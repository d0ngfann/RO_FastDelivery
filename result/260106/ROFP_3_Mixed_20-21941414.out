
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 3
DI Scenario: Mixed
Start Time: 2026-01-05 15:25:03
================================================================================
Loading data from data/DH_data_full_seed3.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
  Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
  Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1680
  DC capacity (MC): min=517, max=897

Demand Structure (s_rk matrix):
  Total customer-product pairs: 72/150 (52.0% sparse)
  Average products per customer: 1.44

Demand (only non-zero entries):
  Nominal (μ): min=8.19, max=34.85, count=72
  Deviation (μ̂): min=4.03, max=9.90

Costs:
  Plant fixed cost: min=5861, max=8650
  DC fixed cost: min=3689, max=4911
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.390', '1.932'] (k=0.812)
    Product 2: ['1.000', '1.313', '1.725'] (k=0.672)
  MD:
    Product 0: ['1.000', '1.241', '1.540'] (k=0.532)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.230', '1.514'] (k=0.512)
  LD:
    Product 0: ['1.000', '1.001', '1.002'] (k=0.002)
    Product 1: ['1.000', '1.130', '1.276'] (k=0.301)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
  Mixed:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48726 nonzeros
Model fingerprint: 0x9e65ca40
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12199 rows and 3199 columns
Presolve time: 0.12s
Presolved: 4474 rows, 5301 columns, 31241 nonzeros
Variable types: 3042 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -298986.6994
Found heuristic solution: objective -171323.3514

Root relaxation: objective 9.722872e+04, 4335 iterations, 0.22 seconds (0.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 97228.7220    0  459 -171323.35 97228.7220   157%     -    0s
H    0     0                    -162635.6222 97228.7220   160%     -    0s
H    0     0                    -162130.7404 85370.1860   153%     -    1s
     0     0 85370.1860    0  651 -162130.74 85370.1860   153%     -    1s
     0     0 85116.1390    0  655 -162130.74 85116.1390   152%     -    1s
     0     0 85108.5831    0  659 -162130.74 85108.5831   152%     -    1s
     0     0 85108.0742    0  658 -162130.74 85108.0742   152%     -    1s
     0     0 82357.5269    0 1071 -162130.74 82357.5269   151%     -    2s
     0     0 82230.5112    0 1071 -162130.74 82230.5112   151%     -    2s
     0     0 82216.4096    0 1074 -162130.74 82216.4096   151%     -    2s
     0     0 82214.7737    0 1075 -162130.74 82214.7737   151%     -    2s
     0     0 78332.1065    0 1066 -162130.74 78332.1065   148%     -    4s
     0     0 78013.0668    0 1084 -162130.74 78013.0668   148%     -    5s
H    0     0                    -115330.3111 77967.1263   168%     -    5s
     0     0 77967.1263    0 1095 -115330.31 77967.1263   168%     -    5s
     0     0 77959.3423    0 1095 -115330.31 77959.3423   168%     -    5s
     0     0 77956.8485    0 1107 -115330.31 77956.8485   168%     -    5s
H    0     0                    -109803.1291 77956.8485   171%     -    6s
H    0     0                    -95078.68036 77956.8485   182%     -    6s
H    0     0                    -94239.77840 77956.8485   183%     -    6s
H    0     0                    -93813.93451 77956.8485   183%     -    6s
H    0     0                    -93404.86209 77956.8485   183%     -    6s
H    0     0                    15033.585112 77956.8485   419%     -    6s
     0     0 75695.0917    0 1167 15033.5851 75695.0917   404%     -    7s
     0     0 75436.1255    0 1181 15033.5851 75436.1255   402%     -    8s
H    0     0                    16428.361500 75380.3715   359%     -    8s
     0     0 75380.3715    0 1173 16428.3615 75380.3715   359%     -    8s
H    0     0                    17007.516665 75368.0889   343%     -    8s
H    0     0                    19217.036495 75368.0889   292%     -    8s
H    0     0                    23811.857442 75368.0889   217%     -    8s
H    0     0                    24502.975747 75368.0889   208%     -    8s
     0     0 75368.0889    0 1168 24502.9757 75368.0889   208%     -    8s
     0     0 75366.5188    0 1175 24502.9757 75366.5188   208%     -    8s
     0     0 74170.1636    0 1176 24502.9757 74170.1636   203%     -   10s
     0     0 73952.2185    0 1194 24502.9757 73952.2185   202%     -   10s
     0     0 73920.6617    0 1175 24502.9757 73920.6617   202%     -   10s
     0     0 73915.1041    0 1206 24502.9757 73915.1041   202%     -   11s
H    0     0                    24557.138584 72839.5215   197%     -   12s
H    0     0                    24561.638776 72839.5215   197%     -   12s
H    0     0                    25635.272216 72839.5215   184%     -   12s
H    0     0                    25650.618089 72839.5215   184%     -   12s
H    0     0                    25721.859141 72839.5215   183%     -   12s
     0     0 72839.5215    0 1176 25721.8591 72839.5215   183%     -   12s
     0     0 72587.9975    0 1196 25721.8591 72587.9975   182%     -   13s
     0     0 72549.4132    0 1199 25721.8591 72549.4132   182%     -   13s
     0     0 72543.4234    0 1213 25721.8591 72543.4234   182%     -   14s
H    0     0                    26641.121604 71794.2000   169%     -   15s
H    0     0                    26645.621797 71794.2000   169%     -   15s
H    0     0                    26886.959316 71794.2000   167%     -   15s
     0     0 71794.2000    0 1177 26886.9593 71794.2000   167%     -   15s
     0     0 71638.6637    0 1183 26886.9593 71638.6637   166%     -   16s
     0     0 71595.2783    0 1192 26886.9593 71595.2783   166%     -   16s
     0     0 71582.3993    0 1209 26886.9593 71582.3993   166%     -   17s
H    0     0                    27710.048180 70972.1667   156%     -   19s
H    0     0                    27887.744126 70972.1667   154%     -   19s
H    0     0                    28110.296393 70972.1667   152%     -   19s
     0     0 70972.1667    0 1204 28110.2964 70972.1667   152%     -   19s
     0     0 70831.7035    0 1228 28110.2964 70831.7035   152%     -   19s
     0     0 70782.0008    0 1238 28110.2964 70782.0008   152%     -   20s
     0     0 70767.2363    0 1239 28110.2964 70767.2363   152%     -   20s
H    0     0                    28124.085060 70275.4917   150%     -   22s
     0     0 70275.4917    0 1153 28124.0851 70275.4917   150%     -   22s
     0     0 70172.6861    0 1199 28124.0851 70172.6861   150%     -   22s
     0     0 70144.8254    0 1211 28124.0851 70144.8254   149%     -   23s
     0     0 70138.7652    0 1195 28124.0851 70138.7652   149%     -   23s
     0     0 69627.8439    0 1161 28124.0851 69627.8439   148%     -   25s
     0     0 69538.1092    0 1193 28124.0851 69538.1092   147%     -   26s
     0     0 69509.8898    0 1233 28124.0851 69509.8898   147%     -   26s
     0     0 69502.7111    0 1242 28124.0851 69502.7111   147%     -   26s
H    0     0                    28373.751785 68941.9206   143%     -   28s
H    0     0                    28398.784083 68941.9206   143%     -   28s
H    0     0                    28441.280730 68941.9206   142%     -   28s
     0     0 68941.9206    0 1140 28441.2807 68941.9206   142%     -   28s
H    0     0                    28538.377934 68828.1967   141%     -   29s
H    0     0                    28540.301575 68828.1967   141%     -   29s
H    0     0                    28605.906878 68828.1967   141%     -   29s
     0     0 68828.1967    0 1186 28605.9069 68828.1967   141%     -   29s
     0     0 68801.9982    0 1202 28605.9069 68801.9982   141%     -   30s
     0     0 68792.0024    0 1210 28605.9069 68792.0024   140%     -   30s
H    0     0                    30946.829980 68502.7015   121%     -   31s
H    0     0                    31014.358924 68502.7015   121%     -   31s
     0     0 68502.7015    0 1144 31014.3589 68502.7015   121%     -   31s
H    0     0                    31257.251245 68435.1375   119%     -   32s
H    0     0                    31271.088053 68435.1375   119%     -   32s
H    0     0                    31280.448299 68435.1375   119%     -   32s
H    0     0                    31323.992105 68435.1375   118%     -   32s
     0     0 68435.1375    0 1197 31323.9921 68435.1375   118%     -   32s
     0     0 68417.2915    0 1192 31323.9921 68417.2915   118%     -   33s
     0     0 68222.5836    0 1151 31323.9921 68222.5836   118%     -   34s
     0     0 68170.5454    0 1165 31323.9921 68170.5454   118%     -   35s
     0     0 68149.1339    0 1145 31323.9921 68149.1339   118%     -   36s
H    0     0                    31482.033352 68149.1339   116%     -   36s
     0     0 67193.4184    0 1083 31482.0334 67193.4184   113%     -   39s
     0     0 66961.4725    0 1151 31482.0334 66961.4725   113%     -   40s
     0     0 66902.5337    0 1164 31482.0334 66902.5337   113%     -   41s
     0     0 66885.8545    0 1199 31482.0334 66885.8545   112%     -   41s
H    0     0                    31990.891908 65728.7958   105%     -   44s
H    0     0                    32051.689843 65728.7958   105%     -   44s
H    0     0                    32099.071518 65728.7958   105%     -   44s
H    0     0                    32179.377417 65728.7958   104%     -   44s
H    0     0                    32338.933697 65728.7958   103%     -   44s
H    0     0                    32353.693187 65728.7958   103%     -   44s
H    0     0                    32361.668796 65728.7958   103%     -   44s
H    0     0                    32376.258600 65728.7958   103%     -   44s
H    0     0                    32427.345100 65728.7958   103%     -   44s
H    0     0                    32493.253831 65728.7958   102%     -   44s
H    0     0                    32514.196414 65728.7958   102%     -   44s
H    0     0                    32568.999501 65728.7958   102%     -   44s
H    0     0                    32652.369170 65728.7958   101%     -   44s
H    0     0                    32731.602903 65728.7958   101%     -   44s
H    0     0                    32819.885617 65728.7958   100%     -   44s
H    0     0                    32881.110530 65728.7958   100%     -   44s
H    0     0                    32947.702898 65728.7958  99.5%     -   44s
     0     0 65728.7958    0 1101 32947.7029 65728.7958  99.5%     -   44s
H    0     0                    33108.547371 65408.2392  97.6%     -   46s
H    0     0                    33194.792302 65408.2392  97.0%     -   46s
H    0     0                    33457.809244 65408.2392  95.5%     -   46s
H    0     0                    33519.545736 65408.2392  95.1%     -   46s
     0     0 65408.2392    0 1142 33519.5457 65408.2392  95.1%     -   46s
     0     0 65319.9233    0 1135 33519.5457 65319.9233  94.9%     -   47s
H    0     0                    33641.755446 65294.1021  94.1%     -   47s
H    0     0                    33858.847995 65294.1021  92.8%     -   47s
H    0     0                    33922.545840 65294.1021  92.5%     -   47s
     0     0 65294.1021    0 1173 33922.5458 65294.1021  92.5%     -   47s
     0     0 64628.9942    0 1158 33922.5458 64628.9942  90.5%     -   50s
H    0     0                    33929.139893 64628.5956  90.5%     -   50s
H    0     0                    33952.123098 64628.5956  90.4%     -   50s
H    0     0                    33995.148399 64628.5956  90.1%     -   50s
H    0     0                    34473.687200 64443.5408  86.9%     -   51s
H    0     0                    34517.429107 64443.5408  86.7%     -   51s
H    0     0                    34797.059072 64443.5408  85.2%     -   51s
     0     0 64443.5408    0 1150 34797.0591 64443.5408  85.2%     -   51s
     0     0 64414.7785    0 1116 34797.0591 64414.7785  85.1%     -   52s
     0     0 64012.9566    0 1147 34797.0591 64012.9566  84.0%     -   53s
H    0     0                    34803.285314 63898.3200  83.6%     -   54s
H    0     0                    34810.354767 63898.3200  83.6%     -   54s
H    0     0                    34922.964289 63898.3200  83.0%     -   54s
H    0     0                    34933.116017 63898.3200  82.9%     -   54s
     0     0 63898.3200    0 1199 34933.1160 63898.3200  82.9%     -   54s
     0     0 63863.3663    0 1191 34933.1160 63863.3663  82.8%     -   55s
     0     0 63849.1884    0 1240 34933.1160 63849.1884  82.8%     -   55s
H    0     0                    34950.089471 62131.8581  77.8%     -   59s
H    0     0                    35176.301720 62131.8581  76.6%     -   59s
H    0     0                    35491.704258 62131.8581  75.1%     -   59s
H    0     0                    35759.341601 62131.8581  73.8%     -   59s
H    0     0                    35759.838840 62131.8581  73.7%     -   59s
H    0     0                    35866.117787 62131.8581  73.2%     -   59s
     0     0 62131.8581    0 1107 35866.1178 62131.8581  73.2%     -   59s
H    0     0                    35876.539600 62129.3243  73.2%     -   59s
H    0     0                    35921.223176 62129.3243  73.0%     -   59s
H    0     0                    36047.269113 61832.4768  71.5%     -   61s
     0     0 61832.4768    0 1160 36047.2691 61832.4768  71.5%     -   61s
     0     0 61756.4830    0 1181 36047.2691 61756.4830  71.3%     -   61s
     0     0 61725.4840    0 1204 36047.2691 61725.4840  71.2%     -   62s
     0     0 60918.8680    0 1103 36047.2691 60918.8680  69.0%     -   64s
     0     0 60730.0247    0 1123 36047.2691 60730.0247  68.5%     -   66s
     0     0 60670.9857    0 1157 36047.2691 60670.9857  68.3%     -   67s
     0     0 60659.7379    0 1130 36047.2691 60659.7379  68.3%     -   67s
     0     0 60299.7042    0 1129 36047.2691 60299.7042  67.3%     -   69s
     0     0 60203.3842    0 1133 36047.2691 60203.3842  67.0%     -   70s
     0     0 60169.9085    0 1156 36047.2691 60169.9085  66.9%     -   71s
     0     0 59887.4652    0 1152 36047.2691 59887.4652  66.1%     -   72s
     0     0 59887.4247    0 1152 36047.2691 59887.4247  66.1%     -   73s
     0     2 59887.4247    0 1152 36047.2691 59887.4247  66.1%     -   76s
     3     8 58231.8345    2  862 36047.2691 59114.2717  64.0%  4505   82s
     7    16 55756.1238    3  658 36047.2691 58224.6759  61.5%  5050   86s
    31    40 53922.0999    5  630 36047.2691 54171.6233  50.3%  3340   91s
H   57    72                    36627.078826 53920.4931  47.2%  4221   92s
H   58    72                    36782.189005 53918.5115  46.6%  4191   92s
H   65    72                    36962.738281 53166.6685  43.8%  3891   92s
   171   174 51054.5475   10  477 36962.7383 52499.1378  42.0%  2234   95s
H  175   174                    36963.256057 52499.1378  42.0%  2207   95s
H  178   174                    37443.118395 52499.1378  40.2%  2180   95s
H  328   302                    37602.122597 52499.1378  39.6%  1483   97s
H  333   302                    37762.971276 52499.1378  39.0%  1481   97s
   438   374 50817.4737   12  471 37762.9713 52463.7236  38.9%  1274  100s
   810   626 48305.7448   18  463 37762.9713 52326.3719  38.6%   945  105s
  1167   869 45894.4979   21  459 37762.9713 51408.0543  36.1%   838  110s
  1973  1351 41165.6034   29  344 37762.9713 49629.8292  31.4%   658  115s
  2709  1680 38619.3056   13  368 37762.9713 47700.8179  26.3%   597  121s
  3468  1999 42805.7566   15  275 37762.9713 46690.5717  23.6%   571  126s
H 3985  2168                    37764.331746 46305.9211  22.6%   553  129s
H 4000  2168                    37770.767833 46305.9211  22.6%   552  129s
  4029  2230 38495.9597   17  368 37770.7678 46305.9211  22.6%   553  130s
  4900  2466 41424.5592   25  335 37770.7678 45927.7963  21.6%   522  135s
  5180  2678     cutoff   27      37770.7678 45919.2116  21.6%   519  140s
  5454  2679 40255.1262   12 1152 37770.7678 45505.0942  20.5%   507  173s
  5458  2682 41096.6815   31  336 37770.7678 45505.0942  20.5%   506  175s
  5475  2698 44738.0522   11  398 37770.7678 45140.4309  19.5%   507  180s
  6243  2474 38965.9832   30  113 37770.7678 39185.5431  3.75%   469  185s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  Projected implied bound: 23
  MIR: 144
  Flow cover: 308
  RLT: 16
  Relax-and-lift: 60

Explored 6879 nodes (3073725 simplex iterations) in 186.17 seconds (234.87 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 37770.8 37764.3 37763 ... 35921.2

Optimal solution found (tolerance 1.00e-04)
Best objective 3.777076783270e+04, best bound 3.777076783270e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 186.18s
  Master Objective (UB) = 37770.77, θ = 166178.13
  Upper Bound (UB) = 37770.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166178.13
  [DEBUG]   ✓ Scenario 0: θ = 166178.13 ≤ Q = 166178.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xc46a2ae
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf3b95d52
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506392e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6949783.6869
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.283963e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128396.28    0  123 6949783.69 -128396.28   102%     -    0s
H    0     0                    -99817.60707 -128396.28  28.6%     -    0s
H    0     0                    -99970.76813 -128396.28  28.4%     -    0s
*    0     0               0    -101420.3495 -101420.35  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 195

Explored 1 nodes (366 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -101420 -99970.8 -99817.6 ... 1.50639e+13
No other solutions better than -101420

Optimal solution found (tolerance 1.00e-04)
Best objective -1.014203494951e+05, best bound -1.014203494951e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 134012.22
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101420.35
  [DEBUG]   S×d_nominal = 235432.57
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 235432.57 + -101420.35 = 134012.22
  [DEBUG]   Current θ from Master = 166178.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32165.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5604.86
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 32165.9112, Absolute Gap = 32165.9112, Relative Gap = 0.851609
  Not converged yet (gap = 32165.91 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91933 nonzeros
Model fingerprint: 0x3723c639
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 5604.86 (0.02s)
MIP start from previous solve produced solution with objective 5604.86 (0.02s)
Loaded MIP start from previous solve with objective 5604.86

Presolve removed 15757 rows and 6396 columns
Presolve time: 0.44s
Presolved: 16206 rows, 8344 columns, 89438 nonzeros
Variable types: 6085 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.234091e+04, 9808 iterations, 2.00 seconds (2.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42340.9087    0  461 5604.85659 42340.9087   655%     -    2s
H    0     0                    9956.0990587 42340.9087   325%     -    2s
H    0     0                    10686.928609 42340.9087   296%     -    2s
     0     0 32436.4884    0  548 10686.9286 32436.4884   204%     -    5s
H    0     0                    12375.245973 32431.5810   162%     -    5s
H    0     0                    12676.066674 31764.4888   151%     -    5s
     0     0 31764.4888    0  537 12676.0667 31764.4888   151%     -    5s
     0     0 31730.9713    0  536 12676.0667 31730.9713   150%     -    5s
     0     0 31727.9533    0  539 12676.0667 31727.9533   150%     -    6s
     0     0 27635.9904    0  378 12676.0667 27635.9904   118%     -    8s
H    0     0                    13249.391368 26919.8449   103%     -    9s
     0     0 26919.8449    0  434 13249.3914 26919.8449   103%     -    9s
     0     0 26684.1291    0  394 13249.3914 26684.1291   101%     -    9s
     0     0 26679.0425    0  398 13249.3914 26679.0425   101%     -    9s
     0     0 26678.9577    0  400 13249.3914 26678.9577   101%     -    9s
     0     0 24294.1019    0  658 13249.3914 24294.1019  83.4%     -   12s
     0     0 23651.6825    0  663 13249.3914 23651.6825  78.5%     -   13s
     0     0 23585.7025    0  667 13249.3914 23585.7025  78.0%     -   13s
     0     0 23563.6547    0  671 13249.3914 23563.6547  77.8%     -   14s
     0     0 23562.8572    0  669 13249.3914 23562.8572  77.8%     -   14s
     0     0 22243.3005    0  362 13249.3914 22243.3005  67.9%     -   17s
     0     0 22004.1185    0  363 13249.3914 22004.1185  66.1%     -   18s
H    0     0                    13274.582050 21882.5145  64.8%     -   19s
     0     0 21882.5145    0  387 13274.5820 21882.5145  64.8%     -   19s
     0     0 21857.8814    0  385 13274.5820 21857.8814  64.7%     -   19s
     0     0 21848.4479    0  388 13274.5820 21848.4479  64.6%     -   19s
     0     0 21847.9303    0  389 13274.5820 21847.9303  64.6%     -   19s
     0     0 21414.1791    0  451 13274.5820 21414.1791  61.3%     -   20s
     0     0 21239.1987    0  400 13274.5820 21239.1987  60.0%     -   21s
     0     0 21182.5652    0  411 13274.5820 21182.5652  59.6%     -   22s
     0     0 21166.6193    0  406 13274.5820 21166.6193  59.5%     -   22s
     0     0 21165.2364    0  410 13274.5820 21165.2364  59.4%     -   22s
     0     0 20950.8816    0  458 13274.5820 20950.8816  57.8%     -   23s
     0     0 20860.0020    0  404 13274.5820 20860.0020  57.1%     -   27s
     0     0 20832.6502    0  393 13274.5820 20832.6502  56.9%     -   27s
     0     0 20826.2046    0  402 13274.5820 20826.2046  56.9%     -   27s
     0     0 20823.9015    0  402 13274.5820 20823.9015  56.9%     -   27s
     0     0 20678.8349    0  478 13274.5820 20678.8349  55.8%     -   28s
     0     0 20634.3481    0  537 13274.5820 20634.3481  55.4%     -   29s
     0     0 20618.2986    0  475 13274.5820 20618.2986  55.3%     -   29s
     0     0 20615.5930    0  531 13274.5820 20615.5930  55.3%     -   29s
     0     0 20568.2223    0  478 13274.5820 20568.2223  54.9%     -   30s
     0     0 20555.4352    0  478 13274.5820 20555.4352  54.8%     -   30s
     0     0 20552.7320    0  478 13274.5820 20552.7320  54.8%     -   31s
     0     0 20508.7913    0  407 13274.5820 20508.7913  54.5%     -   31s
     0     0 20500.1911    0  545 13274.5820 20500.1911  54.4%     -   32s
     0     0 20495.8461    0  470 13274.5820 20495.8461  54.4%     -   32s
     0     0 20470.3679    0  406 13274.5820 20470.3679  54.2%     -   33s
     0     0 20458.1585    0  481 13274.5820 20458.1585  54.1%     -   33s
     0     0 20454.3513    0  480 13274.5820 20454.3513  54.1%     -   33s
     0     0 20434.3803    0  470 13274.5820 20434.3803  53.9%     -   34s
     0     0 20433.8218    0  470 13274.5820 20433.8218  53.9%     -   34s
     0     2 20433.4721    0  470 13274.5820 20433.4721  53.9%     -   40s
    15    32 15158.4412    4  326 13274.5820 18668.9611  40.6%  1082   45s
   133   145 17259.3064    7  290 13274.5820 18059.0443  36.0%   816   50s
   361   324 15285.7474   15  263 13274.5820 18055.9732  36.0%   627   55s
   623   502 14261.8631   28  239 13274.5820 18055.9732  36.0%   520   60s
  1008   684 13530.6935   37  235 13274.5820 17553.7725  32.2%   433   65s
  1415   886 14293.2675   20  333 13274.5820 17488.6963  31.7%   403   71s
  1809  1126 16115.0019   15  424 13274.5820 17488.6963  31.7%   391   75s
  2331  1448     cutoff   30      13274.5820 17301.1080  30.3%   359   80s
  2975  1689 15229.5373   16  281 13274.5820 16857.8073  27.0%   334   85s
  3497  2094     cutoff   48      13274.5820 16735.1879  26.1%   323   90s
  4018  2259 14200.6570   18  470 13274.5820 16726.1045  26.0%   311  104s
  4020  2260 16115.1034   13  205 13274.5820 16726.1045  26.0%   311  106s
  4022  2262 13529.1185   39  353 13274.5820 16726.1045  26.0%   310  110s
  4032  2268 15833.0348   33  413 13274.5820 16726.1045  26.0%   310  115s
  4037  2272 15540.6170   12  467 13274.5820 16726.1045  26.0%   309  120s
  4043  2276 14887.8751   13  464 13274.5820 16726.1045  26.0%   309  126s
  4045  2277 13348.2226   36  464 13274.5820 16726.1045  26.0%   309  131s
  4052  2291 15822.9013   12  275 13274.5820 16726.1045  26.0%   316  136s
  4106  2308 16726.1045   15  303 13274.5820 16726.1045  26.0%   324  140s
  4415  2363     cutoff   24      13274.5820 16726.1045  26.0%   325  145s
  4808  2269 14338.1115   22  231 13274.5820 16555.8759  24.7%   323  150s
  5138  2137 13533.1728   23  263 13274.5820 16555.8759  24.7%   322  155s
  5589  1887 13757.2927   31  245 13274.5820 15665.2812  18.0%   318  160s

Cutting planes:
  Gomory: 1
  MIR: 189
  Flow cover: 340
  Zero half: 1
  RLT: 8
  Relax-and-lift: 26

Explored 6071 nodes (1891123 simplex iterations) in 164.54 seconds (233.78 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: 13274.6 13249.4 12676.1 ... 5604.86

Optimal solution found (tolerance 1.00e-04)
Best objective 1.327458204953e+04, best bound 1.327458204953e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 164.55s
  Master Objective (UB) = 13274.58, θ = 141675.20
  Upper Bound (UB) = 13274.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141675.20
  [DEBUG]   ✓ Scenario 0: θ = 141675.20 ≤ Q = 141675.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141675.20 ≤ Q = 141675.20 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2212c7fd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdded3803
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506319e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6727433.4712
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.391293e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139129.27    0  126 6727433.47 -139129.27   102%     -    0s
H    0     0                    -107053.9717 -139129.27  30.0%     -    0s
H    0     0                    -107207.1328 -139129.27  29.8%     -    0s
H    0     0                    -118156.7114 -139129.27  17.7%     -    0s
     0     0 -123115.10    0  122 -118156.71 -123115.10  4.20%     -    0s
H    0     0                    -120395.6687 -123024.22  2.18%     -    0s
     0     0 -122136.42    0  118 -120395.67 -122136.42  1.45%     -    0s
     0     0 -121511.31    0   93 -120395.67 -121511.31  0.93%     -    0s
H    0     0                    -120715.4380 -121495.46  0.65%     -    0s
H    0     0                    -121007.8918 -121495.46  0.40%     -    0s
     0     0 -121466.04    0   85 -121007.89 -121466.04  0.38%     -    0s
     0     0 -121443.95    0  106 -121007.89 -121443.95  0.36%     -    0s
     0     0 -121437.15    0   89 -121007.89 -121437.15  0.35%     -    0s
H    0     0                    -121019.4647 -121437.15  0.35%     -    0s
     0     0 -121330.28    0   37 -121019.46 -121330.28  0.26%     -    0s
H    0     0                    -121024.6212 -121327.17  0.25%     -    0s
     0     0 -121327.17    0   37 -121024.62 -121327.17  0.25%     -    0s
     0     0 -121273.29    0   35 -121024.62 -121273.29  0.21%     -    0s
     0     0 -121273.21    0   35 -121024.62 -121273.21  0.21%     -    0s
H    0     0                    -121056.0484 -121273.21  0.18%     -    0s
H    0     0                    -121067.9178 -121273.21  0.17%     -    0s
     0     0 -121273.21    0   90 -121067.92 -121273.21  0.17%     -    0s
H    0     0                    -121110.3309 -121273.21  0.13%     -    0s
     0     0 -121273.21    0   76 -121110.33 -121273.21  0.13%     -    0s
     0     0 -121273.21    0   66 -121110.33 -121273.21  0.13%     -    0s
     0     0 -121223.29    0   57 -121110.33 -121223.29  0.09%     -    0s
     0     0 -121222.64    0   57 -121110.33 -121222.64  0.09%     -    0s
     0     0 -121212.59    0    4 -121110.33 -121212.59  0.08%     -    0s
H    0     0                    -121195.5949 -121211.57  0.01%     -    0s
     0     0 -121211.15    0    4 -121195.59 -121211.15  0.01%     -    0s
     0     0 -121211.07    0    4 -121195.59 -121211.07  0.01%     -    0s
     0     0 -121211.07    0    4 -121195.59 -121211.07  0.01%     -    0s
     0     0 -121211.07    0    4 -121195.59 -121211.07  0.01%     -    0s
*    0     0               0    -121210.5102 -121210.51  0.00%     -    0s

Cutting planes:
  Gomory: 31
  Implied bound: 9
  MIR: 92
  Flow cover: 21
  RLT: 9
  Relax-and-lift: 5

Explored 1 nodes (1026 simplex iterations) in 0.33 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -121211 -121196 -121110 ... -120396
No other solutions better than -121211

Optimal solution found (tolerance 1.00e-04)
Best objective -1.212105102183e+05, best bound -1.212105102183e+05, gap 0.0000%
  Subproblem solved in 0.36s
  Worst-case operational profit (Z_SP) = 131943.69
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121210.51
  [DEBUG]   S×d_nominal = 253154.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253154.21 + -121210.51 = 131943.69
  [DEBUG]   Current θ from Master = 141675.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9731.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3543.07
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 7669.7255, Absolute Gap = 7669.7255, Relative Gap = 0.577775
  Not converged yet (gap = 7669.73 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135140 nonzeros
Model fingerprint: 0x8bc93380
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 3543.07 (0.04s)
MIP start from previous solve produced solution with objective 3543.07 (0.04s)
Loaded MIP start from previous solve with objective 3543.07

Presolve removed 23634 rows and 9594 columns
Presolve time: 0.57s
Presolved: 23619 rows, 11386 columns, 131849 nonzeros
Variable types: 9127 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.61s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.233965e+04, 11432 iterations, 3.63 seconds (4.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42339.6534    0  461 3543.07411 42339.6534  1095%     -    4s
H    0     0                    12108.504111 42339.6534   250%     -    4s
H    0     0                    12838.259411 42339.6534   230%     -    4s
H    0     0                    12893.987566 42339.6534   228%     -    4s
H    0     0                    12908.128834 33091.5359   156%     -    9s
     0     0 33091.5359    0  618 12908.1288 33091.5359   156%     -    9s
     0     0 32159.4787    0  550 12908.1288 32159.4787   149%     -   10s
     0     0 32101.9572    0  552 12908.1288 32101.9572   149%     -   10s
     0     0 32101.9449    0  550 12908.1288 32101.9449   149%     -   10s
     0     0 27205.4322    0  537 12908.1288 27205.4322   111%     -   15s
     0     0 26569.6005    0  543 12908.1288 26569.6005   106%     -   16s
     0     0 26410.2331    0  488 12908.1288 26410.2331   105%     -   17s
     0     0 26372.4973    0  659 12908.1288 26372.4973   104%     -   17s
     0     0 26366.3529    0  558 12908.1288 26366.3529   104%     -   18s
     0     0 26366.1479    0  555 12908.1288 26366.1479   104%     -   18s
     0     0 24266.4180    0  602 12908.1288 24266.4180  88.0%     -   23s
     0     0 23898.1573    0  591 12908.1288 23898.1573  85.1%     -   25s
     0     0 23701.8609    0  594 12908.1288 23701.8609  83.6%     -   25s
     0     0 23599.4717    0  598 12908.1288 23599.4717  82.8%     -   26s
     0     0 23558.8159    0  591 12908.1288 23558.8159  82.5%     -   26s
     0     0 23543.7500    0  601 12908.1288 23543.7500  82.4%     -   27s
     0     0 23540.3828    0  606 12908.1288 23540.3828  82.4%     -   27s
     0     0 22264.0416    0  394 12908.1288 22264.0416  72.5%     -   33s
     0     0 21882.8332    0  378 12908.1288 21882.8332  69.5%     -   35s
     0     0 21763.1672    0  384 12908.1288 21763.1672  68.6%     -   35s
     0     0 21735.7060    0  396 12908.1288 21735.7060  68.4%     -   36s
     0     0 21688.7844    0  388 12908.1288 21688.7844  68.0%     -   36s
     0     0 21676.1325    0  394 12908.1288 21676.1325  67.9%     -   37s
     0     0 21675.8702    0  396 12908.1288 21675.8702  67.9%     -   37s
     0     0 21283.2376    0  367 12908.1288 21283.2376  64.9%     -   39s
     0     0 21142.1930    0  394 12908.1288 21142.1930  63.8%     -   40s
     0     0 21105.7614    0  394 12908.1288 21105.7614  63.5%     -   40s
     0     0 21099.7579    0  400 12908.1288 21099.7579  63.5%     -   41s
     0     0 20938.9793    0  388 12908.1288 20938.9793  62.2%     -   42s
     0     0 20893.6795    0  397 12908.1288 20893.6795  61.9%     -   45s
     0     0 20871.3419    0  417 12908.1288 20871.3419  61.7%     -   45s
     0     0 20865.9361    0  412 12908.1288 20865.9361  61.6%     -   45s
     0     0 20695.7714    0  483 12908.1288 20695.7714  60.3%     -   47s
     0     0 20665.6145    0  473 12908.1288 20665.6145  60.1%     -   48s
     0     0 20654.4799    0  417 12908.1288 20654.4799  60.0%     -   48s
     0     0 20651.6029    0  541 12908.1288 20651.6029  60.0%     -   48s
     0     0 20574.7284    0  408 12908.1288 20574.7284  59.4%     -   50s
     0     0 20554.9438    0  420 12908.1288 20554.9438  59.2%     -   52s
     0     0 20548.7810    0  483 12908.1288 20548.7810  59.2%     -   53s
     0     0 20506.9729    0  399 12908.1288 20506.9729  58.9%     -   54s
     0     0 20487.8540    0  402 12908.1288 20487.8540  58.7%     -   55s
     0     0 20483.0021    0  409 12908.1288 20483.0021  58.7%     -   55s
     0     0 20448.4020    0  426 12908.1288 20448.4020  58.4%     -   56s
     0     0 20442.7120    0  412 12908.1288 20442.7120  58.4%     -   57s
     0     0 20423.0019    0  422 12908.1288 20423.0019  58.2%     -   57s
     0     0 20422.8057    0  422 12908.1288 20422.8057  58.2%     -   58s
     0     2 20422.8036    0  422 12908.1288 20422.8036  58.2%     -   70s
    15    32 19289.6214    4  355 12908.1288 19752.2936  53.0%  1203   76s
H   44    64                    13080.809646 19569.3295  49.6%  1479   78s
    63    96 17124.6658    6  407 13080.8096 19519.4001  49.2%  1470   82s
    95   131 15379.4077    7  468 13080.8096 19516.3448  49.2%  1724   85s
   239   214 14827.6537   11  526 13080.8096 19516.3448  49.2%  1368   92s
   283   223 14623.5302   11  527 13080.8096 19389.4884  48.2%  1296   97s
   338   247 14683.9241   12  454 13080.8096 19291.5307  47.5%  1208  101s
   448   342 13832.7569   14  372 13080.8096 19291.5307  47.5%  1108  106s
   625   467     cutoff   22      13080.8096 19193.1983  46.7%   954  110s
   896   633 17013.6020    9  348 13080.8096 18892.9103  44.4%   819  117s
  1013   766 16180.2318   11  391 13080.8096 18892.9103  44.4%   778  121s
  1246   881 16027.2566   13  382 13080.8096 18892.9103  44.4%   698  125s
  1488   996 15434.2124   23  358 13080.8096 18698.6469  42.9%   664  130s
  1715  1161 14497.9111   39  226 13080.8096 18517.5303  41.6%   645  135s
  1996  1271 15441.1005   11  340 13080.8096 18517.5303  41.6%   617  141s
  2242  1429 14362.7682   18  277 13080.8096 18517.5303  41.6%   604  146s
  2539  1641 13903.2203   30  255 13080.8096 18084.2705  38.3%   591  153s
  2768  1725     cutoff   41      13080.8096 17711.2033  35.4%   577  156s
  3141  1948 15383.5654    9  292 13080.8096 17697.2163  35.3%   564  161s
  3347  2035 13502.3467   13  261 13080.8096 17697.2163  35.3%   557  165s
  3858  2226     cutoff   20      13080.8096 17622.2961  34.7%   531  171s
  4182  2441 13445.0768   13  503 13080.8096 17410.8874  33.1%   523  178s
  4442  2558 13655.1756   14  340 13080.8096 17373.4547  32.8%   515  182s
  4759  2675 13782.8848    8  176 13080.8096 17319.9169  32.4%   505  185s
  5033  2676 14364.0801   19  422 13080.8096 17265.9995  32.0%   501  200s
  5036  2678 15577.7161   18  387 13080.8096 17265.9995  32.0%   500  207s
  5038  2679 15060.7956   13  347 13080.8096 17265.9995  32.0%   500  211s
  5045  2684 15304.3368   19  412 13080.8096 17265.9995  32.0%   499  215s
  5049  2687 15031.1316   11  437 13080.8096 17265.9995  32.0%   499  220s
  5055  2691 16110.5030   19  409 13080.8096 17265.9995  32.0%   498  226s
  5059  2693 13929.5591   22  463 13080.8096 17265.9995  32.0%   498  231s
  5062  2695 16509.7760   18  435 13080.8096 17265.9995  32.0%   498  235s
  5064  2697 15171.8921   17  474 13080.8096 17265.9995  32.0%   498  241s
  5065  2697 16999.3622   10  474 13080.8096 17265.9995  32.0%   497  250s
  5068  2704 16407.6574   16  335 13080.8096 17265.9995  32.0%   507  256s
  5080  2724 15652.4067   18  398 13080.8096 17265.9995  32.0%   511  260s
  5128  2751 14407.7501   20  315 13080.8096 17265.9995  32.0%   518  266s
  5240  2796     cutoff   22      13080.8096 17265.9995  32.0%   529  271s
  5388  2784     cutoff   23      13080.8096 17265.9995  32.0%   532  275s
  5520  2771 15499.4711   23  173 13080.8096 17128.7264  30.9%   531  281s
  5662  2703 13384.5442   26  103 13080.8096 16969.6985  29.7%   534  285s
  5856  2648 13238.0664   24   94 13080.8096 16439.3260  25.7%   537  291s
  5933  2618 infeasible   25      13080.8096 15959.6239  22.0%   537  295s
  6162  2467 14840.9407   24  310 13080.8096 15612.5535  19.4%   537  300s
  6449  2257     cutoff   23      13080.8096 15310.7234  17.0%   533  306s

Cutting planes:
  Gomory: 1
  MIR: 237
  Flow cover: 475
  RLT: 5
  Relax-and-lift: 43

Explored 6553 nodes (3523543 simplex iterations) in 308.91 seconds (500.30 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: 13080.8 12908.1 12894 ... 3543.07

Optimal solution found (tolerance 1.00e-04)
Best objective 1.308080964607e+04, best bound 1.308080964607e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 308.93s
  Master Objective (UB) = 13080.81, θ = 141658.92
  Upper Bound (UB) = 13080.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141658.92
  [DEBUG]   ✓ Scenario 0: θ = 141658.92 ≤ Q = 141658.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141658.92 ≤ Q = 141658.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141658.92 ≤ Q = 141658.92 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x63b2e30f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9c4d1cf1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506465e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6727997.5970
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.388167e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138816.74    0  123 6727997.60 -138816.74   102%     -    0s
H    0     0                    -109960.6589 -138816.74  26.2%     -    0s
H    0     0                    -110113.8199 -138816.74  26.1%     -    0s
H    0     0                    -115069.4904 -138816.74  20.6%     -    0s
H    0     0                    -115626.2171 -123230.59  6.58%     -    0s
     0     0 -123230.59    0  119 -115626.22 -123230.59  6.58%     -    0s
H    0     0                    -118880.5521 -123127.02  3.57%     -    0s
H    0     0                    -120395.6687 -123127.02  2.27%     -    0s
     0     0 -122178.62    0  123 -120395.67 -122178.62  1.48%     -    0s
     0     0 -122104.18    0  124 -120395.67 -122104.18  1.42%     -    0s
     0     0 -121352.86    0   98 -120395.67 -121352.86  0.80%     -    0s
     0     0 -121286.65    0   89 -120395.67 -121286.65  0.74%     -    0s
     0     0 -121257.61    0  101 -120395.67 -121257.61  0.72%     -    0s
     0     0 -121251.89    0  101 -120395.67 -121251.89  0.71%     -    0s
     0     0 -120912.87    0   69 -120395.67 -120912.87  0.43%     -    0s
     0     0 -120848.13    0   71 -120395.67 -120848.13  0.38%     -    0s
     0     0 -120833.03    0   73 -120395.67 -120833.03  0.36%     -    0s
     0     0 -120783.70    0   60 -120395.67 -120783.70  0.32%     -    0s
     0     0 -120775.14    0   60 -120395.67 -120775.14  0.32%     -    0s
     0     0 -120744.82    0   58 -120395.67 -120744.82  0.29%     -    0s
     0     0 -120743.03    0   58 -120395.67 -120743.03  0.29%     -    0s
H    0     0                    -120553.4024 -120734.45  0.15%     -    0s
H    0     0                    -120568.3258 -120734.45  0.14%     -    0s
     0     0 -120734.45    0   90 -120568.33 -120734.45  0.14%     -    0s
     0     0 -120734.45    0   73 -120568.33 -120734.45  0.14%     -    0s
     0     0 -120734.45    0   52 -120568.33 -120734.45  0.14%     -    0s
     0     0 -120726.19    0   51 -120568.33 -120726.19  0.13%     -    0s
     0     0 -120725.12    0   51 -120568.33 -120725.12  0.13%     -    0s
     0     0 -120691.47    0   43 -120568.33 -120691.47  0.10%     -    0s
     0     0 -120689.62    0   43 -120568.33 -120689.62  0.10%     -    0s
     0     0 -120683.48    0   53 -120568.33 -120683.48  0.10%     -    0s
     0     0 -120682.06    0   53 -120568.33 -120682.06  0.09%     -    0s
     0     2 -120681.96    0   53 -120568.33 -120681.96  0.09%     -    0s
H   29     3                    -120570.0423 -120581.40  0.01%   7.4    0s

Cutting planes:
  Gomory: 24
  Implied bound: 1
  MIR: 92
  Flow cover: 26
  RLT: 4
  BQP: 1

Explored 34 nodes (1485 simplex iterations) in 0.28 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -120570 -120568 -120553 ... 1.50647e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.205700423441e+05, best bound -1.205775928626e+05, gap 0.0063%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 132584.16
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120570.04
  [DEBUG]   S×d_nominal = 253154.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253154.21 + -120570.04 = 132584.16
  [DEBUG]   Current θ from Master = 141658.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9074.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4006.06
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 7475.9531, Absolute Gap = 7475.9531, Relative Gap = 0.571521
  Not converged yet (gap = 7475.95 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178347 nonzeros
Model fingerprint: 0x78a4fdee
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4006.06 (0.03s)
Loaded MIP start from previous solve with objective 4006.06

Presolve removed 31512 rows and 12792 columns
Presolve time: 1.51s
Presolved: 31031 rows, 14428 columns, 173959 nonzeros
Variable types: 12169 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26864    2.6220950e+04   0.000000e+00   1.506356e+07      5s
   38853    4.0121373e+04   0.000000e+00   1.494913e+05     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23229    4.1012137e+04   0.000000e+00   0.000000e+00     10s

Root relaxation: objective 4.101214e+04, 23229 iterations, 8.57 seconds (11.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41012.1371    0  303 4006.05517 41012.1371   924%     -   10s
H    0     0                    11795.151015 41012.1371   248%     -   10s
H    0     0                    12269.479292 41012.1371   234%     -   10s
H    0     0                    12390.783890 41012.1371   231%     -   11s
H    0     0                    12451.456381 41012.1371   229%     -   11s
H    0     0                    12577.243559 33253.5447   164%     -   15s
     0     0 33041.1968    0  398 12577.2436 33041.1968   163%     -   15s
H    0     0                    12671.763873 33041.1968   161%     -   15s
H    0     0                    12747.991579 33041.1968   159%     -   15s
     0     0 32828.9186    0  481 12747.9916 32828.9186   158%     -   17s
     0     0 32827.5742    0  481 12747.9916 32827.5742   158%     -   17s
     0     0 32819.8713    0  481 12747.9916 32819.8713   157%     -   17s
     0     0 32817.5920    0  483 12747.9916 32817.5920   157%     -   17s
     0     0 32817.5873    0  486 12747.9916 32817.5873   157%     -   17s
     0     0 27436.6442    0  478 12747.9916 27436.6442   115%     -   24s
     0     0 26499.3108    0  483 12747.9916 26499.3108   108%     -   27s
     0     0 26296.2237    0  495 12747.9916 26296.2237   106%     -   30s
     0     0 26253.8498    0  493 12747.9916 26253.8498   106%     -   30s
     0     0 26243.6686    0  500 12747.9916 26243.6686   106%     -   31s
     0     0 26237.3656    0  496 12747.9916 26237.3656   106%     -   31s
     0     0 26235.9729    0  490 12747.9916 26235.9729   106%     -   31s
     0     0 23370.3601    0  519 12747.9916 23370.3601  83.3%     -   41s
     0     0 22816.0505    0  532 12747.9916 22816.0505  79.0%     -   43s
     0     0 22687.8598    0  625 12747.9916 22687.8598  78.0%     -   45s
     0     0 22588.6907    0  538 12747.9916 22588.6907  77.2%     -   46s
     0     0 22447.0798    0  609 12747.9916 22447.0798  76.1%     -   47s
     0     0 22425.2438    0  545 12747.9916 22425.2438  75.9%     -   47s
     0     0 22423.7283    0  542 12747.9916 22423.7283  75.9%     -   47s
     0     0 20875.9934    0  484 12747.9916 20875.9934  63.8%     -   59s
H    0     0                    12801.146521 20875.7760  63.1%     -   59s
     0     0 20526.2102    0  370 12801.1465 20526.2102  60.3%     -   63s
     0     0 20379.3805    0  477 12801.1465 20379.3805  59.2%     -   66s
     0     0 20333.3294    0  388 12801.1465 20333.3294  58.8%     -   68s
     0     0 20289.7731    0  395 12801.1465 20289.7731  58.5%     -   70s
     0     0 20231.6913    0  613 12801.1465 20231.6913  58.0%     -   71s
     0     0 20216.4960    0  582 12801.1465 20216.4960  57.9%     -   72s
H    0     0                    12842.297405 20208.9683  57.4%     -   73s
     0     0 20208.9683    0  523 12842.2974 20208.9683  57.4%     -   73s
     0     0 20206.5530    0  586 12842.2974 20206.5530  57.3%     -   73s
     0     0 19662.9675    0  392 12842.2974 19662.9675  53.1%     -   78s
     0     0 19478.4201    0  472 12842.2974 19478.4201  51.7%     -   81s
     0     0 19402.7476    0  402 12842.2974 19402.7476  51.1%     -   82s
     0     0 19376.4245    0  403 12842.2974 19376.4245  50.9%     -   83s
     0     0 19373.9779    0  394 12842.2974 19373.9779  50.9%     -   83s
     0     0 19121.9067    0  399 12842.2974 19121.9067  48.9%     -   87s
     0     0 19038.4867    0  405 12842.2974 19038.4867  48.2%     -   90s
     0     0 19025.4185    0  396 12842.2974 19025.4185  48.1%     -   90s
     0     0 19017.7633    0  406 12842.2974 19017.7633  48.1%     -   91s
     0     0 19013.2463    0  411 12842.2974 19013.2463  48.1%     -   92s
     0     0 18933.6068    0  407 12842.2974 18933.6068  47.4%     -   95s
     0     0 18912.6585    0  396 12842.2974 18912.6585  47.3%     -   97s
     0     0 18901.1373    0  564 12842.2974 18901.1373  47.2%     -   98s
     0     0 18890.4948    0  399 12842.2974 18890.4948  47.1%     -   99s
     0     0 18885.1534    0  504 12842.2974 18885.1534  47.1%     -  101s
     0     0 18844.0477    0  579 12842.2974 18844.0477  46.7%     -  103s
     0     0 18837.0914    0  552 12842.2974 18837.0914  46.7%     -  104s
     0     0 18832.0116    0  549 12842.2974 18832.0116  46.6%     -  105s
     0     0 18817.5360    0  551 12842.2974 18817.5360  46.5%     -  106s
     0     0 18808.7080    0  560 12842.2974 18808.7080  46.5%     -  107s
     0     0 18806.7071    0  415 12842.2974 18806.7071  46.4%     -  107s
     0     0 18776.2748    0  553 12842.2974 18776.2748  46.2%     -  109s
     0     0 18775.9067    0  553 12842.2974 18775.9067  46.2%     -  110s
     0     2 18775.6388    0  553 12842.2974 18775.6388  46.2%     -  125s
     7    16 18373.1798    3  409 12842.2974 18409.2312  43.3%  1907  133s
    15    32 18110.7044    4  552 12842.2974 18372.7687  43.1%  2818  141s
    31    64 17326.0722    5  641 12842.2974 18110.2971  41.0%  4275  148s
H   40    64                    12846.733618 18110.2971  41.0%  4312  148s
    63    96 16832.2362    6  547 12846.7336 17751.7865  38.2%  4288  153s
    95   128 16551.0830    7  480 12846.7336 17751.5640  38.2%  4481  157s
H   99   128                    12884.924866 17751.5640  37.8%  4448  157s
H  102   128                    12900.402346 17751.5640  37.6%  4402  157s
   127   223 16033.4473    8  489 12900.4023 17751.5640  37.6%  3976  162s
   224   287 16356.9281    9  540 12900.4023 17751.5640  37.6%  2853  170s
   312   327 16181.6656   10  564 12900.4023 17751.5640  37.6%  2441  178s
   399   346 16284.5330   11  616 12900.4023 17751.5640  37.6%  2193  187s
   439   374 15631.7863   12  529 12900.4023 17751.5640  37.6%  2141  193s
   492   402 16178.2685   12  626 12900.4023 17751.5640  37.6%  2066  201s
   566   443 16087.2259   13  646 12900.4023 17292.7405  34.0%  1936  207s
   641   483 15936.8229   14  634 12900.4023 17292.7405  34.0%  1820  212s
   717   532 15803.4923   14  621 12900.4023 17292.7405  34.0%  1746  218s
   782   595 15631.2085   15  624 12900.4023 17292.7405  34.0%  1707  222s
   857   650 15540.9637   15  621 12900.4023 17241.9389  33.7%  1642  225s
   941   682 15578.2587   16  541 12900.4023 17241.9389  33.7%  1581  230s
  1113   740     cutoff   17      12900.4023 16956.1485  31.4%  1500  238s
  1180   796 13766.9759   18  439 12900.4023 16912.2287  31.1%  1476  242s
  1268   817 13577.4273   19  433 12900.4023 16804.8472  30.3%  1449  249s
  1333   859     cutoff   20      12900.4023 16804.8472  30.3%  1443  253s
  1419   909 13348.8794   19  463 12900.4023 16804.8472  30.3%  1413  258s
  1508   956     cutoff   20      12900.4023 16804.8472  30.3%  1399  265s
  1631  1011 13007.5819   21  456 12900.4023 16804.8472  30.3%  1375  271s
  1799  1039 12959.1191   23  410 12900.4023 16787.4264  30.1%  1325  279s
  1847  1060     cutoff   24      12900.4023 16787.4264  30.1%  1321  283s
  1904  1108 15425.4899    8  239 12900.4023 16617.1108  28.8%  1314  289s
H 1985  1108                    12903.950556 16442.1407  27.4%  1294  289s
  2039  1167 15054.3372    9  234 12903.9506 16442.1407  27.4%  1270  294s
  2236  1255 14606.3726   11  227 12903.9506 16406.2757  27.1%  1225  300s
  2485  1297 14017.1749   16  226 12903.9506 16289.0115  26.2%  1188  310s
  2591  1318 12996.2624   18  425 12903.9506 16289.0115  26.2%  1180  315s
  2720  1381 13483.8201   22  324 12903.9506 16289.0115  26.2%  1174  322s
  2887  1451     cutoff   26      12903.9506 16289.0115  26.2%  1160  327s
  3114  1494 14031.6344   14  399 12903.9506 16289.0115  26.2%  1128  336s
  3346  1528     cutoff   18      12903.9506 16137.6281  25.1%  1115  345s
  3525  1606     cutoff   11      12903.9506 16002.9374  24.0%  1116  351s
  3716  1620 14858.5727   11  415 12903.9506 15978.2501  23.8%  1112  359s
  3949  1672 13841.3688   14  272 12903.9506 15899.6171  23.2%  1101  367s
  4226  1721     cutoff   15      12903.9506 15863.2296  22.9%  1086  376s
  4438  1740     cutoff   12      12903.9506 15863.2296  22.9%  1090  384s
  4698  1760     cutoff   38      12903.9506 15654.2290  21.3%  1083  394s
  4923  1772     cutoff   16      12903.9506 15523.7217  20.3%  1090  400s
  5059  1797 13219.9795   12  103 12903.9506 15470.0833  19.9%  1096  409s
  5310  1813 14351.4032   16  300 12903.9506 15435.4758  19.6%  1095  416s
  5626  1865 12969.4162   26  174 12903.9506 15426.7598  19.6%  1084  425s
  5986  1907 13195.6927    9  361 12903.9506 15288.3956  18.5%  1067  433s
  6286  1919     cutoff   15      12903.9506 15234.6070  18.1%  1059  441s
  6576  1975 13776.8626   12  394 12903.9506 15132.6004  17.3%  1054  451s
  6991  1985 13270.2670   17  254 12903.9506 15050.3032  16.6%  1036  461s
  7408  1992     cutoff   16      12903.9506 14906.3130  15.5%  1027  472s
  7870  2026     cutoff   17      12903.9506 14802.5121  14.7%  1013  481s
  8305  2051     cutoff   17      12903.9506 14731.3535  14.2%   994  491s
  8772  2087 12971.4040   19  255 12903.9506 14629.0830  13.4%   983  501s
  9297  2079     cutoff   20      12903.9506 14545.7039  12.7%   973  511s
  9403  2074     cutoff   20      12903.9506 14545.7039  12.7%   970  522s
  9900  2034 13188.7421   19  214 12903.9506 14478.0269  12.2%   961  533s
 10455  1982 13431.3921   17  231 12903.9506 14418.8808  11.7%   952  545s
 10997  1939 12935.8246   24  298 12903.9506 14280.6672  10.7%   946  557s
 11645  1863 13417.9568   16  453 12903.9506 14182.9503  9.91%   936  570s
 12348  1740 13362.4899   20  347 12903.9506 14141.3871  9.59%   924  584s
 13128  1503     cutoff   23      12903.9506 14053.2173  8.91%   911  597s
 13955  1257     cutoff   13      12903.9506 13913.6664  7.82%   897  611s
 14682   799     cutoff   14      12903.9506 13794.9804  6.91%   891  625s
 15744    39     cutoff   17      12903.9506 13659.0965  5.85%   868  636s
 16958     3     cutoff   16      12903.9506 13302.7415  3.09%   832  648s
 17000     2     cutoff   22      12903.9506 13108.0452  1.58%   831  660s

Cutting planes:
  Learned: 3
  Gomory: 17
  Cover: 2
  Implied bound: 16
  MIR: 2056
  Flow cover: 1455
  Zero half: 1
  RLT: 53
  Relax-and-lift: 380

Explored 17007 nodes (14267990 simplex iterations) in 661.21 seconds (1277.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12904 12900.4 12884.9 ... 12451.5

Optimal solution found (tolerance 1.00e-04)
Best objective 1.290395055610e+04, best bound 1.290395055610e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 661.25s
  Master Objective (UB) = 12903.95, θ = 141433.10
  Upper Bound (UB) = 12903.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141433.10
  [DEBUG]   ✓ Scenario 0: θ = 141433.10 ≤ Q = 141433.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141433.10 ≤ Q = 141433.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141433.10 ≤ Q = 141433.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141433.10 ≤ Q = 141433.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x758ee258
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x758ee258
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6609701.4057
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.390542e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139054.17    0  123 6609701.41 -139054.17   102%     -    0s
H    0     0                    -110218.5731 -139054.17  26.2%     -    0s
H    0     0                    -110371.7341 -139054.17  26.0%     -    0s
H    0     0                    -114521.1915 -139054.17  21.4%     -    0s
H    0     0                    -115107.6621 -139054.17  20.8%     -    0s
H    0     0                    -115521.8531 -123597.74  6.99%     -    0s
H    0     0                    -119524.2244 -123597.74  3.41%     -    0s
     0     0 -123597.74    0  118 -119524.22 -123597.74  3.41%     -    0s
H    0     0                    -120436.7883 -123494.16  2.54%     -    0s
     0     0 -122765.77    0  126 -120436.79 -122765.77  1.93%     -    0s
     0     0 -121821.96    0  103 -120436.79 -121821.96  1.15%     -    0s
     0     0 -121720.05    0   93 -120436.79 -121720.05  1.07%     -    0s
     0     0 -121675.92    0   94 -120436.79 -121675.92  1.03%     -    0s
     0     0 -121675.52    0   94 -120436.79 -121675.52  1.03%     -    0s
     0     0 -121321.04    0   67 -120436.79 -121321.04  0.73%     -    0s
     0     0 -121279.19    0   74 -120436.79 -121279.19  0.70%     -    0s
     0     0 -121260.59    0   76 -120436.79 -121260.59  0.68%     -    0s
     0     0 -121254.08    0   77 -120436.79 -121254.08  0.68%     -    0s
     0     0 -120972.88    0   63 -120436.79 -120972.88  0.45%     -    0s
     0     0 -120941.08    0   64 -120436.79 -120941.08  0.42%     -    0s
     0     0 -120930.61    0   63 -120436.79 -120930.61  0.41%     -    0s
     0     0 -120851.87    0   58 -120436.79 -120851.87  0.34%     -    0s
     0     0 -120851.36    0   58 -120436.79 -120851.36  0.34%     -    0s
     0     2 -120851.29    0   58 -120436.79 -120851.29  0.34%     -    0s
H   41    44                    -120521.6957 -120788.27  0.22%   8.1    0s
H   43    43                    -120753.6743 -120788.27  0.03%   7.8    0s
H   58    34                    -120775.7642 -120786.27  0.01%   6.5    0s

Cutting planes:
  Gomory: 15
  Implied bound: 5
  MIR: 137
  Flow cover: 22
  RLT: 65

Explored 72 nodes (1213 simplex iterations) in 0.18 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -120776 -120754 -120522 ... 1.48645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.207757642205e+05, best bound -1.207841665751e+05, gap 0.0070%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 132378.44
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120775.76
  [DEBUG]   S×d_nominal = 253154.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253154.21 + -120775.76 = 132378.44
  [DEBUG]   Current θ from Master = 141433.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9054.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3849.29
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 7299.0940, Absolute Gap = 7299.0940, Relative Gap = 0.565648
  Not converged yet (gap = 7299.09 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221554 nonzeros
Model fingerprint: 0x777ecb98
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 39390 rows and 15990 columns
Presolve time: 1.11s
Presolved: 38443 rows, 17470 columns, 237669 nonzeros
Variable types: 15211 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -170240.0806

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 38443 rows, 17470 columns, 237669 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25752    1.8231986e+04   0.000000e+00   1.981941e+07      5s
   34899    2.7818744e+04   0.000000e+00   1.359024e+06     10s
Concurrent spin time: 0.82s

Solved with dual simplex

Root relaxation: objective 3.053262e+04, 27460 iterations, 13.18 seconds (17.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30532.6197    0  217 -170240.08 30532.6197   118%     -   14s
H    0     0                    -160485.5210 30532.6197   119%     -   14s
H    0     0                    -121283.6618 30532.6197   125%     -   14s
H    0     0                    -119535.9948 30532.6197   126%     -   14s
H    0     0                    -119255.9264 30532.6197   126%     -   14s
H    0     0                    -101365.1060 30532.6197   130%     -   15s
H    0     0                    -94898.74256 30532.6197   132%     -   15s
H    0     0                    -71486.59231 30532.6197   143%     -   15s
H    0     0                    -69792.76310 30532.6197   144%     -   15s
H    0     0                    -60640.40808 30532.6197   150%     -   15s
H    0     0                    -59659.06370 30532.6197   151%     -   15s
H    0     0                    -7869.544019 30532.6197   488%     -   15s
H    0     0                    -3397.318319 30532.6197   999%     -   15s
H    0     0                    -2948.954989 30532.6197  1135%     -   15s
H    0     0                    -2802.919770 30532.6197  1189%     -   15s
H    0     0                    -2757.924981 30532.6197  1207%     -   16s
H    0     0                    -2673.204048 26206.4118  1080%     -   21s
     0     0 26169.9389    0  257 -2673.2040 26169.9389  1079%     -   21s
     0     0 25803.0747    0  259 -2673.2040 25803.0747  1065%     -   22s
     0     0 25803.0747    0  253 -2673.2040 25803.0747  1065%     -   23s
H    0     0                    -2208.308418 25803.0747  1268%     -   25s
     0     0 25803.0747    0  299 -2208.3084 25803.0747  1268%     -   25s
     0     0 25803.0747    0  297 -2208.3084 25803.0747  1268%     -   26s
     0     0 25803.0747    0  264 -2208.3084 25803.0747  1268%     -   26s
     0     0 25803.0747    0  299 -2208.3084 25803.0747  1268%     -   26s
     0     0 23339.1477    0  334 -2208.3084 23339.1477  1157%     -   32s
     0     0 22883.3517    0  347 -2208.3084 22883.3517  1136%     -   34s
     0     0 22799.8470    0  342 -2208.3084 22799.8470  1132%     -   36s
     0     0 22781.6809    0  338 -2208.3084 22781.6809  1132%     -   36s
     0     0 22743.9575    0  338 -2208.3084 22743.9575  1130%     -   37s
     0     0 22723.1901    0  387 -2208.3084 22723.1901  1129%     -   38s
     0     0 22718.5390    0  349 -2208.3084 22718.5390  1129%     -   38s
     0     0 22718.1239    0  348 -2208.3084 22718.1239  1129%     -   38s
H    0     0                     583.4766460 22718.1239  3794%     -   42s
H    0     0                    1064.7572643 22718.1239  2034%     -   42s
H    0     0                    5985.8535598 22718.1239   280%     -   42s
H    0     0                    8528.9364149 22718.1239   166%     -   42s
H    0     0                    9394.0045081 22718.1239   142%     -   42s
H    0     0                    9728.7973878 22718.1239   134%     -   42s
H    0     0                    10580.504989 22718.1239   115%     -   42s
H    0     0                    10808.655199 22718.1239   110%     -   42s
H    0     0                    10836.720746 22718.1239   110%     -   42s
H    0     0                    10893.362343 22718.1239   109%     -   42s
     0     0 21632.7472    0  326 10893.3623 21632.7472  98.6%     -   46s
H    0     0                    11270.465953 21632.6492  91.9%     -   46s
H    0     0                    11276.718661 21632.6492  91.8%     -   46s
H    0     0                    11894.352045 21632.6492  81.9%     -   46s
     0     0 20757.4653    0  324 11894.3520 20757.4653  74.5%     -   50s
     0     0 20522.1668    0  337 11894.3520 20522.1668  72.5%     -   53s
     0     0 20408.9897    0  347 11894.3520 20408.9897  71.6%     -   55s
     0     0 20335.4764    0  353 11894.3520 20335.4764  71.0%     -   57s
     0     0 20303.4098    0  357 11894.3520 20303.4098  70.7%     -   58s
     0     0 20297.8432    0  352 11894.3520 20297.8432  70.7%     -   59s
     0     0 20294.5430    0  355 11894.3520 20294.5430  70.6%     -   59s
     0     0 20291.9906    0  355 11894.3520 20291.9906  70.6%     -   59s
     0     0 20291.5267    0  359 11894.3520 20291.5267  70.6%     -   59s
     0     0 19733.8162    0  354 11894.3520 19733.8162  65.9%     -   66s
     0     0 19559.0172    0  371 11894.3520 19559.0172  64.4%     -   68s
     0     0 19292.8514    0  383 11894.3520 19292.8514  62.2%     -   71s
     0     0 19249.9010    0  384 11894.3520 19249.9010  61.8%     -   72s
     0     0 19218.4585    0  380 11894.3520 19218.4585  61.6%     -   72s
     0     0 19195.0313    0  379 11894.3520 19195.0313  61.4%     -   73s
     0     0 19177.4043    0  382 11894.3520 19177.4043  61.2%     -   74s
     0     0 19173.7864    0  387 11894.3520 19173.7864  61.2%     -   74s
     0     0 19169.5681    0  382 11894.3520 19169.5681  61.2%     -   74s
     0     0 19165.2048    0  393 11894.3520 19165.2048  61.1%     -   75s
     0     0 19150.0257    0  386 11894.3520 19150.0257  61.0%     -   75s
     0     0 19147.1610    0  391 11894.3520 19147.1610  61.0%     -   76s
     0     0 19146.2109    0  388 11894.3520 19146.2109  61.0%     -   76s
     0     0 18947.3250    0  370 11894.3520 18947.3250  59.3%     -   79s
H    0     0                    11989.062361 18947.2643  58.0%     -   80s
H    0     0                    12006.668787 18947.2643  57.8%     -   80s
H    0     0                    12014.544175 18947.2643  57.7%     -   80s
     0     0 18863.8643    0  434 12014.5442 18863.8643  57.0%     -   82s
     0     0 18789.3494    0  381 12014.5442 18789.3494  56.4%     -   83s
     0     0 18773.9910    0  377 12014.5442 18773.9910  56.3%     -   84s
     0     0 18770.8864    0  381 12014.5442 18770.8864  56.2%     -   84s
     0     0 18769.7458    0  385 12014.5442 18769.7458  56.2%     -   85s
     0     0 18701.1217    0  386 12014.5442 18701.1217  55.7%     -   86s
H    0     0                    12209.726354 18700.4942  53.2%     -   88s
H    0     0                    12389.586744 18700.4942  50.9%     -   88s
H    0     0                    12411.223533 18700.4942  50.7%     -   88s
     0     0 18688.7719    0  389 12411.2235 18688.7719  50.6%     -   89s
     0     0 18684.4866    0  382 12411.2235 18684.4866  50.5%     -   89s
     0     0 18675.6727    0  379 12411.2235 18675.6727  50.5%     -   90s
     0     0 18667.4506    0  379 12411.2235 18667.4506  50.4%     -   90s
     0     0 18664.5750    0  387 12411.2235 18664.5750  50.4%     -   91s
     0     0 18663.4732    0  391 12411.2235 18663.4732  50.4%     -   91s
     0     0 18644.3908    0  394 12411.2235 18644.3908  50.2%     -   92s
     0     0 18587.4209    0  397 12411.2235 18587.4209  49.8%     -   94s
     0     0 18580.0187    0  397 12411.2235 18580.0187  49.7%     -   94s
     0     0 18578.0842    0  399 12411.2235 18578.0842  49.7%     -   94s
     0     0 18576.7369    0  396 12411.2235 18576.7369  49.7%     -   95s
     0     0 18533.7174    0  446 12411.2235 18533.7174  49.3%     -   96s
     0     0 18527.1346    0  451 12411.2235 18527.1346  49.3%     -   99s
     0     0 18526.7568    0  449 12411.2235 18526.7568  49.3%     -   99s
     0     0 18512.5091    0  399 12411.2235 18512.5091  49.2%     -  101s
     0     0 18506.9991    0  398 12411.2235 18506.9991  49.1%     -  101s
     0     0 18506.4101    0  405 12411.2235 18506.4101  49.1%     -  102s
     0     0 18497.1590    0  402 12411.2235 18497.1590  49.0%     -  103s
     0     0 18487.3113    0  403 12411.2235 18487.3113  49.0%     -  103s
     0     0 18482.4058    0  405 12411.2235 18482.4058  48.9%     -  104s
     0     0 18481.9003    0  403 12411.2235 18481.9003  48.9%     -  104s
     0     0 18455.3392    0  450 12411.2235 18455.3392  48.7%     -  106s
     0     0 18445.5781    0  450 12411.2235 18445.5781  48.6%     -  107s
     0     0 18440.7451    0  460 12411.2235 18440.7451  48.6%     -  108s
     0     0 18439.0826    0  462 12411.2235 18439.0826  48.6%     -  108s
     0     0 18438.6304    0  462 12411.2235 18438.6304  48.6%     -  108s
     0     0 18424.8880    0  402 12411.2235 18424.8880  48.5%     -  109s
     0     0 18422.8856    0  471 12411.2235 18422.8856  48.4%     -  110s
     0     0 18421.8310    0  464 12411.2235 18421.8310  48.4%     -  110s
     0     0 18416.2436    0  512 12411.2235 18416.2436  48.4%     -  111s
     0     0 18414.2580    0  417 12411.2235 18414.2580  48.4%     -  112s
     0     0 18413.5814    0  414 12411.2235 18413.5814  48.4%     -  112s
     0     0 18412.1204    0  408 12411.2235 18412.1204  48.4%     -  113s
     0     0 18412.1204    0  408 12411.2235 18412.1204  48.4%     -  113s
     0     0 18411.6859    0  412 12411.2235 18411.6859  48.3%     -  113s
     0     0 18410.4978    0  405 12411.2235 18410.4978  48.3%     -  114s
     0     0 18410.3118    0  405 12411.2235 18410.3118  48.3%     -  115s
H    0     0                    12433.677421 18410.1909  48.1%     -  122s
H    0     0                    12460.060927 18410.1909  47.8%     -  122s
H    0     0                    12478.212403 18410.1909  47.5%     -  122s
H    0     0                    12562.120942 18410.1909  46.6%     -  126s
H    0     0                    12660.833240 18410.1909  45.4%     -  126s
     0     2 18410.1909    0  405 12660.8332 18410.1909  45.4%     -  127s
     1     4 18316.6364    1  453 12660.8332 18409.2256  45.4%  1955  130s
     7    16 18087.4096    3  373 12660.8332 18174.4992  43.5%  2413  136s
    15    32 17899.3699    4  433 12660.8332 18086.1425  42.9%  3063  142s
    31    64 17798.0782    5  428 12660.8332 17897.3401  41.4%  3806  147s
    63    96 17750.9233    6  422 12660.8332 17797.6722  40.6%  3449  152s
    95   171 17556.5386    7  422 12660.8332 17797.6722  40.6%  3028  158s
   178   229 17486.5885    8  415 12660.8332 17797.6722  40.6%  2253  164s
   242   285 17153.0286    8  426 12660.8332 17797.6722  40.6%  2345  171s
   307   334 16347.3401    9  368 12660.8332 17797.6722  40.6%  2372  177s
   382   367 16105.6712    9  422 12660.8332 17797.6722  40.6%  2214  183s
   420   427 16084.3419   10  373 12660.8332 17797.6722  40.6%  2189  189s
   502   486 14700.7882   10  338 12660.8332 17750.8330  40.2%  2037  194s
   581   547 15733.6482   11  401 12660.8332 17750.8330  40.2%  1916  201s
   671   594 15659.8057   12  353 12660.8332 17750.8330  40.2%  1800  206s
   746   628 15279.9746   13  338 12660.8332 17750.8330  40.2%  1734  212s
   820   655 15397.1684   13  281 12660.8332 17750.8330  40.2%  1687  219s
   892   695 15161.0356   14  320 12660.8332 17750.8330  40.2%  1653  222s
   962   722 14564.1888   14  386 12660.8332 17560.9309  38.7%  1633  228s
  1027   763 14139.0162   15  291 12660.8332 17560.9309  38.7%  1642  235s
  1090   807 13922.6314   16  302 12660.8332 17560.9309  38.7%  1628  241s
  1164   855 13028.7613   16  225 12660.8332 17560.9309  38.7%  1619  246s
  1246   891 13551.0327   17  299 12660.8332 17209.1687  35.9%  1603  252s
  1336   914 13728.2571   17  214 12660.8332 17209.1687  35.9%  1576  260s
  1441   930 13494.4885   18  225 12660.8332 16859.0400  33.2%  1548  266s
  1535   954 13103.8026   19  236 12660.8332 16827.7843  32.9%  1543  271s
  1639   967 15523.4703    7  296 12660.8332 16827.7843  32.9%  1530  279s
  1745   985 15052.9004   10  336 12660.8332 16681.4992  31.8%  1518  286s
  1866   999     cutoff   13      12660.8332 16653.4452  31.5%  1505  294s
  1916   997     cutoff   12      12660.8332 16580.7830  31.0%  1534  300s
  1996   996 13286.9991   12  199 12660.8332 16580.7830  31.0%  1539  307s
  2077  1009     cutoff   13      12660.8332 16419.8378  29.7%  1548  316s
  2205  1028 12720.9607    9  190 12660.8332 16222.2176  28.1%  1530  322s
  2276  1040 15376.6773   11  388 12660.8332 16063.2012  26.9%  1537  330s
  2379  1050 14249.9031   13  227 12660.8332 16063.2012  26.9%  1547  338s
  2491  1043 12946.8752   15  345 12660.8332 16061.6755  26.9%  1543  346s
  2625  1046     cutoff   16      12660.8332 15956.5833  26.0%  1538  354s
  2727  1060 12961.2782   15  301 12660.8332 15956.5833  26.0%  1542  364s
  2911  1088     cutoff    9      12660.8332 15956.5833  26.0%  1513  372s
  3102  1080     cutoff   10      12660.8332 15826.7051  25.0%  1493  382s
  3282  1091 13527.8562   11  184 12660.8332 15826.7051  25.0%  1490  390s
  3433  1103 13500.5629   11  272 12660.8332 15826.7051  25.0%  1484  400s
  3608  1103     cutoff   15      12660.8332 15617.9379  23.4%  1482  411s
  3785  1116 13112.5639    9  192 12660.8332 15483.5471  22.3%  1487  422s
  3999  1134 infeasible   10      12660.8332 15409.1080  21.7%  1482  431s
  4204  1123 13382.9993   11  158 12660.8332 15382.6554  21.5%  1480  441s
  4459  1122     cutoff   16      12660.8332 15375.2913  21.4%  1466  454s
  4524  1131 13317.6673   16  167 12660.8332 15177.9731  19.9%  1475  472s
  4656  1109 infeasible   17      12660.8332 15177.9731  19.9%  1474  483s
  4840  1079     cutoff   12      12660.8332 15137.1314  19.6%  1469  495s
  5008  1062 12767.7093   13  278 12660.8332 15017.0742  18.6%  1477  505s
  5120  1042     cutoff   14      12660.8332 15017.0742  18.6%  1483  518s
  5299  1021     cutoff   17      12660.8332 14866.0229  17.4%  1491  529s
  5529   956 12898.3182   13  195 12660.8332 14866.0229  17.4%  1494  541s
  5787   874     cutoff   12      12660.8332 14698.0574  16.1%  1521  554s
  6055   787     cutoff   13      12660.8332 14627.0243  15.5%  1516  568s
  6407   665     cutoff   15      12660.8332 14379.3148  13.6%  1502  582s
  6856   386     cutoff   12      12660.8332 14096.8048  11.3%  1472  594s
  7535    91     cutoff   19      12660.8332 13787.6731  8.90%  1399  604s
  8392     2     cutoff   25      12660.8332 13129.6026  3.70%  1284  606s

Cutting planes:
  Implied bound: 15
  MIR: 527
  Flow cover: 812
  RLT: 32
  Relax-and-lift: 69

Explored 8658 nodes (10931483 simplex iterations) in 606.27 seconds (1219.32 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12660.8 12562.1 12478.2 ... 12006.7

Optimal solution found (tolerance 1.00e-04)
Best objective 1.266083324037e+04, best bound 1.266083324037e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 606.29s
  Master Objective (UB) = 12660.83, θ = 140884.96
  Upper Bound (UB) = 12660.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140884.96
  [DEBUG]   ✓ Scenario 0: θ = 140884.96 ≤ Q = 140884.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140884.96 ≤ Q = 140884.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140884.96 ≤ Q = 140884.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140884.96 ≤ Q = 140884.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140884.96 ≤ Q = 140884.96 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x65969438
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x65969438
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.496387e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6667964.8696
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.396779e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139677.90    0  123 6667964.87 -139677.90   102%     -    0s
H    0     0                    -110920.5462 -139677.90  25.9%     -    0s
H    0     0                    -111073.7073 -139677.90  25.8%     -    0s
H    0     0                    -115832.3270 -139677.90  20.6%     -    0s
     0     0 -125649.46    0   97 -115832.33 -125649.46  8.48%     -    0s
H    0     0                    -122513.1818 -125545.50  2.48%     -    0s
     0     0 -124676.72    0   95 -122513.18 -124676.72  1.77%     -    0s
H    0     0                    -123177.9092 -124666.74  1.21%     -    0s
H    0     0                    -123323.9924 -124581.33  1.02%     -    0s
H    0     0                    -123356.0933 -124581.33  0.99%     -    0s
     0     0 -124581.33    0   79 -123356.09 -124581.33  0.99%     -    0s
     0     0 -124561.18    0   91 -123356.09 -124561.18  0.98%     -    0s
     0     0 -124021.98    0   62 -123356.09 -124021.98  0.54%     -    0s
     0     0 -123875.51    0   46 -123356.09 -123875.51  0.42%     -    0s
     0     0 -123864.47    0   45 -123356.09 -123864.47  0.41%     -    0s
     0     0 -123658.33    0   21 -123356.09 -123658.33  0.25%     -    0s
     0     0 -123649.83    0   18 -123356.09 -123649.83  0.24%     -    0s
     0     0 -123635.93    0   22 -123356.09 -123635.93  0.23%     -    0s
     0     0 -123513.98    0   13 -123356.09 -123513.98  0.13%     -    0s
     0     0 -123498.76    0   12 -123356.09 -123498.76  0.12%     -    0s
H    0     0                    -123372.6710 -123498.76  0.10%     -    0s
     0     0 -123498.76    0   15 -123372.67 -123498.76  0.10%     -    0s
     0     0 -123472.18    0   18 -123372.67 -123472.18  0.08%     -    0s
     0     0 -123467.97    0   12 -123372.67 -123467.97  0.08%     -    0s
H    0     0                    -123386.5484 -123467.97  0.07%     -    0s
     0     0 -123420.43    0    4 -123386.55 -123420.43  0.03%     -    0s
H    0     0                    -123397.6250 -123419.61  0.02%     -    0s
H    0     0                    -123397.7984 -123419.61  0.02%     -    0s
*    0     0               0    -123417.7969 -123417.80  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 4
  MIR: 2
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (940 simplex iterations) in 0.16 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -123418 -123398 -123398 ... -115832
No other solutions better than -123418

Optimal solution found (tolerance 1.00e-04)
Best objective -1.234177969355e+05, best bound -1.234177969355e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 129736.41
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123417.80
  [DEBUG]   S×d_nominal = 253154.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253154.21 + -123417.80 = 129736.41
  [DEBUG]   Current θ from Master = 140884.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11148.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1512.28
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 7055.9766, Absolute Gap = 7055.9766, Relative Gap = 0.557307
  Not converged yet (gap = 7055.98 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264761 nonzeros
Model fingerprint: 0x5a0ba32e
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47268 rows and 19188 columns
Presolve time: 1.77s
Presolved: 45855 rows, 20512 columns, 284099 nonzeros
Variable types: 18253 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -170240.0806

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 45855 rows, 20512 columns, 284099 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25532   -7.3249709e+04   0.000000e+00   2.115968e+07      5s
   38193    1.0721632e+04   0.000000e+00   7.799347e+07     10s
   47826    1.9764367e+04   0.000000e+00   1.656208e+07     15s
   55735    2.5587357e+04   0.000000e+00   8.890602e+05     20s
Concurrent spin time: 0.42s

Solved with dual simplex

Root relaxation: objective 3.053254e+04, 32261 iterations, 19.34 seconds (25.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30532.5409    0  217 -170240.08 30532.5409   118%     -   21s
H    0     0                    -163865.0032 30532.5409   119%     -   21s
H    0     0                    -64574.00534 30532.5409   147%     -   21s
H    0     0                    -64437.02800 30532.5409   147%     -   21s
H    0     0                    -54842.33381 30532.5409   156%     -   22s
H    0     0                    -52580.77066 30532.5409   158%     -   22s
H    0     0                    -51599.42628 30532.5409   159%     -   22s
H    0     0                    -34706.62066 30532.5409   188%     -   22s
H    0     0                    -18147.17916 30532.5409   268%     -   23s
H    0     0                    -17851.07548 30532.5409   271%     -   23s
H    0     0                    -16325.10061 30532.5409   287%     -   23s
     0     0 26172.1003    0  256 -16325.101 26172.1003   260%     -   33s
H    0     0                    -16039.04816 26170.4213   263%     -   34s
H    0     0                    -15266.65787 26170.4213   271%     -   34s
H    0     0                    -14225.71591 26170.4213   284%     -   34s
H    0     0                    -14186.35985 26170.4213   284%     -   34s
H    0     0                    -14067.57892 26170.4213   286%     -   34s
     0     0 25780.9787    0  265 -14067.579 25780.9787   283%     -   39s
     0     0 25780.9787    0  267 -14067.579 25780.9787   283%     -   40s
     0     0 25780.9787    0  265 -14067.579 25780.9787   283%     -   41s
     0     0 25780.9787    0  265 -14067.579 25780.9787   283%     -   41s
     0     0 23467.8209    0  336 -14067.579 23467.8209   267%     -   50s
H    0     0                    -13018.69930 23466.6768   280%     -   50s
H    0     0                    -12632.88474 23466.6768   286%     -   50s
H    0     0                    -12616.90058 23466.6768   286%     -   50s
H    0     0                    -5751.275355 23466.6768   508%     -   50s
     0     0 22977.6531    0  375 -5751.2754 22977.6531   500%     -   56s
     0     0 22895.4214    0  342 -5751.2754 22895.4214   498%     -   58s
     0     0 22864.1564    0  336 -5751.2754 22864.1564   498%     -   59s
     0     0 22851.9736    0  382 -5751.2754 22851.9736   497%     -   60s
     0     0 22806.5532    0  337 -5751.2754 22806.5532   497%     -   62s
     0     0 22792.1469    0  345 -5751.2754 22792.1469   496%     -   64s
     0     0 22787.2228    0  391 -5751.2754 22787.2228   496%     -   65s
     0     0 22786.6873    0  394 -5751.2754 22786.6873   496%     -   65s
H    0     0                    -710.5804981 22786.6873  3307%     -   70s
H    0     0                    -698.6589026 22786.6873  3361%     -   70s
H    0     0                    -141.8535249 22786.6873      -     -   70s
H    0     0                    -126.4584395 22786.6873      -     -   70s
H    0     0                     610.9752070 22786.6873  3630%     -   70s
H    0     0                     635.1695731 22786.6873  3487%     -   70s
     0     0 21075.7826    0  321  635.16957 21075.7826  3218%     -   77s
     0     0 20793.0670    0  371  635.16957 20793.0670  3174%     -   81s
H    0     0                    6762.0522641 20633.9195   205%     -   84s
H    0     0                    7831.5939721 20633.9195   163%     -   84s
H    0     0                    10020.819408 20633.9195   106%     -   84s
H    0     0                    10022.525854 20633.9195   106%     -   84s
H    0     0                    10064.641371 20633.9195   105%     -   84s
H    0     0                    10115.639021 20633.9195   104%     -   84s
H    0     0                    10130.756734 20633.9195   104%     -   84s
H    0     0                    10159.799412 20633.9195   103%     -   84s
     0     0 20633.9195    0  326 10159.7994 20633.9195   103%     -   84s
     0     0 20563.6871    0  337 10159.7994 20563.6871   102%     -   85s
     0     0 20549.4424    0  335 10159.7994 20549.4424   102%     -   86s
     0     0 20537.4282    0  342 10159.7994 20537.4282   102%     -   87s
     0     0 20536.3143    0  346 10159.7994 20536.3143   102%     -   87s
     0     0 20523.6820    0  352 10159.7994 20523.6820   102%     -   87s
     0     0 20520.9821    0  348 10159.7994 20520.9821   102%     -   88s
     0     0 20520.8907    0  348 10159.7994 20520.8907   102%     -   88s
     0     0 19774.9397    0  357 10159.7994 19774.9397  94.6%     -   96s
     0     0 19635.3230    0  348 10159.7994 19635.3230  93.3%     -   99s
     0     0 19496.7374    0  344 10159.7994 19496.7374  91.9%     -  102s
     0     0 19408.9467    0  350 10159.7994 19408.9467  91.0%     -  104s
     0     0 19352.9324    0  340 10159.7994 19352.9324  90.5%     -  106s
     0     0 19336.2675    0  358 10159.7994 19336.2675  90.3%     -  108s
     0     0 19326.0217    0  364 10159.7994 19326.0217  90.2%     -  108s
     0     0 19317.1685    0  367 10159.7994 19317.1685  90.1%     -  109s
     0     0 19313.9047    0  362 10159.7994 19313.9047  90.1%     -  109s
     0     0 19313.0140    0  362 10159.7994 19313.0140  90.1%     -  110s
H    0     0                    10379.300296 19067.0900  83.7%     -  114s
H    0     0                    10618.587756 19067.0900  79.6%     -  114s
     0     0 19067.0900    0  372 10618.5878 19067.0900  79.6%     -  114s
H    0     0                    11033.523555 19066.2237  72.8%     -  115s
H    0     0                    11044.784270 19066.2237  72.6%     -  115s
H    0     0                    11053.866188 19066.2237  72.5%     -  115s
H    0     0                    11219.243385 19066.2237  69.9%     -  115s
     0     0 18935.2734    0  379 11219.2434 18935.2734  68.8%     -  118s
     0     0 18905.4934    0  377 11219.2434 18905.4934  68.5%     -  120s
     0     0 18901.0483    0  390 11219.2434 18901.0483  68.5%     -  121s
     0     0 18896.9650    0  379 11219.2434 18896.9650  68.4%     -  121s
     0     0 18891.9894    0  378 11219.2434 18891.9894  68.4%     -  122s
     0     0 18890.9381    0  384 11219.2434 18890.9381  68.4%     -  122s
     0     0 18786.9835    0  375 11219.2434 18786.9835  67.5%     -  125s
H    0     0                    11844.765077 18786.7258  58.6%     -  126s
H    0     0                    11865.454796 18786.7258  58.3%     -  126s
H    0     0                    11869.062779 18786.7258  58.3%     -  126s
H    0     0                    11889.346288 18786.7258  58.0%     -  126s
H    0     0                    11901.318153 18786.7258  57.9%     -  126s
     0     0 18756.5742    0  378 11901.3182 18756.5742  57.6%     -  127s
     0     0 18700.0661    0  363 11901.3182 18700.0661  57.1%     -  128s
     0     0 18673.2699    0  374 11901.3182 18673.2699  56.9%     -  130s
     0     0 18669.7759    0  376 11901.3182 18669.7759  56.9%     -  130s
     0     0 18667.6654    0  382 11901.3182 18667.6654  56.9%     -  131s
     0     0 18661.4104    0  383 11901.3182 18661.4104  56.8%     -  131s
     0     0 18657.9840    0  380 11901.3182 18657.9840  56.8%     -  132s
     0     0 18656.1512    0  385 11901.3182 18656.1512  56.8%     -  132s
     0     0 18655.7335    0  381 11901.3182 18655.7335  56.8%     -  133s
     0     0 18572.9713    0  388 11901.3182 18572.9713  56.1%     -  136s
     0     0 18555.8244    0  390 11901.3182 18555.8244  55.9%     -  137s
     0     0 18534.9887    0  384 11901.3182 18534.9887  55.7%     -  138s
     0     0 18531.6232    0  393 11901.3182 18531.6232  55.7%     -  139s
     0     0 18531.0284    0  386 11901.3182 18531.0284  55.7%     -  139s
     0     0 18498.8653    0  390 11901.3182 18498.8653  55.4%     -  141s
H    0     0                    12046.337758 18498.8243  53.6%     -  141s
H    0     0                    12051.360890 18498.8243  53.5%     -  142s
     0     0 18490.7794    0  396 12051.3609 18490.7794  53.4%     -  143s
     0     0 18482.6791    0  438 12051.3609 18482.6791  53.4%     -  143s
     0     0 18479.7651    0  447 12051.3609 18479.7651  53.3%     -  144s
     0     0 18479.2891    0  442 12051.3609 18479.2891  53.3%     -  145s
     0     0 18466.2758    0  437 12051.3609 18466.2758  53.2%     -  146s
     0     0 18463.1445    0  438 12051.3609 18463.1445  53.2%     -  147s
     0     0 18460.8005    0  436 12051.3609 18460.8005  53.2%     -  147s
     0     0 18457.4031    0  437 12051.3609 18457.4031  53.2%     -  147s
     0     0 18456.6920    0  436 12051.3609 18456.6920  53.2%     -  148s
     0     0 18445.8092    0  393 12051.3609 18445.8092  53.1%     -  149s
     0     0 18444.5284    0  391 12051.3609 18444.5284  53.0%     -  150s
     0     0 18440.0239    0  386 12051.3609 18440.0239  53.0%     -  151s
     0     0 18438.8311    0  385 12051.3609 18438.8311  53.0%     -  151s
     0     0 18434.2202    0  434 12051.3609 18434.2202  53.0%     -  153s
     0     0 18432.5955    0  436 12051.3609 18432.5955  53.0%     -  153s
     0     0 18432.5161    0  438 12051.3609 18432.5161  52.9%     -  153s
     0     0 18431.2844    0  435 12051.3609 18431.2844  52.9%     -  154s
     0     0 18430.4325    0  435 12051.3609 18430.4325  52.9%     -  155s
H    0     0                    12116.077266 18429.9930  52.1%     -  176s
     0     2 18429.9930    0  435 12116.0773 18429.9930  52.1%     -  177s
     3     8 18238.9818    2  383 12116.0773 18376.8769  51.7%  3386  183s
     7    16 17979.3067    3  425 12116.0773 18346.4386  51.4%  3678  188s
    15    32 17778.2448    4  376 12116.0773 18116.0853  49.5%  4008  198s
    31    52 16554.3792    5  278 12116.0773 17981.1589  48.4%  6873  211s
H   34    52                    12122.722163 17981.1589  48.3%  6699  211s
    51    82 15709.0145    6  341 12122.7222 17981.1589  48.3%  6576  219s
    83   209 15670.4824    7  338 12122.7222 17981.1589  48.3%  5565  229s
H  161   209                    12506.097853 17981.1589  43.8%  3679  229s
   216   258 15231.4735   12  318 12506.0979 17981.1589  43.8%  3112  235s
   302   281 15133.0155   13  317 12506.0979 17981.1589  43.8%  2751  244s
H  304   281                    12633.981289 17981.1589  42.3%  2754  244s
   340   318 infeasible   11      12633.9813 17981.1589  42.3%  2708  253s
   415   361 14831.3045   13  326 12633.9813 17981.1589  42.3%  2515  263s
   489   399     cutoff   13      12633.9813 17981.1589  42.3%  2383  271s
   572   436 13772.2714   14  276 12633.9813 17981.1589  42.3%  2249  280s
   647   460 13490.9338   14  313 12633.9813 17981.1589  42.3%  2163  289s
   704   507 13278.4746   14  312 12633.9813 17981.1589  42.3%  2134  295s
   771   527 13574.0998   16  322 12633.9813 17649.4182  39.7%  2070  303s
   817   555     cutoff   17      12633.9813 17648.6595  39.7%  2076  313s
   865   577 15140.1983    8  337 12633.9813 17648.6595  39.7%  2082  320s
   936   604 13722.2388    9  317 12633.9813 17607.4556  39.4%  2054  326s
   991   645 13668.9703   10  318 12633.9813 17607.4556  39.4%  2047  335s
  1050   689     cutoff   11      12633.9813 17607.4556  39.4%  2040  340s
  1116   736     cutoff   10      12633.9813 17607.4556  39.4%  2035  347s
  1194   770 12999.1430    9  249 12633.9813 17607.4556  39.4%  2019  357s
  1269   814 12833.0528   10  237 12633.9813 17607.4556  39.4%  1995  366s
  1353   855     cutoff    7      12633.9813 17607.4556  39.4%  1988  374s
  1442   922 14154.5390    9  168 12633.9813 17607.4556  39.4%  1976  383s
  1565   971 13322.3116   14   91 12633.9813 17607.4556  39.4%  1936  394s
  1678  1013 13062.5993   18   78 12633.9813 16998.0241  34.5%  1909  404s
  1804  1058     cutoff   20      12633.9813 16945.9637  34.1%  1867  412s
  1931  1065 12743.0258    8  316 12633.9813 16945.9637  34.1%  1846  423s
  2045  1080     cutoff    8      12633.9813 16836.2782  33.3%  1847  431s
  2134  1098     cutoff    9      12633.9813 16664.1617  31.9%  1856  443s
  2246  1122     cutoff    9      12633.9813 16542.8479  30.9%  1872  454s
  2357  1131     cutoff   13      12633.9813 16542.8479  30.9%  1886  465s
  2506  1132 14512.8581   12  211 12633.9813 16542.8479  30.9%  1872  479s
  2605  1179 13693.1146   14  207 12633.9813 16542.8479  30.9%  1876  490s
  2752  1183 13714.3632   17  212 12633.9813 15985.4075  26.5%  1871  500s
  2871  1220 13637.3446   18  210 12633.9813 15985.4075  26.5%  1866  511s
  3042  1238 13328.3216   22  247 12633.9813 15985.4075  26.5%  1852  521s
  3102  1265 13256.6662   23  234 12633.9813 15985.4075  26.5%  1852  532s
  3241  1322 15034.1929   13  301 12633.9813 15900.0303  25.9%  1833  545s
  3398  1375     cutoff   15      12633.9813 15900.0303  25.9%  1808  559s
  3611  1384 infeasible   13      12633.9813 15754.6395  24.7%  1782  572s
  3812  1381 13962.6227    8  245 12633.9813 15706.8914  24.3%  1776  585s
  3991  1423 13402.6947   11  246 12633.9813 15460.7477  22.4%  1788  596s
  4121  1452 12902.3552   14  183 12633.9813 15460.7477  22.4%  1787  610s
  4403  1471 13709.8061   19  301 12633.9813 15447.3847  22.3%  1757  623s
  4580  1487     cutoff   20      12633.9813 15447.3847  22.3%  1759  637s
  4814  1485 13348.0333   13  227 12633.9813 15172.2403  20.1%  1759  653s
  5066  1498 13652.6162   11  236 12633.9813 15109.1640  19.6%  1755  668s
  5343  1519     cutoff   13      12633.9813 15109.1640  19.6%  1750  684s
  5657  1499 14048.6057   24  272 12633.9813 14794.0198  17.1%  1735  700s
  5928  1475 13420.7991   28  239 12633.9813 14794.0198  17.1%  1734  719s
  6185  1419     cutoff   18      12633.9813 14592.3697  15.5%  1740  738s
  6461  1370 13494.4333   17  291 12633.9813 14477.7733  14.6%  1748  758s
  6704  1287 infeasible   16      12633.9813 14393.2929  13.9%  1761  778s
  7037  1193     cutoff   20      12633.9813 14289.2378  13.1%  1759  796s
  7328  1050     cutoff   14      12633.9813 14184.3571  12.3%  1758  816s
  7686   836 13123.9522   11  297 12633.9813 14010.4052  10.9%  1755  836s
  8097   551     cutoff   22      12633.9813 13870.4578  9.79%  1747  856s
  8609   169     cutoff   17      12633.9813 13678.7984  8.27%  1723  875s
  9292     0     cutoff   18      12633.9813 13446.6649  6.43%  1650  883s

Cutting planes:
  Implied bound: 13
  MIR: 687
  Flow cover: 863
  RLT: 27
  Relax-and-lift: 58

Explored 9579 nodes (15618347 simplex iterations) in 883.19 seconds (1802.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12634 12506.1 12122.7 ... 11865.5

Optimal solution found (tolerance 1.00e-04)
Best objective 1.263398128858e+04, best bound 1.263398128858e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 883.22s
  Master Objective (UB) = 12633.98, θ = 141697.83
  Upper Bound (UB) = 12633.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141697.83
  [DEBUG]   ✓ Scenario 0: θ = 141697.83 ≤ Q = 141697.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141697.83 ≤ Q = 141697.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141697.83 ≤ Q = 141697.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141697.83 ≤ Q = 141697.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141697.83 ≤ Q = 141697.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141697.83 ≤ Q = 141697.83 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6f2d21ee
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x90d2de12
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6664759.5157
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.403420e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140342.04    0  126 6664759.52 -140342.04   102%     -    0s
H    0     0                    -109229.5398 -140342.04  28.5%     -    0s
H    0     0                    -109909.1381 -140342.04  27.7%     -    0s
H    0     0                    -116389.8608 -140342.04  20.6%     -    0s
     0     0 -122463.83    0  120 -116389.86 -122463.83  5.22%     -    0s
H    0     0                    -119217.0608 -122360.26  2.64%     -    0s
     0     0 -122184.22    0  115 -119217.06 -122184.22  2.49%     -    0s
     0     0 -121078.69    0  106 -119217.06 -121078.69  1.56%     -    0s
     0     0 -120927.19    0  105 -119217.06 -120927.19  1.43%     -    0s
     0     0 -120438.05    0  106 -119217.06 -120438.05  1.02%     -    0s
     0     0 -120389.08    0  105 -119217.06 -120389.08  0.98%     -    0s
     0     0 -120371.45    0  106 -119217.06 -120371.45  0.97%     -    0s
     0     0 -120185.51    0   96 -119217.06 -120185.51  0.81%     -    0s
     0     0 -120154.85    0   94 -119217.06 -120154.85  0.79%     -    0s
     0     0 -120039.01    0   90 -119217.06 -120039.01  0.69%     -    0s
     0     0 -120036.38    0   90 -119217.06 -120036.38  0.69%     -    0s
     0     2 -120035.97    0   90 -119217.06 -120035.97  0.69%     -    0s
H  348    40                    -119232.2390 -119494.59  0.22%   6.6    0s

Cutting planes:
  Gomory: 57
  Implied bound: 8
  MIR: 203
  Flow cover: 7
  RLT: 25

Explored 679 nodes (4684 simplex iterations) in 0.24 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -119232 -119217 -116390 ... 1.48645e+13
No other solutions better than -119232

Optimal solution found (tolerance 1.00e-04)
Best objective -1.192322390149e+05, best bound -1.192322390149e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 133554.96
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119232.24
  [DEBUG]   S×d_nominal = 252787.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252787.20 + -119232.24 = 133554.96
  [DEBUG]   Current θ from Master = 141697.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8142.88 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4491.10
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 7029.1247, Absolute Gap = 7029.1247, Relative Gap = 0.556367
  Not converged yet (gap = 7029.12 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 307968 nonzeros
Model fingerprint: 0x0a2aca61
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55146 rows and 22386 columns
Presolve time: 1.61s
Presolved: 53267 rows, 23554 columns, 330529 nonzeros
Variable types: 21295 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53267 rows, 23554 columns, 330529 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22457   -7.0952606e+04   0.000000e+00   3.843522e+07      5s
   34415    1.7830079e+04   0.000000e+00   5.043718e+06     10s
   42003    2.3982039e+04   0.000000e+00   2.790867e+06     15s
   48286    2.4977719e+04   0.000000e+00   5.192859e+06     20s
Concurrent spin time: 4.57s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.961860e+04, 43286 iterations, 21.90 seconds (29.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 29618.5971    0  219 -179468.78 29618.5971   117%     -   24s
H    0     0                    -173093.7051 29618.5971   117%     -   24s
H    0     0                    -152043.6865 29618.5971   119%     -   24s
H    0     0                    -84125.90596 29618.5971   135%     -   24s
H    0     0                    -80627.21723 29618.5971   137%     -   24s
H    0     0                    -77810.28338 29618.5971   138%     -   24s
H    0     0                    -76144.65399 29618.5971   139%     -   24s
H    0     0                    -76115.01287 29618.5971   139%     -   24s
H    0     0                    -75951.82984 29618.5971   139%     -   24s
H    0     0                    -74783.45390 29618.5971   140%     -   24s
H    0     0                    -36935.38196 29618.5971   180%     -   24s
H    0     0                    -34766.29825 29618.5971   185%     -   25s
H    0     0                    -34626.53122 29618.5971   186%     -   25s
H    0     0                    -16002.71279 29618.5971   285%     -   25s
H    0     0                    -15386.68995 29618.5971   292%     -   25s
H    0     0                    -15313.42931 29618.5971   293%     -   25s
H    0     0                    -13050.12147 29618.5971   327%     -   25s
H    0     0                    -13032.88135 29618.5971   327%     -   25s
H    0     0                    -12861.80790 29618.5971   330%     -   25s
H    0     0                    -12844.56778 29618.5971   331%     -   25s
     0     0 25031.0037    0  226 -12844.568 25031.0037   295%     -   33s
H    0     0                    -8364.592116 25031.0037   399%     -   33s
H    0     0                    -7743.465669 25031.0037   423%     -   33s
H    0     0                    -6499.624818 25031.0037   485%     -   33s
     0     0 24779.3676    0  233 -6499.6248 24779.3676   481%     -   35s
     0     0 24120.8213    0  239 -6499.6248 24120.8213   471%     -   37s
     0     0 24042.0383    0  238 -6499.6248 24042.0383   470%     -   38s
     0     0 24042.0383    0  237 -6499.6248 24042.0383   470%     -   40s
     0     0 24042.0383    0  239 -6499.6248 24042.0383   470%     -   40s
     0     0 21761.4068    0  327 -6499.6248 21761.4068   435%     -   47s
H    0     0                    -6218.410057 21761.4068   450%     -   47s
H    0     0                    -5112.238363 21761.4068   526%     -   47s
H    0     0                    -4761.753698 21761.4068   557%     -   48s
H    0     0                    -4732.937558 21761.4068   560%     -   48s
H    0     0                    -3265.321813 21450.9971   757%     -   51s
H    0     0                    -3096.389753 21450.9971   793%     -   51s
H    0     0                    -3047.994615 21450.9971   804%     -   51s
     0     0 21450.9971    0  380 -3047.9946 21450.9971   804%     -   51s
     0     0 21416.4642    0  371 -3047.9946 21416.4642   803%     -   52s
     0     0 21403.9697    0  372 -3047.9946 21403.9697   802%     -   52s
     0     0 21372.1916    0  385 -3047.9946 21372.1916   801%     -   53s
     0     0 21352.9172    0  378 -3047.9946 21352.9172   801%     -   54s
     0     0 21335.2531    0  374 -3047.9946 21335.2531   800%     -   54s
     0     0 21304.8380    0  378 -3047.9946 21304.8380   799%     -   55s
     0     0 21295.0010    0  378 -3047.9946 21295.0010   799%     -   56s
     0     0 21233.1507    0  376 -3047.9946 21233.1507   797%     -   57s
     0     0 21219.8290    0  377 -3047.9946 21219.8290   796%     -   57s
     0     0 21211.5027    0  376 -3047.9946 21211.5027   796%     -   58s
     0     0 21189.6384    0  374 -3047.9946 21189.6384   795%     -   58s
     0     0 21185.9117    0  381 -3047.9946 21185.9117   795%     -   59s
     0     0 21184.7486    0  378 -3047.9946 21184.7486   795%     -   59s
     0     0 21184.2903    0  378 -3047.9946 21184.2903   795%     -   59s
H    0     0                    -139.0925831 21184.2903      -     -   64s
H    0     0                     301.4948131 21184.2903  6926%     -   64s
H    0     0                     349.7057442 21184.2903  5958%     -   64s
     0     0 19553.9278    0  336  349.70574 19553.9278  5492%     -   70s
H    0     0                    4424.5063725 18840.5212   326%     -   77s
H    0     0                    5673.3259744 18840.5212   232%     -   77s
     0     0 18840.5212    0  345 5673.32597 18840.5212   232%     -   77s
H    0     0                    7260.3509351 18721.2727   158%     -   79s
H    0     0                    7952.5522967 18721.2727   135%     -   79s
H    0     0                    8005.7002841 18721.2727   134%     -   79s
H    0     0                    8014.4210739 18721.2727   134%     -   79s
H    0     0                    8037.9055667 18721.2727   133%     -   79s
H    0     0                    8055.9807620 18721.2727   132%     -   79s
     0     0 18721.2727    0  364 8055.98076 18721.2727   132%     -   79s
H    0     0                    8229.1196799 18634.3614   126%     -   81s
H    0     0                    8229.4066433 18634.3614   126%     -   81s
H    0     0                    8229.7505271 18634.3614   126%     -   81s
     0     0 18634.3614    0  366 8229.75053 18634.3614   126%     -   81s
H    0     0                    8257.5083295 18557.6706   125%     -   83s
H    0     0                    8490.5486468 18557.6706   119%     -   83s
H    0     0                    8605.8175211 18557.6706   116%     -   83s
H    0     0                    8793.0852941 18557.6706   111%     -   83s
H    0     0                    8986.6502586 18557.6706   107%     -   83s
H    0     0                    9009.5067723 18557.6706   106%     -   83s
H    0     0                    9036.5516119 18557.6706   105%     -   83s
     0     0 18557.6706    0  365 9036.55161 18557.6706   105%     -   83s
     0     0 18486.4359    0  361 9036.55161 18486.4359   105%     -   86s
     0     0 18460.1619    0  362 9036.55161 18460.1619   104%     -   87s
     0     0 18453.3973    0  359 9036.55161 18453.3973   104%     -   87s
     0     0 18440.6238    0  365 9036.55161 18440.6238   104%     -   88s
     0     0 18440.4281    0  364 9036.55161 18440.4281   104%     -   88s
     0     0 17972.7936    0  371 9036.55161 17972.7936  98.9%     -   96s
     0     0 17756.5813    0  378 9036.55161 17756.5813  96.5%     -  100s
     0     0 17720.7567    0  377 9036.55161 17720.7567  96.1%     -  102s
     0     0 17628.9536    0  374 9036.55161 17628.9536  95.1%     -  104s
     0     0 17612.4371    0  378 9036.55161 17612.4371  94.9%     -  105s
     0     0 17606.0281    0  373 9036.55161 17606.0281  94.8%     -  106s
     0     0 17599.0996    0  376 9036.55161 17599.0996  94.8%     -  107s
     0     0 17592.2085    0  373 9036.55161 17592.2085  94.7%     -  108s
     0     0 17590.7043    0  417 9036.55161 17590.7043  94.7%     -  108s
H    0     0                    9038.5667510 17587.4468  94.6%     -  109s
H    0     0                    9051.0055828 17587.4468  94.3%     -  109s
     0     0 17587.4468    0  419 9051.00558 17587.4468  94.3%     -  109s
     0     0 17585.9911    0  372 9051.00558 17585.9911  94.3%     -  109s
     0     0 17582.2682    0  362 9051.00558 17582.2682  94.3%     -  110s
     0     0 17580.1965    0  373 9051.00558 17580.1965  94.2%     -  110s
     0     0 17579.0117    0  374 9051.00558 17579.0117  94.2%     -  111s
     0     0 17504.9724    0  417 9051.00558 17504.9724  93.4%     -  114s
H    0     0                    9054.6883009 17504.9387  93.3%     -  114s
H    0     0                    9156.8670157 17504.9387  91.2%     -  114s
H    0     0                    9178.0810377 17504.9387  90.7%     -  114s
H    0     0                    9305.0738926 17504.9387  88.1%     -  114s
H    0     0                    9390.1634576 17504.9387  86.4%     -  114s
     0     0 17472.8161    0  367 9390.16346 17472.8161  86.1%     -  115s
     0     0 17457.5391    0  375 9390.16346 17457.5391  85.9%     -  116s
     0     0 17448.5388    0  377 9390.16346 17448.5388  85.8%     -  117s
     0     0 17446.8038    0  375 9390.16346 17446.8038  85.8%     -  118s
     0     0 17446.2556    0  428 9390.16346 17446.2556  85.8%     -  118s
     0     0 17415.1735    0  419 9390.16346 17415.1735  85.5%     -  120s
H    0     0                    9404.8193260 17415.0531  85.2%     -  121s
H    0     0                    9702.3048033 17415.0531  79.5%     -  121s
H    0     0                    9718.8165687 17415.0531  79.2%     -  121s
H    0     0                    9762.5028642 17415.0531  78.4%     -  121s
H    0     0                    9856.8061798 17415.0531  76.7%     -  121s
     0     0 17409.2155    0  426 9856.80618 17409.2155  76.6%     -  122s
     0     0 17400.8630    0  433 9856.80618 17400.8630  76.5%     -  123s
     0     0 17392.9810    0  431 9856.80618 17392.9810  76.5%     -  123s
     0     0 17388.1230    0  433 9856.80618 17388.1230  76.4%     -  124s
     0     0 17387.5689    0  438 9856.80618 17387.5689  76.4%     -  124s
     0     0 17353.0387    0  429 9856.80618 17353.0387  76.1%     -  126s
     0     0 17347.6231    0  441 9856.80618 17347.6231  76.0%     -  127s
     0     0 17345.6407    0  447 9856.80618 17345.6407  76.0%     -  127s
     0     0 17345.4052    0  446 9856.80618 17345.4052  76.0%     -  127s
     0     0 17326.3742    0  435 9856.80618 17326.3742  75.8%     -  129s
H    0     0                    9920.6289964 17325.7462  74.6%     -  129s
H    0     0                    9930.2143854 17325.7462  74.5%     -  129s
H    0     0                    9945.8538229 17325.7462  74.2%     -  129s
     0     0 17320.2465    0  441 9945.85382 17320.2465  74.1%     -  130s
     0     0 17314.7878    0  435 9945.85382 17314.7878  74.1%     -  131s
     0     0 17313.2150    0  436 9945.85382 17313.2150  74.1%     -  131s
     0     0 17312.7475    0  447 9945.85382 17312.7475  74.1%     -  132s
     0     0 17306.5414    0  436 9945.85382 17306.5414  74.0%     -  133s
     0     0 17304.1715    0  388 9945.85382 17304.1715  74.0%     -  134s
     0     0 17301.1561    0  385 9945.85382 17301.1561  74.0%     -  134s
     0     0 17299.9244    0  390 9945.85382 17299.9244  73.9%     -  135s
     0     0 17290.1855    0  392 9945.85382 17290.1855  73.8%     -  136s
H    0     0                    9974.2561409 17289.5314  73.3%     -  138s
     0     0 17282.9371    0  399 9974.25614 17282.9371  73.3%     -  139s
     0     0 17276.6550    0  449 9974.25614 17276.6550  73.2%     -  139s
     0     0 17275.9385    0  401 9974.25614 17275.9385  73.2%     -  140s
     0     0 17271.5449    0  391 9974.25614 17271.5449  73.2%     -  141s
H    0     0                    9982.0012396 17271.0120  73.0%     -  141s
     0     0 17266.5374    0  450 9982.00124 17266.5374  73.0%     -  141s
     0     0 17264.8798    0  444 9982.00124 17264.8798  73.0%     -  142s
     0     0 17264.6233    0  401 9982.00124 17264.6233  73.0%     -  142s
     0     0 17261.2816    0  401 9982.00124 17261.2816  72.9%     -  143s
     0     0 17259.5059    0  456 9982.00124 17259.5059  72.9%     -  145s
     0     0 17258.9678    0  458 9982.00124 17258.9678  72.9%     -  145s
     0     0 17248.2361    0  451 9982.00124 17248.2361  72.8%     -  147s
     0     0 17245.3522    0  458 9982.00124 17245.3522  72.8%     -  148s
     0     0 17244.0924    0  457 9982.00124 17244.0924  72.8%     -  148s
     0     0 17229.5723    0  445 9982.00124 17229.5723  72.6%     -  150s
     0     0 17217.0318    0  450 9982.00124 17217.0318  72.5%     -  151s
     0     0 17215.5042    0  450 9982.00124 17215.5042  72.5%     -  152s
     0     0 17213.8745    0  449 9982.00124 17213.8745  72.4%     -  152s
     0     0 17213.2323    0  450 9982.00124 17213.2323  72.4%     -  152s
     0     0 17212.3562    0  450 9982.00124 17212.3562  72.4%     -  153s
     0     0 17211.9253    0  450 9982.00124 17211.9253  72.4%     -  154s
     0     0 17211.5603    0  457 9982.00124 17211.5603  72.4%     -  155s
     0     0 17211.2765    0  454 9982.00124 17211.2765  72.4%     -  155s
     0     0 17211.0934    0  451 9982.00124 17211.0934  72.4%     -  156s
     0     0 17210.7081    0  454 9982.00124 17210.7081  72.4%     -  157s
     0     0 17210.7081    0  457 9982.00124 17210.7081  72.4%     -  158s
     0     0 17210.5071    0  457 9982.00124 17210.5071  72.4%     -  159s
     0     2 17209.6325    0  457 9982.00124 17209.6325  72.4%     -  202s
     1     4 17132.0589    1  447 9982.00124 17209.6325  72.4%  2834  206s
     3     8 17032.6035    2  449 9982.00124 17129.1091  71.6%  4075  213s
     7    16 16982.0901    3  457 9982.00124 17032.5775  70.6%  5526  217s
    15    32 16808.9300    4  417 9982.00124 16981.7246  70.1%  5297  225s
    31    50 16006.3383    5  352 9982.00124 16808.5472  68.4%  7280  241s
H   49    82                    10551.267624 16807.6510  59.3%  6522  249s
    81   159 14112.8680    7  299 10551.2676 16807.6510  59.3%  5437  259s
   160   269 13836.6315    9  324 10551.2676 16807.6510  59.3%  3499  269s
   276   345 13809.1452   10  311 10551.2676 16807.6510  59.3%  2674  277s
   372   386 12854.0816   10  263 10551.2676 16807.6510  59.3%  2381  287s
   460   424 13255.0565   12  219 10551.2676 16807.6510  59.3%  2141  296s
   536   447 13263.4532   12  226 10551.2676 16807.6510  59.3%  2097  301s
   577   464 13220.9650   12  217 10551.2676 16807.6510  59.3%  2080  309s
   610   464     cutoff   23      10551.2676 16509.8198  56.5%  2062  310s
   648   485 13169.5598   13  210 10551.2676 16509.8198  56.5%  2064  318s
   689   520 13078.5702   13  200 10551.2676 16509.6017  56.5%  2076  327s
   734   543 12830.4309   13  203 10551.2676 16509.6017  56.5%  2100  335s
   775   569 12753.9123   13  216 10551.2676 16509.6017  56.5%  2126  341s
   832   591 13040.4360   13  192 10551.2676 16509.6017  56.5%  2110  345s
   868   636 12870.5420   14  170 10551.2676 16509.6017  56.5%  2099  354s
   940   684 12733.7926   15  171 10551.2676 16509.6017  56.5%  2023  362s
  1029   720 12724.7805   14  191 10551.2676 16300.4257  54.5%  1944  371s
  1098   780 12718.5074   16  165 10551.2676 16057.1242  52.2%  1901  378s
  1183   827 12527.9094   18  161 10551.2676 16057.1242  52.2%  1866  387s
  1280   875 12451.6182   21  246 10551.2676 16057.1242  52.2%  1838  397s
  1377   891 12114.4115   28  164 10551.2676 16057.1242  52.2%  1823  406s
  1421   922 12107.7253   29  154 10551.2676 16057.1242  52.2%  1841  413s
  1478   964 12044.5138   28  128 10551.2676 15782.8523  49.6%  1842  420s
  1550   991 12095.7910   30  145 10551.2676 15782.8523  49.6%  1821  427s
  1639  1031 12089.9349   31  151 10551.2676 15782.8523  49.6%  1799  436s
  1725  1085 11871.4990   31   96 10551.2676 15636.6398  48.2%  1800  442s
  1839  1128 11631.1562   37   96 10551.2676 15468.4011  46.6%  1773  452s
  1938  1142     cutoff   44      10551.2676 15468.4011  46.6%  1784  458s
  1991  1175 11178.7620   44  101 10551.2676 15000.2075  42.2%  1798  468s
  2106  1221 13246.8378    7  155 10551.2676 15000.2075  42.2%  1785  478s
  2202  1286     cutoff    9      10551.2676 15000.2075  42.2%  1803  488s
  2356  1332 11844.7802   10  130 10551.2676 15000.2075  42.2%  1785  500s
  2524  1354 12756.3791   10  259 10551.2676 14763.2846  39.9%  1763  512s
  2641  1418 11578.5354   12  157 10551.2676 14615.1186  38.5%  1762  522s
  2794  1495 12975.6055    9  238 10551.2676 14615.1186  38.5%  1754  532s
  2989  1574 11166.6456   14  178 10551.2676 14492.5143  37.4%  1732  545s
  3173  1648 13763.7998   12  390 10551.2676 14433.2766  36.8%  1721  559s
  3396  1704     cutoff   15      10551.2676 14312.7212  35.6%  1697  573s
  3568  1788 12850.1278   17  316 10551.2676 14312.7212  35.6%  1705  586s
  3778  1854 11784.6085   20  246 10551.2676 14183.7541  34.4%  1692  598s
  3951  1939 11546.4946   24  294 10551.2676 14163.3440  34.2%  1686  611s
  4211  2023     cutoff   29      10551.2676 14163.3440  34.2%  1661  626s
  4511  2112     cutoff   32      10551.2676 14031.5001  33.0%  1628  643s
  4765  2137     cutoff   10      10551.2676 14031.5001  33.0%  1619  658s
  5018  2186     cutoff    8      10551.2676 14027.8200  32.9%  1621  672s
  5209  2261 12224.0586   13  351 10551.2676 13776.8768  30.6%  1626  689s
  5502  2321 11907.5819   15  341 10551.2676 13730.0793  30.1%  1615  707s
  5755  2426 11026.2212   19  367 10551.2676 13637.7553  29.3%  1622  723s
  6137  2507 11866.3367    9  316 10551.2676 13587.9972  28.8%  1599  742s
  6528  2520 11321.2818   11  282 10551.2676 13574.2170  28.7%  1578  756s
  6605  2571 11217.9526   12  216 10551.2676 13441.2546  27.4%  1576  774s
  6880  2586 infeasible   13      10551.2676 13435.3103  27.3%  1568  788s
  6929  2604 12774.1625    9  204 10551.2676 13416.8279  27.2%  1572  802s
  6977  2605 11717.3811   14  457 10551.2676 13416.8279  27.2%  1573  868s
  6979  2606 11797.7951   26  219 10551.2676 13416.8279  27.2%  1573  887s
  6980  2607 11393.1521   20  407 10551.2676 13416.8279  27.2%  1573  907s
  6981  2608 11826.4509   14  339 10551.2676 13416.8279  27.2%  1572  922s
  6982  2608 10962.0909   23  378 10551.2676 13416.8279  27.2%  1572  930s
  6983  2609 11707.2268   24  352 10551.2676 13416.8279  27.2%  1572  935s
  6985  2610 12091.4168   20  432 10551.2676 13416.8279  27.2%  1572  943s
  6986  2611 11987.8731   13  370 10551.2676 13416.8279  27.2%  1571  945s
  6988  2612 11087.4595   36  386 10551.2676 13416.8279  27.2%  1571  950s
  6991  2614 12800.1931    8  437 10551.2676 13416.8279  27.2%  1570  955s
  6993  2616 11062.7016   15  381 10551.2676 13416.8279  27.2%  1570  962s
  6995  2617 12975.2936   17  378 10551.2676 13416.8279  27.2%  1569  966s
  6996  2618 11410.8896   17  390 10551.2676 13416.8279  27.2%  1569  970s
  6998  2619 12339.1660   12  385 10551.2676 13416.8279  27.2%  1569  977s
  6999  2620 13312.0342   12  406 10551.2676 13416.8279  27.2%  1568  980s
  7001  2621 11456.9421   23  392 10551.2676 13416.8279  27.2%  1568  986s
  7003  2622 11078.4765   10  390 10551.2676 13416.8279  27.2%  1568  993s
  7004  2623 11274.4073   21  385 10551.2676 13416.8279  27.2%  1567  996s
  7005  2624 11538.9831   15  405 10551.2676 13416.8279  27.2%  1567 1001s
  7007  2625 11512.9834   28  447 10551.2676 13416.8279  27.2%  1567 1009s
  7008  2626 11131.3614   29  447 10551.2676 13416.8279  27.2%  1566 1027s
  7009  2626 12900.7962   13  447 10551.2676 13416.8279  27.2%  1566 1044s
  7010  2630 13416.8279   13  489 10551.2676 13416.8279  27.2%  1588 1054s
  7012  2633 13416.8279   14  434 10551.2676 13416.8279  27.2%  1589 1061s
  7016  2640 13416.8279   15  432 10551.2676 13416.8279  27.2%  1592 1066s
  7024  2653 13416.8279   16  415 10551.2676 13416.8279  27.2%  1594 1077s
  7040  2664 13416.8279   17  399 10551.2676 13416.8279  27.2%  1602 1093s
  7056  2691 13416.8279   18  353 10551.2676 13416.8279  27.2%  1614 1099s
  7088  2712 13416.8279   19  392 10551.2676 13416.8279  27.2%  1623 1116s
  7171  2713 13416.8279   21  297 10551.2676 13416.8279  27.2%  1650 1128s
  7259  2717 13088.7728   20  373 10551.2676 13416.8279  27.2%  1656 1136s
  7351  2701 12516.3360   21  139 10551.2676 13416.8279  27.2%  1655 1145s
  7422  2700 12494.1394   22  141 10551.2676 13416.8279  27.2%  1657 1156s
  7501  2697 11464.2832   25  114 10551.2676 13416.8279  27.2%  1657 1161s
  7545  2701 11391.6320   26  112 10551.2676 13416.8279  27.2%  1659 1173s
  7618  2681 10845.9123   28  120 10551.2676 13416.8279  27.2%  1659 1181s
  7675  2663 12386.2178   20  175 10551.2676 13416.8279  27.2%  1664 1190s
  7739  2642 11640.8511   21  163 10551.2676 13416.8279  27.2%  1669 1201s
  7794  2620 11533.8418   22  165 10551.2676 13416.8279  27.2%  1674 1211s
  7869  2599     cutoff   23      10551.2676 13416.8279  27.2%  1677 1222s
  7931  2582 13416.8279   19  468 10551.2676 13416.8279  27.2%  1684 1233s
  8015  2555 13413.2354   20  406 10551.2676 13416.8279  27.2%  1687 1243s
  8071  2550 11840.9559   23  376 10551.2676 13416.8279  27.2%  1693 1254s
  8133  2537 13191.7802   20  342 10551.2676 13416.8279  27.2%  1699 1264s
  8174  2534 12540.7065   21  438 10551.2676 13416.8279  27.2%  1705 1272s
  8225  2512 11764.8806   22  381 10551.2676 13416.8279  27.2%  1706 1281s
  8301  2469 11543.6452   23  352 10551.2676 13416.8279  27.2%  1708 1293s
  8390  2438     cutoff   23      10551.2676 13416.8279  27.2%  1714 1303s
  8501  2412 11359.5115   23  235 10551.2676 13416.8279  27.2%  1712 1314s
H 8519  2274                    10772.109592 13416.8279  24.6%  1713 1314s
  8574  2211     cutoff   24      10772.1096 13416.8279  24.6%  1710 1326s
  8720  2108 12620.3626   22  307 10772.1096 13416.8279  24.6%  1706 1338s
H 8731  1978                    10783.981213 13416.8279  24.4%  1706 1338s
  8841  1893 12399.5817   23  284 10783.9812 13416.8279  24.4%  1701 1347s
  9011  1788 11256.8954   24  227 10783.9812 13416.8279  24.4%  1692 1354s
  9102  1726 11141.2408   25  231 10783.9812 13416.8279  24.4%  1686 1363s
  9271  1642 10887.5325   26  266 10783.9812 12891.7794  19.5%  1671 1369s
  9400  1575     cutoff   27      10783.9812 12594.5522  16.8%  1656 1375s
  9449  1557 10794.6006   23  272 10783.9812 11864.8897  10.0%  1652 1380s

Cutting planes:
  Gomory: 1
  MIR: 452
  Flow cover: 1042
  RLT: 18
  Relax-and-lift: 55

Explored 9456 nodes (15818197 simplex iterations) in 1380.93 seconds (2616.92 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10784 10772.1 10551.3 ... 9762.5

Optimal solution found (tolerance 1.00e-04)
Best objective 1.078398121306e+04, best bound 1.078398121306e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1380.96s
  Master Objective (UB) = 10783.98, θ = 140927.63
  Upper Bound (UB) = 10783.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140927.63
  [DEBUG]   ✓ Scenario 0: θ = 140927.63 ≤ Q = 140927.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140927.63 ≤ Q = 140927.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140927.63 ≤ Q = 140927.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140927.63 ≤ Q = 140927.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140927.63 ≤ Q = 140927.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140927.63 ≤ Q = 140927.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140927.63 ≤ Q = 140927.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5ba925f8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa456da08
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.494292e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6709947.7921
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.439345e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143934.55    0  125 6709947.79 -143934.55   102%     -    0s
H    0     0                    -108536.4096 -143934.55  32.6%     -    0s
H    0     0                    -109139.5832 -143934.55  31.9%     -    0s
H    0     0                    -110776.1866 -143934.55  29.9%     -    0s
H    0     0                    -123174.1493 -143934.55  16.9%     -    0s
     0     0 -128669.66    0   84 -123174.15 -128669.66  4.46%     -    0s
H    0     0                    -125780.5595 -128566.09  2.21%     -    0s
     0     0 -128313.44    0   80 -125780.56 -128313.44  2.01%     -    0s
     0     0 -127761.52    0   77 -125780.56 -127761.52  1.57%     -    0s
H    0     0                    -126319.6739 -127685.40  1.08%     -    0s
     0     0 -127653.48    0   62 -126319.67 -127653.48  1.06%     -    0s
     0     0 -127619.36    0   58 -126319.67 -127619.36  1.03%     -    0s
     0     0 -127542.23    0   80 -126319.67 -127542.23  0.97%     -    0s
     0     0 -127528.42    0   56 -126319.67 -127528.42  0.96%     -    0s
     0     0 -127013.81    0   56 -126319.67 -127013.81  0.55%     -    0s
     0     0 -127009.46    0   56 -126319.67 -127009.46  0.55%     -    0s
     0     0 -126963.80    0   50 -126319.67 -126963.80  0.51%     -    0s
H    0     0                    -126558.5589 -126963.38  0.32%     -    0s
H    0     0                    -126576.7980 -126963.38  0.31%     -    0s
     0     0 -126929.88    0   56 -126576.80 -126929.88  0.28%     -    0s
     0     0 -126876.16    0   57 -126576.80 -126876.16  0.24%     -    0s
     0     0 -126866.88    0   56 -126576.80 -126866.88  0.23%     -    0s
     0     0 -126778.07    0   48 -126576.80 -126778.07  0.16%     -    0s
     0     0 -126750.85    0   55 -126576.80 -126750.85  0.14%     -    0s
     0     0 -126731.98    0   56 -126576.80 -126731.98  0.12%     -    0s
     0     0 -126711.94    0   56 -126576.80 -126711.94  0.11%     -    0s
     0     0 -126711.46    0   56 -126576.80 -126711.46  0.11%     -    0s
     0     0 -126666.30    0   51 -126576.80 -126666.30  0.07%     -    0s
     0     0 -126666.30    0   49 -126576.80 -126666.30  0.07%     -    0s
     0     0 -126666.30    0   41 -126576.80 -126666.30  0.07%     -    0s
H    0     0                    -126579.4486 -126666.30  0.07%     -    0s
     0     0 -126640.45    0   47 -126579.45 -126640.45  0.05%     -    0s
     0     0 -126621.77    0   44 -126579.45 -126621.77  0.03%     -    0s
     0     0 -126610.89    0   44 -126579.45 -126610.89  0.02%     -    0s
     0     0 -126610.58    0   44 -126579.45 -126610.58  0.02%     -    0s
     0     0 -126604.27    0   37 -126579.45 -126604.27  0.02%     -    0s
     0     0 -126603.80    0   36 -126579.45 -126603.80  0.02%     -    0s
*    0     0               0    -126597.6155 -126597.62  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 3
  MIR: 77
  Flow cover: 9
  Relax-and-lift: 1

Explored 1 nodes (1058 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -126598 -126579 -126577 ... -108536
No other solutions better than -126598

Optimal solution found (tolerance 1.00e-04)
Best objective -1.265976154612e+05, best bound -1.265976154612e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 126373.60
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126597.62
  [DEBUG]   S×d_nominal = 252971.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252971.22 + -126597.62 = 126373.60
  [DEBUG]   Current θ from Master = 140927.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14554.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3770.05
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 5179.1246, Absolute Gap = 5179.1246, Relative Gap = 0.480261
  Not converged yet (gap = 5179.12 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351175 nonzeros
Model fingerprint: 0x3e4e7a55
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63024 rows and 25584 columns
Presolve time: 2.27s
Presolved: 60679 rows, 26596 columns, 376959 nonzeros
Variable types: 24337 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60679 rows, 26596 columns, 376959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25007   -1.4969534e+05   0.000000e+00   3.655310e+08      5s
   39997   -1.7854527e+04   0.000000e+00   3.879332e+07     10s
   48623    1.5728985e+04   0.000000e+00   4.658693e+06     15s
   55815    1.9671105e+04   0.000000e+00   1.916080e+06     20s
   61774    2.3243592e+04   0.000000e+00   3.331372e+06     25s
Concurrent spin time: 4.70s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.961860e+04, 49119 iterations, 26.50 seconds (35.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 29618.5971    0  219 -179468.78 29618.5971   117%     -   29s
H    0     0                    -162855.0654 29618.5971   118%     -   29s
H    0     0                    -131130.3463 29618.5971   123%     -   29s
H    0     0                    -102052.2835 29618.5971   129%     -   29s
H    0     0                    -86758.41202 29618.5971   134%     -   30s
H    0     0                    -86594.77215 29618.5971   134%     -   30s
H    0     0                    -85025.47192 29618.5971   135%     -   30s
H    0     0                    -11840.04203 29618.5971   350%     -   30s
H    0     0                    -3127.468607 29618.5971  1047%     -   30s
H    0     0                    -2489.355860 29618.5971  1290%     -   30s
H    0     0                    -2294.316357 25489.9392  1211%     -   39s
H    0     0                    -2121.056383 25489.9392  1302%     -   39s
H    0     0                    -1191.414128 25489.9392  2239%     -   39s
     0     0 25489.9392    0  232 -1191.4141 25489.9392  2239%     -   39s
     0     0 25287.7567    0  268 -1191.4141 25287.7567  2222%     -   42s
     0     0 24817.5918    0  263 -1191.4141 24817.5918  2183%     -   45s
     0     0 24814.3202    0  266 -1191.4141 24814.3202  2183%     -   46s
     0     0 24795.2512    0  244 -1191.4141 24795.2512  2181%     -   47s
     0     0 24536.9306    0  250 -1191.4141 24536.9306  2159%     -   52s
     0     0 24536.9306    0  251 -1191.4141 24536.9306  2159%     -   53s
     0     0 24536.9306    0  251 -1191.4141 24536.9306  2159%     -   53s
     0     0 21965.3746    0  331 -1191.4141 21965.3746  1944%     -   66s
     0     0 21782.7191    0  372 -1191.4141 21782.7191  1928%     -   73s
     0     0 21678.6480    0  362 -1191.4141 21678.6480  1920%     -   77s
H    0     0                    -720.6804162 21655.5879  3105%     -   79s
H    0     0                     445.7709284 21655.5879  4758%     -   79s
     0     0 21655.5879    0  314  445.77093 21655.5879  4758%     -   79s
     0     0 21616.1740    0  307  445.77093 21616.1740  4749%     -   80s
     0     0 21538.8100    0  315  445.77093 21538.8100  4732%     -   82s
     0     0 21530.8059    0  321  445.77093 21530.8059  4730%     -   82s
     0     0 21517.1271    0  312  445.77093 21517.1271  4727%     -   83s
     0     0 21507.5616    0  315  445.77093 21507.5616  4725%     -   84s
     0     0 21506.9142    0  315  445.77093 21506.9142  4725%     -   84s
H    0     0                    4074.6592550 19943.8211   389%     -  107s
H    0     0                    4202.6273849 19943.8211   375%     -  107s
H    0     0                    5534.0771224 19943.8211   260%     -  107s
H    0     0                    6126.9900605 19943.8211   226%     -  107s
H    0     0                    6453.8689060 19943.8211   209%     -  107s
H    0     0                    7560.2678335 19943.8211   164%     -  107s
H    0     0                    7716.8557728 19943.8211   158%     -  107s
H    0     0                    7772.8529729 19943.8211   157%     -  107s
H    0     0                    7786.4376692 19943.8211   156%     -  107s
H    0     0                    7804.1986916 19943.8211   156%     -  107s
     0     0 19943.8211    0  324 7804.19869 19943.8211   156%     -  107s
H    0     0                    8167.0855554 19943.3955   144%     -  107s
H    0     0                    8205.5264724 19943.3955   143%     -  107s
H    0     0                    8250.5184422 19943.3955   142%     -  107s
H    0     0                    8270.8396504 19943.3955   141%     -  107s
     0     0 19709.9919    0  339 8270.83965 19709.9919   138%     -  112s
     0     0 19633.7541    0  343 8270.83965 19633.7541   137%     -  116s
     0     0 19602.5075    0  357 8270.83965 19602.5075   137%     -  118s
     0     0 19526.0244    0  335 8270.83965 19526.0244   136%     -  122s
     0     0 19509.2448    0  349 8270.83965 19509.2448   136%     -  124s
     0     0 19463.9345    0  347 8270.83965 19463.9345   135%     -  126s
H    0     0                    8303.5740845 19352.6982   133%     -  130s
     0     0 19352.6982    0  356 8303.57408 19352.6982   133%     -  130s
H    0     0                    8866.0954022 19290.0356   118%     -  133s
     0     0 19290.0356    0  362 8866.09540 19290.0356   118%     -  133s
H    0     0                    8890.1692153 19279.8884   117%     -  134s
H    0     0                    8946.1730734 19279.8884   116%     -  134s
H    0     0                    8982.5059921 19279.8884   115%     -  134s
H    0     0                    9045.2679023 19279.8884   113%     -  134s
H    0     0                    9067.4759109 19279.8884   113%     -  134s
H    0     0                    9069.5123431 19279.8884   113%     -  134s
     0     0 19279.8884    0  366 9069.51234 19279.8884   113%     -  134s
     0     0 19273.6217    0  364 9069.51234 19273.6217   113%     -  135s
H    0     0                    9181.8100993 19264.2084   110%     -  137s
H    0     0                    9206.5282042 19264.2084   109%     -  137s
H    0     0                    9230.0737382 19264.2084   109%     -  137s
     0     0 19264.2084    0  359 9230.07374 19264.2084   109%     -  137s
     0     0 19257.5546    0  360 9230.07374 19257.5546   109%     -  138s
     0     0 19255.6820    0  362 9230.07374 19255.6820   109%     -  139s
     0     0 19255.0014    0  415 9230.07374 19255.0014   109%     -  139s
     0     0 18418.7354    0  372 9230.07374 18418.7354   100%     -  151s
     0     0 18174.2342    0  358 9230.07374 18174.2342  96.9%     -  156s
     0     0 17995.1262    0  363 9230.07374 17995.1262  95.0%     -  160s
     0     0 17909.6793    0  369 9230.07374 17909.6793  94.0%     -  162s
     0     0 17859.4960    0  377 9230.07374 17859.4960  93.5%     -  165s
     0     0 17842.9140    0  385 9230.07374 17842.9140  93.3%     -  166s
     0     0 17825.8372    0  386 9230.07374 17825.8372  93.1%     -  166s
     0     0 17823.2168    0  388 9230.07374 17823.2168  93.1%     -  167s
     0     0 17822.6129    0  393 9230.07374 17822.6129  93.1%     -  167s
     0     0 17716.5622    0  383 9230.07374 17716.5622  91.9%     -  173s
     0     0 17692.1545    0  389 9230.07374 17692.1545  91.7%     -  175s
     0     0 17684.7174    0  388 9230.07374 17684.7174  91.6%     -  176s
     0     0 17676.7495    0  391 9230.07374 17676.7495  91.5%     -  177s
     0     0 17673.7653    0  391 9230.07374 17673.7653  91.5%     -  177s
     0     0 17671.4865    0  392 9230.07374 17671.4865  91.5%     -  178s
     0     0 17668.1606    0  388 9230.07374 17668.1606  91.4%     -  178s
     0     0 17664.9926    0  392 9230.07374 17664.9926  91.4%     -  179s
     0     0 17664.9612    0  394 9230.07374 17664.9612  91.4%     -  179s
     0     0 17575.9122    0  384 9230.07374 17575.9122  90.4%     -  183s
H    0     0                    9491.2693801 17574.0291  85.2%     -  185s
H    0     0                    10348.888677 17574.0291  69.8%     -  185s
H    0     0                    10356.112892 17574.0291  69.7%     -  186s
     0     0 17547.3185    0  387 10356.1129 17547.3185  69.4%     -  187s
     0     0 17533.9344    0  395 10356.1129 17533.9344  69.3%     -  188s
     0     0 17527.1062    0  395 10356.1129 17527.1062  69.2%     -  189s
     0     0 17518.6842    0  389 10356.1129 17518.6842  69.2%     -  190s
     0     0 17509.8916    0  397 10356.1129 17509.8916  69.1%     -  191s
     0     0 17507.6791    0  438 10356.1129 17507.6791  69.1%     -  192s
     0     0 17506.9639    0  439 10356.1129 17506.9639  69.0%     -  193s
     0     0 17482.3781    0  398 10356.1129 17482.3781  68.8%     -  195s
H    0     0                    10443.658156 17481.6135  67.4%     -  196s
     0     0 17472.3910    0  408 10443.6582 17472.3910  67.3%     -  197s
     0     0 17463.7283    0  409 10443.6582 17463.7283  67.2%     -  198s
     0     0 17462.5408    0  409 10443.6582 17462.5408  67.2%     -  199s
     0     0 17454.1656    0  446 10443.6582 17454.1656  67.1%     -  201s
     0     0 17451.0319    0  450 10443.6582 17451.0319  67.1%     -  205s
     0     0 17450.4949    0  452 10443.6582 17450.4949  67.1%     -  205s
     0     0 17441.8178    0  450 10443.6582 17441.8178  67.0%     -  207s
     0     0 17437.3476    0  444 10443.6582 17437.3476  67.0%     -  209s
     0     0 17436.9055    0  450 10443.6582 17436.9055  67.0%     -  209s
     0     0 17430.3300    0  407 10443.6582 17430.3300  66.9%     -  210s
H    0     0                    10471.579214 17430.0227  66.5%     -  211s
H    0     0                    10476.429044 17430.0227  66.4%     -  212s
H    0     0                    10488.439585 17430.0227  66.2%     -  212s
     0     0 17426.0942    0  394 10488.4396 17426.0942  66.1%     -  212s
     0     0 17425.7208    0  394 10488.4396 17425.7208  66.1%     -  212s
     0     0 17418.1193    0  446 10488.4396 17418.1193  66.1%     -  215s
     0     0 17417.6683    0  446 10488.4396 17417.6683  66.1%     -  216s
     0     2 17417.6683    0  446 10488.4396 17417.6683  66.1%     -  250s
     1     4 17353.5578    1  384 10488.4396 17417.6043  66.1%  1799  255s
     3     8 17204.2838    2  418 10488.4396 17351.4475  65.4%  4069  264s
     7    16 16962.1625    3  415 10488.4396 17199.7997  64.0%  6738  270s
    15    32 16760.4492    4  438 10488.4396 16961.8226  61.7%  5122  279s
    31    49 11499.4635    5  141 10488.4396 16760.3291  59.8%  9064  300s
H   48    79                    10526.642212 16760.3291  59.2%  8822  322s
H   59    79                    10529.901171 16760.3291  59.2%  8028  322s
H   61    79                    10551.267624 16760.3291  58.8%  7848  322s
    80   157 13117.3528    7  272 10551.2676 16760.3291  58.8%  6828  340s
   192   175 13014.6111   10  262 10551.2676 16760.3291  58.8%  4726  353s
   235   200 13109.2696    9  261 10551.2676 16760.3291  58.8%  4163  366s
   321   217 11051.6974   11  314 10551.2676 16760.3291  58.8%  3468  378s
   403   243 12831.3291   10  272 10551.2676 16760.3291  58.8%  3130  390s
   478   275 12748.3911   11  254 10551.2676 16760.3291  58.8%  2974  403s
   576   311     cutoff   12      10551.2676 16584.5752  57.2%  2753  416s
   642   317 15473.2979    6  380 10551.2676 16581.5975  57.2%  2722  427s
   692   353 15398.7248    7  359 10551.2676 16581.5975  57.2%  2672  438s
   744   379 15104.4902    9  351 10551.2676 16581.5975  57.2%  2616  454s
   804   415 13211.8641   11  275 10551.2676 16581.5975  57.2%  2542  464s
   870   445 13034.3969   12  329 10551.2676 16581.5975  57.2%  2462  473s
   950   479 12547.3314   14  263 10551.2676 16352.2770  55.0%  2374  484s
  1026   508 infeasible   16      10551.2676 16352.2770  55.0%  2312  495s
  1083   532     cutoff   16      10551.2676 16352.2770  55.0%  2260  506s
  1145   571     cutoff   15      10551.2676 16352.2770  55.0%  2232  516s
  1219   596     cutoff   15      10551.2676 15670.8056  48.5%  2189  529s
  1300   643 12893.9142    7  344 10551.2676 15645.6684  48.3%  2157  541s
  1381   674 11982.8764    9  312 10551.2676 15645.6684  48.3%  2129  554s
  1480   727 11762.5069   10  311 10551.2676 15402.6523  46.0%  2096  566s
  1561   769 11063.5644   12  218 10551.2676 15402.6523  46.0%  2105  579s
  1704   820 13642.7709    9  379 10551.2676 15402.6523  46.0%  2045  591s
  1841   843 13569.5468   10  316 10551.2676 15247.4987  44.5%  2014  603s
  1880   869 13520.0003   11  321 10551.2676 14931.8854  41.5%  2019  611s
  1948   895 13309.8973   12  290 10551.2676 14739.0566  39.7%  2005  623s
  2042   944 13291.0643   13  233 10551.2676 14655.5732  38.9%  1992  637s
  2160   997 13096.4880   14  281 10551.2676 14655.5732  38.9%  1977  649s
  2305  1042 12965.1764   15  284 10551.2676 14655.5732  38.9%  1957  661s
  2432  1125     cutoff   18      10551.2676 14655.5732  38.9%  1964  676s
  2610  1161     cutoff   17      10551.2676 14379.2804  36.3%  1948  688s
  2801  1227     cutoff    7      10551.2676 14379.2804  36.3%  1930  704s
  2973  1307 11995.5468   13  197 10551.2676 14379.2804  36.3%  1919  718s
  3201  1376     cutoff   16      10551.2676 14379.2804  36.3%  1883  732s
  3461  1455 10823.2458   20  161 10551.2676 14045.9226  33.1%  1843  750s
  3694  1544 10844.9851   23  155 10551.2676 13718.2991  30.0%  1825  763s
  3947  1597 12393.8070   11  188 10551.2676 13718.2991  30.0%  1803  780s
  4224  1667 10985.9428   18  152 10551.2676 13718.2991  30.0%  1781  799s
  4564  1734     cutoff   16      10551.2676 13532.4767  28.3%  1739  816s
  4881  1812 11527.1335   17  331 10551.2676 13476.7513  27.7%  1725  834s
  5130  1850     cutoff   19      10551.2676 13340.7702  26.4%  1729  855s
  5407  1899     cutoff   13      10551.2676 13311.3470  26.2%  1725  873s
  5705  1985 10780.3000   23  161 10551.2676 13164.7032  24.8%  1711  891s
  6078  2052 11684.3401   14  282 10551.2676 13163.4532  24.8%  1689  912s
  6472  2153 10734.8451   18  173 10551.2676 13163.4532  24.8%  1672  930s
  6952  2216     cutoff   11      10551.2676 12957.7743  22.8%  1635  948s
  7281  2373 11076.6853   16  176 10551.2676 12888.1822  22.1%  1629  968s
  7869  2374 12239.1675   16  446 10551.2676 12770.9312  21.0%  1585 1074s
  7871  2375 11395.9567   21  219 10551.2676 12770.9312  21.0%  1585 1119s
  7872  2376 10960.2996   24  347 10551.2676 12770.9312  21.0%  1585 1148s
  7873  2377 11403.6536   22  361 10551.2676 12770.9312  21.0%  1585 1162s
  7874  2377 11451.1723   15  399 10551.2676 12770.9312  21.0%  1584 1174s
  7875  2378 10954.5869   33  362 10551.2676 12770.9312  21.0%  1584 1183s
  7876  2379 10728.8127   18  361 10551.2676 12770.9312  21.0%  1584 1191s
  7877  2379 12481.1799   11  412 10551.2676 12770.9312  21.0%  1584 1199s
  7878  2380 12146.8928   15  386 10551.2676 12770.9312  21.0%  1584 1202s
  7879  2381 11121.0107   33  397 10551.2676 12770.9312  21.0%  1583 1205s
  7881  2382 10984.3801   21  432 10551.2676 12770.9312  21.0%  1583 1216s
  7882  2383 11671.2336   19  441 10551.2676 12770.9312  21.0%  1583 1221s
  7883  2383 10933.1592   28  428 10551.2676 12770.9312  21.0%  1583 1225s
  7884  2384 11039.7527   23  441 10551.2676 12770.9312  21.0%  1582 1233s
  7885  2385 11680.6278   26  437 10551.2676 12770.9312  21.0%  1582 1235s
  7887  2386 11470.8993   21  439 10551.2676 12770.9312  21.0%  1582 1245s
  7889  2387 11827.5770   13  442 10551.2676 12770.9312  21.0%  1581 1255s
  7891  2389 11043.6172   33  394 10551.2676 12770.9312  21.0%  1581 1265s
  7893  2390 11443.4166   13  452 10551.2676 12770.9312  21.0%  1581 1275s
  7894  2391 12463.5376   24  452 10551.2676 12770.9312  21.0%  1580 1322s
  7895  2391 12238.4434   18  452 10551.2676 12770.9312  21.0%  1580 1350s
  7896  2395 12770.9312   13  421 10551.2676 12770.9312  21.0%  1607 1366s
  7898  2398 12770.9312   14  436 10551.2676 12770.9312  21.0%  1607 1377s
  7902  2405 12770.9312   15  419 10551.2676 12770.9312  21.0%  1610 1394s
  7910  2418 12770.9312   16  402 10551.2676 12770.9312  21.0%  1613 1412s
  7926  2427 12770.9312   17  418 10551.2676 12770.9312  21.0%  1628 1432s
  7942  2453 12770.9312   18  346 10551.2676 12770.9312  21.0%  1649 1453s
  7973  2507 12770.9312   19  341 10551.2676 12770.9312  21.0%  1661 1474s
  8073  2496 12770.9312   21  331 10551.2676 12770.9312  21.0%  1711 1487s
  8108  2504 12770.9312   20  333 10551.2676 12770.9312  21.0%  1717 1504s
  8148  2516 12770.9312   21  284 10551.2676 12770.9312  21.0%  1725 1519s
  8193  2519 12770.9312   22  250 10551.2676 12770.9312  21.0%  1726 1532s
  8250  2507 12770.9312   21  260 10551.2676 12770.9312  21.0%  1734 1548s
  8313  2495 11153.9488   22  313 10551.2676 12770.9312  21.0%  1738 1561s
  8379  2494 11840.5095   21  266 10551.2676 12770.9312  21.0%  1740 1577s
  8442  2485     cutoff   23      10551.2676 12770.9312  21.0%  1743 1590s
  8504  2479 11300.7479   22  253 10551.2676 12770.9312  21.0%  1747 1603s
  8564  2475 11476.9551   22  261 10551.2676 12770.9312  21.0%  1756 1615s
  8639  2468 10695.2687   23  232 10551.2676 12770.9312  21.0%  1760 1626s
  8711  2469     cutoff   24      10551.2676 12770.9312  21.0%  1767 1634s
  8787  2443 10893.2704   24  257 10551.2676 12770.9312  21.0%  1768 1648s
  8868  2433 10892.1234   25  237 10551.2676 12770.9312  21.0%  1771 1659s
  8947  2419 12770.9312   21  349 10551.2676 12770.9312  21.0%  1779 1672s
  9022  2417 12770.9312   22  356 10551.2676 12770.9312  21.0%  1787 1684s
  9105  2399 12066.5458   24  248 10551.2676 12770.9312  21.0%  1793 1698s
  9205  2399 11152.5826   26  130 10551.2676 12770.9312  21.0%  1802 1712s
  9303  2379 11816.7221   26  243 10551.2676 12770.9312  21.0%  1807 1726s
  9417  2361     cutoff   28      10551.2676 12770.9312  21.0%  1812 1741s
  9523  2337     cutoff   28      10551.2676 12770.9312  21.0%  1818 1758s
  9631  2313 11726.1624   21  309 10551.2676 12770.9312  21.0%  1825 1775s
  9764  2263 10767.3973   23  294 10551.2676 12770.9312  21.0%  1827 1789s
  9887  2214 11219.7233   25  314 10551.2676 12770.9312  21.0%  1833 1806s
 10018  2167     cutoff   25      10551.2676 12770.9312  21.0%  1840 1823s
 10158  2109 10922.7783   24  208 10551.2676 12770.9312  21.0%  1846 1840s
 10311  2046 10860.7181   28  162 10551.2676 12770.9312  21.0%  1852 1856s
 10493  1956     cutoff   21      10551.2676 12770.9312  21.0%  1850 1874s
 10720  1838 12109.8049   21  366 10551.2676 12770.9312  21.0%  1843 1892s
 10982  1684     cutoff   22      10551.2676 12594.1191  19.4%  1833 1908s
 11324  1473 12142.2854   21  303 10551.2676 12311.8872  16.7%  1808 1925s
 11781  1196 infeasible   22      10551.2676 12138.3545  15.0%  1768 1939s
 12263   954 infeasible   34      10551.2676 11533.1308  9.31%  1724 1949s
*12547   740              41    10574.109795 11533.1308  9.07%  1692 1949s
 12600   715     cutoff   62      10574.1098 11429.2508  8.09%  1686 1955s
 12979   587     cutoff   75      10574.1098 10662.1413  0.83%  1639 1966s
 13049   558 10575.4601   88   16 10574.1098 10623.2693  0.46%  1631 1974s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 475
  Mixing: 2
  Flow cover: 1190
  RLT: 7
  Relax-and-lift: 88

Explored 13069 nodes (21531352 simplex iterations) in 1974.69 seconds (3739.44 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10574.1 10551.3 10529.9 ... 10348.9

Optimal solution found (tolerance 1.00e-04)
Best objective 1.057410979474e+04, best bound 1.057410979474e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1974.70s
  Master Objective (UB) = 10574.11, θ = 140692.08
  Upper Bound (UB) = 10574.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140692.08
  [DEBUG]   ✓ Scenario 0: θ = 140692.08 ≤ Q = 140692.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140692.08 ≤ Q = 140692.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140692.08 ≤ Q = 140692.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140692.08 ≤ Q = 140692.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140692.08 ≤ Q = 140692.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140692.08 ≤ Q = 140692.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140692.08 ≤ Q = 140692.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140692.08 ≤ Q = 140692.08 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x770370be
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x88fc8f42
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.494219e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6688514.6381
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.424677e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142467.69    0  126 6688514.64 -142467.69   102%     -    0s
H    0     0                    -111488.7943 -142467.69  27.8%     -    0s
H    0     0                    -112752.4335 -142467.69  26.4%     -    0s
H    0     0                    -123951.7857 -142467.69  14.9%     -    0s
     0     0 -128112.94    0   89 -123951.79 -128112.94  3.36%     -    0s
H    0     0                    -126288.9174 -128021.97  1.37%     -    0s
     0     0 -127331.16    0   85 -126288.92 -127331.16  0.83%     -    0s
     0     0 -126594.22    0   31 -126288.92 -126594.22  0.24%     -    0s
     0     0 -126593.24    0   30 -126288.92 -126593.24  0.24%     -    0s
     0     0 -126530.35    0   29 -126288.92 -126530.35  0.19%     -    0s
     0     0 -126526.01    0   27 -126288.92 -126526.01  0.19%     -    0s
     0     0 -126524.68    0   27 -126288.92 -126524.68  0.19%     -    0s
     0     0 -126524.40    0   27 -126288.92 -126524.40  0.19%     -    0s
     0     0 -126515.41    0   26 -126288.92 -126515.41  0.18%     -    0s
     0     0 -126509.54    0   26 -126288.92 -126509.54  0.17%     -    0s
     0     0 -126508.34    0   26 -126288.92 -126508.34  0.17%     -    0s
     0     0 -126507.55    0   26 -126288.92 -126507.55  0.17%     -    0s
H    0     0                    -126300.6210 -126507.55  0.16%     -    0s
     0     0 -126350.65    0   13 -126300.62 -126350.65  0.04%     -    0s
     0     0 -126321.97    0   10 -126300.62 -126321.97  0.02%     -    0s
     0     0          -    0      -126300.62 -126312.32  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  Flow cover: 6
  RLT: 1
  Relax-and-lift: 3

Warning: cleanup yields a better solution due to numeric instability

Explored 1 nodes (669 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -1.26953e+21 -126301 -126289 ... 1.49422e+13
No other solutions better than -126312

Optimal solution found (tolerance 1.00e-04)
Best objective -1.269532482474e+21, best bound -1.269532482474e+21, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = -1269532482473971417088.00
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -1269532482473971679232.00
  [DEBUG]   S×d_nominal = 253154.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253154.21 + -1269532482473971679232.00 = -1269532482473971417088.00
  [DEBUG]   Current θ from Master = 140692.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1269532482473971679232.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1269532482473971417088.00
  Lower Bound (LB) = 5604.86
  Gap (UB-LB) = 4969.2532, Absolute Gap = 4969.2532, Relative Gap = 0.469945
  Not converged yet (gap = 4969.25 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394382 nonzeros
Model fingerprint: 0x38649388
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70902 rows and 28782 columns
Presolve time: 2.10s
Presolved: 68091 rows, 29638 columns, 423389 nonzeros
Variable types: 27379 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68091 rows, 29638 columns, 423389 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23421   -1.9966053e+05   0.000000e+00   2.580499e+06      5s
   36635   -1.9529984e+04   0.000000e+00   5.360215e+07     10s
   43455   -5.3671054e+03   0.000000e+00   8.761954e+06     15s
   49343    3.0927513e+03   0.000000e+00   3.820566e+06     20s
   55117    1.1945121e+04   0.000000e+00   2.006756e+06     25s
   59725    1.3981317e+04   0.000000e+00   4.944297e+07     30s
Concurrent spin time: 5.57s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.961860e+04, 57408 iterations, 31.49 seconds (42.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 29618.5971    0  219 -179468.78 29618.5971   117%     -   34s
H    0     0                    -167930.1414 29618.5971   118%     -   34s
H    0     0                    -120560.9149 29618.5971   125%     -   34s
H    0     0                    -119805.5679 29618.5971   125%     -   34s
H    0     0                    -79200.11718 29618.5971   137%     -   35s
H    0     0                    -78612.28422 29618.5971   138%     -   35s
H    0     0                    -56752.88952 29618.5971   152%     -   35s
H    0     0                    -36716.13678 29618.5971   181%     -   36s
H    0     0                    -20578.49877 29618.5971   244%     -   36s
H    0     0                    -20220.92177 29618.5971   246%     -   36s
H    0     0                    -20174.06194 29618.5971   247%     -   36s
H    0     0                    -16840.23073 25316.4821   250%     -   48s
H    0     0                    -9399.491705 25316.4821   369%     -   48s
H    0     0                    -9051.247106 25316.4821   380%     -   48s
     0     0 25299.3465    0  255 -9051.2471 25299.3465   380%     -   48s
H    0     0                    -7981.208936 25299.3465   417%     -   48s
H    0     0                    -7896.312453 25299.3465   420%     -   49s
     0     0 24852.4647    0  245 -7896.3125 24852.4647   415%     -   53s
     0     0 24834.0594    0  272 -7896.3125 24834.0594   415%     -   54s
     0     0 24805.9232    0  266 -7896.3125 24805.9232   414%     -   56s
     0     0 24681.5610    0  266 -7896.3125 24681.5610   413%     -   57s
     0     0 23995.4585    0  243 -7896.3125 23995.4585   404%     -   60s
     0     0 23980.8979    0  252 -7896.3125 23980.8979   404%     -   62s
     0     0 23979.9091    0  249 -7896.3125 23979.9091   404%     -   68s
     0     0 23979.9091    0  249 -7896.3125 23979.9091   404%     -   69s
     0     0 23979.9091    0  251 -7896.3125 23979.9091   404%     -   69s
     0     0 23979.9091    0  252 -7896.3125 23979.9091   404%     -   70s
H    0     0                    -2584.091389 21742.4876   941%     -   83s
     0     0 21742.4876    0  369 -2584.0914 21742.4876   941%     -   84s
     0     0 21198.7238    0  381 -2584.0914 21198.7238   920%     -   94s
     0     0 21032.5497    0  382 -2584.0914 21032.5497   914%     -   98s
     0     0 20919.0189    0  383 -2584.0914 20919.0189   910%     -  101s
     0     0 20812.5131    0  398 -2584.0914 20812.5131   905%     -  104s
     0     0 20756.6690    0  374 -2584.0914 20756.6690   903%     -  106s
H    0     0                    -2219.928669 20747.4060  1035%     -  108s
H    0     0                     206.1507067 20747.4060  9964%     -  108s
H    0     0                     381.4986439 20747.4060  5338%     -  108s
H    0     0                     528.1583906 20747.4060  3828%     -  108s
H    0     0                     779.2349843 20747.4060  2563%     -  108s
     0     0 20747.4060    0  371  779.23498 20747.4060  2563%     -  108s
H    0     0                    1006.4350500 20742.9401  1961%     -  109s
     0     0 20742.9401    0  380 1006.43505 20742.9401  1961%     -  109s
     0     0 20729.0202    0  380 1006.43505 20729.0202  1960%     -  110s
     0     0 20721.4326    0  389 1006.43505 20721.4326  1959%     -  111s
     0     0 20714.1779    0  383 1006.43505 20714.1779  1958%     -  112s
     0     0 20714.1286    0  383 1006.43505 20714.1286  1958%     -  112s
     0     0 19746.3858    0  327 1006.43505 19746.3858  1862%     -  132s
     0     0 19345.9255    0  380 1006.43505 19345.9255  1822%     -  140s
     0     0 19150.4835    0  338 1006.43505 19150.4835  1803%     -  146s
     0     0 19077.4151    0  384 1006.43505 19077.4151  1796%     -  150s
     0     0 19015.5534    0  353 1006.43505 19015.5534  1789%     -  153s
     0     0 18989.3959    0  350 1006.43505 18989.3959  1787%     -  155s
     0     0 18729.8899    0  349 1006.43505 18729.8899  1761%     -  158s
     0     0 18696.9363    0  364 1006.43505 18696.9363  1758%     -  161s
     0     0 18676.2870    0  349 1006.43505 18676.2870  1756%     -  162s
     0     0 18669.0519    0  359 1006.43505 18669.0519  1755%     -  164s
     0     0 18658.7871    0  397 1006.43505 18658.7871  1754%     -  166s
     0     0 18655.8666    0  405 1006.43505 18655.8666  1754%     -  166s
     0     0 18650.5287    0  407 1006.43505 18650.5287  1753%     -  167s
     0     0 18650.1121    0  363 1006.43505 18650.1121  1753%     -  167s
H    0     0                    1048.0359217 18058.2202  1623%     -  178s
H    0     0                    5498.4435482 18058.2202   228%     -  178s
H    0     0                    7094.8364560 18058.2202   155%     -  178s
H    0     0                    7567.4895375 18058.2202   139%     -  178s
H    0     0                    7604.4510386 18058.2202   137%     -  178s
H    0     0                    7830.6323608 18058.2202   131%     -  178s
     0     0 18058.2202    0  416 7830.63236 18058.2202   131%     -  178s
H    0     0                    7886.6772043 18058.0088   129%     -  179s
H    0     0                    7912.3185468 18058.0088   128%     -  179s
H    0     0                    8007.1381596 18058.0088   126%     -  179s
     0     0 17898.1352    0  355 8007.13816 17898.1352   124%     -  184s
     0     0 17808.2751    0  415 8007.13816 17808.2751   122%     -  189s
     0     0 17788.3797    0  420 8007.13816 17788.3797   122%     -  191s
     0     0 17765.9888    0  416 8007.13816 17765.9888   122%     -  192s
     0     0 17758.8749    0  418 8007.13816 17758.8749   122%     -  193s
     0     0 17755.9355    0  426 8007.13816 17755.9355   122%     -  194s
     0     0 17755.2202    0  426 8007.13816 17755.2202   122%     -  195s
H    0     0                    8056.1612844 17647.8353   119%     -  200s
H    0     0                    8057.7046637 17647.8353   119%     -  200s
H    0     0                    8087.3250543 17647.8353   118%     -  200s
     0     0 17647.8353    0  426 8087.32505 17647.8353   118%     -  200s
H    0     0                    8485.0517335 17647.4190   108%     -  201s
H    0     0                    8530.8250273 17647.4190   107%     -  201s
H    0     0                    8580.5679881 17647.4190   106%     -  201s
H    0     0                    8590.2785801 17647.4190   105%     -  201s
H    0     0                    8592.9914937 17647.4190   105%     -  201s
H    0     0                    8609.4722365 17647.4190   105%     -  201s
     0     0 17572.7612    0  434 8609.47224 17572.7612   104%     -  204s
     0     0 17553.2097    0  376 8609.47224 17553.2097   104%     -  205s
     0     0 17542.8835    0  375 8609.47224 17542.8835   104%     -  206s
     0     0 17531.3238    0  422 8609.47224 17531.3238   104%     -  207s
     0     0 17521.3676    0  417 8609.47224 17521.3676   104%     -  208s
     0     0 17518.4081    0  416 8609.47224 17518.4081   103%     -  209s
     0     0 17517.6028    0  420 8609.47224 17517.6028   103%     -  209s
     0     0 17448.4237    0  443 8609.47224 17448.4237   103%     -  213s
H    0     0                    8620.0921306 17448.1325   102%     -  214s
H    0     0                    8687.7079558 17448.1325   101%     -  214s
H    0     0                    8793.5072377 17448.1325  98.4%     -  214s
H    0     0                    9377.9588999 17448.1325  86.1%     -  214s
     0     0 17440.3613    0  390 9377.95890 17440.3613  86.0%     -  215s
     0     0 17433.8816    0  391 9377.95890 17433.8816  85.9%     -  216s
     0     0 17430.9809    0  390 9377.95890 17430.9809  85.9%     -  217s
     0     0 17417.4764    0  390 9377.95890 17417.4764  85.7%     -  217s
     0     0 17415.6219    0  389 9377.95890 17415.6219  85.7%     -  218s
     0     0 17415.3594    0  392 9377.95890 17415.3594  85.7%     -  218s
     0     0 17374.5533    0  393 9377.95890 17374.5533  85.3%     -  220s
H    0     0                    9380.9451349 17373.9585  85.2%     -  221s
H    0     0                    9480.6880311 17349.8978  83.0%     -  223s
H    0     0                    9586.4399575 17349.8978  81.0%     -  223s
     0     0 17349.8978    0  395 9586.43996 17349.8978  81.0%     -  223s
     0     0 17345.0124    0  393 9586.43996 17345.0124  80.9%     -  224s
     0     0 17342.7549    0  393 9586.43996 17342.7549  80.9%     -  224s
     0     0 17342.1148    0  395 9586.43996 17342.1148  80.9%     -  225s
     0     0 17314.9600    0  385 9586.43996 17314.9600  80.6%     -  228s
     0     0 17306.9224    0  450 9586.43996 17306.9224  80.5%     -  230s
     0     0 17305.7942    0  398 9586.43996 17305.7942  80.5%     -  230s
     0     0 17298.5862    0  399 9586.43996 17298.5862  80.4%     -  232s
H    0     0                    9595.0058547 17297.4046  80.3%     -  233s
     0     0 17296.6665    0  453 9595.00585 17296.6665  80.3%     -  233s
     0     0 17296.1858    0  395 9595.00585 17296.1858  80.3%     -  234s
     0     0 17281.2280    0  442 9595.00585 17281.2280  80.1%     -  237s
     0     0 17273.3373    0  389 9595.00585 17273.3373  80.0%     -  239s
     0     0 17269.1433    0  394 9595.00585 17269.1433  80.0%     -  240s
     0     0 17268.5319    0  453 9595.00585 17268.5319  80.0%     -  241s
     0     0 17264.6129    0  444 9595.00585 17264.6129  79.9%     -  243s
     0     0 17259.4142    0  404 9595.00585 17259.4142  79.9%     -  244s
     0     0 17258.5564    0  462 9595.00585 17258.5564  79.9%     -  245s
     0     0 17253.5858    0  399 9595.00585 17253.5858  79.8%     -  247s
H    0     0                    9758.0027085 17253.2916  76.8%     -  247s
     0     0 17248.5731    0  392 9758.00271 17248.5731  76.8%     -  249s
     0     0 17246.9483    0  456 9758.00271 17246.9483  76.7%     -  249s
     0     0 17246.6230    0  396 9758.00271 17246.6230  76.7%     -  249s
     0     0 17239.9675    0  394 9758.00271 17239.9675  76.7%     -  251s
     0     0 17238.6570    0  393 9758.00271 17238.6570  76.7%     -  252s
     0     0 17230.9313    0  400 9758.00271 17230.9313  76.6%     -  254s
H    0     0                    9835.9425461 17229.2008  75.2%     -  255s
     0     0 17229.2008    0  399 9835.94255 17229.2008  75.2%     -  255s
     0     0 17228.9834    0  397 9835.94255 17228.9834  75.2%     -  257s
     0     0 17228.3292    0  397 9835.94255 17228.3292  75.2%     -  259s
H    0     0                    9947.6546042 17228.3292  73.2%     -  293s
H    0     2                    9991.2531002 17228.3292  72.4%     -  295s
     0     2 17228.3292    0  397 9991.25310 17228.3292  72.4%     -  295s
     1     4 17050.4859    1  387 9991.25310 17228.3292  72.4%  3948  301s
     3     8 16974.2398    2  388 9991.25310 17047.1861  70.6%  4513  308s
     7    16 16783.2135    3  382 9991.25310 16972.0920  69.9%  5506  314s
    15    32 16611.3820    4  451 9991.25310 16778.0800  67.9%  5275  322s
    31    48 16172.0603    5  432 9991.25310 16748.8497  67.6%  7429  340s
    47    79 14814.9275    6  378 9991.25310 16748.8497  67.6%  7153  356s
H   52    79                    10126.700060 16748.8497  65.4%  7359  356s
H   52    79                    10180.426091 16748.8497  64.5%  7359  356s
H   53    79                    10265.036264 16748.8497  63.2%  7378  356s
H   56    79                    10386.459419 16748.8497  61.3%  7343  356s
    78   153 14383.2847    7  300 10386.4594 16748.8497  61.3%  6654  374s
H  156   245                    10388.093718 16748.8497  61.2%  5418  385s
H  161   245                    10394.851770 16748.8497  61.1%  5429  385s
H  164   245                    10401.423999 16748.8497  61.0%  5434  385s
H  164   245                    10415.586447 16748.8497  60.8%  5434  385s
H  189   245                    10426.217355 16748.8497  60.6%  5199  385s
   256   319 12846.0106    9  301 10426.2174 16748.8497  60.6%  4753  396s
   356   343 12796.4378    9  256 10426.2174 16748.8497  60.6%  4198  408s
H  373   343                    10450.416208 16748.8497  60.3%  4131  408s
   409   407 12686.0106    9  259 10450.4162 16748.8497  60.3%  4136  421s
H  495   437                    10456.803415 16748.8497  60.2%  3868  432s
H  495   437                    10511.088699 16748.8497  59.3%  3868  432s
H  508   437                    10514.802894 16748.8497  59.3%  3866  432s
H  508   437                    10518.952980 16748.8497  59.2%  3866  432s
   538   471 12637.9448   10  279 10518.9530 16748.8497  59.2%  3842  442s
   613   487 12353.8758   10  249 10518.9530 16748.8497  59.2%  3767  453s
   664   530 12746.7495   11  245 10518.9530 16748.8497  59.2%  3827  463s
   727   557     cutoff   11      10518.9530 16748.8497  59.2%  3862  474s
   799   587 12168.5433   11  235 10518.9530 16748.8497  59.2%  3766  485s
   869   625 infeasible   12      10518.9530 16748.8497  59.2%  3683  495s
   945   671 11920.0577   13  298 10518.9530 16748.8497  59.2%  3676  507s
  1022   702 11453.8012   14  242 10518.9530 16611.3396  57.9%  3631  519s
H 1046   702                    10548.154151 16611.3396  57.5%  3631  519s
  1065   753 11784.8475   14  293 10548.1542 16611.3396  57.5%  3644  529s
  1162   787 11689.3120   14  308 10548.1542 16611.3396  57.5%  3589  541s
  1258   813 11312.4434   15  242 10548.1542 16611.3396  57.5%  3543  554s
  1340   865 infeasible   15      10548.1542 16611.3396  57.5%  3531  567s
  1431   900 10683.4966   20  269 10548.1542 16611.3396  57.5%  3499  580s
  1518   941 infeasible   20      10548.1542 16611.3396  57.5%  3505  594s
  1606   987 infeasible   22      10548.1542 16459.0589  56.0%  3529  606s
  1700  1012 14530.2634    6  358 10548.1542 16456.7835  56.0%  3551  621s
  1767  1061 14286.9859    7  345 10548.1542 16456.7835  56.0%  3620  632s
  1858  1120 13560.0911    9  343 10548.1542 16456.7835  56.0%  3659  643s
  1957  1170 12930.4613   11  336 10548.1542 16456.7835  56.0%  3688  658s
  2081  1211 12794.1972   13  329 10548.1542 15329.8716  45.3%  3696  669s
  2155  1270 12739.0643   14  333 10548.1542 15329.5083  45.3%  3689  683s
  2266  1317 12419.0680   17  317 10548.1542 15329.5083  45.3%  3675  697s
  2381  1352 11832.1421   22  287 10548.1542 15329.5083  45.3%  3709  715s
  2497  1367 11447.3441   27  305 10548.1542 15329.5083  45.3%  3724  729s
  2545  1399 11420.3070   28  299 10548.1542 15075.1773  42.9%  3751  745s
  2640  1468 11093.9195   33  253 10548.1542 15075.1773  42.9%  3760  761s
  2759  1503 10999.6807   12  326 10548.1542 14771.5314  40.0%  3790  778s
  2897  1567 10754.5320   14  297 10548.1542 14771.5314  40.0%  3802  796s
  3051  1659 12773.5943   11  231 10548.1542 14771.5314  40.0%  3794  816s
  3215  1763 12060.1434   15  217 10548.1542 14374.8785  36.3%  3798  834s
  3432  1828 11878.5640   18  253 10548.1542 14349.6247  36.0%  3755  855s
  3599  1921 infeasible   26      10548.1542 14336.0938  35.9%  3759  873s
  3794  1998 13178.0153   11  320 10548.1542 14336.0938  35.9%  3765  893s
  3992  2057 12806.9542   14  310 10548.1542 14152.8417  34.2%  3771  914s
  4118  2148 12588.6368   16  235 10548.1542 14079.7465  33.5%  3775  933s
  4317  2267 11972.9162   22  143 10548.1542 14079.7465  33.5%  3782  954s
  4583  2381 11415.8107   36   86 10548.1542 13967.0885  32.4%  3752  976s
  4911  2450 infeasible   59      10548.1542 13967.0885  32.4%  3671 1001s
  5203  2502 11698.5602   17  230 10548.1542 13763.1917  30.5%  3649 1023s
  5372  2652 11061.7091   19  202 10548.1542 13732.5414  30.2%  3663 1048s
H 5643  2651                    10551.267624 13672.7719  29.6%  3655 1048s
  5645  2652 12708.7154   21  397 10551.2676 13672.7719  29.6%  3657 1179s
  5647  2653 10703.5042   25  219 10551.2676 13672.7719  29.6%  3655 1219s
  5648  2654 12322.4760   16  356 10551.2676 13672.7719  29.6%  3655 1248s
  5649  2655 13208.1166   11  386 10551.2676 13672.7719  29.6%  3654 1265s
  5650  2655 11887.5448   23  363 10551.2676 13672.7719  29.6%  3653 1281s
  5651  2656 11502.9265   19  357 10551.2676 13672.7719  29.6%  3653 1291s
  5652  2657 11982.2469   12  374 10551.2676 13672.7719  29.6%  3652 1299s
  5653  2657 12918.7734   11  375 10551.2676 13672.7719  29.6%  3652 1308s
  5654  2658 12871.5708   19  377 10551.2676 13672.7719  29.6%  3651 1311s
  5655  2659 11844.9744   23  424 10551.2676 13672.7719  29.6%  3650 1315s
  5656  2659 11479.9924   33  423 10551.2676 13672.7719  29.6%  3650 1324s
  5657  2660 11372.2212   40  389 10551.2676 13672.7719  29.6%  3649 1328s
  5658  2661 12097.2827   14  385 10551.2676 13672.7719  29.6%  3648 1333s
  5659  2661 11940.9111   12  376 10551.2676 13672.7719  29.6%  3648 1339s
  5660  2662 11771.8378    9  378 10551.2676 13672.7719  29.6%  3647 1342s
  5662  2663 11986.6486   16  374 10551.2676 13672.7719  29.6%  3646 1347s
  5663  2664 12028.2190   31  384 10551.2676 13672.7719  29.6%  3645 1354s
  5664  2665 11337.4072   44  391 10551.2676 13672.7719  29.6%  3644 1359s
  5665  2665 11858.8617   18  390 10551.2676 13672.7719  29.6%  3644 1368s
  5666  2666 11715.7209   18  385 10551.2676 13672.7719  29.6%  3643 1371s
  5667  2667 11236.7809   23  389 10551.2676 13672.7719  29.6%  3643 1376s
  5669  2668 12930.4346    9  403 10551.2676 13672.7719  29.6%  3641 1385s
  5671  2669 13058.6757   13  438 10551.2676 13672.7719  29.6%  3640 1397s
  5672  2670 11856.8140   19  401 10551.2676 13672.7719  29.6%  3639 1400s
  5673  2671 13176.4427   17  470 10551.2676 13672.7719  29.6%  3639 1408s
  5674  2671 12827.0736   22  399 10551.2676 13672.7719  29.6%  3638 1411s
  5675  2672 11023.8376   25  460 10551.2676 13672.7719  29.6%  3637 1416s
  5676  2673 12467.9648   10  460 10551.2676 13672.7719  29.6%  3637 1457s
  5677  2673 12626.5906   11  460 10551.2676 13672.7719  29.6%  3636 1502s
  5678  2677 13672.7719   15  424 10551.2676 13672.7719  29.6%  3673 1518s
  5680  2680 13672.7719   16  374 10551.2676 13672.7719  29.6%  3674 1533s
  5684  2687 13672.7719   17  494 10551.2676 13672.7719  29.6%  3676 1545s
  5692  2700 13672.7719   18  433 10551.2676 13672.7719  29.6%  3683 1565s
  5708  2711 13672.7719   19  397 10551.2676 13672.7719  29.6%  3691 1593s
  5724  2738 13576.2835   20  343 10551.2676 13672.7719  29.6%  3725 1614s
  5756  2823 12591.4042   21  332 10551.2676 13672.7719  29.6%  3727 1635s
  5858  2825 12077.1846   24  286 10551.2676 13672.7719  29.6%  3790 1653s
  5931  2818 11553.3516   23  327 10551.2676 13672.7719  29.6%  3800 1671s
  6003  2803 12449.5523   22  321 10551.2676 13672.7719  29.6%  3787 1686s
  6079  2775 infeasible   25      10551.2676 13672.7719  29.6%  3771 1702s
  6159  2748     cutoff   25      10551.2676 13672.7719  29.6%  3755 1719s
  6216  2739     cutoff   26      10551.2676 13672.7719  29.6%  3742 1733s
  6280  2729 10884.7915   26  281 10551.2676 13672.7719  29.6%  3728 1750s
  6355  2713 10704.2712   27  283 10551.2676 13672.7719  29.6%  3712 1763s
  6421  2695 12212.9509   26  255 10551.2676 13672.7719  29.6%  3696 1779s
  6472  2684 11901.2952   27  303 10551.2676 13672.7719  29.6%  3687 1794s
  6547  2665 11702.9807   29  336 10551.2676 13672.7719  29.6%  3673 1808s
  6605  2653 11700.0931   30  380 10551.2676 13672.7719  29.6%  3667 1823s
  6664  2649 11035.0835   32  213 10551.2676 13672.7719  29.6%  3669 1840s
  6701  2649 11001.3392   33  217 10551.2676 13672.7719  29.6%  3673 1856s
  6738  2649 10971.2533   34  209 10551.2676 13672.7719  29.6%  3671 1873s
  6773  2648     cutoff   35      10551.2676 13672.7719  29.6%  3678 1886s
  6814  2648 10671.7438   36  131 10551.2676 13672.7719  29.6%  3676 1901s
  6848  2645 10623.3901   37  193 10551.2676 13672.7719  29.6%  3674 1916s
  6905  2628     cutoff   37      10551.2676 13672.7719  29.6%  3671 1932s
  6984  2607 11254.8261   25  302 10551.2676 13672.7719  29.6%  3655 1949s
  7066  2581     cutoff   26      10551.2676 13672.7719  29.6%  3641 1963s
  7111  2578 11941.7917   22  342 10551.2676 13672.7719  29.6%  3644 1982s
  7184  2568 11620.8283   24  332 10551.2676 13672.7719  29.6%  3639 2005s
  7296  2546     cutoff   27      10551.2676 13672.7719  29.6%  3625 2025s
  7407  2527 10657.3141   27  246 10551.2676 13672.7719  29.6%  3616 2044s
  7517  2513 13304.7521   23  326 10551.2676 13672.7719  29.6%  3608 2064s
  7648  2515 12287.4165   24  239 10551.2676 13672.7719  29.6%  3590 2085s
  7809  2500 12103.6099   26  197 10551.2676 13672.7719  29.6%  3555 2109s
  7986  2454 infeasible   29      10551.2676 13672.7719  29.6%  3520 2133s
  8145  2430 11529.8926   27  254 10551.2676 13672.7719  29.6%  3491 2156s
  8315  2367 10980.3562   31  243 10551.2676 13672.7719  29.6%  3468 2175s
  8368  2362     cutoff   32      10551.2676 13664.6895  29.5%  3470 2195s
  8432  2340 12151.2673   22  401 10551.2676 13649.5802  29.4%  3461 2218s
  8536  2307 11453.3304   23  299 10551.2676 13649.5802  29.4%  3451 2241s
  8680  2275 11302.7151   24  365 10551.2676 13649.5802  29.4%  3437 2268s
  8834  2229     cutoff   26      10551.2676 13185.4050  25.0%  3426 2297s
  9007  2182 infeasible   26      10551.2676 12938.9070  22.6%  3407 2333s
  9236  2092 10969.1774   28  259 10551.2676 12938.9070  22.6%  3377 2360s
  9456  2003 10741.1202   36  301 10551.2676 12733.8304  20.7%  3349 2389s
  9685  1908 infeasible   29      10551.2676 12434.8895  17.9%  3331 2417s
  9842  1846 10811.4575   33  145 10551.2676 12337.7399  16.9%  3323 2445s
 10114  1746 11141.0621   31  171 10551.2676 12177.0279  15.4%  3307 2476s
 10506  1556     cutoff   27      10551.2676 11909.9349  12.9%  3254 2509s
 10946  1337 10595.9000   25  249 10551.2676 11628.4082  10.2%  3195 2544s
 11453  1063 infeasible   30      10551.2676 11527.2702  9.25%  3121 2572s
 12172   654 10783.9393   65  125 10551.2676 11358.0001  7.65%  3003 2592s
 13081   427 10603.6232   76   39 10551.2676 11021.7838  4.46%  2834 2601s
 14072     3     cutoff   73      10551.2676 10639.2036  0.83%  2649 2607s

Cutting planes:
  Learned: 1
  MIR: 700
  Mixing: 3
  Flow cover: 1362
  RLT: 21
  Relax-and-lift: 122

Explored 14821 nodes (37768384 simplex iterations) in 2608.65 seconds (4883.57 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10551.3 10548.2 10519 ... 10401.4

Optimal solution found (tolerance 1.00e-04)
Best objective 1.055126762410e+04, best bound 1.055126762410e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2608.69s
  Master Objective (UB) = 10551.27, θ = 138958.63
  Upper Bound (UB) = 10551.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 138958.63
  [DEBUG]   ✓ Scenario 0: θ = 138958.63 ≤ Q = 138958.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 138958.63 ≤ Q = 138958.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x12901437
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xed6febc9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506392e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6847734.7951
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.336232e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133623.19    0  123 6847734.80 -133623.19   102%     -    0s
H    0     0                    -104917.4777 -133623.19  27.4%     -    0s
H    0     0                    -105070.6387 -133623.19  27.2%     -    0s
     0     0 -109255.51    0  125 -105070.64 -109255.51  3.98%     -    0s
H    0     0                    -106330.2042 -109152.42  2.65%     -    0s
     0     0 -108293.26    0  125 -106330.20 -108293.26  1.85%     -    0s
     0     0 -108250.05    0  128 -106330.20 -108250.05  1.81%     -    0s
     0     0 -108013.69    0  132 -106330.20 -108013.69  1.58%     -    0s
     0     0 -108012.48    0  132 -106330.20 -108012.48  1.58%     -    0s
     0     0 -107868.11    0  130 -106330.20 -107868.11  1.45%     -    0s
     0     0 -107866.08    0  130 -106330.20 -107866.08  1.44%     -    0s
     0     2 -107866.08    0  130 -106330.20 -107866.08  1.44%     -    0s
H   32    64                    -106368.2721 -107589.03  1.15%  20.4    0s
H   40    64                    -106408.0457 -107589.03  1.11%  19.5    0s
H   46    64                    -106867.4205 -107589.03  0.68%  18.2    0s
H   95   141                    -106898.6980 -107527.49  0.59%  14.9    0s
H  100   141                    -106979.8727 -107527.49  0.51%  14.6    0s
H  347   166                    -107005.0233 -107527.49  0.49%   7.2    0s
H 1007   330                    -107066.6549 -107356.44  0.27%   5.6    0s
* 1131   342              23    -107078.2799 -107337.89  0.24%   5.6    0s
* 1287   342              25    -107106.1422 -107306.85  0.19%   5.6    0s
* 1794    75              22    -107112.8460 -107207.80  0.09%   5.6    0s
* 1933     7              21    -107131.7324 -107170.12  0.04%   5.5    0s

Cutting planes:
  Gomory: 36
  Implied bound: 6
  MIR: 261
  Flow cover: 4
  RLT: 2
  BQP: 1

Explored 2003 nodes (11262 simplex iterations) in 0.49 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -107132 -107113 -107106 ... -106408
No other solutions better than -107132

Optimal solution found (tolerance 1.00e-04)
Best objective -1.071317324013e+05, best bound -1.071317324013e+05, gap 0.0000%
  Subproblem solved in 0.52s
  Worst-case operational profit (Z_SP) = 138307.62
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107131.73
  [DEBUG]   S×d_nominal = 245439.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245439.35 + -107131.73 = 138307.62
  [DEBUG]   Current θ from Master = 138958.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 651.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9900.26
  Lower Bound (LB) = 9900.26
  Gap (UB-LB) = 651.0081, Absolute Gap = 651.0081, Relative Gap = 0.061700
  Not converged yet (gap = 651.01 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437589 nonzeros
Model fingerprint: 0xe40ea3fc
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78780 rows and 31980 columns
Presolve time: 2.25s
Presolved: 75503 rows, 32680 columns, 469819 nonzeros
Variable types: 30421 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75503 rows, 32680 columns, 469819 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23299   -2.2863219e+05   0.000000e+00   1.828430e+06      5s
   35798   -7.3473853e+04   0.000000e+00   2.439875e+08     10s
   45213   -1.9016101e+04   0.000000e+00   3.718658e+07     15s
   52047    3.3097460e+03   0.000000e+00   6.694117e+06     20s
   57974    7.0982731e+03   0.000000e+00   1.010392e+07     25s
   62588    9.4481024e+03   0.000000e+00   2.084919e+06     30s
   69206    2.0490045e+04   0.000000e+00   7.698117e+05     35s
   74015    2.1452467e+04   0.000000e+00   1.053603e+07     40s
   81253    2.3296480e+04   0.000000e+00   7.597350e+07     45s
   85656    2.3986345e+04   0.000000e+00   2.780633e+07     50s
   91689    2.5267775e+04   0.000000e+00   1.052388e+07     55s
   97521    2.6163711e+04   0.000000e+00   7.185558e+08     60s
  103456    2.7015746e+04   0.000000e+00   1.291057e+06     65s
Concurrent spin time: 4.66s

Solved with dual simplex

Root relaxation: objective 2.961647e+04, 93956 iterations, 69.26 seconds (83.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 29616.4673    0  219 -179468.78 29616.4673   117%     -   72s
H    0     0                    -171513.3899 29616.4673   117%     -   72s
H    0     0                    -98338.87146 29616.4673   130%     -   72s
H    0     0                    -86683.36624 29616.4673   134%     -   72s
H    0     0                    -86589.65820 29616.4673   134%     -   72s
H    0     0                    -85020.35796 29616.4673   135%     -   73s
H    0     0                    -5590.427157 29616.4673   630%     -   73s
H    0     0                    -3127.468607 29616.4673  1047%     -   73s
H    0     0                    -2756.787880 29616.4673  1174%     -   73s
H    0     0                    -1809.587145 25436.2283  1506%     -   98s
H    0     0                    -1505.493017 25436.2283  1790%     -   98s
H    0     0                    -1057.722363 25436.2283  2505%     -   98s
     0     0 24983.7010    0  262 -1057.7224 24983.7010  2462%     -   98s
     0     0 24968.6766    0  268 -1057.7224 24968.6766  2461%     -  104s
     0     0 24968.6766    0  268 -1057.7224 24968.6766  2461%     -  104s
     0     0 24756.0625    0  264 -1057.7224 24756.0625  2441%     -  105s
     0     0 24718.0214    0  197 -1057.7224 24718.0214  2437%     -  113s
     0     0 24718.0214    0  240 -1057.7224 24718.0214  2437%     -  117s
     0     0 24718.0214    0  240 -1057.7224 24718.0214  2437%     -  120s
     0     0 24718.0214    0  238 -1057.7224 24718.0214  2437%     -  120s
     0     0 22474.8169    0  246 -1057.7224 22474.8169  2225%     -  125s
     0     0 22474.8169    0  246 -1057.7224 22474.8169  2225%     -  128s
     0     0 22474.8169    0  245 -1057.7224 22474.8169  2225%     -  128s
     0     0 22474.8169    0  245 -1057.7224 22474.8169  2225%     -  129s
     0     0 22385.6201    0  329 -1057.7224 22385.6201  2216%     -  149s
H    0     0                    -954.5603411 22385.4577  2445%     -  150s
     0     0 21882.2142    0  367 -954.56034 21882.2142  2392%     -  157s
H    0     0                    -426.0498711 21714.1021  5197%     -  161s
     0     0 21714.1021    0  382 -426.04987 21714.1021  5197%     -  161s
     0     0 21549.6372    0  376 -426.04987 21549.6372  5158%     -  166s
H    0     0                    -385.6797208 21530.2636  5682%     -  169s
H    0     0                     907.4534574 21530.2636  2273%     -  169s
H    0     0                    6440.6374597 21530.2636   234%     -  169s
     0     0 21530.2636    0  375 6440.63746 21530.2636   234%     -  169s
     0     0 21522.9746    0  378 6440.63746 21522.9746   234%     -  170s
H    0     0                    7541.8163312 21446.6770   184%     -  173s
     0     0 21446.6770    0  366 7541.81633 21446.6770   184%     -  173s
H    0     0                    7805.6994460 21370.7592   174%     -  176s
H    0     0                    7868.3510920 21370.7592   172%     -  176s
H    0     0                    7869.7277458 21370.7592   172%     -  176s
     0     0 21370.7592    0  367 7869.72775 21370.7592   172%     -  177s
H    0     0                    7885.8177653 21333.1836   171%     -  180s
     0     0 21333.1836    0  376 7885.81777 21333.1836   171%     -  180s
     0     0 21328.4537    0  378 7885.81777 21328.4537   170%     -  181s
     0     0 21326.6025    0  380 7885.81777 21326.6025   170%     -  182s
H    0     0                    7974.8033622 21277.9546   167%     -  186s
H    0     0                    8262.4446087 21277.9546   158%     -  186s
H    0     0                    8457.7146836 21277.9546   152%     -  186s
H    0     0                    8457.7523586 21277.9546   152%     -  186s
     0     0 21277.9546    0  377 8457.75236 21277.9546   152%     -  186s
     0     0 21277.0794    0  377 8457.75236 21277.0794   152%     -  188s
     0     0 21275.4710    0  381 8457.75236 21275.4710   152%     -  189s
     0     0 21275.4710    0  381 8457.75236 21275.4710   152%     -  189s
     0     0 19482.5061    0  323 8457.75236 19482.5061   130%     -  212s
H    0     0                    8701.7402031 19481.5814   124%     -  213s
H    0     0                    8899.9255749 19481.5814   119%     -  213s
H    0     0                    8928.6202560 19481.5814   118%     -  213s
H    0     0                    9065.5381195 19481.5814   115%     -  213s
H    0     0                    9099.6603289 19481.5814   114%     -  213s
     0     0 19048.7134    0  397 9099.66033 19048.7134   109%     -  222s
     0     0 18914.8334    0  384 9099.66033 18914.8334   108%     -  226s
     0     0 18801.5299    0  394 9099.66033 18801.5299   107%     -  230s
     0     0 18768.3180    0  343 9099.66033 18768.3180   106%     -  232s
     0     0 18712.3608    0  347 9099.66033 18712.3608   106%     -  235s
H    0     0                    9129.3867568 18688.1963   105%     -  237s
     0     0 18688.1963    0  355 9129.38676 18688.1963   105%     -  237s
H    0     0                    9147.2317005 18627.3365   104%     -  240s
     0     0 18627.3365    0  345 9147.23170 18627.3365   104%     -  240s
     0     0 18601.9867    0  351 9147.23170 18601.9867   103%     -  241s
     0     0 18594.6922    0  367 9147.23170 18594.6922   103%     -  242s
     0     0 18591.6419    0  364 9147.23170 18591.6419   103%     -  243s
     0     0 18581.9466    0  364 9147.23170 18581.9466   103%     -  244s
     0     0 18574.5654    0  365 9147.23170 18574.5654   103%     -  245s
     0     0 18571.7309    0  370 9147.23170 18571.7309   103%     -  246s
     0     0 18570.4053    0  366 9147.23170 18570.4053   103%     -  246s
     0     0 18568.9721    0  366 9147.23170 18568.9721   103%     -  247s
     0     0 18567.9860    0  372 9147.23170 18567.9860   103%     -  247s
     0     0 18057.3411    0  363 9147.23170 18057.3411  97.4%     -  259s
     0     0 17873.6658    0  363 9147.23170 17873.6658  95.4%     -  265s
     0     0 17759.4626    0  361 9147.23170 17759.4626  94.2%     -  270s
     0     0 17718.5307    0  367 9147.23170 17718.5307  93.7%     -  273s
     0     0 17689.7045    0  375 9147.23170 17689.7045  93.4%     -  276s
     0     0 17682.6776    0  382 9147.23170 17682.6776  93.3%     -  278s
     0     0 17677.0530    0  394 9147.23170 17677.0530  93.3%     -  279s
     0     0 17675.4774    0  390 9147.23170 17675.4774  93.2%     -  280s
     0     0 17675.1905    0  385 9147.23170 17675.1905  93.2%     -  280s
     0     0 17560.9203    0  378 9147.23170 17560.9203  92.0%     -  287s
H    0     0                    9443.5629915 17559.8751  85.9%     -  288s
H    0     0                    9584.4826803 17559.8751  83.2%     -  288s
H    0     0                    9627.3302313 17559.8751  82.4%     -  288s
     0     0 17523.2144    0  374 9627.33023 17523.2144  82.0%     -  291s
     0     0 17507.5955    0  374 9627.33023 17507.5955  81.9%     -  295s
     0     0 17504.5255    0  375 9627.33023 17504.5255  81.8%     -  296s
     0     0 17504.1161    0  377 9627.33023 17504.1161  81.8%     -  297s
     0     0 17476.6002    0  366 9627.33023 17476.6002  81.5%     -  301s
H    0     0                    9732.8002541 17476.1401  79.6%     -  306s
     0     0 17407.3945    0  368 9732.80025 17407.3945  78.9%     -  310s
     0     0 17383.7897    0  417 9732.80025 17383.7897  78.6%     -  313s
     0     0 17374.5369    0  432 9732.80025 17374.5369  78.5%     -  315s
     0     0 17372.1189    0  440 9732.80025 17372.1189  78.5%     -  316s
     0     0 17369.9407    0  428 9732.80025 17369.9407  78.5%     -  317s
     0     0 17369.3709    0  384 9732.80025 17369.3709  78.5%     -  318s
     0     0 17342.5986    0  380 9732.80025 17342.5986  78.2%     -  321s
H    0     0                    9840.1010544 17342.5598  76.2%     -  322s
H    0     0                    9845.5442487 17342.5598  76.1%     -  322s
     0     0 17331.1196    0  379 9845.54425 17331.1196  76.0%     -  325s
     0     0 17321.5900    0  380 9845.54425 17321.5900  75.9%     -  326s
     0     0 17317.1341    0  379 9845.54425 17317.1341  75.9%     -  327s
     0     0 17313.0508    0  419 9845.54425 17313.0508  75.8%     -  330s
     0     0 17309.5507    0  373 9845.54425 17309.5507  75.8%     -  330s
     0     0 17308.0353    0  428 9845.54425 17308.0353  75.8%     -  331s
     0     0 17305.6379    0  420 9845.54425 17305.6379  75.8%     -  332s
     0     0 17303.3941    0  371 9845.54425 17303.3941  75.7%     -  333s
     0     0 17303.1805    0  370 9845.54425 17303.1805  75.7%     -  333s
     0     0 17293.0989    0  363 9845.54425 17293.0989  75.6%     -  336s
     0     0 17290.2231    0  371 9845.54425 17290.2231  75.6%     -  339s
     0     0 17288.7151    0  368 9845.54425 17288.7151  75.6%     -  339s
     0     0 17286.5722    0  375 9845.54425 17286.5722  75.6%     -  340s
     0     0 17286.1275    0  379 9845.54425 17286.1275  75.6%     -  340s
     0     0 17266.2233    0  435 9845.54425 17266.2233  75.4%     -  346s
     0     0 17260.8136    0  371 9845.54425 17260.8136  75.3%     -  349s
     0     0 17256.1582    0  385 9845.54425 17256.1582  75.3%     -  349s
     0     0 17252.7931    0  380 9845.54425 17252.7931  75.2%     -  350s
     0     0 17252.2908    0  385 9845.54425 17252.2908  75.2%     -  350s
     0     0 17244.6409    0  376 9845.54425 17244.6409  75.2%     -  352s
H    0     0                    10026.122725 17243.5085  72.0%     -  360s
     0     0 17237.9080    0  378 10026.1227 17237.9080  71.9%     -  361s
     0     0 17236.9734    0  381 10026.1227 17236.9734  71.9%     -  362s
     0     0 17228.2305    0  384 10026.1227 17228.2305  71.8%     -  364s
H    0     0                    10225.020638 17228.0849  68.5%     -  365s
     0     0 17225.5448    0  383 10225.0206 17225.5448  68.5%     -  365s
     0     0 17224.7536    0  391 10225.0206 17224.7536  68.5%     -  366s
     0     0 17223.7090    0  395 10225.0206 17223.7090  68.4%     -  368s
H    0     0                    10298.324160 17223.6133  67.2%     -  376s
     0     0 17223.0057    0  388 10298.3242 17223.0057  67.2%     -  377s
     0     0 17222.8029    0  398 10298.3242 17222.8029  67.2%     -  379s
H    0     0                    10332.704586 17222.4666  66.7%     -  380s
     0     0 17222.2789    0  394 10332.7046 17222.2789  66.7%     -  381s
     0     0 17222.0309    0  400 10332.7046 17222.0309  66.7%     -  382s
     0     0 17221.6163    0  400 10332.7046 17221.6163  66.7%     -  385s
H    0     0                    10378.440806 17221.6163  65.9%     -  451s
H    0     0                    10403.711349 17221.6163  65.5%     -  455s
H    0     0                    10413.322627 17221.6163  65.4%     -  458s
H    0     0                    10464.383841 17221.6163  64.6%     -  458s
     0     2 17221.6163    0  400 10464.3838 17221.6163  64.6%     -  459s
     1     4 17104.0838    1  380 10464.3838 17221.2294  64.6%  4061  466s
     3     8 17032.3694    2  371 10464.3838 17103.7566  63.4%  6002  475s
     7    15 16128.7089    3  347 10464.3838 17031.9741  62.8%  6853  489s
    14    30 15812.2544    4  358 10464.3838 17031.9741  62.8%  7428  500s
    29    45 15045.4371    5  301 10464.3838 16588.1394  58.5%  8370  521s
    44    77 13895.2481    5  298 10464.3838 16588.1394  58.5%  9369  556s
    76   108 13443.2275    6  287 10464.3838 16307.1789  55.8%  7791  571s
   109   142 13405.6495    7  279 10464.3838 16307.1789  55.8%  7791  582s
H  117   142                    10466.738248 16307.1789  55.8%  7437  582s
H  129   142                    10481.881062 16307.1789  55.6%  6956  582s
   143   216 13050.2488    8  269 10481.8811 16307.1789  55.6%  6672  598s
   235   280 12547.0895    9  240 10481.8811 16307.1789  55.6%  5608  612s
   299   341 12423.9339   11  230 10481.8811 16307.1789  55.6%  5113  627s
   363   402 11803.7191   13  209 10481.8811 16307.1789  55.6%  4787  639s
   438   478 11352.5786   18  186 10481.8811 16307.1789  55.6%  4394  653s
   521   536 11032.1192   23  192 10481.8811 16307.1789  55.6%  4016  667s
   603   577 10599.6780   28  153 10481.8811 16307.1789  55.6%  3763  678s
   682   592 14256.8921   10  486 10481.8811 16307.1789  55.6%  3596  690s
   723   624 13734.7977   11  403 10481.8811 16286.0601  55.4%  3523  701s
   774   646 12883.2144   12  271 10481.8811 16286.0601  55.4%  3457  715s
   820   679 12693.8246   13  268 10481.8811 16286.0601  55.4%  3373  727s
   883   719 12512.1005   14  255 10481.8811 16286.0601  55.4%  3318  741s
   959   727 11147.0579   16  183 10481.8811 16286.0601  55.4%  3224  754s
  1039   744 11011.5028   18  181 10481.8811 16286.0601  55.4%  3125  768s
  1107   786 10677.6494   17  185 10481.8811 16286.0601  55.4%  3080  784s
  1191   846 11447.0575   32  108 10481.8811 16286.0601  55.4%  3033  799s
  1279   929 10972.3268   40   88 10481.8811 16286.0601  55.4%  3003  813s
  1406  1020 10818.5028   47   73 10481.8811 16286.0601  55.4%  2876  825s
  1548  1035 10647.1533   55   77 10481.8811 16286.0601  55.4%  2745  836s
  1591  1054 10645.1338   56   73 10481.8811 16286.0601  55.4%  2751  850s
  1653  1068 12443.1981   20  233 10481.8811 16286.0601  55.4%  2743  865s
  1725  1102 12326.5641   22  230 10481.8811 16286.0601  55.4%  2744  881s
  1799  1159 11967.2271   26  262 10481.8811 16286.0601  55.4%  2759  895s
  1912  1163 10701.8940   29  243 10481.8811 16286.0601  55.4%  2728  914s
  1992  1190 infeasible   28      10481.8811 15804.7610  50.8%  2749  933s
  2071  1230 15374.0324    6  329 10481.8811 15804.7610  50.8%  2785  952s
  2165  1279 13725.0059    8  228 10481.8811 15804.7610  50.8%  2826  970s
  2286  1358 12786.7787   11  214 10481.8811 15804.7610  50.8%  2810  990s
  2436  1427     cutoff   17      10481.8811 15804.7610  50.8%  2784 1010s
  2602  1489 11397.7026   19  139 10481.8811 15804.7610  50.8%  2745 1029s
  2767  1542 13780.3052    8  400 10481.8811 15499.3725  47.9%  2731 1051s
  2919  1618 11005.2136    9  308 10481.8811 15499.3725  47.9%  2733 1074s
  3051  1702     cutoff   10      10481.8811 15499.3725  47.9%  2755 1097s
  3221  1774 11825.3341    9  377 10481.8811 15499.3725  47.9%  2748 1118s
  3387  1851 11295.4298   11  354 10481.8811 15499.3725  47.9%  2749 1144s
  3573  1953 10521.3239   13  360 10481.8811 15499.3725  47.9%  2720 1168s
  3815  2056 14146.3684    9  229 10481.8811 14847.7035  41.7%  2682 1192s
  4025  2140 infeasible   12      10481.8811 14740.7926  40.6%  2670 1220s
  4239  2285 12294.2798   14  128 10481.8811 14723.8824  40.5%  2664 1244s
  4508  2441 11056.4859   41  101 10481.8811 14654.2237  39.8%  2629 1271s
H 4552  2441                    10482.044958 14654.2237  39.8%  2617 1271s
H 4674  2441                    10487.053743 14654.2237  39.7%  2571 1271s
  4781  2441 12878.1066   13  400 10487.0537 14654.2237  39.7%  2573 1404s
  4783  2442 13306.9270   15  219 10487.0537 14654.2237  39.7%  2572 1461s
  4784  2443 12737.4950   12  395 10487.0537 14654.2237  39.7%  2572 1497s
  4785  2444 11253.8647   29  369 10487.0537 14654.2237  39.7%  2571 1517s
  4786  2444 12552.1303   21  392 10487.0537 14654.2237  39.7%  2571 1530s
  4787  2445 10720.8704   25  346 10487.0537 14654.2237  39.7%  2570 1545s
  4788  2446 11654.3430   24  393 10487.0537 14654.2237  39.7%  2570 1553s
  4789  2446 11772.9515   27  351 10487.0537 14654.2237  39.7%  2569 1559s
  4790  2447 13069.9580   18  423 10487.0537 14654.2237  39.7%  2569 1564s
  4791  2448 10646.6989   51  425 10487.0537 14654.2237  39.7%  2568 1569s
  4792  2448 11169.0314   28  376 10487.0537 14654.2237  39.7%  2567 1571s
  4794  2450 10550.1629   27  421 10487.0537 14654.2237  39.7%  2566 1577s
  4796  2451 10646.3848   19  379 10487.0537 14654.2237  39.7%  2565 1583s
  4797  2452 11318.5478   34  380 10487.0537 14654.2237  39.7%  2565 1586s
  4799  2453 10929.1055   50  379 10487.0537 14654.2237  39.7%  2564 1598s
  4800  2454 10882.0231   17  375 10487.0537 14654.2237  39.7%  2563 1601s
  4801  2454 10812.8126   37  395 10487.0537 14654.2237  39.7%  2563 1605s
  4803  2456 11358.3054    8  382 10487.0537 14654.2237  39.7%  2562 1610s
  4804  2456 12004.2496   27  381 10487.0537 14654.2237  39.7%  2561 1617s
  4805  2457 11339.3884   13  400 10487.0537 14654.2237  39.7%  2561 1620s
  4807  2458 11885.5984   22  404 10487.0537 14654.2237  39.7%  2559 1625s
  4808  2459 12129.6519   27  401 10487.0537 14654.2237  39.7%  2559 1637s
  4809  2460 10858.2051   31  448 10487.0537 14654.2237  39.7%  2558 1641s
  4810  2460 13455.9938   16  468 10487.0537 14654.2237  39.7%  2558 1645s
  4811  2461 10961.3569   24  408 10487.0537 14654.2237  39.7%  2557 1652s
  4813  2462 10849.7213   46  414 10487.0537 14654.2237  39.7%  2556 1658s
  4814  2463 12417.7856   20  407 10487.0537 14654.2237  39.7%  2556 1668s
  4815  2464 14393.4614   10  398 10487.0537 14654.2237  39.7%  2555 1672s
  4816  2464 12593.1914   12  401 10487.0537 14654.2237  39.7%  2555 1678s
  4817  2465 11792.0283   17  405 10487.0537 14654.2237  39.7%  2554 1683s
  4818  2466 11017.1513   19  386 10487.0537 14654.2237  39.7%  2554 1690s
  4820  2467 13578.9384   13  405 10487.0537 14654.2237  39.7%  2553 1702s
  4821  2468 10826.9863   35  405 10487.0537 14654.2237  39.7%  2552 1761s
  4822  2468 12936.2230   14  405 10487.0537 14654.2237  39.7%  2552 1820s
  4823  2472 14654.2237   13  434 10487.0537 14654.2237  39.7%  2603 1841s
  4825  2475 14654.2237   14  494 10487.0537 14654.2237  39.7%  2606 1862s
  4829  2482 14654.2237   15  444 10487.0537 14654.2237  39.7%  2609 1892s
  4837  2495 14654.2237   16  482 10487.0537 14654.2237  39.7%  2619 1908s
  4853  2506 14654.2237   17  407 10487.0537 14654.2237  39.7%  2658 1950s
  4869  2509 14061.1912   18  347 10487.0537 14654.2237  39.7%  2687 1978s
  4901  2612 13992.3281   19  333 10487.0537 14654.2237  39.7%  2740 2009s
  5027  2614 13424.5078   23  335 10487.0537 14654.2237  39.7%  2784 2026s
H 5077  2472                    10489.838273 14654.2237  39.7%  2825 2026s
  5092  2489 11947.0332   22  267 10489.8383 14654.2237  39.7%  2841 2040s
  5172  2469 13475.7650   21  311 10489.8383 14654.2237  39.7%  2886 2053s
H 5187  2347                    10491.528982 14654.2237  39.7%  2889 2053s
  5219  2342 13165.2058   24  324 10491.5290 14654.2237  39.7%  2912 2068s
  5289  2318 13143.4300   24  308 10491.5290 14654.2237  39.7%  2942 2083s
H 5290  2205                    10493.729698 14654.2237  39.6%  2941 2083s
  5323  2189 13268.0372   24  387 10493.7297 14654.2237  39.6%  2970 2105s
  5394  2172 12878.6324   25  342 10493.7297 14654.2237  39.6%  3000 2124s
  5433  2178 11408.1403   26  219 10493.7297 14654.2237  39.6%  3029 2137s
  5479  2170 11353.9056   27  218 10493.7297 14654.2237  39.6%  3061 2161s
H 5481  2063                    10497.317587 14654.2237  39.6%  3061 2161s
  5543  2053 10960.6314   28  222 10497.3176 14654.2237  39.6%  3083 2177s
  5612  2041     cutoff   29      10497.3176 14654.2237  39.6%  3100 2194s
  5679  2029 infeasible   27      10497.3176 14654.2237  39.6%  3120 2210s
  5746  2017 13620.9980   18  270 10497.3176 14654.2237  39.6%  3148 2225s
  5808  2009 12762.5372   20  207 10497.3176 14654.2237  39.6%  3171 2241s
  5872  2008     cutoff   23      10497.3176 14654.2237  39.6%  3186 2254s
  5933  2008 infeasible   23      10497.3176 14654.2237  39.6%  3195 2274s
  6031  1978     cutoff   24      10497.3176 14654.2237  39.6%  3213 2290s
  6141  1962 14286.2402   19  279 10497.3176 14654.2237  39.6%  3232 2307s
  6226  1953 12898.3537   21  264 10497.3176 14654.2237  39.6%  3260 2322s
  6276  1972 12312.2951   22  236 10497.3176 14654.2237  39.6%  3289 2341s
  6365  1961 11605.9685   24  215 10497.3176 14654.2237  39.6%  3308 2359s
  6464  1937 11299.0678   26  189 10497.3176 14654.2237  39.6%  3343 2379s
  6570  1920 10936.4885   30  219 10497.3176 14654.2237  39.6%  3375 2398s
  6665  1893 10799.2877   31  139 10497.3176 14359.1215  36.8%  3409 2416s
  6788  1850 infeasible   33      10497.3176 13732.2684  30.8%  3444 2440s
  6906  1836     cutoff   18      10497.3176 13732.2684  30.8%  3486 2460s
  7061  1770 12542.1264   18  251 10497.3176 13732.2684  30.8%  3495 2479s
  7158  1763     cutoff   19      10497.3176 13732.2684  30.8%  3529 2501s
  7295  1736 12275.0107   20  227 10497.3176 13732.2684  30.8%  3549 2522s
  7435  1705 11854.1095   23  179 10497.3176 13267.8381  26.4%  3577 2549s
  7604  1643 11342.8099   27  109 10497.3176 12897.7256  22.9%  3602 2573s
  7764  1589     cutoff   30      10497.3176 12897.7256  22.9%  3628 2597s
  7815  1566 infeasible   29      10497.3176 12612.0432  20.1%  3654 2617s
  7896  1535 11677.8457   23  268 10497.3176 12612.0432  20.1%  3665 2644s
  8060  1500 11677.4856   24  264 10497.3176 12552.1182  19.6%  3676 2670s
  8273  1404 11051.9897   27  204 10497.3176 12381.9714  18.0%  3678 2698s
  8517  1308 infeasible   26      10497.3176 12181.7587  16.0%  3681 2726s
  8790  1219 11177.1771   29  135 10497.3176 12151.9614  15.8%  3676 2751s
  9162  1094 10772.0065   53   91 10497.3176 12144.4580  15.7%  3641 2777s
  9505   997 11029.5268   28  115 10497.3176 11860.8579  13.0%  3599 2803s
 10046   809 10572.8696   30  101 10497.3176 11661.7602  11.1%  3522 2828s
 10715   708 infeasible   38      10497.3176 11337.8120  8.01%  3408 2849s
 11718   501 infeasible   35      10497.3176 11143.5497  6.16%  3199 2869s
 12874   135 10786.6375   53  250 10497.3176 10965.1264  4.46%  2992 2886s
 13886    12 infeasible   36      10497.3176 10921.1639  4.04%  2824 2894s
 14190    19 10643.6073   74  102 10497.3176 10643.6073  1.39%  2774 2901s
 14337    29 infeasible   80      10497.3176 10642.0869  1.38%  2747 2908s
 14581     0     cutoff  100      10497.3176 10602.8824  1.01%  2703 2911s

Cutting planes:
  Learned: 2
  MIR: 664
  Mixing: 2
  Flow cover: 1584
  RLT: 26
  Relax-and-lift: 132

Explored 14806 nodes (39824817 simplex iterations) in 2911.97 seconds (5272.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10497.3 10493.7 10489.8 ... 10378.4

Optimal solution found (tolerance 1.00e-04)
Best objective 1.049731758729e+04, best bound 1.049731758729e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2912.01s
  Master Objective (UB) = 10497.32, θ = 138904.68
  Upper Bound (UB) = 10497.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 138904.68
  [DEBUG]   ✓ Scenario 0: θ = 138904.68 ≤ Q = 138904.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 138904.68 ≤ Q = 138904.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 138904.68 ≤ Q = 138904.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 138904.68 ≤ Q = 138905.05 (slack: 0.38)
  [DEBUG]   ✓ Scenario 4: θ = 138904.68 ≤ Q = 138904.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 138904.68 ≤ Q = 138904.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 138904.68 ≤ Q = 138904.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 138904.68 ≤ Q = 138904.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 138904.68 ≤ Q = 145746.90 (slack: 6842.22)
  [DEBUG]   ✓ Scenario 9: θ = 138904.68 ≤ Q = 138904.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x35502319
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcaafdce7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506392e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6845335.0930
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.336511e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133651.07    0  123 6845335.09 -133651.07   102%     -    0s
H    0     0                    -104912.7506 -133651.07  27.4%     -    0s
H    0     0                    -105065.9117 -133651.07  27.2%     -    0s
     0     0 -109224.27    0  125 -105065.91 -109224.27  3.96%     -    0s
H    0     0                    -106327.4213 -109121.18  2.63%     -    0s
     0     0 -108004.42    0  128 -106327.42 -108004.42  1.58%     -    0s
     0     0 -107773.83    0  130 -106327.42 -107773.83  1.36%     -    0s
     0     0 -107730.70    0  130 -106327.42 -107730.70  1.32%     -    0s
     0     0 -107602.28    0  131 -106327.42 -107602.28  1.20%     -    0s
     0     0 -107586.48    0  131 -106327.42 -107586.48  1.18%     -    0s
     0     2 -107586.48    0  131 -106327.42 -107586.48  1.18%     -    0s
H   33    55                    -106339.6788 -107455.97  1.05%  15.4    0s
H   36    55                    -106405.2628 -107455.97  0.99%  14.8    0s
H   40    54                    -106502.4418 -107450.53  0.89%  15.0    0s
H   47    43                    -106897.7898 -107450.53  0.52%  14.4    0s
H  463    95                    -107025.0972 -107181.98  0.15%   6.6    0s
H  473    95                    -107035.8455 -107181.98  0.14%   6.6    0s
*  632    32              25    -107050.5769 -107166.77  0.11%   6.7    0s

Cutting planes:
  Gomory: 58
  Implied bound: 8
  MIR: 203
  Flow cover: 15
  BQP: 1

Explored 789 nodes (5511 simplex iterations) in 0.23 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -107051 -107036 -107025 ... -104913
No other solutions better than -107051

Optimal solution found (tolerance 1.00e-04)
Best objective -1.070505768993e+05, best bound -1.070505768993e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 138332.42
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107050.58
  [DEBUG]   S×d_nominal = 245382.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245382.99 + -107050.58 = 138332.42
  [DEBUG]   Current θ from Master = 138904.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 572.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9925.06
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = 572.2599, Absolute Gap = 572.2599, Relative Gap = 0.054515
  Not converged yet (gap = 572.26 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480796 nonzeros
Model fingerprint: 0xafa315ce
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86658 rows and 35178 columns
Presolve time: 2.82s
Presolved: 82915 rows, 35722 columns, 509957 nonzeros
Variable types: 33463 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366661.4492
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 581
 AA' NZ     : 2.991e+06
 Factor NZ  : 6.719e+06 (roughly 100 MB of memory)
 Factor Ops : 1.193e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67511035e+07  1.54934395e+08  9.36e+04 2.24e+01  7.29e+04     4s
   1  -1.25966825e+07  1.35769066e+08  6.53e+04 8.99e+01  5.04e+04     5s
   2  -3.56235200e+06  1.03819570e+08  1.79e+04 8.23e-01  1.45e+04     5s
   3  -7.22242634e+05  7.22119875e+07  1.16e+03 1.18e+00  1.35e+03     5s
   4  -5.10664851e+05  2.83330022e+07  3.73e+02 2.81e-01  4.33e+02     5s
   5  -3.84424939e+05  1.88330543e+07  1.19e+02 1.69e-01  1.97e+02     5s
   6  -2.50746498e+05  1.31722355e+07  3.27e+01 1.09e-01  1.05e+02     5s
   7  -1.51817501e+05  9.29810861e+06  1.13e+01 7.39e-02  6.67e+01     5s
   8  -1.13376224e+05  5.76843627e+06  6.52e+00 4.54e-02  4.05e+01     5s
   9  -9.00204075e+04  2.30490355e+06  2.88e+00 1.71e-02  1.61e+01     5s
  10  -5.24910254e+04  7.13696228e+05  9.29e-01 4.95e-03  5.07e+00     5s
  11  -3.33207738e+04  4.13685726e+05  5.81e-01 3.07e-03  2.95e+00     5s
  12  -2.16714364e+04  2.57760480e+05  4.25e-01 1.85e-03  1.84e+00     5s
  13  -1.00046434e+04  1.84675094e+05  3.00e-01 1.44e-03  1.28e+00     5s
  14  -2.08618930e+03  1.35798473e+05  2.28e-01 1.48e-03  9.08e-01     5s
  15   2.74571179e+03  1.14900973e+05  1.87e-01 1.29e-03  7.39e-01     5s
  16   6.73669932e+03  9.41310022e+04  1.52e-01 1.32e-03  5.76e-01     6s
  17   1.22297766e+04  6.82689642e+04  1.12e-01 1.85e-03  3.69e-01     6s
  18   1.80009864e+04  5.86896946e+04  7.41e-02 1.30e-03  2.68e-01     6s
  19   2.17235446e+04  5.23478886e+04  5.42e-02 1.54e-03  2.02e-01     6s
  20   2.48554462e+04  4.67628587e+04  3.84e-02 1.49e-03  1.44e-01     6s
  21   2.66773815e+04  4.31415650e+04  3.02e-02 1.29e-03  1.08e-01     6s
  22   2.81265944e+04  3.95862933e+04  2.41e-02 9.20e-04  7.55e-02     6s
  23   2.97152564e+04  3.79481240e+04  1.77e-02 8.89e-04  5.42e-02     6s
  24   3.06426231e+04  3.69638819e+04  1.40e-02 6.72e-04  4.16e-02     6s
  25   3.18605129e+04  3.64603651e+04  9.39e-03 5.22e-04  3.03e-02     6s
  26   3.27115748e+04  3.57360588e+04  6.06e-03 3.49e-04  1.99e-02     6s
  27   3.36455756e+04  3.49353211e+04  2.63e-03 3.09e-04  8.49e-03     6s
  28   3.40819589e+04  3.47184078e+04  1.07e-03 1.82e-04  4.19e-03     6s
  29   3.42109039e+04  3.46103118e+04  6.59e-04 1.12e-04  2.63e-03     7s
  30   3.42960898e+04  3.45129783e+04  3.95e-04 5.74e-05  1.43e-03     7s
  31   3.43085416e+04  3.45030262e+04  3.55e-04 5.06e-05  1.28e-03     7s
  32   3.43771827e+04  3.44867983e+04  1.46e-04 3.92e-05  7.21e-04     7s
  33   3.43960121e+04  3.44602585e+04  9.09e-05 2.08e-05  4.23e-04     7s
  34   3.44173081e+04  3.44540707e+04  3.25e-05 1.65e-05  2.42e-04     7s
  35   3.44276237e+04  3.44303157e+04  3.29e-06 1.25e-06  1.77e-05     7s
  36   3.44292801e+04  3.44292928e+04  1.60e-08 3.60e-07  8.38e-08     7s
  37   3.44292876e+04  3.44292879e+04  1.22e-08 5.69e-10  1.60e-09     7s

Barrier solved model in 37 iterations and 7.20 seconds (6.15 work units)
Optimal objective 3.44292876e+04


Root crossover log...

   70326 DPushes remaining with DInf 0.0000000e+00                 7s
    4586 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    9189 PPushes remaining with PInf 4.8876055e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.2432679e+03     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43521    3.4429288e+04   0.000000e+00   5.243268e+03     12s
   43597    3.4429288e+04   0.000000e+00   0.000000e+00     12s
   43597    3.4429288e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.442929e+04, 43597 iterations, 8.47 seconds (11.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34429.2879    0  289 -179468.78 34429.2879   119%     -   12s
H    0     0                    -174393.7472 34429.2879   120%     -   12s
H    0     0                    -136371.2296 34429.2879   125%     -   13s
H    0     0                    -122483.7901 34429.2879   128%     -   13s
H    0     0                    -122164.7819 34429.2879   128%     -   13s
H    0     0                    -86703.32976 34429.2879   140%     -   13s
H    0     0                    -85588.74699 34429.2879   140%     -   13s
H    0     0                    -85201.39147 34429.2879   140%     -   13s
H    0     0                    -73554.34844 34429.2879   147%     -   13s
H    0     0                    -21941.33358 34429.2879   257%     -   13s
H    0     0                    -18387.20799 34429.2879   287%     -   13s
H    0     0                    -17321.32954 34429.2879   299%     -   14s
H    0     0                    -16586.18882 34429.2879   308%     -   14s
H    0     0                    -13856.54683 34429.2879   348%     -   15s
     0     0 27540.2411    0  263 -13856.547 27540.2411   299%     -   34s
H    0     0                    -13086.79546 27539.2595   310%     -   34s
H    0     0                    -9009.650465 27539.2595   406%     -   35s
H    0     0                    -8721.431344 27539.2595   416%     -   35s
H    0     0                    -8624.852668 27539.2595   419%     -   35s
H    0     0                    -6580.627968 27082.4038   512%     -   42s
H    0     0                    -5360.330103 27082.4038   605%     -   42s
H    0     0                    -5332.652766 27082.4038   608%     -   42s
     0     0 27082.4038    0  274 -5332.6528 27082.4038   608%     -   42s
     0     0 26993.9619    0  261 -5332.6528 26993.9619   606%     -   45s
     0     0 26952.9824    0  265 -5332.6528 26952.9824   605%     -   48s
     0     0 26941.6240    0  263 -5332.6528 26941.6240   605%     -   50s
     0     0 26933.1146    0  265 -5332.6528 26933.1146   605%     -   50s
     0     0 26933.1146    0  265 -5332.6528 26933.1146   605%     -   51s
     0     0 23936.7768    0  321 -5332.6528 23936.7768   549%     -   82s
H    0     0                    -4326.170524 23935.3321   653%     -   82s
H    0     0                    -2986.582908 23935.3321   901%     -   82s
     0     0 22957.7985    0  330 -2986.5829 22957.7985   869%     -  103s
     0     0 22885.0122    0  335 -2986.5829 22885.0122   866%     -  107s
     0     0 22830.0804    0  342 -2986.5829 22830.0804   864%     -  115s
     0     0 22793.5450    0  337 -2986.5829 22793.5450   863%     -  117s
     0     0 22713.8758    0  338 -2986.5829 22713.8758   861%     -  122s
     0     0 22669.7796    0  388 -2986.5829 22669.7796   859%     -  127s
     0     0 22661.7209    0  337 -2986.5829 22661.7209   859%     -  130s
     0     0 22658.8129    0  339 -2986.5829 22658.8129   859%     -  132s
     0     0 22657.6909    0  343 -2986.5829 22657.6909   859%     -  133s
H    0     0                    -2472.324114 21272.2984   960%     -  165s
H    0     0                    -2457.507311 21272.2984   966%     -  165s
H    0     0                    -2420.696481 21272.2984   979%     -  165s
H    0     0                    -2416.925632 21272.2984   980%     -  165s
H    0     0                    -2396.043614 21272.2984   988%     -  165s
H    0     0                    -1248.425189 21272.2984  1804%     -  165s
     0     0 21272.2984    0  388 -1248.4252 21272.2984  1804%     -  165s
     0     0 20469.0433    0  318 -1248.4252 20469.0433  1740%     -  181s
     0     0 20268.2395    0  392 -1248.4252 20268.2395  1724%     -  193s
H    0     0                    6164.4755127 20077.8271   226%     -  207s
H    0     0                    6201.1883520 20077.8271   224%     -  207s
     0     0 20077.8271    0  336 6201.18835 20077.8271   224%     -  207s
     0     0 20032.5187    0  319 6201.18835 20032.5187   223%     -  214s
     0     0 19973.9244    0  337 6201.18835 19973.9244   222%     -  225s
     0     0 19944.9369    0  350 6201.18835 19944.9369   222%     -  231s
     0     0 19901.9310    0  388 6201.18835 19901.9310   221%     -  241s
     0     0 19878.7540    0  325 6201.18835 19878.7540   221%     -  246s
     0     0 19868.9084    0  335 6201.18835 19868.9084   220%     -  248s
     0     0 19862.8546    0  340 6201.18835 19862.8546   220%     -  252s
     0     0 19860.1886    0  336 6201.18835 19860.1886   220%     -  253s
     0     0 19857.7524    0  341 6201.18835 19857.7524   220%     -  255s
     0     0 19857.0495    0  341 6201.18835 19857.0495   220%     -  256s
     0     0 19033.1919    0  357 6201.18835 19033.1919   207%     -  287s
H    0     0                    6369.4005977 19032.9252   199%     -  288s
H    0     0                    8177.4440302 18789.1450   130%     -  300s
H    0     0                    8460.6020955 18789.1450   122%     -  300s
H    0     0                    8814.3153827 18789.1450   113%     -  300s
     0     0 18789.1450    0  418 8814.31538 18789.1450   113%     -  300s
     0     0 18713.5477    0  413 8814.31538 18713.5477   112%     -  307s
     0     0 18652.0071    0  418 8814.31538 18652.0071   112%     -  313s
     0     0 18558.9776    0  427 8814.31538 18558.9776   111%     -  319s
     0     0 18546.9358    0  430 8814.31538 18546.9358   110%     -  321s
     0     0 18504.3934    0  359 8814.31538 18504.3934   110%     -  325s
     0     0 18465.7778    0  470 8814.31538 18465.7778   109%     -  330s
     0     0 18449.1263    0  372 8814.31538 18449.1263   109%     -  332s
     0     0 18442.4534    0  361 8814.31538 18442.4534   109%     -  334s
     0     0 18435.5494    0  364 8814.31538 18435.5494   109%     -  335s
     0     0 18421.8760    0  370 8814.31538 18421.8760   109%     -  337s
     0     0 18407.7914    0  359 8814.31538 18407.7914   109%     -  340s
     0     0 18407.2929    0  363 8814.31538 18407.2929   109%     -  340s
     0     0 18145.4230    0  374 8814.31538 18145.4230   106%     -  350s
H    0     0                    9060.3300011 18142.6937   100%     -  350s
     0     0 18042.2918    0  446 9060.33000 18042.2918  99.1%     -  356s
     0     0 18021.6558    0  427 9060.33000 18021.6558  98.9%     -  359s
     0     0 18017.6288    0  428 9060.33000 18017.6288  98.9%     -  361s
     0     0 18014.4341    0  432 9060.33000 18014.4341  98.8%     -  362s
     0     0 18001.5980    0  436 9060.33000 18001.5980  98.7%     -  364s
     0     0 17997.0691    0  439 9060.33000 17997.0691  98.6%     -  368s
     0     0 17995.8242    0  430 9060.33000 17995.8242  98.6%     -  369s
     0     0 17909.4326    0  390 9060.33000 17909.4326  97.7%     -  376s
H    0     0                    9440.5192904 17908.9881  89.7%     -  380s
H    0     0                    9480.8894407 17908.9881  88.9%     -  381s
     0     0 17899.3720    0  388 9480.88944 17899.3720  88.8%     -  384s
     0     0 17890.1581    0  389 9480.88944 17890.1581  88.7%     -  386s
     0     0 17886.3268    0  384 9480.88944 17886.3268  88.7%     -  388s
     0     0 17883.4646    0  389 9480.88944 17883.4646  88.6%     -  389s
     0     0 17879.1751    0  382 9480.88944 17879.1751  88.6%     -  392s
     0     0 17869.0799    0  391 9480.88944 17869.0799  88.5%     -  394s
     0     0 17862.8804    0  386 9480.88944 17862.8804  88.4%     -  398s
     0     0 17861.9973    0  386 9480.88944 17861.9973  88.4%     -  400s
     0     0 17749.5627    0  394 9480.88944 17749.5627  87.2%     -  408s
     0     0 17705.8192    0  448 9480.88944 17705.8192  86.8%     -  413s
     0     0 17691.0336    0  433 9480.88944 17691.0336  86.6%     -  417s
     0     0 17685.7095    0  439 9480.88944 17685.7095  86.5%     -  418s
     0     0 17682.6033    0  379 9480.88944 17682.6033  86.5%     -  422s
     0     0 17682.6033    0  379 9480.88944 17682.6033  86.5%     -  422s
     0     0 17679.0961    0  438 9480.88944 17679.0961  86.5%     -  424s
     0     0 17677.4777    0  443 9480.88944 17677.4777  86.5%     -  425s
     0     0 17629.1751    0  390 9480.88944 17629.1751  85.9%     -  432s
H    0     0                    9506.0801226 17628.8193  85.4%     -  433s
     0     0 17613.1507    0  391 9506.08012 17613.1507  85.3%     -  437s
     0     0 17609.5694    0  399 9506.08012 17609.5694  85.2%     -  440s
     0     0 17607.4875    0  400 9506.08012 17607.4875  85.2%     -  441s
     0     0 17571.9799    0  455 9506.08012 17571.9799  84.8%     -  447s
     0     0 17543.7021    0  399 9506.08012 17543.7021  84.6%     -  452s
     0     0 17532.0648    0  406 9506.08012 17532.0648  84.4%     -  454s
     0     0 17529.8931    0  411 9506.08012 17529.8931  84.4%     -  456s
     0     0 17514.5318    0  422 9506.08012 17514.5318  84.2%     -  460s
     0     0 17506.9019    0  402 9506.08012 17506.9019  84.2%     -  463s
     0     0 17504.4237    0  457 9506.08012 17504.4237  84.1%     -  465s
     0     0 17500.7918    0  406 9506.08012 17500.7918  84.1%     -  466s
     0     0 17498.9665    0  410 9506.08012 17498.9665  84.1%     -  468s
     0     0 17492.8131    0  452 9506.08012 17492.8131  84.0%     -  471s
     0     0 17490.9708    0  452 9506.08012 17490.9708  84.0%     -  473s
     0     0 17479.4765    0  394 9506.08012 17479.4765  83.9%     -  477s
H    0     0                    9706.1070830 17479.0931  80.1%     -  483s
     0     0 17471.8893    0  407 9706.10708 17471.8893  80.0%     -  485s
     0     0 17471.1067    0  401 9706.10708 17471.1067  80.0%     -  486s
     0     0 17468.6517    0  411 9706.10708 17468.6517  80.0%     -  488s
     0     0 17468.5832    0  411 9706.10708 17468.5832  80.0%     -  492s
     0     2 17468.5832    0  411 9706.10708 17468.5832  80.0%     -  559s
     1     4 17386.7391    1  395 9706.10708 17468.3721  80.0%  5587  571s
     3     8 17221.0823    2  423 9706.10708 17386.3712  79.1%  7234  584s
     7    16 16757.2647    3  459 9706.10708 17229.5536  77.5%  7111  602s
    15    32 16628.1599    4  460 9706.10708 17024.6201  75.4%  9019  615s
    31    48 15843.7798    5  422 9706.10708 16876.7469  73.9% 11381  647s
    47    80 14723.0546    6  363 9706.10708 16876.7469  73.9% 11992  663s
    79   148 14290.7414    7  299 9706.10708 16876.7469  73.9%  9127  698s
   149   175 13915.3891    8  288 9706.10708 16876.7469  73.9%  7041  712s
H  163   175                    9718.8519708 16876.7469  73.6%  6660  712s
   186   252 13639.4260    9  283 9718.85197 16876.7469  73.6%  6280  733s
   273   342 13076.8964    9  299 9718.85197 16876.7469  73.6%  5520  761s
   375   402 13312.4257   10  240 9718.85197 16876.7469  73.6%  4975  779s
   457   422 12996.1659   12  246 9718.85197 16876.7469  73.6%  4936  797s
   527   441 infeasible   10      9718.85197 16876.7469  73.6%  4897  814s
   611   446 12109.7925   14  165 9718.85197 16876.7469  73.6%  4951  830s
H  614   446                    9740.3716495 16876.7469  73.3%  4955  830s
   664   462 10704.8981   13  216 9740.37165 16876.7469  73.3%  4914  846s
   738   485 11200.8592   15  219 9740.37165 16876.7469  73.3%  4861  863s
   810   528 10269.1161   17  191 9740.37165 16876.7469  73.3%  4834  878s
   884   557     cutoff   18      9740.37165 16876.7469  73.3%  4731  894s
   965   591     cutoff   18      9740.37165 16876.7469  73.3%  4692  911s
  1049   623 10155.4071   18  166 9740.37165 16876.7469  73.3%  4672  926s
  1139   641 10115.5058   19  157 9740.37165 16876.7469  73.3%  4576  946s
  1240   666 9790.84320   22  151 9740.37165 16876.7469  73.3%  4495  964s
  1317   694 10462.9839   11  215 9740.37165 16876.7469  73.3%  4503  981s
  1409   743     cutoff   12      9740.37165 16876.7469  73.3%  4449  999s
  1516   805     cutoff   12      9740.37165 16626.8259  70.7%  4385 1018s
  1649   828 14439.7766    6  353 9740.37165 16626.8259  70.7%  4278 1033s
  1690   842 12076.7070    7  396 9740.37165 16626.8259  70.7%  4315 1052s
  1764   854     cutoff    8      9740.37165 16626.8259  70.7%  4254 1071s
  1864   872 13948.6883    7  333 9740.37165 16626.8259  70.7%  4209 1087s
  1913   909 13772.6508    8  333 9740.37165 16626.8259  70.7%  4242 1104s
  1957   909 14211.1333    7  253 9740.37165 16626.8259  70.7%  4266 1105s
  2002   956 11942.1800   10  305 9740.37165 16626.8259  70.7%  4241 1125s
  2114   993 11326.2645   13  225 9740.37165 16280.9017  67.1%  4271 1150s
  2267  1025 10429.0431   15  342 9740.37165 16280.9017  67.1%  4217 1172s
  2407  1083 12225.1746    9  317 9740.37165 16280.9017  67.1%  4213 1193s
  2581  1125 10349.4573   11  283 9740.37165 16280.9017  67.1%  4178 1216s
  2726  1199 10511.7940   11  183 9740.37165 15643.5851  60.6%  4179 1243s
  2924  1263 13284.5763    8  222 9740.37165 15642.3855  60.6%  4152 1268s
  3128  1280 9833.59684    9  189 9740.37165 15642.3855  60.6%  4127 1285s
H 3165  1280                    10032.276590 15642.3855  55.9%  4152 1285s
  3175  1327     cutoff    9      10032.2766 15642.3855  55.9%  4153 1311s
  3376  1347 10768.4771   14  185 10032.2766 15642.3855  55.9%  4147 1337s
  3578  1402     cutoff   15      10032.2766 14273.6432  42.3%  4163 1366s
  3840  1451     cutoff    7      10032.2766 13906.0668  38.6%  4123 1396s
  4115  1519 10496.6041   13  125 10032.2766 13865.2584  38.2%  4063 1422s
  4375  1651 10517.1261   13  126 10032.2766 13865.2584  38.2%  4038 1454s
  4693  1732     cutoff   14      10032.2766 13752.0623  37.1%  3988 1483s
H 4696  1732                    10112.599303 13752.0623  36.0%  3987 1483s
H 4707  1732                    10118.078568 13752.0623  35.9%  3986 1483s
H 4718  1732                    10123.322992 13752.0623  35.8%  3991 1483s
H 4739  1732                    10216.750860 13734.6145  34.4%  3982 1483s
H 4889  1732                    10269.293017 13705.0279  33.5%  3958 1483s
  4977  1718 11128.5988   14  199 10269.2930 13626.8338  32.7%  3950 1513s
  5267  1716     cutoff   14      10269.2930 13612.1494  32.6%  3926 1547s
  5535  1675 10690.1004   13  153 10269.2930 13256.3232  29.1%  3935 1582s
  5796  1620     cutoff   17      10269.2930 13157.5644  28.1%  3966 1619s
  6078  1647     cutoff   12      10269.2930 13044.8689  27.0%  3981 1654s
H 6343  1647                    10335.625006 12964.2097  25.4%  3973 1654s
  6376  1735     cutoff   12      10335.6250 12964.2097  25.4%  3974 1690s
  6875  1693 10583.9642   12  125 10335.6250 12606.0933  22.0%  3872 1726s
H 6889  1693                    10399.586802 12573.5430  20.9%  3870 1726s
H 6903  1693                    10400.476010 12573.5430  20.9%  3872 1726s
H 6944  1693                    10426.217355 12573.5430  20.6%  3855 1726s
  7079  1680     cutoff   13      10426.2174 12573.5430  20.6%  3849 1771s
  7559  1635     cutoff   21      10426.2174 12426.5498  19.2%  3801 1807s
H 7568  1635                    10434.417329 12426.5498  19.1%  3801 1807s
H 7578  1635                    10467.299989 12426.5498  18.7%  3798 1807s
H 7602  1635                    10481.881062 12273.9685  17.1%  3795 1807s
  7801  1599 11344.6736   15  114 10481.8811 12254.8204  16.9%  3780 1847s
  8446  1378     cutoff   14      10481.8811 11921.2308  13.7%  3668 1884s
  9245  1362     cutoff   15      10481.8811 11532.9803  10.0%  3512 1915s
 11008  1322     cutoff   28      10481.8811 11285.6359  7.67%  3044 1940s
 13162   807     cutoff   42      10481.8811 11064.3074  5.56%  2607 1955s
 15708   414     cutoff   49      10481.8811 10953.2669  4.50%  2218 1972s
 17238    32 10531.3414   57   40 10481.8811 10690.8833  1.99%  2029 1984s
 18671     0     cutoff   67      10481.8811 10563.0503  0.77%  1877 1985s

Cutting planes:
  Learned: 1
  Gomory: 21
  Implied bound: 84
  MIR: 1960
  Flow cover: 2125
  RLT: 61
  Relax-and-lift: 449

Explored 18726 nodes (35467996 simplex iterations) in 1985.06 seconds (3711.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10481.9 10467.3 10434.4 ... 10118.1

Optimal solution found (tolerance 1.00e-04)
Best objective 1.048188106243e+04, best bound 1.048188106243e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1985.13s
  Master Objective (UB) = 10481.88, θ = 139213.87
  Upper Bound (UB) = 10481.88

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 139213.87
  [DEBUG]   ✓ Scenario 0: θ = 139213.87 ≤ Q = 139213.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 139213.87 ≤ Q = 139218.88 (slack: 5.01)
  [DEBUG]   ✓ Scenario 2: θ = 139213.87 ≤ Q = 139213.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 139213.87 ≤ Q = 139213.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 139213.87 ≤ Q = 139213.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 139213.87 ≤ Q = 139213.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 139213.87 ≤ Q = 139213.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 139213.87 ≤ Q = 139213.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 139213.87 ≤ Q = 139213.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 139213.87 ≤ Q = 139213.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 139213.87 ≤ Q = 139213.87 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1b4db0a1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1b4db0a1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.496460e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6807866.7847
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.340811e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134081.12    0  126 6807866.78 -134081.12   102%     -    0s
H    0     0                    -103403.7786 -134081.12  29.7%     -    0s
H    0     0                    -104083.3769 -134081.12  28.8%     -    0s
     0     0 -112320.69    0   67 -104083.38 -112320.69  7.91%     -    0s
H    0     0                    -110058.6574 -112295.81  2.03%     -    0s
     0     0 -112233.86    0   62 -110058.66 -112233.86  1.98%     -    0s
H    0     0                    -111944.7414 -111961.63  0.02%     -    0s
     0     0 -111961.63    0    2 -111944.74 -111961.63  0.02%     -    0s

Cutting planes:
  Gomory: 35
  MIR: 161
  RLT: 15

Explored 1 nodes (412 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -111945 -110059 -104083 ... 1.49646e+13
No other solutions better than -111945

Optimal solution found (tolerance 1.00e-04)
Best objective -1.119447413777e+05, best bound -1.119447413777e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 133553.43
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111944.74
  [DEBUG]   S×d_nominal = 245498.17
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245498.17 + -111944.74 = 133553.43
  [DEBUG]   Current θ from Master = 139213.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5660.44 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4821.44
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = 556.8233, Absolute Gap = 556.8233, Relative Gap = 0.053122
  Not converged yet (gap = 556.82 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524003 nonzeros
Model fingerprint: 0xdcc14df8
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94536 rows and 38376 columns
Presolve time: 3.01s
Presolved: 90327 rows, 38764 columns, 551423 nonzeros
Variable types: 36505 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371802.5864
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 581
 AA' NZ     : 3.321e+06
 Factor NZ  : 7.530e+06 (roughly 110 MB of memory)
 Factor Ops : 1.380e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73230032e+07  1.67966583e+08  9.68e+04 2.21e+01  7.49e+04     5s
   1  -1.32137099e+07  1.47774096e+08  6.85e+04 9.20e+01  5.24e+04     5s
   2  -4.04022944e+06  1.13468388e+08  2.02e+04 9.28e-01  1.63e+04     5s
   3  -8.45670683e+05  8.05683000e+07  1.45e+03 1.14e+00  1.58e+03     5s
   4  -5.40880251e+05  3.45660278e+07  4.22e+02 3.97e-01  4.95e+02     5s
   5  -4.44703393e+05  2.31685836e+07  1.97e+02 2.36e-01  2.65e+02     5s
   6  -2.77824534e+05  1.70286777e+07  3.00e+01 1.61e-01  1.21e+02     5s
   7  -1.85589277e+05  1.12091475e+07  1.00e+01 1.01e-01  7.30e+01     5s
   8  -1.35897748e+05  6.56046558e+06  5.39e+00 5.76e-02  4.19e+01     5s
   9  -8.31005141e+04  2.75359328e+06  2.33e+00 2.29e-02  1.74e+01     5s
  10  -5.72409018e+04  1.71851637e+06  1.32e+00 1.39e-02  1.08e+01     6s
  11  -2.48452318e+04  6.98395412e+05  5.39e-01 5.44e-03  4.38e+00     6s
  12  -1.37517005e+04  3.85706615e+05  3.81e-01 3.02e-03  2.42e+00     6s
  13  -7.77791468e+03  2.15789266e+05  2.89e-01 1.64e-03  1.35e+00     6s
  14   8.99735661e+02  1.75064680e+05  1.87e-01 1.29e-03  1.05e+00     6s
  15   4.47849920e+03  1.46936900e+05  1.53e-01 1.12e-03  8.60e-01     6s
  16   6.57524597e+03  1.08416472e+05  1.34e-01 9.52e-04  6.15e-01     6s
  17   1.25869540e+04  8.20041216e+04  9.80e-02 1.26e-03  4.19e-01     6s
  18   1.67719284e+04  6.75771439e+04  7.71e-02 1.23e-03  3.07e-01     6s
  19   1.99677203e+04  6.10185484e+04  6.25e-02 1.42e-03  2.48e-01     6s
  20   2.24203401e+04  5.27165627e+04  5.15e-02 1.40e-03  1.83e-01     6s
  21   2.53839398e+04  4.78161536e+04  3.95e-02 1.92e-03  1.35e-01     6s
  22   2.72275351e+04  4.56259286e+04  3.20e-02 1.84e-03  1.11e-01     7s
  23   2.82796559e+04  4.43845610e+04  2.77e-02 1.59e-03  9.72e-02     7s
  24   3.06273903e+04  4.16942206e+04  1.89e-02 1.10e-03  6.68e-02     7s
  25   3.18061935e+04  4.01270765e+04  1.47e-02 7.82e-04  5.02e-02     7s
  26   3.31103759e+04  3.83055662e+04  1.01e-02 4.09e-04  3.14e-02     7s
  27   3.40616008e+04  3.77796785e+04  6.89e-03 3.10e-04  2.25e-02     7s
  28   3.46731116e+04  3.73707751e+04  4.93e-03 2.25e-04  1.63e-02     7s
  29   3.50946951e+04  3.71170121e+04  3.54e-03 1.72e-04  1.22e-02     7s
  30   3.53944238e+04  3.69658058e+04  2.57e-03 1.42e-04  9.49e-03     7s
  31   3.55950311e+04  3.66414880e+04  1.94e-03 8.61e-05  6.32e-03     7s
  32   3.58707516e+04  3.65099944e+04  1.09e-03 7.71e-05  3.86e-03     8s
  33   3.60788414e+04  3.63985723e+04  4.70e-04 4.23e-05  1.93e-03     8s
  34   3.60957800e+04  3.63643296e+04  4.24e-04 3.17e-05  1.62e-03     8s
  35   3.61315206e+04  3.62968794e+04  3.27e-04 1.17e-05  9.99e-04     8s
  36   3.61870991e+04  3.62860504e+04  1.71e-04 8.95e-06  5.97e-04     8s
  37   3.61933753e+04  3.62811171e+04  1.53e-04 7.30e-06  5.30e-04     8s
  38   3.62027581e+04  3.62732391e+04  1.29e-04 5.19e-06  4.26e-04     8s
  39   3.62265903e+04  3.62545375e+04  6.63e-05 6.49e-07  1.69e-04     8s
  40   3.62377168e+04  3.62523012e+04  3.60e-05 1.40e-07  8.81e-05     9s
  41   3.62494439e+04  3.62518450e+04  5.62e-06 1.04e-06  1.45e-05     9s
  42   3.62499044e+04  3.62518383e+04  4.49e-06 9.24e-07  1.17e-05     9s
  43   3.62506964e+04  3.62518157e+04  2.55e-06 6.30e-07  6.76e-06     9s
  44   3.62516966e+04  3.62517450e+04  3.70e-08 2.74e-08  2.91e-07     9s
  45   3.62517380e+04  3.62517387e+04  7.67e-10 1.88e-09  4.30e-09     9s
  46   3.62517383e+04  3.62517383e+04  3.35e-09 1.43e-10  1.87e-11     9s

Barrier solved model in 46 iterations and 9.40 seconds (7.67 work units)
Optimal objective 3.62517383e+04


Root crossover log...

   72958 DPushes remaining with DInf 0.0000000e+00                 9s
   17049 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2166 PPushes remaining with PInf 8.8647138e-07                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.2673784e-11     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26502    3.6251738e+04   0.000000e+00   0.000000e+00     11s
   26502    3.6251738e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.625174e+04, 26502 iterations, 7.56 seconds (7.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36251.7383    0  369 -179468.78 36251.7383   120%     -   12s
H    0     0                    -171398.1114 36251.7383   121%     -   12s
H    0     0                    -113800.1870 36251.7383   132%     -   12s
H    0     0                    -113692.1558 36251.7383   132%     -   12s
H    0     0                    -110017.7694 36251.7383   133%     -   12s
H    0     0                    -76243.44125 36251.7383   148%     -   12s
H    0     0                    -75886.99235 36251.7383   148%     -   12s
H    0     0                    -25239.62524 36251.7383   244%     -   12s
H    0     0                    -23970.64988 36251.7383   251%     -   12s
H    0     0                    -23540.02505 36251.7383   254%     -   13s
H    0     0                    -22978.05499 36251.7383   258%     -   13s
H    0     0                    -18334.94786 36251.7383   298%     -   15s
H    0     0                    -16521.57870 36251.7383   319%     -   15s
H    0     0                    -11808.64606 36251.7383   407%     -   15s
H    0     0                    -11777.10465 36251.7383   408%     -   15s
H    0     0                    -7251.659639 29621.9203   508%     -   42s
H    0     0                    -7244.629084 29621.9203   509%     -   42s
H    0     0                    -5835.422082 29621.9203   608%     -   42s
H    0     0                    -5817.281977 29621.9203   609%     -   42s
     0     0 29621.9203    0  321 -5817.2820 29621.9203   609%     -   42s
     0     0 29132.4463    0  342 -5817.2820 29132.4463   601%     -   58s
     0     0 28964.7970    0  405 -5817.2820 28964.7970   598%     -   63s
     0     0 28852.2728    0  398 -5817.2820 28852.2728   596%     -   68s
     0     0 28851.4635    0  387 -5817.2820 28851.4635   596%     -   74s
     0     0 28851.4635    0  386 -5817.2820 28851.4635   596%     -   76s
     0     0 28851.4635    0  390 -5817.2820 28851.4635   596%     -   77s
     0     0 28805.6059    0  334 -5817.2820 28805.6059   595%     -   82s
     0     0 28804.0979    0  386 -5817.2820 28804.0979   595%     -   84s
     0     0 28803.7167    0  388 -5817.2820 28803.7167   595%     -   85s
H    0     0                    6924.0084383 24997.7708   261%     -  139s
H    0     0                    8680.7128628 24997.7708   188%     -  139s
H    0     0                    8683.4474277 24997.7708   188%     -  139s
H    0     0                    8865.0063411 24997.7708   182%     -  139s
H    0     0                    8868.7570954 24997.7708   182%     -  139s
H    0     0                    8874.3738420 24997.7708   182%     -  139s
H    0     0                    8948.1635330 24997.7708   179%     -  139s
H    0     0                    8966.8187310 24997.7708   179%     -  139s
H    0     0                    8969.0807740 24997.7708   179%     -  139s
     0     0 24997.7708    0  396 8969.08077 24997.7708   179%     -  139s
H    0     0                    9003.6887792 24997.7386   178%     -  140s
H    0     0                    9053.5385654 24997.7386   176%     -  140s
H    0     0                    9100.0150370 24997.7386   175%     -  140s
     0     0 24315.1152    0  432 9100.01504 24315.1152   167%     -  171s
     0     0 24152.2449    0  397 9100.01504 24152.2449   165%     -  187s
     0     0 24095.2552    0  424 9100.01504 24095.2552   165%     -  194s
     0     0 23934.3736    0  418 9100.01504 23934.3736   163%     -  207s
H    0     0                    9100.0205070 23911.1108   163%     -  212s
H    0     0                    9118.9855494 23911.1108   162%     -  212s
H    0     0                    9131.5619125 23911.1108   162%     -  212s
H    0     0                    9141.8599330 23911.1108   162%     -  212s
     0     0 23911.1108    0  427 9141.85993 23911.1108   162%     -  212s
     0     0 23905.2523    0  385 9141.85993 23905.2523   161%     -  216s
     0     0 23900.1964    0  438 9141.85993 23900.1964   161%     -  219s
     0     0 23868.0943    0  345 9141.85993 23868.0943   161%     -  225s
     0     0 23863.3739    0  393 9141.85993 23863.3739   161%     -  228s
     0     0 23781.5373    0  395 9141.85993 23781.5373   160%     -  241s
     0     0 23739.8804    0  398 9141.85993 23739.8804   160%     -  249s
     0     0 23736.2668    0  427 9141.85993 23736.2668   160%     -  252s
     0     0 23735.8353    0  431 9141.85993 23735.8353   160%     -  252s
H    0     0                    9179.4609370 23735.8353   159%     -  266s
H    0     0                    9201.6918352 23735.8353   158%     -  266s
H    0     0                    9208.8094177 23735.8353   158%     -  266s
H    0     0                    9220.3522096 23735.8353   157%     -  266s
H    0     0                    9225.4934922 20942.0521   127%     -  325s
H    0     0                    9237.1841854 20942.0521   127%     -  325s
     0     0 20942.0521    0  401 9237.18419 20942.0521   127%     -  325s
H    0     0                    9274.7351980 20941.9465   126%     -  326s
H    0     0                    9533.1017129 20502.7327   115%     -  347s
H    0     0                    9545.2747245 20502.7327   115%     -  347s
H    0     0                    9679.6987644 20502.7327   112%     -  347s
     0     0 20502.7327    0  452 9679.69876 20502.7327   112%     -  347s
     0     0 20385.4898    0  372 9679.69876 20385.4898   111%     -  358s
     0     0 20226.2135    0  419 9679.69876 20226.2135   109%     -  374s
     0     0 20154.8328    0  442 9679.69876 20154.8328   108%     -  381s
     0     0 20000.6105    0  471 9679.69876 20000.6105   107%     -  393s
     0     0 19962.7605    0  398 9679.69876 19962.7605   106%     -  399s
     0     0 19874.3272    0  444 9679.69876 19874.3272   105%     -  407s
     0     0 19786.1064    0  427 9679.69876 19786.1064   104%     -  415s
     0     0 19732.0997    0  380 9679.69876 19732.0997   104%     -  420s
H    0     0                    9756.7493661 19724.0162   102%     -  423s
     0     0 19724.0162    0  387 9756.74937 19724.0162   102%     -  424s
     0     0 19720.3543    0  391 9756.74937 19720.3543   102%     -  426s
     0     0 19719.6549    0  393 9756.74937 19719.6549   102%     -  426s
     0     0 18998.1323    0  363 9756.74937 18998.1323  94.7%     -  453s
H    0     0                    9760.4481609 18997.7361  94.6%     -  454s
     0     0 18849.3941    0  397 9760.44816 18849.3941  93.1%     -  464s
     0     0 18759.7436    0  429 9760.44816 18759.7436  92.2%     -  474s
     0     0 18726.8649    0  369 9760.44816 18726.8649  91.9%     -  479s
H    0     0                    9795.7220017 18648.3491  90.4%     -  487s
H    0     0                    9796.6443094 18648.3491  90.4%     -  487s
H    0     0                    9801.1703784 18648.3491  90.3%     -  487s
H    0     0                    9812.3629427 18648.3491  90.0%     -  487s
     0     0 18648.3491    0  473 9812.36294 18648.3491  90.0%     -  487s
     0     0 18585.6737    0  436 9812.36294 18585.6737  89.4%     -  492s
     0     0 18567.5528    0  424 9812.36294 18567.5528  89.2%     -  497s
     0     0 18545.5789    0  434 9812.36294 18545.5789  89.0%     -  502s
     0     0 18537.5910    0  438 9812.36294 18537.5910  88.9%     -  504s
     0     0 18533.7819    0  439 9812.36294 18533.7819  88.9%     -  505s
     0     0 18532.8543    0  443 9812.36294 18532.8543  88.9%     -  506s
     0     0 18275.9222    0  424 9812.36294 18275.9222  86.3%     -  522s
     0     0 18179.8181    0  485 9812.36294 18179.8181  85.3%     -  535s
     0     0 18141.6297    0  434 9812.36294 18141.6297  84.9%     -  539s
     0     0 18118.0054    0  435 9812.36294 18118.0054  84.6%     -  543s
     0     0 18108.8427    0  440 9812.36294 18108.8427  84.6%     -  545s
     0     0 18101.0480    0  430 9812.36294 18101.0480  84.5%     -  547s
H    0     0                    9815.6127541 18092.3675  84.3%     -  550s
H    0     0                    9844.7438403 18092.3675  83.8%     -  550s
     0     0 18092.3675    0  438 9844.74384 18092.3675  83.8%     -  550s
     0     0 18088.4212    0  438 9844.74384 18088.4212  83.7%     -  552s
     0     0 18085.2177    0  443 9844.74384 18085.2177  83.7%     -  554s
     0     0 18084.1640    0  438 9844.74384 18084.1640  83.7%     -  555s
     0     0 17960.7458    0  503 9844.74384 17960.7458  82.4%     -  568s
     0     0 17900.3193    0  508 9844.74384 17900.3193  81.8%     -  580s
     0     0 17884.1510    0  458 9844.74384 17884.1510  81.7%     -  585s
     0     0 17855.6482    0  455 9844.74384 17855.6482  81.4%     -  592s
     0     0 17839.8897    0  463 9844.74384 17839.8897  81.2%     -  597s
     0     0 17832.5586    0  404 9844.74384 17832.5586  81.1%     -  601s
     0     0 17828.5151    0  461 9844.74384 17828.5151  81.1%     -  604s
     0     0 17824.8033    0  459 9844.74384 17824.8033  81.1%     -  607s
     0     0 17823.4078    0  467 9844.74384 17823.4078  81.0%     -  609s
     0     0 17735.1062    0  494 9844.74384 17735.1062  80.1%     -  622s
     0     0 17690.3206    0  448 9844.74384 17690.3206  79.7%     -  631s
     0     0 17674.8631    0  463 9844.74384 17674.8631  79.5%     -  638s
     0     0 17671.7351    0  410 9844.74384 17671.7351  79.5%     -  640s
     0     0 17662.7184    0  459 9844.74384 17662.7184  79.4%     -  643s
     0     0 17658.5355    0  417 9844.74384 17658.5355  79.4%     -  645s
     0     0 17656.8250    0  413 9844.74384 17656.8250  79.4%     -  647s
     0     0 17595.2132    0  464 9844.74384 17595.2132  78.7%     -  656s
     0     0 17580.2534    0  526 9844.74384 17580.2534  78.6%     -  665s
     0     0 17573.8701    0  410 9844.74384 17573.8701  78.5%     -  668s
     0     0 17570.9491    0  479 9844.74384 17570.9491  78.5%     -  670s
     0     0 17496.8167    0  455 9844.74384 17496.8167  77.7%     -  680s
     0     0 17481.9285    0  465 9844.74384 17481.9285  77.6%     -  685s
     0     0 17470.3805    0  408 9844.74384 17470.3805  77.5%     -  691s
     0     0 17459.9862    0  465 9844.74384 17459.9862  77.4%     -  695s
     0     0 17456.0383    0  473 9844.74384 17456.0383  77.3%     -  698s
     0     0 17450.4516    0  472 9844.74384 17450.4516  77.3%     -  700s
     0     0 17448.6576    0  528 9844.74384 17448.6576  77.2%     -  701s
     0     0 17430.5607    0  471 9844.74384 17430.5607  77.1%     -  708s
     0     0 17424.1207    0  479 9844.74384 17424.1207  77.0%     -  712s
     0     0 17421.5379    0  479 9844.74384 17421.5379  77.0%     -  713s
     0     0 17394.8891    0  451 9844.74384 17394.8891  76.7%     -  718s
     0     0 17381.8656    0  455 9844.74384 17381.8656  76.6%     -  723s
     0     0 17363.6023    0  466 9844.74384 17363.6023  76.4%     -  726s
     0     0 17357.8197    0  458 9844.74384 17357.8197  76.3%     -  729s
     0     0 17355.2664    0  467 9844.74384 17355.2664  76.3%     -  730s
     0     0 17339.3051    0  458 9844.74384 17339.3051  76.1%     -  738s
     0     0 17335.2455    0  449 9844.74384 17335.2455  76.1%     -  765s
     0     0 17331.5021    0  460 9844.74384 17331.5021  76.0%     -  768s
     0     0 17330.6285    0  519 9844.74384 17330.6285  76.0%     -  769s
     0     0 17321.8419    0  465 9844.74384 17321.8419  76.0%     -  775s
     0     0 17317.8141    0  471 9844.74384 17317.8141  75.9%     -  778s
     0     0 17316.3511    0  471 9844.74384 17316.3511  75.9%     -  779s
     0     0 17311.5796    0  474 9844.74384 17311.5796  75.8%     -  784s
     0     0 17311.3111    0  474 9844.74384 17311.3111  75.8%     -  788s
H    0     0                    9865.1902705 17311.2928  75.5%     -  944s
     0     2 17311.2928    0  474 9865.19027 17311.2928  75.5%     -  952s
     1     4 17214.6909    1  443 9865.19027 17311.2140  75.5%  5438  970s
     3     8 17120.3026    2  497 9865.19027 17214.6425  74.5%  8310  985s
     7    15 15869.2478    3  422 9865.19027 17120.1824  73.5%  8770 1013s
    14    30 16237.9489    4  430 9865.19027 17120.1824  73.5% 12043 1035s
    29    43 15951.6201    5  424 9865.19027 16745.5736  69.7% 13941 1083s
H   44    67                    9866.0757626 16745.5736  69.7% 15186 1199s
H   59    67                    10202.826792 16745.5736  64.1% 13036 1199s
    74   136 15302.8694    7  351 10202.8268 16745.5736  64.1% 13414 1248s
H  145   207                    10332.369778 16745.5736  62.1% 10285 1280s
H  147   207                    10349.445211 16745.5736  61.8% 10249 1280s
H  151   207                    10377.334394 16745.5736  61.4% 10288 1280s
   222   268 15001.8396   12  402 10377.3344 16745.5736  61.4%  8683 1306s
   301   297 13773.7010   15  386 10377.3344 16745.5736  61.4%  8136 1329s
   334   327 13773.2876   16  386 10377.3344 16745.5736  61.4%  8104 1349s
   370   357 13693.4287   17  384 10377.3344 16745.5736  61.4%  7896 1371s
   410   384 13429.9262   18  378 10377.3344 16745.5736  61.4%  7739 1389s
   455   395 13368.6897   19  387 10377.3344 16745.5736  61.4%  7554 1411s
   498   419 12981.9504   20  378 10377.3344 16745.5736  61.4%  7650 1433s
   534   453 12054.5994   21  303 10377.3344 16745.5736  61.4%  7585 1448s
   578   492 11945.9639   22  241 10377.3344 16734.3707  61.3%  7434 1466s
   627   535 11893.4858   23  235 10377.3344 16734.3707  61.3%  7242 1483s
   690   576 11888.4828   24  226 10377.3344 16734.3707  61.3%  6940 1501s
   758   638 11806.4373   25  302 10377.3344 16734.3707  61.3%  6592 1517s
   835   689 11046.7318   30  203 10377.3344 16734.3707  61.3%  6320 1537s
   918   752 10967.2657   32  167 10377.3344 16383.6804  57.9%  6134 1556s
  1003   774     cutoff   35      10377.3344 16383.6804  57.9%  5940 1577s
  1039   812 infeasible   16      10377.3344 16349.5472  57.6%  5905 1592s
  1085   851 14259.9949    7  456 10377.3344 16349.5472  57.6%  5835 1611s
  1142   883 11981.8710    8  422 10377.3344 16349.5472  57.6%  5765 1632s
  1207   932 11839.4766    9  405 10377.3344 16349.5472  57.6%  5636 1655s
  1283   990 11633.7546   10  341 10377.3344 16349.5472  57.6%  5454 1679s
  1399  1031 11261.4226   12  418 10377.3344 16349.5472  57.6%  5238 1703s
  1520  1112 11229.2979   14  424 10377.3344 16348.0377  57.5%  5127 1728s
  1655  1167 10895.4585   17  499 10377.3344 16348.0377  57.5%  5033 1752s
  1779  1208 infeasible   20      10377.3344 16348.0377  57.5%  4996 1777s
  1896  1268 12842.7485   12  281 10377.3344 16348.0377  57.5%  5017 1803s
  2026  1351 12430.6748   16  304 10377.3344 16348.0377  57.5%  5042 1829s
  2169  1367 11024.8671   20  223 10377.3344 16348.0377  57.5%  5054 1861s
  2294  1425 12263.7579   14  406 10377.3344 16348.0377  57.5%  5086 1888s
  2423  1492 11592.8256   16  240 10377.3344 16348.0377  57.5%  5144 1917s
  2588  1566 infeasible   19      10377.3344 16348.0377  57.5%  5140 1947s
  2756  1651 13150.4193   10  256 10377.3344 16348.0377  57.5%  5136 1980s
  2939  1763 12753.7506   11  261 10377.3344 15580.5985  50.1%  5120 2011s
  3139  1861 11911.9873   14  210 10377.3344 15580.5985  50.1%  5089 2042s
  3319  2001 10601.6943   18  237 10377.3344 15390.1942  48.3%  5087 2070s
  3522  2033 10479.6634   19  199 10377.3344 14917.3527  43.7%  5064 2108s
  3722  2073 11815.7272    7  343 10377.3344 14913.4976  43.7%  5099 2145s
  3899  2092     cutoff   11      10377.3344 14913.4976  43.7%  5153 2185s
  4060  2132 infeasible   12      10377.3344 14913.4976  43.7%  5212 2227s
  4226  2238 11898.0936    9  270 10377.3344 14778.6647  42.4%  5301 2267s
  4461  2342 11055.8744   12  204 10377.3344 14456.6187  39.3%  5310 2309s
  4739  2435 infeasible   16      10377.3344 14419.5344  39.0%  5271 2357s
  4991  2514 11991.2948   13  387 10377.3344 14328.2824  38.1%  5249 2404s
  5223  2627 10905.4265   15  173 10377.3344 14256.8840  37.4%  5249 2453s
  5572  2628 12116.5825   14  474 10377.3344 14256.8840  37.4%  5184 2753s
  5574  2629 10838.9973   30  283 10377.3344 14256.8840  37.4%  5182 2769s
  5575  2630 12952.7210   19  410 10377.3344 14256.8840  37.4%  5181 2865s
  5576  2631 12789.4250   10  427 10377.3344 14256.8840  37.4%  5180 2938s
  5577  2631 12038.5471   22  467 10377.3344 14256.8840  37.4%  5179 2976s
  5578  2632 13674.2266   13  482 10377.3344 14256.8840  37.4%  5178 3009s
  5579  2633 11761.2427   39  433 10377.3344 14256.8840  37.4%  5177 3040s
  5580  2633 13568.7211    9  396 10377.3344 14256.8840  37.4%  5176 3052s
  5581  2634 12425.2050   10  383 10377.3344 14256.8840  37.4%  5175 3066s
  5582  2635 10575.4212   15  486 10377.3344 14256.8840  37.4%  5174 3075s
  5583  2635 11099.9037   30  440 10377.3344 14256.8840  37.4%  5173 3083s
  5584  2636 10942.9914   22  495 10377.3344 14256.8840  37.4%  5172 3088s
  5585  2637 12153.8947   20  441 10377.3344 14256.8840  37.4%  5172 3093s
  5586  2637 11213.7632   18  456 10377.3344 14256.8840  37.4%  5171 3101s
  5587  2638 11177.3139   40  448 10377.3344 14256.8840  37.4%  5170 3117s
  5588  2639 11056.3788   30  443 10377.3344 14256.8840  37.4%  5169 3123s
  5589  2639 12953.4045   14  460 10377.3344 14256.8840  37.4%  5168 3128s
  5590  2640 12479.2830   16  409 10377.3344 14256.8840  37.4%  5167 3134s
  5591  2641 10875.1061   17  478 10377.3344 14256.8840  37.4%  5166 3153s
  5592  2641 10785.3987   22  511 10377.3344 14256.8840  37.4%  5165 3162s
  5593  2642 11090.3670   32  468 10377.3344 14256.8840  37.4%  5164 3169s
  5594  2643 11283.6440   15  513 10377.3344 14256.8840  37.4%  5163 3184s
  5595  2643 11008.3778   17  574 10377.3344 14256.8840  37.4%  5162 3191s
  5596  2644 12663.6734   15  533 10377.3344 14256.8840  37.4%  5161 3204s
  5597  2645 12310.1473    9  592 10377.3344 14256.8840  37.4%  5160 3213s
  5598  2645 11911.6031   15  536 10377.3344 14256.8840  37.4%  5160 3233s
  5599  2646 11545.7927   18  482 10377.3344 14256.8840  37.4%  5159 3244s
  5600  2647 11662.3588   15  562 10377.3344 14256.8840  37.4%  5158 3257s
  5601  2647 12240.6329   13  589 10377.3344 14256.8840  37.4%  5157 3266s
  5602  2648 12239.5527   15  547 10377.3344 14256.8840  37.4%  5156 3280s
  5603  2649 10992.9091   36  547 10377.3344 14256.8840  37.4%  5155 3304s
  5604  2649 13097.6421    9  547 10377.3344 14256.8840  37.4%  5154 3368s
  5605  2653 14256.8840   11  541 10377.3344 14256.8840  37.4%  5208 3404s
  5607  2656 14256.8840   12  456 10377.3344 14256.8840  37.4%  5209 3457s
  5611  2663 14256.8840   13  461 10377.3344 14256.8840  37.4%  5210 3496s
  5619  2676 14256.8840   14  461 10377.3344 14256.8840  37.4%  5217 3532s
  5635  2685 14256.8840   15  348 10377.3344 14256.8840  37.4%  5256 3582s
  5651  2704 13643.4073   16  300 10377.3344 14256.8840  37.4%  5264 3600s

Cutting planes:
  Gomory: 35
  Implied bound: 40
  Projected implied bound: 258
  MIR: 1155
  Mixing: 3
  Flow cover: 1127
  RLT: 61
  Relax-and-lift: 271

Explored 5675 nodes (30445570 simplex iterations) in 3600.10 seconds (5686.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10377.3 10349.4 10332.4 ... 9801.17

Time limit reached
Best objective 1.037733439429e+04, best bound 1.425688403963e+04, gap 37.3848%
  WARNING: Time limit reached. Using best solution found (gap: 37.38%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 10377.33, θ = 138948.70
  Upper Bound (UB) = 10377.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 138948.70
  [DEBUG]   ✓ Scenario 0: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 138948.70 ≤ Q = 138948.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 138948.70 ≤ Q = 138948.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6eb39d47
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6eb39d47
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-14, 2e+02]
Found heuristic solution: objective 1.506392e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6849645.2698
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.334558e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133455.82    0  123 6849645.27 -133455.82   102%     -    0s
H    0     0                    -104746.9909 -133455.82  27.4%     -    0s
H    0     0                    -104900.1520 -133455.82  27.2%     -    0s
     0     0 -109512.95    0   71 -104900.15 -109512.95  4.40%     -    0s
H    0     0                    -107059.3775 -109412.50  2.20%     -    0s
     0     0 -108833.52    0   71 -107059.38 -108833.52  1.66%     -    0s
H    0     0                    -107913.6795 -108822.56  0.84%     -    0s
     0     0 -108424.21    0   76 -107913.68 -108424.21  0.47%     -    0s
     0     0 -108363.31    0   75 -107913.68 -108363.31  0.42%     -    0s
     0     0 -108350.89    0   76 -107913.68 -108350.89  0.41%     -    0s
     0     0 -108238.68    0   41 -107913.68 -108238.68  0.30%     -    0s
     0     0 -108202.94    0   40 -107913.68 -108202.94  0.27%     -    0s
     0     0 -108180.83    0   41 -107913.68 -108180.83  0.25%     -    0s
     0     0 -108141.63    0   21 -107913.68 -108141.63  0.21%     -    0s
H    0     0                    -108086.0840 -108131.03  0.04%     -    0s
     0     0 -108131.03    0   21 -108086.08 -108131.03  0.04%     -    0s
     0     0 -108131.03    0   13 -108086.08 -108131.03  0.04%     -    0s
     0     0 -108106.79    0    7 -108086.08 -108106.79  0.02%     -    0s
     0     0 -108106.79    0    7 -108086.08 -108106.79  0.02%     -    0s
     0     0 -108106.79    0    6 -108086.08 -108106.79  0.02%     -    0s
     0     0 -108101.29    0    6 -108086.08 -108101.29  0.01%     -    0s
H    0     0                    -108100.3267 -108101.29  0.00%     -    0s

Explored 1 nodes (682 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -108100 -108086 -107914 ... 1.50639e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.081003266908e+05, best bound -1.081012910052e+05, gap 0.0009%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 137119.57
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108100.33
  [DEBUG]   S×d_nominal = 245219.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245219.89 + -108100.33 = 137119.57
  [DEBUG]   Current θ from Master = 138948.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1829.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8548.20
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = 452.2767, Absolute Gap = 452.2767, Relative Gap = 0.043583
  Not converged yet (gap = 452.28 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567210 nonzeros
Model fingerprint: 0xad98d6da
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 102414 rows and 41574 columns
Presolve time: 3.63s
Presolved: 97739 rows, 41806 columns, 595602 nonzeros
Variable types: 39547 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371802.5864
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.837e+06
 Factor NZ  : 8.753e+06 (roughly 130 MB of memory)
 Factor Ops : 1.681e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79381879e+07  1.80051038e+08  1.00e+05 2.16e+01  7.70e+04     6s
   1  -1.37141924e+07  1.59192803e+08  7.10e+04 9.25e+01  5.40e+04     6s
   2  -4.49457161e+06  1.22720499e+08  2.26e+04 5.65e-01  1.80e+04     6s
   3  -1.09680864e+06  8.99094023e+07  2.20e+03 1.33e+00  2.15e+03     6s
   4  -7.45089698e+05  5.85653604e+07  4.91e+02 5.27e-01  6.74e+02     6s
   5  -6.81082447e+05  4.89930976e+07  2.66e+02 4.29e-01  4.57e+02     6s
   6  -4.82207248e+05  3.43497115e+07  2.08e+02 2.81e-01  3.24e+02     6s
   7  -3.68898866e+05  2.57518688e+07  5.28e+01 1.97e-01  1.76e+02     6s
   8  -2.52709137e+05  1.69419318e+07  3.26e+00 1.27e-01  9.74e+01     6s
   9  -1.77515270e+05  9.65941327e+06  1.15e+00 6.97e-02  5.52e+01     6s
  10  -1.19379032e+05  4.59394623e+06  6.45e-01 3.22e-02  2.64e+01     6s
  11  -8.64908920e+04  3.57428635e+06  4.42e-01 2.46e-02  2.05e+01     6s
  12  -6.48168616e+04  1.81482364e+06  2.76e-01 1.22e-02  1.05e+01     7s
  13  -2.60619859e+04  8.81459336e+05  1.09e-01 5.70e-03  5.07e+00     7s
  14  -1.33233421e+04  3.89521510e+05  6.69e-02 2.55e-03  2.25e+00     7s
  15  -5.52330197e+03  2.25367268e+05  4.77e-02 1.60e-03  1.29e+00     7s
  16   1.29143827e+03  1.56974020e+05  3.62e-02 1.32e-03  8.69e-01     7s
  17   5.78088468e+03  1.36446812e+05  2.96e-02 1.03e-03  7.29e-01     7s
  18   1.20711991e+04  9.87092133e+04  2.17e-02 7.95e-04  4.83e-01     7s
  19   1.75705249e+04  7.64862492e+04  1.56e-02 5.26e-04  3.29e-01     7s
  20   2.25643425e+04  6.35740294e+04  1.08e-02 3.59e-04  2.29e-01     7s
  21   2.54132613e+04  5.70003377e+04  8.22e-03 2.73e-04  1.76e-01     7s
  22   2.77414804e+04  5.17215736e+04  6.24e-03 2.03e-04  1.34e-01     7s
  23   2.88965073e+04  4.89130370e+04  5.21e-03 1.72e-04  1.12e-01     7s
  24   3.07169259e+04  4.45174636e+04  3.86e-03 1.22e-04  7.70e-02     8s
  25   3.21631265e+04  4.14106487e+04  2.81e-03 7.27e-05  5.16e-02     8s
  26   3.35267221e+04  4.04871225e+04  1.90e-03 6.03e-05  3.88e-02     8s
  27   3.38589602e+04  4.03393562e+04  1.67e-03 5.80e-05  3.61e-02     8s
  28   3.41343277e+04  3.92678643e+04  1.49e-03 4.26e-05  2.86e-02     8s
  29   3.47984169e+04  3.85621356e+04  1.05e-03 3.17e-05  2.10e-02     8s
  30   3.51711600e+04  3.79717607e+04  7.98e-04 2.25e-05  1.56e-02     8s
  31   3.55852809e+04  3.76709211e+04  5.45e-04 1.79e-05  1.16e-02     8s
  32   3.58046633e+04  3.74293336e+04  4.03e-04 1.42e-05  9.06e-03     8s
  33   3.60294168e+04  3.71254396e+04  2.65e-04 9.43e-06  6.11e-03     9s
  34   3.60815521e+04  3.69161963e+04  2.33e-04 6.41e-06  4.66e-03     9s
  35   3.61631097e+04  3.67389574e+04  1.87e-04 3.74e-06  3.21e-03     9s
  36   3.62920439e+04  3.66186128e+04  1.08e-04 6.44e-06  1.82e-03     9s
  37   3.63662751e+04  3.65799756e+04  6.67e-05 4.68e-06  1.19e-03     9s
  38   3.64268488e+04  3.65619951e+04  3.40e-05 3.62e-06  7.54e-04     9s
  39   3.64469916e+04  3.65256117e+04  2.32e-05 1.70e-06  4.39e-04     9s
  40   3.64591706e+04  3.65154671e+04  1.69e-05 1.13e-06  3.14e-04     9s
  41   3.64771027e+04  3.65073223e+04  7.84e-06 6.60e-07  1.69e-04     9s
  42   3.64900788e+04  3.64944956e+04  1.68e-06 3.14e-08  2.46e-05    10s
  43   3.64931569e+04  3.64938699e+04  2.64e-07 1.84e-08  3.98e-06    10s
  44   3.64938034e+04  3.64938388e+04  1.75e-08 5.94e-09  1.97e-07    10s
  45   3.64938193e+04  3.64938196e+04  5.64e-09 1.75e-09  1.91e-09    10s

Barrier solved model in 45 iterations and 9.78 seconds (8.62 work units)
Optimal objective 3.64938193e+04


Root crossover log...

   78881 DPushes remaining with DInf 0.0000000e+00                10s
   38166 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    7282 PPushes remaining with PInf 2.7218230e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.3115302e+01     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40062    3.6493819e+04   0.000000e+00   4.311530e+01     13s
   40084    3.6493819e+04   0.000000e+00   0.000000e+00     13s
   40084    3.6493819e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.649382e+04, 40084 iterations, 8.39 seconds (9.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36493.8194    0  374 -179468.78 36493.8194   120%     -   14s
H    0     0                    -176089.3004 36493.8194   121%     -   14s
H    0     0                    -131658.8250 36493.8194   128%     -   14s
H    0     0                    -84556.84719 36493.8194   143%     -   15s
H    0     0                    -84327.59631 36493.8194   143%     -   15s
H    0     0                    -49420.26614 36493.8194   174%     -   15s
H    0     0                    -48763.06958 36493.8194   175%     -   15s
H    0     0                    -45104.03254 36493.8194   181%     -   15s
H    0     0                    -44157.75167 36493.8194   183%     -   16s
H    0     0                    -44097.07918 36493.8194   183%     -   16s
H    0     0                    -44077.56206 36493.8194   183%     -   16s
H    0     0                    -19360.16927 36493.8194   288%     -   18s
H    0     0                    -8307.783993 36493.8194   539%     -   18s
H    0     0                    -7990.647533 36493.8194   557%     -   18s
     0     0 30153.0669    0  374 -7990.6475 30153.0669   477%     -   53s
H    0     0                    -2586.226419 30152.7242  1266%     -   54s
H    0     0                    -1161.711766 30152.7242  2696%     -   54s
H    0     0                    -543.7197301 30152.7242  5646%     -   54s
H    0     0                    -426.3997144 30152.7242  7171%     -   54s
H    0     0                    -304.9257491 30152.7242  9989%     -   54s
H    0     0                    -234.4989063 30152.7242      -     -   54s
     0     0 29346.1248    0  375 -234.49891 29346.1248      -     -   80s
     0     0 29162.6120    0  379 -234.49891 29162.6120      -     -  101s
     0     0 28930.3169    0  365 -234.49891 28930.3169      -     -  118s
     0     0 28894.1017    0  373 -234.49891 28894.1017      -     -  121s
     0     0 28893.1704    0  358 -234.49891 28893.1704      -     -  133s
     0     0 28893.1704    0  364 -234.49891 28893.1704      -     -  138s
     0     0 28893.1704    0  365 -234.49891 28893.1704      -     -  140s
     0     0 28893.1704    0  363 -234.49891 28893.1704      -     -  142s
     0     0 28893.1704    0  368 -234.49891 28893.1704      -     -  151s
     0     0 28893.1704    0  368 -234.49891 28893.1704      -     -  153s
     0     0 28893.1704    0  368 -234.49891 28893.1704      -     -  154s
     0     0 28893.1704    0  365 -234.49891 28893.1704      -     -  155s
H    0     0                    4788.0710175 25038.8107   423%     -  221s
H    0     0                    5735.5956049 25038.8107   337%     -  221s
H    0     0                    6198.4994076 25038.8107   304%     -  221s
H    0     0                    7948.5484269 25038.8107   215%     -  221s
H    0     0                    8090.9687849 25038.8107   209%     -  221s
H    0     0                    8151.5074536 25038.8107   207%     -  221s
H    0     0                    8438.3778651 25038.8107   197%     -  221s
H    0     0                    8486.7847821 25038.8107   195%     -  221s
H    0     0                    8588.6408152 25038.8107   192%     -  221s
H    0     0                    8757.0300401 25038.8107   186%     -  221s
H    0     0                    8809.0145675 25038.8107   184%     -  221s
H    0     0                    8810.7028393 25038.8107   184%     -  221s
H    0     0                    8824.5097014 25038.8107   184%     -  221s
H    0     0                    8856.1382184 25038.8107   183%     -  221s
H    0     0                    8865.4855996 25038.8107   182%     -  221s
H    0     0                    8866.7031835 25038.8107   182%     -  221s
     0     0 25038.8107    0  365 8866.70318 25038.8107   182%     -  221s
H    0     0                    8891.5355407 25038.7963   182%     -  222s
     0     0 24274.5833    0  445 8891.53554 24274.5833   173%     -  256s
H    0     0                    8902.0378348 23988.7324   169%     -  283s
H    0     0                    9505.6508308 23988.7324   152%     -  283s
H    0     0                    9505.6691412 23988.7324   152%     -  283s
     0     0 23988.7324    0  460 9505.66914 23988.7324   152%     -  283s
     0     0 23913.4520    0  409 9505.66914 23913.4520   152%     -  293s
     0     0 23890.7619    0  425 9505.66914 23890.7619   151%     -  302s
     0     0 23864.8980    0  416 9505.66914 23864.8980   151%     -  313s
     0     0 23856.3841    0  406 9505.66914 23856.3841   151%     -  318s
     0     0 23796.4185    0  426 9505.66914 23796.4185   150%     -  331s
     0     0 23772.6570    0  420 9505.66914 23772.6570   150%     -  338s
     0     0 23770.3097    0  422 9505.66914 23770.3097   150%     -  343s
     0     0 23755.9782    0  415 9505.66914 23755.9782   150%     -  346s
     0     0 23741.6485    0  424 9505.66914 23741.6485   150%     -  351s
     0     0 23740.6906    0  424 9505.66914 23740.6906   150%     -  352s
H    0     0                    9515.5372829 21785.9974   129%     -  434s
H    0     0                    9625.2600502 21785.9974   126%     -  434s
     0     0 21785.9974    0  364 9625.26005 21785.9974   126%     -  434s
H    0     0                    9635.6642271 21316.2498   121%     -  460s
     0     0 21316.2498    0  414 9635.66423 21316.2498   121%     -  460s
     0     0 21208.1482    0  427 9635.66423 21208.1482   120%     -  478s
     0     0 21158.3499    0  429 9635.66423 21158.3499   120%     -  486s
     0     0 21084.3976    0  427 9635.66423 21084.3976   119%     -  495s
     0     0 21017.0303    0  422 9635.66423 21017.0303   118%     -  506s
     0     0 20973.6004    0  431 9635.66423 20973.6004   118%     -  515s
     0     0 20941.5501    0  433 9635.66423 20941.5501   117%     -  522s
     0     0 20921.0088    0  420 9635.66423 20921.0088   117%     -  526s
     0     0 20866.0448    0  427 9635.66423 20866.0448   117%     -  534s
     0     0 20854.8298    0  440 9635.66423 20854.8298   116%     -  538s
     0     0 20849.6125    0  438 9635.66423 20849.6125   116%     -  541s
     0     0 20843.0556    0  426 9635.66423 20843.0556   116%     -  543s
     0     0 20839.3782    0  433 9635.66423 20839.3782   116%     -  544s
     0     0 20838.1526    0  437 9635.66423 20838.1526   116%     -  545s
     0     0 19961.3994    0  369 9635.66423 19961.3994   107%     -  585s
H    0     0                    9684.8796847 19961.3351   106%     -  586s
     0     0 19640.1373    0  379 9684.87968 19640.1373   103%     -  609s
     0     0 19438.6343    0  372 9684.87968 19438.6343   101%     -  633s
     0     0 19347.9660    0  385 9684.87968 19347.9660   100%     -  644s
     0     0 19290.9409    0  385 9684.87968 19290.9409  99.2%     -  655s
     0     0 19176.4965    0  377 9684.87968 19176.4965  98.0%     -  662s
     0     0 19134.7466    0  378 9684.87968 19134.7466  97.6%     -  667s
     0     0 19111.4578    0  380 9684.87968 19111.4578  97.3%     -  672s
     0     0 19110.1109    0  383 9684.87968 19110.1109  97.3%     -  673s
     0     0 18879.2842    0  378 9684.87968 18879.2842  94.9%     -  692s
     0     0 18736.9424    0  381 9684.87968 18736.9424  93.5%     -  708s
     0     0 18682.2287    0  386 9684.87968 18682.2287  92.9%     -  721s
     0     0 18469.8933    0  371 9684.87968 18469.8933  90.7%     -  738s
     0     0 18445.9053    0  380 9684.87968 18445.9053  90.5%     -  743s
     0     0 18430.8933    0  376 9684.87968 18430.8933  90.3%     -  746s
     0     0 18400.3171    0  362 9684.87968 18400.3171  90.0%     -  750s
     0     0 18371.0057    0  372 9684.87968 18371.0057  89.7%     -  754s
     0     0 18366.9796    0  386 9684.87968 18366.9796  89.6%     -  756s
     0     0 18361.3240    0  381 9684.87968 18361.3240  89.6%     -  758s
     0     0 18360.6211    0  384 9684.87968 18360.6211  89.6%     -  759s
     0     0 18160.8340    0  454 9684.87968 18160.8340  87.5%     -  774s
     0     0 18119.3894    0  497 9684.87968 18119.3894  87.1%     -  781s
     0     0 18084.0725    0  451 9684.87968 18084.0725  86.7%     -  787s
     0     0 18077.1482    0  506 9684.87968 18077.1482  86.7%     -  791s
     0     0 18014.6097    0  450 9684.87968 18014.6097  86.0%     -  799s
H    0     0                    9704.4686145 18003.4178  85.5%     -  805s
     0     0 18003.4178    0  446 9704.46861 18003.4178  85.5%     -  805s
     0     0 17998.4769    0  430 9704.46861 17998.4769  85.5%     -  807s
     0     0 17976.5484    0  427 9704.46861 17976.5484  85.2%     -  810s
     0     0 17966.4979    0  378 9704.46861 17966.4979  85.1%     -  813s
     0     0 17962.0525    0  388 9704.46861 17962.0525  85.1%     -  814s
     0     0 17959.7798    0  433 9704.46861 17959.7798  85.1%     -  815s
     0     0 17847.2505    0  388 9704.46861 17847.2505  83.9%     -  826s
H    0     0                    9718.5186184 17846.1567  83.6%     -  827s
     0     0 17798.6263    0  381 9718.51862 17798.6263  83.1%     -  831s
H    0     0                    9757.8616311 17795.5525  82.4%     -  832s
H    0     0                    9769.5149684 17795.5525  82.2%     -  832s
H    0     0                    9778.7363517 17795.5525  82.0%     -  832s
H    0     0                    9787.9637136 17795.5525  81.8%     -  832s
H    0     0                    9789.8809496 17795.5525  81.8%     -  832s
     0     0 17795.5525    0  390 9789.88095 17795.5525  81.8%     -  833s
     0     0 17793.1438    0  392 9789.88095 17793.1438  81.8%     -  834s
     0     0 17728.0109    0  458 9789.88095 17728.0109  81.1%     -  846s
     0     0 17712.5566    0  416 9789.88095 17712.5566  80.9%     -  851s
     0     0 17702.9206    0  412 9789.88095 17702.9206  80.8%     -  855s
     0     0 17699.5199    0  413 9789.88095 17699.5199  80.8%     -  857s
     0     0 17698.8131    0  413 9789.88095 17698.8131  80.8%     -  858s
     0     0 17651.7871    0  452 9789.88095 17651.7871  80.3%     -  866s
     0     0 17640.4461    0  451 9789.88095 17640.4461  80.2%     -  872s
     0     0 17628.9648    0  401 9789.88095 17628.9648  80.1%     -  876s
     0     0 17627.4590    0  406 9789.88095 17627.4590  80.1%     -  877s
     0     0 17608.4270    0  400 9789.88095 17608.4270  79.9%     -  884s
     0     0 17601.8898    0  454 9789.88095 17601.8898  79.8%     -  889s
     0     0 17597.2185    0  463 9789.88095 17597.2185  79.7%     -  892s
     0     0 17594.9260    0  452 9789.88095 17594.9260  79.7%     -  893s
     0     0 17576.1990    0  397 9789.88095 17576.1990  79.5%     -  899s
     0     0 17560.8471    0  400 9789.88095 17560.8471  79.4%     -  904s
     0     0 17551.2912    0  407 9789.88095 17551.2912  79.3%     -  906s
     0     0 17544.9361    0  403 9789.88095 17544.9361  79.2%     -  909s
     0     0 17541.8181    0  412 9789.88095 17541.8181  79.2%     -  911s
     0     0 17540.7340    0  414 9789.88095 17540.7340  79.2%     -  911s
     0     0 17525.2239    0  389 9789.88095 17525.2239  79.0%     -  917s
H    0     0                    9825.0326100 17513.1318  78.3%     -  921s
     0     0 17513.1318    0  404 9825.03261 17513.1318  78.3%     -  921s
     0     0 17511.1215    0  404 9825.03261 17511.1215  78.2%     -  924s
     0     0 17503.4829    0  460 9825.03261 17503.4829  78.2%     -  930s
     0     0 17500.4783    0  462 9825.03261 17500.4783  78.1%     -  933s
     0     0 17490.8956    0  388 9825.03261 17490.8956  78.0%     -  937s
     0     0 17490.7229    0  388 9825.03261 17490.7229  78.0%     -  942s
H    0     0                    9828.2444637 17490.5840  78.0%     - 1046s
H    0     0                    9897.0477984 17490.5840  76.7%     - 1048s
H    0     0                    9964.9179420 17490.5840  75.5%     - 1048s
     0     2 17490.5840    0  388 9964.91794 17490.5840  75.5%     - 1050s
     1     3 16586.4021    1  308 9964.91794 17490.5840  75.5%  7646 1059s
     2     6 16263.9378    2  292 9964.91794 17490.5840  75.5%  7052 1070s
     5    12 15374.5421    3  288 9964.91794 17353.7989  74.1%  7933 1085s
    11    24 15276.1870    4  285 9964.91794 17211.0142  72.7%  8824 1108s
    23    36 16375.1407    4  451 9964.91794 17046.6375  71.1% 12133 1153s
    35    68 16171.7123    5  392 9964.91794 17046.6375  71.1% 15153 1279s
H   44    68                    9966.0065887 17046.6375  71.0% 13662 1279s
H   45    68                    9966.5944967 17046.6375  71.0% 13445 1279s
H   53    68                    9977.9384032 17046.6375  70.8% 12488 1279s
    67   197 16118.7944    6  380 9977.93840 16891.1808  69.3% 18901 1324s
   200   242 15609.9075    8  307 9977.93840 16891.1808  69.3% 10248 1339s
H  215   242                    9983.3441439 16891.1808  69.2%  9849 1339s
H  228   242                    10238.758671 16891.1808  65.0%  9544 1339s
   245   290 15588.5308    9  299 10238.7587 16891.1808  65.0%  9393 1359s
   313   314 14928.4784   10  291 10238.7587 16891.1808  65.0%  8708 1377s
H  327   314                    10238.838766 16891.1808  65.0%  8553 1377s
   359   354 14113.1922   15  320 10238.8388 16730.0442  63.4%  8316 1399s
   416   382 15552.2418    9  300 10238.8388 16730.0442  63.4%  8348 1419s
H  418   382                    10257.232983 16730.0442  63.1%  8341 1419s
   452   431 14877.8463   10  295 10257.2330 16730.0442  63.1%  8295 1438s
   515   463 14650.9555   11  333 10257.2330 16730.0442  63.1%  8094 1456s
H  516   463                    10265.571562 16730.0442  63.0%  8079 1456s
   559   507 14252.2899   12  329 10265.5716 16730.0442  63.0%  7982 1475s
   628   540 13775.1491   11  189 10265.5716 16730.0442  63.0%  7837 1492s
H  666   540                    10272.530396 16730.0442  62.9%  7785 1492s
   671   583 12968.2341   12  250 10272.5304 16730.0442  62.9%  7781 1510s
   742   613 14103.5931   13  274 10272.5304 16730.0442  62.9%  7654 1527s
   788   643 13672.0658   14  235 10272.5304 16730.0442  62.9%  7611 1546s
   848   669 infeasible   27      10272.5304 16668.9452  62.3%  7486 1563s
   888   697 13103.0729   15  257 10272.5304 16668.9452  62.3%  7453 1584s
   962   752 11388.5148   16  274 10272.5304 16668.9452  62.3%  7350 1602s
H  995   752                    10308.128040 16668.9452  61.7%  7197 1602s
H  998   752                    10311.878794 16668.9452  61.6%  7188 1602s
  1050   756 12850.3923   16  339 10311.8788 16668.9452  61.6%  7108 1621s
H 1078   756                    10377.579164 16668.9452  60.6%  7149 1621s
  1104   802 11067.6648   17  262 10377.5792 16668.9452  60.6%  7120 1640s
H 1163   802                    10391.444259 16668.9452  60.4%  7002 1640s
  1174   836 10789.8154   19  254 10391.4443 16668.9452  60.4%  7026 1663s
  1273   882     cutoff   20      10391.4443 16668.9452  60.4%  6955 1684s
  1371   906     cutoff   22      10391.4443 16668.9452  60.4%  6838 1707s
  1496   966 infeasible   22      10391.4443 16087.4387  54.8%  6649 1732s
  1605  1016 11887.3397    7  311 10391.4443 16087.4387  54.8%  6527 1756s
  1733  1057 10528.3333    8  218 10391.4443 16087.4387  54.8%  6371 1778s
  1820  1102 infeasible    9      10391.4443 15990.1483  53.9%  6346 1804s
  1916  1156 14206.0791   10  289 10391.4443 15990.1483  53.9%  6316 1831s
  2002  1209 13013.1501   11  284 10391.4443 15990.1483  53.9%  6327 1859s
  2131  1241 12061.0385   14  248 10391.4443 15990.1483  53.9%  6279 1885s
  2215  1283 11471.2906   16  135 10391.4443 15868.6994  52.7%  6269 1916s
  2324  1362 10676.8464   23   77 10391.4443 15868.6994  52.7%  6309 1945s
  2471  1375 10877.8547   24   98 10391.4443 15868.6994  52.7%  6232 1977s
  2624  1399 11632.9632   15  285 10391.4443 15712.4097  51.2%  6183 2009s
  2732  1455 11219.2739   18  281 10391.4443 15712.4097  51.2%  6249 2045s
  2852  1479 10530.9812   22  272 10391.4443 15712.4097  51.2%  6282 2080s
  3010  1531 13295.0359   11  277 10391.4443 15653.4756  50.6%  6264 2117s
  3183  1584 12571.0551   15  238 10391.4443 15653.4756  50.6%  6207 2154s
  3312  1642 10535.4331   18  187 10391.4443 15653.4756  50.6%  6293 2193s
  3465  1713 12277.1876   11  315 10391.4443 15653.4756  50.6%  6272 2231s
  3649  1802 infeasible   13      10391.4443 15653.4756  50.6%  6248 2272s
  3904  1839 infeasible   14      10391.4443 15273.5219  47.0%  6150 2315s
  4096  1902 12675.7169   13  313 10391.4443 15273.5219  47.0%  6124 2359s
  4308  1996 11856.9644   23  222 10391.4443 14843.3229  42.8%  6124 2407s
  4517  2083 10978.4006   39   27 10391.4443 14843.3229  42.8%  6131 2452s
  4707  2185 infeasible   14      10391.4443 14843.3229  42.8%  6113 2506s
  4954  2331 12580.1400   14  285 10391.4443 14772.4205  42.2%  6099 2559s
  5290  2332 10885.0558   22  388 10391.4443 14585.0983  40.4%  5965 2794s
  5292  2333 11070.4093   30  281 10391.4443 14585.0983  40.4%  5963 2809s
  5293  2334 11598.0432   22  369 10391.4443 14585.0983  40.4%  5962 2912s
  5294  2335 12051.3774   20  465 10391.4443 14585.0983  40.4%  5961 2981s
  5295  2335 11997.5229   17  333 10391.4443 14585.0983  40.4%  5960 3018s
  5296  2336 11235.9501   21  366 10391.4443 14585.0983  40.4%  5959 3040s
  5297  2337 12332.0357   11  349 10391.4443 14585.0983  40.4%  5957 3057s
  5298  2337 11048.5487   32  368 10391.4443 14585.0983  40.4%  5956 3077s
  5299  2338 13749.8113    9  377 10391.4443 14585.0983  40.4%  5955 3090s
  5300  2339 10994.6537   62  373 10391.4443 14585.0983  40.4%  5954 3099s
  5301  2339 11496.4683   21  378 10391.4443 14585.0983  40.4%  5953 3105s
  5302  2340 10782.1772   50  372 10391.4443 14585.0983  40.4%  5952 3116s
  5303  2341 13762.9386   10  377 10391.4443 14585.0983  40.4%  5951 3123s
  5304  2341 10578.6854   20  389 10391.4443 14585.0983  40.4%  5950 3133s
  5305  2342 10579.7768   56  387 10391.4443 14585.0983  40.4%  5948 3137s
  5306  2343 10829.5453   48  493 10391.4443 14585.0983  40.4%  5947 3155s
  5307  2343 13741.0833   12  387 10391.4443 14585.0983  40.4%  5946 3161s
  5308  2344 10622.0844   27  390 10391.4443 14585.0983  40.4%  5945 3166s
  5309  2345 11044.9072   21  398 10391.4443 14585.0983  40.4%  5944 3172s
  5310  2345 10940.9610   45  438 10391.4443 14585.0983  40.4%  5943 3185s
  5311  2346 12018.5450    8  392 10391.4443 14585.0983  40.4%  5942 3191s
  5312  2347 11418.9899   25  403 10391.4443 14585.0983  40.4%  5941 3200s
  5313  2347 11712.2081   20  393 10391.4443 14585.0983  40.4%  5940 3206s
  5314  2348 10838.5146   22  387 10391.4443 14585.0983  40.4%  5938 3216s
  5315  2349 10722.9154   18  387 10391.4443 14585.0983  40.4%  5937 3222s
  5316  2349 11786.4091   28  389 10391.4443 14585.0983  40.4%  5936 3230s
  5317  2350 12973.0994   23  389 10391.4443 14585.0983  40.4%  5935 3235s
  5318  2351 11366.2893   14  387 10391.4443 14585.0983  40.4%  5934 3242s
  5319  2351 12392.6444   11  394 10391.4443 14585.0983  40.4%  5933 3248s
  5320  2352 13101.1322   15  449 10391.4443 14585.0983  40.4%  5932 3256s
  5321  2353 11604.7988   18  398 10391.4443 14585.0983  40.4%  5931 3262s
  5322  2353 13354.1080   13  401 10391.4443 14585.0983  40.4%  5929 3269s
  5323  2354 11236.7591   20  505 10391.4443 14585.0983  40.4%  5928 3275s
  5324  2355 11620.2129   16  438 10391.4443 14585.0983  40.4%  5927 3283s
  5325  2355 10524.8111   18  438 10391.4443 14585.0983  40.4%  5926 3321s
  5326  2356 11218.9365   27  438 10391.4443 14585.0983  40.4%  5925 3379s
  5327  2360 14585.0983   16  478 10391.4443 14585.0983  40.4%  5979 3419s
  5329  2363 14585.0983   17  479 10391.4443 14585.0983  40.4%  5979 3434s
  5333  2370 14585.0983   18  472 10391.4443 14585.0983  40.4%  5980 3471s
  5341  2383 14585.0983   19  414 10391.4443 14585.0983  40.4%  5989 3519s
  5357  2394 14585.0983   20  407 10391.4443 14585.0983  40.4%  6018 3566s
  5373  2413 14585.0983   21  382 10391.4443 14585.0983  40.4%  6062 3600s

Cutting planes:
  Gomory: 29
  Implied bound: 66
  Projected implied bound: 290
  MIR: 1054
  Mixing: 2
  Flow cover: 1231
  RLT: 49
  Relax-and-lift: 221

Explored 5404 nodes (33428571 simplex iterations) in 3600.15 seconds (5713.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10391.4 10377.6 10311.9 ... 9983.34

Time limit reached
Best objective 1.039144425911e+04, best bound 1.458509829962e+04, gap 40.3568%
  WARNING: Time limit reached. Using best solution found (gap: 40.36%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 10391.44, θ = 138971.39
  Upper Bound (UB) = 10391.44

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 138971.39
  [DEBUG]   ✓ Scenario 0: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 138971.39 ≤ Q = 138971.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 138971.39 ≤ Q = 138971.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 138971.39 ≤ Q = 138971.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 138971.39 ≤ Q = 138971.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3eb8b242
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3eb8b242
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.496387e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6802256.1096
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.336096e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133609.62    0  123 6802256.11 -133609.62   102%     -    0s
H    0     0                    -104853.8014 -133609.62  27.4%     -    0s
H    0     0                    -105006.9624 -133609.62  27.2%     -    0s
     0     0 -109234.09    0  124 -105006.96 -109234.09  4.03%     -    0s
H    0     0                    -106394.6961 -109130.99  2.57%     -    0s
     0     0 -108391.24    0  122 -106394.70 -108391.24  1.88%     -    0s
H    0     0                    -107344.5473 -108382.64  0.97%     -    0s
     0     0 -108188.67    0   75 -107344.55 -108188.67  0.79%     -    0s
H    0     0                    -107359.0055 -108168.66  0.75%     -    0s
     0     0 -108120.83    0   75 -107359.01 -108120.83  0.71%     -    0s
     0     0 -108110.14    0   74 -107359.01 -108110.14  0.70%     -    0s
     0     0 -107939.82    0   57 -107359.01 -107939.82  0.54%     -    0s
H    0     0                    -107361.0599 -107938.93  0.54%     -    0s
     0     0 -107929.82    0   62 -107361.06 -107929.82  0.53%     -    0s
     0     0 -107890.26    0   62 -107361.06 -107890.26  0.49%     -    0s
     0     0 -107873.50    0   62 -107361.06 -107873.50  0.48%     -    0s
H    0     0                    -107374.2954 -107862.87  0.46%     -    0s
H    0     0                    -107381.3790 -107862.87  0.45%     -    0s
     0     2 -107862.87    0   62 -107381.38 -107862.87  0.45%     -    0s
H   50    47                    -107564.7281 -107717.49  0.14%  12.1    0s
H   76     7                    -107716.8526 -107717.31  0.00%  11.1    0s

Cutting planes:
  Gomory: 48
  Implied bound: 9
  MIR: 169
  Flow cover: 21
  RLT: 2
  BQP: 1

Explored 136 nodes (1543 simplex iterations) in 0.14 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -107717 -107565 -107381 ... -104854
No other solutions better than -107717

Optimal solution found (tolerance 1.00e-04)
Best objective -1.077168525872e+05, best bound -1.077168525872e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 137685.10
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107716.85
  [DEBUG]   S×d_nominal = 245401.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245401.95 + -107716.85 = 137685.10
  [DEBUG]   Current θ from Master = 138971.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1286.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9105.15
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = 466.3865, Absolute Gap = 466.3865, Relative Gap = 0.044882
  Not converged yet (gap = 466.39 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610417 nonzeros
Model fingerprint: 0x0f6e8258
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 110292 rows and 44772 columns
Presolve time: 3.63s
Presolved: 105151 rows, 44848 columns, 638081 nonzeros
Variable types: 42589 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372846.9779
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 4.263e+06
 Factor NZ  : 9.948e+06 (roughly 140 MB of memory)
 Factor Ops : 1.999e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84459948e+07  1.91992187e+08  1.03e+05 1.94e+01  7.88e+04     6s
   1  -1.40716677e+07  1.70580044e+08  7.28e+04 9.39e+01  5.51e+04     6s
   2  -4.40529090e+06  1.32423939e+08  2.22e+04 7.02e-01  1.76e+04     6s
   3  -2.14971641e+06  1.12613700e+08  7.35e+03 6.84e+00  6.14e+03     6s
   4  -8.28748175e+05  8.63648657e+07  9.01e+02 3.60e+00  1.11e+03     6s
   5  -7.28536318e+05  4.35844602e+07  4.52e+02 1.42e+00  5.21e+02     6s
   6  -5.99629127e+05  3.74616776e+07  1.96e+02 1.18e+00  3.20e+02     6s
   7  -3.80292738e+05  2.45568387e+07  9.03e+01 6.75e-01  1.80e+02     6s
   8  -3.22837201e+05  1.51606314e+07  6.01e+01 1.77e-02  1.08e+02     6s
   9  -1.73254696e+05  8.84984199e+06  9.06e+00 9.09e-03  5.00e+01     6s
  10  -1.04538115e+05  5.44428868e+06  4.66e+00 3.82e-02  2.99e+01     6s
  11  -8.90361454e+04  3.28779538e+06  3.36e+00 1.02e-02  1.80e+01     6s
  12  -7.45293846e+04  2.88934004e+06  2.42e+00 1.36e-02  1.57e+01     6s
  13  -4.56592076e+04  1.91415049e+06  1.23e+00 1.55e-02  1.03e+01     7s
  14  -1.88500816e+04  6.07323188e+05  4.67e-01 4.85e-04  3.27e+00     7s
  15  -1.01061949e+04  3.28896593e+05  2.87e-01 2.47e-04  1.77e+00     7s
  16  -1.97458622e+03  2.21200766e+05  1.91e-01 1.69e-04  1.16e+00     7s
  17   2.29034042e+03  1.63667938e+05  1.53e-01 1.65e-04  8.40e-01     7s
  18   6.91040101e+03  1.09516877e+05  1.23e-01 2.46e-04  5.34e-01     7s
  19   1.13005295e+04  8.79269907e+04  9.93e-02 5.64e-04  3.99e-01     7s
  20   1.45794375e+04  7.30662574e+04  8.46e-02 5.02e-04  3.04e-01     7s
  21   1.81402880e+04  6.42678814e+04  7.02e-02 8.07e-04  2.40e-01     7s
  22   2.22514457e+04  5.79791829e+04  5.42e-02 1.04e-03  1.86e-01     7s
  23   2.52105903e+04  5.24357224e+04  4.32e-02 1.08e-03  1.42e-01     7s
  24   2.82462994e+04  5.04285276e+04  3.24e-02 7.86e-04  1.15e-01     7s
  25   3.05331270e+04  4.72363913e+04  2.47e-02 7.93e-04  8.68e-02     7s
  26   3.22346790e+04  4.46994344e+04  1.93e-02 8.35e-04  6.48e-02     8s
  27   3.39782176e+04  4.35937856e+04  1.38e-02 7.28e-04  5.00e-02     8s
  28   3.50307774e+04  4.27122523e+04  1.07e-02 6.05e-04  3.99e-02     8s
  29   3.54853543e+04  4.17612107e+04  9.33e-03 4.56e-04  3.26e-02     8s
  30   3.65697147e+04  4.13643338e+04  6.03e-03 3.94e-04  2.49e-02     8s
  31   3.66840103e+04  4.04545116e+04  5.68e-03 2.60e-04  1.96e-02     8s
  32   3.69291357e+04  4.04104051e+04  5.00e-03 2.52e-04  1.81e-02     8s
  33   3.73823900e+04  4.00651747e+04  3.70e-03 2.02e-04  1.39e-02     8s
  34   3.75395640e+04  3.98877395e+04  3.26e-03 1.75e-04  1.22e-02     8s
  35   3.79566356e+04  3.94779880e+04  2.12e-03 1.06e-04  7.91e-03     8s
  36   3.79993798e+04  3.93248023e+04  2.00e-03 8.34e-05  6.89e-03     9s
  37   3.81643578e+04  3.92717575e+04  1.57e-03 7.69e-05  5.76e-03     9s
  38   3.82532964e+04  3.92330672e+04  1.34e-03 7.06e-05  5.09e-03     9s
  39   3.83521825e+04  3.91115996e+04  1.08e-03 5.49e-05  3.95e-03     9s
  40   3.84469005e+04  3.90019434e+04  8.32e-04 3.56e-05  2.89e-03     9s
  41   3.85536747e+04  3.89708044e+04  5.71e-04 3.06e-05  2.17e-03     9s
  42   3.86049299e+04  3.89006110e+04  4.37e-04 1.91e-05  1.54e-03     9s
  43   3.86824098e+04  3.88666065e+04  2.40e-04 1.31e-05  9.57e-04     9s
  44   3.87287522e+04  3.88351944e+04  1.27e-04 8.10e-06  5.53e-04     9s
  45   3.87417724e+04  3.88267032e+04  9.65e-05 6.68e-06  4.41e-04    10s
  46   3.87701322e+04  3.87959605e+04  3.14e-05 1.64e-06  1.34e-04    10s
  47   3.87831485e+04  3.87856330e+04  3.44e-06 6.37e-08  1.29e-05    10s
  48   3.87850461e+04  3.87850709e+04  1.17e-08 3.26e-07  1.29e-07    10s
  49   3.87850532e+04  3.87850702e+04  6.02e-10 3.12e-07  8.80e-08    10s
  50   3.87850532e+04  3.87850680e+04  4.69e-09 2.72e-07  7.67e-08    10s
  51   3.87850532e+04  3.87850614e+04  1.14e-08 8.37e-06  4.31e-08    10s
  52   3.87850534e+04  3.87850534e+04  7.81e-09 1.88e-07  1.50e-11    10s

Barrier solved model in 52 iterations and 10.46 seconds (10.40 work units)
Optimal objective 3.87850534e+04


Root crossover log...

   84915 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2601 PPushes remaining with PInf 1.6409196e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.7394507e-11     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32128    3.8785053e+04   0.000000e+00   0.000000e+00     13s
   32128    3.8785053e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.05s

Solved with barrier

Root relaxation: objective 3.878505e+04, 32128 iterations, 8.54 seconds (10.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38785.0534    0  392 -179468.78 38785.0534   122%     -   13s
H    0     0                    -134130.3035 38785.0534   129%     -   14s
H    0     0                    -89568.11550 38785.0534   143%     -   14s
H    0     0                    -69320.68677 38785.0534   156%     -   14s
H    0     0                    -43213.60350 38785.0534   190%     -   14s
H    0     0                    -11293.51982 38785.0534   443%     -   14s
H    0     0                    4500.5792924 38785.0534   762%     -   15s
H    0     0                    4594.6181708 38785.0534   744%     -   15s
H    0     0                    7528.3682914 32110.2293   327%     -   44s
H    0     0                    7628.9748809 32110.2293   321%     -   44s
     0     0 31957.8344    0  362 7628.97488 31957.8344   319%     -   44s
H    0     0                    7632.0032250 31957.8344   319%     -   45s
     0     0 31295.2776    0  379 7632.00323 31295.2776   310%     -   62s
     0     0 31245.7091    0  390 7632.00323 31245.7091   309%     -   74s
     0     0 31245.7091    0  394 7632.00323 31245.7091   309%     -   77s
     0     0 31245.7091    0  382 7632.00323 31245.7091   309%     -   78s
     0     0 31244.6720    0  382 7632.00323 31244.6720   309%     -   78s
     0     0 31233.3436    0  378 7632.00323 31233.3436   309%     -   80s
     0     0 31232.9127    0  380 7632.00323 31232.9127   309%     -   80s
     0     0 26759.7386    0  402 7632.00323 26759.7386   251%     -  139s
H    0     0                    8153.9495085 26759.5703   228%     -  140s
H    0     0                    8203.7963797 26759.5703   226%     -  141s
H    0     0                    8213.9234968 26759.5703   226%     -  141s
H    0     0                    8244.3298427 26759.5703   225%     -  141s
H    0     0                    8244.6784267 26759.5703   225%     -  141s
H    0     0                    8260.0573807 26759.5703   224%     -  141s
     0     0 25885.6816    0  445 8260.05738 25885.6816   213%     -  191s
     0     0 25688.1674    0  454 8260.05738 25688.1674   211%     -  217s
     0     0 25547.7365    0  479 8260.05738 25547.7365   209%     -  238s
     0     0 25513.2943    0  474 8260.05738 25513.2943   209%     -  251s
     0     0 25494.2232    0  470 8260.05738 25494.2232   209%     -  261s
     0     0 25460.1162    0  472 8260.05738 25460.1162   208%     -  270s
     0     0 25341.7693    0  458 8260.05738 25341.7693   207%     -  284s
     0     0 25331.1292    0  458 8260.05738 25331.1292   207%     -  290s
     0     0 25245.7662    0  450 8260.05738 25245.7662   206%     -  300s
H    0     0                    8261.3382971 25206.0409   205%     -  306s
H    0     0                    8300.8538404 25206.0409   204%     -  306s
H    0     0                    8303.5216044 25206.0409   204%     -  306s
H    0     0                    8322.2283004 25206.0409   203%     -  306s
     0     0 25206.0409    0  428 8322.22830 25206.0409   203%     -  306s
     0     0 25196.6257    0  425 8322.22830 25196.6257   203%     -  309s
     0     0 25194.5971    0  423 8322.22830 25194.5971   203%     -  311s
     0     0 25194.1407    0  423 8322.22830 25194.1407   203%     -  312s
H    0     0                    8766.5975308 22398.8083   156%     -  411s
H    0     0                    8844.3888636 22398.8083   153%     -  411s
H    0     0                    9163.6965697 22398.8083   144%     -  411s
H    0     0                    9194.8863016 22398.8083   144%     -  411s
H    0     0                    9231.3239056 22398.8083   143%     -  411s
     0     0 22398.8083    0  348 9231.32391 22398.8083   143%     -  411s
H    0     0                    9233.4449351 22398.3586   143%     -  413s
H    0     0                    9312.9995066 22398.3586   141%     -  413s
H    0     0                    9320.8470428 22398.3586   140%     -  413s
     0     0 21597.2100    0  362 9320.84704 21597.2100   132%     -  471s
     0     0 21330.4413    0  369 9320.84704 21330.4413   129%     -  495s
H    0     0                    9375.4210412 21260.7919   127%     -  511s
H    0     0                    9432.9450180 21260.7919   125%     -  511s
     0     0 21260.7919    0  442 9432.94502 21260.7919   125%     -  512s
     0     0 21198.6130    0  439 9432.94502 21198.6130   125%     -  529s
     0     0 21067.2715    0  428 9432.94502 21067.2715   123%     -  551s
     0     0 21043.3788    0  426 9432.94502 21043.3788   123%     -  563s
     0     0 21006.9004    0  409 9432.94502 21006.9004   123%     -  575s
     0     0 20987.7639    0  410 9432.94502 20987.7639   122%     -  584s
     0     0 20975.7903    0  407 9432.94502 20975.7903   122%     -  591s
     0     0 20953.9336    0  408 9432.94502 20953.9336   122%     -  598s
     0     0 20944.4570    0  408 9432.94502 20944.4570   122%     -  603s
     0     0 20939.4407    0  414 9432.94502 20939.4407   122%     -  607s
     0     0 20936.0462    0  407 9432.94502 20936.0462   122%     -  611s
H    0     0                    9458.7497523 20870.6157   121%     -  623s
     0     0 20870.6157    0  407 9458.74975 20870.6157   121%     -  623s
     0     0 20859.9500    0  396 9458.74975 20859.9500   121%     -  627s
     0     0 20856.4327    0  395 9458.74975 20856.4327   120%     -  629s
     0     0 20853.6716    0  415 9458.74975 20853.6716   120%     -  632s
     0     0 19853.2169    0  376 9458.74975 19853.2169   110%     -  684s
H    0     0                    9465.5078044 19852.8419   110%     -  685s
     0     0 19527.6659    0  387 9465.50780 19527.6659   106%     -  713s
H    0     0                    9686.1139183 19428.6183   101%     -  730s
H    0     0                    9730.4742389 19428.6183   100%     -  730s
     0     0 19428.6183    0  387 9730.47424 19428.6183   100%     -  730s
     0     0 19400.6500    0  387 9730.47424 19400.6500  99.4%     -  741s
     0     0 19324.4593    0  399 9730.47424 19324.4593  98.6%     -  754s
     0     0 19203.3872    0  397 9730.47424 19203.3872  97.4%     -  767s
     0     0 19127.9677    0  397 9730.47424 19127.9677  96.6%     -  775s
     0     0 19086.8621    0  393 9730.47424 19086.8621  96.2%     -  782s
     0     0 19034.7872    0  391 9730.47424 19034.7872  95.6%     -  788s
     0     0 18995.5653    0  394 9730.47424 18995.5653  95.2%     -  794s
     0     0 18991.2661    0  402 9730.47424 18991.2661  95.2%     -  797s
     0     0 18989.3812    0  400 9730.47424 18989.3812  95.2%     -  799s
     0     0 18757.6072    0  377 9730.47424 18757.6072  92.8%     -  820s
H    0     0                    9786.5385237 18757.4351  91.7%     -  821s
H    0     0                    9812.1439191 18757.4351  91.2%     -  821s
     0     0 18707.2038    0  382 9812.14392 18707.2038  90.7%     -  830s
     0     0 18655.5854    0  383 9812.14392 18655.5854  90.1%     -  837s
     0     0 18638.4356    0  389 9812.14392 18638.4356  90.0%     -  841s
     0     0 18628.1682    0  393 9812.14392 18628.1682  89.8%     -  844s
     0     0 18607.4688    0  392 9812.14392 18607.4688  89.6%     -  851s
     0     0 18580.7478    0  394 9812.14392 18580.7478  89.4%     -  859s
     0     0 18572.1506    0  387 9812.14392 18572.1506  89.3%     -  862s
     0     0 18483.8772    0  403 9812.14392 18483.8772  88.4%     -  866s
     0     0 18458.9722    0  411 9812.14392 18458.9722  88.1%     -  871s
     0     0 18456.7833    0  405 9812.14392 18456.7833  88.1%     -  873s
     0     0 18310.5986    0  459 9812.14392 18310.5986  86.6%     -  890s
H    0     0                    9817.1384227 18310.5061  86.5%     -  894s
     0     0 18277.6846    0  452 9817.13842 18277.6846  86.2%     -  902s
     0     0 18253.5501    0  388 9817.13842 18253.5501  85.9%     -  907s
     0     0 18242.9265    0  394 9817.13842 18242.9265  85.8%     -  911s
     0     0 18239.5435    0  409 9817.13842 18239.5435  85.8%     -  914s
     0     0 18161.7273    0  401 9817.13842 18161.7273  85.0%     -  927s
     0     0 18142.3724    0  378 9817.13842 18142.3724  84.8%     -  934s
     0     0 18104.2663    0  385 9817.13842 18104.2663  84.4%     -  945s
     0     0 18095.0191    0  399 9817.13842 18095.0191  84.3%     -  951s
     0     0 18088.1250    0  400 9817.13842 18088.1250  84.3%     -  955s
     0     0 18083.0173    0  398 9817.13842 18083.0173  84.2%     -  959s
     0     0 18080.6199    0  401 9817.13842 18080.6199  84.2%     -  962s
     0     0 17959.8694    0  453 9817.13842 17959.8694  82.9%     -  984s
H    0     0                    9840.1010544 17959.1876  82.5%     -  986s
H    0     0                    9845.5442487 17959.1876  82.4%     -  986s
     0     0 17910.2155    0  458 9845.54425 17910.2155  81.9%     -  996s
     0     0 17902.4182    0  460 9845.54425 17902.4182  81.8%     - 1002s
     0     0 17889.8351    0  467 9845.54425 17889.8351  81.7%     - 1007s
     0     0 17884.8064    0  469 9845.54425 17884.8064  81.7%     - 1010s
     0     0 17883.2127    0  469 9845.54425 17883.2127  81.6%     - 1013s
     0     0 17773.5824    0  454 9845.54425 17773.5824  80.5%     - 1031s
     0     0 17699.7551    0  422 9845.54425 17699.7551  79.8%     - 1042s
     0     0 17665.4796    0  418 9845.54425 17665.4796  79.4%     - 1050s
     0     0 17660.1102    0  425 9845.54425 17660.1102  79.4%     - 1055s
     0     0 17656.3997    0  433 9845.54425 17656.3997  79.3%     - 1058s
     0     0 17655.1060    0  424 9845.54425 17655.1060  79.3%     - 1060s
     0     0 17612.5712    0  475 9845.54425 17612.5712  78.9%     - 1069s
     0     0 17592.1611    0  469 9845.54425 17592.1611  78.7%     - 1076s
     0     0 17588.2109    0  422 9845.54425 17588.2109  78.6%     - 1080s
     0     0 17586.1369    0  427 9845.54425 17586.1369  78.6%     - 1082s
     0     0 17545.1976    0  476 9845.54425 17545.1976  78.2%     - 1093s
     0     0 17526.5168    0  475 9845.54425 17526.5168  78.0%     - 1099s
     0     0 17517.8535    0  473 9845.54425 17517.8535  77.9%     - 1103s
     0     0 17513.5583    0  483 9845.54425 17513.5583  77.9%     - 1105s
     0     0 17508.7374    0  483 9845.54425 17508.7374  77.8%     - 1107s
     0     0 17507.2276    0  486 9845.54425 17507.2276  77.8%     - 1108s
     0     0 17467.0714    0  413 9845.54425 17467.0714  77.4%     - 1118s
     0     0 17439.6457    0  496 9845.54425 17439.6457  77.1%     - 1132s
     0     0 17431.4831    0  435 9845.54425 17431.4831  77.0%     - 1136s
     0     0 17429.5914    0  431 9845.54425 17429.5914  77.0%     - 1138s
     0     0 17415.5503    0  432 9845.54425 17415.5503  76.9%     - 1146s
     0     0 17411.9019    0  430 9845.54425 17411.9019  76.9%     - 1153s
     0     0 17394.5648    0  507 9845.54425 17394.5648  76.7%     - 1164s
     0     0 17387.6883    0  485 9845.54425 17387.6883  76.6%     - 1170s
     0     0 17382.3514    0  426 9845.54425 17382.3514  76.6%     - 1173s
     0     0 17381.7542    0  427 9845.54425 17381.7542  76.5%     - 1175s
     0     0 17372.4813    0  483 9845.54425 17372.4813  76.5%     - 1181s
     0     0 17371.4427    0  483 9845.54425 17371.4427  76.4%     - 1187s
     0     2 17371.4427    0  483 9845.54425 17371.4427  76.4%     - 1274s
     1     3 17019.3477    1  442 9845.54425 17371.0624  76.4% 13246 1292s
     2     4 17239.2592    1  478 9845.54425 17239.2592  75.1%  9112 1303s
     3     7 16752.8004    2  385 9845.54425 17239.1917  75.1%  7108 1321s
     6    13 16904.6598    3  394 9845.54425 17239.0101  75.1%  8839 1347s
    12    26 16805.2846    4  391 9845.54425 16903.5898  71.7% 10144 1369s
    25    39 16488.6726    5  409 9845.54425 16802.5711  70.7% 14501 2559s
    38    71 14340.9322    6  202 9845.54425 16802.5711  70.7% 25176 2841s
H   42    71                    9846.8454908 16802.5711  70.6% 23803 2841s
    70   213 14185.8584    7  189 9846.84549 16560.2211  68.2% 24291 2904s
   212   281 10620.1197   12  158 9846.84549 16559.4136  68.2% 12365 2932s
H  223   281                    10050.525623 16559.4136  64.8% 11939 2932s
   280   334     cutoff   17      10050.5256 16559.4136  64.8% 10697 2985s
H  341   384                    10113.287533 16559.4136  63.7% 10041 3008s
   405   433 infeasible   13      10113.2875 16559.4136  63.7%  9556 3031s
   467   458 12191.8840   12  324 10113.2875 16559.4136  63.7%  9346 3055s
H  498   482                    10118.534166 16559.4136  63.7%  9300 3076s
H  503   482                    10129.503771 16559.4136  63.5%  9291 3076s
H  505   482                    10149.056049 16559.4136  63.2%  9279 3076s
   536   505 11262.9558   15  312 10149.0560 16559.4136  63.2%  9152 3098s
   571   536 11254.4970   16  230 10149.0560 16559.4136  63.2%  9155 3118s
H  600   536                    10188.679765 16559.4136  62.5%  9080 3118s
   618   580 11254.0846   17  226 10188.6798 16559.4136  62.5%  9101 3141s
   701   624 infeasible   20      10188.6798 16406.4321  61.0%  8773 3164s
H  704   624                    10189.015886 16406.4321  61.0%  8738 3164s
   781   663 11117.2674   18  303 10189.0159 16406.4321  61.0%  8519 3186s
   860   673 infeasible   22      10189.0159 16406.4321  61.0%  8244 3205s
   906   700 10668.4097   22  162 10189.0159 16393.0332  60.9%  8180 3226s
   947   733 10665.7470   23  157 10189.0159 16207.9929  59.1%  8166 3247s
  1016   777 10597.8496   24  158 10189.0159 16207.9929  59.1%  8013 3271s
  1087   836 infeasible   23      10189.0159 16207.9929  59.1%  7966 3292s
  1166   915 14300.2147   12  430 10189.0159 16207.9929  59.1%  7914 3316s
  1265   964 11711.4645   25  268 10189.0159 16174.2924  58.7%  7767 3340s
  1364   997 11543.2372   25  376 10189.0159 16174.2924  58.7%  7673 3369s
  1461  1021 10284.9161   12  289 10189.0159 16174.2924  58.7%  7634 3397s
  1520  1041 infeasible   13      10189.0159 16174.2924  58.7%  7628 3428s
  1588  1093 11394.9885   19  303 10189.0159 16174.2924  58.7%  7673 3460s
  1681  1138 10959.8142   22  287 10189.0159 16174.2924  58.7%  7639 3491s
  1787  1180 10749.0215   27  267 10189.0159 16174.2924  58.7%  7542 3522s
  1892  1230 infeasible   32      10189.0159 16174.2924  58.7%  7446 3554s
  1982  1312 14589.3615    7  364 10189.0159 16174.2924  58.7%  7473 3590s
  2086  1330 10896.4653   20  417 10189.0159 16174.2924  58.7%  7497 3600s

Cutting planes:
  Learned: 2
  Gomory: 33
  Implied bound: 306
  MIR: 3209
  Flow cover: 2868
  RLT: 176
  Relax-and-lift: 973

Explored 2106 nodes (16561026 simplex iterations) in 3600.06 seconds (4505.34 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10189 10188.7 10149.1 ... 9840.1

Time limit reached
Best objective 1.018901588630e+04, best bound 1.617429242568e+04, gap 58.7424%
  WARNING: Time limit reached. Using best solution found (gap: 58.74%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 10189.02, θ = 138672.06
  Upper Bound (UB) = 10189.02

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 138672.06
  [DEBUG]   ✓ Scenario 0: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 138672.06 ≤ Q = 138672.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 138672.06 ≤ Q = 138672.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 138672.06 ≤ Q = 138673.73 (slack: 1.68)
  [DEBUG]   ✓ Scenario 7: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 138672.06 ≤ Q = 138672.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 138672.06 ≤ Q = 138672.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1def50f8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1def50f8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.496387e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6758836.0052
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.341651e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134165.09    0  123 6758836.01 -134165.09   102%     -    0s
H    0     0                    -105427.3883 -134165.09  27.3%     -    0s
H    0     0                    -105580.5494 -134165.09  27.1%     -    0s
     0     0 -114451.66    0   70 -105580.55 -114451.66  8.40%     -    0s
H    0     0                    -112476.6267 -114355.65  1.67%     -    0s
H    0     0                    -112797.3262 -114355.65  1.38%     -    0s
     0     0 -113510.72    0   64 -112797.33 -113510.72  0.63%     -    0s
H    0     0                    -112810.2912 -113503.15  0.61%     -    0s
     0     0 -113445.70    0   61 -112810.29 -113445.70  0.56%     -    0s
     0     0 -113140.77    0   44 -112810.29 -113140.77  0.29%     -    0s
     0     0 -113053.36    0   34 -112810.29 -113053.36  0.22%     -    0s
     0     0 -113036.08    0   45 -112810.29 -113036.08  0.20%     -    0s
H    0     0                    -112819.9994 -113031.22  0.19%     -    0s
     0     0 -113031.22    0   39 -112820.00 -113031.22  0.19%     -    0s
     0     0 -112936.49    0   22 -112820.00 -112936.49  0.10%     -    0s
     0     0 -112936.49    0   32 -112820.00 -112936.49  0.10%     -    0s
     0     0 -112936.49    0   30 -112820.00 -112936.49  0.10%     -    0s
     0     0 -112936.49    0   25 -112820.00 -112936.49  0.10%     -    0s
     0     0 -112877.02    0   11 -112820.00 -112877.02  0.05%     -    0s
     0     0 -112850.69    0    5 -112820.00 -112850.69  0.03%     -    0s
H    0     0                    -112841.7132 -112844.14  0.00%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 13
  Flow cover: 5
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (802 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -112842 -112820 -112810 ... 1.49639e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.128417132273e+05, best bound -1.128441354662e+05, gap 0.0021%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 132769.03
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112841.71
  [DEBUG]   S×d_nominal = 245610.74
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245610.74 + -112841.71 = 132769.03
  [DEBUG]   Current θ from Master = 138672.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5903.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4285.99
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = 263.9582, Absolute Gap = 263.9582, Relative Gap = 0.025906
  Not converged yet (gap = 263.96 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653624 nonzeros
Model fingerprint: 0xd7720429
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 118170 rows and 47970 columns
Presolve time: 4.02s
Presolved: 112563 rows, 47890 columns, 682349 nonzeros
Variable types: 45631 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372846.9779
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 4.782e+06
 Factor NZ  : 1.113e+07 (roughly 160 MB of memory)
 Factor Ops : 2.328e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89434059e+07  2.03875393e+08  1.06e+05 1.88e+01  8.05e+04     7s
   1  -1.45356392e+07  1.81905515e+08  7.52e+04 9.32e+01  5.66e+04     7s
   2  -3.73032600e+06  1.41477704e+08  2.01e+04 6.44e-01  1.59e+04     7s
   3  -1.93235891e+06  1.38563978e+08  9.40e+03 1.18e+01  7.79e+03     7s
   4  -7.18269904e+05  1.09805471e+08  1.05e+03 2.48e-01  1.31e+03     7s
   5  -5.61195886e+05  7.01469159e+07  4.64e+02 1.37e-01  6.56e+02     7s
   6  -4.67519062e+05  4.05129484e+07  2.51e+02 7.04e-02  3.50e+02     7s
   7  -3.59484450e+05  2.73962679e+07  1.01e+02 4.39e-02  1.90e+02     7s
   8  -2.39278707e+05  1.56714700e+07  2.78e+01 2.23e-02  8.94e+01     7s
   9  -1.43498804e+05  7.40078381e+06  8.23e+00 9.45e-03  3.88e+01     7s
  10  -9.78165055e+04  4.38020019e+06  4.90e+00 5.41e-03  2.26e+01     8s
  11  -7.80367753e+04  3.30876582e+06  3.33e+00 4.05e-03  1.69e+01     8s
  12  -4.84193055e+04  2.30622135e+06  1.59e+00 2.78e-03  1.16e+01     8s
  13  -2.49616177e+04  1.54061085e+06  7.88e-01 1.81e-03  7.65e+00     8s
  14  -1.55697365e+04  5.21711438e+05  4.79e-01 5.50e-04  2.62e+00     8s
  15  -5.41069765e+03  2.68565073e+05  2.65e-01 2.70e-04  1.33e+00     8s
  16  -9.25551055e+02  1.78766470e+05  2.05e-01 1.83e-04  8.75e-01     8s
  17   4.64956494e+03  1.54875682e+05  1.60e-01 1.66e-04  7.31e-01     8s
  18   1.06922639e+04  1.13396814e+05  1.18e-01 1.84e-04  5.00e-01     8s
  19   1.57602201e+04  8.60495264e+04  8.78e-02 9.76e-05  3.42e-01     8s
  20   2.02516732e+04  7.26180195e+04  6.63e-02 4.27e-04  2.55e-01     8s
  21   2.34243025e+04  6.35978031e+04  5.15e-02 1.01e-03  1.95e-01     8s
  22   2.67409373e+04  5.70506233e+04  3.86e-02 1.02e-03  1.47e-01     9s
  23   2.89962824e+04  5.22763897e+04  3.03e-02 9.97e-04  1.13e-01     9s
  24   3.14019555e+04  4.89982032e+04  2.21e-02 1.12e-03  8.55e-02     9s
  25   3.29201901e+04  4.58489624e+04  1.71e-02 6.91e-04  6.29e-02     9s
  26   3.43471289e+04  4.46580149e+04  1.26e-02 5.66e-04  5.01e-02     9s
  27   3.51134758e+04  4.33715719e+04  1.03e-02 4.46e-04  4.01e-02     9s
  28   3.56019184e+04  4.24983587e+04  8.81e-03 3.69e-04  3.35e-02     9s
  29   3.60912924e+04  4.10907493e+04  7.28e-03 2.24e-04  2.43e-02     9s
  30   3.65355360e+04  4.06424852e+04  6.00e-03 1.81e-04  2.00e-02     9s
  31   3.70410163e+04  4.04294004e+04  4.54e-03 1.64e-04  1.65e-02     9s
  32   3.73141948e+04  3.99422152e+04  3.71e-03 1.32e-04  1.28e-02    10s
  33   3.76115871e+04  3.97430681e+04  2.91e-03 1.10e-04  1.04e-02    10s
  34   3.79558095e+04  3.94802077e+04  2.00e-03 7.93e-05  7.41e-03    10s
  35   3.81730087e+04  3.92093232e+04  1.47e-03 5.92e-05  5.04e-03    10s
  36   3.83733774e+04  3.90588660e+04  9.34e-04 3.96e-05  3.33e-03    10s
  37   3.84482006e+04  3.90211837e+04  7.48e-04 3.43e-05  2.79e-03    10s
  38   3.85131567e+04  3.89897734e+04  5.85e-04 3.01e-05  2.32e-03    10s
  39   3.85969751e+04  3.89095940e+04  3.91e-04 1.92e-05  1.52e-03    10s
  40   3.86110404e+04  3.88946315e+04  3.57e-04 1.72e-05  1.38e-03    11s
  41   3.86420848e+04  3.88786405e+04  2.81e-04 1.50e-05  1.15e-03    11s
  42   3.86624012e+04  3.88405259e+04  2.35e-04 1.02e-05  8.66e-04    11s
  43   3.86823991e+04  3.88231160e+04  1.85e-04 7.76e-06  6.84e-04    11s
  44   3.87002275e+04  3.88064295e+04  1.43e-04 5.52e-06  5.16e-04    11s
  45   3.87239484e+04  3.87750967e+04  8.71e-05 8.22e-06  2.49e-04    11s
  46   3.87495397e+04  3.87702275e+04  3.16e-05 3.58e-06  1.01e-04    11s
  47   3.87582840e+04  3.87679627e+04  1.36e-05 1.89e-06  4.70e-05    11s
  48   3.87608081e+04  3.87666756e+04  8.69e-06 9.38e-07  2.85e-05    12s
  49   3.87622673e+04  3.87656075e+04  5.84e-06 1.06e-07  1.62e-05    12s
  50   3.87641194e+04  3.87655465e+04  2.27e-06 7.84e-08  6.94e-06    12s
  51   3.87651573e+04  3.87654277e+04  4.08e-07 1.83e-08  1.31e-06    12s
  52   3.87653762e+04  3.87653875e+04  7.25e-08 1.24e-09  5.49e-08    12s
  53   3.87653854e+04  3.87653854e+04  1.03e-10 2.93e-11  1.95e-12    12s

Barrier solved model in 53 iterations and 12.11 seconds (11.13 work units)
Optimal objective 3.87653854e+04


Root crossover log...

   90954 DPushes remaining with DInf 0.0000000e+00                12s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    2626 PPushes remaining with PInf 3.9056028e-07                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.6639036e-11     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32195    3.8765385e+04   0.000000e+00   0.000000e+00     15s
   32195    3.8765385e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.876539e+04, 32195 iterations, 9.84 seconds (12.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38765.3854    0  394 -179468.78 38765.3854   122%     -   16s
H    0     0                    -94441.78151 38765.3854   141%     -   16s
H    0     0                    -70359.13550 38765.3854   155%     -   16s
H    0     0                    -68995.15928 38765.3854   156%     -   16s
H    0     0                    -46990.38655 38765.3854   182%     -   16s
H    0     0                    -5599.834563 38765.3854   792%     -   17s
H    0     0                    -5195.890153 38765.3854   846%     -   17s
H    0     0                    -588.5021058 38765.3854  6687%     -   17s
H    0     0                    3269.8479810 38765.3854  1086%     -   17s
H    0     0                    4482.2590826 38765.3854   765%     -   18s
H    0     0                    4860.7524256 38765.3854   698%     -   18s
H    0     0                    4861.0007336 38765.3854   697%     -   18s
H    0     0                    4873.0655808 38765.3854   696%     -   18s
H    0     0                    4884.7045253 38765.3854   694%     -   18s
H    0     0                    4901.5011971 38765.3854   691%     -   18s
H    0     0                    6866.1702343 31815.1032   363%     -   61s
H    0     0                    7131.9875120 31815.1032   346%     -   61s
H    0     0                    7875.0219414 31815.1032   304%     -   61s
H    0     0                    8075.0386362 31815.1032   294%     -   61s
H    0     0                    8082.7167733 31815.1032   294%     -   61s
H    0     0                    8094.1171916 31815.1032   293%     -   61s
     0     0 31452.8518    0  373 8094.11719 31452.8518   289%     -   61s
H    0     0                    8197.6409139 31452.8518   284%     -   62s
H    0     0                    8208.9460510 31452.8518   283%     -   62s
     0     0 30978.7231    0  361 8208.94605 30978.7231   277%     -   84s
     0     0 30935.1341    0  373 8208.94605 30935.1341   277%     -  103s
     0     0 30935.1341    0  405 8208.94605 30935.1341   277%     -  108s
     0     0 30935.1341    0  406 8208.94605 30935.1341   277%     -  114s
     0     0 30935.1341    0  400 8208.94605 30935.1341   277%     -  118s
     0     0 30935.1341    0  400 8208.94605 30935.1341   277%     -  119s
H    0     0                    8343.5447608 26450.9690   217%     -  198s
H    0     0                    8382.2943399 26450.9690   216%     -  198s
H    0     0                    8430.5866536 26450.9690   214%     -  198s
H    0     0                    8469.1250447 26450.9690   212%     -  198s
H    0     0                    8804.4599128 26450.9690   200%     -  198s
H    0     0                    8807.1009374 26450.9690   200%     -  198s
     0     0 26450.9690    0  426 8807.10094 26450.9690   200%     -  199s
H    0     0                    8893.3035432 26450.3642   197%     -  200s
H    0     0                    8900.5719217 26450.3642   197%     -  200s
     0     0 25433.3571    0  427 8900.57192 25433.3571   186%     -  263s
     0     0 25166.6764    0  414 8900.57192 25166.6764   183%     -  288s
     0     0 25106.7252    0  411 8900.57192 25106.7252   182%     -  298s
H    0     0                    9075.8849355 25088.3788   176%     -  306s
H    0     0                    9079.5912699 25088.3788   176%     -  306s
H    0     0                    9150.6292713 25088.3788   174%     -  306s
H    0     0                    9162.8912059 25088.3788   174%     -  306s
H    0     0                    9295.5129585 25088.3788   170%     -  306s
H    0     0                    9349.8359241 25088.3788   168%     -  306s
     0     0 25088.3788    0  421 9349.83592 25088.3788   168%     -  306s
     0     0 25057.7277    0  421 9349.83592 25057.7277   168%     -  316s
     0     0 25005.9822    0  416 9349.83592 25005.9822   167%     -  331s
     0     0 24987.4382    0  416 9349.83592 24987.4382   167%     -  341s
     0     0 24975.2464    0  423 9349.83592 24975.2464   167%     -  347s
     0     0 24962.8250    0  414 9349.83592 24962.8250   167%     -  351s
     0     0 24959.0413    0  423 9349.83592 24959.0413   167%     -  355s
     0     0 24958.4917    0  417 9349.83592 24958.4917   167%     -  356s
H    0     0                    9560.7185684 21765.8348   128%     -  466s
     0     0 21765.8348    0  368 9560.71857 21765.8348   128%     -  466s
     0     0 21315.6791    0  444 9560.71857 21315.6791   123%     -  502s
     0     0 20989.4416    0  378 9560.71857 20989.4416   120%     -  533s
     0     0 20827.2018    0  446 9560.71857 20827.2018   118%     -  549s
H    0     0                    9588.8210973 20782.8063   117%     -  561s
H    0     0                    9605.4576992 20782.8063   116%     -  561s
     0     0 20782.8063    0  435 9605.45770 20782.8063   116%     -  561s
     0     0 20673.3641    0  450 9605.45770 20673.3641   115%     -  574s
     0     0 20514.2014    0  364 9605.45770 20514.2014   114%     -  590s
H    0     0                    9690.6884912 20467.4193   111%     -  601s
     0     0 20467.4193    0  453 9690.68849 20467.4193   111%     -  601s
     0     0 20448.6949    0  450 9690.68849 20448.6949   111%     -  607s
     0     0 20437.0718    0  449 9690.68849 20437.0718   111%     -  611s
     0     0 20427.0082    0  452 9690.68849 20427.0082   111%     -  613s
     0     0 20422.7367    0  448 9690.68849 20422.7367   111%     -  616s
     0     0 20418.8962    0  452 9690.68849 20418.8962   111%     -  620s
     0     0 20416.5213    0  447 9690.68849 20416.5213   111%     -  622s
     0     0 19635.3314    0  393 9690.68849 19635.3314   103%     -  701s
     0     0 19445.8820    0  384 9690.68849 19445.8820   101%     -  728s
     0     0 19236.8463    0  393 9690.68849 19236.8463  98.5%     -  750s
     0     0 19216.2004    0  404 9690.68849 19216.2004  98.3%     -  759s
     0     0 19207.3851    0  407 9690.68849 19207.3851  98.2%     -  765s
     0     0 19200.3616    0  414 9690.68849 19200.3616  98.1%     -  769s
     0     0 19197.4029    0  418 9690.68849 19197.4029  98.1%     -  772s
     0     0 18920.3570    0  450 9690.68849 18920.3570  95.2%     -  805s
     0     0 18801.1971    0  404 9690.68849 18801.1971  94.0%     -  821s
     0     0 18752.9740    0  407 9690.68849 18752.9740  93.5%     -  833s
H    0     0                    9701.3624979 18703.8417  92.8%     -  843s
H    0     0                    9715.2087042 18703.8417  92.5%     -  843s
     0     0 18703.8417    0  394 9715.20870 18703.8417  92.5%     -  843s
     0     0 18686.6546    0  402 9715.20870 18686.6546  92.3%     -  850s
     0     0 18660.2066    0  462 9715.20870 18660.2066  92.1%     -  863s
     0     0 18654.9018    0  466 9715.20870 18654.9018  92.0%     -  866s
     0     0 18650.9814    0  466 9715.20870 18650.9814  92.0%     -  870s
     0     0 18631.8962    0  468 9715.20870 18631.8962  91.8%     -  880s
     0     0 18612.8152    0  473 9715.20870 18612.8152  91.6%     -  890s
     0     0 18608.8366    0  479 9715.20870 18608.8366  91.5%     -  893s
     0     0 18605.9459    0  479 9715.20870 18605.9459  91.5%     -  898s
     0     0 18390.5931    0  407 9715.20870 18390.5931  89.3%     -  931s
H    0     0                    9764.9253602 18390.5579  88.3%     -  937s
H    0     0                    9872.5838315 18390.5579  86.3%     -  937s
     0     0 18328.8193    0  398 9872.58383 18328.8193  85.7%     -  946s
     0     0 18305.3992    0  411 9872.58383 18305.3992  85.4%     -  955s
     0     0 18299.9279    0  410 9872.58383 18299.9279  85.4%     -  961s
     0     0 18294.9199    0  413 9872.58383 18294.9199  85.3%     -  966s
     0     0 18293.0739    0  404 9872.58383 18293.0739  85.3%     -  969s
     0     0 18106.2413    0  452 9872.58383 18106.2413  83.4%     - 1004s
     0     0 17952.1669    0  498 9872.58383 17952.1669  81.8%     - 1032s
     0     0 17922.5706    0  518 9872.58383 17922.5706  81.5%     - 1043s
     0     0 17912.6737    0  517 9872.58383 17912.6737  81.4%     - 1049s
     0     0 17896.4284    0  530 9872.58383 17896.4284  81.3%     - 1062s
     0     0 17893.2791    0  533 9872.58383 17893.2791  81.2%     - 1066s
     0     0 17791.4855    0  443 9872.58383 17791.4855  80.2%     - 1088s
H    0     0                    9876.4740228 17790.6719  80.1%     - 1090s
H    0     0                    9891.9866345 17790.6719  79.8%     - 1090s
     0     0 17749.9736    0  525 9891.98663 17749.9736  79.4%     - 1102s
     0     0 17742.9454    0  415 9891.98663 17742.9454  79.4%     - 1108s
     0     0 17729.6604    0  412 9891.98663 17729.6604  79.2%     - 1114s
     0     0 17722.8940    0  484 9891.98663 17722.8940  79.2%     - 1120s
     0     0 17716.9152    0  546 9891.98663 17716.9152  79.1%     - 1126s
     0     0 17715.6420    0  542 9891.98663 17715.6420  79.1%     - 1129s
     0     0 17695.6636    0  420 9891.98663 17695.6636  78.9%     - 1141s
     0     0 17680.6317    0  420 9891.98663 17680.6317  78.7%     - 1151s
     0     0 17678.9394    0  420 9891.98663 17678.9394  78.7%     - 1155s
     0     0 17638.9807    0  395 9891.98663 17638.9807  78.3%     - 1172s
H    0     0                    9996.9488324 17638.9153  76.4%     - 1178s
     0     0 17628.8433    0  413 9996.94883 17628.8433  76.3%     - 1189s
     0     0 17624.7661    0  420 9996.94883 17624.7661  76.3%     - 1195s
     0     0 17623.1158    0  415 9996.94883 17623.1158  76.3%     - 1198s
     0     0 17580.7383    0  472 9996.94883 17580.7383  75.9%     - 1212s
     0     0 17572.6559    0  417 9996.94883 17572.6559  75.8%     - 1219s
     0     0 17570.2951    0  405 9996.94883 17570.2951  75.8%     - 1223s
     0     0 17532.5603    0  413 9996.94883 17532.5603  75.4%     - 1236s
H    0     0                    10060.741904 17532.2227  74.3%     - 1238s
H    0     0                    10062.152878 17532.2227  74.2%     - 1238s
H    0     0                    10070.100300 17532.2227  74.1%     - 1238s
H    0     0                    10072.170971 17532.2227  74.1%     - 1238s
     0     0 17522.0617    0  469 10072.1710 17522.0617  74.0%     - 1248s
     0     0 17511.3951    0  471 10072.1710 17511.3951  73.9%     - 1256s
     0     0 17508.4477    0  411 10072.1710 17508.4477  73.8%     - 1260s
     0     0 17491.6712    0  406 10072.1710 17491.6712  73.7%     - 1268s
H    0     0                    10132.277687 17491.6670  72.6%     - 1269s
     0     0 17487.1157    0  408 10132.2777 17487.1157  72.6%     - 1273s
     0     0 17486.8539    0  469 10132.2777 17486.8539  72.6%     - 1275s
     0     0 17481.0586    0  415 10132.2777 17481.0586  72.5%     - 1280s
     0     0 17479.2432    0  404 10132.2777 17479.2432  72.5%     - 1297s
     0     0 17475.2308    0  399 10132.2777 17475.2308  72.5%     - 1302s
     0     0 17474.9631    0  399 10132.2777 17474.9631  72.5%     - 1309s
     0     2 17474.9631    0  399 10132.2777 17474.9631  72.5%     - 1451s
     1     4 17429.8553    1  449 10132.2777 17474.9631  72.5%  4663 1471s
     3     6 17246.4721    2  455 10132.2777 17429.7441  72.0% 10060 1502s
     5    10 17049.3745    3  445 10132.2777 17429.7441  72.0% 10803 1527s
     9    18 16796.2766    4  455 10132.2777 17246.2228  70.2% 10156 1561s
    17    36 15941.1216    4  456 10132.2777 17106.4895  68.8% 11549 1594s
    35    50 15846.2952    5  445 10132.2777 16759.6302  65.4% 15803 1672s
    49    78 13785.1061    6  380 10132.2777 16759.6302  65.4% 15321 1729s
H   52    78                    10139.035739 16759.6302  65.3% 15104 1729s
H   57    78                    10236.894843 16759.6302  63.7% 15150 1729s
H   59    78                    10266.257659 16759.6302  63.2% 14857 1729s
    77   157 13682.5266    7  376 10266.2577 16759.6302  63.2% 13317 1818s
   158   230 13488.0639    8  210 10266.2577 16759.6302  63.2% 10860 1860s
   235   287 13478.6133    9  372 10266.2577 16759.6302  63.2%  8910 1901s
   296   317     cutoff   10      10266.2577 16759.6302  63.2%  7985 1938s
   336   382 12303.1159   10  358 10266.2577 16759.6302  63.2%  7654 1974s
   403   438 12122.4567   11  190 10266.2577 16759.6302  63.2%  7089 2013s
   475   463 12039.4933   12  187 10266.2577 16759.6302  63.2%  6446 2044s
   506   489 11910.3118   13  182 10266.2577 16759.6302  63.2%  6300 2077s
H  524   489                    10345.594047 16759.6302  62.0%  6185 2077s
   554   540 11710.6328   13  178 10345.5940 16759.6302  62.0%  6075 2109s
   635   579 11316.5618   17  163 10345.5940 16759.6302  62.0%  5721 2138s
   708   611 infeasible   16      10345.5940 16759.6302  62.0%  5472 2166s
   778   640     cutoff   18      10345.5940 16759.6302  62.0%  5283 2193s
   855   687 infeasible   19      10345.5940 16759.6302  62.0%  5060 2222s
   941   712 10956.1798   29  311 10345.5940 16759.6302  62.0%  4838 2249s
  1024   717 10915.5865   30  298 10345.5940 16759.6302  62.0%  4634 2278s
  1100   716 10556.8582   31  175 10345.5940 16759.6302  62.0%  4504 2313s
  1157   754 10551.3904   31  259 10345.5940 16759.6302  62.0%  4448 2349s
  1232   804     cutoff   32      10345.5940 16759.6302  62.0%  4387 2380s
  1347   874 10650.0592   31  217 10345.5940 16759.6302  62.0%  4205 2415s
  1490   864 infeasible   34      10345.5940 16759.6302  62.0%  4022 2450s
  1573   878 12562.0808   12  262 10345.5940 16759.6302  62.0%  3980 2490s
  1643   912 12301.8234   13  230 10345.5940 16759.6302  62.0%  3993 2530s
  1733   950 11515.7523   17  205 10345.5940 16759.6302  62.0%  3964 2569s
  1829  1004 11014.5587   28  136 10345.5940 16759.6302  62.0%  3958 2608s
  1925  1104 infeasible   38      10345.5940 16759.6302  62.0%  3913 2652s
  2100  1145 11671.4128   26  160 10345.5940 16759.6302  62.0%  3753 2691s
  2217  1226 11171.3583   30  134 10345.5940 16759.6302  62.0%  3673 2736s
  2391  1299 10968.0809   39   76 10345.5940 16759.6302  62.0%  3599 2786s
  2550  1375 10777.6075   49   86 10345.5940 16759.6302  62.0%  3545 2830s
  2696  1440 10648.2763   58  131 10345.5940 16759.6302  62.0%  3511 2886s
  2849  1502 10497.8157   69   88 10345.5940 16759.6302  62.0%  3472 2939s
  2980  1519 12829.0370    8  242 10345.5940 16759.6302  62.0%  3476 2991s
  3025  1553 12240.5229    9  204 10345.5940 16759.6302  62.0%  3507 3049s
  3026  1553 10810.9589    8  388 10345.5940 16759.6302  62.0%  3510 3050s
  3096  1613 11971.4091   10  242 10345.5940 16559.1337  60.1%  3518 3101s
  3220  1669 11864.4921   11  243 10345.5940 16558.9401  60.1%  3493 3155s
  3341  1722 11487.2170   14  207 10345.5940 16558.9401  60.1%  3479 3212s
  3429  1780 11240.7471   16  183 10345.5940 16558.9401  60.1%  3514 3278s
  3538  1855 10791.9153   29  169 10345.5940 16558.9401  60.1%  3527 3349s
  3668  1942 10489.2051   51   99 10345.5940 15411.6019  49.0%  3541 3418s
  3832  1991     cutoff   57      10345.5940 15249.4389  47.4%  3546 3475s
  3923  2093 12914.7170    8  352 10345.5940 15249.4389  47.4%  3573 3542s
  4094  2169 11848.5815   11  347 10345.5940 15249.4389  47.4%  3601 3600s

Cutting planes:
  Gomory: 25
  Implied bound: 319
  MIR: 3530
  Flow cover: 2925
  RLT: 166
  Relax-and-lift: 980

Explored 4282 nodes (16269620 simplex iterations) in 3600.09 seconds (5069.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10345.6 10266.3 10236.9 ... 9996.95

Time limit reached
Best objective 1.034559404656e+04, best bound 1.524943888861e+04, gap 47.4003%
  WARNING: Time limit reached. Using best solution found (gap: 47.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 10345.59, θ = 138912.23
  Upper Bound (UB) = 10345.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 138912.23
  [DEBUG]   ✓ Scenario 0: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 138912.23 ≤ Q = 138912.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 138912.23 ≤ Q = 138912.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x66995c0f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x66995c0f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506392e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6846054.5404
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.335291e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133529.08    0  123 6846054.54 -133529.08   102%     -    0s
H    0     0                    -104812.3855 -133529.08  27.4%     -    0s
H    0     0                    -104965.5466 -133529.08  27.2%     -    0s
     0     0 -108940.47    0  126 -104965.55 -108940.47  3.79%     -    0s
H    0     0                    -105899.8440 -108820.64  2.76%     -    0s
     0     0 -107957.34    0  121 -105899.84 -107957.34  1.94%     -    0s
H    0     0                    -107118.3074 -107949.80  0.78%     -    0s
     0     0 -107798.94    0   73 -107118.31 -107798.94  0.64%     -    0s
     0     0 -107792.16    0   73 -107118.31 -107792.16  0.63%     -    0s
     0     0 -107684.27    0   73 -107118.31 -107684.27  0.53%     -    0s
     0     0 -107681.25    0   73 -107118.31 -107681.25  0.53%     -    0s
     0     2 -107681.11    0   73 -107118.31 -107681.11  0.53%     -    0s
H   86    38                    -107230.9587 -107380.02  0.14%  13.3    0s
H  204    17                    -107259.2255 -107317.68  0.05%   9.5    0s

Cutting planes:
  Gomory: 31
  Implied bound: 10
  MIR: 203
  Flow cover: 4
  BQP: 1

Explored 267 nodes (2761 simplex iterations) in 0.18 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -107259 -107231 -107118 ... 1.50639e+13
No other solutions better than -107259

Optimal solution found (tolerance 1.00e-04)
Best objective -1.072592255289e+05, best bound -1.072592255289e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 137973.40
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107259.23
  [DEBUG]   S×d_nominal = 245232.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245232.63 + -107259.23 = 137973.40
  [DEBUG]   Current θ from Master = 138912.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 938.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9406.77
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = 420.5363, Absolute Gap = 420.5363, Relative Gap = 0.040649
  Not converged yet (gap = 420.54 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 696831 nonzeros
Model fingerprint: 0x255941e7
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 126048 rows and 51168 columns
Presolve time: 4.34s
Presolved: 119975 rows, 50932 columns, 742079 nonzeros
Variable types: 48673 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.48s

Barrier statistics:
 Dense cols : 587
 AA' NZ     : 5.872e+06
 Factor NZ  : 1.269e+07 (roughly 170 MB of memory)
 Factor Ops : 2.680e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.98761074e+07  2.13285831e+08  1.12e+05 1.94e+01  8.40e+04     8s
   1  -1.52422072e+07  1.91329778e+08  7.94e+04 8.97e+01  5.89e+04     8s
   2  -4.54957010e+06  1.49300051e+08  2.30e+04 6.67e-01  1.81e+04     8s
   3  -7.84164385e+05  1.05930492e+08  1.31e+03 1.89e+00  1.46e+03     8s
   4  -5.73924860e+05  5.67815202e+07  4.24e+02 8.43e-01  5.48e+02     8s
   5  -4.88598191e+05  3.73719174e+07  2.30e+02 5.03e-01  3.15e+02     8s
   6  -4.19575553e+05  2.76653376e+07  1.05e+02 3.46e-01  1.88e+02     8s
   7  -3.16678382e+05  2.15628820e+07  1.80e+01 2.58e-01  1.09e+02     9s
   8  -2.14224337e+05  1.19490308e+07  4.57e+00 1.37e-01  5.70e+01     9s
   9  -1.50205564e+05  4.18256421e+06  2.46e+00 4.70e-02  2.01e+01     9s
  10  -1.12649252e+05  3.02474636e+06  1.54e+00 3.37e-02  1.45e+01     9s
  11  -9.07598594e+04  1.93341788e+06  9.50e-01 2.12e-02  9.29e+00     9s
  12  -7.21019977e+04  1.47895554e+06  4.76e-01 1.63e-02  7.09e+00     9s
  13  -4.51094965e+04  7.77128524e+05  2.03e-01 8.23e-03  3.75e+00     9s
  14  -2.19121984e+04  4.03066615e+05  8.09e-02 4.21e-03  1.94e+00     9s
  15  -1.01147858e+04  2.35577575e+05  5.05e-02 2.39e-03  1.12e+00     9s
  16  -2.15939044e+03  1.76431712e+05  3.56e-02 1.73e-03  8.14e-01     9s
  17   2.95444153e+03  1.25098990e+05  2.84e-02 1.44e-03  5.57e-01     9s
  18   7.30311210e+03  1.03055999e+05  2.30e-02 1.11e-03  4.37e-01    10s
  19   1.12734347e+04  7.57302713e+04  1.82e-02 6.96e-04  2.94e-01    10s
  20   1.68975211e+04  6.52754636e+04  1.25e-02 5.11e-04  2.21e-01    10s
  21   2.06289623e+04  5.40338383e+04  9.01e-03 3.41e-04  1.52e-01    10s
  22   2.27742523e+04  4.91517595e+04  7.18e-03 2.62e-04  1.20e-01    10s
  23   2.46990096e+04  4.52268693e+04  5.67e-03 2.00e-04  9.36e-02    10s
  24   2.61191155e+04  4.17819836e+04  4.62e-03 1.48e-04  7.14e-02    10s
  25   2.79870397e+04  4.02243338e+04  3.32e-03 1.24e-04  5.58e-02    10s
  26   2.95321589e+04  3.75101669e+04  2.28e-03 7.43e-05  3.64e-02    11s
  27   3.03536450e+04  3.56479938e+04  1.76e-03 4.03e-05  2.41e-02    11s
  28   3.08042301e+04  3.46068625e+04  1.47e-03 4.47e-05  1.73e-02    11s
  29   3.10801305e+04  3.44015617e+04  1.29e-03 3.80e-05  1.51e-02    11s
  30   3.13153653e+04  3.42561490e+04  1.15e-03 3.30e-05  1.34e-02    11s
  31   3.14575187e+04  3.39947882e+04  1.06e-03 2.44e-05  1.16e-02    11s
  32   3.19815520e+04  3.38106163e+04  7.53e-04 2.26e-05  8.34e-03    11s
  33   3.25328198e+04  3.36171247e+04  4.19e-04 1.41e-05  4.94e-03    11s
  34   3.27696969e+04  3.35764390e+04  2.72e-04 1.23e-05  3.68e-03    12s
  35   3.28652486e+04  3.35015802e+04  2.21e-04 9.06e-06  2.90e-03    12s
  36   3.30654462e+04  3.34417860e+04  1.08e-04 6.61e-06  1.72e-03    12s
  37   3.31039184e+04  3.33958549e+04  8.69e-05 4.80e-06  1.33e-03    12s
  38   3.31374183e+04  3.33672210e+04  6.92e-05 3.67e-06  1.05e-03    12s
  39   3.31846343e+04  3.33380640e+04  4.51e-05 2.53e-06  7.00e-04    12s
  40   3.32251330e+04  3.33257248e+04  2.39e-05 2.01e-06  4.59e-04    12s
  41   3.32554377e+04  3.33038595e+04  8.62e-06 1.15e-06  2.21e-04    13s
  42   3.32668073e+04  3.32814374e+04  3.04e-06 2.32e-07  6.67e-05    13s
  43   3.32689033e+04  3.32780454e+04  2.15e-06 1.15e-07  4.17e-05    13s
  44   3.32689952e+04  3.32777893e+04  2.12e-06 1.06e-07  4.01e-05    13s
  45   3.32702126e+04  3.32767467e+04  1.63e-06 7.11e-08  2.98e-05    13s
  46   3.32739359e+04  3.32754397e+04  1.71e-07 2.84e-08  6.86e-06    13s
  47   3.32743397e+04  3.32750112e+04  4.81e-08 1.50e-08  3.06e-06    13s
  48   3.32744856e+04  3.32749575e+04  3.26e-08 1.37e-08  2.15e-06    13s
  49   3.32745186e+04  3.32745704e+04  1.79e-08 1.03e-09  2.37e-07    14s
  50   3.32745369e+04  3.32745381e+04  3.31e-09 6.45e-10  5.76e-09    14s
  51   3.32745378e+04  3.32745379e+04  2.38e-08 6.21e-09  6.00e-10    14s

Barrier solved model in 51 iterations and 13.83 seconds (13.13 work units)
Optimal objective 3.32745378e+04


Root crossover log...

  102917 DPushes remaining with DInf 0.0000000e+00                14s
   39752 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    7007 PPushes remaining with PInf 3.9048024e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8499363e+02     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56492    3.3274538e+04   0.000000e+00   2.849936e+02     20s
   56828    3.3274538e+04   0.000000e+00   0.000000e+00     20s
   56828    3.3274538e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 2.63s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 3.327454e+04, 56828 iterations, 17.43 seconds (20.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33274.5379    0  262 -179468.78 33274.5379   119%     -   24s
H    0     0                    -176089.3004 33274.5379   119%     -   24s
H    0     0                    -116350.8277 33274.5379   129%     -   24s
H    0     0                    -115141.4745 33274.5379   129%     -   25s
H    0     0                    -114293.7024 33274.5379   129%     -   25s
H    0     0                    -81131.34517 33274.5379   141%     -   25s
H    0     0                    -80150.00079 33274.5379   142%     -   25s
H    0     0                    -15982.68130 33274.5379   308%     -   25s
H    0     0                    -15474.83679 33274.5379   315%     -   26s
H    0     0                    -15338.21566 33274.5379   317%     -   26s
H    0     0                    -12595.51009 26691.5298   312%     -   68s
H    0     0                    -9148.327819 26691.5298   392%     -   68s
H    0     0                    -4348.863486 26691.5298   714%     -   68s
     0     0 26612.6790    0  234 -4348.8635 26612.6790   712%     -   68s
H    0     0                    -1954.571164 26612.6790  1462%     -   69s
H    0     0                    -1806.530333 26612.6790  1573%     -   69s
H    0     0                    -1539.098313 26612.6790  1829%     -   69s
     0     0 26099.7476    0  280 -1539.0983 26099.7476  1796%     -   86s
     0     0 26046.2989    0  272 -1539.0983 26046.2989  1792%     -   96s
     0     0 26034.2175    0  273 -1539.0983 26034.2175  1792%     -  101s
     0     0 25661.5553    0  279 -1539.0983 25661.5553  1767%     -  113s
     0     0 25473.5781    0  279 -1539.0983 25473.5781  1755%     -  123s
     0     0 25473.5781    0  283 -1539.0983 25473.5781  1755%     -  125s
     0     0 25473.5781    0  274 -1539.0983 25473.5781  1755%     -  130s
     0     0 25443.9182    0  256 -1539.0983 25443.9182  1753%     -  142s
     0     0 25436.9803    0  259 -1539.0983 25436.9803  1753%     -  144s
     0     0 25436.8214    0  259 -1539.0983 25436.8214  1753%     -  145s
     0     0 22800.9150    0  436 -1539.0983 22800.9150  1581%     -  218s
H    0     0                    -907.4258214 22800.7631  2613%     -  219s
     0     0 21920.5703    0  426 -907.42582 21920.5703  2516%     -  258s
     0     0 21763.0020    0  427 -907.42582 21763.0020  2498%     -  274s
     0     0 21594.8296    0  418 -907.42582 21594.8296  2480%     -  295s
     0     0 21466.4329    0  422 -907.42582 21466.4329  2466%     -  307s
     0     0 21378.0829    0  421 -907.42582 21378.0829  2456%     -  314s
     0     0 21323.2565    0  413 -907.42582 21323.2565  2450%     -  322s
H    0     0                    6810.9437308 21310.1020   213%     -  327s
H    0     0                    7636.1454896 21310.1020   179%     -  327s
H    0     0                    8386.4616408 21310.1020   154%     -  327s
H    0     0                    8444.3078627 21310.1020   152%     -  327s
H    0     0                    8870.3992905 21310.1020   140%     -  327s
H    0     0                    8935.2507965 21310.1020   138%     -  327s
H    0     0                    8986.7691532 21310.1020   137%     -  327s
     0     0 21310.1020    0  419 8986.76915 21310.1020   137%     -  327s
     0     0 21307.0734    0  420 8986.76915 21307.0734   137%     -  330s
     0     0 21293.0105    0  420 8986.76915 21293.0105   137%     -  333s
H    0     0                    9026.6537826 21281.5322   136%     -  336s
H    0     0                    9028.4878546 21281.5322   136%     -  336s
     0     0 21281.5322    0  420 9028.48785 21281.5322   136%     -  336s
     0     0 21278.6193    0  418 9028.48785 21278.6193   136%     -  338s
H    0     0                    9079.5792239 21205.1705   134%     -  349s
     0     0 21205.1705    0  424 9079.57922 21205.1705   134%     -  349s
     0     0 21195.7654    0  424 9079.57922 21195.7654   133%     -  352s
     0     0 21191.0883    0  426 9079.57922 21191.0883   133%     -  355s
     0     0 21168.4580    0  427 9079.57922 21168.4580   133%     -  358s
     0     0 21161.4389    0  432 9079.57922 21161.4389   133%     -  360s
     0     0 21160.2384    0  434 9079.57922 21160.2384   133%     -  362s
     0     0 19887.6845    0  353 9079.57922 19887.6845   119%     -  413s
     0     0 19295.5905    0  351 9079.57922 19295.5905   113%     -  456s
     0     0 19022.1369    0  339 9079.57922 19022.1369   110%     -  479s
     0     0 18918.3346    0  345 9079.57922 18918.3346   108%     -  494s
     0     0 18889.6029    0  354 9079.57922 18889.6029   108%     -  504s
H    0     0                    9154.4026540 18871.4506   106%     -  511s
H    0     0                    9163.1526153 18871.4506   106%     -  511s
H    0     0                    9170.5604035 18871.4506   106%     -  511s
H    0     0                    9195.2194469 18871.4506   105%     -  511s
H    0     0                    9195.5028746 18871.4506   105%     -  511s
H    0     0                    9218.8354767 18871.4506   105%     -  511s
H    0     0                    9225.8139540 18871.4506   105%     -  511s
     0     0 18871.4506    0  358 9225.81395 18871.4506   105%     -  511s
     0     0 18858.1814    0  366 9225.81395 18858.1814   104%     -  517s
     0     0 18848.8511    0  373 9225.81395 18848.8511   104%     -  522s
     0     0 18834.9086    0  370 9225.81395 18834.9086   104%     -  527s
     0     0 18793.1383    0  368 9225.81395 18793.1383   104%     -  538s
     0     0 18788.7122    0  378 9225.81395 18788.7122   104%     -  540s
     0     0 18784.7052    0  379 9225.81395 18784.7052   104%     -  544s
     0     0 18783.9668    0  375 9225.81395 18783.9668   104%     -  545s
     0     0 18333.6750    0  436 9225.81395 18333.6750  98.7%     -  580s
H    0     0                    9233.0330546 18333.2473  98.6%     -  582s
H    0     0                    9263.8829683 18333.2473  97.9%     -  582s
     0     0 18193.6924    0  427 9263.88297 18193.6924  96.4%     -  599s
     0     0 18170.3067    0  372 9263.88297 18170.3067  96.1%     -  604s
     0     0 18161.7662    0  375 9263.88297 18161.7662  96.0%     -  606s
     0     0 18160.0763    0  372 9263.88297 18160.0763  96.0%     -  607s
     0     0 18020.4311    0  367 9263.88297 18020.4311  94.5%     -  620s
H    0     0                    9309.7696089 18019.2431  93.6%     -  621s
H    0     0                    9422.1702717 18019.2431  91.2%     -  621s
H    0     0                    9423.7152129 18019.2431  91.2%     -  621s
H    0     0                    9565.6369984 18019.2431  88.4%     -  621s
     0     0 17943.0662    0  430 9565.63700 17943.0662  87.6%     -  633s
     0     0 17919.9244    0  422 9565.63700 17919.9244  87.3%     -  639s
     0     0 17915.4412    0  421 9565.63700 17915.4412  87.3%     -  644s
     0     0 17905.1095    0  418 9565.63700 17905.1095  87.2%     -  650s
     0     0 17897.3874    0  433 9565.63700 17897.3874  87.1%     -  654s
     0     0 17894.9758    0  438 9565.63700 17894.9758  87.1%     -  656s
     0     0 17861.1061    0  430 9565.63700 17861.1061  86.7%     -  662s
     0     0 17852.4540    0  438 9565.63700 17852.4540  86.6%     -  665s
     0     0 17851.2706    0  439 9565.63700 17851.2706  86.6%     -  666s
     0     0 17794.2164    0  443 9565.63700 17794.2164  86.0%     -  676s
     0     0 17760.9203    0  448 9565.63700 17760.9203  85.7%     -  687s
     0     0 17749.2520    0  458 9565.63700 17749.2520  85.6%     -  692s
     0     0 17746.1280    0  390 9565.63700 17746.1280  85.5%     -  695s
     0     0 17743.2783    0  383 9565.63700 17743.2783  85.5%     -  698s
     0     0 17742.8434    0  386 9565.63700 17742.8434  85.5%     -  699s
     0     0 17710.1649    0  441 9565.63700 17710.1649  85.1%     -  709s
     0     0 17704.6099    0  393 9565.63700 17704.6099  85.1%     -  713s
     0     0 17696.9320    0  400 9565.63700 17696.9320  85.0%     -  719s
     0     0 17693.6797    0  399 9565.63700 17693.6797  85.0%     -  722s
     0     0 17693.0604    0  401 9565.63700 17693.0604  85.0%     -  724s
     0     0 17653.7599    0  381 9565.63700 17653.7599  84.6%     -  734s
H    0     0                    9691.6445667 17651.9930  82.1%     -  736s
H    0     0                    9752.8454566 17651.9930  81.0%     -  737s
     0     0 17640.9419    0  377 9752.84546 17640.9419  80.9%     -  742s
     0     0 17633.3411    0  395 9752.84546 17633.3411  80.8%     -  744s
     0     0 17629.6950    0  396 9752.84546 17629.6950  80.8%     -  747s
     0     0 17627.8556    0  389 9752.84546 17627.8556  80.7%     -  749s
     0     0 17603.8708    0  398 9752.84546 17603.8708  80.5%     -  756s
     0     0 17598.3333    0  394 9752.84546 17598.3333  80.4%     -  761s
     0     0 17596.5182    0  393 9752.84546 17596.5182  80.4%     -  763s
     0     0 17591.9512    0  396 9752.84546 17591.9512  80.4%     -  768s
H    0     0                    9784.2126887 17590.9500  79.8%     -  771s
     0     0 17562.8466    0  394 9784.21269 17562.8466  79.5%     -  776s
     0     0 17554.0169    0  395 9784.21269 17554.0169  79.4%     -  779s
     0     0 17549.7238    0  399 9784.21269 17549.7238  79.4%     -  782s
     0     0 17545.6336    0  397 9784.21269 17545.6336  79.3%     -  783s
     0     0 17544.3742    0  391 9784.21269 17544.3742  79.3%     -  785s
     0     0 17528.0076    0  406 9784.21269 17528.0076  79.1%     -  792s
     0     0 17511.7739    0  410 9784.21269 17511.7739  79.0%     -  796s
     0     0 17504.5852    0  390 9784.21269 17504.5852  78.9%     -  799s
     0     0 17503.1751    0  402 9784.21269 17503.1751  78.9%     -  800s
     0     0 17492.4538    0  388 9784.21269 17492.4538  78.8%     -  806s
H    0     0                    9840.3907202 17492.1366  77.8%     -  813s
     0     0 17488.6513    0  393 9840.39072 17488.6513  77.7%     -  815s
     0     0 17487.9702    0  394 9840.39072 17487.9702  77.7%     -  816s
     0     0 17482.6285    0  397 9840.39072 17482.6285  77.7%     -  822s
     0     0 17478.8865    0  401 9840.39072 17478.8865  77.6%     -  827s
     0     0 17477.7946    0  400 9840.39072 17477.7946  77.6%     -  828s
     0     0 17471.9792    0  386 9840.39072 17471.9792  77.6%     -  833s
     0     0 17469.9607    0  394 9840.39072 17469.9607  77.5%     -  838s
     0     0 17467.3290    0  395 9840.39072 17467.3290  77.5%     -  842s
     0     0 17467.0251    0  395 9840.39072 17467.0251  77.5%     -  849s
     0     2 17467.0251    0  395 9840.39072 17467.0251  77.5%     -  956s
     1     3 17148.6486    1  305 9840.39072 17466.3946  77.5%  5429  965s
     2     4 17303.6604    1  386 9840.39072 17303.6604  75.8%  7268  979s
     3     7 16137.4056    2  293 9840.39072 17302.9775  75.8%  6586  999s
     6    12 15923.7250    3  281 9840.39072 17302.9775  75.8%  8113 1024s
    11    24 15450.9437    4  366 9840.39072 17225.1499  75.0% 10942 1049s
    23    36 16491.4820    4  412 9840.39072 16891.4032  71.7% 14868 1101s
    35    68 16221.3075    5  411 9840.39072 16891.4032  71.7% 13996 1267s
H   36    68                    9846.8454908 16891.4032  71.5% 13607 1267s
H   43    68                    9854.0790983 16891.4032  71.4% 12970 1267s
H   54    68                    9892.3863379 16891.4032  70.8% 11878 1267s
    67   217 16192.2958    6  398 9892.38634 16464.8490  66.4% 17492 1324s
   216   268 15968.6418   10  422 9892.38634 16464.6340  66.4%  8699 1349s
H  223   268                    9914.9053591 16464.6340  66.1%  8600 1349s
H  227   268                    9927.0040623 16464.6340  65.9%  8487 1349s
H  256   268                    10131.289310 16464.6340  62.5%  8214 1349s
   273   309 15557.9813   11  368 10131.2893 16464.6340  62.5%  8031 1372s
   322   333 13353.6161   12  342 10131.2893 16464.6340  62.5%  7962 1396s
H  351   333                    10186.018466 16464.6340  61.6%  7978 1396s
   355   366 14235.5971   15  335 10186.0185 16464.6340  61.6%  8009 1421s
   396   398 12523.0656   13  333 10186.0185 16464.6340  61.6%  8056 1447s
   438   435 12490.4053   14  316 10186.0185 16464.6340  61.6%  8104 1472s
   495   452 11357.8414   16  284 10186.0185 16464.6340  61.6%  8057 1498s
   543   450 10741.9094   17  285 10186.0185 16464.6340  61.6%  8088 1523s
   603   468 infeasible   18      10186.0185 16329.6581  60.3%  8018 1549s
   649   478 14509.3627    7  338 10186.0185 16329.6581  60.3%  8301 1577s
   697   497 11899.7701    8  339 10186.0185 16329.6581  60.3%  8291 1604s
   743   522 11702.1422    9  331 10186.0185 16329.6581  60.3%  8426 1628s
   778   545     cutoff   10      10186.0185 16329.6581  60.3%  8593 1651s
H  807   545                    10197.137722 16220.2393  59.1%  8621 1651s
   829   575 11428.6647   11  321 10197.1377 16220.2393  59.1%  8613 1674s
   917   622 10884.3224   14  291 10197.1377 16220.2393  59.1%  8435 1697s
   992   638 10281.7047   18  331 10197.1377 16220.2393  59.1%  8333 1721s
  1065   652     cutoff   18      10197.1377 16073.8240  57.6%  8241 1746s
H 1093   652                    10204.540478 16073.8240  57.5%  8229 1746s
  1130   666 12933.7112   11  308 10204.5405 16073.8240  57.5%  8212 1775s
  1216   684 12610.9099   13  293 10204.5405 16073.8240  57.5%  8141 1805s
  1267   718 11950.6869   14  362 10204.5405 16073.8240  57.5%  8205 1834s
  1333   773 11935.3556   16  264 10204.5405 16073.8240  57.5%  8290 1864s
  1398   830 11340.9012   18  192 10204.5405 16073.8240  57.5%  8324 1893s
  1503   846 10466.8330   25  227 10204.5405 16073.8240  57.5%  8270 1924s
  1617   893 infeasible   11      10204.5405 15522.2580  52.1%  8177 1960s
  1708   913 11548.2181   18  251 10204.5405 15522.2580  52.1%  8177 1990s
  1746   935 13583.8311   10  309 10204.5405 15522.2580  52.1%  8250 2018s
  1784   973 12687.5134   11  300 10204.5405 15522.2580  52.1%  8297 2051s
  1849   986 10532.5325   13  286 10204.5405 15257.7455  49.5%  8301 2082s
  1944  1018 infeasible   15      10204.5405 15242.6789  49.4%  8181 2118s
  2058  1075 11629.9712    9  287 10204.5405 15242.6789  49.4%  8131 2152s
  2175  1084 10565.3309   13  190 10204.5405 15242.6789  49.4%  8095 2184s
H 2198  1084                    10218.525526 15242.6789  49.2%  8084 2184s
  2228  1122 10361.5434   14  184 10218.5255 15242.6789  49.2%  8093 2226s
  2391  1181 infeasible   13      10218.5255 15124.5876  48.0%  8006 2271s
  2527  1201     cutoff   11      10218.5255 15066.2192  47.4%  8032 2314s
  2705  1273 12084.3461   10  417 10218.5255 14998.5266  46.8%  7897 2358s
  2858  1341 11902.4663   12  343 10218.5255 14997.1092  46.8%  7896 2403s
  3017  1439 10892.8298   13  433 10218.5255 14951.1023  46.3%  7904 2448s
  3255  1520 10355.9852   14  379 10218.5255 14930.6354  46.1%  7747 2505s
  3476  1550 infeasible   14      10218.5255 14930.6354  46.1%  7618 2557s
  3653  1587 infeasible   11      10218.5255 14707.6140  43.9%  7624 2610s
  3836  1606 13103.0435   11  273 10218.5255 14707.6140  43.9%  7678 2662s
  3997  1691 12875.2549   12  252 10218.5255 14661.8599  43.5%  7663 2715s
  4176  1704 10665.4261   14  199 10218.5255 14661.8599  43.5%  7704 2783s
  4376  1733 infeasible   16      10218.5255 14551.0538  42.4%  7731 2850s
  4562  1763 infeasible   13      10218.5255 14491.1970  41.8%  7806 2917s
  4759  1757 12052.4541   11  216 10218.5255 14331.7829  40.3%  7852 2986s
H 4763  1757                    10219.158057 14331.7829  40.2%  7854 2986s
  4939  1814     cutoff   14      10219.1581 14212.6668  39.1%  7877 3054s
  5171  1861 12694.1623   14  331 10219.1581 14177.0713  38.7%  7882 3121s
  5437  1910 11888.2472   16  357 10219.1581 14004.3415  37.0%  7805 3191s
  5723  1923 infeasible   19      10219.1581 13928.7972  36.3%  7754 3270s
  5983  1917 10345.6002   15  250 10219.1581 13928.7972  36.3%  7778 3359s
  6214  1952 infeasible   14      10219.1581 13694.0817  34.0%  7801 3438s
  6563  1914 infeasible   12      10219.1581 13671.2535  33.8%  7758 3520s
  6785  1892 infeasible   14      10219.1581 13408.5079  31.2%  7769 3599s

Cutting planes:
  Gomory: 18
  Implied bound: 187
  MIR: 2580
  Flow cover: 2800
  Inf proof: 1
  RLT: 73
  Relax-and-lift: 515
  BQP: 1
  PSD: 1

Explored 6871 nodes (54458690 simplex iterations) in 3600.05 seconds (6427.27 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10219.2 10218.5 10204.5 ... 9854.08

Time limit reached
Best objective 1.021915805739e+04, best bound 1.334578875165e+04, gap 30.5958%
  WARNING: Time limit reached. Using best solution found (gap: 30.60%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 10219.16, θ = 138413.22
  Upper Bound (UB) = 10219.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 138413.22
  [DEBUG]   ✓ Scenario 0: θ = 138413.22 ≤ Q = 138413.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 138413.22 ≤ Q = 138427.95 (slack: 14.73)
  [DEBUG]   ✓ Scenario 6: θ = 138413.22 ≤ Q = 138430.68 (slack: 17.46)
  [DEBUG]   ✓ Scenario 7: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 138413.22 ≤ Q = 138413.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 138413.22 ≤ Q = 138413.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 138413.22 ≤ Q = 138413.22 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6dc833a6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9237cc5a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.476375e+13
Presolve removed 2656 rows and 1948 columns
Presolve time: 0.01s
Presolved: 437 rows, 441 columns, 1232 nonzeros
Found heuristic solution: objective 6594378.0923
Variable types: 298 continuous, 143 integer (143 binary)
Found heuristic solution: objective 6594038.5609

Root relaxation: objective -1.349062e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134906.20    0  121 6594038.56 -134906.20   102%     -    0s
H    0     0                    -98889.31536 -134906.20  36.4%     -    0s
H    0     0                    -99514.66101 -134906.20  35.6%     -    0s
H    0     0                    -99641.95909 -110491.24  10.9%     -    0s
H    0     0                    -104035.7514 -110491.24  6.21%     -    0s
     0     0 -110491.24    0  123 -104035.75 -110491.24  6.21%     -    0s
H    0     0                    -106122.1722 -110388.15  4.02%     -    0s
     0     0 -109508.74    0   75 -106122.17 -109508.74  3.19%     -    0s
H    0     0                    -108155.5607 -109502.04  1.24%     -    0s
     0     0 -109198.65    0   71 -108155.56 -109198.65  0.96%     -    0s
     0     0 -109176.27    0   71 -108155.56 -109176.27  0.94%     -    0s
     0     0 -109050.68    0   65 -108155.56 -109050.68  0.83%     -    0s
     0     0 -109024.35    0   65 -108155.56 -109024.35  0.80%     -    0s
H    0     0                    -108166.7814 -109022.15  0.79%     -    0s
     0     2 -109022.15    0   65 -108166.78 -109022.15  0.79%     -    0s
H   95   105                    -108187.5744 -108789.62  0.56%  15.1    0s
H  115   105                    -108199.4757 -108789.62  0.55%  13.4    0s
H  177   105                    -108222.1927 -108789.62  0.52%  10.8    0s
*  323   152              12    -108258.5478 -108679.69  0.39%   9.1    0s
H  678   284                    -108421.4116 -108644.69  0.21%   7.7    0s
H  723   284                    -108464.1258 -108644.69  0.17%   7.7    0s
*  838   202              23    -108472.4553 -108644.69  0.16%   7.5    0s
* 1042    95              22    -108499.4506 -108589.07  0.08%   7.1    0s
* 1248    11              23    -108502.1994 -108589.07  0.08%   6.5    0s

Cutting planes:
  Gomory: 65
  Implied bound: 11
  MIR: 206
  Flow cover: 3
  RLT: 1

Explored 1377 nodes (9028 simplex iterations) in 0.24 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -108502 -108499 -108472 ... -108167
No other solutions better than -108502

Optimal solution found (tolerance 1.00e-04)
Best objective -1.085021994327e+05, best bound -1.085021994327e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 137216.62
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108502.20
  [DEBUG]   S×d_nominal = 245718.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 245718.82 + -108502.20 = 137216.62
  [DEBUG]   Current θ from Master = 138413.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1196.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9022.56
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = 294.1003, Absolute Gap = 294.1003, Relative Gap = 0.028779
  Not converged yet (gap = 294.10 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740038 nonzeros
Model fingerprint: 0x2920d299
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 133926 rows and 54366 columns
Presolve time: 4.91s
Presolved: 127387 rows, 53974 columns, 787679 nonzeros
Variable types: 51715 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -365885.1654
Found heuristic solution: objective -179468.7826

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.48s

Barrier statistics:
 Dense cols : 587
 AA' NZ     : 6.537e+06
 Factor NZ  : 1.563e+07 (roughly 200 MB of memory)
 Factor Ops : 6.236e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.03598002e+07  2.24543213e+08  1.15e+05 1.89e+01  8.56e+04     8s
   1  -1.57126009e+07  2.02076298e+08  8.18e+04 8.97e+01  6.03e+04     8s
   2  -4.71901716e+06  1.57785438e+08  2.38e+04 7.56e-01  1.86e+04     8s
   3  -7.96837221e+05  1.12823279e+08  1.31e+03 1.19e+00  1.46e+03     8s
   4  -5.99211385e+05  7.24391696e+07  4.73e+02 6.43e-01  6.39e+02     8s
   5  -5.18037234e+05  4.55768130e+07  2.38e+02 3.60e-01  3.47e+02     8s
   6  -4.22976825e+05  3.23879431e+07  7.40e+01 2.43e-01  1.83e+02     8s
   7  -3.59534461e+05  2.51817069e+07  2.69e+01 1.83e-01  1.24e+02     8s
   8  -2.46711211e+05  1.70867386e+07  4.69e+00 1.21e-01  7.63e+01     8s
   9  -1.99880541e+05  7.05719087e+06  2.68e+00 4.87e-02  3.17e+01     9s
  10  -1.30560826e+05  4.40309104e+06  1.52e+00 2.97e-02  1.97e+01     9s
  11  -1.17439986e+05  3.75888610e+06  1.25e+00 2.53e-02  1.68e+01     9s
  12  -1.07775612e+05  2.68322411e+06  1.03e+00 1.81e-02  1.21e+01     9s
  13  -8.94584118e+04  2.22049860e+06  6.14e-01 1.50e-02  9.96e+00     9s
  14  -5.54614457e+04  1.21642562e+06  1.92e-01 8.31e-03  5.47e+00     9s
  15  -2.75637165e+04  3.18934210e+05  6.52e-02 1.95e-03  1.49e+00     9s
  16  -8.59709403e+03  2.07888377e+05  3.67e-02 1.44e-03  9.30e-01     9s
  17  -3.75584091e+03  1.58920856e+05  3.12e-02 1.39e-03  6.99e-01     9s
  18   2.32100143e+03  1.18534188e+05  2.45e-02 2.42e-03  4.99e-01    10s
  19   5.74913359e+03  1.02667815e+05  2.09e-02 2.06e-03  4.16e-01    10s
  20   9.62522405e+03  7.78373026e+04  1.70e-02 1.33e-03  2.93e-01    10s
  21   1.64059879e+04  6.21179516e+04  1.07e-02 8.99e-04  1.96e-01    10s
  22   1.93470091e+04  5.19616366e+04  8.46e-03 5.89e-04  1.40e-01    10s
  23   2.18467673e+04  4.57059882e+04  6.76e-03 3.97e-04  1.03e-01    10s
  24   2.37191706e+04  4.21133179e+04  5.53e-03 2.76e-04  7.90e-02    10s
  25   2.64086868e+04  4.00710235e+04  3.85e-03 2.15e-04  5.87e-02    11s
  26   2.80942509e+04  3.71928572e+04  2.86e-03 4.51e-04  3.91e-02    11s
  27   2.90954002e+04  3.60224200e+04  2.30e-03 3.09e-04  2.98e-02    11s
  28   3.05088341e+04  3.53485846e+04  1.50e-03 2.28e-04  2.08e-02    11s
  29   3.12119630e+04  3.46776023e+04  1.13e-03 1.52e-04  1.49e-02    11s
  30   3.14306429e+04  3.45552248e+04  1.01e-03 1.38e-04  1.34e-02    11s
  31   3.19605059e+04  3.44516657e+04  7.14e-04 1.26e-04  1.07e-02    12s
  32   3.22539036e+04  3.41064738e+04  5.54e-04 8.64e-05  7.96e-03    12s
  33   3.25513436e+04  3.37490114e+04  3.98e-04 4.42e-05  5.15e-03    12s
  34   3.27801828e+04  3.36996821e+04  2.77e-04 3.86e-05  3.95e-03    12s
  35   3.29888802e+04  3.35448421e+04  1.72e-04 2.01e-05  2.39e-03    12s
  36   3.31775438e+04  3.34501578e+04  7.83e-05 1.01e-05  1.17e-03    12s
  37   3.32008516e+04  3.34118333e+04  6.70e-05 5.88e-06  9.07e-04    12s
  38   3.32508735e+04  3.33930286e+04  4.49e-05 3.93e-06  6.11e-04    13s
  39   3.32908062e+04  3.33695463e+04  2.73e-05 2.44e-06  3.38e-04    13s
  40   3.32962108e+04  3.33665011e+04  2.49e-05 1.98e-06  3.02e-04    13s
  41   3.33321716e+04  3.33588501e+04  8.60e-06 7.16e-07  1.15e-04    13s
  42   3.33504273e+04  3.33549843e+04  1.13e-06 2.11e-07  1.96e-05    13s
  43   3.33532563e+04  3.33534150e+04  3.26e-08 3.63e-09  6.83e-07    13s
  44   3.33532833e+04  3.33534125e+04  2.00e-06 3.46e-09  5.54e-07    13s
  45   3.33533618e+04  3.33533631e+04  3.88e-08 6.68e-10  5.88e-09    14s
  46   3.33533630e+04  3.33533631e+04  4.37e-08 3.99e-08  2.38e-10    14s

Barrier solved model in 46 iterations and 13.67 seconds (13.16 work units)
Optimal objective 3.33533630e+04


Root crossover log...

  109414 DPushes remaining with DInf 0.0000000e+00                14s
   31415 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    3760 PPushes remaining with PInf 3.3850770e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.3778912e+02     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52206    3.3353363e+04   0.000000e+00   4.377891e+02     18s
   52259    3.3353363e+04   0.000000e+00   0.000000e+00     18s
   52259    3.3353363e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.335336e+04, 52259 iterations, 12.26 seconds (15.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33353.3631    0  261 -179468.78 33353.3631   119%     -   19s
H    0     0                    -104773.2015 33353.3631   132%     -   19s
H    0     0                    -104451.2010 33353.3631   132%     -   20s
H    0     0                    -86462.22073 33353.3631   139%     -   20s
H    0     0                    -86160.86426 33353.3631   139%     -   20s
H    0     0                    -15982.68130 33353.3631   309%     -   20s
H    0     0                    -15474.83679 33353.3631   316%     -   20s
H    0     0                    -15338.21566 33353.3631   317%     -   20s
H    0     0                    -13858.33697 33314.8211   340%     -   22s
H    0     0                    -13244.32387 33314.8211   352%     -   22s
H    0     0                    -12488.68214 26849.5098   315%     -   72s
H    0     0                    -6240.985206 26849.5098   530%     -   72s
H    0     0                    -4770.260583 26849.5098   663%     -   72s
     0     0 26697.9647    0  250 -4770.2606 26697.9647   660%     -   72s
     0     0 26524.6935    0  289 -4770.2606 26524.6935   656%     -   95s
     0     0 26492.6503    0  296 -4770.2606 26492.6503   655%     -  106s
     0     0 26412.1843    0  287 -4770.2606 26412.1843   654%     -  117s
     0     0 26312.1088    0  287 -4770.2606 26312.1088   652%     -  125s
     0     0 26272.8508    0  280 -4770.2606 26272.8508   651%     -  134s
     0     0 26259.2287    0  283 -4770.2606 26259.2287   650%     -  139s
     0     0 26252.9592    0  281 -4770.2606 26252.9592   650%     -  141s
     0     0 26252.7413    0  288 -4770.2606 26252.7413   650%     -  142s
     0     0 23798.4625    0  347 -4770.2606 23798.4625   599%     -  195s
H    0     0                    -3754.584528 23798.3421   734%     -  196s
H    0     0                    -3063.466223 23798.3421   877%     -  196s
H    0     0                    -2935.550809 23798.3421   911%     -  196s
     0     0 23374.5308    0  329 -2935.5508 23374.5308   896%     -  225s
     0     0 23284.0071    0  333 -2935.5508 23284.0071   893%     -  234s
     0     0 22929.4805    0  337 -2935.5508 22929.4805   881%     -  253s
     0     0 22787.4385    0  409 -2935.5508 22787.4385   876%     -  263s
     0     0 22700.7289    0  417 -2935.5508 22700.7289   873%     -  272s
     0     0 22646.7962    0  415 -2935.5508 22646.7962   871%     -  277s
     0     0 22635.4179    0  418 -2935.5508 22635.4179   871%     -  281s
     0     0 22621.5800    0  420 -2935.5508 22621.5800   871%     -  286s
     0     0 22621.3112    0  422 -2935.5508 22621.3112   871%     -  288s
H    0     0                    -260.0151575 20957.1233  8160%     -  352s
H    0     0                    2044.0470541 20957.1233   925%     -  352s
H    0     0                    2919.8883791 20957.1233   618%     -  352s
H    0     0                    7261.1080196 20957.1233   189%     -  352s
H    0     0                    7585.3463789 20957.1233   176%     -  352s
H    0     0                    7677.1169565 20957.1233   173%     -  352s
H    0     0                    7690.4155343 20957.1233   173%     -  352s
     0     0 20957.1233    0  363 7690.41553 20957.1233   173%     -  352s
H    0     0                    7702.2785120 20957.0162   172%     -  354s
     0     0 20256.0260    0  413 7702.27851 20256.0260   163%     -  402s
     0     0 20114.7812    0  415 7702.27851 20114.7812   161%     -  423s
     0     0 20010.1182    0  418 7702.27851 20010.1182   160%     -  436s
     0     0 19935.1540    0  419 7702.27851 19935.1540   159%     -  448s
     0     0 19907.0379    0  416 7702.27851 19907.0379   158%     -  458s
     0     0 19830.7999    0  414 7702.27851 19830.7999   157%     -  469s
     0     0 19767.3429    0  414 7702.27851 19767.3429   157%     -  478s
     0     0 19657.0041    0  398 7702.27851 19657.0041   155%     -  491s
     0     0 19568.5564    0  409 7702.27851 19568.5564   154%     -  502s
H    0     0                    7836.5105798 19518.9186   149%     -  510s
H    0     0                    7838.1208458 19518.9186   149%     -  510s
H    0     0                    7849.1602159 19518.9186   149%     -  510s
     0     0 19518.9186    0  414 7849.16022 19518.9186   149%     -  510s
     0     0 19399.6119    0  340 7849.16022 19399.6119   147%     -  522s
     0     0 19359.3457    0  356 7849.16022 19359.3457   147%     -  528s
     0     0 19321.7107    0  357 7849.16022 19321.7107   146%     -  533s
     0     0 19310.3451    0  358 7849.16022 19310.3451   146%     -  537s
     0     0 19309.2152    0  353 7849.16022 19309.2152   146%     -  538s
     0     0 18719.8251    0  382 7849.16022 18719.8251   138%     -  568s
H    0     0                    7855.8051126 18719.1626   138%     -  569s
H    0     0                    7859.7318713 18719.1626   138%     -  570s
     0     0 18367.2723    0  406 7859.73187 18367.2723   134%     -  586s
     0     0 18337.8353    0  399 7859.73187 18337.8353   133%     -  593s
     0     0 18272.0656    0  390 7859.73187 18272.0656   132%     -  601s
     0     0 18251.0930    0  390 7859.73187 18251.0930   132%     -  607s
     0     0 18215.6430    0  392 7859.73187 18215.6430   132%     -  613s
     0     0 18212.3188    0  394 7859.73187 18212.3188   132%     -  616s
     0     0 18205.3806    0  398 7859.73187 18205.3806   132%     -  618s
     0     0 18199.2786    0  399 7859.73187 18199.2786   132%     -  620s
     0     0 18184.4283    0  404 7859.73187 18184.4283   131%     -  624s
     0     0 18178.1795    0  403 7859.73187 18178.1795   131%     -  626s
     0     0 18174.5884    0  407 7859.73187 18174.5884   131%     -  628s
     0     0 18170.9178    0  401 7859.73187 18170.9178   131%     -  630s
     0     0 18168.6492    0  411 7859.73187 18168.6492   131%     -  631s
     0     0 18167.5848    0  403 7859.73187 18167.5848   131%     -  632s
     0     0 18083.3878    0  381 7859.73187 18083.3878   130%     -  643s
     0     0 18059.9101    0  383 7859.73187 18059.9101   130%     -  648s
     0     0 18036.9537    0  382 7859.73187 18036.9537   129%     -  654s
     0     0 18015.2899    0  392 7859.73187 18015.2899   129%     -  658s
     0     0 18008.0451    0  387 7859.73187 18008.0451   129%     -  661s
     0     0 18004.0719    0  386 7859.73187 18004.0719   129%     -  663s
     0     0 18002.3282    0  391 7859.73187 18002.3282   129%     -  665s
     0     0 17922.8517    0  373 7859.73187 17922.8517   128%     -  677s
     0     0 17876.5192    0  375 7859.73187 17876.5192   127%     -  689s
     0     0 17850.1175    0  432 7859.73187 17850.1175   127%     -  697s
     0     0 17830.7571    0  433 7859.73187 17830.7571   127%     -  705s
     0     0 17821.1798    0  432 7859.73187 17821.1798   127%     -  710s
     0     0 17809.8767    0  430 7859.73187 17809.8767   127%     -  715s
     0     0 17806.2664    0  431 7859.73187 17806.2664   127%     -  717s
     0     0 17801.8026    0  422 7859.73187 17801.8026   126%     -  719s
     0     0 17799.6599    0  429 7859.73187 17799.6599   126%     -  722s
     0     0 17799.4466    0  387 7859.73187 17799.4466   126%     -  723s
     0     0 17768.5390    0  375 7859.73187 17768.5390   126%     -  732s
     0     0 17759.0759    0  421 7859.73187 17759.0759   126%     -  741s
     0     0 17746.3442    0  424 7859.73187 17746.3442   126%     -  745s
     0     0 17742.3369    0  384 7859.73187 17742.3369   126%     -  747s
     0     0 17740.7716    0  382 7859.73187 17740.7716   126%     -  750s
     0     0 17727.6394    0  388 7859.73187 17727.6394   126%     -  759s
H    0     0                    7876.1975198 17726.6037   125%     -  761s
     0     0 17718.3071    0  391 7876.19752 17718.3071   125%     -  765s
     0     0 17715.6860    0  390 7876.19752 17715.6860   125%     -  769s
     0     0 17709.6058    0  389 7876.19752 17709.6058   125%     -  771s
     0     0 17707.8794    0  389 7876.19752 17707.8794   125%     -  773s
     0     0 17662.9582    0  434 7876.19752 17662.9582   124%     -  788s
     0     0 17651.4045    0  441 7876.19752 17651.4045   124%     -  794s
     0     0 17643.1246    0  391 7876.19752 17643.1246   124%     -  797s
     0     0 17639.3424    0  405 7876.19752 17639.3424   124%     -  799s
     0     0 17630.8125    0  394 7876.19752 17630.8125   124%     -  803s
     0     0 17626.8456    0  399 7876.19752 17626.8456   124%     -  805s
     0     0 17624.5936    0  395 7876.19752 17624.5936   124%     -  807s
     0     0 17623.6516    0  394 7876.19752 17623.6516   124%     -  809s
     0     0 17602.0601    0  401 7876.19752 17602.0601   123%     -  817s
     0     0 17595.8090    0  397 7876.19752 17595.8090   123%     -  823s
     0     0 17594.3255    0  393 7876.19752 17594.3255   123%     -  825s
     0     0 17578.8761    0  406 7876.19752 17578.8761   123%     -  833s
     0     0 17576.7553    0  402 7876.19752 17576.7553   123%     -  837s
     0     0 17558.5645    0  398 7876.19752 17558.5645   123%     -  844s
H    0     0                    7876.3597406 17557.7612   123%     -  846s
     0     0 17551.0852    0  401 7876.35974 17551.0852   123%     -  849s
     0     0 17548.3653    0  404 7876.35974 17548.3653   123%     -  851s
     0     0 17546.9566    0  401 7876.35974 17546.9566   123%     -  852s
H    0     0                    7878.1134903 17505.1142   122%     -  859s
H    0     0                    7906.8319534 17505.1142   121%     -  859s
     0     0 17505.1142    0  406 7906.83195 17505.1142   121%     -  859s
     0     0 17501.0125    0  401 7906.83195 17501.0125   121%     -  864s
     0     0 17498.8126    0  412 7906.83195 17498.8126   121%     -  867s
     0     0 17490.8592    0  409 7906.83195 17490.8592   121%     -  868s
     0     0 17488.2334    0  414 7906.83195 17488.2334   121%     -  870s
     0     0 17487.9579    0  408 7906.83195 17487.9579   121%     -  870s
     0     0 17479.7788    0  449 7906.83195 17479.7788   121%     -  876s
     0     0 17478.2607    0  402 7906.83195 17478.2607   121%     -  881s
     0     0 17471.7085    0  465 7906.83195 17471.7085   121%     -  887s
     0     0 17469.9458    0  516 7906.83195 17469.9458   121%     -  891s
     0     0 17464.5658    0  466 7906.83195 17464.5658   121%     -  899s
     0     0 17462.9445    0  411 7906.83195 17462.9445   121%     -  911s
     0     0 17461.6294    0  454 7906.83195 17461.6294   121%     -  915s
     0     0 17461.5730    0  454 7906.83195 17461.5730   121%     -  924s
H    0     0                    8005.1582317 17461.5730   118%     -  994s
H    0     0                    8051.0252268 17461.5730   117%     - 1068s
H    0     2                    8362.3509686 17461.5730   109%     - 1071s
     0     2 17461.5730    0  454 8362.35097 17461.5730   109%     - 1071s
     1     3 16840.3568    1  365 8362.35097 17461.2275   109% 12206 1089s
     2     4 17289.1473    1  446 8362.35097 17289.1473   107%  9092 1103s
     3     7 16157.1408    2  389 8362.35097 17289.1407   107%  9310 1123s
     6    13 16112.5935    3  339 8362.35097 17287.9403   107%  8508 1197s
    12    26 15602.7444    4  415 8362.35097 17122.4110   105% 12284 1223s
    25    39 16337.5244    5  481 8362.35097 16772.7822   101% 14392 1266s
H   38    71                    8405.8947746 16772.7822   100% 14727 1481s
H   39    71                    8528.5347139 16772.7822  96.7% 14607 1481s
H   40    71                    8629.3156015 16772.7822  94.4% 14602 1481s
H   41    71                    8660.3885005 16772.7822  93.7% 14586 1481s
H   42    71                    8783.6996931 16772.7822  91.0% 14418 1481s
H   43    71                    9203.4111416 16772.7822  82.2% 14294 1481s
H   44    71                    9245.1055846 16772.7822  81.4% 14059 1481s
H   48    71                    9662.5632771 16772.7822  73.6% 13482 1481s
    70   200 16013.9271    7  420 9662.56328 16675.9175  72.6% 17732 1529s
   201   234 15074.0594   11  425 9662.56328 16675.9175  72.6% 10735 1550s
H  202   234                    9706.1070830 16675.9175  71.8% 10682 1550s
H  213   234                    9722.6238251 16675.9175  71.5% 10368 1550s
   235   294 14934.5278   12  406 9722.62383 16675.9175  71.5%  9977 1576s
   302   335 14752.6895   15  406 9722.62383 16675.9175  71.5%  8969 1602s
H  316   335                    9735.9224029 16675.9175  71.3%  8795 1602s
   356   380 14001.8661   11  378 9735.92240 16675.9175  71.3%  8411 1626s
   416   409 14474.2335   16  358 9735.92240 16675.9175  71.3%  8161 1646s
H  458   409                    9740.3716495 16675.9175  71.2%  8021 1646s
   459   424 13660.5996   17  340 9740.37165 16675.9175  71.2%  8051 1669s
   501   442 13427.3676   18  343 9740.37165 16675.9175  71.2%  8083 1693s
   538   471 13337.4333   19  338 9740.37165 16675.9175  71.2%  8070 1714s
   569   499 12264.7435   20  256 9740.37165 16675.9175  71.2%  8175 1735s
   600   536 12166.5040   21  243 9740.37165 16675.9175  71.2%  8133 1752s
   645   568 11594.6706   24  180 9740.37165 16675.9175  71.2%  8024 1772s
   689   616 11562.4094   25  230 9740.37165 16675.9175  71.2%  7808 1792s
   747   665 11282.8886   28  273 9740.37165 16557.8489  70.0%  7545 1813s
   812   706     cutoff   31      9740.37165 16467.9935  69.1%  7357 1834s
   881   731 10410.9843   31  220 9740.37165 16467.9935  69.1%  7210 1852s
   914   761 10379.3277   32  224 9740.37165 16467.9935  69.1%  7209 1873s
   956   783     cutoff   33      9740.37165 16225.3799  66.6%  7171 1899s
  1008   794 10459.3690   23  128 9740.37165 16225.3799  66.6%  6995 1922s
  1078   827 10394.4400   24  110 9740.37165 16225.3799  66.6%  6854 1947s
  1166   870 10279.8627   25   98 9740.37165 16225.3799  66.6%  6690 1972s
  1263   904     cutoff   10      9740.37165 16225.3799  66.6%  6567 1998s
  1368   934 12920.4248   12  359 9740.37165 16104.0408  65.3%  6406 2024s
  1413   934     cutoff   32      9740.37165 16104.0408  65.3%  6478 2025s
  1436   975 10936.2817   15  208 9740.37165 16104.0408  65.3%  6507 2051s
  1505  1012 10528.4323   19  212 9740.37165 16104.0408  65.3%  6632 2081s
  1606  1057     cutoff   20      9740.37165 15751.4904  61.7%  6594 2110s
  1695  1094 11868.3002   11  351 9740.37165 15751.4904  61.7%  6618 2140s
  1786  1135 11656.7865   12  346 9740.37165 15751.4904  61.7%  6582 2171s
  1895  1192 11550.5875   14  267 9740.37165 15751.4904  61.7%  6524 2208s
  2012  1235 10274.1890   20  252 9740.37165 15751.4904  61.7%  6475 2243s
  2119  1277 14254.5665   13  323 9740.37165 15376.8719  57.9%  6537 2280s
  2243  1302 12194.9342   15  238 9740.37165 15376.8719  57.9%  6545 2321s
  2358  1345 11090.8869   17  332 9740.37165 15351.2610  57.6%  6593 2360s
  2475  1393     cutoff   20      9740.37165 15331.8129  57.4%  6636 2402s
  2611  1435     cutoff   16      9740.37165 15331.8129  57.4%  6691 2442s
  2783  1481 10733.5890   12  177 9740.37165 15331.8129  57.4%  6627 2480s
  2935  1564 9824.60525   18  118 9740.37165 15331.8129  57.4%  6549 2522s
  3096  1621 11875.5641    9  302 9740.37165 15331.8129  57.4%  6531 2571s
  3299  1669     cutoff   11      9740.37165 15331.8129  57.4%  6416 2620s
  3476  1741 11711.1161   12  206 9740.37165 15014.7899  54.2%  6408 2669s
  3669  1818     cutoff   15      9740.37165 15009.3025  54.1%  6402 2720s
  3865  1848     cutoff   22      9740.37165 14864.9972  52.6%  6420 2773s
  4048  1911 11806.6229    7  235 9740.37165 14709.1517  51.0%  6472 2827s
  4257  1970     cutoff    9      9740.37165 14709.1517  51.0%  6483 2888s
  4424  2074 infeasible   48      9740.37165 14703.4297  51.0%  6574 2943s
  4672  2113 12144.3852    5  355 9740.37165 14460.1837  48.5%  6563 3005s
  4906  2220 11636.7237    6  336 9740.37165 14460.1837  48.5%  6549 3073s
  5154  2270 9942.35470    6  309 9740.37165 14241.3879  46.2%  6527 3137s
  5379  2382 11309.3556   15  363 9740.37165 14240.1803  46.2%  6551 3204s
  5692  2383 11015.4512   22  454 9740.37165 14173.1096  45.5%  6519 3588s

Explored 5693 nodes (37781758 simplex iterations) in 3600.05 seconds (5834.81 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9740.37 9735.92 9722.62 ... 8629.32

Time limit reached
Best objective 9.740371649534e+03, best bound 1.417310961721e+04, gap 45.5089%
  WARNING: Time limit reached. Using best solution found (gap: 45.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 9740.37, θ = 141304.29
  Upper Bound (UB) = 9740.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141304.29
  [DEBUG]   ✓ Scenario 0: θ = 141304.29 ≤ Q = 141304.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141304.29 ≤ Q = 141304.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141304.29 ≤ Q = 141304.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141304.29 ≤ Q = 141304.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141304.29 ≤ Q = 141304.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141304.29 ≤ Q = 141304.29 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6a97725f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6a97725f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.500656e+13
Presolve removed 2649 rows and 1942 columns
Presolve time: 0.01s
Presolved: 444 rows, 447 columns, 1251 nonzeros
Found heuristic solution: objective 6577661.1608
Variable types: 303 continuous, 144 integer (144 binary)

Root relaxation: objective -1.415166e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141516.62    0  128 6577661.16 -141516.62   102%     -    0s
H    0     0                    -108208.9934 -141516.62  30.8%     -    0s
H    0     0                    -108366.0806 -141516.62  30.6%     -    0s
H    0     0                    -108681.1833 -141516.62  30.2%     -    0s
H    0     0                    -108756.7554 -121976.76  12.2%     -    0s
     0     0 -121976.76    0   32 -108756.76 -121976.76  12.2%     -    0s
H    0     0                    -110682.7719 -121883.82  10.1%     -    0s
H    0     0                    -121335.6786 -121883.82  0.45%     -    0s
     0     0 -121483.48    0   14 -121335.68 -121483.48  0.12%     -    0s
     0     0 -121475.14    0    9 -121335.68 -121475.14  0.11%     -    0s
     0     0 -121466.70    0    9 -121335.68 -121466.70  0.11%     -    0s
     0     0 -121465.61    0    9 -121335.68 -121465.61  0.11%     -    0s
     0     0 -121450.34    0    5 -121335.68 -121450.34  0.09%     -    0s
     0     0 -121445.63    0    5 -121335.68 -121445.63  0.09%     -    0s
     0     0 -121445.63    0    9 -121335.68 -121445.63  0.09%     -    0s
H    0     0                    -121438.4367 -121445.63  0.01%     -    0s

Explored 1 nodes (485 simplex iterations) in 0.08 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -121438 -121336 -120642 ... 1.50066e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.214384366680e+05, best bound -1.214456333952e+05, gap 0.0059%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 131407.62
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121438.44
  [DEBUG]   S×d_nominal = 252846.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252846.06 + -121438.44 = 131407.62
  [DEBUG]   Current θ from Master = 141304.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9896.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -156.30
  Lower Bound (LB) = 9925.06
  Gap (UB-LB) = -184.6861, Absolute Gap = 184.6861, Relative Gap = -0.018961
  *** CONVERGED (small negative gap: -184.69 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 17
Total Time: 35286.81s
Converged: True
Final Lower Bound: 9925.0577
Final Upper Bound: 9740.3716
Final Gap: -184.686073
Number of Critical Scenarios: 17
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 8, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 1 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 17
Start Time: 2026-01-05 15:25:03
End Time: 2026-01-06 01:13:10
Total Time: 35286.81s
Optimal Value: 9925.06
Lower Bound: 9925.06
Upper Bound: 9740.37
Gap: -184.686073
Plants Opened: {0: [1], 1: [0], 2: [1]} (3 plants)
DCs Opened: [0, 8, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed3_Mixed_gamma20_20260106_011310.csv

Total Execution Time: 35287.82 seconds
End Time: 2026-01-06 01:13:11

All tasks completed successfully!

