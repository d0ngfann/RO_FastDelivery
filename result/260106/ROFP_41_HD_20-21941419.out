
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 41
DI Scenario: HD
Start Time: 2026-01-05 15:25:19
================================================================================
Loading data from data/DH_data_full_seed41.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.314', '1.727'] (k=0.674)
  Product 1: ['1.000', '1.414', '2.000'] (k=0.855)
  Product 2: ['1.000', '1.363', '1.858'] (k=0.764)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=959, max=1595
  DC capacity (MC): min=463, max=867

Demand Structure (s_rk matrix):
  Total customer-product pairs: 89/150 (40.7% sparse)
  Average products per customer: 1.78

Demand (only non-zero entries):
  Nominal (μ): min=8.15, max=34.51, count=89
  Deviation (μ̂): min=4.09, max=9.86

Costs:
  Plant fixed cost: min=5087, max=9291
  DC fixed cost: min=3141, max=5414
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.314', '1.727'] (k=0.674)
    Product 1: ['1.000', '1.414', '2.000'] (k=0.855)
    Product 2: ['1.000', '1.363', '1.858'] (k=0.764)
  MD:
    Product 0: ['1.000', '1.307', '1.708'] (k=0.660)
    Product 1: ['1.000', '1.280', '1.639'] (k=0.609)
    Product 2: ['1.000', '1.209', '1.462'] (k=0.468)
  LD:
    Product 0: ['1.000', '1.035', '1.071'] (k=0.084)
    Product 1: ['1.000', '1.100', '1.209'] (k=0.234)
    Product 2: ['1.000', '1.102', '1.215'] (k=0.240)
  Mixed:
    Product 0: ['1.000', '1.314', '1.727'] (k=0.674)
    Product 1: ['1.000', '1.280', '1.639'] (k=0.609)
    Product 2: ['1.000', '1.102', '1.215'] (k=0.240)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48777 nonzeros
Model fingerprint: 0xfc15692e
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11502 rows and 2502 columns
Presolve time: 0.13s
Presolved: 5171 rows, 5998 columns, 35796 nonzeros
Variable types: 3739 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -242862.8526
Found heuristic solution: objective -184569.7215

Root relaxation: objective 1.585581e+05, 5526 iterations, 0.46 seconds (0.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 158558.145    0  583 -184569.72 158558.145   186%     -    0s
H    0     0                    -182953.6124 158558.145   187%     -    0s
     0     0 136106.084    0  669 -182953.61 136106.084   174%     -    2s
H    0     0                    -154906.9066 136092.725   188%     -    2s
     0     0 135862.270    0  707 -154906.91 135862.270   188%     -    2s
     0     0 135853.018    0  702 -154906.91 135853.018   188%     -    2s
     0     0 135852.664    0  703 -154906.91 135852.664   188%     -    2s
     0     0 129281.631    0  731 -154906.91 129281.631   183%     -    3s
     0     0 128816.936    0  739 -154906.91 128816.936   183%     -    3s
     0     0 128765.604    0  737 -154906.91 128765.604   183%     -    4s
     0     0 128746.670    0  740 -154906.91 128746.670   183%     -    4s
     0     0 128746.463    0  745 -154906.91 128746.463   183%     -    4s
H    0     0                    -143468.9090 119638.330   183%     -    6s
H    0     0                    -136832.9846 119638.330   187%     -    6s
H    0     0                    -18847.24557 119638.330   735%     -    6s
H    0     0                    27480.197192 119638.330   335%     -    6s
     0     0 119638.330    0  660 27480.1972 119638.330   335%     -    6s
     0     0 118874.573    0  684 27480.1972 118874.573   333%     -    6s
     0     0 118806.358    0  704 27480.1972 118806.358   332%     -    6s
     0     0 118794.472    0  704 27480.1972 118794.472   332%     -    6s
H    0     0                    27710.131761 109636.084   296%     -    8s
H    0     0                    27799.300317 109636.084   294%     -    8s
H    0     0                    28297.088928 109636.084   287%     -    8s
H    0     0                    28382.721619 109636.084   286%     -    8s
H    0     0                    29019.663278 109636.084   278%     -    8s
H    0     0                    29481.144427 109636.084   272%     -    8s
H    0     0                    30054.031859 109636.084   265%     -    8s
H    0     0                    30067.376467 109636.084   265%     -    8s
H    0     0                    30081.462619 109636.084   264%     -    8s
H    0     0                    38561.236973 109636.084   184%     -    8s
     0     0 109636.084    0  559 38561.2370 109636.084   184%     -    8s
     0     0 108572.424    0  529 38561.2370 108572.424   182%     -    9s
H    0     0                    38993.669281 108305.404   178%     -    9s
H    0     0                    39017.486881 108305.404   178%     -    9s
H    0     0                    39058.360516 108305.404   177%     -    9s
H    0     0                    39846.178210 108305.404   172%     -    9s
H    0     0                    40259.411461 108305.404   169%     -    9s
     0     0 108305.404    0  491 40259.4115 108305.404   169%     -    9s
H    0     0                    42072.712004 108228.057   157%     -    9s
H    0     0                    42099.359896 108228.057   157%     -    9s
     0     0 108228.057    0  573 42099.3599 108228.057   157%     -    9s
     0     0 108211.203    0  570 42099.3599 108211.203   157%     -    9s
H    0     0                    42249.448505 105953.991   151%     -   10s
H    0     0                    42264.570417 105953.991   151%     -   10s
H    0     0                    42307.822487 105953.991   150%     -   10s
H    0     0                    42527.730021 105953.991   149%     -   10s
H    0     0                    45731.930106 105953.991   132%     -   10s
     0     0 105953.991    0  617 45731.9301 105953.991   132%     -   10s
     0     0 105437.347    0  698 45731.9301 105437.347   131%     -   11s
     0     0 105282.704    0  687 45731.9301 105282.704   130%     -   11s
     0     0 105246.071    0  712 45731.9301 105246.071   130%     -   11s
     0     0 105237.444    0  702 45731.9301 105237.444   130%     -   11s
     0     0 103639.936    0  684 45731.9301 103639.936   127%     -   13s
     0     0 103259.684    0  783 45731.9301 103259.684   126%     -   13s
     0     0 103150.580    0  774 45731.9301 103150.580   126%     -   13s
     0     0 103118.624    0  796 45731.9301 103118.624   125%     -   14s
     0     0 103112.036    0  802 45731.9301 103112.036   125%     -   14s
H    0     0                    48089.885934 101509.251   111%     -   15s
H    0     0                    48094.486685 101509.251   111%     -   15s
H    0     0                    49530.100732 101509.251   105%     -   15s
H    0     0                    49580.894287 101509.251   105%     -   15s
H    0     0                    49973.734923 101509.251   103%     -   15s
H    0     0                    54372.000183 101509.251  86.7%     -   15s
H    0     0                    55479.715179 101509.251  83.0%     -   15s
H    0     0                    55567.048742 101509.251  82.7%     -   15s
H    0     0                    55608.055727 101509.251  82.5%     -   15s
H    0     0                    55785.568878 101509.251  82.0%     -   15s
     0     0 101509.251    0  786 55785.5689 101509.251  82.0%     -   15s
H    0     0                    55793.151508 101239.091  81.5%     -   16s
H    0     0                    55830.476101 101239.091  81.3%     -   16s
H    0     0                    55834.738126 101239.091  81.3%     -   16s
H    0     0                    55847.847746 101239.091  81.3%     -   16s
H    0     0                    55911.827239 101239.091  81.1%     -   16s
H    0     0                    56174.441844 101239.091  80.2%     -   16s
H    0     0                    56209.331226 101239.091  80.1%     -   16s
H    0     0                    56742.525647 101239.091  78.4%     -   16s
H    0     0                    56768.875106 101239.091  78.3%     -   16s
     0     0 101239.091    0  820 56768.8751 101239.091  78.3%     -   16s
     0     0 101183.212    0  867 56768.8751 101183.212  78.2%     -   16s
     0     0 101162.644    0  857 56768.8751 101162.644  78.2%     -   16s
H    0     0                    56816.753200 101162.644  78.1%     -   16s
H    0     0                    58159.790591 100354.836  72.6%     -   18s
H    0     0                    58863.370062 100354.836  70.5%     -   18s
H    0     0                    58977.363899 100354.836  70.2%     -   18s
     0     0 100354.836    0  770 58977.3639 100354.836  70.2%     -   18s
     0     0 100145.090    0  836 58977.3639 100145.090  69.8%     -   18s
H    0     0                    59089.231017 100102.487  69.4%     -   19s
     0     0 100102.487    0  819 59089.2310 100102.487  69.4%     -   19s
     0     0 100090.578    0  846 59089.2310 100090.578  69.4%     -   19s
H    0     0                    59254.946814 99395.6112  67.7%     -   20s
     0     0 99395.6112    0  727 59254.9468 99395.6112  67.7%     -   20s
H    0     0                    59275.820931 99196.7324  67.3%     -   21s
     0     0 99196.7324    0  835 59275.8209 99196.7324  67.3%     -   21s
H    0     0                    59521.245816 99122.6029  66.5%     -   21s
H    0     0                    59613.706174 99122.6029  66.3%     -   21s
H    0     0                    59982.767055 99122.6029  65.3%     -   21s
H    0     0                    60004.738184 99122.6029  65.2%     -   21s
H    0     0                    60057.190557 99122.6029  65.0%     -   21s
H    0     0                    60086.424769 99122.6029  65.0%     -   21s
H    0     0                    60108.395898 99122.6029  64.9%     -   21s
     0     0 99122.6029    0  881 60108.3959 99122.6029  64.9%     -   21s
H    0     0                    60271.887519 99103.8941  64.4%     -   22s
H    0     0                    60286.275439 99103.8941  64.4%     -   22s
H    0     0                    60326.635477 99103.8941  64.3%     -   22s
H    0     0                    60484.902784 99103.8941  63.8%     -   22s
     0     0 99103.8941    0  882 60484.9028 99103.8941  63.8%     -   22s
H    0     0                    60516.997779 97898.1338  61.8%     -   23s
H    0     0                    60796.994578 97898.1338  61.0%     -   23s
H    0     0                    60894.094554 97898.1338  60.8%     -   23s
H    0     0                    60898.241430 97898.1338  60.8%     -   23s
H    0     0                    61052.658998 97898.1338  60.4%     -   23s
H    0     0                    61057.191891 97898.1338  60.3%     -   23s
     0     0 97898.1338    0  767 61057.1919 97898.1338  60.3%     -   23s
     0     0 97741.0781    0  795 61057.1919 97741.0781  60.1%     -   24s
H    0     0                    61398.867372 97674.0880  59.1%     -   24s
     0     0 97674.0880    0  818 61398.8674 97674.0880  59.1%     -   24s
     0     0 97644.8776    0  873 61398.8674 97644.8776  59.0%     -   24s
H    0     0                    61484.863615 97077.7842  57.9%     -   26s
     0     0 97077.7842    0  721 61484.8636 97077.7842  57.9%     -   26s
H    0     0                    61504.527821 96939.2567  57.6%     -   27s
H    0     0                    61525.034182 96939.2567  57.6%     -   27s
H    0     0                    61538.403252 96939.2567  57.5%     -   27s
     0     0 96939.2567    0  750 61538.4033 96939.2567  57.5%     -   27s
     0     0 96872.9848    0  704 61538.4033 96872.9848  57.4%     -   27s
     0     0 96853.6896    0  812 61538.4033 96853.6896  57.4%     -   27s
     0     0 96485.8899    0  776 61538.4033 96485.8899  56.8%     -   29s
     0     0 96386.1541    0  773 61538.4033 96386.1541  56.6%     -   29s
     0     0 96359.9822    0  802 61538.4033 96359.9822  56.6%     -   30s
     0     0 96060.6368    0  724 61538.4033 96060.6368  56.1%     -   31s
     0     0 96060.5334    0  724 61538.4033 96060.5334  56.1%     -   31s
     0     2 96060.3322    0  724 61538.4033 96060.3322  56.1%     -   32s
     3     8 95731.9118    2  738 61538.4033 95865.3640  55.8%  1177   35s
    15    32 94820.3310    4  637 61538.4033 95088.5017  54.5%  2838   40s
    95   230 93155.4006    7  537 61538.4033 94398.3082  53.4%  1845   46s
H  100   230                    61744.682214 94398.3082  52.9%  1780   46s
H  105   230                    63657.942837 94398.3082  48.3%  1714   46s
H  107   230                    64548.861158 94398.3082  46.2%  1721   46s
H  111   230                    64943.374134 94398.3082  45.4%  1676   46s
H  185   230                    65009.822643 94398.3082  45.2%  1191   46s
H  331   409                    65047.642641 94398.3082  45.1%   942   49s
H  335   409                    65664.196828 94398.3082  43.8%   938   49s
H  394   409                    66211.345195 94398.3082  42.6%   882   49s
   408   493 92775.9801   11  550 66211.3452 94398.3082  42.6%   868   51s
H  535   573                    66736.722585 94398.3082  41.4%   844   53s
   681   776 89492.4444   15  506 66736.7226 94398.3082  41.4%   758   55s
H 1106  1144                    67036.412248 94398.3082  40.8%   607   58s
H 1118  1144                    68283.700423 94398.3082  38.2%   604   58s
  1296  1449 89674.1203   24  383 68283.7004 94398.3082  38.2%   554   61s
  1948  1967 88528.5862   29  383 68283.7004 94362.5842  38.2%   459   66s
  2214  2146 82967.5649   32  341 68283.7004 94277.4154  38.1%   499   70s
H 2263  2210                    68561.939504 94277.4154  37.5%   507   71s
H 2377  2310                    68676.946458 94277.4154  37.3%   506   72s
  2919  3081 76401.4923   67  206 68676.9465 94277.4154  37.3%   466   75s
  3950  3924 88872.0891    8  441 68676.9465 94277.4154  37.3%   404   80s
  4570  4167 83745.8372   47  724 68676.9465 94277.4154  37.3%   403   95s
  4598  4186 91059.6102   13  359 68676.9465 91059.6102  32.6%   400  100s
  4619  4209 87947.4507   14  328 68676.9465 90055.9990  31.1%   403  105s
  4865  4390 75546.4248   20  345 68676.9465 86651.7967  26.2%   410  110s
  5242  4515 70986.2618   25  262 68676.9465 85220.7750  24.1%   408  115s
H 5315  4305                    69738.843000 85059.7369  22.0%   407  115s
  6005  4329 infeasible   25      69738.8430 84108.3847  20.6%   397  120s
  6629  4294 70032.6959   26  233 69738.8430 83181.1331  19.3%   389  125s
  7947  4056 70408.0585   22  321 69738.8430 81734.9775  17.2%   367  130s
 10012  3599 73694.7564   26  213 69738.8430 79703.4414  14.3%   349  135s
 12061  3020 74027.0506   26  261 69738.8430 77890.2804  11.7%   335  140s
 14197  2258 70924.7884   23  249 69738.8430 76313.1953  9.43%   324  145s
 16490  1207     cutoff   22      69738.8430 75262.7666  7.92%   315  150s
 18657   825     cutoff   23      69738.8430 73649.6635  5.61%   306  155s
 20936   182 70061.7263   37   16 69738.8430 70132.5829  0.56%   287  160s
H21500   182                    69822.636439 70132.5829  0.44%   280  160s

Cutting planes:
  Gomory: 1
  Implied bound: 13
  Projected implied bound: 14
  MIR: 340
  Mixing: 1
  Flow cover: 464
  RLT: 17
  Relax-and-lift: 87

Explored 23471 nodes (6115321 simplex iterations) in 160.31 seconds (235.31 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 69822.6 69738.8 68676.9 ... 65047.6

Optimal solution found (tolerance 1.00e-04)
Best objective 6.982263643852e+04, best bound 6.982263643852e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 160.32s
  Master Objective (UB) = 69822.64, θ = 237029.56
  Upper Bound (UB) = 69822.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 237029.56
  [DEBUG]   ✓ Scenario 0: θ = 237029.56 ≤ Q = 237029.56 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5dfee1ce
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5dfee1ce
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.329642e+13
Presolve removed 2544 rows and 1834 columns
Presolve time: 0.01s
Presolved: 549 rows, 555 columns, 1552 nonzeros
Found heuristic solution: objective 7100722.0024
Variable types: 377 continuous, 178 integer (178 binary)

Root relaxation: objective -1.725438e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -172543.84    0  124 7100722.00 -172543.84   102%     -    0s
H    0     0                    -134196.9922 -172543.84  28.6%     -    0s
H    0     0                    -134790.3951 -172543.84  28.0%     -    0s
*    0     0               0    -138303.4672 -138303.47  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 213

Explored 1 nodes (402 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -138303 -134790 -134197 ... 1.32964e+13
No other solutions better than -138303

Optimal solution found (tolerance 1.00e-04)
Best objective -1.383034671737e+05, best bound -1.383034671737e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 203492.52
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138303.47
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -138303.47 = 203492.52
  [DEBUG]   Current θ from Master = 237029.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33537.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 36285.60
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 33537.0392, Absolute Gap = 33537.0392, Relative Gap = 0.480318
  Not converged yet (gap = 33537.04 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92035 nonzeros
Model fingerprint: 0x15b74783
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 36285.6 (0.02s)
MIP start from previous solve produced solution with objective 36285.6 (0.02s)
Loaded MIP start from previous solve with objective 36285.6

Presolve removed 12403 rows and 5042 columns
Presolve time: 0.52s
Presolved: 19560 rows, 9698 columns, 119428 nonzeros
Variable types: 7439 continuous, 2259 integer (2259 binary)

Root relaxation: objective 7.902152e+04, 11787 iterations, 2.03 seconds (2.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 79021.5201    0   79 36285.5973 79021.5201   118%     -    2s
H    0     0                    36494.037218 79021.5201   117%     -    2s
H    0     0                    37214.941674 79021.5201   112%     -    2s
     0     0 74749.9004    0  113 37214.9417 74749.9004   101%     -    3s
H    0     0                    37782.852251 74746.4775  97.8%     -    3s
     0     0 73912.4102    0  111 37782.8523 73912.4102  95.6%     -    4s
     0     0 70648.5731    0  161 37782.8523 70648.5731  87.0%     -    5s
     0     0 69689.3481    0  253 37782.8523 69689.3481  84.4%     -    6s
     0     0 69578.8376    0  252 37782.8523 69578.8376  84.2%     -    6s
     0     0 69533.0667    0  246 37782.8523 69533.0667  84.0%     -    6s
     0     0 69525.0373    0  250 37782.8523 69525.0373  84.0%     -    6s
     0     0 69519.6059    0  257 37782.8523 69519.6059  84.0%     -    6s
     0     0 69519.3654    0  261 37782.8523 69519.3654  84.0%     -    6s
     0     0 68044.8806    0  299 37782.8523 68044.8806  80.1%     -    8s
H    0     0                    40897.164826 67492.3767  65.0%     -    9s
H    0     0                    42588.021309 67492.3767  58.5%     -    9s
H    0     0                    42745.950984 67492.3767  57.9%     -    9s
     0     0 67492.3767    0  309 42745.9510 67492.3767  57.9%     -    9s
     0     0 67272.1331    0  316 42745.9510 67272.1331  57.4%     -    9s
     0     0 67220.3256    0  321 42745.9510 67220.3256  57.3%     -    9s
     0     0 67164.4116    0  313 42745.9510 67164.4116  57.1%     -    9s
     0     0 67151.5237    0  327 42745.9510 67151.5237  57.1%     -   10s
     0     0 67149.1255    0  328 42745.9510 67149.1255  57.1%     -   10s
     0     0 67147.4409    0  328 42745.9510 67147.4409  57.1%     -   10s
     0     0 67147.1406    0  325 42745.9510 67147.1406  57.1%     -   10s
     0     0 66317.9712    0  355 42745.9510 66317.9712  55.1%     -   12s
     0     0 65961.1179    0  398 42745.9510 65961.1179  54.3%     -   12s
     0     0 65851.1240    0  402 42745.9510 65851.1240  54.1%     -   13s
     0     0 65796.3841    0  405 42745.9510 65796.3841  53.9%     -   13s
     0     0 65786.8275    0  401 42745.9510 65786.8275  53.9%     -   13s
     0     0 65780.9766    0  405 42745.9510 65780.9766  53.9%     -   13s
     0     0 65779.7037    0  404 42745.9510 65779.7037  53.9%     -   13s
H    0     0                    42784.949425 65609.2406  53.3%     -   14s
     0     0 65609.2406    0  382 42784.9494 65609.2406  53.3%     -   14s
H    0     0                    42831.885945 65564.7117  53.1%     -   14s
     0     0 65564.7117    0  386 42831.8859 65564.7117  53.1%     -   14s
     0     0 65555.3546    0  372 42831.8859 65555.3546  53.1%     -   14s
     0     0 65549.4770    0  379 42831.8859 65549.4770  53.0%     -   14s
     0     0 65544.2351    0  384 42831.8859 65544.2351  53.0%     -   15s
     0     0 65541.6617    0  388 42831.8859 65541.6617  53.0%     -   15s
     0     0 65539.4339    0  386 42831.8859 65539.4339  53.0%     -   15s
     0     0 65538.0853    0  385 42831.8859 65538.0853  53.0%     -   15s
     0     0 65477.1358    0  385 42831.8859 65477.1358  52.9%     -   15s
H    0     0                    42863.549487 65475.8131  52.8%     -   16s
H    0     0                    42869.081269 65475.8131  52.7%     -   16s
     0     0 65463.3737    0  384 42869.0813 65463.3737  52.7%     -   16s
     0     0 65454.0107    0  383 42869.0813 65454.0107  52.7%     -   16s
     0     0 65444.7942    0  393 42869.0813 65444.7942  52.7%     -   16s
     0     0 65442.0278    0  398 42869.0813 65442.0278  52.7%     -   16s
     0     0 65441.4970    0  394 42869.0813 65441.4970  52.7%     -   16s
     0     0 65416.0952    0  382 42869.0813 65416.0952  52.6%     -   17s
     0     0 65403.3396    0  394 42869.0813 65403.3396  52.6%     -   17s
     0     0 65398.9433    0  391 42869.0813 65398.9433  52.6%     -   17s
     0     0 65396.0164    0  391 42869.0813 65396.0164  52.5%     -   17s
     0     0 65394.6863    0  391 42869.0813 65394.6863  52.5%     -   17s
     0     0 65389.4405    0  397 42869.0813 65389.4405  52.5%     -   18s
     0     0 65386.8834    0  404 42869.0813 65386.8834  52.5%     -   18s
     0     0 65386.8260    0  406 42869.0813 65386.8260  52.5%     -   18s
     0     0 65385.5564    0  402 42869.0813 65385.5564  52.5%     -   18s
     0     0 65384.3589    0  399 42869.0813 65384.3589  52.5%     -   19s
     0     0 65380.4008    0  401 42869.0813 65380.4008  52.5%     -   19s
     0     0 65379.4968    0  401 42869.0813 65379.4968  52.5%     -   19s
     0     0 65370.5911    0  406 42869.0813 65370.5911  52.5%     -   19s
     0     0 65370.3440    0  406 42869.0813 65370.3440  52.5%     -   20s
     0     2 65370.3440    0  406 42869.0813 65370.3440  52.5%     -   24s
     3     8 65046.7804    2  391 42869.0813 65256.9722  52.2%   418   25s
H   64    96                    42893.333986 64725.7559  50.9%   940   29s
    95   215 64235.7534    7  372 42893.3340 64725.7559  50.9%   745   30s
   406   475 63536.3467   13  401 42893.3340 64725.7559  50.9%   446   35s
H  464   475                    43016.260993 64725.7559  50.5%   430   35s
H  543   610                    43095.762024 64725.7559  50.2%   426   37s
H  557   610                    43168.774420 64725.7559  49.9%   427   37s
   836   868 62730.4695   17  386 43168.7744 64725.7559  49.9%   371   40s
H  914   930                    43280.677968 64725.7559  49.5%   368   42s
  1235  1244 61854.6597   22  372 43280.6780 64616.1611  49.3%   340   45s
H 1267  1244                    43609.060005 64616.1611  48.2%   336   45s
H 1295  1272                    43680.307619 64616.1611  47.9%   341   47s
H 1325  1272                    43707.675091 64616.1611  47.8%   340   47s
  1491  1504 61003.1460   25  367 43707.6751 64394.3411  47.3%   346   50s
H 1724  1652                    43761.934519 64394.3411  47.1%   348   53s
  1838  1798 59735.5793   31  348 43761.9345 64394.3411  47.1%   357   55s
H 1987  1865                    43790.845191 64307.0908  46.9%   380   57s
  1993  1922 58287.2701   34  341 43790.8452 64307.0908  46.9%   381   60s
H 2290  2208                    43862.092805 64307.0908  46.6%   393   64s
H 2292  2208                    43886.219825 64307.0908  46.5%   393   64s
H 2308  2208                    44100.433560 64307.0908  45.8%   392   64s
H 2352  2208                    44257.402413 64307.0908  45.3%   391   64s
  2355  2383 55556.8705   39  208 44257.4024 64307.0908  45.3%   392   66s
  2920  2896 51531.2711   46  219 44257.4024 64307.0908  45.3%   375   70s
  3567  3362 50372.9348   52  168 44257.4024 64307.0908  45.3%   353   75s
H 3967  3405                    45139.933591 64221.6446  42.3%   353   78s
  3968  3406 54973.7688   35  406 45139.9336 64221.6446  42.3%   353   85s
  3972  3409 46371.5822   83  309 45139.9336 64221.6446  42.3%   352   90s
  3980  3414 50369.7195   67  392 45139.9336 64221.6446  42.3%   352   95s
  3989  3420 63152.6270   15  390 45139.9336 64221.6446  42.3%   351  100s
  3998  3426 55827.5369   20  390 45139.9336 64221.6446  42.3%   350  105s
  4004  3430 60773.4123   10  392 45139.9336 64221.6446  42.3%   350  111s
  4006  3434 60334.7819   11  384 45139.9336 64221.6446  42.3%   356  115s
  4020  3458 59292.4624   14  366 45139.9336 64221.6446  42.3%   357  120s
H 4038  3311                    45405.946947 64131.7366  41.2%   363  122s
H 4048  3144                    45416.138466 64131.7366  41.2%   363  122s
H 4049  2988                    45464.670406 64131.7366  41.1%   363  122s
H 4055  2839                    45590.532009 63961.9298  40.3%   363  122s
  4100  2928 57885.9709   17  374 45590.5320 63958.4798  40.3%   371  125s
H 4102  2787                    45896.540652 63958.4798  39.4%   371  125s
H 4232  2691                    45961.434172 63958.4798  39.2%   382  128s
  4284  2721 55231.9265   20  288 45961.4342 63958.4798  39.2%   384  130s
  4485  2759 54150.2241   23  314 45961.4342 62450.5803  35.9%   393  135s
H 4499  2628                    46015.557273 62450.5803  35.7%   394  135s
H 4628  2519                    46085.613992 61911.0482  34.3%   397  138s
  4706  2564 51440.0016   25  221 46085.6140 61580.2652  33.6%   399  140s
  4947  2681 51552.0996   28  269 46085.6140 61047.6748  32.5%   400  145s
  5096  2685 50603.6553   29  253 46085.6140 60736.0908  31.8%   399  151s
  5269  2701 48567.7361   31  244 46085.6140 60736.0908  31.8%   399  155s
  5526  2680 46895.0831   36  246 46085.6140 60736.0908  31.8%   400  160s
  5773  2744 56748.6888   19  321 46085.6140 59809.8751  29.8%   399  166s
  6135  2774 48253.5931   26  256 46085.6140 58925.2468  27.9%   396  171s
  6647  2859 48911.9737   22  273 46085.6140 58886.0522  27.8%   393  176s
  7110  2893     cutoff   29      46085.6140 58458.0885  26.8%   390  180s
  7655  2893 50672.0533   22  250 46085.6140 57662.6010  25.1%   385  185s
  8198  2941 52236.3973   21  301 46085.6140 57063.1309  23.8%   383  190s
  8990  2978 52133.4500   22  205 46085.6140 56619.9640  22.9%   381  197s
  9590  2914 50938.5405   31  185 46085.6140 56206.2091  22.0%   381  202s
H 9747  2740                    46127.646548 55929.2328  21.2%   381  202s
 10243  2752 46347.7334   29  165 46127.6465 55890.1487  21.2%   379  207s
 10574  2775 52755.1781   24  277 46127.6465 55861.2311  21.1%   380  210s
 11282  3028 48475.0539   24  277 46127.6465 55328.2891  19.9%   381  216s
 12071  3232 47189.8844   26  225 46127.6465 55190.6655  19.6%   382  222s
 12360  3297 50327.5017   24  219 46127.6465 54888.4261  19.0%   382  225s
 12973  3395 46433.8968   29  149 46127.6465 54684.4380  18.6%   384  233s
 13336  3498 51602.9545   25  258 46127.6465 54601.9059  18.4%   384  236s
 13843  3564     cutoff   29      46127.6465 54518.6557  18.2%   384  240s
H13853  3561                    46128.983028 54518.6557  18.2%   384  240s
 14773  3758 48739.1445   25  264 46128.9830 54278.4581  17.7%   384  248s
H15343  3943                    46167.224283 53826.9315  16.6%   384  252s
H15485  3932                    46199.337028 53826.9315  16.5%   383  252s
*15887  3928             101    46232.850626 53773.6560  16.3%   381  252s
 16054  3970 49829.1699   24  232 46232.8506 53610.5423  16.0%   380  258s
H16081  3968                    46246.543319 53591.5772  15.9%   381  258s
 16417  4066     cutoff   30      46246.5433 53591.5772  15.9%   380  262s
 17061  4195 50601.6511   19  325 46246.5433 53355.2851  15.4%   380  266s
 17752  4295 49884.3325   24  208 46246.5433 53210.7613  15.1%   379  271s
 18334  4408 51204.8062   24  287 46246.5433 53045.7036  14.7%   379  276s
 19074  4503 49943.8722   25  240 46246.5433 53036.2623  14.7%   378  281s
 19833  4513     cutoff   26      46246.5433 52825.9406  14.2%   378  287s
H19834  4502                    46273.959948 52825.9406  14.2%   378  287s
H19838  4478                    46339.704943 52825.9406  14.0%   378  287s
H19841  4475                    46342.816145 52825.9406  14.0%   378  287s
H19886  4473                    46350.333334 52825.9406  14.0%   378  287s
H19935  4447                    46418.283283 52825.9406  13.8%   378  287s
H20027  4417                    46469.165741 52825.9406  13.7%   378  287s
 20062  4537 47802.3905   28  284 46469.1657 52825.9406  13.7%   378  293s
 20971  4632     cutoff   28      46469.1657 52578.3200  13.1%   376  299s
 21861  4662 47289.2573   24  135 46469.1657 52437.0337  12.8%   375  304s
 22476  4675     cutoff   35      46469.1657 52311.3678  12.6%   374  310s
H22554  4667                    46498.646121 52211.5970  12.3%   374  310s
 23323  4771 48496.9303   19  296 46498.6461 52084.7902  12.0%   373  316s
 24302  4749 49737.6699   27  244 46498.6461 51965.6023  11.8%   372  322s
 25273  4717 48637.4271   24  215 46498.6461 51702.0695  11.2%   372  329s
 26334  4720 47852.0678   28  296 46498.6461 51528.9483  10.8%   371  336s
 27507  4668 47547.5391   22  259 46498.6461 51260.6342  10.2%   369  342s
 28461  4605     cutoff   29      46498.6461 51105.8598  9.91%   369  349s
 29181  4468 48642.9716   25  292 46498.6461 50924.0157  9.52%   367  356s
 30336  4305 48517.5457   24  205 46498.6461 50718.8497  9.08%   366  364s
 31611  4097 46977.9489   32  170 46498.6461 50442.9013  8.48%   365  371s
 32970  3719     cutoff   26      46498.6461 50176.2161  7.91%   364  379s
 34513  3186 46711.5286   28  250 46498.6461 49841.7768  7.19%   362  387s
 36007  2370     cutoff   26      46498.6461 49543.0652  6.55%   360  395s
 37775  1804     cutoff   26      46498.6461 49050.0754  5.49%   356  404s
H37963  1804                    46500.163357 48996.8757  5.37%   356  404s
 38625  2111 46959.1171   34  114 46500.1634 48783.2374  4.91%   353  412s
H39201  2111                    46504.890526 48739.0532  4.80%   349  412s
*45032  2111              62    46508.508326 47130.7922  1.34%   311  412s
 45151  3758 46562.3067   58   22 46508.5083 47126.2046  1.33%   311  420s
H45400  3687                    46530.285005 47126.2046  1.28%   309  420s
*46155  3660              82    46537.045996 47123.3808  1.26%   304  420s
*46161  3578              82    46556.463284 47123.3808  1.22%   304  420s
*46169  3528              85    46572.141085 47123.3808  1.18%   304  420s
*46285  3528              84    46595.400041 47123.3808  1.13%   304  420s
*47171  3528              87    46596.563272 47123.3808  1.13%   298  420s
*48092  3528              72    46618.407299 47123.3808  1.08%   293  420s
*48768  3528              77    46680.882319 47123.3808  0.95%   289  420s
H50366  3528                    46681.112871 47123.3808  0.95%   281  420s
*51112  3528             112    46691.575363 47123.3808  0.92%   277  420s

Cutting planes:
  MIR: 470
  Mixing: 2
  Flow cover: 926
  RLT: 11
  Relax-and-lift: 79

Explored 55912 nodes (14294295 simplex iterations) in 422.23 seconds (835.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 46691.6 46691.6 46681.1 ... 46537

Optimal solution found (tolerance 1.00e-04)
Best objective 4.669157536256e+04, best bound 4.669157536256e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 422.30s
  Master Objective (UB) = 46691.58, θ = 191941.08
  Upper Bound (UB) = 46691.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191941.08
  [DEBUG]   ✓ Scenario 0: θ = 191941.08 ≤ Q = 191941.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191941.08 ≤ Q = 191990.93 (slack: 49.85)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x552eac48
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x552eac48
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.346772e+13
Presolve removed 2552 rows and 1843 columns
Presolve time: 0.01s
Presolved: 541 rows, 546 columns, 1527 nonzeros
Found heuristic solution: objective 7440869.9820
Variable types: 369 continuous, 177 integer (177 binary)
Found heuristic solution: objective 7440418.0691

Root relaxation: objective -1.676698e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167669.84    0  134 7440418.07 -167669.84   102%     -    0s
H    0     0                    -147149.0325 -167669.84  13.9%     -    0s
H    0     0                    -147252.2666 -167669.84  13.9%     -    0s
     0     0 -155653.16    0   86 -147252.27 -155653.16  5.71%     -    0s
H    0     0                    -153905.4412 -155572.09  1.08%     -    0s
     0     0 -154987.09    0   76 -153905.44 -154987.09  0.70%     -    0s
     0     0 -154981.41    0   76 -153905.44 -154981.41  0.70%     -    0s
H    0     0                    -154156.1848 -154979.60  0.53%     -    0s
     0     0 -154979.60    0   75 -154156.18 -154979.60  0.53%     -    0s
     0     0 -154422.11    0   46 -154156.18 -154422.11  0.17%     -    0s
     0     0 -154402.60    0   37 -154156.18 -154402.60  0.16%     -    0s
     0     0 -154401.46    0   24 -154156.18 -154401.46  0.16%     -    0s
     0     0 -154334.43    0   33 -154156.18 -154334.43  0.12%     -    0s
     0     0 -154330.38    0   22 -154156.18 -154330.38  0.11%     -    0s
     0     0 -154327.61    0   22 -154156.18 -154327.61  0.11%     -    0s
     0     0 -154231.87    0    9 -154156.18 -154231.87  0.05%     -    0s
     0     0 -154231.87    0   10 -154156.18 -154231.87  0.05%     -    0s
*    0     0               0    -154188.1314 -154188.13  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 3
  MIR: 2
  Flow cover: 4
  Relax-and-lift: 3

Explored 1 nodes (722 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -154188 -154156 -153499 ... 1.34677e+13
No other solutions better than -154188

Optimal solution found (tolerance 1.00e-04)
Best objective -1.541881313516e+05, best bound -1.541881313516e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 166744.99
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154188.13
  [DEBUG]   S×d_nominal = 320933.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320933.12 + -154188.13 = 166744.99
  [DEBUG]   Current θ from Master = 191941.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25196.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21495.49
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 10405.9781, Absolute Gap = 10405.9781, Relative Gap = 0.222866
  Not converged yet (gap = 10405.98 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135293 nonzeros
Model fingerprint: 0xfd24b727
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 21495.5 (0.03s)
MIP start from previous solve produced solution with objective 21495.5 (0.03s)
Loaded MIP start from previous solve with objective 21495.5

Presolve removed 18563 rows and 7543 columns
Presolve time: 0.73s
Presolved: 28690 rows, 13437 columns, 176954 nonzeros
Variable types: 11178 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   46234    6.8004557e+04   0.000000e+00   6.095289e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   15144    7.7204969e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 7.720497e+04, 15144 iterations, 4.92 seconds (6.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 77204.9694    0   88 21495.4914 77204.9694   259%     -    5s
H    0     0                    34846.289904 77204.9694   122%     -    6s
H    0     0                    35430.304622 77204.9694   118%     -    6s
H    0     0                    35993.271396 77204.9694   114%     -    6s
H    0     0                    36320.705506 77204.9694   113%     -    6s
H    0     0                    37456.662328 77204.9694   106%     -    6s
     0     0 73161.0581    0  115 37456.6623 73161.0581  95.3%     -    8s
     0     0 72342.7127    0  111 37456.6623 72342.7127  93.1%     -    9s
     0     0 72342.7127    0  119 37456.6623 72342.7127  93.1%     -    9s
     0     0 69678.2944    0  161 37456.6623 69678.2944  86.0%     -   12s
H    0     0                    38082.618690 69678.1960  83.0%     -   12s
H    0     0                    38135.469570 69678.1960  82.7%     -   12s
H    0     0                    38210.350044 69678.1960  82.4%     -   12s
H    0     0                    38241.859671 69678.1960  82.2%     -   12s
H    0     0                    38313.121428 69678.1960  81.9%     -   12s
     0     0 68537.4711    0  266 38313.1214 68537.4711  78.9%     -   13s
     0     0 68184.3940    0  270 38313.1214 68184.3940  78.0%     -   13s
     0     0 68109.7092    0  275 38313.1214 68109.7092  77.8%     -   14s
     0     0 68074.6629    0  277 38313.1214 68074.6629  77.7%     -   14s
     0     0 68068.6364    0  270 38313.1214 68068.6364  77.7%     -   14s
     0     0 68067.4500    0  275 38313.1214 68067.4500  77.7%     -   14s
     0     0 68067.4487    0  275 38313.1214 68067.4487  77.7%     -   14s
     0     0 66819.6352    0  302 38313.1214 66819.6352  74.4%     -   17s
     0     0 66256.6951    0  324 38313.1214 66256.6951  72.9%     -   18s
     0     0 66129.1917    0  342 38313.1214 66129.1917  72.6%     -   19s
     0     0 65941.3612    0  342 38313.1214 65941.3612  72.1%     -   19s
H    0     0                    38441.817973 65891.8622  71.4%     -   20s
H    0     0                    38500.563922 65891.8622  71.1%     -   20s
H    0     0                    38595.272934 65891.8622  70.7%     -   20s
H    0     0                    38721.804434 65891.8622  70.2%     -   20s
     0     0 65891.8622    0  340 38721.8044 65891.8622  70.2%     -   20s
H    0     0                    38732.477312 65866.2362  70.1%     -   20s
H    0     0                    38896.275866 65866.2362  69.3%     -   20s
     0     0 65866.2362    0  344 38896.2759 65866.2362  69.3%     -   20s
H    0     0                    39099.647263 65861.8732  68.4%     -   20s
H    0     0                    39100.143657 65861.8732  68.4%     -   20s
     0     0 65861.8732    0  349 39100.1437 65861.8732  68.4%     -   20s
H    0     0                    39115.821458 65860.6769  68.4%     -   20s
     0     0 65860.6769    0  351 39115.8215 65860.6769  68.4%     -   20s
     0     0 65860.1307    0  353 39115.8215 65860.1307  68.4%     -   20s
H    0     0                    39251.686393 65860.1307  67.8%     -   23s
     0     0 64870.9205    0  339 39251.6864 64870.9205  65.3%     -   24s
     0     0 64619.0013    0  350 39251.6864 64619.0013  64.6%     -   25s
     0     0 64527.3146    0  350 39251.6864 64527.3146  64.4%     -   26s
     0     0 64485.6485    0  355 39251.6864 64485.6485  64.3%     -   27s
     0     0 64451.7690    0  360 39251.6864 64451.7690  64.2%     -   27s
H    0     0                    39429.688655 64441.0443  63.4%     -   28s
     0     0 64441.0443    0  362 39429.6887 64441.0443  63.4%     -   28s
     0     0 64437.5791    0  363 39429.6887 64437.5791  63.4%     -   28s
     0     0 64435.4400    0  365 39429.6887 64435.4400  63.4%     -   28s
     0     0 64434.9636    0  367 39429.6887 64434.9636  63.4%     -   28s
     0     0 64059.3842    0  430 39429.6887 64059.3842  62.5%     -   30s
H    0     0                    39599.139068 64058.9347  61.8%     -   31s
H    0     0                    39680.153205 64058.9347  61.4%     -   31s
H    0     0                    39735.736875 64058.9347  61.2%     -   31s
     0     0 63972.6715    0  394 39735.7369 63972.6715  61.0%     -   32s
     0     0 63939.5250    0  392 39735.7369 63939.5250  60.9%     -   32s
     0     0 63901.5000    0  403 39735.7369 63901.5000  60.8%     -   33s
     0     0 63891.6274    0  380 39735.7369 63891.6274  60.8%     -   33s
     0     0 63886.8784    0  418 39735.7369 63886.8784  60.8%     -   34s
     0     0 63881.4769    0  413 39735.7369 63881.4769  60.8%     -   34s
     0     0 63879.1154    0  414 39735.7369 63879.1154  60.8%     -   34s
     0     0 63878.4779    0  418 39735.7369 63878.4779  60.8%     -   34s
     0     0 63736.4014    0  374 39735.7369 63736.4014  60.4%     -   36s
     0     0 63715.5608    0  381 39735.7369 63715.5608  60.3%     -   36s
     0     0 63708.5775    0  417 39735.7369 63708.5775  60.3%     -   37s
     0     0 63704.7217    0  379 39735.7369 63704.7217  60.3%     -   37s
     0     0 63703.3219    0  384 39735.7369 63703.3219  60.3%     -   37s
     0     0 63649.4987    0  382 39735.7369 63649.4987  60.2%     -   39s
     0     0 63633.7305    0  382 39735.7369 63633.7305  60.1%     -   39s
     0     0 63624.9373    0  391 39735.7369 63624.9373  60.1%     -   40s
     0     0 63623.4295    0  390 39735.7369 63623.4295  60.1%     -   40s
     0     0 63614.8614    0  383 39735.7369 63614.8614  60.1%     -   40s
H    0     0                    39740.945844 63614.4392  60.1%     -   41s
H    0     0                    39770.831964 63614.4392  60.0%     -   41s
     0     0 63610.5412    0  390 39770.8320 63610.5412  59.9%     -   41s
     0     0 63607.2749    0  394 39770.8320 63607.2749  59.9%     -   41s
     0     0 63602.1484    0  386 39770.8320 63602.1484  59.9%     -   41s
     0     0 63599.5294    0  396 39770.8320 63599.5294  59.9%     -   41s
     0     0 63598.0796    0  390 39770.8320 63598.0796  59.9%     -   41s
     0     0 63592.4683    0  383 39770.8320 63592.4683  59.9%     -   42s
     0     0 63590.3645    0  397 39770.8320 63590.3645  59.9%     -   42s
     0     0 63588.5612    0  403 39770.8320 63588.5612  59.9%     -   43s
     0     0 63588.1196    0  405 39770.8320 63588.1196  59.9%     -   43s
     0     0 63583.9022    0  396 39770.8320 63583.9022  59.9%     -   43s
     0     0 63577.5614    0  410 39770.8320 63577.5614  59.9%     -   44s
     0     0 63575.9145    0  400 39770.8320 63575.9145  59.9%     -   44s
     0     0 63574.7669    0  398 39770.8320 63574.7669  59.9%     -   44s
     0     0 63573.7482    0  392 39770.8320 63573.7482  59.9%     -   45s
     0     0 63553.3649    0  385 39770.8320 63553.3649  59.8%     -   45s
     0     0 63543.2888    0  399 39770.8320 63543.2888  59.8%     -   46s
     0     0 63541.9747    0  393 39770.8320 63541.9747  59.8%     -   46s
     0     0 63537.3293    0  401 39770.8320 63537.3293  59.8%     -   47s
     0     0 63535.7016    0  400 39770.8320 63535.7016  59.8%     -   47s
     0     0 63535.7016    0  401 39770.8320 63535.7016  59.8%     -   48s
     0     0 63535.4775    0  399 39770.8320 63535.4775  59.8%     -   48s
     0     0 63535.4345    0  401 39770.8320 63535.4345  59.8%     -   48s
     0     0 63534.2321    0  401 39770.8320 63534.2321  59.8%     -   49s
H    0     0                    40945.741935 63534.2321  55.2%     -   55s
H    0     0                    40976.810314 63534.2321  55.0%     -   56s
H    0     2                    41012.879176 63534.2321  54.9%     -   56s
     0     2 63534.2321    0  401 41012.8792 63534.2321  54.9%     -   56s
     3     8 63333.7058    2  391 41012.8792 63410.5109  54.6%  1583   61s
    15    32 63008.1952    4  384 41012.8792 63274.5487  54.3%  2604   68s
H   31    64                    41510.525005 63008.0675  51.8%  3990   71s
    95   170 62573.6076    7  388 41510.5250 62947.0072  51.6%  2339   77s
H  125   170                    42228.451996 62947.0072  49.1%  2084   77s
   169   255 62082.2962    8  377 42228.4520 62947.0072  49.1%  1858   81s
   254   287 60401.9315    8  350 42228.4520 62947.0072  49.1%  1680   85s
   329   362 62065.2666   10  375 42228.4520 62947.0072  49.1%  1702   92s
   361   397 61803.9841   10  400 42228.4520 62947.0072  49.1%  1665   96s
   428   469 59722.8194   12  304 42228.4520 62947.0072  49.1%  1610  102s
   468   501 61754.9603   12  416 42228.4520 62947.0072  49.1%  1588  105s
H  495   501                    43347.249548 62947.0072  45.2%  1560  105s
   698   726 61007.1277   20  419 43347.2495 62888.8330  45.1%  1291  111s
   766   803 60878.1031   21  417 43347.2495 62888.8330  45.1%  1261  115s
H  775   803                    43624.852984 62888.8330  44.2%  1261  115s
   866   953 60216.6117   23  418 43624.8530 62888.8330  44.2%  1206  120s
  1068  1133 59863.6491   24  410 43624.8530 62751.4728  43.8%  1097  127s
  1173  1227 58398.1284   25  393 43624.8530 62751.4728  43.8%  1063  130s
  1395  1406 57481.6381   27  373 43624.8530 62619.0313  43.5%  1011  137s
H 1522  1459                    43730.732000 62619.0313  43.2%  1009  139s
  1555  1558 57338.2796   29  306 43730.7320 62619.0313  43.2%   999  143s
  1668  1648 56542.8892   34  346 43730.7320 62619.0313  43.2%   985  147s
  1766  1740 52218.9396   34  339 43730.7320 62619.0313  43.2%   981  150s
  1991  1961 53832.4621   36  338 43730.7320 62374.8301  42.6%   968  158s
  2113  2107 53806.0457   37  289 43730.7320 62374.8301  42.6%   955  162s
  2297  2274 49196.3899   38  282 43730.7320 62374.8301  42.6%   924  166s
  2504  2468 45305.2517   39  290 43730.7320 62374.8301  42.6%   892  170s
  2986  2704 61180.6514   15  388 43730.7320 62334.7285  42.5%   823  178s
  3145  2766 59921.5042   17  348 43730.7320 62196.5365  42.2%   824  183s
  3251  2866 55191.4473   20  285 43730.7320 62196.5365  42.2%   843  187s
  3395  3003 50801.4405   23  238 43730.7320 62196.5365  42.2%   846  192s
  3596  3114 47777.9719   32  228 43730.7320 62196.5365  42.2%   837  197s
H 3798  3114                    43779.344995 62083.5812  41.8%   834  201s
  3799  3115 58070.3314   11  401 43779.3450 62083.5812  41.8%   833  211s
  3801  3116 45454.8158   50   88 43779.3450 62083.5812  41.8%   833  217s
  3802  3117 46484.6313   17  207 43779.3450 62083.5812  41.8%   833  223s
  3803  3118 47112.7240   37  283 43779.3450 62083.5812  41.8%   832  226s
  3805  3119 51007.0730   24  362 43779.3450 62083.5812  41.8%   832  231s
  3809  3122 54988.7111   12  376 43779.3450 62083.5812  41.8%   831  235s
  3815  3126 46981.1499   36  378 43779.3450 62083.5812  41.8%   830  240s
  3821  3130 56240.6226   25  387 43779.3450 62083.5812  41.8%   829  246s
  3825  3132 57702.7539   23  458 43779.3450 62083.5812  41.8%   828  251s
  3829  3135 52272.9899   27  401 43779.3450 62083.5812  41.8%   827  255s
  3833  3138 60017.6354   26  401 43779.3450 62083.5812  41.8%   826  260s
  3838  3141 55614.6763   19  402 43779.3450 62083.5812  41.8%   825  271s
  3839  3142 60420.0431   11  402 43779.3450 62083.5812  41.8%   825  276s
  3840  3145 62083.5812   16  394 43779.3450 62083.5812  41.8%   840  283s
  3842  3149 62083.5812   17  365 43779.3450 62083.5812  41.8%   841  287s
  3846  3155 57156.6822   18  345 43779.3450 62083.5812  41.8%   845  291s
  3854  3169 56735.4310   19  366 43779.3450 62083.5812  41.8%   852  297s
  3870  3193 53281.6030   20  369 43779.3450 62083.5812  41.8%   870  309s
  3900  3215 59497.1339   21  317 43779.3450 62017.0870  41.7%   933  313s
  3932  3237 57472.3911   22  272 43779.3450 61629.9633  40.8%   947  320s
  3964  3260 56760.1763   23  270 43779.3450 61629.6298  40.8%   967  325s
  3998  3288 55380.0459   23  223 43779.3450 61629.6298  40.8%   980  330s
H 4026  3120                    44208.073635 61629.6298  39.4%   993  330s
  4037  3199 56271.9854   24  243 44208.0736 61629.6298  39.4%   997  337s
  4127  3210 53687.2416   26  229 44208.0736 61629.6298  39.4%  1025  343s
  4193  3229 54404.3309   25  202 44208.0736 61629.6298  39.4%  1034  348s
  4276  3237 51010.8572   24  250 44208.0736 60205.2584  36.2%  1049  353s
  4360  3235 52732.5564   26  214 44208.0736 60205.2584  36.2%  1061  359s
  4429  3233 50527.8944   27  193 44208.0736 59921.7686  35.5%  1075  361s
H 4454  3075                    44505.334929 59704.5627  34.2%  1078  361s
  4467  3115 48583.4168   28  232 44505.3349 59704.5627  34.2%  1080  365s
H 4556  2961                    44689.468908 58711.8812  31.4%  1092  369s
  4582  2977 48221.5562   29  179 44689.4689 58711.8812  31.4%  1097  373s
  4672  2982 45105.3873   30  187 44689.4689 58600.5084  31.1%  1098  376s
  4754  2980     cutoff   31      44689.4689 58600.5084  31.1%  1101  381s
  4849  2966 53707.3339   25  246 44689.4689 58600.5084  31.1%  1108  385s
H 4851  2829                    45039.831311 58600.5084  30.1%  1108  385s
H 4852  2701                    45154.211463 58600.5084  29.8%  1108  385s
  4994  2746 50925.6952   27  218 45154.2115 57560.1210  27.5%  1119  396s
  5082  2766 45713.4542   28  175 45154.2115 57556.9635  27.5%  1126  400s
  5183  2783 51751.3844   28  245 45154.2115 57556.9635  27.5%  1128  407s
  5291  2801     cutoff   29      45154.2115 57354.6532  27.0%  1129  411s
H 5418  2662                    45644.134984 56841.9852  24.5%  1128  414s
  5459  2669 50548.2527   31  203 45644.1350 56841.9852  24.5%  1130  419s
  5591  2647     cutoff   33      45644.1350 56688.2774  24.2%  1131  425s
  5834  2657 46657.8946   36  110 45644.1350 56538.3875  23.9%  1143  437s
  5960  2669     cutoff   39      45644.1350 56231.2621  23.2%  1148  443s
  6106  2645 53068.9404   27  260 45644.1350 56091.7840  22.9%  1153  448s
  6212  2636 51496.6930   28  215 45644.1350 56091.7840  22.9%  1154  454s
  6348  2638     cutoff   30      45644.1350 56091.7840  22.9%  1157  460s
  6497  2632     cutoff   34      45644.1350 55887.3686  22.4%  1162  468s
  6663  2634 52770.0093   25  279 45644.1350 55887.3686  22.4%  1167  474s
  6823  2645 50916.1160   28  196 45644.1350 55517.1552  21.6%  1172  481s
  7009  2619 47943.4261   33  152 45644.1350 55504.2134  21.6%  1176  488s
  7193  2620     cutoff   42      45644.1350 55239.6587  21.0%  1180  494s
  7385  2597 51599.9021   28  272 45644.1350 55239.6587  21.0%  1182  502s
  7528  2606 50317.0797   30  294 45644.1350 54983.5662  20.5%  1182  510s
  7772  2546     cutoff   32      45644.1350 54894.1650  20.3%  1181  517s
  8014  2532 48625.1696   31  169 45644.1350 54894.1650  20.3%  1186  526s
  8232  2537     cutoff   27      45644.1350 54004.4905  18.3%  1188  534s
  8517  2492 49804.8254   29  287 45644.1350 53961.7091  18.2%  1186  543s
  8725  2435 48558.2470   33  224 45644.1350 53847.4846  18.0%  1186  552s
  9099  2334     cutoff   35      45644.1350 53670.7162  17.6%  1179  561s
  9427  2265 48853.6525   28  192 45644.1350 53219.9944  16.6%  1179  571s
  9738  2165     cutoff   35      45644.1350 53104.2176  16.3%  1185  579s
  9959  2127 47992.8457   27  257 45644.1350 53061.3052  16.2%  1186  589s
 10230  2096 51152.2341   27  294 45644.1350 52831.7536  15.7%  1190  600s
 10561  2034     cutoff   28      45644.1350 52671.1108  15.4%  1189  610s
 10920  1997 47333.0749   28  259 45644.1350 52509.3290  15.0%  1192  621s
 11210  2012     cutoff   30      45644.1350 52318.0451  14.6%  1192  634s
 11632  2015     cutoff   26      45644.1350 52180.2257  14.3%  1194  645s
 12117  1996 46975.7148   30  243 45644.1350 51886.6503  13.7%  1192  657s
 12536  1966 47678.5369   30  245 45644.1350 51565.9654  13.0%  1192  670s
 13053  1927 infeasible   36      45644.1350 51471.4698  12.8%  1189  683s
 13624  1865 46483.4442   30  187 45644.1350 51086.4025  11.9%  1185  696s
 14177  1807 47045.7935   28  333 45644.1350 50903.5596  11.5%  1184  709s
 14776  1692 46422.1052   31  176 45644.1350 50481.7918  10.6%  1180  723s
 15386  1537 45947.4322   33  148 45644.1350 50053.8460  9.66%  1178  736s
 16075  1238     cutoff   28      45644.1350 49681.6360  8.85%  1172  751s
 16886   816     cutoff   32      45644.1350 49293.6997  8.00%  1160  766s
 17745    37     cutoff   34      45644.1350 48685.2623  6.66%  1147  781s

Cutting planes:
  MIR: 376
  Mixing: 1
  Flow cover: 655
  RLT: 10
  Relax-and-lift: 69

Explored 19052 nodes (20984081 simplex iterations) in 783.35 seconds (1609.87 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 45644.1 45154.2 45039.8 ... 43347.2

Optimal solution found (tolerance 1.00e-04)
Best objective 4.564413498390e+04, best bound 4.564413498390e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 783.37s
  Master Objective (UB) = 45644.13, θ = 206603.21
  Upper Bound (UB) = 45644.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206603.21
  [DEBUG]   ✓ Scenario 0: θ = 206603.21 ≤ Q = 206603.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206603.21 ≤ Q = 206603.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206603.21 ≤ Q = 206603.21 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7f20c2c8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x80df3d38
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.222999e+13
Presolve removed 2544 rows and 1835 columns
Presolve time: 0.01s
Presolved: 549 rows, 554 columns, 1549 nonzeros
Found heuristic solution: objective 6367117.6711
Variable types: 376 continuous, 178 integer (178 binary)

Root relaxation: objective -1.699774e+05, 283 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169977.39    0  136 6367117.67 -169977.39   103%     -    0s
H    0     0                    -131640.8436 -169977.39  29.1%     -    0s
H    0     0                    -132281.1581 -169977.39  28.5%     -    0s
H    0     0                    -137676.5497 -169977.39  23.5%     -    0s
H    0     0                    -149197.5270 -169977.39  13.9%     -    0s
     0     0 -159577.65    0   99 -149197.53 -159577.65  6.96%     -    0s
H    0     0                    -156679.6631 -159503.15  1.80%     -    0s
H    0     0                    -157330.8873 -159197.29  1.19%     -    0s
     0     0 -159197.29    0   80 -157330.89 -159197.29  1.19%     -    0s
     0     0 -159197.18    0   79 -157330.89 -159197.18  1.19%     -    0s
     0     0 -157909.96    0   51 -157330.89 -157909.96  0.37%     -    0s
H    0     0                    -157338.2400 -157908.92  0.36%     -    0s
     0     0 -157861.06    0   48 -157338.24 -157861.06  0.33%     -    0s
     0     0 -157490.82    0   28 -157338.24 -157490.82  0.10%     -    0s
     0     0 -157473.47    0   10 -157338.24 -157473.47  0.09%     -    0s
H    0     0                    -157396.2834 -157468.79  0.05%     -    0s
     0     0 -157439.28    0    7 -157396.28 -157439.28  0.03%     -    0s
     0     0 -157433.20    0    5 -157396.28 -157433.20  0.02%     -    0s
     0     0 -157433.20    0   11 -157396.28 -157433.20  0.02%     -    0s
H    0     0                    -157420.2091 -157433.20  0.01%     -    0s

Explored 1 nodes (746 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -157420 -157396 -157338 ... 1.223e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.574202090949e+05, best bound -1.574332042793e+05, gap 0.0083%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 184375.78
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157420.21
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -157420.21 = 184375.78
  [DEBUG]   Current θ from Master = 206603.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22227.43 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23416.71
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 9358.5377, Absolute Gap = 9358.5377, Relative Gap = 0.205033
  Not converged yet (gap = 9358.54 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178551 nonzeros
Model fingerprint: 0x82dd4212
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 23416.7 (0.04s)
MIP start from previous solve produced solution with objective 23416.7 (0.04s)
Loaded MIP start from previous solve with objective 23416.7

Presolve removed 24724 rows and 10044 columns
Presolve time: 1.17s
Presolved: 37819 rows, 17176 columns, 234179 nonzeros
Variable types: 14917 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37819 rows, 17176 columns, 234179 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54117    2.8504158e+04   0.000000e+00   1.485696e+06      5s
   69609    6.4312309e+04   0.000000e+00   1.576535e+07     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 7.676126e+04, 25577 iterations, 12.57 seconds (16.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 76761.2635    0   83 23416.7082 76761.2635   228%     -   14s
H    0     0                    25288.208506 76761.2635   204%     -   14s
H    0     0                    37841.160359 76761.2635   103%     -   14s
H    0     0                    38285.774665 76761.2635   100%     -   14s
H    0     0                    39066.683300 76761.2635  96.5%     -   14s
H    0     0                    40353.376610 76761.2635  90.2%     -   14s
H    0     0                    40354.052987 76761.2635  90.2%     -   14s
H    0     0                    40378.937360 71502.6540  77.1%     -   20s
H    0     0                    40542.818357 71502.6540  76.4%     -   20s
     0     0 71285.0790    0  168 40542.8184 71285.0790  75.8%     -   20s
     0     0 71285.0618    0  179 40542.8184 71285.0618  75.8%     -   21s
     0     0 71285.0618    0  181 40542.8184 71285.0618  75.8%     -   21s
     0     0 71285.0618    0  181 40542.8184 71285.0618  75.8%     -   21s
     0     0 68274.9909    0  252 40542.8184 68274.9909  68.4%     -   26s
     0     0 67778.3833    0  266 40542.8184 67778.3833  67.2%     -   29s
     0     0 67680.0694    0  280 40542.8184 67680.0694  66.9%     -   30s
     0     0 67602.0119    0  273 40542.8184 67602.0119  66.7%     -   30s
     0     0 67570.4374    0  268 40542.8184 67570.4374  66.7%     -   31s
     0     0 67550.0458    0  272 40542.8184 67550.0458  66.6%     -   31s
     0     0 67547.8149    0  270 40542.8184 67547.8149  66.6%     -   31s
     0     0 67547.2981    0  276 40542.8184 67547.2981  66.6%     -   32s
H    0     0                    40883.127363 65670.2756  60.6%     -   39s
H    0     0                    40902.503001 65670.2756  60.6%     -   39s
H    0     0                    41230.574760 65670.2756  59.3%     -   39s
     0     0 65670.2756    0  314 41230.5748 65670.2756  59.3%     -   39s
H    0     0                    41395.704523 65665.8930  58.6%     -   40s
     0     0 65123.2446    0  331 41395.7045 65123.2446  57.3%     -   43s
     0     0 64980.1514    0  331 41395.7045 64980.1514  57.0%     -   44s
     0     0 64932.8873    0  331 41395.7045 64932.8873  56.9%     -   45s
     0     0 64904.5994    0  337 41395.7045 64904.5994  56.8%     -   45s
     0     0 64868.0459    0  362 41395.7045 64868.0459  56.7%     -   46s
     0     0 64849.8858    0  330 41395.7045 64849.8858  56.7%     -   46s
     0     0 64845.9924    0  332 41395.7045 64845.9924  56.6%     -   47s
     0     0 64844.4558    0  328 41395.7045 64844.4558  56.6%     -   47s
     0     0 64844.0956    0  332 41395.7045 64844.0956  56.6%     -   47s
     0     0 64226.4679    0  352 41395.7045 64226.4679  55.2%     -   54s
     0     0 64060.1171    0  368 41395.7045 64060.1171  54.8%     -   57s
     0     0 63912.3955    0  372 41395.7045 63912.3955  54.4%     -   59s
H    0     0                    41409.933875 63802.6945  54.1%     -   60s
     0     0 63802.6945    0  367 41409.9339 63802.6945  54.1%     -   61s
     0     0 63757.8142    0  368 41409.9339 63757.8142  54.0%     -   62s
     0     0 63742.5436    0  371 41409.9339 63742.5436  53.9%     -   62s
     0     0 63738.7140    0  375 41409.9339 63738.7140  53.9%     -   62s
     0     0 63736.4845    0  377 41409.9339 63736.4845  53.9%     -   63s
     0     0 63735.5401    0  377 41409.9339 63735.5401  53.9%     -   63s
     0     0 63513.8865    0  385 41409.9339 63513.8865  53.4%     -   66s
H    0     0                    41485.596663 63511.2225  53.1%     -   66s
H    0     0                    41676.519276 63511.2225  52.4%     -   66s
H    0     0                    41799.056489 63511.2225  51.9%     -   66s
     0     0 63424.5223    0  392 41799.0565 63424.5223  51.7%     -   69s
H    0     0                    41951.906153 63395.3900  51.1%     -   70s
     0     0 63395.3900    0  389 41951.9062 63395.3900  51.1%     -   70s
     0     0 63383.3090    0  392 41951.9062 63383.3090  51.1%     -   70s
H    0     0                    42708.787359 63375.0939  48.4%     -   71s
     0     0 63375.0939    0  391 42708.7874 63375.0939  48.4%     -   71s
     0     0 63369.8040    0  393 42708.7874 63369.8040  48.4%     -   71s
     0     0 63368.3393    0  393 42708.7874 63368.3393  48.4%     -   72s
     0     0 63226.8649    0  387 42708.7874 63226.8649  48.0%     -   74s
H    0     0                    42724.433050 63226.2312  48.0%     -   74s
H    0     0                    42897.373575 63226.2312  47.4%     -   74s
     0     0 63191.1647    0  396 42897.3736 63191.1647  47.3%     -   76s
     0     0 63179.6518    0  395 42897.3736 63179.6518  47.3%     -   77s
     0     0 63173.3297    0  397 42897.3736 63173.3297  47.3%     -   78s
     0     0 63171.3039    0  399 42897.3736 63171.3039  47.3%     -   79s
     0     0 63165.8865    0  400 42897.3736 63165.8865  47.2%     -   80s
     0     0 63164.8415    0  398 42897.3736 63164.8415  47.2%     -   81s
     0     0 63141.3428    0  393 42897.3736 63141.3428  47.2%     -   83s
H    0     0                    43826.465215 63138.7735  44.1%     -   83s
     0     0 63135.5349    0  404 43826.4652 63135.5349  44.1%     -   83s
     0     0 63131.9771    0  400 43826.4652 63131.9771  44.0%     -   83s
     0     0 63127.1359    0  401 43826.4652 63127.1359  44.0%     -   84s
     0     0 63126.7145    0  398 43826.4652 63126.7145  44.0%     -   84s
     0     0 63109.6126    0  387 43826.4652 63109.6126  44.0%     -   86s
     0     0 63104.9289    0  400 43826.4652 63104.9289  44.0%     -   87s
     0     0 63104.9289    0  398 43826.4652 63104.9289  44.0%     -   88s
     0     0 63098.7010    0  390 43826.4652 63098.7010  44.0%     -   89s
     0     0 63093.7372    0  396 43826.4652 63093.7372  44.0%     -   90s
     0     0 63092.3463    0  394 43826.4652 63092.3463  44.0%     -   90s
     0     0 63090.7603    0  401 43826.4652 63090.7603  44.0%     -   91s
     0     0 63090.1136    0  397 43826.4652 63090.1136  44.0%     -   92s
     0     0 63089.5935    0  401 43826.4652 63089.5935  44.0%     -   93s
     0     0 63073.9344    0  401 43826.4652 63073.9344  43.9%     -   94s
H    0     0                    43924.537295 63072.7139  43.6%     -  109s
     0     2 63072.7139    0  401 43924.5373 63072.7139  43.6%     -  110s
     3     8 62466.5210    2  374 43924.5373 62788.2291  42.9%  4586  119s
     7    16 62328.8895    3  376 43924.5373 62464.1929  42.2%  4375  124s
    15    32 62146.4121    4  391 43924.5373 62327.8077  41.9%  4499  132s
    31    63 60230.1998    5  356 43924.5373 62144.0845  41.5%  6540  144s
    62    95 59926.9796    6  377 43924.5373 62144.0845  41.5%  6526  151s
    94   132 59878.9212    7  369 43924.5373 62144.0845  41.5%  5260  157s
   131   169 59828.0529    8  361 43924.5373 62144.0845  41.5%  4168  164s
   168   233 59255.5662    8  341 43924.5373 62144.0845  41.5%  3739  172s
   232   310 58916.0302    9  323 43924.5373 62144.0845  41.5%  3570  182s
   309   400 59247.6257   10  335 43924.5373 62144.0845  41.5%  3327  189s
   399   484 55256.1758   11  322 43924.5373 62144.0845  41.5%  3054  196s
   484   564 59061.1453   11  328 43924.5373 62144.0845  41.5%  2829  203s
   575   626 58722.9547   10  314 43924.5373 62144.0845  41.5%  2604  211s
   641   699 58874.3633   12  332 43924.5373 61904.9479  40.9%  2494  215s
   716   767 58939.2802   13  328 43924.5373 61904.3535  40.9%  2402  221s
   790   837 58803.5074   13  311 43924.5373 61904.3535  40.9%  2334  226s
   868   874 57262.6084   14  331 43924.5373 61904.3535  40.9%  2262  230s
   905   925 58660.9615   13  257 43924.5373 61904.3535  40.9%  2249  238s
   960   988 57755.5392   16  290 43924.5373 61904.3535  40.9%  2228  244s
  1030  1052 57227.7185   18  227 43924.5373 61904.3535  40.9%  2161  251s
  1108  1124 57271.1228   19  218 43924.5373 61904.3535  40.9%  2100  257s
  1188  1197 57173.9250   19  235 43924.5373 61904.3535  40.9%  2043  262s
  1275  1299 56954.5698   22  319 43924.5373 61904.3535  40.9%  1984  269s
  1377  1383 56859.3921   23  313 43924.5373 61904.3535  40.9%  1912  274s
  1475  1450 56486.9714   25  252 43924.5373 61904.3535  40.9%  1862  281s
  1556  1547 54615.0825   24  318 43924.5373 61611.4245  40.3%  1849  287s
  1661  1668 54878.5727   26  209 43924.5373 61611.4245  40.3%  1809  295s
  1796  1803 54250.6759   27  309 43924.5373 61611.4245  40.3%  1741  303s
  1955  1939 54698.8283   27  208 43924.5373 61611.4245  40.3%  1664  309s
  2101  2074 53952.2831   29  207 43924.5373 61611.4245  40.3%  1610  317s
  2254  2176 53799.0848   32  258 43924.5373 61611.4245  40.3%  1559  327s
  2384  2311 53297.8732   33  195 43924.5373 61611.4245  40.3%  1539  335s
  2539  2477 52979.7506   35  182 43924.5373 61611.4245  40.3%  1504  343s
  2739  2606 51808.4621   37  170 43924.5373 61611.4245  40.3%  1447  351s
  2928  2763 infeasible   38      43924.5373 61611.4245  40.3%  1414  359s
  3122  2953 50450.1248   40  177 43924.5373 61611.4245  40.3%  1383  370s
  3377  2954 51396.2385   29  401 43924.5373 61611.4245  40.3%  1338  396s
  3379  2955 51036.2346   51   83 43924.5373 61611.4245  40.3%  1337  408s
  3380  2956 57120.6020    9  314 43924.5373 61611.4245  40.3%  1337  416s
  3381  2957 57255.2021   15  329 43924.5373 61611.4245  40.3%  1336  423s
  3382  2957 59187.9465   14  356 43924.5373 61611.4245  40.3%  1336  427s
  3383  2958 56852.4950   25  384 43924.5373 61611.4245  40.3%  1335  431s
  3385  2959 54903.4849   16  386 43924.5373 61611.4245  40.3%  1335  435s
  3387  2961 48159.1203   66  420 43924.5373 61611.4245  40.3%  1334  440s
  3390  2963 44497.2080   36  392 43924.5373 61611.4245  40.3%  1333  445s
  3394  2965 56815.5350   15  398 43924.5373 61611.4245  40.3%  1331  450s
  3397  2967 54516.6830   17  393 43924.5373 61611.4245  40.3%  1330  457s
  3399  2969 53819.1634   16  406 43924.5373 61611.4245  40.3%  1329  460s
  3402  2971 54786.3591   16  416 43924.5373 61611.4245  40.3%  1328  467s
  3405  2973 48037.3651   41  413 43924.5373 61611.4245  40.3%  1327  472s
  3407  2974 53428.3952   32  461 43924.5373 61611.4245  40.3%  1326  477s
  3409  2975 45705.2231   72  400 43924.5373 61611.4245  40.3%  1325  481s
  3411  2977 49020.4794  103  445 43924.5373 61611.4245  40.3%  1325  485s
  3412  2977 53364.7509   42  445 43924.5373 61611.4245  40.3%  1324  497s
  3413  2978 53061.4544   48  445 43924.5373 61611.4245  40.3%  1324  511s
  3414  2982 61611.4245   11  429 43924.5373 61611.4245  40.3%  1355  523s
  3416  2985 61611.4245   12  406 43924.5373 61611.4245  40.3%  1358  533s
  3420  2992 61611.4245   13  419 43924.5373 61611.4245  40.3%  1362  543s
  3428  3005 61611.4245   14  411 43924.5373 61611.4245  40.3%  1370  555s
  3444  3022 57921.6061   15  359 43924.5373 61611.4245  40.3%  1410  574s
  3466  3046 57787.9474   16  388 43924.5373 61611.4245  40.3%  1455  588s
  3498  3125 56858.8680   17  348 43924.5373 61611.4245  40.3%  1496  600s
  3587  3168 56306.0671   19  352 43924.5373 61611.4245  40.3%  1572  611s
  3660  3202 55625.7328   19  334 43924.5373 61611.4245  40.3%  1606  622s
  3722  3242 55515.2950   20  320 43924.5373 61611.4245  40.3%  1634  634s
  3801  3265 55556.1101   21  327 43924.5373 61251.4612  39.4%  1648  645s
  3875  3288 51707.2012   20  364 43924.5373 61249.7037  39.4%  1664  656s
  3963  3305 53767.1342   21  306 43924.5373 61249.7037  39.4%  1669  668s
  4034  3329 54790.4225   21  328 43924.5373 61249.7037  39.4%  1682  676s
  4102  3343 54036.3440   22  306 43924.5373 61249.7037  39.4%  1691  685s
  4177  3344 52773.7156   23  284 43924.5373 60702.2360  38.2%  1698  694s
  4229  3353 54181.6829   22  328 43924.5373 60702.2360  38.2%  1707  700s
  4265  3378 52311.8294   23  295 43924.5373 60702.2360  38.2%  1717  708s
  4311  3388 51854.2337   23  281 43924.5373 60056.9453  36.7%  1727  715s
  4345  3407 50618.0640   24  204 43924.5373 60056.9453  36.7%  1736  725s
  4392  3423 49772.0333   25  181 43924.5373 60056.9453  36.7%  1746  731s
  4444  3442 48780.7593   26  182 43924.5373 60056.9453  36.7%  1749  739s
  4520  3441 48650.9443   27  186 43924.5373 59668.7785  35.8%  1750  745s
  4558  3459 48420.1136   28  174 43924.5373 59668.7785  35.8%  1754  753s
  4607  3474 48210.3685   29  176 43924.5373 59390.0539  35.2%  1756  762s
  4661  3489 47775.8777   30  191 43924.5373 59376.4565  35.2%  1761  772s
  4714  3509 47101.6881   31  173 43924.5373 59376.4565  35.2%  1765  784s
  4778  3535 47802.6738   29  178 43924.5373 59376.4565  35.2%  1768  794s
  4856  3546 46961.0736   30  167 43924.5373 59376.4565  35.2%  1775  803s
  4911  3576     cutoff   31      43924.5373 58764.7576  33.8%  1780  812s
  5015  3596 46305.0622   35  202 43924.5373 58511.1098  33.2%  1777  822s
  5135  3617 44138.4529   39  220 43924.5373 58210.5590  32.5%  1775  835s
  5286  3618 54617.9439   18  347 43924.5373 58210.5590  32.5%  1770  846s
  5443  3645 54120.0398   20  329 43924.5373 57958.3993  31.9%  1768  858s
  5586  3688 51141.4582   23  288 43924.5373 57958.3993  31.9%  1773  870s
  5741  3711     cutoff   31      43924.5373 57958.3993  31.9%  1777  885s
  5893  3718 51485.6137   19  301 43924.5373 57828.8704  31.7%  1785  899s
  6034  3733 49703.5566   22  257 43924.5373 57828.8704  31.7%  1795  910s
  6126  3779 45030.3102   26  128 43924.5373 57626.6415  31.2%  1797  923s
  6292  3802 53341.4831   19  226 43924.5373 57618.7479  31.2%  1801  938s
  6463  3820 52837.8209   21  217 43924.5373 57618.7479  31.2%  1804  953s
  6647  3841 53180.6588   21  262 43924.5373 57472.7053  30.8%  1808  970s
  6827  3888 47933.8325   22  284 43924.5373 57472.7053  30.8%  1818  984s
  7040  3906 52106.1129   23  264 43924.5373 57472.7053  30.8%  1820 1000s
  7250  3890     cutoff   26      43924.5373 57472.7053  30.8%  1825 1017s
  7477  3893 46960.9323   21  316 43924.5373 57307.2674  30.5%  1820 1037s
  7683  3926 45655.2776   22  269 43924.5373 56879.1581  29.5%  1835 1054s
  7896  3962     cutoff   25      43924.5373 56299.7099  28.2%  1845 1072s
  8179  3978 51338.5215   21  289 43924.5373 56299.7099  28.2%  1845 1092s
  8444  4016 47784.3965   26  173 43924.5373 56224.8318  28.0%  1851 1114s
  8797  3935     cutoff   29      43924.5373 56224.8318  28.0%  1846 1135s
  8983  3994 52076.5461   24  293 43924.5373 56196.2619  27.9%  1844 1154s
  9184  4047 47259.2989   30  105 43924.5373 56196.2619  27.9%  1851 1176s
  9559  4080 52724.4087   21  318 43924.5373 56085.2475  27.7%  1844 1199s
  9883  4081 48507.9270   31  184 43924.5373 56085.2475  27.7%  1847 1223s
 10229  4080 50125.8231   21  340 43924.5373 55761.1799  26.9%  1852 1245s
 10530  4092 44713.3224   24  306 43924.5373 55091.7636  25.4%  1866 1274s
 10950  4028 48118.6751   19  332 43924.5373 55091.7636  25.4%  1864 1300s
 11307  4018 48605.1740   20  339 43924.5373 54777.3729  24.7%  1874 1326s
 11702  4043 52973.9330   21  353 43924.5373 54777.3729  24.7%  1881 1354s
 12215  4018 46368.4376   30  160 43924.5373 54773.9633  24.7%  1868 1382s
 12766  4108 infeasible   23      43924.5373 54414.1755  23.9%  1856 1414s
 13287  4203 45100.2211   25  257 43924.5373 54304.6029  23.6%  1852 1445s
 13509  4369 47153.3460   20  278 43924.5373 54304.6029  23.6%  1853 1475s
H13521  4248                    44524.058723 54304.6029  22.0%  1853 1475s
 13968  4426 48497.6873   24  240 44524.0587 54191.8763  21.7%  1854 1507s
 14600  4548 44696.8311   27  258 44524.0587 53954.5911  21.2%  1841 1537s
 15217  4636 45476.8603   26  222 44524.0587 53902.4737  21.1%  1833 1571s
 15921  4773 49178.1143   23  294 44524.0587 53668.3640  20.5%  1820 1605s
H15939  4760                    44567.692411 53668.3640  20.4%  1819 1605s
H16013  4713                    44691.668412 53668.3640  20.1%  1820 1605s
H16386  4691                    44757.894505 53664.0002  19.9%  1821 1605s
 16440  4819 50028.5211   24  270 44757.8945 53664.0002  19.9%  1820 1642s
 17059  4974 49931.0315   22  234 44757.8945 53288.5681  19.1%  1823 1678s
 17718  5123 47056.9891   25  225 44757.8945 53152.0320  18.8%  1822 1716s
 18465  5247     cutoff   30      44757.8945 52979.9839  18.4%  1815 1756s
 19228  5258 50659.5376   27  317 44757.8945 52972.4879  18.4%  1809 1791s
H19234  5192                    44972.733030 52972.4879  17.8%  1808 1791s
H19237  5120                    45141.961432 52972.4879  17.3%  1808 1791s
H19251  4976                    45494.532591 52972.4879  16.4%  1809 1791s
 19285  5076 49564.3280   28  302 45494.5326 52972.4879  16.4%  1809 1835s
 20035  5227 49501.7911   24  335 45494.5326 52672.2064  15.8%  1810 1880s
 20780  5362 47485.8184   20  336 45494.5326 52633.8922  15.7%  1811 1925s
 21628  5480 48572.6374   22  232 45494.5326 52400.1882  15.2%  1806 1972s
 22281  5644 45605.4957   30  251 45494.5326 52260.1823  14.9%  1801 2021s
 23203  5722 infeasible   25      45494.5326 52117.8931  14.6%  1796 2070s
 24165  5783 48666.5420   25  307 45494.5326 51873.9276  14.0%  1794 2124s
 25219  5868     cutoff   27      45494.5326 51735.4549  13.7%  1787 2174s
 26222  5908     cutoff   32      45494.5326 51619.1111  13.5%  1786 2228s
 27277  5959     cutoff   27      45494.5326 51473.3209  13.1%  1784 2285s
 28344  6037 48199.9158   27  224 45494.5326 51271.8324  12.7%  1783 2345s
 29428  6125 46257.3589   28  245 45494.5326 51159.1517  12.5%  1780 2411s
 30764  6136 45914.7354   19  273 45494.5326 50871.7194  11.8%  1774 2465s
 31923  6142     cutoff   26      45494.5326 50690.9162  11.4%  1769 2522s
 33130  6084 47088.5185   32  170 45494.5326 50551.8677  11.1%  1763 2581s
 34274  6025     cutoff   22      45494.5326 50333.1683  10.6%  1762 2643s
 35542  5927 46305.7247   25  208 45494.5326 50153.3317  10.2%  1758 2710s
 36956  5764 47732.2010   28  213 45494.5326 49920.5758  9.73%  1752 2778s
 38399  5600 infeasible   26      45494.5326 49714.9403  9.28%  1745 2847s
 39907  5348 46422.5914   28  173 45494.5326 49495.8806  8.80%  1739 2919s
 41460  5045     cutoff   26      45494.5326 49279.1239  8.32%  1733 2991s
 43090  4577 46121.7186   31  249 45494.5326 49030.0846  7.77%  1727 3066s
 44830  3988     cutoff   29      45494.5326 48760.6049  7.18%  1719 3144s
 46747  3191 infeasible   25      45494.5326 48445.7352  6.49%  1707 3225s
*48768  3166              49    45554.717913 48099.7475  5.59%  1693 3225s
 48792  2309     cutoff   29      45554.7179 48099.7475  5.59%  1693 3306s
H48794  2306                    45560.033339 48099.7475  5.57%  1693 3306s
 50387   535     cutoff   29      45560.0333 47891.3947  5.12%  1678 3378s
 52921     0     cutoff   24      45560.0333 46646.2036  2.38%  1636 3384s
*53182     0              52    45592.522418 46472.3530  1.93%  1629 3384s

Cutting planes:
  Learned: 2
  MIR: 652
  Flow cover: 1390
  RLT: 14
  Relax-and-lift: 124

Explored 53557 nodes (86789369 simplex iterations) in 3384.43 seconds (7296.31 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 45592.5 45592.5 45560 ... 44567.7

Optimal solution found (tolerance 1.00e-04)
Best objective 4.559252241760e+04, best bound 4.559252241760e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3384.49s
  Master Objective (UB) = 45592.52, θ = 206946.98
  Upper Bound (UB) = 45592.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206946.98
  [DEBUG]   ✓ Scenario 0: θ = 206946.98 ≤ Q = 206946.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206946.98 ≤ Q = 206946.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206946.98 ≤ Q = 206946.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206946.98 ≤ Q = 206946.98 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x595aade5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa6a5521b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.244585e+13
Presolve removed 2543 rows and 1834 columns
Presolve time: 0.01s
Presolved: 550 rows, 555 columns, 1552 nonzeros
Found heuristic solution: objective 6522673.5655
Variable types: 377 continuous, 178 integer (178 binary)

Root relaxation: objective -1.691354e+05, 274 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169135.43    0  133 6522673.57 -169135.43   103%     -    0s
H    0     0                    -131071.0212 -169135.43  29.0%     -    0s
H    0     0                    -131567.8905 -169135.43  28.6%     -    0s
H    0     0                    -134433.5978 -169135.43  25.8%     -    0s
H    0     0                    -140618.3925 -169135.43  20.3%     -    0s
     0     0 -153880.96    0   79 -140618.39 -153880.96  9.43%     -    0s
H    0     0                    -147219.6978 -153428.67  4.22%     -    0s
H    0     0                    -149494.4591 -153428.67  2.63%     -    0s
     0     0 -152423.20    0   67 -149494.46 -152423.20  1.96%     -    0s
     0     0 -152405.19    0   71 -149494.46 -152405.19  1.95%     -    0s
     0     0 -152403.98    0   67 -149494.46 -152403.98  1.95%     -    0s
H    0     0                    -150281.8667 -152403.98  1.41%     -    0s
     0     0 -151780.88    0   83 -150281.87 -151780.88  1.00%     -    0s
     0     0 -151764.16    0   72 -150281.87 -151764.16  0.99%     -    0s
     0     0 -151751.67    0   70 -150281.87 -151751.67  0.98%     -    0s
H    0     0                    -150548.6408 -151751.67  0.80%     -    0s
H    0     0                    -150552.9860 -151298.17  0.49%     -    0s
     0     0 -151298.17    0   47 -150552.99 -151298.17  0.49%     -    0s
H    0     0                    -150664.3844 -151282.59  0.41%     -    0s
     0     0 -151219.51    0   64 -150664.38 -151219.51  0.37%     -    0s
     0     0 -151203.74    0   62 -150664.38 -151203.74  0.36%     -    0s
     0     0 -151202.26    0   62 -150664.38 -151202.26  0.36%     -    0s
     0     0 -150916.57    0   20 -150664.38 -150916.57  0.17%     -    0s
H    0     0                    -150678.5678 -150906.38  0.15%     -    0s
     0     0 -150827.18    0   19 -150678.57 -150827.18  0.10%     -    0s
     0     0 -150825.93    0   15 -150678.57 -150825.93  0.10%     -    0s
     0     0 -150825.75    0   16 -150678.57 -150825.75  0.10%     -    0s
     0     0 -150806.42    0   14 -150678.57 -150806.42  0.08%     -    0s
     0     0 -150806.42    0   35 -150678.57 -150806.42  0.08%     -    0s
     0     0 -150748.51    0   11 -150678.57 -150748.51  0.05%     -    0s
     0     0 -150747.92    0    8 -150678.57 -150747.92  0.05%     -    0s
H    0     0                    -150738.6369 -150746.08  0.00%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 1
  MIR: 17
  Flow cover: 6
  RLT: 7
  Relax-and-lift: 5

Explored 1 nodes (1010 simplex iterations) in 0.14 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -150739 -150679 -150664 ... -131568

Optimal solution found (tolerance 1.00e-04)
Best objective -1.507386368952e+05, best bound -1.507460841123e+05, gap 0.0049%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 188059.30
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -150738.64
  [DEBUG]   S×d_nominal = 338797.94
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 338797.94 + -150738.64 = 188059.30
  [DEBUG]   Current θ from Master = 206946.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18887.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26704.84
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 9306.9252, Absolute Gap = 9306.9252, Relative Gap = 0.204133
  Not converged yet (gap = 9306.93 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221809 nonzeros
Model fingerprint: 0x4aba7490
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 30925 rows and 12565 columns
Presolve time: 1.92s
Presolved: 46908 rows, 20895 columns, 291284 nonzeros
Variable types: 18636 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307441.5572
Found heuristic solution: objective -197760.9489

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46908 rows, 20895 columns, 291284 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24673   -9.6185263e+03   0.000000e+00   8.081348e+06      5s
   40705    5.3846710e+04   0.000000e+00   9.434361e+05     10s
   53271    6.5179151e+04   0.000000e+00   7.417548e+06     15s
   63413    7.1424838e+04   0.000000e+00   1.393357e+09     20s
Concurrent spin time: 0.49s

Solved with dual simplex

Root relaxation: objective 7.657798e+04, 30305 iterations, 18.65 seconds (25.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 76577.9793    0   93 -197760.95 76577.9793   139%     -   21s
H    0     0                    -185717.9315 76577.9793   141%     -   21s
H    0     0                    -175304.1510 76577.9793   144%     -   21s
H    0     0                    -117544.8887 76577.9793   165%     -   21s
H    0     0                    -116995.5677 76577.9793   165%     -   21s
H    0     0                    -116588.7054 76577.9793   166%     -   21s
H    0     0                    -23141.19401 76577.9793   431%     -   21s
H    0     0                    30236.726125 76577.9793   153%     -   21s
H    0     0                    35752.480051 76577.9793   114%     -   21s
H    0     0                    36783.442988 76577.9793   108%     -   21s
H    0     0                    39030.250714 76577.9793  96.2%     -   22s
H    0     0                    40195.854533 76577.9793  90.5%     -   22s
H    0     0                    40245.083470 76577.9793  90.3%     -   22s
     0     0 71115.8889    0  173 40245.0835 71115.8889  76.7%     -   29s
H    0     0                    40299.717227 71115.8889  76.5%     -   29s
     0     0 71063.1879    0  190 40299.7172 71063.1879  76.3%     -   33s
     0     0 71063.1879    0  181 40299.7172 71063.1879  76.3%     -   34s
     0     0 71063.1879    0  183 40299.7172 71063.1879  76.3%     -   35s
     0     0 71063.1879    0  183 40299.7172 71063.1879  76.3%     -   35s
     0     0 68221.1965    0  269 40299.7172 68221.1965  69.3%     -   42s
     0     0 67389.2660    0  275 40299.7172 67389.2660  67.2%     -   46s
     0     0 67200.9145    0  284 40299.7172 67200.9145  66.8%     -   49s
     0     0 67085.6688    0  285 40299.7172 67085.6688  66.5%     -   51s
     0     0 67032.6863    0  297 40299.7172 67032.6863  66.3%     -   52s
     0     0 67020.1748    0  304 40299.7172 67020.1748  66.3%     -   53s
     0     0 67017.5028    0  308 40299.7172 67017.5028  66.3%     -   53s
     0     0 67017.4928    0  308 40299.7172 67017.4928  66.3%     -   53s
     0     0 65513.4820    0  311 40299.7172 65513.4820  62.6%     -   64s
H    0     0                    40356.571426 65513.3680  62.3%     -   64s
     0     0 64919.3661    0  336 40356.5714 64919.3661  60.9%     -   70s
     0     0 64663.0465    0  329 40356.5714 64663.0465  60.2%     -   75s
     0     0 64578.4590    0  341 40356.5714 64578.4590  60.0%     -   78s
     0     0 64527.1110    0  349 40356.5714 64527.1110  59.9%     -   80s
H    0     0                    40394.112472 64456.7629  59.6%     -   83s
     0     0 64456.7629    0  356 40394.1125 64456.7629  59.6%     -   83s
     0     0 64447.2983    0  357 40394.1125 64447.2983  59.5%     -   83s
     0     0 64443.0977    0  359 40394.1125 64443.0977  59.5%     -   85s
     0     0 64441.0720    0  359 40394.1125 64441.0720  59.5%     -   85s
     0     0 64440.6319    0  359 40394.1125 64440.6319  59.5%     -   85s
H    0     0                    40407.198357 64440.6319  59.5%     -   90s
H    0     0                    40417.534967 64440.6319  59.4%     -   90s
H    0     0                    40622.189801 63869.6974  57.2%     -   95s
H    0     0                    40722.771908 63869.6974  56.8%     -   95s
H    0     0                    41169.782700 63869.6974  55.1%     -   95s
H    0     0                    41303.929991 63869.6974  54.6%     -   95s
     0     0 63869.6974    0  376 41303.9300 63869.6974  54.6%     -   95s
     0     0 63718.0989    0  372 41303.9300 63718.0989  54.3%     -   99s
H    0     0                    41508.078044 63596.8263  53.2%     -  103s
     0     0 63596.8263    0  367 41508.0780 63596.8263  53.2%     -  103s
     0     0 63561.5797    0  367 41508.0780 63561.5797  53.1%     -  105s
     0     0 63551.1777    0  368 41508.0780 63551.1777  53.1%     -  106s
     0     0 63542.0228    0  370 41508.0780 63542.0228  53.1%     -  107s
     0     0 63539.2286    0  378 41508.0780 63539.2286  53.1%     -  107s
     0     0 63536.1520    0  372 41508.0780 63536.1520  53.1%     -  108s
     0     0 63533.7391    0  377 41508.0780 63533.7391  53.1%     -  108s
     0     0 63532.5683    0  378 41508.0780 63532.5683  53.1%     -  108s
     0     0 63423.6703    0  386 41508.0780 63423.6703  52.8%     -  112s
     0     0 63406.3543    0  382 41508.0780 63406.3543  52.8%     -  113s
     0     0 63395.2480    0  386 41508.0780 63395.2480  52.7%     -  114s
     0     0 63389.6888    0  389 41508.0780 63389.6888  52.7%     -  115s
     0     0 63387.7081    0  391 41508.0780 63387.7081  52.7%     -  115s
     0     0 63387.1145    0  390 41508.0780 63387.1145  52.7%     -  115s
     0     0 63358.6026    0  387 41508.0780 63358.6026  52.6%     -  117s
H    0     0                    41615.016500 63357.6774  52.2%     -  118s
H    0     0                    41621.800944 63357.6774  52.2%     -  118s
     0     0 63337.0850    0  384 41621.8009 63337.0850  52.2%     -  120s
     0     0 63323.8105    0  387 41621.8009 63323.8105  52.1%     -  121s
     0     0 63319.3899    0  385 41621.8009 63319.3899  52.1%     -  121s
     0     0 63318.8569    0  388 41621.8009 63318.8569  52.1%     -  121s
     0     0 63304.4915    0  386 41621.8009 63304.4915  52.1%     -  123s
     0     0 63298.6473    0  394 41621.8009 63298.6473  52.1%     -  124s
     0     0 63294.2191    0  393 41621.8009 63294.2191  52.1%     -  124s
     0     0 63293.5911    0  395 41621.8009 63293.5911  52.1%     -  125s
     0     0 63280.5170    0  390 41621.8009 63280.5170  52.0%     -  127s
     0     0 63270.8835    0  392 41621.8009 63270.8835  52.0%     -  129s
     0     0 63269.1611    0  386 41621.8009 63269.1611  52.0%     -  129s
     0     0 63268.1183    0  391 41621.8009 63268.1183  52.0%     -  130s
     0     0 63262.1087    0  396 41621.8009 63262.1087  52.0%     -  131s
     0     0 63260.4876    0  403 41621.8009 63260.4876  52.0%     -  131s
     0     0 63260.1516    0  403 41621.8009 63260.1516  52.0%     -  131s
     0     0 63259.3136    0  395 41621.8009 63259.3136  52.0%     -  132s
H    0     0                    41932.297821 63257.9729  50.9%     -  134s
     0     0 63257.9729    0  400 41932.2978 63257.9729  50.9%     -  134s
     0     0 63257.9729    0  397 41932.2978 63257.9729  50.9%     -  135s
     0     0 63257.7037    0  398 41932.2978 63257.7037  50.9%     -  135s
     0     0 63257.7037    0  398 41932.2978 63257.7037  50.9%     -  136s
     0     0 63257.7037    0  398 41932.2978 63257.7037  50.9%     -  137s
H    0     0                    42008.097759 63257.7037  50.6%     -  163s
H    0     0                    42110.718553 63257.7037  50.2%     -  163s
H    0     2                    42184.616174 63257.7037  50.0%     -  170s
     0     2 63257.7037    0  398 42184.6162 63257.7037  50.0%     -  170s
     3     8 63031.6263    2  381 42184.6162 63103.4687  49.6%  3544  181s
     7    16 62717.2059    3  385 42184.6162 63031.4522  49.4%  5134  189s
    15    32 62331.9940    4  379 42184.6162 62715.8072  48.7%  5892  197s
    31    58 61005.7358    5  288 42184.6162 62331.9883  47.8%  7793  213s
H   57    90                    42356.189989 62331.9883  47.2%  7517  225s
H   58    90                    42432.073818 62331.9883  46.9%  7547  225s
H   61    90                    42628.503070 62331.9883  46.2%  7445  225s
    89   154 59715.4974    7  264 42628.5031 62331.9883  46.2%  6260  235s
   153   186 59616.6691    9  268 42628.5031 62331.9883  46.2%  4434  243s
H  156   186                    42739.545106 62331.9883  45.8%  4365  243s
H  168   186                    42823.309990 62331.9883  45.6%  4254  243s
H  170   186                    43180.273355 62331.9883  44.4%  4242  243s
H  176   186                    43206.703927 62331.9883  44.3%  4137  243s
   185   296 59542.3022    8  254 43206.7039 62331.9883  44.3%  4046  253s
   295   383 58674.4863   10  264 43206.7039 62331.9883  44.3%  3381  260s
   382   415 58953.0443    9  311 43206.7039 62331.9883  44.3%  3186  266s
   414   457 58567.0589   12  260 43206.7039 62331.9883  44.3%  3117  276s
H  430   457                    43212.729654 62331.9883  44.2%  3155  276s
   456   489 56527.7610   11  256 43212.7297 62331.9883  44.2%  3122  283s
   488   536 58193.3071   11  281 43212.7297 62331.9883  44.2%  3180  291s
H  512   536                    43216.060372 62331.9883  44.2%  3178  291s
H  534   536                    43222.646618 62331.9883  44.2%  3090  291s
   535   635 58385.7129   13  252 43222.6466 62331.9883  44.2%  3091  301s
   634   730 55887.3711   14  251 43222.6466 62331.9883  44.2%  2880  311s
   729   832 56678.6416   14  302 43222.6466 62331.9883  44.2%  2711  319s
   831   936 55881.1013   13  249 43222.6466 62331.9883  44.2%  2548  327s
   937  1024 56567.0808   15  303 43222.6466 62331.9883  44.2%  2401  335s
  1035  1062 55775.0205   15  239 43222.6466 62331.9883  44.2%  2320  341s
  1085  1115 55240.5808   14  251 43222.6466 62331.9883  44.2%  2301  350s
  1166  1155 56339.1359   16  306 43222.6466 62263.3880  44.1%  2270  361s
  1254  1195 56041.4541   16  288 43222.6466 62263.2247  44.1%  2217  371s
  1320  1244 49555.3775   15  210 43222.6466 62263.2247  44.1%  2241  380s
  1377  1306 54057.5464   15  239 43222.6466 62263.2247  44.1%  2297  391s
  1447  1399 55505.2229   16  239 43222.6466 62263.2247  44.1%  2317  402s
  1544  1438 56190.0425   17  310 43222.6466 62263.2247  44.1%  2268  409s
  1595  1492 55908.1413   18  296 43222.6466 62263.2247  44.1%  2263  418s
  1661  1559 55105.7745   19  292 43222.6466 62263.2247  44.1%  2259  428s
  1757  1632 54327.0131   18  219 43222.6466 62263.2247  44.1%  2231  439s
  1871  1751 54743.9002   20  222 43222.6466 62263.2247  44.1%  2200  448s
  2024  1826 54127.0964   19  223 43222.6466 62263.2247  44.1%  2125  460s
  2167  1944 54710.4465   21  217 43222.6466 62093.8383  43.7%  2094  474s
  2305  2091 51326.1432   22  190 43222.6466 62093.8383  43.7%  2066  488s
  2464  2231 51304.7828   25  175 43222.6466 62024.4561  43.5%  2026  500s
  2638  2431 49949.8986   27  137 43222.6466 62024.4561  43.5%  1984  514s
  2870  2612 44507.1892   26  117 43222.6466 62024.4561  43.5%  1918  525s
  3123  2818 49261.0330   28  137 43222.6466 62024.4561  43.5%  1848  540s
  3405  2915 48284.9809   29  184 43222.6466 60842.2035  40.8%  1785  550s
  3575  2916 58499.5916    9  398 43222.6466 60842.2035  40.8%  1748  587s
  3577  2917 56677.6105   13   93 43222.6466 60842.2035  40.8%  1747  608s
  3578  2918 53503.7490   13  292 43222.6466 60842.2035  40.8%  1747  626s
  3579  2919 44611.8381   33  334 43222.6466 60842.2035  40.8%  1746  638s
  3580  2919 57793.1510   14  385 43222.6466 60842.2035  40.8%  1746  646s
  3581  2920 50496.9334   45  376 43222.6466 60842.2035  40.8%  1745  651s
  3582  2921 47034.5730   34  419 43222.6466 60842.2035  40.8%  1745  655s
  3585  2923 57506.3105   15  397 43222.6466 60842.2035  40.8%  1743  661s
  3586  2923 51678.2101   49  405 43222.6466 60842.2035  40.8%  1743  667s
  3589  2925 59074.2485   15  384 43222.6466 60842.2035  40.8%  1741  672s
  3590  2926 55969.9129   23  379 43222.6466 60842.2035  40.8%  1741  676s
  3592  2927 56525.1171   18  401 43222.6466 60842.2035  40.8%  1740  682s
  3593  2928 47322.5180   48  395 43222.6466 60842.2035  40.8%  1739  685s
H 3593  2781                    43224.626415 60842.2035  40.8%  1739  688s
  3594  2782 45313.7739   31  379 43224.6264 60842.2035  40.8%  1739  690s
  3596  2783 59375.3129   21  461 43224.6264 60842.2035  40.8%  1738  699s
  3597  2784 50135.3308   31  384 43224.6264 60842.2035  40.8%  1738  701s
  3598  2784 51661.8655   50  378 43224.6264 60842.2035  40.8%  1737  705s
H 3599  2645                    43322.144169 60842.2035  40.4%  1737  713s
H 3599  2512                    43354.633248 60842.2035  40.3%  1737  713s
  3601  2513 48801.2181   29  381 43354.6332 60842.2035  40.3%  1736  715s
  3603  2515 57012.8475   20  436 43354.6332 60842.2035  40.3%  1735  740s
  3604  2515 48155.2372   59  436 43354.6332 60842.2035  40.3%  1734  768s
  3605  2519 60842.2035   16  387 43354.6332 60842.2035  40.3%  1773  783s
  3607  2522 60842.2035   17  422 43354.6332 60842.2035  40.3%  1776  798s
  3611  2529 60842.2035   18  417 43354.6332 60842.2035  40.3%  1782  813s
  3619  2542 60842.2035   19  414 43354.6332 60842.2035  40.3%  1798  828s
  3635  2556 59484.7402   20  377 43354.6332 60842.2035  40.3%  1837  856s
  3654  2582 58199.2500   21  395 43354.6332 60842.2035  40.3%  1894  878s
  3686  2694 57852.3607   22  411 43354.6332 60842.2035  40.3%  1958  898s
  3809  2685 57252.2063   26  394 43354.6332 60842.2035  40.3%  2055  908s
  3841  2711 55922.1991   25  280 43354.6332 60842.2035  40.3%  2073  922s
  3878  2733 56409.2767   26  282 43354.6332 60842.2035  40.3%  2098  935s
  3912  2757 55705.8078   24  343 43354.6332 60842.2035  40.3%  2122  945s
  3947  2781 57177.7731   27  389 43354.6332 60842.2035  40.3%  2143  957s
  3986  2801 55351.7145   26  301 43354.6332 60842.2035  40.3%  2157  965s
  4027  2815 53349.1894   27  366 43354.6332 60842.2035  40.3%  2165  978s
  4065  2836 54949.5083   26  280 43354.6332 60842.2035  40.3%  2175  991s
  4104  2853 55734.7878   27  353 43354.6332 60842.2035  40.3%  2187 1002s
  4148  2858 55521.6368   27  263 43354.6332 60842.2035  40.3%  2189 1017s
H 4183  2720                    43609.967178 60842.2035  39.5%  2188 1017s
  4208  2742 55355.8660   28  263 43609.9672 60842.2035  39.5%  2186 1032s
H 4286  2596                    43632.365742 60842.2035  39.4%  2187 1032s
  4322  2603 53708.4245   30  217 43632.3657 60842.2035  39.4%  2183 1047s
  4407  2601 53047.5452   29  231 43632.3657 60842.2035  39.4%  2190 1063s
  4475  2607 50107.1730   31  224 43632.3657 60842.2035  39.4%  2208 1075s
  4540  2606 50384.6682   32  190 43632.3657 60842.2035  39.4%  2234 1083s
H 4569  2483                    43687.910315 60842.2035  39.3%  2244 1083s
  4577  2511 47969.2553   33  159 43687.9103 60842.2035  39.3%  2248 1098s
  4661  2504 50639.8833   32  233 43687.9103 60842.2035  39.3%  2262 1113s
H 4696  2384                    43742.101075 60842.2035  39.1%  2266 1113s
  4703  2408 47139.9888   32  218 43742.1011 60842.2035  39.1%  2269 1127s
H 4752  2289                    43894.667353 60842.2035  38.6%  2278 1127s
  4761  2311 47694.1793   34  166 43894.6674 60842.2035  38.6%  2277 1146s
H 4770  2210                    44038.355892 60842.2035  38.2%  2279 1146s
H 4776  2115                    44116.256984 60842.2035  37.9%  2279 1146s
  4806  2161 47765.2476   35  158 44116.2570 60842.2035  37.9%  2285 1163s
  4897  2179 46437.5747   38  139 44116.2570 60842.2035  37.9%  2301 1179s
  4992  2207     cutoff   42      44116.2570 60450.2966  37.0%  2317 1195s
  5106  2219 56057.7970   23  365 44116.2570 60450.2966  37.0%  2328 1213s
  5222  2256 52944.3132   26  333 44116.2570 59285.3577  34.4%  2337 1231s
  5322  2259 51396.7074   28  293 44116.2570 59141.0167  34.1%  2353 1247s
H 5329  2168                    44192.206851 59141.0167  33.8%  2354 1247s
H 5371  2070                    44221.221822 59141.0167  33.7%  2352 1247s
H 5383  1987                    44235.790256 59141.0167  33.7%  2353 1247s
  5411  2058 50835.3432   30  274 44235.7903 59141.0167  33.7%  2354 1265s
  5533  2070 45636.3074   36  117 44235.7903 59141.0167  33.7%  2365 1286s
  5684  2098 54519.9309   23  265 44235.7903 58870.8333  33.1%  2372 1305s
H 5820  2015                    44462.970029 58364.6201  31.3%  2384 1326s
H 5892  1919                    44524.351463 57707.1873  29.6%  2381 1326s
  5914  1992 51619.2566   25  233 44524.3515 57707.1873  29.6%  2383 1347s
  6059  2025 48413.7912   26  225 44524.3515 57707.1873  29.6%  2398 1366s
  6182  2047 44861.8339   27  222 44524.3515 57707.1873  29.6%  2420 1388s
  6324  2067 46554.2705   29  222 44524.3515 57707.1873  29.6%  2436 1412s
  6514  2048     cutoff   31      44524.3515 57607.6190  29.4%  2440 1436s
  6722  2042 53679.2880   26  318 44524.3515 57607.6190  29.4%  2440 1460s
  6881  2106 50698.3007   28  256 44524.3515 57543.9008  29.2%  2456 1482s
  7039  2114 48130.8637   32  272 44524.3515 57119.2493  28.3%  2473 1508s
  7170  2154 46619.8114   31  146 44524.3515 57119.2493  28.3%  2476 1532s
  7387  2162 44552.6481   36  146 44524.3515 57119.2493  28.3%  2474 1561s
  7632  2182 54438.5042   24  391 44524.3515 57119.2493  28.3%  2474 1589s
  7831  2257 51090.5454   28  280 44524.3515 57119.2493  28.3%  2492 1618s
  8097  2360 47316.1977   35  162 44524.3515 56674.2550  27.3%  2500 1648s
  8343  2425 51179.4339   24  261 44524.3515 56674.2550  27.3%  2512 1678s
  8541  2514 49612.7766   26  228 44524.3515 56568.0805  27.0%  2523 1711s
  8787  2607 48506.6155   28  266 44524.3515 56568.0805  27.0%  2550 1748s
  9100  2733     cutoff   33      44524.3515 56568.0805  27.0%  2554 1784s
  9398  2873 46451.4529   33  236 44524.3515 56234.2355  26.3%  2559 1824s
  9753  2946 47709.8218   29  260 44524.3515 56057.5087  25.9%  2556 1864s
H 9829  2936                    44648.776542 55941.9135  25.3%  2556 1864s
 10034  3060 51900.7906   28  253 44648.7765 55941.9135  25.3%  2556 1901s
 10442  3203 52256.7226   28  330 44648.7765 55722.1864  24.8%  2549 1938s
 10832  3368     cutoff   34      44648.7765 55435.4474  24.2%  2549 1981s
 11136  3530 52738.7160   28  298 44648.7765 55362.7960  24.0%  2570 2022s
 11554  3666 46595.9629   39  146 44648.7765 55362.7960  24.0%  2570 2065s
 12014  3806 47845.4366   31  244 44648.7765 55362.7960  24.0%  2565 2109s
 12447  3924 45543.0672   28  231 44648.7765 54855.3805  22.9%  2571 2152s
 12885  4067 47918.9332   29  163 44648.7765 54855.3805  22.9%  2579 2198s
 13329  4225     cutoff   30      44648.7765 54721.8695  22.6%  2589 2252s
 13837  4384 45767.1951   31  290 44648.7765 54498.9401  22.1%  2590 2303s
H13877  4384                    44654.091968 54498.9401  22.0%  2589 2303s
H14054  4382                    44686.581046 54417.2412  21.8%  2589 2303s
 14256  4536     cutoff   32      44686.5810 54417.2412  21.8%  2586 2367s
 14784  4666     cutoff   30      44686.5810 54340.9382  21.6%  2589 2423s
 15361  4776 48744.8244   28  316 44686.5810 54233.8317  21.4%  2590 2478s
 15939  4926 47469.3847   28  204 44686.5810 54080.6480  21.0%  2594 2541s
 16514  5017     cutoff   33      44686.5810 54014.3752  20.9%  2594 2599s
 16968  5183 48230.6690   31  230 44686.5810 54014.3752  20.9%  2599 2671s
 17651  5338     cutoff   27      44686.5810 53621.6473  20.0%  2595 2739s
 18308  5496     cutoff   45      44686.5810 53485.5997  19.7%  2601 2810s
 19026  5654 47699.6074   29  386 44686.5810 53347.4488  19.4%  2600 2880s
 19757  5816 48831.1749   30  247 44686.5810 53190.6297  19.0%  2597 2956s
 20603  5940 48597.1555   27  388 44686.5810 53034.4217  18.7%  2585 3031s
 21471  6018 46969.1655   34  150 44686.5810 52893.0275  18.4%  2579 3108s
 22287  6185 47417.3843   30  250 44686.5810 52768.3244  18.1%  2581 3196s
 23133  6297 45421.1940   33  102 44686.5810 52566.4893  17.6%  2581 3282s
 24036  6418 49033.9390   28  322 44686.5810 52442.4767  17.4%  2581 3369s
 24986  6614     cutoff   28      44686.5810 52313.7846  17.1%  2576 3464s
 25975  6734     cutoff   30      44686.5810 52149.8837  16.7%  2573 3562s
 26949  6765 46045.2233   33  276 44686.5810 52023.4830  16.4%  2575 3600s

Cutting planes:
  Learned: 1
  MIR: 816
  Mixing: 3
  Flow cover: 1595
  RLT: 25
  Relax-and-lift: 132

Explored 27444 nodes (70586815 simplex iterations) in 3600.03 seconds (7285.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 44686.6 44654.1 44648.8 ... 44038.4

Time limit reached
Best objective 4.468658104600e+04, best bound 5.199451038560e+04, gap 16.3537%
  WARNING: Time limit reached. Using best solution found (gap: 16.35%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 44686.58, θ = 206624.59
  Upper Bound (UB) = 44686.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206624.59
  [DEBUG]   ✓ Scenario 0: θ = 206624.59 ≤ Q = 206624.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206624.59 ≤ Q = 206624.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206624.59 ≤ Q = 206624.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206624.59 ≤ Q = 206624.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206624.59 ≤ Q = 206624.59 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xec03caa
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf13fc356
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.247930e+13
Presolve removed 2543 rows and 1834 columns
Presolve time: 0.01s
Presolved: 550 rows, 555 columns, 1552 nonzeros
Found heuristic solution: objective 6558398.8332
Variable types: 377 continuous, 178 integer (178 binary)

Root relaxation: objective -1.696333e+05, 287 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169633.35    0  135 6558398.83 -169633.35   103%     -    0s
H    0     0                    -129318.4437 -169633.35  31.2%     -    0s
H    0     0                    -130059.3906 -169633.35  30.4%     -    0s
H    0     0                    -134228.2257 -169633.35  26.4%     -    0s
H    0     0                    -141949.1083 -169633.35  19.5%     -    0s
     0     0 -151628.53    0   91 -141949.11 -151628.53  6.82%     -    0s
H    0     0                    -148919.9891 -151538.16  1.76%     -    0s
     0     0 -151278.79    0   73 -148919.99 -151278.79  1.58%     -    0s
H    0     0                    -149908.1694 -151278.79  0.91%     -    0s
     0     0 -150731.08    0   83 -149908.17 -150731.08  0.55%     -    0s
     0     0 -150709.01    0   82 -149908.17 -150709.01  0.53%     -    0s
     0     0 -150708.95    0   82 -149908.17 -150708.95  0.53%     -    0s
H    0     0                    -149912.8785 -150499.84  0.39%     -    0s
     0     0 -150499.84    0   53 -149912.88 -150499.84  0.39%     -    0s
H    0     0                    -149995.5830 -150476.86  0.32%     -    0s
     0     0 -150471.82    0   52 -149995.58 -150471.82  0.32%     -    0s
     0     0 -150470.69    0   49 -149995.58 -150470.69  0.32%     -    0s
     0     0 -150469.57    0   48 -149995.58 -150469.57  0.32%     -    0s
     0     0 -150469.32    0   49 -149995.58 -150469.32  0.32%     -    0s
     0     0 -150188.69    0   13 -149995.58 -150188.69  0.13%     -    0s
H    0     0                    -150016.2628 -150188.23  0.11%     -    0s
H    0     0                    -150018.9211 -150188.23  0.11%     -    0s
     0     0 -150188.23    0   20 -150018.92 -150188.23  0.11%     -    0s
     0     0 -150158.65    0   13 -150018.92 -150158.65  0.09%     -    0s
     0     0 -150158.65    0   38 -150018.92 -150158.65  0.09%     -    0s
     0     0 -150083.07    0   16 -150018.92 -150083.07  0.04%     -    0s
H    0     0                    -150067.8731 -150082.70  0.01%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 22
  Flow cover: 14
  Relax-and-lift: 5

Explored 1 nodes (922 simplex iterations) in 0.14 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -150068 -150019 -150016 ... -129318

Optimal solution found (tolerance 1.00e-04)
Best objective -1.500678730611e+05, best bound -1.500826960635e+05, gap 0.0099%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 188730.07
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -150067.87
  [DEBUG]   S×d_nominal = 338797.94
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 338797.94 + -150067.87 = 188730.07
  [DEBUG]   Current θ from Master = 206624.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17894.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26792.05
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 8400.9838, Absolute Gap = 8400.9838, Relative Gap = 0.187998
  Not converged yet (gap = 8400.98 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265067 nonzeros
Model fingerprint: 0x89a5fee8
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37126 rows and 15086 columns
Presolve time: 1.73s
Presolved: 55997 rows, 24614 columns, 348389 nonzeros
Variable types: 22355 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307441.5572
Found heuristic solution: objective -197760.9489

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 55997 rows, 24614 columns, 348389 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28368   -1.6402506e+04   0.000000e+00   7.304712e+07      5s
   42261    4.7351896e+04   0.000000e+00   5.545121e+07     10s
   54683    5.8726230e+04   0.000000e+00   1.681149e+07     15s
   64216    6.1233396e+04   0.000000e+00   7.256180e+07     20s
   75017    7.0308194e+04   0.000000e+00   3.057646e+07     25s
Concurrent spin time: 1.43s

Solved with dual simplex

Root relaxation: objective 7.656839e+04, 37549 iterations, 26.33 seconds (34.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 76568.3902    0   98 -197760.95 76568.3902   139%     -   28s
H    0     0                    -184370.1279 76568.3902   142%     -   28s
H    0     0                    -169094.5331 76568.3902   145%     -   28s
H    0     0                    -168965.4685 76568.3902   145%     -   28s
H    0     0                    -130886.9980 76568.3902   158%     -   29s
H    0     0                    -130256.4533 76568.3902   159%     -   29s
H    0     0                    -36041.47867 76568.3902   312%     -   29s
H    0     0                    -6128.271689 76568.3902  1349%     -   29s
H    0     0                    -3572.355096 76568.3902  2243%     -   29s
H    0     0                    32386.915401 76568.3902   136%     -   29s
H    0     0                    36777.743686 76568.3902   108%     -   29s
     0     0 71687.3586    0  137 36777.7437 71687.3586  94.9%     -   38s
H    0     0                    36822.380889 71289.1479  93.6%     -   43s
     0     0 71289.1479    0  205 36822.3809 71289.1479  93.6%     -   43s
     0     0 70986.7316    0  194 36822.3809 70986.7316  92.8%     -   46s
     0     0 70978.9302    0  196 36822.3809 70978.9302  92.8%     -   47s
     0     0 70975.7766    0  196 36822.3809 70975.7766  92.8%     -   47s
     0     0 67989.2699    0  278 36822.3809 67989.2699  84.6%     -   58s
H    0     0                    40238.845894 67989.1547  69.0%     -   58s
     0     0 67356.7056    0  288 40238.8459 67356.7056  67.4%     -   67s
     0     0 67101.3592    0  293 40238.8459 67101.3592  66.8%     -   72s
     0     0 66981.0334    0  288 40238.8459 66981.0334  66.5%     -   76s
     0     0 66954.7844    0  293 40238.8459 66954.7844  66.4%     -   77s
     0     0 66943.1498    0  300 40238.8459 66943.1498  66.4%     -   77s
     0     0 66941.2972    0  304 40238.8459 66941.2972  66.4%     -   78s
     0     0 66941.1863    0  306 40238.8459 66941.1863  66.4%     -   78s
H    0     0                    40245.083470 65535.0738  62.8%     -   96s
H    0     0                    40260.742711 65535.0738  62.8%     -   96s
     0     0 65535.0738    0  336 40260.7427 65535.0738  62.8%     -   96s
H    0     0                    40285.627083 65535.0382  62.7%     -   96s
H    0     0                    40304.300615 65535.0382  62.6%     -   96s
H    0     0                    40305.030452 65092.0048  61.5%     -  105s
     0     0 65092.0048    0  365 40305.0305 65092.0048  61.5%     -  105s
     0     0 64928.1516    0  334 40305.0305 64928.1516  61.1%     -  110s
     0     0 64738.7756    0  348 40305.0305 64738.7756  60.6%     -  114s
     0     0 64643.6500    0  344 40305.0305 64643.6500  60.4%     -  117s
     0     0 64569.4227    0  349 40305.0305 64569.4227  60.2%     -  121s
     0     0 64542.9001    0  355 40305.0305 64542.9001  60.1%     -  123s
H    0     0                    40322.999068 64531.9859  60.0%     -  125s
     0     0 64531.9859    0  353 40322.9991 64531.9859  60.0%     -  125s
     0     0 64525.6781    0  351 40322.9991 64525.6781  60.0%     -  126s
     0     0 64516.6299    0  384 40322.9991 64516.6299  60.0%     -  127s
     0     0 64515.3239    0  353 40322.9991 64515.3239  60.0%     -  127s
     0     0 64508.0676    0  357 40322.9991 64508.0676  60.0%     -  128s
     0     0 64507.9822    0  354 40322.9991 64507.9822  60.0%     -  128s
H    0     0                    40391.359442 64507.9822  59.7%     -  135s
     0     0 63783.4083    0  357 40391.3594 63783.4083  57.9%     -  143s
H    0     0                    40402.335704 63783.1023  57.9%     -  144s
     0     0 63669.5502    0  366 40402.3357 63669.5502  57.6%     -  146s
     0     0 63559.8392    0  378 40402.3357 63559.8392  57.3%     -  148s
     0     0 63504.7186    0  380 40402.3357 63504.7186  57.2%     -  150s
     0     0 63474.0771    0  369 40402.3357 63474.0771  57.1%     -  151s
     0     0 63461.5391    0  375 40402.3357 63461.5391  57.1%     -  152s
     0     0 63456.0778    0  372 40402.3357 63456.0778  57.1%     -  152s
     0     0 63452.9632    0  377 40402.3357 63452.9632  57.1%     -  153s
     0     0 63451.3152    0  375 40402.3357 63451.3152  57.0%     -  153s
     0     0 63450.4319    0  376 40402.3357 63450.4319  57.0%     -  153s
     0     0 63311.4953    0  375 40402.3357 63311.4953  56.7%     -  157s
     0     0 63291.1677    0  380 40402.3357 63291.1677  56.7%     -  158s
     0     0 63286.0791    0  378 40402.3357 63286.0791  56.6%     -  159s
     0     0 63280.4535    0  381 40402.3357 63280.4535  56.6%     -  160s
     0     0 63275.7818    0  385 40402.3357 63275.7818  56.6%     -  160s
     0     0 63274.4283    0  376 40402.3357 63274.4283  56.6%     -  161s
     0     0 63251.4903    0  409 40402.3357 63251.4903  56.6%     -  163s
H    0     0                    40437.559908 63247.5048  56.4%     -  166s
     0     0 63246.6463    0  402 40437.5599 63246.6463  56.4%     -  167s
     0     0 63237.6444    0  425 40437.5599 63237.6444  56.4%     -  169s
     0     0 63234.5911    0  430 40437.5599 63234.5911  56.4%     -  169s
     0     0 63233.1960    0  432 40437.5599 63233.1960  56.4%     -  170s
     0     0 63196.5688    0  400 40437.5599 63196.5688  56.3%     -  172s
     0     0 63193.5802    0  394 40437.5599 63193.5802  56.3%     -  173s
     0     0 63189.6677    0  405 40437.5599 63189.6677  56.3%     -  175s
     0     0 63187.3487    0  402 40437.5599 63187.3487  56.3%     -  177s
     0     0 63186.1872    0  392 40437.5599 63186.1872  56.3%     -  177s
     0     0 63180.6269    0  411 40437.5599 63180.6269  56.2%     -  179s
     0     0 63169.7947    0  387 40437.5599 63169.7947  56.2%     -  181s
     0     0 63166.6554    0  391 40437.5599 63166.6554  56.2%     -  181s
     0     0 63166.0615    0  392 40437.5599 63166.0615  56.2%     -  182s
     0     0 63165.3553    0  387 40437.5599 63165.3553  56.2%     -  184s
     0     0 63164.4832    0  387 40437.5599 63164.4832  56.2%     -  185s
H    0     0                    41356.770660 63154.5523  52.7%     -  209s
     0     2 63154.5523    0  387 41356.7707 63154.5523  52.7%     -  239s
     1     4 63058.0067    1  367 41356.7707 63149.2406  52.7%  3332  243s
     3     8 62685.9529    2  379 41356.7707 63051.8496  52.5%  5669  254s
     7    16 62534.6426    3  376 41356.7707 62685.5524  51.6%  7357  270s
    15    32 62440.6123    4  373 41356.7707 62534.6239  51.2%  8951  281s
    31    54 59157.6005    5  359 41356.7707 62440.3095  51.0% 11080  307s
    53    86 58427.4774    6  376 41356.7707 62440.3095  51.0% 13106  323s
H   56    86                    42154.048184 62440.3095  48.1% 12662  323s
    85   205 58212.0762    7  348 42154.0482 62440.3095  48.1% 10300  366s
   204   237 58047.6641    9  335 42154.0482 62440.3095  48.1%  5902  377s
   236   269 58013.8500   10  337 42154.0482 62440.3095  48.1%  5343  388s
   268   301 57194.4231   10  248 42154.0482 62440.3095  48.1%  4987  398s
H  288   301                    42226.238518 62440.3095  47.9%  4812  398s
   300   427 58131.4953    8  352 42226.2385 62440.3095  47.9%  4725  419s
   426   518 57544.7127   11  254 42226.2385 62440.3095  47.9%  4210  436s
   517   600 57954.1017   11  325 42226.2385 62440.3095  47.9%  3965  449s
   599   682 57519.0206   12  248 42226.2385 62440.3095  47.9%  3934  465s
   681   770 56508.3350   13  208 42226.2385 62440.3095  47.9%  3813  478s
   771   853 57753.3708   14  344 42226.2385 62440.3095  47.9%  3656  492s
   858   926 55865.1579   13  269 42226.2385 62440.3095  47.9%  3532  508s
   950   996 55878.7797   15  319 42226.2385 62440.3095  47.9%  3388  521s
  1042  1049 55735.1919   15  335 42226.2385 62440.3095  47.9%  3285  535s
  1132  1133 53266.5865   14  207 42226.2385 62440.3095  47.9%  3176  549s
  1243  1201 55079.1115   14  247 42226.2385 62334.7964  47.6%  3084  564s
  1355  1267 55403.3051   16  314 42226.2385 62334.7964  47.6%  2990  577s
  1479  1325 51556.1069   17  313 42226.2385 61867.3873  46.5%  2897  592s
  1574  1393 54498.4575   18  285 42226.2385 61866.8276  46.5%  2891  608s
  1656  1473 52402.9152   18  252 42226.2385 61866.8276  46.5%  2915  626s
  1756  1567 43586.2256   19  274 42226.2385 61866.8276  46.5%  2890  641s
  1876  1679 51676.9020   19  223 42226.2385 61866.8276  46.5%  2846  655s
  2014  1818 51059.7205   22  260 42226.2385 61190.7598  44.9%  2797  670s
  2159  1976 50514.7217   26  199 42226.2385 61190.7598  44.9%  2745  686s
  2335  2147 50410.4066   27  205 42226.2385 61190.7598  44.9%  2665  703s
  2552  2294 49570.3513   29  192 42226.2385 61188.7046  44.9%  2568  718s
  2755  2437 48313.0990   31  124 42226.2385 61188.7046  44.9%  2505  736s
  2962  2580 47448.3950   45   73 42226.2385 61188.7046  44.9%  2446  756s
  3158  2703 46679.6705   46   71 42226.2385 61182.6776  44.9%  2413  777s
  3323  2859 45360.6729   47  112 42226.2385 61182.6776  44.9%  2414  795s
  3545  2860 50993.0216   23  387 42226.2385 60783.1215  43.9%  2380  905s
  3547  2861 53809.7678   12   98 42226.2385 60783.1215  43.9%  2378  935s
  3548  2862 51488.2806   34  307 42226.2385 60783.1215  43.9%  2378  955s
  3549  2863 55639.3822   12  352 42226.2385 60783.1215  43.9%  2377  968s
  3550  2863 51441.5154   12  361 42226.2385 60783.1215  43.9%  2376  976s
  3551  2864 45292.2919   73  369 42226.2385 60783.1215  43.9%  2376  981s
  3552  2865 50486.1500   16  394 42226.2385 60783.1215  43.9%  2375  987s
  3553  2865 45688.6121   58  373 42226.2385 60783.1215  43.9%  2374  990s
  3556  2867 49302.9485   40  397 42226.2385 60783.1215  43.9%  2372  998s
  3557  2868 55698.7727    9  411 42226.2385 60783.1215  43.9%  2372 1004s
  3558  2869 49640.6729   43  378 42226.2385 60783.1215  43.9%  2371 1006s
  3560  2870 58038.7787   14  420 42226.2385 60783.1215  43.9%  2370 1014s
  3561  2871 43151.7015   50  387 42226.2385 60783.1215  43.9%  2369 1016s
  3563  2872 47758.7197   34  400 42226.2385 60783.1215  43.9%  2368 1022s
  3565  2873 54118.5846   18  387 42226.2385 60783.1215  43.9%  2366 1027s
  3567  2875 44362.6163   54  385 42226.2385 60783.1215  43.9%  2365 1036s
  3569  2876 47191.4610   40  389 42226.2385 60783.1215  43.9%  2364 1042s
  3571  2877 52486.0008   15  401 42226.2385 60783.1215  43.9%  2362 1050s
  3574  2879 59237.2261    8  392 42226.2385 60783.1215  43.9%  2360 1084s
  3575  2880 58056.0499   14  392 42226.2385 60783.1215  43.9%  2360 1114s
  3576  2884 60783.1215   10  399 42226.2385 60783.1215  43.9%  2398 1133s
  3578  2887 60783.1215   11  383 42226.2385 60783.1215  43.9%  2400 1152s
  3582  2894 60783.1215   12  382 42226.2385 60783.1215  43.9%  2408 1170s
  3590  2907 60783.1215   13  382 42226.2385 60783.1215  43.9%  2423 1189s
  3606  2923 59361.5735   14  414 42226.2385 60783.1215  43.9%  2475 1232s
  3627  2948 55800.4359   15  306 42226.2385 60783.1215  43.9%  2525 1261s
  3659  2973 54704.9426   16  285 42226.2385 60783.1215  43.9%  2600 1284s
  3695  3002 54617.1094   17  276 42226.2385 60783.1215  43.9%  2630 1309s
  3736  3054 54156.7639   17  269 42226.2385 60783.1215  43.9%  2642 1336s
  3803  3093 53895.7673   18  257 42226.2385 60783.1215  43.9%  2694 1360s
  3879  3132 52137.1241   20  244 42226.2385 60783.1215  43.9%  2778 1381s
  3978  3162 51331.4025   18  258 42226.2385 60783.1215  43.9%  2806 1405s
  4074  3183 49976.9388   22  253 42226.2385 60783.1215  43.9%  2818 1429s
  4173  3198 49539.0922   23  211 42226.2385 60783.1215  43.9%  2810 1450s
  4252  3194 46395.6958   25  239 42226.2385 60783.1215  43.9%  2820 1472s
  4330  3201 46305.4690   25  163 42226.2385 60783.1215  43.9%  2823 1491s
  4398  3201 46884.9347   25  196 42226.2385 60783.1215  43.9%  2834 1504s
  4439  3213 46244.5165   25  164 42226.2385 60783.1215  43.9%  2845 1519s
  4492  3212 45994.6945   27  141 42226.2385 60783.1215  43.9%  2854 1534s
  4534  3222 45911.8195   28  144 42226.2385 60783.1215  43.9%  2861 1550s
  4570  3241 45195.0882   29  132 42226.2385 60783.1215  43.9%  2874 1563s
  4615  3249 45103.2229   30  133 42226.2385 60783.1215  43.9%  2880 1578s
  4671  3265 45272.2267   28  137 42226.2385 59165.7975  40.1%  2884 1596s
  4718  3280 infeasible   33      42226.2385 59165.7975  40.1%  2892 1610s
H 4758  3122                    43013.571052 59165.7975  37.6%  2899 1610s
  4768  3154 50042.7576   18  335 43013.5711 59165.7975  37.6%  2904 1629s
  4861  3171 49473.4300   20  321 43013.5711 59165.7975  37.6%  2918 1653s
  4952  3198 48457.4800   22  273 43013.5711 59165.7975  37.6%  2932 1676s
  5049  3229 46406.2228   24  173 43013.5711 59165.7975  37.6%  2950 1697s
  5163  3228 44298.3696   26  173 43013.5711 59165.7975  37.6%  2960 1721s
  5293  3240 43485.4863   28  106 43013.5711 59165.7975  37.6%  2962 1744s
  5427  3256 54538.2540   19  359 43013.5711 59165.7975  37.6%  2963 1767s
  5543  3291 52503.1812   21  292 43013.5711 59165.7975  37.6%  2976 1794s
  5664  3334 47622.7380   25  212 43013.5711 59165.7975  37.6%  2985 1827s
  5809  3349 45502.0442   27  272 43013.5711 59165.7975  37.6%  2984 1853s
  5961  3329 43363.6911   29  234 43013.5711 59165.7975  37.6%  2982 1883s
  6146  3293 48993.2165   23  333 43013.5711 57268.1265  33.1%  2980 1906s
H 6147  3156                    43540.526648 57268.1265  31.5%  2980 1906s
H 6177  3015                    43623.244641 57268.1265  31.3%  2990 1906s
  6232  3072 48547.8671   24  323 43623.2446 57268.1265  31.3%  2991 1932s
  6393  3084 46490.8192   27  276 43623.2446 57268.1265  31.3%  2997 1965s
  6579  3081     cutoff   22      43623.2446 56592.3306  29.7%  2994 1996s
  6761  3103 51045.4481   19  286 43623.2446 56592.3306  29.7%  2996 2028s
  6913  3151 48776.2993   22  268 43623.2446 56427.4666  29.4%  3014 2060s
  7131  3122 44942.0898   30  100 43623.2446 56427.4666  29.4%  3012 2094s
  7376  3087     cutoff   48      43623.2446 55992.4047  28.4%  3004 2127s
H 7377  2960                    43700.350619 55992.4047  28.1%  3004 2127s
H 7378  2839                    43757.709090 55992.4047  28.0%  3004 2127s
  7494  2899 52710.6766   20  261 43757.7091 55809.8171  27.5%  3015 2162s
  7712  2928 50695.9956   22  234 43757.7091 55798.4468  27.5%  3026 2201s
  7934  2918 47548.6757   24  210 43757.7091 55798.4468  27.5%  3039 2241s
  8189  2925 50670.8297   18  303 43757.7091 55636.5946  27.1%  3044 2283s
  8449  2937 44521.8053   27  185 43757.7091 55636.5946  27.1%  3051 2323s
  8734  2874     cutoff   23      43757.7091 55291.5505  26.4%  3044 2362s
H 8751  2754                    43790.329289 55291.5505  26.3%  3044 2362s
  8872  2857     cutoff   23      43790.3293 54911.9928  25.4%  3042 2408s
  9110  2867 47733.5265   21  281 43790.3293 54854.2483  25.3%  3068 2455s
  9437  2896     cutoff   26      43790.3293 54842.5909  25.2%  3062 2508s
  9780  2883 49581.2983   24  313 43790.3293 54719.2745  25.0%  3061 2562s
 10102  2923 45243.5117   31  273 43790.3293 54456.9184  24.4%  3069 2613s
 10467  3030 48402.7659   20  280 43790.3293 54336.0570  24.1%  3071 2665s
 10855  3178 45414.6482   23  302 43790.3293 54232.7215  23.8%  3066 2723s
 11244  3342 50793.5286   22  284 43790.3293 54199.2441  23.8%  3069 2780s
 11638  3529 46938.5642   31  260 43790.3293 54199.2441  23.8%  3071 2847s
 12053  3677 49756.2354   24  301 43790.3293 54031.4407  23.4%  3073 2913s
 12487  3826 44817.9995   42  130 43790.3293 53418.4161  22.0%  3076 2976s
 12963  3955     cutoff   22      43790.3293 53245.4029  21.6%  3070 3044s
 13388  4063 44044.5483   27  262 43790.3293 53170.8848  21.4%  3073 3117s
 13872  4195 48405.8117   23  243 43790.3293 53004.9983  21.0%  3078 3191s
 14385  4290 50061.9607   20  198 43790.3293 52867.7251  20.7%  3077 3263s
 14756  4420 infeasible   36      43790.3293 52777.1275  20.5%  3077 3339s
 15246  4550 infeasible   26      43790.3293 52623.6971  20.2%  3080 3420s
 15811  4635 44726.4188   32  221 43790.3293 52604.2780  20.1%  3079 3501s
 16394  4762 43969.1214   34  142 43790.3293 52222.7895  19.3%  3082 3586s
 17090  4771 47011.6455   23  195 43790.3293 52148.8971  19.1%  3073 3600s

Cutting planes:
  Learned: 1
  MIR: 660
  Mixing: 4
  Flow cover: 1617
  RLT: 28
  Relax-and-lift: 131

Explored 17187 nodes (52912998 simplex iterations) in 3600.04 seconds (6855.34 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 43790.3 43757.7 43700.4 ... 40437.6

Time limit reached
Best objective 4.379032928859e+04, best bound 5.214889709138e+04, gap 19.0877%
  WARNING: Time limit reached. Using best solution found (gap: 19.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 43790.33, θ = 205587.49
  Upper Bound (UB) = 43790.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205587.49
  [DEBUG]   ✓ Scenario 0: θ = 205587.49 ≤ Q = 205587.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205587.49 ≤ Q = 205587.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205587.49 ≤ Q = 205587.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205587.49 ≤ Q = 205587.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205587.49 ≤ Q = 205587.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205587.49 ≤ Q = 205587.49 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3ffc55ef
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc003aa11
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.238552e+13
Presolve removed 2543 rows and 1834 columns
Presolve time: 0.01s
Presolved: 550 rows, 555 columns, 1552 nonzeros
Found heuristic solution: objective 6521488.5485
Variable types: 377 continuous, 178 integer (178 binary)

Root relaxation: objective -1.697213e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169721.34    0  136 6521488.55 -169721.34   103%     -    0s
H    0     0                    -131199.2666 -169721.34  29.4%     -    0s
H    0     0                    -131812.0057 -169721.34  28.8%     -    0s
H    0     0                    -139410.8344 -169721.34  21.7%     -    0s
H    0     0                    -140970.0283 -148536.19  5.37%     -    0s
     0     0 -148536.19    0   71 -140970.03 -148536.19  5.37%     -    0s
H    0     0                    -147462.3832 -148409.98  0.64%     -    0s
H    0     0                    -147486.9606 -147972.19  0.33%     -    0s
     0     0 -147972.19    0   61 -147486.96 -147972.19  0.33%     -    0s
     0     0 -147968.80    0   61 -147486.96 -147968.80  0.33%     -    0s
     0     0 -147959.66    0   58 -147486.96 -147959.66  0.32%     -    0s
     0     0 -147955.61    0   58 -147486.96 -147955.61  0.32%     -    0s
     0     0 -147950.32    0   55 -147486.96 -147950.32  0.31%     -    0s
     0     0 -147596.09    0   57 -147486.96 -147596.09  0.07%     -    0s
     0     0 -147567.81    0   16 -147486.96 -147567.81  0.05%     -    0s
     0     0 -147564.72    0   11 -147486.96 -147564.72  0.05%     -    0s
     0     0 -147564.62    0    7 -147486.96 -147564.62  0.05%     -    0s
     0     0          -    0      -147486.96 -147499.62  0.01%     -    0s

Cutting planes:
  Gomory: 31
  Implied bound: 5
  MIR: 100
  Flow cover: 6
  RLT: 68
  Relax-and-lift: 2
  BQP: 1

Explored 1 nodes (660 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -147487 -147462 -140970 ... 1.23855e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.474869606187e+05, best bound -1.474996211053e+05, gap 0.0086%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 191019.87
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147486.96
  [DEBUG]   S×d_nominal = 338506.83
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 338506.83 + -147486.96 = 191019.87
  [DEBUG]   Current θ from Master = 205587.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14567.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 29222.71
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 7504.7320, Absolute Gap = 7504.7320, Relative Gap = 0.171379
  Not converged yet (gap = 7504.73 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308325 nonzeros
Model fingerprint: 0x9eeabae0
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43347 rows and 17617 columns
Presolve time: 2.23s
Presolved: 65066 rows, 28323 columns, 405434 nonzeros
Variable types: 26064 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307441.5572
Found heuristic solution: objective -197760.9489

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 65066 rows, 28323 columns, 405434 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22471   -1.0834862e+05   0.000000e+00   1.945245e+07      5s
   33696    1.9647640e+04   0.000000e+00   1.885949e+07     10s
   44104    3.4100778e+04   0.000000e+00   4.379738e+06     15s
   50650    4.3297313e+04   0.000000e+00   8.953087e+07     20s
   59226    5.4946335e+04   0.000000e+00   3.490186e+06     25s
Concurrent spin time: 0.09s

Solved with dual simplex

Root relaxation: objective 7.616839e+04, 39511 iterations, 27.06 seconds (38.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 76168.3896    0   95 -197760.95 76168.3896   139%     -   30s
H    0     0                    -192510.4855 76168.3896   140%     -   30s
H    0     0                    -169017.4565 76168.3896   145%     -   30s
H    0     0                    -152021.3569 76168.3896   150%     -   30s
H    0     0                    -146660.2324 76168.3896   152%     -   30s
H    0     0                    -37879.43466 76168.3896   301%     -   30s
H    0     0                    36777.743686 76168.3896   107%     -   30s
H    0     0                    36783.442988 76168.3896   107%     -   30s
H    0     0                    36821.812273 76168.3896   107%     -   31s
     0     0 70624.6324    0  134 36821.8123 70624.6324  91.8%     -   48s
H    0     0                    36836.385802 70624.6324  91.7%     -   49s
H    0     0                    36882.385374 70624.6324  91.5%     -   49s
     0     0 70505.0442    0  197 36882.3854 70505.0442  91.2%     -   56s
     0     0 70505.0442    0  208 36882.3854 70505.0442  91.2%     -   58s
     0     0 70505.0442    0  210 36882.3854 70505.0442  91.2%     -   59s
     0     0 70505.0442    0  211 36882.3854 70505.0442  91.2%     -   60s
     0     0 67725.2086    0  212 36882.3854 67725.2086  83.6%     -   61s
     0     0 67724.2172    0  261 36882.3854 67724.2172  83.6%     -   76s
     0     0 66939.3209    0  284 36882.3854 66939.3209  81.5%     -   85s
     0     0 66752.9177    0  302 36882.3854 66752.9177  81.0%     -   88s
     0     0 66716.2706    0  302 36882.3854 66716.2706  80.9%     -   89s
     0     0 66683.1776    0  304 36882.3854 66683.1776  80.8%     -   91s
     0     0 66670.4205    0  306 36882.3854 66670.4205  80.8%     -   92s
     0     0 66665.2426    0  302 36882.3854 66665.2426  80.8%     -   92s
     0     0 66663.4980    0  303 36882.3854 66663.4980  80.7%     -   92s
     0     0 66662.4099    0  302 36882.3854 66662.4099  80.7%     -   93s
     0     0 66611.1443    0  299 36882.3854 66611.1443  80.6%     -   94s
     0     0 66595.4992    0  305 36882.3854 66595.4992  80.6%     -   95s
     0     0 66590.0183    0  312 36882.3854 66590.0183  80.5%     -   96s
     0     0 66589.9148    0  312 36882.3854 66589.9148  80.5%     -   96s
     0     0 65050.2817    0  327 36882.3854 65050.2817  76.4%     -  117s
H    0     0                    36902.138205 65049.7249  76.3%     -  117s
     0     0 64626.6677    0  328 36902.1382 64626.6677  75.1%     -  126s
     0     0 64503.2563    0  333 36902.1382 64503.2563  74.8%     -  132s
     0     0 64381.7473    0  336 36902.1382 64381.7473  74.5%     -  139s
     0     0 64287.7486    0  330 36902.1382 64287.7486  74.2%     -  142s
     0     0 64208.3609    0  337 36902.1382 64208.3609  74.0%     -  145s
     0     0 64167.3520    0  335 36902.1382 64167.3520  73.9%     -  147s
     0     0 64139.3197    0  341 36902.1382 64139.3197  73.8%     -  148s
     0     0 64106.6287    0  340 36902.1382 64106.6287  73.7%     -  149s
     0     0 64092.4807    0  348 36902.1382 64092.4807  73.7%     -  150s
     0     0 64087.6819    0  349 36902.1382 64087.6819  73.7%     -  151s
     0     0 64085.9674    0  351 36902.1382 64085.9674  73.7%     -  152s
     0     0 64085.5113    0  352 36902.1382 64085.5113  73.7%     -  152s
     0     0 63417.3819    0  411 36902.1382 63417.3819  71.9%     -  168s
     0     0 63213.6276    0  373 36902.1382 63213.6276  71.3%     -  177s
     0     0 63065.1461    0  407 36902.1382 63065.1461  70.9%     -  181s
     0     0 63001.2229    0  415 36902.1382 63001.2229  70.7%     -  185s
     0     0 62992.0379    0  415 36902.1382 62992.0379  70.7%     -  186s
     0     0 62987.8069    0  414 36902.1382 62987.8069  70.7%     -  187s
     0     0 62984.7030    0  416 36902.1382 62984.7030  70.7%     -  189s
     0     0 62982.1014    0  414 36902.1382 62982.1014  70.7%     -  190s
H    0     0                    36914.465983 62957.5654  70.5%     -  191s
     0     0 62957.5654    0  418 36914.4660 62957.5654  70.5%     -  191s
     0     0 62948.1806    0  411 36914.4660 62948.1806  70.5%     -  192s
     0     0 62944.6852    0  415 36914.4660 62944.6852  70.5%     -  193s
     0     0 62943.1135    0  415 36914.4660 62943.1135  70.5%     -  193s
     0     0 62942.7271    0  419 36914.4660 62942.7271  70.5%     -  193s
     0     0 62845.3930    0  371 36914.4660 62845.3930  70.2%     -  199s
     0     0 62798.9178    0  412 36914.4660 62798.9178  70.1%     -  203s
     0     0 62785.3408    0  376 36914.4660 62785.3408  70.1%     -  205s
     0     0 62783.9647    0  416 36914.4660 62783.9647  70.1%     -  206s
     0     0 62755.3714    0  374 36914.4660 62755.3714  70.0%     -  209s
H    0     0                    36943.320857 62753.3438  69.9%     -  214s
H    0     0                    38160.400892 62753.3438  64.4%     -  217s
H    0     0                    38301.762522 62753.3438  63.8%     -  217s
     0     0 62744.1279    0  378 38301.7625 62744.1279  63.8%     -  220s
     0     0 62741.1935    0  390 38301.7625 62741.1935  63.8%     -  221s
     0     0 62739.8747    0  388 38301.7625 62739.8747  63.8%     -  221s
     0     0 62722.2804    0  393 38301.7625 62722.2804  63.8%     -  224s
H    0     0                    38442.759028 62722.1485  63.2%     -  225s
     0     0 62716.2377    0  398 38442.7590 62716.2377  63.1%     -  226s
     0     0 62714.5516    0  391 38442.7590 62714.5516  63.1%     -  227s
     0     0 62713.4064    0  397 38442.7590 62713.4064  63.1%     -  227s
     0     0 62703.5877    0  387 38442.7590 62703.5877  63.1%     -  229s
     0     0 62701.1271    0  396 38442.7590 62701.1271  63.1%     -  229s
     0     0 62700.2881    0  376 38442.7590 62700.2881  63.1%     -  230s
     0     0 62695.9608    0  394 38442.7590 62695.9608  63.1%     -  231s
     0     0 62694.8581    0  399 38442.7590 62694.8581  63.1%     -  232s
     0     0 62691.0028    0  401 38442.7590 62691.0028  63.1%     -  234s
     0     0 62689.3310    0  401 38442.7590 62689.3310  63.1%     -  235s
     0     0 62687.7165    0  402 38442.7590 62687.7165  63.1%     -  235s
     0     0 62687.6063    0  402 38442.7590 62687.6063  63.1%     -  235s
     0     0 62685.8420    0  397 38442.7590 62685.8420  63.1%     -  237s
     0     0 62685.6938    0  397 38442.7590 62685.6938  63.1%     -  238s
H    0     0                    38593.364906 62685.6938  62.4%     -  265s
H    0     0                    38607.207427 62685.6938  62.4%     -  265s
H    0     0                    38667.924811 62685.6938  62.1%     -  265s
H    0     0                    38838.294824 62685.6938  61.4%     -  290s
     0     2 62685.6938    0  397 38838.2948 62685.6938  61.4%     -  291s
     1     4 62490.2030    1  413 38838.2948 62684.1756  61.4%  4085  298s
     3     8 62085.4369    2  402 38838.2948 62451.6152  60.8%  5932  306s
     7    16 61892.5341    3  379 38838.2948 62084.3463  59.9%  6090  318s
    15    32 61581.7201    4  390 38838.2948 61858.4589  59.3%  7464  332s
    31    48 60539.2355    5  384 38838.2948 61581.3628  58.6% 10377  363s
    47    80 58966.2871    6  375 38838.2948 61581.3628  58.6%  9905  388s
    79   113 58921.5781    7  360 38838.2948 61581.3628  58.6%  7959  413s
   112   149 58796.6419    8  353 38838.2948 61581.3628  58.6%  6731  429s
   148   190 58783.8204    8  356 38838.2948 61581.3628  58.6%  5509  451s
   189   243 58630.8704    9  348 38838.2948 61581.3628  58.6%  5264  478s
   242   296 58602.8883    9  352 38838.2948 61581.3628  58.6%  4876  494s
   295   412 57917.5528    9  348 38838.2948 61581.3628  58.6%  4342  511s
H  310   412                    38891.537337 61581.3628  58.3%  4197  511s
   411   540 58557.1211    9  353 38891.5373 61581.3628  58.3%  3642  527s
   539   653 58261.5984   10  336 38891.5373 61581.3628  58.3%  3152  540s
   652   685 58374.9125   10  343 38891.5373 61581.3628  58.3%  2856  546s
   684   720 57297.5995   10  359 38891.5373 61581.3628  58.3%  2800  556s
   719   754 57956.3386   11  362 38891.5373 61581.3628  58.3%  2767  567s
   753   787 57398.9333   11  374 38891.5373 61581.3628  58.3%  2719  577s
   786   819 58048.9327   11  332 38891.5373 61581.3628  58.3%  2693  586s
   822   857 57602.7269   11  323 38891.5373 61581.3628  58.3%  2648  597s
   862   895 56824.1926   11  313 38891.5373 61581.3628  58.3%  2607  607s
   900   935 57772.4543   12  355 38891.5373 61581.3628  58.3%  2536  619s
   940   972 57558.1532   13  326 38891.5373 61581.3628  58.3%  2468  638s
   977  1012 56339.1886   12  303 38891.5373 61581.3628  58.3%  2412  647s
H  990  1012                    38934.422971 61581.3628  58.2%  2391  647s
  1019  1164 57241.5851   12  340 38934.4230 61581.3628  58.2%  2351  662s
  1181  1281 57405.6863   15  320 38934.4230 61581.3628  58.2%  2163  676s
  1342  1399 57115.5508   16  319 38934.4230 61581.3628  58.2%  2022  692s
  1538  1468 57029.3742   15  295 38934.4230 61581.3628  58.2%  1886  707s
  1673  1531 56864.6696   17  310 38934.4230 61581.3628  58.2%  1881  729s
  1779  1612 53579.7885   16  213 38934.4230 60995.5665  56.7%  1880  745s
  1882  1694 56461.2490   18  307 38934.4230 60994.3708  56.7%  1907  763s
  1988  1799 55921.8544   19  242 38934.4230 60994.3708  56.7%  1943  780s
  2111  1831 53941.9813   20  275 38934.4230 60994.3708  56.7%  1939  790s
  2143  1861 52262.7545   19  284 38934.4230 60994.3708  56.7%  1949  800s
  2195  1888 54325.4109   21  214 38934.4230 60670.2503  55.8%  1944  815s
  2239  1954 52647.3153   22  242 38934.4230 60670.2503  55.8%  1968  830s
  2305  2033 52910.6419   22  197 38934.4230 60670.2503  55.8%  1961  849s
  2422  2176 52131.9932   23  198 38934.4230 60670.2503  55.8%  1923  867s
  2603  2285 52033.8467   24  186 38934.4230 60670.2503  55.8%  1860  886s
  2806  2406 52647.4519   23  190 38934.4230 60670.2503  55.8%  1813  904s
  3006  2509 50584.7605   24  207 38934.4230 60670.2503  55.8%  1784  925s
  3151  2707 50471.0963   24  172 38934.4230 60319.8459  54.9%  1768  946s
  3379  2938 48746.8432   26  160 38934.4230 60319.8459  54.9%  1729  966s
  3653  2939 48677.0334   23  397 38934.4230 60119.2586  54.4%  1689 1052s
  3655  2940 41345.4100   45   95 38934.4230 60119.2586  54.4%  1688 1092s
  3656  2941 52493.5392   27  312 38934.4230 60119.2586  54.4%  1687 1123s
  3657  2942 41957.2087   39  341 38934.4230 60119.2586  54.4%  1687 1140s
  3658  2942 50010.4075   29  359 38934.4230 60119.2586  54.4%  1687 1155s
  3659  2943 57290.9214   11  413 38934.4230 60119.2586  54.4%  1686 1167s
  3660  2944 47710.5390   53  425 38934.4230 60119.2586  54.4%  1686 1173s
  3661  2944 57579.2992   15  431 38934.4230 60119.2586  54.4%  1685 1179s
  3662  2945 43857.9493   46  426 38934.4230 60119.2586  54.4%  1685 1185s
  3663  2946 47327.1269   48  397 38934.4230 60119.2586  54.4%  1684 1191s
  3665  2947 49734.9537   88  406 38934.4230 60119.2586  54.4%  1683 1197s
  3667  2948 56189.4062    8  381 38934.4230 60119.2586  54.4%  1682 1204s
  3668  2949 42434.4007   49  397 38934.4230 60119.2586  54.4%  1682 1207s
  3669  2950 57341.1457   15  401 38934.4230 60119.2586  54.4%  1681 1212s
  3670  2950 52449.1042   11  404 38934.4230 60119.2586  54.4%  1681 1215s
  3671  2951 45224.8954   30  399 38934.4230 60119.2586  54.4%  1681 1220s
  3674  2953 44079.4813   36  404 38934.4230 60119.2586  54.4%  1679 1228s
  3675  2954 44281.8590   38  443 38934.4230 60119.2586  54.4%  1679 1230s
  3677  2955 55221.5870   27  435 38934.4230 60119.2586  54.4%  1678 1242s
  3679  2956 40454.6848   70  432 38934.4230 60119.2586  54.4%  1677 1248s
  3680  2957 41890.0512   52  433 38934.4230 60119.2586  54.4%  1676 1250s
  3681  2958 57235.0307   10  426 38934.4230 60119.2586  54.4%  1676 1256s
  3683  2959 52476.6400   22  429 38934.4230 60119.2586  54.4%  1675 1261s
  3684  2960 56444.9520   12  429 38934.4230 60119.2586  54.4%  1675 1298s
  3685  2960 43033.5315   68  429 38934.4230 60119.2586  54.4%  1674 1356s
  3686  2964 60119.2586   15  374 38934.4230 60119.2586  54.4%  1717 1383s
  3688  2967 60119.2586   16  397 38934.4230 60119.2586  54.4%  1720 1408s
  3692  2974 60119.2586   17  383 38934.4230 60119.2586  54.4%  1727 1433s
  3700  2987 60119.2586   18  368 38934.4230 60119.2586  54.4%  1749 1474s
  3716  2998 58591.7825   19  377 38934.4230 60119.2586  54.4%  1804 1530s
  3732  3025 57301.6521   20  367 38934.4230 60119.2586  54.4%  1848 1584s
  3764  3047 56308.0277   21  348 38934.4230 60119.2586  54.4%  1903 1621s
  3797  3127 56200.8844   22  349 38934.4230 60119.2586  54.4%  2001 1658s
  3888  3202 55438.0408   22  342 38934.4230 60119.2586  54.4%  2040 1692s
  3993  3216 55536.4462   24  311 38934.4230 60119.2586  54.4%  2099 1712s
H 4020  3058                    39392.683095 60119.2586  52.6%  2111 1712s
H 4032  2913                    39796.201457 60119.2586  51.1%  2125 1712s
  4042  2998 54754.3318   23  382 39796.2015 60119.2586  51.1%  2132 1735s
  4141  3047 51719.1065   23  329 39796.2015 60119.2586  51.1%  2161 1755s
  4259  3062 52561.0416   26  261 39796.2015 60119.2586  51.1%  2156 1772s
  4372  3034 52299.9747   27  262 39796.2015 60119.2586  51.1%  2154 1793s
H 4389  2895                    40078.426961 60119.2586  50.0%  2156 1793s
H 4407  2761                    40321.693662 60119.2586  49.1%  2159 1793s
  4416  2752 51734.3336   28  236 40321.6937 60119.2586  49.1%  2160 1815s
  4504  2739 50168.7631   29  246 40321.6937 60119.2586  49.1%  2163 1836s
  4542  2756 48808.4495   27  238 40321.6937 60119.2586  49.1%  2185 1853s
  4577  2783 48912.0786   28  262 40321.6937 60119.2586  49.1%  2219 1869s
  4627  2783 44361.5651   30  156 40321.6937 60119.2586  49.1%  2235 1892s
  4688  2786 43903.4384   30  201 40321.6937 60119.2586  49.1%  2245 1918s
  4746  2800 44953.6429   30  251 40321.6937 60119.2586  49.1%  2261 1940s
  4806  2801 47446.1750   29  263 40321.6937 60119.2586  49.1%  2286 1961s
  4861  2819 46306.3112   29  255 40321.6937 60119.2586  49.1%  2309 1985s
  4933  2816 46015.5177   30  223 40321.6937 60119.2586  49.1%  2330 2012s
  5006  2825 43261.2560   30  219 40321.6937 59771.0726  48.2%  2357 2038s
  5091  2829 43165.4229   31  164 40321.6937 59771.0726  48.2%  2376 2063s
  5187  2843 42956.7771   32  145 40321.6937 59771.0726  48.2%  2386 2092s
  5309  2858 55339.7606   27  307 40321.6937 59771.0726  48.2%  2396 2123s
  5396  2889 53310.8084   29  260 40321.6937 58394.1107  44.8%  2423 2154s
  5488  2913 50113.8158   31  205 40321.6937 58394.1107  44.8%  2453 2185s
  5597  2908 43055.9194   33  198 40321.6937 58394.1107  44.8%  2472 2213s
H 5606  2784                    40443.261610 58394.1107  44.4%  2476 2213s
  5660  2836     cutoff   37      40443.2616 58365.2508  44.3%  2485 2246s
  5775  2859 55634.4968   25  298 40443.2616 58365.2508  44.3%  2511 2280s
  5901  2892 53629.1395   28  238 40443.2616 58348.7805  44.3%  2539 2316s
  6000  2938 51242.4362   31  259 40443.2616 58348.7805  44.3%  2568 2351s
  6124  2973 43969.5757   35  206 40443.2616 58348.7805  44.3%  2596 2386s
  6258  3022 42126.9548   37  217 40443.2616 58123.9206  43.7%  2619 2424s
  6424  3037 54890.3885   23  295 40443.2616 58123.9206  43.7%  2635 2466s
  6600  3032 47547.8966   26  268 40443.2616 57596.3457  42.4%  2654 2514s
  6770  3003 44322.0195   29  285 40443.2616 57596.3457  42.4%  2676 2543s
  6828  3003 43088.7967   30  273 40443.2616 57596.3457  42.4%  2680 2570s
  6866  3000 42849.1831   31  268 40443.2616 57596.3457  42.4%  2687 2606s
  6915  3012     cutoff   32      40443.2616 57596.3457  42.4%  2696 2647s
  6980  3034 40757.7262   33  254 40443.2616 56848.9480  40.6%  2714 2688s
  7083  3072 40707.0429   34  252 40443.2616 56782.2563  40.4%  2725 2733s
  7216  3152 49471.9499   23  244 40443.2616 56649.1930  40.1%  2756 2781s
  7413  3187 44622.2503   26  210 40443.2616 56461.0156  39.6%  2774 2834s
  7614  3218     cutoff   31      40443.2616 56408.8615  39.5%  2795 2888s
  7836  3246 50333.7718   24  258 40443.2616 56309.0740  39.2%  2824 2946s
  8048  3261 41285.0463   36  195 40443.2616 56160.7248  38.9%  2855 3006s
  8265  3266 49458.5365   27  334 40443.2616 56109.0075  38.7%  2891 3068s
  8501  3287 46426.9723   31  271 40443.2616 55980.7266  38.4%  2921 3126s
  8738  3332     cutoff   37      40443.2616 55980.7266  38.4%  2959 3190s
  8996  3386     cutoff   29      40443.2616 55980.7266  38.4%  2989 3253s
  9313  3365 49996.1321   30  375 40443.2616 55582.8529  37.4%  3007 3318s
  9659  3356     cutoff   37      40443.2616 55533.7538  37.3%  3022 3383s
  9874  3401 48449.2429   25  353 40443.2616 55231.1087  36.6%  3046 3466s
 10167  3419 41979.0885   33  292 40443.2616 55231.1087  36.6%  3078 3542s
 10483  3427 46396.8145   28  175 40443.2616 55058.4434  36.1%  3109 3600s

Cutting planes:
  MIR: 792
  Mixing: 2
  Flow cover: 1812
  RLT: 28
  Relax-and-lift: 181

Explored 10750 nodes (33852900 simplex iterations) in 3600.06 seconds (6463.55 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 40443.3 40321.7 40078.4 ... 38607.2

Time limit reached
Best objective 4.044326160984e+04, best bound 5.494080299441e+04, gap 35.8466%
  WARNING: Time limit reached. Using best solution found (gap: 35.85%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 40443.26, θ = 208588.91
  Upper Bound (UB) = 40443.26

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 208588.91
  [DEBUG]   ✓ Scenario 0: θ = 208588.91 ≤ Q = 208588.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 208588.91 ≤ Q = 208588.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 208588.91 ≤ Q = 208588.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 208588.91 ≤ Q = 208588.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 208588.91 ≤ Q = 208588.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 208588.91 ≤ Q = 208588.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 208588.91 ≤ Q = 208588.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x524e0d9b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x524e0d9b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.238699e+13
Presolve removed 2543 rows and 1833 columns
Presolve time: 0.01s
Presolved: 550 rows, 556 columns, 1552 nonzeros
Found heuristic solution: objective 6572114.5433
Variable types: 378 continuous, 178 integer (178 binary)

Root relaxation: objective -1.673397e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167339.74    0  124 6572114.54 -167339.74   103%     -    0s
H    0     0                    -129232.2883 -167339.74  29.5%     -    0s
H    0     0                    -129824.8762 -167339.74  28.9%     -    0s
H    0     0                    -134636.6542 -167339.74  24.3%     -    0s
H    0     0                    -135733.1655 -167339.74  23.3%     -    0s
     0     0 -148421.86    0  104 -135733.17 -148421.86  9.35%     -    0s
H    0     0                    -144421.9807 -148398.99  2.75%     -    0s
H    0     0                    -145684.0952 -148398.99  1.86%     -    0s
     0     0 -146981.63    0  110 -145684.10 -146981.63  0.89%     -    0s
     0     0 -146926.75    0  110 -145684.10 -146926.75  0.85%     -    0s
     0     0 -146917.08    0  110 -145684.10 -146917.08  0.85%     -    0s
     0     0 -146420.91    0   46 -145684.10 -146420.91  0.51%     -    0s
     0     0 -146202.53    0   50 -145684.10 -146202.53  0.36%     -    0s
     0     0 -146191.50    0   62 -145684.10 -146191.50  0.35%     -    0s
     0     0 -145915.02    0   22 -145684.10 -145915.02  0.16%     -    0s
     0     0 -145914.91    0   22 -145684.10 -145914.91  0.16%     -    0s
     0     0 -145907.92    0   24 -145684.10 -145907.92  0.15%     -    0s
     0     0 -145905.49    0   17 -145684.10 -145905.49  0.15%     -    0s
     0     0 -145809.55    0   19 -145684.10 -145809.55  0.09%     -    0s
     0     0 -145809.55    0   21 -145684.10 -145809.55  0.09%     -    0s
     0     0 -145770.13    0    5 -145684.10 -145770.13  0.06%     -    0s
H    0     0                    -145759.9649 -145768.14  0.01%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 7
  Flow cover: 17
  Relax-and-lift: 2

Explored 1 nodes (921 simplex iterations) in 0.13 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145760 -145684 -143438 ... 1.2387e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.457599648801e+05, best bound -1.457681368755e+05, gap 0.0056%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 196036.02
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145759.96
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -145759.96 = 196036.02
  [DEBUG]   Current θ from Master = 208588.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12552.89 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27890.37
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 4157.6643, Absolute Gap = 4157.6643, Relative Gap = 0.102802
  Not converged yet (gap = 4157.66 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351583 nonzeros
Model fingerprint: 0xec11daca
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49528 rows and 20128 columns
Presolve time: 2.25s
Presolved: 74175 rows, 32052 columns, 462599 nonzeros
Variable types: 29793 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307441.5572
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 74175 rows, 32052 columns, 462599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25402   -1.8033714e+05   0.000000e+00   1.487037e+07      5s
   39116   -1.0971762e+04   0.000000e+00   3.535624e+08     10s
   49781    3.1359588e+04   0.000000e+00   2.523369e+07     15s
   58770    4.3139301e+04   0.000000e+00   2.375351e+07     20s
   67024    5.4003495e+04   0.000000e+00   5.367165e+07     25s
   73960    5.8759923e+04   0.000000e+00   7.736170e+06     30s
   80986    6.2228085e+04   0.000000e+00   4.251590e+07     35s
Concurrent spin time: 1.77s

Solved with dual simplex

Root relaxation: objective 7.609861e+04, 49172 iterations, 37.86 seconds (51.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 76098.6100    0   97 -198441.04 76098.6100   138%     -   41s
H    0     0                    -188198.9783 76098.6100   140%     -   41s
H    0     0                    -91042.84418 76098.6100   184%     -   41s
H    0     0                    -72573.34768 76098.6100   205%     -   41s
H    0     0                    -71395.78725 76098.6100   207%     -   41s
H    0     0                    -70039.29884 76098.6100   209%     -   41s
H    0     0                    -70015.95525 76098.6100   209%     -   41s
H    0     0                    -69930.57080 76098.6100   209%     -   41s
H    0     0                    -68867.28334 76098.6100   211%     -   41s
H    0     0                    -68727.74827 76098.6100   211%     -   41s
H    0     0                    -68561.15472 76098.6100   211%     -   41s
H    0     0                    -37879.43466 76098.6100   301%     -   41s
H    0     0                    2937.7588444 76098.6100  2490%     -   42s
H    0     0                    5294.5143241 76098.6100  1337%     -   42s
H    0     0                    26710.340251 76098.6100   185%     -   42s
H    0     0                    34989.352108 76098.6100   117%     -   42s
H    0     0                    36777.743686 76098.6100   107%     -   42s
H    0     0                    36802.628058 71014.3747  93.0%     -   59s
     0     0 71014.3747    0  132 36802.6281 71014.3747  93.0%     -   59s
     0     0 70724.3977    0  146 36802.6281 70724.3977  92.2%     -   65s
     0     0 70628.8401    0  152 36802.6281 70628.8401  91.9%     -   68s
     0     0 70618.1652    0  154 36802.6281 70618.1652  91.9%     -   69s
     0     0 70618.1652    0  152 36802.6281 70618.1652  91.9%     -   70s
     0     0 70618.0940    0  156 36802.6281 70618.0940  91.9%     -   71s
     0     0 70617.8675    0  152 36802.6281 70617.8675  91.9%     -   71s
H    0     0                    36825.229121 68252.0513  85.3%     -   89s
     0     0 68252.0513    0  268 36825.2291 68252.0513  85.3%     -   89s
     0     0 67102.8580    0  292 36825.2291 67102.8580  82.2%     -  106s
     0     0 66931.0668    0  287 36825.2291 66931.0668  81.8%     -  113s
     0     0 66876.8051    0  244 36825.2291 66876.8051  81.6%     -  116s
     0     0 66846.6954    0  241 36825.2291 66846.6954  81.5%     -  118s
     0     0 66840.0222    0  279 36825.2291 66840.0222  81.5%     -  118s
     0     0 66815.0056    0  279 36825.2291 66815.0056  81.4%     -  119s
     0     0 66805.9641    0  247 36825.2291 66805.9641  81.4%     -  120s
     0     0 66801.9499    0  247 36825.2291 66801.9499  81.4%     -  121s
     0     0 66801.2469    0  249 36825.2291 66801.2469  81.4%     -  121s
H    0     0                    36846.696645 66801.2469  81.3%     -  130s
H    0     0                    36884.418091 66801.2469  81.1%     -  130s
     0     0 65207.2280    0  321 36884.4181 65207.2280  76.8%     -  152s
     0     0 64864.2843    0  337 36884.4181 64864.2843  75.9%     -  168s
     0     0 64554.1450    0  341 36884.4181 64554.1450  75.0%     -  178s
     0     0 64359.7693    0  341 36884.4181 64359.7693  74.5%     -  187s
     0     0 64288.0890    0  342 36884.4181 64288.0890  74.3%     -  192s
     0     0 64229.9598    0  351 36884.4181 64229.9598  74.1%     -  197s
     0     0 64217.5744    0  350 36884.4181 64217.5744  74.1%     -  198s
     0     0 64184.6539    0  352 36884.4181 64184.6539  74.0%     -  201s
     0     0 64176.4254    0  351 36884.4181 64176.4254  74.0%     -  202s
     0     0 64172.1292    0  354 36884.4181 64172.1292  74.0%     -  203s
     0     0 64167.0106    0  356 36884.4181 64167.0106  74.0%     -  204s
     0     0 64163.0378    0  353 36884.4181 64163.0378  74.0%     -  206s
     0     0 64160.9697    0  351 36884.4181 64160.9697  74.0%     -  206s
     0     0 64160.8375    0  353 36884.4181 64160.8375  74.0%     -  207s
H    0     0                    36914.465983 63607.4674  72.3%     -  232s
     0     0 63607.4674    0  357 36914.4660 63607.4674  72.3%     -  232s
     0     0 63414.5322    0  365 36914.4660 63414.5322  71.8%     -  240s
     0     0 63377.7024    0  371 36914.4660 63377.7024  71.7%     -  245s
     0     0 63330.7141    0  410 36914.4660 63330.7141  71.6%     -  251s
     0     0 63320.3913    0  413 36914.4660 63320.3913  71.5%     -  254s
     0     0 63311.1540    0  421 36914.4660 63311.1540  71.5%     -  257s
     0     0 63304.8312    0  416 36914.4660 63304.8312  71.5%     -  258s
     0     0 63301.4588    0  453 36914.4660 63301.4588  71.5%     -  260s
     0     0 63298.0143    0  419 36914.4660 63298.0143  71.5%     -  261s
     0     0 63275.7101    0  445 36914.4660 63275.7101  71.4%     -  264s
     0     0 63259.7482    0  414 36914.4660 63259.7482  71.4%     -  265s
     0     0 63254.2396    0  416 36914.4660 63254.2396  71.4%     -  266s
     0     0 63251.9127    0  416 36914.4660 63251.9127  71.3%     -  267s
     0     0 63251.5480    0  422 36914.4660 63251.5480  71.3%     -  267s
     0     0 63117.0304    0  385 36914.4660 63117.0304  71.0%     -  275s
     0     0 63075.4054    0  400 36914.4660 63075.4054  70.9%     -  280s
     0     0 63071.7316    0  419 36914.4660 63071.7316  70.9%     -  282s
     0     0 63070.6235    0  424 36914.4660 63070.6235  70.9%     -  282s
     0     0 62997.7169    0  397 36914.4660 62997.7169  70.7%     -  288s
     0     0 62975.3230    0  431 36914.4660 62975.3230  70.6%     -  292s
     0     0 62968.1555    0  404 36914.4660 62968.1555  70.6%     -  294s
H    0     0                    36943.320857 62966.5199  70.4%     -  295s
     0     0 62966.5199    0  402 36943.3209 62966.5199  70.4%     -  295s
     0     0 62965.6516    0  394 36943.3209 62965.6516  70.4%     -  295s
     0     0 62946.4592    0  441 36943.3209 62946.4592  70.4%     -  300s
     0     0 62942.0874    0  440 36943.3209 62942.0874  70.4%     -  301s
     0     0 62939.1461    0  409 36943.3209 62939.1461  70.4%     -  302s
     0     0 62937.3875    0  446 36943.3209 62937.3875  70.4%     -  303s
     0     0 62936.8097    0  446 36943.3209 62936.8097  70.4%     -  303s
     0     0 62923.3695    0  434 36943.3209 62923.3695  70.3%     -  306s
     0     0 62920.2968    0  403 36943.3209 62920.2968  70.3%     -  313s
     0     0 62919.4308    0  406 36943.3209 62919.4308  70.3%     -  314s
     0     0 62915.2600    0  398 36943.3209 62915.2600  70.3%     -  316s
     0     0 62912.5576    0  398 36943.3209 62912.5576  70.3%     -  317s
     0     0 62912.4722    0  398 36943.3209 62912.4722  70.3%     -  318s
     0     0 62909.8455    0  404 36943.3209 62909.8455  70.3%     -  320s
     0     0 62907.9649    0  404 36943.3209 62907.9649  70.3%     -  324s
     0     0 62907.4298    0  406 36943.3209 62907.4298  70.3%     -  325s
     0     0 62906.9334    0  399 36943.3209 62906.9334  70.3%     -  326s
     0     0 62906.3154    0  399 36943.3209 62906.3154  70.3%     -  327s
     0     2 62906.3154    0  399 36943.3209 62906.3154  70.3%     -  397s
     1     4 62801.9826    1  389 36943.3209 62906.3154  70.3%  3196  409s
     3     8 62389.5724    2  401 36943.3209 62800.3024  70.0%  5283  424s
     7    16 62157.7987    3  398 36943.3209 62387.4643  68.9%  7071  440s
    15    32 61955.6693    4  407 36943.3209 62157.4105  68.3%  8139  467s
    31    50 61952.1799    5  407 36943.3209 61955.4831  67.7% 13146  510s
    49    82 61894.0812    6  400 36943.3209 61951.1328  67.7% 11510  536s
    81   114 61763.0031    7  397 36943.3209 61893.8896  67.5%  8826  562s
   113   261 61652.8046    8  380 36943.3209 61893.8896  67.5%  6773  592s
   260   344 61190.8890   10  363 36943.3209 61893.8896  67.5%  4380  612s
   343   375 61462.7967   10  382 36943.3209 61893.8896  67.5%  3933  627s
   374   413 61089.1330   10  375 36943.3209 61893.8896  67.5%  3900  653s
   412   456 61394.9948   11  379 36943.3209 61893.8896  67.5%  3839  671s
   455   503 61333.4280   11  384 36943.3209 61893.8896  67.5%  3736  683s
   502   552 61335.9829   12  372 36943.3209 61893.8896  67.5%  3624  700s
   551   594 61087.0296   13  377 36943.3209 61893.8896  67.5%  3515  716s
   593   644 60630.1747   14  372 36943.3209 61893.8896  67.5%  3454  733s
   643   689 60147.4695   14  336 36943.3209 61893.8896  67.5%  3358  750s
   688   742 60528.4120   15  364 36943.3209 61893.8896  67.5%  3311  764s
   741   796 60347.8575   15  366 36943.3209 61893.8896  67.5%  3220  779s
   795   849 60370.5955   16  401 36943.3209 61893.8896  67.5%  3139  793s
   848   893 60244.5180   16  362 36943.3209 61893.8896  67.5%  3083  815s
   892   953 60266.2349   17  383 36943.3209 61893.8896  67.5%  3010  827s
   952  1016 60691.6372   13  346 36943.3209 61893.8896  67.5%  2922  845s
  1015  1084 60051.3932   18  382 36943.3209 61893.8896  67.5%  2844  859s
  1083  1151 59697.8656   19  384 36943.3209 61893.8896  67.5%  2757  872s
H 1100  1151                    38336.047613 61893.8896  61.5%  2726  872s
  1150  1276 58887.1982   19  390 38336.0476 61893.8896  61.5%  2682  892s
  1285  1426 59637.9032   20  386 38336.0476 61893.8896  61.5%  2576  912s
  1451  1550 59590.2683   21  386 38336.0476 61893.8896  61.5%  2444  932s
  1606  1660 59219.3732   25  340 38336.0476 61893.8896  61.5%  2343  956s
  1752  1789 57646.3895   26  266 38336.0476 61893.8896  61.5%  2302  978s
  1899  1955 59345.8898   15  322 38336.0476 61893.8896  61.5%  2266  998s
  2083  2084 57100.1840   27  286 38336.0476 61893.8896  61.5%  2179 1022s
  2271  2116 55641.6987   29  276 38336.0476 61893.8896  61.5%  2127 1039s
H 2292  2116                    38376.042312 61893.8896  61.3%  2138 1039s
  2309  2242 53406.7422   29  266 38376.0423 61893.8896  61.3%  2138 1063s
  2517  2347 53381.6411   33  205 38376.0423 61375.0695  59.9%  2082 1089s
  2669  2480 51955.4639   34  188 38376.0423 61375.0695  59.9%  2091 1115s
  2826  2606 50440.7395   36  177 38376.0423 61335.1463  59.8%  2089 1142s
  3006  2681 49826.3001   38  175 38376.0423 61335.1463  59.8%  2073 1178s
  3125  2780 49088.1673   44  132 38376.0423 61333.1829  59.8%  2059 1208s
  3254  2897 47509.9057   47  124 38376.0423 61333.1829  59.8%  2086 1238s
  3409  2936 45080.2044   56  127 38376.0423 61333.1829  59.8%  2109 1257s
H 3448  2932                    38781.027368 61333.1829  58.2%  2134 1400s
H 3448  2931                    38797.776399 61333.1829  58.1%  2134 1444s
H 3448  2929                    38905.623539 61333.1829  57.6%  2134 1456s
  3449  2930 40572.8617   32  399 38905.6235 61333.1829  57.6%  2133 1544s
  3451  2931 47610.0089   48   97 38905.6235 61333.1829  57.6%  2132 1592s
  3452  2932 54966.9021   39  302 38905.6235 61333.1829  57.6%  2131 1629s
  3453  2933 45525.6778   57  335 38905.6235 61333.1829  57.6%  2131 1654s
  3454  2933 57489.0099   14  347 38905.6235 61333.1829  57.6%  2130 1672s
  3455  2934 40917.5131   61  418 38905.6235 61333.1829  57.6%  2129 1692s
  3456  2935 47328.6931   44  390 38905.6235 61333.1829  57.6%  2129 1703s
  3457  2935 51513.1881   29  388 38905.6235 61333.1829  57.6%  2128 1709s
  3458  2936 55247.9711   14  394 38905.6235 61333.1829  57.6%  2127 1714s
  3459  2937 39443.4032   79  392 38905.6235 61333.1829  57.6%  2127 1720s
  3461  2938 56965.1397   20  391 38905.6235 61333.1829  57.6%  2126 1727s
  3462  2939 47322.6583   65  392 38905.6235 61333.1829  57.6%  2125 1736s
  3463  2939 45466.6222   51  403 38905.6235 61333.1829  57.6%  2124 1742s
  3464  2940 48043.1573   43  396 38905.6235 61333.1829  57.6%  2124 1746s
  3465  2941 42135.4207   42  389 38905.6235 61333.1829  57.6%  2123 1750s
  3467  2942 57314.2415   14  408 38905.6235 61333.1829  57.6%  2122 1755s
  3469  2943 45936.5581   31  433 38905.6235 61333.1829  57.6%  2121 1766s
H 3469  2795                    39066.825944 61333.1829  57.0%  2121 1768s
H 3469  2655                    39117.582333 61333.1829  56.8%  2121 1768s
  3471  2657 51796.0759   28  416 39117.5823 61333.1829  56.8%  2120 1770s
H 3472  2524                    39263.054030 61333.1829  56.2%  2119 1780s
  3475  2526 45131.7930   59  406 39263.0540 61333.1829  56.2%  2117 1786s
  3476  2527 57407.9851   14  433 39263.0540 61333.1829  56.2%  2116 1791s
  3478  2528 44270.7449   79  446 39263.0540 61333.1829  56.2%  2115 1797s
  3479  2529 47653.6703   68  454 39263.0540 61333.1829  56.2%  2115 1803s
  3480  2530 49809.7904   33  488 39263.0540 61333.1829  56.2%  2114 1808s
  3481  2530 54704.2284   16  450 39263.0540 61333.1829  56.2%  2113 1813s
  3482  2531 40715.7522   61  484 39263.0540 61333.1829  56.2%  2113 1816s
  3483  2532 58207.7875   13  446 39263.0540 61333.1829  56.2%  2112 1821s
  3485  2533 47378.4176   50  442 39263.0540 61333.1829  56.2%  2111 1828s
  3486  2534 41131.0953   25  444 39263.0540 61333.1829  56.2%  2110 1831s
  3487  2534 43794.3315   51  444 39263.0540 61333.1829  56.2%  2110 1835s
  3488  2535 47522.1526   50  444 39263.0540 61333.1829  56.2%  2109 1880s
H 3488  2407                    39304.720541 61333.1829  56.0%  2109 1935s
  3490  2411 61333.1829   16  429 39304.7205 61333.1829  56.0%  2161 1976s
  3492  2415 61333.1829   17  412 39304.7205 61333.1829  56.0%  2165 2006s
  3496  2421 61333.1829   18  374 39304.7205 61333.1829  56.0%  2173 2038s
  3504  2435 61273.5019   19  417 39304.7205 61333.1829  56.0%  2192 2078s
  3520  2445 59677.4420   20  391 39304.7205 61273.4866  55.9%  2267 2164s
  3536  2472 57908.1314   21  410 39304.7205 61273.4866  55.9%  2319 2215s
H 3547  2347                    39367.970455 61273.4866  55.6%  2341 2215s
  3568  2431 57195.1359   22  437 39367.9705 61273.4866  55.6%  2381 2263s
H 3659  2350                    39609.481770 61273.4866  54.7%  2535 2294s
  3723  2396 55320.0490   24  378 39609.4818 61273.4866  54.7%  2559 2330s
  3790  2419 56523.0919   25  390 39609.4818 61273.4866  54.7%  2602 2358s
  3836  2470 55310.1823   24  371 39609.4818 61273.4866  54.7%  2635 2388s
  3903  2502 53912.0441   24  357 39609.4818 61273.4866  54.7%  2667 2417s
  3978  2528 50691.2326   35  245 39609.4818 61273.4866  54.7%  2685 2455s
  4056  2529 56033.7750   26  373 39609.4818 61273.4866  54.7%  2697 2488s
  4091  2549 54979.8762   26  338 39609.4818 61273.4866  54.7%  2711 2511s
  4143  2558 54477.1414   26  363 39609.4818 61273.4866  54.7%  2720 2532s
  4175  2578 52489.5457   26  335 39609.4818 61273.4866  54.7%  2727 2561s
  4221  2591 53556.1846   26  306 39609.4818 61273.4866  54.7%  2733 2586s
  4258  2603 54634.9608   27  312 39609.4818 61273.4866  54.7%  2746 2608s
  4299  2608 55344.1652   27  353 39609.4818 61273.4866  54.7%  2762 2630s
  4355  2597 54752.6993   28  373 39609.4818 61273.4866  54.7%  2766 2656s
  4415  2596 53547.1859   29  375 39609.4818 61273.4866  54.7%  2765 2688s
  4473  2603 53140.8378   30  301 39609.4818 61273.4866  54.7%  2772 2727s
  4537  2588 51299.1903   30  308 39609.4818 61273.4866  54.7%  2786 2756s
H 4564  2470                    39771.598459 61273.4866  54.1%  2790 2756s
  4595  2482 49136.8368   29  326 39771.5985 61273.4866  54.1%  2790 2794s
  4695  2484 52648.7285   31  288 39771.5985 61273.4866  54.1%  2792 2830s
H 4770  2355                    39823.466427 61273.4866  53.9%  2807 2830s
  4790  2406 50090.8536   32  337 39823.4664 61273.4866  53.9%  2808 2867s
  4878  2432 47745.2987   33  311 39823.4664 60725.8559  52.5%  2836 2917s
  4973  2461 49322.7451   32  275 39823.4664 60725.8559  52.5%  2857 2956s
  5068  2487 49251.8084   33  284 39823.4664 60725.8559  52.5%  2892 2991s
  5155  2515 48097.2813   33  276 39823.4664 60725.8559  52.5%  2917 3032s
  5257  2551 46086.4557   35  256 39823.4664 60725.8559  52.5%  2937 3067s
  5391  2577 47132.4654   37  238 39823.4664 60725.8559  52.5%  2948 3107s
  5530  2554 42650.7155   38  215 39823.4664 60035.0312  50.8%  2958 3151s
H 5603  2431                    39964.972160 60035.0312  50.2%  2961 3151s
  5631  2465     cutoff   40      39964.9722 60035.0312  50.2%  2960 3192s
  5725  2493 43294.3366   41  156 39964.9722 59432.5609  48.7%  2957 3232s
  5832  2517 42804.2468   42  163 39964.9722 59432.5609  48.7%  2970 3277s
  5955  2546 41589.6613   47  107 39964.9722 59432.5609  48.7%  2983 3332s
  6087  2577 40695.8663   53  102 39964.9722 58688.9856  46.9%  3001 3386s
  6242  2598     cutoff   64      39964.9722 58688.9856  46.9%  3021 3449s
  6427  2609 47339.6731   26  286 39964.9722 58688.9856  46.9%  3031 3505s
  6563  2642 41814.8071   30  209 39964.9722 58688.9856  46.9%  3072 3565s
  6728  2632 42434.7780   29  217 39964.9722 58688.9856  46.9%  3099 3600s

Cutting planes:
  Learned: 2
  MIR: 880
  Mixing: 2
  Flow cover: 2055
  RLT: 20
  Relax-and-lift: 193

Explored 6847 nodes (21552878 simplex iterations) in 3600.06 seconds (5988.80 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 39965 39823.5 39771.6 ... 38905.6

Time limit reached
Best objective 3.996497216014e+04, best bound 5.868898556926e+04, gap 46.8511%
  WARNING: Time limit reached. Using best solution found (gap: 46.85%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 39964.97, θ = 207732.75
  Upper Bound (UB) = 39964.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207732.75
  [DEBUG]   ✓ Scenario 0: θ = 207732.75 ≤ Q = 207732.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207732.75 ≤ Q = 207732.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207732.75 ≤ Q = 207732.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 207732.75 ≤ Q = 207732.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 207732.75 ≤ Q = 207732.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 207732.75 ≤ Q = 207732.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 207732.75 ≤ Q = 207732.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 207732.75 ≤ Q = 207732.75 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5123e682
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5123e682
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.243198e+13
Presolve removed 2544 rows and 1835 columns
Presolve time: 0.01s
Presolved: 549 rows, 554 columns, 1549 nonzeros
Found heuristic solution: objective 6504109.5141
Variable types: 376 continuous, 178 integer (178 binary)

Root relaxation: objective -1.696731e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169673.13    0  129 6504109.51 -169673.13   103%     -    0s
H    0     0                    -129664.9645 -169673.13  30.9%     -    0s
H    0     0                    -130596.8806 -169673.13  29.9%     -    0s
H    0     0                    -132411.5080 -169673.13  28.1%     -    0s
H    0     0                    -132766.6739 -146695.69  10.5%     -    0s
H    0     0                    -136567.8113 -146695.69  7.42%     -    0s
H    0     0                    -141544.6195 -146695.69  3.64%     -    0s
     0     0 -146695.69    0  130 -141544.62 -146695.69  3.64%     -    0s
     0     0 -146132.83    0  129 -141544.62 -146132.83  3.24%     -    0s
H    0     0                    -143028.6859 -146132.83  2.17%     -    0s
     0     0 -144902.74    0  136 -143028.69 -144902.74  1.31%     -    0s
H    0     0                    -143276.7627 -144900.15  1.13%     -    0s
     0     0 -144845.65    0  134 -143276.76 -144845.65  1.10%     -    0s
     0     0 -144844.32    0  134 -143276.76 -144844.32  1.09%     -    0s
     0     0 -144281.91    0   98 -143276.76 -144281.91  0.70%     -    0s
     0     0 -144131.51    0   78 -143276.76 -144131.51  0.60%     -    0s
     0     0 -144125.05    0   79 -143276.76 -144125.05  0.59%     -    0s
     0     0 -143906.37    0   65 -143276.76 -143906.37  0.44%     -    0s
H    0     0                    -143482.4691 -143903.69  0.29%     -    0s
H    0     0                    -143515.0392 -143903.69  0.27%     -    0s
     0     0 -143865.66    0   67 -143515.04 -143865.66  0.24%     -    0s
     0     0 -143865.66    0   63 -143515.04 -143865.66  0.24%     -    0s
     0     0 -143801.75    0   40 -143515.04 -143801.75  0.20%     -    0s
H    0     0                    -143592.9846 -143801.70  0.15%     -    0s
     0     0 -143790.17    0   41 -143592.98 -143790.17  0.14%     -    0s
     0     0 -143790.15    0   40 -143592.98 -143790.15  0.14%     -    0s
     0     0 -143735.81    0   39 -143592.98 -143735.81  0.10%     -    0s
     0     0 -143731.93    0   39 -143592.98 -143731.93  0.10%     -    0s
H    0     0                    -143598.4989 -143731.93  0.09%     -    0s
     0     0 -143731.93    0   66 -143598.50 -143731.93  0.09%     -    0s
     0     0 -143731.93    0   66 -143598.50 -143731.93  0.09%     -    0s
     0     0 -143731.93    0   47 -143598.50 -143731.93  0.09%     -    0s
     0     0 -143640.42    0   16 -143598.50 -143640.42  0.03%     -    0s
     0     0 -143636.87    0    7 -143598.50 -143636.87  0.03%     -    0s
     0     0          -    0      -143598.50 -143611.65  0.01%     -    0s

Cutting planes:
  Gomory: 18
  Implied bound: 3
  MIR: 56
  Flow cover: 16
  RLT: 1
  Relax-and-lift: 8

Explored 1 nodes (1182 simplex iterations) in 0.20 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -143598 -143593 -143515 ... -130597

Optimal solution found (tolerance 1.00e-04)
Best objective -1.435984989157e+05, best bound -1.436116471793e+05, gap 0.0092%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 198197.49
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143598.50
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -143598.50 = 198197.49
  [DEBUG]   Current θ from Master = 207732.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9535.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30429.71
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 3679.3749, Absolute Gap = 3679.3749, Relative Gap = 0.092065
  Not converged yet (gap = 3679.37 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394841 nonzeros
Model fingerprint: 0x57236144
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55689 rows and 22629 columns
Presolve time: 2.80s
Presolved: 83304 rows, 35791 columns, 509036 nonzeros
Variable types: 33532 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321663.6835
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.436e+06
 Factor NZ  : 7.422e+06 (roughly 100 MB of memory)
 Factor Ops : 1.196e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.50544259e+07  1.51800170e+08  1.09e+05 2.17e+01  6.76e+04     4s
   1  -1.11158181e+07  1.34720679e+08  7.51e+04 7.41e+01  4.60e+04     5s
   2  -4.79252173e+06  1.00196548e+08  3.19e+04 8.36e-12  2.05e+04     5s
   3  -7.56810060e+05  7.41237403e+07  1.92e+03 1.72e+00  1.65e+03     5s
   4  -4.60170354e+05  2.47484006e+07  4.42e+02 1.18e-01  3.93e+02     5s
   5  -3.22380161e+05  1.75324219e+07  1.47e+02 7.64e-02  1.87e+02     5s
   6  -2.44766165e+05  1.17890977e+07  7.71e+01 4.56e-02  1.10e+02     5s
   7  -1.53781730e+05  9.00151164e+06  4.45e+01 3.31e-02  7.53e+01     5s
   8  -1.14519309e+05  5.52951805e+06  2.80e+01 1.88e-02  4.40e+01     5s
   9  -8.16250327e+04  4.03685095e+06  1.59e+01 1.31e-02  3.01e+01     5s
  10  -4.72506165e+04  1.73751667e+06  5.72e+00 5.17e-03  1.23e+01     5s
  11  -1.67824700e+04  4.76140449e+05  2.11e+00 1.35e-03  3.30e+00     5s
  12   1.99839674e+03  3.03173330e+05  1.55e+00 1.17e-03  2.01e+00     5s
  13   9.41552484e+03  2.17075427e+05  1.33e+00 9.67e-04  1.39e+00     6s
  14   1.90411442e+04  1.70134425e+05  1.09e+00 1.40e-03  1.01e+00     6s
  15   3.15356860e+04  1.54218141e+05  8.32e-01 1.07e-03  8.17e-01     6s
  16   3.91158904e+04  1.29644686e+05  6.80e-01 1.14e-03  6.03e-01     6s
  17   4.45581755e+04  1.20896235e+05  5.81e-01 1.29e-03  5.08e-01     6s
  18   5.28046189e+04  1.10210854e+05  4.37e-01 1.24e-03  3.82e-01     6s
  19   5.90950396e+04  1.03226555e+05  3.32e-01 1.22e-03  2.94e-01     6s
  20   6.36465882e+04  9.84286798e+04  2.61e-01 1.22e-03  2.31e-01     6s
  21   6.80428212e+04  9.50968308e+04  1.95e-01 1.13e-03  1.80e-01     6s
  22   7.07812020e+04  9.11387684e+04  1.56e-01 1.32e-03  1.35e-01     6s
  23   7.25337077e+04  8.87762882e+04  1.32e-01 1.60e-03  1.08e-01     6s
  24   7.60886480e+04  8.70728718e+04  8.31e-02 9.58e-04  7.30e-02     6s
  25   7.78985946e+04  8.58324963e+04  6.06e-02 8.58e-04  5.27e-02     7s
  26   7.91269930e+04  8.49179846e+04  4.52e-02 1.53e-03  3.85e-02     7s
  27   8.00820893e+04  8.42665950e+04  3.33e-02 1.07e-03  2.78e-02     7s
  28   8.11009518e+04  8.38507360e+04  2.11e-02 9.31e-04  1.83e-02     7s
  29   8.12809709e+04  8.37808393e+04  1.90e-02 8.21e-04  1.66e-02     7s
  30   8.13739995e+04  8.35752328e+04  1.80e-02 7.52e-04  1.46e-02     7s
  31   8.19847727e+04  8.34480891e+04  1.10e-02 5.97e-04  9.72e-03     7s
  32   8.24298884e+04  8.32986583e+04  6.03e-03 3.96e-04  5.76e-03     7s
  33   8.24515295e+04  8.32180527e+04  5.78e-03 3.10e-04  5.09e-03     7s
  34   8.27057499e+04  8.31203180e+04  3.02e-03 1.65e-04  2.75e-03     7s
  35   8.28076776e+04  8.30971430e+04  1.95e-03 1.31e-04  1.92e-03     8s
  36   8.28701574e+04  8.30731589e+04  1.30e-03 9.74e-05  1.35e-03     8s
  37   8.29082354e+04  8.30447357e+04  9.04e-04 5.79e-05  9.05e-04     8s
  38   8.29346036e+04  8.30257486e+04  6.41e-04 3.18e-05  6.05e-04     8s
  39   8.29671039e+04  8.30158505e+04  3.24e-04 3.77e-05  3.23e-04     8s
  40   8.29854009e+04  8.30096911e+04  1.48e-04 2.01e-05  1.61e-04     8s
  41   8.29947604e+04  8.30068520e+04  6.52e-05 1.37e-05  7.99e-05     8s
  42   8.29996439e+04  8.30030302e+04  2.26e-05 1.33e-06  2.25e-05     8s
  43   8.30008277e+04  8.30029114e+04  1.16e-05 1.12e-06  1.38e-05     8s
  44   8.30019933e+04  8.30023370e+04  1.90e-06 5.69e-07  2.27e-06     9s
  45   8.30022588e+04  8.30023133e+04  7.25e-08 3.85e-07  3.56e-07     9s
  46   8.30022641e+04  8.30022789e+04  3.41e-08 4.86e-08  9.64e-08     9s
  47   8.30022642e+04  8.30022788e+04  4.77e-07 4.99e-08  9.53e-08     9s
  48   8.30022684e+04  8.30022728e+04  5.03e-08 1.02e-08  2.89e-08     9s
  49   8.30022693e+04  8.30022703e+04  2.21e-06 8.72e-07  8.19e-09     9s
  50   8.30022695e+04  8.30022703e+04  1.87e-06 1.36e-05  6.60e-09    10s
  51   8.30022694e+04  8.30022703e+04  3.71e-06 1.32e-05  6.57e-09    10s
  52   8.30022694e+04  8.30022703e+04  8.53e-06 1.44e-05  6.17e-09    10s
  53   8.30022697e+04  8.30022704e+04  1.03e-05 1.66e-05  6.01e-09    10s
  54   8.30022698e+04  8.30022703e+04  1.19e-05 2.11e-05  5.68e-09    10s
  55   8.30022698e+04  8.30022708e+04  1.17e-05 3.43e-05  4.00e-09    10s
  56   8.30022701e+04  8.30022707e+04  1.01e-05 2.98e-05  3.28e-09    10s
  57   8.30022701e+04  8.30022705e+04  9.75e-06 2.45e-05  2.83e-09    10s
  58   8.30022700e+04  8.30022703e+04  5.93e-06 1.71e-05  1.97e-09    11s

Barrier solved model in 58 iterations and 10.66 seconds (8.27 work units)
Optimal objective 8.30022700e+04


Root crossover log...

   75509 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    1314 PPushes remaining with PInf 6.5370074e-04                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6662287e+00     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40924    8.3002270e+04   0.000000e+00   3.666229e+00     15s
   40932    8.3002270e+04   0.000000e+00   0.000000e+00     15s
   40932    8.3002270e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.300227e+04, 40932 iterations, 11.58 seconds (13.55 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83002.2698    0  205 -198441.04 83002.2698   142%     -   15s
H    0     0                    -191877.5100 83002.2698   143%     -   15s
H    0     0                    -91283.29018 83002.2698   191%     -   16s
H    0     0                    -90757.28649 83002.2698   191%     -   16s
H    0     0                    -35436.65155 83002.2698   334%     -   16s
H    0     0                    24853.683125 83002.2698   234%     -   16s
H    0     0                    32513.170114 83002.2698   155%     -   17s
H    0     0                    32702.822395 83002.2698   154%     -   18s
H    0     0                    32727.962078 83002.2698   154%     -   18s
H    0     0                    32796.817351 83002.2698   153%     -   18s
H    0     0                    32868.918851 83002.2698   153%     -   18s
H    0     0                    32886.887467 83002.2698   152%     -   18s
H    0     0                    33114.403648 83002.2698   151%     -   18s
H    0     0                    33208.398604 83002.2698   150%     -   18s
H    0     0                    33279.567930 83002.2698   149%     -   18s
H    0     0                    33555.656464 83002.2698   147%     -   20s
H    0     0                    33556.218373 83002.2698   147%     -   20s
     0     0 74984.4321    0  205 33556.2184 74984.4321   123%     -   63s
H    0     0                    34544.926997 74982.9674   117%     -   64s
     0     0 73987.8441    0  256 34544.9270 73987.8441   114%     -  101s
     0     0 73874.3141    0  257 34544.9270 73874.3141   114%     -  112s
     0     0 73431.4395    0  293 34544.9270 73431.4395   113%     -  130s
     0     0 73380.9030    0  295 34544.9270 73380.9030   112%     -  134s
     0     0 73368.1529    0  294 34544.9270 73368.1529   112%     -  137s
     0     0 73363.1830    0  289 34544.9270 73363.1830   112%     -  139s
     0     0 73360.0936    0  294 34544.9270 73360.0936   112%     -  140s
     0     0 73356.3418    0  292 34544.9270 73356.3418   112%     -  141s
     0     0 73355.7705    0  294 34544.9270 73355.7705   112%     -  142s
     0     0 69995.0059    0  304 34544.9270 69995.0059   103%     -  202s
H    0     0                    35005.608100 69219.7576  97.7%     -  255s
H    0     0                    35618.967144 69219.7576  94.3%     -  255s
H    0     0                    35985.620409 69219.7576  92.4%     -  255s
H    0     0                    36187.594708 69219.7576  91.3%     -  255s
H    0     0                    36236.028176 69219.7576  91.0%     -  255s
H    0     0                    36496.946174 69219.7576  89.7%     -  255s
     0     0 69219.7576    0  315 36496.9462 69219.7576  89.7%     -  255s
H    0     0                    36560.640905 69021.4026  88.8%     -  279s
     0     0 69021.4026    0  324 36560.6409 69021.4026  88.8%     -  279s
H    0     0                    36617.457619 68968.9980  88.4%     -  287s
     0     0 68968.9980    0  362 36617.4576 68968.9980  88.4%     -  287s
     0     0 68954.3534    0  334 36617.4576 68954.3534  88.3%     -  291s
     0     0 68894.5325    0  356 36617.4576 68894.5325  88.1%     -  296s
     0     0 68873.7155    0  350 36617.4576 68873.7155  88.1%     -  301s
     0     0 68867.3118    0  348 36617.4576 68867.3118  88.1%     -  303s
     0     0 68864.6735    0  345 36617.4576 68864.6735  88.1%     -  305s
     0     0 68864.2890    0  342 36617.4576 68864.2890  88.1%     -  306s
     0     0 66808.0060    0  352 36617.4576 66808.0060  82.4%     -  389s
     0     0 66155.3472    0  385 36617.4576 66155.3472  80.7%     -  434s
     0     0 65944.2688    0  430 36617.4576 65944.2688  80.1%     -  463s
     0     0 65883.5040    0  375 36617.4576 65883.5040  79.9%     -  473s
     0     0 65866.7638    0  381 36617.4576 65866.7638  79.9%     -  480s
     0     0 65849.8656    0  373 36617.4576 65849.8656  79.8%     -  487s
     0     0 65835.1793    0  369 36617.4576 65835.1793  79.8%     -  492s
     0     0 65822.2470    0  372 36617.4576 65822.2470  79.8%     -  495s
     0     0 65819.1542    0  370 36617.4576 65819.1542  79.7%     -  497s
     0     0 65818.4943    0  364 36617.4576 65818.4943  79.7%     -  498s
     0     0 64430.1168    0  374 36617.4576 64430.1168  76.0%     -  571s
     0     0 64083.9913    0  445 36617.4576 64083.9913  75.0%     -  603s
     0     0 63847.8798    0  331 36617.4576 63847.8798  74.4%     -  630s
     0     0 63721.7421    0  375 36617.4576 63721.7421  74.0%     -  647s
     0     0 63655.4655    0  412 36617.4576 63655.4655  73.8%     -  661s
     0     0 63611.4997    0  397 36617.4576 63611.4997  73.7%     -  678s
     0     0 63589.4307    0  394 36617.4576 63589.4307  73.7%     -  686s
     0     0 63568.7821    0  391 36617.4576 63568.7821  73.6%     -  692s
     0     0 63564.7041    0  394 36617.4576 63564.7041  73.6%     -  696s
     0     0 63545.4480    0  394 36617.4576 63545.4480  73.5%     -  704s
     0     0 63544.3205    0  395 36617.4576 63544.3205  73.5%     -  707s
     0     0 63130.0533    0  360 36617.4576 63130.0533  72.4%     -  735s
     0     0 62994.1453    0  415 36617.4576 62994.1453  72.0%     -  753s
     0     0 62926.6631    0  420 36617.4576 62926.6631  71.8%     -  762s
     0     0 62907.8631    0  425 36617.4576 62907.8631  71.8%     -  768s
     0     0 62889.6958    0  435 36617.4576 62889.6958  71.7%     -  774s
     0     0 62882.2468    0  429 36617.4576 62882.2468  71.7%     -  778s
     0     0 62876.3744    0  433 36617.4576 62876.3744  71.7%     -  781s
     0     0 62870.6371    0  430 36617.4576 62870.6371  71.7%     -  785s
     0     0 62869.7968    0  436 36617.4576 62869.7968  71.7%     -  786s
     0     0 62772.0210    0  399 36617.4576 62772.0210  71.4%     -  798s
H    0     0                    36702.949514 62771.8452  71.0%     -  800s
     0     0 62712.0476    0  406 36702.9495 62712.0476  70.9%     -  815s
     0     0 62703.4819    0  397 36702.9495 62703.4819  70.8%     -  820s
     0     0 62698.0764    0  424 36702.9495 62698.0764  70.8%     -  824s
     0     0 62694.2928    0  419 36702.9495 62694.2928  70.8%     -  826s
     0     0 62693.2628    0  422 36702.9495 62693.2628  70.8%     -  827s
     0     0 62656.1329    0  417 36702.9495 62656.1329  70.7%     -  841s
     0     0 62651.4760    0  415 36702.9495 62651.4760  70.7%     -  844s
     0     0 62649.9199    0  421 36702.9495 62649.9199  70.7%     -  846s
     0     0 62625.2286    0  426 36702.9495 62625.2286  70.6%     -  855s
     0     0 62621.9156    0  473 36702.9495 62621.9156  70.6%     -  861s
     0     0 62618.7101    0  473 36702.9495 62618.7101  70.6%     -  864s
     0     0 62617.8567    0  465 36702.9495 62617.8567  70.6%     -  865s
     0     0 62612.8241    0  432 36702.9495 62612.8241  70.6%     -  870s
     0     0 62611.2298    0  437 36702.9495 62611.2298  70.6%     -  873s
     0     0 62608.5673    0  469 36702.9495 62608.5673  70.6%     -  876s
     0     0 62608.5530    0  469 36702.9495 62608.5530  70.6%     -  879s
H    0     0                    36870.397396 62608.5197  69.8%     -  963s
H    0     0                    36914.465983 62608.5197  69.6%     - 1028s
     0     2 62608.5197    0  469 36914.4660 62608.5197  69.6%     - 1050s
     1     4 62544.1675    1  456 36914.4660 62608.5197  69.6%  3377 1073s
     3     8 62102.2925    2  420 36914.4660 62543.2565  69.4%  8178 1117s
     7    16 61801.3592    3  419 36914.4660 62101.1894  68.2% 11520 1170s
    15    32 61685.4118    4  416 36914.4660 61800.7300  67.4% 15051 1215s
    31    48 60322.3659    5  415 36914.4660 61685.3197  67.1% 20197 1322s
    47    80 58524.5133    6  372 36914.4660 61685.3197  67.1% 18922 1384s
H   66    80                    36943.320857 61685.3197  67.0% 16605 1384s
    79   147 58273.6919    7  355 36943.3209 61685.3197  67.0% 14880 1536s
   146   296 57806.6610    9  352 36943.3209 61685.3197  67.0% 10136 1596s
   295   392 57659.1952   10  345 36943.3209 61685.3197  67.0%  6814 1628s
   391   457 57607.6639   11  343 36943.3209 61685.3197  67.0%  6021 1657s
   456   522 57121.8275   11  317 36943.3209 61685.3197  67.0%  5674 1686s
   521   579 57422.5880   12  337 36943.3209 61685.3197  67.0%  5514 1717s
   582   614 56850.4834   12  344 36943.3209 61685.3197  67.0%  5462 1746s
   623   639 57489.4154   12  336 36943.3209 61685.3197  67.0%  5459 1771s
   650   665 56898.5128   12  322 36943.3209 61685.3197  67.0%  5674 1794s
   684   685 57245.6318   13  340 36943.3209 61685.3197  67.0%  5841 1817s
   710   717 56916.1038   12  315 36943.3209 61685.3197  67.0%  5953 1843s
   742   746 56622.9355   13  333 36943.3209 61685.3197  67.0%  6075 1867s
   771   777 53155.8458   13  328 36943.3209 61685.3197  67.0%  6172 1890s
H  797   777                    37058.647798 61685.3197  66.5%  6238 1890s
   808   806 55474.6394   14  328 37058.6478 61685.3197  66.5%  6224 1916s
   837   842 56202.5715   14  314 37058.6478 61685.3197  66.5%  6297 1940s
   875   870 49524.2210   30  291 37058.6478 61685.3197  66.5%  6433 1963s
H  885   870                    37181.173306 61685.3197  65.9%  6462 1963s
H  897   870                    37296.857634 61685.3197  65.4%  6476 1963s
H  904   870                    37457.905173 61685.3197  64.7%  6476 1963s
   909   932 50356.6415   15  328 37457.9052 61685.3197  64.7%  6506 1988s
   987  1018 49388.9059   16  310 37457.9052 61685.3197  64.7%  6414 2018s
  1099  1064 49911.6907   16  321 37457.9052 61685.3197  64.7%  6183 2046s
H 1111  1064                    37774.472227 61685.3197  63.3%  6205 2046s
H 1113  1064                    37953.412742 61685.3197  62.5%  6201 2046s
  1180  1127 48035.8089   17  286 37953.4127 61685.3197  62.5%  6113 2076s
  1295  1158 39091.3053   36  236 37953.4127 61685.3197  62.5%  6004 2107s
  1365  1202     cutoff   37      37953.4127 61685.3197  62.5%  6108 2139s
  1463  1278 48452.2968   17  312 37953.4127 61685.3197  62.5%  6014 2178s
  1573  1296 47501.0346   18  299 37953.4127 61685.3197  62.5%  5985 2214s
H 1602  1296                    38010.009241 61685.3197  62.3%  6003 2214s
  1609  1377 46358.8991   19  267 38010.0092 61685.3197  62.3%  6054 2251s
  1755  1428 41948.8171   19  262 38010.0092 61685.3197  62.3%  5858 2290s
  1877  1476 43950.8847   20  271 38010.0092 61685.3197  62.3%  5787 2332s
  1983  1538 42698.3893   21  316 38010.0092 61685.3197  62.3%  5767 2374s
  2123  1559 39520.8668   21  191 38010.0092 61685.3197  62.3%  5640 2412s
H 2136  1559                    38118.435015 61685.3197  61.8%  5642 2412s
H 2149  1559                    38126.964929 61685.3197  61.8%  5669 2412s
  2158  1588 40926.8419   20  276 38126.9649 61685.3197  61.8%  5714 2457s
  2259  1613 39158.3812   22  207 38126.9649 61685.3197  61.8%  5753 2499s
H 2271  1613                    38160.686426 61685.3197  61.6%  5817 2499s
  2292  1668 38495.2556   23  337 38160.6864 61685.3197  61.6%  5900 2548s
H 2338  1668                    38205.970202 61685.3197  61.5%  5930 2548s
  2381  1699 45456.9454   14  296 38205.9702 61685.3197  61.5%  5989 2593s
  2436  1779 45243.0780   15  281 38205.9702 61685.3197  61.5%  6055 2641s
  2524  1898 43768.3221   16  185 38205.9702 61685.3197  61.5%  6120 2688s
  2656  2045 42769.6429   24  167 38205.9702 61685.3197  61.5%  6113 2742s
H 2823  2067                    38303.530953 61685.3197  61.0%  6072 2787s
  2860  2226 40610.9343   38  147 38303.5310 61337.3938  60.1%  6122 2844s
  3049  2399 39206.6801   56   86 38303.5310 61337.3938  60.1%  6069 2904s
  3252  2553 51967.7653   14  286 38303.5310 61337.3938  60.1%  6037 2960s
H 3462  2544                    38489.557582 61337.3938  59.4%  5975 3008s
  3463  2545 46543.2284   22  469 38489.5576 61337.3938  59.4%  5973 3143s
H 3464  2418                    38530.710727 61337.3938  59.2%  5972 3155s
H 3464  2297                    38618.382283 61337.3938  58.8%  5972 3155s
H 3465  2182                    38641.534989 61337.3938  58.7%  5970 3236s
  3466  2183 46801.0785   34  331 38641.5350 61337.3938  58.7%  5968 3243s
  3467  2184 48448.8935   18  361 38641.5350 61337.3938  58.7%  5966 3327s
  3468  2184 47028.6109   19  397 38641.5350 61337.3938  58.7%  5965 3387s
  3469  2185 55247.2175   19  392 38641.5350 61337.3938  58.7%  5963 3424s
  3470  2186 51079.9956   22  367 38641.5350 61337.3938  58.7%  5961 3453s
  3471  2186 39195.8925   18  375 38641.5350 61337.3938  58.7%  5960 3467s
  3472  2187 45188.1907   43  374 38641.5350 61337.3938  58.7%  5958 3481s
  3473  2188 44431.1373   32  396 38641.5350 61337.3938  58.7%  5956 3497s
  3474  2188 42357.8485   26  390 38641.5350 61337.3938  58.7%  5954 3510s
  3475  2189 57658.8249   16  381 38641.5350 61337.3938  58.7%  5953 3523s
  3476  2190 49509.2094   23  422 38641.5350 61337.3938  58.7%  5951 3529s
  3477  2190 43681.7953   24  399 38641.5350 61337.3938  58.7%  5949 3542s
  3478  2191 55102.8052   16  433 38641.5350 61337.3938  58.7%  5948 3552s
  3479  2192 54014.9733   17  444 38641.5350 61337.3938  58.7%  5946 3558s
  3480  2192 39371.9726   57  412 38641.5350 61337.3938  58.7%  5944 3562s
  3481  2193 57141.1691   16  391 38641.5350 61337.3938  58.7%  5942 3575s
  3482  2194 41240.5189   38  410 38641.5350 61337.3938  58.7%  5941 3583s
  3483  2194 47028.6109   19  446 38641.5350 61337.3938  58.7%  5939 3590s

Cutting planes:
  Gomory: 16
  Implied bound: 41
  Projected implied bound: 47
  MIR: 689
  Mixing: 5
  Flow cover: 543
  RLT: 16
  Relax-and-lift: 188

Explored 3483 nodes (21313027 simplex iterations) in 3600.21 seconds (5378.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 38641.5 38618.4 38530.7 ... 38010

Time limit reached
Best objective 3.864153498858e+04, best bound 6.133739375877e+04, gap 58.7344%
  WARNING: Time limit reached. Using best solution found (gap: 58.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.28s
  Master Objective (UB) = 38641.53, θ = 206543.57
  Upper Bound (UB) = 38641.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206543.57
  [DEBUG]   ✓ Scenario 0: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 206543.57 ≤ Q = 206543.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x267b2561
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x267b2561
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.249619e+13
Presolve removed 2543 rows and 1834 columns
Presolve time: 0.01s
Presolved: 550 rows, 555 columns, 1552 nonzeros
Found heuristic solution: objective 6502048.3159
Variable types: 377 continuous, 178 integer (178 binary)

Root relaxation: objective -1.712683e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171268.33    0  129 6502048.32 -171268.33   103%     -    0s
H    0     0                    -132785.0620 -171268.33  29.0%     -    0s
H    0     0                    -133726.6438 -171268.33  28.1%     -    0s
H    0     0                    -133754.1427 -171268.33  28.0%     -    0s
H    0     0                    -134474.8691 -150645.91  12.0%     -    0s
     0     0 -150645.91    0   98 -134474.87 -150645.91  12.0%     -    0s
H    0     0                    -147999.0009 -150547.12  1.72%     -    0s
     0     0 -150207.84    0  101 -147999.00 -150207.84  1.49%     -    0s
     0     0 -150199.48    0  101 -147999.00 -150199.48  1.49%     -    0s
     0     0 -149379.69    0   86 -147999.00 -149379.69  0.93%     -    0s
H    0     0                    -148065.9749 -149350.12  0.87%     -    0s
     0     0 -149340.86    0   86 -148065.97 -149340.86  0.86%     -    0s
H    0     0                    -148076.4298 -148732.78  0.44%     -    0s
     0     0 -148732.78    0   35 -148076.43 -148732.78  0.44%     -    0s
H    0     0                    -148084.1390 -148675.90  0.40%     -    0s
     0     0 -148574.18    0   43 -148084.14 -148574.18  0.33%     -    0s
     0     0 -148569.90    0   43 -148084.14 -148569.90  0.33%     -    0s
     0     0 -148568.90    0   45 -148084.14 -148568.90  0.33%     -    0s
     0     0 -148356.51    0   45 -148084.14 -148356.51  0.18%     -    0s
H    0     0                    -148118.2991 -148356.40  0.16%     -    0s
     0     0 -148316.39    0   48 -148118.30 -148316.39  0.13%     -    0s
     0     0 -148316.09    0   47 -148118.30 -148316.09  0.13%     -    0s
     0     0 -148314.40    0   48 -148118.30 -148314.40  0.13%     -    0s
     0     0 -148272.84    0   44 -148118.30 -148272.84  0.10%     -    0s
     0     0 -148272.84    0   60 -148118.30 -148272.84  0.10%     -    0s
     0     0 -148272.84    0   39 -148118.30 -148272.84  0.10%     -    0s
H    0     0                    -148198.2871 -148272.84  0.05%     -    0s
H    0     0                    -148222.5108 -148272.84  0.03%     -    0s
     0     0 -148272.84    0   29 -148222.51 -148272.84  0.03%     -    0s
     0     0 -148241.11    0    6 -148222.51 -148241.11  0.01%     -    0s
     0     0          -    0      -148222.51 -148230.23  0.01%     -    0s

Cutting planes:
  Gomory: 20
  Implied bound: 14
  MIR: 47
  Flow cover: 17

Explored 1 nodes (1112 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -148223 -148198 -148118 ... -133727

Optimal solution found (tolerance 1.00e-04)
Best objective -1.482225108255e+05, best bound -1.482302327203e+05, gap 0.0052%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 193573.48
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148222.51
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -148222.51 = 193573.48
  [DEBUG]   Current θ from Master = 206543.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12970.10 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25671.44
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 2355.9377, Absolute Gap = 2355.9377, Relative Gap = 0.060969
  Not converged yet (gap = 2355.94 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438099 nonzeros
Model fingerprint: 0x68c7cdec
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61850 rows and 25130 columns
Presolve time: 3.03s
Presolved: 92433 rows, 39530 columns, 560629 nonzeros
Variable types: 37271 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -327405.5644
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.977e+06
 Factor NZ  : 8.670e+06 (roughly 120 MB of memory)
 Factor Ops : 1.482e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.54181454e+07  1.67105820e+08  1.11e+05 2.06e+01  6.88e+04     5s
   1  -1.15163845e+07  1.49171262e+08  7.71e+04 7.20e+01  4.71e+04     5s
   2  -5.26168521e+06  1.10853998e+08  3.48e+04 2.20e-11  2.22e+04     5s
   3  -8.09129785e+05  8.37558359e+07  2.23e+03 1.28e+00  1.84e+03     5s
   4  -4.63521083e+05  2.85294037e+07  4.70e+02 1.30e-01  4.14e+02     5s
   5  -3.35249398e+05  2.05838660e+07  1.77e+02 9.08e-02  2.09e+02     5s
   6  -2.62498011e+05  1.44093101e+07  8.44e+01 5.79e-02  1.22e+02     5s
   7  -1.89391078e+05  1.15229911e+07  4.49e+01 4.45e-02  8.57e+01     5s
   8  -1.11150052e+05  8.15364993e+06  2.02e+01 3.00e-02  5.48e+01     5s
   9  -6.93827733e+04  6.16850176e+06  1.11e+01 2.21e-02  3.94e+01     5s
  10  -3.65047702e+04  2.17380799e+06  4.07e+00 6.91e-03  1.34e+01     5s
  11   1.53904563e+03  5.41304540e+05  1.46e+00 1.42e-03  3.23e+00     5s
  12   1.45758757e+04  2.69567960e+05  9.61e-01 8.92e-04  1.52e+00     5s
  13   2.22734662e+04  2.04667952e+05  7.46e-01 6.84e-04  1.09e+00     5s
  14   2.95701303e+04  1.58244023e+05  6.05e-01 1.37e-03  7.66e-01     6s
  15   3.85900208e+04  1.43205645e+05  4.68e-01 1.21e-03  6.22e-01     6s
  16   4.58416981e+04  1.25700736e+05  3.74e-01 1.78e-03  4.75e-01     6s
  17   5.43724324e+04  1.15942084e+05  2.69e-01 1.77e-03  3.66e-01     6s
  18   5.94141619e+04  1.07559187e+05  2.10e-01 1.85e-03  2.86e-01     6s
  19   6.42584066e+04  1.03962761e+05  1.58e-01 1.80e-03  2.35e-01     6s
  20   6.63640709e+04  9.41745630e+04  1.34e-01 1.60e-03  1.65e-01     6s
  21   7.01120571e+04  9.16218283e+04  9.86e-02 1.39e-03  1.28e-01     6s
  22   7.09637215e+04  9.04339055e+04  9.04e-02 1.14e-03  1.16e-01     6s
  23   7.27699676e+04  8.85422334e+04  7.41e-02 1.19e-03  9.36e-02     6s
  24   7.36459703e+04  8.78710585e+04  6.64e-02 1.18e-03  8.44e-02     6s
  25   7.55933104e+04  8.69123375e+04  4.95e-02 9.29e-04  6.71e-02     6s
  26   7.70301641e+04  8.56541213e+04  3.72e-02 1.06e-03  5.11e-02     6s
  27   7.80524082e+04  8.46547013e+04  2.87e-02 8.94e-04  3.92e-02     6s
  28   7.94267866e+04  8.35140946e+04  1.81e-02 7.73e-04  2.42e-02     6s
  29   8.01095168e+04  8.28011713e+04  1.29e-02 9.95e-04  1.60e-02     7s
  30   8.04187855e+04  8.25174521e+04  1.06e-02 7.88e-04  1.25e-02     7s
  31   8.09679811e+04  8.23916795e+04  6.47e-03 6.18e-04  8.44e-03     7s
  32   8.10672483e+04  8.22527677e+04  5.72e-03 4.48e-04  7.03e-03     7s
  33   8.11958100e+04  8.21476855e+04  4.78e-03 3.15e-04  5.65e-03     7s
  34   8.13314542e+04  8.20953924e+04  3.83e-03 2.83e-04  4.53e-03     7s
  35   8.15746635e+04  8.20098948e+04  2.19e-03 1.93e-04  2.58e-03     7s
  36   8.17371529e+04  8.19630689e+04  1.07e-03 1.07e-04  1.34e-03     7s
  37   8.18189966e+04  8.19324119e+04  5.26e-04 5.07e-05  6.73e-04     7s
  38   8.18487589e+04  8.19147978e+04  3.35e-04 3.23e-05  3.92e-04     7s
  39   8.18608798e+04  8.19138493e+04  2.59e-04 2.96e-05  3.14e-04     7s
  40   8.18797867e+04  8.19084731e+04  1.40e-04 1.35e-05  1.70e-04     7s
  41   8.19008619e+04  8.19063383e+04  7.68e-06 7.72e-06  3.23e-05     7s
  42   8.19031248e+04  8.19037334e+04  6.79e-07 9.76e-07  3.59e-06     7s
  43   8.19033840e+04  8.19034496e+04  1.33e-07 5.70e-08  3.88e-07     8s
  44   8.19034479e+04  8.19034485e+04  3.97e-08 2.65e-09  3.26e-09     8s

Barrier solved model in 44 iterations and 7.60 seconds (7.11 work units)
Optimal objective 8.19034479e+04


Root crossover log...

   83233 DPushes remaining with DInf 0.0000000e+00                 8s
   11853 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

   17781 PPushes remaining with PInf 8.3583008e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9246280e+04     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60034    8.1903448e+04   0.000000e+00   3.924628e+04     14s
   60551    8.1903448e+04   0.000000e+00   0.000000e+00     15s
   60551    8.1903448e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 1.63s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.190345e+04, 60551 iterations, 12.75 seconds (17.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81903.4484    0  168 -198441.04 81903.4484   141%     -   17s
H    0     0                    -190406.4487 81903.4484   143%     -   17s
H    0     0                    -41914.13355 81903.4484   295%     -   17s
H    0     0                    24614.229990 81903.4484   233%     -   18s
H    0     0                    25131.617670 81903.4484   226%     -   18s
H    0     0                    27510.928430 81903.4484   198%     -   18s
H    0     0                    27603.091672 81903.4484   197%     -   18s
H    0     0                    28379.276607 81903.4484   189%     -   18s
H    0     0                    31564.178743 74593.5592   136%     -   88s
H    0     0                    33235.513854 74593.5592   124%     -   88s
H    0     0                    33543.725795 74593.5592   122%     -   88s
     0     0 74593.5592    0  340 33543.7258 74593.5592   122%     -   88s
     0     0 73861.5770    0  278 33543.7258 73861.5770   120%     -  128s
     0     0 73820.9619    0  281 33543.7258 73820.9619   120%     -  141s
     0     0 73820.9619    0  279 33543.7258 73820.9619   120%     -  147s
     0     0 73766.9526    0  279 33543.7258 73766.9526   120%     -  154s
     0     0 73763.5708    0  283 33543.7258 73763.5708   120%     -  156s
     0     0 73760.0592    0  285 33543.7258 73760.0592   120%     -  159s
     0     0 73758.4763    0  279 33543.7258 73758.4763   120%     -  160s
     0     0 73758.4754    0  279 33543.7258 73758.4754   120%     -  160s
H    0     0                    35162.000466 70076.1192  99.3%     -  263s
H    0     0                    35209.460010 70076.1192  99.0%     -  263s
H    0     0                    35506.980990 70076.1192  97.4%     -  263s
     0     0 70076.1192    0  375 35506.9810 70076.1192  97.4%     -  263s
H    0     0                    35589.023657 70076.1160  96.9%     -  263s
H    0     0                    35669.598960 70076.1160  96.5%     -  263s
     0     0 69512.8350    0  366 35669.5990 69512.8350  94.9%     -  301s
     0     0 69213.0435    0  376 35669.5990 69213.0435  94.0%     -  339s
     0     0 68852.9333    0  416 35669.5990 68852.9333  93.0%     -  365s
     0     0 68823.4032    0  397 35669.5990 68823.4032  92.9%     -  372s
     0     0 68814.6526    0  396 35669.5990 68814.6526  92.9%     -  378s
     0     0 68808.6903    0  403 35669.5990 68808.6903  92.9%     -  381s
     0     0 68806.0736    0  396 35669.5990 68806.0736  92.9%     -  384s
     0     0 68803.0780    0  394 35669.5990 68803.0780  92.9%     -  386s
     0     0 68799.9335    0  393 35669.5990 68799.9335  92.9%     -  389s
     0     0 68795.3765    0  391 35669.5990 68795.3765  92.9%     -  395s
     0     0 68794.3408    0  391 35669.5990 68794.3408  92.9%     -  397s
     0     0 66680.8281    0  363 35669.5990 66680.8281  86.9%     -  483s
H    0     0                    35902.268428 66680.4548  85.7%     -  484s
H    0     0                    36148.259388 66680.4548  84.5%     -  484s
H    0     0                    36614.146577 65998.9709  80.3%     -  531s
     0     0 65998.9709    0  464 36614.1466 65998.9709  80.3%     -  531s
     0     0 65781.8512    0  461 36614.1466 65781.8512  79.7%     -  560s
     0     0 65654.1258    0  472 36614.1466 65654.1258  79.3%     -  587s
     0     0 65573.5973    0  474 36614.1466 65573.5973  79.1%     -  605s
     0     0 65529.7394    0  481 36614.1466 65529.7394  79.0%     -  619s
     0     0 65490.6481    0  467 36614.1466 65490.6481  78.9%     -  629s
     0     0 65432.9952    0  482 36614.1466 65432.9952  78.7%     -  640s
     0     0 65425.6106    0  483 36614.1466 65425.6106  78.7%     -  645s
     0     0 65424.3520    0  484 36614.1466 65424.3520  78.7%     -  648s
     0     0 64197.1261    0  399 36614.1466 64197.1261  75.3%     -  717s
     0     0 63873.7766    0  458 36614.1466 63873.7766  74.5%     -  753s
     0     0 63741.6164    0  448 36614.1466 63741.6164  74.1%     -  776s
     0     0 63666.6786    0  458 36614.1466 63666.6786  73.9%     -  794s
     0     0 63592.0853    0  453 36614.1466 63592.0853  73.7%     -  804s
     0     0 63561.9721    0  452 36614.1466 63561.9721  73.6%     -  816s
     0     0 63533.8409    0  389 36614.1466 63533.8409  73.5%     -  825s
     0     0 63507.5203    0  389 36614.1466 63507.5203  73.5%     -  831s
     0     0 63502.3685    0  387 36614.1466 63502.3685  73.4%     -  835s
     0     0 63499.3311    0  390 36614.1466 63499.3311  73.4%     -  838s
     0     0 63496.9737    0  394 36614.1466 63496.9737  73.4%     -  841s
H    0     0                    36922.132778 63496.9737  72.0%     -  842s
     0     0 63208.2075    0  430 36922.1328 63208.2075  71.2%     -  870s
     0     0 63143.5657    0  443 36922.1328 63143.5657  71.0%     -  889s
     0     0 63106.9646    0  456 36922.1328 63106.9646  70.9%     -  904s
     0     0 63097.4289    0  443 36922.1328 63097.4289  70.9%     -  913s
     0     0 63073.5006    0  443 36922.1328 63073.5006  70.8%     -  924s
     0     0 63052.4728    0  449 36922.1328 63052.4728  70.8%     -  933s
     0     0 63044.2488    0  451 36922.1328 63044.2488  70.7%     -  938s
     0     0 63042.7746    0  457 36922.1328 63042.7746  70.7%     -  940s
     0     0 62881.5162    0  456 36922.1328 62881.5162  70.3%     -  962s
H    0     0                    37007.783923 62881.0458  69.9%     -  966s
     0     0 62854.2242    0  457 37007.7839 62854.2242  69.8%     -  977s
     0     0 62844.3258    0  515 37007.7839 62844.3258  69.8%     -  983s
     0     0 62837.5906    0  520 37007.7839 62837.5906  69.8%     -  987s
     0     0 62833.9311    0  522 37007.7839 62833.9311  69.8%     -  989s
     0     0 62829.5859    0  513 37007.7839 62829.5859  69.8%     -  992s
     0     0 62827.2182    0  513 37007.7839 62827.2182  69.8%     -  994s
     0     0 62785.6055    0  406 37007.7839 62785.6055  69.7%     - 1005s
H    0     0                    37032.668295 62784.7841  69.5%     - 1006s
     0     0 62749.8878    0  439 37032.6683 62749.8878  69.4%     - 1014s
     0     0 62746.4401    0  399 37032.6683 62746.4401  69.4%     - 1017s
     0     0 62745.2073    0  446 37032.6683 62745.2073  69.4%     - 1019s
     0     0 62721.8940    0  391 37032.6683 62721.8940  69.4%     - 1029s
H    0     0                    37151.399304 62716.1618  68.8%     - 1030s
H    0     0                    37365.463140 62716.1618  67.8%     - 1031s
     0     0 62710.1325    0  394 37365.4631 62710.1325  67.8%     - 1037s
     0     0 62707.7587    0  399 37365.4631 62707.7587  67.8%     - 1040s
     0     0 62643.9446    0  393 37365.4631 62643.9446  67.7%     - 1051s
     0     0 62633.7128    0  401 37365.4631 62633.7128  67.6%     - 1058s
     0     0 62633.0074    0  400 37365.4631 62633.0074  67.6%     - 1060s
     0     0 62628.7429    0  404 37365.4631 62628.7429  67.6%     - 1066s
H    0     0                    37626.854115 62628.5782  66.4%     - 1078s
     0     0 62621.8809    0  398 37626.8541 62621.8809  66.4%     - 1083s
     0     0 62619.2949    0  396 37626.8541 62619.2949  66.4%     - 1086s
     0     0 62616.0204    0  402 37626.8541 62616.0204  66.4%     - 1090s
     0     0 62615.9467    0  402 37626.8541 62615.9467  66.4%     - 1092s
     0     2 62615.9467    0  402 37626.8541 62615.9467  66.4%     - 1311s
     1     3 62474.2884    1  386 37626.8541 62615.9467  66.4%  8838 1324s
     2     4 62515.6311    1  385 37626.8541 62515.6311  66.1%  8268 1337s
     3     6 62356.0944    2  385 37626.8541 62513.2960  66.1%  7616 1383s
     5    10 62184.7034    3  379 37626.8541 62513.2960  66.1% 10410 1405s
     9    16 61702.3927    4  370 37626.8541 62355.0389  65.7% 10247 1494s
    15    30 61408.1673    5  392 37626.8541 62183.6318  65.3% 13850 1536s
    29    44 60198.8090    5  363 37626.8541 61702.2586  64.0% 20162 1636s
H   43    74                    37745.585125 61407.7281  62.7% 19220 1725s
    73   175 57181.5862    7  356 37745.5851 61407.7281  62.7% 16633 1863s
   174   272 57009.1958   10  353 37745.5851 61407.7281  62.7% 10927 1917s
   271   357 56390.4550   13  340 37745.5851 61407.7281  62.7%  8410 1964s
   356   441 56377.8800   14  338 37745.5851 61407.7281  62.7%  7428 2003s
   440   514 55910.5143   16  334 37745.5851 61407.7281  62.7%  6694 2038s
   513   544 55604.8074   17  329 37745.5851 61407.7281  62.7%  6198 2071s
   543   574 55411.0479   18  332 37745.5851 61407.7281  62.7%  6116 2112s
   573   613 55392.2972   19  330 37745.5851 61407.7281  62.7%  6029 2145s
   612   651 55097.2888   20  333 37745.5851 61407.7281  62.7%  5893 2172s
   650   692 55047.5888   21  330 37745.5851 61407.7281  62.7%  5730 2209s
   691   738 54829.6053   22  314 37745.5851 61407.7281  62.7%  5586 2240s
   737   788 54692.1489   23  307 37745.5851 61407.7281  62.7%  5432 2268s
   787   835 55950.2217   22  257 37745.5851 61407.7281  62.7%  5307 2307s
   834   895 54578.8278   24  305 37745.5851 61407.7281  62.7%  5167 2339s
   894   950 54471.3232   25  343 37745.5851 61407.7281  62.7%  4993 2371s
H  909   950                    37938.474556 61407.7281  61.9%  4957 2371s
   949   980 54438.0918   26  340 37938.4746 61407.7281  61.9%  4843 2410s
H  960   980                    38068.748629 61407.7281  61.3%  4830 2410s
   979  1088 54406.0563   27  341 38068.7486 61407.7281  61.3%  4814 2459s
  1095  1189 54165.4383   29  398 38068.7486 61407.7281  61.3%  4597 2502s
  1206  1294 53867.8035   31  360 38068.7486 61407.7281  61.3%  4441 2547s
  1315  1429 53732.9977   32  362 38068.7486 61407.7281  61.3%  4303 2598s
  1466  1540 53201.9073   34  329 38068.7486 61407.7281  61.3%  4090 2637s
  1614  1653 52979.0150   36  369 38068.7486 61407.7281  61.3%  3929 2683s
  1755  1779 52403.4726   38  368 38068.7486 61407.6656  61.3%  3808 2732s
  1915  1858 51240.3499   41  256 38068.7486 61407.6656  61.3%  3709 2787s
  2028  1899 49110.3342   43  277 38068.7486 61268.0401  60.9%  3687 2835s
  2098  1993 45510.7129   44  166 38068.7486 61268.0401  60.9%  3715 2884s
  2222  2114 45049.1741   47  146 38068.7486 61268.0401  60.9%  3680 2938s
  2371  2253 42746.5825   60  101 38068.7486 61009.3861  60.3%  3633 2992s
  2552  2361 41542.9249   75   78 38068.7486 61009.3861  60.3%  3556 3048s
  2704  2476 39717.5247   91   76 38068.7486 61009.3861  60.3%  3554 3103s
  2865  2602     cutoff  100      38068.7486 61009.3861  60.3%  3535 3169s
  3007  2762 60040.3389    7  348 38068.7486 60818.6252  59.8%  3544 3227s
  3195  2936 53634.5605    8  352 38068.7486 60818.6252  59.8%  3522 3297s

Cutting planes:
  Learned: 5
  Gomory: 28
  Implied bound: 152
  MIR: 2294
  Flow cover: 2377
  RLT: 90
  Relax-and-lift: 608

Explored 3423 nodes (12433413 simplex iterations) in 3600.05 seconds (5187.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 38068.7 37938.5 37745.6 ... 36614.1

Time limit reached
Best objective 3.806874862892e+04, best bound 6.081862515622e+04, gap 59.7600%
  WARNING: Time limit reached. Using best solution found (gap: 59.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 38068.75, θ = 206989.65
  Upper Bound (UB) = 38068.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206989.65
  [DEBUG]   ✓ Scenario 0: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206989.65 ≤ Q = 206989.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 206989.65 ≤ Q = 206989.65 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6a3a0ca4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x95c5f35c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.253606e+13
Presolve removed 2549 rows and 1839 columns
Presolve time: 0.01s
Presolved: 544 rows, 550 columns, 1536 nonzeros
Found heuristic solution: objective 6440800.2304
Variable types: 373 continuous, 177 integer (177 binary)
Found heuristic solution: objective 6440369.6540

Root relaxation: objective -1.694833e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169483.28    0  122 6440369.65 -169483.28   103%     -    0s
H    0     0                    -128664.0819 -169483.28  31.7%     -    0s
H    0     0                    -134806.5478 -169483.28  25.7%     -    0s
H    0     0                    -134902.0948 -169483.28  25.6%     -    0s
H    0     0                    -135588.7277 -169402.68  24.9%     -    0s
     0     0 -149164.76    0   97 -135588.73 -149164.76  10.0%     -    0s
H    0     0                    -144789.4091 -149063.06  2.95%     -    0s
H    0     0                    -145141.1431 -149063.06  2.70%     -    0s
H    0     0                    -145988.7435 -149063.06  2.11%     -    0s
H    0     0                    -146340.4776 -149063.06  1.86%     -    0s
     0     0 -147517.83    0  106 -146340.48 -147517.83  0.80%     -    0s
     0     0 -147478.19    0  106 -146340.48 -147478.19  0.78%     -    0s
     0     0 -147478.19    0  106 -146340.48 -147478.19  0.78%     -    0s
     0     0 -146982.43    0   56 -146340.48 -146982.43  0.44%     -    0s
     0     0 -146855.09    0   60 -146340.48 -146855.09  0.35%     -    0s
     0     0 -146776.33    0   64 -146340.48 -146776.33  0.30%     -    0s
     0     0 -146775.39    0   64 -146340.48 -146775.39  0.30%     -    0s
     0     0 -146723.32    0   62 -146340.48 -146723.32  0.26%     -    0s
     0     0 -146716.42    0   60 -146340.48 -146716.42  0.26%     -    0s
     0     0 -146713.09    0   61 -146340.48 -146713.09  0.25%     -    0s
     0     0 -146609.28    0   20 -146340.48 -146609.28  0.18%     -    0s
     0     0 -146609.17    0   19 -146340.48 -146609.17  0.18%     -    0s
     0     0 -146559.36    0   19 -146340.48 -146559.36  0.15%     -    0s
     0     0 -146558.95    0   19 -146340.48 -146558.95  0.15%     -    0s
     0     0 -146527.86    0   16 -146340.48 -146527.86  0.13%     -    0s
     0     0 -146527.86    0   38 -146340.48 -146527.86  0.13%     -    0s
     0     0 -146488.82    0   19 -146340.48 -146488.82  0.10%     -    0s
H    0     0                    -146400.6515 -146481.57  0.06%     -    0s
     0     0 -146454.85    0    6 -146400.65 -146454.85  0.04%     -    0s
     0     0 -146439.87    0    5 -146400.65 -146439.87  0.03%     -    0s
H    0     0                    -146406.9164 -146431.25  0.02%     -    0s
     0     0 -146427.83    0    2 -146406.92 -146427.83  0.01%     -    0s
     0     0 -146427.83    0    7 -146406.92 -146427.83  0.01%     -    0s
     0     0 -146427.83    0    6 -146406.92 -146427.83  0.01%     -    0s
H    0     0                    -146409.7133 -146427.83  0.01%     -    0s
H    0     0                    -146426.3347 -146427.83  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  Flow cover: 5

Explored 1 nodes (1091 simplex iterations) in 0.27 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -146426 -146410 -146407 ... -134902

Optimal solution found (tolerance 1.00e-04)
Best objective -1.464263347347e+05, best bound -1.464278294192e+05, gap 0.0010%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 195369.65
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146426.33
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -146426.33 = 195369.65
  [DEBUG]   Current θ from Master = 206989.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11620.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26448.75
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 1783.1514, Absolute Gap = 1783.1514, Relative Gap = 0.046840
  Not converged yet (gap = 1783.15 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481357 nonzeros
Model fingerprint: 0xc2cfcd19
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68031 rows and 27641 columns
Presolve time: 3.79s
Presolved: 101542 rows, 43259 columns, 613226 nonzeros
Variable types: 41000 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329616.5457
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.597e+06
 Factor NZ  : 1.019e+07 (roughly 140 MB of memory)
 Factor Ops : 1.857e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62666689e+07  1.81913228e+08  1.17e+05 1.93e+01  7.21e+04     6s
   1  -1.21733474e+07  1.63954047e+08  8.12e+04 7.29e+01  4.93e+04     6s
   2  -5.20362527e+06  1.23455712e+08  3.50e+04 1.39e-11  2.23e+04     6s
   3  -1.06209607e+06  9.63636307e+07  2.73e+03 9.88e-01  2.17e+03     6s
   4  -6.06392869e+05  4.99921170e+07  4.81e+02 2.89e-01  5.32e+02     6s
   5  -3.95455863e+05  3.06530670e+07  1.44e+02 1.23e-01  2.37e+02     6s
   6  -3.60357166e+05  2.19937119e+07  1.11e+02 4.80e-02  1.68e+02     6s
   7  -3.36342628e+05  1.80613844e+07  8.14e+01 3.82e-02  1.31e+02     6s
   8  -1.81385442e+05  1.33445350e+07  2.05e+01 2.66e-02  7.96e+01     7s
   9  -1.14513534e+05  9.37394953e+06  8.42e+00 1.81e-02  5.31e+01     7s
  10  -6.97245386e+04  4.92120280e+06  3.90e+00 9.32e-03  2.74e+01     7s
  11  -1.69861293e+04  8.13316234e+05  8.77e-01 1.20e-03  4.50e+00     7s
  12   5.90307352e+03  3.80447368e+05  5.64e-01 5.14e-04  2.02e+00     7s
  13   1.68666760e+04  2.33132833e+05  4.02e-01 6.48e-04  1.17e+00     7s
  14   2.44170388e+04  1.97855117e+05  3.33e-01 1.61e-03  9.36e-01     7s
  15   3.79037456e+04  1.67482405e+05  2.27e-01 1.40e-03  6.99e-01     7s
  16   4.63731878e+04  1.45616311e+05  1.71e-01 1.62e-03  5.35e-01     7s
  17   5.38201706e+04  1.27526859e+05  1.25e-01 1.71e-03  3.97e-01     7s
  18   6.00419713e+04  1.13756905e+05  8.95e-02 1.16e-03  2.89e-01     7s
  19   6.45262156e+04  1.05344360e+05  6.66e-02 9.33e-04  2.20e-01     8s
  20   6.86181989e+04  9.60940429e+04  4.74e-02 1.23e-03  1.48e-01     8s
  21   7.04502101e+04  9.14634443e+04  3.99e-02 1.40e-03  1.13e-01     8s
  22   7.15349956e+04  8.97561037e+04  3.55e-02 1.44e-03  9.82e-02     8s
  23   7.29668543e+04  8.73124552e+04  2.97e-02 1.14e-03  7.73e-02     8s
  24   7.41937944e+04  8.66082660e+04  2.48e-02 1.02e-03  6.69e-02     8s
  25   7.56052627e+04  8.46857455e+04  1.94e-02 6.88e-04  4.89e-02     8s
  26   7.68709224e+04  8.40313149e+04  1.45e-02 5.63e-04  3.86e-02     8s
  27   7.74790347e+04  8.33317480e+04  1.23e-02 4.34e-04  3.15e-02     9s
  28   7.81277981e+04  8.28325996e+04  9.87e-03 3.46e-04  2.54e-02     9s
  29   7.86351582e+04  8.21285964e+04  7.93e-03 2.21e-04  1.88e-02     9s
  30   7.90374374e+04  8.20388827e+04  6.46e-03 2.05e-04  1.62e-02     9s
  31   7.93850163e+04  8.16816826e+04  5.20e-03 1.46e-04  1.24e-02     9s
  32   7.98872647e+04  8.15026526e+04  3.42e-03 1.11e-04  8.70e-03     9s
  33   8.00984490e+04  8.13410361e+04  2.69e-03 7.92e-05  6.70e-03     9s
  34   8.03409590e+04  8.11970801e+04  1.90e-03 5.11e-05  4.61e-03    10s
  35   8.05442015e+04  8.11151061e+04  1.23e-03 4.70e-05  3.08e-03    10s
  36   8.06483920e+04  8.10819578e+04  8.88e-04 3.87e-05  2.34e-03    10s
  37   8.06836539e+04  8.10618025e+04  7.67e-04 3.39e-05  2.04e-03    10s
  38   8.07573066e+04  8.10088225e+04  5.20e-04 2.06e-05  1.36e-03    10s
  39   8.07654554e+04  8.09993439e+04  4.93e-04 2.03e-05  1.26e-03    10s
  40   8.08473364e+04  8.09871612e+04  2.21e-04 1.71e-05  7.53e-04    11s
  41   8.08651912e+04  8.09746465e+04  1.60e-04 1.38e-05  5.89e-04    11s
  42   8.08802922e+04  8.09491651e+04  1.14e-04 6.92e-06  3.71e-04    11s
  43   8.08924674e+04  8.09309752e+04  7.89e-05 2.41e-06  2.07e-04    11s
  44   8.08985777e+04  8.09267207e+04  6.13e-05 1.39e-06  1.52e-04    11s
  45   8.09030838e+04  8.09263941e+04  4.90e-05 1.30e-06  1.26e-04    11s
  46   8.09119094e+04  8.09242382e+04  2.43e-05 7.68e-07  6.64e-05    12s
  47   8.09186580e+04  8.09221962e+04  5.61e-06 2.73e-07  1.91e-05    12s
  48   8.09205637e+04  8.09212941e+04  1.02e-06 2.67e-07  3.93e-06    12s
  49   8.09209819e+04  8.09210018e+04  4.40e-08 7.18e-09  1.07e-07    12s
  50   8.09209919e+04  8.09209920e+04  4.30e-09 8.43e-10  3.22e-10    12s

Barrier solved model in 50 iterations and 12.05 seconds (9.29 work units)
Optimal objective 8.09209919e+04


Root crossover log...

   88246 DPushes remaining with DInf 0.0000000e+00                12s
   15110 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    3172 PPushes remaining with PInf 1.5338798e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.8552486e+00     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41888    8.0920992e+04   0.000000e+00   5.855249e+00     20s
   41926    8.0920992e+04   0.000000e+00   0.000000e+00     20s
   41926    8.0920992e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 1.31s

Solved with barrier

Root relaxation: objective 8.092099e+04, 41926 iterations, 16.69 seconds (21.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 80920.9920    0  266 -198441.04 80920.9920   141%     -   22s
H    0     0                    -196969.9812 80920.9920   141%     -   22s
H    0     0                    -170646.9816 80920.9920   147%     -   23s
H    0     0                    -170373.0642 80920.9920   147%     -   23s
H    0     0                    -156764.0644 80920.9920   152%     -   24s
H    0     0                    -156584.1941 80920.9920   152%     -   24s
H    0     0                    -57020.23094 80920.9920   242%     -   24s
H    0     0                    -56450.08065 80920.9920   243%     -   24s
H    0     0                    -55793.93869 80920.9920   245%     -   25s
H    0     0                    -16747.57240 80920.9920   583%     -   25s
H    0     0                    -11647.41353 80920.9920   795%     -   25s
H    0     0                    8785.8682985 80920.9920   821%     -   26s
H    0     0                    9510.9094152 80920.9920   751%     -   26s
H    0     0                    9981.9965773 80920.9920   711%     -   27s
H    0     0                    10213.272210 80920.9920   692%     -   27s
H    0     0                    10415.554153 80920.9920   677%     -   27s
H    0     0                    10462.837863 80920.9920   673%     -   27s
H    0     0                    18291.682801 80920.9920   342%     -   29s
H    0     0                    23047.025704 80920.9920   251%     -   29s
H    0     0                    23226.107038 80920.9920   248%     -   29s
H    0     0                    23228.570519 80920.9920   248%     -   29s
H    0     0                    23272.321612 80920.9920   248%     -   29s
H    0     0                    23282.150112 80920.9920   248%     -   29s
H    0     0                    23342.175393 80920.9920   247%     -   29s
     0     0 73150.5035    0  303 23342.1754 73150.5035   213%     -  130s
H    0     0                    24022.232253 73150.5035   205%     -  131s
H    0     0                    25983.470689 73150.5035   182%     -  132s
H    0     0                    26292.662534 73150.5035   178%     -  132s
H    0     0                    26528.429101 73150.5035   176%     -  132s
     0     0 72722.2781    0  290 26528.4291 72722.2781   174%     -  194s
     0     0 72550.4113    0  293 26528.4291 72550.4113   173%     -  226s
     0     0 72530.1719    0  282 26528.4291 72530.1719   173%     -  237s
     0     0 72525.4537    0  286 26528.4291 72525.4537   173%     -  245s
     0     0 72525.4537    0  301 26528.4291 72525.4537   173%     -  255s
     0     0 72525.4537    0  298 26528.4291 72525.4537   173%     -  273s
     0     0 72458.7685    0  310 26528.4291 72458.7685   173%     -  295s
     0     0 72456.3149    0  359 26528.4291 72456.3149   173%     -  300s
     0     0 72454.7672    0  359 26528.4291 72454.7672   173%     -  301s
     0     0 72454.7580    0  359 26528.4291 72454.7580   173%     -  301s
H    0     0                    34031.130179 69318.6203   104%     -  408s
H    0     0                    34550.064428 69318.6203   101%     -  408s
     0     0 69318.6203    0  419 34550.0644 69318.6203   101%     -  409s
H    0     0                    34715.723463 69318.3739   100%     -  409s
     0     0 68714.9104    0  413 34715.7235 68714.9104  97.9%     -  476s
     0     0 68508.1107    0  424 34715.7235 68508.1107  97.3%     -  526s
     0     0 68370.4124    0  448 34715.7235 68370.4124  96.9%     -  553s
     0     0 68338.9721    0  467 34715.7235 68338.9721  96.9%     -  572s
     0     0 68294.6667    0  460 34715.7235 68294.6667  96.7%     -  584s
H    0     0                    34798.510050 68235.7899  96.1%     -  603s
     0     0 68235.7899    0  459 34798.5101 68235.7899  96.1%     -  603s
     0     0 68210.0291    0  460 34798.5101 68210.0291  96.0%     -  619s
     0     0 68191.8143    0  452 34798.5101 68191.8143  96.0%     -  626s
     0     0 68168.8416    0  456 34798.5101 68168.8416  95.9%     -  634s
     0     0 68165.4201    0  454 34798.5101 68165.4201  95.9%     -  637s
     0     0 68164.0441    0  454 34798.5101 68164.0441  95.9%     -  638s
     0     0 66226.8583    0  374 34798.5101 66226.8583  90.3%     -  747s
H    0     0                    35061.431711 66226.2422  88.9%     -  749s
H    0     0                    35191.511424 66226.2422  88.2%     -  749s
H    0     0                    35780.859112 66226.2422  85.1%     -  749s
H    0     0                    35840.996883 66226.2422  84.8%     -  749s
     0     0 65520.2967    0  357 35840.9969 65520.2967  82.8%     -  810s
     0     0 65398.7908    0  361 35840.9969 65398.7908  82.5%     -  837s
     0     0 65330.0608    0  377 35840.9969 65330.0608  82.3%     -  856s
     0     0 65271.1301    0  360 35840.9969 65271.1301  82.1%     -  874s
     0     0 65228.4981    0  366 35840.9969 65228.4981  82.0%     -  888s
     0     0 65191.2457    0  374 35840.9969 65191.2457  81.9%     -  901s
     0     0 65178.1819    0  373 35840.9969 65178.1819  81.9%     -  911s
     0     0 65171.3716    0  372 35840.9969 65171.3716  81.8%     -  914s
     0     0 65153.1224    0  372 35840.9969 65153.1224  81.8%     -  921s
     0     0 65138.8692    0  377 35840.9969 65138.8692  81.7%     -  926s
     0     0 65135.7628    0  375 35840.9969 65135.7628  81.7%     -  928s
     0     0 65131.8528    0  377 35840.9969 65131.8528  81.7%     -  930s
     0     0 65129.5911    0  369 35840.9969 65129.5911  81.7%     -  932s
     0     0 64160.0411    0  365 35840.9969 64160.0411  79.0%     - 1023s
     0     0 63904.2401    0  449 35840.9969 63904.2401  78.3%     - 1062s
     0     0 63819.2453    0  445 35840.9969 63819.2453  78.1%     - 1085s
     0     0 63705.7059    0  463 35840.9969 63705.7059  77.7%     - 1116s
     0     0 63690.3811    0  483 35840.9969 63690.3811  77.7%     - 1133s
     0     0 63666.0223    0  465 35840.9969 63666.0223  77.6%     - 1145s
     0     0 63658.1466    0  471 35840.9969 63658.1466  77.6%     - 1155s
     0     0 63649.4699    0  473 35840.9969 63649.4699  77.6%     - 1164s
     0     0 63642.4927    0  471 35840.9969 63642.4927  77.6%     - 1172s
     0     0 63636.2870    0  478 35840.9969 63636.2870  77.6%     - 1181s
     0     0 63633.3176    0  399 35840.9969 63633.3176  77.5%     - 1184s
     0     0 63630.6606    0  472 35840.9969 63630.6606  77.5%     - 1189s
     0     0 63374.1090    0  465 35840.9969 63374.1090  76.8%     - 1239s
H    0     0                    36377.556886 63373.9873  74.2%     - 1240s
H    0     0                    36399.704161 63373.9873  74.1%     - 1240s
     0     0 63323.9358    0  403 36399.7042 63323.9358  74.0%     - 1257s
     0     0 63311.1012    0  398 36399.7042 63311.1012  73.9%     - 1267s
     0     0 63284.1934    0  396 36399.7042 63284.1934  73.9%     - 1278s
     0     0 63259.5897    0  391 36399.7042 63259.5897  73.8%     - 1291s
     0     0 63248.1145    0  394 36399.7042 63248.1145  73.8%     - 1300s
     0     0 63238.6499    0  396 36399.7042 63238.6499  73.7%     - 1307s
     0     0 63218.9051    0  395 36399.7042 63218.9051  73.7%     - 1315s
     0     0 63204.4849    0  436 36399.7042 63204.4849  73.6%     - 1325s
     0     0 63199.9643    0  404 36399.7042 63199.9643  73.6%     - 1331s
     0     0 63199.5248    0  402 36399.7042 63199.5248  73.6%     - 1332s
     0     0 63052.0831    0  456 36399.7042 63052.0831  73.2%     - 1358s
H    0     0                    36556.411620 63051.2680  72.5%     - 1358s
     0     0 63008.1567    0  422 36556.4116 63008.1567  72.4%     - 1368s
     0     0 62995.2272    0  491 36556.4116 62995.2272  72.3%     - 1376s
     0     0 62977.6505    0  502 36556.4116 62977.6505  72.3%     - 1383s
     0     0 62972.5477    0  505 36556.4116 62972.5477  72.3%     - 1388s
     0     0 62970.3425    0  500 36556.4116 62970.3425  72.3%     - 1390s
     0     0 62875.2327    0  419 36556.4116 62875.2327  72.0%     - 1409s
     0     0 62852.1263    0  422 36556.4116 62852.1263  71.9%     - 1417s
     0     0 62843.6103    0  402 36556.4116 62843.6103  71.9%     - 1424s
     0     0 62838.2181    0  389 36556.4116 62838.2181  71.9%     - 1427s
     0     0 62836.6966    0  394 36556.4116 62836.6966  71.9%     - 1430s
     0     0 62789.7767    0  404 36556.4116 62789.7767  71.8%     - 1450s
     0     0 62782.2275    0  467 36556.4116 62782.2275  71.7%     - 1458s
     0     0 62777.7564    0  469 36556.4116 62777.7564  71.7%     - 1466s
     0     0 62775.1727    0  400 36556.4116 62775.1727  71.7%     - 1471s
     0     0 62759.6550    0  399 36556.4116 62759.6550  71.7%     - 1484s
     0     0 62741.9704    0  440 36556.4116 62741.9704  71.6%     - 1501s
     0     0 62733.0020    0  430 36556.4116 62733.0020  71.6%     - 1507s
     0     0 62732.0818    0  433 36556.4116 62732.0818  71.6%     - 1510s
     0     0 62716.4853    0  428 36556.4116 62716.4853  71.6%     - 1521s
     0     0 62711.8608    0  429 36556.4116 62711.8608  71.5%     - 1529s
     0     0 62703.8441    0  436 36556.4116 62703.8441  71.5%     - 1538s
     0     0 62703.1691    0  431 36556.4116 62703.1691  71.5%     - 1540s
     0     0 62693.0787    0  437 36556.4116 62693.0787  71.5%     - 1549s
     0     0 62688.6544    0  519 36556.4116 62688.6544  71.5%     - 1556s
     0     0 62684.1703    0  507 36556.4116 62684.1703  71.5%     - 1564s
     0     0 62683.8287    0  506 36556.4116 62683.8287  71.5%     - 1565s
     0     0 62659.1066    0  443 36556.4116 62659.1066  71.4%     - 1579s
     0     0 62651.7225    0  477 36556.4116 62651.7225  71.4%     - 1592s
     0     0 62649.7262    0  495 36556.4116 62649.7262  71.4%     - 1600s
     0     0 62641.4313    0  420 36556.4116 62641.4313  71.4%     - 1609s
     0     0 62639.5003    0  418 36556.4116 62639.5003  71.4%     - 1615s
     0     0 62613.8896    0  465 36556.4116 62613.8896  71.3%     - 1631s
     0     0 62613.7807    0  465 36556.4116 62613.7807  71.3%     - 1635s
H    0     0                    36565.889546 62613.1353  71.2%     - 1768s
H    0     0                    36580.216828 62613.1353  71.2%     - 1768s
H    0     0                    36632.886875 62613.1353  70.9%     - 1768s
H    0     0                    36643.556393 62613.1353  70.9%     - 1768s
H    0     0                    37007.026721 62613.1353  69.2%     - 1768s
H    0     0                    37055.529670 62613.1353  69.0%     - 1768s
H    0     0                    37066.417660 62613.1353  68.9%     - 1768s
H    0     0                    37127.682966 62612.9582  68.6%     - 1944s
     0     2 62612.9582    0  465 37127.6830 62612.9582  68.6%     - 2337s
     1     4 62431.9792    1  451 37127.6830 62612.5166  68.6% 16588 2377s
     3     8 62313.5675    2  489 37127.6830 62431.9781  68.2% 17221 2439s
     7    16 62117.1443    3  451 37127.6830 62313.5122  67.8% 17587 2562s
    15    32 61687.5553    4  409 37127.6830 62116.6969  67.3% 21771 2626s
    31    47 61022.5083    5  394 37127.6830 61687.2049  66.1% 27232 3600s

Cutting planes:
  Learned: 2
  Gomory: 18
  Implied bound: 254
  MIR: 2630
  Flow cover: 2415
  RLT: 91
  Relax-and-lift: 555

Explored 46 nodes (2114901 simplex iterations) in 3600.18 seconds (4711.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 37127.7 37066.4 37055.5 ... 36399.7

Time limit reached
Best objective 3.712768296581e+04, best bound 6.168720493837e+04, gap 66.1488%
  WARNING: Time limit reached. Using best solution found (gap: 66.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = 37127.68, θ = 205698.84
  Upper Bound (UB) = 37127.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205698.84
  [DEBUG]   ✓ Scenario 0: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205698.84 ≤ Q = 205698.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 205698.84 ≤ Q = 205698.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x50d04be5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaf2fb41b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.252072e+13
Presolve removed 2555 rows and 1844 columns
Presolve time: 0.01s
Presolved: 538 rows, 545 columns, 1520 nonzeros
Found heuristic solution: objective 6364581.8887
Variable types: 369 continuous, 176 integer (176 binary)
Found heuristic solution: objective 6363699.3994

Root relaxation: objective -1.725987e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -172598.73    0  127 6363699.40 -172598.73   103%     -    0s
H    0     0                    -133383.6099 -172598.73  29.4%     -    0s
H    0     0                    -136817.2226 -149484.09  9.26%     -    0s
H    0     0                    -141844.1169 -149484.09  5.39%     -    0s
     0     0 -149484.09    0   98 -141844.12 -149484.09  5.39%     -    0s
H    0     0                    -145158.8811 -149379.14  2.91%     -    0s
H    0     0                    -145433.3877 -149379.14  2.71%     -    0s
H    0     0                    -146396.5308 -149379.14  2.04%     -    0s
H    0     0                    -146671.0373 -149379.14  1.85%     -    0s
     0     0 -149221.08    0  101 -146671.04 -149221.08  1.74%     -    0s
     0     0 -149214.51    0  101 -146671.04 -149214.51  1.73%     -    0s
     0     0 -148228.98    0   60 -146671.04 -148228.98  1.06%     -    0s
H    0     0                    -147379.3009 -148219.68  0.57%     -    0s
     0     0 -148201.77    0   60 -147379.30 -148201.77  0.56%     -    0s
H    0     0                    -147427.9085 -148201.77  0.52%     -    0s
     0     0 -147861.95    0   55 -147427.91 -147861.95  0.29%     -    0s
     0     0 -147824.34    0   53 -147427.91 -147824.34  0.27%     -    0s
     0     0 -147816.14    0   53 -147427.91 -147816.14  0.26%     -    0s
H    0     0                    -147458.6649 -147747.03  0.20%     -    0s
     0     0 -147747.03    0   34 -147458.66 -147747.03  0.20%     -    0s
H    0     0                    -147589.4605 -147745.73  0.11%     -    0s
     0     0 -147729.13    0   30 -147589.46 -147729.13  0.09%     -    0s
     0     0 -147729.09    0   29 -147589.46 -147729.09  0.09%     -    0s
     0     0 -147674.41    0   22 -147589.46 -147674.41  0.06%     -    0s
     0     0 -147674.41    0   51 -147589.46 -147674.41  0.06%     -    0s
     0     0 -147667.55    0   12 -147589.46 -147667.55  0.05%     -    0s
     0     0 -147661.74    0    8 -147589.46 -147661.74  0.05%     -    0s
     0     0 -147638.55    0    9 -147589.46 -147638.55  0.03%     -    0s
     0     0          -    0      -147589.46 -147590.11  0.00%     -    0s

Cutting planes:
  Gomory: 20
  Implied bound: 12
  MIR: 31
  Flow cover: 16
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (870 simplex iterations) in 0.15 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -147589 -147459 -147428 ... 6.3637e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.475894604557e+05, best bound -1.475901100345e+05, gap 0.0004%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 194206.53
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147589.46
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -147589.46 = 194206.53
  [DEBUG]   Current θ from Master = 205698.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11492.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25635.37
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 842.0857, Absolute Gap = 842.0857, Relative Gap = 0.022681
  Not converged yet (gap = 842.09 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524615 nonzeros
Model fingerprint: 0xcbc59f6c
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74212 rows and 30152 columns
Presolve time: 3.58s
Presolved: 110651 rows, 46988 columns, 666203 nonzeros
Variable types: 44729 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -331363.2010
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 665
 AA' NZ     : 3.831e+06
 Factor NZ  : 9.291e+06 (roughly 140 MB of memory)
 Factor Ops : 1.776e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69960094e+07  1.96401533e+08  1.22e+05 1.86e+01  7.49e+04     6s
   1  -1.27628410e+07  1.78317106e+08  8.50e+04 7.32e+01  5.14e+04     6s
   2  -3.76664236e+06  1.33629815e+08  2.57e+04 6.28e-01  1.65e+04     6s
   3  -9.00310623e+05  9.86394019e+07  2.85e+03 1.10e+00  2.19e+03     6s
   4  -4.89057034e+05  5.07123252e+07  5.38e+02 3.85e-01  5.41e+02     6s
   5  -3.78924731e+05  3.34109487e+07  2.34e+02 2.24e-01  2.81e+02     6s
   6  -3.11096366e+05  2.38569305e+07  1.01e+02 1.48e-01  1.64e+02     6s
   7  -2.50388258e+05  1.85068526e+07  5.85e+01 1.10e-01  1.16e+02     6s
   8  -1.36594818e+05  1.19154970e+07  7.76e+00 6.71e-02  6.19e+01     6s
   9  -8.27101995e+04  7.93245055e+06  3.58e+00 4.55e-02  4.04e+01     7s
  10  -4.42465701e+04  2.86275432e+06  1.54e+00 1.56e-02  1.45e+01     7s
  11  -8.58036917e+03  1.35740385e+06  6.42e-01 7.01e-03  6.78e+00     7s
  12   9.72057475e+03  7.90615575e+05  4.04e-01 3.91e-03  3.87e+00     7s
  13   1.67585353e+04  4.74763644e+05  2.91e-01 2.33e-03  2.27e+00     7s
  14   2.31620636e+04  2.92869518e+05  2.30e-01 1.35e-03  1.33e+00     7s
  15   2.67671091e+04  2.34454988e+05  1.95e-01 9.08e-04  1.03e+00     7s
  16   4.32124644e+04  1.77110525e+05  1.13e-01 2.02e-03  6.62e-01     7s
  17   4.93165381e+04  1.42649231e+05  9.09e-02 3.16e-03  4.62e-01     7s
  18   5.63741330e+04  1.27245689e+05  6.83e-02 2.06e-03  3.50e-01     7s
  19   6.14888308e+04  1.15365668e+05  5.28e-02 2.12e-03  2.66e-01     7s
  20   6.49608954e+04  1.07123496e+05  4.31e-02 1.07e-03  2.08e-01     8s
  21   6.60692157e+04  9.91882657e+04  4.00e-02 1.24e-03  1.64e-01     8s
  22   6.96369250e+04  9.71868184e+04  3.08e-02 1.09e-03  1.36e-01     8s
  23   6.98324122e+04  9.40144371e+04  3.02e-02 8.64e-04  1.20e-01     8s
  24   7.19447559e+04  9.07404645e+04  2.48e-02 6.35e-04  9.30e-02     8s
  25   7.42140794e+04  8.90263848e+04  1.92e-02 4.64e-04  7.33e-02     8s
  26   7.54493714e+04  8.86533143e+04  1.62e-02 4.56e-04  6.53e-02     8s
  27   7.73461540e+04  8.68021983e+04  1.17e-02 3.19e-04  4.68e-02     8s
  28   7.79707116e+04  8.64442949e+04  1.01e-02 2.93e-04  4.19e-02     9s
  29   7.86757802e+04  8.60404911e+04  8.50e-03 2.64e-04  3.64e-02     9s
  30   7.87844389e+04  8.59609495e+04  8.24e-03 2.60e-04  3.55e-02     9s
  31   7.92364584e+04  8.49540851e+04  7.16e-03 1.87e-04  2.83e-02     9s
  32   7.99291879e+04  8.47141093e+04  5.53e-03 1.70e-04  2.37e-02     9s
  33   8.01475936e+04  8.45100487e+04  5.02e-03 1.51e-04  2.16e-02     9s
  34   8.08364332e+04  8.38809397e+04  3.44e-03 1.07e-04  1.51e-02     9s
  35   8.12982268e+04  8.36476203e+04  2.39e-03 8.83e-05  1.16e-02    10s
  36   8.14855163e+04  8.32235486e+04  1.98e-03 5.59e-05  8.59e-03    10s
  37   8.17144020e+04  8.30790233e+04  1.48e-03 4.64e-05  6.75e-03    10s
  38   8.19929010e+04  8.29469752e+04  8.90e-04 3.64e-05  4.72e-03    10s
  39   8.21052078e+04  8.28083386e+04  6.61e-04 2.63e-05  3.48e-03    10s
  40   8.21690824e+04  8.27376580e+04  5.34e-04 2.09e-05  2.81e-03    10s
  41   8.22440426e+04  8.26129906e+04  3.86e-04 1.17e-05  1.82e-03    10s
  42   8.22800257e+04  8.25782287e+04  3.17e-04 9.06e-06  1.47e-03    11s
  43   8.23116802e+04  8.25170019e+04  2.58e-04 8.50e-06  1.02e-03    11s
  44   8.23673572e+04  8.25045925e+04  1.55e-04 6.52e-06  6.79e-04    11s
  45   8.24122303e+04  8.24813713e+04  7.02e-05 3.32e-06  3.42e-04    11s
  46   8.24336471e+04  8.24685640e+04  3.44e-05 1.67e-06  1.73e-04    11s
  47   8.24375554e+04  8.24636631e+04  2.80e-05 9.15e-07  1.29e-04    11s
  48   8.24455706e+04  8.24602726e+04  1.51e-05 4.60e-07  7.27e-05    11s
  49   8.24513490e+04  8.24589662e+04  6.15e-06 3.29e-07  3.77e-05    12s
  50   8.24531637e+04  8.24574063e+04  3.48e-06 1.81e-07  2.10e-05    12s
  51   8.24535139e+04  8.24567338e+04  2.95e-06 1.15e-07  1.59e-05    12s
  52   8.24549869e+04  8.24560414e+04  7.27e-07 4.89e-08  5.21e-06    12s
  53   8.24552800e+04  8.24557921e+04  3.32e-07 2.48e-08  2.53e-06    12s
  54   8.24553135e+04  8.24555424e+04  2.87e-07 3.95e-08  1.13e-06    13s
  55   8.24555100e+04  8.24555364e+04  5.44e-08 1.73e-08  1.30e-07    13s
  56   8.24555230e+04  8.24555329e+04  1.83e-07 8.71e-09  4.90e-08    13s
  57   8.24555279e+04  8.24555295e+04  4.06e-08 1.45e-09  7.98e-09    13s
  58   8.24555282e+04  8.24555295e+04  1.16e-06 1.56e-08  6.05e-09    13s
  59   8.24555287e+04  8.24555291e+04  7.80e-07 1.38e-07  2.04e-09    14s

Barrier solved model in 59 iterations and 13.58 seconds (11.73 work units)
Optimal objective 8.24555287e+04


Root crossover log...

   94770 DPushes remaining with DInf 0.0000000e+00                14s
   40273 DPushes remaining with DInf 0.0000000e+00                15s
    5028 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

   17466 PPushes remaining with PInf 8.8766605e-05                22s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7166407e+04     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60986    8.2455528e+04   0.000000e+00   2.716641e+04     25s
   61173    8.2455528e+04   0.000000e+00   5.079404e+02     25s
   61696    8.2455529e+04   0.000000e+00   0.000000e+00     26s
   61696    8.2455529e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 7.94s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.245553e+04, 61696 iterations, 29.53 seconds (33.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82455.5291    0  286 -198441.04 82455.5291   142%     -   35s
H    0     0                    -188198.9783 82455.5291   144%     -   35s
H    0     0                    -146314.4773 82455.5291   156%     -   35s
H    0     0                    -146102.3477 82455.5291   156%     -   35s
H    0     0                    -131810.2149 82455.5291   163%     -   35s
H    0     0                    -113602.7983 82455.5291   173%     -   35s
H    0     0                    -44572.66045 82455.5291   285%     -   35s
H    0     0                    1527.8490310 82455.5291  5297%     -   36s
H    0     0                    3362.6224564 82455.5291  2352%     -   36s
H    0     0                    10761.041280 82455.5291   666%     -   36s
H    0     0                    12381.672724 82455.5291   566%     -   37s
H    0     0                    13393.827029 82455.5291   516%     -   37s
H    0     0                    13616.900436 82455.5291   506%     -   37s
H    0     0                    22980.674962 82455.5291   259%     -   39s
H    0     0                    24503.207180 82455.5291   237%     -   39s
H    0     0                    25006.309659 82455.5291   230%     -   39s
H    0     0                    25357.746506 82455.5291   225%     -   39s
H    0     0                    26127.559769 82455.5291   216%     -   39s
     0     0 75664.8904    0  285 26127.5598 75664.8904   190%     -  158s
H    0     0                    28328.786332 75652.0515   167%     -  159s
H    0     0                    28458.674852 75652.0515   166%     -  159s
H    0     0                    28991.617904 75652.0515   161%     -  159s
H    0     0                    29664.694251 75652.0515   155%     -  159s
H    0     0                    31487.642011 74905.1241   138%     -  229s
H    0     0                    31799.688541 74905.1241   136%     -  229s
H    0     0                    31996.492676 74905.1241   134%     -  229s
     0     0 74905.1241    0  304 31996.4927 74905.1241   134%     -  229s
     0     0 74751.2487    0  309 31996.4927 74751.2487   134%     -  270s
     0     0 74675.2788    0  313 31996.4927 74675.2788   133%     -  289s
     0     0 74594.3910    0  315 31996.4927 74594.3910   133%     -  300s
     0     0 74582.3821    0  319 31996.4927 74582.3821   133%     -  312s
     0     0 74582.3821    0  305 31996.4927 74582.3821   133%     -  327s
     0     0 74582.3821    0  314 31996.4927 74582.3821   133%     -  339s
     0     0 74582.3821    0  296 31996.4927 74582.3821   133%     -  361s
     0     0 74569.4152    0  303 31996.4927 74569.4152   133%     -  385s
     0     0 74568.7171    0  303 31996.4927 74568.7171   133%     -  386s
H    0     0                    32179.517363 70839.4561   120%     -  535s
H    0     0                    33099.759211 70839.4561   114%     -  535s
H    0     0                    33116.557587 70839.4561   114%     -  535s
H    0     0                    33530.050493 70839.4561   111%     -  535s
H    0     0                    33532.153735 70839.4561   111%     -  535s
H    0     0                    33550.122351 70839.4561   111%     -  535s
H    0     0                    33613.377505 70839.4561   111%     -  535s
H    0     0                    34084.929941 70839.4561   108%     -  535s
H    0     0                    35486.042867 70839.4561   100%     -  535s
     0     0 70839.4561    0  395 35486.0429 70839.4561   100%     -  535s
H    0     0                    36123.358743 70839.4097  96.1%     -  536s
     0     0 69878.4156    0  435 36123.3587 69878.4156  93.4%     -  636s
     0     0 69625.2764    0  421 36123.3587 69625.2764  92.7%     -  675s
     0     0 69360.1683    0  442 36123.3587 69360.1683  92.0%     -  710s
     0     0 69278.9222    0  433 36123.3587 69278.9222  91.8%     -  733s
     0     0 69177.3350    0  406 36123.3587 69177.3350  91.5%     -  752s
     0     0 69150.8602    0  424 36123.3587 69150.8602  91.4%     -  769s
     0     0 69146.3997    0  426 36123.3587 69146.3997  91.4%     -  774s
     0     0 69145.2343    0  422 36123.3587 69145.2343  91.4%     -  775s
     0     0 66450.8658    0  424 36123.3587 66450.8658  84.0%     -  980s
     0     0 65968.1622    0  370 36123.3587 65968.1622  82.6%     - 1057s
     0     0 65775.3851    0  458 36123.3587 65775.3851  82.1%     - 1094s
     0     0 65672.0220    0  454 36123.3587 65672.0220  81.8%     - 1124s
     0     0 65623.8186    0  453 36123.3587 65623.8186  81.7%     - 1152s
     0     0 65611.6068    0  453 36123.3587 65611.6068  81.6%     - 1166s
     0     0 65596.6561    0  454 36123.3587 65596.6561  81.6%     - 1178s
     0     0 65582.1668    0  452 36123.3587 65582.1668  81.6%     - 1190s
     0     0 65578.9148    0  459 36123.3587 65578.9148  81.5%     - 1198s
     0     0 65549.3394    0  485 36123.3587 65549.3394  81.5%     - 1214s
     0     0 65529.2649    0  477 36123.3587 65529.2649  81.4%     - 1225s
     0     0 65521.7002    0  455 36123.3587 65521.7002  81.4%     - 1231s
     0     0 65517.2678    0  462 36123.3587 65517.2678  81.4%     - 1236s
     0     0 65516.0118    0  452 36123.3587 65516.0118  81.4%     - 1241s
     0     0 64314.5569    0  387 36123.3587 64314.5569  78.0%     - 1361s
     0     0 63924.2278    0  391 36123.3587 63924.2278  77.0%     - 1407s
     0     0 63792.7795    0  393 36123.3587 63792.7795  76.6%     - 1438s
     0     0 63735.1865    0  399 36123.3587 63735.1865  76.4%     - 1456s
     0     0 63651.9519    0  406 36123.3587 63651.9519  76.2%     - 1474s
     0     0 63628.0371    0  395 36123.3587 63628.0371  76.1%     - 1484s
     0     0 63588.6122    0  393 36123.3587 63588.6122  76.0%     - 1502s
     0     0 63575.4989    0  393 36123.3587 63575.4989  76.0%     - 1516s
     0     0 63570.8962    0  391 36123.3587 63570.8962  76.0%     - 1521s
     0     0 63566.9976    0  377 36123.3587 63566.9976  76.0%     - 1525s
     0     0 63560.6229    0  380 36123.3587 63560.6229  76.0%     - 1530s
     0     0 63558.1009    0  382 36123.3587 63558.1009  75.9%     - 1532s
     0     0 63321.5588    0  390 36123.3587 63321.5588  75.3%     - 1568s
     0     0 63270.1591    0  393 36123.3587 63270.1591  75.2%     - 1587s
     0     0 63245.2933    0  384 36123.3587 63245.2933  75.1%     - 1599s
     0     0 63227.1076    0  391 36123.3587 63227.1076  75.0%     - 1608s
     0     0 63220.2691    0  408 36123.3587 63220.2691  75.0%     - 1617s
     0     0 63209.6154    0  390 36123.3587 63209.6154  75.0%     - 1622s
     0     0 63207.7708    0  399 36123.3587 63207.7708  75.0%     - 1627s
     0     0 63146.8390    0  405 36123.3587 63146.8390  74.8%     - 1645s
     0     0 63123.0058    0  395 36123.3587 63123.0058  74.7%     - 1662s
     0     0 63113.6252    0  400 36123.3587 63113.6252  74.7%     - 1668s
     0     0 63112.1996    0  408 36123.3587 63112.1996  74.7%     - 1672s
     0     0 63031.4952    0  465 36123.3587 63031.4952  74.5%     - 1695s
     0     0 62995.5872    0  461 36123.3587 62995.5872  74.4%     - 1712s
     0     0 62988.2916    0  438 36123.3587 62988.2916  74.4%     - 1721s
     0     0 62981.9850    0  437 36123.3587 62981.9850  74.4%     - 1728s
     0     0 62976.4338    0  436 36123.3587 62976.4338  74.3%     - 1737s
     0     0 62968.9323    0  430 36123.3587 62968.9323  74.3%     - 1746s
     0     0 62962.1490    0  439 36123.3587 62962.1490  74.3%     - 1752s
     0     0 62956.7647    0  439 36123.3587 62956.7647  74.3%     - 1759s
     0     0 62955.3754    0  445 36123.3587 62955.3754  74.3%     - 1764s
     0     0 62903.5380    0  493 36123.3587 62903.5380  74.1%     - 1784s
H    0     0                    36163.570860 62882.8814  73.9%     - 1803s
     0     0 62882.8814    0  507 36163.5709 62882.8814  73.9%     - 1803s
     0     0 62877.4874    0  400 36163.5709 62877.4874  73.9%     - 1810s
     0     0 62872.6585    0  519 36163.5709 62872.6585  73.9%     - 1815s
     0     0 62870.0186    0  504 36163.5709 62870.0186  73.8%     - 1821s
     0     0 62814.1072    0  463 36163.5709 62814.1072  73.7%     - 1838s
     0     0 62802.9703    0  516 36163.5709 62802.9703  73.7%     - 1849s
     0     0 62800.7206    0  523 36163.5709 62800.7206  73.7%     - 1853s
     0     0 62786.5613    0  517 36163.5709 62786.5613  73.6%     - 1866s
     0     0 62782.9915    0  518 36163.5709 62782.9915  73.6%     - 1873s
     0     0 62781.9310    0  531 36163.5709 62781.9310  73.6%     - 1878s
     0     0 62768.6283    0  464 36163.5709 62768.6283  73.6%     - 1888s
     0     0 62768.4735    0  464 36163.5709 62768.4735  73.6%     - 1892s
H    0     0                    36278.082156 62768.4735  73.0%     - 2101s
H    0     0                    36522.975741 62768.4735  71.9%     - 2101s
H    0     0                    36624.575638 62768.4735  71.4%     - 2221s
     0     2 62768.4735    0  464 36624.5756 62768.4735  71.4%     - 2224s
     1     3 61351.0139    1  487 36624.5756 62768.4735  71.4% 24690 2278s
     2     4 62650.9757    1  452 36624.5756 62650.9757  71.1% 19069 2301s
     3     7 60731.3721    2  380 36624.5756 62648.4307  71.1% 16009 2345s
     6    13 62026.5241    3  479 36624.5756 62648.4307  71.1% 16698 2399s
    12    25 61969.9418    4  445 36624.5756 62215.4657  69.9% 17123 2451s
    24    37 61052.1643    5  406 36624.5756 62215.3024  69.9% 22850 2602s
    36    68 60570.8339    5  393 36624.5756 62048.1782  69.4% 26427 2853s
    67   114 60563.2640    6  403 36624.5756 62048.1782  69.4% 26536 2947s
   113   176 60451.9226    7  381 36624.5756 62048.1782  69.4% 19739 3031s
   175   236 60425.7700    8  386 36624.5756 62048.1782  69.4% 16307 3106s
   235   292 60321.6281    9  381 36624.5756 62048.1782  69.4% 15061 3174s
   291   361 60005.3723   10  374 36624.5756 62048.1782  69.4% 14499 3243s
   360   431 59983.6830   11  370 36624.5756 62048.1782  69.4% 13566 3305s
   430   483 59566.3254   16  348 36624.5756 62048.1782  69.4% 12900 3362s
   484   513 59772.2083   13  373 36624.5756 62048.1782  69.4% 12734 3405s
   515   550 59675.0182   14  368 36624.5756 62048.1782  69.4% 12787 3451s
   552   577 59598.8213   15  370 36624.5756 62048.1782  69.4% 12726 3510s
   585   607 59082.0755   21  338 36624.5756 62048.1782  69.4% 12477 3553s
   615   638 59489.6082   16  373 36624.5756 62048.1782  69.4% 12492 3600s

Cutting planes:
  Learned: 1
  Gomory: 30
  Implied bound: 298
  MIR: 3100
  Flow cover: 2412
  RLT: 123
  Relax-and-lift: 714

Explored 646 nodes (8918061 simplex iterations) in 3600.06 seconds (4972.22 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 36624.6 36523 36278.1 ... 33532.2

Time limit reached
Best objective 3.662457563802e+04, best bound 6.204817824117e+04, gap 69.4168%
  WARNING: Time limit reached. Using best solution found (gap: 69.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 36624.58, θ = 207567.69
  Upper Bound (UB) = 36624.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207567.69
  [DEBUG]   ✓ Scenario 0: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207567.69 ≤ Q = 207567.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 207567.69 ≤ Q = 207567.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 207567.69 ≤ Q = 207567.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 207567.69 ≤ Q = 207567.69 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7f341526
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7f341526
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.253431e+13
Presolve removed 2542 rows and 1833 columns
Presolve time: 0.01s
Presolved: 551 rows, 556 columns, 1555 nonzeros
Found heuristic solution: objective 6482547.5754
Variable types: 378 continuous, 178 integer (178 binary)

Root relaxation: objective -1.685294e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168529.45    0  124 6482547.58 -168529.45   103%     -    0s
H    0     0                    -130050.9540 -168529.45  29.6%     -    0s
H    0     0                    -130849.1352 -168529.45  28.8%     -    0s
     0     0 -147609.70    0   91 -130849.14 -147609.70  12.8%     -    0s
H    0     0                    -144425.4973 -147608.84  2.20%     -    0s
H    0     0                    -145015.2909 -147608.84  1.79%     -    0s
     0     0 -146191.75    0   64 -145015.29 -146191.75  0.81%     -    0s
H    0     0                    -145091.8252 -146180.23  0.75%     -    0s
H    0     0                    -145361.8250 -146180.23  0.56%     -    0s
     0     0 -146179.91    0   49 -145361.82 -146179.91  0.56%     -    0s
H    0     0                    -145553.7595 -145810.33  0.18%     -    0s
     0     0 -145810.33    0   33 -145553.76 -145810.33  0.18%     -    0s
     0     0 -145788.05    0   27 -145553.76 -145788.05  0.16%     -    0s
     0     0 -145737.95    0   29 -145553.76 -145737.95  0.13%     -    0s
     0     0 -145729.78    0   28 -145553.76 -145729.78  0.12%     -    0s
     0     0 -145729.43    0   28 -145553.76 -145729.43  0.12%     -    0s
     0     0 -145692.21    0   26 -145553.76 -145692.21  0.10%     -    0s
     0     0 -145692.21    0   51 -145553.76 -145692.21  0.10%     -    0s
     0     0 -145586.72    0   10 -145553.76 -145586.72  0.02%     -    0s
     0     0 -145584.14    0    8 -145553.76 -145584.14  0.02%     -    0s
H    0     0                    -145560.0099 -145583.30  0.02%     -    0s
     0     0 -145582.49    0    2 -145560.01 -145582.49  0.02%     -    0s
     0     0 -145582.49    0    2 -145560.01 -145582.49  0.02%     -    0s
     0     0 -145582.49    0    6 -145560.01 -145582.49  0.02%     -    0s
H    0     0                    -145582.1953 -145582.49  0.00%     -    0s

Explored 1 nodes (911 simplex iterations) in 0.17 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145582 -145560 -145554 ... 6.48255e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.455821953343e+05, best bound -1.455824913610e+05, gap 0.0002%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 196213.79
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145582.20
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -145582.20 = 196213.79
  [DEBUG]   Current θ from Master = 207567.69
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11353.90 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25270.68
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 338.9784, Absolute Gap = 338.9784, Relative Gap = 0.009255
  Not converged yet (gap = 338.98 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567873 nonzeros
Model fingerprint: 0x8745c004
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80413 rows and 32673 columns
Presolve time: 3.48s
Presolved: 119740 rows, 50707 columns, 737001 nonzeros
Variable types: 48448 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307441.5572
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 702
 AA' NZ     : 4.812e+06
 Factor NZ  : 1.192e+07 (roughly 170 MB of memory)
 Factor Ops : 4.054e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.76817016e+07  2.11578671e+08  1.29e+05 1.89e+01  7.85e+04     6s
   1  -1.34136380e+07  1.92809107e+08  9.12e+04 6.99e+01  5.48e+04     6s
   2  -4.09271663e+06  1.42758788e+08  2.80e+04 8.14e-01  1.79e+04     6s
   3  -7.86594788e+05  1.05727858e+08  1.79e+03 1.84e+00  1.56e+03     6s
   4  -5.12775104e+05  6.03515444e+07  5.12e+02 9.10e-01  5.58e+02     6s
   5  -3.95062972e+05  3.59705134e+07  1.67e+02 4.61e-01  2.48e+02     6s
   6  -3.40634565e+05  2.61059466e+07  8.57e+01 3.14e-01  1.59e+02     7s
   7  -2.72510636e+05  1.91356976e+07  4.08e+01 2.20e-01  1.04e+02     7s
   8  -1.63122967e+05  1.45428734e+07  1.06e+01 1.62e-01  7.06e+01     7s
   9  -1.21343439e+05  8.76541863e+06  5.73e+00 9.59e-02  4.18e+01     7s
  10  -9.13151986e+04  4.42655878e+06  3.19e+00 4.74e-02  2.10e+01     7s
  11  -6.57472103e+04  2.55455602e+06  1.51e+00 2.67e-02  1.21e+01     7s
  12  -4.83237811e+04  8.94467431e+05  9.83e-01 9.41e-03  4.34e+00     7s
  13  -1.05403823e+04  4.58169581e+05  4.64e-01 4.73e-03  2.15e+00     7s
  14   3.74496561e+03  2.92686236e+05  3.56e-01 2.66e-03  1.33e+00     8s
  15   1.58503034e+04  2.49223233e+05  2.89e-01 2.45e-03  1.07e+00     8s
  16   2.77898568e+04  1.81565334e+05  2.27e-01 2.32e-03  7.06e-01     8s
  17   3.60089982e+04  1.46470013e+05  1.88e-01 2.27e-03  5.07e-01     8s
  18   4.45017454e+04  1.26659596e+05  1.47e-01 1.89e-03  3.77e-01     8s
  19   5.46080102e+04  1.16945395e+05  1.00e-01 2.34e-03  2.86e-01     8s
  20   5.87556006e+04  1.06123451e+05  8.24e-02 1.96e-03  2.17e-01     9s
  21   6.17487345e+04  9.96207735e+04  7.05e-02 1.40e-03  1.74e-01     9s
  22   6.38201348e+04  9.53472185e+04  6.27e-02 1.94e-03  1.45e-01     9s
  23   6.94894903e+04  9.27130673e+04  4.13e-02 1.49e-03  1.07e-01     9s
  24   7.10020260e+04  9.02698962e+04  3.59e-02 1.65e-03  8.85e-02     9s
  25   7.42169176e+04  8.79153560e+04  2.44e-02 1.55e-03  6.29e-02     9s
  26   7.55723981e+04  8.65100064e+04  1.98e-02 1.09e-03  5.02e-02     9s
  27   7.64538221e+04  8.51561518e+04  1.69e-02 1.03e-03  4.00e-02    10s
  28   7.74408090e+04  8.41723009e+04  1.36e-02 9.33e-04  3.09e-02    10s
  29   7.86442736e+04  8.35499214e+04  9.81e-03 6.56e-04  2.25e-02    10s
  30   7.97706179e+04  8.29005539e+04  6.15e-03 3.81e-04  1.44e-02    10s
  31   8.02275864e+04  8.25319359e+04  4.72e-03 2.54e-04  1.06e-02    10s
  32   8.09174449e+04  8.23511969e+04  2.62e-03 2.01e-04  6.58e-03    11s
  33   8.11340587e+04  8.22119647e+04  1.96e-03 1.48e-04  4.95e-03    11s
  34   8.12284700e+04  8.21382429e+04  1.68e-03 1.19e-04  4.18e-03    11s
  35   8.14421333e+04  8.20115792e+04  1.05e-03 8.10e-05  2.61e-03    11s
  36   8.15325224e+04  8.19156260e+04  7.89e-04 3.71e-05  1.76e-03    11s
  37   8.16166959e+04  8.18845127e+04  5.52e-04 3.10e-05  1.23e-03    12s
  38   8.16578411e+04  8.18607661e+04  4.35e-04 1.85e-05  9.33e-04    12s
  39   8.17090933e+04  8.18521273e+04  2.94e-04 1.39e-05  6.57e-04    12s
  40   8.17816412e+04  8.18424696e+04  1.02e-04 9.15e-06  2.79e-04    12s
  41   8.18167718e+04  8.18269453e+04  1.16e-05 3.26e-06  4.66e-05    12s
  42   8.18214434e+04  8.18232288e+04  2.41e-06 1.79e-07  8.20e-06    13s
  43   8.18227243e+04  8.18231129e+04  2.46e-07 1.07e-07  1.78e-06    13s
  44   8.18229390e+04  8.18229410e+04  5.20e-09 7.36e-10  8.99e-09    13s
  45   8.18229396e+04  8.18229397e+04  2.59e-08 7.40e-10  1.15e-10    13s

Barrier solved model in 45 iterations and 13.19 seconds (10.04 work units)
Optimal objective 8.18229396e+04


Root crossover log...

  106140 DPushes remaining with DInf 0.0000000e+00                13s
   41463 DPushes remaining with DInf 0.0000000e+00                15s
    7526 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    1371 PPushes remaining with PInf 4.4422401e-06                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.0664806e+00     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54790    8.1822940e+04   0.000000e+00   3.066481e+00     25s
   54815    8.1822940e+04   0.000000e+00   0.000000e+00     25s
   54815    8.1822940e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 3.29s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.182294e+04, 54815 iterations, 24.30 seconds (29.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81822.9397    0  227 -198441.04 81822.9397   141%     -   29s
H    0     0                    -194140.1517 81822.9397   142%     -   29s
H    0     0                    -82647.69917 81822.9397   199%     -   30s
H    0     0                    -82467.54911 81822.9397   199%     -   30s
H    0     0                    -65927.87867 81822.9397   224%     -   30s
H    0     0                    -65798.05283 81822.9397   224%     -   30s
H    0     0                    2663.5447676 81822.9397  2972%     -   31s
H    0     0                    4419.0124424 81822.9397  1752%     -   32s
H    0     0                    9481.2561865 81822.9397   763%     -   32s
H    0     0                    9580.1174811 81822.9397   754%     -   33s
H    0     0                    9883.2690401 81822.9397   728%     -   33s
H    0     0                    9956.1639988 81822.9397   722%     -   33s
H    0     0                    10128.216589 81822.9397   708%     -   33s
H    0     0                    21094.480655 81822.9397   288%     -   36s
H    0     0                    23507.981237 81822.9397   248%     -   36s
H    0     0                    24691.021521 81822.9397   231%     -   36s
H    0     0                    24848.951195 81822.9397   229%     -   36s
H    0     0                    24868.373430 81822.9397   229%     -   36s
H    0     0                    25035.858963 81822.9397   227%     -   36s
H    0     0                    25037.717422 81822.9397   227%     -   36s
     0     0 74374.0058    0  216 25037.7174 74374.0058   197%     -  175s
H    0     0                    26459.547459 74374.0058   181%     -  177s
H    0     0                    26619.222181 74374.0058   179%     -  177s
     0     0 73593.7704    0  230 26619.2222 73593.7704   176%     -  229s
     0     0 73319.9369    0  222 26619.2222 73319.9369   175%     -  272s
     0     0 73252.6550    0  233 26619.2222 73252.6550   175%     -  297s
     0     0 73220.2800    0  237 26619.2222 73220.2800   175%     -  312s
     0     0 73218.9067    0  238 26619.2222 73218.9067   175%     -  325s
     0     0 73218.9067    0  238 26619.2222 73218.9067   175%     -  335s
     0     0 73218.9067    0  231 26619.2222 73218.9067   175%     -  342s
     0     0 73218.9067    0  238 26619.2222 73218.9067   175%     -  351s
     0     0 73218.9067    0  235 26619.2222 73218.9067   175%     -  357s
     0     0 73218.9067    0  237 26619.2222 73218.9067   175%     -  359s
     0     0 73218.9067    0  235 26619.2222 73218.9067   175%     -  361s
     0     0 73218.9067    0  242 26619.2222 73218.9067   175%     -  366s
     0     0 73218.9067    0  243 26619.2222 73218.9067   175%     -  378s
     0     0 73218.9067    0  241 26619.2222 73218.9067   175%     -  380s
     0     0 68764.6154    0  306 26619.2222 68764.6154   158%     -  547s
H    0     0                    33280.768920 68764.4958   107%     -  548s
     0     0 68031.9713    0  330 33280.7689 68031.9713   104%     -  640s
     0     0 67845.6335    0  345 33280.7689 67845.6335   104%     -  684s
     0     0 67782.4864    0  340 33280.7689 67782.4864   104%     -  714s
     0     0 67745.1586    0  345 33280.7689 67745.1586   104%     -  755s
     0     0 67736.9423    0  351 33280.7689 67736.9423   104%     -  765s
     0     0 67723.0857    0  351 33280.7689 67723.0857   103%     -  773s
     0     0 67713.5543    0  351 33280.7689 67713.5543   103%     -  778s
     0     0 67713.0294    0  346 33280.7689 67713.0294   103%     -  780s
     0     0 65970.6855    0  360 33280.7689 65970.6855  98.2%     -  896s
H    0     0                    33666.102450 65970.4613  96.0%     -  897s
H    0     0                    33905.614732 65970.4613  94.6%     -  897s
H    0     0                    33949.313910 65970.4613  94.3%     -  897s
     0     0 65349.9600    0  342 33949.3139 65349.9600  92.5%     -  945s
     0     0 65111.2217    0  350 33949.3139 65111.2217  91.8%     -  987s
     0     0 64975.8068    0  354 33949.3139 64975.8068  91.4%     - 1017s
     0     0 64914.4689    0  357 33949.3139 64914.4689  91.2%     - 1040s
     0     0 64889.0620    0  362 33949.3139 64889.0620  91.1%     - 1054s
     0     0 64879.0529    0  360 33949.3139 64879.0529  91.1%     - 1062s
     0     0 64833.4849    0  354 33949.3139 64833.4849  91.0%     - 1075s
     0     0 64807.5474    0  361 33949.3139 64807.5474  90.9%     - 1083s
     0     0 64800.0231    0  355 33949.3139 64800.0231  90.9%     - 1088s
     0     0 64775.1729    0  353 33949.3139 64775.1729  90.8%     - 1097s
     0     0 64773.1896    0  353 33949.3139 64773.1896  90.8%     - 1100s
     0     0 64029.6054    0  356 33949.3139 64029.6054  88.6%     - 1177s
H    0     0                    34010.122872 64028.8832  88.3%     - 1178s
     0     0 63669.6018    0  356 34010.1229 63669.6018  87.2%     - 1204s
     0     0 63545.2615    0  382 34010.1229 63545.2615  86.8%     - 1222s
     0     0 63491.9127    0  382 34010.1229 63491.9127  86.7%     - 1232s
     0     0 63461.4676    0  383 34010.1229 63461.4676  86.6%     - 1243s
     0     0 63438.4563    0  377 34010.1229 63438.4563  86.5%     - 1253s
     0     0 63431.2523    0  380 34010.1229 63431.2523  86.5%     - 1258s
     0     0 63412.5363    0  383 34010.1229 63412.5363  86.5%     - 1262s
     0     0 63406.7045    0  385 34010.1229 63406.7045  86.4%     - 1267s
     0     0 63400.1975    0  384 34010.1229 63400.1975  86.4%     - 1270s
     0     0 63395.7252    0  383 34010.1229 63395.7252  86.4%     - 1275s
     0     0 63394.1456    0  383 34010.1229 63394.1456  86.4%     - 1277s
     0     0 63173.6291    0  393 34010.1229 63173.6291  85.7%     - 1303s
H    0     0                    34021.967374 63172.5733  85.7%     - 1304s
     0     0 63078.5939    0  392 34021.9674 63078.5939  85.4%     - 1323s
     0     0 63058.7227    0  389 34021.9674 63058.7227  85.3%     - 1334s
     0     0 63052.3143    0  387 34021.9674 63052.3143  85.3%     - 1340s
     0     0 63045.6671    0  391 34021.9674 63045.6671  85.3%     - 1346s
     0     0 63037.0482    0  389 34021.9674 63037.0482  85.3%     - 1351s
     0     0 63029.0825    0  388 34021.9674 63029.0825  85.3%     - 1356s
     0     0 63024.8639    0  389 34021.9674 63024.8639  85.2%     - 1363s
     0     0 63024.2050    0  391 34021.9674 63024.2050  85.2%     - 1365s
     0     0 62930.6025    0  409 34021.9674 62930.6025  85.0%     - 1382s
H    0     0                    34158.745193 62930.3867  84.2%     - 1407s
H    0     0                    34888.286320 62930.3867  80.4%     - 1407s
H    0     0                    34913.972988 62930.3867  80.2%     - 1408s
     0     0 62910.2759    0  408 34913.9730 62910.2759  80.2%     - 1417s
     0     0 62899.2814    0  416 34913.9730 62899.2814  80.2%     - 1420s
     0     0 62893.1114    0  415 34913.9730 62893.1114  80.1%     - 1425s
     0     0 62890.2505    0  415 34913.9730 62890.2505  80.1%     - 1429s
     0     0 62889.1639    0  450 34913.9730 62889.1639  80.1%     - 1431s
     0     0 62842.6990    0  390 34913.9730 62842.6990  80.0%     - 1444s
     0     0 62812.9785    0  405 34913.9730 62812.9785  79.9%     - 1452s
     0     0 62800.5529    0  397 34913.9730 62800.5529  79.9%     - 1458s
     0     0 62794.0279    0  402 34913.9730 62794.0279  79.9%     - 1462s
     0     0 62792.3338    0  409 34913.9730 62792.3338  79.8%     - 1463s
     0     0 62771.3412    0  397 34913.9730 62771.3412  79.8%     - 1476s
     0     0 62764.4655    0  433 34913.9730 62764.4655  79.8%     - 1488s
     0     0 62762.1673    0  433 34913.9730 62762.1673  79.8%     - 1493s
     0     0 62746.0409    0  437 34913.9730 62746.0409  79.7%     - 1507s
     0     0 62739.9035    0  447 34913.9730 62739.9035  79.7%     - 1513s
     0     0 62733.6582    0  443 34913.9730 62733.6582  79.7%     - 1517s
     0     0 62726.6812    0  442 34913.9730 62726.6812  79.7%     - 1522s
     0     0 62726.2638    0  442 34913.9730 62726.2638  79.7%     - 1524s
     0     0 62718.3592    0  409 34913.9730 62718.3592  79.6%     - 1536s
     0     0 62718.3095    0  409 34913.9730 62718.3095  79.6%     - 1540s
H    0     0                    35025.439029 62718.3057  79.1%     - 1800s
H    0     2                    36827.912605 62718.3057  70.3%     - 2019s
     0     2 62718.3057    0  409 36827.9126 62718.3057  70.3%     - 2019s
     1     4 62481.4004    1  387 36827.9126 62717.8826  70.3% 12151 2070s
     3     8 62267.8832    2  389 36827.9126 62480.2990  69.7% 16503 2117s
     7    16 62152.9207    3  437 36827.9126 62267.1466  69.1% 15967 2177s
    15    32 61827.1888    4  436 36827.9126 62152.6810  68.8% 16320 2230s
    31    48 59915.9493    5  300 36827.9126 61826.8335  67.9% 22654 2869s
    47    80 58701.8117    6  296 36827.9126 61826.8335  67.9% 22666 2940s
H   51    80                    36971.988971 61826.8335  67.2% 21852 2940s
    79   144 58629.1556    7  291 36971.9890 61826.8335  67.2% 18005 3277s
   143   176 58233.2825    8  276 36971.9890 61826.8335  67.2% 12969 3347s
H  154   176                    37013.073792 61826.8335  67.0% 12324 3347s
H  156   176                    37076.808980 61826.8335  66.8% 12223 3347s
   175   327 58361.0260    9  265 37076.8090 61826.8335  66.8% 11334 3431s
   326   419 58296.8162   12  261 37076.8090 61826.8335  66.8%  7927 3485s
H  337   419                    37133.080474 61826.8335  66.5%  7771 3485s
H  345   419                    37226.473969 61826.8335  66.1%  7658 3485s
   418   509 58068.5667   12  267 37226.4740 61826.8335  66.1%  7003 3534s
   508   573 58134.6618   13  260 37226.4740 61826.8335  66.1%  6316 3578s
H  512   573                    37251.358341 61826.8335  66.0%  6304 3578s
H  530   573                    37324.802281 61826.8335  65.6%  6215 3578s
   572   593 55474.0388   23  244 37324.8023 61826.8335  65.6%  5986 3600s

Cutting planes:
  Learned: 5
  Gomory: 26
  Implied bound: 203
  MIR: 2602
  Flow cover: 2638
  RLT: 73
  Relax-and-lift: 405

Explored 592 nodes (4092045 simplex iterations) in 3600.04 seconds (4688.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 37324.8 37251.4 37226.5 ... 34914

Time limit reached
Best objective 3.732480228105e+04, best bound 6.182683351639e+04, gap 65.6454%
  WARNING: Time limit reached. Using best solution found (gap: 65.65%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 37324.80, θ = 205242.83
  Upper Bound (UB) = 37324.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205242.83
  [DEBUG]   ✓ Scenario 0: θ = 205242.83 ≤ Q = 205242.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205242.83 ≤ Q = 205242.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205242.83 ≤ Q = 205242.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205242.83 ≤ Q = 205242.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205242.83 ≤ Q = 205242.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205242.83 ≤ Q = 205242.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205242.83 ≤ Q = 205242.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 205242.83 ≤ Q = 205242.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 205242.83 ≤ Q = 205242.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 205242.83 ≤ Q = 205242.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 205242.83 ≤ Q = 205242.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 205242.83 ≤ Q = 205242.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 205242.83 ≤ Q = 205242.83 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x41a3e7c6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbe5c183a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.314921e+13
Presolve removed 2542 rows and 1832 columns
Presolve time: 0.01s
Presolved: 551 rows, 557 columns, 1555 nonzeros
Found heuristic solution: objective 6960869.3888
Variable types: 379 continuous, 178 integer (178 binary)

Root relaxation: objective -1.737876e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173787.57    0  127 6960869.39 -173787.57   102%     -    0s
H    0     0                    -135260.4385 -173787.57  28.5%     -    0s
H    0     0                    -135535.0529 -173787.57  28.2%     -    0s
H    0     0                    -136277.1224 -150797.63  10.7%     -    0s
H    0     0                    -141406.8092 -150797.63  6.64%     -    0s
     0     0 -150790.76    0   43 -141406.81 -150790.76  6.64%     -    0s
H    0     0                    -148854.0108 -150790.76  1.30%     -    0s
     0     0 -150750.60    0   37 -148854.01 -150750.60  1.27%     -    0s
     0     0 -150746.50    0   42 -148854.01 -150746.50  1.27%     -    0s
     0     0 -149988.13    0   19 -148854.01 -149988.13  0.76%     -    0s
H    0     0                    -149629.6332 -149924.23  0.20%     -    0s
     0     0 -149924.23    0   16 -149629.63 -149924.23  0.20%     -    0s
     0     0 -149912.41    0   19 -149629.63 -149912.41  0.19%     -    0s
     0     0 -149769.72    0   13 -149629.63 -149769.72  0.09%     -    0s
     0     0 -149769.72    0   27 -149629.63 -149769.72  0.09%     -    0s
     0     0 -149678.15    0    6 -149629.63 -149678.15  0.03%     -    0s
H    0     0                    -149662.9204 -149672.63  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 18
  Flow cover: 8

Explored 1 nodes (667 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -149663 -149630 -148973 ... 1.31492e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.496629204199e+05, best bound -1.496726296072e+05, gap 0.0065%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 192133.07
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149662.92
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -149662.92 = 192133.07
  [DEBUG]   Current θ from Master = 205242.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13109.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24215.04
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 1039.2050, Absolute Gap = 1039.2050, Relative Gap = 0.027842
  Not converged yet (gap = 1039.21 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611131 nonzeros
Model fingerprint: 0x84396b5a
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86634 rows and 35204 columns
Presolve time: 4.67s
Presolved: 128809 rows, 54416 columns, 791116 nonzeros
Variable types: 52157 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -308490.3386
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.47s

Barrier statistics:
 Dense cols : 692
 AA' NZ     : 5.502e+06
 Factor NZ  : 1.275e+07 (roughly 180 MB of memory)
 Factor Ops : 2.773e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83230841e+07  2.25301386e+08  1.34e+05 1.85e+01  8.09e+04     7s
   1  -1.39538453e+07  2.06380078e+08  9.46e+04 7.10e+01  5.65e+04     7s
   2  -4.40604402e+06  1.53598195e+08  3.00e+04 8.38e-01  1.90e+04     7s
   3  -8.64414847e+05  1.14869296e+08  1.77e+03 1.86e+00  1.55e+03     7s
   4  -5.49744062e+05  4.01080047e+07  4.75e+02 3.98e-01  4.27e+02     7s
   5  -4.01916722e+05  3.05868236e+07  1.71e+02 2.78e-01  2.18e+02     8s
   6  -3.44218795e+05  2.23130603e+07  9.63e+01 1.89e-01  1.40e+02     8s
   7  -2.62441990e+05  1.82257660e+07  5.06e+01 1.48e-01  9.93e+01     8s
   8  -1.45294540e+05  1.11961090e+07  1.43e+01 8.31e-02  5.26e+01     8s
   9  -1.01548210e+05  7.26984025e+06  6.17e+00 5.30e-02  3.27e+01     8s
  10  -8.10903308e+04  2.27903111e+06  3.52e+00 1.53e-02  1.03e+01     8s
  11  -4.87246703e+04  8.29730499e+05  1.54e+00 5.09e-03  3.79e+00     8s
  12  -1.27513932e+04  4.32042333e+05  7.31e-01 2.25e-03  1.91e+00     8s
  13   1.08567864e+04  2.82702563e+05  4.53e-01 2.30e-03  1.16e+00     8s
  14   1.78387822e+04  1.88211007e+05  3.91e-01 2.91e-03  7.30e-01     9s
  15   2.92074657e+04  1.56148634e+05  3.12e-01 2.13e-03  5.44e-01     9s
  16   3.59380801e+04  1.31667559e+05  2.64e-01 1.79e-03  4.10e-01     9s
  17   3.69539012e+04  1.24077982e+05  2.58e-01 1.90e-03  3.74e-01     9s
  18   4.56686161e+04  1.14223470e+05  2.01e-01 1.94e-03  2.94e-01     9s
  19   5.23929919e+04  1.07030583e+05  1.60e-01 2.43e-03  2.34e-01     9s
  20   5.87390304e+04  9.82467963e+04  1.23e-01 1.81e-03  1.69e-01     9s
  21   6.41900925e+04  9.50830804e+04  9.19e-02 1.88e-03  1.32e-01     9s
  22   6.81081165e+04  9.19916404e+04  7.03e-02 1.65e-03  1.02e-01    10s
  23   6.99333145e+04  9.01476926e+04  5.96e-02 1.28e-03  8.66e-02    10s
  24   7.24339998e+04  8.77879174e+04  4.65e-02 1.53e-03  6.58e-02    10s
  25   7.38652133e+04  8.64276384e+04  3.91e-02 1.54e-03  5.39e-02    10s
  26   7.61818110e+04  8.50542971e+04  2.76e-02 1.31e-03  3.80e-02    10s
  27   7.75915694e+04  8.38926306e+04  2.06e-02 8.27e-04  2.70e-02    10s
  28   7.88576639e+04  8.35036014e+04  1.44e-02 6.46e-04  1.99e-02    10s
  29   7.96861611e+04  8.30096260e+04  1.05e-02 4.27e-04  1.42e-02    10s
  30   8.02654830e+04  8.28026492e+04  7.72e-03 3.31e-04  1.09e-02    11s
  31   8.07753336e+04  8.25299848e+04  5.35e-03 2.20e-04  7.52e-03    11s
  32   8.10431477e+04  8.24194544e+04  4.14e-03 1.71e-04  5.90e-03    11s
  33   8.12367691e+04  8.23580545e+04  3.26e-03 1.46e-04  4.80e-03    11s
  34   8.14249226e+04  8.21971248e+04  2.40e-03 7.92e-05  3.31e-03    11s
  35   8.15682467e+04  8.21238515e+04  1.79e-03 4.62e-05  2.38e-03    11s
  36   8.18139245e+04  8.20664340e+04  7.82e-04 7.75e-05  1.08e-03    12s
  37   8.18914882e+04  8.20472706e+04  4.49e-04 5.36e-05  6.67e-04    12s
  38   8.19218869e+04  8.20304306e+04  3.22e-04 3.38e-05  4.65e-04    12s
  39   8.19603390e+04  8.20183352e+04  1.61e-04 1.83e-05  2.48e-04    12s
  40   8.19828295e+04  8.20116632e+04  7.32e-05 1.01e-05  1.23e-04    12s
  41   8.19964226e+04  8.20051790e+04  2.16e-05 2.35e-06  3.75e-05    12s
  42   8.20016080e+04  8.20047176e+04  3.93e-06 1.86e-06  1.33e-05    12s
  43   8.20019317e+04  8.20039062e+04  2.93e-06 1.01e-06  8.43e-06    12s
  44   8.20022409e+04  8.20031006e+04  1.99e-06 1.97e-07  3.68e-06    13s
  45   8.20028391e+04  8.20029809e+04  1.28e-07 1.06e-07  6.05e-07    13s
  46   8.20028696e+04  8.20029230e+04  5.40e-08 3.32e-08  2.28e-07    13s
  47   8.20028864e+04  8.20028951e+04  8.59e-08 2.19e-09  3.74e-08    13s
  48   8.20028874e+04  8.20028948e+04  3.21e-07 1.36e-08  3.16e-08    14s
  49   8.20028882e+04  8.20028944e+04  3.78e-07 1.91e-08  2.70e-08    14s
  50   8.20028921e+04  8.20028931e+04  1.26e-05 1.20e-06  4.56e-09    14s
  51   8.20028926e+04  8.20028931e+04  6.52e-06 2.09e-06  2.17e-09    14s

Barrier solved model in 51 iterations and 14.35 seconds (12.40 work units)
Optimal objective 8.20028926e+04


Root crossover log...

  114470 DPushes remaining with DInf 0.0000000e+00                14s
   65914 DPushes remaining with DInf 0.0000000e+00                15s
   21243 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

   16982 PPushes remaining with PInf 1.3354935e-04                25s
    7769 PPushes remaining with PInf 6.1671547e-05                26s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.7174147e+05     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   80188    8.2002893e+04   0.000000e+00   5.717415e+05     28s
   81455    8.2002893e+04   0.000000e+00   0.000000e+00     30s
   81455    8.2002893e+04   0.000000e+00   0.000000e+00     30s
Concurrent spin time: 4.54s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.200289e+04, 81455 iterations, 28.65 seconds (36.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82002.8931    0  205 -198441.04 82002.8931   141%     -   35s
H    0     0                    -195611.2130 82002.8931   142%     -   35s
H    0     0                    -188925.0229 82002.8931   143%     -   36s
H    0     0                    -188100.1808 82002.8931   144%     -   36s
H    0     0                    -184321.8884 82002.8931   144%     -   37s
H    0     0                    -184030.3909 82002.8931   145%     -   37s
H    0     0                    -183913.9709 82002.8931   145%     -   37s
H    0     0                    -183754.9502 82002.8931   145%     -   37s
H    0     0                    -57640.41837 82002.8931   242%     -   38s
H    0     0                    -56737.81327 82002.8931   245%     -   38s
H    0     0                    9451.7392822 82002.8931   768%     -   38s
H    0     0                    12007.655875 82002.8931   583%     -   38s
H    0     0                    22154.957946 82002.8931   270%     -   39s
H    0     0                    27454.071301 82002.8931   199%     -   39s
H    0     0                    31600.801202 82002.8931   159%     -   40s
H    0     0                    31939.915729 82002.8931   157%     -   40s
H    0     0                    32123.690057 82002.8931   155%     -   40s
H    0     0                    32159.926480 82002.8931   155%     -   40s
H    0     0                    32351.496983 82002.8931   153%     -   40s
H    0     0                    32396.383583 82002.8931   153%     -   40s
H    0     0                    32423.481263 82002.8931   153%     -   40s
H    0     0                    32426.202327 82002.8931   153%     -   40s
H    0     0                    32625.818184 74129.0231   127%     -  234s
H    0     0                    33979.487728 74129.0231   118%     -  234s
H    0     0                    33982.388027 74129.0231   118%     -  234s
H    0     0                    33984.293490 74129.0231   118%     -  234s
     0     0 73339.4600    0  233 33984.2935 73339.4600   116%     -  235s
H    0     0                    33991.671122 73339.4600   116%     -  237s
H    0     0                    34006.096119 73339.4600   116%     -  237s
H    0     0                    34016.025322 73339.4600   116%     -  237s
H    0     0                    34072.368763 73339.4600   115%     -  237s
H    0     0                    34105.832003 73339.4600   115%     -  237s
H    0     0                    34650.951408 73339.4600   112%     -  237s
     0     0 73153.9839    0  244 34650.9514 73153.9839   111%     -  315s
     0     0 73007.6799    0  251 34650.9514 73007.6799   111%     -  327s
     0     0 72993.1068    0  249 34650.9514 72993.1068   111%     -  335s
     0     0 72990.8232    0  249 34650.9514 72990.8232   111%     -  348s
     0     0 72990.8232    0  248 34650.9514 72990.8232   111%     -  352s
     0     0 72990.8232    0  249 34650.9514 72990.8232   111%     -  369s
     0     0 72990.8232    0  254 34650.9514 72990.8232   111%     -  386s
     0     0 72990.8232    0  258 34650.9514 72990.8232   111%     -  394s
     0     0 72990.8232    0  255 34650.9514 72990.8232   111%     -  399s
     0     0 72990.8232    0  252 34650.9514 72990.8232   111%     -  423s
H    0     0                    34803.106933 72990.8232   110%     -  427s
H    0     0                    34828.852458 72990.8232   110%     -  427s
H    0     0                    35432.082259 72990.8232   106%     -  427s
     0     0 69474.8663    0  266 35432.0823 69474.8663  96.1%     -  427s
     0     0 69474.8663    0  269 35432.0823 69474.8663  96.1%     -  432s
     0     0 69474.8438    0  262 35432.0823 69474.8438  96.1%     -  434s
     0     0 69157.1119    0  315 35432.0823 69157.1119  95.2%     -  561s
H    0     0                    35622.601709 69157.0314  94.1%     -  562s
     0     0 68200.1738    0  332 35622.6017 68200.1738  91.5%     -  621s
     0     0 67857.8270    0  358 35622.6017 67857.8270  90.5%     -  683s
     0     0 67678.0565    0  357 35622.6017 67678.0565  90.0%     -  709s
     0     0 67654.0092    0  360 35622.6017 67654.0092  89.9%     -  720s
     0     0 67636.0486    0  366 35622.6017 67636.0486  89.9%     -  725s
     0     0 67598.1322    0  353 35622.6017 67598.1322  89.8%     -  733s
     0     0 67486.1281    0  363 35622.6017 67486.1281  89.4%     -  753s
     0     0 67463.0200    0  371 35622.6017 67463.0200  89.4%     -  764s
     0     0 67460.4962    0  377 35622.6017 67460.4962  89.4%     -  768s
     0     0 67448.3176    0  371 35622.6017 67448.3176  89.3%     -  775s
     0     0 67440.8588    0  380 35622.6017 67440.8588  89.3%     -  780s
     0     0 67434.6460    0  385 35622.6017 67434.6460  89.3%     -  783s
     0     0 67433.1899    0  386 35622.6017 67433.1899  89.3%     -  785s
     0     0 65546.0584    0  335 35622.6017 65546.0584  84.0%     -  896s
     0     0 65101.3724    0  330 35622.6017 65101.3724  82.8%     -  941s
     0     0 64942.6929    0  344 35622.6017 64942.6929  82.3%     -  965s
     0     0 64817.4148    0  353 35622.6017 64817.4148  82.0%     -  990s
     0     0 64798.1225    0  354 35622.6017 64798.1225  81.9%     - 1003s
     0     0 64752.3773    0  343 35622.6017 64752.3773  81.8%     - 1024s
H    0     0                    35642.601602 64736.1232  81.6%     - 1036s
     0     0 64736.1232    0  352 35642.6016 64736.1232  81.6%     - 1036s
H    0     0                    35653.839407 64724.5967  81.5%     - 1046s
     0     0 64724.5967    0  381 35653.8394 64724.5967  81.5%     - 1046s
     0     0 64723.1761    0  379 35653.8394 64723.1761  81.5%     - 1050s
     0     0 63788.1545    0  344 35653.8394 63788.1545  78.9%     - 1133s
H    0     0                    35761.332612 63788.1353  78.4%     - 1134s
H    0     0                    35767.429613 63788.1353  78.3%     - 1134s
     0     0 63528.8074    0  369 35767.4296 63528.8074  77.6%     - 1176s
     0     0 63348.8826    0  368 35767.4296 63348.8826  77.1%     - 1204s
     0     0 63289.5081    0  387 35767.4296 63289.5081  76.9%     - 1217s
     0     0 63269.4616    0  388 35767.4296 63269.4616  76.9%     - 1225s
     0     0 63252.4707    0  387 35767.4296 63252.4707  76.8%     - 1232s
     0     0 63244.6249    0  384 35767.4296 63244.6249  76.8%     - 1238s
     0     0 63231.6482    0  395 35767.4296 63231.6482  76.8%     - 1243s
     0     0 63227.1647    0  395 35767.4296 63227.1647  76.8%     - 1246s
     0     0 63218.2718    0  391 35767.4296 63218.2718  76.7%     - 1253s
     0     0 63204.3479    0  385 35767.4296 63204.3479  76.7%     - 1258s
     0     0 63200.6376    0  393 35767.4296 63200.6376  76.7%     - 1262s
     0     0 63199.5376    0  398 35767.4296 63199.5376  76.7%     - 1264s
     0     0 63013.0484    0  383 35767.4296 63013.0484  76.2%     - 1295s
H    0     0                    35809.313104 63012.9769  76.0%     - 1297s
H    0     0                    35848.199818 63012.9769  75.8%     - 1297s
H    0     0                    35960.971786 63012.9769  75.2%     - 1297s
     0     0 62975.6064    0  393 35960.9718 62975.6064  75.1%     - 1312s
     0     0 62955.9159    0  393 35960.9718 62955.9159  75.1%     - 1320s
     0     0 62944.4338    0  397 35960.9718 62944.4338  75.0%     - 1324s
     0     0 62932.0363    0  400 35960.9718 62932.0363  75.0%     - 1331s
     0     0 62926.1527    0  394 35960.9718 62926.1527  75.0%     - 1336s
     0     0 62925.3183    0  399 35960.9718 62925.3183  75.0%     - 1339s
     0     0 62815.1524    0  428 35960.9718 62815.1524  74.7%     - 1357s
     0     0 62772.4890    0  429 35960.9718 62772.4890  74.6%     - 1371s
     0     0 62762.8655    0  412 35960.9718 62762.8655  74.5%     - 1379s
     0     0 62756.0139    0  410 35960.9718 62756.0139  74.5%     - 1386s
     0     0 62753.2759    0  407 35960.9718 62753.2759  74.5%     - 1389s
     0     0 62717.1389    0  410 35960.9718 62717.1389  74.4%     - 1404s
     0     0 62707.5307    0  416 35960.9718 62707.5307  74.4%     - 1413s
     0     0 62703.7041    0  414 35960.9718 62703.7041  74.4%     - 1418s
     0     0 62702.5403    0  414 35960.9718 62702.5403  74.4%     - 1420s
     0     0 62685.3306    0  429 35960.9718 62685.3306  74.3%     - 1437s
     0     0 62679.6606    0  434 35960.9718 62679.6606  74.3%     - 1442s
     0     0 62677.7562    0  426 35960.9718 62677.7562  74.3%     - 1445s
     0     0 62666.2825    0  442 35960.9718 62666.2825  74.3%     - 1453s
     0     0 62658.2180    0  441 35960.9718 62658.2180  74.2%     - 1465s
     0     0 62650.0205    0  448 35960.9718 62650.0205  74.2%     - 1473s
     0     0 62647.5233    0  444 35960.9718 62647.5233  74.2%     - 1480s
     0     0 62642.1597    0  450 35960.9718 62642.1597  74.2%     - 1488s
     0     0 62640.7544    0  449 35960.9718 62640.7544  74.2%     - 1495s
     0     0 62638.8875    0  453 35960.9718 62638.8875  74.2%     - 1503s
     0     0 62638.7801    0  453 35960.9718 62638.7801  74.2%     - 1508s
H    0     0                    36147.592513 62638.2823  73.3%     - 1809s
H    0     0                    36244.099841 62638.2823  72.8%     - 1817s
     0     2 62638.2823    0  453 36244.0998 62638.2823  72.8%     - 1824s
     1     3 61524.1688    1  322 36244.0998 62638.2823  72.8% 18883 1868s
     2     4 62455.4134    1  450 36244.0998 62455.4134  72.3% 13270 1886s
     3     6 62322.7997    2  386 36244.0998 62454.2009  72.3% 11127 1925s
     5    11 62115.4672    3  429 36244.0998 62454.2009  72.3% 13384 1971s
    10    20 61021.1075    4  375 36244.0998 62311.1359  71.9% 14304 2023s
    19    29 58882.0342    4  402 36244.0998 62311.1359  71.9% 21488 2176s
    28    56 60829.2244    4  361 36244.0998 62127.1050  71.4% 21625 2456s
H   32    56                    36400.894905 62127.1050  70.7% 20793 2456s
    55    88 60597.5083    5  365 36400.8949 62127.1050  70.7% 28573 2500s
    87   159 60507.5551    6  359 36400.8949 62127.1050  70.7% 23791 2589s
   158   212 60184.7300    8  348 36400.8949 62127.1050  70.7% 17612 2657s
   211   267 60179.9089   10  349 36400.8949 62127.1050  70.7% 15119 2722s
   266   327 60033.5567   11  347 36400.8949 62127.1050  70.7% 13769 2781s
   326   368 59309.6622   12  323 36400.8949 62127.1050  70.7% 12634 2831s
   367   432 59198.1901   13  322 36400.8949 62127.1050  70.7% 12142 2889s
   431   459 58846.2955   15  299 36400.8949 62127.1050  70.7% 11282 2938s
   458   493 56810.4972   29  345 36400.8949 62127.1050  70.7% 11095 2980s
   492   524 58818.3054   16  298 36400.8949 62127.1050  70.7% 11167 3023s
   523   551 58802.4748   17  299 36400.8949 62127.1050  70.7% 11237 3059s
   550   580 58733.2661   18  293 36400.8949 62127.1050  70.7% 11295 3099s
   579   611 58712.5549   19  292 36400.8949 62127.1050  70.7% 11470 3133s
   610   643 58655.1694   20  293 36400.8949 62127.1050  70.7% 11562 3171s
   642   677 58535.8095   21  298 36400.8949 62127.1050  70.7% 11662 3206s
   676   709 57139.1751   22  205 36400.8949 62127.1050  70.7% 11666 3240s
   708   745 54288.9841   23  194 36400.8949 62127.1050  70.7% 11664 3273s
   744   779 53915.0836   24  191 36400.8949 62127.1050  70.7% 11563 3316s
   778   813 53883.0686   25  189 36400.8949 62127.1050  70.7% 11531 3353s
   812   847 53278.3902   26  176 36400.8949 62127.1050  70.7% 11458 3394s
   846   878 52742.3752   27  190 36400.8949 62127.1050  70.7% 11329 3470s
H  867   878                    36414.980948 62127.1050  70.6% 11292 3470s
   877   936 52671.0867   28  195 36414.9809 62127.1050  70.6% 11291 3512s
H  892   936                    36928.753605 62127.1050  68.2% 11223 3512s
   935  1019 52551.6276   31  173 36928.7536 62127.1050  68.2% 11139 3570s
  1018  1078 51885.7547   35  179 36928.7536 62127.1050  68.2% 10936 3600s
H 1030  1078                    36989.799166 62127.1050  68.0% 10855 3600s

Cutting planes:
  Learned: 4
  Gomory: 30
  Implied bound: 132
  MIR: 2894
  Flow cover: 2699
  RLT: 72
  Relax-and-lift: 582

Explored 1077 nodes (12154459 simplex iterations) in 3600.07 seconds (5134.96 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 36989.8 36928.8 36415 ... 35767.4

Time limit reached
Best objective 3.698979916642e+04, best bound 6.212710504144e+04, gap 67.9574%
  WARNING: Time limit reached. Using best solution found (gap: 67.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 36989.80, θ = 205133.30
  Upper Bound (UB) = 36989.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205133.30
  [DEBUG]   ✓ Scenario 0: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205133.30 ≤ Q = 205133.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 205133.30 ≤ Q = 205133.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 205133.30 ≤ Q = 205133.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 205133.30 ≤ Q = 205133.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 205133.30 ≤ Q = 205133.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 205133.30 ≤ Q = 205133.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x51971dfd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xae68e203
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.238683e+13
Presolve removed 2555 rows and 1844 columns
Presolve time: 0.01s
Presolved: 538 rows, 545 columns, 1520 nonzeros
Found heuristic solution: objective 6328202.0546
Variable types: 369 continuous, 176 integer (176 binary)
Found heuristic solution: objective 6327319.5652

Root relaxation: objective -1.717617e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171761.72    0  120 6327319.57 -171761.72   103%     -    0s
H    0     0                    -130200.2460 -171761.72  31.9%     -    0s
H    0     0                    -131644.6574 -171678.91  30.4%     -    0s
     0     0 -147529.34    0  105 -131644.66 -147529.34  12.1%     -    0s
H    0     0                    -142797.7448 -147481.83  3.28%     -    0s
H    0     0                    -143067.7446 -147481.83  3.09%     -    0s
H    0     0                    -144184.1750 -147481.83  2.29%     -    0s
H    0     0                    -144454.1747 -147481.83  2.10%     -    0s
     0     0 -146158.82    0  108 -144454.17 -146158.82  1.18%     -    0s
H    0     0                    -144761.4597 -146151.59  0.96%     -    0s
     0     0 -146072.74    0  108 -144761.46 -146072.74  0.91%     -    0s
     0     0 -145801.80    0   50 -144761.46 -145801.80  0.72%     -    0s
     0     0 -145693.85    0   72 -144761.46 -145693.85  0.64%     -    0s
     0     0 -145688.89    0   48 -144761.46 -145688.89  0.64%     -    0s
     0     0 -145640.03    0   47 -144761.46 -145640.03  0.61%     -    0s
     0     0 -145628.10    0   47 -144761.46 -145628.10  0.60%     -    0s
H    0     0                    -144772.9387 -145622.33  0.59%     -    0s
H    0     0                    -145036.3409 -145622.33  0.40%     -    0s
     0     2 -145622.33    0   47 -145036.34 -145622.33  0.40%     -    0s
H   41    40                    -145236.9782 -145542.40  0.21%   8.4    0s
H   42    40                    -145265.7536 -145542.40  0.19%   8.4    0s
H  106   143                    -145331.4274 -145521.22  0.13%  10.0    0s
*  129   143              11    -145345.2621 -145514.12  0.12%   9.1    0s
H  171   143                    -145362.8881 -145514.12  0.10%   7.7    0s
H  258   106                    -145419.7510 -145514.12  0.06%   6.5    0s

Cutting planes:
  Gomory: 45
  Implied bound: 1
  MIR: 179
  Flow cover: 12
  RLT: 23
  Relax-and-lift: 3
  BQP: 4

Explored 509 nodes (2957 simplex iterations) in 0.20 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145420 -145363 -145345 ... -144454
No other solutions better than -145420

Optimal solution found (tolerance 1.00e-04)
Best objective -1.454197509508e+05, best bound -1.454197509508e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 196376.24
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145419.75
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -145419.75 = 196376.24
  [DEBUG]   Current θ from Master = 205133.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8757.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28232.74
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = 704.2019, Absolute Gap = 704.2019, Relative Gap = 0.019038
  Not converged yet (gap = 704.20 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654389 nonzeros
Model fingerprint: 0x165fe3f1
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 92815 rows and 37715 columns
Presolve time: 4.75s
Presolved: 137918 rows, 58145 columns, 847475 nonzeros
Variable types: 55886 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309350.3309
Found heuristic solution: objective -198441.0425

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.52s

Barrier statistics:
 Dense cols : 692
 AA' NZ     : 6.237e+06
 Factor NZ  : 1.436e+07 (roughly 200 MB of memory)
 Factor Ops : 3.264e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89698778e+07  2.39671258e+08  1.39e+05 1.79e+01  8.33e+04     7s
   1  -1.45038437e+07  2.20626464e+08  9.83e+04 7.05e+01  5.84e+04     7s
   2  -4.60487452e+06  1.64321491e+08  3.12e+04 9.10e-01  1.97e+04     7s
   3  -9.15659853e+05  1.23832094e+08  1.67e+03 1.92e+00  1.49e+03     8s
   4  -7.36063914e+05  7.20053216e+07  6.08e+02 8.62e-01  6.26e+02     8s
   5  -5.02014389e+05  5.79319826e+07  3.92e+02 6.58e-01  4.40e+02     8s
   6  -3.98891468e+05  4.24046987e+07  1.31e+02 4.42e-01  2.35e+02     8s
   7  -3.63526106e+05  2.89602076e+07  7.87e+01 2.84e-01  1.50e+02     8s
   8  -2.61077431e+05  2.08768323e+07  1.28e+01 1.96e-01  8.87e+01     8s
   9  -1.60639511e+05  1.20936731e+07  1.67e+00 1.10e-01  4.91e+01     8s
  10  -1.09463166e+05  6.56137448e+06  8.01e-01 5.98e-02  2.66e+01     8s
  11  -9.04234331e+04  5.40405794e+06  5.47e-01 4.89e-02  2.19e+01     9s
  12  -7.38996374e+04  3.55446035e+06  3.52e-01 3.15e-02  1.44e+01     9s
  13  -4.78273992e+04  2.05182539e+06  1.90e-01 1.80e-02  8.35e+00     9s
  14  -7.19321256e+03  6.41761286e+05  6.39e-02 5.42e-03  2.58e+00     9s
  15   6.01927120e+03  3.49098774e+05  4.50e-02 2.87e-03  1.36e+00     9s
  16   2.04401910e+04  2.66111141e+05  3.36e-02 2.28e-03  9.76e-01     9s
  17   3.19037388e+04  2.16171563e+05  2.56e-02 1.68e-03  7.32e-01     9s
  18   3.85175955e+04  1.74027759e+05  2.10e-02 1.23e-03  5.39e-01     9s
  19   5.07236109e+04  1.42542578e+05  1.34e-02 8.50e-04  3.65e-01    10s
  20   5.89095103e+04  1.23453385e+05  9.23e-03 5.93e-04  2.57e-01    10s
  21   6.35621798e+04  1.08210308e+05  7.08e-03 4.05e-04  1.77e-01    10s
  22   6.78859023e+04  1.04427625e+05  5.29e-03 3.45e-04  1.45e-01    10s
  23   7.12355143e+04  9.94287316e+04  3.93e-03 2.66e-04  1.12e-01    10s
  24   7.31581370e+04  9.57590725e+04  3.15e-03 2.15e-04  8.98e-02    10s
  25   7.55099724e+04  9.21238043e+04  2.29e-03 1.57e-04  6.60e-02    11s
  26   7.73336013e+04  8.96616891e+04  1.62e-03 1.17e-04  4.90e-02    11s
  27   7.85484754e+04  8.74212525e+04  1.20e-03 8.50e-05  3.53e-02    11s
  28   7.95627041e+04  8.64505312e+04  8.83e-04 7.38e-05  2.74e-02    11s
  29   8.07141195e+04  8.53175497e+04  5.07e-04 5.26e-05  1.83e-02    11s
  30   8.10738015e+04  8.45232887e+04  3.96e-04 3.85e-05  1.37e-02    12s
  31   8.16185002e+04  8.38801510e+04  2.31e-04 2.72e-05  8.99e-03    12s
  32   8.18070390e+04  8.35522006e+04  1.76e-04 2.10e-05  6.93e-03    12s
  33   8.19286004e+04  8.33527601e+04  1.44e-04 1.70e-05  5.66e-03    12s
  34   8.20024442e+04  8.32329334e+04  1.23e-04 1.46e-05  4.89e-03    12s
  35   8.20269132e+04  8.29708367e+04  1.16e-04 9.79e-06  3.75e-03    12s
  36   8.21854838e+04  8.29232729e+04  7.37e-05 8.93e-06  2.93e-03    13s
  37   8.22813295e+04  8.27391734e+04  4.98e-05 5.13e-06  1.82e-03    13s
  38   8.23226903e+04  8.26321255e+04  3.88e-05 3.04e-06  1.23e-03    13s
  39   8.23922613e+04  8.25951593e+04  2.13e-05 2.25e-06  8.06e-04    13s
  40   8.24347651e+04  8.25253452e+04  1.06e-05 8.09e-07  3.60e-04    13s
  41   8.24634531e+04  8.25188681e+04  4.35e-06 6.84e-07  2.20e-04    13s
  42   8.24704749e+04  8.25013585e+04  2.60e-06 3.38e-07  1.23e-04    14s
  43   8.24743045e+04  8.24948551e+04  1.77e-06 2.12e-07  8.17e-05    14s
  44   8.24752816e+04  8.24894824e+04  1.58e-06 1.09e-07  5.64e-05    14s
  45   8.24766018e+04  8.24876966e+04  1.31e-06 7.64e-08  4.41e-05    14s
  46   8.24798870e+04  8.24870511e+04  6.77e-07 6.40e-08  2.85e-05    14s
  47   8.24820430e+04  8.24857891e+04  2.65e-07 4.11e-08  1.49e-05    15s
  48   8.24828705e+04  8.24854285e+04  9.51e-08 3.59e-08  1.02e-05    15s
  49   8.24831840e+04  8.24850876e+04  8.98e-08 2.97e-08  7.57e-06    15s
  50   8.24833908e+04  8.24840527e+04  2.51e-08 1.10e-08  2.63e-06    16s
  51   8.24834146e+04  8.24834531e+04  3.96e-08 1.39e-10  1.54e-07    16s
  52   8.24834328e+04  8.24834379e+04  1.18e-07 3.07e-09  2.05e-08    16s
  53   8.24834347e+04  8.24834378e+04  8.61e-07 1.14e-09  1.25e-08    17s
  54   8.24834348e+04  8.24834378e+04  1.27e-06 2.13e-09  1.24e-08    17s
  55   8.24834377e+04  8.24834378e+04  6.26e-08 4.36e-09  3.93e-10    17s

Barrier solved model in 55 iterations and 16.90 seconds (15.95 work units)
Optimal objective 8.24834377e+04


Root crossover log...

  122358 DPushes remaining with DInf 0.0000000e+00                17s
   40266 DPushes remaining with DInf 0.0000000e+00                20s
    5548 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

    3960 PPushes remaining with PInf 2.3539423e-05                28s
       0 PPushes remaining with PInf 0.0000000e+00                29s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6735209e+00     29s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63944    8.2483438e+04   0.000000e+00   1.673521e+00     29s
   63958    8.2483438e+04   0.000000e+00   0.000000e+00     29s
   63958    8.2483438e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 2.31s

Solved with barrier

Root relaxation: objective 8.248344e+04, 63958 iterations, 25.91 seconds (34.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82483.4378    0  209 -198441.04 82483.4378   142%     -   32s
H    0     0                    -195611.2130 82483.4378   142%     -   32s
H    0     0                    -173295.6458 82483.4378   148%     -   35s
H    0     0                    -171507.9246 82483.4378   148%     -   38s
H    0     0                    -171243.7104 82483.4378   148%     -   38s
H    0     0                    -171089.0187 82483.4378   148%     -   38s
H    0     0                    -21905.74266 82483.4378   477%     -   38s
H    0     0                    -21320.10225 82483.4378   487%     -   39s
H    0     0                    -20945.51695 82483.4378   494%     -   39s
H    0     0                    -20680.83298 82483.4378   499%     -   39s
     0     0 75182.8162    0  231 -20680.833 75182.8162   464%     -  241s
H    0     0                    -14880.37699 75182.7023   605%     -  243s
H    0     0                    3479.6982149 75182.7023  2061%     -  243s
H    0     0                    5957.9714128 75182.7023  1162%     -  243s
     0     0 74157.1698    0  245 5957.97141 74157.1698  1145%     -  329s
     0     0 74068.8510    0  243 5957.97141 74068.8510  1143%     -  360s
     0     0 74031.5812    0  248 5957.97141 74031.5812  1143%     -  379s
     0     0 73953.4821    0  232 5957.97141 73953.4821  1141%     -  403s
     0     0 73912.7446    0  243 5957.97141 73912.7446  1141%     -  427s
     0     0 73855.4085    0  241 5957.97141 73855.4085  1140%     -  435s
     0     0 73848.4336    0  245 5957.97141 73848.4336  1139%     -  438s
     0     0 73846.2706    0  243 5957.97141 73846.2706  1139%     -  439s
     0     0 73772.5715    0  240 5957.97141 73772.5715  1138%     -  464s
     0     0 73768.6628    0  237 5957.97141 73768.6628  1138%     -  468s
     0     0 73697.0163    0  243 5957.97141 73697.0163  1137%     -  498s
     0     0 73660.2264    0  251 5957.97141 73660.2264  1136%     -  520s
     0     0 73648.0223    0  253 5957.97141 73648.0223  1136%     -  528s
     0     0 73647.3097    0  253 5957.97141 73647.3097  1136%     -  530s
     0     0 70268.9297    0  282 5957.97141 70268.9297  1079%     -  667s
H    0     0                    19762.030569 70268.8845   256%     -  668s
H    0     0                    25516.686703 70268.8845   175%     -  668s
H    0     0                    26534.789185 70268.8845   165%     -  668s
H    0     0                    27649.811957 70268.8845   154%     -  668s
H    0     0                    27672.934385 70268.8845   154%     -  668s
H    0     0                    27701.419504 70268.8845   154%     -  668s
H    0     0                    27853.412586 70268.8845   152%     -  668s
H    0     0                    27909.234620 70268.8845   152%     -  668s
H    0     0                    28138.694396 70268.8845   150%     -  668s
H    0     0                    28402.632314 70268.8845   147%     -  668s
H    0     0                    28605.381786 70268.8845   146%     -  668s
     0     0 69479.8270    0  314 28605.3818 69479.8270   143%     -  807s
     0     0 69311.0825    0  325 28605.3818 69311.0825   142%     -  840s
     0     0 68831.1336    0  317 28605.3818 68831.1336   141%     -  876s
     0     0 68773.6188    0  331 28605.3818 68773.6188   140%     -  895s
     0     0 68718.3884    0  336 28605.3818 68718.3884   140%     -  916s
     0     0 68680.2794    0  332 28605.3818 68680.2794   140%     -  926s
     0     0 68569.5327    0  337 28605.3818 68569.5327   140%     -  944s
     0     0 68557.1317    0  335 28605.3818 68557.1317   140%     -  948s
     0     0 68549.0676    0  335 28605.3818 68549.0676   140%     -  952s
     0     0 68531.7489    0  339 28605.3818 68531.7489   140%     -  958s
     0     0 68460.7649    0  328 28605.3818 68460.7649   139%     -  974s
     0     0 68436.4509    0  336 28605.3818 68436.4509   139%     -  986s
     0     0 68433.1542    0  334 28605.3818 68433.1542   139%     -  991s
     0     0 68422.7374    0  339 28605.3818 68422.7374   139%     -  998s
     0     0 68368.5356    0  333 28605.3818 68368.5356   139%     - 1012s
     0     0 68358.7942    0  336 28605.3818 68358.7942   139%     - 1021s
     0     0 68346.8621    0  337 28605.3818 68346.8621   139%     - 1032s
     0     0 68340.4122    0  346 28605.3818 68340.4122   139%     - 1038s
     0     0 68339.3505    0  348 28605.3818 68339.3505   139%     - 1041s
     0     0 65766.9287    0  341 28605.3818 65766.9287   130%     - 1209s
H    0     0                    32065.619967 65765.9397   105%     - 1210s
H    0     0                    32335.582677 65765.9397   103%     - 1210s
     0     0 65165.1674    0  350 32335.5827 65165.1674   102%     - 1275s
     0     0 64953.7266    0  348 32335.5827 64953.7266   101%     - 1312s
     0     0 64822.0667    0  391 32335.5827 64822.0667   100%     - 1339s
     0     0 64728.1456    0  352 32335.5827 64728.1456   100%     - 1364s
     0     0 64662.4734    0  354 32335.5827 64662.4734   100%     - 1380s
     0     0 64640.1316    0  350 32335.5827 64640.1316   100%     - 1392s
     0     0 64615.7528    0  357 32335.5827 64615.7528   100%     - 1404s
     0     0 64586.5579    0  360 32335.5827 64586.5579   100%     - 1419s
     0     0 64583.6903    0  354 32335.5827 64583.6903   100%     - 1424s
     0     0 64574.0003    0  359 32335.5827 64574.0003   100%     - 1430s
     0     0 64567.5566    0  353 32335.5827 64567.5566   100%     - 1433s
     0     0 64561.9728    0  354 32335.5827 64561.9728   100%     - 1438s
     0     0 64560.6879    0  358 32335.5827 64560.6879   100%     - 1440s
     0     0 63812.8546    0  405 32335.5827 63812.8546  97.3%     - 1515s
H    0     0                    33070.871325 63812.5249  93.0%     - 1517s
H    0     0                    33299.435421 63812.5249  91.6%     - 1517s
     0     0 63595.9325    0  410 33299.4354 63595.9325  91.0%     - 1544s
     0     0 63526.6899    0  414 33299.4354 63526.6899  90.8%     - 1563s
     0     0 63421.0484    0  417 33299.4354 63421.0484  90.5%     - 1583s
     0     0 63383.2081    0  416 33299.4354 63383.2081  90.3%     - 1600s
     0     0 63337.9015    0  413 33299.4354 63337.9015  90.2%     - 1614s
     0     0 63308.6655    0  420 33299.4354 63308.6655  90.1%     - 1626s
     0     0 63261.9369    0  421 33299.4354 63261.9369  90.0%     - 1643s
     0     0 63253.5554    0  417 33299.4354 63253.5554  90.0%     - 1650s
     0     0 63246.6782    0  421 33299.4354 63246.6782  89.9%     - 1656s
     0     0 63241.6776    0  423 33299.4354 63241.6776  89.9%     - 1662s
     0     0 63235.7745    0  421 33299.4354 63235.7745  89.9%     - 1668s
     0     0 63234.3568    0  422 33299.4354 63234.3568  89.9%     - 1670s
     0     0 62922.4520    0  400 33299.4354 62922.4520  89.0%     - 1707s
     0     0 62849.9687    0  398 33299.4354 62849.9687  88.7%     - 1726s
     0     0 62837.8443    0  431 33299.4354 62837.8443  88.7%     - 1738s
     0     0 62815.5707    0  441 33299.4354 62815.5707  88.6%     - 1750s
     0     0 62809.8241    0  422 33299.4354 62809.8241  88.6%     - 1756s
     0     0 62806.3866    0  430 33299.4354 62806.3866  88.6%     - 1760s
     0     0 62805.1437    0  438 33299.4354 62805.1437  88.6%     - 1762s
     0     0 62737.0557    0  496 33299.4354 62737.0557  88.4%     - 1788s
     0     0 62725.5091    0  489 33299.4354 62725.5091  88.4%     - 1798s
     0     0 62719.5656    0  478 33299.4354 62719.5656  88.4%     - 1805s
     0     0 62715.9711    0  463 33299.4354 62715.9711  88.3%     - 1809s
     0     0 62714.9780    0  493 33299.4354 62714.9780  88.3%     - 1816s
     0     0 62695.0458    0  444 33299.4354 62695.0458  88.3%     - 1829s
     0     0 62674.9896    0  428 33299.4354 62674.9896  88.2%     - 1839s
     0     0 62670.0356    0  464 33299.4354 62670.0356  88.2%     - 1846s
     0     0 62668.1760    0  429 33299.4354 62668.1760  88.2%     - 1848s
     0     0 62645.7329    0  456 33299.4354 62645.7329  88.1%     - 1861s
     0     0 62622.7382    0  487 33299.4354 62622.7382  88.1%     - 1871s
     0     0 62618.1042    0  489 33299.4354 62618.1042  88.0%     - 1875s
     0     0 62617.0384    0  463 33299.4354 62617.0384  88.0%     - 1877s
     0     0 62611.8386    0  454 33299.4354 62611.8386  88.0%     - 1884s
     0     0 62606.7541    0  457 33299.4354 62606.7541  88.0%     - 1893s
     0     0 62604.1246    0  453 33299.4354 62604.1246  88.0%     - 1896s
     0     0 62587.9082    0  417 33299.4354 62587.9082  88.0%     - 1908s
     0     0 62580.3761    0  419 33299.4354 62580.3761  87.9%     - 1915s
     0     0 62578.3322    0  420 33299.4354 62578.3322  87.9%     - 1921s
     0     0 62571.0019    0  459 33299.4354 62571.0019  87.9%     - 1930s
H    0     0                    33792.216476 62570.3777  85.2%     - 1931s
     0     0 62568.8356    0  424 33792.2165 62568.8356  85.2%     - 1934s
     0     0 62566.6285    0  445 33792.2165 62566.6285  85.2%     - 1940s
     0     0 62566.0774    0  445 33792.2165 62566.0774  85.1%     - 1945s
H    0     0                    35671.586892 62566.0774  75.4%     - 2294s
H    0     0                    35795.811946 62566.0774  74.8%     - 2305s
H    0     0                    35900.260534 62566.0774  74.3%     - 2305s
H    0     2                    35959.414626 62566.0774  74.0%     - 2323s
     0     2 62566.0774    0  445 35959.4146 62566.0774  74.0%     - 2323s
     1     3 61553.0983    1  370 35959.4146 62563.9939  74.0% 20690 2370s
     2     4 62343.0056    1  483 35959.4146 62343.0056  73.4% 16778 2413s
     3     8 62118.4211    2  395 35959.4146 62342.8594  73.4% 16067 2450s
     7    14 59973.9397    3  375 35959.4146 62156.5578  72.9% 14662 2593s
    13    26 59085.0574    4  386 35959.4146 62117.7853  72.7% 23624 2667s
    25    38 60459.2903    5  383 35959.4146 62029.1456  72.5% 29949 2830s
    37    68 60002.8155    6  374 35959.4146 61896.9914  72.1% 30365 3129s
H   38    68                    36107.885517 61896.9914  71.4% 29566 3129s
    67   102 59804.7941    7  357 36107.8855 61896.9914  71.4% 28089 3343s
   101   197 59600.9083    8  349 36107.8855 61896.9914  71.4% 25055 3496s
   196   282 59226.4419   12  348 36107.8855 61896.9914  71.4% 18284 3600s

Cutting planes:
  Learned: 2
  Gomory: 17
  Implied bound: 166
  MIR: 3002
  Flow cover: 2976
  RLT: 62
  Relax-and-lift: 533

Explored 281 nodes (5022811 simplex iterations) in 3600.05 seconds (4675.64 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 36107.9 35959.4 35795.8 ... 28605.4

Time limit reached
Best objective 3.610788551739e+04, best bound 6.189699139244e+04, gap 71.4224%
  WARNING: Time limit reached. Using best solution found (gap: 71.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 36107.89, θ = 207283.34
  Upper Bound (UB) = 36107.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207283.34
  [DEBUG]   ✓ Scenario 0: θ = 207283.34 ≤ Q = 207283.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 207283.34 ≤ Q = 207283.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 207283.34 ≤ Q = 207283.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 207283.34 ≤ Q = 207283.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 207283.34 ≤ Q = 207283.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 207283.34 ≤ Q = 207283.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 207283.34 ≤ Q = 207283.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2136d5c9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2136d5c9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.254965e+13
Presolve removed 2542 rows and 1833 columns
Presolve time: 0.01s
Presolved: 551 rows, 556 columns, 1555 nonzeros
Found heuristic solution: objective 6484230.3404
Variable types: 378 continuous, 178 integer (178 binary)

Root relaxation: objective -1.689237e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168923.71    0  124 6484230.34 -168923.71   103%     -    0s
H    0     0                    -130392.5714 -168923.71  29.6%     -    0s
H    0     0                    -131190.7526 -168923.71  28.8%     -    0s
H    0     0                    -131787.3734 -168923.71  28.2%     -    0s
H    0     0                    -135277.7215 -168923.71  24.9%     -    0s
     0     0 -148299.17    0  109 -135277.72 -148299.17  9.63%     -    0s
H    0     0                    -143958.6290 -148186.86  2.94%     -    0s
H    0     0                    -144261.7010 -148186.86  2.72%     -    0s
H    0     0                    -145505.0299 -148186.86  1.84%     -    0s
     0     0 -146810.77    0  111 -145505.03 -146810.77  0.90%     -    0s
     0     0 -146789.26    0  111 -145505.03 -146789.26  0.88%     -    0s
     0     0 -146124.27    0   54 -145505.03 -146124.27  0.43%     -    0s
     0     0 -146035.22    0   74 -145505.03 -146035.22  0.36%     -    0s
     0     0 -146022.87    0   73 -145505.03 -146022.87  0.36%     -    0s
     0     0 -145821.67    0   37 -145505.03 -145821.67  0.22%     -    0s
     0     0 -145794.07    0   44 -145505.03 -145794.07  0.20%     -    0s
     0     0 -145751.48    0   38 -145505.03 -145751.48  0.17%     -    0s
     0     0 -145731.82    0   38 -145505.03 -145731.82  0.16%     -    0s
H    0     0                    -145511.0891 -145731.82  0.15%     -    0s
H    0     0                    -145555.6759 -145731.82  0.12%     -    0s
     0     0 -145731.82    0   64 -145555.68 -145731.82  0.12%     -    0s
     0     0 -145731.82    0   64 -145555.68 -145731.82  0.12%     -    0s
     0     0 -145731.82    0   32 -145555.68 -145731.82  0.12%     -    0s
H    0     0                    -145556.4758 -145644.06  0.06%     -    0s
     0     0 -145644.06    0   30 -145556.48 -145644.06  0.06%     -    0s
     0     0 -145635.67    0   27 -145556.48 -145635.67  0.05%     -    0s
     0     0 -145618.15    0   11 -145556.48 -145618.15  0.04%     -    0s
     0     0 -145608.79    0    8 -145556.48 -145608.79  0.04%     -    0s
     0     0          -    0      -145556.48 -145568.54  0.01%     -    0s

Cutting planes:
  Gomory: 25
  Implied bound: 20
  MIR: 38
  Flow cover: 30
  RLT: 2
  Relax-and-lift: 3

Explored 1 nodes (1128 simplex iterations) in 0.21 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145556 -145556 -145511 ... -130393

Optimal solution found (tolerance 1.00e-04)
Best objective -1.455564758083e+05, best bound -1.455685358360e+05, gap 0.0083%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 196239.51
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145556.48
  [DEBUG]   S×d_nominal = 341795.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341795.99 + -145556.48 = 196239.51
  [DEBUG]   Current θ from Master = 207283.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11043.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25064.06
  Lower Bound (LB) = 36285.60
  Gap (UB-LB) = -177.7117, Absolute Gap = 177.7117, Relative Gap = -0.004922
  *** CONVERGED (small negative gap: -177.71 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 15
Total Time: 44363.24s
Converged: True
Final Lower Bound: 36285.5973
Final Upper Bound: 36107.8855
Final Gap: -177.711743
Number of Critical Scenarios: 15
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0, 1] (2/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 4
DCs Opened: [0, 4, 5, 7, 9] (5/10)
Active Routes (Plant→DC): 15
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 15
Start Time: 2026-01-05 15:25:19
End Time: 2026-01-06 03:44:42
Total Time: 44363.24s
Optimal Value: 36285.60
Lower Bound: 36285.60
Upper Bound: 36107.89
Gap: -177.711743
Plants Opened: {0: [0, 1], 1: [0], 2: [0]} (4 plants)
DCs Opened: [0, 4, 5, 7, 9] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed41_HD_gamma20_20260106_034442.csv

Total Execution Time: 44363.70 seconds
End Time: 2026-01-06 03:44:42

All tasks completed successfully!

