
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 3
DI Scenario: LD
Start Time: 2026-01-05 15:25:19
================================================================================
Loading data from data/DH_data_full_seed3.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.001', '1.002'] (k=0.002)
  Product 1: ['1.000', '1.130', '1.276'] (k=0.301)
  Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1680
  DC capacity (MC): min=517, max=897

Demand Structure (s_rk matrix):
  Total customer-product pairs: 72/150 (52.0% sparse)
  Average products per customer: 1.44

Demand (only non-zero entries):
  Nominal (μ): min=8.19, max=34.85, count=72
  Deviation (μ̂): min=4.03, max=9.90

Costs:
  Plant fixed cost: min=5861, max=8650
  DC fixed cost: min=3689, max=4911
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.390', '1.932'] (k=0.812)
    Product 2: ['1.000', '1.313', '1.725'] (k=0.672)
  MD:
    Product 0: ['1.000', '1.241', '1.540'] (k=0.532)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.230', '1.514'] (k=0.512)
  LD:
    Product 0: ['1.000', '1.001', '1.002'] (k=0.002)
    Product 1: ['1.000', '1.130', '1.276'] (k=0.301)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
  Mixed:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48726 nonzeros
Model fingerprint: 0xd5d765a0
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12199 rows and 3199 columns
Presolve time: 0.19s
Presolved: 4474 rows, 5301 columns, 31241 nonzeros
Variable types: 3042 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340063.9009
Found heuristic solution: objective -171323.3514

Root relaxation: objective 4.673914e+04, 3965 iterations, 0.12 seconds (0.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46739.1351    0  428 -171323.35 46739.1351   127%     -    0s
     0     0 44638.2305    0  616 -171323.35 44638.2305   126%     -    0s
H    0     0                    -169795.4741 44629.4716   126%     -    0s
H    0     0                    -161568.5570 44495.2296   128%     -    0s
     0     0 44495.2296    0  616 -161568.56 44495.2296   128%     -    0s
     0     0 44485.6399    0  684 -161568.56 44485.6399   128%     -    0s
     0     0 44484.1444    0  683 -161568.56 44484.1444   128%     -    0s
     0     0 41476.2822    0  958 -161568.56 41476.2822   126%     -    1s
H    0     0                    -128886.6595 41472.2989   132%     -    1s
     0     0 41280.4460    0  964 -128886.66 41280.4460   132%     -    1s
     0     0 41259.4457    0  970 -128886.66 41259.4457   132%     -    1s
     0     0 41258.5307    0  966 -128886.66 41258.5307   132%     -    1s
H    0     0                    -52319.52663 39437.8845   175%     -    3s
H    0     0                    -2837.749053 39437.8845  1490%     -    3s
H    0     0                    -2677.394564 39437.8845  1573%     -    3s
     0     0 39437.8845    0 1157 -2677.3946 39437.8845  1573%     -    3s
     0     0 39031.1136    0 1156 -2677.3946 39031.1136  1558%     -    3s
     0     0 39031.1136    0 1151 -2677.3946 39031.1136  1558%     -    3s
H    0     0                    -2613.562188 39031.1136  1593%     -    3s
     0     0 39031.1136    0 1155 -2613.5622 39031.1136  1593%     -    3s
     0     0 39021.2611    0 1160 -2613.5622 39021.2611  1593%     -    3s
H    0     0                    -2612.708690 38283.0166  1565%     -    4s
H    0     0                    -2594.085993 38283.0166  1576%     -    4s
H    0     0                    -2475.455277 37629.7051  1620%     -    5s
H    0     0                    -2403.217682 37629.7051  1666%     -    5s
     0     0 37629.7051    0 1339 -2403.2177 37629.7051  1666%     -    5s
H    0     0                    2493.6399450 37292.7936  1396%     -    6s
H    0     0                    2607.8133481 37292.7936  1330%     -    6s
H    0     0                    2773.8877428 37292.7936  1244%     -    6s
H    0     0                    2888.0611459 37292.7936  1191%     -    6s
H    0     0                    3180.9584312 37292.7936  1072%     -    6s
H    0     0                    3435.5821438 37292.7936   985%     -    6s
H    0     0                    3455.5580210 37292.7936   979%     -    6s
H    0     0                    3500.5341361 37292.7936   965%     -    6s
     0     0 37292.7936    0 1342 3500.53414 37292.7936   965%     -    6s
     0     0 37247.8751    0 1353 3500.53414 37247.8751   964%     -    6s
     0     0 37198.2219    0 1353 3500.53414 37198.2219   963%     -    6s
     0     0 36452.2866    0 1387 3500.53414 36452.2866   941%     -    7s
     0     0 36335.3538    0 1290 3500.53414 36335.3538   938%     -    8s
     0     0 36294.7517    0 1311 3500.53414 36294.7517   937%     -    8s
     0     0 36291.2734    0 1308 3500.53414 36291.2734   937%     -    8s
     0     0 35581.7044    0 1439 3500.53414 35581.7044   916%     -   10s
     0     0 35396.1048    0 1462 3500.53414 35396.1048   911%     -   11s
     0     0 35374.0826    0 1469 3500.53414 35374.0826   911%     -   11s
     0     0 35370.6943    0 1479 3500.53414 35370.6943   910%     -   11s
H    0     0                    4758.7923765 35370.6943   643%     -   11s
H    0     0                    4789.1693925 35370.6943   639%     -   11s
H    0     0                    4804.1066350 35370.6943   636%     -   11s
H    0     0                    5087.2279282 34591.2900   580%     -   13s
H    0     0                    5118.6697533 34591.2900   576%     -   13s
H    0     0                    5129.8945019 34591.2900   574%     -   13s
H    0     0                    5286.0646773 34591.2900   554%     -   13s
H    0     0                    5300.8990427 34591.2900   553%     -   13s
H    0     0                    7415.5544515 34591.2900   366%     -   13s
H    0     0                    7665.1284136 34591.2900   351%     -   13s
H    0     0                    7672.4436046 34591.2900   351%     -   13s
H    0     0                    7693.7729859 34591.2900   350%     -   13s
H    0     0                    7782.9746567 34591.2900   344%     -   13s
H    0     0                    7838.9388864 34591.2900   341%     -   13s
     0     0 34591.2900    0 1402 7838.93889 34591.2900   341%     -   13s
H    0     0                    8205.4941540 34414.8826   319%     -   14s
H    0     0                    8562.4436009 34414.8826   302%     -   14s
H    0     0                    8565.8294328 34414.8826   302%     -   14s
H    0     0                    8611.8634208 34414.8826   300%     -   14s
H    0     0                    8615.2492526 34414.8826   299%     -   14s
H    0     0                    8622.5644436 34414.8826   299%     -   14s
     0     0 34414.8826    0 1441 8622.56444 34414.8826   299%     -   14s
     0     0 34400.0140    0 1454 8622.56444 34400.0140   299%     -   15s
     0     0 34395.6073    0 1466 8622.56444 34395.6073   299%     -   15s
H    0     0                    8625.0832733 33728.4882   291%     -   17s
H    0     0                    8655.7531870 33728.4882   290%     -   17s
H    0     0                    8708.5588387 33728.4882   287%     -   17s
     0     0 33348.4042    0 1478 8708.55884 33348.4042   283%     -   17s
H    0     0                    8714.5155283 33348.4042   283%     -   18s
H    0     0                    8812.3314497 33348.4042   278%     -   18s
H    0     0                    8825.3993874 33348.4042   278%     -   18s
H    0     0                    8827.9182171 33348.4042   278%     -   18s
H    0     0                    8845.4847263 33348.4042   277%     -   18s
H    0     0                    8899.8153577 33348.4042   275%     -   18s
H    0     0                    8900.8974537 33348.4042   275%     -   18s
     0     0 33344.6815    0 1490 8900.89745 33344.6815   275%     -   18s
     0     0 33344.6815    0 1487 8900.89745 33344.6815   275%     -   19s
     0     0 32985.6990    0 1496 8900.89745 32985.6990   271%     -   19s
     0     0 32985.6990    0 1505 8900.89745 32985.6990   271%     -   19s
     0     0 32724.0127    0 1495 8900.89745 32724.0127   268%     -   21s
     0     0 32655.3819    0 1480 8900.89745 32655.3819   267%     -   22s
     0     0 32368.4591    0 1503 8900.89745 32368.4591   264%     -   23s
     0     0 32368.4591    0 1506 8900.89745 32368.4591   264%     -   23s
     0     0 32272.8794    0 1471 8900.89745 32272.8794   263%     -   25s
     0     0 32213.7830    0 1513 8900.89745 32213.7830   262%     -   27s
     0     0 32152.3226    0 1509 8900.89745 32152.3226   261%     -   27s
     0     0 32071.1185    0 1529 8900.89745 32071.1185   260%     -   27s
H    0     0                    8918.5466713 32071.1185   260%     -   29s
     0     0 31988.3798    0 1503 8918.54667 31988.3798   259%     -   29s
     0     0 31804.3287    0 1521 8918.54667 31804.3287   257%     -   30s
H    0     0                    8922.4894637 31804.3287   256%     -   31s
H    0     0                    8924.6283331 31804.3287   256%     -   31s
H    0     0                    8928.0141649 31804.3287   256%     -   31s
     0     0 31725.9391    0 1542 8928.01416 31725.9391   255%     -   31s
     0     0 31725.9391    0 1540 8928.01416 31725.9391   255%     -   31s
H    0     0                    8960.0270018 31718.9257   254%     -   33s
     0     0 31544.1290    0 1501 8960.02700 31544.1290   252%     -   34s
H    0     0                    9151.5284749 31544.1290   245%     -   35s
     0     0 31539.1186    0 1512 9151.52847 31539.1186   245%     -   35s
     0     0 31501.0234    0 1516 9151.52847 31501.0234   244%     -   35s
     0     0 31488.9418    0 1540 9151.52847 31488.9418   244%     -   36s
     0     0 31204.3712    0 1531 9151.52847 31204.3712   241%     -   38s
     0     0 31145.6866    0 1561 9151.52847 31145.6866   240%     -   39s
     0     0 31143.8378    0 1554 9151.52847 31143.8378   240%     -   40s
     0     0 30899.8257    0 1479 9151.52847 30899.8257   238%     -   42s
H    0     0                    9211.0588333 30899.8257   235%     -   43s
     0     0 30791.6642    0 1518 9211.05883 30791.6642   234%     -   43s
     0     0 30791.6642    0 1527 9211.05883 30791.6642   234%     -   44s
     0     0 30723.5240    0 1488 9211.05883 30723.5240   234%     -   46s
     0     0 30680.9455    0 1521 9211.05883 30680.9455   233%     -   47s
     0     0 30634.4953    0 1534 9211.05883 30634.4953   233%     -   47s
     0     0 30546.8832    0 1502 9211.05883 30546.8832   232%     -   49s
     0     0 30509.5495    0 1517 9211.05883 30509.5495   231%     -   50s
     0     0 30452.4417    0 1523 9211.05883 30452.4417   231%     -   51s
     0     0 30410.7204    0 1491 9211.05883 30410.7204   230%     -   53s
     0     0 30325.3785    0 1501 9211.05883 30325.3785   229%     -   54s
     0     0 30325.3785    0 1507 9211.05883 30325.3785   229%     -   54s
H    0     0                    9257.1314012 30294.8421   227%     -   56s
H    0     0                    9311.6462785 30294.8421   225%     -   56s
     0     0 30269.2981    0 1463 9311.64628 30269.2981   225%     -   56s
     0     0 30229.7697    0 1490 9311.64628 30229.7697   225%     -   57s
     0     0 30217.3945    0 1491 9311.64628 30217.3945   225%     -   58s
     0     0 30103.7544    0 1464 9311.64628 30103.7544   223%     -   60s
     0     0 30064.4218    0 1476 9311.64628 30064.4218   223%     -   61s
     0     0 30056.0927    0 1481 9311.64628 30056.0927   223%     -   61s
     0     0 29945.3412    0 1458 9311.64628 29945.3412   222%     -   63s
     0     0 29945.3002    0 1458 9311.64628 29945.3002   222%     -   63s
     0     2 29945.2804    0 1458 9311.64628 29945.2804   222%     -   66s
     1     4 29014.7983    1 1322 9311.64628 29944.0273   222%  6077   73s
     3     8 28608.7159    2 1202 9311.64628 29006.3731   212%  7788   80s
    15    32 27667.3901    4  961 9311.64628 28232.9676   203%  5570   85s
H   95   179                    9314.9933906 26191.0182   181%  3264   91s
H  102   179                    9362.1797457 26191.0182   180%  3155   91s
   338   381 11722.4114   12  382 9362.17975 25345.4563   171%  1725   96s
H  496   491                    9379.7891771 24399.8585   160%  1401   99s
   558   520 11643.4417   18  469 9379.78918 24006.5989   156%  1316  100s
H  604   549                    9381.9280464 24006.5989   156%  1269  101s
   730   675     cutoff   22      9381.92805 23090.1549   146%  1179  107s
   879   796 13023.3944   10  602 9381.92805 22213.9022   137%  1110  111s
  1016   888 11187.8477   12  576 9381.92805 21876.7478   133%  1072  115s
  1394  1129     cutoff   20      9381.92805 21554.8298   130%  1180  120s
  1592  1172 10235.7533    8  238 9381.92805 21424.1166   128%  1145  125s
  1727  1229 9605.58674    9  235 9381.92805 20636.1123   120%  1138  131s
  1893  1317     cutoff   12      9381.92805 20546.7935   119%  1134  136s
  2329  1559 10227.9237   14  203 9381.92805 20213.1727   115%  1064  141s
  2753  1761 16014.3463   11  692 9381.92805 19666.1440   110%  1039  145s
  3149  1898 12886.6240   20  568 9381.92805 18888.1797   101%  1043  151s
  3212  1955 12868.1874   21  569 9381.92805 18888.1797   101%  1042  155s
  3447  2232 12723.0404   23  556 9381.92805 18495.8243  97.1%  1029  162s
  3723  2398 11251.9198   35  526 9381.92805 18495.8243  97.1%  1007  165s
  4016  2399 12211.2838   20 1458 9381.92805 18401.6194  96.1%  1010  187s
  4020  2402 10513.1314   42  491 9381.92805 17397.2110  85.4%  1009  190s
  4036  2412 11500.0553   20  614 9381.92805 14232.4503  51.7%  1005  195s
  4163  2385 11599.5156   17  257 9381.92805 11654.7961  24.2%   985  200s

Cutting planes:
  Implied bound: 2
  Projected implied bound: 52
  MIR: 166
  Flow cover: 349
  Zero half: 12
  RLT: 3
  Relax-and-lift: 79

Explored 4226 nodes (4219874 simplex iterations) in 200.93 seconds (255.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9381.93 9379.79 9362.18 ... 8928.01

Optimal solution found (tolerance 1.00e-04)
Best objective 9.381928046441e+03, best bound 9.381928046441e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 200.94s
  Master Objective (UB) = 9381.93, θ = 125289.83
  Upper Bound (UB) = 9381.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 125289.83
  [DEBUG]   ✓ Scenario 0: θ = 125289.83 ≤ Q = 125289.83 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x199a6b2f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe66594d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.594741e+13
Presolve removed 2652 rows and 1946 columns
Presolve time: 0.01s
Presolved: 441 rows, 443 columns, 1242 nonzeros
Found heuristic solution: objective 7544945.9018
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.103260e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110326.02    0  123 7544945.90 -110326.02   101%     -    0s
H    0     0                    -81839.25420 -110326.02  34.8%     -    0s
H    0     0                    -82008.83356 -110326.02  34.5%     -    0s
H    0     0                    -83375.85748 -83375.857  0.00%     -    0s
     0     0          -    0      -83375.857 -83375.857  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 195

Explored 1 nodes (360 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -83375.9 -82008.8 -81839.3 ... 1.59474e+13
No other solutions better than -83375.9

Optimal solution found (tolerance 1.00e-04)
Best objective -8.337585748176e+04, best bound -8.337585748176e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 93087.63
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83375.86
  [DEBUG]   S×d_nominal = 176463.49
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 176463.49 + -83375.86 = 93087.63
  [DEBUG]   Current θ from Master = 125289.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32202.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22820.27
  Lower Bound (LB) = -22820.27
  Gap (UB-LB) = 32202.1991, Absolute Gap = 32202.1991, Relative Gap = 3.432365
  Not converged yet (gap = 32202.20 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91933 nonzeros
Model fingerprint: 0x722708d6
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -22820.3 (0.02s)
MIP start from previous solve produced solution with objective -22820.3 (0.02s)
Loaded MIP start from previous solve with objective -22820.3

Presolve removed 15757 rows and 6396 columns
Presolve time: 0.43s
Presolved: 16206 rows, 8344 columns, 89438 nonzeros
Variable types: 6085 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.263840e+03, 10220 iterations, 2.24 seconds (3.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 4263.84006    0  465 -22820.271 4263.84006   119%     -    2s
H    0     0                    -22672.30077 4263.84006   119%     -    2s
H    0     0                    -22636.37986 4263.84006   119%     -    2s
     0     0 -2252.1593    0  815 -22636.380 -2252.1593  90.1%     -    6s
     0     0 -2392.5265    0  820 -22636.380 -2392.5265  89.4%     -    6s
     0     0 -2403.8419    0  816 -22636.380 -2403.8419  89.4%     -    6s
     0     0 -2403.8431    0  816 -22636.380 -2403.8431  89.4%     -    6s
     0     0 -7449.1894    0  813 -22636.380 -7449.1894  67.1%     -   10s
H    0     0                    -22635.02110 -7449.4803  67.1%     -   10s
H    0     0                    -22630.07285 -7449.4803  67.1%     -   10s
H    0     0                    -22627.04837 -7449.4803  67.1%     -   10s
H    0     0                    -22621.06655 -7449.4803  67.1%     -   10s
H    0     0                    -22616.11830 -7449.4803  67.1%     -   10s
H    0     0                    -22610.13648 -7449.4803  67.1%     -   10s
     0     0 -7826.3562    0  803 -22610.136 -7826.3562  65.4%     -   11s
     0     0 -7838.9455    0  799 -22610.136 -7838.9455  65.3%     -   11s
     0     0 -7849.6792    0  820 -22610.136 -7849.6792  65.3%     -   11s
     0     0 -7850.5244    0  817 -22610.136 -7850.5244  65.3%     -   11s
H    0     0                    -22159.91324 -7850.5244  64.6%     -   13s
H    0     0                    -22012.44634 -7850.5244  64.3%     -   13s
H    0     0                    -21718.43304 -7850.5244  63.9%     -   13s
     0     0 -9896.9331    0  542 -21718.433 -9896.9331  54.4%     -   15s
H    0     0                    -20728.10956 -9898.1231  52.2%     -   16s
H    0     0                    -19730.50767 -9898.1231  49.8%     -   16s
H    0     0                    -19671.79619 -9898.1231  49.7%     -   16s
H    0     0                    -18294.09445 -10536.898  42.4%     -   17s
H    0     0                    -17882.52742 -10536.898  41.1%     -   17s
H    0     0                    -17866.88400 -10536.898  41.0%     -   17s
H    0     0                    -17563.41700 -10536.898  40.0%     -   17s
H    0     0                    -17030.52847 -10536.898  38.1%     -   17s
     0     0 -10536.898    0  752 -17030.528 -10536.898  38.1%     -   17s
     0     0 -10648.906    0  674 -17030.528 -10648.906  37.5%     -   18s
     0     0 -10672.566    0  679 -17030.528 -10672.566  37.3%     -   18s
H    0     0                    -17017.47717 -10682.669  37.2%     -   19s
H    0     0                    -17015.35145 -10682.669  37.2%     -   19s
     0     0 -10682.669    0  677 -17015.351 -10682.669  37.2%     -   19s
     0     0 -10683.475    0  676 -17015.351 -10683.475  37.2%     -   19s
     0     0 -11325.942    0  528 -17015.351 -11325.942  33.4%     -   23s
H    0     0                    -16988.55914 -11326.728  33.3%     -   23s
     0     0 -11514.190    0  561 -16988.559 -11514.190  32.2%     -   24s
     0     0 -11545.631    0  637 -16988.559 -11545.631  32.0%     -   24s
     0     0 -11556.459    0  560 -16988.559 -11556.459  32.0%     -   25s
     0     0 -11557.230    0  565 -16988.559 -11557.230  32.0%     -   25s
     0     0 -11890.086    0  608 -16988.559 -11890.086  30.0%     -   27s
H    0     0                    -16987.69942 -11890.376  30.0%     -   27s
H    0     0                    -16983.47712 -11890.376  30.0%     -   27s
     0     0 -11942.907    0  522 -16983.477 -11942.907  29.7%     -   28s
     0     0 -11951.724    0  715 -16983.477 -11951.724  29.6%     -   28s
     0     0 -11952.511    0  717 -16983.477 -11952.511  29.6%     -   28s
H    0     0                    -16973.36712 -12044.184  29.0%     -   29s
     0     0 -12044.184    0  687 -16973.367 -12044.184  29.0%     -   29s
H    0     0                    -16949.68914 -12044.218  28.9%     -   30s
     0     0 -12096.907    0  532 -16949.689 -12096.907  28.6%     -   30s
     0     0 -12104.585    0  796 -16949.689 -12104.585  28.6%     -   31s
     0     0 -12109.112    0  804 -16949.689 -12109.112  28.6%     -   31s
     0     0 -12182.180    0  802 -16949.689 -12182.180  28.1%     -   32s
H    0     0                    -16918.13037 -12182.362  28.0%     -   32s
     0     0 -12191.313    0  516 -16918.130 -12191.313  27.9%     -   33s
     0     0 -12195.708    0  508 -16918.130 -12195.708  27.9%     -   33s
     0     0 -12241.598    0  603 -16918.130 -12241.598  27.6%     -   34s
     0     0 -12257.663    0  531 -16918.130 -12257.663  27.5%     -   34s
     0     0 -12262.345    0  613 -16918.130 -12262.345  27.5%     -   35s
     0     0 -12362.077    0  729 -16918.130 -12362.077  26.9%     -   36s
     0     0 -12387.792    0  617 -16918.130 -12387.792  26.8%     -   37s
     0     0 -12393.575    0  523 -16918.130 -12393.575  26.7%     -   37s
     0     0 -12419.947    0  704 -16918.130 -12419.947  26.6%     -   38s
     0     0 -12434.810    0  518 -16918.130 -12434.810  26.5%     -   39s
     0     0 -12437.789    0  535 -16918.130 -12437.789  26.5%     -   39s
     0     0 -12465.164    0  526 -16918.130 -12465.164  26.3%     -   40s
     0     0 -12474.292    0  532 -16918.130 -12474.292  26.3%     -   40s
     0     0 -12478.128    0  541 -16918.130 -12478.128  26.2%     -   40s
     0     0 -12527.305    0  551 -16918.130 -12527.305  26.0%     -   41s
     0     0 -12528.203    0  551 -16918.130 -12528.203  25.9%     -   41s
     0     2 -12528.203    0  551 -16918.130 -12528.203  25.9%     -   49s
     1     4 -12974.567    1  519 -16918.130 -12536.458  25.9%  1345   50s
    45    20     cutoff    6      -16918.130 -14015.648  17.2%   669   56s
H   54    20                    -16911.00499 -14679.351  13.2%   615   56s
H  138    35                    -16905.41971 -15526.705  8.16%   444   58s
   351    21 -16693.069   15   38 -16905.420 -15666.306  7.33%   290   60s
H 2634   444                    -16895.26310 -16798.920  0.57%  61.2   62s
H 3612   429                    -16885.14423 -16822.092  0.37%  48.8   63s
  5184   210 -16876.607   44   16 -16885.144 -16831.791  0.32%  38.5   65s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 14
  MIR: 1694
  Flow cover: 836
  Zero half: 30
  RLT: 78
  Relax-and-lift: 181

Explored 5979 nodes (257430 simplex iterations) in 65.48 seconds (83.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -16885.1 -16895.3 -16905.4 ... -16988.6
No other solutions better than -16885.1

Optimal solution found (tolerance 1.00e-04)
Best objective -1.688514423050e+04, best bound -1.688514423050e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 65.49s
  Master Objective (UB) = -16885.14, θ = 93986.25
  Upper Bound (UB) = -16885.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93986.25
  [DEBUG]   ✓ Scenario 0: θ = 93986.25 ≤ Q = 93986.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93986.25 ≤ Q = 93986.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xafd87f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x00afd87f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.364465e+13
Presolve removed 2656 rows and 1952 columns
Presolve time: 0.01s
Presolved: 437 rows, 437 columns, 1230 nonzeros
Found heuristic solution: objective 6321378.3713
Variable types: 293 continuous, 144 integer (144 binary)

Root relaxation: objective -1.133239e+05, 275 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113323.94    0  125 6321378.37 -113323.94   102%     -    0s
H    0     0                    -77128.75709 -113323.94  46.9%     -    0s
H    0     0                    -78415.48766 -113323.94  44.5%     -    0s
H    0     0                    -92699.07118 -113323.94  22.2%     -    0s
H    0     0                    -92776.75920 -102875.41  10.9%     -    0s
     0     0 -102875.41    0  118 -92776.759 -102875.41  10.9%     -    0s
H    0     0                    -100116.9135 -102871.26  2.75%     -    0s
     0     0 -102624.97    0  112 -100116.91 -102624.97  2.51%     -    0s
     0     0 -102151.28    0   99 -100116.91 -102151.28  2.03%     -    0s
H    0     0                    -101058.1878 -102151.28  1.08%     -    0s
H    0     0                    -101127.2335 -102013.47  0.88%     -    0s
     0     0 -101974.07    0   95 -101127.23 -101974.07  0.84%     -    0s
     0     0 -101974.07    0  107 -101127.23 -101974.07  0.84%     -    0s
     0     0 -101680.70    0   63 -101127.23 -101680.70  0.55%     -    0s
     0     0 -101656.78    0   69 -101127.23 -101656.78  0.52%     -    0s
     0     0 -101456.90    0   33 -101127.23 -101456.90  0.33%     -    0s
     0     0 -101388.63    0   36 -101127.23 -101388.63  0.26%     -    0s
     0     0 -101388.53    0   36 -101127.23 -101388.53  0.26%     -    0s
     0     0 -101137.48    0    3 -101127.23 -101137.48  0.01%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 22
  MIR: 73
  Flow cover: 10
  RLT: 123
  Relax-and-lift: 11
  BQP: 14

Explored 1 nodes (826 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -101127 -101058 -92776.8 ... 1.36446e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.011272335108e+05, best bound -1.011372427040e+05, gap 0.0099%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 72733.90
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101127.23
  [DEBUG]   S×d_nominal = 173861.13
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173861.13 + -101127.23 = 72733.90
  [DEBUG]   Current θ from Master = 93986.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21252.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -38137.50
  Lower Bound (LB) = -22820.27
  Gap (UB-LB) = 5935.1268, Absolute Gap = 5935.1268, Relative Gap = 0.351500
  Not converged yet (gap = 5935.13 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135140 nonzeros
Model fingerprint: 0x93a6b7d6
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -38137.5 (0.03s)
MIP start from previous solve produced solution with objective -38137.5 (0.03s)
Loaded MIP start from previous solve with objective -38137.5

Presolve removed 23634 rows and 9594 columns
Presolve time: 0.58s
Presolved: 23619 rows, 11386 columns, 131849 nonzeros
Variable types: 9127 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26372   -9.0489707e+03   0.000000e+00   1.248584e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   15964    2.7047502e+03   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 2.704750e+03, 15964 iterations, 5.64 seconds (7.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2704.75021    0  426 -38137.501 2704.75021   107%     -    6s
H    0     0                    -29916.11458 2704.75021   109%     -    6s
H    0     0                    -27836.93356 2704.75021   110%     -    6s
H    0     0                    -27835.26795 2704.75021   110%     -    6s
H    0     0                    -27814.00337 2704.75021   110%     -    6s
     0     0 -3789.5755    0  612 -27814.003 -3789.5755  86.4%     -   10s
     0     0 -4022.8125    0  617 -27814.003 -4022.8125  85.5%     -   11s
     0     0 -4103.9352    0  693 -27814.003 -4103.9352  85.2%     -   12s
     0     0 -4109.5473    0  695 -27814.003 -4109.5473  85.2%     -   12s
     0     0 -4109.5648    0  695 -27814.003 -4109.5648  85.2%     -   12s
     0     0 -8755.4451    0  834 -27814.003 -8755.4451  68.5%     -   18s
H    0     0                    -27813.89835 -8755.6508  68.5%     -   18s
     0     0 -9185.4556    0  907 -27813.898 -9185.4556  67.0%     -   19s
     0     0 -9273.6721    0  919 -27813.898 -9273.6721  66.7%     -   20s
     0     0 -9306.2652    0  861 -27813.898 -9306.2652  66.5%     -   20s
     0     0 -9308.3678    0  851 -27813.898 -9308.3678  66.5%     -   20s
     0     0 -11938.278    0  699 -27813.898 -11938.278  57.1%     -   27s
     0     0 -12165.329    0  709 -27813.898 -12165.329  56.3%     -   29s
H    0     0                    -27810.05834 -12307.682  55.7%     -   30s
     0     0 -12307.682    0  700 -27810.058 -12307.682  55.7%     -   30s
     0     0 -12319.613    0  706 -27810.058 -12319.613  55.7%     -   31s
     0     0 -12321.698    0  714 -27810.058 -12321.698  55.7%     -   31s
H    0     0                    -27797.93897 -13565.208  51.2%     -   38s
H    0     0                    -27796.12822 -13565.208  51.2%     -   38s
H    0     0                    -27791.52627 -13565.208  51.2%     -   38s
     0     0 -13565.208    0  462 -27791.526 -13565.208  51.2%     -   38s
     0     0 -13804.622    0  645 -27791.526 -13804.622  50.3%     -   41s
     0     0 -14047.663    0  626 -27791.526 -14047.663  49.5%     -   43s
     0     0 -14088.073    0  628 -27791.526 -14088.073  49.3%     -   44s
     0     0 -14095.211    0  638 -27791.526 -14095.211  49.3%     -   44s
     0     0 -14096.459    0  635 -27791.526 -14096.459  49.3%     -   44s
     0     0 -14464.037    0  893 -27791.526 -14464.037  48.0%     -   48s
     0     0 -14619.699    0  816 -27791.526 -14619.699  47.4%     -   50s
     0     0 -14645.871    0  727 -27791.526 -14645.871  47.3%     -   51s
     0     0 -14656.354    0  827 -27791.526 -14656.354  47.3%     -   51s
     0     0 -14659.419    0  624 -27791.526 -14659.419  47.3%     -   52s
H    0     0                    -25141.75902 -14856.267  40.9%     -   54s
H    0     0                    -23969.30568 -14856.267  38.0%     -   54s
     0     0 -14856.267    0  922 -23969.306 -14856.267  38.0%     -   54s
H    0     0                    -23928.46717 -14856.434  37.9%     -   55s
H    0     0                    -23160.02797 -14856.434  35.9%     -   55s
H    0     0                    -23154.73792 -14856.434  35.8%     -   55s
     0     0 -14890.226    0  737 -23154.738 -14890.226  35.7%     -   56s
     0     0 -14910.839    0  833 -23154.738 -14910.839  35.6%     -   57s
H    0     0                    -22836.15974 -14920.578  34.7%     -   57s
H    0     0                    -22772.08892 -14920.578  34.5%     -   57s
     0     0 -14920.578    0  846 -22772.089 -14920.578  34.5%     -   57s
     0     0 -14930.180    0  924 -22772.089 -14930.180  34.4%     -   58s
     0     0 -14930.668    0  929 -22772.089 -14930.668  34.4%     -   58s
H    0     0                    -22745.03643 -15072.527  33.7%     -   61s
     0     0 -15072.527    0  556 -22745.036 -15072.527  33.7%     -   61s
H    0     0                    -22643.03068 -15072.909  33.4%     -   61s
H    0     0                    -22639.64485 -15072.909  33.4%     -   61s
     0     0 -15112.140    0  648 -22639.645 -15112.140  33.2%     -   63s
     0     0 -15127.237    0  562 -22639.645 -15127.237  33.2%     -   64s
     0     0 -15128.629    0  573 -22639.645 -15128.629  33.2%     -   64s
     0     0 -15204.993    0  556 -22639.645 -15204.993  32.8%     -   66s
     0     0 -15220.730    0  571 -22639.645 -15220.730  32.8%     -   67s
     0     0 -15224.414    0  563 -22639.645 -15224.414  32.8%     -   67s
     0     0 -15277.967    0  618 -22639.645 -15277.967  32.5%     -   69s
H    0     0                    -22599.34230 -15278.312  32.4%     -   69s
     0     0 -15297.940    0  553 -22599.342 -15297.940  32.3%     -   70s
     0     0 -15303.208    0  555 -22599.342 -15303.208  32.3%     -   71s
     0     0 -15326.629    0  635 -22599.342 -15326.629  32.2%     -   72s
     0     0 -15331.648    0  553 -22599.342 -15331.648  32.2%     -   72s
     0     0 -15340.048    0  546 -22599.342 -15340.048  32.1%     -   73s
     0     0 -15347.746    0  534 -22599.342 -15347.746  32.1%     -   74s
     0     0 -15349.467    0  835 -22599.342 -15349.467  32.1%     -   75s
     0     0 -15360.052    0  566 -22599.342 -15360.052  32.0%     -   77s
     0     0 -15360.672    0  566 -22599.342 -15360.672  32.0%     -   77s
     0     2 -15360.672    0  566 -22599.342 -15360.672  32.0%     -   91s
     3     8 -16038.694    2  441 -22599.342 -15708.055  30.5%  2766   95s
    15    32 -18236.241    4  403 -22599.342 -16200.225  28.3%  2388  102s
    63    92 -18933.152    6  528 -22599.342 -16754.047  25.9%  1773  107s
   145   206 -19155.558    8  534 -22599.342 -16876.912  25.3%  1244  113s
   217   253 -19234.587    9  527 -22599.342 -16876.912  25.3%  1010  116s
   356   315 -19951.254   10  283 -22599.342 -16876.912  25.3%   862  121s
   471   432 -20041.294   11  383 -22599.342 -16999.917  24.8%   848  125s
   690   574 -20120.290   13  605 -22599.342 -16999.917  24.8%   747  130s
   827   640 -20356.297   14  491 -22599.342 -17197.431  23.9%   728  136s
   981   721 -20478.440   16  531 -22599.342 -17197.431  23.9%   707  141s
  1138   818 -20703.832   17  527 -22599.342 -17202.189  23.9%   696  146s
  1336   918 -20947.557   18  547 -22599.342 -17203.527  23.9%   662  150s
  1562   987     cutoff   19      -22599.342 -17226.892  23.8%   644  155s
  1780  1037 -21495.452   22  480 -22599.342 -17226.892  23.8%   652  163s
  1886  1052     cutoff   22      -22599.342 -17613.448  22.1%   655  168s
  1945  1065 -21901.716    8  211 -22599.342 -17730.946  21.5%   667  170s
  2153  1133     cutoff   10      -22599.342 -17730.946  21.5%   672  177s
  2269  1177 -19032.052   10  459 -22599.342 -17730.946  21.5%   672  180s
  2566  1256     cutoff   12      -22599.342 -18041.241  20.2%   662  187s
  2703  1290 -20591.538   12  322 -22599.342 -18214.181  19.4%   664  191s
  3001  1357 -22092.196   17  313 -22599.342 -18214.181  19.4%   667  199s
  3183  1396 -22290.337   15  365 -22599.342 -18443.278  18.4%   669  203s
  3281  1427     cutoff   16      -22599.342 -18450.647  18.4%   670  208s
  3447  1457     cutoff   13      -22599.342 -18450.647  18.4%   671  213s
  3616  1462 -20998.879   10  291 -22599.342 -18673.319  17.4%   666  217s
  3801  1448 -20889.075   11  176 -22599.342 -18673.319  17.4%   669  221s
  3985  1458     cutoff   13      -22599.342 -18945.742  16.2%   674  227s
  4130  1478 infeasible   13      -22599.342 -19109.839  15.4%   679  231s
  4401  1497 -20931.819   16  164 -22599.342 -19122.891  15.4%   670  237s
  4677  1488     cutoff   22      -22599.342 -19223.712  14.9%   665  242s
  4939  1521     cutoff   24      -22599.342 -19397.512  14.2%   664  247s
  5241  1509     cutoff   10      -22599.342 -19463.252  13.9%   657  252s
  5504  1487 -21073.968   15  127 -22599.342 -19504.499  13.7%   654  257s
  5889  1488 infeasible   11      -22599.342 -19829.006  12.3%   642  261s
  5952  1447 -21978.086   12  168 -22599.342 -19845.309  12.2%   643  266s
  6190  1424 -21390.685   18  137 -22599.342 -19959.233  11.7%   636  272s
  6501  1394 -21798.818   30  156 -22599.342 -20053.783  11.3%   631  278s
  6895  1282     cutoff   10      -22599.342 -20189.224  10.7%   624  284s
  7387  1222     cutoff   34      -22599.342 -20427.900  9.61%   611  290s
  7834  1089 infeasible   11      -22599.342 -20671.297  8.53%   603  296s
  8435   775 infeasible   33      -22599.342 -20870.971  7.65%   588  303s
  9411   571 -22483.457   30  135 -22599.342 -21118.397  6.55%   553  308s
 10864   333     cutoff   35      -22599.342 -21514.977  4.80%   498  312s
 15161     0 -22487.197   36   70 -22599.342 -22315.751  1.25%   373  315s

Cutting planes:
  Gomory: 4
  Implied bound: 6
  MIR: 2425
  Flow cover: 1625
  Zero half: 19
  RLT: 121
  Relax-and-lift: 382

Explored 16221 nodes (5776349 simplex iterations) in 315.77 seconds (550.44 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -22599.3 -22639.6 -22643 ... -23969.3
No other solutions better than -22599.3

Optimal solution found (tolerance 1.00e-04)
Best objective -2.259934230375e+04, best bound -2.259934230375e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 315.79s
  Master Objective (UB) = -22599.34, θ = 93308.56
  Upper Bound (UB) = -22599.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93308.56
  [DEBUG]   ✓ Scenario 0: θ = 93308.56 ≤ Q = 93308.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93308.56 ≤ Q = 93308.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93308.56 ≤ Q = 93308.56 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x48a81015
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb757efeb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.594741e+13
Presolve removed 2652 rows and 1946 columns
Presolve time: 0.01s
Presolved: 441 rows, 443 columns, 1242 nonzeros
Found heuristic solution: objective 7489668.9302
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.117985e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111798.46    0  123 7489668.93 -111798.46   101%     -    0s
H    0     0                    -83187.93537 -111798.46  34.4%     -    0s
H    0     0                    -83357.51473 -111798.46  34.1%     -    0s
H    0     0                    -84673.24191 -84673.242  0.00%     -    0s
     0     0          -    0      -84673.242 -84673.242  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 195

Explored 1 nodes (363 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -84673.2 -83357.5 -83187.9 ... 1.59474e+13
No other solutions better than -84673.2

Optimal solution found (tolerance 1.00e-04)
Best objective -8.467324190547e+04, best bound -8.467324190547e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 93302.41
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84673.24
  [DEBUG]   S×d_nominal = 177975.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 177975.65 + -84673.24 = 93302.41
  [DEBUG]   Current θ from Master = 93308.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22605.50
  Lower Bound (LB) = -22605.50
  Gap (UB-LB) = 6.1569, Absolute Gap = 6.1569, Relative Gap = 0.000272
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 3
Total Time: 583.81s
Converged: True
Final Lower Bound: -22605.4992
Final Upper Bound: -22599.3423
Final Gap: 6.156875
Number of Critical Scenarios: 3
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [8, 9] (2/10)
Active Routes (Plant→DC): 6
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 12 customers  Mode 1: 8 customers  Mode 2: 30 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 3
Start Time: 2026-01-05 15:25:19
End Time: 2026-01-05 15:35:03
Total Time: 583.81s
Optimal Value: -22605.50
Lower Bound: -22605.50
Upper Bound: -22599.34
Gap: 6.156875
Plants Opened: {0: [1], 1: [0], 2: [1]} (3 plants)
DCs Opened: [8, 9] (2 DCs)
================================================================================

Results saved to: result/DH_single_full_seed3_LD_gamma20_20260105_153503.csv

Total Execution Time: 583.99 seconds
End Time: 2026-01-05 15:35:03

All tasks completed successfully!

