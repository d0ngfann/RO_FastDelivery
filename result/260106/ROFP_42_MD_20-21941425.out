
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 42
DI Scenario: MD
Start Time: 2026-01-05 18:13:29
================================================================================
Loading data from data/DH_data_full_seed42.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.170', '1.369'] (k=0.387)
  Product 1: ['1.000', '1.302', '1.694'] (k=0.650)
  Product 2: ['1.000', '1.198', '1.435'] (k=0.445)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1033, max=1638
  DC capacity (MC): min=441, max=890

Demand Structure (s_rk matrix):
  Total customer-product pairs: 88/150 (41.3% sparse)
  Average products per customer: 1.76

Demand (only non-zero entries):
  Nominal (μ): min=8.24, max=34.19, count=88
  Deviation (μ̂): min=4.08, max=9.90

Costs:
  Plant fixed cost: min=5618, max=9853
  DC fixed cost: min=3306, max=5456
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.368', '1.872'] (k=0.773)
    Product 1: ['1.000', '1.336', '1.786'] (k=0.715)
    Product 2: ['1.000', '1.464', '2.143'] (k=0.940)
  MD:
    Product 0: ['1.000', '1.170', '1.369'] (k=0.387)
    Product 1: ['1.000', '1.302', '1.694'] (k=0.650)
    Product 2: ['1.000', '1.198', '1.435'] (k=0.445)
  LD:
    Product 0: ['1.000', '1.021', '1.042'] (k=0.050)
    Product 1: ['1.000', '1.096', '1.201'] (k=0.226)
    Product 2: ['1.000', '1.032', '1.064'] (k=0.077)
  Mixed:
    Product 0: ['1.000', '1.368', '1.872'] (k=0.773)
    Product 1: ['1.000', '1.302', '1.694'] (k=0.650)
    Product 2: ['1.000', '1.032', '1.064'] (k=0.077)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48774 nonzeros
Model fingerprint: 0x2a7ce98e
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11543 rows and 2543 columns
Presolve time: 0.20s
Presolved: 5130 rows, 5957 columns, 35527 nonzeros
Variable types: 3698 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -276603.1071
Found heuristic solution: objective -194749.8017

Root relaxation: objective 9.514711e+04, 5210 iterations, 0.34 seconds (0.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 95147.1116    0  646 -194749.80 95147.1116   149%     -    0s
     0     0 89478.6206    0  851 -194749.80 89478.6206   146%     -    1s
H    0     0                    -180876.8733 89478.5269   149%     -    1s
     0     0 89317.2687    0  840 -180876.87 89317.2687   149%     -    1s
     0     0 89314.4590    0  841 -180876.87 89314.4590   149%     -    1s
H    0     0                    -60145.57335 86485.1772   244%     -    2s
     0     0 86485.1772    0  992 -60145.573 86485.1772   244%     -    2s
     0     0 86035.4883    0 1007 -60145.573 86035.4883   243%     -    3s
     0     0 85464.1454    0 1006 -60145.573 85464.1454   242%     -    3s
     0     0 85413.2823    0 1100 -60145.573 85413.2823   242%     -    3s
     0     0 85264.0551    0 1004 -60145.573 85264.0551   242%     -    3s
     0     0 83006.7980    0 1090 -60145.573 83006.7980   238%     -    5s
     0     0 82670.2623    0 1082 -60145.573 82670.2623   237%     -    6s
     0     0 82631.7241    0 1078 -60145.573 82631.7241   237%     -    6s
     0     0 82616.0415    0 1079 -60145.573 82616.0415   237%     -    6s
     0     0 82614.5281    0 1076 -60145.573 82614.5281   237%     -    6s
H    0     0                    21765.182024 82357.5565   278%     -    7s
     0     0 79819.6433    0 1204 21765.1820 79819.6433   267%     -    9s
H    0     0                    23027.719390 79459.3890   245%     -   10s
H    0     0                    23430.013508 79459.3890   239%     -   10s
     0     0 79459.3890    0 1217 23430.0135 79459.3890   239%     -   10s
     0     0 79401.1226    0 1223 23430.0135 79401.1226   239%     -   10s
     0     0 79387.6136    0 1242 23430.0135 79387.6136   239%     -   10s
     0     0 79384.1324    0 1247 23430.0135 79384.1324   239%     -   10s
H    0     0                    23479.410109 76580.7480   226%     -   13s
H    0     0                    23489.912535 76580.7480   226%     -   13s
H    0     0                    23511.797536 76580.7480   226%     -   13s
     0     0 76580.7480    0 1134 23511.7975 76580.7480   226%     -   13s
     0     0 76177.6540    0 1169 23511.7975 76177.6540   224%     -   13s
     0     0 76076.7447    0 1171 23511.7975 76076.7447   224%     -   14s
     0     0 76058.5416    0 1162 23511.7975 76058.5416   223%     -   14s
     0     0 76054.6721    0 1176 23511.7975 76054.6721   223%     -   14s
H    0     0                    23619.276277 74057.9274   214%     -   17s
H    0     0                    23693.439057 74057.9274   213%     -   17s
H    0     0                    23751.566890 74057.9274   212%     -   17s
H    0     0                    23815.989398 74057.9274   211%     -   17s
     0     0 74057.9274    0 1186 23815.9894 74057.9274   211%     -   17s
     0     0 73769.0788    0 1221 23815.9894 73769.0788   210%     -   18s
     0     0 73705.2698    0 1202 23815.9894 73705.2698   209%     -   18s
     0     0 73696.0263    0 1215 23815.9894 73696.0263   209%     -   18s
     0     0 72587.8214    0 1227 23815.9894 72587.8214   205%     -   21s
H    0     0                    23937.764178 72377.4727   202%     -   22s
H    0     0                    23990.485814 72377.4727   202%     -   22s
H    0     0                    24007.019701 72377.4727   201%     -   22s
H    0     0                    24061.016925 72377.4727   201%     -   22s
H    0     0                    24061.665861 72377.4727   201%     -   22s
H    0     0                    24177.094532 72377.4727   199%     -   22s
     0     0 72377.4727    0 1227 24177.0945 72377.4727   199%     -   22s
     0     0 72323.4937    0 1249 24177.0945 72323.4937   199%     -   22s
     0     0 72304.0786    0 1243 24177.0945 72304.0786   199%     -   23s
     0     0 72297.4912    0 1258 24177.0945 72297.4912   199%     -   23s
     0     0 71297.3106    0 1123 24177.0945 71297.3106   195%     -   25s
     0     0 71070.6644    0 1176 24177.0945 71070.6644   194%     -   26s
     0     0 71013.4300    0 1195 24177.0945 71013.4300   194%     -   27s
     0     0 70998.9043    0 1219 24177.0945 70998.9043   194%     -   27s
H    0     0                    24185.012171 70998.9043   194%     -   28s
H    0     0                    24579.864688 69240.1883   182%     -   31s
H    0     0                    28009.587935 69240.1883   147%     -   31s
H    0     0                    28046.568425 69240.1883   147%     -   31s
H    0     0                    28079.870054 69240.1883   147%     -   31s
H    0     0                    28109.759070 69240.1883   146%     -   31s
H    0     0                    28143.060699 69240.1883   146%     -   31s
H    0     0                    28491.406626 69240.1883   143%     -   31s
H    0     0                    28808.603691 69240.1883   140%     -   31s
H    0     0                    29033.913194 69240.1883   138%     -   31s
H    0     0                    29264.886188 69240.1883   137%     -   31s
H    0     0                    29265.440036 69240.1883   137%     -   31s
H    0     0                    29938.250853 69240.1883   131%     -   31s
H    0     0                    30007.436318 69240.1883   131%     -   31s
     0     0 69240.1883    0 1118 30007.4363 69240.1883   131%     -   31s
H    0     0                    30390.843183 68926.8480   127%     -   32s
H    0     0                    30480.168900 68926.8480   126%     -   32s
H    0     0                    30515.355283 68926.8480   126%     -   32s
     0     0 68926.8480    0 1126 30515.3553 68926.8480   126%     -   32s
H    0     0                    30576.760155 68805.7867   125%     -   33s
     0     0 68805.7867    0 1181 30576.7602 68805.7867   125%     -   33s
     0     0 68781.7480    0 1202 30576.7602 68781.7480   125%     -   34s
     0     0 68775.0968    0 1199 30576.7602 68775.0968   125%     -   34s
     0     0 68095.5390    0 1096 30576.7602 68095.5390   123%     -   37s
     0     0 67969.2003    0 1160 30576.7602 67969.2003   122%     -   39s
     0     0 67951.5228    0 1162 30576.7602 67951.5228   122%     -   39s
     0     0 65172.4305    0 1126 30576.7602 65172.4305   113%     -   44s
     0     0 64939.8560    0 1138 30576.7602 64939.8560   112%     -   45s
     0     0 64861.0851    0 1144 30576.7602 64861.0851   112%     -   46s
     0     0 64838.0366    0 1149 30576.7602 64838.0366   112%     -   46s
     0     0 62985.3622    0 1031 30576.7602 62985.3622   106%     -   49s
     0     0 62669.2373    0 1077 30576.7602 62669.2373   105%     -   51s
     0     0 62561.2688    0 1110 30576.7602 62561.2688   105%     -   52s
     0     0 62529.4773    0 1121 30576.7602 62529.4773   105%     -   53s
     0     0 62521.0909    0 1120 30576.7602 62521.0909   104%     -   53s
     0     0 59730.6357    0 1074 30576.7602 59730.6357  95.3%     -   57s
     0     0 59271.6228    0 1134 30576.7602 59271.6228  93.8%     -   59s
     0     0 59145.2423    0 1149 30576.7602 59145.2423  93.4%     -   61s
     0     0 59100.7494    0 1131 30576.7602 59100.7494  93.3%     -   61s
     0     0 59083.5274    0 1141 30576.7602 59083.5274  93.2%     -   61s
     0     0 57786.5940    0 1099 30576.7602 57786.5940  89.0%     -   65s
     0     0 57451.2330    0 1114 30576.7602 57451.2330  87.9%     -   67s
     0     0 57384.2402    0 1155 30576.7602 57384.2402  87.7%     -   68s
     0     0 57359.9758    0 1166 30576.7602 57359.9758  87.6%     -   68s
     0     0 55695.1376    0  996 30576.7602 55695.1376  82.1%     -   72s
H    0     0                    30608.647353 55256.7098  80.5%     -   74s
     0     0 55256.7098    0 1069 30608.6474 55256.7098  80.5%     -   74s
     0     0 55134.4374    0 1082 30608.6474 55134.4374  80.1%     -   75s
     0     0 55088.7961    0 1074 30608.6474 55088.7961  80.0%     -   76s
     0     0 55076.5762    0 1098 30608.6474 55076.5762  79.9%     -   76s
H    0     0                    30644.872746 52255.1093  70.5%     -   81s
     0     0 52255.1093    0  881 30644.8727 52255.1093  70.5%     -   81s
     0     0 51797.8776    0  858 30644.8727 51797.8776  69.0%     -   82s
     0     0 51637.6029    0  825 30644.8727 51637.6029  68.5%     -   83s
     0     0 51589.5982    0  847 30644.8727 51589.5982  68.3%     -   83s
     0     0 51570.9517    0  892 30644.8727 51570.9517  68.3%     -   84s
     0     0 50875.2367    0  878 30644.8727 50875.2367  66.0%     -   86s
     0     0 50580.7178    0  941 30644.8727 50580.7178  65.1%     -   87s
     0     0 50522.0809    0  925 30644.8727 50522.0809  64.9%     -   88s
     0     0 50495.1961    0  925 30644.8727 50495.1961  64.8%     -   88s
     0     0 50020.9521    0  881 30644.8727 50020.9521  63.2%     -   90s
     0     0 49907.4890    0  887 30644.8727 49907.4890  62.9%     -   91s
     0     0 49862.8781    0  913 30644.8727 49862.8781  62.7%     -   92s
     0     0 49604.4668    0  880 30644.8727 49604.4668  61.9%     -   93s
     0     0 49603.8918    0  880 30644.8727 49603.8918  61.9%     -   93s
     0     2 49603.8918    0  880 30644.8727 49603.8918  61.9%     -   98s
     1     4 49011.7129    1  712 30644.8727 49601.8815  61.9%  3080  102s
     7    16 47620.4850    3  664 30644.8727 48981.2740  59.8%  3130  106s
    31    64 45917.2975    5  504 30644.8727 47691.6911  55.6%  3565  115s
    95   203 43939.8843    7  409 30644.8727 47344.8782  54.5%  3948  121s
H  210   233                    30657.508335 47344.8782  54.4%  2252  123s
H  212   233                    31276.062664 47344.8782  51.4%  2239  123s
H  240   233                    31638.721358 47344.8782  49.6%  2053  123s
H  245   233                    32539.037605 47344.8782  45.5%  2024  123s
   246   329 43191.1645   11  414 32539.0376 47344.8782  45.5%  2024  125s
H  408   355                    32594.005801 46761.4543  43.5%  1465  126s
H  533   508                    33385.771149 46761.4543  40.1%  1247  129s
   613   576 39342.5196   16  295 33385.7711 46761.4543  40.1%  1161  131s
H  728   638                    33501.020660 46677.3497  39.3%  1059  132s
H  773   638                    34132.950707 46677.3497  36.8%  1023  132s
   815   677 36349.6374   21  296 34132.9507 46677.3497  36.8%   991  135s
  1158   929 41774.1280   10  434 34132.9507 45530.8751  33.4%   866  140s
  1423  1080 38047.3106   13  159 34132.9507 45530.8751  33.4%   813  145s
  1758  1215 38591.1849   13  241 34132.9507 45484.4928  33.3%   751  151s
  2151  1408 36845.5265   16  228 34132.9507 44938.8165  31.7%   710  156s
  2732  1743 40956.5993    9  377 34132.9507 44509.3804  30.4%   653  160s
  3376  1872     cutoff   15      34132.9507 43931.8782  28.7%   616  165s
  3613  1980 39010.9704   13  320 34132.9507 43746.5316  28.2%   612  170s
  4399  2236 infeasible   18      34132.9507 43593.6486  27.7%   584  175s
  5004  2468 35576.4243   14  204 34132.9507 43262.5346  26.7%   560  181s
  5597  2534 36984.7326    8  392 34132.9507 42760.0112  25.3%   552  185s
  6520  2661     cutoff   22      34132.9507 42306.1852  23.9%   547  191s
  7118  2720     cutoff    9      34132.9507 41871.2702  22.7%   549  196s
  7824  2732 35449.9988   13  152 34132.9507 41545.2752  21.7%   546  203s
  8203  2752 36579.4308    9  248 34132.9507 41468.2962  21.5%   546  206s
  8665  2774 35889.0440   20  231 34132.9507 41225.0291  20.8%   548  211s
  9314  2808 36811.8753   17  147 34132.9507 40945.1515  20.0%   552  216s
 10100  2812 36700.8838   13  208 34132.9507 40623.7399  19.0%   553  223s
 10299  2830     cutoff   14      34132.9507 40534.9983  18.8%   553  228s
 10811  2876     cutoff   15      34132.9507 40495.6546  18.6%   549  231s
 12004  2873 infeasible   20      34132.9507 40097.1078  17.5%   542  238s
 12639  2863 infeasible   20      34132.9507 40028.3514  17.3%   538  242s
 13239  2830     cutoff   15      34132.9507 39631.8951  16.1%   536  246s
 13921  2789 36553.7710   20  107 34132.9507 39459.4898  15.6%   540  253s
 14519  2739     cutoff   22      34132.9507 39421.1363  15.5%   538  257s
 15232  2654 36151.0608   14  370 34132.9507 39152.6302  14.7%   536  262s
 15948  2560 infeasible   21      34132.9507 38981.6589  14.2%   535  266s
 16673  2456 36882.2577   10  263 34132.9507 38744.9544  13.5%   534  272s
 17411  2319 35777.6855   10  207 34132.9507 38660.1847  13.3%   534  276s
 18144  2146     cutoff   19      34132.9507 38392.8192  12.5%   534  281s
 18947  1893     cutoff   35      34132.9507 37927.7993  11.1%   534  286s
 19856  1587     cutoff   18      34132.9507 37715.8442  10.5%   531  291s
 20716  1124     cutoff   16      34132.9507 37199.5387  8.98%   531  296s
 21774   302     cutoff    8      34132.9507 36595.8721  7.22%   526  301s

Cutting planes:
  Learned: 2
  Gomory: 9
  Implied bound: 490
  MIR: 2758
  Flow cover: 1741
  RLT: 86
  Relax-and-lift: 1362
  BQP: 2

Explored 24416 nodes (12120028 simplex iterations) in 302.26 seconds (428.95 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 34133 33501 33385.8 ... 30608.6

Optimal solution found (tolerance 1.00e-04)
Best objective 3.413295070735e+04, best bound 3.413295070735e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 302.27s
  Master Objective (UB) = 34132.95, θ = 178001.06
  Upper Bound (UB) = 34132.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 178001.06
  [DEBUG]   ✓ Scenario 0: θ = 178001.06 ≤ Q = 178001.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5707e4fe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa8f81b02
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.312974e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6915408.3296
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.577989e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157798.91    0  126 6915408.33 -157798.91   102%     -    0s
H    0     0                    -119114.8306 -157798.91  32.5%     -    0s
H    0     0                    -119624.9402 -157798.91  31.9%     -    0s
*    0     0               0    -122644.6594 -122644.66  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 214

Explored 1 nodes (390 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -122645 -119625 -119115 ... 1.31297e+13
No other solutions better than -122645

Optimal solution found (tolerance 1.00e-04)
Best objective -1.226446594403e+05, best bound -1.226446594403e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 146616.74
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122644.66
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -122644.66 = 146616.74
  [DEBUG]   Current θ from Master = 178001.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31384.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2748.63
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 31384.3237, Absolute Gap = 31384.3237, Relative Gap = 0.919473
  Not converged yet (gap = 31384.32 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92029 nonzeros
Model fingerprint: 0xcc77eb22
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 2748.63 (0.02s)
MIP start from previous solve produced solution with objective 2748.63 (0.02s)
Loaded MIP start from previous solve with objective 2748.63

Presolve removed 12585 rows and 5104 columns
Presolve time: 0.52s
Presolved: 19378 rows, 9636 columns, 107498 nonzeros
Variable types: 7377 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.209624e+04, 10027 iterations, 1.99 seconds (2.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42096.2366    0  468 2748.62705 42096.2366  1432%     -    2s
H    0     0                    3797.6206647 42096.2366  1008%     -    2s
H    0     0                    4322.7923535 42096.2366   874%     -    2s
     0     0 33671.3609    0  444 4322.79235 33671.3609   679%     -    5s
H    0     0                    4375.2097675 33671.2032   670%     -    5s
H    0     0                    4477.9870753 33253.1016   643%     -    6s
H    0     0                    4991.7128060 33253.1016   566%     -    6s
     0     0 33164.3817    0  530 4991.71281 33164.3817   564%     -    6s
     0     0 33151.9211    0  513 4991.71281 33151.9211   564%     -    6s
     0     0 33151.9211    0  519 4991.71281 33151.9211   564%     -    6s
     0     0 27589.2651    0  447 4991.71281 27589.2651   453%     -    9s
     0     0 26993.3333    0  543 4991.71281 26993.3333   441%     -   10s
     0     0 26802.0205    0  548 4991.71281 26802.0205   437%     -   11s
     0     0 26773.9000    0  534 4991.71281 26773.9000   436%     -   11s
     0     0 26771.2541    0  538 4991.71281 26771.2541   436%     -   11s
     0     0 23940.1797    0  514 4991.71281 23940.1797   380%     -   15s
     0     0 23485.8034    0  519 4991.71281 23485.8034   370%     -   16s
H    0     0                    7005.0330442 23263.9680   232%     -   17s
     0     0 23263.9680    0  593 7005.03304 23263.9680   232%     -   17s
H    0     0                    7318.8423617 23131.2963   216%     -   17s
H    0     0                    7430.1419873 23131.2963   211%     -   17s
H    0     0                    7477.5324841 23131.2963   209%     -   17s
     0     0 23131.2963    0  540 7477.53248 23131.2963   209%     -   17s
     0     0 23101.2341    0  554 7477.53248 23101.2341   209%     -   17s
     0     0 23084.9959    0  545 7477.53248 23084.9959   209%     -   17s
     0     0 23072.8465    0  553 7477.53248 23072.8465   209%     -   18s
     0     0 23070.8797    0  555 7477.53248 23070.8797   209%     -   18s
H    0     0                    7643.4885663 21603.6487   183%     -   22s
H    0     0                    7667.1659468 21603.6487   182%     -   22s
H    0     0                    7718.8206863 21603.6487   180%     -   22s
H    0     0                    7722.6182464 21603.6487   180%     -   22s
     0     0 21603.6487    0  371 7722.61825 21603.6487   180%     -   22s
H    0     0                    7739.2013908 21602.4734   179%     -   23s
     0     0 21407.5337    0  470 7739.20139 21407.5337   177%     -   24s
     0     0 21326.2973    0  398 7739.20139 21326.2973   176%     -   24s
     0     0 21308.2104    0  554 7739.20139 21308.2104   175%     -   25s
     0     0 21301.0618    0  492 7739.20139 21301.0618   175%     -   25s
     0     0 21300.0000    0  488 7739.20139 21300.0000   175%     -   25s
     0     0 20725.5221    0  514 7739.20139 20725.5221   168%     -   27s
H    0     0                    9088.1324255 20640.0716   127%     -   27s
     0     0 20640.0716    0  536 9088.13243 20640.0716   127%     -   27s
     0     0 20615.2674    0  602 9088.13243 20615.2674   127%     -   28s
     0     0 20580.1272    0  596 9088.13243 20580.1272   126%     -   28s
     0     0 20572.7034    0  677 9088.13243 20572.7034   126%     -   28s
     0     0 20571.4522    0  672 9088.13243 20571.4522   126%     -   29s
     0     0 20407.9170    0  464 9088.13243 20407.9170   125%     -   30s
H    0     0                    9162.7141144 20400.8642   123%     -   32s
H    0     0                    9205.1864547 20400.8642   122%     -   33s
H    0     0                    9241.3467330 20382.7641   121%     -   33s
H    0     0                    9269.8412526 20382.7641   120%     -   33s
H    0     0                    9276.4451201 20382.7641   120%     -   33s
H    0     0                    9278.4011893 20382.7641   120%     -   33s
     0     0 20382.7641    0  384 9278.40119 20382.7641   120%     -   33s
     0     0 20376.8485    0  384 9278.40119 20376.8485   120%     -   33s
     0     0 20055.1096    0  419 9278.40119 20055.1096   116%     -   34s
     0     0 20014.4217    0  418 9278.40119 20014.4217   116%     -   35s
     0     0 20009.2044    0  425 9278.40119 20009.2044   116%     -   35s
     0     0 19945.4947    0  476 9278.40119 19945.4947   115%     -   36s
     0     0 19924.9122    0  487 9278.40119 19924.9122   115%     -   37s
     0     0 19918.6648    0  497 9278.40119 19918.6648   115%     -   37s
     0     0 19879.7919    0  441 9278.40119 19879.7919   114%     -   38s
     0     0 19876.6883    0  389 9278.40119 19876.6883   114%     -   38s
     0     0 19838.6128    0  501 9278.40119 19838.6128   114%     -   39s
     0     0 19838.5257    0  501 9278.40119 19838.5257   114%     -   39s
     0     2 19838.2738    0  501 9278.40119 19838.2738   114%     -   48s
     1     4 19001.5241    1  466 9278.40119 19838.2738   114%  1894   50s
    31    62 16382.3985    5  450 9278.40119 18615.2805   101%  1185   55s
H   51    62                    9294.7732377 18389.9844  97.9%  1254   55s
H  122   125                    9331.0572791 18303.0459  96.2%  1033   58s
   242   247 13862.1779    9  356 9331.05728 18303.0459  96.2%   732   61s
H  327   315                    9342.1828979 18056.9919  93.3%   657   63s
H  328   315                    9355.1061339 18056.9919  93.0%   656   63s
   460   451 12535.7116   13  255 9355.10613 18056.9919  93.0%   576   65s
   928   645 9681.11559   23  192 9355.10613 16843.6610  80.0%   436   70s
H 1083   688                    9355.7373459 16363.0192  74.9%   427   73s
  1213   846 10455.5350   17  301 9355.73735 16363.0192  74.9%   409   75s
  1833  1078     cutoff   24      9355.73735 16049.0599  71.5%   339   80s
  2223  1220 11238.4354   16  325 9355.73735 15680.8571  67.6%   327   85s
  2626  1327 9941.93501   18  298 9355.73735 15630.0264  67.1%   322   90s
  3363  1759     cutoff   15      9355.73735 15630.0264  67.1%   302   95s
  4093  1867 infeasible   12      9355.73735 14550.5777  55.5%   289  100s
  4744  2061 9640.43409   10  326 9355.73735 14170.5515  51.5%   282  105s
  5523  2349     cutoff   23      9355.73735 13941.5844  49.0%   276  111s
  5898  2350 11578.6979   17  501 9355.73735 13941.5844  49.0%   270  129s
  5900  2351 11067.0330   35   97 9355.73735 13941.5844  49.0%   270  132s
  5902  2353 10873.6833   52  369 9355.73735 13941.5844  49.0%   270  136s
  5908  2357 9999.75171   22  352 9355.73735 13941.5844  49.0%   270  141s
  5913  2360 9451.61546   21  459 9355.73735 13941.5844  49.0%   270  146s
  5918  2363 11985.1992   15  467 9355.73735 13941.5844  49.0%   269  150s
  5920  2365 11605.6124   24  467 9355.73735 13941.5844  49.0%   269  158s
  5921  2368 13941.5844   14  337 9355.73735 13941.5844  49.0%   274  160s
  5935  2392 12786.7083   17  289 9355.73735 13941.5844  49.0%   277  165s
  6015  2461 11180.4637   20  240 9355.73735 13941.5844  49.0%   285  170s
  6217  2454     cutoff   24      9355.73735 13941.5844  49.0%   294  175s
  6487  2439 11425.3419   25  186 9355.73735 13941.5844  49.0%   299  180s
  6675  2389 13455.8678   24  245 9355.73735 13941.5844  49.0%   300  185s
  6973  2295 9708.64308   26  225 9355.73735 13941.5844  49.0%   303  190s
H 7008  2164                    9362.0061992 13941.5844  48.9%   304  190s
  7274  2099 9938.58227   23  280 9362.00620 13680.3780  46.1%   306  196s
  7536  1961 9483.21777   27  281 9362.00620 13333.2217  42.4%   307  201s
H 7581  1833                    9362.0896109 13333.2217  42.4%   307  201s
H 7636  1693                    9362.5287767 12952.6280  38.3%   307  202s
  7897  1488     cutoff   27      9362.52878 12280.7628  31.2%   304  205s
  9958   714 9366.31600   58   12 9362.52878 9385.51821  0.25%   251  210s

Cutting planes:
  Implied bound: 1
  MIR: 176
  Mixing: 1
  Flow cover: 379
  RLT: 6
  Relax-and-lift: 26

Explored 10391 nodes (2550977 simplex iterations) in 210.60 seconds (311.29 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9362.53 9362.09 9362.01 ... 9276.45

Optimal solution found (tolerance 1.00e-04)
Best objective 9.362528776741e+03, best bound 9.362528776741e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 210.61s
  Master Objective (UB) = 9362.53, θ = 140355.12
  Upper Bound (UB) = 9362.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140355.12
  [DEBUG]   ✓ Scenario 0: θ = 140355.12 ≤ Q = 140355.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140355.12 ≤ Q = 140355.12 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x602be22e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9fd41dd2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.391425e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 7458102.4762
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.557053e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155705.30    0  136 7458102.48 -155705.30   102%     -    0s
H    0     0                    -109710.3099 -155705.30  41.9%     -    0s
H    0     0                    -110462.1287 -155705.30  41.0%     -    0s
H    0     0                    -135037.1826 -155705.30  15.3%     -    0s
     0     0 -142820.97    0   80 -135037.18 -142820.97  5.76%     -    0s
H    0     0                    -140275.9955 -142689.08  1.72%     -    0s
H    0     0                    -140598.3966 -142689.08  1.49%     -    0s
     0     0 -142486.22    0   74 -140598.40 -142486.22  1.34%     -    0s
     0     0 -142485.87    0   73 -140598.40 -142485.87  1.34%     -    0s
H    0     0                    -140819.1827 -141734.52  0.65%     -    0s
     0     0 -141734.52    0   49 -140819.18 -141734.52  0.65%     -    0s
     0     0 -141523.25    0   48 -140819.18 -141523.25  0.50%     -    0s
     0     0 -141516.10    0   51 -140819.18 -141516.10  0.49%     -    0s
     0     0 -141166.93    0   27 -140819.18 -141166.93  0.25%     -    0s
     0     0 -141076.43    0   33 -140819.18 -141076.43  0.18%     -    0s
     0     0 -141075.41    0   31 -140819.18 -141075.41  0.18%     -    0s
     0     0 -141053.35    0   31 -140819.18 -141053.35  0.17%     -    0s
     0     0 -141052.78    0   31 -140819.18 -141052.78  0.17%     -    0s
     0     0 -140965.33    0   10 -140819.18 -140965.33  0.10%     -    0s
H    0     0                    -140882.6489 -140956.85  0.05%     -    0s
     0     0 -140956.85    0   12 -140882.65 -140956.85  0.05%     -    0s
     0     0 -140919.50    0    3 -140882.65 -140919.50  0.03%     -    0s
     0     0 -140913.09    0    7 -140882.65 -140913.09  0.02%     -    0s
     0     0          -    0      -140882.65 -140894.50  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  MIR: 3
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (844 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -140883 -140819 -140598 ... 1.39143e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.408826488778e+05, best bound -1.408944972857e+05, gap 0.0084%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 116919.88
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140882.65
  [DEBUG]   S×d_nominal = 257802.53
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 257802.53 + -140882.65 = 116919.88
  [DEBUG]   Current θ from Master = 140355.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23435.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14072.71
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 6613.9017, Absolute Gap = 6613.9017, Relative Gap = 0.706423
  Not converged yet (gap = 6613.90 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135284 nonzeros
Model fingerprint: 0x790a7a21
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -14072.7 (0.03s)
MIP start from previous solve produced solution with objective -14072.7 (0.03s)
Loaded MIP start from previous solve with objective -14072.7

Presolve removed 18826 rows and 7646 columns
Presolve time: 0.78s
Presolved: 28427 rows, 13334 columns, 175169 nonzeros
Variable types: 11075 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29959    1.3288108e+04   0.000000e+00   7.743567e+06      5s
Concurrent spin time: 0.01s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   15650    3.0624640e+04   0.000000e+00   0.000000e+00      8s

Root relaxation: objective 3.062464e+04, 15650 iterations, 7.47 seconds (8.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30624.6398    0   89 -14072.711 30624.6398   318%     -    8s
H    0     0                    -1065.540321 30624.6398  2974%     -    8s
H    0     0                    1102.8410603 30624.6398  2677%     -    9s
H    0     0                    2686.2672639 30624.6398  1040%     -    9s
H    0     0                    2938.4840116 30624.6398   942%     -    9s
H    0     0                    3051.3432286 30624.4353   904%     -   10s
     0     0 27771.2663    0  254 3051.34323 27771.2663   810%     -   11s
     0     0 27184.3834    0  268 3051.34323 27184.3834   791%     -   12s
     0     0 27183.9296    0  271 3051.34323 27183.9296   791%     -   13s
     0     0 27183.9296    0  274 3051.34323 27183.9296   791%     -   13s
     0     0 27183.9296    0  274 3051.34323 27183.9296   791%     -   13s
H    0     0                    3169.7130040 23442.1999   640%     -   16s
     0     0 23442.1999    0  277 3169.71300 23442.1999   640%     -   16s
H    0     0                    5814.7801076 23436.3733   303%     -   16s
H    0     0                    5958.3248002 23436.3733   293%     -   16s
H    0     0                    6048.9019040 23436.3733   287%     -   16s
H    0     0                    6109.7794351 23436.3733   284%     -   16s
H    0     0                    6136.4522255 23436.3733   282%     -   16s
H    0     0                    6179.2819254 23436.3733   279%     -   16s
     0     0 22786.2054    0  314 6179.28193 22786.2054   269%     -   17s
     0     0 22404.8329    0  316 6179.28193 22404.8329   263%     -   18s
     0     0 22395.3980    0  321 6179.28193 22395.3980   262%     -   18s
     0     0 22389.0702    0  323 6179.28193 22389.0702   262%     -   18s
     0     0 22388.8586    0  329 6179.28193 22388.8586   262%     -   18s
     0     0 20852.4828    0  384 6179.28193 20852.4828   237%     -   23s
H    0     0                    6254.0011652 20454.2151   227%     -   24s
H    0     0                    6259.8992894 20454.2151   227%     -   24s
H    0     0                    6271.4759774 20454.2151   226%     -   24s
H    0     0                    6298.2760422 20454.2151   225%     -   24s
H    0     0                    6341.6988378 20454.2151   223%     -   24s
H    0     0                    6372.9858924 20454.2151   221%     -   24s
     0     0 20454.2151    0  393 6372.98589 20454.2151   221%     -   24s
H    0     0                    6429.1401192 20223.6706   215%     -   25s
H    0     0                    6453.6083719 20223.6706   213%     -   25s
     0     0 20223.6706    0  389 6453.60837 20223.6706   213%     -   25s
     0     0 20157.2889    0  390 6453.60837 20157.2889   212%     -   25s
     0     0 20137.0929    0  407 6453.60837 20137.0929   212%     -   25s
     0     0 20134.5006    0  403 6453.60837 20134.5006   212%     -   25s
     0     0 20131.1799    0  407 6453.60837 20131.1799   212%     -   26s
     0     0 20130.2911    0  409 6453.60837 20130.2911   212%     -   26s
     0     0 19558.9118    0  350 6453.60837 19558.9118   203%     -   30s
     0     0 19383.0597    0  406 6453.60837 19383.0597   200%     -   31s
     0     0 19307.5665    0  416 6453.60837 19307.5665   199%     -   32s
     0     0 19277.9454    0  409 6453.60837 19277.9454   199%     -   32s
     0     0 19256.8462    0  352 6453.60837 19256.8462   198%     -   32s
     0     0 19246.5459    0  360 6453.60837 19246.5459   198%     -   33s
     0     0 19242.2088    0  420 6453.60837 19242.2088   198%     -   33s
     0     0 19241.1187    0  422 6453.60837 19241.1187   198%     -   33s
     0     0 18965.3329    0  408 6453.60837 18965.3329   194%     -   35s
     0     0 18917.4323    0  421 6453.60837 18917.4323   193%     -   35s
     0     0 18882.5628    0  417 6453.60837 18882.5628   193%     -   36s
     0     0 18876.2325    0  421 6453.60837 18876.2325   192%     -   36s
     0     0 18874.3652    0  421 6453.60837 18874.3652   192%     -   36s
     0     0 18874.2613    0  423 6453.60837 18874.2613   192%     -   36s
H    0     0                    6490.4177115 18810.2937   190%     -   37s
     0     0 18810.2937    0  433 6490.41771 18810.2937   190%     -   37s
     0     0 18798.7794    0  438 6490.41771 18798.7794   190%     -   38s
     0     0 18791.8384    0  437 6490.41771 18791.8384   190%     -   38s
     0     0 18790.7986    0  438 6490.41771 18790.7986   190%     -   38s
     0     0 18771.0058    0  442 6490.41771 18771.0058   189%     -   39s
     0     0 18766.0016    0  425 6490.41771 18766.0016   189%     -   40s
     0     0 18761.8336    0  425 6490.41771 18761.8336   189%     -   40s
     0     0 18761.0044    0  437 6490.41771 18761.0044   189%     -   40s
H    0     0                    6526.2796388 18761.0044   187%     -   40s
H    0     0                    6528.9636247 18744.0125   187%     -   41s
     0     0 18744.0125    0  432 6528.96362 18744.0125   187%     -   41s
     0     0 18741.1181    0  442 6528.96362 18741.1181   187%     -   41s
     0     0 18740.3949    0  434 6528.96362 18740.3949   187%     -   41s
     0     0 18726.7443    0  441 6528.96362 18726.7443   187%     -   42s
     0     0 18725.3262    0  445 6528.96362 18725.3262   187%     -   42s
     0     0 18709.1345    0  445 6528.96362 18709.1345   187%     -   43s
H    0     0                    6531.4398160 18707.7331   186%     -   43s
H    0     0                    6567.5581930 18707.7331   185%     -   43s
     0     0 18692.2349    0  432 6567.55819 18692.2349   185%     -   44s
     0     0 18685.0951    0  444 6567.55819 18685.0951   185%     -   44s
     0     0 18682.3680    0  443 6567.55819 18682.3680   184%     -   44s
     0     0 18677.1335    0  443 6567.55819 18677.1335   184%     -   45s
     0     0 18675.9580    0  445 6567.55819 18675.9580   184%     -   45s
     0     0 18668.5931    0  432 6567.55819 18668.5931   184%     -   45s
     0     0 18666.5982    0  448 6567.55819 18666.5982   184%     -   46s
     0     0 18665.2415    0  449 6567.55819 18665.2415   184%     -   46s
     0     0 18652.2718    0  439 6567.55819 18652.2718   184%     -   47s
     0     0 18646.1909    0  438 6567.55819 18646.1909   184%     -   48s
     0     0 18644.4196    0  433 6567.55819 18644.4196   184%     -   48s
     0     0 18643.2136    0  436 6567.55819 18643.2136   184%     -   48s
     0     0 18635.4677    0  431 6567.55819 18635.4677   184%     -   49s
     0     0 18631.9445    0  441 6567.55819 18631.9445   184%     -   49s
     0     0 18630.6149    0  443 6567.55819 18630.6149   184%     -   49s
     0     0 18622.5459    0  445 6567.55819 18622.5459   184%     -   50s
     0     0 18621.4176    0  444 6567.55819 18621.4176   184%     -   50s
     0     0 18613.3633    0  435 6567.55819 18613.3633   183%     -   51s
     0     0 18610.5852    0  431 6567.55819 18610.5852   183%     -   51s
     0     0 18610.0243    0  436 6567.55819 18610.0243   183%     -   52s
     0     0 18608.2631    0  438 6567.55819 18608.2631   183%     -   52s
     0     0 18608.0642    0  438 6567.55819 18608.0642   183%     -   53s
     0     2 18605.3245    0  438 6567.55819 18605.3245   183%     -   62s
     3     8 18335.0708    2  355 6567.55819 18447.0859   181%  1477   65s
    15    32 18053.4935    4  407 6567.55819 18140.5206   176%  1587   71s
    31    62 17484.6225    5  471 6567.55819 18052.7939   175%  2091   75s
    95   196 16750.9410    7  473 6567.55819 17242.0942   163%  2184   82s
   197   273 16714.0691    9  406 6567.55819 17242.0942   163%  1451   86s
   329   357 16406.7687   10  363 6567.55819 16964.7407   158%  1242   91s
   403   395 15736.0812   11  458 6567.55819 16964.7407   158%  1176   95s
   501   479 15375.1101   12  391 6567.55819 16964.7407   158%  1224  102s
   547   533 15693.9701   12  460 6567.55819 16964.7407   158%  1243  105s
   660   625 14749.5928   14  338 6567.55819 16964.7407   158%  1288  111s
   806   738 13801.9521   15  475 6567.55819 16550.5311   152%  1221  118s
   886   798 14398.0615   16  428 6567.55819 16550.5311   152%  1188  121s
  1052   901 14208.6136   17  419 6567.55819 16535.7201   152%  1113  127s
  1174  1004 14071.7753   18  374 6567.55819 16535.7201   152%  1089  133s
  1248  1048 12845.0652   19  359 6567.55819 16535.7201   152%  1078  136s
  1339  1083 12728.8755   20  410 6567.55819 16535.7201   152%  1058  140s
  1511  1204 12516.5879   21  361 6567.55819 16328.6529   149%  1050  147s
  1609  1286 11027.3584   22  291 6567.55819 16328.6529   149%  1045  151s
  1702  1347 9642.01947   22  348 6567.55819 16328.6529   149%  1045  156s
  1840  1402 9872.47184   25  320 6567.55819 16316.2823   148%  1033  164s
  1894  1452 9164.94224   25  150 6567.55819 16282.7077   148%  1029  168s
  1984  1505 8968.76695   26  130 6567.55819 16282.7077   148%  1011  172s
  2085  1564 7298.88949   27  141 6567.55819 16160.3073   146%   994  176s
  2206  1638 7374.32430   27  115 6567.55819 16160.3073   146%   986  182s
  2368  1708 13917.2426   11  228 6567.55819 16160.3073   146%   967  187s
  2506  1823 11575.4297   14  202 6567.55819 16160.3073   146%   966  195s
  2885  2044 7254.69092   20  160 6567.55819 16006.0512   144%   929  203s
  3068  2141 14919.0433   14  390 6567.55819 15924.4438   142%   917  208s
  3264  2258 13726.7008   16  263 6567.55819 15882.6662   142%   908  214s
  3490  2350 11663.3212   19  164 6567.55819 15878.1813   142%   894  219s
  3686  2424 8196.80660   22  113 6567.55819 15691.3647   139%   885  226s
  3874  2527 9713.93578   27  197 6567.55819 15641.4851   138%   886  231s
  4065  2654 7868.24897   32  188 6567.55819 15641.4851   138%   887  237s
  4324  2761 7056.24267   43  162 6567.55819 15269.1608   132%   879  244s
  4550  2762 8316.99399   20  438 6567.55819 15269.1608   132%   878  260s
  4552  2763 9631.93090   20   89 6567.55819 15269.1608   132%   878  269s
  4553  2764 12853.1555   15  238 6567.55819 15269.1608   132%   878  276s
  4555  2765 8966.44236   19  423 6567.55819 15269.1608   132%   877  281s
  4560  2769 9593.47046   17  405 6567.55819 15269.1608   132%   876  285s
  4565  2772 10229.5208   30  463 6567.55819 15269.1608   132%   875  290s
  4569  2775 8299.73309   23  477 6567.55819 15269.1608   132%   875  295s
  4572  2777 11603.9031   12  506 6567.55819 15269.1608   132%   874  301s
  4575  2779 10894.4548   15  416 6567.55819 15269.1608   132%   873  305s
  4578  2781 9053.77386   36  503 6567.55819 15269.1608   132%   873  319s
  4579  2781 10448.4406   17  503 6567.55819 15269.1608   132%   873  325s
  4582  2788 15269.1608   14  434 6567.55819 15269.1608   132%   885  331s
  4594  2808 15269.1608   16  291 6567.55819 15269.1608   132%   886  338s
  4610  2835 15189.9519   17  294 6567.55819 15269.1608   132%   895  345s
  4674  2892 12420.9309   19  370 6567.55819 15269.1608   132%   916  355s
  4793  2942 6643.07214   21  327 6567.55819 15269.1608   132%   939  364s
  4857  2966     cutoff   22      6567.55819 15269.1608   132%   944  368s
  4945  2950 6925.96498   23  222 6567.55819 15269.1608   132%   943  373s
  4994  2944     cutoff   24      6567.55819 15189.8359   131%   941  378s
  5070  2938 10281.0575   19  178 6567.55819 15138.6154   131%   943  382s
  5128  2935 9328.74214   20  309 6567.55819 15043.4652   129%   942  386s
  5196  2948 9205.14266   21  262 6567.55819 15043.4652   129%   941  391s
  5268  2968 7984.69181   23  168 6567.55819 15043.4652   129%   942  396s
  5369  2973     cutoff   25      6567.55819 14450.2618   120%   942  401s
  5413  2971 6689.76155   19  163 6567.55819 14450.2618   120%   941  405s
H 5451  2819                    6572.1804808 14201.8676   116%   940  405s
  5558  2823 8629.65489   20  179 6572.18048 14201.8676   116%   939  415s
  5716  2822     cutoff   24      6572.18048 13817.7388   110%   943  422s
  5822  2812 11639.6656   20  208 6572.18048 13728.4809   109%   940  426s
  5917  2811 11217.0181   21  317 6572.18048 13728.4809   109%   941  432s
H 6012  2662                    6576.6874976 13698.9559   108%   942  436s
H 6097  2522                    6603.9571225 13588.7313   106%   941  439s
  6117  2551 9026.78088   26  217 6603.95712 13588.7313   106%   941  444s
  6254  2531     cutoff   28      6603.95712 13107.8134  98.5%   937  448s
  6379  2523 7053.37747   25  176 6603.95712 12811.9400  94.0%   935  455s
H 6520  2371                    6739.5068063 12811.9400  90.1%   932  458s
H 6524  2256                    7151.4204848 12811.9400  79.2%   932  458s
  6556  2242 10412.3134   20  274 7151.42048 12811.9400  79.2%   931  463s
  6723  2222 7666.22573   22  190 7151.42048 12479.1044  74.5%   927  468s
  6876  2199 9199.53363   22  257 7151.42048 12306.8818  72.1%   925  474s
  7061  2160 8918.06078   26  250 7151.42048 12306.8818  72.1%   919  479s
  7225  2091     cutoff   29      7151.42048 11903.7637  66.5%   916  485s
  7418  2037     cutoff   20      7151.42048 11720.6861  63.9%   910  490s
  7615  1955 10210.5755   21  332 7151.42048 11389.1357  59.3%   904  496s
* 7811  1782              60    7160.0944041 11389.1357  59.1%   899  496s
  7822  1754 7750.32788   24  394 7160.09440 11389.1357  59.1%   897  501s
  8035  1639     cutoff   29      7160.09440 10946.2985  52.9%   889  507s
H 8299  1433                    7187.4319047 10682.7686  48.6%   879  512s
H 8309  1332                    7252.7823242 10682.7686  47.3%   879  512s
  8384  1205 7847.20448   28  220 7252.78232 10682.7686  47.3%   877  518s
  8710   991 8596.27651   24  181 7252.78232 10226.4982  41.0%   866  523s
  9047   778     cutoff   24      7252.78232 10211.6709  40.8%   854  528s
  9202   632 7256.08593   42   24 7252.78232 9487.27790  30.8%   847  533s
* 9356   489              63    7253.6537673 9487.27790  30.8%   837  533s
  9429   262     cutoff   43      7253.65377 9199.16563  26.8%   832  538s
* 9637   129              65    7255.1775871 9090.45440  25.3%   817  538s
* 9824   129              58    7262.0719978 8941.45312  23.1%   805  538s
H10178    78                    7267.8546288 8614.97176  18.5%   780  539s
*10201    78              69    7271.2363590 8614.97176  18.5%   778  539s
 10562     0     cutoff   59      7271.23636 7347.93533  1.05%   753  540s
*10619     0              59    7283.7915045 7342.90055  0.81%   749  540s

Cutting planes:
  Learned: 2
  MIR: 306
  Mixing: 1
  Flow cover: 784
  RLT: 14
  Relax-and-lift: 55

Explored 10793 nodes (8007582 simplex iterations) in 540.09 seconds (953.88 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 7283.79 7271.24 7267.85 ... 7151.42

Optimal solution found (tolerance 1.00e-04)
Best objective 7.283791504505e+03, best bound 7.283791504505e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 540.11s
  Master Objective (UB) = 7283.79, θ = 136938.81
  Upper Bound (UB) = 7283.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 136938.81
  [DEBUG]   ✓ Scenario 0: θ = 136938.81 ≤ Q = 136938.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 136938.81 ≤ Q = 136938.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 136938.81 ≤ Q = 136938.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3e9113a5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc16eec5b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.426698e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 7515787.3594
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.619492e+05, 290 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161949.25    0  140 7515787.36 -161949.25   102%     -    0s
H    0     0                    -118802.9599 -161949.25  36.3%     -    0s
H    0     0                    -120532.6194 -161949.25  34.4%     -    0s
H    0     0                    -137699.2074 -161949.25  17.6%     -    0s
H    0     0                    -139601.0267 -148836.18  6.62%     -    0s
H    0     0                    -141562.5459 -148836.18  5.14%     -    0s
     0     0 -148836.18    0   68 -141562.55 -148836.18  5.14%     -    0s
H    0     0                    -146882.3599 -148799.21  1.31%     -    0s
     0     0 -147906.04    0   62 -146882.36 -147906.04  0.70%     -    0s
     0     0 -147762.96    0   19 -146882.36 -147762.96  0.60%     -    0s
H    0     0                    -147227.5208 -147762.96  0.36%     -    0s
     0     0 -147681.15    0   15 -147227.52 -147681.15  0.31%     -    0s
     0     0 -147674.44    0   23 -147227.52 -147674.44  0.30%     -    0s
H    0     0                    -147555.8899 -147674.44  0.08%     -    0s
     0     0 -147670.78    0    6 -147555.89 -147670.78  0.08%     -    0s
H    0     0                    -147574.1868 -147659.69  0.06%     -    0s
     0     0 -147659.69    0    6 -147574.19 -147659.69  0.06%     -    0s
H    0     0                    -147577.2948 -147659.69  0.06%     -    0s
     0     0 -147653.48    0    6 -147577.29 -147653.48  0.05%     -    0s
     0     0 -147653.48    0   15 -147577.29 -147653.48  0.05%     -    0s
     0     0 -147616.89    0    4 -147577.29 -147616.89  0.03%     -    0s
H    0     0                    -147615.3739 -147615.39  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 5
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (731 simplex iterations) in 0.22 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -147615 -147577 -147574 ... -120533

Optimal solution found (tolerance 1.00e-04)
Best objective -1.476153739030e+05, best bound -1.476153938671e+05, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 112756.44
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147615.37
  [DEBUG]   S×d_nominal = 260371.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260371.81 + -147615.37 = 112756.44
  [DEBUG]   Current θ from Master = 136938.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24182.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16898.59
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 4535.1645, Absolute Gap = 4535.1645, Relative Gap = 0.622638
  Not converged yet (gap = 4535.16 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178539 nonzeros
Model fingerprint: 0x3a0cf4ee
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -16898.6 (0.03s)
Loaded MIP start from previous solve with objective -16898.6

Presolve removed 25108 rows and 10198 columns
Presolve time: 0.95s
Presolved: 37435 rows, 17022 columns, 231699 nonzeros
Variable types: 14763 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37435 rows, 17022 columns, 231699 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   45285    1.7705492e+03   0.000000e+00   7.293761e+08      5s
   56940    2.2499327e+04   0.000000e+00   1.374086e+06     10s
   67433    2.8201737e+04   0.000000e+00   6.306214e+05     15s
Concurrent spin time: 4.66s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.053126e+04, 36691 iterations, 18.02 seconds (22.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30531.2571    0   93 -16898.586 30531.2571   281%     -   19s
H    0     0                    -12692.75754 30531.2571   341%     -   19s
H    0     0                    -12251.05421 30531.2571   349%     -   19s
H    0     0                    -10459.62643 30531.2571   392%     -   19s
H    0     0                    -10439.74966 30531.2571   392%     -   19s
H    0     0                    -4472.379185 30531.2571   783%     -   20s
H    0     0                    -4468.795474 30531.2571   783%     -   20s
H    0     0                    -4281.328568 30531.2571   813%     -   20s
H    0     0                    -4220.346354 30531.2571   823%     -   20s
H    0     0                    -4219.758706 30531.2571   824%     -   20s
H    0     0                    -4198.558456 30531.2571   827%     -   20s
     0     0 27025.7553    0  279 -4198.5585 27025.7553   744%     -   25s
H    0     0                    -2388.266970 27025.7553  1232%     -   26s
H    0     0                    -1252.344742 27025.7553  2258%     -   26s
     0     0 26934.2863    0  277 -1252.3447 26934.2863  2251%     -   28s
     0     0 26934.2863    0  278 -1252.3447 26934.2863  2251%     -   28s
     0     0 26934.2863    0  278 -1252.3447 26934.2863  2251%     -   28s
     0     0 23717.9292    0  261 -1252.3447 23717.9292  1994%     -   32s
H    0     0                    -1075.206161 23717.6605  2306%     -   33s
     0     0 23164.2958    0  308 -1075.2062 23164.2958  2254%     -   35s
     0     0 22773.1451    0  318 -1075.2062 22773.1451  2218%     -   36s
     0     0 22647.2386    0  315 -1075.2062 22647.2386  2206%     -   37s
     0     0 22589.0999    0  321 -1075.2062 22589.0999  2201%     -   37s
     0     0 22576.8996    0  325 -1075.2062 22576.8996  2200%     -   38s
     0     0 22575.1181    0  325 -1075.2062 22575.1181  2200%     -   38s
     0     0 22574.2469    0  327 -1075.2062 22574.2469  2200%     -   38s
     0     0 21292.6009    0  353 -1075.2062 21292.6009  2080%     -   44s
H    0     0                    -950.9113684 21291.8230  2339%     -   45s
     0     0 20856.6678    0  359 -950.91137 20856.6678  2293%     -   46s
     0     0 20668.6368    0  379 -950.91137 20668.6368  2274%     -   48s
     0     0 20567.5842    0  393 -950.91137 20567.5842  2263%     -   49s
     0     0 20445.1147    0  391 -950.91137 20445.1147  2250%     -   51s
     0     0 20428.5497    0  398 -950.91137 20428.5497  2248%     -   52s
     0     0 20418.3923    0  401 -950.91137 20418.3923  2247%     -   52s
     0     0 20416.5897    0  397 -950.91137 20416.5897  2247%     -   52s
     0     0 20414.6878    0  388 -950.91137 20414.6878  2247%     -   52s
H    0     0                    -835.9627510 20414.2072  2542%     -   53s
H    0     0                    -816.8560822 20414.2072  2599%     -   53s
H    0     0                    -807.2610319 20414.2072  2629%     -   53s
     0     0 20414.2072    0  394 -807.26103 20414.2072  2629%     -   53s
H    0     0                     556.3940571 20414.2072  3569%     -   56s
H    0     0                     561.5343685 20414.2072  3535%     -   56s
H    0     0                     694.4000129 20414.2072  2840%     -   56s
     0     0 19805.7529    0  393  694.40001 19805.7529  2752%     -   60s
     0     0 19539.9719    0  450  694.40001 19539.9719  2714%     -   63s
     0     0 19313.6078    0  442  694.40001 19313.6078  2681%     -   67s
     0     0 19232.3776    0  394  694.40001 19232.3776  2670%     -   68s
     0     0 19176.7464    0  344  694.40001 19176.7464  2662%     -   69s
     0     0 19159.2521    0  406  694.40001 19159.2521  2659%     -   69s
     0     0 19145.2255    0  347  694.40001 19145.2255  2657%     -   70s
     0     0 19140.7332    0  407  694.40001 19140.7332  2656%     -   70s
     0     0 19139.6157    0  404  694.40001 19139.6157  2656%     -   71s
     0     0 18927.7126    0  398  694.40001 18927.7126  2626%     -   74s
H    0     0                     702.1674530 18927.1551  2596%     -   75s
H    0     0                    1089.1039533 18927.1551  1638%     -   75s
     0     0 18897.2138    0  395 1089.10395 18897.2138  1635%     -   75s
     0     0 18851.1213    0  404 1089.10395 18851.1213  1631%     -   77s
     0     0 18844.6271    0  414 1089.10395 18844.6271  1630%     -   77s
     0     0 18831.3450    0  407 1089.10395 18831.3450  1629%     -   78s
     0     0 18828.8290    0  419 1089.10395 18828.8290  1629%     -   78s
     0     0 18827.3837    0  422 1089.10395 18827.3837  1629%     -   78s
     0     0 18827.3556    0  417 1089.10395 18827.3556  1629%     -   78s
     0     0 18768.0072    0  403 1089.10395 18768.0072  1623%     -   80s
     0     0 18757.5097    0  404 1089.10395 18757.5097  1622%     -   83s
     0     0 18751.6703    0  412 1089.10395 18751.6703  1622%     -   83s
     0     0 18751.2603    0  412 1089.10395 18751.2603  1622%     -   83s
     0     0 18730.7206    0  422 1089.10395 18730.7206  1620%     -   84s
     0     0 18726.5766    0  428 1089.10395 18726.5766  1619%     -   85s
     0     0 18725.3821    0  430 1089.10395 18725.3821  1619%     -   85s
     0     0 18717.9813    0  431 1089.10395 18717.9813  1619%     -   86s
     0     0 18714.6350    0  428 1089.10395 18714.6350  1618%     -   87s
     0     0 18713.0014    0  430 1089.10395 18713.0014  1618%     -   87s
     0     0 18711.3460    0  470 1089.10395 18711.3460  1618%     -   88s
     0     0 18711.2913    0  428 1089.10395 18711.2913  1618%     -   88s
H    0     0                    1186.3083732 18711.2913  1477%     -   88s
H    0     0                    1266.4021374 18707.3780  1377%     -   89s
H    0     0                    1923.8952403 18707.3780   872%     -   89s
H    0     0                    1962.1223641 18707.3780   853%     -   89s
H    0     0                    2000.0703534 18707.3780   835%     -   89s
     0     0 18707.3780    0  432 2000.07035 18707.3780   835%     -   89s
H    0     0                    2010.8398248 18707.2774   830%     -   89s
H    0     0                    2052.4877674 18707.2774   811%     -   89s
     0     0 18706.9681    0  434 2052.48777 18706.9681   811%     -   89s
     0     0 18700.5069    0  439 2052.48777 18700.5069   811%     -   90s
     0     0 18699.3883    0  439 2052.48777 18699.3883   811%     -   91s
H    0     0                    2543.7950798 18699.3883   635%     -  106s
     0     2 18699.3883    0  439 2543.79508 18699.3883   635%     -  109s
     1     4 18232.8294    1  431 2543.79508 18698.7293   635%  1676  114s
     3     8 18066.9386    2  427 2543.79508 18358.6929   622%  3031  118s
     7    16 17942.7168    3  432 2543.79508 18065.2770   610%  3665  122s
    15    32 17749.2219    4  492 2543.79508 17942.7097   605%  3562  128s
    31    55 15172.5667    5  288 2543.79508 17749.1602   598%  4496  139s
H   54    87                    4382.9544465 17749.0990   305%  4433  149s
H   79    87                    4520.8584346 17749.0990   293%  3847  149s
    86   233 16504.0842    7  353 4520.85843 17749.0990   293%  3656  158s
   232   303 16446.7859   11  348 4520.85843 17749.0990   293%  2133  165s
H  257   303                    4525.6144893 17749.0990   292%  2176  165s
H  261   303                    4548.3834611 17749.0990   290%  2196  165s
   304   376 15094.9264   11  261 4548.38346 17749.0990   290%  2093  173s
   380   421 14887.0617    9  261 4548.38346 17749.0990   290%  2015  183s
   448   463 14560.2745   11  222 4548.38346 17431.2828   283%  1931  189s
   506   499 15989.2959   12  335 4548.38346 17429.4983   283%  1928  197s
   554   542 15895.2769   12  288 4548.38346 17429.4983   283%  2119  204s
   613   588 15879.4173   12  386 4548.38346 17429.4983   283%  2105  208s
   669   642 15818.9165   12  280 4548.38346 17429.4983   283%  2063  215s
   741   703 14525.4280   12  235 4548.38346 17429.4983   283%  2017  220s
   909   862 13518.7837   12  219 4548.38346 17429.4983   283%  1827  230s
  1005   899 13673.7690   13  208 4548.38346 17429.4983   283%  1748  236s
  1084   943 13362.9138   15  189 4548.38346 17260.9358   279%  1694  245s
  1138  1019 12101.2772   15  195 4548.38346 17260.9358   279%  1668  251s
  1242  1110 11175.8902   16  189 4548.38346 17260.9358   279%  1605  259s
  1355  1135 13075.1067   16  183 4548.38346 17260.9358   279%  1533  264s
H 1359  1135                    5350.5985854 17260.9358   223%  1532  264s
H 1398  1200                    5905.1758784 17260.9358   192%  1523  269s
H 1417  1200                    5949.2344293 17260.9358   190%  1513  269s
  1522  1277 9181.24135   18  170 5949.23443 16978.7657   185%  1465  276s
  1643  1373 9997.60711   18  181 5949.23443 16978.7657   185%  1431  282s
H 1679  1373                    6181.1019093 16978.7657   175%  1421  282s
H 1711  1373                    6195.0371814 16978.7657   174%  1403  282s
H 1730  1373                    6482.4888240 16978.7657   162%  1405  282s
  1755  1444 11148.7725   17  190 6482.48882 16978.7657   162%  1405  288s
H 1898  1528                    6633.6764449 16978.7657   156%  1369  297s
H 1947  1528                    6668.2766986 16900.9673   153%  1356  297s
  2024  1639 10471.1509   27  219 6668.27670 16900.9673   153%  1343  307s
  2183  1702 10260.4764   29  216 6668.27670 16900.9673   153%  1309  313s
H 2212  1702                    6692.3327456 16900.9673   153%  1301  313s
  2272  1850 10002.6057   30  246 6692.33275 16900.9673   153%  1292  320s
  2472  1889 7514.94300   41  131 6692.33275 16665.9183   149%  1248  326s
  2662  1985 9190.32114   47  200 6692.33275 16665.9183   149%  1216  334s
  2861  2002 8120.47394   52  104 6692.33275 16574.4462   148%  1186  341s
H 2880  1989                    6769.4494261 16553.7119   145%  1189  341s
  2908  2118 8100.03089   53  100 6769.44943 16553.7119   145%  1190  348s
  3116  2144 7895.04756   55   22 6769.44943 16553.7119   145%  1165  353s
  3153  2174 7723.99372   55   46 6769.44943 16503.5450   144%  1166  359s
  3193  2219 7894.23045   56   99 6769.44943 16488.0074   144%  1170  365s
H 3205  2209                    6825.8488753 16488.0074   142%  1169  365s
  3261  2318 7812.32099   55   91 6825.84888 16488.0074   142%  1166  373s
H 3291  2314                    6857.3291153 16488.0074   140%  1160  373s
  3455  2453 7841.73520   62  103 6857.32912 16488.0074   140%  1148  382s
  3673  2610 7622.68179   74  106 6857.32912 16488.0074   140%  1136  391s
  3905  2611 9079.16258   52  439 6857.32912 16427.3412   140%  1121  458s
  3907  2612 7439.01160   52   93 6857.32912 16427.3412   140%  1121  472s
  3908  2613 12860.4447   13  382 6857.32912 16427.3412   140%  1121  484s
H 3908  2482                    6888.5681123 16427.3412   138%  1121  489s
  3909  2483 7695.00712   26  393 6888.56811 16427.3412   138%  1120  490s
  3911  2484 11358.2645   14  441 6888.56811 16427.3412   138%  1120  497s
  3912  2485 7439.01160   52  442 6888.56811 16427.3412   138%  1119  501s
  3913  2485 13321.4691   17  407 6888.56811 16427.3412   138%  1119  505s
  3917  2488 7455.81980   30  437 6888.56811 16427.3412   138%  1118  510s
  3919  2489 7524.01342   78  431 6888.56811 16427.3412   138%  1117  515s
  3922  2491 14954.6567   13  436 6888.56811 16427.3412   138%  1117  521s
  3924  2493 14430.1307   18  490 6888.56811 16427.3412   138%  1116  525s
  3926  2494 7787.88752   44  482 6888.56811 16427.3412   138%  1115  530s
  3929  2496 11034.9548   20  452 6888.56811 16427.3412   138%  1115  536s
  3930  2497 8901.18438   19  444 6888.56811 16427.3412   138%  1114  540s
  3932  2498 14507.8395   10  455 6888.56811 16427.3412   138%  1114  545s
  3934  2499 14522.9792   13  505 6888.56811 16427.3412   138%  1113  553s
  3935  2500 14985.1575   11  434 6888.56811 16427.3412   138%  1113  555s
  3938  2502 9302.14092   29  437 6888.56811 16427.3412   138%  1112  561s
  3940  2503 9000.63780   21  431 6888.56811 16427.3412   138%  1111  565s
  3943  2505 16291.3271    8  584 6888.56811 16427.3412   138%  1111  572s
  3945  2507 12555.8948   21  446 6888.56811 16427.3412   138%  1110  577s
  3947  2508 9318.23963   21  443 6888.56811 16427.3412   138%  1109  581s
  3948  2509 12482.6346   21  443 6888.56811 16427.3412   138%  1109  597s
  3949  2509 8277.69903   54  443 6888.56811 16427.3412   138%  1109  610s
  3950  2513 16427.3412   15  424 6888.56811 16427.3412   138%  1137  620s
  3952  2516 16427.3412   16  340 6888.56811 16427.3412   138%  1137  628s
  3956  2523 16427.3412   17  347 6888.56811 16427.3412   138%  1140  638s
  3964  2536 16427.3412   18  369 6888.56811 16427.3412   138%  1145  645s
  3980  2563 15875.0232   19  413 6888.56811 16427.3412   138%  1162  657s
  4012  2564 13376.2867   20  258 6888.56811 15894.1948   131%  1193  671s
  4024  2614 12738.5740   21  240 6888.56811 15894.1948   131%  1214  689s
  4095  2612 10687.5584   23  293 6888.56811 15874.7466   130%  1280  698s
  4135  2621 8377.14822   23  177 6888.56811 15874.7466   130%  1299  714s
  4221  2634 9771.00568   22  214 6888.56811 15391.1920   123%  1311  721s
  4300  2632 10607.7700   24  227 6888.56811 15390.6999   123%  1317  733s
  4385  2634 10010.0918   26  217 6888.56811 14852.2314   116%  1316  740s
  4458  2630     cutoff   28      6888.56811 14852.2314   116%  1320  749s
  4531  2634 9068.02533   31  122 6888.56811 14446.6850   110%  1329  757s
  4586  2649 infeasible   32      6888.56811 14446.6850   110%  1336  764s
  4660  2648     cutoff   33      6888.56811 14446.6850   110%  1340  774s
  4731  2648     cutoff   34      6888.56811 14446.6850   110%  1342  785s
  4813  2639 8252.33756   39  213 6888.56811 14446.6850   110%  1342  796s
  4893  2622     cutoff   43      6888.56811 14446.6850   110%  1349  805s
  4980  2605     cutoff   23      6888.56811 13948.4919   102%  1352  815s
  5060  2602 12428.2371   23  408 6888.56811 13826.1587   101%  1358  823s
  5121  2616 12049.8010   24  354 6888.56811 13640.0418  98.0%  1364  832s
  5195  2625 11357.2552   26  272 6888.56811 13577.6869  97.1%  1368  843s
  5279  2625 10893.5503   29  196 6888.56811 13577.6869  97.1%  1374  853s
  5378  2619     cutoff   33      6888.56811 13577.6869  97.1%  1376  863s
  5478  2622 9598.46867   33  288 6888.56811 13577.6869  97.1%  1377  874s
  5572  2605 8246.71834   37   76 6888.56811 13577.6869  97.1%  1384  882s
  5696  2584     cutoff   40      6888.56811 13577.6869  97.1%  1382  894s
  5758  2563 7168.38281   46  169 6888.56811 13577.6869  97.1%  1382  895s
  5849  2521 9768.76431   24  401 6888.56811 13577.6869  97.1%  1377  905s
  5971  2504 9567.40787   25  385 6888.56811 12777.8578  85.5%  1384  916s
  6100  2481 7931.09117   26  349 6888.56811 12539.3855  82.0%  1391  933s
  6189  2491 8338.38090   27  307 6888.56811 12513.1713  81.7%  1394  945s
  6309  2484 7407.19121   27  256 6888.56811 12513.1713  81.7%  1399  956s
  6457  2469 6985.11270   28  240 6888.56811 11983.9277  74.0%  1401  969s
  6625  2446 8179.39778   30  315 6888.56811 11864.5444  72.2%  1401  981s
  6832  2366 7266.59842   31  165 6888.56811 11711.0635  70.0%  1393  993s
  7016  2320 8769.80379   23  313 6888.56811 11421.7926  65.8%  1388 1008s
  7184  2265     cutoff   25      6888.56811 11421.7926  65.8%  1390 1021s
  7402  2180 7226.28605   26  299 6888.56811 11114.3861  61.3%  1387 1037s
  7626  2094     cutoff   34      6888.56811 10867.7190  57.8%  1388 1049s
  7886  1958 7808.04827   32  250 6888.56811 10602.1030  53.9%  1379 1061s
  8142  1825     cutoff   32      6888.56811 10194.4399  48.0%  1367 1076s
  8444  1658 8625.34811   30  294 6888.56811 9839.82191  42.8%  1355 1089s
  8780  1378 8386.04066   28  206 6888.56811 9769.82311  41.8%  1334 1102s
  9271  1007 7351.27356   33  207 6888.56811 9341.69119  35.6%  1302 1117s
  9805   636     cutoff   29      6888.56811 8837.47264  28.3%  1264 1129s
 10378   398     cutoff   29      6888.56811 8413.55463  22.1%  1212 1140s
 10839   241 6991.60510   51   36 6888.56811 7165.39821  4.02%  1163 1149s
 11065   139 6921.27281   50   34 6888.56811 7016.66672  1.86%  1141 1159s
 11173   103     cutoff   54      6888.56811 6929.48514  0.59%  1130 1167s
 11175   102     cutoff   55      6888.56811 6915.06711  0.38%  1130 1176s
 11177   100 6914.60890   56   16 6888.56811 6914.60890  0.38%  1130 1183s

Cutting planes:
  Gomory: 4
  MIR: 333
  Flow cover: 711
  RLT: 13
  Relax-and-lift: 49

Explored 11188 nodes (12726417 simplex iterations) in 1183.80 seconds (2037.92 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6888.57 6857.33 6825.85 ... 6181.1

Optimal solution found (tolerance 1.00e-04)
Best objective 6.888568112294e+03, best bound 6.888568112294e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1183.81s
  Master Objective (UB) = 6888.57, θ = 136127.57
  Upper Bound (UB) = 6888.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 136127.57
  [DEBUG]   ✓ Scenario 0: θ = 136127.57 ≤ Q = 136127.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 136127.57 ≤ Q = 136127.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 136127.57 ≤ Q = 136127.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 136127.57 ≤ Q = 136127.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5069ff99
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaf960067
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.445973e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 7586967.2278
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.605192e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160519.15    0  126 7586967.23 -160519.15   102%     -    0s
H    0     0                    -121671.4635 -160519.15  31.9%     -    0s
H    0     0                    -122239.0603 -160519.15  31.3%     -    0s
H    0     0                    -132464.6007 -160519.15  21.2%     -    0s
H    0     0                    -142721.3712 -145607.30  2.02%     -    0s
     0     0 -145607.30    0   82 -142721.37 -145607.30  2.02%     -    0s
H    0     0                    -143066.2041 -145479.56  1.69%     -    0s
H    0     0                    -143417.7597 -145479.56  1.44%     -    0s
H    0     0                    -143762.5926 -145479.56  1.19%     -    0s
     0     0 -144518.82    0   51 -143762.59 -144518.82  0.53%     -    0s
     0     0 -144460.61    0   46 -143762.59 -144460.61  0.49%     -    0s
     0     0 -144458.14    0   46 -143762.59 -144458.14  0.48%     -    0s
     0     0 -144121.84    0   31 -143762.59 -144121.84  0.25%     -    0s
H    0     0                    -143772.6077 -144119.85  0.24%     -    0s
     0     0 -143998.37    0   43 -143772.61 -143998.37  0.16%     -    0s
     0     0 -143998.36    0   35 -143772.61 -143998.36  0.16%     -    0s
     0     0 -143994.73    0   35 -143772.61 -143994.73  0.15%     -    0s
     0     0 -143912.91    0   25 -143772.61 -143912.91  0.10%     -    0s
     0     0 -143890.37    0   22 -143772.61 -143890.37  0.08%     -    0s
     0     0 -143890.37    0   21 -143772.61 -143890.37  0.08%     -    0s
     0     0 -143890.37    0   15 -143772.61 -143890.37  0.08%     -    0s
     0     0 -143890.37    0   15 -143772.61 -143890.37  0.08%     -    0s
     0     0 -143852.22    0    7 -143772.61 -143852.22  0.06%     -    0s
     0     0 -143852.22    0   17 -143772.61 -143852.22  0.06%     -    0s
     0     0 -143805.69    0    9 -143772.61 -143805.69  0.02%     -    0s
H    0     0                    -143799.3279 -143802.26  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 4
  Flow cover: 9
  Relax-and-lift: 2

Explored 1 nodes (878 simplex iterations) in 0.21 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -143799 -143773 -143763 ... 1.44597e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.437993279419e+05, best bound -1.438022608061e+05, gap 0.0020%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 117226.34
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143799.33
  [DEBUG]   S×d_nominal = 261025.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261025.66 + -143799.33 = 117226.34
  [DEBUG]   Current θ from Master = 136127.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18901.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12012.67
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 4139.9411, Absolute Gap = 4139.9411, Relative Gap = 0.600987
  Not converged yet (gap = 4139.94 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221794 nonzeros
Model fingerprint: 0x6321e1a7
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31390 rows and 12750 columns
Presolve time: 1.25s
Presolved: 46443 rows, 20710 columns, 288229 nonzeros
Variable types: 18451 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315267.1831
Found heuristic solution: objective -174979.4334

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46443 rows, 20710 columns, 288229 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25465   -1.4976791e+04   0.000000e+00   2.414640e+07      5s
   35254    1.8016861e+04   0.000000e+00   5.208797e+06     10s
   43891    2.3840277e+04   0.000000e+00   1.460945e+06     15s
   52642    2.6914472e+04   0.000000e+00   8.427592e+05     20s
Concurrent spin time: 0.95s

Solved with dual simplex

Root relaxation: objective 3.042414e+04, 35207 iterations, 22.28 seconds (29.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30424.1388    0   98 -174979.43 30424.1388   117%     -   24s
H    0     0                    -167326.2325 30424.1388   118%     -   24s
H    0     0                    -113291.5983 30424.1388   127%     -   24s
H    0     0                    -112898.5969 30424.1388   127%     -   24s
H    0     0                    -54594.98190 30424.1388   156%     -   24s
H    0     0                    -52813.36829 30424.1388   158%     -   24s
H    0     0                    -7270.303189 30424.1388   518%     -   25s
H    0     0                    -5608.915007 30424.1388   642%     -   25s
H    0     0                    -5515.918427 30424.1388   652%     -   25s
H    0     0                    -5037.595318 30424.1388   704%     -   25s
H    0     0                    -4976.968873 26702.0128   637%     -   34s
     0     0 26431.0759    0  278 -4976.9689 26431.0759   631%     -   34s
H    0     0                    -4706.606557 26431.0759   662%     -   35s
H    0     0                    -4670.873713 26431.0759   666%     -   35s
H    0     0                    -4546.496202 26431.0759   681%     -   35s
     0     0 26431.0759    0  284 -4546.4962 26431.0759   681%     -   37s
     0     0 26431.0759    0  292 -4546.4962 26431.0759   681%     -   37s
     0     0 26431.0759    0  288 -4546.4962 26431.0759   681%     -   38s
     0     0 26431.0759    0  289 -4546.4962 26431.0759   681%     -   38s
     0     0 23134.6556    0  330 -4546.4962 23134.6556   609%     -   49s
H    0     0                    1349.2841821 23133.5090  1615%     -   50s
     0     0 22596.3645    0  322 1349.28418 22596.3645  1575%     -   55s
     0     0 22028.8656    0  332 1349.28418 22028.8656  1533%     -   59s
     0     0 21892.3569    0  330 1349.28418 21892.3569  1523%     -   60s
     0     0 21874.5461    0  336 1349.28418 21874.5461  1521%     -   61s
     0     0 21870.0196    0  337 1349.28418 21870.0196  1521%     -   61s
     0     0 21867.8899    0  338 1349.28418 21867.8899  1521%     -   62s
     0     0 21860.4407    0  344 1349.28418 21860.4407  1520%     -   62s
     0     0 21860.1715    0  347 1349.28418 21860.1715  1520%     -   62s
H    0     0                    1633.2089257 20676.5783  1166%     -   75s
H    0     0                    1900.7086539 20676.5783   988%     -   75s
H    0     0                    2414.6175433 20676.5783   756%     -   75s
H    0     0                    2425.9060316 20676.5783   752%     -   75s
H    0     0                    3208.8852603 20676.5783   544%     -   75s
     0     0 20676.5783    0  375 3208.88526 20676.5783   544%     -   75s
     0     0 20285.0889    0  416 3208.88526 20285.0889   532%     -   82s
     0     0 20102.2584    0  424 3208.88526 20102.2584   526%     -   87s
     0     0 20030.5112    0  423 3208.88526 20030.5112   524%     -   89s
     0     0 19963.2819    0  422 3208.88526 19963.2819   522%     -   91s
     0     0 19934.0048    0  431 3208.88526 19934.0048   521%     -   92s
     0     0 19866.0673    0  425 3208.88526 19866.0673   519%     -   93s
     0     0 19844.3384    0  436 3208.88526 19844.3384   518%     -   94s
     0     0 19842.4118    0  431 3208.88526 19842.4118   518%     -   94s
     0     0 19825.9918    0  430 3208.88526 19825.9918   518%     -   95s
     0     0 19823.2614    0  433 3208.88526 19823.2614   518%     -   96s
     0     0 19821.3973    0  431 3208.88526 19821.3973   518%     -   96s
     0     0 19820.4024    0  430 3208.88526 19820.4024   518%     -   96s
H    0     0                    4763.8677410 19820.4024   316%     -  102s
H    0     0                    4878.0383772 19820.4024   306%     -  102s
H    0     0                    4940.5054709 19820.4024   301%     -  102s
     0     0 19010.5735    0  395 4940.50547 19010.5735   285%     -  111s
H    0     0                    5037.2477054 19010.3975   277%     -  112s
H    0     0                    5099.7747917 19010.3975   273%     -  112s
H    0     0                    5169.1590395 19010.3975   268%     -  112s
H    0     0                    5175.7629070 19010.3975   267%     -  112s
H    0     0                    5180.3320289 19010.3975   267%     -  112s
     0     0 18905.5260    0  402 5180.33203 18905.5260   265%     -  115s
     0     0 18878.1699    0  401 5180.33203 18878.1699   264%     -  117s
     0     0 18771.0917    0  340 5180.33203 18771.0917   262%     -  119s
     0     0 18759.8078    0  395 5180.33203 18759.8078   262%     -  120s
     0     0 18749.8424    0  414 5180.33203 18749.8424   262%     -  121s
     0     0 18747.5493    0  403 5180.33203 18747.5493   262%     -  121s
     0     0 18742.4182    0  416 5180.33203 18742.4182   262%     -  122s
     0     0 18741.2038    0  415 5180.33203 18741.2038   262%     -  122s
     0     0 18561.3073    0  422 5180.33203 18561.3073   258%     -  126s
     0     0 18536.4450    0  422 5180.33203 18536.4450   258%     -  127s
     0     0 18521.2965    0  432 5180.33203 18521.2965   258%     -  128s
     0     0 18516.8969    0  468 5180.33203 18516.8969   257%     -  129s
     0     0 18515.5005    0  432 5180.33203 18515.5005   257%     -  130s
     0     0 18477.2670    0  460 5180.33203 18477.2670   257%     -  132s
H    0     0                    5384.8231663 18477.0618   243%     -  133s
     0     0 18471.0559    0  428 5384.82317 18471.0559   243%     -  134s
     0     0 18470.1920    0  424 5384.82317 18470.1920   243%     -  135s
     0     0 18431.3192    0  426 5384.82317 18431.3192   242%     -  138s
     0     0 18428.1746    0  421 5384.82317 18428.1746   242%     -  139s
     0     0 18426.5985    0  414 5384.82317 18426.5985   242%     -  140s
     0     0 18426.0606    0  417 5384.82317 18426.0606   242%     -  140s
     0     0 18418.1485    0  412 5384.82317 18418.1485   242%     -  142s
H    0     0                    5386.5217985 18418.0481   242%     -  143s
H    0     0                    5436.9436789 18418.0481   239%     -  143s
H    0     0                    5465.0531872 18418.0481   237%     -  143s
     0     0 18415.4811    0  422 5465.05319 18415.4811   237%     -  143s
     0     0 18414.5732    0  425 5465.05319 18414.5732   237%     -  144s
     0     0 18413.3753    0  419 5465.05319 18413.3753   237%     -  145s
     0     0 18412.2858    0  423 5465.05319 18412.2858   237%     -  146s
     0     0 18402.2267    0  421 5465.05319 18402.2267   237%     -  148s
     0     0 18401.1188    0  421 5465.05319 18401.1188   237%     -  149s
H    0     0                    5484.1109381 18400.7442   236%     -  170s
H    0     0                    5522.4227145 18400.7442   233%     -  170s
     0     2 18400.7442    0  421 5522.42271 18400.7442   233%     -  187s
     1     4 18203.7833    1  400 5522.42271 18400.7098   233%  2790  192s
     3     8 17578.7752    2  406 5522.42271 18202.6342   230%  4205  198s
     7    16 17357.0802    3  397 5522.42271 17578.7057   218%  4712  203s
    15    32 16795.7444    4  409 5522.42271 17356.3617   214%  4539  211s
    31    51 14212.2383    5  272 5522.42271 16901.3692   206%  6725  226s
    50    83 15351.1672    6  317 5522.42271 16901.3692   206%  6357  234s
H   82   117                    5615.3675931 16901.3692   201%  5397  241s
H   83   117                    5620.0206078 16901.3692   201%  5358  241s
H   84   117                    5641.8908052 16901.3692   200%  5304  241s
H   88   117                    5738.4563462 16901.3692   195%  5119  241s
H  101   117                    5759.6074877 16901.3692   193%  4674  241s
H  106   117                    5803.7178839 16901.3692   191%  4579  241s
H  112   117                    5854.1758025 16901.3692   189%  4489  241s
   116   255 15319.4598    8  296 5854.17580 16901.3692   189%  4384  252s
   255   309 15131.4613   10  280 5854.17580 16901.3692   189%  2832  262s
   329   354 13847.1727   11  275 5854.17580 16901.3692   189%  2690  273s
   407   409 14799.8765   11  234 5854.17580 16901.3692   189%  2543  284s
   483   459 14511.1902   11  224 5854.17580 16901.3692   189%  2440  295s
   556   486 15104.9123   11  282 5854.17580 16901.3692   189%  2376  305s
   589   522 14312.5623   12  311 5854.17580 16901.3692   189%  2417  312s
   629   548 14229.1845   12  226 5854.17580 16901.3692   189%  2480  319s
   667   566 14234.6893   12  225 5854.17580 16901.3692   189%  2492  330s
   711   592 13808.3492   13  345 5854.17580 16901.3692   189%  2524  338s
   745   616 13759.6812   13  305 5854.17580 16901.3692   189%  2597  348s
   787   645 13506.7907   14  289 5854.17580 16901.3692   189%  2577  355s
   826   671 13117.7903   14  343 5854.17580 16795.4099   187%  2590  364s
   874   699 13127.2892   14  299 5854.17580 16795.4099   187%  2599  375s
   916   730 12901.8515   15  300 5854.17580 16438.6937   181%  2601  386s
   953   757 12767.2580   15  342 5854.17580 16438.2722   181%  2616  392s
   994   792 6601.61499   13  273 5854.17580 16438.2722   181%  2660  404s
  1041   828 11080.6113   15  339 5854.17580 16438.2722   181%  2644  414s
  1109   867 12142.5437   16  399 5854.17580 16438.2722   181%  2620  425s
  1176   923 11199.2839   17  360 5854.17580 16438.2722   181%  2625  434s
  1214   923 infeasible   29      5854.17580 16438.2722   181%  2613  435s
  1240  1003 11160.2279   18  350 5854.17580 16438.2722   181%  2608  445s
  1320  1059 10936.6719   19  341 5854.17580 16438.2722   181%  2578  457s
  1406  1109 10612.2214   20  337 5854.17580 16317.9359   179%  2572  467s
  1491  1172 10819.5323   19  354 5854.17580 16317.9359   179%  2584  477s
  1580  1238 10406.6482   20  301 5854.17580 16317.9359   179%  2604  488s
  1680  1323 9984.21483   21  216 5854.17580 16317.9359   179%  2600  499s
  1797  1442 10000.5781   21  343 5854.17580 16317.9359   179%  2569  509s
  1942  1515 10257.3017   20  296 5854.17580 16317.9359   179%  2495  517s
  2111  1542 9810.93833   20  352 5854.17580 16317.9359   179%  2413  531s
  2228  1628 9974.85087   22  313 5854.17580 16317.9359   179%  2423  545s
  2340  1690 10326.9776   21  323 5854.17580 16317.9359   179%  2444  558s
  2463  1751 9730.70917   23  227 5854.17580 15738.7783   169%  2461  572s
  2612  1831 9235.60404   26  198 5854.17580 15738.6428   169%  2465  585s
  2748  1900 8904.48262   29  224 5854.17580 15738.6428   169%  2489  600s
  2867  1979 8647.60090   34  206 5854.17580 15738.6428   169%  2522  612s
  3020  2063 8176.97389   37  140 5854.17580 15738.6428   169%  2529  627s
H 3194  2126                    5866.3976216 15738.6428   168%  2535  643s
H 3207  2124                    5916.3784782 15738.6428   166%  2534  643s
H 3233  2124                    5942.5194276 15738.6428   165%  2538  643s
  3304  2211 7655.16894   42  139 5942.51943 15736.5487   165%  2557  657s
  3459  2313 7060.84406   44  142 5942.51943 15594.7631   162%  2575  672s
  3626  2418 6061.46717   48  127 5942.51943 15389.4916   159%  2598  688s
  3783  2552 13974.5703   12  488 5942.51943 15388.8879   159%  2628  705s
  4010  2553 9912.89524   42  421 5942.51943 15388.8879   159%  2614  792s
  4012  2554 6777.31689   20   98 5942.51943 15388.8879   159%  2612  817s
  4013  2555 7371.66144   25  333 5942.51943 15388.8879   159%  2612  830s
  4014  2556 14446.9894    8  313 5942.51943 15388.8879   159%  2611  839s
  4015  2556 7531.56661   19  392 5942.51943 15388.8879   159%  2610  847s
  4016  2557 9930.82599   20  413 5942.51943 15388.8879   159%  2610  854s
  4017  2558 8636.31144   23  387 5942.51943 15388.8879   159%  2609  858s
  4018  2558 8509.44433   37  394 5942.51943 15388.8879   159%  2608  862s
  4019  2559 7573.36825   13  404 5942.51943 15388.8879   159%  2608  866s
  4021  2560 14089.8142    9  411 5942.51943 15388.8879   159%  2606  871s
  4023  2562 13532.6824   14  410 5942.51943 15388.8879   159%  2605  877s
  4025  2563 7432.74400   37  410 5942.51943 15388.8879   159%  2604  883s
  4026  2564 13149.4829   15  419 5942.51943 15388.8879   159%  2603  885s
  4028  2565 7724.02626   16  447 5942.51943 15388.8879   159%  2602  891s
  4030  2566 12471.8991   13  497 5942.51943 15388.8879   159%  2601  896s
  4031  2567 12122.3751    9  424 5942.51943 15388.8879   159%  2600  900s
  4033  2568 7492.19946   41  444 5942.51943 15388.8879   159%  2599  906s
  4035  2570 7666.91811   29  442 5942.51943 15388.8879   159%  2597  912s
  4036  2570 9521.28086   28  442 5942.51943 15388.8879   159%  2597  956s
  4037  2571 8788.92039   23  442 5942.51943 15388.8879   159%  2596  972s
  4038  2575 15388.8879   10  457 5942.51943 15388.8879   159%  2624  981s
  4040  2578 15388.8879   11  350 5942.51943 15388.8879   159%  2624  997s
  4044  2585 15388.8879   12  409 5942.51943 15388.8879   159%  2627 1010s
  4052  2598 15388.8879   13  434 5942.51943 15388.8879   159%  2632 1020s
  4068  2617 15388.8879   14  414 5942.51943 15388.8879   159%  2665 1044s
  4093  2634 14030.9775   15  371 5942.51943 15388.8879   159%  2688 1059s
  4125  2671 13465.7481   16  376 5942.51943 15388.8879   159%  2719 1085s
  4172  2754 13433.2106   17  429 5942.51943 15388.8879   159%  2751 1104s
  4275  2776 13281.0078   20  403 5942.51943 15388.8879   159%  2743 1118s
  4361  2812 12499.5757   22  326 5942.51943 15388.8879   159%  2732 1133s
  4447  2805 11373.5419   22  212 5942.51943 15388.8879   159%  2718 1139s
  4487  2817 11340.9515   21  245 5942.51943 15388.8879   159%  2712 1157s
  4536  2839 12191.4280   23  326 5942.51943 15388.8879   159%  2710 1176s
  4595  2853 11754.0872   23  321 5942.51943 15388.8879   159%  2702 1186s
  4677  2865 11663.9109   24  265 5942.51943 15388.8879   159%  2681 1197s
  4755  2869 11340.9694   25  233 5942.51943 15388.8879   159%  2663 1210s
  4831  2874 11201.0503   26  222 5942.51943 15388.8879   159%  2649 1222s
  4904  2888 10955.9796   27  290 5942.51943 15388.8879   159%  2634 1234s
  4980  2898 8857.65768   28  273 5942.51943 15388.8879   159%  2621 1245s
  5054  2906 8547.48581   31  181 5942.51943 15388.8879   159%  2615 1255s
  5142  2910 8482.43406   32  173 5942.51943 15388.8879   159%  2599 1268s
  5234  2922 8386.88668   32  180 5942.51943 15388.8879   159%  2585 1279s
  5337  2906 7132.45685   34   93 5942.51943 15388.8879   159%  2565 1296s
  5448  2915 6395.04997   38   92 5942.51943 14310.7910   141%  2547 1309s
  5524  2931 5995.17230   46   40 5942.51943 14237.2659   140%  2546 1321s
  5629  2938     cutoff   48      5942.51943 14200.3946   139%  2534 1336s
  5730  2929 12746.3340   16  305 5942.51943 14048.9270   136%  2529 1350s
  5804  2940 12404.3178   17  250 5942.51943 14000.5200   136%  2522 1366s
  5914  2945 10924.1932   19  176 5942.51943 13899.2688   134%  2506 1382s
  6010  2967 9905.88496   21  300 5942.51943 13833.3286   133%  2504 1398s
  6103  2977 9607.17601   23  251 5942.51943 13833.3286   133%  2501 1417s
  6239  2971 6437.55616   27  306 5942.51943 13717.7290   131%  2487 1432s
  6374  2960 6193.44508   25  229 5942.51943 13531.5745   128%  2475 1449s
  6543  2935 11377.1488   18  369 5942.51943 13531.5745   128%  2456 1466s
  6704  2934 9508.28473   21  321 5942.51943 13531.5745   128%  2440 1481s
  6841  2918     cutoff   23      5942.51943 13531.5745   128%  2434 1497s
  6953  2911 6500.46117   27  133 5942.51943 13329.1638   124%  2427 1516s
  7108  2921 6900.88470   19  332 5942.51943 13329.1638   124%  2418 1535s
  7272  2900 6529.67978   22  329 5942.51943 13329.1638   124%  2406 1553s
  7451  2891 8783.13418   19  225 5942.51943 12956.9778   118%  2396 1573s
  7625  2894 7520.56285   23  208 5942.51943 12925.6095   118%  2387 1599s
  7825  2864 7015.85286   20  342 5942.51943 12912.2418   117%  2377 1621s
  8030  2839 5965.57051   27  136 5942.51943 12481.7507   110%  2364 1643s
  8212  2843 6554.91194   17  253 5942.51943 12481.7507   110%  2353 1667s
  8430  2836 6124.79201   18  189 5942.51943 12481.7507   110%  2343 1689s
  8694  2782 8169.50293   19  184 5942.51943 12213.4318   106%  2323 1712s
  9021  2708     cutoff   22      5942.51943 11979.0824   102%  2294 1738s
  9351  2683 10651.7359   17  235 5942.51943 11943.1752   101%  2271 1763s
  9581  2712 9348.54887   23  106 5942.51943 11599.5831  95.2%  2260 1790s
  9941  2662 6031.19363   58   78 5942.51943 11533.5327  94.1%  2234 1817s
 10272  2579 8042.06611   25  276 5942.51943 11511.0559  93.7%  2223 1845s
 10595  2503     cutoff   30      5942.51943 11511.0559  93.7%  2215 1873s
 10940  2460     cutoff   32      5942.51943 11206.0296  88.6%  2205 1904s
 11295  2357     cutoff   26      5942.51943 11090.8649  86.6%  2193 1935s
 11632  2297     cutoff   22      5942.51943 11090.8649  86.6%  2179 1970s
 12077  2301     cutoff   23      5942.51943 10779.6466  81.4%  2160 2001s
 12482  2335 6764.66114   26  176 5942.51943 10684.2241  79.8%  2140 2038s
 12948  2321 7831.06490   25  333 5942.51943 10446.9724  75.8%  2125 2072s
 13393  2336 8863.75553   24  147 5942.51943 10295.2102  73.2%  2109 2108s
 13852  2352 8188.74692   25  323 5942.51943 10103.4484  70.0%  2097 2146s
H13897  2344                    5999.4172790 10103.4484  68.4%  2096 2146s
 14268  2320     cutoff   28      5999.41728 10005.9127  66.8%  2083 2185s
 14844  2263     cutoff   23      5999.41728 9789.92581  63.2%  2067 2225s
 15476  2267     cutoff   22      5999.41728 9512.62040  58.6%  2044 2261s
 15642  2262 7114.83310   22  271 5999.41728 9457.75138  57.6%  2038 2301s
 16387  2177 6107.42436   22  221 5999.41728 9376.82392  56.3%  2001 2342s
 17161  1964     cutoff   29      5999.41728 8964.50670  49.4%  1972 2386s
 18022  1889 infeasible   32      5999.41728 8699.73801  45.0%  1941 2431s
H18046  1853                    6061.3085335 8698.53573  43.5%  1941 2431s
H18068  1853                    6062.3658114 8698.53573  43.5%  1940 2431s
 18415  1407 6537.40737   25  389 6062.36581 8655.67513  42.8%  1925 2475s
 19580  1242 6139.66487   34  112 6062.36581 8241.14651  35.9%  1871 2517s
 19951   884     cutoff   35      6062.36581 8020.31979  32.3%  1852 2557s
*22271   884              51    6063.5156531 7806.65946  28.7%  1698 2557s
 22528  2251     cutoff   49      6063.51565 7074.03151  16.7%  1682 2572s
H22645  2251                    6190.8284185 7074.03151  14.3%  1674 2572s
H22765  2251                    6274.2621715 7074.03151  12.7%  1666 2572s
 26240   451     cutoff   48      6274.26217 6635.73129  5.76%  1458 2579s
*26838   451              46    6282.6623861 6635.73129  5.62%  1427 2579s
 29974     0     cutoff   43      6282.66239 6407.23905  1.98%  1282 2583s
*29997     0              47    6318.2507946 6407.23905  1.41%  1281 2583s

Cutting planes:
  MIR: 617
  Mixing: 3
  Flow cover: 1568
  RLT: 15
  Relax-and-lift: 77

Explored 30883 nodes (38608223 simplex iterations) in 2583.81 seconds (4887.18 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6318.25 6318.25 6282.66 ... 5942.52

Optimal solution found (tolerance 1.00e-04)
Best objective 6.318250794595e+03, best bound 6.318250794595e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2583.84s
  Master Objective (UB) = 6318.25, θ = 140574.02
  Upper Bound (UB) = 6318.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140574.02
  [DEBUG]   ✓ Scenario 0: θ = 140574.02 ≤ Q = 145018.15 (slack: 4444.14)
  [DEBUG]   ✓ Scenario 1: θ = 140574.02 ≤ Q = 140574.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140574.02 ≤ Q = 140577.86 (slack: 3.85)
  [DEBUG]   ✓ Scenario 3: θ = 140574.02 ≤ Q = 140574.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140574.02 ≤ Q = 140584.08 (slack: 10.07)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x360822ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc9f7dd36
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.444126e+13
Presolve removed 2553 rows and 1846 columns
Presolve time: 0.01s
Presolved: 540 rows, 543 columns, 1523 nonzeros
Found heuristic solution: objective 7732407.1860
Variable types: 367 continuous, 176 integer (176 binary)

Root relaxation: objective -1.557528e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155752.77    0  125 7732407.19 -155752.77   102%     -    0s
H    0     0                    -116831.6914 -155752.77  33.3%     -    0s
H    0     0                    -117430.9294 -155752.77  32.6%     -    0s
H    0     0                    -126474.6176 -155752.77  23.1%     -    0s
     0     0 -138584.19    0  124 -126474.62 -138584.19  9.57%     -    0s
H    0     0                    -132478.7932 -138497.77  4.54%     -    0s
     0     0 -137788.58    0  131 -132478.79 -137788.58  4.01%     -    0s
H    0     0                    -133439.8422 -137776.56  3.25%     -    0s
     0     0 -137765.81    0  128 -133439.84 -137765.81  3.24%     -    0s
     0     0 -137712.53    0  131 -133439.84 -137712.53  3.20%     -    0s
H    0     0                    -134347.4805 -137712.53  2.50%     -    0s
H    0     0                    -134580.1859 -137712.53  2.33%     -    0s
     0     0 -137341.85    0  121 -134580.19 -137341.85  2.05%     -    0s
     0     0 -137313.49    0  121 -134580.19 -137313.49  2.03%     -    0s
     0     0 -136599.91    0  120 -134580.19 -136599.91  1.50%     -    0s
H    0     0                    -134622.9851 -136534.01  1.42%     -    0s
     0     0 -136534.01    0  123 -134622.99 -136534.01  1.42%     -    0s
     0     0 -135781.55    0   96 -134622.99 -135781.55  0.86%     -    0s
     0     0 -135721.33    0   97 -134622.99 -135721.33  0.82%     -    0s
     0     0 -135712.75    0   99 -134622.99 -135712.75  0.81%     -    0s
     0     0 -135461.27    0   76 -134622.99 -135461.27  0.62%     -    0s
     0     0 -135422.34    0   64 -134622.99 -135422.34  0.59%     -    0s
     0     0 -135422.34    0   77 -134622.99 -135422.34  0.59%     -    0s
H    0     0                    -134702.2468 -135422.34  0.53%     -    0s
     0     0 -135284.14    0   61 -134702.25 -135284.14  0.43%     -    0s
     0     0 -135171.96    0   67 -134702.25 -135171.96  0.35%     -    0s
     0     0 -135171.95    0   65 -134702.25 -135171.95  0.35%     -    0s
     0     0 -135014.20    0   32 -134702.25 -135014.20  0.23%     -    0s
     0     0 -135000.73    0   29 -134702.25 -135000.73  0.22%     -    0s
     0     0 -134942.97    0   22 -134702.25 -134942.97  0.18%     -    0s
     0     0 -134934.93    0   22 -134702.25 -134934.93  0.17%     -    0s
     0     0 -134910.57    0   22 -134702.25 -134910.57  0.15%     -    0s
     0     0 -134910.57    0   39 -134702.25 -134910.57  0.15%     -    0s
     0     0 -134910.57    0   38 -134702.25 -134910.57  0.15%     -    0s
     0     0 -134820.48    0   21 -134702.25 -134820.48  0.09%     -    0s
H    0     0                    -134710.3193 -134806.51  0.07%     -    0s
     0     0 -134788.96    0   14 -134710.32 -134788.96  0.06%     -    0s
     0     0 -134777.62    0    9 -134710.32 -134777.62  0.05%     -    0s
     0     0 -134776.04    0   12 -134710.32 -134776.04  0.05%     -    0s
     0     0 -134771.83    0    2 -134710.32 -134771.83  0.05%     -    0s
H    0     0                    -134771.7533 -134771.75  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 4
  MIR: 14
  Flow cover: 22
  RLT: 4
  Relax-and-lift: 4

Explored 1 nodes (1395 simplex iterations) in 0.21 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -134772 -134710 -134702 ... -116832
No other solutions better than -134772

Optimal solution found (tolerance 1.00e-04)
Best objective -1.347717533386e+05, best bound -1.347717533386e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 126156.97
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134771.75
  [DEBUG]   S×d_nominal = 260928.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260928.72 + -134771.75 = 126156.97
  [DEBUG]   Current θ from Master = 140574.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14417.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8098.80
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 3569.6237, Absolute Gap = 3569.6237, Relative Gap = 0.564970
  Not converged yet (gap = 3569.62 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265049 nonzeros
Model fingerprint: 0xb19c5e53
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37652 rows and 15292 columns
Presolve time: 1.96s
Presolved: 55471 rows, 24408 columns, 344819 nonzeros
Variable types: 22149 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315267.1831
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 55471 rows, 24408 columns, 344819 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22281   -1.1737819e+05   0.000000e+00   3.494200e+06      5s
   34150    8.7132138e+03   0.000000e+00   4.146733e+07     10s
   42189    1.5827819e+04   0.000000e+00   3.532518e+06     15s
   50064    2.1596619e+04   0.000000e+00   1.290061e+09     20s
   56996    2.3672747e+04   0.000000e+00   1.789271e+06     25s
   63875    2.5525269e+04   0.000000e+00   2.561079e+05     30s
Concurrent spin time: 2.68s

Solved with dual simplex

Root relaxation: objective 2.878164e+04, 45453 iterations, 31.75 seconds (43.55 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28781.6362    0  102 -191968.18 28781.6362   115%     -   34s
H    0     0                    -176005.3251 28781.6362   116%     -   34s
H    0     0                    -126280.5051 28781.6362   123%     -   34s
H    0     0                    -126089.2721 28781.6362   123%     -   34s
H    0     0                    -54227.84497 28781.6362   153%     -   34s
H    0     0                    -25148.21051 28781.6362   214%     -   34s
H    0     0                    -15294.65179 28781.6362   288%     -   35s
H    0     0                    -6381.758720 28781.6362   551%     -   35s
H    0     0                    -4787.052746 28781.6362   701%     -   35s
H    0     0                    -4418.006362 28781.6362   751%     -   35s
H    0     0                    -4323.486265 28781.6362   766%     -   35s
H    0     0                    1088.7338453 28781.6362  2544%     -   36s
H    0     0                    1350.6770542 28781.6362  2031%     -   36s
H    0     0                    1896.0305319 28781.6362  1418%     -   36s
H    0     0                    2023.1650486 28781.6362  1323%     -   36s
     0     0 25210.1763    0  244 2023.16505 25210.1763  1146%     -   47s
H    0     0                    2065.4043852 25210.1763  1121%     -   48s
H    0     0                    2128.7080050 25210.1763  1084%     -   48s
     0     0 25177.3668    0  241 2128.70800 25177.3668  1083%     -   52s
     0     0 25177.3668    0  239 2128.70800 25177.3668  1083%     -   53s
     0     0 25177.3668    0  240 2128.70800 25177.3668  1083%     -   53s
H    0     0                    2322.4253859 21646.3747   832%     -   65s
H    0     0                    2561.6480876 21646.3747   745%     -   65s
H    0     0                    2569.6470038 21646.3747   742%     -   65s
     0     0 21646.3747    0  293 2569.64700 21646.3747   742%     -   65s
     0     0 21058.8946    0  306 2569.64700 21058.8946   720%     -   69s
     0     0 20939.8791    0  315 2569.64700 20939.8791   715%     -   72s
     0     0 20584.7227    0  325 2569.64700 20584.7227   701%     -   76s
     0     0 20556.6589    0  327 2569.64700 20556.6589   700%     -   78s
     0     0 20520.5950    0  327 2569.64700 20520.5950   699%     -   79s
     0     0 20515.6690    0  325 2569.64700 20515.6690   698%     -   79s
     0     0 20511.7941    0  328 2569.64700 20511.7941   698%     -   80s
     0     0 20509.7283    0  334 2569.64700 20509.7283   698%     -   80s
     0     0 20509.2914    0  328 2569.64700 20509.2914   698%     -   81s
H    0     0                    2676.9224396 18529.9175   592%     -  100s
     0     0 18529.9175    0  366 2676.92244 18529.9175   592%     -  100s
H    0     0                    2722.5252350 18529.3887   581%     -  101s
H    0     0                    2907.2730575 18529.3887   537%     -  101s
H    0     0                    3010.0760691 18529.3887   516%     -  101s
H    0     0                    3021.5700435 18529.3887   513%     -  101s
     0     0 18129.6459    0  360 3021.57004 18129.6459   500%     -  111s
     0     0 17783.4235    0  370 3021.57004 17783.4235   489%     -  116s
     0     0 17646.8738    0  327 3021.57004 17646.8738   484%     -  120s
     0     0 17604.2769    0  371 3021.57004 17604.2769   483%     -  122s
     0     0 17459.4685    0  366 3021.57004 17459.4685   478%     -  125s
     0     0 17415.4099    0  371 3021.57004 17415.4099   476%     -  127s
     0     0 17374.5280    0  374 3021.57004 17374.5280   475%     -  129s
     0     0 17359.2235    0  379 3021.57004 17359.2235   475%     -  131s
     0     0 17344.8333    0  374 3021.57004 17344.8333   474%     -  133s
     0     0 17335.8347    0  376 3021.57004 17335.8347   474%     -  135s
     0     0 17331.4221    0  383 3021.57004 17331.4221   474%     -  136s
     0     0 17330.9671    0  385 3021.57004 17330.9671   474%     -  136s
H    0     0                    3467.0096671 16752.8148   383%     -  146s
     0     0 16752.8148    0  402 3467.00967 16752.8148   383%     -  146s
     0     0 16651.9866    0  415 3467.00967 16651.9866   380%     -  149s
     0     0 16603.6301    0  409 3467.00967 16603.6301   379%     -  152s
     0     0 16570.5725    0  415 3467.00967 16570.5725   378%     -  153s
     0     0 16563.1707    0  415 3467.00967 16563.1707   378%     -  154s
     0     0 16556.8369    0  407 3467.00967 16556.8369   378%     -  155s
     0     0 16554.5526    0  407 3467.00967 16554.5526   377%     -  155s
     0     0 16551.9437    0  405 3467.00967 16551.9437   377%     -  156s
     0     0 16550.0407    0  402 3467.00967 16550.0407   377%     -  156s
     0     0 16548.1784    0  403 3467.00967 16548.1784   377%     -  156s
     0     0 16547.7836    0  407 3467.00967 16547.7836   377%     -  156s
     0     0 16446.6237    0  399 3467.00967 16446.6237   374%     -  161s
     0     0 16434.9512    0  418 3467.00967 16434.9512   374%     -  162s
     0     0 16423.1317    0  416 3467.00967 16423.1317   374%     -  164s
     0     0 16421.8623    0  413 3467.00967 16421.8623   374%     -  165s
     0     0 16380.7151    0  417 3467.00967 16380.7151   372%     -  167s
     0     0 16373.3928    0  420 3467.00967 16373.3928   372%     -  172s
     0     0 16366.1403    0  428 3467.00967 16366.1403   372%     -  174s
     0     0 16363.4641    0  438 3467.00967 16363.4641   372%     -  174s
     0     0 16362.5023    0  435 3467.00967 16362.5023   372%     -  175s
     0     0 16339.1787    0  421 3467.00967 16339.1787   371%     -  178s
     0     0 16332.1277    0  416 3467.00967 16332.1277   371%     -  180s
     0     0 16327.5927    0  417 3467.00967 16327.5927   371%     -  181s
     0     0 16327.1580    0  417 3467.00967 16327.1580   371%     -  181s
     0     0 16317.9192    0  462 3467.00967 16317.9192   371%     -  183s
     0     0 16306.2343    0  475 3467.00967 16306.2343   370%     -  190s
     0     0 16303.2394    0  467 3467.00967 16303.2394   370%     -  190s
     0     0 16302.7486    0  512 3467.00967 16302.7486   370%     -  191s
     0     0 16261.0816    0  470 3467.00967 16261.0816   369%     -  193s
     0     0 16259.8203    0  428 3467.00967 16259.8203   369%     -  194s
     0     0 16250.3163    0  480 3467.00967 16250.3163   369%     -  196s
     0     0 16248.1299    0  475 3467.00967 16248.1299   369%     -  196s
     0     0 16248.0184    0  479 3467.00967 16248.0184   369%     -  196s
     0     0 16241.0178    0  475 3467.00967 16241.0178   368%     -  198s
     0     0 16232.5351    0  476 3467.00967 16232.5351   368%     -  199s
     0     0 16231.7294    0  469 3467.00967 16231.7294   368%     -  200s
     0     0 16227.3165    0  471 3467.00967 16227.3165   368%     -  201s
     0     0 16225.8201    0  471 3467.00967 16225.8201   368%     -  203s
     0     2 16225.8201    0  471 3467.00967 16225.8201   368%     -  236s
     1     4 16032.1440    1  392 3467.00967 16225.7036   368%  5636  241s
     3     8 15442.9541    2  489 3467.00967 16031.7949   362%  5346  249s
     7    16 15272.6972    3  502 3467.00967 15441.1003   345%  5294  256s
    15    32 15140.9639    4  514 3467.00967 15272.4259   341%  5770  264s
    31    49 9705.02378    5  226 3467.00967 15140.3971   337%  7487  417s
    48    81 14255.4696    6  402 3467.00967 15140.3971   337%  8956  443s
H   73    81                    4473.1970753 15140.3971   238%  7278  443s
    80   229 14211.3853    7  397 4473.19708 15140.3971   238%  6851  458s
   228   311 13816.2071   10  270 4473.19708 15140.3971   238%  3879  465s
H  241   311                    4525.6144893 15140.3971   235%  3758  465s
   310   371 13332.6351   10  232 4525.61449 15140.3971   235%  3338  475s
   388   420 13700.8425   10  383 4525.61449 15140.3971   235%  3026  485s
   449   473 13198.6319   10  306 4525.61449 15140.3971   235%  2844  496s
   520   512 13497.6124    8  360 4525.61449 15140.3971   235%  2721  506s
   583   545 13729.9310   11  256 4525.61449 15140.3971   235%  2656  514s
   618   587 13649.1081   11  264 4525.61449 15140.3971   235%  2676  524s
   664   627 13182.0256   11  230 4525.61449 15140.3971   235%  2641  533s
   705   686 13185.1051   11  240 4525.61449 15140.3971   235%  2653  539s
   770   743 13641.4393   11  385 4525.61449 15140.3971   235%  2556  546s
   841   791 13543.4679   11  384 4525.61449 15140.3971   235%  2459  554s
   911   819 13613.2482   12  366 4525.61449 14948.7798   230%  2384  565s
   968   849 12716.1617   12  270 4525.61449 14948.3107   230%  2366  572s
  1013   867 12172.7121   12  245 4525.61449 14948.3107   230%  2374  583s
  1077   890 11646.4751   12  284 4525.61449 14948.3107   230%  2383  594s
H 1107   890                    4548.3834611 14948.3107   229%  2394  594s
  1131   920 12192.7489   12  256 4548.38346 14948.3107   229%  2403  606s
  1195   950 11582.4761   12  227 4548.38346 14738.7432   224%  2427  618s
  1251   993 11924.7383   13  225 4548.38346 14738.7432   224%  2493  630s
  1320  1024 7398.35297   12  366 4548.38346 14738.7432   224%  2522  642s
  1375  1072 12393.2876   13  269 4548.38346 14738.7432   224%  2535  654s
  1459  1129 11509.7191   14  228 4548.38346 14738.7432   224%  2523  668s
  1548  1201     cutoff   16      4548.38346 14738.7432   224%  2493  683s
  1662  1272 7304.47901   15  294 4548.38346 14738.7432   224%  2451  697s
  1795  1359 5250.13626   15  191 4548.38346 14738.7432   224%  2401  711s
  1914  1382 7084.86075   16  234 4548.38346 14738.7432   224%  2395  719s
  1953  1409 6946.60445   17  232 4548.38346 14738.7432   224%  2397  732s
  2002  1445 6694.13868   18  268 4548.38346 14108.3847   210%  2393  739s
  2060  1482 6617.10160   19  265 4548.38346 14108.3847   210%  2374  753s
  2137  1552 6537.53031   20  267 4548.38346 14029.8391   208%  2357  764s
  2251  1605 6503.26245   21  316 4548.38346 14029.8391   208%  2320  777s
  2372  1691 5939.71641   23  248 4548.38346 13989.9801   208%  2300  792s
  2524  1713 5555.15892   25  360 4548.38346 13989.9801   208%  2277  804s
  2566  1735     cutoff   24      4548.38346 13966.3210   207%  2288  819s
  2613  1764 5665.89602   25  249 4548.38346 13966.3210   207%  2299  835s
  2666  1799 5422.01147   26  250 4548.38346 13966.3210   207%  2306  848s
  2723  1839 5044.78561   26  296 4548.38346 13966.3210   207%  2304  860s
  2827  1887     cutoff   25      4548.38346 13966.3210   207%  2269  879s
  2950  1945 5126.33665   28  302 4548.38346 13795.8611   203%  2241  895s
  3058  2043     cutoff   27      4548.38346 13767.9134   203%  2244  915s
  3192  2143     cutoff   30      4548.38346 13767.9134   203%  2236  931s
  3400  2250 12190.6292    8  261 4548.38346 13645.4673   200%  2203  950s
  3575  2371 10120.2584   11  205 4548.38346 13645.4673   200%  2201  969s
  3781  2489 8042.95442   12  249 4548.38346 13639.5888   200%  2193  991s
  4021  2660 9669.23365   13  221 4548.38346 13610.4984   199%  2179 1013s
  4281  2661 6629.63298   30  471 4548.38346 13525.3052   197%  2157 1069s
  4283  2662 6117.46044   31  102 4548.38346 13525.3052   197%  2156 1098s
  4284  2663 5624.53767   26  267 4548.38346 13525.3052   197%  2156 1117s
  4285  2664 5172.41146   29  314 4548.38346 13525.3052   197%  2155 1137s
  4286  2664 8555.57775   28  470 4548.38346 13525.3052   197%  2155 1151s
  4287  2665 10217.1671   13  405 4548.38346 13525.3052   197%  2154 1160s
  4288  2666 12273.4976    7  412 4548.38346 13525.3052   197%  2154 1170s
  4289  2666 8135.86340   20  442 4548.38346 13525.3052   197%  2153 1177s
  4290  2667 5105.42780   44  405 4548.38346 13525.3052   197%  2153 1181s
  4291  2668 10913.6822   18  412 4548.38346 13525.3052   197%  2152 1186s
  4293  2669 12862.7902    9  408 4548.38346 13525.3052   197%  2151 1192s
  4294  2670 5877.98861   34  405 4548.38346 13525.3052   197%  2151 1195s
  4296  2671 6730.40301   14  419 4548.38346 13525.3052   197%  2150 1201s
  4298  2672 10244.3323   13  469 4548.38346 13525.3052   197%  2149 1211s
  4300  2674 6949.13053   24  483 4548.38346 13525.3052   197%  2148 1217s
  4301  2674 8430.85848   25  426 4548.38346 13525.3052   197%  2147 1223s
  4302  2675 8542.46072   22  520 4548.38346 13525.3052   197%  2147 1225s
  4304  2676 8044.58264   16  494 4548.38346 13525.3052   197%  2146 1231s
  4305  2677 9025.62398   11  532 4548.38346 13525.3052   197%  2145 1236s
  4307  2678 10939.9430   16  499 4548.38346 13525.3052   197%  2144 1244s
  4308  2679 4928.37071   32  449 4548.38346 13525.3052   197%  2144 1246s
  4309  2680 13454.0503   11  460 4548.38346 13525.3052   197%  2143 1252s
  4310  2680 6541.11902   38  429 4548.38346 13525.3052   197%  2143 1255s
  4311  2681 7437.90511   27  489 4548.38346 13525.3052   197%  2142 1260s
  4313  2682 12282.6267   14  481 4548.38346 13525.3052   197%  2141 1269s
  4314  2683 11734.0490   11  451 4548.38346 13525.3052   197%  2141 1272s
  4315  2684 13499.4246   11  440 4548.38346 13525.3052   197%  2140 1276s
  4316  2684 8921.96581   19  440 4548.38346 13525.3052   197%  2140 1305s
  4317  2685 9165.04654   44  440 4548.38346 13525.3052   197%  2139 1338s
  4318  2689 13525.3052   11  369 4548.38346 13525.3052   197%  2184 1356s
  4320  2692 13525.3052   12  362 4548.38346 13525.3052   197%  2185 1372s
  4324  2699 13525.3052   13  355 4548.38346 13525.3052   197%  2189 1384s
  4332  2712 13525.3052   14  359 4548.38346 13525.3052   197%  2196 1400s
  4348  2724 6358.91658   15  215 4548.38346 13525.3052   197%  2215 1430s
  4365  2750 13363.3303   16  339 4548.38346 13525.3052   197%  2256 1455s
  4397  2768 12822.9653   17  320 4548.38346 13525.3052   197%  2269 1472s
  4432  2789 11252.5006   18  305 4548.38346 13525.3052   197%  2338 1492s
  4476  2819 11551.4112   18  305 4548.38346 13525.3052   197%  2368 1515s
  4541  2850 10827.9372   19  294 4548.38346 13525.3052   197%  2387 1533s
  4628  2849 8366.81069   19  241 4548.38346 13525.3052   197%  2403 1552s
  4721  2832 9731.64172   20  250 4548.38346 13525.3052   197%  2413 1568s
  4764  2836 7679.38294   20  295 4548.38346 13525.3052   197%  2425 1586s
  4809  2845 7469.25694   20  214 4548.38346 13525.3052   197%  2432 1601s
  4863  2840 7230.52325   20  241 4548.38346 13525.3052   197%  2436 1618s
  4919  2846 5027.50796   21  226 4548.38346 13525.3052   197%  2439 1635s
  4975  2853     cutoff   21      4548.38346 13525.3052   197%  2442 1650s
  5037  2849     cutoff   19      4548.38346 13371.6012   194%  2448 1665s
  5101  2860 11291.9624   16  369 4548.38346 13371.6012   194%  2455 1677s
  5160  2872 10781.3900   16  333 4548.38346 13371.6012   194%  2462 1690s
  5221  2877 10710.7881   17  302 4548.38346 13371.6012   194%  2467 1708s
  5282  2885 9113.51163   17  359 4548.38346 13371.6012   194%  2473 1720s
  5349  2894 10340.4100   18  360 4548.38346 13341.1765   193%  2471 1741s
  5430  2909 7849.91752   18  366 4548.38346 12701.2816   179%  2472 1757s
  5516  2913 10241.7563   19  387 4548.38346 12530.3306   175%  2478 1773s
  5608  2935 9982.22627   20  409 4548.38346 12530.3306   175%  2481 1792s
  5714  2943 7647.65132   20  268 4548.38346 12516.8052   175%  2478 1807s
  5829  2946 9125.54230   21  375 4548.38346 12516.8052   175%  2477 1824s
  5936  2955 8591.55800   22  289 4548.38346 12516.8052   175%  2479 1842s
  6033  2959 7726.63127   23  251 4548.38346 12431.6319   173%  2493 1861s
  6164  2949     cutoff   24      4548.38346 12319.7005   171%  2490 1881s
  6298  2945 5101.85825   29   16 4548.38346 11729.3838   158%  2493 1902s
  6429  2937 7113.88915   19  309 4548.38346 11616.0252   155%  2499 1929s
  6587  2929 5694.87524   23  153 4548.38346 11273.4697   148%  2497 1950s
  6729  2917 8658.86039   19  300 4548.38346 11176.0127   146%  2504 1974s
  6882  2918 7183.71504   22  149 4548.38346 11176.0127   146%  2508 1997s
  7049  2909 4565.15605   25  229 4548.38346 10918.5134   140%  2505 2018s
  7228  2856 4590.04241   27  224 4548.38346 10918.5134   140%  2501 2044s
  7438  2811 8150.76192   20  246 4548.38346 10781.1602   137%  2492 2069s
  7620  2792     cutoff   23      4548.38346 10369.8105   128%  2495 2094s
  7791  2791     cutoff   24      4548.38346 10318.1511   127%  2501 2122s
  8031  2766 5625.45090   23  187 4548.38346 10318.1511   127%  2489 2151s
  8268  2713     cutoff   24      4548.38346 10090.2552   122%  2485 2178s
  8512  2644 6314.27041   24  244 4548.38346 9811.67609   116%  2478 2207s
  8814  2559     cutoff   23      4548.38346 9719.74592   114%  2459 2237s
  9065  2488     cutoff   23      4548.38346 9453.95253   108%  2446 2268s
  9368  2414 5295.19355   23  245 4548.38346 9391.59452   106%  2438 2300s
  9694  2351 5039.44146   24  381 4548.38346 9283.88216   104%  2429 2332s
 10007  2228     cutoff   27      4548.38346 9214.20787   103%  2422 2365s
 10337  2112 7092.17766   22  372 4548.38346 8940.53026  96.6%  2420 2400s
 10733  1998 5676.71384   18  360 4548.38346 8715.63038  91.6%  2406 2435s
 11173  1871 6023.98537   22  313 4548.38346 8550.73328  88.0%  2387 2471s
 11584  1693 4999.52508   25  157 4548.38346 8451.09550  85.8%  2379 2510s
 12064  1524 4898.11282   27  192 4548.38346 8102.22879  78.1%  2361 2550s
 12508  1402 6274.54442   25  257 4548.38346 7980.16501  75.5%  2351 2587s
 12997  1356     cutoff   30      4548.38346 7802.42683  71.5%  2329 2631s
 13542  1276     cutoff   29      4548.38346 7699.70467  69.3%  2305 2671s
 14085  1230 infeasible   25      4548.38346 7263.10765  59.7%  2288 2710s
 14208  1135 6263.56042   27  272 4548.38346 7263.10765  59.7%  2284 2753s
 14714   846     cutoff   26      4548.38346 7105.80495  56.2%  2260 2800s
 15589   294     cutoff   27      4548.38346 6645.80157  46.1%  2209 2847s
 16759     0     cutoff   26      4548.38346 6149.04724  35.2%  2121 2873s

Cutting planes:
  Learned: 1
  MIR: 525
  Mixing: 3
  Flow cover: 1194
  RLT: 14
  Relax-and-lift: 76

Explored 17232 nodes (36080555 simplex iterations) in 2873.59 seconds (5349.85 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 4548.38 4525.61 4473.2 ... 2569.65

Optimal solution found (tolerance 1.00e-04)
Best objective 4.548383461093e+03, best bound 4.548383461093e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2873.60s
  Master Objective (UB) = 4548.38, θ = 146447.92
  Upper Bound (UB) = 4548.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146447.92
  [DEBUG]   ✓ Scenario 0: θ = 146447.92 ≤ Q = 146447.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146447.92 ≤ Q = 146447.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146447.92 ≤ Q = 146447.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146447.92 ≤ Q = 146447.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146447.92 ≤ Q = 146447.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146447.92 ≤ Q = 146447.92 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x648f7f3e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x648f7f3e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.319790e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6966123.7482
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.579769e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157976.92    0  126 6966123.75 -157976.92   102%     -    0s
H    0     0                    -119321.1852 -157976.92  32.4%     -    0s
H    0     0                    -119831.2949 -157976.92  31.8%     -    0s
     0     0 -135485.03    0   78 -119831.29 -135485.03  13.1%     -    0s
H    0     0                    -132553.6111 -135359.92  2.12%     -    0s
H    0     0                    -132842.7260 -135359.92  1.89%     -    0s
H    0     0                    -133312.2439 -135359.92  1.54%     -    0s
H    0     0                    -133601.3588 -135359.92  1.32%     -    0s
     0     0 -134341.95    0   64 -133601.36 -134341.95  0.55%     -    0s
     0     0 -134284.66    0   59 -133601.36 -134284.66  0.51%     -    0s
     0     0 -134071.70    0   28 -133601.36 -134071.70  0.35%     -    0s
     0     0 -133976.46    0   35 -133601.36 -133976.46  0.28%     -    0s
     0     0 -133974.64    0   31 -133601.36 -133974.64  0.28%     -    0s
H    0     0                    -133638.3934 -133780.21  0.11%     -    0s
     0     0 -133780.21    0   11 -133638.39 -133780.21  0.11%     -    0s
     0     0 -133772.54    0   12 -133638.39 -133772.54  0.10%     -    0s
     0     0 -133687.14    0    4 -133638.39 -133687.14  0.04%     -    0s
     0     0 -133667.50    0    8 -133638.39 -133667.50  0.02%     -    0s
     0     0          -    0      -133638.39 -133649.93  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 1
  Flow cover: 4
  Relax-and-lift: 5

Explored 1 nodes (767 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -133638 -133601 -133504 ... 1.31979e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.336383934225e+05, best bound -1.336499271340e+05, gap 0.0086%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 135623.01
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133638.39
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -133638.39 = 135623.01
  [DEBUG]   Current θ from Master = 146447.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10824.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6276.53
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 1799.7564, Absolute Gap = 1799.7564, Relative Gap = 0.395691
  Not converged yet (gap = 1799.76 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308304 nonzeros
Model fingerprint: 0x22b48446
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43934 rows and 17844 columns
Presolve time: 1.97s
Presolved: 64479 rows, 28096 columns, 401349 nonzeros
Variable types: 25837 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315267.1831
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 64479 rows, 28096 columns, 401349 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30179   -1.1648442e+05   0.000000e+00   6.036322e+08      5s
   43961   -1.6168226e+04   0.000000e+00   1.997699e+08     10s
   52788    3.9997950e+02   0.000000e+00   5.100352e+06     15s
   61110    1.1666144e+04   0.000000e+00   1.697685e+07     20s
   67280    1.6740152e+04   0.000000e+00   1.269563e+06     25s
Concurrent spin time: 1.89s

Solved with dual simplex

Root relaxation: objective 2.878164e+04, 45824 iterations, 26.64 seconds (37.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28781.6362    0  102 -191968.18 28781.6362   115%     -   29s
H    0     0                    -180806.2338 28781.6362   116%     -   29s
H    0     0                    -111850.1997 28781.6362   126%     -   29s
H    0     0                    -110832.8015 28781.6362   126%     -   29s
H    0     0                    -54227.84497 28781.6362   153%     -   29s
H    0     0                    -44693.99718 28781.6362   164%     -   30s
H    0     0                    -4787.052746 28781.6362   701%     -   30s
H    0     0                    -4626.377749 28781.6362   722%     -   30s
H    0     0                    -4553.175761 28781.6362   732%     -   30s
H    0     0                    -4418.006362 28781.6362   751%     -   30s
H    0     0                    -4408.800141 28781.6362   753%     -   30s
H    0     0                    -4323.486265 28781.6362   766%     -   30s
H    0     0                    -4262.859821 26036.1487   711%     -   43s
     0     0 26036.1487    0  260 -4262.8598 26036.1487   711%     -   44s
     0     0 25347.3403    0  261 -4262.8598 25347.3403   695%     -   49s
     0     0 25088.6422    0  257 -4262.8598 25088.6422   689%     -   52s
     0     0 25088.6422    0  234 -4262.8598 25088.6422   689%     -   55s
     0     0 25088.6422    0  234 -4262.8598 25088.6422   689%     -   55s
     0     0 25088.6422    0  237 -4262.8598 25088.6422   689%     -   55s
     0     0 25088.6422    0  237 -4262.8598 25088.6422   689%     -   55s
     0     0 21743.8984    0  305 -4262.8598 21743.8984   610%     -   73s
H    0     0                    1040.7989949 21743.5409  1989%     -   73s
     0     0 21273.5788    0  288 1040.79899 21273.5788  1944%     -   82s
     0     0 21183.0505    0  327 1040.79899 21183.0505  1935%     -   85s
     0     0 21111.5227    0  306 1040.79899 21111.5227  1928%     -   88s
     0     0 20758.5631    0  332 1040.79899 20758.5631  1894%     -   94s
     0     0 20700.2013    0  321 1040.79899 20700.2013  1889%     -   96s
     0     0 20677.6836    0  337 1040.79899 20677.6836  1887%     -   99s
     0     0 20674.3013    0  337 1040.79899 20674.3013  1886%     -  100s
     0     0 20673.2963    0  338 1040.79899 20673.2963  1886%     -  101s
     0     0 20636.0982    0  339 1040.79899 20636.0982  1883%     -  102s
     0     0 20627.0861    0  345 1040.79899 20627.0861  1882%     -  103s
     0     0 20626.1728    0  346 1040.79899 20626.1728  1882%     -  103s
     0     0 20626.1656    0  348 1040.79899 20626.1656  1882%     -  103s
H    0     0                    2112.4813799 20626.1656   876%     -  111s
H    0     0                    2128.7080050 20626.1656   869%     -  111s
     0     0 18492.5140    0  370 2128.70800 18492.5140   769%     -  127s
     0     0 17820.2592    0  380 2128.70800 17820.2592   737%     -  139s
     0     0 17591.6766    0  372 2128.70800 17591.6766   726%     -  144s
     0     0 17503.8313    0  390 2128.70800 17503.8313   722%     -  147s
     0     0 17478.3397    0  398 2128.70800 17478.3397   721%     -  149s
     0     0 17462.2770    0  389 2128.70800 17462.2770   720%     -  150s
     0     0 17456.2132    0  399 2128.70800 17456.2132   720%     -  151s
     0     0 17450.6083    0  395 2128.70800 17450.6083   720%     -  151s
     0     0 17449.0846    0  399 2128.70800 17449.0846   720%     -  152s
     0     0 17445.7903    0  391 2128.70800 17445.7903   720%     -  153s
     0     0 17445.1897    0  391 2128.70800 17445.1897   720%     -  153s
     0     0 16864.1417    0  433 2128.70800 16864.1417   692%     -  167s
     0     0 16627.0513    0  402 2128.70800 16627.0513   681%     -  173s
     0     0 16580.1377    0  418 2128.70800 16580.1377   679%     -  175s
     0     0 16556.0449    0  415 2128.70800 16556.0449   678%     -  177s
     0     0 16544.6802    0  425 2128.70800 16544.6802   677%     -  178s
     0     0 16536.9469    0  416 2128.70800 16536.9469   677%     -  179s
     0     0 16535.0041    0  416 2128.70800 16535.0041   677%     -  179s
     0     0 16534.5050    0  423 2128.70800 16534.5050   677%     -  180s
     0     0 16393.4432    0  421 2128.70800 16393.4432   670%     -  186s
     0     0 16355.0361    0  422 2128.70800 16355.0361   668%     -  189s
     0     0 16333.3133    0  480 2128.70800 16333.3133   667%     -  191s
     0     0 16330.7079    0  478 2128.70800 16330.7079   667%     -  191s
     0     0 16329.1292    0  489 2128.70800 16329.1292   667%     -  191s
     0     0 16328.1515    0  441 2128.70800 16328.1515   667%     -  192s
     0     0 16295.0008    0  410 2128.70800 16295.0008   665%     -  195s
H    0     0                    2199.5014341 16292.5589   641%     -  198s
H    0     0                    2237.4494233 16292.5589   628%     -  199s
H    0     0                    2539.0854423 16292.5589   542%     -  199s
H    0     0                    2595.2231037 16292.5589   528%     -  199s
     0     0 16275.8950    0  420 2595.22310 16275.8950   527%     -  200s
     0     0 16269.1313    0  423 2595.22310 16269.1313   527%     -  202s
     0     0 16266.6121    0  483 2595.22310 16266.6121   527%     -  203s
     0     0 16266.5325    0  483 2595.22310 16266.5325   527%     -  203s
     0     0 16257.8017    0  494 2595.22310 16257.8017   526%     -  205s
H    0     0                    2629.5788487 16257.3764   518%     -  206s
H    0     0                    2630.0905907 16257.3764   518%     -  206s
H    0     0                    2637.3436036 16257.3764   516%     -  206s
H    0     0                    2677.4475677 16257.3764   507%     -  206s
     0     0 16253.9380    0  489 2677.44757 16253.9380   507%     -  207s
     0     0 16252.3998    0  497 2677.44757 16252.3998   507%     -  207s
     0     0 16251.6979    0  498 2677.44757 16251.6979   507%     -  207s
     0     0 16246.8268    0  433 2677.44757 16246.8268   507%     -  209s
     0     0 16245.1670    0  489 2677.44757 16245.1670   507%     -  211s
     0     0 16244.3475    0  497 2677.44757 16244.3475   507%     -  212s
     0     0 16240.7944    0  496 2677.44757 16240.7944   507%     -  214s
H    0     0                    2840.5895380 16240.2568   472%     -  214s
H    0     0                    2955.4170317 16240.2568   450%     -  214s
     0     0 16240.2568    0  502 2955.41703 16240.2568   450%     -  214s
     0     0 16237.8807    0  494 2955.41703 16237.8807   449%     -  216s
     0     0 16236.5910    0  508 2955.41703 16236.5910   449%     -  221s
     0     0 16234.1255    0  505 2955.41703 16234.1255   449%     -  223s
     0     0 16232.9311    0  505 2955.41703 16232.9311   449%     -  225s
     0     2 16232.9311    0  505 2955.41703 16232.9311   449%     -  260s
     1     4 16049.5488    1  466 2955.41703 16232.9311   449%  4110  268s
     3     8 15765.3477    2  456 2955.41703 16049.2444   443%  5856  277s
     7    16 15685.1437    3  431 2955.41703 15763.8559   433%  6188  291s
    15    32 15216.8501    4  415 2955.41703 15683.5132   431%  7145  301s
    31    49 10644.9356    5  238 2955.41703 15216.8020   415%  9353  327s
    48    81 13542.6411    6  303 2955.41703 15216.8020   415% 10589  353s
    80   227 13462.5123    7  290 2955.41703 15216.8020   415%  8347  376s
   226   258 12709.6169   11  252 2955.41703 15216.8020   415%  4860  385s
H  231   258                    2969.6813081 15216.8020   412%  4778  385s
H  235   258                    3164.7065626 15216.8020   381%  4752  385s
   259   347 13241.3662   10  342 3164.70656 15216.8020   381%  4455  394s
   354   377 13429.2403    9  278 3164.70656 15216.8020   381%  3794  405s
   386   405 13192.5044   12  281 3164.70656 15216.8020   381%  3674  416s
   425   438 13222.4609   12  274 3164.70656 15216.8020   381%  3501  427s
   466   474 13118.9893   11  337 3164.70656 15216.8020   381%  3376  437s
   510   514 12574.2539   12  325 3164.70656 15216.8020   381%  3258  449s
   556   547 12501.1891   12  289 3164.70656 15216.8020   381%  3104  460s
   601   570 12442.9286   11  260 3164.70656 15216.8020   381%  3017  471s
   652   586 12813.7102   13  281 3164.70656 15216.8020   381%  2892  484s
   698   611 12860.9157   13  274 3164.70656 15216.8020   381%  2897  493s
   739   628 12767.3506   13  252 3164.70656 15216.8020   381%  2923  505s
   782   657 12779.6729   13  307 3164.70656 15216.8020   381%  2902  517s
   815   686 11620.7060   13  234 3164.70656 15216.8020   381%  2922  528s
   856   722 11737.9115   13  331 3164.70656 15216.8020   381%  2928  541s
   908   755 11831.8980   13  376 3164.70656 15216.8020   381%  2900  553s
   945   792 10855.7129   13  236 3164.70656 15216.8020   381%  2902  562s
   996   823 12532.0651   14  257 3164.70656 15216.8020   381%  2891  573s
  1034   856 12712.5225   14  281 3164.70656 15216.8020   381%  2917  584s
  1077   882 12677.7306   14  283 3164.70656 15216.8020   381%  2912  597s
  1131   935 11648.5777   14  242 3164.70656 15216.8020   381%  2902  611s
  1212  1012 11751.3752   15  318 3164.70656 15216.8020   381%  2860  626s
  1303  1044 11916.5173   15  328 3164.70656 15216.8020   381%  2799  640s
  1429  1087 5526.56823   15  248 3164.70656 15216.8020   381%  2705  655s
  1520  1129 6514.76981   15  222 3164.70656 15216.8020   381%  2678  670s
  1602  1165 11691.5307   16  371 3164.70656 15216.8020   381%  2698  687s
  1702  1230 11417.0967   16  376 3164.70656 15216.8020   381%  2670  702s
  1813  1267 10642.0142   16  282 3164.70656 15216.8020   381%  2649  718s
  1928  1327 10301.1560   16  280 3164.70656 14783.6862   367%  2639  735s
  2030  1356 9839.92683   17  350 3164.70656 14782.6271   367%  2654  747s
  2065  1387 10582.5182   17  292 3164.70656 14782.6271   367%  2665  757s
  2098  1416 10127.3135   18  388 3164.70656 14782.6271   367%  2663  769s
  2133  1442 9414.48626   17  362 3164.70656 14782.6271   367%  2672  785s
  2171  1477 9855.45207   19  349 3164.70656 14244.2094   350%  2683  801s
H 2179  1477                    3733.8922596 14244.2094   281%  2681  801s
  2218  1606 7878.85833   19  223 3733.89226 14197.8245   280%  2677  821s
  2429  1707 8807.60057   21  229 3733.89226 14197.8245   280%  2600  842s
  2665  1762 7405.29136   23  250 3733.89226 14197.8245   280%  2509  863s
  2826  1821 7069.69638   24  239 3733.89226 13605.0090   264%  2512  885s
  2963  1911 6584.84774   28  132 3733.89226 13605.0090   264%  2531  908s
  3109  2042 5734.98645   33  126 3733.89226 13402.0989   259%  2555  933s
  3315  2160 4270.18769   36  176 3733.89226 13402.0989   259%  2534  957s
  3537  2265 10395.1859   12  239 3733.89226 13122.0371   251%  2492  982s
  3764  2385 7074.22520   17  336 3733.89226 13122.0371   251%  2464 1008s
  3982  2453 4616.99482   22  208 3733.89226 13122.0371   251%  2456 1033s
  4195  2536 4618.18646   12  161 3733.89226 12966.3956   247%  2459 1063s
  4400  2626 8187.99542   16  189 3733.89226 12966.3956   247%  2474 1089s
  4638  2741 infeasible   20      3733.89226 12938.8256   247%  2475 1121s
  4930  2742 6724.43635   29  505 3733.89226 12861.5775   244%  2455 1189s
H 4931  2605                    3837.7813381 12861.5775   235%  2454 1223s
  4933  2606 7754.94486   35  321 3837.78134 12861.5775   235%  2453 1243s
  4934  2607 10604.3121   20  347 3837.78134 12861.5775   235%  2453 1262s
  4935  2607 5917.50377   34  456 3837.78134 12861.5775   235%  2452 1281s
  4936  2608 11055.3403    7  425 3837.78134 12861.5775   235%  2452 1293s
  4937  2609 11059.3358   14  412 3837.78134 12861.5775   235%  2451 1301s
  4938  2609 11894.0688   12  416 3837.78134 12861.5775   235%  2451 1307s
  4939  2610 7553.59521   15  525 3837.78134 12861.5775   235%  2450 1311s
  4941  2611 5957.70750   11  458 3837.78134 12861.5775   235%  2449 1315s
  4943  2613 5643.89491   23  427 3837.78134 12861.5775   235%  2448 1325s
  4945  2614 11049.5994   11  420 3837.78134 12861.5775   235%  2447 1334s
  4946  2615 6199.51499   23  422 3837.78134 12861.5775   235%  2447 1338s
H 4946  2484                    4337.2617782 12861.5775   197%  2447 1346s
  4948  2485 5917.50377   34  487 4337.26178 12861.5775   197%  2446 1350s
  4949  2486 11058.9145   14  496 4337.26178 12861.5775   197%  2445 1357s
  4950  2486 6945.40939   15  485 4337.26178 12861.5775   197%  2445 1361s
H 4950  2362                    4347.2168888 12861.5775   196%  2445 1369s
  4952  2364 11382.4235   12  496 4347.21689 12861.5775   196%  2444 1373s
  4953  2364 10432.4060   11  536 4347.21689 12861.5775   196%  2443 1380s
  4955  2366 7301.71054   28  481 4347.21689 12861.5775   196%  2442 1390s
  4956  2366 7332.85069   10  481 4347.21689 12861.5775   196%  2442 1426s
H 4956  2247                    4487.6665000 12861.5775   187%  2442 1439s
  4957  2248 11888.9786    9  481 4487.66650 12861.5775   187%  2441 1452s
  4958  2252 12861.5775   12  463 4487.66650 12861.5775   187%  2479 1490s
  4960  2255 12861.5775   13  454 4487.66650 12861.5775   187%  2481 1501s
  4964  2262 12861.5775   14  516 4487.66650 12861.5775   187%  2486 1515s
  4972  2275 12861.5775   15  501 4487.66650 12861.5775   187%  2490 1536s
  4988  2286 12861.5775   16  452 4487.66650 12861.5775   187%  2523 1568s
  5004  2310 12861.5775   17  377 4487.66650 12861.5775   187%  2556 1592s
  5036  2372 12861.5775   18  259 4487.66650 12861.5775   187%  2590 1617s
  5131  2367 11642.8129   20  333 4487.66650 12861.5775   187%  2675 1636s
  5197  2392 6721.49280   20  195 4487.66650 12861.5775   187%  2687 1656s
  5262  2416 10431.6620   21  224 4487.66650 12861.5775   187%  2702 1673s
  5339  2429 10715.2919   19  229 4487.66650 12861.5775   187%  2707 1688s
  5415  2423 9994.98891   21  321 4487.66650 12861.5775   187%  2710 1703s
  5491  2408 9853.07305   22  208 4487.66650 12861.5775   187%  2703 1720s
  5565  2390 8934.13020   24  198 4487.66650 12861.5775   187%  2697 1735s
  5633  2381 8558.97982   25  263 4487.66650 12861.5775   187%  2693 1755s
  5700  2386 5323.42908   26  219 4487.66650 12861.5775   187%  2695 1770s
  5752  2401 5147.72619   27  214 4487.66650 12861.5775   187%  2704 1787s
  5812  2405 4912.35835   29  222 4487.66650 12861.5775   187%  2712 1809s
  5888  2416     cutoff   30      4487.66650 12861.5775   187%  2718 1822s
  5954  2405     cutoff   30      4487.66650 12861.5775   187%  2727 1837s
  6000  2402 infeasible   23      4487.66650 12861.5775   187%  2730 1853s
  6048  2409 12725.2094   18  386 4487.66650 12861.5775   187%  2733 1865s
  6085  2422 11746.8738   19  504 4487.66650 12861.5775   187%  2736 1884s
  6135  2424 11284.1142   20  498 4487.66650 12861.5775   187%  2738 1904s
  6192  2415 11151.3734   21  390 4487.66650 12861.5775   187%  2739 1921s
  6253  2413 10972.8425   22  284 4487.66650 12861.5775   187%  2740 1938s
  6324  2413 9340.95066   23  261 4487.66650 12861.5775   187%  2745 1955s
  6389  2443 5715.34160   24  189 4487.66650 12861.5775   187%  2753 1973s
  6465  2429     cutoff   25      4487.66650 12806.2052   185%  2757 1992s
  6568  2418     cutoff   24      4487.66650 12773.3036   185%  2759 2012s
  6689  2427 10943.5044   21  429 4487.66650 12278.1317   174%  2760 2032s
  6780  2464 10785.7994   22  385 4487.66650 12278.1317   174%  2775 2052s
  6889  2470 9517.62261   24  377 4487.66650 12278.1317   174%  2783 2069s
  6964  2482 8492.30634   26  343 4487.66650 12173.6219   171%  2790 2088s
  7063  2473 8135.77801   27  275 4487.66650 12115.8490   170%  2789 2110s
  7198  2470 6136.06923   29  246 4487.66650 11808.0609   163%  2785 2134s
  7336  2470     cutoff   31      4487.66650 11644.8801   159%  2792 2157s
  7496  2481 7377.92853   22  216 4487.66650 11419.1845   154%  2797 2184s
  7642  2483 4932.44530   24  299 4487.66650 11118.1687   148%  2803 2209s
  7818  2439 8247.47313   22  320 4487.66650 11118.1687   148%  2800 2235s
  7865  2449 8143.38493   23  334 4487.66650 11098.0875   147%  2806 2274s
  7912  2444 7736.32923   24  385 4487.66650 11098.0875   147%  2811 2293s
  7978  2433 7110.06045   25  296 4487.66650 11098.0875   147%  2809 2318s
  8036  2427 6602.15068   26  263 4487.66650 11098.0875   147%  2813 2342s
  8112  2422 6598.43699   27  301 4487.66650 11098.0875   147%  2813 2367s
  8178  2429 6410.63000   28  260 4487.66650 11098.0875   147%  2816 2394s
  8246  2424 6384.38080   29  260 4487.66650 10693.6947   138%  2820 2421s
  8317  2428 6144.75426   30  248 4487.66650 10693.6947   138%  2823 2451s
  8408  2427 5888.28078   31  217 4487.66650 10693.6947   138%  2818 2479s
  8502  2421 5048.30823   32  205 4487.66650 10693.6947   138%  2819 2514s
  8598  2421 4998.01508   33  203 4487.66650 10693.6947   138%  2822 2547s
  8686  2410     cutoff   34      4487.66650 10693.6947   138%  2828 2586s
  8834  2403 7471.75514   23  176 4487.66650 10693.6947   138%  2824 2623s
  8988  2359     cutoff   24      4487.66650 10326.0782   130%  2822 2662s
  9191  2319 5250.10500   26  211 4487.66650 10326.0782   130%  2814 2700s
  9427  2293 5808.07081   22  253 4487.66650 10126.0711   126%  2827 2744s
  9732  2241 6859.86982   24  317 4487.66650 10126.0711   126%  2832 2787s
 10050  2198 7048.64499   24  377 4487.66650 9737.44925   117%  2836 2835s
 10422  2145 4723.35482   31  244 4487.66650 9619.71675   114%  2831 2879s
 10780  2037 5979.61624   22  293 4487.66650 9473.46225   111%  2835 2929s
 11254  1931 7053.64905   25  419 4487.66650 9393.01948   109%  2823 2983s
 11643  1833 5620.06958   23  306 4487.66650 9111.63456   103%  2827 3029s
 12011  1851 6140.33889   25  354 4487.66650 9006.04662   101%  2828 3077s
 12357  1838 7366.49536   21  168 4487.66650 8901.28538  98.3%  2826 3129s
 12831  1811 4610.83180   23  202 4487.66650 8768.51987  95.4%  2823 3187s
 13365  1824 6104.39214   21  268 4487.66650 8505.63292  89.5%  2814 3246s
 13856  1851 5804.59723   25  259 4487.66650 8259.58143  84.1%  2817 3304s
 14446  1819     cutoff   24      4487.66650 8055.51160  79.5%  2803 3365s
 14977  1741 5854.68063   27  343 4487.66650 7873.40860  75.4%  2793 3433s
 15621  1630     cutoff   36      4487.66650 7634.52010  70.1%  2781 3499s
 16329  1441     cutoff   25      4487.66650 7485.47942  66.8%  2764 3567s
 17082  1312     cutoff   25      4487.66650 7205.91729  60.6%  2744 3600s

Cutting planes:
  MIR: 629
  Flow cover: 1226
  RLT: 10
  Relax-and-lift: 90

Explored 17514 nodes (47915398 simplex iterations) in 3600.05 seconds (7011.81 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 4487.67 4347.22 4337.26 ... 2677.45

Time limit reached
Best objective 4.487666500018e+03, best bound 6.982065164982e+03, gap 55.5834%
  WARNING: Time limit reached. Using best solution found (gap: 55.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 4487.67, θ = 146969.74
  Upper Bound (UB) = 4487.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146969.74
  [DEBUG]   ✓ Scenario 0: θ = 146969.74 ≤ Q = 146969.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146969.74 ≤ Q = 146969.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146969.74 ≤ Q = 146969.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146969.74 ≤ Q = 146969.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146969.74 ≤ Q = 146969.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146969.74 ≤ Q = 146969.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146969.74 ≤ Q = 146969.74 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xd918c30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf26e73d0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.313808e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6968497.6786
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.596346e+05, 271 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159634.56    0  136 6968497.68 -159634.56   102%     -    0s
H    0     0                    -116115.6138 -159634.56  37.5%     -    0s
H    0     0                    -117649.0135 -159634.56  35.7%     -    0s
H    0     0                    -122339.5555 -139110.86  13.7%     -    0s
H    0     0                    -127880.3831 -139110.86  8.78%     -    0s
     0     0 -139110.86    0   67 -127880.38 -139110.86  8.78%     -    0s
H    0     0                    -137034.5054 -139084.19  1.50%     -    0s
     0     0 -138896.84    0   63 -137034.51 -138896.84  1.36%     -    0s
H    0     0                    -137624.6765 -138896.84  0.92%     -    0s
     0     0 -138166.61    0   48 -137624.68 -138166.61  0.39%     -    0s
     0     0 -138101.43    0   45 -137624.68 -138101.43  0.35%     -    0s
     0     0 -138101.43    0   39 -137624.68 -138101.43  0.35%     -    0s
     0     0 -137900.54    0   12 -137624.68 -137900.54  0.20%     -    0s
     0     0 -137900.41    0   11 -137624.68 -137900.41  0.20%     -    0s
     0     0 -137818.76    0   10 -137624.68 -137818.76  0.14%     -    0s
     0     0 -137817.76    0   16 -137624.68 -137817.76  0.14%     -    0s
H    0     0                    -137663.7704 -137817.76  0.11%     -    0s
     0     0 -137773.67    0    4 -137663.77 -137773.67  0.08%     -    0s
     0     0 -137764.68    0    8 -137663.77 -137764.68  0.07%     -    0s
H    0     0                    -137679.7088 -137764.68  0.06%     -    0s
*    0     0               0    -137748.1573 -137748.16  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 1
  Flow cover: 6

Explored 1 nodes (720 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -137748 -137680 -137664 ... 6.9685e+06
No other solutions better than -137748

Optimal solution found (tolerance 1.00e-04)
Best objective -1.377481572770e+05, best bound -1.377481572770e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 131513.24
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137748.16
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -137748.16 = 131513.24
  [DEBUG]   Current θ from Master = 146969.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15456.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10968.83
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 1739.0395, Absolute Gap = 1739.0395, Relative Gap = 0.387515
  Not converged yet (gap = 1739.04 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351559 nonzeros
Model fingerprint: 0x45609753
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50216 rows and 20396 columns
Presolve time: 2.68s
Presolved: 73487 rows, 31784 columns, 457879 nonzeros
Variable types: 29525 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315267.1831
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73487 rows, 31784 columns, 457879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21076   -1.8271066e+05   0.000000e+00   2.585299e+06      5s
   42302   -1.7992459e+04   0.000000e+00   7.858436e+06     10s
   51401   -6.6575363e+03   0.000000e+00   3.744832e+07     15s
   58076   -1.2003023e+03   0.000000e+00   1.507425e+07     20s
   65452    6.6396060e+03   0.000000e+00   1.531896e+07     25s
   71549    9.7395881e+03   0.000000e+00   2.178696e+06     30s
   77814    1.1341307e+04   0.000000e+00   1.954461e+08     35s
   82047    1.5392424e+04   0.000000e+00   6.577521e+07     40s
   87863    1.8539339e+04   0.000000e+00   1.196671e+07     45s
   92979    2.0849420e+04   0.000000e+00   7.094780e+05     50s
   98204    2.2156843e+04   0.000000e+00   3.071073e+06     55s
  103252    2.2410302e+04   0.000000e+00   3.545717e+06     60s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 2.869583e+04, 68451 iterations, 58.93 seconds (77.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28695.8256    0   96 -191968.18 28695.8256   115%     -   62s
H    0     0                    -172581.5300 28695.8256   117%     -   62s
H    0     0                    -161686.2119 28695.8256   118%     -   62s
H    0     0                    -161540.9182 28695.8256   118%     -   63s
H    0     0                    -54227.84497 28695.8256   153%     -   63s
H    0     0                    -53385.32511 28695.8256   154%     -   63s
H    0     0                    -6726.900896 28695.8256   527%     -   63s
H    0     0                    -6298.130300 28695.8256   556%     -   63s
H    0     0                    -4687.400452 28695.8256   712%     -   63s
H    0     0                    -4474.866673 28695.8256   741%     -   63s
H    0     0                    -4420.488757 28695.8256   749%     -   63s
     0     0 26279.8284    0  270 -4420.4888 26279.8284   695%     -   77s
     0     0 26075.3353    0  283 -4420.4888 26075.3353   690%     -   82s
     0     0 26075.3353    0  277 -4420.4888 26075.3353   690%     -   84s
     0     0 25761.5660    0  267 -4420.4888 25761.5660   683%     -   90s
     0     0 25761.5660    0  269 -4420.4888 25761.5660   683%     -   92s
     0     0 25761.5660    0  267 -4420.4888 25761.5660   683%     -   92s
H    0     0                    -4187.902234 21929.6898   624%     -  116s
H    0     0                    -4036.385416 21929.6898   643%     -  116s
     0     0 21929.6898    0  333 -4036.3854 21929.6898   643%     -  116s
H    0     0                    -3698.752873 21929.4321   693%     -  117s
     0     0 21611.8679    0  287 -3698.7529 21611.8679   684%     -  125s
     0     0 21470.0043    0  299 -3698.7529 21470.0043   680%     -  129s
     0     0 21426.7782    0  294 -3698.7529 21426.7782   679%     -  133s
     0     0 21397.2341    0  305 -3698.7529 21397.2341   678%     -  136s
     0     0 21387.2594    0  309 -3698.7529 21387.2594   678%     -  137s
     0     0 21370.8768    0  303 -3698.7529 21370.8768   678%     -  138s
     0     0 21325.8345    0  304 -3698.7529 21325.8345   677%     -  140s
     0     0 21320.0794    0  307 -3698.7529 21320.0794   676%     -  141s
     0     0 21304.2595    0  306 -3698.7529 21304.2595   676%     -  142s
     0     0 21300.1706    0  301 -3698.7529 21300.1706   676%     -  143s
     0     0 21294.2534    0  306 -3698.7529 21294.2534   676%     -  143s
     0     0 21293.7943    0  310 -3698.7529 21293.7943   676%     -  144s
H    0     0                     406.6683023 19135.3163  4605%     -  170s
H    0     0                     602.3562080 19135.3163  3077%     -  170s
H    0     0                     799.4814122 19135.3163  2293%     -  170s
H    0     0                     926.0101326 19135.3163  1966%     -  170s
H    0     0                     931.4902502 19135.3163  1954%     -  170s
H    0     0                    1086.6203231 19135.3163  1661%     -  170s
H    0     0                    1089.9995667 19135.3163  1656%     -  170s
     0     0 19135.3163    0  382 1089.99957 19135.3163  1656%     -  170s
     0     0 18815.1304    0  330 1089.99957 18815.1304  1626%     -  179s
H    0     0                    2360.5245976 18349.4239   677%     -  193s
H    0     0                    2609.6570194 18349.4239   603%     -  193s
     0     0 18349.4239    0  385 2609.65702 18349.4239   603%     -  193s
     0     0 18192.3799    0  385 2609.65702 18192.3799   597%     -  198s
     0     0 18124.1295    0  384 2609.65702 18124.1295   595%     -  204s
     0     0 18020.0189    0  401 2609.65702 18020.0189   591%     -  208s
     0     0 18001.0719    0  388 2609.65702 18001.0719   590%     -  210s
     0     0 17716.2336    0  378 2609.65702 17716.2336   579%     -  219s
     0     0 17676.8693    0  381 2609.65702 17676.8693   577%     -  221s
     0     0 17670.4683    0  379 2609.65702 17670.4683   577%     -  223s
     0     0 17662.2934    0  382 2609.65702 17662.2934   577%     -  225s
     0     0 17657.3603    0  380 2609.65702 17657.3603   577%     -  226s
     0     0 17653.6809    0  389 2609.65702 17653.6809   576%     -  227s
     0     0 17653.0503    0  389 2609.65702 17653.0503   576%     -  227s
H    0     0                    2758.4664465 17653.0503   540%     -  236s
H    0     0                    2800.1143891 17653.0503   530%     -  236s
H    0     0                    2857.3240748 16971.9480   494%     -  249s
     0     0 16971.9480    0  385 2857.32407 16971.9480   494%     -  249s
     0     0 16643.4407    0  459 2857.32407 16643.4407   482%     -  259s
     0     0 16533.2325    0  455 2857.32407 16533.2325   479%     -  263s
     0     0 16484.8162    0  456 2857.32407 16484.8162   477%     -  266s
     0     0 16456.4352    0  451 2857.32407 16456.4352   476%     -  269s
     0     0 16444.3225    0  464 2857.32407 16444.3225   476%     -  271s
     0     0 16441.0763    0  463 2857.32407 16441.0763   475%     -  272s
     0     0 16437.0727    0  467 2857.32407 16437.0727   475%     -  273s
     0     0 16432.0829    0  464 2857.32407 16432.0829   475%     -  274s
     0     0 16430.5131    0  468 2857.32407 16430.5131   475%     -  275s
     0     0 16427.7053    0  467 2857.32407 16427.7053   475%     -  275s
     0     0 16421.9044    0  470 2857.32407 16421.9044   475%     -  276s
     0     0 16421.2867    0  473 2857.32407 16421.2867   475%     -  277s
     0     0 16322.6202    0  419 2857.32407 16322.6202   471%     -  281s
H    0     0                    3013.8857138 16322.4911   442%     -  282s
H    0     0                    3099.3722880 16322.4911   427%     -  282s
H    0     0                    3142.6959503 16322.4911   419%     -  282s
H    0     0                    3158.9225754 16322.4911   417%     -  282s
H    0     0                    3170.4165498 16322.4911   415%     -  282s
H    0     0                    3218.6888332 16322.4911   407%     -  282s
     0     0 16302.7053    0  417 3218.68883 16302.7053   407%     -  283s
     0     0 16295.4203    0  412 3218.68883 16295.4203   406%     -  284s
     0     0 16290.9989    0  423 3218.68883 16290.9989   406%     -  285s
     0     0 16289.1352    0  416 3218.68883 16289.1352   406%     -  285s
     0     0 16288.9580    0  426 3218.68883 16288.9580   406%     -  286s
     0     0 16242.5466    0  451 3218.68883 16242.5466   405%     -  291s
     0     0 16219.8434    0  454 3218.68883 16219.8434   404%     -  300s
     0     0 16218.1449    0  452 3218.68883 16218.1449   404%     -  301s
     0     0 16216.5137    0  457 3218.68883 16216.5137   404%     -  302s
     0     0 16215.7863    0  449 3218.68883 16215.7863   404%     -  302s
     0     0 16201.0424    0  419 3218.68883 16201.0424   403%     -  304s
     0     0 16194.9161    0  414 3218.68883 16194.9161   403%     -  306s
     0     0 16194.3339    0  414 3218.68883 16194.3339   403%     -  307s
     0     0 16176.6101    0  421 3218.68883 16176.6101   403%     -  309s
H    0     0                    3272.0886880 16176.3591   394%     -  312s
H    0     0                    3288.3153131 16176.3591   392%     -  312s
     0     0 16175.0496    0  422 3288.31531 16175.0496   392%     -  313s
     0     0 16174.3528    0  423 3288.31531 16174.3528   392%     -  313s
     0     0 16171.8676    0  424 3288.31531 16171.8676   392%     -  315s
     0     0 16171.0155    0  417 3288.31531 16171.0155   392%     -  316s
     0     0 16170.0804    0  424 3288.31531 16170.0804   392%     -  318s
     0     0 16168.0908    0  422 3288.31531 16168.0908   392%     -  321s
     0     0 16167.7331    0  423 3288.31531 16167.7331   392%     -  321s
     0     0 16166.7145    0  419 3288.31531 16166.7145   392%     -  323s
     0     0 16166.6284    0  419 3288.31531 16166.6284   392%     -  325s
H    0     0                    3340.7327271 16166.3864   384%     -  344s
H    0     0                    3386.0606228 16166.3864   377%     -  344s
H    0     0                    3438.4780368 16166.3864   370%     -  344s
     0     2 16166.3864    0  419 3438.47804 16166.3864   370%     -  371s
     1     4 16073.9242    1  414 3438.47804 16166.3864   370%  2342  382s
     3     8 15908.4188    2  408 3438.47804 16073.4944   367%  5622  393s
     7    16 15586.1926    3  413 3438.47804 16016.9645   366%  5518  402s
    15    32 15421.1846    4  404 3438.47804 15823.0005   360%  5408  416s
    31    49 10759.4150    5  234 3438.47804 15692.7212   356%  8807  446s
    48    81 12745.9247    6  288 3438.47804 15692.7212   356%  9010  482s
    80   226 12655.3959    7  272 3438.47804 15692.7212   356%  6872  510s
   225   258 12174.0554   10  247 3438.47804 15692.7212   356%  4207  522s
   257   295 12087.6871    9  254 3438.47804 15692.7212   356%  4038  534s
   294   331 12090.4216   10  247 3438.47804 15692.7212   356%  3952  547s
H  309   331                    3462.2536125 15692.7212   353%  3884  547s
   330   436 12007.8065    9  252 3462.25361 15692.7212   353%  3819  559s
   436   474 9560.94688   11  219 3462.25361 15692.7212   353%  3488  570s
H  477   474                    3581.8317470 15692.7212   338%  3418  570s
   490   499 11898.5690   20  294 3581.83175 15692.7212   338%  3417  585s
   561   532 9297.61114   11  227 3581.83175 15692.7212   338%  3507  599s
H  565   532                    3656.5488497 15692.7212   329%  3513  599s
H  569   532                    3822.7740514 15692.7212   311%  3535  599s
H  595   532                    4070.4411067 15692.7212   286%  3591  599s
   628   546 8702.41062   12  235 4070.44111 15692.7212   286%  3653  613s
   694   570 8143.58662   12  193 4070.44111 15692.7212   286%  3697  628s
H  697   570                    4145.1582094 15692.7212   279%  3692  628s
   736   600 8377.51408   12  224 4145.15821 15692.7212   279%  3809  641s
   808   632 6107.76319   13  186 4145.15821 15692.7212   279%  3889  654s
   867   665 7074.48684   14  182 4145.15821 15692.7212   279%  3883  668s
H  933   665                    4215.4954405 15692.7212   272%  3902  668s
   940   681 6874.36323   15  180 4215.49544 15692.7212   272%  3906  682s
   998   704 4379.85651   14  175 4215.49544 15692.7212   272%  3949  695s
  1045   735 6772.82254   16  158 4215.49544 15692.7212   272%  3972  712s
  1122   799 6165.06655   19  148 4215.49544 15692.7212   272%  3938  727s
  1212   874 5347.97948   23  141 4215.49544 15692.7212   272%  3935  743s
  1323   964     cutoff   25      4215.49544 15692.7212   272%  3899  757s
  1439  1037 14253.7870    6  376 4215.49544 15692.7212   272%  3898  771s
  1552  1091 14108.8369    7  376 4215.49544 15692.7212   272%  3897  787s
  1656  1146 11846.1555    9  326 4215.49544 15300.4023   263%  3952  803s
  1754  1218 11629.3090   10  327 4215.49544 14908.2345   254%  4021  819s
  1856  1301 11171.5255   12  284 4215.49544 14908.2345   254%  4090  835s
  1979  1402 9631.42169   15  279 4215.49544 14804.8530   251%  4102  854s
  2129  1459 8776.70839   19  267 4215.49544 14804.8530   251%  4053  871s
  2233  1511 8558.49106   21  274 4215.49544 14804.8530   251%  4014  891s
  2336  1565 7935.58949   26  287 4215.49544 14710.4079   249%  4035  910s
  2436  1657 6986.44144   31  235 4215.49544 14710.4079   249%  4074  927s
  2554  1767 6169.16926   39  189 4215.49544 14710.4079   249%  4102  943s
  2692  1913 5114.19927   40  161 4215.49544 14710.4079   249%  4117  959s
  2885  2020 11377.8712    7  212 4215.49544 14313.3937   240%  4068  982s
  3066  2151 9691.50378    9  158 4215.49544 14313.3937   240%  4044 1004s
  3294  2195 4971.71822   11  230 4215.49544 14313.3937   240%  3972 1028s
  3467  2254 4346.87305   12  152 4215.49544 14313.3937   240%  3920 1052s
  3636  2325 9086.54478   10  246 4215.49544 13736.0274   226%  3934 1077s
  3792  2421 11328.9171   11  268 4215.49544 13736.0274   226%  3952 1100s
  3944  2447 8968.46434   15  174 4215.49544 13736.0274   226%  3997 1123s
  3989  2495 8760.84620   16  180 4215.49544 13736.0274   226%  4038 1148s
  4111  2602 7036.73703   15  160 4215.49544 13736.0274   226%  4071 1173s
  4292  2603 8542.80253   14  419 4215.49544 13420.4325   218%  4083 1250s
  4294  2604 6381.09998   14   96 4215.49544 13420.4325   218%  4081 1315s
  4295  2605 7976.10347   31  336 4215.49544 13420.4325   218%  4080 1346s
  4296  2606 9081.21603   13  474 4215.49544 13420.4325   218%  4079 1378s
  4297  2606 7174.99817   38  440 4215.49544 13420.4325   218%  4078 1396s
  4298  2607 11913.0164   17  431 4215.49544 13420.4325   218%  4077 1408s
  4299  2608 4772.14780   48  469 4215.49544 13420.4325   218%  4076 1419s
  4300  2608 12159.4696    8  457 4215.49544 13420.4325   218%  4075 1427s
  4301  2609 4575.80216   14  428 4215.49544 13420.4325   218%  4075 1431s
  4302  2610 5543.64696   61  425 4215.49544 13420.4325   218%  4074 1435s
  4303  2610 7064.30125   29  416 4215.49544 13420.4325   218%  4073 1442s
  4304  2611 8005.57129    9  425 4215.49544 13420.4325   218%  4072 1446s
  4305  2612 6562.48788   18  387 4215.49544 13420.4325   218%  4071 1455s
  4306  2612 9793.04161   21  440 4215.49544 13420.4325   218%  4070 1460s
  4308  2614 11377.7825   11  486 4215.49544 13420.4325   218%  4068 1469s
  4309  2614 7283.89986   14  434 4215.49544 13420.4325   218%  4067 1472s
  4310  2615 7665.82973   13  444 4215.49544 13420.4325   218%  4066 1475s
  4311  2616 8444.28459   21  444 4215.49544 13420.4325   218%  4065 1483s
  4312  2616 5003.49196   38  481 4215.49544 13420.4325   218%  4064 1486s
  4313  2617 8925.89727   20  480 4215.49544 13420.4325   218%  4063 1490s
  4314  2618 10795.8977   13  434 4215.49544 13420.4325   218%  4062 1498s
  4315  2618 6768.55478   34  391 4215.49544 13420.4325   218%  4061 1502s
  4316  2619 7922.80911   15  486 4215.49544 13420.4325   218%  4060 1510s
  4318  2620 5774.40228   16  506 4215.49544 13420.4325   218%  4058 1517s
  4319  2621 11755.2729   16  416 4215.49544 13420.4325   218%  4058 1521s
  4320  2622 7144.98964   39  456 4215.49544 13420.4325   218%  4057 1529s
  4321  2622 9752.65920   15  414 4215.49544 13420.4325   218%  4056 1532s
  4322  2623 6457.80973   34  424 4215.49544 13420.4325   218%  4055 1537s
  4323  2624 8148.95422   16  523 4215.49544 13420.4325   218%  4054 1546s
  4324  2624 5150.46691   20  454 4215.49544 13420.4325   218%  4053 1550s
  4326  2626 4985.67494   35  423 4215.49544 13420.4325   218%  4051 1560s
  4328  2627 5946.32530   32  427 4215.49544 13420.4325   218%  4049 1570s
  4330  2628 4650.11392   47  466 4215.49544 13420.4325   218%  4047 1579s
  4331  2629 8820.31087   17  466 4215.49544 13420.4325   218%  4046 1643s
  4332  2630 8544.68516   16  466 4215.49544 13420.4325   218%  4045 1696s
  4333  2633 13420.4325   12  455 4215.49544 13420.4325   218%  4103 1736s
  4335  2637 13420.4325   13  451 4215.49544 13420.4325   218%  4106 1767s
  4339  2643 13420.4325   14  446 4215.49544 13420.4325   218%  4110 1799s
  4347  2657 13420.4325   15  466 4215.49544 13420.4325   218%  4118 1818s
  4363  2668 12657.4929   16  248 4215.49544 13420.4325   218%  4156 1874s
  4380  2695 11473.0843   17  270 4215.49544 13420.4325   218%  4187 1913s
  4412  2786 11416.2887   18  258 4215.49544 13420.4325   218%  4248 1948s
  4518  2780 9643.24764   22  282 4215.49544 13420.4325   218%  4263 1964s
  4556  2828 7814.47313   21  196 4215.49544 13420.4325   218%  4269 1984s
  4623  2849 8437.91451   23  266 4215.49544 13420.4325   218%  4269 2000s
  4686  2856 7869.22308   24  235 4215.49544 13420.4325   218%  4287 2019s
  4766  2841 6968.26834   26  232 4215.49544 13420.4325   218%  4305 2035s
  4842  2822 7393.11737   24  261 4215.49544 13420.4325   218%  4322 2057s
  4908  2808 6285.54592   27  226 4215.49544 13420.4325   218%  4337 2075s
  4967  2794 5253.37017   30  276 4215.49544 13420.4325   218%  4356 2093s
  5022  2788 4880.97891   31  192 4215.49544 13420.4325   218%  4374 2110s
  5100  2777     cutoff   32      4215.49544 13420.4325   218%  4390 2127s
  5158  2796 7301.74683   22  172 4215.49544 13420.4325   218%  4400 2151s
  5221  2811 5539.51132   25  143 4215.49544 13420.4325   218%  4421 2174s
  5294  2799     cutoff   28      4215.49544 13420.4325   218%  4443 2197s
  5338  2790 7530.62765   28  221 4215.49544 13420.4325   218%  4457 2219s
  5386  2794 7518.98695   29  114 4215.49544 13420.4325   218%  4467 2237s
  5434  2792     cutoff   30      4215.49544 13420.4325   218%  4477 2254s
  5474  2794 6717.08134   31  183 4215.49544 13420.4325   218%  4494 2271s
  5517  2810 6707.25283   32  182 4215.49544 13420.4325   218%  4501 2285s
  5569  2805 6308.67798   33  124 4215.49544 13420.4325   218%  4497 2305s
  5633  2806 5711.79295   34  226 4215.49544 13420.4325   218%  4502 2327s
  5705  2796 5669.93768   35  267 4215.49544 13420.4325   218%  4521 2346s
  5770  2797     cutoff   38      4215.49544 13420.4325   218%  4538 2367s
  5846  2807 8421.47134   19  384 4215.49544 13420.4325   218%  4552 2394s
  5929  2829 7950.33924   21  326 4215.49544 13420.4325   218%  4565 2420s
  6025  2837 infeasible   25      4215.49544 13420.4325   218%  4591 2446s
  6121  2840 4381.65913   26  226 4215.49544 13420.4325   218%  4617 2469s
  6240  2818     cutoff   25      4215.49544 13098.9809   211%  4639 2494s
  6294  2832 10868.9742   19  426 4215.49544 13098.9809   211%  4647 2518s
  6363  2832 10628.7950   20  450 4215.49544 12018.9490   185%  4662 2544s
  6461  2828 9434.90244   23  412 4215.49544 12018.9490   185%  4693 2572s
  6567  2828 8478.58360   24  352 4215.49544 12018.9490   185%  4731 2600s
  6675  2828 5541.53734   27  287 4215.49544 12018.9490   185%  4774 2630s
  6818  2819 6946.72093   26  272 4215.49544 12018.9490   185%  4810 2666s
  6949  2811 infeasible   31      4215.49544 12018.9490   185%  4842 2697s
  7096  2777 5911.68412   22  147 4215.49544 11222.6645   166%  4882 2730s
  7231  2768 7242.54365   26  198 4215.49544 11067.6446   163%  4931 2767s
  7368  2778 6726.24920   27  161 4215.49544 11067.6446   163%  4969 2803s
  7525  2730     cutoff   31      4215.49544 10706.5486   154%  5010 2836s
  7630  2761 5918.45652   17  188 4215.49544 10706.5486   154%  5054 2873s
  7792  2722 infeasible   23      4215.49544 10694.5482   154%  5094 2913s
  7962  2701 8139.54622   22  192 4215.49544 10628.4808   152%  5143 2953s
  8129  2684 6192.88963   24  250 4215.49544 10628.4808   152%  5193 3000s
  8313  2667 infeasible   28      4215.49544 10463.8427   148%  5247 3044s
  8523  2601 7879.44208   23  184 4215.49544 10208.7599   142%  5280 3081s
  8586  2619 4792.87757   24  170 4215.49544 10208.7599   142%  5298 3126s
  8733  2594     cutoff   26      4215.49544 10143.5089   141%  5313 3177s
  8904  2609 7907.09345   20  170 4215.49544 9956.90054   136%  5332 3231s
  9165  2585     cutoff   27      4215.49544 9956.90054   136%  5351 3283s
  9429  2579     cutoff   22      4215.49544 9792.56208   132%  5379 3337s
  9719  2571 5413.75468   24  363 4215.49544 9745.13561   131%  5407 3387s
 10054  2524 4990.37052   25  210 4215.49544 9579.21539   127%  5419 3442s
 10414  2482 infeasible   27      4215.49544 9353.63881   122%  5427 3496s
 10762  2435 infeasible   25      4215.49544 9208.64925   118%  5447 3564s
 11075  2353 4380.70212   22  308 4215.49544 9097.78098   116%  5482 3600s

Cutting planes:
  Learned: 1
  MIR: 668
  Flow cover: 1713
  RLT: 15
  Relax-and-lift: 153

Explored 11329 nodes (62480360 simplex iterations) in 3600.05 seconds (6868.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 4215.5 4145.16 4070.44 ... 3340.73

Time limit reached
Best objective 4.215495440512e+03, best bound 9.014253222256e+03, gap 113.8362%
  WARNING: Time limit reached. Using best solution found (gap: 113.84%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 4215.50, θ = 146609.77
  Upper Bound (UB) = 4215.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146609.77
  [DEBUG]   ✓ Scenario 0: θ = 146609.77 ≤ Q = 146609.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146609.77 ≤ Q = 146609.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146609.77 ≤ Q = 146609.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146609.77 ≤ Q = 146609.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146609.77 ≤ Q = 146609.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146609.77 ≤ Q = 146609.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146609.77 ≤ Q = 146609.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146609.77 ≤ Q = 146609.77 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3caaa133
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc3555ecd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.312088e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6940420.4839
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.575227e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157522.67    0  126 6940420.48 -157522.67   102%     -    0s
H    0     0                    -118878.2434 -157522.67  32.5%     -    0s
H    0     0                    -119388.3531 -157522.67  31.9%     -    0s
     0     0 -133294.68    0   59 -119388.35 -133294.68  11.6%     -    0s
H    0     0                    -131779.4640 -133263.32  1.13%     -    0s
H    0     0                    -131920.4377 -133263.32  1.02%     -    0s
     0     0 -132583.58    0   47 -131920.44 -132583.58  0.50%     -    0s
H    0     0                    -131936.6935 -132582.93  0.49%     -    0s
     0     0 -132553.18    0   40 -131936.69 -132553.18  0.47%     -    0s
     0     0 -132290.61    0   17 -131936.69 -132290.61  0.27%     -    0s
     0     0 -132286.13    0   15 -131936.69 -132286.13  0.26%     -    0s
H    0     0                    -131937.6090 -132284.66  0.26%     -    0s
     0     0 -132246.80    0   16 -131937.61 -132246.80  0.23%     -    0s
     0     0 -132246.28    0   15 -131937.61 -132246.28  0.23%     -    0s
     0     0 -132243.85    0   16 -131937.61 -132243.85  0.23%     -    0s
     0     0 -132143.08    0   13 -131937.61 -132143.08  0.16%     -    0s
     0     0 -132130.04    0   15 -131937.61 -132130.04  0.15%     -    0s
     0     0 -132056.17    0   12 -131937.61 -132056.17  0.09%     -    0s
     0     0 -132056.17    0   17 -131937.61 -132056.17  0.09%     -    0s
H    0     0                    -131939.8554 -132056.17  0.09%     -    0s
     0     0 -131960.20    0    9 -131939.86 -131960.20  0.02%     -    0s
     0     0          -    0      -131939.86 -131946.12  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 8
  Flow cover: 9

Explored 1 nodes (746 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -131940 -131938 -131937 ... 1.31209e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.319398554001e+05, best bound -1.319461182017e+05, gap 0.0047%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 137067.93
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131939.86
  [DEBUG]   S×d_nominal = 269007.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269007.78 + -131939.86 = 137067.93
  [DEBUG]   Current θ from Master = 146609.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9541.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5326.34
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 1466.8684, Absolute Gap = 1466.8684, Relative Gap = 0.347971
  Not converged yet (gap = 1466.87 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394814 nonzeros
Model fingerprint: 0xb9fedfdc
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56478 rows and 22938 columns
Presolve time: 2.55s
Presolved: 82515 rows, 35482 columns, 503885 nonzeros
Variable types: 33223 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -317265.2303
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.403e+06
 Factor NZ  : 7.385e+06 (roughly 100 MB of memory)
 Factor Ops : 1.199e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55382041e+07  1.62417924e+08  9.56e+04 2.29e+01  6.85e+04     4s
   1  -1.15626948e+07  1.39788690e+08  6.66e+04 7.32e+01  4.76e+04     5s
   2  -3.45036618e+06  1.08542911e+08  1.98e+04 2.19e-11  1.51e+04     5s
   3  -7.48057276e+05  7.00625356e+07  1.48e+03 4.47e-11  1.48e+03     5s
   4  -5.29177953e+05  2.62810682e+07  5.46e+02 1.08e-11  5.05e+02     5s
   5  -3.71590381e+05  1.70593394e+07  2.05e+02 1.12e-11  2.29e+02     5s
   6  -2.29453123e+05  1.20656619e+07  6.10e+01 7.44e-12  1.11e+02     5s
   7  -1.91931333e+05  1.04059151e+07  4.31e+01 6.85e-12  8.93e+01     5s
   8  -1.23269763e+05  6.48058164e+06  1.99e+01 5.49e-12  5.01e+01     5s
   9  -9.95751156e+04  4.52299960e+06  1.07e+01 5.73e-12  3.31e+01     5s
  10  -8.52745872e+04  1.67525025e+06  6.34e+00 4.40e-12  1.23e+01     5s
  11  -4.67619306e+04  4.39186924e+05  1.39e+00 1.91e-12  3.26e+00     5s
  12  -2.78291704e+04  2.73032047e+05  8.48e-01 1.91e-12  2.01e+00     5s
  13  -2.10251251e+04  1.65501685e+05  6.83e-01 2.04e-04  1.24e+00     5s
  14  -9.04631773e+03  1.27179493e+05  4.79e-01 3.31e-04  9.07e-01     5s
  15  -5.11392077e+03  9.60427805e+04  4.22e-01 1.11e-03  6.74e-01     5s
  16   2.24340724e+03  7.66493439e+04  3.15e-01 1.48e-03  4.95e-01     5s
  17   6.07941171e+03  6.77394918e+04  2.71e-01 1.14e-03  4.11e-01     5s
  18   1.23001347e+04  5.60337601e+04  1.98e-01 1.71e-03  2.91e-01     5s
  19   1.60651159e+04  5.12632102e+04  1.61e-01 1.85e-03  2.34e-01     6s
  20   2.04651680e+04  4.51535101e+04  1.19e-01 2.03e-03  1.64e-01     6s
  21   2.41562976e+04  4.36621521e+04  8.61e-02 1.95e-03  1.30e-01     6s
  22   2.64328078e+04  4.17516624e+04  6.65e-02 1.52e-03  1.02e-01     6s
  23   2.77539685e+04  3.94907894e+04  5.54e-02 1.31e-03  7.81e-02     6s
  24   2.87794266e+04  3.83426645e+04  4.71e-02 1.24e-03  6.37e-02     6s
  25   2.98374198e+04  3.77100884e+04  3.86e-02 1.06e-03  5.24e-02     6s
  26   3.09259798e+04  3.72271090e+04  2.98e-02 8.28e-04  4.19e-02     6s
  27   3.15229645e+04  3.68930311e+04  2.51e-02 8.84e-04  3.57e-02     6s
  28   3.24661216e+04  3.63789985e+04  1.80e-02 1.31e-03  2.60e-02     6s
  29   3.27559505e+04  3.60791698e+04  1.59e-02 1.06e-03  2.21e-02     6s
  30   3.31900038e+04  3.57101782e+04  1.26e-02 7.25e-04  1.68e-02     6s
  31   3.37467706e+04  3.55159545e+04  8.46e-03 5.99e-04  1.18e-02     6s
  32   3.39353928e+04  3.53935250e+04  7.05e-03 4.75e-04  9.71e-03     6s
  33   3.40741724e+04  3.52876004e+04  6.07e-03 3.68e-04  8.08e-03     6s
  34   3.41958550e+04  3.52091513e+04  5.18e-03 2.82e-04  6.75e-03     7s
  35   3.42408227e+04  3.51560277e+04  4.86e-03 2.17e-04  6.10e-03     7s
  36   3.43956564e+04  3.51291838e+04  3.82e-03 1.81e-04  4.89e-03     7s
  37   3.45205742e+04  3.50756566e+04  2.97e-03 1.22e-04  3.70e-03     7s
  38   3.46676449e+04  3.50355374e+04  1.94e-03 7.95e-05  2.45e-03     7s
  39   3.47067236e+04  3.50268405e+04  1.68e-03 6.93e-05  2.13e-03     7s
  40   3.47836118e+04  3.50138637e+04  1.14e-03 5.54e-05  1.53e-03     7s
  41   3.47867043e+04  3.50053065e+04  1.12e-03 4.65e-05  1.46e-03     7s
  42   3.48065458e+04  3.50018258e+04  9.86e-04 4.30e-05  1.30e-03     7s
  43   3.48916205e+04  3.49814633e+04  4.41e-04 1.99e-05  5.98e-04     7s
  44   3.49531651e+04  3.49646514e+04  4.77e-05 2.82e-06  7.64e-05     7s
  45   3.49621443e+04  3.49622849e+04  4.77e-07 7.73e-06  9.33e-07     7s
  46   3.49622075e+04  3.49622658e+04  6.25e-07 5.84e-07  3.88e-07     7s
  47   3.49622641e+04  3.49622642e+04  4.81e-09 5.75e-10  9.58e-10     8s

Barrier solved model in 47 iterations and 7.55 seconds (6.78 work units)
Optimal objective 3.49622641e+04


Root crossover log...

   73106 DPushes remaining with DInf 0.0000000e+00                 8s
      11 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    4872 PPushes remaining with PInf 5.0904548e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.7881624e+05     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39007    3.4962264e+04   0.000000e+00   4.788162e+05     11s
   39069    3.4962264e+04   0.000000e+00   0.000000e+00     11s
   39069    3.4962264e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.496226e+04, 39069 iterations, 7.19 seconds (9.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34962.2642    0  207 -191968.18 34962.2642   118%     -   11s
H    0     0                    -180816.5752 34962.2642   119%     -   11s
H    0     0                    -176310.0082 34962.2642   120%     -   12s
H    0     0                    -168752.6438 34962.2642   121%     -   12s
H    0     0                    -168558.9304 34962.2642   121%     -   12s
H    0     0                    -58063.05376 34962.2642   160%     -   12s
H    0     0                    -26726.07599 34962.2642   231%     -   12s
H    0     0                    -13825.14672 34962.2642   353%     -   13s
H    0     0                    -13386.92753 34962.2642   361%     -   13s
H    0     0                    -12072.91089 34962.2642   390%     -   13s
H    0     0                    -11881.52825 27783.8674   334%     -   56s
H    0     0                    -9552.725260 27783.8674   391%     -   56s
H    0     0                    -9542.101769 27783.8674   391%     -   56s
H    0     0                    -8638.811061 27783.8674   422%     -   56s
H    0     0                    -8248.081818 27783.8674   437%     -   56s
H    0     0                    -8149.541518 27783.8674   441%     -   56s
     0     0 27742.7433    0  314 -8149.5415 27742.7433   440%     -   56s
H    0     0                    -6296.274083 27742.7433   541%     -   56s
H    0     0                    -6038.779319 27742.7433   559%     -   57s
     0     0 27320.4669    0  283 -6038.7793 27320.4669   552%     -   69s
     0     0 27100.6618    0  321 -6038.7793 27100.6618   549%     -   77s
     0     0 27100.6618    0  321 -6038.7793 27100.6618   549%     -   78s
     0     0 27100.6618    0  274 -6038.7793 27100.6618   549%     -   80s
     0     0 27100.6618    0  328 -6038.7793 27100.6618   549%     -   84s
     0     0 27100.6618    0  329 -6038.7793 27100.6618   549%     -   85s
     0     0 27100.6618    0  329 -6038.7793 27100.6618   549%     -   86s
     0     0 23472.7109    0  348 -6038.7793 23472.7109   489%     -  120s
H    0     0                     322.9169832 23472.7109  7169%     -  121s
H    0     0                     401.3936310 23472.7109  5748%     -  121s
     0     0 22156.3355    0  377  401.39363 22156.3355  5420%     -  153s
     0     0 21858.7456    0  413  401.39363 21858.7456  5346%     -  165s
     0     0 21793.5268    0  423  401.39363 21793.5268  5329%     -  173s
     0     0 21749.2984    0  417  401.39363 21749.2984  5318%     -  179s
     0     0 21636.5307    0  414  401.39363 21636.5307  5290%     -  187s
     0     0 21633.9493    0  415  401.39363 21633.9493  5290%     -  190s
     0     0 21598.8300    0  419  401.39363 21598.8300  5281%     -  195s
     0     0 21530.7212    0  429  401.39363 21530.7212  5264%     -  202s
     0     0 21525.9890    0  423  401.39363 21525.9890  5263%     -  204s
     0     0 21501.9747    0  422  401.39363 21501.9747  5257%     -  207s
     0     0 21500.9995    0  422  401.39363 21500.9995  5257%     -  208s
     0     0 19491.8552    0  385  401.39363 19491.8552  4756%     -  245s
H    0     0                     430.2714549 19491.6397  4430%     -  245s
H    0     0                     454.0773211 19491.6397  4193%     -  245s
     0     0 19051.4489    0  365  454.07732 19051.4489  4096%     -  258s
H    0     0                     521.7275625 18583.0318  3462%     -  274s
H    0     0                     716.3413569 18583.0318  2494%     -  274s
H    0     0                    1160.9144639 18583.0318  1501%     -  274s
     0     0 18583.0318    0  387 1160.91446 18583.0318  1501%     -  275s
     0     0 18470.6185    0  439 1160.91446 18470.6185  1491%     -  283s
     0     0 18399.8124    0  388 1160.91446 18399.8124  1485%     -  289s
     0     0 18382.3390    0  457 1160.91446 18382.3390  1483%     -  295s
     0     0 18347.9455    0  401 1160.91446 18347.9455  1480%     -  300s
     0     0 18311.8167    0  420 1160.91446 18311.8167  1477%     -  304s
     0     0 18305.7736    0  421 1160.91446 18305.7736  1477%     -  306s
     0     0 18305.4854    0  421 1160.91446 18305.4854  1477%     -  307s
     0     0 17185.0880    0  412 1160.91446 17185.0880  1380%     -  337s
     0     0 16867.8077    0  413 1160.91446 16867.8077  1353%     -  348s
     0     0 16811.3294    0  458 1160.91446 16811.3294  1348%     -  353s
     0     0 16774.2184    0  473 1160.91446 16774.2184  1345%     -  355s
     0     0 16734.7888    0  456 1160.91446 16734.7888  1342%     -  360s
     0     0 16722.9823    0  462 1160.91446 16722.9823  1341%     -  362s
     0     0 16713.4098    0  415 1160.91446 16713.4098  1340%     -  364s
     0     0 16706.5516    0  416 1160.91446 16706.5516  1339%     -  366s
     0     0 16704.4876    0  426 1160.91446 16704.4876  1339%     -  366s
     0     0 16496.5866    0  481 1160.91446 16496.5866  1321%     -  378s
     0     0 16461.3052    0  415 1160.91446 16461.3052  1318%     -  384s
     0     0 16456.6853    0  532 1160.91446 16456.6853  1318%     -  386s
     0     0 16454.3974    0  543 1160.91446 16454.3974  1317%     -  387s
     0     0 16402.9760    0  425 1160.91446 16402.9760  1313%     -  396s
H    0     0                    1730.6483033 16402.4999   848%     -  398s
H    0     0                    1913.9108185 16402.4999   757%     -  398s
     0     0 16347.4592    0  454 1913.91082 16347.4592   754%     -  403s
     0     0 16337.8066    0  455 1913.91082 16337.8066   754%     -  407s
     0     0 16335.1542    0  460 1913.91082 16335.1542   753%     -  409s
     0     0 16297.9556    0  456 1913.91082 16297.9556   752%     -  414s
H    0     0                    1998.9693217 16297.6743   715%     -  414s
H    0     0                    2106.0179766 16297.6743   674%     -  414s
     0     0 16290.9638    0  406 2106.01798 16290.9638   674%     -  418s
     0     0 16287.3762    0  452 2106.01798 16287.3762   673%     -  421s
     0     0 16282.2404    0  456 2106.01798 16282.2404   673%     -  422s
     0     0 16277.3247    0  470 2106.01798 16277.3247   673%     -  423s
     0     0 16276.5734    0  466 2106.01798 16276.5734   673%     -  424s
     0     0 16257.2709    0  407 2106.01798 16257.2709   672%     -  429s
     0     0 16253.2013    0  422 2106.01798 16253.2013   672%     -  432s
     0     0 16251.1117    0  420 2106.01798 16251.1117   672%     -  433s
     0     0 16232.3707    0  415 2106.01798 16232.3707   671%     -  439s
H    0     0                    3572.8654565 16230.9925   354%     -  439s
H    0     0                    3779.1419365 16230.9925   329%     -  439s
     0     0 16230.3916    0  422 3779.14194 16230.3916   329%     -  440s
     0     0 16226.1056    0  415 3779.14194 16226.1056   329%     -  443s
     0     0 16224.9426    0  415 3779.14194 16224.9426   329%     -  446s
H    0     0                    3821.8764106 16223.8788   325%     -  480s
H    0     0                    3834.5014407 16223.8788   323%     -  480s
     0     2 16223.8788    0  415 3834.50144 16223.8788   323%     -  516s
     1     3 16089.6937    1  292 3834.50144 16223.8788   323%  3370  524s
     2     4 15759.3017    1  339 3834.50144 16088.5687   320%  8132  540s
     3     7 14888.3518    2  314 3834.50144 16087.9446   320%  7066  555s
     6    13 14420.8626    3  259 3834.50144 15799.7524   312%  6266  581s
    12    26 15283.8263    4  425 3834.50144 15799.6644   312%  8118  594s
    25    39 14223.3425    5  367 3834.50144 15299.7873   299%  9561  636s
    38    71 13496.7565    6  341 3834.50144 15299.7873   299% 12504  736s
    70   157 13435.1381    7  315 3834.50144 15091.5396   294% 14245  786s
   156   273 13334.4489   10  374 3834.50144 15091.3727   294%  8459  811s
   272   344 13107.2927   13  361 3834.50144 15091.3727   294%  5962  830s
   345   409 12586.7782   15  366 3834.50144 15091.3727   294%  5504  848s
   422   450 12311.6103   17  370 3834.50144 15091.3727   294%  5101  866s
   485   479 12934.1321   12  384 3834.50144 15091.3727   294%  5044  883s
   518   515 12024.6852   18  390 3834.50144 15053.8153   293%  5279  900s
   554   558 12795.8471   12  368 3834.50144 15053.8153   293%  5547  918s
   597   592 11626.0077   19  370 3834.50144 15053.8153   293%  5507  936s
   645   622 11228.7754   20  374 3834.50144 15053.8153   293%  5488  955s
   689   659 12249.3997   12  294 3834.50144 15053.8153   293%  5461  973s
   728   689 8669.08570   21  329 3834.50144 15053.8153   293%  5577  991s
   782   723 8657.27456   22  286 3834.50144 15053.8153   293%  5539 1010s
   838   765 7255.37490   25  271 3834.50144 15053.8153   293%  5573 1030s
   894   809 7153.85925   26  308 3834.50144 15053.8153   293%  5585 1050s
   948   840 6975.64340   29  278 3834.50144 15053.8153   293%  5598 1067s
  1011   877 6317.59892   33  299 3834.50144 15053.8153   293%  5562 1087s
  1068   927 6243.64517   35  314 3834.50144 15053.8153   293%  5632 1106s
  1134   971 5660.96452   38  261 3834.50144 15053.8153   293%  5592 1126s
  1231   994 4922.20954   41  238 3834.50144 15053.8153   293%  5430 1148s
  1307  1027 5234.44903   41  323 3834.50144 15053.8153   293%  5479 1172s
  1398  1076 4243.36332   43  227 3834.50144 15053.8153   293%  5461 1196s
  1485  1105 10627.2884   11  349 3834.50144 14721.5803   284%  5462 1222s
  1516  1136 10239.8446   12  343 3834.50144 14721.5803   284%  5534 1244s
  1557  1161 10057.2261   13  329 3834.50144 14721.5803   284%  5565 1266s
  1602  1192 9792.54685   14  316 3834.50144 14622.1663   281%  5591 1290s
  1653  1249     cutoff   15      3834.50144 14622.1663   281%  5643 1312s
  1728  1310 9451.42588   16  310 3834.50144 14622.1663   281%  5642 1339s
  1812  1372 9191.98854   17  292 3834.50144 14622.1663   281%  5638 1365s
  1928  1437 9106.23205   18  328 3834.50144 14622.1663   281%  5581 1397s
  2043  1510 8301.61899   22  283 3834.50144 14622.1663   281%  5545 1428s
  2156  1606 7642.96649   27  208 3834.50144 14488.6656   278%  5548 1457s
  2300  1714 6819.53284   38  186 3834.50144 14488.6656   278%  5509 1488s
H 2439  1714                    3899.6318520 14470.7096   271%  5505 1488s
  2442  1782 5405.30589   49  136 3899.63185 14470.7096   271%  5511 1520s
  2568  1887 infeasible   53      3899.63185 14470.7096   271%  5572 1554s
  2735  1972 12714.9983    5  250 3899.63185 14470.7096   271%  5568 1589s
  2906  2038 11114.1111    7  231 3899.63185 14470.7096   271%  5543 1627s
H 3055  2081                    3917.0500935 14388.0219   267%  5594 1661s
  3160  2168     cutoff   32      3917.05009 14266.7895   264%  5613 1700s
  3303  2287 11429.5999   14  498 3917.05009 14154.0529   261%  5690 1739s
  3494  2430 9236.16731   16  337 3917.05009 14154.0529   261%  5689 1778s
  3709  2532 8237.84858   19  289 3917.05009 14154.0529   261%  5648 1820s
  3967  2667     cutoff   23      3917.05009 14154.0529   261%  5571 1865s
  4213  2668 8710.32309   20  415 3917.05009 13991.2415   257%  5511 1981s
  4215  2669 9956.09879   18  217 3917.05009 13991.2415   257%  5509 1994s
  4216  2670 6158.69181   35  331 3917.05009 13991.2415   257%  5508 2056s
  4217  2671 8368.89503    9  383 3917.05009 13991.2415   257%  5506 2128s
  4218  2671 8327.18115   25  429 3917.05009 13991.2415   257%  5505 2172s
  4219  2672 5500.27093   31  401 3917.05009 13991.2415   257%  5504 2207s
  4220  2673 5875.68414   17  459 3917.05009 13991.2415   257%  5502 2224s
  4221  2673 12505.4048   10  409 3917.05009 13991.2415   257%  5501 2236s
  4222  2674 5480.26866   40  450 3917.05009 13991.2415   257%  5500 2247s
  4223  2675 11993.6576   19  451 3917.05009 13991.2415   257%  5498 2256s
  4224  2675 9511.75685   13  409 3917.05009 13991.2415   257%  5497 2260s
  4226  2677 11136.2780   10  412 3917.05009 13991.2415   257%  5494 2270s
  4227  2677 5247.63649   25  412 3917.05009 13991.2415   257%  5493 2275s
  4228  2678 9666.70884   14  391 3917.05009 13991.2415   257%  5492 2288s
  4229  2679 12485.3700   11  445 3917.05009 13991.2415   257%  5491 2296s
  4230  2679 7034.51628   17  400 3917.05009 13991.2415   257%  5489 2302s
  4231  2680 10290.4069   20  392 3917.05009 13991.2415   257%  5488 2307s
  4232  2681 12250.5825   12  408 3917.05009 13991.2415   257%  5487 2321s
  4233  2681 12536.7468   16  426 3917.05009 13991.2415   257%  5485 2327s
  4234  2682 5036.73467   37  472 3917.05009 13991.2415   257%  5484 2331s
  4235  2683 4612.49170   28  433 3917.05009 13991.2415   257%  5483 2337s
  4236  2683 8486.87757   13  495 3917.05009 13991.2415   257%  5482 2348s
  4237  2684 7326.07577   12  498 3917.05009 13991.2415   257%  5480 2359s
  4238  2685 4233.94132   47  486 3917.05009 13991.2415   257%  5479 2370s
  4240  2686 6487.75770   19  512 3917.05009 13991.2415   257%  5476 2400s
  4241  2687 5028.24850   39  460 3917.05009 13991.2415   257%  5475 2407s
  4242  2687 8976.23573   18  478 3917.05009 13991.2415   257%  5474 2420s
  4244  2689 8591.53481   21  422 3917.05009 13991.2415   257%  5471 2440s
  4245  2689 13223.8255   12  493 3917.05009 13991.2415   257%  5470 2446s
  4246  2690 11441.6786    7  411 3917.05009 13991.2415   257%  5469 2456s
  4247  2691 7684.57322   21  523 3917.05009 13991.2415   257%  5467 2464s
  4248  2691 8926.62592   20  453 3917.05009 13991.2415   257%  5466 2474s
  4249  2692 9341.80920   13  453 3917.05009 13991.2415   257%  5465 2496s
  4250  2693 9082.63970   15  453 3917.05009 13991.2415   257%  5463 2557s
  4251  2696 13991.2415   12  412 3917.05009 13991.2415   257%  5533 2594s
  4253  2699 13991.2415   13  451 3917.05009 13991.2415   257%  5535 2636s
  4256  2705 13991.2415   14  451 3917.05009 13991.2415   257%  5536 2675s
  4263  2716 13991.2415   15  420 3917.05009 13991.2415   257%  5545 2706s
  4277  2726 13991.2415   16  374 3917.05009 13991.2415   257%  5588 2782s
  4291  2753 12272.4869   17  310 3917.05009 13991.2415   257%  5614 2878s
  4323  2788 11800.1031   18  303 3917.05009 13991.2415   257%  5673 2926s
  4369  2813 11189.2404   23  279 3917.05009 13991.2415   257%  5694 2973s
  4426  2850 9923.53726   27  244 3917.05009 13991.2415   257%  5681 3020s
  4505  2867 6963.02067   30  225 3917.05009 13991.2415   257%  5690 3055s
  4570  2900 6481.72055   32  214 3917.05009 13991.2415   257%  5704 3089s
  4653  2927     cutoff   34      3917.05009 13991.2415   257%  5714 3136s
  4733  2937     cutoff   34      3917.05009 13918.8364   255%  5711 3165s
  4812  2934 5825.42328   32  192 3917.05009 13918.8364   255%  5727 3201s
  4882  2953 infeasible   35      3917.05009 13918.8364   255%  5728 3238s
  4955  2955     cutoff   35      3917.05009 13918.8364   255%  5742 3265s
  5022  2963     cutoff   30      3917.05009 13886.6556   255%  5772 3302s
  5094  2969 11865.4550   19  394 3917.05009 13886.6556   255%  5779 3327s
  5163  2962 10922.8008   20  316 3917.05009 13886.6556   255%  5783 3354s
  5238  2952 10504.4834   21  307 3917.05009 13886.6556   255%  5785 3386s
  5290  2959 9698.31623   22  294 3917.05009 13886.6556   255%  5805 3412s
  5346  2959 8132.25054   23  347 3917.05009 13886.6556   255%  5820 3444s
  5401  2964 8004.62083   24  346 3917.05009 13886.6556   255%  5827 3472s
  5469  2965 7054.24290   26  343 3917.05009 13886.6556   255%  5835 3502s
  5565  2975 6104.47543   28  303 3917.05009 13886.6556   255%  5816 3536s
  5643  2970 4433.97287   31  133 3917.05009 13886.6556   255%  5837 3564s
  5679  2982 4374.92120   32  116 3917.05009 13480.5309   244%  5849 3595s
  5735  2967     cutoff   33      3917.05009 13480.5309   244%  5845 3600s

Cutting planes:
  Learned: 2
  Gomory: 16
  Implied bound: 10
  Projected implied bound: 116
  MIR: 1151
  Mixing: 2
  Flow cover: 1568
  RLT: 30
  Relax-and-lift: 197

Explored 5754 nodes (33903380 simplex iterations) in 3600.07 seconds (6174.52 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 3917.05 3899.63 3834.5 ... 1730.65

Time limit reached
Best objective 3.917050093472e+03, best bound 1.348053090056e+04, gap 244.1501%
  WARNING: Time limit reached. Using best solution found (gap: 244.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 3917.05, θ = 146870.24
  Upper Bound (UB) = 3917.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146870.24
  [DEBUG]   ✓ Scenario 0: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146870.24 ≤ Q = 146870.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146870.24 ≤ Q = 146870.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x44d75a7d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbb28a583
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.312088e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6941285.6420
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.574880e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157487.99    0  126 6941285.64 -157487.99   102%     -    0s
H    0     0                    -118860.1848 -157487.99  32.5%     -    0s
H    0     0                    -119383.4020 -157487.99  31.9%     -    0s
     0     0 -130851.61    0  107 -119383.40 -130851.61  9.61%     -    0s
H    0     0                    -127171.1297 -130727.72  2.80%     -    0s
     0     0 -130198.64    0  101 -127171.13 -130198.64  2.38%     -    0s
H    0     0                    -129138.4488 -130178.80  0.81%     -    0s
H    0     0                    -129153.6729 -130178.80  0.79%     -    0s
     0     0 -129708.72    0   26 -129153.67 -129708.72  0.43%     -    0s
H    0     0                    -129170.3172 -129701.12  0.41%     -    0s
     0     0 -129701.12    0   27 -129170.32 -129701.12  0.41%     -    0s
     0     0 -129521.09    0   13 -129170.32 -129521.09  0.27%     -    0s
     0     0 -129492.20    0   10 -129170.32 -129492.20  0.25%     -    0s
H    0     0                    -129265.3813 -129492.20  0.18%     -    0s
     0     0 -129489.31    0   12 -129265.38 -129489.31  0.17%     -    0s
     0     0 -129410.69    0   11 -129265.38 -129410.69  0.11%     -    0s
     0     0 -129393.64    0   12 -129265.38 -129393.64  0.10%     -    0s
     0     0 -129352.18    0   12 -129265.38 -129352.18  0.07%     -    0s
     0     0 -129352.18    0   49 -129265.38 -129352.18  0.07%     -    0s
     0     0 -129352.18    0   49 -129265.38 -129352.18  0.07%     -    0s
H    0     0                    -129277.1536 -129352.18  0.06%     -    0s
     0     0 -129295.82    0    5 -129277.15 -129295.82  0.01%     -    0s
     0     0          -    0      -129277.15 -129288.03  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 17
  MIR: 41
  Flow cover: 4
  RLT: 1

Explored 1 nodes (799 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -129277 -129265 -129170 ... 1.31209e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.292771536382e+05, best bound -1.292880274474e+05, gap 0.0084%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 139984.25
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129277.15
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -129277.15 = 139984.25
  [DEBUG]   Current θ from Master = 146870.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6886.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2968.95
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 1168.4230, Absolute Gap = 1168.4230, Relative Gap = 0.298292
  Not converged yet (gap = 1168.42 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438069 nonzeros
Model fingerprint: 0xba328693
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 62760 rows and 25490 columns
Presolve time: 2.66s
Presolved: 91523 rows, 39170 columns, 555809 nonzeros
Variable types: 36911 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -319884.6976
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.959e+06
 Factor NZ  : 8.590e+06 (roughly 120 MB of memory)
 Factor Ops : 1.471e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62451136e+07  1.78547475e+08  9.99e+04 2.18e+01  7.12e+04     4s
   1  -1.21696238e+07  1.54775182e+08  7.03e+04 7.41e+01  4.99e+04     4s
   2  -4.08224451e+06  1.19886009e+08  2.36e+04 9.49e-12  1.77e+04     5s
   3  -9.35445339e+05  9.01617041e+07  1.98e+03 2.42e+00  1.92e+03     5s
   4  -5.97584928e+05  4.72485805e+07  5.81e+02 8.00e-01  6.53e+02     5s
   5  -5.14881752e+05  2.76073971e+07  2.84e+02 2.97e-02  3.31e+02     5s
   6  -3.82058159e+05  2.04533625e+07  1.30e+02 1.02e-11  1.94e+02     5s
   7  -2.64252472e+05  1.50250236e+07  3.31e+01 7.88e-12  1.07e+02     5s
   8  -1.56778591e+05  1.14230574e+07  1.36e+01 6.10e-12  7.43e+01     5s
   9  -1.15650037e+05  7.50396516e+06  7.35e+00 6.49e-12  4.74e+01     5s
  10  -9.10411739e+04  3.43001829e+06  4.56e+00 6.77e-12  2.16e+01     5s
  11  -5.75428275e+04  9.40530456e+05  2.48e+00 2.47e-12  6.07e+00     5s
  12  -2.77285155e+04  5.06908273e+05  1.39e+00 1.32e-12  3.23e+00     5s
  13  -1.79179490e+04  2.75692730e+05  9.40e-01 7.40e-13  1.77e+00     5s
  14  -8.78593516e+03  1.70009770e+05  6.51e-01 1.07e-03  1.07e+00     5s
  15  -2.18096012e+03  1.28580036e+05  5.03e-01 1.96e-04  7.84e-01     6s
  16   4.21917210e+03  9.67009654e+04  3.89e-01 6.61e-04  5.54e-01     6s
  17   8.20836710e+03  7.81066629e+04  3.28e-01 2.16e-03  4.19e-01     6s
  18   1.29054177e+04  6.74319488e+04  2.63e-01 2.01e-03  3.27e-01     6s
  19   1.81462638e+04  5.41740458e+04  1.94e-01 1.76e-03  2.16e-01     6s
  20   2.26193027e+04  5.02787670e+04  1.43e-01 1.94e-03  1.66e-01     6s
  21   2.51065339e+04  4.71237462e+04  1.15e-01 1.86e-03  1.32e-01     6s
  22   2.58600728e+04  4.45419149e+04  1.06e-01 1.79e-03  1.12e-01     6s
  23   2.99156596e+04  4.22143701e+04  6.17e-02 1.53e-03  7.36e-02     6s
  24   3.07617775e+04  4.00983394e+04  5.27e-02 8.59e-04  5.59e-02     6s
  25   3.14710285e+04  3.90431338e+04  4.51e-02 9.01e-04  4.53e-02     6s
  26   3.26410269e+04  3.83739030e+04  3.33e-02 1.18e-03  3.43e-02     6s
  27   3.32335307e+04  3.80005241e+04  2.74e-02 1.55e-03  2.85e-02     6s
  28   3.39463200e+04  3.77810575e+04  2.04e-02 1.43e-03  2.29e-02     7s
  29   3.40671868e+04  3.75958823e+04  1.92e-02 1.35e-03  2.11e-02     7s
  30   3.46089990e+04  3.73442948e+04  1.38e-02 1.04e-03  1.64e-02     7s
  31   3.49803030e+04  3.71214363e+04  1.04e-02 8.52e-04  1.28e-02     7s
  32   3.51307306e+04  3.70467321e+04  8.90e-03 7.92e-04  1.15e-02     7s
  33   3.53748882e+04  3.68476084e+04  6.54e-03 6.23e-04  8.80e-03     7s
  34   3.55548849e+04  3.67105523e+04  4.89e-03 5.05e-04  6.91e-03     7s
  35   3.57588650e+04  3.65172109e+04  3.09e-03 3.35e-04  4.53e-03     7s
  36   3.57990549e+04  3.63643369e+04  2.75e-03 1.94e-04  3.38e-03     7s
  37   3.58659076e+04  3.63165577e+04  2.20e-03 1.50e-04  2.69e-03     7s
  38   3.59468654e+04  3.62454157e+04  1.56e-03 8.10e-05  1.79e-03     7s
  39   3.60527043e+04  3.62253151e+04  7.13e-04 6.45e-05  1.03e-03     8s
  40   3.61001185e+04  3.61771859e+04  3.49e-04 6.69e-05  4.61e-04     8s
  41   3.61122090e+04  3.61657901e+04  2.58e-04 3.61e-05  3.20e-04     8s
  42   3.61257225e+04  3.61644013e+04  1.64e-04 3.30e-05  2.31e-04     8s
  43   3.61265850e+04  3.61620980e+04  1.58e-04 2.80e-05  2.12e-04     8s
  44   3.61296506e+04  3.61617977e+04  1.37e-04 2.71e-05  1.92e-04     8s
  45   3.61310432e+04  3.61578056e+04  1.27e-04 1.82e-05  1.60e-04     8s
  46   3.61438284e+04  3.61536174e+04  3.15e-05 1.32e-05  5.85e-05     8s
  47   3.61469787e+04  3.61504677e+04  1.35e-05 3.12e-06  2.08e-05     8s
  48   3.61489068e+04  3.61497285e+04  2.03e-06 1.02e-06  4.90e-06     8s
  49   3.61490275e+04  3.61495042e+04  1.48e-06 3.93e-07  2.85e-06     9s
  50   3.61491000e+04  3.61494851e+04  1.14e-06 3.46e-07  2.30e-06     9s
  51   3.61492157e+04  3.61494095e+04  6.00e-07 1.36e-07  1.16e-06     9s
  52   3.61493151e+04  3.61493768e+04  1.43e-07 5.85e-08  3.68e-07     9s
  53   3.61493512e+04  3.61493520e+04  1.48e-09 3.94e-09  4.91e-09     9s
  54   3.61493516e+04  3.61493516e+04  4.46e-10 3.29e-11  7.41e-13     9s

Barrier solved model in 54 iterations and 9.01 seconds (8.36 work units)
Optimal objective 3.61493516e+04


Root crossover log...

   79807 DPushes remaining with DInf 0.0000000e+00                 9s
    7706 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    1270 PPushes remaining with PInf 8.9405849e-07                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.3120499e-11     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31011    3.6149352e+04   0.000000e+00   0.000000e+00     11s
   31011    3.6149352e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.614935e+04, 31011 iterations, 7.66 seconds (8.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36149.3516    0  237 -191968.18 36149.3516   119%     -   11s
H    0     0                    -179216.8993 36149.3516   120%     -   11s
H    0     0                    -145941.1456 36149.3516   125%     -   12s
H    0     0                    -144313.1215 36149.3516   125%     -   12s
H    0     0                    -142932.4003 36149.3516   125%     -   12s
H    0     0                    -141793.3206 36149.3516   125%     -   12s
H    0     0                    -67757.64310 36149.3516   153%     -   12s
H    0     0                    -46815.15323 36149.3516   177%     -   12s
H    0     0                    -46366.95428 36149.3516   178%     -   12s
H    0     0                    -19866.92279 36149.3516   282%     -   12s
H    0     0                    -12422.35389 36149.3516   391%     -   12s
H    0     0                    -12205.75480 36149.3516   396%     -   13s
H    0     0                    -11927.94317 28570.7712   340%     -   63s
H    0     0                    -9209.153971 28570.7712   410%     -   63s
H    0     0                    -8974.319640 28570.7712   418%     -   63s
H    0     0                    -8788.215479 28570.7712   425%     -   63s
     0     0 28336.4585    0  346 -8788.2155 28336.4585   422%     -   63s
     0     0 27980.5484    0  360 -8788.2155 27980.5484   418%     -   74s
     0     0 27964.1392    0  354 -8788.2155 27964.1392   418%     -   92s
     0     0 27964.1392    0  354 -8788.2155 27964.1392   418%     -   95s
     0     0 27964.1392    0  351 -8788.2155 27964.1392   418%     -   96s
H    0     0                    -8646.376197 24889.6463   388%     -  149s
H    0     0                    -8595.231888 24889.6463   390%     -  149s
H    0     0                    -8559.563563 24889.6463   391%     -  149s
     0     0 24889.6463    0  407 -8559.5636 24889.6463   391%     -  149s
H    0     0                    -1875.392687 24889.6028  1427%     -  150s
H    0     0                    -1836.062781 24889.6028  1456%     -  150s
H    0     0                    -1834.993664 24889.6028  1456%     -  150s
H    0     0                    -1658.924201 24889.6028  1600%     -  150s
     0     0 24269.0389    0  464 -1658.9242 24269.0389  1563%     -  185s
     0     0 24009.6939    0  464 -1658.9242 24009.6939  1547%     -  206s
     0     0 23948.4113    0  466 -1658.9242 23948.4113  1544%     -  213s
     0     0 23946.3670    0  468 -1658.9242 23946.3670  1543%     -  215s
     0     0 23782.2721    0  391 -1658.9242 23782.2721  1534%     -  221s
     0     0 23774.2016    0  401 -1658.9242 23774.2016  1533%     -  224s
     0     0 23661.6929    0  468 -1658.9242 23661.6929  1526%     -  232s
     0     0 23562.5601    0  470 -1658.9242 23562.5601  1520%     -  241s
     0     0 23551.0865    0  471 -1658.9242 23551.0865  1520%     -  243s
     0     0 23541.0836    0  472 -1658.9242 23541.0836  1519%     -  246s
     0     0 23538.6113    0  470 -1658.9242 23538.6113  1519%     -  248s
     0     0 23534.5457    0  468 -1658.9242 23534.5457  1519%     -  249s
     0     0 23526.9731    0  482 -1658.9242 23526.9731  1518%     -  253s
     0     0 23519.7507    0  460 -1658.9242 23519.7507  1518%     -  256s
     0     0 23518.4069    0  461 -1658.9242 23518.4069  1518%     -  257s
H    0     0                    -952.9386973 20391.1859  2240%     -  336s
     0     0 20391.1859    0  458 -952.93870 20391.1859  2240%     -  336s
H    0     0                    -666.9096359 20391.1239  3158%     -  337s
     0     0 19930.8409    0  468 -666.90964 19930.8409  3089%     -  369s
     0     0 19704.6819    0  486 -666.90964 19704.6819  3055%     -  393s
     0     0 19360.7000    0  472 -666.90964 19360.7000  3003%     -  415s
     0     0 19318.2231    0  498 -666.90964 19318.2231  2997%     -  428s
     0     0 19265.1242    0  515 -666.90964 19265.1242  2989%     -  439s
     0     0 19249.0980    0  505 -666.90964 19249.0980  2986%     -  446s
     0     0 19204.6442    0  490 -666.90964 19204.6442  2980%     -  455s
     0     0 19178.8293    0  499 -666.90964 19178.8293  2976%     -  462s
     0     0 19149.5701    0  492 -666.90964 19149.5701  2971%     -  470s
     0     0 19142.0133    0  498 -666.90964 19142.0133  2970%     -  474s
     0     0 19113.6953    0  491 -666.90964 19113.6953  2966%     -  481s
     0     0 19110.1770    0  499 -666.90964 19110.1770  2965%     -  485s
     0     0 19108.7144    0  501 -666.90964 19108.7144  2965%     -  488s
     0     0 17867.9404    0  500 -666.90964 17867.9404  2779%     -  546s
     0     0 17245.3227    0  528 -666.90964 17245.3227  2686%     -  575s
H    0     0                    -434.8225523 17094.1646  4031%     -  588s
H    0     0                    -402.6809934 17094.1646  4345%     -  588s
H    0     0                    -254.9113227 17094.1646  6806%     -  588s
H    0     0                    -242.7167978 17094.1646  7143%     -  588s
H    0     0                    -188.6317210 17094.1646  9162%     -  588s
     0     0 17094.1646    0  532 -188.63172 17094.1646  9162%     -  588s
H    0     0                     180.9632172 17039.9473  9316%     -  598s
H    0     0                     325.7936837 17039.9473  5130%     -  598s
     0     0 17039.9473    0  541  325.79368 17039.9473  5130%     -  598s
     0     0 17025.0634    0  541  325.79368 17025.0634  5126%     -  604s
     0     0 17013.6074    0  537  325.79368 17013.6074  5122%     -  607s
     0     0 16987.5913    0  529  325.79368 16987.5913  5114%     -  613s
     0     0 16977.4337    0  526  325.79368 16977.4337  5111%     -  616s
     0     0 16972.6358    0  534  325.79368 16972.6358  5110%     -  618s
     0     0 16970.9504    0  537  325.79368 16970.9504  5109%     -  619s
H    0     0                     374.1746835 16630.7443  4345%     -  638s
     0     0 16630.7443    0  403  374.17468 16630.7443  4345%     -  638s
H    0     0                     644.1530060 16561.3844  2471%     -  650s
H    0     0                     708.3585405 16561.3844  2238%     -  650s
     0     0 16561.3844    0  480  708.35854 16561.3844  2238%     -  650s
     0     0 16526.6032    0  510  708.35854 16526.6032  2233%     -  657s
     0     0 16490.0457    0  429  708.35854 16490.0457  2228%     -  664s
     0     0 16480.5228    0  431  708.35854 16480.5228  2227%     -  668s
     0     0 16476.3499    0  427  708.35854 16476.3499  2226%     -  670s
     0     0 16474.5320    0  429  708.35854 16474.5320  2226%     -  671s
H    0     0                     711.4855711 16409.9119  2206%     -  680s
H    0     0                     794.3231442 16409.9119  1966%     -  680s
H    0     0                     817.4633694 16409.9119  1907%     -  680s
     0     0 16409.9119    0  395  817.46337 16409.9119  1907%     -  680s
     0     0 16393.8403    0  403  817.46337 16393.8403  1905%     -  687s
     0     0 16388.6161    0  406  817.46337 16388.6161  1905%     -  689s
     0     0 16383.6605    0  403  817.46337 16383.6605  1904%     -  692s
     0     0 16382.9367    0  407  817.46337 16382.9367  1904%     -  694s
     0     0 16301.1065    0  398  817.46337 16301.1065  1894%     -  706s
     0     0 16283.7500    0  408  817.46337 16283.7500  1892%     -  711s
     0     0 16278.3033    0  399  817.46337 16278.3033  1891%     -  712s
     0     0 16277.5611    0  402  817.46337 16277.5611  1891%     -  714s
     0     0 16249.3466    0  397  817.46337 16249.3466  1888%     -  719s
     0     0 16246.1234    0  399  817.46337 16246.1234  1887%     -  722s
     0     0 16235.7899    0  396  817.46337 16235.7899  1886%     -  727s
     0     0 16234.2138    0  396  817.46337 16234.2138  1886%     -  731s
     0     0 16226.8272    0  410  817.46337 16226.8272  1885%     -  738s
     0     0 16226.2514    0  410  817.46337 16226.2514  1885%     -  742s
H    0     0                     829.3159694 16225.7778  1857%     -  790s
H    0     0                     854.0111233 16225.7778  1800%     -  838s
H    0     0                    1149.5448957 16225.7778  1311%     -  839s
H    0     0                    1316.7387848 16225.7778  1132%     -  839s
H    0     0                    1578.7429573 16225.7778   928%     -  839s
H    0     0                    2297.0271924 16225.7778   606%     -  839s
H    0     0                    2366.1278579 16225.7778   586%     -  840s
H    0     0                    2475.5305490 16225.7778   555%     -  840s
H    0     2                    2794.0118550 16225.7778   481%     -  911s
     0     2 16225.7778    0  410 2794.01185 16225.7778   481%     -  911s
     1     4 15737.7074    1  485 2794.01185 16225.7778   481% 14637  933s
     3     8 15656.1039    2  471 2794.01185 16123.5914   477%  9458  974s
     7    16 15319.7435    3  495 2794.01185 15655.6908   460% 12960 1018s
    15    32 15027.5340    4  504 2794.01185 15319.2252   448% 15515 1045s
    31    48 14209.7133    5  472 2794.01185 15027.0365   438% 17645 1129s
    47    80 13166.3678    6  336 2794.01185 15027.0365   438% 18863 1169s
H   48    80                    2929.5773439 15027.0365   413% 18470 1169s
    79   150 12996.6961    7  344 2929.57734 15027.0365   413% 14834 1276s
   149   267 12789.1353    9  326 2929.57734 15027.0365   413% 10107 1323s
   272   301 11682.6850   12  247 2929.57734 15027.0365   413%  7363 1349s
H  296   301                    2986.8550255 15027.0365   403%  7115 1349s
   312   320 11253.6580   12  256 2986.85503 15027.0365   403%  7146 1378s
   336   353 12546.1066   11  319 2986.85503 15027.0365   403%  7235 1403s
   375   385 3644.90095   11  177 2986.85503 15027.0365   403%  7624 1428s
H  385   385                    3032.0128383 15027.0365   396%  7677 1428s
H  387   385                    3100.2840544 15027.0365   385%  7702 1428s
   407   455 3607.70536   11  173 3100.28405 15027.0365   385%  7782 1455s
   502   502 9986.45075   13  212 3100.28405 15027.0365   385%  7201 1480s
   577   547 10322.9207   13  373 3100.28405 15027.0365   385%  7015 1507s
   648   598 4417.68184   14  354 3100.28405 15027.0365   385%  6969 1532s
   731   635 9415.17675   14  292 3100.28405 15027.0365   385%  6800 1559s
   793   689 9506.77374   14  282 3100.28405 15027.0365   385%  6796 1582s
   861   748 8179.09538   16  307 3100.28405 15027.0365   385%  6807 1605s
   935   796 7835.69282   15  281 3100.28405 15027.0365   385%  6783 1628s
  1016   841 7755.28911   17  374 3100.28405 15027.0365   385%  6619 1650s
  1098   865 infeasible   17      3100.28405 15027.0365   385%  6560 1676s
  1200   897 6768.39597   31  280 3100.28405 15027.0365   385%  6420 1701s
  1300   928 5910.95687   32  320 3100.28405 15027.0365   385%  6260 1726s
H 1320   928                    3164.7065626 15027.0365   375%  6193 1726s
  1379   964 5633.43140   33  337 3164.70656 15027.0365   375%  6238 1753s
  1487  1016 3343.57365   37  148 3164.70656 15027.0365   375%  6164 1782s
  1596  1078 11036.9686    8  383 3164.70656 15027.0365   375%  6083 1809s
  1718  1117 10006.2877    9  445 3164.70656 15027.0365   375%  6061 1839s
  1825  1134 9881.14277   10  454 3164.70656 15027.0365   375%  6050 1871s
  1862  1186 9565.56407   11  391 3164.70656 15027.0365   375%  6106 1898s
  1924  1207 8588.06237   12  280 3164.70656 15027.0365   375%  6122 1935s
  1965  1235 6348.26523   13  358 3164.70656 15027.0365   375%  6145 2001s
  2045  1288 5666.47745   14  354 3164.70656 15027.0365   375%  6123 2053s
  2156  1369     cutoff   15      3164.70656 15027.0365   375%  6058 2089s
  2292  1427 4702.87398    9  245 3164.70656 15027.0365   375%  6000 2125s
  2434  1486 4053.02384   10  252 3164.70656 15027.0365   375%  5964 2165s
  2519  1541     cutoff   11      3164.70656 15027.0365   375%  6031 2203s
  2622  1597 8303.36820   10  206 3164.70656 14687.7431   364%  6120 2246s
  2717  1660 5417.32277   11  159 3164.70656 14687.7431   364%  6190 2289s
  2824  1728 3813.61297   12  136 3164.70656 14687.7431   364%  6236 2338s
  2956  1792 10645.0294    8  261 3164.70656 14687.7431   364%  6265 2382s
  3086  1853 8190.20668    9  231 3164.70656 14687.7431   364%  6318 2433s
  3217  1938 6388.32224   12  169 3164.70656 14687.7431   364%  6337 2486s
  3349  2040 4924.56137   15  237 3164.70656 14687.7431   364%  6395 2538s
  3474  2095 infeasible   16      3164.70656 14687.7431   364%  6461 2586s
  3594  2149 11348.3459   11  484 3164.70656 14687.7431   364%  6552 2645s
  3706  2212 8599.41224   11  443 3164.70656 13566.5300   329%  6656 2698s
  3827  2304 8923.71038   11  214 3164.70656 13307.8056   321%  6773 2758s
  3967  2403 9431.69454   13  327 3164.70656 13307.8056   321%  6887 2814s
  4167  2404 4652.94482   38  410 3164.70656 13307.8056   321%  6873 2967s
  4169  2405 12533.3978   15  197 3164.70656 13307.8056   321%  6870 2979s
  4170  2406 4483.11863   19  359 3164.70656 13307.8056   321%  6868 3042s
  4171  2407 8685.32877   11  333 3164.70656 13307.8056   321%  6866 3112s
  4172  2407 6150.82253   30  485 3164.70656 13307.8056   321%  6865 3160s
  4173  2408 10240.3649   10  403 3164.70656 13307.8056   321%  6863 3192s
  4174  2409 3917.31845   28  411 3164.70656 13307.8056   321%  6861 3216s
  4175  2409 5575.17019   17  428 3164.70656 13307.8056   321%  6860 3230s
  4176  2410 8892.35690   20  415 3164.70656 13307.8056   321%  6858 3238s
  4177  2411 10426.8814   13  413 3164.70656 13307.8056   321%  6857 3252s
  4178  2411 12656.3882   13  336 3164.70656 13307.8056   321%  6855 3274s
  4179  2412 4197.77929   34  421 3164.70656 13307.8056   321%  6853 3287s
  4180  2413 9297.90279   15  413 3164.70656 13307.8056   321%  6852 3296s
  4181  2413 6036.95753   31  419 3164.70656 13307.8056   321%  6850 3302s
  4182  2414 5584.84265   32  392 3164.70656 13307.8056   321%  6848 3308s
  4183  2415 11422.7832   15  397 3164.70656 13307.8056   321%  6847 3312s
  4184  2415 3911.62575   27  408 3164.70656 13307.8056   321%  6845 3316s
  4185  2416 4319.75741   20  403 3164.70656 13307.8056   321%  6843 3337s
  4186  2417 12236.4487   12  471 3164.70656 13307.8056   321%  6842 3344s
  4187  2417 5885.87810   41  422 3164.70656 13307.8056   321%  6840 3349s
  4188  2418 7560.85893   23  431 3164.70656 13307.8056   321%  6839 3363s
  4189  2419 6200.66366   16  410 3164.70656 13307.8056   321%  6837 3372s
  4190  2419 10665.3124   12  473 3164.70656 13307.8056   321%  6835 3386s
  4191  2420 8693.29860   12  419 3164.70656 13307.8056   321%  6834 3394s
  4192  2421 5286.92408   48  475 3164.70656 13307.8056   321%  6832 3401s
  4193  2421 5151.50832   22  449 3164.70656 13307.8056   321%  6830 3413s
  4194  2422 4536.49087   44  327 3164.70656 13307.8056   321%  6829 3419s
  4195  2423 7610.76850   13  444 3164.70656 13307.8056   321%  6827 3436s
  4196  2423 4300.80082   35  350 3164.70656 13307.8056   321%  6826 3441s
  4197  2424 12313.5311    9  486 3164.70656 13307.8056   321%  6824 3453s
  4198  2425 7314.55932   26  494 3164.70656 13307.8056   321%  6822 3461s
  4199  2425 8235.85843   18  404 3164.70656 13307.8056   321%  6821 3470s
  4200  2426 9746.49449   11  404 3164.70656 13307.8056   321%  6819 3485s
  4201  2427 13115.5618   13  404 3164.70656 13307.8056   321%  6817 3553s
  4202  2430 13307.8056   15  397 3164.70656 13307.8056   321%  6892 3596s

Cutting planes:
  Gomory: 37
  Implied bound: 26
  Projected implied bound: 258
  MIR: 959
  Mixing: 3
  Flow cover: 670
  RLT: 48
  Relax-and-lift: 174

Explored 4204 nodes (29487339 simplex iterations) in 3600.05 seconds (5829.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 3164.71 3100.28 3032.01 ... 1578.74

Time limit reached
Best objective 3.164706562635e+03, best bound 1.330780558213e+04, gap 320.5068%
  WARNING: Time limit reached. Using best solution found (gap: 320.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 3164.71, θ = 146386.49
  Upper Bound (UB) = 3164.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146386.49
  [DEBUG]   ✓ Scenario 0: θ = 146386.49 ≤ Q = 146386.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146386.49 ≤ Q = 146386.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146386.49 ≤ Q = 146386.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146386.49 ≤ Q = 146386.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146386.49 ≤ Q = 146386.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146386.49 ≤ Q = 146386.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146386.49 ≤ Q = 146386.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146386.49 ≤ Q = 146386.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146386.49 ≤ Q = 146386.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 146386.49 ≤ Q = 146386.49 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2209b1bd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xddf64e43
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.263607e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.01s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6463283.0161
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.627130e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162713.01    0  130 6463283.02 -162713.01   103%     -    0s
H    0     0                    -123926.0040 -162713.01  31.3%     -    0s
H    0     0                    -125130.3978 -162713.01  30.0%     -    0s
     0     0 -137620.52    0   67 -125130.40 -137620.52  10.0%     -    0s
H    0     0                    -135421.1763 -137602.64  1.61%     -    0s
     0     0 -137535.71    0   59 -135421.18 -137535.71  1.56%     -    0s
     0     0 -137525.64    0   65 -135421.18 -137525.64  1.55%     -    0s
H    0     0                    -136020.7940 -137525.64  1.11%     -    0s
     0     0 -137131.74    0   47 -136020.79 -137131.74  0.82%     -    0s
H    0     0                    -136058.2062 -137099.09  0.77%     -    0s
     0     0 -137072.70    0   46 -136058.21 -137072.70  0.75%     -    0s
     0     0 -136990.44    0   44 -136058.21 -136990.44  0.69%     -    0s
     0     0 -136942.78    0   44 -136058.21 -136942.78  0.65%     -    0s
H    0     0                    -136467.9852 -136942.78  0.35%     -    0s
     0     0 -136942.78    0   86 -136467.99 -136942.78  0.35%     -    0s
     0     0 -136942.78    0   47 -136467.99 -136942.78  0.35%     -    0s
     0     0 -136935.68    0   44 -136467.99 -136935.68  0.34%     -    0s
     0     0 -136934.76    0   44 -136467.99 -136934.76  0.34%     -    0s
     0     0 -136761.12    0   44 -136467.99 -136761.12  0.21%     -    0s
     0     0 -136755.52    0   43 -136467.99 -136755.52  0.21%     -    0s
     0     0 -136628.72    0   44 -136467.99 -136628.72  0.12%     -    0s
H    0     0                    -136525.5382 -136627.32  0.07%     -    0s
     0     0 -136570.09    0   45 -136525.54 -136570.09  0.03%     -    0s
     0     0 -136542.15    0   43 -136525.54 -136542.15  0.01%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 14
  MIR: 83
  Flow cover: 14
  RLT: 13
  Relax-and-lift: 1

Explored 1 nodes (996 simplex iterations) in 0.24 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -136526 -136468 -136058 ... 1.26361e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.365255381663e+05, best bound -1.365358371198e+05, gap 0.0075%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 132735.86
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136525.54
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -136525.54 = 132735.86
  [DEBUG]   Current θ from Master = 146386.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13650.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10485.93
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 416.0795, Absolute Gap = 416.0795, Relative Gap = 0.131475
  Not converged yet (gap = 416.08 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481324 nonzeros
Model fingerprint: 0xd287209e
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69042 rows and 28042 columns
Presolve time: 3.34s
Presolved: 100531 rows, 42858 columns, 607619 nonzeros
Variable types: 40599 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -322235.9304
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.573e+06
 Factor NZ  : 1.009e+07 (roughly 140 MB of memory)
 Factor Ops : 1.847e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68826242e+07  1.93331559e+08  1.04e+05 2.07e+01  7.34e+04     5s
   1  -1.27080540e+07  1.68420042e+08  7.32e+04 7.34e+01  5.16e+04     5s
   2  -4.33324483e+06  1.30934457e+08  2.48e+04 3.56e-11  1.85e+04     5s
   3  -1.78453466e+06  1.32633745e+08  8.16e+03 2.96e+01  6.57e+03     6s
   4  -1.20309207e+06  8.74612354e+07  4.76e+03 2.80e+00  3.70e+03     6s
   5  -5.65126612e+05  5.71117277e+07  8.80e+02 1.16e+00  8.77e+02     6s
   6  -4.42674123e+05  3.37831486e+07  3.88e+02 5.90e-01  4.12e+02     6s
   7  -3.57534464e+05  2.35270643e+07  1.88e+02 1.29e-11  2.31e+02     6s
   8  -2.56582472e+05  1.65542491e+07  8.11e+01 8.97e-12  1.31e+02     6s
   9  -1.72671936e+05  1.26248371e+07  3.74e+01 1.20e-11  8.53e+01     6s
  10  -1.08583123e+05  6.94284988e+06  1.61e+01 8.23e-12  4.28e+01     6s
  11  -7.66009356e+04  2.58586280e+06  7.38e+00 5.18e-12  1.54e+01     6s
  12  -5.72577834e+04  7.29633356e+05  4.83e+00 5.08e-03  4.51e+00     7s
  13  -2.91718995e+04  3.84611152e+05  3.14e+00 1.57e-12  2.34e+00     7s
  14  -2.10002963e+04  2.37167221e+05  2.25e+00 1.32e-12  1.44e+00     7s
  15  -1.15062940e+04  1.53452094e+05  1.55e+00 6.24e-13  9.16e-01     7s
  16  -1.89826843e+02  1.06688177e+05  9.11e-01 4.23e-13  5.89e-01     7s
  17   5.33101813e+03  8.88049991e+04  7.12e-01 6.21e-04  4.59e-01     7s
  18   1.12972360e+04  7.47609507e+04  5.27e-01 6.11e-04  3.49e-01     7s
  19   1.41469059e+04  5.69453795e+04  4.55e-01 1.53e-03  2.35e-01     7s
  20   1.64057545e+04  5.05739576e+04  3.99e-01 1.65e-03  1.88e-01     7s
  21   1.82239960e+04  4.71188887e+04  3.59e-01 1.89e-03  1.59e-01     7s
  22   1.99525304e+04  4.65208435e+04  3.23e-01 1.84e-03  1.46e-01     8s
  23   2.15989643e+04  4.46543426e+04  2.87e-01 1.29e-03  1.27e-01     8s
  24   2.41338807e+04  4.27002008e+04  2.35e-01 1.77e-03  1.02e-01     8s
  25   2.62313009e+04  4.07688779e+04  1.91e-01 1.79e-03  8.00e-02     8s
  26   2.75233553e+04  4.00800718e+04  1.66e-01 1.22e-03  6.91e-02     8s
  27   2.88093977e+04  3.89301852e+04  1.40e-01 1.02e-03  5.57e-02     8s
  28   2.96176396e+04  3.85830505e+04  1.24e-01 8.60e-04  4.94e-02     8s
  29   3.01271117e+04  3.80515118e+04  1.14e-01 1.07e-03  4.36e-02     8s
  30   3.09372222e+04  3.77242662e+04  9.65e-02 1.08e-03  3.74e-02     8s
  31   3.12872466e+04  3.73067962e+04  8.83e-02 1.11e-03  3.31e-02     9s
  32   3.16827809e+04  3.70481099e+04  7.98e-02 1.06e-03  2.95e-02     9s
  33   3.24669167e+04  3.66288923e+04  6.33e-02 8.67e-04  2.29e-02     9s
  34   3.29578293e+04  3.64166189e+04  5.26e-02 6.76e-04  1.90e-02     9s
  35   3.33006502e+04  3.62729947e+04  4.53e-02 5.45e-04  1.64e-02     9s
  36   3.38236198e+04  3.62217721e+04  3.47e-02 5.42e-04  1.32e-02     9s
  37   3.39608466e+04  3.60720800e+04  3.18e-02 4.78e-04  1.16e-02     9s
  38   3.41855964e+04  3.60322142e+04  2.75e-02 4.69e-04  1.02e-02     9s
  39   3.42834317e+04  3.59955400e+04  2.55e-02 4.41e-04  9.42e-03    10s
  40   3.43675113e+04  3.59429957e+04  2.37e-02 4.12e-04  8.67e-03    10s
  41   3.44531745e+04  3.58987186e+04  2.19e-02 3.85e-04  7.95e-03    10s
  42   3.47103912e+04  3.58345269e+04  1.68e-02 4.07e-04  6.18e-03    10s
  43   3.47510802e+04  3.58118147e+04  1.60e-02 4.49e-04  5.84e-03    10s
  44   3.47902659e+04  3.57715298e+04  1.52e-02 3.55e-04  5.40e-03    10s
  45   3.48674858e+04  3.57538491e+04  1.38e-02 4.07e-04  4.88e-03    10s
  46   3.49594453e+04  3.57268036e+04  1.20e-02 4.29e-04  4.22e-03    10s
  47   3.50730002e+04  3.57054317e+04  9.81e-03 3.95e-04  3.48e-03    10s
  48   3.51800087e+04  3.56897675e+04  7.89e-03 3.51e-04  2.81e-03    11s
  49   3.52684136e+04  3.56807640e+04  6.24e-03 2.66e-04  2.27e-03    11s
  50   3.53009958e+04  3.56679766e+04  5.62e-03 2.22e-04  2.02e-03    11s
  51   3.53982458e+04  3.56376360e+04  3.81e-03 1.26e-04  1.32e-03    11s
  52   3.54156081e+04  3.56305780e+04  3.49e-03 8.80e-05  1.18e-03    11s
  53   3.54377297e+04  3.56277203e+04  3.08e-03 6.91e-05  1.05e-03    11s
  54   3.54823588e+04  3.56240300e+04  2.26e-03 5.58e-05  7.80e-04    11s
  55   3.55127633e+04  3.56157811e+04  1.69e-03 2.64e-05  5.67e-04    12s
  56   3.55266295e+04  3.56157581e+04  1.45e-03 2.57e-05  4.91e-04    12s
  57   3.55520234e+04  3.56134881e+04  9.99e-04 4.99e-05  3.38e-04    12s
  58   3.55851034e+04  3.56116508e+04  4.21e-04 1.82e-05  1.46e-04    12s
  59   3.55949049e+04  3.56114945e+04  2.53e-04 1.67e-05  9.13e-05    12s
  60   3.55993863e+04  3.56111843e+04  1.78e-04 6.86e-06  6.49e-05    12s
  61   3.56022626e+04  3.56109424e+04  1.32e-04 3.14e-06  4.77e-05    12s
  62   3.56092224e+04  3.56107074e+04  1.95e-05 4.22e-06  8.15e-06    13s
  63   3.56105919e+04  3.56106219e+04  3.41e-07 1.62e-07  1.65e-07    13s
  64   3.56106158e+04  3.56106175e+04  4.09e-08 2.74e-08  9.53e-09    13s
  65   3.56106170e+04  3.56106175e+04  2.44e-07 5.96e-09  2.93e-09    13s
  66   3.56106175e+04  3.56106175e+04  1.58e-08 3.25e-11  2.70e-11    13s

Barrier solved model in 66 iterations and 13.02 seconds (10.20 work units)
Optimal objective 3.56106175e+04


Root crossover log...

   85834 DPushes remaining with DInf 0.0000000e+00                13s
    8120 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    1602 PPushes remaining with PInf 5.2779610e-06                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0684887e-02     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33273    3.5610618e+04   0.000000e+00   1.068489e-02     16s
   33274    3.5610618e+04   0.000000e+00   0.000000e+00     16s
   33274    3.5610618e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.561062e+04, 33274 iterations, 12.21 seconds (12.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35610.6175    0  287 -191968.18 35610.6175   119%     -   17s
H    0     0                    -184325.3256 35610.6175   119%     -   17s
H    0     0                    -163572.8745 35610.6175   122%     -   17s
H    0     0                    -162209.3939 35610.6175   122%     -   17s
H    0     0                    -161944.2124 35610.6175   122%     -   17s
H    0     0                    -68655.20820 35610.6175   152%     -   17s
H    0     0                    -43445.20117 35610.6175   182%     -   18s
H    0     0                    -43413.96446 35610.6175   182%     -   18s
H    0     0                    -16196.82629 35610.6175   320%     -   18s
H    0     0                    -14775.80315 35610.6175   341%     -   18s
H    0     0                    -13218.46765 35610.6175   369%     -   18s
H    0     0                    -10097.35132 28849.4092   386%     -   67s
H    0     0                    -10024.25356 28849.4092   388%     -   67s
H    0     0                    -9952.182055 28849.4092   390%     -   67s
H    0     0                    -9753.976599 28849.4092   396%     -   67s
H    0     0                    -9209.508426 28849.4092   413%     -   67s
     0     0 28818.8827    0  438 -9209.5084 28818.8827   413%     -   67s
H    0     0                    -9181.430233 28818.8827   414%     -   68s
H    0     0                    -9083.383276 28818.8827   417%     -   68s
H    0     0                    -8929.048645 28818.8827   423%     -   68s
H    0     0                    -8849.294222 28818.8827   426%     -   68s
     0     0 28513.9153    0  446 -8849.2942 28513.9153   422%     -   79s
     0     0 28339.5929    0  437 -8849.2942 28339.5929   420%     -   88s
     0     0 28315.9189    0  442 -8849.2942 28315.9189   420%     -   98s
     0     0 28315.9189    0  448 -8849.2942 28315.9189   420%     -  101s
     0     0 28315.9189    0  446 -8849.2942 28315.9189   420%     -  107s
     0     0 28311.6520    0  449 -8849.2942 28311.6520   420%     -  115s
     0     0 28306.3864    0  449 -8849.2942 28306.3864   420%     -  116s
     0     0 28306.3400    0  449 -8849.2942 28306.3400   420%     -  116s
H    0     0                    -6727.443591 24508.9131   464%     -  208s
H    0     0                    -6479.086580 24508.9131   478%     -  208s
H    0     0                    -6432.164231 24508.9131   481%     -  208s
     0     0 24508.9131    0  434 -6432.1642 24508.9131   481%     -  208s
H    0     0                     190.4890995 24508.6586      -     -  209s
     0     0 23705.1997    0  501  190.48910 23705.1997      -     -  274s
     0     0 23435.6872    0  524  190.48910 23435.6872      -     -  312s
     0     0 23397.2756    0  525  190.48910 23397.2756      -     -  332s
     0     0 23233.0744    0  508  190.48910 23233.0744      -     -  350s
     0     0 23102.5635    0  514  190.48910 23102.5635      -     -  369s
     0     0 22957.0613    0  506  190.48910 22957.0613      -     -  387s
     0     0 22948.7602    0  506  190.48910 22948.7602      -     -  394s
     0     0 22907.3689    0  496  190.48910 22907.3689      -     -  405s
     0     0 22805.8002    0  502  190.48910 22805.8002      -     -  420s
     0     0 22791.9291    0  513  190.48910 22791.9291      -     -  427s
     0     0 22791.6850    0  509  190.48910 22791.6850      -     -  429s
H    0     0                     770.2753247 20189.4437  2521%     -  535s
H    0     0                    1123.2771799 20189.4437  1697%     -  535s
H    0     0                    1129.6101436 20189.4437  1687%     -  535s
H    0     0                    1141.0270939 20189.4437  1669%     -  535s
H    0     0                    1295.5877960 20189.4437  1458%     -  535s
H    0     0                    1305.6127790 20189.4437  1446%     -  535s
     0     0 20189.4437    0  486 1305.61278 20189.4437  1446%     -  535s
H    0     0                    1313.9729648 20189.0091  1436%     -  535s
     0     0 19633.8951    0  554 1313.97296 19633.8951  1394%     -  584s
     0     0 19452.3776    0  562 1313.97296 19452.3776  1380%     -  610s
H    0     0                    1321.1074172 19334.4321  1364%     -  631s
H    0     0                    1347.4346830 19334.4321  1335%     -  631s
H    0     0                    1377.2058184 19334.4321  1304%     -  631s
H    0     0                    1381.9013612 19334.4321  1299%     -  631s
     0     0 19334.4321    0  555 1381.90136 19334.4321  1299%     -  631s
     0     0 19280.9589    0  551 1381.90136 19280.9589  1295%     -  643s
     0     0 19260.0539    0  558 1381.90136 19260.0539  1294%     -  651s
     0     0 19235.6824    0  559 1381.90136 19235.6824  1292%     -  657s
     0     0 19216.6552    0  601 1381.90136 19216.6552  1291%     -  666s
     0     0 19207.8728    0  602 1381.90136 19207.8728  1290%     -  672s
     0     0 19205.7988    0  559 1381.90136 19205.7988  1290%     -  674s
H    0     0                    1468.7099919 17803.4120  1112%     -  739s
H    0     0                    1478.8667769 17803.4120  1104%     -  739s
     0     0 17803.4120    0  469 1478.86678 17803.4120  1104%     -  739s
     0     0 17425.3862    0  509 1478.86678 17425.3862  1078%     -  773s
     0     0 17303.4036    0  467 1478.86678 17303.4036  1070%     -  797s
     0     0 17237.5615    0  475 1478.86678 17237.5615  1066%     -  816s
     0     0 17220.0787    0  486 1478.86678 17220.0787  1064%     -  821s
     0     0 17184.8600    0  478 1478.86678 17184.8600  1062%     -  829s
H    0     0                    1482.0366445 17167.3774  1058%     -  836s
H    0     0                    1492.7077872 17167.3774  1050%     -  836s
H    0     0                    1530.9206556 17167.3774  1021%     -  836s
H    0     0                    1545.8431531 17167.3774  1011%     -  836s
     0     0 17167.3774    0  523 1545.84315 17167.3774  1011%     -  837s
     0     0 17161.5918    0  526 1545.84315 17161.5918  1010%     -  840s
     0     0 17156.4369    0  513 1545.84315 17156.4369  1010%     -  843s
     0     0 17153.3515    0  481 1545.84315 17153.3515  1010%     -  845s
     0     0 17141.9395    0  524 1545.84315 17141.9395  1009%     -  849s
     0     0 17137.3408    0  516 1545.84315 17137.3408  1009%     -  851s
     0     0 17113.0200    0  522 1545.84315 17113.0200  1007%     -  856s
     0     0 17112.8430    0  517 1545.84315 17112.8430  1007%     -  857s
H    0     0                    1546.6731905 16777.7265   985%     -  880s
H    0     0                    1547.7731015 16777.7265   984%     -  880s
H    0     0                    1550.1852531 16777.7265   982%     -  880s
H    0     0                    1550.4877366 16777.7265   982%     -  880s
     0     0 16777.7265    0  452 1550.48774 16777.7265   982%     -  880s
     0     0 16680.4297    0  412 1550.48774 16680.4297   976%     -  895s
     0     0 16652.1473    0  414 1550.48774 16652.1473   974%     -  905s
     0     0 16642.2555    0  422 1550.48774 16642.2555   973%     -  913s
     0     0 16635.0324    0  414 1550.48774 16635.0324   973%     -  920s
     0     0 16612.0382    0  415 1550.48774 16612.0382   971%     -  928s
     0     0 16606.5777    0  413 1550.48774 16606.5777   971%     -  933s
     0     0 16592.5284    0  401 1550.48774 16592.5284   970%     -  940s
     0     0 16590.7409    0  409 1550.48774 16590.7409   970%     -  944s
     0     0 16501.3013    0  488 1550.48774 16501.3013   964%     -  973s
     0     0 16461.3246    0  402 1550.48774 16461.3246   962%     -  982s
     0     0 16447.1724    0  402 1550.48774 16447.1724   961%     -  988s
     0     0 16445.7944    0  398 1550.48774 16445.7944   961%     -  990s
     0     0 16356.4675    0  510 1550.48774 16356.4675   955%     - 1007s
     0     0 16332.0526    0  513 1550.48774 16332.0526   953%     - 1018s
     0     0 16328.9792    0  523 1550.48774 16328.9792   953%     - 1021s
     0     0 16295.2959    0  566 1550.48774 16295.2959   951%     - 1042s
     0     0 16286.2771    0  628 1550.48774 16286.2771   950%     - 1057s
     0     0 16283.5534    0  647 1550.48774 16283.5534   950%     - 1062s
     0     0 16259.8368    0  532 1550.48774 16259.8368   949%     - 1074s
     0     0 16235.5140    0  616 1550.48774 16235.5140   947%     - 1085s
     0     0 16231.9683    0  445 1550.48774 16231.9683   947%     - 1089s
     0     0 16230.3858    0  453 1550.48774 16230.3858   947%     - 1091s
     0     0 16211.6284    0  428 1550.48774 16211.6284   946%     - 1101s
H    0     0                    1553.9902880 16211.5907   943%     - 1105s
     0     0 16199.1881    0  432 1553.99029 16199.1881   942%     - 1113s
     0     0 16196.4030    0  437 1553.99029 16196.4030   942%     - 1116s
     0     0 16187.2508    0  434 1553.99029 16187.2508   942%     - 1123s
     0     0 16183.7767    0  616 1553.99029 16183.7767   941%     - 1130s
     0     0 16181.4655    0  426 1553.99029 16181.4655   941%     - 1133s
     0     0 16167.4642    0  440 1553.99029 16167.4642   940%     - 1140s
     0     0 16167.3110    0  440 1553.99029 16167.3110   940%     - 1144s
H    0     0                    2021.6443313 16167.0159   700%     - 1287s
H    0     0                    2286.6828362 16167.0159   607%     - 1302s
H    0     0                    2358.7528794 16167.0159   585%     - 1302s
H    0     0                    2485.8873961 16167.0159   550%     - 1302s
H    0     0                    2538.3048101 16167.0159   537%     - 1304s
     0     2 16167.0159    0  440 2538.30481 16167.0159   537%     - 1320s
     1     3 16012.9246    1  579 2538.30481 16166.9290   537% 13470 1344s
     2     6 14792.3188    2  516 2538.30481 16166.9290   537% 16430 1378s
     5    12 14160.7116    3  470 2538.30481 15712.7995   519% 13331 1420s
    11    24 14039.7077    4  480 2538.30481 15517.6628   511% 13904 1460s
    23    36 13982.3028    5  599 2538.30481 15132.0356   496% 21680 1559s
    35    68 13258.4745    5  421 2538.30481 15132.0356   496% 19912 1763s
H   48    68                    3208.0716135 15132.0356   372% 18173 1763s
H   55    68                    3219.6905660 15132.0356   370% 17623 1763s
    67   214 12980.6189    6  482 3219.69057 14703.3351   357% 23765 1838s
   213   284 12871.3888   12  433 3219.69057 14702.7532   357% 12074 1874s
H  276   284                    3242.9197000 14702.7532   353% 10210 1874s
   283   341 12759.8809    9  415 3242.91970 14702.7532   353% 10088 1904s
   340   394 12352.2199    9  308 3242.91970 14702.7532   353%  9518 1932s
   397   440 12286.0554   10  307 3242.91970 14702.7532   353%  9131 1959s
   447   467 11170.5163   10  242 3242.91970 14702.7532   353%  8803 1983s
H  449   467                    3630.8176308 14702.7532   305%  8792 1983s
   496   493     cutoff   18      3630.81763 14702.7532   305%  8625 2011s
   555   505 7113.90024   11  190 3630.81763 14702.7532   305%  8376 2035s
H  562   505                    3796.7602822 14702.7532   287%  8363 2035s
   593   528 5185.69367   12  165 3796.76028 14702.7532   287%  8349 2064s
   646   544 6843.12957   12  202 3796.76028 14702.7532   287%  8168 2092s
   691   574     cutoff   13      3796.76028 14702.7532   287%  8153 2118s
   743   624 4813.91607   13  171 3796.76028 14481.7374   281%  8203 2146s
H  749   624                    3821.8764107 14481.7374   279%  8191 2146s
H  790   624                    3834.5014407 14481.7374   278%  8008 2146s
   811   683     cutoff   15      3834.50144 14481.7374   278%  8079 2173s
   892   743 4747.80204   15  189 3834.50144 14481.7374   278%  7821 2201s
   990   761 infeasible   15      3834.50144 14481.7374   278%  7362 2231s
  1082   788 4252.24889   18  163 3834.50144 14481.7374   278%  7085 2269s
  1147   806 infeasible   20      3834.50144 14481.7374   278%  6895 2307s
  1228   825 9577.69007   15  392 3834.50144 14481.7374   278%  6827 2338s
  1265   857 9510.74260   16  384 3834.50144 14481.7374   278%  6909 2403s
  1309   879 6084.78624   17  387 3834.50144 14481.7374   278%  6985 2430s
  1341   905 6050.11187   18  398 3834.50144 14481.7374   278%  7041 2460s
  1383   931 5974.06319   19  382 3834.50144 14481.7374   278%  7090 2488s
  1433   957 5787.75844   20  371 3834.50144 14481.7374   278%  7108 2521s
  1487  1006 5155.20601   21  352 3834.50144 14481.7374   278%  7156 2556s
  1562  1039 infeasible   22      3834.50144 14481.7374   278%  7119 2587s
  1635  1058 5003.96546   23  360 3834.50144 14481.7374   278%  7077 2623s
  1690  1101 infeasible   24      3834.50144 14481.7374   278%  7116 2663s
  1749  1138 infeasible   25      3834.50144 14481.7374   278%  7258 2703s
  1822  1161 infeasible   26      3834.50144 14481.7374   278%  7303 2742s
  1903  1221 7205.95115   21  328 3834.50144 14481.7374   278%  7344 2783s
  1993  1279 6829.66604   24  316 3834.50144 14481.7374   278%  7426 2859s
  2059  1349 6597.68763   28  235 3834.50144 14481.7374   278%  7538 2903s
  2169  1425 6335.27081   29  229 3834.50144 14481.7374   278%  7527 2951s
  2307  1511 6195.96964   33  249 3834.50144 14481.7374   278%  7546 3001s
  2467  1564 5628.67791   42  237 3834.50144 14481.7374   278%  7493 3058s
  2618  1599 infeasible   45      3834.50144 14481.7374   278%  7472 3115s
  2725  1642 7130.58280   15  402 3834.50144 14481.7374   278%  7595 3175s
  2840  1736 infeasible   17      3834.50144 13678.2261   257%  7721 3237s
  2974  1829     cutoff   18      3834.50144 13678.2261   257%  7785 3298s
  3172  1873 8163.36311   12  216 3834.50144 13678.2261   257%  7679 3370s
  3313  1933 infeasible   17      3834.50144 13547.1147   253%  7690 3440s
  3420  2007 10648.9104   14  538 3834.50144 13547.1147   253%  7836 3511s
  3554  2027 6137.35445   17  397 3834.50144 13481.4628   252%  7950 3575s
  3596  2051 4792.31197   18  347 3834.50144 13481.4628   252%  8021 3600s

Cutting planes:
  Learned: 1
  Gomory: 14
  Implied bound: 217
  MIR: 3245
  Flow cover: 2871
  RLT: 161
  Relax-and-lift: 893

Explored 3624 nodes (29807421 simplex iterations) in 3600.08 seconds (5613.80 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 3834.5 3821.88 3796.76 ... 2358.75

Time limit reached
Best objective 3.834501440736e+03, best bound 1.348146284680e+04, gap 251.5832%
  WARNING: Time limit reached. Using best solution found (gap: 251.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 3834.50, θ = 146876.18
  Upper Bound (UB) = 3834.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146876.18
  [DEBUG]   ✓ Scenario 0: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 146876.18 ≤ Q = 146876.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 146876.18 ≤ Q = 146876.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3ee59e04
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc11a61fc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.318092e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6973004.4965
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.574650e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157465.03    0  126 6973004.50 -157465.03   102%     -    0s
H    0     0                    -118782.1260 -157465.03  32.6%     -    0s
H    0     0                    -119227.8658 -157465.03  32.1%     -    0s
     0     0 -129154.68    0   76 -119227.87 -129154.68  8.33%     -    0s
H    0     0                    -126272.8862 -129136.73  2.27%     -    0s
H    0     0                    -126562.0011 -129136.73  2.03%     -    0s
H    0     0                    -126908.4433 -129136.73  1.76%     -    0s
H    0     0                    -127197.5581 -129136.73  1.52%     -    0s
     0     0 -128582.00    0   76 -127197.56 -128582.00  1.09%     -    0s
     0     0 -128299.13    0   67 -127197.56 -128299.13  0.87%     -    0s
     0     0 -128258.17    0   74 -127197.56 -128258.17  0.83%     -    0s
     0     0 -128252.33    0   68 -127197.56 -128252.33  0.83%     -    0s
     0     0 -127950.09    0   55 -127197.56 -127950.09  0.59%     -    0s
     0     0 -127916.91    0   61 -127197.56 -127916.91  0.57%     -    0s
     0     0 -127688.25    0   51 -127197.56 -127688.25  0.39%     -    0s
     0     0 -127672.93    0   50 -127197.56 -127672.93  0.37%     -    0s
     0     0 -127672.93    0   46 -127197.56 -127672.93  0.37%     -    0s
     0     0 -127609.00    0   47 -127197.56 -127609.00  0.32%     -    0s
     0     0 -127604.04    0   47 -127197.56 -127604.04  0.32%     -    0s
     0     0 -127599.65    0   76 -127197.56 -127599.65  0.32%     -    0s
     0     0 -127599.65    0   56 -127197.56 -127599.65  0.32%     -    0s
H    0     0                    -127202.9503 -127537.96  0.26%     -    0s
     0     0 -127525.98    0   40 -127202.95 -127525.98  0.25%     -    0s
     0     0 -127522.11    0   40 -127202.95 -127522.11  0.25%     -    0s
     0     0 -127522.10    0   42 -127202.95 -127522.10  0.25%     -    0s
     0     0 -127450.01    0   22 -127202.95 -127450.01  0.19%     -    0s
     0     0 -127449.92    0    9 -127202.95 -127449.92  0.19%     -    0s
H    0     0                    -127250.8695 -127438.96  0.15%     -    0s
H    0     0                    -127262.4812 -127436.00  0.14%     -    0s
     0     0 -127436.00    0   10 -127262.48 -127436.00  0.14%     -    0s
     0     0 -127384.92    0    9 -127262.48 -127384.92  0.10%     -    0s
     0     0 -127304.82    0   11 -127262.48 -127304.82  0.03%     -    0s
     0     0 -127304.82    0   12 -127262.48 -127304.82  0.03%     -    0s
H    0     0                    -127267.1816 -127304.82  0.03%     -    0s
     0     0          -    0      -127267.18 -127277.08  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 3
  MIR: 7
  Flow cover: 5

Explored 1 nodes (1263 simplex iterations) in 0.32 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -127267 -127262 -127251 ... 1.31809e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.272671816497e+05, best bound -1.272770789772e+05, gap 0.0078%
  Subproblem solved in 0.35s
  Worst-case operational profit (Z_SP) = 141994.22
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127267.18
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -127267.18 = 141994.22
  [DEBUG]   Current θ from Master = 146876.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4881.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1047.46
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 1085.8744, Absolute Gap = 1085.8744, Relative Gap = 0.283185
  Not converged yet (gap = 1085.87 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524579 nonzeros
Model fingerprint: 0x28835bdd
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75324 rows and 30594 columns
Presolve time: 3.14s
Presolved: 109539 rows, 46546 columns, 660107 nonzeros
Variable types: 44287 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -323225.4013
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 665
 AA' NZ     : 3.796e+06
 Factor NZ  : 9.163e+06 (roughly 140 MB of memory)
 Factor Ops : 1.759e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.75080622e+07  2.08650126e+08  1.08e+05 2.00e+01  7.56e+04     5s
   1  -1.33016357e+07  1.82786672e+08  7.60e+04 7.33e+01  5.30e+04     5s
   2  -4.30473606e+06  1.37018346e+08  2.42e+04 5.99e-01  1.80e+04     5s
   3  -8.64725344e+05  9.44629362e+07  1.84e+03 9.85e-01  1.74e+03     6s
   4  -5.70751136e+05  3.64479833e+07  6.66e+02 1.69e-01  5.84e+02     6s
   5  -4.36084452e+05  2.32744136e+07  3.13e+02 8.47e-02  2.91e+02     6s
   6  -2.91409466e+05  1.81837533e+07  1.27e+02 5.68e-02  1.58e+02     6s
   7  -1.75775499e+05  1.33783754e+07  4.16e+01 3.75e-02  8.63e+01     6s
   8  -1.11639116e+05  1.02095295e+07  2.04e+01 2.74e-02  5.91e+01     6s
   9  -8.10137275e+04  3.45769981e+06  8.85e+00 6.96e-03  1.92e+01     6s
  10  -6.20613174e+04  1.58092789e+06  5.37e+00 2.96e-03  8.67e+00     6s
  11  -3.11849439e+04  5.90796151e+05  2.45e+00 1.04e-03  3.19e+00     6s
  12  -2.32269858e+04  3.59085959e+05  1.87e+00 6.79e-04  1.95e+00     6s
  13  -1.20939184e+04  1.85959405e+05  1.06e+00 7.85e-04  1.00e+00     6s
  14  -2.57101697e+03  1.37169474e+05  6.30e-01 9.88e-04  7.03e-01     7s
  15  -5.21848210e+02  1.20930556e+05  5.71e-01 6.99e-04  6.11e-01     7s
  16   4.60501564e+03  8.80523095e+04  4.49e-01 1.64e-03  4.20e-01     7s
  17   7.88809888e+03  7.77014191e+04  3.87e-01 1.26e-03  3.51e-01     7s
  18   1.25975246e+04  7.01829335e+04  3.03e-01 1.46e-03  2.89e-01     7s
  19   1.55260009e+04  5.86450836e+04  2.57e-01 1.57e-03  2.17e-01     7s
  20   1.78911434e+04  5.43107743e+04  2.22e-01 1.43e-03  1.83e-01     7s
  21   2.06942484e+04  5.21641295e+04  1.81e-01 1.38e-03  1.58e-01     7s
  22   2.16008557e+04  4.67439369e+04  1.69e-01 1.64e-03  1.26e-01     7s
  23   2.33608394e+04  4.45802642e+04  1.46e-01 1.39e-03  1.07e-01     8s
  24   2.59000718e+04  4.29224034e+04  1.15e-01 1.63e-03  8.55e-02     8s
  25   2.74208518e+04  4.21205520e+04  9.60e-02 1.65e-03  7.38e-02     8s
  26   2.93312094e+04  3.93622583e+04  7.37e-02 1.64e-03  5.04e-02     8s
  27   2.96417830e+04  3.85706420e+04  6.97e-02 1.84e-03  4.49e-02     8s
  28   3.00254462e+04  3.79292579e+04  6.53e-02 9.65e-04  3.97e-02     8s
  29   3.07067900e+04  3.75859706e+04  5.75e-02 8.30e-04  3.46e-02     8s
  30   3.11281895e+04  3.74668248e+04  5.28e-02 8.53e-04  3.19e-02     8s
  31   3.20095551e+04  3.72060059e+04  4.30e-02 9.92e-04  2.61e-02     8s
  32   3.27107701e+04  3.71037648e+04  3.51e-02 1.02e-03  2.21e-02     8s
  33   3.28071469e+04  3.68391530e+04  3.36e-02 8.33e-04  2.03e-02     9s
  34   3.30718488e+04  3.67581011e+04  3.06e-02 1.00e-03  1.85e-02     9s
  35   3.34948985e+04  3.66067850e+04  2.57e-02 1.18e-03  1.56e-02     9s
  36   3.36350349e+04  3.65877373e+04  2.41e-02 1.16e-03  1.48e-02     9s
  37   3.38945070e+04  3.65107881e+04  2.12e-02 1.09e-03  1.31e-02     9s
  38   3.40065216e+04  3.64753383e+04  1.99e-02 1.11e-03  1.24e-02     9s
  39   3.41997675e+04  3.64152127e+04  1.78e-02 1.02e-03  1.11e-02     9s
  40   3.43856383e+04  3.63042437e+04  1.58e-02 7.91e-04  9.64e-03     9s
  41   3.45837960e+04  3.62524962e+04  1.35e-02 7.10e-04  8.38e-03    10s
  42   3.48531478e+04  3.62058496e+04  1.06e-02 5.87e-04  6.79e-03    10s
  43   3.49591470e+04  3.61671936e+04  9.50e-03 5.05e-04  6.07e-03    10s
  44   3.50893673e+04  3.60998870e+04  8.08e-03 3.78e-04  5.08e-03    10s
  45   3.52454166e+04  3.60876473e+04  6.41e-03 3.58e-04  4.23e-03    10s
  46   3.53796272e+04  3.59904547e+04  5.02e-03 1.84e-04  3.07e-03    10s
  47   3.54326315e+04  3.59751045e+04  4.45e-03 1.70e-04  2.72e-03    10s
  48   3.54861651e+04  3.59713507e+04  3.90e-03 1.63e-04  2.44e-03    10s
  49   3.55620595e+04  3.59579746e+04  3.13e-03 1.38e-04  1.99e-03    11s
  50   3.57054994e+04  3.59243895e+04  1.68e-03 8.29e-05  1.10e-03    11s
  51   3.57432788e+04  3.59014006e+04  1.29e-03 4.50e-05  7.94e-04    11s
  52   3.57492270e+04  3.58998323e+04  1.22e-03 4.32e-05  7.56e-04    11s
  53   3.57533573e+04  3.58979033e+04  1.18e-03 4.06e-05  7.26e-04    11s
  54   3.57699660e+04  3.58921843e+04  1.01e-03 3.14e-05  6.14e-04    11s
  55   3.58011973e+04  3.58845936e+04  7.03e-04 3.16e-05  4.19e-04    11s
  56   3.58331993e+04  3.58805438e+04  3.83e-04 2.05e-05  2.38e-04    11s
  57   3.58577041e+04  3.58748508e+04  1.45e-04 7.46e-06  8.61e-05    12s
  58   3.58613681e+04  3.58742837e+04  1.09e-04 4.07e-06  6.49e-05    12s
  59   3.58637809e+04  3.58742015e+04  8.71e-05 3.55e-06  5.23e-05    12s
  60   3.58679239e+04  3.58741434e+04  5.00e-05 3.14e-06  3.12e-05    12s
  61   3.58705952e+04  3.58737876e+04  2.60e-05 1.75e-06  1.60e-05    12s
  62   3.58733185e+04  3.58737274e+04  5.28e-06 3.79e-07  2.05e-06    12s
  63   3.58737025e+04  3.58737051e+04  4.31e-08 7.17e-09  1.31e-08    12s
  64   3.58737042e+04  3.58737045e+04  5.82e-08 1.49e-10  1.56e-09    12s

Barrier solved model in 64 iterations and 12.33 seconds (10.54 work units)
Optimal objective 3.58737042e+04


Root crossover log...

   95943 DPushes remaining with DInf 0.0000000e+00                12s
   10211 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   19706 PPushes remaining with PInf 7.2466729e-05                16s
       0 PPushes remaining with PInf 9.5722843e-09                18s

  Push phase complete: Pinf 9.5722843e-09, Dinf 6.6592600e+07     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63757    3.5873563e+04   0.000000e+00   6.659260e+07     18s
   64687    3.5873563e+04   0.000000e+00   1.372788e+05     20s
   67982    3.5873704e+04   0.000000e+00   0.000000e+00     24s
   67982    3.5873704e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 1.53s

Solved with barrier

Root relaxation: objective 3.587370e+04, 67982 iterations, 21.85 seconds (27.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35873.7045    0  228 -191968.18 35873.7045   119%     -   26s
H    0     0                    -183470.8642 35873.7045   120%     -   26s
H    0     0                    -62957.05297 35873.7045   157%     -   27s
H    0     0                    -24866.93978 35873.7045   244%     -   27s
H    0     0                    -24848.85048 35873.7045   244%     -   27s
H    0     0                    -11235.12913 35873.7045   419%     -   29s
H    0     0                    -7393.548320 35873.7045   585%     -   29s
H    0     0                    -7128.418829 35873.7045   603%     -   29s
     0     0 28422.0778    0  409 -7128.4188 28422.0778   499%     -  110s
H    0     0                    -7109.760567 28422.0778   500%     -  112s
H    0     0                    -7071.568112 28422.0778   502%     -  112s
H    0     0                    -7008.524615 28422.0778   506%     -  112s
H    0     0                    -6988.691593 28422.0778   507%     -  112s
H    0     0                    -6983.488793 28422.0778   507%     -  112s
     0     0 28289.1822    0  413 -6983.4888 28289.1822   505%     -  119s
     0     0 28289.1822    0  415 -6983.4888 28289.1822   505%     -  133s
     0     0 28289.1822    0  412 -6983.4888 28289.1822   505%     -  138s
     0     0 28289.1822    0  416 -6983.4888 28289.1822   505%     -  143s
     0     0 28289.1822    0  409 -6983.4888 28289.1822   505%     -  146s
     0     0 28289.1822    0  426 -6983.4888 28289.1822   505%     -  148s
     0     0 28289.1822    0  412 -6983.4888 28289.1822   505%     -  161s
     0     0 28289.1822    0  412 -6983.4888 28289.1822   505%     -  163s
     0     0 28289.1822    0  412 -6983.4888 28289.1822   505%     -  163s
     0     0 24296.4672    0  435 -6983.4888 24296.4672   448%     -  287s
H    0     0                    -2592.873596 24296.3150  1037%     -  288s
H    0     0                    -1449.962164 24296.3150  1776%     -  288s
H    0     0                    -752.7354528 24296.3150  3328%     -  288s
H    0     0                    -306.8708434 24296.3150  8017%     -  288s
H    0     0                      64.2386582 24296.3150      -     -  288s
H    0     0                      78.7837910 24296.3150      -     -  288s
     0     0 23406.4581    0  487   78.78379 23406.4581      -     -  349s
     0     0 23107.5088    0  506   78.78379 23107.5088      -     -  378s
     0     0 22621.9178    0  522   78.78379 22621.9178      -     -  413s
     0     0 22530.4981    0  532   78.78379 22530.4981      -     -  431s
     0     0 22435.4559    0  539   78.78379 22435.4559      -     -  447s
     0     0 22412.7333    0  528   78.78379 22412.7333      -     -  454s
     0     0 22351.0194    0  519   78.78379 22351.0194      -     -  467s
H    0     0                     845.3247755 22340.0224  2543%     -  474s
H    0     0                    1017.2514900 22340.0224  2096%     -  474s
H    0     0                    1022.3911091 22340.0224  2085%     -  474s
     0     0 22340.0224    0  535 1022.39111 22340.0224  2085%     -  474s
     0     0 22334.6759    0  522 1022.39111 22334.6759  2085%     -  477s
H    0     0                    1164.7216151 22319.8585  1816%     -  482s
H    0     0                    1186.5046948 22319.8585  1781%     -  482s
H    0     0                    1192.0882719 22319.8585  1772%     -  482s
H    0     0                    1264.8536667 22319.8585  1665%     -  482s
H    0     0                    1272.7090397 22319.8585  1654%     -  482s
     0     0 22319.8585    0  521 1272.70904 22319.8585  1654%     -  482s
     0     0 22204.4876    0  540 1272.70904 22204.4876  1645%     -  498s
     0     0 22182.2382    0  541 1272.70904 22182.2382  1643%     -  509s
     0     0 22176.7627    0  551 1272.70904 22176.7627  1642%     -  514s
     0     0 22175.6130    0  545 1272.70904 22175.6130  1642%     -  516s
     0     0 19963.5078    0  490 1272.70904 19963.5078  1469%     -  644s
     0     0 19479.2545    0  490 1272.70904 19479.2545  1431%     -  700s
     0     0 19312.2099    0  493 1272.70904 19312.2099  1417%     -  732s
     0     0 19228.2764    0  556 1272.70904 19228.2764  1411%     -  751s
     0     0 19162.5597    0  558 1272.70904 19162.5597  1406%     -  766s
     0     0 19146.8438    0  562 1272.70904 19146.8438  1404%     -  774s
     0     0 19130.0728    0  552 1272.70904 19130.0728  1403%     -  783s
     0     0 19115.1531    0  565 1272.70904 19115.1531  1402%     -  793s
     0     0 19103.6218    0  656 1272.70904 19103.6218  1401%     -  800s
     0     0 19084.8899    0  587 1272.70904 19084.8899  1400%     -  810s
     0     0 19072.8584    0  568 1272.70904 19072.8584  1399%     -  817s
     0     0 19066.0793    0  570 1272.70904 19066.0793  1398%     -  822s
     0     0 19064.8241    0  578 1272.70904 19064.8241  1398%     -  823s
H    0     0                    1275.2502034 17647.0447  1284%     -  911s
     0     0 17647.0447    0  521 1275.25020 17647.0447  1284%     -  911s
     0     0 17172.4500    0  502 1275.25020 17172.4500  1247%     -  954s
     0     0 17028.3688    0  527 1275.25020 17028.3688  1235%     -  982s
     0     0 16946.4290    0  516 1275.25020 16946.4290  1229%     - 1000s
     0     0 16894.8634    0  576 1275.25020 16894.8634  1225%     - 1017s
     0     0 16848.5281    0  505 1275.25020 16848.5281  1221%     - 1033s
     0     0 16835.3776    0  525 1275.25020 16835.3776  1220%     - 1044s
     0     0 16815.9564    0  530 1275.25020 16815.9564  1219%     - 1053s
     0     0 16791.7750    0  580 1275.25020 16791.7750  1217%     - 1065s
     0     0 16781.5961    0  578 1275.25020 16781.5961  1216%     - 1074s
     0     0 16774.4052    0  622 1275.25020 16774.4052  1215%     - 1080s
     0     0 16764.8774    0  633 1275.25020 16764.8774  1215%     - 1084s
     0     0 16763.6774    0  631 1275.25020 16763.6774  1215%     - 1087s
     0     0 16527.4832    0  506 1275.25020 16527.4832  1196%     - 1123s
     0     0 16480.4688    0  514 1275.25020 16480.4688  1192%     - 1144s
     0     0 16463.9371    0  570 1275.25020 16463.9371  1191%     - 1155s
     0     0 16455.9121    0  587 1275.25020 16455.9121  1190%     - 1159s
     0     0 16444.7368    0  536 1275.25020 16444.7368  1190%     - 1167s
     0     0 16441.6818    0  542 1275.25020 16441.6818  1189%     - 1171s
     0     0 16359.4498    0  569 1275.25020 16359.4498  1183%     - 1191s
     0     0 16344.9912    0  572 1275.25020 16344.9912  1182%     - 1204s
     0     0 16330.8686    0  560 1275.25020 16330.8686  1181%     - 1212s
     0     0 16319.6820    0  506 1275.25020 16319.6820  1180%     - 1220s
     0     0 16311.4493    0  504 1275.25020 16311.4493  1179%     - 1227s
     0     0 16309.3480    0  496 1275.25020 16309.3480  1179%     - 1229s
     0     0 16251.2586    0  412 1275.25020 16251.2586  1174%     - 1247s
     0     0 16229.8648    0  436 1275.25020 16229.8648  1173%     - 1261s
     0     0 16222.4178    0  425 1275.25020 16222.4178  1172%     - 1269s
     0     0 16220.8483    0  433 1275.25020 16220.8483  1172%     - 1274s
     0     0 16205.1772    0  426 1275.25020 16205.1772  1171%     - 1283s
     0     0 16203.2774    0  431 1275.25020 16203.2774  1171%     - 1289s
     0     0 16197.8641    0  630 1275.25020 16197.8641  1170%     - 1297s
     0     0 16189.2972    0  442 1275.25020 16189.2972  1169%     - 1307s
     0     0 16187.3351    0  432 1275.25020 16187.3351  1169%     - 1311s
     0     0 16183.7490    0  428 1275.25020 16183.7490  1169%     - 1317s
     0     0 16182.4773    0  428 1275.25020 16182.4773  1169%     - 1322s
H    0     0                    1311.8082138 16182.4773  1134%     - 1574s
H    0     2                    2570.8207912 16182.4773   529%     - 1703s
     0     2 16182.4773    0  428 2570.82079 16182.4773   529%     - 1703s
     1     4 16040.1789    1  557 2570.82079 16182.4773   529% 13715 1731s
     3     8 15930.3890    2  556 2570.82079 16039.8275   524% 12980 1784s
     7    16 15861.4069    3  418 2570.82079 15930.3811   520% 14947 1826s
    15    32 15449.0990    4  556 2570.82079 15860.4718   517% 15210 1888s
    31    48 15099.5417    5  416 2570.82079 15449.0378   501% 22836 2031s
    47    80 14851.6219    6  417 2570.82079 15449.0378   501% 19879 2091s
    79   193 14833.8033    7  334 2570.82079 15449.0378   501% 15984 2165s
   192   249 14609.9006   10  394 2570.82079 15449.0378   501%  9695 2205s
   248   300 14560.7079   11  387 2570.82079 15449.0378   501%  8834 2241s
   299   343 14226.1858   15  303 2570.82079 15449.0378   501%  8719 2282s
   342   385 14270.5307   11  309 2570.82079 15449.0378   501%  8423 2321s
   388   408 14476.2025   12  378 2570.82079 15449.0378   501%  8243 2356s
H  397   408                    2663.8510619 15449.0378   480%  8255 2356s
   415   443 13940.7040   12  298 2663.85106 15449.0378   480%  8461 2397s
   451   463 14220.2166   12  320 2663.85106 15449.0378   480%  8217 2436s
H  460   463                    2944.2990964 15449.0378   425%  8175 2436s
   471   497 14297.6238   13  310 2944.29910 15449.0378   425%  8180 2484s
   518   520 14095.0287   14  296 2944.29910 15449.0378   425%  8029 2524s
   549   540 12839.3638   13  223 2944.29910 15449.0378   425%  8004 2563s
H  562   540                    3071.2965034 15449.0378   403%  7957 2563s
   584   580 13674.8418   15  367 3071.29650 15449.0378   403%  7824 2608s
   639   615 13545.7088   16  368 3071.29650 15449.0378   403%  7517 2652s
   695   653 12970.2811   18  452 3071.29650 15449.0378   403%  7402 2695s
   763   677 13082.1296   17  269 3071.29650 15449.0378   403%  7189 2734s
   814   712 12156.7041   20  374 3071.29650 15449.0378   403%  7022 2779s
   865   729 12126.9445   21  364 3071.29650 15449.0378   403%  6897 2828s
   914   746 12807.5231   18  348 3071.29650 15449.0378   403%  6832 2870s
   941   768 12118.8814   19  547 3071.29650 15449.0378   403%  6838 2928s
   985   802 11808.1157   20  476 3071.29650 15449.0378   403%  6764 2992s
  1029   827 6900.75308   24  313 3071.29650 15449.0378   403%  6753 3040s
  1091   852 10618.3997   20  394 3071.29650 15449.0378   403%  6664 3092s
  1153   889 8103.94678   21  471 3071.29650 15449.0378   403%  6543 3147s
  1222   947 9807.72198   21  351 3071.29650 15449.0378   403%  6398 3203s
  1293   988 10303.7800   21  464 3071.29650 15449.0378   403%  6277 3256s
  1376  1022 infeasible   27      3071.29650 15449.0378   403%  6118 3317s
  1451  1077 9398.97496   22  455 3071.29650 15449.0378   403%  6062 3376s
  1533  1151 9348.20125   24  387 3071.29650 15449.0378   403%  5970 3436s
  1654  1213 9149.84088   29  289 3071.29650 15449.0378   403%  5802 3501s
  1779  1243 8962.35535   32  419 3071.29650 15449.0378   403%  5679 3568s
  1887  1278 3627.26473   59  274 3071.29650 15449.0378   403%  5624 3600s

Cutting planes:
  Learned: 4
  Gomory: 21
  Implied bound: 174
  MIR: 3297
  Flow cover: 3291
  RLT: 126
  Relax-and-lift: 1229

Explored 1968 nodes (11624653 simplex iterations) in 3600.08 seconds (5134.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 3071.3 2944.3 2663.85 ... 1186.5

Time limit reached
Best objective 3.071296503394e+03, best bound 1.544903781178e+04, gap 403.0136%
  WARNING: Time limit reached. Using best solution found (gap: 403.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 3071.30, θ = 144358.04
  Upper Bound (UB) = 3071.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144358.04
  [DEBUG]   ✓ Scenario 0: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144358.04 ≤ Q = 144358.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 144358.04 ≤ Q = 144358.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 144358.04 ≤ Q = 144358.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5bb8c84c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa44737b4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.277649e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.01s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6554172.6667
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.618126e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161812.63    0  135 6554172.67 -161812.63   102%     -    0s
H    0     0                    -127143.7139 -161812.63  27.3%     -    0s
H    0     0                    -128021.6551 -161812.63  26.4%     -    0s
     0     0 -137591.89    0   71 -128021.66 -137591.89  7.48%     -    0s
H    0     0                    -135416.0775 -137541.66  1.57%     -    0s
H    0     0                    -135738.4786 -137541.66  1.33%     -    0s
H    0     0                    -135924.6608 -137541.66  1.19%     -    0s
H    0     0                    -136247.0618 -137541.66  0.95%     -    0s
     0     0 -137518.47    0   58 -136247.06 -137518.47  0.93%     -    0s
     0     0 -137500.13    0   67 -136247.06 -137500.13  0.92%     -    0s
     0     0 -137499.44    0   67 -136247.06 -137499.44  0.92%     -    0s
     0     0 -137138.85    0   54 -136247.06 -137138.85  0.65%     -    0s
     0     0 -137038.27    0   45 -136247.06 -137038.27  0.58%     -    0s
     0     0 -136959.02    0   42 -136247.06 -136959.02  0.52%     -    0s
     0     0 -136934.81    0   42 -136247.06 -136934.81  0.50%     -    0s
H    0     0                    -136268.0006 -136934.81  0.49%     -    0s
     0     0 -136851.51    0   38 -136268.00 -136851.51  0.43%     -    0s
     0     0 -136839.92    0   38 -136268.00 -136839.92  0.42%     -    0s
     0     0 -136839.92    0   87 -136268.00 -136839.92  0.42%     -    0s
     0     0 -136839.92    0   45 -136268.00 -136839.92  0.42%     -    0s
     0     0 -136765.16    0   37 -136268.00 -136765.16  0.36%     -    0s
     0     0 -136671.65    0   43 -136268.00 -136671.65  0.30%     -    0s
     0     0 -136663.75    0   44 -136268.00 -136663.75  0.29%     -    0s
     0     0 -136663.18    0   44 -136268.00 -136663.18  0.29%     -    0s
     0     0 -136606.74    0   43 -136268.00 -136606.74  0.25%     -    0s
     0     0 -136572.26    0   44 -136268.00 -136572.26  0.22%     -    0s
H    0     0                    -136297.0358 -136570.05  0.20%     -    0s
     0     0 -136570.05    0   44 -136297.04 -136570.05  0.20%     -    0s
     0     0 -136557.95    0   44 -136297.04 -136557.95  0.19%     -    0s
     0     0 -136557.02    0   44 -136297.04 -136557.02  0.19%     -    0s
     0     0 -136557.02    0   49 -136297.04 -136557.02  0.19%     -    0s
     0     0 -136557.02    0   42 -136297.04 -136557.02  0.19%     -    0s
     0     0 -136547.36    0   44 -136297.04 -136547.36  0.18%     -    0s
     0     0 -136532.32    0   44 -136297.04 -136532.32  0.17%     -    0s
     0     0 -136516.89    0   44 -136297.04 -136516.89  0.16%     -    0s
     0     0 -136515.41    0   44 -136297.04 -136515.41  0.16%     -    0s
     0     0 -136512.86    0   44 -136297.04 -136512.86  0.16%     -    0s
     0     0 -136511.83    0   44 -136297.04 -136511.83  0.16%     -    0s
     0     2 -136511.83    0   44 -136297.04 -136511.83  0.16%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 2
  MIR: 48
  Flow cover: 14
  RLT: 4

Explored 35 nodes (1592 simplex iterations) in 0.31 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -136297 -136268 -136247 ... 1.27765e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.362970357810e+05, best bound -1.363085156967e+05, gap 0.0084%
  Subproblem solved in 0.34s
  Worst-case operational profit (Z_SP) = 132964.36
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136297.04
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -136297.04 = 132964.36
  [DEBUG]   Current θ from Master = 144358.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11393.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8322.38
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 322.6695, Absolute Gap = 322.6695, Relative Gap = 0.105060
  Not converged yet (gap = 322.67 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567834 nonzeros
Model fingerprint: 0x7c356438
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81606 rows and 33146 columns
Presolve time: 3.64s
Presolved: 118547 rows, 50234 columns, 728611 nonzeros
Variable types: 47975 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315710.7753
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 694
 AA' NZ     : 4.761e+06
 Factor NZ  : 1.176e+07 (roughly 160 MB of memory)
 Factor Ops : 3.837e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82105936e+07  2.23421693e+08  1.13e+05 2.04e+01  7.83e+04     6s
   1  -1.39714873e+07  1.96145496e+08  8.09e+04 7.00e+01  5.55e+04     6s
   2  -4.43766151e+06  1.46450220e+08  2.52e+04 8.80e-01  1.84e+04     6s
   3  -9.07392499e+05  1.03946497e+08  2.08e+03 1.65e+00  1.90e+03     6s
   4  -5.84125120e+05  5.30524804e+07  5.32e+02 6.53e-01  5.82e+02     6s
   5  -4.61402601e+05  3.28101573e+07  2.04e+02 3.57e-01  2.71e+02     6s
   6  -3.79050961e+05  2.49536618e+07  6.83e+01 2.54e-01  1.53e+02     7s
   7  -2.90759255e+05  1.89627428e+07  2.77e+01 1.86e-01  1.02e+02     7s
   8  -1.77239824e+05  1.41654299e+07  8.95e+00 1.35e-01  6.96e+01     7s
   9  -1.27827402e+05  4.38222288e+06  3.59e+00 3.75e-02  2.13e+01     7s
  10  -9.22871095e+04  2.52091436e+06  1.55e+00 2.05e-02  1.22e+01     7s
  11  -6.85540966e+04  1.70197878e+06  6.84e-01 1.37e-02  8.21e+00     7s
  12  -5.15847510e+04  5.81125628e+05  3.72e-01 4.66e-03  2.93e+00     7s
  13  -2.58099594e+04  3.13021063e+05  1.55e-01 2.47e-03  1.57e+00     7s
  14  -1.61466265e+04  1.93210923e+05  1.11e-01 1.71e-03  9.67e-01     8s
  15  -5.40832342e+03  1.46852474e+05  7.84e-02 1.88e-03  7.03e-01     8s
  16   9.03936992e+02  1.05398963e+05  6.13e-02 1.90e-03  4.83e-01     8s
  17   7.57164864e+03  8.39700941e+04  4.52e-02 1.88e-03  3.53e-01     8s
  18   1.20111448e+04  7.34102271e+04  3.52e-02 1.42e-03  2.84e-01     8s
  19   1.55908383e+04  6.03832925e+04  2.79e-02 1.50e-03  2.07e-01     8s
  20   1.83271738e+04  5.19363497e+04  2.29e-02 1.46e-03  1.55e-01     9s
  21   2.11897382e+04  4.92269431e+04  1.79e-02 1.27e-03  1.30e-01     9s
  22   2.23664102e+04  4.76903803e+04  1.61e-02 1.14e-03  1.17e-01     9s
  23   2.42462979e+04  4.39126748e+04  1.32e-02 8.19e-04  9.09e-02     9s
  24   2.60254069e+04  4.16335834e+04  1.07e-02 6.33e-04  7.21e-02     9s
  25   2.73403611e+04  3.99430497e+04  8.76e-03 5.25e-04  5.82e-02     9s
  26   2.89705406e+04  3.86961493e+04  6.37e-03 4.37e-04  4.49e-02    10s
  27   3.03558401e+04  3.73325919e+04  4.39e-03 3.09e-04  3.22e-02    10s
  28   3.15590753e+04  3.55812837e+04  2.84e-03 1.44e-04  1.86e-02    10s
  29   3.21173175e+04  3.49708733e+04  2.15e-03 9.05e-05  1.32e-02    10s
  30   3.25134523e+04  3.47084081e+04  1.67e-03 6.70e-05  1.01e-02    10s
  31   3.27663247e+04  3.45017726e+04  1.36e-03 4.78e-05  8.02e-03    10s
  32   3.31805759e+04  3.43841721e+04  8.75e-04 3.70e-05  5.56e-03    11s
  33   3.34539803e+04  3.42164290e+04  5.58e-04 2.16e-05  3.52e-03    11s
  34   3.35409495e+04  3.41725991e+04  4.65e-04 1.77e-05  2.92e-03    11s
  35   3.36099456e+04  3.41387895e+04  3.87e-04 1.48e-05  2.44e-03    11s
  36   3.37015628e+04  3.40910489e+04  2.85e-04 1.05e-05  1.80e-03    11s
  37   3.37787155e+04  3.40371727e+04  1.94e-04 5.75e-06  1.19e-03    12s
  38   3.38290553e+04  3.40124301e+04  1.40e-04 3.66e-06  8.47e-04    12s
  39   3.38878786e+04  3.39953419e+04  7.78e-05 2.25e-06  4.97e-04    12s
  40   3.38960498e+04  3.39918808e+04  6.97e-05 1.96e-06  4.43e-04    12s
  41   3.39052981e+04  3.39903820e+04  6.04e-05 1.84e-06  3.93e-04    12s
  42   3.39231772e+04  3.39845951e+04  4.20e-05 1.41e-06  2.84e-04    13s
  43   3.39419917e+04  3.39774581e+04  2.29e-05 8.58e-07  1.64e-04    13s
  44   3.39453830e+04  3.39762307e+04  1.97e-05 7.56e-07  1.43e-04    13s
  45   3.39600948e+04  3.39709593e+04  5.35e-06 3.37e-07  5.02e-05    13s
  46   3.39658390e+04  3.39667188e+04  4.17e-07 2.29e-08  4.06e-06    13s
  47   3.39663619e+04  3.39664509e+04  1.25e-08 4.83e-09  4.11e-07    13s
  48   3.39663781e+04  3.39663798e+04  1.08e-09 3.33e-11  7.79e-09    14s
  49   3.39663791e+04  3.39663791e+04  5.93e-09 2.05e-09  7.44e-11    14s

Barrier solved model in 49 iterations and 13.92 seconds (11.15 work units)
Optimal objective 3.39663791e+04


Root crossover log...

  104149 DPushes remaining with DInf 0.0000000e+00                14s
   34136 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    1929 PPushes remaining with PInf 9.9492085e-06                19s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9735921e-02     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47910    3.3966379e+04   0.000000e+00   3.973592e-02     19s
   47913    3.3966379e+04   0.000000e+00   0.000000e+00     19s
   47913    3.3966379e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.396638e+04, 47913 iterations, 15.00 seconds (17.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33966.3791    0  237 -191968.18 33966.3791   118%     -   20s
H    0     0                    -186989.9560 33966.3791   118%     -   20s
H    0     0                    -138042.2323 33966.3791   125%     -   20s
H    0     0                    -128509.1535 33966.3791   126%     -   20s
H    0     0                    -127311.0125 33966.3791   127%     -   20s
H    0     0                    -66137.93747 33966.3791   151%     -   21s
H    0     0                    -49144.12924 33966.3791   169%     -   21s
H    0     0                    -48688.89657 33966.3791   170%     -   21s
H    0     0                    -38523.87430 33966.3791   188%     -   22s
H    0     0                    -37583.74699 33966.3791   190%     -   22s
H    0     0                    -22835.56525 33966.3791   249%     -   22s
H    0     0                    -16972.86930 33966.3791   300%     -   22s
H    0     0                    -12459.10769 33966.3791   373%     -   22s
     0     0 28466.8979    0  269 -12459.108 28466.8979   328%     -   92s
H    0     0                    -12287.21998 28466.4590   332%     -   93s
H    0     0                    -11414.77475 28466.4590   349%     -   93s
H    0     0                    -9005.299925 28090.7161   412%     -  111s
H    0     0                    -8931.707083 28090.7161   415%     -  111s
H    0     0                    -8450.057890 28090.7161   432%     -  111s
     0     0 28090.7161    0  275 -8450.0579 28090.7161   432%     -  111s
     0     0 27888.9176    0  276 -8450.0579 27888.9176   430%     -  122s
     0     0 27870.5577    0  274 -8450.0579 27870.5577   430%     -  129s
     0     0 27857.0650    0  276 -8450.0579 27857.0650   430%     -  130s
     0     0 27823.1727    0  277 -8450.0579 27823.1727   429%     -  134s
     0     0 27703.6904    0  316 -8450.0579 27703.6904   428%     -  137s
     0     0 27703.6904    0  277 -8450.0579 27703.6904   428%     -  138s
H    0     0                    -6386.671587 24118.2756   478%     -  196s
H    0     0                    -6349.136460 24118.2756   480%     -  196s
H    0     0                    -6332.406535 24118.2756   481%     -  196s
     0     0 24037.1552    0  383 -6332.4065 24037.1552   480%     -  197s
H    0     0                    -868.0673580 24037.1552  2869%     -  198s
H    0     0                    -835.9257991 24037.1552  2976%     -  198s
     0     0 23306.6005    0  382 -835.92580 23306.6005  2888%     -  238s
     0     0 23019.6532    0  387 -835.92580 23019.6532  2854%     -  261s
     0     0 22909.6503    0  397 -835.92580 22909.6503  2841%     -  274s
     0     0 22830.4254    0  402 -835.92580 22830.4254  2831%     -  286s
     0     0 22813.4406    0  400 -835.92580 22813.4406  2829%     -  291s
     0     0 22615.0124    0  399 -835.92580 22615.0124  2805%     -  304s
     0     0 22562.2701    0  411 -835.92580 22562.2701  2799%     -  309s
     0     0 22492.5866    0  400 -835.92580 22492.5866  2791%     -  317s
     0     0 22475.2457    0  407 -835.92580 22475.2457  2789%     -  320s
     0     0 22474.9801    0  407 -835.92580 22474.9801  2789%     -  321s
     0     0 19957.6028    0  367 -835.92580 19957.6028  2487%     -  380s
H    0     0                    -785.4745054 19957.4988  2641%     -  381s
H    0     0                    -773.8654691 19957.4988  2679%     -  381s
H    0     0                    -671.9045278 19957.4988  3070%     -  381s
H    0     0                    -603.9584394 19957.4988  3404%     -  381s
H    0     0                    -587.1876125 19957.4988  3499%     -  381s
H    0     0                    -568.2088910 19957.4988  3612%     -  381s
H    0     0                    -491.0263332 19957.4988  4164%     -  381s
H    0     0                     -75.8406798 19328.6688      -     -  423s
H    0     0                     -17.3825835 19328.6688      -     -  423s
     0     0 19328.6688    0  384  -17.38258 19328.6688      -     -  423s
     0     0 18959.9569    0  381  -17.38258 18959.9569      -     -  458s
H    0     0                     106.9350673 18730.9798      -     -  480s
H    0     0                     141.8939752 18730.9798      -     -  480s
     0     0 18730.9798    0  430  141.89398 18730.9798      -     -  481s
     0     0 18681.8952    0  394  141.89398 18681.8952      -     -  496s
     0     0 18625.8030    0  397  141.89398 18625.8030      -     -  510s
     0     0 18586.3692    0  392  141.89398 18586.3692      -     -  519s
     0     0 18581.0875    0  395  141.89398 18581.0875      -     -  524s
     0     0 18567.2014    0  384  141.89398 18567.2014      -     -  529s
     0     0 18559.7346    0  394  141.89398 18559.7346      -     -  532s
     0     0 18557.5290    0  383  141.89398 18557.5290      -     -  535s
     0     0 18549.0761    0  383  141.89398 18549.0761      -     -  539s
     0     0 18547.7463    0  385  141.89398 18547.7463      -     -  540s
H    0     0                     414.3054317 17891.1196  4218%     -  585s
H    0     0                     915.5914222 17891.1196  1854%     -  585s
H    0     0                    1317.4574536 17891.1196  1258%     -  585s
H    0     0                    1397.6333462 17891.1196  1180%     -  585s
H    0     0                    1515.8229781 17891.1196  1080%     -  585s
     0     0 17891.1196    0  404 1515.82298 17891.1196  1080%     -  585s
     0     0 17489.1362    0  397 1515.82298 17489.1362  1054%     -  615s
     0     0 17363.5804    0  383 1515.82298 17363.5804  1045%     -  627s
     0     0 17305.6270    0  433 1515.82298 17305.6270  1042%     -  635s
     0     0 17242.5981    0  446 1515.82298 17242.5981  1038%     -  643s
     0     0 17134.4748    0  396 1515.82298 17134.4748  1030%     -  655s
     0     0 17105.8747    0  463 1515.82298 17105.8747  1028%     -  660s
     0     0 17058.2895    0  405 1515.82298 17058.2895  1025%     -  666s
     0     0 17039.3711    0  505 1515.82298 17039.3711  1024%     -  671s
     0     0 17024.3531    0  496 1515.82298 17024.3531  1023%     -  675s
     0     0 17019.4884    0  457 1515.82298 17019.4884  1023%     -  677s
     0     0 17005.5460    0  456 1515.82298 17005.5460  1022%     -  681s
     0     0 17002.9336    0  459 1515.82298 17002.9336  1022%     -  683s
     0     0 17001.9752    0  509 1515.82298 17001.9752  1022%     -  684s
     0     0 16695.3995    0  459 1515.82298 16695.3995  1001%     -  708s
H    0     0                    1568.2403921 16695.2828   965%     -  709s
     0     0 16647.8288    0  457 1568.24039 16647.8288   962%     -  719s
     0     0 16613.8161    0  418 1568.24039 16613.8161   959%     -  729s
     0     0 16603.3148    0  399 1568.24039 16603.3148   959%     -  733s
     0     0 16600.5155    0  416 1568.24039 16600.5155   959%     -  735s
     0     0 16595.8816    0  411 1568.24039 16595.8816   958%     -  737s
     0     0 16588.5499    0  414 1568.24039 16588.5499   958%     -  739s
     0     0 16587.9814    0  415 1568.24039 16587.9814   958%     -  740s
     0     0 16499.8713    0  431 1568.24039 16499.8713   952%     -  751s
H    0     0                    1601.7114613 16499.7551   930%     -  767s
H    0     0                    2377.7443121 16499.7551   594%     -  767s
     0     0 16465.1336    0  418 2377.74431 16465.1336   592%     -  777s
     0     0 16454.7733    0  426 2377.74431 16454.7733   592%     -  783s
     0     0 16449.5979    0  426 2377.74431 16449.5979   592%     -  787s
     0     0 16442.0880    0  416 2377.74431 16442.0880   591%     -  789s
     0     0 16433.6673    0  434 2377.74431 16433.6673   591%     -  794s
     0     0 16430.7663    0  429 2377.74431 16430.7663   591%     -  797s
     0     0 16429.9426    0  429 2377.74431 16429.9426   591%     -  798s
     0     0 16342.9276    0  417 2377.74431 16342.9276   587%     -  810s
H    0     0                    2538.3048101 16342.8873   544%     -  811s
     0     0 16333.5906    0  406 2538.30481 16333.5906   543%     -  816s
     0     0 16329.6721    0  411 2538.30481 16329.6721   543%     -  819s
     0     0 16325.1933    0  423 2538.30481 16325.1933   543%     -  822s
     0     0 16320.0945    0  422 2538.30481 16320.0945   543%     -  825s
     0     0 16318.2528    0  422 2538.30481 16318.2528   543%     -  826s
     0     0 16305.4640    0  423 2538.30481 16305.4640   542%     -  835s
     0     0 16299.2590    0  424 2538.30481 16299.2590   542%     -  843s
     0     0 16298.4095    0  431 2538.30481 16298.4095   542%     -  844s
     0     0 16292.7774    0  424 2538.30481 16292.7774   542%     -  849s
     0     0 16286.1557    0  433 2538.30481 16286.1557   542%     -  853s
     0     0 16284.5236    0  433 2538.30481 16284.5236   542%     -  855s
     0     0 16271.6783    0  422 2538.30481 16271.6783   541%     -  863s
H    0     0                    3219.3290665 16271.5148   405%     -  884s
     0     0 16267.6351    0  414 3219.32907 16267.6351   405%     -  887s
     0     0 16267.3683    0  419 3219.32907 16267.3683   405%     -  888s
     0     0 16260.3442    0  420 3219.32907 16260.3442   405%     -  895s
     0     0 16260.1980    0  420 3219.32907 16260.1980   405%     -  901s
H    0     0                    3372.9307653 16260.1980   382%     -  971s
H    0     0                    3502.7418490 16260.1980   364%     -  971s
H    0     0                    3596.8846056 16260.1980   352%     -  971s
     0     2 16260.1980    0  420 3596.88461 16260.1980   352%     - 1042s
     1     3 16163.1973    1  410 3596.88461 16259.9067   352%  9418 1056s
     2     4 16209.0811    1  413 3596.88461 16209.0811   351%  6505 1073s
     3     8 15936.8103    2  359 3596.88461 16208.1505   351%  6984 1091s
     7    15 15595.9659    3  422 3596.88461 16137.2399   349%  7211 1128s
    14    30 15675.0772    4  419 3596.88461 15976.5744   344% 10601 1161s
    29    45 13979.1662    5  425 3596.88461 15675.0478   336% 14226 1258s
    44    76 14118.8952    6  268 3596.88461 15675.0478   336% 17940 1437s
    75   112 13827.0424    7  310 3596.88461 15399.0711   328% 16100 1483s
   111   164 13811.5633    8  310 3596.88461 15399.0711   328% 14067 1522s
   163   242 13732.1449    9  242 3596.88461 15399.0711   328% 10997 1566s
   241   301 13580.3623   10  243 3596.88461 15399.0711   328%  8920 1604s
   300   376 13187.1982   11  246 3596.88461 15399.0711   328%  8106 1646s
   375   425 12886.3116   12  246 3596.88461 15399.0711   328%  7628 1709s
   426   472 12541.5067   13  230 3596.88461 15399.0711   328%  7509 1748s
   486   498 12115.0546   15  217 3596.88461 15399.0711   328%  7249 1778s
   518   527 11748.7904   16  229 3596.88461 15399.0711   328%  7313 1809s
   556   553 11696.6492   17  219 3596.88461 15399.0711   328%  7467 1842s
   601   586 11233.7922   18  225 3596.88461 15399.0711   328%  7417 1888s
   638   621 11084.1696   19  218 3596.88461 15399.0711   328%  7256 1923s
   675   648 10880.3577   20  207 3596.88461 15399.0711   328%  7123 1957s
   724   688 10842.6730   21  204 3596.88461 15399.0711   328%  6925 1991s
   776   721 8790.26598   22  181 3596.88461 15399.0711   328%  6728 2025s
   821   775 8784.04774   23  179 3596.88461 15399.0711   328%  6584 2058s
H  843   775                    3706.5849192 15399.0711   315%  6473 2058s
   885   814 8721.81492   24  179 3706.58492 15399.0711   315%  6279 2096s
   987   842 4518.45550   30  114 3706.58492 15399.0711   315%  5929 2139s
  1069   876     cutoff   35      3706.58492 15399.0711   315%  5726 2183s
  1158   941 infeasible   33      3706.58492 15399.0711   315%  5539 2226s
  1265  1036 7237.30271   41  248 3706.58492 15399.0711   315%  5306 2272s
  1378  1121 7171.53757   42  234 3706.58492 15399.0711   315%  5140 2319s
  1524  1187 6835.96100   44  284 3706.58492 15399.0711   315%  4933 2370s
  1658  1246 6393.59360   45  221 3706.58492 15399.0711   315%  4749 2424s
  1791  1308 6363.91375   46  173 3706.58492 15399.0711   315%  4635 2476s
  1930  1346 6148.25731   47  234 3706.58492 15388.8644   315%  4533 2518s
  1998  1378 5920.12649   49  230 3706.58492 15388.8644   315%  4508 2568s
  2058  1426 5997.58767   48  183 3706.58492 15388.8644   315%  4523 2624s
  2148  1515 4990.06966   54  196 3706.58492 15388.8644   315%  4483 2681s
  2288  1577 infeasible   61      3706.58492 15388.8644   315%  4394 2742s
  2443  1627 6885.85287   14  226 3706.58492 15388.8644   315%  4315 2810s
  2555  1747 4945.01334   17  212 3706.58492 15388.8644   315%  4331 2877s
  2743  1835 infeasible   23      3706.58492 15388.8644   315%  4246 2947s
  2897  1947 11883.1623   16  422 3706.58492 15387.7786   315%  4247 3013s
  3079  2040 11416.4495   17  439 3706.58492 15387.7786   315%  4211 3087s
  3245  2147 8724.77612   19  480 3706.58492 15387.7786   315%  4189 3167s
  3403  2286 7649.81409   21  452 3706.58492 15387.7786   315%  4213 3246s
  3576  2468 6862.71883   23  362 3706.58492 15387.7786   315%  4217 3328s

Cutting planes:
  Learned: 2
  Gomory: 8
  Implied bound: 137
  MIR: 2786
  Flow cover: 2829
  RLT: 59
  Relax-and-lift: 392

Explored 3813 nodes (16414818 simplex iterations) in 3600.13 seconds (5160.65 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 3706.58 3596.88 3502.74 ... 1515.82

Time limit reached
Best objective 3.706584919151e+03, best bound 1.538777860467e+04, gap 315.1471%
  WARNING: Time limit reached. Using best solution found (gap: 315.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 3706.58, θ = 146510.72
  Upper Bound (UB) = 3706.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146510.72
  [DEBUG]   ✓ Scenario 0: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146510.72 ≤ Q = 146510.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146510.72 ≤ Q = 146510.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 146510.72 ≤ Q = 146510.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 146510.72 ≤ Q = 146510.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2d305f30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2d305f30
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-15, 2e+02]
Found heuristic solution: objective 1.310389e+13
Presolve removed 2552 rows and 1844 columns
Presolve time: 0.01s
Presolved: 541 rows, 545 columns, 1526 nonzeros
Found heuristic solution: objective 6921480.5846
Variable types: 369 continuous, 176 integer (176 binary)

Root relaxation: objective -1.578951e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157895.15    0  126 6921480.58 -157895.15   102%     -    0s
H    0     0                    -119133.7030 -157895.15  32.5%     -    0s
H    0     0                    -119579.4427 -157895.15  32.0%     -    0s
H    0     0                    -126793.6810 -129368.76  2.03%     -    0s
     0     0 -129368.76    0   58 -126793.68 -129368.76  2.03%     -    0s
H    0     0                    -127138.5138 -129333.13  1.73%     -    0s
H    0     0                    -127463.5040 -129333.13  1.47%     -    0s
H    0     0                    -127808.3369 -129333.13  1.19%     -    0s
     0     0 -128690.11    0   60 -127808.34 -128690.11  0.69%     -    0s
H    0     0                    -127813.0526 -128669.82  0.67%     -    0s
     0     0 -128460.37    0   41 -127813.05 -128460.37  0.51%     -    0s
     0     0 -128420.22    0   40 -127813.05 -128420.22  0.48%     -    0s
     0     0 -128381.25    0   37 -127813.05 -128381.25  0.44%     -    0s
     0     0 -128376.01    0   38 -127813.05 -128376.01  0.44%     -    0s
H    0     0                    -127837.2537 -128376.01  0.42%     -    0s
     0     0 -128150.76    0   12 -127837.25 -128150.76  0.25%     -    0s
     0     0 -128059.22    0   15 -127837.25 -128059.22  0.17%     -    0s
     0     0 -128059.11    0   15 -127837.25 -128059.11  0.17%     -    0s
     0     0 -128053.78    0   15 -127837.25 -128053.78  0.17%     -    0s
     0     0 -127949.96    0    7 -127837.25 -127949.96  0.09%     -    0s
     0     0 -127949.96    0   14 -127837.25 -127949.96  0.09%     -    0s
H    0     0                    -127839.3326 -127949.96  0.09%     -    0s
     0     0 -127912.36    0    4 -127839.33 -127912.36  0.06%     -    0s
H    0     0                    -127910.9188 -127911.44  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 4
  Flow cover: 7
  Relax-and-lift: 2

Explored 1 nodes (752 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -127911 -127839 -127837 ... 1.31039e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.279109188500e+05, best bound -1.279114421057e+05, gap 0.0004%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 141350.48
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127910.92
  [DEBUG]   S×d_nominal = 269261.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 269261.40 + -127910.92 = 141350.48
  [DEBUG]   Current θ from Master = 146510.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5160.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1453.65
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 957.9579, Absolute Gap = 957.9579, Relative Gap = 0.258448
  Not converged yet (gap = 957.96 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611089 nonzeros
Model fingerprint: 0x5ecd8a32
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87888 rows and 35698 columns
Presolve time: 4.58s
Presolved: 127555 rows, 53922 columns, 783921 nonzeros
Variable types: 51663 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315710.7753
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.49s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 5.410e+06
 Factor NZ  : 1.248e+07 (roughly 170 MB of memory)
 Factor Ops : 2.723e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87064938e+07  2.37858744e+08  1.16e+05 2.03e+01  7.99e+04     7s
   1  -1.43604310e+07  2.09340292e+08  8.29e+04 6.93e+01  5.67e+04     7s
   2  -4.69417956e+06  1.56909165e+08  2.67e+04 7.39e-01  1.95e+04     7s
   3  -1.00294471e+06  1.12992035e+08  2.37e+03 2.06e+00  2.11e+03     7s
   4  -6.17830801e+05  6.45257877e+07  5.78e+02 7.25e-01  6.46e+02     7s
   5  -5.24285393e+05  4.06505377e+07  3.33e+02 3.84e-01  3.70e+02     8s
   6  -4.46969665e+05  2.87200823e+07  1.84e+02 2.43e-01  2.24e+02     8s
   7  -3.58572385e+05  2.08886602e+07  7.34e+01 1.64e-01  1.27e+02     8s
   8  -1.98315434e+05  1.44004258e+07  1.53e+01 1.05e-01  6.87e+01     8s
   9  -1.29972900e+05  6.64484974e+06  7.22e+00 4.42e-02  3.07e+01     8s
  10  -1.03041252e+05  2.66612681e+06  3.65e+00 1.65e-02  1.23e+01     8s
  11  -8.76559036e+04  1.73762966e+06  2.49e+00 1.06e-02  8.01e+00     8s
  12  -6.30936519e+04  5.48837154e+05  1.08e+00 3.22e-03  2.66e+00     8s
  13  -4.31860029e+04  3.64897930e+05  6.06e-01 2.03e-03  1.76e+00     8s
  14  -2.94143665e+04  2.19320747e+05  4.32e-01 1.28e-03  1.07e+00     8s
  15  -1.75909480e+04  1.63187560e+05  3.43e-01 1.50e-03  7.80e-01     9s
  16  -1.02320150e+04  1.20564640e+05  2.87e-01 1.78e-03  5.65e-01     9s
  17  -4.14455925e+03  1.00729693e+05  2.42e-01 1.91e-03  4.53e-01     9s
  18   1.01322959e+03  8.26490344e+04  2.04e-01 1.84e-03  3.53e-01     9s
  19   8.60638867e+03  6.50203078e+04  1.49e-01 1.96e-03  2.44e-01     9s
  20   1.27206596e+04  5.88491675e+04  1.21e-01 1.87e-03  1.99e-01     9s
  21   1.57092373e+04  5.19464042e+04  1.01e-01 2.02e-03  1.57e-01     9s
  22   1.85553011e+04  4.79752288e+04  8.37e-02 1.75e-03  1.27e-01     9s
  23   2.08874397e+04  4.47671092e+04  6.95e-02 1.64e-03  1.03e-01     9s
  24   2.28651259e+04  4.24051557e+04  5.84e-02 2.01e-03  8.45e-02    10s
  25   2.44461719e+04  4.10755268e+04  4.98e-02 2.04e-03  7.19e-02    10s
  26   2.65794022e+04  3.95274363e+04  3.83e-02 1.81e-03  5.60e-02    10s
  27   2.78713892e+04  3.82581472e+04  3.13e-02 1.74e-03  4.49e-02    10s
  28   2.95255468e+04  3.70755916e+04  2.26e-02 1.82e-03  3.26e-02    10s
  29   3.10209981e+04  3.61283137e+04  1.50e-02 8.73e-04  2.21e-02    10s
  30   3.13633104e+04  3.56398226e+04  1.33e-02 6.61e-04  1.85e-02    10s
  31   3.20661362e+04  3.50573115e+04  9.84e-03 3.97e-04  1.29e-02    10s
  32   3.27035417e+04  3.48505572e+04  6.89e-03 2.94e-04  9.28e-03    11s
  33   3.29700133e+04  3.47438346e+04  5.67e-03 2.47e-04  7.67e-03    11s
  34   3.32244548e+04  3.46398702e+04  4.44e-03 2.26e-04  6.12e-03    11s
  35   3.35032035e+04  3.44390480e+04  3.13e-03 1.35e-04  4.05e-03    11s
  36   3.35443311e+04  3.44191887e+04  2.94e-03 1.25e-04  3.78e-03    11s
  37   3.36888175e+04  3.43815159e+04  2.29e-03 1.03e-04  3.00e-03    11s
  38   3.37653085e+04  3.43189175e+04  1.93e-03 1.87e-04  2.40e-03    12s
  39   3.40022293e+04  3.42771262e+04  8.15e-04 1.23e-04  1.19e-03    12s
  40   3.41307003e+04  3.42481418e+04  2.54e-04 7.83e-05  5.07e-04    12s
  41   3.41819893e+04  3.42022584e+04  4.82e-05 2.40e-05  8.75e-05    12s
  42   3.41840467e+04  3.41965770e+04  4.06e-05 1.70e-06  5.42e-05    12s
  43   3.41904310e+04  3.41961677e+04  1.82e-05 5.02e-07  2.48e-05    12s
  44   3.41913869e+04  3.41961655e+04  1.50e-05 5.00e-07  2.07e-05    12s
  45   3.41958771e+04  3.41959269e+04  1.04e-07 5.70e-08  2.15e-07    13s
  46   3.41958978e+04  3.41959094e+04  1.42e-06 1.62e-07  5.13e-08    13s
  47   3.41959028e+04  3.41959093e+04  8.25e-07 1.04e-07  2.86e-08    13s
  48   3.41959034e+04  3.41959092e+04  9.07e-07 8.75e-08  2.52e-08    13s
  49   3.41959074e+04  3.41959090e+04  5.52e-07 1.16e-08  7.08e-09    13s
  50   3.41959090e+04  3.41959090e+04  6.51e-07 1.09e-07  1.63e-10    13s

Barrier solved model in 50 iterations and 13.42 seconds (11.83 work units)
Optimal objective 3.41959090e+04


Root crossover log...

  113898 DPushes remaining with DInf 0.0000000e+00                13s
   29884 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    2690 PPushes remaining with PInf 2.7803494e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4204241e+03     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   55070    3.4195909e+04   0.000000e+00   2.420424e+03     19s
   55155    3.4195909e+04   0.000000e+00   0.000000e+00     19s
   55155    3.4195909e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 1.01s

Solved with barrier

Root relaxation: objective 3.419591e+04, 55155 iterations, 14.79 seconds (16.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34195.9090    0  192 -191968.18 34195.9090   118%     -   21s
H    0     0                    -136661.7368 34195.9090   125%     -   22s
H    0     0                    -134508.8650 34195.9090   125%     -   22s
H    0     0                    -133806.2156 34195.9090   126%     -   23s
H    0     0                    -133523.6207 34195.9090   126%     -   23s
H    0     0                    -71450.88210 34195.9090   148%     -   23s
H    0     0                    -69915.06353 34195.9090   149%     -   24s
H    0     0                    -14125.42033 34195.9090   342%     -   24s
H    0     0                    -12535.30829 34195.9090   373%     -   26s
H    0     0                    -12454.14287 34195.9090   375%     -   26s
H    0     0                    -8816.277177 28221.1668   420%     -  108s
H    0     0                    -8703.117993 28221.1668   424%     -  108s
     0     0 28024.5525    0  257 -8703.1180 28024.5525   422%     -  108s
H    0     0                    -7153.599127 28024.5525   492%     -  110s
H    0     0                    -7123.599704 28024.5525   493%     -  110s
H    0     0                    -6386.671587 28024.5525   539%     -  110s
H    0     0                    -6323.603934 28024.5525   543%     -  110s
     0     0 28024.5525    0  265 -6323.6039 28024.5525   543%     -  129s
     0     0 27577.3672    0  275 -6323.6039 27577.3672   536%     -  147s
     0     0 27576.7502    0  275 -6323.6039 27576.7502   536%     -  159s
     0     0 27557.3891    0  274 -6323.6039 27557.3891   536%     -  170s
     0     0 27545.5990    0  311 -6323.6039 27545.5990   536%     -  178s
     0     0 27545.5990    0  311 -6323.6039 27545.5990   536%     -  179s
H    0     0                    -6301.435011 24223.2358   484%     -  261s
     0     0 24200.4695    0  346 -6301.4350 24200.4695   484%     -  261s
H    0     0                    -675.9321110 24200.4695  3680%     -  262s
     0     0 23355.5142    0  340 -675.93211 23355.5142  3555%     -  318s
     0     0 23228.4157    0  355 -675.93211 23228.4157  3537%     -  340s
     0     0 22956.1152    0  360 -675.93211 22956.1152  3496%     -  360s
     0     0 22811.0629    0  374 -675.93211 22811.0629  3475%     -  379s
     0     0 22739.7800    0  376 -675.93211 22739.7800  3464%     -  396s
     0     0 22477.4966    0  356 -675.93211 22477.4966  3425%     -  427s
     0     0 22462.0013    0  354 -675.93211 22462.0013  3423%     -  434s
     0     0 22435.3076    0  379 -675.93211 22435.3076  3419%     -  441s
     0     0 22428.8701    0  380 -675.93211 22428.8701  3418%     -  447s
     0     0 22428.2632    0  383 -675.93211 22428.2632  3418%     -  450s
H    0     0                    -585.9431862 19670.6006  3457%     -  552s
     0     0 19670.6006    0  448 -585.94319 19670.6006  3457%     -  552s
H    0     0                    -549.9658649 19670.5150  3677%     -  553s
     0     0 19248.9059    0  430 -549.96586 19248.9059  3600%     -  585s
H    0     0                    -455.0297324 19082.2246  4294%     -  610s
     0     0 19082.2246    0  449 -455.02973 19082.2246  4294%     -  610s
     0     0 19005.5273    0  455 -455.02973 19005.5273  4277%     -  630s
     0     0 18909.1307    0  456 -455.02973 18909.1307  4256%     -  640s
     0     0 18893.8737    0  451 -455.02973 18893.8737  4252%     -  647s
     0     0 18885.8690    0  459 -455.02973 18885.8690  4250%     -  650s
H    0     0                     377.8577632 18860.0341  4891%     -  656s
H    0     0                     458.8777088 18860.0341  4010%     -  656s
H    0     0                     462.6813174 18860.0341  3976%     -  656s
     0     0 18860.0341    0  456  462.68132 18860.0341  3976%     -  656s
     0     0 18793.2835    0  445  462.68132 18793.2835  3962%     -  667s
     0     0 18774.4442    0  448  462.68132 18774.4442  3958%     -  673s
     0     0 18755.2842    0  453  462.68132 18755.2842  3954%     -  679s
     0     0 18733.0889    0  452  462.68132 18733.0889  3949%     -  683s
     0     0 18727.2221    0  460  462.68132 18727.2221  3948%     -  686s
     0     0 18712.9659    0  455  462.68132 18712.9659  3944%     -  689s
     0     0 18699.7545    0  448  462.68132 18699.7545  3942%     -  693s
     0     0 18685.5842    0  447  462.68132 18685.5842  3939%     -  696s
     0     0 18669.5187    0  450  462.68132 18669.5187  3935%     -  698s
     0     0 18650.1219    0  454  462.68132 18650.1219  3931%     -  702s
     0     0 18641.9315    0  464  462.68132 18641.9315  3929%     -  706s
     0     0 18637.4011    0  464  462.68132 18637.4011  3928%     -  707s
     0     0 18637.0819    0  464  462.68132 18637.0819  3928%     -  708s
     0     0 17336.9818    0  404  462.68132 17336.9818  3647%     -  753s
     0     0 17122.1793    0  409  462.68132 17122.1793  3601%     -  775s
     0     0 17050.1337    0  409  462.68132 17050.1337  3585%     -  786s
     0     0 17007.4912    0  408  462.68132 17007.4912  3576%     -  791s
     0     0 16975.1753    0  411  462.68132 16975.1753  3569%     -  800s
     0     0 16928.9473    0  420  462.68132 16928.9473  3559%     -  809s
     0     0 16907.9668    0  477  462.68132 16907.9668  3554%     -  817s
     0     0 16876.2125    0  477  462.68132 16876.2125  3547%     -  821s
     0     0 16871.2901    0  419  462.68132 16871.2901  3546%     -  824s
     0     0 16868.4666    0  422  462.68132 16868.4666  3546%     -  827s
     0     0 16860.7283    0  482  462.68132 16860.7283  3544%     -  831s
     0     0 16855.3885    0  478  462.68132 16855.3885  3543%     -  834s
     0     0 16852.7319    0  473  462.68132 16852.7319  3542%     -  837s
     0     0 16846.0335    0  482  462.68132 16846.0335  3541%     -  839s
     0     0 16844.9476    0  485  462.68132 16844.9476  3541%     -  840s
     0     0 16649.9854    0  454  462.68132 16649.9854  3499%     -  856s
H    0     0                     808.5359726 16649.0116  1959%     -  857s
     0     0 16564.6017    0  411  808.53597 16564.6017  1949%     -  869s
     0     0 16502.7838    0  422  808.53597 16502.7838  1941%     -  888s
     0     0 16483.0265    0  419  808.53597 16483.0265  1939%     -  897s
     0     0 16476.8023    0  419  808.53597 16476.8023  1938%     -  901s
     0     0 16473.8947    0  416  808.53597 16473.8947  1937%     -  905s
     0     0 16471.0699    0  413  808.53597 16471.0699  1937%     -  906s
     0     0 16464.7423    0  417  808.53597 16464.7423  1936%     -  908s
     0     0 16462.5429    0  419  808.53597 16462.5429  1936%     -  910s
     0     0 16357.3995    0  419  808.53597 16357.3995  1923%     -  927s
H    0     0                    1935.5024354 16357.1254   745%     -  944s
H    0     0                    1955.2532021 16357.1254   737%     -  944s
H    0     0                    2345.7926479 16357.1254   597%     -  948s
     0     0 16341.1165    0  419 2345.79265 16341.1165   597%     -  957s
     0     0 16335.8158    0  420 2345.79265 16335.8158   596%     -  961s
     0     0 16333.0294    0  429 2345.79265 16333.0294   596%     -  963s
     0     0 16331.9267    0  432 2345.79265 16331.9267   596%     -  964s
     0     0 16285.4606    0  423 2345.79265 16285.4606   594%     -  972s
     0     0 16277.3006    0  424 2345.79265 16277.3006   594%     -  981s
     0     0 16276.1876    0  419 2345.79265 16276.1876   594%     -  983s
     0     0 16258.4880    0  428 2345.79265 16258.4880   593%     -  993s
     0     0 16252.4899    0  440 2345.79265 16252.4899   593%     - 1001s
     0     0 16251.7430    0  439 2345.79265 16251.7430   593%     - 1002s
     0     0 16226.8495    0  451 2345.79265 16226.8495   592%     - 1011s
     0     0 16221.6351    0  441 2345.79265 16221.6351   592%     - 1016s
     0     0 16219.3341    0  440 2345.79265 16219.3341   591%     - 1018s
     0     0 16174.3535    0  497 2345.79265 16174.3535   590%     - 1033s
H    0     0                    2570.8102178 16174.3255   529%     - 1070s
     0     0 16167.6899    0  447 2570.81022 16167.6899   529%     - 1102s
     0     0 16166.1840    0  444 2570.81022 16166.1840   529%     - 1106s
     0     0 16155.2419    0  437 2570.81022 16155.2419   528%     - 1115s
     0     0 16148.4467    0  442 2570.81022 16148.4467   528%     - 1121s
     0     0 16146.3576    0  442 2570.81022 16146.3576   528%     - 1124s
     0     0 16136.9117    0  440 2570.81022 16136.9117   528%     - 1130s
     0     0 16126.7572    0  443 2570.81022 16126.7572   527%     - 1137s
     0     0 16121.9911    0  456 2570.81022 16121.9911   527%     - 1140s
     0     0 16120.1265    0  451 2570.81022 16120.1265   527%     - 1142s
     0     0 16106.7593    0  436 2570.81022 16106.7593   527%     - 1153s
     0     0 16104.7352    0  442 2570.81022 16104.7352   526%     - 1157s
     0     0 16101.4765    0  435 2570.81022 16101.4765   526%     - 1163s
     0     0 16100.3086    0  440 2570.81022 16100.3086   526%     - 1167s
     0     0 16096.8488    0  432 2570.81022 16096.8488   526%     - 1175s
     0     0 16095.9249    0  438 2570.81022 16095.9249   526%     - 1179s
     0     0 16093.7870    0  434 2570.81022 16093.7870   526%     - 1183s
     0     0 16093.4596    0  434 2570.81022 16093.4596   526%     - 1191s
     0     2 16093.3728    0  434 2570.81022 16093.3728   526%     - 1383s
     1     3 15997.3764    1  419 2570.81022 16093.1910   526%  6645 1395s
     2     4 16029.3532    1  427 2570.81022 16029.3532   524%  3834 1407s
     3     7 15783.2586    2  476 2570.81022 16029.2657   524%  4467 1428s
     6    14 15617.5136    3  417 2570.81022 16029.1438   524%  6312 1474s
    13    28 15335.9087    4  435 2570.81022 15770.0174   513%  9276 1503s
    27    42 14614.5471    5  422 2570.81022 15644.0112   509% 14316 2705s
    41    73 14323.1301    6  415 2570.81022 15644.0112   509% 18320 2899s
    72   105 14271.0945    7  410 2570.81022 15455.3318   501% 18539 2981s
H   84   105                    2801.0460065 15453.9081   452% 17668 2981s
H  104   219                    3046.4349396 15407.7447   406% 16127 3056s
H  138   219                    3067.2092114 15407.7447   402% 13473 3056s
   218   314 14105.0774   12  487 3067.20921 15407.7447   402% 10474 3104s
   313   375 13272.0490   11  367 3067.20921 15407.7447   402%  8985 3143s
   374   442 13128.3927   12  373 3067.20921 15407.7447   402%  8469 3179s
   443   467 14033.8478   13  492 3067.20921 15407.7447   402%  8035 3210s
   503   494 13966.5886   13  489 3067.20921 15407.7447   402%  7650 3237s
   568   538 13774.7975   14  502 3067.20921 15407.7447   402%  7300 3272s
   620   563 6332.97242   24  140 3067.20921 15407.7447   402%  7379 3302s
   657   593 6134.33075   25  137 3067.20921 15407.7447   402%  7459 3365s
   705   632 5915.19753   27  135 3067.20921 15407.7447   402%  7546 3396s
   754   679 6526.23420   15  346 3067.20921 15407.7447   402%  7617 3422s
   815   727 6437.34373   16  333 3067.20921 15407.7447   402%  7474 3451s
   893   759 6341.50088   18  393 3067.20921 15407.7447   402%  7288 3480s
   955   806 6151.03534   19  389 3067.20921 15407.7447   402%  7262 3510s
  1036   849 5874.77403   22  377 3067.20921 15407.7447   402%  7141 3540s
  1107   908 4964.13831   26  277 3067.20921 15407.7447   402%  7159 3573s
  1196   967 4471.28650   30  232 3067.20921 15407.7447   402%  7140 3600s

Cutting planes:
  Learned: 3
  Gomory: 17
  Implied bound: 94
  MIR: 2794
  Flow cover: 3013
  Zero half: 1
  RLT: 54
  Relax-and-lift: 335

Explored 1291 nodes (9674603 simplex iterations) in 3600.05 seconds (4444.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 3067.21 3046.43 2801.05 ... 458.878

Time limit reached
Best objective 3.067209211438e+03, best bound 1.535734858882e+04, gap 400.6945%
  WARNING: Time limit reached. Using best solution found (gap: 400.69%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 3067.21, θ = 144521.74
  Upper Bound (UB) = 3067.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144521.74
  [DEBUG]   ✓ Scenario 0: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144521.74 ≤ Q = 144521.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 144521.74 ≤ Q = 144521.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3e25edd8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3e25edd8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.277416e+13
Presolve removed 2557 rows and 1848 columns
Presolve time: 0.01s
Presolved: 536 rows, 541 columns, 1513 nonzeros
Found heuristic solution: objective 6492883.4046
Variable types: 366 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6492421.7891

Root relaxation: objective -1.598782e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159878.19    0  124 6492421.79 -159878.19   102%     -    0s
H    0     0                    -115626.4103 -159878.19  38.3%     -    0s
H    0     0                    -131804.1949 -159878.19  21.3%     -    0s
H    0     0                    -131892.4795 -159878.19  21.2%     -    0s
     0     0 -138407.72    0   65 -131892.48 -138407.72  4.94%     -    0s
H    0     0                    -135503.2465 -138339.43  2.09%     -    0s
H    0     0                    -135845.1494 -138339.43  1.84%     -    0s
H    0     0                    -136180.6040 -138339.43  1.59%     -    0s
H    0     0                    -136522.5069 -138339.43  1.33%     -    0s
     0     0 -137494.25    0   40 -136522.51 -137494.25  0.71%     -    0s
     0     0 -137406.51    0   35 -136522.51 -137406.51  0.65%     -    0s
     0     0 -137406.50    0   35 -136522.51 -137406.50  0.65%     -    0s
     0     0 -137146.01    0   27 -136522.51 -137146.01  0.46%     -    0s
     0     0 -137075.42    0   29 -136522.51 -137075.42  0.40%     -    0s
     0     0 -137074.70    0   30 -136522.51 -137074.70  0.40%     -    0s
     0     0 -136873.14    0   18 -136522.51 -136873.14  0.26%     -    0s
H    0     0                    -136626.3575 -136855.31  0.17%     -    0s
     0     0 -136855.31    0   24 -136626.36 -136855.31  0.17%     -    0s
     0     0 -136855.31    0   24 -136626.36 -136855.31  0.17%     -    0s
     0     0 -136756.20    0   20 -136626.36 -136756.20  0.10%     -    0s
     0     0 -136756.20    0   20 -136626.36 -136756.20  0.10%     -    0s
     0     0 -136671.23    0    2 -136626.36 -136671.23  0.03%     -    0s
H    0     0                    -136656.7269 -136669.95  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 1
  MIR: 5
  Flow cover: 12
  Relax-and-lift: 5

Explored 1 nodes (784 simplex iterations) in 0.17 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -136657 -136626 -136523 ... 6.49288e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.366567269084e+05, best bound -1.366699521118e+05, gap 0.0097%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 131963.89
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136656.73
  [DEBUG]   S×d_nominal = 268620.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 268620.62 + -136656.73 = 131963.89
  [DEBUG]   Current θ from Master = 144521.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12557.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9490.63
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 318.5822, Absolute Gap = 318.5822, Relative Gap = 0.103867
  Not converged yet (gap = 318.58 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654344 nonzeros
Model fingerprint: 0x4025a670
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94150 rows and 38240 columns
Presolve time: 4.74s
Presolved: 136583 rows, 57620 columns, 839408 nonzeros
Variable types: 55361 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315480.6859
Found heuristic solution: objective -191968.1850

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.48s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 6.118e+06
 Factor NZ  : 1.406e+07 (roughly 200 MB of memory)
 Factor Ops : 3.204e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.92200273e+07  2.52631080e+08  1.20e+05 1.93e+01  8.17e+04     7s
   1  -1.47804063e+07  2.23136393e+08  8.55e+04 6.87e+01  5.81e+04     7s
   2  -4.98910680e+06  1.67500973e+08  2.85e+04 8.89e-01  2.06e+04     7s
   3  -1.46675751e+06  1.39579328e+08  4.40e+03 3.81e+00  3.57e+03     8s
   4  -7.92504973e+05  1.04641788e+08  7.70e+02 2.16e+00  9.26e+02     8s
   5  -7.17981506e+05  8.35750660e+07  4.33e+02 1.66e+00  6.09e+02     8s
   6  -5.33519119e+05  4.63936442e+07  3.32e+02 3.60e-01  3.76e+02     8s
   7  -4.22038300e+05  3.88409294e+07  1.08e+02 1.90e-01  2.16e+02     8s
   8  -3.34980796e+05  2.42183211e+07  2.77e+01 3.28e-02  1.11e+02     8s
   9  -2.09615154e+05  1.43409988e+07  6.38e+00 1.87e-02  6.04e+01     8s
  10  -1.49319741e+05  7.73382303e+06  2.78e+00 9.84e-03  3.22e+01     9s
  11  -1.17307121e+05  5.32501199e+06  1.61e+00 6.75e-03  2.21e+01     9s
  12  -1.03422663e+05  3.99828637e+06  1.12e+00 5.04e-03  1.66e+01     9s
  13  -7.66958464e+04  2.74360103e+06  4.18e-01 8.19e-03  1.13e+01     9s
  14  -5.16713081e+04  7.23029146e+05  1.55e-01 8.41e-04  3.11e+00     9s
  15  -2.79784268e+04  3.76422439e+05  7.07e-02 4.29e-04  1.62e+00     9s
  16  -1.73505840e+04  2.11142751e+05  4.93e-02 3.82e-04  9.17e-01     9s
  17  -8.26660331e+03  1.74200315e+05  3.80e-02 2.50e-04  7.32e-01     9s
  18  -2.54310889e+03  1.23850811e+05  3.18e-02 8.18e-04  5.07e-01    10s
  19   4.84620298e+03  9.18075446e+04  2.38e-02 1.42e-03  3.49e-01    10s
  20   9.51494573e+03  7.73883071e+04  1.91e-02 1.34e-03  2.72e-01    10s
  21   1.41231840e+04  6.34128012e+04  1.48e-02 1.54e-03  1.98e-01    10s
  22   1.68924628e+04  5.78737285e+04  1.23e-02 1.27e-03  1.65e-01    10s
  23   1.87038750e+04  5.10903300e+04  1.09e-02 9.41e-04  1.30e-01    10s
  24   2.17321780e+04  5.00091931e+04  8.48e-03 8.79e-04  1.14e-01    11s
  25   2.36231697e+04  4.71982078e+04  7.09e-03 7.28e-04  9.46e-02    11s
  26   2.54533929e+04  4.43064200e+04  5.79e-03 5.59e-04  7.57e-02    11s
  27   2.63979275e+04  4.30700599e+04  5.14e-03 4.93e-04  6.69e-02    11s
  28   2.83936874e+04  3.96816458e+04  3.76e-03 3.25e-04  4.53e-02    11s
  29   3.04525335e+04  3.77799491e+04  2.42e-03 2.05e-04  2.94e-02    12s
  30   3.14246440e+04  3.66519769e+04  1.80e-03 1.34e-04  2.10e-02    12s
  31   3.20003597e+04  3.60384997e+04  1.46e-03 9.59e-05  1.62e-02    12s
  32   3.23014127e+04  3.57546857e+04  1.28e-03 7.71e-05  1.39e-02    12s
  33   3.31761429e+04  3.54309418e+04  7.61e-04 5.69e-05  9.05e-03    12s
  34   3.36257928e+04  3.48960656e+04  4.88e-04 2.37e-05  5.10e-03    13s
  35   3.39412625e+04  3.47127175e+04  2.97e-04 1.29e-05  3.10e-03    13s
  36   3.40641889e+04  3.46543406e+04  2.26e-04 9.59e-06  2.37e-03    13s
  37   3.41747270e+04  3.45812309e+04  1.63e-04 5.48e-06  1.63e-03    13s
  38   3.41835162e+04  3.45655869e+04  1.58e-04 4.65e-06  1.53e-03    13s
  39   3.42031844e+04  3.45533565e+04  1.48e-04 4.00e-06  1.41e-03    14s
  40   3.43103551e+04  3.45237084e+04  8.80e-05 2.37e-06  8.57e-04    14s
  41   3.43394726e+04  3.45180426e+04  7.29e-05 2.03e-06  7.17e-04    14s
  42   3.43735555e+04  3.44984621e+04  5.50e-05 2.51e-06  5.02e-04    14s
  43   3.43939687e+04  3.44953196e+04  4.43e-05 2.08e-06  4.07e-04    14s
  44   3.44078503e+04  3.44938035e+04  3.69e-05 1.87e-06  3.45e-04    15s
  45   3.44503100e+04  3.44855593e+04  1.39e-05 8.10e-07  1.42e-04    15s
  46   3.44759970e+04  3.44789338e+04  7.77e-07 6.35e-08  1.18e-05    15s
  47   3.44780742e+04  3.44781419e+04  5.01e-09 2.20e-08  2.72e-07    15s
  48   3.44780786e+04  3.44780799e+04  9.97e-10 2.59e-06  5.42e-09    16s
  49   3.44780786e+04  3.44780798e+04  2.32e-07 2.33e-06  4.92e-09    16s
  50   3.44780792e+04  3.44780792e+04  7.82e-08 1.37e-06  1.29e-11    16s

Barrier solved model in 50 iterations and 16.11 seconds (13.63 work units)
Optimal objective 3.44780792e+04


Root crossover log...

  119652 DPushes remaining with DInf 4.5415200e-08                16s
    5562 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    1781 PPushes remaining with PInf 6.3099831e-07                22s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2225783e-10     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53561    3.4478079e+04   0.000000e+00   0.000000e+00     22s
   53561    3.4478079e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.447808e+04, 53561 iterations, 16.49 seconds (19.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34478.0792    0  243 -191968.18 34478.0792   118%     -   23s
H    0     0                    -188636.7549 34478.0792   118%     -   23s
H    0     0                    -128481.4443 34478.0792   127%     -   23s
H    0     0                    -127476.7603 34478.0792   127%     -   23s
H    0     0                    -125148.1470 34478.0792   128%     -   24s
H    0     0                    -123654.6918 34478.0792   128%     -   24s
H    0     0                    -72704.86679 34478.0792   147%     -   24s
H    0     0                    -71169.04822 34478.0792   148%     -   24s
H    0     0                    -29177.48909 34478.0792   218%     -   24s
H    0     0                    -22911.65597 34478.0792   250%     -   26s
H    0     0                    -17201.37157 34478.0792   300%     -   26s
H    0     0                    -12459.10769 34478.0792   377%     -   26s
     0     0 28128.7533    0  260 -12459.108 28128.7533   326%     -  115s
H    0     0                    -11550.99310 28119.2033   343%     -  116s
H    0     0                    -11495.10117 28119.2033   345%     -  116s
H    0     0                    -10131.99715 28119.2033   378%     -  116s
     0     0 27695.8139    0  303 -10131.997 27695.8139   373%     -  168s
     0     0 27649.6359    0  309 -10131.997 27649.6359   373%     -  175s
     0     0 27628.1029    0  311 -10131.997 27628.1029   373%     -  179s
     0     0 27626.7913    0  304 -10131.997 27626.7913   373%     -  181s
     0     0 27626.5515    0  308 -10131.997 27626.5515   373%     -  183s
     0     0 24315.7068    0  261 -10131.997 24315.7068   340%     -  249s
H    0     0                    -2962.668598 24315.6505   921%     -  250s
H    0     0                    -2304.470237 24315.6505  1155%     -  250s
     0     0 23617.8440    0  363 -2304.4702 23617.8440  1125%     -  307s
     0     0 23350.3129    0  363 -2304.4702 23350.3129  1113%     -  329s
     0     0 23065.8766    0  406 -2304.4702 23065.8766  1101%     -  356s
     0     0 22949.8330    0  412 -2304.4702 22949.8330  1096%     -  366s
     0     0 22826.4469    0  416 -2304.4702 22826.4469  1091%     -  376s
     0     0 22467.6687    0  356 -2304.4702 22467.6687  1075%     -  406s
     0     0 22416.2232    0  364 -2304.4702 22416.2232  1073%     -  414s
     0     0 22390.4731    0  369 -2304.4702 22390.4731  1072%     -  420s
     0     0 22348.8738    0  396 -2304.4702 22348.8738  1070%     -  427s
     0     0 22348.5534    0  398 -2304.4702 22348.5534  1070%     -  430s
     0     0 19743.9444    0  427 -2304.4702 19743.9444   957%     -  503s
H    0     0                    -2272.997464 19742.8016   969%     -  504s
H    0     0                    -2272.328678 19742.8016   969%     -  504s
H    0     0                    -2224.537648 19742.8016   988%     -  504s
     0     0 19059.0217    0  409 -2224.5376 19059.0217   957%     -  548s
     0     0 18745.4483    0  404 -2224.5376 18745.4483   943%     -  576s
     0     0 18507.8236    0  484 -2224.5376 18507.8236   932%     -  609s
     0     0 18426.9900    0  400 -2224.5376 18426.9900   928%     -  623s
     0     0 18417.1269    0  396 -2224.5376 18417.1269   928%     -  629s
     0     0 18407.9996    0  491 -2224.5376 18407.9996   927%     -  637s
     0     0 18361.2630    0  390 -2224.5376 18361.2630   925%     -  646s
     0     0 18327.6761    0  387 -2224.5376 18327.6761   924%     -  654s
     0     0 18323.6621    0  438 -2224.5376 18323.6621   924%     -  659s
     0     0 18320.3780    0  384 -2224.5376 18320.3780   924%     -  662s
     0     0 18301.3022    0  389 -2224.5376 18301.3022   923%     -  669s
     0     0 18294.9215    0  397 -2224.5376 18294.9215   922%     -  674s
     0     0 18293.6315    0  394 -2224.5376 18293.6315   922%     -  676s
     0     0 17307.4770    0  471 -2224.5376 17307.4770   878%     -  739s
     0     0 17142.6548    0  481 -2224.5376 17142.6548   871%     -  762s
     0     0 17030.1145    0  481 -2224.5376 17030.1145   866%     -  783s
     0     0 16970.6819    0  487 -2224.5376 16970.6819   863%     -  800s
     0     0 16949.3869    0  478 -2224.5376 16949.3869   862%     -  814s
     0     0 16934.8752    0  546 -2224.5376 16934.8752   861%     -  821s
     0     0 16923.8497    0  482 -2224.5376 16923.8497   861%     -  828s
     0     0 16914.1751    0  483 -2224.5376 16914.1751   860%     -  834s
     0     0 16902.7200    0  491 -2224.5376 16902.7200   860%     -  839s
     0     0 16873.8278    0  498 -2224.5376 16873.8278   859%     -  853s
     0     0 16863.9322    0  497 -2224.5376 16863.9322   858%     -  860s
     0     0 16862.3668    0  490 -2224.5376 16862.3668   858%     -  863s
     0     0 16567.1184    0  414 -2224.5376 16567.1184   845%     -  902s
     0     0 16513.3804    0  416 -2224.5376 16513.3804   842%     -  922s
     0     0 16483.9119    0  420 -2224.5376 16483.9119   841%     -  929s
     0     0 16480.4649    0  481 -2224.5376 16480.4649   841%     -  933s
     0     0 16475.1268    0  477 -2224.5376 16475.1268   841%     -  940s
     0     0 16467.8814    0  529 -2224.5376 16467.8814   840%     -  945s
     0     0 16466.2038    0  476 -2224.5376 16466.2038   840%     -  946s
     0     0 16390.7081    0  451 -2224.5376 16390.7081   837%     -  963s
H    0     0                    1417.1156311 16389.8044  1057%     -  987s
H    0     0                    1700.5985686 16389.8044   864%     -  987s
H    0     0                    1797.4286340 16389.8044   812%     -  989s
     0     0 16362.9680    0  459 1797.42863 16362.9680   810%     - 1003s
     0     0 16348.8949    0  414 1797.42863 16348.8949   810%     - 1008s
     0     0 16345.5113    0  407 1797.42863 16345.5113   809%     - 1012s
     0     0 16342.5467    0  479 1797.42863 16342.5467   809%     - 1016s
     0     0 16339.1996    0  520 1797.42863 16339.1996   809%     - 1019s
     0     0 16337.2817    0  527 1797.42863 16337.2817   809%     - 1021s
     0     0 16297.3412    0  410 1797.42863 16297.3412   807%     - 1036s
H    0     0                    1854.8855697 16296.9879   779%     - 1037s
     0     0 16284.6368    0  417 1854.88557 16284.6368   778%     - 1047s
     0     0 16279.0908    0  425 1854.88557 16279.0908   778%     - 1052s
     0     0 16276.7928    0  429 1854.88557 16276.7928   778%     - 1055s
     0     0 16247.3926    0  419 1854.88557 16247.3926   776%     - 1068s
H    0     0                    1891.9651691 16243.9587   759%     - 1069s
H    0     0                    2044.8539052 16243.9587   694%     - 1071s
H    0     0                    2159.0989752 16243.9587   652%     - 1071s
H    0     0                    2328.1236534 16243.9587   598%     - 1071s
H    0     0                    2377.6211269 16243.9587   583%     - 1072s
     0     0 16230.0232    0  411 2377.62113 16230.0232   583%     - 1080s
     0     0 16225.7160    0  428 2377.62113 16225.7160   582%     - 1085s
     0     0 16224.9903    0  428 2377.62113 16224.9903   582%     - 1086s
     0     0 16209.8318    0  430 2377.62113 16209.8318   582%     - 1096s
     0     0 16205.9270    0  446 2377.62113 16205.9270   582%     - 1101s
     0     0 16190.9584    0  444 2377.62113 16190.9584   581%     - 1106s
     0     0 16188.8730    0  449 2377.62113 16188.8730   581%     - 1110s
     0     0 16150.7913    0  423 2377.62113 16150.7913   579%     - 1124s
H    0     0                    2463.6891423 16150.4955   556%     - 1168s
     0     0 16131.1939    0  439 2463.68914 16131.1939   555%     - 1178s
     0     0 16126.5988    0  443 2463.68914 16126.5988   555%     - 1182s
     0     0 16124.6439    0  442 2463.68914 16124.6439   554%     - 1185s
     0     0 16120.9714    0  432 2463.68914 16120.9714   554%     - 1191s
     0     0 16119.7176    0  435 2463.68914 16119.7176   554%     - 1193s
     0     0 16115.8427    0  431 2463.68914 16115.8427   554%     - 1200s
     0     0 16114.0786    0  431 2463.68914 16114.0786   554%     - 1203s
     0     0 16112.9091    0  429 2463.68914 16112.9091   554%     - 1207s
     0     0 16111.8067    0  431 2463.68914 16111.8067   554%     - 1209s
     0     0 16106.4917    0  431 2463.68914 16106.4917   554%     - 1215s
     0     0 16105.8902    0  431 2463.68914 16105.8902   554%     - 1224s
H    0     0                    2720.0901787 16105.7396   492%     - 1538s
     0     2 16105.7396    0  431 2720.09018 16105.7396   492%     - 1542s
     1     3 15895.8623    1  393 2720.09018 16105.7396   492% 23771 1600s
     2     4 16036.3516    1  449 2720.09018 16036.3516   490% 15992 1617s
     3     5 14815.1772    2  448 2720.09018 16035.7979   490% 13600 1641s
     4    10 14171.8461    3  439 2720.09018 16035.7979   490% 13911 1668s
     9    19 13010.1404    4  326 2720.09018 15784.8398   480% 10448 1726s
    18    38 12248.6131    5  295 2720.09018 15584.4964   473% 12264 1758s
    37    51 14950.0934    5  485 2720.09018 15406.2915   466% 15892 1846s
    50    75 13348.2499    6  280 2720.09018 15406.2915   466% 18364 1915s
    74   179 13265.7365    7  276 2720.09018 15406.2915   466% 16814 1980s
   178   208 13252.7167    8  275 2720.09018 15406.2915   466% 10866 2021s
   207   245 13167.5648    9  260 2720.09018 15406.2915   466% 10307 2067s
   244   279 13086.9646   10  266 2720.09018 15406.2915   466%  9577 2107s
H  248   279                    2923.7182658 15406.2915   427%  9511 2107s
   278   342 12968.0177   11  266 2923.71827 15406.2915   427%  9207 2153s
   341   396 12745.5052   12  242 2923.71827 15406.2915   427%  8585 2198s
   397   432 10467.3106   18  237 2923.71827 15406.2915   427%  8006 2245s
   441   470 12603.0155   13  249 2923.71827 15406.2915   427%  7681 2287s
   493   506 6429.64757   26  194 2923.71827 15406.2915   427%  7331 2332s
   537   533 12252.3421   12  304 2923.71827 15406.2915   427%  7100 2372s
   564   558 11463.3231   13  244 2923.71827 15406.2915   427%  7105 2451s
   595   603 11696.6950   15  259 2923.71827 15406.2915   427%  7051 2493s
   642   635 6922.76528   20  286 2923.71827 15406.2915   427%  6820 2531s
   692   670 12756.2707   11  246 2923.71827 15406.2915   427%  6674 2573s
   737   703 12031.5105   12  239 2923.71827 15406.2915   427%  6527 2615s
   784   752 11298.3908   13  226 2923.71827 15406.2915   427%  6417 2656s
   843   800 6029.29570   24  392 2923.71827 15406.2915   427%  6253 2697s
   899   843 10312.3058   13  223 2923.71827 15406.2915   427%  6168 2737s
   970   894 9768.42918   14  231 2923.71827 15406.2915   427%  5986 2781s
  1043   951 9283.50624   15  297 2923.71827 15406.2915   427%  5794 2831s
  1122  1007 9131.17944   16  223 2923.71827 15406.2915   427%  5661 2875s
  1224  1062 8548.59422   18  280 2923.71827 15406.2915   427%  5460 2928s
  1323  1081     cutoff   19      2923.71827 15406.2915   427%  5266 2973s
  1362  1132 6893.33104   14  178 2923.71827 15406.2915   427%  5260 3021s
  1451  1208 6508.23833   15  184 2923.71827 15406.2915   427%  5124 3074s
  1562  1287 4652.11865   17  180 2923.71827 15406.2915   427%  4987 3134s
  1681  1336 3452.77983   19  174 2923.71827 15406.2915   427%  4882 3193s
  1800  1399 3797.41362   19  161 2923.71827 15406.2915   427%  4800 3258s
  1914  1481 4824.10493   18  153 2923.71827 15406.2915   427%  4725 3327s
  2043  1576     cutoff   21      2923.71827 15406.2915   427%  4670 3393s
  2182  1690 4822.59217   22  107 2923.71827 15406.2915   427%  4604 3463s
  2357  1772 12335.6687   10  299 2923.71827 15406.2915   427%  4483 3539s
  2548  1835 11044.7684   12  190 2923.71827 15406.2915   427%  4356 3600s

Cutting planes:
  Learned: 2
  Gomory: 12
  Implied bound: 196
  MIR: 2878
  Flow cover: 3321
  RLT: 77
  Relax-and-lift: 525

Explored 2681 nodes (12178195 simplex iterations) in 3600.07 seconds (4998.99 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 2923.72 2720.09 2463.69 ... 1797.43

Time limit reached
Best objective 2.923718265782e+03, best bound 1.540629148414e+04, gap 426.9417%
  WARNING: Time limit reached. Using best solution found (gap: 426.94%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 2923.72, θ = 145460.53
  Upper Bound (UB) = 2923.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145460.53
  [DEBUG]   ✓ Scenario 0: θ = 145460.53 ≤ Q = 145460.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145460.53 ≤ Q = 145460.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145460.53 ≤ Q = 145460.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145460.53 ≤ Q = 145460.53 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4e957ebe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb16a8142
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.268875e+13
Presolve removed 2557 rows and 1848 columns
Presolve time: 0.01s
Presolved: 536 rows, 541 columns, 1513 nonzeros
Found heuristic solution: objective 6473886.9063
Variable types: 366 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6473425.2908

Root relaxation: objective -1.589044e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158904.37    0  123 6473425.29 -158904.37   102%     -    0s
H    0     0                    -107525.7399 -158904.37  47.8%     -    0s
H    0     0                    -116370.9807 -158904.37  36.5%     -    0s
H    0     0                    -130519.6787 -132586.80  1.58%     -    0s
     0     0 -132586.80    0   59 -130519.68 -132586.80  1.58%     -    0s
H    0     0                    -130864.5116 -132521.02  1.27%     -    0s
H    0     0                    -131049.2308 -132521.02  1.12%     -    0s
     0     0 -131986.31    0   52 -131049.23 -131986.31  0.72%     -    0s
     0     0 -131955.73    0   45 -131049.23 -131955.73  0.69%     -    0s
H    0     0                    -131051.4971 -131941.04  0.68%     -    0s
     0     0 -131941.04    0   45 -131051.50 -131941.04  0.68%     -    0s
H    0     0                    -131088.0723 -131941.04  0.65%     -    0s
     0     0 -131643.93    0   46 -131088.07 -131643.93  0.42%     -    0s
     0     0 -131618.53    0   46 -131088.07 -131618.53  0.40%     -    0s
     0     0 -131435.50    0   38 -131088.07 -131435.50  0.27%     -    0s
     0     0 -131408.46    0   40 -131088.07 -131408.46  0.24%     -    0s
     0     0 -131407.50    0   38 -131088.07 -131407.50  0.24%     -    0s
     0     0 -131407.22    0   39 -131088.07 -131407.22  0.24%     -    0s
     0     0 -131403.74    0   38 -131088.07 -131403.74  0.24%     -    0s
     0     0 -131396.26    0   38 -131088.07 -131396.26  0.24%     -    0s
     0     0 -131396.26    0   42 -131088.07 -131396.26  0.24%     -    0s
     0     0 -131396.26    0   38 -131088.07 -131396.26  0.24%     -    0s
     0     0 -131396.26    0   34 -131088.07 -131396.26  0.24%     -    0s
     0     0 -131391.75    0   35 -131088.07 -131391.75  0.23%     -    0s
     0     0 -131386.03    0   33 -131088.07 -131386.03  0.23%     -    0s
H    0     0                    -131122.5059 -131372.39  0.19%     -    0s
     0     0 -131372.39    0   33 -131122.51 -131372.39  0.19%     -    0s
     0     0 -131372.39    0   33 -131122.51 -131372.39  0.19%     -    0s
H    0     0                    -131138.2551 -131372.39  0.18%     -    0s
H    0     0                    -131197.5317 -131372.39  0.13%     -    0s
     0     0 -131372.39    0   37 -131197.53 -131372.39  0.13%     -    0s
     0     0 -131372.39    0   42 -131197.53 -131372.39  0.13%     -    0s
     0     0 -131372.39    0   35 -131197.53 -131372.39  0.13%     -    0s
     0     0 -131372.39    0   35 -131197.53 -131372.39  0.13%     -    0s
H    0     0                    -131200.8121 -131372.39  0.13%     -    0s
     0     0 -131372.39    0   35 -131200.81 -131372.39  0.13%     -    0s
     0     0 -131361.97    0   35 -131200.81 -131361.97  0.12%     -    0s
     0     0 -131361.97    0   35 -131200.81 -131361.97  0.12%     -    0s
     0     2 -131361.97    0   35 -131200.81 -131361.97  0.12%     -    0s
*   15     3               5    -131202.0147 -131291.95  0.07%   8.3    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 43
  Flow cover: 16

Explored 22 nodes (1307 simplex iterations) in 0.43 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -131202 -131201 -131198 ... -116371

Optimal solution found (tolerance 1.00e-04)
Best objective -1.312020146727e+05, best bound -1.312080956942e+05, gap 0.0046%
  Subproblem solved in 0.45s
  Worst-case operational profit (Z_SP) = 137418.61
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131202.01
  [DEBUG]   S×d_nominal = 268620.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 268620.62 + -131202.01 = 137418.61
  [DEBUG]   Current θ from Master = 145460.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8041.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5118.20
  Lower Bound (LB) = 2748.63
  Gap (UB-LB) = 175.0912, Absolute Gap = 175.0912, Relative Gap = 0.059886
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 15
Total Time: 40107.49s
Converged: True
Final Lower Bound: 2748.6270
Final Upper Bound: 2923.7183
Final Gap: 175.091218
Number of Critical Scenarios: 15
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 4, 5, 6] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 0 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 15
Start Time: 2026-01-05 18:13:29
End Time: 2026-01-06 05:21:57
Total Time: 40107.49s
Optimal Value: 2748.63
Lower Bound: 2748.63
Upper Bound: 2923.72
Gap: 175.091218
Plants Opened: {0: [2], 1: [0], 2: [0]} (3 plants)
DCs Opened: [2, 4, 5, 6] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed42_MD_gamma20_20260106_052157.csv

Total Execution Time: 40108.39 seconds
End Time: 2026-01-06 05:21:57

All tasks completed successfully!

