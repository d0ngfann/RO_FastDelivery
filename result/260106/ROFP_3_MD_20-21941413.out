
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 3
DI Scenario: MD
Start Time: 2026-01-05 15:25:19
================================================================================
Loading data from data/DH_data_full_seed3.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.241', '1.540'] (k=0.532)
  Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
  Product 2: ['1.000', '1.230', '1.514'] (k=0.512)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1680
  DC capacity (MC): min=517, max=897

Demand Structure (s_rk matrix):
  Total customer-product pairs: 72/150 (52.0% sparse)
  Average products per customer: 1.44

Demand (only non-zero entries):
  Nominal (μ): min=8.19, max=34.85, count=72
  Deviation (μ̂): min=4.03, max=9.90

Costs:
  Plant fixed cost: min=5861, max=8650
  DC fixed cost: min=3689, max=4911
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.390', '1.932'] (k=0.812)
    Product 2: ['1.000', '1.313', '1.725'] (k=0.672)
  MD:
    Product 0: ['1.000', '1.241', '1.540'] (k=0.532)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.230', '1.514'] (k=0.512)
  LD:
    Product 0: ['1.000', '1.001', '1.002'] (k=0.002)
    Product 1: ['1.000', '1.130', '1.276'] (k=0.301)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
  Mixed:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48726 nonzeros
Model fingerprint: 0xa644153b
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12199 rows and 3199 columns
Presolve time: 0.18s
Presolved: 4474 rows, 5301 columns, 31241 nonzeros
Variable types: 3042 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -302682.4847
Found heuristic solution: objective -171323.3514

Root relaxation: objective 9.084428e+04, 4394 iterations, 0.21 seconds (0.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 90844.2756    0  470 -171323.35 90844.2756   153%     -    0s
H    0     0                    -170800.5805 90844.2756   153%     -    0s
H    0     0                    -169795.4741 90844.2756   154%     -    0s
     0     0 82028.3730    0  628 -169795.47 82028.3730   148%     -    1s
     0     0 81882.1946    0  646 -169795.47 81882.1946   148%     -    1s
     0     0 81878.5792    0  646 -169795.47 81878.5792   148%     -    1s
H    0     0                    -161621.1566 79079.3274   149%     -    2s
     0     0 79079.3274    0  993 -161621.16 79079.3274   149%     -    2s
H    0     0                    -153216.8119 79072.1717   152%     -    2s
     0     0 78955.6106    0  998 -153216.81 78955.6106   152%     -    2s
     0     0 78951.6171    0  994 -153216.81 78951.6171   152%     -    2s
     0     0 78951.2360    0  999 -153216.81 78951.2360   152%     -    2s
H    0     0                    -151414.5119 76272.6071   150%     -    3s
     0     0 76272.6071    0 1174 -151414.51 76272.6071   150%     -    3s
H    0     0                    -59687.21502 75898.2595   227%     -    4s
H    0     0                    2055.9453513 75898.2595  3592%     -    4s
H    0     0                    7323.8017430 75898.2595   936%     -    4s
     0     0 75898.2595    0 1161 7323.80174 75898.2595   936%     -    4s
     0     0 75837.2279    0 1172 7323.80174 75837.2279   935%     -    4s
     0     0 75805.7286    0 1163 7323.80174 75805.7286   935%     -    5s
     0     0 75803.4720    0 1164 7323.80174 75803.4720   935%     -    5s
     0     0 73414.8739    0 1189 7323.80174 73414.8739   902%     -    6s
     0     0 73202.9935    0 1215 7323.80174 73202.9935   900%     -    7s
     0     0 73160.4017    0 1208 7323.80174 73160.4017   899%     -    7s
     0     0 73150.1649    0 1222 7323.80174 73150.1649   899%     -    7s
     0     0 73148.2213    0 1221 7323.80174 73148.2213   899%     -    7s
H    0     0                    7483.4941217 73148.2213   877%     -    7s
H    0     0                    7539.0349465 73148.2213   870%     -    7s
H    0     0                    7563.4024423 73148.2213   867%     -    7s
H    0     0                    7606.5442532 73148.2213   862%     -    7s
H    0     0                    7728.9089271 73148.2213   846%     -    7s
H    0     0                    7731.1676571 71647.6958   827%     -    9s
H    0     0                    7784.8416805 71647.6958   820%     -    9s
H    0     0                    7794.3893232 71647.6958   819%     -    9s
H    0     0                    7795.0094328 71647.6958   819%     -    9s
H    0     0                    7848.0633466 71647.6958   813%     -    9s
H    0     0                    7966.9556319 71647.6958   799%     -    9s
H    0     0                    22583.576493 71647.6958   217%     -    9s
     0     0 71647.6958    0 1173 22583.5765 71647.6958   217%     -    9s
     0     0 71422.0930    0 1207 22583.5765 71422.0930   216%     -    9s
H    0     0                    22982.585458 71376.0500   211%     -    9s
H    0     0                    23225.481624 71376.0500   207%     -    9s
H    0     0                    24110.517763 71376.0500   196%     -    9s
H    0     0                    24118.865079 71376.0500   196%     -    9s
H    0     0                    24145.340818 71376.0500   196%     -    9s
H    0     0                    24171.739828 71376.0500   195%     -    9s
H    0     0                    24242.374464 71376.0500   194%     -    9s
     0     0 71376.0500    0 1220 24242.3745 71376.0500   194%     -    9s
     0     0 71368.3869    0 1227 24242.3745 71368.3869   194%     -   10s
H    0     0                    24384.642963 70243.9273   188%     -   11s
H    0     0                    24537.085263 70243.9273   186%     -   11s
H    0     0                    24699.392071 70243.9273   184%     -   11s
H    0     0                    25105.449416 70243.9273   180%     -   11s
H    0     0                    25233.831608 70243.9273   178%     -   11s
H    0     0                    25330.879438 70243.9273   177%     -   11s
H    0     0                    25369.892664 70243.9273   177%     -   11s
H    0     0                    25382.831626 70243.9273   177%     -   11s
H    0     0                    25395.914791 70243.9273   177%     -   11s
H    0     0                    25495.540260 70243.9273   176%     -   11s
H    0     0                    25552.379078 70243.9273   175%     -   11s
H    0     0                    25665.135145 70243.9273   174%     -   11s
H    0     0                    25794.400123 70243.9273   172%     -   11s
H    0     0                    25834.903357 70243.9273   172%     -   11s
     0     0 70243.9273    0 1183 25834.9034 70243.9273   172%     -   11s
     0     0 70067.7739    0 1207 25834.9034 70067.7739   171%     -   12s
     0     0 70014.0404    0 1214 25834.9034 70014.0404   171%     -   13s
     0     0 70008.2665    0 1227 25834.9034 70008.2665   171%     -   13s
     0     0 69425.2136    0 1183 25834.9034 69425.2136   169%     -   14s
     0     0 69315.4942    0 1235 25834.9034 69315.4942   168%     -   15s
     0     0 69277.2494    0 1226 25834.9034 69277.2494   168%     -   15s
     0     0 69268.0163    0 1234 25834.9034 69268.0163   168%     -   15s
     0     0 67795.5577    0 1148 25834.9034 67795.5577   162%     -   17s
     0     0 67441.8421    0 1202 25834.9034 67441.8421   161%     -   19s
     0     0 67337.6380    0 1201 25834.9034 67337.6380   161%     -   19s
     0     0 67311.0511    0 1233 25834.9034 67311.0511   161%     -   19s
     0     0 67305.1817    0 1233 25834.9034 67305.1817   161%     -   20s
     0     0 66645.0515    0 1168 25834.9034 66645.0515   158%     -   21s
     0     0 66428.0797    0 1187 25834.9034 66428.0797   157%     -   22s
H    0     0                    25904.353512 66394.5585   156%     -   23s
H    0     0                    25904.720073 66394.5585   156%     -   23s
     0     0 66394.5585    0 1203 25904.7201 66394.5585   156%     -   23s
     0     0 66383.1990    0 1213 25904.7201 66383.1990   156%     -   23s
     0     0 65939.7632    0 1176 25904.7201 65939.7632   155%     -   25s
     0     0 65830.3380    0 1230 25904.7201 65830.3380   154%     -   26s
H    0     0                    25920.763676 65787.9064   154%     -   27s
H    0     0                    25925.628359 65787.9064   154%     -   27s
H    0     0                    25943.554500 65787.9064   154%     -   27s
H    0     0                    25954.526081 65787.9064   153%     -   27s
     0     0 65787.9064    0 1203 25954.5261 65787.9064   153%     -   27s
H    0     0                    25967.675319 65776.7477   153%     -   28s
     0     0 65776.7477    0 1211 25967.6753 65776.7477   153%     -   28s
     0     0 65367.6963    0 1233 25967.6753 65367.6963   152%     -   29s
     0     0 65280.4698    0 1293 25967.6753 65280.4698   151%     -   31s
     0     0 65259.3208    0 1282 25967.6753 65259.3208   151%     -   31s
     0     0 64927.9268    0 1207 25967.6753 64927.9268   150%     -   33s
     0     0 64847.2582    0 1231 25967.6753 64847.2582   150%     -   34s
     0     0 64804.9238    0 1221 25967.6753 64804.9238   150%     -   35s
     0     0 64793.7978    0 1236 25967.6753 64793.7978   150%     -   35s
H    0     0                    25975.553076 64541.2658   148%     -   37s
H    0     0                    25985.532471 64541.2658   148%     -   37s
H    0     0                    25994.118187 64541.2658   148%     -   37s
H    0     0                    26004.693711 64541.2658   148%     -   37s
H    0     0                    26068.676327 64541.2658   148%     -   37s
H    0     0                    26084.023823 64541.2658   147%     -   37s
H    0     0                    26097.552301 64541.2658   147%     -   37s
     0     0 64541.2658    0 1202 26097.5523 64541.2658   147%     -   37s
     0     0 64486.5146    0 1186 26097.5523 64486.5146   147%     -   38s
     0     0 64455.1250    0 1187 26097.5523 64455.1250   147%     -   38s
     0     0 64449.8276    0 1201 26097.5523 64449.8276   147%     -   39s
H    0     0                    26121.939667 63426.8225   143%     -   41s
H    0     0                    26122.806796 63426.8225   143%     -   41s
H    0     0                    26123.387911 63426.8225   143%     -   41s
H    0     0                    26137.957795 63426.8225   143%     -   41s
H    0     0                    26245.083281 63426.8225   142%     -   41s
     0     0 63426.8225    0 1099 26245.0833 63426.8225   142%     -   41s
H    0     0                    27824.874491 63209.7152   127%     -   42s
H    0     0                    28287.607177 63209.7152   123%     -   42s
H    0     0                    28741.071528 63209.7152   120%     -   42s
H    0     0                    29417.713843 63209.7152   115%     -   42s
H    0     0                    29771.243417 63209.7152   112%     -   42s
H    0     0                    29871.947288 63209.7152   112%     -   42s
H    0     0                    29877.484545 63209.7152   112%     -   42s
H    0     0                    30258.900032 63209.7152   109%     -   42s
H    0     0                    30386.517652 63209.7152   108%     -   42s
     0     0 63209.7152    0 1155 30386.5177 63209.7152   108%     -   42s
H    0     0                    30421.508659 63158.2226   108%     -   43s
H    0     0                    30551.393260 63158.2226   107%     -   43s
     0     0 63158.2226    0 1183 30551.3933 63158.2226   107%     -   43s
     0     0 63141.2727    0 1214 30551.3933 63141.2727   107%     -   43s
     0     0 62683.8281    0 1139 30551.3933 62683.8281   105%     -   45s
     0     0 62601.0558    0 1207 30551.3933 62601.0558   105%     -   46s
     0     0 62574.9584    0 1194 30551.3933 62574.9584   105%     -   47s
     0     0 59983.0827    0 1093 30551.3933 59983.0827  96.3%     -   50s
     0     0 59544.6583    0 1180 30551.3933 59544.6583  94.9%     -   52s
     0     0 59428.6783    0 1174 30551.3933 59428.6783  94.5%     -   53s
     0     0 59396.4782    0 1183 30551.3933 59396.4782  94.4%     -   53s
     0     0 59386.4956    0 1200 30551.3933 59386.4956  94.4%     -   53s
     0     0 58184.0883    0 1140 30551.3933 58184.0883  90.4%     -   56s
     0     0 57879.6798    0 1162 30551.3933 57879.6798  89.5%     -   58s
     0     0 57808.7227    0 1223 30551.3933 57808.7227  89.2%     -   58s
     0     0 57773.1896    0 1244 30551.3933 57773.1896  89.1%     -   59s
     0     0 57762.8462    0 1233 30551.3933 57762.8462  89.1%     -   59s
H    0     0                    30739.480156 56062.8553  82.4%     -   63s
H    0     0                    30768.264130 56062.8553  82.2%     -   63s
H    0     0                    30888.833924 56062.8553  81.5%     -   63s
H    0     0                    31124.751622 56062.8553  80.1%     -   63s
H    0     0                    31747.410867 56062.8553  76.6%     -   63s
H    0     0                    32041.180094 56062.8553  75.0%     -   63s
     0     0 56062.8553    0 1099 32041.1801 56062.8553  75.0%     -   63s
H    0     0                    32078.724196 56062.5613  74.8%     -   63s
H    0     0                    32196.199736 56062.5613  74.1%     -   63s
     0     0 55674.6632    0 1123 32196.1997 55674.6632  72.9%     -   65s
     0     0 55538.6576    0 1137 32196.1997 55538.6576  72.5%     -   66s
     0     0 55502.9243    0 1141 32196.1997 55502.9243  72.4%     -   66s
H    0     0                    32334.762937 51661.6184  59.8%     -   70s
H    0     0                    32434.849597 51661.6184  59.3%     -   70s
H    0     0                    32849.783616 51661.6184  57.3%     -   70s
H    0     0                    33183.085013 51661.6184  55.7%     -   70s
     0     0 51661.6184    0  895 33183.0850 51661.6184  55.7%     -   70s
H    0     0                    33234.354452 50986.7635  53.4%     -   72s
     0     0 50986.7635    0  893 33234.3545 50986.7635  53.4%     -   72s
     0     0 50775.7139    0  908 33234.3545 50775.7139  52.8%     -   72s
     0     0 50710.3095    0  973 33234.3545 50710.3095  52.6%     -   73s
     0     0 50689.4388    0  903 33234.3545 50689.4388  52.5%     -   73s
     0     0 46818.2450    0  637 33234.3545 46818.2450  40.9%     -   76s
     0     0 46159.3648    0  553 33234.3545 46159.3648  38.9%     -   78s
     0     0 45986.2604    0  649 33234.3545 45986.2604  38.4%     -   78s
     0     0 45897.4636    0  418 33234.3545 45897.4636  38.1%     -   79s
     0     0 45860.4179    0  697 33234.3545 45860.4179  38.0%     -   79s
     0     0 45262.7931    0  788 33234.3545 45262.7931  36.2%     -   80s
     0     0 44973.2037    0  723 33234.3545 44973.2037  35.3%     -   81s
     0     0 44904.4848    0  758 33234.3545 44904.4848  35.1%     -   81s
     0     0 44891.0488    0  750 33234.3545 44891.0488  35.1%     -   82s
     0     0 44628.3987    0  683 33234.3545 44628.3987  34.3%     -   82s
     0     0 44561.0100    0  747 33234.3545 44561.0100  34.1%     -   83s
     0     0 44495.6233    0  786 33234.3545 44495.6233  33.9%     -   84s
     0     0 44450.9558    0  732 33234.3545 44450.9558  33.8%     -   84s
     0     0 44303.0816    0  769 33234.3545 44303.0816  33.3%     -   85s
     0     0 44302.1683    0  769 33234.3545 44302.1683  33.3%     -   85s
     0     2 44302.1683    0  769 33234.3545 44302.1683  33.3%     -   87s
     7    16 42796.0076    3  643 33234.3545 43432.6215  30.7%  2172   91s
    31    64 42038.5927    5  540 33234.3545 42952.3392  29.2%  2629   95s
H   33    64                    33287.149902 42952.3392  29.0%  2496   95s
H   47    64                    33350.253955 42952.1891  28.8%  2121   95s
H   99   220                    33744.013290 42809.8534  26.9%  2132   99s
H  105   220                    34051.315379 42809.8534  25.7%  2062   99s
H  119   220                    34807.254535 42809.8534  23.0%  1903   99s
   221   323 41319.2483   10  438 34807.2545 42809.8534  23.0%  1320  100s
   615   610 39752.3542   16  375 34807.2545 42809.8534  23.0%   826  105s
H  617   610                    34983.505599 42809.8534  22.4%   825  105s
H  780   692                    35012.505964 42541.6884  21.5%   748  107s
   899   773 35807.1033   23  336 35012.5060 42541.6884  21.5%   730  111s
  1099   937 35842.2699   24  365 35012.5060 42541.6884  21.5%   721  116s
  1398  1122 35634.8532   30  334 35012.5060 42257.2584  20.7%   678  121s
  1746  1383 39244.4104    9  323 35012.5060 41826.8154  19.5%   633  125s
  2190  1541 37658.9804   14  249 35012.5060 41716.0735  19.1%   590  130s
  2572  1739     cutoff   17      35012.5060 41679.7129  19.0%   588  136s
  2855  1903 36338.2297   22  356 35012.5060 41679.7129  19.0%   584  140s
  3356  2095 38603.3378   10  286 35012.5060 41354.3521  18.1%   579  146s
  3564  2252 38057.6269   13  273 35012.5060 41354.3521  18.1%   569  150s
  3884  2412 36407.4562   20  317 35012.5060 41196.5210  17.7%   570  155s
  4621  2704 38608.2924   10  327 35012.5060 41095.8016  17.4%   550  160s
  4810  2705 35376.0499   27  769 35012.5060 41020.4217  17.2%   551  175s
  4834  2721 37480.6242   19  361 35012.5060 41020.4217  17.2%   548  180s
  4920  2764 38070.8759   16  253 35012.5060 38942.0260  11.2%   548  185s
  5701  2444 35055.8853   39   28 35012.5060 36233.0378  3.49%   498  190s
* 6364  2090              76    35015.164986 35113.7176  0.28%   448  191s

Cutting planes:
  Implied bound: 3
  Projected implied bound: 11
  MIR: 175
  Flow cover: 349
  RLT: 5
  Relax-and-lift: 74

Explored 6449 nodes (3014265 simplex iterations) in 192.16 seconds (246.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 35015.2 35012.5 34983.5 ... 33183.1

Optimal solution found (tolerance 1.00e-04)
Best objective 3.501516498637e+04, best bound 3.501516498637e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 192.17s
  Master Objective (UB) = 35015.16, θ = 164147.38
  Upper Bound (UB) = 35015.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 164147.38
  [DEBUG]   ✓ Scenario 0: θ = 164147.38 ≤ Q = 164147.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7a8952c3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7a8952c3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6771372.3861
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.299557e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129955.74    0  123 6771372.39 -129955.74   102%     -    0s
H    0     0                    -101151.6454 -129955.74  28.5%     -    0s
H    0     0                    -101304.8064 -129955.74  28.3%     -    0s
H    0     0                    -102821.9388 -102821.94  0.00%     -    0s
     0     0          -    0      -102821.94 -102821.94  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 195

Explored 1 nodes (370 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -102822 -101305 -101152 ... 1.48645e+13
No other solutions better than -102822

Optimal solution found (tolerance 1.00e-04)
Best objective -1.028219387662e+05, best bound -1.028219387662e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 132575.97
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102821.94
  [DEBUG]   S×d_nominal = 235397.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 235397.91 + -102821.94 = 132575.97
  [DEBUG]   Current θ from Master = 164147.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31571.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3443.76
  Lower Bound (LB) = 3443.76
  Gap (UB-LB) = 31571.4051, Absolute Gap = 31571.4051, Relative Gap = 0.901649
  Not converged yet (gap = 31571.41 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91933 nonzeros
Model fingerprint: 0xda2b3a4f
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 3443.76 (0.02s)
MIP start from previous solve produced solution with objective 3443.76 (0.02s)
Loaded MIP start from previous solve with objective 3443.76

Presolve removed 15757 rows and 6396 columns
Presolve time: 0.42s
Presolved: 16206 rows, 8344 columns, 89438 nonzeros
Variable types: 6085 continuous, 2259 integer (2259 binary)

Root relaxation: objective 3.869142e+04, 12298 iterations, 2.41 seconds (3.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38691.4160    0  429 3443.75993 38691.4160  1024%     -    2s
H    0     0                    5954.2135430 38691.4160   550%     -    3s
H    0     0                    6788.8869894 38691.4160   470%     -    3s
     0     0 28190.4389    0  546 6788.88699 28190.4389   315%     -    5s
H    0     0                    6997.3025233 28184.9488   303%     -    5s
     0     0 28137.7683    0  546 6997.30252 28137.7683   302%     -    5s
     0     0 28106.2165    0  541 6997.30252 28106.2165   302%     -    5s
     0     0 28104.9054    0  546 6997.30252 28104.9054   302%     -    5s
     0     0 22878.2337    0  527 6997.30252 22878.2337   227%     -    8s
     0     0 22043.4874    0  554 6997.30252 22043.4874   215%     -    9s
     0     0 21934.4539    0  659 6997.30252 21934.4539   213%     -    9s
     0     0 21855.2724    0  661 6997.30252 21855.2724   212%     -   10s
     0     0 21845.6477    0  663 6997.30252 21845.6477   212%     -   10s
     0     0 21843.9934    0  669 6997.30252 21843.9934   212%     -   10s
     0     0 19564.4485    0  483 6997.30252 19564.4485   180%     -   13s
     0     0 19152.4121    0  479 6997.30252 19152.4121   174%     -   14s
     0     0 19091.4319    0  548 6997.30252 19091.4319   173%     -   14s
     0     0 19077.9748    0  492 6997.30252 19077.9748   173%     -   15s
     0     0 19068.4482    0  484 6997.30252 19068.4482   173%     -   15s
     0     0 19067.8717    0  483 6997.30252 19067.8717   173%     -   15s
     0     0 18115.3397    0  384 6997.30252 18115.3397   159%     -   18s
     0     0 17782.1552    0  485 6997.30252 17782.1552   154%     -   19s
H    0     0                    6997.5412467 17683.3362   153%     -   19s
     0     0 17683.3362    0  423 6997.54125 17683.3362   153%     -   19s
     0     0 17661.1765    0  498 6997.54125 17661.1765   152%     -   19s
     0     0 17655.5209    0  500 6997.54125 17655.5209   152%     -   19s
H    0     0                    7090.5597571 17293.5495   144%     -   20s
H    0     0                    7186.9215019 17293.5495   141%     -   20s
H    0     0                    7374.9447593 17293.5495   134%     -   20s
     0     0 17293.5495    0  485 7374.94476 17293.5495   134%     -   21s
H    0     0                    7476.6208943 17292.8993   131%     -   21s
H    0     0                    7479.0393087 17292.8993   131%     -   21s
H    0     0                    7625.7795799 17292.8993   127%     -   21s
H    0     0                    7714.9438545 17292.8993   124%     -   21s
     0     0 17104.1120    0  485 7714.94385 17104.1120   122%     -   21s
     0     0 17029.3083    0  614 7714.94385 17029.3083   121%     -   22s
     0     0 16991.6302    0  489 7714.94385 16991.6302   120%     -   22s
     0     0 16979.4769    0  628 7714.94385 16979.4769   120%     -   22s
     0     0 16978.0343    0  498 7714.94385 16978.0343   120%     -   22s
     0     0 16814.6318    0  395 7714.94385 16814.6318   118%     -   23s
H    0     0                    7790.9595160 16814.3000   116%     -   25s
H    0     0                    7813.8391887 16814.3000   115%     -   25s
     0     0 16756.3828    0  400 7813.83919 16756.3828   114%     -   25s
     0     0 16720.7837    0  414 7813.83919 16720.7837   114%     -   25s
     0     0 16713.5003    0  413 7813.83919 16713.5003   114%     -   26s
     0     0 16710.9137    0  408 7813.83919 16710.9137   114%     -   26s
     0     0 16562.3625    0  547 7813.83919 16562.3625   112%     -   27s
     0     0 16514.1465    0  403 7813.83919 16514.1465   111%     -   27s
     0     0 16499.2081    0  612 7813.83919 16499.2081   111%     -   27s
     0     0 16491.7044    0  389 7813.83919 16491.7044   111%     -   27s
     0     0 16490.4685    0  617 7813.83919 16490.4685   111%     -   27s
     0     0 16418.7973    0  407 7813.83919 16418.7973   110%     -   28s
     0     0 16398.0578    0  411 7813.83919 16398.0578   110%     -   28s
     0     0 16384.3950    0  395 7813.83919 16384.3950   110%     -   29s
     0     0 16379.6452    0  557 7813.83919 16379.6452   110%     -   29s
     0     0 16298.5967    0  393 7813.83919 16298.5967   109%     -   29s
     0     0 16281.5018    0  393 7813.83919 16281.5018   108%     -   30s
H    0     0                    7823.4314510 16279.2198   108%     -   30s
     0     0 16279.2198    0  398 7823.43145 16279.2198   108%     -   30s
     0     0 16254.9643    0  391 7823.43145 16254.9643   108%     -   30s
     0     0 16248.4643    0  489 7823.43145 16248.4643   108%     -   31s
     0     0 16206.7328    0  400 7823.43145 16206.7328   107%     -   31s
     0     0 16205.9029    0  400 7823.43145 16205.9029   107%     -   32s
H    0     0                    7973.6228731 16205.0090   103%     -   35s
H    0     0                    7991.8867867 16205.0090   103%     -   37s
H    0     0                    8223.2982005 16205.0090  97.1%     -   37s
H    0     0                    8304.4174878 16205.0090  95.1%     -   37s
     0     2 16205.0090    0  400 8304.41749 16205.0090  95.1%     -   37s
     7    16 14601.3177    3  400 8304.41749 15623.6705  88.1%   945   40s
    95   149 10812.6997    7  304 8304.41749 14096.6389  69.7%  1084   46s
H  102   149                    8697.1433288 14096.6389  62.1%  1049   46s
   410   314     cutoff   12      8697.14333 13915.2082  60.0%   577   50s
H  499   337                    8860.9901039 13915.2082  57.0%   550   51s
H  524   337                    8957.2945626 13912.9758  55.3%   552   51s
   670   440     cutoff   13      8957.29456 13705.0757  53.0%   526   55s
H  888   515                    9007.7752263 13413.7663  48.9%   507   59s
   910   572 10282.8672   10  185 9007.77523 13413.7663  48.9%   509   60s
  1360   707     cutoff   14      9007.77523 13302.9172  47.7%   475   65s
H 1638   773                    9013.9279787 12908.4380  43.2%   452   68s
  1765   880 10357.4715   13  118 9013.92798 12823.7867  42.3%   451   70s
  2072   977 9463.73498   23   51 9013.92798 12779.2232  41.8%   446   75s
  2473  1073 10478.2922   17  220 9013.92798 12535.5489  39.1%   431   80s
  2855  1120 infeasible   20      9013.92798 12224.6948  35.6%   433   87s
  3050  1240     cutoff   10      9013.92798 12174.2584  35.1%   431   91s
H 3053  1240                    9070.3040084 12174.2584  34.2%   431   91s
H 3284  1289                    9141.8171502 12092.5329  32.3%   423   93s
  3676  1386 9797.66207   19  244 9141.81715 12006.1418  31.3%   412   96s
  4091  1486     cutoff   17      9141.81715 11919.8917  30.4%   411  100s
H 4336  1497                    9206.9636820 11851.9669  28.7%   408  102s
  4696  1548 10632.8061   15  155 9206.96368 11817.3745  28.4%   409  106s
  5191  1582 10408.1882   17  172 9206.96368 11493.5503  24.8%   407  110s
  5722  1582     cutoff   17      9206.96368 11347.8766  23.3%   404  115s
H 5812  1577                    9272.4053807 11242.7540  21.2%   406  118s
  6012  1551 10503.8479   12  305 9272.40538 11186.2008  20.6%   406  120s
  6609  1509 9359.10078   21  141 9272.40538 11009.6295  18.7%   406  125s
  7330  1387     cutoff   17      9272.40538 10811.9930  16.6%   400  130s
  8255  1205 10074.0951   17  110 9272.40538 10546.8228  13.7%   391  136s
  9372   900 9735.44938   20  248 9272.40538 10247.5723  10.5%   379  141s
*11517   680              48    9275.3013605 10020.0447  8.03%   331  144s
 11794   694     cutoff   26      9275.30136 9775.68033  5.39%   325  147s
*12949  1190              52    9306.0837122 9748.04504  4.75%   299  149s
*12987  1190              47    9320.6447946 9748.04504  4.59%   298  149s
 15242   809 9432.74188   51  400 9320.64479 9544.72106  2.40%   257  173s
 15244   810 9364.15626   41  229 9320.64479 9544.72106  2.40%   257  175s
 15248   813 9324.00837   49  423 9320.64479 9544.72106  2.40%   257  180s
 15254   817 9333.53216   42  381 9320.64479 9544.72106  2.40%   257  185s
 15260   821 9339.91891   36  440 9320.64479 9544.72106  2.40%   257  190s
 15262   822 9331.25656   52  440 9320.64479 9544.72106  2.40%   257  195s
 15293   866 9544.72106   14  316 9320.64479 9544.72106  2.40%   259  200s
 15509   915     cutoff   17      9320.64479 9544.72106  2.40%   262  205s
 15855   800 9544.72106   21  290 9320.64479 9544.72106  2.40%   264  210s
 16271   662 9544.72106   20  170 9320.64479 9544.72106  2.40%   264  215s
 16752   409     cutoff   24      9320.64479 9544.72106  2.40%   262  220s
H16810   347                    9322.2567621 9544.72106  2.39%   262  220s
 17111   167 9544.72106   36  187 9322.25676 9544.72106  2.39%   261  225s

Cutting planes:
  MIR: 189
  Flow cover: 350
  RLT: 9
  Relax-and-lift: 48

Explored 19690 nodes (4533523 simplex iterations) in 228.01 seconds (364.83 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9322.26 9320.64 9306.08 ... 9007.78

Optimal solution found (tolerance 1.00e-04)
Best objective 9.322256762085e+03, best bound 9.322256762085e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 228.03s
  Master Objective (UB) = 9322.26, θ = 136355.76
  Upper Bound (UB) = 9322.26

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 136355.76
  [DEBUG]   ✓ Scenario 0: θ = 136355.76 ≤ Q = 136355.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 136355.76 ≤ Q = 136355.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7b834789
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7b834789
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.333982e+13
Presolve removed 2652 rows and 1946 columns
Presolve time: 0.01s
Presolved: 441 rows, 443 columns, 1242 nonzeros
Found heuristic solution: objective 6012738.9864
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.343320e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134332.04    0  125 6012738.99 -134332.04   102%     -    0s
H    0     0                    -98089.75254 -134332.04  36.9%     -    0s
H    0     0                    -119881.6399 -134332.04  12.1%     -    0s
H    0     0                    -120173.5463 -134332.04  11.8%     -    0s
H    0     0                    -120487.4495 -134332.04  11.5%     -    0s
H    0     0                    -120564.6636 -134332.04  11.4%     -    0s
H    0     0                    -125242.5458 -126557.17  1.05%     -    0s
     0     0 -126539.91    0   78 -125242.55 -126539.91  1.04%     -    0s
H    0     0                    -125453.6574 -126062.76  0.49%     -    0s
     0     0 -126062.76    0   80 -125453.66 -126062.76  0.49%     -    0s
     0     0 -126045.81    0   80 -125453.66 -126045.81  0.47%     -    0s
     0     0 -126041.37    0   80 -125453.66 -126041.37  0.47%     -    0s
     0     0 -125532.74    0   20 -125453.66 -125532.74  0.06%     -    0s
     0     0 -125525.36    0   19 -125453.66 -125525.36  0.06%     -    0s
     0     0 -125523.66    0    6 -125453.66 -125523.66  0.06%     -    0s
     0     0 -125510.03    0    6 -125453.66 -125510.03  0.04%     -    0s
     0     0 -125509.56    0    6 -125453.66 -125509.56  0.04%     -    0s
     0     0          -    0      -125453.66 -125461.49  0.01%     -    0s

Cutting planes:
  Gomory: 23
  Implied bound: 3
  MIR: 74
  Flow cover: 6
  RLT: 95
  Relax-and-lift: 1
  BQP: 2

Explored 1 nodes (552 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -125454 -120565 -120487 ... 1.33398e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.254536573580e+05, best bound -1.254614945485e+05, gap 0.0062%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 112317.66
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125453.66
  [DEBUG]   S×d_nominal = 237771.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 237771.31 + -125453.66 = 112317.66
  [DEBUG]   Current θ from Master = 136355.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24038.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14715.85
  Lower Bound (LB) = 3443.76
  Gap (UB-LB) = 5878.4968, Absolute Gap = 5878.4968, Relative Gap = 0.630587
  Not converged yet (gap = 5878.50 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135140 nonzeros
Model fingerprint: 0x769aba5c
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -14715.8 (0.03s)
Loaded MIP start from previous solve with objective -14715.8

Presolve removed 23634 rows and 9594 columns
Presolve time: 0.55s
Presolved: 23619 rows, 11386 columns, 131849 nonzeros
Variable types: 9127 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36027    3.2440956e+04   0.000000e+00   1.303416e+06      5s
Concurrent spin time: 0.12s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16145    3.7980011e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 3.798001e+04, 16145 iterations, 6.73 seconds (8.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37980.0112    0  427 -14715.849 37980.0112   358%     -    7s
H    0     0                    -5584.990833 37980.0112   780%     -    7s
H    0     0                    -4443.379289 37980.0112   955%     -    7s
H    0     0                    -1696.716741 37980.0112  2338%     -    7s
H    0     0                     134.8601515 37980.0112      -     -    7s
H    0     0                     737.9735222 37980.0112  5047%     -    7s
H    0     0                     776.2554411 37980.0112  4793%     -    7s
H    0     0                    1465.4766541 37980.0112  2492%     -    8s
H    0     0                    1519.5965226 37980.0112  2399%     -    8s
H    0     0                    2462.0108341 28318.5542  1050%     -   12s
H    0     0                    2465.6622456 28318.5542  1049%     -   12s
H    0     0                    2541.5212343 28318.5542  1014%     -   12s
H    0     0                    2618.0256208 28318.5542   982%     -   12s
     0     0 28296.1801    0  564 2618.02562 28296.1801   981%     -   12s
     0     0 27519.2237    0  483 2618.02562 27519.2237   951%     -   13s
     0     0 27519.2237    0  554 2618.02562 27519.2237   951%     -   13s
     0     0 27507.8127    0  564 2618.02562 27507.8127   951%     -   13s
     0     0 27504.4835    0  559 2618.02562 27504.4835   951%     -   13s
     0     0 27504.4835    0  559 2618.02562 27504.4835   951%     -   13s
H    0     0                    2635.2474373 22451.5987   752%     -   19s
H    0     0                    2642.3637662 22451.5987   750%     -   19s
     0     0 22451.5987    0  559 2642.36377 22451.5987   750%     -   19s
H    0     0                    2712.1942605 22449.1070   728%     -   19s
H    0     0                    2747.2179629 22449.1070   717%     -   19s
H    0     0                    2812.1789930 22449.1070   698%     -   19s
     0     0 21781.1625    0  487 2812.17899 21781.1625   675%     -   20s
     0     0 21685.1205    0  496 2812.17899 21685.1205   671%     -   21s
     0     0 21553.1834    0  481 2812.17899 21553.1834   666%     -   22s
     0     0 21546.2677    0  550 2812.17899 21546.2677   666%     -   22s
     0     0 21546.2519    0  553 2812.17899 21546.2519   666%     -   22s
H    0     0                    2852.7429681 18971.0296   565%     -   29s
     0     0 18971.0296    0  361 2852.74297 18971.0296   565%     -   29s
     0     0 18343.6715    0  376 2852.74297 18343.6715   543%     -   31s
H    0     0                    3276.9542310 18050.0060   451%     -   32s
H    0     0                    3326.5274995 18050.0060   443%     -   32s
H    0     0                    3409.9640431 18050.0060   429%     -   32s
H    0     0                    3537.0208006 18050.0060   410%     -   32s
     0     0 18050.0060    0  390 3537.02080 18050.0060   410%     -   32s
H    0     0                    3553.5002216 17964.6726   406%     -   33s
     0     0 17964.6726    0  397 3553.50022 17964.6726   406%     -   33s
     0     0 17932.6281    0  400 3553.50022 17932.6281   405%     -   33s
     0     0 17887.4580    0  417 3553.50022 17887.4580   403%     -   34s
     0     0 17873.5606    0  502 3553.50022 17873.5606   403%     -   35s
     0     0 17855.4436    0  409 3553.50022 17855.4436   402%     -   36s
     0     0 17855.2309    0  413 3553.50022 17855.2309   402%     -   36s
H    0     0                    4065.8493485 16567.3227   307%     -   42s
H    0     0                    4119.1347729 16567.3227   302%     -   42s
H    0     0                    4159.1583048 16567.3227   298%     -   42s
     0     0 16567.3227    0  490 4159.15830 16567.3227   298%     -   42s
H    0     0                    4178.9008203 16566.9405   296%     -   42s
H    0     0                    4327.0386096 16566.9405   283%     -   42s
H    0     0                    4333.2289709 16566.9405   282%     -   42s
     0     0 16220.6940    0  698 4333.22897 16220.6940   274%     -   45s
     0     0 16118.1638    0  388 4333.22897 16118.1638   272%     -   46s
     0     0 16075.4809    0  640 4333.22897 16075.4809   271%     -   46s
     0     0 16064.8515    0  632 4333.22897 16064.8515   271%     -   47s
     0     0 16061.3842    0  469 4333.22897 16061.3842   271%     -   47s
     0     0 15776.8031    0  487 4333.22897 15776.8031   264%     -   50s
H    0     0                    4335.9312333 15775.7216   264%     -   50s
     0     0 15543.1894    0  506 4335.93123 15543.1894   258%     -   52s
     0     0 15494.4810    0  500 4335.93123 15494.4810   257%     -   53s
     0     0 15480.7659    0  662 4335.93123 15480.7659   257%     -   54s
     0     0 15473.2809    0  511 4335.93123 15473.2809   257%     -   54s
     0     0 15469.0054    0  663 4335.93123 15469.0054   257%     -   54s
     0     0 15308.4310    0  395 4335.93123 15308.4310   253%     -   57s
     0     0 15262.5174    0  397 4335.93123 15262.5174   252%     -   58s
     0     0 15240.1359    0  388 4335.93123 15240.1359   251%     -   59s
     0     0 15226.8585    0  401 4335.93123 15226.8585   251%     -   59s
     0     0 15225.5004    0  406 4335.93123 15225.5004   251%     -   59s
     0     0 15124.5449    0  399 4335.93123 15124.5449   249%     -   61s
     0     0 15035.0605    0  392 4335.93123 15035.0605   247%     -   63s
     0     0 15014.8438    0  392 4335.93123 15014.8438   246%     -   63s
     0     0 15009.7806    0  394 4335.93123 15009.7806   246%     -   64s
     0     0 14977.2733    0  390 4335.93123 14977.2733   245%     -   65s
H    0     0                    4377.6194582 14976.5480   242%     -   65s
H    0     0                    4379.3336214 14976.5480   242%     -   65s
H    0     0                    4415.4512148 14976.5480   239%     -   65s
     0     0 14965.6544    0  400 4415.45121 14965.6544   239%     -   66s
     0     0 14962.4543    0  405 4415.45121 14962.4543   239%     -   67s
     0     0 14941.2072    0  469 4415.45121 14941.2072   238%     -   69s
     0     0 14928.6852    0  463 4415.45121 14928.6852   238%     -   70s
     0     0 14926.1771    0  396 4415.45121 14926.1771   238%     -   70s
     0     0 14913.2175    0  413 4415.45121 14913.2175   238%     -   71s
     0     0 14911.5478    0  413 4415.45121 14911.5478   238%     -   71s
H    0     0                    4478.3494222 14911.5478   233%     -   78s
H    0     0                    4493.7157842 14911.5478   232%     -   78s
H    0     0                    4493.8671621 14911.4579   232%     -   87s
H    0     0                    4730.6545728 14911.4579   215%     -   87s
H    0     0                    4811.3781688 14911.4579   210%     -   87s
H    0     0                    5824.4077143 14911.4579   156%     -   87s
H    0     0                    6024.9890548 14911.4579   147%     -   87s
H    0     0                    6749.9134891 14911.4579   121%     -   87s
H    0     0                    6966.0421521 14911.4579   114%     -   88s
     0     2 14911.4579    0  413 6966.04215 14911.4579   114%     -   88s
     1     4 14452.3470    1  331 6966.04215 14911.4139   114%  5505   91s
     7    16 13973.3908    3  333 6966.04215 14377.1949   106%  2752   96s
    31    64 13600.4684    5  397 6966.04215 13959.4170   100%  3368  101s
H   33    64                    6997.3025233 13959.4170  99.5%  3198  101s
    95   128 13402.5022    7  332 6997.30252 13831.0641  97.7%  2550  107s
   127   178 13379.7399    8  321 6997.30252 13831.0641  97.7%  2285  112s
   177   244 12785.9798    9  336 6997.30252 13831.0641  97.7%  2118  115s
   281   314 12787.0709   10  331 6997.30252 13831.0641  97.7%  1875  124s
   326   362 13063.3798   10  474 6997.30252 13831.0641  97.7%  1850  127s
   377   414 12749.2050   11  470 6997.30252 13831.0641  97.7%  1767  130s
   501   509 12455.8694   13  299 6997.30252 13782.6226  97.0%  1647  136s
   607   585 11085.1134   16  423 6997.30252 13775.1909  96.9%  1635  143s
   670   616 11139.9809   20  416 6997.30252 13775.1909  96.9%  1637  146s
   713   660 10889.0645   23  339 6997.30252 13775.1909  96.9%  1661  150s
   821   751 10436.1986   26  273 6997.30252 13775.1909  96.9%  1668  156s
   996   902 9881.54156   35  269 6997.30252 13689.2103  95.6%  1537  162s
  1113   995 9223.46565   37  257 6997.30252 13689.2103  95.6%  1457  165s
  1372  1170 8325.31459   46  185 6997.30252 13517.8972  93.2%  1301  172s
  1527  1275 11817.8311    8  280 6997.30252 13517.2245  93.2%  1236  177s
  1670  1327 11551.6532    9  272 6997.30252 13475.7369  92.6%  1201  182s
  1784  1365 8192.29515   11  345 6997.30252 13475.7369  92.6%  1214  185s
  1986  1488 7570.49857   13  207 6997.30252 13475.7369  92.6%  1230  193s
  2073  1560 7332.14858   15  228 6997.30252 13475.7369  92.6%  1233  198s
  2231  1623     cutoff    7      6997.30252 13475.7369  92.6%  1207  203s
  2387  1667 8770.38870    9  174 6997.30252 13264.3735  89.6%  1191  208s
  2536  1713     cutoff   13      6997.30252 13166.8187  88.2%  1184  212s
  2672  1796 9199.12967    9  312 6997.30252 13133.2069  87.7%  1198  216s
  2779  1859 8583.53605   11  304 6997.30252 13133.2069  87.7%  1223  220s
  2930  1887 8396.15179   12  300 6997.30252 13133.2069  87.7%  1222  225s
  3146  1971 8116.33393   14  340 6997.30252 13039.8634  86.4%  1240  235s
  3409  2104 infeasible   18      6997.30252 13013.6124  86.0%  1246  244s
  3563  2166 11622.5450   10  440 6997.30252 12970.5618  85.4%  1254  249s
  3764  2260 10194.2329   12  399 6997.30252 12970.5618  85.4%  1251  254s
  3921  2380     cutoff   19      6997.30252 12970.5618  85.4%  1258  261s
  4127  2473 11520.3939   12  303 6997.30252 12881.2353  84.1%  1261  267s
  4385  2597 9588.08783   15  436 6997.30252 12864.3739  83.8%  1257  273s
  4618  2598 12150.3479   12  413 6997.30252 12801.1975  82.9%  1259  289s
  4620  2599 7660.93430   39  231 6997.30252 12801.1975  82.9%  1258  293s
  4621  2600 11424.5267   13  386 6997.30252 12801.1975  82.9%  1258  297s
  4623  2601 10532.7538   13  347 6997.30252 12801.1975  82.9%  1258  300s
  4628  2605 11338.9666    9  416 6997.30252 12801.1975  82.9%  1256  305s
  4636  2610 9428.25575   11  390 6997.30252 12801.1975  82.9%  1254  310s
  4641  2613 8223.15396   13  424 6997.30252 12801.1975  82.9%  1253  315s
  4645  2616 9805.71202   20  381 6997.30252 12801.1975  82.9%  1252  320s
  4647  2617 7510.93862   22  391 6997.30252 12801.1975  82.9%  1251  325s
  4652  2621 8327.49107   26  404 6997.30252 12801.1975  82.9%  1250  330s
  4656  2623 8769.96858   15  405 6997.30252 12801.1975  82.9%  1249  339s
  4657  2624 11048.0245   15  405 6997.30252 12801.1975  82.9%  1248  342s
  4658  2628 12801.1975   15  377 6997.30252 12801.1975  82.9%  1261  345s
  4672  2651 12801.1975   18  299 6997.30252 12801.1975  82.9%  1262  352s
  4688  2674 12801.1975   19  296 6997.30252 12801.1975  82.9%  1265  355s
  4752  2685 10791.3689   21  304 6997.30252 12801.1975  82.9%  1277  360s
  4883  2684 8394.40473   22  231 6997.30252 12801.1975  82.9%  1274  366s
  5022  2667 9685.50922   24  234 6997.30252 12801.1975  82.9%  1266  371s
  5115  2635 9259.66620   25  241 6997.30252 12801.1975  82.9%  1257  376s
  5294  2625 9206.18800   27  239 6997.30252 12801.1975  82.9%  1234  382s
  5376  2611 9009.25802   28  243 6997.30252 12801.1975  82.9%  1223  385s
  5576  2566 8165.67665   31  290 6997.30252 12018.5563  71.8%  1199  391s
  5727  2518 8979.12616   23  240 6997.30252 12018.5563  71.8%  1185  397s
  5792  2497 8063.35335   24  226 6997.30252 11531.7378  64.8%  1178  400s
  6065  2416 8337.73634   24  263 6997.30252 11531.0868  64.8%  1152  407s
  6308  2343 8121.86571   29  210 6997.30252 11531.0868  64.8%  1123  411s
  6444  2270 7390.75722   32  225 6997.30252 9621.01315  37.5%  1109  415s
  6982  1936     cutoff   26      6997.30252 9466.52767  35.3%  1050  421s
  7245  1764 7400.54561   42  237 6997.30252 8721.74022  24.6%  1023  425s

Cutting planes:
  Learned: 2
  MIR: 179
  Flow cover: 504
  RLT: 11
  Relax-and-lift: 43

Explored 7314 nodes (7529533 simplex iterations) in 426.13 seconds (694.72 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6997.3 6966.04 6749.91 ... 4415.45

Optimal solution found (tolerance 1.00e-04)
Best objective 6.997302523331e+03, best bound 6.997302523331e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 426.15s
  Master Objective (UB) = 6997.30, θ = 135397.92
  Upper Bound (UB) = 6997.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135397.92
  [DEBUG]   ✓ Scenario 0: θ = 135397.92 ≤ Q = 135397.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135397.92 ≤ Q = 135397.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135397.92 ≤ Q = 135397.92 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x73c008fe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x73c008fe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506319e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6742087.9580
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.367542e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136754.24    0  126 6742087.96 -136754.24   102%     -    0s
H    0     0                    -104678.9367 -136754.24  30.6%     -    0s
H    0     0                    -104832.0978 -136754.24  30.5%     -    0s
H    0     0                    -105235.5309 -136754.24  30.0%     -    0s
H    0     0                    -114468.2629 -136754.24  19.5%     -    0s
     0     0 -120060.96    0   47 -114468.26 -120060.96  4.89%     -    0s
H    0     0                    -118408.5995 -120034.95  1.37%     -    0s
     0     0 -119231.20    0   43 -118408.60 -119231.20  0.69%     -    0s
     0     0 -119217.48    0   49 -118408.60 -119217.48  0.68%     -    0s
H    0     0                    -118670.5841 -119095.69  0.36%     -    0s
     0     0 -119095.69    0   15 -118670.58 -119095.69  0.36%     -    0s
H    0     0                    -118673.9448 -119055.35  0.32%     -    0s
H    0     0                    -118969.8431 -119055.35  0.07%     -    0s
     0     0 -119055.35    0   15 -118969.84 -119055.35  0.07%     -    0s
     0     0 -119038.02    0    9 -118969.84 -119038.02  0.06%     -    0s
     0     0 -119037.83    0    9 -118969.84 -119037.83  0.06%     -    0s
     0     0 -119014.77    0    6 -118969.84 -119014.77  0.04%     -    0s
     0     0 -119014.77    0    8 -118969.84 -119014.77  0.04%     -    0s
H    0     0                    -118988.8937 -119014.77  0.02%     -    0s
     0     0 -119000.59    0    6 -118988.89 -119000.59  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 3
  Flow cover: 2
  RLT: 3
  Relax-and-lift: 1

Explored 1 nodes (570 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -118989 -118970 -118935 ... -104832

Optimal solution found (tolerance 1.00e-04)
Best objective -1.189888937261e+05, best bound -1.190005868834e+05, gap 0.0098%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 124395.65
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118988.89
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -118988.89 = 124395.65
  [DEBUG]   Current θ from Master = 135397.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11002.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4004.97
  Lower Bound (LB) = 3443.76
  Gap (UB-LB) = 3553.5426, Absolute Gap = 3553.5426, Relative Gap = 0.507845
  Not converged yet (gap = 3553.54 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178347 nonzeros
Model fingerprint: 0x1593c6e0
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -4004.97 (0.05s)
MIP start from previous solve produced solution with objective -4004.97 (0.05s)
Loaded MIP start from previous solve with objective -4004.97

Presolve removed 31512 rows and 12792 columns
Presolve time: 0.80s
Presolved: 31031 rows, 14428 columns, 173959 nonzeros
Variable types: 12169 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29807    3.2991512e+04   0.000000e+00   8.544111e+05      5s
   39822    3.7612777e+04   0.000000e+00   2.297990e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26007    3.7883477e+04   0.000000e+00   0.000000e+00     13s

Root relaxation: objective 3.788348e+04, 26007 iterations, 11.95 seconds (15.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37883.4771    0  422 -4004.9673 37883.4771  1046%     -   13s
H    0     0                    4240.1776108 37883.4771   793%     -   13s
H    0     0                    4725.2580240 37883.4771   702%     -   13s
H    0     0                    6598.4640671 37883.4771   474%     -   13s
H    0     0                    6630.7768896 28879.2428   336%     -   20s
     0     0 28824.0101    0  627 6630.77689 28824.0101   335%     -   20s
     0     0 28050.5764    0  630 6630.77689 28050.5764   323%     -   22s
     0     0 27933.2473    0  636 6630.77689 27933.2473   321%     -   24s
     0     0 27881.6963    0  653 6630.77689 27881.6963   320%     -   24s
     0     0 27880.7382    0  648 6630.77689 27880.7382   320%     -   24s
     0     0 22746.1411    0  453 6630.77689 22746.1411   243%     -   32s
     0     0 21357.4738    0  627 6630.77689 21357.4738   222%     -   38s
     0     0 21092.5611    0  626 6630.77689 21092.5611   218%     -   40s
     0     0 21031.4764    0  632 6630.77689 21031.4764   217%     -   41s
     0     0 21024.3189    0  630 6630.77689 21024.3189   217%     -   41s
     0     0 21023.2497    0  632 6630.77689 21023.2497   217%     -   42s
     0     0 18549.2387    0  383 6630.77689 18549.2387   180%     -   52s
     0     0 18041.2428    0  377 6630.77689 18041.2428   172%     -   55s
     0     0 17893.6261    0  434 6630.77689 17893.6261   170%     -   57s
     0     0 17862.1546    0  434 6630.77689 17862.1546   169%     -   58s
     0     0 17827.4998    0  434 6630.77689 17827.4998   169%     -   58s
     0     0 17823.0566    0  438 6630.77689 17823.0566   169%     -   59s
     0     0 16776.7649    0  387 6630.77689 16776.7649   153%     -   66s
     0     0 16459.5376    0  378 6630.77689 16459.5376   148%     -   70s
     0     0 16371.3996    0  395 6630.77689 16371.3996   147%     -   71s
     0     0 16343.4764    0  398 6630.77689 16343.4764   146%     -   72s
     0     0 16338.0359    0  400 6630.77689 16338.0359   146%     -   73s
     0     0 16052.9418    0  517 6630.77689 16052.9418   142%     -   76s
     0     0 15859.2680    0  383 6630.77689 15859.2680   139%     -   80s
     0     0 15831.1831    0  399 6630.77689 15831.1831   139%     -   81s
     0     0 15823.6630    0  400 6630.77689 15823.6630   139%     -   81s
     0     0 15820.4505    0  399 6630.77689 15820.4505   139%     -   82s
     0     0 15598.3919    0  584 6630.77689 15598.3919   135%     -   86s
     0     0 15545.6797    0  413 6630.77689 15545.6797   134%     -   90s
     0     0 15517.7082    0  503 6630.77689 15517.7082   134%     -   92s
     0     0 15496.3223    0  413 6630.77689 15496.3223   134%     -   93s
     0     0 15490.9606    0  426 6630.77689 15490.9606   134%     -   94s
     0     0 15421.4104    0  389 6630.77689 15421.4104   133%     -   96s
     0     0 15365.0100    0  651 6630.77689 15365.0100   132%     -   99s
     0     0 15332.9191    0  583 6630.77689 15332.9191   131%     -  101s
     0     0 15324.7145    0  590 6630.77689 15324.7145   131%     -  101s
     0     0 15318.5517    0  594 6630.77689 15318.5517   131%     -  102s
     0     0 15314.1752    0  599 6630.77689 15314.1752   131%     -  103s
     0     0 15231.5635    0  522 6630.77689 15231.5635   130%     -  106s
     0     0 15185.1620    0  427 6630.77689 15185.1620   129%     -  110s
     0     0 15173.8325    0  424 6630.77689 15173.8325   129%     -  111s
     0     0 15170.5255    0  427 6630.77689 15170.5255   129%     -  111s
     0     0 15084.3415    0  407 6630.77689 15084.3415   127%     -  114s
     0     0 15059.3165    0  416 6630.77689 15059.3165   127%     -  116s
     0     0 15046.8135    0  414 6630.77689 15046.8135   127%     -  118s
     0     0 15040.8295    0  501 6630.77689 15040.8295   127%     -  118s
     0     0 14990.8432    0  426 6630.77689 14990.8432   126%     -  121s
     0     0 14977.4729    0  505 6630.77689 14977.4729   126%     -  123s
     0     0 14964.6807    0  425 6630.77689 14964.6807   126%     -  124s
     0     0 14960.1736    0  428 6630.77689 14960.1736   126%     -  124s
H    0     0                    6725.1924311 14925.5236   122%     -  127s
     0     0 14925.5236    0  419 6725.19243 14925.5236   122%     -  127s
H    0     0                    6798.9009219 14925.5004   120%     -  128s
     0     0 14912.2413    0  424 6798.90092 14912.2413   119%     -  129s
     0     0 14909.0805    0  496 6798.90092 14909.0805   119%     -  129s
     0     0 14900.1973    0  413 6798.90092 14900.1973   119%     -  131s
     0     0 14900.1676    0  413 6798.90092 14900.1676   119%     -  131s
     0     2 14900.0578    0  413 6798.90092 14900.0578   119%     -  205s
     3     8 14561.4123    2  341 6798.90092 14694.4897   116%  3630  214s
     7    16 14359.1596    3  561 6798.90092 14560.7752   114%  3696  219s
    15    32 12627.4954    4  475 6798.90092 14359.1356   111%  4367  224s
    31    54 11603.4785    5  457 6798.90092 14275.0461   110%  5979  236s
    53    86 12320.7819    6  316 6798.90092 14275.0461   110%  5410  241s
    85   198 12245.2116    7  303 6798.90092 14275.0461   110%  4473  254s
   197   243 12053.8862   10  291 6798.90092 14275.0461   110%  2565  260s
   248   313 12011.3716   10  275 6798.90092 14275.0461   110%  2276  267s
   334   391 11762.5163    9  300 6798.90092 14275.0461   110%  2018  277s
   430   462 11782.6751   10  307 6798.90092 14045.4606   107%  1878  283s
   527   536 11486.3086   13  300 6798.90092 14045.4606   107%  1770  289s
   619   595 infeasible   11      6798.90092 14045.4606   107%  1679  293s
   710   672 11380.0307   16  294 6798.90092 14045.4606   107%  1596  297s
   798   758 11266.5638   19  349 6798.90092 14045.4606   107%  1528  301s
   896   837 10968.6638   18  272 6798.90092 14045.4606   107%  1448  306s
   991   907 10648.3619   20  278 6798.90092 13769.2361   103%  1400  311s
  1104   979 10572.3834   22  283 6798.90092 13769.2361   103%  1344  316s
  1218  1020 10450.0365   25  272 6798.90092 13769.2361   103%  1302  320s
  1287  1085 10022.0725   25  328 6798.90092 13769.2361   103%  1285  326s
  1393  1174 10118.5862   26  262 6798.90092 13769.2361   103%  1258  330s
  1650  1366 9842.08240   32  251 6798.90092 13662.6365   101%  1172  338s
  1806  1409 8449.82237   33  216 6798.90092 13662.6365   101%  1137  348s
  1944  1461 7913.53099   33  203 6798.90092 13582.7474   100%  1125  352s
  2045  1519 8294.93413   34  229 6798.90092 13582.7474   100%  1122  357s
  2151  1540 7758.97120   39  126 6798.90092 13240.5564  94.7%  1135  362s
  2200  1618 7750.99254   40  128 6798.90092 13240.5564  94.7%  1141  367s
  2321  1725     cutoff   44      6798.90092 13240.5564  94.7%  1123  372s
  2485  1747 10603.1099   10  275 6798.90092 13240.5564  94.7%  1105  381s
  2526  1783 infeasible   11      6798.90092 13056.5397  92.0%  1105  396s
  2570  1837 8264.32825   11  245 6798.90092 13056.5397  92.0%  1110  400s
  2633  1887 8246.27330   12  250 6798.90092 13056.5397  92.0%  1099  411s
  2747  1952 8111.69526   13  235 6798.90092 13049.1189  91.9%  1080  418s
  2854  1980 infeasible   14      6798.90092 13016.5953  91.5%  1069  428s
  2960  2051 infeasible   15      6798.90092 13016.5953  91.5%  1067  437s
  3057  2142 7547.08824   16  239 6798.90092 12918.3970  90.0%  1063  443s
  3200  2190 7474.89871   17  323 6798.90092 12895.5096  89.7%  1044  447s
  3321  2260 7458.12611   18  223 6798.90092 12887.4551  89.6%  1038  453s
  3467  2298 infeasible   19      6798.90092 12868.7493  89.3%  1025  460s
  3566  2373 7408.66442   20  207 6798.90092 12827.6573  88.7%  1019  466s
H 3670  2373                    6803.2030897 12815.7422  88.4%  1014  466s
  3713  2530 infeasible   21      6803.20309 12815.7422  88.4%  1009  473s
  4008  2742 11521.0076    9  450 6803.20309 12815.7422  88.4%   994  481s
  4359  2743 7651.20551   30  413 6803.20309 12815.7422  88.4%   967  517s
  4361  2744 10391.8054   16  229 6803.20309 12815.7422  88.4%   967  525s
  4362  2745 7233.53008   54  393 6803.20309 12815.7422  88.4%   967  533s
  4363  2746 8166.69037   19  377 6803.20309 12815.7422  88.4%   967  536s
  4364  2746 8635.96101   38  481 6803.20309 12815.7422  88.4%   966  541s
  4366  2748 8731.02836   24  390 6803.20309 12815.7422  88.4%   966  545s
  4371  2751 10734.7820   10  396 6803.20309 12815.7422  88.4%   965  550s
  4372  2752 7851.91809   10  399 6803.20309 12815.7422  88.4%   965  555s
  4376  2754 11365.2119   15  453 6803.20309 12815.7422  88.4%   964  561s
  4379  2756 8097.15068   34  418 6803.20309 12815.7422  88.4%   963  565s
  4382  2758 9240.67646   17  418 6803.20309 12815.7422  88.4%   962  570s
  4384  2760 8970.47138   39  411 6803.20309 12815.7422  88.4%   962  575s
  4387  2762 8298.79868   27  479 6803.20309 12815.7422  88.4%   961  580s
  4390  2764 7612.55363   20  474 6803.20309 12815.7422  88.4%   961  586s
  4393  2766 8413.27973   10  433 6803.20309 12815.7422  88.4%   960  591s
  4396  2768 9390.01226   17  429 6803.20309 12815.7422  88.4%   959  595s
  4399  2770 10637.4869   22  409 6803.20309 12815.7422  88.4%   959  609s
  4400  2770 9290.35850   30  409 6803.20309 12815.7422  88.4%   958  617s
  4401  2774 12815.7422   12  411 6803.20309 12815.7422  88.4%   977  631s
  4403  2777 12815.7422   13  412 6803.20309 12815.7422  88.4%   977  638s
  4407  2784 12815.7422   14  455 6803.20309 12815.7422  88.4%   978  644s
  4415  2796 12815.7422   15  449 6803.20309 12815.7422  88.4%   980  653s
  4431  2822 12331.9548   16  438 6803.20309 12815.7422  88.4%  1003  659s
  4462  2842 11942.6487   17  351 6803.20309 12815.7422  88.4%  1013  662s
  4494  2861 11530.0168   18  445 6803.20309 12815.7422  88.4%  1028  670s
  4533  2885 10982.5653   19  362 6803.20309 12815.7422  88.4%  1040  676s
  4589  2908 11336.2353   19  395 6803.20309 12815.7422  88.4%  1065  681s
  4664  2918 10242.5838   21  331 6803.20309 12815.7422  88.4%  1079  686s
  4747  2904 9415.11886   21  246 6803.20309 12815.7422  88.4%  1085  690s
  4837  2881 9473.16697   22  235 6803.20309 12815.7422  88.4%  1087  699s
  4912  2870 infeasible   22      6803.20309 12815.7422  88.4%  1092  705s
  4970  2860 8933.08921   23  295 6803.20309 12815.7422  88.4%  1099  710s
  5035  2842 8433.47460   24  302 6803.20309 12815.7422  88.4%  1102  718s
  5101  2817 8825.95979   24  296 6803.20309 12815.7422  88.4%  1110  722s
  5143  2820 8784.94730   25  293 6803.20309 12815.7422  88.4%  1113  726s
  5185  2820 8543.39672   26  292 6803.20309 12815.7422  88.4%  1115  730s
  5224  2811 8538.57363   27  297 6803.20309 12815.7422  88.4%  1115  736s
  5277  2796 8267.10495   28  289 6803.20309 12815.7422  88.4%  1116  741s
  5336  2800 8141.48478   29  285 6803.20309 12815.7422  88.4%  1119  747s
  5404  2783 8077.53972   32  259 6803.20309 12815.7422  88.4%  1118  752s
  5464  2775     cutoff   33      6803.20309 12815.7422  88.4%  1119  757s
  5535  2755 7799.47009   34  230 6803.20309 12815.7422  88.4%  1119  762s
  5632  2733 7320.72277   36  250 6803.20309 12815.7422  88.4%  1119  768s
  5728  2707 7159.21977   40  205 6803.20309 12815.7422  88.4%  1122  774s
  5818  2685 6955.41969   46  243 6803.20309 11918.0457  75.2%  1121  783s
  5934  2677 infeasible   21      6803.20309 11909.3705  75.1%  1123  790s
  6053  2661 9035.11489   18  234 6803.20309 11909.3705  75.1%  1123  795s
  6160  2633 7575.31023   20  223 6803.20309 11909.3705  75.1%  1123  801s
  6290  2567     cutoff   23      6803.20309 11373.3969  67.2%  1125  807s
  6392  2537 7696.66762   19  217 6803.20309 11102.4095  63.2%  1131  815s
  6515  2512 infeasible   18      6803.20309 10757.4215  58.1%  1136  822s
  6628  2508 9201.97741   25  195 6803.20309 10546.6903  55.0%  1136  828s
  6811  2470 8949.25323   27  220 6803.20309 10546.6903  55.0%  1127  836s
  7010  2391 7989.73185   31  239 6803.20309 10540.1618  54.9%  1116  841s
  7194  2330 infeasible   35      6803.20309 9954.84031  46.3%  1112  847s
  7360  2242 7437.10389   23  240 6803.20309 9937.21826  46.1%  1111  856s
  7554  2157 8809.34534   23  353 6803.20309 9937.21826  46.1%  1114  863s
  7719  2086 7590.07295   25  180 6803.20309 9937.21826  46.1%  1118  872s
  7914  2002     cutoff   27      6803.20309 9937.21826  46.1%  1120  879s
  8194  1845 7162.29293   37  124 6803.20309 9147.38967  34.5%  1109  886s
  8507  1633 infeasible   33      6803.20309 9082.64733  33.5%  1101  893s
  8822  1344 infeasible   19      6803.20309 8339.50287  22.6%  1094  899s
  9170  1181     cutoff   28      6803.20309 8114.63145  19.3%  1076  904s

Cutting planes:
  Learned: 2
  MIR: 386
  Mixing: 1
  Flow cover: 745
  Inf proof: 1
  RLT: 8
  Relax-and-lift: 61

Explored 9271 nodes (10092142 simplex iterations) in 904.96 seconds (1598.49 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: 6803.2 6798.9 6725.19 ... -4004.97

Optimal solution found (tolerance 1.00e-04)
Best objective 6.803203089693e+03, best bound 6.803203089693e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 904.98s
  Master Objective (UB) = 6803.20, θ = 135332.36
  Upper Bound (UB) = 6803.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135332.36
  [DEBUG]   ✓ Scenario 0: θ = 135332.36 ≤ Q = 135332.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135332.36 ≤ Q = 135332.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135332.36 ≤ Q = 135332.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135332.36 ≤ Q = 135332.36 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x44c6ec1d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x44c6ec1d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6624355.8925
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.353853e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135385.26    0  123 6624355.89 -135385.26   102%     -    0s
H    0     0                    -106549.6627 -135385.26  27.1%     -    0s
H    0     0                    -106702.8237 -135385.26  26.9%     -    0s
     0     0 -112763.44    0   94 -106702.82 -112763.44  5.68%     -    0s
H    0     0                    -109451.5073 -112654.93  2.93%     -    0s
H    0     0                    -110265.6345 -112654.93  2.17%     -    0s
     0     0 -111963.84    0   98 -110265.63 -111963.84  1.54%     -    0s
     0     0 -111471.35    0  103 -110265.63 -111471.35  1.09%     -    0s
     0     0 -111412.83    0  103 -110265.63 -111412.83  1.04%     -    0s
     0     0 -111411.99    0  103 -110265.63 -111411.99  1.04%     -    0s
     0     0 -111010.87    0   96 -110265.63 -111010.87  0.68%     -    0s
     0     0 -110967.16    0  103 -110265.63 -110967.16  0.64%     -    0s
     0     0 -110946.09    0  103 -110265.63 -110946.09  0.62%     -    0s
     0     0 -110792.59    0  104 -110265.63 -110792.59  0.48%     -    0s
     0     0 -110766.51    0  103 -110265.63 -110766.51  0.45%     -    0s
H    0     0                    -110300.9972 -110766.51  0.42%     -    0s
H    0     2                    -110303.6861 -110766.51  0.42%     -    0s
     0     2 -110766.51    0  101 -110303.69 -110766.51  0.42%     -    0s

Cutting planes:
  Gomory: 44
  Implied bound: 9
  MIR: 224
  Flow cover: 2
  RLT: 7
  BQP: 4

Explored 582 nodes (3628 simplex iterations) in 0.22 seconds (0.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -110304 -110301 -110266 ... 1.48645e+13
No other solutions better than -110304

Optimal solution found (tolerance 1.00e-04)
Best objective -1.103036860687e+05, best bound -1.103036860687e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 133080.86
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110303.69
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -110303.69 = 133080.86
  [DEBUG]   Current θ from Master = 135332.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2251.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4551.71
  Lower Bound (LB) = 4551.71
  Gap (UB-LB) = 2251.4954, Absolute Gap = 2251.4954, Relative Gap = 0.330946
  Not converged yet (gap = 2251.50 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221554 nonzeros
Model fingerprint: 0x18e1ea9a
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 39390 rows and 15990 columns
Presolve time: 1.41s
Presolved: 38443 rows, 17470 columns, 237669 nonzeros
Variable types: 15211 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -168431.6867

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 38443 rows, 17470 columns, 237669 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25979   -5.9168474e+03   0.000000e+00   8.564175e+06      5s
   36276    6.2067762e+03   0.000000e+00   4.856490e+06     10s
Concurrent spin time: 1.06s

Solved with dual simplex

Root relaxation: objective 2.646010e+04, 23509 iterations, 11.32 seconds (14.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26460.0978    0  234 -168431.69 26460.0978   116%     -   13s
H    0     0                    -158473.3607 26460.0978   117%     -   13s
H    0     0                    -75004.37089 26460.0978   135%     -   13s
H    0     0                    -74378.37503 26460.0978   136%     -   13s
H    0     0                    -67161.28764 26460.0978   139%     -   13s
H    0     0                    -58544.49987 26460.0978   145%     -   13s
H    0     0                    -41854.65529 26460.0978   163%     -   13s
H    0     0                    -39001.54617 26460.0978   168%     -   13s
H    0     0                    -32694.77968 26460.0978   181%     -   14s
H    0     0                    -25292.31035 26460.0978   205%     -   14s
H    0     0                    -23809.91503 26460.0978   211%     -   14s
H    0     0                    -23570.05834 26460.0978   212%     -   14s
H    0     0                    -17985.43515 22431.4489   225%     -   18s
     0     0 22324.3051    0  214 -17985.435 22324.3051   224%     -   18s
     0     0 22247.6302    0  215 -17985.435 22247.6302   224%     -   19s
     0     0 22039.2581    0  228 -17985.435 22039.2581   223%     -   20s
     0     0 22039.2581    0  223 -17985.435 22039.2581   223%     -   21s
     0     0 22039.2581    0  216 -17985.435 22039.2581   223%     -   21s
     0     0 22039.2581    0  217 -17985.435 22039.2581   223%     -   22s
     0     0 22039.2581    0  221 -17985.435 22039.2581   223%     -   22s
H    0     0                    -16116.97242 19560.8097   221%     -   27s
     0     0 19560.8097    0  305 -16116.972 19560.8097   221%     -   27s
H    0     0                    -14514.70017 19560.8005   235%     -   28s
H    0     0                    -11843.12625 19560.8005   265%     -   28s
H    0     0                    -11517.85551 19560.8005   270%     -   28s
H    0     0                    -11069.20909 19098.2427   273%     -   31s
H    0     0                    -6882.958449 19098.2427   377%     -   31s
H    0     0                    -4654.110292 19098.2427   510%     -   31s
H    0     0                    3220.5423802 19098.2427   493%     -   31s
     0     0 19098.2427    0  316 3220.54238 19098.2427   493%     -   32s
     0     0 18975.0740    0  319 3220.54238 18975.0740   489%     -   33s
     0     0 18867.3961    0  358 3220.54238 18867.3961   486%     -   34s
     0     0 18774.2327    0  367 3220.54238 18774.2327   483%     -   35s
     0     0 18767.1897    0  368 3220.54238 18767.1897   483%     -   35s
     0     0 18765.0531    0  369 3220.54238 18765.0531   483%     -   36s
     0     0 18764.8251    0  370 3220.54238 18764.8251   483%     -   36s
     0     0 17150.1251    0  368 3220.54238 17150.1251   433%     -   43s
     0     0 16959.9586    0  365 3220.54238 16959.9586   427%     -   45s
     0     0 16916.3485    0  339 3220.54238 16916.3485   425%     -   47s
     0     0 16897.1062    0  337 3220.54238 16897.1062   425%     -   47s
     0     0 16884.5504    0  331 3220.54238 16884.5504   424%     -   48s
     0     0 16876.9948    0  333 3220.54238 16876.9948   424%     -   48s
     0     0 16876.4696    0  335 3220.54238 16876.4696   424%     -   48s
     0     0 16146.0875    0  348 3220.54238 16146.0875   401%     -   58s
H    0     0                    4420.6410685 15815.4984   258%     -   61s
H    0     0                    4945.7852949 15815.4984   220%     -   61s
     0     0 15815.4984    0  396 4945.78529 15815.4984   220%     -   61s
     0     0 15663.3859    0  408 4945.78529 15663.3859   217%     -   63s
     0     0 15582.3069    0  409 4945.78529 15582.3069   215%     -   65s
     0     0 15564.4790    0  403 4945.78529 15564.4790   215%     -   66s
     0     0 15555.8832    0  409 4945.78529 15555.8832   215%     -   66s
     0     0 15549.8233    0  412 4945.78529 15549.8233   214%     -   67s
     0     0 15548.5317    0  413 4945.78529 15548.5317   214%     -   67s
     0     0 15547.9091    0  416 4945.78529 15547.9091   214%     -   68s
     0     0 15427.7322    0  367 4945.78529 15427.7322   212%     -   71s
H    0     0                    6226.6337406 15424.8041   148%     -   71s
H    0     0                    6279.5166266 15424.8041   146%     -   71s
H    0     0                    6352.2032823 15424.8041   143%     -   71s
H    0     0                    6405.0861682 15424.8041   141%     -   71s
H    0     0                    6486.5781246 15424.8041   138%     -   71s
     0     0 15369.9777    0  370 6486.57812 15369.9777   137%     -   72s
     0     0 15357.0390    0  382 6486.57812 15357.0390   137%     -   73s
H    0     0                    6500.9499036 15348.6177   136%     -   74s
     0     0 15348.6177    0  361 6500.94990 15348.6177   136%     -   74s
     0     0 15341.5413    0  371 6500.94990 15341.5413   136%     -   74s
     0     0 15338.9865    0  365 6500.94990 15338.9865   136%     -   75s
     0     0 15336.7636    0  371 6500.94990 15336.7636   136%     -   75s
     0     0 15335.1490    0  369 6500.94990 15335.1490   136%     -   75s
     0     0 15334.7918    0  369 6500.94990 15334.7918   136%     -   75s
     0     0 15244.7689    0  373 6500.94990 15244.7689   135%     -   78s
H    0     0                    6599.5165183 15244.5478   131%     -   78s
     0     0 15152.3710    0  370 6599.51652 15152.3710   130%     -   80s
     0     0 15132.0619    0  369 6599.51652 15132.0619   129%     -   81s
     0     0 15124.6888    0  373 6599.51652 15124.6888   129%     -   82s
     0     0 15122.9356    0  374 6599.51652 15122.9356   129%     -   82s
     0     0 15121.7036    0  378 6599.51652 15121.7036   129%     -   83s
     0     0 15055.1315    0  375 6599.51652 15055.1315   128%     -   85s
     0     0 15027.3928    0  381 6599.51652 15027.3928   128%     -   86s
     0     0 15022.3251    0  389 6599.51652 15022.3251   128%     -   87s
     0     0 15018.3452    0  387 6599.51652 15018.3452   128%     -   87s
     0     0 15016.6216    0  386 6599.51652 15016.6216   128%     -   87s
     0     0 15015.3698    0  390 6599.51652 15015.3698   128%     -   88s
     0     0 14893.6756    0  366 6599.51652 14893.6756   126%     -   90s
     0     0 14870.4294    0  380 6599.51652 14870.4294   125%     -   91s
     0     0 14862.6743    0  381 6599.51652 14862.6743   125%     -   92s
     0     0 14860.8146    0  384 6599.51652 14860.8146   125%     -   92s
     0     0 14858.2286    0  383 6599.51652 14858.2286   125%     -   92s
     0     0 14858.0686    0  384 6599.51652 14858.0686   125%     -   92s
     0     0 14828.9975    0  384 6599.51652 14828.9975   125%     -   94s
     0     0 14817.3269    0  436 6599.51652 14817.3269   125%     -   96s
     0     0 14814.8675    0  443 6599.51652 14814.8675   124%     -   96s
     0     0 14814.7853    0  443 6599.51652 14814.7853   124%     -   96s
     0     0 14801.8513    0  390 6599.51652 14801.8513   124%     -   98s
     0     0 14791.1375    0  386 6599.51652 14791.1375   124%     -  101s
     0     0 14787.6296    0  386 6599.51652 14787.6296   124%     -  102s
     0     0 14786.5077    0  387 6599.51652 14786.5077   124%     -  103s
     0     0 14745.0507    0  387 6599.51652 14745.0507   123%     -  106s
     0     0 14729.4041    0  392 6599.51652 14729.4041   123%     -  107s
     0     0 14721.2204    0  399 6599.51652 14721.2204   123%     -  108s
     0     0 14719.6473    0  400 6599.51652 14719.6473   123%     -  108s
     0     0 14718.8963    0  401 6599.51652 14718.8963   123%     -  108s
     0     0 14708.3603    0  396 6599.51652 14708.3603   123%     -  109s
     0     0 14704.3864    0  401 6599.51652 14704.3864   123%     -  110s
     0     0 14704.0201    0  403 6599.51652 14704.0201   123%     -  111s
     0     0 14695.9038    0  381 6599.51652 14695.9038   123%     -  112s
     0     0 14687.5517    0  444 6599.51652 14687.5517   123%     -  113s
     0     0 14683.4032    0  393 6599.51652 14683.4032   122%     -  114s
     0     0 14683.0818    0  448 6599.51652 14683.0818   122%     -  114s
     0     0 14679.8275    0  445 6599.51652 14679.8275   122%     -  115s
     0     0 14677.8326    0  436 6599.51652 14677.8326   122%     -  116s
     0     0 14677.1555    0  443 6599.51652 14677.1555   122%     -  117s
     0     0 14675.7971    0  439 6599.51652 14675.7971   122%     -  118s
     0     0 14674.5549    0  387 6599.51652 14674.5549   122%     -  118s
     0     0 14666.3243    0  439 6599.51652 14666.3243   122%     -  119s
H    0     0                    6630.7768896 14666.2646   121%     -  123s
H    0     0                    6725.1924311 14666.2646   118%     -  124s
H    0     0                    6798.9009219 14666.2646   116%     -  125s
     0     0 14625.6231    0  445 6798.90092 14625.6231   115%     -  127s
     0     0 14621.0720    0  449 6798.90092 14621.0720   115%     -  128s
     0     0 14619.0138    0  392 6798.90092 14619.0138   115%     -  128s
     0     0 14618.6111    0  445 6798.90092 14618.6111   115%     -  128s
     0     0 14615.1632    0  447 6798.90092 14615.1632   115%     -  130s
     0     0 14612.2933    0  453 6798.90092 14612.2933   115%     -  130s
     0     0 14611.4347    0  446 6798.90092 14611.4347   115%     -  131s
     0     0 14610.4191    0  452 6798.90092 14610.4191   115%     -  132s
     0     0 14609.4839    0  455 6798.90092 14609.4839   115%     -  132s
     0     0 14609.4839    0  455 6798.90092 14609.4839   115%     -  133s
     0     0 14609.4839    0  453 6798.90092 14609.4839   115%     -  133s
     0     0 14609.4839    0  455 6798.90092 14609.4839   115%     -  134s
     0     0 14608.8376    0  455 6798.90092 14608.8376   115%     -  135s
     0     2 14608.8376    0  455 6798.90092 14608.8376   115%     -  151s
     1     4 14566.1341    1  445 6798.90092 14608.8376   115%  2202  155s
     7    16 14261.7411    3  376 6798.90092 14527.5593   114%  2881  164s
    15    32 14000.0253    4  430 6798.90092 14260.1920   110%  3747  169s
    31    52 12123.0846    5  297 6798.90092 13999.8543   106%  4612  180s
    51    84 10495.7997    6  279 6798.90092 13997.8703   106%  4634  186s
    83   212 10454.4830    7  274 6798.90092 13997.8703   106%  3561  192s
   213   243 9153.23119   10  167 6798.90092 13997.8703   106%  2101  195s
   291   310 10308.6055    8  192 6798.90092 13997.8703   106%  1762  203s
   334   341 9116.24353   11  166 6798.90092 13997.8703   106%  1653  205s
   429   395 9087.12404   11  167 6798.90092 13997.8703   106%  1450  216s
   486   427 8784.19660   11  156 6798.90092 13789.1818   103%  1365  222s
   541   451 8095.64517   10  146 6798.90092 13789.1818   103%  1341  229s
   597   476     cutoff   10      6798.90092 13789.1818   103%  1308  237s
   658   492 8884.54863   12  138 6798.90092 13789.1818   103%  1269  244s
   718   509 8712.99861   12  238 6798.90092 13789.1818   103%  1277  247s
   774   538 8908.20858   12  157 6798.90092 13759.1256   102%  1267  256s
   813   569 8037.36830   12  144 6798.90092 13574.6950   100%  1275  261s
   871   597 8705.82127   12  163 6798.90092 13574.6950   100%  1270  265s
   939   631 8354.25393   13  159 6798.90092 13574.6950   100%  1244  273s
  1007   672 8024.19164   14   91 6798.90092 13574.6950   100%  1214  279s
  1080   723 7254.01071   16   30 6798.90092 13574.6950   100%  1186  282s
  1168   747     cutoff   17      6798.90092 13574.6950   100%  1150  291s
  1246   801 8319.40832    7  311 6798.90092 13541.9116  99.2%  1161  297s
  1326   863 8122.81423    8  222 6798.90092 12361.1869  81.8%  1155  303s
  1430   934 7974.01756   13  205 6798.90092 12205.5499  79.5%  1129  312s
  1547   999 7950.99951   15  205 6798.90092 12205.5499  79.5%  1097  321s
  1658  1041 7571.05244   19  173 6798.90092 12205.5499  79.5%  1075  325s
  1810  1075 7564.48424   20  175 6798.90092 12194.4107  79.4%  1048  333s
  1947  1160     cutoff   10      6798.90092 12194.4107  79.4%  1035  339s
  2109  1210 9092.00149   12  257 6798.90092 12139.1721  78.5%  1020  347s
  2227  1296 8989.88052   13  199 6798.90092 12139.1721  78.5%  1008  355s
  2383  1379 8105.29640   16  210 6798.90092 12064.0883  77.4%  1004  361s
  2546  1475 7186.47226   21  146 6798.90092 12064.0883  77.4%   985  367s
  2737  1526 9811.36390    9  233 6798.90092 12059.8876  77.4%   981  373s
  2893  1597 9075.22374   11  275 6798.90092 12059.8876  77.4%   973  379s
  3134  1682 8367.98348   15  206 6798.90092 11932.2745  75.5%   953  389s
  3330  1738 7819.67400   19  172 6798.90092 11932.2745  75.5%   939  398s
  3579  1778     cutoff   26      6798.90092 11830.0113  74.0%   925  406s
  3792  1896 8940.33084   11  122 6798.90092 11825.9484  73.9%   927  414s
  4073  1997 10967.1717   12  283 6798.90092 11632.8105  71.1%   911  423s
  4336  2065 9356.05435   15  231 6798.90092 11632.8105  71.1%   903  432s
  4555  2206 8771.54453   16  223 6798.90092 11523.9501  69.5%   902  440s
  4862  2290 7663.47944   24  147 6798.90092 11375.7142  67.3%   894  449s
  5112  2403 10707.4997   11  301 6798.90092 11311.6911  66.4%   897  457s
  5396  2404 7435.43535   46  455 6798.90092 11288.4720  66.0%   896  485s
  5398  2405 8125.77262   26  234 6798.90092 11288.4720  66.0%   896  501s
  5399  2406 9681.67779   29  394 6798.90092 11288.4720  66.0%   895  515s
  5400  2407 10873.5255   10  355 6798.90092 11288.4720  66.0%   895  523s
  5401  2407 7634.82653   15  412 6798.90092 11288.4720  66.0%   895  529s
  5402  2408 7649.47259   29  384 6798.90092 11288.4720  66.0%   895  535s
  5404  2409 10453.0436   12  427 6798.90092 11288.4720  66.0%   895  542s
  5406  2411 7494.65503   25  447 6798.90092 11288.4720  66.0%   894  546s
  5408  2412 8462.23537   15  457 6798.90092 11288.4720  66.0%   894  550s
  5410  2413 10853.2287   13  398 6798.90092 11288.4720  66.0%   894  555s
  5412  2415 10012.0385   14  406 6798.90092 11288.4720  66.0%   893  561s
  5415  2417 9955.14810   20  466 6798.90092 11288.4720  66.0%   893  568s
  5416  2417 8072.40479   18  465 6798.90092 11288.4720  66.0%   893  570s
  5418  2419 9038.58918   13  544 6798.90092 11288.4720  66.0%   892  576s
  5419  2419 9008.06544   11  457 6798.90092 11288.4720  66.0%   892  582s
  5421  2421 8279.75046   17  465 6798.90092 11288.4720  66.0%   892  588s
  5422  2421 8273.69208   17  460 6798.90092 11288.4720  66.0%   892  590s
  5424  2423 8618.67152   26  520 6798.90092 11288.4720  66.0%   891  613s
  5425  2423 7030.89839   10  520 6798.90092 11288.4720  66.0%   891  624s
  5426  2427 11288.4720   14  440 6798.90092 11288.4720  66.0%   911  629s
  5428  2430 11288.4720   15  395 6798.90092 11288.4720  66.0%   912  636s
  5432  2437 11288.4720   16  462 6798.90092 11288.4720  66.0%   913  650s
  5440  2450 11288.4720   17  509 6798.90092 11288.4720  66.0%   917  661s
  5456  2477 11288.4720   18  459 6798.90092 11288.4720  66.0%   938  670s
  5488  2495 11288.4720   19  454 6798.90092 11288.4720  66.0%   949  676s
  5520  2508 11288.4720   20  468 6798.90092 11288.4720  66.0%   968  684s
  5560  2529 11288.4720   21  431 6798.90092 11288.4720  66.0%   982  696s
  5611  2553 8233.78299   21  409 6798.90092 11288.4720  66.0%   997  706s
  5670  2575 11288.4720   22  407 6798.90092 11288.4720  66.0%  1024  714s
  5733  2583 9342.46528   22  365 6798.90092 11288.4720  66.0%  1048  722s
  5818  2586 10671.9242   23  320 6798.90092 11288.4720  66.0%  1062  733s
  5896  2578 10008.6272   23  405 6798.90092 11288.4720  66.0%  1075  745s
  5968  2579 10151.9189   24  226 6798.90092 11288.4720  66.0%  1088  753s
  6052  2580 9854.13160   24  353 6798.90092 11288.4720  66.0%  1097  762s
  6130  2574 9722.41678   25  150 6798.90092 11288.4720  66.0%  1103  772s
  6206  2575 9366.22545   26  133 6798.90092 11288.4720  66.0%  1117  782s
  6283  2564 9330.53271   27  129 6798.90092 11288.4720  66.0%  1122  791s
  6337  2558 7494.27624   27   91 6798.90092 11288.4720  66.0%  1136  799s
  6406  2552 7341.51422   28   62 6798.90092 11288.4720  66.0%  1145  811s
  6483  2546 7032.10209   32   37 6798.90092 11288.4720  66.0%  1153  822s
  6561  2547 10085.1293   21  309 6798.90092 11288.4720  66.0%  1162  833s
  6645  2552 9783.53939   24  280 6798.90092 11288.4720  66.0%  1173  839s
  6750  2524 7864.78923   27  151 6798.90092 11288.4720  66.0%  1176  849s
  6844  2495 7025.42178   29  150 6798.90092 10969.7589  61.3%  1189  859s
  6948  2473 7459.96303   26  141 6798.90092 10920.9234  60.6%  1206  867s
  7050  2442 7044.29860   28  150 6798.90092 10601.2203  55.9%  1218  875s
  7161  2431 9461.77372   24  114 6798.90092 10460.0352  53.8%  1226  884s
  7271  2441 7082.07003   26   27 6798.90092 10397.8688  52.9%  1239  890s
  7389  2400     cutoff   29      6798.90092 10341.0708  52.1%  1242  899s
  7541  2348     cutoff   31      6798.90092 10146.4389  49.2%  1249  909s
  7684  2299 8319.91239   24  245 6798.90092 10091.5259  48.4%  1265  918s
  7839  2269 7489.14279   25  218 6798.90092 9972.01504  46.7%  1279  926s
  8022  2204     cutoff   28      6798.90092 9954.50003  46.4%  1282  933s
  8101  2180 7653.31212   26  301 6798.90092 9933.76444  46.1%  1293  944s
  8287  2099 infeasible   35      6798.90092 9933.76444  46.1%  1295  955s
  8483  2019 7101.27014   29  199 6798.90092 9560.43921  40.6%  1306  966s
  8695  1912 8705.49140   26  117 6798.90092 9560.43921  40.6%  1313  979s
  8938  1786     cutoff   30      6798.90092 9560.43921  40.6%  1319  988s
  9193  1634 6982.93631   29  126 6798.90092 9089.53321  33.7%  1326  998s
  9502  1496 7037.42093   32  305 6798.90092 9089.53321  33.7%  1323 1006s
  9588  1462 7037.20948   33  310 6798.90092 9089.53321  33.7%  1321 1013s
  9652  1420 6898.27731   34  226 6798.90092 9089.53321  33.7%  1320 1023s
  9743  1340     cutoff   29      6798.90092 8812.01123  29.6%  1316 1032s
  9924  1141     cutoff   28      6798.90092 8658.67779  27.4%  1310 1042s
 10265   850 7353.96941   29  295 6798.90092 8127.63652  19.5%  1295 1052s
 10611   697 infeasible   31      6798.90092 7906.81644  16.3%  1276 1060s

Cutting planes:
  MIR: 388
  Flow cover: 904
  RLT: 9
  Relax-and-lift: 77

Explored 10685 nodes (13712316 simplex iterations) in 1063.53 seconds (1909.65 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6798.9 6725.19 6630.78 ... 6226.63

Optimal solution found (tolerance 1.00e-04)
Best objective 6.798900921925e+03, best bound 6.798900921925e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1063.54s
  Master Objective (UB) = 6798.90, θ = 135377.01
  Upper Bound (UB) = 6798.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135377.01
  [DEBUG]   ✓ Scenario 0: θ = 135377.01 ≤ Q = 135377.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135377.01 ≤ Q = 135377.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135377.01 ≤ Q = 135377.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135377.01 ≤ Q = 135377.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135377.01 ≤ Q = 135377.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xa9d8dc6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf562723a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.506465e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6742652.0838
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.353290e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135328.99    0  123 6742652.08 -135328.99   102%     -    0s
H    0     0                    -106472.9097 -135328.99  27.1%     -    0s
H    0     0                    -106626.0708 -135328.99  26.9%     -    0s
     0     0 -118624.12    0   96 -106626.07 -118624.12  11.3%     -    0s
H    0     0                    -115030.1672 -118552.87  3.06%     -    0s
H    0     0                    -116431.5297 -118552.87  1.82%     -    0s
     0     0 -117898.44    0  102 -116431.53 -117898.44  1.26%     -    0s
     0     0 -117825.99    0  103 -116431.53 -117825.99  1.20%     -    0s
     0     0 -117010.82    0   57 -116431.53 -117010.82  0.50%     -    0s
H    0     0                    -116434.0207 -116967.30  0.46%     -    0s
     0     0 -116839.68    0   55 -116434.02 -116839.68  0.35%     -    0s
     0     0 -116827.84    0   58 -116434.02 -116827.84  0.34%     -    0s
     0     0 -116551.65    0   16 -116434.02 -116551.65  0.10%     -    0s
     0     0 -116542.34    0   15 -116434.02 -116542.34  0.09%     -    0s
     0     0 -116487.74    0    6 -116434.02 -116487.74  0.05%     -    0s
     0     0 -116455.71    0    7 -116434.02 -116455.71  0.02%     -    0s
     0     0          -    0      -116434.02 -116444.45  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 1
  Flow cover: 4
  Relax-and-lift: 3

Explored 1 nodes (755 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -116434 -116432 -106626 ... 1.50647e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.164340206893e+05, best bound -1.164444526286e+05, gap 0.0090%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 126950.53
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116434.02
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -116434.02 = 126950.53
  [DEBUG]   Current θ from Master = 135377.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8426.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1627.58
  Lower Bound (LB) = 4551.71
  Gap (UB-LB) = 2247.1932, Absolute Gap = 2247.1932, Relative Gap = 0.330523
  Not converged yet (gap = 2247.19 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264761 nonzeros
Model fingerprint: 0x2e4cc90b
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47268 rows and 19188 columns
Presolve time: 1.24s
Presolved: 45855 rows, 20512 columns, 284099 nonzeros
Variable types: 18253 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 45855 rows, 20512 columns, 284099 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25487   -2.4203714e+04   0.000000e+00   1.822253e+07      5s
   37255    1.1641372e+04   0.000000e+00   1.088626e+06     10s
   47033    1.9181137e+04   0.000000e+00   5.837258e+06     15s
Concurrent spin time: 1.80s

Solved with dual simplex

Root relaxation: objective 2.625600e+04, 34671 iterations, 20.06 seconds (26.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26255.9986    0  232 -170236.42 26255.9986   115%     -   22s
H    0     0                    -160518.4572 26255.9986   116%     -   22s
H    0     0                    -93103.48867 26255.9986   128%     -   22s
H    0     0                    -70208.31720 26255.9986   137%     -   22s
H    0     0                    -45759.80347 26255.9986   157%     -   22s
H    0     0                    -32682.19721 26255.9986   180%     -   22s
H    0     0                    -30837.74395 26255.9986   185%     -   22s
H    0     0                    -29848.70723 26255.9986   188%     -   22s
H    0     0                    -29667.65375 26255.9986   189%     -   23s
H    0     0                    -24818.73359 26255.9986   206%     -   23s
H    0     0                    -24756.75280 26255.9986   206%     -   23s
     0     0 22166.9243    0  216 -24756.753 22166.9243   190%     -   30s
H    0     0                    -23640.78038 22166.3830   194%     -   31s
     0     0 21770.1787    0  222 -23640.780 21770.1787   192%     -   33s
     0     0 21550.2350    0  219 -23640.780 21550.2350   191%     -   34s
     0     0 21317.3090    0  223 -23640.780 21317.3090   190%     -   35s
     0     0 21293.2902    0  220 -23640.780 21293.2902   190%     -   36s
     0     0 21293.2902    0  225 -23640.780 21293.2902   190%     -   38s
     0     0 21291.2637    0  232 -23640.780 21291.2637   190%     -   39s
     0     0 21291.2637    0  232 -23640.780 21291.2637   190%     -   39s
     0     0 18566.8486    0  353 -23640.780 18566.8486   179%     -   45s
H    0     0                    -18787.79870 18565.9414   199%     -   46s
H    0     0                    -18186.76532 18565.9414   202%     -   46s
     0     0 18249.2537    0  356 -18186.765 18249.2537   200%     -   49s
     0     0 18220.6131    0  357 -18186.765 18220.6131   200%     -   51s
     0     0 18196.3751    0  359 -18186.765 18196.3751   200%     -   51s
     0     0 18132.6471    0  366 -18186.765 18132.6471   200%     -   53s
     0     0 18119.7192    0  366 -18186.765 18119.7192   200%     -   54s
     0     0 18114.3594    0  364 -18186.765 18114.3594   200%     -   54s
     0     0 18114.3538    0  364 -18186.765 18114.3538   200%     -   54s
H    0     0                    -17491.12259 16727.4746   196%     -   66s
H    0     0                    -11224.34953 16727.4746   249%     -   66s
H    0     0                    -9944.041970 16727.4746   268%     -   66s
H    0     0                    -8334.967328 16727.4746   301%     -   66s
H    0     0                    -8142.919093 16727.4746   305%     -   66s
H    0     0                    -7525.851117 16727.4746   322%     -   66s
H    0     0                    -5669.755866 16727.4746   395%     -   66s
H    0     0                    3389.5107591 16727.4746   394%     -   66s
H    0     0                    3933.8337773 16727.4746   325%     -   66s
H    0     0                    3986.7166633 16727.4746   320%     -   66s
H    0     0                    4488.6479842 16727.4746   273%     -   66s
     0     0 16727.4746    0  334 4488.64798 16727.4746   273%     -   66s
H    0     0                    5277.6475509 16726.3512   217%     -   66s
H    0     0                    5347.7329254 16726.3512   213%     -   66s
H    0     0                    5531.4462283 16726.3512   202%     -   66s
H    0     0                    5579.4301515 16726.3512   200%     -   66s
H    0     0                    5584.3291143 16726.3512   200%     -   66s
     0     0 16165.1533    0  338 5584.32911 16165.1533   189%     -   71s
     0     0 16054.5685    0  400 5584.32911 16054.5685   187%     -   73s
     0     0 16034.4820    0  351 5584.32911 16034.4820   187%     -   74s
     0     0 15960.4184    0  340 5584.32911 15960.4184   186%     -   76s
     0     0 15941.7013    0  348 5584.32911 15941.7013   185%     -   77s
     0     0 15935.1502    0  349 5584.32911 15935.1502   185%     -   78s
     0     0 15924.2670    0  351 5584.32911 15924.2670   185%     -   79s
     0     0 15913.8620    0  354 5584.32911 15913.8620   185%     -   80s
     0     0 15912.9488    0  356 5584.32911 15912.9488   185%     -   80s
     0     0 15132.5465    0  363 5584.32911 15132.5465   171%     -   90s
     0     0 14954.6499    0  353 5584.32911 14954.6499   168%     -   94s
     0     0 14833.4619    0  368 5584.32911 14833.4619   166%     -   96s
     0     0 14806.9735    0  393 5584.32911 14806.9735   165%     -   98s
     0     0 14788.7644    0  383 5584.32911 14788.7644   165%     -   99s
     0     0 14780.0975    0  382 5584.32911 14780.0975   165%     -  100s
     0     0 14778.8256    0  383 5584.32911 14778.8256   165%     -  100s
     0     0 14690.2478    0  382 5584.32911 14690.2478   163%     -  104s
H    0     0                    5800.0395027 14689.7322   153%     -  104s
H    0     0                    6155.7384725 14689.7322   139%     -  104s
H    0     0                    6239.8683037 14689.7322   135%     -  104s
H    0     0                    6309.1417744 14689.7322   133%     -  104s
H    0     0                    6362.0246603 14689.7322   131%     -  104s
     0     0 14656.9347    0  426 6362.02466 14656.9347   130%     -  106s
     0     0 14648.9856    0  436 6362.02466 14648.9856   130%     -  107s
     0     0 14643.3600    0  435 6362.02466 14643.3600   130%     -  108s
     0     0 14640.4971    0  394 6362.02466 14640.4971   130%     -  108s
     0     0 14639.8357    0  388 6362.02466 14639.8357   130%     -  108s
     0     0 14499.6854    0  430 6362.02466 14499.6854   128%     -  112s
H    0     0                    6640.0060816 14494.6831   118%     -  113s
H    0     0                    6641.1432975 14494.6831   118%     -  114s
     0     0 14470.5717    0  394 6641.14330 14470.5717   118%     -  116s
     0     0 14463.8051    0  393 6641.14330 14463.8051   118%     -  117s
     0     0 14460.8534    0  393 6641.14330 14460.8534   118%     -  117s
     0     0 14458.5198    0  443 6641.14330 14458.5198   118%     -  118s
     0     0 14454.7035    0  388 6641.14330 14454.7035   118%     -  118s
     0     0 14454.2110    0  390 6641.14330 14454.2110   118%     -  118s
     0     0 14430.5159    0  443 6641.14330 14430.5159   117%     -  120s
     0     0 14416.5275    0  503 6641.14330 14416.5275   117%     -  122s
     0     0 14410.0045    0  399 6641.14330 14410.0045   117%     -  122s
     0     0 14409.4958    0  397 6641.14330 14409.4958   117%     -  123s
     0     0 14390.7509    0  455 6641.14330 14390.7509   117%     -  125s
     0     0 14384.6426    0  384 6641.14330 14384.6426   117%     -  126s
     0     0 14382.3031    0  392 6641.14330 14382.3031   117%     -  126s
     0     0 14379.4723    0  383 6641.14330 14379.4723   117%     -  127s
     0     0 14378.7226    0  435 6641.14330 14378.7226   117%     -  127s
     0     0 14365.8097    0  452 6641.14330 14365.8097   116%     -  129s
     0     0 14359.4276    0  387 6641.14330 14359.4276   116%     -  131s
     0     0 14356.7633    0  451 6641.14330 14356.7633   116%     -  131s
     0     0 14355.4964    0  449 6641.14330 14355.4964   116%     -  132s
     0     0 14339.2050    0  396 6641.14330 14339.2050   116%     -  134s
     0     0 14331.6298    0  454 6641.14330 14331.6298   116%     -  140s
     0     0 14328.3283    0  438 6641.14330 14328.3283   116%     -  141s
     0     0 14327.3730    0  462 6641.14330 14327.3730   116%     -  141s
     0     0 14316.2439    0  457 6641.14330 14316.2439   116%     -  143s
     0     0 14313.0251    0  405 6641.14330 14313.0251   116%     -  144s
     0     0 14312.1127    0  410 6641.14330 14312.1127   116%     -  144s
     0     0 14306.2272    0  413 6641.14330 14306.2272   115%     -  145s
     0     0 14303.5992    0  461 6641.14330 14303.5992   115%     -  146s
     0     0 14303.3815    0  461 6641.14330 14303.3815   115%     -  146s
     0     0 14299.0364    0  456 6641.14330 14299.0364   115%     -  148s
     0     0 14298.1809    0  414 6641.14330 14298.1809   115%     -  148s
     0     0 14296.1970    0  412 6641.14330 14296.1970   115%     -  149s
     0     0 14296.1445    0  412 6641.14330 14296.1445   115%     -  150s
     0     2 14295.5765    0  412 6641.14330 14295.5765   115%     -  182s
     1     4 14188.0274    1  456 6641.14330 14295.3285   115%  2292  188s
     3     8 13890.3012    2  478 6641.14330 14187.2656   114%  4798  192s
     7    16 13789.6746    3  457 6641.14330 13998.2013   111%  3919  199s
    15    32 13559.0608    4  463 6641.14330 13789.1856   108%  4430  208s
    31    50 11775.9571    5  292 6641.14330 13558.9835   104%  6905  272s
    51    80 12466.0406    6  367 6641.14330 13558.9835   104%  6944  280s
    83   195 12203.2585    7  320 6641.14330 13558.9835   104%  5147  291s
H  117   195                    6686.8627295 13558.9835   103%  4324  291s
   202   266 11494.0645    9  285 6686.86273 13558.9835   103%  3204  297s
   300   307 11793.8028   10  369 6686.86273 13558.9835   103%  2646  306s
   385   335 11912.1466   10  383 6686.86273 13558.9835   103%  2400  316s
   464   349 11470.4788   10  279 6686.86273 13558.9835   103%  2282  325s
   510   369 10199.9636   11  315 6686.86273 13558.9835   103%  2325  332s
   580   390 9169.99529   11  336 6686.86273 13558.9835   103%  2265  341s
   630   407 11859.0093   11  380 6686.86273 13558.9835   103%  2240  348s
   686   426 11319.2828   11  231 6686.86273 13500.3517   102%  2258  357s
   749   460 10408.5881   12  311 6686.86273 13500.3517   102%  2243  363s
   809   491 9640.14415   12  324 6686.86273 13500.3517   102%  2217  369s
   872   517 7237.27082   12  349 6686.86273 13500.3517   102%  2182  377s
   948   536 10016.8887   13  365 6686.86273 13500.3517   102%  2161  387s
  1013   561     cutoff   13      6686.86273 13353.8229   100%  2142  396s
  1083   585     cutoff   15      6686.86273 13353.8229   100%  2122  405s
  1147   611 7197.38866   14  230 6686.86273 13353.8229   100%  2146  414s
  1210   661 7360.20469   16  281 6686.86273 13353.8229   100%  2167  423s
  1296   735 6842.89860   17  263 6686.86273 13121.7560  96.2%  2134  433s
  1412   778     cutoff   18      6686.86273 13121.7560  96.2%  2048  444s
  1507   816 10063.3673   12  332 6686.86273 13121.7560  96.2%  2009  455s
  1571   884 9927.15678   13  317 6686.86273 12435.1965  86.0%  1996  465s
  1670   963 8977.20571   16  276 6686.86273 12349.6525  84.7%  1956  474s
  1817  1022 8369.37463   19  321 6686.86273 12349.6525  84.7%  1902  484s
  1946  1080 8083.10175   23  275 6686.86273 12199.2979  82.4%  1859  495s
  2076  1115 infeasible   27      6686.86273 12199.2979  82.4%  1841  505s
  2181  1147 10011.1136   12  402 6686.86273 12199.2979  82.4%  1845  515s
  2319  1206 9796.69562   13  324 6686.86273 12199.2979  82.4%  1836  525s
  2486  1223 8037.84435   17  292 6686.86273 12199.2979  82.4%  1805  537s
  2655  1267     cutoff   18      6686.86273 11907.9530  78.1%  1781  550s
  2801  1283 8207.05605   19  295 6686.86273 11738.9015  75.6%  1778  557s
  2849  1292     cutoff   20      6686.86273 11738.9015  75.6%  1779  568s
  2904  1301     cutoff   21      6686.86273 11738.9015  75.6%  1796  580s
  2971  1322 8106.88288   17  195 6686.86273 11636.7305  74.0%  1794  590s
  3044  1343 6891.31327   18  236 6686.86273 11636.7305  74.0%  1796  599s
  3139  1381 6732.14788   19  224 6686.86273 11559.2957  72.9%  1795  610s
  3255  1420 8585.89568   17  209 6686.86273 11505.0455  72.1%  1793  623s
  3406  1459 7727.20615   19  210 6686.86273 11505.0455  72.1%  1767  637s
  3550  1472 6971.61334   19  210 6686.86273 11352.1171  69.8%  1781  651s
  3716  1509 10256.3336   14  342 6686.86273 11335.3807  69.5%  1781  668s
  3913  1523 7460.97997   18  388 6686.86273 11335.3807  69.5%  1788  682s
  4112  1567     cutoff   19      6686.86273 11175.2170  67.1%  1783  696s
  4363  1629 7626.31099   14  270 6686.86273 10987.0279  64.3%  1772  714s
  4603  1660 10644.1481   14  317 6686.86273 10866.0098  62.5%  1764  729s
  4844  1688     cutoff   21      6686.86273 10856.7268  62.4%  1758  746s
  5109  1727 7010.29330   15  271 6686.86273 10676.1521  59.7%  1750  765s
  5350  1768 8167.47822   17  292 6686.86273 10540.2679  57.6%  1754  786s
  5607  1788 7381.43693   21  293 6686.86273 10399.1808  55.5%  1753  807s
  5955  1832 7602.69404   12  186 6686.86273 10190.6311  52.4%  1737  826s
  6202  1892     cutoff   15      6686.86273 10190.6311  52.4%  1729  848s
  6591  1919 6948.08175   30  176 6686.86273 10092.9160  50.9%  1703  866s
  6890  1945     cutoff   18      6686.86273 9960.74044  49.0%  1697  886s
  7135  2000 6866.90386   20   91 6686.86273 9881.15873  47.8%  1694  905s
  7629  2026 7581.71290   25  262 6686.86273 9726.10342  45.5%  1669  927s
  8042  2034 infeasible   29      6686.86273 9639.18823  44.2%  1660  951s
  8592  2069 8204.44582   16   88 6686.86273 9496.64729  42.0%  1634  974s
  9108  2118 7505.64119   13  326 6686.86273 9319.86148  39.4%  1619  997s
  9665  2103 7828.16830   11  218 6686.86273 9233.66324  38.1%  1596 1022s
 10276  2067     cutoff   22      6686.86273 8976.69620  34.2%  1572 1049s
 10944  2014 7140.33399   21  157 6686.86273 8844.78913  32.3%  1548 1073s
 11649  1859     cutoff   23      6686.86273 8626.15159  29.0%  1521 1100s
 12314  1737 infeasible   14      6686.86273 8432.90183  26.1%  1509 1126s
 13230  1582 7000.31182   35  157 6686.86273 8209.99309  22.8%  1471 1152s
 14331  1433     cutoff   31      6686.86273 8004.60623  19.7%  1420 1176s
 14927  1149 6944.94147   22   96 6686.86273 7902.70818  18.2%  1395 1202s
 16386   351     cutoff   30      6686.86273 7645.08684  14.3%  1324 1226s
 18084     0     cutoff   28      6686.86273 7330.47958  9.63%  1246 1236s

Cutting planes:
  Learned: 1
  Cover: 1
  Implied bound: 23
  MIR: 732
  Flow cover: 1189
  RLT: 31
  Relax-and-lift: 74

Explored 18670 nodes (22902939 simplex iterations) in 1236.61 seconds (2576.45 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6686.86 6641.14 6640.01 ... 5579.43

Optimal solution found (tolerance 1.00e-04)
Best objective 6.686862729509e+03, best bound 6.686862729509e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1236.68s
  Master Objective (UB) = 6686.86, θ = 134936.01
  Upper Bound (UB) = 6686.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134936.01
  [DEBUG]   ✓ Scenario 0: θ = 134936.01 ≤ Q = 134936.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 134936.01 ≤ Q = 134936.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 134936.01 ≤ Q = 134979.99 (slack: 43.98)
  [DEBUG]   ✓ Scenario 3: θ = 134936.01 ≤ Q = 135309.86 (slack: 373.84)
  [DEBUG]   ✓ Scenario 4: θ = 134936.01 ≤ Q = 135045.47 (slack: 109.45)
  [DEBUG]   ✓ Scenario 5: θ = 134936.01 ≤ Q = 134936.01 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2535cfe5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdaca301b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6646416.3241
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.358466e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135846.60    0  123 6646416.32 -135846.60   102%     -    0s
H    0     0                    -107080.5584 -135846.60  26.9%     -    0s
H    0     0                    -107233.7195 -135846.60  26.7%     -    0s
     0     0 -112921.26    0   96 -107233.72 -112921.26  5.30%     -    0s
H    0     0                    -109599.7344 -112812.77  2.93%     -    0s
H    0     0                    -110339.1525 -112812.77  2.24%     -    0s
     0     0 -112133.18    0  101 -110339.15 -112133.18  1.63%     -    0s
     0     0 -112060.74    0  101 -110339.15 -112060.74  1.56%     -    0s
     0     0 -111652.80    0  104 -110339.15 -111652.80  1.19%     -    0s
     0     0 -111612.47    0  105 -110339.15 -111612.47  1.15%     -    0s
     0     0 -111434.64    0   99 -110339.15 -111434.64  0.99%     -    0s
     0     0 -111393.45    0  106 -110339.15 -111393.45  0.96%     -    0s
     0     0 -111262.59    0  106 -110339.15 -111262.59  0.84%     -    0s
     0     0 -111229.04    0  106 -110339.15 -111229.04  0.81%     -    0s
H    0     0                    -110340.3103 -111228.37  0.80%     -    0s
     0     2 -111228.37    0  106 -110340.31 -111228.37  0.80%     -    0s
H  395   138                    -110351.1542 -110768.44  0.38%   7.9    0s
H  708    98                    -110375.5326 -110768.44  0.36%   7.7    0s
H 1271     3                    -110377.8584 -110403.37  0.02%   6.4    0s

Cutting planes:
  Gomory: 45
  Implied bound: 9
  MIR: 217
  Flow cover: 7
  RLT: 12
  BQP: 2

Explored 1308 nodes (8848 simplex iterations) in 0.32 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -110378 -110376 -110351 ... 1.48645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.103778583861e+05, best bound -1.103791709128e+05, gap 0.0012%
  Subproblem solved in 0.35s
  Worst-case operational profit (Z_SP) = 133006.69
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110377.86
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -110377.86 = 133006.69
  [DEBUG]   Current θ from Master = 134936.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1929.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4757.54
  Lower Bound (LB) = 4757.54
  Gap (UB-LB) = 1929.3247, Absolute Gap = 1929.3247, Relative Gap = 0.288525
  Not converged yet (gap = 1929.32 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 307968 nonzeros
Model fingerprint: 0x85746dac
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55146 rows and 22386 columns
Presolve time: 1.50s
Presolved: 53267 rows, 23554 columns, 330529 nonzeros
Variable types: 21295 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53267 rows, 23554 columns, 330529 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24311   -1.1113910e+05   0.000000e+00   1.754341e+09      5s
   36442   -9.9264308e+03   0.000000e+00   3.721445e+06     10s
   45426    4.1530356e+03   0.000000e+00   1.374436e+07     15s
   53966    1.1312040e+04   0.000000e+00   1.256131e+07     20s
   61154    2.0163030e+04   0.000000e+00   1.213584e+07     25s
Concurrent spin time: 0.12s

Solved with dual simplex

Root relaxation: objective 2.625600e+04, 34672 iterations, 25.12 seconds (33.63 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26255.9986    0  232 -170236.42 26255.9986   115%     -   27s
H    0     0                    -163861.3468 26255.9986   116%     -   27s
H    0     0                    -152889.3986 26255.9986   117%     -   27s
H    0     0                    -50135.43031 26255.9986   152%     -   27s
H    0     0                    -46941.52943 26255.9986   156%     -   27s
H    0     0                    -39724.44204 26255.9986   166%     -   27s
H    0     0                    -27713.37733 26255.9986   195%     -   27s
H    0     0                    -16023.61040 26255.9986   264%     -   29s
H    0     0                    -15589.74376 26255.9986   268%     -   29s
H    0     0                    -13422.05451 26255.9986   296%     -   29s
H    0     0                    -13407.27946 26255.9986   296%     -   29s
H    0     0                    -10998.45104 26255.9986   339%     -   29s
H    0     0                    -8773.182976 22460.7631   356%     -   39s
H    0     0                    -8756.938152 22460.7631   356%     -   39s
H    0     0                    -8679.234442 22460.7631   359%     -   39s
H    0     0                    -8540.404668 22460.7631   363%     -   39s
     0     0 22327.3420    0  223 -8540.4047 22327.3420   361%     -   39s
     0     0 22262.1657    0  223 -8540.4047 22262.1657   361%     -   41s
     0     0 22262.1657    0  223 -8540.4047 22262.1657   361%     -   41s
     0     0 22154.1739    0  221 -8540.4047 22154.1739   359%     -   44s
     0     0 22154.1739    0  215 -8540.4047 22154.1739   359%     -   46s
     0     0 22154.1739    0  219 -8540.4047 22154.1739   359%     -   49s
H    0     0                    -8502.150290 22154.1739   361%     -   50s
     0     0 19624.5581    0  221 -8502.1503 19624.5581   331%     -   50s
     0     0 19624.5581    0  223 -8502.1503 19624.5581   331%     -   50s
     0     0 19624.5581    0  223 -8502.1503 19624.5581   331%     -   50s
     0     0 19622.5564    0  302 -8502.1503 19622.5564   331%     -   59s
H    0     0                    -2204.863230 19622.5564   990%     -   59s
H    0     0                    -1192.353734 19622.5564  1746%     -   59s
H    0     0                    -1032.778877 19622.5564  2000%     -   59s
H    0     0                    -747.1837462 19622.5564  2726%     -   59s
H    0     0                    -373.5651401 19622.5564  5353%     -   59s
H    0     0                    -292.5117746 19622.5564  6808%     -   59s
H    0     0                    -190.1577190 19622.5564      -     -   59s
H    0     0                    -155.9011694 19622.5564      -     -   59s
     0     0 19329.1667    0  305 -155.90117 19329.1667      -     -   64s
     0     0 19241.0002    0  308 -155.90117 19241.0002      -     -   66s
     0     0 19172.7195    0  323 -155.90117 19172.7195      -     -   68s
     0     0 19160.8606    0  317 -155.90117 19160.8606      -     -   69s
     0     0 19095.1001    0  305 -155.90117 19095.1001      -     -   71s
     0     0 19089.7790    0  306 -155.90117 19089.7790      -     -   72s
     0     0 19086.9250    0  308 -155.90117 19086.9250      -     -   72s
     0     0 19085.1812    0  310 -155.90117 19085.1812      -     -   73s
     0     0 19083.9985    0  312 -155.90117 19083.9985      -     -   73s
     0     0 19082.4825    0  318 -155.90117 19082.4825      -     -   74s
     0     0 19082.4771    0  318 -155.90117 19082.4771      -     -   74s
H    0     0                     704.0678729 19082.4771  2610%     -   79s
H    0     0                     953.4909192 19082.4771  1901%     -   79s
H    0     0                    1025.5715317 19082.4771  1761%     -   79s
H    0     0                    1226.5513740 19082.4771  1456%     -   79s
H    0     0                    1230.7650099 19082.4771  1450%     -   79s
H    0     0                    1316.4456065 19082.4771  1350%     -   79s
     0     0 16964.3234    0  330 1316.44561 16964.3234  1189%     -   89s
H    0     0                    1321.3008445 16963.9048  1184%     -   89s
H    0     0                    1437.3801766 16440.1078  1044%     -   95s
H    0     0                    1461.4905164 16440.1078  1025%     -   95s
H    0     0                    1538.9366251 16440.1078   968%     -   95s
H    0     0                    1540.7623250 16440.1078   967%     -   95s
H    0     0                    1546.1557006 16440.1078   963%     -   95s
H    0     0                    1555.1531595 16440.1078   957%     -   95s
H    0     0                    1593.7161702 16440.1078   932%     -   95s
H    0     0                    1607.2123383 16440.1078   923%     -   95s
H    0     0                    1639.4683356 16440.1078   903%     -   95s
     0     0 16440.1078    0  328 1639.46834 16440.1078   903%     -   95s
     0     0 16251.8657    0  339 1639.46834 16251.8657   891%     -   99s
     0     0 16201.2771    0  326 1639.46834 16201.2771   888%     -  101s
     0     0 16122.3262    0  342 1639.46834 16122.3262   883%     -  104s
     0     0 16098.1657    0  338 1639.46834 16098.1657   882%     -  106s
     0     0 16061.3185    0  336 1639.46834 16061.3185   880%     -  108s
     0     0 16042.1799    0  336 1639.46834 16042.1799   878%     -  109s
     0     0 16021.7363    0  325 1639.46834 16021.7363   877%     -  110s
     0     0 15968.5537    0  345 1639.46834 15968.5537   874%     -  112s
     0     0 15951.9012    0  344 1639.46834 15951.9012   873%     -  113s
H    0     0                    3184.4955802 15945.9442   401%     -  113s
H    0     0                    3469.9273534 15945.9442   360%     -  113s
H    0     0                    3471.5696035 15945.9442   359%     -  113s
H    0     0                    3657.0900554 15945.9442   336%     -  113s
H    0     0                    4004.3730054 15945.9442   298%     -  113s
H    0     0                    4293.7849690 15945.9442   271%     -  113s
     0     0 15945.9442    0  344 4293.78497 15945.9442   271%     -  113s
     0     0 15938.7207    0  344 4293.78497 15938.7207   271%     -  114s
     0     0 15935.9111    0  349 4293.78497 15935.9111   271%     -  115s
     0     0 15934.3405    0  352 4293.78497 15934.3405   271%     -  115s
     0     0 15934.1370    0  350 4293.78497 15934.1370   271%     -  115s
     0     0 15229.3740    0  368 4293.78497 15229.3740   255%     -  124s
     0     0 15129.5779    0  373 4293.78497 15129.5779   252%     -  127s
H    0     0                    4967.3931873 15007.3156   202%     -  131s
H    0     0                    5082.9388619 15007.3156   195%     -  131s
H    0     0                    5116.7252842 15007.3156   193%     -  131s
     0     0 15007.3156    0  372 5116.72528 15007.3156   193%     -  132s
     0     0 14985.4114    0  378 5116.72528 14985.4114   193%     -  132s
     0     0 14955.1631    0  380 5116.72528 14955.1631   192%     -  135s
     0     0 14950.5704    0  379 5116.72528 14950.5704   192%     -  136s
     0     0 14944.8942    0  380 5116.72528 14944.8942   192%     -  137s
     0     0 14942.6363    0  382 5116.72528 14942.6363   192%     -  137s
     0     0 14941.0098    0  379 5116.72528 14941.0098   192%     -  138s
     0     0 14940.3746    0  382 5116.72528 14940.3746   192%     -  138s
     0     0 14833.2896    0  436 5116.72528 14833.2896   190%     -  142s
H    0     0                    6010.2665187 14833.2583   147%     -  143s
H    0     0                    6110.1385091 14833.2583   143%     -  143s
     0     0 14804.2006    0  390 6110.13851 14804.2006   142%     -  145s
     0     0 14754.2812    0  436 6110.13851 14754.2812   141%     -  147s
     0     0 14749.6597    0  433 6110.13851 14749.6597   141%     -  148s
     0     0 14737.4473    0  482 6110.13851 14737.4473   141%     -  149s
     0     0 14732.0585    0  479 6110.13851 14732.0585   141%     -  150s
     0     0 14731.3610    0  479 6110.13851 14731.3610   141%     -  150s
     0     0 14646.1871    0  422 6110.13851 14646.1871   140%     -  154s
H    0     0                    6640.0060816 14646.0399   121%     -  155s
H    0     0                    6641.1432975 14646.0399   121%     -  155s
     0     0 14566.6918    0  382 6641.14330 14566.6918   119%     -  158s
     0     0 14511.5368    0  378 6641.14330 14511.5368   119%     -  160s
     0     0 14487.1946    0  388 6641.14330 14487.1946   118%     -  161s
     0     0 14483.4045    0  389 6641.14330 14483.4045   118%     -  161s
     0     0 14480.0100    0  379 6641.14330 14480.0100   118%     -  162s
     0     0 14477.9402    0  381 6641.14330 14477.9402   118%     -  162s
     0     0 14474.3947    0  378 6641.14330 14474.3947   118%     -  163s
     0     0 14473.4335    0  375 6641.14330 14473.4335   118%     -  163s
     0     0 14437.2036    0  396 6641.14330 14437.2036   117%     -  167s
     0     0 14428.0243    0  374 6641.14330 14428.0243   117%     -  169s
     0     0 14426.1993    0  390 6641.14330 14426.1993   117%     -  169s
     0     0 14425.5986    0  389 6641.14330 14425.5986   117%     -  169s
     0     0 14342.1177    0  403 6641.14330 14342.1177   116%     -  173s
     0     0 14311.9393    0  388 6641.14330 14311.9393   116%     -  176s
     0     0 14306.5264    0  397 6641.14330 14306.5264   115%     -  176s
     0     0 14304.3445    0  404 6641.14330 14304.3445   115%     -  177s
     0     0 14303.9676    0  395 6641.14330 14303.9676   115%     -  177s
     0     0 14282.5802    0  388 6641.14330 14282.5802   115%     -  180s
     0     0 14279.4050    0  389 6641.14330 14279.4050   115%     -  181s
     0     0 14277.8997    0  396 6641.14330 14277.8997   115%     -  182s
     0     0 14277.0578    0  394 6641.14330 14277.0578   115%     -  182s
     0     0 14272.4438    0  391 6641.14330 14272.4438   115%     -  185s
     0     0 14270.4695    0  403 6641.14330 14270.4695   115%     -  187s
     0     0 14269.9957    0  406 6641.14330 14269.9957   115%     -  188s
     0     0 14266.7783    0  390 6641.14330 14266.7783   115%     -  190s
     0     0 14263.6836    0  440 6641.14330 14263.6836   115%     -  191s
     0     0 14263.0527    0  394 6641.14330 14263.0527   115%     -  191s
     0     0 14258.4605    0  447 6641.14330 14258.4605   115%     -  194s
     0     0 14257.9843    0  447 6641.14330 14257.9843   115%     -  196s
     0     2 14257.5523    0  447 6641.14330 14257.5523   115%     -  222s
     1     4 14104.6558    1  423 6641.14330 14257.5146   115%  2303  228s
     3     8 13922.6490    2  452 6641.14330 14103.7415   112%  5010  233s
     7    16 13758.6482    3  460 6641.14330 14014.5086   111%  4240  240s
    15    32 13584.1496    4  458 6641.14330 13753.7438   107%  5144  248s
    31    50 9079.43626    5  180 6641.14330 13584.0462   105%  7462  264s
    49    82 11479.3189    6  411 6641.14330 13584.0462   105%  7240  275s
    81   156 11472.5405    7  401 6641.14330 13584.0462   105%  5949  285s
   155   247 11381.8969    8  392 6641.14330 13584.0462   105%  3795  295s
   259   300 11088.2906    9  359 6641.14330 13584.0462   105%  2961  302s
   348   333 11034.6915   12  346 6641.14330 13584.0462   105%  2598  313s
   422   356 11060.3934   12  277 6641.14330 13584.0462   105%  2463  323s
   473   399 10396.5296   13  310 6641.14330 13584.0462   105%  2451  330s
   533   421 10415.5368   13  308 6641.14330 13584.0462   105%  2445  338s
   588   458 9663.05637   13  327 6641.14330 13584.0462   105%  2441  347s
   652   486 10269.6443   14  309 6641.14330 13584.0462   105%  2421  356s
   703   519 10290.4705   14  306 6641.14330 13584.0462   105%  2385  366s
   766   537 9643.88044   13  271 6641.14330 13584.0462   105%  2363  376s
   807   568 9724.35562   14  304 6641.14330 13584.0462   105%  2368  386s
   872   592 7082.91941   15  315 6641.14330 13584.0462   105%  2352  395s
   918   636     cutoff   15      6641.14330 13584.0462   105%  2365  404s
   980   661 8334.18092   14  263 6641.14330 13279.0709   100%  2346  412s
  1018   688 6812.19207   14  278 6641.14330 13279.0709   100%  2364  420s
  1075   717 7323.42094   15  257 6641.14330 13279.0709   100%  2327  431s
  1131   745 7000.01449   16  313 6641.14330 13279.0709   100%  2312  442s
  1222   782 11044.2535   11  327 6641.14330 12896.6232  94.2%  2246  452s
  1281   819 10496.6448   12  308 6641.14330 12896.6232  94.2%  2243  461s
  1364   858 10377.6253   13  231 6641.14330 12896.6232  94.2%  2204  471s
  1443   906 8636.69505   16  199 6641.14330 12896.6232  94.2%  2180  482s
  1539   980 8467.82805   19  201 6641.14330 12658.0189  90.6%  2136  492s
  1654  1031 8078.39389   24  171 6641.14330 12610.6259  89.9%  2071  503s
  1807  1084 7754.81402   28  213 6641.14330 12483.3751  88.0%  2021  513s
  1917  1135 6935.28865   32  191 6641.14330 12483.3751  88.0%  2003  527s
  2025  1178 10083.9698   11  326 6641.14330 12483.3751  88.0%  2007  540s
  2154  1204 7924.81705   14  294 6641.14330 12316.1728  85.5%  1995  553s
  2244  1238 7751.20649   15  207 6641.14330 12161.3343  83.1%  2013  567s
  2372  1285 10568.1392   10  389 6641.14330 12131.6622  82.7%  2024  581s
  2508  1339 9833.24733   12  379 6641.14330 11998.6235  80.7%  2020  596s
  2635  1403 8322.46407   14  334 6641.14330 11998.6235  80.7%  2033  611s
  2789  1462     cutoff   20      6641.14330 11998.6235  80.7%  2028  624s
  2926  1553     cutoff   20      6641.14330 11998.6235  80.7%  2032  637s
  3101  1622 7673.43675   10  233 6641.14330 11998.6235  80.7%  2031  652s
  3260  1681 7539.90429   11  263 6641.14330 11998.6235  80.7%  2033  670s
  3450  1765     cutoff    8      6641.14330 11643.6611  75.3%  2018  688s
  3659  1813 10602.6856    6  259 6641.14330 11511.1307  73.3%  2009  705s
  3816  1840 8755.58932    7  140 6641.14330 11478.9500  72.8%  2020  724s
  4010  1905     cutoff    9      6641.14330 11399.6060  71.7%  2034  745s
  4212  1996 7336.23808   10  106 6641.14330 11152.0087  67.9%  2040  762s
  4464  2066 9641.73770   20  237 6641.14330 11088.1418  67.0%  2027  783s
  4720  2158 7977.40590   25  262 6641.14330 11079.1251  66.8%  2015  803s
  4969  2221 7287.00742   30  179 6641.14330 10944.1422  64.8%  2015  825s
  5221  2285 9873.72915   11  217 6641.14330 10931.1094  64.6%  2013  850s
  5493  2364 7450.10591   11   93 6641.14330 10828.5682  63.1%  2012  873s
  5817  2409 7251.23672   15  164 6641.14330 10733.3009  61.6%  1996  894s
  5987  2504 7199.55049   16  145 6641.14330 10728.7427  61.5%  1996  915s
  6309  2505 7632.92417   37  447 6641.14330 10644.3353  60.3%  1978  954s
  6311  2506 7302.65949   33  232 6641.14330 10644.3353  60.3%  1977  983s
  6312  2507 7338.47062   27  397 6641.14330 10644.3353  60.3%  1977 1001s
  6313  2508 8685.93889   21  338 6641.14330 10644.3353  60.3%  1976 1009s
  6314  2508 7476.09294   14  351 6641.14330 10644.3353  60.3%  1976 1016s
  6315  2509 9061.78459   16  467 6641.14330 10644.3353  60.3%  1976 1024s
  6316  2510 8801.98702   17  374 6641.14330 10644.3353  60.3%  1976 1028s
  6317  2510 8779.94003   19  421 6641.14330 10644.3353  60.3%  1975 1034s
  6318  2511 7766.10754   22  381 6641.14330 10644.3353  60.3%  1975 1037s
  6320  2512 7277.80336   27  482 6641.14330 10644.3353  60.3%  1974 1041s
  6322  2514 6911.29837   37  393 6641.14330 10644.3353  60.3%  1974 1045s
  6323  2514 7853.82156   23  468 6641.14330 10644.3353  60.3%  1973 1050s
  6326  2516 9995.92674   15  445 6641.14330 10644.3353  60.3%  1972 1058s
  6327  2517 7933.50671   13  437 6641.14330 10644.3353  60.3%  1972 1060s
  6329  2518 7364.04555   18  497 6641.14330 10644.3353  60.3%  1971 1066s
  6330  2519 7842.65922   14  431 6641.14330 10644.3353  60.3%  1971 1070s
  6332  2520 7788.30582   30  465 6641.14330 10644.3353  60.3%  1971 1080s
  6334  2522 8641.96492   16  489 6641.14330 10644.3353  60.3%  1970 1086s
  6336  2523 8530.54522    8  529 6641.14330 10644.3353  60.3%  1969 1093s
  6337  2524 8658.89854    7  529 6641.14330 10644.3353  60.3%  1969 1120s
  6338  2524 8329.52156   15  529 6641.14330 10644.3353  60.3%  1969 1141s
  6339  2528 10644.3353   13  519 6641.14330 10644.3353  60.3%  1991 1153s
  6341  2531 10644.3353   14  522 6641.14330 10644.3353  60.3%  1992 1164s
  6345  2538 10644.3353   15  326 6641.14330 10644.3353  60.3%  1994 1181s
  6353  2546 10644.3353   16  393 6641.14330 10644.3353  60.3%  2002 1190s
  6369  2550     cutoff   17      6641.14330 10644.3353  60.3%  2020 1212s
  6381  2572 10644.3353   18  251 6641.14330 10644.3353  60.3%  2028 1236s
  6413  2611     cutoff   19      6641.14330 10644.3353  60.3%  2058 1256s
  6505  2598 9183.92106   21  312 6641.14330 10644.3353  60.3%  2123 1265s
  6547  2608 9017.90097   22  304 6641.14330 10644.3353  60.3%  2134 1275s
  6597  2612 8368.29664   24  293 6641.14330 10644.3353  60.3%  2142 1284s
  6646  2623 8101.80016   25  356 6641.14330 10644.3353  60.3%  2153 1297s
  6720  2627 7690.68671   27  282 6641.14330 10644.3353  60.3%  2152 1309s
  6779  2623 7674.21929   29  333 6641.14330 10644.3353  60.3%  2153 1323s
  6855  2604 7262.85853   32  310 6641.14330 10644.3353  60.3%  2153 1334s
  6927  2582 6888.40072   35  264 6641.14330 10644.3353  60.3%  2158 1346s
  6993  2565 8144.37937   21  286 6641.14330 10644.3353  60.3%  2165 1356s
  7058  2548 8099.00215   22  311 6641.14330 10644.3353  60.3%  2168 1368s
  7128  2519 7700.98445   24  204 6641.14330 10644.3353  60.3%  2172 1379s
  7200  2523 7586.83429   26  195 6641.14330 10644.3353  60.3%  2176 1389s
  7279  2503 7165.22953   30  232 6641.14330 10644.3353  60.3%  2177 1397s
  7360  2483 6809.68739   33  114 6641.14330 10644.3353  60.3%  2178 1408s
  7428  2470 7649.50532   24   68 6641.14330 10644.3353  60.3%  2183 1420s
  7500  2435 6997.62615   25   17 6641.14330 10644.3353  60.3%  2185 1431s
  7608  2391     cutoff   27      6641.14330 10124.2115  52.4%  2185 1442s
  7708  2360 6995.63876   22  361 6641.14330 10124.2115  52.4%  2185 1453s
  7834  2300     cutoff   26      6641.14330 10124.2115  52.4%  2179 1465s
  7960  2235     cutoff   25      6641.14330 9911.23701  49.2%  2178 1476s
  8103  2144     cutoff   25      6641.14330 9478.66507  42.7%  2175 1487s
  8237  2022 7870.66511   26  261 6641.14330 9478.66507  42.7%  2167 1499s
  8402  1923     cutoff   31      6641.14330 8777.63034  32.2%  2156 1509s
  8546  1824     cutoff   28      6641.14330 8400.10149  26.5%  2140 1520s
  8684  1745     cutoff   30      6641.14330 8400.10149  26.5%  2122 1527s

Cutting planes:
  MIR: 308
  Mixing: 1
  Flow cover: 890
  RLT: 22
  Relax-and-lift: 58

Explored 8761 nodes (18690731 simplex iterations) in 1528.31 seconds (2869.81 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6641.14 6640.01 6110.14 ... 3657.09

Optimal solution found (tolerance 1.00e-04)
Best objective 6.641143297545e+03, best bound 6.641143297545e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1528.34s
  Master Objective (UB) = 6641.14, θ = 135976.57
  Upper Bound (UB) = 6641.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135976.57
  [DEBUG]   ✓ Scenario 0: θ = 135976.57 ≤ Q = 135976.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135976.57 ≤ Q = 135976.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135976.57 ≤ Q = 135976.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135976.57 ≤ Q = 135976.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135976.57 ≤ Q = 135976.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135976.57 ≤ Q = 135976.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135976.57 ≤ Q = 135976.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2df2f5be
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd20d0a42
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.472150e+13
Presolve removed 2649 rows and 1942 columns
Presolve time: 0.01s
Presolved: 444 rows, 447 columns, 1251 nonzeros
Found heuristic solution: objective 6518713.6976
Variable types: 303 continuous, 144 integer (144 binary)

Root relaxation: objective -1.367107e+05, 233 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136710.72    0  128 6518713.70 -136710.72   102%     -    0s
H    0     0                    -105546.6504 -136710.72  29.5%     -    0s
H    0     0                    -106226.2487 -136710.72  28.7%     -    0s
     0     0 -115922.46    0   25 -106226.25 -115922.46  9.13%     -    0s
H    0     0                    -107817.5103 -115904.66  7.50%     -    0s
H    0     0                    -108064.3853 -115904.66  7.26%     -    0s
H    0     0                    -115529.6486 -115904.66  0.32%     -    0s
     0     0 -115868.42    0   17 -115529.65 -115868.42  0.29%     -    0s
     0     0 -115840.34    0   14 -115529.65 -115840.34  0.27%     -    0s
     0     0 -115833.67    0   13 -115529.65 -115833.67  0.26%     -    0s
     0     0 -115809.04    0   15 -115529.65 -115809.04  0.24%     -    0s
     0     0 -115807.37    0   13 -115529.65 -115807.37  0.24%     -    0s
     0     0 -115758.54    0    4 -115529.65 -115758.54  0.20%     -    0s
H    0     0                    -115627.1293 -115758.54  0.11%     -    0s
H    0     0                    -115649.9908 -115758.54  0.09%     -    0s
     0     0 -115758.54    0   13 -115649.99 -115758.54  0.09%     -    0s
H    0     0                    -115666.6580 -115758.54  0.08%     -    0s
     0     0 -115753.46    0    4 -115666.66 -115753.46  0.08%     -    0s
H    0     0                    -115727.7399 -115738.50  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 5
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (494 simplex iterations) in 0.06 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -115728 -115667 -115650 ... 6.51871e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.157277398681e+05, best bound -1.157384994023e+05, gap 0.0093%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 127656.81
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115727.74
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -115727.74 = 127656.81
  [DEBUG]   Current θ from Master = 135976.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8319.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1678.62
  Lower Bound (LB) = 4757.54
  Gap (UB-LB) = 1883.6052, Absolute Gap = 1883.6052, Relative Gap = 0.283627
  Not converged yet (gap = 1883.61 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351175 nonzeros
Model fingerprint: 0x4319cae6
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63024 rows and 25584 columns
Presolve time: 2.53s
Presolved: 60679 rows, 26596 columns, 376959 nonzeros
Variable types: 24337 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60679 rows, 26596 columns, 376959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25945   -1.5547448e+05   0.000000e+00   7.158195e+08      5s
   39350   -1.7168362e+04   0.000000e+00   8.303327e+07     10s
   46560    8.9762315e+03   0.000000e+00   2.214048e+08     15s
   53750    1.4655558e+04   0.000000e+00   2.881927e+07     20s
   59197    1.5268311e+04   0.000000e+00   5.217929e+07     25s
Concurrent spin time: 3.02s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.612131e+04, 42324 iterations, 28.15 seconds (38.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26121.3069    0  242 -170236.42 26121.3069   115%     -   31s
H    0     0                    -157013.8541 26121.3069   117%     -   31s
H    0     0                    -126120.5554 26121.3069   121%     -   31s
H    0     0                    -118564.5912 26121.3069   122%     -   31s
H    0     0                    -83025.92335 26121.3069   131%     -   31s
H    0     0                    -70907.18197 26121.3069   137%     -   32s
H    0     0                    -53658.25086 26121.3069   149%     -   32s
H    0     0                    -42911.89250 26121.3069   161%     -   32s
H    0     0                    -42772.12548 26121.3069   161%     -   32s
H    0     0                    -38446.11779 26121.3069   168%     -   32s
H    0     0                    -36386.63064 26121.3069   172%     -   33s
H    0     0                    -31118.72773 26121.3069   184%     -   33s
H    0     0                    -21047.40409 26121.3069   224%     -   33s
H    0     0                    -18343.78472 26121.3069   242%     -   33s
H    0     0                    -17495.09469 26121.3069   249%     -   33s
H    0     0                    -15782.44640 22073.6661   240%     -   45s
     0     0 22073.6661    0  249 -15782.446 22073.6661   240%     -   45s
H    0     0                    -15230.53488 22073.3258   245%     -   46s
     0     0 21960.7258    0  249 -15230.535 21960.7258   244%     -   47s
     0     0 21960.7258    0  247 -15230.535 21960.7258   244%     -   48s
     0     0 21951.7405    0  251 -15230.535 21951.7405   244%     -   49s
     0     0 21935.1669    0  259 -15230.535 21935.1669   244%     -   50s
     0     0 21935.0360    0  259 -15230.535 21935.0360   244%     -   51s
     0     0 21885.4407    0  257 -15230.535 21885.4407   244%     -   53s
     0     0 21885.4407    0  257 -15230.535 21885.4407   244%     -   53s
H    0     0                    -10033.39994 18955.8811   289%     -   67s
H    0     0                    -9994.540515 18955.8811   290%     -   67s
H    0     0                    -9700.219964 18955.8811   295%     -   67s
H    0     0                    -9647.425054 18955.8811   296%     -   67s
     0     0 18954.4805    0  274 -9647.4251 18954.4805   296%     -   68s
H    0     0                    -7194.973669 18954.4805   363%     -   68s
     0     0 18289.2577    0  319 -7194.9737 18289.2577   354%     -   76s
     0     0 18112.7283    0  326 -7194.9737 18112.7283   352%     -   81s
     0     0 18050.7546    0  329 -7194.9737 18050.7546   351%     -   83s
     0     0 18039.9073    0  328 -7194.9737 18039.9073   351%     -   84s
     0     0 17992.0540    0  323 -7194.9737 17992.0540   350%     -   87s
     0     0 17944.8532    0  325 -7194.9737 17944.8532   349%     -   91s
     0     0 17941.4024    0  321 -7194.9737 17941.4024   349%     -   91s
H    0     0                    -6232.795631 17940.3013   388%     -   92s
     0     0 17940.3013    0  327 -6232.7956 17940.3013   388%     -   92s
     0     0 17938.6703    0  327 -6232.7956 17938.6703   388%     -   92s
     0     0 17938.4809    0  327 -6232.7956 17938.4809   388%     -   92s
H    0     0                    -4856.927729 17938.4809   469%     -   99s
H    0     0                    2332.0833470 16972.7363   628%     -  113s
H    0     0                    2346.5917576 16972.7363   623%     -  113s
H    0     0                    2374.1379187 16972.7363   615%     -  113s
H    0     0                    2735.9024932 16972.7363   520%     -  113s
H    0     0                    3094.4687032 16972.7363   448%     -  113s
     0     0 16972.7363    0  333 3094.46870 16972.7363   448%     -  113s
H    0     0                    5809.6197106 16972.2153   192%     -  113s
H    0     0                    5929.8724500 16972.2153   186%     -  113s
     0     0 16540.9413    0  334 5929.87245 16540.9413   179%     -  121s
     0     0 16248.6365    0  332 5929.87245 16248.6365   174%     -  126s
     0     0 16210.1325    0  337 5929.87245 16210.1325   173%     -  129s
     0     0 16172.0272    0  343 5929.87245 16172.0272   173%     -  132s
     0     0 16123.0546    0  346 5929.87245 16123.0546   172%     -  135s
     0     0 16106.5926    0  349 5929.87245 16106.5926   172%     -  137s
     0     0 16100.2857    0  343 5929.87245 16100.2857   172%     -  138s
     0     0 16088.7974    0  349 5929.87245 16088.7974   171%     -  139s
     0     0 16080.0108    0  353 5929.87245 16080.0108   171%     -  140s
     0     0 16076.3011    0  357 5929.87245 16076.3011   171%     -  141s
     0     0 16075.8105    0  357 5929.87245 16075.8105   171%     -  141s
     0     0 15538.2979    0  363 5929.87245 15538.2979   162%     -  157s
     0     0 15267.0886    0  350 5929.87245 15267.0886   157%     -  165s
     0     0 15194.6538    0  366 5929.87245 15194.6538   156%     -  169s
     0     0 15145.4064    0  368 5929.87245 15145.4064   155%     -  173s
     0     0 15061.3408    0  367 5929.87245 15061.3408   154%     -  176s
     0     0 15055.1504    0  371 5929.87245 15055.1504   154%     -  176s
     0     0 15050.1801    0  372 5929.87245 15050.1801   154%     -  177s
     0     0 15047.2220    0  377 5929.87245 15047.2220   154%     -  178s
     0     0 15046.2712    0  376 5929.87245 15046.2712   154%     -  179s
H    0     0                    6073.5548147 14807.1828   144%     -  187s
H    0     0                    6091.8314313 14807.1828   143%     -  187s
     0     0 14807.1828    0  412 6091.83143 14807.1828   143%     -  187s
H    0     0                    6254.1926925 14807.1826   137%     -  187s
     0     0 14729.4965    0  414 6254.19269 14729.4965   136%     -  192s
     0     0 14711.5496    0  367 6254.19269 14711.5496   135%     -  194s
     0     0 14691.6843    0  414 6254.19269 14691.6843   135%     -  196s
     0     0 14686.7571    0  365 6254.19269 14686.7571   135%     -  197s
     0     0 14685.9873    0  361 6254.19269 14685.9873   135%     -  198s
     0     0 14629.2453    0  415 6254.19269 14629.2453   134%     -  202s
     0     0 14598.1426    0  430 6254.19269 14598.1426   133%     -  208s
     0     0 14584.0472    0  420 6254.19269 14584.0472   133%     -  210s
     0     0 14579.0744    0  430 6254.19269 14579.0744   133%     -  212s
     0     0 14573.3665    0  473 6254.19269 14573.3665   133%     -  214s
     0     0 14569.0067    0  433 6254.19269 14569.0067   133%     -  215s
     0     0 14568.1937    0  435 6254.19269 14568.1937   133%     -  215s
     0     0 14507.8362    0  389 6254.19269 14507.8362   132%     -  219s
     0     0 14480.7573    0  389 6254.19269 14480.7573   132%     -  221s
     0     0 14472.4652    0  387 6254.19269 14472.4652   131%     -  223s
     0     0 14469.8429    0  377 6254.19269 14469.8429   131%     -  224s
     0     0 14467.7304    0  381 6254.19269 14467.7304   131%     -  225s
     0     0 14464.9826    0  393 6254.19269 14464.9826   131%     -  225s
     0     0 14461.3494    0  392 6254.19269 14461.3494   131%     -  226s
     0     0 14458.7075    0  393 6254.19269 14458.7075   131%     -  227s
     0     0 14456.5117    0  395 6254.19269 14456.5117   131%     -  228s
     0     0 14455.0498    0  393 6254.19269 14455.0498   131%     -  228s
     0     0 14454.4311    0  398 6254.19269 14454.4311   131%     -  228s
     0     0 14430.1487    0  398 6254.19269 14430.1487   131%     -  231s
     0     0 14421.9010    0  394 6254.19269 14421.9010   131%     -  233s
     0     0 14414.8347    0  402 6254.19269 14414.8347   130%     -  234s
     0     0 14412.2160    0  397 6254.19269 14412.2160   130%     -  235s
     0     0 14410.0189    0  398 6254.19269 14410.0189   130%     -  235s
     0     0 14409.8529    0  402 6254.19269 14409.8529   130%     -  236s
     0     0 14392.6360    0  399 6254.19269 14392.6360   130%     -  239s
     0     0 14388.4728    0  404 6254.19269 14388.4728   130%     -  240s
     0     0 14387.3165    0  405 6254.19269 14387.3165   130%     -  241s
     0     0 14380.7579    0  403 6254.19269 14380.7579   130%     -  243s
     0     0 14378.0087    0  406 6254.19269 14378.0087   130%     -  245s
     0     0 14377.1099    0  407 6254.19269 14377.1099   130%     -  245s
     0     0 14366.3096    0  452 6254.19269 14366.3096   130%     -  248s
     0     0 14361.1769    0  454 6254.19269 14361.1769   130%     -  250s
     0     0 14359.8416    0  453 6254.19269 14359.8416   130%     -  250s
H    0     0                    6270.9608091 14354.9672   129%     -  253s
     0     0 14354.9672    0  502 6270.96081 14354.9672   129%     -  253s
H    0     0                    6308.8127095 14354.8726   128%     -  259s
     0     0 14350.0058    0  449 6308.81271 14350.0058   127%     -  261s
     0     0 14349.2484    0  403 6308.81271 14349.2484   127%     -  262s
     0     0 14344.7837    0  502 6308.81271 14344.7837   127%     -  264s
H    0     0                    6475.9539396 14344.7257   122%     -  265s
     0     0 14339.5009    0  456 6475.95394 14339.5009   121%     -  266s
     0     0 14334.1757    0  460 6475.95394 14334.1757   121%     -  267s
     0     0 14331.8240    0  466 6475.95394 14331.8240   121%     -  268s
     0     0 14331.2639    0  466 6475.95394 14331.2639   121%     -  268s
     0     0 14328.0741    0  461 6475.95394 14328.0741   121%     -  270s
     0     0 14324.6736    0  464 6475.95394 14324.6736   121%     -  271s
     0     0 14322.7976    0  463 6475.95394 14322.7976   121%     -  272s
     0     0 14322.2306    0  464 6475.95394 14322.2306   121%     -  272s
     0     0 14319.9447    0  466 6475.95394 14319.9447   121%     -  274s
     0     0 14319.0192    0  467 6475.95394 14319.0192   121%     -  275s
     0     0 14316.6230    0  461 6475.95394 14316.6230   121%     -  277s
     0     0 14313.4022    0  464 6475.95394 14313.4022   121%     -  279s
     0     0 14312.8225    0  463 6475.95394 14312.8225   121%     -  280s
     0     0 14303.8867    0  466 6475.95394 14303.8867   121%     -  283s
     0     0 14303.8544    0  466 6475.95394 14303.8544   121%     -  284s
H    0     0                    6512.9239211 14303.7621   120%     -  325s
H    0     0                    6587.1231956 14303.7621   117%     -  325s
     0     2 14303.7621    0  466 6587.12320 14303.7621   117%     -  331s
     1     4 14214.2990    1  449 6587.12320 14303.7621   117%  3286  339s
     3     8 14076.8694    2  423 6587.12320 14213.6673   116%  6034  345s
     7    16 13946.6174    3  440 6587.12320 14098.3248   114%  5238  356s
    15    32 13851.6895    4  449 6587.12320 13946.3334   112%  7090  366s
    31    48 13510.2031    5  460 6587.12320 13851.3856   110%  8427  385s
    47    80 12595.0023    6  319 6587.12320 13851.3856   110%  9296  399s
    79   156 12537.3394    7  366 6587.12320 13851.3856   110%  7366  428s
   155   200 12461.0967    9  359 6587.12320 13851.3856   110%  5166  437s
   206   259 12487.1200    9  306 6587.12320 13851.3856   110%  4212  451s
   282   294 8685.82353    8  161 6587.12320 13851.3856   110%  4042  466s
   323   310 11302.9699   10  322 6587.12320 13851.3856   110%  3951  488s
   388   346 12430.1435   10  350 6587.12320 13851.3856   110%  3850  506s
   450   370 10650.5914   10  258 6587.12320 13851.3856   110%  3857  518s
   518   402 10396.1652   11  238 6587.12320 13851.3856   110%  3867  533s
   572   442 10658.8299   11  280 6587.12320 13807.6920   110%  3907  545s
   630   474 10909.8640   11  250 6587.12320 13807.6920   110%  3919  559s
   688   496 10079.1643   12  259 6587.12320 13807.6920   110%  3952  573s
   754   526 10068.3622   12  251 6587.12320 13807.6920   110%  3964  587s
   818   562 9568.06320   13  256 6587.12320 13807.6920   110%  3983  599s
   892   583 8334.43076   13  326 6587.12320 13807.6920   110%  3942  613s
   967   596 9466.85582   14  251 6587.12320 13807.6920   110%  3866  626s
  1036   625 9454.45263   15  248 6587.12320 13807.6920   110%  3842  640s
  1103   671 9102.42385   16  193 6587.12320 13807.6920   110%  3918  654s
  1175   694 8927.36595   19  297 6587.12320 13669.0290   108%  3958  668s
  1261   740 8840.68711   21  183 6587.12320 13669.0290   108%  3944  684s
  1339   773 8683.68641   24  231 6587.12320 13669.0290   108%  3949  698s
  1418   806 8427.93410   26  168 6587.12320 13669.0290   108%  3930  714s
  1499   824     cutoff   26      6587.12320 12939.8204  96.4%  3942  730s
  1569   860 7593.59407   32  205 6587.12320 12939.8204  96.4%  3981  746s
  1649   876 infeasible   34      6587.12320 12939.8204  96.4%  4020  764s
  1703   889 6984.56803   35  148 6587.12320 12939.8204  96.4%  4064  782s
  1788   914 6700.80973   40  147 6587.12320 12939.8204  96.4%  4083  799s
  1881   940 10430.9705   13  398 6587.12320 12322.3242  87.1%  4094  818s
  1985   980 7702.32799   15  329 6587.12320 12322.3242  87.1%  4133  836s
  2064  1012 6775.54420   18  307 6587.12320 12322.3242  87.1%  4212  855s
  2152  1057     cutoff   17      6587.12320 12021.4398  82.5%  4282  875s
  2235  1102 11637.0442    6  307 6587.12320 12021.4398  82.5%  4323  896s
  2364  1147 10890.3514    8  243 6587.12320 11895.5986  80.6%  4297  913s
  2466  1184 8618.51098   10  315 6587.12320 11818.6434  79.4%  4315  934s
  2613  1233     cutoff   14      6587.12320 11783.4675  78.9%  4325  953s
  2724  1298 9721.95283   12  318 6587.12320 11783.4675  78.9%  4334  976s
  2888  1341 7983.26864   17  234 6587.12320 11673.7520  77.2%  4253 1001s
  3069  1416 6929.18982   22  210 6587.12320 11632.4799  76.6%  4163 1024s
  3243  1478     cutoff   27      6587.12320 11546.4144  75.3%  4182 1048s
  3459  1541 9053.15066   13  335 6587.12320 11409.5389  73.2%  4164 1070s
  3638  1564 8167.78795   17  164 6587.12320 11409.5389  73.2%  4177 1089s
  3679  1588 8087.99572   18  277 6587.12320 11305.7623  71.6%  4197 1113s
  3735  1635 7643.78487   19  265 6587.12320 11305.7623  71.6%  4207 1138s
  3849  1714 8632.19656    9  184 6587.12320 11305.7623  71.6%  4180 1164s
  4056  1765     cutoff   14      6587.12320 11305.7623  71.6%  4129 1190s
  4261  1831     cutoff   17      6587.12320 11305.7623  71.6%  4151 1222s
  4516  1871 6911.34804   12  273 6587.12320 11305.7623  71.6%  4158 1252s
  4796  1975 10341.4400   11  257 6587.12320 11142.4331  69.2%  4149 1283s
  5090  2080 8164.34714   16  255 6587.12320 10931.2648  65.9%  4139 1319s
  5396  2138 6868.68976   30  141 6587.12320 10890.0431  65.3%  4122 1354s
  5763  2222 7619.60901   14  181 6587.12320 10825.8026  64.3%  4084 1388s
  6129  2295 8939.36964   12  292 6587.12320 10687.4250  62.2%  4056 1424s
  6493  2404     cutoff   19      6587.12320 10638.9051  61.5%  4034 1459s
  6901  2405 7511.46754   24  466 6587.12320 10511.1559  59.6%  3994 1525s
  6903  2406 10386.5113   13  242 6587.12320 10511.1559  59.6%  3993 1560s
  6904  2407 9066.99477   13  396 6587.12320 10511.1559  59.6%  3993 1591s
  6905  2408 8425.44576   16  405 6587.12320 10511.1559  59.6%  3992 1610s
  6906  2408 9465.22105   12  455 6587.12320 10511.1559  59.6%  3991 1619s
  6907  2409 9711.33855   10  405 6587.12320 10511.1559  59.6%  3991 1627s
  6908  2410 6961.90426   14  380 6587.12320 10511.1559  59.6%  3990 1634s
  6909  2410 9835.74419   15  374 6587.12320 10511.1559  59.6%  3990 1637s
  6910  2411 9188.82269    7  474 6587.12320 10511.1559  59.6%  3989 1642s
  6911  2412 8235.42268   18  453 6587.12320 10511.1559  59.6%  3988 1646s
  6912  2412 7486.55308   16  492 6587.12320 10511.1559  59.6%  3988 1650s
  6914  2414 8373.05535   26  484 6587.12320 10511.1559  59.6%  3987 1656s
  6915  2414 8640.20768    9  452 6587.12320 10511.1559  59.6%  3986 1664s
  6916  2415 7510.80382   39  408 6587.12320 10511.1559  59.6%  3986 1668s
  6917  2416 9431.19497   15  465 6587.12320 10511.1559  59.6%  3985 1675s
  6919  2417 7014.15285   25  466 6587.12320 10511.1559  59.6%  3984 1680s
  6920  2418 9257.02565   18  460 6587.12320 10511.1559  59.6%  3983 1687s
  6922  2419 8817.44946   17  412 6587.12320 10511.1559  59.6%  3982 1692s
  6923  2420 8248.31298   29  399 6587.12320 10511.1559  59.6%  3982 1698s
  6924  2420 7089.84678   23  408 6587.12320 10511.1559  59.6%  3981 1702s
  6925  2421 7222.82529   12  416 6587.12320 10511.1559  59.6%  3980 1715s
  6927  2422 7595.59250   20  417 6587.12320 10511.1559  59.6%  3979 1725s
  6929  2424 8274.69122   25  444 6587.12320 10511.1559  59.6%  3978 1734s
  6930  2424 8749.52855   16  404 6587.12320 10511.1559  59.6%  3978 1738s
  6931  2425 9953.40123   11  415 6587.12320 10511.1559  59.6%  3977 1743s
  6932  2426 7867.22993   18  415 6587.12320 10511.1559  59.6%  3976 1780s
  6933  2426 7015.56107   26  415 6587.12320 10511.1559  59.6%  3976 1806s
  6934  2430 10511.1559   13  404 6587.12320 10511.1559  59.6%  4001 1816s
  6936  2433 10511.1559   14  428 6587.12320 10511.1559  59.6%  4001 1832s
  6940  2440 10511.1559   15  442 6587.12320 10511.1559  59.6%  4002 1855s
  6948  2453 10511.1559   16  486 6587.12320 10511.1559  59.6%  4007 1873s
  6964  2465 9700.95287   17  269 6587.12320 10511.1559  59.6%  4021 1902s
  6981  2491 10511.1559   18  367 6587.12320 10511.1559  59.6%  4032 1922s
  7013  2512 10511.1559   19  349 6587.12320 10511.1559  59.6%  4047 1938s
  7045  2533 10511.1559   20  405 6587.12320 10511.1559  59.6%  4044 1955s
  7077  2563 10511.1559   21  410 6587.12320 10511.1559  59.6%  4041 1974s
  7128  2605 10511.1559   20  314 6587.12320 10511.1559  59.6%  4036 1995s
  7213  2587 10511.1559   22  348 6587.12320 10511.1559  59.6%  4033 2019s
  7303  2573 10511.1559   21  313 6587.12320 10511.1559  59.6%  4034 2042s
  7377  2544 10278.4310   21  326 6587.12320 10511.1559  59.6%  4046 2060s
  7448  2535 7217.58823   21  290 6587.12320 10511.1559  59.6%  4059 2086s
  7510  2531 7740.00267   22  412 6587.12320 10511.1559  59.6%  4080 2106s
  7583  2536 9820.18635   22  379 6587.12320 10511.1559  59.6%  4091 2123s
  7657  2525 9640.19915   23  318 6587.12320 10511.1559  59.6%  4100 2139s
  7737  2514 8539.48016   24  231 6587.12320 10511.1559  59.6%  4100 2154s
  7815  2501 7965.34082   25  160 6587.12320 10511.1559  59.6%  4104 2170s
  7895  2485 7270.43005   28  146 6587.12320 10511.1559  59.6%  4098 2197s
  7973  2472     cutoff   31      6587.12320 10511.1559  59.6%  4103 2215s
  8030  2488 8481.90376   22  419 6587.12320 10511.1559  59.6%  4120 2233s
  8101  2502     cutoff   25      6587.12320 10511.1559  59.6%  4134 2248s
  8184  2479     cutoff   26      6587.12320 10511.1559  59.6%  4136 2267s
  8282  2461     cutoff   20      6587.12320 10511.1559  59.6%  4139 2287s
  8365  2449 7115.17234   26  209 6587.12320 10511.1559  59.6%  4154 2306s
  8468  2433     cutoff   29      6587.12320 10511.1559  59.6%  4152 2327s
  8564  2413 6935.42338   23  303 6587.12320 10511.1559  59.6%  4166 2347s
  8676  2397 6869.28539   25  346 6587.12320 10511.1559  59.6%  4173 2367s
  8787  2384 8085.75855   22  342 6587.12320 10511.1559  59.6%  4174 2391s
  8911  2351     cutoff   24      6587.12320 10511.1559  59.6%  4160 2416s
  9048  2280     cutoff   26      6587.12320 10348.3587  57.1%  4153 2437s
  9201  2253     cutoff   19      6587.12320 10080.6956  53.0%  4153 2460s
  9346  2220 7687.51928   23  227 6587.12320 9936.80117  50.9%  4150 2483s
  9519  2141 6866.44946   29  232 6587.12320 9936.80117  50.9%  4147 2506s
  9711  2066 7424.02815   21  203 6587.12320 9744.41406  47.9%  4140 2530s
  9922  2001 6908.55887   25  284 6587.12320 9494.99864  44.1%  4128 2559s
 10120  1901     cutoff   27      6587.12320 9367.65335  42.2%  4121 2587s
 10361  1772     cutoff   27      6587.12320 9367.65335  42.2%  4110 2614s
 10591  1643 7685.33225   28  281 6587.12320 9168.44169  39.2%  4100 2642s
 10892  1377 7156.59216   25  160 6587.12320 9168.44169  39.2%  4068 2670s
 11258  1026 7010.01245   29  406 6587.12320 8271.63539  25.6%  4015 2692s
 11621   864 7115.17298   26  216 6587.12320 7914.00614  20.1%  3935 2701s

Cutting planes:
  MIR: 426
  Mixing: 2
  Flow cover: 980
  RLT: 15
  Relax-and-lift: 95

Explored 11682 nodes (46102716 simplex iterations) in 2702.02 seconds (5293.37 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6587.12 6512.92 6475.95 ... 5809.62

Optimal solution found (tolerance 1.00e-04)
Best objective 6.587123195607e+03, best bound 6.587123195607e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2702.03s
  Master Objective (UB) = 6587.12, θ = 136358.19
  Upper Bound (UB) = 6587.12

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 136358.19
  [DEBUG]   ✓ Scenario 0: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 136358.19 ≤ Q = 136358.19 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3a2674ed
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc5d98b13
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.482083e+13
Presolve removed 2649 rows and 1942 columns
Presolve time: 0.01s
Presolved: 444 rows, 447 columns, 1251 nonzeros
Found heuristic solution: objective 6564642.6802
Variable types: 303 continuous, 144 integer (144 binary)

Root relaxation: objective -1.343365e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134336.55    0  123 6564642.68 -134336.55   102%     -    0s
H    0     0                    -105658.7728 -134336.55  27.1%     -    0s
H    0     0                    -105811.9339 -134336.55  27.0%     -    0s
     0     0 -116439.76    0   74 -105811.93 -116439.76  10.0%     -    0s
H    0     0                    -113610.6120 -116336.65  2.40%     -    0s
H    0     0                    -114525.5232 -116336.65  1.58%     -    0s
     0     0 -115649.97    0   76 -114525.52 -115649.97  0.98%     -    0s
     0     0 -114993.16    0   41 -114525.52 -114993.16  0.41%     -    0s
     0     0 -114985.56    0   40 -114525.52 -114985.56  0.40%     -    0s
     0     0 -114977.68    0   39 -114525.52 -114977.68  0.39%     -    0s
     0     0 -114910.16    0   57 -114525.52 -114910.16  0.34%     -    0s
     0     0 -114902.84    0   55 -114525.52 -114902.84  0.33%     -    0s
     0     0 -114899.21    0   54 -114525.52 -114899.21  0.33%     -    0s
     0     0 -114842.52    0   47 -114525.52 -114842.52  0.28%     -    0s
     0     0 -114823.39    0   36 -114525.52 -114823.39  0.26%     -    0s
     0     0 -114816.26    0   34 -114525.52 -114816.26  0.25%     -    0s
H    0     0                    -114528.0252 -114786.24  0.23%     -    0s
H    0     0                    -114570.3729 -114786.24  0.19%     -    0s
     0     0 -114786.24    0   37 -114570.37 -114786.24  0.19%     -    0s
     0     0 -114780.40    0   35 -114570.37 -114780.40  0.18%     -    0s
     0     0 -114774.83    0   35 -114570.37 -114774.83  0.18%     -    0s
     0     0 -114653.40    0   12 -114570.37 -114653.40  0.07%     -    0s
     0     0 -114586.65    0    7 -114570.37 -114586.65  0.01%     -    0s
     0     0          -    0      -114570.37 -114581.56  0.01%     -    0s

Explored 1 nodes (710 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -114570 -114528 -114526 ... 1.48208e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.145703728818e+05, best bound -1.145815588522e+05, gap 0.0098%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 128814.17
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114570.37
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -114570.37 = 128814.17
  [DEBUG]   Current θ from Master = 136358.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7544.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -956.90
  Lower Bound (LB) = 4757.54
  Gap (UB-LB) = 1829.5851, Absolute Gap = 1829.5851, Relative Gap = 0.277752
  Not converged yet (gap = 1829.59 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394382 nonzeros
Model fingerprint: 0x0c23a8a1
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70902 rows and 28782 columns
Presolve time: 3.52s
Presolved: 68091 rows, 29638 columns, 423389 nonzeros
Variable types: 27379 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68091 rows, 29638 columns, 423389 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   10965   -2.4347860e+05   0.000000e+00   4.520910e+06      5s
   29966   -9.8435889e+04   0.000000e+00   3.715299e+07     10s
   39249   -1.2435582e+04   0.000000e+00   4.943891e+07     15s
   47002   -1.9997747e+03   0.000000e+00   1.610452e+07     20s
   53666    3.1762127e+02   0.000000e+00   1.151125e+08     25s
   59469    1.4488054e+03   0.000000e+00   3.290765e+07     30s
   65183    5.0196049e+03   0.000000e+00   2.206905e+07     35s
   70942    6.6375721e+03   0.000000e+00   3.467610e+06     40s
   76093    8.3830133e+03   0.000000e+00   1.655443e+07     45s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 2.594841e+04, 50399 iterations, 43.07 seconds (58.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 25948.4128    0  235 -170236.42 25948.4128   115%     -   47s
H    0     0                    -158697.7831 25948.4128   116%     -   47s
H    0     0                    -48952.78966 25948.4128   153%     -   47s
H    0     0                    -35824.13830 25948.4128   172%     -   47s
H    0     0                    -34166.31579 25948.4128   176%     -   48s
H    0     0                    -30610.07594 25948.4128   185%     -   50s
H    0     0                    -30582.07814 25948.4128   185%     -   50s
     0     0 21058.2787    0  260 -30582.078 21058.2787   169%     -   64s
H    0     0                    -29394.11070 21057.7311   172%     -   65s
     0     0 20902.9254    0  263 -29394.111 20902.9254   171%     -   68s
     0     0 20890.8159    0  262 -29394.111 20890.8159   171%     -   69s
     0     0 20856.8614    0  267 -29394.111 20856.8614   171%     -   71s
     0     0 20848.8659    0  267 -29394.111 20848.8659   171%     -   72s
     0     0 20817.7450    0  272 -29394.111 20817.7450   171%     -   74s
     0     0 20790.5030    0  273 -29394.111 20790.5030   171%     -   75s
     0     0 20693.9631    0  269 -29394.111 20693.9631   170%     -   80s
     0     0 20693.9631    0  271 -29394.111 20693.9631   170%     -   81s
     0     0 20693.9631    0  271 -29394.111 20693.9631   170%     -   81s
     0     0 18220.7522    0  357 -29394.111 18220.7522   162%     -   97s
H    0     0                    -28107.99853 18220.7522   165%     -   97s
H    0     0                    -28096.84049 18220.7522   165%     -   97s
H    0     0                    -22773.77223 18220.7522   180%     -   97s
H    0     0                    -20864.18365 18220.7522   187%     -   97s
     0     0 17944.6843    0  371 -20864.184 17944.6843   186%     -  105s
     0     0 17841.6433    0  383 -20864.184 17841.6433   186%     -  109s
     0     0 17777.1295    0  378 -20864.184 17777.1295   185%     -  112s
     0     0 17735.7296    0  381 -20864.184 17735.7296   185%     -  116s
     0     0 17731.5560    0  382 -20864.184 17731.5560   185%     -  117s
H    0     0                    -9813.838453 17726.8274   281%     -  118s
     0     0 17726.8274    0  385 -9813.8385 17726.8274   281%     -  118s
     0     0 17723.3516    0  388 -9813.8385 17723.3516   281%     -  120s
H    0     0                    -9534.398812 17689.9045   286%     -  123s
     0     0 17689.9045    0  385 -9534.3988 17689.9045   286%     -  123s
     0     0 17662.4814    0  389 -9534.3988 17662.4814   285%     -  126s
     0     0 17656.2615    0  385 -9534.3988 17656.2615   285%     -  127s
     0     0 17655.8710    0  385 -9534.3988 17655.8710   285%     -  127s
     0     0 16344.0800    0  340 -9534.3988 16344.0800   271%     -  154s
H    0     0                    -5521.152841 16344.0685   396%     -  154s
     0     0 16191.4928    0  348 -5521.1528 16191.4928   393%     -  161s
     0     0 16092.0642    0  349 -5521.1528 16092.0642   391%     -  166s
     0     0 15957.1422    0  350 -5521.1528 15957.1422   389%     -  174s
     0     0 15923.4384    0  361 -5521.1528 15923.4384   388%     -  176s
     0     0 15858.7739    0  400 -5521.1528 15858.7739   387%     -  180s
H    0     0                    -705.0629303 15836.2087  2346%     -  182s
H    0     0                    -195.2263366 15836.2087  8212%     -  182s
H    0     0                     855.3738115 15836.2087  1751%     -  182s
H    0     0                    1207.9308746 15836.2087  1211%     -  182s
H    0     0                    1855.5734639 15836.2087   753%     -  182s
H    0     0                    1888.2103307 15836.2087   739%     -  182s
H    0     0                    2256.3253611 15836.2087   602%     -  182s
H    0     0                    2327.9347216 15836.2087   580%     -  182s
H    0     0                    2349.4348738 15836.2087   574%     -  182s
H    0     0                    2411.4156626 15836.2087   557%     -  182s
     0     0 15836.2087    0  351 2411.41566 15836.2087   557%     -  182s
     0     0 15829.6423    0  347 2411.41566 15829.6423   556%     -  183s
     0     0 15826.2070    0  341 2411.41566 15826.2070   556%     -  184s
     0     0 15826.0302    0  343 2411.41566 15826.0302   556%     -  184s
H    0     0                    2427.9882108 15826.0302   552%     -  192s
H    0     0                    2477.1057460 15826.0302   539%     -  192s
H    0     0                    2561.2355772 15826.0302   518%     -  192s
     0     0 15160.6831    0  420 2561.23558 15160.6831   492%     -  203s
H    0     0                    5370.8202650 15160.5558   182%     -  204s
     0     0 14989.6433    0  416 5370.82026 14989.6433   179%     -  210s
     0     0 14938.7472    0  364 5370.82026 14938.7472   178%     -  214s
     0     0 14910.6020    0  368 5370.82026 14910.6020   178%     -  217s
     0     0 14902.8441    0  366 5370.82026 14902.8441   177%     -  219s
     0     0 14899.5504    0  415 5370.82026 14899.5504   177%     -  220s
     0     0 14896.3671    0  419 5370.82026 14896.3671   177%     -  221s
     0     0 14895.4144    0  369 5370.82026 14895.4144   177%     -  222s
     0     0 14861.8293    0  421 5370.82026 14861.8293   177%     -  226s
H    0     0                    6286.5826107 14861.4245   136%     -  226s
     0     0 14846.7559    0  375 6286.58261 14846.7559   136%     -  229s
     0     0 14836.0561    0  373 6286.58261 14836.0561   136%     -  231s
     0     0 14828.4334    0  377 6286.58261 14828.4334   136%     -  234s
     0     0 14819.1976    0  384 6286.58261 14819.1976   136%     -  236s
     0     0 14718.3355    0  428 6286.58261 14718.3355   134%     -  240s
     0     0 14700.9339    0  432 6286.58261 14700.9339   134%     -  242s
     0     0 14695.2873    0  435 6286.58261 14695.2873   134%     -  244s
     0     0 14695.1606    0  434 6286.58261 14695.1606   134%     -  244s
     0     0 14605.2275    0  388 6286.58261 14605.2275   132%     -  252s
H    0     0                    6402.3309207 14604.6497   128%     -  253s
     0     0 14569.3758    0  394 6402.33092 14569.3758   128%     -  258s
     0     0 14544.7618    0  382 6402.33092 14544.7618   127%     -  260s
     0     0 14539.9120    0  381 6402.33092 14539.9120   127%     -  261s
     0     0 14537.7584    0  386 6402.33092 14537.7584   127%     -  262s
     0     0 14535.5128    0  390 6402.33092 14535.5128   127%     -  263s
     0     0 14534.8955    0  392 6402.33092 14534.8955   127%     -  263s
     0     0 14431.1587    0  391 6402.33092 14431.1587   125%     -  269s
     0     0 14410.5900    0  370 6402.33092 14410.5900   125%     -  272s
     0     0 14405.3080    0  378 6402.33092 14405.3080   125%     -  274s
     0     0 14402.7988    0  385 6402.33092 14402.7988   125%     -  274s
     0     0 14402.2877    0  381 6402.33092 14402.2877   125%     -  275s
     0     0 14370.1096    0  397 6402.33092 14370.1096   124%     -  280s
     0     0 14364.0569    0  403 6402.33092 14364.0569   124%     -  282s
     0     0 14361.9939    0  394 6402.33092 14361.9939   124%     -  283s
     0     0 14361.5155    0  395 6402.33092 14361.5155   124%     -  284s
     0     0 14354.3906    0  389 6402.33092 14354.3906   124%     -  286s
     0     0 14352.8036    0  395 6402.33092 14352.8036   124%     -  287s
     0     0 14351.6329    0  398 6402.33092 14351.6329   124%     -  288s
     0     0 14343.3963    0  386 6402.33092 14343.3963   124%     -  292s
     0     0 14341.4112    0  435 6402.33092 14341.4112   124%     -  294s
     0     0 14340.8357    0  436 6402.33092 14340.8357   124%     -  295s
     0     0 14333.4831    0  440 6402.33092 14333.4831   124%     -  297s
     0     0 14329.9785    0  439 6402.33092 14329.9785   124%     -  300s
     0     0 14329.1886    0  445 6402.33092 14329.1886   124%     -  300s
     0     0 14323.3540    0  441 6402.33092 14323.3540   124%     -  303s
     0     0 14322.8472    0  441 6402.33092 14322.8472   124%     -  305s
H    0     0                    6466.0254789 14322.8472   122%     -  351s
H    0     0                    6548.0372684 14322.8472   119%     -  351s
H    0     2                    6579.2976397 14322.8472   118%     -  367s
     0     2 14322.8472    0  441 6579.29764 14322.8472   118%     -  367s
     1     4 14207.3161    1  427 6579.29764 14322.7034   118%  4040  387s
     3     8 13914.3769    2  461 6579.29764 14207.2334   116% 10702  397s
     7    16 13616.1358    3  431 6579.29764 14100.2598   114%  7231  409s
    15    32 13568.3197    4  469 6579.29764 13882.6081   111%  7657  424s
    31    48 11911.8475    5  250 6579.29764 13826.2171   110%  9749  541s
    47    80 11541.6460    6  351 6579.29764 13826.2171   110% 10301  558s
    79   164 10906.3082    7  341 6579.29764 13826.2171   110%  8465  586s
   163   266 10843.3670    9  334 6579.29764 13826.2171   110%  5751  600s
H  172   266                    6585.4190014 13826.2171   110%  5555  600s
   271   316 10311.5505   11  297 6585.41900 13826.2171   110%  4474  611s
   355   342 10736.5776   10  331 6585.41900 13826.2171   110%  4106  625s
   437   374 10130.4086   10  310 6585.41900 13826.2171   110%  3728  638s
   507   383 10228.3192   10  301 6585.41900 13826.2171   110%  3677  651s
   547   420 9518.55425   12  275 6585.41900 13826.2171   110%  3733  670s
   611   463 9326.50060   13  284 6585.41900 13826.2171   110%  3744  683s
   678   503 8604.17001   14  273 6585.41900 13826.2171   110%  3755  692s
   752   509 8546.11659   15  281 6585.41900 13826.2171   110%  3666  705s
   811   522 8042.42525   17  277 6585.41900 13826.2171   110%  3701  718s
   870   568 8196.91079   16  193 6585.41900 13826.2171   110%  3802  728s
   942   615 8192.46197   17  193 6585.41900 13826.2171   110%  3761  741s
  1025   650 8132.50435   18  194 6585.41900 13826.2171   110%  3701  755s
  1104   678 7650.32356   19  258 6585.41900 13826.2171   110%  3675  767s
  1171   711     cutoff   19      6585.41900 13826.2171   110%  3707  782s
  1265   737     cutoff   20      6585.41900 13568.9971   106%  3647  796s
  1345   774 10763.3379    6  272 6585.41900 13568.9971   106%  3697  809s
  1431   842 8824.31096    8  113 6585.41900 13568.9971   106%  3731  823s
  1538   911 8300.14732   10   92 6585.41900 13568.9971   106%  3678  839s
  1669   990 6997.79988   15   62 6585.41900 13568.9971   106%  3578  854s
  1808  1022     cutoff   19      6585.41900 13568.9971   106%  3494  869s
  1935  1053     cutoff   18      6585.41900 13058.6171  98.3%  3452  885s
  2043  1094 9375.04972   13  229 6585.41900 13058.6171  98.3%  3497  900s
  2124  1159 8719.76511   14  312 6585.41900 13058.6171  98.3%  3569  914s
  2234  1232 8269.95604   15  269 6585.41900 13058.6171  98.3%  3565  929s
  2373  1295 7967.40303   17  310 6585.41900 12745.2275  93.5%  3528  947s
  2506  1323 7665.14020   20  244 6585.41900 12745.2275  93.5%  3502  958s
  2544  1344 7542.94468   21  239 6585.41900 12745.2275  93.5%  3515  971s
  2592  1366 7537.90509   22  284 6585.41900 12682.0780  92.6%  3543  988s
  2659  1400 7299.79949   25  216 6585.41900 12682.0780  92.6%  3563 1006s
  2742  1438 6803.19909   28  157 6585.41900 12682.0780  92.6%  3593 1018s
  2820  1502 infeasible   13      6585.41900 12533.9598  90.3%  3584 1034s
  2908  1549 11046.7708   13  319 6585.41900 12533.9598  90.3%  3639 1051s
  2993  1602 10764.4681   14  289 6585.41900 12533.9598  90.3%  3656 1069s
  3154  1636 10044.4401   17  259 6585.41900 12533.9598  90.3%  3653 1090s
  3286  1737 9678.10086   18  174 6585.41900 11886.2283  80.5%  3655 1109s
  3443  1808 9333.26178   21  263 6585.41900 11787.6836  79.0%  3644 1128s
  3627  1869 9144.52113   23  249 6585.41900 11787.6836  79.0%  3657 1150s
  3830  1893 8744.64517   28  212 6585.41900 11725.4145  78.1%  3668 1177s
  4004  1947 8481.35572   32  170 6585.41900 11642.5664  76.8%  3694 1204s
  4192  2005 8226.92787   41  100 6585.41900 11628.8431  76.6%  3729 1229s
  4419  2103     cutoff   55      6585.41900 11366.9818  72.6%  3732 1253s
  4677  2133 8784.47456   13  251 6585.41900 11328.4392  72.0%  3727 1279s
  4900  2181 infeasible   14      6585.41900 11265.9165  71.1%  3748 1308s
  5169  2206 infeasible   16      6585.41900 11184.7377  69.8%  3751 1334s
  5354  2238     cutoff   19      6585.41900 11184.7377  69.8%  3780 1366s
  5584  2316     cutoff   11      6585.41900 10989.7099  66.9%  3817 1394s
  5827  2335     cutoff   11      6585.41900 10948.8656  66.3%  3855 1424s
  6052  2413 6977.28467   18   72 6585.41900 10907.0171  65.6%  3881 1457s
  6347  2465     cutoff   17      6585.41900 10790.2491  63.9%  3902 1489s
  6654  2530 8387.08199   15  177 6585.41900 10759.4917  63.4%  3916 1521s
  6966  2592     cutoff   19      6585.41900 10722.8786  62.8%  3933 1555s
  7303  2656 8875.94780   14  158 6585.41900 10664.6728  61.9%  3944 1590s
  7604  2702 6771.58457   17  133 6585.41900 10624.9422  61.3%  3980 1627s
  7954  2764     cutoff   14      6585.41900 10618.4027  61.2%  3993 1663s
  8348  2765 8656.74012   13  441 6585.41900 10494.1470  59.4%  3977 1814s
  8350  2766 9277.92745    9  235 6585.41900 10494.1470  59.4%  3976 1891s
  8351  2767 8820.61128    9  407 6585.41900 10494.1470  59.4%  3975 1936s
  8352  2768 9870.02714   18  331 6585.41900 10494.1470  59.4%  3975 1953s
  8353  2768 8418.60168   15  348 6585.41900 10494.1470  59.4%  3974 1967s
  8354  2769 7426.63877   16  360 6585.41900 10494.1470  59.4%  3974 1976s
  8355  2770 7737.91454    9  376 6585.41900 10494.1470  59.4%  3973 1986s
  8356  2770 7113.08820   11  381 6585.41900 10494.1470  59.4%  3973 1996s
  8358  2772 6948.74807   31  398 6585.41900 10494.1470  59.4%  3972 2005s
  8360  2773 6825.08012   19  435 6585.41900 10494.1470  59.4%  3971 2012s
  8361  2774 7908.56637   17  383 6585.41900 10494.1470  59.4%  3970 2015s
  8362  2774 7426.63877   16  429 6585.41900 10494.1470  59.4%  3970 2022s
  8363  2775 7825.45332   16  389 6585.41900 10494.1470  59.4%  3969 2027s
  8364  2776 8463.47708   31  437 6585.41900 10494.1470  59.4%  3969 2037s
  8365  2776 9444.07402   13  435 6585.41900 10494.1470  59.4%  3969 2040s
  8366  2777 10057.2574   12  414 6585.41900 10494.1470  59.4%  3968 2045s
  8367  2778 9188.04252   10  381 6585.41900 10494.1470  59.4%  3968 2052s
  8368  2778 9402.12964   15  378 6585.41900 10494.1470  59.4%  3967 2056s
  8369  2779 9185.23634   11  441 6585.41900 10494.1470  59.4%  3967 2064s
  8370  2780 9590.00257   15  435 6585.41900 10494.1470  59.4%  3966 2069s
  8371  2780 8002.35656    9  382 6585.41900 10494.1470  59.4%  3966 2077s
  8372  2781 9383.31665   16  428 6585.41900 10494.1470  59.4%  3965 2081s
  8373  2782 9763.98510    9  381 6585.41900 10494.1470  59.4%  3965 2096s
  8374  2782 9926.38322   13  439 6585.41900 10494.1470  59.4%  3964 2101s
  8375  2783 7630.69162   13  378 6585.41900 10494.1470  59.4%  3964 2110s
  8376  2784 10189.2387   10  437 6585.41900 10494.1470  59.4%  3963 2116s
  8377  2784 8362.53508   18  384 6585.41900 10494.1470  59.4%  3963 2125s
  8378  2785 7585.52195   15  378 6585.41900 10494.1470  59.4%  3962 2131s
  8379  2786 9141.34144   25  429 6585.41900 10494.1470  59.4%  3962 2140s
  8380  2786 9900.21415   31  377 6585.41900 10494.1470  59.4%  3961 2146s
  8381  2787 7622.42980   17  486 6585.41900 10494.1470  59.4%  3961 2155s
  8382  2788 7337.33165   31  486 6585.41900 10494.1470  59.4%  3960 2215s
  8383  2788 9218.47270   31  486 6585.41900 10494.1470  59.4%  3960 2252s
  8384  2792 10494.1470   15  430 6585.41900 10494.1470  59.4%  3988 2341s
  8386  2795 10494.1470   16  429 6585.41900 10494.1470  59.4%  3989 2371s
  8390  2802 10494.1470   17  415 6585.41900 10494.1470  59.4%  3991 2392s
  8398  2815 10494.1470   18  487 6585.41900 10494.1470  59.4%  3996 2423s
  8414  2827 8932.07252   19  211 6585.41900 10494.1470  59.4%  4014 2470s
  8431  2853 10494.1470   20  379 6585.41900 10494.1470  59.4%  4041 2488s
  8463  2936 10256.5948   21  312 6585.41900 10494.1470  59.4%  4049 2516s
  8574  2937 9078.77783   23  291 6585.41900 10494.1470  59.4%  4044 2534s
  8658  2920 7185.43319   24  208 6585.41900 10494.1470  59.4%  4029 2555s
  8708  2909 8094.59388   24  274 6585.41900 10494.1470  59.4%  4026 2579s
  8771  2893     cutoff   23      6585.41900 10494.1470  59.4%  4019 2594s
  8827  2887 6885.06268   25  209 6585.41900 10494.1470  59.4%  4012 2617s
  8894  2874 7372.10859   25  268 6585.41900 10494.1470  59.4%  4001 2633s
  8936  2877 7331.77833   26  261 6585.41900 10494.1470  59.4%  3999 2649s
  8995  2872 8184.36461   24  259 6585.41900 10494.1470  59.4%  3996 2662s
  9043  2870 8182.20754   25  237 6585.41900 10494.1470  59.4%  3992 2677s
  9094  2860 7742.40106   28  179 6585.41900 10494.1470  59.4%  3988 2692s
  9140  2858     cutoff   28      6585.41900 10494.1470  59.4%  3985 2706s
  9208  2837     cutoff   28      6585.41900 10494.1470  59.4%  3975 2722s
  9265  2820 7281.65752   25  400 6585.41900 10494.1470  59.4%  3966 2738s
  9333  2812 7157.70355   26  312 6585.41900 10494.1470  59.4%  3957 2764s
  9395  2811 6957.38347   22  308 6585.41900 10494.1470  59.4%  3956 2778s
  9444  2815 6861.54921   23  299 6585.41900 10494.1470  59.4%  3952 2797s
  9516  2805 8479.65685   21  304 6585.41900 10494.1470  59.4%  3949 2814s
  9603  2778 8191.61823   21  371 6585.41900 10494.1470  59.4%  3939 2833s
  9650  2786 7404.64666   22  341 6585.41900 10494.1470  59.4%  3941 2859s
  9708  2789 7378.74069   22  283 6585.41900 10494.1470  59.4%  3937 2877s
  9772  2783     cutoff   23      6585.41900 10494.1470  59.4%  3935 2897s
  9833  2767 6819.40960   24  183 6585.41900 10494.1470  59.4%  3932 2916s
  9920  2750 6992.72579   26  168 6585.41900 10494.1470  59.4%  3923 2939s
 10018  2735     cutoff   27      6585.41900 10494.1470  59.4%  3913 2961s
 10117  2719 10135.1240   22  324 6585.41900 10494.1470  59.4%  3907 2982s
 10201  2691 8244.11826   24  423 6585.41900 10494.1470  59.4%  3906 3008s
 10324  2673 7554.17069   26  374 6585.41900 10494.1470  59.4%  3896 3032s
 10433  2639     cutoff   28      6585.41900 10494.1470  59.4%  3892 3055s
 10582  2600 8572.03393   25  204 6585.41900 10378.2386  57.6%  3876 3084s
 10723  2577 7799.06933   28   93 6585.41900 10378.2386  57.6%  3863 3111s
 10859  2539 7373.64434   36  119 6585.41900 10004.8255  51.9%  3853 3136s
 11000  2520 8451.60254   26  296 6585.41900 10004.8255  51.9%  3839 3165s
 11178  2470 7466.46105   31  171 6585.41900 10004.8255  51.9%  3820 3191s
 11375  2405 7278.73785   31  202 6585.41900 9607.85472  45.9%  3791 3222s
 11601  2281     cutoff   31      6585.41900 9414.49630  43.0%  3762 3255s
 11856  2141 6718.35655   23  295 6585.41900 9136.49190  38.7%  3728 3286s
 12108  1986     cutoff   29      6585.41900 9136.49190  38.7%  3695 3320s
 12396  1793     cutoff   28      6585.41900 8601.31742  30.6%  3660 3352s
 12689  1466     cutoff   25      6585.41900 8284.64387  25.8%  3627 3382s
 13070  1230 infeasible   28      6585.41900 7868.71559  19.5%  3568 3400s

Cutting planes:
  MIR: 478
  Mixing: 2
  Flow cover: 1038
  RLT: 11
  Relax-and-lift: 102

Explored 13235 nodes (47079800 simplex iterations) in 3404.17 seconds (6329.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6585.42 6579.3 6548.04 ... 2427.99

Optimal solution found (tolerance 1.00e-04)
Best objective 6.585419001364e+03, best bound 6.585419001364e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3404.19s
  Master Objective (UB) = 6585.42, θ = 135581.95
  Upper Bound (UB) = 6585.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135581.95
  [DEBUG]   ✓ Scenario 0: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135581.95 ≤ Q = 135581.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xf1ad29d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf0e52d63
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6671881.2363
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.351004e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135100.37    0  123 6671881.24 -135100.37   102%     -    0s
H    0     0                    -106271.9283 -135100.37  27.1%     -    0s
H    0     0                    -106425.0894 -135100.37  26.9%     -    0s
     0     0 -111566.06    0   97 -106425.09 -111566.06  4.83%     -    0s
H    0     0                    -109067.7667 -111458.70  2.19%     -    0s
     0     0 -110694.64    0  101 -109067.77 -110694.64  1.49%     -    0s
     0     0 -110229.90    0  104 -109067.77 -110229.90  1.07%     -    0s
     0     0 -110161.62    0  103 -109067.77 -110161.62  1.00%     -    0s
     0     0 -110161.17    0  103 -109067.77 -110161.17  1.00%     -    0s
     0     0 -109984.41    0   98 -109067.77 -109984.41  0.84%     -    0s
     0     0 -109964.64    0   99 -109067.77 -109964.64  0.82%     -    0s
     0     0 -109578.17    0  104 -109067.77 -109578.17  0.47%     -    0s
     0     0 -109465.48    0  103 -109067.77 -109465.48  0.36%     -    0s
     0     0 -109443.88    0  103 -109067.77 -109443.88  0.34%     -    0s
     0     0 -109329.63    0  103 -109067.77 -109329.63  0.24%     -    0s
     0     0 -109329.59    0  103 -109067.77 -109329.59  0.24%     -    0s
     0     2 -109329.58    0  103 -109067.77 -109329.58  0.24%     -    0s
*   46     4              15    -109071.2009 -109096.37  0.02%  11.9    0s

Cutting planes:
  Gomory: 27
  Implied bound: 3
  MIR: 204
  Flow cover: 11
  RLT: 5
  BQP: 2

Explored 59 nodes (1241 simplex iterations) in 0.16 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -109071 -109068 -106425 ... 1.48645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.090712008569e+05, best bound -1.090781600250e+05, gap 0.0064%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 134313.35
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109071.20
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -109071.20 = 134313.35
  [DEBUG]   Current θ from Master = 135581.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1268.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5316.82
  Lower Bound (LB) = 5316.82
  Gap (UB-LB) = 1268.5991, Absolute Gap = 1268.5991, Relative Gap = 0.192638
  Not converged yet (gap = 1268.60 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437589 nonzeros
Model fingerprint: 0x81cf6453
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78780 rows and 31980 columns
Presolve time: 2.33s
Presolved: 75503 rows, 32680 columns, 469819 nonzeros
Variable types: 30421 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75503 rows, 32680 columns, 469819 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27664   -1.9856926e+05   0.000000e+00   2.195588e+07      5s
   42984   -5.4164783e+04   0.000000e+00   1.157631e+07     10s
   50743   -3.1340759e+04   0.000000e+00   4.726435e+07     15s
   57978   -5.6550798e+03   0.000000e+00   3.369818e+06     20s
   66057    2.7719281e+03   0.000000e+00   2.198208e+06     25s
   71893    6.3722642e+03   0.000000e+00   2.497130e+07     30s
   77843    1.4748058e+04   0.000000e+00   1.127403e+06     35s
   84038    1.6061722e+04   0.000000e+00   2.640965e+06     40s
   88472    1.6667879e+04   0.000000e+00   1.028594e+06     45s
   93193    1.7624844e+04   0.000000e+00   5.412934e+06     50s
   98415    1.8710831e+04   0.000000e+00   5.374811e+06     55s
  102869    1.9068077e+04   0.000000e+00   1.369961e+06     60s
  107510    2.0217524e+04   0.000000e+00   1.858614e+07     65s
  112098    2.0605389e+04   0.000000e+00   4.401759e+06     70s
Concurrent spin time: 13.43s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 2.594841e+04, 89833 iterations, 84.89 seconds (100.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 25948.4128    0  235 -170236.42 25948.4128   115%     -   88s
H    0     0                    -164957.6225 25948.4128   116%     -   88s
H    0     0                    -48952.78966 25948.4128   153%     -   88s
H    0     0                    -35824.13830 25948.4128   172%     -   88s
H    0     0                    -34953.99845 25948.4128   174%     -   89s
H    0     0                    -34166.31579 25948.4128   176%     -   89s
H    0     0                    -32158.04738 25948.4128   181%     -   90s
H    0     0                    -30908.48693 25948.4128   184%     -   90s
H    0     0                    -9809.317763 22049.8006   325%     -  112s
     0     0 22049.8006    0  255 -9809.3178 22049.8006   325%     -  113s
H    0     0                    -9781.739913 22049.2547   325%     -  113s
     0     0 21865.0657    0  263 -9781.7399 21865.0657   324%     -  121s
     0     0 21843.6184    0  262 -9781.7399 21843.6184   323%     -  123s
     0     0 21831.4092    0  256 -9781.7399 21831.4092   323%     -  126s
     0     0 21784.7706    0  258 -9781.7399 21784.7706   323%     -  129s
     0     0 21780.8418    0  258 -9781.7399 21780.8418   323%     -  130s
     0     0 21780.7391    0  258 -9781.7399 21780.7391   323%     -  131s
     0     0 18886.9779    0  278 -9781.7399 18886.9779   293%     -  155s
H    0     0                    -9446.912146 18886.2584   300%     -  155s
     0     0 18725.2112    0  315 -9446.9121 18725.2112   298%     -  161s
     0     0 18640.9765    0  324 -9446.9121 18640.9765   297%     -  165s
     0     0 18633.5660    0  319 -9446.9121 18633.5660   297%     -  167s
     0     0 18605.8038    0  324 -9446.9121 18605.8038   297%     -  170s
     0     0 18588.8272    0  324 -9446.9121 18588.8272   297%     -  173s
     0     0 18565.6354    0  330 -9446.9121 18565.6354   297%     -  176s
     0     0 18556.1881    0  334 -9446.9121 18556.1881   296%     -  177s
     0     0 18554.3789    0  331 -9446.9121 18554.3789   296%     -  178s
     0     0 18550.3806    0  330 -9446.9121 18550.3806   296%     -  180s
     0     0 18549.3204    0  331 -9446.9121 18549.3204   296%     -  180s
     0     0 18549.0010    0  336 -9446.9121 18549.0010   296%     -  180s
     0     0 17173.9477    0  370 -9446.9121 17173.9477   282%     -  214s
H    0     0                    -9166.111971 17173.1543   287%     -  215s
H    0     0                    -8528.152205 17173.1543   301%     -  215s
H    0     0                    -8281.877653 17173.1543   307%     -  215s
     0     0 16710.5338    0  384 -8281.8777 16710.5338   302%     -  226s
H    0     0                    -7012.354630 16523.7554   336%     -  235s
     0     0 16523.7554    0  385 -7012.3546 16523.7554   336%     -  235s
H    0     0                    -5705.976011 16484.9379   389%     -  238s
H    0     0                    -5393.409310 16484.9379   406%     -  238s
     0     0 16484.9379    0  390 -5393.4093 16484.9379   406%     -  238s
     0     0 16443.5694    0  395 -5393.4093 16443.5694   405%     -  241s
     0     0 16430.3661    0  398 -5393.4093 16430.3661   405%     -  244s
     0     0 16396.6284    0  392 -5393.4093 16396.6284   404%     -  246s
     0     0 16342.0830    0  398 -5393.4093 16342.0830   403%     -  251s
     0     0 16329.3783    0  401 -5393.4093 16329.3783   403%     -  254s
     0     0 16298.6728    0  385 -5393.4093 16298.6728   402%     -  257s
     0     0 16286.1964    0  399 -5393.4093 16286.1964   402%     -  259s
     0     0 16281.3594    0  400 -5393.4093 16281.3594   402%     -  261s
     0     0 16277.6857    0  394 -5393.4093 16277.6857   402%     -  262s
     0     0 16268.0158    0  396 -5393.4093 16268.0158   402%     -  263s
     0     0 16256.3877    0  388 -5393.4093 16256.3877   401%     -  264s
     0     0 16254.2222    0  386 -5393.4093 16254.2222   401%     -  265s
     0     0 16249.9477    0  392 -5393.4093 16249.9477   401%     -  266s
     0     0 16247.2978    0  392 -5393.4093 16247.2978   401%     -  266s
     0     0 16246.9766    0  395 -5393.4093 16246.9766   401%     -  266s
     0     0 15683.6703    0  346 -5393.4093 15683.6703   391%     -  283s
H    0     0                    -4555.217554 15682.9981   444%     -  284s
     0     0 15472.5275    0  357 -4555.2176 15472.5275   440%     -  292s
     0     0 15442.3451    0  357 -4555.2176 15442.3451   439%     -  297s
     0     0 15423.6334    0  360 -4555.2176 15423.6334   439%     -  301s
     0     0 15416.7684    0  416 -4555.2176 15416.7684   438%     -  303s
     0     0 15412.2701    0  414 -4555.2176 15412.2701   438%     -  305s
     0     0 15404.8706    0  369 -4555.2176 15404.8706   438%     -  306s
     0     0 15401.0149    0  363 -4555.2176 15401.0149   438%     -  308s
     0     0 15397.2637    0  414 -4555.2176 15397.2637   438%     -  309s
     0     0 15396.6466    0  366 -4555.2176 15396.6466   438%     -  309s
     0     0 15180.3387    0  356 -4555.2176 15180.3387   433%     -  320s
     0     0 15134.0323    0  367 -4555.2176 15134.0323   432%     -  324s
     0     0 15122.3760    0  368 -4555.2176 15122.3760   432%     -  327s
     0     0 15108.1616    0  371 -4555.2176 15108.1616   432%     -  331s
     0     0 15102.2936    0  371 -4555.2176 15102.2936   432%     -  334s
     0     0 15096.2504    0  380 -4555.2176 15096.2504   431%     -  335s
     0     0 15091.6107    0  379 -4555.2176 15091.6107   431%     -  337s
     0     0 15088.4018    0  379 -4555.2176 15088.4018   431%     -  339s
     0     0 15087.2421    0  385 -4555.2176 15087.2421   431%     -  340s
     0     0 14992.9093    0  378 -4555.2176 14992.9093   429%     -  348s
H    0     0                    3189.2820090 14992.1134   370%     -  353s
H    0     0                    5369.7669196 14992.1134   179%     -  354s
H    0     0                    5567.2597667 14992.1134   169%     -  354s
     0     0 14963.4280    0  433 5567.25977 14963.4280   169%     -  360s
     0     0 14940.1321    0  424 5567.25977 14940.1321   168%     -  364s
     0     0 14933.8965    0  434 5567.25977 14933.8965   168%     -  366s
     0     0 14932.5998    0  383 5567.25977 14932.5998   168%     -  366s
     0     0 14930.3395    0  434 5567.25977 14930.3395   168%     -  367s
     0     0 14928.5319    0  434 5567.25977 14928.5319   168%     -  368s
     0     0 14919.6346    0  430 5567.25977 14919.6346   168%     -  369s
     0     0 14917.4967    0  431 5567.25977 14917.4967   168%     -  371s
     0     0 14916.4679    0  431 5567.25977 14916.4679   168%     -  371s
     0     0 14797.5501    0  374 5567.25977 14797.5501   166%     -  381s
H    0     0                    5959.5159619 14797.4344   148%     -  381s
H    0     0                    6222.6647409 14797.4344   138%     -  381s
H    0     0                    6224.8881131 14797.4344   138%     -  381s
H    0     0                    6283.5038166 14797.4344   135%     -  381s
     0     0 14766.2332    0  418 6283.50382 14766.2332   135%     -  385s
     0     0 14752.6378    0  377 6283.50382 14752.6378   135%     -  387s
     0     0 14750.7985    0  419 6283.50382 14750.7985   135%     -  388s
     0     0 14748.3775    0  417 6283.50382 14748.3775   135%     -  389s
     0     0 14748.1385    0  378 6283.50382 14748.1385   135%     -  390s
     0     0 14645.8763    0  372 6283.50382 14645.8763   133%     -  399s
     0     0 14625.8997    0  384 6283.50382 14625.8997   133%     -  404s
     0     0 14616.7204    0  431 6283.50382 14616.7204   133%     -  406s
     0     0 14612.8409    0  389 6283.50382 14612.8409   133%     -  407s
     0     0 14599.6951    0  431 6283.50382 14599.6951   132%     -  410s
     0     0 14597.4150    0  418 6283.50382 14597.4150   132%     -  412s
     0     0 14594.6442    0  436 6283.50382 14594.6442   132%     -  413s
     0     0 14593.0767    0  434 6283.50382 14593.0767   132%     -  414s
     0     0 14592.8340    0  437 6283.50382 14592.8340   132%     -  414s
     0     0 14547.9018    0  493 6283.50382 14547.9018   132%     -  422s
     0     0 14536.5016    0  460 6283.50382 14536.5016   131%     -  425s
     0     0 14530.5753    0  503 6283.50382 14530.5753   131%     -  428s
     0     0 14528.6744    0  462 6283.50382 14528.6744   131%     -  429s
     0     0 14528.3017    0  461 6283.50382 14528.3017   131%     -  430s
     0     0 14504.4691    0  492 6283.50382 14504.4691   131%     -  435s
     0     0 14490.9873    0  485 6283.50382 14490.9873   131%     -  438s
     0     0 14487.6184    0  502 6283.50382 14487.6184   131%     -  440s
     0     0 14484.4959    0  499 6283.50382 14484.4959   131%     -  442s
     0     0 14484.1450    0  501 6283.50382 14484.1450   131%     -  442s
     0     0 14453.4200    0  492 6283.50382 14453.4200   130%     -  448s
     0     0 14447.4975    0  489 6283.50382 14447.4975   130%     -  450s
     0     0 14445.3879    0  481 6283.50382 14445.3879   130%     -  451s
     0     0 14444.2107    0  486 6283.50382 14444.2107   130%     -  453s
     0     0 14434.9928    0  479 6283.50382 14434.9928   130%     -  457s
H    0     0                    6548.0372684 14434.8094   120%     -  474s
     0     0 14431.3947    0  388 6548.03727 14431.3947   120%     -  475s
     0     0 14430.2200    0  483 6548.03727 14430.2200   120%     -  477s
     0     0 14419.0325    0  538 6548.03727 14419.0325   120%     -  482s
     0     0 14416.2818    0  489 6548.03727 14416.2818   120%     -  485s
     0     0 14415.6625    0  494 6548.03727 14415.6625   120%     -  487s
     0     0 14409.6922    0  488 6548.03727 14409.6922   120%     -  489s
     0     0 14409.1242    0  491 6548.03727 14409.1242   120%     -  491s
     0     0 14408.7602    0  398 6548.03727 14408.7602   120%     -  493s
     0     0 14408.6752    0  490 6548.03727 14408.6752   120%     -  494s
     0     0 14406.3689    0  491 6548.03727 14406.3689   120%     -  499s
     0     0 14402.4273    0  489 6548.03727 14402.4273   120%     -  500s
     0     0 14402.1470    0  490 6548.03727 14402.1470   120%     -  501s
     0     0 14395.2098    0  492 6548.03727 14395.2098   120%     -  504s
     0     0 14394.9037    0  492 6548.03727 14394.9037   120%     -  507s
     0     2 14394.9037    0  492 6548.03727 14394.9037   120%     -  572s
     1     4 14340.4104    1  470 6548.03727 14391.4623   120%  2069  584s
     3     8 14304.0511    2  464 6548.03727 14339.6400   119%  5414  591s
     7    16 14134.1166    3  484 6548.03727 14301.5037   118%  5010  612s
    15    32 13906.3385    4  485 6548.03727 14134.0127   116%  8028  632s
    31    48 12621.3850    5  499 6548.03727 13906.2246   112% 11556  677s
    47    80 11262.0202    6  385 6548.03727 13906.2246   112% 10814  693s
H   48    80                    6579.2976397 13906.2246   111% 10589  694s
    79   162 11247.4986    7  374 6579.29764 13906.2246   111%  9112  736s
   161   194 11185.8266    9  369 6579.29764 13906.2246   111%  5397  750s
   193   227 11033.0429    9  244 6579.29764 13906.2246   111%  4899  768s
   229   261 11222.7934    8  366 6579.29764 13906.2246   111%  4676  786s
   270   296 11149.8734   10  418 6579.29764 13906.2246   111%  4545  804s
   313   354 11016.4339   10  297 6579.29764 13906.2246   111%  4254  819s
   372   389 11192.8182    9  374 6579.29764 13906.2246   111%  3931  834s
   451   403 11112.5330   10  318 6579.29764 13906.2246   111%  3518  852s
   516   435 10525.1824   11  281 6579.29764 13906.2246   111%  3302  871s
   568   460 10942.0661   10  242 6579.29764 13906.2246   111%  3350  888s
   621   488 7397.67578   11  329 6579.29764 13906.2246   111%  3276  905s
   677   516 9258.13506   11  410 6579.29764 13906.2246   111%  3232  921s
   727   543 10909.3828   11  239 6579.29764 13906.2246   111%  3223  938s
   786   567 10434.6445   12  292 6579.29764 13906.2246   111%  3185  954s
   846   604 10456.9525   12  282 6579.29764 13906.2246   111%  3130  970s
   905   638 10346.5739   13  271 6579.29764 13906.2246   111%  3065  986s
   983   661 10318.1348   14  267 6579.29764 13906.2246   111%  2972 1003s
  1050   691 9399.58386   17  237 6579.29764 13906.2246   111%  2918 1021s
  1116   741 8839.78959   23  214 6579.29764 13906.2246   111%  2886 1040s
  1206   783 8862.08143   24  224 6579.29764 13906.2246   111%  2809 1057s
  1294   818 8496.19067   28  159 6579.29764 13906.2246   111%  2771 1077s
  1389   875 8557.22194   30  255 6579.29764 13906.2246   111%  2747 1098s
  1488   966 8337.78287   39  214 6579.29764 13906.2246   111%  2745 1119s
  1620  1058 8184.59244   48  239 6579.29764 13906.2246   111%  2683 1145s
  1760  1110 8026.47875   56  168 6579.29764 13906.2246   111%  2643 1168s
  1882  1190     cutoff   63      6579.29764 13713.5783   108%  2623 1191s
  2034  1245 8152.91410   10  370 6579.29764 13709.5799   108%  2594 1213s
  2179  1263 7304.76349   12  320 6579.29764 13709.5799   108%  2577 1235s
  2293  1351     cutoff   14      6579.29764 13709.5799   108%  2588 1258s
  2448  1444 8309.78247   10  117 6579.29764 13709.5799   108%  2553 1281s
  2597  1497     cutoff   25      6579.29764 13415.9551   104%  2548 1313s
  2716  1571 7883.74827   22  182 6579.29764 13415.9551   104%  2574 1342s
  2872  1626 7327.92079   24  182 6579.29764 13415.9551   104%  2589 1370s
  2983  1698 infeasible   28      6579.29764 12842.1865  95.2%  2609 1403s
  3163  1766 6690.01516    9  349 6579.29764 12842.1865  95.2%  2617 1434s
  3315  1803     cutoff   11      6579.29764 12842.1865  95.2%  2614 1469s
  3495  1873 10730.9059   13  308 6579.29764 12800.5197  94.6%  2598 1501s
  3678  1910 10062.2538   16  310 6579.29764 12170.3649  85.0%  2595 1536s
  3853  1977     cutoff   19      6579.29764 12170.3649  85.0%  2620 1572s
  4036  2059 6686.41312   23  263 6579.29764 11770.4675  78.9%  2652 1608s
  4280  2104     cutoff   30      6579.29764 11701.4775  77.9%  2638 1651s
  4468  2180 10380.5253   11  292 6579.29764 11641.5844  76.9%  2664 1693s
  4654  2279 8230.86050   16  271 6579.29764 11578.3534  76.0%  2701 1733s
  4864  2357 6944.49806   20  142 6579.29764 11505.5501  74.9%  2705 1775s
  5147  2413 7175.46380   19  135 6579.29764 11354.1522  72.6%  2705 1815s
  5383  2496 9227.26150   10  286 6579.29764 11298.2958  71.7%  2712 1862s
  5679  2541 8225.55661   13  187 6579.29764 11245.2158  70.9%  2709 1909s
  5932  2605     cutoff   16      6579.29764 11138.8301  69.3%  2732 1954s
  6186  2698 7130.05007   12  378 6579.29764 11084.2877  68.5%  2725 2007s
  6502  2699 9238.77426   13  492 6579.29764 11084.2877  68.5%  2730 2135s
  6504  2700 8078.40649   12  235 6579.29764 11084.2877  68.5%  2729 2174s
  6505  2701 9998.53347   14  386 6579.29764 11084.2877  68.5%  2728 2210s
  6506  2702 7574.94206   19  377 6579.29764 11084.2877  68.5%  2728 2238s
  6507  2702 8061.63993   41  434 6579.29764 11084.2877  68.5%  2728 2250s
  6508  2703 10379.8155   12  458 6579.29764 11084.2877  68.5%  2727 2261s
  6509  2704 7414.80045   28  469 6579.29764 11084.2877  68.5%  2727 2271s
  6510  2704 7399.97609   24  471 6579.29764 11084.2877  68.5%  2726 2278s
  6511  2705 10011.0287   11  469 6579.29764 11084.2877  68.5%  2726 2288s
  6512  2706 7081.52378   18  476 6579.29764 11084.2877  68.5%  2725 2295s
  6513  2706 7414.14105   21  483 6579.29764 11084.2877  68.5%  2725 2300s
  6514  2707 7917.19131   48  490 6579.29764 11084.2877  68.5%  2725 2305s
  6515  2708 8314.94215   13  477 6579.29764 11084.2877  68.5%  2724 2310s
  6517  2709 8413.81814   22  525 6579.29764 11084.2877  68.5%  2723 2318s
  6518  2710 8416.25768   30  525 6579.29764 11084.2877  68.5%  2723 2323s
  6519  2710 8401.52717   31  529 6579.29764 11084.2877  68.5%  2722 2326s
  6520  2711 9725.32387   19  532 6579.29764 11084.2877  68.5%  2722 2330s
  6521  2712 7214.53532   14  526 6579.29764 11084.2877  68.5%  2722 2341s
  6522  2712 10378.0488   13  484 6579.29764 11084.2877  68.5%  2721 2347s
  6523  2713 8349.57684    8  532 6579.29764 11084.2877  68.5%  2721 2353s
  6524  2714 8735.83778   15  491 6579.29764 11084.2877  68.5%  2720 2357s
  6525  2714 9008.86089   12  489 6579.29764 11084.2877  68.5%  2720 2364s
  6526  2715 10556.4417   12  432 6579.29764 11084.2877  68.5%  2720 2374s
  6527  2716 9046.56962   13  450 6579.29764 11084.2877  68.5%  2719 2379s
  6528  2716 7978.12709   19  441 6579.29764 11084.2877  68.5%  2719 2390s
  6529  2717 7201.70476   24  402 6579.29764 11084.2877  68.5%  2718 2398s
  6530  2718 8388.11613   36  438 6579.29764 11084.2877  68.5%  2718 2410s
  6531  2718 10172.9119   16  438 6579.29764 11084.2877  68.5%  2717 2416s
  6532  2719 7282.91327   15  446 6579.29764 11084.2877  68.5%  2717 2433s
  6533  2720 6862.15053   12  396 6579.29764 11084.2877  68.5%  2717 2438s
  6534  2720 7361.75841   37  410 6579.29764 11084.2877  68.5%  2716 2444s
  6535  2721 7238.59082   22  393 6579.29764 11084.2877  68.5%  2716 2455s
  6536  2722 10505.8508   10  406 6579.29764 11084.2877  68.5%  2715 2460s
  6537  2722 7151.82436   27  380 6579.29764 11084.2877  68.5%  2715 2467s
  6538  2723 9279.49758   21  458 6579.29764 11084.2877  68.5%  2715 2479s
  6539  2724 7022.71807   27  448 6579.29764 11084.2877  68.5%  2714 2484s
  6540  2724 7460.48217   12  448 6579.29764 11084.2877  68.5%  2714 2497s
  6541  2725 8531.88545   15  448 6579.29764 11084.2877  68.5%  2713 2536s
  6542  2726 8062.81740   57  448 6579.29764 11084.2877  68.5%  2713 2602s
  6543  2728 11084.2877   13  440 6579.29764 11084.2877  68.5%  2754 2626s
  6544  2731 11084.2877   14  460 6579.29764 11084.2877  68.5%  2755 2651s
  6547  2736 11084.2877   15  452 6579.29764 11084.2877  68.5%  2758 2686s
  6553  2746 11084.2877   16  395 6579.29764 11084.2877  68.5%  2766 2710s
  6565  2758 8788.08865   17  182 6579.29764 11084.2877  68.5%  2782 2745s
  6581  2784 11084.2877   17  335 6579.29764 11084.2877  68.5%  2813 2778s
  6613  2800 11084.2877   18  338 6579.29764 11084.2877  68.5%  2825 2799s
  6646  2802 11084.2877   19  335 6579.29764 11084.2877  68.5%  2835 2837s
  6703  2800 9112.11040   19  198 6579.29764 11084.2877  68.5%  2837 2865s
  6780  2797 11084.2877   20  343 6579.29764 11084.2877  68.5%  2862 2890s
  6846  2785 8983.14742   20  183 6579.29764 11084.2877  68.5%  2885 2911s
  6928  2782 8982.89015   21  186 6579.29764 11084.2877  68.5%  2912 2930s
  6998  2777 11033.3007   21  290 6579.29764 11084.2877  68.5%  2936 2954s
  7065  2774 9143.47069   25  221 6579.29764 11084.2877  68.5%  2956 2975s
  7135  2775     cutoff   22      6579.29764 11084.2877  68.5%  2964 2993s
  7204  2761 infeasible   23      6579.29764 11084.2877  68.5%  2992 3009s
  7275  2751 9994.83585   24  219 6579.29764 11084.2877  68.5%  3012 3026s
  7332  2755 7288.10037   26   56 6579.29764 11084.2877  68.5%  3032 3043s
  7394  2757     cutoff   25      6579.29764 11084.2877  68.5%  3047 3060s
  7471  2743 7286.32571   27   76 6579.29764 11084.2877  68.5%  3063 3089s
  7537  2721 8605.69291   29  167 6579.29764 11084.2877  68.5%  3081 3107s
  7619  2703 8187.57460   31  158 6579.29764 11084.2877  68.5%  3093 3128s
  7693  2697 7624.54774   34  116 6579.29764 11084.2877  68.5%  3126 3150s
  7791  2682 6970.71225   37  141 6579.29764 11084.2877  68.5%  3136 3171s
  7862  2679 6807.79800   40  137 6579.29764 11084.2877  68.5%  3168 3191s
  7957  2671 10690.0858   18  298 6579.29764 11084.2877  68.5%  3191 3214s
  8057  2649 10449.8847   19  378 6579.29764 11084.2877  68.5%  3211 3239s
  8159  2610 7691.26430   21  238 6579.29764 11084.2877  68.5%  3220 3262s
  8247  2584 6777.97494   20  329 6579.29764 11084.2877  68.5%  3239 3285s
  8370  2542 6753.14084   21  290 6579.29764 11084.2877  68.5%  3260 3308s
  8472  2519     cutoff   24      6579.29764 10144.3220  54.2%  3271 3332s
  8584  2485 7529.91786   21  302 6579.29764 10141.2591  54.1%  3291 3356s
  8727  2425 infeasible   23      6579.29764 9820.41972  49.3%  3309 3381s
  8863  2330 7518.41600   26  216 6579.29764 9820.41972  49.3%  3328 3410s
  9029  2264 infeasible   26      6579.29764 9372.54391  42.5%  3358 3438s
  9204  2158     cutoff   21      6579.29764 9316.63208  41.6%  3379 3465s
  9430  2024 6634.44468   27  258 6579.29764 9071.23175  37.9%  3383 3494s
  9660  1828     cutoff   27      6579.29764 8651.86996  31.5%  3390 3523s
  9900  1667     cutoff   24      6579.29764 8482.30653  28.9%  3390 3549s
 10092  1549 6934.62342   25  172 6579.29764 7929.35481  20.5%  3377 3572s
 10208  1504 6848.45283   29  251 6579.29764 7746.88567  17.7%  3365 3582s

Cutting planes:
  MIR: 528
  Mixing: 2
  Flow cover: 1292
  Zero half: 1
  RLT: 8
  Relax-and-lift: 116

Explored 10224 nodes (34775404 simplex iterations) in 3582.93 seconds (6350.72 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6579.3 6548.04 6283.5 ... -4555.22

Optimal solution found (tolerance 1.00e-04)
Best objective 6.579297639676e+03, best bound 6.579297639676e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3582.95s
  Master Objective (UB) = 6579.30, θ = 135417.31
  Upper Bound (UB) = 6579.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135417.31
  [DEBUG]   ✓ Scenario 0: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135417.31 ≤ Q = 135417.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4329d081
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbcd62f7f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6663737.6565
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.352846e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135284.57    0  123 6663737.66 -135284.57   102%     -    0s
H    0     0                    -106436.5601 -135284.57  27.1%     -    0s
H    0     0                    -106589.7211 -135284.57  26.9%     -    0s
     0     0 -110460.38    0   71 -106589.72 -110460.38  3.63%     -    0s
H    0     0                    -108221.5480 -110356.21  1.97%     -    0s
     0     0 -109743.44    0   75 -108221.55 -109743.44  1.41%     -    0s
     0     0 -109231.92    0   78 -108221.55 -109231.92  0.93%     -    0s
     0     0 -109206.90    0   77 -108221.55 -109206.90  0.91%     -    0s
     0     0 -109087.48    0   73 -108221.55 -109087.48  0.80%     -    0s
     0     0 -109086.23    0   73 -108221.55 -109086.23  0.80%     -    0s
H    0     0                    -108238.0606 -109086.03  0.78%     -    0s
     0     2 -109086.03    0   73 -108238.06 -109086.03  0.78%     -    0s
H   95    80                    -108255.9628 -108639.02  0.35%  18.1    0s
H  134    80                    -108265.4961 -108639.02  0.35%  14.1    0s
*  170    80              11    -108366.1015 -108613.16  0.23%  11.8    0s

Cutting planes:
  Gomory: 32
  Implied bound: 8
  MIR: 201
  Flow cover: 7
  RLT: 2

Explored 653 nodes (4592 simplex iterations) in 0.17 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -108366 -108265 -108256 ... 1.48645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.083661014908e+05, best bound -1.083745300357e+05, gap 0.0078%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 135018.45
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108366.10
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -108366.10 = 135018.45
  [DEBUG]   Current θ from Master = 135417.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 398.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6180.43
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 398.8680, Absolute Gap = 398.8680, Relative Gap = 0.060625
  Not converged yet (gap = 398.87 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480796 nonzeros
Model fingerprint: 0xd9e1945b
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86658 rows and 35178 columns
Presolve time: 3.31s
Presolved: 82915 rows, 35722 columns, 509957 nonzeros
Variable types: 33463 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372591.5682
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 581
 AA' NZ     : 2.991e+06
 Factor NZ  : 6.719e+06 (roughly 100 MB of memory)
 Factor Ops : 1.193e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.58333808e+07  1.55861712e+08  7.59e+04 2.16e+01  6.77e+04     5s
   1  -1.18550261e+07  1.33680713e+08  5.27e+04 6.31e+01  4.67e+04     5s
   2  -3.31223506e+06  1.01150696e+08  1.43e+04 4.37e-01  1.32e+04     5s
   3  -8.62979499e+05  7.93937496e+07  1.19e+03 2.82e+00  1.54e+03     5s
   4  -6.93172618e+05  3.91730818e+07  7.13e+02 7.40e-01  8.00e+02     5s
   5  -6.12390096e+05  2.69046157e+07  3.22e+02 1.44e-01  4.08e+02     5s
   6  -4.52018030e+05  1.67968429e+07  1.63e+02 1.75e-02  2.18e+02     5s
   7  -3.21394822e+05  1.20047979e+07  8.37e+01 1.15e-02  1.29e+02     5s
   8  -1.56621992e+05  8.55200464e+06  2.47e+01 7.66e-03  6.92e+01     5s
   9  -1.02483087e+05  4.11465139e+06  7.13e+00 3.17e-03  2.98e+01     5s
  10  -7.97208008e+04  1.82114346e+06  2.92e+00 7.94e-03  1.29e+01     5s
  11  -5.18570177e+04  9.97023101e+05  1.02e+00 7.10e-04  6.97e+00     5s
  12  -4.24441244e+04  5.51845093e+05  7.54e-01 3.84e-04  3.94e+00     6s
  13  -3.21596299e+04  2.61451349e+05  5.48e-01 1.75e-04  1.94e+00     6s
  14  -1.53158410e+04  1.67090811e+05  3.25e-01 1.65e-04  1.20e+00     6s
  15  -9.95723171e+03  1.18252130e+05  2.72e-01 1.85e-04  8.47e-01     6s
  16  -3.01005950e+03  9.99958574e+04  2.14e-01 2.22e-04  6.80e-01     6s
  17  -3.12136489e+02  8.31766863e+04  1.91e-01 6.30e-04  5.51e-01     6s
  18   4.92539183e+03  6.68526647e+04  1.53e-01 6.47e-04  4.09e-01     6s
  19   1.05498244e+04  5.64241358e+04  1.13e-01 6.24e-04  3.03e-01     6s
  20   1.51582940e+04  5.03656295e+04  8.44e-02 7.80e-04  2.32e-01     6s
  21   1.68218284e+04  4.56842868e+04  7.45e-02 6.71e-04  1.91e-01     6s
  22   1.84804667e+04  4.25599210e+04  6.50e-02 7.34e-04  1.59e-01     6s
  23   2.15144266e+04  3.95457826e+04  4.88e-02 9.30e-04  1.19e-01     6s
  24   2.39077190e+04  3.72352634e+04  3.68e-02 8.52e-04  8.80e-02     6s
  25   2.53652995e+04  3.52459799e+04  2.96e-02 7.69e-04  6.53e-02     6s
  26   2.66966990e+04  3.45095423e+04  2.32e-02 7.13e-04  5.16e-02     6s
  27   2.78251788e+04  3.41862132e+04  1.78e-02 6.49e-04  4.20e-02     6s
  28   2.88147077e+04  3.31893775e+04  1.30e-02 5.26e-04  2.89e-02     7s
  29   2.96904730e+04  3.25985734e+04  8.90e-03 9.69e-04  1.92e-02     7s
  30   3.02769781e+04  3.20669765e+04  6.18e-03 4.24e-04  1.18e-02     7s
  31   3.08947971e+04  3.19625891e+04  3.32e-03 2.86e-04  7.06e-03     7s
  32   3.11858787e+04  3.18660971e+04  2.12e-03 1.76e-04  4.50e-03     7s
  33   3.12782547e+04  3.18490034e+04  1.72e-03 1.56e-04  3.77e-03     7s
  34   3.13554701e+04  3.18120169e+04  1.38e-03 1.14e-04  3.02e-03     7s
  35   3.13794494e+04  3.18006251e+04  1.29e-03 1.03e-04  2.78e-03     7s
  36   3.14596142e+04  3.17812075e+04  9.41e-04 8.45e-05  2.12e-03     7s
  37   3.15714543e+04  3.17591806e+04  4.90e-04 5.82e-05  1.24e-03     7s
  38   3.16330872e+04  3.17260486e+04  2.46e-04 2.95e-05  6.14e-04     7s
  39   3.16875851e+04  3.17089006e+04  3.61e-05 9.85e-06  1.40e-04     7s
  40   3.16972538e+04  3.17021398e+04  7.08e-06 1.84e-06  3.22e-05     7s
  41   3.17004108e+04  3.17006581e+04  4.00e-07 4.47e-08  1.63e-06     7s
  42   3.17006171e+04  3.17006172e+04  1.94e-09 7.17e-09  2.61e-10     8s

Barrier solved model in 42 iterations and 7.53 seconds (6.37 work units)
Optimal objective 3.17006171e+04


Root crossover log...

   70723 DPushes remaining with DInf 0.0000000e+00                 8s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    2065 PPushes remaining with PInf 1.5292212e-05                10s
    1544 PPushes remaining with PInf 2.9830072e-06                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2212972e+01     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33989    3.1700617e+04   0.000000e+00   1.221297e+01     10s
   33991    3.1700617e+04   0.000000e+00   0.000000e+00     10s
   33991    3.1700617e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.170062e+04, 33991 iterations, 6.42 seconds (8.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 31700.6172    0  288 -170236.42 31700.6172   119%     -   11s
H    0     0                    -160481.8646 31700.6172   120%     -   11s
H    0     0                    -101099.1115 31700.6172   131%     -   11s
H    0     0                    -96672.02795 31700.6172   133%     -   11s
H    0     0                    -96578.31848 31700.6172   133%     -   11s
H    0     0                    -96424.23548 31700.6172   133%     -   11s
H    0     0                    -62950.22655 31700.6172   150%     -   11s
H    0     0                    -4172.616950 31700.6172   860%     -   11s
H    0     0                    -3486.524786 31700.6172  1009%     -   12s
H    0     0                    -3213.962956 31700.6172  1086%     -   12s
H    0     0                    -421.3095977 31700.6172  7624%     -   12s
H    0     0                     -15.3523952 31700.6172      -     -   12s
H    0     0                      98.9252013 31700.6172      -     -   12s
H    0     0                     158.6742658 31700.6172      -     -   12s
H    0     0                     204.8395712 31700.6172      -     -   12s
H    0     0                     271.9301547 31700.6172      -     -   14s
H    0     0                     682.5852718 31700.6172  4544%     -   14s
H    0     0                     683.2062678 31700.6172  4540%     -   14s
H    0     0                     917.3792438 31693.3278  3355%     -   14s
H    0     0                     956.1770149 31693.3278  3215%     -   14s
H    0     0                     990.0925777 31693.3278  3101%     -   14s
H    0     0                    1102.8530605 31693.3278  2774%     -   14s
H    0     0                    1190.1132211 24961.7707  1997%     -   41s
H    0     0                    1306.6556019 24961.7707  1810%     -   41s
H    0     0                    1338.8603101 24961.7707  1764%     -   41s
H    0     0                    1345.3052436 24961.7707  1755%     -   41s
H    0     0                    1649.9380658 24961.7707  1413%     -   41s
H    0     0                    1660.0394925 24961.7707  1404%     -   41s
     0     0 24961.7707    0  306 1660.03949 24961.7707  1404%     -   41s
     0     0 24817.7176    0  298 1660.03949 24817.7176  1395%     -   52s
     0     0 24727.7422    0  290 1660.03949 24727.7422  1390%     -   62s
     0     0 24713.4817    0  288 1660.03949 24713.4817  1389%     -   65s
     0     0 24711.5654    0  287 1660.03949 24711.5654  1389%     -   66s
     0     0 24710.7569    0  285 1660.03949 24710.7569  1389%     -   66s
     0     0 20759.0156    0  303 1660.03949 20759.0156  1151%     -  109s
H    0     0                    1671.8744564 20759.0156  1142%     -  110s
H    0     0                    1698.7182403 20759.0156  1122%     -  110s
     0     0 20163.5534    0  379 1698.71824 20163.5534  1087%     -  142s
     0     0 19884.4419    0  358 1698.71824 19884.4419  1071%     -  160s
     0     0 19702.2064    0  362 1698.71824 19702.2064  1060%     -  173s
H    0     0                    1727.9114630 19672.3626  1039%     -  175s
H    0     0                    1980.1306857 19672.3626   893%     -  175s
     0     0 19672.3626    0  363 1980.13069 19672.3626   893%     -  175s
H    0     0                    2027.4913938 19452.5914   859%     -  186s
     0     0 19452.5914    0  357 2027.49139 19452.5914   859%     -  186s
     0     0 19435.1009    0  359 2027.49139 19435.1009   859%     -  188s
     0     0 19408.1060    0  361 2027.49139 19408.1060   857%     -  192s
     0     0 19312.6885    0  411 2027.49139 19312.6885   853%     -  200s
     0     0 19278.4469    0  354 2027.49139 19278.4469   851%     -  206s
     0     0 19274.2667    0  396 2027.49139 19274.2667   851%     -  208s
     0     0 19273.4299    0  397 2027.49139 19273.4299   851%     -  209s
     0     0 17710.8872    0  340 2027.49139 17710.8872   774%     -  244s
     0     0 17474.8817    0  373 2027.49139 17474.8817   762%     -  256s
     0     0 17359.1230    0  383 2027.49139 17359.1230   756%     -  264s
H    0     0                    2204.5411780 17215.3255   681%     -  270s
     0     0 17215.3255    0  365 2204.54118 17215.3255   681%     -  270s
H    0     0                    2227.5924958 17140.6432   669%     -  277s
     0     0 17140.6432    0  379 2227.59250 17140.6432   669%     -  277s
     0     0 17119.3698    0  374 2227.59250 17119.3698   669%     -  281s
     0     0 17113.7370    0  374 2227.59250 17113.7370   668%     -  283s
     0     0 17098.7545    0  330 2227.59250 17098.7545   668%     -  288s
     0     0 17058.7402    0  340 2227.59250 17058.7402   666%     -  293s
     0     0 17049.4093    0  338 2227.59250 17049.4093   665%     -  297s
     0     0 17044.4956    0  342 2227.59250 17044.4956   665%     -  299s
     0     0 17041.6943    0  343 2227.59250 17041.6943   665%     -  300s
     0     0 17037.2606    0  342 2227.59250 17037.2606   665%     -  301s
     0     0 17034.2313    0  342 2227.59250 17034.2313   665%     -  302s
     0     0 17015.2444    0  339 2227.59250 17015.2444   664%     -  305s
     0     0 17011.5351    0  341 2227.59250 17011.5351   664%     -  307s
     0     0 16998.5476    0  339 2227.59250 16998.5476   663%     -  309s
     0     0 16993.1569    0  339 2227.59250 16993.1569   663%     -  310s
     0     0 16991.8748    0  344 2227.59250 16991.8748   663%     -  311s
     0     0 16153.2337    0  353 2227.59250 16153.2337   625%     -  338s
     0     0 15818.1697    0  344 2227.59250 15818.1697   610%     -  354s
     0     0 15643.4606    0  354 2227.59250 15643.4606   602%     -  363s
     0     0 15574.3971    0  352 2227.59250 15574.3971   599%     -  371s
H    0     0                    2988.0719638 15531.9790   420%     -  376s
H    0     0                    4003.3737126 15531.9790   288%     -  376s
     0     0 15531.9790    0  353 4003.37371 15531.9790   288%     -  376s
     0     0 15508.1960    0  354 4003.37371 15508.1960   287%     -  382s
H    0     0                    4168.1178325 15438.5417   270%     -  389s
H    0     0                    4173.5564414 15438.5417   270%     -  389s
H    0     0                    4376.7250911 15438.5417   253%     -  389s
     0     0 15438.5417    0  361 4376.72509 15438.5417   253%     -  389s
     0     0 15426.3211    0  364 4376.72509 15426.3211   252%     -  395s
     0     0 15417.8852    0  361 4376.72509 15417.8852   252%     -  397s
     0     0 15390.0570    0  354 4376.72509 15390.0570   252%     -  403s
     0     0 15385.3908    0  354 4376.72509 15385.3908   252%     -  406s
     0     0 15382.8278    0  360 4376.72509 15382.8278   251%     -  408s
     0     0 15381.7522    0  367 4376.72509 15381.7522   251%     -  410s
     0     0 15141.6959    0  427 4376.72509 15141.6959   246%     -  433s
H    0     0                    5349.6427908 15141.4986   183%     -  433s
H    0     0                    5931.4028197 15141.4986   155%     -  433s
     0     0 15048.6444    0  426 5931.40282 15048.6444   154%     -  445s
     0     0 15011.8251    0  435 5931.40282 15011.8251   153%     -  454s
     0     0 15002.2430    0  437 5931.40282 15002.2430   153%     -  458s
     0     0 14993.5625    0  434 5931.40282 14993.5625   153%     -  461s
     0     0 14990.2864    0  438 5931.40282 14990.2864   153%     -  463s
     0     0 14988.8761    0  443 5931.40282 14988.8761   153%     -  464s
     0     0 14873.0958    0  372 5931.40282 14873.0958   151%     -  475s
H    0     0                    6056.7889378 14872.8736   146%     -  476s
     0     0 14848.8468    0  377 6056.78894 14848.8468   145%     -  482s
     0     0 14797.1275    0  372 6056.78894 14797.1275   144%     -  491s
     0     0 14774.1874    0  381 6056.78894 14774.1874   144%     -  496s
     0     0 14764.5582    0  370 6056.78894 14764.5582   144%     -  499s
     0     0 14759.5119    0  377 6056.78894 14759.5119   144%     -  501s
     0     0 14757.4442    0  373 6056.78894 14757.4442   144%     -  501s
     0     0 14672.6297    0  384 6056.78894 14672.6297   142%     -  510s
H    0     0                    6177.3739308 14672.4881   138%     -  511s
H    0     0                    6220.5975619 14672.4881   136%     -  511s
H    0     0                    6222.6647409 14672.4881   136%     -  511s
H    0     0                    6283.5038166 14672.4881   134%     -  511s
     0     0 14646.1698    0  451 6283.50382 14646.1698   133%     -  518s
     0     0 14636.5863    0  444 6283.50382 14636.5863   133%     -  521s
     0     0 14627.3777    0  401 6283.50382 14627.3777   133%     -  523s
     0     0 14623.5228    0  398 6283.50382 14623.5228   133%     -  525s
     0     0 14621.6729    0  400 6283.50382 14621.6729   133%     -  526s
     0     0 14574.9582    0  385 6283.50382 14574.9582   132%     -  535s
     0     0 14556.9176    0  383 6283.50382 14556.9176   132%     -  539s
     0     0 14549.6420    0  387 6283.50382 14549.6420   132%     -  541s
     0     0 14544.8726    0  385 6283.50382 14544.8726   131%     -  544s
     0     0 14543.8417    0  386 6283.50382 14543.8417   131%     -  545s
     0     0 14495.1393    0  382 6283.50382 14495.1393   131%     -  552s
     0     0 14477.8454    0  385 6283.50382 14477.8454   130%     -  557s
     0     0 14472.1956    0  390 6283.50382 14472.1956   130%     -  560s
     0     0 14469.6864    0  393 6283.50382 14469.6864   130%     -  562s
     0     0 14468.7388    0  389 6283.50382 14468.7388   130%     -  564s
     0     0 14449.8592    0  383 6283.50382 14449.8592   130%     -  569s
     0     0 14441.0240    0  380 6283.50382 14441.0240   130%     -  575s
     0     0 14434.5755    0  385 6283.50382 14434.5755   130%     -  578s
     0     0 14431.8594    0  384 6283.50382 14431.8594   130%     -  580s
     0     0 14430.9612    0  384 6283.50382 14430.9612   130%     -  581s
     0     0 14399.7217    0  371 6283.50382 14399.7217   129%     -  586s
     0     0 14385.3380    0  385 6283.50382 14385.3380   129%     -  590s
     0     0 14378.6228    0  380 6283.50382 14378.6228   129%     -  594s
     0     0 14375.9158    0  381 6283.50382 14375.9158   129%     -  597s
     0     0 14374.5323    0  392 6283.50382 14374.5323   129%     -  598s
     0     0 14357.4251    0  433 6283.50382 14357.4251   128%     -  605s
     0     0 14348.6524    0  386 6283.50382 14348.6524   128%     -  608s
     0     0 14344.4328    0  382 6283.50382 14344.4328   128%     -  610s
     0     0 14342.7118    0  390 6283.50382 14342.7118   128%     -  611s
     0     0 14315.2660    0  448 6283.50382 14315.2660   128%     -  617s
     0     0 14306.5736    0  390 6283.50382 14306.5736   128%     -  623s
     0     0 14300.5561    0  499 6283.50382 14300.5561   128%     -  626s
     0     0 14297.3662    0  502 6283.50382 14297.3662   128%     -  627s
     0     0 14294.4668    0  516 6283.50382 14294.4668   127%     -  629s
     0     0 14293.6725    0  458 6283.50382 14293.6725   127%     -  630s
     0     0 14273.5709    0  459 6283.50382 14273.5709   127%     -  635s
     0     0 14268.8754    0  447 6283.50382 14268.8754   127%     -  638s
     0     0 14264.1219    0  448 6283.50382 14264.1219   127%     -  639s
     0     0 14263.0030    0  453 6283.50382 14263.0030   127%     -  640s
     0     0 14254.8326    0  447 6283.50382 14254.8326   127%     -  645s
     0     0 14248.8323    0  453 6283.50382 14248.8323   127%     -  648s
     0     0 14245.4007    0  455 6283.50382 14245.4007   127%     -  649s
     0     0 14242.7923    0  450 6283.50382 14242.7923   127%     -  650s
     0     0 14241.0714    0  449 6283.50382 14241.0714   127%     -  651s
     0     0 14223.6518    0  407 6283.50382 14223.6518   126%     -  655s
     0     0 14217.8601    0  403 6283.50382 14217.8601   126%     -  667s
     0     0 14214.6382    0  406 6283.50382 14214.6382   126%     -  670s
     0     0 14212.4904    0  408 6283.50382 14212.4904   126%     -  672s
     0     0 14206.2858    0  399 6283.50382 14206.2858   126%     -  676s
     0     0 14203.3667    0  412 6283.50382 14203.3667   126%     -  679s
     0     0 14201.1117    0  406 6283.50382 14201.1117   126%     -  680s
     0     0 14196.2885    0  404 6283.50382 14196.2885   126%     -  683s
     0     0 14193.2361    0  403 6283.50382 14193.2361   126%     -  705s
     0     0 14191.4501    0  409 6283.50382 14191.4501   126%     -  706s
     0     0 14189.7486    0  460 6283.50382 14189.7486   126%     -  708s
     0     0 14189.0537    0  460 6283.50382 14189.0537   126%     -  711s
     0     2 14188.7470    0  460 6283.50382 14188.7470   126%     -  812s
     1     3 12904.7228    1  289 6283.50382 14188.6839   126%  5895  820s
     5    11 11872.1325    3  279 6283.50382 14041.3084   123%  4273  845s
    10    22 11414.7458    4  286 6283.50382 14040.9398   123%  7501  858s
    21    33 13510.9558    3  407 6283.50382 13843.3280   120%  8948  882s
    32    65 12406.4411    4  360 6283.50382 13843.3280   120%  9614  973s
H   35    65                    6402.3309206 13843.3280   116%  9133  973s
    64    97 12050.6603    5  348 6402.33092 13621.6377   113% 14483 1030s
    96   207 11711.7366    6  352 6402.33092 13617.7534   113% 12816 1063s
   213   274 10758.4613    8  328 6402.33092 13617.7534   113%  8847 1084s
   315   333 8946.43272    9  302 6402.33092 13617.7534   113%  7194 1100s
H  318   333                    6466.0254789 13617.7534   111%  7183 1100s
   402   361 8286.56780   10  346 6466.02548 13617.7534   111%  6422 1116s
   492   379 6842.74534   12  221 6466.02548 13617.7534   111%  5946 1132s
H  538   379                    6492.1457872 13495.8386   108%  5723 1132s
   559   388 6660.04313   13  144 6492.14579 13495.8386   108%  5704 1149s
   616   407 11103.5282    8  365 6492.14579 13495.8386   108%  5740 1165s
   661   439 10553.6769    9  337 6492.14579 13495.8386   108%  5828 1181s
   725   466     cutoff   11      6492.14579 13495.8386   108%  5686 1195s
   784   489 8627.85034   11  341 6492.14579 13495.8386   108%  5569 1209s
   855   512 8314.13043   13  306 6492.14579 13495.8386   108%  5456 1225s
   912   550 8192.32630   14  309 6492.14579 13495.8386   108%  5446 1240s
H  974   581                    6562.3533687 13495.8386   106%  5404 1255s
  1019   610 7976.07386   16  298 6562.35337 13495.8386   106%  5400 1271s
  1073   652 7864.14972   17  315 6562.35337 13495.8386   106%  5327 1283s
  1131   691 7784.69782   18  312 6562.35337 13495.8386   106%  5325 1299s
  1208   711 7356.41422   19  316 6562.35337 13371.7966   104%  5263 1315s
  1252   754 7263.84027   20  314 6562.35337 13371.7966   104%  5255 1327s
  1303   807 7070.08192   22  322 6562.35337 13371.7966   104%  5275 1341s
  1360   856 infeasible   24      6562.35337 13371.7966   104%  5260 1356s
  1443   900 6824.36623   25  283 6562.35337 13371.7966   104%  5215 1373s
  1553   922     cutoff   27      6562.35337 13306.5208   103%  5113 1392s
  1634   939 10865.5371   12  245 6562.35337 13306.5208   103%  5111 1414s
  1669   965 10636.0616   13  242 6562.35337 13306.5208   103%  5128 1434s
  1705   992 10487.5364   14  236 6562.35337 13306.5208   103%  5143 1452s
  1758  1018 10369.5882   15  237 6562.35337 13306.5208   103%  5123 1472s
  1816  1043 10191.1256   16  247 6562.35337 12627.4654  92.4%  5153 1493s
  1853  1082 10176.0346   17  250 6562.35337 12627.4654  92.4%  5173 1512s
  1896  1121 9239.62898   18  217 6562.35337 12627.4654  92.4%  5205 1531s
  1971  1159 8879.90775   19  206 6562.35337 12442.3448  89.6%  5187 1556s
  2051  1212     cutoff   20      6562.35337 12442.3448  89.6%  5196 1578s
  2149  1261 8232.28885   21  193 6562.35337 12442.3448  89.6%  5233 1603s
  2252  1327 7845.23698   24  234 6562.35337 12390.8000  88.8%  5230 1627s
  2360  1403 7541.94239   29  234 6562.35337 12366.3981  88.4%  5263 1652s
  2490  1476 6990.06330   33  250 6562.35337 12270.9754  87.0%  5259 1677s
  2625  1525 10633.1338    8  242 6562.35337 11970.2342  82.4%  5257 1704s
  2788  1608     cutoff   12      6562.35337 11935.9763  81.9%  5186 1733s
  2918  1690 7401.60670   12  135 6562.35337 11935.9763  81.9%  5235 1763s
  3108  1777 8038.13096   15  344 6562.35337 11935.9763  81.9%  5192 1793s
  3309  1871 7180.10030   18  241 6562.35337 11935.9763  81.9%  5126 1828s
  3538  1939 9265.27907    6  212 6562.35337 11935.9763  81.9%  5042 1865s
  3718  2019     cutoff    9      6562.35337 11584.2074  76.5%  5036 1899s
  3888  2099 10267.2719    8  213 6562.35337 11584.2074  76.5%  5075 1937s
  4087  2180 8800.88733   13  216 6562.35337 11584.2074  76.5%  5077 1977s
  4258  2263 7916.40533   19  267 6562.35337 11312.2948  72.4%  5128 2018s
  4453  2350 7186.34797   24  247 6562.35337 11312.2948  72.4%  5158 2059s
  4680  2411 10060.6388   10  252 6562.35337 11245.8533  71.4%  5157 2102s
  4857  2515 9194.01329   14  207 6562.35337 11170.0029  70.2%  5174 2144s
  5088  2516 10938.3435   10  460 6562.35337 11153.0731  70.0%  5177 2245s
  5090  2517 7283.55095   13  273 6562.35337 11153.0731  70.0%  5175 2259s
  5091  2518 8465.68482   10  379 6562.35337 11153.0731  70.0%  5174 2333s
  5092  2519 8246.41942   33  391 6562.35337 11153.0731  70.0%  5173 2385s
  5093  2519 6949.69918   39  352 6562.35337 11153.0731  70.0%  5172 2422s
  5094  2520 8307.88384   10  420 6562.35337 11153.0731  70.0%  5171 2443s
  5095  2521 8259.23266   15  418 6562.35337 11153.0731  70.0%  5170 2461s
  5096  2521 9001.76935   25  410 6562.35337 11153.0731  70.0%  5169 2472s
  5097  2522 8812.99349   11  428 6562.35337 11153.0731  70.0%  5168 2487s
  5098  2523 9484.66190   19  433 6562.35337 11153.0731  70.0%  5167 2501s
  5099  2523 6825.29082   41  470 6562.35337 11153.0731  70.0%  5166 2510s
  5101  2525 7512.93696   32  369 6562.35337 11153.0731  70.0%  5164 2523s
  5102  2525 8174.65692   11  394 6562.35337 11153.0731  70.0%  5163 2528s
  5103  2526 8452.63323   24  396 6562.35337 11153.0731  70.0%  5162 2534s
  5104  2527 7667.05100   14  436 6562.35337 11153.0731  70.0%  5161 2548s
  5105  2527 9457.02895   17  397 6562.35337 11153.0731  70.0%  5160 2555s
  5107  2529 8858.22981   16  378 6562.35337 11153.0731  70.0%  5158 2562s
  5108  2529 9062.71989   16  388 6562.35337 11153.0731  70.0%  5157 2573s
  5109  2530 7202.80880   41  411 6562.35337 11153.0731  70.0%  5156 2579s
  5110  2531 10983.1140   11  400 6562.35337 11153.0731  70.0%  5155 2582s
  5111  2531 8444.85591   25  388 6562.35337 11153.0731  70.0%  5154 2587s
  5112  2532 7331.89931   20  393 6562.35337 11153.0731  70.0%  5153 2601s
  5113  2533 10028.4601   13  390 6562.35337 11153.0731  70.0%  5152 2611s
  5114  2533 9945.16583   16  449 6562.35337 11153.0731  70.0%  5151 2622s
  5115  2534 9243.74857   18  407 6562.35337 11153.0731  70.0%  5150 2629s
  5116  2535 10412.8006    7  410 6562.35337 11153.0731  70.0%  5149 2642s
  5117  2535 8511.29729   11  398 6562.35337 11153.0731  70.0%  5148 2648s
  5118  2536 7174.12211   22  410 6562.35337 11153.0731  70.0%  5147 2657s
  5119  2537 8885.73675   10  425 6562.35337 11153.0731  70.0%  5146 2665s
  5120  2537 9557.59447    9  420 6562.35337 11153.0731  70.0%  5145 2674s
  5121  2538 8561.51447   19  466 6562.35337 11153.0731  70.0%  5144 2681s
  5122  2539 8520.42907   18  418 6562.35337 11153.0731  70.0%  5143 2690s
  5123  2539 8750.57976   14  418 6562.35337 11153.0731  70.0%  5142 2707s
  5124  2540 7630.53517   29  418 6562.35337 11153.0731  70.0%  5141 2777s
  5125  2543 11153.0731   10  384 6562.35337 11153.0731  70.0%  5193 2810s
  5126  2544 11153.0731   11  477 6562.35337 11153.0731  70.0%  5194 2830s
  5128  2549 11153.0731   11  301 6562.35337 11153.0731  70.0%  5196 2859s
  5133  2557 11153.0731   12  285 6562.35337 11153.0731  70.0%  5197 2901s
  5143  2565 8577.56900   13  164 6562.35337 11153.0731  70.0%  5208 2975s
  5154  2585 11153.0731   14  313 6562.35337 11153.0731  70.0%  5229 3105s
  5185  2595 11153.0731   15  315 6562.35337 11153.0731  70.0%  5406 3155s
  5217  2614 9077.00745   16  371 6562.35337 11153.0731  70.0%  5435 3209s
  5249  2653 8954.65241   17  362 6562.35337 11153.0731  70.0%  5470 3252s
  5307  2693 8785.24776   18  363 6562.35337 11153.0731  70.0%  5459 3295s
  5409  2696 8426.01204   19  288 6562.35337 11153.0731  70.0%  5433 3331s
  5494  2695 8045.55535   20  330 6562.35337 11153.0731  70.0%  5412 3373s
  5587  2678     cutoff   21      6562.35337 11153.0731  70.0%  5381 3417s
  5676  2663 7839.82037   22  330 6562.35337 11153.0731  70.0%  5355 3453s
  5747  2651 7560.12169   24  278 6562.35337 11153.0731  70.0%  5348 3481s
  5813  2653     cutoff   26      6562.35337 11153.0731  70.0%  5339 3505s
  5883  2657 7894.02624   21  205 6562.35337 11153.0731  70.0%  5324 3536s
  5945  2662 7859.04311   22  175 6562.35337 11153.0731  70.0%  5309 3562s
  6018  2680 7368.88633   25  183 6562.35337 11153.0731  70.0%  5288 3586s
  6105  2663 6624.04773   25  142 6562.35337 11153.0731  70.0%  5252 3600s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  Projected implied bound: 148
  MIR: 1019
  Mixing: 4
  Flow cover: 1468
  RLT: 28
  Relax-and-lift: 193

Explored 6191 nodes (32713178 simplex iterations) in 3600.07 seconds (6073.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6562.35 6492.15 6466.03 ... 5931.4

Time limit reached
Best objective 6.562353368719e+03, best bound 1.115307309142e+04, gap 69.9554%
  WARNING: Time limit reached. Using best solution found (gap: 69.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 6562.35, θ = 135204.28
  Upper Bound (UB) = 6562.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135204.28
  [DEBUG]   ✓ Scenario 0: θ = 135204.28 ≤ Q = 135204.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135204.28 ≤ Q = 135204.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135204.28 ≤ Q = 135204.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135204.28 ≤ Q = 135204.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135204.28 ≤ Q = 135204.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135204.28 ≤ Q = 135204.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135204.28 ≤ Q = 135204.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135204.28 ≤ Q = 135204.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135204.28 ≤ Q = 135204.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135204.28 ≤ Q = 135204.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135204.28 ≤ Q = 135204.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x52c3e38d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x52c3e38d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.476521e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6582610.1213
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.355230e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135523.01    0  123 6582610.12 -135523.01   102%     -    0s
H    0     0                    -106677.7435 -135523.01  27.0%     -    0s
H    0     0                    -106830.9045 -135523.01  26.9%     -    0s
     0     0 -112195.58    0   79 -106830.90 -112195.58  5.02%     -    0s
H    0     0                    -109838.1700 -112096.36  2.06%     -    0s
     0     0 -111600.66    0   77 -109838.17 -111600.66  1.60%     -    0s
H    0     0                    -110300.4183 -111595.49  1.17%     -    0s
H    0     0                    -110595.3449 -111595.49  0.90%     -    0s
     0     0 -111300.36    0   79 -110595.34 -111300.36  0.64%     -    0s
H    0     0                    -110632.3047 -111289.23  0.59%     -    0s
     0     0 -111230.84    0   78 -110632.30 -111230.84  0.54%     -    0s
     0     0 -110987.61    0   63 -110632.30 -110987.61  0.32%     -    0s
     0     0 -110983.81    0   62 -110632.30 -110983.81  0.32%     -    0s
     0     0 -110982.63    0   61 -110632.30 -110982.63  0.32%     -    0s
     0     0 -110947.46    0   50 -110632.30 -110947.46  0.28%     -    0s
     0     0 -110934.57    0   54 -110632.30 -110934.57  0.27%     -    0s
     0     0 -110746.57    0   30 -110632.30 -110746.57  0.10%     -    0s
     0     0 -110741.22    0   24 -110632.30 -110741.22  0.10%     -    0s
     0     0 -110722.72    0   13 -110632.30 -110722.72  0.08%     -    0s
     0     0 -110717.96    0   12 -110632.30 -110717.96  0.08%     -    0s
H    0     0                    -110637.0114 -110717.96  0.07%     -    0s
     0     0 -110704.29    0   13 -110637.01 -110704.29  0.06%     -    0s
     0     0 -110692.90    0   13 -110637.01 -110692.90  0.05%     -    0s
     0     0 -110688.59    0   12 -110637.01 -110688.59  0.05%     -    0s
     0     0 -110666.67    0    9 -110637.01 -110666.67  0.03%     -    0s
     0     0 -110663.39    0    8 -110637.01 -110663.39  0.02%     -    0s
*    0     0               0    -110652.0661 -110652.07  0.00%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 3
  Flow cover: 4
  Relax-and-lift: 2

Explored 1 nodes (735 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -110652 -110637 -110632 ... 1.47652e+13
No other solutions better than -110652

Optimal solution found (tolerance 1.00e-04)
Best objective -1.106520660849e+05, best bound -1.106520660849e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 132732.48
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110652.07
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -110652.07 = 132732.48
  [DEBUG]   Current θ from Master = 135204.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2471.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4090.56
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 381.9237, Absolute Gap = 381.9237, Relative Gap = 0.058199
  Not converged yet (gap = 381.92 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524003 nonzeros
Model fingerprint: 0xec751bbe
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94536 rows and 38376 columns
Presolve time: 3.11s
Presolved: 90327 rows, 38764 columns, 551427 nonzeros
Variable types: 36505 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378310.3330
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 581
 AA' NZ     : 3.321e+06
 Factor NZ  : 7.530e+06 (roughly 110 MB of memory)
 Factor Ops : 1.380e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.65261565e+07  1.69638088e+08  7.93e+04 2.11e+01  7.02e+04     5s
   1  -1.25802969e+07  1.46473528e+08  5.59e+04 6.41e+01  4.89e+04     5s
   2  -3.94864034e+06  1.11792525e+08  1.69e+04 5.66e-01  1.55e+04     5s
   3  -9.02305390e+05  7.60044159e+07  1.96e+03 6.25e-01  2.13e+03     5s
   4  -5.20790944e+05  3.94977618e+07  4.41e+02 1.62e-01  5.84e+02     5s
   5  -4.31855212e+05  2.65419213e+07  2.13e+02 9.65e-02  3.16e+02     5s
   6  -2.99528141e+05  1.90875247e+07  3.31e+01 6.44e-02  1.39e+02     5s
   7  -2.07703952e+05  1.29463081e+07  9.67e+00 4.17e-02  8.44e+01     5s
   8  -1.16502116e+05  8.71484298e+06  1.77e+00 2.75e-02  5.39e+01     5s
   9  -8.58806173e+04  4.51862790e+06  1.06e+00 1.45e-02  2.80e+01     5s
  10  -5.02839523e+04  3.10096583e+06  3.13e-01 9.74e-03  1.90e+01     5s
  11  -2.91295681e+04  1.64479967e+06  1.22e-01 5.08e-03  1.01e+01     5s
  12  -1.65782733e+04  7.15171979e+05  7.70e-02 2.05e-03  4.41e+00     6s
  13  -1.00328216e+04  3.69939329e+05  5.11e-02 1.02e-03  2.29e+00     6s
  14   4.24746378e+02  1.96916678e+05  2.78e-02 7.29e-04  1.18e+00     6s
  15   2.99663743e+03  1.47548551e+05  2.41e-02 9.17e-04  8.71e-01     6s
  16   6.82240169e+03  1.10810981e+05  1.96e-02 1.26e-03  6.27e-01     6s
  17   1.07282248e+04  9.34246522e+04  1.57e-02 9.45e-04  4.99e-01     6s
  18   1.56928342e+04  7.31763374e+04  1.12e-02 6.37e-04  3.47e-01     6s
  19   1.96310369e+04  5.86825055e+04  8.38e-03 4.23e-04  2.35e-01     6s
  20   2.16242291e+04  5.29737096e+04  7.00e-03 3.28e-04  1.89e-01     6s
  21   2.39038035e+04  4.80438230e+04  5.50e-03 2.45e-04  1.46e-01     6s
  22   2.54980224e+04  4.23703149e+04  4.51e-03 1.61e-04  1.02e-01     6s
  23   2.76251031e+04  4.03321480e+04  3.25e-03 1.25e-04  7.66e-02     6s
  24   2.86952624e+04  3.92893715e+04  2.63e-03 1.06e-04  6.39e-02     6s
  25   3.01986528e+04  3.75012540e+04  1.78e-03 7.27e-05  4.40e-02     6s
  26   3.12131345e+04  3.58328588e+04  1.23e-03 5.07e-05  2.78e-02     7s
  27   3.19619608e+04  3.50636060e+04  8.39e-04 3.30e-05  1.87e-02     7s
  28   3.25736531e+04  3.48285458e+04  5.24e-04 2.84e-05  1.36e-02     7s
  29   3.29423975e+04  3.47072029e+04  3.41e-04 2.53e-05  1.06e-02     7s
  30   3.32239753e+04  3.44327007e+04  2.04e-04 1.86e-05  7.29e-03     7s
  31   3.33205948e+04  3.40265398e+04  1.60e-04 8.42e-06  4.26e-03     7s
  32   3.34567394e+04  3.39308676e+04  9.93e-05 5.94e-06  2.86e-03     7s
  33   3.35780130e+04  3.38620127e+04  4.59e-05 4.18e-06  1.71e-03     7s
  34   3.36420964e+04  3.37975439e+04  1.92e-05 2.54e-06  9.37e-04     7s
  35   3.36606434e+04  3.37412663e+04  1.19e-05 1.11e-06  4.86e-04     7s
  36   3.36647019e+04  3.37191910e+04  1.04e-05 5.77e-07  3.28e-04     7s
  37   3.36791833e+04  3.37035189e+04  5.13e-06 2.03e-07  1.47e-04     8s
  38   3.36860118e+04  3.36983261e+04  2.74e-06 8.47e-08  7.42e-05     8s
  39   3.36936640e+04  3.36944846e+04  1.60e-07 8.66e-08  4.95e-06     8s
  40   3.36942624e+04  3.36943847e+04  2.18e-08 1.70e-08  7.37e-07     8s
  41   3.36943545e+04  3.36943548e+04  9.90e-10 2.61e-09  1.65e-09     8s

Barrier solved model in 41 iterations and 7.84 seconds (7.51 work units)
Optimal objective 3.36943545e+04


Root crossover log...

   74061 DPushes remaining with DInf 0.0000000e+00                 8s
   13931 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    9667 PPushes remaining with PInf 2.9043818e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6380316e+02     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41753    3.3694355e+04   0.000000e+00   1.638032e+02     12s
   41798    3.3694355e+04   0.000000e+00   0.000000e+00     12s
   41798    3.3694355e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.369435e+04, 41798 iterations, 8.69 seconds (12.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33694.3547    0  368 -170236.42 33694.3547   120%     -   13s
H    0     0                    -161681.7136 33694.3547   121%     -   13s
H    0     0                    -68949.81058 33694.3547   149%     -   14s
H    0     0                    -65414.40382 33694.3547   152%     -   14s
H    0     0                    -18360.43064 33694.3547   284%     -   14s
H    0     0                    -18301.69832 33694.3547   284%     -   14s
H    0     0                    -15983.50305 33694.3547   311%     -   16s
H    0     0                    -14425.95196 33694.3547   334%     -   16s
     0     0 26936.2594    0  376 -14425.952 26936.2594   287%     -   67s
     0     0 26634.2052    0  419 -14425.952 26634.2052   285%     -   92s
     0     0 26557.5003    0  428 -14425.952 26557.5003   284%     -  104s
     0     0 26492.3294    0  428 -14425.952 26492.3294   284%     -  112s
     0     0 26470.5228    0  426 -14425.952 26470.5228   283%     -  119s
     0     0 26470.5228    0  422 -14425.952 26470.5228   283%     -  134s
     0     0 26470.5228    0  422 -14425.952 26470.5228   283%     -  142s
     0     0 26470.5228    0  424 -14425.952 26470.5228   283%     -  143s
H    0     0                    -4535.795920 21662.3041   578%     -  224s
H    0     0                    -3417.270623 21662.3041   734%     -  224s
H    0     0                    -3256.770549 21662.3041   765%     -  224s
     0     0 21662.3041    0  337 -3256.7705 21662.3041   765%     -  224s
H    0     0                    1563.0134006 21662.2276  1286%     -  224s
H    0     0                    4501.1962316 20893.2947   364%     -  274s
H    0     0                    4563.1770204 20893.2947   358%     -  274s
H    0     0                    5214.1461948 20893.2947   301%     -  274s
H    0     0                    5301.6726841 20893.2947   294%     -  274s
     0     0 20893.2947    0  419 5301.67268 20893.2947   294%     -  274s
     0     0 20721.8793    0  355 5301.67268 20721.8793   291%     -  295s
     0     0 20490.2887    0  352 5301.67268 20490.2887   286%     -  319s
     0     0 20351.6954    0  412 5301.67268 20351.6954   284%     -  341s
     0     0 20306.7230    0  413 5301.67268 20306.7230   283%     -  353s
H    0     0                    5490.6157660 20289.2901   270%     -  364s
     0     0 20289.2901    0  416 5490.61577 20289.2901   270%     -  365s
     0     0 20274.7687    0  408 5490.61577 20274.7687   269%     -  372s
     0     0 20266.4021    0  413 5490.61577 20266.4021   269%     -  378s
     0     0 20257.5951    0  421 5490.61577 20257.5951   269%     -  383s
     0     0 20251.9542    0  416 5490.61577 20251.9542   269%     -  388s
     0     0 20250.0484    0  415 5490.61577 20250.0484   269%     -  390s
H    0     0                    5784.2010412 20250.0484   250%     -  411s
H    0     0                    5893.2297752 20250.0484   244%     -  411s
H    0     0                    5955.4708504 20250.0484   240%     -  411s
H    0     0                    5960.8267661 20250.0484   240%     -  411s
H    0     0                    6181.1290721 20250.0484   228%     -  411s
     0     0 18459.6585    0  342 6181.12907 18459.6585   199%     -  475s
H    0     0                    6277.0832253 18459.5130   194%     -  476s
     0     0 17998.9240    0  352 6277.08323 17998.9240   187%     -  508s
     0     0 17811.0814    0  344 6277.08323 17811.0814   184%     -  534s
     0     0 17752.9227    0  346 6277.08323 17752.9227   183%     -  546s
     0     0 17697.9484    0  341 6277.08323 17697.9484   182%     -  555s
     0     0 17635.7775    0  330 6277.08323 17635.7775   181%     -  566s
     0     0 17612.0747    0  345 6277.08323 17612.0747   181%     -  573s
     0     0 17579.3050    0  342 6277.08323 17579.3050   180%     -  583s
     0     0 17567.0926    0  351 6277.08323 17567.0926   180%     -  589s
     0     0 17552.9770    0  338 6277.08323 17552.9770   180%     -  594s
     0     0 17516.4316    0  352 6277.08323 17516.4316   179%     -  600s
     0     0 17505.7438    0  344 6277.08323 17505.7438   179%     -  606s
     0     0 17499.0074    0  344 6277.08323 17499.0074   179%     -  611s
     0     0 17498.1004    0  350 6277.08323 17498.1004   179%     -  613s
     0     0 16454.4151    0  361 6277.08323 16454.4151   162%     -  662s
     0     0 16246.6497    0  342 6277.08323 16246.6497   159%     -  686s
     0     0 16195.0349    0  361 6277.08323 16195.0349   158%     -  697s
     0     0 16077.6548    0  364 6277.08323 16077.6548   156%     -  711s
     0     0 15806.4248    0  391 6277.08323 15806.4248   152%     -  725s
     0     0 15751.6954    0  382 6277.08323 15751.6954   151%     -  737s
     0     0 15738.0575    0  393 6277.08323 15738.0575   151%     -  744s
     0     0 15731.2638    0  452 6277.08323 15731.2638   151%     -  748s
     0     0 15709.4489    0  454 6277.08323 15709.4489   150%     -  755s
     0     0 15704.6803    0  455 6277.08323 15704.6803   150%     -  759s
     0     0 15683.2333    0  448 6277.08323 15683.2333   150%     -  765s
     0     0 15676.0295    0  384 6277.08323 15676.0295   150%     -  770s
     0     0 15673.8933    0  444 6277.08323 15673.8933   150%     -  772s
     0     0 15370.3423    0  501 6277.08323 15370.3423   145%     -  795s
     0     0 15282.1234    0  452 6277.08323 15282.1234   143%     -  808s
     0     0 15239.6108    0  458 6277.08323 15239.6108   143%     -  820s
     0     0 15216.0068    0  458 6277.08323 15216.0068   142%     -  827s
     0     0 15207.4412    0  465 6277.08323 15207.4412   142%     -  831s
     0     0 15200.6765    0  517 6277.08323 15200.6765   142%     -  834s
     0     0 15179.0315    0  515 6277.08323 15179.0315   142%     -  842s
     0     0 15169.3076    0  409 6277.08323 15169.3076   142%     -  847s
H    0     0                    6345.7826909 15164.6389   139%     -  851s
     0     0 15164.6389    0  463 6345.78269 15164.6389   139%     -  851s
     0     0 15159.6375    0  525 6345.78269 15159.6375   139%     -  856s
     0     0 15152.6967    0  528 6345.78269 15152.6967   139%     -  860s
     0     0 15151.3474    0  471 6345.78269 15151.3474   139%     -  862s
     0     0 15010.6634    0  438 6345.78269 15010.6634   137%     -  879s
H    0     0                    6399.9216902 15009.6242   135%     -  905s
H    0     0                    6463.6162485 15009.6242   132%     -  905s
H    0     0                    6466.0254789 15009.6242   132%     -  905s
     0     0 14967.4589    0  456 6466.02548 14967.4589   131%     -  919s
     0     0 14951.1168    0  459 6466.02548 14951.1168   131%     -  925s
     0     0 14942.9511    0  468 6466.02548 14942.9511   131%     -  930s
     0     0 14933.1422    0  465 6466.02548 14933.1422   131%     -  937s
     0     0 14917.5139    0  514 6466.02548 14917.5139   131%     -  946s
     0     0 14914.0094    0  516 6466.02548 14914.0094   131%     -  950s
     0     0 14912.3476    0  514 6466.02548 14912.3476   131%     -  952s
     0     0 14760.7563    0  460 6466.02548 14760.7563   128%     -  974s
     0     0 14728.6498    0  464 6466.02548 14728.6498   128%     -  985s
     0     0 14710.2211    0  448 6466.02548 14710.2211   128%     -  992s
     0     0 14705.4682    0  435 6466.02548 14705.4682   127%     -  995s
     0     0 14699.4471    0  493 6466.02548 14699.4471   127%     -  999s
     0     0 14698.1389    0  379 6466.02548 14698.1389   127%     - 1001s
     0     0 14646.0498    0  513 6466.02548 14646.0498   127%     - 1013s
     0     0 14626.0035    0  450 6466.02548 14626.0035   126%     - 1024s
     0     0 14615.0688    0  516 6466.02548 14615.0688   126%     - 1030s
     0     0 14610.7990    0  528 6466.02548 14610.7990   126%     - 1034s
     0     0 14609.8814    0  527 6466.02548 14609.8814   126%     - 1036s
     0     0 14526.7295    0  467 6466.02548 14526.7295   125%     - 1050s
     0     0 14514.5642    0  453 6466.02548 14514.5642   124%     - 1056s
     0     0 14503.1943    0  461 6466.02548 14503.1943   124%     - 1061s
     0     0 14498.8856    0  458 6466.02548 14498.8856   124%     - 1064s
     0     0 14496.5534    0  459 6466.02548 14496.5534   124%     - 1067s
     0     0 14474.3493    0  454 6466.02548 14474.3493   124%     - 1077s
     0     0 14463.3609    0  513 6466.02548 14463.3609   124%     - 1087s
     0     0 14459.9911    0  468 6466.02548 14459.9911   124%     - 1090s
     0     0 14457.6847    0  519 6466.02548 14457.6847   124%     - 1092s
     0     0 14429.8237    0  446 6466.02548 14429.8237   123%     - 1101s
     0     0 14422.5658    0  457 6466.02548 14422.5658   123%     - 1105s
     0     0 14419.8940    0  454 6466.02548 14419.8940   123%     - 1107s
     0     0 14410.8371    0  410 6466.02548 14410.8371   123%     - 1113s
     0     0 14406.5181    0  406 6466.02548 14406.5181   123%     - 1117s
     0     0 14404.4061    0  403 6466.02548 14404.4061   123%     - 1119s
     0     0 14392.5966    0  405 6466.02548 14392.5966   123%     - 1123s
     0     0 14392.2455    0  405 6466.02548 14392.2455   123%     - 1128s
     0     2 14392.2358    0  405 6466.02548 14392.2358   123%     - 1280s
     1     3 12734.9741    1  346 6466.02548 14391.7855   123% 16000 1311s
     2     5 12535.9770    2  333 6466.02548 14391.7855   123% 11643 1321s
     4     9 12350.1129    3  340 6466.02548 14314.8245   121%  9394 1338s
     8    18 13047.9258    3  384 6466.02548 14314.7154   121%  9435 1362s
    17    36 12803.1807    4  366 6466.02548 14090.1563   118% 10599 1393s
    35    50 13051.7471    4  407 6466.02548 13857.1396   114% 13716 1450s
    49    76 12107.4794    5  414 6466.02548 13857.1396   114% 14986 1489s
    77   182 11750.1988    6  407 6466.02548 13857.1396   114% 12919 1526s
   187   215 11682.8043   10  389 6466.02548 13857.1396   114%  8204 1552s
   224   234 9837.80674   11  308 6466.02548 13857.1396   114%  7957 1601s
H  231   234                    6492.1457872 13857.1396   113%  7877 1601s
   266   258 6588.69403   12  314 6492.14579 13857.1396   113%  7452 1627s
   343   260 infeasible   13      6492.14579 13857.1396   113%  7026 1652s
   409   276 8841.04496   13  272 6492.14579 13857.1396   113%  7230 1677s
H  424   276                    6524.5014683 13857.1396   112%  7382 1677s
   457   300 8531.78899   14  210 6524.50147 13857.1396   112%  7576 1701s
   525   316     cutoff   15      6524.50147 13857.1396   112%  7730 1723s
   587   336 infeasible   21      6524.50147 13857.1396   112%  7636 1746s
   648   345     cutoff   12      6524.50147 13857.1396   112%  7686 1769s
   693   356 infeasible   19      6524.50147 13857.1396   112%  7782 1794s
   736   367 7528.95832   17  272 6524.50147 13857.1396   112%  7912 1817s
   779   386 6945.42863   18  310 6524.50147 13857.1396   112%  7900 1838s
   834   412 6840.70441   19  304 6524.50147 13857.1396   112%  7781 1861s
   897   435 infeasible   20      6524.50147 13857.1396   112%  7695 1885s
   968   439 infeasible   22      6524.50147 13857.1396   112%  7630 1912s
  1023   457 infeasible   21      6524.50147 13640.4171   109%  7538 1933s
  1089   472 12393.4746    5  369 6524.50147 13640.4171   109%  7483 1959s
  1154   498 8416.96388   12  246 6524.50147 13640.4171   109%  7463 1987s
  1219   514 12389.3050    5  414 6524.50147 13640.4171   109%  7534 2015s
  1287   552 12124.8179    6  419 6524.50147 13365.2371   105%  7558 2045s
  1365   585 10991.3773    7  201 6524.50147 13365.2371   105%  7583 2071s
  1450   587 12038.9537    7  419 6524.50147 13365.2371   105%  7547 2101s
  1549   608 10349.7041    8  282 6524.50147 12742.6614  95.3%  7460 2130s
  1620   632 8152.76918    9  322 6524.50147 12742.6614  95.3%  7498 2162s
  1720   647 8858.51576    8  150 6524.50147 12742.6614  95.3%  7423 2197s
  1795   700 infeasible    9      6524.50147 12742.6614  95.3%  7498 2231s
  1910   735 infeasible   12      6524.50147 12742.6614  95.3%  7454 2269s
  1987   775 infeasible   13      6524.50147 12319.5326  88.8%  7457 2310s
  2095   827 infeasible   15      6524.50147 12319.5326  88.8%  7409 2356s
  2207   865 6721.15306   16  318 6524.50147 12319.5326  88.8%  7446 2393s
  2319   904 7019.42991   12  339 6524.50147 12319.5326  88.8%  7443 2433s
  2394   980     cutoff   13      6524.50147 12319.5326  88.8%  7487 2472s
  2502  1059 infeasible   14      6524.50147 11393.2128  74.6%  7503 2519s
  2676  1114 7887.88767    9  258 6524.50147 11393.2128  74.6%  7414 2566s
  2848  1159 7462.82407   12  293 6524.50147 11393.2128  74.6%  7331 2617s
  3012  1250 6702.72870   14  286 6524.50147 11393.2128  74.6%  7307 2672s
  3217  1301 infeasible   12      6524.50147 11393.2128  74.6%  7248 2720s
  3407  1358 6724.00271   15  335 6524.50147 11393.2128  74.6%  7239 2770s
  3591  1417 infeasible   17      6524.50147 11245.7160  72.4%  7231 2821s
  3763  1464     cutoff   19      6524.50147 11245.7160  72.4%  7265 2877s
  3947  1479 infeasible   12      6524.50147 10859.4345  66.4%  7296 2934s
  4009  1496 9506.44149   11  297 6524.50147 10859.4345  66.4%  7314 2996s
  4121  1547 8704.67538   12  272 6524.50147 10859.4345  66.4%  7291 3055s
  4268  1589 8195.53199   13  239 6524.50147 10859.4345  66.4%  7301 3113s
  4423  1622 7228.18616   14  252 6524.50147 10745.2647  64.7%  7288 3178s
  4591  1693 7170.20525   15  259 6524.50147 10673.2631  63.6%  7321 3237s
  4754  1765 6929.31708   16  309 6524.50147 10673.2631  63.6%  7329 3309s
  4980  1816 6619.68983   17  134 6524.50147 10513.2801  61.1%  7335 3385s
  5239  1891 6618.71034   18  132 6524.50147 10317.0031  58.1%  7324 3461s
  5520  1949     cutoff   18      6524.50147 10142.5612  55.5%  7276 3541s
  5691  2037 8227.11614   14  244 6524.50147 9952.36255  52.5%  7316 3600s

Cutting planes:
  Learned: 1
  Gomory: 31
  Implied bound: 196
  MIR: 2472
  Flow cover: 2540
  RLT: 127
  Relax-and-lift: 933

Explored 5971 nodes (44111799 simplex iterations) in 3600.06 seconds (6136.92 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6524.5 6492.15 6466.03 ... 5955.47

Time limit reached
Best objective 6.524501468318e+03, best bound 9.920546725528e+03, gap 52.0506%
  WARNING: Time limit reached. Using best solution found (gap: 52.05%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 6524.50, θ = 135116.90
  Upper Bound (UB) = 6524.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135116.90
  [DEBUG]   ✓ Scenario 0: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135116.90 ≤ Q = 135116.90 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7aa8f8b2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7aa8f8b2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.476448e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6578845.3714
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.356220e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135622.02    0  123 6578845.37 -135622.02   102%     -    0s
H    0     0                    -106784.3941 -135622.02  27.0%     -    0s
H    0     0                    -106937.5551 -135622.02  26.8%     -    0s
     0     0 -114738.88    0   75 -106937.56 -114738.88  7.30%     -    0s
H    0     0                    -112044.7342 -114635.77  2.31%     -    0s
     0     0 -114002.00    0   74 -112044.73 -114002.00  1.75%     -    0s
H    0     0                    -112792.6407 -113984.96  1.06%     -    0s
     0     0 -113923.91    0   76 -112792.64 -113923.91  1.00%     -    0s
H    0     0                    -112794.8783 -113923.91  1.00%     -    0s
     0     0 -113373.66    0   56 -112794.88 -113373.66  0.51%     -    0s
     0     0 -113301.73    0   61 -112794.88 -113301.73  0.45%     -    0s
     0     0 -113288.66    0   53 -112794.88 -113288.66  0.44%     -    0s
     0     0 -113111.90    0   47 -112794.88 -113111.90  0.28%     -    0s
     0     0 -113094.43    0   38 -112794.88 -113094.43  0.27%     -    0s
     0     0 -113092.84    0   38 -112794.88 -113092.84  0.26%     -    0s
     0     0 -112990.63    0   13 -112794.88 -112990.63  0.17%     -    0s
H    0     0                    -112840.6434 -112987.58  0.13%     -    0s
     0     0 -112982.86    0   17 -112840.64 -112982.86  0.13%     -    0s
     0     0 -112947.88    0   15 -112840.64 -112947.88  0.10%     -    0s
     0     0 -112947.88    0   13 -112840.64 -112947.88  0.10%     -    0s
     0     0 -112888.71    0    2 -112840.64 -112888.71  0.04%     -    0s
H    0     0                    -112886.0262 -112888.08  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 2
  MIR: 1
  Flow cover: 6
  Relax-and-lift: 3

Explored 1 nodes (732 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -112886 -112841 -112795 ... 1.47645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.128860262372e+05, best bound -1.128880841727e+05, gap 0.0018%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 130498.52
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112886.03
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -112886.03 = 130498.52
  [DEBUG]   Current θ from Master = 135116.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4618.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1906.12
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 344.0718, Absolute Gap = 344.0718, Relative Gap = 0.052735
  Not converged yet (gap = 344.07 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567210 nonzeros
Model fingerprint: 0x1d27badf
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 102414 rows and 41574 columns
Presolve time: 3.17s
Presolved: 97739 rows, 41806 columns, 595602 nonzeros
Variable types: 39547 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378310.3330
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.837e+06
 Factor NZ  : 8.753e+06 (roughly 130 MB of memory)
 Factor Ops : 1.681e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.71767526e+07  1.81875473e+08  8.24e+04 2.02e+01  7.24e+04     5s
   1  -1.30952300e+07  1.57957888e+08  5.81e+04 6.44e+01  5.05e+04     5s
   2  -4.42023362e+06  1.20824957e+08  1.90e+04 6.34e-01  1.73e+04     5s
   3  -1.03828227e+06  8.43727318e+07  2.53e+03 1.65e+00  2.62e+03     5s
   4  -5.41376982e+05  5.46351915e+07  5.07e+02 8.19e-01  7.16e+02     5s
   5  -4.49284746e+05  3.32434908e+07  2.49e+02 4.19e-01  3.70e+02     5s
   6  -3.80387996e+05  2.30145504e+07  1.19e+02 2.65e-01  2.11e+02     5s
   7  -2.65627550e+05  1.75732120e+07  3.52e+01 1.92e-01  1.21e+02     6s
   8  -1.29947413e+05  1.23580863e+07  5.21e+00 1.32e-01  7.22e+01     6s
   9  -9.13104608e+04  4.89657578e+06  2.63e+00 4.97e-02  2.84e+01     6s
  10  -6.14075325e+04  2.68345521e+06  1.32e+00 2.69e-02  1.55e+01     6s
  11  -3.93386168e+04  1.50325141e+06  6.83e-01 1.46e-02  8.66e+00     6s
  12  -2.30976344e+04  6.25570496e+05  4.30e-01 5.65e-03  3.63e+00     6s
  13  -1.36541807e+04  3.28444282e+05  2.74e-01 2.97e-03  1.91e+00     6s
  14  -2.67545873e+03  1.94341216e+05  1.52e-01 1.66e-03  1.10e+00     6s
  15   1.45608454e+03  1.55051121e+05  1.23e-01 1.32e-03  8.58e-01     6s
  16   6.27188161e+03  1.06160641e+05  9.57e-02 9.05e-04  5.58e-01     6s
  17   9.14766275e+03  9.13979246e+04  8.24e-02 7.95e-04  4.59e-01     6s
  18   1.40062525e+04  7.26137344e+04  6.12e-02 2.26e-03  3.27e-01     6s
  19   1.83570615e+04  5.85380432e+04  4.50e-02 2.01e-03  2.24e-01     7s
  20   2.15154767e+04  5.32728450e+04  3.44e-02 1.59e-03  1.77e-01     7s
  21   2.32276405e+04  4.70249111e+04  2.91e-02 1.57e-03  1.33e-01     7s
  22   2.55571504e+04  4.14900194e+04  2.22e-02 1.70e-03  8.90e-02     7s
  23   2.72535986e+04  3.86687235e+04  1.75e-02 1.21e-03  6.38e-02     7s
  24   2.92753704e+04  3.72597264e+04  1.19e-02 8.50e-04  4.46e-02     7s
  25   3.04961540e+04  3.58217661e+04  8.59e-03 4.69e-04  2.98e-02     7s
  26   3.14442539e+04  3.51132661e+04  6.14e-03 2.92e-04  2.05e-02     7s
  27   3.22746944e+04  3.48717944e+04  3.99e-03 2.46e-04  1.45e-02     7s
  28   3.27105088e+04  3.46154060e+04  2.89e-03 1.80e-04  1.06e-02     7s
  29   3.30037461e+04  3.44151092e+04  2.16e-03 1.27e-04  7.88e-03     8s
  30   3.33478917e+04  3.42481132e+04  1.30e-03 7.87e-05  5.03e-03     8s
  31   3.35537808e+04  3.41621531e+04  8.08e-04 6.88e-05  3.40e-03     8s
  32   3.37192314e+04  3.41198611e+04  4.25e-04 5.65e-05  2.24e-03     8s
  33   3.37600184e+04  3.40416233e+04  3.27e-04 3.42e-05  1.57e-03     8s
  34   3.38411502e+04  3.39852571e+04  1.50e-04 1.96e-05  8.05e-04     8s
  35   3.39030025e+04  3.39258072e+04  2.39e-05 6.45e-06  1.27e-04     8s
  36   3.39071768e+04  3.39186536e+04  1.68e-05 1.46e-06  6.41e-05     8s
  37   3.39134253e+04  3.39176831e+04  5.44e-06 6.43e-07  2.38e-05     8s
  38   3.39157840e+04  3.39167839e+04  1.27e-06 1.00e-07  5.58e-06     8s
  39   3.39165691e+04  3.39165771e+04  4.30e-08 3.09e-08  4.46e-08     9s
  40   3.39165758e+04  3.39165758e+04  5.76e-09 6.42e-11  3.44e-10     9s

Barrier solved model in 40 iterations and 8.68 seconds (7.66 work units)
Optimal objective 3.39165758e+04


Root crossover log...

   79757 DPushes remaining with DInf 0.0000000e+00                 9s
   27584 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    4407 PPushes remaining with PInf 1.4120493e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.7626007e+00     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36896    3.3916576e+04   0.000000e+00   7.762601e+00     13s
   36927    3.3916576e+04   0.000000e+00   0.000000e+00     13s
   36927    3.3916576e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.391658e+04, 36927 iterations, 9.26 seconds (12.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33916.5758    0  372 -170236.42 33916.5758   120%     -   14s
H    0     0                    -154753.8466 33916.5758   122%     -   15s
H    0     0                    -124977.7710 33916.5758   127%     -   16s
H    0     0                    -124816.8742 33916.5758   127%     -   17s
H    0     0                    -124795.9180 33916.5758   127%     -   17s
H    0     0                    -82339.47572 33916.5758   141%     -   17s
H    0     0                    -43201.41023 33916.5758   179%     -   17s
H    0     0                    -41280.06363 33916.5758   182%     -   17s
H    0     0                    -36821.83849 33916.5758   192%     -   19s
H    0     0                    -36716.31694 33916.5758   192%     -   19s
H    0     0                    -22580.25150 26511.4071   217%     -  105s
H    0     0                    -20464.46017 26511.4071   230%     -  105s
H    0     0                    -19212.44152 26511.4071   238%     -  105s
H    0     0                    -19151.27939 26511.4071   238%     -  105s
H    0     0                    -19056.42947 26511.4071   239%     -  105s
     0     0 26511.4071    0  394 -19056.429 26511.4071   239%     -  106s
H    0     0                    -17228.17420 26511.4068   254%     -  106s
H    0     0                    -16920.91362 26511.4068   257%     -  107s
H    0     0                    -15336.33861 26511.4068   273%     -  107s
     0     0 26265.7949    0  480 -15336.339 26265.7949   271%     -  130s
     0     0 26245.7750    0  482 -15336.339 26245.7750   271%     -  136s
     0     0 26232.6255    0  472 -15336.339 26232.6255   271%     -  141s
     0     0 26230.9188    0  482 -15336.339 26230.9188   271%     -  144s
     0     0 26226.3855    0  438 -15336.339 26226.3855   271%     -  146s
     0     0 26224.6932    0  440 -15336.339 26224.6932   271%     -  149s
     0     0 26224.6544    0  440 -15336.339 26224.6544   271%     -  151s
H    0     0                    2484.8636441 22489.7620   805%     -  254s
H    0     0                    4036.2097969 22489.7620   457%     -  254s
H    0     0                    5291.5899527 22489.7620   325%     -  254s
H    0     0                    5349.2288758 22489.7620   320%     -  254s
H    0     0                    5684.8741853 22489.7620   296%     -  254s
H    0     0                    5905.8341730 22489.7620   281%     -  254s
H    0     0                    6096.0440976 22489.7620   269%     -  254s
     0     0 22489.7620    0  381 6096.04410 22489.7620   269%     -  254s
     0     0 21682.3947    0  475 6096.04410 21682.3947   256%     -  312s
     0     0 21436.3578    0  441 6096.04410 21436.3578   252%     -  351s
     0     0 21198.0777    0  458 6096.04410 21198.0777   248%     -  378s
     0     0 21067.1119    0  498 6096.04410 21067.1119   246%     -  403s
     0     0 20718.5128    0  504 6096.04410 20718.5128   240%     -  441s
     0     0 20645.6685    0  526 6096.04410 20645.6685   239%     -  463s
     0     0 20597.2344    0  531 6096.04410 20597.2344   238%     -  478s
     0     0 20539.1856    0  479 6096.04410 20539.1856   237%     -  497s
     0     0 20509.5170    0  477 6096.04410 20509.5170   236%     -  507s
     0     0 20471.2958    0  481 6096.04410 20471.2958   236%     -  519s
     0     0 20464.2254    0  481 6096.04410 20464.2254   236%     -  524s
     0     0 20462.3583    0  483 6096.04410 20462.3583   236%     -  527s
     0     0 20460.7316    0  483 6096.04410 20460.7316   236%     -  529s
H    0     0                    6115.7494232 18397.6378   201%     -  612s
     0     0 18397.6378    0  367 6115.74942 18397.6378   201%     -  612s
H    0     0                    6137.8508746 18397.4111   200%     -  613s
H    0     0                    6181.1290721 18397.4111   198%     -  613s
     0     0 17762.2741    0  363 6181.12907 17762.2741   187%     -  640s
     0     0 17606.0479    0  351 6181.12907 17606.0479   185%     -  661s
     0     0 17546.7628    0  362 6181.12907 17546.7628   184%     -  674s
     0     0 17524.6336    0  361 6181.12907 17524.6336   184%     -  687s
     0     0 17502.1861    0  366 6181.12907 17502.1861   183%     -  696s
     0     0 17498.1347    0  368 6181.12907 17498.1347   183%     -  699s
     0     0 17463.4681    0  359 6181.12907 17463.4681   183%     -  712s
     0     0 17434.0131    0  423 6181.12907 17434.0131   182%     -  725s
     0     0 17416.6495    0  361 6181.12907 17416.6495   182%     -  733s
     0     0 17409.9404    0  361 6181.12907 17409.9404   182%     -  739s
     0     0 17402.5111    0  363 6181.12907 17402.5111   182%     -  743s
     0     0 17393.5488    0  363 6181.12907 17393.5488   181%     -  748s
     0     0 17383.6999    0  368 6181.12907 17383.6999   181%     -  753s
     0     0 17380.0245    0  364 6181.12907 17380.0245   181%     -  756s
     0     0 17372.5806    0  361 6181.12907 17372.5806   181%     -  759s
     0     0 17371.6947    0  363 6181.12907 17371.6947   181%     -  761s
     0     0 16699.6491    0  367 6181.12907 16699.6491   170%     -  806s
     0     0 16396.1617    0  364 6181.12907 16396.1617   165%     -  833s
     0     0 16321.4441    0  368 6181.12907 16321.4441   164%     -  846s
     0     0 16296.0307    0  368 6181.12907 16296.0307   164%     -  856s
     0     0 16290.8023    0  374 6181.12907 16290.8023   164%     -  859s
     0     0 16272.2663    0  365 6181.12907 16272.2663   163%     -  866s
     0     0 16264.2490    0  369 6181.12907 16264.2490   163%     -  873s
     0     0 16249.0141    0  372 6181.12907 16249.0141   163%     -  880s
     0     0 16234.5584    0  420 6181.12907 16234.5584   163%     -  886s
     0     0 16228.7979    0  417 6181.12907 16228.7979   163%     -  890s
     0     0 16224.6946    0  456 6181.12907 16224.6946   162%     -  894s
     0     0 16223.6445    0  457 6181.12907 16223.6445   162%     -  897s
H    0     0                    6277.0832253 15943.3407   154%     -  928s
     0     0 15943.3407    0  470 6277.08323 15943.3407   154%     -  928s
H    0     0                    6345.7826909 15943.3206   151%     -  929s
     0     0 15884.4328    0  431 6345.78269 15884.4328   150%     -  945s
     0     0 15864.7131    0  431 6345.78269 15864.7131   150%     -  955s
     0     0 15835.6704    0  431 6345.78269 15835.6704   150%     -  963s
     0     0 15827.5022    0  376 6345.78269 15827.5022   149%     -  967s
     0     0 15754.6414    0  424 6345.78269 15754.6414   148%     -  977s
     0     0 15751.2391    0  413 6345.78269 15751.2391   148%     -  980s
     0     0 15749.2460    0  428 6345.78269 15749.2460   148%     -  982s
     0     0 15666.6809    0  447 6345.78269 15666.6809   147%     - 1004s
     0     0 15606.1858    0  489 6345.78269 15606.1858   146%     - 1035s
     0     0 15558.8551    0  513 6345.78269 15558.8551   145%     - 1045s
     0     0 15539.3501    0  502 6345.78269 15539.3501   145%     - 1052s
     0     0 15537.6180    0  508 6345.78269 15537.6180   145%     - 1054s
     0     0 15327.3826    0  501 6345.78269 15327.3826   142%     - 1077s
     0     0 15185.8487    0  458 6345.78269 15185.8487   139%     - 1089s
     0     0 15164.5682    0  459 6345.78269 15164.5682   139%     - 1099s
     0     0 15157.2716    0  453 6345.78269 15157.2716   139%     - 1104s
     0     0 15150.0732    0  454 6345.78269 15150.0732   139%     - 1110s
     0     0 15135.0147    0  460 6345.78269 15135.0147   139%     - 1116s
     0     0 15124.7264    0  450 6345.78269 15124.7264   138%     - 1123s
     0     0 15120.2396    0  478 6345.78269 15120.2396   138%     - 1128s
     0     0 15117.9549    0  455 6345.78269 15117.9549   138%     - 1130s
     0     0 15012.5419    0  403 6345.78269 15012.5419   137%     - 1147s
H    0     0                    6402.3309206 15012.4809   134%     - 1160s
     0     0 14978.1573    0  400 6402.33092 14978.1573   134%     - 1168s
     0     0 14969.1359    0  413 6402.33092 14969.1359   134%     - 1172s
     0     0 14960.6100    0  408 6402.33092 14960.6100   134%     - 1179s
     0     0 14953.2036    0  412 6402.33092 14953.2036   134%     - 1184s
     0     0 14950.9010    0  416 6402.33092 14950.9010   134%     - 1186s
     0     0 14846.2836    0  464 6402.33092 14846.2836   132%     - 1207s
     0     0 14823.9981    0  459 6402.33092 14823.9981   132%     - 1215s
     0     0 14806.4969    0  409 6402.33092 14806.4969   131%     - 1225s
     0     0 14791.5752    0  400 6402.33092 14791.5752   131%     - 1232s
     0     0 14780.7366    0  408 6402.33092 14780.7366   131%     - 1238s
     0     0 14776.5497    0  404 6402.33092 14776.5497   131%     - 1242s
     0     0 14775.7862    0  414 6402.33092 14775.7862   131%     - 1244s
     0     0 14735.2401    0  414 6402.33092 14735.2401   130%     - 1259s
     0     0 14728.1413    0  405 6402.33092 14728.1413   130%     - 1265s
     0     0 14704.2224    0  430 6402.33092 14704.2224   130%     - 1274s
     0     0 14698.0894    0  417 6402.33092 14698.0894   130%     - 1279s
     0     0 14696.8579    0  409 6402.33092 14696.8579   130%     - 1280s
     0     0 14676.4039    0  405 6402.33092 14676.4039   129%     - 1289s
     0     0 14669.4601    0  417 6402.33092 14669.4601   129%     - 1296s
     0     0 14667.7125    0  409 6402.33092 14667.7125   129%     - 1298s
     0     0 14641.5354    0  403 6402.33092 14641.5354   129%     - 1311s
     0     0 14631.8710    0  417 6402.33092 14631.8710   129%     - 1317s
     0     0 14626.4240    0  416 6402.33092 14626.4240   128%     - 1321s
     0     0 14624.7268    0  410 6402.33092 14624.7268   128%     - 1323s
     0     0 14601.0386    0  401 6402.33092 14601.0386   128%     - 1332s
     0     0 14583.0081    0  408 6402.33092 14583.0081   128%     - 1341s
     0     0 14574.9260    0  419 6402.33092 14574.9260   128%     - 1347s
     0     0 14571.4444    0  413 6402.33092 14571.4444   128%     - 1352s
     0     0 14569.8665    0  416 6402.33092 14569.8665   128%     - 1354s
     0     0 14537.7239    0  409 6402.33092 14537.7239   127%     - 1369s
H    0     0                    6466.0254789 14537.6388   125%     - 1435s
     0     0 14524.1239    0  410 6466.02548 14524.1239   125%     - 1462s
     0     0 14521.7217    0  417 6466.02548 14521.7217   125%     - 1466s
     0     0 14494.9794    0  412 6466.02548 14494.9794   124%     - 1479s
     0     0 14486.4137    0  410 6466.02548 14486.4137   124%     - 1489s
     0     0 14480.0085    0  420 6466.02548 14480.0085   124%     - 1497s
     0     0 14478.0702    0  428 6466.02548 14478.0702   124%     - 1500s
     0     0 14461.9349    0  428 6466.02548 14461.9349   124%     - 1513s
     0     0 14458.2930    0  430 6466.02548 14458.2930   124%     - 1520s
     0     0 14451.7547    0  428 6466.02548 14451.7547   124%     - 1524s
     0     0 14451.2094    0  426 6466.02548 14451.2094   123%     - 1526s
     0     0 14446.8287    0  436 6466.02548 14446.8287   123%     - 1531s
     0     0 14446.7509    0  436 6466.02548 14446.7509   123%     - 1536s
     0     2 14446.3748    0  436 6466.02548 14446.3748   123%     - 1666s
     1     3 13111.6990    1  313 6466.02548 14446.1034   123% 11792 1690s
     2     6 13011.4229    2  322 6466.02548 14446.1034   123%  8496 1703s
     5     9 13770.9450    2  406 6466.02548 14359.4864   122%  9654 1741s
     8    17 11420.9393    4  307 6466.02548 14359.4864   122% 11468 1766s
    16    33 11158.8506    5  305 6466.02548 14115.3759   118%  9645 1789s
    32    51 9086.87642    6  183 6466.02548 14115.3759   118% 14081 2970s
    50    81 9085.26171    6  198 6466.02548 14115.3759   118% 19189 3030s
H   76    81                    6494.0888178 14115.3759   117% 15445 3030s
    82   182 9063.55509    7  197 6494.08882 14115.3759   117% 14810 3075s
   213   246 8526.08677    9  167 6494.08882 14115.3759   117%  7982 3095s
   337   273 8490.85989   10  173 6494.08882 14115.3759   117%  6344 3114s
   423   277 infeasible   11      6494.08882 14115.3759   117%  5742 3134s
   498   271 7725.18930   13  153 6494.08882 14115.3759   117%  5273 3151s
   540   284 7667.86450   13  144 6494.08882 14115.3759   117%  5152 3169s
   583   309 7144.01034   15  139 6494.08882 14115.3759   117%  5092 3187s
   627   329     cutoff   17      6494.08882 14115.3759   117%  5215 3204s
   683   357     cutoff   18      6494.08882 14115.3759   117%  5252 3219s
   742   389 7762.74505   11  141 6494.08882 14115.3759   117%  5206 3236s
   809   414 7584.41529   12  108 6494.08882 14115.3759   117%  5045 3252s
   879   466 6852.17639   17   63 6494.08882 14115.3759   117%  4906 3267s
   971   500     cutoff   20      6494.08882 14115.3759   117%  4763 3284s
  1062   499 7595.88538   22  235 6494.08882 14115.3759   117%  4617 3302s
  1127   489     cutoff   23      6494.08882 14115.3759   117%  4627 3321s
  1175   489 7321.40803   23  234 6494.08882 14115.3759   117%  4751 3340s
  1221   491 6931.76707   25  211 6494.08882 14115.3759   117%  4753 3361s
  1255   494 infeasible   24      6494.08882 14059.4666   116%  4831 3382s
  1298   498 12857.5299    4  398 6494.08882 14059.4666   116%  4890 3405s
  1336   530 9189.56354   15  269 6494.08882 14059.4666   116%  4943 3427s
  1382   553 infeasible   13      6494.08882 14059.4666   116%  5035 3447s
  1435   576 infeasible   19      6494.08882 14059.4666   116%  5032 3468s
  1504   578 7609.53610   10   69 6494.08882 14059.4666   116%  5049 3491s
  1561   594 7484.44797   11   78 6494.08882 14059.4666   116%  5062 3516s
  1639   603 6880.27601   12   53 6494.08882 14059.4666   116%  5078 3541s
  1706   630 6792.97564   13   34 6494.08882 14059.4666   116%  5126 3566s
  1809   654 6889.88060   12   46 6494.08882 14059.4666   116%  5119 3592s
  1880   653 7675.60946   18  244 6494.08882 14059.4666   116%  5160 3600s

Cutting planes:
  Learned: 1
  Gomory: 30
  Implied bound: 166
  MIR: 2806
  Flow cover: 2807
  RLT: 119
  Relax-and-lift: 1081

Explored 1910 nodes (10633972 simplex iterations) in 3600.05 seconds (4499.46 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6494.09 6466.03 6402.33 ... 5905.83

Time limit reached
Best objective 6.494088817820e+03, best bound 1.405946663882e+04, gap 116.4964%
  WARNING: Time limit reached. Using best solution found (gap: 116.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 6494.09, θ = 135324.09
  Upper Bound (UB) = 6494.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135324.09
  [DEBUG]   ✓ Scenario 0: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135324.09 ≤ Q = 135324.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135324.09 ≤ Q = 137737.96 (slack: 2413.87)
  [DEBUG]   ✓ Scenario 7: θ = 135324.09 ≤ Q = 135324.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 135324.09 ≤ Q = 135324.09 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x144e8216
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xebb17dea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.476521e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6583094.1543
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.353942e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135394.20    0  123 6583094.15 -135394.20   102%     -    0s
H    0     0                    -106557.9316 -135394.20  27.1%     -    0s
H    0     0                    -106711.0927 -135394.20  26.9%     -    0s
     0     0 -111287.96    0   79 -106711.09 -111287.96  4.29%     -    0s
H    0     0                    -108878.0459 -111188.74  2.12%     -    0s
     0     0 -110772.85    0   78 -108878.05 -110772.85  1.74%     -    0s
H    0     0                    -109587.9413 -110533.51  0.86%     -    0s
     0     0 -110533.51    0   83 -109587.94 -110533.51  0.86%     -    0s
H    0     0                    -109680.9181 -110507.40  0.75%     -    0s
     0     0 -110507.40    0   83 -109680.92 -110507.40  0.75%     -    0s
     0     0 -110371.70    0   79 -109680.92 -110371.70  0.63%     -    0s
     0     0 -110337.90    0   79 -109680.92 -110337.90  0.60%     -    0s
H    0     0                    -109688.3107 -110337.90  0.59%     -    0s
     0     2 -110337.90    0   79 -109688.31 -110337.90  0.59%     -    0s
H  116    62                    -109699.8300 -110013.48  0.29%   7.8    0s
H  300    97                    -109741.7660 -109949.10  0.19%   6.8    0s
*  378    72              16    -109839.2138 -109892.03  0.05%   6.7    0s
H  480     5                    -109839.3057 -109892.03  0.05%   6.3    0s
*  491     5              14    -109864.5029 -109885.99  0.02%   6.2    0s

Cutting planes:
  Gomory: 32
  Implied bound: 6
  MIR: 177
  Flow cover: 5
  RLT: 35
  Relax-and-lift: 4
  BQP: 3

Explored 548 nodes (3763 simplex iterations) in 0.28 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -109865 -109839 -109839 ... -106711
No other solutions better than -109865

Optimal solution found (tolerance 1.00e-04)
Best objective -1.098645029012e+05, best bound -1.098645029012e+05, gap 0.0000%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 133520.04
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109864.50
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -109864.50 = 133520.04
  [DEBUG]   Current θ from Master = 135324.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1804.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4690.05
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 313.6592, Absolute Gap = 313.6592, Relative Gap = 0.048299
  Not converged yet (gap = 313.66 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610417 nonzeros
Model fingerprint: 0x451935c1
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 110292 rows and 44772 columns
Presolve time: 3.83s
Presolved: 105151 rows, 44848 columns, 638081 nonzeros
Variable types: 42589 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -380015.6695
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 4.263e+06
 Factor NZ  : 9.948e+06 (roughly 140 MB of memory)
 Factor Ops : 1.999e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.77172062e+07  1.94230916e+08  8.50e+04 1.95e+01  7.44e+04     6s
   1  -1.34787935e+07  1.69598936e+08  5.98e+04 6.53e+01  5.17e+04     6s
   2  -3.86944150e+06  1.30242558e+08  1.65e+04 7.24e-01  1.51e+04     6s
   3  -8.10052373e+05  9.10285446e+07  1.27e+03 1.93e-01  1.54e+03     6s
   4  -5.89214635e+05  3.16707823e+07  5.43e+02 5.41e-02  5.62e+02     6s
   5  -4.61844034e+05  2.25568183e+07  2.59e+02 3.03e-02  2.96e+02     6s
   6  -2.59361484e+05  1.73618351e+07  4.57e+01 2.17e-02  1.21e+02     6s
   7  -1.31592906e+05  1.16221145e+07  9.85e+00 1.37e-02  6.60e+01     6s
   8  -9.65912060e+04  7.88767990e+06  6.02e+00 9.14e-03  4.37e+01     6s
   9  -6.79373766e+04  3.83691169e+06  1.64e+00 4.24e-03  2.06e+01     7s
  10  -3.62158622e+04  1.75683268e+06  3.81e-01 1.89e-03  9.34e+00     7s
  11  -1.63878355e+04  6.10841089e+05  1.88e-01 7.87e-04  3.26e+00     7s
  12  -1.09899083e+04  3.77697581e+05  1.34e-01 5.81e-04  2.02e+00     7s
  13  -3.90420325e+03  2.44178244e+05  8.74e-02 3.35e-04  1.29e+00     7s
  14   8.51947194e+02  1.59136810e+05  6.49e-02 2.67e-04  8.22e-01     7s
  15   4.31153714e+03  1.32728325e+05  5.43e-02 4.29e-04  6.67e-01     7s
  16   8.36107405e+03  1.03046836e+05  4.41e-02 5.42e-04  4.92e-01     7s
  17   1.20050124e+04  8.77198547e+04  3.59e-02 9.02e-04  3.93e-01     7s
  18   1.70579560e+04  6.79339877e+04  2.59e-02 1.43e-03  2.64e-01     7s
  19   1.99433332e+04  5.83166857e+04  2.10e-02 1.03e-03  1.99e-01     8s
  20   2.25411289e+04  5.18479020e+04  1.70e-02 7.63e-04  1.52e-01     8s
  21   2.55657706e+04  4.82950406e+04  1.26e-02 5.96e-04  1.18e-01     8s
  22   2.70718126e+04  4.41674511e+04  1.06e-02 4.01e-04  8.88e-02     8s
  23   2.92913131e+04  4.20557311e+04  7.70e-03 3.04e-04  6.63e-02     8s
  24   3.04719885e+04  4.04307462e+04  6.27e-03 2.25e-04  5.17e-02     8s
  25   3.06967330e+04  3.96826216e+04  6.00e-03 1.92e-04  4.67e-02     8s
  26   3.18764176e+04  3.93855698e+04  4.63e-03 1.82e-04  3.90e-02     8s
  27   3.22832269e+04  3.85721738e+04  4.11e-03 1.87e-04  3.27e-02     9s
  28   3.26440907e+04  3.78587361e+04  3.66e-03 1.40e-04  2.71e-02     9s
  29   3.30489991e+04  3.76538460e+04  3.18e-03 1.25e-04  2.39e-02     9s
  30   3.33172514e+04  3.69936516e+04  2.86e-03 7.94e-05  1.91e-02     9s
  31   3.37370346e+04  3.67149074e+04  2.37e-03 5.86e-05  1.55e-02     9s
  32   3.40195974e+04  3.66595335e+04  2.04e-03 5.49e-05  1.37e-02     9s
  33   3.41504882e+04  3.64218082e+04  1.89e-03 3.93e-05  1.18e-02     9s
  34   3.45741715e+04  3.63490659e+04  1.42e-03 3.33e-05  9.22e-03    10s
  35   3.47480633e+04  3.62609695e+04  1.22e-03 2.76e-05  7.86e-03    10s
  36   3.47969023e+04  3.61765114e+04  1.16e-03 2.21e-05  7.17e-03    10s
  37   3.49925310e+04  3.61367551e+04  9.42e-04 1.99e-05  5.94e-03    10s
  38   3.50466571e+04  3.60681632e+04  8.77e-04 2.52e-05  5.31e-03    10s
  39   3.51453565e+04  3.60557031e+04  7.70e-04 2.39e-05  4.73e-03    10s
  40   3.51890059e+04  3.60144288e+04  7.22e-04 1.96e-05  4.29e-03    11s
  41   3.52516288e+04  3.60022364e+04  6.51e-04 1.84e-05  3.90e-03    11s
  42   3.53059633e+04  3.59781982e+04  5.87e-04 1.58e-05  3.49e-03    11s
  43   3.54390606e+04  3.59749472e+04  4.38e-04 1.54e-05  2.78e-03    11s
  44   3.54581215e+04  3.59386124e+04  4.15e-04 1.17e-05  2.50e-03    11s
  45   3.55517136e+04  3.59079543e+04  3.06e-04 8.19e-06  1.85e-03    11s
  46   3.56271772e+04  3.58769819e+04  2.20e-04 4.27e-06  1.30e-03    11s
  47   3.56805759e+04  3.58692271e+04  1.62e-04 3.53e-06  9.80e-04    12s
  48   3.57102408e+04  3.58657153e+04  1.29e-04 3.22e-06  8.07e-04    12s
  49   3.57660607e+04  3.58536216e+04  6.69e-05 2.13e-06  4.55e-04    12s
  50   3.57883533e+04  3.58352290e+04  4.28e-05 3.68e-07  2.43e-04    12s
  51   3.58206588e+04  3.58322091e+04  8.48e-06 1.43e-07  6.00e-05    12s
  52   3.58256355e+04  3.58307833e+04  3.71e-06 5.98e-08  2.67e-05    12s
  53   3.58262813e+04  3.58304675e+04  3.10e-06 4.18e-08  2.17e-05    12s
  54   3.58280784e+04  3.58300250e+04  1.44e-06 1.65e-08  1.01e-05    13s
  55   3.58294123e+04  3.58297910e+04  2.63e-07 6.79e-08  1.97e-06    13s
  56   3.58297281e+04  3.58297302e+04  8.90e-09 6.97e-09  1.11e-08    13s
  57   3.58297298e+04  3.58297298e+04  2.18e-10 5.08e-12  1.87e-12    13s

Barrier solved model in 57 iterations and 12.93 seconds (11.05 work units)
Optimal objective 3.58297298e+04


Root crossover log...

   84623 DPushes remaining with DInf 0.0000000e+00                13s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    2541 PPushes remaining with PInf 2.8647678e-07                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.4875519e-11     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29570    3.5829730e+04   0.000000e+00   0.000000e+00     15s
   29570    3.5829730e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.582973e+04, 29570 iterations, 10.49 seconds (10.93 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35829.7298    0  400 -170236.42 35829.7298   121%     -   16s
H    0     0                    -168656.1091 35829.7298   121%     -   16s
H    0     0                    -93229.33611 35829.7298   138%     -   16s
H    0     0                    -66292.46600 35829.7298   154%     -   16s
H    0     0                    -17766.03677 35829.7298   302%     -   16s
H    0     0                    -15157.28907 35829.7298   336%     -   17s
H    0     0                    -10775.86106 35829.7298   432%     -   17s
H    0     0                    -10152.21719 35829.7298   453%     -   17s
H    0     0                    -9248.130051 35829.7298   487%     -   17s
H    0     0                    -8572.593201 35829.7298   518%     -   17s
H    0     0                    -8176.467795 35829.7298   538%     -   17s
H    0     0                    -8161.629092 35829.7298   539%     -   17s
H    0     0                    -8114.487007 35829.7298   542%     -   17s
H    0     0                    -8102.753102 35829.7298   542%     -   17s
H    0     0                    -7968.833796 35829.7298   550%     -   19s
H    0     0                    -7906.853008 35829.7298   553%     -   19s
H    0     0                    -7769.609760 28134.9560   462%     -   73s
H    0     0                    -5460.035032 28134.9560   615%     -   73s
H    0     0                    -5395.418242 28134.9560   621%     -   73s
     0     0 28134.9560    0  356 -5395.4182 28134.9560   621%     -   73s
H    0     0                    1177.0393332 28133.0280  2290%     -   74s
H    0     0                    5798.0943078 28133.0280   385%     -   74s
     0     0 27611.7246    0  455 5798.09431 27611.7246   376%     -   98s
     0     0 27579.1747    0  459 5798.09431 27579.1747   376%     -  117s
     0     0 27579.1747    0  459 5798.09431 27579.1747   376%     -  122s
     0     0 27579.1747    0  454 5798.09431 27579.1747   376%     -  128s
     0     0 27579.1747    0  472 5798.09431 27579.1747   376%     -  135s
     0     0 27579.1747    0  470 5798.09431 27579.1747   376%     -  138s
     0     0 27579.1747    0  470 5798.09431 27579.1747   376%     -  138s
     0     0 22624.9211    0  446 5798.09431 22624.9211   290%     -  265s
     0     0 21720.9737    0  525 5798.09431 21720.9737   275%     -  350s
     0     0 21390.9327    0  506 5798.09431 21390.9327   269%     -  390s
     0     0 21160.0161    0  492 5798.09431 21160.0161   265%     -  418s
     0     0 21128.8343    0  501 5798.09431 21128.8343   264%     -  428s
     0     0 21105.0292    0  489 5798.09431 21105.0292   264%     -  438s
     0     0 21070.7448    0  494 5798.09431 21070.7448   263%     -  459s
     0     0 20893.8908    0  518 5798.09431 20893.8908   260%     -  490s
     0     0 20815.2609    0  509 5798.09431 20815.2609   259%     -  508s
     0     0 20793.5944    0  524 5798.09431 20793.5944   259%     -  518s
     0     0 20773.5928    0  520 5798.09431 20773.5928   258%     -  528s
H    0     0                    6151.5280086 20713.3994   237%     -  540s
H    0     0                    6153.0861869 20713.3994   237%     -  540s
H    0     0                    6198.9496759 20713.3994   234%     -  540s
H    0     0                    6220.2727427 20713.3994   233%     -  540s
     0     0 20713.3994    0  506 6220.27274 20713.3994   233%     -  540s
     0     0 20690.5248    0  512 6220.27274 20690.5248   233%     -  546s
     0     0 20686.5237    0  500 6220.27274 20686.5237   233%     -  551s
     0     0 20685.7109    0  519 6220.27274 20685.7109   233%     -  553s
     0     0 18548.6215    0  392 6220.27274 18548.6215   198%     -  686s
     0     0 18135.4844    0  431 6220.27274 18135.4844   192%     -  743s
     0     0 17910.0873    0  426 6220.27274 17910.0873   188%     -  785s
     0     0 17779.1951    0  420 6220.27274 17779.1951   186%     -  818s
     0     0 17671.6262    0  419 6220.27274 17671.6262   184%     -  844s
     0     0 17620.5461    0  419 6220.27274 17620.5461   183%     -  865s
     0     0 17553.1814    0  430 6220.27274 17553.1814   182%     -  884s
     0     0 17513.4770    0  432 6220.27274 17513.4770   182%     -  899s
     0     0 17484.9914    0  430 6220.27274 17484.9914   181%     -  912s
     0     0 17456.3023    0  436 6220.27274 17456.3023   181%     -  924s
     0     0 17453.4649    0  434 6220.27274 17453.4649   181%     -  930s
     0     0 16435.6339    0  368 6220.27274 16435.6339   164%     - 1012s
     0     0 16177.1778    0  390 6220.27274 16177.1778   160%     - 1055s
     0     0 16040.1396    0  403 6220.27274 16040.1396   158%     - 1079s
     0     0 16001.7707    0  398 6220.27274 16001.7707   157%     - 1100s
     0     0 15986.2560    0  393 6220.27274 15986.2560   157%     - 1111s
     0     0 15981.2689    0  401 6220.27274 15981.2689   157%     - 1114s
     0     0 15935.9166    0  396 6220.27274 15935.9166   156%     - 1126s
     0     0 15875.3271    0  403 6220.27274 15875.3271   155%     - 1141s
     0     0 15862.6091    0  396 6220.27274 15862.6091   155%     - 1150s
     0     0 15860.9296    0  395 6220.27274 15860.9296   155%     - 1152s
     0     0 15626.5060    0  420 6220.27274 15626.5060   151%     - 1186s
H    0     0                    6220.5975619 15626.2502   151%     - 1187s
H    0     0                    6345.7826909 15626.2502   146%     - 1187s
     0     0 15579.3704    0  376 6345.78269 15579.3704   146%     - 1202s
     0     0 15569.5387    0  386 6345.78269 15569.5387   145%     - 1209s
     0     0 15564.2410    0  392 6345.78269 15564.2410   145%     - 1215s
     0     0 15561.8187    0  387 6345.78269 15561.8187   145%     - 1218s
     0     0 15431.1906    0  456 6345.78269 15431.1906   143%     - 1240s
H    0     0                    6466.0254789 15430.8472   139%     - 1261s
     0     0 15405.9704    0  398 6466.02548 15405.9704   138%     - 1277s
     0     0 15398.8060    0  464 6466.02548 15398.8060   138%     - 1284s
     0     0 15389.8422    0  450 6466.02548 15389.8422   138%     - 1291s
     0     0 15379.8389    0  464 6466.02548 15379.8389   138%     - 1300s
     0     0 15372.5240    0  407 6466.02548 15372.5240   138%     - 1308s
     0     0 15219.9332    0  407 6466.02548 15219.9332   135%     - 1332s
     0     0 15199.2203    0  480 6466.02548 15199.2203   135%     - 1342s
     0     0 15194.2891    0  420 6466.02548 15194.2891   135%     - 1347s
     0     0 15178.0359    0  469 6466.02548 15178.0359   135%     - 1355s
     0     0 15175.1653    0  466 6466.02548 15175.1653   135%     - 1360s
     0     0 15063.7234    0  471 6466.02548 15063.7234   133%     - 1383s
     0     0 15023.0110    0  479 6466.02548 15023.0110   132%     - 1400s
     0     0 15011.2919    0  475 6466.02548 15011.2919   132%     - 1410s
     0     0 15005.5921    0  467 6466.02548 15005.5921   132%     - 1418s
     0     0 15004.4575    0  465 6466.02548 15004.4575   132%     - 1421s
     0     0 14923.8774    0  399 6466.02548 14923.8774   131%     - 1444s
     0     0 14798.3423    0  503 6466.02548 14798.3423   129%     - 1482s
     0     0 14783.1496    0  494 6466.02548 14783.1496   129%     - 1492s
     0     0 14771.7615    0  508 6466.02548 14771.7615   128%     - 1496s
     0     0 14770.0695    0  506 6466.02548 14770.0695   128%     - 1499s
     0     0 14721.6922    0  466 6466.02548 14721.6922   128%     - 1514s
     0     0 14704.1059    0  508 6466.02548 14704.1059   127%     - 1525s
     0     0 14697.5759    0  517 6466.02548 14697.5759   127%     - 1531s
     0     0 14677.6087    0  500 6466.02548 14677.6087   127%     - 1542s
     0     0 14673.3235    0  453 6466.02548 14673.3235   127%     - 1546s
     0     0 14671.5485    0  506 6466.02548 14671.5485   127%     - 1549s
     0     0 14633.3825    0  469 6466.02548 14633.3825   126%     - 1563s
     0     0 14624.2115    0  498 6466.02548 14624.2115   126%     - 1571s
     0     0 14619.9389    0  459 6466.02548 14619.9389   126%     - 1576s
     0     0 14616.3997    0  445 6466.02548 14616.3997   126%     - 1581s
     0     0 14588.5636    0  515 6466.02548 14588.5636   126%     - 1593s
     0     0 14576.9611    0  409 6466.02548 14576.9611   125%     - 1600s
     0     0 14573.4622    0  413 6466.02548 14573.4622   125%     - 1604s
     0     0 14558.6141    0  424 6466.02548 14558.6141   125%     - 1614s
     0     0 14552.9420    0  417 6466.02548 14552.9420   125%     - 1620s
     0     0 14549.7083    0  425 6466.02548 14549.7083   125%     - 1624s
     0     0 14533.9646    0  407 6466.02548 14533.9646   125%     - 1632s
     0     0 14532.6291    0  409 6466.02548 14532.6291   125%     - 1636s
     0     0 14509.1276    0  418 6466.02548 14509.1276   124%     - 1644s
     0     0 14508.3938    0  418 6466.02548 14508.3938   124%     - 1649s
     0     2 14507.7399    0  418 6466.02548 14507.7399   124%     - 1894s
     1     3 14128.6479    1  302 6466.02548 14507.5295   124% 11284 1909s
     2     4 14395.0578    1  409 6466.02548 14395.0578   123%  8444 1919s
     3     6 13797.6919    2  331 6466.02548 14394.9913   123%  7343 1935s
     5    10 13495.8161    3  375 6466.02548 14394.9913   123%  7467 1956s
     9    19 13380.6642    4  380 6466.02548 14078.0069   118%  8439 2010s
    18    29 7707.82708    5  212 6466.02548 14077.9628   118% 10784 2131s
    28    56 12061.6616    4  480 6466.02548 13850.2192   114% 12060 2280s
    57    81 11835.6065    5  437 6466.02548 13546.2687   109% 27617 2351s
    88   139 11715.5548    6  349 6466.02548 13546.2597   109% 20961 2402s
   150   216 11363.9894    8  415 6466.02548 13546.2597   109% 14732 2447s
   239   260 11354.2087   10  404 6466.02548 13546.2597   109% 10923 2485s
   299   284 10839.6797   12  391 6466.02548 13546.2597   109%  9580 2533s
   337   322 10728.9490   13  384 6466.02548 13546.2597   109%  9078 2610s
   381   350 10363.8123   14  453 6466.02548 13546.2597   109%  8667 2676s
   423   380 10228.5164   15  394 6466.02548 13546.2597   109%  8471 2712s
   453   410 9162.60049   16  333 6466.02548 13546.2597   109%  8404 2751s
   491   436 8875.73097   17  339 6466.02548 13546.2597   109%  8268 2785s
   529   468 infeasible   18      6466.02548 13546.2597   109%  8196 2820s
   567   484 infeasible   18      6466.02548 13546.2597   109%  8066 2856s
   603   513 8783.95895   17  278 6466.02548 13546.2597   109%  8019 2893s
   654   557 8254.81313   18  212 6466.02548 13546.2597   109%  7740 2936s
   706   589 8171.60416   19  206 6466.02548 13546.2597   109%  7509 2972s
   764   628 8124.73719   20  260 6466.02548 13546.2597   109%  7283 3004s
   817   652 8081.50223   21  210 6466.02548 13546.2597   109%  7087 3038s
   877   663 8063.44047   22  209 6466.02548 13546.2597   109%  6850 3071s
   928   683 8032.17404   23  194 6466.02548 12899.8752   100%  6708 3109s
   986   712 7997.48790   24  204 6466.02548 12899.8752   100%  6619 3140s
  1033   742 7981.67236   25  192 6466.02548 12899.8752   100%  6512 3172s
  1082   770 7710.65272   26  190 6466.02548 12899.8752   100%  6511 3205s
  1130   800 7105.73038   27  163 6466.02548 12666.1541  95.9%  6423 3241s
  1204   845 6918.54183   28  154 6466.02548 12666.1541  95.9%  6308 3279s
  1269   879 6715.14594   29  152 6466.02548 12666.1541  95.9%  6221 3316s
  1350   929     cutoff   30      6466.02548 12666.1541  95.9%  6110 3355s
  1444   991 6717.57532   29  137 6466.02548 12666.1541  95.9%  6011 3397s
  1562  1045 6560.67766   30  189 6466.02548 12666.1541  95.9%  5827 3442s
  1677  1082 6557.88717   31  185 6466.02548 12654.9511  95.7%  5691 3487s
  1774  1127 6527.46471   32  232 6466.02548 12642.4476  95.5%  5595 3547s
  1875  1164 infeasible   33      6466.02548 12641.0206  95.5%  5541 3600s

Cutting planes:
  Gomory: 48
  Implied bound: 306
  MIR: 3110
  Flow cover: 2732
  RLT: 153
  Relax-and-lift: 910

Explored 1975 nodes (11705166 simplex iterations) in 3600.06 seconds (4964.45 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6466.03 6345.78 6220.6 ... -5395.42

Time limit reached
Best objective 6.466025478942e+03, best bound 1.264102064973e+04, gap 95.4991%
  WARNING: Time limit reached. Using best solution found (gap: 95.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 6466.03, θ = 135646.94
  Upper Bound (UB) = 6466.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135646.94
  [DEBUG]   ✓ Scenario 0: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135646.94 ≤ Q = 135646.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 135646.94 ≤ Q = 135646.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x67df34b7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x67df34b7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6670382.1461
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.350383e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135038.33    0  123 6670382.15 -135038.33   102%     -    0s
H    0     0                    -106206.9360 -135038.33  27.1%     -    0s
H    0     0                    -106360.0971 -135038.33  27.0%     -    0s
     0     0 -110385.49    0   71 -106360.10 -110385.49  3.78%     -    0s
H    0     0                    -108133.9954 -110281.31  1.99%     -    0s
     0     0 -109791.37    0   49 -108134.00 -109791.37  1.53%     -    0s
H    0     0                    -108694.8453 -109790.65  1.01%     -    0s
     0     0 -109260.94    0   31 -108694.85 -109260.94  0.52%     -    0s
     0     0 -109157.52    0   24 -108694.85 -109157.52  0.43%     -    0s
     0     0 -109122.19    0   24 -108694.85 -109122.19  0.39%     -    0s
     0     0 -108872.22    0   19 -108694.85 -108872.22  0.16%     -    0s
     0     0 -108859.13    0   19 -108694.85 -108859.13  0.15%     -    0s
     0     0 -108835.11    0   14 -108694.85 -108835.11  0.13%     -    0s
     0     0 -108835.11    0   46 -108694.85 -108835.11  0.13%     -    0s
     0     0 -108826.61    0   15 -108694.85 -108826.61  0.12%     -    0s
H    0     0                    -108716.6278 -108810.86  0.09%     -    0s
     0     0 -108810.86    0   12 -108716.63 -108810.86  0.09%     -    0s
     0     0 -108810.08    0   13 -108716.63 -108810.08  0.09%     -    0s
     0     0 -108743.65    0   11 -108716.63 -108743.65  0.02%     -    0s
     0     0 -108743.65    0   13 -108716.63 -108743.65  0.02%     -    0s
     0     0 -108743.65    0   11 -108716.63 -108743.65  0.02%     -    0s
H    0     0                    -108720.0767 -108743.65  0.02%     -    0s
H    0     0                    -108724.8098 -108743.65  0.02%     -    0s
     0     0 -108743.65    0    8 -108724.81 -108743.65  0.02%     -    0s
     0     0 -108743.65    0   12 -108724.81 -108743.65  0.02%     -    0s
     0     0 -108743.65    0   12 -108724.81 -108743.65  0.02%     -    0s
H    0     0                    -108727.2497 -108736.06  0.01%     -    0s
     0     0 -108736.06    0    3 -108727.25 -108736.06  0.01%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 4
  Flow cover: 12
  RLT: 1
  Relax-and-lift: 7

Explored 1 nodes (843 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -108727 -108725 -108720 ... 6.67038e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.087272497357e+05, best bound -1.087360631397e+05, gap 0.0081%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 134657.30
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108727.25
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -108727.25 = 134657.30
  [DEBUG]   Current θ from Master = 135646.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 989.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5476.39
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 285.5958, Absolute Gap = 285.5958, Relative Gap = 0.044169
  Not converged yet (gap = 285.60 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653624 nonzeros
Model fingerprint: 0x8c261fd6
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 118170 rows and 47970 columns
Presolve time: 4.22s
Presolved: 112563 rows, 47890 columns, 682409 nonzeros
Variable types: 45631 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -380015.6695
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 4.784e+06
 Factor NZ  : 1.113e+07 (roughly 160 MB of memory)
 Factor Ops : 2.329e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.81844431e+07  2.05898052e+08  8.72e+04 1.88e+01  7.59e+04     6s
   1  -1.38613079e+07  1.80392592e+08  6.14e+04 6.54e+01  5.28e+04     6s
   2  -4.00502545e+06  1.39086290e+08  1.71e+04 9.12e-01  1.55e+04     6s
   3  -8.93624500e+05  1.01156602e+08  1.25e+03 7.39e-01  1.54e+03     7s
   4  -5.94307591e+05  3.75400619e+07  4.08e+02 1.46e-01  4.83e+02     7s
   5  -4.97667677e+05  2.72468613e+07  2.28e+02 9.45e-02  2.91e+02     7s
   6  -3.67430574e+05  1.96696580e+07  8.48e+01 6.28e-02  1.51e+02     7s
   7  -2.46624475e+05  1.41335899e+07  3.36e+01 4.19e-02  8.80e+01     7s
   8  -1.12372091e+05  8.06849673e+06  8.57e+00 2.05e-02  4.29e+01     7s
   9  -1.01946071e+05  6.03267956e+06  6.74e+00 1.50e-02  3.18e+01     7s
  10  -6.29148501e+04  2.79389107e+06  2.00e+00 6.41e-03  1.42e+01     7s
  11  -4.30616290e+04  1.44255401e+06  1.04e+00 3.32e-03  7.30e+00     7s
  12  -2.16806032e+04  5.13557331e+05  5.01e-01 1.12e-03  2.61e+00     8s
  13  -1.38779516e+04  3.22614345e+05  3.71e-01 9.73e-04  1.64e+00     8s
  14  -3.60611974e+03  1.54376957e+05  2.25e-01 7.99e-04  7.69e-01     8s
  15   1.84334972e+03  1.26500140e+05  1.83e-01 7.83e-04  6.07e-01     8s
  16   7.75079609e+03  9.56566341e+04  1.36e-01 8.35e-04  4.28e-01     8s
  17   9.73692781e+03  8.46755144e+04  1.23e-01 1.09e-03  3.65e-01     8s
  18   1.48832945e+04  6.74203675e+04  9.14e-02 1.26e-03  2.56e-01     8s
  19   1.84555643e+04  5.43818173e+04  7.20e-02 1.50e-03  1.75e-01     8s
  20   2.13901021e+04  4.87424029e+04  5.83e-02 1.60e-03  1.33e-01     8s
  21   2.29113497e+04  4.46152530e+04  5.18e-02 1.76e-03  1.06e-01     9s
  22   2.49637806e+04  4.23393067e+04  4.32e-02 1.82e-03  8.45e-02     9s
  23   2.77282864e+04  4.10081422e+04  3.17e-02 1.93e-03  6.46e-02     9s
  24   2.87719219e+04  4.02959690e+04  2.75e-02 1.72e-03  5.61e-02     9s
  25   2.99108591e+04  3.89624616e+04  2.29e-02 1.21e-03  4.40e-02     9s
  26   3.04850535e+04  3.82469452e+04  2.06e-02 9.28e-04  3.78e-02     9s
  27   3.12076464e+04  3.77719696e+04  1.77e-02 7.21e-04  3.19e-02     9s
  28   3.16237890e+04  3.72917123e+04  1.60e-02 5.41e-04  2.76e-02     9s
  29   3.24672099e+04  3.70953176e+04  1.28e-02 4.62e-04  2.25e-02    10s
  30   3.28008598e+04  3.67695344e+04  1.15e-02 3.40e-04  1.93e-02    10s
  31   3.33845272e+04  3.65655260e+04  9.28e-03 2.91e-04  1.55e-02    10s
  32   3.36908958e+04  3.63944346e+04  8.08e-03 2.27e-04  1.32e-02    10s
  33   3.40884653e+04  3.63303017e+04  6.60e-03 1.98e-04  1.09e-02    10s
  34   3.42757524e+04  3.62425859e+04  5.82e-03 1.67e-04  9.57e-03    10s
  35   3.44332589e+04  3.61979201e+04  5.22e-03 1.45e-04  8.59e-03    10s
  36   3.46322247e+04  3.61174188e+04  4.47e-03 1.13e-04  7.23e-03    11s
  37   3.48520579e+04  3.60811849e+04  3.59e-03 1.11e-04  5.98e-03    11s
  38   3.49685151e+04  3.60351706e+04  3.12e-03 9.85e-05  5.19e-03    11s
  39   3.50698119e+04  3.59823572e+04  2.74e-03 7.61e-05  4.44e-03    11s
  40   3.51345070e+04  3.59704263e+04  2.49e-03 7.14e-05  4.07e-03    11s
  41   3.51902794e+04  3.59499173e+04  2.28e-03 6.22e-05  3.70e-03    11s
  42   3.52929363e+04  3.58824681e+04  1.88e-03 4.88e-05  2.87e-03    12s
  43   3.53687614e+04  3.58737021e+04  1.59e-03 4.28e-05  2.46e-03    12s
  44   3.54528124e+04  3.58436131e+04  1.27e-03 3.64e-05  1.90e-03    12s
  45   3.55159124e+04  3.58332151e+04  1.02e-03 2.57e-05  1.54e-03    12s
  46   3.55594800e+04  3.58231078e+04  8.63e-04 1.75e-05  1.28e-03    12s
  47   3.55847722e+04  3.58184898e+04  7.70e-04 1.87e-05  1.14e-03    12s
  48   3.56744196e+04  3.58089388e+04  4.40e-04 2.42e-05  6.55e-04    12s
  49   3.57496423e+04  3.58068369e+04  1.70e-04 1.78e-05  2.78e-04    13s
  50   3.57687513e+04  3.58044759e+04  1.04e-04 1.08e-05  1.74e-04    13s
  51   3.57785822e+04  3.58037137e+04  7.21e-05 8.52e-06  1.22e-04    13s
  52   3.57925664e+04  3.58034528e+04  2.41e-05 7.75e-06  5.29e-05    13s
  53   3.57959015e+04  3.58019968e+04  1.40e-05 3.22e-06  2.96e-05    13s
  54   3.57983512e+04  3.58018995e+04  6.76e-06 2.96e-06  1.73e-05    13s
  55   3.58006034e+04  3.58009324e+04  3.52e-07 1.07e-07  1.60e-06    13s
  56   3.58008080e+04  3.58008086e+04  3.22e-09 1.19e-10  2.92e-09    14s
  57   3.58008085e+04  3.58008085e+04  9.32e-09 8.77e-12  6.18e-12    14s

Barrier solved model in 57 iterations and 13.76 seconds (11.58 work units)
Optimal objective 3.58008085e+04


Root crossover log...

   90550 DPushes remaining with DInf 0.0000000e+00                14s
   21086 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    2710 PPushes remaining with PInf 8.1467589e-07                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.2156951e-11     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31806    3.5800808e+04   0.000000e+00   0.000000e+00     17s
   31806    3.5800808e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.580081e+04, 31806 iterations, 12.03 seconds (13.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35800.8085    0  400 -170236.42 35800.8085   121%     -   18s
H    0     0                    -92469.44809 35800.8085   139%     -   18s
H    0     0                    -64225.25557 35800.8085   156%     -   18s
H    0     0                    -19800.86444 35800.8085   281%     -   19s
H    0     0                    -14115.80418 35800.8085   354%     -   19s
H    0     0                    -10771.59319 35800.8085   432%     -   19s
H    0     0                    -9115.679059 35800.8085   493%     -   19s
H    0     0                    -8111.088147 35800.8085   541%     -   19s
H    0     0                    -8102.753102 35800.8085   542%     -   19s
H    0     0                    -8049.107358 35800.8085   545%     -   19s
H    0     0                    -3313.037660 28083.6086   948%     -   85s
H    0     0                    4556.4391659 28083.6086   516%     -   85s
H    0     0                    5578.1694591 28083.6086   403%     -   85s
H    0     0                    5611.8445840 28083.6086   400%     -   85s
H    0     0                    5742.2835200 28083.6086   389%     -   85s
     0     0 27981.8168    0  377 5742.28352 27981.8168   387%     -   85s
H    0     0                    5926.2005571 27981.8168   372%     -   86s
     0     0 27285.6803    0  470 5926.20056 27285.6803   360%     -  117s
     0     0 27238.3391    0  477 5926.20056 27238.3391   360%     -  130s
     0     0 27238.3391    0  479 5926.20056 27238.3391   360%     -  137s
     0     0 27238.3391    0  483 5926.20056 27238.3391   360%     -  139s
     0     0 23494.9226    0  399 5926.20056 23494.9226   296%     -  221s
H    0     0                    6042.7280881 21838.2706   261%     -  336s
     0     0 21838.2706    0  403 6042.72809 21838.2706   261%     -  336s
     0     0 21485.7540    0  448 6042.72809 21485.7540   256%     -  389s
     0     0 21281.9318    0  503 6042.72809 21281.9318   252%     -  421s
     0     0 21243.5423    0  507 6042.72809 21243.5423   252%     -  443s
     0     0 21166.4892    0  461 6042.72809 21166.4892   250%     -  471s
     0     0 21013.5252    0  467 6042.72809 21013.5252   248%     -  508s
     0     0 20952.7198    0  466 6042.72809 20952.7198   247%     -  533s
H    0     0                    6088.5301910 20939.6391   244%     -  548s
H    0     0                    6125.6786928 20939.6391   242%     -  548s
H    0     0                    6162.4354237 20939.6391   240%     -  548s
H    0     0                    6198.9496759 20939.6391   238%     -  548s
     0     0 20939.6391    0  434 6198.94968 20939.6391   238%     -  548s
     0     0 20876.0153    0  449 6198.94968 20876.0153   237%     -  562s
     0     0 20841.3915    0  458 6198.94968 20841.3915   236%     -  571s
     0     0 20840.0745    0  454 6198.94968 20840.0745   236%     -  574s
     0     0 18775.2240    0  356 6198.94968 18775.2240   203%     -  696s
H    0     0                    6246.7857305 18775.1315   201%     -  697s
     0     0 18313.3343    0  388 6246.78573 18313.3343   193%     -  767s
     0     0 18120.7461    0  382 6246.78573 18120.7461   190%     -  820s
     0     0 18031.6268    0  402 6246.78573 18031.6268   189%     -  850s
     0     0 17886.2564    0  441 6246.78573 17886.2564   186%     -  882s
     0     0 17755.9403    0  516 6246.78573 17755.9403   184%     -  910s
     0     0 17708.1041    0  519 6246.78573 17708.1041   183%     -  932s
     0     0 17679.0584    0  395 6246.78573 17679.0584   183%     -  947s
     0     0 17620.4298    0  397 6246.78573 17620.4298   182%     -  959s
     0     0 17606.8972    0  473 6246.78573 17606.8972   182%     -  973s
     0     0 17598.6138    0  395 6246.78573 17598.6138   182%     -  978s
     0     0 17498.5843    0  381 6246.78573 17498.5843   180%     - 1004s
     0     0 17475.9151    0  392 6246.78573 17475.9151   180%     - 1012s
     0     0 17451.9635    0  387 6246.78573 17451.9635   179%     - 1025s
     0     0 17447.8630    0  385 6246.78573 17447.8630   179%     - 1035s
     0     0 17445.9664    0  385 6246.78573 17445.9664   179%     - 1041s
     0     0 16323.4175    0  442 6246.78573 16323.4175   161%     - 1152s
     0     0 16113.4676    0  447 6246.78573 16113.4676   158%     - 1173s
     0     0 15955.5521    0  453 6246.78573 15955.5521   155%     - 1197s
     0     0 15786.3273    0  447 6246.78573 15786.3273   153%     - 1229s
     0     0 15730.4994    0  471 6246.78573 15730.4994   152%     - 1248s
     0     0 15720.1763    0  467 6246.78573 15720.1763   152%     - 1255s
     0     0 15716.7818    0  470 6246.78573 15716.7818   152%     - 1260s
     0     0 15540.9786    0  459 6246.78573 15540.9786   149%     - 1297s
     0     0 15471.4140    0  458 6246.78573 15471.4140   148%     - 1323s
     0     0 15453.6379    0  472 6246.78573 15453.6379   147%     - 1339s
     0     0 15429.7617    0  471 6246.78573 15429.7617   147%     - 1354s
H    0     0                    6283.5038166 15415.3551   145%     - 1368s
     0     0 15415.3551    0  409 6283.50382 15415.3551   145%     - 1368s
H    0     0                    6286.5826107 15410.2154   145%     - 1377s
     0     0 15410.2154    0  410 6286.58261 15410.2154   145%     - 1377s
     0     0 15401.6912    0  413 6286.58261 15401.6912   145%     - 1384s
     0     0 15395.7217    0  410 6286.58261 15395.7217   145%     - 1393s
     0     0 15386.8918    0  414 6286.58261 15386.8918   145%     - 1404s
     0     0 15377.9521    0  414 6286.58261 15377.9521   145%     - 1412s
     0     0 15374.7963    0  411 6286.58261 15374.7963   145%     - 1415s
     0     0 15274.4110    0  509 6286.58261 15274.4110   143%     - 1442s
H    0     0                    6331.9086054 15273.9220   141%     - 1444s
H    0     0                    6402.3309206 15273.9220   139%     - 1444s
     0     0 15239.4921    0  519 6402.33092 15239.4921   138%     - 1457s
     0     0 15223.9965    0  452 6402.33092 15223.9965   138%     - 1466s
     0     0 15214.3551    0  407 6402.33092 15214.3551   138%     - 1473s
     0     0 15206.4676    0  459 6402.33092 15206.4676   138%     - 1479s
     0     0 15133.3067    0  384 6402.33092 15133.3067   136%     - 1497s
     0     0 15091.0379    0  397 6402.33092 15091.0379   136%     - 1508s
     0     0 15086.8672    0  446 6402.33092 15086.8672   136%     - 1513s
     0     0 15078.9027    0  453 6402.33092 15078.9027   136%     - 1518s
     0     0 15073.4314    0  449 6402.33092 15073.4314   135%     - 1524s
     0     0 15070.8859    0  446 6402.33092 15070.8859   135%     - 1527s
     0     0 14991.4436    0  399 6402.33092 14991.4436   134%     - 1543s
     0     0 14951.2385    0  458 6402.33092 14951.2385   134%     - 1559s
     0     0 14947.4988    0  502 6402.33092 14947.4988   133%     - 1566s
     0     0 14943.3182    0  509 6402.33092 14943.3182   133%     - 1572s
     0     0 14942.7087    0  513 6402.33092 14942.7087   133%     - 1574s
     0     0 14892.3838    0  523 6402.33092 14892.3838   133%     - 1594s
     0     0 14878.1129    0  407 6402.33092 14878.1129   132%     - 1608s
     0     0 14870.1116    0  460 6402.33092 14870.1116   132%     - 1617s
     0     0 14866.4344    0  513 6402.33092 14866.4344   132%     - 1622s
     0     0 14865.4962    0  463 6402.33092 14865.4962   132%     - 1624s
     0     0 14808.6346    0  515 6402.33092 14808.6346   131%     - 1642s
     0     0 14734.9635    0  517 6402.33092 14734.9635   130%     - 1662s
     0     0 14719.5408    0  459 6402.33092 14719.5408   130%     - 1670s
     0     0 14715.6652    0  523 6402.33092 14715.6652   130%     - 1676s
     0     0 14714.1045    0  518 6402.33092 14714.1045   130%     - 1679s
     0     0 14678.3522    0  402 6402.33092 14678.3522   129%     - 1694s
     0     0 14667.7427    0  404 6402.33092 14667.7427   129%     - 1704s
     0     0 14663.0140    0  458 6402.33092 14663.0140   129%     - 1711s
     0     0 14662.0001    0  403 6402.33092 14662.0001   129%     - 1713s
     0     0 14636.8884    0  506 6402.33092 14636.8884   129%     - 1725s
     0     0 14630.3145    0  518 6402.33092 14630.3145   129%     - 1730s
     0     0 14622.1527    0  384 6402.33092 14622.1527   128%     - 1736s
     0     0 14618.7170    0  393 6402.33092 14618.7170   128%     - 1739s
     0     0 14596.6529    0  515 6402.33092 14596.6529   128%     - 1759s
     0     0 14591.1799    0  521 6402.33092 14591.1799   128%     - 1765s
     0     0 14588.9377    0  536 6402.33092 14588.9377   128%     - 1770s
     0     0 14580.3968    0  413 6402.33092 14580.3968   128%     - 1779s
     0     0 14577.2221    0  406 6402.33092 14577.2221   128%     - 1784s
     0     0 14571.4902    0  458 6402.33092 14571.4902   128%     - 1790s
     0     0 14568.3527    0  459 6402.33092 14568.3527   128%     - 1802s
     0     0 14564.4880    0  410 6402.33092 14564.4880   127%     - 1810s
     0     0 14564.3296    0  410 6402.33092 14564.3296   127%     - 1816s
     0     2 14564.2643    0  410 6402.33092 14564.2643   127%     - 2015s
     1     3 14230.6026    1  371 6402.33092 14563.9069   127% 11831 2032s
     2     5 13830.8489    2  227 6402.33092 14563.9069   127% 10431 2045s
     4     9 13454.3739    3  240 6402.33092 14457.7898   126%  9766 2078s
     8    17 13290.2639    4  233 6402.33092 14457.3063   126% 10623 2122s
    16    34 13157.0500    5  227 6402.33092 14315.7549   124% 10616 2160s
    33    49 13160.1142    5  399 6402.33092 14264.8518   123% 16343 2265s
    48    78 12881.9044    6  495 6402.33092 14264.8518   123% 15345 2345s
H   76    78                    6418.4107415 14264.8518   122% 12909 2345s
    77   192 12729.9947    7  375 6418.41074 14264.8518   122% 13047 2399s
   191   261 12549.6871    9  441 6418.41074 14264.8518   122%  9337 2434s
   260   326 12505.6774   11  425 6418.41074 14264.8518   122%  7810 2467s
   325   366 10192.6664   12  255 6418.41074 14264.8518   122%  7090 2495s
   367   403 12506.8780   10  359 6418.41074 14264.8518   122%  6690 2527s
   410   433 9969.07783   15  212 6418.41074 14264.8518   122%  6448 2561s
H  442   433                    6477.9323488 14264.8518   120%  6300 2561s
   450   491 9769.75847   16  210 6477.93235 14264.8518   120%  6270 2595s
   516   517 9082.64504   18  236 6477.93235 14264.8518   120%  6014 2622s
   546   575 9046.80463   19  238 6477.93235 14264.8518   120%  5938 2658s
   610   627 8940.83822   21  233 6477.93235 14264.8518   120%  5623 2683s
   674   691 8907.67713   23  227 6477.93235 14264.8518   120%  5285 2712s
   758   718 infeasible   27      6477.93235 14264.8518   120%  4974 2748s
   793   780 8641.88018   28  260 6477.93235 14264.8518   120%  4896 2773s
   874   807 8639.22605   29  305 6477.93235 14264.8518   120%  4696 2797s
   945   823 8589.85795   30  245 6477.93235 14264.8518   120%  4535 2830s
  1003   822 8398.43514   31  198 6477.93235 14264.8518   120%  4454 2872s
  1036   834 8168.87811   32  172 6477.93235 14264.8518   120%  4451 2905s
  1093   843 8006.19399   34  228 6477.93235 14264.8518   120%  4416 2953s
  1130   859 7903.11552   35  229 6477.93235 14264.8518   120%  4424 2984s
  1168   873 7108.95183   36  152 6477.93235 14264.8518   120%  4448 3021s
  1215   932 6884.95243   37  220 6477.93235 14264.8518   120%  4406 3055s
  1314   937     cutoff   40      6477.93235 14264.8518   120%  4309 3094s
  1386   925 infeasible   38      6477.93235 13984.7161   116%  4278 3151s
  1466   941 infeasible   28      6477.93235 13984.7120   116%  4237 3192s
  1524   950 10159.1267    8  235 6477.93235 13984.7120   116%  4275 3235s
  1583   973 7943.62662    9  123 6477.93235 13984.7120   116%  4342 3280s
  1649  1019 7541.85822   12   75 6477.93235 13984.7120   116%  4391 3333s
  1744  1088     cutoff   16      6477.93235 13942.6365   115%  4342 3382s
  1859  1173 10367.2951    8  288 6477.93235 13942.6365   115%  4291 3432s
  1998  1215 12330.2401    7  482 6477.93235 13942.6365   115%  4223 3485s
  2111  1262 8124.30757   16  216 6477.93235 13942.6365   115%  4210 3542s
  2186  1338 11641.2873    8  434 6477.93235 13823.6762   113%  4271 3597s
  2292  1339 7086.89614   37   78 6477.93235 13823.6762   113%  4327 3600s

Cutting planes:
  Learned: 2
  Gomory: 44
  Implied bound: 373
  MIR: 3544
  Flow cover: 3508
  RLT: 167
  Relax-and-lift: 1159

Explored 2297 nodes (10835485 simplex iterations) in 3600.06 seconds (4909.63 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6477.93 6418.41 6402.33 ... 6125.68

Time limit reached
Best objective 6.477932348812e+03, best bound 1.382367624725e+04, gap 113.3964%
  WARNING: Time limit reached. Using best solution found (gap: 113.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 6477.93, θ = 135407.31
  Upper Bound (UB) = 6477.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135407.31
  [DEBUG]   ✓ Scenario 0: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135407.31 ≤ Q = 135407.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135407.31 ≤ Q = 137183.28 (slack: 1775.97)
  [DEBUG]   ✓ Scenario 3: θ = 135407.31 ≤ Q = 135407.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135407.31 ≤ Q = 136988.32 (slack: 1581.01)
  [DEBUG]   ✓ Scenario 5: θ = 135407.31 ≤ Q = 135407.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 135407.31 ≤ Q = 135407.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 135407.31 ≤ Q = 135407.31 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1f69bb83
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe096447d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.476448e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6588517.0038
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.352888e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135288.81    0  123 6588517.00 -135288.81   102%     -    0s
H    0     0                    -106474.7092 -135288.81  27.1%     -    0s
H    0     0                    -106627.8703 -135288.81  26.9%     -    0s
     0     0 -110277.43    0   92 -106627.87 -110277.43  3.42%     -    0s
H    0     0                    -107763.5598 -110168.93  2.23%     -    0s
     0     0 -109796.36    0   44 -107763.56 -109796.36  1.89%     -    0s
H    0     0                    -108855.0837 -109720.21  0.79%     -    0s
     0     0 -109355.25    0   21 -108855.08 -109355.25  0.46%     -    0s
     0     0 -109305.60    0   18 -108855.08 -109305.60  0.41%     -    0s
     0     0 -109221.34    0   23 -108855.08 -109221.34  0.34%     -    0s
     0     0 -109219.75    0   25 -108855.08 -109219.75  0.33%     -    0s
H    0     0                    -108881.8095 -109219.75  0.31%     -    0s
     0     0 -109016.53    0   17 -108881.81 -109016.53  0.12%     -    0s
     0     0 -109014.44    0   13 -108881.81 -109014.44  0.12%     -    0s
H    0     0                    -108898.5960 -109013.71  0.11%     -    0s
     0     0 -108994.55    0   13 -108898.60 -108994.55  0.09%     -    0s
     0     0 -108940.28    0    6 -108898.60 -108940.28  0.04%     -    0s
     0     0 -108940.28    0   11 -108898.60 -108940.28  0.04%     -    0s
     0     0 -108909.57    0    5 -108898.60 -108909.57  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 8

Explored 1 nodes (588 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -108899 -108882 -108855 ... 1.47645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.088985960260e+05, best bound -1.089076828236e+05, gap 0.0083%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 134485.95
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108898.60
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -108898.60 = 134485.95
  [DEBUG]   Current θ from Master = 135407.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 921.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5556.57
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 297.5027, Absolute Gap = 297.5027, Relative Gap = 0.045926
  Not converged yet (gap = 297.50 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 696831 nonzeros
Model fingerprint: 0xcb2c3175
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 126048 rows and 51168 columns
Presolve time: 4.38s
Presolved: 119975 rows, 50932 columns, 742017 nonzeros
Variable types: 48673 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.39s

Barrier statistics:
 Dense cols : 587
 AA' NZ     : 5.872e+06
 Factor NZ  : 1.269e+07 (roughly 170 MB of memory)
 Factor Ops : 2.680e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85289902e+07  2.15909308e+08  9.00e+04 1.83e+01  7.69e+04     8s
   1  -1.39944185e+07  1.88852367e+08  6.26e+04 6.13e+01  5.31e+04     8s
   2  -4.28201841e+06  1.43651152e+08  1.86e+04 6.12e+00  1.64e+04     8s
   3  -1.77712468e+06  1.21959375e+08  4.80e+03 2.31e+00  4.55e+03     8s
   4  -8.05158231e+05  8.43876934e+07  6.93e+02 8.71e-01  9.33e+02     8s
   5  -7.11945822e+05  7.20436087e+07  3.43e+02 7.05e-01  5.92e+02     8s
   6  -4.95800679e+05  4.65825290e+07  2.86e+02 1.08e-01  4.14e+02     8s
   7  -4.14476510e+05  3.57792441e+07  9.58e+01 4.13e-02  2.28e+02     9s
   8  -3.34006861e+05  2.21261543e+07  2.25e+01 2.43e-02  1.15e+02     9s
   9  -2.19331967e+05  1.33036673e+07  4.76e+00 1.40e-02  6.36e+01     9s
  10  -1.33832190e+05  8.45840245e+06  1.87e+00 8.79e-03  3.97e+01     9s
  11  -1.05162468e+05  5.44539852e+06  1.08e+00 5.64e-03  2.55e+01     9s
  12  -9.25316882e+04  3.34565279e+06  6.69e-01 3.48e-03  1.57e+01     9s
  13  -6.66607223e+04  2.51068154e+06  2.20e-01 2.59e-03  1.18e+01     9s
  14  -4.97883427e+04  1.34986473e+06  9.45e-02 1.37e-03  6.38e+00     9s
  15  -2.89650968e+04  4.10883658e+05  3.50e-02 4.11e-04  2.00e+00    10s
  16  -1.88762208e+04  2.68774313e+05  2.38e-02 2.79e-04  1.31e+00    10s
  17  -1.08841821e+04  1.86536838e+05  1.86e-02 3.24e-04  9.00e-01    10s
  18  -3.48329955e+03  1.41165728e+05  1.44e-02 1.50e-03  6.59e-01    10s
  19   3.52496723e+03  9.27365259e+04  1.04e-02 1.78e-03  4.07e-01    10s
  20   8.32932136e+03  7.97838325e+04  7.92e-03 1.64e-03  3.26e-01    10s
  21   1.26650403e+04  7.15630812e+04  5.84e-03 1.47e-03  2.68e-01    10s
  22   1.48887142e+04  6.15905924e+04  4.86e-03 1.09e-03  2.13e-01    11s
  23   1.72421417e+04  5.36059734e+04  3.99e-03 8.25e-04  1.66e-01    11s
  24   1.77669450e+04  4.92137904e+04  3.80e-03 6.69e-04  1.43e-01    11s
  25   2.08229639e+04  4.63521913e+04  2.74e-03 5.78e-04  1.16e-01    11s
  26   2.29882781e+04  4.14463503e+04  2.03e-03 4.01e-04  8.41e-02    11s
  27   2.43547808e+04  3.90212386e+04  1.62e-03 3.16e-04  6.68e-02    12s
  28   2.62230833e+04  3.62042032e+04  1.09e-03 2.13e-04  4.55e-02    12s
  29   2.74748261e+04  3.36588853e+04  7.56e-04 1.13e-04  2.82e-02    12s
  30   2.84130611e+04  3.28023822e+04  5.11e-04 8.64e-05  2.00e-02    12s
  31   2.90661514e+04  3.19121833e+04  3.44e-04 5.19e-05  1.30e-02    12s
  32   2.93035428e+04  3.16335612e+04  2.85e-04 4.12e-05  1.06e-02    12s
  33   2.96621501e+04  3.13458092e+04  1.96e-04 3.03e-05  7.67e-03    13s
  34   2.98438747e+04  3.11070001e+04  1.53e-04 2.14e-05  5.76e-03    13s
  35   3.01258202e+04  3.09517686e+04  8.91e-05 1.52e-05  3.76e-03    13s
  36   3.02272648e+04  3.07253010e+04  6.70e-05 6.28e-06  2.27e-03    13s
  37   3.03002117e+04  3.06756553e+04  5.08e-05 4.38e-06  1.71e-03    13s
  38   3.03444988e+04  3.06215690e+04  4.19e-05 2.31e-06  1.26e-03    14s
  39   3.03829206e+04  3.06075932e+04  3.36e-05 1.81e-06  1.02e-03    14s
  40   3.04967640e+04  3.05770087e+04  1.08e-05 6.98e-07  3.66e-04    14s
  41   3.05471380e+04  3.05606430e+04  1.20e-06 1.68e-07  6.16e-05    14s
  42   3.05538830e+04  3.05573953e+04  1.27e-07 8.13e-08  1.60e-05    14s
  43   3.05546951e+04  3.05550063e+04  3.43e-08 9.57e-09  1.42e-06    15s
  44   3.05547308e+04  3.05547317e+04  1.12e-08 5.70e-11  3.86e-09    15s
  45   3.05547311e+04  3.05547314e+04  1.34e-07 1.66e-09  1.41e-09    15s
  46   3.05547311e+04  3.05547314e+04  2.40e-07 1.58e-09  1.23e-09    15s

Barrier solved model in 46 iterations and 15.23 seconds (11.81 work units)
Optimal objective 3.05547311e+04


Root crossover log...

  102014 DPushes remaining with DInf 0.0000000e+00                15s
   12073 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

   10301 PPushes remaining with PInf 4.4748767e-05                22s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.6942340e+02     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   61822    3.0554731e+04   0.000000e+00   6.694234e+02     24s
   61911    3.0554731e+04   0.000000e+00   0.000000e+00     24s
   61911    3.0554731e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 1.45s

Solved with barrier

Root relaxation: objective 3.055473e+04, 61911 iterations, 20.06 seconds (23.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30554.7313    0  299 -170236.42 30554.7313   118%     -   26s
H    0     0                    -165556.9000 30554.7313   118%     -   26s
H    0     0                    -97959.40856 30554.7313   131%     -   27s
H    0     0                    -96906.90598 30554.7313   132%     -   27s
H    0     0                    -28908.25560 30554.7313   206%     -   27s
H    0     0                    -28743.57058 30554.7313   206%     -   27s
H    0     0                    -12774.53002 30554.7313   339%     -   27s
H    0     0                    -12323.23850 30554.7313   348%     -   27s
H    0     0                    -11331.97166 30554.7313   370%     -   27s
H    0     0                    -11052.38018 23727.7685   315%     -  102s
     0     0 23727.7685    0  266 -11052.380 23727.7685   315%     -  103s
H    0     0                    -7279.334027 23727.6867   426%     -  104s
H    0     0                    -6876.208588 23727.6867   445%     -  104s
H    0     0                    -6784.373240 23727.6867   450%     -  104s
H    0     0                    -6538.993498 23727.6867   463%     -  104s
     0     0 22937.5760    0  277 -6538.9935 22937.5760   451%     -  131s
     0     0 22870.7996    0  278 -6538.9935 22870.7996   450%     -  149s
     0     0 22862.5227    0  276 -6538.9935 22862.5227   450%     -  154s
     0     0 22862.5227    0  282 -6538.9935 22862.5227   450%     -  161s
     0     0 22693.4303    0  288 -6538.9935 22693.4303   447%     -  165s
     0     0 22677.0274    0  289 -6538.9935 22677.0274   447%     -  170s
     0     0 22610.3408    0  284 -6538.9935 22610.3408   446%     -  175s
     0     0 22608.6199    0  286 -6538.9935 22608.6199   446%     -  177s
     0     0 22608.6187    0  279 -6538.9935 22608.6187   446%     -  178s
     0     0 19680.1773    0  379 -6538.9935 19680.1773   401%     -  245s
H    0     0                    -6204.165732 19679.8317   417%     -  245s
     0     0 19148.0358    0  422 -6204.1657 19148.0358   409%     -  285s
     0     0 19069.5898    0  422 -6204.1657 19069.5898   407%     -  312s
     0     0 18640.7668    0  424 -6204.1657 18640.7668   400%     -  350s
     0     0 18592.3123    0  415 -6204.1657 18592.3123   400%     -  362s
     0     0 18583.9454    0  419 -6204.1657 18583.9454   400%     -  366s
H    0     0                    -4100.200850 18442.7665   550%     -  376s
H    0     0                    -3738.107673 18442.7665   593%     -  376s
H    0     0                      46.8737095 18442.7665      -     -  376s
H    0     0                      68.9259879 18442.7665      -     -  376s
H    0     0                     252.7001096 18442.7665  7198%     -  376s
H    0     0                     374.3642845 18442.7665  4826%     -  376s
H    0     0                     439.7589322 18442.7665  4094%     -  376s
H    0     0                     497.3963262 18442.7665  3608%     -  376s
H    0     0                     528.1827795 18442.7665  3392%     -  376s
H    0     0                     542.5036429 18442.7665  3300%     -  376s
H    0     0                     553.1691299 18442.7665  3234%     -  376s
     0     0 18442.7665    0  417  553.16913 18442.7665  3234%     -  377s
H    0     0                     553.6327259 18432.5534  3229%     -  381s
H    0     0                     583.0264026 18432.5534  3062%     -  381s
     0     0 18432.5534    0  414  583.02640 18432.5534  3062%     -  382s
     0     0 18390.7641    0  422  583.02640 18390.7641  3054%     -  395s
     0     0 18373.1779    0  416  583.02640 18373.1779  3051%     -  402s
     0     0 18370.3933    0  418  583.02640 18370.3933  3051%     -  405s
     0     0 18365.8691    0  425  583.02640 18365.8691  3050%     -  408s
     0     0 18292.9002    0  427  583.02640 18292.9002  3038%     -  417s
     0     0 18262.6557    0  421  583.02640 18262.6557  3032%     -  424s
     0     0 18257.2600    0  427  583.02640 18257.2600  3031%     -  428s
     0     0 18250.1378    0  430  583.02640 18250.1378  3030%     -  432s
     0     0 18249.2477    0  432  583.02640 18249.2477  3030%     -  433s
H    0     0                    3958.9727669 16841.6058   325%     -  509s
H    0     0                    4573.6453635 16841.6058   268%     -  509s
H    0     0                    5323.8326856 16841.6058   216%     -  509s
H    0     0                    5536.0048965 16841.6058   204%     -  509s
H    0     0                    5724.0281539 16841.6058   194%     -  509s
     0     0 16841.6058    0  335 5724.02815 16841.6058   194%     -  509s
H    0     0                    6046.5262969 16841.6013   179%     -  510s
H    0     0                    6075.7406979 16841.6013   177%     -  510s
     0     0 16552.9625    0  350 6075.74070 16552.9625   172%     -  535s
     0     0 16399.7348    0  362 6075.74070 16399.7348   170%     -  557s
     0     0 16348.0643    0  361 6075.74070 16348.0643   169%     -  569s
     0     0 16325.5445    0  361 6075.74070 16325.5445   169%     -  577s
     0     0 16280.1630    0  370 6075.74070 16280.1630   168%     -  587s
     0     0 16237.0610    0  365 6075.74070 16237.0610   167%     -  593s
     0     0 16154.5480    0  357 6075.74070 16154.5480   166%     -  606s
     0     0 16136.0861    0  363 6075.74070 16136.0861   166%     -  610s
     0     0 16113.0298    0  360 6075.74070 16113.0298   165%     -  618s
     0     0 16106.5444    0  365 6075.74070 16106.5444   165%     -  621s
     0     0 16074.0263    0  363 6075.74070 16074.0263   165%     -  631s
     0     0 16066.7460    0  366 6075.74070 16066.7460   164%     -  635s
     0     0 16063.7928    0  371 6075.74070 16063.7928   164%     -  637s
     0     0 16062.6119    0  371 6075.74070 16062.6119   164%     -  639s
     0     0 15561.9587    0  358 6075.74070 15561.9587   156%     -  675s
     0     0 15465.7689    0  357 6075.74070 15465.7689   155%     -  689s
     0     0 15412.2936    0  364 6075.74070 15412.2936   154%     -  705s
     0     0 15396.0163    0  372 6075.74070 15396.0163   153%     -  715s
     0     0 15379.7843    0  381 6075.74070 15379.7843   153%     -  723s
     0     0 15375.0677    0  383 6075.74070 15375.0677   153%     -  730s
     0     0 15370.6972    0  373 6075.74070 15370.6972   153%     -  735s
     0     0 15369.5704    0  376 6075.74070 15369.5704   153%     -  737s
     0     0 15162.3846    0  358 6075.74070 15162.3846   150%     -  769s
H    0     0                    6173.5287823 15162.1640   146%     -  770s
     0     0 15087.5284    0  428 6173.52878 15087.5284   144%     -  797s
     0     0 15050.4186    0  378 6173.52878 15050.4186   144%     -  806s
     0     0 15031.3111    0  374 6173.52878 15031.3111   143%     -  816s
     0     0 15020.2584    0  423 6173.52878 15020.2584   143%     -  822s
     0     0 15017.0017    0  428 6173.52878 15017.0017   143%     -  826s
     0     0 15013.5684    0  430 6173.52878 15013.5684   143%     -  829s
     0     0 15012.4936    0  434 6173.52878 15012.4936   143%     -  832s
     0     0 14953.4370    0  370 6173.52878 14953.4370   142%     -  851s
H    0     0                    6220.5975619 14953.3454   140%     -  872s
     0     0 14930.8609    0  427 6220.59756 14930.8609   140%     -  888s
     0     0 14925.2145    0  418 6220.59756 14925.2145   140%     -  897s
     0     0 14918.5445    0  425 6220.59756 14918.5445   140%     -  903s
     0     0 14917.1187    0  428 6220.59756 14917.1187   140%     -  906s
     0     0 14885.5270    0  527 6220.59756 14885.5270   139%     -  926s
     0     0 14875.3508    0  533 6220.59756 14875.3508   139%     -  937s
     0     0 14869.9400    0  484 6220.59756 14869.9400   139%     -  945s
     0     0 14827.1290    0  380 6220.59756 14827.1290   138%     -  958s
     0     0 14804.2629    0  422 6220.59756 14804.2629   138%     -  966s
     0     0 14794.6676    0  424 6220.59756 14794.6676   138%     -  970s
     0     0 14789.1260    0  424 6220.59756 14789.1260   138%     -  975s
     0     0 14787.3789    0  470 6220.59756 14787.3789   138%     -  977s
     0     0 14711.5851    0  386 6220.59756 14711.5851   136%     -  991s
     0     0 14695.4795    0  392 6220.59756 14695.4795   136%     - 1002s
     0     0 14688.4704    0  438 6220.59756 14688.4704   136%     - 1007s
     0     0 14685.2005    0  384 6220.59756 14685.2005   136%     - 1011s
     0     0 14683.5983    0  384 6220.59756 14683.5983   136%     - 1015s
     0     0 14677.7267    0  379 6220.59756 14677.7267   136%     - 1024s
H    0     0                    6222.6647409 14676.4245   136%     - 1025s
     0     0 14675.8911    0  393 6222.66474 14675.8911   136%     - 1028s
     0     0 14656.3470    0  374 6222.66474 14656.3470   136%     - 1039s
H    0     0                    6283.5038166 14656.2283   133%     - 1060s
     0     0 14652.0632    0  380 6283.50382 14652.0632   133%     - 1065s
     0     0 14638.9434    0  403 6283.50382 14638.9434   133%     - 1074s
     0     0 14633.7046    0  436 6283.50382 14633.7046   133%     - 1082s
     0     0 14631.6769    0  435 6283.50382 14631.6769   133%     - 1085s
     0     0 14625.2690    0  434 6283.50382 14625.2690   133%     - 1092s
     0     0 14619.4764    0  441 6283.50382 14619.4764   133%     - 1100s
     0     0 14616.1836    0  444 6283.50382 14616.1836   133%     - 1106s
     0     0 14615.8034    0  445 6283.50382 14615.8034   133%     - 1108s
     0     0 14600.7844    0  407 6283.50382 14600.7844   132%     - 1121s
     0     0 14588.3292    0  412 6283.50382 14588.3292   132%     - 1128s
     0     0 14586.9236    0  406 6283.50382 14586.9236   132%     - 1130s
     0     0 14561.4887    0  413 6283.50382 14561.4887   132%     - 1146s
     0     0 14555.1718    0  405 6283.50382 14555.1718   132%     - 1153s
     0     0 14553.2934    0  411 6283.50382 14553.2934   132%     - 1158s
     0     0 14550.0410    0  407 6283.50382 14550.0410   132%     - 1166s
     0     0 14549.4748    0  410 6283.50382 14549.4748   132%     - 1168s
     0     0 14545.3077    0  405 6283.50382 14545.3077   131%     - 1174s
     0     0 14544.8399    0  410 6283.50382 14544.8399   131%     - 1178s
     0     0 14539.8909    0  406 6283.50382 14539.8909   131%     - 1187s
     0     0 14538.3777    0  406 6283.50382 14538.3777   131%     - 1194s
     0     2 14538.3777    0  406 6283.50382 14538.3777   131%     - 1432s
     1     4 14407.4156    1  401 6283.50382 14538.3777   131%  8694 1466s
     3     8 14213.6665    2  420 6283.50382 14407.3580   129% 13432 1487s
     7    16 14148.2824    3  426 6283.50382 14323.5544   128% 10714 1519s
    15    32 13955.7092    4  430 6283.50382 14148.1571   125% 12979 1552s
    31    48 12016.8254    5  347 6283.50382 13955.4032   122% 17628 1628s
    47    80 10260.5121    6  216 6283.50382 13955.4032   122% 19255 1664s
H   48    80                    6286.5826107 13955.4032   122% 18854 1664s
H   50    80                    6331.4779021 13955.4032   120% 18568 1664s
    79   147 10154.1811    7  209 6331.47790 13955.4032   120% 14992 1775s
   156   243 10133.8110    8  204 6331.47790 13955.4032   120% 10633 1814s
H  189   243                    6345.7826909 13955.4032   120%  9750 1814s
H  194   243                    6361.5919886 13955.4032   119%  9540 1814s
H  209   243                    6402.3309207 13955.4032   118%  8989 1815s
   261   328 9723.52560   10  212 6402.33092 13955.4032   118%  8591 1843s
   353   396 9078.29904   10  156 6402.33092 13955.4032   118%  7467 1866s
   444   427 9183.49043   12  123 6402.33092 13955.4032   118%  6826 1887s
   521   443 8093.43257   12  140 6402.33092 13955.4032   118%  6591 1907s
   554   469 infeasible   14      6402.33092 13955.4032   118%  6595 1927s
   600   489 11544.4945    9  257 6402.33092 13955.4032   118%  6710 1950s
   650   492 8045.01081   10  107 6402.33092 13955.4032   118%  6671 1970s
   703   508 8024.71853   11   86 6402.33092 13955.4032   118%  6521 1990s
   764   522 7546.91585   15   66 6402.33092 13955.4032   118%  6399 2008s
   812   549 6995.73786   19   29 6402.33092 13955.4032   118%  6371 2027s
   867   568 6833.88809   24   19 6402.33092 13955.4032   118%  6249 2047s
   925   594 6576.47732   22  174 6402.33092 13955.4032   118%  6080 2068s
   976   603 infeasible   23      6402.33092 13955.4032   118%  6007 2092s
  1035   630 7161.47196   22  204 6402.33092 13955.4032   118%  6100 2113s
  1093   639 6777.70664   24  188 6402.33092 13955.4032   118%  6110 2135s
  1146   661 8558.30953   16  292 6402.33092 13955.4032   118%  6095 2159s
  1210   688 8460.97684   18  236 6402.33092 13955.4032   118%  6093 2184s
  1275   745 8122.11805   20  241 6402.33092 13955.4032   118%  6026 2209s
  1368   793 7926.27217   23  294 6402.33092 13955.4032   118%  5929 2235s
  1464   826 7522.00152   28  270 6402.33092 13955.4032   118%  5829 2261s
  1569   846 7371.10344   33  208 6402.33092 13955.4032   118%  5762 2290s
  1609   876 7231.73101   34  217 6402.33092 13955.4032   118%  5764 2317s
  1677   877 6829.85965   38  158 6402.33092 13955.4032   118%  5716 2347s
  1774   907 6574.80961   45  179 6402.33092 13955.4032   118%  5681 2379s
  1875   930     cutoff   48      6402.33092 13955.4032   118%  5623 2412s
  1991   960 10342.5952   12  335 6402.33092 13955.4032   118%  5644 2448s
  2078   980 9951.63707   13  250 6402.33092 13955.4032   118%  5764 2483s
  2182  1006 9188.02040   15  318 6402.33092 13955.4032   118%  5833 2521s
  2261  1023 7689.02740   17  242 6402.33092 13955.4032   118%  5999 2560s
  2374  1046 6940.72393   20  219 6402.33092 13955.4032   118%  6051 2603s
  2476  1073 infeasible   25      6402.33092 13955.4032   118%  6161 2644s
  2585  1117 9703.12872    8  228 6402.33092 13955.4032   118%  6294 2687s
  2702  1139 8875.36174    9  217 6402.33092 13955.4032   118%  6408 2735s
  2801  1182 infeasible   13      6402.33092 13716.2591   114%  6565 2776s
  2915  1222 13243.8645    6  374 6402.33092 13716.1864   114%  6694 2817s
  3015  1263 12433.7994    7  415 6402.33092 13716.1864   114%  6775 2863s
  3148  1324 11073.7533    8  409 6402.33092 13716.1864   114%  6809 2911s
  3302  1377 10221.1657    9  387 6402.33092 13716.1864   114%  6858 2960s
  3502  1459 9977.57596   10  399 6402.33092 13716.1864   114%  6853 3014s
  3654  1485 9773.03060   11  374 6402.33092 13716.1864   114%  6936 3063s
  3692  1495 9516.72014   12  355 6402.33092 13716.1864   114%  6987 3118s
  3750  1518 9506.18162   13  351 6402.33092 13716.1864   114%  7011 3162s
  3799  1532 9324.31860   14  338 6402.33092 13241.6850   107%  7043 3219s
  3849  1559 9133.38211   15  319 6402.33092 13241.6850   107%  7048 3273s
  3928  1603 9061.77831   16  314 6402.33092 13241.6850   107%  7053 3335s
  4077  1665 8835.47792   19  204 6402.33092 11329.8854  77.0%  7057 3393s
  4237  1718 8287.55995   28  121 6402.33092 11329.8854  77.0%  7047 3452s
  4423  1831 7726.68875   37  302 6402.33092 11329.8854  77.0%  7099 3523s
  4677  1879 infeasible   54      6402.33092 11093.3491  73.3%  7095 3593s
  4962  1879 infeasible   13      6402.33092 11093.3491  73.3%  7092 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 193
  MIR: 2651
  Flow cover: 3009
  Inf proof: 1
  RLT: 81
  Relax-and-lift: 444
  BQP: 3
  PSD: 2

Explored 5004 nodes (36025579 simplex iterations) in 3600.08 seconds (6158.32 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6402.33 6361.59 6345.78 ... 6075.74

Time limit reached
Best objective 6.402330920650e+03, best bound 1.109334914414e+04, gap 73.2705%
  WARNING: Time limit reached. Using best solution found (gap: 73.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 6402.33, θ = 135371.39
  Upper Bound (UB) = 6402.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135371.39
  [DEBUG]   ✓ Scenario 0: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135371.39 ≤ Q = 137446.06 (slack: 2074.68)
  [DEBUG]   ✓ Scenario 5: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 135371.39 ≤ Q = 135371.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x70fbb39b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8f044c65
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6665240.9052
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.353359e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135335.94    0  123 6665240.91 -135335.94   102%     -    0s
H    0     0                    -106482.4881 -135335.94  27.1%     -    0s
H    0     0                    -106635.6492 -135335.94  26.9%     -    0s
     0     0 -110850.84    0   45 -106635.65 -110850.84  3.95%     -    0s
H    0     0                    -108690.0788 -110765.16  1.91%     -    0s
     0     0 -110393.21    0   49 -108690.08 -110393.21  1.57%     -    0s
H    0     0                    -109136.5252 -110316.52  1.08%     -    0s
H    0     0                    -109303.4869 -109988.80  0.63%     -    0s
     0     0 -109988.80    0   33 -109303.49 -109988.80  0.63%     -    0s
H    0     0                    -109333.2310 -109963.86  0.58%     -    0s
     0     0 -109963.86    0   42 -109333.23 -109963.86  0.58%     -    0s
     0     0 -109963.64    0   42 -109333.23 -109963.64  0.58%     -    0s
     0     0 -109644.83    0   18 -109333.23 -109644.83  0.29%     -    0s
     0     0 -109584.68    0   23 -109333.23 -109584.68  0.23%     -    0s
     0     0 -109568.20    0   23 -109333.23 -109568.20  0.21%     -    0s
     0     0 -109485.20    0   15 -109333.23 -109485.20  0.14%     -    0s
     0     0 -109473.10    0   16 -109333.23 -109473.10  0.13%     -    0s
     0     0 -109440.46    0   14 -109333.23 -109440.46  0.10%     -    0s
     0     0 -109440.46    0   30 -109333.23 -109440.46  0.10%     -    0s
     0     0 -109392.68    0   12 -109333.23 -109392.68  0.05%     -    0s
H    0     0                    -109359.4600 -109391.77  0.03%     -    0s
H    0     0                    -109365.9288 -109391.77  0.02%     -    0s
     0     0 -109390.23    0   12 -109365.93 -109390.23  0.02%     -    0s
     0     0 -109390.20    0   12 -109365.93 -109390.20  0.02%     -    0s
     0     0          -    0      -109365.93 -109376.35  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 3
  MIR: 28
  Flow cover: 8
  Relax-and-lift: 3

Explored 1 nodes (740 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -109366 -109359 -109333 ... 1.48645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.093659288138e+05, best bound -1.093763515792e+05, gap 0.0095%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 134018.62
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109365.93
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -109365.93 = 134018.62
  [DEBUG]   Current θ from Master = 135371.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1352.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5049.56
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 221.9013, Absolute Gap = 221.9013, Relative Gap = 0.034659
  Not converged yet (gap = 221.90 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740038 nonzeros
Model fingerprint: 0x8c9c4556
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 133926 rows and 54366 columns (presolve time = 5s)...
Presolve removed 133926 rows and 54366 columns
Presolve time: 5.82s
Presolved: 127387 rows, 53974 columns, 787607 nonzeros
Variable types: 51715 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.70s

Barrier statistics:
 Dense cols : 587
 AA' NZ     : 6.537e+06
 Factor NZ  : 1.409e+07 (roughly 200 MB of memory)
 Factor Ops : 3.101e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89475687e+07  2.27258372e+08  9.21e+04 1.79e+01  7.82e+04     9s
   1  -1.44047775e+07  1.99298320e+08  6.44e+04 6.11e+01  5.43e+04    10s
   2  -4.48813853e+06  1.53448692e+08  1.95e+04 8.68e+00  1.71e+04    10s
   3  -1.61049630e+06  1.37749663e+08  4.04e+03 5.32e+00  3.95e+03    10s
   4  -8.09641885e+05  9.06765316e+07  6.83e+02 1.97e+00  9.26e+02    10s
   5  -7.14892883e+05  6.44928727e+07  3.42e+02 1.23e+00  5.29e+02    10s
   6  -4.83254340e+05  4.59728634e+07  2.17e+02 8.05e-01  3.48e+02    10s
   7  -4.19580215e+05  3.73669083e+07  1.02e+02 6.22e-01  2.29e+02    10s
   8  -3.37452585e+05  2.40258171e+07  1.40e+01 3.54e-01  1.13e+02    10s
   9  -2.87618910e+05  1.42281552e+07  1.04e+01 1.91e-02  6.65e+01    10s
  10  -1.54103491e+05  8.09173857e+06  1.99e+00 1.05e-02  3.59e+01    11s
  11  -1.17839599e+05  4.02798760e+06  1.26e+00 5.17e-03  1.80e+01    11s
  12  -9.15596850e+04  2.62911079e+06  6.87e-01 3.35e-03  1.18e+01    11s
  13  -6.20831353e+04  1.86583921e+06  2.45e-01 2.36e-03  8.30e+00    11s
  14  -3.78338466e+04  9.05964177e+05  8.14e-02 1.13e-03  4.06e+00    11s
  15  -2.11432898e+04  3.96850563e+05  3.59e-02 5.02e-04  1.80e+00    11s
  16  -8.31498852e+03  2.09835249e+05  1.96e-02 3.60e-04  9.37e-01    11s
  17  -3.20023543e+03  1.59321275e+05  1.60e-02 4.96e-04  6.98e-01    11s
  18   2.97189368e+03  1.19952803e+05  1.19e-02 7.41e-04  5.03e-01    11s
  19   7.73707752e+03  8.98201868e+04  8.97e-03 5.32e-04  3.53e-01    12s
  20   1.07417898e+04  7.94243556e+04  7.45e-03 4.47e-04  2.95e-01    12s
  21   1.14354746e+04  7.13056232e+04  7.14e-03 6.98e-04  2.57e-01    12s
  22   1.55031492e+04  6.23626759e+04  5.26e-03 7.08e-04  2.01e-01    12s
  23   1.80018647e+04  5.34382270e+04  4.24e-03 1.19e-03  1.52e-01    12s
  24   2.02567191e+04  5.01322729e+04  3.38e-03 1.02e-03  1.28e-01    12s
  25   2.24653030e+04  4.33295137e+04  2.56e-03 7.91e-04  8.96e-02    12s
  26   2.49906136e+04  4.03280243e+04  1.68e-03 5.36e-04  6.59e-02    12s
  27   2.65477393e+04  3.69163586e+04  1.19e-03 2.87e-04  4.46e-02    13s
  28   2.77221671e+04  3.46605662e+04  8.26e-04 1.86e-04  2.98e-02    13s
  29   2.87934281e+04  3.33933068e+04  5.09e-04 1.16e-04  1.98e-02    13s
  30   2.93528261e+04  3.24034050e+04  3.46e-04 7.10e-05  1.31e-02    13s
  31   2.97170980e+04  3.18308448e+04  2.37e-04 4.73e-05  9.08e-03    13s
  32   3.00363339e+04  3.13065927e+04  1.49e-04 2.52e-05  5.46e-03    13s
  33   3.01628456e+04  3.10801810e+04  1.18e-04 1.58e-05  3.94e-03    13s
  34   3.02944617e+04  3.08804481e+04  8.57e-05 7.42e-06  2.52e-03    14s
  35   3.03446079e+04  3.08532618e+04  7.46e-05 6.35e-06  2.19e-03    14s
  36   3.04090055e+04  3.08011975e+04  6.05e-05 4.31e-06  1.68e-03    14s
  37   3.04907809e+04  3.07476076e+04  4.16e-05 2.38e-06  1.10e-03    14s
  38   3.05608199e+04  3.07173322e+04  2.65e-05 1.08e-06  6.72e-04    14s
  39   3.06136321e+04  3.07034722e+04  1.47e-05 1.70e-06  3.86e-04    14s
  40   3.06370874e+04  3.06988386e+04  9.53e-06 1.31e-06  2.65e-04    15s
  41   3.06706745e+04  3.06875245e+04  2.57e-06 3.13e-07  7.24e-05    15s
  42   3.06770577e+04  3.06860054e+04  1.20e-06 1.84e-07  3.84e-05    15s
  43   3.06824131e+04  3.06844999e+04  1.40e-07 7.92e-08  8.97e-06    15s
  44   3.06829007e+04  3.06838952e+04  9.02e-08 3.88e-08  4.28e-06    15s
  45   3.06833332e+04  3.06834090e+04  3.30e-08 5.96e-08  3.26e-07    15s
  46   3.06833500e+04  3.06833520e+04  5.09e-09 4.39e-09  8.60e-09    16s
  47   3.06833507e+04  3.06833507e+04  1.23e-08 3.95e-09  1.57e-10    16s

Barrier solved model in 47 iterations and 15.63 seconds (12.68 work units)
Optimal objective 3.06833507e+04


Root crossover log...

  107958 DPushes remaining with DInf 0.0000000e+00                16s
    1666 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    3264 PPushes remaining with PInf 1.9663024e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7424930e+00     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   51334    3.0683351e+04   0.000000e+00   1.742493e+00     22s
   51338    3.0683351e+04   0.000000e+00   0.000000e+00     22s
   51338    3.0683351e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 3.068335e+04, 51338 iterations, 15.07 seconds (18.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30683.3507    0  304 -170236.42 30683.3507   118%     -   23s
H    0     0                    -165556.9000 30683.3507   119%     -   23s
H    0     0                    -91607.77125 30683.3507   133%     -   23s
H    0     0                    -90953.63851 30683.3507   134%     -   23s
H    0     0                    -31035.96384 30683.3507   199%     -   24s
H    0     0                    -31015.24361 30683.3507   199%     -   24s
H    0     0                    -19710.20821 23532.2576   219%     -  135s
H    0     0                    -10790.55855 23532.2576   318%     -  135s
     0     0 23532.2576    0  267 -10790.559 23532.2576   318%     -  136s
H    0     0                    -8459.734313 23531.8930   378%     -  137s
H    0     0                    -7371.520362 23531.8930   419%     -  137s
     0     0 23022.2377    0  273 -7371.5204 23022.2377   412%     -  170s
     0     0 22982.0525    0  273 -7371.5204 22982.0525   412%     -  178s
     0     0 22891.5384    0  273 -7371.5204 22891.5384   411%     -  189s
     0     0 22883.8280    0  273 -7371.5204 22883.8280   410%     -  194s
     0     0 22883.8280    0  273 -7371.5204 22883.8280   410%     -  197s
     0     0 22827.9256    0  274 -7371.5204 22827.9256   410%     -  200s
     0     0 22820.6933    0  274 -7371.5204 22820.6933   410%     -  202s
     0     0 22820.6933    0  274 -7371.5204 22820.6933   410%     -  203s
     0     0 19693.5539    0  356 -7371.5204 19693.5539   367%     -  276s
H    0     0                    -6470.688266 19693.1433   404%     -  277s
H    0     0                    -6135.860500 19693.1433   421%     -  277s
H    0     0                     424.9127686 19122.1801  4400%     -  326s
H    0     0                     780.0832758 19122.1801  2351%     -  326s
H    0     0                     997.0410694 19122.1801  1818%     -  326s
H    0     0                    1017.5314345 19122.1801  1779%     -  326s
H    0     0                    1095.0762296 19122.1801  1646%     -  326s
H    0     0                    1205.5775074 19122.1801  1486%     -  326s
H    0     0                    1217.3929475 19122.1801  1471%     -  326s
H    0     0                    1217.6977856 19122.1801  1470%     -  326s
H    0     0                    1242.4158730 19122.1801  1439%     -  326s
     0     0 19122.1801    0  365 1242.41587 19122.1801  1439%     -  326s
     0     0 19032.4129    0  374 1242.41587 19032.4129  1432%     -  351s
     0     0 18989.0092    0  417 1242.41587 18989.0092  1428%     -  370s
     0     0 18888.6723    0  417 1242.41587 18888.6723  1420%     -  398s
     0     0 18874.9654    0  420 1242.41587 18874.9654  1419%     -  410s
     0     0 18859.9777    0  418 1242.41587 18859.9777  1418%     -  419s
     0     0 18836.2565    0  417 1242.41587 18836.2565  1416%     -  426s
     0     0 18826.5047    0  418 1242.41587 18826.5047  1415%     -  430s
     0     0 18780.9336    0  412 1242.41587 18780.9336  1412%     -  440s
     0     0 18777.5174    0  415 1242.41587 18777.5174  1411%     -  447s
     0     0 18766.8328    0  422 1242.41587 18766.8328  1411%     -  453s
     0     0 18704.2932    0  416 1242.41587 18704.2932  1405%     -  466s
     0     0 18650.1572    0  413 1242.41587 18650.1572  1401%     -  478s
     0     0 18639.6958    0  414 1242.41587 18639.6958  1400%     -  483s
     0     0 18626.0407    0  414 1242.41587 18626.0407  1399%     -  487s
     0     0 18458.4790    0  410 1242.41587 18458.4790  1386%     -  502s
     0     0 18452.3397    0  418 1242.41587 18452.3397  1385%     -  508s
     0     0 18451.4899    0  415 1242.41587 18451.4899  1385%     -  510s
     0     0 17247.6378    0  345 1242.41587 17247.6378  1288%     -  599s
H    0     0                    1473.9561771 17247.3621  1070%     -  601s
H    0     0                    1481.6654509 17247.3621  1064%     -  601s
     0     0 17070.5093    0  358 1481.66545 17070.5093  1052%     -  631s
     0     0 16927.0540    0  359 1481.66545 16927.0540  1042%     -  656s
     0     0 16811.8352    0  350 1481.66545 16811.8352  1035%     -  671s
     0     0 16780.0801    0  351 1481.66545 16780.0801  1033%     -  683s
     0     0 16728.3131    0  360 1481.66545 16728.3131  1029%     -  697s
     0     0 16637.8392    0  347 1481.66545 16637.8392  1023%     -  710s
     0     0 16613.9369    0  353 1481.66545 16613.9369  1021%     -  717s
     0     0 16586.8374    0  362 1481.66545 16586.8374  1019%     -  724s
     0     0 16583.0537    0  355 1481.66545 16583.0537  1019%     -  728s
     0     0 16580.0626    0  355 1481.66545 16580.0626  1019%     -  731s
     0     0 16578.3470    0  357 1481.66545 16578.3470  1019%     -  733s
H    0     0                    2183.6067606 15912.0183   629%     -  789s
H    0     0                    4375.6451988 15912.0183   264%     -  789s
H    0     0                    5183.8886428 15912.0183   207%     -  789s
H    0     0                    5895.3920368 15912.0183   170%     -  789s
     0     0 15912.0183    0  347 5895.39204 15912.0183   170%     -  789s
H    0     0                    5913.6686535 15767.7063   167%     -  815s
     0     0 15767.7063    0  363 5913.66865 15767.7063   167%     -  815s
     0     0 15718.8457    0  415 5913.66865 15718.8457   166%     -  826s
     0     0 15658.9899    0  364 5913.66865 15658.9899   165%     -  839s
     0     0 15610.9785    0  373 5913.66865 15610.9785   164%     -  849s
     0     0 15589.1185    0  374 5913.66865 15589.1185   164%     -  855s
     0     0 15563.7652    0  366 5913.66865 15563.7652   163%     -  863s
     0     0 15556.4369    0  375 5913.66865 15556.4369   163%     -  868s
     0     0 15549.6558    0  382 5913.66865 15549.6558   163%     -  871s
     0     0 15456.3941    0  380 5913.66865 15456.3941   161%     -  881s
     0     0 15429.6203    0  378 5913.66865 15429.6203   161%     -  890s
     0     0 15415.5825    0  392 5913.66865 15415.5825   161%     -  895s
     0     0 15411.6340    0  391 5913.66865 15411.6340   161%     -  899s
     0     0 15409.5367    0  397 5913.66865 15409.5367   161%     -  902s
     0     0 15351.6737    0  392 5913.66865 15351.6737   160%     -  913s
     0     0 15323.5838    0  384 5913.66865 15323.5838   159%     -  922s
     0     0 15318.9897    0  382 5913.66865 15318.9897   159%     -  926s
     0     0 15317.1486    0  386 5913.66865 15317.1486   159%     -  929s
     0     0 15122.5010    0  387 5913.66865 15122.5010   156%     -  963s
H    0     0                    6317.8878165 15122.3914   139%     -  964s
     0     0 15064.9220    0  392 6317.88782 15064.9220   138%     -  984s
     0     0 15047.6611    0  381 6317.88782 15047.6611   138%     -  990s
     0     0 15039.0052    0  389 6317.88782 15039.0052   138%     -  996s
H    0     0                    6403.5584201 15014.2131   134%     - 1007s
     0     0 15014.2131    0  386 6403.55842 15014.2131   134%     - 1007s
     0     0 14953.5394    0  373 6403.55842 14953.5394   134%     - 1026s
     0     0 14942.5028    0  391 6403.55842 14942.5028   133%     - 1034s
     0     0 14937.0467    0  391 6403.55842 14937.0467   133%     - 1038s
     0     0 14934.3208    0  389 6403.55842 14934.3208   133%     - 1040s
     0     0 14926.2759    0  384 6403.55842 14926.2759   133%     - 1043s
     0     0 14916.8465    0  385 6403.55842 14916.8465   133%     - 1050s
     0     0 14915.5183    0  380 6403.55842 14915.5183   133%     - 1053s
     0     0 14849.6826    0  492 6403.55842 14849.6826   132%     - 1080s
     0     0 14817.4589    0  402 6403.55842 14817.4589   131%     - 1115s
     0     0 14773.7349    0  454 6403.55842 14773.7349   131%     - 1130s
     0     0 14750.5970    0  399 6403.55842 14750.5970   130%     - 1141s
     0     0 14739.7697    0  457 6403.55842 14739.7697   130%     - 1149s
     0     0 14733.3134    0  410 6403.55842 14733.3134   130%     - 1154s
     0     0 14732.6788    0  415 6403.55842 14732.6788   130%     - 1156s
     0     0 14638.6798    0  402 6403.55842 14638.6798   129%     - 1179s
     0     0 14622.1421    0  458 6403.55842 14622.1421   128%     - 1190s
     0     0 14611.7462    0  459 6403.55842 14611.7462   128%     - 1198s
     0     0 14605.5459    0  461 6403.55842 14605.5459   128%     - 1205s
     0     0 14599.6906    0  459 6403.55842 14599.6906   128%     - 1210s
     0     0 14596.9042    0  468 6403.55842 14596.9042   128%     - 1212s
     0     0 14595.4960    0  469 6403.55842 14595.4960   128%     - 1215s
     0     0 14577.0181    0  458 6403.55842 14577.0181   128%     - 1226s
     0     0 14563.0663    0  458 6403.55842 14563.0663   127%     - 1239s
     0     0 14558.3375    0  470 6403.55842 14558.3375   127%     - 1247s
     0     0 14556.5682    0  468 6403.55842 14556.5682   127%     - 1251s
     0     0 14538.8916    0  457 6403.55842 14538.8916   127%     - 1265s
     0     0 14532.9043    0  471 6403.55842 14532.9043   127%     - 1271s
     0     0 14526.9819    0  459 6403.55842 14526.9819   127%     - 1278s
     0     0 14524.4365    0  467 6403.55842 14524.4365   127%     - 1281s
     0     0 14523.3311    0  467 6403.55842 14523.3311   127%     - 1283s
     0     0 14509.4631    0  471 6403.55842 14509.4631   127%     - 1297s
     0     0 14500.7936    0  414 6403.55842 14500.7936   126%     - 1310s
     0     0 14494.3958    0  403 6403.55842 14494.3958   126%     - 1314s
     0     0 14492.9440    0  408 6403.55842 14492.9440   126%     - 1316s
     0     0 14486.1503    0  408 6403.55842 14486.1503   126%     - 1324s
     0     0 14482.8282    0  406 6403.55842 14482.8282   126%     - 1331s
     0     0 14476.9110    0  402 6403.55842 14476.9110   126%     - 1336s
     0     0 14474.8354    0  414 6403.55842 14474.8354   126%     - 1339s
     0     0 14464.6055    0  416 6403.55842 14464.6055   126%     - 1348s
     0     0 14455.2746    0  414 6403.55842 14455.2746   126%     - 1400s
     0     0 14452.8818    0  450 6403.55842 14452.8818   126%     - 1406s
     0     0 14452.4475    0  406 6403.55842 14452.4475   126%     - 1408s
     0     0 14444.0535    0  409 6403.55842 14444.0535   126%     - 1419s
     0     0 14441.0291    0  403 6403.55842 14441.0291   126%     - 1424s
     0     0 14439.7926    0  406 6403.55842 14439.7926   125%     - 1426s
     0     0 14425.2944    0  446 6403.55842 14425.2944   125%     - 1438s
     0     0 14424.8840    0  446 6403.55842 14424.8840   125%     - 1448s
     0     2 14424.7691    0  446 6403.55842 14424.7691   125%     - 1675s
     1     3 13686.4442    1  285 6403.55842 14424.7691   125% 10499 1696s
     2     4 14258.0086    1  391 6403.55842 14258.0086   123%  8232 1708s
     3     7 13176.5290    2  329 6403.55842 14257.8709   123%  8614 1729s
     6    11 12185.9656    3  201 6403.55842 14254.7415   123%  7466 1761s
    10    21 12087.7703    4  299 6403.55842 14224.9457   122%  9121 1791s
    20    31 12977.5969    4  371 6403.55842 14079.7209   120% 12774 1853s
    30    61 12494.1274    5  464 6403.55842 14079.7209   120% 14151 2082s
    60    93 12188.5552    6  433 6403.55842 13767.1822   115% 20869 2127s
    92   126 12163.5281    7  438 6403.55842 13499.0895   111% 18551 2170s
   125   205 12140.3723    8  444 6403.55842 13499.0852   111% 15049 2213s
   204   249 11948.8174   12  397 6403.55842 13499.0852   111% 10909 2253s
   271   292 9949.40106   13  352 6403.55842 13499.0852   111%  9755 2286s
   327   316 9602.61321   14  363 6403.55842 13499.0852   111%  9443 2317s
   383   339 8487.65564   15  349 6403.55842 13499.0852   111%  9096 2347s
   435   354 9960.71798   12  352 6403.55842 13499.0852   111%  8921 2379s
   483   393 6952.10665   15  338 6403.55842 13499.0852   111%  9076 2406s
   540   414     cutoff   16      6403.55842 13499.0852   111%  9006 2438s
   581   458     cutoff   16      6403.55842 13499.0852   111%  9064 2468s
   647   519 9044.20291   16  241 6403.55842 13499.0852   111%  8883 2494s
   734   561 infeasible   17      6403.55842 13244.7642   107%  8465 2520s
   816   613 8289.72751   24  176 6403.55842 13244.7642   107%  8263 2548s
   904   651 infeasible   18      6403.55842 13244.7642   107%  7938 2574s
   990   670     cutoff   19      6403.55842 13244.7642   107%  7722 2599s
  1049   729 7376.32780   21  160 6403.55842 13244.7642   107%  7654 2627s
  1145   820 6968.59808   24  205 6403.55842 13244.7642   107%  7400 2655s
  1270   858 6525.23649   32  121 6403.55842 13244.7642   107%  7066 2682s
  1373   925 8596.93676   14  309 6403.55842 13172.7741   106%  6916 2711s
  1482   972 8414.57939   15  334 6403.55842 13172.7741   106%  6722 2743s
  1601   980 7996.34198   17  323 6403.55842 13172.7741   106%  6577 2773s
  1652  1019 8074.45067   17  327 6403.55842 13172.7741   106%  6622 2803s
  1733  1045 7627.84662   18  321 6403.55842 13172.7741   106%  6698 2834s
  1815  1095 7201.16622   20  247 6403.55842 13172.7741   106%  6740 2869s
  1897  1105 6437.11455   25  215 6403.55842 13172.7741   106%  6817 2904s
  2001  1146 11437.7020    8  272 6403.55842 13172.7741   106%  6821 2943s
  2082  1190 7830.56186   34  218 6403.55842 13172.7741   106%  6953 2984s
  2157  1221 8338.85974    9  106 6403.55842 13172.7741   106%  7007 3025s
  2232  1229 6755.27354   12   65 6403.55842 13172.7741   106%  7068 3064s
  2321  1271 11410.8254    8  293 6403.55842 13172.7741   106%  7145 3104s
  2391  1302 10250.3724   10  160 6403.55842 13172.7741   106%  7247 3147s
  2508  1370 7729.70351   12  217 6403.55842 13172.7741   106%  7318 3192s
  2628  1432 infeasible   14      6403.55842 13172.7741   106%  7365 3237s
  2786  1545 6710.20631   18  223 6403.55842 12271.5598  91.6%  7349 3281s
  2959  1613 infeasible   19      6403.55842 12229.0607  91.0%  7290 3333s
  3134  1686 10804.8113   11  306 6403.55842 11860.2917  85.2%  7291 3385s
  3320  1789 8738.86383   14  235 6403.55842 11858.5351  85.2%  7209 3437s
  3479  1811 7965.05591   19  239 6403.55842 11858.5351  85.2%  7272 3493s
  3519  1829 7886.03271   20  240 6403.55842 11858.5351  85.2%  7327 3542s
  3571  1856 7806.77913   21  237 6403.55842 11734.1426  83.2%  7351 3594s
  3633  1856 6696.70692   21  125 6403.55842 11734.1426  83.2%  7362 3600s

Cutting planes:
  Learned: 3
  Gomory: 8
  Implied bound: 230
  MIR: 2949
  Flow cover: 2989
  RLT: 48
  Relax-and-lift: 453

Explored 3657 nodes (27532868 simplex iterations) in 3600.09 seconds (5719.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6403.56 6317.89 5913.67 ... 1242.42

Time limit reached
Best objective 6.403558420102e+03, best bound 1.173414255933e+04, gap 83.2441%
  WARNING: Time limit reached. Using best solution found (gap: 83.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 6403.56, θ = 135146.84
  Upper Bound (UB) = 6403.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135146.84
  [DEBUG]   ✓ Scenario 0: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 135146.84 ≤ Q = 135146.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x341e92fb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x341e92fb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.476448e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6578988.0038
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.355902e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135590.15    0  123 6578988.00 -135590.15   102%     -    0s
H    0     0                    -106735.1822 -135590.15  27.0%     -    0s
H    0     0                    -106888.3432 -135590.15  26.9%     -    0s
     0     0 -111505.10    0   75 -106888.34 -111505.10  4.32%     -    0s
H    0     0                    -108640.2929 -111401.52  2.54%     -    0s
H    0     0                    -109389.8484 -111401.52  1.84%     -    0s
     0     0 -110828.45    0   77 -109389.85 -110828.45  1.32%     -    0s
     0     0 -110311.43    0   81 -109389.85 -110311.43  0.84%     -    0s
     0     0 -110240.76    0   81 -109389.85 -110240.76  0.78%     -    0s
     0     0 -109918.34    0   70 -109389.85 -109918.34  0.48%     -    0s
     0     0 -109858.71    0   78 -109389.85 -109858.71  0.43%     -    0s
     0     0 -109855.46    0   78 -109389.85 -109855.46  0.43%     -    0s
     0     0 -109711.77    0   57 -109389.85 -109711.77  0.29%     -    0s
     0     0 -109689.71    0   64 -109389.85 -109689.71  0.27%     -    0s
     0     0 -109641.45    0   63 -109389.85 -109641.45  0.23%     -    0s
     0     0 -109630.29    0   63 -109389.85 -109630.29  0.22%     -    0s
H    0     0                    -109433.6215 -109630.25  0.18%     -    0s
H    0     0                    -109456.7522 -109630.25  0.16%     -    0s
     0     0 -109630.25    0   67 -109456.75 -109630.25  0.16%     -    0s
     0     0 -109630.25    0   77 -109456.75 -109630.25  0.16%     -    0s
     0     0 -109630.25    0   62 -109456.75 -109630.25  0.16%     -    0s
     0     0 -109630.25    0   54 -109456.75 -109630.25  0.16%     -    0s
     0     0 -109629.17    0   52 -109456.75 -109629.17  0.16%     -    0s
     0     0 -109608.37    0   53 -109456.75 -109608.37  0.14%     -    0s
     0     0 -109605.63    0   52 -109456.75 -109605.63  0.14%     -    0s
     0     0 -109604.67    0   52 -109456.75 -109604.67  0.14%     -    0s
     0     0 -109581.61    0   51 -109456.75 -109581.61  0.11%     -    0s
     0     0 -109580.89    0   51 -109456.75 -109580.89  0.11%     -    0s
     0     0 -109550.73    0   52 -109456.75 -109550.73  0.09%     -    0s
     0     0 -109544.93    0   52 -109456.75 -109544.93  0.08%     -    0s
     0     0 -109544.93    0   54 -109456.75 -109544.93  0.08%     -    0s
     0     0 -109544.93    0   47 -109456.75 -109544.93  0.08%     -    0s
     0     0 -109544.93    0   43 -109456.75 -109544.93  0.08%     -    0s
     0     0 -109526.57    0   10 -109456.75 -109526.57  0.06%     -    0s
     0     0 -109516.39    0    9 -109456.75 -109516.39  0.05%     -    0s
     0     0 -109496.11    0    8 -109456.75 -109496.11  0.04%     -    0s
     0     0 -109494.58    0    8 -109456.75 -109494.58  0.03%     -    0s
     0     0 -109486.82    0    7 -109456.75 -109486.82  0.03%     -    0s
     0     0 -109486.82    0    9 -109456.75 -109486.82  0.03%     -    0s
     0     0          -    0      -109456.75 -109462.64  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 5
  Flow cover: 2
  Relax-and-lift: 1

Explored 1 nodes (1550 simplex iterations) in 0.23 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -109457 -109434 -109390 ... 1.47645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.094567521975e+05, best bound -1.094626438101e+05, gap 0.0054%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 133927.80
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109456.75
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -109456.75 = 133927.80
  [DEBUG]   Current θ from Master = 135146.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1219.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5184.52
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 223.1288, Absolute Gap = 223.1288, Relative Gap = 0.034844
  Not converged yet (gap = 223.13 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783245 nonzeros
Model fingerprint: 0xf9584ee2
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141804 rows and 57564 columns (presolve time = 5s)...
Presolve removed 141804 rows and 57564 columns
Presolve time: 5.29s
Presolved: 134799 rows, 57016 columns, 833271 nonzeros
Variable types: 54757 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.53s

Barrier statistics:
 Dense cols : 587
 AA' NZ     : 7.238e+06
 Factor NZ  : 1.674e+07 (roughly 200 MB of memory)
 Factor Ops : 5.711e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93478664e+07  2.38885580e+08  9.42e+04 1.72e+01  7.94e+04     8s
   1  -1.48224987e+07  2.10106190e+08  6.65e+04 6.05e+01  5.56e+04     8s
   2  -4.78203400e+06  1.64184176e+08  2.19e+04 1.21e+01  1.89e+04     8s
   3  -3.26041413e+06  1.52954322e+08  1.43e+04 8.53e+00  1.25e+04     8s
   4  -9.07728721e+05  1.05028952e+08  1.18e+03 3.68e-01  1.38e+03     9s
   5  -7.26466680e+05  6.52260008e+07  4.32e+02 1.75e-01  5.87e+02     9s
   6  -6.94410886e+05  5.11068675e+07  3.79e+02 1.28e-01  4.77e+02     9s
   7  -6.26242054e+05  3.44225473e+07  1.89e+02 7.05e-02  2.66e+02     9s
   8  -4.74145455e+05  2.70149324e+07  3.00e+01 5.55e-02  1.30e+02     9s
   9  -2.70979022e+05  1.53295261e+07  7.65e+00 2.97e-02  6.67e+01     9s
  10  -1.50105764e+05  8.36829273e+06  2.36e+00 1.57e-02  3.52e+01     9s
  11  -1.32281092e+05  5.27328896e+06  1.84e+00 9.72e-03  2.23e+01     9s
  12  -1.20439182e+05  4.07503364e+06  1.45e+00 7.46e-03  1.72e+01    10s
  13  -9.60316224e+04  2.97558360e+06  8.26e-01 5.37e-03  1.26e+01    10s
  14  -6.92845595e+04  1.73662858e+06  2.70e-01 3.09e-03  7.35e+00    10s
  15  -4.69063450e+04  5.27975709e+05  8.50e-02 8.33e-04  2.34e+00    10s
  16  -2.68097139e+04  2.61570469e+05  4.30e-02 4.45e-04  1.17e+00    10s
  17  -1.10051679e+04  1.53021589e+05  2.46e-02 1.53e-03  6.66e-01    10s
  18  -7.13623014e+03  1.15253325e+05  2.19e-02 1.06e-03  4.97e-01    10s
  19   4.46957101e+02  1.01954963e+05  1.63e-02 8.79e-04  4.12e-01    11s
  20   3.12436304e+03  8.07145541e+04  1.44e-02 6.12e-04  3.15e-01    11s
  21   6.96683373e+03  6.77423622e+04  1.20e-02 4.64e-04  2.47e-01    11s
  22   1.05669302e+04  5.92570052e+04  9.79e-03 3.65e-04  1.98e-01    11s
  23   1.36212878e+04  5.56258180e+04  7.99e-03 3.24e-04  1.71e-01    11s
  24   1.61470783e+04  4.83781969e+04  6.61e-03 4.46e-04  1.31e-01    11s
  25   1.82277217e+04  4.35920420e+04  5.54e-03 2.96e-04  1.03e-01    12s
  26   2.13948256e+04  4.21881970e+04  3.97e-03 2.66e-04  8.45e-02    12s
  27   2.21883627e+04  3.78988700e+04  3.61e-03 1.78e-04  6.38e-02    12s
  28   2.40511284e+04  3.62958182e+04  2.77e-03 1.35e-04  4.97e-02    12s
  29   2.46532038e+04  3.46147268e+04  2.51e-03 1.03e-04  4.05e-02    12s
  30   2.55617752e+04  3.42317739e+04  2.12e-03 9.22e-05  3.52e-02    13s
  31   2.68645528e+04  3.30820774e+04  1.56e-03 6.07e-05  2.53e-02    13s
  32   2.76574765e+04  3.24885579e+04  1.24e-03 4.47e-05  1.96e-02    13s
  33   2.78299239e+04  3.23495815e+04  1.17e-03 4.12e-05  1.84e-02    13s
  34   2.85743591e+04  3.20664444e+04  8.70e-04 3.41e-05  1.42e-02    13s
  35   2.89937093e+04  3.16773523e+04  6.96e-04 2.40e-05  1.09e-02    14s
  36   2.92063114e+04  3.14779180e+04  6.09e-04 4.13e-05  9.23e-03    14s
  37   2.95929074e+04  3.11811172e+04  4.50e-04 2.46e-05  6.45e-03    14s
  38   2.97592457e+04  3.09839240e+04  3.81e-04 2.24e-05  4.98e-03    14s
  39   2.99670900e+04  3.09133195e+04  2.95e-04 1.59e-05  3.85e-03    14s
  40   2.99885539e+04  3.08937889e+04  2.86e-04 1.42e-05  3.68e-03    15s
  41   3.01481770e+04  3.08479543e+04  2.26e-04 9.85e-06  2.84e-03    15s
  42   3.02803874e+04  3.08317066e+04  1.73e-04 8.30e-06  2.24e-03    15s
  43   3.04418840e+04  3.08102175e+04  1.09e-04 6.28e-06  1.50e-03    15s
  44   3.04765123e+04  3.07793647e+04  9.60e-05 3.66e-06  1.23e-03    15s
  45   3.05879456e+04  3.07678358e+04  5.36e-05 2.56e-06  7.31e-04    15s
  46   3.06888560e+04  3.07554118e+04  1.59e-05 1.39e-06  2.70e-04    16s
  47   3.07034789e+04  3.07536759e+04  1.09e-05 1.26e-06  2.04e-04    16s
  48   3.07216780e+04  3.07466109e+04  4.80e-06 7.04e-07  1.01e-04    16s
  49   3.07297739e+04  3.07423126e+04  2.28e-06 3.78e-07  5.09e-05    16s
  50   3.07342182e+04  3.07378384e+04  8.69e-07 4.40e-08  1.47e-05    16s
  51   3.07368874e+04  3.07375171e+04  5.85e-08 2.14e-08  2.56e-06    17s
  52   3.07371418e+04  3.07372208e+04  3.53e-08 7.44e-09  3.21e-07    17s
  53   3.07371506e+04  3.07371512e+04  4.34e-09 4.31e-11  2.79e-09    17s
  54   3.07371509e+04  3.07371510e+04  1.92e-07 8.43e-11  3.01e-10    17s

Barrier solved model in 54 iterations and 17.07 seconds (15.98 work units)
Optimal objective 3.07371509e+04


Root crossover log...

  113797 DPushes remaining with DInf 0.0000000e+00                17s
   29402 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    5154 PPushes remaining with PInf 4.1526886e-05                24s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.1047264e+00     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   55680    3.0737151e+04   0.000000e+00   5.104726e+00     25s
   55733    3.0737151e+04   0.000000e+00   0.000000e+00     25s
   55733    3.0737151e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 2.44s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 3.073715e+04, 55733 iterations, 20.97 seconds (25.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 30737.1510    0  302 -170236.42 30737.1510   118%     -   28s
H    0     0                    -165556.9000 30737.1510   119%     -   28s
H    0     0                    -131918.5190 30737.1510   123%     -   29s
H    0     0                    -129675.3589 30737.1510   124%     -   29s
H    0     0                    -78968.20861 30737.1510   139%     -   29s
H    0     0                    -78741.26443 30737.1510   139%     -   45s
H    0     0                    -38815.20778 30737.1510   179%     -   45s
H    0     0                    -11223.77793 30737.1510   374%     -   45s
H    0     0                    -7025.706448 30737.1510   537%     -   45s
     0     0 23540.6201    0  258 -7025.7064 23540.6201   435%     -  119s
     0     0 23540.6201    0  258 -7025.7064 23540.6201   435%     -  120s
H    0     0                    -6177.914525 23538.5933   481%     -  120s
H    0     0                    -5311.161816 23538.5933   543%     -  120s
H    0     0                    -5263.322664 23538.5933   547%     -  120s
     0     0 23302.5428    0  270 -5263.3227 23302.5428   543%     -  137s
     0     0 23301.4960    0  270 -5263.3227 23301.4960   543%     -  140s
     0     0 23177.8793    0  267 -5263.3227 23177.8793   540%     -  155s
     0     0 23177.3574    0  271 -5263.3227 23177.3574   540%     -  157s
     0     0 20604.3655    0  350 -5263.3227 20604.3655   491%     -  232s
H    0     0                    -4928.494898 20604.2335   518%     -  233s
     0     0 20158.4161    0  375 -4928.4949 20158.4161   509%     -  285s
     0     0 19920.1713    0  414 -4928.4949 19920.1713   504%     -  327s
     0     0 19590.9338    0  399 -4928.4949 19590.9338   498%     -  365s
     0     0 19565.5895    0  367 -4928.4949 19565.5895   497%     -  379s
     0     0 19558.4573    0  369 -4928.4949 19558.4573   497%     -  385s
     0     0 19526.4065    0  399 -4928.4949 19526.4065   496%     -  393s
     0     0 19506.0503    0  404 -4928.4949 19506.0503   496%     -  401s
     0     0 19503.6734    0  401 -4928.4949 19503.6734   496%     -  406s
     0     0 19495.7336    0  405 -4928.4949 19495.7336   496%     -  410s
     0     0 19492.9102    0  405 -4928.4949 19492.9102   496%     -  413s
     0     0 19409.2266    0  403 -4928.4949 19409.2266   494%     -  427s
     0     0 19390.6598    0  407 -4928.4949 19390.6598   493%     -  434s
     0     0 19380.2619    0  395 -4928.4949 19380.2619   493%     -  437s
     0     0 19378.5894    0  393 -4928.4949 19378.5894   493%     -  440s
     0     0 19372.9307    0  399 -4928.4949 19372.9307   493%     -  446s
     0     0 19357.2261    0  388 -4928.4949 19357.2261   493%     -  452s
     0     0 19354.6835    0  384 -4928.4949 19354.6835   493%     -  456s
     0     0 19354.5078    0  384 -4928.4949 19354.5078   493%     -  457s
     0     0 17609.8040    0  384 -4928.4949 17609.8040   457%     -  553s
     0     0 17133.0815    0  394 -4928.4949 17133.0815   448%     -  610s
     0     0 17038.7946    0  407 -4928.4949 17038.7946   446%     -  644s
     0     0 16986.8760    0  406 -4928.4949 16986.8760   445%     -  667s
     0     0 16907.9471    0  359 -4928.4949 16907.9471   443%     -  699s
     0     0 16896.6432    0  370 -4928.4949 16896.6432   443%     -  711s
     0     0 16890.0310    0  372 -4928.4949 16890.0310   443%     -  721s
     0     0 16817.9816    0  413 -4928.4949 16817.9816   441%     -  748s
     0     0 16811.5149    0  404 -4928.4949 16811.5149   441%     -  756s
     0     0 16809.8197    0  363 -4928.4949 16809.8197   441%     -  761s
     0     0 16246.3191    0  396 -4928.4949 16246.3191   430%     -  849s
H    0     0                    -3893.576037 16246.0717   517%     -  850s
     0     0 15982.1637    0  413 -3893.5760 15982.1637   510%     -  891s
     0     0 15885.9786    0  424 -3893.5760 15885.9786   508%     -  913s
     0     0 15832.9280    0  422 -3893.5760 15832.9280   507%     -  932s
     0     0 15806.7040    0  428 -3893.5760 15806.7040   506%     -  944s
     0     0 15787.3388    0  435 -3893.5760 15787.3388   505%     -  952s
     0     0 15770.6971    0  438 -3893.5760 15770.6971   505%     -  961s
     0     0 15738.2136    0  433 -3893.5760 15738.2136   504%     -  979s
     0     0 15732.1031    0  429 -3893.5760 15732.1031   504%     -  985s
     0     0 15729.9249    0  435 -3893.5760 15729.9249   504%     -  988s
     0     0 15729.5951    0  440 -3893.5760 15729.5951   504%     -  991s
     0     0 15504.9361    0  377 -3893.5760 15504.9361   498%     - 1038s
     0     0 15415.0040    0  381 -3893.5760 15415.0040   496%     - 1071s
     0     0 15383.1822    0  384 -3893.5760 15383.1822   495%     - 1088s
     0     0 15360.8437    0  390 -3893.5760 15360.8437   495%     - 1104s
     0     0 15354.9504    0  385 -3893.5760 15354.9504   494%     - 1112s
     0     0 15349.8769    0  393 -3893.5760 15349.8769   494%     - 1124s
     0     0 15343.0177    0  382 -3893.5760 15343.0177   494%     - 1134s
     0     0 15339.8625    0  388 -3893.5760 15339.8625   494%     - 1142s
     0     0 15336.2916    0  395 -3893.5760 15336.2916   494%     - 1151s
     0     0 15322.6139    0  381 -3893.5760 15322.6139   494%     - 1165s
     0     0 15308.3113    0  393 -3893.5760 15308.3113   493%     - 1181s
     0     0 15301.1207    0  438 -3893.5760 15301.1207   493%     - 1191s
     0     0 15296.9597    0  446 -3893.5760 15296.9597   493%     - 1201s
     0     0 15295.6951    0  443 -3893.5760 15295.6951   493%     - 1205s
     0     0 15149.7490    0  441 -3893.5760 15149.7490   489%     - 1242s
H    0     0                    -3858.000862 15149.5733   493%     - 1269s
H    0     0                     496.4606169 15149.5733  2952%     - 1269s
H    0     0                     850.2030557 15149.5733  1682%     - 1269s
H    0     0                    2249.7426315 15149.5733   573%     - 1269s
     0     0 15095.0757    0  381 2249.74263 15095.0757   571%     - 1294s
     0     0 15079.8589    0  377 2249.74263 15079.8589   570%     - 1309s
     0     0 15068.8602    0  375 2249.74263 15068.8602   570%     - 1329s
     0     0 15064.0640    0  436 2249.74263 15064.0640   570%     - 1346s
     0     0 15060.0134    0  439 2249.74263 15060.0134   569%     - 1364s
     0     0 15050.7527    0  429 2249.74263 15050.7527   569%     - 1380s
     0     0 15047.7196    0  480 2249.74263 15047.7196   569%     - 1388s
     0     0 15004.8642    0  440 2249.74263 15004.8642   567%     - 1413s
     0     0 14996.5449    0  503 2249.74263 14996.5449   567%     - 1429s
     0     0 14991.4964    0  433 2249.74263 14991.4964   566%     - 1438s
     0     0 14990.2814    0  433 2249.74263 14990.2814   566%     - 1446s
     0     0 14891.6393    0  492 2249.74263 14891.6393   562%     - 1489s
H    0     0                    2459.2392300 14891.5630   506%     - 1490s
H    0     0                    3091.2243895 14891.5630   382%     - 1490s
     0     0 14848.4590    0  498 3091.22439 14848.4590   380%     - 1515s
     0     0 14818.4724    0  505 3091.22439 14818.4724   379%     - 1533s
     0     0 14810.5919    0  451 3091.22439 14810.5919   379%     - 1543s
     0     0 14804.9850    0  451 3091.22439 14804.9850   379%     - 1559s
     0     0 14799.8402    0  455 3091.22439 14799.8402   379%     - 1568s
     0     0 14791.3204    0  451 3091.22439 14791.3204   378%     - 1577s
     0     0 14790.3294    0  455 3091.22439 14790.3294   378%     - 1580s
     0     0 14685.8771    0  386 3091.22439 14685.8771   375%     - 1609s
     0     0 14669.1490    0  382 3091.22439 14669.1490   375%     - 1640s
     0     0 14661.0951    0  379 3091.22439 14661.0951   374%     - 1649s
     0     0 14658.1553    0  386 3091.22439 14658.1553   374%     - 1655s
     0     0 14650.1449    0  397 3091.22439 14650.1449   374%     - 1661s
     0     0 14648.4009    0  391 3091.22439 14648.4009   374%     - 1664s
     0     0 14601.2780    0  383 3091.22439 14601.2780   372%     - 1693s
     0     0 14593.7783    0  383 3091.22439 14593.7783   372%     - 1705s
     0     0 14589.0467    0  394 3091.22439 14589.0467   372%     - 1710s
     0     0 14584.5765    0  393 3091.22439 14584.5765   372%     - 1715s
     0     0 14581.6165    0  379 3091.22439 14581.6165   372%     - 1721s
     0     0 14579.4773    0  374 3091.22439 14579.4773   372%     - 1727s
     0     0 14549.7990    0  431 3091.22439 14549.7990   371%     - 1747s
     0     0 14541.4414    0  383 3091.22439 14541.4414   370%     - 1761s
     0     0 14536.5193    0  382 3091.22439 14536.5193   370%     - 1766s
     0     0 14535.7843    0  383 3091.22439 14535.7843   370%     - 1769s
     0     0 14528.1456    0  386 3091.22439 14528.1456   370%     - 1778s
H    0     0                    5853.8767529 14528.0138   148%     - 1780s
H    0     0                    6147.3237532 14528.0138   136%     - 1780s
H    0     0                    6239.7886286 14528.0138   133%     - 1780s
     0     0 14522.9136    0  384 6239.78863 14522.9136   133%     - 1786s
     0     0 14521.2142    0  390 6239.78863 14521.2142   133%     - 1790s
     0     0 14504.7110    0  385 6239.78863 14504.7110   132%     - 1804s
H    0     0                    6283.5038166 14504.6640   131%     - 1851s
     0     0 14491.8533    0  401 6283.50382 14491.8533   131%     - 1870s
     0     0 14489.7765    0  390 6283.50382 14489.7765   131%     - 1876s
     0     0 14442.9464    0  401 6283.50382 14442.9464   130%     - 1903s
     0     0 14418.4274    0  392 6283.50382 14418.4274   129%     - 1916s
     0     0 14410.6534    0  398 6283.50382 14410.6534   129%     - 1925s
     0     0 14407.9534    0  461 6283.50382 14407.9534   129%     - 1936s
     0     0 14404.7304    0  458 6283.50382 14404.7304   129%     - 1945s
     0     0 14402.0171    0  460 6283.50382 14402.0171   129%     - 1953s
     0     0 14398.9365    0  459 6283.50382 14398.9365   129%     - 1960s
     0     0 14394.9910    0  451 6283.50382 14394.9910   129%     - 1963s
     0     0 14393.7291    0  462 6283.50382 14393.7291   129%     - 1968s
     0     0 14386.2365    0  433 6283.50382 14386.2365   129%     - 1987s
     0     0 14381.3992    0  397 6283.50382 14381.3992   129%     - 1997s
     0     0 14379.0322    0  465 6283.50382 14379.0322   129%     - 2007s
     0     0 14378.1938    0  466 6283.50382 14378.1938   129%     - 2010s
     0     0 14366.9443    0  524 6283.50382 14366.9443   129%     - 2025s
     0     0 14360.8017    0  524 6283.50382 14360.8017   129%     - 2037s
     0     0 14356.2278    0  526 6283.50382 14356.2278   128%     - 2047s
     0     0 14354.7772    0  525 6283.50382 14354.7772   128%     - 2054s
     0     0 14320.1984    0  395 6283.50382 14320.1984   128%     - 2069s
     0     0 14317.9142    0  418 6283.50382 14317.9142   128%     - 2073s
     0     0 14304.0650    0  399 6283.50382 14304.0650   128%     - 2082s
     0     0 14295.5779    0  411 6283.50382 14295.5779   128%     - 2095s
     0     0 14287.7945    0  411 6283.50382 14287.7945   127%     - 2103s
     0     0 14286.4739    0  410 6283.50382 14286.4739   127%     - 2107s
     0     0 14275.0951    0  414 6283.50382 14275.0951   127%     - 2123s
     0     0 14272.9133    0  415 6283.50382 14272.9133   127%     - 2126s
     0     0 14258.3070    0  398 6283.50382 14258.3070   127%     - 2137s
     0     0 14248.8990    0  452 6283.50382 14248.8990   127%     - 2154s
     0     0 14242.5626    0  452 6283.50382 14242.5626   127%     - 2161s
     0     0 14240.6136    0  450 6283.50382 14240.6136   127%     - 2166s
     0     0 14233.2069    0  463 6283.50382 14233.2069   127%     - 2177s
     0     0 14229.3402    0  410 6283.50382 14229.3402   126%     - 2182s
     0     0 14228.1670    0  415 6283.50382 14228.1670   126%     - 2185s
     0     0 14225.3191    0  407 6283.50382 14225.3191   126%     - 2196s
     0     0 14222.8289    0  403 6283.50382 14222.8289   126%     - 2203s
     0     0 14222.0522    0  397 6283.50382 14222.0522   126%     - 2204s
     0     0 14192.5897    0  395 6283.50382 14192.5897   126%     - 2215s
     0     0 14188.6452    0  398 6283.50382 14188.6452   126%     - 2220s
     0     0 14187.7508    0  400 6283.50382 14187.7508   126%     - 2222s
     0     0 14185.5621    0  399 6283.50382 14185.5621   126%     - 2228s
     0     0 14184.4050    0  399 6283.50382 14184.4050   126%     - 2232s
     0     0 14181.3380    0  399 6283.50382 14181.3380   126%     - 2237s
     0     0 14181.2307    0  399 6283.50382 14181.2307   126%     - 2246s
     0     2 14181.2237    0  399 6283.50382 14181.2237   126%     - 2485s
     1     3 13442.5465    1  316 6283.50382 14181.2237   126% 11326 2509s
     2     4 14097.3116    1  457 6283.50382 14097.3116   124%  9492 2523s
     3     6 12923.6990    2  311 6283.50382 14097.2555   124%  8315 2541s
     5    10 12630.9681    3  299 6283.50382 14097.2555   124%  9145 2570s
     9    20 13594.3221    3  503 6283.50382 13878.1067   121% 11221 2603s
    19    40 13482.2488    4  442 6283.50382 13790.7776   119% 11655 2658s
    39    52 12886.7327    5  370 6283.50382 13714.0934   118% 16814 2882s
    51    74 12738.1754    6  357 6283.50382 13714.0934   118% 16993 2971s
H   62    74                    6361.5919886 13714.0934   116% 15725 2971s
    75   177 12519.5806    7  343 6361.59199 13714.0934   116% 14496 3057s
   180   251 12167.0816   11  344 6361.59199 13714.0934   116%  9911 3099s
   258   300 7804.49466   12  125 6361.59199 13714.0934   116%  8767 3133s
   320   330 7284.48541   16   99 6361.59199 13714.0934   116%  8580 3194s
   361   361     cutoff   20      6361.59199 13714.0934   116%  8634 3270s
H  382   361                    6389.0211003 13714.0934   115%  8567 3270s
   419   405     cutoff   12      6389.02110 13714.0934   115%  8839 3297s
   492   456 8239.30427   20  312 6389.02110 13714.0934   115%  8655 3328s
   569   501 8175.90989   22  316 6389.02110 13714.0934   115%  8367 3356s
   638   553 7870.11874   14  320 6389.02110 13714.0934   115%  8151 3379s
   718   575 7831.10353   15  310 6389.02110 13714.0934   115%  7877 3407s
   790   601 7492.25512   17  307 6389.02110 13714.0934   115%  7680 3435s
   858   628     cutoff   17      6389.02110 13714.0934   115%  7613 3463s
   916   658 6735.66993   17  288 6389.02110 13714.0934   115%  7532 3489s
   993   674     cutoff   19      6389.02110 13714.0934   115%  7374 3517s
  1047   697 6520.68240   18  291 6389.02110 13714.0934   115%  7352 3547s
  1112   709     cutoff   18      6389.02110 13714.0934   115%  7318 3576s
  1179   745 8264.84199   18  292 6389.02110 13714.0934   115%  7265 3600s

Cutting planes:
  Learned: 1
  Gomory: 6
  Implied bound: 188
  MIR: 3137
  Flow cover: 2816
  RLT: 48
  Relax-and-lift: 478

Explored 1245 nodes (9933628 simplex iterations) in 3600.07 seconds (4838.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6389.02 6361.59 6283.5 ... 850.203

Time limit reached
Best objective 6.389021100250e+03, best bound 1.371409336553e+04, gap 114.6509%
  WARNING: Time limit reached. Using best solution found (gap: 114.65%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 6389.02, θ = 135096.34
  Upper Bound (UB) = 6389.02

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135096.34
  [DEBUG]   ✓ Scenario 0: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135096.34 ≤ Q = 136934.51 (slack: 1838.17)
  [DEBUG]   ✓ Scenario 7: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 135096.34 ≤ Q = 135096.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 135096.34 ≤ Q = 135096.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x19c7ddef
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x19c7ddef
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.486454e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6608322.7129
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.356915e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135691.50    0  123 6608322.71 -135691.50   102%     -    0s
H    0     0                    -106937.3136 -135691.50  26.9%     -    0s
H    0     0                    -107090.4747 -135691.50  26.7%     -    0s
     0     0 -109967.67    0   43 -107090.47 -109967.67  2.69%     -    0s
H    0     0                    -108495.9558 -109858.45  1.26%     -    0s
     0     0 -109562.56    0   46 -108495.96 -109562.56  0.98%     -    0s
     0     0 -109275.60    0   33 -108495.96 -109275.60  0.72%     -    0s
     0     0 -109209.82    0   48 -108495.96 -109209.82  0.66%     -    0s
     0     0 -109205.06    0   47 -108495.96 -109205.06  0.65%     -    0s
     0     0 -109145.18    0   40 -108495.96 -109145.18  0.60%     -    0s
     0     0 -109137.77    0   40 -108495.96 -109137.77  0.59%     -    0s
H    0     0                    -108527.1120 -109137.62  0.56%     -    0s
     0     2 -109137.62    0   40 -108527.11 -109137.62  0.56%     -    0s
H   92    42                    -108556.9848 -108763.29  0.19%   7.9    0s
*  190    53              14    -108562.2276 -108735.24  0.16%   6.0    0s
H  264    19                    -108570.2499 -108664.37  0.09%   5.7    0s

Cutting planes:
  Gomory: 14
  Implied bound: 9
  MIR: 148
  Flow cover: 9
  RLT: 4

Explored 383 nodes (2312 simplex iterations) in 0.22 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -108570 -108562 -108557 ... 1.48645e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.085702499027e+05, best bound -1.085750884738e+05, gap 0.0045%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 134814.30
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108570.25
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -108570.25 = 134814.30
  [DEBUG]   Current θ from Master = 135096.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 282.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6106.98
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 208.5915, Absolute Gap = 208.5915, Relative Gap = 0.032648
  Not converged yet (gap = 208.59 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826452 nonzeros
Model fingerprint: 0xf0314b35
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 149682 rows and 60762 columns (presolve time = 5s)...
Presolve removed 149682 rows and 60762 columns
Presolve time: 5.71s
Presolved: 142211 rows, 60058 columns, 877617 nonzeros
Variable types: 57799 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -371815.2844
Found heuristic solution: objective -170236.4243

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.42s

Barrier statistics:
 Dense cols : 1008
 AA' NZ     : 3.804e+06
 Factor NZ  : 1.028e+07 (roughly 170 MB of memory)
 Factor Ops : 3.638e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.96988380e+07  2.49839518e+08  9.57e+04 1.67e+01  8.04e+04     8s
   1  -1.52235437e+07  2.20261688e+08  6.83e+04 6.07e+01  5.69e+04     8s
   2  -4.86972341e+06  1.72034831e+08  2.24e+04 1.17e+00  1.95e+04     8s
   3  -1.92104464e+06  1.67535705e+08  7.60e+03 8.22e+00  7.02e+03     9s
   4  -7.22513977e+05  1.22450750e+08  8.30e+02 4.17e-01  1.14e+03     9s
   5  -5.91951792e+05  5.56645812e+07  3.90e+02 1.34e-01  4.92e+02     9s
   6  -4.94914699e+05  3.90480242e+07  2.05e+02 8.53e-02  2.88e+02     9s
   7  -3.51852027e+05  3.28534289e+07  3.80e+01 6.88e-02  1.52e+02     9s
   8  -2.50480604e+05  1.92726495e+07  7.40e+00 3.81e-02  7.87e+01     9s
   9  -1.47301487e+05  9.04686174e+06  1.05e+00 1.71e-02  3.57e+01     9s
  10  -1.18736821e+05  3.65492022e+06  6.81e-01 7.33e-03  1.46e+01    10s
  11  -9.41630547e+04  2.74427681e+06  4.04e-01 5.45e-03  1.10e+01    10s
  12  -6.99339159e+04  2.01458391e+06  1.89e-01 3.99e-03  8.04e+00    10s
  13  -4.74018931e+04  1.35381005e+06  7.66e-02 2.64e-03  5.40e+00    10s
  14  -2.35922991e+04  2.74324816e+05  2.04e-02 4.82e-04  1.15e+00    10s
  15  -1.59458961e+04  1.71996905e+05  1.56e-02 6.83e-04  7.24e-01    10s
  16  -2.87938622e+03  1.29338303e+05  9.64e-03 1.22e-03  5.09e-01    10s
  17   2.85524270e+03  9.26643578e+04  7.49e-03 1.99e-03  3.46e-01    10s
  18   6.57025725e+03  7.63038389e+04  6.23e-03 1.63e-03  2.69e-01    10s
  19   1.02576625e+04  6.58680198e+04  5.11e-03 1.40e-03  2.14e-01    11s
  20   1.19892801e+04  5.95363629e+04  4.60e-03 1.09e-03  1.83e-01    11s
  21   1.57624028e+04  5.11592563e+04  3.54e-03 9.63e-04  1.36e-01    11s
  22   1.89397334e+04  4.51952290e+04  2.70e-03 6.60e-04  1.01e-01    11s
  23   2.20739340e+04  4.02436255e+04  1.96e-03 4.27e-04  7.00e-02    11s
  24   2.32294920e+04  3.74416787e+04  1.70e-03 5.73e-04  5.48e-02    11s
  25   2.54211266e+04  3.57560146e+04  1.22e-03 4.10e-04  3.98e-02    12s
  26   2.66876802e+04  3.41573065e+04  9.55e-04 3.01e-04  2.88e-02    12s
  27   2.84102503e+04  3.33606777e+04  6.04e-04 2.10e-04  1.91e-02    12s
  28   2.93120726e+04  3.25318327e+04  4.13e-04 1.55e-04  1.24e-02    12s
  29   2.97486858e+04  3.20506136e+04  3.26e-04 8.12e-05  8.87e-03    12s
  30   3.01271928e+04  3.18897881e+04  2.50e-04 5.84e-05  6.79e-03    13s
  31   3.02245545e+04  3.18515673e+04  2.31e-04 5.30e-05  6.27e-03    13s
  32   3.04973328e+04  3.18294258e+04  1.78e-04 5.01e-05  5.13e-03    13s
  33   3.07773778e+04  3.16300054e+04  1.23e-04 2.23e-05  3.29e-03    13s
  34   3.10701577e+04  3.15183485e+04  6.93e-05 7.62e-06  1.73e-03    13s
  35   3.12753586e+04  3.14837199e+04  3.11e-05 2.92e-06  8.03e-04    13s
  36   3.13166952e+04  3.14798883e+04  2.37e-05 2.49e-06  6.29e-04    14s
  37   3.13564799e+04  3.14693141e+04  1.67e-05 1.36e-06  4.35e-04    14s
  38   3.13896793e+04  3.14614624e+04  1.10e-05 5.34e-07  2.77e-04    14s
  39   3.14287292e+04  3.14596740e+04  4.21e-06 3.55e-07  1.19e-04    14s
  40   3.14404016e+04  3.14584985e+04  2.29e-06 2.54e-07  6.97e-05    14s
  41   3.14522137e+04  3.14554599e+04  4.52e-07 1.19e-08  1.25e-05    15s
  42   3.14541876e+04  3.14552481e+04  1.57e-07 1.90e-08  4.09e-06    15s
  43   3.14552043e+04  3.14552062e+04  1.90e-08 3.27e-08  7.62e-09    15s
  44   3.14552058e+04  3.14552060e+04  5.91e-08 2.74e-10  8.57e-10    15s

Barrier solved model in 44 iterations and 15.12 seconds (12.22 work units)
Optimal objective 3.14552058e+04


Root crossover log...

  120812 DPushes remaining with DInf 0.0000000e+00                15s
   22079 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

   11556 PPushes remaining with PInf 7.1282563e-05                24s
    1747 PPushes remaining with PInf 7.1743353e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.3794923e+05     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72513    3.1455206e+04   0.000000e+00   2.379492e+05     26s
   72757    3.1455206e+04   0.000000e+00   0.000000e+00     26s
   72757    3.1455206e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 3.47s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 3.145521e+04, 72757 iterations, 22.79 seconds (27.78 work units)
Total elapsed time = 30.07s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 31455.2060    0  283 -170236.42 31455.2060   118%     -   30s
H    0     0                    -144818.2003 31455.2060   122%     -   31s
H    0     0                    -115710.7881 31455.2060   127%     -   31s
H    0     0                    -78097.14674 31455.2060   140%     -   31s
H    0     0                    -60816.59476 31455.2060   152%     -   31s
H    0     0                    -11168.72433 31455.2060   382%     -   31s
H    0     0                    -4278.411434 31455.2060   835%     -   32s
H    0     0                    -4263.041471 31455.2060   838%     -   32s
H    0     0                    -4256.150831 31455.2060   839%     -   33s
     0     0 24555.2594    0  293 -4256.1508 24555.2594   677%     -  109s
     0     0 24555.2594    0  293 -4256.1508 24555.2594   677%     -  110s
H    0     0                    -505.2335928 24555.2504  4960%     -  111s
H    0     0                     444.8988257 24555.2504  5419%     -  112s
H    0     0                     580.3345270 24555.2504  4131%     -  112s
H    0     0                     619.4889918 24555.2504  3864%     -  112s
     0     0 24051.1931    0  283  619.48899 24051.1931  3782%     -  147s
     0     0 23712.9315    0  280  619.48899 23712.9315  3728%     -  178s
     0     0 23703.2478    0  277  619.48899 23703.2478  3726%     -  185s
     0     0 23693.7685    0  279  619.48899 23693.7685  3725%     -  190s
     0     0 23679.7091    0  283  619.48899 23679.7091  3722%     -  199s
     0     0 23678.9948    0  285  619.48899 23678.9948  3722%     -  201s
     0     0 19906.1026    0  329  619.48899 19906.1026  3113%     -  322s
H    0     0                    1558.7767839 19905.7143  1177%     -  323s
H    0     0                    1590.5022488 19905.7143  1152%     -  324s
H    0     0                    1648.3227080 19905.7143  1108%     -  324s
H    0     0                    1679.5631132 19905.7143  1085%     -  324s
     0     0 19318.5832    0  416 1679.56311 19318.5832  1050%     -  384s
     0     0 18848.1562    0  423 1679.56311 18848.1562  1022%     -  437s
     0     0 18744.4650    0  420 1679.56311 18744.4650  1016%     -  460s
     0     0 18730.3249    0  421 1679.56311 18730.3249  1015%     -  466s
     0     0 18651.3977    0  425 1679.56311 18651.3977  1010%     -  483s
     0     0 18638.0580    0  430 1679.56311 18638.0580  1010%     -  492s
     0     0 18595.9144    0  424 1679.56311 18595.9144  1007%     -  504s
     0     0 18560.1852    0  429 1679.56311 18560.1852  1005%     -  516s
     0     0 18555.6347    0  435 1679.56311 18555.6347  1005%     -  521s
     0     0 18553.1965    0  435 1679.56311 18553.1965  1005%     -  525s
     0     0 18551.7787    0  438 1679.56311 18551.7787  1005%     -  527s
     0     0 16760.1651    0  336 1679.56311 16760.1651   898%     -  615s
     0     0 16276.7305    0  401 1679.56311 16276.7305   869%     -  665s
     0     0 16165.7899    0  355 1679.56311 16165.7899   862%     -  687s
     0     0 15965.8261    0  365 1679.56311 15965.8261   851%     -  707s
     0     0 15900.7271    0  368 1679.56311 15900.7271   847%     -  729s
     0     0 15841.8928    0  376 1679.56311 15841.8928   843%     -  746s
     0     0 15825.1978    0  367 1679.56311 15825.1978   842%     -  760s
     0     0 15816.8340    0  378 1679.56311 15816.8340   842%     -  766s
     0     0 15809.9435    0  390 1679.56311 15809.9435   841%     -  774s
     0     0 15805.9373    0  383 1679.56311 15805.9373   841%     -  778s
     0     0 15804.2455    0  383 1679.56311 15804.2455   841%     -  781s
     0     0 15210.3642    0  381 1679.56311 15210.3642   806%     -  852s
H    0     0                    1737.0483195 15210.3307   776%     -  854s
H    0     0                    1744.3221704 15210.3307   772%     -  854s
     0     0 15003.9710    0  448 1744.32217 15003.9710   760%     -  897s
     0     0 14876.0742    0  437 1744.32217 14876.0742   753%     -  933s
     0     0 14771.3468    0  378 1744.32217 14771.3468   747%     -  960s
     0     0 14754.2351    0  383 1744.32217 14754.2351   746%     -  977s
     0     0 14738.1020    0  446 1744.32217 14738.1020   745%     -  988s
     0     0 14728.1053    0  439 1744.32217 14728.1053   744%     -  999s
     0     0 14722.5378    0  386 1744.32217 14722.5378   744%     - 1006s
     0     0 14717.2281    0  388 1744.32217 14717.2281   744%     - 1013s
     0     0 14715.0031    0  394 1744.32217 14715.0031   744%     - 1017s
     0     0 14591.2004    0  379 1744.32217 14591.2004   736%     - 1048s
     0     0 14571.7932    0  432 1744.32217 14571.7932   735%     - 1064s
     0     0 14550.7663    0  375 1744.32217 14550.7663   734%     - 1073s
     0     0 14546.1768    0  453 1744.32217 14546.1768   734%     - 1079s
     0     0 14545.1988    0  380 1744.32217 14545.1988   734%     - 1083s
     0     0 14483.1194    0  443 1744.32217 14483.1194   730%     - 1104s
     0     0 14469.1846    0  439 1744.32217 14469.1846   730%     - 1121s
     0     0 14458.6075    0  428 1744.32217 14458.6075   729%     - 1131s
     0     0 14453.4173    0  440 1744.32217 14453.4173   729%     - 1137s
     0     0 14452.5434    0  436 1744.32217 14452.5434   729%     - 1140s
     0     0 14431.5637    0  435 1744.32217 14431.5637   727%     - 1153s
     0     0 14424.3791    0  432 1744.32217 14424.3791   727%     - 1164s
     0     0 14423.0497    0  442 1744.32217 14423.0497   727%     - 1170s
     0     0 14395.9850    0  434 1744.32217 14395.9850   725%     - 1184s
     0     0 14388.1031    0  425 1744.32217 14388.1031   725%     - 1195s
     0     0 14386.1192    0  427 1744.32217 14386.1192   725%     - 1202s
     0     0 14372.7844    0  434 1744.32217 14372.7844   724%     - 1221s
     0     0 14364.0185    0  445 1744.32217 14364.0185   723%     - 1236s
     0     0 14358.2922    0  486 1744.32217 14358.2922   723%     - 1247s
     0     0 14357.9675    0  437 1744.32217 14357.9675   723%     - 1250s
     0     0 14334.0347    0  433 1744.32217 14334.0347   722%     - 1265s
     0     0 14321.7059    0  455 1744.32217 14321.7059   721%     - 1282s
     0     0 14320.1347    0  446 1744.32217 14320.1347   721%     - 1286s
     0     0 14314.3766    0  445 1744.32217 14314.3766   721%     - 1298s
     0     0 14309.8605    0  513 1744.32217 14309.8605   720%     - 1313s
     0     0 14308.2795    0  465 1744.32217 14308.2795   720%     - 1317s
     0     0 14301.8680    0  462 1744.32217 14301.8680   720%     - 1332s
     0     0 14300.2834    0  459 1744.32217 14300.2834   720%     - 1341s
     0     0 14289.7960    0  461 1744.32217 14289.7960   719%     - 1360s
     0     0 14289.5874    0  461 1744.32217 14289.5874   719%     - 1370s
H    0     0                    1797.9258342 14289.5790   695%     - 1435s
H    0     0                    4248.0257610 14289.5790   236%     - 1538s
H    0     0                    5380.9781648 14289.5790   166%     - 1539s
H    0     2                    5791.4984902 14289.5790   147%     - 1543s
     0     2 14289.5790    0  461 5791.49849 14289.5790   147%     - 1543s
     1     3 13734.2502    1  301 5791.49849 14289.5790   147% 13688 1574s
     2     4 14190.8270    1  432 5791.49849 14190.8270   145% 12504 1598s
     3     5 12866.7906    2  356 5791.49849 14190.7850   145% 13720 1629s
     4    10 12746.9654    3  294 5791.49849 14190.7850   145% 11836 1649s
     9    18 12621.7103    4  333 5791.49849 13921.5924   140%  8983 1703s
    17    25 8722.92050    5  184 5791.49849 13770.1789   138% 12403 1772s
    26    48 13036.9354    4  413 5791.49849 13694.5831   136% 12056 1910s
    49    78 12351.9604    5  359 5791.49849 13694.5831   136% 28653 1998s
H   50    78                    5855.0872430 13694.5831   134% 28080 1998s
H   54    78                    6345.7826909 13694.5831   116% 26765 1998s
    80   117 12016.4042    6  355 6345.78269 13694.5831   116% 21959 2113s
   121   177 11853.1214    7  396 6345.78269 13694.5831   116% 16384 2176s
H  129   177                    6361.5919886 13694.5831   115% 15626 2176s
   187   203 11804.6224    8  392 6361.59199 13694.5831   115% 12297 2229s
   220   251 11585.2317    9  395 6361.59199 13694.5831   115% 11030 2274s
   277   327 11475.5204   10  277 6361.59199 13694.5831   115%  9673 2325s
   359   382 10506.9001   11  240 6361.59199 13694.5831   115%  8590 2372s
   433   422 9828.67554   12  235 6361.59199 13694.5831   115%  7998 2413s
   506   462 9632.73540   13  235 6361.59199 13694.5831   115%  7400 2456s
   577   499 9272.84786   15  214 6361.59199 13694.5831   115%  6825 2496s
   646   534 9067.29968   17  163 6361.59199 13694.5831   115%  6450 2532s
   719   557     cutoff   20      6361.59199 13694.5831   115%  6078 2571s
   782   574 7864.35544   22  304 6361.59199 13694.5831   115%  5879 2610s
   834   593 infeasible   22      6361.59199 13694.5831   115%  5782 2651s
   883   623 infeasible   23      6361.59199 13694.5831   115%  5732 2692s
   935   649 9778.90272   11  262 6361.59199 13694.5831   115%  5731 2737s
   997   667 9757.84762   12  255 6361.59199 13694.5831   115%  5664 2780s
  1068   698 6777.17207   14  200 6361.59199 13694.5831   115%  5593 2828s
  1125   728 infeasible   15      6361.59199 13694.5831   115%  5581 2872s
  1177   753 8348.12870   12  309 6361.59199 13694.5831   115%  5516 2920s
  1225   812 9401.98079   14  169 6361.59199 13694.5831   115%  5510 2968s
  1320   863 9210.32137   16  169 6361.59199 13694.5831   115%  5393 3018s
  1418   916 8730.48412   20  128 6361.59199 13694.5831   115%  5284 3067s
  1524   984 7811.43353   24  120 6361.59199 13694.5831   115%  5193 3120s
  1649  1039 7539.99118   29  202 6361.59199 13694.5831   115%  5070 3180s
  1764  1073 7399.63602   35  182 6361.59199 13694.5831   115%  5012 3234s
  1854  1087 infeasible   47      6361.59199 13694.5831   115%  4987 3293s
  1928  1118 8340.59688    9  356 6361.59199 13694.5831   115%  5029 3355s
  2002  1155 7668.18510   10  419 6361.59199 13694.5831   115%  5079 3421s
  2091  1196 infeasible   11      6361.59199 13694.5831   115%  5090 3493s
  2160  1219 9586.64564    8  360 6361.59199 13331.3402   110%  5086 3566s
  2232  1230 9202.49465    9  350 6361.59199 13331.3402   110%  5111 3600s

Cutting planes:
  Learned: 2
  Gomory: 19
  Implied bound: 211
  MIR: 3070
  Flow cover: 3120
  Zero half: 1
  RLT: 80
  Relax-and-lift: 698

Explored 2268 nodes (12273819 simplex iterations) in 3600.06 seconds (5077.71 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 6361.59 6345.78 5855.09 ... 1679.56

Time limit reached
Best objective 6.361591988629e+03, best bound 1.333134020717e+04, gap 109.5598%
  WARNING: Time limit reached. Using best solution found (gap: 109.56%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 6361.59, θ = 135010.97
  Upper Bound (UB) = 6361.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 135010.97
  [DEBUG]   ✓ Scenario 0: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 135010.97 ≤ Q = 135010.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 135010.97 ≤ Q = 135010.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 135010.97 ≤ Q = 135170.20 (slack: 159.23)
  [DEBUG]   ✓ Scenario 7: θ = 135010.97 ≤ Q = 135010.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 135010.97 ≤ Q = 135010.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 135010.97 ≤ Q = 135010.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 135010.97 ≤ Q = 135010.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 135010.97 ≤ Q = 135281.92 (slack: 270.95)
  [DEBUG]   ✓ Scenario 16: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 135010.97 ≤ Q = 135010.97 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4f2ac4d4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4f2ac4d4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.476448e+13
Presolve removed 2650 rows and 1943 columns
Presolve time: 0.01s
Presolved: 443 rows, 446 columns, 1248 nonzeros
Found heuristic solution: objective 6610577.4354
Variable types: 302 continuous, 144 integer (144 binary)

Root relaxation: objective -1.357502e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135750.15    0  123 6610577.44 -135750.15   102%     -    0s
H    0     0                    -107005.6050 -135750.15  26.9%     -    0s
H    0     0                    -107158.7661 -135750.15  26.7%     -    0s
     0     0 -110435.26    0   94 -107158.77 -110435.26  3.06%     -    0s
H    0     0                    -107836.8778 -110326.77  2.31%     -    0s
     0     0 -109942.60    0   46 -107836.88 -109942.60  1.95%     -    0s
H    0     0                    -108941.2989 -109923.63  0.90%     -    0s
H    0     0                    -108943.9386 -109923.63  0.90%     -    0s
     0     0 -109635.62    0   29 -108943.94 -109635.62  0.63%     -    0s
     0     0 -109588.08    0   36 -108943.94 -109588.08  0.59%     -    0s
     0     0 -109587.70    0   37 -108943.94 -109587.70  0.59%     -    0s
     0     0 -109373.32    0   23 -108943.94 -109373.32  0.39%     -    0s
     0     0 -109341.33    0   20 -108943.94 -109341.33  0.36%     -    0s
     0     0 -109325.29    0   26 -108943.94 -109325.29  0.35%     -    0s
     0     0 -109316.89    0   27 -108943.94 -109316.89  0.34%     -    0s
     0     0 -109100.83    0   16 -108943.94 -109100.83  0.14%     -    0s
     0     0 -109099.71    0   15 -108943.94 -109099.71  0.14%     -    0s
H    0     0                    -108976.8563 -109082.19  0.10%     -    0s
     0     0 -109057.23    0   15 -108976.86 -109057.23  0.07%     -    0s
     0     0 -109056.58    0   17 -108976.86 -109056.58  0.07%     -    0s
     0     0 -109033.88    0    7 -108976.86 -109033.88  0.05%     -    0s
     0     0 -109033.88    0   15 -108976.86 -109033.88  0.05%     -    0s
H    0     0                    -109001.4187 -109033.88  0.03%     -    0s
*    0     0               0    -109014.9253 -109014.93  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 8
  Flow cover: 6
  RLT: 2
  PSD: 1

Explored 1 nodes (644 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -109015 -109001 -108977 ... 1.47645e+13
No other solutions better than -109015

Optimal solution found (tolerance 1.00e-04)
Best objective -1.090149253220e+05, best bound -1.090149253220e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 134369.62
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109014.93
  [DEBUG]   S×d_nominal = 243384.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243384.55 + -109014.93 = 134369.62
  [DEBUG]   Current θ from Master = 135010.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 641.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5720.25
  Lower Bound (LB) = 6180.43
  Gap (UB-LB) = 181.1624, Absolute Gap = 181.1624, Relative Gap = 0.028478
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 19
Total Time: 47685.61s
Converged: True
Final Lower Bound: 6180.4296
Final Upper Bound: 6361.5920
Final Gap: 181.162359
Number of Critical Scenarios: 19
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [4, 8, 9] (3/10)
Active Routes (Plant→DC): 8
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 19
Start Time: 2026-01-05 15:25:19
End Time: 2026-01-06 04:40:04
Total Time: 47685.61s
Optimal Value: 6180.43
Lower Bound: 6180.43
Upper Bound: 6361.59
Gap: 181.162359
Plants Opened: {0: [1], 1: [0], 2: [1]} (3 plants)
DCs Opened: [4, 8, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed3_MD_gamma20_20260106_044005.csv

Total Execution Time: 47686.14 seconds
End Time: 2026-01-06 04:40:05

All tasks completed successfully!

