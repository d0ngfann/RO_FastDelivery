
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 24
DI Scenario: Mixed
Start Time: 2026-01-04 12:31:03
================================================================================
Loading data from data/DH_data_full_seed24.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
  Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
  Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=993, max=1652
  DC capacity (MC): min=447, max=853

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.89, count=87
  Deviation (μ̂): min=4.03, max=9.95

Costs:
  Plant fixed cost: min=5996, max=9615
  DC fixed cost: min=3150, max=5670
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.499', '2.248'] (k=0.999)
    Product 2: ['1.000', '1.406', '1.976'] (k=0.840)
  MD:
    Product 0: ['1.000', '1.251', '1.565'] (k=0.553)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.267', '1.606'] (k=0.584)
  LD:
    Product 0: ['1.000', '1.019', '1.038'] (k=0.045)
    Product 1: ['1.000', '1.001', '1.001'] (k=0.001)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
  Mixed:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0xc91219e9
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.13s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -292401.0271
Found heuristic solution: objective -195802.1610

Root relaxation: objective 1.140142e+05, 5330 iterations, 0.33 seconds (0.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 114014.189    0  497 -195802.16 114014.189   158%     -    0s
H    0     0                    -190773.4392 114014.189   160%     -    0s
     0     0 102216.038    0  811 -190773.44 102216.038   154%     -    2s
H    0     0                    -188142.9364 101851.440   154%     -    2s
     0     0 101851.440    0  820 -188142.94 101851.440   154%     -    2s
     0     0 101839.153    0  830 -188142.94 101839.153   154%     -    2s
     0     0 101838.659    0  832 -188142.94 101838.659   154%     -    2s
H    0     0                    -169973.7486 101838.659   160%     -    2s
H    0     0                    -146622.5362 95470.7292   165%     -    3s
H    0     0                    -146060.1775 95470.7292   165%     -    3s
     0     0 95470.7292    0  932 -146060.18 95470.7292   165%     -    3s
     0     0 95211.0143    0  931 -146060.18 95211.0143   165%     -    4s
     0     0 95186.5912    0  931 -146060.18 95186.5912   165%     -    4s
     0     0 95185.3578    0  946 -146060.18 95185.3578   165%     -    4s
     0     0 90127.8211    0 1010 -146060.18 90127.8211   162%     -    6s
     0     0 89807.6817    0 1018 -146060.18 89807.6817   161%     -    7s
H    0     0                    -75401.36811 89777.4703   219%     -    7s
     0     0 89777.4703    0 1011 -75401.368 89777.4703   219%     -    7s
H    0     0                    -36544.72332 89776.7958   346%     -    7s
     0     0 89776.7958    0 1011 -36544.723 89776.7958   346%     -    7s
H    0     0                    24240.406727 89776.7958   270%     -    8s
H    0     0                    24676.688752 85699.1863   247%     -   10s
H    0     0                    25203.046399 85699.1863   240%     -   10s
     0     0 85699.1863    0 1084 25203.0464 85699.1863   240%     -   10s
H    0     0                    25282.158000 85252.1125   237%     -   10s
H    0     0                    26113.047865 85252.1125   226%     -   10s
H    0     0                    26430.984885 85252.1125   223%     -   10s
H    0     0                    26478.489392 85252.1125   222%     -   10s
H    0     0                    27375.012698 85252.1125   211%     -   10s
H    0     0                    27434.112849 85252.1125   211%     -   10s
H    0     0                    27477.520958 85252.1125   210%     -   10s
H    0     0                    27522.891479 85252.1125   210%     -   10s
H    0     0                    27710.496950 85252.1125   208%     -   10s
H    0     0                    27752.852449 85252.1125   207%     -   10s
H    0     0                    27783.540627 85252.1125   207%     -   10s
     0     0 85252.1125    0 1085 27783.5406 85252.1125   207%     -   10s
H    0     0                    28633.791852 85174.0004   197%     -   11s
H    0     0                    28636.565146 85174.0004   197%     -   11s
H    0     0                    28832.901820 85174.0004   195%     -   11s
H    0     0                    29143.258749 85174.0004   192%     -   11s
H    0     0                    29156.399693 85174.0004   192%     -   11s
     0     0 85174.0004    0 1100 29156.3997 85174.0004   192%     -   11s
     0     0 85157.7253    0 1108 29156.3997 85157.7253   192%     -   11s
     0     0 85157.1481    0 1117 29156.3997 85157.1481   192%     -   11s
H    0     0                    29559.861626 81182.3883   175%     -   14s
H    0     0                    29564.362810 81182.3883   175%     -   14s
H    0     0                    29579.550975 81182.3883   174%     -   14s
H    0     0                    29601.313720 81182.3883   174%     -   14s
     0     0 81182.3883    0  997 29601.3137 81182.3883   174%     -   14s
H    0     0                    29668.870193 80534.0391   171%     -   15s
H    0     0                    29675.621360 80534.0391   171%     -   15s
     0     0 80534.0391    0 1047 29675.6214 80534.0391   171%     -   15s
     0     0 80433.9104    0 1065 29675.6214 80433.9104   171%     -   15s
     0     0 80414.8578    0 1065 29675.6214 80414.8578   171%     -   15s
H    0     0                    31521.762539 80407.4050   155%     -   15s
     0     0 80407.4050    0 1069 31521.7625 80407.4050   155%     -   15s
H    0     0                    31529.631450 73584.8896   133%     -   18s
H    0     0                    31580.110492 73584.8896   133%     -   18s
     0     0 73584.8896    0  822 31580.1105 73584.8896   133%     -   18s
H    0     0                    31612.660971 72552.3412   130%     -   19s
     0     0 72552.3412    0  843 31612.6610 72552.3412   130%     -   19s
     0     0 72515.7436    0  849 31612.6610 72515.7436   129%     -   19s
     0     0 72487.1219    0  873 31612.6610 72487.1219   129%     -   19s
     0     0 72475.0583    0  865 31612.6610 72475.0583   129%     -   20s
     0     0 67352.7168    0  761 31612.6610 67352.7168   113%     -   22s
H    0     0                    31661.219338 66555.3499   110%     -   23s
     0     0 66555.3499    0  793 31661.2193 66555.3499   110%     -   23s
     0     0 66327.9325    0  800 31661.2193 66327.9325   109%     -   23s
     0     0 66254.5035    0  819 31661.2193 66254.5035   109%     -   23s
H    0     0                    31781.046284 66214.5795   108%     -   24s
     0     0 66214.5795    0  816 31781.0463 66214.5795   108%     -   24s
     0     0 66209.2197    0  840 31781.0463 66209.2197   108%     -   24s
H    0     0                    31793.401539 64175.6479   102%     -   26s
H    0     0                    31856.194797 64175.6479   101%     -   26s
H    0     0                    31863.486270 64175.6479   101%     -   26s
H    0     0                    31938.886596 64175.6479   101%     -   26s
H    0     0                    31948.954335 64175.6479   101%     -   26s
H    0     0                    32015.660309 64175.6479   100%     -   26s
H    0     0                    32295.154429 64175.6479  98.7%     -   26s
H    0     0                    32432.462198 64175.6479  97.9%     -   26s
     0     0 64175.6479    0  776 32432.4622 64175.6479  97.9%     -   26s
     0     0 63750.5570    0  805 32432.4622 63750.5570  96.6%     -   27s
     0     0 63602.4594    0  800 32432.4622 63602.4594  96.1%     -   28s
H    0     0                    32443.505075 63561.3806  95.9%     -   28s
H    0     0                    32458.551718 63561.3806  95.8%     -   28s
     0     0 63561.3806    0  818 32458.5517 63561.3806  95.8%     -   28s
     0     0 63541.2689    0  821 32458.5517 63541.2689  95.8%     -   28s
H    0     0                    32462.500607 61998.3759  91.0%     -   30s
H    0     0                    35017.291666 61998.3759  77.1%     -   30s
H    0     0                    35258.421508 61998.3759  75.8%     -   30s
H    0     0                    35281.829940 61998.3759  75.7%     -   30s
     0     0 61998.3759    0  766 35281.8299 61998.3759  75.7%     -   30s
     0     0 61729.4922    0  816 35281.8299 61729.4922  75.0%     -   31s
     0     0 61660.7877    0  833 35281.8299 61660.7877  74.8%     -   32s
H    0     0                    35451.899836 61640.6030  73.9%     -   32s
H    0     0                    37227.908865 61640.6030  65.6%     -   32s
     0     0 61640.6030    0  833 37227.9089 61640.6030  65.6%     -   32s
     0     0 60760.7214    0  757 37227.9089 60760.7214  63.2%     -   34s
     0     0 60473.5579    0  806 37227.9089 60473.5579  62.4%     -   34s
H    0     0                    37441.729004 60352.7202  61.2%     -   35s
H    0     0                    37471.407607 60352.7202  61.1%     -   35s
H    0     0                    37537.929253 60352.7202  60.8%     -   35s
     0     0 60352.7202    0  837 37537.9293 60352.7202  60.8%     -   35s
H    0     0                    37798.237914 60319.6357  59.6%     -   35s
H    0     0                    37803.509801 60319.6357  59.6%     -   35s
     0     0 60319.6357    0  810 37803.5098 60319.6357  59.6%     -   35s
     0     0 59678.8871    0  765 37803.5098 59678.8871  57.9%     -   37s
     0     0 59497.7404    0  665 37803.5098 59497.7404  57.4%     -   38s
     0     0 59442.4761    0  763 37803.5098 59442.4761  57.2%     -   39s
     0     0 59423.5723    0  808 37803.5098 59423.5723  57.2%     -   39s
     0     0 58952.7477    0  839 37803.5098 58952.7477  55.9%     -   41s
H    0     0                    37905.202038 58787.0552  55.1%     -   42s
H    0     0                    37963.860984 58787.0552  54.9%     -   42s
     0     0 58787.0552    0  831 37963.8610 58787.0552  54.9%     -   42s
H    0     0                    38408.186356 58761.4970  53.0%     -   42s
H    0     0                    38723.153490 58761.4970  51.7%     -   42s
H    0     0                    38901.251746 58761.4970  51.1%     -   42s
H    0     0                    38910.783003 58761.4970  51.0%     -   42s
     0     0 58761.4970    0  833 38910.7830 58761.4970  51.0%     -   42s
H    0     0                    38915.029651 58436.4380  50.2%     -   44s
H    0     0                    39291.474739 58436.4380  48.7%     -   44s
H    0     0                    39567.026757 58436.4380  47.7%     -   44s
H    0     0                    39690.170699 58436.4380  47.2%     -   44s
H    0     0                    39769.780525 58436.4380  46.9%     -   44s
H    0     0                    39908.204559 58436.4380  46.4%     -   44s
H    0     0                    39988.033708 58436.4380  46.1%     -   44s
     0     0 58436.4380    0  872 39988.0337 58436.4380  46.1%     -   44s
     0     0 58288.0406    0  790 39988.0337 58288.0406  45.8%     -   44s
     0     0 58231.7629    0  897 39988.0337 58231.7629  45.6%     -   45s
     0     0 58217.0051    0  826 39988.0337 58217.0051  45.6%     -   45s
     0     0 57985.9204    0  888 39988.0337 57985.9204  45.0%     -   47s
     0     0 57985.7967    0  888 39988.0337 57985.7967  45.0%     -   47s
     0     2 57985.6301    0  888 39988.0337 57985.6301  45.0%     -   49s
     1     4 57929.4930    1  823 39988.0337 57985.6301  45.0%  1092   51s
     7    16 56762.0234    3  685 39988.0337 57825.6158  44.6%  2356   56s
    31    63 55296.0475    5  589 39988.0337 57038.2618  42.6%  4222   69s
H   36    63                    40228.719697 57038.2618  41.8%  4670   69s
H   37    63                    40273.706069 57038.2618  41.6%  4739   69s
    62    95 55013.5308    6  500 40273.7061 56737.9478  40.9%  5992   72s
H   94   232                    40295.782780 56271.0425  39.6%  4661   74s
H  113   232                    40698.542817 56271.0425  38.3%  4015   74s
H  132   232                    40774.069222 56271.0425  38.0%  3615   74s
   235   343 53152.5757   10  456 40774.0692 56271.0425  38.0%  2368   76s
H  367   370                    40783.600478 56271.0425  38.0%  1709   77s
H  447   481                    40838.416216 56271.0425  37.8%  1498   78s
   579   592 52021.2238   16  426 40838.4162 56271.0425  37.8%  1233   81s
   698   714 51984.8521   17  431 40838.4162 56271.0425  37.8%  1088   85s
H  809   745                    41024.346156 55769.0673  35.9%   992   85s
  1219  1157 45786.3536   26  403 41024.3462 55729.9444  35.8%   760   90s
  1620  1357 43769.4023   30  313 41024.3462 55729.9444  35.8%   665   96s
  1904  1690 42242.6684   35  298 41024.3462 55561.3724  35.4%   628  101s
  2477  2181 45446.4037   11  208 41024.3462 54993.9853  34.1%   555  105s
  3227  2589 48318.6658   11  196 41024.3462 54783.9958  33.5%   490  110s
  3570  2777     cutoff   19      41024.3462 54503.1677  32.9%   485  117s
  3984  2963 50809.2240   12  341 41024.3462 54503.1677  32.9%   469  120s
  4424  3104 43148.1397   26  888 41024.3462 54384.6018  32.6%   465  139s
  4427  3106 52567.2559   11  360 41024.3462 54384.6018  32.6%   464  140s
  4448  3120 45153.4875   12  349 41024.3462 54384.6018  32.6%   462  145s
  4467  3150 53015.4283   13  398 41024.3462 54384.6018  32.6%   467  150s
  4913  3248 43565.4133   21  253 41024.3462 51427.3981  25.4%   463  155s
H 5276  3007                    41109.810396 50001.3823  21.6%   449  157s
  5630  2898 45658.1989   20  306 41109.8104 49418.7624  20.2%   439  160s
  6406  2628 43184.0822   27  291 41109.8104 48540.0307  18.1%   417  165s
  8170  2235 41312.2719   31   78 41109.8104 44320.2077  7.81%   348  170s
* 8339  2030              51    41134.597101 43105.9562  4.79%   342  170s
* 9325  1742              60    41215.440570 41692.9218  1.16%   309  170s
*10944   857              44    41245.632340 41645.2950  0.97%   267  170s
*11459   557              49    41297.867421 41584.6186  0.69%   256  170s

Cutting planes:
  Implied bound: 15
  Projected implied bound: 17
  MIR: 266
  Flow cover: 496
  RLT: 32
  Relax-and-lift: 115
  BQP: 3

Explored 12691 nodes (3042821 simplex iterations) in 171.00 seconds (225.82 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41297.9 41245.6 41215.4 ... 40698.5

Optimal solution found (tolerance 1.00e-04)
Best objective 4.129786742124e+04, best bound 4.129786742124e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 171.00s
  Master Objective (UB) = 41297.87, θ = 193255.01
  Upper Bound (UB) = 41297.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 193255.01
  [DEBUG]   ✓ Scenario 0: θ = 193255.01 ≤ Q = 193255.01 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69493bda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69493bda
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.352302e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 7104670.0433
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.523045e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152304.53    0  123 7104670.04 -152304.53   102%     -    0s
H    0     0                    -116904.2763 -152304.53  30.3%     -    0s
H    0     0                    -117200.2049 -152304.53  30.0%     -    0s
*    0     0               0    -119824.7995 -119824.80  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 210

Explored 1 nodes (375 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -119825 -117200 -116904 ... 1.3523e+13
No other solutions better than -119825

Optimal solution found (tolerance 1.00e-04)
Best objective -1.198247994561e+05, best bound -1.198247994561e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 161298.93
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119824.80
  [DEBUG]   S×d_nominal = 281123.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 281123.73 + -119824.80 = 161298.93
  [DEBUG]   Current θ from Master = 193255.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31956.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9341.79
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 31956.0799, Absolute Gap = 31956.0799, Relative Gap = 0.773795
  Not converged yet (gap = 31956.08 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0x4865f973
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 9341.79 (0.02s)
MIP start from previous solve produced solution with objective 9341.79 (0.02s)
Loaded MIP start from previous solve with objective 9341.79

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.47s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.371957e+04, 10259 iterations, 2.10 seconds (2.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53719.5697    0  292 9341.78754 53719.5697   475%     -    2s
H    0     0                    9895.6805385 53719.5697   443%     -    2s
H    0     0                    9999.1261731 53719.5697   437%     -    2s
H    0     0                    10060.201761 53719.5697   434%     -    2s
     0     0 43277.3324    0  517 10060.2018 43277.3324   330%     -    5s
H    0     0                    10124.070832 43276.5975   327%     -    6s
H    0     0                    10264.077518 43276.5975   322%     -    6s
H    0     0                    10299.470402 43276.5975   320%     -    6s
     0     0 43213.2219    0  517 10299.4704 43213.2219   320%     -    6s
     0     0 37857.8110    0  538 10299.4704 37857.8110   268%     -    9s
H    0     0                    10308.633095 37123.1680   260%     -    9s
H    0     0                    10550.449041 37123.1680   252%     -    9s
     0     0 37123.1680    0  548 10550.4490 37123.1680   252%     -    9s
     0     0 36975.4630    0  578 10550.4490 36975.4630   250%     -   10s
     0     0 36958.7977    0  577 10550.4490 36958.7977   250%     -   10s
     0     0 36944.1320    0  591 10550.4490 36944.1320   250%     -   10s
     0     0 36943.5584    0  581 10550.4490 36943.5584   250%     -   10s
     0     0 33293.8086    0  499 10550.4490 33293.8086   216%     -   14s
     0     0 32673.5767    0  562 10550.4490 32673.5767   210%     -   15s
     0     0 32565.7912    0  560 10550.4490 32565.7912   209%     -   15s
     0     0 32519.4808    0  558 10550.4490 32519.4808   208%     -   15s
     0     0 32501.2717    0  564 10550.4490 32501.2717   208%     -   16s
     0     0 32497.3740    0  569 10550.4490 32497.3740   208%     -   16s
     0     0 30647.8426    0  593 10550.4490 30647.8426   190%     -   20s
     0     0 30127.5082    0  529 10550.4490 30127.5082   186%     -   21s
     0     0 30048.3809    0  702 10550.4490 30048.3809   185%     -   22s
H    0     0                    15105.186270 30005.0069  98.6%     -   22s
H    0     0                    15116.572461 30005.0069  98.5%     -   22s
H    0     0                    15145.668211 30005.0069  98.1%     -   22s
     0     0 30005.0069    0  690 15145.6682 30005.0069  98.1%     -   22s
H    0     0                    15170.873629 30001.7219  97.8%     -   22s
     0     0 30001.7219    0  699 15170.8736 30001.7219  97.8%     -   22s
     0     0 29250.6701    0  417 15170.8736 29250.6701  92.8%     -   25s
H    0     0                    15319.674790 29250.3785  90.9%     -   25s
H    0     0                    15398.045560 29250.3785  90.0%     -   25s
H    0     0                    15418.213527 29250.3785  89.7%     -   25s
     0     0 29078.4872    0  409 15418.2135 29078.4872  88.6%     -   26s
     0     0 29050.8263    0  422 15418.2135 29050.8263  88.4%     -   26s
     0     0 29038.6470    0  418 15418.2135 29038.6470  88.3%     -   26s
     0     0 29034.2715    0  438 15418.2135 29034.2715  88.3%     -   26s
     0     0 28699.7702    0  397 15418.2135 28699.7702  86.1%     -   28s
H    0     0                    15427.784510 28698.6874  86.0%     -   28s
     0     0 28655.2278    0  398 15427.7845 28655.2278  85.7%     -   28s
     0     0 28642.7424    0  398 15427.7845 28642.7424  85.7%     -   29s
     0     0 28638.9922    0  399 15427.7845 28638.9922  85.6%     -   29s
H    0     0                    15486.673691 28512.5845  84.1%     -   30s
H    0     0                    15641.330221 28512.5845  82.3%     -   30s
     0     0 28512.5845    0  447 15641.3302 28512.5845  82.3%     -   30s
     0     0 28484.9795    0  523 15641.3302 28484.9795  82.1%     -   31s
     0     0 28478.9894    0  529 15641.3302 28478.9894  82.1%     -   31s
     0     0 28428.3655    0  557 15641.3302 28428.3655  81.8%     -   32s
     0     0 28401.5152    0  413 15641.3302 28401.5152  81.6%     -   33s
     0     0 28398.6876    0  417 15641.3302 28398.6876  81.6%     -   33s
     0     0 28375.2501    0  403 15641.3302 28375.2501  81.4%     -   34s
     0     0 28365.8549    0  409 15641.3302 28365.8549  81.4%     -   34s
     0     0 28359.6959    0  424 15641.3302 28359.6959  81.3%     -   34s
     0     0 28348.9500    0  420 15641.3302 28348.9500  81.2%     -   35s
     0     0 28345.3234    0  424 15641.3302 28345.3234  81.2%     -   36s
     0     0 28338.2732    0  470 15641.3302 28338.2732  81.2%     -   37s
     0     0 28338.0372    0  470 15641.3302 28338.0372  81.2%     -   37s
     0     2 28337.3404    0  470 15641.3302 28337.3404  81.2%     -   43s
     3     8 27482.3044    2  468 15641.3302 28169.1676  80.1%  1036   45s
    31    64 26376.1497    5  591 15641.3302 27376.7884  75.0%  1497   50s
    95   152 26029.8690    7  534 15641.3302 27169.9787  73.7%  1533   58s
H  119   152                    15659.980800 27169.9787  73.5%  1339   58s
   276   346 25060.0719   10  357 15659.9808 27169.9787  73.5%   842   62s
H  286   346                    15665.960922 27169.9787  73.4%   835   62s
   500   478 24932.7740   13  414 15665.9609 27169.9787  73.4%   674   66s
   634   622 24396.3354   16  406 15665.9609 26642.6823  70.1%   671   71s
   782   759 22136.1390   18  360 15665.9609 26541.2123  69.4%   631   76s
  1072   940 22526.8521   21  373 15665.9609 26494.1310  69.1%   550   80s
  1273  1100 21229.9567   24  355 15665.9609 26443.6149  68.8%   535   86s
H 1357  1146                    15669.647218 26443.6149  68.8%   525   88s
  1574  1438 20471.8409   29  333 15669.6472 26388.0755  68.4%   486   91s
  2179  1814 18843.6043   38  318 15669.6472 26239.2231  67.5%   415   96s
H 2372  1832                    15706.687082 26239.2231  67.1%   406   98s
  2425  1934 15938.1056   49  224 15706.6871 26239.2231  67.1%   407  100s
  2782  2118 24064.5709    9  564 15706.6871 26142.0178  66.4%   402  105s
  3370  2508 21944.5433   20  214 15706.6871 26142.0178  66.4%   386  111s
H 3682  2564                    15805.543640 26007.9223  64.5%   375  114s
  3754  2701 19170.4913   49   86 15805.5436 26007.9223  64.5%   374  117s
  4287  2891     cutoff   17      15805.5436 25942.9331  64.1%   365  121s
  4516  3107 20799.5502   14  275 15805.5436 25942.9331  64.1%   365  125s
  4909  3108 18862.9688   22  470 15805.5436 25495.3361  61.3%   353  148s
H 4910  2953                    15810.052410 25495.3361  61.3%   353  151s
  4912  2954 22673.6606   21  387 15810.0524 25495.3361  61.3%   353  155s
  4920  2959 18842.4921   13  459 15810.0524 25495.3361  61.3%   352  160s
  4927  2964 21741.4352   18  461 15810.0524 25495.3361  61.3%   352  165s
  4933  2968 18953.8994   27  524 15810.0524 25495.3361  61.3%   351  170s
  4937  2971 24660.4020   14  485 15810.0524 25495.3361  61.3%   351  176s
  4939  2975 25495.3361   10  325 15810.0524 25495.3361  61.3%   357  181s
  4953  2998 24765.1009   13  322 15810.0524 25495.3361  61.3%   360  186s
H 4996  2865                    15824.482439 25495.3361  61.1%   368  188s
H 4997  2723                    15825.000232 25495.3361  61.1%   368  188s
  5033  2754     cutoff   16      15825.0002 25495.3361  61.1%   376  192s
H 5053  2613                    15825.221172 25495.3361  61.1%   377  192s
  5150  2647 23129.5155   17  387 15825.2212 25495.3361  61.1%   386  195s
  5377  2644     cutoff   19      15825.2212 24821.4500  56.8%   393  200s
  5574  2612     cutoff   22      15825.2212 24682.1864  56.0%   398  205s
H 5734  2447                    15832.592380 23767.1631  50.1%   398  208s
  5830  2445 17124.7108   27  210 15832.5924 23767.1631  50.1%   398  211s
H 5907  2298                    15843.048640 23767.1631  50.0%   398  211s
  6024  2315 17777.1162   28  212 15843.0486 23548.3238  48.6%   397  215s
H 6342  2136                    15855.675924 22762.0309  43.6%   394  218s
  6367  2124 16166.3105   41   82 15855.6759 22762.0309  43.6%   393  220s
H 6474  1990                    15856.244480 22762.0309  43.6%   394  222s
  6696  1871 16438.4639   19  261 15856.2445 21650.7288  36.5%   395  226s
  6921  1749     cutoff   17      15856.2445 20657.4809  30.3%   397  230s
  7331  1506 infeasible   26      15856.2445 19860.0217  25.3%   395  236s
  8237  1159 infeasible   22      15856.2445 17446.4746  10.0%   371  241s

Cutting planes:
  Learned: 1
  MIR: 259
  Flow cover: 467
  RLT: 9
  Relax-and-lift: 48

Explored 9086 nodes (3114564 simplex iterations) in 241.65 seconds (371.34 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 15856.2 15843 15832.6 ... 15660

Optimal solution found (tolerance 1.00e-04)
Best objective 1.585624448025e+04, best bound 1.585624448025e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 241.66s
  Master Objective (UB) = 15856.24, θ = 150631.68
  Upper Bound (UB) = 15856.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150631.68
  [DEBUG]   ✓ Scenario 0: θ = 150631.68 ≤ Q = 150631.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150631.68 ≤ Q = 150631.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xdc40684
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0dc40684
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.411776e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 7755468.7301
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.442174e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144217.42    0  139 7755468.73 -144217.42   102%     -    0s
H    0     0                    -103189.0035 -144217.42  39.8%     -    0s
H    0     0                    -104439.9269 -144217.42  38.1%     -    0s
H    0     0                    -122011.8033 -144217.42  18.2%     -    0s
     0     0 -132862.58    0   74 -122011.80 -132862.58  8.89%     -    0s
H    0     0                    -129989.5426 -132762.87  2.13%     -    0s
     0     0 -131700.35    0   81 -129989.54 -131700.35  1.32%     -    0s
     0     0 -131671.64    0   81 -129989.54 -131671.64  1.29%     -    0s
     0     0 -131668.84    0   81 -129989.54 -131668.84  1.29%     -    0s
     0     0 -130969.20    0   22 -129989.54 -130969.20  0.75%     -    0s
H    0     0                    -130307.6756 -130965.45  0.50%     -    0s
     0     0 -130792.11    0   24 -130307.68 -130792.11  0.37%     -    0s
H    0     0                    -130322.3787 -130724.87  0.31%     -    0s
     0     0 -130724.87    0   29 -130322.38 -130724.87  0.31%     -    0s
     0     0 -130716.86    0   29 -130322.38 -130716.86  0.30%     -    0s
     0     0 -130635.48    0   12 -130322.38 -130635.48  0.24%     -    0s
     0     0 -130620.68    0   12 -130322.38 -130620.68  0.23%     -    0s
     0     0 -130620.68    0   12 -130322.38 -130620.68  0.23%     -    0s
     0     0 -130620.68    0   12 -130322.38 -130620.68  0.23%     -    0s
H    0     0                    -130376.4464 -130566.80  0.15%     -    0s
     0     0 -130566.80    0    8 -130376.45 -130566.80  0.15%     -    0s
H    0     0                    -130414.0768 -130557.26  0.11%     -    0s
     0     0 -130557.26    0    7 -130414.08 -130557.26  0.11%     -    0s
     0     0 -130549.63    0    8 -130414.08 -130549.63  0.10%     -    0s
     0     0 -130549.63    0   14 -130414.08 -130549.63  0.10%     -    0s
H    0     0                    -130487.2570 -130549.63  0.05%     -    0s
     0     0 -130528.82    0    6 -130487.26 -130528.82  0.03%     -    0s
H    0     0                    -130488.3977 -130525.44  0.03%     -    0s
     0     0 -130515.27    0    6 -130488.40 -130515.27  0.02%     -    0s
H    0     0                    -130507.5565 -130515.27  0.01%     -    0s

Cutting planes:
  Gomory: 11
  Implied bound: 6
  MIR: 5
  Flow cover: 5
  Relax-and-lift: 3

Explored 1 nodes (901 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -130508 -130488 -130487 ... -104440
No other solutions better than -130508

Optimal solution found (tolerance 1.00e-04)
Best objective -1.305075564711e+05, best bound -1.305075564711e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 126965.41
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130507.56
  [DEBUG]   S×d_nominal = 257472.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 257472.97 + -130507.56 = 126965.41
  [DEBUG]   Current θ from Master = 150631.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23666.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7810.02
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 6514.4569, Absolute Gap = 6514.4569, Relative Gap = 0.410845
  Not converged yet (gap = 6514.46 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0xa84b8e84
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -7810.02 (0.03s)
Loaded MIP start from previous solve with objective -7810.02

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.70s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41955    2.5472319e+04   0.000000e+00   1.195977e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   17925    3.9164162e+04   0.000000e+00   0.000000e+00      8s

Root relaxation: objective 3.916416e+04, 17925 iterations, 6.77 seconds (8.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39164.1619    0  206 -7810.0249 39164.1619   601%     -    7s
H    0     0                    3769.6084238 39164.1619   939%     -    7s
H    0     0                    4208.9903676 39164.1619   830%     -    7s
H    0     0                    4352.0473685 39164.1619   800%     -    8s
H    0     0                    4482.8507627 39164.1619   774%     -    8s
H    0     0                    4501.8674874 39164.1619   770%     -    8s
H    0     0                    4514.3541415 39164.1619   768%     -    8s
H    0     0                    6460.0895900 39164.1619   506%     -    9s
H    0     0                    9311.4036490 39164.1619   321%     -    9s
H    0     0                    9452.7668401 39164.1619   314%     -    9s
H    0     0                    9487.2371685 39164.1619   313%     -    9s
     0     0 35214.9099    0  309 9487.23717 35214.9099   271%     -   11s
     0     0 34551.1871    0  212 9487.23717 34551.1871   264%     -   12s
     0     0 34243.8510    0  312 9487.23717 34243.8510   261%     -   12s
     0     0 34218.8092    0  307 9487.23717 34218.8092   261%     -   13s
     0     0 34218.7008    0  307 9487.23717 34218.7008   261%     -   13s
     0     0 32427.7809    0  268 9487.23717 32427.7809   242%     -   15s
H    0     0                    11989.368877 32420.8329   170%     -   15s
H    0     0                    12017.406471 32420.8329   170%     -   15s
H    0     0                    12568.322978 32420.8329   158%     -   15s
H    0     0                    12575.235946 32420.8329   158%     -   15s
H    0     0                    12597.453300 32420.8329   157%     -   15s
H    0     0                    12649.518232 32420.8329   156%     -   15s
     0     0 31867.7802    0  270 12649.5182 31867.7802   152%     -   16s
     0     0 31717.8437    0  285 12649.5182 31717.8437   151%     -   16s
     0     0 31674.2489    0  283 12649.5182 31674.2489   150%     -   16s
     0     0 31672.8304    0  284 12649.5182 31672.8304   150%     -   17s
     0     0 31672.4642    0  286 12649.5182 31672.4642   150%     -   17s
     0     0 30178.0593    0  309 12649.5182 30178.0593   139%     -   20s
H    0     0                    12674.941597 30177.7060   138%     -   20s
H    0     0                    12695.639944 30177.7060   138%     -   20s
     0     0 29865.2195    0  331 12695.6399 29865.2195   135%     -   21s
     0     0 29670.1137    0  368 12695.6399 29670.1137   134%     -   22s
     0     0 29565.3961    0  371 12695.6399 29565.3961   133%     -   23s
     0     0 29546.9842    0  375 12695.6399 29546.9842   133%     -   23s
     0     0 29543.8981    0  379 12695.6399 29543.8981   133%     -   23s
     0     0 29543.8965    0  379 12695.6399 29543.8965   133%     -   23s
     0     0 28855.1427    0  395 12695.6399 28855.1427   127%     -   28s
H    0     0                    12945.721249 28854.8122   123%     -   28s
     0     0 28700.8085    0  428 12945.7212 28700.8085   122%     -   29s
     0     0 28581.0893    0  400 12945.7212 28581.0893   121%     -   30s
     0     0 28557.1570    0  357 12945.7212 28557.1570   121%     -   31s
     0     0 28528.4459    0  411 12945.7212 28528.4459   120%     -   31s
     0     0 28489.1266    0  414 12945.7212 28489.1266   120%     -   32s
     0     0 28479.2919    0  408 12945.7212 28479.2919   120%     -   32s
     0     0 28470.0612    0  360 12945.7212 28470.0612   120%     -   32s
     0     0 28466.0193    0  353 12945.7212 28466.0193   120%     -   32s
     0     0 28463.8852    0  356 12945.7212 28463.8852   120%     -   32s
     0     0 28462.2746    0  362 12945.7212 28462.2746   120%     -   32s
     0     0 28461.4133    0  365 12945.7212 28461.4133   120%     -   32s
     0     0 28178.7711    0  411 12945.7212 28178.7711   118%     -   35s
     0     0 28084.4655    0  435 12945.7212 28084.4655   117%     -   36s
     0     0 28045.1168    0  444 12945.7212 28045.1168   117%     -   37s
     0     0 28037.2848    0  441 12945.7212 28037.2848   117%     -   37s
     0     0 28033.1270    0  449 12945.7212 28033.1270   117%     -   37s
     0     0 28031.8208    0  449 12945.7212 28031.8208   117%     -   37s
     0     0 27865.5722    0  434 12945.7212 27865.5722   115%     -   39s
H    0     0                    12958.787411 27863.1561   115%     -   40s
     0     0 27830.7087    0  382 12958.7874 27830.7087   115%     -   40s
     0     0 27825.2745    0  328 12958.7874 27825.2745   115%     -   41s
     0     0 27823.4718    0  380 12958.7874 27823.4718   115%     -   41s
     0     0 27822.6490    0  380 12958.7874 27822.6490   115%     -   41s
     0     0 27797.5832    0  327 12958.7874 27797.5832   115%     -   42s
     0     0 27791.5120    0  431 12958.7874 27791.5120   114%     -   42s
     0     0 27787.8005    0  440 12958.7874 27787.8005   114%     -   42s
     0     0 27786.4177    0  442 12958.7874 27786.4177   114%     -   43s
     0     0 27781.3768    0  447 12958.7874 27781.3768   114%     -   43s
     0     0 27779.7568    0  441 12958.7874 27779.7568   114%     -   44s
     0     0 27779.5154    0  449 12958.7874 27779.5154   114%     -   44s
     0     0 27771.1421    0  475 12958.7874 27771.1421   114%     -   45s
     0     0 27764.4951    0  467 12958.7874 27764.4951   114%     -   46s
     0     0 27764.4951    0  471 12958.7874 27764.4951   114%     -   46s
     0     0 27764.4951    0  447 12958.7874 27764.4951   114%     -   47s
     0     0 27764.4951    0  440 12958.7874 27764.4951   114%     -   47s
     0     0 27763.9347    0  440 12958.7874 27763.9347   114%     -   48s
H    0     0                    13119.608843 27763.9347   112%     -   55s
H    0     0                    13126.927417 27763.9347   112%     -   56s
     0     2 27763.9347    0  440 13126.9274 27763.9347   112%     -   56s
     7    16 27071.7465    3  474 13126.9274 27417.0618   109%  2136   62s
    15    32 26663.2451    4  492 13126.9274 27063.2394   106%  2530   65s
H   35    64                    13130.518533 26663.2120   103%  3307   69s
H   39    64                    13225.428176 26663.2120   102%  3104   69s
    63    96 26242.0044    6  439 13225.4282 26577.6357   101%  2792   72s
    95   207 26217.1247    7  440 13225.4282 26577.6357   101%  2089   77s
H  144   207                    13238.807949 26577.6357   101%  1758   77s
   206   279 25922.2935   10  399 13238.8079 26577.6357   101%  1485   81s
   357   407 25306.1487   12  401 13238.8079 26577.6357   101%  1381   87s
   428   460 25014.3087   13  401 13238.8079 26572.0779   101%  1308   91s
   544   554 24740.2992   15  436 13238.8079 26572.0779   101%  1306   97s
   601   615 24083.6799   17  378 13238.8079 26572.0779   101%  1298  100s
   712   683 22411.0956   18  407 13238.8079 26572.0779   101%  1282  108s
   762   729 22812.3082   19  405 13238.8079 26572.0779   101%  1301  111s
   815   771 22686.1657   19  244 13238.8079 26572.0779   101%  1326  115s
   935   850 21096.9180   21  389 13238.8079 26240.5047  98.2%  1327  121s
  1030   928 20730.1480   23  382 13238.8079 26240.5047  98.2%  1318  128s
  1064   973 20549.6217   24  391 13238.8079 26240.5047  98.2%  1313  130s
  1123  1040 20437.6271   25  347 13238.8079 26240.5047  98.2%  1287  135s
  1268  1214 19909.1257   26  333 13238.8079 26240.5047  98.2%  1234  141s
  1522  1432 18913.3600   36  228 13238.8079 26190.0410  97.8%  1125  148s
  1648  1488 17457.5561   39  237 13238.8079 26190.0410  97.8%  1097  152s
  1716  1609 18104.2187   40  212 13238.8079 26063.6743  96.9%  1085  155s
  2015  1906 15854.7759   51  141 13238.8079 26038.4897  96.7%  1019  164s
  2220  2085 14632.6652   61  117 13238.8079 26038.4897  96.7%   973  168s
  2465  2209     cutoff   71      13238.8079 25939.0752  95.9%   916  172s
  2707  2284 25132.5110    7  394 13238.8079 25929.1683  95.9%   881  176s
  2820  2390 24971.3436    8  378 13238.8079 25887.9690  95.5%   872  180s
  3144  2557 19406.2302   12  180 13238.8079 25887.9690  95.5%   853  187s
H 3146  2557                    13264.897603 25887.9690  95.2%   853  187s
  3179  2658 17304.0361   13  191 13264.8976 25887.9690  95.2%   856  192s
  3392  2762 18810.1678   13  152 13264.8976 25752.1799  94.1%   841  197s
  3597  2896 15427.1398   22  126 13264.8976 25752.1799  94.1%   836  202s
  3776  2897 20809.0829   23  440 13264.8976 25752.1799  94.1%   837  217s
  3778  2898 20072.6210   23  206 13264.8976 25752.1799  94.1%   837  230s
  3779  2899 16719.6397   37  323 13264.8976 25752.1799  94.1%   836  236s
  3780  2900 22910.7626   16  374 13264.8976 25752.1799  94.1%   836  240s
  3783  2902 19021.3930   12  319 13264.8976 25752.1799  94.1%   836  245s
  3789  2906 24854.5680    9  441 13264.8976 25752.1799  94.1%   834  251s
  3794  2909 20938.2505   14  400 13264.8976 25752.1799  94.1%   833  256s
  3797  2911 23269.9619   16  413 13264.8976 25752.1799  94.1%   832  260s
  3802  2914 13550.8304   18  429 13264.8976 25752.1799  94.1%   831  265s
  3806  2917 17009.0233   11  424 13264.8976 25752.1799  94.1%   830  270s
  3810  2920 18638.1691   17  471 13264.8976 25752.1799  94.1%   830  276s
  3811  2920 24226.7646   10  471 13264.8976 25752.1799  94.1%   829  290s
  3812  2921 17332.2065   29  471 13264.8976 25752.1799  94.1%   829  302s
  3813  2925 25752.1799   14  390 13264.8976 25752.1799  94.1%   847  306s
  3815  2928 25752.1799   15  386 13264.8976 25752.1799  94.1%   849  310s
  3819  2935 25752.1799   16  437 13264.8976 25752.1799  94.1%   850  315s
  3827  2948 25556.9333   17  443 13264.8976 25752.1799  94.1%   856  322s
  3843  2975 24477.1350   18  490 13264.8976 25555.1035  92.7%   871  327s
  3875  2988 19603.4041   19  326 13264.8976 24531.3079  84.9%   900  339s
  3899  3060 23167.1074   20  400 13264.8976 24530.9284  84.9%   960  349s
H 3929  2903                    13274.269580 24530.9284  84.8%   980  349s
H 3945  2759                    13287.005618 24530.9284  84.6%   986  349s
  3980  2812 21375.8773   23  284 13287.0056 24530.9284  84.6%   994  355s
  4055  2831 21221.7537   24  294 13287.0056 24530.9284  84.6%  1016  361s
  4134  2871 20669.8789   26  347 13287.0056 24530.9284  84.6%  1024  369s
  4221  2888 20434.9740   30  260 13287.0056 24530.9284  84.6%  1029  373s
  4306  2918 18306.7363   32  166 13287.0056 24530.9284  84.6%  1031  377s
  4398  2920 17865.7796   34  134 13287.0056 24064.3352  81.1%  1029  382s
  4471  2923 17908.6614   34  163 13287.0056 24064.3352  81.1%  1026  387s
  4549  2905 15741.7752   35  118 13287.0056 24064.3352  81.1%  1028  392s
  4623  2915 13572.6592   37  137 13287.0056 24064.3352  81.1%  1029  396s
  4682  2929     cutoff   36      13287.0056 23550.2446  77.2%  1033  400s
  4747  2941     cutoff   39      13287.0056 23252.1975  75.0%  1035  406s
  4827  2938 14121.7111   44   95 13287.0056 22898.0602  72.3%  1037  410s
  4875  2947     cutoff   46      13287.0056 22611.0915  70.2%  1039  416s
  4965  2940 17207.7499   20  202 13287.0056 22596.4445  70.1%  1040  420s
  5001  2950 15721.5928   21  168 13287.0056 22596.4445  70.1%  1043  425s
  5056  2954 14632.6635   23  148 13287.0056 22419.2262  68.7%  1043  430s
  5158  2951     cutoff   25      13287.0056 22385.5669  68.5%  1041  435s
  5267  2944     cutoff   26      13287.0056 22385.5669  68.5%  1043  440s
  5387  2938 19437.3788   22  399 13287.0056 22385.5669  68.5%  1041  446s
  5487  2941 19026.0539   24  345 13287.0056 22148.8219  66.7%  1045  452s
  5599  2913 infeasible   26      13287.0056 21825.4200  64.3%  1048  456s
  5647  2906 16925.6965   28  204 13287.0056 21825.4200  64.3%  1052  461s
  5709  2911 16784.4207   29  255 13287.0056 21653.8129  63.0%  1054  466s
  5755  2912     cutoff   29      13287.0056 21653.8129  63.0%  1059  473s
  5840  2897 16191.3694   31  180 13287.0056 21319.9312  60.5%  1057  479s
  5887  2881 16043.5515   32   87 13287.0056 21319.9312  60.5%  1059  484s
  5968  2866 15346.9831   33  121 13287.0056 21319.9312  60.5%  1059  490s
  6059  2850     cutoff   33      13287.0056 21319.9312  60.5%  1059  496s
  6189  2849 13982.3422   34  110 13287.0056 20842.6081  56.9%  1057  503s
  6314  2849 14484.0658   32  182 13287.0056 20842.6081  56.9%  1059  511s
  6494  2831 14935.9965   28  239 13287.0056 20449.2585  53.9%  1060  519s
  6697  2811 14250.7189   29   85 13287.0056 20316.1997  52.9%  1057  527s
  6904  2776 17656.7553   22  316 13287.0056 20163.3138  51.8%  1056  536s
  7114  2779 infeasible   24      13287.0056 20163.3138  51.8%  1053  544s
  7307  2764 15975.8218   25  331 13287.0056 19871.4722  49.6%  1055  553s
  7561  2771 15298.4700   30  283 13287.0056 19803.2155  49.0%  1053  560s
  7813  2724 13463.8243   34  258 13287.0056 19602.8443  47.5%  1049  568s
  8076  2728 16264.5659   27  357 13287.0056 19602.8443  47.5%  1047  577s
  8411  2672 16363.4024   25  327 13287.0056 19263.7716  45.0%  1041  584s
  8735  2561     cutoff   28      13287.0056 19260.8443  45.0%  1035  593s
  9105  2533 14969.3223   29  287 13287.0056 18768.6735  41.3%  1029  603s
  9446  2430     cutoff   30      13287.0056 18544.4028  39.6%  1027  613s
  9845  2278 15975.1956   31  234 13287.0056 18427.3647  38.7%  1020  626s
 10265  2100 16005.8026   23  171 13287.0056 18098.9759  36.2%  1014  638s
 10730  1876     cutoff   31      13287.0056 17895.1223  34.7%  1006  648s
 11169  1605 13966.4596   26  255 13287.0056 17580.7619  32.3%  1000  660s
 11647  1286 15504.3429   25  166 13287.0056 17236.6335  29.7%   994  670s
 12245  1138 14802.4084   35  249 13287.0056 16772.0326  26.2%   980  680s
 12833   788 13313.4118   25  286 13287.0056 16557.7105  24.6%   969  692s
 13636   225     cutoff   29      13287.0056 16048.3338  20.8%   945  705s
 16719   533     cutoff   59      13287.0056 13621.3439  2.52%   795  710s

Cutting planes:
  MIR: 331
  Flow cover: 884
  RLT: 6
  Relax-and-lift: 49

Explored 20273 nodes (13452529 simplex iterations) in 714.01 seconds (1328.69 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 13287 13274.3 13264.9 ... 12945.7

Optimal solution found (tolerance 1.00e-04)
Best objective 1.328700561775e+04, best bound 1.328700561775e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 714.02s
  Master Objective (UB) = 13287.01, θ = 147797.26
  Upper Bound (UB) = 13287.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147797.26
  [DEBUG]   ✓ Scenario 0: θ = 147797.26 ≤ Q = 147797.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 147797.26 ≤ Q = 147797.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 147797.26 ≤ Q = 147797.26 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1d9639ba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1d9639ba
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-15, 2e+02]
Found heuristic solution: objective 1.412061e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 7745806.0116
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.408205e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140820.45    0  132 7745806.01 -140820.45   102%     -    0s
H    0     0                    -102077.4788 -140820.45  38.0%     -    0s
H    0     0                    -104302.7462 -140820.45  35.0%     -    0s
H    0     0                    -112319.5459 -140820.45  25.4%     -    0s
H    0     0                    -112543.8963 -126854.99  12.7%     -    0s
     0     0 -126854.99    0   73 -112543.90 -126854.99  12.7%     -    0s
H    0     0                    -123869.5233 -126746.88  2.32%     -    0s
     0     0 -126257.72    0   74 -123869.52 -126257.72  1.93%     -    0s
     0     0 -126246.36    0   74 -123869.52 -126246.36  1.92%     -    0s
H    0     0                    -124333.4193 -126246.36  1.54%     -    0s
     0     0 -125658.22    0   52 -124333.42 -125658.22  1.07%     -    0s
H    0     0                    -124484.3298 -125577.71  0.88%     -    0s
     0     0 -125577.71    0   51 -124484.33 -125577.71  0.88%     -    0s
     0     0 -125577.71    0   51 -124484.33 -125577.71  0.88%     -    0s
     0     0 -125577.71    0   52 -124484.33 -125577.71  0.88%     -    0s
     0     0 -125136.45    0   25 -124484.33 -125136.45  0.52%     -    0s
     0     0 -125068.29    0   30 -124484.33 -125068.29  0.47%     -    0s
     0     0 -125065.44    0   31 -124484.33 -125065.44  0.47%     -    0s
     0     0 -124885.70    0   17 -124484.33 -124885.70  0.32%     -    0s
     0     0 -124879.52    0   18 -124484.33 -124879.52  0.32%     -    0s
     0     0 -124794.93    0   18 -124484.33 -124794.93  0.25%     -    0s
     0     0 -124740.31    0   22 -124484.33 -124740.31  0.21%     -    0s
     0     0 -124738.15    0   21 -124484.33 -124738.15  0.20%     -    0s
     0     0 -124708.78    0   15 -124484.33 -124708.78  0.18%     -    0s
     0     0 -124708.78    0   17 -124484.33 -124708.78  0.18%     -    0s
H    0     0                    -124595.1952 -124704.59  0.09%     -    0s
     0     0 -124704.42    0   11 -124595.20 -124704.42  0.09%     -    0s
     0     0 -124680.65    0    9 -124595.20 -124680.65  0.07%     -    0s
     0     0 -124680.65    0   14 -124595.20 -124680.65  0.07%     -    0s
     0     0 -124627.86    0    5 -124595.20 -124627.86  0.03%     -    0s
     0     0 -124626.39    0    5 -124595.20 -124626.39  0.03%     -    0s
H    0     0                    -124596.7077 -124626.39  0.02%     -    0s
H    0     0                    -124625.2166 -124626.39  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 7
  Flow cover: 6

Explored 1 nodes (784 simplex iterations) in 0.16 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -124625 -124597 -124595 ... -102077
No other solutions better than -124625

Optimal solution found (tolerance 1.00e-04)
Best objective -1.246252166310e+05, best bound -1.246252166310e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 129252.41
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124625.22
  [DEBUG]   S×d_nominal = 253877.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253877.63 + -124625.22 = 129252.41
  [DEBUG]   Current θ from Master = 147797.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18544.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5257.84
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3945.2181, Absolute Gap = 3945.2181, Relative Gap = 0.296923
  Not converged yet (gap = 3945.22 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0x2464025f
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -5257.84 (0.12s)
Loaded MIP start from previous solve with objective -5257.84

Presolve removed 25452 rows and 10332 columns
Presolve time: 0.95s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   46253    1.0539323e+04   0.000000e+00   9.323169e+06      5s
   57716    3.4068241e+04   0.000000e+00   1.586239e+06     10s
   66984    3.7877872e+04   0.000000e+00   1.214549e+06     15s
Concurrent spin time: 3.02s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.892112e+04, 36262 iterations, 17.83 seconds (24.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38921.1221    0  206 -5257.8375 38921.1221   840%     -   19s
H    0     0                    12387.904671 38921.1221   214%     -   19s
H    0     0                    12455.599577 38921.1221   212%     -   19s
     0     0 34350.3163    0  308 12455.5996 34350.3163   176%     -   26s
     0     0 33734.6553    0  300 12455.5996 33734.6553   171%     -   28s
     0     0 33734.3982    0  304 12455.5996 33734.3982   171%     -   29s
     0     0 33734.3982    0  306 12455.5996 33734.3982   171%     -   30s
     0     0 33734.3982    0  303 12455.5996 33734.3982   171%     -   30s
     0     0 33734.3982    0  301 12455.5996 33734.3982   171%     -   30s
     0     0 31365.1687    0  283 12455.5996 31365.1687   152%     -   37s
H    0     0                    12506.340083 31365.0975   151%     -   37s
H    0     0                    12590.558031 31365.0975   149%     -   37s
H    0     0                    12749.715862 31365.0975   146%     -   37s
H    0     0                    12757.034436 31365.0975   146%     -   37s
H    0     0                    12768.045096 31365.0975   146%     -   37s
H    0     0                    12768.570069 31365.0975   146%     -   37s
     0     0 30664.8414    0  352 12768.5701 30664.8414   140%     -   41s
     0     0 30546.6297    0  360 12768.5701 30546.6297   139%     -   44s
     0     0 30471.0057    0  320 12768.5701 30471.0057   139%     -   45s
     0     0 30449.2059    0  325 12768.5701 30449.2059   138%     -   45s
     0     0 30437.5420    0  323 12768.5701 30437.5420   138%     -   46s
     0     0 30425.3501    0  363 12768.5701 30425.3501   138%     -   47s
     0     0 30424.1268    0  360 12768.5701 30424.1268   138%     -   47s
     0     0 30423.1160    0  364 12768.5701 30423.1160   138%     -   48s
     0     0 30423.1095    0  364 12768.5701 30423.1095   138%     -   48s
     0     0 29228.2581    0  386 12768.5701 29228.2581   129%     -   57s
     0     0 28961.6995    0  410 12768.5701 28961.6995   127%     -   61s
     0     0 28875.7904    0  387 12768.5701 28875.7904   126%     -   63s
     0     0 28820.9474    0  352 12768.5701 28820.9474   126%     -   64s
     0     0 28797.0756    0  396 12768.5701 28797.0756   126%     -   65s
     0     0 28784.9527    0  361 12768.5701 28784.9527   125%     -   66s
     0     0 28781.2172    0  351 12768.5701 28781.2172   125%     -   66s
     0     0 28776.7164    0  398 12768.5701 28776.7164   125%     -   67s
     0     0 28776.5362    0  398 12768.5701 28776.5362   125%     -   67s
     0     0 28407.5562    0  363 12768.5701 28407.5562   122%     -   74s
     0     0 28260.8047    0  374 12768.5701 28260.8047   121%     -   77s
     0     0 28182.4923    0  386 12768.5701 28182.4923   121%     -   80s
     0     0 28152.0814    0  381 12768.5701 28152.0814   120%     -   80s
     0     0 28122.3213    0  391 12768.5701 28122.3213   120%     -   81s
     0     0 28102.2384    0  387 12768.5701 28102.2384   120%     -   82s
     0     0 28097.3875    0  384 12768.5701 28097.3875   120%     -   82s
     0     0 28095.8288    0  385 12768.5701 28095.8288   120%     -   83s
     0     0 28093.8130    0  388 12768.5701 28093.8130   120%     -   83s
     0     0 28093.1236    0  387 12768.5701 28093.1236   120%     -   83s
     0     0 28019.4453    0  437 12768.5701 28019.4453   119%     -   85s
     0     0 27980.7433    0  439 12768.5701 27980.7433   119%     -   87s
     0     0 27975.8465    0  440 12768.5701 27975.8465   119%     -   88s
     0     0 27972.2175    0  444 12768.5701 27972.2175   119%     -   88s
     0     0 27969.2483    0  437 12768.5701 27969.2483   119%     -   89s
     0     0 27968.7069    0  439 12768.5701 27968.7069   119%     -   89s
     0     0 27896.8250    0  386 12768.5701 27896.8250   118%     -   91s
H    0     0                    12782.290427 27869.4504   118%     -   93s
H    0     0                    12788.041701 27869.4504   118%     -   93s
H    0     0                    12795.114578 27869.4504   118%     -   93s
     0     0 27869.4504    0  440 12795.1146 27869.4504   118%     -   93s
     0     0 27840.5039    0  432 12795.1146 27840.5039   118%     -   94s
     0     0 27834.3629    0  441 12795.1146 27834.3629   118%     -   94s
     0     0 27833.4631    0  438 12795.1146 27833.4631   118%     -   94s
     0     0 27810.2944    0  411 12795.1146 27810.2944   117%     -   95s
     0     0 27806.1744    0  418 12795.1146 27806.1744   117%     -   97s
     0     0 27804.4570    0  421 12795.1146 27804.4570   117%     -   97s
     0     0 27803.6389    0  421 12795.1146 27803.6389   117%     -   97s
     0     0 27788.5518    0  418 12795.1146 27788.5518   117%     -   99s
     0     0 27783.6947    0  416 12795.1146 27783.6947   117%     -   99s
     0     0 27783.2580    0  413 12795.1146 27783.2580   117%     -   99s
     0     0 27777.8892    0  425 12795.1146 27777.8892   117%     -  100s
     0     0 27775.4686    0  413 12795.1146 27775.4686   117%     -  101s
     0     0 27774.9063    0  416 12795.1146 27774.9063   117%     -  101s
     0     0 27764.0909    0  460 12795.1146 27764.0909   117%     -  102s
     0     0 27762.0405    0  407 12795.1146 27762.0405   117%     -  103s
     0     0 27761.4579    0  452 12795.1146 27761.4579   117%     -  103s
     0     0 27755.2610    0  447 12795.1146 27755.2610   117%     -  104s
     0     0 27752.0565    0  447 12795.1146 27752.0565   117%     -  105s
     0     2 27750.3854    0  447 12795.1146 27750.3854   117%     -  120s
     3     8 27473.6443    2  490 12795.1146 27681.3920   116%  3632  127s
     7    16 27445.5272    3  478 12795.1146 27473.3149   115%  3773  135s
    15    32 27367.9340    4  485 12795.1146 27444.8308   114%  5029  140s
    31    48 26162.4712    5  381 12795.1146 27367.8125   114%  5338  152s
    47    80 24943.6125    6  386 12795.1146 27367.8125   114%  6375  160s
    79   144 24494.6789    7  366 12795.1146 27367.8125   114%  4724  174s
   143   273 24376.6560    9  350 12795.1146 27367.8125   114%  3699  180s
   369   394 24140.1464   11  396 12795.1146 27367.8125   114%  2181  194s
   403   437 23549.7457   10  288 12795.1146 27367.8125   114%  2117  199s
H  431   437                    12795.135559 27367.8125   114%  2046  199s
   454   466 23199.8503   12  309 12795.1356 27367.8125   114%  2033  203s
   487   502 24085.7038   12  333 12795.1356 27367.8125   114%  1972  206s
   525   537 23978.7890   13  385 12795.1356 27367.8125   114%  1926  216s
   607   608 23688.7451   15  370 12795.1356 27367.8125   114%  1808  223s
   645   647 23379.3998   18  361 12795.1356 27367.8125   114%  1776  228s
   686   689 23218.5517   17  375 12795.1356 27367.8125   114%  1771  232s
   730   733 23337.4500   19  355 12795.1356 27367.8125   114%  1739  235s
   825   813 22750.0948   21  279 12795.1356 27367.8125   114%  1646  242s
   870   868 22887.3084   21  306 12795.1356 27367.8125   114%  1599  246s
   935   928 22605.8852   23  227 12795.1356 27299.1203   113%  1542  250s
  1003   989 18426.0989   22  319 12795.1356 27299.1203   113%  1498  260s
  1112  1046 22367.6876   24  284 12795.1356 27299.1203   113%  1435  268s
  1185  1114 22085.2867   24  288 12795.1356 27299.1203   113%  1440  277s
  1287  1178 15348.7840   24  187 12795.1356 27299.1203   113%  1414  283s
  1377  1256 19641.0995   25  218 12795.1356 27299.1203   113%  1407  291s
  1489  1333 19599.0909   25  215 12795.1356 27299.1203   113%  1385  296s
  1608  1405 19496.5633   25  219 12795.1356 27299.1203   113%  1359  303s
  1726  1485 20690.8539   26  202 12795.1356 27299.1203   113%  1349  311s
  1857  1570 20291.9288   27  314 12795.1356 26707.7232   109%  1341  321s
  1974  1638 19612.9143   28  260 12795.1356 26707.7232   109%  1340  329s
  2076  1712 19281.5122   30  268 12795.1356 26707.7232   109%  1351  337s
  2173  1785 19218.8481   30  220 12795.1356 26707.7232   109%  1371  345s
  2276  1911 18863.4033   33  323 12795.1356 26707.7232   109%  1389  356s
  2436  2001 17611.5854   39  272 12795.1356 26707.7232   109%  1370  368s
H 2566  2001                    12812.701882 26707.7232   108%  1363  368s
  2577  2137 17498.7283   43  249 12812.7019 26707.7232   108%  1361  375s
  2732  2274 16376.3102   44  238 12812.7019 26707.7232   108%  1349  383s
  2919  2437 16788.6060   48  226 12812.7019 26707.7232   108%  1323  394s
  3134  2648 16677.9675   51  303 12812.7019 26707.7232   108%  1302  401s
  3382  2649 17633.2704   43  447 12812.7019 26707.7232   108%  1261  426s
  3384  2650 15408.3074   24  206 12812.7019 26707.7232   108%  1261  443s
  3385  2651 13786.1592   25  319 12812.7019 26707.7232   108%  1260  455s
  3386  2652 15710.1465   18  372 12812.7019 26707.7232   108%  1260  461s
  3387  2652 14932.1037   49  457 12812.7019 26707.7232   108%  1260  465s
  3389  2654 21965.7406   12  419 12812.7019 26707.7232   108%  1259  470s
  3391  2655 14203.3782   44  435 12812.7019 26707.7232   108%  1258  475s
  3395  2658 14175.9713   22  437 12812.7019 26707.7232   108%  1257  482s
  3400  2661 23465.9212   15  397 12812.7019 26707.7232   108%  1255  485s
  3403  2663 15186.1683   64  411 12812.7019 26707.7232   108%  1254  490s
  3407  2666 20276.0588   27  426 12812.7019 26707.7232   108%  1252  495s
  3410  2668 16078.3199   54  480 12812.7019 26707.7232   108%  1251  500s
  3414  2670 21011.6443   31  486 12812.7019 26707.7232   108%  1250  505s
  3416  2672 16340.7569   26  471 12812.7019 26707.7232   108%  1249  510s
  3420  2674 13285.2912   35  529 12812.7019 26707.7232   108%  1247  517s
  3422  2676 22471.7063   12  524 12812.7019 26707.7232   108%  1247  521s
  3423  2676 14137.8937   91  524 12812.7019 26707.7232   108%  1246  539s
  3424  2677 14709.6882   12  524 12812.7019 26707.7232   108%  1246  552s
  3425  2681 26707.7232   15  483 12812.7019 26707.7232   108%  1274  560s
  3427  2684 26707.7232   16  509 12812.7019 26707.7232   108%  1275  571s
  3431  2691 26658.3405   17  485 12812.7019 26707.7232   108%  1279  580s
  3439  2704 26280.7081   18  486 12812.7019 26656.9438   108%  1288  592s
  3455  2720 24526.0694   19  341 12812.7019 26279.7482   105%  1319  655s
  3476  2745 22984.2319   20  446 12812.7019 26279.7482   105%  1349  668s
  3508  2837 22882.8796   21  392 12812.7019 26279.7482   105%  1383  681s
  3613  2876 21560.1992   23  353 12812.7019 26279.7482   105%  1444  693s
  3689  2909 21481.8567   24  369 12812.7019 26279.7482   105%  1466  704s
  3761  2914 20964.1198   22  295 12812.7019 26279.7482   105%  1486  712s
  3794  2936 21116.6030   25  358 12812.7019 26279.7482   105%  1497  719s
  3831  2954 20874.0337   27  335 12812.7019 26279.7482   105%  1506  726s
  3873  2986 20414.7379   29  434 12812.7019 26279.7482   105%  1511  732s
  3926  3024 18573.4949   29  171 12812.7019 26279.7482   105%  1515  741s
  4003  3054 14991.3434   30  136 12812.7019 26279.7482   105%  1515  755s
  4076  3090 17115.0619   33  151 12812.7019 25922.4452   102%  1513  761s
  4154  3098 14219.0109   35  108 12812.7019 25909.2208   102%  1510  767s
  4226  3126 17486.7517   37  133 12812.7019 25909.2208   102%  1506  778s
  4306  3118 infeasible   39      12812.7019 25909.2208   102%  1506  785s
  4345  3128 17231.4566   37  148 12812.7019 25909.2208   102%  1514  795s
  4393  3140 15952.1829   39  315 12812.7019 25602.6497   100%  1521  803s
  4459  3157     cutoff   39      12812.7019 25602.6497   100%  1528  810s
  4542  3175 15140.1739   40  351 12812.7019 25264.1064  97.2%  1533  824s
  4631  3205 13669.6582   40   84 12812.7019 25264.1064  97.2%  1536  832s
  4731  3218 13661.8057   41   88 12812.7019 25044.8074  95.5%  1539  843s
  4829  3221 20278.5584   22  233 12812.7019 25044.8074  95.5%  1545  853s
  4932  3252 20057.7365   23  209 12812.7019 25044.8074  95.5%  1551  861s
  5032  3289 19630.1089   25  341 12812.7019 25044.8074  95.5%  1556  871s
  5146  3312 18881.9485   28  338 12812.7019 24810.6960  93.6%  1556  884s
  5275  3347 18398.6483   30  336 12812.7019 24810.6960  93.6%  1558  894s
  5414  3338 infeasible   33      12812.7019 24380.0816  90.3%  1558  904s
  5511  3366 17262.3135   36  277 12812.7019 24380.0816  90.3%  1555  915s
  5616  3405     cutoff   43      12812.7019 24004.1510  87.3%  1563  925s
  5731  3396 13623.7965   52  132 12812.7019 24004.1510  87.3%  1575  934s
  5769  3411 13527.0521   53  134 12812.7019 24004.1510  87.3%  1581  942s
  5807  3426 13200.6759   54  163 12812.7019 24004.1510  87.3%  1585  954s
  5845  3441 13125.0439   55  266 12812.7019 23842.9489  86.1%  1587  962s
  5886  3459 13117.6244   56  191 12812.7019 23542.0257  83.7%  1592  972s
  5930  3499 13040.8894   57  138 12812.7019 23542.0257  83.7%  1594  985s
H 5953  3356                    12812.859338 23542.0257  83.7%  1592  985s
H 6023  3205                    12901.061391 23542.0257  82.5%  1589  985s
  6025  3318 21663.1306   21  248 12901.0614 23542.0257  82.5%  1589  999s
  6223  3365     cutoff   25      12901.0614 23329.0338  80.8%  1586 1013s
  6440  3410 16168.3405   28   98 12901.0614 23107.8796  79.1%  1577 1027s
  6658  3398 21127.0568   25  368 12901.0614 23107.8796  79.1%  1574 1042s
  6811  3462 19816.8489   27  254 12901.0614 23107.8796  79.1%  1574 1056s
  7033  3466     cutoff   32      12901.0614 23107.8796  79.1%  1568 1071s
  7290  3476 15837.9383   42  241 12901.0614 23086.0559  78.9%  1558 1090s
  7494  3513 14440.6132   23  230 12901.0614 23086.0559  78.9%  1569 1109s
  7726  3588 21425.7724   22  213 12901.0614 22714.3631  76.1%  1574 1127s
  7983  3599 16908.2361   28  177 12901.0614 22521.7726  74.6%  1580 1143s
  8276  3620 16335.4921   31  135 12901.0614 22521.7726  74.6%  1567 1159s
H 8313  3486                    12922.291248 22521.7726  74.3%  1565 1159s
  8624  3499 13325.2604   23  236 12922.2912 22442.6871  73.7%  1558 1178s
  8903  3520 infeasible   24      12922.2912 22132.7074  71.3%  1567 1196s
  9176  3526 17646.8220   26  454 12922.2912 21971.4089  70.0%  1580 1216s
  9513  3563 17246.5293   29  412 12922.2912 21971.4089  70.0%  1578 1237s
  9857  3575 14642.8609   35  164 12922.2912 21971.4089  70.0%  1566 1258s
 10262  3625 15721.2450   24  357 12922.2912 21971.4089  70.0%  1563 1279s
 10656  3692     cutoff   30      12922.2912 21614.8661  67.3%  1565 1303s
 11036  3781 16253.9172   27  409 12922.2912 21334.3236  65.1%  1571 1326s
 11426  3889 14812.8853   36  272 12922.2912 21237.1926  64.3%  1571 1349s
 11875  4032 14010.8751   33  211 12922.2912 21069.0528  63.0%  1571 1375s
 12329  4131     cutoff   34      12922.2912 20980.0557  62.4%  1573 1401s
 12803  4309 13559.3041   29  360 12922.2912 20963.3227  62.2%  1576 1426s
 13261  4525 14807.2325   30  341 12922.2912 20695.4740  60.2%  1581 1453s
 13792  4723 17014.5634   28  302 12922.2912 20574.1694  59.2%  1578 1483s
 14377  4905 17795.4840   23  327 12922.2912 20337.9081  57.4%  1573 1511s
 14915  5030 14726.6008   29  333 12922.2912 20267.7272  56.8%  1574 1548s
 15432  5176 17672.6476   26  498 12922.2912 20126.5220  55.8%  1576 1580s
 16081  5386     cutoff   29      12922.2912 20014.9744  54.9%  1573 1612s
 16760  5668 16648.6339   27  327 12922.2912 19715.1217  52.6%  1569 1645s
 17563  5835 15554.6913   30  390 12922.2912 19568.1150  51.4%  1556 1684s
 18297  5942 13964.2926   31  228 12922.2912 19428.0099  50.3%  1552 1720s
 18915  6024 13223.4770   31  345 12922.2912 19261.1933  49.1%  1561 1761s
 19588  6205 14245.2093   24  463 12922.2912 19107.9430  47.9%  1566 1799s
 20385  6378 13013.0250   27  259 12922.2912 18934.5747  46.5%  1564 1840s
 21271  6543     cutoff   27      12922.2912 18833.3426  45.7%  1557 1880s
 22154  6687 13689.4774   36  267 12922.2912 18669.8933  44.5%  1553 1924s
 23120  6693 13178.0458   35  261 12922.2912 18546.7332  43.5%  1545 1961s
 23238  6843 13842.3693   35  284 12922.2912 18494.8106  43.1%  1546 2002s
 23912  6989 15243.8666   34  323 12922.2912 18389.6709  42.3%  1542 2045s
 24901  7106 16291.9707   31  259 12922.2912 18247.4284  41.2%  1536 2094s
 25944  7181 15613.4808   23  408 12922.2912 18115.1441  40.2%  1533 2141s
 27139  7302 13252.2430   32  305 12922.2912 17978.6996  39.1%  1523 2194s
*28341  7297              45    12937.381736 17808.3209  37.7%  1516 2194s
 28369  7427 15874.1785   30  149 12937.3817 17808.3209  37.7%  1516 2243s
H28496  7280                    13209.790576 17808.3209  34.8%  1515 2243s
 29629  7243 14178.6823   33  113 13209.7906 17580.4928  33.1%  1505 2302s
 31071  7207 14632.0740   31  250 13209.7906 17386.8007  31.6%  1497 2347s
 32248  7125 infeasible   29      13209.7906 17165.4133  29.9%  1490 2396s
 33641  6965     cutoff   39      13209.7906 16983.2881  28.6%  1475 2444s
 34867  6763 13371.1521   32  131 13209.7906 16851.5305  27.6%  1467 2494s
 36232  6342 14294.8842   45  148 13209.7906 16647.6401  26.0%  1455 2546s
 37841  5911     cutoff   37      13209.7906 16377.5135  24.0%  1439 2597s
 39577  5291 14261.3591   34  246 13209.7906 16105.5831  21.9%  1420 2648s
 41415  4490     cutoff   40      13209.7906 15827.0661  19.8%  1401 2700s
 43507  3427     cutoff   35      13209.7906 15613.7648  18.2%  1376 2753s
 45842  1730 infeasible   41      13209.7906 15113.6304  14.4%  1346 2800s
 48749   410     cutoff   30      13209.7906 14610.9911  10.6%  1298 2833s
*52723   410              79    13220.357636 14498.2989  9.67%  1211 2833s
*52724   410              78    13221.534084 14498.2989  9.66%  1211 2833s
 53941     0     cutoff   60      13221.5341 13377.9792  1.18%  1188 2837s
H53974     0                    13236.473757 13377.9792  1.07%  1187 2837s

Cutting planes:
  Learned: 1
  MIR: 722
  Mixing: 2
  Flow cover: 1772
  RLT: 13
  Relax-and-lift: 75

Explored 55492 nodes (64281458 simplex iterations) in 2838.32 seconds (5934.69 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 13236.5 13221.5 13220.4 ... 12795.1

Optimal solution found (tolerance 1.00e-04)
Best objective 1.323647375682e+04, best bound 1.323647375682e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2838.36s
  Master Objective (UB) = 13236.47, θ = 153330.94
  Upper Bound (UB) = 13236.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153330.94
  [DEBUG]   ✓ Scenario 0: θ = 153330.94 ≤ Q = 153330.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153330.94 ≤ Q = 153330.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153330.94 ≤ Q = 153333.06 (slack: 2.12)
  [DEBUG]   ✓ Scenario 3: θ = 153330.94 ≤ Q = 153330.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x56f2ae09
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x56f2ae09
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461673e+13
Presolve removed 2566 rows and 1858 columns
Presolve time: 0.01s
Presolved: 527 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 7998287.6430
Variable types: 358 continuous, 173 integer (173 binary)
Found heuristic solution: objective 7997915.7096

Root relaxation: objective -1.496574e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149657.44    0  128 7997915.71 -149657.44   102%     -    0s
H    0     0                    -121452.2417 -149657.44  23.2%     -    0s
H    0     0                    -125947.0664 -136433.61  8.33%     -    0s
     0     0 -136433.61    0   94 -125947.07 -136433.61  8.33%     -    0s
H    0     0                    -132410.0519 -136317.23  2.95%     -    0s
     0     0 -136063.75    0   93 -132410.05 -136063.75  2.76%     -    0s
H    0     0                    -133414.2316 -136063.75  1.99%     -    0s
     0     0 -135276.30    0   93 -133414.23 -135276.30  1.40%     -    0s
     0     0 -135229.72    0   96 -133414.23 -135229.72  1.36%     -    0s
     0     0 -135218.92    0   96 -133414.23 -135218.92  1.35%     -    0s
     0     0 -135218.92    0   95 -133414.23 -135218.92  1.35%     -    0s
H    0     0                    -133545.1923 -134851.18  0.98%     -    0s
     0     0 -134851.18    0   62 -133545.19 -134851.18  0.98%     -    0s
     0     0 -134772.63    0   56 -133545.19 -134772.63  0.92%     -    0s
     0     0 -134772.52    0   56 -133545.19 -134772.52  0.92%     -    0s
     0     0 -134451.83    0   52 -133545.19 -134451.83  0.68%     -    0s
     0     0 -134376.65    0   53 -133545.19 -134376.65  0.62%     -    0s
     0     0 -134095.40    0   28 -133545.19 -134095.40  0.41%     -    0s
     0     0 -134086.98    0   28 -133545.19 -134086.98  0.41%     -    0s
     0     0 -133931.05    0   16 -133545.19 -133931.05  0.29%     -    0s
H    0     0                    -133584.9945 -133930.74  0.26%     -    0s
     0     0 -133890.83    0   13 -133584.99 -133890.83  0.23%     -    0s
     0     0 -133886.29    0   17 -133584.99 -133886.29  0.23%     -    0s
     0     0 -133784.80    0   16 -133584.99 -133784.80  0.15%     -    0s
     0     0 -133784.80    0   52 -133584.99 -133784.80  0.15%     -    0s
     0     0 -133784.80    0   49 -133584.99 -133784.80  0.15%     -    0s
     0     0 -133784.80    0   49 -133584.99 -133784.80  0.15%     -    0s
H    0     0                    -133621.1030 -133784.80  0.12%     -    0s
     0     0 -133658.53    0   13 -133621.10 -133658.53  0.03%     -    0s
     0     0 -133654.73    0    8 -133621.10 -133654.73  0.03%     -    0s
H    0     0                    -133624.8477 -133650.73  0.02%     -    0s
     0     0 -133650.24    0    8 -133624.85 -133650.24  0.02%     -    0s
     0     0 -133639.28    0    5 -133624.85 -133639.28  0.01%     -    0s
H    0     0                    -133637.5553 -133639.28  0.00%     -    0s

Explored 1 nodes (977 simplex iterations) in 0.20 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -133638 -133625 -133621 ... 7.99792e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.336375552715e+05, best bound -1.336392777827e+05, gap 0.0013%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 131790.31
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133637.56
  [DEBUG]   S×d_nominal = 265427.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 265427.87 + -133637.56 = 131790.31
  [DEBUG]   Current θ from Master = 153330.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21540.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8304.15
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3894.6862, Absolute Gap = 3894.6862, Relative Gap = 0.294239
  Not converged yet (gap = 3894.69 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0x5377eee3
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 1.52s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25651   -1.3425096e+04   0.000000e+00   7.607938e+06      5s
   38435    2.0548165e+04   0.000000e+00   4.976364e+06     10s
   46834    3.0702581e+04   0.000000e+00   3.154882e+08     15s
Concurrent spin time: 1.25s

Solved with dual simplex

Root relaxation: objective 3.850034e+04, 27424 iterations, 14.57 seconds (18.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38500.3441    0  206 -219144.29 38500.3441   118%     -   17s
H    0     0                    -212888.7365 38500.3441   118%     -   17s
H    0     0                    -186780.9921 38500.3441   121%     -   17s
H    0     0                    -185064.8491 38500.3441   121%     -   17s
H    0     0                    -182106.1955 38500.3441   121%     -   17s
H    0     0                    -181996.7629 38500.3441   121%     -   17s
H    0     0                    -181792.8949 38500.3441   121%     -   17s
H    0     0                    -66934.47220 38500.3441   158%     -   17s
H    0     0                    -66832.30996 38500.3441   158%     -   17s
H    0     0                    -41673.58287 38500.3441   192%     -   17s
H    0     0                    -25152.22157 38500.3441   253%     -   18s
H    0     0                    -16932.28854 38500.3441   327%     -   18s
H    0     0                    -15301.98221 38500.3441   352%     -   18s
H    0     0                    -12873.05935 38500.3441   399%     -   19s
H    0     0                    -7349.972853 38500.3441   624%     -   19s
     0     0 34196.2660    0  306 -7349.9729 34196.2660   565%     -   27s
H    0     0                    -4010.805025 34196.1147   953%     -   27s
H    0     0                    -4009.165108 34196.1147   953%     -   28s
H    0     0                    -3434.675007 34196.1147  1096%     -   28s
H    0     0                    -3410.685514 34196.1147  1103%     -   28s
H    0     0                    -3406.511639 34196.1147  1104%     -   28s
H    0     0                    -2818.349355 33914.1242  1303%     -   30s
H    0     0                    -2164.843559 33914.1242  1667%     -   30s
     0     0 33914.1242    0  129 -2164.8436 33914.1242  1667%     -   30s
     0     0 33608.7827    0  297 -2164.8436 33608.7827  1652%     -   33s
     0     0 33435.0151    0  299 -2164.8436 33435.0151  1644%     -   36s
     0     0 33435.0151    0  305 -2164.8436 33435.0151  1644%     -   37s
     0     0 33435.0151    0  309 -2164.8436 33435.0151  1644%     -   37s
     0     0 33434.9405    0  309 -2164.8436 33434.9405  1644%     -   37s
H    0     0                    7401.7599230 31052.8736   320%     -   46s
H    0     0                    7818.4710870 31052.8736   297%     -   46s
H    0     0                    7955.3381478 31052.8736   290%     -   46s
H    0     0                    8215.5362560 31052.8736   278%     -   46s
H    0     0                    9101.9349220 31052.8736   241%     -   46s
H    0     0                    9108.6530695 31052.8736   241%     -   46s
H    0     0                    9201.7561575 31052.8736   237%     -   46s
H    0     0                    9236.6628528 31052.8736   236%     -   46s
     0     0 31052.8736    0  263 9236.66285 31052.8736   236%     -   46s
     0     0 30472.0571    0  282 9236.66285 30472.0571   230%     -   51s
     0     0 30352.7852    0  284 9236.66285 30352.7852   229%     -   54s
     0     0 30325.2068    0  290 9236.66285 30325.2068   228%     -   56s
     0     0 30325.0878    0  288 9236.66285 30325.0878   228%     -   56s
     0     0 29171.8928    0  259 9236.66285 29171.8928   216%     -   69s
H    0     0                    9266.9520066 29171.6931   215%     -   70s
     0     0 28820.4281    0  326 9266.95201 28820.4281   211%     -   75s
     0     0 28716.7290    0  281 9266.95201 28716.7290   210%     -   78s
     0     0 28684.4763    0  346 9266.95201 28684.4763   210%     -   79s
     0     0 28649.9841    0  340 9266.95201 28649.9841   209%     -   80s
     0     0 28619.0327    0  295 9266.95201 28619.0327   209%     -   81s
H    0     0                    9334.4999919 28575.6390   206%     -   83s
H    0     0                    9343.6012094 28575.6390   206%     -   83s
H    0     0                    9372.5522078 28575.6390   205%     -   83s
     0     0 28575.6390    0  336 9372.55221 28575.6390   205%     -   83s
     0     0 28567.0872    0  345 9372.55221 28567.0872   205%     -   83s
     0     0 28553.1674    0  345 9372.55221 28553.1674   205%     -   84s
     0     0 28549.5533    0  344 9372.55221 28549.5533   205%     -   85s
     0     0 28548.8204    0  337 9372.55221 28548.8204   205%     -   85s
     0     0 28016.7361    0  353 9372.55221 28016.7361   199%     -   98s
H    0     0                    9381.8827962 28016.4795   199%     -   99s
     0     0 27723.9281    0  362 9381.88280 27723.9281   196%     -  103s
     0     0 27670.4394    0  367 9381.88280 27670.4394   195%     -  105s
     0     0 27643.7857    0  368 9381.88280 27643.7857   195%     -  106s
     0     0 27612.6899    0  364 9381.88280 27612.6899   194%     -  107s
     0     0 27595.1879    0  365 9381.88280 27595.1879   194%     -  107s
     0     0 27583.4810    0  373 9381.88280 27583.4810   194%     -  108s
     0     0 27579.1801    0  370 9381.88280 27579.1801   194%     -  108s
     0     0 27569.0006    0  374 9381.88280 27569.0006   194%     -  109s
     0     0 27567.4686    0  379 9381.88280 27567.4686   194%     -  109s
     0     0 27567.3649    0  375 9381.88280 27567.3649   194%     -  109s
     0     0 27440.0574    0  376 9381.88280 27440.0574   192%     -  114s
H    0     0                    9416.0994587 27439.3000   191%     -  114s
     0     0 27421.7185    0  327 9416.09946 27421.7185   191%     -  116s
     0     0 27418.2205    0  369 9416.09946 27418.2205   191%     -  116s
     0     0 27413.0698    0  383 9416.09946 27413.0698   191%     -  117s
     0     0 27409.8847    0  378 9416.09946 27409.8847   191%     -  117s
     0     0 27408.7459    0  394 9416.09946 27408.7459   191%     -  117s
     0     0 27356.1261    0  386 9416.09946 27356.1261   191%     -  120s
     0     0 27298.4401    0  369 9416.09946 27298.4401   190%     -  124s
     0     0 27286.3572    0  433 9416.09946 27286.3572   190%     -  124s
     0     0 27279.9895    0  371 9416.09946 27279.9895   190%     -  125s
     0     0 27277.0854    0  434 9416.09946 27277.0854   190%     -  126s
     0     0 27274.1201    0  441 9416.09946 27274.1201   190%     -  126s
     0     0 27273.9432    0  440 9416.09946 27273.9432   190%     -  126s
     0     0 27243.0795    0  434 9416.09946 27243.0795   189%     -  129s
     0     0 27226.0745    0  387 9416.09946 27226.0745   189%     -  130s
     0     0 27219.3141    0  417 9416.09946 27219.3141   189%     -  131s
     0     0 27215.9854    0  436 9416.09946 27215.9854   189%     -  132s
     0     0 27214.3251    0  447 9416.09946 27214.3251   189%     -  132s
     0     0 27213.2626    0  411 9416.09946 27213.2626   189%     -  132s
     0     0 27194.4693    0  357 9416.09946 27194.4693   189%     -  134s
     0     0 27182.3198    0  459 9416.09946 27182.3198   189%     -  136s
     0     0 27177.1949    0  357 9416.09946 27177.1949   189%     -  137s
     0     0 27175.3005    0  450 9416.09946 27175.3005   189%     -  137s
     0     0 27173.3065    0  355 9416.09946 27173.3065   189%     -  138s
     0     0 27172.7269    0  462 9416.09946 27172.7269   189%     -  138s
     0     0 27158.0221    0  395 9416.09946 27158.0221   188%     -  140s
     0     0 27147.6787    0  480 9416.09946 27147.6787   188%     -  141s
     0     0 27145.2591    0  489 9416.09946 27145.2591   188%     -  141s
     0     0 27143.2211    0  490 9416.09946 27143.2211   188%     -  141s
     0     0 27142.0441    0  489 9416.09946 27142.0441   188%     -  142s
     0     0 27130.9282    0  425 9416.09946 27130.9282   188%     -  144s
     0     0 27125.9860    0  463 9416.09946 27125.9860   188%     -  146s
     0     0 27123.8191    0  420 9416.09946 27123.8191   188%     -  147s
     0     0 27123.2888    0  465 9416.09946 27123.2888   188%     -  147s
     0     0 27114.3006    0  463 9416.09946 27114.3006   188%     -  149s
     0     0 27113.5163    0  466 9416.09946 27113.5163   188%     -  149s
     0     0 27111.1385    0  416 9416.09946 27111.1385   188%     -  151s
     0     0 27110.1221    0  407 9416.09946 27110.1221   188%     -  151s
     0     0 27105.3287    0  461 9416.09946 27105.3287   188%     -  153s
     0     0 27104.3201    0  465 9416.09946 27104.3201   188%     -  154s
     0     0 27102.1211    0  482 9416.09946 27102.1211   188%     -  155s
     0     0 27101.6476    0  465 9416.09946 27101.6476   188%     -  156s
     0     0 27100.5808    0  413 9416.09946 27100.5808   188%     -  157s
     0     0 27098.6424    0  413 9416.09946 27098.6424   188%     -  158s
     0     2 27098.6424    0  413 9416.09946 27098.6424   188%     -  178s
     1     4 27043.6424    1  360 9416.09946 27098.6424   188%  1179  180s
     3     8 26693.5586    2  480 9416.09946 27042.9700   187%  2652  185s
     7    16 26524.8385    3  482 9416.09946 26909.2430   186%  3523  192s
    15    32 26209.8703    4  483 9416.09946 26630.6409   183%  4086  202s
    31    48 25825.4370    5  401 9416.09946 26375.2011   180%  6768  217s
    47    80 24688.5483    6  429 9416.09946 26375.2011   180%  6128  229s
H   61    80                    9438.1134441 26375.2011   179%  5914  229s
    79   143 24558.7555    7  362 9438.11344 26375.2011   179%  5018  252s
H  107   143                    9796.1082434 26375.2011   169%  4093  252s
   142   285 24274.5368    9  362 9796.10824 26375.2011   169%  3498  263s
H  146   285                    9865.2216086 26375.2011   167%  3448  263s
H  168   285                    9922.7625884 26375.2011   166%  3287  263s
H  203   285                    9960.6670544 26375.2011   165%  2919  263s
   284   385 24239.6482   10  340 9960.66705 26375.2011   165%  2498  269s
   384   463 23355.3638   12  336 9960.66705 26375.2011   165%  2196  278s
   464   540 23503.2621   11  328 9960.66705 26375.2011   165%  2135  286s
   543   572 18996.8853   12  340 9960.66705 26375.2011   165%  2062  294s
   575   610 19346.3097   13  305 9960.66705 26375.2011   165%  2035  302s
H  597   610                    9976.9428171 26375.2011   164%  1991  302s
H  617   610                    9994.9556005 26375.2011   164%  1972  302s
   621   631 23206.6913   13  324 9994.95560 26375.2011   164%  1966  312s
H  636   631                    10008.664469 26375.2011   164%  1946  312s
   660   691 23692.1958   13  288 10008.6645 26375.2011   164%  1924  323s
   741   720 22806.4775   13  333 10008.6645 26375.2011   164%  1878  330s
H  766   720                    11451.741405 26375.2011   130%  1882  330s
   774   754 18482.8512   13  349 11451.7414 26375.2011   130%  1885  340s
   856   783 23482.8380   14  292 11451.7414 26375.2011   130%  1840  350s
H  864   783                    11801.455361 26375.2011   123%  1840  350s
H  865   783                    12165.307210 26375.2011   117%  1838  350s
   889   828 22621.8704   15  367 12165.3072 26375.2011   117%  1864  361s
   960   854 22447.7368   16  379 12165.3072 26375.2011   117%  1857  370s
H  965   854                    12195.936478 26375.2011   116%  1863  370s
H  974   854                    12469.618796 26375.2011   112%  1854  370s
H  979   854                    12600.273051 26375.2011   109%  1852  370s
  1000   914 22027.7028   17  384 12600.2731 26375.2011   109%  1856  380s
  1099   957 21273.5136   18  371 12600.2731 26375.2011   109%  1832  390s
  1180  1032 19796.5189   17  345 12600.2731 26375.2011   109%  1845  399s
  1289  1112 19649.9628   19  391 12600.2731 26375.2011   109%  1805  409s
  1391  1204 14785.8734   18  274 12600.2731 26270.8680   108%  1800  418s
  1500  1284 19159.5228   19  225 12600.2731 26269.1543   108%  1783  427s
  1627  1358 19583.0308   20  329 12600.2731 26269.1543   108%  1744  440s
  1753  1408 17496.8933   21  322 12600.2731 26269.1543   108%  1730  452s
  1859  1491 18250.1668   22  325 12600.2731 26269.1543   108%  1732  465s
  1973  1567 17595.8600   23  316 12600.2731 25777.3317   105%  1739  474s
  2077  1634 16099.7958   25  247 12600.2731 25777.3317   105%  1757  488s
H 2089  1634                    12609.450739 25777.3317   104%  1761  488s
  2196  1728 17414.8763   24  318 12609.4507 25777.3317   104%  1751  499s
  2334  1792 15127.0517   24  370 12609.4507 25476.7704   102%  1753  511s
H 2338  1792                    12788.157893 25476.7704  99.2%  1755  511s
H 2347  1792                    12913.333960 25476.7704  97.3%  1751  511s
H 2370  1792                    13091.663232 25476.7704  94.6%  1748  511s
H 2412  1792                    13195.174372 25460.5854  93.0%  1747  511s
  2416  1845 14732.0585   25  231 13195.1744 25460.5854  93.0%  1747  525s
  2581  1921 15071.7773   27  130 13195.1744 25460.5854  93.0%  1727  538s
  2744  2010 14815.0183   28  121 13195.1744 25416.7202  92.6%  1719  549s
H 2899  2073                    13200.459988 25406.6919  92.5%  1722  562s
H 2899  2073                    13204.504960 25406.6919  92.4%  1722  562s
H 2912  2073                    13209.790576 25406.6919  92.3%  1728  563s
  2993  2220     cutoff   35      13209.7906 25370.6162  92.1%  1728  578s
  3184  2323     cutoff   51      13209.7906 25370.6162  92.1%  1715  592s
  3353  2352 23934.7107    9  414 13209.7906 25312.3676  91.6%  1720  602s
  3388  2424 23035.7135   10  307 13209.7906 25312.3676  91.6%  1727  614s
  3474  2526 21934.5288   11  285 13209.7906 25312.3676  91.6%  1723  631s
  3619  2527 23633.8963    9  413 13209.7906 25312.3676  91.6%  1705  667s
  3621  2528 19805.9649   27  206 13209.7906 25312.3676  91.6%  1704  688s
  3622  2529 14627.3189   24  402 13209.7906 25312.3676  91.6%  1704  705s
  3623  2530 21154.0829   15  389 13209.7906 25312.3676  91.6%  1703  715s
  3624  2530 24367.1660    8  363 13209.7906 25312.3676  91.6%  1703  722s
  3625  2531 18577.7467   22  396 13209.7906 25312.3676  91.6%  1702  728s
  3626  2532 22436.9621   17  437 13209.7906 25312.3676  91.6%  1702  732s
  3628  2533 22839.3468   16  414 13209.7906 25312.3676  91.6%  1701  735s
  3633  2536 17639.5022   16  469 13209.7906 25312.3676  91.6%  1699  741s
  3634  2537 13978.2674   52  422 13209.7906 25312.3676  91.6%  1698  747s
  3637  2539 14319.1098   52  477 13209.7906 25312.3676  91.6%  1697  756s
  3639  2540 20079.3392   17  508 13209.7906 25312.3676  91.6%  1696  760s
  3642  2542 23863.1998   12  483 13209.7906 25312.3676  91.6%  1695  766s
  3643  2543 18057.9130   25  419 13209.7906 25312.3676  91.6%  1694  771s
  3645  2544 14362.5253   30  484 13209.7906 25312.3676  91.6%  1693  778s
  3647  2546 23691.3998   14  482 13209.7906 25312.3676  91.6%  1692  784s
  3648  2546 24462.3996   10  512 13209.7906 25312.3676  91.6%  1692  785s
  3650  2548 24172.9879    7  515 13209.7906 25312.3676  91.6%  1691  791s
  3652  2549 13766.8217   30  474 13209.7906 25312.3676  91.6%  1690  796s
  3653  2550 21250.1095   21  474 13209.7906 25312.3676  91.6%  1689  817s
  3654  2550 16346.7194   23  474 13209.7906 25312.3676  91.6%  1689  840s
  3655  2554 25312.3676   13  501 13209.7906 25312.3676  91.6%  1719  853s
  3657  2557 25312.3676   14  504 13209.7906 25312.3676  91.6%  1720  866s
  3661  2564 25312.3676   15  491 13209.7906 25312.3676  91.6%  1723  875s
  3669  2577 25312.3676   16  504 13209.7906 25312.3676  91.6%  1733  890s
  3685  2588 23875.5737   17  438 13209.7906 25312.3676  91.6%  1759  914s
  3701  2615 23750.9987   18  334 13209.7906 25312.3676  91.6%  1782  935s
  3733  2636 22425.6018   19  446 13209.7906 25312.3676  91.6%  1803  950s
  3765  2665 21704.3726   20  398 13209.7906 25312.3676  91.6%  1848  967s
  3805  2747 21578.6086   20  320 13209.7906 25312.3676  91.6%  1876  985s
  3910  2796 20995.4073   21  264 13209.7906 25312.3676  91.6%  1887  998s
  4026  2810 17108.3096   21  309 13209.7906 25312.3676  91.6%  1886 1010s
  4122  2834 19318.0032   22  347 13209.7906 25312.3676  91.6%  1888 1023s
  4200  2867 19822.7224   22  264 13209.7906 25312.3676  91.6%  1892 1037s
  4296  2872 20297.5264   23  270 13209.7906 25312.3676  91.6%  1884 1049s
  4366  2888 19225.8155   23  266 13209.7906 25312.3676  91.6%  1888 1062s
  4453  2880 17480.1999   24  267 13209.7906 25312.3676  91.6%  1881 1074s
  4527  2896 17218.1852   25  283 13209.7906 25312.3676  91.6%  1874 1087s
  4611  2899 17176.3626   26  265 13209.7906 25312.3676  91.6%  1875 1100s
  4683  2894 15743.0521   28  216 13209.7906 25312.3676  91.6%  1875 1112s
  4759  2903 15411.8085   27  218 13209.7906 25312.3676  91.6%  1879 1123s
  4846  2907 19556.5541   22  381 13209.7906 25312.3676  91.6%  1882 1137s
  4937  2904 19427.6901   23  380 13209.7906 25312.3676  91.6%  1890 1147s
  4972  2924 19266.9760   24  415 13209.7906 24798.1975  87.7%  1904 1158s
  5021  2932 19016.9321   25  328 13209.7906 24798.1975  87.7%  1915 1167s
  5059  2946 18718.1480   26  252 13209.7906 24798.1975  87.7%  1920 1179s
  5112  2945 18034.1408   27  290 13209.7906 24798.1975  87.7%  1922 1190s
  5177  2958 16634.7823   28  305 13209.7906 24798.1975  87.7%  1927 1203s
  5261  2978 15736.4151   29  199 13209.7906 24798.1975  87.7%  1930 1218s
  5341  3018 15444.4532   30  193 13209.7906 23912.0499  81.0%  1934 1235s
  5467  3040 15104.3220   33  205 13209.7906 23912.0499  81.0%  1937 1253s
  5577  3042 infeasible   38      13209.7906 23912.0499  81.0%  1943 1271s
  5710  3049 20845.3406   20  347 13209.7906 23637.0333  78.9%  1945 1288s
  5826  3082 20251.8719   22  370 13209.7906 23296.3038  76.4%  1963 1306s
  5940  3126 18852.5907   26  314 13209.7906 23296.3038  76.4%  1976 1324s
  6085  3157 17768.8487   31  140 13209.7906 23296.3038  76.4%  1979 1341s
  6247  3170     cutoff   37      13209.7906 23296.3038  76.4%  1978 1361s
  6456  3142 13563.5446   45  109 13209.7906 23240.9026  75.9%  1966 1380s
  6600  3160 15591.3390   22  421 13209.7906 23240.9026  75.9%  1980 1400s
  6755  3196 15399.5830   23  353 13209.7906 21930.0323  66.0%  1989 1420s
  6942  3217     cutoff   24      13209.7906 21930.0323  66.0%  1991 1443s
  7131  3205 13680.5069   25  390 13209.7906 21883.9429  65.7%  1996 1465s
  7290  3234 13550.0960   27  334 13209.7906 21869.5289  65.6%  2000 1486s
  7497  3228 14220.8179   24  287 13209.7906 21869.5289  65.6%  2007 1510s
  7732  3233 15581.2381   25  328 13209.7906 21742.7668  64.6%  2009 1536s
  7948  3223     cutoff   28      13209.7906 21606.8393  63.6%  2020 1560s
  8188  3278 18815.3835   21  452 13209.7906 21258.4125  60.9%  2026 1587s
  8449  3298 16387.4206   28  228 13209.7906 21160.4332  60.2%  2029 1613s
  8722  3366 13988.8131   35  182 13209.7906 21049.7388  59.3%  2022 1639s
  9008  3422 13687.7851   30  106 13209.7906 21004.1600  59.0%  2024 1668s
  9353  3409 18263.2808   22  299 13209.7906 21004.1600  59.0%  2018 1696s
  9672  3431 16542.4090   26  247 13209.7906 20953.1835  58.6%  2022 1725s
 10008  3439 16918.5750   23  409 13209.7906 20575.6767  55.8%  2025 1757s
 10381  3405     cutoff   25      13209.7906 20450.8503  54.8%  2020 1787s
 10721  3448 18899.4328   22  314 13209.7906 20435.0070  54.7%  2019 1819s
 11146  3440 16345.4971   33  225 13209.7906 20322.0983  53.8%  2013 1851s
 11578  3531 14281.4591   30  256 13209.7906 20158.8727  52.6%  2008 1887s
 11994  3699 15635.8605   25  250 13209.7906 20016.6996  51.5%  2011 1923s
 12429  3758     cutoff   29      13209.7906 19857.4998  50.3%  2012 1964s
 12876  3901 16399.3973   25  232 13209.7906 19613.5293  48.5%  2017 2002s
 13409  4014 14613.1550   22  450 13209.7906 19581.4539  48.2%  2008 2044s
 13928  4172 14533.3013   29  164 13209.7906 19461.3101  47.3%  2002 2084s
 14500  4296 16496.9891   26  267 13209.7906 19450.2065  47.2%  1995 2127s
 15107  4430 15603.2714   32  115 13209.7906 19207.2183  45.4%  1986 2173s
 15741  4574 14819.0683   29  107 13209.7906 19037.9891  44.1%  1978 2217s
 16316  4637 14259.2852   29  323 13209.7906 18893.2745  43.0%  1981 2256s
 16674  4701     cutoff   31      13209.7906 18884.2322  43.0%  1982 2305s
 17374  4766 13536.1649   36  164 13209.7906 18690.0902  41.5%  1973 2353s
 18033  4835     cutoff   28      13209.7906 18622.3095  41.0%  1974 2404s
 18688  4904 14242.8121   27  164 13209.7906 18411.0049  39.4%  1976 2457s
 19424  4960 13858.4253   27  185 13209.7906 18181.4841  37.6%  1975 2516s
 20284  5046     cutoff   28      13209.7906 17993.8745  36.2%  1964 2571s
 21122  5005 14854.8538   26  345 13209.7906 17809.4789  34.8%  1959 2631s
 21899  4958     cutoff   28      13209.7906 17695.2225  34.0%  1962 2692s
 22844  4912 15569.5738   23  291 13209.7906 17508.5042  32.5%  1954 2757s
 23785  4790 14717.8769   25  333 13209.7906 17257.7751  30.6%  1948 2822s
 24844  4625     cutoff   32      13209.7906 17023.0711  28.9%  1936 2890s
 25923  4410 14015.9874   34  276 13209.7906 16874.0270  27.7%  1926 2962s
 27084  4033 13578.8470   32  248 13209.7906 16589.3798  25.6%  1912 3033s
 28232  3491     cutoff   33      13209.7906 16295.2879  23.4%  1902 3104s
 29606  2791 14137.7661   20  265 13209.7906 15986.3942  21.0%  1882 3177s
 31124  1546     cutoff   31      13209.7906 15565.6555  17.8%  1856 3244s
 33142    15     cutoff   28      13209.7906 15094.6051  14.3%  1801 3294s
 35084     0 infeasible   34      13209.7906 13854.2954  4.88%  1730 3295s

Cutting planes:
  Learned: 1
  MIR: 749
  Mixing: 2
  Flow cover: 1497
  RLT: 14
  Relax-and-lift: 89

Explored 35101 nodes (60839184 simplex iterations) in 3296.04 seconds (6584.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 13209.8 13209.8 13204.5 ... 12600.3

Optimal solution found (tolerance 1.00e-04)
Best objective 1.320979057606e+04, best bound 1.320979057606e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3296.05s
  Master Objective (UB) = 13209.79, θ = 160772.18
  Upper Bound (UB) = 13209.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160772.18
  [DEBUG]   ✓ Scenario 0: θ = 160772.18 ≤ Q = 163121.30 (slack: 2349.12)
  [DEBUG]   ✓ Scenario 1: θ = 160772.18 ≤ Q = 160772.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160772.18 ≤ Q = 160804.80 (slack: 32.62)
  [DEBUG]   ✓ Scenario 3: θ = 160772.18 ≤ Q = 160772.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160772.18 ≤ Q = 160804.32 (slack: 32.14)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2a598979
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd5a67687
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.298017e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6655200.6605
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.578195e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157819.48    0  138 6655200.66 -157819.48   102%     -    0s
H    0     0                    -119197.7195 -157819.48  32.4%     -    0s
H    0     0                    -119365.6210 -157819.48  32.2%     -    0s
H    0     0                    -124249.0622 -157819.48  27.0%     -    0s
H    0     0                    -137370.9239 -157819.48  14.9%     -    0s
     0     0 -142541.17    0   99 -137370.92 -142541.17  3.76%     -    0s
H    0     0                    -139725.0633 -142419.13  1.93%     -    0s
H    0     0                    -140031.7315 -142419.13  1.70%     -    0s
     0     0 -141815.90    0   96 -140031.73 -141815.90  1.27%     -    0s
     0     0 -141018.45    0   59 -140031.73 -141018.45  0.70%     -    0s
     0     0 -140965.02    0   61 -140031.73 -140965.02  0.67%     -    0s
     0     0 -140959.20    0   57 -140031.73 -140959.20  0.66%     -    0s
     0     0 -140825.46    0   55 -140031.73 -140825.46  0.57%     -    0s
     0     0 -140810.61    0   56 -140031.73 -140810.61  0.56%     -    0s
     0     0 -140715.78    0   57 -140031.73 -140715.78  0.49%     -    0s
     0     0 -140699.61    0   57 -140031.73 -140699.61  0.48%     -    0s
     0     2 -140699.61    0   57 -140031.73 -140699.61  0.48%     -    0s
H   56    44                    -140052.8265 -140336.51  0.20%  12.9    0s
H   59    42                    -140061.4334 -140313.07  0.18%  12.7    0s
H  315   106                    -140065.7777 -140226.46  0.11%   7.1    0s

Cutting planes:
  Gomory: 54
  Implied bound: 9
  MIR: 129
  Flow cover: 16
  RLT: 83
  Relax-and-lift: 6
  BQP: 1

Explored 989 nodes (6090 simplex iterations) in 0.23 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -140066 -140061 -140053 ... 6.6552e+06
No other solutions better than -140066

Optimal solution found (tolerance 1.00e-04)
Best objective -1.400657776632e+05, best bound -1.400657776632e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 142339.84
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140065.78
  [DEBUG]   S×d_nominal = 282405.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282405.62 + -140065.78 = 142339.84
  [DEBUG]   Current θ from Master = 160772.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18432.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5222.55
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3868.0030, Absolute Gap = 3868.0030, Relative Gap = 0.292813
  Not converged yet (gap = 3868.00 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0xfb3fa96e
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 1.40s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27659   -3.2388375e+04   0.000000e+00   3.562119e+06      5s
   37789    8.3503964e+03   0.000000e+00   2.530065e+06     10s
   46769    2.0868124e+04   0.000000e+00   8.133138e+06     15s
   54977    2.7189174e+04   0.000000e+00   3.517351e+07     20s
   62198    2.9461355e+04   0.000000e+00   8.350217e+05     25s
   69579    3.2765396e+04   0.000000e+00   2.248655e+08     30s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.849481e+04, 46751 iterations, 32.03 seconds (43.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38494.8099    0  204 -219144.29 38494.8099   118%     -   34s
H    0     0                    -212888.7365 38494.8099   118%     -   34s
H    0     0                    -158405.1649 38494.8099   124%     -   34s
H    0     0                    -158080.3762 38494.8099   124%     -   34s
H    0     0                    -146162.9085 38494.8099   126%     -   34s
H    0     0                    -144710.5295 38494.8099   127%     -   34s
H    0     0                    -66934.47220 38494.8099   158%     -   34s
H    0     0                    -2083.504410 38494.8099  1948%     -   34s
H    0     0                    -418.3239563 38494.8099  9302%     -   34s
H    0     0                    -261.2367235 38494.8099      -     -   34s
H    0     0                    1648.8461537 38494.8099  2235%     -   35s
H    0     0                    2863.9721968 34460.3447  1103%     -   50s
H    0     0                    5204.3757414 34460.3447   562%     -   50s
H    0     0                    5656.6732451 34460.3447   509%     -   50s
     0     0 33560.2916    0  310 5656.67325 33560.2916   493%     -   50s
     0     0 33501.9266    0  223 5656.67325 33501.9266   492%     -   58s
     0     0 33501.9266    0  230 5656.67325 33501.9266   492%     -   61s
     0     0 33501.9266    0  234 5656.67325 33501.9266   492%     -   62s
     0     0 33501.9266    0  311 5656.67325 33501.9266   492%     -   63s
     0     0 31571.4977    0  313 5656.67325 31571.4977   458%     -   64s
     0     0 31571.4977    0  311 5656.67325 31571.4977   458%     -   64s
H    0     0                    5777.1492913 31402.2872   444%     -   75s
H    0     0                    7219.5013079 31402.2872   335%     -   75s
H    0     0                    7256.2728764 31402.2872   333%     -   75s
     0     0 31402.2872    0  184 7256.27288 31402.2872   333%     -   75s
H    0     0                    7262.3577600 31401.7897   332%     -   75s
H    0     0                    7355.7629865 31401.7897   327%     -   75s
H    0     0                    7373.6133928 31401.7897   326%     -   75s
H    0     0                    7379.1833211 31401.7897   326%     -   75s
     0     0 31198.8948    0  314 7379.18332 31198.8948   323%     -   79s
     0     0 31006.3251    0  311 7379.18332 31006.3251   320%     -   83s
     0     0 30988.9538    0  321 7379.18332 30988.9538   320%     -   84s
     0     0 30985.4367    0  323 7379.18332 30985.4367   320%     -   85s
     0     0 30977.4905    0  325 7379.18332 30977.4905   320%     -   86s
     0     0 30976.0656    0  321 7379.18332 30976.0656   320%     -   86s
     0     0 30975.8929    0  327 7379.18332 30975.8929   320%     -   86s
H    0     0                    7424.7482179 30975.8929   317%     -   94s
H    0     0                    7460.0387492 30975.8929   315%     -   94s
     0     0 28939.7115    0  276 7460.03875 28939.7115   288%     -  108s
H    0     0                    7469.3693376 28599.4558   283%     -  114s
     0     0 28599.4558    0  345 7469.36934 28599.4558   283%     -  114s
     0     0 28413.2333    0  377 7469.36934 28413.2333   280%     -  119s
     0     0 28359.5596    0  375 7469.36934 28359.5596   280%     -  123s
     0     0 28329.0778    0  419 7469.36934 28329.0778   279%     -  126s
H    0     0                    7485.7941452 28299.3857   278%     -  129s
     0     0 28299.3857    0  351 7485.79415 28299.3857   278%     -  129s
     0     0 28280.5887    0  350 7485.79415 28280.5887   278%     -  130s
H    0     0                    8006.0356558 28274.6397   253%     -  130s
     0     0 28274.6397    0  347 8006.03566 28274.6397   253%     -  130s
     0     0 28273.0171    0  345 8006.03566 28273.0171   253%     -  131s
H    0     0                    8557.0489173 28270.4898   230%     -  132s
     0     0 28270.4898    0  347 8557.04892 28270.4898   230%     -  132s
     0     0 28270.2754    0  347 8557.04892 28270.2754   230%     -  132s
H    0     0                    8578.8425209 27703.6196   223%     -  147s
     0     0 27703.6196    0  421 8578.84252 27703.6196   223%     -  147s
     0     0 27484.2252    0  420 8578.84252 27484.2252   220%     -  151s
     0     0 27420.7902    0  418 8578.84252 27420.7902   220%     -  155s
     0     0 27377.7387    0  420 8578.84252 27377.7387   219%     -  157s
     0     0 27358.4359    0  363 8578.84252 27358.4359   219%     -  158s
     0     0 27354.3941    0  418 8578.84252 27354.3941   219%     -  159s
     0     0 27353.4834    0  358 8578.84252 27353.4834   219%     -  160s
H    0     0                    8680.5098537 27214.7930   214%     -  166s
H    0     0                    8736.0736652 27214.7930   212%     -  166s
     0     0 27214.7930    0  375 8736.07367 27214.7930   212%     -  166s
     0     0 27126.8320    0  466 8736.07367 27126.8320   211%     -  170s
     0     0 27109.0162    0  424 8736.07367 27109.0162   210%     -  171s
     0     0 27101.9364    0  429 8736.07367 27101.9364   210%     -  172s
     0     0 27097.9137    0  469 8736.07367 27097.9137   210%     -  173s
     0     0 27096.6329    0  434 8736.07367 27096.6329   210%     -  174s
     0     0 27050.0572    0  425 8736.07367 27050.0572   210%     -  178s
H    0     0                    8770.2468401 27048.5441   208%     -  179s
     0     0 27044.1966    0  436 8770.24684 27044.1966   208%     -  181s
     0     0 27040.4690    0  440 8770.24684 27040.4690   208%     -  182s
     0     0 27038.3061    0  447 8770.24684 27038.3061   208%     -  182s
     0     0 27037.1588    0  448 8770.24684 27037.1588   208%     -  183s
     0     0 27003.0615    0  396 8770.24684 27003.0615   208%     -  187s
     0     0 26983.6505    0  444 8770.24684 26983.6505   208%     -  189s
     0     0 26980.7158    0  436 8770.24684 26980.7158   208%     -  190s
     0     0 26977.0738    0  481 8770.24684 26977.0738   208%     -  192s
     0     0 26976.8341    0  488 8770.24684 26976.8341   208%     -  192s
     0     0 26949.9199    0  445 8770.24684 26949.9199   207%     -  195s
H    0     0                    8772.7311657 26949.7990   207%     -  196s
     0     0 26945.3257    0  497 8772.73117 26945.3257   207%     -  197s
     0     0 26942.2600    0  457 8772.73117 26942.2600   207%     -  198s
     0     0 26941.4238    0  456 8772.73117 26941.4238   207%     -  198s
     0     0 26936.9060    0  463 8772.73117 26936.9060   207%     -  201s
     0     0 26935.4454    0  460 8772.73117 26935.4454   207%     -  202s
     0     0 26934.3922    0  450 8772.73117 26934.3922   207%     -  203s
     0     0 26922.7548    0  422 8772.73117 26922.7548   207%     -  205s
     0     0 26917.3966    0  422 8772.73117 26917.3966   207%     -  207s
     0     0 26913.8786    0  427 8772.73117 26913.8786   207%     -  208s
     0     0 26912.6721    0  426 8772.73117 26912.6721   207%     -  208s
     0     0 26903.7363    0  422 8772.73117 26903.7363   207%     -  211s
     0     0 26896.2147    0  407 8772.73117 26896.2147   207%     -  212s
     0     0 26895.4249    0  421 8772.73117 26895.4249   207%     -  213s
     0     0 26883.4617    0  410 8772.73117 26883.4617   206%     -  215s
     0     0 26879.2977    0  418 8772.73117 26879.2977   206%     -  217s
     0     0 26878.0829    0  413 8772.73117 26878.0829   206%     -  218s
     0     0 26876.5666    0  418 8772.73117 26876.5666   206%     -  219s
     0     0 26875.1722    0  409 8772.73117 26875.1722   206%     -  220s
     0     0 26869.2431    0  412 8772.73117 26869.2431   206%     -  224s
     0     0 26866.6369    0  464 8772.73117 26866.6369   206%     -  225s
     0     0 26864.7862    0  467 8772.73117 26864.7862   206%     -  226s
     0     0 26863.9192    0  427 8772.73117 26863.9192   206%     -  226s
     0     0 26860.9853    0  422 8772.73117 26860.9853   206%     -  228s
     0     0 26860.9615    0  422 8772.73117 26860.9615   206%     -  229s
H    0     0                    8859.0396543 26860.9615   203%     -  252s
H    0     2                    8964.8104843 26860.9615   200%     -  253s
     0     2 26860.9615    0  422 8964.81048 26860.9615   200%     -  253s
     1     4 26641.4102    1  451 8964.81048 26860.9615   200%  6630  261s
     3     8 26504.1840    2  450 8964.81048 26638.5596   197%  5947  270s
     7    16 26327.1302    3  504 8964.81048 26504.0999   196%  5514  278s
    15    32 26170.2168    4  549 8964.81048 26324.8661   194%  5502  290s
    31    48 25168.4840    5  465 8964.81048 26169.8961   192%  8503  313s
    47    80 24468.0020    6  358 8964.81048 26169.8961   192%  8268  331s
H   48    80                    9175.1168902 26169.8961   185%  8095  331s
H   52    80                    9217.3027125 26169.8961   184%  7917  331s
H   54    80                    9324.3860180 26169.8961   181%  7744  331s
H   55    80                    9393.5093759 26169.8961   179%  7719  331s
H   64    80                    10758.036322 26169.8961   143%  7253  331s
    79   147 24341.9618    7  393 10758.0363 26169.8961   143%  6360  365s
H  146   295                    11068.444604 26169.8961   136%  4415  381s
H  150   295                    11298.660576 26169.8961   132%  4373  381s
H  159   295                    11421.854880 26169.8961   129%  4234  381s
H  164   295                    11587.973286 26169.8961   126%  4149  381s
H  173   295                    11712.650102 26169.8961   123%  4023  381s
H  232   295                    11882.646184 26169.8961   120%  3449  381s
   294   393 23756.7719   10  379 11882.6462 26169.8961   120%  3091  393s
H  406   454                    11889.364332 26169.8961   120%  2636  404s
   495   502 23541.1115   11  309 11889.3643 26169.8961   120%  2481  416s
   573   524 23981.9657   11  335 11889.3643 26169.8961   120%  2396  427s
H  585   524                    12058.640953 26169.8961   117%  2382  427s
   621   554 24039.6358   11  323 12058.6410 26169.8961   117%  2406  438s
   677   582 22997.9111   11  280 12058.6410 26169.8961   117%  2429  450s
   707   640 21954.1933   12  254 12058.6410 26169.8961   117%  2499  461s
   769   685 22360.5424   12  243 12058.6410 26169.8961   117%  2501  471s
   820   744 22849.6508   12  319 12058.6410 26169.8961   117%  2529  482s
   903   782 18877.8399   12  385 12058.6410 26169.8961   117%  2460  494s
   965   819 21854.3798   13  255 12058.6410 26169.8961   117%  2454  507s
  1034   859 21809.5409   13  228 12058.6410 26169.8961   117%  2448  520s
H 1067   859                    12502.784972 26169.8961   109%  2448  520s
  1086   910 21746.1362   14  261 12502.7850 26169.8961   109%  2443  533s
  1173   938 21147.3546   16  260 12502.7850 25945.5793   108%  2405  545s
  1243   990 20217.5588   16  206 12502.7850 25945.5793   108%  2386  560s
  1321  1074 20658.1062   14  238 12502.7850 25945.5793   108%  2382  572s
  1435  1158 20976.2199   17  249 12502.7850 25945.5793   108%  2322  585s
  1553  1243 19764.1172   17  259 12502.7850 25945.5793   108%  2275  598s
  1672  1337 19321.8339   19  253 12502.7850 25945.5793   108%  2239  612s
  1804  1389 18884.4756   21  193 12502.7850 25261.1315   102%  2213  623s
  1894  1480 18620.8695   23  237 12502.7850 25261.1315   102%  2190  640s
  2017  1516 18470.1200   25  189 12502.7850 25230.5486   102%  2161  652s
  2065  1612 18417.1446   26  192 12502.7850 25230.5486   102%  2165  663s
  2183  1729 17959.6940   27  351 12502.7850 25230.5486   102%  2121  677s
  2350  1864 18095.3470   27  183 12502.7850 25230.5486   102%  2052  691s
  2545  2016 17825.9918   28  231 12502.7850 25230.5486   102%  1992  709s
  2728  2186 17640.6188   29  235 12502.7850 25230.5486   102%  1950  723s
  2947  2345 17634.5320   31  226 12502.7850 25230.5486   102%  1908  740s
  3170  2486     cutoff   32      12502.7850 25230.5486   102%  1862  756s
  3392  2642 17158.7314   34  332 12502.7850 25205.7962   102%  1844  775s
  3607  2643 15598.2914   54  422 12502.7850 25205.7962   102%  1824  832s
  3609  2644 20787.0963   17  204 12502.7850 25205.7962   102%  1823  876s
  3610  2645 23127.4645    8  447 12502.7850 25205.7962   102%  1822  911s
  3611  2646 16894.3639   52  375 12502.7850 25205.7962   102%  1822  931s
  3612  2646 15358.8758   54  421 12502.7850 25205.7962   102%  1821  942s
  3613  2647 13042.5740   37  475 12502.7850 25205.7962   102%  1821  948s
  3614  2648 19716.8322   17  445 12502.7850 25205.7962   102%  1820  952s
  3616  2649 19633.7185   14  449 12502.7850 25205.7962   102%  1819  957s
  3618  2650 15173.9416   39  485 12502.7850 25205.7962   102%  1818  961s
  3620  2652 21467.4092   14  516 12502.7850 25205.7962   102%  1817  965s
  3621  2652 23125.2538   10  553 12502.7850 25205.7962   102%  1817  971s
  3623  2654 14009.5069   29  449 12502.7850 25205.7962   102%  1816  975s
  3626  2656 15206.8955   47  456 12502.7850 25205.7962   102%  1814  982s
  3628  2657 14778.1126   38  515 12502.7850 25205.7962   102%  1813  986s
  3629  2658 19251.1130   22  477 12502.7850 25205.7962   102%  1813  991s
  3631  2659 22019.7586   18  475 12502.7850 25205.7962   102%  1812  999s
  3632  2660 20929.2261   15  469 12502.7850 25205.7962   102%  1811 1002s
  3633  2660 22490.9204   10  471 12502.7850 25205.7962   102%  1811 1008s
  3634  2661 13763.5962   23  476 12502.7850 25205.7962   102%  1810 1010s
  3635  2662 14214.4565   29  408 12502.7850 25205.7962   102%  1810 1015s
  3636  2662 23425.2680   11  457 12502.7850 25205.7962   102%  1809 1020s
  3639  2664 14922.4382   61  463 12502.7850 25205.7962   102%  1808 1031s
  3641  2666 20271.8282   14  479 12502.7850 25205.7962   102%  1807 1036s
  3642  2666 13262.8959   48  417 12502.7850 25205.7962   102%  1806 1041s
  3644  2668 12671.0446   18  433 12502.7850 25205.7962   102%  1805 1045s
  3645  2668 13975.5375   44  412 12502.7850 25205.7962   102%  1805 1050s
  3647  2670 20429.4998   20  467 12502.7850 25205.7962   102%  1804 1055s
  3649  2671 22621.1153   15  421 12502.7850 25205.7962   102%  1803 1063s
  3650  2672 12992.7708   40  435 12502.7850 25205.7962   102%  1802 1066s
  3651  2672 13115.9980   43  428 12502.7850 25205.7962   102%  1802 1071s
  3652  2673 20838.4331   13  432 12502.7850 25205.7962   102%  1801 1075s
  3654  2674 19121.2094   25  425 12502.7850 25205.7962   102%  1800 1119s
  3655  2675 12789.9295   40  425 12502.7850 25205.7962   102%  1800 1156s
  3656  2679 25205.7962   16  413 12502.7850 25205.7962   102%  1854 1173s
  3658  2682 25205.7962   17  410 12502.7850 25205.7962   102%  1857 1190s
  3662  2689 25205.7962   18  446 12502.7850 25205.7962   102%  1863 1210s
  3670  2702 25205.7962   19  576 12502.7850 25205.7962   102%  1879 1233s
  3686  2711 25205.7962   20  541 12502.7850 25205.7962   102%  1926 1275s
  3702  2737 23086.2920   21  480 12502.7850 25205.7962   102%  1958 1313s
  3734  2824 22836.3200   22  360 12502.7850 25205.7962   102%  2004 1344s
  3831  2823 22270.6416   24  461 12502.7850 25205.7962   102%  2120 1359s
  3863  2848 21807.6332   24  362 12502.7850 25205.7962   102%  2131 1378s
  3899  2893 22051.9872   25  462 12502.7850 25205.7962   102%  2139 1395s
  3969  2925 20144.3006   27  298 12502.7850 25205.7962   102%  2151 1413s
  4060  2949 21718.6374   25  461 12502.7850 25205.7962   102%  2157 1431s
  4161  2963 21355.7926   25  463 12502.7850 25205.7962   102%  2153 1447s
  4251  2966 21449.1028   26  407 12502.7850 24866.9627  98.9%  2151 1469s
  4329  2976 21155.8410   26  421 12502.7850 24866.9627  98.9%  2161 1487s
  4402  2973 19886.7058   27  395 12502.7850 24866.9627  98.9%  2182 1508s
  4460  2984 19037.3508   28  424 12502.7850 24843.6383  98.7%  2206 1525s
  4531  2997 14987.7308   39  237 12502.7850 24843.6383  98.7%  2214 1545s
  4598  3001 18550.4824   29  393 12502.7850 24590.8709  96.7%  2231 1561s
  4665  3017 18107.5151   30  405 12502.7850 24590.8709  96.7%  2247 1578s
  4761  3021 17969.7133   31  217 12502.7850 24330.9818  94.6%  2256 1597s
  4852  3020 16197.7141   33   95 12502.7850 24090.2815  92.7%  2261 1616s
  4951  3033     cutoff   34      12502.7850 23872.3289  90.9%  2262 1638s
  5034  3060 14502.7521   35  258 12502.7850 23872.3289  90.9%  2283 1657s
  5119  3083 12943.4750   36   72 12502.7850 23644.9355  89.1%  2297 1678s
  5220  3100     cutoff   37      12502.7850 23644.9355  89.1%  2307 1697s
  5335  3105 13378.6891   44  146 12502.7850 23176.3518  85.4%  2312 1719s
  5455  3134 19879.7629   23  288 12502.7850 23176.3518  85.4%  2322 1741s
  5572  3151 19452.7715   25  269 12502.7850 23176.3518  85.4%  2333 1764s
  5693  3158 17337.6041   29  236 12502.7850 23176.3518  85.4%  2341 1792s
  5828  3176 15584.5614   31  186 12502.7850 23176.3518  85.4%  2348 1817s
  5979  3184 13553.6615   34  102 12502.7850 23057.7288  84.4%  2346 1841s
  6158  3164 13978.3709   25  245 12502.7850 22505.5060  80.0%  2334 1869s
  6330  3185     cutoff   27      12502.7850 22198.3834  77.5%  2334 1896s
  6486  3199 19820.8144   27  256 12502.7850 22163.3404  77.3%  2342 1931s
  6628  3200 18339.5702   30  209 12502.7850 22055.6023  76.4%  2366 1960s
  6769  3220 17244.6651   33  213 12502.7850 21936.1148  75.4%  2388 1988s
  6931  3261 15925.8921   35  182 12502.7850 21936.1148  75.4%  2399 2022s
  7187  3223 15157.0404   36  112 12502.7850 21873.6338  75.0%  2386 2050s
  7357  3252 20022.6553   29  313 12502.7850 21513.7738  72.1%  2393 2084s
  7515  3268 15684.2809   31  277 12502.7850 21513.7738  72.1%  2419 2116s
  7716  3256 13895.1424   33  326 12502.7850 21351.5276  70.8%  2434 2152s
  7994  3226 15569.0620   26  268 12502.7850 21254.8839  70.0%  2430 2187s
  8179  3185 13119.4944   30  257 12502.7850 21127.9253  69.0%  2459 2216s
  8287  3202 12872.4397   31  246 12502.7850 21105.9688  68.8%  2468 2252s
  8528  3198 13671.3282   30  159 12502.7850 21027.8408  68.2%  2476 2289s
  8739  3187 16514.0148   30  185 12502.7850 20792.1842  66.3%  2482 2329s
  9068  3193 18861.1905   25  331 12502.7850 20533.0078  64.2%  2487 2370s
  9354  3163 15162.8493   34  277 12502.7850 20481.2017  63.8%  2502 2407s
  9485  3242 14378.4171   44  113 12502.7850 20481.2017  63.8%  2500 2454s
  9836  3208 16109.8909   25  359 12502.7850 20347.2280  62.7%  2498 2505s
 10154  3162     cutoff   28      12502.7850 20121.6115  60.9%  2510 2558s
 10504  3143 15568.4643   31  292 12502.7850 20016.3403  60.1%  2522 2610s
 10875  3132 17121.5508   30  216 12502.7850 19914.5009  59.3%  2529 2661s
 11287  3076     cutoff   36      12502.7850 19853.2540  58.8%  2533 2716s
 11689  3024 17867.1069   32  144 12502.7850 19724.8420  57.8%  2539 2773s
 12093  3130 infeasible   30      12502.7850 19485.0952  55.8%  2551 2836s
 12493  3223     cutoff   30      12502.7850 19235.8193  53.9%  2562 2900s
 12937  3335 15818.2530   30  230 12502.7850 19235.4651  53.8%  2570 2963s
 13387  3478 15917.8002   31  242 12502.7850 19220.0447  53.7%  2581 3028s
 13881  3538 12915.7231   26  221 12502.7850 18831.3585  50.6%  2583 3097s
 14435  3592     cutoff   29      12502.7850 18718.8096  49.7%  2583 3166s
 14952  3611 16691.3741   27  348 12502.7850 18662.0770  49.3%  2591 3225s
 15037  3664     cutoff   28      12502.7850 18551.2551  48.4%  2594 3289s
 15450  3749 12933.3514   31  393 12502.7850 18524.2824  48.2%  2594 3367s
 16015  3830 14519.8996   28  312 12502.7850 18255.2426  46.0%  2601 3449s
 16663  3921 15755.8046   28  211 12502.7850 18126.5544  45.0%  2599 3532s
 17318  3947     cutoff   31      12502.7850 18087.7555  44.7%  2600 3600s

Cutting planes:
  Learned: 2
  MIR: 637
  Mixing: 2
  Flow cover: 1636
  RLT: 16
  Relax-and-lift: 103

Explored 17997 nodes (46797961 simplex iterations) in 3600.04 seconds (6704.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12502.8 12058.6 11889.4 ... 10758

Time limit reached
Best objective 1.250278497220e+04, best bound 1.799664347023e+04, gap 43.9411%
  WARNING: Time limit reached. Using best solution found (gap: 43.94%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 12502.78, θ = 157319.67
  Upper Bound (UB) = 12502.78

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157319.67
  [DEBUG]   ✓ Scenario 0: θ = 157319.67 ≤ Q = 157319.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157319.67 ≤ Q = 157319.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157319.67 ≤ Q = 157319.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157319.67 ≤ Q = 157319.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157319.67 ≤ Q = 157319.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157319.67 ≤ Q = 157319.67 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2e8f6f0f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd17090f1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-15, 2e+02]
Found heuristic solution: objective 1.323349e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6627690.6254
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.608513e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160851.27    0  130 6627690.63 -160851.27   102%     -    0s
H    0     0                    -125389.6927 -160851.27  28.3%     -    0s
H    0     0                    -125557.5941 -160851.27  28.1%     -    0s
H    0     0                    -133152.2606 -141180.98  6.03%     -    0s
     0     0 -141180.98    0   89 -133152.26 -141180.98  6.03%     -    0s
H    0     0                    -136955.1587 -141051.94  2.99%     -    0s
H    0     0                    -137282.2948 -141051.94  2.75%     -    0s
H    0     0                    -137678.0135 -141051.94  2.45%     -    0s
H    0     0                    -138005.1497 -141051.94  2.21%     -    0s
H    0     0                    -138256.9307 -141032.82  2.01%     -    0s
     0     0 -141032.82    0   89 -138256.93 -141032.82  2.01%     -    0s
     0     0 -141032.62    0   89 -138256.93 -141032.62  2.01%     -    0s
     0     0 -139848.32    0   52 -138256.93 -139848.32  1.15%     -    0s
H    0     0                    -138467.3986 -139800.74  0.96%     -    0s
     0     0 -139745.39    0   52 -138467.40 -139745.39  0.92%     -    0s
     0     0 -139637.00    0   52 -138467.40 -139637.00  0.84%     -    0s
     0     0 -139567.61    0   51 -138467.40 -139567.61  0.79%     -    0s
     0     0 -139567.61    0   50 -138467.40 -139567.61  0.79%     -    0s
     0     0 -139436.62    0   53 -138467.40 -139436.62  0.70%     -    0s
     0     0 -139434.23    0   53 -138467.40 -139434.23  0.70%     -    0s
H    0     0                    -138467.9360 -139434.23  0.70%     -    0s
     0     2 -139434.23    0   53 -138467.94 -139434.23  0.70%     -    0s
H  112   143                    -138487.6349 -138902.34  0.30%  15.0    0s
H  192   143                    -138508.3470 -138852.62  0.25%  11.3    0s
*  805   306              20    -138521.3653 -138743.45  0.16%   6.6    0s
* 1101   338              19    -138533.9068 -138681.92  0.11%   6.1    0s
* 1353   314              20    -138561.5486 -138650.55  0.06%   5.7    0s
* 1467   314              19    -138561.5935 -138650.55  0.06%   5.5    0s

Cutting planes:
  Gomory: 57
  Implied bound: 7
  MIR: 152
  Flow cover: 6
  RLT: 47
  Relax-and-lift: 1

Explored 1997 nodes (10372 simplex iterations) in 0.30 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -138562 -138562 -138534 ... -138005
No other solutions better than -138562

Optimal solution found (tolerance 1.00e-04)
Best objective -1.385615934602e+05, best bound -1.385615934602e+05, gap 0.0000%
  Subproblem solved in 0.33s
  Worst-case operational profit (Z_SP) = 143918.46
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138561.59
  [DEBUG]   S×d_nominal = 282480.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282480.05 + -138561.59 = 143918.46
  [DEBUG]   Current θ from Master = 157319.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13401.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -898.42
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3160.9974, Absolute Gap = 3160.9974, Relative Gap = 0.252823
  Not converged yet (gap = 3161.00 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0x54a751f0
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 2.22s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25692   -1.7194972e+05   0.000000e+00   1.052332e+08      5s
   39578   -2.4231004e+04   0.000000e+00   5.932012e+06     10s
   47664    8.1436417e+03   0.000000e+00   1.264479e+07     15s
   55883    1.3396564e+04   0.000000e+00   2.975652e+07     20s
Concurrent spin time: 1.42s

Solved with dual simplex

Root relaxation: objective 3.836139e+04, 37434 iterations, 21.38 seconds (30.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38361.3889    0  208 -219144.29 38361.3889   118%     -   24s
H    0     0                    -211639.7960 38361.3889   118%     -   24s
H    0     0                    -186975.7411 38361.3889   121%     -   25s
H    0     0                    -184153.7882 38361.3889   121%     -   25s
H    0     0                    -183998.7222 38361.3889   121%     -   25s
H    0     0                    -182859.3950 38361.3889   121%     -   25s
H    0     0                    -182376.1244 38361.3889   121%     -   25s
H    0     0                    -182228.6258 38361.3889   121%     -   25s
H    0     0                    -182040.2051 38361.3889   121%     -   25s
H    0     0                    -60485.41141 38361.3889   163%     -   25s
H    0     0                    -60291.68853 38361.3889   164%     -   26s
H    0     0                    -6625.514928 38361.3889   679%     -   26s
H    0     0                    1622.1179787 38361.3889  2265%     -   26s
H    0     0                    1627.0270826 34377.6553  2013%     -   48s
H    0     0                    1650.3508850 34377.6553  1983%     -   48s
H    0     0                    1750.0934195 34377.6553  1864%     -   48s
H    0     0                    1913.3610277 34377.6553  1697%     -   48s
     0     0 33658.7640    0  321 1913.36103 33658.7640  1659%     -   48s
     0     0 33197.6315    0  317 1913.36103 33197.6315  1635%     -   57s
     0     0 33197.6315    0  320 1913.36103 33197.6315  1635%     -   60s
     0     0 33197.6315    0  324 1913.36103 33197.6315  1635%     -   61s
     0     0 33197.6315    0  322 1913.36103 33197.6315  1635%     -   61s
     0     0 33197.6315    0  324 1913.36103 33197.6315  1635%     -   63s
     0     0 33197.6315    0  323 1913.36103 33197.6315  1635%     -   63s
     0     0 33197.6315    0  323 1913.36103 33197.6315  1635%     -   63s
     0     0 31017.0086    0  253 1913.36103 31017.0086  1521%     -   82s
H    0     0                    2899.6345321 31016.9484   970%     -   83s
H    0     0                    5095.1760513 31016.9484   509%     -   83s
H    0     0                    5173.5267253 31016.9484   500%     -   83s
     0     0 30613.2009    0  229 5173.52673 30613.2009   492%     -   90s
H    0     0                    5700.8550869 30524.3575   435%     -   94s
H    0     0                    5712.6259553 30524.3575   434%     -   94s
H    0     0                    5754.7832515 30524.3575   430%     -   94s
H    0     0                    5897.2782183 30524.3575   418%     -   94s
H    0     0                    5963.4670632 30524.3575   412%     -   94s
H    0     0                    6130.5888729 30524.3575   398%     -   94s
     0     0 30524.3575    0  235 6130.58887 30524.3575   398%     -   94s
     0     0 30401.5730    0  311 6130.58887 30401.5730   396%     -   98s
     0     0 30397.5369    0  311 6130.58887 30397.5369   396%     -   99s
     0     0 30397.0311    0  309 6130.58887 30397.0311   396%     -   99s
H    0     0                    7201.7207897 30397.0311   322%     -  108s
H    0     0                    7220.4188409 30397.0311   321%     -  108s
H    0     0                    7520.0338526 28765.5498   283%     -  125s
H    0     0                    7525.6252771 28765.5498   282%     -  125s
H    0     0                    7731.6298908 28765.5498   272%     -  125s
     0     0 28765.5498    0  414 7731.62989 28765.5498   272%     -  125s
H    0     0                    7859.7645574 28765.2142   266%     -  126s
H    0     0                    8030.1281918 28765.2142   258%     -  126s
     0     0 28425.9969    0  307 8030.12819 28425.9969   254%     -  132s
     0     0 28298.4965    0  355 8030.12819 28298.4965   252%     -  138s
     0     0 28264.7941    0  358 8030.12819 28264.7941   252%     -  143s
     0     0 28210.7223    0  390 8030.12819 28210.7223   251%     -  148s
     0     0 28195.6669    0  363 8030.12819 28195.6669   251%     -  150s
     0     0 28183.0732    0  394 8030.12819 28183.0732   251%     -  151s
     0     0 28171.1217    0  366 8030.12819 28171.1217   251%     -  153s
     0     0 28164.5809    0  371 8030.12819 28164.5809   251%     -  155s
     0     0 28161.7692    0  375 8030.12819 28161.7692   251%     -  156s
     0     0 28160.2307    0  406 8030.12819 28160.2307   251%     -  157s
     0     0 28157.2059    0  372 8030.12819 28157.2059   251%     -  158s
     0     0 28154.8285    0  402 8030.12819 28154.8285   251%     -  159s
     0     0 28151.8025    0  374 8030.12819 28151.8025   251%     -  160s
     0     0 28151.7139    0  374 8030.12819 28151.7139   251%     -  160s
H    0     0                    8051.1839193 27719.5663   244%     -  177s
     0     0 27719.5663    0  391 8051.18392 27719.5663   244%     -  177s
H    0     0                    8187.4159845 27498.7901   236%     -  185s
     0     0 27498.7901    0  398 8187.41598 27498.7901   236%     -  185s
     0     0 27447.7925    0  403 8187.41598 27447.7925   235%     -  189s
     0     0 27427.5273    0  399 8187.41598 27427.5273   235%     -  191s
     0     0 27422.2296    0  404 8187.41598 27422.2296   235%     -  192s
H    0     0                    8408.0624189 27387.7561   226%     -  196s
H    0     0                    8435.9144102 27387.7561   225%     -  196s
     0     0 27387.7561    0  483 8435.91441 27387.7561   225%     -  196s
     0     0 27385.1838    0  420 8435.91441 27385.1838   225%     -  197s
     0     0 27383.8106    0  440 8435.91441 27383.8106   225%     -  198s
     0     0 27382.7544    0  402 8435.91441 27382.7544   225%     -  198s
     0     0 27324.4359    0  468 8435.91441 27324.4359   224%     -  203s
H    0     0                    8443.4289455 27324.3329   224%     -  204s
H    0     0                    8454.8444367 27324.3329   223%     -  204s
H    0     0                    8498.6582208 27324.3329   222%     -  204s
H    0     0                    8524.5145268 27324.3329   221%     -  204s
H    0     0                    8571.8037652 27324.3329   219%     -  204s
H    0     0                    8600.3282154 27324.3329   218%     -  204s
H    0     0                    8633.3800492 27324.3329   216%     -  204s
     0     0 27296.2828    0  425 8633.38005 27296.2828   216%     -  207s
     0     0 27277.6944    0  378 8633.38005 27277.6944   216%     -  208s
     0     0 27266.4879    0  481 8633.38005 27266.4879   216%     -  212s
     0     0 27251.2621    0  473 8633.38005 27251.2621   216%     -  214s
     0     0 27243.9028    0  433 8633.38005 27243.9028   216%     -  215s
     0     0 27241.1106    0  432 8633.38005 27241.1106   216%     -  215s
     0     0 27240.6861    0  435 8633.38005 27240.6861   216%     -  215s
     0     0 27183.8751    0  391 8633.38005 27183.8751   215%     -  219s
     0     0 27166.3817    0  446 8633.38005 27166.3817   215%     -  228s
     0     0 27161.2603    0  453 8633.38005 27161.2603   215%     -  230s
     0     0 27157.0491    0  453 8633.38005 27157.0491   215%     -  231s
     0     0 27156.2761    0  460 8633.38005 27156.2761   215%     -  232s
     0     0 27135.3265    0  422 8633.38005 27135.3265   214%     -  234s
     0     0 27130.9259    0  416 8633.38005 27130.9259   214%     -  235s
     0     0 27126.6765    0  409 8633.38005 27126.6765   214%     -  236s
     0     0 27125.4248    0  414 8633.38005 27125.4248   214%     -  237s
     0     0 27117.3774    0  432 8633.38005 27117.3774   214%     -  239s
     0     0 27113.9923    0  359 8633.38005 27113.9923   214%     -  242s
     0     0 27112.7272    0  362 8633.38005 27112.7272   214%     -  243s
     0     0 27096.7443    0  454 8633.38005 27096.7443   214%     -  245s
H    0     0                    8640.6637828 27093.7132   214%     -  246s
     0     0 27092.3708    0  362 8640.66378 27092.3708   214%     -  247s
     0     0 27090.6419    0  362 8640.66378 27090.6419   214%     -  247s
     0     0 27088.9182    0  467 8640.66378 27088.9182   214%     -  248s
     0     0 27088.6545    0  470 8640.66378 27088.6545   214%     -  249s
     0     0 27082.8567    0  396 8640.66378 27082.8567   213%     -  251s
     0     0 27080.8672    0  470 8640.66378 27080.8672   213%     -  256s
     0     0 27079.6742    0  359 8640.66378 27079.6742   213%     -  257s
     0     0 27077.6590    0  427 8640.66378 27077.6590   213%     -  259s
     0     0 27077.1485    0  419 8640.66378 27077.1485   213%     -  260s
     0     0 27075.8265    0  428 8640.66378 27075.8265   213%     -  262s
     0     0 27075.1118    0  417 8640.66378 27075.1118   213%     -  262s
     0     0 27071.1759    0  414 8640.66378 27071.1759   213%     -  264s
     0     0 27052.6540    0  414 8640.66378 27052.6540   213%     -  266s
     0     2 27052.2981    0  414 8640.66378 27052.2981   213%     -  310s
     1     4 27008.4718    1  348 8640.66378 27048.6453   213%  2965  316s
     3     7 25879.6197    2  369 8640.66378 27006.5490   213%  4947  324s
     6    14 24874.2588    3  358 8640.66378 27006.5490   213%  6163  335s
    13    28 24415.7805    4  364 8640.66378 26477.4151   206%  6942  356s
    27    42 25435.2933    4  462 8640.66378 26161.3572   203% 12024  388s
    41    74 24701.7520    5  444 8640.66378 26161.3572   203% 11075  429s
H   47    74                    8721.8045313 26161.3572   200% 10245  429s
    73   162 24626.5386    6  438 8721.80453 25842.9234   196%  9695  465s
H  161   194                    9047.7287012 25842.9234   186%  6229  480s
H  184   194                    9192.7268943 25842.9234   181%  5784  480s
   193   306 23815.2075   10  420 9192.72689 25842.9234   181%  5776  500s
   305   398 23629.5549   14  395 9192.72689 25842.9234   181%  4957  516s
   397   486 22800.9479   17  352 9192.72689 25842.9234   181%  4410  532s
   485   566 22382.5282   22  334 9192.72689 25842.9234   181%  4042  547s
   567   674 21923.5503   27  325 9192.72689 25842.9234   181%  3788  561s
   675   768 21644.1817   32  277 9192.72689 25842.9234   181%  3408  573s
   773   853 21239.6225   35  307 9192.72689 25842.9234   181%  3152  583s
   868   944 20976.2437   37  310 9192.72689 25842.9234   181%  2972  595s
   972  1054 20804.6480   39  328 9192.72689 25842.9234   181%  2779  609s
  1096  1148 19510.5703   41  230 9192.72689 25842.9234   181%  2603  621s
  1206  1235 14835.5032   43  165 9192.72689 25842.9234   181%  2490  634s
  1313  1304 13726.7818   49  165 9192.72689 25577.5108   178%  2414  647s
  1430  1338 10812.5516   57  106 9192.72689 25577.5108   178%  2331  664s
  1504  1380 21846.4735   13  417 9192.72689 25318.3741   175%  2337  680s
H 1512  1380                    9202.0574826 25318.3741   175%  2328  680s
  1554  1426 21638.1284   14  430 9202.05748 25318.3741   175%  2383  696s
  1624  1486 21599.7005   15  429 9202.05748 25318.3741   175%  2416  714s
  1686  1552 19983.7969   17  338 9202.05748 25318.3741   175%  2458  730s
  1768  1616 19842.7796   19  368 9202.05748 25318.3741   175%  2473  749s
H 1856  1650                    9300.8548043 25232.0980   171%  2469  765s
H 1862  1650                    9323.0515518 25232.0980   171%  2480  765s
  1906  1708 20629.9845   13  272 9323.05155 25232.0980   171%  2516  785s
  1980  1754 12818.9175   24  281 9323.05155 25232.0980   171%  2557  803s
H 1981  1754                    9402.5919185 25232.0980   168%  2556  803s
H 1985  1754                    9479.5515035 25232.0980   166%  2559  803s
H 1994  1754                    9710.4464691 25232.0980   160%  2551  803s
H 2001  1754                    9753.3050210 25232.0980   159%  2552  803s
H 2008  1754                    11595.997165 25232.0980   118%  2547  803s
  2048  1803 12753.8083   25  288 11595.9972 25232.0980   118%  2575  822s
H 2135  1822                    11707.838101 25232.0980   116%  2586  842s
H 2139  1822                    12649.111195 25232.0980  99.5%  2585  842s
  2213  1819     cutoff   31      12649.1112 25232.0980  99.5%  2592  864s
  2314  1793 23083.3758    7  351 12649.1112 25044.3432  98.0%  2598  893s
H 2331  1793                    12660.490672 25044.3432  97.8%  2596  893s
H 2336  1793                    12667.809246 25044.3432  97.7%  2601  893s
  2401  1797 23033.0922    8  295 12667.8092 25044.3432  97.7%  2607  917s
  2492  1828 21768.5399   10  369 12667.8092 25044.3432  97.7%  2634  937s
  2599  1902 21450.6292   12  358 12667.8092 25044.3432  97.7%  2628  957s
  2703  2002 20439.2743   14  357 12667.8092 25044.3432  97.7%  2605  977s
H 2746  1985                    12779.671087 25044.3432  96.0%  2602  977s
  2831  2092 19411.5883   19  334 12779.6711 25044.3432  96.0%  2581 1003s
  2988  2177 18715.5373   23  332 12779.6711 25044.3432  96.0%  2560 1041s
  3122  2293 18395.7447   27  336 12779.6711 25044.3432  96.0%  2544 1067s
  3296  2398 14273.1199   47   26 12779.6711 25044.3432  96.0%  2524 1094s
  3457  2529     cutoff   29      12779.6711 24618.1377  92.6%  2518 1122s
  3641  2530 17008.7907   27  414 12779.6711 24618.1377  92.6%  2493 1188s
  3643  2531 13744.5160   41  208 12779.6711 24618.1377  92.6%  2491 1248s
  3644  2532 14617.4388   28  375 12779.6711 24618.1377  92.6%  2490 1296s
  3645  2533 15167.4059   57  382 12779.6711 24618.1377  92.6%  2490 1320s
  3646  2533 14213.0796   33  446 12779.6711 24618.1377  92.6%  2489 1338s
  3647  2534 22206.0487   13  428 12779.6711 24618.1377  92.6%  2488 1347s
  3648  2535 23212.2072   20  499 12779.6711 24618.1377  92.6%  2488 1353s
  3649  2535 19928.2778   31  422 12779.6711 24618.1377  92.6%  2487 1360s
  3650  2536 17374.2909   36  455 12779.6711 24618.1377  92.6%  2486 1365s
  3652  2537 16829.7618   35  367 12779.6711 24618.1377  92.6%  2485 1373s
  3653  2538 21229.0239   15  432 12779.6711 24618.1377  92.6%  2484 1380s
  3654  2539 17737.7078   22  468 12779.6711 24618.1377  92.6%  2484 1386s
  3656  2540 23551.6056   12  449 12779.6711 24618.1377  92.6%  2482 1391s
  3658  2541 16438.5543   49  429 12779.6711 24618.1377  92.6%  2481 1400s
  3660  2543 22020.2058   17  472 12779.6711 24618.1377  92.6%  2480 1411s
  3662  2544 17732.6544   21  417 12779.6711 24618.1377  92.6%  2478 1419s
H 3662  2416                    12792.259771 24618.1377  92.4%  2478 1420s
  3664  2417 21955.3124   13  422 12792.2598 24618.1377  92.4%  2477 1431s
  3666  2419 16224.2917   15  426 12792.2598 24618.1377  92.4%  2476 1436s
  3667  2419 20188.0933   12  419 12792.2598 24618.1377  92.4%  2475 1440s
  3669  2421 23186.4435   12  469 12792.2598 24618.1377  92.4%  2474 1452s
  3671  2422 23677.7515   16  422 12792.2598 24618.1377  92.4%  2472 1459s
  3672  2423 17695.7348   16  422 12792.2598 24618.1377  92.4%  2472 1518s
H 3672  2301                    12844.058088 24618.1377  91.7%  2472 1570s
  3674  2304 24618.1377   10  373 12844.0581 24618.1377  91.7%  2534 1593s
  3675  2307 24618.1377   11  323 12844.0581 24618.1377  91.7%  2536 1617s
  3678  2312 24618.1377   12  389 12844.0581 24618.1377  91.7%  2538 1644s
  3684  2322 23337.8221   13  311 12844.0581 24618.1377  91.7%  2553 1668s
  3696  2331 22748.8192   14  343 12844.0581 24618.1377  91.7%  2611 1718s
  3711  2358 23551.6389   14  422 12844.0581 24618.1377  91.7%  2636 1770s
  3743  2425 22358.9797   15  425 12844.0581 24618.1377  91.7%  2716 1811s
  3828  2466 21569.6912   16  380 12844.0581 24618.1377  91.7%  2884 1859s
  3906  2507 22035.1593   16  428 12844.0581 24618.1377  91.7%  2920 1897s
  3987  2521 20867.5426   17  384 12844.0581 24618.1377  91.7%  2944 1930s
  4037  2566 18852.3781   18  441 12844.0581 24618.1377  91.7%  2968 1955s
  4120  2603 19978.5987   18  318 12844.0581 24618.1377  91.7%  2979 1981s
  4200  2638 17229.2641   19  333 12844.0581 24618.1377  91.7%  2976 2001s
  4293  2668     cutoff   20      12844.0581 24618.1377  91.7%  2965 2021s
  4373  2696 18983.6418   19  421 12844.0581 24618.1377  91.7%  2960 2039s
  4458  2694 13442.5444   32  288 12844.0581 24618.1377  91.7%  2949 2056s
  4525  2683 14224.5792   20  379 12844.0581 24618.1377  91.7%  2947 2077s
  4609  2675 13896.3286   21  356 12844.0581 24618.1377  91.7%  2938 2100s
  4676  2660     cutoff   22      12844.0581 24618.1377  91.7%  2932 2130s
  4742  2656     cutoff   23      12844.0581 24618.1377  91.7%  2937 2150s
  4807  2660     cutoff   24      12844.0581 23794.6109  85.3%  2941 2172s
  4869  2673 19079.9572   21  320 12844.0581 23794.6109  85.3%  2957 2196s
  4928  2691 18577.4912   22  266 12844.0581 23794.6109  85.3%  2967 2218s
  4986  2710 17479.5066   23  187 12844.0581 23718.3491  84.7%  2980 2252s
  5061  2722 15292.7969   25  171 12844.0581 23656.8902  84.2%  2987 2281s
  5145  2738 14467.6776   26  160 12844.0581 23656.8902  84.2%  2995 2306s
  5224  2757 14019.7269   30  168 12844.0581 23656.8902  84.2%  3000 2335s
  5331  2752     cutoff   36      12844.0581 23271.5221  81.2%  3000 2362s
  5447  2764 21467.5385   18  460 12844.0581 23271.5221  81.2%  2998 2390s
  5552  2747 20412.0337   21  310 12844.0581 23271.5221  81.2%  3003 2414s
  5600  2769 19743.6752   22  274 12844.0581 23099.7048  79.8%  3017 2438s
  5666  2791 18412.9922   23  256 12844.0581 22997.7325  79.1%  3027 2467s
  5781  2814 17298.0412   24  205 12844.0581 22997.7325  79.1%  3024 2498s
  5897  2814 15661.7328   26  188 12844.0581 22720.8741  76.9%  3025 2534s
  6028  2815     cutoff   29      12844.0581 22696.1447  76.7%  3034 2579s
  6166  2826 infeasible   28      12844.0581 22585.2810  75.8%  3045 2618s
  6288  2855 18661.2755   19  416 12844.0581 22503.8122  75.2%  3064 2658s
  6437  2890 17093.8781   21  301 12844.0581 22503.8122  75.2%  3075 2703s
  6602  2856 16348.0311   23  384 12844.0581 22070.0240  71.8%  3081 2736s
  6648  2891     cutoff   24      12844.0581 22070.0240  71.8%  3091 2778s
  6783  2893 13798.8731   25  406 12844.0581 22070.0240  71.8%  3084 2829s
  6951  2922 13286.4801   27  334 12844.0581 22070.0240  71.8%  3088 2885s
  7130  2952 17375.3306   21  456 12844.0581 22070.0240  71.8%  3099 2931s
  7335  2973 15253.9502   25  267 12844.0581 22070.0240  71.8%  3104 2983s
  7567  2984 13292.8021   29  115 12844.0581 22070.0240  71.8%  3099 3033s
  7809  2964 17608.0161   21  216 12844.0581 21694.6297  68.9%  3102 3082s
  7967  2961 14403.8736   24  323 12844.0581 21600.4962  68.2%  3116 3136s
  8206  2947     cutoff   29      12844.0581 21392.5236  66.6%  3114 3193s
  8407  3003 15778.0449   23  267 12844.0581 21371.8827  66.4%  3136 3247s
  8651  3050 13860.6569   28  113 12844.0581 21049.6020  63.9%  3144 3306s
  8988  3020 18647.2183   20  306 12844.0581 21009.8982  63.6%  3117 3364s
  9281  2999     cutoff   24      12844.0581 21009.8982  63.6%  3110 3426s
  9535  2976     cutoff   35      12844.0581 20853.3863  62.4%  3131 3490s
  9890  2916     cutoff   54      12844.0581 20636.6125  60.7%  3121 3563s
 10193  2831 16628.8760   25  243 12844.0581 20587.9063  60.3%  3132 3600s

Cutting planes:
  MIR: 701
  Mixing: 3
  Flow cover: 1416
  RLT: 18
  Relax-and-lift: 85

Explored 10401 nodes (32669119 simplex iterations) in 3600.05 seconds (6270.73 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12844.1 12792.3 12779.7 ... 9710.45

Time limit reached
Best objective 1.284405808826e+04, best bound 2.036360112587e+04, gap 58.5449%
  WARNING: Time limit reached. Using best solution found (gap: 58.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 12844.06, θ = 160591.61
  Upper Bound (UB) = 12844.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160591.61
  [DEBUG]   ✓ Scenario 0: θ = 160591.61 ≤ Q = 160591.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160591.61 ≤ Q = 160591.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160591.61 ≤ Q = 160591.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160591.61 ≤ Q = 160591.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160591.61 ≤ Q = 160591.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160591.61 ≤ Q = 160591.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160591.61 ≤ Q = 160591.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x579c60ac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x579c60ac
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.305532e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6687490.7344
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.571288e+05, 274 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157128.79    0  138 6687490.73 -157128.79   102%     -    0s
H    0     0                    -117935.5696 -157128.79  33.2%     -    0s
H    0     0                    -118103.4710 -157128.79  33.0%     -    0s
H    0     0                    -126728.1077 -138685.32  9.44%     -    0s
H    0     0                    -132795.1043 -138685.32  4.44%     -    0s
     0     0 -138685.32    0   57 -132795.10 -138685.32  4.44%     -    0s
H    0     0                    -137434.5711 -138640.76  0.88%     -    0s
H    0     0                    -138316.7505 -138495.42  0.13%     -    0s
     0     0 -138446.68    0   14 -138316.75 -138446.68  0.09%     -    0s
     0     0 -138424.75    0   12 -138316.75 -138424.75  0.08%     -    0s
     0     0 -138416.39    0   10 -138316.75 -138416.39  0.07%     -    0s
     0     0 -138408.37    0    9 -138316.75 -138408.37  0.07%     -    0s
     0     0 -138389.82    0    9 -138316.75 -138389.82  0.05%     -    0s
     0     0 -138380.08    0    8 -138316.75 -138380.08  0.05%     -    0s
     0     0 -138378.04    0    8 -138316.75 -138378.04  0.04%     -    0s
     0     0          -    0      -138316.75 -138330.40  0.01%     -    0s

Cutting planes:
  Gomory: 22
  MIR: 87
  RLT: 46

Explored 1 nodes (520 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -138317 -137435 -132795 ... 1.30553e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.383167504757e+05, best bound -1.383304026505e+05, gap 0.0099%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 144026.85
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138316.75
  [DEBUG]   S×d_nominal = 282343.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282343.60 + -138316.75 = 144026.85
  [DEBUG]   Current θ from Master = 160591.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16564.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3720.71
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3502.2705, Absolute Gap = 3502.2705, Relative Gap = 0.272676
  Not converged yet (gap = 3502.27 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0x7688a44e
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 2.33s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25251   -1.4618303e+05   0.000000e+00   2.487190e+07      5s
   38496   -1.2156577e+04   0.000000e+00   9.277608e+06     10s
   47950   -2.8557158e+03   0.000000e+00   4.789232e+06     15s
   54972    4.1601988e+02   0.000000e+00   5.274390e+06     20s
   59754    1.2241773e+03   0.000000e+00   8.151205e+06     25s
   64891    2.3642652e+03   0.000000e+00   4.440992e+06     30s
   68611    2.6697520e+03   0.000000e+00   4.467014e+08     35s
   75189    7.0247901e+03   0.000000e+00   3.359229e+08     40s
   80439    1.2258709e+04   0.000000e+00   1.309869e+06     45s
   85986    1.3885418e+04   0.000000e+00   1.002379e+07     50s
   91017    1.4784797e+04   0.000000e+00   7.812787e+05     55s
   95785    1.6213082e+04   0.000000e+00   2.628798e+06     60s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.833688e+04, 59652 iterations, 57.66 seconds (74.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38336.8816    0  206 -219144.29 38336.8816   117%     -   61s
H    0     0                    -211639.7960 38336.8816   118%     -   61s
H    0     0                    -173456.2218 38336.8816   122%     -   61s
H    0     0                    -161628.3842 38336.8816   124%     -   61s
H    0     0                    -155996.2087 38336.8816   125%     -   62s
H    0     0                    -64387.79909 38336.8816   160%     -   62s
H    0     0                    -19052.23054 38336.8816   301%     -   62s
H    0     0                    -10238.59157 38336.8816   474%     -   62s
H    0     0                    -9759.173244 38336.8816   493%     -   62s
H    0     0                    -9641.899146 38336.8816   498%     -   62s
     0     0 34291.8020    0  306 -9641.8991 34291.8020   456%     -   86s
H    0     0                    -7853.458403 34291.4092   537%     -   86s
H    0     0                    -5625.628143 34291.4092   710%     -   86s
H    0     0                    -3345.539511 34291.4092  1125%     -   86s
     0     0 33578.5801    0  301 -3345.5395 33578.5801  1104%     -   97s
     0     0 33314.7698    0  303 -3345.5395 33314.7698  1096%     -  104s
     0     0 33233.1270    0  304 -3345.5395 33233.1270  1093%     -  109s
     0     0 33106.8113    0  310 -3345.5395 33106.8113  1090%     -  111s
     0     0 33106.8113    0  303 -3345.5395 33106.8113  1090%     -  115s
     0     0 33105.0474    0  323 -3345.5395 33105.0474  1090%     -  122s
     0     0 33102.5647    0  314 -3345.5395 33102.5647  1089%     -  122s
     0     0 33102.5423    0  314 -3345.5395 33102.5423  1089%     -  123s
H    0     0                    -385.0601942 31144.7915  8188%     -  154s
     0     0 31144.7915    0  303 -385.06019 31144.7915  8188%     -  154s
H    0     0                    5625.4094523 31144.5902   454%     -  155s
H    0     0                    5634.7400407 31144.5902   453%     -  155s
     0     0 30861.4167    0  326 5634.74004 30861.4167   448%     -  164s
     0     0 30658.8934    0  297 5634.74004 30658.8934   444%     -  171s
     0     0 30584.5522    0  339 5634.74004 30584.5522   443%     -  175s
     0     0 30311.5725    0  368 5634.74004 30311.5725   438%     -  186s
     0     0 30268.2227    0  372 5634.74004 30268.2227   437%     -  189s
     0     0 30250.6826    0  337 5634.74004 30250.6826   437%     -  192s
     0     0 30248.8684    0  344 5634.74004 30248.8684   437%     -  193s
     0     0 30237.8064    0  336 5634.74004 30237.8064   437%     -  194s
     0     0 30235.3661    0  338 5634.74004 30235.3661   437%     -  196s
     0     0 30233.6719    0  381 5634.74004 30233.6719   437%     -  197s
     0     0 30233.0319    0  384 5634.74004 30233.0319   437%     -  198s
     0     0 29206.8330    0  348 5634.74004 29206.8330   418%     -  230s
H    0     0                    6286.6714834 29206.5533   365%     -  231s
     0     0 28764.1088    0  344 6286.67148 28764.1088   358%     -  242s
     0     0 28585.8161    0  397 6286.67148 28585.8161   355%     -  252s
     0     0 28523.3445    0  400 6286.67148 28523.3445   354%     -  259s
     0     0 28433.3225    0  360 6286.67148 28433.3225   352%     -  265s
     0     0 28413.9970    0  364 6286.67148 28413.9970   352%     -  268s
H    0     0                    7775.5916035 28408.1212   265%     -  270s
H    0     0                    7782.3097510 28408.1212   265%     -  270s
     0     0 28408.1212    0  412 7782.30975 28408.1212   265%     -  270s
     0     0 28406.1050    0  368 7782.30975 28406.1050   265%     -  271s
     0     0 28404.8412    0  413 7782.30975 28404.8412   265%     -  272s
     0     0 28404.1179    0  417 7782.30975 28404.1179   265%     -  273s
H    0     0                    8217.2435827 28404.1179   246%     -  286s
H    0     0                    9046.0228967 28404.1179   214%     -  286s
     0     0 27842.5034    0  380 9046.02290 27842.5034   208%     -  300s
     0     0 27646.3068    0  401 9046.02290 27646.3068   206%     -  311s
     0     0 27541.2657    0  312 9046.02290 27541.2657   204%     -  316s
     0     0 27484.4452    0  316 9046.02290 27484.4452   204%     -  320s
     0     0 27463.4054    0  398 9046.02290 27463.4054   204%     -  323s
     0     0 27459.4984    0  312 9046.02290 27459.4984   204%     -  324s
     0     0 27452.7809    0  315 9046.02290 27452.7809   203%     -  325s
     0     0 27438.5334    0  318 9046.02290 27438.5334   203%     -  328s
     0     0 27433.5594    0  315 9046.02290 27433.5594   203%     -  329s
     0     0 27430.2112    0  314 9046.02290 27430.2112   203%     -  330s
     0     0 27402.7724    0  318 9046.02290 27402.7724   203%     -  332s
     0     0 27397.2289    0  324 9046.02290 27397.2289   203%     -  333s
     0     0 27390.8118    0  355 9046.02290 27390.8118   203%     -  335s
     0     0 27387.4995    0  361 9046.02290 27387.4995   203%     -  336s
     0     0 27385.9359    0  352 9046.02290 27385.9359   203%     -  337s
     0     0 27385.6963    0  358 9046.02290 27385.6963   203%     -  337s
     0     0 27301.2668    0  429 9046.02290 27301.2668   202%     -  344s
H    0     0                    9135.6547011 27300.7176   199%     -  345s
H    0     0                    9191.3037956 27300.7176   197%     -  345s
     0     0 27281.2271    0  373 9191.30380 27281.2271   197%     -  347s
     0     0 27259.9773    0  423 9191.30380 27259.9773   197%     -  350s
     0     0 27253.4100    0  431 9191.30380 27253.4100   197%     -  352s
     0     0 27242.0127    0  421 9191.30380 27242.0127   196%     -  353s
     0     0 27241.4013    0  425 9191.30380 27241.4013   196%     -  354s
     0     0 27159.9033    0  429 9191.30380 27159.9033   195%     -  361s
     0     0 27141.0544    0  463 9191.30380 27141.0544   195%     -  369s
     0     0 27136.2805    0  466 9191.30380 27136.2805   195%     -  370s
     0     0 27133.8678    0  467 9191.30380 27133.8678   195%     -  371s
     0     0 27126.1990    0  437 9191.30380 27126.1990   195%     -  372s
     0     0 27124.8643    0  431 9191.30380 27124.8643   195%     -  373s
     0     0 27121.9963    0  432 9191.30380 27121.9963   195%     -  374s
     0     0 27120.5990    0  473 9191.30380 27120.5990   195%     -  375s
     0     0 27118.0933    0  473 9191.30380 27118.0933   195%     -  376s
     0     0 27115.2360    0  441 9191.30380 27115.2360   195%     -  378s
     0     0 27114.8309    0  448 9191.30380 27114.8309   195%     -  378s
     0     0 27090.5069    0  485 9191.30380 27090.5069   195%     -  384s
     0     0 27082.4257    0  488 9191.30380 27082.4257   195%     -  387s
     0     0 27076.6774    0  450 9191.30380 27076.6774   195%     -  388s
     0     0 27073.5320    0  447 9191.30380 27073.5320   195%     -  390s
     0     0 27068.0269    0  438 9191.30380 27068.0269   194%     -  391s
     0     0 27066.3988    0  438 9191.30380 27066.3988   194%     -  392s
     0     0 27064.1166    0  478 9191.30380 27064.1166   194%     -  393s
     0     0 27062.5324    0  444 9191.30380 27062.5324   194%     -  394s
     0     0 27062.1085    0  448 9191.30380 27062.1085   194%     -  394s
     0     0 27041.1764    0  408 9191.30380 27041.1764   194%     -  400s
     0     0 27031.0329    0  443 9191.30380 27031.0329   194%     -  404s
     0     0 27015.7781    0  481 9191.30380 27015.7781   194%     -  408s
     0     0 27013.4232    0  485 9191.30380 27013.4232   194%     -  409s
     0     0 27012.8695    0  474 9191.30380 27012.8695   194%     -  409s
     0     0 26998.5812    0  408 9191.30380 26998.5812   194%     -  413s
H    0     0                    9239.8497823 26998.5371   192%     -  414s
H    0     0                    9304.8574305 26998.5371   190%     -  414s
     0     0 26996.7242    0  439 9304.85743 26996.7242   190%     -  416s
     0     0 26994.5487    0  434 9304.85743 26994.5487   190%     -  417s
     0     0 26990.1035    0  434 9304.85743 26990.1035   190%     -  419s
     0     0 26989.5295    0  443 9304.85743 26989.5295   190%     -  419s
     0     0 26978.3436    0  449 9304.85743 26978.3436   190%     -  424s
H    0     0                    9307.3417560 26977.3483   190%     -  427s
     0     0 26973.9353    0  417 9307.34176 26973.9353   190%     -  428s
     0     0 26972.4250    0  418 9307.34176 26972.4250   190%     -  429s
     0     0 26971.7794    0  419 9307.34176 26971.7794   190%     -  429s
     0     0 26964.6474    0  421 9307.34176 26964.6474   190%     -  433s
     0     0 26962.1267    0  463 9307.34176 26962.1267   190%     -  434s
     0     0 26961.6311    0  463 9307.34176 26961.6311   190%     -  435s
     0     0 26958.1456    0  415 9307.34176 26958.1456   190%     -  437s
     0     0 26956.4328    0  426 9307.34176 26956.4328   190%     -  454s
     0     0 26955.1732    0  418 9307.34176 26955.1732   190%     -  455s
     0     0 26954.2094    0  418 9307.34176 26954.2094   190%     -  458s
     0     0 26954.1909    0  418 9307.34176 26954.1909   190%     -  460s
     0     2 26954.1909    0  418 9307.34176 26954.1909   190%     -  524s
     1     4 26939.0525    1  454 9307.34176 26954.1909   190%  1692  534s
     3     8 26851.8274    2  452 9307.34176 26939.0352   189%  4342  555s
     7    16 26794.4273    3  478 9307.34176 26851.4134   188%  7295  572s
    15    32 26675.2462    4  490 9307.34176 26791.9208   188%  8762  587s
    31    48 25801.8054    5  359 9307.34176 26675.1843   187% 10836  626s
    47    80 24803.4897    6  413 9307.34176 26675.1843   187% 13173  649s
    79   118 24715.6635    7  401 9307.34176 26675.1843   187% 10301  695s
H   97   118                    9308.8219472 26675.1843   187%  9031  695s
H  117   228                    9316.1405218 26675.1843   186%  8425  731s
H  169   228                    9322.2017200 26675.1843   186%  7103  731s
H  201   228                    9329.5202945 26675.1843   186%  6662  731s
   227   312 24543.2700   10  392 9329.52029 26675.1843   186%  6355  755s
   311   396 22852.7484   11  294 9329.52029 26675.1843   186%  5563  776s
   395   482 24129.9847   10  357 9329.52029 26675.1843   186%  5092  791s
   481   533 23446.4927   11  353 9329.52029 26675.1843   186%  4708  805s
   532   611 20305.0257   21  255 9329.52029 26675.1843   186%  4560  820s
   610   647 22974.4200   11  299 9329.52029 26675.1843   186%  4282  834s
   654   710 19936.4933   23  289 9329.52029 26675.1843   186%  4276  853s
   727   773 23285.3570   11  349 9329.52029 26675.1843   186%  4216  866s
   796   829 19498.1048   25  315 9329.52029 26675.1843   186%  4161  882s
   874   857 22646.8748   12  296 9329.52029 26675.1843   186%  4118  896s
   910   889 17366.3529   12  313 9329.52029 26675.1843   186%  4132  911s
   949   916 23273.2161   12  341 9329.52029 26675.1843   186%  4158  925s
   982   959 18442.7596   29  242 9329.52029 26675.1843   186%  4221  942s
H 1023   959                    9332.8921963 26675.1843   186%  4236  942s
H 1025   959                    10424.595318 26675.1843   156%  4248  942s
  1035   988 22664.0248   13  238 10424.5953 26675.1843   156%  4237  959s
H 1045   988                    11274.311071 26675.1843   137%  4215  959s
  1095  1047 22346.9675   14  288 11274.3111 26675.1843   137%  4256  977s
  1184  1120 22262.0073   15  296 11274.3111 26675.1843   137%  4270  996s
  1275  1149 22005.4014   17  332 11274.3111 26675.1843   137%  4327 1016s
H 1276  1149                    11548.385602 26675.1843   131%  4323 1016s
H 1291  1149                    11636.189474 26675.1843   129%  4339 1016s
  1312  1234 21869.4262   18  304 11636.1895 26675.1843   129%  4351 1034s
  1413  1343 21835.2640   19  295 11636.1895 26675.1843   129%  4334 1054s
  1538  1418 21572.8055   20  287 11636.1895 26675.1843   129%  4285 1073s
  1653  1488 21563.2641   19  309 11636.1895 26675.1843   129%  4291 1094s
  1775  1511 21496.0678   21  324 11636.1895 26675.1843   129%  4271 1114s
H 1782  1511                    11647.617294 26675.1843   129%  4276 1114s
  1834  1583 21436.4016   22  237 11647.6173 26675.1843   129%  4308 1135s
  1962  1648 21209.3961   22  279 11647.6173 26675.1843   129%  4292 1158s
  2079  1736 20825.7395   23  281 11647.6173 26675.1843   129%  4311 1182s
  2211  1811 20319.0891   24  318 11647.6173 26306.8998   126%  4311 1205s
  2357  1832 19361.1757   25  283 11647.6173 26303.9626   126%  4316 1229s
  2473  1906 19567.9445   28  310 11647.6173 26303.9626   126%  4319 1255s
  2589  1998 19213.1950   31  235 11647.6173 26303.9626   126%  4366 1283s
  2741  2084 17504.2128   34  102 11647.6173 26303.9626   126%  4373 1312s
  2875  2161 15855.8728   35  106 11647.6173 26303.9626   126%  4409 1340s
  3021  2245 17797.7566   38  247 11647.6173 25288.6510   117%  4434 1368s
  3217  2312 16594.1506   46  192 11647.6173 25219.0199   117%  4384 1399s
  3348  2373 13752.9544   47  121 11647.6173 25215.1420   116%  4450 1429s
  3431  2486 13728.1279   53  150 11647.6173 25215.1420   116%  4493 1456s
H 3575  2467                    11848.141486 24937.2278   110%  4494 1456s
  3582  2572 13321.6186   63  154 11848.1415 24937.2278   110%  4498 1490s
  3747  2670 14240.4834   24  234 11848.1415 24937.2278   110%  4518 1525s
H 3899  2658                    11914.696625 24937.2278   109%  4567 1543s
H 3899  2650                    12012.289798 24937.2278   108%  4567 1546s
H 3899  2618                    12147.969286 24937.2278   105%  4567 1549s
  3900  2619 13021.1125   26  418 12147.9693 24937.2278   105%  4566 1633s
  3902  2620 19737.3670   27  206 12147.9693 24937.2278   105%  4563 1688s
  3903  2621 13914.6108   48  376 12147.9693 24937.2278   105%  4562 1747s
  3904  2622 20100.7134   28  347 12147.9693 24937.2278   105%  4561 1768s
H 3904  2490                    12160.557970 24937.2278   105%  4561 1783s
  3906  2491 14460.5621   30  389 12160.5580 24937.2278   105%  4559 1795s
  3907  2492 13371.1063   53  464 12160.5580 24937.2278   105%  4558 1806s
  3908  2492 24201.8826    9  472 12160.5580 24937.2278   105%  4556 1815s
  3909  2493 16157.1138   35  454 12160.5580 24937.2278   105%  4555 1820s
  3910  2494 13798.0932   23  447 12160.5580 24937.2278   105%  4554 1826s
  3911  2494 14373.0638   38  443 12160.5580 24937.2278   105%  4553 1831s
H 3911  2369                    12169.735657 24937.2278   105%  4553 1836s
  3913  2371 17983.9732   28  416 12169.7357 24937.2278   105%  4551 1842s
  3915  2372 14168.6365   38  419 12169.7357 24937.2278   105%  4548 1848s
  3916  2373 18893.0693   28  347 12169.7357 24937.2278   105%  4547 1855s
  3918  2374 21127.2996   17  409 12169.7357 24937.2278   105%  4545 1861s
  3919  2375 12300.5720   44  406 12169.7357 24937.2278   105%  4544 1869s
  3920  2375 12898.6962   68  409 12169.7357 24937.2278   105%  4542 1870s
  3922  2377 19091.4226   36  454 12169.7357 24937.2278   105%  4540 1881s
  3924  2378 15206.6861   42  393 12169.7357 24937.2278   105%  4538 1892s
  3925  2379 23129.5259   16  363 12169.7357 24937.2278   105%  4537 1895s
  3926  2379 14994.1650   43  394 12169.7357 24937.2278   105%  4535 1904s
  3927  2380 13923.6168   25  453 12169.7357 24937.2278   105%  4534 1909s
  3928  2381 13658.6179   18  365 12169.7357 24937.2278   105%  4533 1915s
  3930  2382 16511.6428   39  449 12169.7357 24937.2278   105%  4531 1925s
  3932  2383 14839.2657   22  473 12169.7357 24937.2278   105%  4529 1934s
  3933  2384 19741.2274   17  470 12169.7357 24937.2278   105%  4527 1937s
  3934  2385 18977.2441   29  474 12169.7357 24937.2278   105%  4526 1942s
  3935  2385 12377.7627   34  474 12169.7357 24937.2278   105%  4525 1995s
  3936  2386 16192.3511   23  474 12169.7357 24937.2278   105%  4524 2034s
  3937  2390 24937.2278   11  413 12169.7357 24937.2278   105%  4581 2134s
  3939  2393 24937.2278   12  385 12169.7357 24937.2278   105%  4580 2161s
  3943  2400 24937.2278   13  451 12169.7357 24937.2278   105%  4583 2183s
  3951  2413 24937.2278   14  498 12169.7357 24937.2278   105%  4592 2220s
  3967  2424 24728.7829   15  453 12169.7357 24937.2278   105%  4633 2285s
  3983  2450 22447.1217   16  433 12169.7357 24937.2278   105%  4662 2319s
  4015  2526 21849.5301   17  365 12169.7357 24937.2278   105%  4695 2360s
  4105  2545 21322.1458   20  371 12169.7357 24937.2278   105%  4762 2392s
  4154  2602 21254.9177   18  395 12169.7357 24937.2278   105%  4762 2425s
  4232  2620 21054.2198   21  302 12169.7357 24937.2278   105%  4755 2454s
  4282  2631 20540.8845   20  270 12169.7357 24937.2278   105%  4739 2487s
  4314  2647 20446.4501   21  347 12169.7357 24937.2278   105%  4740 2513s
  4352  2667 16996.9146   21  353 12169.7357 24937.2278   105%  4741 2545s
  4390  2690 16578.9543   20  359 12169.7357 24937.2278   105%  4734 2574s
  4442  2705 17494.4646   21  341 12169.7357 24937.2278   105%  4724 2599s
  4509  2730 20857.3039   22  291 12169.7357 24937.2278   105%  4708 2624s
  4581  2749 18631.1202   22  258 12169.7357 24937.2278   105%  4682 2650s
  4653  2749 19542.7926   23  284 12169.7357 24937.2278   105%  4662 2676s
  4724  2749 19501.9722   24  287 12169.7357 24937.2278   105%  4637 2697s
  4799  2735     cutoff   44      12169.7357 24937.2278   105%  4614 2718s
  4864  2712 18671.6556   25  288 12169.7357 24937.2278   105%  4593 2743s
  4927  2699 17927.0406   26  237 12169.7357 24937.2278   105%  4583 2771s
  4991  2701 12781.6655   26  253 12169.7357 24937.2278   105%  4576 2818s
  5064  2709 17241.3384   27  325 12169.7357 24937.2278   105%  4561 2848s
  5141  2696 16158.2592   28  303 12169.7357 24937.2278   105%  4547 2884s
  5233  2697 13771.2836   29  284 12169.7357 24937.2278   105%  4533 2915s
  5299  2712 14615.4051   28  329 12169.7357 24937.2278   105%  4535 2947s
  5369  2731 13124.9754   30  335 12169.7357 24937.2278   105%  4542 2979s
  5437  2750 13109.2272   31  334 12169.7357 24937.2278   105%  4553 3013s
  5510  2774 13184.1521   32  162 12169.7357 24937.2278   105%  4549 3049s
  5586  2788 infeasible   33      12169.7357 24937.2278   105%  4549 3084s
  5682  2773 21862.9806   17  437 12169.7357 24937.2278   105%  4549 3116s
  5745  2794 21533.0646   18  410 12169.7357 24937.2278   105%  4547 3150s
  5853  2794 21102.7744   19  381 12169.7357 24937.2278   105%  4526 3191s
  5948  2821 16344.1235   20  407 12169.7357 24937.2278   105%  4524 3237s
  6051  2822 15398.4507   22  378 12169.7357 24937.2278   105%  4527 3293s
  6133  2827 13455.6200   23  429 12169.7357 24041.2249  97.5%  4520 3337s
  6231  2845 13318.4022   24  386 12169.7357 24041.2249  97.5%  4518 3380s
  6337  2852 12939.3322   25  294 12169.7357 24041.2249  97.5%  4517 3430s
  6457  2896 16528.6549   20  466 12169.7357 24041.2249  97.5%  4512 3475s
  6599  2907 12789.5561   22  458 12169.7357 24041.2249  97.5%  4494 3534s
  6749  2944 infeasible   24      12169.7357 22856.5436  87.8%  4479 3590s
  6907  2902 infeasible   21      12169.7357 22844.2516  87.7%  4471 3600s

Cutting planes:
  Learned: 2
  MIR: 718
  Mixing: 2
  Flow cover: 1630
  RLT: 13
  Relax-and-lift: 141

Explored 6930 nodes (31268252 simplex iterations) in 3600.06 seconds (6151.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12169.7 12160.6 12148 ... 11274.3

Time limit reached
Best objective 1.216973565732e+04, best bound 2.284425164222e+04, gap 87.7136%
  WARNING: Time limit reached. Using best solution found (gap: 87.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 12169.74, θ = 160277.34
  Upper Bound (UB) = 12169.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160277.34
  [DEBUG]   ✓ Scenario 0: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6b2e6eef
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x94d19111
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-13, 2e+02]
Found heuristic solution: objective 1.316019e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6757991.5342
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.556714e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155671.38    0  132 6757991.53 -155671.38   102%     -    0s
H    0     0                    -117350.7404 -155671.38  32.7%     -    0s
H    0     0                    -118169.7874 -155671.38  31.7%     -    0s
     0     0 -132311.83    0   63 -118169.79 -132311.83  12.0%     -    0s
H    0     0                    -129320.7539 -132193.33  2.22%     -    0s
H    0     0                    -129649.5559 -132193.33  1.96%     -    0s
H    0     0                    -130269.9298 -132193.33  1.48%     -    0s
H    0     0                    -130598.7317 -132193.33  1.22%     -    0s
     0     0 -132106.28    0   60 -130598.73 -132106.28  1.15%     -    0s
     0     0 -131569.43    0   47 -130598.73 -131569.43  0.74%     -    0s
     0     0 -131525.54    0   47 -130598.73 -131525.54  0.71%     -    0s
     0     0 -131513.62    0   47 -130598.73 -131513.62  0.70%     -    0s
     0     0 -131364.71    0   47 -130598.73 -131364.71  0.59%     -    0s
     0     0 -131336.70    0   47 -130598.73 -131336.70  0.57%     -    0s
     0     0 -131259.09    0   47 -130598.73 -131259.09  0.51%     -    0s
H    0     0                    -130686.3743 -131259.09  0.44%     -    0s
     0     0 -131107.42    0   40 -130686.37 -131107.42  0.32%     -    0s
     0     0 -131089.59    0   30 -130686.37 -131089.59  0.31%     -    0s
     0     0 -131088.83    0   30 -130686.37 -131088.83  0.31%     -    0s
     0     0 -131088.83    0   58 -130686.37 -131088.83  0.31%     -    0s
     0     0 -131088.83    0   58 -130686.37 -131088.83  0.31%     -    0s
     0     0 -131084.74    0   21 -130686.37 -131084.74  0.30%     -    0s
     0     0 -130953.03    0   15 -130686.37 -130953.03  0.20%     -    0s
     0     0 -130890.39    0   14 -130686.37 -130890.39  0.16%     -    0s
     0     0 -130850.64    0   15 -130686.37 -130850.64  0.13%     -    0s
     0     0 -130850.64    0   15 -130686.37 -130850.64  0.13%     -    0s
H    0     0                    -130686.6909 -130850.64  0.13%     -    0s
     0     0 -130850.64    0   15 -130686.69 -130850.64  0.13%     -    0s
H    0     0                    -130716.9872 -130850.64  0.10%     -    0s
     0     0 -130780.44    0    7 -130716.99 -130780.44  0.05%     -    0s
     0     0 -130780.25    0    5 -130716.99 -130780.25  0.05%     -    0s
H    0     0                    -130764.9027 -130770.43  0.00%     -    0s

Cutting planes:
  Gomory: 20
  Implied bound: 23
  MIR: 16
  Flow cover: 9
  RLT: 7
  Relax-and-lift: 6

Explored 1 nodes (921 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -130765 -130717 -130687 ... 1.31602e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.307649026990e+05, best bound -1.307704348933e+05, gap 0.0042%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 151640.71
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130764.90
  [DEBUG]   S×d_nominal = 282405.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282405.62 + -130764.90 = 151640.71
  [DEBUG]   Current θ from Master = 160277.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8636.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3533.11
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2827.9481, Absolute Gap = 2827.9481, Relative Gap = 0.232375
  Not converged yet (gap = 2827.95 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0xb2391c18
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 2.68s
Presolved: 81726 rows, 35173 columns, 500096 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346845.8465
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.397e+06
 Factor NZ  : 7.331e+06 (roughly 100 MB of memory)
 Factor Ops : 1.231e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.40394753e+07  1.61726904e+08  9.08e+04 2.11e+01  7.16e+04     4s
   1  -1.04210051e+07  1.39421138e+08  6.20e+04 6.45e+01  4.83e+04     4s
   2  -3.34999646e+06  1.06494300e+08  1.97e+04 8.81e-12  1.63e+04     4s
   3  -8.32929532e+05  7.64689339e+07  2.44e+03 1.70e-11  2.36e+03     4s
   4  -4.48877935e+05  2.23714775e+07  4.10e+02 3.06e-02  4.19e+02     4s
   5  -2.70459416e+05  1.58422744e+07  8.12e+01 2.72e-02  1.56e+02     5s
   6  -1.52661908e+05  9.99600723e+06  3.27e+01 1.55e-02  8.34e+01     5s
   7  -1.22525931e+05  8.83353522e+06  2.21e+01 1.33e-02  6.94e+01     5s
   8  -9.78060545e+04  6.71012285e+06  7.64e+00 9.74e-03  4.81e+01     5s
   9  -8.50277000e+04  4.43920348e+06  4.70e+00 6.32e-03  3.13e+01     5s
  10  -6.10368817e+04  8.80331676e+05  1.39e+00 1.14e-03  6.36e+00     5s
  11  -3.40519609e+04  3.17986993e+05  6.54e-01 4.31e-04  2.36e+00     5s
  12  -1.60913314e+04  2.01597947e+05  4.54e-01 4.21e-04  1.46e+00     5s
  13  -2.67522794e+03  1.36682372e+05  3.37e-01 9.42e-04  9.34e-01     5s
  14   5.30901992e+03  1.14857691e+05  2.74e-01 1.09e-03  7.34e-01     5s
  15   1.19571993e+04  9.73340075e+04  2.21e-01 2.15e-03  5.72e-01     5s
  16   1.55761731e+04  7.61568325e+04  1.89e-01 1.42e-03  4.07e-01     5s
  17   2.17250831e+04  6.89951972e+04  1.44e-01 2.03e-03  3.17e-01     5s
  18   2.65368851e+04  6.45740136e+04  1.11e-01 1.71e-03  2.55e-01     5s
  19   2.95053288e+04  6.05412975e+04  9.14e-02 1.12e-03  2.08e-01     5s
  20   3.21612267e+04  5.55709855e+04  7.52e-02 1.76e-03  1.57e-01     5s
  21   3.64652918e+04  5.35283106e+04  5.04e-02 1.02e-03  1.14e-01     5s
  22   3.69799441e+04  5.07681645e+04  4.77e-02 2.36e-03  9.26e-02     5s
  23   3.82613556e+04  4.97561253e+04  4.06e-02 1.31e-03  7.72e-02     6s
  24   4.14006785e+04  4.87473552e+04  2.39e-02 1.14e-03  4.93e-02     6s
  25   4.18478044e+04  4.81460746e+04  2.17e-02 9.59e-04  4.23e-02     6s
  26   4.28711066e+04  4.78098045e+04  1.65e-02 8.37e-04  3.31e-02     6s
  27   4.39616096e+04  4.71624154e+04  1.10e-02 4.97e-04  2.15e-02     6s
  28   4.47180880e+04  4.69874609e+04  7.27e-03 4.23e-04  1.52e-02     6s
  29   4.53006289e+04  4.66908004e+04  4.47e-03 2.41e-04  9.33e-03     6s
  30   4.54893579e+04  4.66004244e+04  3.55e-03 2.04e-04  7.45e-03     6s
  31   4.56533774e+04  4.65470600e+04  2.77e-03 1.71e-04  5.99e-03     6s
  32   4.58287661e+04  4.64530356e+04  1.95e-03 2.09e-04  4.19e-03     6s
  33   4.59973561e+04  4.63865023e+04  1.15e-03 1.30e-04  2.61e-03     6s
  34   4.61142923e+04  4.63247008e+04  6.53e-04 3.76e-05  1.41e-03     6s
  35   4.61889211e+04  4.63008150e+04  3.34e-04 1.93e-05  7.50e-04     6s
  36   4.62042780e+04  4.62867650e+04  2.74e-04 8.18e-06  5.54e-04     7s
  37   4.62409581e+04  4.62808471e+04  1.30e-04 3.59e-06  2.68e-04     7s
  38   4.62720319e+04  4.62797723e+04  1.16e-05 2.68e-06  5.17e-05     7s
  39   4.62757479e+04  4.62770799e+04  9.65e-07 5.97e-07  8.88e-06     7s
  40   4.62760794e+04  4.62762592e+04  3.23e-07 1.92e-10  1.20e-06     7s
  41   4.62762384e+04  4.62762542e+04  7.81e-08 9.66e-11  1.06e-07     7s
  42   4.62762515e+04  4.62762515e+04  4.33e-09 1.79e-10  2.59e-10     7s

Barrier solved model in 42 iterations and 7.02 seconds (6.43 work units)
Optimal objective 4.62762515e+04


Root crossover log...

   72750 DPushes remaining with DInf 0.0000000e+00                 7s
    3339 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    1843 PPushes remaining with PInf 2.8293091e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.6864766e+00     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40430    4.6276252e+04   0.000000e+00   6.686477e+00     12s
   40446    4.6276252e+04   0.000000e+00   0.000000e+00     12s
   40446    4.6276252e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.19s

Solved with barrier

Root relaxation: objective 4.627625e+04, 40446 iterations, 8.63 seconds (12.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46276.2515    0  230 -219144.29 46276.2515   121%     -   12s
H    0     0                    -214512.9736 46276.2515   122%     -   12s
H    0     0                    -157950.2464 46276.2515   129%     -   13s
H    0     0                    -155311.7792 46276.2515   130%     -   13s
H    0     0                    -154288.9545 46276.2515   130%     -   13s
H    0     0                    -153535.6000 46276.2515   130%     -   13s
H    0     0                    -153501.8833 46276.2515   130%     -   13s
H    0     0                    -31223.69936 46276.2515   248%     -   13s
H    0     0                    -11077.16405 46276.2515   518%     -   13s
H    0     0                    -8948.440566 46276.2515   617%     -   13s
H    0     0                    -8878.393674 46276.2515   621%     -   14s
H    0     0                    -7930.247468 46276.2515   684%     -   14s
H    0     0                    -7580.154134 38838.9163   612%     -   65s
H    0     0                    -7445.656649 38838.9163   622%     -   65s
     0     0 38835.2951    0  347 -7445.6566 38835.2951   622%     -   66s
     0     0 38272.1142    0  341 -7445.6566 38272.1142   614%     -   85s
     0     0 38202.0649    0  346 -7445.6566 38202.0649   613%     -   94s
     0     0 38116.9252    0  353 -7445.6566 38116.9252   612%     -  100s
     0     0 38116.9252    0  365 -7445.6566 38116.9252   612%     -  105s
     0     0 38102.0823    0  354 -7445.6566 38102.0823   612%     -  113s
     0     0 38102.0823    0  351 -7445.6566 38102.0823   612%     -  115s
     0     0 38001.6393    0  349 -7445.6566 38001.6393   610%     -  124s
     0     0 37991.0608    0  353 -7445.6566 37991.0608   610%     -  127s
     0     0 37989.8245    0  356 -7445.6566 37989.8245   610%     -  128s
     0     0 37989.7975    0  356 -7445.6566 37989.7975   610%     -  129s
H    0     0                    -7234.338046 33350.7949   561%     -  194s
H    0     0                    -7121.621692 33350.7949   568%     -  194s
H    0     0                    -7108.716537 33350.7949   569%     -  194s
     0     0 33350.7949    0  362 -7108.7165 33350.7949   569%     -  194s
H    0     0                    -2755.072596 33350.7348  1311%     -  194s
H    0     0                    -1741.168987 33350.7348  2015%     -  195s
H    0     0                    -888.3161912 33350.7348  3854%     -  195s
H    0     0                    -738.4232490 33350.7348  4616%     -  195s
H    0     0                    -531.2621650 33350.7348  6378%     -  195s
H    0     0                    -489.8408876 33350.7348  6908%     -  195s
H    0     0                    -364.8450398 33350.7348  9241%     -  195s
     0     0 32516.2634    0  376 -364.84504 32516.2634  9012%     -  218s
     0     0 32217.7584    0  365 -364.84504 32217.7584  8931%     -  231s
     0     0 31949.3729    0  380 -364.84504 31949.3729  8857%     -  247s
H    0     0                    2472.9737824 31895.8272  1190%     -  260s
H    0     0                    2885.9824099 31895.8272  1005%     -  260s
H    0     0                    3111.9258409 31895.8272   925%     -  260s
     0     0 31895.8272    0  375 3111.92584 31895.8272   925%     -  260s
H    0     0                    3290.3479872 31837.8426   868%     -  271s
H    0     0                    4182.3498377 31837.8426   661%     -  271s
     0     0 31837.8426    0  385 4182.34984 31837.8426   661%     -  271s
H    0     0                    5227.2808267 31811.7766   509%     -  276s
H    0     0                    5264.4541745 31811.7766   504%     -  276s
     0     0 31811.7766    0  374 5264.45417 31811.7766   504%     -  276s
H    0     0                    6741.6959979 31787.8819   372%     -  280s
H    0     0                    7302.0692090 31787.8819   335%     -  280s
H    0     0                    7330.0978486 31787.8819   334%     -  280s
     0     0 31787.8819    0  372 7330.09785 31787.8819   334%     -  280s
     0     0 31783.6824    0  386 7330.09785 31783.6824   334%     -  282s
     0     0 31768.8301    0  390 7330.09785 31768.8301   333%     -  283s
     0     0 31762.6187    0  386 7330.09785 31762.6187   333%     -  284s
     0     0 31762.4146    0  388 7330.09785 31762.4146   333%     -  285s
H    0     0                    7463.4946500 31762.4146   326%     -  302s
H    0     0                    8693.2374011 31762.4146   265%     -  302s
     0     0 29654.9745    0  363 8693.23740 29654.9745   241%     -  340s
H    0     0                    9218.9303843 29654.9740   222%     -  341s
H    0     0                    9707.3985485 29654.9740   205%     -  341s
     0     0 29243.2264    0  389 9707.39855 29243.2264   201%     -  366s
     0     0 29021.5672    0  342 9707.39855 29021.5672   199%     -  385s
     0     0 28955.6304    0  357 9707.39855 28955.6304   198%     -  398s
     0     0 28913.8088    0  357 9707.39855 28913.8088   198%     -  408s
     0     0 28898.1349    0  353 9707.39855 28898.1349   198%     -  417s
     0     0 28847.0212    0  349 9707.39855 28847.0212   197%     -  426s
H    0     0                    9747.0545224 28826.9475   196%     -  437s
H    0     0                    10850.062985 28826.9475   166%     -  437s
H    0     0                    10855.099407 28826.9475   166%     -  437s
H    0     0                    10862.081518 28826.9475   165%     -  437s
     0     0 28826.9475    0  325 10862.0815 28826.9475   165%     -  437s
     0     0 28805.1448    0  323 10862.0815 28805.1448   165%     -  442s
     0     0 28794.9108    0  367 10862.0815 28794.9108   165%     -  445s
     0     0 28790.1067    0  332 10862.0815 28790.1067   165%     -  448s
     0     0 28772.6238    0  326 10862.0815 28772.6238   165%     -  451s
     0     0 28768.6376    0  317 10862.0815 28768.6376   165%     -  453s
     0     0 28761.9151    0  322 10862.0815 28761.9151   165%     -  457s
     0     0 28761.3178    0  326 10862.0815 28761.3178   165%     -  459s
     0     0 27919.6396    0  434 10862.0815 27919.6396   157%     -  519s
H    0     0                    11035.537091 27733.0748   151%     -  532s
     0     0 27733.0748    0  386 11035.5371 27733.0748   151%     -  532s
     0     0 27673.4034    0  444 11035.5371 27673.4034   151%     -  540s
     0     0 27638.1324    0  440 11035.5371 27638.1324   150%     -  547s
     0     0 27620.1684    0  447 11035.5371 27620.1684   150%     -  550s
H    0     0                    11104.742486 27613.8012   149%     -  553s
     0     0 27613.8012    0  450 11104.7425 27613.8012   149%     -  553s
     0     0 27612.1185    0  451 11104.7425 27612.1185   149%     -  554s
     0     0 27507.4023    0  414 11104.7425 27507.4023   148%     -  567s
     0     0 27429.3089    0  422 11104.7425 27429.3089   147%     -  573s
     0     0 27398.6375    0  434 11104.7425 27398.6375   147%     -  576s
H    0     0                    11166.248268 27394.0130   145%     -  578s
     0     0 27394.0130    0  457 11166.2483 27394.0130   145%     -  578s
     0     0 27390.9012    0  460 11166.2483 27390.9012   145%     -  579s
     0     0 27389.8378    0  471 11166.2483 27389.8378   145%     -  580s
     0     0 27341.8080    0  391 11166.2483 27341.8080   145%     -  586s
H    0     0                    11326.665074 27341.1427   141%     -  590s
     0     0 27326.1677    0  386 11326.6651 27326.1677   141%     -  593s
     0     0 27295.6038    0  454 11326.6651 27295.6038   141%     -  598s
     0     0 27289.4451    0  429 11326.6651 27289.4451   141%     -  600s
     0     0 27288.1928    0  435 11326.6651 27288.1928   141%     -  602s
     0     0 27266.9089    0  418 11326.6651 27266.9089   141%     -  609s
H    0     0                    11455.025987 27264.9294   138%     -  609s
H    0     0                    11480.946570 27264.9294   137%     -  610s
H    0     0                    11564.389976 27264.9294   136%     -  610s
     0     0 27262.0566    0  422 11564.3900 27262.0566   136%     -  611s
     0     0 27253.6289    0  348 11564.3900 27253.6289   136%     -  613s
     0     0 27252.8589    0  344 11564.3900 27252.8589   136%     -  614s
     0     0 27237.9652    0  415 11564.3900 27237.9652   136%     -  619s
     0     0 27228.9080    0  423 11564.3900 27228.9080   135%     -  623s
     0     0 27222.7508    0  424 11564.3900 27222.7508   135%     -  625s
     0     0 27218.3415    0  467 11564.3900 27218.3415   135%     -  627s
     0     0 27216.3203    0  465 11564.3900 27216.3203   135%     -  629s
     0     0 27204.5571    0  398 11564.3900 27204.5571   135%     -  633s
     0     0 27184.3567    0  385 11564.3900 27184.3567   135%     -  638s
     0     0 27182.6293    0  423 11564.3900 27182.6293   135%     -  640s
     0     0 27170.9726    0  389 11564.3900 27170.9726   135%     -  646s
H    0     0                    11679.998075 27170.5711   133%     -  652s
H    0     0                    11689.458373 27170.5711   132%     -  653s
H    0     0                    11801.299309 27170.5711   130%     -  654s
     0     0 27168.7023    0  486 11801.2993 27168.7023   130%     -  656s
     0     0 27163.9167    0  443 11801.2993 27163.9167   130%     -  662s
H    0     0                    11819.739157 27163.2705   130%     -  663s
H    0     0                    11858.988424 27163.2705   129%     -  663s
     0     0 27162.5290    0  426 11858.9884 27162.5290   129%     -  664s
     0     0 27143.0536    0  338 11858.9884 27143.0536   129%     -  669s
     0     0 27128.1723    0  393 11858.9884 27128.1723   129%     -  689s
     0     0 27124.4981    0  354 11858.9884 27124.4981   129%     -  690s
     0     0 27116.5177    0  417 11858.9884 27116.5177   129%     -  693s
     0     0 27113.2381    0  417 11858.9884 27113.2381   129%     -  695s
     0     0 27111.3666    0  419 11858.9884 27111.3666   129%     -  695s
     0     0 27103.0392    0  348 11858.9884 27103.0392   129%     -  700s
     0     0 27098.8637    0  411 11858.9884 27098.8637   129%     -  702s
     0     0 27097.0320    0  467 11858.9884 27097.0320   128%     -  704s
     0     0 27093.7613    0  421 11858.9884 27093.7613   128%     -  706s
     0     0 27091.9811    0  419 11858.9884 27091.9811   128%     -  711s
     0     0 27089.4458    0  426 11858.9884 27089.4458   128%     -  715s
     0     0 27089.3689    0  426 11858.9884 27089.3689   128%     -  718s
     0     2 27088.3429    0  426 11858.9884 27088.3429   128%     -  797s
     1     4 27003.5974    1  408 11858.9884 27088.3429   128%  3788  811s
     3     8 26973.1356    2  410 11858.9884 27002.7847   128%  6651  825s
     7    15 26746.2981    3  417 11858.9884 26971.0818   127%  7577  845s
    14    29 26543.8455    4  480 11858.9884 26746.1303   126%  9224  867s
    28    43 24790.4643    5  340 11858.9884 26746.1303   126% 13500  924s
    42    74 25046.0494    5  339 11858.9884 26543.4892   124% 11589 1043s
H   62    74                    11866.687103 26543.4892   124% 10341 1043s
    73   169 24992.5921    6  332 11866.6871 26543.4892   124% 11973 1098s
   168   276 24427.6789    9  307 11866.6871 26543.4892   124%  8246 1130s
H  175   276                    11908.628132 26543.4892   123%  8071 1130s
H  191   276                    11939.815621 26543.4892   122%  7677 1130s
H  264   276                    11991.216949 26543.4892   121%  6342 1130s
   275   357 24083.1573   12  299 11991.2169 26543.4892   121%  6274 1157s
   356   414 23626.3000   14  319 11991.2169 26543.4892   121%  5661 1182s
   417   466 23119.7181   17  263 11991.2169 26543.4892   121%  5394 1205s
   471   496 22840.0130   20  320 11991.2169 26543.4892   121%  5332 1226s
   501   533 22651.4433   21  254 11991.2169 26543.4892   121%  5285 1247s
   538   564 22637.3616   22  318 11991.2169 26543.4892   121%  5168 1264s
H  548   564                    12011.392141 26543.4892   121%  5147 1264s
   569   636 22535.1218   23  308 12011.3921 26543.4892   121%  5171 1285s
   645   666 16325.6943   26  182 12011.3921 26543.4892   121%  5071 1302s
   675   696 15755.6561   27  147 12011.3921 26543.4892   121%  5105 1321s
   713   727 infeasible   28      12011.3921 26543.4892   121%  5210 1341s
   754   756 15120.4304   29  137 12011.3921 26543.4892   121%  5233 1359s
H  781   756                    12057.164237 26242.3414   118%  5257 1359s
   795   815 15115.5931   30  133 12057.1642 26242.3414   118%  5234 1380s
   872   879 14663.5942   35  132 12057.1642 26240.8960   118%  5278 1398s
   966   945 14069.4525   41  117 12057.1642 26240.8960   118%  5201 1419s
  1050   989 infeasible   47      12057.1642 26240.8960   118%  5225 1440s
  1118  1035 24853.7558   10  536 12057.1642 26240.8960   118%  5315 1465s
  1174  1095 24687.4759   11  406 12057.1642 26240.8960   118%  5434 1494s
  1252  1168 24313.8306   13  409 12057.1642 26240.8960   118%  5463 1517s
  1336  1248 infeasible   25      12057.1642 26240.8960   118%  5523 1543s
  1435  1320 23342.1468   15  349 12057.1642 26240.8960   118%  5537 1568s
  1535  1435 23229.4537   16  340 12057.1642 26240.8960   118%  5507 1596s
  1668  1515 23033.6810   18  428 12057.1642 26240.8960   118%  5411 1626s
  1793  1548 22000.6476   21  420 12057.1642 26240.8960   118%  5377 1645s
  1826  1585 21962.6107   22  329 12057.1642 26240.8960   118%  5450 1671s
  1895  1678 21607.5498   24  354 12057.1642 26240.8960   118%  5437 1699s
  2002  1747 21293.2285   27  353 12057.1642 26240.8960   118%  5398 1729s
  2097  1860 20893.1072   30  351 12057.1642 26240.8960   118%  5383 1760s
  2255  2039 20632.2799   34  343 12057.1642 26240.8960   118%  5330 1790s
  2454  2102 19855.0258   38  294 12057.1642 26240.8960   118%  5172 1825s
  2608  2180 16971.2884   43  303 12057.1642 26240.8960   118%  5158 1862s
  2759  2245 14270.5014   51  115 12057.1642 26240.8960   118%  5170 1901s
  2871  2275 infeasible   40      12057.1642 25581.4167   112%  5263 1934s
  2903  2302 23958.1936   11  314 12057.1642 25581.4167   112%  5349 1966s
  2940  2342 23324.0825   12  494 12057.1642 25581.4167   112%  5446 1997s
H 2946  2342                    12072.108079 25581.4167   112%  5454 1997s
  2990  2369 21817.0324   13  332 12072.1081 25581.4167   112%  5485 2025s
H 2992  2369                    12104.792942 25581.4167   111%  5483 2025s
H 2996  2368                    12146.141121 25581.4167   111%  5486 2025s
  3027  2478 20453.9088   14  437 12146.1411 25581.4167   111%  5524 2066s
  3181  2629 infeasible   15      12146.1411 25490.5134   110%  5562 2109s
  3396  2722 13622.0059   16  226 12146.1411 25490.5134   110%  5530 2153s
  3586  2821 12533.8721   20  349 12146.1411 25490.5134   110%  5526 2200s
  3799  2888 infeasible   75      12146.1411 25429.8539   109%  5530 2249s
  3984  2964 14547.1213   13  226 12146.1411 25429.8539   109%  5570 2299s
  4124  3049 12405.7721   15  209 12146.1411 25429.8539   109%  5593 2349s
  4295  3184 22201.2808   17  342 12146.1411 25402.2199   109%  5637 2402s
  4496  3185 21426.2804   37  426 12146.1411 25402.2199   109%  5661 2511s
  4498  3186 16931.7714   20  272 12146.1411 25402.2199   109%  5658 2532s
  4499  3187 23414.2291   10  316 12146.1411 25402.2199   109%  5657 2638s
  4500  3188 13674.7891   39  375 12146.1411 25402.2199   109%  5656 2725s
  4501  3188 15169.5674    9  400 12146.1411 25402.2199   109%  5655 2771s
  4502  3189 19421.7386   17  479 12146.1411 25402.2199   109%  5653 2804s
  4503  3190 23304.9993   28  400 12146.1411 25402.2199   109%  5652 2822s
  4504  3190 13288.5254   18  481 12146.1411 25402.2199   109%  5651 2840s
  4505  3191 14708.4831   40  429 12146.1411 25402.2199   109%  5649 2854s
  4506  3192 24491.1578    9  385 12146.1411 25402.2199   109%  5648 2866s
  4507  3192 19474.5361   27  341 12146.1411 25402.2199   109%  5647 2875s
  4508  3193 19845.4849   33  430 12146.1411 25402.2199   109%  5646 2882s
  4509  3194 13549.5816   39  388 12146.1411 25402.2199   109%  5644 2889s
  4510  3194 12290.2132   28  349 12146.1411 25402.2199   109%  5643 2894s
  4511  3195 18929.7617   33  350 12146.1411 25402.2199   109%  5642 2897s
  4512  3196 20653.1300   28  386 12146.1411 25402.2199   109%  5641 2912s
  4513  3196 17034.8447   43  378 12146.1411 25402.2199   109%  5639 2919s
  4514  3197 19718.4258   29  465 12146.1411 25402.2199   109%  5638 2931s
  4515  3198 13646.7248   34  448 12146.1411 25402.2199   109%  5637 2938s
  4516  3198 24482.1416    5  478 12146.1411 25402.2199   109%  5636 2941s
  4517  3199 14777.2069   58  508 12146.1411 25402.2199   109%  5634 2950s
  4518  3200 19655.0622   11  438 12146.1411 25402.2199   109%  5633 2960s
  4519  3200 23436.4349    9  476 12146.1411 25402.2199   109%  5632 2967s
  4520  3201 23469.8292   11  456 12146.1411 25402.2199   109%  5631 2972s
  4521  3202 17718.0939   20  472 12146.1411 25402.2199   109%  5629 2985s
  4522  3202 22449.0973   23  476 12146.1411 25402.2199   109%  5628 2990s
  4524  3204 15273.4795   51  483 12146.1411 25402.2199   109%  5626 3000s
  4525  3204 18059.7962   38  437 12146.1411 25402.2199   109%  5625 3010s
  4527  3206 23101.4489   15  456 12146.1411 25402.2199   109%  5622 3017s
  4528  3206 21119.9982   33  421 12146.1411 25402.2199   109%  5621 3029s
  4529  3207 14896.1363   59  422 12146.1411 25402.2199   109%  5620 3034s
  4530  3208 15209.6155   45  415 12146.1411 25402.2199   109%  5618 3041s
  4531  3208 13462.6333   67  421 12146.1411 25402.2199   109%  5617 3045s
  4532  3209 13191.0167   38  488 12146.1411 25402.2199   109%  5616 3056s
  4533  3210 15466.5850   31  409 12146.1411 25402.2199   109%  5615 3060s
  4534  3210 21195.2078   32  491 12146.1411 25402.2199   109%  5613 3070s
  4536  3212 17348.3802   42  409 12146.1411 25402.2199   109%  5611 3081s
  4537  3212 20220.5307   43  409 12146.1411 25402.2199   109%  5610 3101s
  4538  3213 13671.9263   39  409 12146.1411 25402.2199   109%  5608 3172s
  4539  3217 25402.2199   13  406 12146.1411 25402.2199   109%  5672 3274s
  4541  3220 25402.2199   14  469 12146.1411 25402.2199   109%  5674 3317s
  4545  3227 25402.2199   15  499 12146.1411 25402.2199   109%  5678 3359s
  4553  3240 25402.2199   16  497 12146.1411 25402.2199   109%  5686 3401s
  4569  3250 24129.1208   17  354 12146.1411 25402.2199   109%  5706 3600s

Cutting planes:
  Gomory: 11
  Implied bound: 3
  Projected implied bound: 83
  MIR: 1003
  Flow cover: 1326
  RLT: 17
  Relax-and-lift: 221

Explored 4584 nodes (26785787 simplex iterations) in 3600.14 seconds (5751.80 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12146.1 12104.8 12072.1 ... 11859

Time limit reached
Best objective 1.214614112145e+04, best bound 2.540221992337e+04, gap 109.1382%
  WARNING: Time limit reached. Using best solution found (gap: 109.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 12146.14, θ = 160678.71
  Upper Bound (UB) = 12146.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160678.71
  [DEBUG]   ✓ Scenario 0: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x48ac8eb7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x48ac8eb7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.305528e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6759496.7935
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.538293e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153829.31    0  124 6759496.79 -153829.31   102%     -    0s
H    0     0                    -118082.6931 -153829.31  30.3%     -    0s
H    0     0                    -118456.5614 -153829.31  29.9%     -    0s
H    0     0                    -127319.3784 -130153.01  2.23%     -    0s
     0     0 -130153.01    0   54 -127319.38 -130153.01  2.23%     -    0s
H    0     0                    -127626.0466 -130065.11  1.91%     -    0s
H    0     0                    -128653.2004 -130065.11  1.10%     -    0s
H    0     0                    -128959.8686 -130065.11  0.86%     -    0s
     0     0 -129349.45    0   24 -128959.87 -129349.45  0.30%     -    0s
H    0     0                    -129007.8818 -129322.94  0.24%     -    0s
     0     0 -129289.99    0   17 -129007.88 -129289.99  0.22%     -    0s
     0     0 -129288.11    0   16 -129007.88 -129288.11  0.22%     -    0s
     0     0 -129212.95    0   17 -129007.88 -129212.95  0.16%     -    0s
     0     0 -129212.95    0   18 -129007.88 -129212.95  0.16%     -    0s
     0     0 -129078.85    0    8 -129007.88 -129078.85  0.06%     -    0s
H    0     0                    -129072.2993 -129072.52  0.00%     -    0s
     0     0 -129072.52    0    7 -129072.30 -129072.52  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 3
  MIR: 7
  Flow cover: 4
  Relax-and-lift: 2

Explored 1 nodes (702 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -129072 -129008 -128960 ... 1.30553e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.290722992835e+05, best bound -1.290725162969e+05, gap 0.0002%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 152872.37
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129072.30
  [DEBUG]   S×d_nominal = 281944.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 281944.67 + -129072.30 = 152872.37
  [DEBUG]   Current θ from Master = 160678.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7806.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4339.79
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2804.3536, Absolute Gap = 2804.3536, Relative Gap = 0.230884
  Not converged yet (gap = 2804.35 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0x1b75c2c9
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 3.61s
Presolved: 90653 rows, 38830 columns, 550679 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -352354.4127
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.925e+06
 Factor NZ  : 8.518e+06 (roughly 120 MB of memory)
 Factor Ops : 1.466e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.49592443e+07  1.77359264e+08  9.64e+04 1.98e+01  7.58e+04     5s
   1  -1.11680631e+07  1.54546723e+08  6.61e+04 6.59e+01  5.13e+04     5s
   2  -3.65567505e+06  1.17475487e+08  2.15e+04 1.39e-11  1.76e+04     5s
   3  -7.38437320e+05  8.11363893e+07  1.71e+03 9.72e-01  1.79e+03     5s
   4  -4.64498799e+05  4.13428540e+07  3.97e+02 4.01e-01  5.24e+02     5s
   5  -3.64053366e+05  2.71888094e+07  1.38e+02 2.32e-01  2.52e+02     6s
   6  -2.78177787e+05  1.76355943e+07  4.33e+01 1.39e-01  1.31e+02     6s
   7  -1.53968088e+05  1.39920258e+07  8.63e+00 1.07e-01  8.91e+01     6s
   8  -1.02097300e+05  6.48534915e+06  3.29e+00 4.75e-02  4.04e+01     6s
   9  -7.22531482e+04  4.50728274e+06  1.96e+00 3.24e-02  2.79e+01     6s
  10  -4.13661466e+04  1.65958087e+06  9.01e-01 1.14e-02  1.03e+01     6s
  11  -9.33341933e+03  5.30633982e+05  3.79e-01 3.05e-03  3.26e+00     6s
  12   3.51084822e+02  2.53345140e+05  2.59e-01 1.26e-03  1.52e+00     6s
  13   8.71429855e+03  1.94669968e+05  1.85e-01 9.50e-04  1.12e+00     6s
  14   1.38550690e+04  1.47736994e+05  1.50e-01 1.70e-03  8.06e-01     6s
  15   1.87917671e+04  1.21966282e+05  1.23e-01 1.06e-03  6.21e-01     6s
  16   2.43829898e+04  9.90710345e+04  9.51e-02 1.39e-03  4.50e-01     6s
  17   2.91220537e+04  8.60167197e+04  7.46e-02 1.31e-03  3.42e-01     6s
  18   3.24111340e+04  7.44288814e+04  6.10e-02 1.39e-03  2.53e-01     6s
  19   3.61407083e+04  6.69096761e+04  4.66e-02 1.64e-03  1.85e-01     6s
  20   3.86686516e+04  6.47823726e+04  3.71e-02 1.41e-03  1.57e-01     7s
  21   3.94945588e+04  6.20529946e+04  3.39e-02 1.06e-03  1.36e-01     7s
  22   4.15583687e+04  6.05539546e+04  2.64e-02 8.37e-04  1.14e-01     7s
  23   4.32326525e+04  5.83311510e+04  2.06e-02 7.12e-04  9.08e-02     7s
  24   4.43478197e+04  5.55627940e+04  1.69e-02 5.74e-04  6.75e-02     7s
  25   4.55408394e+04  5.49360005e+04  1.31e-02 5.05e-04  5.65e-02     7s
  26   4.68993470e+04  5.32832412e+04  8.82e-03 4.98e-04  3.84e-02     7s
  27   4.79405028e+04  5.22661704e+04  5.80e-03 2.90e-04  2.60e-02     7s
  28   4.83635327e+04  5.18966067e+04  4.61e-03 2.54e-04  2.13e-02     7s
  29   4.88447987e+04  5.15429699e+04  3.26e-03 2.03e-04  1.62e-02     7s
  30   4.89407115e+04  5.08649747e+04  2.99e-03 1.30e-04  1.16e-02     7s
  31   4.90555796e+04  5.08383793e+04  2.67e-03 1.26e-04  1.07e-02     8s
  32   4.93194874e+04  5.08017684e+04  1.97e-03 1.19e-04  8.92e-03     8s
  33   4.95564680e+04  5.06163611e+04  1.35e-03 8.73e-05  6.38e-03     8s
  34   4.96463647e+04  5.04872871e+04  1.13e-03 9.41e-05  5.06e-03     8s
  35   4.97594092e+04  5.04021163e+04  8.39e-04 7.32e-05  3.87e-03     8s
  36   4.97825816e+04  5.03464246e+04  7.75e-04 5.97e-05  3.39e-03     8s
  37   4.98344803e+04  5.02789821e+04  6.44e-04 4.30e-05  2.67e-03     8s
  38   4.98755219e+04  5.02516065e+04  5.46e-04 3.57e-05  2.26e-03     8s
  39   4.99208360e+04  5.01906640e+04  4.36e-04 1.97e-05  1.62e-03     8s
  40   4.99412540e+04  5.01786516e+04  3.86e-04 1.69e-05  1.43e-03     8s
  41   5.00054757e+04  5.01756209e+04  2.40e-04 1.61e-05  1.02e-03     9s
  42   5.00521584e+04  5.01465494e+04  1.31e-04 8.60e-06  5.68e-04     9s
  43   5.00732273e+04  5.01394215e+04  8.42e-05 1.15e-05  3.98e-04     9s
  44   5.00813059e+04  5.01226136e+04  6.49e-05 4.60e-06  2.49e-04     9s
  45   5.00891641e+04  5.01202208e+04  4.76e-05 3.45e-06  1.87e-04     9s
  46   5.00954091e+04  5.01179876e+04  3.37e-05 2.56e-06  1.36e-04     9s
  47   5.01073133e+04  5.01136197e+04  8.23e-06 1.87e-06  3.79e-05     9s
  48   5.01074903e+04  5.01132331e+04  7.87e-06 1.53e-06  3.46e-05     9s
  49   5.01096592e+04  5.01121241e+04  3.52e-06 5.35e-07  1.48e-05     9s
  50   5.01112421e+04  5.01115638e+04  4.70e-07 3.48e-08  1.94e-06     9s
  51   5.01114718e+04  5.01115354e+04  8.06e-08 1.57e-08  3.82e-07    10s
  52   5.01115078e+04  5.01115212e+04  2.11e-08 6.38e-09  8.08e-08    10s
  53   5.01115109e+04  5.01115140e+04  8.78e-09 1.43e-09  1.84e-08    10s
  54   5.01115115e+04  5.01115118e+04  7.05e-08 9.47e-09  2.00e-09    10s

Barrier solved model in 54 iterations and 9.88 seconds (8.79 work units)
Optimal objective 5.01115115e+04


Root crossover log...

   78207 DPushes remaining with DInf 0.0000000e+00                10s
   37651 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   14585 PPushes remaining with PInf 4.3890158e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7897779e+03     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50084    5.0111512e+04   0.000000e+00   2.789778e+03     15s
   50342    5.0111512e+04   0.000000e+00   0.000000e+00     15s
   50342    5.0111512e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.35s

Solved with barrier

Root relaxation: objective 5.011151e+04, 50342 iterations, 10.95 seconds (14.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50111.5118    0  320 -219144.29 50111.5118   123%     -   16s
H    0     0                    -214512.9736 50111.5118   123%     -   16s
H    0     0                    -173661.9336 50111.5118   129%     -   16s
H    0     0                    -44613.66151 50111.5118   212%     -   16s
H    0     0                    -20023.43401 50111.5118   350%     -   17s
H    0     0                    -15143.94235 50111.5118   431%     -   17s
H    0     0                    -14582.04274 50111.5118   444%     -   17s
H    0     0                    -14304.48920 50111.5118   450%     -   17s
H    0     0                    -14253.10003 50111.5118   452%     -   17s
H    0     0                    -6436.271458 41389.5207   743%     -   86s
H    0     0                    -6094.754080 41389.5207   779%     -   86s
H    0     0                    -6090.349366 41389.5207   780%     -   86s
H    0     0                    -5173.687943 41389.5207   900%     -   86s
     0     0 41389.5207    0  508 -5173.6879 41389.5207   900%     -   86s
H    0     0                    -5152.512794 41388.6788   903%     -   87s
H    0     0                    -5122.821481 41388.6788   908%     -   87s
H    0     0                    -5089.501399 41388.6788   913%     -   87s
     0     0 41201.2048    0  522 -5089.5014 41201.2048   910%     -  108s
     0     0 40864.3872    0  530 -5089.5014 40864.3872   903%     -  120s
     0     0 40615.3670    0  555 -5089.5014 40615.3670   898%     -  140s
     0     0 40521.7409    0  569 -5089.5014 40521.7409   896%     -  161s
     0     0 40521.7409    0  555 -5089.5014 40521.7409   896%     -  168s
     0     0 40521.7409    0  555 -5089.5014 40521.7409   896%     -  171s
     0     0 40521.7409    0  554 -5089.5014 40521.7409   896%     -  179s
     0     0 40521.7409    0  549 -5089.5014 40521.7409   896%     -  180s
H    0     0                    -5056.988345 36338.1316   819%     -  292s
     0     0 36338.1316    0  222 -5056.9883 36338.1316   819%     -  292s
H    0     0                    -2108.154339 36338.1273  1824%     -  292s
H    0     0                    -1999.831553 36338.1273  1917%     -  293s
H    0     0                    -1379.338277 36338.1273  2734%     -  293s
H    0     0                    -1004.689825 36338.1273  3717%     -  293s
H    0     0                     756.8853321 36338.1273  4701%     -  293s
H    0     0                     862.7929660 36338.1273  4112%     -  293s
H    0     0                     984.8935724 36338.1273  3590%     -  293s
H    0     0                    1267.0905644 36338.1273  2768%     -  293s
H    0     0                    1319.2815723 36338.1273  2654%     -  293s
H    0     0                    1337.9796235 36338.1273  2616%     -  293s
H    0     0                    1343.3583780 36338.1273  2605%     -  293s
     0     0 34966.2522    0  564 1343.35838 34966.2522  2503%     -  392s
     0     0 34804.3468    0  373 1343.35838 34804.3468  2491%     -  418s
     0     0 34716.1116    0  391 1343.35838 34716.1116  2484%     -  437s
     0     0 34630.7016    0  393 1343.35838 34630.7016  2478%     -  458s
H    0     0                    3143.0570741 34510.9292   998%     -  475s
H    0     0                    3715.4951545 34510.9292   829%     -  475s
H    0     0                    3821.8135289 34510.9292   803%     -  475s
H    0     0                    4018.9698637 34510.9292   759%     -  475s
H    0     0                    5202.1190447 34510.9292   563%     -  475s
     0     0 34510.9292    0  391 5202.11904 34510.9292   563%     -  475s
H    0     0                    5438.7297569 34471.3338   534%     -  491s
H    0     0                    5766.7426480 34471.3338   498%     -  491s
H    0     0                    5782.0382823 34471.3338   496%     -  491s
H    0     0                    5801.9307364 34471.3338   494%     -  491s
H    0     0                    5847.4412325 34471.3338   490%     -  491s
     0     0 34471.3338    0  390 5847.44123 34471.3338   490%     -  491s
     0     0 34443.3789    0  356 5847.44123 34443.3789   489%     -  503s
H    0     0                    6181.0873598 34431.9230   457%     -  513s
     0     0 34431.9230    0  360 6181.08736 34431.9230   457%     -  513s
H    0     0                    6334.9773586 34345.4954   442%     -  525s
H    0     0                    6362.0224302 34345.4954   440%     -  525s
H    0     0                    6442.6419547 34345.4954   433%     -  525s
H    0     0                    6444.0249978 34345.4954   433%     -  525s
     0     0 34345.4954    0  331 6444.02500 34345.4954   433%     -  525s
     0     0 34342.8153    0  337 6444.02500 34342.8153   433%     -  530s
     0     0 34319.9366    0  348 6444.02500 34319.9366   433%     -  545s
     0     0 34313.5463    0  348 6444.02500 34313.5463   432%     -  547s
     0     0 34305.9242    0  337 6444.02500 34305.9242   432%     -  554s
     0     0 34300.6862    0  339 6444.02500 34300.6862   432%     -  561s
     0     0 34299.9118    0  341 6444.02500 34299.9118   432%     -  564s
     0     0 31834.2776    0  410 6444.02500 31834.2776   394%     -  691s
H    0     0                    6447.1585082 31833.8761   394%     -  692s
H    0     0                    6525.5576616 31833.8761   388%     -  692s
H    0     0                    6631.2362716 31833.8761   380%     -  692s
H    0     0                    6639.0725913 31104.0142   368%     -  754s
     0     0 31104.0142    0  408 6639.07259 31104.0142   368%     -  754s
H    0     0                    6762.4011152 30882.8424   357%     -  798s
     0     0 30882.8424    0  394 6762.40112 30882.8424   357%     -  798s
H    0     0                    6982.1853597 30829.6677   342%     -  814s
     0     0 30829.6677    0  333 6982.18536 30829.6677   342%     -  814s
     0     0 30709.2758    0  399 6982.18536 30709.2758   340%     -  849s
     0     0 30642.5032    0  433 6982.18536 30642.5032   339%     -  876s
     0     0 30636.3507    0  489 6982.18536 30636.3507   339%     -  883s
     0     0 30622.4083    0  439 6982.18536 30622.4083   339%     -  895s
     0     0 30595.7324    0  392 6982.18536 30595.7324   338%     -  904s
     0     0 30568.8250    0  437 6982.18536 30568.8250   338%     -  912s
     0     0 30563.2351    0  441 6982.18536 30563.2351   338%     -  920s
     0     0 30562.7178    0  395 6982.18536 30562.7178   338%     -  922s
     0     0 29025.6188    0  440 6982.18536 29025.6188   316%     - 1020s
H    0     0                    7086.0981669 29025.2540   310%     - 1021s
H    0     0                    7106.0424221 29025.2540   308%     - 1021s
H    0     0                    7108.3187304 29025.2540   308%     - 1021s
H    0     0                    7114.1652441 29025.2540   308%     - 1021s
H    0     0                    7130.4827700 29025.2540   307%     - 1021s
     0     0 28800.9004    0  470 7130.48277 28800.9004   304%     - 1055s
     0     0 28676.8487    0  499 7130.48277 28676.8487   302%     - 1076s
H    0     0                    7415.9490683 28624.5110   286%     - 1093s
H    0     0                    7470.7054975 28624.5110   283%     - 1093s
     0     0 28624.5110    0  487 7470.70550 28624.5110   283%     - 1093s
     0     0 28579.3096    0  487 7470.70550 28579.3096   283%     - 1106s
     0     0 28562.9393    0  457 7470.70550 28562.9393   282%     - 1118s
     0     0 28554.0593    0  458 7470.70550 28554.0593   282%     - 1124s
     0     0 28543.6604    0  459 7470.70550 28543.6604   282%     - 1130s
     0     0 28539.5272    0  456 7470.70550 28539.5272   282%     - 1135s
     0     0 28538.5381    0  458 7470.70550 28538.5381   282%     - 1138s
H    0     0                    7539.6082569 28289.6099   275%     - 1162s
     0     0 28289.6099    0  446 7539.60826 28289.6099   275%     - 1162s
H    0     0                    7548.5647186 28208.2405   274%     - 1183s
H    0     0                    7689.8175164 28208.2405   267%     - 1183s
     0     0 28208.2405    0  421 7689.81752 28208.2405   267%     - 1183s
     0     0 28152.5390    0  415 7689.81752 28152.5390   266%     - 1197s
H    0     0                    7713.5473538 28137.0262   265%     - 1206s
     0     0 28137.0262    0  421 7713.54735 28137.0262   265%     - 1206s
     0     0 28124.3193    0  451 7713.54735 28124.3193   265%     - 1214s
H    0     0                    7714.9435425 28121.5446   265%     - 1218s
     0     0 28121.5446    0  450 7714.94354 28121.5446   265%     - 1218s
     0     0 28030.2119    0  467 7714.94354 28030.2119   263%     - 1240s
H    0     0                    7756.3048670 28029.6591   261%     - 1241s
     0     0 27983.1733    0  466 7756.30487 27983.1733   261%     - 1260s
     0     0 27978.3184    0  468 7756.30487 27978.3184   261%     - 1264s
     0     0 27974.5097    0  434 7756.30487 27974.5097   261%     - 1271s
     0     0 27866.3165    0  448 7756.30487 27866.3165   259%     - 1290s
     0     0 27840.6436    0  388 7756.30487 27840.6436   259%     - 1301s
     0     0 27833.4495    0  449 7756.30487 27833.4495   259%     - 1307s
     0     0 27830.5638    0  450 7756.30487 27830.5638   259%     - 1310s
     0     0 27802.9099    0  482 7756.30487 27802.9099   258%     - 1322s
H    0     0                    7806.8666448 27802.3809   256%     - 1323s
     0     0 27797.6230    0  456 7806.86664 27797.6230   256%     - 1328s
     0     0 27790.9755    0  449 7806.86664 27790.9755   256%     - 1334s
     0     0 27786.8806    0  448 7806.86664 27786.8806   256%     - 1338s
     0     0 27680.0582    0  450 7806.86664 27680.0582   255%     - 1359s
     0     0 27666.8028    0  435 7806.86664 27666.8028   254%     - 1365s
     0     0 27660.8715    0  488 7806.86664 27660.8715   254%     - 1370s
     0     0 27656.5129    0  455 7806.86664 27656.5129   254%     - 1374s
     0     0 27655.8116    0  451 7806.86664 27655.8116   254%     - 1375s
     0     0 27629.9881    0  447 7806.86664 27629.9881   254%     - 1383s
     0     0 27608.8263    0  460 7806.86664 27608.8263   254%     - 1390s
     0     0 27601.5318    0  405 7806.86664 27601.5318   254%     - 1395s
     0     0 27599.3861    0  452 7806.86664 27599.3861   254%     - 1397s
     0     0 27530.2662    0  443 7806.86664 27530.2662   253%     - 1412s
H    0     0                    7836.4686491 27530.2201   251%     - 1413s
H    0     0                    7879.9912104 27530.2201   249%     - 1413s
     0     0 27512.4158    0  480 7879.99121 27512.4158   249%     - 1420s
     0     0 27505.0408    0  483 7879.99121 27505.0408   249%     - 1423s
     0     0 27498.4599    0  479 7879.99121 27498.4599   249%     - 1427s
     0     0 27494.6882    0  478 7879.99121 27494.6882   249%     - 1429s
     0     0 27458.0020    0  464 7879.99121 27458.0020   248%     - 1439s
H    0     0                    8035.8649988 27457.4657   242%     - 1447s
H    0     0                    8040.2394740 27457.4657   242%     - 1447s
H    0     0                    8090.1236938 27457.4657   239%     - 1447s
     0     0 27450.9317    0  463 8090.12369 27450.9317   239%     - 1454s
     0     0 27448.6862    0  462 8090.12369 27448.6862   239%     - 1456s
     0     0 27437.0885    0  463 8090.12369 27437.0885   239%     - 1462s
     0     0 27425.1667    0  506 8090.12369 27425.1667   239%     - 1467s
     0     0 27421.4519    0  412 8090.12369 27421.4519   239%     - 1471s
     0     0 27408.0495    0  459 8090.12369 27408.0495   239%     - 1478s
     0     0 27407.9255    0  459 8090.12369 27407.9255   239%     - 1481s
H    0     0                    8091.1074600 27407.9255   239%     - 1532s
H    0     0                    8172.7582180 27407.9255   235%     - 1594s
H    0     0                    8389.2161453 27407.9255   227%     - 1594s
H    0     0                    8624.8239247 27407.9255   218%     - 1597s
H    0     0                    8698.1236173 27407.9255   215%     - 1600s
H    0     0                    8830.7402734 27407.9255   210%     - 1600s
H    0     0                    8872.1508676 27407.9255   209%     - 1600s
H    0     0                    8943.2869371 27407.9255   206%     - 1600s
H    0     0                    8965.6475297 27407.7148   206%     - 1641s
H    0     0                    9000.5117805 27407.7148   205%     - 1641s
H    0     0                    9058.4234353 27407.7148   203%     - 1654s
H    0     0                    9234.4207448 27407.7148   197%     - 1656s
H    0     0                    9249.0024359 27407.7148   196%     - 1656s
H    0     0                    9313.8851168 27407.7148   194%     - 1656s
H    0     0                    9318.5751930 27407.7148   194%     - 1657s
H    0     2                    9329.5202945 27407.7148   194%     - 1900s
     0     2 27407.7148    0  459 9329.52029 27407.7148   194%     - 1900s
     1     4 27361.0455    1  400 9329.52029 27405.3523   194%  5629 1927s
     3     8 27013.0278    2  457 9329.52029 27360.9527   193% 11617 1986s
     7    16 26833.5975    3  498 9329.52029 27012.9916   190% 14638 2032s
    15    32 26652.5980    4  476 9329.52029 26833.2072   188% 16724 2077s
    31    48 25483.1110    5  404 9329.52029 26651.8240   186% 23843 2236s
    47    80 24498.5123    6  386 9329.52029 26651.8240   186% 21473 2282s
    79   144 24386.2681    7  376 9329.52029 26651.8240   186% 16884 2454s
   143   233 23871.9537    9  352 9329.52029 26651.8240   186% 11529 2516s
   232   324 23980.9391    8  298 9329.52029 26651.8240   186%  9002 2575s
   323   402 22239.2441   10  278 9329.52029 26651.8240   186%  8026 2623s
   401   468 24085.3931   11  374 9329.52029 26651.8240   186%  7570 2663s
   467   551 23840.3033   12  366 9329.52029 26651.8240   186%  7359 2695s
H  491   551                    10096.368057 26651.8240   164%  7216 2695s
   550   652 23826.5027   12  358 10096.3681 26651.8240   164%  7008 2726s
   651   731 23711.3639   13  375 10096.3681 26651.8240   164%  6511 2750s
H  654   731                    11091.272818 26651.8240   140%  6496 2750s
H  668   731                    11164.150265 26651.8240   139%  6503 2750s
   732   782 21571.3975   25  427 11164.1503 26651.8240   139%  6343 2773s
   810   827 21435.9830   29  432 11164.1503 26651.8240   139%  6268 2799s
H  823   827                    11480.480775 26651.8240   132%  6247 2799s
   863   881 20809.9627   31  339 11480.4808 26651.8240   132%  6223 2824s
   935   914 23427.7119   14  361 11480.4808 26651.8240   132%  6177 2851s
H  937   914                    11681.621061 26651.8240   128%  6171 2851s
H  952   914                    11756.908297 26651.8240   127%  6161 2851s
   983   947 20599.6742   33  356 11756.9083 26651.8240   127%  6142 2878s
  1048   975 23381.3592   15  307 11756.9083 26651.8240   127%  6078 2904s
H 1055   975                    11828.354218 26651.8240   125%  6115 2904s
  1090  1052 23108.9476   16  296 11828.3542 26651.8240   125%  6079 2934s
H 1206  1107                    11981.632711 26651.8240   122%  5948 2965s
H 1207  1107                    12055.387625 26651.8240   121%  5950 2965s
H 1221  1107                    12177.546793 26651.8240   119%  5937 2965s
  1307  1138 22608.2719   18  288 12177.5468 26651.8240   119%  5758 2998s
  1402  1167 22167.0605   17  270 12177.5468 26651.8240   119%  5695 3025s
H 1403  1167                    12239.954249 26651.8240   118%  5691 3025s
  1466  1227 17555.8438   19  300 12239.9542 26651.8240   118%  5724 3059s
  1556  1323 21725.4243   18  263 12239.9542 26651.8240   118%  5814 3096s
H 1563  1323                    12251.301707 26651.8240   118%  5823 3096s
  1672  1416 15397.9689   19  218 12251.3017 26651.8240   118%  5810 3129s
  1793  1520 21590.2152   19  238 12251.3017 26651.8240   118%  5845 3168s
  1942  1641 21277.7499   21  269 12251.3017 26651.8240   118%  5784 3205s
H 2108  1688                    12301.716830 26651.8240   117%  5697 3239s
  2195  1829 20175.9342   23  242 12301.7168 26651.8240   117%  5634 3278s
  2381  1936 18276.2462   25  283 12301.7168 26651.8240   117%  5559 3321s
  2572  2032 19900.8809   26  243 12301.7168 26651.8240   117%  5459 3367s
  2765  2144 19478.1655   27  228 12301.7168 26651.8240   117%  5353 3414s
  2960  2207 15477.0946   30  230 12301.7168 26651.8240   117%  5278 3462s
  3146  2246 16555.4645   30  220 12301.7168 26651.8240   117%  5246 3510s
  3265  2321 15103.8718   29  250 12301.7168 26651.8240   117%  5327 3560s
  3402  2375 16110.5796   31  238 12301.7168 26651.8240   117%  5383 3600s

Cutting planes:
  Learned: 1
  Gomory: 15
  Implied bound: 202
  MIR: 3740
  Flow cover: 2797
  RLT: 123
  Relax-and-lift: 990

Explored 3480 nodes (19548454 simplex iterations) in 3600.04 seconds (5580.29 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12301.7 12251.3 12240 ... 11480.5

Time limit reached
Best objective 1.230171683025e+04, best bound 2.665182401753e+04, gap 116.6513%
  WARNING: Time limit reached. Using best solution found (gap: 116.65%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 12301.72, θ = 161507.72
  Upper Bound (UB) = 12301.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161507.72
  [DEBUG]   ✓ Scenario 0: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 161507.72 ≤ Q = 161507.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 161507.72 ≤ Q = 161507.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 161507.72 ≤ Q = 161507.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 161507.72 ≤ Q = 161507.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 161507.72 ≤ Q = 161507.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2193150a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde6ceaf6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362410e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6926716.2795
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.541191e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154119.07    0  130 6926716.28 -154119.07   102%     -    0s
H    0     0                    -116339.8967 -154119.07  32.5%     -    0s
H    0     0                    -116489.3461 -154119.07  32.3%     -    0s
     0     0 -129762.87    0   52 -116489.35 -129762.87  11.4%     -    0s
H    0     0                    -127683.1725 -129667.70  1.55%     -    0s
H    0     0                    -128020.9340 -129667.70  1.29%     -    0s
H    0     0                    -128321.0972 -129667.70  1.05%     -    0s
     0     0 -129667.70    0   36 -128321.10 -129667.70  1.05%     -    0s
     0     0 -129667.70    0   34 -128321.10 -129667.70  1.05%     -    0s
     0     0 -128976.01    0   34 -128321.10 -128976.01  0.51%     -    0s
H    0     0                    -128323.2365 -128964.21  0.50%     -    0s
     0     0 -128890.24    0   32 -128323.24 -128890.24  0.44%     -    0s
     0     0 -128890.24    0   32 -128323.24 -128890.24  0.44%     -    0s
H    0     0                    -128354.4886 -128890.24  0.42%     -    0s
     0     0 -128690.40    0   14 -128354.49 -128690.40  0.26%     -    0s
     0     0 -128690.27    0   12 -128354.49 -128690.27  0.26%     -    0s
     0     0 -128580.49    0   16 -128354.49 -128580.49  0.18%     -    0s
     0     0 -128576.89    0   15 -128354.49 -128576.89  0.17%     -    0s
     0     0 -128571.91    0   13 -128354.49 -128571.91  0.17%     -    0s
     0     0 -128532.93    0   10 -128354.49 -128532.93  0.14%     -    0s
     0     0 -128532.93    0   27 -128354.49 -128532.93  0.14%     -    0s
     0     0 -128532.93    0   26 -128354.49 -128532.93  0.14%     -    0s
     0     0 -128532.93    0   25 -128354.49 -128532.93  0.14%     -    0s
     0     0 -128532.93    0   13 -128354.49 -128532.93  0.14%     -    0s
     0     0 -128490.42    0   10 -128354.49 -128490.42  0.11%     -    0s
     0     0 -128438.67    0    9 -128354.49 -128438.67  0.07%     -    0s
H    0     0                    -128370.7071 -128432.75  0.05%     -    0s
H    0     0                    -128373.0991 -128432.75  0.05%     -    0s
     0     0 -128432.75    0    8 -128373.10 -128432.75  0.05%     -    0s
     0     0 -128424.41    0    6 -128373.10 -128424.41  0.04%     -    0s
     0     0 -128424.41    0   13 -128373.10 -128424.41  0.04%     -    0s
H    0     0                    -128383.3654 -128424.41  0.03%     -    0s
     0     0 -128416.76    0    5 -128383.37 -128416.76  0.03%     -    0s
H    0     0                    -128392.8912 -128411.04  0.01%     -    0s
H    0     0                    -128393.9173 -128411.04  0.01%     -    0s
H    0     0                    -128403.4691 -128411.04  0.01%     -    0s
     0     0 -128411.04    0    4 -128403.47 -128411.04  0.01%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 5
  MIR: 2
  Flow cover: 2

Explored 1 nodes (805 simplex iterations) in 0.22 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128403 -128394 -128393 ... -127683

Optimal solution found (tolerance 1.00e-04)
Best objective -1.284034691127e+05, best bound -1.284110395929e+05, gap 0.0059%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 153953.50
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128403.47
  [DEBUG]   S×d_nominal = 282356.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282356.97 + -128403.47 = 153953.50
  [DEBUG]   Current θ from Master = 161507.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7554.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4747.50
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2959.9293, Absolute Gap = 2959.9293, Relative Gap = 0.240611
  Not converged yet (gap = 2959.93 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0x960c6ccf
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 2.98s
Presolved: 99580 rows, 42487 columns, 601994 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353328.8244
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.526e+06
 Factor NZ  : 9.979e+06 (roughly 140 MB of memory)
 Factor Ops : 1.828e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.58141212e+07  1.92562992e+08  1.02e+05 2.01e+01  7.96e+04     5s
   1  -1.18590028e+07  1.69181370e+08  6.99e+04 6.69e+01  5.39e+04     5s
   2  -2.91470644e+06  1.28641958e+08  1.69e+04 2.73e-11  1.40e+04     5s
   3  -6.54410511e+05  8.76342384e+07  1.30e+03 1.53e-11  1.46e+03     5s
   4  -4.58389887e+05  3.40982808e+07  3.57e+02 1.35e-11  4.22e+02     5s
   5  -3.33091504e+05  2.43906488e+07  8.64e+01 1.23e-11  1.88e+02     5s
   6  -2.50738269e+05  1.70439148e+07  3.58e+01 1.37e-11  1.13e+02     5s
   7  -1.45153721e+05  1.10922014e+07  8.58e+00 2.17e-11  6.49e+01     5s
   8  -8.76036973e+04  4.31541785e+06  4.22e+00 5.41e-12  2.49e+01     5s
   9  -5.08168645e+04  2.21438735e+06  1.99e+00 3.88e-12  1.26e+01     5s
  10  -1.34327240e+04  7.49410167e+05  8.80e-01 1.78e-12  4.21e+00     5s
  11   2.15844167e+02  3.10791322e+05  4.29e-01 1.09e-12  1.71e+00     6s
  12   1.32538372e+04  1.80236025e+05  2.44e-01 1.04e-04  9.18e-01     6s
  13   1.85893681e+04  1.34413785e+05  1.92e-01 5.45e-04  6.36e-01     6s
  14   2.33351458e+04  1.13819549e+05  1.53e-01 6.91e-04  4.97e-01     6s
  15   2.60811122e+04  1.01376927e+05  1.30e-01 7.89e-04  4.13e-01     6s
  16   3.12283971e+04  8.56578139e+04  9.60e-02 9.50e-04  2.99e-01     6s
  17   3.50559517e+04  7.58403265e+04  7.41e-02 1.22e-03  2.24e-01     6s
  18   3.84498891e+04  6.83151988e+04  5.56e-02 8.76e-04  1.64e-01     6s
  19   4.07286627e+04  6.42705251e+04  4.39e-02 6.71e-04  1.29e-01     6s
  20   4.21166368e+04  6.18305682e+04  3.70e-02 7.02e-04  1.08e-01     6s
  21   4.32585663e+04  6.04115767e+04  3.12e-02 8.87e-04  9.41e-02     6s
  22   4.50539569e+04  5.73170222e+04  2.27e-02 8.03e-04  6.73e-02     6s
  23   4.56889191e+04  5.56593042e+04  1.99e-02 6.20e-04  5.47e-02     6s
  24   4.69200731e+04  5.50510642e+04  1.45e-02 5.50e-04  4.46e-02     7s
  25   4.75322448e+04  5.44255492e+04  1.18e-02 4.74e-04  3.78e-02     7s
  26   4.80565441e+04  5.37857552e+04  9.68e-03 3.94e-04  3.14e-02     7s
  27   4.87897083e+04  5.26893621e+04  6.73e-03 2.72e-04  2.14e-02     7s
  28   4.93643824e+04  5.21419391e+04  4.61e-03 1.94e-04  1.52e-02     7s
  29   4.95816677e+04  5.16493869e+04  3.82e-03 1.28e-04  1.13e-02     7s
  30   4.98521709e+04  5.14280289e+04  2.90e-03 9.70e-05  8.65e-03     7s
  31   5.01169306e+04  5.13354676e+04  1.99e-03 8.26e-05  6.69e-03     7s
  32   5.02195545e+04  5.11893602e+04  1.63e-03 6.30e-05  5.32e-03     7s
  33   5.02675906e+04  5.10760278e+04  1.47e-03 5.08e-05  4.44e-03     7s
  34   5.04093029e+04  5.09560146e+04  9.84e-04 3.57e-05  3.00e-03     8s
  35   5.04690661e+04  5.08640865e+04  7.85e-04 2.13e-05  2.17e-03     8s
  36   5.05168603e+04  5.08471869e+04  6.30e-04 1.89e-05  1.81e-03     8s
  37   5.05476506e+04  5.08160293e+04  5.27e-04 1.44e-05  1.47e-03     8s
  38   5.05656567e+04  5.08026519e+04  4.67e-04 1.24e-05  1.30e-03     8s
  39   5.06008845e+04  5.07928231e+04  3.52e-04 1.10e-05  1.05e-03     8s
  40   5.06345008e+04  5.07591431e+04  2.50e-04 5.66e-06  6.84e-04     8s
  41   5.06825799e+04  5.07484138e+04  9.76e-05 4.10e-06  3.61e-04     8s
  42   5.07076200e+04  5.07282826e+04  2.82e-05 8.99e-06  1.13e-04     8s
  43   5.07147166e+04  5.07222006e+04  1.04e-05 2.86e-06  4.11e-05     8s
  44   5.07159962e+04  5.07194858e+04  7.40e-06 1.26e-06  1.92e-05     8s
  45   5.07189043e+04  5.07194116e+04  3.27e-07 9.14e-07  2.78e-06     9s
  46   5.07192052e+04  5.07192144e+04  5.31e-08 9.12e-08  5.03e-08     9s
  47   5.07192129e+04  5.07192135e+04  1.32e-07 4.50e-11  3.29e-09     9s
  48   5.07192134e+04  5.07192134e+04  6.56e-09 1.88e-09  3.44e-12     9s

Barrier solved model in 48 iterations and 8.83 seconds (8.84 work units)
Optimal objective 5.07192134e+04


Root crossover log...

   83850 DPushes remaining with DInf 0.0000000e+00                 9s
   17859 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    1629 PPushes remaining with PInf 5.6517231e-07                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.7978029e-11     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30292    5.0719213e+04   0.000000e+00   0.000000e+00     12s
   30292    5.0719213e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.071921e+04, 30292 iterations, 8.23 seconds (10.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50719.2134    0  364 -219144.29 50719.2134   123%     -   12s
H    0     0                    -212888.7365 50719.2134   124%     -   12s
H    0     0                    -129059.3492 50719.2134   139%     -   13s
H    0     0                    -123847.4760 50719.2134   141%     -   13s
H    0     0                    -117903.7187 50719.2134   143%     -   13s
H    0     0                    -115651.9685 50719.2134   144%     -   13s
H    0     0                    -115306.3104 50719.2134   144%     -   13s
H    0     0                    -55425.81715 50719.2134   192%     -   13s
H    0     0                    -31489.30536 50719.2134   261%     -   14s
H    0     0                    -13968.52488 50719.2134   463%     -   14s
H    0     0                    -11648.80066 50719.2134   535%     -   14s
H    0     0                    -9242.936563 42114.6547   556%     -   80s
H    0     0                    -8936.534100 42114.6547   571%     -   80s
     0     0 42114.6547    0  518 -8936.5341 42114.6547   571%     -   80s
H    0     0                    -8685.953656 42110.1436   585%     -   81s
H    0     0                    -8552.587906 42110.1436   592%     -   81s
H    0     0                    -8419.422924 42110.1436   600%     -   81s
H    0     0                    -8256.912623 42110.1436   610%     -   81s
H    0     0                    -8233.205705 42110.1436   611%     -   82s
     0     0 41406.0098    0  592 -8233.2057 41406.0098   603%     -  112s
     0     0 41291.6673    0  606 -8233.2057 41291.6673   602%     -  121s
     0     0 41206.9403    0  607 -8233.2057 41206.9403   600%     -  129s
     0     0 41157.5087    0  603 -8233.2057 41157.5087   600%     -  134s
     0     0 41157.5087    0  608 -8233.2057 41157.5087   600%     -  149s
     0     0 41157.5087    0  602 -8233.2057 41157.5087   600%     -  155s
     0     0 41157.5087    0  596 -8233.2057 41157.5087   600%     -  158s
     0     0 41157.5087    0  599 -8233.2057 41157.5087   600%     -  164s
     0     0 41119.6445    0  593 -8233.2057 41119.6445   599%     -  169s
     0     0 41119.6357    0  593 -8233.2057 41119.6357   599%     -  170s
H    0     0                    -5405.878676 37026.6048   785%     -  230s
H    0     0                    -5124.264709 37026.6048   823%     -  230s
H    0     0                    -5104.916540 37026.6048   825%     -  230s
H    0     0                    -4766.225615 37026.6048   877%     -  230s
     0     0 37001.8680    0  286 -4766.2256 37001.8680   876%     -  230s
H    0     0                    4015.0346193 37001.8680   822%     -  231s
H    0     0                    5104.0611179 37001.8680   625%     -  231s
H    0     0                    5210.8529842 37001.8680   610%     -  231s
H    0     0                    5320.4207348 37001.8680   595%     -  231s
H    0     0                    5363.1950390 37001.8680   590%     -  231s
H    0     0                    5410.1622414 37001.8680   584%     -  231s
H    0     0                    5420.4241094 37001.8680   583%     -  231s
H    0     0                    5427.4022464 37001.8680   582%     -  231s
     0     0 35627.8476    0  605 5427.40225 35627.8476   556%     -  317s
     0     0 35264.5690    0  549 5427.40225 35264.5690   550%     -  399s
H    0     0                    5860.2111715 35154.4875   500%     -  433s
H    0     0                    5880.4285242 35154.4875   498%     -  433s
H    0     0                    5913.4457908 35154.4875   494%     -  433s
H    0     0                    5925.2576005 35154.4875   493%     -  433s
H    0     0                    5966.9496794 35154.4875   489%     -  433s
     0     0 35154.4875    0  598 5966.94968 35154.4875   489%     -  433s
H    0     0                    7109.9250740 34916.6143   391%     -  492s
H    0     0                    7114.3297874 34916.6143   391%     -  492s
     0     0 34916.6143    0  587 7114.32979 34916.6143   391%     -  492s
     0     0 34727.1178    0  528 7114.32979 34727.1178   388%     -  533s
     0     0 34642.0436    0  541 7114.32979 34642.0436   387%     -  553s
     0     0 34598.1795    0  537 7114.32979 34598.1795   386%     -  570s
     0     0 34568.8273    0  519 7114.32979 34568.8273   386%     -  581s
     0     0 34559.1324    0  534 7114.32979 34559.1324   386%     -  590s
     0     0 34553.4751    0  542 7114.32979 34553.4751   386%     -  597s
     0     0 34547.0746    0  535 7114.32979 34547.0746   386%     -  604s
     0     0 34470.8377    0  525 7114.32979 34470.8377   385%     -  619s
     0     0 34465.4077    0  543 7114.32979 34465.4077   384%     -  625s
     0     0 34464.2336    0  546 7114.32979 34464.2336   384%     -  628s
H    0     0                    7212.5127080 34464.2336   378%     -  649s
H    0     0                    7221.8432964 34464.2336   377%     -  649s
H    0     0                    7227.4832889 34464.2336   377%     -  649s
     0     0 31911.5423    0  344 7227.48329 31911.5423   342%     -  748s
H    0     0                    7251.7263118 31911.1649   340%     -  749s
H    0     0                    7438.4398601 31179.6946   319%     -  832s
H    0     0                    7455.1107790 31179.6946   318%     -  833s
     0     0 31179.6946    0  412 7455.11078 31179.6946   318%     -  833s
     0     0 31041.5929    0  396 7455.11078 31041.5929   316%     -  853s
     0     0 30990.9017    0  384 7455.11078 30990.9017   316%     -  881s
     0     0 30975.9685    0  412 7455.11078 30975.9685   315%     -  893s
     0     0 30954.9451    0  389 7455.11078 30954.9451   315%     -  910s
     0     0 30953.6458    0  390 7455.11078 30953.6458   315%     -  914s
H    0     0                    7696.3297022 30953.6458   302%     -  954s
H    0     0                    7784.8457109 30953.6458   298%     -  954s
H    0     0                    7789.0934736 30953.6458   297%     -  954s
H    0     0                    7823.2368450 30953.6458   296%     -  954s
     0     0 29738.4952    0  386 7823.23684 29738.4952   280%     - 1037s
H    0     0                    7932.7564131 29738.4428   275%     - 1039s
H    0     0                    8117.4041438 29451.7016   263%     - 1081s
H    0     0                    8126.9326960 29451.7016   262%     - 1081s
H    0     0                    8143.6036149 29451.7016   262%     - 1081s
     0     0 29451.7016    0  313 8143.60361 29451.7016   262%     - 1081s
     0     0 29312.7754    0  333 8143.60361 29312.7754   260%     - 1102s
     0     0 29268.4256    0  344 8143.60361 29268.4256   259%     - 1121s
     0     0 29210.3820    0  343 8143.60361 29210.3820   259%     - 1139s
     0     0 29195.8526    0  330 8143.60361 29195.8526   259%     - 1150s
     0     0 29182.7449    0  330 8143.60361 29182.7449   258%     - 1156s
     0     0 29171.7806    0  326 8143.60361 29171.7806   258%     - 1164s
     0     0 29110.3069    0  319 8143.60361 29110.3069   257%     - 1176s
     0     0 29098.3994    0  335 8143.60361 29098.3994   257%     - 1184s
     0     0 29093.4246    0  329 8143.60361 29093.4246   257%     - 1190s
     0     0 29092.0648    0  328 8143.60361 29092.0648   257%     - 1192s
H    0     0                    8230.3246327 28890.5410   251%     - 1222s
     0     0 28890.5410    0  381 8230.32463 28890.5410   251%     - 1222s
H    0     0                    8232.3517650 28890.5222   251%     - 1223s
     0     0 28807.1514    0  327 8232.35177 28807.1514   250%     - 1242s
     0     0 28789.7290    0  407 8232.35177 28789.7290   250%     - 1253s
     0     0 28766.0568    0  402 8232.35177 28766.0568   249%     - 1261s
     0     0 28762.7777    0  401 8232.35177 28762.7777   249%     - 1266s
     0     0 28574.5261    0  344 8232.35177 28574.5261   247%     - 1292s
     0     0 28514.6590    0  353 8232.35177 28514.6590   246%     - 1308s
     0     0 28496.4282    0  398 8232.35177 28496.4282   246%     - 1319s
     0     0 28468.5260    0  346 8232.35177 28468.5260   246%     - 1331s
     0     0 28450.5830    0  393 8232.35177 28450.5830   246%     - 1339s
     0     0 28443.2452    0  348 8232.35177 28443.2452   246%     - 1343s
     0     0 28441.4984    0  351 8232.35177 28441.4984   245%     - 1346s
     0     0 28322.1819    0  408 8232.35177 28322.1819   244%     - 1369s
     0     0 28279.2151    0  359 8232.35177 28279.2151   244%     - 1388s
     0     0 28241.1500    0  428 8232.35177 28241.1500   243%     - 1400s
     0     0 28233.8281    0  431 8232.35177 28233.8281   243%     - 1409s
     0     0 28225.9889    0  431 8232.35177 28225.9889   243%     - 1415s
     0     0 28223.9326    0  426 8232.35177 28223.9326   243%     - 1418s
     0     0 28161.2215    0  416 8232.35177 28161.2215   242%     - 1439s
     0     0 28137.9453    0  501 8232.35177 28137.9453   242%     - 1455s
     0     0 28132.3477    0  467 8232.35177 28132.3477   242%     - 1459s
     0     0 28127.9296    0  465 8232.35177 28127.9296   242%     - 1467s
     0     0 28063.6967    0  477 8232.35177 28063.6967   241%     - 1493s
     0     0 28040.9855    0  496 8232.35177 28040.9855   241%     - 1509s
     0     0 28017.1998    0  505 8232.35177 28017.1998   240%     - 1516s
     0     0 28008.1835    0  501 8232.35177 28008.1835   240%     - 1524s
     0     0 28005.9593    0  448 8232.35177 28005.9593   240%     - 1531s
     0     0 27981.8242    0  516 8232.35177 27981.8242   240%     - 1541s
     0     0 27965.4080    0  523 8232.35177 27965.4080   240%     - 1550s
     0     0 27957.7685    0  521 8232.35177 27957.7685   240%     - 1554s
     0     0 27954.6497    0  529 8232.35177 27954.6497   240%     - 1557s
     0     0 27924.5799    0  426 8232.35177 27924.5799   239%     - 1576s
     0     0 27904.1559    0  420 8232.35177 27904.1559   239%     - 1590s
     0     0 27892.7020    0  428 8232.35177 27892.7020   239%     - 1596s
     0     0 27891.2545    0  427 8232.35177 27891.2545   239%     - 1598s
     0     0 27874.5585    0  425 8232.35177 27874.5585   239%     - 1609s
     0     0 27865.3106    0  475 8232.35177 27865.3106   238%     - 1617s
     0     0 27859.4493    0  469 8232.35177 27859.4493   238%     - 1624s
     0     0 27857.6395    0  429 8232.35177 27857.6395   238%     - 1630s
     0     0 27832.7588    0  511 8232.35177 27832.7588   238%     - 1643s
     0     0 27816.8340    0  469 8232.35177 27816.8340   238%     - 1652s
     0     0 27814.3980    0  373 8232.35177 27814.3980   238%     - 1655s
     0     0 27792.8490    0  435 8232.35177 27792.8490   238%     - 1664s
     0     0 27792.8452    0  435 8232.35177 27792.8452   238%     - 1668s
H    0     0                    8245.9666996 27792.8079   237%     - 1900s
H    0     2                    8291.8837256 27792.8079   235%     - 1904s
     0     2 27792.8079    0  435 8291.88373 27792.8079   235%     - 1904s
     1     3 27747.0726    1  440 8291.88373 27792.5665   235%  5907 1913s
     2     5 27625.6637    2  427 8291.88373 27792.5665   235%  6080 1928s
     4     9 27402.0298    3  422 8291.88373 27745.2998   235%  6824 1982s
     8    18 27245.5390    3  449 8291.88373 27679.7678   234% 10658 2037s
    17    36 26882.4540    4  420 8291.88373 27372.0190   230% 13700 2093s
    35    50 26591.2834    5  528 8291.88373 27009.3058   226% 22811 3571s
    49    61 25847.7887    6  423 8291.88373 27009.3058   226% 23872 3600s
H   52    61                    8310.0507493 27009.3058   225% 22798 3600s
H   56    61                    8339.7922498 27009.3058   224% 21534 3600s

Cutting planes:
  Learned: 1
  Gomory: 20
  Implied bound: 369
  MIR: 3502
  Flow cover: 2486
  RLT: 169
  Relax-and-lift: 1326

Explored 60 nodes (2068670 simplex iterations) in 3600.11 seconds (4025.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 8339.79 8310.05 8291.88 ... 7932.76

Time limit reached
Best objective 8.339792249803e+03, best bound 2.700930578565e+04, gap 223.8607%
  WARNING: Time limit reached. Using best solution found (gap: 223.86%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 8339.79, θ = 140228.31
  Upper Bound (UB) = 8339.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140228.31
  [DEBUG]   ✓ Scenario 0: θ = 140228.31 ≤ Q = 140228.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140228.31 ≤ Q = 140228.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140228.31 ≤ Q = 140246.20 (slack: 17.90)
  [DEBUG]   ✓ Scenario 3: θ = 140228.31 ≤ Q = 140228.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140228.31 ≤ Q = 140234.06 (slack: 5.75)
  [DEBUG]   ✓ Scenario 5: θ = 140228.31 ≤ Q = 140228.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140228.31 ≤ Q = 140228.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140228.31 ≤ Q = 140228.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140228.31 ≤ Q = 140228.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140228.31 ≤ Q = 140228.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140228.31 ≤ Q = 140228.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x283cdec4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd7c3213c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.375617e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 7521193.8678
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.346351e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134635.07    0  123 7521193.87 -134635.07   102%     -    0s
H    0     0                    -99381.39903 -134635.07  35.5%     -    0s
H    0     0                    -99888.67629 -134635.07  34.8%     -    0s
H    0     0                    -101420.3614 -117471.94  15.8%     -    0s
H    0     0                    -102044.4892 -117471.94  15.1%     -    0s
H    0     0                    -111151.9732 -117471.94  5.69%     -    0s
     0     0 -117471.94    0  137 -111151.97 -117471.94  5.69%     -    0s
H    0     0                    -112463.3183 -117431.69  4.42%     -    0s
     0     0 -115682.08    0  138 -112463.32 -115682.08  2.86%     -    0s
H    0     0                    -112948.6066 -115664.78  2.40%     -    0s
     0     0 -115664.78    0  138 -112948.61 -115664.78  2.40%     -    0s
H    0     0                    -113147.4285 -115345.83  1.94%     -    0s
     0     0 -115345.83    0  132 -113147.43 -115345.83  1.94%     -    0s
     0     0 -115210.06    0  132 -113147.43 -115210.06  1.82%     -    0s
     0     0 -114960.34    0  116 -113147.43 -114960.34  1.60%     -    0s
     0     0 -114923.34    0  126 -113147.43 -114923.34  1.57%     -    0s
     0     0 -114912.44    0  130 -113147.43 -114912.44  1.56%     -    0s
     0     0 -114719.22    0  109 -113147.43 -114719.22  1.39%     -    0s
     0     0 -114689.04    0  112 -113147.43 -114689.04  1.36%     -    0s
     0     0 -114685.57    0  112 -113147.43 -114685.57  1.36%     -    0s
     0     0 -114424.39    0  108 -113147.43 -114424.39  1.13%     -    0s
     0     0 -114395.26    0  127 -113147.43 -114395.26  1.10%     -    0s
     0     0 -114377.23    0  127 -113147.43 -114377.23  1.09%     -    0s
     0     0 -114076.88    0   90 -113147.43 -114076.88  0.82%     -    0s
     0     0 -114001.65    0  103 -113147.43 -114001.65  0.75%     -    0s
     0     0 -113987.64    0   80 -113147.43 -113987.64  0.74%     -    0s
     0     0 -113752.05    0  128 -113147.43 -113752.05  0.53%     -    0s
     0     0 -113735.39    0   95 -113147.43 -113735.39  0.52%     -    0s
     0     0 -113667.97    0   67 -113147.43 -113667.97  0.46%     -    0s
     0     0 -113660.23    0   67 -113147.43 -113660.23  0.45%     -    0s
     0     0 -113656.78    0   67 -113147.43 -113656.78  0.45%     -    0s
     0     0 -113649.97    0   67 -113147.43 -113649.97  0.44%     -    0s
     0     2 -113649.97    0   67 -113147.43 -113649.97  0.44%     -    0s
H   39    24                    -113355.1045 -113474.49  0.11%  16.5    0s
*  114    31               7    -113369.3054 -113437.56  0.06%   8.2    0s

Cutting planes:
  Gomory: 62
  Implied bound: 5
  MIR: 153
  Flow cover: 5
  RLT: 83
  Relax-and-lift: 1

Explored 190 nodes (2333 simplex iterations) in 0.38 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -113369 -113355 -113147 ... 1.37562e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.133693054147e+05, best bound -1.133794716219e+05, gap 0.0090%
  Subproblem solved in 0.41s
  Worst-case operational profit (Z_SP) = 129497.28
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113369.31
  [DEBUG]   S×d_nominal = 242866.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 242866.59 + -113369.31 = 129497.28
  [DEBUG]   Current θ from Master = 140228.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10731.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2391.24
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = -1001.9953, Absolute Gap = 1001.9953, Relative Gap = -0.120146
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 8339.79, LB = 9341.79, Gap = -1002.00
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524543 nonzeros
Model fingerprint: 0xc9bccf99
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 76356 rows and 30996 columns
Presolve time: 3.47s
Presolved: 108507 rows, 46144 columns, 653411 nonzeros
Variable types: 43885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -354124.1784
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 659
 AA' NZ     : 3.756e+06
 Factor NZ  : 9.083e+06 (roughly 140 MB of memory)
 Factor Ops : 1.738e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66181921e+07  2.07857163e+08  1.07e+05 1.95e+01  8.30e+04     6s
   1  -1.25698631e+07  1.84181721e+08  7.38e+04 6.65e+01  5.65e+04     6s
   2  -3.52773200e+06  1.39820655e+08  2.06e+04 8.28e-01  1.68e+04     6s
   3  -8.16003655e+05  1.00331739e+08  2.17e+03 1.89e+00  2.15e+03     6s
   4  -4.89050472e+05  3.63297856e+07  4.69e+02 1.89e-01  4.94e+02     6s
   5  -3.42183052e+05  2.56709023e+07  1.21e+02 1.14e-01  2.05e+02     6s
   6  -2.50096400e+05  1.73408846e+07  4.82e+01 6.91e-02  1.14e+02     6s
   7  -1.60138726e+05  1.26474666e+07  1.84e+01 4.74e-02  7.23e+01     6s
   8  -9.46420660e+04  8.26103355e+06  7.84e+00 2.94e-02  4.45e+01     6s
   9  -7.28069235e+04  5.79392266e+06  4.45e+00 2.03e-02  3.05e+01     6s
  10  -4.04590198e+04  2.15057332e+06  1.65e+00 7.05e-03  1.12e+01     6s
  11  -1.15799848e+04  7.67963059e+05  7.37e-01 2.29e-03  3.95e+00     6s
  12  -3.20314409e+03  4.45547638e+05  5.17e-01 1.43e-03  2.27e+00     6s
  13   6.61567700e+03  2.71053659e+05  3.33e-01 9.32e-04  1.34e+00     6s
  14   1.50376911e+04  1.68106457e+05  2.23e-01 1.28e-03  7.73e-01     6s
  15   1.97321541e+04  1.28490407e+05  1.80e-01 1.09e-03  5.49e-01     7s
  16   2.56523961e+04  1.05185499e+05  1.31e-01 9.05e-04  4.01e-01     7s
  17   2.79243729e+04  9.13541800e+04  1.15e-01 6.35e-04  3.20e-01     7s
  18   3.13025068e+04  8.14927040e+04  9.45e-02 8.23e-04  2.53e-01     7s
  19   3.41710238e+04  7.15252966e+04  7.91e-02 1.59e-03  1.88e-01     7s
  20   3.79028082e+04  6.52759074e+04  5.98e-02 1.18e-03  1.38e-01     7s
  21   4.00130801e+04  6.11783862e+04  4.91e-02 1.71e-03  1.07e-01     7s
  22   4.14577016e+04  5.82629790e+04  4.18e-02 1.36e-03  8.48e-02     7s
  23   4.37213263e+04  5.60443583e+04  3.06e-02 1.85e-03  6.22e-02     7s
  24   4.53810441e+04  5.51062668e+04  2.26e-02 1.44e-03  4.91e-02     7s
  25   4.56072110e+04  5.48249852e+04  2.15e-02 1.35e-03  4.65e-02     7s
  26   4.61841042e+04  5.40895914e+04  1.88e-02 1.06e-03  3.99e-02     7s
  27   4.73717828e+04  5.34402395e+04  1.34e-02 8.58e-04  3.06e-02     8s
  28   4.81722857e+04  5.28489894e+04  9.75e-03 6.81e-04  2.36e-02     8s
  29   4.85397631e+04  5.20835965e+04  8.16e-03 4.61e-04  1.79e-02     8s
  30   4.87861855e+04  5.18028199e+04  7.12e-03 3.75e-04  1.52e-02     8s
  31   4.92404049e+04  5.15149854e+04  5.21e-03 3.02e-04  1.15e-02     8s
  32   4.94419919e+04  5.11787396e+04  4.39e-03 2.19e-04  8.76e-03     8s
  33   4.97123596e+04  5.10803574e+04  3.32e-03 1.83e-04  6.90e-03     8s
  34   4.99023416e+04  5.10242027e+04  2.55e-03 1.62e-04  5.66e-03     8s
  35   4.99741783e+04  5.08861898e+04  2.25e-03 1.03e-04  4.60e-03     8s
  36   5.02035648e+04  5.08258835e+04  1.36e-03 8.34e-05  3.14e-03     8s
  37   5.02663191e+04  5.07540992e+04  1.12e-03 5.96e-05  2.46e-03     9s
  38   5.03285089e+04  5.06847613e+04  8.72e-04 4.36e-05  1.80e-03     9s
  39   5.04516596e+04  5.06456037e+04  4.02e-04 2.72e-05  9.78e-04     9s
  40   5.04968810e+04  5.06067894e+04  2.31e-04 1.38e-05  5.54e-04     9s
  41   5.05063836e+04  5.05961055e+04  1.97e-04 1.01e-05  4.52e-04     9s
  42   5.05216531e+04  5.05932668e+04  1.44e-04 9.18e-06  3.61e-04     9s
  43   5.05527791e+04  5.05781695e+04  3.79e-05 4.19e-06  1.28e-04     9s
  44   5.05639697e+04  5.05682947e+04  1.84e-06 2.32e-06  2.18e-05     9s
  45   5.05645186e+04  5.05654217e+04  9.71e-07 2.13e-07  4.55e-06     9s
  46   5.05652987e+04  5.05652996e+04  2.40e-09 1.95e-08  4.67e-09     9s
  47   5.05652994e+04  5.05652994e+04  1.00e-08 6.40e-12  2.58e-11     9s

Barrier solved model in 47 iterations and 9.43 seconds (9.08 work units)
Optimal objective 5.05652994e+04


Root crossover log...

   88333 DPushes remaining with DInf 0.0000000e+00                 9s
   38400 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2287 PPushes remaining with PInf 3.2062931e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.3150540e-11     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33566    5.0565299e+04   0.000000e+00   0.000000e+00     13s
   33566    5.0565299e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.14s

Solved with barrier

Root relaxation: objective 5.056530e+04, 33566 iterations, 8.84 seconds (11.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50565.2994    0  420 -219144.29 50565.2994   123%     -   14s
H    0     0                    -185232.2825 50565.2994   127%     -   14s
H    0     0                    -161540.2168 50565.2994   131%     -   14s
H    0     0                    -146840.9073 50565.2994   134%     -   14s
H    0     0                    -130068.5557 50565.2994   139%     -   15s
H    0     0                    -76989.42524 50565.2994   166%     -   15s
H    0     0                    -76402.95835 50565.2994   166%     -   15s
H    0     0                    -66312.35880 50565.2994   176%     -   15s
H    0     0                    -65695.15785 50565.2994   177%     -   15s
H    0     0                    -27889.38130 50565.2994   281%     -   15s
H    0     0                    -26713.39121 50565.2994   289%     -   15s
H    0     0                    -26239.70683 50565.2994   293%     -   16s
H    0     0                    -26014.41710 50565.2994   294%     -   16s
H    0     0                    -23487.08502 50565.2994   315%     -   18s
H    0     0                    -20871.09642 50565.2994   342%     -   18s
H    0     0                    -20870.75031 50565.2994   342%     -   18s
H    0     0                    -20734.40725 50565.2994   344%     -   18s
H    0     0                    -20717.73633 50565.2994   344%     -   18s
H    0     0                    -20491.14935 50565.2994   347%     -   18s
H    0     0                    -18455.54576 41881.1440   327%     -  104s
H    0     0                    -18276.59193 41881.1440   329%     -  104s
H    0     0                    -18264.58626 41881.1440   329%     -  104s
H    0     0                    -17577.39929 41881.1440   338%     -  104s
H    0     0                    -17545.73799 41881.1440   339%     -  104s
H    0     0                    -17540.02458 41881.1440   339%     -  104s
H    0     0                    -17521.94318 41881.1440   339%     -  104s
     0     0 41881.1440    0  584 -17521.943 41881.1440   339%     -  104s
H    0     0                    -14226.03427 41880.7296   394%     -  105s
H    0     0                    -14150.52587 41880.7296   396%     -  106s
H    0     0                    -12439.14481 41880.7296   437%     -  106s
H    0     0                    -12218.01557 41880.7296   443%     -  106s
     0     0 41311.9867    0  612 -12218.016 41311.9867   438%     -  157s
     0     0 41203.7978    0  615 -12218.016 41203.7978   437%     -  175s
     0     0 41172.7175    0  615 -12218.016 41172.7175   437%     -  185s
     0     0 41143.8830    0  616 -12218.016 41143.8830   437%     -  194s
     0     0 41044.5815    0  623 -12218.016 41044.5815   436%     -  204s
     0     0 41044.5815    0  615 -12218.016 41044.5815   436%     -  211s
     0     0 40876.8220    0  621 -12218.016 40876.8220   435%     -  231s
     0     0 40834.0764    0  629 -12218.016 40834.0764   434%     -  244s
     0     0 40833.1651    0  626 -12218.016 40833.1651   434%     -  248s
     0     0 36689.3259    0  404 -12218.016 36689.3259   400%     -  330s
H    0     0                    -9590.169764 36689.3210   483%     -  331s
H    0     0                    -4290.912049 36689.3210   955%     -  331s
H    0     0                    -2673.969555 36689.3210  1472%     -  332s
H    0     0                    -1910.551110 36689.3210  2020%     -  332s
H    0     0                    -1050.888875 36689.3210  3591%     -  332s
H    0     0                    -1031.275121 36689.3210  3658%     -  332s
H    0     0                    -978.5048258 36689.3210  3850%     -  332s
H    0     0                    -975.0973467 36689.3210  3863%     -  332s
H    0     0                    -972.5948523 36689.3210  3872%     -  332s
H    0     0                    -956.3992955 36689.3210  3936%     -  332s
     0     0 35183.7092    0  640 -956.39930 35183.7092  3779%     -  462s
     0     0 34878.4139    0  628 -956.39930 34878.4139  3747%     -  527s
     0     0 34649.0588    0  602 -956.39930 34649.0588  3723%     -  583s
     0     0 34529.1010    0  604 -956.39930 34529.1010  3710%     -  622s
     0     0 34495.9868    0  556 -956.39930 34495.9868  3707%     -  645s
H    0     0                    -919.2535098 34482.5370  3851%     -  662s
     0     0 34482.5370    0  562 -919.25351 34482.5370  3851%     -  662s
H    0     0                    1282.5089857 34467.4225  2587%     -  686s
H    0     0                    1340.3310107 34467.4225  2472%     -  686s
H    0     0                    1702.5604195 34467.4225  1924%     -  686s
H    0     0                    1703.1952898 34467.4225  1924%     -  686s
H    0     0                    1727.5064838 34467.4225  1895%     -  686s
H    0     0                    2132.0435910 34467.4225  1517%     -  686s
H    0     0                    2142.0528005 34467.4225  1509%     -  686s
     0     0 34467.4225    0  597 2142.05280 34467.4225  1509%     -  686s
H    0     0                    3232.0196864 34435.6127   965%     -  709s
     0     0 34435.6127    0  607 3232.01969 34435.6127   965%     -  709s
H    0     0                    4520.7043598 34361.0371   660%     -  737s
H    0     0                    5676.7197004 34361.0371   505%     -  737s
H    0     0                    5853.7692390 34361.0371   487%     -  737s
H    0     0                    5955.5664647 34361.0371   477%     -  737s
H    0     0                    6084.6851267 34361.0371   465%     -  737s
H    0     0                    6086.0681698 34361.0371   465%     -  737s
H    0     0                    6125.4645516 34361.0371   461%     -  737s
     0     0 34361.0371    0  608 6125.46455 34361.0371   461%     -  737s
     0     0 34310.4205    0  592 6125.46455 34310.4205   460%     -  761s
     0     0 34289.5529    0  602 6125.46455 34289.5529   460%     -  784s
     0     0 34267.1864    0  552 6125.46455 34267.1864   459%     -  806s
     0     0 34251.6167    0  528 6125.46455 34251.6167   459%     -  817s
     0     0 34238.4345    0  522 6125.46455 34238.4345   459%     -  841s
     0     0 34237.5411    0  526 6125.46455 34237.5411   459%     -  844s
     0     0 32158.5201    0  434 6125.46455 32158.5201   425%     - 1020s
H    0     0                    6454.0434145 32158.4982   398%     - 1022s
H    0     0                    6454.7341347 32158.4982   398%     - 1022s
     0     0 31519.1737    0  372 6454.73413 31519.1737   388%     - 1140s
     0     0 31284.6873    0  382 6454.73413 31284.6873   385%     - 1198s
H    0     0                    6723.3749533 31081.5411   362%     - 1256s
H    0     0                    6803.6577714 31081.5411   357%     - 1256s
H    0     0                    6839.2374432 31081.5411   354%     - 1256s
H    0     0                    6932.0186843 31081.5411   348%     - 1256s
H    0     0                    6955.3497068 31081.5411   347%     - 1256s
     0     0 31081.5411    0  351 6955.34971 31081.5411   347%     - 1257s
     0     0 30927.4931    0  488 6955.34971 30927.4931   345%     - 1288s
     0     0 30888.5595    0  505 6955.34971 30888.5595   344%     - 1315s
     0     0 30870.8821    0  496 6955.34971 30870.8821   344%     - 1333s
     0     0 30819.0489    0  433 6955.34971 30819.0489   343%     - 1357s
     0     0 30802.8886    0  393 6955.34971 30802.8886   343%     - 1375s
     0     0 30777.4758    0  341 6955.34971 30777.4758   343%     - 1390s
     0     0 30763.4406    0  386 6955.34971 30763.4406   342%     - 1400s
     0     0 30748.1164    0  383 6955.34971 30748.1164   342%     - 1411s
     0     0 30744.1441    0  387 6955.34971 30744.1441   342%     - 1416s
     0     0 30730.2100    0  432 6955.34971 30730.2100   342%     - 1428s
     0     0 30725.7217    0  427 6955.34971 30725.7217   342%     - 1434s
     0     0 30724.8671    0  437 6955.34971 30724.8671   342%     - 1436s
H    0     0                    6989.0502476 29408.5688   321%     - 1547s
     0     0 29408.5688    0  455 6989.05025 29408.5688   321%     - 1547s
H    0     0                    6999.6447011 29408.4941   320%     - 1548s
H    0     0                    7018.4828229 29408.4941   319%     - 1548s
H    0     0                    7029.8622996 29408.4941   318%     - 1548s
     0     0 29143.1050    0  492 7029.86230 29143.1050   315%     - 1607s
H    0     0                    7210.4598762 29061.0014   303%     - 1645s
     0     0 29061.0014    0  461 7210.45988 29061.0014   303%     - 1645s
     0     0 29032.9079    0  457 7210.45988 29032.9079   303%     - 1663s
     0     0 29001.1612    0  449 7210.45988 29001.1612   302%     - 1687s
     0     0 28991.5168    0  451 7210.45988 28991.5168   302%     - 1702s
     0     0 28981.3686    0  455 7210.45988 28981.3686   302%     - 1717s
     0     0 28973.1362    0  466 7210.45988 28973.1362   302%     - 1726s
     0     0 28967.5302    0  473 7210.45988 28967.5302   302%     - 1736s
H    0     0                    7671.3063726 28967.2152   278%     - 1739s
     0     0 28967.2152    0  483 7671.30637 28967.2152   278%     - 1739s
     0     0 28525.5952    0  457 7671.30637 28525.5952   272%     - 1809s
     0     0 28432.5772    0  525 7671.30637 28432.5772   271%     - 1858s
     0     0 28379.9322    0  442 7671.30637 28379.9322   270%     - 1884s
     0     0 28351.1237    0  513 7671.30637 28351.1237   270%     - 1904s
     0     0 28329.0584    0  515 7671.30637 28329.0584   269%     - 1925s
     0     0 28322.8754    0  526 7671.30637 28322.8754   269%     - 1930s
     0     0 28305.7246    0  511 7671.30637 28305.7246   269%     - 1937s
     0     0 28303.8457    0  513 7671.30637 28303.8457   269%     - 1939s
H    0     0                    7695.3483622 28139.3657   266%     - 1982s
     0     0 28139.3657    0  528 7695.34836 28139.3657   266%     - 1982s
H    0     0                    7802.7976060 28139.2420   261%     - 1983s
H    0     0                    7993.3766065 28139.2420   252%     - 1983s
     0     0 28099.1026    0  560 7993.37661 28099.1026   252%     - 2007s
     0     0 28079.1526    0  530 7993.37661 28079.1526   251%     - 2025s
     0     0 28075.0498    0  535 7993.37661 28075.0498   251%     - 2034s
     0     0 28016.0267    0  568 7993.37661 28016.0267   250%     - 2060s
     0     0 27999.0310    0  565 7993.37661 27999.0310   250%     - 2075s
     0     0 27991.6133    0  573 7993.37661 27991.6133   250%     - 2083s
     0     0 27979.7672    0  416 7993.37661 27979.7672   250%     - 2092s
     0     0 27978.1025    0  414 7993.37661 27978.1025   250%     - 2096s
     0     0 27921.3211    0  417 7993.37661 27921.3211   249%     - 2122s
     0     0 27897.0532    0  437 7993.37661 27897.0532   249%     - 2141s
     0     0 27893.5757    0  432 7993.37661 27893.5757   249%     - 2149s
     0     0 27844.2277    0  377 7993.37661 27844.2277   248%     - 2173s
     0     0 27815.6402    0  377 7993.37661 27815.6402   248%     - 2199s
     0     0 27808.9951    0  469 7993.37661 27808.9951   248%     - 2219s
     0     0 27808.7422    0  421 7993.37661 27808.7422   248%     - 2221s
     0     0 27780.2587    0  409 7993.37661 27780.2587   248%     - 2243s
     0     0 27769.3907    0  420 7993.37661 27769.3907   247%     - 2254s
     0     0 27754.7211    0  426 7993.37661 27754.7211   247%     - 2268s
     0     0 27751.3087    0  436 7993.37661 27751.3087   247%     - 2275s
     0     0 27716.3704    0  484 7993.37661 27716.3704   247%     - 2305s
     0     0 27696.9426    0  480 7993.37661 27696.9426   246%     - 2325s
     0     0 27690.4051    0  485 7993.37661 27690.4051   246%     - 2334s
     0     0 27684.0546    0  473 7993.37661 27684.0546   246%     - 2348s
     0     0 27681.0684    0  488 7993.37661 27681.0684   246%     - 2353s
     0     0 27661.2949    0  477 7993.37661 27661.2949   246%     - 2375s
H    0     0                    8800.4638604 27661.1902   214%     - 2419s
H    0     0                    9329.5202945 27661.1902   196%     - 2422s
     0     0 27648.1144    0  538 9329.52029 27648.1144   196%     - 2440s
     0     0 27641.0567    0  487 9329.52029 27641.0567   196%     - 2450s
     0     0 27640.1960    0  491 9329.52029 27640.1960   196%     - 2455s
     0     0 27626.6022    0  483 9329.52029 27626.6022   196%     - 2471s
     0     0 27616.6844    0  490 9329.52029 27616.6844   196%     - 2487s
     0     0 27613.6242    0  529 9329.52029 27613.6242   196%     - 2492s
     0     0 27578.5823    0  431 9329.52029 27578.5823   196%     - 2507s
     0     0 27533.5386    0  430 9329.52029 27533.5386   195%     - 2574s
     0     0 27527.8011    0  430 9329.52029 27527.8011   195%     - 2584s
     0     0 27515.5451    0  426 9329.52029 27515.5451   195%     - 2598s
     0     0 27513.6473    0  440 9329.52029 27513.6473   195%     - 2603s
     0     0 27481.1364    0  490 9329.52029 27481.1364   195%     - 2619s
     0     0 27445.8641    0  509 9329.52029 27445.8641   194%     - 2634s
     0     0 27434.9936    0  500 9329.52029 27434.9936   194%     - 2641s
     0     0 27431.1762    0  488 9329.52029 27431.1762   194%     - 2644s
     0     0 27399.3879    0  488 9329.52029 27399.3879   194%     - 2658s
     0     0 27388.7098    0  495 9329.52029 27388.7098   194%     - 2668s
     0     0 27386.5785    0  495 9329.52029 27386.5785   194%     - 2672s
     0     0 27366.4069    0  507 9329.52029 27366.4069   193%     - 2685s
     0     0 27358.2531    0  493 9329.52029 27358.2531   193%     - 2694s
     0     0 27353.9063    0  447 9329.52029 27353.9063   193%     - 2706s
     0     0 27350.5290    0  493 9329.52029 27350.5290   193%     - 2710s
     0     0 27332.7505    0  487 9329.52029 27332.7505   193%     - 2728s
     0     0 27332.7011    0  487 9329.52029 27332.7011   193%     - 2735s
     0     2 27332.5586    0  487 9329.52029 27332.5586   193%     - 3555s
     1     3 27290.2068    1  474 9329.52029 27332.5586   193%  4870 3600s

Cutting planes:
  Learned: 4
  Gomory: 24
  Implied bound: 194
  MIR: 2003
  Flow cover: 1247
  RLT: 169
  Relax-and-lift: 837

Explored 2 nodes (1216468 simplex iterations) in 3600.05 seconds (5166.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9329.52 8800.46 7993.38 ... 6999.64

Time limit reached
Best objective 9.329520294535e+03, best bound 2.733255855661e+04, gap 192.9685%
  WARNING: Time limit reached. Using best solution found (gap: 192.97%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 9329.52, θ = 160046.04
  Upper Bound (UB) = 9329.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160046.04
  [DEBUG]   ✓ Scenario 0: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160046.04 ≤ Q = 160046.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160046.04 ≤ Q = 160046.04 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5b1c49bf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa4e3b641
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.440299e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 7490594.0181
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.550716e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155071.58    0  132 7490594.02 -155071.58   102%     -    0s
H    0     0                    -117807.2428 -155071.58  31.6%     -    0s
H    0     0                    -117975.1442 -155071.58  31.4%     -    0s
     0     0 -133045.92    0  114 -117975.14 -133045.92  12.8%     -    0s
H    0     0                    -127809.6978 -132916.52  4.00%     -    0s
H    0     0                    -128136.8340 -132916.52  3.73%     -    0s
H    0     0                    -128866.1635 -132916.52  3.14%     -    0s
H    0     0                    -129193.2997 -132916.52  2.88%     -    0s
     0     0 -132916.52    0  112 -129193.30 -132916.52  2.88%     -    0s
     0     0 -132916.52    0  112 -129193.30 -132916.52  2.88%     -    0s
     0     0 -131542.42    0   66 -129193.30 -131542.42  1.82%     -    0s
H    0     0                    -130246.7565 -131532.08  0.99%     -    0s
H    0     0                    -130573.8927 -131532.08  0.73%     -    0s
H    0     0                    -130647.1516 -131521.60  0.67%     -    0s
     0     0 -131521.60    0   66 -130647.15 -131521.60  0.67%     -    0s
     0     0 -131244.78    0   37 -130647.15 -131244.78  0.46%     -    0s
     0     0 -131119.91    0   43 -130647.15 -131119.91  0.36%     -    0s
     0     0 -131097.18    0   41 -130647.15 -131097.18  0.34%     -    0s
     0     0 -130966.97    0   24 -130647.15 -130966.97  0.24%     -    0s
     0     0 -130940.06    0   22 -130647.15 -130940.06  0.22%     -    0s
     0     0 -130903.83    0   20 -130647.15 -130903.83  0.20%     -    0s
     0     0 -130891.51    0   19 -130647.15 -130891.51  0.19%     -    0s
     0     0 -130881.99    0   20 -130647.15 -130881.99  0.18%     -    0s
     0     0 -130859.88    0   11 -130647.15 -130859.88  0.16%     -    0s
     0     0 -130856.07    0   12 -130647.15 -130856.07  0.16%     -    0s
     0     0 -130844.50    0   11 -130647.15 -130844.50  0.15%     -    0s
     0     0 -130844.50    0   11 -130647.15 -130844.50  0.15%     -    0s
H    0     0                    -130713.8926 -130844.50  0.10%     -    0s
     0     0 -130844.50    0   57 -130713.89 -130844.50  0.10%     -    0s
     0     0 -130844.50    0   15 -130713.89 -130844.50  0.10%     -    0s
H    0     0                    -130745.3390 -130844.50  0.08%     -    0s
     0     0 -130837.78    0   12 -130745.34 -130837.78  0.07%     -    0s
     0     0 -130826.86    0   13 -130745.34 -130826.86  0.06%     -    0s
     0     0 -130826.74    0   13 -130745.34 -130826.74  0.06%     -    0s
     0     0 -130826.73    0   13 -130745.34 -130826.73  0.06%     -    0s
     0     0 -130788.47    0    4 -130745.34 -130788.47  0.03%     -    0s
     0     0 -130788.47    0    7 -130745.34 -130788.47  0.03%     -    0s
H    0     0                    -130770.8827 -130788.47  0.01%     -    0s
H    0     0                    -130781.6653 -130788.47  0.01%     -    0s
     0     0 -130788.47    0    2 -130781.67 -130788.47  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 3
  Flow cover: 5

Explored 1 nodes (1083 simplex iterations) in 0.20 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -130782 -130771 -130745 ... -117975

Optimal solution found (tolerance 1.00e-04)
Best objective -1.307816652974e+05, best bound -1.307884729398e+05, gap 0.0052%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 151735.26
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130781.67
  [DEBUG]   S×d_nominal = 282516.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282516.93 + -130781.67 = 151735.26
  [DEBUG]   Current θ from Master = 160046.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8310.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1018.74
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = -12.2672, Absolute Gap = 12.2672, Relative Gap = -0.001315
  *** CONVERGED (small negative gap: -12.27 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 12
Total Time: 32470.47s
Converged: True
Final Lower Bound: 9341.7875
Final Upper Bound: 9329.5203
Final Gap: -12.267246
Number of Critical Scenarios: 12
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [5, 6, 8, 9] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 6 customers  Mode 1: 3 customers  Mode 2: 41 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 12
Start Time: 2026-01-04 12:31:03
End Time: 2026-01-04 21:32:13
Total Time: 32470.47s
Optimal Value: 9341.79
Lower Bound: 9341.79
Upper Bound: 9329.52
Gap: -12.267246
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [5, 6, 8, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed24_Mixed_gamma20_20260104_213213.csv

Total Execution Time: 32470.70 seconds
End Time: 2026-01-04 21:32:14

All tasks completed successfully!

