
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 40
DI Scenario: HD
Start Time: 2026-01-05 15:25:04
================================================================================
Loading data from data/DH_data_full_seed40.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
  Product 1: ['1.000', '1.397', '1.953'] (k=0.825)
  Product 2: ['1.000', '1.475', '2.176'] (k=0.959)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=900, max=1732
  DC capacity (MC): min=418, max=894

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.01, max=34.70, count=87
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5661, max=9568
  DC fixed cost: min=3076, max=5936
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
    Product 1: ['1.000', '1.397', '1.953'] (k=0.825)
    Product 2: ['1.000', '1.475', '2.176'] (k=0.959)
  MD:
    Product 0: ['1.000', '1.261', '1.590'] (k=0.572)
    Product 1: ['1.000', '1.272', '1.619'] (k=0.594)
    Product 2: ['1.000', '1.200', '1.439'] (k=0.449)
  LD:
    Product 0: ['1.000', '1.116', '1.247'] (k=0.272)
    Product 1: ['1.000', '1.084', '1.176'] (k=0.200)
    Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
  Mixed:
    Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
    Product 1: ['1.000', '1.272', '1.619'] (k=0.594)
    Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0xa9771620
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.13s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -260203.9811
Found heuristic solution: objective -198039.8849

Root relaxation: objective 1.588531e+05, 5469 iterations, 0.42 seconds (0.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 158853.106    0  416 -198039.88 158853.106   180%     -    0s
H    0     0                    -192206.2407 158853.106   183%     -    0s
     0     0 138382.157    0  691 -192206.24 138382.157   172%     -    1s
     0     0 138062.997    0  635 -192206.24 138062.997   172%     -    1s
H    0     0                    -165041.3406 138055.720   184%     -    1s
     0     0 138055.720    0  628 -165041.34 138055.720   184%     -    1s
     0     0 138055.081    0  634 -165041.34 138055.081   184%     -    1s
     0     0 126771.607    0  658 -165041.34 126771.607   177%     -    3s
     0     0 126273.073    0  651 -165041.34 126273.073   177%     -    3s
     0     0 126223.720    0  652 -165041.34 126223.720   176%     -    3s
     0     0 126221.978    0  651 -165041.34 126221.978   176%     -    3s
     0     0 117615.732    0  609 -165041.34 117615.732   171%     -    5s
H    0     0                    -149530.8933 115027.219   177%     -    6s
H    0     0                    -19529.98275 115027.219   689%     -    6s
H    0     0                    58935.047882 115027.219  95.2%     -    6s
     0     0 115027.219    0  493 58935.0479 115027.219  95.2%     -    6s
     0     0 114379.456    0  518 58935.0479 114379.456  94.1%     -    6s
     0     0 114223.428    0  554 58935.0479 114223.428  93.8%     -    6s
     0     0 114181.136    0  559 58935.0479 114181.136  93.7%     -    6s
H    0     0                    60131.639000 114172.887  89.9%     -    6s
     0     0 114172.887    0  525 60131.6390 114172.887  89.9%     -    6s
H    0     0                    60405.474005 114172.887  89.0%     -    7s
H    0     0                    60525.627958 114172.887  88.6%     -    7s
H    0     0                    60527.991422 114172.887  88.6%     -    7s
H    0     0                    60917.214161 114172.887  87.4%     -    7s
H    0     0                    60922.352253 114172.887  87.4%     -    7s
H    0     0                    65460.635194 114172.887  74.4%     -    7s
H    0     0                    66105.599640 114172.887  72.7%     -    7s
H    0     0                    66115.858852 114172.887  72.7%     -    7s
H    0     0                    66485.145579 114172.887  71.7%     -    7s
H    0     0                    66579.966450 114172.887  71.5%     -    7s
H    0     0                    66585.104542 114172.887  71.5%     -    7s
H    0     0                    67293.161626 114172.887  69.7%     -    7s
H    0     0                    68037.881889 114172.887  67.8%     -    7s
H    0     0                    68080.918369 114172.887  67.7%     -    7s
H    0     0                    68422.193320 114172.887  66.9%     -    7s
H    0     0                    68431.239322 114172.887  66.8%     -    7s
H    0     0                    68531.903182 114172.887  66.6%     -    7s
H    0     0                    68640.696365 109890.939  60.1%     -    8s
H    0     0                    68763.316373 109890.939  59.8%     -    8s
H    0     0                    68799.656082 109890.939  59.7%     -    8s
H    0     0                    68902.143436 109890.939  59.5%     -    8s
     0     0 109890.939    0  543 68902.1434 109890.939  59.5%     -    8s
H    0     0                    68980.798980 109022.176  58.0%     -    9s
H    0     0                    69051.098384 109022.176  57.9%     -    9s
H    0     0                    69068.515689 109022.176  57.8%     -    9s
     0     0 109022.176    0  518 69068.5157 109022.176  57.8%     -    9s
     0     0 108830.690    0  551 69068.5157 108830.690  57.6%     -    9s
H    0     0                    69068.762568 108763.705  57.5%     -    9s
H    0     0                    69084.124774 108763.705  57.4%     -    9s
H    0     0                    69117.764686 108763.705  57.4%     -    9s
H    0     0                    69167.936962 108763.705  57.2%     -    9s
     0     0 108763.705    0  552 69167.9370 108763.705  57.2%     -    9s
H    0     0                    69228.709605 108717.181  57.0%     -    9s
H    0     0                    69246.126909 108717.181  57.0%     -    9s
H    0     0                    69336.622866 108717.181  56.8%     -    9s
H    0     0                    69353.000357 108717.181  56.8%     -    9s
H    0     0                    69384.040619 108717.181  56.7%     -    9s
H    0     0                    69401.457924 108717.181  56.6%     -    9s
     0     0 108717.181    0  560 69401.4579 108717.181  56.6%     -    9s
     0     0 108713.364    0  563 69401.4579 108713.364  56.6%     -    9s
     0     0 106051.524    0  461 69401.4579 106051.524  52.8%     -   10s
     0     0 105404.129    0  509 69401.4579 105404.129  51.9%     -   11s
     0     0 105227.806    0  491 69401.4579 105227.806  51.6%     -   11s
     0     0 105189.346    0  496 69401.4579 105189.346  51.6%     -   11s
     0     0 105177.195    0  513 69401.4579 105177.195  51.5%     -   11s
     0     0 104112.013    0  504 69401.4579 104112.013  50.0%     -   12s
     0     0 103732.348    0  498 69401.4579 103732.348  49.5%     -   12s
     0     0 103624.688    0  537 69401.4579 103624.688  49.3%     -   13s
     0     0 103597.654    0  542 69401.4579 103597.654  49.3%     -   13s
     0     0 102936.195    0  532 69401.4579 102936.195  48.3%     -   14s
     0     0 102676.840    0  531 69401.4579 102676.840  47.9%     -   14s
     0     0 102613.281    0  539 69401.4579 102613.281  47.9%     -   14s
     0     0 102574.142    0  576 69401.4579 102574.142  47.8%     -   14s
     0     0 102558.907    0  599 69401.4579 102558.907  47.8%     -   14s
     0     0 102073.103    0  515 69401.4579 102073.103  47.1%     -   15s
     0     0 101897.329    0  564 69401.4579 101897.329  46.8%     -   16s
     0     0 101849.710    0  535 69401.4579 101849.710  46.8%     -   16s
     0     0 101824.197    0  552 69401.4579 101824.197  46.7%     -   16s
H    0     0                    69520.937693 101623.047  46.2%     -   17s
H    0     0                    70046.120772 101623.047  45.1%     -   17s
     0     0 101623.047    0  541 70046.1208 101623.047  45.1%     -   17s
     0     0 101501.829    0  637 70046.1208 101501.829  44.9%     -   17s
H    0     0                    71085.201816 101469.966  42.7%     -   17s
H    0     0                    71338.492474 101469.966  42.2%     -   17s
     0     0 101469.966    0  592 71338.4925 101469.966  42.2%     -   17s
     0     0 101317.430    0  504 71338.4925 101317.430  42.0%     -   18s
     0     0 101317.292    0  504 71338.4925 101317.292  42.0%     -   18s
     0     2 101317.197    0  504 71338.4925 101317.197  42.0%     -   20s
H   95   206                    71675.136427 99857.1705  39.3%  1204   26s
H  107   206                    71840.490883 99857.1705  39.0%  1132   26s
H  109   206                    72119.587671 99857.1705  38.5%  1123   26s
   314   352 98499.5688   11  508 72119.5877 99857.1705  38.5%   705   30s
H  508   519                    72301.300039 99857.1705  38.1%   667   34s
   518   638 96229.3984   21  311 72301.3000 99857.1705  38.1%   662   35s
H  644   715                    72411.054585 99857.1705  37.9%   594   36s
H  681   715                    72533.678394 99857.1705  37.7%   581   36s
  1136  1233 94104.4935   33  338 72533.6784 99809.6764  37.6%   479   40s
  1779  1760 88664.9717   38  366 72533.6784 99809.6764  37.6%   455   45s
H 1853  1830                    72533.727047 99809.6764  37.6%   457   47s
  2078  2142 87704.4822   42  259 72533.7270 99775.7190  37.6%   438   50s
H 2099  2142                    72677.079655 99775.7190  37.3%   437   50s
  2897  2972 82863.8683   60  326 72677.0797 99714.4932  37.2%   416   55s
  4440  4494 78265.1463  119  109 72677.0797 99706.3735  37.2%   349   61s
  4858  4583 77457.9420  142   97 72677.0797 99706.3735  37.2%   347   65s
H 4918  4619                    72853.046498 99662.6126  36.8%   350   66s
H 4969  4864                    73060.918421 99662.6126  36.4%   350   67s
H 5521  5026                    73587.440952 99651.2104  35.4%   345   74s
  5522  5019 95858.4667   20  504 73587.4410 99651.2104  35.4%   345   78s
  5527  5022 96139.5979   19  346 73587.4410 96859.2215  31.6%   344   80s
  5561  5045 75745.8600  120  361 73587.4410 93162.5216  26.6%   342   85s
  5625  5100     cutoff   17      73587.4410 92169.6138  25.3%   350   90s
H 5657  4881                    74585.226089 91974.5013  23.3%   351   90s
H 5671  4635                    74586.998834 91575.3672  22.8%   352   90s
H 5867  4420                    76108.940095 91319.7665  20.0%   352   92s
H 5994  4206                    76246.958779 90487.2168  18.7%   351   93s
H 6002  3997                    76639.945401 90487.2168  18.1%   351   93s
H 6016  3796                    76729.839015 90487.2168  17.9%   350   93s
H 6125  3637                    77634.792542 89559.7641  15.4%   350   94s
  6238  3631 82411.4219   33  219 77634.7925 89030.0500  14.7%   349   95s
H 6294  3436                    77657.647962 89030.0500  14.6%   349   95s
H 6375  3287                    77898.497577 89030.0500  14.3%   347   95s
H 6379  3125                    78275.202702 89030.0500  13.7%   347   95s
H 6383  2973                    78280.425255 89030.0500  13.7%   347   95s
H 6396  2825                    78361.027913 89030.0500  13.6%   347   95s
H 6504  2693                    78573.383864 89030.0500  13.3%   346   97s
H 6566  2542                    78602.672091 89030.0500  13.3%   344   97s
H 6694  2422                    78613.760990 89030.0500  13.2%   342   97s
H 6710  2300                    78614.133747 89030.0500  13.2%   342   97s
  7074  2239 79350.8156   22  303 78614.1337 88299.1698  12.3%   337  100s
H 7124  2110                    78714.653971 88298.6015  12.2%   336  100s
H 7819  1799                    78781.785256 85996.8772  9.16%   326  103s
H 7849  1717                    78818.881056 85996.8772  9.11%   325  104s
H 7858  1618                    78829.454679 85996.8772  9.09%   325  104s
H 7875  1523                    78840.750472 85996.8772  9.08%   325  104s
H 7930  1418                    79070.998015 85996.8772  8.76%   324  104s
  8291  1259 80721.2737   23  187 79070.9980 84979.6018  7.47%   318  105s
H 9278   761                    79080.240258 84331.1038  6.64%   304  107s
H 9331   658                    79111.459937 84331.1038  6.60%   303  107s
*12178  1651              90    79162.711765 80635.7361  1.86%   246  109s
*12273  1651             107    79590.543072 80635.7361  1.31%   245  109s
 13954  2236     cutoff   55      79590.5431 80455.7852  1.09%   220  110s
H15864  2117                    79745.891977 80352.2740  0.76%   198  110s
*18844  1997              85    79773.623478 80173.9168  0.50%   173  111s
*20463  1390              98    79804.581405 80098.4585  0.37%   162  111s

Cutting planes:
  Learned: 1
  Gomory: 5
  Implied bound: 17
  Projected implied bound: 16
  MIR: 307
  Mixing: 2
  Flow cover: 418
  RLT: 45
  Relax-and-lift: 101

Explored 23155 nodes (3436324 simplex iterations) in 112.18 seconds (159.46 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 79804.6 79773.6 79745.9 ... 78829.5

Optimal solution found (tolerance 1.00e-04)
Best objective 7.980458140525e+04, best bound 7.980458140525e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 112.19s
  Master Objective (UB) = 79804.58, θ = 248630.92
  Upper Bound (UB) = 79804.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 248630.92
  [DEBUG]   ✓ Scenario 0: θ = 248630.92 ≤ Q = 248630.92 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x23e2c6f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfdc1d391
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.428041e+13
Presolve removed 2555 rows and 1846 columns
Presolve time: 0.01s
Presolved: 538 rows, 543 columns, 1518 nonzeros
Found heuristic solution: objective 7260642.0420
Variable types: 369 continuous, 174 integer (174 binary)

Root relaxation: objective -1.933333e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -193333.30    0  125 7260642.04 -193333.30   103%     -    0s
H    0     0                    -156183.8965 -193333.30  23.8%     -    0s
H    0     0                    -156648.3422 -193333.30  23.4%     -    0s
*    0     0               0    -160300.2448 -160300.24  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 212

Explored 1 nodes (389 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -160300 -156648 -156184 ... 1.42804e+13
No other solutions better than -160300

Optimal solution found (tolerance 1.00e-04)
Best objective -1.603002448237e+05, best bound -1.603002448237e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 218990.45
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -160300.24
  [DEBUG]   S×d_nominal = 379290.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379290.69 + -160300.24 = 218990.45
  [DEBUG]   Current θ from Master = 248630.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 29640.47 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 50164.11
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 29640.4736, Absolute Gap = 29640.4736, Relative Gap = 0.371413
  Not converged yet (gap = 29640.47 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0x59662cfe
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 50164.1 (0.02s)
Loaded MIP start from previous solve with objective 50164.1

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.50s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 9.181311e+04, 9894 iterations, 1.27 seconds (1.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91813.1070    0  198 50164.1078 91813.1070  83.0%     -    1s
H    0     0                    50755.634399 91813.1070  80.9%     -    2s
H    0     0                    51591.955990 91813.1070  78.0%     -    2s
H    0     0                    51695.695414 91813.1070  77.6%     -    2s
     0     0 84288.7582    0  207 51695.6954 84288.7582  63.0%     -    3s
     0     0 84093.9505    0  229 51695.6954 84093.9505  62.7%     -    3s
     0     0 84081.2313    0  222 51695.6954 84081.2313  62.6%     -    3s
     0     0 84078.3583    0  229 51695.6954 84078.3583  62.6%     -    3s
     0     0 79454.1107    0  276 51695.6954 79454.1107  53.7%     -    5s
H    0     0                    51761.958410 79037.9173  52.7%     -    5s
     0     0 79037.9173    0  243 51761.9584 79037.9173  52.7%     -    5s
     0     0 78885.0275    0  252 51761.9584 78885.0275  52.4%     -    6s
     0     0 78869.5817    0  251 51761.9584 78869.5817  52.4%     -    6s
     0     0 78797.9712    0  252 51761.9584 78797.9712  52.2%     -    6s
     0     0 78795.5143    0  256 51761.9584 78795.5143  52.2%     -    6s
H    0     0                    52654.495997 76529.8882  45.3%     -    8s
H    0     0                    54069.435952 76529.8882  41.5%     -    8s
     0     0 76529.8882    0  286 54069.4360 76529.8882  41.5%     -    8s
H    0     0                    54316.944792 76527.4502  40.9%     -    8s
H    0     0                    54960.589557 76527.4502  39.2%     -    8s
H    0     0                    56201.439734 76527.4502  36.2%     -    8s
H    0     0                    56871.905494 76527.4502  34.6%     -    8s
H    0     0                    57432.088479 76527.4502  33.2%     -    8s
     0     0 75815.5024    0  297 57432.0885 75815.5024  32.0%     -    8s
     0     0 75537.8994    0  310 57432.0885 75537.8994  31.5%     -    9s
     0     0 75423.4124    0  306 57432.0885 75423.4124  31.3%     -    9s
     0     0 75372.1490    0  311 57432.0885 75372.1490  31.2%     -    9s
     0     0 75358.8508    0  319 57432.0885 75358.8508  31.2%     -   10s
     0     0 75350.4377    0  322 57432.0885 75350.4377  31.2%     -   10s
     0     0 75348.9904    0  319 57432.0885 75348.9904  31.2%     -   10s
     0     0 74165.6836    0  326 57432.0885 74165.6836  29.1%     -   12s
     0     0 73679.0863    0  376 57432.0885 73679.0863  28.3%     -   13s
     0     0 73477.7749    0  317 57432.0885 73477.7749  27.9%     -   14s
     0     0 73382.3328    0  322 57432.0885 73382.3328  27.8%     -   14s
     0     0 73363.9057    0  441 57432.0885 73363.9057  27.7%     -   14s
     0     0 73357.3332    0  449 57432.0885 73357.3332  27.7%     -   15s
     0     0 73356.9788    0  454 57432.0885 73356.9788  27.7%     -   15s
     0     0 73049.6438    0  295 57432.0885 73049.6438  27.2%     -   16s
H    0     0                    57685.669803 73049.5625  26.6%     -   16s
H    0     0                    57835.020587 73049.5625  26.3%     -   16s
H    0     0                    57888.122098 73049.5625  26.2%     -   16s
H    0     0                    57974.169865 73049.5625  26.0%     -   16s
H    0     0                    58048.397724 73049.5625  25.8%     -   16s
H    0     0                    58135.416110 73049.5625  25.7%     -   16s
     0     0 72834.1103    0  331 58135.4161 72834.1103  25.3%     -   16s
     0     0 72759.9352    0  334 58135.4161 72759.9352  25.2%     -   17s
     0     0 72737.2018    0  349 58135.4161 72737.2018  25.1%     -   17s
     0     0 72719.1292    0  404 58135.4161 72719.1292  25.1%     -   17s
     0     0 72699.8223    0  400 58135.4161 72699.8223  25.1%     -   17s
     0     0 72694.3522    0  407 58135.4161 72694.3522  25.0%     -   17s
     0     0 72693.0937    0  404 58135.4161 72693.0937  25.0%     -   18s
     0     0 72517.1526    0  310 58135.4161 72517.1526  24.7%     -   18s
     0     0 72447.6481    0  307 58135.4161 72447.6481  24.6%     -   19s
     0     0 72434.5185    0  367 58135.4161 72434.5185  24.6%     -   19s
     0     0 72427.2113    0  310 58135.4161 72427.2113  24.6%     -   20s
     0     0 72423.1658    0  312 58135.4161 72423.1658  24.6%     -   20s
     0     0 72334.2907    0  292 58135.4161 72334.2907  24.4%     -   20s
H    0     0                    58236.462884 72333.5701  24.2%     -   20s
H    0     0                    58310.690744 72333.5701  24.0%     -   20s
     0     0 72323.2109    0  303 58310.6907 72323.2109  24.0%     -   21s
     0     0 72317.2865    0  294 58310.6907 72317.2865  24.0%     -   21s
     0     0 72314.4308    0  295 58310.6907 72314.4308  24.0%     -   21s
     0     0 72296.7282    0  365 58310.6907 72296.7282  24.0%     -   21s
     0     0 72290.7268    0  430 58310.6907 72290.7268  24.0%     -   22s
     0     0 72287.1140    0  369 58310.6907 72287.1140  24.0%     -   22s
     0     0 72264.3028    0  382 58310.6907 72264.3028  23.9%     -   22s
H    0     0                    58318.116259 72264.0260  23.9%     -   22s
     0     0 72242.1009    0  305 58318.1163 72242.1009  23.9%     -   23s
     0     0 72235.5781    0  308 58318.1163 72235.5781  23.9%     -   23s
     0     0 72234.5112    0  307 58318.1163 72234.5112  23.9%     -   23s
     0     0 72219.7807    0  311 58318.1163 72219.7807  23.8%     -   23s
     0     0 72215.8132    0  308 58318.1163 72215.8132  23.8%     -   24s
     0     0 72210.8209    0  318 58318.1163 72210.8209  23.8%     -   24s
     0     0 72207.5209    0  323 58318.1163 72207.5209  23.8%     -   25s
     0     0 72185.9185    0  372 58318.1163 72185.9185  23.8%     -   25s
     0     0 72185.2809    0  372 58318.1163 72185.2809  23.8%     -   25s
H    0     0                    58873.813984 72184.8501  22.6%     -   28s
H    0     0                    58912.688356 72184.8501  22.5%     -   28s
H    0     0                    59131.534028 72184.8501  22.1%     -   29s
     0     2 72184.8501    0  372 59131.5340 72184.8501  22.1%     -   29s
     1     4 72146.5528    1  364 59131.5340 72184.4766  22.1%   427   30s
H   31    64                    59179.626425 71520.6856  20.9%  1283   34s
    63    96 71211.7511    6  452 59179.6264 71375.0348  20.6%  1118   36s
H   97   128                    59242.143949 71375.0348  20.5%   974   37s
H  103   128                    59479.651344 71375.0348  20.0%   959   37s
H  112   128                    59662.031862 71375.0348  19.6%   939   37s
H  127   231                    59773.620674 71375.0348  19.4%   940   39s
   240   305 69737.4505    9  449 59773.6207 71375.0348  19.4%   710   40s
   659   666 68942.8627   15  371 59773.6207 71375.0348  19.4%   466   45s
  1067   987 68214.5824   21  297 59773.6207 71186.4035  19.1%   410   50s
  1217  1083 62612.7706   25  266 59773.6207 71186.4035  19.1%   408   55s
  1568  1399 65991.8007   29  257 59773.6207 70744.4272  18.4%   381   60s
  1973  1635 61947.9538   37  217 59773.6207 70604.7901  18.1%   371   67s
  2276  1915 64731.5242   19  314 59773.6207 70572.4315  18.1%   369   71s
  2746  2162 69354.1933   13  305 59773.6207 70448.3722  17.9%   360   76s
  3077  2393 66906.7885   18  220 59773.6207 70448.3722  17.9%   357   80s
  3711  2690 66334.0817   19  264 59773.6207 70395.6817  17.8%   346   85s
  4153  2799 61938.9659   25  200 59773.6207 69935.6483  17.0%   350   92s
  4254  2934 61457.7428   27  147 59773.6207 69935.6483  17.0%   352   95s
  4380  2935 67536.7587   12  372 59773.6207 69935.6483  17.0%   348  104s
  4382  2936 66128.6003   18   67 59773.6207 69935.6483  17.0%   348  106s
  4386  2939 64596.6286   24  304 59773.6207 69935.6483  17.0%   348  110s
  4396  2946 61745.4407   24  309 59773.6207 69935.6483  17.0%   347  115s
  4406  2952 68539.2271   19  319 59773.6207 69935.6483  17.0%   346  122s
  4407  2953 62352.8949   26  319 59773.6207 69935.6483  17.0%   346  125s
  4422  2974 69935.6483   13  305 59773.6207 69935.6483  17.0%   352  130s
  4494  3028 67318.4108   16  301 59773.6207 69356.1240  16.0%   358  135s
  4786  3082 62008.9442   20  274 59773.6207 68891.1808  15.3%   368  140s
  4994  3065 62403.8609   22  203 59773.6207 68891.1808  15.3%   371  145s
  5215  3056 60206.2022   26  232 59773.6207 67665.4339  13.2%   377  150s
  5537  3022 63031.4196   23  179 59773.6207 66425.8684  11.1%   375  155s
  5832  3010 61641.4320   26  147 59773.6207 66067.5712  10.5%   376  160s
  6508  2791     cutoff   25      59773.6207 65709.1336  9.93%   370  166s
  7051  2589 60279.7328   18  188 59773.6207 64513.1272  7.93%   371  170s
  8144  1951     cutoff   18      59773.6207 62349.9690  4.31%   361  176s

Cutting planes:
  Learned: 1
  MIR: 227
  Mixing: 1
  Flow cover: 307
  RLT: 3
  Relax-and-lift: 37

Explored 8908 nodes (3145380 simplex iterations) in 177.87 seconds (290.37 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 59773.6 59662 59479.7 ... 58310.7

Optimal solution found (tolerance 1.00e-04)
Best objective 5.977362067430e+04, best bound 5.977362067430e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 177.88s
  Master Objective (UB) = 59773.62, θ = 221579.40
  Upper Bound (UB) = 59773.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 221579.40
  [DEBUG]   ✓ Scenario 0: θ = 221579.40 ≤ Q = 221579.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 221579.40 ≤ Q = 221579.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6e58ab7e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6e58ab7e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.378558e+13
Presolve removed 2555 rows and 1846 columns
Presolve time: 0.01s
Presolved: 538 rows, 543 columns, 1518 nonzeros
Found heuristic solution: objective 6939811.0826
Variable types: 369 continuous, 174 integer (174 binary)

Root relaxation: objective -1.950484e+05, 272 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -195048.43    0  134 6939811.08 -195048.43   103%     -    0s
H    0     0                    -155816.5782 -195048.43  25.2%     -    0s
H    0     0                    -156124.3060 -195048.43  24.9%     -    0s
H    0     0                    -171527.4988 -195048.43  13.7%     -    0s
H    0     0                    -171685.1646 -183139.29  6.67%     -    0s
     0     0 -183139.29    0   80 -171685.16 -183139.29  6.67%     -    0s
H    0     0                    -181228.6169 -183128.68  1.05%     -    0s
     0     0 -182650.65    0   79 -181228.62 -182650.65  0.78%     -    0s
     0     0 -182648.49    0   79 -181228.62 -182648.49  0.78%     -    0s
H    0     0                    -181821.1935 -182104.96  0.16%     -    0s
     0     0 -182104.96    0   27 -181821.19 -182104.96  0.16%     -    0s
     0     0 -182104.96    0   22 -181821.19 -182104.96  0.16%     -    0s
H    0     0                    -181854.7235 -182050.74  0.11%     -    0s
     0     0 -182050.74    0   24 -181854.72 -182050.74  0.11%     -    0s
     0     0 -181977.60    0   21 -181854.72 -181977.60  0.07%     -    0s
     0     0 -181923.38    0   11 -181854.72 -181923.38  0.04%     -    0s
     0     0          -    0      -181854.72 -181864.90  0.01%     -    0s

Cutting planes:
  Gomory: 33
  Implied bound: 2
  MIR: 86
  Flow cover: 4
  RLT: 102
  Relax-and-lift: 4
  BQP: 3

Explored 1 nodes (638 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -181855 -181821 -181229 ... 1.37856e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.818547234828e+05, best bound -1.818648997214e+05, gap 0.0056%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 199338.80
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -181854.72
  [DEBUG]   S×d_nominal = 381193.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 381193.52 + -181854.72 = 199338.80
  [DEBUG]   Current θ from Master = 221579.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22240.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 37533.02
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 9609.5129, Absolute Gap = 9609.5129, Relative Gap = 0.160765
  Not converged yet (gap = 9609.51 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0x7d6a6010
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 37533 (0.03s)
MIP start from previous solve produced solution with objective 37533 (0.03s)
Loaded MIP start from previous solve with objective 37533

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.73s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43487    7.0768677e+04   0.000000e+00   1.234959e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   14685    8.6351643e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 8.635164e+04, 14685 iterations, 4.58 seconds (5.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86351.6428    0   69 37533.0167 86351.6428   130%     -    5s
H    0     0                    38138.067017 86351.6428   126%     -    5s
H    0     0                    38191.327528 86351.6428   126%     -    5s
H    0     0                    42170.045539 86351.6428   105%     -    6s
H    0     0                    56197.930820 86351.6428  53.7%     -    6s
H    0     0                    56629.431188 86351.6428  52.5%     -    6s
     0     0 80025.5709    0  117 56629.4312 80025.5709  41.3%     -    8s
     0     0 79404.9544    0  130 56629.4312 79404.9544  40.2%     -    9s
     0     0 79404.9544    0  135 56629.4312 79404.9544  40.2%     -    9s
     0     0 79404.9544    0  134 56629.4312 79404.9544  40.2%     -    9s
H    0     0                    57267.284500 75712.9298  32.2%     -   12s
     0     0 75613.3903    0  214 57267.2845 75613.3903  32.0%     -   12s
     0     0 75124.0013    0  218 57267.2845 75124.0013  31.2%     -   13s
     0     0 74864.5621    0  257 57267.2845 74864.5621  30.7%     -   13s
     0     0 74781.8684    0  220 57267.2845 74781.8684  30.6%     -   14s
     0     0 74764.2195    0  258 57267.2845 74764.2195  30.6%     -   14s
     0     0 74763.3130    0  259 57267.2845 74763.3130  30.6%     -   14s
     0     0 73496.8767    0  278 57267.2845 73496.8767  28.3%     -   17s
     0     0 72925.6801    0  272 57267.2845 72925.6801  27.3%     -   18s
     0     0 72672.2115    0  288 57267.2845 72672.2115  26.9%     -   19s
     0     0 72428.2884    0  297 57267.2845 72428.2884  26.5%     -   20s
     0     0 72381.6279    0  333 57267.2845 72381.6279  26.4%     -   20s
     0     0 72326.4497    0  297 57267.2845 72326.4497  26.3%     -   20s
     0     0 72302.9244    0  296 57267.2845 72302.9244  26.3%     -   21s
     0     0 72286.4380    0  294 57267.2845 72286.4380  26.2%     -   21s
     0     0 72271.8841    0  300 57267.2845 72271.8841  26.2%     -   21s
     0     0 72269.1298    0  296 57267.2845 72269.1298  26.2%     -   21s
     0     0 72268.8480    0  296 57267.2845 72268.8480  26.2%     -   21s
     0     0 71725.3742    0  311 57267.2845 71725.3742  25.2%     -   24s
     0     0 71566.7351    0  313 57267.2845 71566.7351  25.0%     -   25s
     0     0 71454.9918    0  312 57267.2845 71454.9918  24.8%     -   26s
     0     0 71353.8305    0  318 57267.2845 71353.8305  24.6%     -   26s
     0     0 71314.1452    0  312 57267.2845 71314.1452  24.5%     -   26s
     0     0 71306.0639    0  323 57267.2845 71306.0639  24.5%     -   26s
     0     0 71303.1364    0  327 57267.2845 71303.1364  24.5%     -   26s
     0     0 71293.1355    0  323 57267.2845 71293.1355  24.5%     -   27s
     0     0 71290.0456    0  327 57267.2845 71290.0456  24.5%     -   27s
     0     0 71287.3118    0  328 57267.2845 71287.3118  24.5%     -   27s
     0     0 71286.4616    0  328 57267.2845 71286.4616  24.5%     -   27s
     0     0 71198.9526    0  368 57267.2845 71198.9526  24.3%     -   28s
     0     0 71176.5314    0  368 57267.2845 71176.5314  24.3%     -   28s
     0     0 71165.8104    0  332 57267.2845 71165.8104  24.3%     -   29s
     0     0 71164.6050    0  333 57267.2845 71164.6050  24.3%     -   29s
     0     0 71139.0957    0  327 57267.2845 71139.0957  24.2%     -   29s
     0     0 71126.3595    0  370 57267.2845 71126.3595  24.2%     -   30s
     0     0 71124.5745    0  368 57267.2845 71124.5745  24.2%     -   30s
     0     0 71107.6616    0  376 57267.2845 71107.6616  24.2%     -   31s
     0     0 71101.4580    0  380 57267.2845 71101.4580  24.2%     -   32s
     0     0 71101.4580    0  329 57267.2845 71101.4580  24.2%     -   32s
     0     0 71097.1741    0  388 57267.2845 71097.1741  24.1%     -   32s
     0     0 71093.0074    0  383 57267.2845 71093.0074  24.1%     -   34s
     0     0 71091.0864    0  384 57267.2845 71091.0864  24.1%     -   34s
     0     0 71090.9755    0  385 57267.2845 71090.9755  24.1%     -   34s
     0     0 71087.5458    0  340 57267.2845 71087.5458  24.1%     -   35s
     0     0 71085.7694    0  345 57267.2845 71085.7694  24.1%     -   35s
     0     0 71084.1101    0  344 57267.2845 71084.1101  24.1%     -   35s
     0     0 71082.5103    0  344 57267.2845 71082.5103  24.1%     -   36s
     0     2 71082.4756    0  344 57267.2845 71082.4756  24.1%     -   41s
     7    16 70455.8439    3  370 57267.2845 70736.4375  23.5%  1697   46s
    31    64 69867.9537    5  342 57267.2845 70266.7809  22.7%  2260   51s
    95   193 69247.6804    7  334 57267.2845 69866.1271  22.0%  1626   55s
   269   339 68571.2406   10  314 57267.2845 69866.1271  22.0%  1033   60s
H  295   339                    57304.605878 69866.1271  21.9%   994   60s
   474   553 68048.9994   13  303 57304.6059 69866.1271  21.9%   875   66s
H  611   616                    57444.442229 69866.1271  21.6%   799   69s
   619   701 67612.7237   16  308 57444.4422 69866.1271  21.6%   793   71s
   877   899 66924.9965   18  345 57444.4422 69866.1271  21.6%   688   77s
  1031   994 66413.3240   20  342 57444.4422 69519.2874  21.0%   675   81s
  1109  1067 65920.9299   22  296 57444.4422 69482.5673  21.0%   679   85s
  1255  1230 65590.2846   25  291 57444.4422 69357.0332  20.7%   668   91s
  1502  1438 64417.8918   28  238 57444.4422 69321.8306  20.7%   644   97s
  1729  1671 63239.8717   30  225 57444.4422 69321.8306  20.7%   624  102s
  1874  1816 63566.7600   33  214 57444.4422 69321.8306  20.7%   606  105s
  2266  2160 60263.5895   35  240 57444.4422 69217.7621  20.5%   555  111s
  2684  2456     cutoff   38      57444.4422 69050.8379  20.2%   525  117s
  2927  2518 66681.4323   10  285 57444.4422 68916.5180  20.0%   519  121s
  3036  2606 66172.5219   12  259 57444.4422 68916.5180  20.0%   520  126s
  3151  2703 65097.4828   14  245 57444.4422 68900.1795  19.9%   516  133s
  3221  2746 64746.6824   15  229 57444.4422 68900.1795  19.9%   515  135s
H 3269  2744                    57707.169786 68900.1795  19.4%   512  135s
  3490  2993 63458.8045   19  227 57707.1698 68854.5649  19.3%   513  142s
  3696  2994 59053.5791   28  344 57707.1698 68819.3524  19.3%   515  154s
  3698  2995 63361.5085   22   69 57707.1698 68819.3524  19.3%   515  157s
  3699  2996 65512.0331   15  233 57707.1698 68819.3524  19.3%   514  160s
  3704  2999 61260.2214   40  332 57707.1698 68819.3524  19.3%   514  165s
  3710  3003 62127.7364   26  381 57707.1698 68819.3524  19.3%   513  170s
  3715  3007 61964.9959   24  337 57707.1698 68819.3524  19.3%   512  175s
  3720  3010 61872.8855   52  339 57707.1698 68819.3524  19.3%   511  180s
  3722  3011 66570.4586   18  339 57707.1698 68819.3524  19.3%   511  187s
  3723  3015 68819.3524   16  371 57707.1698 68819.3524  19.3%   519  194s
  3725  3018 68819.3524   17  371 57707.1698 68819.3524  19.3%   519  196s
  3737  3038 68819.3524   19  327 57707.1698 68819.3524  19.3%   522  201s
  3753  3065 68819.3524   20  333 57707.1698 68819.3524  19.3%   526  206s
  3817  3127 68819.3524   22  334 57707.1698 68819.3524  19.3%   564  213s
  3893  3127 62413.6295   23  308 57707.1698 68819.3524  19.3%   573  216s
  3975  3148 61533.1592   24  297 57707.1698 68819.3524  19.3%   589  221s
H 4011  2985                    57738.337651 68819.3524  19.2%   596  221s
  4075  3072 66603.6535   25  319 57738.3377 68819.3524  19.2%   604  226s
  4181  3083 64284.0914   27  259 57738.3377 68819.3524  19.2%   612  231s
  4258  3091 63544.0717   28  240 57738.3377 68819.3524  19.2%   617  236s
  4353  3086 62638.2058   29  236 57738.3377 68819.3524  19.2%   619  241s
  4464  3080 61402.2817   30  205 57738.3377 68668.0400  18.9%   627  248s
  4530  3068     cutoff   30      57738.3377 68668.0400  18.9%   631  251s
  4657  3066 59590.8800   32  195 57738.3377 68668.0400  18.9%   638  257s
  4738  3058 58847.4098   33  182 57738.3377 68402.2544  18.5%   640  260s
  4922  3023     cutoff   36      57738.3377 68402.2544  18.5%   642  268s
  5009  3027 58237.5955   39  149 57738.3377 66822.3078  15.7%   644  271s
  5218  3017 59678.0357   29  170 57738.3377 66822.3078  15.7%   640  276s
  5368  2990 57780.0257   30  164 57738.3377 66822.3078  15.7%   636  280s
  5718  2958 61082.1122   28  211 57738.3377 66434.5183  15.1%   633  287s
  5892  2929     cutoff   30      57738.3377 66256.5052  14.8%   635  291s
  6068  2900     cutoff   29      57738.3377 65964.1294  14.2%   637  295s
  6305  2849 60820.9100   28  228 57738.3377 65625.8564  13.7%   643  300s
  6351  2864 60001.5294   29  209 57738.3377 65625.8564  13.7%   644  305s
  6613  2843 58289.3347   31  163 57738.3377 65541.5160  13.5%   643  313s
  6841  2843     cutoff   33      57738.3377 64746.2244  12.1%   640  317s
  7117  2789 59418.8418   31  210 57738.3377 64676.0685  12.0%   635  321s
* 7304  2582              52    57762.613528 64676.0685  12.0%   631  321s
  7427  2581 58367.8898   27  140 57762.6135 64583.2740  11.8%   634  325s
  7990  2428 58828.1193   25  132 57762.6135 63717.1995  10.3%   627  333s
  8331  2322     cutoff   30      57762.6135 63514.0046  10.0%   624  337s
  8677  2208 58535.5431   29  249 57762.6135 63352.3069  9.68%   621  342s
  9055  2104 58135.2615   29  188 57762.6135 62977.0578  9.03%   618  347s
  9450  1932 58359.1266   28  159 57762.6135 62592.5143  8.36%   615  352s
  9820  1753     cutoff   34      57762.6135 62059.1883  7.44%   615  357s
 10199  1565     cutoff   32      57762.6135 61904.2556  7.17%   616  361s
 10512  1363 57977.5873   29  206 57762.6135 61392.7067  6.28%   616  366s
 11016  1112 58234.1327   30  181 57762.6135 60943.3879  5.51%   610  371s
 11653   623 57774.3646   30  143 57762.6135 60516.0685  4.77%   599  376s
 12534   439     cutoff   42      57762.6135 59781.4150  3.49%   578  380s
*12645   439              64    57852.537606 59756.9658  3.29%   573  380s
*13403   439              53    57913.264724 59643.3458  2.99%   547  380s
*15895    30              83    57980.319567 58160.1547  0.31%   471  384s
*16413    30              72    58060.052175 58135.2613  0.13%   457  384s

Cutting planes:
  MIR: 331
  Flow cover: 524
  RLT: 7
  Relax-and-lift: 49

Explored 16870 nodes (7565302 simplex iterations) in 384.26 seconds (725.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 58060.1 57980.3 57913.3 ... 57267.3

Optimal solution found (tolerance 1.00e-04)
Best objective 5.806005217511e+04, best bound 5.806005217511e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 384.27s
  Master Objective (UB) = 58060.05, θ = 220685.41
  Upper Bound (UB) = 58060.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 220685.41
  [DEBUG]   ✓ Scenario 0: θ = 220685.41 ≤ Q = 220685.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 220685.41 ≤ Q = 220685.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 220685.41 ≤ Q = 220685.41 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x437aa599
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbc855a67
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.359843e+13
Presolve removed 2555 rows and 1846 columns
Presolve time: 0.01s
Presolved: 538 rows, 543 columns, 1518 nonzeros
Found heuristic solution: objective 6876867.3010
Variable types: 369 continuous, 174 integer (174 binary)

Root relaxation: objective -1.944092e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194409.23    0  135 6876867.30 -194409.23   103%     -    0s
H    0     0                    -156973.9068 -194409.23  23.8%     -    0s
H    0     0                    -169677.4699 -194409.23  14.6%     -    0s
     0     0 -181562.78    0   99 -169677.47 -181562.78  7.00%     -    0s
H    0     0                    -178970.9159 -181451.29  1.39%     -    0s
     0     0 -181292.52    0   80 -178970.92 -181292.52  1.30%     -    0s
     0     0 -180561.86    0   59 -178970.92 -180561.86  0.89%     -    0s
H    0     0                    -179994.6776 -180561.86  0.32%     -    0s
     0     0 -180517.49    0   55 -179994.68 -180517.49  0.29%     -    0s
H    0     0                    -180002.2224 -180496.78  0.27%     -    0s
     0     0 -180496.78    0   58 -180002.22 -180496.78  0.27%     -    0s
     0     0 -180494.14    0   58 -180002.22 -180494.14  0.27%     -    0s
     0     0 -180208.25    0   28 -180002.22 -180208.25  0.11%     -    0s
     0     0 -180197.03    0   23 -180002.22 -180197.03  0.11%     -    0s
     0     0 -180110.99    0    7 -180002.22 -180110.99  0.06%     -    0s
     0     0 -180105.99    0    4 -180002.22 -180105.99  0.06%     -    0s
     0     0 -180084.03    0    5 -180002.22 -180084.03  0.05%     -    0s
     0     0 -180074.09    0    7 -180002.22 -180074.09  0.04%     -    0s
H    0     0                    -180041.1059 -180074.09  0.02%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 3
  Flow cover: 5
  RLT: 1

Explored 1 nodes (776 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -180041 -180002 -179995 ... 1.35984e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.800411058524e+05, best bound -1.800583078292e+05, gap 0.0096%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 199714.14
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -180041.11
  [DEBUG]   S×d_nominal = 379755.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379755.25 + -180041.11 = 199714.14
  [DEBUG]   Current θ from Master = 220685.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20971.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 37088.79
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 7895.9444, Absolute Gap = 7895.9444, Relative Gap = 0.135996
  Not converged yet (gap = 7895.94 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0x2deb0c4a
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 37088.8 (0.08s)
Loaded MIP start from previous solve with objective 37088.8

Presolve removed 25452 rows and 10332 columns
Presolve time: 1.95s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29061    1.0591423e+04   0.000000e+00   8.779411e+07      5s
Concurrent spin time: 0.18s

Solved with dual simplex

Root relaxation: objective 8.553917e+04, 19965 iterations, 7.41 seconds (9.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 85539.1750    0   73 37088.7868 85539.1750   131%     -    9s
H    0     0                    43717.622729 85539.1750  95.7%     -    9s
H    0     0                    50853.316269 85539.1750  68.2%     -   10s
H    0     0                    51077.453398 85539.1750  67.5%     -   10s
H    0     0                    51625.839260 85539.1750  65.7%     -   10s
H    0     0                    52705.647514 85539.1750  62.3%     -   10s
H    0     0                    52757.709440 85539.1750  62.1%     -   10s
H    0     0                    52784.150706 85539.1750  62.1%     -   10s
H    0     0                    53745.516848 85539.1750  59.2%     -   10s
H    0     0                    54042.664918 85539.1750  58.3%     -   10s
H    0     0                    54104.465621 85539.1750  58.1%     -   10s
H    0     0                    55153.115722 85539.1750  55.1%     -   10s
H    0     0                    55516.973086 85539.1750  54.1%     -   10s
H    0     0                    55551.331593 85539.1750  54.0%     -   10s
H    0     0                    55650.294694 85539.1750  53.7%     -   10s
     0     0 79237.1144    0  137 55650.2947 79237.1144  42.4%     -   14s
     0     0 78728.5645    0  129 55650.2947 78728.5645  41.5%     -   16s
     0     0 78728.5645    0  121 55650.2947 78728.5645  41.5%     -   17s
     0     0 78728.5645    0  131 55650.2947 78728.5645  41.5%     -   17s
     0     0 78728.5645    0  131 55650.2947 78728.5645  41.5%     -   18s
     0     0 78728.5645    0  129 55650.2947 78728.5645  41.5%     -   18s
H    0     0                    55922.803012 75610.8887  35.2%     -   23s
     0     0 75610.8887    0  183 55922.8030 75610.8887  35.2%     -   23s
     0     0 74765.2706    0  191 55922.8030 74765.2706  33.7%     -   26s
     0     0 74612.8966    0  210 55922.8030 74612.8966  33.4%     -   27s
     0     0 74537.3349    0  212 55922.8030 74537.3349  33.3%     -   28s
     0     0 74521.8735    0  219 55922.8030 74521.8735  33.3%     -   28s
     0     0 74519.9894    0  223 55922.8030 74519.9894  33.3%     -   28s
     0     0 74518.5017    0  223 55922.8030 74518.5017  33.3%     -   28s
     0     0 74518.4964    0  223 55922.8030 74518.4964  33.3%     -   28s
     0     0 73089.0168    0  244 55922.8030 73089.0168  30.7%     -   35s
     0     0 72670.9302    0  289 55922.8030 72670.9302  29.9%     -   38s
     0     0 72561.5434    0  268 55922.8030 72561.5434  29.8%     -   39s
     0     0 72493.2642    0  268 55922.8030 72493.2642  29.6%     -   40s
     0     0 72471.1125    0  268 55922.8030 72471.1125  29.6%     -   41s
     0     0 72467.1025    0  274 55922.8030 72467.1025  29.6%     -   41s
     0     0 72445.0778    0  271 55922.8030 72445.0778  29.5%     -   42s
     0     0 72443.8590    0  273 55922.8030 72443.8590  29.5%     -   42s
H    0     0                    55968.444824 71404.6413  27.6%     -   47s
     0     0 71404.6413    0  343 55968.4448 71404.6413  27.6%     -   47s
H    0     0                    55983.076057 71191.7158  27.2%     -   49s
     0     0 71191.7158    0  352 55983.0761 71191.7158  27.2%     -   49s
     0     0 70983.7506    0  356 55983.0761 70983.7506  26.8%     -   51s
     0     0 70891.0003    0  357 55983.0761 70891.0003  26.6%     -   52s
     0     0 70820.4750    0  357 55983.0761 70820.4750  26.5%     -   53s
     0     0 70768.3047    0  356 55983.0761 70768.3047  26.4%     -   54s
     0     0 70762.7541    0  359 55983.0761 70762.7541  26.4%     -   55s
     0     0 70756.7196    0  364 55983.0761 70756.7196  26.4%     -   55s
     0     0 70752.6666    0  367 55983.0761 70752.6666  26.4%     -   56s
     0     0 70723.8556    0  370 55983.0761 70723.8556  26.3%     -   57s
     0     0 70718.4280    0  368 55983.0761 70718.4280  26.3%     -   57s
     0     0 70713.8414    0  365 55983.0761 70713.8414  26.3%     -   57s
     0     0 70713.0764    0  367 55983.0761 70713.0764  26.3%     -   57s
     0     0 70558.4744    0  328 55983.0761 70558.4744  26.0%     -   60s
H    0     0                    56412.471271 70558.1923  25.1%     -   60s
H    0     0                    56489.327801 70558.1923  24.9%     -   60s
     0     0 70481.7327    0  323 56489.3278 70481.7327  24.8%     -   61s
     0     0 70422.5715    0  332 56489.3278 70422.5715  24.7%     -   61s
     0     0 70406.8995    0  328 56489.3278 70406.8995  24.6%     -   62s
     0     0 70387.2770    0  335 56489.3278 70387.2770  24.6%     -   63s
     0     0 70383.2272    0  336 56489.3278 70383.2272  24.6%     -   63s
     0     0 70381.0770    0  334 56489.3278 70381.0770  24.6%     -   63s
     0     0 70380.1822    0  339 56489.3278 70380.1822  24.6%     -   63s
     0     0 70317.4123    0  395 56489.3278 70317.4123  24.5%     -   65s
     0     0 70303.9750    0  399 56489.3278 70303.9750  24.5%     -   67s
     0     0 70292.9109    0  402 56489.3278 70292.9109  24.4%     -   68s
     0     0 70290.6612    0  357 56489.3278 70290.6612  24.4%     -   68s
     0     0 70288.1310    0  400 56489.3278 70288.1310  24.4%     -   68s
     0     0 70287.5574    0  404 56489.3278 70287.5574  24.4%     -   68s
     0     0 70263.6353    0  391 56489.3278 70263.6353  24.4%     -   70s
     0     0 70259.1211    0  402 56489.3278 70259.1211  24.4%     -   70s
     0     0 70256.3596    0  395 56489.3278 70256.3596  24.4%     -   71s
     0     0 70254.9161    0  399 56489.3278 70254.9161  24.4%     -   71s
     0     0 70236.1459    0  356 56489.3278 70236.1459  24.3%     -   72s
H    0     0                    56506.367516 70235.7074  24.3%     -   74s
     0     0 70234.9061    0  355 56506.3675 70234.9061  24.3%     -   74s
     0     0 70224.4149    0  407 56506.3675 70224.4149  24.3%     -   75s
     0     0 70221.9181    0  405 56506.3675 70221.9181  24.3%     -   76s
     0     0 70218.6043    0  359 56506.3675 70218.6043  24.3%     -   76s
     0     0 70216.6703    0  418 56506.3675 70216.6703  24.3%     -   76s
     0     0 70216.4751    0  420 56506.3675 70216.4751  24.3%     -   77s
     0     0 70209.0939    0  415 56506.3675 70209.0939  24.2%     -   78s
     0     0 70206.0322    0  406 56506.3675 70206.0322  24.2%     -   78s
     0     0 70199.4508    0  408 56506.3675 70199.4508  24.2%     -   79s
     0     0 70199.2027    0  408 56506.3675 70199.2027  24.2%     -   80s
     0     2 70196.2724    0  408 56506.3675 70196.2724  24.2%     -   93s
     1     4 70164.2518    1  400 56506.3675 70196.2069  24.2%  1310   95s
     3     8 70037.0831    2  406 56506.3675 70163.2781  24.2%  2494  102s
     7    16 69788.2037    3  348 56506.3675 70036.3986  23.9%  4527  107s
    15    32 69625.9410    4  387 56506.3675 69785.6564  23.5%  5047  112s
    31    51 67745.4219    5  314 56506.3675 69625.5696  23.2%  5585  123s
    50    83 67320.9452    6  304 56506.3675 69625.5696  23.2%  7299  129s
H   55    83                    56520.829009 69625.5696  23.2%  6917  129s
H   65    83                    56594.160610 69625.5696  23.0%  6392  129s
    82   173 67201.7875    7  293 56594.1606 69625.5696  23.0%  5409  138s
   172   284 66850.5017    9  293 56594.1606 69625.5696  23.0%  3839  145s
   375   467 65127.7360   10  267 56594.1606 69625.5696  23.0%  2592  152s
   466   557 66443.8157   10  271 56594.1606 69625.5696  23.0%  2295  155s
   654   747 66295.4109   10  263 56594.1606 69625.5696  23.0%  1889  162s
   746   822 66408.2167   11  291 56594.1606 69625.5696  23.0%  1759  165s
   931   979 65566.0379   11  256 56594.1606 69485.7914  22.8%  1587  174s
  1023  1027 65858.9488   11  289 56594.1606 69485.7914  22.8%  1531  179s
H 1040  1027                    56631.654247 69485.7914  22.7%  1511  179s
  1093  1070 65815.4769   11  270 56631.6542 69485.7914  22.7%  1506  183s
H 1097  1070                    56819.889353 69485.7914  22.3%  1506  183s
  1180  1140 65842.3229   12  273 56819.8894 69485.7914  22.3%  1473  187s
  1282  1195 65662.0419   12  263 56819.8894 69485.7914  22.3%  1446  194s
  1365  1263 65557.8505   11  278 56819.8894 69485.7914  22.3%  1451  198s
  1459  1320 65204.7480   12  259 56819.8894 69485.7914  22.3%  1434  203s
  1541  1396 65091.0588   13  255 56819.8894 69485.7914  22.3%  1438  209s
  1621  1484 64879.1221   13  287 56819.8894 69485.7914  22.3%  1452  213s
  1721  1588 64205.9615   13  257 56819.8894 69485.7914  22.3%  1434  219s
  1841  1675 64514.9866   13  252 56819.8894 69053.2252  21.5%  1405  226s
  1972  1757 65022.2535   14  263 56819.8894 69053.2252  21.5%  1378  231s
  2070  1782 64799.7333   16  256 56819.8894 69053.2252  21.5%  1376  237s
  2109  1806 64617.1898   17  249 56819.8894 69053.2252  21.5%  1377  242s
  2149  1847 64389.5910   18  248 56819.8894 69053.2252  21.5%  1376  248s
  2212  1884 64525.7610   18  245 56819.8894 69053.2252  21.5%  1364  253s
  2273  1941 64338.7152   19  242 56819.8894 68765.0005  21.0%  1359  260s
  2352  2001 64173.6317   20  243 56819.8894 68374.2560  20.3%  1361  267s
  2460  2055 64117.3233   21  234 56819.8894 68374.2560  20.3%  1354  273s
  2571  2167 63414.3796   20  201 56819.8894 68374.2560  20.3%  1359  279s
  2717  2303 62450.1189   22  226 56819.8894 68374.2560  20.3%  1348  285s
  2874  2465 63088.4740   21  225 56819.8894 68255.9033  20.1%  1332  293s
  3096  2704 62204.9426   28  199 56819.8894 68121.5317  19.9%  1302  299s
  3404  2893 61219.6599   34  123 56819.8894 68065.1392  19.8%  1237  306s
  3693  2894 61220.0674   32  408 56819.8894 68065.1392  19.8%  1197  326s
  3695  2895 64244.7624   14   73 56819.8894 68065.1392  19.8%  1196  336s
  3696  2896 66298.7188   19  247 56819.8894 68065.1392  19.8%  1196  343s
  3697  2897 58846.4606   45  304 56819.8894 68065.1392  19.8%  1195  348s
  3698  2897 58754.2047   43  318 56819.8894 68065.1392  19.8%  1195  351s
  3700  2899 64816.6861   13  378 56819.8894 68065.1392  19.8%  1194  355s
  3703  2901 65740.8246   14  398 56819.8894 68065.1392  19.8%  1193  360s
  3708  2904 61665.1872   24  404 56819.8894 68065.1392  19.8%  1192  366s
  3712  2907 59934.1082   41  334 56819.8894 68065.1392  19.8%  1190  370s
  3716  2909 62463.0818   29  406 56819.8894 68065.1392  19.8%  1189  376s
  3719  2911 61419.8775   39  407 56819.8894 68065.1392  19.8%  1188  380s
  3722  2913 64704.9150   12  400 56819.8894 68065.1392  19.8%  1187  385s
  3726  2916 58726.4303   29  409 56819.8894 68065.1392  19.8%  1186  391s
  3727  2917 67144.8950    7  409 56819.8894 68065.1392  19.8%  1186  402s
  3728  2917 64854.4236   14  409 56819.8894 68065.1392  19.8%  1185  410s
  3729  2921 68065.1392   14  405 56819.8894 68065.1392  19.8%  1205  425s
  3731  2924 68065.1392   15  397 56819.8894 68065.1392  19.8%  1206  433s
  3735  2931 68065.1392   16  392 56819.8894 68065.1392  19.8%  1210  442s
  3743  2944 68065.1392   17  394 56819.8894 68065.1392  19.8%  1221  452s
  3759  2961 64597.9694   18  315 56819.8894 68065.1392  19.8%  1247  467s
  3781  2986 67133.1202   19  338 56819.8894 68065.1392  19.8%  1299  474s
H 3788  2836                    56848.726824 68065.1392  19.7%  1305  474s
  3813  2868 66538.3237   20  292 56848.7268 68065.1392  19.7%  1321  482s
  3854  2920 65743.3239   22  290 56848.7268 68065.1392  19.7%  1345  493s
  3927  2961 65297.9203   22  283 56848.7268 68065.1392  19.7%  1363  502s
  4013  2990 58932.1961   23  278 56848.7268 68065.1392  19.7%  1396  509s
  4102  2975 63758.5372   24  265 56848.7268 68065.1392  19.7%  1406  515s
  4169  2979 62626.1526   23  252 56848.7268 68065.1392  19.7%  1406  524s
  4233  2983 61399.0636   24  341 56848.7268 68065.1392  19.7%  1420  529s
H 4248  2839                    56872.241238 68065.1392  19.7%  1425  529s
  4272  2851 62536.5130   23  267 56872.2412 68065.1392  19.7%  1432  536s
  4352  2844 62780.7789   26  261 56872.2412 68065.1392  19.7%  1442  542s
H 4399  2697                    56908.049259 68065.1392  19.6%  1450  542s
  4406  2716 60904.7580   26  239 56908.0493 68065.1392  19.6%  1450  551s
  4489  2709 59885.6531   27  208 56908.0493 67879.6030  19.3%  1456  559s
  4535  2715 59020.2771   28  158 56908.0493 67879.6030  19.3%  1469  566s
  4606  2734 57380.7734   30  104 56908.0493 66718.5628  17.2%  1478  573s
  4676  2732 60677.2303   23  264 56908.0493 66522.3401  16.9%  1487  579s
  4750  2730 58045.3050   23  215 56908.0493 66522.3401  16.9%  1499  587s
H 4804  2586                    57027.685755 66522.3401  16.6%  1503  587s
  4809  2606 59703.7406   24  259 57027.6858 66522.3401  16.6%  1503  594s
  4897  2600     cutoff   25      57027.6858 66522.3401  16.6%  1513  602s
  5003  2597 58182.3800   25  250 57027.6858 66520.9527  16.6%  1513  610s
  5092  2610 58442.7806   25  265 57027.6858 66520.9527  16.6%  1524  617s
  5185  2618     cutoff   26      57027.6858 66520.9527  16.6%  1534  625s
  5296  2606 58339.6779   26  275 57027.6858 66520.9527  16.6%  1536  635s
  5419  2598     cutoff   27      57027.6858 65513.1728  14.9%  1536  644s
  5578  2568 58763.3825   24  233 57027.6858 65513.1728  14.9%  1529  653s
  5733  2545 58296.2869   25  241 57027.6858 65058.9423  14.1%  1524  663s
  5884  2512 57483.0351   31  190 57027.6858 65058.9423  14.1%  1522  669s
  5927  2509 57458.3807   32  192 57027.6858 65058.9423  14.1%  1525  677s
  6054  2485 57211.1527   40  204 57027.6858 64410.9408  12.9%  1517  686s
  6221  2476 61388.6986   22  239 57027.6858 64410.9408  12.9%  1514  695s
  6424  2453 60071.2957   24  190 57027.6858 64169.4489  12.5%  1504  705s
  6640  2438 58378.1637   30  144 57027.6858 63834.1520  11.9%  1499  714s
  6884  2424 57101.8198   25  305 57027.6858 63792.7153  11.9%  1486  723s
  7070  2395 60673.8352   26  207 57027.6858 63792.7153  11.9%  1485  736s
  7332  2345     cutoff   32      57027.6858 63260.5324  10.9%  1476  747s
  7576  2287 60342.7089   22  238 57027.6858 63152.6908  10.7%  1473  758s
  7805  2226 59104.2161   25  158 57027.6858 63152.6908  10.7%  1475  769s
  8016  2138 58291.4281   28  217 57027.6858 62977.4587  10.4%  1472  781s
  8266  2054 57642.1450   24  197 57027.6858 62662.1506  9.88%  1470  793s
  8550  1955     cutoff   22      57027.6858 62221.7223  9.11%  1470  806s
  8827  1844 57932.2202   28  218 57027.6858 61914.3325  8.57%  1473  818s
  9148  1738 57148.2043   24  253 57027.6858 61470.3414  7.79%  1470  832s
  9403  1609 57952.7100   32  152 57027.6858 61432.3427  7.72%  1469  845s
  9759  1481 58834.0055   31  139 57027.6858 61145.7065  7.22%  1464  856s
  9831  1425 57658.0491   32  131 57027.6858 61143.2365  7.22%  1467  869s
  9990  1337 57516.2985   33   92 57027.6858 60939.8765  6.86%  1463  882s
 10306  1136     cutoff   25      57027.6858 60939.8765  6.86%  1452  895s
 10779   775 59180.4851   26  243 57027.6858 60502.4537  6.09%  1433  915s
 11282   392 57127.0927   26  201 57027.6858 59876.9747  5.00%  1414  928s
 12129   220 infeasible   31      57027.6858 59180.4197  3.77%  1359  938s
 13337   206     cutoff   76      57027.6858 57770.2025  1.30%  1252  940s
*13980   206              69    57047.813942 57770.2025  1.27%  1197  940s
 14702    30 infeasible   50      57047.8139 57345.3431  0.52%  1140  949s

Cutting planes:
  MIR: 502
  Flow cover: 791
  RLT: 11
  Relax-and-lift: 74

Explored 15523 nodes (16905010 simplex iterations) in 949.54 seconds (1876.66 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 57047.8 57027.7 56908 ... 56506.4

Optimal solution found (tolerance 1.00e-04)
Best objective 5.704781394221e+04, best bound 5.704781394221e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 949.56s
  Master Objective (UB) = 57047.81, θ = 218940.77
  Upper Bound (UB) = 57047.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 218940.77
  [DEBUG]   ✓ Scenario 0: θ = 218940.77 ≤ Q = 218940.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 218940.77 ≤ Q = 218940.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 218940.77 ≤ Q = 218940.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 218940.77 ≤ Q = 218940.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2d90c0df
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2d90c0df
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.369177e+13
Presolve removed 2555 rows and 1846 columns
Presolve time: 0.01s
Presolved: 538 rows, 543 columns, 1518 nonzeros
Found heuristic solution: objective 6872379.3841
Variable types: 369 continuous, 174 integer (174 binary)

Root relaxation: objective -1.935585e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -193558.45    0  132 6872379.38 -193558.45   103%     -    0s
H    0     0                    -155687.8901 -193558.45  24.3%     -    0s
H    0     0                    -164975.7091 -193558.45  17.3%     -    0s
     0     0 -182281.79    0   97 -164975.71 -182281.79  10.5%     -    0s
H    0     0                    -180391.1617 -182208.76  1.01%     -    0s
H    0     0                    -181030.9227 -181988.47  0.53%     -    0s
     0     0 -181988.47    0   97 -181030.92 -181988.47  0.53%     -    0s
     0     0 -181987.90    0   97 -181030.92 -181987.90  0.53%     -    0s
     0     0 -181230.49    0   41 -181030.92 -181230.49  0.11%     -    0s
     0     0 -181177.45    0   22 -181030.92 -181177.45  0.08%     -    0s
     0     0 -181117.90    0   19 -181030.92 -181117.90  0.05%     -    0s
     0     0 -181110.73    0   10 -181030.92 -181110.73  0.04%     -    0s
     0     0 -181108.06    0    8 -181030.92 -181108.06  0.04%     -    0s
     0     0 -181072.76    0    7 -181030.92 -181072.76  0.02%     -    0s
     0     0 -181068.69    0    6 -181030.92 -181068.69  0.02%     -    0s
H    0     0                    -181061.5052 -181068.69  0.00%     -    0s

Explored 1 nodes (709 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -181062 -181031 -180246 ... 1.36918e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.810615051602e+05, best bound -1.810686943059e+05, gap 0.0040%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 196329.65
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -181061.51
  [DEBUG]   S×d_nominal = 377391.16
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 377391.16 + -181061.51 = 196329.65
  [DEBUG]   Current θ from Master = 218940.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22611.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34436.70
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 6883.7062, Absolute Gap = 6883.7062, Relative Gap = 0.120666
  Not converged yet (gap = 6883.71 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0x1f67938f
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 1.23s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -199127.5693

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26036    1.5814347e+04   0.000000e+00   5.403217e+07      5s
   37257    3.3189012e+04   0.000000e+00   1.763820e+07     10s
   47105    6.4306588e+04   0.000000e+00   2.773054e+06     15s
Concurrent spin time: 1.69s

Solved with dual simplex

Root relaxation: objective 8.528651e+04, 32867 iterations, 16.99 seconds (22.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 85286.5125    0   75 -199127.57 85286.5125   143%     -   18s
H    0     0                    -194120.9112 85286.5125   144%     -   18s
H    0     0                    -124347.8214 85286.5125   169%     -   18s
H    0     0                    -114401.1546 85286.5125   175%     -   19s
H    0     0                    -113468.2092 85286.5125   175%     -   19s
H    0     0                    -92850.99434 85286.5125   192%     -   19s
H    0     0                    -90712.21476 85286.5125   194%     -   19s
H    0     0                    -90347.33873 85286.5125   194%     -   19s
H    0     0                    -90312.73118 85286.5125   194%     -   19s
H    0     0                    -31312.68176 85286.5125   372%     -   19s
H    0     0                    49470.784399 85286.5125  72.4%     -   19s
H    0     0                    52042.958977 85286.5125  63.9%     -   19s
H    0     0                    54872.700343 85286.5125  55.4%     -   19s
H    0     0                    54973.256247 79891.2685  45.3%     -   26s
     0     0 79823.0612    0  126 54973.2562 79823.0612  45.2%     -   26s
     0     0 79362.0614    0  115 54973.2562 79362.0614  44.4%     -   30s
     0     0 79362.0614    0  123 54973.2562 79362.0614  44.4%     -   30s
     0     0 79362.0614    0  119 54973.2562 79362.0614  44.4%     -   30s
     0     0 79362.0614    0  119 54973.2562 79362.0614  44.4%     -   31s
H    0     0                    55273.174629 76252.2688  38.0%     -   37s
     0     0 76088.7828    0  182 55273.1746 76088.7828  37.7%     -   37s
     0     0 75480.0251    0  193 55273.1746 75480.0251  36.6%     -   41s
     0     0 75262.4269    0  196 55273.1746 75262.4269  36.2%     -   43s
     0     0 75115.0541    0  195 55273.1746 75115.0541  35.9%     -   44s
     0     0 74989.0497    0  183 55273.1746 74989.0497  35.7%     -   46s
     0     0 74971.9838    0  197 55273.1746 74971.9838  35.6%     -   46s
     0     0 74955.0563    0  192 55273.1746 74955.0563  35.6%     -   47s
     0     0 74948.0298    0  186 55273.1746 74948.0298  35.6%     -   48s
     0     0 74947.8690    0  191 55273.1746 74947.8690  35.6%     -   48s
H    0     0                    55335.320092 74947.8690  35.4%     -   52s
H    0     0                    55691.861978 74947.8690  34.6%     -   52s
H    0     0                    55889.727078 73182.6317  30.9%     -   60s
     0     0 73182.6317    0  258 55889.7271 73182.6317  30.9%     -   60s
     0     0 72098.1661    0  278 55889.7271 72098.1661  29.0%     -   65s
     0     0 71935.1069    0  273 55889.7271 71935.1069  28.7%     -   67s
     0     0 71883.3668    0  288 55889.7271 71883.3668  28.6%     -   69s
     0     0 71853.1644    0  282 55889.7271 71853.1644  28.6%     -   71s
     0     0 71802.9802    0  321 55889.7271 71802.9802  28.5%     -   73s
     0     0 71784.4689    0  286 55889.7271 71784.4689  28.4%     -   73s
     0     0 71781.9525    0  290 55889.7271 71781.9525  28.4%     -   73s
     0     0 71781.7684    0  290 55889.7271 71781.7684  28.4%     -   73s
     0     0 71177.8483    0  318 55889.7271 71177.8483  27.4%     -   80s
     0     0 70942.5371    0  316 55889.7271 70942.5371  26.9%     -   83s
     0     0 70650.5433    0  353 55889.7271 70650.5433  26.4%     -   86s
     0     0 70577.1580    0  367 55889.7271 70577.1580  26.3%     -   89s
     0     0 70542.0285    0  378 55889.7271 70542.0285  26.2%     -   90s
     0     0 70527.8315    0  384 55889.7271 70527.8315  26.2%     -   91s
     0     0 70517.6364    0  388 55889.7271 70517.6364  26.2%     -   92s
     0     0 70516.4578    0  385 55889.7271 70516.4578  26.2%     -   92s
     0     0 70445.8717    0  333 55889.7271 70445.8717  26.0%     -   95s
     0     0 70431.0636    0  383 55889.7271 70431.0636  26.0%     -   96s
     0     0 70412.2788    0  386 55889.7271 70412.2788  26.0%     -   97s
     0     0 70402.0892    0  385 55889.7271 70402.0892  26.0%     -   98s
     0     0 70394.7920    0  383 55889.7271 70394.7920  26.0%     -   99s
     0     0 70385.7647    0  392 55889.7271 70385.7647  25.9%     -  100s
     0     0 70367.7859    0  391 55889.7271 70367.7859  25.9%     -  100s
     0     0 70362.9139    0  394 55889.7271 70362.9139  25.9%     -  101s
     0     0 70360.2267    0  392 55889.7271 70360.2267  25.9%     -  101s
     0     0 70357.8008    0  386 55889.7271 70357.8008  25.9%     -  102s
     0     0 70355.7988    0  386 55889.7271 70355.7988  25.9%     -  102s
     0     0 70355.0236    0  388 55889.7271 70355.0236  25.9%     -  103s
     0     0 70303.5917    0  386 55889.7271 70303.5917  25.8%     -  105s
     0     0 70292.4267    0  392 55889.7271 70292.4267  25.8%     -  108s
     0     0 70289.9452    0  345 55889.7271 70289.9452  25.8%     -  108s
     0     0 70289.2648    0  395 55889.7271 70289.2648  25.8%     -  108s
     0     0 70261.7153    0  333 55889.7271 70261.7153  25.7%     -  111s
     0     0 70253.0087    0  390 55889.7271 70253.0087  25.7%     -  112s
     0     0 70250.4965    0  389 55889.7271 70250.4965  25.7%     -  112s
     0     0 70249.3994    0  391 55889.7271 70249.3994  25.7%     -  112s
     0     0 70241.3213    0  393 55889.7271 70241.3213  25.7%     -  114s
     0     0 70238.7032    0  388 55889.7271 70238.7032  25.7%     -  117s
     0     0 70236.0445    0  408 55889.7271 70236.0445  25.7%     -  118s
     0     0 70235.6158    0  402 55889.7271 70235.6158  25.7%     -  118s
     0     0 70234.2855    0  404 55889.7271 70234.2855  25.7%     -  119s
     0     0 70233.3939    0  400 55889.7271 70233.3939  25.7%     -  120s
     0     0 70231.2920    0  403 55889.7271 70231.2920  25.7%     -  121s
     0     0 70229.7413    0  408 55889.7271 70229.7413  25.7%     -  121s
     0     0 70229.3472    0  407 55889.7271 70229.3472  25.7%     -  122s
     0     0 70222.5860    0  407 55889.7271 70222.5860  25.6%     -  123s
     0     2 70222.5860    0  407 55889.7271 70222.5860  25.6%     -  140s
     3     8 69955.1650    2  392 55889.7271 70159.6561  25.5%  2809  150s
    15    32 69568.0063    4  393 55889.7271 69870.2984  25.0%  4094  162s
    31    51 68184.0184    5  316 55889.7271 69567.8624  24.5%  8389  178s
    50    83 68093.0264    6  367 55889.7271 69567.7946  24.5%  6966  186s
    82   126 67886.6778    7  319 55889.7271 69567.7946  24.5%  5524  197s
   125   235 67647.4099    8  314 55889.7271 69567.7946  24.5%  4219  207s
   234   339 67590.5678    9  314 55889.7271 69567.7946  24.5%  3102  214s
   338   371 67320.3230   10  309 55889.7271 69567.7946  24.5%  2639  221s
   370   410 66971.1893   10  303 55889.7271 69567.7946  24.5%  2594  229s
   409   454 67213.1686   11  293 55889.7271 69567.7946  24.5%  2524  236s
   453   493 67175.2886   12  285 55889.7271 69567.7946  24.5%  2429  242s
   492   539 66935.7470   11  301 55889.7271 69567.7946  24.5%  2376  247s
   538   584 66943.9362   13  264 55889.7271 69567.7946  24.5%  2312  253s
   585   629 66758.5268   13  291 55889.7271 69567.7946  24.5%  2258  258s
   632   677 65757.4336   12  288 55889.7271 69567.7946  24.5%  2195  263s
   682   726 66880.3726   12  297 55889.7271 69567.7946  24.5%  2137  267s
   733   776 66797.1167   14  256 55889.7271 69567.7946  24.5%  2072  271s
   785   808 66542.2659   14  310 55889.7271 69567.7946  24.5%  2008  276s
   817   844 64103.1839   14  255 55889.7271 69567.7946  24.5%  1995  281s
   868   888 63740.2687   14  272 55889.7271 69567.7946  24.5%  1946  285s
   918   931 66713.9910   15  284 55889.7271 69567.7946  24.5%  1896  292s
   969   972 66235.5017   15  307 55889.7271 69299.2769  24.0%  1857  298s
  1026  1025 66350.8060   16  279 55889.7271 69299.2769  24.0%  1831  304s
  1079  1074 66196.1894   17  286 55889.7271 69299.2769  24.0%  1819  308s
  1133  1111 64306.6721   15  209 55889.7271 69299.2769  24.0%  1781  317s
  1182  1154 66023.2232   16  238 55889.7271 69212.7465  23.8%  1783  327s
  1225  1192 66021.2059   17  238 55889.7271 69212.7465  23.8%  1796  333s
  1271  1236 62847.8479   17  239 55889.7271 69212.7465  23.8%  1784  339s
  1317  1283 65462.6944   18  250 55889.7271 69212.7465  23.8%  1772  345s
  1372  1341 66127.4522   18  285 55889.7271 69212.7465  23.8%  1752  351s
  1434  1389 65014.3275   18  230 55889.7271 69016.0178  23.5%  1722  359s
  1496  1454 64776.4201   19  232 55889.7271 69016.0178  23.5%  1698  366s
  1567  1517 63631.5099   19  265 55889.7271 69016.0178  23.5%  1681  378s
  1654  1578 64714.8184   20  213 55889.7271 69016.0178  23.5%  1650  388s
H 1687  1578                    55957.073994 69016.0178  23.3%  1637  388s
  1753  1669 64073.3105   20  231 55957.0740 69016.0178  23.3%  1634  401s
  1927  1803 61942.8690   21  207 55957.0740 69016.0178  23.3%  1616  413s
  2125  1941 61488.4170   22  188 55957.0740 68817.6275  23.0%  1584  426s
  2309  2098 60448.3961   22  207 55957.0740 68320.7244  22.1%  1580  439s
  2482  2242 60487.6590   22  178 55957.0740 68320.7244  22.1%  1571  453s
  2674  2432 60297.4780   24  150 55957.0740 68320.4350  22.1%  1562  465s
H 2936  2458                    55977.002082 68320.4350  22.1%  1513  473s
  2973  2557 59743.6194   28  152 55977.0021 68320.4350  22.1%  1517  484s
  3226  2618 57626.1671   32   93 55977.0021 68320.4350  22.1%  1493  497s
  3411  2673 56972.2958   39  103 55977.0021 68320.4350  22.1%  1509  511s
  3563  2782 65634.0161   12  283 55977.0021 68320.4350  22.1%  1540  525s
  3736  2899 60981.4280   15  260 55977.0021 67893.0405  21.3%  1561  540s
  3949  2919 58109.6692   20  266 55977.0021 67662.7896  20.9%  1564  550s
  3993  2970 57950.6921   21  228 55977.0021 67654.0259  20.9%  1577  564s
  4101  3124 58003.2864   21  214 55977.0021 67653.4118  20.9%  1570  578s
  4366  3125 58789.9182   15  407 55977.0021 67452.7878  20.5%  1549  610s
  4368  3126 66035.3561    5   75 55977.0021 67452.7878  20.5%  1548  630s
H 4368  2969                    55978.495636 67452.7878  20.5%  1548  640s
H 4368  2821                    56211.989154 67452.7878  20.0%  1548  640s
H 4369  2680                    56213.929023 67452.7878  20.0%  1548  650s
  4371  2681 58318.8627   23  288 56213.9290 67452.7878  20.0%  1547  655s
  4373  2683 58272.9673   18  321 56213.9290 67452.7878  20.0%  1547  663s
  4374  2683 60368.2232   21  332 56213.9290 67452.7878  20.0%  1546  666s
  4376  2685 59261.3854   33  380 56213.9290 67452.7878  20.0%  1546  672s
  4378  2686 57772.8410   37  387 56213.9290 67452.7878  20.0%  1545  675s
  4381  2688 65774.0361    6  392 56213.9290 67452.7878  20.0%  1544  682s
H 4382  2555                    56239.465935 67452.7878  19.9%  1543  687s
  4385  2557 59742.1243   29  340 56239.4659 67452.7878  19.9%  1542  690s
  4389  2559 61918.7555   18  325 56239.4659 67452.7878  19.9%  1541  696s
  4392  2561 58525.2289   48  327 56239.4659 67452.7878  19.9%  1540  700s
  4395  2563 58631.2601   24  329 56239.4659 67452.7878  19.9%  1539  706s
  4398  2565 66592.6448    8  331 56239.4659 67452.7878  19.9%  1538  728s
  4399  2566 57501.9139   69  331 56239.4659 67452.7878  19.9%  1537  742s
  4400  2570 67452.7878   12  333 56239.4659 67452.7878  19.9%  1561  767s
  4402  2573 67452.7878   13  390 56239.4659 67452.7878  19.9%  1563  780s
  4406  2580 67452.7878   14  389 56239.4659 67452.7878  19.9%  1565  791s
  4414  2593 67452.7878   15  329 56239.4659 67452.7878  19.9%  1575  802s
  4430  2610 65855.8069   16  292 56239.4659 67452.7878  19.9%  1607  823s
  4452  2634 66368.1413   17  287 56239.4659 67452.7878  19.9%  1639  835s
  4484  2656 65870.7636   18  267 56239.4659 67452.7878  19.9%  1673  846s
H 4485  2526                    56359.396834 67452.7878  19.7%  1673  846s
H 4486  2403                    56360.434865 67452.7878  19.7%  1674  846s
H 4488  2286                    56376.950634 67452.7878  19.6%  1677  846s
H 4490  2176                    56397.677246 67452.7878  19.6%  1679  846s
H 4493  2070                    56456.282889 67452.7878  19.5%  1682  846s
H 4509  1964                    56499.592731 67452.7878  19.4%  1700  846s
  4516  2044 65537.6011   19  271 56499.5927 67452.7878  19.4%  1707  861s
  4607  2062 64777.6358   21  295 56499.5927 67452.7878  19.4%  1754  875s
  4697  2067 63080.7860   24  253 56499.5927 67452.7878  19.4%  1792  888s
  4797  2055 61516.4620   26  226 56499.5927 67452.7878  19.4%  1818  900s
  4881  2059 61205.5998   30  228 56499.5927 67452.7878  19.4%  1839  913s
  4963  2067 60460.6283   35  174 56499.5927 67452.7878  19.4%  1868  922s
  5027  2067 60196.7495   37   73 56499.5927 67452.7878  19.4%  1894  930s
  5067  2082 60122.1433   38   97 56499.5927 67452.7878  19.4%  1902  937s
  5123  2083 59935.5137   39   84 56499.5927 67452.7878  19.4%  1909  949s
  5164  2096 58745.9769   40   98 56499.5927 67452.7878  19.4%  1915  962s
  5235  2100 60036.2415   39   90 56499.5927 67452.7878  19.4%  1916  973s
  5306  2113 58496.7382   41  111 56499.5927 67452.7878  19.4%  1935  984s
  5388  2116 58520.8365   43   34 56499.5927 67452.7878  19.4%  1944  996s
  5478  2118     cutoff   47      56499.5927 67452.7878  19.4%  1951 1006s
  5550  2131 63059.3467   19  240 56499.5927 67452.7878  19.4%  1967 1016s
  5633  2144 62844.4055   21  238 56499.5927 67452.7878  19.4%  1978 1028s
  5717  2158 61483.0440   24  217 56499.5927 67452.7878  19.4%  2000 1037s
  5828  2160 58525.9871   26  185 56499.5927 67452.7878  19.4%  2006 1050s
  5962  2134     cutoff   28      56499.5927 67452.7878  19.4%  2010 1062s
  6055  2150 60238.1443   24  269 56499.5927 67452.7878  19.4%  2025 1075s
  6151  2158 58903.4003   26  220 56499.5927 67339.4213  19.2%  2048 1088s
  6263  2151 57927.3258   29  179 56499.5927 67339.4213  19.2%  2067 1101s
  6406  2135     cutoff   30      56499.5927 65959.8218  16.7%  2077 1114s
  6535  2146 59849.1994   22  236 56499.5927 65959.8218  16.7%  2093 1127s
  6652  2143 57381.3616   25  205 56499.5927 65362.7947  15.7%  2105 1142s
  6823  2135 60736.1293   18  209 56499.5927 65174.0910  15.4%  2114 1156s
  6994  2132 58260.6454   22  226 56499.5927 64965.4758  15.0%  2123 1171s
  7153  2103 57877.0758   25  197 56499.5927 64840.7113  14.8%  2140 1187s
  7263  2096 61197.2332   23  341 56499.5927 64724.8188  14.6%  2151 1203s
  7433  2033 56954.7791   26  206 56499.5927 64724.8188  14.6%  2156 1219s
  7626  1994     cutoff   21      56499.5927 64627.4397  14.4%  2172 1236s
  7798  2011 60299.5532   18  211 56499.5927 64627.4397  14.4%  2206 1250s
  8020  1952 57290.1218   23  249 56499.5927 64627.4397  14.4%  2213 1262s
  8077  1958 57076.5534   24  238 56499.5927 64627.4397  14.4%  2218 1280s
  8258  1948 60086.2293   22  299 56499.5927 63584.3117  12.5%  2220 1297s
  8479  1930 59383.8583   23  271 56499.5927 63546.6680  12.5%  2213 1315s
  8717  1879 58918.7635   25  256 56499.5927 63398.9304  12.2%  2214 1334s
  8952  1809     cutoff   30      56499.5927 63256.8418  12.0%  2236 1352s
  9199  1733     cutoff   24      56499.5927 62934.2113  11.4%  2260 1373s
  9455  1667 56768.4699   25  238 56499.5927 62645.4637  10.9%  2279 1393s
  9727  1582 58536.1220   23  219 56499.5927 62355.8098  10.4%  2295 1413s
 10050  1480     cutoff   21      56499.5927 61979.9160  9.70%  2290 1435s
 10349  1485 56752.5562   24  165 56499.5927 61815.2337  9.41%  2309 1457s
 10665  1549 57770.5295   21  224 56499.5927 61583.3626  9.00%  2326 1480s
 11101  1587     cutoff   30      56499.5927 61333.6377  8.56%  2323 1505s
 11559  1557     cutoff   28      56499.5927 61194.1228  8.31%  2315 1526s
 11951  1556     cutoff   30      56499.5927 60719.5914  7.47%  2324 1550s
 12424  1528 57632.0208   23  161 56499.5927 60568.1356  7.20%  2316 1574s
 12922  1461 56881.9874   26  152 56499.5927 60222.4402  6.59%  2312 1598s
 13385  1371 infeasible   24      56499.5927 60089.8375  6.35%  2316 1624s
 14048  1144     cutoff   26      56499.5927 59499.8227  5.31%  2287 1650s
*14745  1144              87    56528.289619 59375.3062  5.04%  2240 1650s
 14954   843     cutoff   23      56528.2896 59073.8923  4.50%  2225 1676s
*15917   843              69    56541.527784 58907.0356  4.18%  2125 1676s
*16364   843              61    56694.447028 58899.8660  3.89%  2079 1676s
 16690   982     cutoff   57      56694.4470 58227.4344  2.70%  2049 1695s
H16696   982                    56704.918081 58227.4344  2.68%  2049 1695s
 18999   818     cutoff   49      56704.9181 57072.1590  0.65%  1812 1700s
*21175   818              55    56714.685917 57037.7367  0.57%  1632 1700s
*22144    60              55    56736.071678 56936.8284  0.35%  1563 1703s

Cutting planes:
  MIR: 508
  Mixing: 1
  Flow cover: 913
  RLT: 12
  Relax-and-lift: 101

Explored 23502 nodes (34798615 simplex iterations) in 1703.96 seconds (3437.74 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 56736.1 56714.7 56704.9 ... 56377

Optimal solution found (tolerance 1.00e-04)
Best objective 5.673607167762e+04, best bound 5.673607167762e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1703.97s
  Master Objective (UB) = 56736.07, θ = 217070.12
  Upper Bound (UB) = 56736.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 217070.12
  [DEBUG]   ✓ Scenario 0: θ = 217070.12 ≤ Q = 217070.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 217070.12 ≤ Q = 217070.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 217070.12 ≤ Q = 217070.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 217070.12 ≤ Q = 217070.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 217070.12 ≤ Q = 217070.12 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x686aa5e2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x97955a1e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.369259e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1502 nonzeros
Found heuristic solution: objective 6918676.7411
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6918396.9884

Root relaxation: objective -1.964310e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196430.99    0  131 6918396.99 -196430.99   103%     -    0s
H    0     0                    -169625.5757 -196430.99  15.8%     -    0s
H    0     0                    -169905.3284 -196430.99  15.6%     -    0s
     0     0 -177034.19    0  109 -169905.33 -177034.19  4.20%     -    0s
H    0     0                    -174084.3887 -177012.36  1.68%     -    0s
H    0     0                    -174364.1414 -177012.36  1.52%     -    0s
H    0     0                    -174385.6927 -177012.36  1.51%     -    0s
H    0     0                    -174665.4455 -177012.36  1.34%     -    0s
     0     0 -176808.12    0  111 -174665.45 -176808.12  1.23%     -    0s
     0     0 -176799.44    0  111 -174665.45 -176799.44  1.22%     -    0s
     0     0 -176137.80    0   84 -174665.45 -176137.80  0.84%     -    0s
     0     0 -175835.96    0   74 -174665.45 -175835.96  0.67%     -    0s
     0     0 -175768.86    0   71 -174665.45 -175768.86  0.63%     -    0s
     0     0 -175420.32    0   55 -174665.45 -175420.32  0.43%     -    0s
     0     0 -175413.46    0   58 -174665.45 -175413.46  0.43%     -    0s
     0     0 -175056.72    0   23 -174665.45 -175056.72  0.22%     -    0s
     0     0 -175025.21    0   28 -174665.45 -175025.21  0.21%     -    0s
     0     0 -175024.64    0   20 -174665.45 -175024.64  0.21%     -    0s
     0     0 -174954.92    0   14 -174665.45 -174954.92  0.17%     -    0s
     0     0 -174942.98    0   15 -174665.45 -174942.98  0.16%     -    0s
     0     0 -174909.06    0   15 -174665.45 -174909.06  0.14%     -    0s
     0     0 -174908.52    0   15 -174665.45 -174908.52  0.14%     -    0s
H    0     0                    -174666.0430 -174908.52  0.14%     -    0s
     0     0 -174908.52    0   64 -174666.04 -174908.52  0.14%     -    0s
     0     0 -174908.52    0   64 -174666.04 -174908.52  0.14%     -    0s
     0     0 -174908.52    0   32 -174666.04 -174908.52  0.14%     -    0s
H    0     0                    -174714.5818 -174759.84  0.03%     -    0s
     0     0 -174759.84    0   29 -174714.58 -174759.84  0.03%     -    0s
     0     0 -174759.78    0   28 -174714.58 -174759.78  0.03%     -    0s
     0     0 -174746.10    0   30 -174714.58 -174746.10  0.02%     -    0s
     0     0 -174745.70    0   22 -174714.58 -174745.70  0.02%     -    0s
     0     0 -174743.06    0   10 -174714.58 -174743.06  0.02%     -    0s
     0     0 -174739.87    0    8 -174714.58 -174739.87  0.01%     -    0s
H    0     0                    -174715.7837 -174739.87  0.01%     -    0s
     0     0          -    0      -174715.78 -174731.53  0.01%     -    0s

Cutting planes:
  Gomory: 24
  Implied bound: 4
  MIR: 46
  Flow cover: 23
  RLT: 5

Explored 1 nodes (1067 simplex iterations) in 0.19 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -174716 -174715 -174666 ... 6.91868e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.747157836544e+05, best bound -1.747315349035e+05, gap 0.0090%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 205006.74
  Scenario: 49 demand increases, 11 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -174715.78
  [DEBUG]   S×d_nominal = 379722.53
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379722.53 + -174715.78 = 205006.74
  [DEBUG]   Current θ from Master = 217070.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12063.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44672.69
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 6571.9639, Absolute Gap = 6571.9639, Relative Gap = 0.115834
  Not converged yet (gap = 6571.96 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 49 increases, 11 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0x9c760199
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 1.51s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26921   -1.2560703e+05   0.000000e+00   8.204387e+07      5s
   40503   -1.0908208e+04   0.000000e+00   1.460526e+08     10s
   50989    2.9481210e+04   0.000000e+00   6.281024e+06     15s
   60911    4.6537463e+04   0.000000e+00   2.060731e+06     20s
   70265    6.2723116e+04   0.000000e+00   1.004400e+07     25s
Concurrent spin time: 1.29s

Solved with dual simplex

Root relaxation: objective 8.456212e+04, 36875 iterations, 25.69 seconds (33.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 84562.1199    0   73 -203987.28 84562.1199   141%     -   28s
H    0     0                    -198980.6227 84562.1199   142%     -   28s
H    0     0                    -197570.9830 84562.1199   143%     -   28s
H    0     0                    -195068.6149 84562.1199   143%     -   28s
H    0     0                    -159944.4042 84562.1199   153%     -   28s
H    0     0                    -159885.6874 84562.1199   153%     -   28s
H    0     0                    -150607.8781 84562.1199   156%     -   29s
H    0     0                    -150292.9800 84562.1199   156%     -   29s
H    0     0                    -150250.9437 84562.1199   156%     -   29s
H    0     0                    -148031.3306 84562.1199   157%     -   29s
H    0     0                    -147917.3293 84562.1199   157%     -   29s
H    0     0                    -28641.68984 84562.1199   395%     -   29s
H    0     0                    35945.965913 84562.1199   135%     -   29s
H    0     0                    38821.624834 84562.1199   118%     -   29s
H    0     0                    44919.398612 84562.1199  88.3%     -   29s
H    0     0                    46247.122850 84562.1199  82.8%     -   29s
H    0     0                    47500.034222 84562.1199  78.0%     -   29s
H    0     0                    48699.809289 84562.1199  73.6%     -   29s
H    0     0                    50250.506583 84562.1199  68.3%     -   29s
H    0     0                    51437.175204 84562.1199  64.4%     -   29s
H    0     0                    51631.053583 84562.1199  63.8%     -   29s
H    0     0                    51703.045750 84562.1199  63.6%     -   29s
H    0     0                    52102.525248 84562.1199  62.3%     -   29s
H    0     0                    52200.241726 84562.1199  62.0%     -   29s
H    0     0                    52578.474347 79175.4792  50.6%     -   39s
H    0     0                    52594.675589 79175.4792  50.5%     -   39s
     0     0 78596.8992    0  126 52594.6756 78596.8992  49.4%     -   39s
     0     0 78409.6241    0  127 52594.6756 78409.6241  49.1%     -   46s
     0     0 78409.6241    0  131 52594.6756 78409.6241  49.1%     -   47s
     0     0 78409.6241    0  133 52594.6756 78409.6241  49.1%     -   47s
     0     0 78409.6241    0  133 52594.6756 78409.6241  49.1%     -   47s
H    0     0                    52798.877252 75084.7015  42.2%     -   57s
H    0     0                    52801.901515 75084.7015  42.2%     -   57s
H    0     0                    53045.760761 75084.7015  41.5%     -   57s
     0     0 74781.0835    0  182 53045.7608 74781.0835  41.0%     -   57s
     0     0 74254.1526    0  190 53045.7608 74254.1526  40.0%     -   64s
     0     0 74078.9562    0  202 53045.7608 74078.9562  39.7%     -   67s
     0     0 74020.4301    0  202 53045.7608 74020.4301  39.5%     -   68s
     0     0 73933.9843    0  203 53045.7608 73933.9843  39.4%     -   71s
H    0     0                    53220.099763 73874.0652  38.8%     -   72s
H    0     0                    53273.491572 73874.0652  38.7%     -   72s
     0     0 73874.0652    0  242 53273.4916 73874.0652  38.7%     -   72s
     0     0 73868.3966    0  241 53273.4916 73868.3966  38.7%     -   73s
     0     0 73848.5600    0  227 53273.4916 73848.5600  38.6%     -   73s
     0     0 73844.0317    0  220 53273.4916 73844.0317  38.6%     -   74s
     0     0 73841.7552    0  236 53273.4916 73841.7552  38.6%     -   74s
     0     0 73840.9657    0  237 53273.4916 73840.9657  38.6%     -   74s
     0     0 72235.0319    0  308 53273.4916 72235.0319  35.6%     -   88s
H    0     0                    53280.940195 72234.5845  35.6%     -   89s
     0     0 71403.6813    0  274 53280.9402 71403.6813  34.0%     -   94s
     0     0 71225.8043    0  287 53280.9402 71225.8043  33.7%     -   98s
H    0     0                    53292.605266 71139.7599  33.5%     -  102s
     0     0 71139.7599    0  285 53292.6053 71139.7599  33.5%     -  102s
     0     0 71085.7007    0  323 53292.6053 71085.7007  33.4%     -  104s
     0     0 71066.8998    0  328 53292.6053 71066.8998  33.4%     -  105s
     0     0 71054.3794    0  296 53292.6053 71054.3794  33.3%     -  107s
     0     0 71044.9061    0  297 53292.6053 71044.9061  33.3%     -  108s
     0     0 71042.8866    0  296 53292.6053 71042.8866  33.3%     -  109s
     0     0 71038.0092    0  295 53292.6053 71038.0092  33.3%     -  109s
     0     0 71029.9561    0  300 53292.6053 71029.9561  33.3%     -  109s
     0     0 71029.7712    0  297 53292.6053 71029.7712  33.3%     -  110s
     0     0 70466.5055    0  368 53292.6053 70466.5055  32.2%     -  117s
     0     0 70220.2343    0  327 53292.6053 70220.2343  31.8%     -  121s
     0     0 70114.3588    0  327 53292.6053 70114.3588  31.6%     -  123s
     0     0 70064.2335    0  336 53292.6053 70064.2335  31.5%     -  126s
     0     0 69984.9838    0  331 53292.6053 69984.9838  31.3%     -  128s
     0     0 69960.1201    0  334 53292.6053 69960.1201  31.3%     -  129s
     0     0 69943.2801    0  376 53292.6053 69943.2801  31.2%     -  131s
     0     0 69940.6199    0  333 53292.6053 69940.6199  31.2%     -  131s
     0     0 69923.7872    0  370 53292.6053 69923.7872  31.2%     -  133s
     0     0 69916.4054    0  378 53292.6053 69916.4054  31.2%     -  133s
     0     0 69915.5506    0  380 53292.6053 69915.5506  31.2%     -  134s
H    0     0                    53490.299972 69710.3579  30.3%     -  139s
H    0     0                    53625.911728 69710.3579  30.0%     -  139s
     0     0 69710.3579    0  333 53625.9117 69710.3579  30.0%     -  139s
H    0     0                    53717.273289 69708.9330  29.8%     -  139s
     0     0 69687.6079    0  381 53717.2733 69687.6079  29.7%     -  141s
     0     0 69672.7810    0  335 53717.2733 69672.7810  29.7%     -  141s
     0     0 69669.4462    0  389 53717.2733 69669.4462  29.7%     -  142s
     0     0 69667.5634    0  392 53717.2733 69667.5634  29.7%     -  142s
     0     0 69666.7612    0  350 53717.2733 69666.7612  29.7%     -  143s
     0     0 69634.8595    0  393 53717.2733 69634.8595  29.6%     -  144s
     0     0 69624.8999    0  394 53717.2733 69624.8999  29.6%     -  146s
     0     0 69616.0513    0  344 53717.2733 69616.0513  29.6%     -  147s
     0     0 69611.7343    0  353 53717.2733 69611.7343  29.6%     -  147s
     0     0 69608.5111    0  401 53717.2733 69608.5111  29.6%     -  147s
     0     0 69607.9562    0  399 53717.2733 69607.9562  29.6%     -  148s
     0     0 69567.8954    0  393 53717.2733 69567.8954  29.5%     -  150s
H    0     0                    54002.721305 69539.7640  28.8%     -  152s
     0     0 69539.7640    0  350 54002.7213 69539.7640  28.8%     -  152s
     0     0 69532.4541    0  406 54002.7213 69532.4541  28.8%     -  154s
     0     0 69529.9684    0  405 54002.7213 69529.9684  28.8%     -  154s
     0     0 69529.1077    0  405 54002.7213 69529.1077  28.8%     -  155s
     0     0 69510.3734    0  404 54002.7213 69510.3734  28.7%     -  157s
     0     0 69509.2882    0  349 54002.7213 69509.2882  28.7%     -  160s
     0     0 69504.7229    0  352 54002.7213 69504.7229  28.7%     -  162s
H    0     0                    54607.686319 69502.6819  27.3%     -  163s
     0     0 69502.6819    0  356 54607.6863 69502.6819  27.3%     -  163s
     0     0 69502.2746    0  414 54607.6863 69502.2746  27.3%     -  163s
     0     0 69500.1005    0  359 54607.6863 69500.1005  27.3%     -  165s
     0     0 69499.2579    0  405 54607.6863 69499.2579  27.3%     -  168s
     0     0 69495.7667    0  356 54607.6863 69495.7667  27.3%     -  169s
H    0     0                    54623.214091 69494.6686  27.2%     -  170s
     0     0 69494.6686    0  358 54623.2141 69494.6686  27.2%     -  170s
     0     0 69492.1774    0  399 54623.2141 69492.1774  27.2%     -  172s
     0     0 69491.4633    0  399 54623.2141 69491.4633  27.2%     -  173s
     0     2 69491.4633    0  399 54623.2141 69491.4633  27.2%     -  210s
     1     4 69423.0317    1  390 54623.2141 69491.2651  27.2%  1633  216s
     3     8 69360.0063    2  389 54623.2141 69414.1934  27.1%  2978  221s
     7    16 69153.8276    3  395 54623.2141 69365.2907  27.0%  3769  227s
    15    32 68855.3099    4  341 54623.2141 69153.5090  26.6%  4864  239s
    31    50 68233.4112    5  374 54623.2141 69012.6209  26.3%  7962  260s
    49    82 68053.9068    6  371 54623.2141 69012.6209  26.3%  7464  273s
H   51    82                    54723.680198 69012.6209  26.1%  7245  273s
    81   132 67914.9916    7  364 54723.6802 69012.6209  26.1%  5769  289s
   131   252 67654.7874    8  352 54723.6802 69012.6209  26.1%  4123  304s
   251   350 67882.8114    9  357 54723.6802 69012.6209  26.1%  3150  316s
   349   382 67525.7641   10  359 54723.6802 69012.6209  26.1%  2878  323s
   381   415 67617.3679   10  351 54723.6802 69012.6209  26.1%  2767  329s
   416   445 67044.4131   10  282 54723.6802 69012.6209  26.1%  2735  338s
   452   474 67177.0606   10  297 54723.6802 69012.6209  26.1%  2777  350s
   485   502 67045.1168   10  298 54723.6802 69012.6209  26.1%  2827  358s
   517   537 67609.7867   11  307 54723.6802 69012.6209  26.1%  2894  364s
   556   574 66877.1607   10  338 54723.6802 68963.1743  26.0%  2874  371s
H  572   574                    54877.219454 68963.1743  25.7%  2881  371s
   595   672 63773.5920   10  293 54877.2195 68963.1743  25.7%  2883  379s
   697   759 63753.2948   11  294 54877.2195 68963.1743  25.7%  2786  388s
   790   833 67056.7912   12  290 54877.2195 68947.4391  25.6%  2722  394s
   880   897 66787.8156   13  296 54877.2195 68947.4391  25.6%  2734  406s
   972   944 63591.7695   12  296 54877.2195 68947.4391  25.6%  2711  417s
  1059  1022 64038.3594   13  268 54877.2195 68947.4391  25.6%  2728  429s
  1161  1117 66683.5793   14  296 54877.2195 68947.4391  25.6%  2710  441s
  1276  1216 59814.8347   14  273 54877.2195 68947.4391  25.6%  2730  451s
  1386  1312 64966.0677   15  261 54877.2195 68947.4391  25.6%  2727  462s
  1509  1408 62347.9664   14  229 54877.2195 68947.4391  25.6%  2709  475s
  1647  1462 64637.7222   16  261 54877.2195 68947.4391  25.6%  2664  488s
  1741  1526 57892.1611   16  227 54877.2195 68947.4391  25.6%  2660  501s
  1843  1626 63447.7832   17  231 54877.2195 68947.4391  25.6%  2709  515s
  1971  1737 63017.3127   18  234 54877.2195 68947.4391  25.6%  2709  527s
  2122  1823 62168.7940   21  199 54877.2195 68947.4391  25.6%  2678  540s
  2234  1913 61975.1282   20  206 54877.2195 68774.6187  25.3%  2663  554s
  2390  2018 62078.2957   22  192 54877.2195 68575.2957  25.0%  2630  565s
  2537  2101 61327.4285   25  187 54877.2195 68524.7933  24.9%  2614  580s
  2668  2174 58475.0629   24  182 54877.2195 68368.5144  24.6%  2631  596s
  2803  2269 59853.7442   27  159 54877.2195 68180.1651  24.2%  2670  612s
  2950  2341 58399.2167   39  100 54877.2195 68051.4004  24.0%  2693  628s
  3084  2446 56748.3510   42   80 54877.2195 68001.1306  23.9%  2731  643s
  3247  2552 57587.1582   51   94 54877.2195 67994.4135  23.9%  2753  662s
  3399  2654 56977.4798   66   67 54877.2195 67994.4135  23.9%  2766  677s
  3565  2771 56721.0450   77   58 54877.2195 67804.1255  23.6%  2781  692s
  3724  2772 61971.5642   21  399 54877.2195 67804.1255  23.6%  2819  730s
  3726  2773 61255.8704   26   73 54877.2195 67804.1255  23.6%  2818  752s
  3727  2774 63086.1483   23  214 54877.2195 67804.1255  23.6%  2817  768s
  3728  2775 62168.5720   20  283 54877.2195 67804.1255  23.6%  2816  778s
  3729  2775 60936.4859   14  314 54877.2195 67804.1255  23.6%  2815  786s
  3730  2776 56957.4351   55  308 54877.2195 67804.1255  23.6%  2814  796s
  3731  2777 56762.5215   72  366 54877.2195 67804.1255  23.6%  2814  801s
  3733  2778 62976.7241   26  387 54877.2195 67804.1255  23.6%  2812  806s
  3735  2779 67228.2768    9  354 54877.2195 67804.1255  23.6%  2811  810s
  3737  2781 62658.0840   26  394 54877.2195 67804.1255  23.6%  2809  815s
  3740  2783 66990.3388    8  417 54877.2195 67804.1255  23.6%  2807  820s
  3742  2784 57081.8824   54  402 54877.2195 67804.1255  23.6%  2805  826s
  3744  2785 60623.7300   21  392 54877.2195 67804.1255  23.6%  2804  831s
  3746  2787 57576.1693   47  399 54877.2195 67804.1255  23.6%  2802  837s
  3748  2788 59483.7865   33  345 54877.2195 67804.1255  23.6%  2801  842s
  3750  2789 56813.2057   11  343 54877.2195 67804.1255  23.6%  2799  846s
  3752  2791 61776.8722   15  401 54877.2195 67804.1255  23.6%  2798  851s
  3754  2792 65769.5959   10  407 54877.2195 67804.1255  23.6%  2796  856s
  3756  2793 55334.1348   16  406 54877.2195 67804.1255  23.6%  2795  860s
  3757  2794 59392.7219   27  406 54877.2195 67804.1255  23.6%  2794  883s
  3758  2795 65203.6881    8  406 54877.2195 67804.1255  23.6%  2794  901s
  3759  2798 67804.1255   13  352 54877.2195 67804.1255  23.6%  2825  920s
  3761  2802 67804.1255   14  344 54877.2195 67804.1255  23.6%  2826  932s
  3765  2808 67804.1255   15  348 54877.2195 67804.1255  23.6%  2829  946s
  3773  2822 67804.1255   16  341 54877.2195 67804.1255  23.6%  2837  964s
  3789  2840 67614.2646   17  345 54877.2195 67804.1255  23.6%  2878  993s
  3813  2864 67193.1272   18  341 54877.2195 67804.1255  23.6%  2909 1012s
H 3834  2716                    55103.578616 67804.1255  23.0%  2939 1012s
H 3839  2582                    55113.803991 67804.1255  23.0%  2946 1012s
  3845  2695 67040.9236   19  351 55113.8040 67804.1255  23.0%  2955 1037s
  3966  2718 66423.6162   21  331 55113.8040 67804.1255  23.0%  2998 1054s
  4038  2741 64203.6352   22  306 55113.8040 67804.1255  23.0%  3021 1068s
  4111  2756 63537.1279   22  321 55113.8040 67804.1255  23.0%  3023 1083s
  4207  2755 61747.1394   23  302 55113.8040 67804.1255  23.0%  3002 1095s
H 4218  2624                    55136.438156 67804.1255  23.0%  2999 1095s
  4286  2631 62498.9386   23  299 55136.4382 67804.1255  23.0%  2984 1107s
  4364  2622 62412.1538   24  279 55136.4382 67804.1255  23.0%  2962 1119s
  4406  2638 61679.2058   24  302 55136.4382 67804.1255  23.0%  2960 1136s
H 4438  2507                    55150.852809 67804.1255  22.9%  2954 1136s
  4484  2511 61904.5408   25  284 55150.8528 67804.1255  22.9%  2944 1154s
  4560  2513 60368.0197   25  251 55150.8528 67427.6026  22.3%  2938 1171s
  4626  2516 61654.4694   26  269 55150.8528 67427.3948  22.3%  2937 1183s
  4676  2525 61098.5298   27  243 55150.8528 67427.3948  22.3%  2930 1193s
  4736  2539 60370.7918   27  280 55150.8528 67427.3948  22.3%  2929 1203s
  4813  2523 61089.7366   28  260 55150.8528 67427.3948  22.3%  2918 1219s
  4868  2525 56090.1654   28  247 55150.8528 67427.3948  22.3%  2916 1228s
  4912  2536 60561.9050   29  229 55150.8528 67427.3948  22.3%  2913 1242s
  4977  2542 56073.0832   29  250 55150.8528 67427.3948  22.3%  2914 1255s
  5060  2532 60234.5715   30  249 55150.8528 66784.6428  21.1%  2911 1272s
  5157  2536 57999.0135   31  250 55150.8528 65769.8424  19.3%  2908 1289s
  5268  2520 57089.9457   32  226 55150.8528 65769.8424  19.3%  2892 1304s
  5361  2527 55781.6217   33  203 55150.8528 65769.8424  19.3%  2896 1320s
  5451  2552 55487.9109   34  168 55150.8528 65769.8424  19.3%  2895 1338s
  5586  2534 57941.9609   24  275 55150.8528 65769.8424  19.3%  2879 1355s
  5714  2532 59090.1689   25  240 55150.8528 65685.9077  19.1%  2872 1373s
  5837  2553 57872.9274   27  208 55150.8528 64912.7580  17.7%  2871 1390s
  5955  2531 57308.5731   31  253 55150.8528 64758.7192  17.4%  2873 1402s
  5993  2539 57308.1003   32  253 55150.8528 64758.7192  17.4%  2875 1416s
  6039  2535 57300.0856   33  253 55150.8528 64758.7192  17.4%  2876 1434s
H 6051  2417                    55153.107911 64758.7192  17.4%  2876 1434s
H 6055  2307                    55156.956129 64758.7192  17.4%  2876 1434s
H 6082  2195                    55203.612206 64758.7192  17.3%  2880 1434s
  6085  2249     cutoff   34      55203.6122 64758.7192  17.3%  2881 1453s
  6281  2209 56569.6716   35  246 55203.6122 64758.7192  17.3%  2848 1475s
  6430  2174 infeasible   36      55203.6122 64758.7192  17.3%  2849 1492s
H 6463  2065                    55308.399621 64758.7192  17.1%  2856 1492s
  6478  2100     cutoff   39      55308.3996 64758.7192  17.1%  2860 1515s
  6625  2086 56501.3913   25  208 55308.3996 64278.1468  16.2%  2864 1539s
  6788  2071     cutoff   28      55308.3996 64278.1468  16.2%  2866 1562s
  6956  2056 60369.8903   24  203 55308.3996 64261.4942  16.2%  2870 1587s
  7098  2080 infeasible   26      55308.3996 63873.4026  15.5%  2888 1610s
  7260  2063     cutoff   28      55308.3996 63873.4026  15.5%  2899 1635s
  7460  2017 infeasible   33      55308.3996 63873.4026  15.5%  2899 1662s
  7626  1981 57790.1188   24  264 55308.3996 63873.4026  15.5%  2918 1684s
  7701  1965 57157.3044   25  201 55308.3996 63253.2447  14.4%  2929 1708s
  7780  1996 55926.5825   26  176 55308.3996 63209.4146  14.3%  2938 1734s
  7998  1961 55518.6998   28  144 55308.3996 63073.5328  14.0%  2935 1762s
  8240  1944 59251.4294   22  234 55308.3996 62975.4944  13.9%  2931 1791s
  8424  1921 55793.2474   28  132 55308.3996 62975.4944  13.9%  2925 1821s
  8691  1871 56995.9881   25  245 55308.3996 62625.3418  13.2%  2921 1851s
H 8801  1742                    55324.167927 62625.3418  13.2%  2920 1851s
  8831  1799 infeasible   28      55324.1679 62625.3418  13.2%  2918 1882s
  9148  1764 infeasible   28      55324.1679 62514.1130  13.0%  2906 1916s
  9441  1799 55982.6487   26  189 55324.1679 62514.1130  13.0%  2909 1951s
  9610  1841 56489.4121   21  235 55324.1679 62023.2249  12.1%  2931 1984s
  9896  1882 infeasible   26      55324.1679 62002.5074  12.1%  2942 2020s
 10208  1891 55540.4501   30   87 55324.1679 61805.4798  11.7%  2945 2062s
 10514  1930     cutoff   31      55324.1679 61714.8539  11.6%  2956 2101s
 10845  1970 infeasible   33      55324.1679 61420.8904  11.0%  2963 2146s
 11187  1994 58012.4514   25  249 55324.1679 61313.0489  10.8%  2970 2191s
 11599  2019 infeasible   36      55324.1679 60984.4462  10.2%  2966 2231s
 12017  2125 infeasible   30      55324.1679 60855.9281  10.0%  2964 2276s
 12497  2160 infeasible   22      55324.1679 60622.0835  9.58%  2945 2324s
 12902  2176 57085.3582   30  153 55324.1679 60497.1077  9.35%  2952 2370s
 13335  2173 infeasible   36      55324.1679 60341.6012  9.07%  2957 2416s
 13718  2183 infeasible   29      55324.1679 60173.4014  8.77%  2964 2466s
 14185  2218 57671.3213   28  181 55324.1679 60018.3180  8.48%  2969 2517s
 14714  2226 56898.4147   27  246 55324.1679 59707.4908  7.92%  2967 2569s
 15216  2210 55747.7037   32   55 55324.1679 59578.7023  7.69%  2965 2626s
 15777  2188 infeasible   24      55324.1679 59360.2466  7.30%  2964 2683s
 16426  2078 56259.5554   25  242 55324.1679 59121.9632  6.86%  2954 2743s
 17034  1994 infeasible   29      55324.1679 58766.1717  6.22%  2959 2808s
 17726  1831 infeasible   26      55324.1679 58576.3533  5.88%  2951 2875s
 18420  1633 infeasible   29      55324.1679 58216.6744  5.23%  2948 2938s
 19193  1293 55684.5393   48   35 55324.1679 57891.2338  4.64%  2938 3016s
 20031   701     cutoff   26      55324.1679 57386.5539  3.73%  2924 3084s
 20992   206 infeasible   32      55324.1679 56875.2743  2.80%  2903 3132s
 22828     0     cutoff   47      55324.1679 55839.8700  0.93%  2734 3144s

Cutting planes:
  Gomory: 2
  MIR: 647
  Mixing: 1
  Flow cover: 1173
  RLT: 22
  Relax-and-lift: 146

Explored 23924 nodes (62861109 simplex iterations) in 3144.71 seconds (6434.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 55324.2 55308.4 55203.6 ... 54877.2

Optimal solution found (tolerance 1.00e-04)
Best objective 5.532416792665e+04, best bound 5.532416792665e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3144.72s
  Master Objective (UB) = 55324.17, θ = 216528.55
  Upper Bound (UB) = 55324.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216528.55
  [DEBUG]   ✓ Scenario 0: θ = 216528.55 ≤ Q = 216528.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216528.55 ≤ Q = 216528.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216528.55 ≤ Q = 216528.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216528.55 ≤ Q = 216528.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216528.55 ≤ Q = 216528.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216528.55 ≤ Q = 216528.55 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4b75d4f1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4b75d4f1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.384140e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1502 nonzeros
Found heuristic solution: objective 6915406.3518
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6914908.3584

Root relaxation: objective -1.919881e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -191988.07    0  122 6914908.36 -191988.07   103%     -    0s
H    0     0                    -158475.5610 -191988.07  21.1%     -    0s
     0     0 -171482.77    0  106 -158475.56 -171482.77  8.21%     -    0s
H    0     0                    -168701.0591 -171353.30  1.57%     -    0s
H    0     0                    -168976.3385 -171353.30  1.41%     -    0s
H    0     0                    -169220.0799 -171353.30  1.26%     -    0s
H    0     0                    -169495.3593 -171353.30  1.10%     -    0s
     0     0 -170446.66    0  102 -169495.36 -170446.66  0.56%     -    0s
     0     0 -170391.00    0  102 -169495.36 -170391.00  0.53%     -    0s
     0     0 -169955.23    0   57 -169495.36 -169955.23  0.27%     -    0s
     0     0 -169947.30    0   56 -169495.36 -169947.30  0.27%     -    0s
     0     0 -169887.36    0   55 -169495.36 -169887.36  0.23%     -    0s
     0     0 -169887.36    0   51 -169495.36 -169887.36  0.23%     -    0s
     0     0 -169887.36    0   53 -169495.36 -169887.36  0.23%     -    0s
     0     0 -169715.40    0   48 -169495.36 -169715.40  0.13%     -    0s
     0     0 -169700.38    0   42 -169495.36 -169700.38  0.12%     -    0s
     0     0 -169682.56    0   37 -169495.36 -169682.56  0.11%     -    0s
     0     0 -169682.38    0   23 -169495.36 -169682.38  0.11%     -    0s
     0     0 -169681.00    0   20 -169495.36 -169681.00  0.11%     -    0s
H    0     0                    -169522.3259 -169681.00  0.09%     -    0s
     0     0 -169662.82    0   18 -169522.33 -169662.82  0.08%     -    0s
     0     0 -169612.20    0   10 -169522.33 -169612.20  0.05%     -    0s
     0     0 -169612.20    0   16 -169522.33 -169612.20  0.05%     -    0s
H    0     0                    -169548.0531 -169612.20  0.04%     -    0s
     0     0 -169572.21    0    2 -169548.05 -169572.21  0.01%     -    0s
H    0     0                    -169563.0753 -169571.25  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 3
  MIR: 2
  Flow cover: 8
  RLT: 1
  Relax-and-lift: 5

Explored 1 nodes (806 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -169563 -169548 -169522 ... 1.38414e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.695630753482e+05, best bound -1.695712485333e+05, gap 0.0048%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 205587.77
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -169563.08
  [DEBUG]   S×d_nominal = 375150.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 375150.85 + -169563.08 = 205587.77
  [DEBUG]   Current θ from Master = 216528.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10940.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44383.39
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 5160.0602, Absolute Gap = 5160.0602, Relative Gap = 0.093270
  Not converged yet (gap = 5160.06 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0x6f039beb
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 1.85s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29264   -1.3196691e+05   0.000000e+00   5.237545e+07      5s
   41831    2.5549972e+03   0.000000e+00   2.655012e+08     10s
   52826    3.5020572e+04   0.000000e+00   2.452174e+07     15s
   60580    4.0063074e+04   0.000000e+00   1.548888e+08     20s
   67467    5.0506732e+04   0.000000e+00   5.560660e+07     25s
   75520    6.7997350e+04   0.000000e+00   1.334202e+07     30s
Concurrent spin time: 5.09s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.455580e+04, 47489 iterations, 34.11 seconds (43.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 84555.8025    0   73 -203987.28 84555.8025   141%     -   36s
H    0     0                    -190565.0664 84555.8025   144%     -   36s
H    0     0                    -94515.55099 84555.8025   189%     -   37s
H    0     0                    -28641.68984 84555.8025   395%     -   37s
H    0     0                    16870.961949 84555.8025   401%     -   37s
H    0     0                    25815.459475 84555.8025   228%     -   37s
H    0     0                    45611.669370 84555.8025  85.4%     -   37s
H    0     0                    47077.893318 84555.8025  79.6%     -   37s
H    0     0                    51385.819830 84555.8025  64.6%     -   37s
H    0     0                    51440.964902 84555.8025  64.4%     -   42s
H    0     0                    51887.529320 84401.1500  62.7%     -   44s
H    0     0                    52215.632048 84401.1500  61.6%     -   44s
H    0     0                    52878.895236 79378.0949  50.1%     -   54s
H    0     0                    52890.034150 79378.0949  50.1%     -   54s
H    0     0                    52978.581678 79378.0949  49.8%     -   54s
H    0     0                    53083.990794 79378.0949  49.5%     -   54s
     0     0 78625.3360    0  118 53083.9908 78625.3360  48.1%     -   54s
     0     0 78487.4120    0  126 53083.9908 78487.4120  47.9%     -   61s
     0     0 78487.4120    0  128 53083.9908 78487.4120  47.9%     -   64s
     0     0 78487.4120    0  126 53083.9908 78487.4120  47.9%     -   64s
     0     0 78487.4120    0  121 53083.9908 78487.4120  47.9%     -   65s
     0     0 78487.4120    0  121 53083.9908 78487.4120  47.9%     -   65s
     0     0 75438.8175    0  178 53083.9908 75438.8175  42.1%     -   76s
     0     0 74560.7575    0  200 53083.9908 74560.7575  40.5%     -   84s
     0     0 74101.0521    0  189 53083.9908 74101.0521  39.6%     -   89s
     0     0 74045.2066    0  210 53083.9908 74045.2066  39.5%     -   91s
     0     0 73979.3570    0  225 53083.9908 73979.3570  39.4%     -   94s
     0     0 73961.9034    0  217 53083.9908 73961.9034  39.3%     -   95s
     0     0 73955.8509    0  222 53083.9908 73955.8509  39.3%     -   95s
     0     0 73946.0418    0  220 53083.9908 73946.0418  39.3%     -   97s
     0     0 73944.6939    0  227 53083.9908 73944.6939  39.3%     -   97s
     0     0 73944.0463    0  223 53083.9908 73944.0463  39.3%     -   97s
     0     0 72393.1501    0  289 53083.9908 72393.1501  36.4%     -  121s
H    0     0                    53155.182610 72393.1254  36.2%     -  122s
H    0     0                    53177.573868 72393.1254  36.1%     -  122s
     0     0 71756.7409    0  294 53177.5739 71756.7409  34.9%     -  130s
     0     0 71568.2036    0  310 53177.5739 71568.2036  34.6%     -  134s
     0     0 71321.6770    0  303 53177.5739 71321.6770  34.1%     -  138s
     0     0 71243.7142    0  316 53177.5739 71243.7142  34.0%     -  141s
     0     0 71142.6506    0  324 53177.5739 71142.6506  33.8%     -  146s
     0     0 71130.5533    0  322 53177.5739 71130.5533  33.8%     -  147s
     0     0 71095.5603    0  286 53177.5739 71095.5603  33.7%     -  149s
     0     0 71081.7025    0  290 53177.5739 71081.7025  33.7%     -  150s
H    0     0                    53376.417274 71073.0854  33.2%     -  151s
H    0     0                    53509.851330 71073.0854  32.8%     -  151s
     0     0 71073.0854    0  292 53509.8513 71073.0854  32.8%     -  151s
H    0     0                    53569.199923 71072.9585  32.7%     -  151s
     0     0 71072.9585    0  292 53569.1999 71072.9585  32.7%     -  151s
     0     0 70602.1599    0  305 53569.1999 70602.1599  31.8%     -  163s
H    0     0                    53586.134849 70601.9603  31.8%     -  164s
     0     0 70302.7388    0  312 53586.1348 70302.7388  31.2%     -  171s
     0     0 70189.2052    0  354 53586.1348 70189.2052  31.0%     -  174s
     0     0 70107.6075    0  327 53586.1348 70107.6075  30.8%     -  177s
     0     0 70062.9650    0  365 53586.1348 70062.9650  30.7%     -  179s
     0     0 70046.6728    0  377 53586.1348 70046.6728  30.7%     -  181s
     0     0 70000.8264    0  326 53586.1348 70000.8264  30.6%     -  183s
     0     0 69974.0932    0  331 53586.1348 69974.0932  30.6%     -  184s
     0     0 69967.4905    0  338 53586.1348 69967.4905  30.6%     -  185s
     0     0 69963.8088    0  343 53586.1348 69963.8088  30.6%     -  186s
     0     0 69931.2130    0  380 53586.1348 69931.2130  30.5%     -  188s
     0     0 69923.1050    0  382 53586.1348 69923.1050  30.5%     -  189s
     0     0 69921.0062    0  342 53586.1348 69921.0062  30.5%     -  189s
     0     0 69919.3394    0  338 53586.1348 69919.3394  30.5%     -  190s
     0     0 69919.1018    0  338 53586.1348 69919.1018  30.5%     -  190s
     0     0 69760.9072    0  382 53586.1348 69760.9072  30.2%     -  195s
     0     0 69707.3047    0  381 53586.1348 69707.3047  30.1%     -  198s
     0     0 69697.2681    0  375 53586.1348 69697.2681  30.1%     -  198s
     0     0 69691.7813    0  384 53586.1348 69691.7813  30.1%     -  199s
     0     0 69688.5425    0  383 53586.1348 69688.5425  30.0%     -  199s
     0     0 69687.6307    0  378 53586.1348 69687.6307  30.0%     -  200s
     0     0 69634.5268    0  396 53586.1348 69634.5268  29.9%     -  203s
H    0     0                    53590.286125 69610.6980  29.9%     -  206s
     0     0 69610.6980    0  395 53590.2861 69610.6980  29.9%     -  206s
H    0     0                    53598.048558 69604.5025  29.9%     -  206s
     0     0 69604.5025    0  399 53598.0486 69604.5025  29.9%     -  206s
     0     0 69602.6775    0  396 53598.0486 69602.6775  29.9%     -  207s
     0     0 69600.4542    0  398 53598.0486 69600.4542  29.9%     -  208s
     0     0 69597.5978    0  398 53598.0486 69597.5978  29.9%     -  208s
     0     0 69595.9803    0  401 53598.0486 69595.9803  29.8%     -  208s
     0     0 69552.2447    0  397 53598.0486 69552.2447  29.8%     -  212s
     0     0 69545.6749    0  398 53598.0486 69545.6749  29.8%     -  214s
     0     0 69540.0172    0  345 53598.0486 69540.0172  29.7%     -  215s
     0     0 69539.3431    0  350 53598.0486 69539.3431  29.7%     -  215s
     0     0 69495.5533    0  398 53598.0486 69495.5533  29.7%     -  220s
     0     0 69488.4288    0  411 53598.0486 69488.4288  29.6%     -  221s
     0     0 69486.1984    0  411 53598.0486 69486.1984  29.6%     -  222s
     0     0 69484.7210    0  404 53598.0486 69484.7210  29.6%     -  222s
     0     0 69477.4426    0  406 53598.0486 69477.4426  29.6%     -  225s
     0     0 69466.1690    0  416 53598.0486 69466.1690  29.6%     -  228s
     0     0 69465.4171    0  412 53598.0486 69465.4171  29.6%     -  229s
     0     0 69451.9027    0  409 53598.0486 69451.9027  29.6%     -  232s
     0     0 69450.0567    0  355 53598.0486 69450.0567  29.6%     -  233s
     0     0 69449.9172    0  404 53598.0486 69449.9172  29.6%     -  233s
     0     0 69449.1573    0  354 53598.0486 69449.1573  29.6%     -  235s
     0     0 69447.7432    0  354 53598.0486 69447.7432  29.6%     -  235s
     0     0 69447.7432    0  360 53598.0486 69447.7432  29.6%     -  237s
H    0     0                    53614.403128 69447.7432  29.5%     -  238s
     0     0 69447.7432    0  360 53614.4031 69447.7432  29.5%     -  238s
     0     0 69447.7432    0  362 53614.4031 69447.7432  29.5%     -  239s
     0     0 69447.7432    0  362 53614.4031 69447.7432  29.5%     -  240s
     0     0 69447.7432    0  362 53614.4031 69447.7432  29.5%     -  241s
     0     0 69447.7432    0  362 53614.4031 69447.7432  29.5%     -  242s
H    0     0                    53649.094125 69447.6421  29.4%     -  304s
H    0     2                    53661.120867 69447.6421  29.4%     -  305s
     0     2 69447.6421    0  362 53661.1209 69447.6421  29.4%     -  305s
     1     4 69409.4309    1  337 53661.1209 69447.6421  29.4%  2263  310s
     3     8 69340.6790    2  397 53661.1209 69409.2554  29.3%  3797  319s
     7    16 69192.7617    3  351 53661.1209 69337.8021  29.2%  5763  331s
    15    32 69029.5119    4  391 53661.1209 69192.7345  28.9%  7766  341s
    31    48 66897.5664    5  373 53661.1209 69029.1372  28.6%  9640  369s
    47    80 66557.4893    6  366 53661.1209 69029.1372  28.6% 12147  387s
H   51    80                    53664.647456 69029.1372  28.6% 11575  387s
H   52    80                    53908.692580 69029.1372  28.0% 11513  387s
H   59    80                    53942.499333 69029.1372  28.0% 11293  387s
H   73    80                    54079.257716 69029.1372  27.6% 10237  387s
    79   144 66479.0806    7  358 54079.2577 69029.1372  27.6%  9924  423s
   143   278 66261.5631    9  351 54079.2577 69029.1372  27.6%  7638  444s
H  167   278                    54124.469796 69029.1372  27.5%  6878  444s
H  209   278                    54304.381146 69029.1372  27.1%  5977  444s
   277   368 66356.9037    9  295 54304.3811 69029.1372  27.1%  5185  457s
   367   437 66369.5674    9  304 54304.3811 69029.1372  27.1%  4518  469s
H  387   437                    54425.948363 69029.1372  26.8%  4425  469s
   436   511 66208.9379   10  302 54425.9484 69029.1372  26.8%  4234  478s
   510   582 66055.2625   10  332 54425.9484 69029.1372  26.8%  3971  490s
   581   667 65740.6854   11  345 54425.9484 69029.1372  26.8%  3741  501s
   666   711 66086.7854   11  341 54425.9484 69029.1372  26.8%  3529  508s
   710   792 64770.6350   11  316 54425.9484 69029.1372  26.8%  3422  517s
   791   874 66033.9302   11  341 54425.9484 69029.1372  26.8%  3242  527s
   875   952 65680.8478   12  295 54425.9484 69029.1372  26.8%  3073  534s
   969   973 65538.9803   12  289 54425.9484 69029.1372  26.8%  2909  545s
  1004   990 65039.1530   12  336 54425.9484 69029.1372  26.8%  2881  557s
H 1039   990                    54488.530253 69029.1372  26.7%  2870  557s
  1045   998 64827.3103   12  332 54488.5303 69029.1372  26.7%  2879  569s
  1087  1045 64719.2072   12  309 54488.5303 69029.1372  26.7%  2865  581s
H 1089  1045                    54518.592965 69029.1372  26.6%  2865  581s
  1159  1072 64206.0060   12  319 54518.5930 69029.1372  26.6%  2810  595s
H 1175  1072                    54606.917144 69029.1372  26.4%  2813  595s
H 1179  1072                    54769.072670 69029.1372  26.0%  2819  595s
  1192  1120 64017.7585   13  227 54769.0727 69029.1372  26.0%  2827  608s
H 1197  1120                    54864.077734 69029.1372  25.8%  2824  608s
H 1252  1120                    54891.689150 69029.1372  25.8%  2769  608s
  1266  1176 65459.8304   13  328 54891.6891 69029.1372  25.8%  2769  623s
  1376  1218 65101.4186   14  280 54891.6891 69029.1372  25.8%  2710  638s
  1446  1249 62254.9839   14  257 54891.6891 69029.1372  25.8%  2703  651s
  1477  1283 62158.1710   14  277 54891.6891 69029.1372  25.8%  2736  661s
H 1479  1283                    54966.014576 69029.1372  25.6%  2733  661s
  1523  1385 62735.0257   14  269 54966.0146 69029.1372  25.6%  2728  676s
  1685  1457 63106.4651   15  294 54966.0146 69029.1372  25.6%  2598  692s
H 1692  1457                    55038.841109 68813.6787  25.0%  2609  692s
  1819  1532 62672.0513   15  264 55038.8411 68813.6787  25.0%  2536  708s
  1946  1586 62494.9904   16  261 55038.8411 68809.9045  25.0%  2514  722s
  2018  1657 61955.7002   17  203 55038.8411 68809.9045  25.0%  2534  737s
  2133  1682 61661.1657   18  191 55038.8411 68809.9045  25.0%  2522  752s
  2170  1735 61323.7524   19  215 55038.8411 68809.9045  25.0%  2540  767s
  2259  1833 60589.9050   19  193 55038.8411 68809.9045  25.0%  2523  781s
  2397  1973 60656.7548   18  206 55038.8411 68809.9045  25.0%  2479  796s
  2569  2000 60970.8879   18  201 55038.8411 68809.9045  25.0%  2412  810s
  2614  2040 60880.7040   24  218 55038.8411 68591.4194  24.6%  2417  824s
  2662  2090 60306.1438   28  206 55038.8411 68591.4194  24.6%  2426  840s
  2720  2169 59907.1688   29  236 55038.8411 68591.4194  24.6%  2416  858s
  2826  2290 59233.5356   36  185 55038.8411 68591.4194  24.6%  2383  875s
  2989  2453 58800.8939   49  161 55038.8411 68143.3106  23.8%  2331  895s
  3216  2597 58406.5290   62  134 55038.8411 68143.3106  23.8%  2266  914s
  3422  2766 58032.4792   77   82 55038.8411 67559.1105  22.7%  2230  936s
  3663  2767 56259.0445   35  362 55038.8411 67166.8763  22.0%  2201  986s
  3665  2768 56957.9470   26   73 55038.8411 67166.8763  22.0%  2200 1020s
  3666  2769 57154.2409   21  236 55038.8411 67166.8763  22.0%  2199 1043s
  3667  2770 64643.2202    7  290 55038.8411 67166.8763  22.0%  2198 1058s
  3668  2770 58864.6816   61  342 55038.8411 67166.8763  22.0%  2198 1066s
  3669  2771 65655.8387   12  372 55038.8411 67166.8763  22.0%  2197 1075s
  3670  2772 56276.0274   70  370 55038.8411 67166.8763  22.0%  2197 1082s
  3671  2772 58540.3039   59  388 55038.8411 67166.8763  22.0%  2196 1088s
  3672  2773 57367.5714   27  398 55038.8411 67166.8763  22.0%  2195 1093s
  3673  2774 56385.3545   40  405 55038.8411 67166.8763  22.0%  2195 1097s
  3674  2774 56308.9587   42  414 55038.8411 67166.8763  22.0%  2194 1101s
  3676  2776 58309.8090   20  421 55038.8411 67166.8763  22.0%  2193 1110s
  3678  2777 60274.8705   17  420 55038.8411 67166.8763  22.0%  2192 1117s
  3679  2778 58191.5633   24  410 55038.8411 67166.8763  22.0%  2191 1122s
  3680  2778 65851.8926   12  407 55038.8411 67166.8763  22.0%  2191 1125s
  3681  2779 62825.3879   10  406 55038.8411 67166.8763  22.0%  2190 1130s
  3683  2780 57543.7944   36  415 55038.8411 67166.8763  22.0%  2189 1137s
  3685  2782 56163.5160   20  357 55038.8411 67166.8763  22.0%  2188 1143s
  3686  2782 64201.9883   21  360 55038.8411 67166.8763  22.0%  2187 1145s
  3687  2783 58495.4228   20  354 55038.8411 67166.8763  22.0%  2187 1150s
  3689  2784 58331.7934   36  365 55038.8411 67166.8763  22.0%  2185 1156s
  3691  2786 56267.1983   35  368 55038.8411 67166.8763  22.0%  2184 1161s
  3693  2787 58907.4051   13  366 55038.8411 67166.8763  22.0%  2183 1165s
  3694  2788 56940.0555   20  366 55038.8411 67166.8763  22.0%  2182 1198s
  3695  2788 56194.2763   38  366 55038.8411 67166.8763  22.0%  2182 1225s
  3696  2792 67166.8763   16  346 55038.8411 67166.8763  22.0%  2226 1250s
  3698  2795 67166.8763   17  406 55038.8411 67166.8763  22.0%  2229 1268s
  3702  2802 67166.8763   18  407 55038.8411 67166.8763  22.0%  2237 1294s
  3710  2815 67166.8763   19  353 55038.8411 67166.8763  22.0%  2250 1319s
  3726  2827 65824.3418   20  363 55038.8411 67166.8763  22.0%  2312 1359s
  3743  2853 65506.3153   21  346 55038.8411 67166.8763  22.0%  2344 1406s
  3775  2964 65108.5815   22  352 55038.8411 67166.8763  22.0%  2401 1437s
  3896  2991 64309.5565   24  386 55038.8411 67166.8763  22.0%  2522 1457s
  3964  3044 63354.1202   24  276 55038.8411 67166.8763  22.0%  2551 1477s
  4042  3080 63206.5689   25  361 55038.8411 67166.8763  22.0%  2574 1494s
  4116  3104 62284.9642   25  347 55038.8411 67166.8763  22.0%  2585 1510s
  4190  3135 61427.9597   25  268 55038.8411 67166.8763  22.0%  2597 1527s
  4284  3129 60681.1713   25  254 55038.8411 67166.8763  22.0%  2581 1542s
  4381  3094 61139.9141   26  320 55038.8411 67166.8763  22.0%  2562 1559s
  4452  3090 59529.3184   27  284 55038.8411 67166.8763  22.0%  2568 1573s
  4505  3089 59703.5545   27  269 55038.8411 67166.8763  22.0%  2585 1589s
  4542  3109 59472.9520   28  265 55038.8411 67166.8763  22.0%  2603 1604s
  4590  3111 59258.8522   29  301 55038.8411 67166.8763  22.0%  2623 1618s
  4629  3120 58112.8709   30  282 55038.8411 67166.8763  22.0%  2635 1632s
  4681  3128 58079.8610   31  271 55038.8411 67166.8763  22.0%  2639 1646s
  4757  3119 57638.8970   32  201 55038.8411 67166.8763  22.0%  2639 1661s
  4817  3115 57539.3524   33  205 55038.8411 67166.8763  22.0%  2635 1679s
  4873  3123 56135.6238   34  198 55038.8411 67166.8763  22.0%  2639 1697s
  4952  3127 56651.6944   38  159 55038.8411 67166.8763  22.0%  2642 1717s
  5043  3120 55692.8064   43  125 55038.8411 67166.8763  22.0%  2639 1738s
  5142  3136     cutoff   48      55038.8411 67166.8763  22.0%  2647 1757s
  5247  3161 57883.5486   25  244 55038.8411 67166.8763  22.0%  2658 1779s
  5362  3145 57345.0718   26  230 55038.8411 67166.8763  22.0%  2656 1799s
  5402  3158 56835.1570   27  233 55038.8411 67166.8763  22.0%  2669 1817s
  5466  3150 56178.1988   28  190 55038.8411 67166.8763  22.0%  2669 1839s
  5580  3167 55916.8336   29  195 55038.8411 65701.4015  19.4%  2658 1861s
  5674  3198 63735.1684   23  311 55038.8411 65701.4015  19.4%  2674 1885s
  5817  3165 60871.2179   26  240 55038.8411 65288.8557  18.6%  2670 1907s
  5869  3171 60597.4333   27  245 55038.8411 65206.0603  18.5%  2674 1929s
  5974  3189 60280.6525   29  221 55038.8411 65206.0603  18.5%  2675 1956s
  6123  3211     cutoff   34      55038.8411 64902.8569  17.9%  2674 1985s
  6287  3244 59026.1389   27  262 55038.8411 64902.8569  17.9%  2678 2011s
  6493  3224 55828.1240   29  233 55038.8411 64902.8569  17.9%  2669 2041s
  6670  3233     cutoff   33      55038.8411 64469.0712  17.1%  2673 2070s
  6847  3218 58073.5332   26  315 55038.8411 64469.0712  17.1%  2682 2102s
  7044  3213 57629.0585   28  281 55038.8411 64469.0712  17.1%  2687 2134s
  7281  3168 56616.2922   31  219 55038.8411 64202.5093  16.6%  2682 2162s
  7415  3157 55615.8342   33  108 55038.8411 64202.5093  16.6%  2681 2193s
  7594  3171 59944.6525   28  221 55038.8411 63734.6410  15.8%  2701 2227s
  7832  3166 56071.5960   30  218 55038.8411 63695.2034  15.7%  2704 2265s
  8167  3149 58785.1798   25  216 55038.8411 63590.8829  15.5%  2679 2306s
  8419  3182 55471.8865   29  168 55038.8411 63430.0170  15.2%  2687 2345s
  8723  3191 60090.1294   25  260 55038.8411 63390.6733  15.2%  2680 2383s
H 8862  3003                    55076.681962 63390.6733  15.1%  2673 2383s
  9036  3059 56135.3424   41   81 55076.6820 63390.6733  15.1%  2674 2422s
  9365  3014 57575.1427   26  244 55076.6820 63262.8083  14.9%  2669 2460s
H 9445  2852                    55114.847203 63262.8083  14.8%  2666 2460s
H 9475  2708                    55172.421462 63262.8083  14.7%  2666 2460s
  9598  2731 56574.2087   28  267 55172.4215 63262.8083  14.7%  2667 2508s
  9918  2674 55471.4661   26  283 55172.4215 63114.0482  14.4%  2674 2558s
 10221  2669 59610.2776   26  211 55172.4215 62787.1913  13.8%  2683 2603s
 10586  2614 56448.4837   36  114 55172.4215 62608.4029  13.5%  2680 2654s
 10969  2631 60020.9948   29  222 55172.4215 62390.1604  13.1%  2683 2704s
 11284  2704     cutoff   33      55172.4215 62283.6517  12.9%  2689 2758s
 11749  2794     cutoff   32      55172.4215 62283.6517  12.9%  2677 2813s
 12154  2871 56254.3204   26  232 55172.4215 61920.1537  12.2%  2678 2871s
 12539  2922 infeasible   31      55172.4215 61779.9829  12.0%  2690 2933s
 12977  2963 56641.0356   26  171 55172.4215 61680.5843  11.8%  2695 2997s
 13444  2968     cutoff   27      55172.4215 61506.2606  11.5%  2697 3055s
 13503  2977     cutoff   27      55172.4215 61379.0136  11.2%  2705 3104s
 13557  2985 58984.8140   27  245 55172.4215 61379.0136  11.2%  2712 3149s
 13617  2986 58769.2794   28  238 55172.4215 61379.0136  11.2%  2713 3198s
 13747  3001 58703.1040   29  238 55172.4215 61379.0136  11.2%  2709 3254s
 13915  3055 58600.8138   30  231 55172.4215 61353.3308  11.2%  2708 3319s
 14280  3109 57372.8477   33  140 55172.4215 61340.6041  11.2%  2703 3395s
 14896  3180     cutoff   26      55172.4215 60901.9318  10.4%  2694 3465s
 15412  3223 55587.0341   34  207 55172.4215 60787.8001  10.2%  2692 3546s
 16010  3221     cutoff   27      55172.4215 60557.2561  9.76%  2695 3600s

Cutting planes:
  Learned: 1
  MIR: 798
  Mixing: 1
  Flow cover: 1586
  RLT: 15
  Relax-and-lift: 186

Explored 16300 nodes (44218651 simplex iterations) in 3600.05 seconds (6819.85 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 55172.4 55114.8 55076.7 ... 54518.6

Time limit reached
Best objective 5.517242146166e+04, best bound 6.052925629838e+04, gap 9.7093%
  WARNING: Time limit reached. Using best solution found (gap: 9.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 55172.42, θ = 215647.41
  Upper Bound (UB) = 55172.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215647.41
  [DEBUG]   ✓ Scenario 0: θ = 215647.41 ≤ Q = 215647.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215647.41 ≤ Q = 215647.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 215647.41 ≤ Q = 215647.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 215647.41 ≤ Q = 215647.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 215647.41 ≤ Q = 215647.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 215647.41 ≤ Q = 215647.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 215647.41 ≤ Q = 215647.41 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x665e2471
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x665e2471
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.360198e+13
Presolve removed 2555 rows and 1846 columns
Presolve time: 0.01s
Presolved: 538 rows, 543 columns, 1518 nonzeros
Found heuristic solution: objective 6773121.1159
Variable types: 369 continuous, 174 integer (174 binary)

Root relaxation: objective -1.912698e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -191269.83    0  129 6773121.12 -191269.83   103%     -    0s
H    0     0                    -154121.3350 -191269.83  24.1%     -    0s
H    0     0                    -154903.1877 -191269.83  23.5%     -    0s
H    0     0                    -160215.1146 -191269.83  19.4%     -    0s
     0     0 -171509.97    0   76 -160215.11 -171509.97  7.05%     -    0s
H    0     0                    -167984.0917 -171400.72  2.03%     -    0s
H    0     0                    -168274.3791 -171400.72  1.86%     -    0s
H    0     0                    -169635.3368 -171400.72  1.04%     -    0s
H    0     0                    -169925.6241 -171400.72  0.87%     -    0s
     0     0 -170353.60    0   61 -169925.62 -170353.60  0.25%     -    0s
H    0     0                    -169944.8893 -170348.77  0.24%     -    0s
     0     0 -170306.80    0   40 -169944.89 -170306.80  0.21%     -    0s
     0     0 -170301.15    0   46 -169944.89 -170301.15  0.21%     -    0s
     0     0 -170050.33    0   12 -169944.89 -170050.33  0.06%     -    0s
     0     0 -170027.65    0   11 -169944.89 -170027.65  0.05%     -    0s
     0     0 -170003.70    0   10 -169944.89 -170003.70  0.03%     -    0s
     0     0 -169989.64    0    9 -169944.89 -169989.64  0.03%     -    0s
     0     0 -169973.83    0    7 -169944.89 -169973.83  0.02%     -    0s
     0     0 -169971.76    0    6 -169944.89 -169971.76  0.02%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 6
  MIR: 155
  Flow cover: 6
  RLT: 41
  Relax-and-lift: 9
  BQP: 13

Explored 1 nodes (587 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -169945 -169926 -169635 ... 1.3602e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.699448892554e+05, best bound -1.699616998084e+05, gap 0.0099%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 203882.46
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -169944.89
  [DEBUG]   S×d_nominal = 373827.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373827.35 + -169944.89 = 203882.46
  [DEBUG]   Current θ from Master = 215647.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11764.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43407.47
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 5008.3137, Absolute Gap = 5008.3137, Relative Gap = 0.090776
  Not converged yet (gap = 5008.31 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0xbe9007cf
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 2.30s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24414   -1.9752589e+05   0.000000e+00   5.637829e+06      5s
   37726   -2.4074454e+04   0.000000e+00   1.880642e+08     10s
   48788    2.7395154e+04   0.000000e+00   7.621835e+07     15s
   57154    3.2625381e+04   0.000000e+00   3.334814e+06     20s
   62515    3.5684332e+04   0.000000e+00   2.877457e+08     25s
   69359    4.2360663e+04   0.000000e+00   3.357861e+07     30s
Concurrent spin time: 4.87s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.455580e+04, 65033 iterations, 35.93 seconds (49.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 84555.8025    0   73 -203987.28 84555.8025   141%     -   39s
H    0     0                    -191912.0663 84555.8025   144%     -   39s
H    0     0                    -156855.8778 84555.8025   154%     -   39s
H    0     0                    -156277.8434 84555.8025   154%     -   39s
H    0     0                    -111390.7888 84555.8025   176%     -   39s
H    0     0                    -111346.6094 84555.8025   176%     -   39s
H    0     0                    -108582.2062 84555.8025   178%     -   39s
H    0     0                    -100533.1077 84555.8025   184%     -   39s
H    0     0                    -28641.68984 84555.8025   395%     -   39s
H    0     0                    29143.730144 84555.8025   190%     -   39s
H    0     0                    44919.398612 84555.8025  88.2%     -   40s
H    0     0                    48496.421355 84555.8025  74.4%     -   40s
H    0     0                    51275.492892 84555.8025  64.9%     -   40s
H    0     0                    51524.154353 84555.8025  64.1%     -   40s
H    0     0                    51967.764337 78762.8232  51.6%     -   60s
     0     0 78761.8874    0  135 51967.7643 78761.8874  51.6%     -   60s
H    0     0                    52932.431710 78761.8874  48.8%     -   61s
     0     0 78203.7517    0  141 52932.4317 78203.7517  47.7%     -   70s
     0     0 78203.7517    0  136 52932.4317 78203.7517  47.7%     -   73s
     0     0 78203.7517    0  142 52932.4317 78203.7517  47.7%     -   74s
     0     0 78203.7517    0  140 52932.4317 78203.7517  47.7%     -   74s
     0     0 78203.7517    0  143 52932.4317 78203.7517  47.7%     -   76s
     0     0 78203.7517    0  143 52932.4317 78203.7517  47.7%     -   76s
     0     0 75065.8625    0  186 52932.4317 75065.8625  41.8%     -   90s
H    0     0                    53029.424331 75065.8625  41.6%     -   90s
     0     0 74392.9197    0  214 53029.4243 74392.9197  40.3%     -  100s
     0     0 74187.0921    0  201 53029.4243 74187.0921  39.9%     -  108s
     0     0 74045.2735    0  215 53029.4243 74045.2735  39.6%     -  115s
     0     0 73987.6752    0  209 53029.4243 73987.6752  39.5%     -  118s
     0     0 73973.3513    0  210 53029.4243 73973.3513  39.5%     -  119s
     0     0 73966.2011    0  214 53029.4243 73966.2011  39.5%     -  120s
     0     0 73965.8354    0  216 53029.4243 73965.8354  39.5%     -  121s
     0     0 71863.4097    0  271 53029.4243 71863.4097  35.5%     -  149s
     0     0 71456.0156    0  284 53029.4243 71456.0156  34.7%     -  157s
     0     0 71223.6731    0  287 53029.4243 71223.6731  34.3%     -  163s
     0     0 71188.6027    0  296 53029.4243 71188.6027  34.2%     -  166s
     0     0 71161.2905    0  294 53029.4243 71161.2905  34.2%     -  167s
     0     0 71157.3668    0  290 53029.4243 71157.3668  34.2%     -  168s
     0     0 71123.6110    0  287 53029.4243 71123.6110  34.1%     -  171s
     0     0 71109.8565    0  293 53029.4243 71109.8565  34.1%     -  172s
     0     0 71105.4471    0  290 53029.4243 71105.4471  34.1%     -  173s
     0     0 71103.5713    0  295 53029.4243 71103.5713  34.1%     -  173s
     0     0 71101.5830    0  297 53029.4243 71101.5830  34.1%     -  174s
     0     0 71101.5262    0  295 53029.4243 71101.5262  34.1%     -  174s
     0     0 70449.5753    0  359 53029.4243 70449.5753  32.8%     -  189s
     0     0 70183.1349    0  317 53029.4243 70183.1349  32.3%     -  196s
     0     0 70086.2011    0  365 53029.4243 70086.2011  32.2%     -  201s
     0     0 70033.0749    0  373 53029.4243 70033.0749  32.1%     -  205s
     0     0 69989.6679    0  341 53029.4243 69989.6679  32.0%     -  208s
     0     0 69969.0001    0  389 53029.4243 69969.0001  31.9%     -  210s
     0     0 69954.5711    0  340 53029.4243 69954.5711  31.9%     -  212s
     0     0 69944.7675    0  378 53029.4243 69944.7675  31.9%     -  214s
     0     0 69938.3075    0  392 53029.4243 69938.3075  31.9%     -  215s
     0     0 69931.2723    0  393 53029.4243 69931.2723  31.9%     -  217s
     0     0 69927.4374    0  396 53029.4243 69927.4374  31.9%     -  217s
     0     0 69924.1822    0  391 53029.4243 69924.1822  31.9%     -  218s
     0     0 69923.4914    0  391 53029.4243 69923.4914  31.9%     -  219s
     0     0 69771.1424    0  381 53029.4243 69771.1424  31.6%     -  225s
H    0     0                    53129.890438 69770.6448  31.3%     -  226s
     0     0 69748.1471    0  384 53129.8904 69748.1471  31.3%     -  229s
     0     0 69726.1314    0  395 53129.8904 69726.1314  31.2%     -  231s
     0     0 69712.8553    0  394 53129.8904 69712.8553  31.2%     -  233s
     0     0 69701.8220    0  390 53129.8904 69701.8220  31.2%     -  234s
     0     0 69696.7184    0  386 53129.8904 69696.7184  31.2%     -  236s
     0     0 69690.0067    0  387 53129.8904 69690.0067  31.2%     -  237s
     0     0 69686.5893    0  396 53129.8904 69686.5893  31.2%     -  237s
     0     0 69678.4456    0  390 53129.8904 69678.4456  31.1%     -  238s
     0     0 69677.4652    0  389 53129.8904 69677.4652  31.1%     -  238s
     0     0 69600.0696    0  342 53129.8904 69600.0696  31.0%     -  245s
     0     0 69582.5981    0  345 53129.8904 69582.5981  31.0%     -  247s
     0     0 69573.8886    0  344 53129.8904 69573.8886  31.0%     -  249s
     0     0 69570.3906    0  351 53129.8904 69570.3906  30.9%     -  250s
     0     0 69566.3889    0  358 53129.8904 69566.3889  30.9%     -  251s
     0     0 69562.7101    0  393 53129.8904 69562.7101  30.9%     -  252s
     0     0 69560.0393    0  350 53129.8904 69560.0393  30.9%     -  253s
     0     0 69558.9475    0  351 53129.8904 69558.9475  30.9%     -  253s
     0     0 69529.9550    0  414 53129.8904 69529.9550  30.9%     -  257s
H    0     0                    53178.979188 69529.3564  30.7%     -  258s
     0     0 69524.3350    0  413 53178.9792 69524.3350  30.7%     -  259s
     0     0 69518.8032    0  413 53178.9792 69518.8032  30.7%     -  261s
     0     0 69516.9756    0  426 53178.9792 69516.9756  30.7%     -  262s
     0     0 69516.4713    0  424 53178.9792 69516.4713  30.7%     -  263s
     0     0 69487.5413    0  377 53178.9792 69487.5413  30.7%     -  266s
     0     0 69484.8600    0  354 53178.9792 69484.8600  30.7%     -  267s
     0     0 69484.1262    0  376 53178.9792 69484.1262  30.7%     -  268s
     0     0 69481.2249    0  341 53178.9792 69481.2249  30.7%     -  269s
     0     0 69479.8196    0  374 53178.9792 69479.8196  30.7%     -  270s
     0     0 69465.6838    0  360 53178.9792 69465.6838  30.6%     -  273s
     0     0 69455.0587    0  413 53178.9792 69455.0587  30.6%     -  275s
     0     0 69452.1559    0  396 53178.9792 69452.1559  30.6%     -  276s
     0     0 69451.1376    0  342 53178.9792 69451.1376  30.6%     -  276s
     0     0 69443.2447    0  408 53178.9792 69443.2447  30.6%     -  279s
     0     0 69442.2982    0  402 53178.9792 69442.2982  30.6%     -  281s
     0     0 69437.6835    0  357 53178.9792 69437.6835  30.6%     -  283s
     0     0 69436.4522    0  355 53178.9792 69436.4522  30.6%     -  284s
     0     0 69435.0053    0  356 53178.9792 69435.0053  30.6%     -  286s
     0     0 69432.5091    0  355 53178.9792 69432.5091  30.6%     -  287s
     0     0 69432.2767    0  356 53178.9792 69432.2767  30.6%     -  287s
     0     0 69432.1159    0  354 53178.9792 69432.1159  30.6%     -  288s
     0     0 69431.8198    0  352 53178.9792 69431.8198  30.6%     -  289s
     0     0 69431.8198    0  344 53178.9792 69431.8198  30.6%     -  290s
     0     0 69431.5825    0  344 53178.9792 69431.5825  30.6%     -  291s
     0     2 69431.5124    0  344 53178.9792 69431.5124  30.6%     -  339s
     1     4 69343.0840    1  339 53178.9792 69430.7898  30.6%  5738  346s
     3     7 68255.7337    2  335 53178.9792 69342.7623  30.4%  7630  356s
     6    14 68289.1330    3  342 53178.9792 69342.7623  30.4%  8405  398s
    13    28 67747.0915    4  311 53178.9792 68771.5264  29.3% 10163  414s
    27    42 66826.7146    4  373 53178.9792 68666.1747  29.1% 13145  447s
    41    74 65663.0483    5  376 53178.9792 68666.1747  29.1% 16024  493s
H   44    74                    53727.712550 68666.1747  27.8% 15520  493s
H   57    74                    53746.799633 68666.1747  27.8% 14645  493s
H   59    74                    54025.086050 68666.1747  27.1% 14211  493s
H   62    74                    54681.969153 68666.1747  25.6% 13764  493s
    73   176 65484.7199    6  325 54681.9692 68385.0834  25.1% 13939  520s
   175   270 65268.4142   11  364 54681.9692 68385.0542  25.1%  8099  539s
   269   341 64829.3890   14  316 54681.9692 68385.0542  25.1%  6567  551s
   340   417 64555.6894   16  311 54681.9692 68385.0542  25.1%  6031  564s
   416   485 64449.4139   18  303 54681.9692 68385.0542  25.1%  5622  576s
   484   554 64227.2242   20  300 54681.9692 68385.0542  25.1%  5412  588s
   553   620 62945.0496   22  286 54681.9692 68385.0542  25.1%  5279  601s
   619   679 62433.5278   23  265 54681.9692 68385.0542  25.1%  5216  612s
   680   748 62403.8778   24  288 54681.9692 68385.0542  25.1%  5168  622s
   749   811 62220.3229   26  268 54681.9692 68385.0542  25.1%  5105  634s
   816   877 61991.9399   28  269 54681.9692 68385.0542  25.1%  5012  644s
   892   937 61952.6091   29  258 54681.9692 68385.0542  25.1%  4868  655s
   962   970 61730.8922   31  257 54681.9692 68385.0542  25.1%  4802  668s
H  968   970                    54852.877068 68385.0542  24.7%  4807  668s
  1001  1000 61526.8009   33  258 54852.8771 68101.0910  24.2%  4830  682s
  1035  1052 61494.7951   34  259 54852.8771 68101.0910  24.2%  4889  695s
  1091  1131 61313.6205   35  245 54852.8771 68101.0910  24.2%  4864  708s
  1172  1222 61247.2298   36  243 54852.8771 68101.0910  24.2%  4772  720s
  1275  1329 61220.2297   37  242 54852.8771 68101.0910  24.2%  4620  734s
  1392  1361 61046.0431   38  254 54852.8771 67815.4085  23.6%  4448  749s
  1436  1454 60595.8429   39  252 54852.8771 67815.4085  23.6%  4413  760s
  1531  1483 60141.3965   42  238 54852.8771 67815.4085  23.6%  4326  776s
  1566  1511 60127.8168   43  234 54852.8771 67815.4085  23.6%  4342  794s
  1602  1538 60119.7450   44  237 54852.8771 67815.4085  23.6%  4372  811s
  1639  1559 57152.4090   45  212 54852.8771 67815.4085  23.6%  4388  825s
  1695  1582 57105.1772   46  201 54852.8771 67815.4085  23.6%  4421  843s
  1747  1613 56753.4077   47  201 54852.8771 67811.0332  23.6%  4493  860s
  1793  1658 56539.8577   48  191 54852.8771 67811.0332  23.6%  4578  879s
  1848  1700 56277.0367   52  165 54852.8771 67811.0332  23.6%  4641  896s
  1911  1771 56039.8253   56  175 54852.8771 67811.0332  23.6%  4691  914s
  1998  1841     cutoff   67      54852.8771 67811.0332  23.6%  4692  932s
  2082  1944 66254.2191    6  313 54852.8771 67811.0332  23.6%  4737  949s
  2187  2070 65584.3361    9  315 54852.8771 67746.9361  23.5%  4782  969s
  2323  2207 64785.1413   12  288 54852.8771 67746.9361  23.5%  4742  983s
  2480  2359 64576.0882   14  286 54852.8771 67505.1792  23.1%  4668 1003s
  2660  2507 63942.0656   18  267 54852.8771 67505.1792  23.1%  4596 1025s
  2860  2638 61735.1038   21  250 54852.8771 67449.9046  23.0%  4531 1044s
  3049  2673 61146.6670   26  250 54852.8771 67449.9046  23.0%  4475 1065s
  3090  2757 60936.8330   27  213 54852.8771 67449.9046  23.0%  4503 1087s
  3194  2811 60005.2197   33  174 54852.8771 67449.9046  23.0%  4493 1112s
  3314  2870 56812.6524   39  126 54852.8771 67449.9046  23.0%  4523 1138s
  3422  2978     cutoff   43      54852.8771 67332.2356  22.8%  4593 1162s
  3556  2979 56267.0252   19  344 54852.8771 67332.2356  22.8%  4642 1229s
  3558  2980 65337.3864   17   73 54852.8771 67332.2356  22.8%  4639 1284s
  3559  2981 63516.6551   23  216 54852.8771 67332.2356  22.8%  4638 1316s
  3560  2982 65392.3459   12  316 54852.8771 67332.2356  22.8%  4636 1340s
  3561  2982 62962.4887   28  324 54852.8771 67332.2356  22.8%  4635 1353s
  3562  2983 62547.6132   36  366 54852.8771 67332.2356  22.8%  4634 1363s
  3563  2984 60983.6997   21  371 54852.8771 67332.2356  22.8%  4632 1369s
  3564  2984 56995.3396   43  409 54852.8771 67332.2356  22.8%  4631 1376s
  3565  2985 64828.2597    9  408 54852.8771 67332.2356  22.8%  4630 1380s
  3567  2986 63060.1631   28  418 54852.8771 67332.2356  22.8%  4627 1389s
  3568  2987 62193.3672   21  360 54852.8771 67332.2356  22.8%  4626 1391s
  3570  2988 57258.3345   66  401 54852.8771 67332.2356  22.8%  4623 1395s
  3571  2989 64979.7005   10  425 54852.8771 67332.2356  22.8%  4622 1401s
  3573  2990 55598.8527   53  394 54852.8771 67332.2356  22.8%  4619 1410s
  3575  2992 62699.7876   15  412 54852.8771 67332.2356  22.8%  4617 1416s
  3576  2992 62571.7822   27  413 54852.8771 67332.2356  22.8%  4616 1421s
  3578  2994 60409.6521   33  354 54852.8771 67332.2356  22.8%  4613 1428s
  3579  2994 65979.9689    7  410 54852.8771 67332.2356  22.8%  4612 1430s
  3580  2995 56972.7261   46  417 54852.8771 67332.2356  22.8%  4610 1435s
  3582  2996 60522.3745   36  412 54852.8771 67332.2356  22.8%  4608 1443s
  3583  2997 64242.1698   22  410 54852.8771 67332.2356  22.8%  4607 1445s
  3585  2998 59824.1978   27  415 54852.8771 67332.2356  22.8%  4604 1452s
  3586  2999 56033.6501   30  415 54852.8771 67332.2356  22.8%  4603 1455s
  3587  3000 64171.0363   17  361 54852.8771 67332.2356  22.8%  4601 1460s
  3589  3001 58414.1999   51  416 54852.8771 67332.2356  22.8%  4599 1469s
  3590  3002 59317.8902   41  416 54852.8771 67332.2356  22.8%  4598 1522s
  3591  3002 56170.9248   64  416 54852.8771 67332.2356  22.8%  4596 1558s
  3592  3006 67332.2356   11  345 54852.8771 67332.2356  22.8%  4650 1581s
  3594  3009 67332.2356   12  335 54852.8771 67332.2356  22.8%  4651 1602s
  3598  3016 67332.2356   13  334 54852.8771 67332.2356  22.8%  4659 1629s
  3606  3029 67332.2356   14  351 54852.8771 67332.2356  22.8%  4674 1650s
  3622  3041 63663.5338   15  238 54852.8771 67332.2356  22.8%  4734 1710s
  3639  3067 64860.4374   16  331 54852.8771 67332.2356  22.8%  4758 1742s
  3671  3190 64639.2046   17  313 54852.8771 67332.2356  22.8%  4815 1777s
  3804  3206 64186.5216   20  360 54852.8771 67332.2356  22.8%  4781 1798s
  3865  3235 63488.4664   21  289 54852.8771 67332.2356  22.8%  4776 1818s
  3915  3249 63978.1958   19  310 54852.8771 67332.2356  22.8%  4794 1839s
  3961  3249 57598.7595   21  294 54852.8771 67332.2356  22.8%  4796 1862s
  4016  3253 63508.2007   21  305 54852.8771 67332.2356  22.8%  4793 1883s
  4069  3245 56649.6773   21  244 54852.8771 67332.2356  22.8%  4790 1905s
  4137  3242 62688.6802   22  315 54852.8771 67332.2356  22.8%  4774 1932s
  4208  3242 61379.3267   22  278 54852.8771 67332.2356  22.8%  4758 1952s
  4268  3237 60988.3784   23  283 54852.8771 67332.2356  22.8%  4745 1971s
  4306  3243 60749.3046   24  281 54852.8771 67332.2356  22.8%  4744 1989s
  4353  3246 60732.3170   25  281 54852.8771 67332.2356  22.8%  4737 2006s
  4390  3249 60587.6354   26  256 54852.8771 67332.2356  22.8%  4725 2025s
  4432  3249 60534.2459   27  243 54852.8771 67332.2356  22.8%  4712 2047s
  4486  3240     cutoff   28      54852.8771 67332.2356  22.8%  4687 2064s
  4530  3246 59028.9571   29  229 54852.8771 67332.2356  22.8%  4683 2084s
  4578  3253 57497.5318   29  242 54852.8771 66833.6474  21.8%  4677 2099s
  4616  3254 56811.4277   30  237 54852.8771 66833.2896  21.8%  4680 2122s
  4675  3253     cutoff   31      54852.8771 66833.2896  21.8%  4658 2141s
  4712  3255     cutoff   32      54852.8771 66833.2896  21.8%  4654 2177s
H 4753  3090                    55030.443022 66833.2896  21.4%  4650 2177s
  4756  3113 55429.1210   33  211 55030.4430 66833.2896  21.4%  4651 2203s
  4880  3093 63195.1853   19  309 55030.4430 66156.1644  20.2%  4600 2236s
  4982  3098 61789.3314   20  283 55030.4430 66148.9690  20.2%  4577 2266s
  5070  3114 56088.7987   22  194 55030.4430 66148.9690  20.2%  4573 2300s
  5210  3084     cutoff   24      55030.4430 66148.9690  20.2%  4523 2333s
  5333  3091 60133.5943   24  227 55030.4430 65014.8978  18.1%  4487 2364s
  5434  3097 59485.6669   26  240 55030.4430 65014.8978  18.1%  4481 2395s
  5567  3086 55499.4053   29  178 55030.4430 64932.8274  18.0%  4458 2428s
  5725  3044 55872.1837   25  267 55030.4430 64932.8274  18.0%  4411 2463s
  5821  3052 55856.5243   26  270 55030.4430 64932.8274  18.0%  4393 2496s
  5897  3078 55574.4762   27  236 55030.4430 64932.8274  18.0%  4392 2527s
  5976  3099 55571.7803   28  234 55030.4430 64932.8274  18.0%  4395 2559s
  6097  3066 55466.0754   29  229 55030.4430 64932.8274  18.0%  4373 2596s
  6250  3073 62479.8834   21  285 55030.4430 64932.8274  18.0%  4346 2639s
  6394  3089 58145.3829   24  203 55030.4430 64932.8274  18.0%  4330 2681s
  6604  3082 56154.2567   22  166 55030.4430 63904.6879  16.1%  4271 2723s
  6819  3098 60964.5299   17  301 55030.4430 63788.1465  15.9%  4220 2766s
  7024  3110     cutoff   20      55030.4430 63763.4432  15.9%  4192 2809s
  7223  3060 57200.2761   18  295 55030.4430 63763.4432  15.9%  4162 2840s
  7270  3054 56247.7457   19  268 55030.4430 63763.4432  15.9%  4163 2875s
  7365  3054 55565.4965   20  188 55030.4430 63763.4432  15.9%  4152 2925s
  7530  3100     cutoff   21      55030.4430 63437.9715  15.3%  4132 2972s
  7777  3116 59687.9033   24  277 55030.4430 63376.7028  15.2%  4096 3023s
  8115  3038     cutoff   29      55030.4430 63232.7074  14.9%  4025 3077s
  8367  3009 55860.7456   28  244 55030.4430 62956.2133  14.4%  4014 3132s
  8609  2992 55542.1330   29  159 55030.4430 62741.8786  14.0%  4011 3192s
  8898  2978 infeasible   30      55030.4430 62667.2932  13.9%  3988 3250s
  9198  2944     cutoff   31      55030.4430 62582.1815  13.7%  3968 3308s
  9586  2876 55608.5948   24  104 55030.4430 62487.8205  13.6%  3916 3367s
  9848  2832 56026.4061   26  322 55030.4430 62104.1285  12.9%  3891 3432s
 10172  2787     cutoff   35      55030.4430 61940.5731  12.6%  3874 3501s
 10613  2696     cutoff   21      55030.4430 61768.4259  12.2%  3821 3572s
 11106  2520 55584.5873   23  314 55030.4430 61589.0927  11.9%  3762 3600s

Cutting planes:
  Learned: 1
  MIR: 813
  Mixing: 1
  Flow cover: 1677
  RLT: 12
  Relax-and-lift: 172

Explored 11309 nodes (42562844 simplex iterations) in 3600.04 seconds (6551.57 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 55030.4 54852.9 54682 ... 52932.4

Time limit reached
Best objective 5.503044302151e+04, best bound 6.154999724090e+04, gap 11.8472%
  WARNING: Time limit reached. Using best solution found (gap: 11.85%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 55030.44, θ = 215587.23
  Upper Bound (UB) = 55030.44

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215587.23
  [DEBUG]   ✓ Scenario 0: θ = 215587.23 ≤ Q = 215587.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215587.23 ≤ Q = 215587.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 215587.23 ≤ Q = 215587.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 215587.23 ≤ Q = 215587.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 215587.23 ≤ Q = 215587.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 215587.23 ≤ Q = 215587.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 215587.23 ≤ Q = 215587.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 215587.23 ≤ Q = 215587.23 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71dc6bc8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71dc6bc8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.373082e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1502 nonzeros
Found heuristic solution: objective 6734612.9783
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6734114.9849

Root relaxation: objective -1.923955e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -192395.51    0  122 6734114.98 -192395.51   103%     -    0s
H    0     0                    -158929.6218 -192395.51  21.1%     -    0s
H    0     0                    -168508.7598 -170981.72  1.47%     -    0s
     0     0 -170981.72    0   93 -168508.76 -170981.72  1.47%     -    0s
H    0     0                    -168799.0472 -170885.68  1.24%     -    0s
H    0     0                    -169049.1105 -170885.68  1.09%     -    0s
H    0     0                    -169339.3979 -170885.68  0.91%     -    0s
     0     0 -170038.24    0   76 -169339.40 -170038.24  0.41%     -    0s
H    0     0                    -169563.6199 -170038.24  0.28%     -    0s
     0     0 -170012.74    0   74 -169563.62 -170012.74  0.26%     -    0s
     0     0 -169842.36    0   42 -169563.62 -169842.36  0.16%     -    0s
     0     0 -169835.08    0   40 -169563.62 -169835.08  0.16%     -    0s
     0     0 -169804.04    0   38 -169563.62 -169804.04  0.14%     -    0s
     0     0 -169803.37    0   39 -169563.62 -169803.37  0.14%     -    0s
     0     0 -169743.65    0   36 -169563.62 -169743.65  0.11%     -    0s
     0     0 -169743.65    0   42 -169563.62 -169743.65  0.11%     -    0s
     0     0 -169743.65    0   44 -169563.62 -169743.65  0.11%     -    0s
     0     0 -169743.65    0   28 -169563.62 -169743.65  0.11%     -    0s
H    0     0                    -169582.2413 -169743.65  0.10%     -    0s
     0     0 -169743.65    0   27 -169582.24 -169743.65  0.10%     -    0s
     0     0 -169684.16    0    8 -169582.24 -169684.16  0.06%     -    0s
     0     0          -    0      -169582.24 -169598.08  0.01%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 4
  MIR: 33
  Flow cover: 16
  RLT: 4
  Relax-and-lift: 1

Explored 1 nodes (876 simplex iterations) in 0.15 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -169582 -169564 -169556 ... 1.37308e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.695822413067e+05, best bound -1.695980783675e+05, gap 0.0093%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 205122.40
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -169582.24
  [DEBUG]   S×d_nominal = 374704.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374704.64 + -169582.24 = 205122.40
  [DEBUG]   Current θ from Master = 215587.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10464.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44565.61
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 4866.3353, Absolute Gap = 4866.3353, Relative Gap = 0.088430
  Not converged yet (gap = 4866.34 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0xb9237ba8
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 2.39s
Presolved: 81726 rows, 35173 columns, 499754 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -300583.5157
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 81726 rows, 35173 columns, 499754 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23332   -1.8869470e+05   0.000000e+00   2.466330e+06      5s
   37044   -4.2234747e+04   0.000000e+00   3.450034e+07     10s
   46131    3.4651019e+03   0.000000e+00   1.221330e+08     15s
   55714    1.0195268e+04   0.000000e+00   5.010088e+06     20s
   59297    1.0296234e+04   0.000000e+00   6.442469e+07     25s
   65272    3.5271255e+04   0.000000e+00   2.369766e+07     30s
   71934    4.6849766e+04   0.000000e+00   9.298131e+07     35s
   77784    5.1742407e+04   0.000000e+00   6.346548e+06     40s
   85118    5.5187597e+04   0.000000e+00   1.143425e+06     45s
   89675    5.6148842e+04   0.000000e+00   1.501696e+07     50s
   93614    5.6768791e+04   0.000000e+00   3.705148e+06     55s
Concurrent spin time: 6.86s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.718188e+04, 77345 iterations, 59.24 seconds (76.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87181.8785    0  140 -203987.28 87181.8785   143%     -   62s
H    0     0                    -194226.9464 87181.8785   145%     -   62s
H    0     0                    -29913.40870 87181.8785   391%     -   63s
H    0     0                    44926.193716 87181.8785  94.1%     -   63s
H    0     0                    47409.888251 87181.8785  83.9%     -   64s
H    0     0                    47711.052677 87181.8785  82.7%     -   64s
H    0     0                    50847.631261 87181.8785  71.5%     -   64s
H    0     0                    51986.464248 87181.8785  67.7%     -   65s
H    0     0                    52054.948678 87181.8785  67.5%     -   65s
H    0     0                    52598.449170 87181.8785  65.7%     -   65s
H    0     0                    52695.405657 87181.8785  65.4%     -   65s
H    0     0                    52949.609469 87181.8785  64.7%     -   65s
     0     0 80416.6346    0  181 52949.6095 80416.6346  51.9%     -   91s
     0     0 80337.2880    0  190 52949.6095 80337.2880  51.7%     -   99s
     0     0 80318.4094    0  202 52949.6095 80318.4094  51.7%     -  104s
     0     0 80318.4094    0  195 52949.6095 80318.4094  51.7%     -  106s
     0     0 80318.4094    0  195 52949.6095 80318.4094  51.7%     -  109s
     0     0 80318.4094    0  193 52949.6095 80318.4094  51.7%     -  110s
     0     0 80318.4094    0  193 52949.6095 80318.4094  51.7%     -  111s
     0     0 76698.7315    0  206 52949.6095 76698.7315  44.9%     -  138s
     0     0 76020.3340    0  234 52949.6095 76020.3340  43.6%     -  152s
     0     0 75803.6110    0  231 52949.6095 75803.6110  43.2%     -  159s
     0     0 75661.8114    0  232 52949.6095 75661.8114  42.9%     -  165s
     0     0 75468.0924    0  243 52949.6095 75468.0924  42.5%     -  173s
     0     0 75383.1983    0  248 52949.6095 75383.1983  42.4%     -  177s
     0     0 75374.9399    0  248 52949.6095 75374.9399  42.4%     -  178s
     0     0 75360.1253    0  251 52949.6095 75360.1253  42.3%     -  180s
     0     0 75358.2112    0  246 52949.6095 75358.2112  42.3%     -  181s
     0     0 75335.4553    0  242 52949.6095 75335.4553  42.3%     -  184s
     0     0 75303.0765    0  254 52949.6095 75303.0765  42.2%     -  187s
     0     0 75298.9128    0  252 52949.6095 75298.9128  42.2%     -  188s
     0     0 75286.7828    0  247 52949.6095 75286.7828  42.2%     -  190s
     0     0 75286.2757    0  247 52949.6095 75286.2757  42.2%     -  190s
     0     0 72290.1040    0  287 52949.6095 72290.1040  36.5%     -  222s
     0     0 71829.4314    0  307 52949.6095 71829.4314  35.7%     -  236s
     0     0 71717.0143    0  308 52949.6095 71717.0143  35.4%     -  244s
     0     0 71523.3964    0  321 52949.6095 71523.3964  35.1%     -  257s
     0     0 71433.4868    0  371 52949.6095 71433.4868  34.9%     -  264s
     0     0 71402.4213    0  364 52949.6095 71402.4213  34.8%     -  268s
     0     0 71386.3771    0  374 52949.6095 71386.3771  34.8%     -  270s
H    0     0                    53073.916956 71350.6216  34.4%     -  274s
H    0     0                    53150.235086 71350.6216  34.2%     -  274s
     0     0 71350.6216    0  371 53150.2351 71350.6216  34.2%     -  274s
     0     0 71319.5997    0  377 53150.2351 71319.5997  34.2%     -  277s
     0     0 71301.6468    0  372 53150.2351 71301.6468  34.2%     -  279s
     0     0 71295.2259    0  385 53150.2351 71295.2259  34.1%     -  280s
     0     0 71238.6868    0  329 53150.2351 71238.6868  34.0%     -  284s
     0     0 71221.3172    0  378 53150.2351 71221.3172  34.0%     -  286s
     0     0 71217.7795    0  376 53150.2351 71217.7795  34.0%     -  287s
     0     0 71206.4959    0  374 53150.2351 71206.4959  34.0%     -  288s
     0     0 71203.8063    0  374 53150.2351 71203.8063  34.0%     -  289s
     0     0 71202.0738    0  382 53150.2351 71202.0738  34.0%     -  290s
     0     0 70441.0957    0  326 53150.2351 70441.0957  32.5%     -  313s
     0     0 70202.3981    0  338 53150.2351 70202.3981  32.1%     -  322s
     0     0 70147.5839    0  342 53150.2351 70147.5839  32.0%     -  328s
     0     0 70132.6823    0  368 53150.2351 70132.6823  32.0%     -  331s
     0     0 70118.5153    0  375 53150.2351 70118.5153  31.9%     -  334s
     0     0 70104.1887    0  339 53150.2351 70104.1887  31.9%     -  336s
     0     0 70090.9491    0  338 53150.2351 70090.9491  31.9%     -  337s
     0     0 70088.1640    0  332 53150.2351 70088.1640  31.9%     -  337s
     0     0 70084.0447    0  331 53150.2351 70084.0447  31.9%     -  338s
     0     0 70075.7195    0  336 53150.2351 70075.7195  31.8%     -  339s
     0     0 70033.7369    0  367 53150.2351 70033.7369  31.8%     -  342s
     0     0 69999.7654    0  341 53150.2351 69999.7654  31.7%     -  345s
     0     0 69989.1760    0  335 53150.2351 69989.1760  31.7%     -  346s
     0     0 69982.2320    0  338 53150.2351 69982.2320  31.7%     -  348s
     0     0 69980.0945    0  333 53150.2351 69980.0945  31.7%     -  349s
     0     0 69807.8924    0  335 53150.2351 69807.8924  31.3%     -  356s
     0     0 69748.7057    0  347 53150.2351 69748.7057  31.2%     -  360s
     0     0 69736.7312    0  351 53150.2351 69736.7312  31.2%     -  362s
     0     0 69708.0120    0  341 53150.2351 69708.0120  31.2%     -  363s
     0     0 69700.1586    0  342 53150.2351 69700.1586  31.1%     -  364s
     0     0 69696.6460    0  351 53150.2351 69696.6460  31.1%     -  365s
     0     0 69694.7553    0  354 53150.2351 69694.7553  31.1%     -  365s
     0     0 69607.4555    0  372 53150.2351 69607.4555  31.0%     -  372s
     0     0 69576.6064    0  392 53150.2351 69576.6064  30.9%     -  378s
     0     0 69561.1412    0  395 53150.2351 69561.1412  30.9%     -  380s
     0     0 69554.3008    0  387 53150.2351 69554.3008  30.9%     -  381s
     0     0 69553.0876    0  378 53150.2351 69553.0876  30.9%     -  382s
     0     0 69517.6947    0  401 53150.2351 69517.6947  30.8%     -  387s
     0     0 69513.8725    0  395 53150.2351 69513.8725  30.8%     -  390s
     0     0 69512.0626    0  403 53150.2351 69512.0626  30.8%     -  391s
     0     0 69501.7462    0  408 53150.2351 69501.7462  30.8%     -  394s
H    0     0                    53469.994610 69501.0678  30.0%     -  399s
     0     0 69497.3169    0  358 53469.9946 69497.3169  30.0%     -  401s
     0     0 69494.6506    0  412 53469.9946 69494.6506  30.0%     -  402s
     0     0 69492.6815    0  407 53469.9946 69492.6815  30.0%     -  403s
     0     0 69449.4451    0  403 53469.9946 69449.4451  29.9%     -  407s
     0     0 69431.8576    0  412 53469.9946 69431.8576  29.9%     -  412s
     0     0 69429.6097    0  419 53469.9946 69429.6097  29.8%     -  413s
     0     0 69423.9582    0  415 53469.9946 69423.9582  29.8%     -  417s
     0     0 69419.6506    0  407 53469.9946 69419.6506  29.8%     -  422s
     0     0 69418.9215    0  419 53469.9946 69418.9215  29.8%     -  422s
     0     0 69417.7998    0  411 53469.9946 69417.7998  29.8%     -  424s
     0     0 69416.2698    0  409 53469.9946 69416.2698  29.8%     -  426s
     0     0 69414.4171    0  409 53469.9946 69414.4171  29.8%     -  428s
     0     0 69414.3916    0  409 53469.9946 69414.3916  29.8%     -  430s
     0     2 69414.3916    0  409 53469.9946 69414.3916  29.8%     -  590s
     1     4 69346.5534    1  397 53469.9946 69414.3129  29.8%  3528  597s
     3     8 69146.6906    2  350 53469.9946 69345.9581  29.7%  5809  619s
     7    16 68796.9556    3  405 53469.9946 69146.6097  29.3%  9758  634s
    15    32 68664.1418    4  355 53469.9946 68796.5145  28.7% 10582  653s
    31    48 68156.0902    5  388 53469.9946 68663.8282  28.4% 14612  689s
    47    80 67318.4180    6  400 53469.9946 68663.8282  28.4% 15736  716s
H   60    80                    53652.844529 68663.8282  28.0% 14846  716s
H   70    80                    53678.827204 68663.8282  27.9% 13753  716s
    79   144 67193.9725    7  394 53678.8272 68663.8282  27.9% 13079  794s
   143   176 67024.7444    8  384 53678.8272 68663.8282  27.9%  9802  817s
H  146   176                    53678.996763 68663.8282  27.9%  9665  817s
H  155   176                    53683.272026 68663.8282  27.9%  9278  817s
   175   284 67066.1637    9  395 53683.2720 68663.8282  27.9%  8751  848s
   283   371 66902.6621   10  381 53683.2720 68663.8282  27.9%  7425  871s
   370   448 66413.3738   11  369 53683.2720 68663.8282  27.9%  6610  894s
   449   535 66804.0732   11  387 53683.2720 68663.8282  27.9%  6143  913s
   536   614 66242.5365   10  360 53683.2720 68663.8282  27.9%  5723  934s
   623   643 66553.2942   10  338 53683.2720 68663.8282  27.9%  5366  950s
H  638   643                    53696.053672 68663.8282  27.9%  5345  950s
   654   703 66630.5368   12  362 53696.0537 68663.8282  27.9%  5293  970s
   720   734 66046.5035   12  321 53696.0537 68663.8282  27.9%  5148  987s
H  750   734                    53752.309145 68663.8282  27.7%  5096  987s
   751   808 66088.3480   13  350 53752.3091 68663.8282  27.7%  5101 1006s
   845   838 65275.2314   13  331 53752.3091 68663.8282  27.7%  4816 1021s
   875   872 65850.4833   12  360 53752.3091 68663.8282  27.7%  4765 1036s
H  889   872                    53877.151909 68663.8282  27.4%  4729 1036s
   913   903 65841.2028   14  273 53877.1519 68663.8282  27.4%  4685 1051s
H  944   936                    53926.801801 68663.8282  27.3%  4630 1069s
H  957   936                    53986.288190 68663.8282  27.2%  4595 1069s
   987  1068 64518.0922   16  258 53986.2882 68663.8282  27.2%  4585 1091s
  1139  1147 64366.8867   15  268 53986.2882 68663.8282  27.2%  4181 1112s
  1273  1216 65404.8311   16  281 53986.2882 68663.8282  27.2%  3963 1131s
  1388  1275 64829.9446   17  271 53986.2882 68663.8282  27.2%  3837 1155s
  1510  1332 64087.5110   18  265 53986.2882 68663.8282  27.2%  3734 1181s
  1641  1381 64409.5085   18  274 53986.2882 68663.8282  27.2%  3624 1208s
  1721  1415 63538.1422   19  270 53986.2882 68663.8282  27.2%  3634 1230s
  1785  1464 61639.7102   19  242 53986.2882 68663.8282  27.2%  3649 1255s
  1879  1529 64044.9162   19  256 53986.2882 68578.1319  27.0%  3638 1280s
  1972  1596 61120.5152   23  218 53986.2882 68578.1108  27.0%  3632 1307s
  2079  1671 59149.1346   20  239 53986.2882 68578.1108  27.0%  3595 1334s
  2200  1769 57949.6678   31  191 53986.2882 68578.1108  27.0%  3550 1363s
  2352  1915 60945.2055   20  238 53986.2882 68578.1108  27.0%  3505 1392s
  2518  2080 59266.8561   20  332 53986.2882 68578.1108  27.0%  3438 1420s
  2749  2190 60734.7365   21  240 53986.2882 68393.6595  26.7%  3311 1457s
  2931  2307 60063.0091   23  219 53986.2882 67935.4680  25.8%  3270 1491s
  3126  2427 59059.4158   22  223 53986.2882 67935.4680  25.8%  3221 1525s
  3299  2535 59564.5179   24  239 53986.2882 67935.4680  25.8%  3211 1558s
  3488  2673 59164.6819   25  252 53986.2882 67732.9858  25.5%  3189 1594s
  3700  2814 58251.9064   30  244 53986.2882 67488.2292  25.0%  3158 1628s
  3950  2815 60005.8479   14  409 53986.2882 67457.5848  25.0%  3115 1717s
  3952  2816 65499.5858   20  114 53986.2882 67457.5848  25.0%  3113 1730s
  3953  2817 63719.2633   21  257 53986.2882 67457.5848  25.0%  3112 1794s
  3954  2818 66255.2625    8  290 53986.2882 67457.5848  25.0%  3111 1863s
  3955  2818 64495.2979    8  346 53986.2882 67457.5848  25.0%  3111 1899s
  3956  2819 65426.4684   15  319 53986.2882 67457.5848  25.0%  3110 1928s
  3957  2820 64732.2230    8  371 53986.2882 67457.5848  25.0%  3109 1946s
  3958  2820 65938.5218    9  367 53986.2882 67457.5848  25.0%  3108 1964s
  3959  2821 54701.5234   43  375 53986.2882 67457.5848  25.0%  3108 1977s
  3960  2822 56531.5540    9  391 53986.2882 67457.5848  25.0%  3107 1986s
  3961  2822 66108.5402    9  372 53986.2882 67457.5848  25.0%  3106 1996s
  3962  2823 66603.7040   14  384 53986.2882 67457.5848  25.0%  3105 2002s
  3963  2824 56362.0906   29  389 53986.2882 67457.5848  25.0%  3104 2008s
  3964  2824 55715.1444   47  389 53986.2882 67457.5848  25.0%  3104 2012s
  3965  2825 64618.9363   16  393 53986.2882 67457.5848  25.0%  3103 2017s
  3966  2826 55619.4339   31  394 53986.2882 67457.5848  25.0%  3102 2023s
  3967  2826 63696.2095    9  403 53986.2882 67457.5848  25.0%  3101 2038s
  3968  2827 57591.2841   39  395 53986.2882 67457.5848  25.0%  3100 2046s
  3969  2828 66005.9379    7  353 53986.2882 67457.5848  25.0%  3100 2051s
  3970  2828 63139.7591   11  413 53986.2882 67457.5848  25.0%  3099 2057s
  3971  2829 63023.3483   19  363 53986.2882 67457.5848  25.0%  3098 2062s
  3972  2830 56851.9184   28  409 53986.2882 67457.5848  25.0%  3097 2065s
  3973  2830 55814.8623   66  371 53986.2882 67457.5848  25.0%  3097 2074s
  3974  2831 55054.6238   37  413 53986.2882 67457.5848  25.0%  3096 2079s
  3975  2832 56516.1671   40  356 53986.2882 67457.5848  25.0%  3095 2082s
  3976  2832 61650.2441   24  369 53986.2882 67457.5848  25.0%  3094 2089s
  3977  2833 58715.1448   30  373 53986.2882 67457.5848  25.0%  3093 2092s
  3978  2834 62319.8964   20  371 53986.2882 67457.5848  25.0%  3093 2099s
  3979  2834 57444.9533   34  418 53986.2882 67457.5848  25.0%  3092 2104s
  3980  2835 66629.1346   13  372 53986.2882 67457.5848  25.0%  3091 2111s
  3982  2836 67454.7545   12  370 53986.2882 67457.5848  25.0%  3090 2119s
  3983  2837 56803.1806   24  372 53986.2882 67457.5848  25.0%  3089 2122s
  3984  2838 58845.9083   55  366 53986.2882 67457.5848  25.0%  3088 2128s
  3985  2838 57490.8179   22  414 53986.2882 67457.5848  25.0%  3087 2131s
  3986  2839 57251.6492   27  406 53986.2882 67457.5848  25.0%  3086 2137s
  3987  2840 58715.1448   30  413 53986.2882 67457.5848  25.0%  3086 2140s
  3988  2840 61570.2423   40  365 53986.2882 67457.5848  25.0%  3085 2146s
  3989  2841 64916.1515   14  365 53986.2882 67457.5848  25.0%  3084 2161s
H 3989  2698                    53988.195299 67457.5848  24.9%  3084 2223s
  3991  2702 67457.5848   12  396 53988.1953 67457.5848  24.9%  3152 2269s
  3993  2706 67457.5848   13  391 53988.1953 67457.5848  24.9%  3154 2313s
  3997  2712 67457.5848   14  398 53988.1953 67457.5848  24.9%  3164 2348s
  4005  2726 67457.5848   15  385 53988.1953 67457.5848  24.9%  3182 2405s
  4021  2736 67265.7832   16  352 53988.1953 67457.5848  24.9%  3232 2474s
  4037  2763 65369.9019   17  340 53988.1953 67457.5848  24.9%  3328 2526s
H 4038  2627                    54031.880183 67457.5848  24.8%  3327 2526s
  4069  2752 65249.0975   18  329 54031.8802 67457.5848  24.8%  3375 2580s
  4205  2752 64533.5261   21  319 54031.8802 67457.5848  24.8%  3451 2604s
  4250  2809 64564.1297   22  307 54031.8802 67457.5848  24.8%  3453 2633s
  4322  2849 64524.2398   22  300 54031.8802 67457.5848  24.8%  3458 2661s
  4386  2881 64341.0271   23  306 54031.8802 67457.5848  24.8%  3472 2686s
  4444  2883 64299.5153   22  306 54031.8802 67457.5848  24.8%  3483 2709s
  4476  2903 64254.4269   22  295 54031.8802 67457.5848  24.8%  3495 2737s
  4514  2917 64071.3338   23  323 54031.8802 67457.5848  24.8%  3501 2768s
  4561  2929 64004.9753   23  278 54031.8802 67457.5848  24.8%  3502 2800s
  4609  2944 63755.0242   24  316 54031.8802 67457.5848  24.8%  3511 2829s
  4665  2944 63867.5902   24  297 54031.8802 67457.5848  24.8%  3514 2857s
  4730  2917 63564.9458   24  284 54031.8802 67457.5848  24.8%  3516 2932s
  4788  2901 61596.6890   26  303 54031.8802 67457.5848  24.8%  3516 2967s
  4831  2908 62322.6910   24  317 54031.8802 67457.5848  24.8%  3524 3000s
  4894  2907 62057.9676   25  306 54031.8802 67457.5848  24.8%  3516 3030s
  4955  2920 61452.6601   26  309 54031.8802 67457.5848  24.8%  3521 3062s
H 4972  2785                    54052.300642 67457.5848  24.8%  3522 3062s
  5035  2794 55691.4461   24  266 54052.3006 67457.5848  24.8%  3511 3093s
  5134  2793 55465.3970   25  267 54052.3006 67457.5848  24.8%  3493 3127s
  5243  2781 59229.3856   23  309 54052.3006 67457.5848  24.8%  3474 3157s
H 5260  2653                    54162.418142 67457.5848  24.5%  3474 3157s
H 5304  2523                    54212.407078 67457.5848  24.4%  3465 3157s
  5317  2545 59198.2078   24  309 54212.4071 67457.5848  24.4%  3463 3191s
  5429  2528 54302.8441   25  242 54212.4071 67457.5848  24.4%  3450 3220s
H 5433  2416                    54678.889047 67457.5848  23.4%  3452 3220s
H 5455  2303                    54699.624006 67457.5848  23.3%  3463 3220s
  5462  2341     cutoff   24      54699.6240 67457.5848  23.3%  3466 3257s
  5563  2349     cutoff   29      54699.6240 67457.5848  23.3%  3467 3296s
  5647  2365     cutoff   31      54699.6240 67457.5848  23.3%  3488 3332s
  5742  2373     cutoff   32      54699.6240 67457.5848  23.3%  3504 3369s
  5842  2401 62318.2397   20  283 54699.6240 67457.5848  23.3%  3516 3406s
  5965  2405 61474.6870   23  231 54699.6240 67457.5848  23.3%  3519 3449s
  6116  2378 58936.5919   25  187 54699.6240 67457.5848  23.3%  3508 3483s
  6151  2407 58547.9325   26  198 54699.6240 67012.3560  22.5%  3517 3513s
H 6200  2292                    54889.250002 67012.3560  22.1%  3504 3513s
  6231  2323 58512.8736   27  192 54889.2500 67012.3560  22.1%  3495 3559s
  6411  2318 55339.2924   30  166 54889.2500 67012.3560  22.1%  3475 3600s

Cutting planes:
  Gomory: 21
  Implied bound: 29
  Projected implied bound: 52
  MIR: 1096
  Mixing: 1
  Flow cover: 1495
  RLT: 14
  Relax-and-lift: 243

Explored 6540 nodes (23143672 simplex iterations) in 3600.06 seconds (6045.21 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 54889.3 54699.6 54678.9 ... 53926.8

Time limit reached
Best objective 5.488925000226e+04, best bound 6.701235600793e+04, gap 22.0865%
  WARNING: Time limit reached. Using best solution found (gap: 22.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 54889.25, θ = 215041.48
  Upper Bound (UB) = 54889.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215041.48
  [DEBUG]   ✓ Scenario 0: θ = 215041.48 ≤ Q = 215041.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215041.48 ≤ Q = 215041.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 215041.48 ≤ Q = 215041.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 215041.48 ≤ Q = 215041.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 215041.48 ≤ Q = 215041.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 215041.48 ≤ Q = 215041.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 215041.48 ≤ Q = 215041.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 215041.48 ≤ Q = 215041.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 215041.48 ≤ Q = 215041.48 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4d032e33
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb2fcd1cd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.378815e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1502 nonzeros
Found heuristic solution: objective 6809327.6341
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6809047.8813

Root relaxation: objective -1.939866e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -193986.58    0  124 6809047.88 -193986.58   103%     -    0s
H    0     0                    -160777.1474 -193986.58  20.7%     -    0s
H    0     0                    -161056.9001 -193986.58  20.4%     -    0s
H    0     0                    -161097.8436 -193986.58  20.4%     -    0s
H    0     0                    -161377.5963 -193986.58  20.2%     -    0s
H    0     0                    -161522.5429 -193826.68  20.0%     -    0s
     0     0 -170954.43    0   70 -161522.54 -170954.43  5.84%     -    0s
H    0     0                    -169805.9101 -170880.97  0.63%     -    0s
H    0     0                    -170112.1645 -170880.97  0.45%     -    0s
     0     0 -170315.97    0   47 -170112.16 -170315.97  0.12%     -    0s
     0     0 -170263.82    0   23 -170112.16 -170263.82  0.09%     -    0s
     0     0 -170260.46    0   22 -170112.16 -170260.46  0.09%     -    0s
     0     0 -170229.36    0   17 -170112.16 -170229.36  0.07%     -    0s
     0     0 -170222.20    0   16 -170112.16 -170222.20  0.06%     -    0s
     0     0          -    0      -170112.16 -170123.38  0.01%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 7
  MIR: 156
  Flow cover: 6
  RLT: 29
  Relax-and-lift: 7

Explored 1 nodes (561 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -170112 -161523 -161378 ... 1.37882e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.701121645415e+05, best bound -1.701233835168e+05, gap 0.0066%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 205784.03
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -170112.16
  [DEBUG]   S×d_nominal = 375896.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 375896.19 + -170112.16 = 205784.03
  [DEBUG]   Current θ from Master = 215041.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9257.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45631.80
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 4725.1422, Absolute Gap = 4725.1422, Relative Gap = 0.086085
  Not converged yet (gap = 4725.14 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0xf991d9e9
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.54s
Presolved: 90653 rows, 38830 columns, 550629 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -313439.1519
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.964e+06
 Factor NZ  : 8.602e+06 (roughly 120 MB of memory)
 Factor Ops : 1.498e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.88444480e+07  1.81488134e+08  1.39e+05 1.64e+01  9.19e+04     4s
   1  -1.42787769e+07  1.67626324e+08  9.91e+04 1.02e+02  6.52e+04     4s
   2  -4.80297354e+06  1.31760985e+08  3.40e+04 2.47e+01  2.36e+04     4s
   3  -3.33969034e+06  1.31767457e+08  2.30e+04 3.35e+01  1.62e+04     4s
   4  -9.75309164e+05  8.76107329e+07  2.08e+03 8.68e-02  1.89e+03     4s
   5  -7.28960237e+05  5.26787303e+07  5.62e+02 3.09e-02  6.54e+02     5s
   6  -6.61374755e+05  3.39690385e+07  2.50e+02 1.27e-02  3.43e+02     5s
   7  -5.71679260e+05  2.52420490e+07  1.78e+02 1.00e-02  2.43e+02     5s
   8  -4.49372224e+05  1.62555738e+07  4.42e+01 7.25e-03  1.19e+02     5s
   9  -3.31089123e+05  1.12526552e+07  1.51e+01 4.75e-03  7.48e+01     5s
  10  -2.21044566e+05  6.95819455e+06  6.90e+00 2.94e-03  4.48e+01     5s
  11  -1.15466189e+05  1.51331526e+06  2.55e+00 4.31e-04  9.97e+00     5s
  12  -3.85561628e+04  5.89994097e+05  1.11e+00 1.07e-04  3.81e+00     5s
  13   2.55111521e+03  3.74276840e+05  6.63e-01 1.65e-04  2.25e+00     5s
  14   1.42562094e+04  2.58904843e+05  5.29e-01 2.23e-03  1.48e+00     5s
  15   2.70102550e+04  2.11280480e+05  4.11e-01 1.52e-03  1.11e+00     5s
  16   4.22024015e+04  1.75980685e+05  2.85e-01 1.77e-03  8.08e-01     5s
  17   4.60048287e+04  1.48165991e+05  2.54e-01 1.73e-03  6.17e-01     5s
  18   5.46816631e+04  1.33325924e+05  1.92e-01 1.85e-03  4.75e-01     5s
  19   6.21555204e+04  1.17672822e+05  1.43e-01 2.57e-03  3.35e-01     6s
  20   6.70210756e+04  1.09582009e+05  1.11e-01 2.13e-03  2.57e-01     6s
  21   7.19047527e+04  1.04501078e+05  8.16e-02 2.19e-03  1.97e-01     6s
  22   7.39410605e+04  9.96009852e+04  6.89e-02 1.64e-03  1.55e-01     6s
  23   7.73259809e+04  9.70220063e+04  4.96e-02 1.54e-03  1.19e-01     6s
  24   8.13305672e+04  9.45003255e+04  2.82e-02 1.85e-03  7.94e-02     6s
  25   8.26317189e+04  9.12301715e+04  2.17e-02 1.02e-03  5.19e-02     6s
  26   8.47397265e+04  8.99926119e+04  1.17e-02 7.38e-04  3.17e-02     6s
  27   8.52297848e+04  8.91962262e+04  9.44e-03 5.22e-04  2.39e-02     6s
  28   8.58371790e+04  8.86604131e+04  6.71e-03 3.60e-04  1.70e-02     6s
  29   8.61966555e+04  8.85229179e+04  5.12e-03 3.19e-04  1.40e-02     6s
  30   8.64160335e+04  8.82345730e+04  4.17e-03 2.34e-04  1.10e-02     6s
  31   8.66192810e+04  8.80224367e+04  3.36e-03 1.70e-04  8.46e-03     7s
  32   8.66732585e+04  8.78907987e+04  3.13e-03 1.29e-04  7.34e-03     7s
  33   8.68039333e+04  8.77897488e+04  2.59e-03 9.76e-05  5.95e-03     7s
  34   8.69297204e+04  8.76719580e+04  2.08e-03 6.10e-05  4.48e-03     7s
  35   8.70240308e+04  8.76414661e+04  1.70e-03 5.71e-05  3.73e-03     7s
  36   8.71151426e+04  8.76236081e+04  1.34e-03 5.16e-05  3.07e-03     7s
  37   8.71283432e+04  8.75878648e+04  1.29e-03 5.18e-05  2.77e-03     7s
  38   8.71900534e+04  8.75859200e+04  1.05e-03 5.11e-05  2.39e-03     7s
  39   8.72354777e+04  8.75474227e+04  8.65e-04 3.58e-05  1.88e-03     7s
  40   8.72683867e+04  8.75209368e+04  7.29e-04 2.39e-05  1.52e-03     8s
  41   8.72940989e+04  8.75175460e+04  6.25e-04 2.24e-05  1.35e-03     8s
  42   8.73176227e+04  8.75088075e+04  5.36e-04 1.89e-05  1.15e-03     8s
  43   8.73870529e+04  8.74959648e+04  2.61e-04 1.34e-05  6.57e-04     8s
  44   8.74015133e+04  8.74844243e+04  2.06e-04 9.32e-06  5.00e-04     8s
  45   8.74237396e+04  8.74706786e+04  1.22e-04 5.06e-06  2.83e-04     8s
  46   8.74271464e+04  8.74676943e+04  1.09e-04 3.73e-06  2.45e-04     8s
  47   8.74444468e+04  8.74596886e+04  4.51e-05 1.46e-05  9.20e-05     8s
  48   8.74480250e+04  8.74592557e+04  3.30e-05 1.10e-05  6.78e-05     8s
  49   8.74503639e+04  8.74583015e+04  2.50e-05 3.34e-06  4.79e-05     8s
  50   8.74515152e+04  8.74579398e+04  2.10e-05 2.07e-06  3.88e-05     9s
  51   8.74571145e+04  8.74578204e+04  1.71e-06 7.82e-07  4.26e-06     9s
  52   8.74576627e+04  8.74577413e+04  1.54e-07 1.31e-07  4.74e-07     9s
  53   8.74577254e+04  8.74577259e+04  4.34e-09 1.24e-08  3.22e-09     9s

Barrier solved model in 53 iterations and 8.89 seconds (8.38 work units)
Optimal objective 8.74577254e+04


Root crossover log...

   80425 DPushes remaining with DInf 0.0000000e+00                 9s
   20377 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

   10409 PPushes remaining with PInf 2.9630604e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8704624e+04     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   46898    8.7457726e+04   0.000000e+00   1.870462e+04     12s
   47083    8.7457726e+04   0.000000e+00   0.000000e+00     13s
   47083    8.7457726e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.745773e+04, 47083 iterations, 9.50 seconds (10.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87457.7258    0  163 -203987.28 87457.7258   143%     -   13s
H    0     0                    -194226.9464 87457.7258   145%     -   13s
H    0     0                    -42673.46709 87457.7258   305%     -   13s
H    0     0                    26421.223102 87457.7258   231%     -   14s
H    0     0                    46435.029085 87457.7258  88.3%     -   14s
H    0     0                    51003.116463 87457.7258  71.5%     -   15s
H    0     0                    51977.122992 87457.7258  68.3%     -   15s
H    0     0                    52010.536006 87457.7258  68.2%     -   15s
H    0     0                    52311.166576 87457.7258  67.2%     -   15s
H    0     0                    52397.958565 87457.7258  66.9%     -   15s
H    0     0                    52440.091588 87457.7258  66.8%     -   15s
H    0     0                    52511.308901 87457.7258  66.6%     -   15s
H    0     0                    52524.504547 87457.7258  66.5%     -   15s
H    0     0                    52769.286501 87457.7258  65.7%     -   15s
H    0     0                    52867.899439 81996.3145  55.1%     -   52s
H    0     0                    52872.282261 81996.3145  55.1%     -   52s
     0     0 81996.3145    0  180 52872.2823 81996.3145  55.1%     -   52s
     0     0 80887.3312    0  194 52872.2823 80887.3312  53.0%     -   84s
     0     0 80534.8773    0  187 52872.2823 80534.8773  52.3%     -   94s
     0     0 80430.8598    0  201 52872.2823 80430.8598  52.1%     -  103s
     0     0 80430.8598    0  196 52872.2823 80430.8598  52.1%     -  107s
     0     0 80430.8598    0  202 52872.2823 80430.8598  52.1%     -  111s
     0     0 80430.8598    0  208 52872.2823 80430.8598  52.1%     -  124s
     0     0 80430.8598    0  207 52872.2823 80430.8598  52.1%     -  125s
     0     0 80430.8167    0  207 52872.2823 80430.8167  52.1%     -  126s
     0     0 80430.7777    0  207 52872.2823 80430.7777  52.1%     -  126s
     0     0 77540.0456    0  269 52872.2823 77540.0456  46.7%     -  160s
H    0     0                    52888.191597 77539.4595  46.6%     -  161s
H    0     0                    52917.706131 77539.4595  46.5%     -  161s
     0     0 76830.0391    0  272 52917.7061 76830.0391  45.2%     -  186s
     0     0 76610.8158    0  271 52917.7061 76610.8158  44.8%     -  197s
     0     0 76589.2848    0  281 52917.7061 76589.2848  44.7%     -  202s
     0     0 76572.6895    0  271 52917.7061 76572.6895  44.7%     -  204s
     0     0 76404.6946    0  271 52917.7061 76404.6946  44.4%     -  211s
     0     0 76355.6068    0  281 52917.7061 76355.6068  44.3%     -  215s
     0     0 76344.8286    0  282 52917.7061 76344.8286  44.3%     -  219s
     0     0 76332.0716    0  290 52917.7061 76332.0716  44.2%     -  223s
     0     0 76319.7088    0  286 52917.7061 76319.7088  44.2%     -  225s
     0     0 76316.8422    0  283 52917.7061 76316.8422  44.2%     -  225s
     0     0 76315.9257    0  282 52917.7061 76315.9257  44.2%     -  226s
H    0     0                    53098.777996 72945.0026  37.4%     -  272s
H    0     0                    53127.246325 72945.0026  37.3%     -  272s
     0     0 72945.0026    0  313 53127.2463 72945.0026  37.3%     -  273s
     0     0 72490.1320    0  291 53127.2463 72490.1320  36.4%     -  296s
     0     0 72265.2330    0  352 53127.2463 72265.2330  36.0%     -  311s
     0     0 72087.8418    0  374 53127.2463 72087.8418  35.7%     -  322s
     0     0 72014.2080    0  391 53127.2463 72014.2080  35.6%     -  330s
     0     0 71979.8024    0  393 53127.2463 71979.8024  35.5%     -  335s
     0     0 71949.8980    0  394 53127.2463 71949.8980  35.4%     -  339s
     0     0 71913.9660    0  393 53127.2463 71913.9660  35.4%     -  343s
     0     0 71898.3095    0  386 53127.2463 71898.3095  35.3%     -  345s
     0     0 71865.8951    0  390 53127.2463 71865.8951  35.3%     -  349s
     0     0 71855.9049    0  395 53127.2463 71855.9049  35.3%     -  351s
     0     0 71851.2299    0  394 53127.2463 71851.2299  35.2%     -  352s
     0     0 71843.8202    0  402 53127.2463 71843.8202  35.2%     -  354s
     0     0 71841.3228    0  393 53127.2463 71841.3228  35.2%     -  354s
     0     0 71833.1771    0  395 53127.2463 71833.1771  35.2%     -  356s
     0     0 71818.5875    0  402 53127.2463 71818.5875  35.2%     -  359s
     0     0 71815.0368    0  400 53127.2463 71815.0368  35.2%     -  360s
     0     0 71814.2149    0  404 53127.2463 71814.2149  35.2%     -  360s
     0     0 70946.1176    0  362 53127.2463 70946.1176  33.5%     -  391s
     0     0 70754.9764    0  359 53127.2463 70754.9764  33.2%     -  403s
     0     0 70640.4456    0  380 53127.2463 70640.4456  33.0%     -  411s
     0     0 70586.7295    0  391 53127.2463 70586.7295  32.9%     -  418s
     0     0 70576.5098    0  401 53127.2463 70576.5098  32.8%     -  421s
     0     0 70533.9012    0  398 53127.2463 70533.9012  32.8%     -  427s
     0     0 70504.9071    0  396 53127.2463 70504.9071  32.7%     -  432s
     0     0 70475.3268    0  388 53127.2463 70475.3268  32.7%     -  437s
     0     0 70469.7131    0  384 53127.2463 70469.7131  32.6%     -  438s
     0     0 70463.1184    0  396 53127.2463 70463.1184  32.6%     -  440s
     0     0 70459.7489    0  405 53127.2463 70459.7489  32.6%     -  442s
     0     0 70440.3553    0  405 53127.2463 70440.3553  32.6%     -  445s
     0     0 70423.5715    0  398 53127.2463 70423.5715  32.6%     -  448s
     0     0 70418.3385    0  397 53127.2463 70418.3385  32.5%     -  449s
     0     0 70414.9774    0  393 53127.2463 70414.9774  32.5%     -  452s
     0     0 70398.6880    0  405 53127.2463 70398.6880  32.5%     -  455s
     0     0 70396.7362    0  388 53127.2463 70396.7362  32.5%     -  456s
     0     0 70131.8230    0  361 53127.2463 70131.8230  32.0%     -  477s
H    0     0                    53160.060193 70130.2173  31.9%     -  477s
H    0     0                    53192.212750 70130.2173  31.8%     -  477s
     0     0 70064.2227    0  393 53192.2128 70064.2227  31.7%     -  486s
     0     0 70051.6861    0  409 53192.2128 70051.6861  31.7%     -  491s
     0     0 70047.6302    0  426 53192.2128 70047.6302  31.7%     -  492s
     0     0 70044.6379    0  424 53192.2128 70044.6379  31.7%     -  493s
     0     0 70038.4973    0  426 53192.2128 70038.4973  31.7%     -  495s
     0     0 70035.2591    0  430 53192.2128 70035.2591  31.7%     -  496s
     0     0 70034.8263    0  429 53192.2128 70034.8263  31.7%     -  497s
     0     0 69945.4487    0  340 53192.2128 69945.4487  31.5%     -  506s
H    0     0                    53378.473362 69944.8517  31.0%     -  507s
     0     0 69891.2580    0  387 53378.4734 69891.2580  30.9%     -  514s
     0     0 69878.2644    0  359 53378.4734 69878.2644  30.9%     -  517s
     0     0 69871.3422    0  410 53378.4734 69871.3422  30.9%     -  519s
     0     0 69869.0906    0  359 53378.4734 69869.0906  30.9%     -  520s
     0     0 69784.6116    0  397 53378.4734 69784.6116  30.7%     -  530s
     0     0 69742.7445    0  399 53378.4734 69742.7445  30.7%     -  540s
     0     0 69733.4489    0  406 53378.4734 69733.4489  30.6%     -  544s
     0     0 69728.3550    0  410 53378.4734 69728.3550  30.6%     -  547s
     0     0 69725.6479    0  427 53378.4734 69725.6479  30.6%     -  549s
     0     0 69697.5712    0  414 53378.4734 69697.5712  30.6%     -  556s
     0     0 69683.9107    0  408 53378.4734 69683.9107  30.5%     -  559s
     0     0 69678.2602    0  397 53378.4734 69678.2602  30.5%     -  561s
     0     0 69676.8072    0  403 53378.4734 69676.8072  30.5%     -  563s
     0     0 69662.5045    0  414 53378.4734 69662.5045  30.5%     -  568s
     0     0 69658.1109    0  409 53378.4734 69658.1109  30.5%     -  571s
     0     0 69657.0946    0  405 53378.4734 69657.0946  30.5%     -  572s
     0     0 69639.2040    0  417 53378.4734 69639.2040  30.5%     -  579s
     0     0 69632.6156    0  428 53378.4734 69632.6156  30.5%     -  584s
     0     0 69630.7113    0  419 53378.4734 69630.7113  30.4%     -  585s
     0     0 69594.1873    0  406 53378.4734 69594.1873  30.4%     -  594s
H    0     0                    53424.979081 69592.5884  30.3%     -  595s
     0     0 69580.7040    0  424 53424.9791 69580.7040  30.2%     -  598s
     0     0 69572.7267    0  412 53424.9791 69572.7267  30.2%     -  601s
     0     0 69571.6886    0  420 53424.9791 69571.6886  30.2%     -  602s
     0     0 69569.6776    0  426 53424.9791 69569.6776  30.2%     -  606s
     0     0 69568.8428    0  424 53424.9791 69568.8428  30.2%     -  608s
     0     0 69568.5963    0  423 53424.9791 69568.5963  30.2%     -  610s
     0     0 69568.3967    0  423 53424.9791 69568.3967  30.2%     -  612s
     0     2 69568.3074    0  423 53424.9791 69568.3074  30.2%     -  741s
     1     3 69195.9761    1  337 53424.9791 69568.3074  30.2%  9952  756s
     2     5 69012.9583    2  393 53424.9791 69568.3074  30.2%  8308  768s
     4     9 68958.2935    3  381 53424.9791 69322.7197  29.8%  7718  788s
     8    17 68278.9231    3  344 53424.9791 69322.7197  29.8%  9211  826s
    16    33 68067.9440    4  398 53424.9791 69113.2781  29.4% 11796  854s
    32    48 67141.2086    4  370 53424.9791 69113.2545  29.4% 17008 2484s
    47    79 66729.3250    7  393 53424.9791 69113.2545  29.4% 24954 2539s
H   50    79                    53469.994610 69113.2545  29.3% 23980 2539s
    78   170 66728.9953    8  393 53469.9946 68833.8968  28.7% 18435 2660s
   169   277 66269.8646   10  363 53469.9946 68833.8968  28.7% 11220 2701s
H  176   277                    53613.947621 68833.8968  28.4% 10911 2701s
H  241   277                    53701.800766 68833.8968  28.2%  9231 2701s
   276   364 66549.8483   11  361 53701.8008 68833.8968  28.2%  8651 2732s
   363   396 66186.4240   13  310 53701.8008 68833.8968  28.2%  7862 2757s
   395   431 65901.0141   13  363 53701.8008 68833.8968  28.2%  7759 2787s
H  410   431                    53823.273178 68833.8968  27.9%  7689 2787s
H  419   431                    53966.940585 68833.8968  27.5%  7756 2787s
   430   461 65860.4522   14  354 53966.9406 68833.8968  27.5%  7726 2812s
   460   499 65817.4208   15  307 53966.9406 68833.8968  27.5%  7575 2839s
   498   538 65556.7969   16  295 53966.9406 68833.8968  27.5%  7411 2861s
   537   572 65387.7798   16  341 53966.9406 68833.8968  27.5%  7430 2886s
   571   606 65523.3193   17  294 53966.9406 68833.8968  27.5%  7317 2913s
H  583   606                    54024.791019 68833.8968  27.4%  7377 2913s
   605   702 65404.3979   17  293 54024.7910 68833.8968  27.4%  7543 2944s
H  696   702                    54050.647917 68833.8968  27.4%  7111 2944s
   701   806 61918.8226   18  297 54050.6479 68833.8968  27.4%  7091 2971s
   809   917 64580.2969   19  294 54050.6479 68833.8968  27.4%  6561 2995s
   926  1008 64341.1339   20  304 54050.6479 68833.8968  27.4%  5996 3019s
  1029  1114 63794.8075   20  280 54050.6479 68833.8968  27.4%  5667 3046s
  1159  1173 64168.2715   21  306 54050.6479 68833.8968  27.4%  5257 3071s
  1288  1221 63305.1137   22  261 54050.6479 68833.1834  27.3%  4954 3099s
  1406  1259 62289.7325   23  229 54050.6479 68833.1834  27.3%  4755 3131s
  1498  1290 61665.5712   23  237 54050.6479 68833.1834  27.3%  4666 3161s
  1563  1324 61911.8664   24  247 54050.6479 68833.1834  27.3%  4629 3197s
  1619  1361 61075.9613   25  245 54050.6479 68833.1834  27.3%  4656 3231s
  1676  1437 60041.7771   26  251 54050.6479 68833.1834  27.3%  4680 3263s
  1774  1464 59080.3842   27  214 54050.6479 68833.1834  27.3%  4627 3294s
  1809  1484 59261.6740   27  217 54050.6479 68833.1834  27.3%  4666 3319s
  1851  1505 59213.3518   28  211 54050.6479 68833.1834  27.3%  4658 3351s
  1884  1532 58392.6399   29  221 54050.6479 68833.1834  27.3%  4652 3382s
  1919  1561 58329.7542   30  214 54050.6479 68833.1834  27.3%  4668 3416s
  1952  1609 58164.6122   31  215 54050.6479 68538.8084  26.8%  4671 3449s
  2004  1679 57476.4755   32  205 54050.6479 68538.8084  26.8%  4631 3485s
  2120  1756 57024.0797   36  189 54050.6479 68538.8084  26.8%  4489 3520s
  2269  1832 56391.7393   43  159 54050.6479 68538.8084  26.8%  4334 3559s
  2388  1943 55460.7249   55  127 54050.6479 68538.8084  26.8%  4272 3600s

Cutting planes:
  Learned: 2
  Gomory: 37
  Implied bound: 201
  MIR: 2309
  Flow cover: 2195
  RLT: 61
  Relax-and-lift: 601

Explored 2537 nodes (11103093 simplex iterations) in 3600.05 seconds (4771.62 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 54050.6 54024.8 53966.9 ... 53192.2

Time limit reached
Best objective 5.405064791734e+04, best bound 6.853880844660e+04, gap 26.8048%
  WARNING: Time limit reached. Using best solution found (gap: 26.80%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 54050.65, θ = 216078.61
  Upper Bound (UB) = 54050.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216078.61
  [DEBUG]   ✓ Scenario 0: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216078.61 ≤ Q = 216078.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216078.61 ≤ Q = 216078.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216078.61 ≤ Q = 216078.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3f72be7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfc08d419
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.396733e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 6819889.7411
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6819609.9884

Root relaxation: objective -1.929698e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -192969.82    0  125 6819609.99 -192969.82   103%     -    0s
H    0     0                    -159978.1666 -192969.82  20.6%     -    0s
H    0     0                    -160257.9193 -192969.82  20.4%     -    0s
     0     0 -170435.79    0   93 -160257.92 -170435.79  6.35%     -    0s
H    0     0                    -167801.5071 -170397.76  1.55%     -    0s
H    0     0                    -168081.2598 -170397.76  1.38%     -    0s
H    0     0                    -168280.0011 -170397.76  1.26%     -    0s
H    0     0                    -168559.7538 -170397.76  1.09%     -    0s
     0     0 -169520.18    0   67 -168559.75 -169520.18  0.57%     -    0s
H    0     0                    -168572.8434 -169468.97  0.53%     -    0s
     0     0 -168960.46    0   54 -168572.84 -168960.46  0.23%     -    0s
     0     0 -168955.89    0   53 -168572.84 -168955.89  0.23%     -    0s
H    0     0                    -168573.6544 -168931.94  0.21%     -    0s
     0     0 -168931.94    0   52 -168573.65 -168931.94  0.21%     -    0s
     0     0 -168778.61    0   26 -168573.65 -168778.61  0.12%     -    0s
     0     0 -168759.29    0   14 -168573.65 -168759.29  0.11%     -    0s
     0     0 -168756.53    0   13 -168573.65 -168756.53  0.11%     -    0s
     0     0 -168753.15    0   10 -168573.65 -168753.15  0.11%     -    0s
H    0     0                    -168577.9554 -168753.15  0.10%     -    0s
     0     0 -168747.38    0   11 -168577.96 -168747.38  0.10%     -    0s
     0     0 -168666.94    0    9 -168577.96 -168666.94  0.05%     -    0s
     0     0 -168666.94    0   19 -168577.96 -168666.94  0.05%     -    0s
H    0     0                    -168612.3664 -168666.94  0.03%     -    0s
     0     0 -168633.54    0    3 -168612.37 -168633.54  0.01%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 8
  Flow cover: 10
  Relax-and-lift: 7

Explored 1 nodes (732 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -168612 -168578 -168574 ... 6.81989e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.686123664399e+05, best bound -1.686274209867e+05, gap 0.0089%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 207147.70
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -168612.37
  [DEBUG]   S×d_nominal = 375760.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 375760.07 + -168612.37 = 207147.70
  [DEBUG]   Current θ from Master = 216078.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8930.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45119.73
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 3886.5402, Absolute Gap = 3886.5402, Relative Gap = 0.071906
  Not converged yet (gap = 3886.54 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0x9c727480
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 3.63s
Presolved: 99580 rows, 42487 columns, 602280 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -317681.5805
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.585e+06
 Factor NZ  : 1.009e+07 (roughly 140 MB of memory)
 Factor Ops : 1.871e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93571267e+07  1.97545190e+08  1.43e+05 1.59e+01  9.39e+04     6s
   1  -1.49188220e+07  1.83364240e+08  1.03e+05 1.01e+02  6.68e+04     6s
   2  -4.97813132e+06  1.45861010e+08  3.41e+04 4.49e+01  2.35e+04     6s
   3  -1.26563051e+06  1.02500324e+08  4.04e+03 9.15e-01  3.21e+03     6s
   4  -7.20481362e+05  5.73675320e+07  5.27e+02 9.08e-02  6.32e+02     6s
   5  -6.43086865e+05  3.47040773e+07  2.46e+02 4.46e-02  3.25e+02     6s
   6  -3.43548742e+05  2.29145836e+07  9.42e+01 1.71e-02  1.72e+02     6s
   7  -3.03624072e+05  1.83238005e+07  6.83e+01 1.31e-02  1.32e+02     6s
   8  -1.79618291e+05  1.12303609e+07  2.78e+01 7.15e-03  7.18e+01     6s
   9  -1.08040760e+05  6.54244522e+06  1.23e+01 4.16e-03  3.92e+01     6s
  10  -7.08778273e+04  3.91739734e+06  5.38e+00 2.38e-03  2.27e+01     6s
  11  -1.38140331e+04  9.75397015e+05  1.24e+00 3.15e-04  5.48e+00     6s
  12  -6.22593751e+03  4.84328975e+05  1.06e+00 5.45e-04  2.72e+00     7s
  13   6.22689629e+03  3.15697546e+05  8.10e-01 5.48e-04  1.71e+00     7s
  14   1.61384176e+04  2.65297490e+05  6.44e-01 1.24e-03  1.38e+00     7s
  15   2.89424939e+04  2.11662046e+05  4.72e-01 1.02e-03  1.01e+00     7s
  16   3.99127181e+04  1.62194930e+05  3.67e-01 2.12e-03  6.74e-01     7s
  17   4.87397407e+04  1.46881563e+05  2.83e-01 1.50e-03  5.41e-01     7s
  18   5.41623889e+04  1.34470901e+05  2.36e-01 1.70e-03  4.42e-01     7s
  19   5.83314181e+04  1.24511925e+05  2.01e-01 1.87e-03  3.64e-01     7s
  20   6.34008606e+04  1.15610298e+05  1.61e-01 1.71e-03  2.87e-01     7s
  21   6.67270191e+04  1.12135586e+05  1.36e-01 1.70e-03  2.50e-01     7s
  22   7.04949047e+04  1.07765928e+05  1.08e-01 1.37e-03  2.05e-01     7s
  23   7.18794384e+04  1.00542551e+05  9.74e-02 1.31e-03  1.58e-01     7s
  24   7.47099154e+04  9.79742278e+04  7.74e-02 1.18e-03  1.28e-01     8s
  25   7.71290425e+04  9.63818970e+04  6.09e-02 1.40e-03  1.06e-01     8s
  26   7.95413819e+04  9.54561853e+04  4.57e-02 1.15e-03  8.76e-02     8s
  27   8.07779324e+04  9.26424413e+04  3.79e-02 9.21e-04  6.53e-02     8s
  28   8.23915245e+04  9.13358446e+04  2.83e-02 6.83e-04  4.92e-02     8s
  29   8.36962572e+04  9.06065300e+04  2.06e-02 5.58e-04  3.80e-02     8s
  30   8.46585660e+04  8.94798689e+04  1.52e-02 3.58e-04  2.65e-02     8s
  31   8.52073462e+04  8.92199969e+04  1.21e-02 3.09e-04  2.21e-02     8s
  32   8.58335559e+04  8.89174791e+04  8.66e-03 2.53e-04  1.70e-02     8s
  33   8.62086381e+04  8.83095978e+04  6.62e-03 1.44e-04  1.16e-02     8s
  34   8.64600095e+04  8.81383558e+04  5.29e-03 1.12e-04  9.24e-03     9s
  35   8.65640306e+04  8.80334021e+04  4.74e-03 9.29e-05  8.09e-03     9s
  36   8.66278373e+04  8.79456571e+04  4.41e-03 7.68e-05  7.25e-03     9s
  37   8.67705799e+04  8.78736133e+04  3.71e-03 6.37e-05  6.07e-03     9s
  38   8.67895807e+04  8.78641525e+04  3.62e-03 6.20e-05  5.92e-03     9s
  39   8.70459406e+04  8.77524462e+04  2.29e-03 4.67e-05  3.89e-03     9s
  40   8.71294215e+04  8.77347305e+04  1.88e-03 4.77e-05  3.33e-03     9s
  41   8.72502796e+04  8.76498425e+04  1.30e-03 2.83e-05  2.20e-03     9s
  42   8.72729653e+04  8.76381962e+04  1.19e-03 2.58e-05  2.01e-03    10s
  43   8.72909307e+04  8.76035661e+04  1.10e-03 1.82e-05  1.72e-03    10s
  44   8.73268734e+04  8.75922532e+04  9.16e-04 1.64e-05  1.46e-03    10s
  45   8.73733560e+04  8.75624266e+04  6.94e-04 9.39e-06  1.04e-03    10s
  46   8.74073729e+04  8.75549794e+04  5.25e-04 7.16e-06  8.13e-04    10s
  47   8.74255105e+04  8.75448381e+04  4.35e-04 5.36e-06  6.57e-04    10s
  48   8.74555365e+04  8.75299414e+04  2.94e-04 2.23e-06  4.10e-04    10s
  49   8.74884471e+04  8.75223125e+04  1.34e-04 2.29e-05  1.87e-04    10s
  50   8.74978381e+04  8.75210684e+04  9.07e-05 1.64e-05  1.28e-04    11s
  51   8.75097375e+04  8.75192692e+04  3.53e-05 6.98e-06  5.25e-05    11s
  52   8.75147674e+04  8.75188888e+04  1.19e-05 5.03e-06  2.27e-05    11s
  53   8.75175856e+04  8.75178943e+04  6.01e-07 4.53e-07  1.70e-06    11s
  54   8.75177579e+04  8.75177596e+04  3.91e-09 4.93e-08  9.72e-09    11s
  55   8.75177593e+04  8.75177593e+04  5.00e-11 1.03e-11  8.45e-13    11s

Barrier solved model in 55 iterations and 10.97 seconds (9.48 work units)
Optimal objective 8.75177593e+04


Root crossover log...

   86867 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    1430 PPushes remaining with PInf 8.7825201e-08                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.9179905e-11     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31498    8.7517759e+04   0.000000e+00   0.000000e+00     13s
   31498    8.7517759e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 8.751776e+04, 31498 iterations, 8.56 seconds (9.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87517.7593    0  198 -203987.28 87517.7593   143%     -   13s
H    0     0                    -196577.4378 87517.7593   145%     -   13s
H    0     0                    -153357.6009 87517.7593   157%     -   14s
H    0     0                    -152696.4216 87517.7593   157%     -   14s
H    0     0                    -144136.9263 87517.7593   161%     -   14s
H    0     0                    -133468.3906 87517.7593   166%     -   14s
H    0     0                    -132929.8741 87517.7593   166%     -   14s
H    0     0                    -33025.57798 87517.7593   365%     -   14s
H    0     0                    46431.685299 87517.7593  88.5%     -   15s
H    0     0                    47962.577850 87517.7593  82.5%     -   16s
H    0     0                    49159.273700 87517.7593  78.0%     -   16s
H    0     0                    50362.372209 87517.7593  73.8%     -   16s
H    0     0                    51153.708456 87517.7593  71.1%     -   16s
H    0     0                    51785.043391 87517.7593  69.0%     -   16s
H    0     0                    52130.895526 87517.7593  67.9%     -   16s
H    0     0                    52425.716245 87517.7593  66.9%     -   16s
H    0     0                    52571.672006 87517.7593  66.5%     -   18s
H    0     0                    52656.369325 87517.7593  66.2%     -   18s
H    0     0                    52712.786102 81389.9315  54.4%     -   56s
H    0     0                    52896.452611 81389.9315  53.9%     -   56s
     0     0 81389.9315    0  195 52896.4526 81389.9315  53.9%     -   58s
     0     0 80745.0780    0  217 52896.4526 80745.0780  52.6%     -   88s
     0     0 80743.2930    0  219 52896.4526 80743.2930  52.6%     -  106s
     0     0 80743.2930    0  190 52896.4526 80743.2930  52.6%     -  110s
     0     0 80743.2930    0  190 52896.4526 80743.2930  52.6%     -  111s
H    0     0                    52979.199510 77877.3837  47.0%     -  187s
     0     0 77877.3837    0  271 52979.1995 77877.3837  47.0%     -  187s
     0     0 77110.8631    0  272 52979.1995 77110.8631  45.5%     -  224s
     0     0 76757.0655    0  277 52979.1995 76757.0655  44.9%     -  250s
     0     0 76688.1851    0  307 52979.1995 76688.1851  44.8%     -  265s
     0     0 76633.6932    0  299 52979.1995 76633.6932  44.6%     -  271s
     0     0 76600.0278    0  305 52979.1995 76600.0278  44.6%     -  279s
     0     0 76562.5318    0  290 52979.1995 76562.5318  44.5%     -  292s
     0     0 76530.1774    0  305 52979.1995 76530.1774  44.5%     -  301s
     0     0 76504.5124    0  287 52979.1995 76504.5124  44.4%     -  306s
     0     0 76496.2280    0  289 52979.1995 76496.2280  44.4%     -  310s
     0     0 76495.3453    0  290 52979.1995 76495.3453  44.4%     -  311s
H    0     0                    53208.887542 73404.3440  38.0%     -  392s
     0     0 73404.3440    0  301 53208.8875 73404.3440  38.0%     -  392s
H    0     0                    53212.723655 72796.5696  36.8%     -  438s
     0     0 72796.5696    0  335 53212.7237 72796.5696  36.8%     -  438s
H    0     0                    53252.666007 72642.1977  36.4%     -  460s
H    0     0                    53283.871188 72642.1977  36.3%     -  460s
H    0     0                    53369.417417 72642.1977  36.1%     -  460s
     0     0 72642.1977    0  381 53369.4174 72642.1977  36.1%     -  460s
H    0     0                    53397.665168 72513.0757  35.8%     -  482s
H    0     0                    53433.876804 72513.0757  35.7%     -  482s
     0     0 72513.0757    0  380 53433.8768 72513.0757  35.7%     -  482s
H    0     0                    53460.160330 72426.7742  35.5%     -  496s
     0     0 72426.7742    0  379 53460.1603 72426.7742  35.5%     -  496s
     0     0 72394.6158    0  369 53460.1603 72394.6158  35.4%     -  504s
     0     0 72299.2861    0  376 53460.1603 72299.2861  35.2%     -  516s
     0     0 72277.9051    0  382 53460.1603 72277.9051  35.2%     -  522s
     0     0 72250.8200    0  398 53460.1603 72250.8200  35.1%     -  530s
     0     0 72235.4091    0  398 53460.1603 72235.4091  35.1%     -  536s
     0     0 72229.4255    0  400 53460.1603 72229.4255  35.1%     -  539s
     0     0 72216.1165    0  406 53460.1603 72216.1165  35.1%     -  543s
     0     0 72210.7713    0  402 53460.1603 72210.7713  35.1%     -  547s
     0     0 72162.7196    0  407 53460.1603 72162.7196  35.0%     -  555s
     0     0 72111.2027    0  396 53460.1603 72111.2027  34.9%     -  564s
     0     0 72093.5122    0  406 53460.1603 72093.5122  34.9%     -  570s
     0     0 72085.6976    0  403 53460.1603 72085.6976  34.8%     -  573s
     0     0 72084.2427    0  401 53460.1603 72084.2427  34.8%     -  574s
     0     0 70528.8225    0  374 53460.1603 70528.8225  31.9%     -  626s
     0     0 70269.5544    0  372 53460.1603 70269.5544  31.4%     -  651s
     0     0 70208.8031    0  344 53460.1603 70208.8031  31.3%     -  662s
     0     0 70175.8957    0  396 53460.1603 70175.8957  31.3%     -  672s
     0     0 70160.2392    0  373 53460.1603 70160.2392  31.2%     -  677s
     0     0 70151.7868    0  349 53460.1603 70151.7868  31.2%     -  681s
     0     0 70148.3103    0  339 53460.1603 70148.3103  31.2%     -  684s
     0     0 70126.4035    0  391 53460.1603 70126.4035  31.2%     -  690s
     0     0 70110.3133    0  388 53460.1603 70110.3133  31.1%     -  695s
     0     0 70107.8880    0  397 53460.1603 70107.8880  31.1%     -  697s
     0     0 69940.9737    0  413 53460.1603 69940.9737  30.8%     -  719s
H    0     0                    53505.744981 69940.6945  30.7%     -  720s
     0     0 69862.9600    0  421 53505.7450 69862.9600  30.6%     -  732s
     0     0 69845.7734    0  400 53505.7450 69845.7734  30.5%     -  740s
     0     0 69839.6445    0  423 53505.7450 69839.6445  30.5%     -  744s
     0     0 69835.7549    0  434 53505.7450 69835.7549  30.5%     -  747s
     0     0 69832.5674    0  422 53505.7450 69832.5674  30.5%     -  749s
     0     0 69828.0641    0  437 53505.7450 69828.0641  30.5%     -  752s
     0     0 69823.6590    0  428 53505.7450 69823.6590  30.5%     -  754s
     0     0 69822.0267    0  430 53505.7450 69822.0267  30.5%     -  757s
     0     0 69757.8595    0  418 53505.7450 69757.8595  30.4%     -  772s
     0     0 69721.1832    0  401 53505.7450 69721.1832  30.3%     -  786s
     0     0 69717.4001    0  412 53505.7450 69717.4001  30.3%     -  788s
     0     0 69715.5769    0  414 53505.7450 69715.5769  30.3%     -  790s
     0     0 69668.2405    0  428 53505.7450 69668.2405  30.2%     -  805s
     0     0 69644.1480    0  430 53505.7450 69644.1480  30.2%     -  815s
     0     0 69637.6004    0  439 53505.7450 69637.6004  30.1%     -  820s
     0     0 69636.4221    0  435 53505.7450 69636.4221  30.1%     -  822s
     0     0 69614.0562    0  414 53505.7450 69614.0562  30.1%     -  836s
     0     0 69600.7940    0  410 53505.7450 69600.7940  30.1%     -  853s
     0     0 69592.9132    0  421 53505.7450 69592.9132  30.1%     -  856s
     0     0 69591.3761    0  418 53505.7450 69591.3761  30.1%     -  857s
     0     0 69557.8769    0  424 53505.7450 69557.8769  30.0%     -  870s
     0     0 69545.7900    0  364 53505.7450 69545.7900  30.0%     -  878s
     0     0 69540.3818    0  427 53505.7450 69540.3818  30.0%     -  884s
     0     0 69538.2482    0  432 53505.7450 69538.2482  30.0%     -  887s
     0     0 69534.8769    0  375 53505.7450 69534.8769  30.0%     -  891s
H    0     0                    53524.421651 69534.7963  29.9%     -  897s
H    0     0                    53540.657361 69534.7963  29.9%     -  898s
     0     0 69532.9579    0  372 53540.6574 69532.9579  29.9%     -  901s
     0     0 69527.5171    0  425 53540.6574 69527.5171  29.9%     -  906s
     0     0 69525.9816    0  427 53540.6574 69525.9816  29.9%     -  909s
     0     0 69524.2627    0  364 53540.6574 69524.2627  29.9%     -  912s
     0     0 69524.0479    0  364 53540.6574 69524.0479  29.9%     -  915s
H    0     0                    53544.754813 69524.0479  29.8%     - 1064s
H    0     0                    53644.671075 69524.0479  29.6%     - 1065s
     0     2 69524.0479    0  364 53644.6711 69524.0479  29.6%     - 1094s
     1     4 69256.1227    1  351 53644.6711 69524.0479  29.6% 18985 1121s
     3     8 69081.9874    2  350 53644.6711 69254.5592  29.1% 14435 1141s
     7    15 68580.9478    3  382 53644.6711 69081.5712  28.8% 13212 1175s
    14    30 68385.2610    4  342 53644.6711 69080.5082  28.8% 15004 1208s
    29    45 68394.5341    5  414 53644.6711 68674.4964  28.0% 21764 2641s
    44    76 68106.5247    6  356 53644.6711 68674.4964  28.0% 24496 2723s
H   50    76                    53802.795950 68674.4964  27.6% 23022 2723s
    75   108 68098.7681    7  345 53802.7959 68567.2472  27.4% 20246 2791s
H  107   193                    53837.092169 68492.7616  27.2% 18829 2851s
   192   271 67630.1928    9  341 53837.0922 68492.7616  27.2% 13368 2901s
   270   315 67107.8961    9  305 53837.0922 68492.7616  27.2% 11539 2945s
   314   378 67228.2547    9  329 53837.0922 68492.7616  27.2% 10881 2984s
   377   447 66523.9979   10  314 53837.0922 68492.7616  27.2% 10094 3019s
   448   520 66334.1637   11  312 53837.0922 68492.7616  27.2%  9691 3051s
   523   605 65769.3180   13  324 53837.0922 68492.7616  27.2%  9052 3084s
   608   636 65545.3214   15  303 53837.0922 68492.7616  27.2%  8337 3105s
   639   674 65314.8459   16  309 53837.0922 68492.7616  27.2%  8189 3131s
   679   703 65163.6017   17  316 53837.0922 68492.7616  27.2%  8037 3159s
   713   741 64885.9837   18  292 53837.0922 68492.7616  27.2%  7941 3182s
   753   782 64710.5402   19  300 53837.0922 68492.7616  27.2%  7785 3210s
   796   819 65709.9147   18  255 53837.0922 68492.7616  27.2%  7605 3238s
   839   880 64520.2013   20  293 53837.0922 68492.7616  27.2%  7467 3262s
   900   942 64498.1276   21  283 53837.0922 68492.7616  27.2%  7166 3290s
   970  1021 65327.6872   19  264 53837.0922 68492.7616  27.2%  6908 3319s
  1060  1078 65101.1429   21  292 53837.0922 68492.7616  27.2%  6559 3350s
  1143  1159 58354.8420   21  282 53837.0922 68492.7616  27.2%  6346 3383s
  1244  1210 57091.9357   22  258 53837.0922 68492.7616  27.2%  6066 3419s
  1315  1259 55867.3561   23  258 53837.0922 68492.7616  27.2%  6067 3456s
  1401  1344 55298.1861   24  270 53837.0922 68492.7616  27.2%  6018 3493s
  1533  1400 55249.9535   25  266 53837.0922 68492.7616  27.2%  5763 3536s
  1649  1468 54721.2013   26  267 53837.0922 68492.7616  27.2%  5609 3576s
  1762  1502 54615.9959   27  259 53837.0922 68492.7616  27.2%  5517 3600s

Cutting planes:
  Gomory: 25
  Implied bound: 231
  MIR: 2460
  Flow cover: 2253
  RLT: 104
  Relax-and-lift: 542

Explored 1848 nodes (10549441 simplex iterations) in 3600.09 seconds (4664.46 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53837.1 53802.8 53644.7 ... 53397.7

Time limit reached
Best objective 5.383709216946e+04, best bound 6.849276163081e+04, gap 27.2223%
  WARNING: Time limit reached. Using best solution found (gap: 27.22%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 53837.09, θ = 216136.90
  Upper Bound (UB) = 53837.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216136.90
  [DEBUG]   ✓ Scenario 0: θ = 216136.90 ≤ Q = 217909.70 (slack: 1772.80)
  [DEBUG]   ✓ Scenario 1: θ = 216136.90 ≤ Q = 216136.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216136.90 ≤ Q = 216136.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216136.90 ≤ Q = 216559.85 (slack: 422.95)
  [DEBUG]   ✓ Scenario 4: θ = 216136.90 ≤ Q = 216136.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216136.90 ≤ Q = 216136.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216136.90 ≤ Q = 216136.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216136.90 ≤ Q = 216136.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216136.90 ≤ Q = 216136.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216136.90 ≤ Q = 216512.51 (slack: 375.61)
  [DEBUG]   ✓ Scenario 10: θ = 216136.90 ≤ Q = 216136.90 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x727779b8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x727779b8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.385522e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 6868356.2025
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6868076.4498

Root relaxation: objective -1.933987e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -193398.67    0  131 6868076.45 -193398.67   103%     -    0s
H    0     0                    -162673.2182 -193398.67  18.9%     -    0s
H    0     0                    -162952.9709 -193398.67  18.7%     -    0s
     0     0 -173227.24    0  111 -162952.97 -173227.24  6.31%     -    0s
H    0     0                    -168970.6802 -173109.95  2.45%     -    0s
H    0     0                    -169250.4329 -173109.95  2.28%     -    0s
H    0     0                    -170840.9593 -173109.95  1.33%     -    0s
H    0     0                    -171120.7120 -173109.95  1.16%     -    0s
     0     0 -172943.65    0   92 -171120.71 -172943.65  1.07%     -    0s
     0     0 -172061.20    0   94 -171120.71 -172061.20  0.55%     -    0s
H    0     0                    -171138.3563 -172049.19  0.53%     -    0s
     0     0 -172005.74    0   94 -171138.36 -172005.74  0.51%     -    0s
     0     0 -171745.53    0   54 -171138.36 -171745.53  0.35%     -    0s
     0     0 -171693.46    0   54 -171138.36 -171693.46  0.32%     -    0s
     0     0 -171693.46    0   54 -171138.36 -171693.46  0.32%     -    0s
     0     0 -171498.87    0   32 -171138.36 -171498.87  0.21%     -    0s
H    0     0                    -171169.8820 -171491.78  0.19%     -    0s
     0     0 -171488.62    0   35 -171169.88 -171488.62  0.19%     -    0s
     0     0 -171406.76    0   14 -171169.88 -171406.76  0.14%     -    0s
H    0     0                    -171231.2775 -171403.90  0.10%     -    0s
     0     0 -171349.09    0    9 -171231.28 -171349.09  0.07%     -    0s
     0     0 -171335.69    0    8 -171231.28 -171335.69  0.06%     -    0s
     0     0 -171302.12    0    7 -171231.28 -171302.12  0.04%     -    0s
     0     0 -171286.46    0    8 -171231.28 -171286.46  0.03%     -    0s
     0     0 -171258.62    0    8 -171231.28 -171258.62  0.02%     -    0s
H    0     0                    -171239.3463 -171258.62  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 1
  Flow cover: 5
  Relax-and-lift: 3

Explored 1 nodes (752 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -171239 -171231 -171170 ... 6.86836e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.712393463129e+05, best bound -1.712548444957e+05, gap 0.0091%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 204671.55
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -171239.35
  [DEBUG]   S×d_nominal = 375910.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 375910.89 + -171239.35 = 204671.55
  [DEBUG]   Current θ from Master = 216136.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11465.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 42371.74
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 3672.9844, Absolute Gap = 3672.9844, Relative Gap = 0.068224
  Not converged yet (gap = 3672.98 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524543 nonzeros
Model fingerprint: 0xe590f0b2
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 76356 rows and 30996 columns
Presolve time: 3.44s
Presolved: 108507 rows, 46144 columns, 653627 nonzeros
Variable types: 43885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -308120.2725
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 692
 AA' NZ     : 3.542e+06
 Factor NZ  : 8.716e+06 (roughly 130 MB of memory)
 Factor Ops : 1.705e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.00345856e+07  2.13584754e+08  1.48e+05 1.85e+01  9.66e+04     5s
   1  -1.55152457e+07  1.99518372e+08  1.07e+05 1.02e+02  6.86e+04     5s
   2  -4.73836970e+06  1.60860199e+08  3.26e+04 2.05e+01  2.25e+04     6s
   3  -1.21478990e+06  1.14799174e+08  4.67e+03 1.32e+00  3.63e+03     6s
   4  -6.15476919e+05  6.71787813e+07  5.52e+02 2.19e-01  6.71e+02     6s
   5  -5.23374961e+05  3.90945482e+07  2.65e+02 1.10e-01  3.40e+02     6s
   6  -3.76279188e+05  2.68563612e+07  9.15e+01 6.17e-02  1.81e+02     6s
   7  -2.79505651e+05  1.88544209e+07  3.38e+01 4.17e-02  1.10e+02     6s
   8  -1.69433319e+05  1.53484630e+07  1.22e+01 3.31e-02  8.25e+01     6s
   9  -9.27373471e+04  5.50415861e+06  5.23e+00 1.12e-02  2.90e+01     6s
  10  -5.93613647e+04  2.01993019e+06  2.60e+00 3.94e-03  1.06e+01     6s
  11  -1.24936359e+04  1.05420034e+06  1.11e+00 1.87e-03  5.41e+00     6s
  12   5.39868278e+02  5.94795803e+05  8.03e-01 1.00e-03  3.01e+00     6s
  13   1.47441911e+04  3.23072959e+05  5.10e-01 6.58e-04  1.56e+00     7s
  14   2.85167353e+04  2.74449147e+05  3.54e-01 1.13e-03  1.24e+00     7s
  15   3.69318494e+04  2.10745849e+05  2.77e-01 1.25e-03  8.78e-01     7s
  16   4.44446677e+04  1.69429945e+05  2.20e-01 1.48e-03  6.31e-01     7s
  17   4.89777456e+04  1.51073696e+05  1.92e-01 1.58e-03  5.16e-01     7s
  18   5.47625891e+04  1.41919772e+05  1.59e-01 1.65e-03  4.40e-01     7s
  19   6.20066839e+04  1.31579351e+05  1.18e-01 1.59e-03  3.51e-01     7s
  20   6.57455267e+04  1.17378920e+05  9.82e-02 1.57e-03  2.61e-01     7s
  21   6.81640268e+04  1.12156084e+05  8.58e-02 1.58e-03  2.22e-01     7s
  22   7.11828809e+04  1.03471670e+05  7.08e-02 1.53e-03  1.63e-01     7s
  23   7.38545027e+04  1.00287765e+05  5.80e-02 1.77e-03  1.33e-01     7s
  24   7.74923872e+04  9.70246036e+04  4.13e-02 1.44e-03  9.86e-02     8s
  25   7.85493403e+04  9.61852937e+04  3.66e-02 1.50e-03  8.90e-02     8s
  26   8.02815825e+04  9.42527058e+04  2.88e-02 1.59e-03  7.05e-02     8s
  27   8.28798640e+04  9.23107152e+04  1.74e-02 1.13e-03  4.76e-02     8s
  28   8.38531042e+04  9.04634221e+04  1.36e-02 7.07e-04  3.34e-02     8s
  29   8.46977478e+04  9.00811819e+04  1.03e-02 6.15e-04  2.72e-02     8s
  30   8.58619506e+04  8.94248668e+04  5.73e-03 4.59e-04  1.80e-02     8s
  31   8.63604229e+04  8.90626058e+04  3.88e-03 3.71e-04  1.36e-02     8s
  32   8.65917876e+04  8.86461318e+04  3.05e-03 2.73e-04  1.04e-02     8s
  33   8.68551500e+04  8.84115360e+04  2.12e-03 2.18e-04  7.85e-03     9s
  34   8.70070731e+04  8.81346435e+04  1.60e-03 1.49e-04  5.69e-03     9s
  35   8.71992560e+04  8.79083875e+04  9.56e-04 9.29e-05  3.58e-03     9s
  36   8.72353264e+04  8.77978811e+04  8.39e-04 1.02e-04  2.84e-03     9s
  37   8.73392820e+04  8.76973845e+04  5.13e-04 7.40e-05  1.81e-03     9s
  38   8.73921894e+04  8.76494124e+04  3.48e-04 5.90e-05  1.30e-03     9s
  39   8.74659364e+04  8.76026682e+04  1.28e-04 3.80e-05  6.89e-04     9s
  40   8.74876182e+04  8.75608723e+04  6.88e-05 1.79e-05  3.69e-04     9s
  41   8.75034980e+04  8.75262518e+04  2.74e-05 4.68e-06  1.15e-04    10s
  42   8.75090413e+04  8.75219891e+04  1.41e-05 2.73e-06  6.53e-05    10s
  43   8.75125319e+04  8.75199937e+04  6.06e-06 2.05e-06  3.76e-05    10s
  44   8.75149756e+04  8.75186875e+04  1.28e-06 1.67e-06  1.87e-05    10s
  45   8.75155059e+04  8.75162582e+04  3.75e-07 3.25e-07  3.79e-06    10s
  46   8.75157054e+04  8.75157517e+04  1.91e-08 3.00e-08  2.33e-07    10s
  47   8.75157313e+04  8.75157313e+04  1.37e-10 7.23e-09  2.56e-10    10s

Barrier solved model in 47 iterations and 10.34 seconds (8.86 work units)
Optimal objective 8.75157313e+04


Root crossover log...

   94914 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2045 PPushes remaining with PInf 1.1180415e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0107743e-10     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36931    8.7515731e+04   0.000000e+00   0.000000e+00     13s
   36931    8.7515731e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.751573e+04, 36931 iterations, 8.64 seconds (9.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87515.7313    0  198 -203987.28 87515.7313   143%     -   13s
H    0     0                    -201272.8287 87515.7313   143%     -   13s
H    0     0                    -154418.5880 87515.7313   157%     -   14s
H    0     0                    -115062.4962 87515.7313   176%     -   14s
H    0     0                    -101805.5213 87515.7313   186%     -   14s
H    0     0                    -56071.30515 87515.7313   256%     -   14s
H    0     0                    42590.944124 87515.7313   105%     -   15s
H    0     0                    44410.773001 87515.7313  97.1%     -   15s
H    0     0                    49132.638484 87515.7313  78.1%     -   16s
H    0     0                    49145.927423 87515.7313  78.1%     -   16s
H    0     0                    49270.777612 87515.7313  77.6%     -   16s
H    0     0                    49335.760434 87515.7313  77.4%     -   16s
H    0     0                    50762.847298 87515.7313  72.4%     -   16s
H    0     0                    51289.903001 87515.7313  70.6%     -   16s
H    0     0                    52154.649857 87515.7313  67.8%     -   16s
H    0     0                    52595.691938 87515.7313  66.4%     -   16s
H    0     0                    52642.655491 81682.9585  55.2%     -   72s
H    0     0                    52646.032977 81682.9585  55.2%     -   72s
H    0     0                    52688.829947 81682.9585  55.0%     -   72s
     0     0 81682.9585    0  206 52688.8299 81682.9585  55.0%     -   73s
H    0     0                    52755.604563 81682.6123  54.8%     -   74s
     0     0 81033.6110    0  213 52755.6046 81033.6110  53.6%     -  109s
     0     0 81013.3188    0  238 52755.6046 81013.3188  53.6%     -  116s
     0     0 81013.3188    0  235 52755.6046 81013.3188  53.6%     -  120s
     0     0 81013.3188    0  229 52755.6046 81013.3188  53.6%     -  122s
     0     0 81013.3188    0  231 52755.6046 81013.3188  53.6%     -  123s
     0     0 78271.6916    0  268 52755.6046 78271.6916  48.4%     -  203s
H    0     0                    52830.012876 78270.9316  48.2%     -  205s
H    0     0                    52886.627875 78270.9316  48.0%     -  205s
     0     0 77575.3230    0  284 52886.6279 77575.3230  46.7%     -  252s
     0     0 77449.5411    0  293 52886.6279 77449.5411  46.4%     -  274s
     0     0 77321.1546    0  268 52886.6279 77321.1546  46.2%     -  297s
     0     0 77118.1597    0  275 52886.6279 77118.1597  45.8%     -  318s
     0     0 76892.1244    0  279 52886.6279 76892.1244  45.4%     -  349s
     0     0 76828.3769    0  267 52886.6279 76828.3769  45.3%     -  362s
     0     0 76800.1768    0  286 52886.6279 76800.1768  45.2%     -  372s
     0     0 76793.6921    0  277 52886.6279 76793.6921  45.2%     -  376s
     0     0 76792.1922    0  277 52886.6279 76792.1922  45.2%     -  378s
     0     0 76790.9682    0  277 52886.6279 76790.9682  45.2%     -  379s
     0     0 73739.4292    0  326 52886.6279 73739.4292  39.4%     -  528s
     0     0 73363.3214    0  334 52886.6279 73363.3214  38.7%     -  590s
     0     0 73162.5457    0  314 52886.6279 73162.5457  38.3%     -  623s
     0     0 72881.7368    0  367 52886.6279 72881.7368  37.8%     -  653s
     0     0 72765.1933    0  326 52886.6279 72765.1933  37.6%     -  675s
     0     0 72733.6572    0  351 52886.6279 72733.6572  37.5%     -  690s
     0     0 72703.8600    0  395 52886.6279 72703.8600  37.5%     -  703s
     0     0 72555.0859    0  375 52886.6279 72555.0859  37.2%     -  730s
     0     0 72510.7552    0  368 52886.6279 72510.7552  37.1%     -  745s
     0     0 72378.2039    0  414 52886.6279 72378.2039  36.9%     -  774s
     0     0 72332.2714    0  324 52886.6279 72332.2714  36.8%     -  788s
     0     0 72319.8203    0  337 52886.6279 72319.8203  36.7%     -  794s
     0     0 72309.4941    0  329 52886.6279 72309.4941  36.7%     -  799s
     0     0 72306.0937    0  333 52886.6279 72306.0937  36.7%     -  802s
     0     0 72303.8620    0  329 52886.6279 72303.8620  36.7%     -  804s
     0     0 72283.1801    0  375 52886.6279 72283.1801  36.7%     -  816s
     0     0 72270.5534    0  378 52886.6279 72270.5534  36.7%     -  820s
     0     0 72255.1221    0  381 52886.6279 72255.1221  36.6%     -  825s
     0     0 72245.6330    0  367 52886.6279 72245.6330  36.6%     -  830s
     0     0 72236.5343    0  382 52886.6279 72236.5343  36.6%     -  836s
     0     0 72233.6621    0  385 52886.6279 72233.6621  36.6%     -  838s
     0     0 72232.4319    0  371 52886.6279 72232.4319  36.6%     -  840s
H    0     0                    52897.118579 72232.4319  36.6%     -  877s
H    0     0                    52913.524215 72232.4319  36.5%     -  877s
H    0     0                    52950.976699 72232.4319  36.4%     -  877s
     0     0 71102.4778    0  352 52950.9767 71102.4778  34.3%     -  941s
     0     0 70719.4927    0  346 52950.9767 70719.4927  33.6%     -  988s
     0     0 70630.9853    0  394 52950.9767 70630.9853  33.4%     - 1005s
     0     0 70548.4126    0  389 52950.9767 70548.4126  33.2%     - 1025s
     0     0 70508.0675    0  396 52950.9767 70508.0675  33.2%     - 1036s
     0     0 70461.6233    0  376 52950.9767 70461.6233  33.1%     - 1060s
     0     0 70428.4440    0  350 52950.9767 70428.4440  33.0%     - 1067s
     0     0 70407.1054    0  373 52950.9767 70407.1054  33.0%     - 1077s
     0     0 70394.0173    0  392 52950.9767 70394.0173  32.9%     - 1083s
     0     0 70373.4066    0  376 52950.9767 70373.4066  32.9%     - 1090s
     0     0 70362.0789    0  378 52950.9767 70362.0789  32.9%     - 1094s
     0     0 70358.5076    0  374 52950.9767 70358.5076  32.9%     - 1096s
     0     0 70344.0442    0  350 52950.9767 70344.0442  32.8%     - 1103s
     0     0 70318.7489    0  369 52950.9767 70318.7489  32.8%     - 1114s
     0     0 70308.5202    0  376 52950.9767 70308.5202  32.8%     - 1121s
     0     0 70305.4123    0  335 52950.9767 70305.4123  32.8%     - 1126s
     0     0 70299.0841    0  344 52950.9767 70299.0841  32.8%     - 1131s
     0     0 70287.1017    0  386 52950.9767 70287.1017  32.7%     - 1136s
     0     0 70281.2565    0  380 52950.9767 70281.2565  32.7%     - 1139s
     0     0 70277.8286    0  383 52950.9767 70277.8286  32.7%     - 1143s
     0     0 70276.7945    0  329 52950.9767 70276.7945  32.7%     - 1144s
     0     0 70004.7104    0  358 52950.9767 70004.7104  32.2%     - 1171s
     0     0 69958.8561    0  349 52950.9767 69958.8561  32.1%     - 1189s
     0     0 69940.9490    0  418 52950.9767 69940.9490  32.1%     - 1202s
     0     0 69935.6019    0  402 52950.9767 69935.6019  32.1%     - 1207s
     0     0 69933.0991    0  400 52950.9767 69933.0991  32.1%     - 1211s
     0     0 69769.9290    0  418 52950.9767 69769.9290  31.8%     - 1243s
     0     0 69715.1862    0  426 52950.9767 69715.1862  31.7%     - 1269s
     0     0 69694.1089    0  424 52950.9767 69694.1089  31.6%     - 1279s
     0     0 69676.5542    0  429 52950.9767 69676.5542  31.6%     - 1287s
     0     0 69663.3760    0  423 52950.9767 69663.3760  31.6%     - 1294s
     0     0 69650.3139    0  432 52950.9767 69650.3139  31.5%     - 1303s
     0     0 69647.9279    0  419 52950.9767 69647.9279  31.5%     - 1307s
     0     0 69600.2725    0  411 52950.9767 69600.2725  31.4%     - 1328s
     0     0 69582.1387    0  430 52950.9767 69582.1387  31.4%     - 1339s
     0     0 69578.7844    0  413 52950.9767 69578.7844  31.4%     - 1343s
     0     0 69576.9427    0  417 52950.9767 69576.9427  31.4%     - 1345s
     0     0 69559.1208    0  412 52950.9767 69559.1208  31.4%     - 1353s
     0     0 69550.6272    0  421 52950.9767 69550.6272  31.3%     - 1362s
     0     0 69548.9202    0  423 52950.9767 69548.9202  31.3%     - 1365s
     0     0 69529.1329    0  414 52950.9767 69529.1329  31.3%     - 1373s
     0     0 69524.1565    0  427 52950.9767 69524.1565  31.3%     - 1378s
     0     0 69522.8530    0  421 52950.9767 69522.8530  31.3%     - 1380s
     0     0 69501.8340    0  401 52950.9767 69501.8340  31.3%     - 1390s
     0     0 69497.0065    0  422 52950.9767 69497.0065  31.2%     - 1399s
     0     0 69494.2919    0  420 52950.9767 69494.2919  31.2%     - 1402s
     0     0 69480.4141    0  415 52950.9767 69480.4141  31.2%     - 1409s
     0     0 69480.3289    0  415 52950.9767 69480.3289  31.2%     - 1413s
     0     2 69480.3021    0  415 52950.9767 69480.3021  31.2%     - 1606s
     1     3 68246.5638    1  358 52950.9767 69480.3017  31.2% 31731 1670s
     2     4 69262.3274    1  394 52950.9767 69262.3274  30.8% 23360 1697s
     3     7 67175.9368    2  370 52950.9767 69262.3032  30.8% 19368 1721s
     6    14 68383.4185    3  338 52950.9767 69262.3032  30.8% 16120 1785s
    13    27 68011.3758    4  335 52950.9767 68758.5791  29.9% 16997 1829s
    26    40 67223.9468    5  336 52950.9767 68758.3064  29.9% 21043 2965s
    39    69 66456.8783    5  385 52950.9767 68376.9127  29.1% 25457 3311s
H   56    69                    52990.358931 68376.9127  29.0% 22965 3311s
H   57    69                    53321.144382 68376.9127  28.2% 22642 3311s
    68   190 67931.9114    6  419 53321.1444 68376.8891  28.2% 25387 3410s
   189   274 67477.9047    9  313 53321.1444 68376.8891  28.2% 14795 3462s
   273   334 67166.9595   10  378 53321.1444 68376.8891  28.2% 12873 3505s
   333   363 66426.8612   11  314 53321.1444 68376.8891  28.2% 12233 3561s
   362   398 66231.4960   12  305 53321.1444 68376.8891  28.2% 11981 3600s

Cutting planes:
  Gomory: 28
  Implied bound: 299
  MIR: 2537
  Flow cover: 2297
  RLT: 81
  Relax-and-lift: 801

Explored 397 nodes (5400270 simplex iterations) in 3600.15 seconds (4196.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53321.1 52990.4 52951 ... 52646

Time limit reached
Best objective 5.332114438227e+04, best bound 6.837688914080e+04, gap 28.2360%
  WARNING: Time limit reached. Using best solution found (gap: 28.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 53321.14, θ = 216828.04
  Upper Bound (UB) = 53321.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216828.04
  [DEBUG]   ✓ Scenario 0: θ = 216828.04 ≤ Q = 216828.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216828.04 ≤ Q = 216828.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216828.04 ≤ Q = 216828.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216828.04 ≤ Q = 216828.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216828.04 ≤ Q = 216828.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216828.04 ≤ Q = 216828.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216828.04 ≤ Q = 216828.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216828.04 ≤ Q = 216828.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216828.04 ≤ Q = 216828.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216828.04 ≤ Q = 216828.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216828.04 ≤ Q = 216828.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216828.04 ≤ Q = 216828.04 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x244b790b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x244b790b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.388449e+13
Presolve removed 2554 rows and 1845 columns
Presolve time: 0.01s
Presolved: 539 rows, 544 columns, 1521 nonzeros
Found heuristic solution: objective 6853036.6088
Variable types: 370 continuous, 174 integer (174 binary)

Root relaxation: objective -1.915808e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -191580.80    0  131 6853036.61 -191580.80   103%     -    0s
H    0     0                    -151449.1100 -191580.80  26.5%     -    0s
H    0     0                    -151725.2451 -191580.80  26.3%     -    0s
H    0     0                    -158049.7921 -191580.80  21.2%     -    0s
H    0     0                    -167807.1149 -170018.61  1.32%     -    0s
     0     0 -170018.61    0   72 -167807.11 -170018.61  1.32%     -    0s
H    0     0                    -168959.9042 -169891.16  0.55%     -    0s
     0     0 -169891.16    0   66 -168959.90 -169891.16  0.55%     -    0s
     0     0 -169890.65    0   66 -168959.90 -169890.65  0.55%     -    0s
     0     0 -169275.76    0   28 -168959.90 -169275.76  0.19%     -    0s
     0     0 -169245.58    0   20 -168959.90 -169245.58  0.17%     -    0s
     0     0 -169220.49    0   18 -168959.90 -169220.49  0.15%     -    0s
     0     0 -169199.23    0   16 -168959.90 -169199.23  0.14%     -    0s
     0     0 -169170.05    0   15 -168959.90 -169170.05  0.12%     -    0s
     0     0 -169132.91    0   15 -168959.90 -169132.91  0.10%     -    0s
     0     0 -169100.26    0    8 -168959.90 -169100.26  0.08%     -    0s
     0     0 -169090.53    0   10 -168959.90 -169090.53  0.08%     -    0s
     0     0 -168988.82    0    3 -168959.90 -168988.82  0.02%     -    0s
     0     0 -168977.03    0    7 -168959.90 -168977.03  0.01%     -    0s

Explored 1 nodes (581 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -168960 -168854 -167807 ... 1.38845e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.689599041925e+05, best bound -1.689733524501e+05, gap 0.0080%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 204134.28
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -168959.90
  [DEBUG]   S×d_nominal = 373094.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373094.18 + -168959.90 = 204134.28
  [DEBUG]   Current θ from Master = 216828.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12693.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 40627.38
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 3157.0366, Absolute Gap = 3157.0366, Relative Gap = 0.059208
  Not converged yet (gap = 3157.04 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567795 nonzeros
Model fingerprint: 0x42d53ad6
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82719 rows and 33579 columns
Presolve time: 3.36s
Presolved: 117434 rows, 49801 columns, 704633 nonzeros
Variable types: 47542 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -317630.6803
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 683
 AA' NZ     : 4.019e+06
 Factor NZ  : 1.025e+07 (roughly 150 MB of memory)
 Factor Ops : 2.339e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.05130537e+07  2.29099352e+08  1.52e+05 1.85e+01  9.84e+04     5s
   1  -1.59162968e+07  2.14851362e+08  1.09e+05 1.02e+02  6.98e+04     6s
   2  -5.19498014e+06  1.73679379e+08  3.61e+04 2.44e+01  2.47e+04     6s
   3  -1.18164618e+06  1.24668389e+08  4.49e+03 2.20e+00  3.48e+03     6s
   4  -6.52304678e+05  7.98800896e+07  7.73e+02 5.79e-01  8.39e+02     6s
   5  -5.67980846e+05  4.01312468e+07  4.03e+02 2.15e-01  4.00e+02     6s
   6  -3.83485169e+05  3.55397299e+07  1.09e+02 1.87e-01  2.22e+02     6s
   7  -2.75149360e+05  2.21967749e+07  3.48e+01 1.06e-01  1.19e+02     6s
   8  -1.55290468e+05  1.50295539e+07  7.82e+00 6.95e-02  7.32e+01     6s
   9  -9.88312378e+04  5.33604415e+06  2.91e+00 2.32e-02  2.57e+01     6s
  10  -5.94482182e+04  2.55809672e+06  1.67e+00 1.09e-02  1.23e+01     6s
  11  -2.96594419e+04  1.82151101e+06  9.46e-01 7.62e-03  8.67e+00     7s
  12  -4.36755461e+03  9.36698512e+05  5.35e-01 3.58e-03  4.40e+00     7s
  13   6.88732289e+03  5.34962436e+05  3.58e-01 1.87e-03  2.46e+00     7s
  14   2.31161199e+04  3.06856051e+05  2.17e-01 1.02e-03  1.32e+00     7s
  15   3.38804458e+04  2.18861788e+05  1.59e-01 1.95e-03  8.63e-01     7s
  16   4.59537493e+04  1.70291860e+05  1.16e-01 2.46e-03  5.80e-01     7s
  17   5.03455201e+04  1.51168292e+05  1.01e-01 2.24e-03  4.70e-01     7s
  18   5.79072595e+04  1.35512392e+05  7.72e-02 1.93e-03  3.62e-01     7s
  19   6.57683186e+04  1.21542286e+05  5.31e-02 1.26e-03  2.60e-01     7s
  20   7.01663968e+04  1.16654945e+05  4.08e-02 1.18e-03  2.17e-01     7s
  21   7.21573608e+04  1.07383780e+05  3.52e-02 8.98e-04  1.64e-01     8s
  22   7.51082971e+04  1.01649214e+05  2.76e-02 1.17e-03  1.24e-01     8s
  23   7.67970077e+04  9.70556962e+04  2.35e-02 8.06e-04  9.45e-02     8s
  24   7.91008516e+04  9.54651338e+04  1.81e-02 6.70e-04  7.63e-02     8s
  25   8.11524805e+04  9.43473504e+04  1.35e-02 5.87e-04  6.15e-02     8s
  26   8.17361157e+04  9.31918130e+04  1.22e-02 4.93e-04  5.34e-02     8s
  27   8.27968629e+04  9.27854689e+04  9.89e-03 4.61e-04  4.66e-02     8s
  28   8.42299480e+04  9.09073498e+04  6.69e-03 3.40e-04  3.11e-02     8s
  29   8.51575972e+04  9.00286890e+04  4.69e-03 2.32e-04  2.27e-02     9s
  30   8.58801645e+04  8.97823410e+04  3.24e-03 2.09e-04  1.82e-02     9s
  31   8.61178891e+04  8.90362753e+04  2.73e-03 2.47e-04  1.36e-02     9s
  32   8.63024234e+04  8.86729792e+04  2.37e-03 1.92e-04  1.11e-02     9s
  33   8.66423842e+04  8.83572832e+04  1.68e-03 1.38e-04  7.99e-03     9s
  34   8.69167561e+04  8.81260127e+04  1.13e-03 9.89e-05  5.64e-03     9s
  35   8.71014541e+04  8.80101631e+04  7.61e-04 8.11e-05  4.24e-03     9s
  36   8.71868845e+04  8.78898512e+04  5.95e-04 6.22e-05  3.28e-03     9s
  37   8.72534807e+04  8.77521574e+04  4.68e-04 3.87e-05  2.32e-03    10s
  38   8.73789058e+04  8.77120196e+04  2.45e-04 3.20e-05  1.55e-03    10s
  39   8.74443539e+04  8.76588461e+04  1.18e-04 2.39e-05  9.99e-04    10s
  40   8.74602200e+04  8.76313046e+04  8.99e-05 1.93e-05  7.97e-04    10s
  41   8.74870860e+04  8.75583474e+04  4.35e-05 7.02e-06  3.32e-04    10s
  42   8.75021871e+04  8.75378662e+04  1.89e-05 3.08e-06  1.66e-04    10s
  43   8.75086300e+04  8.75273379e+04  9.79e-06 1.57e-06  8.72e-05    10s
  44   8.75097383e+04  8.75246754e+04  8.16e-06 1.21e-06  6.96e-05    11s
  45   8.75120507e+04  8.75221745e+04  4.78e-06 8.58e-07  4.72e-05    11s
  46   8.75153953e+04  8.75184062e+04  2.85e-07 3.52e-07  1.40e-05    11s
  47   8.75155274e+04  8.75181654e+04  1.74e-07 3.19e-07  1.23e-05    11s
  48   8.75156758e+04  8.75165246e+04  3.06e-08 1.06e-07  3.95e-06    11s
  49   8.75157179e+04  8.75157468e+04  1.85e-08 9.21e-09  1.34e-07    12s
  50   8.75157311e+04  8.75157314e+04  2.36e-09 4.72e-10  1.16e-09    12s

Barrier solved model in 50 iterations and 11.67 seconds (10.74 work units)
Optimal objective 8.75157311e+04


Root crossover log...

  102676 DPushes remaining with DInf 0.0000000e+00                12s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    6878 PPushes remaining with PInf 4.3610886e-05                15s
    4381 PPushes remaining with PInf 2.4435318e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.7330902e+02     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48081    8.7515731e+04   0.000000e+00   4.733090e+02     16s
   48126    8.7515731e+04   0.000000e+00   0.000000e+00     16s
   48126    8.7515731e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.751573e+04, 48126 iterations, 11.47 seconds (13.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87515.7313    0  198 -203987.28 87515.7313   143%     -   16s
H    0     0                    -195571.7245 87515.7313   145%     -   16s
H    0     0                    -179326.8219 87515.7313   149%     -   19s
H    0     0                    -161891.0748 87515.7313   154%     -   19s
H    0     0                    -132028.6515 87515.7313   166%     -   19s
H    0     0                    -126634.3033 87515.7313   169%     -   19s
H    0     0                    -126573.6153 87515.7313   169%     -   20s
H    0     0                    -120595.8340 87515.7313   173%     -   20s
H    0     0                    -57748.90449 87515.7313   252%     -   22s
H    0     0                    18590.760914 87515.7313   371%     -   22s
H    0     0                    40772.217863 87515.7313   115%     -   22s
H    0     0                    44957.226287 87515.7313  94.7%     -   22s
H    0     0                    51966.518834 87515.7313  68.4%     -   22s
H    0     0                    52092.176342 81600.8294  56.6%     -   94s
H    0     0                    52408.152785 81600.8294  55.7%     -   94s
H    0     0                    52551.306769 81600.8294  55.3%     -   98s
H    0     0                    52814.872377 81600.8294  54.5%     -   98s
H    0     0                    53058.741831 81600.8294  53.8%     -   98s
H    0     0                    53196.636600 81600.8294  53.4%     -   98s
     0     0 81600.8294    0  202 53196.6366 81600.8294  53.4%     -   99s
     0     0 80820.1343    0  203 53196.6366 80820.1343  51.9%     -  133s
     0     0 80819.8869    0  186 53196.6366 80819.8869  51.9%     -  140s
     0     0 80819.8869    0  196 53196.6366 80819.8869  51.9%     -  142s
     0     0 80819.8869    0  186 53196.6366 80819.8869  51.9%     -  151s
     0     0 80819.8869    0  213 53196.6366 80819.8869  51.9%     -  154s
     0     0 78264.4613    0  240 53196.6366 78264.4613  47.1%     -  230s
H    0     0                    53249.504202 78264.1377  47.0%     -  232s
     0     0 77409.2882    0  299 53249.5042 77409.2882  45.4%     -  315s
     0     0 77149.2863    0  267 53249.5042 77149.2863  44.9%     -  386s
     0     0 77095.8644    0  277 53249.5042 77095.8644  44.8%     -  409s
     0     0 77081.3892    0  301 53249.5042 77081.3892  44.8%     -  428s
     0     0 76892.2322    0  297 53249.5042 76892.2322  44.4%     -  477s
     0     0 76818.5460    0  301 53249.5042 76818.5460  44.3%     -  503s
     0     0 76792.1678    0  299 53249.5042 76792.1678  44.2%     -  515s
     0     0 76785.4188    0  299 53249.5042 76785.4188  44.2%     -  520s
     0     0 76783.8824    0  302 53249.5042 76783.8824  44.2%     -  523s
     0     0 76782.2632    0  300 53249.5042 76782.2632  44.2%     -  524s
     0     0 76780.9005    0  302 53249.5042 76780.9005  44.2%     -  526s
     0     0 76780.1230    0  304 53249.5042 76780.1230  44.2%     -  529s
     0     0 74313.6853    0  333 53249.5042 74313.6853  39.6%     -  641s
     0     0 73749.9433    0  309 53249.5042 73749.9433  38.5%     -  696s
     0     0 73312.9446    0  318 53249.5042 73312.9446  37.7%     -  750s
     0     0 73092.7581    0  352 53249.5042 73092.7581  37.3%     -  791s
     0     0 72984.4811    0  376 53249.5042 72984.4811  37.1%     -  820s
     0     0 72888.2578    0  380 53249.5042 72888.2578  36.9%     -  852s
     0     0 72856.4400    0  398 53249.5042 72856.4400  36.8%     -  868s
     0     0 72842.8757    0  385 53249.5042 72842.8757  36.8%     -  880s
     0     0 72801.8051    0  387 53249.5042 72801.8051  36.7%     -  899s
     0     0 72793.8843    0  399 53249.5042 72793.8843  36.7%     -  905s
     0     0 72746.8676    0  380 53249.5042 72746.8676  36.6%     -  926s
     0     0 72710.3533    0  354 53249.5042 72710.3533  36.5%     -  942s
     0     0 72693.1160    0  392 53249.5042 72693.1160  36.5%     -  951s
     0     0 72685.6936    0  395 53249.5042 72685.6936  36.5%     -  959s
     0     0 72684.6617    0  398 53249.5042 72684.6617  36.5%     -  962s
     0     0 71427.0811    0  407 53249.5042 71427.0811  34.1%     - 1084s
     0     0 71040.4482    0  365 53249.5042 71040.4482  33.4%     - 1149s
     0     0 70849.0170    0  391 53249.5042 70849.0170  33.1%     - 1187s
     0     0 70771.6969    0  407 53249.5042 70771.6969  32.9%     - 1207s
     0     0 70729.0707    0  401 53249.5042 70729.0707  32.8%     - 1222s
     0     0 70701.8079    0  417 53249.5042 70701.8079  32.8%     - 1230s
     0     0 70670.1944    0  415 53249.5042 70670.1944  32.7%     - 1240s
     0     0 70644.2493    0  412 53249.5042 70644.2493  32.7%     - 1249s
     0     0 70641.0992    0  425 53249.5042 70641.0992  32.7%     - 1252s
     0     0 70588.9233    0  422 53249.5042 70588.9233  32.6%     - 1268s
     0     0 70579.9733    0  423 53249.5042 70579.9733  32.5%     - 1274s
     0     0 70571.1867    0  434 53249.5042 70571.1867  32.5%     - 1277s
     0     0 70561.1584    0  423 53249.5042 70561.1584  32.5%     - 1283s
     0     0 70557.9592    0  419 53249.5042 70557.9592  32.5%     - 1285s
     0     0 70556.9462    0  420 53249.5042 70556.9462  32.5%     - 1287s
     0     0 70232.5955    0  407 53249.5042 70232.5955  31.9%     - 1319s
     0     0 70139.8136    0  401 53249.5042 70139.8136  31.7%     - 1336s
     0     0 70110.3401    0  372 53249.5042 70110.3401  31.7%     - 1345s
     0     0 70094.5590    0  385 53249.5042 70094.5590  31.6%     - 1352s
     0     0 70086.7465    0  378 53249.5042 70086.7465  31.6%     - 1357s
     0     0 70084.9320    0  385 53249.5042 70084.9320  31.6%     - 1360s
     0     0 69943.8119    0  367 53249.5042 69943.8119  31.4%     - 1386s
     0     0 69892.0754    0  392 53249.5042 69892.0754  31.3%     - 1407s
     0     0 69883.4772    0  402 53249.5042 69883.4772  31.2%     - 1420s
     0     0 69876.9793    0  405 53249.5042 69876.9793  31.2%     - 1426s
     0     0 69875.0474    0  412 53249.5042 69875.0474  31.2%     - 1430s
     0     0 69764.5417    0  429 53249.5042 69764.5417  31.0%     - 1457s
     0     0 69744.4411    0  422 53249.5042 69744.4411  31.0%     - 1470s
     0     0 69737.7552    0  418 53249.5042 69737.7552  31.0%     - 1474s
     0     0 69736.3599    0  415 53249.5042 69736.3599  31.0%     - 1476s
     0     0 69709.7629    0  395 53249.5042 69709.7629  30.9%     - 1487s
     0     0 69701.2355    0  402 53249.5042 69701.2355  30.9%     - 1493s
     0     0 69699.2170    0  408 53249.5042 69699.2170  30.9%     - 1495s
     0     0 69680.1914    0  429 53249.5042 69680.1914  30.9%     - 1507s
     0     0 69663.5131    0  419 53249.5042 69663.5131  30.8%     - 1515s
     0     0 69637.2217    0  414 53249.5042 69637.2217  30.8%     - 1522s
     0     0 69631.2068    0  416 53249.5042 69631.2068  30.8%     - 1526s
     0     0 69629.7350    0  416 53249.5042 69629.7350  30.8%     - 1528s
     0     0 69582.1233    0  429 53249.5042 69582.1233  30.7%     - 1546s
     0     0 69574.0489    0  398 53249.5042 69574.0489  30.7%     - 1552s
     0     0 69572.9563    0  401 53249.5042 69572.9563  30.7%     - 1555s
     0     0 69551.3488    0  408 53249.5042 69551.3488  30.6%     - 1563s
     0     0 69542.2468    0  421 53249.5042 69542.2468  30.6%     - 1568s
     0     0 69537.1015    0  413 53249.5042 69537.1015  30.6%     - 1573s
     0     0 69535.5922    0  356 53249.5042 69535.5922  30.6%     - 1579s
     0     0 69513.8668    0  361 53249.5042 69513.8668  30.5%     - 1590s
     0     0 69486.1661    0  407 53249.5042 69486.1661  30.5%     - 1604s
     0     0 69483.3094    0  410 53249.5042 69483.3094  30.5%     - 1608s
     0     0 69468.0608    0  415 53249.5042 69468.0608  30.5%     - 1619s
     0     0 69463.5537    0  427 53249.5042 69463.5537  30.4%     - 1624s
     0     0 69461.8609    0  433 53249.5042 69461.8609  30.4%     - 1627s
     0     0 69458.3155    0  353 53249.5042 69458.3155  30.4%     - 1634s
     0     0 69457.7658    0  356 53249.5042 69457.7658  30.4%     - 1638s
     0     0 69456.8790    0  348 53249.5042 69456.8790  30.4%     - 1643s
     0     0 69456.4539    0  348 53249.5042 69456.4539  30.4%     - 1645s
     0     0 69456.0006    0  348 53249.5042 69456.0006  30.4%     - 1648s
     0     0 69455.6358    0  348 53249.5042 69455.6358  30.4%     - 1651s
     0     2 69455.6358    0  348 53249.5042 69455.6358  30.4%     - 1888s
     1     3 68914.5053    1  392 53249.5042 69455.5362  30.4% 19987 1927s
     2     5 68705.5048    2  383 53249.5042 69455.5362  30.4% 14376 1962s
     4    10 68948.3107    2  347 53249.5042 69211.3771  30.0% 12624 1991s
     9    19 68036.5467    3  329 53249.5042 69150.8463  29.9% 11551 2074s
    18    37 67798.5542    4  343 53249.5042 68828.5952  29.3% 15568 2130s
    36    50 66667.2269    6  322 53249.5042 68827.9672  29.3% 25797 2266s
    49    77 65854.9358    6  333 53249.5042 68827.9672  29.3% 26049 2357s
    76   182 65640.5420    7  335 53249.5042 68616.5616  28.9% 21561 2512s
H  104   182                    53266.852109 68616.5616  28.8% 17761 2512s
H  181   214                    53287.777271 68616.5616  28.8% 13532 2553s
   213   288 65115.7302   13  308 53287.7773 68616.5616  28.8% 13475 2619s
   287   362 64749.1707   17  307 53287.7773 68616.5616  28.8% 11984 2676s
   361   434 64072.4033   21  304 53287.7773 68616.5616  28.8% 10714 2725s
   433   511 63918.0037   22  287 53287.7773 68616.5616  28.8%  9893 2775s
   510   580 64101.9819   20  237 53287.7773 68616.5616  28.8%  9101 2817s
   579   642 63395.9486   24  287 53287.7773 68616.5616  28.8%  8640 2857s
   641   690 59783.3144   26  262 53287.7773 68616.5616  28.8%  8175 2895s
   697   751 59724.4037   27  263 53287.7773 68616.5616  28.8%  7936 2937s
   768   812 59567.2113   30  249 53287.7773 68616.5616  28.8%  7542 2976s
   835   886 55166.9792   31  236 53287.7773 68616.5616  28.8%  7255 3016s
   909   916 54088.1451   33  231 53287.7773 68616.5616  28.8%  7031 3072s
   945   997 54062.0957   34  225 53287.7773 68616.5616  28.8%  6914 3112s
  1034  1026 53693.9386   38  236 53287.7773 68616.5616  28.8%  6630 3146s
  1063  1070     cutoff   39      53287.7773 68616.5616  28.8%  6569 3187s
  1117  1158 53648.1209   40  220 53287.7773 68616.5616  28.8%  6432 3225s
  1217  1196     cutoff   41      53287.7773 68616.5616  28.8%  6098 3262s
  1263  1249 61248.5762   33  198 53287.7773 68616.5616  28.8%  5992 3302s
  1324  1333 55236.0582   60   98 53287.7773 68616.5616  28.8%  5883 3344s
  1428  1382 55140.7469   61   92 53287.7773 68616.5616  28.8%  5678 3400s
  1543  1414 54509.5151   66   60 53287.7773 68616.3920  28.8%  5502 3447s
  1649  1444 56174.9614   40  212 53287.7773 68616.3920  28.8%  5414 3510s
  1739  1526 56138.7562   41  212 53287.7773 68616.3920  28.8%  5389 3573s
  1861  1608 55457.1981   49  134 53287.7773 68616.3920  28.8%  5234 3600s

Cutting planes:
  Gomory: 30
  Implied bound: 322
  MIR: 3309
  Flow cover: 2740
  RLT: 98
  Relax-and-lift: 891

Explored 1961 nodes (10813448 simplex iterations) in 3600.05 seconds (5070.67 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53287.8 53249.5 53196.6 ... 44957.2

Time limit reached
Best objective 5.328777727093e+04, best bound 6.861639196341e+04, gap 28.7657%
  WARNING: Time limit reached. Using best solution found (gap: 28.77%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 53287.78, θ = 215387.80
  Upper Bound (UB) = 53287.78

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215387.80
  [DEBUG]   ✓ Scenario 0: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215387.80 ≤ Q = 215390.70 (slack: 2.90)
  [DEBUG]   ✓ Scenario 2: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 215387.80 ≤ Q = 215387.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 215387.80 ≤ Q = 215387.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 215387.80 ≤ Q = 215387.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 215387.80 ≤ Q = 215387.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 215387.80 ≤ Q = 215387.80 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x689830c2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x689830c2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.376036e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 6763635.3953
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6763355.6426

Root relaxation: objective -1.943385e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194338.54    0  129 6763355.64 -194338.54   103%     -    0s
H    0     0                    -162381.7245 -194338.54  19.7%     -    0s
H    0     0                    -162661.4772 -194338.54  19.5%     -    0s
     0     0 -173362.50    0  102 -162661.48 -173362.50  6.58%     -    0s
H    0     0                    -171107.9116 -173362.37  1.32%     -    0s
     0     0 -173121.96    0  104 -171107.91 -173121.96  1.18%     -    0s
     0     0 -172630.99    0   78 -171107.91 -172630.99  0.89%     -    0s
H    0     0                    -171200.0425 -172591.54  0.81%     -    0s
     0     0 -172591.54    0   76 -171200.04 -172591.54  0.81%     -    0s
     0     0 -172591.03    0   78 -171200.04 -172591.03  0.81%     -    0s
H    0     0                    -171786.0523 -172591.03  0.47%     -    0s
     0     0 -172438.59    0   71 -171786.05 -172438.59  0.38%     -    0s
     0     0 -172425.45    0   71 -171786.05 -172425.45  0.37%     -    0s
H    0     0                    -171833.9499 -172425.45  0.34%     -    0s
H    0     0                    -172218.2332 -172425.45  0.12%     -    0s
     0     1 -172425.45    0   63 -172218.23 -172425.45  0.12%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 1
  MIR: 142
  Flow cover: 6
  RLT: 57
  Relax-and-lift: 5

Explored 27 nodes (738 simplex iterations) in 0.19 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -172218 -171786 -171200 ... 1.37604e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.722182332045e+05, best bound -1.722334318778e+05, gap 0.0088%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 203256.47
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -172218.23
  [DEBUG]   S×d_nominal = 375474.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 375474.70 + -172218.23 = 203256.47
  [DEBUG]   Current θ from Master = 215387.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12131.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41156.44
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 3123.6695, Absolute Gap = 3123.6695, Relative Gap = 0.058619
  Not converged yet (gap = 3123.67 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611047 nonzeros
Model fingerprint: 0xbd994564
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89082 rows and 36162 columns
Presolve time: 3.93s
Presolved: 126361 rows, 53458 columns, 775123 nonzeros
Variable types: 51199 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -300583.5157
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 719
 AA' NZ     : 5.045e+06
 Factor NZ  : 1.187e+07 (roughly 170 MB of memory)
 Factor Ops : 2.623e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.21022602e+07  2.45290099e+08  1.65e+05 1.77e+01  1.05e+05     6s
   1  -1.73642246e+07  2.31826257e+08  1.20e+05 1.02e+02  7.60e+04     6s
   2  -5.79195442e+06  1.87800392e+08  3.96e+04 2.71e+01  2.66e+04     6s
   3  -1.17970374e+06  1.34642125e+08  4.20e+03 1.81e+00  3.27e+03     7s
   4  -6.69677336e+05  8.55691686e+07  7.20e+02 5.63e-01  7.99e+02     7s
   5  -6.09572980e+05  5.08237284e+07  4.50e+02 2.71e-01  4.61e+02     7s
   6  -4.79140992e+05  3.58206709e+07  1.28e+02 1.75e-01  2.20e+02     7s
   7  -3.75491244e+05  2.44329588e+07  3.98e+01 1.11e-01  1.25e+02     7s
   8  -2.94653081e+05  1.61852205e+07  2.06e+01 7.20e-02  7.83e+01     7s
   9  -2.00531547e+05  1.15180037e+07  9.56e+00 4.99e-02  5.33e+01     7s
  10  -1.41625165e+05  5.61642775e+06  4.75e+00 2.33e-02  2.56e+01     7s
  11  -1.07700012e+05  4.46250862e+06  2.52e+00 1.84e-02  2.01e+01     7s
  12  -7.51282071e+04  2.98099635e+06  1.25e+00 1.23e-02  1.33e+01     7s
  13  -5.59099003e+04  1.47699731e+06  7.96e-01 6.06e-03  6.67e+00     7s
  14  -1.54622207e+03  4.40801600e+05  2.11e-01 1.59e-03  1.92e+00     7s
  15   1.87382715e+04  2.91660312e+05  1.39e-01 1.29e-03  1.18e+00     8s
  16   3.30909944e+04  2.19446435e+05  1.00e-01 2.00e-03  8.08e-01     8s
  17   4.12552334e+04  1.81555974e+05  7.99e-02 2.05e-03  6.09e-01     8s
  18   5.24463587e+04  1.50965829e+05  5.46e-02 1.65e-03  4.27e-01     8s
  19   6.06029985e+04  1.22443826e+05  3.85e-02 1.95e-03  2.68e-01     8s
  20   6.94321811e+04  1.05943090e+05  2.39e-02 1.12e-03  1.58e-01     8s
  21   7.48998018e+04  9.87592322e+04  1.56e-02 6.95e-04  1.04e-01     8s
  22   7.75736225e+04  9.48921563e+04  1.18e-02 4.67e-04  7.51e-02     8s
  23   8.06488121e+04  9.33434821e+04  7.70e-03 3.74e-04  5.51e-02     8s
  24   8.25868694e+04  9.14038815e+04  5.22e-03 2.61e-04  3.82e-02     9s
  25   8.47164213e+04  8.95994475e+04  2.59e-03 1.52e-04  2.12e-02     9s
  26   8.57854242e+04  8.81868937e+04  1.36e-03 6.54e-05  1.04e-02     9s
  27   8.63465544e+04  8.78220088e+04  7.52e-04 4.33e-05  6.40e-03     9s
  28   8.64251992e+04  8.76576961e+04  6.68e-04 3.37e-05  5.35e-03     9s
  29   8.66474387e+04  8.74607786e+04  4.28e-04 2.17e-05  3.53e-03     9s
  30   8.68341393e+04  8.72931730e+04  2.47e-04 1.17e-05  1.99e-03     9s
  31   8.69165246e+04  8.72202028e+04  1.64e-04 7.37e-06  1.32e-03     9s
  32   8.69486755e+04  8.71906026e+04  1.34e-04 5.64e-06  1.05e-03    10s
  33   8.70112239e+04  8.71528802e+04  7.27e-05 3.42e-06  6.14e-04    10s
  34   8.70167260e+04  8.71516135e+04  6.76e-05 3.35e-06  5.85e-04    10s
  35   8.70684244e+04  8.71287619e+04  1.78e-05 2.05e-06  2.62e-04    10s
  36   8.70859358e+04  8.71094893e+04  3.81e-06 9.93e-07  1.02e-04    10s
  37   8.70863278e+04  8.71090532e+04  3.51e-06 9.69e-07  9.85e-05    10s
  38   8.70871246e+04  8.71044067e+04  2.82e-06 7.43e-07  7.49e-05    10s
  39   8.70877489e+04  8.71024210e+04  2.22e-06 6.31e-07  6.36e-05    11s
  40   8.70878890e+04  8.70943956e+04  2.12e-06 3.84e-07  2.82e-05    11s
  41   8.70899519e+04  8.70942130e+04  5.82e-07 3.65e-07  1.85e-05    11s
  42   8.70905570e+04  8.70930229e+04  1.94e-07 2.48e-07  1.07e-05    11s
  43   8.70908304e+04  8.70915152e+04  5.03e-08 6.62e-08  2.97e-06    11s
  44   8.70908675e+04  8.70914095e+04  3.56e-08 5.40e-08  2.35e-06    11s
  45   8.70908900e+04  8.70912874e+04  2.59e-08 3.92e-08  1.72e-06    12s
  46   8.70909015e+04  8.70912677e+04  5.97e-08 3.68e-08  1.59e-06    12s
  47   8.70909042e+04  8.70910535e+04  1.70e-06 4.81e-07  6.48e-07    12s
  48   8.70909533e+04  8.70909968e+04  1.16e-07 1.47e-07  1.88e-07    12s
  49   8.70909592e+04  8.70909605e+04  6.66e-09 3.18e-09  5.65e-09    12s
  50   8.70909594e+04  8.70909600e+04  1.56e-07 1.60e-08  2.78e-09    12s

Barrier solved model in 50 iterations and 12.38 seconds (12.72 work units)
Optimal objective 8.70909594e+04


Root crossover log...

  113580 DPushes remaining with DInf 3.2951429e-07                12s
    5097 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    6258 PPushes remaining with PInf 3.4152174e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2626620e+03     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62594    8.7090960e+04   0.000000e+00   3.262662e+03     17s
   62716    8.7090960e+04   0.000000e+00   0.000000e+00     17s
   62716    8.7090960e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.709096e+04, 62716 iterations, 12.52 seconds (16.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87090.9596    0  149 -203987.28 87090.9596   143%     -   18s
H    0     0                    -199321.9092 87090.9596   144%     -   18s
H    0     0                    -167391.1276 87090.9596   152%     -   19s
H    0     0                    -166857.5385 87090.9596   152%     -   19s
H    0     0                    -37617.21624 87090.9596   332%     -   20s
H    0     0                    18040.120019 87090.9596   383%     -   20s
H    0     0                    19725.078094 87090.9596   342%     -   20s
H    0     0                    37780.767869 87090.9596   131%     -   21s
H    0     0                    40614.551593 87090.9596   114%     -   22s
H    0     0                    44371.175611 87090.9596  96.3%     -   22s
H    0     0                    47015.466870 87090.9596  85.2%     -   22s
H    0     0                    49532.844157 87090.9596  75.8%     -   23s
H    0     0                    49641.985788 87090.9596  75.4%     -   23s
H    0     0                    50138.093391 87090.9596  73.7%     -   23s
H    0     0                    50232.914079 87090.9596  73.4%     -   23s
H    0     0                    50430.498980 87090.9596  72.7%     -   23s
H    0     0                    50997.400589 87090.9596  70.8%     -   23s
H    0     0                    51153.861869 87090.9596  70.3%     -   23s
H    0     0                    51153.872065 87090.9596  70.3%     -   23s
H    0     0                    51157.790957 87090.9596  70.2%     -   23s
H    0     0                    51977.320579 87090.9596  67.6%     -   25s
H    0     0                    52164.153222 87090.9596  67.0%     -   25s
H    0     0                    52313.943338 87090.9596  66.5%     -   25s
H    0     0                    52325.152017 81048.2374  54.9%     -  118s
H    0     0                    52326.498826 81048.2374  54.9%     -  118s
     0     0 81048.2374    0  169 52326.4988 81048.2374  54.9%     -  118s
H    0     0                    52348.498743 81046.7531  54.8%     -  121s
     0     0 80716.5799    0  172 52348.4987 80716.5799  54.2%     -  165s
     0     0 80617.5200    0  179 52348.4987 80617.5200  54.0%     -  180s
     0     0 80602.0468    0  180 52348.4987 80602.0468  54.0%     -  190s
     0     0 80572.0218    0  171 52348.4987 80572.0218  53.9%     -  203s
     0     0 80565.2589    0  178 52348.4987 80565.2589  53.9%     -  209s
     0     0 80565.2576    0  178 52348.4987 80565.2576  53.9%     -  210s
H    0     0                    52421.873635 76875.2107  46.6%     -  311s
     0     0 76875.2107    0  239 52421.8736 76875.2107  46.6%     -  312s
     0     0 76356.9273    0  255 52421.8736 76356.9273  45.7%     -  370s
     0     0 76042.5272    0  250 52421.8736 76042.5272  45.1%     -  404s
     0     0 75985.3193    0  261 52421.8736 75985.3193  44.9%     -  418s
H    0     0                    52490.514879 75935.1621  44.7%     -  428s
H    0     0                    52504.349818 75935.1621  44.6%     -  428s
H    0     0                    52527.758443 75935.1621  44.6%     -  428s
     0     0 75935.1621    0  262 52527.7584 75935.1621  44.6%     -  428s
     0     0 75917.3974    0  266 52527.7584 75917.3974  44.5%     -  442s
     0     0 75888.2291    0  266 52527.7584 75888.2291  44.5%     -  455s
     0     0 75887.1806    0  261 52527.7584 75887.1806  44.5%     -  460s
     0     0 73204.1074    0  305 52527.7584 73204.1074  39.4%     -  535s
H    0     0                    52620.911395 73203.0664  39.1%     -  537s
     0     0 72723.0462    0  358 52620.9114 72723.0462  38.2%     -  581s
     0     0 72426.5326    0  362 52620.9114 72426.5326  37.6%     -  619s
     0     0 72329.1893    0  364 52620.9114 72329.1893  37.5%     -  642s
     0     0 72250.7301    0  387 52620.9114 72250.7301  37.3%     -  661s
     0     0 72228.1080    0  384 52620.9114 72228.1080  37.3%     -  668s
     0     0 72053.8635    0  346 52620.9114 72053.8635  36.9%     -  686s
     0     0 72005.9944    0  341 52620.9114 72005.9944  36.8%     -  701s
     0     0 71948.7456    0  344 52620.9114 71948.7456  36.7%     -  717s
     0     0 71898.2518    0  354 52620.9114 71898.2518  36.6%     -  729s
     0     0 71834.3706    0  358 52620.9114 71834.3706  36.5%     -  742s
     0     0 71777.1227    0  378 52620.9114 71777.1227  36.4%     -  758s
     0     0 71747.0455    0  384 52620.9114 71747.0455  36.3%     -  768s
     0     0 71722.8646    0  345 52620.9114 71722.8646  36.3%     -  777s
     0     0 71668.9100    0  345 52620.9114 71668.9100  36.2%     -  790s
     0     0 71654.2514    0  346 52620.9114 71654.2514  36.2%     -  797s
     0     0 71625.3567    0  388 52620.9114 71625.3567  36.1%     -  809s
     0     0 71612.2148    0  349 52620.9114 71612.2148  36.1%     -  814s
     0     0 71608.6503    0  356 52620.9114 71608.6503  36.1%     -  817s
     0     0 71607.1010    0  362 52620.9114 71607.1010  36.1%     -  820s
     0     0 70832.2960    0  380 52620.9114 70832.2960  34.6%     -  870s
     0     0 70476.7721    0  338 52620.9114 70476.7721  33.9%     -  896s
     0     0 70417.3803    0  369 52620.9114 70417.3803  33.8%     -  909s
     0     0 70382.3432    0  380 52620.9114 70382.3432  33.8%     -  922s
     0     0 70361.0762    0  382 52620.9114 70361.0762  33.7%     -  931s
     0     0 70354.9012    0  379 52620.9114 70354.9012  33.7%     -  934s
     0     0 70340.6253    0  397 52620.9114 70340.6253  33.7%     -  939s
     0     0 70335.5209    0  385 52620.9114 70335.5209  33.7%     -  942s
     0     0 70308.0715    0  384 52620.9114 70308.0715  33.6%     -  947s
     0     0 70303.8836    0  393 52620.9114 70303.8836  33.6%     -  951s
     0     0 70300.3946    0  398 52620.9114 70300.3946  33.6%     -  956s
     0     0 70298.7753    0  394 52620.9114 70298.7753  33.6%     -  959s
     0     0 70084.0195    0  370 52620.9114 70084.0195  33.2%     -  977s
     0     0 69986.7792    0  359 52620.9114 69986.7792  33.0%     -  994s
     0     0 69959.9567    0  386 52620.9114 69959.9567  33.0%     - 1004s
     0     0 69947.7538    0  390 52620.9114 69947.7538  32.9%     - 1008s
     0     0 69940.0852    0  350 52620.9114 69940.0852  32.9%     - 1014s
     0     0 69936.3021    0  354 52620.9114 69936.3021  32.9%     - 1017s
     0     0 69935.8771    0  396 52620.9114 69935.8771  32.9%     - 1018s
H    0     0                    52641.203528 69802.0216  32.6%     - 1037s
     0     0 69802.0216    0  377 52641.2035 69802.0216  32.6%     - 1037s
     0     0 69760.9828    0  371 52641.2035 69760.9828  32.5%     - 1060s
     0     0 69720.4756    0  388 52641.2035 69720.4756  32.4%     - 1073s
     0     0 69696.2349    0  407 52641.2035 69696.2349  32.4%     - 1079s
     0     0 69685.7056    0  394 52641.2035 69685.7056  32.4%     - 1085s
     0     0 69675.4547    0  389 52641.2035 69675.4547  32.4%     - 1088s
     0     0 69665.2195    0  393 52641.2035 69665.2195  32.3%     - 1093s
     0     0 69661.3038    0  399 52641.2035 69661.3038  32.3%     - 1096s
     0     0 69659.6541    0  398 52641.2035 69659.6541  32.3%     - 1097s
     0     0 69584.2909    0  365 52641.2035 69584.2909  32.2%     - 1118s
H    0     0                    52659.300358 69584.0154  32.1%     - 1119s
     0     0 69579.3764    0  350 52659.3004 69579.3764  32.1%     - 1123s
     0     0 69574.6709    0  359 52659.3004 69574.6709  32.1%     - 1126s
     0     0 69574.0955    0  353 52659.3004 69574.0955  32.1%     - 1127s
     0     0 69550.4408    0  391 52659.3004 69550.4408  32.1%     - 1139s
H    0     0                    52795.617891 69550.3963  31.7%     - 1165s
H    0     0                    52918.558685 69550.3963  31.4%     - 1165s
     0     0 69544.2920    0  350 52918.5587 69544.2920  31.4%     - 1174s
     0     0 69540.7942    0  390 52918.5587 69540.7942  31.4%     - 1181s
     0     0 69538.6913    0  391 52918.5587 69538.6913  31.4%     - 1184s
     0     0 69515.8021    0  396 52918.5587 69515.8021  31.4%     - 1194s
     0     0 69504.1196    0  403 52918.5587 69504.1196  31.3%     - 1203s
     0     0 69501.0755    0  402 52918.5587 69501.0755  31.3%     - 1206s
     0     0 69497.7321    0  403 52918.5587 69497.7321  31.3%     - 1210s
     0     0 69496.8773    0  400 52918.5587 69496.8773  31.3%     - 1211s
     0     0 69480.0371    0  350 52918.5587 69480.0371  31.3%     - 1220s
H    0     0                    53008.819693 69479.9676  31.1%     - 1228s
     0     0 69479.4581    0  362 53008.8197 69479.4581  31.1%     - 1230s
     0     0 69478.7000    0  367 53008.8197 69478.7000  31.1%     - 1235s
     0     0 69477.8439    0  359 53008.8197 69477.8439  31.1%     - 1238s
     0     0 69477.3242    0  359 53008.8197 69477.3242  31.1%     - 1242s
     0     0 69476.7264    0  367 53008.8197 69476.7264  31.1%     - 1244s
     0     0 69464.4411    0  365 53008.8197 69464.4411  31.0%     - 1252s
     0     0 69463.6104    0  365 53008.8197 69463.6104  31.0%     - 1255s
     0     2 69463.6104    0  365 53008.8197 69463.6104  31.0%     - 1504s
     1     3 69413.3476    1  350 53008.8197 69458.1426  31.0%  8940 1520s
     2     4 69373.0095    1  382 53008.8197 69412.0965  30.9%  7848 1539s
     3     6 67764.8747    2  359 53008.8197 69410.0149  30.9% 10136 1569s
     5    12 68426.2696    3  335 53008.8197 69372.9524  30.9%  9755 1604s
    11    24 67846.2886    4  376 53008.8197 68746.1378  29.7% 12918 1656s
    23    36 68118.1132    4  378 53008.8197 68479.5584  29.2% 24796 1766s
    35    68 67334.7903    5  414 53008.8197 68479.5584  29.2% 21454 1997s
    67   112 67267.4485    6  416 53008.8197 68355.6498  29.0% 25193 2066s
H   69   112                    53026.288176 68355.6498  28.9% 24687 2066s
H   76   112                    53038.345098 68355.6498  28.9% 23603 2066s
   111   222 67167.0768    7  355 53038.3451 68355.5533  28.9% 20124 2155s
   221   282 67053.8107   10  338 53038.3451 68355.5533  28.9% 13656 2210s
   281   311 66886.9225   12  353 53038.3451 68355.5533  28.9% 12444 2258s
   310   346 66781.1971   13  338 53038.3451 68355.5533  28.9% 12327 2306s
   345   381 66738.2133   14  316 53038.3451 68355.5533  28.9% 12051 2352s
   380   420 66618.7099   15  311 53038.3451 68355.5533  28.9% 11703 2418s
   419   462 66594.2811   16  381 53038.3451 68355.5533  28.9% 11348 2464s
   461   503 66492.6277   17  326 53038.3451 68355.5533  28.9% 11084 2501s
   502   549 63998.3264   20  297 53038.3451 68355.5533  28.9% 11216 2545s
H  532   549                    53146.755555 68355.5533  28.6% 11187 2545s
   548   628 65896.1908   18  294 53146.7556 68355.5533  28.6% 11186 2587s
   627   693 65752.4576   19  332 53146.7556 68355.5533  28.6% 10879 2622s
   694   765 65670.8564   20  278 53146.7556 68355.5533  28.6% 10797 2658s
   766   838 65459.3547   22  284 53146.7556 68355.5533  28.6% 10611 2692s
   839   923 65435.8950   24  288 53146.7556 68355.5533  28.6% 10335 2724s
   924  1005 65182.1623   26  269 53146.7556 68355.5533  28.6% 10076 2762s
  1006  1083 64756.8149   28  295 53146.7556 68355.5533  28.6% 10002 2795s
  1090  1183 63852.2457   31  251 53146.7556 68355.5533  28.6%  9908 2831s
  1192  1277 63403.3608   34  237 53146.7556 68355.5533  28.6%  9636 2865s
  1306  1374 54171.0945   36  183 53146.7556 68355.5533  28.6%  9384 2907s
  1425  1481 54004.6230   39  193 53146.7556 68355.5533  28.6%  9099 2944s
  1563  1537     cutoff   43      53146.7556 68355.5533  28.6%  8849 2990s
H 1565  1537                    53426.443954 68355.5533  27.9%  8841 2990s
H 1583  1537                    53532.650649 68355.5533  27.7%  8811 2990s
  1662  1580 60306.1568   35  228 53532.6506 68355.5533  27.7%  8723 3035s
  1767  1653 60282.8787   36  247 53532.6506 68355.5533  27.7%  8663 3081s
  1888  1749 59152.6689   39  178 53532.6506 68355.5533  27.7%  8608 3130s
  2025  1879 58231.6179   45  167 53532.6506 68355.5533  27.7%  8483 3179s
  2187  1997 57469.4986   51  150 53532.6506 68355.5533  27.7%  8313 3232s
  2356  2161 55891.7594   58  139 53532.6506 68355.5533  27.7%  8108 3285s
  2558  2291 54110.1456   72   97 53532.6506 68355.5533  27.7%  7827 3337s
  2758  2407 66763.8433    8  325 53532.6506 67999.6068  27.0%  7609 3389s
  2926  2526 65906.4331   10  302 53532.6506 67999.6068  27.0%  7498 3448s
  3119  2567 65698.6711   11  307 53532.6506 67785.3736  26.6%  7404 3498s
H 3122  2566                    53570.761922 67785.3736  26.5%  7410 3498s
H 3200  2557                    53663.153225 67785.3736  26.3%  7412 3498s
  3203  2605 64813.1448   12  264 53663.1532 67785.3736  26.3%  7433 3558s
  3316  2650 61923.0588   14  223 53663.1532 67733.8111  26.2%  7523 3600s

Cutting planes:
  Learned: 2
  Gomory: 20
  Lift-and-project: 1
  Implied bound: 212
  MIR: 2926
  Flow cover: 3010
  RLT: 45
  Relax-and-lift: 508

Explored 3409 nodes (26595261 simplex iterations) in 3600.06 seconds (5514.72 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53663.2 53570.8 53532.7 ... 52795.6

Time limit reached
Best objective 5.366315322547e+04, best bound 6.773381106863e+04, gap 26.2203%
  WARNING: Time limit reached. Using best solution found (gap: 26.22%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 53663.15, θ = 216020.22
  Upper Bound (UB) = 53663.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216020.22
  [DEBUG]   ✓ Scenario 0: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216020.22 ≤ Q = 216020.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216020.22 ≤ Q = 216062.42 (slack: 42.20)
  [DEBUG]   ✓ Scenario 6: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216020.22 ≤ Q = 216020.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216020.22 ≤ Q = 216020.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216020.22 ≤ Q = 216421.69 (slack: 401.47)
  [DEBUG]   ✓ Scenario 13: θ = 216020.22 ≤ Q = 216020.22 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x266da768
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd9925898
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.389868e+13
Presolve removed 2554 rows and 1845 columns
Presolve time: 0.01s
Presolved: 539 rows, 544 columns, 1521 nonzeros
Found heuristic solution: objective 6827805.7797
Variable types: 370 continuous, 174 integer (174 binary)

Root relaxation: objective -1.904085e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -190408.50    0  124 6827805.78 -190408.50   103%     -    0s
H    0     0                    -153082.9563 -190408.50  24.4%     -    0s
H    0     0                    -153631.5918 -190408.50  23.9%     -    0s
H    0     0                    -157111.9791 -190408.50  21.2%     -    0s
H    0     0                    -157432.0241 -167675.73  6.51%     -    0s
     0     0 -167675.73    0  108 -157432.02 -167675.73  6.51%     -    0s
H    0     0                    -165077.2298 -167547.61  1.50%     -    0s
H    0     0                    -165352.5091 -167547.61  1.33%     -    0s
H    0     0                    -165484.9984 -167547.61  1.25%     -    0s
H    0     0                    -165760.2777 -167547.61  1.08%     -    0s
     0     0 -166485.35    0  101 -165760.28 -166485.35  0.44%     -    0s
     0     0 -166460.23    0  101 -165760.28 -166460.23  0.42%     -    0s
     0     0 -166204.99    0   36 -165760.28 -166204.99  0.27%     -    0s
     0     0 -166090.91    0   48 -165760.28 -166090.91  0.20%     -    0s
     0     0 -166002.52    0   40 -165760.28 -166002.52  0.15%     -    0s
     0     0 -165995.62    0   40 -165760.28 -165995.62  0.14%     -    0s
H    0     0                    -165773.4552 -165995.62  0.13%     -    0s
     0     0 -165995.62    0   77 -165773.46 -165995.62  0.13%     -    0s
     0     0 -165995.62    0   77 -165773.46 -165995.62  0.13%     -    0s
     0     0 -165995.62    0   40 -165773.46 -165995.62  0.13%     -    0s
H    0     0                    -165790.9630 -165995.62  0.12%     -    0s
     0     0 -165945.25    0   37 -165790.96 -165945.25  0.09%     -    0s
     0     0 -165920.09    0   36 -165790.96 -165920.09  0.08%     -    0s
     0     0 -165893.82    0   33 -165790.96 -165893.82  0.06%     -    0s
H    0     0                    -165792.6146 -165893.62  0.06%     -    0s
H    0     0                    -165805.3193 -165893.62  0.05%     -    0s
H    0     0                    -165814.1246 -165893.62  0.05%     -    0s
     0     0 -165893.62    0   33 -165814.12 -165893.62  0.05%     -    0s
H    0     0                    -165837.2178 -165893.62  0.03%     -    0s
     0     0 -165893.62    0   34 -165837.22 -165893.62  0.03%     -    0s
     0     0 -165893.62    0   32 -165837.22 -165893.62  0.03%     -    0s
     0     0 -165893.62    0   28 -165837.22 -165893.62  0.03%     -    0s
     0     0 -165893.62    0   28 -165837.22 -165893.62  0.03%     -    0s
     0     0 -165891.83    0   28 -165837.22 -165891.83  0.03%     -    0s
     0     0 -165885.92    0   27 -165837.22 -165885.92  0.03%     -    0s
     0     0 -165876.03    0   27 -165837.22 -165876.03  0.02%     -    0s
H    0     0                    -165841.3843 -165876.03  0.02%     -    0s
     0     0 -165867.34    0   27 -165841.38 -165867.34  0.02%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 38
  Flow cover: 15

Explored 1 nodes (1228 simplex iterations) in 0.24 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -165841 -165837 -165814 ... -165210

Optimal solution found (tolerance 1.00e-04)
Best objective -1.658413842859e+05, best bound -1.658499441747e+05, gap 0.0052%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 208065.50
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -165841.38
  [DEBUG]   S×d_nominal = 373906.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373906.89 + -165841.38 = 208065.50
  [DEBUG]   Current θ from Master = 216020.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7954.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45708.44
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 3499.0455, Absolute Gap = 3499.0455, Relative Gap = 0.065204
  Not converged yet (gap = 3499.05 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654299 nonzeros
Model fingerprint: 0x38ef0d97
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 95445 rows and 38745 columns (presolve time = 5s)...
Presolve removed 95445 rows and 38745 columns
Presolve time: 6.41s
Presolved: 135288 rows, 57115 columns, 831154 nonzeros
Variable types: 54856 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -300583.5157
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.55s

Barrier statistics:
 Dense cols : 723
 AA' NZ     : 5.683e+06
 Factor NZ  : 1.326e+07 (roughly 200 MB of memory)
 Factor Ops : 3.054e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.28165693e+07  2.59478387e+08  1.70e+05 1.76e+01  1.08e+05     9s
   1  -1.79909843e+07  2.46454899e+08  1.24e+05 1.05e+02  7.81e+04     9s
   2  -6.78508600e+06  2.00839365e+08  4.50e+04 4.28e+01  2.98e+04     9s
   3  -1.48814332e+06  1.45611321e+08  6.18e+03 1.90e+00  4.51e+03    10s
   4  -7.80214113e+05  9.59246811e+07  1.31e+03 5.14e-01  1.16e+03    10s
   5  -6.52770810e+05  4.08626261e+07  5.58e+02 1.36e-01  4.53e+02    10s
   6  -4.83768945e+05  3.04295632e+07  1.72e+02 9.40e-02  2.08e+02    10s
   7  -3.01564163e+05  2.05918667e+07  4.35e+01 5.83e-02  1.03e+02    10s
   8  -2.18730316e+05  1.32007286e+07  2.19e+01 3.47e-02  6.14e+01    10s
   9  -1.40547609e+05  8.17975358e+06  7.63e+00 2.00e-02  3.54e+01    10s
  10  -1.13590039e+05  3.94501468e+06  3.83e+00 9.17e-03  1.69e+01    10s
  11  -8.45010657e+04  2.67195713e+06  2.03e+00 6.08e-03  1.13e+01    10s
  12  -5.69409226e+04  9.60188498e+05  1.02e+00 2.25e-03  4.15e+00    11s
  13  -1.46893191e+04  3.97765526e+05  4.86e-01 2.14e-03  1.68e+00    11s
  14   1.13669781e+04  2.70049516e+05  3.34e-01 1.36e-03  1.05e+00    11s
  15   2.42115246e+04  2.13409478e+05  2.67e-01 1.54e-03  7.70e-01    11s
  16   3.86864863e+04  1.77202364e+05  1.95e-01 1.35e-03  5.63e-01    11s
  17   4.06993811e+04  1.66135289e+05  1.85e-01 1.31e-03  5.10e-01    11s
  18   4.23661958e+04  1.51954274e+05  1.77e-01 1.50e-03  4.46e-01    11s
  19   5.32720624e+04  1.30909496e+05  1.24e-01 1.48e-03  3.16e-01    11s
  20   5.90796017e+04  1.18803339e+05  9.87e-02 1.59e-03  2.43e-01    11s
  21   6.43607488e+04  1.07995504e+05  7.76e-02 1.74e-03  1.78e-01    12s
  22   6.75884484e+04  9.95781483e+04  6.54e-02 2.21e-03  1.30e-01    12s
  23   7.15118575e+04  9.58078136e+04  5.15e-02 1.51e-03  9.90e-02    12s
  24   7.47916492e+04  9.27628265e+04  3.99e-02 2.48e-03  7.32e-02    12s
  25   7.85352992e+04  9.09676525e+04  2.71e-02 1.69e-03  5.07e-02    12s
  26   8.18651204e+04  8.96504938e+04  1.60e-02 1.11e-03  3.17e-02    12s
  27   8.37293871e+04  8.90782091e+04  9.98e-03 8.59e-04  2.18e-02    12s
  28   8.46561742e+04  8.85815249e+04  7.07e-03 6.50e-04  1.60e-02    13s
  29   8.55798963e+04  8.79511160e+04  4.25e-03 3.72e-04  9.65e-03    13s
  30   8.60817801e+04  8.76178433e+04  2.77e-03 2.29e-04  6.25e-03    13s
  31   8.61016312e+04  8.74304938e+04  2.71e-03 1.50e-04  5.41e-03    13s
  32   8.63051796e+04  8.72613131e+04  2.11e-03 7.48e-05  3.90e-03    13s
  33   8.68344489e+04  8.72188664e+04  6.06e-04 5.50e-05  1.56e-03    13s
  34   8.69972879e+04  8.71424588e+04  1.88e-04 2.49e-05  5.90e-04    13s
  35   8.70248233e+04  8.71294125e+04  1.20e-04 1.96e-05  4.25e-04    14s
  36   8.70531812e+04  8.71151670e+04  5.15e-05 1.41e-05  2.52e-04    14s
  37   8.70667788e+04  8.70962077e+04  2.03e-05 6.88e-06  1.19e-04    14s
  38   8.70752897e+04  8.70785087e+04  3.95e-06 3.03e-07  1.31e-05    14s
  39   8.70769446e+04  8.70777863e+04  1.24e-06 1.17e-07  3.42e-06    14s
  40   8.70776260e+04  8.70776523e+04  6.24e-08 4.47e-08  1.07e-07    14s
  41   8.70776454e+04  8.70776458e+04  1.77e-07 5.55e-08  1.26e-09    14s

Barrier solved model in 41 iterations and 14.47 seconds (10.94 work units)
Optimal objective 8.70776454e+04


Root crossover log...

  121604 DPushes remaining with DInf 0.0000000e+00                15s
   59428 DPushes remaining with DInf 0.0000000e+00                15s
     950 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

   10094 PPushes remaining with PInf 7.1257354e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3065167e+04     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74516    8.7077646e+04   0.000000e+00   1.306517e+04     23s
   75076    8.7077646e+04   0.000000e+00   0.000000e+00     24s
   75076    8.7077646e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 2.01s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.707765e+04, 75076 iterations, 18.13 seconds (21.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87077.6458    0  157 -203987.28 87077.6458   143%     -   26s
H    0     0                    -200069.6417 87077.6458   144%     -   32s
H    0     0                    -199795.8618 87077.6458   144%     -   32s
H    0     0                    -198810.4183 87077.6458   144%     -   32s
H    0     0                    -197445.5950 87077.6458   144%     -   33s
H    0     0                    -195678.0251 87077.6458   145%     -   33s
H    0     0                    -195548.3405 87077.6458   145%     -   33s
H    0     0                    -195327.3291 87077.6458   145%     -   33s
H    0     0                    -195259.7509 87077.6458   145%     -   33s
H    0     0                    -188401.5737 87077.6458   146%     -   33s
H    0     0                    -188298.3484 87077.6458   146%     -   33s
H    0     0                    5542.7135633 87077.6458  1471%     -   33s
H    0     0                    28628.690190 87077.6458   204%     -   33s
H    0     0                    36977.789259 87077.6458   135%     -   33s
H    0     0                    37565.038059 87077.6458   132%     -   34s
     0     0 80354.1190    0  181 37565.0381 80354.1190   114%     -  140s
H    0     0                    45312.585238 80353.9933  77.3%     -  141s
H    0     0                    50367.074205 80353.9933  59.5%     -  141s
H    0     0                    50610.857780 80353.9933  58.8%     -  141s
H    0     0                    51593.232284 80353.9933  55.7%     -  142s
     0     0 79670.3170    0  169 51593.2323 79670.3170  54.4%     -  221s
     0     0 79610.4934    0  167 51593.2323 79610.4934  54.3%     -  245s
     0     0 79503.8092    0  160 51593.2323 79503.8092  54.1%     -  267s
     0     0 79463.0582    0  160 51593.2323 79463.0582  54.0%     -  283s
     0     0 79459.2377    0  162 51593.2323 79459.2377  54.0%     -  288s
     0     0 79443.7328    0  157 51593.2323 79443.7328  54.0%     -  301s
     0     0 79441.9273    0  196 51593.2323 79441.9273  54.0%     -  307s
     0     0 79441.5540    0  196 51593.2323 79441.5540  54.0%     -  308s
     0     0 76438.2158    0  247 51593.2323 76438.2158  48.2%     -  378s
     0     0 75761.4289    0  275 51593.2323 75761.4289  46.8%     -  441s
     0     0 75586.9955    0  255 51593.2323 75586.9955  46.5%     -  482s
     0     0 75440.9547    0  261 51593.2323 75440.9547  46.2%     -  510s
     0     0 75283.7299    0  249 51593.2323 75283.7299  45.9%     -  535s
     0     0 75269.0316    0  255 51593.2323 75269.0316  45.9%     -  541s
     0     0 75237.5080    0  252 51593.2323 75237.5080  45.8%     -  552s
     0     0 75058.9651    0  261 51593.2323 75058.9651  45.5%     -  588s
     0     0 75040.1670    0  265 51593.2323 75040.1670  45.4%     -  596s
     0     0 75024.7931    0  258 51593.2323 75024.7931  45.4%     -  605s
     0     0 74994.6949    0  260 51593.2323 74994.6949  45.4%     -  618s
     0     0 74970.6553    0  263 51593.2323 74970.6553  45.3%     -  628s
     0     0 74966.0870    0  268 51593.2323 74966.0870  45.3%     -  635s
     0     0 74965.1233    0  270 51593.2323 74965.1233  45.3%     -  638s
     0     0 72611.0957    0  297 51593.2323 72611.0957  40.7%     -  746s
     0     0 72159.1903    0  306 51593.2323 72159.1903  39.9%     -  789s
     0     0 71897.1055    0  311 51593.2323 71897.1055  39.4%     -  817s
     0     0 71793.6819    0  316 51593.2323 71793.6819  39.2%     -  837s
     0     0 71663.3412    0  316 51593.2323 71663.3412  38.9%     -  860s
     0     0 71529.8600    0  323 51593.2323 71529.8600  38.6%     -  881s
     0     0 71491.5320    0  330 51593.2323 71491.5320  38.6%     -  893s
     0     0 71460.4795    0  337 51593.2323 71460.4795  38.5%     -  902s
     0     0 71443.6602    0  335 51593.2323 71443.6602  38.5%     -  909s
     0     0 71431.7908    0  339 51593.2323 71431.7908  38.5%     -  914s
     0     0 71419.7644    0  336 51593.2323 71419.7644  38.4%     -  921s
     0     0 71417.2861    0  340 51593.2323 71417.2861  38.4%     -  924s
     0     0 71417.0907    0  339 51593.2323 71417.0907  38.4%     -  925s
     0     0 70509.6937    0  385 51593.2323 70509.6937  36.7%     - 1001s
     0     0 70336.3915    0  340 51593.2323 70336.3915  36.3%     - 1020s
     0     0 70271.6888    0  337 51593.2323 70271.6888  36.2%     - 1033s
     0     0 70251.8476    0  338 51593.2323 70251.8476  36.2%     - 1040s
     0     0 70236.2405    0  355 51593.2323 70236.2405  36.1%     - 1049s
     0     0 70215.0228    0  378 51593.2323 70215.0228  36.1%     - 1061s
     0     0 70206.3175    0  384 51593.2323 70206.3175  36.1%     - 1065s
     0     0 70200.2700    0  352 51593.2323 70200.2700  36.1%     - 1069s
     0     0 70197.5576    0  382 51593.2323 70197.5576  36.1%     - 1072s
     0     0 70194.7445    0  387 51593.2323 70194.7445  36.1%     - 1074s
     0     0 70191.9600    0  354 51593.2323 70191.9600  36.0%     - 1076s
     0     0 70188.1584    0  382 51593.2323 70188.1584  36.0%     - 1077s
     0     0 70186.4178    0  379 51593.2323 70186.4178  36.0%     - 1079s
     0     0 70014.8558    0  372 51593.2323 70014.8558  35.7%     - 1102s
     0     0 69964.3120    0  383 51593.2323 69964.3120  35.6%     - 1111s
     0     0 69960.5895    0  389 51593.2323 69960.5895  35.6%     - 1114s
     0     0 69954.7469    0  384 51593.2323 69954.7469  35.6%     - 1119s
     0     0 69952.1804    0  385 51593.2323 69952.1804  35.6%     - 1122s
     0     0 69931.6702    0  373 51593.2323 69931.6702  35.5%     - 1132s
     0     0 69916.7315    0  397 51593.2323 69916.7315  35.5%     - 1137s
     0     0 69909.5044    0  388 51593.2323 69909.5044  35.5%     - 1140s
     0     0 69906.9368    0  394 51593.2323 69906.9368  35.5%     - 1144s
     0     0 69905.8693    0  401 51593.2323 69905.8693  35.5%     - 1145s
     0     0 69805.7496    0  395 51593.2323 69805.7496  35.3%     - 1166s
     0     0 69766.5937    0  410 51593.2323 69766.5937  35.2%     - 1181s
     0     0 69757.1466    0  404 51593.2323 69757.1466  35.2%     - 1186s
     0     0 69750.9636    0  400 51593.2323 69750.9636  35.2%     - 1192s
     0     0 69749.8963    0  403 51593.2323 69749.8963  35.2%     - 1194s
     0     0 69660.4819    0  396 51593.2323 69660.4819  35.0%     - 1213s
H    0     0                    51744.192434 69658.9611  34.6%     - 1214s
H    0     0                    52121.425136 69658.9611  33.6%     - 1214s
     0     0 69633.0669    0  386 52121.4251 69633.0669  33.6%     - 1226s
     0     0 69620.7131    0  401 52121.4251 69620.7131  33.6%     - 1234s
     0     0 69609.7241    0  404 52121.4251 69609.7241  33.6%     - 1241s
     0     0 69603.2038    0  401 52121.4251 69603.2038  33.5%     - 1247s
     0     0 69598.5492    0  399 52121.4251 69598.5492  33.5%     - 1251s
     0     0 69594.8801    0  396 52121.4251 69594.8801  33.5%     - 1253s
     0     0 69593.9312    0  399 52121.4251 69593.9312  33.5%     - 1255s
     0     0 69573.3356    0  408 52121.4251 69573.3356  33.5%     - 1268s
H    0     0                    52125.466531 69573.2670  33.5%     - 1290s
H    0     0                    52252.531802 69573.2670  33.1%     - 1290s
     0     0 69552.2756    0  406 52252.5318 69552.2756  33.1%     - 1298s
     0     0 69549.0747    0  412 52252.5318 69549.0747  33.1%     - 1301s
     0     0 69547.8150    0  415 52252.5318 69547.8150  33.1%     - 1303s
     0     0 69523.1271    0  410 52252.5318 69523.1271  33.1%     - 1313s
     0     0 69498.7407    0  401 52252.5318 69498.7407  33.0%     - 1325s
     0     0 69492.6503    0  405 52252.5318 69492.6503  33.0%     - 1330s
     0     0 69490.9183    0  415 52252.5318 69490.9183  33.0%     - 1333s
     0     0 69485.2795    0  409 52252.5318 69485.2795  33.0%     - 1340s
     0     0 69481.8728    0  412 52252.5318 69481.8728  33.0%     - 1350s
     0     0 69480.9891    0  416 52252.5318 69480.9891  33.0%     - 1353s
     0     0 69470.5114    0  352 52252.5318 69470.5114  33.0%     - 1361s
     0     0 69465.4075    0  408 52252.5318 69465.4075  32.9%     - 1367s
     0     0 69461.3501    0  352 52252.5318 69461.3501  32.9%     - 1370s
     0     0 69460.7730    0  406 52252.5318 69460.7730  32.9%     - 1372s
     0     0 69459.8296    0  403 52252.5318 69459.8296  32.9%     - 1375s
H    0     0                    52478.722609 69459.6208  32.4%     - 1383s
     0     0 69459.3138    0  400 52478.7226 69459.3138  32.4%     - 1388s
     0     0 69458.7165    0  400 52478.7226 69458.7165  32.4%     - 1392s
H    0     0                    52650.145059 69458.7133  31.9%     - 1393s
     0     0 69458.4742    0  405 52650.1451 69458.4742  31.9%     - 1394s
     0     0 69447.8709    0  405 52650.1451 69447.8709  31.9%     - 1403s
     0     0 69447.5341    0  405 52650.1451 69447.5341  31.9%     - 1407s
H    0     0                    52668.607942 69447.5341  31.9%     - 1524s
H    0     0                    52770.473613 69447.5236  31.6%     - 1706s
H    0     0                    52940.616443 69447.5236  31.2%     - 1720s
H    0     0                    53105.236664 69447.5236  30.8%     - 1732s
H    0     0                    53273.625299 69447.5236  30.4%     - 1732s
     0     2 69447.5236    0  405 53273.6253 69447.5236  30.4%     - 2176s
     1     4 69427.6494    1  393 53273.6253 69447.2116  30.4%  2191 2196s
     3     8 69174.9866    2  389 53273.6253 69426.9176  30.3%  9285 2240s
     7    16 69018.8868    3  389 53273.6253 69174.4814  29.8% 13970 2293s
    15    32 68683.2341    4  355 53273.6253 69018.7740  29.6% 15591 2342s
    31    47 68465.9812    5  417 53273.6253 68811.2261  29.2% 22340 3600s

Cutting planes:
  Gomory: 21
  Implied bound: 141
  MIR: 2669
  Flow cover: 2579
  RLT: 34
  Relax-and-lift: 396

Explored 46 nodes (1673401 simplex iterations) in 3600.20 seconds (4930.72 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53273.6 53105.2 52940.6 ... 52121.4

Time limit reached
Best objective 5.327362529869e+04, best bound 6.881122609635e+04, gap 29.1657%
  WARNING: Time limit reached. Using best solution found (gap: 29.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 53273.63, θ = 214625.93
  Upper Bound (UB) = 53273.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214625.93
  [DEBUG]   ✓ Scenario 0: θ = 214625.93 ≤ Q = 214625.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 214625.93 ≤ Q = 214625.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 214625.93 ≤ Q = 214625.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 214625.93 ≤ Q = 214625.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 214625.93 ≤ Q = 214625.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 214625.93 ≤ Q = 214625.93 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x45c73d2d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x45c73d2d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.373234e+13
Presolve removed 2567 rows and 1856 columns
Presolve time: 0.01s
Presolved: 526 rows, 533 columns, 1486 nonzeros
Found heuristic solution: objective 6711421.2114
Variable types: 361 continuous, 172 integer (172 binary)
Found heuristic solution: objective 6710643.4652

Root relaxation: objective -1.973055e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -197305.46    0  127 6710643.47 -197305.46   103%     -    0s
H    0     0                    -163782.5775 -197305.46  20.5%     -    0s
H    0     0                    -164062.3302 -197305.46  20.3%     -    0s
H    0     0                    -164218.1284 -197305.46  20.1%     -    0s
H    0     0                    -164483.1612 -197197.71  19.9%     -    0s
     0     0 -174284.18    0   69 -164483.16 -174284.18  5.96%     -    0s
H    0     0                    -172565.4799 -174208.28  0.95%     -    0s
     0     0 -174038.47    0   51 -172565.48 -174038.47  0.85%     -    0s
     0     0 -173430.59    0   52 -172565.48 -173430.59  0.50%     -    0s
H    0     0                    -173251.5042 -173429.37  0.10%     -    0s
     0     0 -173292.52    0    9 -173251.50 -173292.52  0.02%     -    0s
     0     0 -173269.62    0    6 -173251.50 -173269.62  0.01%     -    0s

Cutting planes:
  Gomory: 34
  MIR: 151
  Flow cover: 5
  RLT: 45
  Relax-and-lift: 4
  BQP: 2

Explored 1 nodes (515 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -173252 -172565 -164483 ... 1.37323e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.732515042103e+05, best bound -1.732624779277e+05, gap 0.0063%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 203428.57
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -173251.50
  [DEBUG]   S×d_nominal = 376680.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 376680.08 + -173251.50 = 203428.57
  [DEBUG]   Current θ from Master = 214625.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11197.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 42076.27
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 3109.5175, Absolute Gap = 3109.5175, Relative Gap = 0.058369
  Not converged yet (gap = 3109.52 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697551 nonzeros
Model fingerprint: 0x829414f4
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101808 rows and 41328 columns (presolve time = 5s)...
Presolve removed 101808 rows and 41328 columns
Presolve time: 6.76s
Presolved: 144215 rows, 60772 columns, 886704 nonzeros
Variable types: 58513 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.85s

Barrier statistics:
 Dense cols : 725
 AA' NZ     : 6.366e+06
 Factor NZ  : 1.449e+07 (roughly 200 MB of memory)
 Factor Ops : 3.303e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.37896626e+07  2.74880930e+08  1.78e+05 1.69e+01  1.12e+05    11s
   1  -1.88384316e+07  2.62809850e+08  1.30e+05 1.06e+02  8.12e+04    11s
   2  -8.22937713e+06  2.16587874e+08  5.37e+04 2.56e+01  3.51e+04    11s
   3  -1.89536776e+06  1.58876663e+08  8.88e+03 3.04e+00  6.19e+03    11s
   4  -8.70183735e+05  1.02723615e+08  1.82e+03 5.63e-01  1.46e+03    11s
   5  -6.72081864e+05  4.09560263e+07  6.13e+02 1.59e-01  4.73e+02    11s
   6  -5.22119567e+05  3.03874102e+07  2.36e+02 1.08e-01  2.32e+02    11s
   7  -3.73062844e+05  2.17678401e+07  1.07e+02 6.94e-02  1.31e+02    11s
   8  -2.45635486e+05  1.37249338e+07  4.51e+01 3.77e-02  6.94e+01    12s
   9  -1.66141163e+05  9.85271687e+06  2.03e+01 2.46e-02  4.40e+01    12s
  10  -1.28839385e+05  6.07202236e+06  1.09e+01 1.41e-02  2.57e+01    12s
  11  -1.00492331e+05  3.25272354e+06  5.47e+00 7.21e-03  1.34e+01    12s
  12  -7.47817738e+04  1.17510797e+06  2.81e+00 2.45e-03  4.88e+00    12s
  13  -5.10286526e+04  5.25569890e+05  1.65e+00 1.10e-03  2.23e+00    12s
  14  -3.97627505e+03  3.16273036e+05  7.22e-01 7.88e-04  1.23e+00    12s
  15   1.12727038e+04  2.38206129e+05  5.62e-01 1.05e-03  8.71e-01    12s
  16   2.98882650e+04  1.74800380e+05  4.06e-01 2.10e-03  5.56e-01    13s
  17   3.92811929e+04  1.58063742e+05  3.28e-01 1.72e-03  4.56e-01    13s
  18   4.23492859e+04  1.44539450e+05  3.02e-01 1.60e-03  3.92e-01    13s
  19   4.26986854e+04  1.41706812e+05  2.99e-01 1.51e-03  3.80e-01    13s
  20   4.45193711e+04  1.36447738e+05  2.85e-01 1.50e-03  3.53e-01    13s
  21   5.38494137e+04  1.23385477e+05  2.10e-01 1.24e-03  2.67e-01    13s
  22   6.00530450e+04  1.10311472e+05  1.63e-01 2.35e-03  1.93e-01    13s
  23   6.51049676e+04  1.02289972e+05  1.27e-01 1.98e-03  1.43e-01    13s
  24   6.82714737e+04  1.00231890e+05  1.07e-01 1.68e-03  1.23e-01    14s
  25   7.20053590e+04  9.63368966e+04  8.32e-02 1.47e-03  9.34e-02    14s
  26   7.48138217e+04  9.33916897e+04  6.65e-02 1.99e-03  7.14e-02    14s
  27   7.89766821e+04  9.13509097e+04  4.21e-02 1.56e-03  4.75e-02    14s
  28   8.02264876e+04  9.00728020e+04  3.51e-02 1.66e-03  3.78e-02    14s
  29   8.23871187e+04  8.90261372e+04  2.29e-02 1.10e-03  2.55e-02    14s
  30   8.40364998e+04  8.82853946e+04  1.41e-02 6.84e-04  1.63e-02    14s
  31   8.51245902e+04  8.80142616e+04  8.46e-03 5.51e-04  1.11e-02    15s
  32   8.54602630e+04  8.79560800e+04  6.74e-03 5.23e-04  9.56e-03    15s
  33   8.57829444e+04  8.76196999e+04  5.13e-03 3.89e-04  7.04e-03    15s
  34   8.62701128e+04  8.73805097e+04  2.74e-03 2.51e-04  4.25e-03    15s
  35   8.63937449e+04  8.72270400e+04  2.19e-03 3.08e-04  3.19e-03    15s
  36   8.64770529e+04  8.71300067e+04  1.81e-03 2.20e-04  2.50e-03    15s
  37   8.67280708e+04  8.70588718e+04  6.31e-04 1.54e-04  1.26e-03    15s
  38   8.68204036e+04  8.69299211e+04  2.31e-04 4.16e-05  4.19e-04    16s
  39   8.68652776e+04  8.69176133e+04  4.93e-05 3.10e-05  1.99e-04    16s
  40   8.68681125e+04  8.68977383e+04  3.97e-05 1.44e-05  1.13e-04    16s
  41   8.68704256e+04  8.68961924e+04  3.20e-05 1.31e-05  9.83e-05    16s
  42   8.68752620e+04  8.68853729e+04  1.39e-05 4.20e-06  3.86e-05    16s
  43   8.68775657e+04  8.68820534e+04  6.82e-06 1.50e-06  1.71e-05    16s
  44   8.68797737e+04  8.68811869e+04  1.65e-07 8.62e-07  5.37e-06    17s
  45   8.68799843e+04  8.68803395e+04  3.79e-08 2.30e-07  1.35e-06    17s
  46   8.68800167e+04  8.68801982e+04  5.96e-09 1.45e-07  6.90e-07    17s
  47   8.68800207e+04  8.68800558e+04  2.29e-09 3.50e-08  1.33e-07    17s
  48   8.68800207e+04  8.68800557e+04  4.74e-08 6.82e-08  1.33e-07    18s
  49   8.68800208e+04  8.68800556e+04  5.15e-08 5.91e-06  1.32e-07    18s
  50   8.68800213e+04  8.68800555e+04  1.12e-07 6.87e-06  1.30e-07    18s
  51   8.68800213e+04  8.68800289e+04  5.61e-08 7.21e-06  2.88e-08    19s
  52   8.68800213e+04  8.68800287e+04  1.61e-07 7.03e-06  2.80e-08    19s
  53   8.68800213e+04  8.68800287e+04  1.49e-07 7.02e-06  2.80e-08    19s
  54   8.68800171e+04  8.68800285e+04  3.60e-07 6.86e-06  4.39e-08    20s
  55   8.68800192e+04  8.68800235e+04  2.15e-07 1.37e-05  1.74e-08    20s
  56   8.68800211e+04  8.68800219e+04  9.57e-07 1.02e-06  3.15e-09    20s

Barrier solved model in 56 iterations and 20.21 seconds (17.16 work units)
Optimal objective 8.68800211e+04


Root crossover log...

  129305 DPushes remaining with DInf 0.0000000e+00                20s
   25363 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                29s

   23142 PPushes remaining with PInf 4.2410738e-04                29s
   11859 PPushes remaining with PInf 3.6257453e-04                30s
       0 PPushes remaining with PInf 0.0000000e+00                32s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6760735e+04     32s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   96518    8.6880022e+04   0.000000e+00   1.676074e+04     32s
   96878    8.6880022e+04   0.000000e+00   0.000000e+00     32s
   96878    8.6880022e+04   0.000000e+00   0.000000e+00     32s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.688002e+04, 96878 iterations, 24.65 seconds (28.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86880.0218    0  156 -203987.28 86880.0218   143%     -   33s
H    0     0                    -203348.9007 86880.0218   143%     -   35s
H    0     0                    -202437.0569 86880.0218   143%     -   37s
H    0     0                    -202210.6047 86880.0218   143%     -   37s
H    0     0                    -199749.2670 86880.0218   143%     -   37s
H    0     0                    -199321.4169 86880.0218   144%     -   37s
H    0     0                    -198972.1764 86880.0218   144%     -   37s
H    0     0                    -198462.6818 86880.0218   144%     -   37s
H    0     0                    -49387.98311 86880.0218   276%     -   37s
H    0     0                    24268.583701 86880.0218   258%     -   38s
H    0     0                    36442.633732 86880.0218   138%     -   39s
H    0     0                    36872.159651 86880.0218   136%     -   39s
H    0     0                    44774.301158 86880.0218  94.0%     -   40s
H    0     0                    47540.979017 86880.0218  82.7%     -   40s
H    0     0                    47550.012488 86880.0218  82.7%     -   41s
H    0     0                    49783.650261 86880.0218  74.5%     -   41s
H    0     0                    50761.043308 86880.0218  71.2%     -   41s
H    0     0                    50908.294666 86880.0218  70.7%     -   41s
     0     0 80241.4550    0  173 50908.2947 80241.4550  57.6%     -  226s
H    0     0                    51023.216532 80241.2178  57.3%     -  228s
H    0     0                    51480.157419 80241.2178  55.9%     -  228s
H    0     0                    51480.378707 80241.2178  55.9%     -  228s
H    0     0                    51630.150814 80241.2178  55.4%     -  228s
     0     0 79603.9973    0  196 51630.1508 79603.9973  54.2%     -  289s
     0     0 79564.7112    0  189 51630.1508 79564.7112  54.1%     -  305s
     0     0 79520.5246    0  190 51630.1508 79520.5246  54.0%     -  321s
     0     0 79517.5683    0  196 51630.1508 79517.5683  54.0%     -  328s
     0     0 79490.5072    0  199 51630.1508 79490.5072  54.0%     -  336s
     0     0 79488.4246    0  197 51630.1508 79488.4246  54.0%     -  339s
     0     0 79487.7399    0  197 51630.1508 79487.7399  54.0%     -  340s
     0     0 76437.8082    0  211 51630.1508 76437.8082  48.0%     -  439s
H    0     0                    51821.447200 76437.7721  47.5%     -  440s
H    0     0                    51916.176751 76437.7721  47.2%     -  466s
     0     0 76061.0685    0  254 51916.1768 76061.0685  46.5%     -  529s
     0     0 75932.9997    0  222 51916.1768 75932.9997  46.3%     -  553s
     0     0 75720.4883    0  235 51916.1768 75720.4883  45.9%     -  588s
     0     0 75678.2772    0  240 51916.1768 75678.2772  45.8%     -  601s
     0     0 75575.7913    0  246 51916.1768 75575.7913  45.6%     -  633s
     0     0 75317.6732    0  257 51916.1768 75317.6732  45.1%     -  672s
     0     0 75245.3671    0  284 51916.1768 75245.3671  44.9%     -  703s
     0     0 75238.1429    0  259 51916.1768 75238.1429  44.9%     -  712s
     0     0 75228.8070    0  281 51916.1768 75228.8070  44.9%     -  724s
     0     0 75210.3719    0  273 51916.1768 75210.3719  44.9%     -  739s
     0     0 75203.0796    0  255 51916.1768 75203.0796  44.9%     -  745s
     0     0 75192.0117    0  249 51916.1768 75192.0117  44.8%     -  752s
     0     0 75190.9704    0  253 51916.1768 75190.9704  44.8%     -  754s
     0     0 72874.9588    0  271 51916.1768 72874.9588  40.4%     -  913s
     0     0 72289.1553    0  291 51916.1768 72289.1553  39.2%     -  983s
     0     0 72145.4451    0  298 51916.1768 72145.4451  39.0%     - 1015s
     0     0 72044.6837    0  298 51916.1768 72044.6837  38.8%     - 1038s
     0     0 72008.2995    0  297 51916.1768 72008.2995  38.7%     - 1050s
     0     0 72000.7040    0  299 51916.1768 72000.7040  38.7%     - 1056s
     0     0 71993.2736    0  295 51916.1768 71993.2736  38.7%     - 1060s
     0     0 71678.7307    0  303 51916.1768 71678.7307  38.1%     - 1091s
     0     0 71538.7178    0  317 51916.1768 71538.7178  37.8%     - 1127s
     0     0 71505.5885    0  323 51916.1768 71505.5885  37.7%     - 1138s
     0     0 71485.1513    0  317 51916.1768 71485.1513  37.7%     - 1152s
     0     0 71481.2579    0  316 51916.1768 71481.2579  37.7%     - 1159s
     0     0 71472.2672    0  314 51916.1768 71472.2672  37.7%     - 1167s
     0     0 71460.8288    0  323 51916.1768 71460.8288  37.6%     - 1170s
     0     0 71437.3555    0  313 51916.1768 71437.3555  37.6%     - 1181s
     0     0 71427.9208    0  314 51916.1768 71427.9208  37.6%     - 1189s
     0     0 71425.1157    0  314 51916.1768 71425.1157  37.6%     - 1192s
     0     0 71406.0261    0  317 51916.1768 71406.0261  37.5%     - 1207s
     0     0 71400.9843    0  324 51916.1768 71400.9843  37.5%     - 1213s
     0     0 71398.5882    0  317 51916.1768 71398.5882  37.5%     - 1215s
     0     0 71392.4947    0  319 51916.1768 71392.4947  37.5%     - 1221s
     0     0 71390.3444    0  319 51916.1768 71390.3444  37.5%     - 1224s
     0     0 71389.9389    0  322 51916.1768 71389.9389  37.5%     - 1227s
     0     0 70589.8094    0  381 51916.1768 70589.8094  36.0%     - 1328s
     0     0 70380.7100    0  368 51916.1768 70380.7100  35.6%     - 1378s
     0     0 70316.5054    0  389 51916.1768 70316.5054  35.4%     - 1399s
     0     0 70283.4602    0  389 51916.1768 70283.4602  35.4%     - 1412s
     0     0 70258.0988    0  391 51916.1768 70258.0988  35.3%     - 1422s
     0     0 70251.9717    0  393 51916.1768 70251.9717  35.3%     - 1426s
     0     0 70236.9660    0  393 51916.1768 70236.9660  35.3%     - 1434s
     0     0 70197.6811    0  398 51916.1768 70197.6811  35.2%     - 1448s
     0     0 70189.7873    0  397 51916.1768 70189.7873  35.2%     - 1456s
     0     0 70185.1902    0  397 51916.1768 70185.1902  35.2%     - 1463s
     0     0 70167.0794    0  401 51916.1768 70167.0794  35.2%     - 1468s
     0     0 70160.8003    0  399 51916.1768 70160.8003  35.1%     - 1471s
     0     0 70158.4966    0  404 51916.1768 70158.4966  35.1%     - 1474s
     0     0 70155.7312    0  402 51916.1768 70155.7312  35.1%     - 1476s
     0     0 70154.8575    0  403 51916.1768 70154.8575  35.1%     - 1478s
     0     0 69970.4753    0  381 51916.1768 69970.4753  34.8%     - 1508s
H    0     0                    52041.189530 69968.3573  34.4%     - 1510s
     0     0 69921.4520    0  400 52041.1895 69921.4520  34.4%     - 1524s
     0     0 69886.4096    0  394 52041.1895 69886.4096  34.3%     - 1535s
     0     0 69867.5273    0  410 52041.1895 69867.5273  34.3%     - 1544s
     0     0 69848.2097    0  385 52041.1895 69848.2097  34.2%     - 1552s
     0     0 69841.8063    0  397 52041.1895 69841.8063  34.2%     - 1556s
     0     0 69830.3789    0  403 52041.1895 69830.3789  34.2%     - 1563s
     0     0 69827.0670    0  404 52041.1895 69827.0670  34.2%     - 1567s
     0     0 69825.3284    0  400 52041.1895 69825.3284  34.2%     - 1568s
     0     0 69725.4577    0  400 52041.1895 69725.4577  34.0%     - 1586s
     0     0 69690.8480    0  414 52041.1895 69690.8480  33.9%     - 1597s
     0     0 69677.2795    0  404 52041.1895 69677.2795  33.9%     - 1602s
     0     0 69671.2302    0  411 52041.1895 69671.2302  33.9%     - 1605s
     0     0 69665.6406    0  402 52041.1895 69665.6406  33.9%     - 1609s
     0     0 69663.4797    0  403 52041.1895 69663.4797  33.9%     - 1612s
     0     0 69561.0570    0  418 52041.1895 69561.0570  33.7%     - 1641s
     0     0 69545.3435    0  417 52041.1895 69545.3435  33.6%     - 1652s
     0     0 69540.0037    0  412 52041.1895 69540.0037  33.6%     - 1655s
     0     0 69536.3844    0  407 52041.1895 69536.3844  33.6%     - 1660s
     0     0 69535.1103    0  414 52041.1895 69535.1103  33.6%     - 1662s
     0     0 69515.3299    0  409 52041.1895 69515.3299  33.6%     - 1673s
     0     0 69507.4409    0  407 52041.1895 69507.4409  33.6%     - 1682s
     0     0 69504.9105    0  406 52041.1895 69504.9105  33.6%     - 1686s
     0     0 69502.0548    0  413 52041.1895 69502.0548  33.6%     - 1688s
     0     0 69501.2942    0  412 52041.1895 69501.2942  33.6%     - 1690s
     0     0 69481.5375    0  402 52041.1895 69481.5375  33.5%     - 1701s
     0     0 69478.0673    0  352 52041.1895 69478.0673  33.5%     - 1706s
     0     0 69476.0014    0  399 52041.1895 69476.0014  33.5%     - 1710s
     0     0 69472.4804    0  398 52041.1895 69472.4804  33.5%     - 1716s
     0     0 69471.6707    0  396 52041.1895 69471.6707  33.5%     - 1718s
     0     0 69461.7810    0  402 52041.1895 69461.7810  33.5%     - 1723s
     0     0 69459.5141    0  397 52041.1895 69459.5141  33.5%     - 1725s
     0     0 69459.0912    0  397 52041.1895 69459.0912  33.5%     - 1730s
     0     0 69459.0206    0  397 52041.1895 69459.0206  33.5%     - 1735s
H    0     0                    52064.354174 69459.0206  33.4%     - 1878s
H    0     0                    52140.508870 69459.0206  33.2%     - 1878s
H    0     0                    52270.507810 69459.0206  32.9%     - 2023s
     0     2 69459.0206    0  397 52270.5078 69459.0206  32.9%     - 2027s
     1     3 68996.9946    1  382 52270.5078 69454.7608  32.9% 13680 2060s
     2     4 69354.8249    1  393 52270.5078 69354.8249  32.7% 11694 2082s
     3     5 68477.6235    2  329 52270.5078 69354.3440  32.7% 12025 2109s
     4    10 68127.3469    3  333 52270.5078 69354.3440  32.7% 11811 2134s
     9    19 67873.7596    4  316 52270.5078 69215.2882  32.4% 10328 2185s
    18    38 67845.2381    5  318 52270.5078 69141.7986  32.3% 12364 2221s
    37    51 68627.1211    5  352 52270.5078 68912.5183  31.8% 17049 2312s
    50    75 68005.8022    6  384 52270.5078 68912.5183  31.8% 19151 2403s
H   72    75                    52289.340483 68912.5183  31.8% 17255 2403s
    74   165 67800.3145    7  394 52289.3405 68912.5183  31.8% 17296 2486s
   164   218 67476.1741   11  366 52289.3405 68912.5183  31.8% 13512 2547s
H  186   218                    52544.612330 68912.5183  31.2% 12353 2547s
   217   263 67452.2441   13  361 52544.6123 68912.5183  31.2% 11643 2608s
   262   294 62560.4759   14  254 52544.6123 68912.5183  31.2% 10645 2664s
   293   334 67148.7736   15  309 52544.6123 68912.5183  31.2% 10327 2716s
   333   383 66875.1827   17  338 52544.6123 68912.5183  31.2%  9854 2774s
   382   417 66813.8706   18  298 52544.6123 68912.5183  31.2%  9509 2850s
   416   473 66774.9602   19  297 52544.6123 68912.5183  31.2%  9378 2911s
   472   503 66632.5466   21  297 52544.6123 68912.5183  31.2%  8911 2995s
   502   528 66379.8552   22  293 52544.6123 68912.5183  31.2%  8830 3103s
   527   554 66151.9791   23  291 52544.6123 68912.5183  31.2%  8904 3197s
   553   584 65805.9392   24  275 52544.6123 68912.5183  31.2%  8898 3290s
   583   614 65139.4896   25  266 52544.6123 68912.5183  31.2%  9008 3335s
   613   645 64996.3673   26  261 52544.6123 68912.5183  31.2%  9281 3388s
   644   674 64916.9085   27  294 52544.6123 68912.5183  31.2%  9158 3439s
   673   706 64386.6169   28  263 52544.6123 68912.5183  31.2%  9057 3487s
   705   734 64336.9222   29  257 52544.6123 68912.5183  31.2%  8972 3534s
   738   762 64334.8582   30  256 52544.6123 68912.5183  31.2%  8786 3593s
   770   771 55891.2663   29  160 52544.6123 68912.5183  31.2%  8682 3600s

Cutting planes:
  Learned: 1
  Gomory: 16
  Implied bound: 167
  MIR: 2857
  Flow cover: 2997
  RLT: 32
  Relax-and-lift: 437

Explored 779 nodes (7469135 simplex iterations) in 3600.08 seconds (4822.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52544.6 52289.3 52270.5 ... 51480.4

Time limit reached
Best objective 5.254461233046e+04, best bound 6.891251825591e+04, gap 31.1505%
  WARNING: Time limit reached. Using best solution found (gap: 31.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 52544.61, θ = 217017.07
  Upper Bound (UB) = 52544.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 217017.07
  [DEBUG]   ✓ Scenario 0: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 217017.07 ≤ Q = 217017.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 217017.07 ≤ Q = 217017.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 217017.07 ≤ Q = 217017.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 217017.07 ≤ Q = 217017.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 217017.07 ≤ Q = 217017.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 217017.07 ≤ Q = 217017.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 217017.07 ≤ Q = 217017.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 217017.07 ≤ Q = 217017.07 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x459b9432
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xba646bce
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.386784e+13
Presolve removed 2554 rows and 1845 columns
Presolve time: 0.01s
Presolved: 539 rows, 544 columns, 1524 nonzeros
Found heuristic solution: objective 6806712.1342
Variable types: 370 continuous, 174 integer (174 binary)

Root relaxation: objective -1.894304e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189430.36    0  124 6806712.13 -189430.36   103%     -    0s
H    0     0                    -152301.6339 -189430.36  24.4%     -    0s
H    0     0                    -152779.7271 -189430.36  24.0%     -    0s
H    0     0                    -155509.3543 -189430.36  21.8%     -    0s
     0     0 -165799.54    0  137 -155509.35 -165799.54  6.62%     -    0s
H    0     0                    -161637.3756 -165751.09  2.55%     -    0s
     0     0 -164484.30    0  101 -161637.38 -164484.30  1.76%     -    0s
H    0     0                    -163394.7585 -164482.68  0.67%     -    0s
H    0     0                    -163412.6096 -164482.68  0.65%     -    0s
H    0     0                    -163671.5964 -164482.68  0.50%     -    0s
     0     0 -164238.10    0   17 -163671.60 -164238.10  0.35%     -    0s
H    0     0                    -164153.6546 -164236.58  0.05%     -    0s
     0     0 -164200.72    0   14 -164153.65 -164200.72  0.03%     -    0s
     0     0 -164195.47    0    7 -164153.65 -164195.47  0.03%     -    0s
     0     0 -164187.29    0    6 -164153.65 -164187.29  0.02%     -    0s
     0     0 -164187.29    0   35 -164153.65 -164187.29  0.02%     -    0s
     0     0 -164187.29    0   35 -164153.65 -164187.29  0.02%     -    0s
H    0     0                    -164158.6697 -164187.29  0.02%     -    0s
H    0     0                    -164166.8098 -164185.44  0.01%     -    0s
     0     0 -164185.44    0    2 -164166.81 -164185.44  0.01%     -    0s
H    0     0                    -164183.4597 -164183.46  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 30
  Flow cover: 3

Explored 1 nodes (740 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -164183 -164167 -164159 ... -155509
No other solutions better than -164183

Optimal solution found (tolerance 1.00e-04)
Best objective -1.641834596739e+05, best bound -1.641834596739e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 209082.91
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -164183.46
  [DEBUG]   S×d_nominal = 373266.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373266.37 + -164183.46 = 209082.91
  [DEBUG]   Current θ from Master = 217017.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7934.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44610.45
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 2380.5046, Absolute Gap = 2380.5046, Relative Gap = 0.045304
  Not converged yet (gap = 2380.50 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740803 nonzeros
Model fingerprint: 0x6e6b5f1f
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 108171 rows and 43911 columns (presolve time = 5s)...
Presolve removed 108171 rows and 43911 columns
Presolve time: 5.14s
Presolved: 153142 rows, 64429 columns, 941717 nonzeros
Variable types: 62170 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.62s

Barrier statistics:
 Dense cols : 725
 AA' NZ     : 7.102e+06
 Factor NZ  : 1.650e+07 (roughly 200 MB of memory)
 Factor Ops : 4.127e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.44695093e+07  2.88956212e+08  1.83e+05 1.68e+01  1.14e+05     8s
   1  -1.94422461e+07  2.77422761e+08  1.33e+05 1.09e+02  8.30e+04     8s
   2  -9.63852573e+06  2.32398847e+08  6.21e+04 3.32e+01  4.01e+04     9s
   3  -2.28178242e+06  1.72520986e+08  1.14e+04 2.58e+00  7.79e+03     9s
   4  -9.13454362e+05  1.21576396e+08  2.04e+03 4.22e-01  1.65e+03     9s
   5  -6.86571821e+05  5.59975756e+07  6.14e+02 1.09e-01  5.23e+02     9s
   6  -6.04297690e+05  3.64997735e+07  3.15e+02 6.44e-02  2.85e+02     9s
   7  -4.70136309e+05  2.58916579e+07  1.19e+02 4.17e-02  1.47e+02     9s
   8  -3.16167062e+05  1.80862213e+07  4.11e+01 2.65e-02  8.15e+01     9s
   9  -1.76329090e+05  1.16939470e+07  1.56e+01 1.61e-02  4.70e+01    10s
  10  -1.45073308e+05  7.22000118e+06  1.06e+01 9.41e-03  2.85e+01    10s
  11  -1.12977556e+05  4.71561048e+06  5.14e+00 5.99e-03  1.80e+01    10s
  12  -7.83368090e+04  1.80010268e+06  2.07e+00 2.21e-03  6.85e+00    10s
  13  -4.73040368e+04  6.01663414e+05  9.44e-01 8.06e-04  2.35e+00    10s
  14  -2.31067246e+03  3.53215037e+05  4.30e-01 1.13e-03  1.28e+00    10s
  15   1.32483144e+04  2.54105726e+05  3.44e-01 6.84e-04  8.67e-01    10s
  16   2.62375767e+04  1.85419388e+05  2.80e-01 2.10e-03  5.73e-01    11s
  17   3.73575508e+04  1.59834577e+05  2.22e-01 2.04e-03  4.41e-01    11s
  18   4.11491499e+04  1.48557401e+05  2.01e-01 1.71e-03  3.87e-01    11s
  19   5.22354309e+04  1.38918736e+05  1.44e-01 1.50e-03  3.12e-01    11s
  20   5.47105662e+04  1.20374655e+05  1.31e-01 1.70e-03  2.37e-01    11s
  21   5.94704606e+04  1.12388847e+05  1.08e-01 1.49e-03  1.91e-01    11s
  22   6.43828903e+04  1.06835412e+05  8.55e-02 1.26e-03  1.53e-01    12s
  23   6.92520105e+04  1.03198191e+05  6.45e-02 1.54e-03  1.22e-01    12s
  24   7.27854118e+04  9.84652109e+04  4.97e-02 1.81e-03  9.25e-02    12s
  25   7.55289313e+04  9.50858274e+04  3.89e-02 1.68e-03  7.05e-02    12s
  26   7.81500804e+04  9.21973504e+04  2.92e-02 1.14e-03  5.06e-02    12s
  27   7.93129742e+04  9.04274548e+04  2.50e-02 7.33e-04  4.01e-02    12s
  28   8.05687592e+04  8.94025871e+04  2.07e-02 5.26e-04  3.19e-02    13s
  29   8.28993562e+04  8.87449812e+04  1.28e-02 4.51e-04  2.11e-02    13s
  30   8.40804936e+04  8.83930704e+04  8.83e-03 3.67e-04  1.55e-02    13s
  31   8.48843190e+04  8.76568695e+04  6.17e-03 1.95e-04  1.00e-02    13s
  32   8.53863419e+04  8.73687925e+04  4.55e-03 3.11e-04  7.15e-03    13s
  33   8.57955814e+04  8.72499406e+04  3.30e-03 2.32e-04  5.24e-03    14s
  34   8.61689952e+04  8.71389513e+04  2.12e-03 1.59e-04  3.50e-03    14s
  35   8.62600125e+04  8.70472669e+04  1.85e-03 9.91e-05  2.84e-03    14s
  36   8.64519383e+04  8.70130284e+04  1.25e-03 7.79e-05  2.02e-03    14s
  37   8.67259478e+04  8.69264862e+04  4.21e-04 2.87e-05  7.23e-04    14s
  38   8.67636810e+04  8.69157452e+04  3.16e-04 2.23e-05  5.48e-04    15s
  39   8.67815289e+04  8.69121816e+04  2.65e-04 2.00e-05  4.71e-04    15s
  40   8.67949141e+04  8.69074100e+04  2.27e-04 1.71e-05  4.05e-04    15s
  41   8.68128633e+04  8.68938723e+04  1.78e-04 8.50e-06  2.92e-04    15s
  42   8.68529461e+04  8.68892338e+04  6.52e-05 6.57e-06  1.31e-04    15s
  43   8.68641931e+04  8.68837649e+04  3.67e-05 2.96e-06  7.05e-05    16s
  44   8.68688760e+04  8.68808825e+04  2.43e-05 1.29e-06  4.33e-05    16s
  45   8.68780955e+04  8.68787910e+04  1.90e-06 1.80e-06  2.51e-06    16s
  46   8.68787378e+04  8.68787449e+04  6.01e-07 1.23e-07  2.56e-08    16s
  47   8.68787419e+04  8.68787422e+04  4.66e-08 4.78e-09  9.61e-10    16s

Barrier solved model in 47 iterations and 16.35 seconds (13.93 work units)
Optimal objective 8.68787419e+04


Root crossover log...

  137368 DPushes remaining with DInf 0.0000000e+00                16s
   31498 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    9294 PPushes remaining with PInf 1.1014213e-04                24s
    4120 PPushes remaining with PInf 3.4336727e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5126465e+02     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   79070    8.6878742e+04   0.000000e+00   4.512647e+02     26s
   79576    8.6878742e+04   0.000000e+00   0.000000e+00     27s
   79576    8.6878742e+04   0.000000e+00   0.000000e+00     27s
Concurrent spin time: 4.33s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.687874e+04, 79576 iterations, 24.88 seconds (27.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86878.7421    0  157 -203987.28 86878.7421   143%     -   32s
H    0     0                    -50240.06432 86878.7421   273%     -   33s
H    0     0                    10210.692240 86878.7421   751%     -   35s
H    0     0                    12928.726819 86878.7421   572%     -   35s
H    0     0                    40995.735392 86878.7421   112%     -   35s
H    0     0                    41349.518480 86878.7421   110%     -   36s
H    0     0                    43430.749799 86878.7421   100%     -   37s
H    0     0                    45065.384849 86878.7421  92.8%     -   37s
H    0     0                    45603.134610 86878.7421  90.5%     -   37s
H    0     0                    46070.361002 86878.7421  88.6%     -   37s
H    0     0                    48434.518158 86878.7421  79.4%     -   37s
H    0     0                    49783.650261 86878.7421  74.5%     -   37s
H    0     0                    50640.931548 86878.7421  71.6%     -   38s
H    0     0                    50778.042513 86878.7421  71.1%     -   38s
H    0     0                    50847.887627 86878.7421  70.9%     -   38s
     0     0 80206.5054    0  174 50847.8876 80206.5054  57.7%     -  272s
H    0     0                    51864.047662 80206.1889  54.6%     -  274s
H    0     0                    52086.785000 80206.1889  54.0%     -  274s
     0     0 79407.3267    0  189 52086.7850 79407.3267  52.5%     -  372s
     0     0 79244.8459    0  187 52086.7850 79244.8459  52.1%     -  402s
     0     0 79140.6209    0  195 52086.7850 79140.6209  51.9%     -  423s
     0     0 79135.1765    0  202 52086.7850 79135.1765  51.9%     -  431s
     0     0 79132.4059    0  203 52086.7850 79132.4059  51.9%     -  436s
     0     0 79127.8115    0  201 52086.7850 79127.8115  51.9%     -  449s
     0     0 79125.3148    0  192 52086.7850 79125.3148  51.9%     -  451s
     0     0 79125.3129    0  192 52086.7850 79125.3129  51.9%     -  452s
     0     0 75867.2138    0  222 52086.7850 75867.2138  45.7%     -  568s
H    0     0                    52136.233346 75867.1700  45.5%     -  570s
H    0     0                    52326.767675 75867.1700  45.0%     -  570s
H    0     0                    52344.928467 75867.1700  44.9%     -  570s
     0     0 75506.5940    0  234 52344.9285 75506.5940  44.2%     -  639s
     0     0 75353.9984    0  239 52344.9285 75353.9984  44.0%     -  686s
     0     0 75300.7879    0  254 52344.9285 75300.7879  43.9%     -  726s
     0     0 75265.2025    0  251 52344.9285 75265.2025  43.8%     -  758s
     0     0 75181.6139    0  250 52344.9285 75181.6139  43.6%     -  802s
     0     0 75102.4958    0  291 52344.9285 75102.4958  43.5%     -  843s
     0     0 75084.5922    0  301 52344.9285 75084.5922  43.4%     -  861s
     0     0 75076.0142    0  294 52344.9285 75076.0142  43.4%     -  878s
     0     0 75071.6868    0  295 52344.9285 75071.6868  43.4%     -  885s
     0     0 75070.7803    0  299 52344.9285 75070.7803  43.4%     -  888s
     0     0 72854.2278    0  302 52344.9285 72854.2278  39.2%     - 1051s
     0     0 72488.9874    0  304 52344.9285 72488.9874  38.5%     - 1112s
     0     0 72339.0693    0  343 52344.9285 72339.0693  38.2%     - 1153s
     0     0 72229.0990    0  314 52344.9285 72229.0990  38.0%     - 1177s
     0     0 72158.1033    0  317 52344.9285 72158.1033  37.9%     - 1195s
     0     0 72129.1143    0  347 52344.9285 72129.1143  37.8%     - 1206s
     0     0 71930.9728    0  302 52344.9285 71930.9728  37.4%     - 1227s
     0     0 71848.9504    0  303 52344.9285 71848.9504  37.3%     - 1250s
     0     0 71781.0231    0  310 52344.9285 71781.0231  37.1%     - 1269s
     0     0 71768.9240    0  309 52344.9285 71768.9240  37.1%     - 1276s
     0     0 71751.7198    0  314 52344.9285 71751.7198  37.1%     - 1283s
     0     0 71727.2681    0  322 52344.9285 71727.2681  37.0%     - 1293s
     0     0 71724.9394    0  328 52344.9285 71724.9394  37.0%     - 1295s
     0     0 71716.8200    0  319 52344.9285 71716.8200  37.0%     - 1299s
     0     0 71709.3900    0  328 52344.9285 71709.3900  37.0%     - 1304s
     0     0 71708.4984    0  329 52344.9285 71708.4984  37.0%     - 1305s
     0     0 70701.6847    0  367 52344.9285 70701.6847  35.1%     - 1393s
     0     0 70303.2698    0  370 52344.9285 70303.2698  34.3%     - 1433s
     0     0 70177.8320    0  379 52344.9285 70177.8320  34.1%     - 1450s
     0     0 70126.4361    0  381 52344.9285 70126.4361  34.0%     - 1468s
     0     0 70105.8927    0  399 52344.9285 70105.8927  33.9%     - 1478s
     0     0 70063.7458    0  398 52344.9285 70063.7458  33.9%     - 1494s
     0     0 70049.9548    0  398 52344.9285 70049.9548  33.8%     - 1498s
     0     0 70032.4514    0  400 52344.9285 70032.4514  33.8%     - 1503s
     0     0 70030.3824    0  397 52344.9285 70030.3824  33.8%     - 1507s
     0     0 69790.9391    0  352 52344.9285 69790.9391  33.3%     - 1546s
     0     0 69753.4130    0  358 52344.9285 69753.4130  33.3%     - 1559s
     0     0 69734.2123    0  359 52344.9285 69734.2123  33.2%     - 1572s
     0     0 69710.3290    0  368 52344.9285 69710.3290  33.2%     - 1581s
     0     0 69707.3873    0  367 52344.9285 69707.3873  33.2%     - 1583s
     0     0 69691.8464    0  367 52344.9285 69691.8464  33.1%     - 1588s
     0     0 69681.9049    0  411 52344.9285 69681.9049  33.1%     - 1597s
     0     0 69680.5792    0  407 52344.9285 69680.5792  33.1%     - 1600s
     0     0 69565.8911    0  354 52344.9285 69565.8911  32.9%     - 1627s
H    0     0                    52411.685138 69565.8768  32.7%     - 1643s
     0     0 69539.0518    0  413 52411.6851 69539.0518  32.7%     - 1662s
     0     0 69518.7132    0  402 52411.6851 69518.7132  32.6%     - 1670s
     0     0 69510.8061    0  408 52411.6851 69510.8061  32.6%     - 1674s
     0     0 69502.4688    0  351 52411.6851 69502.4688  32.6%     - 1680s
     0     0 69496.5047    0  389 52411.6851 69496.5047  32.6%     - 1690s
     0     0 69495.0627    0  396 52411.6851 69495.0627  32.6%     - 1693s
     0     0 69456.0058    0  354 52411.6851 69456.0058  32.5%     - 1708s
H    0     0                    52509.499545 69455.3913  32.3%     - 1710s
H    0     0                    52575.604992 69455.3913  32.1%     - 1710s
     0     0 69426.7070    0  364 52575.6050 69426.7070  32.1%     - 1724s
     0     0 69420.7471    0  368 52575.6050 69420.7471  32.0%     - 1733s
     0     0 69419.5545    0  362 52575.6050 69419.5545  32.0%     - 1736s
     0     0 69402.7375    0  400 52575.6050 69402.7375  32.0%     - 1747s
H    0     0                    52766.047398 69401.6075  31.5%     - 1751s
H    0     0                    52770.898358 69401.6075  31.5%     - 1752s
H    0     0                    52860.627201 69401.6075  31.3%     - 1752s
     0     0 69398.5989    0  404 52860.6272 69398.5989  31.3%     - 1757s
     0     0 69397.6915    0  409 52860.6272 69397.6915  31.3%     - 1759s
     0     0 69390.7909    0  398 52860.6272 69390.7909  31.3%     - 1766s
     0     0 69387.0516    0  415 52860.6272 69387.0516  31.3%     - 1771s
     0     0 69386.7272    0  414 52860.6272 69386.7272  31.3%     - 1772s
     0     0 69383.6041    0  414 52860.6272 69383.6041  31.3%     - 1778s
     0     0 69381.4669    0  416 52860.6272 69381.4669  31.3%     - 1820s
     0     0 69379.6335    0  413 52860.6272 69379.6335  31.3%     - 1825s
     0     0 69379.5303    0  413 52860.6272 69379.5303  31.2%     - 1831s
H    0     0                    52879.090084 69379.0159  31.2%     - 1999s
H    0     0                    53168.410036 69379.0159  30.5%     - 2144s
     0     2 69379.0159    0  413 53168.4100 69379.0159  30.5%     - 2149s
     1     3 69289.8047    1  406 53168.4100 69379.0159  30.5%  8204 2167s
     2     4 69267.5277    1  407 53168.4100 69289.3396  30.3%  7744 2184s
     3     7 69130.2906    2  395 53168.4100 69288.9868  30.3%  6346 2220s
     6    11 68944.1622    3  399 53168.4100 69267.0997  30.3%  9790 2268s
    10    21 67986.3141    4  337 53168.4100 69131.8946  30.0% 13950 2310s
    20    31 66465.0442    4  358 53168.4100 68942.6516  29.7% 20815 2415s
H   30    61                    53451.239004 68850.2096  28.8% 23187 2917s
H   31    61                    53483.505533 68850.2096  28.7% 22915 2917s
H   40    61                    53605.611613 68850.2096  28.4% 21916 2917s
    60    93 66976.1197    7  323 53605.6116 68850.2096  28.4% 31032 2966s
    92   173 66815.4703    8  320 53605.6116 68850.2096  28.4% 26130 3203s
H  151   173                    53736.087792 68850.2096  28.1% 18961 3203s
   172   241 66692.2854   11  324 53736.0878 68850.2096  28.1% 17615 3281s
   240   307 66406.7888   12  362 53736.0878 68850.2096  28.1% 14689 3351s
   306   358 66216.2562   14  323 53736.0878 68850.2096  28.1% 13262 3413s
   357   390 65334.7143   16  311 53736.0878 68850.2096  28.1% 12624 3456s
   389   422 65048.5459   17  296 53736.0878 68850.2096  28.1% 12592 3519s
H  391   422                    53763.061831 68850.2096  28.1% 12540 3519s
H  411   422                    53765.941022 68850.2096  28.1% 12446 3519s
   421   451 64938.1866   18  298 53765.9410 68850.2096  28.1% 12332 3573s
   450   474 64875.8682   19  279 53765.9410 68850.2096  28.1% 12325 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 166
  MIR: 3159
  Flow cover: 2980
  RLT: 36
  Relax-and-lift: 405

Explored 473 nodes (6570672 simplex iterations) in 3600.11 seconds (4537.62 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53765.9 53763.1 53736.1 ... 52770.9

Time limit reached
Best objective 5.376594102197e+04, best bound 6.885020961223e+04, gap 28.0554%
  WARNING: Time limit reached. Using best solution found (gap: 28.06%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 53765.94, θ = 216132.25
  Upper Bound (UB) = 53765.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216132.25
  [DEBUG]   ✓ Scenario 0: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 216132.25 ≤ Q = 216132.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 216132.25 ≤ Q = 216132.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6e13965c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6e13965c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.389868e+13
Presolve removed 2554 rows and 1845 columns
Presolve time: 0.01s
Presolved: 539 rows, 544 columns, 1521 nonzeros
Found heuristic solution: objective 6819590.4277
Variable types: 370 continuous, 174 integer (174 binary)

Root relaxation: objective -1.902803e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -190280.26    0  124 6819590.43 -190280.26   103%     -    0s
H    0     0                    -152915.5598 -190280.26  24.4%     -    0s
H    0     0                    -153464.1953 -190280.26  24.0%     -    0s
H    0     0                    -156468.1553 -190280.26  21.6%     -    0s
H    0     0                    -156496.9305 -167439.93  6.99%     -    0s
     0     0 -167439.93    0  109 -156496.93 -167439.93  6.99%     -    0s
H    0     0                    -164012.4378 -167437.48  2.09%     -    0s
H    0     0                    -165505.5188 -167437.48  1.17%     -    0s
     0     0 -166261.62    0  113 -165505.52 -166261.62  0.46%     -    0s
     0     0 -166242.62    0  112 -165505.52 -166242.62  0.45%     -    0s
     0     0 -165924.66    0   52 -165505.52 -165924.66  0.25%     -    0s
     0     0 -165785.28    0   66 -165505.52 -165785.28  0.17%     -    0s
     0     0 -165774.14    0   64 -165505.52 -165774.14  0.16%     -    0s
     0     0 -165750.46    0   41 -165505.52 -165750.46  0.15%     -    0s
     0     0 -165747.64    0   40 -165505.52 -165747.64  0.15%     -    0s
     0     0 -165695.26    0   38 -165505.52 -165695.26  0.11%     -    0s
H    0     0                    -165556.6933 -165694.59  0.08%     -    0s
     0     0 -165694.59    0   38 -165556.69 -165694.59  0.08%     -    0s
     0     0 -165667.95    0   38 -165556.69 -165667.95  0.07%     -    0s
     0     0 -165667.95    0   47 -165556.69 -165667.95  0.07%     -    0s
     0     0 -165667.95    0   47 -165556.69 -165667.95  0.07%     -    0s
     0     0 -165667.95    0   37 -165556.69 -165667.95  0.07%     -    0s
     0     0 -165666.56    0   35 -165556.69 -165666.56  0.07%     -    0s
H    0     0                    -165561.5486 -165654.44  0.06%     -    0s
     0     0 -165654.44    0   35 -165561.55 -165654.44  0.06%     -    0s
     0     0 -165623.97    0   18 -165561.55 -165623.97  0.04%     -    0s
     0     0 -165612.06    0   33 -165561.55 -165612.06  0.03%     -    0s
     0     0 -165611.56    0   18 -165561.55 -165611.56  0.03%     -    0s
     0     0 -165610.03    0   32 -165561.55 -165610.03  0.03%     -    0s
     0     0 -165609.67    0   32 -165561.55 -165609.67  0.03%     -    0s
     0     0 -165609.65    0   31 -165561.55 -165609.65  0.03%     -    0s
     0     0 -165609.65    0   32 -165561.55 -165609.65  0.03%     -    0s
     0     0 -165609.65    0   31 -165561.55 -165609.65  0.03%     -    0s
     0     0 -165607.33    0   31 -165561.55 -165607.33  0.03%     -    0s
     0     0 -165603.12    0   31 -165561.55 -165603.12  0.03%     -    0s
     0     0 -165597.36    0   30 -165561.55 -165597.36  0.02%     -    0s
     0     0 -165593.66    0   30 -165561.55 -165593.66  0.02%     -    0s
     0     0 -165592.11    0   30 -165561.55 -165592.11  0.02%     -    0s
     0     0 -165592.11    0   30 -165561.55 -165592.11  0.02%     -    0s
     0     0 -165591.35    0   30 -165561.55 -165591.35  0.02%     -    0s
     0     0 -165591.27    0   28 -165561.55 -165591.27  0.02%     -    0s
     0     0 -165591.27    0   31 -165561.55 -165591.27  0.02%     -    0s
     0     0 -165591.27    0    8 -165561.55 -165591.27  0.02%     -    0s
     0     0          -    0      -165561.55 -165573.68  0.01%     -    0s

Cutting planes:
  Gomory: 11
  MIR: 25
  Flow cover: 4
  RLT: 1

Explored 1 nodes (1341 simplex iterations) in 0.20 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -165562 -165557 -165555 ... -152916

Optimal solution found (tolerance 1.00e-04)
Best objective -1.655615486001e+05, best bound -1.655736842661e+05, gap 0.0073%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 207883.57
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -165561.55
  [DEBUG]   S×d_nominal = 373445.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373445.12 + -165561.55 = 207883.57
  [DEBUG]   Current θ from Master = 216132.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8248.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45517.26
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 3601.8333, Absolute Gap = 3601.8333, Relative Gap = 0.066991
  Not converged yet (gap = 3601.83 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 784055 nonzeros
Model fingerprint: 0x14e50256
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 114534 rows and 46494 columns (presolve time = 5s)...
Presolve removed 114534 rows and 46494 columns
Presolve time: 5.30s
Presolved: 162069 rows, 68086 columns, 996572 nonzeros
Variable types: 65827 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.65s

Barrier statistics:
 Dense cols : 725
 AA' NZ     : 7.859e+06
 Factor NZ  : 1.826e+07 (roughly 240 MB of memory)
 Factor Ops : 4.752e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.53497036e+07  3.04725581e+08  1.89e+05 1.62e+01  1.18e+05     8s
   1  -2.01770353e+07  2.94467212e+08  1.38e+05 1.10e+02  8.56e+04     8s
   2  -1.08175822e+07  2.47369395e+08  6.99e+04 3.42e+01  4.47e+04     9s
   3  -2.34319771e+06  1.84330409e+08  1.19e+04 3.82e+00  8.07e+03     9s
   4  -8.98389989e+05  1.26813239e+08  1.93e+03 5.43e-01  1.58e+03     9s
   5  -6.86846326e+05  5.65465513e+07  5.96e+02 1.44e-01  5.03e+02     9s
   6  -6.10791669e+05  3.87166269e+07  3.23e+02 8.42e-02  2.89e+02     9s
   7  -4.84149943e+05  2.82151528e+07  1.25e+02 5.71e-02  1.53e+02     9s
   8  -3.12538931e+05  1.85944818e+07  4.78e+01 3.29e-02  8.19e+01     9s
   9  -1.58223706e+05  1.28920281e+07  1.21e+01 2.13e-02  4.78e+01    10s
  10  -1.33402520e+05  7.25331798e+06  7.78e+00 1.14e-02  2.64e+01    10s
  11  -1.01635095e+05  3.67817942e+06  3.60e+00 5.34e-03  1.32e+01    10s
  12  -7.06105453e+04  1.10905139e+06  1.46e+00 1.55e-03  4.04e+00    10s
  13  -4.16083634e+04  5.21833094e+05  8.51e-01 7.96e-04  1.92e+00    10s
  14   2.94602778e+03  2.71748065e+05  3.93e-01 1.85e-03  9.15e-01    10s
  15   1.97013827e+04  2.15306257e+05  3.16e-01 9.97e-04  6.66e-01    10s
  16   3.33193820e+04  1.78085680e+05  2.47e-01 2.16e-03  4.93e-01    11s
  17   4.02636954e+04  1.51431009e+05  2.12e-01 2.18e-03  3.79e-01    11s
  18   4.48184036e+04  1.42782926e+05  1.88e-01 1.56e-03  3.34e-01    11s
  19   4.81242104e+04  1.30594653e+05  1.71e-01 1.52e-03  2.81e-01    11s
  20   5.59720700e+04  1.22064713e+05  1.31e-01 1.24e-03  2.25e-01    11s
  21   6.18682925e+04  1.12420402e+05  1.01e-01 1.36e-03  1.72e-01    11s
  22   6.63529588e+04  1.04678807e+05  8.01e-02 1.36e-03  1.31e-01    12s
  23   7.00165631e+04  9.96852120e+04  6.41e-02 1.61e-03  1.01e-01    12s
  24   7.35121206e+04  9.63419528e+04  4.94e-02 1.48e-03  7.78e-02    12s
  25   7.51217019e+04  9.32016600e+04  4.29e-02 1.62e-03  6.16e-02    12s
  26   7.79987299e+04  9.17646161e+04  3.17e-02 1.24e-03  4.69e-02    12s
  27   7.84404907e+04  9.01082023e+04  3.00e-02 8.38e-04  3.98e-02    13s
  28   8.12237867e+04  8.96728332e+04  1.99e-02 7.00e-04  2.88e-02    13s
  29   8.27642797e+04  8.90897403e+04  1.43e-02 4.90e-04  2.16e-02    13s
  30   8.45453360e+04  8.81748297e+04  8.00e-03 2.81e-04  1.24e-02    13s
  31   8.52148057e+04  8.75939889e+04  5.74e-03 1.38e-04  8.11e-03    13s
  32   8.56891076e+04  8.74515655e+04  4.14e-03 1.01e-04  6.01e-03    13s
  33   8.61339837e+04  8.73676642e+04  2.67e-03 8.32e-05  4.20e-03    14s
  34   8.62679857e+04  8.73187920e+04  2.23e-03 7.26e-05  3.58e-03    14s
  35   8.64737398e+04  8.72399953e+04  1.56e-03 5.46e-05  2.61e-03    14s
  36   8.65612519e+04  8.71400033e+04  1.28e-03 3.51e-05  1.97e-03    14s
  37   8.66128032e+04  8.71117716e+04  1.12e-03 3.66e-05  1.70e-03    14s
  38   8.67365544e+04  8.71075231e+04  7.44e-04 3.54e-05  1.26e-03    15s
  39   8.67997572e+04  8.70693902e+04  5.46e-04 2.41e-05  9.18e-04    15s
  40   8.68081449e+04  8.70541817e+04  5.19e-04 1.99e-05  8.38e-04    15s
  41   8.68957176e+04  8.70155990e+04  2.58e-04 8.82e-06  4.09e-04    15s
  42   8.69248602e+04  8.69970997e+04  1.68e-04 2.61e-05  2.46e-04    15s
  43   8.69528967e+04  8.69935844e+04  8.41e-05 1.98e-05  1.39e-04    16s
  44   8.69583758e+04  8.69915087e+04  6.79e-05 1.59e-05  1.13e-04    16s
  45   8.69634381e+04  8.69894533e+04  5.29e-05 1.23e-05  8.86e-05    16s
  46   8.69712863e+04  8.69871702e+04  2.98e-05 8.06e-06  5.41e-05    16s
  47   8.69783534e+04  8.69838124e+04  1.10e-05 2.71e-06  1.86e-05    16s
  48   8.69824674e+04  8.69826239e+04  5.83e-08 5.29e-07  5.31e-07    17s
  49   8.69825061e+04  8.69825564e+04  3.30e-08 1.39e-08  1.71e-07    17s
  50   8.69825518e+04  8.69825556e+04  5.72e-06 9.40e-07  1.37e-08    17s
  51   8.69825525e+04  8.69825547e+04  4.01e-06 1.70e-07  7.62e-09    17s
  52   8.69825545e+04  8.69825545e+04  8.11e-08 4.00e-09  2.14e-11    17s

Barrier solved model in 52 iterations and 17.47 seconds (16.18 work units)
Optimal objective 8.69825545e+04


Root crossover log...

  145280 DPushes remaining with DInf 0.0000000e+00                18s
   25491 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    1838 PPushes remaining with PInf 3.7261945e-06                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.3957840e-10     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   67057    8.6982554e+04   0.000000e+00   0.000000e+00     25s
   67057    8.6982554e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 2.00s

Solved with barrier

Root relaxation: objective 8.698255e+04, 67057 iterations, 20.88 seconds (23.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86982.5545    0  153 -203987.28 86982.5545   143%     -   28s
H    0     0                    -202587.5875 86982.5545   143%     -   28s
H    0     0                    -70154.82781 86982.5545   224%     -   29s
H    0     0                    -51823.86363 86982.5545   268%     -   29s
H    0     0                    -51389.72217 86982.5545   269%     -   29s
H    0     0                    -50950.30602 86982.5545   271%     -   29s
H    0     0                    19770.888390 86982.5545   340%     -   31s
H    0     0                    20821.599552 86982.5545   318%     -   31s
H    0     0                    40964.732944 86982.5545   112%     -   31s
H    0     0                    45881.573688 86982.5545  89.6%     -   32s
H    0     0                    46696.922350 86982.5545  86.3%     -   33s
H    0     0                    47573.989185 86982.5545  82.8%     -   34s
H    0     0                    47812.716948 86982.5545  81.9%     -   35s
H    0     0                    49322.003946 86982.5545  76.4%     -   35s
H    0     0                    49582.421103 86982.5545  75.4%     -   35s
H    0     0                    50708.478469 86982.5545  71.5%     -   35s
     0     0 81232.6232    0  170 50708.4785 81232.6232  60.2%     -  176s
H    0     0                    50744.577110 81231.9479  60.1%     -  179s
H    0     0                    51689.065922 81231.9479  57.2%     -  179s
H    0     0                    52246.651719 81231.9479  55.5%     -  179s
     0     0 80914.5251    0  194 52246.6517 80914.5251  54.9%     -  262s
     0     0 80604.8746    0  211 52246.6517 80604.8746  54.3%     -  327s
     0     0 80593.7408    0  204 52246.6517 80593.7408  54.3%     -  350s
     0     0 80592.6436    0  202 52246.6517 80592.6436  54.3%     -  357s
     0     0 80591.7800    0  206 52246.6517 80591.7800  54.3%     -  360s
     0     0 80589.5828    0  204 52246.6517 80589.5828  54.2%     -  362s
     0     0 80587.4416    0  198 52246.6517 80587.4416  54.2%     -  371s
     0     0 80584.7479    0  200 52246.6517 80584.7479  54.2%     -  377s
     0     0 80583.6866    0  200 52246.6517 80583.6866  54.2%     -  380s
     0     0 80429.2849    0  200 52246.6517 80429.2849  53.9%     -  440s
     0     0 80371.0402    0  207 52246.6517 80371.0402  53.8%     -  471s
     0     0 80365.4535    0  208 52246.6517 80365.4535  53.8%     -  482s
     0     0 80363.3848    0  205 52246.6517 80363.3848  53.8%     -  491s
     0     0 80362.2277    0  205 52246.6517 80362.2277  53.8%     -  492s
     0     0 80358.7520    0  238 52246.6517 80358.7520  53.8%     -  496s
     0     0 80358.5857    0  240 52246.6517 80358.5857  53.8%     -  497s
     0     0 77553.1119    0  235 52246.6517 77553.1119  48.4%     -  618s
     0     0 77014.4999    0  251 52246.6517 77014.4999  47.4%     -  694s
     0     0 76907.3694    0  242 52246.6517 76907.3694  47.2%     -  726s
     0     0 76760.2283    0  240 52246.6517 76760.2283  46.9%     -  780s
     0     0 76726.8930    0  259 52246.6517 76726.8930  46.9%     -  814s
     0     0 76665.2190    0  250 52246.6517 76665.2190  46.7%     -  859s
     0     0 76534.3489    0  232 52246.6517 76534.3489  46.5%     -  894s
     0     0 76407.0982    0  247 52246.6517 76407.0982  46.2%     -  939s
     0     0 76397.4028    0  254 52246.6517 76397.4028  46.2%     -  949s
     0     0 76388.0047    0  250 52246.6517 76388.0047  46.2%     -  961s
     0     0 76318.8481    0  245 52246.6517 76318.8481  46.1%     -  983s
     0     0 76250.0862    0  260 52246.6517 76250.0862  45.9%     - 1011s
     0     0 76230.6522    0  241 52246.6517 76230.6522  45.9%     - 1023s
     0     0 76211.1280    0  256 52246.6517 76211.1280  45.9%     - 1035s
     0     0 76161.0482    0  243 52246.6517 76161.0482  45.8%     - 1059s
     0     0 76156.1441    0  242 52246.6517 76156.1441  45.8%     - 1064s
     0     0 76151.4608    0  250 52246.6517 76151.4608  45.8%     - 1075s
     0     0 76131.0935    0  244 52246.6517 76131.0935  45.7%     - 1084s
     0     0 76128.1527    0  245 52246.6517 76128.1527  45.7%     - 1088s
     0     0 76099.5824    0  246 52246.6517 76099.5824  45.7%     - 1106s
     0     0 76095.0027    0  249 52246.6517 76095.0027  45.6%     - 1114s
     0     0 76087.2802    0  252 52246.6517 76087.2802  45.6%     - 1123s
     0     0 76084.8305    0  249 52246.6517 76084.8305  45.6%     - 1127s
     0     0 76066.3461    0  250 52246.6517 76066.3461  45.6%     - 1138s
     0     0 76061.9213    0  248 52246.6517 76061.9213  45.6%     - 1141s
     0     0 76052.8449    0  243 52246.6517 76052.8449  45.6%     - 1147s
     0     0 76052.8438    0  243 52246.6517 76052.8438  45.6%     - 1148s
     0     0 73419.4949    0  294 52246.6517 73419.4949  40.5%     - 1316s
     0     0 72653.4514    0  292 52246.6517 72653.4514  39.1%     - 1431s
     0     0 72569.2529    0  350 52246.6517 72569.2529  38.9%     - 1470s
     0     0 72460.1762    0  314 52246.6517 72460.1762  38.7%     - 1507s
     0     0 72395.3921    0  358 52246.6517 72395.3921  38.6%     - 1539s
     0     0 72293.4725    0  363 52246.6517 72293.4725  38.4%     - 1572s
     0     0 72230.6780    0  318 52246.6517 72230.6780  38.2%     - 1595s
     0     0 72201.6068    0  320 52246.6517 72201.6068  38.2%     - 1613s
     0     0 72177.9363    0  320 52246.6517 72177.9363  38.1%     - 1621s
     0     0 72164.7931    0  322 52246.6517 72164.7931  38.1%     - 1631s
     0     0 72162.3748    0  324 52246.6517 72162.3748  38.1%     - 1638s
     0     0 72145.8122    0  322 52246.6517 72145.8122  38.1%     - 1645s
     0     0 72136.5117    0  321 52246.6517 72136.5117  38.1%     - 1653s
     0     0 72132.5174    0  325 52246.6517 72132.5174  38.1%     - 1658s
     0     0 72089.0143    0  325 52246.6517 72089.0143  38.0%     - 1673s
     0     0 72043.1792    0  322 52246.6517 72043.1792  37.9%     - 1687s
     0     0 72037.1212    0  332 52246.6517 72037.1212  37.9%     - 1694s
     0     0 72034.7609    0  330 52246.6517 72034.7609  37.9%     - 1700s
     0     0 72033.4857    0  369 52246.6517 72033.4857  37.9%     - 1702s
     0     0 71071.8468    0  357 52246.6517 71071.8468  36.0%     - 1789s
     0     0 70670.7194    0  400 52246.6517 70670.7194  35.3%     - 1840s
     0     0 70602.4976    0  383 52246.6517 70602.4976  35.1%     - 1860s
     0     0 70577.1042    0  405 52246.6517 70577.1042  35.1%     - 1874s
     0     0 70556.4947    0  397 52246.6517 70556.4947  35.0%     - 1886s
     0     0 70550.3177    0  402 52246.6517 70550.3177  35.0%     - 1894s
     0     0 70529.1598    0  364 52246.6517 70529.1598  35.0%     - 1903s
     0     0 70519.0388    0  366 52246.6517 70519.0388  35.0%     - 1910s
     0     0 70506.9165    0  356 52246.6517 70506.9165  35.0%     - 1919s
     0     0 70479.8069    0  402 52246.6517 70479.8069  34.9%     - 1934s
     0     0 70474.0833    0  402 52246.6517 70474.0833  34.9%     - 1941s
     0     0 70469.4711    0  413 52246.6517 70469.4711  34.9%     - 1945s
     0     0 70452.9265    0  401 52246.6517 70452.9265  34.8%     - 1956s
     0     0 70401.9594    0  387 52246.6517 70401.9594  34.7%     - 1970s
     0     0 70388.6880    0  384 52246.6517 70388.6880  34.7%     - 1977s
     0     0 70385.8825    0  390 52246.6517 70385.8825  34.7%     - 1980s
     0     0 70383.1817    0  389 52246.6517 70383.1817  34.7%     - 1984s
     0     0 70383.1279    0  388 52246.6517 70383.1279  34.7%     - 1985s
     0     0 70098.5407    0  360 52246.6517 70098.5407  34.2%     - 2020s
     0     0 70050.8780    0  348 52246.6517 70050.8780  34.1%     - 2046s
     0     0 70035.1850    0  349 52246.6517 70035.1850  34.0%     - 2054s
     0     0 70027.1083    0  364 52246.6517 70027.1083  34.0%     - 2060s
     0     0 70008.1576    0  357 52246.6517 70008.1576  34.0%     - 2071s
     0     0 70003.0231    0  360 52246.6517 70003.0231  34.0%     - 2076s
     0     0 70001.6263    0  355 52246.6517 70001.6263  34.0%     - 2078s
     0     0 69817.1672    0  371 52246.6517 69817.1672  33.6%     - 2108s
     0     0 69731.1703    0  392 52246.6517 69731.1703  33.5%     - 2141s
     0     0 69716.9775    0  392 52246.6517 69716.9775  33.4%     - 2149s
     0     0 69711.4658    0  391 52246.6517 69711.4658  33.4%     - 2157s
     0     0 69702.2648    0  392 52246.6517 69702.2648  33.4%     - 2164s
     0     0 69694.5222    0  395 52246.6517 69694.5222  33.4%     - 2170s
     0     0 69692.6262    0  405 52246.6517 69692.6262  33.4%     - 2173s
     0     0 69610.1772    0  403 52246.6517 69610.1772  33.2%     - 2199s
     0     0 69590.6750    0  408 52246.6517 69590.6750  33.2%     - 2209s
     0     0 69584.2329    0  410 52246.6517 69584.2329  33.2%     - 2217s
     0     0 69581.6775    0  411 52246.6517 69581.6775  33.2%     - 2224s
     0     0 69576.9261    0  409 52246.6517 69576.9261  33.2%     - 2230s
     0     0 69573.9859    0  413 52246.6517 69573.9859  33.2%     - 2232s
     0     0 69572.3211    0  414 52246.6517 69572.3211  33.2%     - 2236s
     0     0 69523.7807    0  397 52246.6517 69523.7807  33.1%     - 2256s
     0     0 69512.8782    0  392 52246.6517 69512.8782  33.0%     - 2294s
     0     0 69505.8064    0  401 52246.6517 69505.8064  33.0%     - 2300s
     0     0 69504.2080    0  403 52246.6517 69504.2080  33.0%     - 2304s
     0     0 69482.9769    0  348 52246.6517 69482.9769  33.0%     - 2316s
     0     0 69463.6415    0  361 52246.6517 69463.6415  33.0%     - 2327s
     0     0 69461.6310    0  361 52246.6517 69461.6310  32.9%     - 2332s
     0     0 69443.5246    0  353 52246.6517 69443.5246  32.9%     - 2342s
H    0     0                    52272.038437 69440.8531  32.8%     - 2356s
     0     0 69435.8796    0  406 52272.0384 69435.8796  32.8%     - 2366s
     0     0 69435.2742    0  411 52272.0384 69435.2742  32.8%     - 2369s
     0     0 69425.0329    0  409 52272.0384 69425.0329  32.8%     - 2382s
     0     0 69424.3304    0  408 52272.0384 69424.3304  32.8%     - 2386s
     0     0 69424.0232    0  408 52272.0384 69424.0232  32.8%     - 2391s
H    0     0                    52294.987367 69423.6472  32.8%     - 2411s
H    0     0                    52389.983815 69423.6472  32.5%     - 2413s
H    0     0                    52434.496659 69423.6472  32.4%     - 2413s
     0     0 69423.6472    0  409 52434.4967 69423.6472  32.4%     - 2414s
     0     0 69423.2805    0  406 52434.4967 69423.2805  32.4%     - 2418s
     0     0 69423.1616    0  406 52434.4967 69423.1616  32.4%     - 2424s
     0     2 69423.1451    0  406 52434.4967 69423.1451  32.4%     - 2722s
     1     3 69333.5663    1  394 52434.4967 69423.1451  32.4%  7450 2739s
     2     4 69360.6832    1  406 52434.4967 69360.6832  32.3% 11370 2772s
     3     5 69101.2263    2  405 52434.4967 69359.8438  32.3% 10897 2795s
     4     9 69137.1280    2  397 52434.4967 69357.1105  32.3%  9170 2832s
     8    18 69001.8680    3  412 52434.4967 69178.8873  31.9%  9348 2899s
    17    34 68907.7271    4  407 52434.4967 69063.5252  31.7% 11395 2948s
    33    48 68528.5620    5  358 52434.4967 68907.7254  31.4% 20145 3083s
    47    70 67378.9555    6  391 52434.4967 68907.7254  31.4% 19075 3187s
H   59    70                    52471.974991 68907.7254  31.3% 18512 3187s
    69   135 67261.0006    7  380 52471.9750 68907.7254  31.3% 17765 3298s
   134   198 67202.5145    8  371 52471.9750 68907.7254  31.3% 16030 3394s
   197   260 67183.9195    9  371 52471.9750 68907.7254  31.3% 13328 3470s
   259   289 67169.1883   10  371 52471.9750 68907.7254  31.3% 11779 3552s
   288   313 66963.4494   11  357 52471.9750 68907.7254  31.3% 11519 3600s

Cutting planes:
  Learned: 1
  Gomory: 17
  Implied bound: 172
  MIR: 2860
  Flow cover: 3291
  RLT: 36
  Relax-and-lift: 448

Explored 312 nodes (4423960 simplex iterations) in 3600.19 seconds (4398.90 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52472 52434.5 52390 ... 49582.4

Time limit reached
Best objective 5.247197499057e+04, best bound 6.890772538145e+04, gap 31.3229%
  WARNING: Time limit reached. Using best solution found (gap: 31.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 52471.97, θ = 214773.19
  Upper Bound (UB) = 52471.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214773.19
  [DEBUG]   ✓ Scenario 0: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 214773.19 ≤ Q = 214773.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 214773.19 ≤ Q = 214773.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 214773.19 ≤ Q = 214773.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 214773.19 ≤ Q = 214773.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 214773.19 ≤ Q = 214773.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 214773.19 ≤ Q = 214773.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 214773.19 ≤ Q = 215598.40 (slack: 825.21)
  [DEBUG]   ✓ Scenario 15: θ = 214773.19 ≤ Q = 214773.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 214773.19 ≤ Q = 214773.19 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x360fd596
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc9f02a6a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.374464e+13
Presolve removed 2567 rows and 1856 columns
Presolve time: 0.01s
Presolved: 526 rows, 533 columns, 1489 nonzeros
Found heuristic solution: objective 6642175.4793
Variable types: 361 continuous, 172 integer (172 binary)
Found heuristic solution: objective 6641397.7331

Root relaxation: objective -1.964847e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196484.66    0  127 6641397.73 -196484.66   103%     -    0s
H    0     0                    -163736.6591 -196484.66  20.0%     -    0s
H    0     0                    -164016.4118 -196484.66  19.8%     -    0s
H    0     0                    -164122.4344 -196217.31  19.6%     -    0s
H    0     0                    -164402.1871 -196217.31  19.4%     -    0s
H    0     0                    -173087.8871 -174778.67  0.98%     -    0s
     0     0 -174778.67    0   74 -173087.89 -174778.67  0.98%     -    0s
     0     0 -174524.00    0   76 -173087.89 -174524.00  0.83%     -    0s
     0     0 -173843.19    0   39 -173087.89 -173843.19  0.44%     -    0s
H    0     0                    -173497.3318 -173801.12  0.18%     -    0s
     0     0 -173801.12    0   40 -173497.33 -173801.12  0.18%     -    0s
     0     0 -173664.60    0   20 -173497.33 -173664.60  0.10%     -    0s
     0     0 -173649.98    0   13 -173497.33 -173649.98  0.09%     -    0s
     0     0 -173607.49    0   12 -173497.33 -173607.49  0.06%     -    0s
     0     0 -173601.21    0   10 -173497.33 -173601.21  0.06%     -    0s
     0     0 -173599.88    0   11 -173497.33 -173599.88  0.06%     -    0s
     0     0          -    0      -173497.33 -173506.19  0.01%     -    0s

Cutting planes:
  Gomory: 22
  Implied bound: 3
  MIR: 121
  Flow cover: 14
  RLT: 75
  Relax-and-lift: 11
  BQP: 2

Explored 1 nodes (612 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -173497 -164402 -164122 ... 1.37446e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.734973317559e+05, best bound -1.735061882399e+05, gap 0.0051%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 203348.10
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -173497.33
  [DEBUG]   S×d_nominal = 376845.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 376845.44 + -173497.33 = 203348.10
  [DEBUG]   Current θ from Master = 214773.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11425.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41046.89
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 2307.8672, Absolute Gap = 2307.8672, Relative Gap = 0.043983
  Not converged yet (gap = 2307.87 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827307 nonzeros
Model fingerprint: 0x070d5aad
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120897 rows and 49077 columns (presolve time = 5s)...
Presolve removed 120897 rows and 49077 columns
Presolve time: 5.99s
Presolved: 170996 rows, 71743 columns, 1051609 nonzeros
Variable types: 69484 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -300583.5157
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.70s

Barrier statistics:
 Dense cols : 723
 AA' NZ     : 8.708e+06
 Factor NZ  : 2.016e+07 (roughly 260 MB of memory)
 Factor Ops : 5.455e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.60542948e+07  3.19219040e+08  1.95e+05 1.61e+01  1.21e+05     9s
   1  -2.07982018e+07  3.10064978e+08  1.42e+05 1.10e+02  8.76e+04     9s
   2  -1.17052742e+07  2.60578606e+08  7.54e+04 3.44e+01  4.80e+04    10s
   3  -2.31199795e+06  1.95131997e+08  1.17e+04 3.09e+00  7.90e+03    10s
   4  -8.45524487e+05  1.31494784e+08  1.53e+03 5.84e-01  1.33e+03    10s
   5  -6.86287281e+05  5.57537719e+07  5.53e+02 1.18e-01  4.64e+02    10s
   6  -6.10503577e+05  4.11407011e+07  2.89e+02 7.94e-02  2.74e+02    10s
   7  -5.03077309e+05  2.93456686e+07  1.19e+02 4.99e-02  1.48e+02    10s
   8  -3.69087092e+05  2.20833421e+07  4.52e+01 3.51e-02  8.99e+01    10s
   9  -2.13658017e+05  1.33689893e+07  1.35e+01 1.92e-02  4.76e+01    11s
  10  -1.49946389e+05  8.98034420e+06  6.86e+00 1.24e-02  3.08e+01    11s
  11  -1.23247589e+05  6.10802208e+06  3.20e+00 8.25e-03  2.05e+01    11s
  12  -7.76909695e+04  3.68985918e+06  7.52e-01 4.85e-03  1.22e+01    11s
  13  -5.65131577e+04  1.07491976e+06  3.51e-01 1.44e-03  3.64e+00    11s
  14  -2.51111116e+04  4.90304223e+05  1.88e-01 9.46e-04  1.66e+00    11s
  15  -4.82937686e+03  2.91165453e+05  1.20e-01 1.06e-03  9.52e-01    11s
  16   1.85469752e+04  2.05339029e+05  8.18e-02 1.41e-03  6.00e-01    12s
  17   3.28008187e+04  1.68929707e+05  6.21e-02 1.42e-03  4.38e-01    12s
  18   3.68627908e+04  1.46672335e+05  5.68e-02 1.58e-03  3.53e-01    12s
  19   4.07373405e+04  1.39985922e+05  5.17e-02 1.42e-03  3.19e-01    12s
  20   4.81257081e+04  1.26039428e+05  4.19e-02 1.08e-03  2.51e-01    12s
  21   5.30140864e+04  1.15386742e+05  3.57e-02 7.95e-04  2.01e-01    13s
  22   6.14058992e+04  1.08566369e+05  2.54e-02 6.54e-04  1.52e-01    13s
  23   6.30571070e+04  1.02159300e+05  2.35e-02 4.81e-04  1.26e-01    13s
  24   6.76325264e+04  9.78935293e+04  1.85e-02 3.66e-04  9.73e-02    13s
  25   7.20113665e+04  9.44733339e+04  1.40e-02 3.68e-04  7.22e-02    13s
  26   7.41135709e+04  9.23540096e+04  1.19e-02 2.79e-04  5.87e-02    14s
  27   7.68217149e+04  9.11112442e+04  9.25e-03 2.17e-04  4.60e-02    14s
  28   7.95987805e+04  8.97940651e+04  6.58e-03 1.61e-04  3.28e-02    14s
  29   8.06027706e+04  8.91660018e+04  5.65e-03 1.20e-04  2.75e-02    14s
  30   8.24174478e+04  8.86243743e+04  3.94e-03 9.22e-05  2.00e-02    14s
  31   8.37736798e+04  8.81741917e+04  2.68e-03 7.08e-05  1.42e-02    15s
  32   8.43397485e+04  8.79150187e+04  2.16e-03 5.68e-05  1.15e-02    15s
  33   8.47786249e+04  8.77043486e+04  1.78e-03 4.68e-05  9.41e-03    15s
  34   8.50438074e+04  8.74050250e+04  1.55e-03 3.10e-05  7.59e-03    15s
  35   8.61351610e+04  8.72185061e+04  5.71e-04 2.07e-05  3.48e-03    16s
  36   8.63123854e+04  8.70945677e+04  4.17e-04 1.41e-05  2.51e-03    16s
  37   8.65701882e+04  8.69247397e+04  1.96e-04 5.38e-06  1.14e-03    16s
  38   8.66572688e+04  8.68750022e+04  1.25e-04 2.78e-06  7.00e-04    16s
  39   8.66815484e+04  8.68646716e+04  1.06e-04 2.25e-06  5.89e-04    16s
  40   8.67099303e+04  8.68515643e+04  8.28e-05 1.62e-06  4.55e-04    17s
  41   8.67342869e+04  8.68395487e+04  6.35e-05 9.93e-07  3.38e-04    17s
  42   8.67733297e+04  8.68280574e+04  3.34e-05 8.18e-06  1.76e-04    17s
  43   8.67761555e+04  8.68252678e+04  3.13e-05 6.26e-06  1.58e-04    17s
  44   8.67837723e+04  8.68234011e+04  2.55e-05 5.28e-06  1.27e-04    17s
  45   8.67901091e+04  8.68226909e+04  2.05e-05 4.45e-06  1.05e-04    18s
  46   8.67963122e+04  8.68216815e+04  1.59e-05 2.57e-06  8.16e-05    18s
  47   8.68084774e+04  8.68214016e+04  6.92e-06 2.31e-06  4.16e-05    18s
  48   8.68092561e+04  8.68192700e+04  6.39e-06 6.57e-07  3.22e-05    18s
  49   8.68100241e+04  8.68191922e+04  5.86e-06 6.76e-07  2.95e-05    19s
  50   8.68114113e+04  8.68191012e+04  4.90e-06 5.27e-07  2.47e-05    19s
  51   8.68146483e+04  8.68186888e+04  2.62e-06 2.90e-07  1.30e-05    19s
  52   8.68171101e+04  8.68186257e+04  9.65e-07 3.40e-07  4.88e-06    19s
  53   8.68183372e+04  8.68186197e+04  1.91e-06 1.38e-07  9.10e-07    20s
  54   8.68185635e+04  8.68185970e+04  3.09e-07 3.69e-09  1.08e-07    20s
  55   8.68185866e+04  8.68185961e+04  4.78e-07 9.43e-08  3.05e-08    20s
  56   8.68185949e+04  8.68185961e+04  2.35e-07 2.49e-07  3.88e-09    20s
  57   8.68185953e+04  8.68185961e+04  4.02e-07 1.47e-07  2.27e-09    20s

Barrier solved model in 57 iterations and 20.40 seconds (19.71 work units)
Optimal objective 8.68185953e+04


Root crossover log...

  152886 DPushes remaining with DInf 0.0000000e+00                20s
   22192 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

   26473 PPushes remaining with PInf 1.3131217e-04                28s
   10316 PPushes remaining with PInf 1.1955028e-04                30s
       0 PPushes remaining with PInf 0.0000000e+00                34s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.1588261e+05     34s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  110161    8.6818596e+04   0.000000e+00   4.158826e+05     34s
  111149    8.6818596e+04   0.000000e+00   7.956788e+02     35s
  112466    8.6818596e+04   0.000000e+00   0.000000e+00     37s
  112466    8.6818596e+04   0.000000e+00   0.000000e+00     37s
Concurrent spin time: 6.66s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.681860e+04, 112466 iterations, 36.49 seconds (39.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86818.5961    0  161 -203987.28 86818.5961   143%     -   45s
H    0     0                    -203353.3090 86818.5961   143%     -   46s
H    0     0                    -191834.8510 86818.5961   145%     -   46s
H    0     0                    -188536.2511 86818.5961   146%     -   47s
H    0     0                    -188452.8839 86818.5961   146%     -   48s
H    0     0                    -49426.85748 86818.5961   276%     -   48s
H    0     0                    22515.802501 86818.5961   286%     -   49s
H    0     0                    24200.760575 86818.5961   259%     -   49s
H    0     0                    44213.600263 86818.5961  96.4%     -   50s
H    0     0                    48302.851816 86818.5961  79.7%     -   51s
H    0     0                    50288.514405 86818.5961  72.6%     -   53s
H    0     0                    50521.715867 86818.5961  71.8%     -   53s
     0     0 80520.3550    0  180 50521.7159 80520.3550  59.4%     -  261s
H    0     0                    51100.672060 80519.9860  57.6%     -  264s
H    0     0                    51502.817295 80519.9860  56.3%     -  264s
H    0     0                    51624.915413 80519.9860  56.0%     -  264s
H    0     0                    51653.503845 80519.9860  55.9%     -  264s
     0     0 79605.1515    0  185 51653.5038 79605.1515  54.1%     -  333s
     0     0 79546.5282    0  191 51653.5038 79546.5282  54.0%     -  376s
     0     0 79516.0558    0  193 51653.5038 79516.0558  53.9%     -  392s
     0     0 79486.5538    0  199 51653.5038 79486.5538  53.9%     -  410s
     0     0 79483.3564    0  202 51653.5038 79483.3564  53.9%     -  414s
     0     0 79482.5749    0  198 51653.5038 79482.5749  53.9%     -  417s
     0     0 79478.3719    0  201 51653.5038 79478.3719  53.9%     -  423s
     0     0 79474.4814    0  199 51653.5038 79474.4814  53.9%     -  427s
     0     0 79474.2291    0  197 51653.5038 79474.2291  53.9%     -  429s
     0     0 76244.2050    0  227 51653.5038 76244.2050  47.6%     -  566s
H    0     0                    51800.718685 76242.9192  47.2%     -  567s
H    0     0                    51825.936718 76242.9192  47.1%     -  567s
H    0     0                    51865.525039 76242.9192  47.0%     -  567s
     0     0 75782.9624    0  258 51865.5250 75782.9624  46.1%     -  660s
     0     0 75649.1307    0  265 51865.5250 75649.1307  45.9%     -  731s
     0     0 75549.1992    0  274 51865.5250 75549.1992  45.7%     -  781s
     0     0 75482.8037    0  277 51865.5250 75482.8037  45.5%     -  827s
     0     0 75424.9728    0  287 51865.5250 75424.9728  45.4%     -  864s
     0     0 75262.9725    0  285 51865.5250 75262.9725  45.1%     -  915s
     0     0 75225.9511    0  282 51865.5250 75225.9511  45.0%     -  956s
     0     0 75216.8531    0  288 51865.5250 75216.8531  45.0%     -  965s
     0     0 75210.5880    0  290 51865.5250 75210.5880  45.0%     -  972s
     0     0 75079.2365    0  280 51865.5250 75079.2365  44.8%     - 1016s
     0     0 75031.5839    0  265 51865.5250 75031.5839  44.7%     - 1060s
     0     0 75029.4129    0  268 51865.5250 75029.4129  44.7%     - 1066s
     0     0 75027.2635    0  271 51865.5250 75027.2635  44.7%     - 1070s
     0     0 75026.6799    0  273 51865.5250 75026.6799  44.7%     - 1073s
     0     0 73310.2789    0  298 51865.5250 73310.2789  41.3%     - 1240s
     0     0 72589.7303    0  305 51865.5250 72589.7303  40.0%     - 1357s
     0     0 72369.4347    0  295 51865.5250 72369.4347  39.5%     - 1406s
     0     0 72245.6629    0  297 51865.5250 72245.6629  39.3%     - 1444s
     0     0 72169.5822    0  305 51865.5250 72169.5822  39.1%     - 1476s
     0     0 72036.2815    0  304 51865.5250 72036.2815  38.9%     - 1516s
     0     0 71993.8517    0  305 51865.5250 71993.8517  38.8%     - 1534s
     0     0 71893.2041    0  310 51865.5250 71893.2041  38.6%     - 1571s
     0     0 71834.9608    0  312 51865.5250 71834.9608  38.5%     - 1597s
     0     0 71830.4431    0  312 51865.5250 71830.4431  38.5%     - 1605s
     0     0 71829.4481    0  305 51865.5250 71829.4481  38.5%     - 1615s
     0     0 71055.0251    0  328 51865.5250 71055.0251  37.0%     - 1725s
     0     0 70750.1881    0  353 51865.5250 70750.1881  36.4%     - 1761s
     0     0 70630.4922    0  376 51865.5250 70630.4922  36.2%     - 1787s
     0     0 70583.4086    0  340 51865.5250 70583.4086  36.1%     - 1800s
     0     0 70566.2264    0  343 51865.5250 70566.2264  36.1%     - 1807s
     0     0 70525.9397    0  344 51865.5250 70525.9397  36.0%     - 1819s
     0     0 70509.2236    0  348 51865.5250 70509.2236  35.9%     - 1827s
     0     0 70505.9978    0  378 51865.5250 70505.9978  35.9%     - 1831s
     0     0 70500.7367    0  344 51865.5250 70500.7367  35.9%     - 1837s
     0     0 70500.5693    0  345 51865.5250 70500.5693  35.9%     - 1839s
     0     0 70190.1779    0  379 51865.5250 70190.1779  35.3%     - 1879s
     0     0 70134.9092    0  376 51865.5250 70134.9092  35.2%     - 1902s
     0     0 70109.8938    0  394 51865.5250 70109.8938  35.2%     - 1913s
     0     0 70087.3570    0  394 51865.5250 70087.3570  35.1%     - 1922s
     0     0 70082.0784    0  401 51865.5250 70082.0784  35.1%     - 1926s
     0     0 70076.6979    0  390 51865.5250 70076.6979  35.1%     - 1930s
     0     0 70075.2222    0  390 51865.5250 70075.2222  35.1%     - 1934s
     0     0 69887.8425    0  390 51865.5250 69887.8425  34.7%     - 1959s
     0     0 69829.1638    0  414 51865.5250 69829.1638  34.6%     - 1978s
     0     0 69815.4859    0  413 51865.5250 69815.4859  34.6%     - 1986s
     0     0 69811.0320    0  421 51865.5250 69811.0320  34.6%     - 1993s
     0     0 69809.3468    0  418 51865.5250 69809.3468  34.6%     - 1998s
     0     0 69707.3939    0  406 51865.5250 69707.3939  34.4%     - 2028s
     0     0 69685.3164    0  409 51865.5250 69685.3164  34.4%     - 2049s
     0     0 69677.5606    0  414 51865.5250 69677.5606  34.3%     - 2059s
     0     0 69675.4238    0  422 51865.5250 69675.4238  34.3%     - 2062s
     0     0 69620.1376    0  430 51865.5250 69620.1376  34.2%     - 2083s
     0     0 69597.9299    0  423 51865.5250 69597.9299  34.2%     - 2102s
     0     0 69594.1361    0  440 51865.5250 69594.1361  34.2%     - 2110s
     0     0 69593.1964    0  430 51865.5250 69593.1964  34.2%     - 2116s
     0     0 69577.0997    0  427 51865.5250 69577.0997  34.1%     - 2130s
     0     0 69569.8373    0  421 51865.5250 69569.8373  34.1%     - 2141s
     0     0 69563.2487    0  430 51865.5250 69563.2487  34.1%     - 2147s
     0     0 69561.6247    0  431 51865.5250 69561.6247  34.1%     - 2149s
     0     0 69538.3149    0  409 51865.5250 69538.3149  34.1%     - 2164s
H    0     0                    51903.489298 69537.6180  34.0%     - 2165s
     0     0 69531.3333    0  368 51903.4893 69531.3333  34.0%     - 2172s
     0     0 69530.0793    0  374 51903.4893 69530.0793  34.0%     - 2175s
     0     0 69524.3060    0  375 51903.4893 69524.3060  33.9%     - 2183s
     0     0 69521.2785    0  366 51903.4893 69521.2785  33.9%     - 2189s
     0     0 69520.2122    0  375 51903.4893 69520.2122  33.9%     - 2192s
     0     0 69510.7276    0  360 51903.4893 69510.7276  33.9%     - 2203s
H    0     0                    51991.587898 69510.5888  33.7%     - 2207s
     0     0 69507.9641    0  427 51991.5879 69507.9641  33.7%     - 2214s
     0     0 69506.4494    0  428 51991.5879 69506.4494  33.7%     - 2217s
     0     0 69503.2357    0  361 51991.5879 69503.2357  33.7%     - 2225s
     0     0 69486.9167    0  372 51991.5879 69486.9167  33.7%     - 2237s
     0     0 69481.8760    0  373 51991.5879 69481.8760  33.6%     - 2243s
     0     0 69480.6505    0  366 51991.5879 69480.6505  33.6%     - 2245s
     0     0 69477.7412    0  352 51991.5879 69477.7412  33.6%     - 2252s
H    0     0                    52227.989810 69476.1102  33.0%     - 2254s
H    0     0                    52257.505796 69476.1102  32.9%     - 2254s
     0     0 69476.1102    0  363 52257.5058 69476.1102  32.9%     - 2257s
     0     0 69474.7129    0  365 52257.5058 69474.7129  32.9%     - 2262s
     0     0 69472.3908    0  434 52257.5058 69472.3908  32.9%     - 2266s
     0     0 69472.3908    0  424 52257.5058 69472.3908  32.9%     - 2270s
     0     0 69471.7995    0  366 52257.5058 69471.7995  32.9%     - 2273s
     0     0 69471.7995    0  371 52257.5058 69471.7995  32.9%     - 2276s
     0     0 69471.7995    0  371 52257.5058 69471.7995  32.9%     - 2282s
     0     2 69471.7995    0  371 52257.5058 69471.7995  32.9%     - 2713s
     1     3 69337.4197    1  347 52257.5058 69467.4791  32.9% 23751 2779s
     2     4 69353.8372    1  360 52257.5058 69353.8372  32.7% 18824 2811s
     3     6 69136.2354    2  408 52257.5058 69352.2233  32.7% 16464 2855s
     5    10 69024.5463    3  361 52257.5058 69352.2233  32.7% 16343 2905s
     9    19 68930.6871    3  354 52257.5058 69206.3595  32.4% 15184 2968s
    18    37 68761.0107    4  354 52257.5058 69147.9727  32.3% 15385 3035s
    36    50 68119.9382    6  348 52257.5058 69145.2637  32.3% 24460 3385s
    49    77 68016.1891    7  357 52257.5058 69145.2637  32.3% 27085 3510s
    76   144 67875.2272    8  334 52257.5058 69049.2501  32.1% 21980 3600s

Cutting planes:
  Gomory: 3
  Implied bound: 246
  MIR: 3601
  Flow cover: 3715
  RLT: 28
  Relax-and-lift: 542

Explored 143 nodes (3604562 simplex iterations) in 3600.11 seconds (4545.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52257.5 52228 51991.6 ... 51502.8

Time limit reached
Best objective 5.225750579558e+04, best bound 6.904925005482e+04, gap 32.1327%
  WARNING: Time limit reached. Using best solution found (gap: 32.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 52257.51, θ = 216548.89
  Upper Bound (UB) = 52257.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216548.89
  [DEBUG]   ✓ Scenario 0: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 216548.89 ≤ Q = 216548.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 216548.89 ≤ Q = 216548.89 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x78d52472
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x78d52472
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.400737e+13
Presolve removed 2554 rows and 1845 columns
Presolve time: 0.01s
Presolved: 539 rows, 544 columns, 1524 nonzeros
Found heuristic solution: objective 6904350.3142
Variable types: 370 continuous, 174 integer (174 binary)

Root relaxation: objective -1.898148e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189814.77    0  124 6904350.31 -189814.77   103%     -    0s
H    0     0                    -152533.4232 -189814.77  24.4%     -    0s
H    0     0                    -153078.0270 -189814.77  24.0%     -    0s
H    0     0                    -155549.7972 -189814.77  22.0%     -    0s
     0     0 -166828.31    0  113 -155549.80 -166828.31  7.25%     -    0s
H    0     0                    -162554.5620 -166710.20  2.56%     -    0s
H    0     0                    -162829.8414 -166710.20  2.38%     -    0s
H    0     0                    -164219.4044 -166710.20  1.52%     -    0s
H    0     0                    -164494.6838 -166710.20  1.35%     -    0s
     0     0 -165761.91    0   93 -164494.68 -165761.91  0.77%     -    0s
H    0     0                    -164953.4336 -165755.49  0.49%     -    0s
H    0     0                    -165013.2616 -165355.53  0.21%     -    0s
     0     0 -165355.53    0   36 -165013.26 -165355.53  0.21%     -    0s
     0     0 -165355.11    0   26 -165013.26 -165355.11  0.21%     -    0s
     0     0 -165307.88    0   41 -165013.26 -165307.88  0.18%     -    0s
     0     0 -165306.05    0   23 -165013.26 -165306.05  0.18%     -    0s
     0     0 -165293.73    0   28 -165013.26 -165293.73  0.17%     -    0s
     0     0 -165285.90    0   15 -165013.26 -165285.90  0.17%     -    0s
     0     0 -165230.89    0   16 -165013.26 -165230.89  0.13%     -    0s
     0     0 -165224.30    0   12 -165013.26 -165224.30  0.13%     -    0s
H    0     0                    -165068.4515 -165188.14  0.07%     -    0s
     0     0 -165188.14    0    8 -165068.45 -165188.14  0.07%     -    0s
     0     0 -165178.50    0    7 -165068.45 -165178.50  0.07%     -    0s
     0     0 -165178.50    0   44 -165068.45 -165178.50  0.07%     -    0s
H    0     0                    -165127.9057 -165178.50  0.03%     -    0s
     0     0          -    0      -165127.91 -165139.28  0.01%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 1
  MIR: 31
  Flow cover: 10

Explored 1 nodes (807 simplex iterations) in 0.13 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -165128 -165068 -165013 ... 6.90435e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.651279057219e+05, best bound -1.651392832795e+05, gap 0.0069%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 208188.70
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -165127.91
  [DEBUG]   S×d_nominal = 373316.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373316.60 + -165127.91 = 208188.70
  [DEBUG]   Current θ from Master = 216548.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8360.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43897.32
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 2093.3980, Absolute Gap = 2093.3980, Relative Gap = 0.040059
  Not converged yet (gap = 2093.40 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870559 nonzeros
Model fingerprint: 0x8ce436a3
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns (presolve time = 5s)...
Presolve removed 127260 rows and 51660 columns
Presolve time: 7.25s
Presolved: 179923 rows, 75400 columns, 1106567 nonzeros
Variable types: 73141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -300583.5157
Found heuristic solution: objective -203987.2808

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.33s

Barrier statistics:
 Dense cols : 722
 AA' NZ     : 9.578e+06
 Factor NZ  : 2.176e+07 (roughly 300 MB of memory)
 Factor Ops : 5.852e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.68448855e+07  3.33639598e+08  2.01e+05 1.56e+01  1.24e+05    12s
   1  -2.14689795e+07  3.25916555e+08  1.46e+05 1.10e+02  8.98e+04    12s
   2  -1.27124772e+07  2.74324523e+08  8.18e+04 3.49e+01  5.17e+04    13s
   3  -2.39627066e+06  2.06648590e+08  1.22e+04 3.42e+00  8.24e+03    13s
   4  -8.15167043e+05  1.34589425e+08  1.32e+03 8.41e-01  1.19e+03    13s
   5  -6.83001073e+05  5.37887135e+07  5.21e+02 1.74e-01  4.31e+02    13s
   6  -6.17998582e+05  4.07983693e+07  2.82e+02 1.20e-01  2.62e+02    13s
   7  -4.71229989e+05  3.11989095e+07  5.49e+01 8.47e-02  1.21e+02    13s
   8  -3.61797004e+05  2.01200238e+07  3.01e+01 5.03e-02  7.33e+01    13s
   9  -2.03777666e+05  1.26876665e+07  1.04e+01 2.94e-02  4.21e+01    14s
  10  -1.49050884e+05  7.46772849e+06  5.85e+00 1.66e-02  2.42e+01    14s
  11  -1.17826849e+05  4.78232865e+06  3.08e+00 1.04e-02  1.53e+01    14s
  12  -7.52232154e+04  2.47041572e+06  1.04e+00 5.30e-03  7.83e+00    14s
  13  -4.87612419e+04  8.02690596e+05  4.84e-01 1.68e-03  2.61e+00    14s
  14  -6.64473155e+02  3.84707170e+05  1.75e-01 1.03e-03  1.18e+00    14s
  15   1.34608144e+04  3.03834869e+05  1.42e-01 8.61e-04  8.88e-01    14s
  16   2.82565123e+04  2.03772131e+05  1.07e-01 1.84e-03  5.37e-01    15s
  17   3.63973404e+04  1.67613858e+05  8.98e-02 2.10e-03  4.01e-01    15s
  18   4.01409408e+04  1.47114341e+05  8.18e-02 2.13e-03  3.27e-01    15s
  19   4.83834436e+04  1.32719372e+05  6.48e-02 2.11e-03  2.58e-01    15s
  20   5.39170828e+04  1.15721256e+05  5.38e-02 2.17e-03  1.89e-01    15s
  21   5.91949636e+04  1.10238253e+05  4.40e-02 2.13e-03  1.56e-01    15s
  22   6.29561889e+04  1.02459249e+05  3.72e-02 1.49e-03  1.21e-01    15s
  23   6.62023440e+04  9.91114508e+04  3.17e-02 1.21e-03  1.01e-01    16s
  24   7.04850599e+04  9.51340216e+04  2.47e-02 9.04e-04  7.55e-02    16s
  25   7.27974073e+04  9.29562196e+04  2.09e-02 6.48e-04  6.17e-02    16s
  26   7.60197075e+04  9.14418011e+04  1.59e-02 4.83e-04  4.72e-02    16s
  27   7.89337171e+04  9.02446285e+04  1.14e-02 3.56e-04  3.46e-02    16s
  28   8.01748477e+04  8.93661588e+04  9.61e-03 2.68e-04  2.81e-02    17s
  29   8.20913490e+04  8.88064734e+04  6.73e-03 2.16e-04  2.06e-02    17s
  30   8.35871105e+04  8.84373017e+04  4.49e-03 1.77e-04  1.48e-02    17s
  31   8.44914640e+04  8.80805273e+04  3.15e-03 1.40e-04  1.10e-02    17s
  32   8.47377779e+04  8.77280934e+04  2.80e-03 1.01e-04  9.15e-03    17s
  33   8.48687620e+04  8.74762542e+04  2.62e-03 7.16e-05  7.98e-03    18s
  34   8.56054550e+04  8.72463837e+04  1.59e-03 1.05e-04  5.02e-03    18s
  35   8.60997993e+04  8.70728694e+04  9.22e-04 6.48e-05  2.98e-03    18s
  36   8.62210978e+04  8.69575479e+04  7.46e-04 3.87e-05  2.25e-03    18s
  37   8.64045591e+04  8.69107216e+04  4.94e-04 2.85e-05  1.55e-03    18s
  38   8.64964049e+04  8.68561806e+04  3.68e-04 1.61e-05  1.10e-03    19s
  39   8.65871711e+04  8.68306429e+04  2.43e-04 1.07e-05  7.45e-04    19s
  40   8.66263162e+04  8.68269752e+04  1.94e-04 9.68e-06  6.14e-04    19s
  41   8.66757182e+04  8.68143470e+04  1.31e-04 7.07e-06  4.24e-04    19s
  42   8.67004388e+04  8.68052994e+04  9.91e-05 5.19e-06  3.21e-04    19s
  43   8.67379345e+04  8.67991024e+04  5.26e-05 3.82e-06  1.87e-04    20s
  44   8.67544570e+04  8.67908709e+04  3.20e-05 2.11e-06  1.11e-04    20s
  45   8.67579020e+04  8.67893709e+04  2.77e-05 1.80e-06  9.63e-05    20s
  46   8.67626209e+04  8.67872672e+04  2.16e-05 1.39e-06  7.54e-05    20s
  47   8.67645445e+04  8.67845042e+04  1.92e-05 8.88e-07  6.11e-05    20s
  48   8.67755597e+04  8.67835399e+04  5.27e-06 6.53e-07  2.44e-05    21s
  49   8.67794057e+04  8.67818380e+04  8.24e-07 3.10e-07  7.43e-06    21s
  50   8.67795099e+04  8.67812789e+04  7.05e-07 2.24e-07  5.41e-06    21s
  51   8.67795687e+04  8.67808701e+04  6.46e-07 1.48e-07  3.98e-06    22s
  52   8.67798615e+04  8.67807494e+04  3.33e-07 1.25e-07  2.71e-06    22s
  53   8.67801115e+04  8.67806854e+04  7.50e-08 1.09e-07  1.75e-06    22s
  54   8.67801742e+04  8.67806571e+04  2.70e-08 1.03e-07  1.47e-06    22s
  55   8.67801756e+04  8.67806507e+04  6.37e-07 9.01e-08  1.45e-06    23s
  56   8.67802025e+04  8.67803603e+04  1.17e-07 3.18e-08  4.82e-07    23s
  57   8.67802095e+04  8.67802102e+04  2.37e-09 1.78e-09  2.05e-09    24s

Barrier solved model in 57 iterations and 23.58 seconds (23.68 work units)
Optimal objective 8.67802095e+04


Root crossover log...

  160878 DPushes remaining with DInf 0.0000000e+00                24s
   61924 DPushes remaining with DInf 0.0000000e+00                25s
    8559 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                32s

    3630 PPushes remaining with PInf 1.4173870e-05                32s
       0 PPushes remaining with PInf 0.0000000e+00                33s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2624449e+04     33s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77334    8.6780210e+04   0.000000e+00   1.262445e+04     33s
   77522    8.6780210e+04   0.000000e+00   0.000000e+00     33s
   77522    8.6780210e+04   0.000000e+00   0.000000e+00     33s
Concurrent spin time: 10.51s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.678021e+04, 77522 iterations, 35.24 seconds (33.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 86780.2100    0  158 -203987.28 86780.2100   143%     -   45s
H    0     0                    -201272.8287 86780.2100   143%     -   45s
H    0     0                    -104903.1342 86780.2100   183%     -   45s
H    0     0                    -96401.15967 86780.2100   190%     -   46s
H    0     0                    -95725.10988 86780.2100   191%     -   46s
H    0     0                    -49426.85748 86780.2100   276%     -   46s
H    0     0                    15557.042088 86780.2100   458%     -   47s
H    0     0                    43426.177288 86780.2100   100%     -   48s
H    0     0                    44428.517864 86780.2100  95.3%     -   49s
H    0     0                    46169.800382 86780.2100  88.0%     -   50s
H    0     0                    48296.878009 86780.2100  79.7%     -   51s
H    0     0                    48375.437356 86780.2100  79.4%     -   51s
H    0     0                    48565.878384 86780.2100  78.7%     -   51s
H    0     0                    48773.728152 86780.2100  77.9%     -   51s
H    0     0                    48906.791939 86780.2100  77.4%     -   52s
H    0     0                    48984.859393 86780.2100  77.2%     -   52s
H    0     0                    49422.104603 86780.2100  75.6%     -   52s
H    0     0                    49515.773747 86780.2100  75.3%     -   52s
     0     0 80998.7791    0  167 49515.7737 80998.7791  63.6%     -  247s
H    0     0                    49650.303002 80998.1404  63.1%     -  250s
H    0     0                    50209.733307 80998.1404  61.3%     -  251s
H    0     0                    50230.433327 80998.1404  61.3%     -  251s
     0     0 80455.5462    0  191 50230.4333 80455.5462  60.2%     -  367s
     0     0 80419.3757    0  197 50230.4333 80419.3757  60.1%     -  385s
     0     0 80403.8810    0  191 50230.4333 80403.8810  60.1%     -  394s
     0     0 80361.3741    0  191 50230.4333 80361.3741  60.0%     -  413s
     0     0 80356.4200    0  193 50230.4333 80356.4200  60.0%     -  421s
     0     0 80355.6159    0  189 50230.4333 80355.6159  60.0%     -  424s
     0     0 80353.6107    0  189 50230.4333 80353.6107  60.0%     -  427s
     0     0 80352.7691    0  193 50230.4333 80352.7691  60.0%     -  427s
     0     0 80352.7691    0  193 50230.4333 80352.7691  60.0%     -  429s
     0     0 77804.0581    0  208 50230.4333 77804.0581  54.9%     -  571s
     0     0 77170.7153    0  267 50230.4333 77170.7153  53.6%     -  659s
     0     0 77028.4211    0  259 50230.4333 77028.4211  53.4%     -  702s
     0     0 76915.5753    0  237 50230.4333 76915.5753  53.1%     -  744s
     0     0 76905.0775    0  235 50230.4333 76905.0775  53.1%     -  756s
     0     0 76765.4536    0  239 50230.4333 76765.4536  52.8%     -  794s
     0     0 76734.6262    0  259 50230.4333 76734.6262  52.8%     -  830s
     0     0 76685.4344    0  260 50230.4333 76685.4344  52.7%     -  865s
     0     0 76683.7306    0  259 50230.4333 76683.7306  52.7%     -  875s
     0     0 76634.2117    0  284 50230.4333 76634.2117  52.6%     -  904s
     0     0 76620.8210    0  260 50230.4333 76620.8210  52.5%     -  925s
     0     0 76616.1850    0  266 50230.4333 76616.1850  52.5%     -  938s
     0     0 76612.5312    0  294 50230.4333 76612.5312  52.5%     -  945s
     0     0 76609.8113    0  265 50230.4333 76609.8113  52.5%     -  956s
     0     0 76609.0216    0  256 50230.4333 76609.0216  52.5%     -  962s
     0     0 74173.1209    0  301 50230.4333 74173.1209  47.7%     - 1208s
H    0     0                    50656.171041 74172.9791  46.4%     - 1211s
H    0     0                    50677.735421 74172.9791  46.4%     - 1211s
H    0     0                    50708.423146 74172.9791  46.3%     - 1211s
H    0     0                    50731.178057 74172.9791  46.2%     - 1211s
H    0     0                    50897.826130 74172.9791  45.7%     - 1211s
     0     0 73250.1078    0  289 50897.8261 73250.1078  43.9%     - 1337s
     0     0 73037.9181    0  307 50897.8261 73037.9181  43.5%     - 1416s
     0     0 72925.4929    0  308 50897.8261 72925.4929  43.3%     - 1478s
     0     0 72851.1613    0  322 50897.8261 72851.1613  43.1%     - 1556s
     0     0 72762.8298    0  311 50897.8261 72762.8298  43.0%     - 1609s
     0     0 72728.6784    0  320 50897.8261 72728.6784  42.9%     - 1634s
     0     0 72679.2817    0  322 50897.8261 72679.2817  42.8%     - 1678s
     0     0 72614.5399    0  334 50897.8261 72614.5399  42.7%     - 1722s
     0     0 72593.8433    0  336 50897.8261 72593.8433  42.6%     - 1751s
     0     0 72561.7621    0  334 50897.8261 72561.7621  42.6%     - 1772s
     0     0 72553.8149    0  340 50897.8261 72553.8149  42.5%     - 1784s
     0     0 72543.1074    0  331 50897.8261 72543.1074  42.5%     - 1802s
     0     0 72528.8827    0  334 50897.8261 72528.8827  42.5%     - 1816s
     0     0 72497.6197    0  330 50897.8261 72497.6197  42.4%     - 1834s
     0     0 72470.8221    0  329 50897.8261 72470.8221  42.4%     - 1854s
     0     0 72465.9839    0  331 50897.8261 72465.9839  42.4%     - 1864s
     0     0 72445.0932    0  337 50897.8261 72445.0932  42.3%     - 1876s
     0     0 72429.7692    0  331 50897.8261 72429.7692  42.3%     - 1893s
     0     0 72428.6473    0  331 50897.8261 72428.6473  42.3%     - 1897s
     0     0 71492.1114    0  317 50897.8261 71492.1114  40.5%     - 2034s
     0     0 71224.4713    0  333 50897.8261 71224.4713  39.9%     - 2101s
     0     0 71034.3521    0  354 50897.8261 71034.3521  39.6%     - 2149s
     0     0 70891.1485    0  352 50897.8261 70891.1485  39.3%     - 2191s
     0     0 70842.2387    0  365 50897.8261 70842.2387  39.2%     - 2216s
     0     0 70795.3600    0  358 50897.8261 70795.3600  39.1%     - 2241s
     0     0 70783.4907    0  349 50897.8261 70783.4907  39.1%     - 2254s
     0     0 70778.0725    0  364 50897.8261 70778.0725  39.1%     - 2261s
     0     0 70771.6487    0  359 50897.8261 70771.6487  39.0%     - 2267s
     0     0 70764.9068    0  367 50897.8261 70764.9068  39.0%     - 2273s
     0     0 70755.5052    0  361 50897.8261 70755.5052  39.0%     - 2282s
     0     0 70744.3567    0  355 50897.8261 70744.3567  39.0%     - 2293s
     0     0 70712.2711    0  349 50897.8261 70712.2711  38.9%     - 2314s
     0     0 70711.4884    0  351 50897.8261 70711.4884  38.9%     - 2317s
     0     0 70358.0042    0  379 50897.8261 70358.0042  38.2%     - 2373s
     0     0 70278.8343    0  385 50897.8261 70278.8343  38.1%     - 2407s
     0     0 70239.8304    0  396 50897.8261 70239.8304  38.0%     - 2429s
     0     0 70210.0413    0  381 50897.8261 70210.0413  37.9%     - 2446s
     0     0 70181.7563    0  393 50897.8261 70181.7563  37.9%     - 2462s
     0     0 70177.5961    0  399 50897.8261 70177.5961  37.9%     - 2466s
     0     0 70175.9167    0  402 50897.8261 70175.9167  37.9%     - 2470s
     0     0 69990.3378    0  353 50897.8261 69990.3378  37.5%     - 2513s
H    0     0                    51196.906376 69988.7868  36.7%     - 2546s
     0     0 69956.0758    0  357 51196.9064 69956.0758  36.6%     - 2576s
     0     0 69947.0848    0  363 51196.9064 69947.0848  36.6%     - 2586s
     0     0 69940.2825    0  357 51196.9064 69940.2825  36.6%     - 2597s
     0     0 69936.5211    0  358 51196.9064 69936.5211  36.6%     - 2603s
     0     0 69930.7766    0  353 51196.9064 69930.7766  36.6%     - 2612s
     0     0 69927.3981    0  359 51196.9064 69927.3981  36.6%     - 2617s
     0     0 69913.3666    0  355 51196.9064 69913.3666  36.6%     - 2627s
     0     0 69895.4614    0  394 51196.9064 69895.4614  36.5%     - 2646s
     0     0 69889.3287    0  358 51196.9064 69889.3287  36.5%     - 2652s
     0     0 69885.8859    0  396 51196.9064 69885.8859  36.5%     - 2657s
     0     0 69879.1975    0  406 51196.9064 69879.1975  36.5%     - 2665s
     0     0 69874.1415    0  405 51196.9064 69874.1415  36.5%     - 2671s
     0     0 69872.1145    0  355 51196.9064 69872.1145  36.5%     - 2675s
     0     0 69748.9818    0  349 51196.9064 69748.9818  36.2%     - 2710s
     0     0 69696.4949    0  403 51196.9064 69696.4949  36.1%     - 2735s
     0     0 69679.7765    0  408 51196.9064 69679.7765  36.1%     - 2748s
     0     0 69672.8468    0  377 51196.9064 69672.8468  36.1%     - 2753s
     0     0 69670.4630    0  415 51196.9064 69670.4630  36.1%     - 2757s
     0     0 69667.2245    0  419 51196.9064 69667.2245  36.1%     - 2761s
     0     0 69665.4779    0  423 51196.9064 69665.4779  36.1%     - 2764s
     0     0 69538.9802    0  409 51196.9064 69538.9802  35.8%     - 2805s
H    0     0                    51614.722146 69538.8677  34.7%     - 2865s
     0     0 69513.1641    0  415 51614.7221 69513.1641  34.7%     - 2885s
     0     0 69505.2948    0  421 51614.7221 69505.2948  34.7%     - 2891s
     0     0 69501.8401    0  427 51614.7221 69501.8401  34.7%     - 2895s
     0     0 69500.5385    0  421 51614.7221 69500.5385  34.7%     - 2897s
     0     0 69462.2938    0  408 51614.7221 69462.2938  34.6%     - 2925s
     0     0 69443.2267    0  423 51614.7221 69443.2267  34.5%     - 2942s
     0     0 69433.2596    0  424 51614.7221 69433.2596  34.5%     - 2949s
     0     0 69427.0346    0  419 51614.7221 69427.0346  34.5%     - 2956s
     0     0 69426.1640    0  417 51614.7221 69426.1640  34.5%     - 2958s
     0     0 69414.4318    0  423 51614.7221 69414.4318  34.5%     - 2977s
     0     0 69408.3563    0  422 51614.7221 69408.3563  34.5%     - 2983s
     0     0 69407.7991    0  426 51614.7221 69407.7991  34.5%     - 2986s
     0     0 69396.8232    0  417 51614.7221 69396.8232  34.5%     - 3000s
     0     0 69392.3462    0  425 51614.7221 69392.3462  34.4%     - 3006s
     0     0 69389.0585    0  429 51614.7221 69389.0585  34.4%     - 3010s
     0     0 69387.4484    0  422 51614.7221 69387.4484  34.4%     - 3013s
     0     0 69376.9707    0  409 51614.7221 69376.9707  34.4%     - 3029s
     0     0 69371.2277    0  406 51614.7221 69371.2277  34.4%     - 3041s
     0     0 69369.9300    0  410 51614.7221 69369.9300  34.4%     - 3044s
     0     0 69352.8394    0  422 51614.7221 69352.8394  34.4%     - 3064s
     0     0 69351.3306    0  422 51614.7221 69351.3306  34.4%     - 3072s
H    0     0                    51860.863172 69351.3306  33.7%     - 3249s
H    0     0                    51901.530053 69351.3306  33.6%     - 3249s
     0     2 69351.3306    0  422 51901.5301 69351.3306  33.6%     - 3480s
     1     3 69307.1946    1  396 51901.5301 69351.2078  33.6%  9615 3508s
     2     4 69269.5509    1  414 51901.5301 69306.9742  33.5% 12563 3546s
     3     5 69041.2803    2  392 51901.5301 69306.9742  33.5% 12335 3576s
     4     6 69173.2891    2  421 51901.5301 69306.9742  33.5% 10716 3600s

Cutting planes:
  Implied bound: 169
  MIR: 2355
  Flow cover: 2258
  RLT: 24
  Relax-and-lift: 442

Explored 5 nodes (1090570 simplex iterations) in 3600.07 seconds (4060.00 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51901.5 51860.9 51614.7 ... 50230.4

Time limit reached
Best objective 5.190153005339e+04, best bound 6.930697422264e+04, gap 33.5355%
  WARNING: Time limit reached. Using best solution found (gap: 33.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 51901.53, θ = 216513.86
  Upper Bound (UB) = 51901.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216513.86
  [DEBUG]   ✓ Scenario 0: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216513.86 ≤ Q = 216513.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216513.86 ≤ Q = 216513.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216513.86 ≤ Q = 216513.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 216513.86 ≤ Q = 216513.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 216513.86 ≤ Q = 216513.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 216513.86 ≤ Q = 216513.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 216513.86 ≤ Q = 216513.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x53b3709
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfac4c8f7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.395565e+13
Presolve removed 2553 rows and 1844 columns
Presolve time: 0.01s
Presolved: 540 rows, 545 columns, 1524 nonzeros
Found heuristic solution: objective 6838079.9136
Variable types: 371 continuous, 174 integer (174 binary)

Root relaxation: objective -1.896311e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189631.05    0  124 6838079.91 -189631.05   103%     -    0s
H    0     0                    -152281.6542 -189631.05  24.5%     -    0s
H    0     0                    -152826.2581 -189631.05  24.1%     -    0s
H    0     0                    -155368.5959 -189631.05  22.1%     -    0s
H    0     0                    -155376.7169 -165564.02  6.56%     -    0s
     0     0 -165564.02    0  133 -155376.72 -165564.02  6.56%     -    0s
H    0     0                    -161506.8010 -165446.73  2.44%     -    0s
     0     0 -163993.41    0  141 -161506.80 -163993.41  1.54%     -    0s
H    0     0                    -162983.9076 -163989.16  0.62%     -    0s
     0     0 -163654.26    0  107 -162983.91 -163654.26  0.41%     -    0s
H    0     0                    -162990.2741 -163491.82  0.31%     -    0s
     0     0 -163491.82    0  120 -162990.27 -163491.82  0.31%     -    0s
     0     0 -163484.39    0  108 -162990.27 -163484.39  0.30%     -    0s
     0     0 -163352.77    0   81 -162990.27 -163352.77  0.22%     -    0s
     0     0 -163349.33    0   81 -162990.27 -163349.33  0.22%     -    0s
     0     0 -163329.34    0   80 -162990.27 -163329.34  0.21%     -    0s
     0     0 -163324.93    0   80 -162990.27 -163324.93  0.21%     -    0s
H    0     0                    -163032.2646 -163324.93  0.18%     -    0s
     0     2 -163324.93    0   80 -163032.26 -163324.93  0.18%     -    0s

Cutting planes:
  Gomory: 51
  Implied bound: 5
  MIR: 187
  Flow cover: 5
  RLT: 32
  Relax-and-lift: 4
  BQP: 1

Explored 338 nodes (2336 simplex iterations) in 0.22 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -163032 -162990 -162984 ... 1.39557e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.630322646458e+05, best bound -1.630418031295e+05, gap 0.0059%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 210062.62
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -163032.26
  [DEBUG]   S×d_nominal = 373094.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373094.88 + -163032.26 = 210062.62
  [DEBUG]   Current θ from Master = 216513.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6451.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45450.29
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 1737.4223, Absolute Gap = 1737.4223, Relative Gap = 0.033475
  Not converged yet (gap = 1737.42 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913811 nonzeros
Model fingerprint: 0xd8ae6616
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 133623 rows and 54243 columns (presolve time = 5s)...
Presolve removed 133623 rows and 54243 columns
Presolve time: 6.90s
Presolved: 188850 rows, 79057 columns, 1160261 nonzeros
Variable types: 76798 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -211318.7458

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.37s

Barrier statistics:
 Dense cols : 1210
 AA' NZ     : 4.438e+06
 Factor NZ  : 1.276e+07 (roughly 200 MB of memory)
 Factor Ops : 4.562e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.77564616e+07  3.48806299e+08  2.14e+05 1.51e+01  1.27e+05    12s
   1  -2.22141124e+07  3.43269825e+08  1.56e+05 1.15e+02  9.23e+04    12s
   2  -1.19344024e+07  2.83797600e+08  7.89e+04 3.08e+01  4.84e+04    12s
   3  -2.63650814e+06  2.13233418e+08  1.39e+04 6.25e+00  8.98e+03    12s
   4  -9.59165322e+05  1.42972603e+08  2.24e+03 9.87e-01  1.70e+03    12s
   5  -7.12200812e+05  6.67835602e+07  6.40e+02 2.10e-01  5.20e+02    13s
   6  -6.41132103e+05  4.56579540e+07  3.54e+02 1.20e-01  3.01e+02    13s
   7  -5.25923210e+05  3.73371671e+07  1.37e+02 9.43e-02  1.71e+02    13s
   8  -3.75064470e+05  2.60390725e+07  4.80e+01 5.92e-02  9.54e+01    13s
   9  -2.41480856e+05  1.87490714e+07  2.27e+01 4.06e-02  6.25e+01    13s
  10  -1.61812372e+05  1.48945858e+07  1.12e+01 3.16e-02  4.68e+01    13s
  11  -1.48467868e+05  9.01339436e+06  8.38e+00 1.82e-02  2.82e+01    13s
  12  -1.25452751e+05  6.57168613e+06  4.83e+00 1.32e-02  2.01e+01    14s
  13  -9.65525092e+04  3.19771856e+06  2.40e+00 6.23e-03  9.76e+00    14s
  14  -6.25858692e+04  7.64320959e+05  9.45e-01 1.38e-03  2.43e+00    14s
  15  -3.20988149e+04  5.24367119e+05  5.74e-01 9.20e-04  1.63e+00    14s
  16   8.12481047e+02  3.01012745e+05  3.12e-01 8.36e-04  8.77e-01    14s
  17   2.01470951e+04  1.89759107e+05  2.34e-01 3.70e-03  4.96e-01    14s
  18   3.39952479e+04  1.66802700e+05  1.84e-01 2.23e-03  3.88e-01    15s
  19   3.94321720e+04  1.51931506e+05  1.61e-01 2.16e-03  3.29e-01    15s
  20   4.30717121e+04  1.44241169e+05  1.47e-01 1.90e-03  2.96e-01    15s
  21   4.54772966e+04  1.36535752e+05  1.38e-01 1.68e-03  2.66e-01    15s
  22   5.06845329e+04  1.22934080e+05  1.18e-01 1.73e-03  2.11e-01    15s
  23   5.43338306e+04  1.14879482e+05  1.04e-01 2.63e-03  1.77e-01    15s
  24   5.76790736e+04  1.06465314e+05  9.10e-02 2.77e-03  1.43e-01    15s
  25   5.91220520e+04  1.05208690e+05  8.57e-02 2.82e-03  1.35e-01    16s
  26   6.65245520e+04  1.01786208e+05  5.95e-02 2.30e-03  1.03e-01    16s
  27   6.99771289e+04  9.71095477e+04  4.76e-02 1.75e-03  7.93e-02    16s
  28   7.17450460e+04  9.37240019e+04  4.18e-02 1.63e-03  6.43e-02    16s
  29   7.55541029e+04  9.16291435e+04  3.00e-02 1.21e-03  4.70e-02    16s
  30   7.68504935e+04  9.00413124e+04  2.60e-02 9.04e-04  3.86e-02    16s
  31   7.83843706e+04  8.91751130e+04  2.14e-02 7.12e-04  3.16e-02    17s
  32   8.04372853e+04  8.78057077e+04  1.52e-02 7.72e-04  2.16e-02    17s
  33   8.26391816e+04  8.73393232e+04  9.03e-03 5.74e-04  1.37e-02    17s
  34   8.27972234e+04  8.71046841e+04  8.59e-03 4.79e-04  1.26e-02    17s
  35   8.37502558e+04  8.66042569e+04  5.85e-03 2.95e-04  8.35e-03    17s
  36   8.40563344e+04  8.64307801e+04  5.00e-03 2.22e-04  6.95e-03    18s
  37   8.41954369e+04  8.63772443e+04  4.62e-03 1.97e-04  6.39e-03    18s
  38   8.43119970e+04  8.63275204e+04  4.30e-03 1.75e-04  5.90e-03    18s
  39   8.46213102e+04  8.62190057e+04  3.41e-03 1.41e-04  4.68e-03    18s
  40   8.49701820e+04  8.61314834e+04  2.44e-03 1.04e-04  3.40e-03    19s
  41   8.50225977e+04  8.60750288e+04  2.30e-03 8.04e-05  3.08e-03    19s
  42   8.52552017e+04  8.60308458e+04  1.64e-03 6.44e-05  2.27e-03    19s
  43   8.53133879e+04  8.60166654e+04  1.49e-03 5.86e-05  2.06e-03    19s
  44   8.53528817e+04  8.59987155e+04  1.38e-03 5.23e-05  1.89e-03    19s
  45   8.53700044e+04  8.59938367e+04  1.33e-03 5.05e-05  1.83e-03    20s
  46   8.53948688e+04  8.59891567e+04  1.25e-03 4.92e-05  1.74e-03    20s
  47   8.54299090e+04  8.59707534e+04  1.16e-03 4.30e-05  1.58e-03    20s
  48   8.54703205e+04  8.59675666e+04  1.03e-03 4.20e-05  1.46e-03    20s
  49   8.55199278e+04  8.59431926e+04  8.97e-04 3.36e-05  1.24e-03    21s
  50   8.55556675e+04  8.59176408e+04  7.95e-04 2.34e-05  1.06e-03    21s
  51   8.55734929e+04  8.59102534e+04  7.46e-04 2.10e-05  9.86e-04    21s
  52   8.56272903e+04  8.59072021e+04  6.00e-04 1.98e-05  8.19e-04    21s
  53   8.56622263e+04  8.58974603e+04  5.01e-04 1.52e-05  6.88e-04    22s
  54   8.56968873e+04  8.58871094e+04  4.03e-04 1.21e-05  5.57e-04    22s
  55   8.57336370e+04  8.58764326e+04  3.03e-04 2.09e-05  4.18e-04    22s
  56   8.57887803e+04  8.58693820e+04  1.55e-04 1.46e-05  2.36e-04    22s
  57   8.58187152e+04  8.58592601e+04  7.79e-05 6.45e-06  1.19e-04    23s
  58   8.58433129e+04  8.58528967e+04  1.74e-05 8.98e-06  2.80e-05    23s
  59   8.58464279e+04  8.58518248e+04  1.03e-05 2.10e-06  1.58e-05    23s
  60   8.58492289e+04  8.58512642e+04  4.14e-06 2.65e-07  5.96e-06    23s
  61   8.58510004e+04  8.58511609e+04  1.92e-07 3.34e-08  4.69e-07    23s
  62   8.58511414e+04  8.58511415e+04  2.18e-09 1.42e-09  4.79e-10    24s

Barrier solved model in 62 iterations and 23.56 seconds (20.22 work units)
Optimal objective 8.58511414e+04


Root crossover log...

  168441 DPushes remaining with DInf 0.0000000e+00                24s
   65035 DPushes remaining with DInf 0.0000000e+00                25s
    1550 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                31s

    7439 PPushes remaining with PInf 7.2318076e-05                31s
       0 PPushes remaining with PInf 0.0000000e+00                32s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.5846527e+02     32s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   80840    8.5851141e+04   0.000000e+00   9.584653e+02     32s
   80854    8.5851141e+04   0.000000e+00   0.000000e+00     32s
   80854    8.5851141e+04   0.000000e+00   0.000000e+00     32s
Concurrent spin time: 0.33s

Solved with barrier

Root relaxation: objective 8.585114e+04, 80854 iterations, 24.14 seconds (24.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 85851.1415    0  150 -211318.75 85851.1415   141%     -   33s
H    0     0                    -208038.1658 85851.1415   141%     -   36s
H    0     0                    -193605.7375 85851.1415   144%     -   36s
H    0     0                    -190391.8847 85851.1415   145%     -   37s
H    0     0                    -188092.4938 85851.1415   146%     -   40s
H    0     0                    -184899.0431 85851.1415   146%     -   40s
H    0     0                    -182640.5789 85851.1415   147%     -   40s
H    0     0                    -182571.2471 85851.1415   147%     -   41s
H    0     0                    -182347.4757 85851.1415   147%     -   41s
H    0     0                    -182160.9920 85851.1415   147%     -   41s
H    0     0                    -5584.589620 85851.1415  1637%     -   42s
H    0     0                    8641.1960999 85851.1415   894%     -   42s
H    0     0                    9454.7015710 85851.1415   808%     -   42s
H    0     0                    11064.210028 85851.1415   676%     -   43s
H    0     0                    11215.993886 85851.1415   665%     -   43s
H    0     0                    12135.568405 85851.1415   607%     -   43s
H    0     0                    12291.916701 85851.1415   598%     -   43s
H    0     0                    12490.551908 85851.1415   587%     -   43s
     0     0 79191.9014    0  168 12490.5519 79191.9014   534%     -  140s
H    0     0                    25671.009277 79188.3847   208%     -  142s
H    0     0                    37416.830479 79188.3847   112%     -  143s
H    0     0                    37703.228858 79188.3847   110%     -  143s
H    0     0                    38394.969246 79188.3847   106%     -  143s
H    0     0                    38980.104652 79188.3847   103%     -  143s
H    0     0                    39171.198768 79188.3847   102%     -  143s
H    0     0                    39645.741959 79188.3847   100%     -  143s
H    0     0                    40331.382621 79188.3847  96.3%     -  143s
H    0     0                    40349.845504 79188.3847  96.3%     -  143s
     0     0 78944.6090    0  187 40349.8455 78944.6090  95.7%     -  192s
     0     0 78880.3825    0  191 40349.8455 78880.3825  95.5%     -  220s
     0     0 78861.0273    0  188 40349.8455 78861.0273  95.4%     -  237s
     0     0 78804.9894    0  190 40349.8455 78804.9894  95.3%     -  259s
     0     0 78801.6927    0  196 40349.8455 78801.6927  95.3%     -  263s
     0     0 78801.5991    0  198 40349.8455 78801.5991  95.3%     -  266s
     0     0 75186.4297    0  237 40349.8455 75186.4297  86.3%     -  408s
H    0     0                    48032.235503 75186.3637  56.5%     -  409s
H    0     0                    48123.117738 75186.3637  56.2%     -  410s
H    0     0                    48282.884817 75186.3637  55.7%     -  410s
H    0     0                    48305.222743 75186.3637  55.6%     -  410s
     0     0 74461.4158    0  250 48305.2227 74461.4158  54.1%     -  504s
     0     0 74342.8939    0  254 48305.2227 74342.8939  53.9%     -  561s
     0     0 74270.2904    0  260 48305.2227 74270.2904  53.8%     -  597s
     0     0 74238.8535    0  263 48305.2227 74238.8535  53.7%     -  620s
     0     0 74101.3164    0  253 48305.2227 74101.3164  53.4%     -  655s
     0     0 73991.6189    0  259 48305.2227 73991.6189  53.2%     -  687s
     0     0 73823.6001    0  273 48305.2227 73823.6001  52.8%     -  737s
     0     0 73802.3206    0  274 48305.2227 73802.3206  52.8%     -  756s
     0     0 73795.9811    0  306 48305.2227 73795.9811  52.8%     -  767s
     0     0 73791.7103    0  304 48305.2227 73791.7103  52.8%     -  773s
     0     0 73791.0910    0  302 48305.2227 73791.0910  52.8%     -  776s
     0     0 71443.5226    0  296 48305.2227 71443.5226  47.9%     -  910s
H    0     0                    48453.818009 71443.2059  47.4%     -  913s
H    0     0                    48528.967811 71443.2059  47.2%     -  913s
     0     0 71015.0633    0  319 48528.9678 71015.0633  46.3%     -  975s
     0     0 70844.3797    0  356 48528.9678 70844.3797  46.0%     - 1025s
     0     0 70777.6948    0  358 48528.9678 70777.6948  45.8%     - 1045s
     0     0 70679.2624    0  357 48528.9678 70679.2624  45.6%     - 1070s
     0     0 70653.4228    0  364 48528.9678 70653.4228  45.6%     - 1079s
     0     0 70616.5819    0  375 48528.9678 70616.5819  45.5%     - 1087s
     0     0 70572.4537    0  361 48528.9678 70572.4537  45.4%     - 1115s
     0     0 70566.0139    0  365 48528.9678 70566.0139  45.4%     - 1123s
     0     0 70496.6354    0  367 48528.9678 70496.6354  45.3%     - 1134s
     0     0 70479.5682    0  381 48528.9678 70479.5682  45.2%     - 1141s
     0     0 70477.6887    0  374 48528.9678 70477.6887  45.2%     - 1145s
     0     0 69506.5680    0  385 48528.9678 69506.5680  43.2%     - 1219s
H    0     0                    48787.747850 69504.9539  42.5%     - 1221s
     0     0 69254.6299    0  377 48787.7478 69254.6299  42.0%     - 1256s
     0     0 69064.3536    0  387 48787.7478 69064.3536  41.6%     - 1291s
     0     0 69037.8983    0  393 48787.7478 69037.8983  41.5%     - 1314s
     0     0 68983.1943    0  379 48787.7478 68983.1943  41.4%     - 1331s
     0     0 68949.5874    0  376 48787.7478 68949.5874  41.3%     - 1346s
     0     0 68945.4278    0  386 48787.7478 68945.4278  41.3%     - 1355s
     0     0 68944.1985    0  391 48787.7478 68944.1985  41.3%     - 1359s
     0     0 68679.4298    0  391 48787.7478 68679.4298  40.8%     - 1407s
H    0     0                    48867.601762 68678.1227  40.5%     - 1410s
     0     0 68607.1973    0  400 48867.6018 68607.1973  40.4%     - 1435s
     0     0 68577.5159    0  388 48867.6018 68577.5159  40.3%     - 1449s
     0     0 68554.7685    0  402 48867.6018 68554.7685  40.3%     - 1460s
     0     0 68538.4342    0  413 48867.6018 68538.4342  40.3%     - 1474s
     0     0 68525.9009    0  404 48867.6018 68525.9009  40.2%     - 1482s
     0     0 68510.9001    0  402 48867.6018 68510.9001  40.2%     - 1490s
     0     0 68485.9255    0  412 48867.6018 68485.9255  40.1%     - 1499s
     0     0 68480.4147    0  409 48867.6018 68480.4147  40.1%     - 1507s
     0     0 68469.3493    0  410 48867.6018 68469.3493  40.1%     - 1513s
     0     0 68465.8921    0  413 48867.6018 68465.8921  40.1%     - 1519s
     0     0 68465.8528    0  412 48867.6018 68465.8528  40.1%     - 1524s
     0     0 68357.5716    0  394 48867.6018 68357.5716  39.9%     - 1559s
     0     0 68337.0417    0  402 48867.6018 68337.0417  39.8%     - 1577s
     0     0 68323.7274    0  405 48867.6018 68323.7274  39.8%     - 1583s
     0     0 68317.6200    0  412 48867.6018 68317.6200  39.8%     - 1589s
     0     0 68315.1500    0  407 48867.6018 68315.1500  39.8%     - 1597s
     0     0 68312.0022    0  416 48867.6018 68312.0022  39.8%     - 1601s
     0     0 68308.8988    0  418 48867.6018 68308.8988  39.8%     - 1603s
     0     0 68306.8978    0  414 48867.6018 68306.8978  39.8%     - 1605s
     0     0 68256.3376    0  413 48867.6018 68256.3376  39.7%     - 1623s
H    0     0                    48935.477809 68255.7525  39.5%     - 1626s
H    0     0                    49367.331408 68255.7525  38.3%     - 1626s
     0     0 68244.6327    0  411 49367.3314 68244.6327  38.2%     - 1635s
     0     0 68239.0527    0  416 49367.3314 68239.0527  38.2%     - 1640s
     0     0 68233.2410    0  417 49367.3314 68233.2410  38.2%     - 1645s
     0     0 68227.4816    0  421 49367.3314 68227.4816  38.2%     - 1652s
     0     0 68221.0873    0  418 49367.3314 68221.0873  38.2%     - 1657s
     0     0 68219.2059    0  423 49367.3314 68219.2059  38.2%     - 1659s
     0     0 68195.0397    0  410 49367.3314 68195.0397  38.1%     - 1675s
     0     0 68187.5615    0  417 49367.3314 68187.5615  38.1%     - 1690s
     0     0 68184.0628    0  413 49367.3314 68184.0628  38.1%     - 1694s
     0     0 68178.8818    0  427 49367.3314 68178.8818  38.1%     - 1699s
     0     0 68177.3328    0  427 49367.3314 68177.3328  38.1%     - 1702s
     0     0 68144.1201    0  426 49367.3314 68144.1201  38.0%     - 1718s
     0     0 68137.5139    0  428 49367.3314 68137.5139  38.0%     - 1727s
     0     0 68135.4757    0  419 49367.3314 68135.4757  38.0%     - 1731s
     0     0 68114.4974    0  402 49367.3314 68114.4974  38.0%     - 1746s
H    0     0                    49495.426530 68111.9224  37.6%     - 1764s
     0     0 68109.7662    0  406 49495.4265 68109.7662  37.6%     - 1768s
     0     0 68106.5332    0  396 49495.4265 68106.5332  37.6%     - 1772s
     0     0 68106.1613    0  404 49495.4265 68106.1613  37.6%     - 1774s
     0     0 68101.9251    0  416 49495.4265 68101.9251  37.6%     - 1782s
H    0     0                    49563.661758 68101.3585  37.4%     - 1785s
     0     0 68101.0504    0  420 49563.6618 68101.0504  37.4%     - 1787s
     0     0 68099.9992    0  420 49563.6618 68099.9992  37.4%     - 1794s
     0     0 68099.7799    0  420 49563.6618 68099.7799  37.4%     - 1809s
     0     0 68098.2247    0  411 49563.6618 68098.2247  37.4%     - 1815s
     0     0 68097.5271    0  411 49563.6618 68097.5271  37.4%     - 1823s
H    0     0                    49671.601406 68097.1208  37.1%     - 1967s
H    0     0                    49874.210127 68097.1208  36.5%     - 2082s
H    0     0                    50007.084451 68097.1208  36.2%     - 2082s
H    0     0                    50078.113333 68097.1208  36.0%     - 2082s
H    0     0                    50079.214312 68097.1208  36.0%     - 2134s
     0     2 68097.1208    0  411 50079.2143 68097.1208  36.0%     - 2142s
     1     3 68048.1365    1  394 50079.2143 68096.6162  36.0% 12055 2174s
     2     4 68031.2615    1  400 50079.2143 68047.4312  35.9% 12783 2201s
     3     5 67722.1396    2  404 50079.2143 68047.4312  35.9% 14250 2244s
     4     9 67091.8824    2  381 50079.2143 68028.7453  35.8% 12203 2297s
     8    17 66871.8365    3  389 50079.2143 67738.4635  35.3% 13343 2414s
    16    32 66448.6445    4  373 50079.2143 67738.0297  35.3% 18520 2478s
    31    47 65211.7509    4  337 50079.2143 67535.4429  34.9% 29137 2608s
    46    77 65504.0950    7  407 50079.2143 67351.7832  34.5% 32320 2745s
H   48    77                    50247.297590 67351.7832  34.0% 31406 2745s
H   53    77                    50568.615802 67351.7832  33.2% 29737 2745s
H   57    77                    50589.291331 67351.7832  33.1% 28590 2745s
    76   207 65070.4319    8  392 50589.2913 67351.7832  33.1% 24079 3082s
   206   268 64859.8344   13  371 50589.2913 67351.7832  33.1% 14148 3172s
H  213   268                    50848.715081 67351.7832  32.5% 13883 3172s
   267   327 64593.4704   15  302 50848.7151 67351.7832  32.5% 12724 3270s
   326   386 64004.8099   18  295 50848.7151 67351.7832  32.5% 11844 3337s
   385   451 63613.6156   19  289 50848.7151 67351.7832  32.5% 11542 3419s
   450   481 63599.5110   20  286 50848.7151 67351.7832  32.5% 11359 3469s
H  456   481                    50922.362302 67351.7832  32.3% 11357 3469s
   480   542 63548.7885   21  287 50922.3623 67351.7832  32.3% 11315 3551s
   541   567 62749.2560   24  335 50922.3623 67351.7832  32.3% 10739 3600s
H  554   567                    50994.539229 67351.7832  32.1% 10603 3600s

Cutting planes:
  Learned: 2
  Gomory: 7
  Implied bound: 301
  MIR: 4080
  Flow cover: 4283
  RLT: 54
  Relax-and-lift: 620
  BQP: 1

Explored 566 nodes (6842351 simplex iterations) in 3600.09 seconds (4749.25 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 50994.5 50922.4 50848.7 ... 49874.2

Time limit reached
Best objective 5.099453922936e+04, best bound 6.735178323740e+04, gap 32.0765%
  WARNING: Time limit reached. Using best solution found (gap: 32.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 50994.54, θ = 214643.17
  Upper Bound (UB) = 50994.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214643.17
  [DEBUG]   ✓ Scenario 0: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214643.17 ≤ Q = 214643.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 214643.17 ≤ Q = 214643.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 214643.17 ≤ Q = 214643.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 214643.17 ≤ Q = 214643.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 214643.17 ≤ Q = 214643.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 214643.17 ≤ Q = 214643.17 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x710a257a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8ef5da86
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-15, 2e+02]
Found heuristic solution: objective 1.385522e+13
Presolve removed 2555 rows and 1846 columns
Presolve time: 0.01s
Presolved: 538 rows, 543 columns, 1521 nonzeros
Found heuristic solution: objective 6979617.6728
Variable types: 369 continuous, 174 integer (174 binary)

Root relaxation: objective -1.857986e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -185798.57    0  124 6979617.67 -185798.57   103%     -    0s
H    0     0                    -148486.8010 -185798.57  25.1%     -    0s
H    0     0                    -149022.5319 -185798.57  24.7%     -    0s
     0     0 -160754.16    0   50 -149022.53 -160754.16  7.87%     -    0s
H    0     0                    -159326.6008 -160692.02  0.86%     -    0s
     0     0 -160421.83    0   32 -159326.60 -160421.83  0.69%     -    0s
     0     0 -160394.21    0   32 -159326.60 -160394.21  0.67%     -    0s
H    0     0                    -159651.7259 -160394.21  0.47%     -    0s
H    0     0                    -159827.8217 -160394.21  0.35%     -    0s
     0     0 -160242.23    0   27 -159827.82 -160242.23  0.26%     -    0s
     0     0 -160184.21    0   25 -159827.82 -160184.21  0.22%     -    0s
     0     0 -160182.67    0   23 -159827.82 -160182.67  0.22%     -    0s
H    0     0                    -159833.0257 -160182.67  0.22%     -    0s
     0     0 -160175.55    0   24 -159833.03 -160175.55  0.21%     -    0s
     0     0 -160166.65    0   23 -159833.03 -160166.65  0.21%     -    0s
     0     0 -160103.90    0   18 -159833.03 -160103.90  0.17%     -    0s
     0     0 -160058.50    0   14 -159833.03 -160058.50  0.14%     -    0s
     0     0 -160056.89    0   14 -159833.03 -160056.89  0.14%     -    0s
     0     0 -159896.80    0    8 -159833.03 -159896.80  0.04%     -    0s
     0     0 -159890.48    0    8 -159833.03 -159890.48  0.04%     -    0s
     0     0          -    0      -159833.03 -159848.35  0.01%     -    0s

Cutting planes:
  Gomory: 11
  Implied bound: 3
  MIR: 152
  Flow cover: 7
  RLT: 11
  Relax-and-lift: 1

Explored 1 nodes (552 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -159833 -159828 -149023 ... 1.38552e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.598330256981e+05, best bound -1.598483504345e+05, gap 0.0096%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 207778.90
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -159833.03
  [DEBUG]   S×d_nominal = 367611.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367611.93 + -159833.03 = 207778.90
  [DEBUG]   Current θ from Master = 214643.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6864.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44130.27
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 830.4315, Absolute Gap = 830.4315, Relative Gap = 0.016285
  Not converged yet (gap = 830.43 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 957063 nonzeros
Model fingerprint: 0x5b80b818
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 139986 rows and 56826 columns (presolve time = 5s)...
Presolve removed 139986 rows and 56826 columns
Presolve time: 6.75s
Presolved: 197777 rows, 82714 columns, 1215473 nonzeros
Variable types: 80455 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -211318.7458

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.20s

Barrier statistics:
 Dense cols : 1209
 AA' NZ     : 4.793e+06
 Factor NZ  : 1.367e+07 (roughly 220 MB of memory)
 Factor Ops : 4.902e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.87186664e+07  3.62881038e+08  2.22e+05 1.46e+01  1.31e+05    12s
   1  -2.30410848e+07  3.59135910e+08  1.61e+05 1.16e+02  9.49e+04    12s
   2  -1.30626609e+07  2.97794334e+08  8.62e+04 2.97e+01  5.26e+04    12s
   3  -2.63939067e+06  2.24827116e+08  1.39e+04 4.59e+00  8.94e+03    13s
   4  -8.68263850e+05  1.48130149e+08  1.56e+03 1.29e+00  1.30e+03    13s
   5  -7.12311790e+05  6.42600756e+07  5.79e+02 2.77e-01  4.67e+02    13s
   6  -6.46656667e+05  4.88806059e+07  3.21e+02 1.92e-01  2.88e+02    13s
   7  -5.47172689e+05  3.62092438e+07  1.15e+02 1.29e-01  1.52e+02    13s
   8  -4.18290503e+05  2.77910897e+07  4.80e+01 9.13e-02  9.71e+01    13s
   9  -2.68186330e+05  1.91914437e+07  1.87e+01 5.97e-02  6.00e+01    14s
  10  -1.59851239e+05  1.22174319e+07  7.74e+00 3.63e-02  3.61e+01    14s
  11  -1.37075925e+05  7.78749656e+06  5.36e+00 2.25e-02  2.28e+01    14s
  12  -1.12478371e+05  5.03829721e+06  2.67e+00 1.43e-02  1.46e+01    14s
  13  -7.99463992e+04  2.23317387e+06  1.06e+00 6.07e-03  6.48e+00    14s
  14  -4.34281561e+04  7.51796353e+05  4.80e-01 1.94e-03  2.22e+00    14s
  15  -1.94317874e+04  3.71473295e+05  3.03e-01 1.15e-03  1.09e+00    15s
  16   5.09812485e+03  2.57002451e+05  1.93e-01 1.93e-03  7.02e-01    15s
  17   2.38446861e+04  1.88727447e+05  1.44e-01 2.30e-03  4.59e-01    15s
  18   3.63044339e+04  1.60219447e+05  1.13e-01 2.83e-03  3.45e-01    15s
  19   3.73725898e+04  1.56034898e+05  1.10e-01 2.54e-03  3.31e-01    15s
  20   3.91758076e+04  1.51838753e+05  1.05e-01 2.42e-03  3.14e-01    15s
  21   4.07430978e+04  1.47471602e+05  1.01e-01 2.38e-03  2.97e-01    16s
  22   4.38159652e+04  1.41473232e+05  9.32e-02 2.27e-03  2.72e-01    16s
  23   4.84732773e+04  1.30492904e+05  8.14e-02 1.62e-03  2.29e-01    16s
  24   5.33605255e+04  1.24667423e+05  6.90e-02 1.68e-03  1.99e-01    16s
  25   5.77143994e+04  1.10333264e+05  5.78e-02 1.62e-03  1.47e-01    16s
  26   6.11980553e+04  1.07033816e+05  4.96e-02 1.48e-03  1.28e-01    17s
  27   6.35828468e+04  1.03340047e+05  4.42e-02 1.54e-03  1.11e-01    17s
  28   6.56318243e+04  1.00177652e+05  3.97e-02 1.29e-03  9.63e-02    17s
  29   6.98426291e+04  9.62107903e+04  3.09e-02 9.44e-04  7.35e-02    17s
  30   7.23049215e+04  9.32750075e+04  2.58e-02 6.84e-04  5.85e-02    17s
  31   7.50350849e+04  9.04259682e+04  2.04e-02 4.50e-04  4.29e-02    18s
  32   7.79788687e+04  8.96846087e+04  1.46e-02 3.63e-04  3.26e-02    18s
  33   8.01071118e+04  8.82653715e+04  1.05e-02 2.25e-04  2.28e-02    18s
  34   8.15750076e+04  8.73887117e+04  7.76e-03 1.46e-04  1.62e-02    18s
  35   8.19948285e+04  8.69001243e+04  7.00e-03 1.07e-04  1.37e-02    19s
  36   8.23996803e+04  8.66429377e+04  6.24e-03 7.43e-05  1.18e-02    19s
  37   8.35031253e+04  8.65952462e+04  4.22e-03 9.40e-05  8.63e-03    19s
  38   8.40921118e+04  8.63799264e+04  3.14e-03 8.54e-05  6.38e-03    19s
  39   8.42884195e+04  8.62709597e+04  2.77e-03 7.11e-05  5.53e-03    20s
  40   8.45580357e+04  8.62399853e+04  2.31e-03 6.91e-05  4.69e-03    20s
  41   8.48040066e+04  8.61757720e+04  1.88e-03 7.17e-05  3.83e-03    20s
  42   8.49737323e+04  8.61245862e+04  1.58e-03 5.56e-05  3.21e-03    20s
  43   8.50923201e+04  8.60386304e+04  1.36e-03 3.59e-05  2.64e-03    21s
  44   8.51135288e+04  8.60233776e+04  1.33e-03 3.28e-05  2.54e-03    21s
  45   8.52084841e+04  8.60005657e+04  1.16e-03 2.77e-05  2.21e-03    21s
  46   8.52209954e+04  8.59794138e+04  1.14e-03 2.37e-05  2.12e-03    21s
  47   8.52694416e+04  8.59616015e+04  1.05e-03 2.34e-05  1.93e-03    22s
  48   8.53309130e+04  8.59491278e+04  9.38e-04 2.05e-05  1.73e-03    22s
  49   8.54036419e+04  8.59429902e+04  8.07e-04 1.93e-05  1.50e-03    22s
  50   8.54550992e+04  8.59366899e+04  7.10e-04 1.79e-05  1.34e-03    23s
  51   8.54900116e+04  8.59088376e+04  6.46e-04 2.37e-05  1.17e-03    23s
  52   8.55336424e+04  8.58953005e+04  5.68e-04 1.75e-05  1.01e-03    23s
  53   8.55933920e+04  8.58814170e+04  4.61e-04 9.05e-06  8.04e-04    23s
  54   8.56111825e+04  8.58768470e+04  4.30e-04 7.89e-06  7.42e-04    24s
  55   8.56380975e+04  8.58744428e+04  3.81e-04 7.28e-06  6.60e-04    24s
  56   8.56579890e+04  8.58714019e+04  3.47e-04 6.13e-06  5.96e-04    24s
  57   8.56918840e+04  8.58647060e+04  2.85e-04 4.20e-06  4.82e-04    24s
  58   8.57372250e+04  8.58619252e+04  1.99e-04 3.12e-06  3.48e-04    25s
  59   8.57736566e+04  8.58560415e+04  1.33e-04 5.78e-06  2.30e-04    25s
  60   8.57890237e+04  8.58533730e+04  1.05e-04 5.70e-06  1.80e-04    25s
  61   8.58027837e+04  8.58510974e+04  8.01e-05 2.80e-06  1.35e-04    25s
  62   8.58277517e+04  8.58502078e+04  3.50e-05 1.88e-06  6.27e-05    26s
  63   8.58419585e+04  8.58494693e+04  1.16e-05 6.72e-07  2.10e-05    26s
  64   8.58450681e+04  8.58494267e+04  6.32e-06 4.99e-07  1.22e-05    26s
  65   8.58486698e+04  8.58493112e+04  9.19e-07 1.79e-07  1.79e-06    26s
  66   8.58493022e+04  8.58493042e+04  8.30e-09 9.42e-09  5.67e-09    26s
  67   8.58493035e+04  8.58493040e+04  1.01e-06 2.13e-09  1.24e-09    27s

Barrier solved model in 67 iterations and 26.54 seconds (22.11 work units)
Optimal objective 8.58493035e+04


Root crossover log...

  176704 DPushes remaining with DInf 0.0000000e+00                27s
   59920 DPushes remaining with DInf 0.0000000e+00                30s
   23058 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                40s

   22821 PPushes remaining with PInf 1.2907505e-04                40s
   10966 PPushes remaining with PInf 4.3782061e-05                40s
       0 PPushes remaining with PInf 0.0000000e+00                42s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9874465e+04     42s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  111713    8.5849304e+04   0.000000e+00   2.987446e+04     42s
  112216    8.5849304e+04   0.000000e+00   0.000000e+00     43s
  112216    8.5849304e+04   0.000000e+00   0.000000e+00     43s
Concurrent spin time: 0.72s

Solved with barrier

Root relaxation: objective 8.584930e+04, 112216 iterations, 35.65 seconds (37.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 85849.3040    0  150 -211318.75 85849.3040   141%     -   45s
H    0     0                    -53478.27748 85849.3040   261%     -   48s
H    0     0                    46201.672626 85849.3040  85.8%     -   49s
H    0     0                    48265.634608 85849.3040  77.9%     -   50s
H    0     0                    49377.284747 85849.3040  73.9%     -   51s
H    0     0                    49684.365618 85849.3040  72.8%     -   52s
H    0     0                    49685.215942 85849.3040  72.8%     -   52s
H    0     0                    49722.424799 85849.3040  72.7%     -   52s
     0     0 79358.0229    0  161 49722.4248 79358.0229  59.6%     -  118s
     0     0 79358.0229    0  161 49722.4248 79358.0229  59.6%     -  118s
     0     0 78985.7624    0  180 49722.4248 78985.7624  58.9%     -  144s
     0     0 78958.1007    0  186 49722.4248 78958.1007  58.8%     -  156s
     0     0 78957.8910    0  182 49722.4248 78957.8910  58.8%     -  157s
     0     0 75188.1804    0  233 49722.4248 75188.1804  51.2%     -  239s
H    0     0                    49730.988260 75187.1583  51.2%     -  241s
H    0     0                    49771.709239 75187.1583  51.1%     -  241s
     0     0 74764.5380    0  217 49771.7092 74764.5380  50.2%     -  306s
     0     0 74272.7750    0  236 49771.7092 74272.7750  49.2%     -  363s
     0     0 74116.5297    0  266 49771.7092 74116.5297  48.9%     -  389s
     0     0 74097.0310    0  270 49771.7092 74097.0310  48.9%     -  399s
     0     0 74090.6038    0  272 49771.7092 74090.6038  48.9%     -  407s
     0     0 73922.3789    0  266 49771.7092 73922.3789  48.5%     -  431s
     0     0 73885.0992    0  265 49771.7092 73885.0992  48.4%     -  445s
     0     0 73881.5156    0  258 49771.7092 73881.5156  48.4%     -  449s
     0     0 73827.4242    0  264 49771.7092 73827.4242  48.3%     -  456s
     0     0 73824.1010    0  273 49771.7092 73824.1010  48.3%     -  460s
     0     0 73718.7289    0  268 49771.7092 73718.7289  48.1%     -  474s
     0     0 73716.9906    0  277 49771.7092 73716.9906  48.1%     -  477s
     0     0 73716.3297    0  281 49771.7092 73716.3297  48.1%     -  479s
     0     0 71597.8781    0  274 49771.7092 71597.8781  43.9%     -  580s
     0     0 70851.9304    0  327 49771.7092 70851.9304  42.4%     -  667s
     0     0 70702.4954    0  339 49771.7092 70702.4954  42.1%     -  706s
     0     0 70612.9718    0  349 49771.7092 70612.9718  41.9%     -  731s
     0     0 70366.4728    0  346 49771.7092 70366.4728  41.4%     -  779s
     0     0 70295.7094    0  332 49771.7092 70295.7094  41.2%     -  797s
     0     0 70286.4874    0  348 49771.7092 70286.4874  41.2%     -  808s
     0     0 70248.8755    0  347 49771.7092 70248.8755  41.1%     -  824s
     0     0 70244.7860    0  346 49771.7092 70244.7860  41.1%     -  828s
     0     0 70234.4676    0  349 49771.7092 70234.4676  41.1%     -  832s
     0     0 70213.0191    0  349 49771.7092 70213.0191  41.1%     -  846s
     0     0 70209.5412    0  352 49771.7092 70209.5412  41.1%     -  850s
     0     0 70208.6503    0  356 49771.7092 70208.6503  41.1%     -  853s
     0     0 69398.1240    0  383 49771.7092 69398.1240  39.4%     -  937s
     0     0 69106.5881    0  354 49771.7092 69106.5881  38.8%     -  977s
     0     0 69051.6393    0  378 49771.7092 69051.6393  38.7%     -  996s
     0     0 69026.5058    0  375 49771.7092 69026.5058  38.7%     - 1010s
     0     0 69001.6041    0  377 49771.7092 69001.6041  38.6%     - 1023s
     0     0 68994.4312    0  378 49771.7092 68994.4312  38.6%     - 1033s
     0     0 68992.0607    0  383 49771.7092 68992.0607  38.6%     - 1036s
     0     0 68979.5334    0  375 49771.7092 68979.5334  38.6%     - 1042s
     0     0 68976.0524    0  379 49771.7092 68976.0524  38.6%     - 1045s
     0     0 68972.2203    0  369 49771.7092 68972.2203  38.6%     - 1049s
     0     0 68970.3664    0  371 49771.7092 68970.3664  38.6%     - 1054s
     0     0 68813.3689    0  379 49771.7092 68813.3689  38.3%     - 1091s
     0     0 68661.6948    0  387 49771.7092 68661.6948  38.0%     - 1141s
     0     0 68635.1077    0  382 49771.7092 68635.1077  37.9%     - 1155s
     0     0 68624.3408    0  386 49771.7092 68624.3408  37.9%     - 1166s
     0     0 68621.6652    0  388 49771.7092 68621.6652  37.9%     - 1172s
     0     0 68615.1173    0  337 49771.7092 68615.1173  37.9%     - 1178s
     0     0 68612.9586    0  389 49771.7092 68612.9586  37.9%     - 1184s
     0     0 68504.9693    0  389 49771.7092 68504.9693  37.6%     - 1212s
H    0     0                    49941.318783 68504.8039  37.2%     - 1216s
     0     0 68490.3105    0  403 49941.3188 68490.3105  37.1%     - 1225s
     0     0 68484.5642    0  402 49941.3188 68484.5642  37.1%     - 1231s
     0     0 68483.3666    0  399 49941.3188 68483.3666  37.1%     - 1234s
     0     0 68418.4007    0  399 49941.3188 68418.4007  37.0%     - 1260s
     0     0 68284.6409    0  396 49941.3188 68284.6409  36.7%     - 1280s
     0     0 68261.7796    0  400 49941.3188 68261.7796  36.7%     - 1293s
     0     0 68251.9168    0  401 49941.3188 68251.9168  36.7%     - 1301s
     0     0 68250.1993    0  402 49941.3188 68250.1993  36.7%     - 1306s
     0     0 68229.8000    0  358 49941.3188 68229.8000  36.6%     - 1320s
H    0     0                    49959.447584 68229.6134  36.6%     - 1322s
H    0     0                    49983.708950 68229.6134  36.5%     - 1322s
H    0     0                    50043.601922 68229.6134  36.3%     - 1322s
     0     0 68209.6589    0  362 50043.6019 68209.6589  36.3%     - 1328s
     0     0 68205.4267    0  367 50043.6019 68205.4267  36.3%     - 1332s
     0     0 68202.8271    0  364 50043.6019 68202.8271  36.3%     - 1334s
     0     0 68200.5192    0  367 50043.6019 68200.5192  36.3%     - 1336s
     0     0 68196.3275    0  371 50043.6019 68196.3275  36.3%     - 1345s
     0     0 68191.8565    0  377 50043.6019 68191.8565  36.3%     - 1352s
     0     0 68180.4731    0  370 50043.6019 68180.4731  36.2%     - 1360s
     0     0 68179.1038    0  371 50043.6019 68179.1038  36.2%     - 1363s
     0     0 68172.8295    0  423 50043.6019 68172.8295  36.2%     - 1371s
     0     0 68172.1610    0  374 50043.6019 68172.1610  36.2%     - 1380s
     0     0 68170.3242    0  421 50043.6019 68170.3242  36.2%     - 1388s
     0     0 68169.2772    0  369 50043.6019 68169.2772  36.2%     - 1391s
     0     0 68168.8899    0  369 50043.6019 68168.8899  36.2%     - 1397s
     0     0 68168.5866    0  369 50043.6019 68168.5866  36.2%     - 1405s
H    0     0                    50073.127327 68168.2844  36.1%     - 1653s
     0     2 68168.2844    0  369 50073.1273 68168.2844  36.1%     - 1688s
     1     4 68162.4549    1  365 50073.1273 68168.2844  36.1%  2954 1727s
     3     7 67923.2302    2  392 50073.1273 68162.3300  36.1% 12991 1767s
     6    12 67889.3649    3  402 50073.1273 68162.3291  36.1% 15619 1825s
    11    24 67402.6475    3  387 50073.1273 68087.3047  36.0% 18988 1868s
    23    36 67304.2347    4  407 50073.1273 67703.2797  35.2% 27660 1989s
    35    68 66741.5645    5  415 50073.1273 67703.2797  35.2% 32928 2602s
H   56    68                    50104.575007 67703.2797  35.1% 28012 2602s
    67   107 66649.9633    6  377 50104.5750 67464.7648  34.6% 38683 2763s
   106   176 65233.2754    7  306 50104.5750 67464.7585  34.6% 30847 2932s
H  130   176                    50211.110591 67464.7585  34.4% 27502 2932s
H  133   176                    50261.653122 67464.7585  34.2% 27322 2932s
H  138   176                    50429.044167 67464.7585  33.8% 26827 2932s
   175   208 66321.3969    7  395 50429.0442 67464.7585  33.8% 24354 3039s
   207   239 65043.1577    9  295 50429.0442 67464.7585  33.8% 22491 3152s
H  208   239                    50666.222619 67464.7585  33.2% 22382 3152s
H  236   239                    50672.290995 67464.7585  33.1% 21384 3152s
   238   331 66227.7095    8  372 50672.2910 67464.7585  33.1% 21415 3325s
   330   405 65986.7866   11  312 50672.2910 67464.7585  33.1% 18613 3453s
   404   436 64253.5658   12  293 50672.2910 67464.7585  33.1% 17433 3536s
   435   475 64669.3851   12  289 50672.2910 67464.7585  33.1% 17502 3600s

Cutting planes:
  Gomory: 15
  Implied bound: 310
  MIR: 3641
  Flow cover: 4063
  RLT: 40
  Relax-and-lift: 528
  BQP: 2
  PSD: 1

Explored 474 nodes (8886901 simplex iterations) in 3600.18 seconds (4852.34 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 50672.3 50666.2 50429 ... 49959.4

Time limit reached
Best objective 5.067229099538e+04, best bound 6.746475853330e+04, gap 33.1393%
  WARNING: Time limit reached. Using best solution found (gap: 33.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 50672.29, θ = 213646.65
  Upper Bound (UB) = 50672.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 213646.65
  [DEBUG]   ✓ Scenario 0: θ = 213646.65 ≤ Q = 213646.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 213646.65 ≤ Q = 213646.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 213646.65 ≤ Q = 213646.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 213646.65 ≤ Q = 213646.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 213646.65 ≤ Q = 213646.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 213646.65 ≤ Q = 213646.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 213646.65 ≤ Q = 213646.65 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x30ffb1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xffcf004f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.391256e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 6886631.0418
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6886351.2891

Root relaxation: objective -1.891716e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189171.58    0  124 6886351.29 -189171.58   103%     -    0s
H    0     0                    -148531.9029 -189171.58  27.4%     -    0s
H    0     0                    -148811.6556 -189171.58  27.1%     -    0s
H    0     0                    -148883.7434 -189171.58  27.1%     -    0s
H    0     0                    -149163.4961 -189171.58  26.8%     -    0s
H    0     0                    -149297.7849 -189061.46  26.6%     -    0s
     0     0 -163495.32    0   68 -149297.78 -163495.32  9.51%     -    0s
H    0     0                    -161651.6224 -163412.46  1.09%     -    0s
H    0     0                    -162159.9389 -163412.46  0.77%     -    0s
H    0     0                    -162447.7734 -163412.46  0.59%     -    0s
     0     0 -162869.14    0   41 -162447.77 -162869.14  0.26%     -    0s
     0     0 -162799.34    0   40 -162447.77 -162799.34  0.22%     -    0s
     0     0 -162797.26    0   39 -162447.77 -162797.26  0.22%     -    0s
     0     0 -162708.85    0   34 -162447.77 -162708.85  0.16%     -    0s
H    0     0                    -162511.1270 -162704.44  0.12%     -    0s
     0     0 -162704.44    0   34 -162511.13 -162704.44  0.12%     -    0s
     0     0 -162686.37    0   33 -162511.13 -162686.37  0.11%     -    0s
     0     0 -162682.17    0   33 -162511.13 -162682.17  0.11%     -    0s
H    0     0                    -162662.8274 -162682.17  0.01%     -    0s
     0     0 -162682.17    0   27 -162662.83 -162682.17  0.01%     -    0s
     0     0 -162682.17    0   27 -162662.83 -162682.17  0.01%     -    0s
     0     0 -162682.17    0    9 -162662.83 -162682.17  0.01%     -    0s
     0     0          -    0      -162662.83 -162676.46  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 10
  MIR: 23
  Flow cover: 2
  RLT: 1

Explored 1 nodes (629 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -162663 -162620 -162511 ... -148532

Optimal solution found (tolerance 1.00e-04)
Best objective -1.626628273900e+05, best bound -1.626764583767e+05, gap 0.0084%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 206964.53
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -162662.83
  [DEBUG]   S×d_nominal = 369627.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369627.36 + -162662.83 = 206964.53
  [DEBUG]   Current θ from Master = 213646.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6682.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43990.17
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = 508.1832, Absolute Gap = 508.1832, Relative Gap = 0.010029
  Not converged yet (gap = 508.18 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 1000315 nonzeros
Model fingerprint: 0x6bcaf0c4
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 146349 rows and 59409 columns (presolve time = 5s)...
Presolve removed 146349 rows and 59409 columns
Presolve time: 7.02s
Presolved: 206704 rows, 86371 columns, 1270377 nonzeros
Variable types: 84112 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -299645.7303
Found heuristic solution: objective -211318.7458

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.97s

Barrier statistics:
 Dense cols : 1209
 AA' NZ     : 5.152e+06
 Factor NZ  : 1.473e+07 (roughly 240 MB of memory)
 Factor Ops : 5.401e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.96609240e+07  3.76596087e+08  2.29e+05 1.45e+01  1.35e+05    13s
   1  -2.38584380e+07  3.74708283e+08  1.67e+05 1.17e+02  9.76e+04    13s
   2  -1.28123087e+07  3.11411459e+08  8.39e+04 3.19e+01  5.11e+04    13s
   3  -2.71172239e+06  2.29956069e+08  1.43e+04 1.31e+00  9.20e+03    14s
   4  -1.23353560e+06  1.74659193e+08  3.99e+03 6.37e-01  2.78e+03    14s
   5  -7.65750443e+05  8.86059474e+07  8.60e+02 2.36e-01  6.84e+02    14s
   6  -6.98878192e+05  5.20994080e+07  5.03e+02 1.07e-01  3.78e+02    14s
   7  -5.87827062e+05  4.36137847e+07  1.46e+02 8.86e-02  1.84e+02    14s
   8  -4.91745812e+05  2.74554211e+07  4.99e+01 5.28e-02  9.34e+01    14s
   9  -2.73781260e+05  1.93221271e+07  1.78e+01 3.40e-02  5.76e+01    15s
  10  -1.61269066e+05  1.19313336e+07  7.15e+00 2.00e-02  3.37e+01    15s
  11  -1.36759707e+05  8.24247895e+06  4.74e+00 1.36e-02  2.30e+01    15s
  12  -1.08931587e+05  5.27920995e+06  1.97e+00 8.52e-03  1.45e+01    15s
  13  -8.67334976e+04  2.19448011e+06  1.20e+00 3.43e-03  6.12e+00    15s
  14  -4.85126832e+04  6.97279677e+05  3.64e-01 9.24e-04  1.99e+00    15s
  15  -1.40901382e+04  3.86430753e+05  1.89e-01 5.24e-04  1.07e+00    15s
  16   9.04703021e+03  2.76303628e+05  1.20e-01 1.28e-03  7.12e-01    16s
  17   2.65675879e+04  2.00392550e+05  8.53e-02 2.40e-03  4.63e-01    16s
  18   4.04346730e+04  1.76160972e+05  5.79e-02 2.04e-03  3.61e-01    16s
  19   4.27316992e+04  1.61522693e+05  5.40e-02 1.94e-03  3.16e-01    16s
  20   4.42814671e+04  1.56133080e+05  5.15e-02 1.80e-03  2.98e-01    16s
  21   5.02942501e+04  1.37163498e+05  4.18e-02 3.37e-03  2.31e-01    16s
  22   5.61963569e+04  1.29463292e+05  3.33e-02 2.94e-03  1.95e-01    17s
  23   5.92969838e+04  1.18627881e+05  2.90e-02 2.17e-03  1.58e-01    17s
  24   6.27588837e+04  1.14631325e+05  2.45e-02 1.92e-03  1.38e-01    17s
  25   6.94660256e+04  1.08454412e+05  1.60e-02 1.53e-03  1.04e-01    17s
  26   7.21371416e+04  9.71175387e+04  1.28e-02 8.20e-04  6.65e-02    18s
  27   7.59430006e+04  9.40239748e+04  8.92e-03 5.89e-04  4.82e-02    18s
  28   7.84786747e+04  9.24080749e+04  6.44e-03 4.73e-04  3.71e-02    18s
  29   8.03129463e+04  8.94808318e+04  4.70e-03 2.59e-04  2.44e-02    18s
  30   8.19952686e+04  8.85876856e+04  3.20e-03 1.93e-04  1.76e-02    19s
  31   8.30201854e+04  8.77043555e+04  2.31e-03 1.28e-04  1.25e-02    19s
  32   8.33173198e+04  8.71542205e+04  2.07e-03 8.79e-05  1.02e-02    19s
  33   8.39996437e+04  8.68675271e+04  1.50e-03 6.76e-05  7.64e-03    19s
  34   8.43885366e+04  8.65267407e+04  1.17e-03 4.37e-05  5.70e-03    19s
  35   8.45452025e+04  8.63744183e+04  1.04e-03 3.37e-05  4.87e-03    20s
  36   8.48444586e+04  8.63008491e+04  8.05e-04 2.86e-05  3.88e-03    20s
  37   8.50825863e+04  8.62306835e+04  6.08e-04 2.38e-05  3.06e-03    20s
  38   8.51759392e+04  8.61192385e+04  5.29e-04 1.68e-05  2.51e-03    21s
  39   8.53008135e+04  8.60742743e+04  4.25e-04 1.40e-05  2.06e-03    21s
  40   8.53734057e+04  8.60524494e+04  3.63e-04 1.27e-05  1.81e-03    21s
  41   8.54208252e+04  8.59769189e+04  3.22e-04 8.38e-06  1.48e-03    21s
  42   8.54768887e+04  8.59460261e+04  2.76e-04 6.51e-06  1.25e-03    22s
  43   8.55694187e+04  8.59150796e+04  2.04e-04 4.64e-06  9.21e-04    22s
  44   8.55926374e+04  8.59056985e+04  1.85e-04 4.15e-06  8.34e-04    22s
  45   8.56266571e+04  8.58961013e+04  1.59e-04 3.65e-06  7.18e-04    22s
  46   8.56493812e+04  8.58873910e+04  1.41e-04 3.20e-06  6.34e-04    23s
  47   8.56691824e+04  8.58701777e+04  1.25e-04 2.42e-06  5.35e-04    23s
  48   8.57062475e+04  8.58540586e+04  9.58e-05 1.28e-06  3.94e-04    23s
  49   8.57283177e+04  8.58440286e+04  7.82e-05 1.35e-05  3.08e-04    23s
  50   8.57629536e+04  8.58404042e+04  5.15e-05 9.60e-06  2.06e-04    24s
  51   8.57761491e+04  8.58396397e+04  4.15e-05 8.70e-06  1.69e-04    24s
  52   8.57958224e+04  8.58357005e+04  2.58e-05 4.98e-06  1.06e-04    24s
  53   8.58159800e+04  8.58342397e+04  1.06e-05 3.58e-06  4.86e-05    25s
  54   8.58252655e+04  8.58314747e+04  3.59e-06 5.32e-07  1.65e-05    25s
  55   8.58258678e+04  8.58310055e+04  3.17e-06 2.50e-07  1.37e-05    25s
  56   8.58287724e+04  8.58307355e+04  1.15e-06 6.88e-08  5.23e-06    25s
  57   8.58301427e+04  8.58306036e+04  2.61e-07 1.46e-08  1.23e-06    25s
  58   8.58305400e+04  8.58305916e+04  2.10e-07 3.40e-09  1.37e-07    26s
  59   8.58305840e+04  8.58305843e+04  2.45e-08 1.19e-08  7.11e-10    26s

Barrier solved model in 59 iterations and 25.77 seconds (22.95 work units)
Optimal objective 8.58305840e+04


Root crossover log...

  182644 DPushes remaining with DInf 0.0000000e+00                26s
   51055 DPushes remaining with DInf 0.0000000e+00                30s
   13888 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                38s

   13209 PPushes remaining with PInf 1.3036708e-04                39s
       0 PPushes remaining with PInf 0.0000000e+00                40s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2008852e+01     40s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   95119    8.5830584e+04   0.000000e+00   3.200885e+01     40s
   95171    8.5830584e+04   0.000000e+00   0.000000e+00     40s
   95171    8.5830584e+04   0.000000e+00   0.000000e+00     41s
Concurrent spin time: 5.32s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.583058e+04, 95171 iterations, 37.27 seconds (35.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 85830.5842    0  152 -211318.75 85830.5842   141%     -   47s
H    0     0                    -50911.43164 85830.5842   269%     -   50s
H    0     0                    11104.594386 85830.5842   673%     -   52s
H    0     0                    20049.091913 85830.5842   328%     -   52s
H    0     0                    23500.922531 85830.5842   265%     -   53s
H    0     0                    46184.293628 85830.5842  85.8%     -   54s
H    0     0                    47244.374485 85830.5842  81.7%     -   56s
H    0     0                    48300.887614 85830.5842  77.7%     -   56s
H    0     0                    49438.981171 85830.5842  73.6%     -   56s
H    0     0                    49637.291542 85830.5842  72.9%     -   56s
H    0     0                    49685.215942 85830.5842  72.7%     -   56s
     0     0 79457.5477    0  165 49685.2159 79457.5477  59.9%     -  206s
     0     0 79457.5477    0  165 49685.2159 79457.5477  59.9%     -  206s
     0     0 78862.9151    0  190 49685.2159 78862.9151  58.7%     -  317s
     0     0 78786.6660    0  175 49685.2159 78786.6660  58.6%     -  356s
     0     0 78761.3294    0  182 49685.2159 78761.3294  58.5%     -  388s
     0     0 78737.8537    0  191 49685.2159 78737.8537  58.5%     -  396s
     0     0 78731.0176    0  184 49685.2159 78731.0176  58.5%     -  402s
     0     0 78727.2416    0  183 49685.2159 78727.2416  58.5%     -  407s
     0     0 78727.2207    0  187 49685.2159 78727.2207  58.5%     -  407s
     0     0 75179.2268    0  227 49685.2159 75179.2268  51.3%     -  548s
H    0     0                    49714.359238 75178.9656  51.2%     -  550s
H    0     0                    49796.550211 75178.9656  51.0%     -  551s
H    0     0                    49806.930477 75178.9656  50.9%     -  551s
     0     0 74507.0555    0  244 49806.9305 74507.0555  49.6%     -  661s
     0     0 74202.0216    0  259 49806.9305 74202.0216  49.0%     -  719s
     0     0 73984.4462    0  257 49806.9305 73984.4462  48.5%     -  783s
     0     0 73899.3286    0  258 49806.9305 73899.3286  48.4%     -  821s
     0     0 73830.8631    0  240 49806.9305 73830.8631  48.2%     -  841s
     0     0 73765.9254    0  260 49806.9305 73765.9254  48.1%     -  858s
     0     0 73737.9703    0  264 49806.9305 73737.9703  48.0%     -  869s
     0     0 73662.6282    0  259 49806.9305 73662.6282  47.9%     -  894s
     0     0 73585.0942    0  266 49806.9305 73585.0942  47.7%     -  912s
     0     0 73557.6436    0  264 49806.9305 73557.6436  47.7%     -  931s
     0     0 73554.8358    0  262 49806.9305 73554.8358  47.7%     -  938s
     0     0 73552.2593    0  262 49806.9305 73552.2593  47.7%     -  945s
     0     0 73513.3877    0  294 49806.9305 73513.3877  47.6%     -  979s
     0     0 73483.0088    0  295 49806.9305 73483.0088  47.5%     -  993s
     0     0 73456.7687    0  296 49806.9305 73456.7687  47.5%     - 1006s
     0     0 73449.2534    0  293 49806.9305 73449.2534  47.5%     - 1015s
     0     0 73445.6610    0  300 49806.9305 73445.6610  47.5%     - 1020s
     0     0 73445.4014    0  302 49806.9305 73445.4014  47.5%     - 1024s
     0     0 71402.7673    0  315 49806.9305 71402.7673  43.4%     - 1156s
     0     0 70977.1362    0  368 49806.9305 70977.1362  42.5%     - 1263s
     0     0 70745.9514    0  355 49806.9305 70745.9514  42.0%     - 1315s
     0     0 70403.3855    0  370 49806.9305 70403.3855  41.4%     - 1377s
     0     0 70363.6156    0  367 49806.9305 70363.6156  41.3%     - 1420s
     0     0 70308.5985    0  376 49806.9305 70308.5985  41.2%     - 1449s
     0     0 70187.6552    0  359 49806.9305 70187.6552  40.9%     - 1487s
     0     0 70180.0630    0  372 49806.9305 70180.0630  40.9%     - 1497s
     0     0 70177.1872    0  366 49806.9305 70177.1872  40.9%     - 1507s
     0     0 70176.3455    0  371 49806.9305 70176.3455  40.9%     - 1513s
     0     0 69540.7130    0  377 49806.9305 69540.7130  39.6%     - 1623s
     0     0 69191.0540    0  378 49806.9305 69191.0540  38.9%     - 1666s
     0     0 68932.5519    0  387 49806.9305 68932.5519  38.4%     - 1712s
     0     0 68861.4481    0  390 49806.9305 68861.4481  38.3%     - 1735s
     0     0 68827.0924    0  392 49806.9305 68827.0924  38.2%     - 1754s
     0     0 68810.6037    0  401 49806.9305 68810.6037  38.2%     - 1766s
     0     0 68797.2277    0  406 49806.9305 68797.2277  38.1%     - 1776s
     0     0 68791.7677    0  415 49806.9305 68791.7677  38.1%     - 1784s
     0     0 68790.1537    0  413 49806.9305 68790.1537  38.1%     - 1788s
     0     0 68527.8510    0  383 49806.9305 68527.8510  37.6%     - 1829s
     0     0 68474.0284    0  378 49806.9305 68474.0284  37.5%     - 1859s
     0     0 68439.3156    0  342 49806.9305 68439.3156  37.4%     - 1878s
     0     0 68411.6848    0  400 49806.9305 68411.6848  37.4%     - 1896s
     0     0 68393.0695    0  393 49806.9305 68393.0695  37.3%     - 1905s
     0     0 68383.7154    0  397 49806.9305 68383.7154  37.3%     - 1918s
     0     0 68365.5732    0  386 49806.9305 68365.5732  37.3%     - 1926s
     0     0 68358.8014    0  388 49806.9305 68358.8014  37.2%     - 1934s
     0     0 68356.1949    0  387 49806.9305 68356.1949  37.2%     - 1938s
     0     0 68354.4616    0  388 49806.9305 68354.4616  37.2%     - 1941s
     0     0 68261.6045    0  394 49806.9305 68261.6045  37.1%     - 1967s
H    0     0                    49995.685159 68259.6125  36.5%     - 1983s
     0     0 68198.1160    0  399 49995.6852 68198.1160  36.4%     - 2008s
     0     0 68180.8983    0  396 49995.6852 68180.8983  36.4%     - 2021s
     0     0 68177.9966    0  403 49995.6852 68177.9966  36.4%     - 2026s
     0     0 68177.1023    0  406 49995.6852 68177.1023  36.4%     - 2029s
     0     0 68155.9894    0  349 49995.6852 68155.9894  36.3%     - 2046s
     0     0 68151.4038    0  400 49995.6852 68151.4038  36.3%     - 2055s
     0     0 68149.0859    0  397 49995.6852 68149.0859  36.3%     - 2060s
     0     0 68119.5666    0  368 49995.6852 68119.5666  36.3%     - 2087s
     0     0 68117.9632    0  361 49995.6852 68117.9632  36.2%     - 2101s
     0     0 68109.4894    0  363 49995.6852 68109.4894  36.2%     - 2114s
     0     0 68103.5177    0  365 49995.6852 68103.5177  36.2%     - 2123s
     0     0 68100.3669    0  364 49995.6852 68100.3669  36.2%     - 2129s
     0     0 68099.3771    0  362 49995.6852 68099.3771  36.2%     - 2132s
     0     0 68097.7932    0  422 49995.6852 68097.7932  36.2%     - 2143s
     0     0 68095.8684    0  407 49995.6852 68095.8684  36.2%     - 2195s
     0     0 68092.3754    0  403 49995.6852 68092.3754  36.2%     - 2207s
     0     0 68091.4070    0  403 49995.6852 68091.4070  36.2%     - 2216s
     0     2 68090.9109    0  403 49995.6852 68090.9109  36.2%     - 2678s
     1     3 67390.0455    1  373 49995.6852 68090.4173  36.2% 36222 2812s
     2     4 67942.8089    1  350 49995.6852 67942.8089  35.9% 25512 2852s
     3     5 66829.3618    2  377 49995.6852 67942.6408  35.9% 23902 2904s
     4     7 66548.5953    3  316 49995.6852 67942.6408  35.9% 21221 2964s
     6    14 66636.9989    3  352 49995.6852 67942.6408  35.9% 20962 3039s
    13    28 66313.0048    4  328 49995.6852 67417.2247  34.8% 16663 3100s
    27    42 66565.1013    4  352 49995.6852 67265.3171  34.5% 27154 3324s
    41    69 65969.7447    5  346 49995.6852 67265.3171  34.5% 27440 3600s
H   54    69                    50038.431109 67265.3171  34.4% 25654 3600s

Cutting planes:
  Learned: 3
  Gomory: 25
  Implied bound: 232
  MIR: 3989
  Flow cover: 4546
  RLT: 54
  Relax-and-lift: 659
  BQP: 1

Explored 68 nodes (2450676 simplex iterations) in 3600.18 seconds (4301.37 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 50038.4 49995.7 49806.9 ... 47244.4

Time limit reached
Best objective 5.003843110947e+04, best bound 6.726531708166e+04, gap 34.4273%
  WARNING: Time limit reached. Using best solution found (gap: 34.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.22s
  Master Objective (UB) = 50038.43, θ = 214536.29
  Upper Bound (UB) = 50038.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214536.29
  [DEBUG]   ✓ Scenario 0: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 214536.29 ≤ Q = 214536.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 214536.29 ≤ Q = 214536.29 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x509fb765
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaf60489b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.391251e+13
Presolve removed 2554 rows and 1845 columns
Presolve time: 0.01s
Presolved: 539 rows, 544 columns, 1524 nonzeros
Found heuristic solution: objective 6884381.3543
Variable types: 370 continuous, 174 integer (174 binary)

Root relaxation: objective -1.859581e+05, 270 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -185958.06    0  131 6884381.35 -185958.06   103%     -    0s
H    0     0                    -150353.7793 -185958.06  23.7%     -    0s
     0     0 -158856.85    0   35 -150353.78 -158856.85  5.66%     -    0s
H    0     0                    -157677.3762 -158787.91  0.70%     -    0s
H    0     0                    -157824.3974 -158787.91  0.61%     -    0s
H    0     0                    -158184.6705 -158787.91  0.38%     -    0s
     0     0 -158787.91    0   24 -158184.67 -158787.91  0.38%     -    0s
     0     0 -158658.05    0   25 -158184.67 -158658.05  0.30%     -    0s
H    0     0                    -158187.4521 -158656.69  0.30%     -    0s
     0     0 -158446.23    0   19 -158187.45 -158446.23  0.16%     -    0s
     0     0 -158434.71    0   19 -158187.45 -158434.71  0.16%     -    0s
     0     0 -158408.86    0   24 -158187.45 -158408.86  0.14%     -    0s
     0     0 -158408.86    0   69 -158187.45 -158408.86  0.14%     -    0s
     0     0 -158408.86    0   30 -158187.45 -158408.86  0.14%     -    0s
     0     0 -158408.86    0   23 -158187.45 -158408.86  0.14%     -    0s
     0     0 -158390.12    0   25 -158187.45 -158390.12  0.13%     -    0s
     0     0 -158390.12    0   25 -158187.45 -158390.12  0.13%     -    0s
     0     0 -158341.74    0   26 -158187.45 -158341.74  0.10%     -    0s
H    0     0                    -158203.8121 -158338.44  0.09%     -    0s
     0     0 -158338.44    0   18 -158203.81 -158338.44  0.09%     -    0s
     0     0 -158322.78    0   26 -158203.81 -158322.78  0.08%     -    0s
     0     0 -158320.58    0   26 -158203.81 -158320.58  0.07%     -    0s
     0     2 -158320.58    0   26 -158203.81 -158320.58  0.07%     -    0s
*   55     7               8    -158204.3342 -158229.16  0.02%   4.3    0s

Cutting planes:
  Gomory: 17
  Implied bound: 9
  MIR: 64
  Flow cover: 9
  RLT: 7

Explored 59 nodes (1055 simplex iterations) in 0.20 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -158204 -158204 -158187 ... 1.39125e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.582043341717e+05, best bound -1.582164501880e+05, gap 0.0077%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 209027.14
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -158204.33
  [DEBUG]   S×d_nominal = 367231.48
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367231.48 + -158204.33 = 209027.14
  [DEBUG]   Current θ from Master = 214536.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5509.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44529.28
  Lower Bound (LB) = 50164.11
  Gap (UB-LB) = -125.6767, Absolute Gap = 125.6767, Relative Gap = -0.002512
  *** CONVERGED (small negative gap: -125.68 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 23
Total Time: 67693.80s
Converged: True
Final Lower Bound: 50164.1078
Final Upper Bound: 50038.4311
Final Gap: -125.676650
Number of Critical Scenarios: 23
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 3, 5, 8, 9] (5/10)
Active Routes (Plant→DC): 15
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 7 customers  Mode 2: 42 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 23
Start Time: 2026-01-05 15:25:04
End Time: 2026-01-06 10:13:18
Total Time: 67693.80s
Optimal Value: 50164.11
Lower Bound: 50164.11
Upper Bound: 50038.43
Gap: -125.676650
Plants Opened: {0: [1], 1: [0], 2: [2]} (3 plants)
DCs Opened: [2, 3, 5, 8, 9] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed40_HD_gamma20_20260106_101318.csv

Total Execution Time: 67694.32 seconds
End Time: 2026-01-06 10:13:18

All tasks completed successfully!

