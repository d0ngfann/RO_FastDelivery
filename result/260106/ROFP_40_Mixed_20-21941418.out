
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 40
DI Scenario: Mixed
Start Time: 2026-01-05 15:25:04
================================================================================
Loading data from data/DH_data_full_seed40.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
  Product 1: ['1.000', '1.272', '1.619'] (k=0.594)
  Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=900, max=1732
  DC capacity (MC): min=418, max=894

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.01, max=34.70, count=87
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5661, max=9568
  DC fixed cost: min=3076, max=5936
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
    Product 1: ['1.000', '1.397', '1.953'] (k=0.825)
    Product 2: ['1.000', '1.475', '2.176'] (k=0.959)
  MD:
    Product 0: ['1.000', '1.261', '1.590'] (k=0.572)
    Product 1: ['1.000', '1.272', '1.619'] (k=0.594)
    Product 2: ['1.000', '1.200', '1.439'] (k=0.449)
  LD:
    Product 0: ['1.000', '1.116', '1.247'] (k=0.272)
    Product 1: ['1.000', '1.084', '1.176'] (k=0.200)
    Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
  Mixed:
    Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
    Product 1: ['1.000', '1.272', '1.619'] (k=0.594)
    Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0xe0f367ae
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.12s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -276983.6688
Found heuristic solution: objective -198039.8849

Root relaxation: objective 1.060101e+05, 5109 iterations, 0.33 seconds (0.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 106010.075    0  437 -198039.88 106010.075   154%     -    0s
H    0     0                    -192206.2407 106010.075   155%     -    0s
H    0     0                    -190369.1438 95804.8381   150%     -    1s
     0     0 95804.8381    0  708 -190369.14 95804.8381   150%     -    1s
     0     0 95497.6281    0  724 -190369.14 95497.6281   150%     -    1s
     0     0 95416.6780    0  730 -190369.14 95416.6780   150%     -    1s
     0     0 95416.3579    0  730 -190369.14 95416.3579   150%     -    1s
H    0     0                    -148678.6242 91215.6483   161%     -    3s
     0     0 91215.6483    0 1020 -148678.62 91215.6483   161%     -    3s
     0     0 91015.5428    0 1015 -148678.62 91015.5428   161%     -    3s
     0     0 91015.5428    0 1029 -148678.62 91015.5428   161%     -    3s
     0     0 91010.8117    0 1032 -148678.62 91010.8117   161%     -    3s
     0     0 91010.2812    0 1034 -148678.62 91010.2812   161%     -    3s
H    0     0                    -147293.1144 87491.4321   159%     -    5s
H    0     0                    -137193.3830 87491.4321   164%     -    5s
     0     0 87491.4321    0  931 -137193.38 87491.4321   164%     -    5s
     0     0 87061.6668    0 1102 -137193.38 87061.6668   163%     -    6s
     0     0 86965.3421    0  956 -137193.38 86965.3421   163%     -    6s
     0     0 86945.8237    0  950 -137193.38 86945.8237   163%     -    6s
     0     0 86942.1370    0  955 -137193.38 86942.1370   163%     -    7s
H    0     0                    -137177.3661 86942.1370   163%     -    7s
H    0     0                    -136116.1995 86942.1370   164%     -    7s
H    0     0                    -127501.8655 83105.6493   165%     -   10s
H    0     0                    -118718.3040 83105.6493   170%     -   10s
H    0     0                    -96074.51044 83105.6493   187%     -   10s
H    0     0                    15991.817743 83105.6493   420%     -   10s
H    0     0                    35675.484718 83105.6493   133%     -   10s
     0     0 83105.6493    0 1076 35675.4847 83105.6493   133%     -   10s
     0     0 82729.6310    0 1087 35675.4847 82729.6310   132%     -   10s
     0     0 82633.1531    0 1093 35675.4847 82633.1531   132%     -   11s
     0     0 82622.0696    0 1097 35675.4847 82622.0696   132%     -   11s
     0     0 82618.7252    0 1100 35675.4847 82618.7252   132%     -   11s
     0     0 80698.5312    0 1086 35675.4847 80698.5312   126%     -   13s
H    0     0                    35681.474602 80478.0740   126%     -   14s
H    0     0                    35962.895422 80478.0740   124%     -   14s
H    0     0                    35966.004367 80478.0740   124%     -   14s
H    0     0                    35971.994251 80478.0740   124%     -   14s
H    0     0                    36090.457310 80478.0740   123%     -   14s
     0     0 80478.0740    0 1093 36090.4573 80478.0740   123%     -   14s
     0     0 80403.8129    0 1096 36090.4573 80403.8129   123%     -   14s
     0     0 80391.2172    0 1110 36090.4573 80391.2172   123%     -   14s
H    0     0                    36281.965413 77819.6857   114%     -   17s
H    0     0                    37617.307376 77819.6857   107%     -   17s
H    0     0                    37655.023687 77819.6857   107%     -   17s
     0     0 77819.6857    0 1045 37655.0237 77819.6857   107%     -   17s
     0     0 77457.3732    0 1070 37655.0237 77457.3732   106%     -   18s
H    0     0                    37714.191026 77344.2824   105%     -   18s
H    0     0                    37754.853079 77344.2824   105%     -   18s
     0     0 77344.2824    0 1091 37754.8531 77344.2824   105%     -   18s
     0     0 77294.5513    0 1093 37754.8531 77294.5513   105%     -   18s
     0     0 77274.6479    0 1101 37754.8531 77274.6479   105%     -   19s
     0     0 77271.2507    0 1090 37754.8531 77271.2507   105%     -   19s
H    0     0                    38511.941033 76142.7571  97.7%     -   21s
H    0     0                    38541.619341 76142.7571  97.6%     -   21s
H    0     0                    38544.537595 76142.7571  97.5%     -   21s
     0     0 76142.7571    0 1082 38544.5376 76142.7571  97.5%     -   21s
H    0     0                    38790.768315 75867.0032  95.6%     -   22s
H    0     0                    39573.740050 75867.0032  91.7%     -   22s
H    0     0                    39703.884935 75867.0032  91.1%     -   22s
H    0     0                    39838.782545 75867.0032  90.4%     -   22s
H    0     0                    40456.820931 75867.0032  87.5%     -   22s
H    0     0                    40459.739184 75867.0032  87.5%     -   22s
H    0     0                    40471.364549 75867.0032  87.5%     -   22s
     0     0 75867.0032    0 1093 40471.3645 75867.0032  87.5%     -   22s
     0     0 75793.6311    0 1110 40471.3645 75793.6311  87.3%     -   23s
     0     0 75771.3345    0 1113 40471.3645 75771.3345  87.2%     -   23s
     0     0 75765.6220    0 1109 40471.3645 75765.6220  87.2%     -   23s
H    0     0                    41980.307192 73178.2441  74.3%     -   27s
H    0     0                    42039.204241 73178.2441  74.1%     -   27s
H    0     0                    42039.799027 73178.2441  74.1%     -   27s
H    0     0                    42582.803064 73178.2441  71.8%     -   27s
     0     0 73178.2441    0 1038 42582.8031 73178.2441  71.8%     -   27s
     0     0 72790.1203    0 1076 42582.8031 72790.1203  70.9%     -   28s
     0     0 72719.4437    0 1088 42582.8031 72719.4437  70.8%     -   29s
     0     0 72704.5543    0 1105 42582.8031 72704.5543  70.7%     -   29s
     0     0 71548.2774    0 1080 42582.8031 71548.2774  68.0%     -   31s
     0     0 71329.3359    0 1129 42582.8031 71329.3359  67.5%     -   33s
     0     0 71257.9688    0 1115 42582.8031 71257.9688  67.3%     -   33s
     0     0 71225.6481    0 1145 42582.8031 71225.6481  67.3%     -   34s
     0     0 71218.3600    0 1158 42582.8031 71218.3600  67.2%     -   34s
     0     0 70361.3992    0 1069 42582.8031 70361.3992  65.2%     -   36s
H    0     0                    42659.005690 70125.9206  64.4%     -   37s
H    0     0                    42659.600477 70125.9206  64.4%     -   37s
     0     0 70125.9206    0 1104 42659.6005 70125.9206  64.4%     -   37s
     0     0 70026.2657    0 1100 42659.6005 70026.2657  64.2%     -   38s
     0     0 69997.4311    0 1117 42659.6005 69997.4311  64.1%     -   39s
     0     0 69183.4570    0 1011 42659.6005 69183.4570  62.2%     -   41s
     0     0 68935.9577    0 1059 42659.6005 68935.9577  61.6%     -   42s
     0     0 68882.7441    0 1091 42659.6005 68882.7441  61.5%     -   43s
     0     0 68869.0504    0 1091 42659.6005 68869.0504  61.4%     -   43s
     0     0 68316.5198    0  999 42659.6005 68316.5198  60.1%     -   46s
     0     0 68170.9882    0 1025 42659.6005 68170.9882  59.8%     -   47s
     0     0 68120.5329    0 1034 42659.6005 68120.5329  59.7%     -   48s
     0     0 68099.3317    0 1090 42659.6005 68099.3317  59.6%     -   48s
     0     0 67541.2102    0 1077 42659.6005 67541.2102  58.3%     -   50s
     0     0 67381.6093    0 1068 42659.6005 67381.6093  58.0%     -   52s
     0     0 67340.8613    0 1142 42659.6005 67340.8613  57.9%     -   53s
     0     0 67323.8747    0 1131 42659.6005 67323.8747  57.8%     -   53s
     0     0 66927.1529    0 1068 42659.6005 66927.1529  56.9%     -   55s
     0     0 66825.6744    0 1061 42659.6005 66825.6744  56.6%     -   56s
     0     0 66787.7717    0 1092 42659.6005 66787.7717  56.6%     -   57s
     0     0 66516.2162    0  988 42659.6005 66516.2162  55.9%     -   59s
     0     0 66515.2638    0  988 42659.6005 66515.2638  55.9%     -   59s
     0     2 66515.2638    0  988 42659.6005 66515.2638  55.9%     -   64s
     1     4 65810.8988    1  830 42659.6005 66513.8682  55.9%  2785   67s
     3     8 65153.9278    2  790 42659.6005 65810.4374  54.3%  4481   72s
     7    16 65103.9714    3  783 42659.6005 65153.6771  52.7%  4323   75s
    31    60 63457.3677    5  663 42659.6005 63841.3270  49.7%  3486   83s
    61    90 62731.4875    6  493 42659.6005 63456.8185  48.8%  5128   86s
H  245   285                    43396.200531 62519.6808  44.1%  1850   89s
   290   420 61361.1158   14  275 43396.2005 62519.6808  44.1%  1618   90s
H  433   500                    44136.100304 62519.6808  41.7%  1200   91s
H  640   639                    44155.046150 62513.7079  41.6%   955   93s
   808   762 58333.1435   22  228 44155.0462 61980.1349  40.4%   845   95s
  1328  1308 54033.8571   27  236 44155.0462 61665.8089  39.7%   632  100s
  2180  1956 48656.3077   39  235 44155.0462 61455.6836  39.2%   508  105s
  3205  2752 50441.2587   22  177 44155.0462 60885.0900  37.9%   450  111s
  3790  3011 51557.4721   18  988 44155.0462 60873.7255  37.9%   421  153s
  3796  3015 48350.2567   35  265 44155.0462 59076.9646  33.8%   421  155s
  3819  3035 52461.3258   14  228 44155.0462 54625.9267  23.7%   422  160s
H 4140  2943                    44317.155862 51917.5713  17.2%   414  163s
H 4141  2798                    44370.666374 51917.5713  17.0%   414  163s
H 4153  2657                    44413.882443 51917.5713  16.9%   413  163s
H 4268  2489                    44414.103775 51638.9598  16.3%   406  163s
  4571  2373 45702.5720   24  198 44414.1038 49696.5138  11.9%   390  165s
H 4577  2247                    44425.679413 49696.5138  11.9%   389  165s
H 4730  2048                    44582.305933 49516.3519  11.1%   381  165s
H 4812  1908                    44589.862040 49495.8142  11.0%   378  165s
H 5091  1612                    44665.257232 48101.1789  7.69%   365  167s
H 5093  1512                    44789.477588 48101.1789  7.39%   365  167s
H 5094  1415                    45039.207161 48101.1789  6.80%   364  167s
H 5185  1351                    45141.524126 46612.4567  3.26%   360  167s
H 5191  1263                    45174.067500 46612.4567  3.18%   359  167s
H 5202  1177                    45230.588339 46612.4567  3.06%   359  167s
H 5210  1097                    45298.409772 46612.4567  2.90%   358  167s
* 8652   868              69    45345.333378 45555.8250  0.46%   223  169s

Cutting planes:
  Implied bound: 8
  Projected implied bound: 15
  MIR: 181
  Flow cover: 357
  RLT: 8
  Relax-and-lift: 75

Explored 11084 nodes (2082285 simplex iterations) in 169.69 seconds (207.88 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 45345.3 45298.4 45230.6 ... 44582.3

Optimal solution found (tolerance 1.00e-04)
Best objective 4.534533337751e+04, best bound 4.534533337751e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 169.70s
  Master Objective (UB) = 45345.33, θ = 180624.49
  Upper Bound (UB) = 45345.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 180624.49
  [DEBUG]   ✓ Scenario 0: θ = 180624.49 ≤ Q = 180624.49 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x40bb13ac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbf44ec54
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.375995e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 7016473.7950
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.688073e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168807.31    0  126 7016473.80 -168807.31   102%     -    0s
H    0     0                    -131157.6780 -168807.31  28.7%     -    0s
H    0     0                    -131687.8270 -168807.31  28.2%     -    0s
H    0     0                    -135561.5905 -135561.59  0.00%     -    0s
     0     0          -    0      -135561.59 -135561.59  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 213

Explored 1 nodes (399 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -135562 -131688 -131158 ... 1.376e+13
No other solutions better than -135562

Optimal solution found (tolerance 1.00e-04)
Best objective -1.355615905243e+05, best bound -1.355615905243e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 151823.29
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135561.59
  [DEBUG]   S×d_nominal = 287384.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 287384.88 + -135561.59 = 151823.29
  [DEBUG]   Current θ from Master = 180624.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 28801.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16544.14
  Lower Bound (LB) = 16544.14
  Gap (UB-LB) = 28801.1977, Absolute Gap = 28801.1977, Relative Gap = 0.635152
  Not converged yet (gap = 28801.20 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0x8926da1d
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 16544.1 (0.02s)
MIP start from previous solve produced solution with objective 16544.1 (0.02s)
Loaded MIP start from previous solve with objective 16544.1

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.48s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.141863e+04, 9408 iterations, 1.82 seconds (2.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51418.6343    0  382 16544.1357 51418.6343   211%     -    2s
H    0     0                    19614.441893 51418.6343   162%     -    2s
H    0     0                    20627.941967 51418.6343   149%     -    2s
     0     0 43442.4501    0  337 20627.9420 43442.4501   111%     -    4s
H    0     0                    20655.835797 43435.7498   110%     -    4s
     0     0 42852.0330    0  444 20655.8358 42852.0330   107%     -    5s
     0     0 42812.9992    0  312 20655.8358 42812.9992   107%     -    5s
     0     0 39539.6528    0  401 20655.8358 39539.6528  91.4%     -    7s
H    0     0                    20660.805384 39537.7916  91.4%     -    7s
     0     0 39199.6125    0  417 20660.8054 39199.6125  89.7%     -    7s
     0     0 38788.3209    0  452 20660.8054 38788.3209  87.7%     -    8s
     0     0 38747.8078    0  436 20660.8054 38747.8078  87.5%     -    8s
     0     0 38742.3854    0  445 20660.8054 38742.3854  87.5%     -    8s
     0     0 38742.2193    0  444 20660.8054 38742.2193  87.5%     -    8s
     0     0 36215.6049    0  340 20660.8054 36215.6049  75.3%     -   10s
H    0     0                    20663.065905 35722.1287  72.9%     -   11s
H    0     0                    20670.159965 35722.1287  72.8%     -   11s
     0     0 35722.1287    0  422 20670.1600 35722.1287  72.8%     -   11s
     0     0 35315.6689    0  434 20670.1600 35315.6689  70.9%     -   12s
     0     0 35200.3773    0  454 20670.1600 35200.3773  70.3%     -   12s
     0     0 35197.2792    0  455 20670.1600 35197.2792  70.3%     -   12s
H    0     0                    20675.879343 33696.1778  63.0%     -   15s
     0     0 33696.1778    0  349 20675.8793 33696.1778  63.0%     -   15s
     0     0 33005.7292    0  347 20675.8793 33005.7292  59.6%     -   16s
     0     0 32870.7435    0  367 20675.8793 32870.7435  59.0%     -   17s
     0     0 32834.0889    0  365 20675.8793 32834.0889  58.8%     -   17s
     0     0 32825.0524    0  366 20675.8793 32825.0524  58.8%     -   17s
     0     0 32821.8840    0  378 20675.8793 32821.8840  58.7%     -   17s
     0     0 32343.7644    0  427 20675.8793 32343.7644  56.4%     -   19s
H    0     0                    20714.437314 32340.5798  56.1%     -   19s
H    0     0                    20730.103746 32340.5798  56.0%     -   19s
     0     0 32220.2605    0  433 20730.1037 32220.2605  55.4%     -   20s
     0     0 32157.1049    0  376 20730.1037 32157.1049  55.1%     -   20s
     0     0 32144.6738    0  375 20730.1037 32144.6738  55.1%     -   20s
     0     0 32134.9592    0  375 20730.1037 32134.9592  55.0%     -   20s
     0     0 32132.3549    0  378 20730.1037 32132.3549  55.0%     -   21s
     0     0 31939.6396    0  348 20730.1037 31939.6396  54.1%     -   21s
H    0     0                    20739.961108 31935.8168  54.0%     -   25s
H    0     0                    20816.610657 31935.8168  53.4%     -   25s
H    0     0                    21003.864409 31935.8168  52.0%     -   25s
     0     0 31895.7414    0  406 21003.8644 31895.7414  51.9%     -   26s
     0     0 31885.1906    0  341 21003.8644 31885.1906  51.8%     -   26s
     0     0 31882.0584    0  344 21003.8644 31882.0584  51.8%     -   26s
     0     0 31828.0114    0  422 21003.8644 31828.0114  51.5%     -   27s
     0     0 31820.8691    0  432 21003.8644 31820.8691  51.5%     -   27s
     0     0 31817.3832    0  431 21003.8644 31817.3832  51.5%     -   27s
H    0     0                    21040.701442 31785.5717  51.1%     -   28s
H    0     0                    21043.852458 31785.5717  51.0%     -   28s
     0     0 31785.5717    0  365 21043.8525 31785.5717  51.0%     -   28s
     0     0 31779.0556    0  354 21043.8525 31779.0556  51.0%     -   28s
     0     0 31777.1848    0  358 21043.8525 31777.1848  51.0%     -   28s
     0     0 31739.8468    0  327 21043.8525 31739.8468  50.8%     -   28s
     0     0 31720.6822    0  345 21043.8525 31720.6822  50.7%     -   29s
     0     0 31715.6716    0  358 21043.8525 31715.6716  50.7%     -   29s
     0     0 31683.2240    0  347 21043.8525 31683.2240  50.6%     -   29s
     0     0 31678.2574    0  358 21043.8525 31678.2574  50.5%     -   29s
     0     0 31673.2356    0  356 21043.8525 31673.2356  50.5%     -   30s
     0     0 31672.0809    0  355 21043.8525 31672.0809  50.5%     -   30s
     0     0 31668.7805    0  353 21043.8525 31668.7805  50.5%     -   30s
     0     0 31668.4035    0  353 21043.8525 31668.4035  50.5%     -   31s
H    0     0                    21044.091262 31668.3382  50.5%     -   37s
H    0     0                    21333.378559 31668.3382  48.4%     -   38s
     0     2 31668.3382    0  353 21333.3786 31668.3382  48.4%     -   38s
     7    16 30485.4317    3  365 21333.3786 31407.6030  47.2%   988   40s
    95   159 29087.5577    7  370 21333.3786 30874.5317  44.7%   909   47s
   193   224 28789.5720    9  344 21333.3786 30874.5317  44.7%   647   51s
H  258   256                    21354.428464 30874.5317  44.6%   622   52s
   344   355 27046.2743   11  342 21354.4285 30874.5317  44.6%   683   56s
   429   436 27482.1398   13  294 21354.4285 30826.5505  44.4%   683   60s
H  458   436                    21485.881136 30826.5505  43.5%   678   60s
   664   618 24664.8008   16  433 21485.8811 30826.5505  43.5%   646   66s
   836   759 22706.0123   17  264 21485.8811 30025.0840  39.7%   617   70s
  1147   897 26115.0011    8  201 21485.8811 29802.6684  38.7%   574   76s
  1472  1022 23619.2245   17  154 21485.8811 29697.4094  38.2%   543   82s
  1696  1144 22098.8809   31  184 21485.8811 29599.5291  37.8%   524   86s
  2010  1251 22976.3966   14  284 21485.8811 29297.0465  36.4%   504   90s
  2532  1457 25253.9746   16  212 21485.8811 29125.6741  35.6%   482   97s
  2707  1534     cutoff   18      21485.8811 29117.0758  35.5%   477  100s
  3319  1699     cutoff   14      21485.8811 28818.9336  34.1%   462  107s
  3649  1897 25653.7502   15  292 21485.8811 28794.3210  34.0%   468  111s
  4170  2022 26981.9048   12  276 21485.8811 28622.4888  33.2%   457  118s
  4332  2081     cutoff   14      21485.8811 28440.4185  32.4%   462  121s
H 4711  2114                    21545.714773 28402.7055  31.8%   460  123s
  4738  2172 23979.4978   13  296 21545.7148 28402.7055  31.8%   460  126s
  5263  2280 infeasible   20      21545.7148 28213.0299  30.9%   457  132s
  5530  2360     cutoff   30      21545.7148 28190.4494  30.8%   456  135s
* 5631  2358              27    21603.070946 28112.8421  30.1%   456  135s
H 5794  2276                    22110.121032 28112.8421  27.1%   457  138s
H 5874  2189                    22338.081519 28112.8421  25.9%   457  138s
  6023  2215     cutoff   18      22338.0815 28102.3021  25.8%   455  142s
  6290  2263     cutoff   18      22338.0815 27770.9218  24.3%   456  145s
  6880  2362     cutoff   18      22338.0815 27508.3319  23.1%   460  153s
  7182  2409 24489.1388   14  240 22338.0815 27406.8263  22.7%   460  157s
  7455  2421     cutoff   15      22338.0815 27352.9379  22.4%   459  161s
  7856  2454     cutoff   16      22338.0815 27239.7680  21.9%   458  165s
  8258  2467     cutoff   14      22338.0815 27007.9558  20.9%   456  171s
  8646  2497 22668.7117   15   60 22338.0815 26837.1493  20.1%   455  175s
  9519  2520 24697.2772   13  293 22338.0815 26661.7357  19.4%   451  183s
  9923  2487 25613.8034   15  250 22338.0815 26567.5940  18.9%   450  188s
 10443  2444 23233.0766   19  223 22338.0815 26262.2623  17.6%   448  192s
 10956  2381     cutoff   15      22338.0815 26101.1436  16.8%   447  196s
 11455  2300 24019.8735   16  289 22338.0815 25962.6037  16.2%   446  201s
 12065  2165 22916.8998   13  228 22338.0815 25797.7523  15.5%   444  206s
 12683  2017     cutoff   15      22338.0815 25575.7243  14.5%   442  211s
 13319  1750 23703.9709   11  205 22338.0815 25310.2962  13.3%   440  217s
 14033  1547 22710.2427   11  276 22338.0815 24968.2037  11.8%   437  223s
 14498  1040     cutoff   22      22338.0815 24737.7461  10.7%   434  229s
 15412   150     cutoff   16      22338.0815 24530.0438  9.81%   426  234s
 16654     0     cutoff   17      22338.0815 24453.4263  9.47%   408  237s

Cutting planes:
  Gomory: 4
  Implied bound: 7
  MIR: 1286
  Flow cover: 739
  Zero half: 1
  RLT: 54
  Relax-and-lift: 312

Explored 16830 nodes (6847526 simplex iterations) in 237.77 seconds (453.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 22338.1 22110.1 21603.1 ... 21040.7

Optimal solution found (tolerance 1.00e-04)
Best objective 2.233808151880e+04, best bound 2.233808151880e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 237.79s
  Master Objective (UB) = 22338.08, θ = 161825.60
  Upper Bound (UB) = 22338.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161825.60
  [DEBUG]   ✓ Scenario 0: θ = 161825.60 ≤ Q = 161825.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161825.60 ≤ Q = 161825.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x15d73120
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xea28cee0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.312566e+13
Presolve removed 2564 rows and 1855 columns
Presolve time: 0.01s
Presolved: 529 rows, 534 columns, 1493 nonzeros
Found heuristic solution: objective 6816229.2398
Variable types: 361 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6815949.4870

Root relaxation: objective -1.688408e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168840.84    0  135 6815949.49 -168840.84   102%     -    0s
H    0     0                    -147024.9593 -168840.84  14.8%     -    0s
H    0     0                    -147304.7120 -168840.84  14.6%     -    0s
H    0     0                    -147546.6069 -168542.66  14.2%     -    0s
     0     0 -156699.88    0  106 -147546.61 -156699.88  6.20%     -    0s
H    0     0                    -152811.1563 -156691.81  2.54%     -    0s
H    0     0                    -153090.9090 -156691.81  2.35%     -    0s
H    0     0                    -154374.7197 -156691.81  1.50%     -    0s
H    0     0                    -154654.4724 -156691.81  1.32%     -    0s
     0     0 -156121.59    0   90 -154654.47 -156121.59  0.95%     -    0s
     0     0 -155075.09    0   45 -154654.47 -155075.09  0.27%     -    0s
     0     0 -155047.31    0   42 -154654.47 -155047.31  0.25%     -    0s
     0     0 -155035.80    0   40 -154654.47 -155035.80  0.25%     -    0s
     0     0 -154961.60    0   36 -154654.47 -154961.60  0.20%     -    0s
     0     0 -154959.99    0   34 -154654.47 -154959.99  0.20%     -    0s
     0     0 -154744.44    0   11 -154654.47 -154744.44  0.06%     -    0s
     0     0 -154744.14    0   10 -154654.47 -154744.14  0.06%     -    0s
     0     0 -154739.53    0   10 -154654.47 -154739.53  0.05%     -    0s
     0     0 -154694.63    0    4 -154654.47 -154694.63  0.03%     -    0s
     0     0 -154694.63    0    5 -154654.47 -154694.63  0.03%     -    0s
H    0     0                    -154686.6235 -154694.63  0.01%     -    0s

Explored 1 nodes (749 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -154687 -154654 -154449 ... 6.81623e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.546866235271e+05, best bound -1.546946318664e+05, gap 0.0052%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 139567.89
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154686.62
  [DEBUG]   S×d_nominal = 294254.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294254.52 + -154686.62 = 139567.89
  [DEBUG]   Current θ from Master = 161825.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22257.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 80.37
  Lower Bound (LB) = 16544.14
  Gap (UB-LB) = 5793.9459, Absolute Gap = 5793.9459, Relative Gap = 0.259375
  Not converged yet (gap = 5793.95 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0x313357f0
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 80.3716 (0.03s)
Loaded MIP start from previous solve with objective 80.3716

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.72s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.20s

Solved with dual simplex

Root relaxation: objective 4.296019e+04, 12476 iterations, 2.91 seconds (3.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42960.1939    0   92   80.37157 42960.1939      -     -    3s
H    0     0                     520.8276396 42960.1939  8148%     -    4s
H    0     0                    14308.668798 42960.1939   200%     -    4s
H    0     0                    14455.944503 42960.1939   197%     -    4s
     0     0 39674.6834    0  185 14455.9445 39674.6834   174%     -    6s
H    0     0                    14478.152282 39674.4138   174%     -    6s
     0     0 38216.9449    0  192 14478.1523 38216.9449   164%     -    7s
     0     0 38180.9648    0  186 14478.1523 38180.9648   164%     -    8s
     0     0 38180.9648    0  194 14478.1523 38180.9648   164%     -    8s
     0     0 38180.9648    0  196 14478.1523 38180.9648   164%     -    8s
     0     0 38180.9648    0  198 14478.1523 38180.9648   164%     -    8s
H    0     0                    14637.719334 35751.9015   144%     -   11s
H    0     0                    14668.700219 35751.9015   144%     -   11s
     0     0 35730.7757    0  254 14668.7002 35730.7757   144%     -   11s
H    0     0                    14684.249671 35730.7757   143%     -   11s
     0     0 34442.2056    0  231 14684.2497 34442.2056   135%     -   12s
     0     0 33991.4793    0  266 14684.2497 33991.4793   131%     -   13s
     0     0 33923.7058    0  240 14684.2497 33923.7058   131%     -   13s
     0     0 33907.6136    0  249 14684.2497 33907.6136   131%     -   13s
     0     0 33903.4632    0  246 14684.2497 33903.4632   131%     -   13s
     0     0 33901.6606    0  248 14684.2497 33901.6606   131%     -   13s
     0     0 33901.5970    0  250 14684.2497 33901.5970   131%     -   13s
     0     0 32168.3315    0  278 14684.2497 32168.3315   119%     -   16s
     0     0 31868.0938    0  290 14684.2497 31868.0938   117%     -   18s
H    0     0                    16321.914883 31778.5198  94.7%     -   18s
H    0     0                    16325.327045 31778.5198  94.7%     -   18s
H    0     0                    16392.417067 31778.5198  93.9%     -   18s
     0     0 31778.5198    0  305 16392.4171 31778.5198  93.9%     -   18s
     0     0 31725.6949    0  297 16392.4171 31725.6949  93.5%     -   19s
     0     0 31706.7863    0  305 16392.4171 31706.7863  93.4%     -   19s
     0     0 31700.5234    0  302 16392.4171 31700.5234  93.4%     -   19s
     0     0 31700.2565    0  302 16392.4171 31700.2565  93.4%     -   19s
     0     0 31119.9997    0  321 16392.4171 31119.9997  89.8%     -   22s
     0     0 30740.3577    0  324 16392.4171 30740.3577  87.5%     -   24s
     0     0 30715.9100    0  330 16392.4171 30715.9100  87.4%     -   24s
     0     0 30662.5124    0  338 16392.4171 30662.5124  87.1%     -   24s
     0     0 30631.9763    0  346 16392.4171 30631.9763  86.9%     -   25s
     0     0 30608.0740    0  337 16392.4171 30608.0740  86.7%     -   25s
     0     0 30584.2242    0  342 16392.4171 30584.2242  86.6%     -   26s
     0     0 30577.0401    0  349 16392.4171 30577.0401  86.5%     -   26s
     0     0 30572.6599    0  344 16392.4171 30572.6599  86.5%     -   26s
     0     0 30570.9392    0  338 16392.4171 30570.9392  86.5%     -   26s
     0     0 30570.7049    0  348 16392.4171 30570.7049  86.5%     -   26s
     0     0 30458.8371    0  344 16392.4171 30458.8371  85.8%     -   27s
H    0     0                    16403.266314 30455.9178  85.7%     -   27s
H    0     0                    16408.076145 30455.9178  85.6%     -   27s
     0     0 30418.5673    0  351 16408.0761 30418.5673  85.4%     -   28s
     0     0 30404.4101    0  354 16408.0761 30404.4101  85.3%     -   28s
     0     0 30401.6463    0  366 16408.0761 30401.6463  85.3%     -   29s
     0     0 30393.8607    0  359 16408.0761 30393.8607  85.2%     -   29s
     0     0 30392.4813    0  356 16408.0761 30392.4813  85.2%     -   29s
     0     0 30332.7722    0  344 16408.0761 30332.7722  84.9%     -   30s
H    0     0                    16416.038735 30332.3759  84.8%     -   31s
H    0     0                    18889.447083 30332.3759  60.6%     -   31s
     0     0 30288.9347    0  357 18889.4471 30288.9347  60.3%     -   32s
     0     0 30282.4969    0  359 18889.4471 30282.4969  60.3%     -   32s
     0     0 30281.3127    0  357 18889.4471 30281.3127  60.3%     -   32s
     0     0 30097.5801    0  353 18889.4471 30097.5801  59.3%     -   34s
     0     0 30064.9234    0  346 18889.4471 30064.9234  59.2%     -   34s
     0     0 30056.0719    0  344 18889.4471 30056.0719  59.1%     -   35s
     0     0 30051.1066    0  349 18889.4471 30051.1066  59.1%     -   35s
     0     0 30050.3148    0  353 18889.4471 30050.3148  59.1%     -   35s
     0     0 30039.0773    0  351 18889.4471 30039.0773  59.0%     -   35s
     0     0 30033.0160    0  358 18889.4471 30033.0160  59.0%     -   36s
     0     0 30031.9296    0  356 18889.4471 30031.9296  59.0%     -   36s
     0     0 29977.4729    0  402 18889.4471 29977.4729  58.7%     -   37s
     0     0 29971.8445    0  404 18889.4471 29971.8445  58.7%     -   37s
     0     0 29967.5037    0  398 18889.4471 29967.5037  58.6%     -   38s
     0     0 29965.0090    0  369 18889.4471 29965.0090  58.6%     -   38s
     0     0 29963.6558    0  378 18889.4471 29963.6558  58.6%     -   38s
     0     0 29962.0140    0  369 18889.4471 29962.0140  58.6%     -   38s
     0     0 29961.0632    0  406 18889.4471 29961.0632  58.6%     -   39s
     0     0 29960.2723    0  401 18889.4471 29960.2723  58.6%     -   39s
     0     0 29959.4745    0  367 18889.4471 29959.4745  58.6%     -   39s
     0     0 29957.6662    0  369 18889.4471 29957.6662  58.6%     -   40s
     0     0 29957.4445    0  369 18889.4471 29957.4445  58.6%     -   40s
H    0     0                    19259.451890 29957.4275  55.5%     -   46s
H    0     0                    19333.191351 29957.4275  55.0%     -   46s
     0     2 29957.4275    0  369 19333.1914 29957.4275  55.0%     -   46s
     3     8 29590.8457    2  358 19333.1914 29817.7498  54.2%  2258   50s
    15    32 29104.3558    4  368 19333.1914 29297.9831  51.5%  2133   55s
H   33    64                    19652.956188 29093.7363  48.0%  2904   57s
H   42    64                    19688.861092 29093.7363  47.8%  2485   57s
H   63    96                    19690.926819 28909.0476  46.8%  2469   59s
H   64    96                    19898.224622 28909.0476  45.3%  2439   59s
H   95   196                    20016.325916 28909.0476  44.4%  1966   62s
H  133   196                    20245.417911 28909.0476  42.8%  1658   62s
   195   250 28493.9919   10  353 20245.4179 28909.0476  42.8%  1417   65s
H  261   295                    20388.658816 28909.0476  41.8%  1388   68s
   317   368 27480.6200   11  346 20388.6588 28909.0476  41.8%  1416   71s
   398   437 28014.0670   12  355 20388.6588 28909.0476  41.8%  1296   75s
H  408   437                    20402.982984 28909.0476  41.7%  1328   75s
   511   541 27685.6229   13  341 20402.9830 28909.0476  41.7%  1214   80s
H  557   541                    20405.107457 28909.0476  41.7%  1190   80s
   696   708 27516.2679   16  328 20405.1075 28909.0476  41.7%  1043   85s
   852   816 27164.3650   19  323 20405.1075 28909.0476  41.7%   965   91s
  1009   885 26937.8612   21  365 20405.1075 28909.0476  41.7%   930   97s
  1047   908 25446.7526   21  246 20405.1075 28909.0476  41.7%   938  102s
  1138   966 26501.9918   22  318 20405.1075 28909.0476  41.7%   946  106s
  1249  1046 25687.7573   23  296 20405.1075 28485.1327  39.6%   911  110s
  1392  1163 25417.9772   25  283 20405.1075 28485.1327  39.6%   895  116s
  1485  1289 25219.7634   26  282 20405.1075 28485.1327  39.6%   881  122s
  1583  1376 24265.4468   26  279 20405.1075 28485.1327  39.6%   859  126s
  1709  1465 24834.2741   27  308 20405.1075 28485.1327  39.6%   828  130s
  2016  1696 24510.9127   28  308 20405.1075 28189.2350  38.1%   781  136s
  2363  1923 23979.0656   30  258 20405.1075 27946.9928  37.0%   738  143s
  2544  1983 23459.2395   34  242 20405.1075 27946.9928  37.0%   724  147s
  2680  2044 22650.4505   37  275 20405.1075 27902.7232  36.7%   727  151s
  2818  2145 21113.5050    9  281 20405.1075 27894.0999  36.7%   734  155s
  3164  2377 26516.3532   11  334 20405.1075 27791.5763  36.2%   723  162s
  3361  2481 25187.8520   13  287 20405.1075 27727.1035  35.9%   716  166s
  3550  2595 24424.8868   18  203 20405.1075 27727.1035  35.9%   717  170s
  3754  2677     cutoff   24      20405.1075 27604.8259  35.3%   714  175s
  4199  2819 26367.2720   11  315 20405.1075 27555.4028  35.0%   711  182s
  4419  2911 23724.7725   14  237 20405.1075 27555.4028  35.0%   713  187s
  4665  3035 23262.7188   16  292 20405.1075 27555.4028  35.0%   711  192s
  4912  3036 21352.7805   31  369 20405.1075 27531.8817  34.9%   708  203s
  4914  3037 23280.7401   38   92 20405.1075 27531.8817  34.9%   708  209s
  4915  3038 25725.8351   16  265 20405.1075 27531.8817  34.9%   708  215s
  4917  3039 22044.5900   32  333 20405.1075 27531.8817  34.9%   707  220s
  4923  3043 21250.4646   24  368 20405.1075 27531.8817  34.9%   707  226s
  4927  3046 23518.3082   25  370 20405.1075 27531.8817  34.9%   706  230s
  4932  3049 22662.0832   32  366 20405.1075 27531.8817  34.9%   705  237s
  4934  3051 25632.0024   11  400 20405.1075 27531.8817  34.9%   705  240s
  4939  3054 23930.2382   20  397 20405.1075 27531.8817  34.9%   704  252s
  4940  3055 21858.1554   42  397 20405.1075 27531.8817  34.9%   704  260s
  4943  3062 23424.9491   17  304 20405.1075 27531.8817  34.9%   716  266s
  4955  3074 27531.8817   19  313 20405.1075 27531.8817  34.9%   721  272s
  4968  3086 27531.8817   20  298 20405.1075 27531.8817  34.9%   724  277s
  4992  3104 27531.8817   21  303 20405.1075 27531.8817  34.9%   731  280s
  5024  3148 27531.8817   22  305 20405.1075 27531.8817  34.9%   750  285s
  5119  3176 25015.0465   24  232 20405.1075 27531.8817  34.9%   767  292s
  5157  3192 26540.7636   23  235 20405.1075 27531.8817  34.9%   772  295s
  5252  3231 26407.7072   25  313 20405.1075 27531.8817  34.9%   780  303s
  5322  3214 23917.3169   25  282 20405.1075 27531.8817  34.9%   783  307s
  5394  3213 21792.1339   25  250 20405.1075 27531.8817  34.9%   789  311s
  5467  3220 24862.0080   24  260 20405.1075 27531.8817  34.9%   795  317s
  5536  3225 22748.3908   24  230 20405.1075 27531.8817  34.9%   797  321s
  5610  3214 23574.0306   26  318 20405.1075 27531.8817  34.9%   799  325s
  5731  3220 22723.3819   28  265 20405.1075 27512.9527  34.8%   803  330s
  5847  3189     cutoff   28      20405.1075 26937.0165  32.0%   810  337s
  5926  3154     cutoff   30      20405.1075 26937.0165  32.0%   810  342s
  6034  3117 20607.6144   32  187 20405.1075 26656.3334  30.6%   813  346s
  6098  3105     cutoff   33      20405.1075 26652.3417  30.6%   817  350s
  6178  3086 21311.4967   31  187 20405.1075 26404.6764  29.4%   820  355s
  6252  3054     cutoff   32      20405.1075 25775.2565  26.3%   823  361s
  6358  2993     cutoff   27      20405.1075 25721.7464  26.1%   827  366s
  6469  2956     cutoff   25      20405.1075 25020.8464  22.6%   831  371s
  6569  2912     cutoff   29      20405.1075 25020.8464  22.6%   838  375s
  6814  2822 21818.6067   27  253 20405.1075 24604.0440  20.6%   845  383s
  6943  2751 22084.9045   26  245 20405.1075 24373.6788  19.4%   847  386s
  7107  2683     cutoff   26      20405.1075 24083.1714  18.0%   846  392s
  7213  2642     cutoff   28      20405.1075 24083.1714  18.0%   847  398s
  7356  2560     cutoff   26      20405.1075 23729.1097  16.3%   851  402s
  7541  2436 21339.2749   27  277 20405.1075 23729.1097  16.3%   850  406s
  7749  2261 21865.4599   32  245 20405.1075 23178.1620  13.6%   847  410s
  8241  1960     cutoff   26      20405.1075 21947.6311  7.56%   827  417s
  8325  1927 20678.0197   41  210 20405.1075 21099.3990  3.40%   821  421s

Cutting planes:
  MIR: 211
  Flow cover: 387
  RLT: 5
  Relax-and-lift: 56

Explored 8340 nodes (6895695 simplex iterations) in 422.22 seconds (750.36 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 20405.1 20403 20388.7 ... 19333.2

Optimal solution found (tolerance 1.00e-04)
Best objective 2.040510745664e+04, best bound 2.040510745664e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 422.23s
  Master Objective (UB) = 20405.11, θ = 155059.05
  Upper Bound (UB) = 20405.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155059.05
  [DEBUG]   ✓ Scenario 0: θ = 155059.05 ≤ Q = 155059.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155059.05 ≤ Q = 155059.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155059.05 ≤ Q = 155059.05 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3b1f513d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc4e0aec3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356718e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6858166.4004
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.762725e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -176272.51    0  130 6858166.40 -176272.51   103%     -    0s
H    0     0                    -139775.6559 -176272.51  26.1%     -    0s
H    0     0                    -139974.5277 -176272.51  25.9%     -    0s
     0     0 -156398.50    0   65 -139974.53 -156398.50  11.7%     -    0s
H    0     0                    -154867.7470 -156395.94  0.99%     -    0s
     0     0 -156317.51    0   64 -154867.75 -156317.51  0.94%     -    0s
     0     0 -156316.51    0   64 -154867.75 -156316.51  0.94%     -    0s
     0     0 -155872.53    0   34 -154867.75 -155872.53  0.65%     -    0s
H    0     0                    -155348.0544 -155849.74  0.32%     -    0s
     0     0 -155806.08    0   22 -155348.05 -155806.08  0.29%     -    0s
     0     0 -155791.98    0   22 -155348.05 -155791.98  0.29%     -    0s
     0     0 -155489.26    0   11 -155348.05 -155489.26  0.09%     -    0s
H    0     0                    -155361.5307 -155470.04  0.07%     -    0s
     0     0 -155464.80    0   20 -155361.53 -155464.80  0.07%     -    0s
     0     0 -155461.62    0   19 -155361.53 -155461.62  0.06%     -    0s
     0     0 -155457.51    0   15 -155361.53 -155457.51  0.06%     -    0s
     0     0 -155409.25    0    3 -155361.53 -155409.25  0.03%     -    0s
     0     0 -155409.25    0    8 -155361.53 -155409.25  0.03%     -    0s
H    0     0                    -155369.6151 -155409.25  0.03%     -    0s
     0     0 -155401.90    0    2 -155369.62 -155401.90  0.02%     -    0s
H    0     0                    -155384.9386 -155399.77  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 3
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (656 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -155385 -155370 -155362 ... 1.35672e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.553849386303e+05, best bound -1.553997749485e+05, gap 0.0095%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 138592.25
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -155384.94
  [DEBUG]   S×d_nominal = 293977.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 293977.19 + -155384.94 = 138592.25
  [DEBUG]   Current θ from Master = 155059.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16466.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3938.31
  Lower Bound (LB) = 16544.14
  Gap (UB-LB) = 3860.9718, Absolute Gap = 3860.9718, Relative Gap = 0.189216
  Not converged yet (gap = 3860.97 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0x29d8182d
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 3938.31 (0.04s)
MIP start from previous solve produced solution with objective 3938.31 (0.05s)
Loaded MIP start from previous solve with objective 3938.31

Presolve removed 25452 rows and 10332 columns
Presolve time: 2.41s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41684    2.8419085e+01   0.000000e+00   3.251398e+06      5s
   54350    3.7347125e+04   0.000000e+00   4.310408e+07     10s
Concurrent spin time: 2.43s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.295128e+04, 24519 iterations, 12.54 seconds (16.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42951.2842    0  168 3938.31120 42951.2842   991%     -   15s
H    0     0                    16538.147069 42951.2842   160%     -   15s
H    0     0                    19942.790436 42951.2842   115%     -   15s
     0     0 38847.7656    0  222 19942.7904 38847.7656  94.8%     -   20s
     0     0 37428.3561    0  239 19942.7904 37428.3561  87.7%     -   24s
     0     0 37428.3561    0  234 19942.7904 37428.3561  87.7%     -   25s
     0     0 37428.3561    0  231 19942.7904 37428.3561  87.7%     -   25s
     0     0 37428.3561    0  231 19942.7904 37428.3561  87.7%     -   26s
     0     0 34613.0067    0  255 19942.7904 34613.0067  73.6%     -   31s
     0     0 33785.0710    0  264 19942.7904 33785.0710  69.4%     -   34s
     0     0 33550.0656    0  273 19942.7904 33550.0656  68.2%     -   35s
     0     0 33463.4856    0  273 19942.7904 33463.4856  67.8%     -   36s
     0     0 33452.5057    0  294 19942.7904 33452.5057  67.7%     -   36s
     0     0 33444.0429    0  289 19942.7904 33444.0429  67.7%     -   37s
     0     0 33443.7357    0  293 19942.7904 33443.7357  67.7%     -   37s
     0     0 31538.0147    0  294 19942.7904 31538.0147  58.1%     -   45s
     0     0 31238.3243    0  312 19942.7904 31238.3243  56.6%     -   48s
     0     0 31114.5903    0  309 19942.7904 31114.5903  56.0%     -   49s
     0     0 31101.3331    0  312 19942.7904 31101.3331  56.0%     -   50s
     0     0 31086.4321    0  301 19942.7904 31086.4321  55.9%     -   50s
     0     0 31082.1025    0  313 19942.7904 31082.1025  55.9%     -   51s
     0     0 31076.3686    0  312 19942.7904 31076.3686  55.8%     -   51s
     0     0 31074.7679    0  316 19942.7904 31074.7679  55.8%     -   52s
     0     0 31074.1614    0  318 19942.7904 31074.1614  55.8%     -   52s
     0     0 30759.0799    0  328 19942.7904 30759.0799  54.2%     -   57s
     0     0 30518.5087    0  325 19942.7904 30518.5087  53.0%     -   60s
     0     0 30405.4623    0  335 19942.7904 30405.4623  52.5%     -   62s
     0     0 30335.5413    0  318 19942.7904 30335.5413  52.1%     -   63s
     0     0 30310.0073    0  330 19942.7904 30310.0073  52.0%     -   63s
H    0     0                    20006.380836 30283.7677  51.4%     -   64s
     0     0 30283.7677    0  342 20006.3808 30283.7677  51.4%     -   64s
     0     0 30281.2075    0  343 20006.3808 30281.2075  51.4%     -   64s
     0     0 30279.5911    0  344 20006.3808 30279.5911  51.3%     -   64s
     0     0 30278.2090    0  348 20006.3808 30278.2090  51.3%     -   65s
     0     0 30183.7374    0  333 20006.3808 30183.7374  50.9%     -   66s
     0     0 30140.0260    0  329 20006.3808 30140.0260  50.7%     -   67s
     0     0 30134.8009    0  334 20006.3808 30134.8009  50.6%     -   67s
     0     0 30080.2150    0  342 20006.3808 30080.2150  50.4%     -   68s
     0     0 30073.5675    0  343 20006.3808 30073.5675  50.3%     -   68s
     0     0 30071.7875    0  346 20006.3808 30071.7875  50.3%     -   68s
     0     0 30070.1585    0  336 20006.3808 30070.1585  50.3%     -   68s
     0     0 30069.0873    0  342 20006.3808 30069.0873  50.3%     -   68s
     0     0 30053.7693    0  339 20006.3808 30053.7693  50.2%     -   69s
H    0     0                    20011.350423 30053.7605  50.2%     -   70s
     0     0 30046.9400    0  345 20011.3504 30046.9400  50.1%     -   70s
     0     0 30044.1622    0  344 20011.3504 30044.1622  50.1%     -   70s
     0     0 30043.0843    0  347 20011.3504 30043.0843  50.1%     -   70s
     0     0 30032.9824    0  350 20011.3504 30032.9824  50.1%     -   71s
     0     0 30030.9676    0  354 20011.3504 30030.9676  50.1%     -   72s
     0     0 30030.0274    0  353 20011.3504 30030.0274  50.1%     -   72s
     0     0 29999.0866    0  350 20011.3504 29999.0866  49.9%     -   73s
     0     0 29998.0511    0  352 20011.3504 29998.0511  49.9%     -   73s
     0     0 29995.3939    0  345 20011.3504 29995.3939  49.9%     -   74s
     0     0 29994.7581    0  353 20011.3504 29994.7581  49.9%     -   75s
     0     0 29992.7784    0  351 20011.3504 29992.7784  49.9%     -   75s
H    0     0                    20018.226295 29992.7103  49.8%     -   75s
     0     0 29990.7269    0  355 20018.2263 29990.7269  49.8%     -   76s
     0     0 29990.4379    0  354 20018.2263 29990.4379  49.8%     -   76s
     0     0 29990.0416    0  354 20018.2263 29990.0416  49.8%     -   76s
     0     0 29989.8035    0  354 20018.2263 29989.8035  49.8%     -   77s
     0     2 29989.7945    0  354 20018.2263 29989.7945  49.8%     -   86s
     3     8 29677.5503    2  326 20018.2263 29831.2834  49.0%  2153   91s
     7    16 29264.5137    3  337 20018.2263 29670.8731  48.2%  2224   95s
    15    32 29083.0175    4  343 20018.2263 29264.5071  46.2%  3246  101s
    31    64 28835.4971    5  391 20018.2263 29103.1724  45.4%  4394  108s
H   34    64                    20027.580876 29103.1724  45.3%  4223  108s
    63    93 28330.1335    6  335 20027.5809 28835.3372  44.0%  4431  118s
    92   195 27589.2161    7  323 20027.5809 28835.3372  44.0%  4671  124s
   196   254 27388.1036    8  277 20027.5809 28835.3372  44.0%  2746  128s
   255   315 27411.8736    8  303 20027.5809 28835.3372  44.0%  2774  133s
   319   367 27243.1916    9  253 20027.5809 28835.3372  44.0%  2713  138s
   391   423 27246.4718    9  308 20027.5809 28835.1303  44.0%  2627  147s
   464   458 26974.4281   10  243 20027.5809 28562.9081  42.6%  2584  151s
   538   494 25587.8448   10  244 20027.5809 28562.9081  42.6%  2568  155s
   592   521 26431.5354   10  222 20027.5809 28562.9081  42.6%  2594  160s
   627   550 24979.8213   10  251 20027.5809 28562.9081  42.6%  2676  165s
   676   580 26339.5105   10  292 20027.5809 28562.9081  42.6%  2695  170s
   766   655 25974.8599   11  220 20027.5809 28277.3542  41.2%  2754  178s
   811   695 25550.7265   11  219 20027.5809 28277.3542  41.2%  2760  181s
   861   750 25489.6798   12  218 20027.5809 28277.3542  41.2%  2720  185s
   993   821 23468.9679   13  216 20027.5809 28277.3542  41.2%  2615  197s
  1054   867 22731.3874   13  225 20027.5809 27938.1324  39.5%  2584  203s
  1122   922 22997.2380   13  223 20027.5809 27938.1324  39.5%  2565  207s
  1187   968 22375.1031   13  209 20027.5809 27938.1324  39.5%  2540  212s
  1259  1015 23031.1781   14  214 20027.5809 27938.1324  39.5%  2525  218s
  1326  1069 21620.0131   14  266 20027.5809 27938.1324  39.5%  2533  222s
  1414  1103 22610.0638   15  202 20027.5809 27938.1324  39.5%  2483  228s
  1512  1159 21483.6912   16  243 20027.5809 27938.1324  39.5%  2449  233s
  1602  1219     cutoff   16      20027.5809 27730.5598  38.5%  2427  239s
  1708  1281 20817.9079   17  228 20027.5809 27730.5598  38.5%  2407  245s
  1800  1349 21157.4242   17  260 20027.5809 27635.6576  38.0%  2408  251s
  1938  1388 20444.8837   19  210 20027.5809 27617.3500  37.9%  2371  257s
  2017  1438 20231.9551   22  254 20027.5809 27617.3500  37.9%  2351  266s
  2145  1460 25768.1943    8  251 20027.5809 27503.9384  37.3%  2331  273s
H 2176  1460                    20091.900382 27503.9384  36.9%  2335  273s
  2199  1534 25345.4053    8  251 20091.9004 27444.4818  36.6%  2338  281s
  2335  1616 24650.8511    9  259 20091.9004 27383.1564  36.3%  2336  289s
  2512  1703 21446.6252   10  243 20091.9004 27383.1564  36.3%  2293  296s
  2679  1752 21317.4043   11  229 20091.9004 27354.2970  36.1%  2253  304s
  2842  1831 infeasible   14      20091.9004 27316.9376  36.0%  2243  313s
  3014  1950 25785.9958    7  287 20091.9004 27316.9376  36.0%  2236  321s
  3172  2054 24236.7603   10  275 20091.9004 27316.9376  36.0%  2229  329s
  3393  2148 23443.2157   13  204 20091.9004 27293.7336  35.8%  2192  338s
  3611  2246 21925.7764   20  162 20091.9004 27245.5373  35.6%  2164  345s
  3808  2304 20850.6183   25  157 20091.9004 27245.5373  35.6%  2153  354s
  3989  2401 22273.3036   12  302 20091.9004 27200.7142  35.4%  2146  363s
  4220  2487 21023.3849   15  305 20091.9004 27200.7142  35.4%  2114  373s
  4427  2579 25452.0462   12  276 20091.9004 27200.7142  35.4%  2096  385s
  4667  2669 24550.8858   14  230 20091.9004 26961.6706  34.2%  2073  398s
  4911  2739 21661.8625   18  174 20091.9004 26911.2666  33.9%  2064  409s
  5153  2820 25181.5024   12  287 20091.9004 26758.4163  33.2%  2068  421s
  5422  2890 21985.9090   17  246 20091.9004 26758.4163  33.2%  2065  431s
  5695  2923     cutoff   20      20091.9004 26758.4163  33.2%  2062  442s
  5970  3044     cutoff   21      20091.9004 26758.4163  33.2%  2048  455s
  6265  3045 20507.7407   24  354 20091.9004 26758.4163  33.2%  2042  474s
  6267  3046 20909.1372   24  168 20091.9004 26758.4163  33.2%  2041  487s
  6268  3047 22005.3944   14  245 20091.9004 26758.4163  33.2%  2041  496s
  6269  3048 23816.8571   16  328 20091.9004 26758.4163  33.2%  2040  502s
  6270  3048 21856.6741   19  304 20091.9004 26758.4163  33.2%  2040  507s
  6271  3049 23049.1427   24  319 20091.9004 26758.4163  33.2%  2040  510s
  6276  3052 23375.1964   19  344 20091.9004 26758.4163  33.2%  2038  515s
  6279  3054 25214.2247   11  374 20091.9004 26758.4163  33.2%  2037  520s
  6282  3056 24652.6086   12  350 20091.9004 26758.4163  33.2%  2036  525s
  6285  3058 20843.0740   16  346 20091.9004 26758.4163  33.2%  2035  533s
  6287  3060 22045.6471   19  349 20091.9004 26758.4163  33.2%  2035  537s
  6289  3061 21913.8376   30  346 20091.9004 26758.4163  33.2%  2034  540s
  6293  3064 26101.6284   11  345 20091.9004 26758.4163  33.2%  2033  546s
  6294  3064 23889.5465   11  345 20091.9004 26758.4163  33.2%  2032  561s
  6295  3065 21300.6781   31  345 20091.9004 26758.4163  33.2%  2032  571s
  6296  3069 26758.4163   14  329 20091.9004 26758.4163  33.2%  2043  578s
  6298  3072 26758.4163   15  319 20091.9004 26758.4163  33.2%  2043  585s
  6302  3079 26758.4163   16  330 20091.9004 26758.4163  33.2%  2044  593s
  6310  3092 26758.4163   17  347 20091.9004 26758.4163  33.2%  2047  600s
  6326  3116 26758.4163   18  344 20091.9004 26758.4163  33.2%  2058  612s
  6356  3138 26758.4163   19  383 20091.9004 26758.4163  33.2%  2084  618s
  6388  3195 26758.4163   20  326 20091.9004 26758.4163  33.2%  2092  626s
  6468  3203 26544.8610   21  334 20091.9004 26758.4163  33.2%  2092  634s
  6542  3209 26682.4919   21  328 20091.9004 26758.4163  33.2%  2101  640s
  6608  3227 25335.8460   22  325 20091.9004 26758.4163  33.2%  2102  645s
  6684  3235 25182.5144   23  308 20091.9004 26758.4163  33.2%  2103  654s
  6746  3241 25054.9107   24  291 20091.9004 26758.4163  33.2%  2108  661s
  6826  3247 25026.7739   25  266 20091.9004 26758.4163  33.2%  2107  669s
  6883  3252 24443.1414   26  250 20091.9004 26758.4163  33.2%  2113  676s
  6952  3255 22252.6513   26  193 20091.9004 26758.4163  33.2%  2118  688s
  7017  3255 23937.8080   27  252 20091.9004 26758.4163  33.2%  2117  693s
  7078  3252 22037.4891   27  267 20091.9004 26681.7236  32.8%  2124  700s
  7145  3266 23062.5128   28  209 20091.9004 26681.7236  32.8%  2127  706s
  7212  3272     cutoff   28      20091.9004 26681.7236  32.8%  2126  711s
  7279  3265 21880.7577   29  180 20091.9004 26681.7236  32.8%  2126  721s
  7352  3254 21458.2198   29  263 20091.9004 26133.0039  30.1%  2130  728s
  7419  3252 20824.3765   30  154 20091.9004 26133.0039  30.1%  2133  735s
  7510  3253     cutoff   31      20091.9004 25992.9071  29.4%  2132  742s
  7602  3227     cutoff   31      20091.9004 25793.5669  28.4%  2130  750s
  7705  3205 22438.5904   23  307 20091.9004 25702.9831  27.9%  2132  758s
  7769  3214 22326.5286   24  291 20091.9004 25702.9831  27.9%  2133  766s
  7853  3202 21978.4039   25  275 20091.9004 25444.9909  26.6%  2131  772s
  7902  3214 21949.5726   26  285 20091.9004 25444.9909  26.6%  2129  782s
  7984  3193 21484.4858   27  211 20091.9004 25444.9909  26.6%  2126  791s
  8123  3154     cutoff   30      20091.9004 25433.4992  26.6%  2116  799s
  8239  3146 23318.9273   20  198 20091.9004 25096.6661  24.9%  2119  810s
  8373  3104 infeasible   23      20091.9004 25041.3380  24.6%  2117  823s
  8519  3070 20339.3835   26  147 20091.9004 24920.2871  24.0%  2118  834s
  8679  3060 21584.0138   24  325 20091.9004 24769.7199  23.3%  2115  842s
  8824  3017 20468.8904   27  226 20091.9004 24769.7199  23.3%  2112  850s
  8874  2988     cutoff   28      20091.9004 24769.7199  23.3%  2110  858s
  8947  2953     cutoff   29      20091.9004 24769.7199  23.3%  2107  867s
  9010  2937     cutoff   26      20091.9004 24769.7199  23.3%  2108  877s
  9078  2931 22581.2866   22  232 20091.9004 24769.7199  23.3%  2106  886s
  9189  2881 22196.5103   23  245 20091.9004 24769.7199  23.3%  2100  897s
  9365  2838     cutoff   27      20091.9004 24769.7199  23.3%  2094  908s
  9584  2761 21700.5681   24  285 20091.9004 24095.0248  19.9%  2090  919s
  9819  2694 23480.2758   25  362 20091.9004 24064.1129  19.8%  2089  927s
  9866  2674 22906.7187   26  282 20091.9004 24064.1129  19.8%  2089  936s
  9933  2661 21237.7902   27  266 20091.9004 24064.1129  19.8%  2086  947s
 10026  2610 20891.5117   28  159 20091.9004 24064.1129  19.8%  2080  959s
 10196  2535     cutoff   30      20091.9004 24064.1129  19.8%  2072  971s
 10479  2396 21358.5021   28  220 20091.9004 23479.6890  16.9%  2062  984s
 10815  2247     cutoff   36      20091.9004 23194.1184  15.4%  2054  996s
 11179  2024 20850.5444   27  214 20091.9004 22965.0030  14.3%  2038 1008s
 11540  1747 20393.9794   25  272 20091.9004 22818.6178  13.6%  2020 1020s
 12000  1300 20923.3061   26  225 20091.9004 22373.5989  11.4%  1993 1031s
 12525   993     cutoff   25      20091.9004 21737.6573  8.19%  1952 1037s

Cutting planes:
  MIR: 301
  Mixing: 1
  Flow cover: 479
  RLT: 11
  Relax-and-lift: 60

Explored 12836 nodes (24643945 simplex iterations) in 1037.66 seconds (2009.63 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: 20091.9 20027.6 20018.2 ... 3938.31

Optimal solution found (tolerance 1.00e-04)
Best objective 2.009190038161e+04, best bound 2.009190038161e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1037.68s
  Master Objective (UB) = 20091.90, θ = 155423.40
  Upper Bound (UB) = 20091.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155423.40
  [DEBUG]   ✓ Scenario 0: θ = 155423.40 ≤ Q = 155423.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155423.40 ≤ Q = 155423.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155423.40 ≤ Q = 155423.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 155423.40 ≤ Q = 155423.40 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xdf3d441
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0df3d441
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347384e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6779365.1884
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.746012e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174601.17    0  131 6779365.19 -174601.17   103%     -    0s
H    0     0                    -138764.7964 -174601.17  25.8%     -    0s
H    0     0                    -138963.6682 -174601.17  25.6%     -    0s
     0     0 -149233.22    0   67 -138963.67 -149233.22  7.39%     -    0s
H    0     0                    -146819.2783 -149219.46  1.63%     -    0s
H    0     0                    -147094.6025 -149219.46  1.44%     -    0s
H    0     0                    -147582.7250 -149219.46  1.11%     -    0s
H    0     0                    -147858.0492 -149219.46  0.92%     -    0s
     0     0 -149159.37    0   65 -147858.05 -149159.37  0.88%     -    0s
     0     0 -149159.37    0   65 -147858.05 -149159.37  0.88%     -    0s
     0     0 -148878.50    0   44 -147858.05 -148878.50  0.69%     -    0s
     0     0 -148851.17    0   44 -147858.05 -148851.17  0.67%     -    0s
     0     0 -148820.82    0    8 -147858.05 -148820.82  0.65%     -    0s
H    0     0                    -147957.6638 -148814.79  0.58%     -    0s
H    0     0                    -148485.5721 -148814.79  0.22%     -    0s
H    0     0                    -148609.0419 -148814.79  0.14%     -    0s
     0     0 -148814.79    0    6 -148609.04 -148814.79  0.14%     -    0s
     0     0 -148812.28    0    6 -148609.04 -148812.28  0.14%     -    0s
H    0     0                    -148810.7916 -148812.28  0.00%     -    0s

Cutting planes:
  Gomory: 24
  MIR: 125
  Flow cover: 18
  RLT: 34

Explored 1 nodes (510 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -148811 -148486 -147958 ... 1.34738e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.488107916209e+05, best bound -1.488122756555e+05, gap 0.0010%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 145673.99
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148810.79
  [DEBUG]   S×d_nominal = 294484.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294484.78 + -148810.79 = 145673.99
  [DEBUG]   Current θ from Master = 155423.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9749.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10342.49
  Lower Bound (LB) = 16544.14
  Gap (UB-LB) = 3547.7647, Absolute Gap = 3547.7647, Relative Gap = 0.176577
  Not converged yet (gap = 3547.76 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0xcbae053c
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 1.30s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356030.4446
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26588   -1.1779162e+04   0.000000e+00   1.760225e+06      5s
   38800    3.3504751e+04   0.000000e+00   1.013129e+07     10s
Concurrent spin time: 0.84s

Solved with dual simplex

Root relaxation: objective 4.273799e+04, 27446 iterations, 12.10 seconds (16.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42737.9929    0  179 -203357.92 42737.9929   121%     -   14s
H    0     0                    -198351.2617 42737.9929   122%     -   14s
H    0     0                    -170864.2477 42737.9929   125%     -   14s
H    0     0                    -81407.70130 42737.9929   152%     -   14s
H    0     0                    -58001.05898 42737.9929   174%     -   14s
H    0     0                    -57971.11521 42737.9929   174%     -   14s
H    0     0                    -57430.68961 42737.9929   174%     -   14s
H    0     0                    -56875.95986 42737.9929   175%     -   14s
H    0     0                    -26317.14241 42737.9929   262%     -   14s
H    0     0                    13849.386330 42737.9929   209%     -   14s
H    0     0                    14273.730756 42737.9929   199%     -   14s
H    0     0                    14293.503271 42737.9929   199%     -   14s
H    0     0                    14347.012817 42737.9929   198%     -   14s
     0     0 39062.4227    0  123 14347.0128 39062.4227   172%     -   19s
H    0     0                    14362.562268 39060.5886   172%     -   20s
     0     0 37373.0749    0  132 14362.5623 37373.0749   160%     -   25s
     0     0 36986.6600    0  180 14362.5623 36986.6600   158%     -   26s
     0     0 36986.6600    0  209 14362.5623 36986.6600   158%     -   27s
     0     0 36986.6600    0  141 14362.5623 36986.6600   158%     -   28s
     0     0 36986.6600    0  146 14362.5623 36986.6600   158%     -   28s
     0     0 36986.6600    0  151 14362.5623 36986.6600   158%     -   28s
H    0     0                    14379.290317 36986.6600   157%     -   28s
     0     0 36986.6600    0  151 14379.2903 36986.6600   157%     -   29s
     0     0 34455.1321    0  262 14379.2903 34455.1321   140%     -   36s
H    0     0                    14389.526974 34455.0952   139%     -   36s
     0     0 33987.5249    0  249 14389.5270 33987.5249   136%     -   39s
     0     0 33819.4902    0  257 14389.5270 33819.4902   135%     -   41s
     0     0 33816.4943    0  259 14389.5270 33816.4943   135%     -   41s
     0     0 33735.9468    0  246 14389.5270 33735.9468   134%     -   42s
     0     0 33721.0517    0  242 14389.5270 33721.0517   134%     -   43s
     0     0 33719.9622    0  253 14389.5270 33719.9622   134%     -   43s
     0     0 33719.5253    0  251 14389.5270 33719.5253   134%     -   43s
     0     0 32054.6846    0  294 14389.5270 32054.6846   123%     -   50s
     0     0 31624.5222    0  315 14389.5270 31624.5222   120%     -   54s
     0     0 31485.7234    0  325 14389.5270 31485.7234   119%     -   56s
     0     0 31425.6522    0  322 14389.5270 31425.6522   118%     -   58s
     0     0 31390.1203    0  324 14389.5270 31390.1203   118%     -   58s
     0     0 31312.4118    0  324 14389.5270 31312.4118   118%     -   59s
     0     0 31301.1722    0  325 14389.5270 31301.1722   118%     -   60s
     0     0 31298.3305    0  322 14389.5270 31298.3305   118%     -   60s
     0     0 31297.3572    0  323 14389.5270 31297.3572   118%     -   60s
     0     0 30670.3665    0  340 14389.5270 30670.3665   113%     -   67s
     0     0 30525.8376    0  347 14389.5270 30525.8376   112%     -   69s
H    0     0                    14843.005658 30448.1184   105%     -   71s
     0     0 30448.1184    0  355 14843.0057 30448.1184   105%     -   71s
H    0     0                    15689.952205 30412.3588  93.8%     -   72s
H    0     0                    15898.497341 30412.3588  91.3%     -   72s
     0     0 30412.3588    0  355 15898.4973 30412.3588  91.3%     -   72s
     0     0 30393.1988    0  350 15898.4973 30393.1988  91.2%     -   73s
     0     0 30377.0846    0  359 15898.4973 30377.0846  91.1%     -   74s
     0     0 30373.3233    0  358 15898.4973 30373.3233  91.0%     -   74s
     0     0 30370.9767    0  356 15898.4973 30370.9767  91.0%     -   75s
     0     0 30370.0215    0  355 15898.4973 30370.0215  91.0%     -   75s
H    0     0                    15989.545244 30245.0497  89.2%     -   78s
     0     0 30245.0497    0  347 15989.5452 30245.0497  89.2%     -   80s
     0     0 30195.8221    0  355 15989.5452 30195.8221  88.8%     -   83s
     0     0 30178.0477    0  365 15989.5452 30178.0477  88.7%     -   85s
     0     0 30173.1002    0  365 15989.5452 30173.1002  88.7%     -   86s
     0     0 30161.1793    0  363 15989.5452 30161.1793  88.6%     -   87s
     0     0 30158.5390    0  365 15989.5452 30158.5390  88.6%     -   87s
     0     0 30158.4922    0  365 15989.5452 30158.4922  88.6%     -   87s
     0     0 30051.7782    0  341 15989.5452 30051.7782  87.9%     -   90s
H    0     0                    16018.051546 30051.3855  87.6%     -   91s
H    0     0                    16024.210677 30051.3855  87.5%     -   91s
H    0     0                    16095.737404 30051.3855  86.7%     -   92s
H    0     0                    16097.643688 30051.3855  86.7%     -   92s
H    0     0                    16102.613275 30051.3855  86.6%     -   92s
H    0     0                    16105.091984 30051.3855  86.6%     -   92s
H    0     0                    16279.628295 30031.3839  84.5%     -   94s
     0     0 30031.3839    0  353 16279.6283 30031.3839  84.5%     -   94s
     0     0 30025.7256    0  348 16279.6283 30025.7256  84.4%     -   94s
     0     0 30024.5387    0  353 16279.6283 30024.5387  84.4%     -   94s
     0     0 30005.3612    0  358 16279.6283 30005.3612  84.3%     -   96s
H    0     0                    16337.338175 30005.1224  83.7%     -   96s
H    0     0                    16354.074586 30005.1224  83.5%     -   96s
H    0     0                    16444.439518 30005.1224  82.5%     -   96s
     0     0 29999.8422    0  357 16444.4395 29999.8422  82.4%     -   96s
     0     0 29995.5158    0  365 16444.4395 29995.5158  82.4%     -   97s
     0     0 29994.1541    0  370 16444.4395 29994.1541  82.4%     -   97s
     0     0 29981.2403    0  363 16444.4395 29981.2403  82.3%     -   98s
H    0     0                    16445.245313 29980.6088  82.3%     -   99s
H    0     0                    16453.794099 29980.6088  82.2%     -   99s
     0     0 29978.5572    0  365 16453.7941 29978.5572  82.2%     -   99s
     0     0 29977.7609    0  368 16453.7941 29977.7609  82.2%     -  100s
     0     0 29970.9912    0  370 16453.7941 29970.9912  82.2%     -  101s
     0     0 29969.1294    0  372 16453.7941 29969.1294  82.1%     -  101s
     0     0 29967.9968    0  375 16453.7941 29967.9968  82.1%     -  102s
     0     0 29962.6588    0  373 16453.7941 29962.6588  82.1%     -  103s
     0     0 29956.6312    0  361 16453.7941 29956.6312  82.1%     -  103s
     0     0 29954.3507    0  375 16453.7941 29954.3507  82.1%     -  104s
     0     0 29953.5544    0  372 16453.7941 29953.5544  82.0%     -  104s
     0     0 29948.6975    0  366 16453.7941 29948.6975  82.0%     -  105s
     0     0 29948.6433    0  366 16453.7941 29948.6433  82.0%     -  106s
H    0     0                    16583.907742 29948.2696  80.6%     -  113s
H    0     0                    16608.218357 29948.2696  80.3%     -  114s
H    0     0                    16609.407901 29948.2696  80.3%     -  114s
     0     2 29948.2696    0  366 16609.4079 29948.2696  80.3%     -  123s
     1     4 29659.0919    1  345 16609.4079 29948.2696  80.3%  2493  127s
     3     8 29600.8551    2  347 16609.4079 29659.0396  78.6%  2995  132s
     7    16 29406.5651    3  352 16609.4079 29600.8236  78.2%  3702  136s
    15    32 29362.4369    4  354 16609.4079 29406.5492  77.0%  3641  143s
    31    54 26660.7224    5  330 16609.4079 29361.2442  76.8%  5634  156s
    53    86 27144.5034    6  319 16609.4079 29361.2442  76.8%  5325  167s
    85   122 26929.6309    7  307 16609.4079 29361.2442  76.8%  4683  176s
   121   154 26873.4288    8  309 16609.4079 29361.2442  76.8%  4435  183s
H  137   154                    16642.061862 29361.2442  76.4%  4087  183s
H  139   154                    16727.927071 29361.2442  75.5%  4069  183s
H  140   154                    18056.980026 29361.2442  62.6%  4073  183s
   153   281 26710.6028    9  297 18056.9800 29361.2442  62.6%  3836  191s
H  215   281                    18177.053913 29361.2442  61.5%  3071  191s
H  279   281                    18894.602457 29361.2442  55.4%  2580  191s
   280   370 26674.3493   12  279 18894.6025 29361.2442  55.4%  2575  201s
   369   477 26366.5826   13  274 18894.6025 29361.2442  55.4%  2285  208s
   476   594 25800.4761   12  301 18894.6025 29361.2442  55.4%  2080  217s
   595   701 26498.0803   14  262 18894.6025 29361.2442  55.4%  1844  225s
   708   806 26566.3530   16  279 18894.6025 29361.2442  55.4%  1708  232s
   815   908 26215.5164   18  262 18894.6025 29361.2442  55.4%  1602  239s
   927   992 26030.8469   18  285 18894.6025 29361.2442  55.4%  1514  248s
  1039  1042 26194.5840   19  257 18894.6025 29140.3498  54.2%  1445  257s
  1143  1109 25869.8482   23  257 18894.6025 29140.3498  54.2%  1434  265s
  1236  1155 25370.7669   21  258 18894.6025 28895.1865  52.9%  1430  273s
  1344  1201 25845.3090   24  243 18894.6025 28892.6984  52.9%  1415  282s
  1410  1268 21919.9683   24  232 18894.6025 28892.6984  52.9%  1436  291s
  1499  1339 24546.1284   25  234 18894.6025 28892.6984  52.9%  1448  298s
  1588  1403 21658.1083   25  181 18894.6025 28892.6984  52.9%  1456  306s
  1699  1497 21760.3084   25  178 18894.6025 28892.6984  52.9%  1452  313s
H 1821  1562                    18919.383680 28880.7853  52.7%  1439  324s
H 1825  1562                    19695.015562 28880.7853  46.6%  1440  324s
H 1913  1562                    19772.348089 28438.5305  43.8%  1425  324s
  1918  1650 22702.7587   28  205 19772.3481 28438.5305  43.8%  1429  333s
H 2050  1677                    19779.442149 28438.5305  43.8%  1417  337s
H 2063  1677                    19781.702669 28438.5305  43.8%  1413  337s
H 2088  1677                    19788.796729 28438.5305  43.7%  1412  337s
  2089  1760 22015.1955   31  217 19788.7967 28438.5305  43.7%  1412  347s
  2260  1846 21508.5373   34  184 19788.7967 28438.5305  43.7%  1390  358s
  2419  1952 20936.6000   41  155 19788.7967 28438.5305  43.7%  1379  369s
  2635  2105 22621.9450    8  213 19788.7967 28223.8108  42.6%  1334  378s
  2835  2170 21682.0093   10  151 19788.7967 27952.3243  41.3%  1307  390s
  3026  2215 26949.4505    9  292 19788.7967 27952.3243  41.3%  1297  402s
  3129  2296 26585.1735   10  287 19788.7967 27952.3243  41.3%  1309  413s
  3278  2412 25804.6224   13  270 19788.7967 27750.3225  40.2%  1309  424s
  3308  2412 20139.7823   22  227 19788.7967 27750.3225  40.2%  1313  425s
  3456  2533 25164.2599   17  196 19788.7967 27750.3225  40.2%  1302  435s
  3673  2659 23890.5214   20  293 19788.7967 27750.3225  40.2%  1289  448s
  3912  2778 21237.4714   27  198 19788.7967 27750.3225  40.2%  1276  460s
  4170  2809     cutoff   34      19788.7967 27676.6818  39.9%  1261  473s
  4373  2887     cutoff   12      19788.7967 27384.0073  38.4%  1261  484s
  4543  2956 24562.9425   17  256 19788.7967 27384.0073  38.4%  1271  494s
  4805  2987 24340.6716   18  174 19788.7967 27144.3291  37.2%  1266  506s
  4991  3040 23417.5866   20  224 19788.7967 27128.8030  37.1%  1281  521s
  5182  3113 21031.0582   27  169 19788.7967 27030.0942  36.6%  1292  535s
  5394  3155     cutoff   33      19788.7967 26911.1932  36.0%  1304  548s
  5564  3231     cutoff    9      19788.7967 26704.1109  34.9%  1316  562s
  5808  3311     cutoff   16      19788.7967 26636.7086  34.6%  1326  576s
  6005  3312 22403.9321   53  366 19788.7967 26581.0305  34.3%  1342  606s
  6007  3313 24344.9277   15  179 19788.7967 26581.0305  34.3%  1342  621s
  6008  3314 20988.0209   24  262 19788.7967 26581.0305  34.3%  1342  635s
  6009  3315 25842.4021   17  310 19788.7967 26581.0305  34.3%  1341  642s
  6010  3315 24189.2569   20  340 19788.7967 26581.0305  34.3%  1341  647s
  6011  3316 24809.7813   26  353 19788.7967 26581.0305  34.3%  1341  650s
  6013  3317 24279.6273   35  362 19788.7967 26581.0305  34.3%  1341  655s
  6018  3321 26230.6201   12  358 19788.7967 26581.0305  34.3%  1339  660s
  6020  3322 23834.7870   28  359 19788.7967 26581.0305  34.3%  1339  666s
  6023  3324 21469.9152   16  367 19788.7967 26581.0305  34.3%  1338  673s
  6025  3325 22083.5041   13  353 19788.7967 26581.0305  34.3%  1338  676s
  6028  3327 24160.7693   20  363 19788.7967 26581.0305  34.3%  1337  680s
  6030  3329 23573.2144   12  365 19788.7967 26581.0305  34.3%  1337  685s
  6032  3330 23073.9984   55  361 19788.7967 26581.0305  34.3%  1336  691s
  6034  3331 24297.2446   20  377 19788.7967 26581.0305  34.3%  1336  695s
  6036  3333 20996.2736   40  413 19788.7967 26581.0305  34.3%  1335  701s
  6038  3334 23097.8245   13  374 19788.7967 26581.0305  34.3%  1335  717s
  6039  3335 21816.5648   35  374 19788.7967 26581.0305  34.3%  1335  734s
  6040  3338 26581.0305   12  365 19788.7967 26581.0305  34.3%  1351  745s
  6042  3342 26581.0305   13  359 19788.7967 26581.0305  34.3%  1352  753s
  6046  3348 26581.0305   14  345 19788.7967 26581.0305  34.3%  1353  764s
  6054  3362 26581.0305   15  358 19788.7967 26581.0305  34.3%  1357  774s
  6070  3372 26581.0305   16  254 19788.7967 26581.0305  34.3%  1382  789s
  6088  3397 26581.0305   17  293 19788.7967 26581.0305  34.3%  1389  799s
  6120  3410 21557.3246   18  252 19788.7967 26581.0305  34.3%  1412  814s
  6185  3430 20138.4445   19  264 19788.7967 26581.0305  34.3%  1438  829s
  6275  3437 20542.9813   18  183 19788.7967 26581.0305  34.3%  1480  838s
  6356  3432 19928.4603   22   76 19788.7967 26581.0305  34.3%  1505  847s
  6460  3415     cutoff   24      19788.7967 26581.0305  34.3%  1515  859s
  6534  3417 22839.1963   20  254 19788.7967 26581.0305  34.3%  1538  871s
  6588  3421 21622.6887   21  301 19788.7967 26581.0305  34.3%  1566  881s
  6644  3428 20588.0214   22  278 19788.7967 26581.0305  34.3%  1591  892s
  6707  3432 20321.0671   24  221 19788.7967 26581.0305  34.3%  1604  902s
  6765  3435     cutoff   26      19788.7967 26581.0305  34.3%  1614  910s
  6830  3432 23559.6180   19  316 19788.7967 26581.0305  34.3%  1627  920s
  6905  3418 21578.4326   21  251 19788.7967 26581.0305  34.3%  1636  931s
  7000  3397 20655.5548   23  223 19788.7967 26581.0305  34.3%  1645  941s
  7079  3380     cutoff   25      19788.7967 26581.0305  34.3%  1656  952s
  7158  3353     cutoff   24      19788.7967 26581.0305  34.3%  1660  965s
  7250  3354 23407.2887   22  334 19788.7967 25817.7765  30.5%  1674  975s
  7330  3331 19954.3288   24  327 19788.7967 25510.9713  28.9%  1688  984s
  7445  3292 21879.3653   25  246 19788.7967 25264.6192  27.7%  1693  996s
  7511  3270 20278.3959   26  193 19788.7967 25020.4794  26.4%  1709 1006s
  7599  3258 20013.4641   27  170 19788.7967 25020.4794  26.4%  1716 1016s
  7698  3229     cutoff   27      19788.7967 25020.4794  26.4%  1721 1030s
  7803  3195 22375.4296   21  235 19788.7967 24668.3273  24.7%  1727 1043s
  7933  3157 21663.5901   23  233 19788.7967 24389.3117  23.2%  1734 1055s
  8050  3114 20137.3920   27  215 19788.7967 24231.7936  22.5%  1749 1067s
  8178  3040 20882.1110   24  134 19788.7967 23810.0568  20.3%  1760 1082s
  8308  3010 21941.9976   22  247 19788.7967 23541.1751  19.0%  1769 1091s
  8475  2928     cutoff   25      19788.7967 23541.1751  19.0%  1768 1106s
  8662  2828 20293.7973   26  227 19788.7967 23357.6824  18.0%  1774 1119s
  8865  2743 20972.7337   21  296 19788.7967 23103.0459  16.7%  1774 1128s
  8946  2648 20959.6278   22  288 19788.7967 23103.0459  16.7%  1776 1140s
  9127  2513     cutoff   24      19788.7967 22843.2921  15.4%  1766 1153s
  9359  2294     cutoff   20      19788.7967 22287.5794  12.6%  1757 1165s
  9635  2140     cutoff   25      19788.7967 22283.2417  12.6%  1738 1173s

Cutting planes:
  MIR: 588
  Flow cover: 841
  RLT: 25
  Relax-and-lift: 93

Explored 9774 nodes (16964874 simplex iterations) in 1173.99 seconds (2211.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19788.8 19781.7 19779.4 ... 16727.9

Optimal solution found (tolerance 1.00e-04)
Best objective 1.978879672903e+04, best bound 1.978879672903e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1174.00s
  Master Objective (UB) = 19788.80, θ = 154610.63
  Upper Bound (UB) = 19788.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 154610.63
  [DEBUG]   ✓ Scenario 0: θ = 154610.63 ≤ Q = 154610.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 154610.63 ≤ Q = 154610.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 154610.63 ≤ Q = 154610.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 154610.63 ≤ Q = 154610.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 154610.63 ≤ Q = 154610.63 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1f50c2ac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1f50c2ac
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.367929e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6860806.2923
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.734509e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173450.92    0  126 6860806.29 -173450.92   103%     -    0s
H    0     0                    -135945.2955 -173450.92  27.6%     -    0s
H    0     0                    -136434.6702 -173450.92  27.1%     -    0s
     0     0 -145471.81    0  109 -136434.67 -145471.81  6.62%     -    0s
H    0     0                    -141085.8429 -145422.83  3.07%     -    0s
H    0     0                    -141362.1034 -145422.83  2.87%     -    0s
H    0     0                    -142198.2414 -145422.83  2.27%     -    0s
H    0     0                    -142474.5018 -145422.83  2.07%     -    0s
     0     0 -144822.75    0  107 -142474.50 -144822.75  1.65%     -    0s
H    0     0                    -143837.3527 -144816.37  0.68%     -    0s
     0     0 -144615.63    0   62 -143837.35 -144615.63  0.54%     -    0s
     0     0 -144596.21    0   62 -143837.35 -144596.21  0.53%     -    0s
     0     0 -144502.02    0   55 -143837.35 -144502.02  0.46%     -    0s
     0     0 -144472.96    0   64 -143837.35 -144472.96  0.44%     -    0s
     0     0 -144469.94    0   64 -143837.35 -144469.94  0.44%     -    0s
     0     0 -144322.79    0   50 -143837.35 -144322.79  0.34%     -    0s
     0     0 -144307.78    0   50 -143837.35 -144307.78  0.33%     -    0s
     0     2 -144306.25    0   50 -143837.35 -144306.25  0.33%     -    0s
H  152    69                    -143859.7809 -143987.41  0.09%   5.4    0s
*  162    69              18    -143881.0774 -143987.41  0.07%   5.2    0s

Cutting planes:
  Gomory: 39
  Implied bound: 2
  MIR: 173
  Flow cover: 9
  RLT: 13
  BQP: 4

Explored 303 nodes (1763 simplex iterations) in 0.36 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -143881 -143860 -143837 ... 1.36793e+13
No other solutions better than -143881

Optimal solution found (tolerance 1.00e-04)
Best objective -1.438810773985e+05, best bound -1.438810773985e+05, gap 0.0000%
  Subproblem solved in 0.39s
  Worst-case operational profit (Z_SP) = 150603.70
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143881.08
  [DEBUG]   S×d_nominal = 294484.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294484.78 + -143881.08 = 150603.70
  [DEBUG]   Current θ from Master = 154610.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4006.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15781.87
  Lower Bound (LB) = 16544.14
  Gap (UB-LB) = 3244.6611, Absolute Gap = 3244.6611, Relative Gap = 0.163965
  Not converged yet (gap = 3244.66 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0xae9aa965
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 1.43s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356030.4446
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21812   -9.8316435e+04   0.000000e+00   2.291774e+07      5s
   34605    9.2029765e+03   0.000000e+00   5.511837e+06     10s
   42363    2.5790367e+04   0.000000e+00   7.529433e+07     15s
   49188    3.3359317e+04   0.000000e+00   1.970747e+07     20s
Concurrent spin time: 4.31s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.273016e+04, 42684 iterations, 21.62 seconds (29.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42730.1591    0  178 -203357.92 42730.1591   121%     -   23s
H    0     0                    -198351.2617 42730.1591   122%     -   23s
H    0     0                    -44162.01498 42730.1591   197%     -   24s
H    0     0                    -38002.84711 42730.1591   212%     -   24s
H    0     0                    -26317.14241 42730.1591   262%     -   24s
H    0     0                    8319.4154584 42730.1591   414%     -   24s
H    0     0                    14135.302371 42730.1591   202%     -   24s
H    0     0                    14267.018428 42730.1591   200%     -   24s
H    0     0                    14320.527974 42730.1591   198%     -   24s
H    0     0                    14334.736105 42730.1591   198%     -   25s
     0     0 39709.7265    0  116 14334.7361 39709.7265   177%     -   32s
H    0     0                    14360.522214 39709.5986   177%     -   33s
H    0     0                    14390.825628 38218.6659   166%     -   37s
     0     0 38114.3715    0  228 14390.8256 38114.3715   165%     -   38s
     0     0 37866.8016    0  232 14390.8256 37866.8016   163%     -   41s
     0     0 37866.3371    0  233 14390.8256 37866.3371   163%     -   41s
     0     0 37866.3294    0  233 14390.8256 37866.3294   163%     -   42s
     0     0 34793.5905    0  261 14390.8256 34793.5905   142%     -   52s
     0     0 34410.5495    0  255 14390.8256 34410.5495   139%     -   56s
     0     0 34195.4048    0  257 14390.8256 34195.4048   138%     -   59s
     0     0 34120.6535    0  252 14390.8256 34120.6535   137%     -   61s
H    0     0                    14437.520872 34025.7435   136%     -   63s
H    0     0                    14440.838317 34025.7435   136%     -   63s
     0     0 34025.7435    0  256 14440.8383 34025.7435   136%     -   63s
     0     0 33932.8993    0  284 14440.8383 33932.8993   135%     -   64s
     0     0 33912.5192    0  276 14440.8383 33912.5192   135%     -   65s
     0     0 33911.5443    0  277 14440.8383 33911.5443   135%     -   66s
     0     0 33909.2027    0  280 14440.8383 33909.2027   135%     -   66s
     0     0 33908.9339    0  282 14440.8383 33908.9339   135%     -   66s
H    0     0                    14584.731791 32165.9748   121%     -   79s
H    0     0                    14608.848785 32165.9748   120%     -   79s
H    0     0                    14685.890736 32165.9748   119%     -   79s
     0     0 32165.9748    0  303 14685.8907 32165.9748   119%     -   79s
H    0     0                    14752.751178 32164.8310   118%     -   80s
     0     0 31881.9664    0  301 14752.7512 31881.9664   116%     -   83s
     0     0 31504.9914    0  318 14752.7512 31504.9914   114%     -   87s
     0     0 31352.2098    0  317 14752.7512 31352.2098   113%     -   89s
     0     0 31311.9780    0  306 14752.7512 31311.9780   112%     -   90s
     0     0 31281.8407    0  321 14752.7512 31281.8407   112%     -   92s
     0     0 31264.7025    0  320 14752.7512 31264.7025   112%     -   93s
     0     0 31243.6277    0  329 14752.7512 31243.6277   112%     -   93s
     0     0 31236.7350    0  323 14752.7512 31236.7350   112%     -   94s
     0     0 31233.8689    0  321 14752.7512 31233.8689   112%     -   95s
     0     0 31231.8218    0  324 14752.7512 31231.8218   112%     -   95s
     0     0 31227.0412    0  322 14752.7512 31227.0412   112%     -   95s
     0     0 31224.2444    0  320 14752.7512 31224.2444   112%     -   95s
     0     0 31222.3793    0  322 14752.7512 31222.3793   112%     -   96s
     0     0 31222.1621    0  324 14752.7512 31222.1621   112%     -   96s
H    0     0                    15427.776821 30626.7163  98.5%     -  104s
H    0     0                    15494.280648 30626.7163  97.7%     -  104s
H    0     0                    15669.163789 30626.7163  95.5%     -  104s
H    0     0                    15728.346986 30626.7163  94.7%     -  104s
H    0     0                    15982.588824 30626.7163  91.6%     -  104s
H    0     0                    16099.859727 30626.7163  90.2%     -  104s
H    0     0                    16103.198570 30626.7163  90.2%     -  104s
H    0     0                    16104.388114 30626.7163  90.2%     -  104s
     0     0 30626.7163    0  335 16104.3881 30626.7163  90.2%     -  105s
     0     0 30336.9054    0  332 16104.3881 30336.9054  88.4%     -  108s
     0     0 30230.2777    0  333 16104.3881 30230.2777  87.7%     -  111s
     0     0 30208.6573    0  331 16104.3881 30208.6573  87.6%     -  113s
     0     0 30201.8143    0  338 16104.3881 30201.8143  87.5%     -  114s
     0     0 30193.3496    0  339 16104.3881 30193.3496  87.5%     -  115s
     0     0 30186.3870    0  329 16104.3881 30186.3870  87.4%     -  115s
     0     0 30139.9914    0  332 16104.3881 30139.9914  87.2%     -  116s
     0     0 30133.6726    0  332 16104.3881 30133.6726  87.1%     -  117s
     0     0 30130.5263    0  335 16104.3881 30130.5263  87.1%     -  118s
     0     0 30126.5826    0  333 16104.3881 30126.5826  87.1%     -  118s
     0     0 30124.9111    0  332 16104.3881 30124.9111  87.1%     -  119s
     0     0 30124.4907    0  336 16104.3881 30124.4907  87.1%     -  119s
     0     0 30045.9071    0  336 16104.3881 30045.9071  86.6%     -  122s
     0     0 30015.7144    0  350 16104.3881 30015.7144  86.4%     -  124s
     0     0 30004.3841    0  357 16104.3881 30004.3841  86.3%     -  125s
     0     0 30001.3389    0  350 16104.3881 30001.3389  86.3%     -  126s
     0     0 30000.3023    0  352 16104.3881 30000.3023  86.3%     -  127s
     0     0 29979.0914    0  357 16104.3881 29979.0914  86.2%     -  128s
     0     0 29972.8781    0  343 16104.3881 29972.8781  86.1%     -  129s
     0     0 29969.1351    0  345 16104.3881 29969.1351  86.1%     -  130s
     0     0 29968.5501    0  348 16104.3881 29968.5501  86.1%     -  131s
H    0     0                    16107.583564 29960.5360  86.0%     -  132s
     0     0 29960.5360    0  349 16107.5836 29960.5360  86.0%     -  133s
     0     0 29954.6154    0  345 16107.5836 29954.6154  86.0%     -  134s
     0     0 29953.3043    0  347 16107.5836 29953.3043  86.0%     -  134s
     0     0 29948.7051    0  354 16107.5836 29948.7051  85.9%     -  135s
H    0     0                    16109.603653 29948.5837  85.9%     -  136s
H    0     0                    16162.895914 29948.5837  85.3%     -  136s
H    0     0                    16172.250494 29948.5837  85.2%     -  136s
     0     0 29946.6587    0  353 16172.2505 29946.6587  85.2%     -  136s
     0     0 29945.8816    0  363 16172.2505 29945.8816  85.2%     -  137s
     0     0 29939.0617    0  345 16172.2505 29939.0617  85.1%     -  138s
     0     0 29935.3872    0  348 16172.2505 29935.3872  85.1%     -  139s
     0     0 29934.3586    0  343 16172.2505 29934.3586  85.1%     -  140s
     0     0 29931.3030    0  351 16172.2505 29931.3030  85.1%     -  141s
     0     0 29929.8017    0  351 16172.2505 29929.8017  85.1%     -  143s
H    0     0                    16177.220082 29929.8017  85.0%     -  161s
H    0     0                    16184.095953 29929.8017  84.9%     -  162s
     0     2 29929.8017    0  351 16184.0960 29929.8017  84.9%     -  163s
     1     4 29680.0694    1  327 16184.0960 29928.9137  84.9%  3766  171s
     3     8 29572.5198    2  331 16184.0960 29679.4637  83.4%  5592  177s
     7    16 29416.9326    3  338 16184.0960 29572.3437  82.7%  5563  182s
    15    32 28977.4150    4  362 16184.0960 29416.6893  81.8%  5780  189s
    31    52 26786.9828    5  303 16184.0960 28977.2991  79.0%  7825  207s
    51    84 27323.2360    6  331 16184.0960 28976.6924  79.0%  7387  218s
H   54    84                    16190.255084 28976.6924  79.0%  7173  218s
H   59    84                    16200.917023 28976.6924  78.9%  7030  218s
    83   188 27268.7235    7  323 16200.9170 28976.6924  78.9%  5850  233s
   189   220 25607.7149   11  239 16200.9170 28976.6924  78.9%  4299  239s
H  192   220                    16293.833835 28976.6924  77.8%  4249  239s
H  193   220                    16395.634685 28976.6924  76.7%  4234  239s
   221   292 24975.7510   11  273 16395.6347 28976.6924  76.7%  4177  248s
   297   322 24779.7257    9  270 16395.6347 28976.6924  76.7%  3980  261s
H  299   322                    17531.732099 28976.6924  65.3%  3959  261s
   329   376 24864.8800   11  273 17531.7321 28976.6924  65.3%  3942  271s
   418   441 24642.1327   11  316 17531.7321 28976.6924  65.3%  3723  279s
   503   487 25595.3978   12  237 17531.7321 28976.6924  65.3%  3638  291s
   588   510 25406.4069   13  242 17531.7321 28879.8091  64.7%  3539  302s
H  590   510                    17578.491912 28879.8091  64.3%  3530  302s
H  596   510                    17823.802415 28879.8091  62.0%  3548  302s
H  602   510                    18642.947532 28879.8091  54.9%  3548  302s
   627   547 25468.1629   13  234 18642.9475 28879.8091  54.9%  3591  314s
   708   575 25051.0209   15  247 18642.9475 28773.6411  54.3%  3520  320s
H  709   575                    18682.595568 28773.6411  54.0%  3515  320s
H  719   575                    18717.030006 28773.6411  53.7%  3532  320s
H  720   575                    18720.389654 28773.6411  53.7%  3527  320s
   746   637 24240.2747   16  235 18720.3897 28773.6411  53.7%  3585  327s
   824   677 24018.7027   16  236 18720.3897 28773.6411  53.7%  3538  333s
H  825   677                    18727.483713 28773.6411  53.6%  3534  333s
H  837   677                    18923.662842 28773.6411  52.1%  3515  333s
   870   696 23965.0109   17  257 18923.6628 28773.6411  52.1%  3515  345s
   957   715 23714.3643   18  228 18923.6628 28773.6411  52.1%  3452  356s
  1001   742 20426.2395   18  212 18923.6628 28773.6411  52.1%  3493  367s
H 1047   742                    18998.150509 28773.6411  51.5%  3542  367s
H 1056   789                    19005.244568 28773.6411  51.4%  3560  375s
H 1060   789                    19007.505089 28773.6411  51.4%  3570  375s
H 1096   789                    19014.599149 28773.6411  51.3%  3545  375s
  1131   835 19301.5575   19  213 19014.5991 28773.6411  51.3%  3587  386s
  1195   892 22589.7752   20  226 19014.5991 28209.2738  48.4%  3572  398s
  1279   943 22553.1579   21  229 19014.5991 28096.6076  47.8%  3536  409s
  1388   966 21902.1111   22  172 19014.5991 28096.6076  47.8%  3458  420s
  1430  1017 21850.2258   23  219 19014.5991 28096.6076  47.8%  3489  428s
  1495  1076 21835.7074   24  170 19014.5991 28096.6076  47.8%  3467  441s
  1632  1151 21337.3991   32  150 19014.5991 27560.6603  44.9%  3374  451s
  1775  1203 20970.4009   39  130 19014.5991 27560.6603  44.9%  3307  463s
  1918  1221 21624.8706   10  197 19014.5991 27560.6603  44.9%  3283  473s
H 1952  1221                    19064.969539 27560.6603  44.6%  3282  473s
  2030  1246 21563.6615   11  191 19064.9695 27560.6603  44.6%  3264  488s
  2137  1298     cutoff   19      19064.9695 27453.4059  44.0%  3305  500s
H 2209  1298                    19481.394287 27453.4059  40.9%  3323  500s
  2221  1354 26101.1822    7  270 19481.3943 27453.4059  40.9%  3328  513s
  2353  1434 22343.0581    9  266 19481.3943 27453.4059  40.9%  3343  528s
  2513  1476 21244.1062   10  229 19481.3943 27448.5047  40.9%  3315  542s
H 2517  1476                    19492.509434 27448.5047  40.8%  3310  542s
H 2596  1476                    19509.035448 27448.5047  40.7%  3286  542s
  2669  1546 20032.1293   11  221 19509.0354 27448.5047  40.7%  3271  556s
  2801  1622     cutoff   12      19509.0354 27448.5047  40.7%  3307  572s
  2977  1662     cutoff   17      19509.0354 27053.2342  38.7%  3282  587s
  3132  1730 21048.3548   10  188 19509.0354 26933.3444  38.1%  3297  603s
H 3309  1781                    19520.150595 26853.7312  37.6%  3293  621s
H 3322  1781                    19532.964107 26715.6667  36.8%  3297  621s
H 3498  1781                    19684.961819 26715.6667  35.7%  3257  621s
  3520  1751 23337.6175   11  276 19684.9618 26715.6667  35.7%  3263  636s
H 3694  1763                    19695.284452 26464.9569  34.4%  3276  656s
  3833  1813 21408.4913   19  213 19695.2845 26402.1462  34.1%  3273  672s
  4013  1819     cutoff   21      19695.2845 26402.1462  34.1%  3281  687s
  4077  1821     cutoff   21      19695.2845 26389.6806  34.0%  3292  707s
  4173  1858 infeasible   22      19695.2845 26345.4646  33.8%  3294  725s
  4276  1872 23168.0929   12  241 19695.2845 26191.4761  33.0%  3302  743s
  4474  1913     cutoff   16      19695.2845 26166.8169  32.9%  3304  761s
  4671  1982 23042.8854   11  278 19695.2845 26166.8169  32.9%  3326  782s
  4900  1977     cutoff   14      19695.2845 26059.2175  32.3%  3337  802s
  5029  2020 20267.6542   13  222 19695.2845 25898.7143  31.5%  3337  825s
  5261  2093     cutoff   15      19695.2845 25889.7281  31.5%  3331  848s
  5536  2151 25370.1784    8  244 19695.2845 25820.2953  31.1%  3332  869s
  5796  2231 22814.2326   12  226 19695.2845 25795.3700  31.0%  3346  895s
  6048  2304 20758.6866   15  228 19695.2845 25605.8408  30.0%  3371  920s
  6367  2354 24576.4233   15  242 19695.2845 25534.5324  29.6%  3364  945s
  6593  2395     cutoff   19      19695.2845 25534.5324  29.6%  3388  970s
  6888  2435 21364.4280   13  345 19695.2845 25514.8153  29.5%  3406  994s
  7111  2495     cutoff   15      19695.2845 25445.5672  29.2%  3411 1021s
  7462  2536 21252.6103   11  215 19695.2845 25317.3986  28.5%  3404 1049s
  7818  2545     cutoff   17      19695.2845 25317.3986  28.5%  3410 1077s
  8157  2627     cutoff   18      19695.2845 25198.9735  27.9%  3408 1105s
  8516  2628 22148.6684   15  351 19695.2845 25198.9735  27.9%  3424 1146s
  8518  2629 20581.4989   24  178 19695.2845 25198.9735  27.9%  3423 1160s
  8519  2630 23479.3791   11  281 19695.2845 25198.9735  27.9%  3422 1175s
  8520  2631 23126.8085   18  317 19695.2845 25198.9735  27.9%  3422 1181s
  8521  2631 24476.9003   13  337 19695.2845 25198.9735  27.9%  3422 1186s
  8523  2633 20577.1196   11  354 19695.2845 25198.9735  27.9%  3421 1191s
  8525  2634 21305.3246   26  361 19695.2845 25198.9735  27.9%  3420 1196s
  8527  2635 24092.3290   10  339 19695.2845 25198.9735  27.9%  3419 1201s
  8529  2637 21646.6734   17  345 19695.2845 25198.9735  27.9%  3418 1205s
  8532  2639 20830.9248   28  345 19695.2845 25198.9735  27.9%  3417 1212s
  8533  2639 23017.9896   15  352 19695.2845 25198.9735  27.9%  3417 1215s
  8535  2641 24214.2429   12  343 19695.2845 25198.9735  27.9%  3416 1220s
  8537  2642 24210.5471   12  350 19695.2845 25198.9735  27.9%  3415 1225s
  8539  2643 20562.9914   24  388 19695.2845 25198.9735  27.9%  3414 1232s
  8541  2645 23214.4900   10  336 19695.2845 25198.9735  27.9%  3414 1237s
  8543  2646 20757.3960   11  341 19695.2845 25198.9735  27.9%  3413 1243s
  8544  2647 20083.8979   34  341 19695.2845 25198.9735  27.9%  3412 1256s
  8545  2647 21996.4181   12  341 19695.2845 25198.9735  27.9%  3412 1269s
  8546  2651 25198.9735   13  344 19695.2845 25198.9735  27.9%  3424 1278s
  8548  2654 25198.9735   14  344 19695.2845 25198.9735  27.9%  3424 1290s
  8552  2661 25198.9735   15  384 19695.2845 25198.9735  27.9%  3425 1309s
  8560  2674 25198.9735   16  407 19695.2845 25198.9735  27.9%  3428 1321s
  8576  2695 25198.9735   17  405 19695.2845 25198.9735  27.9%  3438 1341s
  8602  2718 25198.9735   18  388 19695.2845 25198.9735  27.9%  3450 1356s
  8634  2740 25153.0305   19  349 19695.2845 25198.9735  27.9%  3450 1371s
  8666  2785 24792.9131   20  359 19695.2845 25198.9735  27.9%  3468 1383s
  8727  2801 24493.8827   21  328 19695.2845 25198.9735  27.9%  3466 1398s
  8786  2803 24201.8361   22  261 19695.2845 25198.9735  27.9%  3469 1411s
  8843  2811 23485.6785   23  240 19695.2845 25198.9735  27.9%  3478 1425s
  8897  2817 23198.8449   24  251 19695.2845 25198.9735  27.9%  3491 1438s
  8960  2821 22627.4480   25  244 19695.2845 25198.9735  27.9%  3503 1451s
  9043  2817 21949.2011   26  246 19695.2845 25198.9735  27.9%  3500 1465s
  9106  2825 21837.4505   27  153 19695.2845 25198.9735  27.9%  3502 1476s
  9180  2819     cutoff   28      19695.2845 25198.9735  27.9%  3499 1486s
  9271  2800 21080.8477   31  155 19695.2845 25198.9735  27.9%  3488 1496s
  9332  2799     cutoff   32      19695.2845 25198.9735  27.9%  3486 1505s
  9402  2782 21839.4684   24  222 19695.2845 25198.9735  27.9%  3483 1517s
  9452  2789 21750.9872   25  211 19695.2845 25198.9735  27.9%  3480 1527s
  9514  2791 20794.7470   25  180 19695.2845 25198.9735  27.9%  3477 1539s
  9578  2789 19905.8358   27  161 19695.2845 25198.9735  27.9%  3477 1550s
  9630  2794     cutoff   29      19695.2845 25198.9735  27.9%  3477 1562s
  9707  2782 21557.7186   19  208 19695.2845 25198.9735  27.9%  3474 1575s
  9800  2769 21499.5845   21  195 19695.2845 25198.9735  27.9%  3473 1591s
  9910  2759     cutoff   24      19695.2845 25198.9735  27.9%  3461 1603s
 10009  2756 22123.4004   19  243 19695.2845 25198.9735  27.9%  3465 1617s
 10135  2737 21024.9998   21  127 19695.2845 25198.9735  27.9%  3452 1631s
 10256  2702 infeasible   31      19695.2845 25177.8559  27.8%  3443 1648s
 10379  2705 22391.8090   21  198 19695.2845 25104.4016  27.5%  3438 1661s
 10511  2693     cutoff   24      19695.2845 25104.4016  27.5%  3434 1677s
 10613  2680 20295.8159   24  165 19695.2845 24982.8038  26.8%  3427 1694s
 10796  2653 23551.5331   23  287 19695.2845 24723.2735  25.5%  3410 1709s
 10972  2609 22842.9054   27  272 19695.2845 24420.8648  24.0%  3394 1722s
 11144  2574 21554.4413   30  206 19695.2845 24198.4318  22.9%  3379 1739s
 11327  2515 19777.6292   33  151 19695.2845 23873.4872  21.2%  3367 1757s
 11424  2491     cutoff   22      19695.2845 23779.7074  20.7%  3364 1773s
 11622  2417 22193.6138   24  371 19695.2845 23779.7074  20.7%  3346 1789s
 11831  2331     cutoff   27      19695.2845 23579.0252  19.7%  3331 1804s
 12030  2247     cutoff   28      19695.2845 23569.3588  19.7%  3331 1824s
 12288  2132 22209.4092   24  318 19695.2845 23268.7827  18.1%  3318 1842s
 12554  2010 20757.7544   27  227 19695.2845 23268.7827  18.1%  3305 1859s
 12824  1840 20214.5101   29  186 19695.2845 22977.7337  16.7%  3290 1877s
 13154  1634     cutoff   25      19695.2845 22705.7858  15.3%  3268 1896s
 13459  1425     cutoff   21      19695.2845 22328.5824  13.4%  3252 1913s
 13821  1112     cutoff   32      19695.2845 22147.4189  12.5%  3225 1934s
 14331   727     cutoff   28      19695.2845 21552.8938  9.43%  3161 1949s
 14686   600     cutoff   27      19695.2845 20526.7236  4.22%  3109 1951s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 402
  Flow cover: 755
  RLT: 18
  Relax-and-lift: 55

Explored 14701 nodes (45836596 simplex iterations) in 1951.04 seconds (3974.96 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19695.3 19685 19533 ... 19007.5

Optimal solution found (tolerance 1.00e-04)
Best objective 1.969528445240e+04, best bound 1.969528445240e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1951.05s
  Master Objective (UB) = 19695.28, θ = 154498.80
  Upper Bound (UB) = 19695.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 154498.80
  [DEBUG]   ✓ Scenario 0: θ = 154498.80 ≤ Q = 154498.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 154498.80 ≤ Q = 154498.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 154498.80 ≤ Q = 154498.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 154498.80 ≤ Q = 154498.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 154498.80 ≤ Q = 154498.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 154498.80 ≤ Q = 154498.80 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x41976119
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x41976119
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368081e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6863163.7410
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.734072e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173407.25    0  126 6863163.74 -173407.25   103%     -    0s
H    0     0                    -135908.1977 -173407.25  27.6%     -    0s
H    0     0                    -136397.5724 -173407.25  27.1%     -    0s
     0     0 -147862.92    0   64 -136397.57 -147862.92  8.41%     -    0s
H    0     0                    -145262.3113 -147758.42  1.72%     -    0s
H    0     0                    -145538.5718 -147758.42  1.53%     -    0s
H    0     0                    -146133.1476 -147758.42  1.11%     -    0s
H    0     0                    -146409.4081 -147758.42  0.92%     -    0s
     0     0 -147112.15    0   49 -146409.41 -147112.15  0.48%     -    0s
H    0     0                    -146447.5434 -147093.38  0.44%     -    0s
     0     0 -147093.38    0   52 -146447.54 -147093.38  0.44%     -    0s
     0     0 -146751.97    0   26 -146447.54 -146751.97  0.21%     -    0s
     0     0 -146690.32    0   28 -146447.54 -146690.32  0.17%     -    0s
     0     0 -146689.97    0   28 -146447.54 -146689.97  0.17%     -    0s
     0     0 -146688.78    0   28 -146447.54 -146688.78  0.16%     -    0s
     0     0 -146514.34    0   11 -146447.54 -146514.34  0.05%     -    0s
     0     0 -146494.80    0    7 -146447.54 -146494.80  0.03%     -    0s
     0     0 -146491.93    0    8 -146447.54 -146491.93  0.03%     -    0s
     0     0 -146473.78    0    6 -146447.54 -146473.78  0.02%     -    0s
     0     0 -146473.78    0   10 -146447.54 -146473.78  0.02%     -    0s
H    0     0                    -146454.0731 -146473.78  0.01%     -    0s
     0     0          -    0      -146454.07 -146467.94  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 6
  Flow cover: 4
  RLT: 3
  Relax-and-lift: 2

Explored 1 nodes (721 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -146454 -146448 -146409 ... 1.36808e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.464540731121e+05, best bound -1.464679374680e+05, gap 0.0095%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 147881.78
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146454.07
  [DEBUG]   S×d_nominal = 294335.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294335.85 + -146454.07 = 147881.78
  [DEBUG]   Current θ from Master = 154498.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6617.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13078.26
  Lower Bound (LB) = 16544.14
  Gap (UB-LB) = 3151.1488, Absolute Gap = 3151.1488, Relative Gap = 0.159995
  Not converged yet (gap = 3151.15 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0x9b989824
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 1.69s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356030.4446
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27214   -1.4239779e+05   0.000000e+00   3.812350e+08      5s
   39026    5.5522998e+03   0.000000e+00   3.589692e+07     10s
   47099    2.8188232e+04   0.000000e+00   8.527983e+06     15s
   54981    3.5285665e+04   0.000000e+00   7.793186e+06     20s
Concurrent spin time: 6.03s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.273016e+04, 49887 iterations, 25.76 seconds (33.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42730.1591    0  178 -203357.92 42730.1591   121%     -   28s
H    0     0                    -191282.7053 42730.1591   122%     -   28s
H    0     0                    -39624.81539 42730.1591   208%     -   28s
H    0     0                    -37504.47312 42730.1591   214%     -   28s
H    0     0                    -26317.14241 42730.1591   262%     -   29s
H    0     0                    -6287.260155 42730.1591   780%     -   29s
H    0     0                    14135.302371 42730.1591   202%     -   29s
H    0     0                    14256.205179 42730.1591   200%     -   29s
H    0     0                    14267.018428 42730.1591   200%     -   29s
H    0     0                    14334.736105 42730.1591   198%     -   30s
     0     0 39614.1065    0  227 14334.7361 39614.1065   176%     -   37s
H    0     0                    14353.932028 39613.9053   176%     -   38s
H    0     0                    14355.647326 38328.3442   167%     -   45s
H    0     0                    14357.249473 38328.3442   167%     -   45s
H    0     0                    14375.276177 38328.3442   167%     -   45s
     0     0 38328.3442    0  198 14375.2762 38328.3442   167%     -   45s
     0     0 37870.3662    0  207 14375.2762 37870.3662   163%     -   48s
     0     0 37858.0800    0  202 14375.2762 37858.0800   163%     -   52s
     0     0 37858.0800    0  210 14375.2762 37858.0800   163%     -   52s
     0     0 37858.0800    0  210 14375.2762 37858.0800   163%     -   53s
     0     0 37858.0800    0  210 14375.2762 37858.0800   163%     -   53s
     0     0 35196.2068    0  248 14375.2762 35196.2068   145%     -   63s
H    0     0                    16024.832395 35195.6515   120%     -   63s
     0     0 34415.0801    0  257 16024.8324 34415.0801   115%     -   69s
     0     0 34055.1199    0  242 16024.8324 34055.1199   113%     -   74s
     0     0 33996.0751    0  246 16024.8324 33996.0751   112%     -   75s
     0     0 33893.1737    0  246 16024.8324 33893.1737   112%     -   78s
     0     0 33690.2260    0  252 16024.8324 33690.2260   110%     -   82s
     0     0 33672.3198    0  247 16024.8324 33672.3198   110%     -   84s
     0     0 33669.4916    0  256 16024.8324 33669.4916   110%     -   85s
     0     0 33665.0361    0  257 16024.8324 33665.0361   110%     -   85s
     0     0 33661.6650    0  256 16024.8324 33661.6650   110%     -   86s
     0     0 33658.9058    0  256 16024.8324 33658.9058   110%     -   86s
     0     0 33658.4505    0  260 16024.8324 33658.4505   110%     -   86s
     0     0 32164.7161    0  298 16024.8324 32164.7161   101%     -  103s
H    0     0                    16170.026274 32164.5912  98.9%     -  104s
H    0     0                    16170.612470 32164.5912  98.9%     -  104s
     0     0 31806.4730    0  314 16170.6125 31806.4730  96.7%     -  108s
     0     0 31722.4261    0  251 16170.6125 31722.4261  96.2%     -  111s
     0     0 31602.1734    0  294 16170.6125 31602.1734  95.4%     -  114s
     0     0 31519.1578    0  299 16170.6125 31519.1578  94.9%     -  117s
     0     0 31498.5471    0  302 16170.6125 31498.5471  94.8%     -  119s
     0     0 31474.2163    0  310 16170.6125 31474.2163  94.6%     -  120s
     0     0 31471.0263    0  320 16170.6125 31471.0263  94.6%     -  120s
     0     0 31467.8548    0  323 16170.6125 31467.8548  94.6%     -  121s
     0     0 31467.7611    0  321 16170.6125 31467.7611  94.6%     -  121s
     0     0 30551.7989    0  363 16170.6125 30551.7989  88.9%     -  133s
H    0     0                    16179.967050 30551.5090  88.8%     -  133s
     0     0 30359.2886    0  343 16179.9671 30359.2886  87.6%     -  138s
     0     0 30275.3021    0  338 16179.9671 30275.3021  87.1%     -  141s
     0     0 30256.5611    0  339 16179.9671 30256.5611  87.0%     -  142s
     0     0 30228.7567    0  339 16179.9671 30228.7567  86.8%     -  144s
     0     0 30204.2343    0  345 16179.9671 30204.2343  86.7%     -  146s
     0     0 30194.3278    0  346 16179.9671 30194.3278  86.6%     -  147s
     0     0 30187.0075    0  344 16179.9671 30187.0075  86.6%     -  147s
     0     0 30185.3418    0  348 16179.9671 30185.3418  86.6%     -  148s
     0     0 30184.6564    0  349 16179.9671 30184.6564  86.6%     -  148s
     0     0 30133.9382    0  348 16179.9671 30133.9382  86.2%     -  151s
     0     0 30108.7357    0  340 16179.9671 30108.7357  86.1%     -  154s
     0     0 30105.5492    0  340 16179.9671 30105.5492  86.1%     -  155s
     0     0 30104.4923    0  345 16179.9671 30104.4923  86.1%     -  155s
     0     0 29993.8708    0  342 16179.9671 29993.8708  85.4%     -  160s
H    0     0                    16389.132233 29993.6560  83.0%     -  162s
H    0     0                    16389.718428 29993.6560  83.0%     -  162s
H    0     0                    16399.073009 29993.6560  82.9%     -  162s
     0     0 29948.7350    0  351 16399.0730 29948.7350  82.6%     -  164s
     0     0 29940.7255    0  354 16399.0730 29940.7255  82.6%     -  165s
     0     0 29931.1441    0  351 16399.0730 29931.1441  82.5%     -  165s
     0     0 29928.9957    0  362 16399.0730 29928.9957  82.5%     -  166s
     0     0 29927.5098    0  364 16399.0730 29927.5098  82.5%     -  166s
     0     0 29926.6295    0  362 16399.0730 29926.6295  82.5%     -  167s
     0     0 29916.7394    0  362 16399.0730 29916.7394  82.4%     -  169s
     0     0 29908.9346    0  360 16399.0730 29908.9346  82.4%     -  171s
     0     0 29901.6791    0  345 16399.0730 29901.6791  82.3%     -  173s
     0     0 29897.9940    0  350 16399.0730 29897.9940  82.3%     -  174s
     0     0 29895.1275    0  356 16399.0730 29895.1275  82.3%     -  174s
     0     0 29894.6575    0  356 16399.0730 29894.6575  82.3%     -  175s
     0     0 29884.5425    0  349 16399.0730 29884.5425  82.2%     -  177s
H    0     0                    16405.948881 29884.5395  82.2%     -  178s
     0     0 29881.9218    0  353 16405.9489 29881.9218  82.1%     -  178s
     0     0 29881.0663    0  353 16405.9489 29881.0663  82.1%     -  179s
     0     0 29876.3140    0  362 16405.9489 29876.3140  82.1%     -  181s
H    0     0                    16446.047792 29875.7429  81.7%     -  181s
     0     0 29875.5627    0  364 16446.0478 29875.5627  81.7%     -  182s
     0     0 29874.1287    0  361 16446.0478 29874.1287  81.6%     -  183s
     0     0 29873.4893    0  349 16446.0478 29873.4893  81.6%     -  184s
     0     0 29873.2811    0  355 16446.0478 29873.2811  81.6%     -  186s
     0     0 29872.8576    0  355 16446.0478 29872.8576  81.6%     -  187s
H    0     0                    16472.774580 29872.8576  81.3%     -  197s
H    0     0                    16507.406540 29872.8576  81.0%     -  197s
H    0     0                    16508.726629 29872.8576  81.0%     -  197s
H    0     0                    16509.312825 29872.8576  80.9%     -  197s
     0     2 29872.8576    0  355 16509.3128 29872.8576  80.9%     -  209s
     1     4 29550.8727    1  335 16509.3128 29872.8576  80.9%  4928  217s
     3     8 29463.4804    2  353 16509.3128 29547.4012  79.0%  5735  223s
     7    16 29264.0079    3  393 16509.3128 29463.1309  78.5%  5273  229s
    15    32 28729.0832    4  362 16509.3128 29262.2499  77.2%  5408  238s
    31    49 28487.3084    5  342 16509.3128 28991.6914  75.6%  7537  257s
    48    81 27775.1682    6  323 16509.3128 28991.1176  75.6%  7046  288s
    80   194 27710.6433    7  313 16509.3128 28991.1176  75.6%  6067  309s
   193   265 27015.7693   10  303 16509.3128 28991.1176  75.6%  5012  322s
   266   345 26874.0438   11  298 16509.3128 28991.1176  75.6%  4531  334s
   348   378 26044.1389   12  281 16509.3128 28991.1176  75.6%  4093  344s
   384   411 25309.0689   12  341 16509.3128 28991.1176  75.6%  3992  357s
   419   448 26345.5190   11  320 16509.3128 28991.1176  75.6%  3930  366s
   462   474 26529.0596   11  235 16509.3128 28991.1176  75.6%  3802  379s
   523   510 25042.2043   13  195 16509.3128 28991.1176  75.6%  3581  389s
   581   549 25005.6884   14  304 16509.3128 28991.1176  75.6%  3475  402s
   642   582 25102.8180   13  355 16509.3128 28991.1176  75.6%  3372  415s
   701   631 24383.8591   15  234 16509.3128 28991.1176  75.6%  3340  424s
   762   668 23674.8398   15  289 16509.3128 28991.1176  75.6%  3259  435s
   819   716 21429.4608   14  212 16509.3128 28991.0160  75.6%  3181  446s
   875   760 26367.9222    8  354 16509.3128 28991.0160  75.6%  3130  456s
H  905   760                    16590.674879 28991.0160  74.7%  3099  456s
   935   810 23690.4664   16  235 16590.6749 28991.0160  74.7%  3052  465s
  1021   854 23593.1736   17  210 16590.6749 28991.0160  74.7%  2963  478s
  1121   922 23065.5105   19  202 16590.6749 28991.0160  74.7%  2878  491s
  1219   997 23118.7894   19  206 16590.6749 28991.0160  74.7%  2830  504s
  1326  1108 22680.0367   21  197 16590.6749 28991.0160  74.7%  2771  514s
  1449  1196 22059.0016   21  175 16590.6749 28991.0160  74.7%  2677  527s
  1606  1319 22655.1178   22  191 16590.6749 28851.8253  73.9%  2573  540s
  1756  1440 22024.1636   22  180 16590.6749 28850.7779  73.9%  2483  553s
H 1919  1463                    16919.026896 28850.7779  70.5%  2398  561s
H 1924  1463                    17242.978830 28850.7779  67.3%  2398  561s
H 1926  1463                    17361.269604 28850.7779  66.2%  2397  561s
H 1929  1463                    17410.207463 28850.7779  65.7%  2398  561s
H 1944  1463                    17525.475084 28850.7779  64.6%  2405  561s
  1956  1610 22221.6380   27  172 17525.4751 28850.7779  64.6%  2403  573s
  2123  1716 21668.0053   33  159 17525.4751 28660.5612  63.5%  2330  588s
  2313  1812 21627.6132   35  214 17525.4751 28660.5612  63.5%  2250  603s
  2460  1888 20398.9310   35  132 17525.4751 28207.1344  60.9%  2231  617s
H 2605  1905                    17614.235961 28207.1344  60.1%  2222  631s
H 2607  1782                    18465.933216 28207.1344  52.8%  2222  631s
H 2625  1771                    18528.300170 28207.1344  52.2%  2227  631s
  2646  1838 20367.9312   36  180 18528.3002 27968.7020  51.0%  2234  649s
  2803  1896 infeasible   38      18528.3002 27968.7020  51.0%  2230  666s
H 2805  1856                    18691.481007 27968.7020  49.6%  2228  666s
H 2809  1813                    18904.789453 27968.7020  47.9%  2229  666s
H 2818  1796                    19064.969539 27968.7020  46.7%  2225  666s
H 2867  1796                    19473.361767 27968.7020  43.6%  2214  666s
  2915  1784 25214.4039    9  299 19473.3618 27968.7020  43.6%  2220  683s
  3058  1818 24148.1047   10  274 19473.3618 27829.0481  42.9%  2226  700s
  3227  1875     cutoff   12      19473.3618 27829.0481  42.9%  2226  717s
  3368  1925 21634.8258   14  232 19473.3618 27716.6020  42.3%  2244  737s
  3523  1999 20177.5794   19  192 19473.3618 27716.6020  42.3%  2248  756s
  3693  2058 24549.9226    9  297 19473.3618 27507.3106  41.3%  2251  777s
  3853  2151 22568.9249   13  241 19473.3618 27445.7429  40.9%  2268  799s
  4019  2173     cutoff   18      19473.3618 27379.0708  40.6%  2282  814s
H 4020  2145                    19582.920395 27379.0708  39.8%  2281  814s
H 4028  2143                    19595.861718 27379.0708  39.7%  2283  814s
H 4043  2139                    19629.673387 27379.0708  39.5%  2287  814s
  4062  2176 20736.8230   19  105 19629.6734 27326.6326  39.2%  2292  836s
  4248  2236 24278.9511    9  313 19629.6734 27326.6326  39.2%  2295  860s
  4444  2274 20843.9975   16  218 19629.6734 27155.8147  38.3%  2303  883s
  4652  2297 24033.6562    9  305 19629.6734 27145.6783  38.3%  2312  906s
  4716  2330 19951.5262   10  260 19629.6734 27098.7762  38.1%  2324  932s
  4837  2382     cutoff   11      19629.6734 27098.7762  38.1%  2327  957s
  4999  2426 21163.9508   14  236 19629.6734 26917.9851  37.1%  2345  983s
  5213  2484 25700.9152    9  267 19629.6734 26917.9851  37.1%  2364 1009s
  5375  2525 22701.1687   16  198 19629.6734 26866.5308  36.9%  2376 1037s
  5575  2595 20202.3172   22  159 19629.6734 26844.9473  36.8%  2404 1064s
  5849  2641 23344.4177   12  333 19629.6734 26844.9473  36.8%  2408 1096s
  6118  2686 21359.5270   15  220 19629.6734 26806.6929  36.6%  2415 1127s
  6405  2683 20628.6594   16  194 19629.6734 26654.9038  35.8%  2423 1158s
  6654  2750 22516.7097   15  274 19629.6734 26596.8563  35.5%  2424 1194s
  6915  2807 22609.4760   13  289 19629.6734 26573.0306  35.4%  2448 1232s
  7204  2904 20827.3307   15  241 19629.6734 26536.8009  35.2%  2462 1273s
  7535  2905 22717.1759   19  355 19629.6734 26324.8186  34.1%  2465 1313s
  7537  2906 20535.3450   20  178 19629.6734 26324.8186  34.1%  2464 1353s
  7538  2907 23559.6084    9  207 19629.6734 26324.8186  34.1%  2464 1377s
  7539  2908 25404.7302   10  306 19629.6734 26324.8186  34.1%  2464 1395s
  7540  2908 23193.7460   17  372 19629.6734 26324.8186  34.1%  2463 1409s
  7541  2909 21870.6783   21  294 19629.6734 26324.8186  34.1%  2463 1415s
  7542  2910 22281.4601   13  346 19629.6734 26324.8186  34.1%  2463 1423s
  7543  2910 19657.7100   40  334 19629.6734 26324.8186  34.1%  2462 1432s
  7544  2911 20988.2588   43  346 19629.6734 26324.8186  34.1%  2462 1436s
  7545  2912 24861.0220   15  343 19629.6734 26324.8186  34.1%  2462 1440s
  7547  2913 21510.3087   22  351 19629.6734 26324.8186  34.1%  2461 1445s
  7549  2914 20743.7707   15  355 19629.6734 26324.8186  34.1%  2460 1453s
  7551  2916 20605.5251   23  348 19629.6734 26324.8186  34.1%  2460 1457s
  7552  2916 21381.6043   72  344 19629.6734 26324.8186  34.1%  2459 1463s
  7553  2917 21392.6067   28  353 19629.6734 26324.8186  34.1%  2459 1466s
  7554  2918 20323.1516   25  345 19629.6734 26324.8186  34.1%  2459 1470s
  7556  2919 24404.2524   19  355 19629.6734 26324.8186  34.1%  2458 1476s
  7558  2920 22378.4644    9  356 19629.6734 26324.8186  34.1%  2457 1483s
  7559  2921 22483.5403   24  393 19629.6734 26324.8186  34.1%  2457 1485s
  7560  2922 22897.6355   18  399 19629.6734 26324.8186  34.1%  2457 1492s
  7562  2923 24337.2159   11  388 19629.6734 26324.8186  34.1%  2456 1500s
  7564  2924 24482.1701   10  373 19629.6734 26324.8186  34.1%  2455 1507s
  7565  2925 25389.3914   12  367 19629.6734 26324.8186  34.1%  2455 1514s
  7566  2926 21275.6023   29  367 19629.6734 26324.8186  34.1%  2455 1552s
  7567  2926 21317.1807   23  367 19629.6734 26324.8186  34.1%  2454 1586s
  7568  2930 26324.8186   16  347 19629.6734 26324.8186  34.1%  2478 1601s
  7570  2933 26324.8186   17  355 19629.6734 26324.8186  34.1%  2479 1628s
  7574  2940 26324.8186   18  336 19629.6734 26324.8186  34.1%  2482 1645s
  7582  2953 26324.8186   19  343 19629.6734 26324.8186  34.1%  2490 1664s
  7598  2962 26324.8186   20  368 19629.6734 26324.8186  34.1%  2503 1687s
  7614  2979 25214.0060   21  299 19629.6734 26324.8186  34.1%  2530 1711s
  7645  3038 24128.4069   22  302 19629.6734 26324.8186  34.1%  2539 1736s
  7724  3059 23218.6627   25  188 19629.6734 26324.8186  34.1%  2593 1756s
  7825  3047 22007.0273   24  252 19629.6734 26324.8186  34.1%  2597 1772s
  7912  3035 22921.5830   26  196 19629.6734 26324.8186  34.1%  2596 1786s
  7973  3041 21401.3521   27  207 19629.6734 26324.8186  34.1%  2598 1801s
  8047  3034 21360.6469   27  211 19629.6734 26324.8186  34.1%  2601 1815s
  8102  3031 21995.0442   27  181 19629.6734 26324.8186  34.1%  2605 1828s
  8180  3019     cutoff   28      19629.6734 26324.8186  34.1%  2604 1841s
  8221  3030 20627.3871   29  179 19629.6734 26324.8186  34.1%  2605 1855s
  8267  3035 20304.6790   30  177 19629.6734 26324.8186  34.1%  2610 1873s
  8316  3038     cutoff   30      19629.6734 26265.2945  33.8%  2609 1886s
  8370  3029     cutoff   32      19629.6734 26265.2945  33.8%  2614 1898s
  8427  3026 21664.1949   22  229 19629.6734 26265.2945  33.8%  2615 1911s
  8481  3029     cutoff   23      19629.6734 26265.2945  33.8%  2619 1932s
  8528  3029     cutoff   24      19629.6734 26263.3483  33.8%  2622 1946s
  8592  3015 21312.1845   25  187 19629.6734 26263.3483  33.8%  2625 1960s
  8645  3019     cutoff   25      19629.6734 26263.3483  33.8%  2629 1974s
  8702  3018 20704.9575   27  259 19629.6734 26263.3483  33.8%  2632 1988s
  8780  3005 19726.5480   27  153 19629.6734 26263.3483  33.8%  2631 2004s
  8868  2976 20183.2999   30  193 19629.6734 26263.3483  33.8%  2633 2021s
  8955  2956     cutoff   23      19629.6734 26263.3483  33.8%  2635 2039s
  9045  2932 21565.0225   30  225 19629.6734 26263.3483  33.8%  2640 2056s
  9140  2920 19829.7129   32  200 19629.6734 26263.3483  33.8%  2644 2075s
  9272  2893     cutoff   24      19629.6734 26263.3483  33.8%  2641 2092s
  9386  2884 22544.6346   26  274 19629.6734 26263.3483  33.8%  2643 2109s
  9530  2851 21351.7951   29  203 19629.6734 26263.3483  33.8%  2635 2132s
  9683  2809 19901.5718   32  120 19629.6734 24226.9602  23.4%  2627 2152s
  9784  2789     cutoff   25      19629.6734 24059.9392  22.6%  2625 2173s
  9953  2745 21297.2899   25  338 19629.6734 24059.9392  22.6%  2611 2192s
 10119  2696 20184.1579   30  238 19629.6734 24059.9392  22.6%  2603 2212s
 10292  2650     cutoff   28      19629.6734 24059.9392  22.6%  2598 2233s
 10482  2588     cutoff   32      19629.6734 23523.0454  19.8%  2589 2253s
 10654  2538 20577.7890   25  274 19629.6734 23233.2872  18.4%  2571 2275s
 10830  2476 20678.5614   29  228 19629.6734 23222.7742  18.3%  2568 2299s
 11060  2382 19795.7335   32  105 19629.6734 23222.7742  18.3%  2558 2324s
 11133  2362 19749.6743   33  105 19629.6734 22823.2677  16.3%  2562 2343s
 11224  2312 19749.3949   34  105 19629.6734 22739.8618  15.8%  2555 2367s
 11350  2249     cutoff   35      19629.6734 22595.3691  15.1%  2550 2396s
 11504  2162 20516.3027   27  166 19629.6734 22570.3924  15.0%  2540 2421s
 11669  2045 19710.1801   28  117 19629.6734 22314.4620  13.7%  2528 2447s
 11949  1879 21099.9623   35  146 19629.6734 22209.2297  13.1%  2507 2472s
 12185  1592     cutoff   28      19629.6734 21730.0096  10.7%  2486 2497s
 12725  1220 19906.5480   35  188 19629.6734 21426.1658  9.15%  2425 2513s
 13230  1039 19729.3287   41    8 19629.6734 19784.5203  0.79%  2348 2516s

Cutting planes:
  MIR: 586
  Mixing: 2
  Flow cover: 1090
  RLT: 21
  Relax-and-lift: 117

Explored 13295 nodes (31289797 simplex iterations) in 2516.17 seconds (4865.78 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19629.7 19595.9 19582.9 ... 17614.2

Optimal solution found (tolerance 1.00e-04)
Best objective 1.962967338713e+04, best bound 1.962967338713e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2516.20s
  Master Objective (UB) = 19629.67, θ = 154703.91
  Upper Bound (UB) = 19629.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 154703.91
  [DEBUG]   ✓ Scenario 0: θ = 154703.91 ≤ Q = 154703.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 154703.91 ≤ Q = 154703.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 154703.91 ≤ Q = 154703.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 154703.91 ≤ Q = 154703.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 154703.91 ≤ Q = 154703.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 154703.91 ≤ Q = 154703.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 154703.91 ≤ Q = 154703.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x8cd427d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf732bd83
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368081e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6876578.4480
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.730937e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173093.66    0  127 6876578.45 -173093.66   103%     -    0s
H    0     0                    -135512.9895 -173093.66  27.7%     -    0s
H    0     0                    -136002.3642 -173093.66  27.3%     -    0s
     0     0 -145427.35    0   63 -136002.36 -145427.35  6.93%     -    0s
H    0     0                    -142919.9385 -145371.56  1.72%     -    0s
H    0     0                    -143196.1990 -145371.56  1.52%     -    0s
H    0     0                    -143838.5793 -145371.56  1.07%     -    0s
H    0     0                    -144114.8398 -145371.56  0.87%     -    0s
     0     0 -144763.58    0   55 -144114.84 -144763.58  0.45%     -    0s
H    0     0                    -144138.3377 -144744.03  0.42%     -    0s
     0     0 -144698.93    0   54 -144138.34 -144698.93  0.39%     -    0s
     0     0 -144361.71    0   24 -144138.34 -144361.71  0.15%     -    0s
     0     0 -144354.86    0   23 -144138.34 -144354.86  0.15%     -    0s
     0     0 -144354.80    0   22 -144138.34 -144354.80  0.15%     -    0s
     0     0 -144322.40    0   24 -144138.34 -144322.40  0.13%     -    0s
     0     0 -144322.40    0   23 -144138.34 -144322.40  0.13%     -    0s
     0     0 -144205.60    0   12 -144138.34 -144205.60  0.05%     -    0s
     0     0 -144205.60    0   20 -144138.34 -144205.60  0.05%     -    0s
H    0     0                    -144139.4452 -144205.60  0.05%     -    0s
     0     0 -144160.52    0    4 -144139.45 -144160.52  0.01%     -    0s
     0     0          -    0      -144139.45 -144149.94  0.01%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 11
  Flow cover: 8
  Relax-and-lift: 2

Explored 1 nodes (741 simplex iterations) in 0.24 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -144139 -144138 -144115 ... 1.36808e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.441394452311e+05, best bound -1.441499371339e+05, gap 0.0073%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 150209.03
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144139.45
  [DEBUG]   S×d_nominal = 294348.48
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294348.48 + -144139.45 = 150209.03
  [DEBUG]   Current θ from Master = 154703.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4494.88 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15134.79
  Lower Bound (LB) = 16544.14
  Gap (UB-LB) = 3085.5377, Absolute Gap = 3085.5377, Relative Gap = 0.157187
  Not converged yet (gap = 3085.54 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0x42cb8a65
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 2.15s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356030.4446
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24273   -1.9934646e+05   0.000000e+00   4.772271e+07      5s
   38279   -3.7747989e+04   0.000000e+00   6.644684e+08     10s
   48591    1.8493851e+03   0.000000e+00   6.501071e+08     15s
   57919    1.9293164e+04   0.000000e+00   2.334764e+06     20s
   63881    2.4156473e+04   0.000000e+00   5.917622e+06     25s
   70655    2.8878265e+04   0.000000e+00   1.241788e+06     30s
   77286    3.3483093e+04   0.000000e+00   2.455910e+07     35s
Concurrent spin time: 2.41s

Solved with dual simplex

Root relaxation: objective 4.273016e+04, 47559 iterations, 35.16 seconds (46.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42730.1591    0  178 -203357.92 42730.1591   121%     -   38s
H    0     0                    -196000.7703 42730.1591   122%     -   38s
H    0     0                    -102487.7955 42730.1591   142%     -   38s
H    0     0                    -95895.58484 42730.1591   145%     -   38s
H    0     0                    -26317.14241 42730.1591   262%     -   38s
H    0     0                    12194.343774 42730.1591   250%     -   38s
H    0     0                    14267.018428 42730.1591   200%     -   39s
H    0     0                    14320.527974 42730.1591   198%     -   39s
H    0     0                    14334.736105 42730.1591   198%     -   40s
H    0     0                    14390.825628 39730.4981   176%     -   50s
     0     0 39717.7750    0  114 14390.8256 39717.7750   176%     -   50s
     0     0 37767.2759    0  229 14390.8256 37767.2759   162%     -   58s
     0     0 37668.0393    0  224 14390.8256 37668.0393   162%     -   61s
     0     0 37556.4783    0  229 14390.8256 37556.4783   161%     -   62s
     0     0 37518.5355    0  232 14390.8256 37518.5355   161%     -   66s
     0     0 37518.5355    0  227 14390.8256 37518.5355   161%     -   67s
     0     0 37518.5355    0  234 14390.8256 37518.5355   161%     -   67s
     0     0 37518.5355    0  227 14390.8256 37518.5355   161%     -   68s
     0     0 37518.5355    0  226 14390.8256 37518.5355   161%     -   70s
     0     0 37518.4593    0  226 14390.8256 37518.4593   161%     -   71s
     0     0 37518.4593    0  226 14390.8256 37518.4593   161%     -   71s
     0     0 34846.6124    0  245 14390.8256 34846.6124   142%     -   84s
H    0     0                    14407.553677 34846.0892   142%     -   84s
     0     0 34301.9784    0  256 14407.5537 34301.9784   138%     -   91s
     0     0 34169.0273    0  261 14407.5537 34169.0273   137%     -   95s
     0     0 33983.2450    0  271 14407.5537 33983.2450   136%     -  100s
     0     0 33833.5829    0  282 14407.5537 33833.5829   135%     -  103s
H    0     0                    14598.819223 33790.0339   131%     -  105s
     0     0 33790.0339    0  278 14598.8192 33790.0339   131%     -  105s
     0     0 33788.1798    0  278 14598.8192 33788.1798   131%     -  106s
     0     0 33786.1570    0  282 14598.8192 33786.1570   131%     -  107s
     0     0 33721.3229    0  286 14598.8192 33721.3229   131%     -  108s
     0     0 33693.4186    0  284 14598.8192 33693.4186   131%     -  110s
     0     0 33678.3375    0  258 14598.8192 33678.3375   131%     -  110s
     0     0 33665.4140    0  265 14598.8192 33665.4140   131%     -  111s
     0     0 33657.1065    0  286 14598.8192 33657.1065   131%     -  113s
     0     0 33656.5029    0  292 14598.8192 33656.5029   131%     -  113s
H    0     0                    15815.556797 31922.4032   102%     -  131s
H    0     0                    16035.120429 31922.4032  99.1%     -  131s
H    0     0                    16044.475010 31922.4032  99.0%     -  131s
     0     0 31922.4032    0  308 16044.4750 31922.4032  99.0%     -  131s
H    0     0                    16110.978837 31913.3128  98.1%     -  131s
     0     0 31654.6639    0  311 16110.9788 31654.6639  96.5%     -  136s
     0     0 31575.0940    0  312 16110.9788 31575.0940  96.0%     -  138s
     0     0 31527.7006    0  332 16110.9788 31527.7006  95.7%     -  140s
     0     0 31497.5391    0  332 16110.9788 31497.5391  95.5%     -  142s
     0     0 31458.6834    0  324 16110.9788 31458.6834  95.3%     -  144s
     0     0 31434.5877    0  326 16110.9788 31434.5877  95.1%     -  145s
     0     0 31429.3999    0  333 16110.9788 31429.3999  95.1%     -  145s
     0     0 31346.0447    0  324 16110.9788 31346.0447  94.6%     -  148s
     0     0 31321.3320    0  328 16110.9788 31321.3320  94.4%     -  150s
     0     0 31308.6170    0  330 16110.9788 31308.6170  94.3%     -  152s
     0     0 31303.7154    0  335 16110.9788 31303.7154  94.3%     -  153s
     0     0 31298.5076    0  333 16110.9788 31298.5076  94.3%     -  153s
     0     0 31297.1132    0  332 16110.9788 31297.1132  94.3%     -  154s
     0     0 31296.5887    0  335 16110.9788 31296.5887  94.3%     -  154s
     0     0 30516.3042    0  342 16110.9788 30516.3042  89.4%     -  164s
     0     0 30310.6732    0  350 16110.9788 30310.6732  88.1%     -  168s
     0     0 30265.8969    0  352 16110.9788 30265.8969  87.9%     -  170s
     0     0 30238.8184    0  353 16110.9788 30238.8184  87.7%     -  172s
     0     0 30229.4948    0  355 16110.9788 30229.4948  87.6%     -  173s
H    0     0                    16112.554052 30220.7789  87.6%     -  174s
     0     0 30220.7789    0  346 16112.5541 30220.7789  87.6%     -  174s
     0     0 30217.8638    0  352 16112.5541 30217.8638  87.5%     -  175s
     0     0 30212.9726    0  360 16112.5541 30212.9726  87.5%     -  175s
     0     0 30210.2158    0  359 16112.5541 30210.2158  87.5%     -  176s
     0     0 30209.5929    0  359 16112.5541 30209.5929  87.5%     -  176s
     0     0 30113.6009    0  347 16112.5541 30113.6009  86.9%     -  181s
     0     0 30089.5408    0  347 16112.5541 30089.5408  86.7%     -  185s
     0     0 30074.9765    0  353 16112.5541 30074.9765  86.7%     -  187s
     0     0 30057.8960    0  351 16112.5541 30057.8960  86.5%     -  190s
     0     0 30052.9442    0  357 16112.5541 30052.9442  86.5%     -  191s
     0     0 30049.1093    0  361 16112.5541 30049.1093  86.5%     -  191s
     0     0 30047.8044    0  350 16112.5541 30047.8044  86.5%     -  192s
     0     0 29998.3105    0  361 16112.5541 29998.3105  86.2%     -  196s
     0     0 29960.4234    0  351 16112.5541 29960.4234  85.9%     -  205s
H    0     0                    16150.421572 29949.7785  85.4%     -  206s
H    0     0                    16167.212420 29949.7785  85.3%     -  206s
     0     0 29949.7785    0  357 16167.2124 29949.7785  85.3%     -  206s
     0     0 29947.8073    0  352 16167.2124 29947.8073  85.2%     -  206s
     0     0 29946.4746    0  355 16167.2124 29946.4746  85.2%     -  207s
     0     0 29941.0650    0  360 16167.2124 29941.0650  85.2%     -  210s
     0     0 29939.4621    0  355 16167.2124 29939.4621  85.2%     -  211s
     0     0 29937.0582    0  353 16167.2124 29937.0582  85.2%     -  212s
     0     0 29936.9624    0  353 16167.2124 29936.9624  85.2%     -  212s
     0     0 29927.3718    0  357 16167.2124 29927.3718  85.1%     -  215s
H    0     0                    16167.342965 29927.1731  85.1%     -  217s
H    0     0                    16167.929160 29927.1731  85.1%     -  217s
     0     0 29926.6351    0  357 16167.9292 29926.6351  85.1%     -  219s
     0     0 29922.6874    0  360 16167.9292 29922.6874  85.1%     -  221s
     0     0 29919.4364    0  349 16167.9292 29919.4364  85.1%     -  222s
     0     0 29918.9621    0  355 16167.9292 29918.9621  85.1%     -  223s
     0     0 29918.7381    0  352 16167.9292 29918.7381  85.0%     -  224s
     0     0 29918.3802    0  352 16167.9292 29918.3802  85.0%     -  226s
H    0     0                    16338.342470 29918.3802  83.1%     -  237s
H    0     0                    16506.072509 29918.3802  81.3%     -  237s
H    0     0                    16508.123281 29918.3802  81.2%     -  253s
     0     2 29918.3802    0  352 16508.1233 29918.3802  81.2%     -  257s
     1     4 29688.4775    1  318 16508.1233 29918.3802  81.2%  6337  271s
     3     8 29553.1131    2  315 16508.1233 29687.0987  79.8%  8275  278s
     7    16 29143.9377    3  342 16508.1233 29552.7400  79.0%  7037  286s
    15    32 28921.6364    4  347 16508.1233 29143.7859  76.5%  7222  305s
    31    49 27184.1112    5  308 16508.1233 28921.1088  75.2%  8884  326s
    48    81 27322.8026    6  320 16508.1233 28921.1088  75.2% 10115  356s
    80   113 27250.8675    7  316 16508.1233 28921.1088  75.2%  7794  370s
H   85   113                    16509.312825 28921.1088  75.2%  7660  370s
H   98   113                    18273.075006 28921.1088  58.3%  7433  370s
   112   258 27084.6166    8  308 18273.0750 28921.1088  58.3%  7196  390s
H  257   344                    18380.120730 28921.1088  57.3%  4388  404s
H  260   344                    19377.553709 28921.1088  49.3%  4370  404s
H  317   344                    19395.760890 28921.1088  49.1%  4015  404s
   351   374 26844.7931   11  293 19395.7609 28921.1088  49.1%  3890  417s
   435   405 26732.2983   14  296 19395.7609 28921.1088  49.1%  3565  429s
H  444   405                    19516.971922 28921.1088  48.2%  3571  429s
   478   463 26653.2986   13  299 19516.9719 28921.1088  48.2%  3506  440s
   546   496 26509.7729   14  285 19516.9719 28921.1088  48.2%  3412  453s
H  580   496                    19524.065982 28921.1088  48.1%  3331  453s
   585   539 26471.7647   15  303 19524.0660 28921.1088  48.1%  3324  465s
   662   571 26288.3887   15  289 19524.0660 28921.1088  48.1%  3223  476s
H  663   571                    19533.420562 28921.1088  48.1%  3218  476s
   704   631 24901.4132   14  190 19533.4206 28639.3058  46.6%  3185  488s
   794   657 25803.1104   16  280 19533.4206 28639.3058  46.6%  3019  499s
H  801   657                    19535.401068 28639.3058  46.6%  3014  499s
   846   700 26267.1089   16  274 19535.4011 28639.3058  46.6%  2965  511s
   922   720 25093.0123   17  250 19535.4011 28639.3058  46.6%  2911  523s
H  930   720                    19544.322584 28639.3058  46.5%  2912  523s
   964   778 25448.2168   17  251 19544.3226 28639.3058  46.5%  2887  536s
  1060   802 24123.5619   17  314 19544.3226 28311.6239  44.9%  2785  549s
  1100   860 24321.5256   18  216 19544.3226 28311.6239  44.9%  2781  557s
  1180   912 25694.8170   17  278 19544.3226 28311.6239  44.9%  2710  570s
  1274   980 24320.4712   19  218 19544.3226 28311.6239  44.9%  2664  583s
  1392  1023 23975.9744   24  244 19544.3226 28311.6239  44.9%  2593  599s
  1501  1093 23813.2997   26  254 19544.3226 27982.3739  43.2%  2547  612s
  1604  1154 23577.5001   29  234 19544.3226 27982.3739  43.2%  2538  627s
  1703  1234 23389.3382   32  236 19544.3226 27982.3739  43.2%  2532  641s
  1824  1321 23316.6492   38  215 19544.3226 27982.3739  43.2%  2510  656s
  1955  1413 23195.7641   39  200 19544.3226 27316.4190  39.8%  2473  673s
  2079  1474 22332.9905   41  199 19544.3226 27316.4190  39.8%  2456  690s
  2218  1534 22456.0607   49  163 19544.3226 27316.4190  39.8%  2434  709s
  2350  1551 21511.7887   56  160 19544.3226 27316.4190  39.8%  2437  725s
  2395  1580 22043.6004   59  159 19544.3226 27316.4190  39.8%  2459  740s
  2452  1594 22204.9060   57  136 19544.3226 26968.9990  38.0%  2472  758s
  2522  1625 22179.4128   58  111 19544.3226 26968.9990  38.0%  2485  775s
  2603  1659 22063.1915   59  115 19544.3226 26968.9990  38.0%  2480  789s
  2679  1733 22057.8811   60  149 19544.3226 26962.8339  38.0%  2480  806s
  2781  1787 21843.3605   69   88 19544.3226 26962.8339  38.0%  2471  822s
  2901  1849 21533.5343   78   86 19544.3226 26962.8339  38.0%  2448  840s
  3038  1908 22123.3926   13  203 19544.3226 26962.8339  38.0%  2417  856s
  3157  1960 21560.8495   16  183 19544.3226 26948.4930  37.9%  2408  875s
  3303  2007     cutoff   30      19544.3226 26920.4250  37.7%  2396  896s
  3479  2100 24307.1546    8  293 19544.3226 26731.1740  36.8%  2386  920s
  3674  2208 20004.9786    8  223 19544.3226 26645.8741  36.3%  2385  942s
  3930  2257 infeasible   10      19544.3226 26341.0067  34.8%  2346  969s
  4137  2355 23651.1067   10  220 19544.3226 26302.5480  34.6%  2349  993s
  4382  2486 20603.2929   15  207 19544.3226 26302.5480  34.6%  2342 1018s
  4690  2536 25459.8666   14  301 19544.3226 26302.5480  34.6%  2314 1041s
  4839  2606 24694.7903   15  305 19544.3226 26302.5480  34.6%  2306 1071s
  5080  2708     cutoff   17      19544.3226 26125.0711  33.7%  2315 1102s
  5302  2709 20428.8508   31  352 19544.3226 26039.1483  33.2%  2332 1169s
  5304  2710 20384.1540   52  178 19544.3226 26039.1483  33.2%  2332 1221s
  5305  2711 24836.8499   18  291 19544.3226 26039.1483  33.2%  2331 1248s
  5306  2712 20003.7547   41  309 19544.3226 26039.1483  33.2%  2331 1265s
  5307  2712 23334.6304   37  317 19544.3226 26039.1483  33.2%  2330 1273s
  5308  2713 25085.2864   12  317 19544.3226 26039.1483  33.2%  2330 1278s
  5309  2714 25618.4050   11  325 19544.3226 26039.1483  33.2%  2329 1284s
  5310  2714 23169.1101   20  338 19544.3226 26039.1483  33.2%  2329 1288s
  5311  2715 22354.7891   19  349 19544.3226 26039.1483  33.2%  2328 1292s
  5312  2716 22389.3450   20  385 19544.3226 26039.1483  33.2%  2328 1296s
  5313  2716 24145.6317   15  343 19544.3226 26039.1483  33.2%  2328 1300s
  5315  2718 22149.4846   44  355 19544.3226 26039.1483  33.2%  2327 1307s
  5316  2718 21160.7413   13  344 19544.3226 26039.1483  33.2%  2326 1313s
  5317  2719 22905.9726   14  350 19544.3226 26039.1483  33.2%  2326 1317s
  5318  2720 21245.5152   14  348 19544.3226 26039.1483  33.2%  2325 1325s
  5320  2721 23123.3061   13  337 19544.3226 26039.1483  33.2%  2325 1334s
  5321  2722 24353.1823   12  351 19544.3226 26039.1483  33.2%  2324 1336s
  5322  2722 25555.3255   18  349 19544.3226 26039.1483  33.2%  2324 1340s
  5324  2724 20117.6588   53  341 19544.3226 26039.1483  33.2%  2323 1351s
  5326  2725 23123.3061   13  341 19544.3226 26039.1483  33.2%  2322 1357s
  5327  2726 21730.0413   12  339 19544.3226 26039.1483  33.2%  2321 1360s
  5328  2726 19929.3791   42  336 19544.3226 26039.1483  33.2%  2321 1366s
  5330  2728 22637.3635   13  331 19544.3226 26039.1483  33.2%  2320 1373s
  5331  2728 20198.3410   30  340 19544.3226 26039.1483  33.2%  2320 1375s
  5333  2730 25876.0752    7  337 19544.3226 26039.1483  33.2%  2319 1427s
  5334  2730 22517.4303   20  337 19544.3226 26039.1483  33.2%  2318 1450s
  5335  2734 26039.1483   11  330 19544.3226 26039.1483  33.2%  2351 1537s
  5337  2737 26039.1483   12  334 19544.3226 26039.1483  33.2%  2351 1560s
  5341  2744 26039.1483   13  335 19544.3226 26039.1483  33.2%  2355 1577s
  5349  2757 26039.1483   14  324 19544.3226 26039.1483  33.2%  2364 1600s
  5365  2771 26039.1483   15  234 19544.3226 26039.1483  33.2%  2387 1628s
  5384  2795 26039.1483   16  322 19544.3226 26039.1483  33.2%  2417 1651s
  5416  2859 23606.3094   17  310 19544.3226 26039.1483  33.2%  2454 1675s
  5526  2874 23128.6537   19  298 19544.3226 26039.1483  33.2%  2516 1692s
  5610  2871 23162.1532   19  303 19544.3226 26039.1483  33.2%  2532 1706s
  5648  2873 22058.4470   19  234 19544.3226 26039.1483  33.2%  2538 1718s
  5706  2866 22590.2548   20  271 19544.3226 26039.1483  33.2%  2542 1734s
  5766  2851 22309.4429   20  235 19544.3226 26039.1483  33.2%  2548 1748s
  5824  2850 20867.0543   20  302 19544.3226 26039.1483  33.2%  2559 1762s
  5883  2853 22884.2077   20  289 19544.3226 26039.1483  33.2%  2571 1780s
  5934  2855     cutoff   20      19544.3226 26039.1483  33.2%  2574 1798s
  6012  2820 infeasible   21      19544.3226 26039.1483  33.2%  2592 1817s
  6090  2822 25299.8860   16  296 19544.3226 26039.1483  33.2%  2614 1831s
  6148  2812 24887.5609   17  304 19544.3226 26039.1483  33.2%  2636 1843s
  6211  2808 24754.2406   18  264 19544.3226 26039.1483  33.2%  2660 1854s
  6254  2816 23114.0219   19  252 19544.3226 26039.1483  33.2%  2678 1867s
  6312  2825 22939.9086   20  256 19544.3226 26039.1483  33.2%  2705 1882s
  6377  2818 21271.1771   22  211 19544.3226 26039.1483  33.2%  2713 1896s
  6460  2808 infeasible   24      19544.3226 26039.1483  33.2%  2726 1910s
  6533  2802 22194.4910   18  211 19544.3226 26039.1483  33.2%  2747 1931s
  6627  2784 21695.5966   19  191 19544.3226 26039.1483  33.2%  2759 1948s
  6718  2787 20923.0145   20  189 19544.3226 26039.1483  33.2%  2787 1969s
  6817  2764 20258.4069   22  192 19544.3226 26039.1483  33.2%  2799 1985s
  6890  2755 21587.0803   17  237 19544.3226 26039.1483  33.2%  2818 2003s
  6946  2752 21363.2655   18  226 19544.3226 26039.1483  33.2%  2825 2020s
  7012  2754 21148.1442   19  219 19544.3226 25951.6205  32.8%  2835 2038s
  7116  2757 21072.3166   20  229 19544.3226 25951.6205  32.8%  2837 2057s
  7240  2712 20827.3607   22  240 19544.3226 25951.6205  32.8%  2846 2077s
  7411  2659 21424.8950   21  207 19544.3226 25031.4729  28.1%  2856 2097s
  7532  2656 21749.2635   23  228 19544.3226 25031.4729  28.1%  2882 2119s
  7662  2629 20592.6121   25  179 19544.3226 24964.3612  27.7%  2909 2141s
  7840  2578 infeasible   23      19544.3226 24964.3612  27.7%  2917 2161s
  8011  2532 21895.8778   19  211 19544.3226 24964.3612  27.7%  2933 2181s
H 8072  2374                    19550.636502 24964.3612  27.7%  2939 2181s
  8145  2350 20980.5198   22  179 19550.6365 24964.3612  27.7%  2936 2199s
  8201  2348 20898.0107   23  167 19550.6365 24964.3612  27.7%  2943 2214s
  8241  2347 20381.8452   24  128 19550.6365 24964.3612  27.7%  2941 2230s
  8287  2333     cutoff   25      19550.6365 24964.3612  27.7%  2944 2248s
  8347  2310     cutoff   26      19550.6365 23652.4186  21.0%  2945 2266s
  8420  2304 22403.1640   21  233 19550.6365 23652.4186  21.0%  2949 2284s
  8487  2276 22232.3896   22  194 19550.6365 23395.1769  19.7%  2949 2308s
  8589  2236 20879.8662   23  257 19550.6365 23395.1769  19.7%  2953 2333s
  8724  2195 20594.1040   27  258 19550.6365 23186.0070  18.6%  2955 2358s
  8927  2115 21093.9753   19  260 19550.6365 23078.8155  18.0%  2958 2387s
  9179  2012 20154.6723   21  232 19550.6365 22878.9550  17.0%  2954 2413s
  9382  1921     cutoff   23      19550.6365 22654.0009  15.9%  2950 2441s
  9720  1675     cutoff   29      19550.6365 22329.8305  14.2%  2937 2471s
 10203  1252     cutoff   22      19550.6365 22140.5892  13.2%  2898 2495s
 10864   803     cutoff   24      19550.6365 21438.7360  9.66%  2806 2515s
 11390   574     cutoff   26      19550.6365 21009.0908  7.46%  2715 2525s

Cutting planes:
  MIR: 660
  Flow cover: 1129
  RLT: 7
  Relax-and-lift: 105

Explored 11566 nodes (31248134 simplex iterations) in 2525.74 seconds (4913.97 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19550.6 19544.3 19535.4 ... 18273.1

Optimal solution found (tolerance 1.00e-04)
Best objective 1.955063650218e+04, best bound 1.955063650218e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2525.79s
  Master Objective (UB) = 19550.64, θ = 154561.45
  Upper Bound (UB) = 19550.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 154561.45
  [DEBUG]   ✓ Scenario 0: θ = 154561.45 ≤ Q = 154561.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 154561.45 ≤ Q = 154561.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 154561.45 ≤ Q = 154561.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 154561.45 ≤ Q = 154561.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 154561.45 ≤ Q = 154561.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 154561.45 ≤ Q = 154561.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 154561.45 ≤ Q = 154561.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 154561.45 ≤ Q = 154561.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x253926b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0253926b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.366357e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6852872.0270
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.732512e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173251.22    0  126 6852872.03 -173251.22   103%     -    0s
H    0     0                    -135733.5833 -173251.22  27.6%     -    0s
H    0     0                    -136222.9580 -173251.22  27.2%     -    0s
     0     0 -143063.37    0  104 -136222.96 -143063.37  5.02%     -    0s
H    0     0                    -139706.4475 -143020.98  2.37%     -    0s
H    0     0                    -139982.7080 -143020.98  2.17%     -    0s
     0     0 -142530.78    0  106 -139982.71 -142530.78  1.82%     -    0s
     0     0 -142274.37    0   60 -139982.71 -142274.37  1.64%     -    0s
H    0     0                    -140762.2957 -142267.00  1.07%     -    0s
H    0     0                    -141291.1404 -142267.00  0.69%     -    0s
     0     0 -142267.00    0   59 -141291.14 -142267.00  0.69%     -    0s
     0     0 -142179.58    0   65 -141291.14 -142179.58  0.63%     -    0s
     0     0 -142149.94    0   65 -141291.14 -142149.94  0.61%     -    0s
     0     2 -142149.94    0   65 -141291.14 -142149.94  0.61%     -    0s
H   80    72                    -141297.1908 -141868.45  0.40%   7.6    0s
H  159    72                    -141315.9016 -141771.90  0.32%   6.1    0s
H 1408   165                    -141323.1905 -141496.35  0.12%   4.9    0s
H 1550   165                    -141327.9468 -141496.35  0.12%   4.8    0s
H 1796    96                    -141337.3334 -141428.69  0.06%   4.7    0s

Cutting planes:
  Gomory: 36
  Implied bound: 1
  MIR: 214
  Flow cover: 5
  RLT: 1

Explored 2170 nodes (10430 simplex iterations) in 0.39 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -141337 -141328 -141323 ... -136223
No other solutions better than -141337

Optimal solution found (tolerance 1.00e-04)
Best objective -1.413373333519e+05, best bound -1.413373333519e+05, gap 0.0000%
  Subproblem solved in 0.42s
  Worst-case operational profit (Z_SP) = 152925.33
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141337.33
  [DEBUG]   S×d_nominal = 294262.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294262.67 + -141337.33 = 152925.33
  [DEBUG]   Current θ from Master = 154561.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1636.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17914.52
  Lower Bound (LB) = 17914.52
  Gap (UB-LB) = 1636.1173, Absolute Gap = 1636.1173, Relative Gap = 0.083686
  Not converged yet (gap = 1636.12 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0x1cbac80d
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 2.48s
Presolved: 81726 rows, 35173 columns, 499754 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356024.8775
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 81726 rows, 35173 columns, 499754 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19421   -1.7122052e+05   0.000000e+00   2.951582e+06      5s
   38448   -3.1696864e+04   0.000000e+00   3.276987e+08     10s
   48017    1.0712264e+04   0.000000e+00   1.381434e+07     15s
   54966    2.1303631e+04   0.000000e+00   4.855708e+07     20s
   61780    3.1596809e+04   0.000000e+00   2.299508e+06     25s
   66397    3.4550068e+04   0.000000e+00   8.456174e+07     30s
   72231    4.0112505e+04   0.000000e+00   4.192492e+06     35s
   77554    4.1145470e+04   0.000000e+00   1.356685e+07     40s
   83750    4.2401529e+04   0.000000e+00   2.308847e+06     45s
   88733    4.3531351e+04   0.000000e+00   6.096602e+08     50s
Concurrent spin time: 5.94s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.680424e+04, 65021 iterations, 57.33 seconds (73.61 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46804.2448    0  208 -203357.92 46804.2448   123%     -   61s
H    0     0                    -198240.2828 46804.2448   124%     -   61s
H    0     0                    -78400.86491 46804.2448   160%     -   61s
H    0     0                    -77354.15463 46804.2448   161%     -   61s
H    0     0                    -23727.07557 46804.2448   297%     -   61s
H    0     0                    -23428.21823 46804.2448   300%     -   61s
H    0     0                    9968.0505880 46804.2448   370%     -   61s
H    0     0                    13086.186096 46804.2448   258%     -   61s
H    0     0                    13286.518612 46804.2448   252%     -   62s
H    0     0                    13290.669389 46804.2448   252%     -   62s
H    0     0                    13652.016269 46804.2448   243%     -   62s
H    0     0                    13679.770147 46804.2448   242%     -   62s
H    0     0                    13933.884643 41393.4323   197%     -   79s
     0     0 41393.4323    0  331 13933.8846 41393.4323   197%     -   79s
H    0     0                    13951.941644 41393.0006   197%     -   80s
     0     0 41000.9506    0  302 13951.9416 41000.9506   194%     -   86s
     0     0 40821.0733    0  336 13951.9416 40821.0733   193%     -   94s
     0     0 40715.6508    0  302 13951.9416 40715.6508   192%     -   98s
     0     0 40655.3426    0  333 13951.9416 40655.3426   191%     -  101s
     0     0 40469.8621    0  288 13951.9416 40469.8621   190%     -  106s
     0     0 40412.9894    0  330 13951.9416 40412.9894   190%     -  108s
     0     0 39981.5039    0  281 13951.9416 39981.5039   187%     -  112s
     0     0 39981.5039    0  289 13951.9416 39981.5039   187%     -  115s
     0     0 39981.5039    0  289 13951.9416 39981.5039   187%     -  115s
H    0     0                    14007.521098 39981.5039   185%     -  122s
     0     0 39981.5039    0  328 14007.5211 39981.5039   185%     -  123s
     0     0 39981.5039    0  327 14007.5211 39981.5039   185%     -  125s
     0     0 39981.5039    0  327 14007.5211 39981.5039   185%     -  125s
H    0     0                    14029.310128 36678.9575   161%     -  151s
     0     0 36635.2098    0  314 14029.3101 36635.2098   161%     -  151s
H    0     0                    15570.766733 36635.2098   135%     -  151s
     0     0 35786.2370    0  267 15570.7667 35786.2370   130%     -  170s
     0     0 35144.4836    0  332 15570.7667 35144.4836   126%     -  185s
     0     0 34906.7255    0  294 15570.7667 34906.7255   124%     -  191s
     0     0 34776.2020    0  301 15570.7667 34776.2020   123%     -  195s
     0     0 34698.6848    0  316 15570.7667 34698.6848   123%     -  200s
     0     0 34690.4542    0  310 15570.7667 34690.4542   123%     -  203s
     0     0 34687.3707    0  315 15570.7667 34687.3707   123%     -  204s
     0     0 34686.7465    0  315 15570.7667 34686.7465   123%     -  206s
H    0     0                    15650.367285 32796.1490   110%     -  235s
H    0     0                    15672.479101 32796.1490   109%     -  235s
     0     0 32796.1490    0  317 15672.4791 32796.1490   109%     -  235s
H    0     0                    15681.833682 32795.2789   109%     -  235s
     0     0 32456.9193    0  326 15681.8337 32456.9193   107%     -  244s
     0     0 32268.4937    0  340 15681.8337 32268.4937   106%     -  250s
     0     0 32207.5307    0  326 15681.8337 32207.5307   105%     -  254s
     0     0 32141.7774    0  378 15681.8337 32141.7774   105%     -  261s
     0     0 32116.1114    0  324 15681.8337 32116.1114   105%     -  265s
     0     0 32027.6716    0  336 15681.8337 32027.6716   104%     -  271s
     0     0 31990.9558    0  339 15681.8337 31990.9558   104%     -  274s
     0     0 31948.0229    0  295 15681.8337 31948.0229   104%     -  276s
     0     0 31925.9157    0  350 15681.8337 31925.9157   104%     -  279s
     0     0 31921.3047    0  345 15681.8337 31921.3047   104%     -  280s
     0     0 31918.2671    0  346 15681.8337 31918.2671   104%     -  281s
     0     0 31916.7322    0  294 15681.8337 31916.7322   104%     -  282s
     0     0 31121.8422    0  334 15681.8337 31121.8422  98.5%     -  296s
     0     0 30826.1889    0  345 15681.8337 30826.1889  96.6%     -  302s
     0     0 30739.9411    0  340 15681.8337 30739.9411  96.0%     -  307s
     0     0 30699.7857    0  342 15681.8337 30699.7857  95.8%     -  310s
H    0     0                    15847.564585 30589.9148  93.0%     -  314s
H    0     0                    15916.987344 30589.9148  92.2%     -  314s
H    0     0                    17312.421113 30589.9148  76.7%     -  314s
H    0     0                    17335.314674 30589.9148  76.5%     -  314s
H    0     0                    17344.188374 30589.9148  76.4%     -  314s
     0     0 30589.9148    0  348 17344.1884 30589.9148  76.4%     -  314s
     0     0 30547.0358    0  348 17344.1884 30547.0358  76.1%     -  318s
     0     0 30527.6418    0  355 17344.1884 30527.6418  76.0%     -  320s
     0     0 30509.3850    0  357 17344.1884 30509.3850  75.9%     -  322s
     0     0 30495.9434    0  357 17344.1884 30495.9434  75.8%     -  323s
     0     0 30481.7139    0  360 17344.1884 30481.7139  75.7%     -  325s
     0     0 30476.0638    0  357 17344.1884 30476.0638  75.7%     -  326s
     0     0 30475.2413    0  360 17344.1884 30475.2413  75.7%     -  327s
     0     0 30212.1045    0  337 17344.1884 30212.1045  74.2%     -  334s
     0     0 30161.3693    0  346 17344.1884 30161.3693  73.9%     -  338s
     0     0 30152.7875    0  352 17344.1884 30152.7875  73.8%     -  340s
     0     0 30101.8701    0  361 17344.1884 30101.8701  73.6%     -  344s
     0     0 30083.7170    0  349 17344.1884 30083.7170  73.5%     -  345s
     0     0 30072.6087    0  348 17344.1884 30072.6087  73.4%     -  346s
     0     0 30068.4102    0  354 17344.1884 30068.4102  73.4%     -  348s
     0     0 30067.6772    0  352 17344.1884 30067.6772  73.4%     -  348s
     0     0 29992.7516    0  358 17344.1884 29992.7516  72.9%     -  356s
H    0     0                    17414.117005 29992.2652  72.2%     -  360s
H    0     0                    17424.930255 29992.2652  72.1%     -  361s
     0     0 29978.8614    0  357 17424.9303 29978.8614  72.0%     -  365s
     0     0 29974.1146    0  363 17424.9303 29974.1146  72.0%     -  366s
     0     0 29972.6808    0  366 17424.9303 29972.6808  72.0%     -  367s
     0     0 29948.1218    0  356 17424.9303 29948.1218  71.9%     -  371s
     0     0 29942.9552    0  358 17424.9303 29942.9552  71.8%     -  373s
     0     0 29942.0416    0  355 17424.9303 29942.0416  71.8%     -  374s
     0     0 29937.7062    0  364 17424.9303 29937.7062  71.8%     -  376s
H    0     0                    17442.547738 29937.5728  71.6%     -  379s
H    0     0                    17462.115050 29937.5728  71.4%     -  379s
     0     0 29936.4392    0  370 17462.1150 29936.4392  71.4%     -  381s
     0     0 29934.2525    0  363 17462.1150 29934.2525  71.4%     -  384s
     0     0 29933.5938    0  365 17462.1150 29933.5938  71.4%     -  387s
     0     0 29931.9386    0  353 17462.1150 29931.9386  71.4%     -  389s
     0     0 29931.8829    0  353 17462.1150 29931.8829  71.4%     -  391s
H    0     0                    17521.515737 29931.7506  70.8%     -  433s
H    0     0                    17529.333662 29931.7506  70.8%     -  433s
H    0     0                    17566.850552 29931.7506  70.4%     -  433s
H    0     0                    17578.901337 29931.7506  70.3%     -  433s
H    0     2                    17646.968869 29931.7506  69.6%     -  444s
     0     2 29931.7506    0  353 17646.9689 29931.7506  69.6%     -  444s
     1     4 29814.1994    1  336 17646.9689 29931.1809  69.6%  2735  452s
     3     8 29675.8696    2  359 17646.9689 29814.0716  68.9%  5370  459s
     7    16 29563.6133    3  369 17646.9689 29675.5504  68.2%  6111  470s
    15    32 29299.5672    4  373 17646.9689 29558.5319  67.5%  7740  481s
    31    48 28519.3314    5  356 17646.9689 29299.0514  66.0% 10256  509s
    47    80 27694.5267    6  358 17646.9689 29299.0514  66.0% 11524  525s
    79   144 26964.3150    7  327 17646.9689 29299.0514  66.0%  9234  569s
   143   176 26772.4308    9  329 17646.9689 29299.0514  66.0%  7378  584s
   175   208 26754.8133    8  316 17646.9689 29299.0514  66.0%  6643  597s
   207   240 26757.9220   10  326 17646.9689 29299.0514  66.0%  6266  612s
   239   272 26393.3358   11  311 17646.9689 29299.0514  66.0%  6034  625s
H  260   272                    17651.166404 29299.0514  66.0%  5968  625s
   271   367 25773.1876    9  242 17651.1664 29299.0514  66.0%  5886  646s
   368   453 26323.4448   12  309 17651.1664 29299.0514  66.0%  5353  662s
   476   536 26347.4683   11  293 17651.1664 29299.0514  66.0%  4804  679s
   568   597 26266.1050   11  279 17651.1664 29299.0514  66.0%  4522  691s
   659   648 26344.1442   12  305 17651.1664 29299.0514  66.0%  4403  707s
   740   711 26270.1864   13  315 17651.1664 29299.0514  66.0%  4313  722s
   817   740 26200.0335   12  286 17651.1664 29299.0514  66.0%  4247  735s
   852   769 25926.2254   14  313 17651.1664 29299.0514  66.0%  4318  750s
   893   801 26121.5511   14  354 17651.1664 29299.0514  66.0%  4341  766s
   935   823 19699.4943   32  122 17651.1664 29299.0514  66.0%  4338  782s
   989   881 21529.0032   14  374 17651.1664 29299.0514  66.0%  4316  797s
  1055   934 25189.0954   15  313 17651.1664 29299.0514  66.0%  4266  814s
  1128   971 24833.8557   16  312 17651.1664 29299.0514  66.0%  4203  832s
  1207  1015 23264.1291   16  280 17651.1664 29299.0514  66.0%  4148  850s
  1299  1086 24549.7172   17  287 17651.1664 29299.0514  66.0%  4060  867s
H 1342  1086                    17655.340488 29299.0514  66.0%  4047  867s
  1384  1197 24382.5245   18  288 17655.3405 29299.0514  66.0%  4051  881s
  1521  1299 23849.3433   20  287 17655.3405 29299.0514  66.0%  3986  898s
  1659  1396 23384.3581   22  265 17655.3405 28945.7485  63.9%  3917  917s
  1811  1505 22959.0240   23  265 17655.3405 28945.6766  63.9%  3867  936s
  1961  1576 23612.1284   21  266 17655.3405 28945.6766  63.9%  3805  956s
  2106  1658 22692.2309   24  260 17655.3405 28945.6766  63.9%  3788  977s
  2239  1754 19954.9391   24  102 17655.3405 28878.5963  63.6%  3802  996s
  2379  1821 20104.4925   25  244 17655.3405 28878.5963  63.6%  3851 1018s
  2544  1887 21988.1524   27  302 17655.3405 28625.5884  62.1%  3835 1040s
  2660  1935 21336.6378   28  270 17655.3405 28579.7630  61.9%  3887 1062s
  2791  2023 20615.9939   36  228 17655.3405 28255.6741  60.0%  3944 1085s
  2924  2116 19494.5408   44  199 17655.3405 28255.6741  60.0%  4009 1109s
  3077  2228 19210.5972   50  192 17655.3405 28229.5328  59.9%  4057 1133s
  3282  2251 19145.3263   46  159 17655.3405 27994.7095  58.6%  4031 1158s
  3403  2329 27288.7902    6  321 17655.3405 27994.7095  58.6%  4049 1184s
  3508  2400 25531.5625    9  272 17655.3405 27994.7095  58.6%  4108 1208s
  3653  2479 22960.3149   13  178 17655.3405 27994.7095  58.6%  4171 1233s
  3828  2594 19605.9191   15   83 17655.3405 27767.8450  57.3%  4230 1263s
  4055  2695 26086.1608    8  245 17655.3405 27758.0588  57.2%  4212 1293s
  4264  2821 24371.0365   14  213 17655.3405 27620.1176  56.4%  4238 1323s
H 4454  2791                    17961.432501 27620.1176  53.8%  4299 1357s
H 4454  2594                    18511.584146 27620.1176  49.2%  4299 1357s
H 4454  2568                    18571.626852 27620.1176  48.7%  4299 1360s
H 4454  2478                    18798.714851 27620.1176  46.9%  4299 1375s
  4455  2457 21596.4899   25  353 18798.7149 27620.1176  46.9%  4298 1465s
H 4456  2335                    18803.684438 27620.1176  46.9%  4297 1474s
  4457  2335 20877.0510   16  169 18803.6844 27620.1176  46.9%  4296 1476s
H 4457  2218                    18844.386594 27620.1176  46.6%  4296 1521s
H 4457  2107                    19014.599149 27620.1176  45.3%  4296 1521s
  4459  2109 19678.6168   38  320 19014.5991 27620.1176  45.3%  4294 1562s
  4460  2109 22543.8443   23  360 19014.5991 27620.1176  45.3%  4293 1594s
  4461  2110 26844.0869    8  342 19014.5991 27620.1176  45.3%  4292 1613s
  4462  2111 22111.2979   52  335 19014.5991 27620.1176  45.3%  4291 1629s
  4463  2111 23961.8676   19  352 19014.5991 27620.1176  45.3%  4290 1643s
  4464  2112 19630.7667   62  354 19014.5991 27620.1176  45.3%  4289 1652s
  4465  2113 20304.0817   34  340 19014.5991 27620.1176  45.3%  4288 1658s
  4466  2113 19476.6211   20  354 19014.5991 27620.1176  45.3%  4287 1663s
  4467  2114 25272.3893   15  351 19014.5991 27620.1176  45.3%  4286 1669s
  4468  2115 19702.3192   25  357 19014.5991 27620.1176  45.3%  4285 1673s
  4469  2115 24250.0629   12  357 19014.5991 27620.1176  45.3%  4284 1677s
  4470  2116 21759.0292   11  360 19014.5991 27620.1176  45.3%  4283 1681s
  4472  2117 25445.3902   11  360 19014.5991 27620.1176  45.3%  4281 1689s
  4473  2118 24752.6015   17  355 19014.5991 27620.1176  45.3%  4280 1693s
  4474  2119 26755.1997    8  358 19014.5991 27620.1176  45.3%  4279 1698s
  4475  2119 26446.4362   12  368 19014.5991 27620.1176  45.3%  4278 1706s
  4477  2121 19139.5617   53  359 19014.5991 27620.1176  45.3%  4276 1713s
  4478  2121 21206.7755   38  365 19014.5991 27620.1176  45.3%  4276 1720s
  4480  2123 22031.8992   19  356 19014.5991 27620.1176  45.3%  4274 1730s
  4482  2124 19483.4851   31  363 19014.5991 27620.1176  45.3%  4272 1740s
  4484  2125 19755.8224   48  362 19014.5991 27620.1176  45.3%  4270 1753s
  4485  2126 23001.6454   16  348 19014.5991 27620.1176  45.3%  4269 1756s
  4486  2127 19493.6688   41  364 19014.5991 27620.1176  45.3%  4268 1761s
  4487  2127 24061.9835   19  364 19014.5991 27620.1176  45.3%  4267 1765s
  4488  2128 26537.7847    7  374 19014.5991 27620.1176  45.3%  4266 1779s
  4489  2129 19678.6419   41  363 19014.5991 27620.1176  45.3%  4265 1782s
  4490  2129 19204.1702   58  362 19014.5991 27620.1176  45.3%  4264 1788s
  4491  2130 25687.2437   15  340 19014.5991 27620.1176  45.3%  4263 1790s
  4493  2131 26295.7227   11  372 19014.5991 27620.1176  45.3%  4261 1814s
  4494  2132 25135.1332   20  372 19014.5991 27620.1176  45.3%  4260 1858s
  4495  2136 27620.1176   12  339 19014.5991 27620.1176  45.3%  4309 1892s
  4497  2139 27620.1176   13  334 19014.5991 27620.1176  45.3%  4309 1924s
  4501  2146 27620.1176   14  354 19014.5991 27620.1176  45.3%  4314 1952s
  4509  2159 27620.1176   15  334 19014.5991 27620.1176  45.3%  4325 1986s
  4525  2170 27620.1176   16  281 19014.5991 27620.1176  45.3%  4340 2020s
  4541  2196 26719.4340   17  265 19014.5991 27620.1176  45.3%  4378 2070s
H 4569  2080                    19026.244722 27620.1176  45.2%  4397 2070s
H 4571  1977                    19035.166239 27620.1176  45.1%  4396 2070s
  4573  2082 22245.0687   18  262 19035.1662 27620.1176  45.1%  4397 2120s
  4680  2131 21842.6164   21  243 19035.1662 27620.1176  45.1%  4414 2148s
H 4687  2032                    19059.999952 27620.1176  44.9%  4413 2148s
  4767  2050 21673.4766   20  255 19060.0000 27620.1176  44.9%  4388 2175s
  4844  2052 21502.4799   22  210 19060.0000 27620.1176  44.9%  4368 2201s
  4914  2047 20899.3111   23  203 19060.0000 27620.1176  44.9%  4355 2228s
  4989  2030     cutoff   24      19060.0000 27620.1176  44.9%  4335 2255s
  5045  2031 23087.1315   24  259 19060.0000 27620.1176  44.9%  4323 2281s
  5115  2026 21907.5370   26  262 19060.0000 27620.1176  44.9%  4309 2303s
  5182  2027 21201.7489   26  192 19060.0000 27620.1176  44.9%  4291 2336s
  5249  2022 20992.6684   27  176 19060.0000 27620.1176  44.9%  4275 2359s
H 5259  1927                    19126.149303 27620.1176  44.4%  4270 2359s
H 5281  1833                    19347.863941 27620.1176  42.8%  4262 2359s
  5312  1850 19661.6832   29  177 19347.8639 27620.1176  42.8%  4257 2381s
  5391  1839 20463.5732   28  167 19347.8639 27620.1176  42.8%  4227 2404s
H 5419  1747                    19455.892696 27620.1176  42.0%  4217 2404s
H 5460  1654                    19473.949333 27620.1176  41.8%  4201 2404s
  5480  1670     cutoff   32      19473.9493 27620.1176  41.8%  4193 2429s
  5547  1664 20761.0257   19  297 19473.9493 27620.1176  41.8%  4185 2451s
  5599  1656 20199.0687   20  271 19473.9493 27620.1176  41.8%  4174 2480s
  5673  1646 19779.8377   23  274 19473.9493 27620.1176  41.8%  4157 2508s
  5735  1660 25300.7225   18  346 19473.9493 27620.1176  41.8%  4156 2533s
  5798  1663 23543.0604   19  317 19473.9493 27620.1176  41.8%  4153 2557s
H 5800  1588                    19474.685669 27620.1176  41.8%  4154 2557s
  5846  1615     cutoff   20      19474.6857 27620.1176  41.8%  4153 2586s
H 5943  1542                    19481.292455 27620.1176  41.8%  4137 2613s
H 5945  1473                    19482.988250 27620.1176  41.8%  4137 2613s
H 5997  1392                    19520.729706 27620.1176  41.5%  4136 2613s
  6017  1420 21819.7069   24  282 19520.7297 27620.1176  41.5%  4134 2644s
  6101  1411 21299.0484   26  222 19520.7297 27620.1176  41.5%  4130 2669s
H 6119  1344                    19527.605577 27620.1176  41.4%  4130 2669s
H 6142  1279                    19537.446712 27620.1176  41.4%  4130 2669s
  6158  1318 21092.1947   27  212 19537.4467 27620.1176  41.4%  4129 2700s
  6268  1314     cutoff   30      19537.4467 27620.1176  41.4%  4113 2734s
  6371  1319     cutoff   30      19537.4467 27620.1176  41.4%  4107 2768s
  6479  1336     cutoff   21      19537.4467 26273.6034  34.5%  4098 2803s
  6613  1334 20342.9566   19  369 19537.4467 26273.6034  34.5%  4077 2843s
H 6623  1275                    19544.322584 26092.6491  33.5%  4075 2843s
  6700  1294     cutoff   19      19544.3226 26085.3843  33.5%  4077 2884s
  6852  1270     cutoff   20      19544.3226 25741.6826  31.7%  4055 2915s
  6898  1263 22703.1434   23  233 19544.3226 25741.6826  31.7%  4055 2955s
  6943  1281     cutoff   24      19544.3226 25741.6826  31.7%  4058 2994s
  7005  1273 20876.0712   25  239 19544.3226 25741.6826  31.7%  4049 3030s
  7073  1280 20855.2299   26  230 19544.3226 25633.8917  31.2%  4044 3064s
  7159  1273 20084.7544   27  219 19544.3226 25633.8917  31.2%  4027 3109s
  7271  1272 19795.5555   28  218 19544.3226 25633.8917  31.2%  3999 3148s
  7366  1267 20727.6518   27  187 19544.3226 25633.8917  31.2%  3990 3197s
  7489  1259     cutoff   28      19544.3226 25633.8917  31.2%  3974 3240s
  7582  1274 19730.8751   28  186 19544.3226 25633.8917  31.2%  3973 3282s
  7713  1298 20557.2113   29  175 19544.3226 24980.4152  27.8%  3960 3329s
  7879  1319 19777.2617   29  214 19544.3226 24980.4152  27.8%  3930 3374s
  7950  1297     cutoff   30      19544.3226 24973.0257  27.8%  3926 3422s
  8055  1306     cutoff   31      19544.3226 24711.7669  26.4%  3913 3464s
  8124  1323 22677.7372   20  174 19544.3226 24688.0816  26.3%  3911 3510s
  8244  1388 21651.1051   21  206 19544.3226 24596.4271  25.8%  3899 3567s
  8466  1412 19699.4020   28  244 19544.3226 24573.0578  25.7%  3864 3600s

Cutting planes:
  Learned: 1
  Gomory: 15
  Implied bound: 16
  Projected implied bound: 61
  MIR: 1108
  Mixing: 1
  Flow cover: 1762
  RLT: 26
  Relax-and-lift: 194

Explored 8600 nodes (33402618 simplex iterations) in 3600.06 seconds (6281.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19544.3 19537.4 19527.6 ... 19347.9

Time limit reached
Best objective 1.954432258434e+04, best bound 2.457305780734e+04, gap 25.7299%
  WARNING: Time limit reached. Using best solution found (gap: 25.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 19544.32, θ = 154042.48
  Upper Bound (UB) = 19544.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 154042.48
  [DEBUG]   ✓ Scenario 0: θ = 154042.48 ≤ Q = 154042.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 154042.48 ≤ Q = 154042.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 154042.48 ≤ Q = 154042.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 154042.48 ≤ Q = 154042.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 154042.48 ≤ Q = 154042.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 154042.48 ≤ Q = 154042.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 154042.48 ≤ Q = 154042.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 154042.48 ≤ Q = 154042.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 154042.48 ≤ Q = 154042.48 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6b751274
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6b751274
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.368081e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6837264.4401
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.740599e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174059.92    0  127 6837264.44 -174059.92   103%     -    0s
H    0     0                    -136476.4427 -174059.92  27.5%     -    0s
H    0     0                    -136965.8173 -174059.92  27.1%     -    0s
     0     0 -146152.35    0  107 -136965.82 -146152.35  6.71%     -    0s
H    0     0                    -141433.1918 -146140.96  3.33%     -    0s
H    0     0                    -141709.4523 -146140.96  3.13%     -    0s
H    0     0                    -142917.3767 -146140.96  2.26%     -    0s
H    0     0                    -143193.6372 -146140.96  2.06%     -    0s
     0     0 -145300.82    0  112 -143193.64 -145300.82  1.47%     -    0s
H    0     0                    -143346.0718 -144999.59  1.15%     -    0s
     0     0 -144999.59    0  104 -143346.07 -144999.59  1.15%     -    0s
H    0     0                    -143415.2778 -144921.31  1.05%     -    0s
     0     0 -144921.31    0  110 -143415.28 -144921.31  1.05%     -    0s
     0     0 -144893.85    0  110 -143415.28 -144893.85  1.03%     -    0s
     0     0 -144893.78    0  110 -143415.28 -144893.78  1.03%     -    0s
     0     0 -144744.23    0   97 -143415.28 -144744.23  0.93%     -    0s
H    0     0                    -143920.9522 -144740.93  0.57%     -    0s
H    0     0                    -144161.2994 -144740.93  0.40%     -    0s
     0     0 -144719.08    0  105 -144161.30 -144719.08  0.39%     -    0s
     0     0 -144718.60    0  105 -144161.30 -144718.60  0.39%     -    0s
     0     0 -144631.06    0   46 -144161.30 -144631.06  0.33%     -    0s
     0     0 -144565.54    0   47 -144161.30 -144565.54  0.28%     -    0s
     0     0 -144560.73    0   46 -144161.30 -144560.73  0.28%     -    0s
     0     0 -144499.55    0   47 -144161.30 -144499.55  0.23%     -    0s
     0     0 -144489.53    0   47 -144161.30 -144489.53  0.23%     -    0s
     0     2 -144489.53    0   47 -144161.30 -144489.53  0.23%     -    0s
H  174     0                    -144163.5753 -144182.75  0.01%   5.6    0s

Cutting planes:
  Gomory: 28
  Implied bound: 1
  MIR: 157
  Flow cover: 20
  RLT: 17
  BQP: 1

Explored 191 nodes (1843 simplex iterations) in 0.25 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -144164 -144161 -143921 ... 6.83726e+06
No other solutions better than -144164

Optimal solution found (tolerance 1.00e-04)
Best objective -1.441635752780e+05, best bound -1.441635752780e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 150321.21
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144163.58
  [DEBUG]   S×d_nominal = 294484.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294484.78 + -144163.58 = 150321.21
  [DEBUG]   Current θ from Master = 154042.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3721.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15823.05
  Lower Bound (LB) = 17914.52
  Gap (UB-LB) = 1629.8034, Absolute Gap = 1629.8034, Relative Gap = 0.083390
  Not converged yet (gap = 1629.80 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0xe972081b
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.70s
Presolved: 90653 rows, 38830 columns, 550619 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364386.3278
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.964e+06
 Factor NZ  : 8.602e+06 (roughly 120 MB of memory)
 Factor Ops : 1.498e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.98088971e+07  1.69267224e+08  1.10e+05 2.72e+01  8.84e+04     4s
   1  -1.49439886e+07  1.51834511e+08  7.79e+04 7.55e+01  6.22e+04     5s
   2  -5.54913338e+06  1.10233281e+08  2.90e+04 5.26e+00  2.46e+04     5s
   3  -9.86930331e+05  8.33942117e+07  2.29e+03 9.32e-01  2.35e+03     5s
   4  -4.82587870e+05  3.94597341e+07  3.87e+02 3.07e-01  5.18e+02     5s
   5  -3.90458167e+05  2.28427801e+07  1.76e+02 1.47e-01  2.53e+02     5s
   6  -3.00142267e+05  1.62062266e+07  8.38e+01 9.81e-02  1.48e+02     5s
   7  -1.78470360e+05  1.16207038e+07  3.01e+01 6.62e-02  8.59e+01     5s
   8  -1.27224748e+05  8.54480472e+06  1.51e+01 4.71e-02  5.83e+01     5s
   9  -9.39930258e+04  5.52158355e+06  8.11e+00 2.93e-02  3.61e+01     5s
  10  -6.95155584e+04  2.06249409e+06  4.21e+00 1.02e-02  1.34e+01     5s
  11  -3.07700999e+04  5.57981357e+05  1.21e+00 2.57e-03  3.60e+00     5s
  12  -1.32050924e+04  3.37711502e+05  8.26e-01 1.45e-03  2.13e+00     5s
  13  -5.25657190e+03  2.02994634e+05  6.03e-01 1.33e-03  1.26e+00     5s
  14  -1.48089293e+03  1.67729524e+05  5.35e-01 1.47e-03  1.03e+00     5s
  15   5.94700789e+03  1.26296158e+05  4.16e-01 1.07e-03  7.29e-01     6s
  16   1.34891213e+04  9.79449371e+04  3.21e-01 2.33e-03  5.11e-01     6s
  17   2.01753443e+04  8.53903851e+04  2.46e-01 2.06e-03  3.95e-01     6s
  18   2.56354926e+04  7.39829052e+04  1.87e-01 2.28e-03  2.92e-01     6s
  19   3.12032511e+04  6.57292302e+04  1.34e-01 1.79e-03  2.09e-01     6s
  20   3.41623657e+04  6.28539512e+04  1.08e-01 1.83e-03  1.73e-01     6s
  21   3.67765113e+04  5.92885622e+04  8.52e-02 1.70e-03  1.36e-01     6s
  22   3.96812197e+04  5.62671948e+04  6.07e-02 1.37e-03  1.00e-01     6s
  23   4.08656308e+04  5.47514899e+04  5.13e-02 1.07e-03  8.39e-02     6s
  24   4.23867965e+04  5.23927398e+04  3.94e-02 1.46e-03  6.05e-02     6s
  25   4.35500825e+04  5.14281844e+04  3.06e-02 1.47e-03  4.76e-02     6s
  26   4.44013390e+04  5.03756913e+04  2.45e-02 1.06e-03  3.61e-02     6s
  27   4.50735101e+04  4.99823251e+04  1.96e-02 8.81e-04  2.97e-02     6s
  28   4.52821971e+04  4.92158997e+04  1.81e-02 8.86e-04  2.38e-02     7s
  29   4.60989687e+04  4.91473429e+04  1.27e-02 8.31e-04  1.84e-02     7s
  30   4.64095989e+04  4.88534326e+04  1.06e-02 6.33e-04  1.48e-02     7s
  31   4.68184986e+04  4.86773175e+04  7.87e-03 5.15e-04  1.12e-02     7s
  32   4.69725784e+04  4.85321075e+04  6.79e-03 3.91e-04  9.43e-03     7s
  33   4.72222772e+04  4.84470497e+04  5.15e-03 3.19e-04  7.40e-03     7s
  34   4.75311185e+04  4.83836284e+04  3.19e-03 2.61e-04  5.15e-03     7s
  35   4.76173247e+04  4.82608569e+04  2.67e-03 1.63e-04  3.89e-03     7s
  36   4.77286532e+04  4.82328268e+04  1.97e-03 1.40e-04  3.05e-03     7s
  37   4.78853158e+04  4.81838548e+04  1.01e-03 9.84e-05  1.80e-03     7s
  38   4.79434736e+04  4.81722587e+04  6.59e-04 8.90e-05  1.38e-03     8s
  39   4.79827541e+04  4.81148282e+04  4.21e-04 4.11e-05  7.97e-04     8s
  40   4.79935681e+04  4.81006715e+04  3.61e-04 3.00e-05  6.46e-04     8s
  41   4.79979333e+04  4.80936216e+04  3.36e-04 2.44e-05  5.78e-04     8s
  42   4.80162443e+04  4.80832153e+04  2.38e-04 1.72e-05  4.04e-04     8s
  43   4.80374366e+04  4.80719703e+04  1.29e-04 7.22e-06  2.09e-04     8s
  44   4.80410354e+04  4.80672133e+04  1.11e-04 3.12e-06  1.58e-04     8s
  45   4.80469310e+04  4.80660458e+04  7.94e-05 2.28e-06  1.15e-04     8s
  46   4.80538944e+04  4.80657897e+04  4.41e-05 2.06e-06  7.18e-05     8s
  47   4.80553826e+04  4.80644038e+04  3.65e-05 1.12e-06  5.45e-05     8s
  48   4.80595990e+04  4.80628694e+04  1.48e-05 1.14e-06  1.98e-05     9s
  49   4.80613954e+04  4.80627555e+04  5.95e-06 5.08e-07  8.22e-06     9s
  50   4.80624622e+04  4.80626902e+04  8.08e-07 4.33e-08  1.38e-06     9s
  51   4.80626610e+04  4.80626618e+04  1.13e-07 3.46e-08  4.62e-09     9s
  52   4.80626611e+04  4.80626611e+04  8.41e-10 1.19e-10  2.75e-12     9s

Barrier solved model in 52 iterations and 8.86 seconds (8.26 work units)
Optimal objective 4.80626611e+04


Root crossover log...

   79633 DPushes remaining with DInf 0.0000000e+00                 9s
     814 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

     990 PPushes remaining with PInf 2.8281164e-07                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.6284742e-11     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29826    4.8062661e+04   0.000000e+00   0.000000e+00     10s
   29826    4.8062661e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.806266e+04, 29826 iterations, 6.97 seconds (7.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48062.6611    0  218 -203357.92 48062.6611   124%     -   10s
H    0     0                    -200643.4677 48062.6611   124%     -   11s
H    0     0                    -156566.6702 48062.6611   131%     -   11s
H    0     0                    -97627.80772 48062.6611   149%     -   11s
H    0     0                    -89402.78905 48062.6611   154%     -   11s
H    0     0                    -88507.92659 48062.6611   154%     -   11s
H    0     0                    -88097.77373 48062.6611   155%     -   11s
H    0     0                    -87817.14542 48062.6611   155%     -   11s
H    0     0                    -26310.63842 48062.6611   283%     -   11s
H    0     0                    -1398.424946 48062.6611  3537%     -   11s
H    0     0                    11924.137409 48062.6611   303%     -   11s
H    0     0                    12054.490695 48062.6611   299%     -   11s
H    0     0                    14144.545971 48062.6611   240%     -   12s
H    0     0                    14161.492164 42059.1488   197%     -   60s
H    0     0                    14164.809610 42059.1488   197%     -   60s
H    0     0                    14176.018608 42059.1488   197%     -   60s
H    0     0                    14179.336053 42059.1488   197%     -   60s
H    0     0                    14253.859929 42059.1488   195%     -   60s
H    0     0                    14257.177375 42059.1488   195%     -   60s
H    0     0                    14370.394371 42059.1488   193%     -   60s
H    0     0                    14373.711816 42059.1488   193%     -   60s
     0     0 42040.7039    0  367 14373.7118 42040.7039   192%     -   60s
     0     0 41443.0549    0  317 14373.7118 41443.0549   188%     -   86s
     0     0 41351.8476    0  313 14373.7118 41351.8476   188%     -   94s
     0     0 41351.8476    0  315 14373.7118 41351.8476   188%     -   96s
     0     0 41134.4023    0  313 14373.7118 41134.4023   186%     -  102s
     0     0 41134.4023    0  321 14373.7118 41134.4023   186%     -  107s
     0     0 41134.4023    0  318 14373.7118 41134.4023   186%     -  112s
     0     0 41134.4023    0  327 14373.7118 41134.4023   186%     -  114s
     0     0 41134.4023    0  326 14373.7118 41134.4023   186%     -  115s
H    0     0                    14451.080299 37728.8776   161%     -  154s
     0     0 37728.8776    0  357 14451.0803 37728.8776   161%     -  154s
H    0     0                    15625.334632 37728.3324   141%     -  155s
H    0     0                    15650.233765 37728.3324   141%     -  155s
H    0     0                    15689.631260 37728.3324   140%     -  155s
     0     0 36778.7382    0  388 15689.6313 36778.7382   134%     -  184s
     0     0 36548.8323    0  377 15689.6313 36548.8323   133%     -  205s
     0     0 36429.0005    0  365 15689.6313 36429.0005   132%     -  219s
     0     0 36404.9290    0  367 15689.6313 36404.9290   132%     -  224s
     0     0 36352.0366    0  373 15689.6313 36352.0366   132%     -  227s
     0     0 36337.8284    0  366 15689.6313 36337.8284   132%     -  232s
     0     0 36335.1342    0  362 15689.6313 36335.1342   132%     -  235s
     0     0 36330.1616    0  365 15689.6313 36330.1616   132%     -  237s
     0     0 36328.5038    0  367 15689.6313 36328.5038   132%     -  238s
     0     0 36261.1812    0  362 15689.6313 36261.1812   131%     -  242s
     0     0 36241.2319    0  368 15689.6313 36241.2319   131%     -  245s
     0     0 36238.6723    0  364 15689.6313 36238.6723   131%     -  247s
     0     0 36238.2802    0  363 15689.6313 36238.2802   131%     -  247s
     0     0 33704.6474    0  358 15689.6313 33704.6474   115%     -  307s
H    0     0                    15796.518613 33704.6307   113%     -  307s
H    0     0                    15839.838283 33704.6307   113%     -  307s
H    0     0                    16004.649507 33704.6307   111%     -  307s
H    0     0                    16083.925755 33704.6307   110%     -  307s
     0     0 32994.8875    0  366 16083.9258 32994.8875   105%     -  330s
     0     0 32823.4847    0  360 16083.9258 32823.4847   104%     -  339s
     0     0 32729.2508    0  361 16083.9258 32729.2508   103%     -  346s
     0     0 32694.5744    0  375 16083.9258 32694.5744   103%     -  351s
     0     0 32629.1756    0  361 16083.9258 32629.1756   103%     -  356s
     0     0 32607.9679    0  365 16083.9258 32607.9679   103%     -  358s
     0     0 32539.8848    0  345 16083.9258 32539.8848   102%     -  365s
     0     0 32506.5452    0  349 16083.9258 32506.5452   102%     -  370s
     0     0 32464.8597    0  353 16083.9258 32464.8597   102%     -  375s
     0     0 32375.8501    0  359 16083.9258 32375.8501   101%     -  382s
     0     0 32358.5836    0  370 16083.9258 32358.5836   101%     -  385s
     0     0 32342.3939    0  371 16083.9258 32342.3939   101%     -  389s
     0     0 32332.7409    0  374 16083.9258 32332.7409   101%     -  392s
     0     0 32328.3389    0  373 16083.9258 32328.3389   101%     -  393s
     0     0 32295.0924    0  364 16083.9258 32295.0924   101%     -  399s
     0     0 32289.4329    0  373 16083.9258 32289.4329   101%     -  401s
     0     0 32287.4906    0  361 16083.9258 32287.4906   101%     -  403s
     0     0 31343.0821    0  344 16083.9258 31343.0821  94.9%     -  433s
H    0     0                    16099.439466 31339.5519  94.7%     -  433s
     0     0 31177.1037    0  359 16099.4395 31177.1037  93.7%     -  443s
     0     0 31096.1838    0  374 16099.4395 31096.1838  93.2%     -  450s
     0     0 31057.6181    0  379 16099.4395 31057.6181  92.9%     -  455s
     0     0 31041.2445    0  391 16099.4395 31041.2445  92.8%     -  459s
     0     0 31020.6802    0  370 16099.4395 31020.6802  92.7%     -  463s
     0     0 31003.8232    0  359 16099.4395 31003.8232  92.6%     -  466s
     0     0 30935.9330    0  359 16099.4395 30935.9330  92.2%     -  470s
     0     0 30925.0197    0  370 16099.4395 30925.0197  92.1%     -  472s
     0     0 30922.3833    0  377 16099.4395 30922.3833  92.1%     -  473s
     0     0 30773.5628    0  424 16099.4395 30773.5628  91.1%     -  484s
H    0     0                    16123.751257 30773.5622  90.9%     -  485s
     0     0 30721.1586    0  435 16123.7513 30721.1586  90.5%     -  491s
     0     0 30698.5993    0  378 16123.7513 30698.5993  90.4%     -  495s
     0     0 30634.9417    0  416 16123.7513 30634.9417  90.0%     -  505s
     0     0 30612.6306    0  408 16123.7513 30612.6306  89.9%     -  510s
     0     0 30600.8549    0  424 16123.7513 30600.8549  89.8%     -  513s
     0     0 30597.8337    0  416 16123.7513 30597.8337  89.8%     -  515s
     0     0 30595.8487    0  420 16123.7513 30595.8487  89.8%     -  517s
     0     0 30454.9010    0  418 16123.7513 30454.9010  88.9%     -  528s
H    0     0                    16190.255084 30454.6926  88.1%     -  531s
     0     0 30382.0422    0  431 16190.2551 30382.0422  87.7%     -  538s
     0     0 30352.5011    0  428 16190.2551 30352.5011  87.5%     -  544s
     0     0 30329.4998    0  430 16190.2551 30329.4998  87.3%     -  548s
     0     0 30326.2331    0  429 16190.2551 30326.2331  87.3%     -  549s
     0     0 30323.7494    0  429 16190.2551 30323.7494  87.3%     -  551s
     0     0 30206.2038    0  370 16190.2551 30206.2038  86.6%     -  564s
     0     0 30196.4897    0  380 16190.2551 30196.4897  86.5%     -  568s
     0     0 30186.8892    0  378 16190.2551 30186.8892  86.5%     -  571s
     0     0 30175.9939    0  374 16190.2551 30175.9939  86.4%     -  576s
     0     0 30171.2236    0  373 16190.2551 30171.2236  86.4%     -  583s
     0     0 30169.9973    0  374 16190.2551 30169.9973  86.3%     -  585s
     0     0 30120.6530    0  376 16190.2551 30120.6530  86.0%     -  593s
     0     0 30106.9177    0  366 16190.2551 30106.9177  86.0%     -  599s
     0     0 30105.6443    0  362 16190.2551 30105.6443  85.9%     -  600s
     0     0 30027.9603    0  358 16190.2551 30027.9603  85.5%     -  610s
     0     0 29997.0924    0  363 16190.2551 29997.0924  85.3%     -  618s
     0     0 29989.8387    0  401 16190.2551 29989.8387  85.2%     -  623s
     0     0 29985.5189    0  406 16190.2551 29985.5189  85.2%     -  625s
     0     0 29978.6977    0  403 16190.2551 29978.6977  85.2%     -  628s
     0     0 29974.6507    0  382 16190.2551 29974.6507  85.1%     -  630s
     0     0 29973.3958    0  370 16190.2551 29973.3958  85.1%     -  631s
     0     0 29951.1348    0  379 16190.2551 29951.1348  85.0%     -  636s
     0     0 29940.5395    0  390 16190.2551 29940.5395  84.9%     -  640s
     0     0 29938.2717    0  396 16190.2551 29938.2717  84.9%     -  643s
     0     0 29918.7717    0  378 16190.2551 29918.7717  84.8%     -  648s
     0     0 29907.8324    0  416 16190.2551 29907.8324  84.7%     -  652s
     0     0 29905.7245    0  366 16190.2551 29905.7245  84.7%     -  654s
     0     0 29897.2755    0  419 16190.2551 29897.2755  84.7%     -  658s
H    0     0                    16905.715285 29897.2707  76.8%     -  665s
H    0     0                    16960.564533 29897.2707  76.3%     -  666s
H    0     0                    17421.680355 29897.2707  71.6%     -  666s
H    0     0                    17596.542241 29897.2707  69.9%     -  666s
H    0     0                    17645.779564 29897.2707  69.4%     -  666s
     0     0 29893.7889    0  374 17645.7796 29893.7889  69.4%     -  667s
     0     0 29891.8322    0  415 17645.7796 29891.8322  69.4%     -  668s
     0     0 29887.3941    0  354 17645.7796 29887.3941  69.4%     -  672s
     0     0 29887.0017    0  354 17645.7796 29887.0017  69.4%     -  676s
H    0     0                    18233.621855 29887.0017  63.9%     -  708s
H    0     0                    18563.802073 29887.0017  61.0%     -  741s
H    0     0                    18724.718940 29887.0017  59.6%     -  747s
H    0     2                    18779.145054 29887.0017  59.1%     -  749s
     0     2 29887.0017    0  354 18779.1451 29887.0017  59.1%     -  749s
     1     3 29675.5880    1  347 18779.1451 29887.0017  59.1%  8292  759s
     2     4 29665.1178    1  406 18779.1451 29675.5797  58.0%  8176  770s
     3     7 28220.7232    2  395 18779.1451 29675.2610  58.0%  8973  785s
     6    14 28504.6719    3  409 18779.1451 29664.7660  58.0%  9796  807s
    13    28 28044.1719    4  349 18779.1451 29060.3779  54.7%  8930  832s
    27    42 27284.7582    5  376 18779.1451 28630.8306  52.5% 15515  894s
    41    73 26708.7258    6  294 18779.1451 28630.8306  52.5% 13983 1028s
    72   127 25692.7721    7  337 18779.1451 28513.6930  51.8% 16326 1073s
H   92   127                    18913.304615 28513.6930  50.8% 13476 1073s
   126   159 25585.4573    8  338 18913.3046 28458.7682  50.5% 11530 1107s
H  133   159                    19050.999608 28458.7682  49.4% 11169 1107s
   158   259 25113.1217    8  319 19050.9996 28458.7682  49.4% 10594 1147s
   258   357 25181.7646   12  299 19050.9996 28458.7682  49.4%  8561 1179s
   356   416 25066.6983   13  273 19050.9996 28458.7682  49.4%  7560 1204s
   423   495 24901.9346   13  277 19050.9996 28458.7682  49.4%  7320 1227s
   514   550 24770.2636   12  286 19050.9996 28458.7682  49.4%  6841 1248s
   585   611 24854.6516   14  281 19050.9996 28458.7682  49.4%  6678 1265s
   672   646 24619.3758   14  275 19050.9996 28458.7682  49.4%  6482 1283s
   748   696 24640.8224   15  268 19050.9996 28458.7682  49.4%  6497 1303s
   820   761 24701.2531   15  280 19050.9996 28458.7682  49.4%  6427 1322s
   903   844 24336.6086   16  267 19050.9996 28458.7682  49.4%  6324 1338s
  1002   875 24121.8579   16  262 19050.9996 28458.7682  49.4%  6091 1360s
  1053   959 24194.1048   17  257 19050.9996 28458.7682  49.4%  6011 1379s
  1171  1046 24021.9560   18  268 19050.9996 27792.0866  45.9%  5771 1397s
H 1174  1046                    19058.093667 27792.0866  45.8%  5759 1397s
  1282  1121 24111.8053   20  257 19058.0937 27792.0866  45.8%  5554 1417s
  1413  1195 23574.8128   24  245 19058.0937 27792.0866  45.8%  5352 1435s
  1536  1238 23212.6117   25  255 19058.0937 27792.0866  45.8%  5288 1454s
H 1575  1238                    19064.969539 27792.0866  45.8%  5234 1454s
  1607  1337 23207.5312   25  240 19064.9695 27792.0866  45.8%  5246 1476s
  1740  1427 23044.2855   24  247 19064.9695 27792.0866  45.8%  5163 1498s
  1891  1507 22951.6280   26  257 19064.9695 27792.0866  45.8%  5042 1522s
  2023  1586 22746.6672   27  245 19064.9695 27722.9784  45.4%  4996 1547s
  2148  1682 22981.6231   26  252 19064.9695 27576.6532  44.6%  4985 1570s
  2278  1773 22162.7300   33  213 19064.9695 27576.6532  44.6%  4955 1596s
  2417  1796 22017.0492   34  196 19064.9695 27576.6532  44.6%  4959 1620s
  2454  1815 21978.2391   34  227 19064.9695 27576.6532  44.6%  5018 1643s
  2499  1843 21697.9164   35  262 19064.9695 27576.6532  44.6%  5062 1669s
  2539  1876 21903.0092   35  203 19064.9695 27445.8184  44.0%  5130 1691s
  2586  1913 21771.6350   36  213 19064.9695 27350.8126  43.5%  5148 1714s
  2633  1950     cutoff   36      19064.9695 27350.8126  43.5%  5161 1741s
  2706  1996 21664.7596   36  203 19064.9695 27350.8126  43.5%  5159 1769s
  2820  2071 21179.7860   39  203 19064.9695 27350.8126  43.5%  5110 1797s
  2933  2160 20333.4365   42  207 19064.9695 27234.6990  42.9%  5103 1829s
  3058  2277 20953.1958   49  214 19064.9695 27232.8439  42.8%  5108 1859s
  3219  2401 20676.5385   53  206 19064.9695 27216.7955  42.8%  5121 1891s
  3379  2542 20080.3499   59  179 19064.9695 27216.7955  42.8%  5173 1922s
  3573  2543 23356.6719   26  354 19064.9695 27101.0907  42.2%  5169 2067s
  3575  2544 24834.3615   27  192 19064.9695 27101.0907  42.2%  5166 2080s
  3576  2545 20311.2114   29  318 19064.9695 27101.0907  42.2%  5165 2160s
  3577  2546 19990.3546   30  367 19064.9695 27101.0907  42.2%  5164 2229s
  3578  2546 25508.6754   13  339 19064.9695 27101.0907  42.2%  5162 2266s
  3579  2547 26332.7641   11  345 19064.9695 27101.0907  42.2%  5161 2287s
  3580  2548 19535.2105   48  352 19064.9695 27101.0907  42.2%  5159 2307s
  3581  2548 26056.3887   12  374 19064.9695 27101.0907  42.2%  5158 2318s
  3582  2549 25448.4066    9  361 19064.9695 27101.0907  42.2%  5156 2329s
  3583  2550 21168.5179   40  364 19064.9695 27101.0907  42.2%  5155 2338s
  3584  2550 20348.1143   41  361 19064.9695 27101.0907  42.2%  5153 2343s
  3585  2551 24799.4130   24  370 19064.9695 27101.0907  42.2%  5152 2347s
  3586  2552 19694.5522   49  372 19064.9695 27101.0907  42.2%  5151 2353s
  3587  2552 19735.6308   45  372 19064.9695 27101.0907  42.2%  5149 2357s
  3588  2553 20609.5076   30  365 19064.9695 27101.0907  42.2%  5148 2360s
  3589  2554 25154.9609    8  378 19064.9695 27101.0907  42.2%  5146 2378s
  3590  2554 26336.0943    7  369 19064.9695 27101.0907  42.2%  5145 2386s
  3591  2555 21006.6710   15  383 19064.9695 27101.0907  42.2%  5143 2390s
  3593  2556 21468.8918   19  369 19064.9695 27101.0907  42.2%  5141 2409s
  3594  2557 21246.9272   33  364 19064.9695 27101.0907  42.2%  5139 2413s
  3595  2558 20490.6541   17  377 19064.9695 27101.0907  42.2%  5138 2418s
  3596  2558 24633.3629   16  345 19064.9695 27101.0907  42.2%  5136 2431s
  3597  2559 20330.4490   43  367 19064.9695 27101.0907  42.2%  5135 2439s
  3598  2560 20236.5724   32  350 19064.9695 27101.0907  42.2%  5133 2445s
  3599  2560 21856.2373   42  369 19064.9695 27101.0907  42.2%  5132 2457s
  3600  2561 22786.3479   25  347 19064.9695 27101.0907  42.2%  5131 2461s
  3601  2562 26223.6672   17  375 19064.9695 27101.0907  42.2%  5129 2469s
  3602  2562 24798.0149   18  370 19064.9695 27101.0907  42.2%  5128 2484s
  3603  2563 22614.6196   28  384 19064.9695 27101.0907  42.2%  5126 2491s
  3604  2564 22800.5722   22  372 19064.9695 27101.0907  42.2%  5125 2495s
  3605  2564 20656.4235   49  361 19064.9695 27101.0907  42.2%  5123 2503s
  3606  2565 20823.4488   27  427 19064.9695 27101.0907  42.2%  5122 2511s
  3607  2566 21386.7997   50  374 19064.9695 27101.0907  42.2%  5121 2524s
  3608  2566 21483.5861   33  376 19064.9695 27101.0907  42.2%  5119 2527s
  3609  2567 23878.8830   20  377 19064.9695 27101.0907  42.2%  5118 2533s
  3610  2568 20448.1022   31  376 19064.9695 27101.0907  42.2%  5116 2536s
  3611  2568 20114.2059   37  379 19064.9695 27101.0907  42.2%  5115 2541s
  3612  2569 19384.4961   21  379 19064.9695 27101.0907  42.2%  5113 2561s
  3613  2570 22472.8280   30  379 19064.9695 27101.0907  42.2%  5112 2634s
  3614  2573 27101.0907   14  378 19064.9695 27101.0907  42.2%  5198 2719s
  3616  2577 27101.0907   15  376 19064.9695 27101.0907  42.2%  5198 2749s
  3620  2583 27101.0907   16  364 19064.9695 27101.0907  42.2%  5209 2790s
  3628  2597 27101.0907   17  394 19064.9695 27101.0907  42.2%  5219 2850s
  3644  2607 27101.0907   18  387 19064.9695 27101.0907  42.2%  5282 2904s
  3660  2634 27101.0907   19  346 19064.9695 27101.0907  42.2%  5347 2970s
  3692  2709 25613.7204   20  362 19064.9695 27101.0907  42.2%  5358 3019s
  3780  2711 25221.9280   22  393 19064.9695 27101.0907  42.2%  5487 3047s
  3811  2739 24105.2636   22  333 19064.9695 27101.0907  42.2%  5482 3083s
  3858  2754 19311.4476   21  299 19064.9695 27101.0907  42.2%  5494 3112s
  3890  2768 24209.6450   23  351 19064.9695 27101.0907  42.2%  5492 3139s
  3926  2779 23274.4987   23  312 19064.9695 27101.0907  42.2%  5492 3171s
  3968  2789 23090.0107   23  290 19064.9695 27101.0907  42.2%  5485 3201s
  4010  2812 23791.0362   24  351 19064.9695 27101.0907  42.2%  5470 3237s
  4059  2818 22827.0571   25  301 19064.9695 27101.0907  42.2%  5442 3265s
  4107  2820 22679.1347   27  295 19064.9695 27101.0907  42.2%  5416 3298s
  4159  2812 22100.2228   30  258 19064.9695 27101.0907  42.2%  5395 3339s
  4210  2811 21911.0588   31  265 19064.9695 27101.0907  42.2%  5398 3372s
  4263  2819 21468.7648   32  253 19064.9695 27101.0907  42.2%  5388 3406s
  4323  2830 21545.7631   33  244 19064.9695 27101.0907  42.2%  5369 3438s
  4387  2832 21271.3499   36  301 19064.9695 27101.0907  42.2%  5342 3465s
  4461  2813 20909.3890   38  295 19064.9695 27101.0907  42.2%  5312 3497s
  4536  2810 19215.4179   40  167 19064.9695 27101.0907  42.2%  5287 3544s
  4604  2812     cutoff   41      19064.9695 27101.0907  42.2%  5276 3579s
  4707  2776     cutoff   44      19064.9695 27101.0907  42.2%  5229 3600s

Cutting planes:
  Gomory: 37
  Implied bound: 37
  Projected implied bound: 226
  MIR: 1292
  Mixing: 10
  Flow cover: 1640
  Inf proof: 1
  RLT: 36
  Relax-and-lift: 294

Explored 4752 nodes (25334831 simplex iterations) in 3600.05 seconds (5981.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19065 19058.1 19051 ... 17596.5

Time limit reached
Best objective 1.906496953913e+04, best bound 2.710109071876e+04, gap 42.1512%
  WARNING: Time limit reached. Using best solution found (gap: 42.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 19064.97, θ = 155761.25
  Upper Bound (UB) = 19064.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155761.25
  [DEBUG]   ✓ Scenario 0: θ = 155761.25 ≤ Q = 155761.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155761.25 ≤ Q = 155761.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155761.25 ≤ Q = 155761.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 155761.25 ≤ Q = 155761.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 155761.25 ≤ Q = 155761.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 155761.25 ≤ Q = 155761.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 155761.25 ≤ Q = 155761.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 155761.25 ≤ Q = 155761.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 155761.25 ≤ Q = 155761.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 155761.25 ≤ Q = 155761.25 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x79cfb8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0079cfb8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.360503e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6653930.7905
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.730286e+05, 274 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173028.60    0  132 6653930.79 -173028.60   103%     -    0s
H    0     0                    -134922.2716 -173028.60  28.2%     -    0s
H    0     0                    -135194.3751 -173028.60  28.0%     -    0s
     0     0 -148556.72    0   52 -135194.38 -148556.72  9.88%     -    0s
H    0     0                    -147200.2634 -148472.30  0.86%     -    0s
     0     0 -148472.30    0   50 -147200.26 -148472.30  0.86%     -    0s
H    0     0                    -147801.5040 -148472.30  0.45%     -    0s
     0     0 -148174.96    0   36 -147801.50 -148174.96  0.25%     -    0s
     0     0 -148169.52    0   34 -147801.50 -148169.52  0.25%     -    0s
     0     0 -148049.54    0   29 -147801.50 -148049.54  0.17%     -    0s
     0     0 -148049.54    0   18 -147801.50 -148049.54  0.17%     -    0s
     0     0 -148049.54    0   24 -147801.50 -148049.54  0.17%     -    0s
     0     0 -148049.54    0   23 -147801.50 -148049.54  0.17%     -    0s
     0     0 -147920.32    0   11 -147801.50 -147920.32  0.08%     -    0s
     0     0 -147920.32    0   24 -147801.50 -147920.32  0.08%     -    0s
     0     0 -147905.82    0   15 -147801.50 -147905.82  0.07%     -    0s
     0     0 -147904.21    0   15 -147801.50 -147904.21  0.07%     -    0s
H    0     0                    -147805.6786 -147901.07  0.06%     -    0s
     0     0 -147861.06    0    6 -147805.68 -147861.06  0.04%     -    0s
     0     0 -147857.87    0    6 -147805.68 -147857.87  0.04%     -    0s
     0     0 -147857.82    0    6 -147805.68 -147857.82  0.04%     -    0s
H    0     0                    -147839.7090 -147857.82  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 3
  MIR: 21
  Flow cover: 8
  Relax-and-lift: 4

Explored 1 nodes (682 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -147840 -147806 -147802 ... 1.3605e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.478397089669e+05, best bound -1.478494633747e+05, gap 0.0066%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 146454.33
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147839.71
  [DEBUG]   S×d_nominal = 294294.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294294.03 + -147839.71 = 146454.33
  [DEBUG]   Current θ from Master = 155761.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9306.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9758.05
  Lower Bound (LB) = 17914.52
  Gap (UB-LB) = 1150.4503, Absolute Gap = 1150.4503, Relative Gap = 0.060344
  Not converged yet (gap = 1150.45 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0x765c07a5
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 3.63s
Presolved: 99580 rows, 42487 columns, 602280 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366724.2498
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.585e+06
 Factor NZ  : 1.009e+07 (roughly 140 MB of memory)
 Factor Ops : 1.871e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.01059120e+07  1.84096387e+08  1.15e+05 1.96e+01  9.14e+04     6s
   1  -1.51999742e+07  1.66069416e+08  8.10e+04 7.52e+01  6.43e+04     6s
   2  -5.13765443e+06  1.21167919e+08  2.72e+04 6.05e+00  2.30e+04     6s
   3  -1.78777708e+06  9.87089110e+07  5.83e+03 1.48e+00  5.28e+03     6s
   4  -7.56683593e+05  7.99793935e+07  6.55e+02 9.39e-01  9.57e+02     6s
   5  -5.12710402e+05  3.91724742e+07  4.60e+02 3.35e-01  5.36e+02     6s
   6  -3.93826790e+05  2.84274437e+07  1.89e+02 2.16e-01  2.81e+02     6s
   7  -3.25554851e+05  2.01490537e+07  9.16e+01 1.41e-01  1.66e+02     6s
   8  -2.20277960e+05  1.37098758e+07  3.38e+01 8.79e-02  9.33e+01     6s
   9  -1.83970586e+05  1.06315009e+07  2.19e+01 6.61e-02  6.84e+01     7s
  10  -1.17883332e+05  7.94908248e+06  8.46e+00 4.79e-02  4.71e+01     7s
  11  -7.98905930e+04  3.18130649e+06  3.39e+00 1.74e-02  1.84e+01     7s
  12  -6.63011782e+04  1.11388075e+06  2.56e+00 5.73e-03  6.64e+00     7s
  13  -2.53883655e+04  5.20884757e+05  1.26e+00 2.24e-03  3.04e+00     7s
  14  -1.44826235e+04  3.32007966e+05  9.11e-01 1.38e-03  1.92e+00     7s
  15  -7.25380000e+03  2.02199563e+05  6.98e-01 1.15e-03  1.16e+00     7s
  16   6.71158848e+03  1.65668461e+05  3.89e-01 1.46e-03  8.76e-01     7s
  17   9.73393225e+03  1.33114279e+05  3.46e-01 1.30e-03  6.80e-01     7s
  18   1.76256910e+04  1.08930074e+05  2.50e-01 1.44e-03  5.03e-01     7s
  19   2.34221782e+04  8.83593694e+04  1.87e-01 1.67e-03  3.57e-01     8s
  20   2.74739896e+04  7.00281739e+04  1.50e-01 1.94e-03  2.34e-01     8s
  21   3.25221065e+04  6.39538720e+04  1.10e-01 1.27e-03  1.73e-01     8s
  22   3.59300566e+04  6.04718912e+04  8.38e-02 1.15e-03  1.35e-01     8s
  23   3.91448890e+04  5.70415802e+04  6.06e-02 1.05e-03  9.85e-02     8s
  24   4.10523031e+04  5.42436181e+04  4.73e-02 1.73e-03  7.26e-02     8s
  25   4.25752134e+04  5.25459227e+04  3.66e-02 1.75e-03  5.49e-02     8s
  26   4.35482976e+04  5.19834328e+04  3.03e-02 1.56e-03  4.64e-02     8s
  27   4.44715237e+04  5.14512385e+04  2.45e-02 1.23e-03  3.84e-02     8s
  28   4.48316278e+04  5.08114923e+04  2.23e-02 9.89e-04  3.29e-02     9s
  29   4.57879908e+04  5.02370851e+04  1.62e-02 1.17e-03  2.45e-02     9s
  30   4.62256964e+04  4.98345565e+04  1.34e-02 1.10e-03  1.99e-02     9s
  31   4.70247032e+04  4.95002484e+04  8.52e-03 7.18e-04  1.36e-02     9s
  32   4.72301374e+04  4.91241685e+04  7.26e-03 4.49e-04  1.04e-02     9s
  33   4.74396416e+04  4.90572595e+04  6.01e-03 4.01e-04  8.90e-03     9s
  34   4.78345025e+04  4.89114360e+04  3.69e-03 2.91e-04  5.93e-03     9s
  35   4.79275523e+04  4.88565463e+04  3.15e-03 2.51e-04  5.11e-03     9s
  36   4.80406494e+04  4.87505123e+04  2.51e-03 1.76e-04  3.91e-03    10s
  37   4.81388776e+04  4.87326827e+04  1.99e-03 1.62e-04  3.27e-03    10s
  38   4.82642144e+04  4.86277781e+04  1.30e-03 1.24e-04  2.00e-03    10s
  39   4.83231680e+04  4.85816479e+04  9.78e-04 6.37e-05  1.42e-03    10s
  40   4.84429448e+04  4.85323195e+04  3.10e-04 6.21e-05  4.92e-04    10s
  41   4.84621838e+04  4.85247880e+04  2.22e-04 3.95e-05  3.44e-04    10s
  42   4.84714056e+04  4.85236896e+04  1.80e-04 3.62e-05  2.88e-04    10s
  43   4.84826387e+04  4.85193237e+04  1.29e-04 2.26e-05  2.02e-04    10s
  44   4.85008157e+04  4.85155443e+04  4.36e-05 1.17e-05  8.10e-05    11s
  45   4.85106921e+04  4.85115574e+04  8.43e-07 8.63e-06  4.75e-06    11s
  46   4.85110123e+04  4.85114947e+04  8.65e-08 7.50e-06  2.64e-06    11s
  47   4.85110658e+04  4.85111093e+04  1.32e-08 5.48e-07  2.38e-07    11s
  48   4.85110682e+04  4.85110771e+04  1.04e-08 5.18e-09  4.89e-08    11s
  49   4.85110687e+04  4.85110769e+04  1.56e-07 1.03e-08  4.53e-08    11s
  50   4.85110697e+04  4.85110768e+04  1.71e-06 2.05e-08  3.90e-08    11s
  51   4.85110704e+04  4.85110765e+04  1.23e-05 8.83e-08  2.85e-08    12s
  52   4.85110705e+04  4.85110765e+04  1.25e-05 8.77e-08  2.83e-08    12s
  53   4.85110719e+04  4.85110765e+04  9.91e-06 7.68e-08  2.16e-08    12s
  54   4.85110719e+04  4.85110765e+04  1.00e-05 7.50e-08  2.12e-08    12s
  55   4.85110726e+04  4.85110764e+04  8.78e-06 4.63e-08  1.83e-08    12s
  56   4.85110736e+04  4.85110764e+04  6.34e-06 2.91e-08  1.33e-08    12s
  57   4.85110749e+04  4.85110764e+04  4.08e-06 1.99e-08  8.27e-09    13s
  58   4.85110752e+04  4.85110764e+04  4.17e-06 1.69e-08  7.43e-09    13s
  59   4.85110757e+04  4.85110764e+04  4.70e-06 8.99e-09  5.05e-09    13s
  60   4.85110760e+04  4.85110764e+04  5.96e-06 1.31e-08  2.65e-09    13s
  61   4.85110762e+04  4.85110764e+04  3.59e-06 1.61e-09  1.60e-09    13s

Barrier solved model in 61 iterations and 13.24 seconds (10.52 work units)
Optimal objective 4.85110762e+04


Root crossover log...

   87186 DPushes remaining with DInf 2.9466199e-07                13s
    3537 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   11684 PPushes remaining with PInf 7.8084334e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.2825924e+04     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50435    4.8511076e+04   0.000000e+00   4.282592e+04     16s
   50797    4.8511076e+04   0.000000e+00   0.000000e+00     17s
   50797    4.8511076e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.851108e+04, 50797 iterations, 12.24 seconds (11.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48511.0764    0  233 -203357.92 48511.0764   124%     -   17s
H    0     0                    -199607.7351 48511.0764   124%     -   17s
H    0     0                    -183854.2344 48511.0764   126%     -   18s
H    0     0                    -176996.0572 48511.0764   127%     -   18s
H    0     0                    -168267.1447 48511.0764   129%     -   18s
H    0     0                    -167467.1931 48511.0764   129%     -   18s
H    0     0                    -167180.6261 48511.0764   129%     -   19s
H    0     0                    -166842.3500 48511.0764   129%     -   19s
H    0     0                    -166547.4438 48511.0764   129%     -   19s
H    0     0                    -166050.8460 48511.0764   129%     -   19s
H    0     0                    -166036.2318 48511.0764   129%     -   19s
H    0     0                    -166016.5387 48511.0764   129%     -   19s
H    0     0                    -28110.21042 48511.0764   273%     -   19s
H    0     0                    12124.291908 48511.0764   300%     -   19s
H    0     0                    12982.207688 48511.0764   274%     -   19s
H    0     0                    13340.386683 48511.0764   264%     -   20s
H    0     0                    13682.678390 48511.0764   255%     -   20s
     0     0 43176.7095    0  321 13682.6784 43176.7095   216%     -   61s
H    0     0                    14109.411273 43176.7041   206%     -   62s
     0     0 41721.9792    0  347 14109.4113 41721.9792   196%     -   92s
     0     0 41634.5360    0  331 14109.4113 41634.5360   195%     -  104s
     0     0 41634.5360    0  342 14109.4113 41634.5360   195%     -  112s
     0     0 41634.5360    0  342 14109.4113 41634.5360   195%     -  113s
     0     0 38269.2991    0  430 14109.4113 38269.2991   171%     -  185s
H    0     0                    15917.859533 38261.0619   140%     -  186s
H    0     0                    15930.291187 38261.0619   140%     -  186s
     0     0 37610.1835    0  413 15930.2912 37610.1835   136%     -  235s
     0     0 37349.1916    0  428 15930.2912 37349.1916   134%     -  269s
     0     0 37025.8788    0  413 15930.2912 37025.8788   132%     -  303s
     0     0 36972.7145    0  411 15930.2912 36972.7145   132%     -  321s
     0     0 36869.0934    0  430 15930.2912 36869.0934   131%     -  348s
     0     0 36825.9176    0  422 15930.2912 36825.9176   131%     -  359s
     0     0 36785.0781    0  414 15930.2912 36785.0781   131%     -  366s
     0     0 36760.3680    0  416 15930.2912 36760.3680   131%     -  372s
     0     0 36759.0586    0  416 15930.2912 36759.0586   131%     -  375s
     0     0 34056.2269    0  392 15930.2912 34056.2269   114%     -  471s
     0     0 33543.4522    0  381 15930.2912 33543.4522   111%     -  507s
     0     0 33386.1757    0  403 15930.2912 33386.1757   110%     -  527s
     0     0 33126.9589    0  379 15930.2912 33126.9589   108%     -  554s
     0     0 33010.1867    0  380 15930.2912 33010.1867   107%     -  567s
     0     0 32933.7259    0  377 15930.2912 32933.7259   107%     -  582s
     0     0 32776.6983    0  363 15930.2912 32776.6983   106%     -  606s
     0     0 32673.5529    0  378 15930.2912 32673.5529   105%     -  614s
     0     0 32632.3505    0  369 15930.2912 32632.3505   105%     -  619s
     0     0 32518.6842    0  361 15930.2912 32518.6842   104%     -  631s
     0     0 32494.2977    0  367 15930.2912 32494.2977   104%     -  636s
     0     0 32466.1854    0  359 15930.2912 32466.1854   104%     -  640s
     0     0 32453.7405    0  349 15930.2912 32453.7405   104%     -  644s
     0     0 32449.5347    0  370 15930.2912 32449.5347   104%     -  647s
     0     0 32431.8973    0  359 15930.2912 32431.8973   104%     -  656s
     0     0 32428.6999    0  360 15930.2912 32428.6999   104%     -  659s
     0     0 32425.2226    0  366 15930.2912 32425.2226   104%     -  661s
     0     0 32424.2297    0  362 15930.2912 32424.2297   104%     -  663s
     0     0 31254.0100    0  372 15930.2912 31254.0100  96.2%     -  724s
     0     0 31006.8453    0  391 15930.2912 31006.8453  94.6%     -  743s
     0     0 30888.2034    0  420 15930.2912 30888.2034  93.9%     -  757s
     0     0 30781.4078    0  427 15930.2912 30781.4078  93.2%     -  769s
     0     0 30747.5649    0  428 15930.2912 30747.5649  93.0%     -  777s
     0     0 30729.7003    0  453 15930.2912 30729.7003  92.9%     -  783s
     0     0 30721.0310    0  430 15930.2912 30721.0310  92.8%     -  786s
     0     0 30705.2902    0  394 15930.2912 30705.2902  92.7%     -  789s
     0     0 30682.5133    0  372 15930.2912 30682.5133  92.6%     -  792s
     0     0 30671.0992    0  381 15930.2912 30671.0992  92.5%     -  795s
     0     0 30664.5878    0  372 15930.2912 30664.5878  92.5%     -  797s
     0     0 30662.6624    0  373 15930.2912 30662.6624  92.5%     -  797s
     0     0 30427.7311    0  373 15930.2912 30427.7311  91.0%     -  820s
H    0     0                    16026.670170 30426.9159  89.9%     -  821s
H    0     0                    16094.497050 30426.9159  89.1%     -  821s
H    0     0                    16123.751257 30426.9159  88.7%     -  821s
     0     0 30396.4135    0  378 16123.7513 30396.4135  88.5%     -  828s
     0     0 30385.9093    0  396 16123.7513 30385.9093  88.5%     -  833s
     0     0 30379.8556    0  381 16123.7513 30379.8556  88.4%     -  838s
     0     0 30375.8342    0  446 16123.7513 30375.8342  88.4%     -  845s
     0     0 30372.8719    0  442 16123.7513 30372.8719  88.4%     -  848s
     0     0 30371.0260    0  451 16123.7513 30371.0260  88.4%     -  850s
     0     0 30210.0520    0  363 16123.7513 30210.0520  87.4%     -  869s
     0     0 30179.4433    0  362 16123.7513 30179.4433  87.2%     -  889s
     0     0 30157.2057    0  364 16123.7513 30157.2057  87.0%     -  898s
     0     0 30148.6315    0  368 16123.7513 30148.6315  87.0%     -  903s
     0     0 30145.8674    0  380 16123.7513 30145.8674  87.0%     -  906s
     0     0 30080.1996    0  403 16123.7513 30080.1996  86.6%     -  918s
     0     0 30065.9249    0  352 16123.7513 30065.9249  86.5%     -  923s
     0     0 30059.8177    0  350 16123.7513 30059.8177  86.4%     -  925s
     0     0 30057.7483    0  402 16123.7513 30057.7483  86.4%     -  927s
     0     0 30029.8246    0  368 16123.7513 30029.8246  86.2%     -  936s
     0     0 30022.8186    0  344 16123.7513 30022.8186  86.2%     -  943s
     0     0 30020.5798    0  343 16123.7513 30020.5798  86.2%     -  946s
     0     0 30010.7498    0  437 16123.7513 30010.7498  86.1%     -  956s
     0     0 30007.5574    0  440 16123.7513 30007.5574  86.1%     -  958s
     0     0 30007.0502    0  428 16123.7513 30007.0502  86.1%     -  959s
     0     0 30002.0788    0  435 16123.7513 30002.0788  86.1%     -  964s
     0     0 30001.9262    0  435 16123.7513 30001.9262  86.1%     -  969s
H    0     0                    16190.255084 30001.9262  85.3%     - 1068s
H    0     0                    17235.769098 30001.9262  74.1%     - 1070s
H    0     0                    17566.891625 30001.9262  70.8%     - 1072s
H    0     0                    17571.861212 30001.9262  70.7%     - 1074s
H    0     0                    17578.737084 30001.9262  70.7%     - 1074s
H    0     0                    17605.727363 30001.9262  70.4%     - 1074s
H    0     0                    17610.696950 30001.9262  70.4%     - 1075s
H    0     2                    17926.549046 30001.9262  67.4%     - 1149s
     0     2 30001.9262    0  435 17926.5490 30001.9262  67.4%     - 1149s
     1     4 29877.5467    1  441 17926.5490 30001.9262  67.4%  9201 1171s
     3     8 29542.8078    2  352 17926.5490 29876.2222  66.7% 11140 1209s
     7    16 29400.0561    3  483 17926.5490 29541.9182  64.8% 13875 1238s
    15    32 29259.8038    4  370 17926.5490 29399.5000  64.0% 12713 1268s
    31    48 28295.1530    5  364 17926.5490 29259.6445  63.2% 20502 1353s
H   47    80                    18035.388718 29259.6445  62.2% 18731 1404s
H   49    80                    18092.753869 29259.6445  61.7% 18225 1404s
H   53    80                    18190.614067 29259.6445  60.9% 17969 1404s
    79   143 27879.6644    7  354 18190.6141 29259.6445  60.9% 15184 1529s
   142   266 27784.4721    9  346 18190.6141 29259.6445  60.9%  9936 1581s
H  170   266                    18726.738221 29259.6445  56.2%  8996 1581s
   265   290 27669.2547   10  333 18726.7382 29259.6445  56.2%  6917 1608s
   299   322 27065.2264   15  327 18726.7382 29259.6445  56.2%  6517 1638s
   331   373 27617.8333   11  334 18726.7382 29259.6445  56.2%  6372 1669s
   382   414 27447.0777   11  331 18726.7382 29259.6445  56.2%  6078 1700s
   427   459 27558.2308   12  328 18726.7382 29259.6445  56.2%  5889 1736s
   489   526 27401.2124   12  327 18726.7382 29259.6445  56.2%  5688 1771s
   573   584 infeasible   25      18726.7382 29259.6445  56.2%  5324 1802s
   649   604 26503.3769   17  323 18726.7382 29259.6445  56.2%  4992 1831s
   679   640 26319.6535   18  311 18726.7382 29259.6445  56.2%  4998 1863s
   732   679 18927.3701   37  194 18726.7382 29259.6445  56.2%  4896 1892s
   799   699 infeasible   40      18726.7382 29259.6445  56.2%  4795 1921s
   859   728 21473.9669   29  291 18726.7382 29259.6445  56.2%  4698 1950s
   920   763 21168.5238   30  297 18726.7382 29259.6445  56.2%  4622 1976s
   987   821 20719.3861   32  234 18726.7382 29259.6445  56.2%  4550 2011s
  1061   888 19991.0555   37  199 18726.7382 29259.6445  56.2%  4489 2041s
  1174   903 infeasible   36      18726.7382 29259.6445  56.2%  4303 2076s
  1243   914 infeasible   44      18726.7382 29259.6445  56.2%  4293 2118s
  1306   962 20524.4099   26  357 18726.7382 29259.6445  56.2%  4334 2155s
  1365  1026 20434.4313   27  346 18726.7382 29259.6445  56.2%  4338 2193s
  1447  1073 20145.9089   28  319 18726.7382 29259.6445  56.2%  4342 2239s
  1535  1135 19354.4105   34  281 18726.7382 29259.6445  56.2%  4300 2279s
  1623  1194 19854.8693   21  159 18726.7382 29259.6445  56.2%  4281 2318s
  1726  1260 19747.6089   23  141 18726.7382 29259.6445  56.2%  4255 2357s
  1840  1352 19406.4788   25  138 18726.7382 29033.9931  55.0%  4216 2396s
  1999  1413 28806.7297    6  333 18726.7382 29033.8279  55.0%  4100 2439s
H 2096  1413                    18855.723695 29033.8279  54.0%  4078 2439s
  2126  1507 28452.4377    8  321 18855.7237 29033.8279  54.0%  4084 2486s
  2288  1602 27633.2514   10  328 18855.7237 29033.8279  54.0%  4018 2536s
  2465  1670 26986.6003   13  306 18855.7237 29033.8279  54.0%  3962 2587s
  2589  1767 21989.3499   16  222 18855.7237 29033.8279  54.0%  3986 2641s
  2732  1874 21841.4734   17  214 18855.7237 28380.7608  50.5%  4002 2696s
  2909  1942 infeasible   21      18855.7237 28380.7608  50.5%  3969 2745s
H 2913  1932                    19001.171220 28380.7608  49.4%  3972 2745s
H 2917  1931                    19025.033764 28380.7608  49.2%  3974 2745s
H 2921  1928                    19039.694917 28380.7608  49.1%  3974 2745s
H 2929  1895                    19260.361446 28380.7608  47.4%  3971 2745s
H 2984  1883                    19298.767126 28380.7608  47.1%  3950 2745s
  3052  1975 25097.6729   11  303 19298.7671 28380.7608  47.1%  3953 2802s
  3218  2105 22863.5239   15  208 19298.7671 28380.7608  47.1%  3947 2863s
  3392  2245 21876.3810   17  323 19298.7671 28380.7608  47.1%  3949 2926s
  3574  2389 21021.5601   20  265 19298.7671 27740.6204  43.7%  3960 2987s
  3811  2390 24804.9283   14  435 19298.7671 27729.8773  43.7%  3915 3142s
  3813  2391 19457.1035   28  197 19298.7671 27729.8773  43.7%  3913 3158s
  3814  2392 20356.2632   23  288 19298.7671 27729.8773  43.7%  3912 3275s
  3815  2393 25817.0251   14  299 19298.7671 27729.8773  43.7%  3911 3350s
  3816  2393 20102.0262   37  307 19298.7671 27729.8773  43.7%  3910 3389s
  3817  2394 19530.8504   41  338 19298.7671 27729.8773  43.7%  3909 3418s
  3818  2395 24558.6871   13  356 19298.7671 27729.8773  43.7%  3908 3439s
  3819  2395 25722.3838   12  364 19298.7671 27729.8773  43.7%  3907 3455s
  3820  2396 20582.1803   30  343 19298.7671 27729.8773  43.7%  3906 3466s
  3821  2397 21905.0587   38  344 19298.7671 27729.8773  43.7%  3905 3473s
  3822  2397 21764.5389   16  358 19298.7671 27729.8773  43.7%  3904 3485s
  3823  2398 23330.9996   30  356 19298.7671 27729.8773  43.7%  3903 3492s
  3824  2399 25615.5072   22  352 19298.7671 27729.8773  43.7%  3902 3502s
  3825  2399 26638.1735   15  393 19298.7671 27729.8773  43.7%  3901 3510s
  3826  2400 24350.4489   16  394 19298.7671 27729.8773  43.7%  3900 3516s
  3827  2401 21119.2380   14  362 19298.7671 27729.8773  43.7%  3899 3541s
  3828  2401 26002.1885    8  394 19298.7671 27729.8773  43.7%  3898 3552s
  3829  2402 22387.6910   20  392 19298.7671 27729.8773  43.7%  3897 3555s
  3830  2403 19533.4013   17  392 19298.7671 27729.8773  43.7%  3896 3561s
  3831  2403 20675.7787   26  360 19298.7671 27729.8773  43.7%  3895 3578s
  3832  2404 20558.7369   19  402 19298.7671 27729.8773  43.7%  3894 3585s
  3833  2405 24278.6672   15  371 19298.7671 27729.8773  43.7%  3893 3593s

Cutting planes:
  Learned: 1
  Gomory: 25
  Implied bound: 46
  Projected implied bound: 251
  MIR: 979
  Mixing: 6
  Flow cover: 672
  RLT: 33
  Relax-and-lift: 225

Explored 3833 nodes (15861061 simplex iterations) in 3600.08 seconds (5342.27 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 19298.8 19260.4 19039.7 ... 18035.4

Time limit reached
Best objective 1.929876712641e+04, best bound 2.772987733766e+04, gap 43.6873%
  WARNING: Time limit reached. Using best solution found (gap: 43.69%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 19298.77, θ = 154028.40
  Upper Bound (UB) = 19298.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 154028.40
  [DEBUG]   ✓ Scenario 0: θ = 154028.40 ≤ Q = 154028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 154028.40 ≤ Q = 154028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 154028.40 ≤ Q = 154028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 154028.40 ≤ Q = 154028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 154028.40 ≤ Q = 154028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 154028.40 ≤ Q = 154028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 154028.40 ≤ Q = 154028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 154028.40 ≤ Q = 154028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 154028.40 ≤ Q = 154028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 154028.40 ≤ Q = 154028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 154028.40 ≤ Q = 154028.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3805277e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc7fad882
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.366357e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.01s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6884960.1301
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.740056e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174005.59    0  127 6884960.13 -174005.59   103%     -    0s
H    0     0                    -136442.4050 -174005.59  27.5%     -    0s
H    0     0                    -136931.7796 -174005.59  27.1%     -    0s
     0     0 -147986.68    0  109 -136931.78 -147986.68  8.07%     -    0s
H    0     0                    -143910.1706 -147871.19  2.75%     -    0s
H    0     0                    -144186.4311 -147871.19  2.56%     -    0s
H    0     0                    -144969.2439 -147871.19  2.00%     -    0s
H    0     0                    -145245.5044 -147871.19  1.81%     -    0s
     0     0 -147348.60    0  107 -145245.50 -147348.60  1.45%     -    0s
H    0     0                    -145437.7590 -146799.07  0.94%     -    0s
     0     0 -146799.07    0  112 -145437.76 -146799.07  0.94%     -    0s
H    0     0                    -145470.7618 -146749.92  0.88%     -    0s
     0     0 -146749.92    0  109 -145470.76 -146749.92  0.88%     -    0s
     0     0 -146746.69    0  110 -145470.76 -146746.69  0.88%     -    0s
     0     0 -146402.98    0   96 -145470.76 -146402.98  0.64%     -    0s
     0     0 -146380.82    0   96 -145470.76 -146380.82  0.63%     -    0s
     0     0 -146141.04    0   89 -145470.76 -146141.04  0.46%     -    0s
H    0     0                    -145472.2599 -146119.94  0.45%     -    0s
     0     0 -146119.94    0   91 -145472.26 -146119.94  0.45%     -    0s
     0     0 -145967.48    0   84 -145472.26 -145967.48  0.34%     -    0s
     0     0 -145964.54    0   84 -145472.26 -145964.54  0.34%     -    0s
     0     2 -145964.54    0   84 -145472.26 -145964.54  0.34%     -    0s
H   31    20                    -145555.9354 -145887.79  0.23%  12.2    0s
*  149    66              11    -145557.4980 -145802.43  0.17%   7.7    0s
*  154    66              14    -145682.7563 -145802.43  0.08%   7.7    0s
*  158    66              13    -145720.8157 -145802.43  0.06%   7.7    0s

Cutting planes:
  Gomory: 27
  Implied bound: 3
  MIR: 170
  Flow cover: 12
  RLT: 52
  Relax-and-lift: 2
  BQP: 2

Explored 308 nodes (2503 simplex iterations) in 0.19 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145721 -145683 -145557 ... -136932
No other solutions better than -145721

Optimal solution found (tolerance 1.00e-04)
Best objective -1.457208156727e+05, best bound -1.457208156727e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 148721.04
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145720.82
  [DEBUG]   S×d_nominal = 294441.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294441.85 + -145720.82 = 148721.04
  [DEBUG]   Current θ from Master = 154028.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5307.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13991.41
  Lower Bound (LB) = 17914.52
  Gap (UB-LB) = 1384.2479, Absolute Gap = 1384.2479, Relative Gap = 0.071727
  Not converged yet (gap = 1384.25 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524543 nonzeros
Model fingerprint: 0xe46c6cd2
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 76356 rows and 30996 columns
Presolve time: 3.60s
Presolved: 108507 rows, 46144 columns, 653627 nonzeros
Variable types: 43885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -360896.4758
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 692
 AA' NZ     : 3.542e+06
 Factor NZ  : 8.716e+06 (roughly 130 MB of memory)
 Factor Ops : 1.705e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.08013335e+07  1.98967984e+08  1.19e+05 2.21e+01  9.40e+04     6s
   1  -1.57616940e+07  1.80462274e+08  8.37e+04 7.44e+01  6.60e+04     6s
   2  -4.89695046e+06  1.32132328e+08  2.60e+04 7.29e+00  2.19e+04     6s
   3  -2.27649174e+06  1.26959021e+08  1.09e+04 6.18e+00  9.54e+03     6s
   4  -7.38296529e+05  1.01456174e+08  9.23e+02 2.16e+00  1.24e+03     6s
   5  -5.57229835e+05  4.81719027e+07  4.34e+02 7.54e-01  5.43e+02     6s
   6  -4.34244276e+05  3.25902073e+07  1.93e+02 4.50e-01  2.89e+02     6s
   7  -3.68494082e+05  2.36152894e+07  9.78e+01 3.07e-01  1.77e+02     6s
   8  -2.55376647e+05  1.52511236e+07  2.90e+01 1.80e-01  9.20e+01     6s
   9  -1.43297154e+05  9.71348346e+06  4.40e+00 1.10e-01  5.12e+01     6s
  10  -1.00877855e+05  4.62095728e+06  2.32e+00 5.25e-02  2.42e+01     6s
  11  -7.13057350e+04  2.77141563e+06  1.29e+00 3.06e-02  1.45e+01     7s
  12  -5.24622340e+04  1.80479975e+06  8.86e-01 1.96e-02  9.42e+00     7s
  13  -2.34468456e+04  8.12114240e+05  4.01e-01 8.22e-03  4.22e+00     7s
  14  -1.02300690e+04  3.48974563e+05  2.25e-01 3.45e-03  1.81e+00     7s
  15  -2.32893030e+03  2.01505111e+05  1.55e-01 1.81e-03  1.03e+00     7s
  16   6.17061579e+03  1.47476314e+05  1.16e-01 1.53e-03  7.12e-01     7s
  17   1.10089402e+04  1.29022658e+05  9.86e-02 1.75e-03  5.95e-01     7s
  18   1.77373866e+04  1.04892067e+05  7.59e-02 1.56e-03  4.39e-01     7s
  19   2.35556075e+04  8.59266391e+04  5.76e-02 1.44e-03  3.14e-01     7s
  20   2.97569634e+04  8.06614716e+04  3.90e-02 1.28e-03  2.56e-01     7s
  21   3.27247553e+04  6.90992335e+04  3.16e-02 8.70e-04  1.83e-01     7s
  22   3.63504886e+04  6.47498995e+04  2.32e-02 6.93e-04  1.43e-01     7s
  23   3.97949672e+04  6.22114132e+04  1.58e-02 5.73e-04  1.13e-01     8s
  24   4.09939837e+04  5.79677705e+04  1.33e-02 4.11e-04  8.55e-02     8s
  25   4.21951480e+04  5.48098392e+04  1.09e-02 2.81e-04  6.36e-02     8s
  26   4.30165013e+04  5.38759176e+04  9.34e-03 2.40e-04  5.47e-02     8s
  27   4.44676398e+04  5.20191084e+04  6.68e-03 1.61e-04  3.80e-02     8s
  28   4.54077675e+04  5.13234906e+04  5.01e-03 1.29e-04  2.98e-02     8s
  29   4.57601282e+04  5.03542825e+04  4.40e-03 8.75e-05  2.32e-02     8s
  30   4.60256098e+04  5.01991410e+04  3.97e-03 7.99e-05  2.10e-02     8s
  31   4.68266835e+04  4.98582060e+04  2.63e-03 6.34e-05  1.53e-02     8s
  32   4.72641342e+04  4.95410151e+04  1.91e-03 9.32e-05  1.15e-02     9s
  33   4.75593495e+04  4.92543584e+04  1.43e-03 8.88e-05  8.54e-03     9s
  34   4.78102513e+04  4.91311635e+04  1.05e-03 7.41e-05  6.65e-03     9s
  35   4.79167416e+04  4.89596554e+04  8.79e-04 5.20e-05  5.25e-03     9s
  36   4.80143622e+04  4.88804526e+04  7.27e-04 4.26e-05  4.36e-03     9s
  37   4.81098260e+04  4.88254426e+04  5.87e-04 3.71e-05  3.61e-03     9s
  38   4.82767913e+04  4.86671878e+04  3.35e-04 2.98e-05  1.97e-03     9s
  39   4.83539727e+04  4.86139011e+04  2.19e-04 2.97e-05  1.31e-03     9s
  40   4.84319630e+04  4.85546289e+04  1.07e-04 1.18e-05  6.18e-04     9s
  41   4.84678519e+04  4.85388910e+04  5.64e-05 7.42e-06  3.58e-04    10s
  42   4.84794591e+04  4.85350879e+04  4.12e-05 6.38e-06  2.80e-04    10s
  43   4.84843145e+04  4.85264302e+04  3.45e-05 4.01e-06  2.12e-04    10s
  44   4.85080756e+04  4.85155339e+04  3.17e-06 1.11e-06  3.76e-05    10s
  45   4.85107774e+04  4.85121871e+04  1.86e-07 2.72e-07  7.10e-06    10s
  46   4.85110316e+04  4.85113685e+04  2.87e-08 7.00e-08  1.70e-06    10s
  47   4.85110401e+04  4.85110784e+04  2.34e-08 3.01e-10  1.93e-07    10s
  48   4.85110432e+04  4.85110778e+04  2.18e-06 2.30e-08  1.76e-07    10s
  49   4.85110703e+04  4.85110767e+04  1.56e-06 9.44e-09  3.25e-08    10s
  50   4.85110757e+04  4.85110764e+04  2.74e-07 4.05e-08  3.69e-09    11s
  51   4.85110764e+04  4.85110764e+04  1.37e-07 2.35e-08  9.87e-11    11s

Barrier solved model in 51 iterations and 10.68 seconds (9.75 work units)
Optimal objective 4.85110764e+04


Root crossover log...

   94885 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    2150 PPushes remaining with PInf 1.4427567e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0621322e-10     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37945    4.8511076e+04   0.000000e+00   0.000000e+00     12s
   37945    4.8511076e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.851108e+04, 37945 iterations, 7.97 seconds (8.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48511.0764    0  233 -203357.92 48511.0764   124%     -   13s
H    0     0                    -190804.3306 48511.0764   125%     -   13s
H    0     0                    -158004.5980 48511.0764   131%     -   13s
H    0     0                    -30508.90456 48511.0764   259%     -   13s
H    0     0                    12124.291908 48511.0764   300%     -   14s
H    0     0                    12982.207688 48511.0764   274%     -   14s
H    0     0                    13340.386683 48511.0764   264%     -   15s
H    0     0                    13682.678390 48511.0764   255%     -   15s
     0     0 42694.9117    0  340 13682.6784 42694.9117   212%     -   59s
H    0     0                    13931.509075 42694.8128   206%     -   60s
H    0     0                    14009.025116 42694.8128   205%     -   60s
H    0     0                    14012.342561 42694.8128   205%     -   60s
     0     0 42183.3632    0  345 14012.3426 42183.3632   201%     -   81s
     0     0 42128.6324    0  339 14012.3426 42128.6324   201%     -   88s
     0     0 42083.4780    0  337 14012.3426 42083.4780   200%     -   95s
     0     0 42079.2107    0  337 14012.3426 42079.2107   200%     -   97s
     0     0 42058.3809    0  341 14012.3426 42058.3809   200%     -  100s
     0     0 42019.3521    0  339 14012.3426 42019.3521   200%     -  105s
     0     0 42015.2973    0  338 14012.3426 42015.2973   200%     -  108s
     0     0 42014.7578    0  342 14012.3426 42014.7578   200%     -  109s
H    0     0                    14106.029730 39074.8924   177%     -  171s
H    0     0                    14291.212352 39074.8924   173%     -  171s
     0     0 39074.8924    0  404 14291.2124 39074.8924   173%     -  171s
H    0     0                    15942.424335 39063.0012   145%     -  172s
     0     0 38246.9859    0  446 15942.4243 38246.9859   140%     -  213s
     0     0 38086.3864    0  426 15942.4243 38086.3864   139%     -  232s
     0     0 38034.7862    0  433 15942.4243 38034.7862   139%     -  242s
     0     0 38008.3921    0  422 15942.4243 38008.3921   138%     -  249s
     0     0 37976.3412    0  428 15942.4243 37976.3412   138%     -  259s
     0     0 37944.7993    0  424 15942.4243 37944.7993   138%     -  269s
     0     0 37935.1264    0  437 15942.4243 37935.1264   138%     -  273s
     0     0 37927.2817    0  421 15942.4243 37927.2817   138%     -  276s
     0     0 37926.5417    0  426 15942.4243 37926.5417   138%     -  278s
H    0     0                    16013.897749 34802.3619   117%     -  366s
     0     0 34802.3619    0  356 16013.8977 34802.3619   117%     -  367s
H    0     0                    16068.740943 34802.0113   117%     -  368s
H    0     0                    16093.173997 34802.0113   116%     -  368s
     0     0 34267.9324    0  346 16093.1740 34267.9324   113%     -  407s
     0     0 34088.3560    0  357 16093.1740 34088.3560   112%     -  427s
     0     0 34011.8641    0  341 16093.1740 34011.8641   111%     -  442s
     0     0 33916.5051    0  352 16093.1740 33916.5051   111%     -  468s
     0     0 33821.0699    0  350 16093.1740 33821.0699   110%     -  490s
     0     0 33753.4264    0  363 16093.1740 33753.4264   110%     -  509s
     0     0 33706.5618    0  365 16093.1740 33706.5618   109%     -  522s
     0     0 33687.8754    0  369 16093.1740 33687.8754   109%     -  538s
     0     0 33678.9103    0  371 16093.1740 33678.9103   109%     -  551s
     0     0 33654.6322    0  364 16093.1740 33654.6322   109%     -  564s
     0     0 33649.1932    0  367 16093.1740 33649.1932   109%     -  568s
     0     0 33637.1007    0  365 16093.1740 33637.1007   109%     -  575s
     0     0 33622.5491    0  364 16093.1740 33622.5491   109%     -  585s
     0     0 33619.6680    0  366 16093.1740 33619.6680   109%     -  590s
     0     0 33609.5138    0  364 16093.1740 33609.5138   109%     -  596s
     0     0 33576.4421    0  372 16093.1740 33576.4421   109%     -  612s
     0     0 33568.2519    0  372 16093.1740 33568.2519   109%     -  616s
     0     0 33540.3340    0  371 16093.1740 33540.3340   108%     -  621s
     0     0 33469.5448    0  361 16093.1740 33469.5448   108%     -  637s
     0     0 33435.9257    0  366 16093.1740 33435.9257   108%     -  646s
     0     0 33380.0097    0  377 16093.1740 33380.0097   107%     -  660s
     0     0 33365.1944    0  377 16093.1740 33365.1944   107%     -  666s
     0     0 33345.0443    0  367 16093.1740 33345.0443   107%     -  674s
     0     0 33339.6794    0  375 16093.1740 33339.6794   107%     -  678s
     0     0 33338.4278    0  370 16093.1740 33338.4278   107%     -  680s
     0     0 32488.9072    0  348 16093.1740 32488.9072   102%     -  734s
     0     0 32169.0856    0  351 16093.1740 32169.0856   100%     -  758s
     0     0 31990.2799    0  354 16093.1740 31990.2799  98.8%     -  777s
     0     0 31965.0501    0  362 16093.1740 31965.0501  98.6%     -  783s
     0     0 31946.5663    0  370 16093.1740 31946.5663  98.5%     -  791s
     0     0 31734.0212    0  358 16093.1740 31734.0212  97.2%     -  809s
     0     0 31668.8890    0  368 16093.1740 31668.8890  96.8%     -  819s
     0     0 31637.0439    0  386 16093.1740 31637.0439  96.6%     -  828s
     0     0 31524.1953    0  366 16093.1740 31524.1953  95.9%     -  838s
     0     0 31505.1621    0  373 16093.1740 31505.1621  95.8%     -  844s
     0     0 31497.1883    0  373 16093.1740 31497.1883  95.7%     -  848s
     0     0 31493.5164    0  373 16093.1740 31493.5164  95.7%     -  850s
     0     0 31343.8803    0  347 16093.1740 31343.8803  94.8%     -  859s
     0     0 31331.1983    0  354 16093.1740 31331.1983  94.7%     -  864s
     0     0 31301.2946    0  374 16093.1740 31301.2946  94.5%     -  869s
     0     0 31295.3572    0  369 16093.1740 31295.3572  94.5%     -  871s
     0     0 31286.3163    0  367 16093.1740 31286.3163  94.4%     -  875s
     0     0 31283.1077    0  365 16093.1740 31283.1077  94.4%     -  876s
     0     0 31282.5687    0  361 16093.1740 31282.5687  94.4%     -  878s
     0     0 30750.8726    0  347 16093.1740 30750.8726  91.1%     -  906s
     0     0 30526.5442    0  359 16093.1740 30526.5442  89.7%     -  922s
     0     0 30477.3538    0  367 16093.1740 30477.3538  89.4%     -  929s
     0     0 30433.5528    0  367 16093.1740 30433.5528  89.1%     -  936s
     0     0 30427.4890    0  370 16093.1740 30427.4890  89.1%     -  939s
     0     0 30423.0574    0  369 16093.1740 30423.0574  89.0%     -  941s
     0     0 30411.7793    0  367 16093.1740 30411.7793  89.0%     -  944s
     0     0 30403.4984    0  369 16093.1740 30403.4984  88.9%     -  947s
     0     0 30402.1829    0  370 16093.1740 30402.1829  88.9%     -  949s
     0     0 30187.1709    0  358 16093.1740 30187.1709  87.6%     -  975s
H    0     0                    16155.798497 30187.0128  86.8%     -  986s
H    0     0                    17917.662242 30187.0128  68.5%     -  986s
H    0     0                    17988.813539 30187.0128  67.8%     -  987s
     0     0 30157.6774    0  374 17988.8135 30157.6774  67.6%     -  994s
     0     0 30150.4493    0  370 17988.8135 30150.4493  67.6%     -  999s
     0     0 30147.1604    0  374 17988.8135 30147.1604  67.6%     - 1002s
     0     0 30144.4886    0  441 17988.8135 30144.4886  67.6%     - 1005s
     0     0 30076.3546    0  373 17988.8135 30076.3546  67.2%     - 1019s
H    0     0                    18107.877029 30075.9654  66.1%     - 1019s
     0     0 30060.7170    0  374 18107.8770 30060.7170  66.0%     - 1028s
     0     0 30057.1677    0  380 18107.8770 30057.1677  66.0%     - 1034s
     0     0 30055.7167    0  382 18107.8770 30055.7167  66.0%     - 1038s
     0     0 30004.2517    0  436 18107.8770 30004.2517  65.7%     - 1055s
H    0     0                    18114.752901 30003.7359  65.6%     - 1056s
H    0     0                    18124.107482 30003.7359  65.5%     - 1057s
     0     0 29985.7430    0  370 18124.1075 29985.7430  65.4%     - 1064s
     0     0 29977.4648    0  362 18124.1075 29977.4648  65.4%     - 1070s
     0     0 29975.5360    0  364 18124.1075 29975.5360  65.4%     - 1071s
     0     0 29954.4003    0  365 18124.1075 29954.4003  65.3%     - 1082s
     0     0 29945.8526    0  372 18124.1075 29945.8526  65.2%     - 1087s
     0     0 29944.5475    0  378 18124.1075 29944.5475  65.2%     - 1090s
     0     0 29941.1615    0  382 18124.1075 29941.1615  65.2%     - 1094s
H    0     0                    18138.262351 29940.9340  65.1%     - 1107s
H    0     0                    18312.377038 29940.9340  63.5%     - 1107s
H    0     0                    18333.625967 29940.9340  63.3%     - 1107s
H    0     0                    18530.426378 29940.9340  61.6%     - 1110s
     0     0 29940.7635    0  381 18530.4264 29940.7635  61.6%     - 1112s
     0     0 29935.6175    0  383 18530.4264 29935.6175  61.5%     - 1118s
     0     0 29935.5249    0  383 18530.4264 29935.5249  61.5%     - 1123s
H    0     0                    18555.660643 29935.5249  61.3%     - 1182s
H    0     0                    18575.255742 29935.5249  61.2%     - 1237s
     0     2 29935.5249    0  383 18575.2557 29935.5249  61.2%     - 1240s
     1     3 29714.3011    1  357 18575.2557 29935.5249  61.2%  8314 1255s
     2     4 29775.1435    1  377 18575.2557 29775.1435  60.3%  7870 1271s
     3     5 28661.0204    2  325 18575.2557 29774.6331  60.3%  9842 1291s
     4     9 29466.7100    2  387 18575.2557 29773.1102  60.3%  9211 1316s
     8    18 28793.5493    3  358 18575.2557 29466.6132  58.6% 11378 1356s
    17    36 28762.6519    4  351 18575.2557 29263.0294  57.5% 10446 1376s
    35    50 28849.0716    5  354 18575.2557 29173.8581  57.1% 14106 3107s
H   49    78                    18584.297618 29173.8581  57.0% 22178 3172s
H   50    78                    18588.495733 29173.8581  56.9% 21995 3172s
H   57    78                    18701.503956 29173.8581  56.0% 20650 3172s
    77   184 28343.6610    7  330 18701.5040 29173.8581  56.0% 17746 3331s
   183   261 28022.7069   11  279 18701.5040 29173.8581  56.0% 10916 3376s
H  184   261                    18726.738221 29173.8581  55.8% 10857 3376s
   260   337 27630.2157   12  259 18726.7382 29173.8581  55.8%  9377 3412s
   338   380 27203.0382   13  257 18726.7382 29173.8581  55.8%  8094 3444s
   405   415 26737.2855   14  253 18726.7382 29173.8581  55.8%  7374 3475s
   470   442 26262.1195   16  240 18726.7382 29173.8581  55.8%  6941 3502s
   507   476 26162.0805   17  239 18726.7382 29173.8581  55.8%  6684 3534s
   551   511 26148.5187   18  230 18726.7382 29173.8581  55.8%  6538 3565s
   612   544 22919.8197   19  213 18726.7382 29173.8581  55.8%  6235 3594s
   665   551 18844.0237   24  175 18726.7382 29173.8581  55.8%  6010 3600s

Cutting planes:
  Gomory: 43
  Implied bound: 246
  MIR: 2627
  Flow cover: 2316
  RLT: 129
  Relax-and-lift: 815

Explored 682 nodes (4748800 simplex iterations) in 3600.05 seconds (4297.47 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 18726.7 18701.5 18588.5 ... 18138.3

Time limit reached
Best objective 1.872673822109e+04, best bound 2.917385811792e+04, gap 55.7872%
  WARNING: Time limit reached. Using best solution found (gap: 55.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 18726.74, θ = 155753.16
  Upper Bound (UB) = 18726.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155753.16
  [DEBUG]   ✓ Scenario 0: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 155753.16 ≤ Q = 155753.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 155753.16 ≤ Q = 155753.16 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xf5d3c71
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf0a2c38f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-14, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-16, 2e+02]
Found heuristic solution: objective 1.361923e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.01s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6671676.3422
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.720388e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -172038.77    0  132 6671676.34 -172038.77   103%     -    0s
H    0     0                    -133987.4843 -172038.77  28.4%     -    0s
H    0     0                    -134259.5877 -172038.77  28.1%     -    0s
     0     0 -148572.15    0   61 -134259.59 -148572.15  10.7%     -    0s
H    0     0                    -146563.8664 -148487.49  1.31%     -    0s
H    0     0                    -146833.4059 -148487.49  1.13%     -    0s
H    0     0                    -147038.5495 -148487.49  0.99%     -    0s
H    0     0                    -147308.0890 -148487.49  0.80%     -    0s
     0     0 -147744.18    0   43 -147308.09 -147744.18  0.30%     -    0s
     0     0 -147702.48    0   38 -147308.09 -147702.48  0.27%     -    0s
     0     0 -147687.13    0   37 -147308.09 -147687.13  0.26%     -    0s
     0     0 -147413.05    0   13 -147308.09 -147413.05  0.07%     -    0s
     0     0 -147408.45    0   12 -147308.09 -147408.45  0.07%     -    0s
     0     0 -147406.27    0    7 -147308.09 -147406.27  0.07%     -    0s
     0     0 -147393.16    0    6 -147308.09 -147393.16  0.06%     -    0s
H    0     0                    -147336.2417 -147393.16  0.04%     -    0s
     0     0 -147375.33    0    5 -147336.24 -147375.33  0.03%     -    0s
     0     0 -147371.30    0    7 -147336.24 -147371.30  0.02%     -    0s
*    0     0               0    -147358.3446 -147358.34  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 3
  Flow cover: 4
  Relax-and-lift: 2

Explored 1 nodes (647 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -147358 -147336 -147308 ... 1.36192e+13
No other solutions better than -147358

Optimal solution found (tolerance 1.00e-04)
Best objective -1.473583445611e+05, best bound -1.473583445611e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 147011.10
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147358.34
  [DEBUG]   S×d_nominal = 294369.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294369.45 + -147358.34 = 147011.10
  [DEBUG]   Current θ from Master = 155753.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8742.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9984.68
  Lower Bound (LB) = 17914.52
  Gap (UB-LB) = 812.2190, Absolute Gap = 812.2190, Relative Gap = 0.043372
  Not converged yet (gap = 812.22 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567795 nonzeros
Model fingerprint: 0xcf30bfa8
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82719 rows and 33579 columns
Presolve time: 3.18s
Presolved: 117434 rows, 49801 columns, 704633 nonzeros
Variable types: 47542 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366067.5801
Found heuristic solution: objective -203357.9198

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 683
 AA' NZ     : 4.019e+06
 Factor NZ  : 1.025e+07 (roughly 150 MB of memory)
 Factor Ops : 2.339e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.13516851e+07  2.13380138e+08  1.22e+05 2.20e+01  9.59e+04     5s
   1  -1.61411962e+07  1.94288441e+08  8.58e+04 7.35e+01  6.73e+04     5s
   2  -5.88553920e+06  1.43152287e+08  3.15e+04 6.59e+00  2.64e+04     5s
   3  -7.63398299e+05  1.13723673e+08  1.11e+03 1.64e+00  1.45e+03     5s
   4  -4.96106242e+05  3.78549822e+07  3.85e+02 2.17e-01  4.48e+02     6s
   5  -3.88573759e+05  2.85226191e+07  1.71e+02 1.50e-01  2.47e+02     6s
   6  -3.05225241e+05  2.15932457e+07  7.93e+01 1.08e-01  1.49e+02     6s
   7  -2.03054754e+05  1.59699492e+07  1.83e+01 7.44e-02  8.46e+01     6s
   8  -1.26028673e+05  9.26601373e+06  5.84e+00 4.37e-02  4.58e+01     6s
   9  -8.46309907e+04  3.55422764e+06  2.73e+00 1.56e-02  1.74e+01     6s
  10  -5.34041726e+04  1.76176797e+06  1.42e+00 7.39e-03  8.57e+00     6s
  11  -2.73560419e+04  1.15025828e+06  6.90e-01 4.71e-03  5.52e+00     6s
  12  -1.90706581e+04  5.55672622e+05  5.14e-01 2.14e-03  2.69e+00     6s
  13  -5.23658745e+03  2.68682065e+05  2.55e-01 9.27e-04  1.28e+00     6s
  14   1.71411314e+03  1.65830642e+05  1.92e-01 7.64e-04  7.66e-01     6s
  15   6.87014113e+03  1.37706138e+05  1.61e-01 1.15e-03  6.11e-01     7s
  16   1.38110559e+04  1.09299327e+05  1.27e-01 1.61e-03  4.46e-01     7s
  17   1.72718709e+04  9.88356325e+04  1.11e-01 1.46e-03  3.81e-01     7s
  18   2.07912779e+04  8.11296792e+04  9.63e-02 2.97e-03  2.82e-01     7s
  19   2.75199436e+04  7.30596102e+04  6.88e-02 2.89e-03  2.12e-01     7s
  20   3.07060743e+04  6.74892934e+04  5.70e-02 2.29e-03  1.72e-01     7s
  21   3.31553675e+04  6.28284601e+04  4.79e-02 2.75e-03  1.38e-01     7s
  22   3.56684888e+04  6.15108046e+04  3.91e-02 2.57e-03  1.21e-01     7s
  23   3.76777052e+04  5.91251206e+04  3.23e-02 2.10e-03  1.00e-01     7s
  24   4.01515975e+04  5.58846349e+04  2.45e-02 1.49e-03  7.34e-02     7s
  25   4.17092711e+04  5.38465227e+04  1.97e-02 1.08e-03  5.66e-02     8s
  26   4.29482638e+04  5.23872909e+04  1.58e-02 7.82e-04  4.40e-02     8s
  27   4.46638418e+04  5.13200563e+04  1.07e-02 5.78e-04  3.10e-02     8s
  28   4.52060744e+04  5.07567438e+04  9.16e-03 4.67e-04  2.59e-02     8s
  29   4.57682779e+04  5.04609787e+04  7.49e-03 4.05e-04  2.19e-02     8s
  30   4.59813278e+04  5.02425788e+04  6.86e-03 3.62e-04  1.99e-02     8s
  31   4.66085899e+04  4.97427489e+04  5.08e-03 2.55e-04  1.46e-02     8s
  32   4.70435766e+04  4.93646733e+04  3.86e-03 1.78e-04  1.08e-02     8s
  33   4.72158965e+04  4.90896972e+04  3.37e-03 1.23e-04  8.74e-03     9s
  34   4.76593835e+04  4.89847511e+04  2.21e-03 1.00e-04  6.18e-03     9s
  35   4.78572680e+04  4.88543559e+04  1.68e-03 7.19e-05  4.65e-03     9s
  36   4.79623767e+04  4.87877570e+04  1.41e-03 5.81e-05  3.85e-03     9s
  37   4.81001657e+04  4.87385113e+04  1.04e-03 6.29e-05  2.98e-03     9s
  38   4.82626612e+04  4.86225802e+04  6.17e-04 8.23e-05  1.68e-03     9s
  39   4.82803772e+04  4.86184601e+04  5.71e-04 7.93e-05  1.58e-03     9s
  40   4.84078486e+04  4.85604546e+04  2.45e-04 5.29e-05  7.12e-04    10s
  41   4.84570205e+04  4.85414147e+04  1.24e-04 3.19e-05  3.94e-04    10s
  42   4.84778465e+04  4.85321673e+04  7.14e-05 2.20e-05  2.53e-04    10s
  43   4.84868155e+04  4.85292720e+04  5.12e-05 1.88e-05  1.98e-04    10s
  44   4.85040779e+04  4.85211130e+04  1.32e-05 1.02e-05  7.94e-05    10s
  45   4.85102130e+04  4.85147225e+04  1.20e-06 3.65e-06  2.10e-05    10s
  46   4.85109920e+04  4.85116431e+04  7.87e-08 5.26e-07  3.03e-06    10s
  47   4.85110679e+04  4.85111348e+04  1.71e-08 5.01e-08  3.11e-07    10s
  48   4.85110719e+04  4.85110774e+04  7.97e-09 6.55e-10  2.57e-08    11s
  49   4.85110719e+04  4.85110774e+04  2.48e-07 6.53e-10  2.56e-08    11s
  50   4.85110733e+04  4.85110770e+04  2.09e-07 4.37e-09  1.74e-08    11s
  51   4.85110754e+04  4.85110765e+04  8.03e-07 8.52e-08  5.14e-09    11s
  52   4.85110754e+04  4.85110765e+04  8.30e-07 8.42e-08  5.08e-09    11s
  53   4.85110754e+04  4.85110765e+04  2.42e-06 8.08e-08  4.95e-09    11s
  54   4.85110755e+04  4.85110765e+04  2.07e-06 7.48e-08  4.30e-09    12s

Barrier solved model in 54 iterations and 11.53 seconds (11.24 work units)
Optimal objective 4.85110755e+04


Root crossover log...

  102867 DPushes remaining with DInf 0.0000000e+00                12s
    6026 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   33066 PPushes remaining with PInf 1.2304839e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1262028e+04     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   82000    4.8511076e+04   0.000000e+00   1.126203e+04     18s
   82483    4.8511076e+04   0.000000e+00   0.000000e+00     19s
   82483    4.8511076e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 4.851108e+04, 82483 iterations, 14.66 seconds (16.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48511.0764    0  233 -203357.92 48511.0764   124%     -   19s
H    0     0                    -192817.4921 48511.0764   125%     -   20s
H    0     0                    -189950.3577 48511.0764   126%     -   20s
H    0     0                    -171103.6339 48511.0764   128%     -   20s
H    0     0                    -167280.3486 48511.0764   129%     -   20s
H    0     0                    -166700.6875 48511.0764   129%     -   21s
H    0     0                    -161779.1059 48511.0764   130%     -   21s
H    0     0                    -161456.0354 48511.0764   130%     -   21s
H    0     0                    -30508.90456 48511.0764   259%     -   21s
H    0     0                    12124.291908 48511.0764   300%     -   21s
H    0     0                    12982.207688 48511.0764   274%     -   22s
H    0     0                    13682.678390 48511.0764   255%     -   22s
H    0     0                    13744.334961 42497.8211   209%     -   95s
H    0     0                    14003.383295 42497.8211   203%     -   95s
H    0     0                    14018.932747 42497.8211   203%     -   95s
     0     0 42497.8211    0  330 14018.9327 42497.8211   203%     -   95s
     0     0 41658.5432    0  358 14018.9327 41658.5432   197%     -  141s
     0     0 41658.5432    0  354 14018.9327 41658.5432   197%     -  151s
     0     0 41520.3283    0  348 14018.9327 41520.3283   196%     -  155s
     0     0 41507.7239    0  348 14018.9327 41507.7239   196%     -  157s
     0     0 41506.9667    0  348 14018.9327 41506.9667   196%     -  158s
H    0     0                    14072.585865 39508.1662   181%     -  236s
H    0     0                    14159.205344 39508.1662   179%     -  236s
H    0     0                    14204.202120 39508.1662   178%     -  236s
H    0     0                    14213.330863 39508.1662   178%     -  236s
     0     0 39454.9306    0  369 14213.3309 39454.9306   178%     -  236s
H    0     0                    14214.608254 39454.9306   178%     -  237s
H    0     0                    14220.250075 39454.9306   177%     -  237s
     0     0 38667.9277    0  390 14220.2501 38667.9277   172%     -  318s
H    0     0                    15414.588037 38171.1685   148%     -  379s
     0     0 38171.1685    0  395 15414.5880 38171.1685   148%     -  391s
     0     0 38078.5016    0  394 15414.5880 38078.5016   147%     -  428s
H    0     0                    15658.911783 38037.3076   143%     -  438s
H    0     0                    15930.317792 38037.3076   139%     -  438s
     0     0 38037.3076    0  395 15930.3178 38037.3076   139%     -  440s
     0     0 37913.6371    0  406 15930.3178 37913.6371   138%     -  488s
     0     0 37857.7078    0  410 15930.3178 37857.7078   138%     -  508s
     0     0 37829.6236    0  406 15930.3178 37829.6236   137%     -  520s
     0     0 37825.2560    0  408 15930.3178 37825.2560   137%     -  529s
H    0     0                    15974.599313 37810.3449   137%     -  536s
     0     0 37810.3449    0  416 15974.5993 37810.3449   137%     -  536s
     0     0 37739.9602    0  408 15974.5993 37739.9602   136%     -  562s
     0     0 37731.0318    0  406 15974.5993 37731.0318   136%     -  568s
     0     0 37586.9827    0  399 15974.5993 37586.9827   135%     -  598s
     0     0 37564.2774    0  425 15974.5993 37564.2774   135%     -  610s
     0     0 37554.9614    0  422 15974.5993 37554.9614   135%     -  615s
H    0     0                    15987.154674 37546.0105   135%     -  620s
H    0     0                    16110.163482 37546.0105   133%     -  620s
     0     0 37546.0105    0  422 16110.1635 37546.0105   133%     -  620s
     0     0 37545.7122    0  423 16110.1635 37545.7122   133%     -  622s
H    0     0                    16190.255084 34083.0449   111%     -  751s
     0     0 34083.0449    0  366 16190.2551 34083.0449   111%     -  764s
     0     0 33183.6840    0  397 16190.2551 33183.6840   105%     -  819s
     0     0 33046.0442    0  373 16190.2551 33046.0442   104%     -  844s
     0     0 32933.8296    0  373 16190.2551 32933.8296   103%     -  868s
     0     0 32899.1217    0  371 16190.2551 32899.1217   103%     -  880s
     0     0 32887.4555    0  382 16190.2551 32887.4555   103%     -  889s
     0     0 32882.4785    0  372 16190.2551 32882.4785   103%     -  895s
     0     0 32872.5752    0  372 16190.2551 32872.5752   103%     -  902s
     0     0 32853.3258    0  387 16190.2551 32853.3258   103%     -  914s
     0     0 32851.0755    0  377 16190.2551 32851.0755   103%     -  918s
     0     0 31771.4939    0  375 16190.2551 31771.4939  96.2%     -  998s
     0     0 31337.2221    0  384 16190.2551 31337.2221  93.6%     - 1048s
     0     0 31268.6166    0  373 16190.2551 31268.6166  93.1%     - 1071s
     0     0 31185.5205    0  384 16190.2551 31185.5205  92.6%     - 1094s
     0     0 31113.5997    0  374 16190.2551 31113.5997  92.2%     - 1109s
     0     0 31035.3550    0  375 16190.2551 31035.3550  91.7%     - 1122s
     0     0 31005.9772    0  367 16190.2551 31005.9772  91.5%     - 1136s
     0     0 30998.6974    0  371 16190.2551 30998.6974  91.5%     - 1142s
     0     0 30973.7114    0  365 16190.2551 30973.7114  91.3%     - 1154s
     0     0 30964.7336    0  371 16190.2551 30964.7336  91.3%     - 1161s
     0     0 30954.2760    0  366 16190.2551 30954.2760  91.2%     - 1170s
     0     0 30948.2138    0  373 16190.2551 30948.2138  91.2%     - 1178s
     0     0 30944.6004    0  429 16190.2551 30944.6004  91.1%     - 1181s
     0     0 30943.6811    0  372 16190.2551 30943.6811  91.1%     - 1183s
     0     0 30411.6624    0  367 16190.2551 30411.6624  87.8%     - 1224s
     0     0 30292.4013    0  355 16190.2551 30292.4013  87.1%     - 1257s
     0     0 30257.1986    0  360 16190.2551 30257.1986  86.9%     - 1270s
     0     0 30235.1912    0  368 16190.2551 30235.1912  86.7%     - 1285s
     0     0 30224.3013    0  355 16190.2551 30224.3013  86.7%     - 1290s
     0     0 30221.4524    0  360 16190.2551 30221.4524  86.7%     - 1293s
     0     0 30218.5947    0  365 16190.2551 30218.5947  86.6%     - 1296s
     0     0 30215.2876    0  364 16190.2551 30215.2876  86.6%     - 1300s
     0     0 30214.0763    0  366 16190.2551 30214.0763  86.6%     - 1302s
     0     0 30154.3646    0  361 16190.2551 30154.3646  86.3%     - 1333s
H    0     0                    16329.247633 30153.5908  84.7%     - 1337s
H    0     0                    16329.833828 30153.5908  84.7%     - 1338s
H    0     0                    16334.217220 30153.5908  84.6%     - 1338s
     0     0 30134.7787    0  349 16334.2172 30134.7787  84.5%     - 1355s
     0     0 30127.9293    0  354 16334.2172 30127.9293  84.4%     - 1364s
     0     0 30126.7629    0  357 16334.2172 30126.7629  84.4%     - 1367s
     0     0 30061.8409    0  369 16334.2172 30061.8409  84.0%     - 1388s
     0     0 30045.4472    0  437 16334.2172 30045.4472  83.9%     - 1397s
     0     0 30039.4078    0  368 16334.2172 30039.4078  83.9%     - 1403s
     0     0 30033.3454    0  368 16334.2172 30033.3454  83.9%     - 1407s
     0     0 30025.7704    0  379 16334.2172 30025.7704  83.8%     - 1413s
     0     0 30024.7943    0  378 16334.2172 30024.7943  83.8%     - 1417s
     0     0 29998.4581    0  347 16334.2172 29998.4581  83.7%     - 1431s
H    0     0                    16344.874737 29998.4574  83.5%     - 1432s
     0     0 29991.4069    0  359 16344.8747 29991.4069  83.5%     - 1437s
     0     0 29990.7843    0  368 16344.8747 29990.7843  83.5%     - 1439s
     0     0 29979.0329    0  371 16344.8747 29979.0329  83.4%     - 1448s
     0     0 29975.0428    0  367 16344.8747 29975.0428  83.4%     - 1455s
     0     0 29973.6171    0  361 16344.8747 29973.6171  83.4%     - 1457s
     0     0 29957.6242    0  448 16344.8747 29957.6242  83.3%     - 1469s
     0     0 29956.3304    0  448 16344.8747 29956.3304  83.3%     - 1476s
H    0     0                    16351.322839 29956.3304  83.2%     - 1523s
H    0     0                    16402.467687 29956.3304  82.6%     - 1523s
H    0     0                    16503.580029 29956.3304  81.5%     - 1523s
H    0     0                    16507.406540 29956.3304  81.5%     - 1523s
H    0     0                    16508.726629 29956.3304  81.5%     - 1523s
H    0     0                    16509.312825 29956.3304  81.5%     - 1523s
     0     2 29956.3304    0  448 16509.3128 29956.3304  81.5%     - 1611s
     1     3 29654.2065    1  422 16509.3128 29956.3304  81.5% 15452 1638s
     2     5 29018.0445    2  351 16509.3128 29956.3304  81.5% 15240 1668s
     4    10 28697.5458    3  353 16509.3128 29813.1818  80.6% 11355 1696s
     9    20 28529.3262    4  342 16509.3128 29727.8605  80.1% 10172 1746s
    19    40 28150.2510    5  346 16509.3128 29415.9039  78.2% 12344 1779s
    39    52 27686.5755    5  411 16509.3128 29008.0499  75.7% 16383 1852s
    51    69 26070.8332    6  334 16509.3128 29008.0499  75.7% 19097 1932s
    68   154 26415.5449    7  285 16509.3128 29008.0499  75.7% 16789 2002s
   153   185 25731.9202    9  267 16509.3128 29008.0499  75.7% 13490 2047s
H  163   185                    16721.511023 29008.0499  73.5% 13054 2047s
   184   271 25686.9967   10  268 16721.5110 29008.0499  73.5% 12508 2103s
   270   322 25376.1242   14  224 16721.5110 29008.0499  73.5%  9876 2152s
   321   363 25116.1801   16  226 16721.5110 29008.0499  73.5%  9154 2200s
   362   393 20889.7855   18  172 16721.5110 29008.0499  73.5%  8779 2235s
H  374   393                    16819.045107 29008.0499  72.5%  8663 2235s
   392   483 20854.0859   19  168 16819.0451 29008.0499  72.5%  8607 2274s
   482   509 20513.3405   24  164 16819.0451 29008.0499  72.5%  7691 2308s
H  489   509                    17151.747112 29008.0499  69.1%  7622 2308s
   512   607 20467.2782   25  160 17151.7471 29008.0499  69.1%  7532 2347s
   616   696 18189.6668   27  151 17151.7471 29008.0499  69.1%  6707 2376s
   711   777     cutoff   30      17151.7471 29008.0499  69.1%  6189 2403s
   816   843 18111.5752   29  145 17151.7471 29008.0499  69.1%  5663 2434s
   916   896 17951.6490   31  141 17151.7471 29008.0499  69.1%  5301 2463s
  1007   943     cutoff   34      17151.7471 29008.0499  69.1%  5058 2496s
  1092  1031     cutoff   33      17151.7471 29008.0499  69.1%  4886 2525s
  1223  1097     cutoff   32      17151.7471 29008.0499  69.1%  4589 2553s
  1362  1167 18391.7222   38  121 17151.7471 29008.0499  69.1%  4287 2583s
  1505  1192 infeasible   47      17151.7471 29008.0499  69.1%  4048 2618s
  1601  1215 21686.7379   19  210 17151.7471 29008.0499  69.1%  3952 2654s
  1691  1269 21463.4125   21  205 17151.7471 29008.0499  69.1%  3888 2690s
H 1811  1282                    17252.101498 29008.0499  68.1%  3801 2729s
H 1821  1282                    17601.467781 29008.0499  64.8%  3824 2729s
H 1870  1282                    17614.387209 29008.0499  64.7%  3819 2729s
  1878  1310 19896.3889   28  161 17614.3872 29008.0499  64.7%  3812 2771s
H 1963  1330                    17727.761647 29008.0499  63.6%  3787 2814s
H 1973  1330                    17745.743689 29008.0499  63.5%  3803 2814s
H 1986  1330                    17752.523158 29008.0499  63.4%  3805 2814s
  2031  1397 infeasible   35      17752.5232 29008.0499  63.4%  3817 2858s
  2130  1461     cutoff   37      17752.5232 29008.0499  63.4%  3821 2904s
  2236  1528 20054.6027   19  118 17752.5232 29008.0499  63.4%  3829 2954s
  2359  1572 18791.8166   22   47 17752.5232 29008.0499  63.4%  3807 3001s
  2488  1592 18982.4725   32  162 17752.5232 29008.0499  63.4%  3780 3044s
  2524  1620 23987.4289   13  285 17752.5232 29008.0499  63.4%  3808 3087s
H 2528  1620                    17771.836050 29008.0499  63.2%  3809 3087s
H 2541  1620                    17871.217804 29008.0499  62.3%  3813 3088s
  2566  1672 23745.6593   15  261 17871.2178 29008.0499  62.3%  3814 3139s
H 2684  1725                    17963.870925 29008.0499  61.5%  3838 3190s
H 2708  1725                    18054.516865 29008.0499  60.7%  3832 3190s
H 2770  1725                    18059.426490 29008.0499  60.6%  3841 3190s
  2798  1759 18644.3875   19  198 18059.4265 29008.0499  60.6%  3879 3249s
  2911  1773 18284.9448   20  186 18059.4265 29008.0499  60.6%  3923 3299s
H 2933  1773                    18061.623065 29008.0499  60.6%  3932 3299s
H 2959  1773                    18072.991901 29008.0499  60.5%  3948 3299s
  2992  1779 20198.7343   31  322 18072.9919 29008.0499  60.5%  3967 3376s
  3089  1817 20122.0950   33  261 18072.9919 29008.0499  60.5%  3999 3434s
  3197  1927 20075.2146   34  254 18072.9919 29008.0499  60.5%  4060 3496s
  3333  2059 19326.8314   37  224 18072.9919 29008.0499  60.5%  4089 3559s
  3508  2154 infeasible   40      18072.9919 29008.0499  60.5%  4085 3600s

Cutting planes:
  Learned: 1
  Gomory: 39
  Implied bound: 301
  MIR: 2797
  Flow cover: 2412
  RLT: 130
  Relax-and-lift: 1122

Explored 3654 nodes (15572950 simplex iterations) in 3600.08 seconds (4941.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 18073 18061.6 18059.4 ... 17727.8

Time limit reached
Best objective 1.807299190102e+04, best bound 2.900804989439e+04, gap 60.5050%
  WARNING: Time limit reached. Using best solution found (gap: 60.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 18072.99, θ = 159059.08
  Upper Bound (UB) = 18072.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 159059.08
  [DEBUG]   ✓ Scenario 0: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 159059.08 ≤ Q = 159059.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 159059.08 ≤ Q = 159059.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 159059.08 ≤ Q = 159059.08 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x47bad427
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x47bad427
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.300826e+13
Presolve removed 2563 rows and 1854 columns
Presolve time: 0.01s
Presolved: 530 rows, 535 columns, 1496 nonzeros
Found heuristic solution: objective 6678579.4522
Variable types: 362 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6678299.6995

Root relaxation: objective -1.610819e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161081.95    0  129 6678299.70 -161081.95   102%     -    0s
H    0     0                    -129533.6598 -161081.95  24.4%     -    0s
H    0     0                    -129813.4125 -161081.95  24.1%     -    0s
H    0     0                    -129869.4669 -161081.95  24.0%     -    0s
     0     0 -140192.90    0   50 -129869.47 -140192.90  7.95%     -    0s
H    0     0                    -138228.0092 -140105.05  1.36%     -    0s
     0     0 -139866.92    0   41 -138228.01 -139866.92  1.19%     -    0s
H    0     0                    -139031.0720 -139866.92  0.60%     -    0s
H    0     0                    -139300.6115 -139866.92  0.41%     -    0s
     0     0 -139388.80    0    8 -139300.61 -139388.80  0.06%     -    0s
     0     0 -139359.75    0    5 -139300.61 -139359.75  0.04%     -    0s
     0     0 -139318.99    0    4 -139300.61 -139318.99  0.01%     -    0s

Cutting planes:
  Gomory: 21
  MIR: 150
  Flow cover: 4
  RLT: 26
  Relax-and-lift: 4
  BQP: 4

Explored 1 nodes (480 simplex iterations) in 0.04 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -139301 -139031 -129869 ... 1.30083e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.393006115057e+05, best bound -1.393139927124e+05, gap 0.0096%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 147510.96
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139300.61
  [DEBUG]   S×d_nominal = 286811.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 286811.58 + -139300.61 = 147510.96
  [DEBUG]   Current θ from Master = 159059.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11548.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6524.88
  Lower Bound (LB) = 17914.52
  Gap (UB-LB) = 158.4727, Absolute Gap = 158.4727, Relative Gap = 0.008768
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 13
Total Time: 28045.13s
Converged: True
Final Lower Bound: 17914.5192
Final Upper Bound: 18072.9919
Final Gap: 158.472696
Number of Critical Scenarios: 13
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 3, 5, 8] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 4 customers  Mode 1: 10 customers  Mode 2: 36 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 13
Start Time: 2026-01-05 15:25:04
End Time: 2026-01-05 23:12:29
Total Time: 28045.13s
Optimal Value: 17914.52
Lower Bound: 17914.52
Upper Bound: 18072.99
Gap: 158.472696
Plants Opened: {0: [1], 1: [0], 2: [2]} (3 plants)
DCs Opened: [2, 3, 5, 8] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed40_Mixed_gamma20_20260105_231229.csv

Total Execution Time: 28045.53 seconds
End Time: 2026-01-05 23:12:29

All tasks completed successfully!

