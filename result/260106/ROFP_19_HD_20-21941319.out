
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 19
DI Scenario: HD
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed19.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
  Product 1: ['1.000', '1.331', '1.773'] (k=0.706)
  Product 2: ['1.000', '1.311', '1.720'] (k=0.669)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=927, max=1790
  DC capacity (MC): min=401, max=818

Demand Structure (s_rk matrix):
  Total customer-product pairs: 78/150 (48.0% sparse)
  Average products per customer: 1.56

Demand (only non-zero entries):
  Nominal (μ): min=8.20, max=34.38, count=78
  Deviation (μ̂): min=4.15, max=10.00

Costs:
  Plant fixed cost: min=5642, max=9474
  DC fixed cost: min=3448, max=5966
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.331', '1.773'] (k=0.706)
    Product 2: ['1.000', '1.311', '1.720'] (k=0.669)
  MD:
    Product 0: ['1.000', '1.286', '1.654'] (k=0.620)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.177', '1.385'] (k=0.402)
  LD:
    Product 0: ['1.000', '1.042', '1.086'] (k=0.102)
    Product 1: ['1.000', '1.040', '1.081'] (k=0.096)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
  Mixed:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48744 nonzeros
Model fingerprint: 0xad1d880e
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11953 rows and 2953 columns
Presolve time: 0.08s
Presolved: 4720 rows, 5547 columns, 32846 nonzeros
Variable types: 3288 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285806.1604
Found heuristic solution: objective -185609.9094

Root relaxation: objective 1.215797e+05, 5001 iterations, 0.21 seconds (0.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 121579.749    0  530 -185609.91 121579.749   166%     -    0s
H    0     0                    -175745.6407 121579.749   169%     -    0s
     0     0 107609.965    0  750 -175745.64 107609.965   161%     -    0s
     0     0 107456.006    0  769 -175745.64 107456.006   161%     -    1s
     0     0 107444.369    0  769 -175745.64 107444.369   161%     -    1s
     0     0 107444.133    0  771 -175745.64 107444.133   161%     -    1s
H    0     0                    -150803.5465 98103.7859   165%     -    2s
     0     0 98103.7859    0  834 -150803.55 98103.7859   165%     -    2s
     0     0 97771.4336    0  851 -150803.55 97771.4336   165%     -    2s
     0     0 97738.5716    0  857 -150803.55 97738.5716   165%     -    2s
     0     0 97733.8628    0  873 -150803.55 97733.8628   165%     -    2s
     0     0 91228.4114    0  797 -150803.55 91228.4114   160%     -    3s
     0     0 90796.4428    0  877 -150803.55 90796.4428   160%     -    3s
     0     0 90705.7865    0  881 -150803.55 90705.7865   160%     -    3s
     0     0 90698.9070    0  879 -150803.55 90698.9070   160%     -    3s
H    0     0                    -147491.4005 90698.9070   161%     -    4s
H    0     0                    -147381.0853 90698.9070   162%     -    4s
H    0     0                    5952.5800041 90698.9070  1424%     -    4s
H    0     0                    5954.1882928 81304.5676  1266%     -    5s
H    0     0                    7023.8903639 81304.5676  1058%     -    5s
H    0     0                    7137.8036436 81304.5676  1039%     -    5s
H    0     0                    7580.2261118 81304.5676   973%     -    5s
H    0     0                    8037.3569248 81304.5676   912%     -    5s
H    0     0                    8344.1669291 81304.5676   874%     -    5s
H    0     0                    8545.5442401 81304.5676   851%     -    5s
H    0     0                    8880.9299223 81304.5676   815%     -    5s
     0     0 81304.5676    0  576 8880.92992 81304.5676   815%     -    5s
H    0     0                    8918.9457572 80451.7922   802%     -    5s
H    0     0                    8922.3972861 80451.7922   802%     -    5s
H    0     0                    9055.3747115 80451.7922   788%     -    5s
H    0     0                    9097.9461141 80451.7922   784%     -    5s
H    0     0                    9512.8892866 80451.7922   746%     -    5s
H    0     0                    14074.774599 80451.7922   472%     -    5s
H    0     0                    14187.411101 80451.7922   467%     -    5s
H    0     0                    14560.692370 80451.7922   453%     -    5s
H    0     0                    14807.916074 80451.7922   443%     -    5s
H    0     0                    15548.143339 80451.7922   417%     -    5s
H    0     0                    15551.274099 80451.7922   417%     -    5s
H    0     0                    15788.158771 80451.7922   410%     -    5s
     0     0 80451.7922    0  590 15788.1588 80451.7922   410%     -    5s
H    0     0                    15831.069146 80215.6022   407%     -    5s
H    0     0                    16170.719619 80215.6022   396%     -    5s
H    0     0                    16177.706133 80215.6022   396%     -    5s
H    0     0                    16273.690603 80215.6022   393%     -    5s
     0     0 80215.6022    0  649 16273.6906 80215.6022   393%     -    5s
     0     0 80175.6322    0  712 16273.6906 80175.6322   393%     -    5s
     0     0 80156.4750    0  668 16273.6906 80156.4750   393%     -    5s
     0     0 80153.2643    0  670 16273.6906 80153.2643   393%     -    5s
     0     0 77412.8038    0  661 16273.6906 77412.8038   376%     -    6s
     0     0 76915.1835    0  708 16273.6906 76915.1835   373%     -    6s
H    0     0                    16405.233805 76740.6879   368%     -    6s
H    0     0                    16405.235574 76740.6879   368%     -    6s
H    0     0                    16509.953768 76740.6879   365%     -    6s
H    0     0                    16574.580080 76740.6879   363%     -    6s
     0     0 76740.6879    0  694 16574.5801 76740.6879   363%     -    6s
     0     0 76695.3892    0  722 16574.5801 76695.3892   363%     -    7s
     0     0 76682.6943    0  711 16574.5801 76682.6943   363%     -    7s
H    0     0                    28775.142012 75063.0608   161%     -    7s
     0     0 75063.0608    0  736 28775.1420 75063.0608   161%     -    7s
     0     0 74531.9819    0  804 28775.1420 74531.9819   159%     -    8s
     0     0 74409.7832    0  837 28775.1420 74409.7832   159%     -    8s
     0     0 74378.2293    0  812 28775.1420 74378.2293   158%     -    8s
     0     0 74360.3864    0  893 28775.1420 74360.3864   158%     -    8s
H    0     0                    30019.919945 72914.0693   143%     -    9s
H    0     0                    31577.505461 72914.0693   131%     -    9s
H    0     0                    32740.627540 72914.0693   123%     -    9s
H    0     0                    33623.252088 72914.0693   117%     -    9s
H    0     0                    33708.229803 72914.0693   116%     -    9s
H    0     0                    33862.282286 72914.0693   115%     -    9s
     0     0 72914.0693    0  802 33862.2823 72914.0693   115%     -    9s
     0     0 72689.3258    0  784 33862.2823 72689.3258   115%     -    9s
     0     0 72626.2181    0  862 33862.2823 72626.2181   114%     -    9s
     0     0 72584.8557    0  875 33862.2823 72584.8557   114%     -   10s
H    0     0                    34602.443094 72570.3522   110%     -   10s
H    0     0                    34624.674858 72570.3522   110%     -   10s
H    0     0                    38002.740664 72570.3522  91.0%     -   10s
H    0     0                    38988.896423 72570.3522  86.1%     -   10s
H    0     0                    39538.887924 72570.3522  83.5%     -   10s
H    0     0                    39844.331586 72570.3522  82.1%     -   10s
H    0     0                    39859.475520 72570.3522  82.1%     -   10s
     0     0 72570.3522    0  868 39859.4755 72570.3522  82.1%     -   10s
H    0     0                    39976.587077 72570.3522  81.5%     -   10s
H    0     0                    40056.808109 71649.9372  78.9%     -   10s
     0     0 71649.9372    0  740 40056.8081 71649.9372  78.9%     -   10s
     0     0 71468.0388    0  780 40056.8081 71468.0388  78.4%     -   11s
     0     0 71407.9525    0  814 40056.8081 71407.9525  78.3%     -   11s
     0     0 71382.6749    0  823 40056.8081 71382.6749  78.2%     -   11s
     0     0 70721.6863    0  816 40056.8081 70721.6863  76.6%     -   12s
     0     0 70535.1729    0  800 40056.8081 70535.1729  76.1%     -   12s
     0     0 70482.0936    0  808 40056.8081 70482.0936  76.0%     -   13s
     0     0 70450.1846    0  838 40056.8081 70450.1846  75.9%     -   13s
H    0     0                    40106.197821 69906.7995  74.3%     -   13s
H    0     0                    40195.736578 69906.7995  73.9%     -   13s
H    0     0                    40278.425027 69906.7995  73.6%     -   13s
     0     0 69906.7995    0  819 40278.4250 69906.7995  73.6%     -   13s
     0     0 69757.7258    0  848 40278.4250 69757.7258  73.2%     -   14s
     0     0 69713.8299    0  883 40278.4250 69713.8299  73.1%     -   14s
     0     0 69695.8796    0  863 40278.4250 69695.8796  73.0%     -   14s
H    0     0                    40346.963475 69330.9975  71.8%     -   15s
H    0     0                    40350.388079 69330.9975  71.8%     -   15s
H    0     0                    40473.307385 69330.9975  71.3%     -   15s
H    0     0                    40517.992481 69330.9975  71.1%     -   15s
     0     0 69330.9975    0  825 40517.9925 69330.9975  71.1%     -   15s
     0     0 69207.6326    0  848 40517.9925 69207.6326  70.8%     -   15s
     0     0 69168.8403    0  857 40517.9925 69168.8403  70.7%     -   15s
H    0     0                    40633.035587 68857.0519  69.5%     -   16s
H    0     0                    40641.195759 68857.0519  69.4%     -   16s
     0     0 68857.0519    0  625 40641.1958 68857.0519  69.4%     -   16s
     0     0 68737.9103    0  718 40641.1958 68737.9103  69.1%     -   16s
     0     0 68698.3505    0  666 40641.1958 68698.3505  69.0%     -   16s
H    0     0                    40647.732975 68484.0455  68.5%     -   17s
H    0     0                    40668.769559 68484.0455  68.4%     -   17s
     0     0 68484.0455    0  757 40668.7696 68484.0455  68.4%     -   17s
     0     0 68483.9116    0  757 40668.7696 68483.9116  68.4%     -   17s
     0     2 68479.9449    0  757 40668.7696 68479.9449  68.4%     -   18s
     3     8 67855.5650    2  626 40668.7696 68219.5136  67.7%  1405   20s
    63    96 65271.4095    6  615 40668.7696 67064.8569  64.9%  2250   25s
H   95   182                    40783.366232 67064.5503  64.4%  1731   26s
H  113   182                    40824.922165 67064.5503  64.3%  1707   26s
H  161   182                    40841.468121 67064.5503  64.2%  1469   26s
H  306   322                    53390.157168 67064.5503  25.6%  1236   27s
H  483   458                    53572.069665 67064.5503  25.2%  1018   29s
H  498   458                    53700.279415 67064.5503  24.9%  1012   29s
   502   558 61080.4147   14  512 53700.2794 67064.5503  24.9%  1010   30s
H 1342  1264                    54072.224929 66935.0385  23.8%   611   33s
  1590  1559 59115.3542   39  386 54072.2249 66935.0385  23.8%   566   35s
H 2017  1851                    54082.111771 66746.0975  23.4%   508   37s
  2429  2007 59168.3258    9  439 54082.1118 66500.1988  23.0%   521   40s
  3025  2217 60192.5226    9  444 54082.1118 65319.3889  20.8%   562   45s
  3403  2409     cutoff   17      54082.1118 65129.3779  20.4%   582   50s
  4223  2715 60241.3291    9  508 54082.1118 64717.5808  19.7%   586   55s
  5136  2948 57715.1555   11  206 54082.1118 63744.9788  17.9%   607   60s
  5996  3140 infeasible   13      54082.1118 63555.2002  17.5%   622   65s
  6591  3227 59769.8295   12  757 54082.1118 63273.2299  17.0%   617   75s
  6619  3246 60886.2637   28  449 54082.1118 63273.2299  17.0%   615   80s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  Projected implied bound: 11
  MIR: 87
  Flow cover: 290
  RLT: 4
  Relax-and-lift: 45
  BQP: 1

Explored 6990 nodes (4214017 simplex iterations) in 82.95 seconds (185.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54082.1 54072.2 53700.3 ... 40647.7

Optimal solution found (tolerance 1.00e-04)
Best objective 5.408211177085e+04, best bound 5.408211177085e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 82.96s
  Master Objective (UB) = 54082.11, θ = 200067.61
  Upper Bound (UB) = 54082.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 200067.61
  [DEBUG]   ✓ Scenario 0: θ = 200067.61 ≤ Q = 200067.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7bd3a2d0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x842c5d30
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.404567e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 6431856.2739
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.603244e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160324.45    0  121 6431856.27 -160324.45   102%     -    0s
H    0     0                    -126811.4546 -160324.45  26.4%     -    0s
H    0     0                    -127360.5272 -160324.45  25.9%     -    0s
H    0     0                    -128658.4409 -128658.44  0.00%     -    0s
     0     0          -    0      -128658.44 -128658.44  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 199

Explored 1 nodes (350 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -128658 -127361 -126811 ... 1.40457e+13
No other solutions better than -128658

Optimal solution found (tolerance 1.00e-04)
Best objective -1.286584409435e+05, best bound -1.286584409435e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 169763.97
  Scenario: 0 demand increases, 59 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128658.44
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -128658.44 = 169763.97
  [DEBUG]   Current θ from Master = 200067.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 30303.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23778.48
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 30303.6343, Absolute Gap = 30303.6343, Relative Gap = 0.560326
  Not converged yet (gap = 30303.63 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 59 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91969 nonzeros
Model fingerprint: 0xe6c597d9
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 23778.5 (0.01s)
MIP start from previous solve produced solution with objective 23778.5 (0.01s)
Loaded MIP start from previous solve with objective 23778.5

Presolve removed 14605 rows and 5924 columns
Presolve time: 0.32s
Presolved: 17358 rows, 8816 columns, 95998 nonzeros
Variable types: 6557 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.087165e+04, 9988 iterations, 1.25 seconds (2.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60871.6503    0  356 23778.4775 60871.6503   156%     -    1s
H    0     0                    23909.159764 60871.6503   155%     -    1s
     0     0 54500.7646    0  386 23909.1598 54500.7646   128%     -    2s
     0     0 54230.5935    0  358 23909.1598 54230.5935   127%     -    3s
     0     0 54217.7524    0  358 23909.1598 54217.7524   127%     -    3s
     0     0 54202.0445    0  364 23909.1598 54202.0445   127%     -    3s
     0     0 49568.9509    0  474 23909.1598 49568.9509   107%     -    4s
H    0     0                    23962.027349 49568.1949   107%     -    4s
H    0     0                    24010.730527 48300.0914   101%     -    4s
H    0     0                    24064.807958 48300.0914   101%     -    4s
     0     0 48300.0914    0  535 24064.8080 48300.0914   101%     -    4s
     0     0 48202.5733    0  544 24064.8080 48202.5733   100%     -    5s
     0     0 48189.6429    0  546 24064.8080 48189.6429   100%     -    5s
     0     0 48185.2945    0  542 24064.8080 48185.2945   100%     -    5s
     0     0 48185.2545    0  545 24064.8080 48185.2545   100%     -    5s
     0     0 44909.7900    0  434 24064.8080 44909.7900  86.6%     -    7s
     0     0 44243.3280    0  511 24064.8080 44243.3280  83.9%     -    7s
     0     0 44103.7202    0  532 24064.8080 44103.7202  83.3%     -    8s
     0     0 44072.1769    0  511 24064.8080 44072.1769  83.1%     -    8s
     0     0 44063.7294    0  519 24064.8080 44063.7294  83.1%     -    8s
     0     0 44058.6812    0  531 24064.8080 44058.6812  83.1%     -    8s
     0     0 44057.8937    0  527 24064.8080 44057.8937  83.1%     -    8s
     0     0 42216.6247    0  517 24064.8080 42216.6247  75.4%     -   10s
     0     0 41802.2102    0  543 24064.8080 41802.2102  73.7%     -   11s
     0     0 41689.2156    0  554 24064.8080 41689.2156  73.2%     -   12s
     0     0 41662.8687    0  560 24064.8080 41662.8687  73.1%     -   12s
     0     0 41645.1676    0  565 24064.8080 41645.1676  73.1%     -   12s
     0     0 41636.7003    0  570 24064.8080 41636.7003  73.0%     -   12s
     0     0 41635.6275    0  571 24064.8080 41635.6275  73.0%     -   12s
     0     0 40849.7440    0  527 24064.8080 40849.7440  69.7%     -   13s
     0     0 40744.0211    0  475 24064.8080 40744.0211  69.3%     -   14s
     0     0 40688.3176    0  527 24064.8080 40688.3176  69.1%     -   14s
     0     0 40678.0080    0  537 24064.8080 40678.0080  69.0%     -   14s
     0     0 40675.9578    0  531 24064.8080 40675.9578  69.0%     -   14s
     0     0 40400.8477    0  562 24064.8080 40400.8477  67.9%     -   15s
H    0     0                    24243.835171 40390.8420  66.6%     -   16s
     0     0 40318.2650    0  615 24243.8352 40318.2650  66.3%     -   16s
     0     0 40293.5865    0  617 24243.8352 40293.5865  66.2%     -   16s
     0     0 40290.4515    0  617 24243.8352 40290.4515  66.2%     -   17s
     0     0 40140.6313    0  499 24243.8352 40140.6313  65.6%     -   17s
     0     0 40104.1581    0  443 24243.8352 40104.1581  65.4%     -   18s
     0     0 40100.1014    0  440 24243.8352 40100.1014  65.4%     -   18s
     0     0 40016.9981    0  493 24243.8352 40016.9981  65.1%     -   18s
     0     0 39997.3627    0  507 24243.8352 39997.3627  65.0%     -   19s
     0     0 39991.3802    0  508 24243.8352 39991.3802  65.0%     -   19s
H    0     0                    24824.003900 39991.3802  61.1%     -   19s
H    0     0                    25029.591638 39991.3802  59.8%     -   19s
H    0     0                    25375.932726 39889.9768  57.2%     -   19s
H    0     0                    25400.619217 39889.9768  57.0%     -   19s
     0     0 39889.9768    0  487 25400.6192 39889.9768  57.0%     -   19s
H    0     0                    25514.565718 39887.1601  56.3%     -   20s
     0     0 39824.1170    0  507 25514.5657 39824.1170  56.1%     -   20s
     0     0 39810.9255    0  480 25514.5657 39810.9255  56.0%     -   20s
     0     0 39806.8261    0  484 25514.5657 39806.8261  56.0%     -   20s
     0     0 39761.7753    0  577 25514.5657 39761.7753  55.8%     -   21s
H    0     0                    25771.725109 39747.4403  54.2%     -   21s
H    0     0                    25872.133634 39747.4403  53.6%     -   21s
H    0     0                    25901.675898 39747.4403  53.5%     -   21s
     0     0 39747.4403    0  493 25901.6759 39747.4403  53.5%     -   21s
     0     0 39744.5534    0  500 25901.6759 39744.5534  53.4%     -   21s
     0     0 39731.8901    0  513 25901.6759 39731.8901  53.4%     -   22s
     0     0 39729.4553    0  516 25901.6759 39729.4553  53.4%     -   22s
     0     0 39715.7959    0  517 25901.6759 39715.7959  53.3%     -   22s
     0     0 39714.6790    0  510 25901.6759 39714.6790  53.3%     -   22s
     0     0 39710.2517    0  522 25901.6759 39710.2517  53.3%     -   23s
     0     0 39709.6779    0  522 25901.6759 39709.6779  53.3%     -   23s
H    0     0                    26157.355665 39705.1308  51.8%     -   26s
H    0     0                    26167.537662 39705.1308  51.7%     -   26s
     0     2 39705.1308    0  522 26167.5377 39705.1308  51.7%     -   26s
    31    62 37675.9959    5  403 26167.5377 38774.2332  48.2%  1299   30s
H   38    62                    26193.643854 38768.4820  48.0%  1223   30s
H  128   178                    26244.601506 37820.8343  44.1%   931   33s
H  180   210                    26852.367294 37820.8343  40.8%   778   33s
H  206   210                    27139.244176 37820.8343  39.4%   721   33s
   211   306 36820.1954    9  443 27139.2442 37820.8343  39.4%   711   35s
   689   600 32155.4629   18  292 27139.2442 37519.7912  38.2%   582   41s
H  979   828                    27157.358640 37208.9120  37.0%   510   43s
  1348  1052     cutoff   18      27157.3586 37208.9120  37.0%   425   45s
H 1536  1079                    27254.046042 36849.5567  35.2%   417   47s
  1940  1491 31271.3407   17  324 27254.0460 36796.7836  35.0%   391   51s
H 2145  1521                    27303.927044 36727.0346  34.5%   372   52s
H 2151  1521                    27461.303621 36727.0346  33.7%   372   52s
  2567  1823 29975.8440    7  281 27461.3036 36640.8918  33.4%   354   55s
H 3088  1984                    27463.592472 36476.6479  32.8%   349   59s
  3146  2003 28075.1771    9  243 27463.5925 36476.6479  32.8%   347   60s
  3868  2184     cutoff   18      27463.5925 35920.7589  30.8%   348   65s
  4320  2263     cutoff   13      27463.5925 35714.7808  30.0%   356   70s
H 4357  2252                    27563.025580 35714.7808  29.6%   357   70s
  5112  2490 30545.4434   10  300 27563.0256 35346.9970  28.2%   364   76s
H 5361  2513                    27592.155570 35346.9970  28.1%   365   77s
  5738  2655 30348.5510   14  211 27592.1556 35134.2079  27.3%   368   83s
  6220  2707 28746.1490    9  382 27592.1556 34839.8094  26.3%   374   86s
  6681  2764     cutoff   18      27592.1556 34627.1514  25.5%   376   90s
H 6714  2736                    27737.440982 34627.1514  24.8%   377   90s
H 7054  2799                    27906.036841 34486.2011  23.6%   378   92s
  7055  2800 29480.5760   20  522 27906.0368 34486.2011  23.6%   378  100s
  7061  2804 28652.4011   19  420 27906.0368 34486.2011  23.6%   377  105s
  7074  2813 31371.7801   25  518 27906.0368 34486.2011  23.6%   377  110s
H 7081  2675                    27906.779743 34486.2011  23.6%   376  115s
H 7081  2541                    27929.598195 34486.2011  23.5%   376  115s
H 7081  2413                    27937.233737 34486.2011  23.4%   376  116s
  7089  2426     cutoff   14      27937.2337 34486.2011  23.4%   381  120s
  7276  2490     cutoff   20      27937.2337 33071.4191  18.4%   388  125s
H 7693  2255                    27957.116363 32497.8759  16.2%   386  128s
  7752  2224 28273.0054   24  205 27957.1164 32497.8759  16.2%   385  130s
H 7848  2078                    27990.413099 32497.8759  16.1%   384  131s
  8424  1760 infeasible   27      27990.4131 29777.0728  6.38%   371  135s

Cutting planes:
  Learned: 1
  Lift-and-project: 1
  MIR: 139
  Mixing: 1
  Flow cover: 382
  RLT: 7
  Relax-and-lift: 40

Explored 8734 nodes (3190918 simplex iterations) in 136.18 seconds (335.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27990.4 27957.1 27937.2 ... 27463.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.799041309917e+04, best bound 2.799041309917e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 136.18s
  Master Objective (UB) = 27990.41, θ = 169246.70
  Upper Bound (UB) = 27990.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169246.70
  [DEBUG]   ✓ Scenario 0: θ = 169246.70 ≤ Q = 169246.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169246.70 ≤ Q = 169246.70 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x435d7ad8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x435d7ad8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.260047e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5820088.6102
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.612383e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161238.32    0  122 5820088.61 -161238.32   103%     -    0s
H    0     0                    -127417.8657 -161238.32  26.5%     -    0s
H    0     0                    -127845.6886 -161238.32  26.1%     -    0s
H    0     0                    -142211.7250 -161238.32  13.4%     -    0s
H    0     0                    -142253.9910 -150406.94  5.73%     -    0s
     0     0 -150406.94    0   82 -142253.99 -150406.94  5.73%     -    0s
H    0     0                    -147948.2349 -150393.86  1.65%     -    0s
H    0     0                    -148320.1282 -150393.86  1.40%     -    0s
H    0     0                    -148331.3927 -150393.86  1.39%     -    0s
H    0     0                    -148703.2860 -150393.86  1.14%     -    0s
     0     0 -150235.76    0   84 -148703.29 -150235.76  1.03%     -    0s
     0     0 -150223.71    0   84 -148703.29 -150223.71  1.02%     -    0s
     0     0 -149086.36    0   37 -148703.29 -149086.36  0.26%     -    0s
     0     0 -149078.13    0   35 -148703.29 -149078.13  0.25%     -    0s
     0     0 -149060.69    0   33 -148703.29 -149060.69  0.24%     -    0s
     0     0 -149058.90    0   31 -148703.29 -149058.90  0.24%     -    0s
     0     0 -148907.81    0    9 -148703.29 -148907.81  0.14%     -    0s
     0     0 -148878.88    0    5 -148703.29 -148878.88  0.12%     -    0s
     0     0 -148878.88    0   38 -148703.29 -148878.88  0.12%     -    0s
H    0     0                    -148762.5859 -148878.88  0.08%     -    0s
H    0     0                    -148818.0489 -148818.05  0.00%     -    0s
     0     0          -    0      -148818.05 -148818.05  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 4
  MIR: 16
  Flow cover: 12
  RLT: 2

Explored 1 nodes (733 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -148818 -148763 -148703 ... 5.82009e+06
No other solutions better than -148818

Optimal solution found (tolerance 1.00e-04)
Best objective -1.488180489250e+05, best bound -1.488180489250e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 146842.19
  Scenario: 39 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148818.05
  [DEBUG]   S×d_nominal = 295660.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 295660.24 + -148818.05 = 146842.19
  [DEBUG]   Current θ from Master = 169246.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22404.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5585.90
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 4211.9356, Absolute Gap = 4211.9356, Relative Gap = 0.150478
  Not converged yet (gap = 4211.94 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 20 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135194 nonzeros
Model fingerprint: 0xa5fae4e8
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 5585.9 (0.02s)
MIP start from previous solve produced solution with objective 5585.9 (0.02s)
Loaded MIP start from previous solve with objective 5585.9

Presolve removed 21876 rows and 8876 columns
Presolve time: 0.40s
Presolved: 25377 rows, 12104 columns, 141859 nonzeros
Variable types: 9845 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.07s

Solved with dual simplex

Root relaxation: objective 5.957188e+04, 16692 iterations, 3.01 seconds (5.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 59571.8773    0  349 5585.90075 59571.8773   966%     -    3s
H    0     0                    18970.721691 59571.8773   214%     -    3s
H    0     0                    23847.589532 59571.8773   150%     -    3s
H    0     0                    23875.130526 59571.8773   150%     -    3s
H    0     0                    24013.363682 59571.8773   148%     -    3s
H    0     0                    24185.707683 59571.8773   146%     -    4s
H    0     0                    24361.001800 59571.8773   145%     -    4s
     0     0 53480.8742    0  399 24361.0018 53480.8742   120%     -    5s
H    0     0                    24513.851721 53473.8081   118%     -    5s
     0     0 53171.7811    0  412 24513.8517 53171.7811   117%     -    6s
     0     0 52967.3444    0  438 24513.8517 52967.3444   116%     -    6s
     0     0 52965.5257    0  409 24513.8517 52965.5257   116%     -    6s
     0     0 52965.3712    0  409 24513.8517 52965.3712   116%     -    6s
     0     0 48048.5748    0  409 24513.8517 48048.5748  96.0%     -    9s
     0     0 46817.1146    0  521 24513.8517 46817.1146  91.0%     -   10s
     0     0 46724.4228    0  518 24513.8517 46724.4228  90.6%     -   10s
     0     0 46708.9043    0  523 24513.8517 46708.9043  90.5%     -   10s
     0     0 46705.1001    0  527 24513.8517 46705.1001  90.5%     -   10s
     0     0 46701.8109    0  484 24513.8517 46701.8109  90.5%     -   10s
     0     0 46701.8085    0  530 24513.8517 46701.8085  90.5%     -   10s
     0     0 43007.2706    0  402 24513.8517 43007.2706  75.4%     -   14s
     0     0 42410.8967    0  448 24513.8517 42410.8967  73.0%     -   16s
     0     0 42261.1342    0  545 24513.8517 42261.1342  72.4%     -   17s
     0     0 42239.1571    0  481 24513.8517 42239.1571  72.3%     -   17s
     0     0 42230.2138    0  480 24513.8517 42230.2138  72.3%     -   17s
     0     0 42222.8082    0  475 24513.8517 42222.8082  72.2%     -   18s
     0     0 42220.4511    0  475 24513.8517 42220.4511  72.2%     -   18s
     0     0 40330.6161    0  465 24513.8517 40330.6161  64.5%     -   22s
     0     0 40019.8545    0  467 24513.8517 40019.8545  63.3%     -   23s
     0     0 39859.4488    0  484 24513.8517 39859.4488  62.6%     -   24s
     0     0 39792.1099    0  484 24513.8517 39792.1099  62.3%     -   25s
     0     0 39779.8058    0  490 24513.8517 39779.8058  62.3%     -   25s
     0     0 39771.9267    0  494 24513.8517 39771.9267  62.2%     -   25s
     0     0 39769.1117    0  488 24513.8517 39769.1117  62.2%     -   26s
     0     0 39476.7595    0  570 24513.8517 39476.7595  61.0%     -   27s
     0     0 39359.8126    0  573 24513.8517 39359.8126  60.6%     -   28s
     0     0 39332.4217    0  574 24513.8517 39332.4217  60.4%     -   29s
     0     0 39325.0264    0  586 24513.8517 39325.0264  60.4%     -   29s
     0     0 39320.9310    0  587 24513.8517 39320.9310  60.4%     -   29s
     0     0 39156.7584    0  490 24513.8517 39156.7584  59.7%     -   31s
     0     0 39040.2604    0  533 24513.8517 39040.2604  59.3%     -   32s
     0     0 38992.1139    0  549 24513.8517 38992.1139  59.1%     -   33s
     0     0 38931.4660    0  509 24513.8517 38931.4660  58.8%     -   34s
     0     0 38913.1961    0  516 24513.8517 38913.1961  58.7%     -   34s
     0     0 38908.0340    0  514 24513.8517 38908.0340  58.7%     -   34s
     0     0 38803.5786    0  468 24513.8517 38803.5786  58.3%     -   36s
     0     0 38782.4305    0  491 24513.8517 38782.4305  58.2%     -   36s
     0     0 38772.1750    0  485 24513.8517 38772.1750  58.2%     -   37s
     0     0 38765.5172    0  493 24513.8517 38765.5172  58.1%     -   37s
     0     0 38763.8058    0  488 24513.8517 38763.8058  58.1%     -   37s
     0     0 38719.9565    0  501 24513.8517 38719.9565  58.0%     -   38s
H    0     0                    24771.128627 38719.4694  56.3%     -   39s
     0     0 38690.4880    0  487 24771.1286 38690.4880  56.2%     -   39s
     0     0 38688.4649    0  490 24771.1286 38688.4649  56.2%     -   39s
     0     0 38645.3646    0  473 24771.1286 38645.3646  56.0%     -   40s
H    0     0                    24821.307234 38642.9003  55.7%     -   40s
     0     0 38635.4650    0  478 24821.3072 38635.4650  55.7%     -   41s
     0     0 38633.3293    0  489 24821.3072 38633.3293  55.6%     -   41s
     0     0 38614.1745    0  479 24821.3072 38614.1745  55.6%     -   42s
H    0     0                    24829.182438 38614.1696  55.5%     -   42s
     0     0 38599.1045    0  484 24829.1824 38599.1045  55.5%     -   43s
     0     0 38591.9750    0  490 24829.1824 38591.9750  55.4%     -   43s
     0     0 38590.7972    0  477 24829.1824 38590.7972  55.4%     -   43s
     0     0 38575.6752    0  493 24829.1824 38575.6752  55.4%     -   44s
     0     0 38573.8554    0  493 24829.1824 38573.8554  55.4%     -   44s
H    0     0                    24987.519000 38573.8554  54.4%     -   50s
H    0     2                    25046.185914 38573.8554  54.0%     -   50s
     0     2 38573.8554    0  493 25046.1859 38573.8554  54.0%     -   50s
     7    16 38181.8606    3  441 25046.1859 38307.7289  52.9%  3548   56s
H   31    64                    25051.614164 37873.5347  51.2%  4640   61s
H   32    64                    25105.044854 37873.5347  50.9%  4528   61s
H   32    64                    25113.482571 37873.5347  50.8%  4528   61s
H   34    64                    25461.624040 37873.5347  48.7%  4386   61s
H   36    64                    25467.311276 37873.5347  48.7%  4276   61s
    95   215 36574.5914    7  455 25467.3113 37722.9483  48.1%  2964   66s
H  134   215                    25559.045054 37722.9483  47.6%  2520   66s
   286   355 35872.0554   10  376 25559.0451 37722.9483  47.6%  1833   70s
H  305   355                    25578.460556 37722.9483  47.5%  1879   70s
H  477   495                    25614.993061 37722.9483  47.3%  1702   74s
   502   561 34837.2327   12  377 25614.9931 37722.9483  47.3%  1649   77s
   633   619 34434.7378   13  409 25614.9931 37333.1502  45.7%  1664   82s
   723   690 32309.3426   14  401 25614.9931 37332.1548  45.7%  1869   88s
   770   731 30587.5539   14  396 25614.9931 37332.1548  45.7%  1946   90s
   872   836 30518.3637   16  394 25614.9931 37332.1548  45.7%  2029   97s
   929   903 28656.8275   16  385 25614.9931 37332.1548  45.7%  2035  100s
H 1028   934                    25745.087229 37332.1548  45.0%  2009  103s
  1063  1006     cutoff   17      25745.0872 37332.1548  45.0%  2002  105s
H 1249  1087                    26092.940903 37208.6722  42.6%  1880  108s
H 1288  1123                    26378.305636 37208.6722  41.1%  1848  112s
H 1333  1123                    26465.260366 37208.6722  40.6%  1830  112s
  1400  1193 33762.7314   13  305 26465.2604 36890.2372  39.4%  1821  115s
H 1404  1193                    26491.698153 36890.2372  39.3%  1825  115s
H 1429  1193                    26576.347812 36890.2372  38.8%  1803  115s
H 1510  1223                    26583.054314 36890.2372  38.8%  1794  117s
H 1520  1223                    26599.166263 36890.2372  38.7%  1794  117s
  1541  1298 32234.0862   15  299 26599.1663 36890.2372  38.7%  1801  120s
H 1574  1298                    26602.400852 36890.2372  38.7%  1783  120s
H 1628  1298                    26669.390525 36890.2372  38.3%  1764  120s
  1784  1457 30510.1501   25  378 26669.3905 36890.2372  38.3%  1740  125s
  2088  1711 29213.6821   41  255 26669.3905 36890.2372  38.3%  1624  131s
  2269  1760     cutoff   45      26669.3905 36890.2372  38.3%  1563  135s
  2480  1777     cutoff   23      26669.3905 36085.8206  35.3%  1578  142s
H 2512  1773                    26688.759439 36085.8206  35.2%  1574  142s
  2587  1887 27996.8727   11  435 26688.7594 36085.8206  35.2%  1573  145s
  2783  1943     cutoff   13      26688.7594 36085.8206  35.2%  1550  150s
H 2903  1940                    26709.211816 36022.8518  34.9%  1546  150s
  3085  2071 28613.8132    8  439 26709.2118 36022.8518  34.9%  1551  158s
  3224  2107 28243.5560    9  391 26709.2118 35993.3367  34.8%  1564  162s
  3341  2201     cutoff   10      26709.2118 35815.0290  34.1%  1568  167s
  3550  2297     cutoff   10      26709.2118 35786.7773  34.0%  1558  173s
  3750  2350 28444.7796   15  254 26709.2118 35759.2537  33.9%  1560  178s
  3899  2401     cutoff   16      26709.2118 35625.7303  33.4%  1582  183s
  4066  2438 28459.6523    8  393 26709.2118 35625.7303  33.4%  1601  188s
  4181  2476 27530.1482    9  402 26709.2118 35625.7303  33.4%  1610  192s
  4319  2507     cutoff   10      26709.2118 35625.7303  33.4%  1625  197s
  4418  2562     cutoff   13      26709.2118 35300.2195  32.2%  1646  202s
  4607  2647 28911.7271    8  283 26709.2118 35300.2195  32.2%  1653  208s
  4819  2725     cutoff   11      26709.2118 35142.8453  31.6%  1659  214s
  5061  2749 27353.7935   12  406 26709.2118 35121.7705  31.5%  1667  218s
  5107  2835     cutoff   13      26709.2118 35121.7705  31.5%  1681  222s
  5284  2836 34526.8390    6  493 26709.2118 35121.7705  31.5%  1681  245s
  5286  2837 28569.2547   15  196 26709.2118 35121.7705  31.5%  1681  250s
  5288  2839 32767.6432   12  370 26709.2118 35121.7705  31.5%  1680  255s
  5295  2843 27069.4538   29  409 26709.2118 35121.7705  31.5%  1678  260s
  5303  2849 28049.5236   16  432 26709.2118 35121.7705  31.5%  1675  265s
  5309  2853 27742.2099   31  486 26709.2118 35121.7705  31.5%  1674  270s
  5315  2857 31750.9671   18  444 26709.2118 35121.7705  31.5%  1672  275s
  5321  2861 28234.7628   23  511 26709.2118 35121.7705  31.5%  1670  280s
  5323  2862 27542.2354   29  521 26709.2118 35121.7705  31.5%  1669  287s
  5324  2863 29374.1044   17  521 26709.2118 35121.7705  31.5%  1669  292s
  5325  2866 35121.7705   11  445 26709.2118 35121.7705  31.5%  1683  297s
  5331  2874 29599.2745   13  360 26709.2118 35121.7705  31.5%  1684  302s
  5353  2883 29464.4090   15  304 26709.2118 34080.3129  27.6%  1688  306s
  5405  2905 30779.2371   17  210 26709.2118 31832.7303  19.2%  1693  312s
  5470  2950 30498.5089   19  190 26709.2118 31621.4477  18.4%  1700  316s
  5610  2945 27167.6405   24  258 26709.2118 31495.7950  17.9%  1684  321s
  5725  2903     cutoff   26      26709.2118 31470.1837  17.8%  1669  325s
  5964  2822     cutoff   23      26709.2118 31462.3333  17.8%  1635  331s
  6115  2780 28157.6477   21  217 26709.2118 31148.9609  16.6%  1616  335s
  6354  2719     cutoff   28      26709.2118 31148.9609  16.6%  1583  340s
H 6629  2497                    26755.381850 29954.7840  12.0%  1539  343s
  6721  2473     cutoff   21      26755.3819 29636.5534  10.8%  1526  345s
  7144  2265     cutoff   31      26755.3819 29229.9391  9.25%  1467  351s
* 7591  1916              39    26865.222170 28218.2386  5.04%  1405  353s
  7677  1872 26956.1566   23  251 26865.2222 28218.2386  5.04%  1391  355s
* 7740  1721              64    26896.064865 28218.2386  4.92%  1381  355s
* 7756  1593              60    27135.369931 28218.2386  3.99%  1378  355s
* 7986  1360              53    27304.740058 27500.4007  0.72%  1341  356s
* 8146  1164              52    27359.430481 27432.1657  0.27%  1315  356s

Cutting planes:
  MIR: 255
  Flow cover: 629
  RLT: 7
  Relax-and-lift: 55

Explored 8218 nodes (10812024 simplex iterations) in 356.74 seconds (969.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27359.4 27304.7 27135.4 ... 26602.4

Optimal solution found (tolerance 1.00e-04)
Best objective 2.735943048128e+04, best bound 2.735943048128e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 356.75s
  Master Objective (UB) = 27359.43, θ = 170779.54
  Upper Bound (UB) = 27359.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170779.54
  [DEBUG]   ✓ Scenario 0: θ = 170779.54 ≤ Q = 170779.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170779.54 ≤ Q = 170779.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170779.54 ≤ Q = 170779.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69c47af0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69c47af0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.297076e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5937739.7168
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.606692e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160669.22    0  124 5937739.72 -160669.22   103%     -    0s
H    0     0                    -127572.8787 -160669.22  25.9%     -    0s
H    0     0                    -128121.9512 -160669.22  25.4%     -    0s
H    0     0                    -134106.3059 -160669.22  19.8%     -    0s
H    0     0                    -134221.7671 -149791.42  11.6%     -    0s
     0     0 -149791.42    0   85 -134221.77 -149791.42  11.6%     -    0s
H    0     0                    -147328.8251 -149705.56  1.61%     -    0s
H    0     0                    -147685.9610 -149705.56  1.37%     -    0s
H    0     0                    -147893.8878 -149421.72  1.03%     -    0s
     0     0 -149415.10    0   88 -147893.89 -149415.10  1.03%     -    0s
     0     0 -148473.59    0   60 -147893.89 -148473.59  0.39%     -    0s
     0     0 -148382.53    0   58 -147893.89 -148382.53  0.33%     -    0s
     0     0 -148377.95    0   38 -147893.89 -148377.95  0.33%     -    0s
     0     0 -148371.22    0   41 -147893.89 -148371.22  0.32%     -    0s
     0     0 -148157.70    0   14 -147893.89 -148157.70  0.18%     -    0s
     0     0 -148027.59    0   12 -147893.89 -148027.59  0.09%     -    0s
     0     0 -147999.00    0    5 -147893.89 -147999.00  0.07%     -    0s
     0     0 -147999.00    0   12 -147893.89 -147999.00  0.07%     -    0s
H    0     0                    -147946.5580 -147999.00  0.04%     -    0s
*    0     0               0    -147976.0640 -147976.06  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 4
  MIR: 6
  Flow cover: 8
  Relax-and-lift: 3

Explored 1 nodes (689 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -147976 -147947 -147894 ... -127573
No other solutions better than -147976

Optimal solution found (tolerance 1.00e-04)
Best objective -1.479760640415e+05, best bound -1.479760640415e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 148941.40
  Scenario: 41 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147976.06
  [DEBUG]   S×d_nominal = 296917.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 296917.47 + -147976.06 = 148941.40
  [DEBUG]   Current θ from Master = 170779.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21838.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5521.29
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 3580.9530, Absolute Gap = 3580.9530, Relative Gap = 0.130886
  Not converged yet (gap = 3580.95 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 18 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178419 nonzeros
Model fingerprint: 0x88087380
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 5521.29 (0.05s)
MIP start from previous solve produced solution with objective 5521.29 (0.05s)
Loaded MIP start from previous solve with objective 5521.29

Presolve removed 29128 rows and 11828 columns
Presolve time: 0.53s
Presolved: 33415 rows, 15392 columns, 206359 nonzeros
Variable types: 13133 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33415 rows, 15392 columns, 206359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39526    2.9638455e+04   0.000000e+00   1.781954e+06      5s
Concurrent spin time: 0.31s

Solved with dual simplex

Root relaxation: objective 5.004945e+04, 23638 iterations, 5.69 seconds (11.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50049.4505    0  194 5521.29105 50049.4505   806%     -    6s
H    0     0                    17801.457765 50049.4505   181%     -    6s
H    0     0                    18881.229787 50049.4505   165%     -    6s
H    0     0                    18894.342835 50049.4505   165%     -    6s
H    0     0                    21447.948946 50049.4505   133%     -    7s
H    0     0                    22662.228346 50049.4505   121%     -    7s
H    0     0                    22677.805146 50049.4505   121%     -    7s
     0     0 46474.6240    0  205 22677.8051 46474.6240   105%     -    9s
     0     0 45669.6165    0  271 22677.8051 45669.6165   101%     -   10s
     0     0 45468.5995    0  273 22677.8051 45468.5995   100%     -   11s
     0     0 45468.5995    0  283 22677.8051 45468.5995   100%     -   11s
     0     0 45468.5995    0  281 22677.8051 45468.5995   100%     -   11s
     0     0 45468.5995    0  281 22677.8051 45468.5995   100%     -   11s
     0     0 42018.0488    0  320 22677.8051 42018.0488  85.3%     -   15s
H    0     0                    22729.195667 42017.9143  84.9%     -   16s
H    0     0                    22852.225574 42017.9143  83.9%     -   16s
     0     0 41489.7928    0  331 22852.2256 41489.7928  81.6%     -   17s
     0     0 41345.7469    0  341 22852.2256 41345.7469  80.9%     -   17s
     0     0 41317.2979    0  346 22852.2256 41317.2979  80.8%     -   18s
     0     0 41303.8866    0  347 22852.2256 41303.8866  80.7%     -   18s
     0     0 41301.5738    0  345 22852.2256 41301.5738  80.7%     -   18s
     0     0 41295.5763    0  338 22852.2256 41295.5763  80.7%     -   18s
     0     0 41289.8397    0  348 22852.2256 41289.8397  80.7%     -   18s
     0     0 41288.7644    0  349 22852.2256 41288.7644  80.7%     -   19s
     0     0 41288.1967    0  349 22852.2256 41288.1967  80.7%     -   19s
H    0     0                    23761.680685 41288.1967  73.8%     -   20s
     0     0 39832.4131    0  366 23761.6807 39832.4131  67.6%     -   23s
H    0     0                    24258.981560 39505.3454  62.8%     -   25s
H    0     0                    24593.201397 39505.3454  60.6%     -   25s
     0     0 39505.3454    0  372 24593.2014 39505.3454  60.6%     -   25s
     0     0 39432.9702    0  384 24593.2014 39432.9702  60.3%     -   26s
     0     0 39373.2533    0  393 24593.2014 39373.2533  60.1%     -   26s
     0     0 39324.2198    0  397 24593.2014 39324.2198  59.9%     -   27s
     0     0 39274.7921    0  387 24593.2014 39274.7921  59.7%     -   28s
     0     0 39264.4513    0  384 24593.2014 39264.4513  59.7%     -   28s
     0     0 39259.4558    0  394 24593.2014 39259.4558  59.6%     -   28s
     0     0 39258.0683    0  395 24593.2014 39258.0683  59.6%     -   28s
     0     0 39257.0541    0  395 24593.2014 39257.0541  59.6%     -   29s
     0     0 38871.9640    0  403 24593.2014 38871.9640  58.1%     -   33s
H    0     0                    24606.583762 38622.9586  57.0%     -   35s
     0     0 38622.9586    0  456 24606.5838 38622.9586  57.0%     -   35s
     0     0 38489.7307    0  412 24606.5838 38489.7307  56.4%     -   36s
     0     0 38452.1685    0  443 24606.5838 38452.1685  56.3%     -   37s
     0     0 38426.6513    0  460 24606.5838 38426.6513  56.2%     -   37s
     0     0 38417.7329    0  461 24606.5838 38417.7329  56.1%     -   37s
     0     0 38414.1221    0  460 24606.5838 38414.1221  56.1%     -   37s
     0     0 38411.9928    0  459 24606.5838 38411.9928  56.1%     -   38s
     0     0 38406.4239    0  459 24606.5838 38406.4239  56.1%     -   38s
     0     0 38405.9289    0  460 24606.5838 38405.9289  56.1%     -   38s
     0     0 38305.0719    0  436 24606.5838 38305.0719  55.7%     -   39s
     0     0 38280.7141    0  442 24606.5838 38280.7141  55.6%     -   40s
     0     0 38277.0224    0  447 24606.5838 38277.0224  55.6%     -   40s
     0     0 38271.7067    0  492 24606.5838 38271.7067  55.5%     -   40s
     0     0 38270.2178    0  447 24606.5838 38270.2178  55.5%     -   40s
     0     0 38268.5649    0  498 24606.5838 38268.5649  55.5%     -   41s
     0     0 38267.7434    0  452 24606.5838 38267.7434  55.5%     -   41s
H    0     0                    24615.839306 38193.5094  55.2%     -   42s
     0     0 38193.5094    0  463 24615.8393 38193.5094  55.2%     -   42s
     0     0 38157.5060    0  440 24615.8393 38157.5060  55.0%     -   43s
     0     0 38126.3602    0  482 24615.8393 38126.3602  54.9%     -   43s
     0     0 38121.0167    0  485 24615.8393 38121.0167  54.9%     -   44s
     0     0 38116.4221    0  481 24615.8393 38116.4221  54.8%     -   44s
     0     0 38116.0175    0  484 24615.8393 38116.0175  54.8%     -   44s
     0     0 38087.8989    0  490 24615.8393 38087.8989  54.7%     -   45s
     0     0 38079.9881    0  489 24615.8393 38079.9881  54.7%     -   45s
     0     0 38077.4304    0  491 24615.8393 38077.4304  54.7%     -   45s
     0     0 38076.0590    0  492 24615.8393 38076.0590  54.7%     -   45s
     0     0 38063.5922    0  480 24615.8393 38063.5922  54.6%     -   46s
H    0     0                    24694.274273 38063.4910  54.1%     -   46s
H    0     0                    24732.688984 38063.4910  53.9%     -   46s
     0     0 38060.5033    0  441 24732.6890 38060.5033  53.9%     -   46s
     0     0 38059.3137    0  442 24732.6890 38059.3137  53.9%     -   46s
H    0     0                    24813.356827 38049.5399  53.3%     -   47s
     0     0 38049.5399    0  490 24813.3568 38049.5399  53.3%     -   47s
     0     0 38047.5238    0  499 24813.3568 38047.5238  53.3%     -   48s
     0     0 38047.2693    0  500 24813.3568 38047.2693  53.3%     -   48s
     0     0 38044.0061    0  455 24813.3568 38044.0061  53.3%     -   48s
     0     0 38036.6076    0  494 24813.3568 38036.6076  53.3%     -   49s
     0     0 38032.8403    0  496 24813.3568 38032.8403  53.3%     -   49s
     0     0 38032.4281    0  451 24813.3568 38032.4281  53.3%     -   49s
     0     0 38027.4208    0  464 24813.3568 38027.4208  53.3%     -   50s
     0     0 38026.7724    0  508 24813.3568 38026.7724  53.3%     -   50s
     0     0 38010.3793    0  503 24813.3568 38010.3793  53.2%     -   51s
H    0     0                    25056.015441 38010.0715  51.7%     -   51s
     0     0 38005.0110    0  499 25056.0154 38005.0110  51.7%     -   51s
     0     0 38000.6002    0  504 25056.0154 38000.6002  51.7%     -   51s
     0     0 37998.7910    0  515 25056.0154 37998.7910  51.7%     -   52s
     0     0 37998.4094    0  511 25056.0154 37998.4094  51.7%     -   52s
     0     0 37986.1047    0  506 25056.0154 37986.1047  51.6%     -   52s
H    0     0                    25209.154962 37985.2004  50.7%     -   53s
     0     0 37984.1649    0  513 25209.1550 37984.1649  50.7%     -   53s
     0     0 37983.4833    0  468 25209.1550 37983.4833  50.7%     -   53s
     0     0 37980.2566    0  507 25209.1550 37980.2566  50.7%     -   54s
     0     0 37978.5442    0  513 25209.1550 37978.5442  50.7%     -   56s
     0     0 37978.0863    0  515 25209.1550 37978.0863  50.7%     -   56s
     0     0 37972.1935    0  488 25209.1550 37972.1935  50.6%     -   56s
     0     0 37971.7333    0  501 25209.1550 37971.7333  50.6%     -   57s
     0     0 37970.4349    0  501 25209.1550 37970.4349  50.6%     -   57s
     0     0 37970.0240    0  501 25209.1550 37970.0240  50.6%     -   58s
H    0     0                    25271.197457 37970.0240  50.3%     -   60s
H    0     0                    25428.838442 37970.0240  49.3%     -   66s
     0     2 37970.0240    0  501 25428.8384 37970.0240  49.3%     -   66s
     3     8 37766.5472    2  494 25428.8384 37903.5460  49.1%  2028   70s
    15    32 36894.2660    4  487 25428.8384 37238.9913  46.4%  3308   76s
    31    64 36591.1997    5  476 25428.8384 36893.5285  45.1%  5217   80s
    63    92 36391.4257    6  465 25428.8384 36590.6171  43.9%  4572   87s
    91   202 36328.6063    7  461 25428.8384 36590.6171  43.9%  5578   94s
H   99   202                    25429.548562 36590.6171  43.9%  5423   94s
H  143   202                    25442.145479 36590.6171  43.8%  4482   94s
   201   256 35908.0082    8  463 25442.1455 36590.6171  43.8%  3519   99s
   255   321 36087.5014    9  453 25442.1455 36590.6171  43.8%  3285  104s
   320   387 35964.7585   10  448 25442.1455 36590.6171  43.8%  3053  108s
   392   418 35742.3523   11  453 25442.1455 36590.6171  43.8%  2850  110s
   425   461 35418.8947   11  459 25442.1455 36590.6171  43.8%  2887  115s
   534   586 34004.7892   12  415 25442.1455 36220.8801  42.4%  2803  123s
   609   651 33910.3499   13  430 25442.1455 36220.8801  42.4%  2646  125s
   768   823 31637.1494   14  443 25442.1455 36220.8801  42.4%  2366  132s
   863   906 33077.3664   15  420 25442.1455 36220.8801  42.4%  2216  135s
   968   931 31335.3098   15  315 25442.1455 36220.8801  42.4%  2073  140s
  1064  1000 32067.0380   16  423 25442.1455 36220.8801  42.4%  2030  149s
  1142  1054 32412.5303   17  394 25442.1455 36220.8801  42.4%  1982  154s
  1208  1113 32195.5090   18  378 25442.1455 36220.8801  42.4%  1978  157s
  1280  1206 32114.9909   20  372 25442.1455 36220.8801  42.4%  1949  161s
  1519  1470 31450.7945   28  357 25442.1455 36220.8801  42.4%  1773  168s
  1682  1539 29965.4894   33  125 25442.1455 35797.1139  40.7%  1665  173s
  1830  1595 28363.7875   35  315 25442.1455 35797.1139  40.7%  1613  177s
  1944  1683 28300.4470   36  285 25442.1455 35797.1139  40.7%  1599  181s
  2068  1787 27946.7291   42  212 25442.1455 35752.1056  40.5%  1574  185s
  2236  1850 26781.7170   47  228 25442.1455 35655.9922  40.1%  1548  191s
  2270  1880 26970.1752   47  234 25442.1455 35655.9922  40.1%  1553  195s
  2346  1964 26790.5143   49  226 25442.1455 35655.9922  40.1%  1551  202s
  2410  2052 26690.3106   50  220 25442.1455 35655.9922  40.1%  1533  205s
  2657  2248 25894.7795   57  201 25442.1455 35655.9922  40.1%  1449  212s
  2801  2303 29109.8280    8  240 25442.1455 35455.0044  39.4%  1427  217s
  2950  2367 31349.5065    8  269 25442.1455 35365.0209  39.0%  1418  222s
  3026  2445 30048.0545    9  288 25442.1455 35365.0209  39.0%  1424  228s
H 3039  2440                    25599.823851 35365.0209  38.1%  1423  228s
  3158  2561     cutoff   10      25599.8239 35365.0209  38.1%  1419  233s
  3345  2683 26618.2521   10  304 25599.8239 35365.0209  38.1%  1415  238s
  3561  2802     cutoff   11      25599.8239 35329.8186  38.0%  1400  244s
  3785  2873 27812.3705   11  293 25599.8239 35318.2834  38.0%  1390  250s
  3951  2953 27407.2526   12  277 25599.8239 35318.2834  38.0%  1408  256s
  4124  3027 26532.9007   13  215 25599.8239 35288.7507  37.8%  1425  263s
H 4324  3108                    25702.036566 35276.8925  37.3%  1429  269s
H 4326  3107                    25747.146670 35276.8925  37.0%  1430  269s
H 4339  3106                    25748.884320 35276.8925  37.0%  1427  269s
  4537  3206 29722.7210   11  245 25748.8843 35276.8925  37.0%  1421  276s
  4727  3207 27430.5743   31  501 25748.8843 35276.8925  37.0%  1436  291s
  4729  3208 26351.5180   58  194 25748.8843 35276.8925  37.0%  1435  297s
  4730  3209 31517.5770   15  334 25748.8843 35276.8925  37.0%  1435  303s
  4731  3210 27325.7338   25  396 25748.8843 35276.8925  37.0%  1435  307s
  4732  3210 31619.0484   19  457 25748.8843 35276.8925  37.0%  1435  310s
  4736  3213 28314.1840   17  496 25748.8843 35276.8925  37.0%  1433  315s
  4740  3216 26131.5164   24  496 25748.8843 35276.8925  37.0%  1432  320s
  4744  3218 27816.2496   28  532 25748.8843 35276.8925  37.0%  1431  325s
  4748  3221 28050.9942   34  497 25748.8843 35276.8925  37.0%  1430  332s
  4751  3223 27467.3061   29  459 25748.8843 35276.8925  37.0%  1429  336s
  4754  3225 32171.4323   16  441 25748.8843 35276.8925  37.0%  1428  340s
  4757  3227 29819.5043   18  502 25748.8843 35276.8925  37.0%  1427  345s
  4760  3229 28103.0352   22  448 25748.8843 35276.8925  37.0%  1426  353s
  4761  3230 27335.4676   38  448 25748.8843 35276.8925  37.0%  1426  359s
  4762  3233 35276.8925   12  445 25748.8843 35276.8925  37.0%  1443  366s
  4764  3237 35276.8925   13  434 25748.8843 35276.8925  37.0%  1443  373s
  4768  3243 35276.8925   14  478 25748.8843 35276.8925  37.0%  1445  379s
  4776  3257 35276.8925   15  407 25748.8843 35276.8925  37.0%  1454  386s
  4792  3280 35276.8925   16  418 25748.8843 35276.8925  37.0%  1477  398s
  4821  3303 33177.9754   17  464 25748.8843 35276.8925  37.0%  1519  405s
  4853  3373 31339.6701   18  491 25748.8843 35276.8925  37.0%  1551  412s
  4942  3392 30009.6298   21  361 25748.8843 35276.8925  37.0%  1588  417s
  5033  3388 29165.6475   20  420 25748.8843 35276.8925  37.0%  1602  424s
  5102  3390 29232.3143   22  417 25748.8843 35276.8925  37.0%  1610  429s
  5181  3369 27712.2423   22  394 25748.8843 35276.8925  37.0%  1618  435s
  5236  3375 27606.8172   22  357 25748.8843 35276.8925  37.0%  1633  441s
  5281  3383 27448.9093   23  300 25748.8843 35276.8925  37.0%  1643  446s
  5331  3386 27448.8783   24  277 25748.8843 35225.1960  36.8%  1647  452s
  5407  3367 infeasible   27      25748.8843 34533.0925  34.1%  1652  457s
  5479  3352 27982.2927   18  401 25748.8843 34533.0925  34.1%  1659  462s
  5551  3344 25998.7578   20  406 25748.8843 34533.0925  34.1%  1669  467s
  5612  3360 27340.2933   20  408 25748.8843 34528.9765  34.1%  1678  472s
  5674  3362     cutoff   22      25748.8843 34002.7218  32.1%  1687  480s
  5746  3357 29095.1278   21  336 25748.8843 34002.7218  32.1%  1694  486s
  5825  3345 27837.9668   23  296 25748.8843 34002.7218  32.1%  1700  492s
  5891  3348 27052.7171   25  219 25748.8843 34002.7218  32.1%  1708  497s
  5981  3327     cutoff   27      25748.8843 34002.7218  32.1%  1713  502s
  6034  3318     cutoff   28      25748.8843 34002.7218  32.1%  1716  507s
  6122  3294 26632.8018   28  179 25748.8843 34002.7218  32.1%  1717  512s
  6174  3286     cutoff   29      25748.8843 33413.5656  29.8%  1722  519s
  6239  3265 25979.8270   29  174 25748.8843 32533.9890  26.4%  1732  527s
  6313  3277 25962.0844   30  177 25748.8843 32404.1931  25.8%  1738  532s
  6377  3262 27715.3900   18  279 25748.8843 31691.3743  23.1%  1745  539s
H 6461  3071                    25784.822990 31457.6097  22.0%  1748  539s
  6468  3070 29139.4788   25  357 25784.8230 31457.6097  22.0%  1748  546s
  6608  3020 27680.1904   27  299 25784.8230 31457.6097  22.0%  1752  554s
  6746  2986 26654.1936   31  166 25784.8230 31457.6097  22.0%  1757  559s
  6819  2974 infeasible   35      25784.8230 31457.6097  22.0%  1760  567s
  6951  2910     cutoff   23      25784.8230 30925.6432  19.9%  1766  574s
  7098  2861 26521.9002   23  267 25784.8230 30722.4885  19.1%  1771  582s
  7246  2804 26380.1080   21  332 25784.8230 30427.6899  18.0%  1779  588s
  7418  2763 27686.4699   26  234 25784.8230 29998.3475  16.3%  1782  596s
  7610  2695 26669.3715   28  203 25784.8230 29998.3475  16.3%  1783  603s
  7791  2636 25961.2264   37  111 25784.8230 29741.2773  15.3%  1778  611s
  8002  2561 27799.8880   25  198 25784.8230 29528.7505  14.5%  1775  620s
  8232  2452 26753.6168   31  168 25784.8230 29277.3072  13.5%  1772  630s
  8491  2369 27578.2925   25  349 25784.8230 28808.5099  11.7%  1766  639s
  8776  2242 infeasible   36      25784.8230 28808.5099  11.7%  1754  647s
  9046  2116 27041.8795   25  213 25784.8230 28603.2601  10.9%  1744  655s
* 9362  1858              39    25804.522194 28282.5903  9.60%  1718  655s
  9452  1746 26693.8996   27  289 25804.5222 28214.0259  9.34%  1715  664s
* 9549  1567              52    26082.196134 28045.0070  7.53%  1705  664s
  9992  1243     cutoff   28      26082.1961 28045.0070  7.53%  1667  669s
*10328   992              51    26241.558680 27610.1969  5.22%  1624  669s
*10381   842              47    26444.662098 27610.1969  4.41%  1617  669s
*10390   714              45    26448.039635 27610.1969  4.39%  1616  669s
 10752   421     cutoff   30      26448.0396 27285.4592  3.17%  1569  670s
H10804   284                    26551.317851 27045.5914  1.86%  1562  670s
*11168     3              49    26551.487897 26559.6514  0.03%  1512  671s

Cutting planes:
  MIR: 373
  Flow cover: 918
  Zero half: 1
  RLT: 25
  Relax-and-lift: 83

Explored 11211 nodes (16988097 simplex iterations) in 671.08 seconds (1965.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26551.5 26551.3 26448 ... 25747.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.655148789742e+04, best bound 2.655148789742e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 671.09s
  Master Objective (UB) = 26551.49, θ = 170561.00
  Upper Bound (UB) = 26551.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170561.00
  [DEBUG]   ✓ Scenario 0: θ = 170561.00 ≤ Q = 170561.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170561.00 ≤ Q = 170561.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170561.00 ≤ Q = 170561.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170561.00 ≤ Q = 170561.00 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x32143bf8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x32143bf8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-13, 2e+02]
Found heuristic solution: objective 1.302120e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 5926123.1562
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.629054e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162905.41    0  124 5926123.16 -162905.41   103%     -    0s
H    0     0                    -127084.7265 -162905.41  28.2%     -    0s
H    0     0                    -127387.3036 -162905.41  27.9%     -    0s
H    0     0                    -136238.3162 -162905.41  19.6%     -    0s
     0     0 -147772.26    0   80 -136238.32 -147772.26  8.47%     -    0s
H    0     0                    -144721.0958 -147719.82  2.07%     -    0s
     0     0 -147068.34    0   85 -144721.10 -147068.34  1.62%     -    0s
     0     0 -147063.15    0   85 -144721.10 -147063.15  1.62%     -    0s
     0     0 -147063.13    0   85 -144721.10 -147063.13  1.62%     -    0s
     0     0 -146743.10    0   70 -144721.10 -146743.10  1.40%     -    0s
H    0     0                    -145883.0492 -146729.28  0.58%     -    0s
H    0     0                    -146172.0494 -146685.24  0.35%     -    0s
     0     0 -146685.24    0   62 -146172.05 -146685.24  0.35%     -    0s
     0     0 -146657.40    0   62 -146172.05 -146657.40  0.33%     -    0s
     0     0 -146644.16    0   62 -146172.05 -146644.16  0.32%     -    0s
     0     0 -146348.67    0   16 -146172.05 -146348.67  0.12%     -    0s
     0     0 -146332.57    0   13 -146172.05 -146332.57  0.11%     -    0s
H    0     0                    -146220.3897 -146318.52  0.07%     -    0s
     0     0 -146286.92    0   13 -146220.39 -146286.92  0.05%     -    0s
     0     0 -146286.85    0   11 -146220.39 -146286.85  0.05%     -    0s
     0     0 -146281.13    0    8 -146220.39 -146281.13  0.04%     -    0s
     0     0 -146247.78    0    4 -146220.39 -146247.78  0.02%     -    0s
     0     0 -146235.78    0    3 -146220.39 -146235.78  0.01%     -    0s
H    0     0                    -146232.6361 -146235.78  0.00%     -    0s

Explored 1 nodes (656 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -146233 -146220 -146172 ... -127085

Optimal solution found (tolerance 1.00e-04)
Best objective -1.462326360620e+05, best bound -1.462357762080e+05, gap 0.0021%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 151149.23
  Scenario: 40 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146232.64
  [DEBUG]   S×d_nominal = 297381.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 297381.87 + -146232.64 = 151149.23
  [DEBUG]   Current θ from Master = 170561.00
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19411.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7139.72
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2773.0104, Absolute Gap = 2773.0104, Relative Gap = 0.104439
  Not converged yet (gap = 2773.01 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 19 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221644 nonzeros
Model fingerprint: 0x12ecca3e
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 36400 rows and 14780 columns
Presolve time: 0.66s
Presolved: 41433 rows, 18680 columns, 256599 nonzeros
Variable types: 16421 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -204344.1227

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41433 rows, 18680 columns, 256599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33586    2.5066703e+04   0.000000e+00   5.809081e+07      5s
   52467    4.1513532e+04   0.000000e+00   1.305950e+07     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.993757e+04, 29467 iterations, 11.07 seconds (21.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49937.5655    0  196 -204344.12 49937.5655   124%     -   12s
H    0     0                    -196437.8760 49937.5655   125%     -   12s
H    0     0                    -110619.9428 49937.5655   145%     -   12s
H    0     0                    -107627.9149 49937.5655   146%     -   12s
H    0     0                    -47258.79323 49937.5655   206%     -   12s
H    0     0                    -44225.83329 49937.5655   213%     -   12s
H    0     0                    -44092.89186 49937.5655   213%     -   12s
H    0     0                    -38324.14505 49937.5655   230%     -   12s
H    0     0                    5368.7333137 49937.5655   830%     -   12s
H    0     0                    8143.9936675 49937.5655   513%     -   12s
H    0     0                    15092.642851 46365.2299   207%     -   16s
H    0     0                    15207.263219 46365.2299   205%     -   16s
     0     0 46342.4352    0  234 15207.2632 46342.4352   205%     -   16s
H    0     0                    15674.738718 46342.4352   196%     -   16s
H    0     0                    17167.195753 46342.4352   170%     -   16s
H    0     0                    17335.871729 46342.4352   167%     -   16s
H    0     0                    18371.013265 46342.4352   152%     -   16s
H    0     0                    21432.259158 46342.4352   116%     -   16s
     0     0 45598.5831    0  248 21432.2592 45598.5831   113%     -   18s
     0     0 45181.2201    0  241 21432.2592 45181.2201   111%     -   19s
     0     0 45181.2201    0  279 21432.2592 45181.2201   111%     -   20s
     0     0 45181.2201    0  277 21432.2592 45181.2201   111%     -   20s
     0     0 45181.2201    0  277 21432.2592 45181.2201   111%     -   20s
     0     0 45181.2201    0  281 21432.2592 45181.2201   111%     -   20s
     0     0 42250.3549    0  320 21432.2592 42250.3549  97.1%     -   25s
H    0     0                    21485.012430 42250.3549  96.7%     -   26s
H    0     0                    21576.522573 42250.3549  95.8%     -   26s
H    0     0                    21793.821073 42250.3549  93.9%     -   26s
H    0     0                    21900.734123 42250.3549  92.9%     -   26s
     0     0 41791.4444    0  326 21900.7341 41791.4444  90.8%     -   29s
     0     0 41577.8156    0  331 21900.7341 41577.8156  89.8%     -   30s
     0     0 41435.9083    0  349 21900.7341 41435.9083  89.2%     -   31s
     0     0 41363.1869    0  342 21900.7341 41363.1869  88.9%     -   32s
     0     0 41356.7469    0  352 21900.7341 41356.7469  88.8%     -   32s
     0     0 41353.8226    0  353 21900.7341 41353.8226  88.8%     -   32s
     0     0 41353.2283    0  352 21900.7341 41353.2283  88.8%     -   33s
     0     0 40338.7585    0  368 21900.7341 40338.7585  84.2%     -   39s
H    0     0                    22735.783881 40337.8943  77.4%     -   40s
     0     0 39920.3183    0  372 22735.7839 39920.3183  75.6%     -   43s
     0     0 39753.6905    0  371 22735.7839 39753.6905  74.9%     -   45s
     0     0 39534.0652    0  386 22735.7839 39534.0652  73.9%     -   47s
     0     0 39490.2334    0  389 22735.7839 39490.2334  73.7%     -   48s
     0     0 39479.1546    0  393 22735.7839 39479.1546  73.6%     -   48s
     0     0 39474.8051    0  394 22735.7839 39474.8051  73.6%     -   49s
     0     0 39472.8423    0  397 22735.7839 39472.8423  73.6%     -   49s
     0     0 39469.7057    0  397 22735.7839 39469.7057  73.6%     -   49s
     0     0 39469.0132    0  397 22735.7839 39469.0132  73.6%     -   49s
     0     0 38959.7886    0  454 22735.7839 38959.7886  71.4%     -   57s
H    0     0                    23219.150377 38959.7387  67.8%     -   57s
H    0     0                    23447.005983 38773.5880  65.4%     -   59s
H    0     0                    23915.200838 38773.5880  62.1%     -   59s
H    0     0                    24704.360283 38773.5880  57.0%     -   59s
H    0     0                    24859.257717 38773.5880  56.0%     -   59s
H    0     0                    24907.498699 38773.5880  55.7%     -   59s
     0     0 38773.5880    0  476 24907.4987 38773.5880  55.7%     -   59s
H    0     0                    24942.894002 38684.5945  55.1%     -   61s
     0     0 38684.5945    0  429 24942.8940 38684.5945  55.1%     -   61s
     0     0 38633.6444    0  470 24942.8940 38633.6444  54.9%     -   61s
     0     0 38608.8225    0  479 24942.8940 38608.8225  54.8%     -   62s
     0     0 38602.3635    0  476 24942.8940 38602.3635  54.8%     -   62s
     0     0 38581.0946    0  469 24942.8940 38581.0946  54.7%     -   63s
     0     0 38578.9707    0  431 24942.8940 38578.9707  54.7%     -   63s
     0     0 38576.7126    0  476 24942.8940 38576.7126  54.7%     -   63s
     0     0 38575.7543    0  435 24942.8940 38575.7543  54.7%     -   63s
     0     0 38446.8146    0  473 24942.8940 38446.8146  54.1%     -   65s
H    0     0                    25276.381484 38446.5374  52.1%     -   66s
H    0     0                    25515.614836 38446.5374  50.7%     -   66s
     0     0 38407.2508    0  475 25515.6148 38407.2508  50.5%     -   66s
     0     0 38390.0150    0  489 25515.6148 38390.0150  50.5%     -   67s
     0     0 38380.4921    0  494 25515.6148 38380.4921  50.4%     -   67s
     0     0 38375.0360    0  496 25515.6148 38375.0360  50.4%     -   67s
     0     0 38374.3505    0  495 25515.6148 38374.3505  50.4%     -   67s
     0     0 38313.0483    0  430 25515.6148 38313.0483  50.2%     -   69s
     0     0 38307.3949    0  428 25515.6148 38307.3949  50.1%     -   70s
     0     0 38306.2249    0  430 25515.6148 38306.2249  50.1%     -   70s
     0     0 38246.3400    0  490 25515.6148 38246.3400  49.9%     -   72s
     0     0 38208.2130    0  483 25515.6148 38208.2130  49.7%     -   73s
     0     0 38194.5448    0  481 25515.6148 38194.5448  49.7%     -   73s
     0     0 38190.1663    0  476 25515.6148 38190.1663  49.7%     -   74s
     0     0 38188.6855    0  487 25515.6148 38188.6855  49.7%     -   74s
     0     0 38188.3358    0  488 25515.6148 38188.3358  49.7%     -   74s
     0     0 38155.6397    0  420 25515.6148 38155.6397  49.5%     -   75s
     0     0 38133.1062    0  440 25515.6148 38133.1062  49.5%     -   76s
     0     0 38131.7681    0  445 25515.6148 38131.7681  49.4%     -   76s
     0     0 38125.8225    0  440 25515.6148 38125.8225  49.4%     -   77s
     0     0 38121.6783    0  448 25515.6148 38121.6783  49.4%     -   77s
     0     0 38121.3215    0  450 25515.6148 38121.3215  49.4%     -   77s
     0     0 38117.3021    0  424 25515.6148 38117.3021  49.4%     -   78s
     0     0 38113.7502    0  438 25515.6148 38113.7502  49.4%     -   79s
     0     0 38109.2818    0  433 25515.6148 38109.2818  49.4%     -   79s
     0     0 38108.7671    0  441 25515.6148 38108.7671  49.4%     -   79s
     0     0 38092.3792    0  440 25515.6148 38092.3792  49.3%     -   80s
     0     0 38091.4978    0  439 25515.6148 38091.4978  49.3%     -   80s
     0     0 38086.7122    0  427 25515.6148 38086.7122  49.3%     -   81s
     0     0 38084.2183    0  451 25515.6148 38084.2183  49.3%     -   82s
     0     0 38083.6121    0  445 25515.6148 38083.6121  49.3%     -   82s
     0     0 38081.0393    0  451 25515.6148 38081.0393  49.2%     -   83s
H    0     0                    25543.020277 38079.7633  49.1%     -   83s
     0     0 38079.7633    0  442 25543.0203 38079.7633  49.1%     -   83s
H    0     0                    25614.440264 38079.7633  48.7%     -   83s
H    0     0                    25640.316461 38079.7633  48.5%     -   83s
H    0     0                    25650.112497 38079.7633  48.5%     -   83s
     0     0 38077.6126    0  452 25650.1125 38077.6126  48.5%     -   84s
     0     0 38076.4672    0  452 25650.1125 38076.4672  48.4%     -   84s
H    0     0                    25650.401656 38076.2793  48.4%     -  101s
H    0     0                    25703.618139 38076.2793  48.1%     -  101s
     0     2 38076.2793    0  452 25703.6181 38076.2793  48.1%     -  102s
     3     8 37962.1357    2  442 25703.6181 37989.3796  47.8%  1142  110s
     7    16 37927.0707    3  444 25703.6181 37962.0264  47.7%  2867  117s
    15    32 37712.2851    4  440 25703.6181 37926.3001  47.6%  4188  120s
    31    48 35354.2426    5  429 25703.6181 37732.5792  46.8%  5378  132s
    47    80 35678.6077    6  368 25703.6181 37732.5792  46.8%  7535  136s
    79   139 35617.7808    7  322 25703.6181 37732.5792  46.8%  5785  148s
   148   257 35396.2053    8  302 25703.6181 37732.5792  46.8%  4436  153s
   272   359 35312.5076    9  298 25703.6181 37732.5792  46.8%  3102  157s
   376   408 34026.9399   10  278 25703.6181 37732.5792  46.8%  2658  164s
   459   464 34670.0673   10  274 25703.6181 37732.5792  46.8%  2447  171s
   541   516 34538.8437   11  292 25703.6181 37732.5792  46.8%  2308  178s
   609   574 34645.9835   10  288 25703.6181 37732.5792  46.8%  2190  183s
   691   613 33522.2025   10  254 25703.6181 37732.5792  46.8%  2103  188s
H  713   613                    25784.822990 37732.5792  46.3%  2076  188s
   758   668 34289.7093   12  273 25784.8230 37712.1002  46.3%  2070  195s
   904   768 31598.8985   13  247 25784.8230 37311.8555  44.7%  1997  205s
   983   836 31606.2756   13  268 25784.8230 37311.8555  44.7%  1969  210s
  1149   910 31483.9434   14  260 25784.8230 37311.8555  44.7%  1865  218s
  1244   941 30003.5733   14  227 25784.8230 37311.8555  44.7%  1815  225s
  1310   999 31321.3998   15  289 25784.8230 37311.8555  44.7%  1823  230s
  1382  1075     cutoff   15      25784.8230 37311.8555  44.7%  1838  236s
  1488  1159 29453.1319   17  251 25784.8230 37040.3964  43.7%  1801  242s
  1617  1259 28661.6516   20  227 25784.8230 37040.3964  43.7%  1744  249s
  1768  1371 28457.4122   24  195 25784.8230 36971.8376  43.4%  1682  255s
  1948  1472 28261.5729   31  200 25784.8230 36971.8376  43.4%  1603  262s
  2129  1533 28176.8236   32  210 25784.8230 36971.8376  43.4%  1543  268s
  2277  1590 26411.4425   35  181 25784.8230 36971.8376  43.4%  1515  276s
  2394  1611 27259.4947   36  191 25784.8230 36145.0799  40.2%  1519  281s
  2435  1634 27592.9864   36  185 25784.8230 36145.0799  40.2%  1530  289s
  2490  1685 27496.4360   37  181 25784.8230 36145.0799  40.2%  1536  297s
  2579  1768 26778.7416   42  184 25784.8230 36145.0799  40.2%  1534  304s
  2686  1851 26437.9637   43  165 25784.8230 35619.2461  38.1%  1529  313s
  2824  1952 28213.0468    7  418 25784.8230 35619.2461  38.1%  1515  320s
  2985  2062 infeasible    8      25784.8230 35367.7686  37.2%  1496  328s
  3184  2189     cutoff   10      25784.8230 35325.8586  37.0%  1477  335s
  3418  2260 31718.5714    8  271 25784.8230 35239.9970  36.7%  1449  344s
  3598  2373 29935.0229   11  311 25784.8230 35222.8970  36.6%  1448  354s
  3775  2506 28993.6002   14  293 25784.8230 35222.8970  36.6%  1446  362s
  4018  2614 27328.0450   20  242 25784.8230 35222.8970  36.6%  1427  371s
  4247  2615 29600.4390   16  452 25784.8230 35183.2831  36.4%  1419  394s
  4249  2616 27166.3091   31  196 25784.8230 35183.2831  36.4%  1418  404s
  4250  2617 30369.7861   21  345 25784.8230 35183.2831  36.4%  1418  415s
  4251  2618 31240.0421   13  374 25784.8230 35183.2831  36.4%  1418  420s
  4253  2619 29806.1581   19  460 25784.8230 35183.2831  36.4%  1417  427s
  4254  2620 31701.9101   13  420 25784.8230 35183.2831  36.4%  1417  430s
  4257  2622 28975.6874   12  482 25784.8230 35183.2831  36.4%  1416  435s
  4262  2625 29180.3795   23  472 25784.8230 35183.2831  36.4%  1414  441s
  4266  2628 26616.2445   31  485 25784.8230 35183.2831  36.4%  1413  445s
  4269  2630 30266.8784   24  473 25784.8230 35183.2831  36.4%  1412  450s
  4271  2631 28513.8243   19  477 25784.8230 35183.2831  36.4%  1411  455s
  4273  2632 30010.4332   23  502 25784.8230 35183.2831  36.4%  1410  460s
  4276  2634 30407.8120   14  548 25784.8230 35183.2831  36.4%  1409  465s
  4278  2636 27272.8692   55  526 25784.8230 35183.2831  36.4%  1409  471s
  4280  2637 28532.2638   29  547 25784.8230 35183.2831  36.4%  1408  475s
  4282  2638 27434.7876   16  515 25784.8230 35183.2831  36.4%  1407  488s
  4283  2639 28925.2049   20  515 25784.8230 35183.2831  36.4%  1407  504s
  4284  2643 35183.2831   12  530 25784.8230 35183.2831  36.4%  1433  511s
  4286  2646 35183.2831   13  531 25784.8230 35183.2831  36.4%  1435  518s
  4290  2653 35183.2831   14  523 25784.8230 35183.2831  36.4%  1437  526s
  4298  2666 35183.2831   15  538 25784.8230 35183.2831  36.4%  1441  536s
  4314  2684 35183.2831   16  452 25784.8230 35183.2831  36.4%  1473  550s
  4337  2708 30428.4373   17  347 25784.8230 35183.2831  36.4%  1498  560s
  4369  2746 30247.3762   18  348 25784.8230 35183.2831  36.4%  1535  569s
  4441  2759 29045.1549   20  313 25784.8230 35183.2831  36.4%  1574  580s
  4543  2764 27204.6166   20  241 25784.8230 35183.2831  36.4%  1590  586s
  4623  2786 28640.5930   21  382 25784.8230 35183.2831  36.4%  1601  593s
  4703  2806 27657.8281   22  345 25784.8230 35183.2831  36.4%  1611  599s
  4781  2796 27900.4136   23  300 25784.8230 35183.2831  36.4%  1614  606s
  4869  2811 26660.4489   25  270 25784.8230 35183.2831  36.4%  1611  617s
  4914  2805 26286.1955   26  231 25784.8230 34733.8739  34.7%  1612  622s
  4976  2791     cutoff   27      25784.8230 34733.8739  34.7%  1611  629s
  5054  2790 26251.7638   26  269 25784.8230 34292.6288  33.0%  1608  635s
  5117  2782     cutoff   28      25784.8230 34292.6288  33.0%  1611  642s
  5169  2775 28692.8821   20  375 25784.8230 33897.1685  31.5%  1613  647s
  5227  2777 28480.9638   21  315 25784.8230 33777.4223  31.0%  1617  654s
  5282  2795     cutoff   23      25784.8230 33777.4223  31.0%  1622  661s
  5349  2809     cutoff   21      25784.8230 33321.3658  29.2%  1629  668s
  5423  2795 30728.6170   17  385 25784.8230 33321.3658  29.2%  1637  676s
  5523  2786 31666.6874   17  358 25784.8230 33321.3658  29.2%  1638  684s
  5605  2753 30005.3916   18  349 25784.8230 32951.9530  27.8%  1645  692s
  5702  2737 28177.1860   19  345 25784.8230 32415.6061  25.7%  1654  700s
  5799  2696 26810.7947   20  353 25784.8230 32415.6061  25.7%  1656  709s
  5907  2676 29973.7029   18  371 25784.8230 32415.6061  25.7%  1666  716s
  5956  2671 27512.4121   20  360 25784.8230 31726.2849  23.0%  1675  724s
  6047  2647 26485.2268   22  337 25784.8230 31574.9581  22.5%  1677  730s
  6176  2635     cutoff   19      25784.8230 31574.9581  22.5%  1681  738s
  6314  2599     cutoff   21      25784.8230 31574.9581  22.5%  1683  745s
  6435  2562     cutoff   22      25784.8230 30786.5866  19.4%  1680  753s
  6584  2531 28346.3584   23  350 25784.8230 30663.9235  18.9%  1681  761s
  6730  2506 27689.5081   25  276 25784.8230 30663.9235  18.9%  1683  770s
  6909  2442 26817.7801   28  205 25784.8230 30663.9235  18.9%  1680  779s
  7103  2365     cutoff   23      25784.8230 29734.5220  15.3%  1681  787s
  7330  2288 26653.1308   28  129 25784.8230 29734.5220  15.3%  1672  795s
  7482  2218 26234.7653   29  286 25784.8230 29734.5220  15.3%  1669  803s
  7586  2159 26110.4985   30  266 25784.8230 29734.5220  15.3%  1666  810s
  7696  2127 25997.6926   31  207 25784.8230 29163.5416  13.1%  1664  818s
  7835  2045 25824.6377   32  151 25784.8230 29079.1634  12.8%  1658  826s
  8059  1919 26371.1550   28  137 25784.8230 28804.5178  11.7%  1647  835s
  8335  1834     cutoff   25      25784.8230 28442.3822  10.3%  1635  843s
* 8531  1636              34    25804.522194 28442.3822  10.2%  1623  843s
  8536  1524     cutoff   28      25804.5222 28442.3822  10.2%  1623  852s
  8977  1235     cutoff   30      25804.5222 27696.8628  7.33%  1596  861s
  9509   907     cutoff   33      25804.5222 27305.8161  5.82%  1555  868s
 10164   574 infeasible   30      25804.5222 26833.6712  3.99%  1489  874s
*10189   439              73    25816.164861 26833.6712  3.94%  1485  874s
*10615   177              74    25876.051023 26572.5435  2.69%  1432  874s
 10722   139 26107.9601   43   69 25876.0510 26170.1075  1.14%  1421  875s
*10798    25              50    25880.849760 26170.1075  1.12%  1411  875s
*10876    25              49    25904.591865 26096.6572  0.74%  1402  875s

Cutting planes:
  Learned: 1
  MIR: 549
  Mixing: 2
  Flow cover: 1169
  Zero half: 1
  RLT: 24
  Relax-and-lift: 91

Explored 11024 nodes (15380372 simplex iterations) in 875.71 seconds (2434.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25904.6 25880.8 25876.1 ... 25640.3

Optimal solution found (tolerance 1.00e-04)
Best objective 2.590459186541e+04, best bound 2.590459186541e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 875.73s
  Master Objective (UB) = 25904.59, θ = 169987.13
  Upper Bound (UB) = 25904.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169987.13
  [DEBUG]   ✓ Scenario 0: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169987.13 ≤ Q = 169987.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x416089c4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbe9f763c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307612e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 5969130.0828
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.613031e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161303.09    0  126 5969130.08 -161303.09   103%     -    0s
H    0     0                    -124053.2055 -161303.09  30.0%     -    0s
H    0     0                    -124546.0576 -161303.09  29.5%     -    0s
H    0     0                    -133803.2229 -161303.09  20.6%     -    0s
     0     0 -142204.46    0   91 -133803.22 -142204.46  6.28%     -    0s
H    0     0                    -139018.3063 -142123.70  2.23%     -    0s
     0     0 -141840.58    0   87 -139018.31 -141840.58  2.03%     -    0s
     0     0 -141831.54    0   87 -139018.31 -141831.54  2.02%     -    0s
     0     0 -141393.05    0   50 -139018.31 -141393.05  1.71%     -    0s
H    0     0                    -140167.1394 -141387.21  0.87%     -    0s
     0     0 -141362.13    0   50 -140167.14 -141362.13  0.85%     -    0s
H    0     0                    -140818.7133 -141359.96  0.38%     -    0s
H    0     0                    -140920.3978 -141359.96  0.31%     -    0s
     0     0 -141294.67    0   37 -140920.40 -141294.67  0.27%     -    0s
     0     0 -141294.49    0   36 -140920.40 -141294.49  0.27%     -    0s
     0     0 -141285.66    0   29 -140920.40 -141285.66  0.26%     -    0s
     0     0 -141010.38    0    8 -140920.40 -141010.38  0.06%     -    0s
     0     0 -140978.65    0    9 -140920.40 -140978.65  0.04%     -    0s
     0     0 -140976.19    0   10 -140920.40 -140976.19  0.04%     -    0s
     0     0 -140950.71    0    4 -140920.40 -140950.71  0.02%     -    0s
     0     0 -140950.71    0    9 -140920.40 -140950.71  0.02%     -    0s
     0     0 -140950.71    0    8 -140920.40 -140950.71  0.02%     -    0s
H    0     0                    -140926.4255 -140950.71  0.02%     -    0s
     0     0          -    0      -140926.43 -140935.32  0.01%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 5
  Flow cover: 2

Explored 1 nodes (590 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -140926 -140920 -140738 ... 5.96913e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.409264255083e+05, best bound -1.409353241519e+05, gap 0.0063%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 156455.44
  Scenario: 25 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140926.43
  [DEBUG]   S×d_nominal = 297381.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 297381.87 + -140926.43 = 156455.44
  [DEBUG]   Current θ from Master = 169987.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13531.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12372.90
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2126.1144, Absolute Gap = 2126.1144, Relative Gap = 0.082075
  Not converged yet (gap = 2126.11 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 34 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264869 nonzeros
Model fingerprint: 0xb4184760
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43692 rows and 17742 columns
Presolve time: 0.81s
Presolved: 49431 rows, 21958 columns, 306779 nonzeros
Variable types: 19699 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -204344.1227

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 49431 rows, 21958 columns, 306779 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34001    2.0147703e+02   0.000000e+00   1.327449e+07      5s
Warning: 1 variables dropped from basis
Warning: switch to quad precision
   41666    5.5582144e+03   0.000000e+00   1.628357e+07     10s
   43616    5.8669814e+03   0.000000e+00   1.003083e+08     15s
   45717    7.8339615e+03   0.000000e+00   1.614413e+08     20s
Concurrent spin time: 5.51s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.993757e+04, 35780 iterations, 19.61 seconds (28.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49937.5655    0  196 -204344.12 49937.5655   124%     -   20s
H    0     0                    -200974.4605 49937.5655   125%     -   20s
H    0     0                    -127682.1970 49937.5655   139%     -   21s
H    0     0                    -118736.3305 49937.5655   142%     -   21s
H    0     0                    -81872.15689 49937.5655   161%     -   21s
H    0     0                    -80978.56535 49937.5655   162%     -   21s
H    0     0                    -22023.18692 49937.5655   327%     -   21s
H    0     0                    -19272.74965 49937.5655   359%     -   21s
H    0     0                    4942.4524160 49937.5655   910%     -   21s
H    0     0                    9841.8898956 49937.5655   407%     -   21s
H    0     0                    10206.096446 49937.5655   389%     -   21s
H    0     0                    10235.831698 49937.5655   388%     -   21s
H    0     0                    11111.470779 49937.5655   349%     -   21s
H    0     0                    11208.810266 49937.5655   346%     -   22s
H    0     0                    11593.697165 46337.9813   300%     -   28s
     0     0 46337.9813    0  252 11593.6972 46337.9813   300%     -   28s
     0     0 45312.2854    0  276 11593.6972 45312.2854   291%     -   31s
     0     0 45179.3323    0  279 11593.6972 45179.3323   290%     -   33s
     0     0 45179.3323    0  283 11593.6972 45179.3323   290%     -   34s
     0     0 45179.3323    0  282 11593.6972 45179.3323   290%     -   34s
     0     0 45179.3323    0  285 11593.6972 45179.3323   290%     -   34s
     0     0 45179.3323    0  285 11593.6972 45179.3323   290%     -   34s
     0     0 45179.3323    0  283 11593.6972 45179.3323   290%     -   34s
H    0     0                    14004.615422 42086.2451   201%     -   42s
H    0     0                    14363.966787 42086.2451   193%     -   42s
H    0     0                    14485.795750 42086.2451   191%     -   42s
H    0     0                    14629.526634 42086.2451   188%     -   42s
H    0     0                    17093.265914 42086.2451   146%     -   42s
     0     0 42086.2451    0  332 17093.2659 42086.2451   146%     -   42s
     0     0 41712.4676    0  332 17093.2659 41712.4676   144%     -   45s
H    0     0                    20553.017921 41492.2546   102%     -   47s
H    0     0                    20934.329558 41492.2546  98.2%     -   47s
H    0     0                    21158.839550 41492.2546  96.1%     -   47s
H    0     0                    21227.530487 41492.2546  95.5%     -   47s
H    0     0                    21264.599003 41492.2546  95.1%     -   47s
     0     0 41492.2546    0  347 21264.5990 41492.2546  95.1%     -   47s
     0     0 41452.1155    0  343 21264.5990 41452.1155  94.9%     -   48s
     0     0 41433.8828    0  341 21264.5990 41433.8828  94.8%     -   49s
H    0     0                    23059.842537 41430.4300  79.7%     -   49s
H    0     0                    23104.161160 41430.4300  79.3%     -   49s
H    0     0                    23143.958980 41430.4300  79.0%     -   49s
H    0     0                    23196.366362 41430.4300  78.6%     -   49s
     0     0 41430.4300    0  349 23196.3664 41430.4300  78.6%     -   49s
     0     0 41429.6931    0  350 23196.3664 41429.6931  78.6%     -   50s
     0     0 40281.0963    0  368 23196.3664 40281.0963  73.7%     -   58s
H    0     0                    23310.797386 40280.3507  72.8%     -   59s
H    0     0                    23529.488486 40280.3507  71.2%     -   59s
     0     0 39813.0503    0  396 23529.4885 39813.0503  69.2%     -   62s
     0     0 39609.7185    0  424 23529.4885 39609.7185  68.3%     -   65s
     0     0 39492.6110    0  440 23529.4885 39492.6110  67.8%     -   67s
     0     0 39435.1239    0  404 23529.4885 39435.1239  67.6%     -   68s
     0     0 39351.8236    0  405 23529.4885 39351.8236  67.2%     -   70s
     0     0 39337.9387    0  410 23529.4885 39337.9387  67.2%     -   71s
     0     0 39327.1309    0  409 23529.4885 39327.1309  67.1%     -   71s
     0     0 39322.9045    0  407 23529.4885 39322.9045  67.1%     -   72s
     0     0 39314.5686    0  412 23529.4885 39314.5686  67.1%     -   72s
     0     0 39313.0045    0  412 23529.4885 39313.0045  67.1%     -   72s
     0     0 39312.3163    0  411 23529.4885 39312.3163  67.1%     -   73s
H    0     0                    23739.048100 38835.4844  63.6%     -   80s
     0     0 38835.4844    0  432 23739.0481 38835.4844  63.6%     -   80s
     0     0 38686.5639    0  459 23739.0481 38686.5639  63.0%     -   82s
     0     0 38637.1938    0  450 23739.0481 38637.1938  62.8%     -   84s
     0     0 38558.7760    0  415 23739.0481 38558.7760  62.4%     -   85s
     0     0 38536.9816    0  461 23739.0481 38536.9816  62.3%     -   86s
     0     0 38529.3473    0  461 23739.0481 38529.3473  62.3%     -   87s
     0     0 38519.4168    0  449 23739.0481 38519.4168  62.3%     -   88s
     0     0 38516.7078    0  455 23739.0481 38516.7078  62.3%     -   88s
     0     0 38515.2513    0  454 23739.0481 38515.2513  62.2%     -   88s
     0     0 38512.8677    0  457 23739.0481 38512.8677  62.2%     -   88s
     0     0 38511.8607    0  457 23739.0481 38511.8607  62.2%     -   89s
     0     0 38440.4995    0  411 23739.0481 38440.4995  61.9%     -   91s
H    0     0                    23996.344675 38440.4087  60.2%     -   92s
H    0     0                    24011.412267 38440.4087  60.1%     -   92s
H    0     0                    24027.732671 38440.4087  60.0%     -   92s
H    0     0                    24050.428633 38440.4087  59.8%     -   92s
H    0     0                    24051.012516 38440.4087  59.8%     -   92s
     0     0 38418.8411    0  472 24051.0125 38418.8411  59.7%     -   93s
     0     0 38408.5279    0  421 24051.0125 38408.5279  59.7%     -   94s
     0     0 38404.1966    0  474 24051.0125 38404.1966  59.7%     -   94s
     0     0 38403.3882    0  424 24051.0125 38403.3882  59.7%     -   94s
     0     0 38366.6904    0  484 24051.0125 38366.6904  59.5%     -   96s
     0     0 38352.3748    0  482 24051.0125 38352.3748  59.5%     -   97s
     0     0 38346.4676    0  485 24051.0125 38346.4676  59.4%     -   97s
     0     0 38337.5160    0  483 24051.0125 38337.5160  59.4%     -   98s
     0     0 38333.4811    0  482 24051.0125 38333.4811  59.4%     -   98s
     0     0 38329.1629    0  481 24051.0125 38329.1629  59.4%     -   99s
     0     0 38328.2131    0  484 24051.0125 38328.2131  59.4%     -   99s
     0     0 38310.7393    0  485 24051.0125 38310.7393  59.3%     -  101s
     0     0 38267.9539    0  469 24051.0125 38267.9539  59.1%     -  102s
     0     0 38240.1284    0  488 24051.0125 38240.1284  59.0%     -  103s
     0     0 38230.5580    0  460 24051.0125 38230.5580  59.0%     -  104s
     0     0 38227.7407    0  459 24051.0125 38227.7407  58.9%     -  104s
     0     0 38227.1365    0  469 24051.0125 38227.1365  58.9%     -  104s
     0     0 38201.6986    0  415 24051.0125 38201.6986  58.8%     -  105s
     0     0 38195.1858    0  417 24051.0125 38195.1858  58.8%     -  107s
     0     0 38192.2060    0  411 24051.0125 38192.2060  58.8%     -  107s
     0     0 38191.7061    0  420 24051.0125 38191.7061  58.8%     -  107s
     0     0 38178.9072    0  479 24051.0125 38178.9072  58.7%     -  109s
     0     0 38177.4378    0  443 24051.0125 38177.4378  58.7%     -  109s
     0     0 38176.7272    0  445 24051.0125 38176.7272  58.7%     -  109s
     0     0 38158.5544    0  485 24051.0125 38158.5544  58.7%     -  111s
H    0     0                    24097.143719 38157.9119  58.4%     -  112s
     0     0 38154.3631    0  445 24097.1437 38154.3631  58.3%     -  112s
     0     0 38152.7644    0  495 24097.1437 38152.7644  58.3%     -  113s
     0     0 38152.2225    0  492 24097.1437 38152.2225  58.3%     -  113s
     0     0 38145.9642    0  494 24097.1437 38145.9642  58.3%     -  114s
     0     0 38145.4374    0  453 24097.1437 38145.4374  58.3%     -  114s
     0     0 38137.9297    0  487 24097.1437 38137.9297  58.3%     -  115s
H    0     0                    24159.506830 38137.4591  57.9%     -  116s
H    0     0                    24174.921991 38137.4591  57.8%     -  116s
     0     0 38133.2339    0  495 24174.9220 38133.2339  57.7%     -  116s
     0     0 38132.6077    0  497 24174.9220 38132.6077  57.7%     -  116s
     0     0 38129.9694    0  497 24174.9220 38129.9694  57.7%     -  117s
     0     0 38129.4089    0  497 24174.9220 38129.4089  57.7%     -  118s
H    0     0                    24222.313414 38129.4089  57.4%     -  131s
H    0     0                    24446.749487 38129.4089  56.0%     -  134s
H    0     2                    24517.394372 38129.4089  55.5%     -  134s
     0     2 38129.4089    0  497 24517.3944 38129.4089  55.5%     -  134s
     1     4 37875.4245    1  479 24517.3944 38119.2920  55.5%  2097  136s
     3     8 37838.4409    2  485 24517.3944 37875.3226  54.5%  2388  142s
     7    16 37436.4999    3  485 24517.3944 37838.0213  54.3%  3937  147s
    15    32 37310.7369    4  489 24517.3944 37436.1902  52.7%  5519  153s
    31    49 36653.1382    5  441 24517.3944 37310.3039  52.2%  8038  167s
    48    81 35855.7539    6  467 24517.3944 37310.1127  52.2%  7830  188s
    80   237 35822.0634    7  461 24517.3944 37310.1127  52.2%  6298  197s
H   83   237                    24557.039498 37310.1127  51.9%  6109  197s
H   88   237                    24632.419226 37310.1127  51.5%  5879  197s
H   93   237                    24644.290787 37310.1127  51.4%  5660  197s
H  171   237                    24647.486817 37310.1127  51.4%  3794  197s
H  190   237                    24759.315640 37310.1127  50.7%  3540  197s
   236   320 35055.8397   11  355 24759.3156 37310.1127  50.7%  3205  204s
   319   401 35652.7835   11  435 24759.3156 37310.1127  50.7%  2910  212s
   400   476 35734.7102    9  449 24759.3156 37310.1127  50.7%  2763  217s
   475   544 35281.5396   11  389 24759.3156 37310.1127  50.7%  2639  224s
   543   619 35560.6503   13  394 24759.3156 37310.1127  50.7%  2546  230s
   618   682 35297.8554   13  390 24759.3156 37310.1127  50.7%  2437  235s
   681   721 34542.5733   14  418 24759.3156 37310.1127  50.7%  2430  242s
   740   764 29094.2780   25  305 24759.3156 37310.1127  50.7%  2469  249s
   807   832 34093.8218   13  315 24759.3156 37310.1127  50.7%  2434  256s
   891   888 33842.9337   13  256 24759.3156 37310.1127  50.7%  2354  263s
   979   956 28374.8920   32  296 24759.3156 37206.3035  50.3%  2272  270s
  1091   987 34314.8501   14  374 24759.3156 37206.3035  50.3%  2163  278s
  1138  1024 34330.7757   15  368 24759.3156 37206.3035  50.3%  2165  285s
  1218  1045 34370.8184   15  371 24759.3156 37206.3035  50.3%  2127  292s
  1259  1069 34074.0734   14  313 24759.3156 37206.3035  50.3%  2122  298s
  1313  1116 31419.7105   14  239 24759.3156 37206.3035  50.3%  2128  306s
  1360  1179 32542.4655   16  395 24759.3156 37206.3035  50.3%  2127  312s
  1437  1200 31378.4441   16  332 24759.3156 37206.3035  50.3%  2101  320s
  1474  1245 32542.7156   16  372 24759.3156 37206.3035  50.3%  2084  325s
  1537  1315 32072.6977   17  313 24759.3156 37206.3035  50.3%  2050  331s
  1627  1389 32190.3998   17  340 24759.3156 37206.3035  50.3%  2001  340s
  1741  1484 31204.3598   17  339 24759.3156 37017.4113  49.5%  1966  349s
H 1755  1484                    24825.867163 37017.4113  49.1%  1967  349s
  1878  1586 26773.6880   17  339 24825.8672 37017.4113  49.1%  1916  357s
  2028  1689 29812.4952   19  281 24825.8672 37017.4113  49.1%  1876  366s
  2193  1823 26952.4093   17  313 24825.8672 37017.4113  49.1%  1837  374s
  2392  1961 29780.1518   20  254 24825.8672 36094.1502  45.4%  1789  384s
  2592  2049 29401.6942   21  204 24825.8672 36094.1502  45.4%  1739  394s
  2786  2144 28441.6808   23  155 24825.8672 36094.1502  45.4%  1711  402s
  2943  2264 26820.1911   23  163 24825.8672 36016.5822  45.1%  1706  412s
  3129  2364     cutoff   27      24825.8672 36016.5822  45.1%  1698  422s
  3275  2473 32276.1751    7  350 24825.8672 35747.0217  44.0%  1713  432s
  3440  2595 28229.9087   10  214 24825.8672 35745.5560  44.0%  1725  442s
  3637  2727 26904.2903   14  249 24825.8672 35745.5560  44.0%  1728  452s
H 3876  2685                    25593.359891 35745.5560  39.7%  1713  461s
H 3923  2625                    25784.822990 35745.5560  38.6%  1704  461s
  4062  2624 32035.9089   16  323 25784.8230 35507.7023  37.7%  1701  471s
  4126  2657 31953.0419   17  274 25784.8230 35481.5609  37.6%  1712  482s
  4167  2713 31133.6462   17  271 25784.8230 35481.5609  37.6%  1728  493s
  4269  2770 27025.3513   17  276 25784.8230 35481.5609  37.6%  1736  505s
  4440  2840 28302.6932   19  195 25784.8230 35481.5609  37.6%  1739  518s
  4663  2920 28138.5739   20  165 25784.8230 35408.1922  37.3%  1748  528s
  4843  2987 26807.4914   25  160 25784.8230 35324.0902  37.0%  1772  540s
  5080  3010 32681.1881   14  334 25784.8230 35324.0902  37.0%  1786  554s
  5218  3100 28034.8111   16  330 25784.8230 35205.3469  36.5%  1797  567s
  5436  3191 26100.9947   21  181 25784.8230 35101.7015  36.1%  1809  580s
  5700  3192 27077.5993   18  497 25784.8230 35015.5974  35.8%  1818  613s
  5702  3193 25939.2625   28  196 25784.8230 35015.5974  35.8%  1817  639s
  5703  3194 28545.5413   30  386 25784.8230 35015.5974  35.8%  1817  653s
  5704  3195 32187.2068   16  415 25784.8230 35015.5974  35.8%  1817  661s
  5705  3195 27010.1521   21  398 25784.8230 35015.5974  35.8%  1816  665s
  5706  3196 28014.9683   27  466 25784.8230 35015.5974  35.8%  1816  670s
  5707  3197 28954.7568   28  501 25784.8230 35015.5974  35.8%  1816  677s
  5708  3197 29622.0770   24  479 25784.8230 35015.5974  35.8%  1815  680s
  5711  3199 26526.9788   45  494 25784.8230 35015.5974  35.8%  1814  685s
  5715  3202 34575.0112    9  487 25784.8230 35015.5974  35.8%  1813  692s
  5717  3203 26411.1502   42  490 25784.8230 35015.5974  35.8%  1813  697s
  5720  3205 26050.4146   39  427 25784.8230 35015.5974  35.8%  1812  702s
  5722  3207 34105.5607    8  493 25784.8230 35015.5974  35.8%  1811  707s
  5724  3208 33066.0235   12  517 25784.8230 35015.5974  35.8%  1810  711s
  5726  3209 27508.7239   36  514 25784.8230 35015.5974  35.8%  1810  718s
  5727  3210 26201.9377   65  472 25784.8230 35015.5974  35.8%  1809  720s
  5729  3211 34456.4364   12  559 25784.8230 35015.5974  35.8%  1809  727s
  5730  3212 26817.9759   19  544 25784.8230 35015.5974  35.8%  1808  730s
  5732  3213 34138.3261   24  464 25784.8230 35015.5974  35.8%  1808  756s
  5733  3214 33098.0675   21  464 25784.8230 35015.5974  35.8%  1807  771s
  5734  3218 35015.5974   14  530 25784.8230 35015.5974  35.8%  1838  788s
  5736  3221 35015.5974   15  513 25784.8230 35015.5974  35.8%  1838  802s
  5740  3228 35015.5974   16  521 25784.8230 35015.5974  35.8%  1842  820s
  5748  3241 35015.5974   17  525 25784.8230 35015.5974  35.8%  1851  830s
  5764  3258 34667.6496   18  460 25784.8230 35015.5974  35.8%  1886  851s
  5786  3282 33543.9618   19  348 25784.8230 35015.5974  35.8%  1908  863s
  5818  3319 33367.8601   20  342 25784.8230 35015.5974  35.8%  1938  877s
  5867  3397 33319.0324   21  281 25784.8230 35015.5974  35.8%  1950  892s
  5978  3417 32282.8337   22  328 25784.8230 35015.5974  35.8%  2002  908s
  6083  3422 30550.2685   22  269 25784.8230 35015.5974  35.8%  2020  919s
  6183  3401 31238.9330   23  325 25784.8230 35015.5974  35.8%  2033  928s
  6231  3396 31234.1679   23  234 25784.8230 35015.5974  35.8%  2043  939s
  6291  3394 28191.6660   24  228 25784.8230 35015.5974  35.8%  2053  948s
  6331  3399 26575.3047   23  272 25784.8230 35015.5974  35.8%  2070  958s
  6378  3397     cutoff   23      25784.8230 35015.5974  35.8%  2077  965s
  6439  3388     cutoff   25      25784.8230 35015.5974  35.8%  2080  975s
  6493  3390 26439.5321   26  216 25784.8230 35015.5974  35.8%  2087  984s
  6554  3389     cutoff   27      25784.8230 35015.5974  35.8%  2095  991s
  6612  3395 31113.4756   23  252 25784.8230 34795.1611  34.9%  2104 1001s
  6688  3380 30918.4422   24  284 25784.8230 34332.0421  33.1%  2110 1008s
  6772  3371 30164.3570   25  243 25784.8230 34332.0421  33.1%  2114 1019s
  6837  3368 28164.9070   26  258 25784.8230 34060.9118  32.1%  2124 1028s
  6920  3367     cutoff   27      25784.8230 33717.7011  30.8%  2135 1037s
  7026  3339 26134.7185   28  220 25784.8230 33450.5922  29.7%  2140 1048s
  7124  3307     cutoff   30      25784.8230 33450.5922  29.7%  2152 1058s
  7246  3288 29215.0572   23  347 25784.8230 33450.5922  29.7%  2160 1070s
  7350  3287 28398.2361   25  305 25784.8230 33450.5922  29.7%  2174 1080s
  7458  3251 25850.9689   28  233 25784.8230 33450.5922  29.7%  2189 1092s
  7594  3224 27328.7383   24  271 25784.8230 32855.0849  27.4%  2198 1103s
  7731  3211     cutoff   26      25784.8230 32469.7933  25.9%  2207 1114s
  7867  3195 25980.6770   26  229 25784.8230 32206.7842  24.9%  2219 1126s
  8026  3152     cutoff   28      25784.8230 32148.7533  24.7%  2221 1138s
  8176  3104     cutoff   28      25784.8230 32054.7869  24.3%  2232 1151s
  8328  3075     cutoff   26      25784.8230 31664.1773  22.8%  2246 1161s
  8426  3053     cutoff   22      25784.8230 31534.4833  22.3%  2253 1175s
  8576  3024 27396.1738   24  337 25784.8230 31362.8280  21.6%  2264 1190s
  8760  2974 27265.6711   26  320 25784.8230 31248.6804  21.2%  2267 1203s
  8930  2940     cutoff   30      25784.8230 31217.1353  21.1%  2281 1216s
  9128  2889     cutoff   31      25784.8230 30876.3610  19.7%  2287 1232s
  9354  2827 26176.2906   24  296 25784.8230 30544.6039  18.5%  2288 1249s
  9573  2739 26229.7159   24  350 25784.8230 30250.3622  17.3%  2295 1266s
  9767  2666     cutoff   27      25784.8230 30169.0447  17.0%  2297 1281s
  9997  2587     cutoff   26      25784.8230 29928.8027  16.1%  2303 1298s
 10295  2449     cutoff   23      25784.8230 29778.4915  15.5%  2301 1315s
 10569  2350 27551.7068   30  268 25784.8230 29542.2593  14.6%  2305 1333s
 10915  2180 27210.5865   22  218 25784.8230 29252.5955  13.4%  2296 1350s
 11341  2016     cutoff   24      25784.8230 28751.6298  11.5%  2277 1370s
 11795  1772 26682.8466   31  250 25784.8230 28585.0583  10.9%  2256 1388s
 12241  1549     cutoff   28      25784.8230 28064.9671  8.84%  2232 1407s
 12859  1125     cutoff   36      25784.8230 27594.5611  7.02%  2187 1423s
 13847   527 26299.7405   35  133 25784.8230 27222.9953  5.58%  2090 1432s
*14352   197              39    25804.522194 26919.8298  4.32%  2031 1432s

Cutting planes:
  Learned: 1
  MIR: 541
  Flow cover: 1219
  Zero half: 1
  RLT: 27
  Relax-and-lift: 107

Explored 14797 nodes (29419444 simplex iterations) in 1434.57 seconds (4318.58 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25804.5 25784.8 25593.4 ... 24517.4

Optimal solution found (tolerance 1.00e-04)
Best objective 2.580452219369e+04, best bound 2.580452219369e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1434.58s
  Master Objective (UB) = 25804.52, θ = 169051.95
  Upper Bound (UB) = 25804.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169051.95
  [DEBUG]   ✓ Scenario 0: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169051.95 ≤ Q = 169051.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e40d628
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa1bf29d8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.342485e+13
Presolve removed 2614 rows and 1905 columns
Presolve time: 0.00s
Presolved: 479 rows, 484 columns, 1318 nonzeros
Found heuristic solution: objective 6114773.9192
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.618244e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161824.41    0  124 6114773.92 -161824.41   103%     -    0s
H    0     0                    -127427.6200 -161824.41  27.0%     -    0s
H    0     0                    -127905.7740 -161824.41  26.5%     -    0s
H    0     0                    -129400.7910 -161824.41  25.1%     -    0s
     0     0 -142410.52    0   83 -129400.79 -142410.52  10.1%     -    0s
H    0     0                    -140189.1671 -142366.81  1.55%     -    0s
     0     0 -142135.78    0   86 -140189.17 -142135.78  1.39%     -    0s
     0     0 -141380.88    0   70 -140189.17 -141380.88  0.85%     -    0s
H    0     0                    -140680.0319 -141378.23  0.50%     -    0s
     0     0 -141212.00    0   63 -140680.03 -141212.00  0.38%     -    0s
     0     0 -141201.15    0   58 -140680.03 -141201.15  0.37%     -    0s
     0     0 -141174.96    0   66 -140680.03 -141174.96  0.35%     -    0s
     0     0 -141173.27    0   66 -140680.03 -141173.27  0.35%     -    0s
     0     0 -141016.12    0   49 -140680.03 -141016.12  0.24%     -    0s
     0     0 -141013.70    0   48 -140680.03 -141013.70  0.24%     -    0s
H    0     0                    -140918.6662 -141009.50  0.06%     -    0s
     0     0 -141009.50    0   47 -140918.67 -141009.50  0.06%     -    0s
     0     0 -140974.34    0    4 -140918.67 -140974.34  0.04%     -    0s
     0     0 -140974.34    0   37 -140918.67 -140974.34  0.04%     -    0s
     0     0 -140974.34    0   37 -140918.67 -140974.34  0.04%     -    0s
H    0     0                    -140967.0591 -140974.34  0.01%     -    0s

Explored 1 nodes (748 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -140967 -140919 -140680 ... 1.34249e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.409670590827e+05, best bound -1.409743358811e+05, gap 0.0052%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 157455.35
  Scenario: 20 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140967.06
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -140967.06 = 157455.35
  [DEBUG]   Current θ from Master = 169051.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11596.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14207.93
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2026.0447, Absolute Gap = 2026.0447, Relative Gap = 0.078515
  Not converged yet (gap = 2026.04 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 39 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308094 nonzeros
Model fingerprint: 0x46d09190
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50984 rows and 20704 columns
Presolve time: 0.95s
Presolved: 57429 rows, 25236 columns, 356959 nonzeros
Variable types: 22977 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -204344.1227

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 57429 rows, 25236 columns, 356959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29166   -9.2805847e+03   0.000000e+00   9.984606e+08      5s
   43609    2.7434275e+04   0.000000e+00   2.753516e+06     10s
   56114    3.7553516e+04   0.000000e+00   1.047627e+07     15s
   67600    4.1721213e+04   0.000000e+00   2.738366e+08     20s
   80066    4.5854147e+04   0.000000e+00   4.632382e+05     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.993757e+04, 50527 iterations, 25.14 seconds (50.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49937.5655    0  196 -204344.12 49937.5655   124%     -   26s
H    0     0                    -196437.8760 49937.5655   125%     -   26s
H    0     0                    -63902.45577 49937.5655   178%     -   26s
H    0     0                    -43563.74280 49937.5655   215%     -   26s
H    0     0                    -41265.96527 49937.5655   221%     -   26s
H    0     0                    -19470.78591 49937.5655   356%     -   26s
H    0     0                    -18827.79023 49937.5655   365%     -   26s
H    0     0                    -18788.83053 49937.5655   366%     -   27s
H    0     0                    -18711.14547 49937.5655   367%     -   27s
H    0     0                    5951.2286666 46109.0613   675%     -   35s
H    0     0                    7399.2585756 46109.0613   523%     -   35s
H    0     0                    8419.3040400 46109.0613   448%     -   35s
H    0     0                    8450.9847217 46109.0613   446%     -   35s
     0     0 45782.0197    0  246 8450.98472 45782.0197   442%     -   35s
H    0     0                    9058.1819077 45782.0197   405%     -   35s
H    0     0                    9077.0422005 45782.0197   404%     -   35s
H    0     0                    9151.0057925 45782.0197   400%     -   35s
H    0     0                    10340.963170 45782.0197   343%     -   35s
H    0     0                    10660.682347 45782.0197   329%     -   35s
     0     0 45287.1376    0  277 10660.6823 45287.1376   325%     -   38s
     0     0 45252.9321    0  287 10660.6823 45252.9321   324%     -   38s
     0     0 45252.9321    0  276 10660.6823 45252.9321   324%     -   39s
     0     0 45139.8546    0  282 10660.6823 45139.8546   323%     -   40s
     0     0 45106.0023    0  283 10660.6823 45106.0023   323%     -   41s
     0     0 45106.0023    0  284 10660.6823 45106.0023   323%     -   41s
     0     0 45106.0023    0  284 10660.6823 45106.0023   323%     -   41s
     0     0 45105.9752    0  270 10660.6823 45105.9752   323%     -   42s
     0     0 45105.9752    0  270 10660.6823 45105.9752   323%     -   42s
H    0     0                    11100.623155 42662.4592   284%     -   53s
H    0     0                    11902.186402 42662.4592   258%     -   53s
H    0     0                    11933.867084 42662.4592   257%     -   53s
     0     0 42520.9637    0  312 11933.8671 42520.9637   256%     -   53s
H    0     0                    13831.273547 42520.9637   207%     -   53s
H    0     0                    15632.669736 42520.9637   172%     -   53s
H    0     0                    15854.298504 42520.9637   168%     -   53s
H    0     0                    15957.524688 42520.9637   166%     -   53s
     0     0 42123.9655    0  316 15957.5247 42123.9655   164%     -   61s
     0     0 41856.9748    0  320 15957.5247 41856.9748   162%     -   66s
H    0     0                    16665.612511 41665.3567   150%     -   70s
H    0     0                    17545.648565 41665.3567   137%     -   70s
     0     0 41665.3567    0  333 17545.6486 41665.3567   137%     -   70s
     0     0 41625.2357    0  326 17545.6486 41625.2357   137%     -   71s
     0     0 41608.5824    0  360 17545.6486 41608.5824   137%     -   72s
     0     0 41601.7459    0  367 17545.6486 41601.7459   137%     -   72s
     0     0 41601.5919    0  368 17545.6486 41601.5919   137%     -   72s
     0     0 40160.1088    0  383 17545.6486 40160.1088   129%     -   85s
H    0     0                    18615.990025 40159.9738   116%     -   86s
H    0     0                    18803.370370 40159.9738   114%     -   86s
H    0     0                    18898.076480 39805.5402   111%     -   91s
H    0     0                    18929.874593 39805.5402   110%     -   91s
H    0     0                    18983.098138 39805.5402   110%     -   91s
H    0     0                    18999.467365 39805.5402   110%     -   91s
H    0     0                    21382.272362 39805.5402  86.2%     -   91s
H    0     0                    21414.941938 39805.5402  85.9%     -   91s
     0     0 39805.5402    0  396 21414.9419 39805.5402  85.9%     -   91s
H    0     0                    21449.147201 39609.1355  84.7%     -   96s
     0     0 39609.1355    0  395 21449.1472 39609.1355  84.7%     -   96s
     0     0 39534.7209    0  404 21449.1472 39534.7209  84.3%     -   99s
H    0     0                    21552.809371 39435.6800  83.0%     -  102s
     0     0 39435.6800    0  411 21552.8094 39435.6800  83.0%     -  102s
     0     0 39392.7612    0  408 21552.8094 39392.7612  82.8%     -  104s
     0     0 39369.6865    0  409 21552.8094 39369.6865  82.7%     -  105s
     0     0 39299.1259    0  402 21552.8094 39299.1259  82.3%     -  106s
H    0     0                    21586.513297 39212.0580  81.7%     -  107s
     0     0 39212.0580    0  432 21586.5133 39212.0580  81.7%     -  107s
     0     0 39195.7076    0  404 21586.5133 39195.7076  81.6%     -  108s
H    0     0                    21774.920058 39189.2179  80.0%     -  109s
H    0     0                    21877.707231 39189.2179  79.1%     -  109s
H    0     0                    21903.771017 39189.2179  78.9%     -  109s
H    0     0                    21920.014545 39189.2179  78.8%     -  109s
     0     0 39189.2179    0  393 21920.0145 39189.2179  78.8%     -  109s
     0     0 39184.0729    0  394 21920.0145 39184.0729  78.8%     -  109s
     0     0 39182.9762    0  403 21920.0145 39182.9762  78.8%     -  109s
     0     0 38728.5262    0  424 21920.0145 38728.5262  76.7%     -  119s
H    0     0                    22002.698660 38728.4489  76.0%     -  119s
H    0     0                    22035.151093 38728.4489  75.8%     -  119s
H    0     0                    22176.653836 38728.4489  74.6%     -  119s
H    0     0                    22190.300014 38728.4489  74.5%     -  119s
H    0     0                    22297.021385 38728.4489  73.7%     -  119s
     0     0 38570.4606    0  448 22297.0214 38570.4606  73.0%     -  123s
     0     0 38485.7939    0  452 22297.0214 38485.7939  72.6%     -  124s
     0     0 38447.6773    0  471 22297.0214 38447.6773  72.4%     -  126s
     0     0 38431.3626    0  456 22297.0214 38431.3626  72.4%     -  128s
     0     0 38426.9371    0  473 22297.0214 38426.9371  72.3%     -  128s
     0     0 38415.7940    0  414 22297.0214 38415.7940  72.3%     -  129s
     0     0 38383.3467    0  460 22297.0214 38383.3467  72.1%     -  130s
     0     0 38367.0726    0  472 22297.0214 38367.0726  72.1%     -  131s
     0     0 38362.7183    0  474 22297.0214 38362.7183  72.1%     -  131s
     0     0 38361.4187    0  481 22297.0214 38361.4187  72.0%     -  131s
     0     0 38203.3774    0  486 22297.0214 38203.3774  71.3%     -  136s
H    0     0                    22321.982585 38203.0070  71.1%     -  136s
H    0     0                    22424.195300 38203.0070  70.4%     -  136s
     0     0 38182.5185    0  474 22424.1953 38182.5185  70.3%     -  137s
     0     0 38178.8494    0  427 22424.1953 38178.8494  70.3%     -  137s
     0     0 38177.1816    0  469 22424.1953 38177.1816  70.2%     -  138s
     0     0 38174.5754    0  473 22424.1953 38174.5754  70.2%     -  138s
     0     0 38173.6470    0  476 22424.1953 38173.6470  70.2%     -  138s
     0     0 38148.6198    0  482 22424.1953 38148.6198  70.1%     -  140s
     0     0 38132.9150    0  489 22424.1953 38132.9150  70.1%     -  141s
     0     0 38128.1843    0  501 22424.1953 38128.1843  70.0%     -  142s
     0     0 38126.2136    0  497 22424.1953 38126.2136  70.0%     -  142s
     0     0 38125.2278    0  500 22424.1953 38125.2278  70.0%     -  142s
     0     0 38078.2905    0  490 22424.1953 38078.2905  69.8%     -  145s
     0     0 38066.1997    0  499 22424.1953 38066.1997  69.8%     -  147s
     0     0 38059.6417    0  442 22424.1953 38059.6417  69.7%     -  148s
     0     0 38053.5114    0  438 22424.1953 38053.5114  69.7%     -  148s
     0     0 38051.6651    0  441 22424.1953 38051.6651  69.7%     -  149s
     0     0 38051.4259    0  443 22424.1953 38051.4259  69.7%     -  149s
     0     0 38042.5357    0  439 22424.1953 38042.5357  69.6%     -  151s
     0     0 38039.9555    0  442 22424.1953 38039.9555  69.6%     -  151s
     0     0 38039.3078    0  440 22424.1953 38039.3078  69.6%     -  152s
     0     0 38019.4565    0  497 22424.1953 38019.4565  69.5%     -  154s
     0     0 38016.4573    0  445 22424.1953 38016.4573  69.5%     -  155s
     0     0 38015.4018    0  442 22424.1953 38015.4018  69.5%     -  155s
     0     0 38013.1140    0  437 22424.1953 38013.1140  69.5%     -  156s
     0     0 38012.5746    0  440 22424.1953 38012.5746  69.5%     -  156s
H    0     0                    22468.596924 38004.6071  69.1%     -  158s
H    0     0                    24749.448346 38004.6071  53.6%     -  158s
     0     0 38004.6071    0  431 24749.4483 38004.6071  53.6%     -  158s
H    0     0                    24857.498072 38004.4170  52.9%     -  158s
H    0     0                    24884.914607 38004.4170  52.7%     -  158s
H    0     0                    25024.472890 38004.4170  51.9%     -  158s
H    0     0                    25093.769973 38004.4170  51.4%     -  158s
H    0     0                    25112.972267 38004.4170  51.3%     -  158s
     0     0 38002.1710    0  444 25112.9723 38002.1710  51.3%     -  159s
     0     0 38001.1278    0  449 25112.9723 38001.1278  51.3%     -  159s
     0     0 37996.5049    0  505 25112.9723 37996.5049  51.3%     -  161s
     0     0 37994.4383    0  510 25112.9723 37994.4383  51.3%     -  162s
     0     0 37993.0611    0  454 25112.9723 37993.0611  51.3%     -  163s
     0     0 37986.0166    0  504 25112.9723 37986.0166  51.3%     -  164s
     0     0 37985.4532    0  504 25112.9723 37985.4532  51.3%     -  165s
H    0     0                    25138.304779 37985.4532  51.1%     -  188s
H    0     0                    25184.405041 37985.4532  50.8%     -  188s
H    0     0                    25717.522859 37985.4532  47.7%     -  188s
H    0     2                    25737.975236 37985.4532  47.6%     -  188s
     0     2 37985.4532    0  504 25737.9752 37985.4532  47.6%     -  188s
     1     4 37893.1467    1  484 25737.9752 37984.9696  47.6%  2831  190s
     3     8 37801.3131    2  437 25737.9752 37894.5051  47.2%  2703  196s
     7    16 37755.2357    3  479 25737.9752 37835.4055  47.0%  3745  209s
    15    32 37679.0126    4  437 25737.9752 37755.0767  46.7%  6278  218s
    31    48 36199.2199    5  425 25737.9752 37678.9145  46.4%  8762  238s
    47    80 35135.4117    6  420 25737.9752 37678.9145  46.4%  8312  246s
H   49    80                    25784.822990 37678.9145  46.1%  8052  246s
    79   144 34747.4002    7  419 25784.8230 37678.9145  46.1%  6493  268s
   143   271 34593.6701    9  393 25784.8230 37678.9145  46.1%  4746  277s
   270   342 34163.4515   11  437 25784.8230 37678.9145  46.1%  3631  285s
   345   399 33345.3582   10  387 25784.8230 37678.9145  46.1%  3433  292s
   402   465 33922.5895   10  372 25784.8230 37678.9145  46.1%  3358  299s
   468   501 34004.9538   12  434 25784.8230 37678.9145  46.1%  3363  306s
   504   548 32579.5291   12  415 25784.8230 37678.9145  46.1%  3345  312s
   565   586 33525.0821   12  373 25784.8230 37678.9145  46.1%  3335  319s
   623   617 33112.1905   11  378 25784.8230 37678.9145  46.1%  3304  328s
   694   642 32991.0149   13  363 25784.8230 37678.9145  46.1%  3240  336s
   759   669 31865.7114   12  405 25784.8230 37678.9145  46.1%  3182  344s
   842   688 31695.8169   13  449 25784.8230 37678.9145  46.1%  3080  351s
   897   731 32559.8517   13  403 25784.8230 37678.9145  46.1%  3040  360s
   959   751 30284.6032   13  419 25784.8230 37678.9145  46.1%  3033  369s
  1009   778 32253.2724   14  403 25784.8230 37678.9145  46.1%  3039  377s
  1055   811 31984.4923   15  363 25784.8230 37678.9145  46.1%  3041  386s
  1112   859 29520.4625   16  345 25784.8230 37678.9145  46.1%  3032  395s
  1190   934 28744.9676   16  374 25784.8230 37678.9145  46.1%  2998  405s
  1287   986 29629.8315   15  356 25784.8230 37678.9145  46.1%  2915  414s
  1390  1040 29445.2141   16  339 25784.8230 37678.9145  46.1%  2862  424s
  1496  1053 28718.6644   19  332 25784.8230 37678.9145  46.1%  2807  436s
  1542  1073 infeasible   19      25784.8230 37678.9145  46.1%  2821  456s
  1592  1103 27980.9418   21  317 25784.8230 37480.2426  45.4%  2876  469s
  1646  1141 27910.5240   22  265 25784.8230 37480.2426  45.4%  2914  479s
  1722  1184 27582.2147   23  308 25784.8230 37146.2303  44.1%  2901  489s
  1793  1207 27578.9015   24  301 25784.8230 37146.2303  44.1%  2911  498s
  1833  1237 27564.1641   25  266 25784.8230 37146.2303  44.1%  2920  507s
  1873  1277 27292.0524   26  273 25784.8230 37146.2303  44.1%  2930  518s
  1943  1317     cutoff   27      25784.8230 37146.2303  44.1%  2902  526s
  2025  1370     cutoff   27      25784.8230 37146.2303  44.1%  2898  539s
  2125  1427 33570.8076   13  414 25784.8230 37146.2303  44.1%  2879  551s
  2218  1488 32638.4335   14  406 25784.8230 37146.2303  44.1%  2866  563s
  2324  1564 29413.0475   15  404 25784.8230 37146.2303  44.1%  2838  575s
  2460  1622 27026.7285   16  401 25784.8230 37146.2303  44.1%  2797  587s
  2579  1668     cutoff   17      25784.8230 35712.0643  38.5%  2764  604s
  2714  1728 26230.5376   17  306 25784.8230 35712.0643  38.5%  2729  618s
  2834  1799 26045.2739   18  297 25784.8230 35575.7529  38.0%  2716  632s
  2987  1898     cutoff   19      25784.8230 35535.4275  37.8%  2693  645s
  3197  1956 32636.4612    9  330 25784.8230 35535.4275  37.8%  2633  660s
  3377  2016 31795.8494   10  325 25784.8230 35467.7161  37.6%  2606  674s
  3526  2153 31767.9425   11  270 25784.8230 35460.3990  37.5%  2597  691s
  3725  2263 30162.8372   12  276 25784.8230 35460.3990  37.5%  2567  707s
  3895  2350 29455.0113   13  203 25784.8230 35342.6781  37.1%  2535  724s
  4114  2417 29087.3236   14  184 25784.8230 35159.0023  36.4%  2520  741s
  4304  2569 27985.4892   16  192 25784.8230 35120.2239  36.2%  2527  758s
  4545  2570 32266.0897    9  504 25784.8230 35120.2239  36.2%  2523  800s
  4547  2571 29441.0521   24  196 25784.8230 35120.2239  36.2%  2522  839s
  4548  2572 27840.0214   39  393 25784.8230 35120.2239  36.2%  2521  869s
  4549  2573 31917.4492   11  393 25784.8230 35120.2239  36.2%  2520  881s
  4550  2573 27412.9437   10  407 25784.8230 35120.2239  36.2%  2520  889s
  4551  2574 28782.9762   24  456 25784.8230 35120.2239  36.2%  2519  897s
  4552  2575 25929.3643   41  458 25784.8230 35120.2239  36.2%  2519  902s
  4553  2575 28840.9582   33  438 25784.8230 35120.2239  36.2%  2518  905s
  4555  2577 27891.8568   25  493 25784.8230 35120.2239  36.2%  2517  911s
  4557  2578 29297.9754   14  516 25784.8230 35120.2239  36.2%  2516  915s
  4559  2579 33769.8426    8  461 25784.8230 35120.2239  36.2%  2515  922s
  4561  2581 26584.9720   25  517 25784.8230 35120.2239  36.2%  2514  927s
  4562  2581 29451.0144   20  470 25784.8230 35120.2239  36.2%  2513  933s
  4563  2582 31801.5918   12  468 25784.8230 35120.2239  36.2%  2513  937s
  4564  2583 27212.3176   21  520 25784.8230 35120.2239  36.2%  2512  940s
  4565  2583 26418.0525   32  510 25784.8230 35120.2239  36.2%  2512  947s
  4566  2584 31200.6006   14  510 25784.8230 35120.2239  36.2%  2511  950s
  4568  2585 28289.0916   23  518 25784.8230 35120.2239  36.2%  2510  956s
  4569  2586 31715.1881   20  521 25784.8230 35120.2239  36.2%  2509  961s
  4570  2587 27428.5053   14  520 25784.8230 35120.2239  36.2%  2509  965s
  4572  2588 30485.3559   17  522 25784.8230 35120.2239  36.2%  2508  971s
  4573  2589 26691.6627   45  520 25784.8230 35120.2239  36.2%  2507  976s
  4575  2590 30081.0073   25  482 25784.8230 35120.2239  36.2%  2506  983s
  4576  2591 26924.5487   31  482 25784.8230 35120.2239  36.2%  2506 1012s
  4577  2591 34408.2742   12  482 25784.8230 35120.2239  36.2%  2505 1030s
  4578  2595 35120.2239   10  514 25784.8230 35120.2239  36.2%  2555 1056s
  4580  2598 35120.2239   11  504 25784.8230 35120.2239  36.2%  2559 1067s
  4584  2605 35120.2239   12  459 25784.8230 35120.2239  36.2%  2560 1083s
  4592  2618 35120.2239   13  458 25784.8230 35120.2239  36.2%  2568 1095s
  4608  2630 32761.6354   14  359 25784.8230 35120.2239  36.2%  2615 1124s
  4625  2656 34231.2622   15  419 25784.8230 35120.2239  36.2%  2635 1146s
  4657  2677 29633.0620   16  384 25784.8230 35120.2239  36.2%  2701 1166s
  4688  2704 29508.2384   17  405 25784.8230 35120.2239  36.2%  2777 1179s
  4728  2712 29394.4087   18  414 25784.8230 35120.2239  36.2%  2799 1197s
  4778  2731 28999.4457   19  395 25784.8230 35120.2239  36.2%  2823 1215s
  4852  2728 28197.1914   19  361 25784.8230 35120.2239  36.2%  2844 1232s
  4945  2694     cutoff   20      25784.8230 35120.2239  36.2%  2853 1246s
  5007  2672 infeasible   19      25784.8230 35120.2239  36.2%  2865 1261s
  5081  2664 31982.6611   15  373 25784.8230 35120.2239  36.2%  2882 1274s
  5151  2673 31824.7347   16  368 25784.8230 35120.2239  36.2%  2897 1291s
  5227  2688 30699.0898   18  329 25784.8230 35120.2239  36.2%  2900 1306s
  5303  2690 28847.5806   20  337 25784.8230 35120.2239  36.2%  2916 1318s
  5376  2689     cutoff   21      25784.8230 35120.2239  36.2%  2922 1325s
  5413  2708 29125.6291   20  257 25784.8230 35120.2239  36.2%  2928 1337s
  5475  2722 28643.1242   23  232 25784.8230 35120.2239  36.2%  2930 1348s
  5556  2717     cutoff   25      25784.8230 35120.2239  36.2%  2932 1358s
  5650  2705 26512.2822   26  222 25784.8230 35120.2239  36.2%  2934 1370s
  5709  2712 26199.1609   28  302 25784.8230 35120.2239  36.2%  2934 1382s
  5799  2703 25869.3544   32  230 25784.8230 34784.5724  34.9%  2934 1395s
  5903  2703 28179.4551   23  269 25784.8230 33472.7065  29.8%  2932 1407s
  5988  2695 27822.4812   25  279 25784.8230 33472.7065  29.8%  2944 1422s
  6079  2698 27220.9276   27  272 25784.8230 33472.7065  29.8%  2945 1435s
  6188  2678 26609.5586   29  273 25784.8230 33233.4771  28.9%  2951 1450s
  6317  2667 26196.0884   29  223 25784.8230 32818.5548  27.3%  2956 1464s
  6444  2633     cutoff   31      25784.8230 32818.5548  27.3%  2964 1480s
  6577  2611 26498.3254   19  305 25784.8230 32818.5548  27.3%  2970 1499s
  6740  2588 26469.9833   20  201 25784.8230 32818.5548  27.3%  2961 1514s
  6836  2583     cutoff   23      25784.8230 31812.5802  23.4%  2966 1529s
  6974  2566 27578.5881   17  371 25784.8230 31381.9031  21.7%  2967 1547s
  7125  2541 26079.5064   20  342 25784.8230 31095.4190  20.6%  2968 1566s
  7323  2485 27455.2314   17  340 25784.8230 30916.8405  19.9%  2959 1585s
  7511  2428     cutoff   19      25784.8230 30600.0458  18.7%  2961 1604s
  7696  2407     cutoff   17      25784.8230 30208.3343  17.2%  2957 1626s
  7938  2323 26684.5221   24  243 25784.8230 30208.3343  17.2%  2944 1645s
  8095  2293 26601.8222   28  166 25784.8230 29968.9446  16.2%  2943 1666s
  8319  2234 28313.1806   22  261 25784.8230 29931.3162  16.1%  2939 1690s
  8577  2130     cutoff   25      25784.8230 29671.6155  15.1%  2923 1711s
  8855  2042 infeasible   30      25784.8230 29278.6961  13.6%  2913 1733s
  9047  1953     cutoff   24      25784.8230 29061.6192  12.7%  2912 1755s
  9309  1882     cutoff   25      25784.8230 29037.1400  12.6%  2906 1778s
  9583  1760     cutoff   23      25784.8230 28714.5256  11.4%  2896 1802s
  9880  1630     cutoff   27      25784.8230 28572.7584  10.8%  2892 1828s
 10253  1467     cutoff   22      25784.8230 28179.1018  9.29%  2876 1855s
 10782  1136 26580.3170   34  189 25784.8230 27976.6680  8.50%  2828 1880s
 11281   683     cutoff   26      25784.8230 27631.9953  7.16%  2796 1901s
 12041   164     cutoff   27      25784.8230 27190.0398  5.45%  2702 1914s
 12808    24     cutoff   34      25784.8230 26110.6857  1.26%  2578 1917s
 13330     3     cutoff   66      25784.8230 25932.2027  0.57%  2481 1932s
 13366     0     cutoff   44      25784.8230 25808.0841  0.09%  2474 1937s

Cutting planes:
  Learned: 1
  MIR: 483
  Flow cover: 1287
  Zero half: 1
  RLT: 23
  Relax-and-lift: 126

Explored 13379 nodes (33283031 simplex iterations) in 1937.36 seconds (5624.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25784.8 25738 25717.5 ... 24857.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.578482299012e+04, best bound 2.578482299012e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1937.37s
  Master Objective (UB) = 25784.82, θ = 172417.91
  Upper Bound (UB) = 25784.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172417.91
  [DEBUG]   ✓ Scenario 0: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172417.91 ≤ Q = 172417.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172417.91 ≤ Q = 172417.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5d7eec8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x05d7eec8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.332576e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6135507.8389
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.550233e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155023.35    0  127 6135507.84 -155023.35   103%     -    0s
H    0     0                    -119820.4493 -155023.35  29.4%     -    0s
H    0     0                    -120873.0325 -155023.35  28.3%     -    0s
H    0     0                    -130144.6766 -155023.35  19.1%     -    0s
H    0     0                    -130345.4539 -140025.39  7.43%     -    0s
H    0     0                    -136602.0149 -140025.39  2.51%     -    0s
     0     0 -140025.39    0   97 -136602.01 -140025.39  2.51%     -    0s
     0     0 -139727.22    0  101 -136602.01 -139727.22  2.29%     -    0s
     0     0 -138699.95    0  102 -136602.01 -138699.95  1.54%     -    0s
H    0     0                    -137747.5181 -138631.48  0.64%     -    0s
     0     0 -138631.48    0  102 -137747.52 -138631.48  0.64%     -    0s
     0     0 -138127.96    0   54 -137747.52 -138127.96  0.28%     -    0s
     0     0 -138115.71    0   45 -137747.52 -138115.71  0.27%     -    0s
     0     0 -138107.18    0   43 -137747.52 -138107.18  0.26%     -    0s
     0     0 -138021.40    0   43 -137747.52 -138021.40  0.20%     -    0s
     0     0 -137992.86    0   29 -137747.52 -137992.86  0.18%     -    0s
     0     0 -137977.28    0   22 -137747.52 -137977.28  0.17%     -    0s
     0     0 -137977.01    0   22 -137747.52 -137977.01  0.17%     -    0s
     0     0 -137884.66    0   13 -137747.52 -137884.66  0.10%     -    0s
     0     0 -137884.66    0   18 -137747.52 -137884.66  0.10%     -    0s
     0     0 -137769.91    0    5 -137747.52 -137769.91  0.02%     -    0s
     0     0 -137768.02    0    4 -137747.52 -137768.02  0.01%     -    0s
H    0     0                    -137768.0212 -137768.02  0.00%     -    0s
     0     0 -137768.02    0    4 -137768.02 -137768.02  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 3
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (769 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -137768 -137748 -136807 ... 6.13551e+06
No other solutions better than -137768

Optimal solution found (tolerance 1.00e-04)
Best objective -1.377680211852e+05, best bound -1.377680211852e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 157860.78
  Scenario: 46 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137768.02
  [DEBUG]   S×d_nominal = 295628.80
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 295628.80 + -137768.02 = 157860.78
  [DEBUG]   Current θ from Master = 172417.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14557.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11227.69
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2006.3455, Absolute Gap = 2006.3455, Relative Gap = 0.077811
  Not converged yet (gap = 2006.35 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 13 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351319 nonzeros
Model fingerprint: 0x77310be0
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 58276 rows and 23666 columns
Presolve time: 1.14s
Presolved: 65427 rows, 28514 columns, 407139 nonzeros
Variable types: 26255 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 65427 rows, 28514 columns, 407139 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31274   -4.3714230e+04   0.000000e+00   1.234993e+08      5s
   43691   -3.2022379e+02   0.000000e+00   1.287788e+07     10s
   53846    3.4592107e+03   0.000000e+00   4.595970e+06     15s
   64071    1.4900383e+04   0.000000e+00   5.870831e+06     20s
   74309    2.2530969e+04   0.000000e+00   1.798779e+07     25s
   83677    2.7828826e+04   0.000000e+00   8.979108e+07     30s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 4.958655e+04, 53965 iterations, 30.11 seconds (59.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49586.5488    0  193 -207405.59 49586.5488   124%     -   31s
H    0     0                    -203514.6892 49586.5488   124%     -   31s
H    0     0                    -70676.71633 49586.5488   170%     -   32s
H    0     0                    -60169.81849 49586.5488   182%     -   32s
H    0     0                    -60067.55604 49586.5488   183%     -   32s
H    0     0                    -14238.02486 49586.5488   448%     -   32s
H    0     0                    -12335.52663 49586.5488   502%     -   33s
H    0     0                    -9725.672712 49586.5488   610%     -   33s
H    0     0                    -9703.502137 49586.5488   611%     -   33s
H    0     0                    -9593.259781 49586.5488   617%     -   33s
H    0     0                    4433.6730834 45672.1795   930%     -   43s
H    0     0                    4686.3909841 45672.1795   875%     -   43s
H    0     0                    5123.9280458 45672.1795   791%     -   43s
     0     0 45672.1795    0  261 5123.92805 45672.1795   791%     -   43s
H    0     0                    5366.4005307 45661.5004   751%     -   44s
     0     0 44957.1346    0  256 5366.40053 44957.1346   738%     -   48s
     0     0 44957.1346    0  268 5366.40053 44957.1346   738%     -   49s
     0     0 44957.1346    0  265 5366.40053 44957.1346   738%     -   49s
     0     0 44957.1346    0  264 5366.40053 44957.1346   738%     -   53s
     0     0 44957.1346    0  271 5366.40053 44957.1346   738%     -   53s
     0     0 44957.1346    0  269 5366.40053 44957.1346   738%     -   54s
     0     0 44957.1346    0  268 5366.40053 44957.1346   738%     -   54s
     0     0 44957.1346    0  268 5366.40053 44957.1346   738%     -   54s
     0     0 44957.1346    0  266 5366.40053 44957.1346   738%     -   54s
H    0     0                    10239.545685 42306.1239   313%     -   66s
H    0     0                    10327.476279 42306.1239   310%     -   66s
H    0     0                    10394.274452 42306.1239   307%     -   66s
     0     0 42214.4263    0  274 10394.2745 42214.4263   306%     -   66s
H    0     0                    14676.157767 42214.4263   188%     -   66s
H    0     0                    14802.857181 42214.4263   185%     -   67s
H    0     0                    15006.866064 42214.4263   181%     -   67s
H    0     0                    15293.895610 42214.4263   176%     -   67s
H    0     0                    15318.177339 42214.4263   176%     -   67s
     0     0 41596.0908    0  311 15318.1773 41596.0908   172%     -   73s
     0     0 41463.5894    0  310 15318.1773 41463.5894   171%     -   76s
     0     0 41353.5977    0  344 15318.1773 41353.5977   170%     -   79s
     0     0 41319.9235    0  347 15318.1773 41319.9235   170%     -   81s
     0     0 41278.2117    0  343 15318.1773 41278.2117   169%     -   83s
     0     0 41274.2833    0  315 15318.1773 41274.2833   169%     -   84s
     0     0 41272.5722    0  347 15318.1773 41272.5722   169%     -   84s
     0     0 41271.5300    0  315 15318.1773 41271.5300   169%     -   85s
     0     0 41270.8652    0  353 15318.1773 41270.8652   169%     -   85s
H    0     0                    15337.833175 41270.8652   169%     -   91s
H    0     0                    15437.661032 41270.8652   167%     -   91s
H    0     0                    15596.284187 41270.8652   165%     -   91s
H    0     0                    15924.991495 41270.8652   159%     -   91s
H    0     0                    16166.577262 39872.9684   147%     -  102s
H    0     0                    16210.049458 39872.9684   146%     -  102s
H    0     0                    16573.911583 39872.9684   141%     -  102s
     0     0 39872.9684    0  359 16573.9116 39872.9684   141%     -  102s
H    0     0                    16721.925473 39872.0551   138%     -  102s
H    0     0                    16914.197632 39872.0551   136%     -  102s
H    0     0                    16987.795187 39872.0551   135%     -  102s
H    0     0                    17043.537900 39872.0551   134%     -  102s
H    0     0                    17228.180885 39872.0551   131%     -  102s
H    0     0                    17287.528801 39872.0551   131%     -  102s
     0     0 39257.4377    0  369 17287.5288 39257.4377   127%     -  109s
     0     0 39115.0910    0  365 17287.5288 39115.0910   126%     -  112s
     0     0 39057.2031    0  372 17287.5288 39057.2031   126%     -  114s
H    0     0                    17592.596085 39020.4653   122%     -  116s
H    0     0                    17691.646021 39020.4653   121%     -  116s
H    0     0                    17719.151584 39020.4653   120%     -  116s
H    0     0                    17817.356833 39020.4653   119%     -  116s
H    0     0                    17830.853696 39020.4653   119%     -  116s
H    0     0                    17895.345834 39020.4653   118%     -  116s
     0     0 39020.4653    0  371 17895.3458 39020.4653   118%     -  116s
H    0     0                    19493.655595 38994.9438   100%     -  118s
H    0     0                    19561.395394 38994.9438  99.3%     -  118s
H    0     0                    20801.196515 38994.9438  87.5%     -  118s
     0     0 38994.9438    0  383 20801.1965 38994.9438  87.5%     -  118s
     0     0 38943.7796    0  380 20801.1965 38943.7796  87.2%     -  119s
     0     0 38917.0990    0  373 20801.1965 38917.0990  87.1%     -  120s
     0     0 38910.9143    0  380 20801.1965 38910.9143  87.1%     -  121s
     0     0 38899.9858    0  373 20801.1965 38899.9858  87.0%     -  123s
     0     0 38896.8693    0  392 20801.1965 38896.8693  87.0%     -  124s
     0     0 38883.9614    0  387 20801.1965 38883.9614  86.9%     -  126s
     0     0 38875.3778    0  384 20801.1965 38875.3778  86.9%     -  127s
     0     0 38874.1875    0  386 20801.1965 38874.1875  86.9%     -  128s
     0     0 38872.9947    0  388 20801.1965 38872.9947  86.9%     -  129s
     0     0 38872.4799    0  386 20801.1965 38872.4799  86.9%     -  129s
     0     0 38430.3535    0  411 20801.1965 38430.3535  84.8%     -  139s
H    0     0                    20879.298391 38427.7290  84.0%     -  140s
H    0     0                    20934.401318 38248.9390  82.7%     -  145s
H    0     0                    21340.805503 38248.9390  79.2%     -  145s
H    0     0                    21394.609431 38248.9390  78.8%     -  145s
H    0     0                    21425.059610 38248.9390  78.5%     -  145s
H    0     0                    21440.674424 38248.9390  78.4%     -  145s
     0     0 38248.9390    0  451 21440.6744 38248.9390  78.4%     -  145s
     0     0 38196.0941    0  453 21440.6744 38196.0941  78.1%     -  147s
     0     0 38177.8858    0  451 21440.6744 38177.8858  78.1%     -  148s
     0     0 38168.5018    0  457 21440.6744 38168.5018  78.0%     -  149s
     0     0 38156.7777    0  456 21440.6744 38156.7777  78.0%     -  151s
H    0     0                    21537.487848 38144.6721  77.1%     -  152s
     0     0 38144.6721    0  451 21537.4878 38144.6721  77.1%     -  152s
     0     0 38140.7812    0  455 21537.4878 38140.7812  77.1%     -  153s
     0     0 38138.2482    0  454 21537.4878 38138.2482  77.1%     -  153s
     0     0 38134.5873    0  453 21537.4878 38134.5873  77.1%     -  153s
     0     0 38133.7511    0  455 21537.4878 38133.7511  77.1%     -  154s
     0     0 38058.4474    0  464 21537.4878 38058.4474  76.7%     -  157s
H    0     0                    21656.553822 38055.8300  75.7%     -  157s
     0     0 38031.7712    0  463 21656.5538 38031.7712  75.6%     -  159s
     0     0 38022.2678    0  469 21656.5538 38022.2678  75.6%     -  160s
     0     0 38021.3320    0  467 21656.5538 38021.3320  75.6%     -  161s
     0     0 37975.7260    0  477 21656.5538 37975.7260  75.4%     -  164s
H    0     0                    21695.012616 37973.0814  75.0%     -  165s
     0     0 37965.8635    0  477 21695.0126 37965.8635  75.0%     -  167s
     0     0 37959.8919    0  481 21695.0126 37959.8919  75.0%     -  167s
     0     0 37956.1956    0  479 21695.0126 37956.1956  75.0%     -  168s
     0     0 37954.2442    0  482 21695.0126 37954.2442  74.9%     -  168s
     0     0 37953.9637    0  482 21695.0126 37953.9637  74.9%     -  168s
     0     0 37939.2148    0  488 21695.0126 37939.2148  74.9%     -  170s
H    0     0                    21702.579860 37937.9367  74.8%     -  171s
H    0     0                    21789.399460 37937.9367  74.1%     -  171s
H    0     0                    21832.809263 37937.9367  73.8%     -  171s
     0     0 37933.8845    0  492 21832.8093 37933.8845  73.7%     -  172s
     0     0 37932.5130    0  494 21832.8093 37932.5130  73.7%     -  172s
     0     0 37928.1701    0  522 21832.8093 37928.1701  73.7%     -  174s
     0     0 37926.2167    0  530 21832.8093 37926.2167  73.7%     -  176s
     0     0 37925.4251    0  525 21832.8093 37925.4251  73.7%     -  177s
H    0     0                    22073.471991 37912.5941  71.8%     -  179s
     0     0 37912.5941    0  523 22073.4720 37912.5941  71.8%     -  179s
H    0     0                    22728.426957 37911.3963  66.8%     -  180s
H    0     0                    22787.435596 37911.3963  66.4%     -  180s
     0     0 37909.9729    0  527 22787.4356 37909.9729  66.4%     -  181s
     0     0 37909.2506    0  530 22787.4356 37909.2506  66.4%     -  182s
     0     0 37900.6146    0  529 22787.4356 37900.6146  66.3%     -  183s
H    0     0                    23181.460972 37900.6092  63.5%     -  184s
H    0     0                    23201.253538 37900.6092  63.4%     -  185s
     0     0 37898.0886    0  533 23201.2535 37898.0886  63.3%     -  185s
     0     0 37897.2560    0  533 23201.2535 37897.2560  63.3%     -  186s
     0     0 37879.5933    0  538 23201.2535 37879.5933  63.3%     -  188s
H    0     0                    23319.390356 37879.5864  62.4%     -  189s
H    0     0                    23504.400279 37879.5864  61.2%     -  189s
     0     0 37874.3661    0  511 23504.4003 37874.3661  61.1%     -  189s
     0     0 37873.6617    0  510 23504.4003 37873.6617  61.1%     -  190s
     0     0 37858.9907    0  454 23504.4003 37858.9907  61.1%     -  191s
H    0     0                    23549.358608 37858.9713  60.8%     -  196s
H    0     0                    23657.017455 37858.9713  60.0%     -  196s
     0     0 37855.5818    0  540 23657.0175 37855.5818  60.0%     -  197s
     0     0 37855.3305    0  537 23657.0175 37855.3305  60.0%     -  198s
     0     0 37849.5952    0  492 23657.0175 37849.5952  60.0%     -  200s
     0     0 37849.0150    0  492 23657.0175 37849.0150  60.0%     -  201s
     0     0 37847.4953    0  544 23657.0175 37847.4953  60.0%     -  202s
     0     0 37846.7437    0  541 23657.0175 37846.7437  60.0%     -  203s
     0     0 37841.8842    0  540 23657.0175 37841.8842  60.0%     -  204s
     0     0 37841.8720    0  540 23657.0175 37841.8720  60.0%     -  205s
H    0     0                    23734.281164 37841.8692  59.4%     -  239s
     0     2 37841.8692    0  540 23734.2812 37841.8692  59.4%     -  240s
     1     3 36346.4656    1  407 23734.2812 37841.8488  59.4% 10402  248s
     2     6 35374.6646    2  340 23734.2812 37841.8488  59.4%  8752  253s
     5    12 34405.6262    3  346 23734.2812 37696.3383  58.8%  6072  262s
    11    24 33890.0404    4  462 23734.2812 37679.2956  58.8%  7552  271s
    23    36 36471.0371    4  495 23734.2812 37386.0398  57.5% 10601  290s
    35    68 34811.5189    5  370 23734.2812 37386.0398  57.5% 10496  323s
H   38    68                    23839.504421 37386.0398  56.8% 10356  323s
H   49    68                    23972.798387 37386.0398  56.0%  9879  323s
H   55    68                    23997.981883 37386.0398  55.8%  9348  323s
    67   170 34802.7232    6  363 23997.9819 37160.0084  54.8% 12019  343s
   169   273 33089.8846    8  333 23997.9819 37159.9798  54.8%  6922  353s
   272   334 33044.1071   10  337 23997.9819 37159.9798  54.8%  5639  362s
   333   365 33005.9355   10  335 23997.9819 37159.9798  54.8%  5498  370s
   364   405 32380.7111   11  371 23997.9819 37159.9798  54.8%  5625  378s
   404   435 32056.0433   12  360 23997.9819 37159.9798  54.8%  5660  389s
   434   462 31990.5561   13  363 23997.9819 37159.9798  54.8%  5720  409s
   465   489 31291.0550   14  236 23997.9819 37159.9798  54.8%  5719  423s
   498   519 31027.8729   15  220 23997.9819 37159.9798  54.8%  5769  432s
   530   553 30939.5687   16  229 23997.9819 37159.9798  54.8%  5889  441s
   568   580 28623.0395   15  269 23997.9819 37159.9798  54.8%  5854  450s
   601   612 28525.4013   16  265 23997.9819 37159.9798  54.8%  5835  459s
   635   642 28106.9442   17  223 23997.9819 37159.9798  54.8%  5876  465s
   669   672 28384.3432   17  253 23997.9819 37159.9798  54.8%  5855  473s
   703   704 28493.9259   16  221 23997.9819 37159.9798  54.8%  5845  479s
   737   742 27714.1078   17  228 23997.9819 37159.9798  54.8%  5763  484s
   776   777 27906.0714   18  260 23997.9819 37159.9798  54.8%  5684  494s
   825   827 27537.9164   18  198 23997.9819 37159.9798  54.8%  5546  501s
   877   885 27802.3305   19  252 23997.9819 37159.9798  54.8%  5481  510s
   941   926 27790.0003   19  257 23997.9819 37159.9798  54.8%  5298  519s
  1002   961 27789.1413   20  210 23997.9819 36910.4558  53.8%  5185  529s
  1051  1002 27620.4906   21  208 23997.9819 36606.5728  52.5%  5138  539s
  1122  1023     cutoff   22      23997.9819 36606.5728  52.5%  5136  550s
  1157  1057 26270.7508   23  159 23997.9819 36495.3948  52.1%  5181  560s
  1193  1105 25501.0190   24  154 23997.9819 36495.3948  52.1%  5274  570s
  1253  1161 25933.9754   23  216 23997.9819 36495.3948  52.1%  5259  580s
  1321  1222     cutoff   25      23997.9819 36495.3948  52.1%  5235  592s
  1412  1266 26136.3341   25  158 23997.9819 36495.3948  52.1%  5181  606s
  1496  1335     cutoff   29      23997.9819 36495.3948  52.1%  5142  620s
  1591  1414 24856.3352   33  157 23997.9819 36495.3948  52.1%  5117  631s
  1706  1499 24709.8090   40  125 23997.9819 36234.6091  51.0%  5034  643s
  1825  1527 24585.4184   45  122 23997.9819 36157.8625  50.7%  4990  653s
  1860  1549 infeasible   46      23997.9819 36082.0273  50.4%  4993  666s
H 1889  1549                    24791.238599 36082.0273  45.5%  4983  666s
H 1898  1549                    25664.830938 36082.0273  40.6%  4991  666s
  1904  1608 33859.7680    6  387 25664.8309 36082.0273  40.6%  5004  682s
  2085  1696 32294.2060    8  326 25664.8309 35858.0262  39.7%  4924  697s
  2223  1768 31338.2369    9  313 25664.8309 35857.7981  39.7%  4974  714s
  2375  1842 31665.9668   11  372 25664.8309 35857.7981  39.7%  4973  729s
  2541  1845 30718.7277   13  297 25664.8309 35857.7981  39.7%  4987  746s
  2694  1933 30780.9139   14  295 25664.8309 35625.2715  38.8%  5012  762s
  2840  2079 30177.8214   20  243 25664.8309 35625.2715  38.8%  5027  778s
  3036  2168 29990.4737   20  265 25664.8309 35625.2715  38.8%  4978  795s
  3217  2250 29484.0598   32  103 25664.8309 35625.2715  38.8%  4958  815s
  3414  2365 29088.0193   35  100 25664.8309 35625.2715  38.8%  4968  834s
  3639  2453 28266.3593   41   87 25664.8309 34782.5636  35.5%  4951  853s
  3825  2539 28006.9955   47   75 25664.8309 34489.6575  34.4%  4985  873s
  4037  2639 27022.2787   48   74 25664.8309 34334.4718  33.8%  5008  896s
  4248  2768 26817.2606   53   80 25664.8309 34318.6784  33.7%  5033  916s
H 4479  2754                    25726.252995 34200.9992  32.9%  5034  945s
  4480  2755 32987.6508    8  540 25726.2530 34200.9992  32.9%  5033 1102s
  4482  2756 28951.7278   42  193 25726.2530 34200.9992  32.9%  5031 1124s
  4483  2757 26687.1160   20  335 25726.2530 34200.9992  32.9%  5030 1148s
  4484  2758 28240.5178   31  397 25726.2530 34200.9992  32.9%  5029 1163s
  4485  2758 31577.4638   12  455 25726.2530 34200.9992  32.9%  5028 1171s
  4486  2759 27504.4963   14  491 25726.2530 34200.9992  32.9%  5027 1179s
  4487  2760 27566.3736   29  489 25726.2530 34200.9992  32.9%  5025 1189s
  4488  2760 25973.4778   23  482 25726.2530 34200.9992  32.9%  5024 1192s
  4489  2761 27651.4969   24  487 25726.2530 34200.9992  32.9%  5023 1198s
  4490  2762 29506.0084   13  529 25726.2530 34200.9992  32.9%  5022 1201s
  4492  2763 27304.0135   29  498 25726.2530 34200.9992  32.9%  5020 1207s
  4494  2764 29878.8945   13  532 25726.2530 34200.9992  32.9%  5018 1213s
  4495  2765 29416.7518   31  486 25726.2530 34200.9992  32.9%  5016 1222s
  4496  2766 26103.5445   32  518 25726.2530 34200.9992  32.9%  5015 1225s
  4498  2767 27607.2364   25  472 25726.2530 34200.9992  32.9%  5013 1231s
  4499  2768 31803.4452    8  473 25726.2530 34200.9992  32.9%  5012 1237s
  4500  2768 29464.0811    8  488 25726.2530 34200.9992  32.9%  5011 1241s
  4501  2769 28945.6836   30  507 25726.2530 34200.9992  32.9%  5010 1248s
  4502  2770 30164.2473   12  509 25726.2530 34200.9992  32.9%  5009 1251s
  4504  2771 31637.1095   23  476 25726.2530 34200.9992  32.9%  5006 1258s
  4505  2772 27135.8399   22  493 25726.2530 34200.9992  32.9%  5005 1260s
  4506  2772 28342.6215   40  495 25726.2530 34200.9992  32.9%  5004 1270s
  4508  2774 26987.3774   27  494 25726.2530 34200.9992  32.9%  5002 1278s
  4509  2774 28117.5594   24  440 25726.2530 34200.9992  32.9%  5001 1281s
  4510  2775 29101.6417   34  441 25726.2530 34200.9992  32.9%  5000 1286s
  4512  2776 28847.6579   27  457 25726.2530 34200.9992  32.9%  4998 1290s
  4513  2777 33349.9547    8  466 25726.2530 34200.9992  32.9%  4996 1295s
  4514  2778 27517.3325   32  466 25726.2530 34200.9992  32.9%  4995 1317s
  4515  2778 25944.6477   32  466 25726.2530 34200.9992  32.9%  4994 1372s
  4516  2781 34200.9992   10  359 25726.2530 34200.9992  32.9%  5041 1380s
  4517  2784 34200.9992   11  341 25726.2530 34200.9992  32.9%  5041 1394s
  4520  2789 33599.9879   12  314 25726.2530 34200.9992  32.9%  5042 1407s
  4526  2799 33402.6134   13  382 25726.2530 34200.9992  32.9%  5048 1420s
  4538  2807 34200.9992   13  426 25726.2530 34200.9992  32.9%  5072 1446s
  4550  2834 31743.8668   14  351 25726.2530 34200.9992  32.9%  5099 1474s
  4581  2861 34200.9992   14  411 25726.2530 34200.9992  32.9%  5143 1494s
  4619  2889 33073.7565   15  415 25726.2530 34200.9992  32.9%  5221 1511s
  4659  2912 33669.2267   17  388 25726.2530 34200.9992  32.9%  5224 1529s
  4698  2925 31964.0093   18  370 25726.2530 34200.9992  32.9%  5251 1547s
  4740  2925 31380.7643   19  376 25726.2530 34200.9992  32.9%  5273 1563s
  4798  2924 31324.3258   20  331 25726.2530 34200.9992  32.9%  5322 1591s
  4859  2922 30935.3055   21  293 25726.2530 34200.9992  32.9%  5355 1607s
  4918  2933 30679.8818   22  273 25726.2530 34200.9992  32.9%  5411 1621s
  4966  2938 30515.2358   24  217 25726.2530 34200.9992  32.9%  5434 1635s
  5021  2949 29720.6341   25  209 25726.2530 34200.9992  32.9%  5454 1648s
  5070  2957 29482.1497   27  136 25726.2530 34200.9992  32.9%  5466 1664s
  5126  2961 28376.5781   29  187 25726.2530 34200.9992  32.9%  5462 1676s
  5187  2969 28892.4800   31  248 25726.2530 34200.9992  32.9%  5460 1687s
  5243  2985 28851.3222   33  208 25726.2530 33535.4318  30.4%  5455 1700s
  5302  2977 28115.7708   35  160 25726.2530 33535.4318  30.4%  5442 1713s
  5367  2973 26801.3224   36  163 25726.2530 33535.4318  30.4%  5433 1728s
  5425  2972     cutoff   37      25726.2530 33535.4318  30.4%  5429 1741s
  5499  2989 27613.5071   19  361 25726.2530 33535.4318  30.4%  5437 1754s
  5572  2991 27364.3277   20  343 25726.2530 33535.4318  30.4%  5437 1769s
  5637  2988 27260.6624   21  336 25726.2530 33162.7385  28.9%  5421 1784s
  5727  2976 26141.0407   24  236 25726.2530 32487.3433  26.3%  5399 1800s
  5806  2982     cutoff   25      25726.2530 32487.3433  26.3%  5403 1816s
  5887  2986 26940.1404   29  174 25726.2530 32226.0114  25.3%  5393 1832s
  5982  2976 26263.0369   37  202 25726.2530 32226.0114  25.3%  5388 1850s
  6096  2963 28847.8508   18  251 25726.2530 32226.0114  25.3%  5369 1865s
  6170  2952 27377.9464   19  278 25726.2530 31795.8306  23.6%  5366 1882s
  6296  2905 27097.2713   20  233 25726.2530 31587.1449  22.8%  5345 1902s
  6440  2879 26385.3652   25  110 25726.2530 31541.3420  22.6%  5328 1924s
  6563  2850     cutoff   28      25726.2530 31541.3420  22.6%  5335 1947s
  6699  2813 29755.8342   22  405 25726.2530 31541.3420  22.6%  5332 1968s
  6822  2800 29155.7981   23  328 25726.2530 31541.3420  22.6%  5329 1990s
  6955  2789 27283.6644   24  211 25726.2530 31541.3420  22.6%  5337 2010s
  7120  2774 26764.0480   28  238 25726.2530 31541.3420  22.6%  5338 2032s
  7328  2715     cutoff   31      25726.2530 30331.9389  17.9%  5316 2058s
  7581  2637 27111.2265   19  266 25726.2530 30331.9389  17.9%  5275 2075s
  7633  2628 25915.7400   20  208 25726.2530 30331.9389  17.9%  5281 2092s
  7700  2624 25760.5141   21  157 25726.2530 29894.3053  16.2%  5273 2116s
  7822  2593 26226.4523   21  300 25726.2530 29894.3053  16.2%  5265 2141s
  8010  2567 26302.4520   24  316 25726.2530 29894.3053  16.2%  5258 2167s
  8277  2523 27343.4553   25  243 25726.2530 29894.3053  16.2%  5223 2193s
  8539  2498 26637.9009   25  255 25726.2530 29168.3830  13.4%  5207 2220s
  8867  2403     cutoff   21      25726.2530 29068.3941  13.0%  5162 2249s
  9216  2318 26190.7008   31  195 25726.2530 28800.5639  12.0%  5129 2277s
  9620  2188 26378.3811   25  235 25726.2530 28574.2332  11.1%  5073 2304s
 10039  2059 27318.4410   22  322 25726.2530 28352.4221  10.2%  5019 2332s
 10509  1901 25875.0776   33  176 25726.2530 27959.0682  8.68%  4954 2361s
 11094  1774 26883.4360   26   85 25726.2530 27674.2755  7.57%  4853 2391s
 11744  1527 26655.1881   30  187 25726.2530 27491.3709  6.86%  4740 2421s
 12429  1228 26041.1317   33  135 25726.2530 27285.8036  6.06%  4631 2447s
 13273   931 26312.0673   28  179 25726.2530 27086.7506  5.29%  4491 2476s
 14132   749     cutoff   30      25726.2530 26935.6409  4.70%  4364 2502s
 15165   228 26015.5470   23  272 25726.2530 26674.2037  3.68%  4205 2528s
 16593     0     cutoff   36      25726.2530 26399.8644  2.62%  3966 2537s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 454
  Mixing: 5
  Flow cover: 1341
  RLT: 21
  Relax-and-lift: 123

Explored 17062 nodes (66494282 simplex iterations) in 2537.96 seconds (8005.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25726.3 25664.8 24791.2 ... 23319.4

Optimal solution found (tolerance 1.00e-04)
Best objective 2.572625299460e+04, best bound 2.572625299460e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2537.98s
  Master Objective (UB) = 25726.25, θ = 173475.85
  Upper Bound (UB) = 25726.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173475.85
  [DEBUG]   ✓ Scenario 0: θ = 173475.85 ≤ Q = 173475.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173475.85 ≤ Q = 173475.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173475.85 ≤ Q = 173475.85 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3239e23c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcdc61dc4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.340139e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6192626.4549
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.574125e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157412.46    0  127 6192626.45 -157412.46   103%     -    0s
H    0     0                    -122089.8789 -157412.46  28.9%     -    0s
H    0     0                    -123094.6341 -157412.46  27.9%     -    0s
H    0     0                    -129020.7617 -157412.46  22.0%     -    0s
H    0     0                    -137172.3230 -157412.46  14.8%     -    0s
     0     0 -141354.47    0   87 -137172.32 -141354.47  3.05%     -    0s
H    0     0                    -138460.8699 -141318.87  2.06%     -    0s
     0     0 -141001.29    0   88 -138460.87 -141001.29  1.83%     -    0s
     0     0 -140303.20    0   53 -138460.87 -140303.20  1.33%     -    0s
H    0     0                    -139364.1345 -140297.88  0.67%     -    0s
     0     0 -140220.68    0   52 -139364.13 -140220.68  0.61%     -    0s
H    0     0                    -139366.6631 -140220.68  0.61%     -    0s
     0     0 -139863.44    0   41 -139366.66 -139863.44  0.36%     -    0s
     0     0 -139836.76    0   45 -139366.66 -139836.76  0.34%     -    0s
     0     0 -139836.00    0   36 -139366.66 -139836.00  0.34%     -    0s
     0     0 -139696.42    0   31 -139366.66 -139696.42  0.24%     -    0s
     0     0 -139661.58    0   30 -139366.66 -139661.58  0.21%     -    0s
     0     0 -139637.11    0   26 -139366.66 -139637.11  0.19%     -    0s
H    0     0                    -139381.7456 -139593.02  0.15%     -    0s
     0     0 -139593.02    0   34 -139381.75 -139593.02  0.15%     -    0s
     0     0 -139573.33    0   35 -139381.75 -139573.33  0.14%     -    0s
     0     0 -139519.53    0   35 -139381.75 -139519.53  0.10%     -    0s
     0     0 -139519.53    0   31 -139381.75 -139519.53  0.10%     -    0s
     0     0 -139519.53    0   32 -139381.75 -139519.53  0.10%     -    0s
H    0     0                    -139385.6904 -139519.53  0.10%     -    0s
     0     0 -139482.10    0   30 -139385.69 -139482.10  0.07%     -    0s
     0     0 -139465.59    0   14 -139385.69 -139465.59  0.06%     -    0s
     0     0 -139463.40    0   11 -139385.69 -139463.40  0.06%     -    0s
     0     0 -139459.30    0   11 -139385.69 -139459.30  0.05%     -    0s
     0     0 -139405.91    0    4 -139385.69 -139405.91  0.01%     -    0s
H    0     0                    -139391.8902 -139404.25  0.01%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 3
  MIR: 28
  Flow cover: 17
  RLT: 1

Explored 1 nodes (854 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139392 -139386 -139382 ... -122090

Optimal solution found (tolerance 1.00e-04)
Best objective -1.393918901593e+05, best bound -1.394042528339e+05, gap 0.0089%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 159030.52
  Scenario: 41 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139391.89
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -139391.89 = 159030.52
  [DEBUG]   Current θ from Master = 173475.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14445.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11280.93
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 1947.7755, Absolute Gap = 1947.7755, Relative Gap = 0.075712
  Not converged yet (gap = 1947.78 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 18 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394544 nonzeros
Model fingerprint: 0xb486674c
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 65568 rows and 26628 columns
Presolve time: 1.29s
Presolved: 73425 rows, 31792 columns, 457319 nonzeros
Variable types: 29533 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73425 rows, 31792 columns, 457319 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31163   -6.4942574e+04   0.000000e+00   3.216142e+08      5s
   45925    3.0044028e+03   0.000000e+00   1.390656e+07     10s
   57640    1.3053186e+04   0.000000e+00   3.846790e+06     15s
   65544    1.5765853e+04   0.000000e+00   2.390152e+07     20s
   75932    2.5423124e+04   0.000000e+00   4.789549e+06     25s
   85220    3.4121771e+04   0.000000e+00   2.488455e+06     30s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 4.954067e+04, 61601 iterations, 31.99 seconds (65.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49540.6712    0  190 -207405.59 49540.6712   124%     -   33s
H    0     0                    -202172.9269 49540.6712   125%     -   33s
H    0     0                    -115123.4403 49540.6712   143%     -   34s
H    0     0                    -114680.6824 49540.6712   143%     -   34s
H    0     0                    -100948.3307 49540.6712   149%     -   34s
H    0     0                    -98768.85842 49540.6712   150%     -   34s
H    0     0                    -97831.72011 49540.6712   151%     -   34s
H    0     0                    -94874.31110 49540.6712   152%     -   34s
H    0     0                    -89524.47355 49540.6712   155%     -   34s
H    0     0                    -72299.87719 49540.6712   169%     -   34s
H    0     0                    -3636.644388 49540.6712  1462%     -   34s
H    0     0                    8646.6819309 49540.6712   473%     -   34s
H    0     0                    9804.6677677 49540.6712   405%     -   34s
H    0     0                    10235.831698 49540.6712   384%     -   34s
H    0     0                    10571.544102 45589.6256   331%     -   51s
H    0     0                    10751.060926 45589.6256   324%     -   51s
     0     0 45580.3607    0  234 10751.0609 45580.3607   324%     -   51s
     0     0 44440.1674    0  277 10751.0609 44440.1674   313%     -   59s
     0     0 44429.7230    0  262 10751.0609 44429.7230   313%     -   62s
     0     0 44429.7230    0  267 10751.0609 44429.7230   313%     -   63s
     0     0 44429.7230    0  271 10751.0609 44429.7230   313%     -   63s
     0     0 44429.7230    0  269 10751.0609 44429.7230   313%     -   65s
     0     0 44429.7230    0  269 10751.0609 44429.7230   313%     -   68s
     0     0 44429.7230    0  278 10751.0609 44429.7230   313%     -   69s
     0     0 44429.7230    0  280 10751.0609 44429.7230   313%     -   69s
     0     0 44429.6874    0  284 10751.0609 44429.6874   313%     -   69s
H    0     0                    10929.810106 41559.1059   280%     -   85s
H    0     0                    11362.504310 41559.1059   266%     -   85s
H    0     0                    11364.449740 41559.1059   266%     -   85s
H    0     0                    13158.478427 41559.1059   216%     -   85s
H    0     0                    14453.017375 41559.1059   188%     -   85s
H    0     0                    16737.482133 41559.1059   148%     -   85s
H    0     0                    16738.235375 41559.1059   148%     -   85s
     0     0 41431.0313    0  313 16738.2354 41431.0313   148%     -   85s
H    0     0                    20013.763995 41431.0313   107%     -   85s
H    0     0                    20382.786063 41431.0313   103%     -   85s
H    0     0                    20552.525752 41431.0313   102%     -   85s
H    0     0                    20600.855506 41431.0313   101%     -   85s
H    0     0                    20697.143168 41431.0313   100%     -   85s
H    0     0                    20712.728079 41431.0313   100%     -   85s
     0     0 41061.5163    0  323 20712.7281 41061.5163  98.2%     -   93s
     0     0 40882.0687    0  375 20712.7281 40882.0687  97.4%     -   98s
     0     0 40772.9110    0  328 20712.7281 40772.9110  96.8%     -  101s
     0     0 40690.8705    0  369 20712.7281 40690.8705  96.5%     -  106s
     0     0 40648.0163    0  369 20712.7281 40648.0163  96.2%     -  108s
     0     0 40632.3683    0  363 20712.7281 40632.3683  96.2%     -  109s
     0     0 40624.1633    0  365 20712.7281 40624.1633  96.1%     -  111s
     0     0 40622.5315    0  366 20712.7281 40622.5315  96.1%     -  111s
     0     0 40621.8683    0  363 20712.7281 40621.8683  96.1%     -  111s
H    0     0                    20726.640951 40621.8683  96.0%     -  118s
H    0     0                    20752.385334 40621.8683  95.7%     -  118s
H    0     0                    20800.559480 40621.8683  95.3%     -  118s
H    0     0                    21341.912564 40621.8683  90.3%     -  118s
     0     0 39746.5129    0  403 21341.9126 39746.5129  86.2%     -  127s
     0     0 39433.7908    0  419 21341.9126 39433.7908  84.8%     -  135s
     0     0 39127.1792    0  381 21341.9126 39127.1792  83.3%     -  145s
     0     0 39058.6748    0  385 21341.9126 39058.6748  83.0%     -  149s
     0     0 38940.5693    0  431 21341.9126 38940.5693  82.5%     -  154s
     0     0 38882.2046    0  402 21341.9126 38882.2046  82.2%     -  157s
H    0     0                    21363.286190 38821.4839  81.7%     -  161s
H    0     0                    21569.101703 38821.4839  80.0%     -  161s
H    0     0                    22034.673710 38821.4839  76.2%     -  161s
     0     0 38821.4839    0  436 22034.6737 38821.4839  76.2%     -  161s
     0     0 38808.3936    0  442 22034.6737 38808.3936  76.1%     -  162s
     0     0 38804.1491    0  402 22034.6737 38804.1491  76.1%     -  163s
     0     0 38793.8970    0  401 22034.6737 38793.8970  76.1%     -  164s
     0     0 38787.1798    0  402 22034.6737 38787.1798  76.0%     -  165s
     0     0 38786.6512    0  403 22034.6737 38786.6512  76.0%     -  165s
H    0     0                    22141.737846 38271.5738  72.8%     -  180s
H    0     0                    22230.245308 38271.5738  72.2%     -  180s
H    0     0                    22266.603121 38271.5738  71.9%     -  180s
H    0     0                    22284.363995 38271.5738  71.7%     -  180s
H    0     0                    22324.086181 38271.5738  71.4%     -  180s
     0     0 38271.5738    0  463 22324.0862 38271.5738  71.4%     -  180s
H    0     0                    22461.267861 38269.4184  70.4%     -  180s
H    0     0                    22516.724514 38269.4184  70.0%     -  180s
H    0     0                    22553.702508 38269.4184  69.7%     -  180s
H    0     0                    22615.321714 38269.4184  69.2%     -  180s
     0     0 38200.2238    0  473 22615.3217 38200.2238  68.9%     -  185s
     0     0 38176.9107    0  480 22615.3217 38176.9107  68.8%     -  188s
H    0     0                    22723.311390 38125.5483  67.8%     -  192s
     0     0 38125.5483    0  419 22723.3114 38125.5483  67.8%     -  192s
     0     0 38112.0419    0  424 22723.3114 38112.0419  67.7%     -  193s
     0     0 38107.4182    0  416 22723.3114 38107.4182  67.7%     -  194s
     0     0 38103.9012    0  438 22723.3114 38103.9012  67.7%     -  194s
     0     0 38098.3667    0  464 22723.3114 38098.3667  67.7%     -  195s
     0     0 38094.9713    0  433 22723.3114 38094.9713  67.6%     -  195s
     0     0 38092.9040    0  427 22723.3114 38092.9040  67.6%     -  196s
     0     0 38091.2521    0  434 22723.3114 38091.2521  67.6%     -  196s
     0     0 38091.0114    0  430 22723.3114 38091.0114  67.6%     -  196s
     0     0 38022.6014    0  437 22723.3114 38022.6014  67.3%     -  200s
H    0     0                    23061.237348 38020.0830  64.9%     -  200s
     0     0 38015.6462    0  437 23061.2373 38015.6462  64.8%     -  201s
     0     0 38011.3945    0  440 23061.2373 38011.3945  64.8%     -  202s
     0     0 38010.0459    0  439 23061.2373 38010.0459  64.8%     -  202s
     0     0 38009.3100    0  437 23061.2373 38009.3100  64.8%     -  203s
     0     0 37954.2888    0  427 23061.2373 37954.2888  64.6%     -  206s
     0     0 37938.7473    0  472 23061.2373 37938.7473  64.5%     -  208s
     0     0 37938.0944    0  432 23061.2373 37938.0944  64.5%     -  209s
     0     0 37886.7886    0  482 23061.2373 37886.7886  64.3%     -  212s
     0     0 37876.6295    0  488 23061.2373 37876.6295  64.2%     -  213s
     0     0 37863.6914    0  490 23061.2373 37863.6914  64.2%     -  215s
     0     0 37860.3888    0  489 23061.2373 37860.3888  64.2%     -  215s
     0     0 37856.9919    0  488 23061.2373 37856.9919  64.2%     -  216s
     0     0 37855.4946    0  486 23061.2373 37855.4946  64.2%     -  216s
     0     0 37852.5095    0  499 23061.2373 37852.5095  64.1%     -  216s
     0     0 37851.7233    0  498 23061.2373 37851.7233  64.1%     -  217s
     0     0 37783.1134    0  482 23061.2373 37783.1134  63.8%     -  219s
     0     0 37764.9203    0  501 23061.2373 37764.9203  63.8%     -  221s
     0     0 37754.3032    0  496 23061.2373 37754.3032  63.7%     -  222s
     0     0 37751.9873    0  498 23061.2373 37751.9873  63.7%     -  223s
     0     0 37749.9008    0  503 23061.2373 37749.9008  63.7%     -  223s
     0     0 37749.4087    0  501 23061.2373 37749.4087  63.7%     -  223s
     0     0 37735.1095    0  497 23061.2373 37735.1095  63.6%     -  226s
     0     0 37730.8041    0  502 23061.2373 37730.8041  63.6%     -  227s
     0     0 37727.0838    0  500 23061.2373 37727.0838  63.6%     -  227s
     0     0 37726.1636    0  502 23061.2373 37726.1636  63.6%     -  228s
     0     0 37706.9251    0  492 23061.2373 37706.9251  63.5%     -  229s
     0     0 37691.9472    0  493 23061.2373 37691.9472  63.4%     -  231s
     0     0 37689.5839    0  498 23061.2373 37689.5839  63.4%     -  231s
     0     0 37689.2226    0  497 23061.2373 37689.2226  63.4%     -  232s
     0     0 37680.1911    0  494 23061.2373 37680.1911  63.4%     -  233s
     0     0 37674.6122    0  501 23061.2373 37674.6122  63.4%     -  235s
     0     0 37672.2125    0  505 23061.2373 37672.2125  63.4%     -  235s
     0     0 37668.9685    0  507 23061.2373 37668.9685  63.3%     -  236s
     0     0 37668.2190    0  509 23061.2373 37668.2190  63.3%     -  236s
H    0     0                    23218.193646 37651.2883  62.2%     -  238s
     0     0 37651.2883    0  537 23218.1936 37651.2883  62.2%     -  238s
H    0     0                    23365.262883 37649.0682  61.1%     -  239s
H    0     0                    23380.330475 37649.0682  61.0%     -  239s
     0     0 37648.5958    0  507 23380.3305 37648.5958  61.0%     -  240s
     0     0 37647.9330    0  506 23380.3305 37647.9330  61.0%     -  240s
     0     0 37644.1947    0  510 23380.3305 37644.1947  61.0%     -  241s
     0     0 37641.4630    0  504 23380.3305 37641.4630  61.0%     -  242s
     0     0 37640.3168    0  507 23380.3305 37640.3168  61.0%     -  243s
     0     0 37629.7357    0  498 23380.3305 37629.7357  60.9%     -  245s
     0     0 37619.4864    0  502 23380.3305 37619.4864  60.9%     -  247s
     0     0 37618.4456    0  504 23380.3305 37618.4456  60.9%     -  247s
     0     0 37606.2611    0  501 23380.3305 37606.2611  60.8%     -  249s
     0     0 37604.0557    0  504 23380.3305 37604.0557  60.8%     -  250s
     0     0 37603.3625    0  509 23380.3305 37603.3625  60.8%     -  250s
     0     0 37591.1824    0  496 23380.3305 37591.1824  60.8%     -  252s
     0     0 37588.2778    0  501 23380.3305 37588.2778  60.8%     -  254s
     0     0 37587.3501    0  497 23380.3305 37587.3501  60.8%     -  254s
     0     0 37586.1186    0  496 23380.3305 37586.1186  60.8%     -  255s
     0     0 37585.6060    0  496 23380.3305 37585.6060  60.8%     -  257s
     0     0 37580.8530    0  498 23380.3305 37580.8530  60.7%     -  258s
     0     0 37578.1866    0  497 23380.3305 37578.1866  60.7%     -  259s
     0     0 37578.1866    0  497 23380.3305 37578.1866  60.7%     -  260s
     0     0 37574.6619    0  497 23380.3305 37574.6619  60.7%     -  261s
H    0     0                    23487.409370 37574.5388  60.0%     -  333s
H    0     0                    23497.225489 37574.5388  59.9%     -  338s
H    0     0                    23661.410487 37574.5388  58.8%     -  340s
     0     2 37574.5388    0  497 23661.4105 37574.5388  58.8%     -  341s
     1     3 36303.8068    1  427 23661.4105 37574.1097  58.8% 15880  351s
     2     4 37417.8179    1  491 23661.4105 37417.8179  58.1% 10318  357s
     3     7 35828.0828    2  435 23661.4105 37415.0745  58.1%  8477  365s
     6    13 35555.5900    3  426 23661.4105 37413.5422  58.1%  7167  375s
    12    26 36379.9280    4  431 23661.4105 36972.7310  56.3%  8489  385s
    25    39 35918.1241    5  456 23661.4105 36763.4372  55.4% 10402  410s
    38    71 35360.3400    6  438 23661.4105 36763.4372  55.4% 10839  448s
    70   145 35060.8277    7  426 23661.4105 36301.0601  53.4% 12354  463s
   144   237 35047.1623    8  463 23661.4105 36300.2860  53.4%  8175  476s
H  151   237                    23718.946111 36300.2860  53.0%  7924  476s
H  155   237                    23725.827706 36300.2860  53.0%  7834  476s
H  162   237                    23730.852517 36300.2860  53.0%  7614  476s
H  167   237                    23738.504021 36300.2860  52.9%  7594  476s
H  178   237                    23808.766841 36300.2860  52.5%  7364  476s
   236   308 34698.4046   13  402 23808.7668 36300.2860  52.5%  6373  487s
   307   373 34426.4699   16  392 23808.7668 36300.2860  52.5%  5822  498s
H  317   373                    23867.651669 36300.2860  52.1%  5723  498s
   372   438 34142.3542   18  385 23867.6517 36300.2860  52.1%  5468  508s
   440   494 33616.3671   20  383 23867.6517 36300.2860  52.1%  5177  518s
H  441   494                    23882.957030 36300.2860  52.0%  5166  518s
   496   558 33224.3018   21  381 23882.9570 36300.2860  52.0%  5159  527s
   562   603 31921.7897   22  344 23882.9570 36300.2860  52.0%  5067  536s
H  597   603                    23997.981883 36300.2860  51.3%  5124  536s
   610   661 31397.5986   23  358 23997.9819 36300.2860  51.3%  5147  545s
   672   701 31370.6844   24  357 23997.9819 36300.2860  51.3%  5216  555s
   722   755 31365.8378   25  397 23997.9819 36300.2860  51.3%  5203  563s
   790   804 31127.1700   27  383 23997.9819 36300.2860  51.3%  5188  573s
   858   857 30819.2957   29  379 23997.9819 36300.2860  51.3%  5164  583s
   937   879 30763.3067   32  283 23997.9819 36300.2860  51.3%  5034  592s
   975   906 30483.9449   33  319 23997.9819 36300.2860  51.3%  5116  602s
  1012   933 29421.0997   34  305 23997.9819 36300.2860  51.3%  5168  613s
  1047   952 29388.1504   35  313 23997.9819 36300.2860  51.3%  5207  624s
H 1070   952                    24126.593647 36300.2860  50.5%  5207  624s
  1090  1019 29357.2492   36  248 24126.5936 36300.2860  50.5%  5218  634s
H 1095  1019                    24379.992116 36300.2860  48.9%  5215  634s
H 1133  1019                    24510.984617 36060.6817  47.1%  5166  634s
  1189  1061 28839.2830   40  282 24510.9846 36060.0337  47.1%  5095  644s
H 1272  1092                    24592.238999 36060.0337  46.6%  5124  656s
H 1322  1092                    24603.911204 36060.0337  46.6%  5107  656s
  1342  1147 28308.4601   45  263 24603.9112 36060.0337  46.6%  5109  668s
  1411  1170 28019.5947   48  268 24603.9112 36060.0337  46.6%  5182  681s
  1446  1193 27896.0713   49  327 24603.9112 35982.9516  46.2%  5232  693s
H 1459  1193                    24665.333756 35982.9516  45.9%  5266  693s
  1485  1273 27857.7805   50  309 24665.3338 35778.3880  45.1%  5301  706s
  1595  1354 27351.9783   56  306 24665.3338 35778.3880  45.1%  5327  719s
H 1660  1354                    24675.012937 35778.3880  45.0%  5296  719s
  1708  1424 27001.6824   62  281 24675.0129 35778.3880  45.0%  5308  733s
  1814  1489 25960.8529   67  247 24675.0129 35778.3880  45.0%  5315  747s
  1907  1569 25819.4340   68  272 24675.0129 35778.3880  45.0%  5343  763s
  2021  1594     cutoff   32      24675.0129 35650.9892  44.5%  5365  774s
H 2050  1594                    24978.103165 35581.3737  42.5%  5392  774s
  2060  1655 33153.5848   14  389 24978.1032 35581.3737  42.5%  5407  790s
  2179  1729 31439.9825   16  381 24978.1032 35581.3737  42.5%  5412  804s
H 2181  1729                    25059.505927 35581.3737  42.0%  5414  804s
H 2214  1729                    25079.721029 35581.3737  41.9%  5397  804s
  2283  1824 31069.4766   17  370 25079.7210 35581.3737  41.9%  5399  820s
  2420  1831 29769.2845   20  273 25079.7210 35581.3737  41.9%  5417  836s
  2564  1894 29084.0357   23  262 25079.7210 35573.7020  41.8%  5421  855s
  2685  1952 27908.3332   28  229 25079.7210 35540.5653  41.7%  5505  872s
  2809  2028 25632.9955   33  162 25079.7210 35359.9050  41.0%  5583  891s
  2931  2049     cutoff   31      25079.7210 35348.0037  40.9%  5651  907s
H 2935  2044                    25221.011445 35348.0037  40.2%  5659  907s
H 2941  2042                    25234.254245 35348.0037  40.1%  5656  907s
H 2945  1999                    25461.648514 35348.0037  38.8%  5659  907s
  2974  2064 31719.0605   11  409 25461.6485 35348.0037  38.8%  5699  927s
  3111  2169 29159.4655   12  301 25461.6485 35348.0037  38.8%  5748  949s
  3256  2286 25805.8449   13  291 25461.6485 35348.0037  38.8%  5819  973s
  3455  2394     cutoff   55      25461.6485 35159.1196  38.1%  5751  995s
  3635  2475 30942.8491   12  338 25461.6485 35115.9132  37.9%  5742 1018s
H 3709  2472                    25474.891314 35115.9132  37.8%  5744 1018s
  3816  2561 26892.1944   14  341 25474.8913 35073.7857  37.7%  5760 1043s
H 4007  2598                    25491.216159 35073.7857  37.6%  5782 1066s
H 4017  2593                    25545.200083 35073.7857  37.3%  5786 1066s
H 4072  2592                    25575.475032 35073.7857  37.1%  5766 1066s
H 4075  2570                    25669.133781 35073.7857  36.6%  5766 1066s
  4109  2657     cutoff   18      25669.1338 35073.7857  36.6%  5777 1093s
  4277  2715 29289.4162   12  258 25669.1338 35073.7857  36.6%  5820 1118s
  4406  2716 32512.2370   13  497 25669.1338 35073.7857  36.6%  5811 1389s
  4408  2717 29165.9517   26  190 25669.1338 35073.7857  36.6%  5808 1421s
  4409  2718 32131.1695   14  373 25669.1338 35073.7857  36.6%  5807 1446s
  4410  2719 31785.4906   10  372 25669.1338 35073.7857  36.6%  5806 1462s
  4411  2719 26914.5958   29  455 25669.1338 35073.7857  36.6%  5804 1475s
  4412  2720 27158.5610   29  455 25669.1338 35073.7857  36.6%  5803 1484s
  4413  2721 27129.5146   22  443 25669.1338 35073.7857  36.6%  5802 1489s
  4414  2721 34016.2488   10  474 25669.1338 35073.7857  36.6%  5800 1495s
  4415  2722 32935.0435   12  480 25669.1338 35073.7857  36.6%  5799 1501s
  4416  2723 27539.1070   25  481 25669.1338 35073.7857  36.6%  5798 1505s
  4418  2724 29573.4222   23  488 25669.1338 35073.7857  36.6%  5795 1511s
  4420  2725 26292.8007   42  529 25669.1338 35073.7857  36.6%  5793 1517s
  4421  2726 31206.4052   19  488 25669.1338 35073.7857  36.6%  5791 1525s
  4423  2727 27418.6208   43  505 25669.1338 35073.7857  36.6%  5789 1533s
  4424  2728 28015.1934   35  504 25669.1338 35073.7857  36.6%  5787 1537s
  4426  2729 30473.3738   12  539 25669.1338 35073.7857  36.6%  5785 1545s
  4428  2731 26445.1526   53  481 25669.1338 35073.7857  36.6%  5782 1550s
  4429  2731 28474.0579   23  493 25669.1338 35073.7857  36.6%  5781 1555s
  4431  2733 26261.5494   68  495 25669.1338 35073.7857  36.6%  5778 1562s
  4432  2733 31842.3926   21  538 25669.1338 35073.7857  36.6%  5777 1565s
  4433  2734 27292.4498   27  498 25669.1338 35073.7857  36.6%  5776 1575s
  4434  2735 26413.6000   39  498 25669.1338 35073.7857  36.6%  5774 1580s
  4436  2736 27804.7711   24  482 25669.1338 35073.7857  36.6%  5772 1587s
  4437  2737 27195.5505   31  497 25669.1338 35073.7857  36.6%  5770 1594s
  4438  2737 33898.9323   14  494 25669.1338 35073.7857  36.6%  5769 1598s
  4439  2738 27120.1741   41  438 25669.1338 35073.7857  36.6%  5768 1600s
  4440  2739 33363.4331    7  496 25669.1338 35073.7857  36.6%  5766 1609s
  4441  2739 30354.5992   17  499 25669.1338 35073.7857  36.6%  5765 1612s
  4442  2740 26906.8601   66  504 25669.1338 35073.7857  36.6%  5764 1615s
  4443  2741 29260.3334   24  505 25669.1338 35073.7857  36.6%  5763 1621s
  4445  2742 30402.9342   17  528 25669.1338 35073.7857  36.6%  5760 1630s
  4447  2743 30988.7015   12  508 25669.1338 35073.7857  36.6%  5757 1639s
  4448  2744 26216.5495   28  440 25669.1338 35073.7857  36.6%  5756 1643s
  4449  2745 30673.3979   15  502 25669.1338 35073.7857  36.6%  5755 1652s
  4451  2746 26330.3406   45  506 25669.1338 35073.7857  36.6%  5752 1656s
  4452  2747 31502.0338   23  442 25669.1338 35073.7857  36.6%  5751 1660s
  4454  2748 31449.5025   10  435 25669.1338 35073.7857  36.6%  5748 1667s
  4455  2749 29237.9197   36  435 25669.1338 35073.7857  36.6%  5747 1700s
  4456  2749 26571.9950   53  435 25669.1338 35073.7857  36.6%  5746 1762s
  4457  2753 35073.7857   10  483 25669.1338 35073.7857  36.6%  5809 1779s
  4459  2756 35073.7857   11  451 25669.1338 35073.7857  36.6%  5809 1798s
  4463  2763 35073.7857   12  453 25669.1338 35073.7857  36.6%  5810 1817s
  4471  2776 35073.7857   13  459 25669.1338 35073.7857  36.6%  5824 1833s
  4487  2787 34654.5357   14  421 25669.1338 35073.7857  36.6%  5863 1868s
  4503  2814 33280.4916   15  382 25669.1338 35073.7857  36.6%  5889 1897s
  4535  2848 32559.1114   16  359 25669.1338 35073.7857  36.6%  5932 1920s
  4580  2872 32049.1101   18  418 25669.1338 35073.7857  36.6%  5996 1939s
  4622  2896 29146.5291   19  355 25669.1338 35073.7857  36.6%  6005 1959s
  4670  2919 29766.2228   18  282 25669.1338 35073.7857  36.6%  6010 1980s
  4728  2929 29714.3436   19  280 25669.1338 35073.7857  36.6%  5993 2010s
  4811  2928 27476.8479   21  333 25669.1338 35073.7857  36.6%  5967 2028s
  4892  2936 26863.3904   22  295 25669.1338 35073.7857  36.6%  5929 2043s
  4978  2919     cutoff   23      25669.1338 35073.7857  36.6%  5891 2057s
  5044  2910 29047.2027   20  210 25669.1338 35073.7857  36.6%  5863 2075s
  5129  2877 28143.9669   21  200 25669.1338 35073.7857  36.6%  5814 2094s
  5189  2869 27235.4632   24  267 25669.1338 35073.7857  36.6%  5788 2109s
  5246  2867 26133.3515   26  109 25669.1338 35073.7857  36.6%  5769 2131s
  5302  2856     cutoff   28      25669.1338 35073.7857  36.6%  5755 2149s
  5375  2839 28801.4831   18  374 25669.1338 35073.7857  36.6%  5728 2163s
  5430  2858 27253.9205   19  304 25669.1338 35073.7857  36.6%  5723 2178s
  5480  2866 25955.3968   20  212 25669.1338 35073.7857  36.6%  5725 2192s
  5535  2862     cutoff   21      25669.1338 35073.7857  36.6%  5713 2207s
  5608  2853     cutoff   20      25669.1338 34973.0350  36.2%  5683 2223s
  5673  2853     cutoff   16      25669.1338 34970.5306  36.2%  5675 2242s
  5759  2850 27237.0848   18  303 25669.1338 34970.5306  36.2%  5644 2261s
  5854  2817 26501.6167   20  293 25669.1338 34970.5306  36.2%  5608 2286s
  5948  2797 26345.3099   22  218 25669.1338 34970.5306  36.2%  5581 2305s
  5990  2805 25892.3282   23  208 25669.1338 34970.5306  36.2%  5587 2325s
  6049  2800 25892.2517   24  206 25669.1338 34970.5306  36.2%  5581 2342s
  6099  2795     cutoff   25      25669.1338 32721.1240  27.5%  5579 2361s
  6176  2767     cutoff   18      25669.1338 32721.1240  27.5%  5558 2384s
  6280  2759 28921.3677   22  384 25669.1338 32143.4098  25.2%  5526 2409s
  6370  2747 27041.1137   25  248 25669.1338 32143.4098  25.2%  5523 2431s
  6492  2733 25803.9368   33  121 25669.1338 32143.4098  25.2%  5495 2455s
  6597  2717 infeasible   23      25669.1338 31738.4587  23.6%  5480 2481s
  6748  2678 25711.3565   20  320 25669.1338 31250.7092  21.7%  5439 2508s
  6918  2655 28087.1147   19  342 25669.1338 31219.2494  21.6%  5398 2536s
  7059  2625 26252.2341   21  277 25669.1338 31140.4618  21.3%  5382 2565s
  7231  2559 25749.0370   23  207 25669.1338 31140.4618  21.3%  5348 2595s
  7430  2482 27184.6631   18  315 25669.1338 30485.0145  18.8%  5311 2625s
  7603  2419 26525.0678   18  360 25669.1338 30097.9251  17.3%  5296 2657s
  7817  2328     cutoff   19      25669.1338 29960.2958  16.7%  5255 2692s
  8044  2241     cutoff   19      25669.1338 29672.0327  15.6%  5208 2727s
  8243  2172 27561.6124   20  247 25669.1338 29672.0327  15.6%  5190 2758s
  8439  2087 26380.9744   17  351 25669.1338 29145.7926  13.5%  5149 2795s
  8690  2015 27470.7098   27  179 25669.1338 28923.5795  12.7%  5113 2832s
  9028  1881     cutoff   36      25669.1338 28620.4706  11.5%  5042 2869s
  9440  1691 26066.8953   19  431 25669.1338 28254.6653  10.1%  4943 2904s
  9884  1489     cutoff   27      25669.1338 27867.2293  8.56%  4843 2941s
 10456  1164     cutoff   25      25669.1338 27409.3423  6.78%  4697 2973s
 11142   659 25762.7303   28  148 25669.1338 27006.6126  5.21%  4525 3002s
 12031   224     cutoff   23      25669.1338 26683.6650  3.95%  4284 3011s

Cutting planes:
  Learned: 1
  MIR: 543
  Flow cover: 1516
  Zero half: 1
  RLT: 22
  Relax-and-lift: 148

Explored 12237 nodes (51992432 simplex iterations) in 3011.11 seconds (8723.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25669.1 25575.5 25545.2 ... 25059.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.566913378063e+04, best bound 2.566913378063e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3011.12s
  Master Objective (UB) = 25669.13, θ = 172607.84
  Upper Bound (UB) = 25669.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172607.84
  [DEBUG]   ✓ Scenario 0: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172607.84 ≤ Q = 172607.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 172607.84 ≤ Q = 175177.30 (slack: 2569.46)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x36466472
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc9b99b8e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.336640e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6149224.1765
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.573584e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157358.37    0  121 6149224.18 -157358.37   103%     -    0s
H    0     0                    -123831.3991 -157358.37  27.1%     -    0s
H    0     0                    -124293.7138 -157358.37  26.6%     -    0s
H    0     0                    -124293.8919 -157358.37  26.6%     -    0s
H    0     0                    -124770.3378 -135787.37  8.83%     -    0s
H    0     0                    -125202.0395 -135787.37  8.45%     -    0s
     0     0 -135787.37    0   84 -125202.04 -135787.37  8.45%     -    0s
H    0     0                    -132588.7417 -135752.91  2.39%     -    0s
H    0     0                    -132942.0926 -135752.91  2.11%     -    0s
H    0     0                    -133529.3512 -135752.91  1.67%     -    0s
H    0     0                    -133882.7021 -135752.91  1.40%     -    0s
     0     0 -134992.91    0   85 -133882.70 -134992.91  0.83%     -    0s
     0     0 -134956.49    0   85 -133882.70 -134956.49  0.80%     -    0s
H    0     0                    -133947.4024 -134956.49  0.75%     -    0s
     0     0 -134541.22    0   58 -133947.40 -134541.22  0.44%     -    0s
     0     0 -134496.05    0   59 -133947.40 -134496.05  0.41%     -    0s
     0     0 -134385.78    0   57 -133947.40 -134385.78  0.33%     -    0s
     0     0 -134363.39    0   57 -133947.40 -134363.39  0.31%     -    0s
     0     2 -134363.39    0   57 -133947.40 -134363.39  0.31%     -    0s
H  268    37                    -133953.6516 -134097.18  0.11%   4.7    0s
H  755    24                    -133978.4006 -134040.82  0.05%   3.3    0s

Cutting planes:
  Gomory: 32
  Implied bound: 8
  MIR: 159
  Flow cover: 6
  RLT: 26
  BQP: 5

Explored 897 nodes (3374 simplex iterations) in 0.10 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -133978 -133954 -133947 ... 6.14922e+06
No other solutions better than -133978

Optimal solution found (tolerance 1.00e-04)
Best objective -1.339784006114e+05, best bound -1.339784006114e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 164444.01
  Scenario: 38 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133978.40
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -133978.40 = 164444.01
  [DEBUG]   Current θ from Master = 172607.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8163.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17505.31
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 1890.6563, Absolute Gap = 1890.6563, Relative Gap = 0.073655
  Not converged yet (gap = 1890.66 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 21 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437769 nonzeros
Model fingerprint: 0x94368838
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 72840 rows and 29580 columns
Presolve time: 1.24s
Presolved: 81443 rows, 35080 columns, 500459 nonzeros
Variable types: 32821 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.390e+06
 Factor NZ  : 7.257e+06 (roughly 100 MB of memory)
 Factor Ops : 1.203e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67512082e+07  1.47055744e+08  1.05e+05 2.12e+01  7.49e+04     2s
   1  -1.21205417e+07  1.32578302e+08  7.03e+04 7.69e+01  5.01e+04     2s
   2  -3.82259043e+06  1.01722253e+08  2.22e+04 1.01e-11  1.66e+04     2s
   3  -1.04661353e+06  9.77677804e+07  3.36e+03 6.91e+00  3.05e+03     2s
   4  -4.87159572e+05  7.20112615e+07  4.75e+02 3.79e+00  8.03e+02     2s
   5  -4.27309618e+05  3.53857027e+07  2.46e+02 9.75e-12  3.83e+02     2s
   6  -3.59706980e+05  2.45082675e+07  8.20e+01 5.94e-12  2.10e+02     2s
   7  -3.03073482e+05  1.78972262e+07  3.80e+01 6.75e-12  1.39e+02     3s
   8  -2.17112418e+05  1.46843603e+07  9.92e+00 4.66e-12  1.04e+02     3s
   9  -1.35442220e+05  7.91837453e+06  2.67e+00 4.31e-12  5.45e+01     3s
  10  -9.66786606e+04  3.90290740e+06  1.45e+00 2.59e-12  2.69e+01     3s
  11  -4.91591320e+04  1.22830220e+06  1.88e-01 2.25e-12  8.54e+00     3s
  12  -2.05868361e+04  3.82695875e+05  6.22e-02 1.11e-12  2.70e+00     3s
  13  -6.65991338e+03  2.38747660e+05  4.40e-02 1.04e-12  1.64e+00     3s
  14   2.05977109e+03  1.86631384e+05  3.52e-02 1.15e-12  1.23e+00     3s
  15   9.66475342e+03  1.49779369e+05  2.84e-02 6.98e-13  9.36e-01     3s
  16   1.71149583e+04  1.30528347e+05  2.18e-02 7.15e-13  7.58e-01     3s
  17   2.39855974e+04  1.18092997e+05  1.62e-02 7.28e-13  6.29e-01     3s
  18   2.74338702e+04  9.66353699e+04  1.37e-02 9.34e-13  4.62e-01     3s
  19   2.98977764e+04  8.46905887e+04  1.21e-02 2.90e-04  3.66e-01     3s
  20   3.52536052e+04  8.01455275e+04  8.68e-03 8.40e-13  3.00e-01     3s
  21   3.83481672e+04  7.38881180e+04  6.85e-03 8.19e-04  2.37e-01     3s
  22   4.05532038e+04  6.88812314e+04  5.61e-03 6.28e-04  1.89e-01     3s
  23   4.25989634e+04  6.16063809e+04  4.50e-03 2.04e-03  1.27e-01     3s
  24   4.63162224e+04  5.90708146e+04  2.65e-03 1.48e-03  8.52e-02     3s
  25   4.73004215e+04  5.63993863e+04  2.18e-03 9.28e-04  6.08e-02     3s
  26   4.81444639e+04  5.47087813e+04  1.80e-03 5.29e-04  4.39e-02     3s
  27   4.93621653e+04  5.42681563e+04  1.25e-03 4.27e-04  3.28e-02     3s
  28   5.01932256e+04  5.38471595e+04  9.03e-04 3.39e-04  2.44e-02     3s
  29   5.09246780e+04  5.36531187e+04  5.92e-04 2.95e-04  1.82e-02     3s
  30   5.10021059e+04  5.34168718e+04  5.58e-04 2.43e-04  1.61e-02     3s
  31   5.12994986e+04  5.31768861e+04  4.27e-04 1.88e-04  1.25e-02     3s
  32   5.15469448e+04  5.28498702e+04  3.19e-04 1.13e-04  8.71e-03     3s
  33   5.20184419e+04  5.27034759e+04  1.21e-04 7.98e-05  4.58e-03     3s
  34   5.21308021e+04  5.25550904e+04  7.78e-05 4.76e-05  2.83e-03     3s
  35   5.21826553e+04  5.24888178e+04  5.70e-05 3.29e-05  2.05e-03     3s
  36   5.22413284e+04  5.24530109e+04  3.46e-05 2.50e-05  1.41e-03     4s
  37   5.22723784e+04  5.24117734e+04  2.28e-05 1.56e-05  9.31e-04     4s
  38   5.23042025e+04  5.23790231e+04  1.12e-05 8.70e-06  5.00e-04     4s
  39   5.23061797e+04  5.23630033e+04  1.05e-05 5.35e-06  3.80e-04     4s
  40   5.23224815e+04  5.23566339e+04  4.84e-06 3.97e-06  2.28e-04     4s
  41   5.23363953e+04  5.23399022e+04  3.19e-07 5.18e-06  2.34e-05     4s
  42   5.23377031e+04  5.23379069e+04  3.32e-08 3.57e-07  1.36e-06     4s
  43   5.23377464e+04  5.23377771e+04  4.79e-07 8.25e-08  2.05e-07     4s
  44   5.23377528e+04  5.23377528e+04  3.28e-10 1.29e-10  1.41e-10     4s

Barrier solved model in 44 iterations and 3.86 seconds (6.77 work units)
Optimal objective 5.23377528e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

     789 PPushes remaining with PInf 1.9909829e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.0793137e-10      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35323    5.2337753e+04   0.000000e+00   0.000000e+00      7s
   35323    5.2337753e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.233775e+04, 35323 iterations, 5.25 seconds (12.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52337.7528    0  239 -207405.59 52337.7528   125%     -    7s
H    0     0                    -74558.77790 52337.7528   170%     -    7s
H    0     0                    -61244.57778 52337.7528   185%     -    7s
H    0     0                    2840.3827787 52337.7528  1743%     -    7s
H    0     0                    2967.6517287 52337.7528  1664%     -    7s
H    0     0                    3606.9581297 52337.7528  1351%     -    8s
H    0     0                    3610.6796708 52337.7528  1350%     -    8s
H    0     0                    3737.5825586 52337.7528  1300%     -    8s
H    0     0                    5801.9336531 46719.7114   705%     -   32s
H    0     0                    6711.0131672 46719.7114   596%     -   32s
     0     0 46719.2420    0  253 6711.01317 46719.2420   596%     -   32s
H    0     0                    8341.8959807 46719.2420   460%     -   32s
H    0     0                    8688.1788670 46719.2420   438%     -   32s
     0     0 46336.9874    0  299 8688.17887 46336.9874   433%     -   42s
     0     0 46228.1144    0  298 8688.17887 46228.1144   432%     -   46s
     0     0 46226.5972    0  306 8688.17887 46226.5972   432%     -   47s
     0     0 46226.5972    0  300 8688.17887 46226.5972   432%     -   48s
     0     0 46226.5972    0  300 8688.17887 46226.5972   432%     -   48s
     0     0 43040.4921    0  318 8688.17887 43040.4921   395%     -   85s
H    0     0                    9772.2409626 43040.4921   340%     -   85s
     0     0 42318.0378    0  347 9772.24096 42318.0378   333%     -  109s
     0     0 42027.7437    0  370 9772.24096 42027.7437   330%     -  120s
     0     0 41959.3584    0  372 9772.24096 41959.3584   329%     -  128s
     0     0 41890.0462    0  392 9772.24096 41890.0462   329%     -  132s
     0     0 41862.4375    0  378 9772.24096 41862.4375   328%     -  135s
     0     0 41853.8866    0  379 9772.24096 41853.8866   328%     -  136s
     0     0 41837.1608    0  378 9772.24096 41837.1608   328%     -  137s
     0     0 41822.2996    0  376 9772.24096 41822.2996   328%     -  140s
     0     0 41818.5271    0  378 9772.24096 41818.5271   328%     -  141s
     0     0 41815.7931    0  380 9772.24096 41815.7931   328%     -  145s
     0     0 41814.2143    0  378 9772.24096 41814.2143   328%     -  146s
     0     0 41813.8497    0  378 9772.24096 41813.8497   328%     -  146s
H    0     0                    12168.908946 40492.4884   233%     -  177s
H    0     0                    12436.069262 40492.4884   226%     -  177s
H    0     0                    12458.089481 40492.4884   225%     -  177s
     0     0 40492.4884    0  395 12458.0895 40492.4884   225%     -  177s
H    0     0                    12566.377657 40492.3838   222%     -  178s
H    0     0                    12620.295880 40070.2209   218%     -  192s
H    0     0                    12794.869382 40070.2209   213%     -  192s
     0     0 40070.2209    0  376 12794.8694 40070.2209   213%     -  192s
H    0     0                    13887.534815 39909.0645   187%     -  201s
H    0     0                    17234.749097 39909.0645   132%     -  201s
H    0     0                    17272.011862 39909.0645   131%     -  201s
H    0     0                    17289.252523 39909.0645   131%     -  201s
     0     0 39909.0645    0  423 17289.2525 39909.0645   131%     -  201s
     0     0 39856.9485    0  422 17289.2525 39856.9485   131%     -  208s
     0     0 39749.9539    0  388 17289.2525 39749.9539   130%     -  215s
     0     0 39721.1171    0  386 17289.2525 39721.1171   130%     -  217s
     0     0 39710.5107    0  388 17289.2525 39710.5107   130%     -  220s
     0     0 39709.2838    0  387 17289.2525 39709.2838   130%     -  222s
     0     0 38957.4871    0  405 17289.2525 38957.4871   125%     -  249s
H    0     0                    17443.585731 38957.1553   123%     -  250s
     0     0 38794.2199    0  415 17443.5857 38794.2199   122%     -  259s
     0     0 38702.3362    0  415 17443.5857 38702.3362   122%     -  267s
     0     0 38643.1528    0  410 17443.5857 38643.1528   122%     -  272s
     0     0 38590.6304    0  457 17443.5857 38590.6304   121%     -  280s
     0     0 38563.7553    0  431 17443.5857 38563.7553   121%     -  284s
     0     0 38559.6044    0  455 17443.5857 38559.6044   121%     -  286s
     0     0 38551.5725    0  427 17443.5857 38551.5725   121%     -  288s
     0     0 38547.9143    0  460 17443.5857 38547.9143   121%     -  290s
     0     0 38543.0562    0  464 17443.5857 38543.0562   121%     -  292s
     0     0 38542.5011    0  464 17443.5857 38542.5011   121%     -  293s
     0     0 38308.4720    0  451 17443.5857 38308.4720   120%     -  305s
     0     0 38241.5909    0  421 17443.5857 38241.5909   119%     -  310s
     0     0 38192.8220    0  463 17443.5857 38192.8220   119%     -  315s
     0     0 38156.1049    0  471 17443.5857 38156.1049   119%     -  319s
     0     0 38144.1956    0  465 17443.5857 38144.1956   119%     -  321s
     0     0 38133.6219    0  476 17443.5857 38133.6219   119%     -  322s
H    0     0                    17556.245331 38128.9521   117%     -  323s
     0     0 38128.9521    0  475 17556.2453 38128.9521   117%     -  323s
     0     0 38121.1377    0  473 17556.2453 38121.1377   117%     -  325s
     0     0 38114.7432    0  473 17556.2453 38114.7432   117%     -  326s
     0     0 38110.9422    0  470 17556.2453 38110.9422   117%     -  327s
     0     0 38110.1977    0  461 17556.2453 38110.1977   117%     -  327s
H    0     0                    18306.943665 38110.1977   108%     -  328s
H    0     0                    18506.197505 38110.1977   106%     -  328s
     0     0 37993.3709    0  447 18506.1975 37993.3709   105%     -  334s
H    0     0                    18588.024595 37992.1495   104%     -  338s
H    0     0                    18748.916395 37992.1495   103%     -  338s
H    0     0                    18807.925033 37992.1495   102%     -  338s
     0     0 37951.0471    0  450 18807.9250 37951.0471   102%     -  345s
     0     0 37924.3426    0  463 18807.9250 37924.3426   102%     -  347s
     0     0 37897.9010    0  457 18807.9250 37897.9010   101%     -  350s
     0     0 37889.7961    0  468 18807.9250 37889.7961   101%     -  351s
     0     0 37885.3963    0  459 18807.9250 37885.3963   101%     -  353s
     0     0 37880.8013    0  459 18807.9250 37880.8013   101%     -  355s
     0     0 37877.9703    0  495 18807.9250 37877.9703   101%     -  355s
     0     0 37875.8141    0  463 18807.9250 37875.8141   101%     -  356s
     0     0 37875.7381    0  502 18807.9250 37875.7381   101%     -  356s
     0     0 37806.1358    0  465 18807.9250 37806.1358   101%     -  361s
     0     0 37757.5465    0  425 18807.9250 37757.5465   101%     -  366s
     0     0 37751.1069    0  429 18807.9250 37751.1069   101%     -  368s
     0     0 37749.5814    0  424 18807.9250 37749.5814   101%     -  369s
     0     0 37687.2850    0  439 18807.9250 37687.2850   100%     -  374s
     0     0 37677.0007    0  433 18807.9250 37677.0007   100%     -  377s
     0     0 37668.4682    0  437 18807.9250 37668.4682   100%     -  379s
     0     0 37659.8913    0  443 18807.9250 37659.8913   100%     -  381s
     0     0 37652.1565    0  441 18807.9250 37652.1565   100%     -  382s
     0     0 37651.0212    0  444 18807.9250 37651.0212   100%     -  383s
     0     0 37623.6744    0  426 18807.9250 37623.6744   100%     -  387s
     0     0 37617.5888    0  432 18807.9250 37617.5888   100%     -  389s
     0     0 37614.4323    0  471 18807.9250 37614.4323   100%     -  390s
     0     0 37614.0506    0  471 18807.9250 37614.0506   100%     -  391s
     0     0 37558.0973    0  473 18807.9250 37558.0973   100%     -  396s
     0     0 37534.9763    0  515 18807.9250 37534.9763   100%     -  401s
     0     0 37519.3232    0  429 18807.9250 37519.3232  99.5%     -  403s
     0     0 37515.4176    0  430 18807.9250 37515.4176  99.5%     -  404s
     0     0 37513.2431    0  430 18807.9250 37513.2431  99.5%     -  405s
     0     0 37511.8038    0  423 18807.9250 37511.8038  99.4%     -  405s
     0     0 37496.3302    0  435 18807.9250 37496.3302  99.4%     -  408s
     0     0 37492.9913    0  446 18807.9250 37492.9913  99.3%     -  409s
     0     0 37491.9817    0  443 18807.9250 37491.9817  99.3%     -  410s
     0     0 37462.1107    0  442 18807.9250 37462.1107  99.2%     -  413s
     0     0 37455.1025    0  440 18807.9250 37455.1025  99.1%     -  417s
     0     0 37452.8027    0  439 18807.9250 37452.8027  99.1%     -  418s
     0     0 37451.7610    0  441 18807.9250 37451.7610  99.1%     -  418s
     0     0 37408.2849    0  441 18807.9250 37408.2849  98.9%     -  424s
     0     0 37399.5165    0  449 18807.9250 37399.5165  98.8%     -  426s
     0     0 37394.0358    0  462 18807.9250 37394.0358  98.8%     -  427s
     0     0 37390.9764    0  462 18807.9250 37390.9764  98.8%     -  428s
     0     0 37389.5085    0  459 18807.9250 37389.5085  98.8%     -  429s
     0     0 37385.8637    0  438 18807.9250 37385.8637  98.8%     -  430s
     0     0 37384.5017    0  441 18807.9250 37384.5017  98.8%     -  432s
     0     0 37376.2278    0  427 18807.9250 37376.2278  98.7%     -  434s
     0     0 37374.3938    0  439 18807.9250 37374.3938  98.7%     -  435s
     0     0 37364.8358    0  495 18807.9250 37364.8358  98.7%     -  439s
     0     0 37354.7275    0  454 18807.9250 37354.7275  98.6%     -  443s
     0     0 37352.6837    0  490 18807.9250 37352.6837  98.6%     -  444s
     0     0 37344.9016    0  475 18807.9250 37344.9016  98.6%     -  446s
     0     0 37344.4094    0  475 18807.9250 37344.4094  98.6%     -  448s
H    0     0                    18871.272018 37344.1436  97.9%     -  520s
     0     2 37344.1436    0  475 18871.2720 37344.1436  97.9%     -  522s
     3     7 37222.1855    2  436 18871.2720 37292.9312  97.6%  4228  549s
     6    14 37032.2218    3  435 18871.2720 37279.9597  97.5%  9942  561s
    13    28 36952.1677    4  478 18871.2720 37031.4882  96.2% 10856  579s
    27    42 35253.8691    5  487 18871.2720 36948.2645  95.8% 14237  639s
    41    74 34276.2840    6  424 18871.2720 36948.2645  95.8% 14253  681s
    73   118 34275.1193    7  420 18871.2720 36662.6200  94.3% 13518  708s
H   76   118                    18952.690422 36662.6200  93.4% 13132  708s
H  100   118                    22035.207755 36662.6200  66.4% 11534  708s
H  117   243                    22112.225675 36659.4730  65.8% 10800  732s
H  122   243                    22362.608792 36659.4730  63.9% 10444  732s
H  145   243                    22548.405926 36659.4730  62.6%  9294  732s
H  192   243                    22649.851253 36659.4730  61.9%  8033  732s
H  197   243                    22781.069144 36659.4730  60.9%  7909  732s
H  238   243                    22809.907685 36659.4730  60.7%  7294  732s
   242   301 32518.2426   13  351 22809.9077 36659.4730  60.7%  7300  753s
   300   346 32162.3294   15  355 22809.9077 36659.4730  60.7%  6919  764s
H  329   346                    23001.009227 36659.4730  59.4%  6515  765s
   345   416 32109.1745   16  351 23001.0092 36659.4730  59.4%  6451  781s
   415   472 32536.6709   23  371 23001.0092 36659.4730  59.4%  5962  803s
H  421   472                    23091.787448 36659.4730  58.8%  5928  803s
   471   521 31660.1520   19  282 23091.7874 36659.4730  58.8%  5712  826s
   520   571 30035.4885   20  289 23091.7874 36659.4730  58.8%  5574  845s
   570   610 29999.9903   21  281 23091.7874 36659.4730  58.8%  5431  866s
   609   655 29689.6455   22  287 23091.7874 36659.4730  58.8%  5366  888s
   670   711 29325.8976   24  283 23091.7874 36659.4730  58.8%  5211  910s
   748   748 29245.8719   28  261 23091.7874 36659.4730  58.8%  4934  931s
   809   791 28866.2691   32  278 23091.7874 36659.4730  58.8%  4817  953s
   874   832 28697.9142   38  275 23091.7874 36659.4730  58.8%  4690  967s
   935   875 28336.7479   44  259 23091.7874 36659.4730  58.8%  4634  984s
  1008   911 27630.8823   49  286 23091.7874 36539.5413  58.2%  4564 1000s
  1067   951 27590.8640   50  320 23091.7874 36539.5413  58.2%  4517 1016s
H 1091   951                    23205.505713 36539.5413  57.5%  4465 1016s
  1128   996 27541.5897   51  319 23205.5057 36539.5413  57.5%  4461 1033s
  1227  1026 24555.5204   52  178 23205.5057 36278.1386  56.3%  4375 1051s
  1309  1077 24401.1141   55  229 23205.5057 36278.1386  56.3%  4320 1070s
  1382  1133     cutoff   63      23205.5057 36278.1386  56.3%  4339 1091s
  1469  1204 32423.6549   12  413 23205.5057 36185.2999  55.9%  4309 1112s
  1565  1275 31177.1560   13  357 23205.5057 36185.2999  55.9%  4270 1131s
  1684  1302 30751.5814   14  300 23205.5057 36185.2999  55.9%  4196 1149s
H 1687  1302                    23232.720642 36185.2999  55.8%  4198 1149s
H 1709  1302                    23236.788330 36185.2999  55.7%  4213 1149s
  1721  1371 28529.3142   15  212 23236.7883 36185.2999  55.7%  4243 1171s
  1838  1494 27471.4018   16  199 23236.7883 36155.6333  55.6%  4189 1193s
  1991  1560 25616.1372   22  186 23236.7883 36155.6333  55.6%  4085 1230s
  2104  1680 25453.5994   26  170 23236.7883 36155.6333  55.6%  4053 1255s
  2286  1704 24057.2867   39  127 23236.7883 35670.9475  53.5%  3938 1274s
H 2295  1704                    23274.415176 35670.9475  53.3%  3932 1274s
  2326  1750 23911.0948   40  117 23274.4152 35670.9475  53.3%  3946 1299s
  2457  1807 24758.2913   29  303 23274.4152 35610.6142  53.0%  3927 1325s
  2588  1835 30133.4575   11  306 23274.4152 35610.6142  53.0%  3923 1351s
H 2616  1833                    23452.096565 35610.6142  51.8%  3924 1351s
  2652  1886 29838.6157   12  248 23452.0966 35610.6142  51.8%  3945 1379s
  2769  1980 27441.1302   14  288 23452.0966 35485.5337  51.3%  3982 1409s
  2891  2115 26960.8477   17  279 23452.0966 35485.5337  51.3%  4018 1438s
  3058  2281 26537.2878   23  262 23452.0966 35485.5337  51.3%  4007 1469s
  3321  2385 25265.7271   29  298 23452.0966 35370.8503  50.8%  3892 1502s
  3564  2469 24489.4438   41  184 23452.0966 35348.8737  50.7%  3821 1534s
  3754  2504 32124.8208   13  374 23452.0966 35348.8737  50.7%  3814 1561s
H 3759  2503                    23516.821050 35348.8737  50.3%  3816 1561s
H 3760  2255                    24569.389992 35348.8737  43.9%  3819 1561s
  3817  2295 30690.5442   14  328 24569.3900 35348.8737  43.9%  3826 1599s
  3957  2358 27326.7196   16  286 24569.3900 35294.4975  43.7%  3872 1636s
  4128  2425     cutoff   16      24569.3900 35234.8423  43.4%  3904 1676s
  4291  2497 33853.8955    6  432 24569.3900 35234.8423  43.4%  3950 1716s
* 4361  2483              34    24601.329276 34918.1101  41.9%  3950 1716s
  4487  2582 30337.2513    8  328 24601.3293 34918.1101  41.9%  3968 1756s
H 4682  2488                    24865.306224 34918.1101  40.4%  4006 1781s
H 4682  2483                    24884.666491 34918.1101  40.3%  4006 1787s
H 4682  2462                    24941.733705 34918.1101  40.0%  4006 1849s
H 4682  2461                    24944.701500 34918.1101  40.0%  4006 1857s
H 4682  2460                    24947.481111 34918.1101  40.0%  4006 1865s
H 4682  2313                    25266.078746 34918.1101  38.2%  4006 1983s
  4683  2305 28532.4832   19  475 25266.0787 34918.1101  38.2%  4005 2047s
  4685  2306 33024.7007   12  227 25266.0787 34918.1101  38.2%  4004 2058s
  4686  2307 25881.8798   29  389 25266.0787 34918.1101  38.2%  4003 2107s
  4687  2308 28803.9346   28  398 25266.0787 34918.1101  38.2%  4002 2145s
  4688  2308 32807.3362   13  419 25266.0787 34918.1101  38.2%  4001 2167s
H 4688  2192                    25288.219529 34918.1101  38.1%  4001 2188s
H 4688  2082                    25296.364230 34918.1101  38.0%  4001 2188s
  4690  2084 27578.3838   17  470 25296.3642 34918.1101  38.0%  3999 2202s
  4691  2084 25296.3642   43  475 25296.3642 34918.1101  38.0%  3999 2211s
  4692  2085 28312.9409   18  439 25296.3642 34918.1101  38.0%  3998 2219s
  4693  2086 27357.8474   22  493 25296.3642 34918.1101  38.0%  3997 2225s
  4694  2086 26048.3968   54  473 25296.3642 34918.1101  38.0%  3996 2233s
  4695  2087 31179.9244   17  483 25296.3642 34918.1101  38.0%  3995 2238s
  4696  2088 27397.1210   21  483 25296.3642 34918.1101  38.0%  3994 2244s
  4697  2088 28288.4315   21  487 25296.3642 34918.1101  38.0%  3993 2247s
  4698  2089 29384.3092   17  476 25296.3642 34918.1101  38.0%  3993 2259s
  4699  2090 31595.3478   13  487 25296.3642 34918.1101  38.0%  3992 2264s
  4700  2090 29887.8937   14  489 25296.3642 34918.1101  38.0%  3991 2268s
  4701  2091 30133.3350   12  493 25296.3642 34918.1101  38.0%  3990 2271s
  4703  2092 26048.3968   54  435 25296.3642 34918.1101  38.0%  3988 2282s
  4704  2093 29840.5965   21  441 25296.3642 34918.1101  38.0%  3988 2286s
  4706  2094 26041.3474   21  432 25296.3642 34918.1101  38.0%  3986 2295s
  4707  2095 28795.8320   16  443 25296.3642 34918.1101  38.0%  3985 2301s
  4708  2096 30849.6800   15  474 25296.3642 34918.1101  38.0%  3984 2306s
  4709  2096 32944.7651    8  414 25296.3642 34918.1101  38.0%  3983 2313s
  4710  2097 33986.3859    7  448 25296.3642 34918.1101  38.0%  3982 2317s
  4711  2098 25538.7849   28  476 25296.3642 34918.1101  38.0%  3982 2322s
H 4711  1993                    25614.641032 34918.1101  36.3%  3982 2329s
  4712  1993 32257.3244   11  480 25614.6410 34918.1101  36.3%  3981 2334s
  4713  1994 34375.8537   10  523 25614.6410 34918.1101  36.3%  3980 2338s
  4714  1995 27610.8255   27  527 25614.6410 34918.1101  36.3%  3979 2341s
  4716  1996 26674.7280   20  450 25614.6410 34918.1101  36.3%  3977 2350s
  4718  1997 26558.0248   19  451 25614.6410 34918.1101  36.3%  3976 2360s
  4719  1998 27229.3379   16  456 25614.6410 34918.1101  36.3%  3975 2365s
  4721  1999 27382.4134   21  468 25614.6410 34918.1101  36.3%  3973 2374s
  4722  2000 25614.6410   49  461 25614.6410 34918.1101  36.3%  3972 2377s
  4723  2001 26486.2556   27  497 25614.6410 34918.1101  36.3%  3971 2387s
  4724  2001 30302.4964   13  497 25614.6410 34918.1101  36.3%  3971 2399s
  4725  2002 33168.5600    9  497 25614.6410 34918.1101  36.3%  3970 2452s
  4726  2005 34918.1101   11  451 25614.6410 34918.1101  36.3%  4037 2481s
  4727  2006 34918.1101   12  416 25614.6410 34918.1101  36.3%  4038 2495s
  4729  2011 34918.1101   12  433 25614.6410 34918.1101  36.3%  4040 2521s
  4734  2019 34918.1101   13  424 25614.6410 34918.1101  36.3%  4044 2549s
  4744  2036 34784.6719   14  438 25614.6410 34918.1101  36.3%  4058 2577s
  4764  2042 33460.1478   15  403 25614.6410 34918.1101  36.3%  4131 2619s
  4777  2064 33183.1938   16  400 25614.6410 34918.1101  36.3%  4160 2650s
  4803  2153 33147.4736   17  395 25614.6410 34918.1101  36.3%  4203 2695s
  4901  2169 31257.7801   20  300 25614.6410 34918.1101  36.3%  4243 2717s
  4952  2195 30632.1852   21  284 25614.6410 34918.1101  36.3%  4283 2739s
  4996  2208 29533.1303   22  211 25614.6410 34918.1101  36.3%  4303 2760s
  5031  2216 28108.9670   23  328 25614.6410 34918.1101  36.3%  4329 2787s
  5085  2220 25775.7602   24  208 25614.6410 34918.1101  36.3%  4349 2810s
  5136  2216 27514.6012   23  214 25614.6410 34918.1101  36.3%  4381 2837s
  5192  2206 26875.1551   24  188 25614.6410 34918.1101  36.3%  4391 2866s
  5255  2200     cutoff   26      25614.6410 34918.1101  36.3%  4403 2887s
  5314  2203 29414.6729   17  364 25614.6410 34918.1101  36.3%  4417 2912s
  5368  2199 28371.4371   18  343 25614.6410 34918.1101  36.3%  4423 2932s
  5421  2201 26093.6156   19  348 25614.6410 34918.1101  36.3%  4437 2954s
  5478  2212 25983.1057   20  352 25614.6410 34918.1101  36.3%  4448 2973s
  5542  2228 27084.9427   20  346 25614.6410 34918.1101  36.3%  4456 2992s
  5607  2229 26572.3545   22  334 25614.6410 34918.1101  36.3%  4457 3011s
  5676  2230 26254.3342   24  277 25614.6410 34918.1101  36.3%  4456 3042s
  5760  2215 26492.8148   27  209 25614.6410 34509.7971  34.7%  4437 3060s
  5811  2214 26095.2447   28  313 25614.6410 34509.7971  34.7%  4444 3080s
  5862  2210 25682.5935   30  321 25614.6410 34509.7971  34.7%  4445 3103s
  5938  2206 28064.3578   27  214 25614.6410 34509.7971  34.7%  4447 3128s
  6022  2185 26728.0113   30  156 25614.6410 34509.7971  34.7%  4446 3149s
  6080  2193 26173.8436   31  206 25614.6410 34509.7971  34.7%  4456 3174s
  6172  2167 25768.5659   33  169 25614.6410 34509.7971  34.7%  4445 3199s
  6269  2174 29776.6853   19  266 25614.6410 33785.9670  31.9%  4443 3224s
  6358  2159 27241.1258   21  244 25614.6410 33785.9670  31.9%  4453 3248s
  6412  2174     cutoff   22      25614.6410 33785.9670  31.9%  4463 3284s
  6484  2165     cutoff   21      25614.6410 33785.9670  31.9%  4476 3316s
  6594  2175 25886.3013   23  274 25614.6410 33785.9670  31.9%  4481 3349s
  6711  2195     cutoff   25      25614.6410 33785.9670  31.9%  4484 3385s
  6860  2205 29844.4182   18  375 25614.6410 33785.9670  31.9%  4475 3431s
  7014  2179 28665.4670   21  340 25614.6410 33785.9670  31.9%  4471 3470s
  7124  2160 28234.1226   22  320 25614.6410 33785.9670  31.9%  4477 3508s
  7260  2128 27288.6812   24  307 25614.6410 33785.9670  31.9%  4488 3541s
  7324  2146 27091.2001   25  301 25614.6410 32438.1082  26.6%  4503 3577s
  7441  2133 26057.3147   21  220 25614.6410 32438.1082  26.6%  4513 3600s

Cutting planes:
  Projected implied bound: 54
  MIR: 741
  Flow cover: 1686
  Zero half: 1
  RLT: 21
  Relax-and-lift: 168

Explored 7554 nodes (34419969 simplex iterations) in 3600.05 seconds (9304.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25614.6 25296.4 25288.2 ... 24601.3

Time limit reached
Best objective 2.561464103162e+04, best bound 3.243810819566e+04, gap 26.6389%
  WARNING: Time limit reached. Using best solution found (gap: 26.64%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 25614.64, θ = 173241.52
  Upper Bound (UB) = 25614.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173241.52
  [DEBUG]   ✓ Scenario 0: θ = 173241.52 ≤ Q = 173241.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2658900c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd9a76ff4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.342764e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6225814.1768
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.565986e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156598.61    0  122 6225814.18 -156598.61   103%     -    0s
H    0     0                    -122572.7141 -156598.61  27.8%     -    0s
H    0     0                    -123276.9224 -156598.61  27.0%     -    0s
H    0     0                    -125525.3447 -156598.61  24.8%     -    0s
     0     0 -139104.60    0   94 -125525.34 -139104.60  10.8%     -    0s
H    0     0                    -135978.9391 -139025.15  2.24%     -    0s
     0     0 -138092.03    0   89 -135978.94 -138092.03  1.55%     -    0s
     0     0 -138010.04    0   96 -135978.94 -138010.04  1.49%     -    0s
H    0     0                    -136944.8304 -138010.04  0.78%     -    0s
H    0     0                    -136971.4596 -138010.04  0.76%     -    0s
H    0     0                    -136976.1160 -137683.98  0.52%     -    0s
     0     0 -137683.98    0   68 -136976.12 -137683.98  0.52%     -    0s
H    0     0                    -136977.1333 -137470.50  0.36%     -    0s
     0     0 -137470.50    0   47 -136977.13 -137470.50  0.36%     -    0s
     0     0 -137468.51    0   34 -136977.13 -137468.51  0.36%     -    0s
     0     0 -137424.34    0   44 -136977.13 -137424.34  0.33%     -    0s
H    0     0                    -136993.7099 -137415.81  0.31%     -    0s
     0     0 -137415.81    0   45 -136993.71 -137415.81  0.31%     -    0s
     0     0 -137351.01    0   45 -136993.71 -137351.01  0.26%     -    0s
     0     0 -137330.27    0   45 -136993.71 -137330.27  0.25%     -    0s
     0     0 -137330.27    0   60 -136993.71 -137330.27  0.25%     -    0s
     0     0 -137330.27    0   38 -136993.71 -137330.27  0.25%     -    0s
     0     0 -137279.61    0   41 -136993.71 -137279.61  0.21%     -    0s
     0     0 -137243.35    0   34 -136993.71 -137243.35  0.18%     -    0s
     0     0 -137128.44    0   27 -136993.71 -137128.44  0.10%     -    0s
     0     0 -137124.88    0   27 -136993.71 -137124.88  0.10%     -    0s
     0     0 -137107.32    0   35 -136993.71 -137107.32  0.08%     -    0s
     0     0 -137098.51    0   34 -136993.71 -137098.51  0.08%     -    0s
     0     0 -137095.25    0   25 -136993.71 -137095.25  0.07%     -    0s
     0     0 -137084.99    0   35 -136993.71 -137084.99  0.07%     -    0s
     0     0 -137082.87    0   25 -136993.71 -137082.87  0.07%     -    0s
     0     0 -137065.41    0   35 -136993.71 -137065.41  0.05%     -    0s
     0     0 -137065.41    0   29 -136993.71 -137065.41  0.05%     -    0s
     0     0 -137065.41    0   27 -136993.71 -137065.41  0.05%     -    0s
H    0     0                    -136997.0416 -137065.41  0.05%     -    0s
     0     0 -137065.41    0   25 -136997.04 -137065.41  0.05%     -    0s
     0     0 -137065.41    0   26 -136997.04 -137065.41  0.05%     -    0s
     0     0 -137063.31    0   25 -136997.04 -137063.31  0.05%     -    0s
     0     0 -137058.59    0   25 -136997.04 -137058.59  0.04%     -    0s
     0     0 -137046.93    0   23 -136997.04 -137046.93  0.04%     -    0s
     0     0 -137046.03    0   23 -136997.04 -137046.03  0.04%     -    0s
     0     2 -137046.03    0   23 -136997.04 -137046.03  0.04%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 38
  Flow cover: 13

Explored 5 nodes (1291 simplex iterations) in 0.12 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -136997 -136994 -136977 ... 6.22581e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.369970415546e+05, best bound -1.370085218361e+05, gap 0.0084%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 161425.37
  Scenario: 45 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136997.04
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -136997.04 = 161425.37
  [DEBUG]   Current θ from Master = 173241.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11816.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13798.49
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 1836.1636, Absolute Gap = 1836.1636, Relative Gap = 0.071684
  Not converged yet (gap = 1836.16 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 14 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480994 nonzeros
Model fingerprint: 0xf2c57308
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80112 rows and 32532 columns
Presolve time: 1.36s
Presolved: 89461 rows, 38368 columns, 545369 nonzeros
Variable types: 36109 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -325498.4012
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.311e+06
 Factor NZ  : 7.434e+06 (roughly 110 MB of memory)
 Factor Ops : 1.292e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67918764e+07  1.60336120e+08  1.05e+05 1.97e+01  7.46e+04     2s
   1  -1.22938592e+07  1.44940210e+08  7.10e+04 7.43e+01  5.00e+04     3s
   2  -3.86678728e+06  1.11719730e+08  2.25e+04 7.60e-01  1.68e+04     3s
   3  -9.20843748e+05  7.86223998e+07  2.78e+03 1.77e+00  2.41e+03     3s
   4  -4.71654332e+05  4.09769470e+07  4.57e+02 6.49e-01  5.41e+02     3s
   5  -3.54498352e+05  2.36268579e+07  1.46e+02 3.12e-01  2.29e+02     3s
   6  -2.75692820e+05  1.68966362e+07  4.76e+01 2.09e-01  1.29e+02     3s
   7  -1.64444907e+05  1.20944787e+07  1.29e+01 1.44e-01  8.00e+01     3s
   8  -9.23721425e+04  7.63425160e+06  5.03e+00 9.04e-02  4.85e+01     3s
   9  -7.40290858e+04  4.07621572e+06  2.71e+00 4.73e-02  2.57e+01     3s
  10  -4.76123298e+04  1.34578892e+06  1.26e+00 1.52e-02  8.56e+00     3s
  11  -1.11170602e+04  3.36600579e+05  3.71e-01 3.04e-03  2.13e+00     3s
  12   6.57385365e+02  2.11095772e+05  2.68e-01 2.21e-03  1.29e+00     3s
  13   5.89719899e+03  1.64341292e+05  2.29e-01 1.55e-03  9.68e-01     3s
  14   1.32770907e+04  1.35711509e+05  1.82e-01 1.33e-03  7.48e-01     3s
  15   1.80822873e+04  1.21951276e+05  1.55e-01 1.71e-03  6.34e-01     3s
  16   2.29506893e+04  1.04358160e+05  1.30e-01 1.46e-03  4.97e-01     3s
  17   2.67755996e+04  9.59109795e+04  1.11e-01 1.04e-03  4.22e-01     3s
  18   3.40795731e+04  8.37607123e+04  7.69e-02 1.04e-03  3.03e-01     3s
  19   3.75092922e+04  7.50468805e+04  6.21e-02 1.26e-03  2.29e-01     3s
  20   4.16178720e+04  7.08964896e+04  4.49e-02 1.14e-03  1.79e-01     3s
  21   4.37139455e+04  6.74679659e+04  3.67e-02 8.87e-04  1.45e-01     3s
  22   4.69342806e+04  6.37178882e+04  2.52e-02 9.91e-04  1.02e-01     3s
  23   4.85141376e+04  6.12833771e+04  1.96e-02 7.23e-04  7.79e-02     3s
  24   5.00661167e+04  5.99046311e+04  1.44e-02 5.73e-04  6.00e-02     3s
  25   5.11681371e+04  5.78749417e+04  1.06e-02 3.58e-04  4.09e-02     3s
  26   5.15681749e+04  5.68311830e+04  9.22e-03 2.65e-04  3.21e-02     3s
  27   5.22581570e+04  5.65860005e+04  7.09e-03 2.30e-04  2.64e-02     3s
  28   5.27657389e+04  5.60671379e+04  5.43e-03 1.68e-04  2.01e-02     3s
  29   5.31783962e+04  5.55077408e+04  4.14e-03 1.03e-04  1.42e-02     3s
  30   5.36572986e+04  5.52883282e+04  2.72e-03 7.60e-05  9.95e-03     4s
  31   5.38466251e+04  5.51806174e+04  2.19e-03 6.22e-05  8.14e-03     4s
  32   5.39295481e+04  5.50359419e+04  1.95e-03 5.26e-05  6.75e-03     4s
  33   5.41015472e+04  5.48730572e+04  1.47e-03 7.18e-05  4.71e-03     4s
  34   5.42630436e+04  5.47803865e+04  1.04e-03 3.88e-05  3.16e-03     4s
  35   5.43590597e+04  5.47552296e+04  7.84e-04 2.92e-05  2.42e-03     4s
  36   5.44261701e+04  5.47121919e+04  6.13e-04 4.72e-05  1.75e-03     4s
  37   5.44893705e+04  5.47015365e+04  4.51e-04 3.37e-05  1.29e-03     4s
  38   5.45311804e+04  5.46930157e+04  3.44e-04 2.38e-05  9.88e-04     4s
  39   5.45824290e+04  5.46849192e+04  2.14e-04 1.49e-05  6.25e-04     4s
  40   5.45850977e+04  5.46827537e+04  2.07e-04 1.27e-05  5.96e-04     4s
  41   5.45882975e+04  5.46820240e+04  1.99e-04 1.20e-05  5.72e-04     4s
  42   5.46032764e+04  5.46797618e+04  1.64e-04 9.43e-06  4.67e-04     4s
  43   5.46078828e+04  5.46784016e+04  1.52e-04 8.08e-06  4.30e-04     4s
  44   5.46116696e+04  5.46761220e+04  1.43e-04 6.77e-06  3.93e-04     4s
  45   5.46144412e+04  5.46755366e+04  1.36e-04 6.14e-06  3.73e-04     4s
  46   5.46190508e+04  5.46752150e+04  1.25e-04 5.68e-06  3.43e-04     4s
  47   5.46218931e+04  5.46737822e+04  1.18e-04 3.99e-06  3.17e-04     4s
  48   5.46296532e+04  5.46734167e+04  9.91e-05 3.63e-06  2.67e-04     4s
  49   5.46345856e+04  5.46731346e+04  8.69e-05 3.36e-06  2.35e-04     4s
  50   5.46403990e+04  5.46720224e+04  7.26e-05 2.92e-06  1.93e-04     4s
  51   5.46429942e+04  5.46719794e+04  6.62e-05 2.82e-06  1.77e-04     4s
  52   5.46526951e+04  5.46716869e+04  4.19e-05 2.22e-06  1.16e-04     5s
  53   5.46572994e+04  5.46712825e+04  3.05e-05 1.62e-06  8.53e-05     5s
  54   5.46593685e+04  5.46709849e+04  2.54e-05 1.10e-06  7.09e-05     5s
  55   5.46596551e+04  5.46708883e+04  2.47e-05 9.69e-07  6.86e-05     5s
  56   5.46649147e+04  5.46704266e+04  1.16e-05 2.11e-07  3.36e-05     5s
  57   5.46680460e+04  5.46703383e+04  4.57e-06 1.44e-07  1.40e-05     5s
  58   5.46688695e+04  5.46703135e+04  2.73e-06 1.23e-07  8.81e-06     5s
  59   5.46695852e+04  5.46702284e+04  1.14e-06 7.96e-08  3.92e-06     5s
  60   5.46697729e+04  5.46702051e+04  7.67e-07 4.61e-08  2.64e-06     5s
  61   5.46700046e+04  5.46701899e+04  3.03e-07 2.74e-08  1.13e-06     5s
  62   5.46701575e+04  5.46701655e+04  1.44e-08 4.47e-10  4.83e-08     5s
  63   5.46701584e+04  5.46701654e+04  5.43e-07 1.06e-07  4.21e-08     5s
  64   5.46701646e+04  5.46701652e+04  7.99e-08 4.06e-09  3.71e-09     5s
  65   5.46701652e+04  5.46701652e+04  1.20e-08 1.46e-10  1.40e-10     5s

Barrier solved model in 65 iterations and 5.06 seconds (9.60 work units)
Optimal objective 5.46701652e+04


Root crossover log...

   76472 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1854 PPushes remaining with PInf 2.1337493e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.0008959e-01      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34245    5.4670165e+04   0.000000e+00   3.000896e-01      8s
   34248    5.4670165e+04   0.000000e+00   0.000000e+00      8s
   34248    5.4670165e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.467017e+04, 34248 iterations, 5.87 seconds (13.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54670.1652    0  286 -207405.59 54670.1652   126%     -    8s
H    0     0                    -100481.4983 54670.1652   154%     -    8s
H    0     0                    -98201.56209 54670.1652   156%     -    8s
H    0     0                    -64507.15808 54670.1652   185%     -    8s
H    0     0                    -63739.38008 54670.1652   186%     -    8s
H    0     0                    -63699.76613 54670.1652   186%     -    8s
H    0     0                    -63699.76530 54670.1652   186%     -    8s
H    0     0                    -63048.93979 54670.1652   187%     -    8s
H    0     0                    -2719.884715 54670.1652  2110%     -    8s
H    0     0                    -939.3853853 54670.1652  5920%     -    8s
H    0     0                    -753.7230335 54670.1652  7353%     -    9s
H    0     0                    -116.7728433 54670.1652      -     -    9s
H    0     0                    -107.2638232 54670.1652      -     -    9s
H    0     0                     -80.7561005 54670.1652      -     -    9s
H    0     0                     -60.3099675 54670.1652      -     -    9s
H    0     0                     -44.2475261 54670.1652      -     -    9s
     0     0 47225.6213    0  321  -44.24753 47225.6213      -     -   45s
H    0     0                     995.4698240 47225.6213  4644%     -   46s
H    0     0                    1489.7099357 47225.6213  3070%     -   46s
H    0     0                    1493.3828088 47225.6213  3062%     -   46s
H    0     0                    1687.0676445 47225.6213  2699%     -   46s
     0     0 47183.4015    0  341 1687.06764 47183.4015  2697%     -   56s
     0     0 47037.5076    0  337 1687.06764 47037.5076  2688%     -   60s
     0     0 46971.2613    0  331 1687.06764 46971.2613  2684%     -   64s
     0     0 46971.2613    0  343 1687.06764 46971.2613  2684%     -   65s
     0     0 46971.2613    0  343 1687.06764 46971.2613  2684%     -   69s
     0     0 46971.2613    0  344 1687.06764 46971.2613  2684%     -   74s
     0     0 46971.2613    0  349 1687.06764 46971.2613  2684%     -   82s
     0     0 46971.2613    0  352 1687.06764 46971.2613  2684%     -   83s
     0     0 46971.2613    0  349 1687.06764 46971.2613  2684%     -   83s
     0     0 46971.2613    0  347 1687.06764 46971.2613  2684%     -   84s
H    0     0                    2040.9142923 43434.5380  2028%     -  137s
H    0     0                    2125.3644791 43434.5380  1944%     -  137s
H    0     0                    2155.8297265 43434.5380  1915%     -  137s
H    0     0                    2258.2282128 43434.5380  1823%     -  137s
H    0     0                    2304.8212527 43434.5380  1785%     -  137s
H    0     0                    2330.5164186 43434.5380  1764%     -  137s
H    0     0                    2336.8318681 43434.5380  1759%     -  137s
H    0     0                    2371.8851361 43434.5380  1731%     -  137s
     0     0 43434.5380    0  362 2371.88514 43434.5380  1731%     -  137s
H    0     0                    6816.3068681 43434.5004   537%     -  137s
H    0     0                    7676.8611463 43434.5004   466%     -  137s
H    0     0                    7740.6041966 43434.5004   461%     -  137s
H    0     0                    7802.4434487 43434.5004   457%     -  137s
H    0     0                    7808.8685202 43434.5004   456%     -  137s
     0     0 42710.6397    0  370 7808.86852 42710.6397   447%     -  170s
     0     0 42576.3929    0  414 7808.86852 42576.3929   445%     -  185s
     0     0 42328.0012    0  390 7808.86852 42328.0012   442%     -  202s
     0     0 42216.6599    0  386 7808.86852 42216.6599   441%     -  213s
     0     0 42193.4476    0  398 7808.86852 42193.4476   440%     -  221s
     0     0 42155.8506    0  399 7808.86852 42155.8506   440%     -  227s
     0     0 42093.2473    0  405 7808.86852 42093.2473   439%     -  235s
     0     0 42059.9166    0  391 7808.86852 42059.9166   439%     -  239s
     0     0 42040.4784    0  397 7808.86852 42040.4784   438%     -  242s
     0     0 42037.9995    0  398 7808.86852 42037.9995   438%     -  243s
     0     0 42029.9138    0  394 7808.86852 42029.9138   438%     -  245s
     0     0 42009.0075    0  388 7808.86852 42009.0075   438%     -  249s
     0     0 42005.7729    0  398 7808.86852 42005.7729   438%     -  252s
     0     0 42003.9858    0  397 7808.86852 42003.9858   438%     -  253s
     0     0 42002.2886    0  403 7808.86852 42002.2886   438%     -  254s
     0     0 41998.4491    0  402 7808.86852 41998.4491   438%     -  256s
     0     0 41998.2588    0  402 7808.86852 41998.2588   438%     -  256s
H    0     0                    8179.5246313 40389.8521   394%     -  312s
H    0     0                    9328.0944798 40389.8521   333%     -  312s
H    0     0                    9333.8733274 40389.8521   333%     -  312s
H    0     0                    9450.2642804 40389.8521   327%     -  312s
H    0     0                    9717.2917172 40389.8521   316%     -  312s
H    0     0                    9863.1116957 40389.8521   310%     -  312s
     0     0 40389.8521    0  398 9863.11170 40389.8521   310%     -  312s
H    0     0                    10791.616352 40389.3441   274%     -  312s
H    0     0                    11383.772760 40389.3441   255%     -  312s
H    0     0                    11751.636504 40389.3441   244%     -  312s
     0     0 40079.5208    0  431 11751.6365 40079.5208   241%     -  332s
     0     0 40000.4580    0  447 11751.6365 40000.4580   240%     -  341s
     0     0 39986.9256    0  450 11751.6365 39986.9256   240%     -  346s
     0     0 39890.1824    0  430 11751.6365 39890.1824   239%     -  354s
     0     0 39802.9476    0  438 11751.6365 39802.9476   239%     -  361s
     0     0 39792.6087    0  445 11751.6365 39792.6087   239%     -  364s
     0     0 39789.3637    0  449 11751.6365 39789.3637   239%     -  366s
     0     0 39774.0474    0  442 11751.6365 39774.0474   238%     -  368s
     0     0 39762.9409    0  438 11751.6365 39762.9409   238%     -  370s
     0     0 39757.6308    0  444 11751.6365 39757.6308   238%     -  373s
     0     0 39701.0167    0  442 11751.6365 39701.0167   238%     -  377s
     0     0 39688.2457    0  440 11751.6365 39688.2457   238%     -  379s
     0     0 39673.2825    0  446 11751.6365 39673.2825   238%     -  382s
     0     0 39671.7935    0  446 11751.6365 39671.7935   238%     -  383s
     0     0 39015.0755    0  401 11751.6365 39015.0755   232%     -  403s
     0     0 38882.9362    0  458 11751.6365 38882.9362   231%     -  414s
     0     0 38797.3769    0  485 11751.6365 38797.3769   230%     -  424s
     0     0 38707.1684    0  464 11751.6365 38707.1684   229%     -  433s
     0     0 38683.4158    0  481 11751.6365 38683.4158   229%     -  438s
     0     0 38639.6476    0  433 11751.6365 38639.6476   229%     -  445s
     0     0 38634.7140    0  477 11751.6365 38634.7140   229%     -  448s
     0     0 38632.9901    0  472 11751.6365 38632.9901   229%     -  449s
     0     0 38483.1929    0  451 11751.6365 38483.1929   227%     -  458s
     0     0 38412.2236    0  446 11751.6365 38412.2236   227%     -  466s
     0     0 38386.9622    0  456 11751.6365 38386.9622   227%     -  468s
     0     0 38368.6869    0  459 11751.6365 38368.6869   226%     -  470s
     0     0 38357.0501    0  454 11751.6365 38357.0501   226%     -  473s
     0     0 38354.2936    0  458 11751.6365 38354.2936   226%     -  474s
     0     0 38348.7383    0  464 11751.6365 38348.7383   226%     -  476s
     0     0 38340.1326    0  460 11751.6365 38340.1326   226%     -  477s
     0     0 38338.9878    0  439 11751.6365 38338.9878   226%     -  478s
     0     0 38204.0935    0  469 11751.6365 38204.0935   225%     -  488s
H    0     0                    12198.949196 38202.1272   213%     -  492s
     0     0 38156.5668    0  495 12198.9492 38156.5668   213%     -  500s
     0     0 38145.7179    0  484 12198.9492 38145.7179   213%     -  504s
     0     0 38134.9396    0  497 12198.9492 38134.9396   213%     -  507s
     0     0 38128.1898    0  499 12198.9492 38128.1898   213%     -  508s
     0     0 38115.5014    0  462 12198.9492 38115.5014   212%     -  510s
     0     0 38109.2550    0  487 12198.9492 38109.2550   212%     -  513s
     0     0 38102.8047    0  484 12198.9492 38102.8047   212%     -  515s
     0     0 38101.0014    0  483 12198.9492 38101.0014   212%     -  516s
     0     0 38007.1203    0  484 12198.9492 38007.1203   212%     -  526s
H    0     0                    13498.648561 38007.0866   182%     -  527s
     0     0 37968.2728    0  539 13498.6486 37968.2728   181%     -  537s
     0     0 37962.3294    0  493 13498.6486 37962.3294   181%     -  540s
     0     0 37959.1002    0  459 13498.6486 37959.1002   181%     -  541s
     0     0 37954.1774    0  500 13498.6486 37954.1774   181%     -  542s
     0     0 37950.2297    0  492 13498.6486 37950.2297   181%     -  543s
     0     0 37949.3589    0  494 13498.6486 37949.3589   181%     -  545s
     0     0 37915.2893    0  530 13498.6486 37915.2893   181%     -  551s
H    0     0                    14871.031572 37914.9805   155%     -  553s
H    0     0                    15763.994139 37914.9805   141%     -  553s
H    0     0                    15820.913748 37914.9805   140%     -  553s
H    0     0                    16756.824035 37914.9805   126%     -  553s
H    0     0                    17185.889090 37914.9805   121%     -  553s
     0     0 37900.2506    0  530 17185.8891 37900.2506   121%     -  556s
     0     0 37898.2852    0  523 17185.8891 37898.2852   121%     -  558s
     0     0 37876.9174    0  443 17185.8891 37876.9174   120%     -  564s
H    0     0                    17265.567042 37876.8975   119%     -  564s
H    0     0                    17367.281932 37876.8975   118%     -  564s
H    0     0                    17416.428201 37876.8975   117%     -  564s
H    0     0                    17495.657999 37876.8975   116%     -  564s
H    0     0                    17554.039157 37876.8975   116%     -  564s
H    0     0                    17596.497561 37876.8975   115%     -  564s
     0     0 37869.2567    0  428 17596.4976 37869.2567   115%     -  567s
     0     0 37866.4904    0  441 17596.4976 37866.4904   115%     -  568s
     0     0 37864.1683    0  442 17596.4976 37864.1683   115%     -  569s
     0     0 37844.0850    0  436 17596.4976 37844.0850   115%     -  575s
H    0     0                    20206.043885 37843.9813  87.3%     -  581s
H    0     0                    20807.151609 37843.9813  81.9%     -  581s
H    0     0                    21226.846755 37843.9813  78.3%     -  581s
H    0     0                    21894.004867 37843.9813  72.9%     -  581s
     0     0 37836.3023    0  480 21894.0049 37836.3023  72.8%     -  584s
     0     0 37832.6234    0  437 21894.0049 37832.6234  72.8%     -  585s
     0     0 37831.3714    0  437 21894.0049 37831.3714  72.8%     -  586s
     0     0 37816.6979    0  478 21894.0049 37816.6979  72.7%     -  589s
H    0     0                    21898.633556 37816.0510  72.7%     -  589s
H    0     0                    21924.002548 37816.0510  72.5%     -  589s
H    0     0                    21973.524596 37816.0510  72.1%     -  589s
H    0     0                    22005.355562 37816.0510  71.8%     -  589s
H    0     0                    22026.678063 37816.0510  71.7%     -  589s
     0     0 37813.7328    0  534 22026.6781 37813.7328  71.7%     -  591s
     0     0 37812.9426    0  506 22026.6781 37812.9426  71.7%     -  592s
     0     0 37793.7868    0  438 22026.6781 37793.7868  71.6%     -  597s
H    0     0                    22223.903639 37793.7702  70.1%     -  598s
H    0     0                    22786.009982 37793.7702  65.9%     -  598s
H    0     0                    22846.469978 37793.7702  65.4%     -  599s
H    0     0                    22989.188222 37793.7702  64.4%     -  599s
     0     0 37788.9584    0  499 22989.1882 37788.9584  64.4%     -  601s
     0     0 37786.5999    0  444 22989.1882 37786.5999  64.4%     -  602s
     0     0 37784.6498    0  448 22989.1882 37784.6498  64.4%     -  604s
     0     0 37784.3224    0  448 22989.1882 37784.3224  64.4%     -  606s
H    0     0                    23141.846857 37784.3224  63.3%     -  659s
H    0     0                    23160.698718 37784.3224  63.1%     -  659s
H    0     0                    23261.966656 37784.3224  62.4%     -  659s
H    0     0                    23344.067282 37784.3224  61.9%     -  701s
H    0     0                    23366.207160 37784.3224  61.7%     -  701s
H    0     0                    23376.858959 37784.3224  61.6%     -  710s
     0     2 37784.3224    0  448 23376.8590 37784.3224  61.6%     -  714s
     1     3 36443.4660    1  487 23376.8590 37783.7598  61.6% 14860  727s
     2     4 37596.5623    1  436 23376.8590 37596.5623  60.8% 11478  734s
     3     7 35535.0727    2  504 23376.8590 37596.4896  60.8% 10791  745s
     6    13 35194.3449    3  415 23376.8590 37596.4896  60.8% 10230  769s
    12    26 36254.9743    3  413 23376.8590 37454.9840  60.2% 12439  789s
    25    39 35717.2512    5  402 23376.8590 37200.8301  59.1% 14488  870s
    38    71 35510.0806    6  430 23376.8590 37200.8301  59.1% 22149 1030s
H   46    71                    23772.669477 37200.8301  56.5% 19957 1030s
    70   154 35376.9166    7  438 23772.6695 37036.5133  55.8% 21116 1064s
   153   251 34966.3967   10  379 23772.6695 37035.6388  55.8% 13924 1089s
   250   302 34898.6393   11  400 23772.6695 37035.6388  55.8% 10493 1109s
   301   341 34809.1849   13  388 23772.6695 37035.6388  55.8%  9832 1130s
   340   391 34428.3499   15  423 23772.6695 37035.6388  55.8%  9721 1149s
   390   416 33397.7131   16  368 23772.6695 37035.6388  55.8%  9531 1167s
   415   447 34967.9323   11  365 23772.6695 37035.6388  55.8%  9452 1186s
   448   471 34923.6056   12  360 23772.6695 37035.6388  55.8%  9380 1204s
   472   495 30704.6716   19  323 23772.6695 37035.6388  55.8%  9286 1224s
H  476   495                    23782.387984 37035.6388  55.7%  9282 1224s
   498   549 31207.6676   15  340 23782.3880 37035.6388  55.7%  9295 1243s
   558   622 30855.0620   16  334 23782.3880 37035.6388  55.7%  9275 1262s
   635   690 30736.0807   18  321 23782.3880 37035.6388  55.7%  9114 1278s
   707   740 30113.7387   17  196 23782.3880 37035.6388  55.7%  9018 1294s
   781   767 infeasible   19      23782.3880 37035.6388  55.7%  8963 1312s
   836   796 29915.1747   20  332 23782.3880 37035.6388  55.7%  9002 1329s
   879   855 28812.7026   21  311 23782.3880 37035.6388  55.7%  9208 1347s
   957   916 28526.6872   22  317 23782.3880 37035.6388  55.7%  9169 1368s
  1042   941 28841.6964   15  323 23782.3880 37035.6388  55.7%  8959 1387s
H 1051   941                    24777.847224 37035.6388  49.5%  8949 1387s
  1080   976 26375.6210   23  302 24777.8472 37035.6388  49.5%  8996 1409s
  1178  1009 26154.6032   24  290 24777.8472 37035.6388  49.5%  8794 1432s
  1270  1019 25389.0810   26  269 24777.8472 37035.6388  49.5%  8724 1456s
  1364  1043 25769.0717   27  296 24777.8472 37035.6388  49.5%  8629 1480s
  1448  1071 25563.2337   29  259 24777.8472 36931.7300  49.1%  8649 1506s
  1520  1096 25015.8035   32  241 24777.8472 36931.7300  49.1%  8695 1534s
  1573  1122 infeasible   33      24777.8472 36931.7300  49.1%  8859 1562s
  1623  1148 33465.0835    6  395 24777.8472 36931.7300  49.1%  9066 1584s
H 1625  1148                    24993.786838 36931.7300  47.8%  9056 1584s
  1659  1218 32705.0255    7  373 24993.7868 36931.7300  47.8%  9233 1613s
  1747  1270 30308.6915    9  365 24993.7868 36931.7300  47.8%  9319 1641s
  1857  1363 25193.2580   11  205 24993.7868 36931.7300  47.8%  9259 1670s
  1986  1458     cutoff   12      24993.7868 36931.7300  47.8%  9212 1708s
  2139  1520 infeasible   12      24993.7868 36841.7656  47.4%  9058 1742s
  2284  1600 33498.8845    9  393 24993.7868 36841.7656  47.4%  8994 1775s
  2433  1631 31912.9189   11  341 24993.7868 36841.7656  47.4%  8915 1803s
H 2477  1631                    25214.601677 36841.7656  46.1%  8944 1803s
H 2478  1631                    25228.780697 36841.7656  46.0%  8944 1803s
H 2486  1631                    25349.112749 36841.7656  45.3%  8969 1803s
  2504  1660 31161.7110   12  341 25349.1127 36841.7656  45.3%  8956 1837s
H 2530  1660                    25370.746624 36841.7656  45.2%  8990 1837s
  2563  1679 infeasible   14      25370.7466 36841.7656  45.2%  9066 1873s
  2663  1706 infeasible   14      25370.7466 36841.7656  45.2%  9194 1912s
  2770  1706     cutoff   18      25370.7466 36841.7656  45.2%  9325 1952s
  2897  1752 25679.7529   19  359 25370.7466 36841.7656  45.2%  9393 1993s
  3009  1823 30445.1363   12  388 25370.7466 36841.7656  45.2%  9547 2032s
  3171  1901 28074.4954   14  332 25370.7466 36841.7656  45.2%  9579 2077s
  3352  1920 26435.6738   18  297 25370.7466 35630.5766  40.4%  9553 2110s
H 3353  1910                    25434.443591 35630.5766  40.1%  9550 2110s
  3397  1989 infeasible   19      25434.4436 35630.5766  40.1%  9610 2154s
  3564  2014     cutoff   21      25434.4436 35468.8150  39.5%  9649 2192s
  3605  2063     cutoff   21      25434.4436 35408.0129  39.2%  9709 2240s
  3760  2122 27789.9046    7  419 25434.4436 35383.6304  39.1%  9693 2290s
  3926  2195 infeasible    9      25434.4436 35342.1663  39.0%  9720 2344s
  4123  2251 infeasible    8      25434.4436 35179.5285  38.3%  9737 2401s
  4281  2338 29517.5038   13  344 25434.4436 35179.5285  38.3%  9847 2460s
  4446  2450 26834.9613   17  290 25434.4436 35179.5285  38.3%  9936 2518s
  4659  2451 26146.7252   31  448 25434.4436 34993.7267  37.6%  9960 2710s
  4661  2452 28582.8268   20  245 25434.4436 34993.7267  37.6%  9956 2721s
  4662  2453 28311.9884   27  400 25434.4436 34993.7267  37.6%  9954 2785s
  4663  2454 27594.5603   25  425 25434.4436 34993.7267  37.6%  9952 2835s
  4664  2454 28414.8777   14  438 25434.4436 34993.7267  37.6%  9950 2874s
  4665  2455 30216.0056   16  437 25434.4436 34993.7267  37.6%  9948 2888s
  4666  2456 26408.7002   33  464 25434.4436 34993.7267  37.6%  9945 2908s
  4667  2456 31943.8301   10  462 25434.4436 34993.7267  37.6%  9943 2923s
  4668  2457 26605.2486   14  415 25434.4436 34993.7267  37.6%  9941 2934s
  4669  2458 26064.0038   36  419 25434.4436 34993.7267  37.6%  9939 2942s
  4670  2458 28796.6174    8  447 25434.4436 34993.7267  37.6%  9937 2951s
  4671  2459 29767.5740   12  428 25434.4436 34993.7267  37.6%  9935 2957s
  4672  2460 34525.8294    6  466 25434.4436 34993.7267  37.6%  9933 2978s
  4673  2460 26298.7387   20  492 25434.4436 34993.7267  37.6%  9931 2986s
  4674  2461 31164.6663   13  483 25434.4436 34993.7267  37.6%  9928 2993s
  4675  2462 31164.6663   13  523 25434.4436 34993.7267  37.6%  9926 2998s
  4676  2462 26099.0449   43  438 25434.4436 34993.7267  37.6%  9924 3010s
  4677  2463 26393.6816   43  504 25434.4436 34993.7267  37.6%  9922 3016s
  4678  2464 26733.5419   22  494 25434.4436 34993.7267  37.6%  9920 3022s
  4679  2464 30004.9578   11  510 25434.4436 34993.7267  37.6%  9918 3028s
  4680  2465 30034.9153   15  529 25434.4436 34993.7267  37.6%  9916 3035s
  4681  2466 27394.1281   20  467 25434.4436 34993.7267  37.6%  9914 3049s
  4682  2466 33392.8911    9  452 25434.4436 34993.7267  37.6%  9911 3056s
  4684  2468 26956.8090   22  459 25434.4436 34993.7267  37.6%  9907 3064s
  4685  2468 33490.4837    9  487 25434.4436 34993.7267  37.6%  9905 3079s
  4686  2469 25970.5325   22  491 25434.4436 34993.7267  37.6%  9903 3087s
  4687  2470 34521.5257   12  500 25434.4436 34993.7267  37.6%  9901 3090s
  4689  2471 26340.9705   29  462 25434.4436 34993.7267  37.6%  9897 3097s
  4690  2472 28470.9470   33  502 25434.4436 34993.7267  37.6%  9895 3101s
  4691  2472 28688.4815   28  483 25434.4436 34993.7267  37.6%  9892 3117s
  4692  2473 33290.1941    8  469 25434.4436 34993.7267  37.6%  9890 3122s
  4693  2474 31244.8150   19  497 25434.4436 34993.7267  37.6%  9888 3127s
  4694  2474 25679.6893   26  486 25434.4436 34993.7267  37.6%  9886 3135s
  4696  2476 34668.2026   13  484 25434.4436 34993.7267  37.6%  9882 3142s
  4697  2476 27136.4916   31  480 25434.4436 34993.7267  37.6%  9880 3155s
  4698  2477 27554.4397   24  482 25434.4436 34993.7267  37.6%  9878 3160s
  4699  2478 32507.5979   10  482 25434.4436 34993.7267  37.6%  9876 3167s
  4700  2478 26347.5623   22  511 25434.4436 34993.7267  37.6%  9873 3171s
  4701  2479 26354.9192   33  508 25434.4436 34993.7267  37.6%  9871 3176s
  4702  2480 25968.2150   47  506 25434.4436 34993.7267  37.6%  9869 3181s
  4703  2480 26042.8969   19  506 25434.4436 34993.7267  37.6%  9867 3195s
  4704  2481 29056.0714   15  506 25434.4436 34993.7267  37.6%  9865 3276s
  4705  2485 34993.7267   13  484 25434.4436 34993.7267  37.6%  9953 3408s
  4707  2488 34993.7267   14  408 25434.4436 34993.7267  37.6%  9955 3444s
  4711  2495 34993.7267   15  465 25434.4436 34993.7267  37.6%  9964 3482s
  4719  2508 34993.7267   16  482 25434.4436 34993.7267  37.6%  9975 3542s
  4735  2513 33744.9893   17  493 25434.4436 34993.7267  37.6% 10030 3600s

Cutting planes:
  Learned: 3
  Gomory: 15
  Implied bound: 12
  Projected implied bound: 185
  MIR: 822
  Mixing: 2
  Flow cover: 1115
  Zero half: 1
  RLT: 26
  Relax-and-lift: 232

Explored 4745 nodes (48358360 simplex iterations) in 3600.07 seconds (9628.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25434.4 25370.7 25349.1 ... 23376.9

Time limit reached
Best objective 2.543444359111e+04, best bound 3.499372670006e+04, gap 37.5840%
  WARNING: Time limit reached. Using best solution found (gap: 37.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 25434.44, θ = 172630.77
  Upper Bound (UB) = 25434.44

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172630.77
  [DEBUG]   ✓ Scenario 0: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 172630.77 ≤ Q = 172630.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 172630.77 ≤ Q = 172630.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x557085c1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x557085c1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.337949e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6182216.2003
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.573045e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157304.50    0  121 6182216.20 -157304.50   103%     -    0s
H    0     0                    -123776.8403 -157304.50  27.1%     -    0s
H    0     0                    -124239.1550 -157304.50  26.6%     -    0s
H    0     0                    -124888.1070 -143707.16  15.1%     -    0s
     0     0 -143707.16    0   89 -124888.11 -143707.16  15.1%     -    0s
H    0     0                    -140587.8677 -143630.56  2.16%     -    0s
H    0     0                    -140959.8395 -143630.56  1.89%     -    0s
H    0     0                    -141154.2021 -143630.56  1.75%     -    0s
H    0     0                    -141526.1739 -143630.56  1.49%     -    0s
     0     0 -142287.59    0   80 -141526.17 -142287.59  0.54%     -    0s
H    0     0                    -141529.2454 -142272.03  0.52%     -    0s
     0     0 -142231.71    0   66 -141529.25 -142231.71  0.50%     -    0s
     0     0 -142225.73    0   76 -141529.25 -142225.73  0.49%     -    0s
H    0     0                    -141555.0808 -142225.73  0.47%     -    0s
     0     0 -141913.23    0   24 -141555.08 -141913.23  0.25%     -    0s
     0     0 -141912.29    0   22 -141555.08 -141912.29  0.25%     -    0s
     0     0 -141864.72    0   15 -141555.08 -141864.72  0.22%     -    0s
     0     0 -141863.01    0   15 -141555.08 -141863.01  0.22%     -    0s
     0     0 -141776.13    0   14 -141555.08 -141776.13  0.16%     -    0s
     0     0 -141775.06    0   13 -141555.08 -141775.06  0.16%     -    0s
     0     0 -141749.64    0   15 -141555.08 -141749.64  0.14%     -    0s
     0     0 -141718.42    0   14 -141555.08 -141718.42  0.12%     -    0s
     0     0 -141718.42    0   20 -141555.08 -141718.42  0.12%     -    0s
H    0     0                    -141589.7118 -141718.42  0.09%     -    0s
     0     0 -141650.96    0    8 -141589.71 -141650.96  0.04%     -    0s
H    0     0                    -141625.0691 -141633.25  0.01%     -    0s
     0     0 -141633.25    0    5 -141625.07 -141633.25  0.01%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 9
  Flow cover: 16
  Relax-and-lift: 7

Explored 1 nodes (765 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -141625 -141590 -141555 ... 6.18222e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.416250690677e+05, best bound -1.416332475553e+05, gap 0.0058%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 156797.34
  Scenario: 42 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141625.07
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -141625.07 = 156797.34
  [DEBUG]   Current θ from Master = 172630.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15833.43 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9601.02
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 1655.9661, Absolute Gap = 1655.9661, Relative Gap = 0.065107
  Not converged yet (gap = 1655.97 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 17 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524219 nonzeros
Model fingerprint: 0x211da397
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87384 rows and 35484 columns
Presolve time: 1.60s
Presolved: 97479 rows, 41656 columns, 592487 nonzeros
Variable types: 39397 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -323817.4629
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.783e+06
 Factor NZ  : 8.573e+06 (roughly 130 MB of memory)
 Factor Ops : 1.559e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68127099e+07  1.73348271e+08  1.05e+05 2.06e+01  7.43e+04     3s
   1  -1.24114288e+07  1.56813251e+08  7.17e+04 7.11e+01  5.02e+04     3s
   2  -3.57898968e+06  1.20214752e+08  2.08e+04 6.35e-01  1.55e+04     3s
   3  -8.10705891e+05  8.49984285e+07  2.10e+03 1.51e+00  1.93e+03     3s
   4  -4.72708424e+05  4.86565728e+07  3.51e+02 6.77e-01  4.96e+02     3s
   5  -3.83593877e+05  2.90821033e+07  1.21e+02 3.55e-01  2.33e+02     3s
   6  -3.37608877e+05  2.16618941e+07  6.46e+01 2.51e-01  1.56e+02     3s
   7  -2.50597729e+05  1.59599110e+07  2.41e+01 1.77e-01  1.01e+02     3s
   8  -1.37695076e+05  1.09631460e+07  2.56e+00 1.18e-01  6.30e+01     3s
   9  -8.76004515e+04  6.13244814e+06  1.34e+00 6.54e-02  3.51e+01     3s
  10  -5.71507792e+04  3.23396078e+06  5.76e-01 3.37e-02  1.85e+01     3s
  11  -1.72360640e+04  6.53099637e+05  8.30e-02 5.26e-03  3.75e+00     3s
  12  -2.86597627e+03  3.03533129e+05  5.20e-02 2.29e-03  1.71e+00     3s
  13   5.29760065e+03  2.25886932e+05  3.77e-02 1.70e-03  1.23e+00     3s
  14   1.25363537e+04  1.75238601e+05  2.88e-02 1.28e-03  9.10e-01     3s
  15   1.70779440e+04  1.44420245e+05  2.49e-02 9.92e-04  7.13e-01     3s
  16   2.04841110e+04  1.15733918e+05  2.21e-02 7.08e-04  5.33e-01     3s
  17   2.59094548e+04  9.23030384e+04  1.81e-02 4.47e-04  3.72e-01     3s
  18   2.98129333e+04  8.24940100e+04  1.55e-02 3.28e-04  2.95e-01     3s
  19   3.65034253e+04  7.65999976e+04  1.12e-02 2.54e-04  2.24e-01     3s
  20   3.86136375e+04  7.19229105e+04  9.78e-03 1.99e-04  1.86e-01     4s
  21   4.04427751e+04  6.94579647e+04  8.65e-03 1.72e-04  1.62e-01     4s
  22   4.27589609e+04  6.60567302e+04  7.22e-03 1.32e-04  1.30e-01     4s
  23   4.43734140e+04  6.31768668e+04  6.21e-03 9.69e-05  1.05e-01     4s
  24   4.65759796e+04  6.11073696e+04  4.88e-03 7.10e-05  8.13e-02     4s
  25   4.71894674e+04  6.00004864e+04  4.49e-03 5.84e-05  7.17e-02     4s
  26   4.93422564e+04  5.86848912e+04  3.21e-03 5.74e-05  5.23e-02     4s
  27   5.03872288e+04  5.77018892e+04  2.59e-03 4.84e-05  4.09e-02     4s
  28   5.10415985e+04  5.70555526e+04  2.20e-03 3.73e-05  3.37e-02     4s
  29   5.18605848e+04  5.65603776e+04  1.71e-03 2.87e-05  2.63e-02     4s
  30   5.22308999e+04  5.60240932e+04  1.49e-03 1.93e-05  2.12e-02     4s
  31   5.31664545e+04  5.56220097e+04  9.61e-04 1.16e-05  1.37e-02     4s
  32   5.36282947e+04  5.54925581e+04  7.05e-04 9.58e-06  1.04e-02     4s
  33   5.38647421e+04  5.53533409e+04  5.73e-04 6.91e-06  8.33e-03     4s
  34   5.43572100e+04  5.52098213e+04  3.11e-04 4.22e-06  4.77e-03     4s
  35   5.45065364e+04  5.50941692e+04  2.32e-04 2.17e-06  3.29e-03     4s
  36   5.46553758e+04  5.50502298e+04  1.55e-04 1.39e-06  2.21e-03     4s
  37   5.47529023e+04  5.50344489e+04  1.04e-04 1.09e-06  1.58e-03     4s
  38   5.48437468e+04  5.50079145e+04  5.87e-05 7.15e-07  9.19e-04     4s
  39   5.48804041e+04  5.49919105e+04  4.05e-05 4.24e-07  6.24e-04     4s
  40   5.48937756e+04  5.49868595e+04  3.42e-05 3.30e-07  5.21e-04     4s
  41   5.49217850e+04  5.49836800e+04  2.04e-05 2.82e-07  3.46e-04     5s
  42   5.49358529e+04  5.49779580e+04  1.38e-05 2.30e-07  2.36e-04     5s
  43   5.49510528e+04  5.49698497e+04  6.40e-06 1.13e-07  1.05e-04     5s
  44   5.49593394e+04  5.49664005e+04  2.62e-06 5.83e-08  3.95e-05     5s
  45   5.49599838e+04  5.49661978e+04  2.35e-06 3.39e-08  3.48e-05     5s
  46   5.49623506e+04  5.49660413e+04  1.38e-06 2.00e-08  2.07e-05     5s
  47   5.49644347e+04  5.49659767e+04  5.20e-07 1.53e-08  8.63e-06     5s
  48   5.49652480e+04  5.49659717e+04  2.26e-07 1.43e-08  4.05e-06     5s
  49   5.49656257e+04  5.49659243e+04  8.54e-08 6.61e-09  1.67e-06     5s
  50   5.49658478e+04  5.49658704e+04  1.34e-08 1.34e-08  1.26e-07     5s
  51   5.49658615e+04  5.49658656e+04  1.32e-06 1.29e-07  2.26e-08     5s
  52   5.49658632e+04  5.49658654e+04  9.17e-07 3.50e-07  1.37e-08     5s
  53   5.49658646e+04  5.49658651e+04  2.26e-07 3.09e-08  3.00e-09     5s

Barrier solved model in 53 iterations and 5.17 seconds (9.84 work units)
Optimal objective 5.49658646e+04


Root crossover log...

   82729 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

   21000 PPushes remaining with PInf 8.5610065e-05                 9s
    2871 PPushes remaining with PInf 8.5844615e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.0424656e+03     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62864    5.4965865e+04   0.000000e+00   2.042466e+03     11s
   63474    5.4965865e+04   0.000000e+00   0.000000e+00     11s
   63474    5.4965865e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 3.79s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.496587e+04, 63474 iterations, 12.74 seconds (23.71 work units)
Total elapsed time = 15.43s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54965.8650    0  325 -207405.59 54965.8650   127%     -   15s
H    0     0                    -122726.8198 54965.8650   145%     -   16s
H    0     0                    -122407.1044 54965.8650   145%     -   16s
H    0     0                    -63081.54894 54965.8650   187%     -   16s
H    0     0                    -36516.38862 54965.8650   251%     -   16s
H    0     0                    -18022.35561 54965.8650   405%     -   16s
H    0     0                    -9848.594018 54965.8650   658%     -   17s
H    0     0                    -6999.262348 54965.8650   885%     -   17s
H    0     0                    -2222.986833 54965.8650  2573%     -   17s
H    0     0                    -2083.800466 54965.8650  2738%     -   17s
H    0     0                    -1910.155181 54965.8650  2978%     -   17s
H    0     0                    -1881.180889 54965.8650  3022%     -   17s
H    0     0                    -1767.763577 54965.8650  3209%     -   17s
H    0     0                    -1419.743694 54965.8650  3972%     -   17s
     0     0 47959.7119    0  265 -1419.7437 47959.7119  3478%     -   65s
H    0     0                     119.2370526 47959.6729      -     -   66s
H    0     0                     324.8043837 47959.6729      -     -   66s
H    0     0                     618.9451894 47959.6729  7649%     -   66s
H    0     0                     854.5201662 47959.6729  5512%     -   66s
H    0     0                     905.2192864 47959.6729  5198%     -   66s
H    0     0                    1731.5982997 47959.6729  2670%     -   66s
     0     0 47779.9235    0  266 1731.59830 47779.9235  2659%     -   85s
     0     0 47771.7447    0  297 1731.59830 47771.7447  2659%     -   87s
     0     0 47704.8467    0  306 1731.59830 47704.8467  2655%     -   95s
     0     0 47704.2816    0  306 1731.59830 47704.2816  2655%     -   96s
     0     0 45028.6283    0  407 1731.59830 45028.6283  2500%     -  172s
H    0     0                    2471.0308343 45028.6283  1722%     -  173s
H    0     0                    2645.9486360 45028.6283  1602%     -  173s
H    0     0                    2962.4034365 45028.6283  1420%     -  173s
H    0     0                    3676.7040298 45028.6283  1125%     -  173s
H    0     0                    4405.3761628 45028.6283   922%     -  173s
H    0     0                    4463.7851479 45028.6283   909%     -  173s
     0     0 44660.1778    0  422 4463.78515 44660.1778   901%     -  208s
     0     0 44532.2625    0  410 4463.78515 44532.2625   898%     -  227s
     0     0 44474.2259    0  414 4463.78515 44474.2259   896%     -  238s
     0     0 44369.0655    0  445 4463.78515 44369.0655   894%     -  248s
     0     0 44112.9095    0  459 4463.78515 44112.9095   888%     -  271s
     0     0 44091.5723    0  456 4463.78515 44091.5723   888%     -  276s
     0     0 44083.6805    0  462 4463.78515 44083.6805   888%     -  278s
     0     0 44067.2455    0  424 4463.78515 44067.2455   887%     -  282s
     0     0 44054.2940    0  428 4463.78515 44054.2940   887%     -  285s
     0     0 44047.6240    0  438 4463.78515 44047.6240   887%     -  287s
     0     0 44046.4782    0  437 4463.78515 44046.4782   887%     -  289s
H    0     0                    7504.4219877 42250.8601   463%     -  377s
H    0     0                    7834.6249279 42250.8601   439%     -  377s
H    0     0                    7890.5610244 42250.8601   435%     -  377s
H    0     0                    8148.2162044 42250.8601   419%     -  377s
H    0     0                    8232.0229714 42250.8601   413%     -  377s
H    0     0                    8252.0265468 42250.8601   412%     -  377s
H    0     0                    8329.5290929 42250.8601   407%     -  377s
H    0     0                    8332.3566771 42250.8601   407%     -  377s
H    0     0                    8333.8794786 42250.8601   407%     -  377s
     0     0 42250.8601    0  416 8333.87948 42250.8601   407%     -  377s
     0     0 41689.1899    0  445 8333.87948 41689.1899   400%     -  408s
H    0     0                    8368.8479342 41533.7754   396%     -  426s
H    0     0                    8443.7121413 41533.7754   392%     -  426s
     0     0 41533.7754    0  420 8443.71214 41533.7754   392%     -  426s
     0     0 41469.9309    0  449 8443.71214 41469.9309   391%     -  439s
     0     0 41385.5395    0  431 8443.71214 41385.5395   390%     -  451s
     0     0 41328.5899    0  415 8443.71214 41328.5899   389%     -  463s
     0     0 41300.9175    0  437 8443.71214 41300.9175   389%     -  472s
     0     0 41279.5359    0  473 8443.71214 41279.5359   389%     -  480s
     0     0 41262.9539    0  483 8443.71214 41262.9539   389%     -  484s
     0     0 41255.7140    0  478 8443.71214 41255.7140   389%     -  488s
     0     0 41254.3030    0  443 8443.71214 41254.3030   389%     -  491s
H    0     0                    8589.4624750 39903.1273   365%     -  541s
H    0     0                    8920.3249914 39903.1273   347%     -  541s
     0     0 39903.1273    0  466 8920.32499 39903.1273   347%     -  541s
H    0     0                    8960.1527998 39902.6138   345%     -  542s
     0     0 39582.7665    0  445 8960.15280 39582.7665   342%     -  560s
     0     0 39462.5354    0  462 8960.15280 39462.5354   340%     -  572s
     0     0 39412.8628    0  468 8960.15280 39412.8628   340%     -  582s
     0     0 39397.2378    0  458 8960.15280 39397.2378   340%     -  586s
     0     0 39388.2332    0  463 8960.15280 39388.2332   340%     -  589s
     0     0 39363.5418    0  460 8960.15280 39363.5418   339%     -  595s
     0     0 39315.7099    0  476 8960.15280 39315.7099   339%     -  603s
     0     0 39289.1018    0  475 8960.15280 39289.1018   338%     -  609s
     0     0 39281.6933    0  465 8960.15280 39281.6933   338%     -  612s
     0     0 39266.3369    0  459 8960.15280 39266.3369   338%     -  616s
     0     0 39258.1543    0  466 8960.15280 39258.1543   338%     -  620s
     0     0 39249.4243    0  475 8960.15280 39249.4243   338%     -  622s
     0     0 39247.5231    0  472 8960.15280 39247.5231   338%     -  624s
     0     0 39052.3730    0  446 8960.15280 39052.3730   336%     -  641s
H    0     0                    8972.0793342 39051.5174   335%     -  642s
     0     0 38991.0554    0  506 8972.07933 38991.0554   335%     -  656s
     0     0 38971.0680    0  425 8972.07933 38971.0680   334%     -  661s
     0     0 38944.7785    0  476 8972.07933 38944.7785   334%     -  669s
     0     0 38937.3682    0  457 8972.07933 38937.3682   334%     -  673s
     0     0 38912.1437    0  440 8972.07933 38912.1437   334%     -  677s
     0     0 38907.8308    0  453 8972.07933 38907.8308   334%     -  680s
     0     0 38900.7401    0  426 8972.07933 38900.7401   334%     -  682s
     0     0 38896.5863    0  408 8972.07933 38896.5863   334%     -  685s
     0     0 38874.7329    0  424 8972.07933 38874.7329   333%     -  689s
     0     0 38873.3547    0  408 8972.07933 38873.3547   333%     -  691s
     0     0 38780.2107    0  466 8972.07933 38780.2107   332%     -  701s
H    0     0                    9088.7131444 38779.9142   327%     -  703s
H    0     0                    9181.7191511 38779.9142   322%     -  703s
H    0     0                    9214.7726525 38779.9142   321%     -  703s
H    0     0                    9363.4693079 38779.9142   314%     -  703s
     0     0 38746.0486    0  431 9363.46931 38746.0486   314%     -  709s
     0     0 38729.9381    0  431 9363.46931 38729.9381   314%     -  714s
     0     0 38715.1537    0  433 9363.46931 38715.1537   313%     -  718s
     0     0 38671.3442    0  445 9363.46931 38671.3442   313%     -  724s
     0     0 38657.7706    0  479 9363.46931 38657.7706   313%     -  728s
     0     0 38656.1436    0  413 9363.46931 38656.1436   313%     -  730s
     0     0 38590.0328    0  520 9363.46931 38590.0328   312%     -  741s
H    0     0                    9762.4251028 38590.0190   295%     -  741s
     0     0 38561.0451    0  534 9762.42510 38561.0451   295%     -  750s
     0     0 38553.7068    0  498 9762.42510 38553.7068   295%     -  755s
     0     0 38550.0907    0  512 9762.42510 38550.0907   295%     -  758s
     0     0 38549.7355    0  497 9762.42510 38549.7355   295%     -  759s
     0     0 38479.5104    0  423 9762.42510 38479.5104   294%     -  771s
H    0     0                    9938.4216166 38479.3452   287%     -  772s
     0     0 38462.6325    0  438 9938.42162 38462.6325   287%     -  778s
     0     0 38442.1128    0  478 9938.42162 38442.1128   287%     -  784s
     0     0 38440.5208    0  472 9938.42162 38440.5208   287%     -  785s
     0     0 38367.2536    0  466 9938.42162 38367.2536   286%     -  794s
H    0     0                    10148.989142 38366.3151   278%     -  794s
     0     0 38340.6746    0  481 10148.9891 38340.6746   278%     -  804s
     0     0 38333.7548    0  516 10148.9891 38333.7548   278%     -  807s
     0     0 38325.2373    0  495 10148.9891 38325.2373   278%     -  810s
     0     0 38320.2853    0  486 10148.9891 38320.2853   278%     -  812s
     0     0 38319.3918    0  487 10148.9891 38319.3918   278%     -  813s
H    0     0                    10326.439320 38246.8382   270%     -  824s
H    0     0                    10456.238045 38246.8382   266%     -  824s
     0     0 38246.8382    0  436 10456.2380 38246.8382   266%     -  824s
H    0     0                    11142.727667 38245.7540   243%     -  824s
H    0     0                    11682.379466 38234.7730   227%     -  829s
H    0     0                    12051.394298 38234.7730   217%     -  829s
     0     0 38234.7730    0  500 12051.3943 38234.7730   217%     -  829s
H    0     0                    12336.520464 38212.4738   210%     -  834s
     0     0 38212.4738    0  447 12336.5205 38212.4738   210%     -  834s
     0     0 38209.3358    0  453 12336.5205 38209.3358   210%     -  836s
     0     0 38208.5501    0  461 12336.5205 38208.5501   210%     -  838s
     0     0 38168.7640    0  526 12336.5205 38168.7640   209%     -  847s
H    0     0                    13855.785310 38167.4317   175%     -  847s
H    0     0                    14586.013947 38167.4317   162%     -  847s
     0     0 38162.3829    0  474 14586.0139 38162.3829   162%     -  851s
     0     0 38160.4726    0  477 14586.0139 38160.4726   162%     -  854s
     0     0 38128.7571    0  451 14586.0139 38128.7571   161%     -  860s
H    0     0                    14676.189351 38128.6982   160%     -  867s
H    0     0                    14947.122459 38128.6982   155%     -  867s
H    0     0                    16449.291448 38128.6982   132%     -  869s
H    0     0                    16880.520339 38128.6982   126%     -  869s
     0     0 38123.6046    0  511 16880.5203 38123.6046   126%     -  874s
     0     0 38122.7174    0  445 16880.5203 38122.7174   126%     -  876s
     0     0 38006.8314    0  432 16880.5203 38006.8314   125%     -  886s
H    0     0                    18701.128045 38006.5614   103%     -  886s
H    0     0                    18734.646261 38006.5614   103%     -  886s
H    0     0                    19904.475435 38006.5614  90.9%     -  886s
H    0     0                    19919.420533 38006.5614  90.8%     -  886s
     0     0 37987.4511    0  438 19919.4205 37987.4511  90.7%     -  892s
     0     0 37982.4713    0  440 19919.4205 37982.4713  90.7%     -  893s
     0     0 37981.1111    0  441 19919.4205 37981.1111  90.7%     -  895s
     0     0 37959.3137    0  503 19919.4205 37959.3137  90.6%     -  900s
H    0     0                    20442.197873 37959.2953  85.7%     -  903s
H    0     0                    20741.865293 37959.2953  83.0%     -  903s
H    0     0                    20804.659492 37959.2953  82.5%     -  903s
H    0     0                    20844.925658 37959.2953  82.1%     -  904s
     0     0 37947.2994    0  438 20844.9257 37947.2994  82.0%     -  907s
     0     0 37941.6479    0  462 20844.9257 37941.6479  82.0%     -  910s
     0     0 37940.7571    0  439 20844.9257 37940.7571  82.0%     -  911s
     0     0 37932.4739    0  440 20844.9257 37932.4739  82.0%     -  915s
H    0     0                    20891.194586 37932.2471  81.6%     -  915s
     0     0 37930.0592    0  441 20891.1946 37930.0592  81.6%     -  916s
     0     0 37908.4128    0  454 20891.1946 37908.4128  81.5%     -  925s
H    0     0                    21020.315733 37907.0039  80.3%     -  927s
     0     0 37904.5998    0  448 21020.3157 37904.5998  80.3%     -  929s
     0     0 37904.1149    0  451 21020.3157 37904.1149  80.3%     -  930s
     0     0 37899.3813    0  442 21020.3157 37899.3813  80.3%     -  934s
     0     0 37899.2183    0  442 21020.3157 37899.2183  80.3%     -  936s
H    0     0                    21049.154275 37899.0862  80.1%     - 1008s
H    0     0                    21123.972523 37899.0862  79.4%     - 1060s
H    0     0                    22837.992082 37899.0862  65.9%     - 1060s
H    0     0                    22847.044537 37899.0862  65.9%     - 1061s
H    0     0                    22926.526681 37899.0862  65.3%     - 1061s
H    0     2                    22939.763429 37899.0862  65.2%     - 1063s
     0     2 37899.0862    0  442 22939.7634 37899.0862  65.2%     - 1063s
     1     3 37831.2606    1  446 22939.7634 37899.0862  65.2%  7813 1069s
     2     4 37694.3040    1  449 22939.7634 37830.4793  64.9%  5938 1077s
     3     7 37407.8986    2  488 22939.7634 37827.6863  64.9%  7257 1090s
     6    13 37248.3957    3  488 22939.7634 37693.8593  64.3%  9944 1116s
    12    25 36967.1918    4  493 22939.7634 37449.8921  63.3% 12383 1135s
    24    37 35614.0147    5  479 22939.7634 37286.8959  62.5% 16603 1200s
    36    68 34381.8182    6  454 22939.7634 36967.0612  61.1% 17762 1330s
H   37    68                    23121.052619 36967.0612  59.9% 17282 1330s
H   43    68                    23130.094593 36967.0612  59.8% 16862 1330s
H   58    68                    23155.414406 36967.0612  59.6% 14421 1330s
    67   137 34231.0541    7  378 23155.4144 36967.0612  59.6% 19892 1393s
   136   239 33804.5437    8  379 23155.4144 36967.0612  59.6% 13717 1425s
H  150   239                    23158.653098 36967.0612  59.6% 13169 1425s
   238   313 33576.3605   11  248 23158.6531 36967.0612  59.6% 10748 1447s
   312   388 33392.0538   13  247 23158.6531 36967.0612  59.6%  9900 1466s
H  328   388                    23187.491639 36967.0612  59.4%  9640 1466s
   387   452 32971.6136   16  237 23187.4916 36967.0612  59.4%  9102 1484s
   453   509 32668.0657   19  224 23187.4916 36967.0612  59.4%  8650 1503s
H  489   509                    23193.381997 36967.0612  59.4%  8509 1503s
   514   549 32310.9301   21  219 23193.3820 36967.0612  59.4%  8571 1518s
   566   581 31419.9070   24  211 23193.3820 36967.0612  59.4%  8624 1536s
   612   624 28633.0091   25  186 23193.3820 36967.0612  59.4%  8762 1554s
   655   639 28483.2675   28  183 23193.3820 36967.0612  59.4%  8710 1571s
   670   664 28479.6887   29  178 23193.3820 36967.0612  59.4%  8805 1589s
H  691   664                    23256.484605 36967.0612  59.0%  8791 1589s
   699   682 24952.8502   30  157 23256.4846 36967.0612  59.0%  8834 1606s
   723   699 24939.7171   31  154 23256.4846 36967.0612  59.0%  8892 1625s
H  752   727                    23410.227354 36967.0612  57.9%  8883 1644s
   798   753 24651.9798   33  145 23410.2274 36967.0612  57.9%  8864 1664s
   873   793 23643.7244   36  124 23410.2274 36967.0612  57.9%  8918 1684s
   949   855 29887.0288   14  322 23410.2274 36967.0612  57.9%  8863 1705s
  1041   932 28442.9819   15  284 23410.2274 36967.0612  57.9%  8661 1726s
  1164   994 27348.4821   15  288 23410.2274 36967.0612  57.9%  8314 1747s
  1284  1027 infeasible   16      23410.2274 36967.0612  57.9%  8029 1767s
H 1347  1027                    23650.579776 36967.0612  56.3%  7876 1767s
  1375  1029 26793.3482   17  286 23650.5798 36967.0612  56.3%  7835 1790s
  1459  1053 25829.9696   17  260 23650.5798 36967.0612  56.3%  7817 1815s
  1527  1106 infeasible   18      23650.5798 36967.0612  56.3%  7862 1839s
  1620  1204 28506.9718   26  232 23650.5798 36967.0612  56.3%  7860 1863s
  1738  1293 27763.2046   31  151 23650.5798 36967.0612  56.3%  7807 1889s
  1899  1327 25855.7105   37   92 23650.5798 36967.0612  56.3%  7606 1913s
  2023  1384 infeasible   44      23650.5798 36967.0612  56.3%  7547 1941s
  2118  1484 25914.0980   22  272 23650.5798 36967.0612  56.3%  7612 1969s
  2282  1500 25418.7656   24  291 23650.5798 36967.0612  56.3%  7463 2000s
H 2323  1500                    23698.721997 36967.0612  56.0%  7401 2000s
H 2351  1500                    23754.310283 36967.0612  55.6%  7383 2000s
  2372  1548 24855.6464   25  291 23754.3103 36967.0612  55.6%  7415 2029s
H 2463  1564                    24344.404401 36967.0612  51.9%  7449 2059s
H 2480  1564                    24366.606169 36967.0612  51.7%  7502 2059s
H 2482  1564                    24457.618149 36967.0612  51.1%  7506 2059s
H 2491  1564                    24515.733138 36967.0612  50.8%  7519 2059s
  2499  1587     cutoff   30      24515.7331 36967.0612  50.8%  7511 2092s
  2571  1648 31423.6688   15  382 24515.7331 36967.0612  50.8%  7553 2122s
  2668  1685 29366.0250   16  377 24515.7331 36967.0612  50.8%  7560 2157s
  2753  1747     cutoff   17      24515.7331 36967.0612  50.8%  7670 2191s
  2837  1777 33402.4883   15  365 24515.7331 36967.0612  50.8%  7828 2225s
  2941  1792 31366.0214   17  369 24515.7331 36967.0612  50.8%  7910 2259s
  3067  1862 29526.4817   19  332 24515.7331 36967.0612  50.8%  7949 2298s
  3252  1897 26943.5357   21  267 24515.7331 36967.0612  50.8%  7888 2339s
  3435  1943 25994.8443   23  300 24515.7331 36967.0612  50.8%  7868 2382s
  3585  1999 infeasible   29      24515.7331 36967.0612  50.8%  7938 2427s
  3699  2049 25136.0348   28  207 24515.7331 36855.4890  50.3%  8098 2473s
  3819  2098 34233.4675    7  504 24515.7331 36855.3654  50.3%  8244 2524s
  3930  2127 28221.2612    8  466 24515.7331 36855.3654  50.3%  8428 2574s
  4051  2176 infeasible    9      24515.7331 36855.3654  50.3%  8577 2629s
  4179  2259 infeasible   40      24515.7331 36855.3654  50.3%  8706 2682s
  4326  2339     cutoff   40      24515.7331 35193.3039  43.6%  8806 2741s
  4488  2392 30111.0539    8  326 24515.7331 35193.3039  43.6%  8935 2790s
H 4553  2380                    24557.416017 35028.4449  42.6%  8963 2790s
H 4572  2373                    24603.944168 35028.4449  42.4%  8953 2790s
H 4573  2337                    24716.664791 35028.4449  41.7%  8955 2845s
  4574  2338 30557.5466   14  442 24716.6648 35028.4449  41.7%  8953 3029s
  4576  2339 25124.1064   37  241 24716.6648 35028.4449  41.7%  8949 3050s
  4577  2340 28143.0541   17  376 24716.6648 35028.4449  41.7%  8947 3143s
H 4577  2222                    24747.795904 35028.4449  41.5%  8947 3226s
  4579  2223 25369.2056   29  456 24747.7959 35028.4449  41.5%  8943 3280s
  4580  2224 26491.4303   22  432 24747.7959 35028.4449  41.5%  8941 3310s
  4581  2225 24747.7959   57  479 24747.7959 35028.4449  41.5%  8939 3327s
  4582  2225 26893.2979   20  475 24747.7959 35028.4449  41.5%  8937 3343s
H 4582  2114                    24751.055031 35028.4449  41.5%  8937 3358s
  4583  2115 33115.3142   12  427 24751.0550 35028.4449  41.5%  8935 3360s
  4584  2116 25116.5708   28  490 24751.0550 35028.4449  41.5%  8933 3374s
  4585  2116 29674.1219   13  425 24751.0550 35028.4449  41.5%  8931 3383s
  4586  2117 29197.5519   18  435 24751.0550 35028.4449  41.5%  8929 3388s
  4587  2118 32640.0503   13  490 24751.0550 35028.4449  41.5%  8927 3400s
  4588  2118 31290.8405   13  432 24751.0550 35028.4449  41.5%  8925 3406s
  4589  2119 31321.5296   10  474 24751.0550 35028.4449  41.5%  8923 3423s
  4590  2120 34035.2643   12  521 24751.0550 35028.4449  41.5%  8921 3436s
  4591  2120 30584.0988   16  531 24751.0550 35028.4449  41.5%  8919 3447s
  4592  2121 25725.8475   33  506 24751.0550 35028.4449  41.5%  8917 3452s
  4593  2122 26112.1278   30  507 24751.0550 35028.4449  41.5%  8916 3458s
  4594  2122 25589.0950   30  534 24751.0550 35028.4449  41.5%  8914 3474s
  4595  2123 25847.5673   39  499 24751.0550 35028.4449  41.5%  8912 3480s
  4596  2124 30588.8981   14  538 24751.0550 35028.4449  41.5%  8910 3485s
  4597  2124 34133.3699   11  507 24751.0550 35028.4449  41.5%  8908 3498s
  4598  2125 26708.4283   38  531 24751.0550 35028.4449  41.5%  8906 3506s
  4599  2126 29406.1729   18  505 24751.0550 35028.4449  41.5%  8904 3513s
  4600  2126 31502.1676   14  503 24751.0550 35028.4449  41.5%  8902 3527s
  4601  2127 34014.6275   12  500 24751.0550 35028.4449  41.5%  8900 3533s
  4602  2128 25939.2166   24  495 24751.0550 35028.4449  41.5%  8898 3537s
  4603  2128 30624.6972   16  518 24751.0550 35028.4449  41.5%  8896 3547s
  4604  2129 29681.4275   12  529 24751.0550 35028.4449  41.5%  8894 3554s
  4605  2130 27496.8522   17  538 24751.0550 35028.4449  41.5%  8892 3569s
  4606  2130 26286.8456   33  509 24751.0550 35028.4449  41.5%  8890 3574s
  4607  2131 25655.8835   18  494 24751.0550 35028.4449  41.5%  8888 3590s
  4608  2132 26802.9535   26  536 24751.0550 35028.4449  41.5%  8887 3597s

Cutting planes:
  Gomory: 9
  Implied bound: 23
  Projected implied bound: 219
  MIR: 772
  Mixing: 1
  Flow cover: 1063
  Zero half: 1
  RLT: 28
  Relax-and-lift: 213

Explored 4608 nodes (42211094 simplex iterations) in 3600.06 seconds (8998.40 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24751.1 24747.8 24716.7 ... 23754.3

Time limit reached
Best objective 2.475105503086e+04, best bound 3.502844489581e+04, gap 41.5230%
  WARNING: Time limit reached. Using best solution found (gap: 41.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 24751.06, θ = 169503.11
  Upper Bound (UB) = 24751.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169503.11
  [DEBUG]   ✓ Scenario 0: θ = 169503.11 ≤ Q = 169503.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169503.11 ≤ Q = 169503.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 169503.11 ≤ Q = 169673.75 (slack: 170.64)
  [DEBUG]   ✓ Scenario 11: θ = 169503.11 ≤ Q = 169503.11 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x115f02ec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x115f02ec
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.330649e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6072112.4940
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.596715e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159671.46    0  123 6072112.49 -159671.46   103%     -    0s
H    0     0                    -125401.9959 -159671.46  27.3%     -    0s
H    0     0                    -125923.0796 -159671.46  26.8%     -    0s
H    0     0                    -129707.2420 -159671.46  23.1%     -    0s
     0     0 -143338.74    0   86 -129707.24 -143338.74  10.5%     -    0s
H    0     0                    -140583.1398 -143262.19  1.91%     -    0s
H    0     0                    -140940.2757 -143262.19  1.65%     -    0s
H    0     0                    -140974.2761 -143262.19  1.62%     -    0s
H    0     0                    -141331.4120 -143262.19  1.37%     -    0s
     0     0 -143132.03    0   71 -141331.41 -143132.03  1.27%     -    0s
     0     0 -142338.28    0   62 -141331.41 -142338.28  0.71%     -    0s
     0     0 -142215.11    0   38 -141331.41 -142215.11  0.63%     -    0s
     0     0 -142193.30    0   37 -141331.41 -142193.30  0.61%     -    0s
     0     0 -142189.52    0   51 -141331.41 -142189.52  0.61%     -    0s
     0     0 -141854.73    0   23 -141331.41 -141854.73  0.37%     -    0s
H    0     0                    -141382.7550 -141845.99  0.33%     -    0s
     0     0 -141779.32    0   28 -141382.75 -141779.32  0.28%     -    0s
     0     0 -141753.55    0   29 -141382.75 -141753.55  0.26%     -    0s
     0     0 -141747.11    0   29 -141382.75 -141747.11  0.26%     -    0s
     0     0 -141662.04    0   14 -141382.75 -141662.04  0.20%     -    0s
     0     0 -141630.66    0   17 -141382.75 -141630.66  0.18%     -    0s
     0     0 -141625.09    0   16 -141382.75 -141625.09  0.17%     -    0s
     0     0 -141596.12    0   16 -141382.75 -141596.12  0.15%     -    0s
     0     0 -141596.12    0   23 -141382.75 -141596.12  0.15%     -    0s
     0     0 -141596.12    0   21 -141382.75 -141596.12  0.15%     -    0s
     0     0 -141510.05    0    7 -141382.75 -141510.05  0.09%     -    0s
H    0     0                    -141461.2970 -141503.48  0.03%     -    0s
     0     0 -141503.48    0    7 -141461.30 -141503.48  0.03%     -    0s
H    0     0                    -141486.5999 -141503.48  0.01%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 1
  MIR: 6
  Flow cover: 16
  Relax-and-lift: 4

Explored 1 nodes (794 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -141487 -141461 -141383 ... 6.07211e+06
No other solutions better than -141487

Optimal solution found (tolerance 1.00e-04)
Best objective -1.414865999451e+05, best bound -1.414865999451e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 154087.00
  Scenario: 39 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141486.60
  [DEBUG]   S×d_nominal = 295573.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 295573.60 + -141486.60 = 154087.00
  [DEBUG]   Current θ from Master = 169503.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15416.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9334.94
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 972.5776, Absolute Gap = 972.5776, Relative Gap = 0.039294
  Not converged yet (gap = 972.58 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 20 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567444 nonzeros
Model fingerprint: 0x19b45900
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94676 rows and 38446 columns
Presolve time: 1.68s
Presolved: 105477 rows, 44934 columns, 640071 nonzeros
Variable types: 42675 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -334767.4776
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 566
 AA' NZ     : 4.358e+06
 Factor NZ  : 9.917e+06 (roughly 140 MB of memory)
 Factor Ops : 1.891e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.74231630e+07  1.85935488e+08  1.09e+05 2.00e+01  7.66e+04     3s
   1  -1.29140942e+07  1.68984281e+08  7.46e+04 7.05e+01  5.19e+04     3s
   2  -3.84052367e+06  1.29841317e+08  2.23e+04 4.77e-01  1.66e+04     3s
   3  -8.87183347e+05  9.26108912e+07  2.48e+03 1.30e+00  2.19e+03     3s
   4  -4.98620762e+05  4.04503477e+07  4.89e+02 3.08e-01  5.10e+02     3s
   5  -3.90750353e+05  2.55038769e+07  1.99e+02 1.64e-01  2.45e+02     3s
   6  -2.95919056e+05  1.88478546e+07  6.58e+01 1.12e-01  1.32e+02     3s
   7  -2.07983122e+05  1.41780773e+07  2.30e+01 8.12e-02  8.45e+01     3s
   8  -1.19715864e+05  1.12375202e+07  7.48e+00 6.32e-02  6.16e+01     3s
   9  -8.87359935e+04  6.40858110e+06  4.49e+00 3.48e-02  3.47e+01     3s
  10  -7.33445871e+04  4.72643969e+06  2.87e+00 2.55e-02  2.53e+01     3s
  11  -3.53807431e+04  6.88033663e+05  8.19e-01 3.13e-03  3.77e+00     3s
  12  -6.89094678e+03  3.62359718e+05  4.13e-01 1.54e-03  1.92e+00     3s
  13  -4.64498049e+02  2.39842079e+05  3.15e-01 9.93e-04  1.25e+00     3s
  14   5.94517709e+03  1.90963851e+05  2.46e-01 9.34e-04  9.61e-01     3s
  15   1.37448084e+04  1.52358596e+05  1.88e-01 1.31e-03  7.19e-01     3s
  16   1.95259540e+04  1.24785026e+05  1.51e-01 1.71e-03  5.46e-01     4s
  17   2.67591722e+04  1.04140962e+05  1.13e-01 1.37e-03  4.01e-01     4s
  18   3.05463358e+04  8.74390233e+04  9.49e-02 1.29e-03  2.95e-01     4s
  19   3.62916515e+04  7.85449075e+04  7.09e-02 1.17e-03  2.19e-01     4s
  20   3.94142883e+04  7.43897075e+04  5.84e-02 1.39e-03  1.81e-01     4s
  21   4.25441328e+04  7.13871418e+04  4.61e-02 1.04e-03  1.50e-01     4s
  22   4.51362343e+04  6.80665608e+04  3.58e-02 7.94e-04  1.19e-01     4s
  23   4.72887128e+04  6.50057574e+04  2.76e-02 1.18e-03  9.19e-02     4s
  24   4.85607819e+04  6.38009902e+04  2.27e-02 1.06e-03  7.90e-02     4s
  25   4.96841051e+04  6.24957868e+04  1.86e-02 8.98e-04  6.64e-02     4s
  26   5.11367454e+04  6.01823744e+04  1.34e-02 6.31e-04  4.69e-02     4s
  27   5.24642565e+04  5.89071202e+04  8.87e-03 4.83e-04  3.34e-02     4s
  28   5.28838105e+04  5.83196525e+04  7.53e-03 3.96e-04  2.82e-02     4s
  29   5.32011544e+04  5.73847425e+04  6.52e-03 2.73e-04  2.17e-02     4s
  30   5.38760459e+04  5.67234170e+04  4.47e-03 1.82e-04  1.48e-02     4s
  31   5.41691818e+04  5.64762850e+04  3.61e-03 1.47e-04  1.20e-02     4s
  32   5.44291949e+04  5.61878251e+04  2.87e-03 1.39e-04  9.12e-03     4s
  33   5.47748575e+04  5.59833715e+04  1.85e-03 9.86e-05  6.27e-03     4s
  34   5.50165420e+04  5.58411696e+04  1.17e-03 7.12e-05  4.28e-03     4s
  35   5.51589559e+04  5.58105934e+04  7.89e-04 6.87e-05  3.38e-03     4s
  36   5.52076156e+04  5.56912090e+04  6.52e-04 4.59e-05  2.51e-03     5s
  37   5.52696590e+04  5.56482130e+04  4.81e-04 3.72e-05  1.96e-03     5s
  38   5.53471362e+04  5.55858989e+04  2.83e-04 2.42e-05  1.24e-03     5s
  39   5.53791172e+04  5.55300144e+04  1.99e-04 1.33e-05  7.82e-04     5s
  40   5.53978040e+04  5.54977454e+04  1.51e-04 6.85e-06  5.18e-04     5s
  41   5.54208884e+04  5.54880541e+04  9.14e-05 5.06e-06  3.48e-04     5s
  42   5.54368577e+04  5.54847147e+04  5.40e-05 4.44e-06  2.48e-04     5s
  43   5.54379738e+04  5.54815172e+04  5.16e-05 3.82e-06  2.26e-04     5s
  44   5.54463132e+04  5.54721612e+04  3.22e-05 1.99e-06  1.34e-04     5s
  45   5.54572130e+04  5.54645102e+04  8.08e-06 5.43e-07  3.78e-05     5s
  46   5.54599776e+04  5.54621400e+04  2.71e-06 1.09e-07  1.12e-05     5s
  47   5.54611869e+04  5.54616849e+04  5.13e-07 3.32e-08  2.58e-06     5s
  48   5.54614571e+04  5.54614946e+04  3.50e-08 3.85e-09  1.94e-07     5s
  49   5.54614710e+04  5.54614715e+04  4.34e-08 1.75e-09  2.72e-09     5s

Barrier solved model in 49 iterations and 5.19 seconds (9.56 work units)
Optimal objective 5.54614710e+04


Root crossover log...

   90504 DPushes remaining with DInf 0.0000000e+00                 5s
      83 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

   14827 PPushes remaining with PInf 3.8926571e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6401735e+04     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58897    5.5461471e+04   0.000000e+00   1.640174e+04     12s
   59635    5.5461471e+04   0.000000e+00   0.000000e+00     13s
   59635    5.5461471e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 5.28s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.546147e+04, 59635 iterations, 15.75 seconds (29.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 55461.4713    0  309 -207405.59 55461.4713   127%     -   18s
H    0     0                    -205149.1519 55461.4713   127%     -   18s
H    0     0                    -129833.9545 55461.4713   143%     -   19s
H    0     0                    -108607.5806 55461.4713   151%     -   19s
H    0     0                    -108508.5409 55461.4713   151%     -   19s
H    0     0                    -80692.85459 55461.4713   169%     -   19s
H    0     0                    -23132.60961 55461.4713   340%     -   19s
H    0     0                    -21678.05058 55461.4713   356%     -   19s
H    0     0                    -2043.468554 55461.4713  2814%     -   20s
H    0     0                    -1935.412643 55461.4713  2966%     -   20s
H    0     0                    -1101.030730 55461.4713  5137%     -   20s
H    0     0                    -1094.547497 55461.4713  5167%     -   22s
H    0     0                    -1039.094867 55461.4713  5437%     -   22s
     0     0 48657.9752    0  297 -1039.0949 48657.9752  4783%     -   73s
H    0     0                    -537.1538328 48129.2772  9060%     -  103s
H    0     0                    -517.6113995 48129.2772  9398%     -  103s
H    0     0                    -504.2528071 48129.2772  9645%     -  103s
H    0     0                    -462.0937086 48129.2772      -     -  103s
     0     0 48129.2772    0  327 -462.09371 48129.2772      -     -  103s
     0     0 48076.2037    0  349 -462.09371 48076.2037      -     -  112s
     0     0 48047.8007    0  355 -462.09371 48047.8007      -     -  120s
     0     0 47989.7117    0  362 -462.09371 47989.7117      -     -  130s
     0     0 47982.9103    0  349 -462.09371 47982.9103      -     -  134s
     0     0 47943.3823    0  367 -462.09371 47943.3823      -     -  145s
     0     0 47940.7878    0  365 -462.09371 47940.7878      -     -  147s
     0     0 47940.2263    0  365 -462.09371 47940.2263      -     -  148s
H    0     0                     314.5204873 44381.9086      -     -  209s
     0     0 44381.9086    0  356  314.52049 44381.9086      -     -  209s
H    0     0                    3909.6830105 44381.8985  1035%     -  210s
H    0     0                    5259.0748305 44381.8985   744%     -  211s
H    0     0                    5523.8180904 44381.8985   703%     -  212s
H    0     0                    6517.9103501 44381.8985   581%     -  213s
H    0     0                    6554.0359769 44381.8985   577%     -  213s
H    0     0                    6578.4978233 44381.8985   575%     -  213s
H    0     0                    6770.5969848 44381.8985   556%     -  213s
H    0     0                    6893.6346861 44381.8985   544%     -  213s
H    0     0                    6901.9082164 44381.8985   543%     -  213s
     0     0 43625.8185    0  425 6901.90822 43625.8185   532%     -  256s
     0     0 43256.0708    0  453 6901.90822 43256.0708   527%     -  291s
     0     0 43158.0274    0  469 6901.90822 43158.0274   525%     -  310s
     0     0 43074.0918    0  482 6901.90822 43074.0918   524%     -  327s
     0     0 43055.8651    0  489 6901.90822 43055.8651   524%     -  337s
     0     0 42988.3226    0  456 6901.90822 42988.3226   523%     -  346s
     0     0 42837.3982    0  468 6901.90822 42837.3982   521%     -  357s
     0     0 42804.0090    0  481 6901.90822 42804.0090   520%     -  361s
     0     0 42651.0268    0  480 6901.90822 42651.0268   518%     -  376s
     0     0 42642.8542    0  500 6901.90822 42642.8542   518%     -  379s
     0     0 42638.6432    0  488 6901.90822 42638.6432   518%     -  382s
     0     0 42635.3616    0  487 6901.90822 42635.3616   518%     -  384s
     0     0 42635.0855    0  488 6901.90822 42635.0855   518%     -  384s
     0     0 40421.2380    0  442 6901.90822 40421.2380   486%     -  451s
H    0     0                    7660.1632197 40421.1918   428%     -  452s
H    0     0                    11859.353389 39900.3152   236%     -  477s
H    0     0                    11898.580935 39900.3152   235%     -  477s
H    0     0                    12090.431676 39900.3152   230%     -  477s
     0     0 39900.3152    0  463 12090.4317 39900.3152   230%     -  477s
H    0     0                    12697.872495 39785.8416   213%     -  490s
H    0     0                    12909.984529 39785.8416   208%     -  490s
     0     0 39785.8416    0  434 12909.9845 39785.8416   208%     -  490s
     0     0 39727.0915    0  448 12909.9845 39727.0915   208%     -  499s
     0     0 39662.6793    0  425 12909.9845 39662.6793   207%     -  507s
     0     0 39644.8833    0  483 12909.9845 39644.8833   207%     -  511s
     0     0 39588.4196    0  427 12909.9845 39588.4196   207%     -  528s
     0     0 39566.0783    0  432 12909.9845 39566.0783   206%     -  534s
     0     0 39561.7358    0  424 12909.9845 39561.7358   206%     -  537s
     0     0 39560.6971    0  424 12909.9845 39560.6971   206%     -  538s
     0     0 38663.2506    0  402 12909.9845 38663.2506   199%     -  577s
     0     0 38521.5551    0  499 12909.9845 38521.5551   198%     -  591s
     0     0 38493.9144    0  414 12909.9845 38493.9144   198%     -  595s
     0     0 38476.9497    0  444 12909.9845 38476.9497   198%     -  601s
     0     0 38469.6781    0  411 12909.9845 38469.6781   198%     -  606s
     0     0 38454.5151    0  440 12909.9845 38454.5151   198%     -  610s
     0     0 38449.1160    0  429 12909.9845 38449.1160   198%     -  612s
     0     0 38448.8632    0  426 12909.9845 38448.8632   198%     -  612s
     0     0 38343.9413    0  431 12909.9845 38343.9413   197%     -  626s
     0     0 38310.3819    0  452 12909.9845 38310.3819   197%     -  634s
     0     0 38304.1066    0  444 12909.9845 38304.1066   197%     -  637s
     0     0 38295.1678    0  477 12909.9845 38295.1678   197%     -  641s
     0     0 38292.2966    0  466 12909.9845 38292.2966   197%     -  643s
     0     0 38291.2190    0  483 12909.9845 38291.2190   197%     -  645s
H    0     0                    13075.411279 38221.8356   192%     -  655s
     0     0 38221.8356    0  417 13075.4113 38221.8356   192%     -  655s
H    0     0                    13274.720369 38221.3399   188%     -  661s
H    0     0                    13378.352455 38221.3399   186%     -  661s
H    0     0                    15537.400816 38221.3399   146%     -  661s
     0     0 38197.7484    0  464 15537.4008 38197.7484   146%     -  667s
     0     0 38190.7470    0  424 15537.4008 38190.7470   146%     -  670s
     0     0 38185.8007    0  447 15537.4008 38185.8007   146%     -  674s
     0     0 38182.8349    0  485 15537.4008 38182.8349   146%     -  676s
     0     0 38179.9343    0  467 15537.4008 38179.9343   146%     -  679s
     0     0 38177.9461    0  462 15537.4008 38177.9461   146%     -  682s
     0     0 38160.0407    0  467 15537.4008 38160.0407   146%     -  689s
H    0     0                    15666.735105 38159.8364   144%     -  690s
     0     0 38153.3166    0  458 15666.7351 38153.3166   144%     -  694s
     0     0 38145.7223    0  478 15666.7351 38145.7223   143%     -  699s
     0     0 38135.9092    0  462 15666.7351 38135.9092   143%     -  702s
     0     0 38130.3902    0  469 15666.7351 38130.3902   143%     -  706s
     0     0 38126.9551    0  480 15666.7351 38126.9551   143%     -  709s
     0     0 38125.0164    0  474 15666.7351 38125.0164   143%     -  712s
     0     0 38073.6988    0  486 15666.7351 38073.6988   143%     -  721s
H    0     0                    16414.109403 38073.4691   132%     -  721s
H    0     0                    17030.413701 38073.4691   124%     -  722s
H    0     0                    17283.305219 38073.4691   120%     -  722s
H    0     0                    17284.655631 38073.4691   120%     -  722s
H    0     0                    17693.950270 38073.4691   115%     -  722s
H    0     0                    17792.122946 38073.4691   114%     -  722s
H    0     0                    17875.435104 38073.4691   113%     -  722s
H    0     0                    17891.817738 38073.4691   113%     -  723s
H    0     0                    18011.530916 38073.4691   111%     -  723s
H    0     0                    18072.155300 38073.4691   111%     -  723s
     0     0 38060.9203    0  438 18072.1553 38060.9203   111%     -  729s
     0     0 38052.8874    0  443 18072.1553 38052.8874   111%     -  732s
     0     0 38051.7637    0  455 18072.1553 38051.7637   111%     -  734s
     0     0 38025.1974    0  426 18072.1553 38025.1974   110%     -  742s
     0     0 38019.6957    0  427 18072.1553 38019.6957   110%     -  747s
     0     0 38017.4039    0  427 18072.1553 38017.4039   110%     -  749s
     0     0 37989.4616    0  432 18072.1553 37989.4616   110%     -  758s
H    0     0                    18087.071200 37989.2877   110%     -  768s
     0     0 37973.1769    0  454 18087.0712 37973.1769   110%     -  774s
     0     0 37960.8091    0  444 18087.0712 37960.8091   110%     -  779s
     0     0 37959.0283    0  464 18087.0712 37959.0283   110%     -  781s
     0     0 37926.1953    0  441 18087.0712 37926.1953   110%     -  789s
H    0     0                    19458.131039 37925.9827  94.9%     -  789s
     0     0 37912.4607    0  446 19458.1310 37912.4607  94.8%     -  796s
     0     0 37910.2213    0  487 19458.1310 37910.2213  94.8%     -  799s
     0     0 37899.0249    0  437 19458.1310 37899.0249  94.8%     -  804s
H    0     0                    19519.913975 37898.8405  94.2%     -  806s
H    0     0                    19776.234114 37898.8405  91.6%     -  807s
H    0     0                    19919.487852 37898.8405  90.3%     -  807s
H    0     0                    20112.821823 37898.8405  88.4%     -  807s
     0     0 37898.3280    0  493 20112.8218 37898.3280  88.4%     -  810s
     0     0 37880.4348    0  453 20112.8218 37880.4348  88.3%     -  816s
     0     0 37879.5688    0  453 20112.8218 37879.5688  88.3%     -  819s
H    0     0                    20232.406197 37877.4757  87.2%     -  963s
     0     2 37877.4757    0  453 20232.4062 37877.4757  87.2%     -  982s
     1     3 37622.4923    1  427 20232.4062 37873.6760  87.2% 10793  993s
     2     4 37695.3059    1  423 20232.4062 37695.3059  86.3%  9766 1003s
     3     6 37405.9368    2  425 20232.4062 37694.7733  86.3% 10374 1017s
     5     9 37168.6590    3  454 20232.4062 37694.7733  86.3% 10465 1037s
     8    17 35865.1231    3  404 20232.4062 37404.4629  84.9% 12006 1062s
    16    34 35658.9613    4  412 20232.4062 37162.4592  83.7% 13416 1092s
    33    49 36427.5291    5  452 20232.4062 36628.6303  81.0% 21086 1251s
    48    79 35778.8510    6  433 20232.4062 36628.6303  81.0% 23123 1300s
H   53    79                    22237.156038 36628.6303  64.7% 22129 1300s
    78   163 35577.7377    7  436 22237.1560 36628.6303  64.7% 18266 1392s
   162   264 35497.4164    9  436 22237.1560 36628.6303  64.7% 11673 1437s
   263   333 35236.0509   12  408 22237.1560 36628.6303  64.7% 10637 1484s
   332   362 34939.5282   14  406 22237.1560 36628.6303  64.7%  9457 1524s
   361   398 33891.2836   12  401 22237.1560 36628.6303  64.7%  9249 1566s
H  365   398                    22238.491887 36628.6303  64.7%  9217 1566s
H  368   398                    22302.769421 36628.6303  64.2%  9154 1566s
H  371   398                    23006.273668 36628.6303  59.2%  9116 1566s
   397   485 32686.9190   15  413 23006.2737 36628.6303  59.2%  8996 1597s
   484   560 31919.0433   13  373 23006.2737 36628.6303  59.2%  8274 1623s
   559   642 31833.9614   14  375 23006.2737 36628.6303  59.2%  7843 1654s
   643   732 27485.4254   30  337 23006.2737 36628.6303  59.2%  7432 1684s
   733   815 27167.9673   32  325 23006.2737 36628.6303  59.2%  6990 1704s
   818   878 26670.3622   34  247 23006.2737 36628.6303  59.2%  6703 1723s
   894   950 23884.5003   36  134 23006.2737 36628.6303  59.2%  6466 1752s
   990   989 31009.6063   23  375 23006.2737 36628.6303  59.2%  6203 1780s
  1065  1043 29532.5454   21  249 23006.2737 36628.6303  59.2%  6048 1804s
  1141  1106 26543.9618   22  204 23006.2737 36628.6303  59.2%  5966 1829s
  1228  1162 26045.2658   23  257 23006.2737 36628.6303  59.2%  5843 1852s
  1320  1229 25896.1933   24  249 23006.2737 36628.6303  59.2%  5681 1880s
  1418  1242 25149.4138   26  294 23006.2737 36628.6303  59.2%  5525 1903s
H 1432  1242                    23015.092706 36628.6303  59.2%  5520 1903s
H 1435  1242                    23157.919190 36628.6303  58.2%  5514 1903s
H 1442  1242                    23309.437489 36628.6303  57.1%  5517 1903s
  1453  1284 25012.8250   27  286 23309.4375 36628.6303  57.1%  5523 1930s
  1540  1370 infeasible   31      23309.4375 36628.6303  57.1%  5467 1960s
  1654  1449 infeasible   35      23309.4375 36628.6303  57.1%  5372 2001s
  1785  1522 24852.4090   47  190 23309.4375 36628.6303  57.1%  5269 2031s
  1923  1574 infeasible   32      23309.4375 36628.6303  57.1%  5144 2083s
  2061  1629 infeasible   47      23309.4375 36628.6303  57.1%  5067 2114s
  2202  1714 25001.6424   36  159 23309.4375 36628.6303  57.1%  5017 2149s
  2326  1778 24038.1930   39  166 23309.4375 36628.6303  57.1%  4980 2190s
  2433  1827 23400.6040   48  132 23309.4375 36628.6303  57.1%  5020 2231s
  2553  1836     cutoff   48      23309.4375 36473.8334  56.5%  4998 2266s
H 2573  1833                    23335.529652 36473.8334  56.3%  5011 2266s
  2591  1878 23466.1397   37  284 23335.5297 36469.3682  56.3%  5037 2308s
  2685  1898 33648.5178    7  386 23335.5297 36469.3682  56.3%  5077 2350s
  2719  1927 33581.6628    8  405 23335.5297 35882.9319  53.8%  5112 2387s
H 2726  1910                    23485.283380 35882.9319  52.8%  5122 2387s
H 2764  1912                    23571.319759 35670.6853  51.3%  5138 2428s
H 2766  1904                    23593.626772 35670.6853  51.2%  5140 2428s
  2820  2012 32356.7410    9  374 23593.6268 35670.6853  51.2%  5166 2470s
  2966  2192 31842.6613   11  364 23593.6268 35607.9474  50.9%  5177 2517s
  3172  2361 31447.5770   14  337 23593.6268 35599.8764  50.9%  5093 2563s
  3403  2471 30402.4600   19  213 23593.6268 35599.8764  50.9%  5003 2610s
  3597  2533 29256.9989   22  227 23593.6268 35599.8764  50.9%  4967 2655s
H 3693  2520                    23624.950836 35496.1945  50.2%  4974 2655s
  3703  2685 28493.7012   28  142 23624.9508 35496.1945  50.2%  4983 2704s
H 3924  2682                    23631.890675 35496.1945  50.2%  4931 2741s
  3925  2683 29069.7572   36  453 23631.8907 35496.1945  50.2%  4930 2980s
  3927  2684 26952.4762   32  249 23631.8907 35496.1945  50.2%  4927 2994s
  3928  2685 30850.7665   24  400 23631.8907 35496.1945  50.2%  4926 3087s
  3929  2686 26069.4370   51  441 23631.8907 35496.1945  50.2%  4925 3148s
  3930  2686 30374.7565   25  462 23631.8907 35496.1945  50.2%  4923 3189s
  3931  2687 26777.0765   40  486 23631.8907 35496.1945  50.2%  4922 3216s
H 3931  2552                    23632.734142 35496.1945  50.2%  4922 3237s
  3933  2553 26936.9413   36  472 23632.7341 35496.1945  50.2%  4920 3257s
  3934  2554 26378.4064   37  497 23632.7341 35496.1945  50.2%  4918 3268s
  3935  2555 28541.5525   25  453 23632.7341 35496.1945  50.2%  4917 3279s
  3936  2555 23784.4231   59  460 23632.7341 35496.1945  50.2%  4916 3289s
  3937  2556 32178.7878   13  475 23632.7341 35496.1945  50.2%  4915 3295s
  3938  2557 25110.9273   32  468 23632.7341 35496.1945  50.2%  4913 3307s
  3939  2557 34366.3557   14  504 23632.7341 35496.1945  50.2%  4912 3314s
  3940  2558 29578.6555   13  480 23632.7341 35496.1945  50.2%  4911 3321s
  3941  2559 30836.4608   21  453 23632.7341 35496.1945  50.2%  4910 3347s
  3942  2559 31188.5335   14  426 23632.7341 35496.1945  50.2%  4909 3364s
  3943  2560 24828.2386   19  437 23632.7341 35496.1945  50.2%  4907 3370s
  3944  2561 25487.4057   46  425 23632.7341 35496.1945  50.2%  4906 3379s
  3945  2561 35235.9821   13  518 23632.7341 35496.1945  50.2%  4905 3387s
  3946  2562 32663.3842   16  513 23632.7341 35496.1945  50.2%  4904 3394s
  3947  2563 31219.9807   18  519 23632.7341 35496.1945  50.2%  4902 3401s
  3948  2563 33477.4589   12  527 23632.7341 35496.1945  50.2%  4901 3430s
  3949  2564 25506.8252   49  481 23632.7341 35496.1945  50.2%  4900 3441s
  3950  2565 29880.0151   21  485 23632.7341 35496.1945  50.2%  4899 3450s
  3951  2565 24756.0988   74  477 23632.7341 35496.1945  50.2%  4897 3459s
  3952  2566 28351.5808   34  484 23632.7341 35496.1945  50.2%  4896 3486s
  3953  2567 31495.6569   12  442 23632.7341 35496.1945  50.2%  4895 3495s
  3954  2567 31368.7767   10  431 23632.7341 35496.1945  50.2%  4894 3502s
  3955  2568 26990.7454   30  480 23632.7341 35496.1945  50.2%  4892 3509s
  3956  2569 29161.4945   22  501 23632.7341 35496.1945  50.2%  4891 3526s
  3957  2569 26960.9180   33  491 23632.7341 35496.1945  50.2%  4890 3533s
  3958  2570 32072.2431    9  422 23632.7341 35496.1945  50.2%  4889 3538s
  3959  2571 29034.6483   34  426 23632.7341 35496.1945  50.2%  4887 3544s
H 3959  2442                    23653.811304 35496.1945  50.1%  4887 3557s
  3960  2442 24205.2308   58  448 23653.8113 35496.1945  50.1%  4886 3562s
  3961  2443 34402.6206   11  457 23653.8113 35496.1945  50.1%  4885 3569s
  3962  2444 24282.2318   49  452 23653.8113 35496.1945  50.1%  4884 3574s
  3963  2444 23764.2277   35  434 23653.8113 35496.1945  50.1%  4883 3588s
  3964  2445 30522.7646   12  503 23653.8113 35496.1945  50.1%  4881 3598s

Cutting planes:
  Learned: 1
  Gomory: 15
  Implied bound: 32
  Projected implied bound: 254
  MIR: 861
  Mixing: 2
  Flow cover: 1015
  RLT: 38
  Relax-and-lift: 287

Explored 3964 nodes (20534908 simplex iterations) in 3600.03 seconds (8364.52 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23653.8 23632.7 23631.9 ... 23015.1

Time limit reached
Best objective 2.365381130420e+04, best bound 3.549619450285e+04, gap 50.0654%
  WARNING: Time limit reached. Using best solution found (gap: 50.07%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 23653.81, θ = 170501.81
  Upper Bound (UB) = 23653.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170501.81
  [DEBUG]   ✓ Scenario 0: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 170501.81 ≤ Q = 170501.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 170501.81 ≤ Q = 170501.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 170501.81 ≤ Q = 170501.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 170501.81 ≤ Q = 170501.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 170501.81 ≤ Q = 170501.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e72ffe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfa18d002
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.308811e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1321 nonzeros
Found heuristic solution: objective 6098508.4655
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.546689e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154668.92    0  126 6098508.47 -154668.92   103%     -    0s
H    0     0                    -116854.4928 -154668.92  32.4%     -    0s
H    0     0                    -118393.4755 -154668.92  30.6%     -    0s
H    0     0                    -125830.1123 -154668.92  22.9%     -    0s
     0     0 -137922.11    0   97 -125830.11 -137922.11  9.61%     -    0s
H    0     0                    -134209.4252 -137873.96  2.73%     -    0s
     0     0 -137221.87    0   96 -134209.43 -137221.87  2.24%     -    0s
     0     0 -136450.77    0   76 -134209.43 -136450.77  1.67%     -    0s
H    0     0                    -135207.5233 -136450.77  0.92%     -    0s
H    0     0                    -135500.5679 -136430.17  0.69%     -    0s
     0     0 -136416.60    0   72 -135500.57 -136416.60  0.68%     -    0s
H    0     0                    -135506.5967 -136416.60  0.67%     -    0s
     0     0 -136007.61    0   42 -135506.60 -136007.61  0.37%     -    0s
     0     0 -135946.43    0   40 -135506.60 -135946.43  0.32%     -    0s
     0     0 -135946.41    0   41 -135506.60 -135946.41  0.32%     -    0s
     0     0 -135780.80    0   19 -135506.60 -135780.80  0.20%     -    0s
     0     0 -135780.54    0   18 -135506.60 -135780.54  0.20%     -    0s
     0     0 -135696.70    0   17 -135506.60 -135696.70  0.14%     -    0s
     0     0 -135690.48    0   16 -135506.60 -135690.48  0.14%     -    0s
     0     0 -135689.09    0   16 -135506.60 -135689.09  0.13%     -    0s
     0     0 -135645.45    0   13 -135506.60 -135645.45  0.10%     -    0s
     0     0 -135645.45    0   20 -135506.60 -135645.45  0.10%     -    0s
     0     0 -135609.96    0    5 -135506.60 -135609.96  0.08%     -    0s
H    0     0                    -135532.9448 -135595.01  0.05%     -    0s
*    0     0               0    -135565.5717 -135565.57  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 8
  Flow cover: 16
  Relax-and-lift: 6

Explored 1 nodes (782 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135566 -135533 -135507 ... -116854
No other solutions better than -135566

Optimal solution found (tolerance 1.00e-04)
Best objective -1.355655716552e+05, best bound -1.355655716552e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 156995.56
  Scenario: 46 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135565.57
  [DEBUG]   S×d_nominal = 292561.14
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 292561.14 + -135565.57 = 156995.56
  [DEBUG]   Current θ from Master = 170501.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13506.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10147.57
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = -124.6662, Absolute Gap = 124.6662, Relative Gap = -0.005270
  *** CONVERGED (small negative gap: -124.67 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 13
Total Time: 25450.15s
Converged: True
Final Lower Bound: 23778.4775
Final Upper Bound: 23653.8113
Final Gap: -124.666160
Number of Critical Scenarios: 13
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [4, 5, 6, 8] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 5 customers  Mode 2: 45 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 13
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-04 19:35:07
Total Time: 25450.15s
Optimal Value: 23778.48
Lower Bound: 23778.48
Upper Bound: 23653.81
Gap: -124.666160
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [4, 5, 6, 8] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed19_HD_gamma20_20260104_193507.csv

Total Execution Time: 25450.44 seconds
End Time: 2026-01-04 19:35:07

All tasks completed successfully!

