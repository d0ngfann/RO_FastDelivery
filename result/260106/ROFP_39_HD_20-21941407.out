
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 39
DI Scenario: HD
Start Time: 2026-01-05 14:42:14
================================================================================
Loading data from data/DH_data_full_seed39.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.393', '1.942'] (k=0.818)
  Product 1: ['1.000', '1.457', '2.123'] (k=0.928)
  Product 2: ['1.000', '1.461', '2.135'] (k=0.935)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1013, max=1554
  DC capacity (MC): min=417, max=752

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.43, max=34.69, count=83
  Deviation (μ̂): min=4.06, max=9.82

Costs:
  Plant fixed cost: min=5018, max=9712
  DC fixed cost: min=3018, max=5791
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.393', '1.942'] (k=0.818)
    Product 1: ['1.000', '1.457', '2.123'] (k=0.928)
    Product 2: ['1.000', '1.461', '2.135'] (k=0.935)
  MD:
    Product 0: ['1.000', '1.295', '1.677'] (k=0.637)
    Product 1: ['1.000', '1.167', '1.361'] (k=0.380)
    Product 2: ['1.000', '1.278', '1.634'] (k=0.605)
  LD:
    Product 0: ['1.000', '1.116', '1.245'] (k=0.270)
    Product 1: ['1.000', '1.116', '1.246'] (k=0.272)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
  Mixed:
    Product 0: ['1.000', '1.393', '1.942'] (k=0.818)
    Product 1: ['1.000', '1.167', '1.361'] (k=0.380)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0x7a839ec5
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.10s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -211974.9906
Found heuristic solution: objective -186497.3382

Root relaxation: objective 1.795975e+05, 5648 iterations, 0.49 seconds (0.53 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 179597.518    0  524 -186497.34 179597.518   196%     -    0s
H    0     0                    -183205.6577 179597.518   198%     -    0s
     0     0 157039.691    0  707 -183205.66 157039.691   186%     -    2s
     0     0 156518.838    0  714 -183205.66 156518.838   185%     -    2s
     0     0 156495.667    0  721 -183205.66 156495.667   185%     -    2s
     0     0 156495.383    0  722 -183205.66 156495.383   185%     -    2s
     0     0 137040.144    0  511 -183205.66 137040.144   175%     -    4s
     0     0 136146.916    0  520 -183205.66 136146.916   174%     -    4s
     0     0 135986.067    0  475 -183205.66 135986.067   174%     -    4s
     0     0 135950.985    0  560 -183205.66 135950.985   174%     -    4s
     0     0 135946.769    0  564 -183205.66 135946.769   174%     -    4s
H    0     0                    -164659.6907 135946.769   183%     -    5s
H    0     0                    -125823.6822 135946.769   208%     -    5s
H    0     0                    -76485.82440 126644.430   266%     -    6s
H    0     0                    53603.247597 126644.430   136%     -    6s
     0     0 126644.430    0  467 53603.2476 126644.430   136%     -    6s
     0     0 125816.018    0  470 53603.2476 125816.018   135%     -    6s
     0     0 125713.440    0  455 53603.2476 125713.440   135%     -    6s
     0     0 125669.619    0  448 53603.2476 125669.619   134%     -    6s
     0     0 125664.859    0  459 53603.2476 125664.859   134%     -    6s
H    0     0                    54212.022621 125664.859   132%     -    7s
H    0     0                    54301.395960 125664.859   131%     -    7s
H    0     0                    56167.346913 125664.859   124%     -    7s
H    0     0                    57088.068624 125664.859   120%     -    7s
H    0     0                    59615.990395 125664.859   111%     -    7s
H    0     0                    59951.516584 125664.859   110%     -    7s
H    0     0                    60034.152260 125664.859   109%     -    7s
H    0     0                    60713.241350 125664.859   107%     -    7s
H    0     0                    60771.081630 125664.859   107%     -    7s
H    0     0                    60773.851081 122674.305   102%     -    8s
H    0     0                    66046.369411 122674.305  85.7%     -    8s
     0     0 122674.305    0  480 66046.3694 122674.305  85.7%     -    8s
     0     0 122039.903    0  515 66046.3694 122039.903  84.8%     -    9s
     0     0 121811.119    0  525 66046.3694 121811.119  84.4%     -    9s
     0     0 121755.543    0  546 66046.3694 121755.543  84.3%     -    9s
H    0     0                    66536.822682 121728.846  82.9%     -    9s
H    0     0                    68152.760655 121728.846  78.6%     -    9s
     0     0 121728.846    0  559 68152.7607 121728.846  78.6%     -    9s
     0     0 121722.017    0  565 68152.7607 121722.017  78.6%     -    9s
H    0     0                    71824.542250 120381.338  67.6%     -   10s
H    0     0                    73074.877737 120381.338  64.7%     -   10s
H    0     0                    73728.100408 120381.338  63.3%     -   10s
H    0     0                    73759.301773 120381.338  63.2%     -   10s
     0     0 120381.338    0  577 73759.3018 120381.338  63.2%     -   10s
     0     0 120086.698    0  626 73759.3018 120086.698  62.8%     -   10s
     0     0 119963.231    0  545 73759.3018 119963.231  62.6%     -   11s
     0     0 119927.440    0  641 73759.3018 119927.440  62.6%     -   11s
     0     0 119918.276    0  644 73759.3018 119918.276  62.6%     -   11s
     0     0 118859.978    0  558 73759.3018 118859.978  61.1%     -   12s
     0     0 118577.440    0  624 73759.3018 118577.440  60.8%     -   12s
     0     0 118517.379    0  566 73759.3018 118517.379  60.7%     -   13s
     0     0 118502.162    0  654 73759.3018 118502.162  60.7%     -   13s
     0     0 117908.766    0  669 73759.3018 117908.766  59.9%     -   14s
H    0     0                    73971.578771 117682.198  59.1%     -   14s
H    0     0                    74539.826377 117682.198  57.9%     -   14s
H    0     0                    75298.274306 117682.198  56.3%     -   14s
H    0     0                    75509.674455 117682.198  55.9%     -   14s
H    0     0                    75653.817341 117682.198  55.6%     -   14s
H    0     0                    75846.743101 117682.198  55.2%     -   14s
     0     0 117682.198    0  693 75846.7431 117682.198  55.2%     -   14s
     0     0 117628.998    0  698 75846.7431 117628.998  55.1%     -   14s
     0     0 117593.969    0  715 75846.7431 117593.969  55.0%     -   14s
     0     0 117588.747    0  728 75846.7431 117588.747  55.0%     -   14s
     0     0 117020.271    0  517 75846.7431 117020.271  54.3%     -   15s
     0     0 116920.549    0  637 75846.7431 116920.549  54.2%     -   16s
     0     0 116877.039    0  641 75846.7431 116877.039  54.1%     -   16s
     0     0 116858.833    0  752 75846.7431 116858.833  54.1%     -   16s
     0     0 116514.606    0  518 75846.7431 116514.606  53.6%     -   17s
     0     0 116399.609    0  577 75846.7431 116399.609  53.5%     -   18s
     0     0 116366.674    0  585 75846.7431 116366.674  53.4%     -   18s
     0     0 116138.109    0  665 75846.7431 116138.109  53.1%     -   18s
     0     0 116138.085    0  665 75846.7431 116138.085  53.1%     -   19s
H    0     0                    75881.146652 116138.085  53.1%     -   20s
H    0     2                    76118.456910 116138.085  52.6%     -   20s
     0     2 116138.085    0  665 76118.4569 116138.085  52.6%     -   20s
    31    64 115021.829    5  446 76118.4569 115156.481  51.3%  2002   26s
   328   371 114379.665   11  504 76118.4569 115020.954  51.1%   844   30s
   540   575 113265.927   15  589 76118.4569 115020.954  51.1%   791   35s
H  554   575                    76993.887550 115020.954  49.4%   788   35s
H  569   575                    77724.512222 115020.954  48.0%   785   35s
H  833   908                    78867.458062 115020.954  45.8%   705   38s
H  866   908                    78996.686115 115020.954  45.6%   704   38s
   994  1076 110905.947   18  330 78996.6861 115020.954  45.6%   670   40s
H  996  1076                    78999.149939 115020.954  45.6%   671   40s
H 1002  1076                    79861.536768 115020.954  44.0%   674   40s
H 1178  1226                    80401.592299 114991.227  43.0%   657   42s
H 1181  1226                    82317.548368 114991.227  39.7%   659   42s
H 1204  1226                    82987.007426 114991.227  38.6%   666   42s
H 1344  1321                    83324.512787 114933.187  37.9%   669   44s
H 1350  1321                    83855.994672 114933.187  37.1%   671   44s
  1396  1367 107640.862   21  577 83855.9947 114933.187  37.1%   680   45s
H 1451  1407                    84001.805578 114933.187  36.8%   710   47s
H 1490  1407                    84008.554980 114933.187  36.8%   730   47s
  1559  1520 102489.341   22  675 84008.5550 114933.187  36.8%   758   50s
H 1617  1520                    84346.161205 114933.187  36.3%   773   50s
  1869  1790 96891.3169   24  433 84346.1612 114933.187  36.3%   812   56s
  1947  1852 95648.5867   25  601 84346.1612 114933.187  36.3%   823   60s
H 1977  1852                    84347.605568 114933.187  36.3%   824   60s
  2350  2357 94464.5146   29  395 84347.6056 114933.187  36.3%   774   65s
H 2645  2503                    84352.931174 114933.187  36.3%   740   67s
  2917  2726 87906.1688   36  345 84352.9312 114795.517  36.1%   733   71s
  3249  3046 109771.642    9  525 84352.9312 114673.363  35.9%   735   75s
  3457  3047 110145.871   23  665 84352.9312 114673.363  35.9%   725   82s
  3473  3058 108996.137   13  360 84352.9312 108996.137  29.2%   722   85s
  3507  3082 89064.1258   39  199 84352.9312 107327.172  27.2%   719   90s
  3532  3099 87792.5599   47  409 84352.9312 107327.172  27.2%   714   96s
  3774  3286 93455.4007   32  293 84352.9312 102096.266  21.0%   700  100s
  4161  3363 87596.5827   37  252 84352.9312 101071.929  19.8%   672  105s
  4575  3437 90580.4953   36  200 84352.9312 99785.0866  18.3%   641  110s
H 4604  3271                    85344.536551 99785.0866  16.9%   638  110s
H 4763  3179                    85973.687781 99272.8146  15.5%   625  111s
H 4780  3034                    85977.270606 99272.8146  15.5%   623  111s
H 4848  2878                    86037.746033 99231.3645  15.3%   617  111s
H 4885  2739                    86150.411014 99058.3373  15.0%   614  111s
H 5074  2671                    86168.552651 98658.0810  14.5%   601  112s
H 5500  2589                    86318.986782 98641.2048  14.3%   572  113s
  5751  2699 87893.3899   37  198 86318.9868 98386.3505  14.0%   553  115s
H 5828  2564                    86465.921033 98386.3505  13.8%   547  115s
H 5845  2456                    86578.880812 98196.6074  13.4%   547  115s
H 7139  2358                    86725.815063 97285.6064  12.2%   487  118s
  8027  2212 89013.1153   39  235 86725.8151 97029.0064  11.9%   455  120s
H 8194  2015                    86991.615451 97029.0064  11.5%   451  120s
H 9611  1960                    87076.429288 95086.3377  9.20%   419  123s
 10560  2133 90650.1372   38  244 87076.4293 94509.0566  8.54%   402  125s
H11663  2163                    87347.365118 93915.2739  7.52%   386  126s
H12038  2134                    87572.587507 93889.2980  7.21%   381  127s
H12046  2051                    87773.648536 93752.8915  6.81%   381  127s
 13433  2045 91278.1236   36  241 87773.6485 93061.3096  6.02%   365  130s
H13583  2039                    87790.729981 93042.5003  5.98%   364  130s
H13859  1969                    88211.966643 92961.9087  5.38%   361  131s
*14494  1833             110    88289.502211 92722.3657  5.02%   354  132s
 16568  1433 89032.7367   41  286 88289.5022 91803.4019  3.98%   337  135s
*20316  2159              88    88429.439123 90223.0409  2.03%   300  138s
 26421  4942 88650.1725   77   32 88429.4391 89481.9854  1.19%   239  140s
H36508  6720                    88467.868974 89126.8699  0.74%   184  141s
*49600  6864              89    88599.502684 88932.8006  0.38%   146  144s
 51125  5971     cutoff   74      88599.5027 88917.0734  0.36%   143  145s

Cutting planes:
  Learned: 2
  Gomory: 3
  Lift-and-project: 3
  MIR: 417
  Mixing: 1
  Flow cover: 303
  RLT: 1
  Relax-and-lift: 26

Explored 61021 nodes (7656785 simplex iterations) in 146.38 seconds (220.43 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 88599.5 88467.9 88429.4 ... 87076.4

Optimal solution found (tolerance 1.00e-04)
Best objective 8.859950268448e+04, best bound 8.859950268448e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 146.40s
  Master Objective (UB) = 88599.50, θ = 263612.77
  Upper Bound (UB) = 88599.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 263612.77
  [DEBUG]   ✓ Scenario 0: θ = 263612.77 ≤ Q = 263612.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5dbf6518
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5dbf6518
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.235575e+13
Presolve removed 2580 rows and 1869 columns
Presolve time: 0.01s
Presolved: 513 rows, 520 columns, 1456 nonzeros
Found heuristic solution: objective 5871815.9616
Variable types: 354 continuous, 166 integer (166 binary)

Root relaxation: objective -1.714217e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171421.70    0  123 5871815.96 -171421.70   103%     -    0s
H    0     0                    -138545.7771 -171421.70  23.7%     -    0s
H    0     0                    -139541.2419 -171421.70  22.8%     -    0s
*    0     0               0    -141374.7314 -141374.73  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 206

Explored 1 nodes (376 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -141375 -139541 -138546 ... 1.23558e+13
No other solutions better than -141375

Optimal solution found (tolerance 1.00e-04)
Best objective -1.413747313994e+05, best bound -1.413747313994e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 232605.37
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141374.73
  [DEBUG]   S×d_nominal = 373980.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 373980.10 + -141374.73 = 232605.37
  [DEBUG]   Current θ from Master = 263612.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31007.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 57592.11
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 31007.3954, Absolute Gap = 31007.3954, Relative Gap = 0.349973
  Not converged yet (gap = 31007.40 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0x7e4696ff
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 57592.1 (0.02s)
Loaded MIP start from previous solve with objective 57592.1

Presolve removed 13565 rows and 5504 columns
Presolve time: 0.49s
Presolved: 18398 rows, 9236 columns, 101918 nonzeros
Variable types: 6977 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.087383e+05, 10405 iterations, 1.52 seconds (2.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 108738.321    0  219 57592.1073 108738.321  88.8%     -    2s
H    0     0                    58310.036235 108738.321  86.5%     -    2s
H    0     0                    60065.633658 108738.321  81.0%     -    2s
     0     0 101326.741    0  225 60065.6337 101326.741  68.7%     -    4s
H    0     0                    60077.445519 101309.902  68.6%     -    4s
H    0     0                    60899.651996 100903.251  65.7%     -    4s
H    0     0                    61180.447294 100903.251  64.9%     -    4s
H    0     0                    61307.526135 100903.251  64.6%     -    4s
     0     0 100903.251    0  262 61307.5261 100903.251  64.6%     -    4s
H    0     0                    61629.041137 100900.693  63.7%     -    4s
     0     0 100900.693    0  262 61629.0411 100900.693  63.7%     -    4s
     0     0 100900.316    0  264 61629.0411 100900.316  63.7%     -    4s
     0     0 95821.0025    0  295 61629.0411 95821.0025  55.5%     -    6s
     0     0 95112.7277    0  331 61629.0411 95112.7277  54.3%     -    6s
     0     0 95006.5628    0  337 61629.0411 95006.5628  54.2%     -    7s
     0     0 94974.5972    0  343 61629.0411 94974.5972  54.1%     -    7s
     0     0 94962.3292    0  342 61629.0411 94962.3292  54.1%     -    7s
     0     0 94960.1741    0  339 61629.0411 94960.1741  54.1%     -    7s
     0     0 94959.2380    0  349 61629.0411 94959.2380  54.1%     -    7s
     0     0 92583.8648    0  314 61629.0411 92583.8648  50.2%     -    9s
H    0     0                    61878.133542 92583.0797  49.6%     -    9s
     0     0 91842.1274    0  346 61878.1335 91842.1274  48.4%     -    9s
     0     0 91648.1842    0  363 61878.1335 91648.1842  48.1%     -   10s
     0     0 91569.5522    0  375 61878.1335 91569.5522  48.0%     -   10s
     0     0 91552.4070    0  362 61878.1335 91552.4070  48.0%     -   10s
H    0     0                    61898.989217 91538.6776  47.9%     -   10s
     0     0 91538.6776    0  373 61898.9892 91538.6776  47.9%     -   10s
     0     0 91535.6465    0  386 61898.9892 91535.6465  47.9%     -   10s
     0     0 91535.6465    0  389 61898.9892 91535.6465  47.9%     -   10s
H    0     0                    62220.494216 89435.8072  43.7%     -   13s
H    0     0                    62435.564528 89435.8072  43.2%     -   13s
     0     0 89435.8072    0  429 62435.5645 89435.8072  43.2%     -   13s
     0     0 88898.2100    0  434 62435.5645 88898.2100  42.4%     -   14s
     0     0 88622.0537    0  446 62435.5645 88622.0537  41.9%     -   15s
H    0     0                    62462.487456 88526.4883  41.7%     -   15s
     0     0 88526.4883    0  448 62462.4875 88526.4883  41.7%     -   15s
     0     0 88499.1575    0  467 62462.4875 88499.1575  41.7%     -   16s
     0     0 88490.1969    0  476 62462.4875 88490.1969  41.7%     -   16s
     0     0 88485.4597    0  469 62462.4875 88485.4597  41.7%     -   16s
     0     0 88481.6796    0  471 62462.4875 88481.6796  41.7%     -   16s
     0     0 87922.9401    0  409 62462.4875 87922.9401  40.8%     -   17s
H    0     0                    62507.850629 87922.5679  40.7%     -   17s
H    0     0                    62972.558247 87922.5679  39.6%     -   17s
H    0     0                    62999.075984 87922.5679  39.6%     -   17s
H    0     0                    63168.685550 87922.5679  39.2%     -   17s
H    0     0                    63189.889166 87922.5679  39.1%     -   17s
     0     0 87748.1054    0  370 63189.8892 87748.1054  38.9%     -   18s
     0     0 87686.3251    0  388 63189.8892 87686.3251  38.8%     -   18s
     0     0 87671.4217    0  385 63189.8892 87671.4217  38.7%     -   18s
     0     0 87665.2662    0  383 63189.8892 87665.2662  38.7%     -   18s
     0     0 87660.2666    0  392 63189.8892 87660.2666  38.7%     -   18s
     0     0 87468.8354    0  395 63189.8892 87468.8354  38.4%     -   19s
     0     0 87332.4884    0  442 63189.8892 87332.4884  38.2%     -   20s
     0     0 87296.2393    0  447 63189.8892 87296.2393  38.1%     -   20s
     0     0 87284.8336    0  450 63189.8892 87284.8336  38.1%     -   20s
     0     0 87280.5877    0  457 63189.8892 87280.5877  38.1%     -   20s
     0     0 87142.2566    0  371 63189.8892 87142.2566  37.9%     -   21s
     0     0 87117.0987    0  375 63189.8892 87117.0987  37.9%     -   21s
     0     0 87109.9039    0  416 63189.8892 87109.9039  37.9%     -   21s
     0     0 87108.0328    0  371 63189.8892 87108.0328  37.9%     -   22s
     0     0 87057.6766    0  372 63189.8892 87057.6766  37.8%     -   22s
H    0     0                    63613.172295 87057.5996  36.9%     -   23s
     0     0 87040.2884    0  437 63613.1723 87040.2884  36.8%     -   23s
     0     0 87028.1415    0  389 63613.1723 87028.1415  36.8%     -   23s
     0     0 87026.7882    0  394 63613.1723 87026.7882  36.8%     -   23s
     0     0 87008.6318    0  416 63613.1723 87008.6318  36.8%     -   24s
H    0     0                    63688.795541 87008.0360  36.6%     -   24s
     0     0 86993.5760    0  378 63688.7955 86993.5760  36.6%     -   24s
     0     0 86992.4005    0  375 63688.7955 86992.4005  36.6%     -   24s
     0     0 86972.8440    0  385 63688.7955 86972.8440  36.6%     -   24s
     0     0 86972.0647    0  385 63688.7955 86972.0647  36.6%     -   25s
     0     2 86971.7509    0  385 63688.7955 86971.7509  36.6%     -   28s
     3     8 86673.7823    2  407 63688.7955 86862.6249  36.4%   618   30s
    31    64 86004.4055    5  390 63688.7955 86150.7131  35.3%  1505   35s
H   33    64                    65045.820726 86150.7131  32.4%  1439   35s
H  114   232                    65342.522324 86001.8090  31.6%  1058   39s
   231   264 85726.0861   10  448 65342.5223 86001.8090  31.6%   724   40s
H  241   264                    65344.471697 86001.8090  31.6%   721   40s
H  244   264                    65476.084188 86001.8090  31.3%   717   40s
H  250   264                    65635.338450 86001.8090  31.0%   711   40s
H  266   335                    65671.822658 86001.8090  31.0%   701   41s
H  418   486                    65753.422962 86001.8090  30.8%   641   43s
   550   583 85040.8522   14  405 65753.4230 86001.8090  30.8%   589   46s
   656   691 84518.0277   16  362 65753.4230 86001.8090  30.8%   586   50s
   794   840 84079.5024   20  405 65753.4230 86001.8090  30.8%   601   56s
H  895   897                    65807.298186 86001.8090  30.7%   588   56s
   981  1065 83676.6352   22  337 65807.2982 86001.8090  30.7%   575   60s
  1377  1343 66646.3721   64  204 65807.2982 85725.8579  30.3%   537   65s
  1573  1548 81593.0304   28  452 65807.2982 85708.3738  30.2%   554   71s
  1714  1660 80495.4280   29  396 65807.2982 85708.3738  30.2%   586   75s
  1925  1855 79550.6543   33  312 65807.2982 85618.7340  30.1%   632   81s
H 1943  1855                    65883.861730 85618.7340  30.0%   638   81s
  2063  2050 77051.5973   36  377 65883.8617 85618.7340  30.0%   653   85s
  2525  2560 75156.6316   43  366 65883.8617 85595.8162  29.9%   626   92s
  2924  2725 72894.1006   50  314 65883.8617 85492.2344  29.8%   602   97s
  2961  2755 72829.8573   51  309 65883.8617 85492.2344  29.8%   603  100s
H 3016  2779                    66134.844480 85492.2344  29.3%   604  102s
  3034  2944 72379.2157   53  300 66134.8445 85492.2344  29.3%   604  105s
  3479  3279 67692.9716   66  247 66134.8445 85051.0490  28.6%   589  110s
H 3699  3279                    66195.748390 84895.6076  28.2%   583  116s
  3700  3280 75725.9635   29  385 66195.7484 84895.6076  28.2%   583  133s
  3702  3281 74823.5925   37   69 66195.7484 84895.6076  28.2%   583  135s
H 3703  3117                    66210.350207 84895.6076  28.2%   582  138s
H 3703  2961                    66318.748139 84895.6076  28.0%   582  138s
  3706  2963 69355.0447   29  371 66318.7481 84895.6076  28.0%   582  140s
H 3706  2815                    66319.653553 84895.6076  28.0%   582  140s
  3718  2823 82589.8956   17  401 66319.6536 84895.6076  28.0%   580  145s
  3728  2830 78665.7152   14  429 66319.6536 84895.6076  28.0%   578  150s
H 3729  2688                    66553.289397 84895.6076  27.6%   578  151s
  3737  2694 72600.7677   57  411 66553.2894 84895.6076  27.6%   577  155s
  3743  2698 80193.6453   11  430 66553.2894 84895.6076  27.6%   576  161s
H 3743  2562                    66577.279267 84895.6076  27.5%   576  163s
H 3743  2434                    66637.854969 84895.6076  27.4%   576  164s
  3745  2438 84895.6076   10  363 66637.8550 84895.6076  27.4%   584  166s
  3759  2461 80126.0215   13  312 66637.8550 83849.9121  25.8%   586  170s
H 3775  2365                    66639.804342 83476.1593  25.3%   588  173s
H 3776  2249                    66663.790114 83476.1593  25.2%   588  173s
  3839  2311 73090.3840   16  263 66663.7901 82917.2216  24.4%   597  175s
H 3842  2199                    66665.739487 82917.2216  24.4%   597  175s
H 3881  2081                    66854.339426 82917.2216  24.0%   600  175s
  4025  2200 71629.0116   19  237 66854.3394 82917.2216  24.0%   603  180s
  4243  2241     cutoff   22      66854.3394 82869.7463  24.0%   602  185s
H 4260  2136                    66923.096214 82869.7463  23.8%   602  185s
  4414  2212 76687.5498   17  322 66923.0962 81381.9670  21.6%   601  190s
  4668  2250 76748.0714   18  339 66923.0962 80678.3154  20.6%   600  195s
H 4721  2156                    67003.028855 80678.3154  20.4%   597  197s
  4841  2189 70638.3877   20  227 67003.0289 80305.6191  19.9%   595  201s
H 5030  2110                    67609.827541 80305.6191  18.8%   589  204s
  5077  2110 72811.4328   19  282 67609.8275 79905.5761  18.2%   587  206s
  5413  2117 68914.4165   25  203 67609.8275 79704.0606  17.9%   581  211s
  5666  2104     cutoff   27      67609.8275 79000.1782  16.8%   574  215s
  5958  2082 72337.9242   20  314 67609.8275 78949.9060  16.8%   571  221s
H 6095  1976                    67626.079854 78551.4840  16.2%   568  223s
  6110  2012 71484.4732   22  256 67626.0799 78551.4840  16.2%   568  225s
  6467  2019 75751.2726   19  329 67626.0799 78467.6257  16.0%   561  230s
  6893  2018 74667.5228   17  376 67626.0799 77761.9582  15.0%   554  235s
H 7101  1902                    67630.039254 77619.4013  14.8%   552  237s
  7189  1936 69421.9990   27  278 67630.0393 77619.4013  14.8%   550  240s
  7684  1840 68155.6388   24  254 67630.0393 77113.8092  14.0%   544  245s
H 7709  1755                    67724.206646 77113.8092  13.9%   544  245s
  8131  1747 74657.0590   20  308 67724.2066 76697.2440  13.2%   539  251s
  8743  1858 72533.0175   21  285 67724.2066 76568.2354  13.1%   534  257s
H 9002  1865                    67823.524568 76568.2354  12.9%   532  259s
H 9004  1861                    67855.295988 76568.2354  12.8%   532  259s
H 9026  1855                    67960.211652 76025.6653  11.9%   532  259s
  9048  1851     cutoff   24      67960.2117 75994.1633  11.8%   532  262s
  9475  1891 70782.6638   24  214 67960.2117 75777.2656  11.5%   526  266s
 10168  1954 68381.8277   25  246 67960.2117 75423.9579  11.0%   518  273s
 10439  1982     cutoff   25      67960.2117 75313.7628  10.8%   516  277s
 10879  2044 70911.9577   18  202 67960.2117 74963.4961  10.3%   513  280s
 11760  2075 70666.1196   19  266 67960.2117 74718.8047  9.94%   508  288s
 12254  2081     cutoff   23      67960.2117 74375.5757  9.44%   504  292s
 12744  2094     cutoff   24      67960.2117 74138.3386  9.09%   501  296s
 13278  2082 70713.6235   23  297 67960.2117 73832.2078  8.64%   498  300s
 14233  2002 69809.2935   19  376 67960.2117 73313.3838  7.88%   493  309s
 14871  1946 70589.1491   19  265 67960.2117 73084.7283  7.54%   489  314s
 15486  1875     cutoff   24      67960.2117 72797.1304  7.12%   486  318s
 16090  1811 infeasible   26      67960.2117 72531.2740  6.73%   484  324s
 16592  1661     cutoff   19      67960.2117 72421.1701  6.56%   482  329s
 17387  1485     cutoff   22      67960.2117 71966.0349  5.89%   477  334s
 18136  1161 infeasible   23      67960.2117 71604.3753  5.36%   474  339s
 19048   753 69241.8310   23  280 67960.2117 71068.6983  4.57%   468  344s
 20053   229     cutoff   19      67960.2117 70618.6348  3.91%   460  349s
 21423   730     cutoff   23      67960.2117 70128.3030  3.19%   440  351s
*21524   730              73    68004.160522 70128.3030  3.12%   438  351s
*22358   730              95    68026.692846 69914.0849  2.77%   423  351s
H23891   705                    68079.757739 68403.7994  0.48%   398  354s
H23927   705                    68087.731962 68403.7994  0.46%   397  354s
 23964   121 68253.4553   51   28 68087.7320 68395.4318  0.45%   397  356s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 411
  Mixing: 2
  Flow cover: 685
  RLT: 3
  Relax-and-lift: 48

Explored 26973 nodes (9595690 simplex iterations) in 357.63 seconds (648.45 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 68087.7 68079.8 68026.7 ... 67609.8

Optimal solution found (tolerance 1.00e-04)
Best objective 6.808773196226e+04, best bound 6.808773196226e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 357.63s
  Master Objective (UB) = 68087.73, θ = 218080.33
  Upper Bound (UB) = 68087.73

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 218080.33
  [DEBUG]   ✓ Scenario 0: θ = 218080.33 ≤ Q = 218080.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 218080.33 ≤ Q = 218080.33 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x56890bb1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa976f44f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.242767e+13
Presolve removed 2586 rows and 1876 columns
Presolve time: 0.01s
Presolved: 507 rows, 513 columns, 1431 nonzeros
Found heuristic solution: objective 5978600.2116
Variable types: 348 continuous, 165 integer (165 binary)
Found heuristic solution: objective 5978247.1978

Root relaxation: objective -1.667106e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166710.57    0  127 5978247.20 -166710.57   103%     -    0s
H    0     0                    -150786.9089 -166710.57  10.6%     -    0s
     0     0 -157398.80    0  111 -150786.91 -157398.80  4.38%     -    0s
H    0     0                    -155671.0968 -157306.15  1.05%     -    0s
     0     0 -156621.29    0  103 -155671.10 -156621.29  0.61%     -    0s
     0     0 -156615.74    0  103 -155671.10 -156615.74  0.61%     -    0s
     0     0 -156306.95    0   98 -155671.10 -156306.95  0.41%     -    0s
H    0     0                    -155953.5204 -156281.43  0.21%     -    0s
     0     0 -156167.00    0   88 -155953.52 -156167.00  0.14%     -    0s
     0     0 -156156.67    0   88 -155953.52 -156156.67  0.13%     -    0s
     0     0 -156144.61    0   33 -155953.52 -156144.61  0.12%     -    0s
     0     0 -156116.11    0   26 -155953.52 -156116.11  0.10%     -    0s
     0     0 -156081.57    0   18 -155953.52 -156081.57  0.08%     -    0s
     0     0 -156081.51    0   14 -155953.52 -156081.51  0.08%     -    0s
H    0     0                    -155971.8505 -156055.01  0.05%     -    0s
     0     0 -156055.01    0   13 -155971.85 -156055.01  0.05%     -    0s
     0     0 -156049.08    0   10 -155971.85 -156049.08  0.05%     -    0s
     0     0 -156048.38    0   11 -155971.85 -156048.38  0.05%     -    0s
     0     0 -156002.18    0    8 -155971.85 -156002.18  0.02%     -    0s
     0     0 -156002.18    0    7 -155971.85 -156002.18  0.02%     -    0s
     0     0          -    0      -155971.85 -155984.46  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  MIR: 3
  RLT: 1

Explored 1 nodes (787 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -155972 -155954 -155918 ... 1.24277e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.559718504837e+05, best bound -1.559844562844e+05, gap 0.0081%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 194614.62
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -155971.85
  [DEBUG]   S×d_nominal = 350586.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 350586.47 + -155971.85 = 194614.62
  [DEBUG]   Current θ from Master = 218080.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23465.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44622.02
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 10495.6247, Absolute Gap = 10495.6247, Relative Gap = 0.154149
  Not converged yet (gap = 10495.62 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0x88bd2ebb
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 44622 (0.03s)
Loaded MIP start from previous solve with objective 44622

Presolve removed 20321 rows and 8251 columns
Presolve time: 0.67s
Presolved: 26932 rows, 12729 columns, 165704 nonzeros
Variable types: 10470 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.19s

Solved with dual simplex

Root relaxation: objective 9.964924e+04, 17100 iterations, 4.04 seconds (5.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99649.2390    0   66 44622.0157 99649.2390   123%     -    4s
H    0     0                    45081.868258 99649.2390   121%     -    5s
H    0     0                    46776.659516 99649.2390   113%     -    5s
H    0     0                    50127.641829 99649.2390  98.8%     -    5s
H    0     0                    55338.947727 99649.2390  80.1%     -    5s
H    0     0                    55847.768710 99649.2390  78.4%     -    5s
H    0     0                    55852.771337 99649.2390  78.4%     -    5s
H    0     0                    55857.700771 99649.2390  78.4%     -    5s
     0     0 94821.4402    0  128 55857.7008 94821.4402  69.8%     -    7s
     0     0 94040.4166    0  136 55857.7008 94040.4166  68.4%     -    8s
     0     0 93986.7540    0  134 55857.7008 93986.7540  68.3%     -    8s
     0     0 93985.6497    0  134 55857.7008 93985.6497  68.3%     -    8s
     0     0 90660.1837    0  233 55857.7008 90660.1837  62.3%     -   10s
H    0     0                    55892.952807 90660.1837  62.2%     -   10s
     0     0 90142.1478    0  202 55892.9528 90142.1478  61.3%     -   11s
     0     0 89987.7975    0  217 55892.9528 89987.7975  61.0%     -   12s
     0     0 89946.9571    0  209 55892.9528 89946.9571  60.9%     -   12s
     0     0 89931.0171    0  241 55892.9528 89931.0171  60.9%     -   12s
     0     0 89929.0955    0  243 55892.9528 89929.0955  60.9%     -   13s
     0     0 89929.0202    0  243 55892.9528 89929.0202  60.9%     -   13s
     0     0 87991.4429    0  296 55892.9528 87991.4429  57.4%     -   16s
H    0     0                    56500.750827 87990.7536  55.7%     -   16s
H    0     0                    59496.110408 87457.7954  47.0%     -   17s
H    0     0                    60325.017929 87457.7954  45.0%     -   17s
H    0     0                    61072.264678 87457.7954  43.2%     -   17s
H    0     0                    61073.827027 87457.7954  43.2%     -   17s
H    0     0                    61114.031889 87457.7954  43.1%     -   17s
H    0     0                    61285.046945 87457.7954  42.7%     -   17s
H    0     0                    61397.241836 87457.7954  42.4%     -   17s
H    0     0                    61426.706886 87457.7954  42.4%     -   17s
H    0     0                    61493.573069 87457.7954  42.2%     -   17s
     0     0 87457.7954    0  311 61493.5731 87457.7954  42.2%     -   17s
     0     0 87310.4717    0  300 61493.5731 87310.4717  42.0%     -   17s
     0     0 87209.3932    0  321 61493.5731 87209.3932  41.8%     -   18s
     0     0 87173.5769    0  318 61493.5731 87173.5769  41.8%     -   18s
H    0     0                    61595.107617 87147.2270  41.5%     -   19s
     0     0 87147.2270    0  317 61595.1076 87147.2270  41.5%     -   19s
H    0     0                    61611.103055 87138.2340  41.4%     -   19s
H    0     0                    61763.475174 87138.2340  41.1%     -   19s
H    0     0                    61919.371785 87138.2340  40.7%     -   19s
H    0     0                    61937.432197 87138.2340  40.7%     -   19s
     0     0 87138.2340    0  325 61937.4322 87138.2340  40.7%     -   19s
     0     0 87130.8748    0  323 61937.4322 87130.8748  40.7%     -   19s
     0     0 87127.5501    0  322 61937.4322 87127.5501  40.7%     -   19s
     0     0 87126.5033    0  324 61937.4322 87126.5033  40.7%     -   19s
     0     0 86257.1851    0  320 61937.4322 86257.1851  39.3%     -   22s
     0     0 86044.4765    0  332 61937.4322 86044.4765  38.9%     -   23s
     0     0 85913.2970    0  372 61937.4322 85913.2970  38.7%     -   24s
     0     0 85836.1211    0  337 61937.4322 85836.1211  38.6%     -   24s
     0     0 85747.8484    0  338 61937.4322 85747.8484  38.4%     -   25s
     0     0 85733.0985    0  331 61937.4322 85733.0985  38.4%     -   25s
     0     0 85729.8514    0  332 61937.4322 85729.8514  38.4%     -   25s
     0     0 85729.1466    0  343 61937.4322 85729.1466  38.4%     -   25s
     0     0 85543.3090    0  382 61937.4322 85543.3090  38.1%     -   26s
     0     0 85473.6372    0  385 61937.4322 85473.6372  38.0%     -   27s
     0     0 85434.8742    0  389 61937.4322 85434.8742  37.9%     -   27s
     0     0 85419.7995    0  349 61937.4322 85419.7995  37.9%     -   27s
     0     0 85417.0493    0  392 61937.4322 85417.0493  37.9%     -   28s
     0     0 85414.8966    0  387 61937.4322 85414.8966  37.9%     -   28s
     0     0 85414.5260    0  387 61937.4322 85414.5260  37.9%     -   28s
     0     0 85355.8122    0  350 61937.4322 85355.8122  37.8%     -   28s
     0     0 85321.5663    0  391 61937.4322 85321.5663  37.8%     -   29s
     0     0 85307.6412    0  361 61937.4322 85307.6412  37.7%     -   29s
     0     0 85299.7968    0  360 61937.4322 85299.7968  37.7%     -   29s
     0     0 85297.9848    0  361 61937.4322 85297.9848  37.7%     -   29s
     0     0 85296.2406    0  360 61937.4322 85296.2406  37.7%     -   29s
     0     0 85259.8081    0  360 61937.4322 85259.8081  37.7%     -   30s
     0     0 85231.6320    0  369 61937.4322 85231.6320  37.6%     -   31s
     0     0 85215.0693    0  371 61937.4322 85215.0693  37.6%     -   31s
     0     0 85210.2200    0  396 61937.4322 85210.2200  37.6%     -   31s
     0     0 85207.6307    0  366 61937.4322 85207.6307  37.6%     -   31s
     0     0 85205.9507    0  400 61937.4322 85205.9507  37.6%     -   31s
     0     0 85193.9189    0  372 61937.4322 85193.9189  37.5%     -   32s
H    0     0                    61975.192241 85191.7920  37.5%     -   32s
     0     0 85191.7920    0  374 61975.1922 85191.7920  37.5%     -   32s
     0     0 85170.3414    0  373 61975.1922 85170.3414  37.4%     -   33s
     0     0 85144.9735    0  366 61975.1922 85144.9735  37.4%     -   33s
     0     0 85142.3975    0  370 61975.1922 85142.3975  37.4%     -   33s
     0     0 85139.8160    0  374 61975.1922 85139.8160  37.4%     -   33s
     0     0 85139.4980    0  367 61975.1922 85139.4980  37.4%     -   33s
     0     0 85137.9243    0  364 61975.1922 85137.9243  37.4%     -   34s
     0     0 85136.2207    0  359 61975.1922 85136.2207  37.4%     -   34s
     0     0 85133.1372    0  371 61975.1922 85133.1372  37.4%     -   35s
     0     0 85130.7188    0  366 61975.1922 85130.7188  37.4%     -   35s
     0     0 85127.9187    0  368 61975.1922 85127.9187  37.4%     -   35s
     0     0 85127.8959    0  368 61975.1922 85127.8959  37.4%     -   35s
     0     0 85127.6367    0  368 61975.1922 85127.6367  37.4%     -   36s
     0     0 85125.8923    0  368 61975.1922 85125.8923  37.4%     -   36s
     0     0 85125.8923    0  368 61975.1922 85125.8923  37.4%     -   36s
     0     0 85121.7101    0  368 61975.1922 85121.7101  37.3%     -   37s
     0     2 85121.7101    0  368 61975.1922 85121.7101  37.3%     -   43s
     1     4 85088.8809    1  358 61975.1922 85112.5266  37.3%   516   45s
     7    16 84895.1515    3  360 61975.1922 85049.5105  37.2%  2787   51s
    15    32 84660.6550    4  364 61975.1922 84892.9260  37.0%  2370   55s
H   34    64                    62212.977431 84658.7328  36.1%  2970   58s
    63    96 84431.4262    6  367 62212.9774 84610.4818  36.0%  2418   61s
    95   175 84249.2184    7  362 62212.9774 84610.4818  36.0%  1989   65s
H  107   175                    62284.117544 84610.4818  35.8%  1969   65s
   275   343 83492.8475   10  387 62284.1175 84610.4818  35.8%  1211   70s
H  279   343                    62452.197578 84610.4818  35.5%  1227   70s
   405   473 83483.1397   11  380 62452.1976 84610.4818  35.5%  1157   77s
H  437   473                    62476.632389 84610.4818  35.4%  1189   77s
   541   574 83152.0479   13  381 62476.6324 84610.4818  35.4%  1153   81s
H  563   574                    62477.554096 84610.4818  35.4%  1150   81s
   661   751 82906.3453   15  381 62477.5541 84610.4818  35.4%  1084   86s
   782   816 82617.6849   17  376 62477.5541 84610.4818  35.4%  1016   90s
H  879   889                    62616.946815 84610.4818  35.1%  1023   93s
   888   977 80058.5289   18  312 62616.9468 84610.4818  35.1%  1023   97s
   984  1065 82371.1125   19  377 62616.9468 84610.4818  35.1%   980  100s
H  985  1065                    62716.533463 84610.4818  34.9%   979  100s
H  995  1065                    62742.406876 84610.4818  34.9%   981  100s
H 1006  1065                    62785.446047 84610.4818  34.8%   981  100s
  1166  1220 81988.9054   20  383 62785.4460 84610.4818  34.8%   937  106s
H 1167  1220                    62815.721607 84610.4818  34.7%   936  106s
H 1197  1220                    62816.343264 84610.4818  34.7%   945  106s
H 1207  1220                    62872.944176 84610.4818  34.6%   939  106s
  1361  1388 80426.3730   21  307 62872.9442 84426.9866  34.3%   912  112s
H 1363  1388                    62886.856942 84426.9866  34.3%   912  112s
  1447  1421 81627.8300   22  398 62886.8569 84426.9866  34.3%   910  115s
H 1507  1463                    62947.249574 84426.9866  34.1%   926  118s
  1532  1567 80784.0288   23  395 62947.2496 84426.9866  34.1%   925  121s
H 1592  1567                    63105.497313 84426.9866  33.8%   918  121s
  1761  1784 79878.4680   26  385 63105.4973 84426.9866  33.8%   889  127s
  1879  1882 79832.6641   27  388 63105.4973 84246.1033  33.5%   881  130s
  2087  2145 79203.9571   29  352 63105.4973 84246.1033  33.5%   883  136s
  2502  2408 77836.4975   37  302 63105.4973 84246.1033  33.5%   806  141s
  2567  2572 77688.2599   38  272 63105.4973 84246.1033  33.5%   798  146s
  2925  3096 76785.0254   42  269 63105.4973 84246.1033  33.5%   740  153s
  3279  3416 74119.7109   46  279 63105.4973 84246.1033  33.5%   689  156s
  4060  4082 71123.6942   56  244 63105.4973 84246.1033  33.5%   609  165s
  4913  4678 66619.6183   88  142 63105.4973 84104.2559  33.3%   551  172s
  5168  4679 70727.9716   64  368 63105.4973 84104.2559  33.3%   543  183s
  5170  4680 64448.3373   88   66 63105.4973 84104.2559  33.3%   543  190s
  5172  4682 73073.8047   46  282 63105.4973 84104.2559  33.3%   543  196s
  5175  4684 69433.7097   69  342 63105.4973 84104.2559  33.3%   542  200s
  5183  4689 73815.5324   62  374 63105.4973 84104.2559  33.3%   541  205s
  5190  4694 68873.6245   72  380 63105.4973 84104.2559  33.3%   541  211s
  5196  4698 74841.5573   28  380 63105.4973 84104.2559  33.3%   540  217s
  5199  4700 64306.0111   71  375 63105.4973 84104.2559  33.3%   540  220s
  5206  4704 64307.5753   67  387 63105.4973 84104.2559  33.3%   539  225s
  5210  4707 66626.8564   45  458 63105.4973 84104.2559  33.3%   539  230s
  5215  4710 74404.2040   41  419 63105.4973 84104.2559  33.3%   538  235s
  5220  4714 65631.1837   80  421 63105.4973 84104.2559  33.3%   538  249s
  5221  4714 78397.9049   23  421 63105.4973 84104.2559  33.3%   537  260s
  5222  4718 84104.2559   13  375 63105.4973 84104.2559  33.3%   547  265s
  5228  4728 83821.6354   15  405 63105.4973 84104.2559  33.3%   549  271s
  5236  4741 83776.2167   16  371 63105.4973 83893.1766  32.9%   550  277s
  5252  4768 83733.1298   17  367 63105.4973 83775.5712  32.8%   555  281s
  5284  4789 82502.4426   18  366 63105.4973 83728.4637  32.7%   567  285s
  5365  4881 81729.9854   20  355 63105.4973 83728.4637  32.7%   588  293s
  5435  4918 80650.8543   21  398 63105.4973 83728.4637  32.7%   594  297s
  5495  4961 80367.3859   21  330 63105.4973 83728.4637  32.7%   601  300s
  5626  5033 78217.2231   23  347 63105.4973 83728.4637  32.7%   613  307s
  5705  5077 77992.9708   24  318 63105.4973 83728.4637  32.7%   617  311s
  5783  5079 77575.8080   25  306 63105.4973 82961.5093  31.5%   620  316s
  5859  5109 74650.3432   26  351 63105.4973 82961.5093  31.5%   627  324s
  5898  5121 74824.3993   26  305 63105.4973 82961.5093  31.5%   632  329s
  5941  5138 74315.9456   27  349 63105.4973 82961.5093  31.5%   636  333s
  5982  5152 73931.8318   27  344 63105.4973 82961.5093  31.5%   638  338s
  6019  5166 74182.6995   28  352 63105.4973 81811.0507  29.6%   640  341s
  6069  5181 72723.7296   28  326 63105.4973 81811.0507  29.6%   642  345s
  6164  5230 73400.2119   29  328 63105.4973 81811.0507  29.6%   647  351s
  6274  5248 72133.3519   31  317 63105.4973 81033.8159  28.4%   651  358s
  6335  5266 66036.7705   31  337 63105.4973 80915.3154  28.2%   656  362s
  6409  5291 71370.0644   32  314 63105.4973 80897.2966  28.2%   660  367s
  6508  5322 70118.7874   33  261 63105.4973 80897.2966  28.2%   663  375s
  6727  5377 67707.4522   36  229 63105.4973 80757.9828  28.0%   674  386s
  6847  5373     cutoff   38      63105.4973 80753.8284  28.0%   681  391s
  6981  5376 76501.6784   22  317 63105.4973 80753.8284  28.0%   687  396s
  7085  5410 72165.4692   26  270 63105.4973 80359.9947  27.3%   692  401s
  7211  5430 67605.4112   30  142 63105.4973 80359.9947  27.3%   699  405s
  7317  5453     cutoff   32      63105.4973 80009.4062  26.8%   707  411s
  7464  5470 77618.6122   24  312 63105.4973 80009.4062  26.8%   713  415s
  7617  5495 74473.7956   27  306 63105.4973 79903.3027  26.6%   717  421s
  7757  5493 66970.2704   31  248 63105.4973 79147.6549  25.4%   724  427s
  7941  5499 75670.1529   25  294 63105.4973 79147.6549  25.4%   728  433s
  8091  5502 70286.8410   29  319 63105.4973 79107.1787  25.4%   735  441s
  8271  5479     cutoff   33      63105.4973 78891.8185  25.0%   739  448s
  8451  5515     cutoff   33      63105.4973 78408.1788  24.2%   744  453s
  8640  5530 72452.1850   24  340 63105.4973 78408.1788  24.2%   747  460s
  8863  5564 69227.8282   29  266 63105.4973 78288.7953  24.1%   750  466s
  9102  5564     cutoff   34      63105.4973 78288.7953  24.1%   752  474s
  9348  5565 70517.6516   23  330 63105.4973 77853.6744  23.4%   758  482s
  9591  5599 65871.1265   26  261 63105.4973 77757.2965  23.2%   764  489s
  9905  5606 74603.3889   25  280 63105.4973 77715.2297  23.2%   767  495s
 10177  5626 65914.4087   33  142 63105.4973 77715.2297  23.2%   772  504s
 10516  5632 73384.4352   20  337 63105.4973 77214.6329  22.4%   777  513s
 10808  5633 65515.7237   24  268 63105.4973 77149.3824  22.3%   785  520s
 11110  5546 infeasible   26      63105.4973 76961.5320  22.0%   791  528s
 11157  5552 64928.9452   26  298 63105.4973 76961.5320  22.0%   793  535s
 11230  5557 69784.9753   25  245 63105.4973 76872.2129  21.8%   794  542s
 11290  5578 67807.9423   28  276 63105.4973 76872.2129  21.8%   796  549s
 11374  5595 68767.9224   24  341 63105.4973 76872.2129  21.8%   798  559s
 11554  5621     cutoff   29      63105.4973 76829.4180  21.7%   800  570s
 11835  5656 67436.9400   34  353 63105.4973 76829.4180  21.7%   806  581s
 12226  5647 72048.6697   23  323 63105.4973 76488.9779  21.2%   811  590s
 12648  5623 63259.1494   29  276 63105.4973 76359.9196  21.0%   815  598s
 13060  5668     cutoff   29      63105.4973 76130.5038  20.6%   822  608s
 13471  5642 71942.4101   31  287 63105.4973 76063.5367  20.5%   831  618s
 13806  5631 68043.7328   21  280 63105.4973 75791.8197  20.1%   837  631s
 14255  5607     cutoff   27      63105.4973 75791.8197  20.1%   843  641s
 14713  5621 70238.3682   23  340 63105.4973 75504.5642  19.6%   851  651s
 15222  5476 68153.1831   29  228 63105.4973 75407.6426  19.5%   857  662s
 15292  5519 63378.1882   31  221 63105.4973 75407.6426  19.5%   858  676s
 15679  5441 64307.3217   29  273 63105.4973 75400.0784  19.5%   864  690s
 16115  5410 67525.7075   24  344 63105.4973 75283.0259  19.3%   872  702s
 16662  5357 68061.3532   30  321 63105.4973 75040.6651  18.9%   879  715s
 17281  5160 63407.1806   29  253 63105.4973 74986.6438  18.8%   882  729s
 18041  4981 65747.9465   27  304 63105.4973 74732.6914  18.4%   882  742s
 18736  4766     cutoff   30      63105.4973 74524.8213  18.1%   884  757s
 19479  4657 66963.5306   28  291 63105.4973 74482.8150  18.0%   887  771s
 20045  4773 64979.4810   29  252 63105.4973 74359.8866  17.8%   892  786s
 20763  4906     cutoff   30      63105.4973 74181.5129  17.6%   896  802s
 21489  5041 63866.5059   38  322 63105.4973 74005.5938  17.3%   902  820s
 22282  5101 67131.7286   30  258 63105.4973 73967.4400  17.2%   907  838s
 23159  5212 67964.9751   26  259 63105.4973 73656.5323  16.7%   908  854s
 24096  5285 69515.8490   24  349 63105.4973 73563.1078  16.6%   910  871s
 25025  5338 64298.3365   26  331 63105.4973 73563.1078  16.6%   911  889s
 26058  5485 67426.4040   31  309 63105.4973 73361.0524  16.3%   911  909s
 26991  5601 64114.7027   27  360 63105.4973 73153.3841  15.9%   916  929s
 27947  5673     cutoff   32      63105.4973 72955.6989  15.6%   920  948s
 28928  5769 64088.0546   31  298 63105.4973 72795.9252  15.4%   923  973s
 30119  5828     cutoff   31      63105.4973 72575.6068  15.0%   925  994s
 31127  5912 63640.7422   30  209 63105.4973 72427.1118  14.8%   929 1015s
 32236  5919 63906.1291   29  309 63105.4973 72235.6602  14.5%   929 1037s
 32760  5966 67001.0678   23  289 63105.4973 72191.3093  14.4%   932 1063s
 33896  6051 66450.7014   28  202 63105.4973 71949.6366  14.0%   935 1087s
 35158  6075 63869.1043   33  176 63105.4973 71838.5442  13.8%   938 1112s
 36528  6133 63951.1802   27  348 63105.4973 71525.3753  13.3%   939 1140s
 37998  6126     cutoff   31      63105.4973 71303.9545  13.0%   939 1168s
 39556  6106 infeasible   29      63105.4973 71070.7777  12.6%   938 1195s
 41088  6070     cutoff   24      63105.4973 70836.5592  12.3%   938 1224s
 42641  6006 66216.3163   33  188 63105.4973 70613.8121  11.9%   939 1254s
 44154  5860 64997.2475   30  262 63105.4973 70365.6772  11.5%   942 1284s
 45894  5712     cutoff   28      63105.4973 70093.4584  11.1%   942 1316s
*47638  5690              70    63181.668423 69808.1340  10.5%   943 1316s
 47650  5496     cutoff   30      63181.6684 69803.7150  10.5%   943 1348s
H47694  5332                    63618.975494 69803.7150  9.72%   943 1348s
H47732  5235                    63792.707930 69803.7150  9.42%   943 1348s
 49234  4921     cutoff   23      63792.7079 69628.3421  9.15%   944 1382s
 51216  4542     cutoff   29      63792.7079 69231.7842  8.53%   944 1418s
 53227  4016     cutoff   27      63792.7079 68794.5804  7.84%   943 1453s
 55309  3446     cutoff   28      63792.7079 68245.9727  6.98%   943 1491s
*57536  3407              97    63859.928907 68188.4011  6.78%   937 1491s
 57826  2778     cutoff   23      63859.9289 67728.9522  6.06%   937 1530s
H57829  2170                    64752.271666 67728.9522  4.60%   937 1530s
H58001  2167                    64760.096367 67709.5108  4.55%   936 1530s
H58233  2131                    64813.260663 67707.8984  4.47%   936 1530s
H58900  2131                    64814.969778 67667.5391  4.40%   934 1530s
 59618  1005     cutoff   26      64814.9698 67400.7447  3.99%   932 1557s
 63899  2353     cutoff   41      64814.9698 65411.7473  0.92%   885 1566s
*63951  2353              62    64982.660700 65411.7473  0.66%   885 1566s

Cutting planes:
  MIR: 905
  Mixing: 3
  Flow cover: 1478
  RLT: 16
  Relax-and-lift: 68

Explored 76539 nodes (57047519 simplex iterations) in 1569.15 seconds (3487.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 64982.7 64982.7 64815 ... 63181.7

Optimal solution found (tolerance 1.00e-04)
Best objective 6.498266070020e+04, best bound 6.498266070020e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1569.19s
  Master Objective (UB) = 64982.66, θ = 223605.57
  Upper Bound (UB) = 64982.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 223605.57
  [DEBUG]   ✓ Scenario 0: θ = 223605.57 ≤ Q = 223605.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 223605.57 ≤ Q = 223607.03 (slack: 1.46)
  [DEBUG]   ✓ Scenario 2: θ = 223605.57 ≤ Q = 223605.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2d4aa94a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2d4aa94a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.265744e+13
Presolve removed 2580 rows and 1871 columns
Presolve time: 0.01s
Presolved: 513 rows, 518 columns, 1447 nonzeros
Found heuristic solution: objective 6232576.9093
Variable types: 352 continuous, 166 integer (166 binary)

Root relaxation: objective -1.677471e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167747.11    0  127 6232576.91 -167747.11   103%     -    0s
H    0     0                    -132818.9184 -167747.11  26.3%     -    0s
H    0     0                    -133451.9047 -167747.11  25.7%     -    0s
H    0     0                    -143225.5084 -167747.11  17.1%     -    0s
H    0     0                    -148586.0891 -167747.11  12.9%     -    0s
H    0     0                    -149663.2159 -154109.33  2.97%     -    0s
     0     0 -154109.33    0   89 -149663.22 -154109.33  2.97%     -    0s
H    0     0                    -152138.3775 -154100.44  1.29%     -    0s
     0     0 -153386.74    0  105 -152138.38 -153386.74  0.82%     -    0s
     0     0 -153383.53    0  105 -152138.38 -153383.53  0.82%     -    0s
     0     0 -153074.20    0   67 -152138.38 -153074.20  0.62%     -    0s
H    0     0                    -152675.0211 -153070.06  0.26%     -    0s
H    0     0                    -152769.5388 -153054.28  0.19%     -    0s
H    0     0                    -152772.7714 -153054.28  0.18%     -    0s
     0     0 -153036.58    0   67 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   67 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   67 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   67 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   79 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   73 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   68 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   67 -152772.77 -153036.58  0.17%     -    0s
     0     0 -153036.58    0   67 -152772.77 -153036.58  0.17%     -    0s
     0     0 -152981.05    0   62 -152772.77 -152981.05  0.14%     -    0s
     0     0 -152972.89    0   61 -152772.77 -152972.89  0.13%     -    0s
     0     0 -152967.75    0   67 -152772.77 -152967.75  0.13%     -    0s
     0     0 -152967.44    0   67 -152772.77 -152967.44  0.13%     -    0s
     0     0 -152954.67    0   66 -152772.77 -152954.67  0.12%     -    0s
     0     0 -152930.47    0   65 -152772.77 -152930.47  0.10%     -    0s
     0     0 -152926.79    0   68 -152772.77 -152926.79  0.10%     -    0s
     0     0 -152914.29    0   67 -152772.77 -152914.29  0.09%     -    0s
     0     0 -152908.93    0   67 -152772.77 -152908.93  0.09%     -    0s
     0     0 -152902.26    0   67 -152772.77 -152902.26  0.08%     -    0s
     0     0 -152901.42    0   67 -152772.77 -152901.42  0.08%     -    0s
     0     2 -152901.42    0   67 -152772.77 -152901.42  0.08%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 4
  MIR: 56
  Flow cover: 17
  RLT: 25
  Relax-and-lift: 5

Explored 12 nodes (1302 simplex iterations) in 0.35 seconds (0.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -152773 -152675 -152343 ... 6.23258e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.527727713677e+05, best bound -1.527878389280e+05, gap 0.0099%
  Subproblem solved in 0.38s
  Worst-case operational profit (Z_SP) = 203726.95
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152772.77
  [DEBUG]   S×d_nominal = 356499.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 356499.72 + -152772.77 = 203726.95
  [DEBUG]   Current θ from Master = 223605.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19878.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45104.03
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 7390.5534, Absolute Gap = 7390.5534, Relative Gap = 0.113731
  Not converged yet (gap = 7390.55 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0x8456631a
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 45104 (0.16s)
MIP start from previous solve produced solution with objective 45104 (0.17s)
Loaded MIP start from previous solve with objective 45104

Presolve removed 27088 rows and 10998 columns
Presolve time: 1.22s
Presolved: 35455 rows, 16222 columns, 219119 nonzeros
Variable types: 13963 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35455 rows, 16222 columns, 219119 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41118    4.2050531e+04   0.000000e+00   1.241860e+07      5s
Concurrent spin time: 0.44s

Solved with dual simplex

Root relaxation: objective 9.940439e+04, 21626 iterations, 8.40 seconds (11.02 work units)
Total elapsed time = 10.01s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99404.3924    0   73 45104.0340 99404.3924   120%     -   10s
H    0     0                    45422.774330 99404.3924   119%     -   10s
H    0     0                    50774.857976 99404.3924  95.8%     -   10s
H    0     0                    55971.259603 99404.3924  77.6%     -   10s
H    0     0                    56086.080529 99404.3924  77.2%     -   10s
H    0     0                    57525.854071 99404.3924  72.8%     -   10s
H    0     0                    57549.033670 99404.3924  72.7%     -   10s
H    0     0                    58945.622011 99404.3924  68.6%     -   10s
     0     0 93717.1238    0  134 58945.6220 93717.1238  59.0%     -   13s
H    0     0                    59853.411218 93715.7935  56.6%     -   14s
H    0     0                    60122.698278 93715.7935  55.9%     -   14s
     0     0 93405.4676    0  149 60122.6983 93405.4676  55.4%     -   15s
     0     0 93404.6079    0  149 60122.6983 93404.6079  55.4%     -   15s
     0     0 93404.5549    0  149 60122.6983 93404.5549  55.4%     -   15s
     0     0 90655.9355    0  201 60122.6983 90655.9355  50.8%     -   18s
H    0     0                    61199.267602 90655.4243  48.1%     -   18s
     0     0 89690.0736    0  215 61199.2676 89690.0736  46.6%     -   20s
     0     0 89432.6770    0  253 61199.2676 89432.6770  46.1%     -   21s
     0     0 89359.4720    0  264 61199.2676 89359.4720  46.0%     -   22s
     0     0 89303.0613    0  231 61199.2676 89303.0613  45.9%     -   22s
     0     0 89287.1263    0  267 61199.2676 89287.1263  45.9%     -   23s
     0     0 89249.6068    0  258 61199.2676 89249.6068  45.8%     -   23s
     0     0 89212.9423    0  232 61199.2676 89212.9423  45.8%     -   23s
     0     0 89209.7080    0  230 61199.2676 89209.7080  45.8%     -   23s
     0     0 89209.1441    0  234 61199.2676 89209.1441  45.8%     -   23s
     0     0 88036.1717    0  312 61199.2676 88036.1717  43.9%     -   28s
     0     0 87536.0750    0  320 61199.2676 87536.0750  43.0%     -   29s
     0     0 87268.4765    0  322 61199.2676 87268.4765  42.6%     -   31s
     0     0 87133.3099    0  321 61199.2676 87133.3099  42.4%     -   32s
     0     0 87077.4429    0  332 61199.2676 87077.4429  42.3%     -   32s
     0     0 87039.0443    0  340 61199.2676 87039.0443  42.2%     -   32s
     0     0 87034.1316    0  345 61199.2676 87034.1316  42.2%     -   33s
     0     0 87034.0963    0  341 61199.2676 87034.0963  42.2%     -   33s
     0     0 86171.3619    0  350 61199.2676 86171.3619  40.8%     -   39s
     0     0 86003.9682    0  331 61199.2676 86003.9682  40.5%     -   40s
     0     0 85944.6618    0  356 61199.2676 85944.6618  40.4%     -   40s
     0     0 85818.1870    0  382 61199.2676 85818.1870  40.2%     -   41s
     0     0 85765.9400    0  383 61199.2676 85765.9400  40.1%     -   42s
     0     0 85743.4524    0  372 61199.2676 85743.4524  40.1%     -   43s
     0     0 85738.0316    0  378 61199.2676 85738.0316  40.1%     -   43s
     0     0 85736.3220    0  377 61199.2676 85736.3220  40.1%     -   43s
     0     0 85735.9536    0  334 61199.2676 85735.9536  40.1%     -   43s
     0     0 85615.2309    0  372 61199.2676 85615.2309  39.9%     -   45s
H    0     0                    61409.267142 85613.5882  39.4%     -   45s
     0     0 85528.4150    0  351 61409.2671 85528.4150  39.3%     -   47s
     0     0 85510.8255    0  386 61409.2671 85510.8255  39.2%     -   47s
     0     0 85496.1137    0  384 61409.2671 85496.1137  39.2%     -   48s
     0     0 85484.1922    0  346 61409.2671 85484.1922  39.2%     -   49s
     0     0 85481.5646    0  386 61409.2671 85481.5646  39.2%     -   50s
     0     0 85480.0757    0  382 61409.2671 85480.0757  39.2%     -   50s
     0     0 85351.0346    0  350 61409.2671 85351.0346  39.0%     -   51s
     0     0 85268.8179    0  362 61409.2671 85268.8179  38.9%     -   54s
     0     0 85257.2503    0  354 61409.2671 85257.2503  38.8%     -   55s
     0     0 85253.0868    0  361 61409.2671 85253.0868  38.8%     -   55s
     0     0 85250.6009    0  360 61409.2671 85250.6009  38.8%     -   55s
     0     0 85247.9454    0  363 61409.2671 85247.9454  38.8%     -   56s
     0     0 85247.5936    0  364 61409.2671 85247.5936  38.8%     -   56s
     0     0 85209.6768    0  359 61409.2671 85209.6768  38.8%     -   58s
     0     0 85204.8411    0  359 61409.2671 85204.8411  38.7%     -   58s
     0     0 85199.9383    0  359 61409.2671 85199.9383  38.7%     -   59s
     0     0 85197.8281    0  365 61409.2671 85197.8281  38.7%     -   59s
     0     0 85196.5591    0  362 61409.2671 85196.5591  38.7%     -   59s
     0     0 85157.2004    0  357 61409.2671 85157.2004  38.7%     -   61s
     0     0 85145.6947    0  367 61409.2671 85145.6947  38.7%     -   62s
     0     0 85145.0485    0  360 61409.2671 85145.0485  38.7%     -   62s
     0     0 85137.8916    0  361 61409.2671 85137.8916  38.6%     -   63s
     0     0 85136.5212    0  353 61409.2671 85136.5212  38.6%     -   64s
     0     0 85111.5941    0  370 61409.2671 85111.5941  38.6%     -   65s
H    0     0                    61504.503992 85110.6468  38.4%     -   67s
H    0     0                    61732.970423 85110.6468  37.9%     -   67s
     0     0 85108.4362    0  378 61732.9704 85108.4362  37.9%     -   67s
     0     0 85107.9647    0  378 61732.9704 85107.9647  37.9%     -   67s
     0     0 85099.5155    0  407 61732.9704 85099.5155  37.9%     -   68s
     0     0 85098.9625    0  378 61732.9704 85098.9625  37.9%     -   69s
     0     0 85087.2145    0  373 61732.9704 85087.2145  37.8%     -   70s
     0     0 85086.4551    0  375 61732.9704 85086.4551  37.8%     -   70s
     0     0 85085.9334    0  372 61732.9704 85085.9334  37.8%     -   70s
     0     0 85084.7431    0  372 61732.9704 85084.7431  37.8%     -   71s
     0     2 85084.7431    0  372 61732.9704 85084.7431  37.8%     -   82s
     1     4 84999.9272    1  377 61732.9704 85084.1823  37.8%  1993   85s
     7    16 84259.0587    3  396 61732.9704 84554.0995  37.0%  2816   91s
    15    32 84098.4271    4  397 61732.9704 84258.5718  36.5%  3572   97s
    31    57 83946.9550    5  399 61732.9704 84096.8116  36.2%  4996  108s
    56    89 83499.0786    6  404 61732.9704 84041.2252  36.1%  4912  127s
    88   121 83424.6605    7  404 61732.9704 84041.2252  36.1%  4244  135s
H   90   121                    61746.412128 84041.2252  36.1%  4171  135s
H   93   121                    61784.969710 84041.2252  36.0%  4104  135s
H   94   121                    61852.175217 84041.2252  35.9%  4068  135s
H   98   121                    61874.684750 84041.2252  35.8%  3935  135s
H  106   121                    61879.747073 84041.2252  35.8%  3744  135s
   120   276 83340.1812    8  400 61879.7471 84041.2252  35.8%  3439  142s
   275   352 82844.3510   11  383 61879.7471 84041.2252  35.8%  2310  146s
   351   428 82981.9245   12  353 61879.7471 84041.2252  35.8%  2155  152s
   427   506 82347.2230   12  386 61879.7471 84041.2252  35.8%  2012  157s
   505   594 82772.2100   13  346 61879.7471 84041.2252  35.8%  1899  161s
   593   668 82364.2814   15  381 61879.7471 84041.2252  35.8%  1802  166s
   667   763 82333.5114   16  351 61879.7471 84041.2252  35.8%  1733  170s
   842   937 81466.0912   17  331 61879.7471 84041.2252  35.8%  1580  179s
   936  1008 81907.2904   18  382 61879.7471 84041.2252  35.8%  1514  185s
  1049  1079 81051.2329   19  378 61879.7471 84041.2252  35.8%  1481  193s
  1090  1159 81171.6245   20  368 61879.7471 84041.2252  35.8%  1477  196s
  1171  1251 80798.0696   21  379 61879.7471 84041.2252  35.8%  1430  201s
  1279  1318 80657.7285   22  334 61879.7471 83949.0547  35.7%  1374  208s
  1376  1386 80010.7917   23  309 61879.7471 83759.2632  35.4%  1360  215s
  1462  1467 74057.1269   24  288 61879.7471 83759.2632  35.4%  1364  220s
  1567  1525 79559.8648   24  314 61879.7471 83759.2632  35.4%  1356  225s
  1643  1601 75490.4427   25  295 61879.7471 83710.0489  35.3%  1368  231s
  1729  1691 77240.8291   26  270 61879.7471 83710.0489  35.3%  1367  236s
  1831  1799 77144.8341   27  280 61879.7471 83710.0489  35.3%  1354  242s
  1967  1884 75996.5005   32  244 61879.7471 83710.0489  35.3%  1324  248s
  2078  2030 70557.8315   34  227 61879.7471 83710.0489  35.3%  1323  257s
  2246  2202 69016.2530   35  221 61879.7471 83710.0489  35.3%  1293  263s
  2470  2379 68030.9010   39  236 61879.7471 83498.3962  34.9%  1231  270s
  2697  2537 66429.3010   41  205 61879.7471 83396.3017  34.8%  1179  277s
  2901  2695 66970.7221   43  213 61879.7471 83396.3017  34.8%  1155  286s
  3108  2757 65013.0100   47  224 61879.7471 83396.3017  34.8%  1137  292s
H 3113  2757                    61888.188042 83396.3017  34.8%  1137  292s
H 3134  2757                    61994.305808 83396.3017  34.5%  1130  292s
H 3142  2757                    62087.343190 83396.3017  34.3%  1129  292s
  3216  2873 63276.1556   50  204 62087.3432 83396.3017  34.3%  1126  303s
  3389  2981 79753.0468    8  303 62087.3432 83396.3017  34.3%  1131  314s
  3504  2982 64061.0714   35  372 62087.3432 83285.8528  34.1%  1151  340s
  3506  2983 64583.5408   66   73 62087.3432 83285.8528  34.1%  1150  351s
  3507  2984 77507.8283   13  239 62087.3432 83285.8528  34.1%  1150  358s
  3508  2985 82166.0875   13  330 62087.3432 83285.8528  34.1%  1150  364s
  3509  2985 68714.7169   55  341 62087.3432 83285.8528  34.1%  1149  368s
  3510  2986 78570.2066   19  325 62087.3432 83285.8528  34.1%  1149  371s
  3512  2987 80082.4595   23  354 62087.3432 83285.8528  34.1%  1148  376s
  3515  2989 79808.9662   23  410 62087.3432 83285.8528  34.1%  1147  380s
  3520  2993 80361.9997   20  362 62087.3432 83285.8528  34.1%  1146  385s
  3525  2996 63884.0056   81  403 62087.3432 83285.8528  34.1%  1144  391s
H 3527  2846                    62101.075617 83285.8528  34.1%  1143  395s
  3531  2849 68842.7879   38  406 62101.0756 83285.8528  34.1%  1142  400s
  3534  2851 80611.5299   14  393 62101.0756 83285.8528  34.1%  1141  405s
  3537  2853 77432.7504   26  406 62101.0756 83285.8528  34.1%  1140  410s
  3540  2855 65691.1311   52  385 62101.0756 83285.8528  34.1%  1139  426s
  3541  2856 68814.9976   53  385 62101.0756 83285.8528  34.1%  1139  436s
  3542  2859 83285.8528   16  354 62101.0756 83285.8528  34.1%  1160  447s
  3544  2863 83285.8528   17  386 62101.0756 83285.8528  34.1%  1162  455s
  3548  2869 83285.8528   18  397 62101.0756 83285.8528  34.1%  1166  466s
  3556  2883 83285.8528   19  403 62101.0756 83285.8528  34.1%  1174  476s
  3572  2908 83285.8528   20  384 62101.0756 83285.8528  34.1%  1206  492s
  3603  2930 83022.8814   21  355 62101.0756 83285.8528  34.1%  1256  501s
  3635  2979 81264.3810   22  397 62101.0756 83048.1109  33.7%  1279  513s
  3695  3030 80553.7506   23  398 62101.0756 83048.1109  33.7%  1328  525s
  3766  3039 75184.1120   24  352 62101.0756 83048.1109  33.7%  1381  531s
  3798  3069 78671.8940   24  430 62101.0756 83048.1109  33.7%  1397  540s
  3839  3123 77402.7373   25  413 62101.0756 83048.1109  33.7%  1421  551s
  3907  3133 76901.2242   26  410 62101.0756 83048.1109  33.7%  1457  556s
H 3931  2982                    62114.826886 83048.1109  33.7%  1466  556s
  3939  3049 72413.8242   26  332 62114.8269 83048.1109  33.7%  1468  566s
  4019  3095 73831.2792   27  393 62114.8269 83048.1109  33.7%  1483  575s
  4108  3110 74038.9599   28  359 62114.8269 83048.1109  33.7%  1494  584s
  4197  3126 74159.8240   28  336 62114.8269 83048.1109  33.7%  1497  592s
  4261  3152 73710.9533   29  314 62114.8269 83034.0742  33.7%  1514  602s
  4326  3189 73112.7277   30  312 62114.8269 83034.0742  33.7%  1529  609s
  4399  3226 72876.4009   31  315 62114.8269 83034.0742  33.7%  1536  617s
  4484  3268 72380.5044   33  272 62114.8269 83034.0742  33.7%  1537  623s
  4579  3301 72202.5149   34  273 62114.8269 83034.0742  33.7%  1533  634s
  4669  3300 70250.5643   36  256 62114.8269 82162.4835  32.3%  1537  641s
  4706  3315 70127.5178   36  281 62114.8269 82071.9629  32.1%  1540  647s
  4742  3348 69053.8695   37  252 62114.8269 82071.9629  32.1%  1542  652s
  4793  3376 63833.7086   37  284 62114.8269 82071.9629  32.1%  1545  658s
  4861  3399 67917.6238   38  258 62114.8269 82071.9629  32.1%  1548  668s
  4968  3420 66480.7662   38  239 62114.8269 81016.6889  30.4%  1543  680s
  5080  3421     cutoff   39      62114.8269 81016.6889  30.4%  1547  690s
  5210  3452     cutoff   40      62114.8269 81016.6889  30.4%  1547  704s
  5324  3477 77292.1962   23  309 62114.8269 80922.2501  30.3%  1552  713s
  5444  3516 75446.6280   25  292 62114.8269 80922.2501  30.3%  1556  724s
  5574  3565 72119.1152   28  303 62114.8269 80922.2501  30.3%  1556  735s
  5725  3554 67023.8011   32  264 62114.8269 80922.2501  30.3%  1557  747s
H 5808  3390                    62138.432943 80922.2501  30.2%  1552  747s
  5838  3460 66214.5305   35  252 62138.4329 80922.2501  30.2%  1553  760s
  5996  3510 63874.2143   43  255 62138.4329 80922.2501  30.2%  1553  772s
  6134  3560 62538.9744   51  218 62138.4329 80230.8269  29.1%  1561  783s
  6310  3583 76719.4316   23  284 62138.4329 80230.8269  29.1%  1560  795s
  6502  3608 72372.0407   27  234 62138.4329 80088.5300  28.9%  1557  810s
  6679  3666 65763.8890   32  152 62138.4329 79600.1537  28.1%  1561  822s
  6846  3696     cutoff   43      62138.4329 79600.1537  28.1%  1566  836s
H 6885  3552                    62152.072466 79600.1537  28.1%  1566  836s
H 6930  3412                    62245.848615 79600.1537  27.9%  1564  836s
  6999  3509 74799.1597   24  327 62245.8486 79600.1537  27.9%  1560  852s
  7250  3537 72985.3835   27  323 62245.8486 79600.1537  27.9%  1553  866s
  7451  3583 68872.3500   32  263 62245.8486 79600.1537  27.9%  1559  884s
  7692  3627 65004.3477   38  186 62245.8486 79600.1537  27.9%  1559  898s
  7936  3580     cutoff   45      62245.8486 79183.2336  27.2%  1562  910s
  7994  3587 76226.8181   23  307 62245.8486 78864.9287  26.7%  1561  923s
  8031  3624 74939.2680   24  332 62245.8486 78864.9287  26.7%  1563  936s
H 8039  3501                    62320.150566 78864.9287  26.5%  1563  936s
  8088  3595 69550.6907   29  242 62320.1506 78864.9287  26.5%  1563  956s
  8416  3630 66714.7550   40  221 62320.1506 78864.9287  26.5%  1560  971s
  8626  3754 73020.4607   25  369 62320.1506 78864.9287  26.5%  1577  988s
  8859  3836 65544.3132   32  265 62320.1506 78864.9287  26.5%  1589 1007s
  9232  3744     cutoff   34      62320.1506 77354.4036  24.1%  1583 1026s
  9344  3879 76412.8048   22  334 62320.1506 77290.7239  24.0%  1583 1043s
  9658  3959 73086.4333   23  259 62320.1506 77290.7239  24.0%  1585 1063s
 10046  3972 68529.5485   26  309 62320.1506 77284.0327  24.0%  1584 1081s
 10466  4104 62934.4656   28  267 62320.1506 77200.4835  23.9%  1579 1100s
 10790  4278 62901.4731   31  219 62320.1506 77014.2801  23.6%  1585 1121s
 11226  4501 67188.0673   31  253 62320.1506 76772.8603  23.2%  1580 1144s
 11665  4659 67600.0296   27  290 62320.1506 76368.4886  22.5%  1579 1164s
 12103  4821 69606.3734   26  276 62320.1506 76202.7789  22.3%  1580 1191s
 12551  5009 73011.3606   25  330 62320.1506 76202.7789  22.3%  1583 1214s
 13014  5271 infeasible   38      62320.1506 76059.2917  22.0%  1586 1237s
 13551  5377     cutoff   34      62320.1506 75878.2614  21.8%  1580 1262s
 13851  5545 71494.0647   33  310 62320.1506 75589.8037  21.3%  1581 1288s
 14383  5740 64668.3075   43  245 62320.1506 75347.7671  20.9%  1583 1314s
 14873  5958     cutoff   32      62320.1506 75274.2678  20.8%  1589 1343s
 15472  6149 65315.1828   34  191 62320.1506 75274.2678  20.8%  1588 1373s
 16050  6388 65878.8040   38  117 62320.1506 74682.9119  19.8%  1592 1403s
 16684  6622 66966.5631   29  292 62320.1506 74637.5092  19.8%  1594 1434s
 17348  6890 64890.3827   30  186 62320.1506 74393.2095  19.4%  1594 1467s
 17978  7117     cutoff   32      62320.1506 74235.5728  19.1%  1599 1498s
 18668  7335 70489.4615   29  298 62320.1506 74235.5728  19.1%  1599 1533s
 19408  7652 67044.2344   31  326 62320.1506 74010.4617  18.8%  1600 1567s
 20192  7888     cutoff   33      62320.1506 73880.0810  18.5%  1600 1602s
 21046  8134 66609.0610   28  200 62320.1506 73739.9158  18.3%  1595 1639s
 21877  8396 63909.0729   29  292 62320.1506 73735.1869  18.3%  1594 1679s
 22679  8436 65927.5576   31  223 62320.1506 73396.7772  17.8%  1598 1718s
H22757  8436                    62344.043483 73396.7772  17.7%  1599 1718s
H22813  8543                    62344.300404 73396.7772  17.7%  1598 1758s
H23027  8498                    62537.582556 73396.7772  17.4%  1595 1758s
 23782  8757 70322.5951   25  316 62537.5826 73304.8911  17.2%  1589 1800s
 24766  9073 62829.9036   32  210 62537.5826 73174.9967  17.0%  1586 1843s
 25794  9216     cutoff   32      62537.5826 73014.0149  16.8%  1583 1887s
 26974  9447     cutoff   32      62537.5826 72903.2852  16.6%  1573 1937s
 28027  9723 65789.7330   30  169 62537.5826 72749.1171  16.3%  1573 1986s
 29049  9977 66021.4681   30  298 62537.5826 72614.1235  16.1%  1577 2041s
 30118 10291 65622.5149   33  232 62537.5826 72469.1960  15.9%  1579 2095s
 31347 10587 67405.9757   26  268 62537.5826 72318.5280  15.6%  1581 2153s
 32755 10896 65229.1462   29  190 62537.5826 72222.5040  15.5%  1575 2206s
 34047 11150     cutoff   33      62537.5826 71997.7879  15.1%  1571 2262s
 35353 11496 67136.5556   31  233 62537.5826 71827.6249  14.9%  1569 2321s
 36728 11780 64698.1602   29  402 62537.5826 71736.6488  14.7%  1568 2383s
 38162 12103 63289.3897   29  197 62537.5826 71572.5907  14.4%  1565 2443s
 39604 12365 66003.3104   30  287 62537.5826 71403.8661  14.2%  1562 2507s
 41174 12561 63150.5208   39  112 62537.5826 71294.0944  14.0%  1558 2580s
 42701 12871 63848.5137   34  206 62537.5826 71160.4200  13.8%  1560 2650s
 44300 13107 64776.3464   38  250 62537.5826 70958.5858  13.5%  1560 2721s
 46006 13444 66505.8310   29  251 62537.5826 70828.9575  13.3%  1558 2794s
 47683 13878 66489.5159   26  274 62537.5826 70672.8384  13.0%  1560 2871s
 49628 14222     cutoff   33      62537.5826 70514.1909  12.8%  1556 2949s
 51519 14484 66390.2575   29  226 62537.5826 70405.3881  12.6%  1554 3037s
 53523 14730 63836.8968   35  255 62537.5826 70237.7632  12.3%  1552 3122s
H55553 14841                    62668.747006 70107.1680  11.9%  1552 3208s
 56744 15129 65366.1670   34  242 62668.7470 70010.0890  11.7%  1551 3305s

Cutting planes:
  MIR: 834
  Mixing: 2
  Flow cover: 1292
  RLT: 11
  Relax-and-lift: 82

Explored 58978 nodes (91654756 simplex iterations) in 3600.13 seconds (7626.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 62668.7 62537.6 62344.3 ... 62087.3

Time limit reached
Best objective 6.266874700586e+04, best bound 6.986142096032e+04, gap 11.4773%
  WARNING: Time limit reached. Using best solution found (gap: 11.48%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 62668.75, θ = 223553.94
  Upper Bound (UB) = 62668.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 223553.94
  [DEBUG]   ✓ Scenario 0: θ = 223553.94 ≤ Q = 223553.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 223553.94 ≤ Q = 223553.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 223553.94 ≤ Q = 223553.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 223553.94 ≤ Q = 223553.94 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6f3f6353
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x90c09cad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.278466e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.01s
Presolved: 508 rows, 514 columns, 1434 nonzeros
Found heuristic solution: objective 6213530.0438
Variable types: 349 continuous, 165 integer (165 binary)
Found heuristic solution: objective 6213177.0300

Root relaxation: objective -1.711775e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171177.47    0  128 6213177.03 -171177.47   103%     -    0s
H    0     0                    -143431.9788 -171177.47  19.3%     -    0s
H    0     0                    -144046.6811 -171177.47  18.8%     -    0s
     0     0 -153310.76    0   76 -144046.68 -153310.76  6.43%     -    0s
H    0     0                    -152463.8325 -153309.64  0.55%     -    0s
     0     0 -152684.81    0   51 -152463.83 -152684.81  0.14%     -    0s
     0     0 -152658.89    0   30 -152463.83 -152658.89  0.13%     -    0s
     0     0 -152637.37    0   23 -152463.83 -152637.37  0.11%     -    0s
     0     0 -152615.12    0   22 -152463.83 -152615.12  0.10%     -    0s
     0     0 -152559.99    0    8 -152463.83 -152559.99  0.06%     -    0s
     0     0 -152559.98    0    8 -152463.83 -152559.98  0.06%     -    0s
     0     0 -152528.09    0    6 -152463.83 -152528.09  0.04%     -    0s
     0     0 -152528.09    0   27 -152463.83 -152528.09  0.04%     -    0s
H    0     0                    -152469.6034 -152528.09  0.04%     -    0s
     0     0 -152520.07    0    2 -152469.60 -152520.07  0.03%     -    0s
H    0     0                    -152514.4951 -152514.50  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 6
  MIR: 20
  Flow cover: 2

Explored 1 nodes (599 simplex iterations) in 0.11 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -152514 -152470 -152464 ... 1.27847e+13
No other solutions better than -152514

Optimal solution found (tolerance 1.00e-04)
Best objective -1.525144950795e+05, best bound -1.525144950795e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 206489.14
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152514.50
  [DEBUG]   S×d_nominal = 359003.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 359003.63 + -152514.50 = 206489.14
  [DEBUG]   Current θ from Master = 223553.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17064.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45603.94
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 5076.6397, Absolute Gap = 5076.6397, Relative Gap = 0.081008
  Not converged yet (gap = 5076.64 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0x71cb3950
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33855 rows and 13745 columns
Presolve time: 1.18s
Presolved: 43978 rows, 19715 columns, 272534 nonzeros
Variable types: 17456 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -196616.4025

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43978 rows, 19715 columns, 272534 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25793    3.3932183e+04   0.000000e+00   8.016283e+07      5s
   38025    5.2526487e+04   0.000000e+00   8.098031e+06     10s
Concurrent spin time: 1.12s

Solved with dual simplex

Root relaxation: objective 9.926020e+04, 28886 iterations, 11.51 seconds (15.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99260.2040    0   79 -196616.40 99260.2040   150%     -   13s
H    0     0                    -191290.1555 99260.2040   152%     -   13s
H    0     0                    -128585.5454 99260.2040   177%     -   13s
H    0     0                    -113052.3332 99260.2040   188%     -   13s
H    0     0                    -102635.2143 99260.2040   197%     -   13s
H    0     0                    -102531.8229 99260.2040   197%     -   13s
H    0     0                    -100420.7176 99260.2040   199%     -   13s
H    0     0                    -98113.97308 99260.2040   201%     -   13s
H    0     0                    -95631.02804 99260.2040   204%     -   13s
H    0     0                    -95625.59592 99260.2040   204%     -   13s
H    0     0                    -31266.40303 99260.2040   417%     -   13s
H    0     0                    -18316.46906 99260.2040   642%     -   14s
H    0     0                    26815.864537 99260.2040   270%     -   14s
H    0     0                    29365.176084 99260.2040   238%     -   14s
H    0     0                    34532.162259 99260.2040   187%     -   14s
H    0     0                    37756.929273 99260.2040   163%     -   14s
H    0     0                    38447.462986 99260.2040   158%     -   14s
H    0     0                    39875.613248 99260.2040   149%     -   14s
H    0     0                    42906.423277 99260.2040   131%     -   14s
H    0     0                    43346.333085 99260.2040   129%     -   14s
H    0     0                    43410.722320 99260.2040   129%     -   14s
H    0     0                    43940.454466 99260.2040   126%     -   14s
H    0     0                    44479.970621 99260.2040   123%     -   14s
H    0     0                    45569.132744 99260.2040   118%     -   15s
H    0     0                    45995.331791 99260.2040   116%     -   15s
H    0     0                    46250.824508 99260.2040   115%     -   15s
     0     0 93726.5966    0  143 46250.8245 93726.5966   103%     -   19s
H    0     0                    46540.893373 93726.3234   101%     -   20s
H    0     0                    46598.236593 93726.3234   101%     -   20s
H    0     0                    47053.140048 93726.3234  99.2%     -   20s
H    0     0                    47430.679896 93726.3234  97.6%     -   20s
H    0     0                    47468.611975 93726.3234  97.4%     -   20s
H    0     0                    47545.663387 93726.3234  97.1%     -   20s
H    0     0                    47633.208329 93726.3234  96.8%     -   20s
     0     0 93014.6585    0  189 47633.2083 93014.6585  95.3%     -   23s
     0     0 92954.3070    0  167 47633.2083 92954.3070  95.1%     -   24s
     0     0 92951.5788    0  170 47633.2083 92951.5788  95.1%     -   24s
     0     0 92951.5780    0  170 47633.2083 92951.5780  95.1%     -   24s
     0     0 90255.7170    0  220 47633.2083 90255.7170  89.5%     -   30s
H    0     0                    47999.345420 90255.6228  88.0%     -   30s
H    0     0                    48586.261541 90255.6228  85.8%     -   30s
     0     0 89505.1818    0  224 48586.2615 89505.1818  84.2%     -   34s
     0     0 89260.3286    0  261 48586.2615 89260.3286  83.7%     -   37s
H    0     0                    49908.808913 89015.2739  78.4%     -   38s
H    0     0                    49959.401351 89015.2739  78.2%     -   38s
     0     0 89015.2739    0  263 49959.4014 89015.2739  78.2%     -   38s
     0     0 88947.5813    0  244 49959.4014 88947.5813  78.0%     -   39s
     0     0 88835.5444    0  242 49959.4014 88835.5444  77.8%     -   40s
     0     0 88803.2017    0  246 49959.4014 88803.2017  77.8%     -   40s
     0     0 88780.1559    0  258 49959.4014 88780.1559  77.7%     -   40s
     0     0 88771.2686    0  254 49959.4014 88771.2686  77.7%     -   41s
     0     0 88770.2048    0  258 49959.4014 88770.2048  77.7%     -   41s
     0     0 88770.1804    0  260 49959.4014 88770.1804  77.7%     -   41s
     0     0 87273.1282    0  341 49959.4014 87273.1282  74.7%     -   49s
H    0     0                    50488.870557 87272.8649  72.9%     -   50s
H    0     0                    50558.375611 87272.8649  72.6%     -   50s
H    0     0                    50642.920739 87272.8649  72.3%     -   50s
H    0     0                    50699.131664 87272.8649  72.1%     -   50s
H    0     0                    50714.893771 87272.8649  72.1%     -   50s
H    0     0                    51917.172759 87083.2165  67.7%     -   52s
H    0     0                    52158.132081 87083.2165  67.0%     -   52s
H    0     0                    53238.910660 87083.2165  63.6%     -   52s
H    0     0                    53530.383389 87083.2165  62.7%     -   52s
     0     0 87083.2165    0  345 53530.3834 87083.2165  62.7%     -   52s
H    0     0                    54463.752524 86885.0559  59.5%     -   54s
H    0     0                    56403.889889 86885.0559  54.0%     -   54s
     0     0 86885.0559    0  356 56403.8899 86885.0559  54.0%     -   54s
     0     0 86780.9814    0  348 56403.8899 86780.9814  53.9%     -   57s
     0     0 86750.3121    0  355 56403.8899 86750.3121  53.8%     -   58s
     0     0 86718.0658    0  355 56403.8899 86718.0658  53.7%     -   60s
     0     0 86695.6421    0  345 56403.8899 86695.6421  53.7%     -   60s
     0     0 86685.5513    0  350 56403.8899 86685.5513  53.7%     -   61s
     0     0 86680.9322    0  353 56403.8899 86680.9322  53.7%     -   61s
     0     0 86666.5589    0  356 56403.8899 86666.5589  53.7%     -   62s
     0     0 86652.6638    0  361 56403.8899 86652.6638  53.6%     -   63s
     0     0 86647.8640    0  352 56403.8899 86647.8640  53.6%     -   63s
     0     0 86640.2111    0  349 56403.8899 86640.2111  53.6%     -   64s
     0     0 86638.5156    0  349 56403.8899 86638.5156  53.6%     -   64s
     0     0 86638.3459    0  348 56403.8899 86638.3459  53.6%     -   64s
     0     0 86168.9948    0  363 56403.8899 86168.9948  52.8%     -   73s
H    0     0                    56937.139694 86033.2031  51.1%     -   76s
     0     0 86033.2031    0  343 56937.1397 86033.2031  51.1%     -   76s
     0     0 85932.3434    0  360 56937.1397 85932.3434  50.9%     -   77s
     0     0 85857.5941    0  364 56937.1397 85857.5941  50.8%     -   79s
     0     0 85838.3598    0  365 56937.1397 85838.3598  50.8%     -   79s
     0     0 85822.4652    0  363 56937.1397 85822.4652  50.7%     -   80s
     0     0 85800.8693    0  367 56937.1397 85800.8693  50.7%     -   81s
     0     0 85792.9217    0  366 56937.1397 85792.9217  50.7%     -   81s
     0     0 85790.3780    0  368 56937.1397 85790.3780  50.7%     -   81s
     0     0 85787.7012    0  362 56937.1397 85787.7012  50.7%     -   82s
     0     0 85787.5511    0  362 56937.1397 85787.5511  50.7%     -   82s
     0     0 85611.8506    0  376 56937.1397 85611.8506  50.4%     -   86s
     0     0 85520.5626    0  385 56937.1397 85520.5626  50.2%     -   89s
     0     0 85504.0460    0  349 56937.1397 85504.0460  50.2%     -   90s
     0     0 85494.4617    0  358 56937.1397 85494.4617  50.2%     -   90s
     0     0 85491.8359    0  355 56937.1397 85491.8359  50.2%     -   91s
     0     0 85490.7196    0  362 56937.1397 85490.7196  50.1%     -   91s
     0     0 85406.3433    0  392 56937.1397 85406.3433  50.0%     -   93s
     0     0 85381.1600    0  395 56937.1397 85381.1600  50.0%     -   95s
     0     0 85344.2805    0  396 56937.1397 85344.2805  49.9%     -   95s
     0     0 85334.7269    0  395 56937.1397 85334.7269  49.9%     -   96s
     0     0 85327.3989    0  393 56937.1397 85327.3989  49.9%     -   97s
     0     0 85325.9655    0  364 56937.1397 85325.9655  49.9%     -   97s
     0     0 85306.9394    0  400 56937.1397 85306.9394  49.8%     -   98s
     0     0 85297.1220    0  399 56937.1397 85297.1220  49.8%     -   99s
     0     0 85295.7016    0  402 56937.1397 85295.7016  49.8%     -   99s
     0     0 85279.1301    0  402 56937.1397 85279.1301  49.8%     -  100s
     0     0 85258.3786    0  406 56937.1397 85258.3786  49.7%     -  102s
     0     0 85251.1866    0  402 56937.1397 85251.1866  49.7%     -  103s
     0     0 85248.1498    0  404 56937.1397 85248.1498  49.7%     -  103s
     0     0 85247.0150    0  410 56937.1397 85247.0150  49.7%     -  104s
     0     0 85241.9214    0  364 56937.1397 85241.9214  49.7%     -  105s
     0     0 85239.1679    0  372 56937.1397 85239.1679  49.7%     -  106s
     0     0 85238.7855    0  362 56937.1397 85238.7855  49.7%     -  106s
     0     0 85237.3433    0  360 56937.1397 85237.3433  49.7%     -  107s
     0     0 85236.1804    0  357 56937.1397 85236.1804  49.7%     -  108s
     0     0 85232.1488    0  362 56937.1397 85232.1488  49.7%     -  109s
     0     0 85231.3175    0  355 56937.1397 85231.3175  49.7%     -  109s
     0     0 85228.7846    0  396 56937.1397 85228.7846  49.7%     -  111s
     0     0 85227.1613    0  396 56937.1397 85227.1613  49.7%     -  111s
     0     2 85227.1613    0  396 56937.1397 85227.1613  49.7%     -  129s
     1     4 85139.4388    1  363 56937.1397 85225.7139  49.7%  1341  136s
     3     8 85040.7195    2  371 56937.1397 85136.5686  49.5%  3799  142s
     7    16 84963.7842    3  361 56937.1397 85040.1197  49.4%  3680  149s
    15    32 84898.8226    4  401 56937.1397 84963.6107  49.2%  4176  158s
    31    50 81325.2554    5  291 56937.1397 84898.7567  49.1%  6079  174s
    49    82 81985.9581    6  374 56937.1397 84898.7567  49.1%  6262  184s
H   53    82                    57105.806937 84898.7567  48.7%  6158  184s
H   55    82                    57385.774155 84898.7567  47.9%  6165  184s
H   62    82                    57488.708965 84898.7567  47.7%  6134  184s
    81   117 81835.8001    7  359 57488.7090 84898.7567  47.7%  5322  194s
H  116   261                    57712.784326 84898.7567  47.1%  4668  206s
H  119   261                    59419.859420 84898.7567  42.9%  4618  206s
   260   343 81612.1178    9  360 59419.8594 84898.7567  42.9%  2928  216s
H  342   420                    59509.707373 84898.7567  42.7%  2661  222s
H  348   420                    59960.356103 84898.7567  41.6%  2647  222s
   419   512 79440.3443   10  314 59960.3561 84898.7567  41.6%  2445  229s
   511   549 81479.5845   10  351 59960.3561 84898.7567  41.6%  2218  234s
H  512   549                    60247.018508 84898.7567  40.9%  2214  234s
   548   623 81435.3990   11  332 60247.0185 84898.7567  40.9%  2176  239s
   628   654 81008.1350   11  356 60247.0185 84898.7567  40.9%  2056  246s
H  629   654                    60336.866461 84898.7567  40.7%  2052  246s
   661   732 81167.9766   11  310 60336.8665 84898.7567  40.7%  2041  253s
   747   775 80840.3400   12  325 60336.8665 84696.2704  40.4%  1936  259s
   794   829 81171.8483   12  339 60336.8665 84696.0451  40.4%  1932  267s
   852   861 80779.6386   12  337 60336.8665 84696.0451  40.4%  1918  273s
   896   908 79636.2045   12  320 60336.8665 84696.0451  40.4%  1903  282s
   957   945 78154.4842   11  286 60336.8665 84696.0451  40.4%  1864  290s
   996   979 78626.7620   13  318 60336.8665 84696.0451  40.4%  1855  296s
  1038  1033 80188.9467   13  324 60336.8665 84696.0451  40.4%  1835  301s
  1107  1120 80538.9279   13  327 60336.8665 84696.0451  40.4%  1781  309s
  1206  1202 78955.8116   13  339 60336.8665 83805.1723  38.9%  1703  317s
  1320  1255 80043.8747   13  335 60336.8665 83803.7394  38.9%  1639  327s
  1435  1327 78430.5113   13  330 60336.8665 83803.7394  38.9%  1605  334s
  1535  1399 80413.5265   14  340 60336.8665 83803.7394  38.9%  1593  344s
  1658  1472 78932.8879   13  312 60336.8665 83803.7394  38.9%  1563  355s
  1765  1556 79251.5239   15  330 60336.8665 83803.7394  38.9%  1563  362s
  1867  1646 79340.2659   15  337 60336.8665 83803.7394  38.9%  1565  370s
  1975  1770 77218.0889   15  279 60336.8665 83436.2842  38.3%  1573  379s
  2111  1914 78918.5004   16  304 60336.8665 83436.2842  38.3%  1550  389s
  2285  2040 77778.2164   17  282 60336.8665 83436.2842  38.3%  1510  399s
  2360  2040 73944.1167   12  243 60336.8665 83436.2842  38.3%  1494  400s
  2455  2188 75282.1754   19  255 60336.8665 83407.8663  38.2%  1484  412s
  2631  2350 77223.4552   19  276 60336.8665 83407.8663  38.2%  1465  424s
  2857  2488 76755.7469   19  267 60336.8665 83407.8663  38.2%  1414  436s
  3046  2685 75911.5564   20  257 60336.8665 82852.9568  37.3%  1403  447s
  3265  2905 75049.2663   20  248 60336.8665 82848.5670  37.3%  1381  458s
  3530  2906 75226.0571   20  396 60336.8665 82848.5670  37.3%  1345  492s
  3532  2907 64911.4200   28   79 60336.8665 82848.5670  37.3%  1344  517s
  3533  2908 63424.6967   50  214 60336.8665 82848.5670  37.3%  1343  529s
  3534  2909 71723.2555   46  258 60336.8665 82848.5670  37.3%  1343  534s
  3535  2909 77344.1968   22  346 60336.8665 82848.5670  37.3%  1343  539s
  3536  2910 77571.3727   14  356 60336.8665 82848.5670  37.3%  1342  542s
  3537  2911 72665.9537   32  356 60336.8665 82848.5670  37.3%  1342  545s
  3540  2913 72253.3732   18  395 60336.8665 82848.5670  37.3%  1341  550s
  3543  2915 74721.1911   16  389 60336.8665 82848.5670  37.3%  1340  555s
  3548  2918 72780.1061   31  410 60336.8665 82848.5670  37.3%  1338  560s
  3552  2921 65759.1568   55  349 60336.8665 82848.5670  37.3%  1336  565s
  3555  2923 63929.3877   34  363 60336.8665 82848.5670  37.3%  1335  572s
  3557  2924 75595.3847   21  355 60336.8665 82848.5670  37.3%  1334  577s
  3559  2925 72253.3732   18  347 60336.8665 82848.5670  37.3%  1334  583s
  3561  2927 65824.0846   26  361 60336.8665 82848.5670  37.3%  1333  586s
  3563  2928 63026.5556   74  348 60336.8665 82848.5670  37.3%  1332  592s
  3565  2929 69257.9817   51  350 60336.8665 82848.5670  37.3%  1331  596s
  3566  2930 69542.5046   42  350 60336.8665 82848.5670  37.3%  1331  622s
  3567  2931 77340.0069   17  350 60336.8665 82848.5670  37.3%  1331  646s
  3568  2934 82848.5670   12  397 60336.8665 82848.5670  37.3%  1356  656s
  3570  2938 82848.5670   13  351 60336.8665 82848.5670  37.3%  1356  678s
  3574  2944 82848.5670   14  363 60336.8665 82848.5670  37.3%  1356  690s
  3582  2958 82848.5670   15  365 60336.8665 82848.5670  37.3%  1366  705s
  3598  2970 81837.4911   16  314 60336.8665 82848.5670  37.3%  1390  726s
  3616  2996 82281.3073   17  349 60336.8665 82848.5670  37.3%  1410  755s
  3648  3062 80003.6110   18  336 60336.8665 82848.5670  37.3%  1439  778s
  3724  3121 76777.8334   20  331 60336.8665 82848.5670  37.3%  1548  793s
  3809  3181 79138.8469   19  316 60336.8665 82848.5670  37.3%  1592  809s
  3901  3231 76888.4760   21  337 60336.8665 82848.5670  37.3%  1625  820s
  3990  3254 73038.9986   21  301 60336.8665 82848.5670  37.3%  1641  833s
  4058  3292 75377.3281   22  336 60336.8665 82848.5670  37.3%  1652  850s
  4145  3335 75230.7967   22  321 60336.8665 82848.5670  37.3%  1660  862s
  4239  3370 76716.5475   22  291 60336.8665 82848.5670  37.3%  1665  875s
  4329  3388 75083.0137   23  290 60336.8665 82848.5670  37.3%  1668  887s
  4412  3382 74697.7776   24  336 60336.8665 82848.5670  37.3%  1671  903s
  4493  3403 72537.6337   25  338 60336.8665 82848.5670  37.3%  1678  915s
  4572  3405 74268.6856   24  269 60336.8665 82848.5670  37.3%  1686  925s
  4606  3425 69852.8213   24  263 60336.8665 82848.5670  37.3%  1695  933s
  4662  3433 72463.6520   25  249 60336.8665 82848.5670  37.3%  1697  950s
  4723  3440 72380.7077   25  271 60336.8665 82475.3171  36.7%  1712  963s
  4766  3475 71267.0144   26  296 60336.8665 82475.3171  36.7%  1717  975s
  4844  3480 67005.1356   26  248 60336.8665 82475.3171  36.7%  1723  990s
  4935  3492 70876.4195   26  311 60336.8665 82475.3171  36.7%  1725 1005s
  5012  3514 71186.0027   27  280 60336.8665 82277.5330  36.4%  1738 1018s
  5084  3556 70734.1056   28  276 60336.8665 82277.5330  36.4%  1748 1030s
  5163  3610 68594.2326   28  265 60336.8665 82277.5330  36.4%  1763 1042s
  5271  3645 69359.7069   29  235 60336.8665 82277.5330  36.4%  1769 1057s
  5401  3676 68210.1951   30  226 60336.8665 80925.1127  34.1%  1769 1074s
  5536  3704 68619.7495   29  260 60336.8665 80925.1127  34.1%  1771 1088s
  5671  3734 67575.3729   32  227 60336.8665 80925.1127  34.1%  1778 1108s
  5810  3766 65671.2021   36  175 60336.8665 80925.1127  34.1%  1784 1123s
  5927  3833 62075.2539   41  125 60336.8665 80821.7646  34.0%  1806 1138s
  6051  3901 60875.6755   50  109 60336.8665 80821.7646  34.0%  1821 1155s
  6235  3866 76946.2044   21  313 60336.8665 80792.0962  33.9%  1821 1174s
  6301  3937 75326.8066   22  352 60336.8665 80792.0962  33.9%  1828 1191s
  6417  4002 73167.7802   25  279 60336.8665 80792.0962  33.9%  1850 1209s
  6580  4040 70294.8194   29  333 60336.8665 80792.0962  33.9%  1865 1229s
  6742  4084 63381.4098   32  218 60336.8665 80260.6806  33.0%  1879 1249s
  6952  4121 61151.4176   35  172 60336.8665 80047.9012  32.7%  1884 1267s
  7138  4135 76007.6108   18  332 60336.8665 80047.9012  32.7%  1895 1286s
  7343  4088 74222.0209   20  350 60336.8665 80047.9012  32.7%  1905 1303s
  7386  4093 69746.1939   21  357 60336.8665 80047.9012  32.7%  1909 1319s
  7439  4100 69480.7380   22  336 60336.8665 80047.9012  32.7%  1911 1339s
  7541  4117 69069.5386   23  340 60336.8665 80047.9012  32.7%  1914 1359s
  7626  4184 67886.2006   24  341 60336.8665 80047.9012  32.7%  1918 1383s
  7828  4213     cutoff   29      60336.8665 80047.9012  32.7%  1923 1407s
  8033  4258 71413.7719   24  358 60336.8665 79319.7013  31.5%  1941 1433s
  8294  4358 68776.7310   29  338 60336.8665 79319.7013  31.5%  1953 1461s
  8570  4418 61670.2384   34  209 60336.8665 78227.4963  29.7%  1957 1488s
  8920  4426 71789.5420   21  329 60336.8665 78193.7379  29.6%  1949 1513s
H 8996  4171                    61278.560547 78193.7379  27.6%  1952 1513s
  9142  4197 67291.7561   23  329 61278.5605 78193.7379  27.6%  1947 1540s
  9411  4228 63239.2051   27  293 61278.5605 78149.8869  27.5%  1965 1572s
  9699  4273 74218.8082   20  368 61278.5605 78010.1675  27.3%  1980 1605s
  9993  4285 66468.4047   28  162 61278.5605 77661.9453  26.7%  2003 1638s
 10351  4417 74000.5550   19  313 61278.5605 77231.4040  26.0%  2015 1672s
H10521  4072                    62048.635151 77231.4040  24.5%  2007 1672s
 10775  4104 62109.1132   59   50 62048.6352 77231.4040  24.5%  2012 1705s
 11126  4103 68363.4635   26  295 62048.6352 77211.1185  24.4%  2026 1740s
 11480  4123 74462.0937   20  344 62048.6352 76770.0803  23.7%  2044 1778s
 11839  4279 67550.7247   28  175 62048.6352 76582.4129  23.4%  2064 1814s
 12173  4450 67066.5048   27  277 62048.6352 76515.5142  23.3%  2088 1852s
 12648  4637 64283.7088   31  244 62048.6352 76460.8028  23.2%  2089 1894s
 13129  4736     cutoff   27      62048.6352 76460.8028  23.2%  2093 1933s
H13141  4735                    62056.265993 76460.8028  23.2%  2092 1933s
H13306  4512                    62842.759270 76460.8028  21.7%  2095 1933s
 13485  4596     cutoff   32      62842.7593 76048.7573  21.0%  2101 1977s
 13950  4735 68146.1704   22  356 62842.7593 75908.6998  20.8%  2112 2024s
 14359  4817 70728.6509   22  306 62842.7593 75908.6998  20.8%  2128 2069s
H14385  4743                    63090.131910 75908.6998  20.3%  2130 2069s
 14541  4906 68900.0420   25  334 63090.1319 75908.6998  20.3%  2137 2116s
 15065  5054 69658.5170   24  369 63090.1319 75726.8740  20.0%  2148 2169s
 15597  5221 69315.1157   21  272 63090.1319 75389.0023  19.5%  2158 2223s
 16134  5446     cutoff   33      63090.1319 75172.8709  19.2%  2163 2280s
 16690  5603     cutoff   32      63090.1319 75027.4690  18.9%  2178 2334s
 17322  5801 70811.8097   23  356 63090.1319 74926.8120  18.8%  2186 2390s
 17936  5935     cutoff   27      63090.1319 74744.5008  18.5%  2197 2449s
 18405  6106 68647.9611   28  254 63090.1319 74609.1530  18.3%  2219 2512s
 19107  6265 65992.0846   26  265 63090.1319 74574.0000  18.2%  2228 2576s
 19827  6347 72321.4016   22  364 63090.1319 74359.4849  17.9%  2237 2637s
 20182  6508     cutoff   27      63090.1319 74332.2210  17.8%  2242 2701s
 20825  6675     cutoff   29      63090.1319 74252.8876  17.7%  2256 2810s
 21647  6812     cutoff   28      63090.1319 74068.3505  17.4%  2263 2883s
 22699  6991 66436.4595   25  238 63090.1319 73861.4230  17.1%  2249 2958s
 23602  7203     cutoff   24      63090.1319 73683.4495  16.8%  2252 3037s
 24537  7402 67399.5473   30  212 63090.1319 73457.3622  16.4%  2254 3115s
 25417  7579 65502.8089   27  398 63090.1319 73328.7622  16.2%  2266 3200s
 26351  7761 68580.1756   28  317 63090.1319 73135.3094  15.9%  2274 3288s
 27334  7951     cutoff   23      63090.1319 72956.1477  15.6%  2280 3375s
 28424  7965 infeasible   24      63090.1319 72730.3992  15.3%  2282 3456s
H28590  7924                    63167.405988 72709.5458  15.1%  2283 3456s
 28763  8083 64254.7056   33  215 63167.4060 72709.5458  15.1%  2282 3556s
 29871  8126     cutoff   23      63167.4060 72639.7923  15.0%  2291 3600s

Cutting planes:
  MIR: 1297
  Mixing: 8
  Flow cover: 2005
  RLT: 18
  Relax-and-lift: 98

Explored 30441 nodes (69867426 simplex iterations) in 3600.03 seconds (7305.54 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 63167.4 63090.1 62842.8 ... 59509.7

Time limit reached
Best objective 6.316740598775e+04, best bound 7.263979234452e+04, gap 14.9957%
  WARNING: Time limit reached. Using best solution found (gap: 15.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 63167.41, θ = 219385.17
  Upper Bound (UB) = 63167.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 219385.17
  [DEBUG]   ✓ Scenario 0: θ = 219385.17 ≤ Q = 219385.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 219385.17 ≤ Q = 219385.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 219385.17 ≤ Q = 219385.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 219385.17 ≤ Q = 219385.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 219385.17 ≤ Q = 219385.17 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71168ebd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71168ebd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.271025e+13
Presolve removed 2599 rows and 1887 columns
Presolve time: 0.01s
Presolved: 494 rows, 502 columns, 1396 nonzeros
Found heuristic solution: objective 6019859.0077
Variable types: 339 continuous, 163 integer (163 binary)
Found heuristic solution: objective 6018826.8075

Root relaxation: objective -1.742855e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174285.46    0  119 6018826.81 -174285.46   103%     -    0s
H    0     0                    -144490.8739 -174285.46  20.6%     -    0s
H    0     0                    -144794.7455 -174285.46  20.4%     -    0s
H    0     0                    -146256.9457 -174285.46  19.2%     -    0s
H    0     0                    -146560.8173 -174285.46  18.9%     -    0s
     0     0 -160479.20    0   76 -146560.82 -160479.20  9.50%     -    0s
H    0     0                    -157667.0470 -160401.72  1.73%     -    0s
H    0     0                    -158632.1416 -160401.72  1.12%     -    0s
H    0     0                    -158903.9713 -160401.72  0.94%     -    0s
H    0     0                    -158944.4056 -160401.72  0.92%     -    0s
     0     0 -159801.25    0   44 -158944.41 -159801.25  0.54%     -    0s
H    0     0                    -159198.0598 -159797.83  0.38%     -    0s
H    0     0                    -159211.8417 -159797.83  0.37%     -    0s
     0     0 -159607.39    0   48 -159211.84 -159607.39  0.25%     -    0s
     0     0 -159563.91    0   31 -159211.84 -159563.91  0.22%     -    0s
     0     0 -159562.91    0   29 -159211.84 -159562.91  0.22%     -    0s
     0     0 -159339.73    0   10 -159211.84 -159339.73  0.08%     -    0s
     0     0 -159339.65    0    9 -159211.84 -159339.65  0.08%     -    0s
H    0     0                    -159235.9434 -159333.88  0.06%     -    0s
     0     0 -159309.61    0    8 -159235.94 -159309.61  0.05%     -    0s
     0     0 -159277.74    0    5 -159235.94 -159277.74  0.03%     -    0s
     0     0 -159272.69    0    8 -159235.94 -159272.69  0.02%     -    0s
H    0     0                    -159247.3707 -159272.69  0.02%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 3
  MIR: 4
  Flow cover: 4
  RLT: 2

Explored 1 nodes (597 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -159247 -159236 -159212 ... -144795

Optimal solution found (tolerance 1.00e-04)
Best objective -1.592473706500e+05, best bound -1.592597872870e+05, gap 0.0078%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 203291.36
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -159247.37
  [DEBUG]   S×d_nominal = 362538.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 362538.73 + -159247.37 = 203291.36
  [DEBUG]   Current θ from Master = 219385.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16093.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 47073.60
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 5575.2987, Absolute Gap = 5575.2987, Relative Gap = 0.088262
  Not converged yet (gap = 5575.30 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0x9f6607bc
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40622 rows and 16492 columns
Presolve time: 1.68s
Presolved: 52501 rows, 23208 columns, 325949 nonzeros
Variable types: 20949 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -196616.4025

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52501 rows, 23208 columns, 325949 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25453   -5.4324863e+04   0.000000e+00   3.087099e+07      5s
   40129    4.2327994e+04   0.000000e+00   1.041665e+09     10s
   54078    5.6804768e+04   0.000000e+00   1.960403e+07     15s
Concurrent spin time: 2.04s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 9.924983e+04, 32399 iterations, 17.68 seconds (23.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99249.8331    0   84 -196616.40 99249.8331   150%     -   19s
H    0     0                    -189447.2237 99249.8331   152%     -   19s
H    0     0                    -128267.5233 99249.8331   177%     -   20s
H    0     0                    -127519.1144 99249.8331   178%     -   20s
H    0     0                    -108674.9211 99249.8331   191%     -   20s
H    0     0                    -48037.70601 99249.8331   307%     -   20s
H    0     0                    14088.192129 99249.8331   604%     -   20s
H    0     0                    17250.738687 99249.8331   475%     -   20s
H    0     0                    28752.494725 99249.8331   245%     -   20s
H    0     0                    28935.724285 99249.8331   243%     -   21s
H    0     0                    28939.146810 99249.8331   243%     -   21s
H    0     0                    35766.251440 99249.8331   177%     -   21s
H    0     0                    39500.364098 99249.8331   151%     -   21s
H    0     0                    41023.601718 99249.8331   142%     -   21s
H    0     0                    42395.202372 99249.8331   134%     -   21s
H    0     0                    44147.524034 99249.8331   125%     -   21s
H    0     0                    44346.783805 99249.8331   124%     -   21s
H    0     0                    44501.614528 99249.8331   123%     -   21s
H    0     0                    44556.283262 99249.8331   123%     -   21s
H    0     0                    47098.687658 99249.8331   111%     -   21s
H    0     0                    47114.831351 99249.8331   111%     -   21s
H    0     0                    47669.672205 99249.8331   108%     -   21s
H    0     0                    47744.858065 99249.8331   108%     -   21s
H    0     0                    47826.245898 99249.8331   108%     -   21s
H    0     0                    48583.719613 99249.8331   104%     -   21s
H    0     0                    48658.905473 99249.8331   104%     -   21s
H    0     0                    48666.931363 99249.8331   104%     -   21s
H    0     0                    49005.600367 99249.8331   103%     -   21s
     0     0 93908.2514    0  147 49005.6004 93908.2514  91.6%     -   27s
H    0     0                    49363.762036 93058.3406  88.5%     -   35s
H    0     0                    49639.819077 93058.3406  87.5%     -   35s
H    0     0                    49758.144584 93058.3406  87.0%     -   35s
     0     0 93000.6768    0  160 49758.1446 93000.6768  86.9%     -   35s
     0     0 93000.6768    0  162 49758.1446 93000.6768  86.9%     -   35s
     0     0 93000.6768    0  162 49758.1446 93000.6768  86.9%     -   36s
     0     0 93000.6377    0  158 49758.1446 93000.6377  86.9%     -   36s
H    0     0                    49802.354084 90226.9569  81.2%     -   47s
     0     0 90226.9569    0  205 49802.3541 90226.9569  81.2%     -   47s
H    0     0                    50967.949258 90226.8030  77.0%     -   48s
H    0     0                    50969.922411 90226.8030  77.0%     -   48s
H    0     0                    51157.840936 90226.8030  76.4%     -   48s
     0     0 89478.0456    0  275 51157.8409 89478.0456  74.9%     -   56s
     0     0 89031.8221    0  243 51157.8409 89031.8221  74.0%     -   64s
     0     0 88796.2241    0  277 51157.8409 88796.2241  73.6%     -   69s
H    0     0                    55420.184019 88736.4743  60.1%     -   71s
H    0     0                    55461.689021 88736.4743  60.0%     -   71s
     0     0 88736.4743    0  279 55461.6890 88736.4743  60.0%     -   71s
     0     0 88715.2666    0  281 55461.6890 88715.2666  60.0%     -   72s
     0     0 88706.2290    0  277 55461.6890 88706.2290  59.9%     -   73s
     0     0 88703.7667    0  274 55461.6890 88703.7667  59.9%     -   73s
     0     0 88702.6511    0  280 55461.6890 88702.6511  59.9%     -   73s
     0     0 88702.6511    0  280 55461.6890 88702.6511  59.9%     -   73s
H    0     0                    56168.077930 87229.7371  55.3%     -   87s
H    0     0                    56175.317086 87229.7371  55.3%     -   87s
H    0     0                    56245.071381 87229.7371  55.1%     -   87s
     0     0 87229.7371    0  344 56245.0714 87229.7371  55.1%     -   87s
H    0     0                    57811.560645 86923.8924  50.4%     -   90s
H    0     0                    57834.650158 86923.8924  50.3%     -   90s
H    0     0                    57869.352179 86923.8924  50.2%     -   90s
     0     0 86923.8924    0  337 57869.3522 86923.8924  50.2%     -   91s
H    0     0                    57881.164040 86804.8383  50.0%     -   94s
     0     0 86804.8383    0  348 57881.1640 86804.8383  50.0%     -   94s
     0     0 86761.4474    0  351 57881.1640 86761.4474  49.9%     -   95s
     0     0 86718.4918    0  353 57881.1640 86718.4918  49.8%     -   96s
     0     0 86696.1051    0  359 57881.1640 86696.1051  49.8%     -   97s
     0     0 86675.5872    0  349 57881.1640 86675.5872  49.7%     -   98s
     0     0 86672.4976    0  356 57881.1640 86672.4976  49.7%     -   98s
     0     0 86668.1427    0  355 57881.1640 86668.1427  49.7%     -   99s
     0     0 86667.0225    0  355 57881.1640 86667.0225  49.7%     -   99s
     0     0 86031.5507    0  341 57881.1640 86031.5507  48.6%     -  111s
     0     0 85839.8339    0  334 57881.1640 85839.8339  48.3%     -  116s
     0     0 85700.3406    0  379 57881.1640 85700.3406  48.1%     -  118s
     0     0 85609.0473    0  351 57881.1640 85609.0473  47.9%     -  121s
     0     0 85594.4889    0  351 57881.1640 85594.4889  47.9%     -  122s
     0     0 85588.3332    0  381 57881.1640 85588.3332  47.9%     -  123s
     0     0 85573.2008    0  383 57881.1640 85573.2008  47.8%     -  124s
     0     0 85561.9805    0  349 57881.1640 85561.9805  47.8%     -  125s
     0     0 85557.2690    0  384 57881.1640 85557.2690  47.8%     -  125s
     0     0 85552.9737    0  386 57881.1640 85552.9737  47.8%     -  126s
     0     0 85551.0888    0  384 57881.1640 85551.0888  47.8%     -  126s
     0     0 85550.8973    0  387 57881.1640 85550.8973  47.8%     -  126s
     0     0 85365.0937    0  381 57881.1640 85365.0937  47.5%     -  131s
     0     0 85307.9788    0  357 57881.1640 85307.9788  47.4%     -  134s
     0     0 85287.0073    0  359 57881.1640 85287.0073  47.3%     -  136s
     0     0 85270.0489    0  357 57881.1640 85270.0489  47.3%     -  137s
     0     0 85258.0334    0  360 57881.1640 85258.0334  47.3%     -  138s
     0     0 85253.1365    0  362 57881.1640 85253.1365  47.3%     -  140s
     0     0 85251.3473    0  359 57881.1640 85251.3473  47.3%     -  140s
     0     0 85249.4574    0  365 57881.1640 85249.4574  47.3%     -  141s
     0     0 85248.8131    0  367 57881.1640 85248.8131  47.3%     -  142s
     0     0 85202.6978    0  364 57881.1640 85202.6978  47.2%     -  144s
H    0     0                    58092.323904 85201.6268  46.7%     -  146s
H    0     0                    58280.932060 85201.6268  46.2%     -  146s
     0     0 85194.9381    0  359 58280.9321 85194.9381  46.2%     -  147s
     0     0 85192.9231    0  361 58280.9321 85192.9231  46.2%     -  148s
     0     0 85191.1124    0  368 58280.9321 85191.1124  46.2%     -  148s
     0     0 85189.9527    0  365 58280.9321 85189.9527  46.2%     -  148s
     0     0 85180.4320    0  378 58280.9321 85180.4320  46.2%     -  150s
     0     0 85177.4605    0  380 58280.9321 85177.4605  46.1%     -  151s
     0     0 85170.8365    0  365 58280.9321 85170.8365  46.1%     -  152s
     0     0 85169.8050    0  366 58280.9321 85169.8050  46.1%     -  152s
     0     0 85151.5996    0  363 58280.9321 85151.5996  46.1%     -  154s
     0     0 85147.8118    0  373 58280.9321 85147.8118  46.1%     -  156s
     0     0 85142.4589    0  377 58280.9321 85142.4589  46.1%     -  156s
     0     0 85142.0469    0  377 58280.9321 85142.0469  46.1%     -  156s
     0     0 85132.8597    0  372 58280.9321 85132.8597  46.1%     -  158s
     0     0 85132.3527    0  372 58280.9321 85132.3527  46.1%     -  158s
     0     0 85124.2658    0  363 58280.9321 85124.2658  46.1%     -  160s
     0     0 85121.8287    0  370 58280.9321 85121.8287  46.1%     -  165s
     0     0 85121.2701    0  372 58280.9321 85121.2701  46.1%     -  166s
     0     0 85111.6922    0  363 58280.9321 85111.6922  46.0%     -  168s
     0     0 85108.4797    0  368 58280.9321 85108.4797  46.0%     -  169s
     0     0 85107.8316    0  366 58280.9321 85107.8316  46.0%     -  169s
     0     0 85107.1701    0  366 58280.9321 85107.1701  46.0%     -  170s
     0     0 85106.2752    0  366 58280.9321 85106.2752  46.0%     -  171s
     0     2 85106.2752    0  366 58280.9321 85106.2752  46.0%     -  194s
     1     4 85074.1807    1  368 58280.9321 85106.2752  46.0%  2240  196s
     3     7 85026.8561    2  366 58280.9321 85074.1543  46.0%  2736  205s
     6    14 84800.4990    3  358 58280.9321 85026.8026  45.9%  4154  217s
    13    28 84548.9830    4  348 58280.9321 85006.3961  45.9%  5765  227s
    27    44 79825.2303    5  313 58280.9321 84548.0400  45.1%  8240  248s
    43    76 82475.9038    6  325 58280.9321 84548.0400  45.1%  8362  267s
H   54    76                    59735.496597 84548.0400  41.5%  7881  267s
    75   209 82413.8066    7  333 59735.4966 84548.0400  41.5%  7122  285s
H  208   241                    59817.515022 84548.0400  41.3%  4999  294s
   240   319 79880.7227   12  289 59817.5150 84548.0400  41.3%  4827  307s
   318   398 79836.6916   13  302 59817.5150 84548.0400  41.3%  4295  315s
H  358   398                    60140.330713 84548.0400  40.6%  4099  315s
   397   477 78630.3080   14  297 60140.3307 84548.0400  40.6%  3930  326s
   476   529 78577.5296   15  300 60140.3307 84548.0400  40.6%  3645  337s
H  479   529                    60288.096017 84548.0400  40.2%  3627  337s
   528   610 78517.2744   17  293 60288.0960 84548.0400  40.2%  3488  347s
   617   698 78179.9868   21  270 60288.0960 84548.0400  40.2%  3257  355s
   705   781 77436.7351   23  260 60288.0960 84548.0400  40.2%  3053  365s
   794   812 76637.1140   25  241 60288.0960 84548.0400  40.2%  2871  370s
   827   845 76600.8746   26  243 60288.0960 84548.0400  40.2%  2827  380s
   866   875 76597.0772   27  235 60288.0960 84548.0400  40.2%  2775  390s
   896   902 76576.9132   28  242 60288.0960 84548.0400  40.2%  2747  396s
   932   926 76457.5436   29  236 60288.0960 84548.0400  40.2%  2719  406s
   968   951 76444.9496   30  235 60288.0960 84548.0400  40.2%  2702  420s
  1005   983 76224.4502   31  236 60288.0960 84357.0611  39.9%  2688  431s
  1037  1013 75885.3204   32  236 60288.0960 84353.1844  39.9%  2705  438s
  1071  1052 75234.5151   33  222 60288.0960 84353.1844  39.9%  2693  448s
  1110  1096 75032.3190   34  224 60288.0960 84353.1844  39.9%  2644  454s
  1160  1155 74904.5802   35  218 60288.0960 84353.1844  39.9%  2595  460s
  1231  1212 74853.0932   36  216 60288.0960 84353.1844  39.9%  2508  471s
  1302  1275 74432.9948   37  218 60288.0960 84353.1844  39.9%  2428  483s
  1393  1338 74229.7592   38  208 60288.0960 84353.1844  39.9%  2340  496s
  1484  1415 73265.6126   41  200 60288.0960 84302.8799  39.8%  2286  507s
  1593  1495 71997.4673   44  161 60288.0960 84302.8799  39.8%  2232  520s
  1707  1560 70094.4440   50  154 60288.0960 84302.8799  39.8%  2185  533s
  1818  1654 64413.6402   57  164 60288.0960 84209.1720  39.7%  2154  548s
  1938  1767     cutoff   67      60288.0960 84209.1720  39.7%  2124  564s
  2099  1834 82275.5624    7  353 60288.0960 84209.1720  39.7%  2074  580s
  2217  1921 81810.7427    9  324 60288.0960 84209.1720  39.7%  2088  595s
  2322  1958 78216.5304   10  295 60288.0960 83161.9829  37.9%  2113  614s
  2429  2017 81558.1180    8  324 60288.0960 83160.7893  37.9%  2133  630s
  2528  2095 78331.3308   11  256 60288.0960 83160.7893  37.9%  2176  648s
  2648  2173 79152.3132   11  290 60288.0960 83160.7893  37.9%  2203  668s
  2754  2250 73747.0181   12  259 60288.0960 82912.5169  37.5%  2232  689s
  2863  2396 78443.6023   11  305 60288.0960 82912.5169  37.5%  2249  707s
  3049  2543 77093.0525   12  305 60288.0960 82641.5549  37.1%  2220  726s
  3244  2678 75811.6809   13  315 60288.0960 82569.3160  37.0%  2186  745s
  3467  2800 74272.7683   16  303 60288.0960 82411.5963  36.7%  2157  766s
  3657  2938 72423.1514   15  275 60288.0960 82411.5963  36.7%  2150  788s
  3829  2939 63020.0281   52  366 60288.0960 82411.5963  36.7%  2158  828s
  3831  2940 77164.7353   11   84 60288.0960 82411.5963  36.7%  2157  865s
  3832  2941 72536.1516   16  242 60288.0960 82411.5963  36.7%  2156  885s
  3833  2942 62371.6291   31  292 60288.0960 82411.5963  36.7%  2156  897s
  3834  2942 64401.1089   23  367 60288.0960 82411.5963  36.7%  2155  905s
  3835  2943 74826.3376   33  338 60288.0960 82411.5963  36.7%  2154  912s
  3836  2944 79944.6256    7  365 60288.0960 82411.5963  36.7%  2154  919s
  3837  2944 76713.0070   16  334 60288.0960 82411.5963  36.7%  2153  926s
  3839  2946 69767.2794   21  389 60288.0960 82411.5963  36.7%  2152  932s
  3841  2947 70010.8062   37  398 60288.0960 82411.5963  36.7%  2151  937s
  3842  2948 74489.3316   10  348 60288.0960 82411.5963  36.7%  2150  940s
  3845  2950 80741.8531   13  368 60288.0960 82411.5963  36.7%  2149  946s
  3847  2951 70552.8632   17  407 60288.0960 82411.5963  36.7%  2148  953s
  3849  2952 75801.1723   26  364 60288.0960 82411.5963  36.7%  2147  955s
  3851  2954 72013.4012   18  355 60288.0960 82411.5963  36.7%  2145  960s
  3853  2955 69775.5422   23  369 60288.0960 82411.5963  36.7%  2144  965s
H 3853  2806                    60336.866461 82411.5963  36.6%  2144  968s
  3856  2808 61896.4818   29  353 60336.8665 82411.5963  36.6%  2143  974s
  3857  2809 72016.8199   44  359 60336.8665 82411.5963  36.6%  2142  976s
  3859  2810 67028.8259   60  394 60336.8665 82411.5963  36.6%  2141  980s
  3861  2811 78828.1868   25  357 60336.8665 82411.5963  36.6%  2140  985s
  3863  2813 71070.9649   33  401 60336.8665 82411.5963  36.6%  2139  990s
  3865  2814 68537.4916   40  403 60336.8665 82411.5963  36.6%  2138 1031s
  3866  2815 72418.9611   16  403 60336.8665 82411.5963  36.6%  2137 1058s
  3867  2818 82411.5963   15  360 60336.8665 82411.5963  36.6%  2176 1072s
  3869  2822 82411.5963   16  393 60336.8665 82411.5963  36.6%  2177 1090s
  3873  2828 82411.5963   17  397 60336.8665 82411.5963  36.6%  2181 1109s
  3881  2842 82411.5963   18  396 60336.8665 82411.5963  36.6%  2193 1128s
  3897  2854 82411.5963   19  384 60336.8665 82411.5963  36.6%  2235 1163s
  3915  2880 80338.9971   20  379 60336.8665 82411.5963  36.6%  2261 1197s
  3947  2907 79649.7938   21  364 60336.8665 82411.5963  36.6%  2332 1220s
  3984  2926 78781.9930   22  357 60336.8665 82411.5963  36.6%  2401 1241s
  4016  2948 77547.0078   22  351 60336.8665 82411.5963  36.6%  2435 1261s
  4048  2969 78495.5722   23  323 60336.8665 82411.5963  36.6%  2466 1286s
  4080  2990 76781.9618   24  313 60336.8665 82411.5963  36.6%  2491 1314s
  4112  3008 73484.3311   23  324 60336.8665 82411.5963  36.6%  2521 1341s
  4148  3027 72776.4318   24  302 60336.8665 82411.5963  36.6%  2546 1363s
  4181  3047 75426.0215   23  288 60336.8665 82411.5963  36.6%  2571 1386s
  4214  3080 77089.5273   23  330 60336.8665 82411.5963  36.6%  2586 1410s
  4258  3103 74847.2942   25  256 60336.8665 82411.5963  36.6%  2607 1433s
  4320  3148 74209.6324   25  356 60336.8665 82411.5963  36.6%  2616 1460s
  4415  3187 73590.6132   26  336 60336.8665 82411.5963  36.6%  2617 1486s
  4525  3188 72585.4168   27  311 60336.8665 82411.5963  36.6%  2619 1507s
  4626  3166 72139.3225   28  278 60336.8665 82411.5963  36.6%  2640 1526s
  4671  3175 71350.3457   29  271 60336.8665 82411.5963  36.6%  2665 1549s
  4720  3201 71964.6524   29  287 60336.8665 82411.5963  36.6%  2705 1567s
  4788  3237 70580.7227   30  262 60336.8665 82411.5963  36.6%  2749 1596s
  4868  3261 70281.6519   31  247 60336.8665 82411.5963  36.6%  2789 1616s
  4962  3280 66126.3911   32  285 60336.8665 82295.1423  36.4%  2831 1637s
  5071  3304 67049.7547   35  206 60336.8665 82295.1423  36.4%  2857 1657s
  5182  3338 64458.6601   37  146 60336.8665 82295.1423  36.4%  2892 1682s
  5294  3334 63528.9212   38  132 60336.8665 81822.5506  35.6%  2933 1703s
  5374  3376 60544.7118   39  107 60336.8665 80885.2802  34.1%  2959 1730s
  5494  3417 71055.7025   25  288 60336.8665 80885.2802  34.1%  2985 1754s
  5623  3462 68935.9784   28  278 60336.8665 80885.2802  34.1%  3021 1777s
  5759  3482 64912.2518   33  225 60336.8665 80885.2802  34.1%  3042 1801s
  5914  3511 infeasible   37      60336.8665 79696.2610  32.1%  3060 1829s
  6047  3559 74907.5501   22  313 60336.8665 79696.2610  32.1%  3111 1855s
  6186  3592 72641.5255   25  326 60336.8665 79696.2610  32.1%  3151 1884s
  6373  3586 69083.3055   29  228 60336.8665 79696.2610  32.1%  3165 1914s
  6548  3576 61547.7325   35  147 60336.8665 79696.2610  32.1%  3198 1944s
  6665  3615 70197.6581   24  312 60336.8665 79696.2610  32.1%  3221 1972s
  6805  3672 64360.6001   30  202 60336.8665 79696.2610  32.1%  3272 2001s
  6976  3699 61891.3544   33  171 60336.8665 79357.8116  31.5%  3309 2037s
  7173  3729 71310.4843   25  317 60336.8665 79357.8116  31.5%  3333 2070s
  7415  3725 69124.1812   28  278 60336.8665 78195.2997  29.6%  3339 2103s
  7652  3763 64678.0059   31  319 60336.8665 78146.0468  29.5%  3372 2138s
  7849  3767 62295.1894   36  205 60336.8665 77299.3488  28.1%  3417 2173s
  8012  3828 69664.4989   23  283 60336.8665 77122.3918  27.8%  3443 2212s
  8260  3869 63774.5637   30  187 60336.8665 76862.1989  27.4%  3460 2249s
  8581  3877 69745.9029   23  348 60336.8665 76862.1989  27.4%  3466 2289s
  8834  3926 64275.0073   28  307 60336.8665 76772.6983  27.2%  3500 2328s
  9102  3947     cutoff   30      60336.8665 76772.6983  27.2%  3516 2369s
  9432  3996     cutoff   31      60336.8665 76629.3945  27.0%  3533 2409s
H 9451  3777                    60970.234292 76629.3945  25.7%  3537 2409s
  9722  3795 63055.2647   32  281 60970.2343 76629.3945  25.7%  3539 2455s
 10061  3802 70372.1425   23  320 60970.2343 76449.2834  25.4%  3573 2500s
 10390  3832 62493.5163   29  255 60970.2343 76073.4442  24.8%  3606 2550s
 10746  3891 63558.9446   31  216 60970.2343 75704.7540  24.2%  3632 2599s
 11201  3929 68958.4348   24  269 60970.2343 74870.1225  22.8%  3642 2650s
 11485  3984     cutoff   27      60970.2343 74656.4240  22.4%  3729 2704s
 11923  3994 67423.2823   23  309 60970.2343 74656.4240  22.4%  3762 2755s
 12346  4154 62413.1818   32  236 60970.2343 74565.7524  22.3%  3794 2812s
 12785  4323 61840.4283   30  222 60970.2343 74249.3858  21.8%  3831 2868s
 13232  4522     cutoff   30      60970.2343 74045.6232  21.4%  3862 2925s
 13717  4702     cutoff   38      60970.2343 73971.0749  21.3%  3887 2983s
 14236  4934 66661.0002   28  299 60970.2343 73697.9572  20.9%  3914 3048s
 14771  5073     cutoff   32      60970.2343 73387.0441  20.4%  3934 3113s
H14863  5068                    61020.808023 73387.0441  20.3%  3935 3113s
 15267  5228 64296.2100   30  231 61020.8080 73387.0441  20.3%  3944 3178s
 15822  5360 67315.6961   23  318 61020.8080 72944.7447  19.5%  3980 3244s
 16335  5591 63918.2408   30  307 61020.8080 72944.7447  19.5%  4003 3318s
 16901  5783 63803.3748   34  209 61020.8080 72578.8656  18.9%  4039 3393s
 17549  6000 69197.6830   25  321 61020.8080 72467.6318  18.8%  4073 3471s
 18213  6241 64473.5109   24  284 61020.8080 72168.1523  18.3%  4100 3549s
 18962  6354 63134.2835   27  317 61020.8080 72168.1523  18.3%  4115 3600s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 833
  Mixing: 9
  Flow cover: 1438
  RLT: 13
  Relax-and-lift: 94

Explored 19370 nodes (80449870 simplex iterations) in 3600.02 seconds (7565.55 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 61020.8 60970.2 60336.9 ... 57881.2

Time limit reached
Best objective 6.102080802276e+04, best bound 7.216729115475e+04, gap 18.2667%
  WARNING: Time limit reached. Using best solution found (gap: 18.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.03s
  Master Objective (UB) = 61020.81, θ = 225353.46
  Upper Bound (UB) = 61020.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225353.46
  [DEBUG]   ✓ Scenario 0: θ = 225353.46 ≤ Q = 225353.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225353.46 ≤ Q = 225353.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 225353.46 ≤ Q = 225353.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225353.46 ≤ Q = 225353.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225353.46 ≤ Q = 225353.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225353.46 ≤ Q = 225353.46 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2384d187
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2384d187
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.285594e+13
Presolve removed 2578 rows and 1869 columns
Presolve time: 0.01s
Presolved: 515 rows, 520 columns, 1453 nonzeros
Found heuristic solution: objective 6285935.7592
Variable types: 354 continuous, 166 integer (166 binary)

Root relaxation: objective -1.635428e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163542.76    0  125 6285935.76 -163542.76   103%     -    0s
H    0     0                    -130331.0433 -163542.76  25.5%     -    0s
H    0     0                    -131873.9196 -163542.76  24.0%     -    0s
H    0     0                    -133965.7155 -163542.76  22.1%     -    0s
H    0     0                    -136925.8173 -148187.54  8.22%     -    0s
     0     0 -148187.54    0  107 -136925.82 -148187.54  8.22%     -    0s
H    0     0                    -140741.1654 -148159.22  5.27%     -    0s
     0     0 -147889.02    0  108 -140741.17 -147889.02  5.08%     -    0s
     0     0 -147888.77    0  106 -140741.17 -147888.77  5.08%     -    0s
H    0     0                    -143060.8295 -147277.39  2.95%     -    0s
     0     0 -147277.39    0   84 -143060.83 -147277.39  2.95%     -    0s
H    0     0                    -144592.4715 -147270.75  1.85%     -    0s
H    0     0                    -146142.3714 -147270.75  0.77%     -    0s
     0     0 -147168.37    0   87 -146142.37 -147168.37  0.70%     -    0s
     0     0 -147166.72    0   87 -146142.37 -147166.72  0.70%     -    0s
     0     2 -147166.62    0   87 -146142.37 -147166.62  0.70%     -    0s
H   36    37                    -146144.9062 -146813.86  0.46%  16.3    0s
H   41    37                    -146269.2333 -146806.47  0.37%  15.0    0s
H  244    72                    -146278.6332 -146709.01  0.29%   8.1    0s
* 1220    22              43    -146281.1680 -146474.12  0.13%   4.8    0s

Cutting planes:
  Gomory: 61
  Implied bound: 1
  MIR: 154
  RLT: 32

Explored 1294 nodes (6741 simplex iterations) in 0.21 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -146281 -146279 -146269 ... -131874
No other solutions better than -146281

Optimal solution found (tolerance 1.00e-04)
Best objective -1.462811680496e+05, best bound -1.462811680496e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 210630.95
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146281.17
  [DEBUG]   S×d_nominal = 356912.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 356912.12 + -146281.17 = 210630.95
  [DEBUG]   Current θ from Master = 225353.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14722.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 46298.30
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 3428.7008, Absolute Gap = 3428.7008, Relative Gap = 0.056189
  Not converged yet (gap = 3428.70 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308199 nonzeros
Model fingerprint: 0xdbd72a09
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47409 rows and 19249 columns
Presolve time: 2.04s
Presolved: 61004 rows, 26691 columns, 379304 nonzeros
Variable types: 24432 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -196616.4025

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 61004 rows, 26691 columns, 379304 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23837   -9.6817792e+04   0.000000e+00   1.335864e+08      5s
   37468   -1.9750702e+02   0.000000e+00   3.232280e+07     10s
   49728    3.5297664e+04   0.000000e+00   2.829767e+06     15s
   57996    3.9655096e+04   0.000000e+00   1.898357e+07     20s
   64059    4.9076842e+04   0.000000e+00   1.203228e+08     25s
Concurrent spin time: 5.81s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 9.920276e+04, 60802 iterations, 30.35 seconds (40.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99202.7573    0   79 -196616.40 99202.7573   150%     -   33s
H    0     0                    -189907.1801 99202.7573   152%     -   33s
H    0     0                    -174905.0379 99202.7573   157%     -   33s
H    0     0                    -128479.8416 99202.7573   177%     -   33s
H    0     0                    -118846.5883 99202.7573   183%     -   33s
H    0     0                    -46042.36439 99202.7573   315%     -   33s
H    0     0                    -4692.036357 99202.7573  2214%     -   33s
H    0     0                    2843.6557203 99202.7573  3389%     -   33s
H    0     0                    21004.010922 99202.7573   372%     -   34s
H    0     0                    30092.593935 99202.7573   230%     -   34s
H    0     0                    38022.933001 99202.7573   161%     -   34s
H    0     0                    40184.767805 99202.7573   147%     -   34s
H    0     0                    44480.203170 99202.7573   123%     -   34s
H    0     0                    44490.248564 94070.6767   111%     -   50s
H    0     0                    44709.391429 94070.6767   110%     -   50s
H    0     0                    44766.202567 94070.6767   110%     -   50s
H    0     0                    44790.391403 94070.6767   110%     -   50s
H    0     0                    46439.913021 94070.6767   103%     -   50s
H    0     0                    48043.014526 94070.6767  95.8%     -   50s
H    0     0                    49073.811658 94070.6767  91.7%     -   50s
     0     0 94010.7326    0  142 49073.8117 94010.7326  91.6%     -   50s
H    0     0                    49233.649935 92517.3369  87.9%     -   59s
H    0     0                    49236.741171 92517.3369  87.9%     -   59s
     0     0 92250.0147    0  188 49236.7412 92250.0147  87.4%     -   59s
     0     0 92249.9244    0  193 49236.7412 92249.9244  87.4%     -   63s
     0     0 92249.9244    0  170 49236.7412 92249.9244  87.4%     -   64s
     0     0 92249.9244    0  169 49236.7412 92249.9244  87.4%     -   65s
     0     0 92249.8613    0  171 49236.7412 92249.8613  87.4%     -   65s
     0     0 89761.7176    0  206 49236.7412 89761.7176  82.3%     -   76s
H    0     0                    53717.361677 89761.7176  67.1%     -   77s
     0     0 89157.9018    0  232 53717.3617 89157.9018  66.0%     -   83s
     0     0 88875.2919    0  257 53717.3617 88875.2919  65.4%     -   90s
     0     0 88783.4821    0  257 53717.3617 88783.4821  65.3%     -   93s
     0     0 88747.8822    0  261 53717.3617 88747.8822  65.2%     -   94s
     0     0 88660.1139    0  254 53717.3617 88660.1139  65.0%     -   96s
     0     0 88647.1445    0  252 53717.3617 88647.1445  65.0%     -   97s
     0     0 88631.9945    0  265 53717.3617 88631.9945  65.0%     -   98s
     0     0 88614.4938    0  253 53717.3617 88614.4938  65.0%     -   99s
     0     0 88613.1775    0  257 53717.3617 88613.1775  65.0%     -  100s
     0     0 88613.1443    0  263 53717.3617 88613.1443  65.0%     -  100s
H    0     0                    56338.111045 87270.4407  54.9%     -  120s
H    0     0                    56361.504290 87270.4407  54.8%     -  120s
     0     0 87270.4407    0  340 56361.5043 87270.4407  54.8%     -  120s
H    0     0                    56412.098769 87270.2333  54.7%     -  121s
     0     0 86965.8596    0  353 56412.0988 86965.8596  54.2%     -  126s
     0     0 86787.2804    0  353 56412.0988 86787.2804  53.8%     -  131s
     0     0 86646.6711    0  358 56412.0988 86646.6711  53.6%     -  136s
     0     0 86605.8730    0  356 56412.0988 86605.8730  53.5%     -  138s
     0     0 86581.9782    0  354 56412.0988 86581.9782  53.5%     -  140s
     0     0 86507.7334    0  347 56412.0988 86507.7334  53.3%     -  142s
     0     0 86486.4980    0  353 56412.0988 86486.4980  53.3%     -  144s
     0     0 86472.7346    0  352 56412.0988 86472.7346  53.3%     -  144s
     0     0 86466.5353    0  354 56412.0988 86466.5353  53.3%     -  145s
     0     0 86460.1555    0  360 56412.0988 86460.1555  53.3%     -  146s
     0     0 86407.0187    0  359 56412.0988 86407.0187  53.2%     -  148s
     0     0 86400.8784    0  353 56412.0988 86400.8784  53.2%     -  148s
     0     0 86395.1741    0  353 56412.0988 86395.1741  53.2%     -  149s
     0     0 86392.7954    0  348 56412.0988 86392.7954  53.1%     -  150s
     0     0 86391.7318    0  348 56412.0988 86391.7318  53.1%     -  150s
     0     0 85855.9128    0  372 56412.0988 85855.9128  52.2%     -  165s
     0     0 85651.4756    0  340 56412.0988 85651.4756  51.8%     -  171s
H    0     0                    56509.899933 85525.2803  51.3%     -  176s
H    0     0                    56519.945326 85525.2803  51.3%     -  176s
     0     0 85525.2803    0  348 56519.9453 85525.2803  51.3%     -  176s
     0     0 85507.0186    0  343 56519.9453 85507.0186  51.3%     -  179s
     0     0 85500.0146    0  343 56519.9453 85500.0146  51.3%     -  181s
     0     0 85495.0984    0  339 56519.9453 85495.0984  51.3%     -  181s
     0     0 85490.7710    0  335 56519.9453 85490.7710  51.3%     -  182s
     0     0 85487.3877    0  342 56519.9453 85487.3877  51.3%     -  182s
     0     0 85487.1523    0  341 56519.9453 85487.1523  51.3%     -  183s
     0     0 85422.5117    0  343 56519.9453 85422.5117  51.1%     -  186s
H    0     0                    56520.577622 85421.1736  51.1%     -  187s
H    0     0                    56618.511910 85421.1736  50.9%     -  187s
H    0     0                    56628.557303 85421.1736  50.8%     -  187s
H    0     0                    56805.516271 85421.1736  50.4%     -  187s
     0     0 85413.2176    0  375 56805.5163 85413.2176  50.4%     -  188s
     0     0 85400.5923    0  348 56805.5163 85400.5923  50.3%     -  190s
     0     0 85397.5490    0  376 56805.5163 85397.5490  50.3%     -  191s
     0     0 85393.1314    0  351 56805.5163 85393.1314  50.3%     -  192s
     0     0 85391.1905    0  384 56805.5163 85391.1905  50.3%     -  193s
     0     0 85389.7927    0  385 56805.5163 85389.7927  50.3%     -  193s
     0     0 85347.7234    0  357 56805.5163 85347.7234  50.2%     -  196s
H    0     0                    56840.501195 85347.2552  50.2%     -  199s
     0     0 85322.7189    0  356 56840.5012 85322.7189  50.1%     -  201s
     0     0 85311.6580    0  397 56840.5012 85311.6580  50.1%     -  203s
     0     0 85309.2735    0  368 56840.5012 85309.2735  50.1%     -  204s
     0     0 85306.3748    0  366 56840.5012 85306.3748  50.1%     -  205s
     0     0 85304.9930    0  403 56840.5012 85304.9930  50.1%     -  205s
     0     0 85288.0807    0  387 56840.5012 85288.0807  50.0%     -  209s
     0     0 85258.3784    0  353 56840.5012 85258.3784  50.0%     -  211s
     0     0 85255.6124    0  352 56840.5012 85255.6124  50.0%     -  211s
     0     0 85254.0547    0  353 56840.5012 85254.0547  50.0%     -  212s
     0     0 85253.1384    0  351 56840.5012 85253.1384  50.0%     -  213s
     0     0 85252.2104    0  353 56840.5012 85252.2104  50.0%     -  215s
     0     0 85248.5939    0  354 56840.5012 85248.5939  50.0%     -  216s
     0     0 85245.2309    0  353 56840.5012 85245.2309  50.0%     -  217s
     0     0 85244.4966    0  366 56840.5012 85244.4966  50.0%     -  219s
     0     0 85243.2988    0  364 56840.5012 85243.2988  50.0%     -  224s
     0     0 85238.1237    0  359 56840.5012 85238.1237  50.0%     -  225s
     0     0 85237.8979    0  359 56840.5012 85237.8979  50.0%     -  226s
H    0     0                    57725.312253 85232.9904  47.7%     -  252s
H    0     0                    58031.204977 85232.9904  46.9%     -  252s
H    0     0                    58190.278410 85232.9904  46.5%     -  252s
H    0     0                    58229.858527 85232.9904  46.4%     -  252s
     0     2 85232.9904    0  359 58229.8585 85232.9904  46.4%     -  280s
     1     4 85197.6200    1  396 58229.8585 85232.9904  46.4%  1954  288s
     3     7 85098.1146    2  398 58229.8585 85197.5789  46.3%  4457  304s
     6    14 85036.7688    3  400 58229.8585 85098.0768  46.1%  6638  317s
    13    28 84963.9028    4  396 58229.8585 85036.3505  46.0%  7115  337s
    27    44 84580.2028    5  380 58229.8585 84963.6716  45.9% 11685  373s
    43    76 82611.2149    6  327 58229.8585 84963.6716  45.9% 11773  394s
    75   132 82450.7095    7  311 58229.8585 84963.6716  45.9%  8905  418s
   131   164 81506.0490   10  314 58229.8585 84963.6716  45.9%  6130  432s
   163   200 81418.1740   11  306 58229.8585 84963.6716  45.9%  5572  451s
   199   236 79593.8763   12  277 58229.8585 84963.6716  45.9%  5172  471s
   235   269 79363.7548   13  278 58229.8585 84963.6716  45.9%  5035  484s
   268   313 76568.3886   14  264 58229.8585 84963.6716  45.9%  5023  502s
H  269   313                    58486.491082 84963.6716  45.3%  5004  502s
H  289   313                    58653.548759 84963.6716  44.9%  4876  502s
   312   446 76477.1156   15  266 58653.5488 84963.6716  44.9%  4706  523s
   445   563 76059.0720   20  245 58653.5488 84963.6716  44.9%  3946  537s
   562   678 75191.6179   25  219 58653.5488 84963.6716  44.9%  3460  549s
   677   787 74718.1615   30  188 58653.5488 84963.6716  44.9%  3116  562s
   786   874 71561.2866   35  168 58653.5488 84963.6716  44.9%  2868  572s
   881  1000 71545.5533   36  172 58653.5488 84963.6716  44.9%  2713  583s
  1013  1099 68159.4228   42  153 58653.5488 84963.6716  44.9%  2493  596s
  1140  1195 62194.4969   47  156 58653.5488 84963.6716  44.9%  2330  610s
  1276  1297 61425.8371   52  117 58653.5488 84963.6716  44.9%  2190  622s
  1424  1312 60597.7567   58  100 58653.5488 84963.6716  44.9%  2071  638s
  1467  1347 74555.5193   13  297 58653.5488 84963.6716  44.9%  2076  653s
  1511  1404 73975.8690   14  266 58653.5488 84963.6716  44.9%  2108  667s
  1587  1482 73292.7106   17  249 58653.5488 84963.6716  44.9%  2099  681s
  1694  1539 72503.2055   22  217 58653.5488 84701.4551  44.4%  2054  696s
  1785  1580 71459.9204   27  200 58653.5488 84701.4551  44.4%  2052  713s
  1868  1604 65473.7883   29  165 58653.5488 84701.4551  44.4%  2082  730s
H 1902  1604                    59543.457384 84701.4551  42.3%  2117  730s
  1906  1665 64946.6186   30  168 59543.4574 84701.4551  42.3%  2122  750s
  1969  1737 64106.3765   37  156 59543.4574 84701.4551  42.3%  2164  768s
  2043  1816 63005.5740   44  151 59543.4574 84701.4551  42.3%  2201  786s
  2126  1918 62936.6016   45  139 59543.4574 83498.6891  40.2%  2212  804s
  2258  2051 62897.7642   46  137 59543.4574 83498.6891  40.2%  2188  823s
  2415  2223 61559.0985   54  124 59543.4574 83346.7250  40.0%  2137  841s
  2620  2383 63916.9686   59  190 59543.4574 83346.7250  40.0%  2065  858s
  2843  2500 62360.3354   67  153 59543.4574 83346.7250  40.0%  1995  880s
  3033  2581 60118.7589   79  135 59543.4574 83346.7250  40.0%  1973  900s
  3154  2727     cutoff   80      59543.4574 83346.7250  40.0%  1969  924s
  3342  2867     cutoff   79      59543.4574 83346.7250  40.0%  1942  946s
H 3538  2854                    59906.651640 83346.7250  39.1%  1929 1028s
H 3538  2852                    59938.864910 83346.7250  39.1%  1929 1065s
H 3538  2847                    60032.867080 83346.7250  38.8%  1929 1075s
H 3538  2846                    60063.027052 83346.7250  38.8%  1929 1077s
H 3538  2846                    60066.239880 83346.7250  38.8%  1929 1080s
  3539  2847 60340.9464   42  359 60066.2399 83346.7250  38.8%  1929 1142s
  3541  2848 76571.8003   15   79 60066.2399 83346.7250  38.8%  1928 1175s
  3542  2849 73497.6839   15  212 60066.2399 83346.7250  38.8%  1927 1196s
  3543  2850 80999.3418   10  307 60066.2399 83346.7250  38.8%  1927 1210s
  3544  2850 82043.0090    6  347 60066.2399 83346.7250  38.8%  1926 1222s
  3545  2851 66232.5538   31  350 60066.2399 83346.7250  38.8%  1926 1231s
  3546  2852 76502.3791    9  375 60066.2399 83346.7250  38.8%  1925 1238s
  3547  2852 65163.1040   17  369 60066.2399 83346.7250  38.8%  1924 1245s
  3548  2853 68362.3492   39  372 60066.2399 83346.7250  38.8%  1924 1252s
  3549  2854 77728.2366   18  385 60066.2399 83346.7250  38.8%  1923 1257s
  3550  2854 67561.4224   22  393 60066.2399 83346.7250  38.8%  1923 1260s
  3551  2855 74812.2973   46  360 60066.2399 83346.7250  38.8%  1922 1265s
  3553  2856 81371.6461   12  388 60066.2399 83346.7250  38.8%  1921 1270s
  3555  2858 80925.6692   17  359 60066.2399 83346.7250  38.8%  1920 1278s
  3556  2858 64810.9560   20  358 60066.2399 83346.7250  38.8%  1920 1281s
  3558  2860 63754.1186   41  361 60066.2399 83346.7250  38.8%  1918 1288s
  3559  2860 79320.6470   14  360 60066.2399 83346.7250  38.8%  1918 1290s
  3560  2861 71899.1866   17  363 60066.2399 83346.7250  38.8%  1917 1295s
  3562  2862 61596.3736   44  370 60066.2399 83346.7250  38.8%  1916 1306s
  3564  2864 64884.8699   41  371 60066.2399 83346.7250  38.8%  1915 1311s
  3565  2864 77126.2591   13  369 60066.2399 83346.7250  38.8%  1915 1321s
H 3565  2720                    60107.678513 83346.7250  38.7%  1915 1321s
  3567  2722 78804.4251    7  381 60107.6785 83346.7250  38.7%  1914 1327s
  3569  2723 73275.0266   31  386 60107.6785 83346.7250  38.7%  1913 1336s
  3571  2724 65333.2710   36  401 60107.6785 83346.7250  38.7%  1912 1341s
  3572  2725 77869.1147   13  376 60107.6785 83346.7250  38.7%  1911 1345s
  3574  2726 69314.3999   24  378 60107.6785 83346.7250  38.7%  1910 1350s
  3575  2727 75051.6465   16  378 60107.6785 83346.7250  38.7%  1909 1382s
  3576  2728 74494.7222   19  378 60107.6785 83346.7250  38.7%  1909 1421s
  3577  2731 83346.7250   15  362 60107.6785 83346.7250  38.7%  1952 1514s
  3579  2735 83346.7250   16  354 60107.6785 83346.7250  38.7%  1956 1545s
  3583  2741 83346.7250   17  369 60107.6785 83346.7250  38.7%  1965 1604s
  3591  2755 83346.7250   18  367 60107.6785 83346.7250  38.7%  1991 1633s
  3607  2775 82940.4297   19  391 60107.6785 83346.7250  38.7%  2065 1694s
H 3632  2630                    60167.626588 83346.7250  38.5%  2167 1694s
  3633  2662 80828.7215   20  347 60167.6266 83346.7250  38.5%  2176 1736s
  3665  2752 80280.1700   21  377 60167.6266 83346.7250  38.5%  2284 1780s
  3766  2798 78756.4557   23  352 60167.6266 83346.7250  38.5%  2430 1813s
  3846  2803 77806.6611   24  324 60167.6266 83346.7250  38.5%  2480 1834s
  3877  2824 78186.5211   22  358 60167.6266 83346.7250  38.5%  2506 1855s
  3909  2848 74974.4754   23  308 60167.6266 83346.7250  38.5%  2530 1877s
  3943  2866 76879.9878   25  312 60167.6266 83346.7250  38.5%  2559 1894s
  3977  2893 76422.4475   25  330 60167.6266 83346.7250  38.5%  2581 1913s
  4015  2929 76316.3775   25  305 60167.6266 83346.7250  38.5%  2602 1935s
  4072  2967 75981.5810   25  309 60167.6266 83346.7250  38.5%  2617 1954s
  4132  2998 75518.4959   26  286 60167.6266 83346.7250  38.5%  2622 1973s
  4203  3025 73350.0926   27  264 60167.6266 83346.7250  38.5%  2632 2003s
  4280  3061 73012.6961   27  295 60167.6266 83346.7250  38.5%  2637 2034s
  4367  3066 73044.5396   28  299 60167.6266 83346.7250  38.5%  2642 2057s
  4451  3070 72439.7659   30  296 60167.6266 83251.8058  38.4%  2649 2088s
  4527  3085 71031.4717   32  261 60167.6266 83249.2666  38.4%  2666 2111s
  4602  3118 69553.7287   33  226 60167.6266 83249.2666  38.4%  2680 2137s
  4678  3145 64673.9758   33  170 60167.6266 82043.7244  36.4%  2700 2160s
  4777  3173 68288.2155   35  204 60167.6266 82043.7244  36.4%  2710 2187s
  4872  3194 67334.6110   36  208 60167.6266 81872.3073  36.1%  2718 2215s
  4977  3202 66910.6232   37  203 60167.6266 81872.3073  36.1%  2726 2247s
  5082  3252 64451.4178   37  146 60167.6266 81872.3073  36.1%  2739 2273s
  5197  3297 64081.4922   38  187 60167.6266 81872.3073  36.1%  2739 2303s
  5340  3344 63882.6247   44  186 60167.6266 81486.6602  35.4%  2733 2331s
  5516  3360 63255.7909   46  153 60167.6266 81377.0702  35.3%  2712 2359s
  5694  3382 infeasible   51      60167.6266 81377.0702  35.3%  2696 2391s
  5859  3388 60512.4825   58  127 60167.6266 81377.0702  35.3%  2695 2424s
  6026  3415 60295.0282   71   81 60167.6266 79681.6189  32.4%  2687 2458s
  6197  3452 74709.2980   24  322 60167.6266 79681.6189  32.4%  2689 2493s
  6343  3505 70676.1847   26  296 60167.6266 79681.6189  32.4%  2706 2526s
  6472  3513 63072.2220   31  212 60167.6266 79681.6189  32.4%  2733 2554s
  6561  3568 60973.8638   35  199 60167.6266 79681.6189  32.4%  2743 2589s
  6733  3595 75674.8689   23  281 60167.6266 79164.8163  31.6%  2753 2625s
  6883  3649 72507.5039   26  284 60167.6266 79164.8163  31.6%  2782 2663s
  7025  3717 68794.7727   31  198 60167.6266 78758.0307  30.9%  2806 2699s
  7204  3755 64594.5979   36  164 60167.6266 78758.0307  30.9%  2820 2738s
  7452  3762 60723.0420   49  124 60167.6266 78554.3938  30.6%  2812 2782s
  7703  3758 69338.1034   26  319 60167.6266 78475.6386  30.4%  2809 2823s
  7863  3809 66103.2987   28  255 60167.6266 77866.5260  29.4%  2819 2861s
  8034  3893 62072.4891   32  242 60167.6266 77828.6144  29.4%  2834 2907s
  8262  3977 74615.6381   23  402 60167.6266 77828.6144  29.4%  2842 2957s
  8570  4034 68531.5809   25  348 60167.6266 77800.7009  29.3%  2829 3009s
  8849  3971 63008.4007   31  188 60167.6266 77800.7009  29.3%  2829 3048s
  8883  3989 62626.7661   32  165 60167.6266 77800.7009  29.3%  2838 3081s
  8918  3997 62268.5491   33  167 60167.6266 77800.7009  29.3%  2845 3116s
  8962  4008 60718.9641   34  167 60167.6266 77800.7009  29.3%  2851 3158s
  9012  4055 65069.7359   35  194 60167.6266 77800.7009  29.3%  2854 3204s
  9152  4100     cutoff   39      60167.6266 77800.7009  29.3%  2844 3253s
  9371  4156 67926.8934   26  298 60167.6266 77800.7009  29.3%  2845 3313s
  9652  4196 60677.6619   30  206 60167.6266 77344.1417  28.5%  2859 3364s
H 9780  4020                    60278.050624 77344.1417  28.3%  2863 3364s
  9879  4143 71409.0308   24  226 60278.0506 77344.1417  28.3%  2861 3429s
 10265  4183 61243.7314   33  183 60278.0506 77143.6538  28.0%  2864 3494s
 10568  4273 68141.7735   26  372 60278.0506 77094.8231  27.9%  2895 3560s
 10930  4225 63709.9023   29  281 60278.0506 76711.7517  27.3%  2918 3600s

Cutting planes:
  Learned: 2
  MIR: 1012
  Mixing: 3
  Flow cover: 1621
  RLT: 19
  Relax-and-lift: 107

Explored 11199 nodes (32860914 simplex iterations) in 3600.04 seconds (6467.42 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 60278.1 60167.6 60107.7 ... 58653.5

Time limit reached
Best objective 6.027805062432e+04, best bound 7.671175173867e+04, gap 27.2632%
  WARNING: Time limit reached. Using best solution found (gap: 27.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 60278.05, θ = 234705.59
  Upper Bound (UB) = 60278.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 234705.59
  [DEBUG]   ✓ Scenario 0: θ = 234705.59 ≤ Q = 234705.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 234705.59 ≤ Q = 234705.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 234705.59 ≤ Q = 234705.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 234705.59 ≤ Q = 234705.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 234705.59 ≤ Q = 234705.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 234705.59 ≤ Q = 234705.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 234705.59 ≤ Q = 234705.59 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5fd12e72
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa02ed18e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.242227e+13
Presolve removed 2579 rows and 1868 columns
Presolve time: 0.01s
Presolved: 514 rows, 521 columns, 1456 nonzeros
Found heuristic solution: objective 5900239.1832
Variable types: 355 continuous, 166 integer (166 binary)

Root relaxation: objective -1.711983e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171198.29    0  131 5900239.18 -171198.29   103%     -    0s
H    0     0                    -136107.4006 -171198.29  25.8%     -    0s
H    0     0                    -137112.5719 -171198.29  24.9%     -    0s
H    0     0                    -137354.6684 -171198.29  24.6%     -    0s
H    0     0                    -148509.9528 -171198.29  15.3%     -    0s
     0     0 -156482.47    0   66 -148509.95 -156482.47  5.37%     -    0s
H    0     0                    -154614.3078 -156399.07  1.15%     -    0s
H    0     0                    -154893.8416 -156399.07  0.97%     -    0s
     0     0 -155956.88    0   64 -154893.84 -155956.88  0.69%     -    0s
     0     0 -155218.02    0   23 -154893.84 -155218.02  0.21%     -    0s
     0     0 -155212.28    0   16 -154893.84 -155212.28  0.21%     -    0s
H    0     0                    -154945.6357 -155211.65  0.17%     -    0s
H    0     0                    -155190.4090 -155211.65  0.01%     -    0s
     0     0 -155211.65    0    8 -155190.41 -155211.65  0.01%     -    0s
     0     0 -155208.40    0    5 -155190.41 -155208.40  0.01%     -    0s
H    0     0                    -155191.9835 -155208.40  0.01%     -    0s

Cutting planes:
  Gomory: 29
  Implied bound: 6
  MIR: 107
  Flow cover: 5
  RLT: 69
  Relax-and-lift: 4
  BQP: 3

Explored 1 nodes (552 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -155192 -155190 -154946 ... 5.90024e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.551919834935e+05, best bound -1.552029602060e+05, gap 0.0071%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 219479.26
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -155191.98
  [DEBUG]   S×d_nominal = 374671.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374671.25 + -155191.98 = 219479.26
  [DEBUG]   Current θ from Master = 234705.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15226.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45051.72
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 2685.9434, Absolute Gap = 2685.9434, Relative Gap = 0.044559
  Not converged yet (gap = 2685.94 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351439 nonzeros
Model fingerprint: 0x63b3b01c
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54196 rows and 22006 columns
Presolve time: 2.12s
Presolved: 69507 rows, 30174 columns, 432659 nonzeros
Variable types: 27915 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -196616.4025

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 69507 rows, 30174 columns, 432659 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27095   -1.6548747e+05   0.000000e+00   5.233855e+09      5s
   41396    1.8442433e+04   0.000000e+00   1.125952e+07     10s
   51323    3.3809011e+04   0.000000e+00   3.805640e+06     15s
   59208    4.2175542e+04   0.000000e+00   3.060246e+07     20s
   63545    4.2565500e+04   0.000000e+00   7.747538e+06     25s
   69896    5.9459455e+04   0.000000e+00   1.940375e+09     30s
   77691    6.5202008e+04   0.000000e+00   5.462673e+06     35s
Concurrent spin time: 5.63s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 9.920276e+04, 62165 iterations, 41.35 seconds (55.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99202.7573    0   79 -196616.40 99202.7573   150%     -   44s
H    0     0                    -187402.3623 99202.7573   153%     -   44s
H    0     0                    -159527.0839 99202.7573   162%     -   44s
H    0     0                    -154369.1996 99202.7573   164%     -   44s
H    0     0                    -149146.0317 99202.7573   167%     -   44s
H    0     0                    -140345.5345 99202.7573   171%     -   44s
H    0     0                    -140325.7427 99202.7573   171%     -   44s
H    0     0                    -46042.36439 99202.7573   315%     -   44s
H    0     0                    2454.8592834 99202.7573  3941%     -   45s
H    0     0                    29081.608476 99202.7573   241%     -   45s
H    0     0                    29806.895202 99202.7573   233%     -   46s
H    0     0                    35725.295230 99202.7573   178%     -   46s
H    0     0                    43593.769093 99202.7573   128%     -   46s
H    0     0                    43911.958765 99202.7573   126%     -   46s
H    0     0                    43921.488789 99202.7573   126%     -   46s
H    0     0                    44435.958691 99202.7573   123%     -   46s
H    0     0                    44480.203170 99202.7573   123%     -   46s
H    0     0                    47489.599444 99202.7573   109%     -   47s
H    0     0                    47569.602539 99202.7573   109%     -   47s
H    0     0                    48152.903290 99202.7573   106%     -   47s
     0     0 93834.1237    0  182 48152.9033 93834.1237  94.9%     -   67s
H    0     0                    48854.817705 93834.1237  92.1%     -   67s
H    0     0                    49506.446285 93834.1237  89.5%     -   67s
H    0     0                    49699.713954 93834.1237  88.8%     -   68s
H    0     0                    50513.909569 93834.1237  85.8%     -   68s
     0     0 92747.2133    0  192 50513.9096 92747.2133  83.6%     -   78s
     0     0 92310.7925    0  183 50513.9096 92310.7925  82.7%     -   85s
     0     0 92310.7925    0  184 50513.9096 92310.7925  82.7%     -   87s
     0     0 92310.7925    0  184 50513.9096 92310.7925  82.7%     -   88s
     0     0 92310.7925    0  185 50513.9096 92310.7925  82.7%     -   88s
     0     0 92310.7925    0  185 50513.9096 92310.7925  82.7%     -   89s
     0     0 92310.7925    0  185 50513.9096 92310.7925  82.7%     -   89s
     0     0 89677.0798    0  212 50513.9096 89677.0798  77.5%     -  106s
H    0     0                    54931.833136 89677.0798  63.3%     -  106s
     0     0 88837.4355    0  286 54931.8331 88837.4355  61.7%     -  122s
     0     0 88552.3110    0  250 54931.8331 88552.3110  61.2%     -  129s
     0     0 88386.4037    0  280 54931.8331 88386.4037  60.9%     -  138s
     0     0 88233.9296    0  298 54931.8331 88233.9296  60.6%     -  144s
     0     0 88206.8236    0  296 54931.8331 88206.8236  60.6%     -  146s
     0     0 88174.2534    0  291 54931.8331 88174.2534  60.5%     -  148s
     0     0 88161.2880    0  293 54931.8331 88161.2880  60.5%     -  149s
     0     0 88134.7602    0  302 54931.8331 88134.7602  60.4%     -  152s
     0     0 88131.3483    0  298 54931.8331 88131.3483  60.4%     -  152s
     0     0 88129.5289    0  306 54931.8331 88129.5289  60.4%     -  153s
     0     0 88127.6470    0  303 54931.8331 88127.6470  60.4%     -  153s
     0     0 88127.1260    0  299 54931.8331 88127.1260  60.4%     -  154s
     0     0 86773.8431    0  356 54931.8331 86773.8431  58.0%     -  180s
H    0     0                    55114.133243 86773.7658  57.4%     -  181s
     0     0 86512.8541    0  352 55114.1332 86512.8541  57.0%     -  190s
     0     0 86448.7023    0  361 55114.1332 86448.7023  56.9%     -  193s
     0     0 86415.4436    0  372 55114.1332 86415.4436  56.8%     -  195s
     0     0 86368.7117    0  363 55114.1332 86368.7117  56.7%     -  197s
     0     0 86328.4440    0  361 55114.1332 86328.4440  56.6%     -  199s
     0     0 86323.0720    0  363 55114.1332 86323.0720  56.6%     -  200s
     0     0 86320.3556    0  364 55114.1332 86320.3556  56.6%     -  201s
     0     0 86319.0982    0  364 55114.1332 86319.0982  56.6%     -  201s
     0     0 85632.7221    0  336 55114.1332 85632.7221  55.4%     -  225s
     0     0 85549.8846    0  336 55114.1332 85549.8846  55.2%     -  232s
     0     0 85501.5420    0  344 55114.1332 85501.5420  55.1%     -  236s
     0     0 85476.3414    0  356 55114.1332 85476.3414  55.1%     -  239s
     0     0 85459.2938    0  353 55114.1332 85459.2938  55.1%     -  242s
     0     0 85439.7191    0  353 55114.1332 85439.7191  55.0%     -  243s
     0     0 85435.1614    0  354 55114.1332 85435.1614  55.0%     -  246s
     0     0 85431.0288    0  344 55114.1332 85431.0288  55.0%     -  248s
     0     0 85424.7416    0  351 55114.1332 85424.7416  55.0%     -  251s
     0     0 85421.9664    0  342 55114.1332 85421.9664  55.0%     -  252s
     0     0 85420.9254    0  389 55114.1332 85420.9254  55.0%     -  252s
     0     0 85324.6523    0  353 55114.1332 85324.6523  54.8%     -  259s
H    0     0                    55227.194046 85324.3099  54.5%     -  260s
H    0     0                    55267.449580 85324.3099  54.4%     -  260s
     0     0 85301.1350    0  353 55267.4496 85301.1350  54.3%     -  265s
     0     0 85296.7909    0  352 55267.4496 85296.7909  54.3%     -  267s
     0     0 85294.3982    0  355 55267.4496 85294.3982  54.3%     -  268s
     0     0 85293.8424    0  352 55267.4496 85293.8424  54.3%     -  268s
     0     0 85244.5469    0  378 55267.4496 85244.5469  54.2%     -  274s
H    0     0                    55346.413831 85243.8575  54.0%     -  279s
     0     0 85197.3967    0  400 55346.4138 85197.3967  53.9%     -  284s
     0     0 85188.5500    0  363 55346.4138 85188.5500  53.9%     -  286s
     0     0 85187.2301    0  362 55346.4138 85187.2301  53.9%     -  287s
     0     0 85173.9919    0  370 55346.4138 85173.9919  53.9%     -  290s
     0     0 85170.9944    0  400 55346.4138 85170.9944  53.9%     -  292s
     0     0 85164.6351    0  378 55346.4138 85164.6351  53.9%     -  293s
     0     0 85163.6021    0  408 55346.4138 85163.6021  53.9%     -  294s
     0     0 85156.1792    0  380 55346.4138 85156.1792  53.9%     -  297s
     0     0 85152.9068    0  362 55346.4138 85152.9068  53.9%     -  300s
     0     0 85151.9293    0  363 55346.4138 85151.9293  53.9%     -  301s
     0     0 85149.1361    0  413 55346.4138 85149.1361  53.8%     -  303s
     0     0 85148.7450    0  412 55346.4138 85148.7450  53.8%     -  304s
H    0     0                    55866.910378 85146.3746  52.4%     -  306s
     0     0 85146.3746    0  419 55866.9104 85146.3746  52.4%     -  306s
H    0     0                    56076.178440 85145.3574  51.8%     -  316s
H    0     0                    56240.774794 85145.3574  51.4%     -  317s
     0     0 85145.3574    0  420 56240.7748 85145.3574  51.4%     -  318s
     0     0 85145.3574    0  400 56240.7748 85145.3574  51.4%     -  319s
     0     0 85145.3574    0  400 56240.7748 85145.3574  51.4%     -  321s
H    0     0                    56308.571788 85144.8883  51.2%     -  375s
H    0     0                    56330.215694 85144.8883  51.2%     -  375s
H    0     0                    56364.792930 85144.8883  51.1%     -  384s
H    0     0                    57308.290258 85144.8883  48.6%     -  384s
H    0     2                    57479.336966 85144.8883  48.1%     -  386s
     0     2 85144.8883    0  400 57479.3370 85144.8883  48.1%     -  386s
     1     4 85096.3627    1  391 57479.3370 85138.1097  48.1%  3669  395s
     3     7 85068.0920    2  399 57479.3370 85096.3104  48.0%  4368  407s
     6    14 84960.1234    3  403 57479.3370 85068.0519  48.0%  5196  423s
    13    28 84818.9029    4  405 57479.3370 84959.2364  47.8%  6907  444s
    27    42 83894.5423    5  357 57479.3370 84818.6262  47.6% 13494  493s
    41    74 83241.2950    6  342 57479.3370 84818.6262  47.6% 12141  537s
H   44    74                    57571.150848 84818.6262  47.3% 11684  537s
H   48    74                    57719.495314 84818.6262  46.9% 11197  537s
H   50    74                    58243.279983 84818.6262  45.6% 11044  537s
    73   169 82755.9488    7  326 58243.2800 84504.5032  45.1% 10183  580s
   168   266 81884.2596   10  313 58243.2800 84499.8879  45.1%  6204  606s
H  171   266                    58689.994791 84499.8879  44.0%  6112  606s
   265   344 80237.4721   13  285 58689.9948 84499.8879  44.0%  5089  627s
   343   377 79447.6940   17  276 58689.9948 84499.8879  44.0%  4741  639s
H  350   377                    58726.476874 84499.8879  43.9%  4707  639s
H  362   377                    58912.627428 84499.8879  43.4%  4637  639s
   376   449 79155.3046   18  273 58912.6274 84499.8879  43.4%  4613  659s
   448   481 77171.0822   21  257 58912.6274 84499.8879  43.4%  4412  677s
   480   529 76054.1713   22  264 58912.6274 84499.8879  43.4%  4291  697s
   528   576 76021.4673   23  264 58912.6274 84499.8879  43.4%  4189  712s
H  554   576                    59388.015787 84499.8879  42.3%  4056  712s
   575   675 74280.2742   27  253 59388.0158 84499.8879  42.3%  4036  733s
   674   765 72030.7695   30  224 59388.0158 84499.8879  42.3%  3729  749s
   766   854 65605.9897   33  175 59388.0158 84499.8879  42.3%  3539  764s
   859   936 65384.0465   37  165 59388.0158 84499.8879  42.3%  3346  781s
   975  1011     cutoff   43      59388.0158 84499.8879  42.3%  3128  798s
  1076  1057     cutoff   45      59388.0158 84499.8879  42.3%  3006  817s
H 1082  1057                    59470.778620 84499.8879  42.1%  3003  817s
H 1097  1057                    59644.691800 84499.8879  41.7%  2990  817s
  1126  1137 61775.7445   46  133 59644.6918 84499.8879  41.7%  2970  834s
  1242  1181 60782.3645   54  122 59644.6918 84499.8879  41.7%  2881  855s
  1331  1246 80452.6597   12  347 59644.6918 84499.8879  41.7%  2858  875s
  1416  1295 77041.9090   13  277 59644.6918 84107.8807  41.0%  2852  899s
  1497  1345 74406.4484   14  278 59644.6918 84107.8807  41.0%  2862  922s
H 1501  1345                    60063.027052 84107.8807  40.0%  2864  922s
  1563  1393 73907.7416   15  271 60063.0271 84107.8807  40.0%  2883  944s
  1639  1447 72507.2287   17  290 60063.0271 84107.8807  40.0%  2907  970s
  1717  1512 66341.0669   20  263 60063.0271 83966.8283  39.8%  2933  993s
  1788  1603 65839.8036   21  251 60063.0271 83966.8283  39.8%  2950 1020s
  1887  1695 65182.6401   25  233 60063.0271 83966.8283  39.8%  2952 1044s
  2003  1725 64766.9226   32  207 60063.0271 83966.8283  39.8%  2933 1062s
  2037  1760     cutoff   33      60063.0271 83966.8283  39.8%  2948 1088s
  2076  1796 64383.3126   34  224 60063.0271 83966.8283  39.8%  2977 1110s
  2116  1838 64137.5467   35  229 60063.0271 83966.8283  39.8%  2984 1129s
  2168  1862 63394.7964   36  219 60063.0271 83946.2749  39.8%  2990 1150s
  2208  1890 63096.1384   37  217 60063.0271 83946.2749  39.8%  2985 1176s
  2260  1941 63008.2339   38  186 60063.0271 83827.6909  39.6%  2979 1198s
  2319  1990 61955.7956   39  214 60063.0271 83827.6909  39.6%  2984 1222s
  2380  2061 61886.6264   40  215 60063.0271 83827.6909  39.6%  2995 1241s
  2457  2151 61872.5351   41  210 60063.0271 83827.6909  39.6%  2979 1266s
  2575  2192 61446.5519   42  212 60063.0271 83827.6909  39.6%  2925 1291s
  2632  2290 61214.7014   43  188 60063.0271 83827.6909  39.6%  2922 1316s
  2768  2400 61046.9943   44  188 60063.0271 83554.9795  39.1%  2869 1343s
  2904  2490 60836.4976   45  189 60063.0271 83554.9795  39.1%  2834 1372s
  3066  2564     cutoff   46      60063.0271 83554.9795  39.1%  2783 1406s
  3204  2670 81569.4948    8  323 60063.0271 83513.3993  39.0%  2797 1438s
  3340  2815 80353.0383    9  289 60063.0271 83513.3993  39.0%  2813 1475s
  3514  2816 72305.5104   28  400 60063.0271 83513.3993  39.0%  2808 1725s
  3516  2817 71149.0944   25   79 60063.0271 83513.3993  39.0%  2806 1774s
  3517  2818 65813.9890   27  234 60063.0271 83513.3993  39.0%  2805 1806s
  3518  2819 72494.4700   28  327 60063.0271 83513.3993  39.0%  2805 1832s
  3519  2819 73224.5354   19  366 60063.0271 83513.3993  39.0%  2804 1851s
  3520  2820 67910.1490   20  364 60063.0271 83513.3993  39.0%  2803 1866s
  3521  2821 66115.5036   37  380 60063.0271 83513.3993  39.0%  2802 1878s
  3522  2821 67661.6608   39  397 60063.0271 83513.3993  39.0%  2801 1886s
  3523  2822 71528.1591   21  393 60063.0271 83513.3993  39.0%  2801 1895s
  3524  2823 77349.4134   12  397 60063.0271 83513.3993  39.0%  2800 1902s
  3525  2823 64610.2388   24  401 60063.0271 83513.3993  39.0%  2799 1908s
  3526  2824 68081.7021   43  398 60063.0271 83513.3993  39.0%  2798 1911s
  3527  2825 61161.3329   33  400 60063.0271 83513.3993  39.0%  2797 1916s
  3528  2825 72125.4126   36  366 60063.0271 83513.3993  39.0%  2797 1925s
  3529  2826 62093.2401   70  376 60063.0271 83513.3993  39.0%  2796 1930s
  3530  2827 80386.0033   16  373 60063.0271 83513.3993  39.0%  2795 1935s
  3531  2827 65283.5080   27  381 60063.0271 83513.3993  39.0%  2794 1943s
  3532  2828 61793.3929   60  379 60063.0271 83513.3993  39.0%  2793 1946s
  3534  2829 62655.9032   27  379 60063.0271 83513.3993  39.0%  2792 1960s
  3535  2830 77130.4889   12  385 60063.0271 83513.3993  39.0%  2791 1966s
  3537  2831 62004.2200   51  373 60063.0271 83513.3993  39.0%  2790 1973s
  3538  2832 71427.7826   22  380 60063.0271 83513.3993  39.0%  2789 1980s
  3540  2833 73667.2363   24  382 60063.0271 83513.3993  39.0%  2787 1989s
  3541  2834 64062.1385   36  376 60063.0271 83513.3993  39.0%  2786 1993s
  3542  2835 74899.7447   23  367 60063.0271 83513.3993  39.0%  2786 1997s
  3543  2835 66435.2648   27  384 60063.0271 83513.3993  39.0%  2785 2000s
  3545  2837 74858.5339   18  382 60063.0271 83513.3993  39.0%  2783 2006s
  3546  2837 77228.0598   16  380 60063.0271 83513.3993  39.0%  2782 2011s
  3548  2839 76238.3744   16  385 60063.0271 83513.3993  39.0%  2781 2017s
  3549  2839 73002.9399   23  385 60063.0271 83513.3993  39.0%  2780 2068s
  3550  2840 69056.1340   48  385 60063.0271 83513.3993  39.0%  2779 2110s
  3551  2844 83513.3993   15  368 60063.0271 83513.3993  39.0%  2843 2172s
  3553  2847 83513.3993   16  367 60063.0271 83513.3993  39.0%  2847 2204s
  3557  2854 83513.3993   17  370 60063.0271 83513.3993  39.0%  2853 2254s
  3562  2852 82883.4258   17  358 60063.0271 83513.3993  39.0%  2863 2255s
  3565  2867 83513.3993   18  371 60063.0271 83513.3993  39.0%  2874 2302s
  3581  2879 80080.6918   19  356 60063.0271 83513.3993  39.0%  2961 2371s
  3598  2905 80386.2656   20  352 60063.0271 83513.3993  39.0%  3002 2433s
  3630  3017 80154.3438   21  362 60063.0271 83513.3993  39.0%  3090 2492s
  3753  3049 77629.0708   23  341 60063.0271 83513.3993  39.0%  3274 2528s
  3826  3093 78217.5613   24  328 60063.0271 83513.3993  39.0%  3324 2557s
  3895  3138 77975.6714   23  337 60063.0271 83513.3993  39.0%  3359 2584s
  3972  3166 76008.7884   24  319 60063.0271 83513.3993  39.0%  3380 2612s
  4047  3197 76053.3405   24  336 60063.0271 83513.3993  39.0%  3394 2637s
  4121  3230 77600.2004   25  305 60063.0271 83513.3993  39.0%  3403 2664s
  4207  3247 77057.0550   26  324 60063.0271 83364.6420  38.8%  3390 2694s
  4292  3244 75176.9944   27  312 60063.0271 83364.6291  38.8%  3382 2726s
  4373  3243 74476.2343   28  295 60063.0271 82262.9361  37.0%  3379 2748s
  4445  3250 73901.5076   28  313 60063.0271 82262.9361  37.0%  3381 2777s
  4516  3247 73776.1593   28  324 60063.0271 81950.1381  36.4%  3390 2799s
  4553  3262 73223.8706   29  261 60063.0271 81950.1381  36.4%  3398 2818s
  4585  3275 71159.3080   30  258 60063.0271 81950.1381  36.4%  3411 2843s
  4622  3294 72291.1362   30  249 60063.0271 81950.1381  36.4%  3424 2865s
  4675  3317 72177.0902   31  249 60063.0271 81950.1381  36.4%  3430 2888s
  4737  3332 69353.4434   30  241 60063.0271 81950.1381  36.4%  3437 2910s
  4794  3362 69578.6261   32  251 60063.0271 81950.1381  36.4%  3449 2936s
  4868  3398 68838.0974   33  246 60063.0271 81950.1381  36.4%  3462 2969s
  4945  3429 68506.8947   33  234 60063.0271 81950.1381  36.4%  3479 3006s
  5055  3451 65094.7280   36  154 60063.0271 81950.1381  36.4%  3481 3035s
  5175  3459 64682.6677   37  138 60063.0271 81950.1381  36.4%  3476 3072s
  5303  3460     cutoff   38      60063.0271 81950.1381  36.4%  3468 3114s
  5401  3490 76564.4739   24  315 60063.0271 81950.1381  36.4%  3485 3161s
  5510  3535 73943.0291   26  271 60063.0271 81950.1381  36.4%  3499 3196s
  5615  3539 72309.4755   28  311 60063.0271 81950.1381  36.4%  3518 3229s
  5682  3543 67451.2305   29  366 60063.0271 81950.1381  36.4%  3520 3258s
  5719  3556 66764.1466   30  291 60063.0271 81950.1381  36.4%  3536 3293s
  5783  3578 65527.5619   31  285 60063.0271 81950.1381  36.4%  3545 3333s
  5897  3594 62942.2057   35  236 60063.0271 81950.1381  36.4%  3552 3378s
  6024  3600 infeasible   43      60063.0271 81950.1381  36.4%  3569 3428s
  6157  3621 77216.3115   25  343 60063.0271 81950.1381  36.4%  3594 3474s
  6253  3658 72589.0805   27  355 60063.0271 81950.1381  36.4%  3637 3528s
  6398  3682 69552.7310   29  346 60063.0271 81950.1381  36.4%  3657 3575s
  6548  3671 66908.3693   32  310 60063.0271 81950.1381  36.4%  3673 3600s

Cutting planes:
  Learned: 1
  MIR: 1001
  Mixing: 3
  Flow cover: 1894
  RLT: 18
  Relax-and-lift: 124

Explored 6661 nodes (24625145 simplex iterations) in 3600.04 seconds (6119.93 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 60063 59644.7 59470.8 ... 57571.2

Time limit reached
Best objective 6.006302705169e+04, best bound 8.195013813264e+04, gap 36.4402%
  WARNING: Time limit reached. Using best solution found (gap: 36.44%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 60063.03, θ = 233601.85
  Upper Bound (UB) = 60063.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 233601.85
  [DEBUG]   ✓ Scenario 0: θ = 233601.85 ≤ Q = 233601.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 233601.85 ≤ Q = 233601.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 233601.85 ≤ Q = 233601.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 233601.85 ≤ Q = 233601.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 233601.85 ≤ Q = 233601.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 233601.85 ≤ Q = 233601.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 233601.85 ≤ Q = 233601.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 233601.85 ≤ Q = 233601.85 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5dcea11a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa2315ee6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.246147e+13
Presolve removed 2580 rows and 1869 columns
Presolve time: 0.01s
Presolved: 513 rows, 520 columns, 1456 nonzeros
Found heuristic solution: objective 5916179.1963
Variable types: 354 continuous, 166 integer (166 binary)

Root relaxation: objective -1.721774e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -172177.40    0  130 5916179.20 -172177.40   103%     -    0s
H    0     0                    -135556.5698 -172177.40  27.0%     -    0s
H    0     0                    -136552.0346 -172177.40  26.1%     -    0s
H    0     0                    -136728.8749 -172177.40  25.9%     -    0s
H    0     0                    -136761.7654 -172177.40  25.9%     -    0s
H    0     0                    -142184.6569 -172177.40  21.1%     -    0s
     0     0 -155442.99    0   71 -142184.66 -155442.99  9.32%     -    0s
H    0     0                    -153524.6992 -155344.94  1.19%     -    0s
H    0     0                    -153836.9631 -155344.94  0.98%     -    0s
H    0     0                    -154030.5020 -155168.01  0.74%     -    0s
     0     0 -155168.01    0   66 -154030.50 -155168.01  0.74%     -    0s
     0     0 -155148.14    0   66 -154030.50 -155148.14  0.73%     -    0s
     0     0 -154239.39    0   37 -154030.50 -154239.39  0.14%     -    0s
     0     0 -154233.96    0   14 -154030.50 -154233.96  0.13%     -    0s
H    0     0                    -154086.1117 -154231.91  0.09%     -    0s
     0     0 -154171.15    0   16 -154086.11 -154171.15  0.06%     -    0s
     0     0 -154158.57    0   12 -154086.11 -154158.57  0.05%     -    0s
     0     0 -154158.57    0   25 -154086.11 -154158.57  0.05%     -    0s
     0     0 -154158.57    0   23 -154086.11 -154158.57  0.05%     -    0s
H    0     0                    -154098.8950 -154158.57  0.04%     -    0s
     0     0 -154158.57    0   21 -154098.89 -154158.57  0.04%     -    0s
     0     0 -154158.57    0   10 -154098.89 -154158.57  0.04%     -    0s
H    0     0                    -154118.4837 -154136.20  0.01%     -    0s
     0     0 -154118.48    0    4 -154118.48 -154118.48  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  MIR: 22
  Flow cover: 3

Explored 1 nodes (686 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -154118 -154099 -154086 ... -136552
No other solutions better than -154118

Optimal solution found (tolerance 1.00e-04)
Best objective -1.541184836779e+05, best bound -1.541184836779e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 220552.76
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154118.48
  [DEBUG]   S×d_nominal = 374671.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374671.25 + -154118.48 = 220552.76
  [DEBUG]   Current θ from Master = 233601.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13049.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 47013.95
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 2470.9198, Absolute Gap = 2470.9198, Relative Gap = 0.041139
  Not converged yet (gap = 2470.92 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394679 nonzeros
Model fingerprint: 0xe16877c3
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 60983 rows and 24763 columns
Presolve time: 2.41s
Presolved: 78010 rows, 33657 columns, 478310 nonzeros
Variable types: 31398 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -196616.4025

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 78010 rows, 33657 columns, 478310 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25423   -1.9228176e+05   0.000000e+00   3.543327e+07      5s
   39707   -1.8880026e+04   0.000000e+00   5.825653e+08     10s
   51327    2.2868430e+04   0.000000e+00   6.757990e+07     15s
   60656    4.0937918e+04   0.000000e+00   7.319720e+07     20s
   68997    4.9603565e+04   0.000000e+00   2.450210e+07     25s
   76420    5.5466101e+04   0.000000e+00   3.993258e+06     30s
   82065    6.1022625e+04   0.000000e+00   3.346504e+07     35s
   89871    6.7856708e+04   0.000000e+00   3.712923e+10     40s
   96783    7.1433007e+04   0.000000e+00   3.748206e+06     45s
  103885    7.7171062e+04   0.000000e+00   2.855206e+07     50s
Concurrent spin time: 2.41s

Solved with dual simplex

Root relaxation: objective 1.007049e+05, 62459 iterations, 52.24 seconds (69.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 100704.877    0  117 -196616.40 100704.877   151%     -   55s
H    0     0                    -192623.8846 100704.877   152%     -   55s
H    0     0                    -172888.7921 100704.877   158%     -   56s
H    0     0                    -172428.2206 100704.877   158%     -   56s
H    0     0                    -140365.3884 100704.877   172%     -   56s
H    0     0                    -140028.1845 100704.877   172%     -   56s
H    0     0                    -139855.3388 100704.877   172%     -   56s
H    0     0                    -138788.4879 100704.877   173%     -   56s
H    0     0                    -138647.3153 100704.877   173%     -   56s
H    0     0                    -87987.87185 100704.877   214%     -   56s
H    0     0                    8810.4532258 100704.877  1043%     -   56s
H    0     0                    8977.9185986 100704.877  1022%     -   56s
H    0     0                    24633.894251 100704.877   309%     -   56s
H    0     0                    32555.866923 100704.877   209%     -   57s
H    0     0                    35343.403713 100704.877   185%     -   58s
H    0     0                    37503.371621 100704.877   169%     -   58s
H    0     0                    42701.921547 100704.877   136%     -   59s
     0     0 95334.6021    0  156 42701.9215 95334.6021   123%     -   79s
H    0     0                    42887.124571 95332.2859   122%     -   81s
H    0     0                    44000.582311 94720.5153   115%     -   89s
     0     0 94720.5153    0  167 44000.5823 94720.5153   115%     -   89s
     0     0 94446.6612    0  172 44000.5823 94446.6612   115%     -   97s
     0     0 94437.5186    0  169 44000.5823 94437.5186   115%     -   98s
     0     0 94408.3374    0  168 44000.5823 94408.3374   115%     -  101s
     0     0 94389.9357    0  159 44000.5823 94389.9357   115%     -  102s
     0     0 94389.5606    0  159 44000.5823 94389.5606   115%     -  102s
     0     0 91560.8559    0  272 44000.5823 91560.8559   108%     -  124s
H    0     0                    53368.345721 91560.7694  71.6%     -  124s
H    0     0                    53614.482686 91560.7694  70.8%     -  125s
H    0     0                    54275.038021 91560.7694  68.7%     -  125s
H    0     0                    54310.571206 91560.7694  68.6%     -  125s
H    0     0                    54489.178440 91560.7694  68.0%     -  125s
H    0     0                    54513.234077 91560.7694  68.0%     -  125s
H    0     0                    54680.683671 91560.7694  67.4%     -  125s
     0     0 90822.6410    0  293 54680.6837 90822.6410  66.1%     -  139s
     0     0 90587.9587    0  291 54680.6837 90587.9587  65.7%     -  147s
     0     0 90495.7457    0  272 54680.6837 90495.7457  65.5%     -  154s
     0     0 90338.9002    0  271 54680.6837 90338.9002  65.2%     -  160s
     0     0 90194.9248    0  282 54680.6837 90194.9248  64.9%     -  165s
     0     0 90120.1336    0  319 54680.6837 90120.1336  64.8%     -  169s
     0     0 90101.2980    0  305 54680.6837 90101.2980  64.8%     -  172s
     0     0 90025.4722    0  292 54680.6837 90025.4722  64.6%     -  175s
     0     0 89957.7472    0  288 54680.6837 89957.7472  64.5%     -  178s
     0     0 89937.4090    0  289 54680.6837 89937.4090  64.5%     -  180s
     0     0 89886.1201    0  294 54680.6837 89886.1201  64.4%     -  185s
     0     0 89878.1409    0  300 54680.6837 89878.1409  64.4%     -  188s
     0     0 89870.4644    0  307 54680.6837 89870.4644  64.4%     -  190s
     0     0 89855.3567    0  298 54680.6837 89855.3567  64.3%     -  194s
     0     0 89852.4593    0  297 54680.6837 89852.4593  64.3%     -  195s
     0     0 89851.3910    0  302 54680.6837 89851.3910  64.3%     -  195s
     0     0 88064.8017    0  307 54680.6837 88064.8017  61.1%     -  238s
     0     0 87601.0020    0  316 54680.6837 87601.0020  60.2%     -  255s
     0     0 87298.9271    0  325 54680.6837 87298.9271  59.7%     -  269s
H    0     0                    54911.115743 87121.6414  58.7%     -  280s
H    0     0                    55205.912965 87121.6414  57.8%     -  280s
H    0     0                    55211.233582 87121.6414  57.8%     -  280s
H    0     0                    55276.692517 87121.6414  57.6%     -  280s
H    0     0                    55276.742651 87121.6414  57.6%     -  280s
H    0     0                    55366.567532 87121.6414  57.4%     -  280s
     0     0 87121.6414    0  367 55366.5675 87121.6414  57.4%     -  281s
     0     0 86997.6466    0  371 55366.5675 86997.6466  57.1%     -  290s
H    0     0                    55500.175938 86915.7351  56.6%     -  296s
H    0     0                    55696.662547 86915.7351  56.1%     -  296s
     0     0 86915.7351    0  322 55696.6625 86915.7351  56.1%     -  296s
     0     0 86834.7556    0  322 55696.6625 86834.7556  55.9%     -  301s
H    0     0                    55780.875602 86778.4027  55.6%     -  305s
H    0     0                    55942.532675 86778.4027  55.1%     -  305s
H    0     0                    55973.808772 86778.4027  55.0%     -  305s
     0     0 86778.4027    0  326 55973.8088 86778.4027  55.0%     -  305s
     0     0 86768.2672    0  330 55973.8088 86768.2672  55.0%     -  308s
     0     0 86731.6635    0  328 55973.8088 86731.6635  55.0%     -  312s
     0     0 86719.7279    0  338 55973.8088 86719.7279  54.9%     -  314s
     0     0 86716.4841    0  331 55973.8088 86716.4841  54.9%     -  315s
     0     0 86715.1620    0  332 55973.8088 86715.1620  54.9%     -  316s
H    0     0                    56060.457724 86715.1620  54.7%     -  327s
     0     0 86034.4346    0  387 56060.4577 86034.4346  53.5%     -  344s
     0     0 85857.4592    0  386 56060.4577 85857.4592  53.2%     -  352s
     0     0 85719.4562    0  394 56060.4577 85719.4562  52.9%     -  359s
     0     0 85621.6519    0  391 56060.4577 85621.6519  52.7%     -  368s
     0     0 85592.7628    0  396 56060.4577 85592.7628  52.7%     -  374s
     0     0 85576.3071    0  385 56060.4577 85576.3071  52.7%     -  376s
     0     0 85565.1108    0  395 56060.4577 85565.1108  52.6%     -  378s
     0     0 85561.2711    0  391 56060.4577 85561.2711  52.6%     -  379s
     0     0 85556.7837    0  390 56060.4577 85556.7837  52.6%     -  381s
     0     0 85550.1085    0  393 56060.4577 85550.1085  52.6%     -  382s
     0     0 85549.9078    0  392 56060.4577 85549.9078  52.6%     -  383s
     0     0 85411.8308    0  358 56060.4577 85411.8308  52.4%     -  394s
     0     0 85373.7360    0  359 56060.4577 85373.7360  52.3%     -  399s
     0     0 85357.9613    0  366 56060.4577 85357.9613  52.3%     -  403s
     0     0 85343.7298    0  402 56060.4577 85343.7298  52.2%     -  405s
     0     0 85336.3418    0  406 56060.4577 85336.3418  52.2%     -  407s
     0     0 85333.5938    0  405 56060.4577 85333.5938  52.2%     -  408s
     0     0 85332.4392    0  363 56060.4577 85332.4392  52.2%     -  410s
     0     0 85297.0755    0  392 56060.4577 85297.0755  52.2%     -  418s
     0     0 85286.9210    0  352 56060.4577 85286.9210  52.1%     -  427s
     0     0 85276.0370    0  397 56060.4577 85276.0370  52.1%     -  430s
     0     0 85274.0627    0  351 56060.4577 85274.0627  52.1%     -  431s
H    0     0                    56427.102814 85236.0494  51.1%     -  438s
     0     0 85236.0494    0  357 56427.1028 85236.0494  51.1%     -  438s
     0     0 85221.2176    0  365 56427.1028 85221.2176  51.0%     -  443s
     0     0 85218.2356    0  364 56427.1028 85218.2356  51.0%     -  444s
     0     0 85216.8127    0  361 56427.1028 85216.8127  51.0%     -  444s
     0     0 85195.2065    0  363 56427.1028 85195.2065  51.0%     -  449s
H    0     0                    56575.081875 85195.1888  50.6%     -  451s
H    0     0                    56792.000771 85195.1888  50.0%     -  451s
H    0     0                    57250.225367 85195.1888  48.8%     -  451s
H    0     0                    57289.425744 85195.1888  48.7%     -  451s
H    0     0                    57425.778009 85195.1888  48.4%     -  451s
     0     0 85189.6987    0  366 57425.7780 85189.6987  48.3%     -  454s
     0     0 85185.5416    0  369 57425.7780 85185.5416  48.3%     -  455s
     0     0 85185.3212    0  367 57425.7780 85185.3212  48.3%     -  456s
     0     0 85167.7437    0  370 57425.7780 85167.7437  48.3%     -  460s
H    0     0                    57427.727382 85167.5566  48.3%     -  461s
     0     0 85144.5970    0  372 57427.7274 85144.5970  48.3%     -  464s
     0     0 85136.5088    0  376 57427.7274 85136.5088  48.2%     -  467s
     0     0 85130.5455    0  381 57427.7274 85130.5455  48.2%     -  470s
     0     0 85130.0053    0  377 57427.7274 85130.0053  48.2%     -  471s
     0     0 85122.6962    0  372 57427.7274 85122.6962  48.2%     -  475s
H    0     0                    57642.308965 85121.8269  47.7%     -  478s
H    0     0                    58044.081875 85121.8269  46.7%     -  478s
H    0     0                    58058.500077 85121.8269  46.6%     -  478s
     0     0 85121.1249    0  376 58058.5001 85121.1249  46.6%     -  479s
     0     0 85102.8820    0  416 58058.5001 85102.8820  46.6%     -  484s
     0     0 85099.4243    0  376 58058.5001 85099.4243  46.6%     -  487s
     0     0 85098.8161    0  379 58058.5001 85098.8161  46.6%     -  487s
     0     0 85097.2756    0  416 58058.5001 85097.2756  46.6%     -  490s
H    0     0                    58062.662660 85097.1136  46.6%     -  494s
     0     0 85097.1136    0  416 58062.6627 85097.1136  46.6%     -  494s
     0     0 85096.1608    0  374 58062.6627 85096.1608  46.6%     -  497s
     0     0 85096.1345    0  374 58062.6627 85096.1345  46.6%     -  498s
H    0     0                    58256.028601 85096.0695  46.1%     -  580s
     0     2 85096.0695    0  374 58256.0286 85096.0695  46.1%     -  589s
     1     4 85076.8162    1  372 58256.0286 85096.0695  46.1%  2490  598s
     3     7 85031.0461    2  422 58256.0286 85076.5187  46.0%  5090  635s
     6    13 84878.0893    3  367 58256.0286 85030.9844  46.0%  8254  670s
    12    25 84831.1089    4  364 58256.0286 84877.8496  45.7%  9088  697s
    24    37 81988.5645    5  358 58256.0286 84877.8496  45.7% 13969  753s
    36    68 83275.5058    5  390 58256.0286 84830.9274  45.6% 13824  894s
H   43    68                    58267.386328 84830.9274  45.6% 14081  894s
H   44    68                    58364.157541 84830.9274  45.3% 13964  894s
H   49    68                    58488.909432 84830.9274  45.0% 13553  895s
H   51    68                    58572.049449 84830.9274  44.8% 13415  895s
H   55    68                    58901.528067 84830.9274  44.0% 12878  895s
H   57    68                    58987.042179 84830.9274  43.8% 12642  895s
    67   134 83231.3319    6  382 58987.0422 84830.9274  43.8% 15265  946s
   133   206 81842.5989    7  364 58987.0422 84830.9274  43.8% 10948  982s
H  134   206                    59048.595814 84830.9274  43.7% 10866  982s
   205   312 81719.7547    8  362 59048.5958 84830.9274  43.7%  8619 1014s
   311   409 80971.1933   11  351 59048.5958 84830.9274  43.7%  7173 1039s
   408   488 80456.0281   16  329 59048.5958 84830.9274  43.7%  6288 1061s
   487   562 80320.4127   20  303 59048.5958 84830.9274  43.7%  5865 1082s
   561   593 79807.7621   22  322 59048.5958 84830.9274  43.7%  5603 1101s
   592   628 79578.7531   23  321 59048.5958 84830.9274  43.7%  5646 1123s
   627   664 79546.7887   24  329 59048.5958 84830.9274  43.7%  5657 1144s
   663   702 79134.4521   25  314 59048.5958 84830.9274  43.7%  5703 1161s
   701   735 78663.3004   26  287 59048.5958 84830.9274  43.7%  5804 1179s
   734   764 78628.9511   27  288 59048.5958 84830.9274  43.7%  5846 1196s
   763   798 78541.3834   28  287 59048.5958 84830.9274  43.7%  5876 1209s
H  786   798                    59111.316461 84830.9274  43.5%  5869 1209s
H  793   798                    59278.897340 84830.9274  43.1%  5890 1209s
   797   883 78520.3114   29  298 59278.8973 84830.9274  43.1%  5921 1227s
   882   913 78349.0609   31  290 59278.8973 84830.9274  43.1%  5813 1245s
   914   948 77504.7077   32  292 59278.8973 84830.9274  43.1%  5834 1263s
   949   984 77126.9353   33  218 59278.8973 84830.9274  43.1%  5856 1279s
H  960   984                    59426.556888 84830.9274  42.7%  5826 1279s
   987  1087 76711.6431   34  264 59426.5569 84830.9274  42.7%  5931 1298s
  1098  1176 74877.2444   36  205 59426.5569 84830.9274  42.7%  5779 1320s
  1203  1283 72603.5753   39  171 59426.5569 84830.9274  42.7%  5646 1341s
  1324  1377 72232.3602   42  163 59426.5569 84647.9480  42.4%  5512 1363s
  1446  1459 71132.5209   46  137 59426.5569 84647.9480  42.4%  5443 1387s
  1562  1531 70719.4897   50  134 59426.5569 84647.9480  42.4%  5409 1413s
  1664  1614 68440.0418   55  166 59426.5569 84647.9480  42.4%  5443 1439s
  1777  1700 68201.8995   60  191 59426.5569 84647.9480  42.4%  5372 1467s
  1909  1795 67287.5564   70  115 59426.5569 84647.9480  42.4%  5328 1495s
  2024  1825 64857.6121   82  150 59426.5569 84647.9480  42.4%  5335 1524s
  2058  1865 64301.3563   83  168 59426.5569 84647.9480  42.4%  5433 1552s
H 2074  1865                    59488.507506 84647.9480  42.3%  5449 1552s
  2108  1973 61810.9835   89  123 59488.5075 84647.9480  42.3%  5477 1588s
H 2238  2018                    59690.579261 84647.9480  41.8%  5458 1616s
H 2272  2018                    59701.739668 84647.9480  41.8%  5476 1616s
  2312  2084 59827.6293  117   89 59701.7397 84647.9480  41.8%  5447 1652s
  2414  2153 81919.6192    9  358 59701.7397 84314.9314  41.2%  5534 1687s
  2542  2232 76920.4390   10  309 59701.7397 84314.9314  41.2%  5586 1723s
  2655  2341 74258.4417   11  300 59701.7397 83663.8815  40.1%  5653 1759s
  2812  2437 73260.8611   13  259 59701.7397 83663.8815  40.1%  5659 1791s
  2958  2477 70920.2376   14  216 59701.7397 83443.6676  39.8%  5661 1817s
  3008  2502 69452.9482   15  195 59701.7397 83443.6676  39.8%  5676 1855s
  3065  2560 68573.8533   16  183 59701.7397 83443.6676  39.8%  5692 1895s
  3149  2686 68266.7440   17  182 59701.7397 83443.6676  39.8%  5700 1940s
  3329  2714 67400.1982   19  159 59701.7397 83443.6676  39.8%  5636 1974s
H 3330  2713                    59842.188517 83443.6676  39.4%  5635 1974s
H 3348  2713                    59846.418400 83443.6676  39.4%  5645 1974s
  3369  2919 67159.8557   20  170 59846.4184 83443.6676  39.4%  5661 2018s
  3618  2920 73673.7825   18  374 59846.4184 83443.6676  39.4%  5551 2120s
  3620  2921 70496.6535   30  112 59846.4184 83443.6676  39.4%  5548 2196s
  3621  2922 81605.4901   12  274 59846.4184 83443.6676  39.4%  5547 2254s
H 3621  2775                    59860.869144 83443.6676  39.4%  5547 2289s
  3622  2776 60965.6747   58  296 59860.8691 83443.6676  39.4%  5545 2290s
  3623  2776 79262.7825   24  330 59860.8691 83443.6676  39.4%  5544 2319s
  3624  2777 68232.5390   41  363 59860.8691 83443.6676  39.4%  5542 2340s
  3625  2778 60126.2447   74  345 59860.8691 83443.6676  39.4%  5541 2354s
  3626  2778 66067.1131   41  391 59860.8691 83443.6676  39.4%  5539 2368s
  3627  2779 68675.1421   30  392 59860.8691 83443.6676  39.4%  5538 2384s
  3628  2780 79623.5929   13  407 59860.8691 83443.6676  39.4%  5536 2393s
  3629  2780 79226.9789   17  369 59860.8691 83443.6676  39.4%  5535 2405s
H 3629  2641                    59941.287464 83443.6676  39.2%  5535 2411s
H 3629  2509                    59963.900379 83443.6676  39.2%  5535 2411s
  3631  2511 61382.8219   42  381 59963.9004 83443.6676  39.2%  5532 2426s
  3632  2511 79362.1328   20  373 59963.9004 83443.6676  39.2%  5530 2436s
  3633  2512 69249.6367   50  375 59963.9004 83443.6676  39.2%  5528 2442s
  3634  2513 79608.1836   11  374 59963.9004 83443.6676  39.2%  5527 2446s
  3636  2514 64683.6723   82  369 59963.9004 83443.6676  39.2%  5524 2452s
  3637  2515 67296.2917   70  379 59963.9004 83443.6676  39.2%  5522 2455s
  3638  2515 60048.4939  135  379 59963.9004 83443.6676  39.2%  5521 2460s
H 3638  2389                    60025.438504 83443.6676  39.0%  5521 2472s
  3640  2391 64611.4048   98  364 60025.4385 83443.6676  39.0%  5518 2478s
  3641  2391 73052.3166   35  363 60025.4385 83443.6676  39.0%  5516 2482s
  3642  2392 69907.7761   22  351 60025.4385 83443.6676  39.0%  5515 2492s
  3643  2393 63677.9839   86  400 60025.4385 83443.6676  39.0%  5513 2499s
H 3643  2273                    60057.115882 83443.6676  38.9%  5513 2507s
H 3643  2159                    60083.579734 83443.6676  38.9%  5513 2507s
  3645  2160 66836.5939   74  367 60083.5797 83443.6676  38.9%  5510 2513s
  3646  2161 61487.7852   65  359 60083.5797 83443.6676  38.9%  5509 2524s
  3647  2161 77340.5935   33  365 60083.5797 83443.6676  38.9%  5507 2528s
  3648  2162 74811.6931   24  375 60083.5797 83443.6676  38.9%  5506 2538s
  3649  2163 62590.7298   55  371 60083.5797 83443.6676  38.9%  5504 2546s
  3650  2163 61483.4296   40  371 60083.5797 83443.6676  38.9%  5503 2556s
  3651  2164 81734.4895   12  385 60083.5797 83443.6676  38.9%  5501 2563s
  3652  2165 67145.0100   22  384 60083.5797 83443.6676  38.9%  5500 2565s
  3654  2166 78275.3056   17  417 60083.5797 83443.6676  38.9%  5497 2575s
H 3655  2058                    60228.337390 83443.6676  38.5%  5495 2585s
  3657  2059 78563.2327    8  425 60228.3374 83443.6676  38.5%  5492 2596s
  3658  2060 77744.7850   16  376 60228.3374 83443.6676  38.5%  5491 2604s
  3659  2060 73922.0324   29  376 60228.3374 83443.6676  38.5%  5489 2669s
  3660  2061 61062.1433   64  376 60228.3374 83443.6676  38.5%  5488 2751s
H 3660  1959                    60356.613317 83443.6676  38.3%  5578 2760s
  3661  1961 83443.6676   14  373 60356.6133 83443.6676  38.3%  5577 2795s
  3663  1964 83443.6676   15  366 60356.6133 83443.6676  38.3%  5580 2840s
  3667  1971 83443.6676   16  373 60356.6133 83443.6676  38.3%  5580 2896s
  3675  1984 83443.6676   17  383 60356.6133 83443.6676  38.3%  5601 2954s
  3691  1995 82230.5598   18  390 60356.6133 83443.6676  38.3%  5701 3081s
H 3707  1920                    60364.782052 83443.6676  38.2%  5734 3181s
H 3714  1825                    60378.514479 83443.6676  38.2%  5758 3181s
H 3733  1730                    60393.285878 83443.6676  38.2%  5803 3181s
  3737  1847 79930.0946   20  357 60393.2859 83443.6676  38.2%  5819 3266s
  3856  1873 78886.0646   21  355 60393.2859 83443.6676  38.2%  5935 3311s
  3921  1904 78110.6269   22  344 60393.2859 83443.6676  38.2%  5955 3350s
  3974  1918 76787.6240   24  319 60393.2859 83443.6676  38.2%  5983 3387s
  4006  1946 76179.2205   23  335 60393.2859 83443.6676  38.2%  6021 3434s
  4044  1971 74429.4558   25  349 60393.2859 83443.6676  38.2%  6024 3465s
  4084  1999 71340.4174   25  284 60393.2859 83443.6676  38.2%  6032 3495s
  4133  2036 75533.8691   24  323 60393.2859 83443.6676  38.2%  6020 3526s
  4191  2059 72723.3307   27  352 60393.2859 83443.6676  38.2%  6001 3556s
  4247  2073 72332.6694   28  323 60393.2859 83443.6676  38.2%  5970 3587s
H 4270  1981                    60529.601668 83443.6676  37.9%  5950 3587s
  4298  2000 70313.4291   30  286 60529.6017 83443.6676  37.9%  5945 3600s

Cutting planes:
  Gomory: 8
  Lift-and-project: 2
  Projected implied bound: 31
  MIR: 1103
  Mixing: 2
  Flow cover: 1651
  RLT: 19
  Relax-and-lift: 128

Explored 4358 nodes (25983252 simplex iterations) in 3600.05 seconds (5871.83 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 60529.6 60393.3 60378.5 ... 59963.9

Time limit reached
Best objective 6.052960166757e+04, best bound 8.344366764101e+04, gap 37.8560%
  WARNING: Time limit reached. Using best solution found (gap: 37.86%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 60529.60, θ = 218912.64
  Upper Bound (UB) = 60529.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 218912.64
  [DEBUG]   ✓ Scenario 0: θ = 218912.64 ≤ Q = 218912.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 218912.64 ≤ Q = 218912.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 218912.64 ≤ Q = 218912.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 218912.64 ≤ Q = 219174.53 (slack: 261.89)
  [DEBUG]   ✓ Scenario 4: θ = 218912.64 ≤ Q = 218912.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 218912.64 ≤ Q = 218912.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 218912.64 ≤ Q = 218912.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 218912.64 ≤ Q = 218912.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 218912.64 ≤ Q = 218912.64 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3122eb50
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3122eb50
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.256919e+13
Presolve removed 2579 rows and 1870 columns
Presolve time: 0.01s
Presolved: 514 rows, 519 columns, 1453 nonzeros
Found heuristic solution: objective 6164959.8003
Variable types: 353 continuous, 166 integer (166 binary)

Root relaxation: objective -1.586827e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158682.68    0  129 6164959.80 -158682.68   103%     -    0s
H    0     0                    -123957.0720 -158682.68  28.0%     -    0s
H    0     0                    -126094.4773 -158682.68  25.8%     -    0s
H    0     0                    -131500.3465 -158682.68  20.7%     -    0s
H    0     0                    -131793.4765 -140686.78  6.75%     -    0s
     0     0 -140686.78    0  132 -131793.48 -140686.78  6.75%     -    0s
H    0     0                    -136766.7734 -140670.43  2.85%     -    0s
     0     0 -140450.79    0  106 -136766.77 -140450.79  2.69%     -    0s
     0     0 -139828.03    0  103 -136766.77 -139828.03  2.24%     -    0s
H    0     0                    -138454.8149 -139808.67  0.98%     -    0s
     0     0 -139808.67    0  103 -138454.81 -139808.67  0.98%     -    0s
     0     0 -139623.50    0   90 -138454.81 -139623.50  0.84%     -    0s
H    0     0                    -138479.9916 -139599.39  0.81%     -    0s
     0     0 -139599.39    0   90 -138479.99 -139599.39  0.81%     -    0s
     0     0 -139502.61    0   89 -138479.99 -139502.61  0.74%     -    0s
     0     0 -139492.17    0   89 -138479.99 -139492.17  0.73%     -    0s
     0     2 -139490.53    0   89 -138479.99 -139490.53  0.73%     -    0s
H   32    30                    -138501.4301 -139115.73  0.44%  15.8    0s
* 1968   179              40    -138522.1405 -138685.80  0.12%   6.4    0s
* 2278    26              35    -138539.1325 -138685.80  0.11%   6.0    0s

Cutting planes:
  Gomory: 93
  Implied bound: 3
  MIR: 209
  Flow cover: 9
  RLT: 31

Explored 2553 nodes (15067 simplex iterations) in 0.62 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -138539 -138522 -138501 ... -123957

Optimal solution found (tolerance 1.00e-04)
Best objective -1.385391324642e+05, best bound -1.385395914529e+05, gap 0.0003%
  Subproblem solved in 0.66s
  Worst-case operational profit (Z_SP) = 205613.71
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138539.13
  [DEBUG]   S×d_nominal = 344152.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 344152.84 + -138539.13 = 205613.71
  [DEBUG]   Current θ from Master = 218912.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13298.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 47230.67
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 2937.4944, Absolute Gap = 2937.4944, Relative Gap = 0.048530
  Not converged yet (gap = 2937.49 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437919 nonzeros
Model fingerprint: 0x0a481292
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67750 rows and 27510 columns
Presolve time: 2.58s
Presolved: 86533 rows, 37150 columns, 528029 nonzeros
Variable types: 34891 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -283692.8931
Found heuristic solution: objective -197811.2499

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.660e+06
 Factor NZ  : 7.900e+06 (roughly 110 MB of memory)
 Factor Ops : 1.328e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.57704381e+07  1.51366147e+08  1.20e+05 2.22e+01  7.67e+04     4s
   1  -1.18489860e+07  1.41735267e+08  8.44e+04 8.31e+01  5.33e+04     4s
   2  -5.92851561e+06  1.07550243e+08  4.17e+04 1.11e-11  2.76e+04     4s
   3  -7.22663410e+05  8.55214061e+07  1.80e+03 1.45e+00  1.68e+03     5s
   4  -4.33537808e+05  2.69070241e+07  4.39e+02 1.01e-01  4.06e+02     5s
   5  -3.30845706e+05  1.73995136e+07  2.09e+02 5.50e-02  2.13e+02     5s
   6  -2.29701901e+05  1.26468530e+07  7.29e+01 3.72e-02  1.13e+02     5s
   7  -1.32747322e+05  9.22145789e+06  3.45e+01 2.52e-02  7.15e+01     5s
   8  -1.04190945e+05  5.95677732e+06  2.39e+01 1.56e-02  4.46e+01     5s
   9  -6.34630411e+04  3.78437837e+06  1.13e+01 9.11e-03  2.64e+01     5s
  10  -2.01353779e+04  1.17558460e+06  1.93e+00 2.40e-03  7.66e+00     5s
  11  -4.28687739e+03  5.13612708e+05  1.35e+00 1.16e-03  3.31e+00     5s
  12   2.74440310e+04  2.83656889e+05  6.78e-01 1.11e-03  1.63e+00     5s
  13   3.31360891e+04  2.36386225e+05  5.96e-01 8.33e-04  1.29e+00     5s
  14   4.47335029e+04  1.92984184e+05  4.58e-01 9.47e-04  9.40e-01     5s
  15   5.02129597e+04  1.73540598e+05  4.03e-01 9.31e-04  7.82e-01     5s
  16   5.95422420e+04  1.50313282e+05  3.18e-01 1.36e-03  5.76e-01     6s
  17   6.16988394e+04  1.44096473e+05  2.98e-01 1.52e-03  5.22e-01     6s
  18   6.68769502e+04  1.35891510e+05  2.52e-01 1.09e-03  4.37e-01     6s
  19   6.82218398e+04  1.28689052e+05  2.40e-01 1.00e-03  3.83e-01     6s
  20   7.60123819e+04  1.21966952e+05  1.74e-01 1.31e-03  2.91e-01     6s
  21   7.92326918e+04  1.19268243e+05  1.50e-01 1.10e-03  2.54e-01     6s
  22   8.25085621e+04  1.12936065e+05  1.24e-01 2.12e-03  1.93e-01     6s
  23   8.57969013e+04  1.10378720e+05  9.90e-02 2.72e-03  1.56e-01     6s
  24   8.78381219e+04  1.09000728e+05  8.43e-02 2.32e-03  1.34e-01     6s
  25   8.92873911e+04  1.07341095e+05  7.37e-02 1.65e-03  1.14e-01     6s
  26   9.10932889e+04  1.06309568e+05  6.05e-02 1.09e-03  9.64e-02     6s
  27   9.31431343e+04  1.05203267e+05  4.61e-02 1.12e-03  7.64e-02     6s
  28   9.43073530e+04  1.04146573e+05  3.81e-02 7.55e-04  6.23e-02     7s
  29   9.58604375e+04  1.03267482e+05  2.78e-02 9.23e-04  4.69e-02     7s
  30   9.68957271e+04  1.02311138e+05  2.08e-02 1.30e-03  3.43e-02     7s
  31   9.73173943e+04  1.02146308e+05  1.81e-02 1.26e-03  3.06e-02     7s
  32   9.77405428e+04  1.01555809e+05  1.55e-02 6.95e-04  2.42e-02     7s
  33   9.83713009e+04  1.01349412e+05  1.18e-02 5.74e-04  1.89e-02     7s
  34   9.85806589e+04  1.01080276e+05  1.05e-02 4.08e-04  1.58e-02     7s
  35   9.89992707e+04  1.00910120e+05  8.08e-03 2.96e-04  1.21e-02     7s
  36   9.95498878e+04  1.00727806e+05  4.85e-03 5.66e-04  7.46e-03     7s
  37   9.97676842e+04  1.00673432e+05  3.60e-03 4.37e-04  5.73e-03     7s
  38   9.99841618e+04  1.00589445e+05  2.36e-03 3.50e-04  3.83e-03     7s
  39   1.00069274e+05  1.00549214e+05  1.89e-03 2.57e-04  3.04e-03     8s
  40   1.00160303e+05  1.00521973e+05  1.39e-03 2.01e-04  2.29e-03     8s
  41   1.00176092e+05  1.00511534e+05  1.30e-03 1.76e-04  2.12e-03     8s
  42   1.00204501e+05  1.00507961e+05  1.16e-03 1.69e-04  1.92e-03     8s
  43   1.00268877e+05  1.00493942e+05  8.07e-04 1.42e-04  1.42e-03     8s
  44   1.00316978e+05  1.00464997e+05  5.49e-04 8.02e-05  9.37e-04     8s
  45   1.00351488e+05  1.00450342e+05  3.67e-04 4.95e-05  6.26e-04     8s
  46   1.00379007e+05  1.00437295e+05  2.24e-04 2.20e-05  3.69e-04     8s
  47   1.00407577e+05  1.00430588e+05  8.03e-05 9.58e-06  1.46e-04     8s
  48   1.00416617e+05  1.00428560e+05  3.82e-05 6.04e-06  7.55e-05     9s
  49   1.00417601e+05  1.00428228e+05  3.35e-05 5.47e-06  6.72e-05     9s
  50   1.00421959e+05  1.00425704e+05  1.28e-05 1.17e-06  2.37e-05     9s
  51   1.00423690e+05  1.00425347e+05  4.93e-06 6.05e-07  1.05e-05     9s
  52   1.00424595e+05  1.00425116e+05  1.16e-06 2.74e-07  3.29e-06     9s
  53   1.00424903e+05  1.00424910e+05  6.70e-08 1.41e-07  4.68e-08     9s
  54   1.00424907e+05  1.00424907e+05  1.08e-07 3.07e-09  7.95e-10     9s

Barrier solved model in 54 iterations and 9.19 seconds (7.76 work units)
Optimal objective 1.00424907e+05


Root crossover log...

   76772 DPushes remaining with DInf 0.0000000e+00                 9s
   29299 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    3851 PPushes remaining with PInf 3.0344600e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.1566707e+01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40435    1.0042491e+05   0.000000e+00   5.156671e+01     14s
   40498    1.0042491e+05   0.000000e+00   0.000000e+00     14s
   40498    1.0042491e+05   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.43s

Solved with barrier

Root relaxation: objective 1.004249e+05, 40498 iterations, 11.34 seconds (14.97 work units)
Total elapsed time = 15.00s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 100424.907    0  174 -197811.25 100424.907   151%     -   15s
H    0     0                    -193818.7321 100424.907   152%     -   15s
H    0     0                    -187065.9116 100424.907   154%     -   15s
H    0     0                    -186992.5731 100424.907   154%     -   15s
H    0     0                    -181021.6519 100424.907   155%     -   15s
H    0     0                    -166089.7239 100424.907   160%     -   16s
H    0     0                    -165957.7397 100424.907   161%     -   16s
H    0     0                    -164115.7946 100424.907   161%     -   16s
H    0     0                    -164074.0373 100424.907   161%     -   16s
H    0     0                    -163899.5655 100424.907   161%     -   16s
H    0     0                    -62953.06600 100424.907   260%     -   16s
H    0     0                    23904.599401 100424.907   320%     -   17s
H    0     0                    28195.172360 100424.907   256%     -   18s
H    0     0                    30951.524133 100424.907   224%     -   18s
H    0     0                    36951.393101 100424.907   172%     -   18s
H    0     0                    41518.983352 100424.907   142%     -   18s
H    0     0                    43103.330267 100424.907   133%     -   18s
H    0     0                    43182.686160 100424.907   133%     -   18s
H    0     0                    44267.422535 100424.907   127%     -   18s
H    0     0                    44377.736087 100424.907   126%     -   18s
H    0     0                    45157.200509 100424.907   122%     -   20s
H    0     0                    45911.427469 100424.907   119%     -   20s
H    0     0                    46231.128918 95103.2106   106%     -  101s
H    0     0                    47171.239143 95103.2106   102%     -  101s
H    0     0                    48387.727266 95103.2106  96.5%     -  101s
H    0     0                    48538.819506 95103.2106  95.9%     -  101s
H    0     0                    49136.820169 95103.2106  93.5%     -  101s
H    0     0                    49139.911405 95103.2106  93.5%     -  101s
     0     0 95103.2106    0  225 49139.9114 95103.2106  93.5%     -  101s
     0     0 94656.6099    0  238 49139.9114 94656.6099  92.6%     -  151s
     0     0 94574.7608    0  244 49139.9114 94574.7608  92.5%     -  166s
     0     0 94559.5873    0  253 49139.9114 94559.5873  92.4%     -  176s
     0     0 94496.3150    0  250 49139.9114 94496.3150  92.3%     -  189s
     0     0 94479.4656    0  255 49139.9114 94479.4656  92.3%     -  196s
     0     0 94463.2025    0  253 49139.9114 94463.2025  92.2%     -  200s
     0     0 94457.6405    0  248 49139.9114 94457.6405  92.2%     -  202s
     0     0 94456.8361    0  247 49139.9114 94456.8361  92.2%     -  203s
     0     0 94456.7823    0  252 49139.9114 94456.7823  92.2%     -  204s
H    0     0                    49155.251247 90897.4642  84.9%     -  284s
H    0     0                    49161.555311 90897.4642  84.9%     -  284s
     0     0 90897.4642    0  296 49161.5553 90897.4642  84.9%     -  284s
H    0     0                    49673.386194 90897.4590  83.0%     -  285s
H    0     0                    49711.643339 90897.4590  82.8%     -  285s
     0     0 89861.4724    0  317 49711.6433 89861.4724  80.8%     -  351s
     0     0 89624.9802    0  356 49711.6433 89624.9802  80.3%     -  374s
     0     0 89435.9669    0  349 49711.6433 89435.9669  79.9%     -  395s
     0     0 89367.5386    0  350 49711.6433 89367.5386  79.8%     -  407s
     0     0 89286.5686    0  328 49711.6433 89286.5686  79.6%     -  419s
     0     0 89254.9475    0  351 49711.6433 89254.9475  79.5%     -  424s
     0     0 89175.5450    0  343 49711.6433 89175.5450  79.4%     -  433s
     0     0 89154.8957    0  347 49711.6433 89154.8957  79.3%     -  441s
     0     0 89067.4176    0  339 49711.6433 89067.4176  79.2%     -  456s
     0     0 89007.7519    0  343 49711.6433 89007.7519  79.0%     -  466s
     0     0 88999.0070    0  350 49711.6433 88999.0070  79.0%     -  468s
     0     0 88996.1480    0  343 49711.6433 88996.1480  79.0%     -  471s
     0     0 88994.4269    0  354 49711.6433 88994.4269  79.0%     -  472s
     0     0 88993.0037    0  355 49711.6433 88993.0037  79.0%     -  473s
     0     0 88990.0796    0  340 49711.6433 88990.0796  79.0%     -  475s
     0     0 88988.4721    0  347 49711.6433 88988.4721  79.0%     -  476s
     0     0 88988.1205    0  343 49711.6433 88988.1205  79.0%     -  477s
H    0     0                    54517.440501 87367.8912  60.3%     -  558s
H    0     0                    54531.261690 87367.8912  60.2%     -  558s
H    0     0                    54532.324244 87367.8912  60.2%     -  558s
H    0     0                    54655.758703 87367.8912  59.9%     -  558s
H    0     0                    54956.362002 87367.8912  59.0%     -  558s
     0     0 87367.8912    0  370 54956.3620 87367.8912  59.0%     -  558s
     0     0 87087.3584    0  399 54956.3620 87087.3584  58.5%     -  591s
H    0     0                    55323.339726 86872.2444  57.0%     -  610s
     0     0 86872.2444    0  408 55323.3397 86872.2444  57.0%     -  610s
     0     0 86795.7273    0  414 55323.3397 86795.7273  56.9%     -  622s
     0     0 86745.9717    0  406 55323.3397 86745.9717  56.8%     -  635s
     0     0 86717.3437    0  400 55323.3397 86717.3437  56.7%     -  642s
     0     0 86675.2038    0  409 55323.3397 86675.2038  56.7%     -  654s
     0     0 86664.1823    0  413 55323.3397 86664.1823  56.7%     -  658s
     0     0 86658.3243    0  407 55323.3397 86658.3243  56.6%     -  663s
     0     0 86655.0571    0  402 55323.3397 86655.0571  56.6%     -  668s
     0     0 86634.6284    0  387 55323.3397 86634.6284  56.6%     -  674s
     0     0 86620.5015    0  402 55323.3397 86620.5015  56.6%     -  678s
     0     0 86602.8770    0  397 55323.3397 86602.8770  56.5%     -  685s
     0     0 86595.0864    0  401 55323.3397 86595.0864  56.5%     -  687s
     0     0 86592.9548    0  396 55323.3397 86592.9548  56.5%     -  689s
     0     0 86592.5622    0  398 55323.3397 86592.5622  56.5%     -  689s
     0     0 85919.9813    0  336 55323.3397 85919.9813  55.3%     -  755s
     0     0 85721.6549    0  397 55323.3397 85721.6549  54.9%     -  776s
     0     0 85656.1640    0  345 55323.3397 85656.1640  54.8%     -  788s
     0     0 85593.1582    0  354 55323.3397 85593.1582  54.7%     -  801s
     0     0 85558.6803    0  348 55323.3397 85558.6803  54.7%     -  810s
     0     0 85517.4472    0  347 55323.3397 85517.4472  54.6%     -  819s
     0     0 85497.1926    0  352 55323.3397 85497.1926  54.5%     -  824s
     0     0 85476.3172    0  346 55323.3397 85476.3172  54.5%     -  833s
     0     0 85445.5377    0  342 55323.3397 85445.5377  54.4%     -  840s
     0     0 85400.6315    0  355 55323.3397 85400.6315  54.4%     -  849s
     0     0 85388.8558    0  355 55323.3397 85388.8558  54.3%     -  854s
     0     0 85383.0845    0  357 55323.3397 85383.0845  54.3%     -  859s
     0     0 85369.8369    0  356 55323.3397 85369.8369  54.3%     -  865s
     0     0 85360.8653    0  351 55323.3397 85360.8653  54.3%     -  868s
     0     0 85357.6648    0  356 55323.3397 85357.6648  54.3%     -  872s
     0     0 85352.5354    0  356 55323.3397 85352.5354  54.3%     -  874s
     0     0 85351.6445    0  355 55323.3397 85351.6445  54.3%     -  876s
     0     0 85257.5063    0  399 55323.3397 85257.5063  54.1%     -  889s
     0     0 85222.2830    0  349 55323.3397 85222.2830  54.0%     -  900s
     0     0 85210.4250    0  399 55323.3397 85210.4250  54.0%     -  907s
     0     0 85204.0513    0  399 55323.3397 85204.0513  54.0%     -  912s
     0     0 85201.1149    0  403 55323.3397 85201.1149  54.0%     -  917s
     0     0 85198.7656    0  414 55323.3397 85198.7656  54.0%     -  919s
     0     0 85198.2334    0  410 55323.3397 85198.2334  54.0%     -  919s
     0     0 85152.0911    0  372 55323.3397 85152.0911  53.9%     -  932s
     0     0 85141.7130    0  373 55323.3397 85141.7130  53.9%     -  948s
     0     0 85139.8898    0  368 55323.3397 85139.8898  53.9%     -  951s
     0     0 85120.2503    0  361 55323.3397 85120.2503  53.9%     -  959s
     0     0 85118.1973    0  370 55323.3397 85118.1973  53.9%     -  962s
     0     0 85108.1564    0  360 55323.3397 85108.1564  53.8%     -  971s
H    0     0                    55435.083581 85107.5662  53.5%     -  974s
H    0     0                    55617.846713 85107.5662  53.0%     -  975s
     0     0 85105.7720    0  365 55617.8467 85105.7720  53.0%     -  980s
     0     0 85103.6425    0  417 55617.8467 85103.6425  53.0%     -  982s
     0     0 85100.0153    0  375 55617.8467 85100.0153  53.0%     -  986s
     0     0 85098.2087    0  363 55617.8467 85098.2087  53.0%     -  988s
     0     0 85074.9291    0  413 55617.8467 85074.9291  53.0%     - 1001s
H    0     0                    55637.335173 85074.8876  52.9%     - 1007s
H    0     0                    55672.971085 85074.8876  52.8%     - 1007s
H    0     0                    55821.426794 85074.8876  52.4%     - 1007s
H    0     0                    55876.267184 85074.8876  52.3%     - 1007s
     0     0 85069.6730    0  413 55876.2672 85069.6730  52.2%     - 1012s
     0     0 85066.2825    0  404 55876.2672 85066.2825  52.2%     - 1014s
     0     0 85066.0699    0  405 55876.2672 85066.0699  52.2%     - 1015s
     0     0 85051.9635    0  408 55876.2672 85051.9635  52.2%     - 1025s
     0     0 85047.4630    0  408 55876.2672 85047.4630  52.2%     - 1032s
     0     0 85046.7091    0  404 55876.2672 85046.7091  52.2%     - 1033s
     0     0 85036.7594    0  404 55876.2672 85036.7594  52.2%     - 1040s
     0     0 85024.8045    0  420 55876.2672 85024.8045  52.2%     - 1051s
     0     0 85020.9743    0  417 55876.2672 85020.9743  52.2%     - 1054s
     0     0 85020.1749    0  422 55876.2672 85020.1749  52.2%     - 1056s
     0     0 85007.1476    0  401 55876.2672 85007.1476  52.1%     - 1063s
     0     0 85001.1645    0  406 55876.2672 85001.1645  52.1%     - 1068s
     0     0 84997.5546    0  411 55876.2672 84997.5546  52.1%     - 1073s
     0     0 84996.3021    0  446 55876.2672 84996.3021  52.1%     - 1076s
     0     0 84993.9989    0  405 55876.2672 84993.9989  52.1%     - 1081s
     0     0 84993.3299    0  450 55876.2672 84993.3299  52.1%     - 1094s
     0     0 84986.0064    0  448 55876.2672 84986.0064  52.1%     - 1101s
     0     0 84985.6253    0  448 55876.2672 84985.6253  52.1%     - 1104s
     0     2 84985.6253    0  448 55876.2672 84985.6253  52.1%     - 1308s
     1     3 84787.5312    1  487 55876.2672 84985.6253  52.1% 10446 1328s
     2     4 84935.8616    1  418 55876.2672 84935.8616  52.0%  8156 1343s
     3     6 84441.1895    2  439 55876.2672 84935.7925  52.0%  7113 1379s
     5     9 82122.1120    3  315 55876.2672 84935.7925  52.0% 11313 1406s
     8    16 81625.5901    4  335 55876.2672 84869.5618  51.9% 10314 1440s
    15    31 83497.4699    4  381 55876.2672 84869.5618  51.9% 10673 1475s
    30    46 81505.8498    5  339 55876.2672 84533.1353  51.3% 16693 1574s
H   45    76                    56193.561832 84533.1353  50.4% 17021 1641s
H   71    76                    56206.426637 84533.1353  50.4% 13967 1641s
    75   144 80404.2704    6  362 56206.4266 84533.1353  50.4% 13716 1755s
   143   254 76325.0564   10  300 56206.4266 84533.1353  50.4%  9528 1808s
H  157   254                    56398.840906 84533.1353  49.9%  9099 1808s
H  182   254                    56421.176390 84533.1353  49.8%  8773 1808s
H  191   254                    56464.145562 84533.1353  49.7%  8637 1808s
   253   346 75782.0314   15  280 56464.1456 84533.1353  49.7%  8460 1853s
   345   421 75556.1707   18  269 56464.1456 84533.1353  49.7%  7222 1889s
   420   494 75090.2374   19  282 56464.1456 84533.1353  49.7%  6639 1921s
   493   523 74803.0098   20  274 56464.1456 84533.1353  49.7%  6198 1947s
H  507   523                    56536.863002 84533.1353  49.5%  6114 1947s
   522   600 74521.1710   21  268 56536.8630 84533.1353  49.5%  6086 1978s
   599   628 74367.0448   22  256 56536.8630 84533.1353  49.5%  5780 2008s
H  613   628                    56570.545890 84533.1353  49.4%  5744 2008s
   627   714 74160.9600   23  243 56570.5459 84533.1353  49.4%  5709 2035s
   713   745 73513.3424   25  238 56570.5459 84533.1353  49.4%  5375 2058s
   744   780 73313.7156   26  243 56570.5459 84533.1353  49.4%  5303 2080s
H  772   780                    56599.902028 84533.1353  49.4%  5275 2080s
   779   869 71473.0684   30  220 56599.9020 84533.1353  49.4%  5282 2104s
   868   963 71338.4866   32  224 56599.9020 84533.1353  49.4%  5008 2131s
   964  1056 69977.9900   34  178 56599.9020 84533.1353  49.4%  4765 2162s
  1065  1082 69877.9214   35  178 56599.9020 84533.1353  49.4%  4549 2184s
  1097  1108 64959.3831   36  174 56599.9020 84533.1353  49.4%  4518 2217s
H 1101  1108                    56786.132520 84533.1353  48.9%  4520 2217s
  1127  1203 64861.6257   37  164 56786.1325 84533.1353  48.9%  4533 2247s
  1255  1241 63526.2546   41  159 56786.1325 84533.1353  48.9%  4309 2291s
  1359  1300 57756.9302   45  129 56786.1325 84533.1353  48.9%  4198 2329s
  1448  1364     cutoff   48      56786.1325 84533.1353  48.9%  4127 2366s
  1528  1472 60801.8657   21  158 56786.1325 84533.1353  48.9%  4117 2400s
  1648  1535 59304.7483   24  141 56786.1325 84533.1353  48.9%  4046 2439s
  1755  1562 infeasible   31      56786.1325 84289.5738  48.4%  4019 2474s
H 1757  1562                    56803.795346 84289.5738  48.4%  4020 2474s
H 1760  1562                    58529.216722 84289.5738  44.0%  4018 2474s
  1806  1598 infeasible   30      58529.2167 84289.5738  44.0%  4042 2516s
  1918  1657 65908.5887   51  152 58529.2167 84289.5738  44.0%  4014 2560s
  2031  1738 61880.2831   63  113 58529.2167 84289.5738  44.0%  3995 2610s
  2158  1826 60253.8740   76  115 58529.2167 84289.5738  44.0%  3976 2654s
  2337  1874 59193.2865   86   89 58529.2167 84289.5738  44.0%  3887 2704s
  2493  1886 infeasible   54      58529.2167 84287.2766  44.0%  3841 2756s
  2583  1910 82231.4096    7  341 58529.2167 83899.4896  43.3%  3864 2798s
H 2594  1910                    58544.389211 83899.4896  43.3%  3883 2798s
  2619  1957 81948.5905    8  383 58544.3892 83899.4896  43.3%  3918 2857s
  2731  2001 78782.3448    8  335 58544.3892 83607.4072  42.8%  3931 2919s
  2799  2063 74608.2856   10  348 58544.3892 83607.4072  42.8%  4005 2979s
  2883  2168 74319.6727   11  338 58544.3892 82831.9343  41.5%  4046 3044s
  2992  2246 70259.0018   13  242 58544.3892 82831.9343  41.5%  4095 3136s
  3080  2403 69742.8144   16  246 58544.3892 82831.9343  41.5%  4117 3205s
  3249  2574 68666.9908   20  270 58544.3892 82831.9343  41.5%  4087 3271s
H 3440  2562                    58703.462644 82831.9343  41.1%  4038 3306s
H 3440  2557                    58743.042760 82831.9343  41.0%  4038 3315s
H 3440  2533                    58954.202623 82831.9343  40.5%  4038 3317s
H 3440  2505                    59148.010531 82831.9343  40.0%  4038 3333s
  3441  2506 73245.8835   17  448 59148.0105 82831.9343  40.0%  4037 3443s
  3443  2507 70048.1026   30  119 59148.0105 82831.9343  40.0%  4035 3458s
  3444  2508 61791.3154   49  325 59148.0105 82831.9343  40.0%  4034 3558s

Cutting planes:
  Gomory: 29
  Implied bound: 45
  Projected implied bound: 113
  MIR: 711
  Mixing: 6
  Flow cover: 469
  RLT: 17
  Relax-and-lift: 108

Explored 3444 nodes (14514401 simplex iterations) in 3600.03 seconds (5195.68 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 59148 58954.2 58743 ... 56570.5

Time limit reached
Best objective 5.914801053100e+04, best bound 8.283193425387e+04, gap 40.0418%
  WARNING: Time limit reached. Using best solution found (gap: 40.04%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 59148.01, θ = 232892.78
  Upper Bound (UB) = 59148.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232892.78
  [DEBUG]   ✓ Scenario 0: θ = 232892.78 ≤ Q = 232892.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232892.78 ≤ Q = 232892.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 232892.78 ≤ Q = 232892.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 232892.78 ≤ Q = 232892.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 232892.78 ≤ Q = 232892.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 232892.78 ≤ Q = 232892.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 232892.78 ≤ Q = 232892.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 232892.78 ≤ Q = 232892.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 232892.78 ≤ Q = 232892.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 232892.78 ≤ Q = 232892.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5e9e5a8a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5e9e5a8a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.240037e+13
Presolve removed 2579 rows and 1868 columns
Presolve time: 0.01s
Presolved: 514 rows, 521 columns, 1456 nonzeros
Found heuristic solution: objective 5868905.6424
Variable types: 355 continuous, 166 integer (166 binary)

Root relaxation: objective -1.719724e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171972.43    0  123 5868905.64 -171972.43   103%     -    0s
H    0     0                    -139079.0948 -171972.43  23.7%     -    0s
H    0     0                    -140074.5596 -171972.43  22.8%     -    0s
     0     0 -156045.46    0   65 -140074.56 -156045.46  11.4%     -    0s
H    0     0                    -154253.4342 -155946.22  1.10%     -    0s
H    0     0                    -154558.0355 -155946.22  0.90%     -    0s
H    0     0                    -154737.9887 -155946.22  0.78%     -    0s
     0     0 -155090.48    0   40 -154737.99 -155090.48  0.23%     -    0s
     0     0 -154981.50    0   23 -154737.99 -154981.50  0.16%     -    0s
     0     0 -154951.00    0   18 -154737.99 -154951.00  0.14%     -    0s
     0     0 -154873.65    0   13 -154737.99 -154873.65  0.09%     -    0s
     0     0 -154804.51    0    6 -154737.99 -154804.51  0.04%     -    0s
     0     0 -154799.02    0    5 -154737.99 -154799.02  0.04%     -    0s
H    0     0                    -154777.7208 -154799.02  0.01%     -    0s

Cutting planes:
  MIR: 3
  Flow cover: 2
  RLT: 1
  PSD: 1

Explored 1 nodes (556 simplex iterations) in 0.13 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -154778 -154738 -154436 ... 1.24004e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.547777208262e+05, best bound -1.547889184001e+05, gap 0.0072%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 219893.53
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154777.72
  [DEBUG]   S×d_nominal = 374671.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374671.25 + -154777.72 = 219893.53
  [DEBUG]   Current θ from Master = 232892.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12999.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 46148.76
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 1555.9033, Absolute Gap = 1555.9033, Relative Gap = 0.026305
  Not converged yet (gap = 1555.90 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481159 nonzeros
Model fingerprint: 0x0664e227
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74537 rows and 30267 columns
Presolve time: 3.09s
Presolved: 95036 rows, 40633 columns, 576380 nonzeros
Variable types: 38374 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281858.9164
Found heuristic solution: objective -197811.2499

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.176e+06
 Factor NZ  : 9.164e+06 (roughly 130 MB of memory)
 Factor Ops : 1.631e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.63277761e+07  1.64689745e+08  1.24e+05 2.13e+01  7.90e+04     5s
   1  -1.22932350e+07  1.55259561e+08  8.73e+04 8.24e+01  5.48e+04     5s
   2  -5.84346825e+06  1.18607201e+08  4.21e+04 3.79e+00  2.77e+04     5s
   3  -1.17571724e+06  9.66948006e+07  3.74e+03 1.41e+00  2.94e+03     5s
   4  -7.01752858e+05  6.76386886e+07  6.16e+02 7.01e-01  7.58e+02     5s
   5  -5.26879202e+05  5.13263160e+07  3.71e+02 5.12e-01  5.06e+02     5s
   6  -3.36044838e+05  3.11778774e+07  1.07e+02 2.76e-01  2.34e+02     5s
   7  -2.89070875e+05  2.00299886e+07  6.53e+01 1.66e-01  1.44e+02     5s
   8  -1.84318979e+05  1.49346288e+07  1.42e+01 1.19e-01  9.18e+01     6s
   9  -1.35696414e+05  7.53397341e+06  7.04e+00 5.77e-02  4.55e+01     6s
  10  -7.39547525e+04  5.08015596e+06  3.24e+00 3.88e-02  3.00e+01     6s
  11  -1.30627797e+04  1.05737242e+06  5.30e-01 5.91e-03  6.16e+00     6s
  12   3.68594285e+03  4.43225459e+05  3.85e-01 2.48e-03  2.53e+00     6s
  13   2.94500623e+04  3.23537940e+05  2.17e-01 1.41e-03  1.69e+00     6s
  14   4.07427191e+04  2.48151737e+05  1.55e-01 1.17e-03  1.19e+00     6s
  15   4.84699421e+04  2.07641140e+05  1.27e-01 1.23e-03  9.15e-01     6s
  16   5.13232644e+04  1.69156927e+05  1.19e-01 2.12e-03  6.77e-01     6s
  17   5.24255462e+04  1.64646421e+05  1.16e-01 2.09e-03  6.45e-01     6s
  18   6.45959309e+04  1.56902235e+05  8.13e-02 1.71e-03  5.30e-01     6s
  19   6.58539325e+04  1.43412690e+05  7.80e-02 1.48e-03  4.46e-01     7s
  20   7.29606528e+04  1.37728338e+05  6.03e-02 1.15e-03  3.72e-01     7s
  21   7.70506632e+04  1.23334563e+05  4.99e-02 1.85e-03  2.66e-01     7s
  22   8.28280344e+04  1.18366679e+05  3.65e-02 1.46e-03  2.04e-01     7s
  23   8.56219353e+04  1.12684845e+05  3.03e-02 9.99e-04  1.55e-01     7s
  24   9.03163484e+04  1.09287895e+05  1.98e-02 8.92e-04  1.09e-01     7s
  25   9.20858505e+04  1.06106009e+05  1.60e-02 5.91e-04  8.05e-02     7s
  26   9.37301736e+04  1.05355591e+05  1.27e-02 4.67e-04  6.68e-02     7s
  27   9.51736949e+04  1.03645611e+05  9.85e-03 2.98e-04  4.87e-02     7s
  28   9.61998883e+04  1.03058122e+05  7.82e-03 2.39e-04  3.94e-02     8s
  29   9.76063868e+04  1.02668961e+05  5.24e-03 2.06e-04  2.91e-02     8s
  30   9.84185576e+04  1.02252158e+05  3.68e-03 1.66e-04  2.20e-02     8s
  31   9.90512596e+04  1.01782888e+05  2.51e-03 1.24e-04  1.57e-02     8s
  32   9.93344607e+04  1.01382703e+05  2.00e-03 8.60e-05  1.18e-02     8s
  33   9.95306499e+04  1.01187179e+05  1.65e-03 6.68e-05  9.51e-03     8s
  34   9.97642531e+04  1.00998665e+05  1.25e-03 4.71e-05  7.09e-03     8s
  35   9.99946685e+04  1.00875466e+05  8.74e-04 3.43e-05  5.06e-03     8s
  36   1.00096802e+05  1.00781933e+05  7.01e-04 4.56e-05  3.94e-03     9s
  37   1.00259862e+05  1.00667264e+05  4.38e-04 2.40e-05  2.34e-03     9s
  38   1.00327892e+05  1.00646248e+05  3.24e-04 2.03e-05  1.83e-03     9s
  39   1.00361156e+05  1.00614457e+05  2.71e-04 1.43e-05  1.45e-03     9s
  40   1.00405692e+05  1.00596000e+05  1.98e-04 1.09e-05  1.09e-03     9s
  41   1.00459064e+05  1.00571039e+05  1.08e-04 1.07e-05  6.43e-04     9s
  42   1.00492759e+05  1.00552106e+05  5.69e-05 5.03e-06  3.41e-04     9s
  43   1.00518299e+05  1.00545929e+05  2.08e-05 2.94e-06  1.59e-04     9s
  44   1.00523942e+05  1.00542552e+05  1.20e-05 2.20e-06  1.07e-04     9s
  45   1.00525755e+05  1.00539205e+05  9.63e-06 1.40e-06  7.72e-05    10s
  46   1.00527604e+05  1.00536521e+05  7.24e-06 7.64e-07  5.12e-05    10s
  47   1.00529180e+05  1.00535896e+05  5.10e-06 6.19e-07  3.86e-05    10s
  48   1.00532511e+05  1.00535179e+05  5.87e-07 4.45e-07  1.53e-05    10s
  49   1.00533194e+05  1.00533454e+05  2.42e-08 5.25e-08  1.49e-06    10s
  50   1.00533211e+05  1.00533380e+05  3.44e-08 3.68e-08  9.71e-07    10s
  51   1.00533211e+05  1.00533223e+05  9.75e-08 7.12e-10  6.94e-08    10s
  52   1.00533219e+05  1.00533220e+05  1.52e-06 7.97e-08  2.16e-09    11s

Barrier solved model in 52 iterations and 10.63 seconds (9.16 work units)
Optimal objective 1.00533219e+05


Root crossover log...

   85984 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   11044 PPushes remaining with PInf 6.9382167e-05                14s
    2771 PPushes remaining with PInf 4.9714733e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1335218e+04     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52596    1.0053322e+05   0.000000e+00   1.133522e+04     16s
   53332    1.0053322e+05   0.000000e+00   0.000000e+00     16s
   53332    1.0053322e+05   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.005332e+05, 53332 iterations, 12.32 seconds (15.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 100533.220    0  142 -197811.25 100533.220   151%     -   16s
H    0     0                    -196477.5208 100533.220   151%     -   16s
H    0     0                    -195746.0524 100533.220   151%     -   17s
H    0     0                    -178821.5029 100533.220   156%     -   17s
H    0     0                    -177883.1805 100533.220   157%     -   17s
H    0     0                    -177866.9376 100533.220   157%     -   17s
H    0     0                    -47233.62944 100533.220   313%     -   17s
H    0     0                    12678.419172 100533.220   693%     -   18s
H    0     0                    16150.785126 100533.220   522%     -   18s
H    0     0                    33440.841137 100533.220   201%     -   19s
H    0     0                    40681.142696 100533.220   147%     -   19s
H    0     0                    41140.060941 100533.220   144%     -   19s
H    0     0                    42788.712442 100533.220   135%     -   19s
H    0     0                    43152.164579 100533.220   133%     -   20s
H    0     0                    44221.998522 100533.220   127%     -   20s
H    0     0                    44880.329699 100533.220   124%     -   20s
H    0     0                    44894.511157 100533.220   124%     -   20s
H    0     0                    45192.536180 100533.220   122%     -   21s
H    0     0                    45200.587040 100533.220   122%     -   21s
H    0     0                    46582.131468 95158.5206   104%     -   89s
H    0     0                    48265.198411 95158.5206  97.2%     -   89s
H    0     0                    48586.398554 95158.5206  95.9%     -   89s
H    0     0                    48869.640164 95158.5206  94.7%     -   89s
     0     0 95158.5206    0  266 48869.6402 95158.5206  94.7%     -   90s
     0     0 94523.3731    0  278 48869.6402 94523.3731  93.4%     -  138s
     0     0 94455.3120    0  282 48869.6402 94455.3120  93.3%     -  155s
     0     0 94451.5627    0  287 48869.6402 94451.5627  93.3%     -  162s
     0     0 94451.5627    0  288 48869.6402 94451.5627  93.3%     -  164s
     0     0 94451.5627    0  290 48869.6402 94451.5627  93.3%     -  165s
H    0     0                    48877.426085 90647.3239  85.5%     -  255s
     0     0 90647.3239    0  279 48877.4261 90647.3239  85.5%     -  255s
H    0     0                    49815.995381 90647.2882  82.0%     -  256s
H    0     0                    50000.226646 90647.2882  81.3%     -  256s
     0     0 90196.3608    0  319 50000.2266 90196.3608  80.4%     -  294s
     0     0 89816.9507    0  331 50000.2266 89816.9507  79.6%     -  348s
     0     0 89660.5110    0  333 50000.2266 89660.5110  79.3%     -  367s
     0     0 89589.3138    0  323 50000.2266 89589.3138  79.2%     -  390s
     0     0 89532.1779    0  332 50000.2266 89532.1779  79.1%     -  407s
     0     0 89507.3782    0  336 50000.2266 89507.3782  79.0%     -  416s
     0     0 89488.0658    0  334 50000.2266 89488.0658  79.0%     -  424s
     0     0 89465.1349    0  330 50000.2266 89465.1349  78.9%     -  434s
     0     0 89403.1324    0  326 50000.2266 89403.1324  78.8%     -  452s
     0     0 89369.3998    0  349 50000.2266 89369.3998  78.7%     -  463s
     0     0 89355.9223    0  343 50000.2266 89355.9223  78.7%     -  469s
     0     0 89348.7361    0  345 50000.2266 89348.7361  78.7%     -  477s
     0     0 89346.5899    0  350 50000.2266 89346.5899  78.7%     -  480s
     0     0 89346.2397    0  345 50000.2266 89346.2397  78.7%     -  481s
     0     0 87600.9015    0  422 50000.2266 87600.9015  75.2%     -  590s
H    0     0                    50558.377393 87600.8420  73.3%     -  591s
H    0     0                    51195.187708 87271.0545  70.5%     -  634s
H    0     0                    54374.486884 87271.0545  60.5%     -  634s
H    0     0                    54500.254152 87271.0545  60.1%     -  634s
H    0     0                    54556.291740 87271.0545  60.0%     -  634s
H    0     0                    54916.900017 87271.0545  58.9%     -  634s
H    0     0                    54992.174235 87271.0545  58.7%     -  634s
     0     0 87271.0545    0  442 54992.1742 87271.0545  58.7%     -  634s
     0     0 87117.3204    0  455 54992.1742 87117.3204  58.4%     -  665s
     0     0 87076.5544    0  452 54992.1742 87076.5544  58.3%     -  682s
     0     0 87021.8230    0  459 54992.1742 87021.8230  58.2%     -  701s
     0     0 87001.8279    0  461 54992.1742 87001.8279  58.2%     -  712s
     0     0 86986.5710    0  460 54992.1742 86986.5710  58.2%     -  719s
     0     0 86949.6214    0  465 54992.1742 86949.6214  58.1%     -  736s
     0     0 86929.0232    0  461 54992.1742 86929.0232  58.1%     -  753s
     0     0 86915.1445    0  465 54992.1742 86915.1445  58.1%     -  762s
     0     0 86911.1748    0  464 54992.1742 86911.1748  58.0%     -  766s
     0     0 86884.1543    0  460 54992.1742 86884.1543  58.0%     -  776s
     0     0 86866.4000    0  467 54992.1742 86866.4000  58.0%     -  784s
     0     0 86858.0940    0  466 54992.1742 86858.0940  57.9%     -  790s
     0     0 86856.4950    0  472 54992.1742 86856.4950  57.9%     -  792s
H    0     0                    55115.505041 85867.7273  55.8%     -  877s
     0     0 85867.7273    0  394 55115.5050 85867.7273  55.8%     -  877s
     0     0 85725.8914    0  385 55115.5050 85725.8914  55.5%     -  909s
     0     0 85675.9053    0  395 55115.5050 85675.9053  55.4%     -  927s
     0     0 85649.1573    0  346 55115.5050 85649.1573  55.4%     -  945s
     0     0 85630.4455    0  349 55115.5050 85630.4455  55.4%     -  954s
     0     0 85605.4995    0  343 55115.5050 85605.4995  55.3%     -  963s
     0     0 85577.8148    0  350 55115.5050 85577.8148  55.3%     -  973s
     0     0 85576.4890    0  353 55115.5050 85576.4890  55.3%     -  977s
     0     0 85400.9307    0  478 55115.5050 85400.9307  54.9%     - 1004s
     0     0 85356.0043    0  396 55115.5050 85356.0043  54.9%     - 1017s
     0     0 85342.9045    0  487 55115.5050 85342.9045  54.8%     - 1027s
     0     0 85281.4721    0  497 55115.5050 85281.4721  54.7%     - 1043s
     0     0 85254.6956    0  370 55115.5050 85254.6956  54.7%     - 1056s
     0     0 85247.2907    0  491 55115.5050 85247.2907  54.7%     - 1064s
     0     0 85246.2020    0  493 55115.5050 85246.2020  54.7%     - 1069s
     0     0 85216.3078    0  404 55115.5050 85216.3078  54.6%     - 1085s
H    0     0                    55199.888293 85216.0860  54.4%     - 1088s
     0     0 85203.9396    0  401 55199.8883 85203.9396  54.4%     - 1099s
     0     0 85198.6514    0  407 55199.8883 85198.6514  54.3%     - 1106s
     0     0 85190.7511    0  396 55199.8883 85190.7511  54.3%     - 1112s
     0     0 85181.3644    0  405 55199.8883 85181.3644  54.3%     - 1117s
     0     0 85179.4381    0  399 55199.8883 85179.4381  54.3%     - 1120s
     0     0 85137.8340    0  415 55199.8883 85137.8340  54.2%     - 1137s
     0     0 85128.7330    0  478 55199.8883 85128.7330  54.2%     - 1149s
     0     0 85121.3331    0  480 55199.8883 85121.3331  54.2%     - 1156s
     0     0 85117.5735    0  485 55199.8883 85117.5735  54.2%     - 1160s
     0     0 85117.1800    0  485 55199.8883 85117.1800  54.2%     - 1162s
     0     0 85087.3928    0  490 55199.8883 85087.3928  54.1%     - 1174s
     0     0 85081.1009    0  367 55199.8883 85081.1009  54.1%     - 1181s
     0     0 85079.5549    0  355 55199.8883 85079.5549  54.1%     - 1184s
     0     0 85063.2485    0  358 55199.8883 85063.2485  54.1%     - 1196s
     0     0 85057.8209    0  361 55199.8883 85057.8209  54.1%     - 1201s
     0     0 85056.1196    0  359 55199.8883 85056.1196  54.1%     - 1203s
     0     0 85049.4635    0  366 55199.8883 85049.4635  54.1%     - 1211s
H    0     0                    55821.628782 85049.4091  52.4%     - 1221s
     0     0 85047.1787    0  360 55821.6288 85047.1787  52.4%     - 1228s
     0     0 85027.2634    0  368 55821.6288 85027.2634  52.3%     - 1238s
     0     0 85027.2374    0  368 55821.6288 85027.2374  52.3%     - 1241s
H    0     0                    55824.720018 85027.2128  52.3%     - 1488s
     0     2 85027.2128    0  368 55824.7200 85027.2128  52.3%     - 1492s
     1     3 84735.2920    1  344 55824.7200 85027.2128  52.3% 11871 1516s
     2     4 84965.1801    1  356 55824.7200 84965.1801  52.2%  8210 1531s
     3     6 84892.7346    2  398 55824.7200 84961.9257  52.2%  7641 1572s
     5     9 84636.4965    3  346 55824.7200 84961.9257  52.2% 11045 1625s
     8    17 84029.5424    4  345 55824.7200 84892.2318  52.1% 14503 1672s
    16    31 83955.1347    5  344 55824.7200 84589.8597  51.5% 13687 1745s
    30    45 81951.1176    5  343 55824.7200 84589.5201  51.5% 22242 1884s
    44    74 82854.2563    6  375 55824.7200 84566.4634  51.5% 20747 1981s
H   54    74                    56052.686400 84566.4634  50.9% 18918 1981s
H   57    74                    57929.918902 84566.4634  46.0% 18560 1981s
H   67    74                    58483.281169 84566.4634  44.6% 16708 1981s
    73   171 82849.2833    7  374 58483.2812 84566.4634  44.6% 16287 2182s
   170   279 82762.7100   10  364 58483.2812 84566.4634  44.6%  9441 2278s
H  175   279                    58488.459926 84566.4634  44.6%  9320 2278s
H  243   279                    58529.759350 84566.4634  44.5%  8236 2278s
   278   342 82280.5441   13  356 58529.7593 84566.4634  44.5%  8202 2341s
H  341   397                    58534.938107 84566.4634  44.5%  8073 2397s
H  387   397                    58683.246973 84566.4634  44.1%  7880 2398s
   396   459 81762.8440   16  342 58683.2470 84566.4634  44.1%  7864 2454s
   458   531 81439.9051   18  330 58683.2470 84566.4634  44.1%  7528 2508s
   530   593 81183.8135   21  319 58683.2470 84566.4634  44.1%  7134 2564s
   592   619 77672.9308   17  314 58683.2470 84566.4634  44.1%  6937 2611s
   618   648 81162.8771   22  323 58683.2470 84566.4634  44.1%  6901 2648s
   647   679 80702.3252   24  357 58683.2470 84566.4634  44.1%  6833 2692s
   678   714 80460.5765   25  346 58683.2470 84566.4634  44.1%  6795 2733s
   713   761 80307.4471   26  335 58683.2470 84566.4634  44.1%  6712 2769s
   760   821 80271.6638   27  337 58683.2470 84566.4634  44.1%  6529 2807s
   820   899 80244.9162   28  343 58683.2470 84566.4634  44.1%  6277 2845s
   898   969 80186.3790   29  332 58683.2470 84566.4634  44.1%  6028 2884s
   976  1067 75714.4457   30  293 58683.2470 84566.4634  44.1%  5858 2932s
  1078  1144 79471.9388   30  355 58683.2470 84566.3918  44.1%  5585 2984s
  1175  1199 78915.5398   31  355 58683.2470 84566.3918  44.1%  5435 3030s
  1271  1248 78316.8069   32  326 58683.2470 84306.2634  43.7%  5303 3090s
  1354  1289 60068.9528   46   87 58683.2470 84305.7135  43.7%  5223 3144s
  1425  1359 infeasible   50      58683.2470 84305.7135  43.7%  5178 3196s
  1525  1412 78189.7343   32  342 58683.2470 84305.7135  43.7%  5129 3252s
  1642  1460 77675.8620   33  347 58683.2470 84305.7135  43.7%  5013 3318s
  1760  1477 64187.8706   39  189 58683.2470 84305.7135  43.7%  4914 3385s
  1839  1551 72813.5039   34  305 58683.2470 83649.7302  42.5%  4948 3455s
  1937  1700 72558.0187   35  294 58683.2470 83649.7302  42.5%  4928 3526s
  2092  1857 70358.6208   37  238 58683.2470 83649.7302  42.5%  4830 3597s
  2289  1860 59508.2504   56  203 58683.2470 83649.7302  42.5%  4687 3600s

Cutting planes:
  Learned: 2
  Gomory: 8
  Implied bound: 236
  MIR: 2515
  Flow cover: 2093
  RLT: 88
  Relax-and-lift: 454

Explored 2304 nodes (11316638 simplex iterations) in 3600.05 seconds (5178.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 58683.2 58534.9 58529.8 ... 55199.9

Time limit reached
Best objective 5.868324697306e+04, best bound 8.364973015282e+04, gap 42.5445%
  WARNING: Time limit reached. Using best solution found (gap: 42.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 58683.25, θ = 237166.02
  Upper Bound (UB) = 58683.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 237166.02
  [DEBUG]   ✓ Scenario 0: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 237166.02 ≤ Q = 237166.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 237166.02 ≤ Q = 237166.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 237166.02 ≤ Q = 237166.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 237166.02 ≤ Q = 237166.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x729b6235
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8d649dcb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.252651e+13
Presolve removed 2578 rows and 1867 columns
Presolve time: 0.01s
Presolved: 515 rows, 522 columns, 1459 nonzeros
Found heuristic solution: objective 5939357.4226
Variable types: 356 continuous, 166 integer (166 binary)

Root relaxation: objective -1.678982e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167898.16    0  127 5939357.42 -167898.16   103%     -    0s
H    0     0                    -133724.4069 -167898.16  25.6%     -    0s
H    0     0                    -134919.3461 -167898.16  24.4%     -    0s
     0     0 -147261.98    0   88 -134919.35 -147261.98  9.15%     -    0s
H    0     0                    -145738.0871 -147256.48  1.04%     -    0s
H    0     0                    -146000.6838 -147256.48  0.86%     -    0s
     0     0 -147214.81    0   82 -146000.68 -147214.81  0.83%     -    0s
     0     0 -146528.39    0   65 -146000.68 -146528.39  0.36%     -    0s
     0     0 -146518.76    0   28 -146000.68 -146518.76  0.35%     -    0s
H    0     0                    -146289.1124 -146518.76  0.16%     -    0s
     0     0 -146508.21    0   28 -146289.11 -146508.21  0.15%     -    0s
H    0     0                    -146443.2283 -146506.94  0.04%     -    0s
     0     0 -146506.94    0   28 -146443.23 -146506.94  0.04%     -    0s
H    0     0                    -146495.9936 -146506.94  0.01%     -    0s

Cutting planes:
  Gomory: 19
  Implied bound: 8
  MIR: 120
  Flow cover: 11
  RLT: 43
  Relax-and-lift: 3
  BQP: 6

Explored 1 nodes (516 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -146496 -146443 -146289 ... 1.25265e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.464959936156e+05, best bound -1.465015838551e+05, gap 0.0038%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 228175.25
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146495.99
  [DEBUG]   S×d_nominal = 374671.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374671.25 + -146495.99 = 228175.25
  [DEBUG]   Current θ from Master = 237166.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8990.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 49692.48
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 1091.1397, Absolute Gap = 1091.1397, Relative Gap = 0.018594
  Not converged yet (gap = 1091.14 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524399 nonzeros
Model fingerprint: 0x9bea25e9
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81324 rows and 33024 columns
Presolve time: 3.15s
Presolved: 103539 rows, 44116 columns, 626987 nonzeros
Variable types: 41857 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -283284.7314
Found heuristic solution: objective -197811.2499

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 614
 AA' NZ     : 3.846e+06
 Factor NZ  : 8.923e+06 (roughly 130 MB of memory)
 Factor Ops : 1.660e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67905587e+07  1.77354641e+08  1.28e+05 2.05e+01  8.08e+04     5s
   1  -1.27041567e+07  1.67967204e+08  9.01e+04 8.13e+01  5.63e+04     5s
   2  -4.13501760e+06  1.30850396e+08  3.00e+04 1.02e+01  1.99e+04     5s
   3  -1.11846573e+06  1.03711095e+08  3.21e+03 1.73e+00  2.57e+03     5s
   4  -7.29522406e+05  6.37306901e+07  6.51e+02 7.70e-01  7.13e+02     5s
   5  -6.55888705e+05  6.08006962e+07  3.64e+02 7.28e-01  5.30e+02     5s
   6  -3.47873468e+05  3.61531149e+07  2.05e+02 3.89e-01  2.96e+02     6s
   7  -3.12017146e+05  2.68824019e+07  9.39e+01 2.74e-01  1.87e+02     6s
   8  -2.46270497e+05  1.68931583e+07  3.61e+01 1.59e-01  1.04e+02     6s
   9  -1.41960805e+05  1.27417461e+07  1.04e+01 1.16e-01  7.12e+01     6s
  10  -7.70032964e+04  6.53181960e+06  4.30e+00 5.79e-02  3.56e+01     6s
  11  -4.64120958e+04  4.30899946e+06  2.47e+00 3.71e-02  2.33e+01     6s
  12  -2.02582216e+04  2.26849866e+06  1.20e+00 1.88e-02  1.22e+01     6s
  13  -3.55635387e+03  6.01096450e+05  7.98e-01 4.50e-03  3.21e+00     6s
  14   2.58202058e+04  3.50600778e+05  4.63e-01 2.27e-03  1.72e+00     6s
  15   3.86399828e+04  2.76729751e+05  3.38e-01 1.71e-03  1.26e+00     6s
  16   4.60598131e+04  2.11564000e+05  2.80e-01 1.71e-03  8.76e-01     6s
  17   5.39100926e+04  1.88083673e+05  2.33e-01 2.08e-03  7.10e-01     7s
  18   5.49988848e+04  1.68766179e+05  2.27e-01 1.80e-03  6.02e-01     7s
  19   6.31871503e+04  1.57194929e+05  1.84e-01 1.49e-03  4.97e-01     7s
  20   6.93945020e+04  1.38692615e+05  1.49e-01 1.99e-03  3.67e-01     7s
  21   7.66244847e+04  1.31908591e+05  1.11e-01 1.60e-03  2.92e-01     7s
  22   7.95186257e+04  1.21746977e+05  9.67e-02 1.78e-03  2.23e-01     7s
  23   8.37340573e+04  1.15313979e+05  7.58e-02 1.51e-03  1.67e-01     7s
  24   8.79213517e+04  1.11952294e+05  5.49e-02 2.89e-03  1.27e-01     7s
  25   8.99030321e+04  1.08239645e+05  4.55e-02 3.55e-03  9.70e-02     7s
  26   9.31524760e+04  1.06478069e+05  3.05e-02 3.66e-03  7.05e-02     7s
  27   9.37826031e+04  1.06057438e+05  2.78e-02 3.41e-03  6.49e-02     7s
  28   9.52470373e+04  1.04568153e+05  2.16e-02 2.56e-03  4.93e-02     8s
  29   9.57934611e+04  1.04185002e+05  1.92e-02 2.32e-03  4.44e-02     8s
  30   9.64371086e+04  1.03951425e+05  1.64e-02 2.18e-03  3.97e-02     8s
  31   9.72778123e+04  1.02482970e+05  1.28e-02 1.26e-03  2.75e-02     8s
  32   9.75333221e+04  1.01928032e+05  1.17e-02 9.17e-04  2.33e-02     8s
  33   9.81809733e+04  1.01490507e+05  9.05e-03 6.36e-04  1.75e-02     8s
  34   9.86470095e+04  1.01388947e+05  7.17e-03 5.66e-04  1.45e-02     8s
  35   9.88910321e+04  1.01179474e+05  6.20e-03 4.28e-04  1.21e-02     8s
  36   9.93244872e+04  1.00910289e+05  4.49e-03 2.45e-04  8.39e-03     8s
  37   9.95970568e+04  1.00858055e+05  3.45e-03 2.09e-04  6.67e-03     9s
  38   9.98728694e+04  1.00762954e+05  2.39e-03 1.48e-04  4.71e-03     9s
  39   9.99618141e+04  1.00720327e+05  2.06e-03 1.20e-04  4.01e-03     9s
  40   1.00031432e+05  1.00652335e+05  1.79e-03 9.97e-05  3.29e-03     9s
  41   1.00246123e+05  1.00627302e+05  1.01e-03 7.75e-05  2.02e-03     9s
  42   1.00290443e+05  1.00612012e+05  8.58e-04 6.37e-05  1.70e-03     9s
  43   1.00338723e+05  1.00583073e+05  6.81e-04 4.89e-05  1.29e-03     9s
  44   1.00387553e+05  1.00566814e+05  5.01e-04 3.29e-05  9.49e-04    10s
  45   1.00461697e+05  1.00553936e+05  2.37e-04 2.02e-05  4.88e-04    10s
  46   1.00501458e+05  1.00548852e+05  9.42e-05 1.49e-05  2.51e-04    10s
  47   1.00512894e+05  1.00543423e+05  5.90e-05 9.76e-06  1.61e-04    10s
  48   1.00514903e+05  1.00542512e+05  5.28e-05 8.89e-06  1.46e-04    10s
  49   1.00521145e+05  1.00537897e+05  3.42e-05 4.57e-06  8.86e-05    10s
  50   1.00525864e+05  1.00535278e+05  2.05e-05 1.91e-06  4.98e-05    10s
  51   1.00527313e+05  1.00533978e+05  1.63e-05 7.02e-07  3.52e-05    10s
  52   1.00531594e+05  1.00533681e+05  4.19e-06 4.21e-07  1.10e-05    10s
  53   1.00533136e+05  1.00533380e+05  1.68e-07 1.44e-07  1.29e-06    11s
  54   1.00533212e+05  1.00533285e+05  1.39e-08 5.72e-08  3.85e-07    11s
  55   1.00533217e+05  1.00533236e+05  8.89e-09 1.44e-08  1.01e-07    11s
  56   1.00533220e+05  1.00533220e+05  1.29e-09 6.95e-11  6.96e-10    11s

Barrier solved model in 56 iterations and 11.15 seconds (9.98 work units)
Optimal objective 1.00533220e+05


Root crossover log...

   93577 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    2088 PPushes remaining with PInf 1.2244130e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.9281282e+00     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42124    1.0053322e+05   0.000000e+00   8.928128e+00     15s
   42138    1.0053322e+05   0.000000e+00   0.000000e+00     15s
   42138    1.0053322e+05   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.005332e+05, 42138 iterations, 11.38 seconds (13.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 100533.220    0  142 -197811.25 100533.220   151%     -   15s
H    0     0                    -195968.3181 100533.220   151%     -   15s
H    0     0                    -190955.2978 100533.220   153%     -   16s
H    0     0                    -177405.7024 100533.220   157%     -   16s
H    0     0                    -162721.5956 100533.220   162%     -   17s
H    0     0                    -161647.4777 100533.220   162%     -   17s
H    0     0                    -154037.3851 100533.220   165%     -   18s
H    0     0                    -153835.3083 100533.220   165%     -   18s
H    0     0                    26835.277473 100533.220   275%     -   18s
H    0     0                    28168.897187 100533.220   257%     -   18s
     0     0 95431.6174    0  279 28168.8972 95431.6174   239%     -   99s
H    0     0                    28376.831578 95431.4536   236%     -  101s
H    0     0                    28563.917612 95431.4536   234%     -  101s
H    0     0                    29862.916431 95431.4536   220%     -  101s
H    0     0                    41391.900867 94984.4979   129%     -  159s
     0     0 94984.4979    0  288 41391.9009 94984.4979   129%     -  159s
H    0     0                    41556.929707 94702.3504   128%     -  188s
     0     0 94702.3504    0  275 41556.9297 94702.3504   128%     -  188s
     0     0 94566.4464    0  289 41556.9297 94566.4464   128%     -  216s
     0     0 94557.5356    0  285 41556.9297 94557.5356   128%     -  221s
     0     0 94532.7838    0  278 41556.9297 94532.7838   127%     -  224s
     0     0 94532.7838    0  278 41556.9297 94532.7838   127%     -  226s
     0     0 94527.6565    0  278 41556.9297 94527.6565   127%     -  227s
     0     0 91723.6160    0  237 41556.9297 91723.6160   121%     -  329s
H    0     0                    41652.833781 91723.5838   120%     -  330s
H    0     0                    41721.516351 91723.5838   120%     -  330s
H    0     0                    42112.123725 91723.5838   118%     -  330s
H    0     0                    42330.163876 91723.5838   117%     -  330s
H    0     0                    42464.236653 91723.5838   116%     -  330s
H    0     0                    43176.238095 91723.5838   112%     -  330s
H    0     0                    43376.338725 91723.5838   111%     -  330s
     0     0 90794.4827    0  363 43376.3387 90794.4827   109%     -  419s
     0     0 90521.5283    0  357 43376.3387 90521.5283   109%     -  456s
     0     0 90385.2851    0  368 43376.3387 90385.2851   108%     -  489s
H    0     0                    44638.670606 90327.5968   102%     -  505s
H    0     0                    44653.715039 90327.5968   102%     -  505s
H    0     0                    44938.605484 90327.5968   101%     -  505s
H    0     0                    45094.321028 90327.5968   100%     -  505s
H    0     0                    45240.463541 90327.5968   100%     -  505s
H    0     0                    45461.755666 90327.5968  98.7%     -  505s
H    0     0                    45728.414991 90327.5968  97.5%     -  505s
H    0     0                    46520.750400 90327.5968  94.2%     -  505s
     0     0 90327.5968    0  366 46520.7504 90327.5968  94.2%     -  505s
     0     0 90311.5606    0  378 46520.7504 90311.5606  94.1%     -  516s
     0     0 90270.5400    0  369 46520.7504 90270.5400  94.0%     -  536s
     0     0 90183.3765    0  357 46520.7504 90183.3765  93.9%     -  566s
     0     0 90171.6986    0  370 46520.7504 90171.6986  93.8%     -  572s
     0     0 90167.7972    0  367 46520.7504 90167.7972  93.8%     -  576s
     0     0 90165.8299    0  368 46520.7504 90165.8299  93.8%     -  579s
     0     0 90165.5215    0  367 46520.7504 90165.5215  93.8%     -  581s
H    0     0                    47977.698028 88168.9218  83.8%     -  722s
H    0     0                    48100.443200 88168.9218  83.3%     -  722s
     0     0 88168.9218    0  380 48100.4432 88168.9218  83.3%     -  722s
H    0     0                    48604.583371 88168.6517  81.4%     -  723s
H    0     0                    48809.401161 88168.6517  80.6%     -  723s
H    0     0                    48994.260615 88168.6517  80.0%     -  724s
     0     0 87700.9519    0  386 48994.2606 87700.9519  79.0%     -  780s
H    0     0                    50439.053283 87541.9126  73.6%     -  815s
H    0     0                    52848.097570 87541.9126  65.6%     -  815s
H    0     0                    52857.627483 87541.9126  65.6%     -  815s
H    0     0                    52859.171235 87541.9126  65.6%     -  815s
H    0     0                    53270.484083 87541.9126  64.3%     -  815s
H    0     0                    53301.407124 87541.9126  64.2%     -  815s
H    0     0                    54145.892163 87541.9126  61.7%     -  815s
H    0     0                    54163.832492 87541.9126  61.6%     -  815s
     0     0 87541.9126    0  389 54163.8325 87541.9126  61.6%     -  815s
H    0     0                    54180.796544 87480.4666  61.5%     -  834s
H    0     0                    54232.369619 87480.4666  61.3%     -  834s
H    0     0                    54360.799468 87480.4666  60.9%     -  834s
     0     0 87480.4666    0  397 54360.7995 87480.4666  60.9%     -  834s
H    0     0                    54775.351611 87430.2218  59.6%     -  858s
     0     0 87430.2218    0  441 54775.3516 87430.2218  59.6%     -  858s
     0     0 87363.5097    0  384 54775.3516 87363.5097  59.5%     -  881s
     0     0 87311.3724    0  394 54775.3516 87311.3724  59.4%     -  907s
     0     0 87279.9215    0  405 54775.3516 87279.9215  59.3%     -  924s
     0     0 87271.7170    0  405 54775.3516 87271.7170  59.3%     -  934s
     0     0 87268.5180    0  400 54775.3516 87268.5180  59.3%     -  944s
     0     0 87260.6356    0  394 54775.3516 87260.6356  59.3%     -  951s
     0     0 87254.2000    0  400 54775.3516 87254.2000  59.3%     -  959s
     0     0 87217.2513    0  394 54775.3516 87217.2513  59.2%     -  978s
     0     0 87204.7812    0  391 54775.3516 87204.7812  59.2%     -  988s
     0     0 87195.0915    0  412 54775.3516 87195.0915  59.2%     -  996s
     0     0 87192.8935    0  412 54775.3516 87192.8935  59.2%     - 1001s
     0     0 87191.7039    0  410 54775.3516 87191.7039  59.2%     - 1003s
     0     0 86268.2309    0  392 54775.3516 86268.2309  57.5%     - 1132s
H    0     0                    54876.429600 86268.2084  57.2%     - 1132s
H    0     0                    54924.538940 86268.2084  57.1%     - 1132s
H    0     0                    55132.710481 86268.2084  56.5%     - 1132s
     0     0 86061.3809    0  400 55132.7105 86061.3809  56.1%     - 1170s
     0     0 85920.7774    0  414 55132.7105 85920.7774  55.8%     - 1203s
     0     0 85886.1785    0  453 55132.7105 85886.1785  55.8%     - 1222s
     0     0 85858.9657    0  424 55132.7105 85858.9657  55.7%     - 1235s
     0     0 85767.8086    0  462 55132.7105 85767.8086  55.6%     - 1257s
     0     0 85748.6553    0  464 55132.7105 85748.6553  55.5%     - 1266s
     0     0 85741.6710    0  402 55132.7105 85741.6710  55.5%     - 1272s
     0     0 85726.6191    0  413 55132.7105 85726.6191  55.5%     - 1284s
     0     0 85702.8443    0  391 55132.7105 85702.8443  55.4%     - 1295s
     0     0 85693.5838    0  410 55132.7105 85693.5838  55.4%     - 1302s
     0     0 85690.6825    0  417 55132.7105 85690.6825  55.4%     - 1310s
     0     0 85674.8140    0  418 55132.7105 85674.8140  55.4%     - 1324s
     0     0 85662.6816    0  360 55132.7105 85662.6816  55.4%     - 1334s
     0     0 85659.8466    0  463 55132.7105 85659.8466  55.4%     - 1341s
     0     0 85658.7997    0  465 55132.7105 85658.7997  55.4%     - 1346s
     0     0 85519.6108    0  408 55132.7105 85519.6108  55.1%     - 1379s
H    0     0                    55203.897829 85519.5551  54.9%     - 1380s
H    0     0                    55402.551379 85519.5551  54.4%     - 1381s
H    0     0                    55539.770809 85519.5551  54.0%     - 1381s
     0     0 85457.5689    0  417 55539.7708 85457.5689  53.9%     - 1400s
     0     0 85431.1070    0  407 55539.7708 85431.1070  53.8%     - 1418s
     0     0 85419.3605    0  434 55539.7708 85419.3605  53.8%     - 1427s
     0     0 85412.8891    0  370 55539.7708 85412.8891  53.8%     - 1434s
H    0     0                    55590.420121 85405.9030  53.6%     - 1441s
     0     0 85405.9030    0  443 55590.4201 85405.9030  53.6%     - 1441s
     0     0 85392.9089    0  462 55590.4201 85392.9089  53.6%     - 1450s
     0     0 85390.6289    0  392 55590.4201 85390.6289  53.6%     - 1456s
     0     0 85388.7954    0  401 55590.4201 85388.7954  53.6%     - 1461s
H    0     0                    55602.065682 85388.7954  53.6%     - 1463s
H    0     0                    55630.193563 85388.7954  53.5%     - 1463s
     0     0 85316.7930    0  407 55630.1936 85316.7930  53.4%     - 1482s
     0     0 85268.6364    0  395 55630.1936 85268.6364  53.3%     - 1506s
     0     0 85258.6200    0  410 55630.1936 85258.6200  53.3%     - 1515s
     0     0 85256.7197    0  398 55630.1936 85256.7197  53.3%     - 1517s
     0     0 85223.4059    0  355 55630.1936 85223.4059  53.2%     - 1536s
     0     0 85205.0353    0  431 55630.1936 85205.0353  53.2%     - 1552s
     0     0 85197.3804    0  462 55630.1936 85197.3804  53.1%     - 1561s
     0     0 85188.2815    0  475 55630.1936 85188.2815  53.1%     - 1568s
     0     0 85187.3637    0  471 55630.1936 85187.3637  53.1%     - 1573s
     0     0 85160.0810    0  390 55630.1936 85160.0810  53.1%     - 1593s
     0     0 85137.4930    0  379 55630.1936 85137.4930  53.0%     - 1611s
     0     0 85130.5623    0  376 55630.1936 85130.5623  53.0%     - 1619s
     0     0 85117.3070    0  392 55630.1936 85117.3070  53.0%     - 1630s
     0     0 85114.0564    0  378 55630.1936 85114.0564  53.0%     - 1636s
     0     0 85106.9962    0  379 55630.1936 85106.9962  53.0%     - 1639s
     0     0 85103.2997    0  483 55630.1936 85103.2997  53.0%     - 1643s
     0     0 85100.8028    0  478 55630.1936 85100.8028  53.0%     - 1647s
     0     0 85099.1805    0  476 55630.1936 85099.1805  53.0%     - 1649s
     0     0 85076.6924    0  443 55630.1936 85076.6924  52.9%     - 1663s
     0     0 85057.2723    0  384 55630.1936 85057.2723  52.9%     - 1679s
     0     0 85054.1164    0  427 55630.1936 85054.1164  52.9%     - 1683s
     0     0 85051.8075    0  385 55630.1936 85051.8075  52.9%     - 1685s
     0     0 85038.1672    0  380 55630.1936 85038.1672  52.9%     - 1692s
H    0     0                    56026.025328 85037.9493  51.8%     - 1697s
     0     0 85035.9429    0  377 56026.0253 85035.9429  51.8%     - 1704s
     0     0 85023.0194    0  376 56026.0253 85023.0194  51.8%     - 1713s
H    0     0                    56043.363679 85022.6799  51.7%     - 1714s
     0     0 85005.1931    0  375 56043.3637 85005.1931  51.7%     - 1724s
     0     0 84998.7602    0  377 56043.3637 84998.7602  51.7%     - 1731s
     0     0 84995.5971    0  442 56043.3637 84995.5971  51.7%     - 1738s
     0     0 84995.1116    0  375 56043.3637 84995.1116  51.7%     - 1742s
     0     0 84989.6422    0  442 56043.3637 84989.6422  51.6%     - 1748s
     0     0 84986.9371    0  380 56043.3637 84986.9371  51.6%     - 1762s
     0     0 84986.2136    0  382 56043.3637 84986.2136  51.6%     - 1765s
     0     0 84976.1740    0  387 56043.3637 84976.1740  51.6%     - 1780s
     0     0 84973.8009    0  489 56043.3637 84973.8009  51.6%     - 1787s
     0     0 84965.3053    0  384 56043.3637 84965.3053  51.6%     - 1795s
H    0     0                    56071.752421 84965.1519  51.5%     - 1917s
H    0     0                    57170.042085 84965.1519  48.6%     - 1949s
     0     0 84962.9797    0  389 57170.0421 84962.9797  48.6%     - 1970s
     0     0 84957.1592    0  389 57170.0421 84957.1592  48.6%     - 1980s
     0     0 84957.1150    0  389 57170.0421 84957.1150  48.6%     - 1983s
H    0     0                    57276.198438 84957.1026  48.3%     - 2316s
H    0     0                    57859.527151 84957.1026  46.8%     - 2316s
H    0     0                    57903.157698 84957.1026  46.7%     - 2328s
H    0     0                    58541.938808 84957.1026  45.1%     - 2332s
     0     2 84957.1026    0  389 58541.9388 84957.1026  45.1%     - 2335s
     1     3 84223.3740    1  339 58541.9388 84957.0445  45.1% 20854 2383s
     2     4 84717.5020    1  368 58541.9388 84717.5020  44.7% 17116 2410s
     3     6 84589.0073    2  355 58541.9388 84717.1451  44.7% 15107 2457s
     5    10 84506.5106    3  455 58541.9388 84717.1451  44.7% 15845 2512s
     9    19 82814.0296    3  347 58541.9388 84588.9041  44.5% 14404 2605s
    18    37 82605.5705    4  379 58541.9388 84506.1736  44.4% 15055 2668s
    36    50 82166.9486    5  362 58541.9388 84279.9636  44.0% 21323 2841s
H   49    76                    58554.836535 84279.9636  43.9% 23368 2937s
    75   208 82017.2538    7  340 58554.8365 84180.0587  43.8% 18495 3027s
   207   239 81664.8040   12  328 58554.8365 84180.0587  43.8%  9778 3062s
H  235   239                    58644.994412 84180.0587  43.5%  9877 3062s
   238   266 81611.7496   13  322 58644.9944 84180.0587  43.5%  9928 3099s
   265   292 81563.2087   14  333 58644.9944 84180.0587  43.5%  9519 3138s
H  268   292                    58725.927293 84180.0587  43.3%  9484 3138s
   291   332 81210.7258   15  330 58725.9273 84180.0587  43.3%  9230 3188s
   331   361 81052.4906   16  329 58725.9273 84180.0587  43.3%  8802 3228s
H  341   361                    58826.596285 84180.0587  43.1%  8831 3228s
H  342   361                    59014.447716 84180.0587  42.6%  8817 3228s
   360   418 81019.2878   17  322 59014.4477 84180.0587  42.6%  8796 3276s
H  417   468                    59044.143031 84180.0587  42.6%  8265 3318s
H  420   468                    59334.087912 84180.0587  41.9%  8238 3318s
   467   518 80551.0604   21  388 59334.0879 84180.0587  41.9%  7873 3368s
   517   554 80489.7329   22  313 59334.0879 84180.0587  41.9%  7687 3415s
   553   605 80059.5651   23  320 59334.0879 84180.0587  41.9%  7560 3465s
   604   631 79717.1673   25  362 59334.0879 84180.0587  41.9%  7376 3512s
   630   670 79315.5828   26  295 59334.0879 84180.0587  41.9%  7335 3573s
   669   697 79315.5393   27  294 59334.0879 84180.0587  41.9%  7153 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 199
  MIR: 2671
  Flow cover: 2281
  RLT: 73
  Relax-and-lift: 674

Explored 696 nodes (5652520 simplex iterations) in 3600.07 seconds (4798.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 59334.1 59044.1 59014.4 ... 57859.5

Time limit reached
Best objective 5.933408791245e+04, best bound 8.418005873704e+04, gap 41.8747%
  WARNING: Time limit reached. Using best solution found (gap: 41.87%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 59334.09, θ = 234200.45
  Upper Bound (UB) = 59334.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 234200.45
  [DEBUG]   ✓ Scenario 0: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 234200.45 ≤ Q = 234200.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 234200.45 ≤ Q = 234200.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 234200.45 ≤ Q = 234200.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 234200.45 ≤ Q = 234200.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 234200.45 ≤ Q = 234200.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6675d577
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x998a2a89
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247505e+13
Presolve removed 2579 rows and 1868 columns
Presolve time: 0.01s
Presolved: 514 rows, 521 columns, 1456 nonzeros
Found heuristic solution: objective 5934348.4723
Variable types: 355 continuous, 166 integer (166 binary)

Root relaxation: objective -1.707063e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -170706.30    0  127 5934348.47 -170706.30   103%     -    0s
H    0     0                    -136654.4552 -170706.30  24.9%     -    0s
H    0     0                    -137850.3855 -170706.30  23.8%     -    0s
H    0     0                    -142422.6304 -151032.92  6.05%     -    0s
     0     0 -151032.92    0   78 -142422.63 -151032.92  6.05%     -    0s
H    0     0                    -148315.5180 -150992.83  1.81%     -    0s
     0     0 -150992.83    0   90 -148315.52 -150992.83  1.81%     -    0s
H    0     0                    -149491.3382 -150992.83  1.00%     -    0s
     0     0 -150992.83    0   73 -149491.34 -150992.83  1.00%     -    0s
     0     0 -150008.12    0   52 -149491.34 -150008.12  0.35%     -    0s
     0     0 -149964.86    0   36 -149491.34 -149964.86  0.32%     -    0s
     0     0 -149887.03    0   36 -149491.34 -149887.03  0.26%     -    0s
     0     0 -149867.86    0   35 -149491.34 -149867.86  0.25%     -    0s
     0     0 -149796.05    0   32 -149491.34 -149796.05  0.20%     -    0s
     0     0 -149786.06    0   32 -149491.34 -149786.06  0.20%     -    0s
     0     0 -149755.60    0   30 -149491.34 -149755.60  0.18%     -    0s
     0     0 -149730.65    0   30 -149491.34 -149730.65  0.16%     -    0s
     0     0 -149730.46    0   65 -149491.34 -149730.46  0.16%     -    0s
     0     0 -149730.46    0   36 -149491.34 -149730.46  0.16%     -    0s
H    0     0                    -149511.7154 -149730.46  0.15%     -    0s
     0     0 -149730.46    0   31 -149511.72 -149730.46  0.15%     -    0s
     0     0 -149730.46    0   30 -149511.72 -149730.46  0.15%     -    0s
     0     0 -149725.92    0   31 -149511.72 -149725.92  0.14%     -    0s
     0     0 -149716.17    0   31 -149511.72 -149716.17  0.14%     -    0s
     0     0 -149716.17    0   30 -149511.72 -149716.17  0.14%     -    0s
     0     0 -149716.17    0   30 -149511.72 -149716.17  0.14%     -    0s
H    0     0                    -149693.6209 -149716.17  0.02%     -    0s
     0     0 -149712.70    0   25 -149693.62 -149712.70  0.01%     -    0s
     0     0 -149712.70    0    5 -149693.62 -149712.70  0.01%     -    0s
     0     0          -    0      -149693.62 -149694.59  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 10
  MIR: 20
  Flow cover: 1
  RLT: 3
  Relax-and-lift: 1

Explored 1 nodes (972 simplex iterations) in 0.29 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -149694 -149512 -149491 ... 5.93435e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.496936209403e+05, best bound -1.496945932221e+05, gap 0.0006%
  Subproblem solved in 0.32s
  Worst-case operational profit (Z_SP) = 224977.63
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149693.62
  [DEBUG]   S×d_nominal = 374671.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374671.25 + -149693.62 = 224977.63
  [DEBUG]   Current θ from Master = 234200.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9222.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 50111.26
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 1741.9806, Absolute Gap = 1741.9806, Relative Gap = 0.029359
  Not converged yet (gap = 1741.98 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567639 nonzeros
Model fingerprint: 0xc75a1d07
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 88111 rows and 35781 columns
Presolve time: 3.91s
Presolved: 112042 rows, 47599 columns, 676484 nonzeros
Variable types: 45340 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -287680.9662
Found heuristic solution: objective -197811.2499

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 614
 AA' NZ     : 4.326e+06
 Factor NZ  : 1.063e+07 (roughly 150 MB of memory)
 Factor Ops : 2.662e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72241486e+07  1.90055558e+08  1.31e+05 2.02e+01  8.24e+04     6s
   1  -1.30873924e+07  1.80886833e+08  9.24e+04 8.09e+01  5.74e+04     6s
   2  -4.49206409e+06  1.42575405e+08  3.24e+04 6.24e-01  2.16e+04     6s
   3  -7.62493677e+05  1.09647379e+08  1.77e+03 1.53e+00  1.66e+03     6s
   4  -4.99142851e+05  4.38719492e+07  4.83e+02 2.90e-01  4.85e+02     6s
   5  -3.37416672e+05  2.94406643e+07  1.47e+02 1.76e-01  2.20e+02     6s
   6  -2.80476512e+05  2.04353009e+07  7.27e+01 1.12e-01  1.33e+02     6s
   7  -1.98475462e+05  1.51905385e+07  2.96e+01 7.97e-02  8.61e+01     7s
   8  -1.19071899e+05  1.05247326e+07  6.72e+00 5.31e-02  5.39e+01     7s
   9  -7.55675785e+04  3.28476937e+06  3.32e+00 1.49e-02  1.68e+01     7s
  10  -9.51962138e+03  1.25995195e+06  9.46e-01 5.28e-03  6.24e+00     7s
  11   5.24742007e+03  5.26129378e+05  7.27e-01 1.87e-03  2.56e+00     7s
  12   2.57015585e+04  3.34832819e+05  4.65e-01 1.50e-03  1.51e+00     7s
  13   3.59907949e+04  2.55258854e+05  3.52e-01 1.26e-03  1.07e+00     7s
  14   4.70124853e+04  2.15475306e+05  2.50e-01 1.85e-03  8.24e-01     7s
  15   6.00566660e+04  1.78628833e+05  1.67e-01 2.05e-03  5.80e-01     7s
  16   6.87807449e+04  1.44664387e+05  1.27e-01 1.62e-03  3.71e-01     8s
  17   7.39346292e+04  1.30949755e+05  1.05e-01 2.29e-03  2.79e-01     8s
  18   7.85396393e+04  1.21821137e+05  8.56e-02 1.80e-03  2.12e-01     8s
  19   8.13668481e+04  1.18676998e+05  7.45e-02 1.76e-03  1.82e-01     8s
  20   8.69910214e+04  1.15591238e+05  5.26e-02 1.47e-03  1.40e-01     8s
  21   8.97390128e+04  1.11295887e+05  4.15e-02 1.58e-03  1.05e-01     8s
  22   9.11156509e+04  1.08690757e+05  3.59e-02 1.54e-03  8.60e-02     8s
  23   9.25115657e+04  1.07360745e+05  3.05e-02 1.32e-03  7.26e-02     8s
  24   9.38387259e+04  1.05735378e+05  2.54e-02 9.82e-04  5.82e-02     8s
  25   9.52147163e+04  1.04719865e+05  2.03e-02 7.60e-04  4.65e-02     9s
  26   9.67813142e+04  1.04024281e+05  1.46e-02 5.23e-04  3.54e-02     9s
  27   9.76747279e+04  1.02930317e+05  1.14e-02 3.31e-04  2.57e-02     9s
  28   9.81437267e+04  1.02362115e+05  9.78e-03 2.31e-04  2.06e-02     9s
  29   9.88728164e+04  1.02131477e+05  7.30e-03 1.95e-04  1.59e-02     9s
  30   9.93494659e+04  1.01877198e+05  5.68e-03 1.45e-04  1.24e-02     9s
  31   9.97823515e+04  1.01643687e+05  4.23e-03 9.88e-05  9.10e-03     9s
  32   1.00142148e+05  1.01544124e+05  3.01e-03 8.03e-05  6.86e-03    10s
  33   1.00458409e+05  1.01377326e+05  1.97e-03 4.95e-05  4.49e-03    10s
  34   1.00643257e+05  1.01261554e+05  1.39e-03 2.73e-05  3.02e-03    10s
  35   1.00750546e+05  1.01182829e+05  1.05e-03 3.51e-05  2.11e-03    10s
  36   1.00861838e+05  1.01157838e+05  7.06e-04 2.40e-05  1.45e-03    10s
  37   1.00942172e+05  1.01145624e+05  4.64e-04 1.84e-05  9.95e-04    10s
  38   1.01002409e+05  1.01129096e+05  2.84e-04 1.13e-05  6.20e-04    10s
  39   1.01038145e+05  1.01124064e+05  1.75e-04 9.03e-06  4.20e-04    11s
  40   1.01054140e+05  1.01118756e+05  1.30e-04 6.74e-06  3.16e-04    11s
  41   1.01062253e+05  1.01111972e+05  1.07e-04 3.80e-06  2.43e-04    11s
  42   1.01077650e+05  1.01107116e+05  6.50e-05 1.75e-06  1.44e-04    11s
  43   1.01091935e+05  1.01105472e+05  2.70e-05 1.06e-06  6.62e-05    11s
  44   1.01093116e+05  1.01104595e+05  2.39e-05 6.97e-07  5.61e-05    11s
  45   1.01095333e+05  1.01103538e+05  1.84e-05 2.44e-07  4.01e-05    12s
  46   1.01101163e+05  1.01103246e+05  3.60e-06 1.41e-07  1.02e-05    12s
  47   1.01101990e+05  1.01102799e+05  1.70e-06 2.86e-09  3.96e-06    12s
  48   1.01102509e+05  1.01102788e+05  5.48e-07 7.89e-09  1.36e-06    12s
  49   1.01102683e+05  1.01102777e+05  1.70e-07 4.14e-09  4.60e-07    12s
  50   1.01102696e+05  1.01102774e+05  5.71e-07 5.33e-08  3.80e-07    12s
  51   1.01102700e+05  1.01102774e+05  3.19e-06 5.33e-08  3.63e-07    13s
  52   1.01102727e+05  1.01102772e+05  2.18e-06 7.48e-08  2.18e-07    13s
  53   1.01102758e+05  1.01102771e+05  4.23e-06 4.74e-07  6.61e-08    13s
  54   1.01102763e+05  1.01102771e+05  2.38e-06 3.19e-07  3.80e-08    13s
  55   1.01102764e+05  1.01102771e+05  2.12e-06 6.56e-07  3.30e-08    13s
  56   1.01102765e+05  1.01102771e+05  1.94e-06 5.42e-07  2.95e-08    13s
  57   1.01102767e+05  1.01102771e+05  4.97e-06 6.15e-07  1.63e-08    14s
  58   1.01102768e+05  1.01102770e+05  4.39e-06 3.33e-07  1.27e-08    14s
  59   1.01102769e+05  1.01102770e+05  2.87e-06 1.46e-07  6.29e-09    14s
  60   1.01102770e+05  1.01102770e+05  3.18e-06 7.99e-08  2.58e-09    14s

Barrier solved model in 60 iterations and 14.07 seconds (11.65 work units)
Optimal objective 1.01102770e+05


Root crossover log...

   99218 DPushes remaining with DInf 0.0000000e+00                14s
   40529 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   20490 PPushes remaining with PInf 1.1995687e-04                19s
    7820 PPushes remaining with PInf 1.0438958e-04                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.3236073e+04     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68380    1.0110277e+05   0.000000e+00   5.323607e+04     21s
   70153    1.0110277e+05   0.000000e+00   0.000000e+00     23s
   70153    1.0110277e+05   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.011028e+05, 70153 iterations, 18.77 seconds (23.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 101102.770    0  184 -197811.25 101102.770   151%     -   24s
H    0     0                    -157901.4451 101102.770   164%     -   24s
H    0     0                    -140221.7553 101102.770   172%     -   24s
H    0     0                    -140186.4346 101102.770   172%     -   25s
H    0     0                    -29047.13478 101102.770   448%     -   25s
H    0     0                    9129.9473937 101102.770  1007%     -   25s
H    0     0                    38591.093504 101102.770   162%     -   26s
H    0     0                    39070.091478 101102.770   159%     -   26s
H    0     0                    39491.346720 101102.770   156%     -   27s
H    0     0                    40709.586896 101102.770   148%     -   27s
H    0     0                    41014.123727 101102.770   147%     -   27s
H    0     0                    41288.134487 101102.770   145%     -   28s
H    0     0                    41443.527330 101102.770   144%     -   28s
H    0     0                    41511.659889 101102.770   144%     -   28s
H    0     0                    41691.837104 101102.770   143%     -   30s
H    0     0                    41833.488215 101102.770   142%     -   30s
H    0     0                    41902.425743 101102.769   141%     -   30s
H    0     0                    44136.650032 96544.9151   119%     -  179s
H    0     0                    44282.737185 96544.9151   118%     -  179s
H    0     0                    45645.422135 96544.9151   112%     -  179s
     0     0 96512.6615    0  247 45645.4221 96512.6615   111%     -  179s
     0     0 95536.3178    0  276 45645.4221 95536.3178   109%     -  262s
     0     0 95324.4378    0  265 45645.4221 95324.4378   109%     -  309s
     0     0 95324.4378    0  267 45645.4221 95324.4378   109%     -  336s
     0     0 94972.4755    0  264 45645.4221 94972.4755   108%     -  374s
     0     0 94957.5662    0  253 45645.4221 94957.5662   108%     -  403s
     0     0 94957.5662    0  270 45645.4221 94957.5662   108%     -  413s
     0     0 94957.5662    0  259 45645.4221 94957.5662   108%     -  436s
     0     0 94957.5662    0  256 45645.4221 94957.5662   108%     -  441s
     0     0 94957.5662    0  263 45645.4221 94957.5662   108%     -  450s
     0     0 94957.5662    0  271 45645.4221 94957.5662   108%     -  453s
     0     0 94957.5662    0  253 45645.4221 94957.5662   108%     -  469s
     0     0 94957.5662    0  266 45645.4221 94957.5662   108%     -  473s
     0     0 92610.7985    0  266 45645.4221 92610.7985   103%     -  477s
     0     0 92610.7985    0  269 45645.4221 92610.7985   103%     -  479s
     0     0 92610.7694    0  269 45645.4221 92610.7694   103%     -  480s
     0     0 91961.8684    0  373 45645.4221 91961.8684   101%     -  648s
H    0     0                    52286.917048 91961.8522  75.9%     -  649s
H    0     0                    52871.788827 91961.8522  73.9%     -  649s
H    0     0                    53056.855472 91961.8522  73.3%     -  649s
H    0     0                    53418.665551 91961.8522  72.2%     -  649s
H    0     0                    53475.143702 91961.8522  72.0%     -  649s
     0     0 90947.1334    0  346 53475.1437 90947.1334  70.1%     -  764s
     0     0 90630.6327    0  396 53475.1437 90630.6327  69.5%     -  824s
     0     0 90520.7845    0  408 53475.1437 90520.7845  69.3%     -  855s
     0     0 90153.6066    0  403 53475.1437 90153.6066  68.6%     -  922s
     0     0 90094.8169    0  418 53475.1437 90094.8169  68.5%     -  952s
     0     0 90069.9608    0  413 53475.1437 90069.9608  68.4%     -  965s
     0     0 90039.0601    0  356 53475.1437 90039.0601  68.4%     -  990s
     0     0 89990.6719    0  364 53475.1437 89990.6719  68.3%     - 1024s
H    0     0                    53495.501652 89921.0875  68.1%     - 1060s
H    0     0                    53539.751563 89921.0875  68.0%     - 1060s
H    0     0                    53680.002336 89921.0875  67.5%     - 1060s
H    0     0                    53749.311707 89921.0875  67.3%     - 1060s
H    0     0                    53761.039548 89921.0875  67.3%     - 1060s
H    0     0                    53801.114509 89921.0875  67.1%     - 1060s
H    0     0                    53874.787883 89921.0875  66.9%     - 1060s
     0     0 89921.0875    0  360 53874.7879 89921.0875  66.9%     - 1060s
     0     0 89890.4020    0  416 53874.7879 89890.4020  66.9%     - 1102s
H    0     0                    54156.135384 89880.3460  66.0%     - 1114s
H    0     0                    54158.856250 89880.3460  66.0%     - 1114s
H    0     0                    54191.363336 89880.3460  65.9%     - 1114s
     0     0 89880.3460    0  426 54191.3633 89880.3460  65.9%     - 1115s
     0     0 89871.6688    0  424 54191.3633 89871.6688  65.8%     - 1124s
     0     0 89869.8349    0  424 54191.3633 89869.8349  65.8%     - 1128s
     0     0 89867.7112    0  429 54191.3633 89867.7112  65.8%     - 1131s
     0     0 89865.7486    0  433 54191.3633 89865.7486  65.8%     - 1136s
     0     0 89865.0542    0  432 54191.3633 89865.0542  65.8%     - 1139s
H    0     0                    54458.342347 89865.0542  65.0%     - 1185s
H    0     0                    54745.964332 89865.0542  64.1%     - 1185s
H    0     0                    54981.251155 89865.0542  63.4%     - 1185s
H    0     0                    55011.666388 89865.0542  63.4%     - 1185s
     0     0 87803.9723    0  291 55011.6664 87803.9723  59.6%     - 1297s
     0     0 87458.0112    0  367 55011.6664 87458.0112  59.0%     - 1354s
     0     0 87320.8381    0  310 55011.6664 87320.8381  58.7%     - 1390s
     0     0 87262.2463    0  420 55011.6664 87262.2463  58.6%     - 1416s
     0     0 87197.5690    0  328 55011.6664 87197.5690  58.5%     - 1445s
     0     0 87185.6663    0  327 55011.6664 87185.6663  58.5%     - 1455s
     0     0 87161.5198    0  321 55011.6664 87161.5198  58.4%     - 1467s
     0     0 87147.4273    0  308 55011.6664 87147.4273  58.4%     - 1476s
     0     0 87122.6711    0  325 55011.6664 87122.6711  58.4%     - 1487s
     0     0 87096.4352    0  369 55011.6664 87096.4352  58.3%     - 1502s
     0     0 87053.9476    0  321 55011.6664 87053.9476  58.2%     - 1523s
     0     0 87041.3919    0  337 55011.6664 87041.3919  58.2%     - 1534s
     0     0 87036.1271    0  330 55011.6664 87036.1271  58.2%     - 1539s
     0     0 87017.2038    0  335 55011.6664 87017.2038  58.2%     - 1546s
     0     0 87014.2773    0  335 55011.6664 87014.2773  58.2%     - 1549s
     0     0 87007.4547    0  336 55011.6664 87007.4547  58.2%     - 1553s
     0     0 86997.5382    0  330 55011.6664 86997.5382  58.1%     - 1558s
     0     0 86989.4534    0  333 55011.6664 86989.4534  58.1%     - 1567s
     0     0 86988.1585    0  329 55011.6664 86988.1585  58.1%     - 1569s
H    0     0                    55046.253882 86207.6914  56.6%     - 1667s
H    0     0                    55516.632116 86207.6914  55.3%     - 1667s
H    0     0                    55531.123777 86207.6914  55.2%     - 1667s
H    0     0                    55583.367115 86207.6914  55.1%     - 1667s
H    0     0                    55883.343307 86207.6914  54.3%     - 1667s
     0     0 86207.6914    0  444 55883.3433 86207.6914  54.3%     - 1667s
H    0     0                    55930.622786 86207.4948  54.1%     - 1669s
H    0     0                    55953.262553 86207.4948  54.1%     - 1669s
H    0     0                    55972.112775 86207.4948  54.0%     - 1670s
H    0     0                    56020.447716 86207.4948  53.9%     - 1670s
     0     0 86026.9079    0  466 56020.4477 86026.9079  53.6%     - 1715s
     0     0 85951.7202    0  443 56020.4477 85951.7202  53.4%     - 1739s
     0     0 85923.9048    0  459 56020.4477 85923.9048  53.4%     - 1756s
H    0     0                    56412.909554 85898.4071  52.3%     - 1777s
     0     0 85898.4071    0  469 56412.9096 85898.4071  52.3%     - 1777s
     0     0 85873.4511    0  462 56412.9096 85873.4511  52.2%     - 1787s
     0     0 85852.6706    0  459 56412.9096 85852.6706  52.2%     - 1804s
     0     0 85839.3532    0  462 56412.9096 85839.3532  52.2%     - 1815s
     0     0 85833.0459    0  457 56412.9096 85833.0459  52.2%     - 1822s
     0     0 85820.7057    0  455 56412.9096 85820.7057  52.1%     - 1830s
     0     0 85816.3668    0  457 56412.9096 85816.3668  52.1%     - 1836s
     0     0 85811.8268    0  456 56412.9096 85811.8268  52.1%     - 1844s
     0     0 85806.7239    0  460 56412.9096 85806.7239  52.1%     - 1848s
     0     0 85795.6102    0  460 56412.9096 85795.6102  52.1%     - 1855s
H    0     0                    56859.395667 85790.9886  50.9%     - 1861s
     0     0 85790.9886    0  460 56859.3957 85790.9886  50.9%     - 1861s
     0     0 85770.8910    0  462 56859.3957 85770.8910  50.8%     - 1870s
     0     0 85763.1083    0  468 56859.3957 85763.1083  50.8%     - 1883s
     0     0 85757.5657    0  461 56859.3957 85757.5657  50.8%     - 1889s
     0     0 85756.4730    0  461 56859.3957 85756.4730  50.8%     - 1892s
     0     0 85533.9733    0  389 56859.3957 85533.9733  50.4%     - 1947s
     0     0 85440.0051    0  362 56859.3957 85440.0051  50.3%     - 1983s
     0     0 85396.6553    0  362 56859.3957 85396.6553  50.2%     - 2005s
     0     0 85383.8544    0  359 56859.3957 85383.8544  50.2%     - 2012s
     0     0 85373.0792    0  368 56859.3957 85373.0792  50.1%     - 2019s
     0     0 85355.8075    0  361 56859.3957 85355.8075  50.1%     - 2030s
     0     0 85345.0088    0  373 56859.3957 85345.0088  50.1%     - 2037s
     0     0 85335.7438    0  472 56859.3957 85335.7438  50.1%     - 2048s
     0     0 85334.9140    0  464 56859.3957 85334.9140  50.1%     - 2050s
     0     0 85287.0059    0  361 56859.3957 85287.0059  50.0%     - 2066s
     0     0 85257.2722    0  369 56859.3957 85257.2722  49.9%     - 2086s
     0     0 85254.6140    0  368 56859.3957 85254.6140  49.9%     - 2089s
     0     0 85253.9225    0  375 56859.3957 85253.9225  49.9%     - 2091s
     0     0 85222.4911    0  373 56859.3957 85222.4911  49.9%     - 2106s
     0     0 85217.8018    0  354 56859.3957 85217.8018  49.9%     - 2116s
     0     0 85212.2138    0  369 56859.3957 85212.2138  49.9%     - 2122s
     0     0 85208.4773    0  366 56859.3957 85208.4773  49.9%     - 2125s
     0     0 85207.3425    0  362 56859.3957 85207.3425  49.9%     - 2127s
     0     0 85183.8657    0  373 56859.3957 85183.8657  49.8%     - 2144s
H    0     0                    57001.783223 85183.8469  49.4%     - 2148s
     0     0 85175.9134    0  369 57001.7832 85175.9134  49.4%     - 2159s
     0     0 85153.9393    0  414 57001.7832 85153.9393  49.4%     - 2171s
     0     0 85148.1000    0  399 57001.7832 85148.1000  49.4%     - 2177s
     0     0 85145.6716    0  406 57001.7832 85145.6716  49.4%     - 2182s
     0     0 85112.9438    0  388 57001.7832 85112.9438  49.3%     - 2203s
     0     0 85105.8153    0  375 57001.7832 85105.8153  49.3%     - 2211s
     0     0 85099.2555    0  385 57001.7832 85099.2555  49.3%     - 2218s
     0     0 85095.6483    0  400 57001.7832 85095.6483  49.3%     - 2222s
     0     0 85093.4775    0  390 57001.7832 85093.4775  49.3%     - 2226s
     0     0 85087.1150    0  419 57001.7832 85087.1150  49.3%     - 2235s
H    0     0                    57135.372173 85087.0081  48.9%     - 2244s
     0     0 85085.8294    0  417 57135.3722 85085.8294  48.9%     - 2248s
     0     0 85079.0167    0  410 57135.3722 85079.0167  48.9%     - 2255s
     0     0 85077.0260    0  409 57135.3722 85077.0260  48.9%     - 2259s
     0     0 85075.4467    0  414 57135.3722 85075.4467  48.9%     - 2264s
     0     0 85075.2138    0  414 57135.3722 85075.2138  48.9%     - 2267s
H    0     0                    57200.652935 85075.2138  48.7%     - 2670s
     0     2 85075.2138    0  414 57200.6529 85075.2138  48.7%     - 2715s
     1     4 85004.7492    1  409 57200.6529 85074.3786  48.7% 11972 2766s
     3     8 84783.2885    2  403 57200.6529 85004.1851  48.6% 15571 2842s
     7    16 84732.6412    3  478 57200.6529 84783.1715  48.2% 18602 2921s
    15    32 84331.3812    4  411 57200.6529 84732.2112  48.1% 19602 3026s
    31    48 83753.0609    5  399 57200.6529 84331.3708  47.4% 29044 3330s
    47    80 81944.6115    6  343 57200.6529 84331.3708  47.4% 31415 3472s
H   63    80                    57337.757143 84331.3708  47.1% 29177 3472s
H   69    80                    57830.922519 84331.3708  45.8% 27300 3473s
    79   144 81149.3564    7  349 57830.9225 84331.3708  45.8% 25009 3600s

Cutting planes:
  Learned: 1
  Gomory: 14
  Implied bound: 237
  MIR: 2924
  Flow cover: 2545
  RLT: 76
  Relax-and-lift: 810

Explored 143 nodes (3294429 simplex iterations) in 3600.20 seconds (4535.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 57830.9 57337.8 57200.7 ... 55953.3

Time limit reached
Best objective 5.783092251917e+04, best bound 8.433137077295e+04, gap 45.8240%
  WARNING: Time limit reached. Using best solution found (gap: 45.82%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.23s
  Master Objective (UB) = 57830.92, θ = 219032.62
  Upper Bound (UB) = 57830.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 219032.62
  [DEBUG]   ✓ Scenario 0: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 219032.62 ≤ Q = 219032.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 219032.62 ≤ Q = 219032.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 219032.62 ≤ Q = 219032.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 219032.62 ≤ Q = 219032.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x218d48ef
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde72b711
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.256492e+13
Presolve removed 2578 rows and 1869 columns
Presolve time: 0.01s
Presolved: 515 rows, 520 columns, 1453 nonzeros
Found heuristic solution: objective 6178976.8595
Variable types: 354 continuous, 166 integer (166 binary)

Root relaxation: objective -1.549323e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154932.30    0  127 6178976.86 -154932.30   103%     -    0s
H    0     0                    -120238.5457 -154932.30  28.9%     -    0s
H    0     0                    -120650.3161 -154932.30  28.4%     -    0s
H    0     0                    -128960.8143 -154932.30  20.1%     -    0s
H    0     0                    -129402.7764 -138351.78  6.92%     -    0s
     0     0 -138351.78    0  114 -129402.78 -138351.78  6.92%     -    0s
H    0     0                    -131442.8511 -138336.36  5.24%     -    0s
H    0     0                    -136041.1157 -138336.36  1.69%     -    0s
H    0     0                    -136410.8519 -138336.36  1.41%     -    0s
     0     0 -138086.01    0   87 -136410.85 -138086.01  1.23%     -    0s
     0     0 -137773.36    0  101 -136410.85 -137773.36  1.00%     -    0s
H    0     0                    -136446.2228 -137764.66  0.97%     -    0s
     0     0 -137683.06    0  101 -136446.22 -137683.06  0.91%     -    0s
H    0     0                    -136721.2517 -137683.06  0.70%     -    0s
     0     0 -137590.98    0   91 -136721.25 -137590.98  0.64%     -    0s
     0     0 -137518.30    0   91 -136721.25 -137518.30  0.58%     -    0s
     0     0 -137518.03    0   91 -136721.25 -137518.03  0.58%     -    0s
     0     0 -137373.40    0   88 -136721.25 -137373.40  0.48%     -    0s
     0     0 -137319.19    0   87 -136721.25 -137319.19  0.44%     -    0s
     0     0 -137318.09    0   87 -136721.25 -137318.09  0.44%     -    0s
     0     0 -137123.70    0   70 -136721.25 -137123.70  0.29%     -    0s
     0     0 -137106.18    0   58 -136721.25 -137106.18  0.28%     -    0s
     0     0 -137054.22    0   66 -136721.25 -137054.22  0.24%     -    0s
     0     0 -137051.05    0   66 -136721.25 -137051.05  0.24%     -    0s
     0     0 -136950.43    0   56 -136721.25 -136950.43  0.17%     -    0s
     0     0 -136945.99    0   56 -136721.25 -136945.99  0.16%     -    0s
     0     0 -136945.99    0   61 -136721.25 -136945.99  0.16%     -    0s
     0     0 -136945.99    0   61 -136721.25 -136945.99  0.16%     -    0s
     0     0 -136743.11    0   14 -136721.25 -136743.11  0.02%     -    0s
     0     0          -    0      -136721.25 -136733.25  0.01%     -    0s

Cutting planes:
  Gomory: 24
  Implied bound: 17
  MIR: 32
  Flow cover: 13
  RLT: 5

Explored 1 nodes (1168 simplex iterations) in 0.19 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -136721 -136632 -136596 ... -120239

Optimal solution found (tolerance 1.00e-04)
Best objective -1.367212516871e+05, best bound -1.367332463016e+05, gap 0.0088%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 206490.50
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136721.25
  [DEBUG]   S×d_nominal = 343211.75
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 343211.75 + -136721.25 = 206490.50
  [DEBUG]   Current θ from Master = 219032.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12542.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45288.80
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 238.8153, Absolute Gap = 238.8153, Relative Gap = 0.004130
  Not converged yet (gap = 238.82 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610879 nonzeros
Model fingerprint: 0xa890f2c9
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94878 rows and 38528 columns
Presolve time: 4.26s
Presolved: 120565 rows, 51092 columns, 742380 nonzeros
Variable types: 48833 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -199047.0512

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 5.435e+06
 Factor NZ  : 1.280e+07 (roughly 170 MB of memory)
 Factor Ops : 3.862e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.76764595e+07  2.04137677e+08  1.36e+05 1.98e+01  8.42e+04     7s
   1  -1.35342857e+07  1.94214285e+08  9.72e+04 7.62e+01  5.96e+04     7s
   2  -4.45836395e+06  1.51962382e+08  3.25e+04 9.68e-01  2.14e+04     7s
   3  -7.69609728e+05  1.09892225e+08  1.86e+03 1.65e+00  1.67e+03     7s
   4  -4.90047620e+05  4.98635088e+07  5.45e+02 3.97e-01  5.31e+02     7s
   5  -3.73279539e+05  3.30729659e+07  2.43e+02 2.23e-01  2.76e+02     7s
   6  -2.95708449e+05  2.72690323e+07  7.55e+01 1.75e-01  1.62e+02     7s
   7  -2.42041624e+05  1.67523929e+07  3.49e+01 9.89e-02  9.07e+01     7s
   8  -1.57591524e+05  1.30847325e+07  1.09e+01 7.50e-02  6.37e+01     8s
   9  -1.09662362e+05  6.95653132e+06  5.48e+00 3.82e-02  3.31e+01     8s
  10  -8.61761561e+04  4.65315996e+06  3.48e+00 2.53e-02  2.20e+01     8s
  11  -7.06152324e+04  3.17007095e+06  2.13e+00 1.71e-02  1.49e+01     8s
  12  -4.62937589e+04  1.37669030e+06  1.13e+00 6.43e-03  6.51e+00     8s
  13  -1.54696332e+04  5.28746502e+05  5.03e-01 2.46e-03  2.48e+00     8s
  14   2.40150526e+04  3.15086446e+05  2.24e-01 1.36e-03  1.32e+00     8s
  15   2.46648648e+04  2.40779429e+05  2.21e-01 1.16e-03  9.84e-01     8s
  16   4.20757177e+04  1.93002972e+05  1.66e-01 1.60e-03  6.87e-01     9s
  17   5.93399394e+04  1.52522637e+05  1.14e-01 2.41e-03  4.24e-01     9s
  18   6.54098149e+04  1.38639100e+05  9.47e-02 2.05e-03  3.33e-01     9s
  19   6.84742468e+04  1.26938748e+05  8.51e-02 1.86e-03  2.66e-01     9s
  20   7.37235199e+04  1.21213041e+05  6.97e-02 1.91e-03  2.16e-01     9s
  21   7.81080393e+04  1.17134447e+05  5.72e-02 1.68e-03  1.78e-01     9s
  22   8.04997344e+04  1.12376813e+05  5.05e-02 2.60e-03  1.45e-01     9s
  23   8.52813047e+04  1.08807199e+05  3.75e-02 2.77e-03  1.07e-01    10s
  24   8.81572231e+04  1.06175084e+05  2.98e-02 2.03e-03  8.21e-02    10s
  25   9.14259123e+04  1.05165226e+05  2.14e-02 1.71e-03  6.26e-02    10s
  26   9.18442783e+04  1.04558197e+05  2.03e-02 1.51e-03  5.79e-02    10s
  27   9.29778161e+04  1.03717043e+05  1.74e-02 1.23e-03  4.89e-02    10s
  28   9.45741798e+04  1.02616962e+05  1.34e-02 8.50e-04  3.67e-02    10s
  29   9.58898827e+04  1.02186181e+05  1.01e-02 6.92e-04  2.87e-02    11s
  30   9.69798771e+04  1.01517284e+05  7.42e-03 4.67e-04  2.07e-02    11s
  31   9.77585451e+04  1.01300011e+05  5.44e-03 3.96e-04  1.61e-02    11s
  32   9.83918729e+04  1.01030413e+05  3.87e-03 3.06e-04  1.20e-02    11s
  33   9.90532168e+04  1.00607224e+05  2.29e-03 1.67e-04  7.08e-03    11s
  34   9.93375139e+04  1.00449328e+05  1.62e-03 1.15e-04  5.07e-03    12s
  35   9.95491770e+04  1.00327279e+05  1.14e-03 7.75e-05  3.55e-03    12s
  36   9.97460965e+04  1.00249610e+05  7.03e-04 5.19e-05  2.29e-03    12s
  37   9.98733289e+04  1.00198601e+05  4.29e-04 4.40e-05  1.48e-03    12s
  38   9.99307953e+04  1.00156277e+05  3.02e-04 2.74e-05  1.03e-03    12s
  39   1.00003163e+05  1.00148556e+05  1.54e-04 2.43e-05  6.62e-04    12s
  40   1.00025797e+05  1.00129010e+05  1.08e-04 1.69e-05  4.70e-04    12s
  41   1.00036260e+05  1.00123751e+05  8.81e-05 1.49e-05  3.98e-04    13s
  42   1.00070375e+05  1.00099824e+05  2.32e-05 6.24e-06  1.34e-04    13s
  43   1.00082621e+05  1.00086949e+05  1.97e-06 1.14e-06  1.97e-05    13s
  44   1.00083493e+05  1.00084497e+05  5.69e-07 2.24e-07  4.57e-06    13s
  45   1.00083746e+05  1.00083929e+05  2.95e-07 7.01e-08  8.34e-07    13s
  46   1.00083775e+05  1.00083926e+05  1.81e-06 6.67e-08  6.90e-07    14s
  47   1.00083800e+05  1.00083923e+05  1.75e-05 3.45e-06  5.64e-07    14s
  48   1.00083850e+05  1.00083923e+05  9.61e-06 3.32e-06  3.32e-07    14s
  49   1.00083890e+05  1.00083920e+05  4.52e-06 5.59e-07  1.36e-07    14s
  50   1.00083918e+05  1.00083919e+05  1.04e-07 1.78e-08  3.71e-09    15s

Barrier solved model in 50 iterations and 14.51 seconds (11.74 work units)
Optimal objective 1.00083918e+05


Root crossover log...

  108852 DPushes remaining with DInf 0.0000000e+00                15s
   60892 DPushes remaining with DInf 0.0000000e+00                15s
   14040 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                23s

   22923 PPushes remaining with PInf 4.3704653e-05                23s
    6863 PPushes remaining with PInf 8.9437208e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4619253e+05     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   84392    1.0008392e+05   0.000000e+00   2.461925e+05     27s
   85162    1.0008392e+05   0.000000e+00   0.000000e+00     27s
   85162    1.0008392e+05   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 1.64s

Solved with barrier

Root relaxation: objective 1.000839e+05, 85162 iterations, 23.94 seconds (29.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 100083.919    0  131 -199047.05 100083.919   150%     -   30s
H    0     0                    -195256.6781 100083.919   151%     -   30s
H    0     0                    -181633.6251 100083.919   155%     -   31s
H    0     0                    -181239.1547 100083.919   155%     -   31s
H    0     0                    -64160.73344 100083.919   256%     -   31s
H    0     0                    -63929.94145 100083.919   257%     -   31s
H    0     0                    23714.660569 100083.919   322%     -   31s
H    0     0                    30027.334183 100083.919   233%     -   32s
H    0     0                    31978.875215 100083.919   213%     -   32s
H    0     0                    37538.526799 100083.919   167%     -   33s
H    0     0                    38251.053044 100083.919   162%     -   33s
H    0     0                    39779.375646 100083.919   152%     -   33s
H    0     0                    41366.361318 95318.2885   130%     -  157s
     0     0 95318.2885    0  199 41366.3613 95318.2885   130%     -  158s
     0     0 93995.5819    0  194 41366.3613 93995.5819   127%     -  252s
     0     0 93956.5597    0  186 41366.3613 93956.5597   127%     -  279s
     0     0 93939.4062    0  195 41366.3613 93939.4062   127%     -  299s
     0     0 93939.4062    0  203 41366.3613 93939.4062   127%     -  335s
     0     0 93918.8160    0  195 41366.3613 93918.8160   127%     -  351s
     0     0 93909.3584    0  206 41366.3613 93909.3584   127%     -  361s
     0     0 93882.5996    0  213 41366.3613 93882.5996   127%     -  377s
     0     0 93867.0607    0  211 41366.3613 93867.0607   127%     -  383s
     0     0 93860.5413    0  207 41366.3613 93860.5413   127%     -  386s
     0     0 93857.0738    0  207 41366.3613 93857.0738   127%     -  387s
     0     0 93855.3188    0  207 41366.3613 93855.3188   127%     -  388s
     0     0 93855.3101    0  207 41366.3613 93855.3101   127%     -  388s
     0     0 91061.7978    0  269 41366.3613 91061.7978   120%     -  494s
H    0     0                    47949.739701 91061.5777  89.9%     -  494s
H    0     0                    48407.425811 91061.5777  88.1%     -  495s
H    0     0                    48666.216378 91061.5777  87.1%     -  495s
H    0     0                    48737.694713 91061.5777  86.8%     -  495s
     0     0 90170.8119    0  295 48737.6947 90170.8119  85.0%     -  558s
     0     0 89989.2377    0  295 48737.6947 89989.2377  84.6%     -  588s
     0     0 89929.0653    0  301 48737.6947 89929.0653  84.5%     -  615s
     0     0 89733.4918    0  319 48737.6947 89733.4918  84.1%     -  653s
     0     0 89657.7736    0  311 48737.6947 89657.7736  84.0%     -  684s
     0     0 89548.6716    0  307 48737.6947 89548.6716  83.7%     -  711s
     0     0 89444.1714    0  331 48737.6947 89444.1714  83.5%     -  743s
     0     0 89407.5680    0  327 48737.6947 89407.5680  83.4%     -  758s
     0     0 89343.9047    0  332 48737.6947 89343.9047  83.3%     -  777s
     0     0 89301.6562    0  331 48737.6947 89301.6562  83.2%     -  795s
     0     0 89284.2638    0  332 48737.6947 89284.2638  83.2%     -  804s
     0     0 89243.0583    0  325 48737.6947 89243.0583  83.1%     -  817s
     0     0 89218.5548    0  334 48737.6947 89218.5548  83.1%     -  826s
     0     0 89215.0369    0  341 48737.6947 89215.0369  83.1%     -  830s
     0     0 89214.8867    0  335 48737.6947 89214.8867  83.1%     -  831s
     0     0 87347.8742    0  365 48737.6947 87347.8742  79.2%     -  955s
     0     0 86993.8441    0  388 48737.6947 86993.8441  78.5%     -  995s
H    0     0                    49219.290249 86824.9790  76.4%     - 1017s
H    0     0                    49356.318516 86824.9790  75.9%     - 1017s
     0     0 86824.9790    0  384 49356.3185 86824.9790  75.9%     - 1017s
     0     0 86792.1447    0  377 49356.3185 86792.1447  75.8%     - 1029s
     0     0 86746.3159    0  379 49356.3185 86746.3159  75.8%     - 1042s
     0     0 86683.8556    0  378 49356.3185 86683.8556  75.6%     - 1057s
     0     0 86607.8038    0  382 49356.3185 86607.8038  75.5%     - 1079s
     0     0 86595.5327    0  386 49356.3185 86595.5327  75.4%     - 1087s
     0     0 86562.1973    0  391 49356.3185 86562.1973  75.4%     - 1097s
     0     0 86537.9627    0  397 49356.3185 86537.9627  75.3%     - 1105s
     0     0 86503.3234    0  397 49356.3185 86503.3234  75.3%     - 1116s
     0     0 86499.0035    0  394 49356.3185 86499.0035  75.3%     - 1121s
     0     0 86454.4384    0  400 49356.3185 86454.4384  75.2%     - 1131s
     0     0 86450.4837    0  388 49356.3185 86450.4837  75.2%     - 1135s
     0     0 86409.6129    0  396 49356.3185 86409.6129  75.1%     - 1146s
     0     0 86399.4596    0  398 49356.3185 86399.4596  75.1%     - 1150s
     0     0 86392.7376    0  392 49356.3185 86392.7376  75.0%     - 1155s
     0     0 86378.2606    0  394 49356.3185 86378.2606  75.0%     - 1166s
     0     0 86377.1590    0  398 49356.3185 86377.1590  75.0%     - 1169s
H    0     0                    50221.485419 86377.1590  72.0%     - 1190s
H    0     0                    50290.718230 85695.1251  70.4%     - 1244s
     0     0 85695.1251    0  335 50290.7182 85695.1251  70.4%     - 1244s
     0     0 85532.1715    0  386 50290.7182 85532.1715  70.1%     - 1270s
     0     0 85429.5031    0  349 50290.7182 85429.5031  69.9%     - 1296s
     0     0 85402.8484    0  401 50290.7182 85402.8484  69.8%     - 1308s
     0     0 85336.9469    0  347 50290.7182 85336.9469  69.7%     - 1322s
     0     0 85302.9017    0  354 50290.7182 85302.9017  69.6%     - 1332s
     0     0 85285.6497    0  358 50290.7182 85285.6497  69.6%     - 1339s
     0     0 85280.9689    0  357 50290.7182 85280.9689  69.6%     - 1345s
     0     0 85255.1858    0  358 50290.7182 85255.1858  69.5%     - 1359s
     0     0 85251.2554    0  354 50290.7182 85251.2554  69.5%     - 1363s
     0     0 85248.2187    0  366 50290.7182 85248.2187  69.5%     - 1366s
     0     0 85245.7014    0  358 50290.7182 85245.7014  69.5%     - 1370s
     0     0 85244.6584    0  355 50290.7182 85244.6584  69.5%     - 1371s
     0     0 85035.4007    0  403 50290.7182 85035.4007  69.1%     - 1401s
     0     0 84989.1263    0  405 50290.7182 84989.1263  69.0%     - 1414s
     0     0 84979.4785    0  400 50290.7182 84979.4785  69.0%     - 1420s
     0     0 84965.9125    0  409 50290.7182 84965.9125  68.9%     - 1428s
     0     0 84956.3964    0  420 50290.7182 84956.3964  68.9%     - 1435s
     0     0 84953.1411    0  404 50290.7182 84953.1411  68.9%     - 1439s
     0     0 84949.2089    0  411 50290.7182 84949.2089  68.9%     - 1445s
     0     0 84948.5340    0  418 50290.7182 84948.5340  68.9%     - 1446s
     0     0 84823.9003    0  386 50290.7182 84823.9003  68.7%     - 1474s
H    0     0                    50339.302478 84823.8139  68.5%     - 1485s
     0     0 84797.5689    0  403 50339.3025 84797.5689  68.5%     - 1498s
     0     0 84786.3524    0  391 50339.3025 84786.3524  68.4%     - 1507s
     0     0 84779.0928    0  359 50339.3025 84779.0928  68.4%     - 1515s
H    0     0                    50794.913939 84769.5181  66.9%     - 1523s
     0     0 84769.5181    0  403 50794.9139 84769.5181  66.9%     - 1524s
H    0     0                    51366.968028 84767.8039  65.0%     - 1526s
H    0     0                    53663.965448 84767.8039  58.0%     - 1526s
H    0     0                    53889.674476 84767.8039  57.3%     - 1526s
H    0     0                    53942.724100 84767.8039  57.1%     - 1526s
H    0     0                    54366.352241 84767.8039  55.9%     - 1526s
     0     0 84767.8039    0  402 54366.3522 84767.8039  55.9%     - 1526s
H    0     0                    54377.947093 84767.8039  55.9%     - 1528s
H    0     0                    54650.466428 84749.9707  55.1%     - 1540s
H    0     0                    54653.229724 84749.9707  55.1%     - 1540s
H    0     0                    54685.022378 84749.9707  55.0%     - 1540s
     0     0 84749.9707    0  362 54685.0224 84749.9707  55.0%     - 1540s
H    0     0                    54724.197852 84740.4694  54.9%     - 1550s
     0     0 84740.4694    0  363 54724.1979 84740.4694  54.9%     - 1550s
     0     0 84735.5624    0  372 54724.1979 84735.5624  54.8%     - 1552s
     0     0 84734.4511    0  369 54724.1979 84734.4511  54.8%     - 1554s
     0     0 84707.5975    0  375 54724.1979 84707.5975  54.8%     - 1566s
     0     0 84677.7133    0  374 54724.1979 84677.7133  54.7%     - 1580s
     0     0 84672.9451    0  368 54724.1979 84672.9451  54.7%     - 1584s
     0     0 84668.8886    0  372 54724.1979 84668.8886  54.7%     - 1586s
     0     0 84667.7043    0  372 54724.1979 84667.7043  54.7%     - 1588s
     0     0 84648.7998    0  371 54724.1979 84648.7998  54.7%     - 1602s
     0     0 84645.2822    0  418 54724.1979 84645.2822  54.7%     - 1608s
     0     0 84642.7890    0  379 54724.1979 84642.7890  54.7%     - 1611s
     0     0 84640.9021    0  374 54724.1979 84640.9021  54.7%     - 1613s
     0     0 84629.9995    0  374 54724.1979 84629.9995  54.6%     - 1618s
H    0     0                    54819.853818 84629.9983  54.4%     - 1649s
     0     0 84626.9014    0  374 54819.8538 84626.9014  54.4%     - 1654s
     0     0 84626.1179    0  379 54819.8538 84626.1179  54.4%     - 1656s
     0     0 84624.1724    0  367 54819.8538 84624.1724  54.4%     - 1661s
     0     0 84621.0317    0  365 54819.8538 84621.0317  54.4%     - 1665s
     0     0 84620.7204    0  367 54819.8538 84620.7204  54.4%     - 1667s
     0     0 84617.7653    0  365 54819.8538 84617.7653  54.4%     - 1673s
     0     0 84617.4112    0  365 54819.8538 84617.4112  54.4%     - 1676s
     0     2 84617.3706    0  365 54819.8538 84617.3706  54.4%     - 2046s
     1     4 84585.0091    1  360 54819.8538 84617.3706  54.4%  3368 2073s
     3     7 84544.5839    2  369 54819.8538 84584.9177  54.3%  6958 2116s
     6    11 84412.6091    3  366 54819.8538 84544.4870  54.2% 10006 2173s
    10    17 84150.7874    4  360 54819.8538 84544.4870  54.2% 13513 2238s
    16    23 79395.8868    5  354 54819.8538 84412.4826  54.0% 19775 2365s
    22    40 81567.7792    5  381 54819.8538 84286.7580  53.8% 18881 2544s
H   39    72                    54866.031397 84286.7580  53.6% 25245 2634s
H   41    72                    55229.985538 84286.7580  52.6% 25404 2634s
H   56    72                    55279.963120 84286.7580  52.5% 25018 2634s
    71   132 80911.0111    7  329 55279.9631 84286.7580  52.5% 25111 2756s
   131   242 80831.0160    8  337 55279.9631 84286.7580  52.5% 18025 2854s
   241   307 78953.1073   11  347 55279.9631 84286.7580  52.5% 13074 2920s
   306   313 79047.2300   10  349 55279.9631 84286.7580  52.5% 12168 2980s
   312   363 80241.7312   12  354 55279.9631 84286.7580  52.5% 12092 3033s
   362   391 79315.3678   11  295 55279.9631 84286.7580  52.5% 11683 3124s
   390   423 78838.7437   13  340 55279.9631 84286.7580  52.5% 11748 3254s
   422   468 78687.1656   14  344 55279.9631 84286.7580  52.5% 11608 3356s
   467   517 78307.4223   15  321 55279.9631 84286.7580  52.5% 11081 3475s
   516   571 78438.4838   17  329 55279.9631 84286.7580  52.5% 10616 3540s
   570   620 78050.5931   20  277 55279.9631 84286.7580  52.5% 10036 3590s
   619   633 74046.1415   23  266 55279.9631 84286.7580  52.5%  9626 3600s

Cutting planes:
  Learned: 3
  Gomory: 8
  Implied bound: 174
  MIR: 2372
  Flow cover: 2258
  RLT: 48
  Relax-and-lift: 450

Explored 632 nodes (6703804 simplex iterations) in 3600.12 seconds (4972.71 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 55280 55230 54866 ... 53942.7

Time limit reached
Best objective 5.527996312038e+04, best bound 8.428675803477e+04, gap 52.4725%
  WARNING: Time limit reached. Using best solution found (gap: 52.47%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 55279.96, θ = 217024.47
  Upper Bound (UB) = 55279.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 217024.47
  [DEBUG]   ✓ Scenario 0: θ = 217024.47 ≤ Q = 217024.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 217024.47 ≤ Q = 217024.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 217024.47 ≤ Q = 217024.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 217024.47 ≤ Q = 217024.47 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6ffe1820
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9001e7e0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.258342e+13
Presolve removed 2578 rows and 1869 columns
Presolve time: 0.01s
Presolved: 515 rows, 520 columns, 1456 nonzeros
Found heuristic solution: objective 6194205.0557
Variable types: 354 continuous, 166 integer (166 binary)

Root relaxation: objective -1.567745e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156774.53    0  128 6194205.06 -156774.53   103%     -    0s
H    0     0                    -122394.6668 -156774.53  28.1%     -    0s
H    0     0                    -123081.2959 -156774.53  27.4%     -    0s
H    0     0                    -126802.2083 -156774.53  23.6%     -    0s
H    0     0                    -129475.5156 -139462.85  7.71%     -    0s
H    0     0                    -134384.1406 -139462.85  3.78%     -    0s
     0     0 -139462.85    0  114 -134384.14 -139462.85  3.78%     -    0s
H    0     0                    -135727.9267 -139370.81  2.68%     -    0s
     0     0 -139182.32    0  113 -135727.93 -139182.32  2.55%     -    0s
H    0     0                    -136315.4734 -139182.32  2.10%     -    0s
H    0     0                    -137181.0531 -138372.51  0.87%     -    0s
     0     0 -138372.51    0  107 -137181.05 -138372.51  0.87%     -    0s
H    0     0                    -137462.9785 -138372.21  0.66%     -    0s
     0     0 -138370.07    0  107 -137462.98 -138370.07  0.66%     -    0s
     0     0 -138069.21    0   98 -137462.98 -138069.21  0.44%     -    0s
     0     0 -138014.58    0   96 -137462.98 -138014.58  0.40%     -    0s
     0     0 -137974.60    0  104 -137462.98 -137974.60  0.37%     -    0s
     0     0 -137950.87    0  102 -137462.98 -137950.87  0.35%     -    0s
     0     0 -137949.52    0  104 -137462.98 -137949.52  0.35%     -    0s
     0     0 -137872.08    0   94 -137462.98 -137872.08  0.30%     -    0s
     0     0 -137865.14    0  100 -137462.98 -137865.14  0.29%     -    0s
     0     0 -137862.79    0  100 -137462.98 -137862.79  0.29%     -    0s
     0     0 -137855.11    0  100 -137462.98 -137855.11  0.29%     -    0s
     0     2 -137855.11    0  100 -137462.98 -137855.11  0.29%     -    0s
H    5     8                    -137467.4174 -137846.71  0.28%  12.8    0s
*  524    38              28    -137467.8192 -137525.54  0.04%   5.7    0s

Cutting planes:
  Gomory: 52
  Implied bound: 1
  MIR: 158
  Flow cover: 13
  RLT: 44

Explored 747 nodes (4628 simplex iterations) in 0.34 seconds (0.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -137468 -137467 -137463 ... -122395
No other solutions better than -137468

Optimal solution found (tolerance 1.00e-04)
Best objective -1.374678192022e+05, best bound -1.374678192022e+05, gap 0.0000%
  Subproblem solved in 0.37s
  Worst-case operational profit (Z_SP) = 205072.50
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137467.82
  [DEBUG]   S×d_nominal = 342540.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 342540.32 + -137467.82 = 205072.50
  [DEBUG]   Current θ from Master = 217024.47
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11951.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43328.00
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = -2312.1441, Absolute Gap = 2312.1441, Relative Gap = -0.041826
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 55279.96, LB = 57592.11, Gap = -2312.14
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654119 nonzeros
Model fingerprint: 0xc0d08932
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101645 rows and 41275 columns
Presolve time: 4.12s
Presolved: 129088 rows, 54585 columns, 795098 nonzeros
Variable types: 52326 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -201494.1305

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.64s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 6.151e+06
 Factor NZ  : 1.344e+07 (roughly 200 MB of memory)
 Factor Ops : 2.800e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79981812e+07  2.16813401e+08  1.40e+05 1.87e+01  8.53e+04     8s
   1  -1.38233001e+07  2.06877821e+08  9.99e+04 7.73e+01  6.04e+04     8s
   2  -4.66733131e+06  1.62006611e+08  3.42e+04 6.42e-01  2.23e+04     8s
   3  -8.20794005e+05  1.18139151e+08  2.08e+03 1.62e+00  1.80e+03     8s
   4  -4.53179274e+05  5.00783379e+07  4.86e+02 4.60e-01  4.80e+02     8s
   5  -3.81972358e+05  3.45113521e+07  2.69e+02 2.71e-01  2.84e+02     8s
   6  -3.03442985e+05  2.75168366e+07  7.62e+01 2.03e-01  1.54e+02     8s
   7  -2.50215194e+05  1.75478955e+07  3.71e+01 1.19e-01  8.99e+01     9s
   8  -1.52134015e+05  1.11616354e+07  1.20e+01 7.18e-02  5.15e+01     9s
   9  -1.05441359e+05  4.15790163e+06  5.82e+00 2.38e-02  1.89e+01     9s
  10  -8.38103085e+04  1.67933321e+06  3.70e+00 9.55e-03  7.72e+00     9s
  11  -4.64541706e+04  7.13439045e+05  1.91e+00 3.87e-03  3.28e+00     9s
  12  -6.63436663e+03  4.75717281e+05  1.09e+00 2.61e-03  2.07e+00     9s
  13   1.26980111e+04  2.80164142e+05  8.14e-01 1.29e-03  1.15e+00     9s
  14   3.75172781e+04  1.88694615e+05  5.45e-01 2.41e-03  6.49e-01     9s
  15   5.17972768e+04  1.64551031e+05  4.14e-01 1.84e-03  4.84e-01     9s
  16   6.27836713e+04  1.46048128e+05  3.10e-01 1.76e-03  3.57e-01    10s
  17   6.62170594e+04  1.34142689e+05  2.76e-01 2.26e-03  2.92e-01    10s
  18   7.45272321e+04  1.26532337e+05  1.98e-01 1.76e-03  2.23e-01    10s
  19   8.03624771e+04  1.15672227e+05  1.46e-01 1.86e-03  1.52e-01    10s
  20   8.25292469e+04  1.11088015e+05  1.29e-01 1.70e-03  1.23e-01    10s
  21   8.74522165e+04  1.07291255e+05  8.92e-02 2.29e-03  8.53e-02    10s
  22   9.06572577e+04  1.06169943e+05  6.45e-02 1.95e-03  6.66e-02    10s
  23   9.19145158e+04  1.05270566e+05  5.48e-02 1.80e-03  5.73e-02    10s
  24   9.35041901e+04  1.03717722e+05  4.28e-02 1.38e-03  4.39e-02    11s
  25   9.44702041e+04  1.02581661e+05  3.57e-02 1.45e-03  3.49e-02    11s
  26   9.66388256e+04  1.01660674e+05  2.03e-02 1.30e-03  2.16e-02    11s
  27   9.75877073e+04  1.01373588e+05  1.37e-02 1.28e-03  1.62e-02    11s
  28   9.82395644e+04  1.00897940e+05  9.36e-03 8.86e-04  1.14e-02    11s
  29   9.88212459e+04  1.00414835e+05  5.60e-03 8.61e-04  6.83e-03    11s
  30   9.90486245e+04  1.00120347e+05  4.19e-03 4.72e-04  4.60e-03    11s
  31   9.92149105e+04  1.00035309e+05  3.20e-03 3.30e-04  3.52e-03    12s
  32   9.93882666e+04  9.99478642e+04  2.18e-03 2.14e-04  2.40e-03    12s
  33   9.94726785e+04  9.99017827e+04  1.69e-03 1.51e-04  1.84e-03    12s
  34   9.95997020e+04  9.98562594e+04  9.64e-04 9.32e-05  1.10e-03    12s
  35   9.96359844e+04  9.98384122e+04  7.70e-04 7.08e-05  8.68e-04    12s
  36   9.97204444e+04  9.98211584e+04  3.00e-04 4.92e-05  4.31e-04    12s
  37   9.97443411e+04  9.98150861e+04  1.67e-04 4.15e-05  3.02e-04    12s
  38   9.97658891e+04  9.97910919e+04  5.67e-05 1.21e-05  1.08e-04    13s
  39   9.97731350e+04  9.97816570e+04  2.67e-05 1.66e-06  3.65e-05    13s
  40   9.97783897e+04  9.97802883e+04  6.33e-06 4.33e-07  8.13e-06    13s
  41   9.97800292e+04  9.97800473e+04  2.08e-08 5.11e-08  7.71e-08    13s
  42   9.97800424e+04  9.97800425e+04  3.45e-09 3.93e-10  1.79e-10    13s

Barrier solved model in 42 iterations and 13.22 seconds (11.00 work units)
Optimal objective 9.97800424e+04


Root crossover log...

  117238 DPushes remaining with DInf 0.0000000e+00                13s
   33358 DPushes remaining with DInf 0.0000000e+00                15s
    1142 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    2164 PPushes remaining with PInf 1.2068904e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.4941548e+01     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58161    9.9780042e+04   0.000000e+00   3.494155e+01     21s
   58183    9.9780042e+04   0.000000e+00   0.000000e+00     21s
   58183    9.9780042e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 1.17s

Solved with barrier

Root relaxation: objective 9.978004e+04, 58183 iterations, 17.50 seconds (21.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99780.0425    0  123 -201494.13 99780.0425   150%     -   23s
H    0     0                    -200416.4398 99780.0425   150%     -   23s
H    0     0                    -190832.6447 99780.0425   152%     -   24s
H    0     0                    -190549.8059 99780.0425   152%     -   24s
H    0     0                    -180838.0408 99780.0425   155%     -   24s
H    0     0                    -119529.3806 99780.0425   183%     -   24s
H    0     0                    -98587.49234 99780.0425   201%     -   24s
H    0     0                    -98586.72398 99780.0425   201%     -   24s
H    0     0                    -98067.86538 99780.0425   202%     -   25s
H    0     0                    -97260.47430 99780.0425   203%     -   25s
H    0     0                    -95334.65353 99780.0425   205%     -   25s
H    0     0                    -94367.52652 99780.0425   206%     -   25s
H    0     0                    -90418.77496 99780.0425   210%     -   25s
H    0     0                    -88500.99634 99780.0425   213%     -   25s
H    0     0                    -87047.12530 99780.0425   215%     -   25s
H    0     0                    -87018.41014 99780.0425   215%     -   26s
H    0     0                    26365.915341 99780.0425   278%     -   26s
H    0     0                    26713.585491 99780.0425   274%     -   28s
H    0     0                    32111.225818 99780.0425   211%     -   28s
H    0     0                    33682.949698 99780.0425   196%     -   28s
H    0     0                    34727.490619 99780.0425   187%     -   28s
H    0     0                    34891.398944 99780.0425   186%     -   28s
H    0     0                    35557.440994 99780.0425   181%     -   31s
H    0     0                    36236.424488 99780.0425   175%     -   31s
H    0     0                    37854.027420 99780.0425   164%     -   31s
H    0     0                    37922.856266 99780.0425   163%     -   31s
H    0     0                    38506.682529 99780.0425   159%     -   31s
H    0     0                    38531.247562 99780.0425   159%     -   31s
H    0     0                    39335.300892 99780.0425   154%     -   31s
H    0     0                    39555.391035 94797.1371   140%     -  152s
H    0     0                    39558.953459 94797.1371   140%     -  152s
H    0     0                    39813.090367 94797.1371   138%     -  152s
     0     0 94303.4060    0  153 39813.0904 94303.4060   137%     -  152s
H    0     0                    40062.890556 94303.4060   135%     -  154s
H    0     0                    40108.803557 94303.4060   135%     -  154s
H    0     0                    40334.866454 94303.4060   134%     -  154s
H    0     0                    40421.236430 94303.4060   133%     -  154s
     0     0 93698.4636    0  171 40421.2364 93698.4636   132%     -  236s
     0     0 93688.0236    0  177 40421.2364 93688.0236   132%     -  280s
     0     0 93688.0236    0  184 40421.2364 93688.0236   132%     -  292s
     0     0 93688.0236    0  182 40421.2364 93688.0236   132%     -  296s
     0     0 93688.0236    0  184 40421.2364 93688.0236   132%     -  306s
     0     0 93688.0236    0  218 40421.2364 93688.0236   132%     -  321s
     0     0 93688.0236    0  220 40421.2364 93688.0236   132%     -  329s
     0     0 93688.0236    0  216 40421.2364 93688.0236   132%     -  331s
H    0     0                    40585.143199 90009.2367   122%     -  467s
H    0     0                    40906.162504 90009.2367   120%     -  467s
     0     0 90009.2367    0  324 40906.1625 90009.2367   120%     -  467s
H    0     0                    41245.611446 90009.1780   118%     -  468s
H    0     0                    47452.086247 90009.1780  89.7%     -  468s
     0     0 89453.2087    0  323 47452.0862 89453.2087  88.5%     -  566s
     0     0 89259.2416    0  297 47452.0862 89259.2416  88.1%     -  622s
     0     0 89192.1613    0  334 47452.0862 89192.1613  88.0%     -  652s
     0     0 89115.9556    0  300 47452.0862 89115.9556  87.8%     -  679s
     0     0 88988.5527    0  304 47452.0862 88988.5527  87.5%     -  716s
     0     0 88862.9323    0  301 47452.0862 88862.9323  87.3%     -  760s
     0     0 88760.2998    0  320 47452.0862 88760.2998  87.1%     -  803s
     0     0 88746.3049    0  330 47452.0862 88746.3049  87.0%     -  819s
     0     0 88721.9986    0  329 47452.0862 88721.9986  87.0%     -  835s
     0     0 88644.5622    0  337 47452.0862 88644.5622  86.8%     -  866s
     0     0 88609.2377    0  331 47452.0862 88609.2377  86.7%     -  885s
     0     0 88598.3676    0  341 47452.0862 88598.3676  86.7%     -  891s
     0     0 88577.5269    0  345 47452.0862 88577.5269  86.7%     -  900s
     0     0 88569.9181    0  342 47452.0862 88569.9181  86.7%     -  905s
     0     0 88556.9548    0  337 47452.0862 88556.9548  86.6%     -  916s
     0     0 88546.8513    0  337 47452.0862 88546.8513  86.6%     -  921s
     0     0 88543.1891    0  341 47452.0862 88543.1891  86.6%     -  925s
     0     0 88543.1403    0  337 47452.0862 88543.1403  86.6%     -  925s
H    0     0                    48270.094858 88543.1403  83.4%     -  956s
H    0     0                    48313.725405 88543.1403  83.3%     -  956s
H    0     0                    49023.924006 88543.1403  80.6%     -  956s
H    0     0                    49239.210479 88543.1403  79.8%     -  956s
H    0     0                    49517.084305 88543.1403  78.8%     -  956s
H    0     0                    49555.337532 88543.1403  78.7%     -  956s
H    0     0                    49555.957355 86890.5188  75.3%     - 1037s
H    0     0                    49588.563741 86890.5188  75.2%     - 1037s
     0     0 86890.5188    0  341 49588.5637 86890.5188  75.2%     - 1037s
H    0     0                    49677.476258 86516.7380  74.2%     - 1089s
     0     0 86516.7380    0  351 49677.4763 86516.7380  74.2%     - 1090s
     0     0 86407.2071    0  351 49677.4763 86407.2071  73.9%     - 1119s
     0     0 86241.4116    0  357 49677.4763 86241.4116  73.6%     - 1150s
     0     0 86193.2847    0  357 49677.4763 86193.2847  73.5%     - 1174s
     0     0 86126.7678    0  354 49677.4763 86126.7678  73.4%     - 1194s
     0     0 86084.0808    0  361 49677.4763 86084.0808  73.3%     - 1222s
     0     0 86067.4968    0  360 49677.4763 86067.4968  73.3%     - 1238s
     0     0 86059.9776    0  360 49677.4763 86059.9776  73.2%     - 1245s
     0     0 86041.9318    0  368 49677.4763 86041.9318  73.2%     - 1254s
     0     0 86034.0709    0  375 49677.4763 86034.0709  73.2%     - 1263s
     0     0 86031.5901    0  367 49677.4763 86031.5901  73.2%     - 1269s
     0     0 86018.0430    0  370 49677.4763 86018.0430  73.2%     - 1275s
     0     0 86011.3954    0  384 49677.4763 86011.3954  73.1%     - 1280s
     0     0 85982.3934    0  375 49677.4763 85982.3934  73.1%     - 1285s
     0     0 85973.4718    0  369 49677.4763 85973.4718  73.1%     - 1292s
     0     0 85970.0681    0  363 49677.4763 85970.0681  73.1%     - 1294s
     0     0 85965.1569    0  375 49677.4763 85965.1569  73.0%     - 1298s
     0     0 85960.4440    0  373 49677.4763 85960.4440  73.0%     - 1301s
     0     0 85959.6349    0  374 49677.4763 85959.6349  73.0%     - 1302s
     0     0 85237.5453    0  375 49677.4763 85237.5453  71.6%     - 1400s
     0     0 85064.9488    0  389 49677.4763 85064.9488  71.2%     - 1439s
     0     0 84971.2025    0  390 49677.4763 84971.2025  71.0%     - 1474s
     0     0 84924.4332    0  398 49677.4763 84924.4332  71.0%     - 1495s
     0     0 84882.2627    0  382 49677.4763 84882.2627  70.9%     - 1509s
     0     0 84868.4956    0  390 49677.4763 84868.4956  70.8%     - 1520s
     0     0 84860.5567    0  394 49677.4763 84860.5567  70.8%     - 1532s
     0     0 84859.5267    0  394 49677.4763 84859.5267  70.8%     - 1537s
     0     0 84739.2024    0  349 49677.4763 84739.2024  70.6%     - 1566s
H    0     0                    49843.827329 84738.5555  70.0%     - 1567s
H    0     0                    50003.379082 84738.5555  69.5%     - 1567s
     0     0 84683.1014    0  355 50003.3791 84683.1014  69.4%     - 1591s
     0     0 84671.4080    0  353 50003.3791 84671.4080  69.3%     - 1603s
     0     0 84665.4643    0  360 50003.3791 84665.4643  69.3%     - 1608s
     0     0 84655.2326    0  359 50003.3791 84655.2326  69.3%     - 1612s
     0     0 84643.3590    0  353 50003.3791 84643.3590  69.3%     - 1622s
     0     0 84633.3699    0  353 50003.3791 84633.3699  69.3%     - 1632s
     0     0 84630.8296    0  350 50003.3791 84630.8296  69.3%     - 1637s
     0     0 84625.6471    0  354 50003.3791 84625.6471  69.2%     - 1644s
     0     0 84622.0547    0  353 50003.3791 84622.0547  69.2%     - 1650s
     0     0 84621.8129    0  356 50003.3791 84621.8129  69.2%     - 1651s
H    0     0                    50038.432045 84532.3254  68.9%     - 1688s
H    0     0                    50052.272944 84532.3254  68.9%     - 1688s
H    0     0                    50108.239293 84532.3254  68.7%     - 1688s
H    0     0                    50227.206867 84532.3254  68.3%     - 1688s
     0     0 84532.3254    0  360 50227.2069 84532.3254  68.3%     - 1688s
     0     0 84493.2578    0  361 50227.2069 84493.2578  68.2%     - 1735s
     0     0 84482.5247    0  399 50227.2069 84482.5247  68.2%     - 1740s
     0     0 84475.6719    0  356 50227.2069 84475.6719  68.2%     - 1746s
     0     0 84470.2949    0  355 50227.2069 84470.2949  68.2%     - 1748s
     0     0 84467.8400    0  360 50227.2069 84467.8400  68.2%     - 1752s
     0     0 84467.1801    0  360 50227.2069 84467.1801  68.2%     - 1753s
     0     0 84419.1954    0  374 50227.2069 84419.1954  68.1%     - 1777s
     0     0 84394.0460    0  373 50227.2069 84394.0460  68.0%     - 1790s
     0     0 84390.6051    0  373 50227.2069 84390.6051  68.0%     - 1795s
     0     0 84387.1342    0  378 50227.2069 84387.1342  68.0%     - 1798s
     0     0 84386.3612    0  375 50227.2069 84386.3612  68.0%     - 1801s
     0     0 84337.8526    0  366 50227.2069 84337.8526  67.9%     - 1813s
     0     0 84327.5756    0  371 50227.2069 84327.5756  67.9%     - 1828s
     0     0 84318.3549    0  363 50227.2069 84318.3549  67.9%     - 1839s
     0     0 84315.6529    0  366 50227.2069 84315.6529  67.9%     - 1846s
     0     0 84315.5075    0  364 50227.2069 84315.5075  67.9%     - 1848s
     0     0 84286.9328    0  357 50227.2069 84286.9328  67.8%     - 1866s
H    0     0                    50251.966779 84286.5048  67.7%     - 1867s
     0     0 84263.5103    0  371 50251.9668 84263.5103  67.7%     - 1879s
     0     0 84262.7029    0  373 50251.9668 84262.7029  67.7%     - 1884s
     0     0 84258.3249    0  412 50251.9668 84258.3249  67.7%     - 1894s
H    0     0                    50393.858382 84257.7240  67.2%     - 1898s
H    0     0                    50442.442630 84257.7240  67.0%     - 1901s
H    0     0                    50588.904705 84257.7240  66.6%     - 1901s
     0     0 84256.8311    0  368 50588.9047 84256.8311  66.6%     - 1908s
     0     0 84255.1341    0  366 50588.9047 84255.1341  66.5%     - 1913s
     0     0 84254.7885    0  368 50588.9047 84254.7885  66.5%     - 1915s
     0     0 84254.3619    0  366 50588.9047 84254.3619  66.5%     - 1918s
H    0     0                    51167.346383 84254.3160  64.7%     - 1981s
H    0     0                    51357.563510 84254.2967  64.1%     - 1982s
H    0     0                    51675.031594 84254.2967  63.0%     - 1982s
H    0     0                    51720.944594 84254.2967  62.9%     - 1982s
     0     0 84254.2967    0  367 51720.9446 84254.2967  62.9%     - 1982s
     0     0 84254.2470    0  364 51720.9446 84254.2470  62.9%     - 1985s
H    0     0                    52172.807912 84254.0879  61.5%     - 1986s
H    0     0                    52349.691149 84254.0879  60.9%     - 1987s
     0     0 84254.0879    0  364 52349.6911 84254.0879  60.9%     - 1987s
     0     0 84253.8423    0  364 52349.6911 84253.8423  60.9%     - 1990s
     0     0 84253.3415    0  364 52349.6911 84253.3415  60.9%     - 1993s
H    0     0                    52490.447201 84253.2339  60.5%     - 2187s
H    0     0                    52493.538437 84253.2339  60.5%     - 2187s
H    0     0                    52533.118554 84253.0996  60.4%     - 2434s
H    0     0                    52586.714423 84253.0996  60.2%     - 2441s
H    0     0                    56186.156106 84253.0996  50.0%     - 2447s
     0     2 84253.0996    0  364 56186.1561 84253.0996  50.0%     - 2452s
     1     3 84066.0269    1  394 56186.1561 84253.0996  50.0% 14214 2477s
     2     4 84214.5939    1  361 56186.1561 84214.5939  49.9% 10169 2492s
     3     5 83141.1979    2  369 56186.1561 84213.9450  49.9% 12686 2524s
     4     9 84095.3196    2  360 56186.1561 84213.7840  49.9% 10750 2553s
     8    17 83797.1229    3  351 56186.1561 84093.5019  49.7% 10036 2601s
    16    33 83673.6865    4  348 56186.1561 84093.5019  49.7% 12520 2677s
    32    48 82833.8906    5  346 56186.1561 83796.5990  49.1% 22000 2871s
    47    75 80997.0701    6  348 56186.1561 83796.5990  49.1% 23424 2982s
H   49    75                    57300.203524 83796.5990  46.2% 23031 2982s
H   51    75                    57407.763597 83796.5990  46.0% 22795 2982s
H   56    75                    57750.352625 83796.5990  45.1% 22015 2982s
    74   184 81432.1470    5  345 57750.3526 83673.0059  44.9% 19749 3112s
   183   244 81314.8086    6  325 57750.3526 83673.0059  44.9% 12012 3176s
   243   314 81218.4126    7  331 57750.3526 83673.0059  44.9% 11531 3237s
   313   362 80893.2903    9  306 57750.3526 83673.0059  44.9% 10408 3287s
   361   413 80751.1830   10  306 57750.3526 83673.0059  44.9%  9982 3345s
   412   440 80613.9912   11  299 57750.3526 83673.0059  44.9%  9527 3384s
   439   468 80348.5739   12  304 57750.3526 83673.0059  44.9%  9453 3437s
   467   499 80311.5373   12  288 57750.3526 83673.0059  44.9%  9281 3480s
   498   532 78139.7324   19  281 57750.3526 83673.0059  44.9%  9529 3527s
H  513   532                    58029.378463 83673.0059  44.2%  9448 3527s
   531   616 80159.6582   13  300 58029.3785 83673.0059  44.2%  9289 3585s
   615   632 79841.7703   16  288 58029.3785 83673.0059  44.2%  8547 3600s

Cutting planes:
  Learned: 6
  Gomory: 10
  Implied bound: 134
  MIR: 2565
  Flow cover: 2495
  RLT: 80
  Relax-and-lift: 389

Explored 631 nodes (5993038 simplex iterations) in 3600.10 seconds (4664.56 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 58029.4 57750.4 57407.8 ... 52349.7

Time limit reached
Best objective 5.802937846264e+04, best bound 8.367300590081e+04, gap 44.1908%
  WARNING: Time limit reached. Using best solution found (gap: 44.19%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 58029.38, θ = 233915.62
  Upper Bound (UB) = 58029.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 233915.62
  [DEBUG]   ✓ Scenario 0: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 233915.62 ≤ Q = 233915.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 233915.62 ≤ Q = 233915.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 233915.62 ≤ Q = 233915.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 233915.62 ≤ Q = 233915.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 233915.62 ≤ Q = 233915.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 233915.62 ≤ Q = 233915.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 233915.62 ≤ Q = 233915.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x39fc3069
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc603cf97
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.245755e+13
Presolve removed 2578 rows and 1867 columns
Presolve time: 0.01s
Presolved: 515 rows, 522 columns, 1459 nonzeros
Found heuristic solution: objective 5885581.9303
Variable types: 356 continuous, 166 integer (166 binary)

Root relaxation: objective -1.734345e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173434.51    0  127 5885581.93 -173434.51   103%     -    0s
H    0     0                    -138537.6603 -173434.51  25.2%     -    0s
H    0     0                    -139737.8338 -173434.51  24.1%     -    0s
     0     0 -150441.99    0   63 -139737.83 -150441.99  7.66%     -    0s
H    0     0                    -148083.3535 -150416.90  1.58%     -    0s
     0     0 -150398.26    0   50 -148083.35 -150398.26  1.56%     -    0s
     0     0 -150394.39    0   47 -148083.35 -150394.39  1.56%     -    0s
     0     0 -149887.94    0   39 -148083.35 -149887.94  1.22%     -    0s
H    0     0                    -148855.3759 -149887.94  0.69%     -    0s
     0     0 -149883.19    0   39 -148855.38 -149883.19  0.69%     -    0s
H    0     0                    -149071.9119 -149883.19  0.54%     -    0s
H    0     0                    -149459.6710 -149883.19  0.28%     -    0s
     0     0 -149578.80    0   24 -149459.67 -149578.80  0.08%     -    0s
     0     0 -149542.77    0   11 -149459.67 -149542.77  0.06%     -    0s
     0     0 -149540.99    0   10 -149459.67 -149540.99  0.05%     -    0s
     0     0 -149531.99    0    6 -149459.67 -149531.99  0.05%     -    0s
     0     0 -149519.67    0    7 -149459.67 -149519.67  0.04%     -    0s
H    0     0                    -149483.9341 -149519.67  0.02%     -    0s
     0     0          -    0      -149483.93 -149495.80  0.01%     -    0s

Cutting planes:
  Gomory: 19
  Implied bound: 1
  MIR: 127
  Flow cover: 5
  RLT: 27
  Relax-and-lift: 1

Explored 1 nodes (522 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -149484 -149460 -148855 ... 1.24576e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.494839341112e+05, best bound -1.494958001653e+05, gap 0.0079%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 225187.31
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149483.93
  [DEBUG]   S×d_nominal = 374671.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 374671.25 + -149483.93 = 225187.31
  [DEBUG]   Current θ from Master = 233915.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8728.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 49301.07
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 437.2712, Absolute Gap = 437.2712, Relative Gap = 0.007535
  Not converged yet (gap = 437.27 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697359 nonzeros
Model fingerprint: 0x38a125be
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 108432 rows and 44032 columns (presolve time = 5s)...
Presolve removed 108432 rows and 44032 columns
Presolve time: 6.00s
Presolved: 137591 rows, 58068 columns, 847664 nonzeros
Variable types: 55809 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -201494.1305

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.61s

Barrier statistics:
 Dense cols : 630
 AA' NZ     : 6.924e+06
 Factor NZ  : 1.515e+07 (roughly 200 MB of memory)
 Factor Ops : 3.307e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83592460e+07  2.29840035e+08  1.43e+05 1.87e+01  8.66e+04    10s
   1  -1.41509846e+07  2.19909464e+08  1.02e+05 7.59e+01  6.15e+04    10s
   2  -4.82647977e+06  1.72198387e+08  3.53e+04 5.94e-01  2.28e+04    10s
   3  -7.90310382e+05  1.30021708e+08  1.57e+03 1.40e+00  1.49e+03    10s
   4  -5.83143786e+05  7.23150120e+07  6.15e+02 5.81e-01  6.35e+02    10s
   5  -5.09437904e+05  5.77062023e+07  4.44e+02 4.34e-01  4.69e+02    10s
   6  -3.74566879e+05  4.45751183e+07  1.66e+02 3.11e-01  2.62e+02    10s
   7  -3.30532795e+05  3.01324240e+07  6.66e+01 1.97e-01  1.51e+02    11s
   8  -2.56102508e+05  2.02448120e+07  1.38e+01 1.25e-01  8.66e+01    11s
   9  -1.68482845e+05  9.66413145e+06  2.81e+00 6.16e-02  3.98e+01    11s
  10  -1.06996301e+05  6.55527500e+06  1.51e+00 4.12e-02  2.68e+01    11s
  11  -9.63313495e+04  3.81942066e+06  1.30e+00 2.37e-02  1.57e+01    11s
  12  -6.04098951e+04  2.72941661e+06  6.03e-01 1.68e-02  1.11e+01    11s
  13  -3.93364708e+04  9.88480781e+05  3.79e-01 5.54e-03  4.10e+00    11s
  14   1.02516893e+04  3.92650866e+05  1.21e-01 2.43e-03  1.52e+00    12s
  15   2.26740656e+04  2.97838053e+05  9.55e-02 2.48e-03  1.10e+00    12s
  16   3.48373536e+04  2.06455149e+05  7.84e-02 2.43e-03  6.84e-01    12s
  17   4.85374081e+04  1.86521149e+05  6.19e-02 2.03e-03  5.50e-01    12s
  18   6.08820438e+04  1.53719919e+05  4.58e-02 1.82e-03  3.70e-01    12s
  19   6.96753109e+04  1.37698221e+05  3.41e-02 1.30e-03  2.71e-01    12s
  20   7.02357943e+04  1.31909213e+05  3.33e-02 1.11e-03  2.46e-01    12s
  21   7.43047436e+04  1.26182419e+05  2.82e-02 9.27e-04  2.07e-01    13s
  22   7.99888716e+04  1.21972821e+05  2.12e-02 7.84e-04  1.67e-01    13s
  23   8.29747527e+04  1.16373695e+05  1.76e-02 5.88e-04  1.33e-01    13s
  24   8.63413308e+04  1.10207041e+05  1.37e-02 4.61e-04  9.52e-02    13s
  25   8.89968864e+04  1.08288879e+05  1.08e-02 3.81e-04  7.69e-02    13s
  26   9.08277397e+04  1.07440088e+05  8.77e-03 3.46e-04  6.62e-02    14s
  27   9.19857650e+04  1.05725916e+05  7.51e-03 2.71e-04  5.48e-02    14s
  28   9.32574069e+04  1.04706362e+05  6.20e-03 2.27e-04  4.56e-02    14s
  29   9.41781589e+04  1.03754183e+05  5.27e-03 1.84e-04  3.82e-02    14s
  30   9.54488096e+04  1.02068780e+05  4.00e-03 1.06e-04  2.64e-02    14s
  31   9.65953104e+04  1.01467967e+05  2.89e-03 1.72e-04  1.94e-02    15s
  32   9.73190486e+04  1.01321051e+05  2.20e-03 1.57e-04  1.60e-02    15s
  33   9.75361539e+04  1.00911235e+05  2.00e-03 1.15e-04  1.35e-02    15s
  34   9.81919019e+04  1.00667773e+05  1.39e-03 8.97e-05  9.87e-03    15s
  35   9.87601859e+04  1.00372986e+05  8.67e-04 5.85e-05  6.43e-03    15s
  36   9.90562307e+04  1.00149288e+05  6.01e-04 3.62e-05  4.36e-03    16s
  37   9.93913006e+04  9.99917875e+04  3.22e-04 2.02e-05  2.39e-03    16s
  38   9.94396217e+04  9.99634428e+04  2.79e-04 1.75e-05  2.09e-03    16s
  39   9.95706609e+04  9.99021892e+04  1.67e-04 1.15e-05  1.32e-03    16s
  40   9.96384935e+04  9.98393623e+04  1.11e-04 5.39e-06  8.01e-04    16s
  41   9.97149596e+04  9.98188990e+04  4.84e-05 3.55e-06  4.14e-04    16s
  42   9.97576150e+04  9.97957608e+04  1.36e-05 1.30e-06  1.52e-04    17s
  43   9.97732710e+04  9.97818434e+04  3.76e-06 1.93e-07  3.42e-05    17s
  44   9.97796338e+04  9.97803831e+04  1.55e-07 2.82e-07  2.99e-06    17s
  45   9.97800252e+04  9.97800641e+04  1.02e-07 1.49e-08  1.55e-07    17s
  46   9.97800425e+04  9.97800425e+04  6.56e-10 6.14e-10  2.01e-11    17s

Barrier solved model in 46 iterations and 17.42 seconds (13.73 work units)
Optimal objective 9.97800425e+04


Root crossover log...

  124807 DPushes remaining with DInf 0.0000000e+00                17s
   22106 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    1327 PPushes remaining with PInf 2.4486620e-06                24s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9911554e-10     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57272    9.9780042e+04   0.000000e+00   0.000000e+00     25s
   57272    9.9780042e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.978004e+04, 57272 iterations, 17.77 seconds (21.16 work units)
Total elapsed time = 25.12s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99780.0425    0  123 -201494.13 99780.0425   150%     -   25s
H    0     0                    -55260.76845 99780.0425   281%     -   26s
H    0     0                    -41545.56413 99780.0425   340%     -   26s
H    0     0                    -40454.50673 99780.0425   347%     -   26s
H    0     0                    -35436.63599 99780.0425   382%     -   27s
H    0     0                    -35407.92083 99780.0425   382%     -   27s
H    0     0                    30528.286157 99780.0425   227%     -   27s
H    0     0                    31038.184444 99780.0425   221%     -   28s
H    0     0                    36172.902485 99780.0425   176%     -   30s
H    0     0                    36773.869558 99780.0425   171%     -   30s
H    0     0                    36993.137036 99780.0425   170%     -   30s
H    0     0                    37005.088894 99780.0425   170%     -   30s
H    0     0                    37554.001308 99780.0425   166%     -   30s
H    0     0                    38219.077265 99780.0425   161%     -   31s
H    0     0                    38242.280597 99780.0425   161%     -   31s
H    0     0                    38780.297088 99780.0425   157%     -   31s
     0     0 95023.6923    0  165 38780.2971 95023.6923   145%     -  180s
     0     0 94386.9222    0  179 38780.2971 94386.9222   143%     -  272s
     0     0 93796.8196    0  186 38780.2971 93796.8196   142%     -  371s
     0     0 93748.5667    0  193 38780.2971 93748.5667   142%     -  412s
     0     0 93733.8716    0  195 38780.2971 93733.8716   142%     -  423s
     0     0 93706.0567    0  198 38780.2971 93706.0567   142%     -  433s
     0     0 93701.9716    0  196 38780.2971 93701.9716   142%     -  436s
     0     0 93701.9716    0  196 38780.2971 93701.9716   142%     -  437s
     0     0 90134.0704    0  269 38780.2971 90134.0704   132%     -  569s
H    0     0                    41986.960911 90133.9847   115%     -  570s
H    0     0                    42458.776341 90133.9847   112%     -  571s
H    0     0                    42495.611767 90133.9847   112%     -  571s
H    0     0                    42497.634243 90133.9847   112%     -  571s
     0     0 89413.9336    0  281 42497.6342 89413.9336   110%     -  661s
     0     0 89252.4444    0  331 42497.6342 89252.4444   110%     -  732s
     0     0 89107.0663    0  314 42497.6342 89107.0663   110%     -  773s
     0     0 88986.2415    0  316 42497.6342 88986.2415   109%     -  813s
     0     0 88905.8833    0  321 42497.6342 88905.8833   109%     -  845s
     0     0 88849.1529    0  318 42497.6342 88849.1529   109%     -  869s
     0     0 88834.4147    0  315 42497.6342 88834.4147   109%     -  879s
     0     0 88826.2850    0  322 42497.6342 88826.2850   109%     -  886s
     0     0 88824.8004    0  321 42497.6342 88824.8004   109%     -  888s
     0     0 88824.4388    0  326 42497.6342 88824.4388   109%     -  890s
     0     0 86831.2879    0  342 42497.6342 86831.2879   104%     - 1036s
     0     0 86404.3908    0  364 42497.6342 86404.3908   103%     - 1111s
     0     0 86200.0269    0  374 42497.6342 86200.0269   103%     - 1155s
     0     0 86042.4696    0  373 42497.6342 86042.4696   102%     - 1204s
     0     0 85967.7188    0  375 42497.6342 85967.7188   102%     - 1227s
     0     0 85909.7670    0  387 42497.6342 85909.7670   102%     - 1252s
     0     0 85893.1107    0  377 42497.6342 85893.1107   102%     - 1271s
     0     0 85873.2471    0  391 42497.6342 85873.2471   102%     - 1286s
     0     0 85861.5654    0  391 42497.6342 85861.5654   102%     - 1295s
     0     0 85800.9643    0  378 42497.6342 85800.9643   102%     - 1315s
     0     0 85767.7106    0  387 42497.6342 85767.7106   102%     - 1331s
     0     0 85761.7939    0  383 42497.6342 85761.7939   102%     - 1341s
     0     0 85759.2484    0  388 42497.6342 85759.2484   102%     - 1346s
     0     0 85758.4540    0  388 42497.6342 85758.4540   102%     - 1351s
     0     0 85188.6904    0  383 42497.6342 85188.6904   100%     - 1469s
     0     0 84980.3581    0  345 42497.6342 84980.3581   100%     - 1521s
     0     0 84912.7573    0  355 42497.6342 84912.7573   100%     - 1546s
     0     0 84892.3436    0  354 42497.6342 84892.3436   100%     - 1561s
     0     0 84878.7150    0  363 42497.6342 84878.7150   100%     - 1576s
     0     0 84869.3401    0  365 42497.6342 84869.3401   100%     - 1589s
     0     0 84864.3900    0  366 42497.6342 84864.3900   100%     - 1594s
     0     0 84857.0311    0  360 42497.6342 84857.0311   100%     - 1602s
     0     0 84852.3698    0  354 42497.6342 84852.3698   100%     - 1609s
     0     0 84842.2860    0  353 42497.6342 84842.2860   100%     - 1618s
     0     0 84835.1928    0  361 42497.6342 84835.1928   100%     - 1625s
     0     0 84822.3274    0  353 42497.6342 84822.3274   100%     - 1638s
     0     0 84795.1117    0  359 42497.6342 84795.1117   100%     - 1656s
     0     0 84777.0771    0  363 42497.6342 84777.0771  99.5%     - 1668s
     0     0 84771.0543    0  357 42497.6342 84771.0543  99.5%     - 1675s
     0     0 84769.4044    0  359 42497.6342 84769.4044  99.5%     - 1677s
     0     0 84615.4365    0  403 42497.6342 84615.4365  99.1%     - 1713s
H    0     0                    42580.787222 84615.2910  98.7%     - 1713s
     0     0 84579.5127    0  408 42580.7872 84579.5127  98.6%     - 1729s
     0     0 84560.6690    0  409 42580.7872 84560.6690  98.6%     - 1740s
     0     0 84549.7728    0  414 42580.7872 84549.7728  98.6%     - 1749s
     0     0 84543.9453    0  413 42580.7872 84543.9453  98.5%     - 1752s
     0     0 84527.2352    0  410 42580.7872 84527.2352  98.5%     - 1760s
     0     0 84515.5392    0  420 42580.7872 84515.5392  98.5%     - 1766s
     0     0 84512.8001    0  423 42580.7872 84512.8001  98.5%     - 1770s
     0     0 84512.6148    0  421 42580.7872 84512.6148  98.5%     - 1771s
     0     0 84477.5658    0  353 42580.7872 84477.5658  98.4%     - 1790s
H    0     0                    42712.189700 84474.8817  97.8%     - 1792s
H    0     0                    42828.885164 84474.8817  97.2%     - 1792s
H    0     0                    42937.623526 84474.8817  96.7%     - 1792s
     0     0 84456.4935    0  399 42937.6235 84456.4935  96.7%     - 1810s
     0     0 84446.6389    0  358 42937.6235 84446.6389  96.7%     - 1822s
     0     0 84440.5328    0  359 42937.6235 84440.5328  96.7%     - 1828s
     0     0 84439.5207    0  361 42937.6235 84439.5207  96.7%     - 1830s
     0     0 84426.9411    0  369 42937.6235 84426.9411  96.6%     - 1845s
     0     0 84423.7058    0  366 42937.6235 84423.7058  96.6%     - 1850s
     0     0 84422.2335    0  372 42937.6235 84422.2335  96.6%     - 1852s
     0     0 84412.0466    0  373 42937.6235 84412.0466  96.6%     - 1869s
H    0     0                    43780.185089 84411.0912  92.8%     - 1871s
H    0     0                    43963.593047 84411.0912  92.0%     - 1871s
     0     0 84409.0080    0  379 43963.5930 84409.0080  92.0%     - 1878s
     0     0 84408.6037    0  377 43963.5930 84408.6037  92.0%     - 1880s
     0     0 84399.5587    0  365 43963.5930 84399.5587  92.0%     - 1888s
     0     0 84393.7175    0  371 43963.5930 84393.7175  92.0%     - 1894s
     0     0 84389.2219    0  371 43963.5930 84389.2219  92.0%     - 1899s
     0     0 84387.5095    0  376 43963.5930 84387.5095  91.9%     - 1907s
     0     0 84351.6876    0  364 43963.5930 84351.6876  91.9%     - 1929s
H    0     0                    45810.159303 84350.9318  84.1%     - 1941s
     0     0 84346.8006    0  368 45810.1593 84346.8006  84.1%     - 1949s
     0     0 84345.0340    0  372 45810.1593 84345.0340  84.1%     - 1955s
     0     0 84337.7058    0  362 45810.1593 84337.7058  84.1%     - 1971s
H    0     0                    46008.812852 84337.6830  83.3%     - 1972s
H    0     0                    47494.996060 84337.6830  77.6%     - 1972s
     0     0 84334.3378    0  368 47494.9961 84334.3378  77.6%     - 1980s
     0     0 84333.0089    0  391 47494.9961 84333.0089  77.6%     - 1985s
     0     0 84327.2960    0  372 47494.9961 84327.2960  77.5%     - 1993s
H    0     0                    47868.596492 84326.6773  76.2%     - 1995s
H    0     0                    48353.883568 84326.6773  74.4%     - 1995s
H    0     0                    48662.769367 84326.6773  73.3%     - 1995s
     0     0 84324.7436    0  371 48662.7694 84324.7436  73.3%     - 2001s
     0     0 84323.8144    0  375 48662.7694 84323.8144  73.3%     - 2003s
     0     0 84320.0427    0  379 48662.7694 84320.0427  73.3%     - 2010s
     0     0 84319.8997    0  379 48662.7694 84319.8997  73.3%     - 2014s
H    0     0                    49249.721925 84319.1421  71.2%     - 2198s
     0     2 84319.1421    0  379 49249.7219 84319.1421  71.2%     - 2369s
     1     3 83321.9815    1  376 49249.7219 84319.1421  71.2% 30195 2457s
     2     4 84200.4004    1  367 49249.7219 84200.4004  71.0% 19208 2474s
     3     6 84151.1834    2  352 49249.7219 84199.3390  71.0% 16493 2503s
     5    10 84047.3477    3  350 49249.7219 84199.3390  71.0% 15288 2542s
     9    18 83920.7320    4  347 49249.7219 84149.8269  70.9% 13422 2624s
    17    29 83855.0036    5  358 49249.7219 83939.9346  70.4% 14781 2699s
    28    39 78303.6178    5  317 49249.7219 83939.9346  70.4% 27951 3600s

Cutting planes:
  Learned: 2
  Gomory: 11
  Implied bound: 172
  MIR: 2386
  Flow cover: 2328
  RLT: 53
  Relax-and-lift: 318
  BQP: 1

Explored 38 nodes (1665666 simplex iterations) in 3600.17 seconds (4047.71 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 49249.7 48662.8 48353.9 ... 42937.6

Time limit reached
Best objective 4.924972192512e+04, best bound 8.385484109468e+04, gap 70.2646%
  WARNING: Time limit reached. Using best solution found (gap: 70.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 49249.72, θ = 225584.10
  Upper Bound (UB) = 49249.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225584.10
  [DEBUG]   ✓ Scenario 0: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225584.10 ≤ Q = 225656.26 (slack: 72.16)
  [DEBUG]   ✓ Scenario 2: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225584.10 ≤ Q = 225584.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 225584.10 ≤ Q = 225584.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 225584.10 ≤ Q = 225584.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 225584.10 ≤ Q = 225584.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 225584.10 ≤ Q = 225584.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 225584.10 ≤ Q = 225584.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 225584.10 ≤ Q = 225584.10 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x79932a7e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x79932a7e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.268008e+13
Presolve removed 2579 rows and 1878 columns
Presolve time: 0.01s
Presolved: 514 rows, 511 columns, 1450 nonzeros
Found heuristic solution: objective 5397892.4732
Variable types: 345 continuous, 166 integer (166 binary)

Root relaxation: objective -1.695203e+05, 272 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169520.30    0  127 5397892.47 -169520.30   103%     -    0s
H    0     0                    -134480.4010 -169520.30  26.1%     -    0s
H    0     0                    -135299.2878 -169520.30  25.3%     -    0s
     0     0 -152060.29    0   55 -135299.29 -152060.29  12.4%     -    0s
H    0     0                    -138189.5896 -152058.33  10.0%     -    0s
H    0     0                    -140513.1581 -152058.33  8.22%     -    0s
H    0     0                    -143866.1214 -152058.33  5.69%     -    0s
H    0     0                    -147933.4476 -152058.33  2.79%     -    0s
     0     0 -149915.92    0   50 -147933.45 -149915.92  1.34%     -    0s
     0     0 -149566.81    0   47 -147933.45 -149566.81  1.10%     -    0s
H    0     0                    -148035.4583 -149531.00  1.01%     -    0s
H    0     0                    -148266.1527 -149531.00  0.85%     -    0s
H    0     0                    -148567.2956 -149531.00  0.65%     -    0s
     0     0 -149371.25    0   49 -148567.30 -149371.25  0.54%     -    0s
     0     0 -149363.28    0   49 -148567.30 -149363.28  0.54%     -    0s
     0     0 -149329.43    0   51 -148567.30 -149329.43  0.51%     -    0s
H    0     0                    -148578.6001 -149329.43  0.51%     -    0s
     0     0 -149321.81    0   51 -148578.60 -149321.81  0.50%     -    0s
H    0     0                    -148599.2950 -149321.81  0.49%     -    0s
     0     2 -149321.81    0   51 -148599.30 -149321.81  0.49%     -    0s
H   29    38                    -148614.0821 -149052.03  0.29%  10.3    0s
H   35    38                    -148616.2207 -149052.03  0.29%   9.9    0s
H   44    38                    -148633.3191 -148980.43  0.23%   9.4    0s
H  252    24                    -148648.1063 -148797.26  0.10%   9.8    0s

Cutting planes:
  Gomory: 31
  MIR: 133
  Flow cover: 2
  RLT: 29
  BQP: 1

Explored 355 nodes (3760 simplex iterations) in 0.25 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -148648 -148633 -148616 ... -147933

Optimal solution found (tolerance 1.00e-04)
Best objective -1.486481062584e+05, best bound -1.486538618438e+05, gap 0.0039%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 214874.14
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148648.11
  [DEBUG]   S×d_nominal = 363522.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 363522.25 + -148648.11 = 214874.14
  [DEBUG]   Current θ from Master = 225584.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10709.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38539.77
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = -8342.3853, Absolute Gap = 8342.3853, Relative Gap = -0.169389
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 49249.72, LB = 57592.11, Gap = -8342.39
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740599 nonzeros
Model fingerprint: 0x9da2444b
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 115199 rows and 46779 columns
Presolve time: 4.48s
Presolved: 146114 rows, 61561 columns, 900113 nonzeros
Variable types: 59302 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -201494.1305

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.92s

Barrier statistics:
 Dense cols : 629
 AA' NZ     : 7.757e+06
 Factor NZ  : 1.695e+07 (roughly 200 MB of memory)
 Factor Ops : 3.887e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86444037e+07  2.41657015e+08  1.45e+05 1.78e+01  8.75e+04     9s
   1  -1.44154219e+07  2.31639573e+08  1.04e+05 7.56e+01  6.23e+04     9s
   2  -4.99636561e+06  1.80882528e+08  3.63e+04 6.75e-01  2.34e+04     9s
   3  -8.11212636e+05  1.37478892e+08  1.56e+03 1.73e+00  1.48e+03     9s
   4  -5.42355182e+05  5.59525633e+07  4.45e+02 4.88e-01  4.54e+02     9s
   5  -4.09498600e+05  4.58925647e+07  2.16e+02 3.78e-01  2.86e+02     9s
   6  -3.41383894e+05  3.34783441e+07  7.44e+01 2.54e-01  1.62e+02     9s
   7  -3.04023175e+05  2.19283290e+07  4.31e+01 1.57e-01  1.00e+02    10s
   8  -2.28121277e+05  1.37591229e+07  1.13e+01 9.43e-02  5.58e+01    10s
   9  -1.28959359e+05  6.50352460e+06  3.46e+00 4.15e-02  2.54e+01    10s
  10  -9.70474821e+04  3.45558972e+06  2.22e+00 2.12e-02  1.35e+01    10s
  11  -6.15099630e+04  2.14649390e+06  9.99e-01 1.29e-02  8.34e+00    10s
  12  -2.78175801e+04  8.42409119e+05  4.79e-01 4.73e-03  3.28e+00    10s
  13   1.08650028e+04  4.47816604e+05  2.33e-01 2.39e-03  1.64e+00    11s
  14   2.70103297e+04  3.24165090e+05  1.66e-01 1.64e-03  1.12e+00    11s
  15   3.89771536e+04  2.77330137e+05  1.27e-01 1.45e-03  8.96e-01    11s
  16   5.09903815e+04  1.79838886e+05  9.48e-02 1.30e-03  4.84e-01    11s
  17   5.95344354e+04  1.63497046e+05  7.60e-02 2.21e-03  3.91e-01    11s
  18   6.67761970e+04  1.45983886e+05  6.05e-02 2.11e-03  2.98e-01    11s
  19   7.42201576e+04  1.34806804e+05  4.48e-02 1.44e-03  2.28e-01    12s
  20   7.53621192e+04  1.30430018e+05  4.25e-02 1.29e-03  2.07e-01    12s
  21   7.93056362e+04  1.18629208e+05  3.47e-02 1.84e-03  1.48e-01    12s
  22   8.18426068e+04  1.15445609e+05  3.01e-02 1.55e-03  1.26e-01    12s
  23   8.49517642e+04  1.12157473e+05  2.44e-02 1.19e-03  1.02e-01    12s
  24   8.93526374e+04  1.07806859e+05  1.66e-02 8.92e-04  6.94e-02    12s
  25   9.03777861e+04  1.06782526e+05  1.48e-02 7.82e-04  6.17e-02    13s
  26   9.35908419e+04  1.04675400e+05  9.34e-03 5.36e-04  4.17e-02    13s
  27   9.40941441e+04  1.03940542e+05  8.56e-03 4.59e-04  3.70e-02    13s
  28   9.51877229e+04  1.02477610e+05  6.80e-03 3.04e-04  2.74e-02    13s
  29   9.64397004e+04  1.01987877e+05  4.85e-03 2.48e-04  2.09e-02    14s
  30   9.71875232e+04  1.01520378e+05  3.70e-03 1.98e-04  1.63e-02    14s
  31   9.79601750e+04  1.00904917e+05  2.53e-03 1.33e-04  1.11e-02    14s
  32   9.84260213e+04  1.00710975e+05  1.85e-03 1.09e-04  8.59e-03    14s
  33   9.89287037e+04  1.00290106e+05  1.13e-03 8.44e-05  5.12e-03    15s
  34   9.92012126e+04  1.00154613e+05  7.64e-04 6.14e-05  3.58e-03    15s
  35   9.93401466e+04  9.99873730e+04  5.78e-04 3.34e-05  2.43e-03    15s
  36   9.95010818e+04  9.99300839e+04  3.57e-04 2.39e-05  1.61e-03    15s
  37   9.96076912e+04  9.98835707e+04  2.15e-04 1.65e-05  1.04e-03    15s
  38   9.96534591e+04  9.98557341e+04  1.55e-04 1.19e-05  7.60e-04    16s
  39   9.96633300e+04  9.98453066e+04  1.42e-04 1.02e-05  6.84e-04    16s
  40   9.97297860e+04  9.98222912e+04  5.71e-05 6.94e-06  3.48e-04    16s
  41   9.97646038e+04  9.97867206e+04  1.64e-05 1.17e-05  8.31e-05    16s
  42   9.97741078e+04  9.97818468e+04  5.87e-06 2.95e-06  2.91e-05    17s
  43   9.97784696e+04  9.97804146e+04  1.51e-06 5.74e-07  7.31e-06    17s
  44   9.97800032e+04  9.97800488e+04  3.83e-08 2.24e-08  1.71e-07    17s
  45   9.97800424e+04  9.97800425e+04  1.74e-09 5.03e-10  1.95e-10    17s

Barrier solved model in 45 iterations and 17.23 seconds (14.31 work units)
Optimal objective 9.97800424e+04


Root crossover log...

  132348 DPushes remaining with DInf 0.0000000e+00                17s
   25010 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    2697 PPushes remaining with PInf 1.6774817e-05                25s
    1854 PPushes remaining with PInf 3.3995547e-06                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.6274333e+00     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63864    9.9780042e+04   0.000000e+00   5.627433e+00     26s
   63896    9.9780042e+04   0.000000e+00   0.000000e+00     26s
   63896    9.9780042e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 0.10s

Solved with barrier

Root relaxation: objective 9.978004e+04, 63896 iterations, 20.34 seconds (24.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99780.0425    0  123 -201494.13 99780.0425   150%     -   26s
H    0     0                    -197718.8015 99780.0425   150%     -   27s
H    0     0                    -197625.6858 99780.0425   150%     -   27s
H    0     0                    -178695.8902 99780.0425   156%     -   28s
H    0     0                    -151268.7630 99780.0425   166%     -   28s
H    0     0                    -150006.0397 99780.0425   167%     -   28s
H    0     0                    -149988.5424 99780.0425   167%     -   28s
H    0     0                    -149645.2000 99780.0425   167%     -   29s
H    0     0                    -149268.8141 99780.0425   167%     -   29s
H    0     0                    -148358.9314 99780.0425   167%     -   29s
H    0     0                    -148304.8243 99780.0425   167%     -   29s
H    0     0                    -148241.7663 99780.0425   167%     -   29s
H    0     0                    -148106.2752 99780.0425   167%     -   29s
H    0     0                    -147913.2004 99780.0425   167%     -   29s
H    0     0                    -147578.1713 99780.0425   168%     -   29s
H    0     0                    -92196.41760 99780.0425   208%     -   29s
H    0     0                    -90283.31664 99780.0425   211%     -   29s
H    0     0                    -87987.87185 99780.0425   213%     -   29s
H    0     0                    -87959.15668 99780.0425   213%     -   30s
H    0     0                    26365.915341 99780.0425   278%     -   30s
H    0     0                    28999.424210 99780.0425   244%     -   32s
H    0     0                    30727.150880 99780.0425   225%     -   33s
H    0     0                    34726.703688 99780.0425   187%     -   33s
H    0     0                    36839.192288 99780.0425   171%     -   33s
     0     0 94800.6685    0  167 36839.1923 94800.6685   157%     -  214s
     0     0 93873.6963    0  166 36839.1923 93873.6963   155%     -  311s
     0     0 93804.9678    0  173 36839.1923 93804.9678   155%     -  333s
     0     0 93773.9941    0  171 36839.1923 93773.9941   155%     -  352s
     0     0 93696.2901    0  210 36839.1923 93696.2901   154%     -  387s
     0     0 93666.3887    0  218 36839.1923 93666.3887   154%     -  412s
     0     0 93657.8618    0  218 36839.1923 93657.8618   154%     -  421s
     0     0 93657.5914    0  218 36839.1923 93657.5914   154%     -  422s
     0     0 89793.8541    0  292 36839.1923 89793.8541   144%     -  580s
H    0     0                    37201.259748 89793.8447   141%     -  582s
H    0     0                    37211.459096 89793.8447   141%     -  582s
H    0     0                    37220.215502 89793.8447   141%     -  582s
H    0     0                    37220.280111 89793.8447   141%     -  582s
H    0     0                    38005.082809 89793.8447   136%     -  582s
H    0     0                    38217.167387 89793.8447   135%     -  582s
H    0     0                    40372.594028 89793.8447   122%     -  582s
H    0     0                    40848.874881 89793.8447   120%     -  582s
H    0     0                    40935.799232 89793.8447   119%     -  582s
H    0     0                    40975.281821 89793.8447   119%     -  582s
H    0     0                    40983.423214 89793.8447   119%     -  582s
H    0     0                    46786.130642 89793.8447  91.9%     -  582s
     0     0 89237.7885    0  326 46786.1306 89237.7885  90.7%     -  654s
     0     0 89043.9086    0  313 46786.1306 89043.9086  90.3%     -  714s
     0     0 88919.1019    0  340 46786.1306 88919.1019  90.1%     -  759s
     0     0 88886.0167    0  343 46786.1306 88886.0167  90.0%     -  777s
     0     0 88864.4929    0  343 46786.1306 88864.4929  89.9%     -  796s
     0     0 88845.9526    0  347 46786.1306 88845.9526  89.9%     -  812s
     0     0 88739.4882    0  347 46786.1306 88739.4882  89.7%     -  845s
     0     0 88697.0088    0  349 46786.1306 88697.0088  89.6%     -  865s
     0     0 88657.2551    0  364 46786.1306 88657.2551  89.5%     -  884s
     0     0 88609.7369    0  351 46786.1306 88609.7369  89.4%     -  906s
     0     0 88599.6811    0  353 46786.1306 88599.6811  89.4%     -  916s
     0     0 88596.9560    0  349 46786.1306 88596.9560  89.4%     -  921s
     0     0 88582.8368    0  358 46786.1306 88582.8368  89.3%     -  930s
     0     0 88568.6916    0  354 46786.1306 88568.6916  89.3%     -  942s
     0     0 88552.4050    0  352 46786.1306 88552.4050  89.3%     -  956s
     0     0 88548.3298    0  351 46786.1306 88548.3298  89.3%     -  960s
     0     0 88548.0569    0  351 46786.1306 88548.0569  89.3%     -  963s
     0     0 86694.1013    0  358 46786.1306 86694.1013  85.3%     - 1079s
H    0     0                    46829.857688 86693.4614  85.1%     - 1081s
H    0     0                    47051.681385 86693.4614  84.3%     - 1081s
     0     0 86292.3398    0  364 47051.6814 86292.3398  83.4%     - 1140s
     0     0 86091.9933    0  387 47051.6814 86091.9933  83.0%     - 1177s
     0     0 85986.6656    0  389 47051.6814 85986.6656  82.7%     - 1212s
     0     0 85895.7913    0  379 47051.6814 85895.7913  82.6%     - 1238s
     0     0 85868.6330    0  386 47051.6814 85868.6330  82.5%     - 1255s
     0     0 85833.1911    0  387 47051.6814 85833.1911  82.4%     - 1271s
     0     0 85752.5166    0  388 47051.6814 85752.5166  82.3%     - 1301s
     0     0 85735.0947    0  384 47051.6814 85735.0947  82.2%     - 1309s
     0     0 85651.0707    0  395 47051.6814 85651.0707  82.0%     - 1326s
     0     0 85635.2816    0  389 47051.6814 85635.2816  82.0%     - 1336s
     0     0 85621.0492    0  398 47051.6814 85621.0492  82.0%     - 1350s
     0     0 85617.0967    0  401 47051.6814 85617.0967  82.0%     - 1355s
     0     0 85615.1710    0  396 47051.6814 85615.1710  82.0%     - 1357s
     0     0 85613.6843    0  395 47051.6814 85613.6843  82.0%     - 1360s
     0     0 85273.1179    0  381 47051.6814 85273.1179  81.2%     - 1440s
H    0     0                    47876.017244 85272.6089  78.1%     - 1444s
H    0     0                    47949.299257 85272.6089  77.8%     - 1444s
     0     0 85110.8643    0  393 47949.2993 85110.8643  77.5%     - 1487s
     0     0 85049.1218    0  359 47949.2993 85049.1218  77.4%     - 1518s
     0     0 85024.2120    0  399 47949.2993 85024.2120  77.3%     - 1536s
     0     0 84961.8186    0  390 47949.2993 84961.8186  77.2%     - 1556s
     0     0 84893.7673    0  396 47949.2993 84893.7673  77.0%     - 1589s
     0     0 84852.5165    0  395 47949.2993 84852.5165  77.0%     - 1608s
     0     0 84838.5156    0  399 47949.2993 84838.5156  76.9%     - 1618s
     0     0 84831.6322    0  398 47949.2993 84831.6322  76.9%     - 1625s
     0     0 84829.1232    0  396 47949.2993 84829.1232  76.9%     - 1628s
     0     0 84828.4196    0  397 47949.2993 84828.4196  76.9%     - 1629s
     0     0 84688.6560    0  374 47949.2993 84688.6560  76.6%     - 1676s
     0     0 84648.7932    0  362 47949.2993 84648.7932  76.5%     - 1702s
     0     0 84605.4846    0  358 47949.2993 84605.4846  76.4%     - 1723s
     0     0 84590.8682    0  377 47949.2993 84590.8682  76.4%     - 1742s
     0     0 84585.5162    0  373 47949.2993 84585.5162  76.4%     - 1750s
     0     0 84580.4765    0  371 47949.2993 84580.4765  76.4%     - 1758s
     0     0 84577.6533    0  370 47949.2993 84577.6533  76.4%     - 1763s
     0     0 84576.2287    0  371 47949.2993 84576.2287  76.4%     - 1769s
     0     0 84549.0179    0  379 47949.2993 84549.0179  76.3%     - 1788s
H    0     0                    49473.804283 84548.6069  70.9%     - 1800s
     0     0 84537.7510    0  374 49473.8043 84537.7510  70.9%     - 1810s
     0     0 84533.2531    0  388 49473.8043 84533.2531  70.9%     - 1818s
     0     0 84528.3459    0  392 49473.8043 84528.3459  70.9%     - 1824s
     0     0 84526.7058    0  390 49473.8043 84526.7058  70.9%     - 1832s
     0     0 84484.2139    0  373 49473.8043 84484.2139  70.8%     - 1859s
H    0     0                    50321.475671 84484.0082  67.9%     - 1860s
H    0     0                    50754.843992 84484.0082  66.5%     - 1860s
H    0     0                    50799.442182 84484.0082  66.3%     - 1860s
     0     0 84477.9878    0  379 50799.4422 84477.9878  66.3%     - 1869s
     0     0 84475.7218    0  431 50799.4422 84475.7218  66.3%     - 1872s
     0     0 84471.2625    0  377 50799.4422 84471.2625  66.3%     - 1876s
     0     0 84467.2299    0  379 50799.4422 84467.2299  66.3%     - 1882s
     0     0 84465.4649    0  382 50799.4422 84465.4649  66.3%     - 1885s
     0     0 84442.7276    0  375 50799.4422 84442.7276  66.2%     - 1897s
H    0     0                    51476.851682 84442.5998  64.0%     - 1899s
H    0     0                    51708.765236 84442.5998  63.3%     - 1900s
H    0     0                    51752.978220 84442.5998  63.2%     - 1901s
H    0     0                    51908.887590 84442.5998  62.7%     - 1902s
H    0     0                    52089.338869 84442.5998  62.1%     - 1903s
     0     0 84431.9248    0  433 52089.3389 84431.9248  62.1%     - 1911s
     0     0 84428.4815    0  369 52089.3389 84428.4815  62.1%     - 1915s
     0     0 84423.4202    0  376 52089.3389 84423.4202  62.1%     - 1919s
     0     0 84419.3209    0  386 52089.3389 84419.3209  62.1%     - 1922s
     0     0 84418.3186    0  386 52089.3389 84418.3186  62.1%     - 1923s
     0     0 84405.0215    0  384 52089.3389 84405.0215  62.0%     - 1931s
H    0     0                    52291.913528 84404.7043  61.4%     - 1933s
     0     0 84400.9604    0  380 52291.9135 84400.9604  61.4%     - 1937s
     0     0 84399.9507    0  413 52291.9135 84399.9507  61.4%     - 1940s
     0     0 84394.8706    0  390 52291.9135 84394.8706  61.4%     - 1948s
H    0     0                    52404.254733 84392.8667  61.0%     - 1957s
H    0     0                    52519.175366 84392.8667  60.7%     - 1957s
     0     0 84392.2209    0  394 52519.1754 84392.2209  60.7%     - 1961s
     0     0 84390.0570    0  392 52519.1754 84390.0570  60.7%     - 1964s
     0     0 84388.8012    0  392 52519.1754 84388.8012  60.7%     - 1967s
     0     0 84376.2243    0  387 52519.1754 84376.2243  60.7%     - 1985s
     0     0 84374.1045    0  385 52519.1754 84374.1045  60.7%     - 1991s
     0     0 84371.2376    0  388 52519.1754 84371.2376  60.6%     - 1997s
     0     0 84370.8762    0  383 52519.1754 84370.8762  60.6%     - 1999s
     0     0 84367.6352    0  378 52519.1754 84367.6352  60.6%     - 2005s
     0     0 84367.0634    0  378 52519.1754 84367.0634  60.6%     - 2009s
H    0     0                    52833.170731 84367.0634  59.7%     - 2388s
H    0     0                    53022.313866 84367.0634  59.1%     - 2445s
     0     2 84367.0634    0  378 53022.3139 84367.0634  59.1%     - 2448s
     1     3 83832.6410    1  341 53022.3139 84366.5927  59.1% 17446 2490s
     2     4 84346.0932    1  363 53022.3139 84346.0932  59.1% 12104 2506s
     3     5 83245.8990    2  326 53022.3139 84346.0573  59.1% 13733 2549s
     4     8 84218.5505    2  417 53022.3139 84346.0396  59.1% 12007 2588s
     7    12 84152.8934    3  417 53022.3139 84218.3715  58.8% 10655 2713s
    11    23 83910.2316    4  399 53022.3139 84218.3715  58.8% 20085 2780s
    22    33 79969.6390    4  340 53022.3139 84152.6755  58.7% 27196 3600s

Cutting planes:
  Learned: 1
  Gomory: 5
  Implied bound: 100
  MIR: 2571
  Flow cover: 2465
  RLT: 68
  Relax-and-lift: 282

Explored 32 nodes (1715655 simplex iterations) in 3600.17 seconds (4168.48 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53022.3 52833.2 52519.2 ... 51476.9

Time limit reached
Best objective 5.302231386605e+04, best bound 8.391006199590e+04, gap 58.2542%
  WARNING: Time limit reached. Using best solution found (gap: 58.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = 53022.31, θ = 215584.37
  Upper Bound (UB) = 53022.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215584.37
  [DEBUG]   ✓ Scenario 0: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 215584.37 ≤ Q = 215584.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 215584.37 ≤ Q = 215584.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 215584.37 ≤ Q = 215584.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 215584.37 ≤ Q = 215584.37 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4acd3020
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb532cfe0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.255664e+13
Presolve removed 2578 rows and 1869 columns
Presolve time: 0.01s
Presolved: 515 rows, 520 columns, 1456 nonzeros
Found heuristic solution: objective 6136114.3177
Variable types: 354 continuous, 166 integer (166 binary)

Root relaxation: objective -1.575361e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157536.13    0  127 6136114.32 -157536.13   103%     -    0s
H    0     0                    -125941.0256 -157536.13  25.1%     -    0s
H    0     0                    -126582.9366 -157536.13  24.5%     -    0s
H    0     0                    -128214.4403 -157536.13  22.9%     -    0s
H    0     0                    -133189.7603 -157536.13  18.3%     -    0s
H    0     0                    -135756.0647 -139712.89  2.91%     -    0s
     0     0 -139712.89    0  112 -135756.06 -139712.89  2.91%     -    0s
     0     0 -139507.64    0  107 -135756.06 -139507.64  2.76%     -    0s
H    0     0                    -137576.6467 -139507.64  1.40%     -    0s
     0     0 -138567.74    0   77 -137576.65 -138567.74  0.72%     -    0s
H    0     0                    -138008.2253 -138555.68  0.40%     -    0s
     0     0 -138554.09    0   77 -138008.23 -138554.09  0.40%     -    0s
     0     0 -138444.87    0   56 -138008.23 -138444.87  0.32%     -    0s
H    0     0                    -138012.7673 -138430.36  0.30%     -    0s
     0     0 -138384.87    0   69 -138012.77 -138384.87  0.27%     -    0s
     0     0 -138377.89    0   69 -138012.77 -138377.89  0.26%     -    0s
     0     0 -138300.63    0   42 -138012.77 -138300.63  0.21%     -    0s
     0     0 -138280.33    0   38 -138012.77 -138280.33  0.19%     -    0s
     0     0 -138274.07    0   38 -138012.77 -138274.07  0.19%     -    0s
     0     0 -138253.85    0   37 -138012.77 -138253.85  0.17%     -    0s
     0     0 -138248.07    0   35 -138012.77 -138248.07  0.17%     -    0s
     0     0 -138230.29    0   35 -138012.77 -138230.29  0.16%     -    0s
     0     0 -138224.16    0   35 -138012.77 -138224.16  0.15%     -    0s
     0     0 -138224.16    0   69 -138012.77 -138224.16  0.15%     -    0s
H    0     0                    -138017.7998 -138224.16  0.15%     -    0s
     0     0 -138224.16    0   54 -138017.80 -138224.16  0.15%     -    0s
     0     0 -138173.13    0   32 -138017.80 -138173.13  0.11%     -    0s
     0     0 -138135.84    0   32 -138017.80 -138135.84  0.09%     -    0s
     0     0 -138135.25    0   45 -138017.80 -138135.25  0.09%     -    0s
     0     0 -138135.18    0   45 -138017.80 -138135.18  0.09%     -    0s
     0     0 -138126.47    0   45 -138017.80 -138126.47  0.08%     -    0s
H    0     0                    -138019.9193 -138096.73  0.06%     -    0s
     0     0 -138096.73    0   40 -138019.92 -138096.73  0.06%     -    0s
     0     0 -138080.37    0   40 -138019.92 -138080.37  0.04%     -    0s
     0     0 -138080.12    0   36 -138019.92 -138080.12  0.04%     -    0s
     0     0 -138069.94    0   37 -138019.92 -138069.94  0.04%     -    0s
     0     0 -138069.89    0   37 -138019.92 -138069.89  0.04%     -    0s
     0     0 -138069.89    0   37 -138019.92 -138069.89  0.04%     -    0s
     0     0 -138069.23    0   37 -138019.92 -138069.23  0.04%     -    0s
     0     0 -138058.74    0   29 -138019.92 -138058.74  0.03%     -    0s
     0     0 -138058.74    0   36 -138019.92 -138058.74  0.03%     -    0s
     0     0 -138046.64    0   11 -138019.92 -138046.64  0.02%     -    0s
     0     0 -138037.71    0   10 -138019.92 -138037.71  0.01%     -    0s
     0     0 -138035.81    0    9 -138019.92 -138035.81  0.01%     -    0s
     0     0          -    0      -138019.92 -138032.65  0.01%     -    0s

Cutting planes:
  Gomory: 15
  Implied bound: 8
  MIR: 16
  Flow cover: 10
  RLT: 8
  Relax-and-lift: 2

Explored 1 nodes (1383 simplex iterations) in 0.27 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -138020 -138018 -138013 ... -125941

Optimal solution found (tolerance 1.00e-04)
Best objective -1.380199192673e+05, best bound -1.380326452822e+05, gap 0.0092%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 202728.89
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138019.92
  [DEBUG]   S×d_nominal = 340748.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340748.81 + -138019.92 = 202728.89
  [DEBUG]   Current θ from Master = 215584.37
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12855.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 40166.83
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = -4569.7934, Absolute Gap = 4569.7934, Relative Gap = -0.086186
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 53022.31, LB = 57592.11, Gap = -4569.79
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783839 nonzeros
Model fingerprint: 0x17d31a9c
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 121986 rows and 49536 columns (presolve time = 5s)...
Presolve removed 121986 rows and 49536 columns
Presolve time: 6.46s
Presolved: 154617 rows, 65044 columns, 952719 nonzeros
Variable types: 62785 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268469.0586
Found heuristic solution: objective -201494.1305

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.44s

Barrier statistics:
 Dense cols : 629
 AA' NZ     : 8.602e+06
 Factor NZ  : 1.893e+07 (roughly 240 MB of memory)
 Factor Ops : 4.662e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89160911e+07  2.54082381e+08  1.47e+05 1.77e+01  8.84e+04    11s
   1  -1.46734982e+07  2.43953978e+08  1.06e+05 7.47e+01  6.30e+04    11s
   2  -5.23017498e+06  1.89963344e+08  3.78e+04 1.10e+00  2.42e+04    11s
   3  -8.63888650e+05  1.49367885e+08  1.93e+03 2.10e+00  1.72e+03    12s
   4  -5.60527440e+05  8.24907832e+07  4.96e+02 8.50e-01  5.70e+02    12s
   5  -4.34051000e+05  5.13418307e+07  2.40e+02 4.61e-01  3.04e+02    12s
   6  -3.61865296e+05  3.94682226e+07  8.79e+01 3.38e-01  1.82e+02    12s
   7  -3.30787582e+05  2.79591703e+07  5.15e+01 2.28e-01  1.21e+02    12s
   8  -2.52780812e+05  2.09334473e+07  1.16e+01 1.64e-01  7.91e+01    12s
   9  -1.79981084e+05  1.25720598e+07  2.04e+00 9.60e-02  4.57e+01    13s
  10  -1.07040421e+05  6.30399193e+06  8.31e-01 4.79e-02  2.28e+01    13s
  11  -8.35889392e+04  3.79941723e+06  5.38e-01 2.83e-02  1.38e+01    13s
  12  -4.90910782e+04  2.84108937e+06  2.26e-01 2.06e-02  1.03e+01    13s
  13  -2.16229177e+04  1.01935897e+06  8.14e-02 7.14e-03  3.69e+00    13s
  14   1.03416287e+04  4.44034949e+05  4.33e-02 2.68e-03  1.54e+00    14s
  15   2.61557869e+04  3.71264553e+05  3.02e-02 2.11e-03  1.22e+00    14s
  16   3.41893688e+04  2.87062599e+05  2.56e-02 1.74e-03  8.97e-01    14s
  17   4.91957853e+04  2.54072256e+05  1.84e-02 1.44e-03  7.27e-01    14s
  18   6.20855896e+04  1.95819626e+05  1.23e-02 9.26e-04  4.74e-01    14s
  19   7.08964495e+04  1.65312768e+05  8.52e-03 6.41e-04  3.35e-01    15s
  20   7.55512920e+04  1.49785650e+05  6.76e-03 4.92e-04  2.63e-01    15s
  21   7.69219423e+04  1.46382463e+05  6.27e-03 4.64e-04  2.46e-01    15s
  22   7.90440884e+04  1.31854330e+05  5.57e-03 3.42e-04  1.87e-01    15s
  23   8.14130852e+04  1.24876246e+05  4.87e-03 2.69e-04  1.54e-01    16s
  24   8.57747220e+04  1.20014518e+05  3.56e-03 2.19e-04  1.21e-01    16s
  25   8.93217449e+04  1.12932255e+05  2.54e-03 1.78e-04  8.38e-02    16s
  26   9.17446754e+04  1.10783679e+05  1.90e-03 1.57e-04  6.75e-02    16s
  27   9.27022900e+04  1.09708081e+05  1.64e-03 1.42e-04  6.03e-02    17s
  28   9.45033485e+04  1.06532970e+05  1.19e-03 1.12e-04  4.27e-02    17s
  29   9.52987645e+04  1.04816427e+05  9.93e-04 8.79e-05  3.38e-02    17s
  30   9.67208192e+04  1.02916673e+05  6.49e-04 5.44e-05  2.20e-02    17s
  31   9.70456915e+04  1.02514231e+05  5.75e-04 4.77e-05  1.94e-02    18s
  32   9.82918668e+04  1.01761986e+05  2.95e-04 3.47e-05  1.23e-02    18s
  33   9.85357245e+04  1.01712710e+05  2.45e-04 3.40e-05  1.13e-02    18s
  34   9.87695032e+04  1.01222775e+05  1.97e-04 2.55e-05  8.70e-03    19s
  35   9.90855631e+04  1.00670645e+05  1.30e-04 1.56e-05  5.62e-03    19s
  36   9.92736469e+04  1.00497344e+05  9.15e-05 1.27e-05  4.34e-03    19s
  37   9.93374089e+04  1.00175161e+05  7.91e-05 7.07e-06  2.97e-03    19s
  38   9.94772032e+04  1.00004723e+05  5.22e-05 4.25e-06  1.87e-03    20s
  39   9.96415254e+04  9.99150149e+04  2.32e-05 3.56e-06  9.70e-04    20s
  40   9.96682828e+04  9.98903585e+04  1.85e-05 2.94e-06  7.88e-04    20s
  41   9.96718571e+04  9.98865234e+04  1.79e-05 2.87e-06  7.61e-04    21s
  42   9.96801114e+04  9.98666888e+04  1.63e-05 2.77e-06  6.62e-04    21s
  43   9.97019984e+04  9.98227572e+04  1.23e-05 1.77e-06  4.28e-04    21s
  44   9.97086420e+04  9.98186453e+04  1.11e-05 1.62e-06  3.90e-04    21s
  45   9.97373429e+04  9.98056984e+04  6.18e-06 1.16e-06  2.42e-04    22s
  46   9.97559146e+04  9.97934439e+04  2.83e-06 7.14e-07  1.33e-04    22s
  47   9.97668005e+04  9.97863945e+04  1.02e-06 4.43e-07  6.95e-05    22s
  48   9.97689531e+04  9.97813174e+04  7.15e-07 2.58e-07  4.39e-05    22s
  49   9.97699588e+04  9.97766394e+04  5.52e-07 9.04e-08  2.37e-05    23s
  50   9.97722544e+04  9.97749043e+04  2.12e-07 2.83e-08  9.40e-06    23s
  51   9.97735519e+04  9.97743575e+04  4.72e-08 1.15e-08  2.86e-06    23s
  52   9.97738511e+04  9.97739990e+04  1.61e-08 4.95e-10  5.25e-07    24s
  53   9.97739570e+04  9.97739826e+04  3.64e-09 7.17e-11  9.09e-08    24s
  54   9.97739574e+04  9.97739823e+04  7.22e-07 1.26e-07  8.83e-08    24s
  55   9.97739589e+04  9.97739817e+04  8.51e-07 1.02e-07  8.06e-08    25s
  56   9.97739599e+04  9.97739815e+04  7.89e-07 8.55e-08  7.65e-08    25s
  57   9.97739620e+04  9.97739813e+04  1.49e-06 8.00e-08  6.87e-08    25s
  58   9.97739634e+04  9.97739812e+04  1.95e-06 1.36e-07  6.35e-08    26s
  59   9.97739677e+04  9.97739809e+04  1.49e-06 1.04e-07  4.73e-08    26s
  60   9.97739790e+04  9.97739795e+04  8.66e-08 1.73e-09  1.60e-09    26s

Barrier solved model in 60 iterations and 26.16 seconds (21.05 work units)
Optimal objective 9.97739790e+04


Root crossover log...

  139440 DPushes remaining with DInf 0.0000000e+00                26s
   33605 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                35s

   17317 PPushes remaining with PInf 1.2370235e-04                35s
   13454 PPushes remaining with PInf 1.0449488e-04                35s
       0 PPushes remaining with PInf 0.0000000e+00                37s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.0723578e+04     37s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   89801    9.9773979e+04   0.000000e+00   3.072358e+04     37s
   90331    9.9773979e+04   0.000000e+00   0.000000e+00     38s
   90331    9.9773979e+04   0.000000e+00   0.000000e+00     38s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.977398e+04, 90331 iterations, 30.63 seconds (33.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99773.9795    0  131 -201494.13 99773.9795   150%     -   39s
H    0     0                    -181959.5052 99773.9795   155%     -   40s
H    0     0                    -181216.8941 99773.9795   155%     -   40s
H    0     0                    -162664.3197 99773.9795   161%     -   41s
H    0     0                    -161231.7747 99773.9795   162%     -   41s
H    0     0                    -158133.2150 99773.9795   163%     -   41s
H    0     0                    -156485.2434 99773.9795   164%     -   42s
H    0     0                    -156279.8633 99773.9795   164%     -   42s
H    0     0                    -155466.1569 99773.9795   164%     -   42s
H    0     0                    -92361.82793 99773.9795   208%     -   42s
H    0     0                    -92333.11277 99773.9795   208%     -   43s
H    0     0                    19971.533215 99773.9795   400%     -   43s
H    0     0                    25200.877220 99773.9795   296%     -   43s
H    0     0                    32589.478928 99773.9795   206%     -   45s
H    0     0                    34585.806749 99773.9795   188%     -   45s
H    0     0                    34765.284442 99773.9795   187%     -   45s
H    0     0                    34819.470245 99773.9795   187%     -   45s
H    0     0                    34997.420093 99773.9795   185%     -   46s
     0     0 95046.1602    0  178 34997.4201 95046.1602   172%     -  224s
H    0     0                    35689.106383 95046.1231   166%     -  227s
     0     0 94090.6625    0  203 35689.1064 94090.6625   164%     -  325s
     0     0 94001.4494    0  178 35689.1064 94001.4494   163%     -  369s
     0     0 93954.5624    0  168 35689.1064 93954.5624   163%     -  403s
     0     0 93935.8292    0  171 35689.1064 93935.8292   163%     -  431s
     0     0 93925.9949    0  178 35689.1064 93925.9949   163%     -  445s
     0     0 93829.0001    0  171 35689.1064 93829.0001   163%     -  477s
     0     0 93818.8955    0  206 35689.1064 93818.8955   163%     -  484s
     0     0 93814.6042    0  206 35689.1064 93814.6042   163%     -  489s
     0     0 93764.5460    0  199 35689.1064 93764.5460   163%     -  513s
     0     0 93760.0539    0  199 35689.1064 93760.0539   163%     -  516s
     0     0 93758.2594    0  200 35689.1064 93758.2594   163%     -  518s
     0     0 93747.4255    0  204 35689.1064 93747.4255   163%     -  520s
     0     0 93725.6997    0  202 35689.1064 93725.6997   163%     -  527s
     0     0 93725.1431    0  204 35689.1064 93725.1431   163%     -  532s
     0     0 93725.0319    0  204 35689.1064 93725.0319   163%     -  534s
     0     0 90178.3956    0  276 35689.1064 90178.3956   153%     -  703s
H    0     0                    38706.345606 90178.1332   133%     -  705s
H    0     0                    39582.327786 90178.1332   128%     -  705s
H    0     0                    40024.978927 90178.1332   125%     -  705s
H    0     0                    40979.042427 90178.1332   120%     -  705s
H    0     0                    41570.886329 90178.1332   117%     -  705s
     0     0 89475.5449    0  300 41570.8863 89475.5449   115%     -  790s
     0     0 89311.0406    0  313 41570.8863 89311.0406   115%     -  837s
     0     0 89197.3453    0  344 41570.8863 89197.3453   115%     -  890s
     0     0 89129.1622    0  321 41570.8863 89129.1622   114%     -  917s
     0     0 89043.8502    0  320 41570.8863 89043.8502   114%     -  954s
     0     0 88998.6808    0  312 41570.8863 88998.6808   114%     -  976s
     0     0 88989.4595    0  305 41570.8863 88989.4595   114%     -  990s
     0     0 88961.7857    0  313 41570.8863 88961.7857   114%     - 1008s
     0     0 88936.1869    0  305 41570.8863 88936.1869   114%     - 1021s
     0     0 88893.8136    0  324 41570.8863 88893.8136   114%     - 1052s
     0     0 88888.5469    0  323 41570.8863 88888.5469   114%     - 1058s
     0     0 88886.0831    0  323 41570.8863 88886.0831   114%     - 1062s
     0     0 88847.6394    0  314 41570.8863 88847.6394   114%     - 1080s
     0     0 88825.6852    0  325 41570.8863 88825.6852   114%     - 1098s
     0     0 88824.2277    0  317 41570.8863 88824.2277   114%     - 1101s
     0     0 88820.5729    0  312 41570.8863 88820.5729   114%     - 1106s
     0     0 88804.9992    0  319 41570.8863 88804.9992   114%     - 1118s
     0     0 88797.0687    0  309 41570.8863 88797.0687   114%     - 1125s
     0     0 88791.8066    0  321 41570.8863 88791.8066   114%     - 1131s
     0     0 88790.9848    0  323 41570.8863 88790.9848   114%     - 1133s
     0     0 87251.2192    0  345 41570.8863 87251.2192   110%     - 1328s
H    0     0                    43191.147969 87251.1513   102%     - 1330s
H    0     0                    43224.409968 87251.1513   102%     - 1330s
H    0     0                    43245.914727 87251.1513   102%     - 1330s
     0     0 86797.6316    0  353 43245.9147 86797.6316   101%     - 1411s
     0     0 86658.0337    0  363 43245.9147 86658.0337   100%     - 1460s
     0     0 86497.8613    0  369 43245.9147 86497.8613   100%     - 1510s
     0     0 86411.6612    0  364 43245.9147 86411.6612   100%     - 1544s
     0     0 86375.3420    0  372 43245.9147 86375.3420   100%     - 1566s
     0     0 86360.3537    0  371 43245.9147 86360.3537   100%     - 1582s
     0     0 86327.0752    0  371 43245.9147 86327.0752   100%     - 1606s
     0     0 86279.3006    0  370 43245.9147 86279.3006   100%     - 1629s
     0     0 86247.2874    0  375 43245.9147 86247.2874  99.4%     - 1656s
     0     0 86224.6335    0  378 43245.9147 86224.6335  99.4%     - 1679s
     0     0 86212.8296    0  378 43245.9147 86212.8296  99.4%     - 1697s
     0     0 86198.6665    0  375 43245.9147 86198.6665  99.3%     - 1704s
     0     0 86137.8616    0  372 43245.9147 86137.8616  99.2%     - 1726s
     0     0 86115.1262    0  370 43245.9147 86115.1262  99.1%     - 1746s
     0     0 86105.5489    0  368 43245.9147 86105.5489  99.1%     - 1752s
     0     0 86097.8236    0  375 43245.9147 86097.8236  99.1%     - 1760s
     0     0 86075.5687    0  370 43245.9147 86075.5687  99.0%     - 1775s
     0     0 85991.5886    0  372 43245.9147 85991.5886  98.8%     - 1810s
     0     0 85968.6734    0  366 43245.9147 85968.6734  98.8%     - 1821s
     0     0 85960.7366    0  367 43245.9147 85960.7366  98.8%     - 1831s
     0     0 85953.4869    0  373 43245.9147 85953.4869  98.8%     - 1842s
     0     0 85950.7933    0  376 43245.9147 85950.7933  98.7%     - 1849s
     0     0 85949.5724    0  376 43245.9147 85949.5724  98.7%     - 1854s
     0     0 85274.2034    0  343 43245.9147 85274.2034  97.2%     - 1941s
H    0     0                    44774.140697 85273.8638  90.5%     - 1946s
H    0     0                    45391.562857 85273.8638  87.9%     - 1947s
     0     0 85112.3569    0  378 45391.5629 85112.3569  87.5%     - 1977s
     0     0 85036.1383    0  384 45391.5629 85036.1383  87.3%     - 2009s
     0     0 84998.1311    0  393 45391.5629 84998.1311  87.3%     - 2029s
     0     0 84979.5355    0  397 45391.5629 84979.5355  87.2%     - 2046s
     0     0 84971.8091    0  395 45391.5629 84971.8091  87.2%     - 2052s
     0     0 84969.7239    0  404 45391.5629 84969.7239  87.2%     - 2056s
     0     0 84957.8760    0  399 45391.5629 84957.8760  87.2%     - 2061s
     0     0 84955.7156    0  405 45391.5629 84955.7156  87.2%     - 2065s
     0     0 84934.5305    0  400 45391.5629 84934.5305  87.1%     - 2076s
     0     0 84863.2512    0  396 45391.5629 84863.2512  87.0%     - 2098s
     0     0 84796.6445    0  399 45391.5629 84796.6445  86.8%     - 2124s
     0     0 84789.7989    0  401 45391.5629 84789.7989  86.8%     - 2129s
     0     0 84788.5750    0  401 45391.5629 84788.5750  86.8%     - 2132s
     0     0 84698.0576    0  360 45391.5629 84698.0576  86.6%     - 2162s
H    0     0                    45728.715957 84697.6115  85.2%     - 2163s
H    0     0                    46116.140558 84697.6115  83.7%     - 2164s
H    0     0                    47203.665357 84697.6115  79.4%     - 2164s
H    0     0                    47341.419416 84697.6115  78.9%     - 2164s
H    0     0                    47521.836111 84697.6115  78.2%     - 2164s
H    0     0                    47579.666271 84697.6115  78.0%     - 2164s
H    0     0                    48080.018938 84697.6115  76.2%     - 2164s
     0     0 84673.5140    0  390 48080.0189 84673.5140  76.1%     - 2178s
     0     0 84634.5137    0  402 48080.0189 84634.5137  76.0%     - 2196s
     0     0 84613.5762    0  395 48080.0189 84613.5762  76.0%     - 2207s
     0     0 84603.0093    0  412 48080.0189 84603.0093  76.0%     - 2220s
     0     0 84601.4336    0  409 48080.0189 84601.4336  76.0%     - 2222s
     0     0 84549.2985    0  361 48080.0189 84549.2985  75.9%     - 2247s
H    0     0                    48676.757789 84549.1154  73.7%     - 2271s
H    0     0                    51589.685349 84549.1154  63.9%     - 2273s
     0     0 84529.3028    0  402 51589.6853 84529.3028  63.8%     - 2287s
     0     0 84501.8783    0  410 51589.6853 84501.8783  63.8%     - 2304s
     0     0 84485.8553    0  408 51589.6853 84485.8553  63.8%     - 2316s
     0     0 84481.8967    0  404 51589.6853 84481.8967  63.8%     - 2322s
     0     0 84480.6918    0  367 51589.6853 84480.6918  63.8%     - 2325s
     0     0 84427.8016    0  368 51589.6853 84427.8016  63.7%     - 2350s
H    0     0                    53378.474870 84427.7450  58.2%     - 2351s
H    0     0                    55816.151925 84427.7450  51.3%     - 2352s
     0     0 84415.1294    0  376 55816.1519 84415.1294  51.2%     - 2362s
     0     0 84412.7327    0  376 55816.1519 84412.7327  51.2%     - 2365s
     0     0 84408.8768    0  374 55816.1519 84408.8768  51.2%     - 2370s
     0     0 84405.0439    0  420 55816.1519 84405.0439  51.2%     - 2378s
     0     0 84401.5090    0  417 55816.1519 84401.5090  51.2%     - 2383s
     0     0 84401.1720    0  421 55816.1519 84401.1720  51.2%     - 2386s
     0     0 84365.6612    0  373 55816.1519 84365.6612  51.1%     - 2405s
H    0     0                    57004.257430 84364.3678  48.0%     - 2409s
H    0     0                    57210.937356 84364.3678  47.5%     - 2409s
H    0     0                    57404.651253 84364.3678  47.0%     - 2409s
H    0     0                    57677.639712 84364.3678  46.3%     - 2409s
     0     0 84339.2954    0  377 57677.6397 84339.2954  46.2%     - 2421s
     0     0 84332.5018    0  381 57677.6397 84332.5018  46.2%     - 2429s
     0     0 84331.2547    0  384 57677.6397 84331.2547  46.2%     - 2433s
     0     0 84326.1077    0  376 57677.6397 84326.1077  46.2%     - 2442s
     0     0 84324.7715    0  372 57677.6397 84324.7715  46.2%     - 2445s
     0     0 84319.3340    0  373 57677.6397 84319.3340  46.2%     - 2455s
H    0     0                    57788.346599 84319.2955  45.9%     - 2463s
     0     0 84317.6388    0  381 57788.3466 84317.6388  45.9%     - 2466s
     0     0 84316.0950    0  374 57788.3466 84316.0950  45.9%     - 2472s
     0     0 84315.8315    0  377 57788.3466 84315.8315  45.9%     - 2475s
     0     0 84315.0589    0  376 57788.3466 84315.0589  45.9%     - 2479s
     0     0 84314.7038    0  376 57788.3466 84314.7038  45.9%     - 2484s
     0     2 84314.7038    0  376 57788.3466 84314.7038  45.9%     - 3069s
     1     3 84137.9248    1  407 57788.3466 84314.7038  45.9% 21886 3124s
     2     4 84275.0172    1  366 57788.3466 84275.0172  45.8% 16198 3152s
     3     6 83905.4189    2  401 57788.3466 84274.4385  45.8% 14181 3187s
     5     9 83731.2633    3  385 57788.3466 84274.4385  45.8% 12984 3246s
     8    15 83590.1383    4  391 57788.3466 84207.6307  45.7% 13440 3306s
    14    28 83211.1388    4  351 57788.3466 84207.6307  45.7% 14098 3374s
    27    40 82407.7231    6  358 57788.3466 84104.9727  45.5% 23694 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 129
  MIR: 2670
  Flow cover: 2586
  RLT: 53
  Relax-and-lift: 342

Explored 39 nodes (1801418 simplex iterations) in 3600.12 seconds (4480.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 57788.3 57677.6 57404.7 ... 48080

Time limit reached
Best objective 5.778834659902e+04, best bound 8.410497272497e+04, gap 45.5397%
  WARNING: Time limit reached. Using best solution found (gap: 45.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 57788.35, θ = 225088.30
  Upper Bound (UB) = 57788.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 225088.30
  [DEBUG]   ✓ Scenario 0: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 225088.30 ≤ Q = 225088.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 225088.30 ≤ Q = 225088.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x8fd1bc5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf702e43b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.230088e+13
Presolve removed 2585 rows and 1873 columns
Presolve time: 0.01s
Presolved: 508 rows, 516 columns, 1440 nonzeros
Found heuristic solution: objective 5662789.8808
Variable types: 351 continuous, 165 integer (165 binary)
Found heuristic solution: objective 5662300.8054

Root relaxation: objective -1.795015e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -179501.49    0  127 5662300.81 -179501.49   103%     -    0s
H    0     0                    -132373.2578 -179501.49  35.6%     -    0s
H    0     0                    -140255.8172 -179501.49  28.0%     -    0s
H    0     0                    -140428.0498 -179501.49  27.8%     -    0s
H    0     0                    -140678.0065 -179261.21  27.4%     -    0s
H    0     0                    -148366.6841 -160139.85  7.94%     -    0s
H    0     0                    -155390.2054 -160139.85  3.06%     -    0s
     0     0 -160139.85    0   60 -155390.21 -160139.85  3.06%     -    0s
H    0     0                    -155944.4373 -160086.30  2.66%     -    0s
H    0     0                    -158320.5620 -160086.30  1.12%     -    0s
H    0     0                    -158594.5422 -160086.30  0.94%     -    0s
H    0     0                    -159077.7645 -160086.30  0.63%     -    0s
     0     0 -159715.14    0   56 -159077.76 -159715.14  0.40%     -    0s
     0     0 -159701.57    0   56 -159077.76 -159701.57  0.39%     -    0s
     0     0 -159431.39    0   24 -159077.76 -159431.39  0.22%     -    0s
     0     0 -159429.19    0   22 -159077.76 -159429.19  0.22%     -    0s
H    0     0                    -159096.3642 -159424.81  0.21%     -    0s
     0     0 -159415.09    0   24 -159096.36 -159415.09  0.20%     -    0s
     0     0 -159401.92    0   16 -159096.36 -159401.92  0.19%     -    0s
     0     0 -159401.92    0   44 -159096.36 -159401.92  0.19%     -    0s
H    0     0                    -159100.6806 -159401.92  0.19%     -    0s
H    0     0                    -159285.0421 -159401.92  0.07%     -    0s
     0     0 -159401.92    0   23 -159285.04 -159401.92  0.07%     -    0s
     0     0 -159378.84    0    6 -159285.04 -159378.84  0.06%     -    0s
     0     0 -159364.01    0    2 -159285.04 -159364.01  0.05%     -    0s
*    0     0               0    -159363.0963 -159363.10  0.00%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 12
  MIR: 24
  Flow cover: 5
  RLT: 5
  BQP: 1

Explored 1 nodes (793 simplex iterations) in 0.16 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -159363 -159285 -159101 ... -140678
No other solutions better than -159363

Optimal solution found (tolerance 1.00e-04)
Best objective -1.593630962953e+05, best bound -1.593630962953e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 211622.74
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -159363.10
  [DEBUG]   S×d_nominal = 370985.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 370985.84 + -159363.10 = 211622.74
  [DEBUG]   Current θ from Master = 225088.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13465.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44322.79
  Lower Bound (LB) = 57592.11
  Gap (UB-LB) = 196.2393, Absolute Gap = 196.2393, Relative Gap = 0.003396
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 18
Total Time: 56089.64s
Converged: True
Final Lower Bound: 57592.1073
Final Upper Bound: 57788.3466
Final Gap: 196.239334
Number of Critical Scenarios: 18
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1, 2] (2/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 4
DCs Opened: [0, 3, 4, 6, 7, 9] (6/10)
Active Routes (Plant→DC): 15
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 3 customers  Mode 2: 47 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 18
Start Time: 2026-01-05 14:42:14
End Time: 2026-01-06 06:17:04
Total Time: 56089.64s
Optimal Value: 57592.11
Lower Bound: 57592.11
Upper Bound: 57788.35
Gap: 196.239334
Plants Opened: {0: [2], 1: [1, 2], 2: [2]} (4 plants)
DCs Opened: [0, 3, 4, 6, 7, 9] (6 DCs)
================================================================================

Results saved to: result/DH_single_full_seed39_HD_gamma20_20260106_061704.csv

Total Execution Time: 56089.87 seconds
End Time: 2026-01-06 06:17:04

All tasks completed successfully!

