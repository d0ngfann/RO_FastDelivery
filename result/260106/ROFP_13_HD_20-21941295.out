
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 13
DI Scenario: HD
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed13.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
  Product 1: ['1.000', '1.320', '1.743'] (k=0.685)
  Product 2: ['1.000', '1.358', '1.844'] (k=0.755)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=916, max=1753
  DC capacity (MC): min=475, max=856

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.12, max=34.71, count=80
  Deviation (μ̂): min=4.05, max=9.96

Costs:
  Plant fixed cost: min=6124, max=9786
  DC fixed cost: min=3012, max=5993
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
    Product 1: ['1.000', '1.320', '1.743'] (k=0.685)
    Product 2: ['1.000', '1.358', '1.844'] (k=0.755)
  MD:
    Product 0: ['1.000', '1.286', '1.653'] (k=0.620)
    Product 1: ['1.000', '1.212', '1.468'] (k=0.473)
    Product 2: ['1.000', '1.148', '1.318'] (k=0.341)
  LD:
    Product 0: ['1.000', '1.004', '1.007'] (k=0.009)
    Product 1: ['1.000', '1.039', '1.080'] (k=0.094)
    Product 2: ['1.000', '1.030', '1.061'] (k=0.073)
  Mixed:
    Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
    Product 1: ['1.000', '1.212', '1.468'] (k=0.473)
    Product 2: ['1.000', '1.030', '1.061'] (k=0.073)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x5d8f624b
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.08s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -266243.3461
Found heuristic solution: objective -180743.6115

Root relaxation: objective 1.459251e+05, 4890 iterations, 0.19 seconds (0.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 145925.148    0  462 -180743.61 145925.148   181%     -    0s
H    0     0                    -168791.6809 145925.148   186%     -    0s
     0     0 127619.763    0  680 -168791.68 127619.763   176%     -    0s
     0     0 127490.032    0  627 -168791.68 127490.032   176%     -    1s
     0     0 127472.431    0  631 -168791.68 127472.431   176%     -    1s
     0     0 127468.121    0  630 -168791.68 127468.121   176%     -    1s
     0     0 117990.341    0  792 -168791.68 117990.341   170%     -    1s
     0     0 117502.102    0  793 -168791.68 117502.102   170%     -    2s
     0     0 117462.840    0  800 -168791.68 117462.840   170%     -    2s
     0     0 117452.977    0  798 -168791.68 117452.977   170%     -    2s
     0     0 117452.572    0  794 -168791.68 117452.572   170%     -    2s
H    0     0                    -167956.7487 106327.917   163%     -    2s
H    0     0                    -166093.0875 106327.917   164%     -    2s
     0     0 106327.917    0  582 -166093.09 106327.917   164%     -    2s
H    0     0                    -164148.1619 106327.313   165%     -    2s
H    0     0                    -116662.8341 99990.5410   186%     -    3s
H    0     0                    -104068.9362 99990.5410   196%     -    3s
H    0     0                    -98176.52703 99990.5410   202%     -    3s
H    0     0                    -54874.96838 99990.5410   282%     -    3s
H    0     0                    39358.887906 99990.5410   154%     -    3s
H    0     0                    39730.746437 99990.5410   152%     -    3s
     0     0 99990.5410    0  483 39730.7464 99990.5410   152%     -    3s
     0     0 99546.1825    0  503 39730.7464 99546.1825   151%     -    3s
     0     0 99414.4646    0  541 39730.7464 99414.4646   150%     -    3s
     0     0 99407.8263    0  554 39730.7464 99407.8263   150%     -    3s
H    0     0                    42564.021259 99407.8263   134%     -    3s
H    0     0                    42570.120659 93708.8298   120%     -    4s
H    0     0                    42906.454933 93708.8298   118%     -    4s
H    0     0                    43016.701972 93708.8298   118%     -    4s
H    0     0                    43039.730117 93708.8298   118%     -    4s
H    0     0                    45514.158153 93708.8298   106%     -    4s
     0     0 93708.8298    0  599 45514.1582 93708.8298   106%     -    4s
H    0     0                    45672.893308 92663.0057   103%     -    4s
H    0     0                    45822.414933 92663.0057   102%     -    4s
H    0     0                    45834.644818 92663.0057   102%     -    4s
H    0     0                    45968.100040 92663.0057   102%     -    4s
H    0     0                    45973.170985 92663.0057   102%     -    4s
H    0     0                    46041.339883 92663.0057   101%     -    4s
H    0     0                    47150.173732 92663.0057  96.5%     -    4s
     0     0 92663.0057    0  639 47150.1737 92663.0057  96.5%     -    4s
     0     0 92395.6674    0  689 47150.1737 92395.6674  96.0%     -    5s
     0     0 92355.5100    0  683 47150.1737 92355.5100  95.9%     -    5s
     0     0 92349.3930    0  697 47150.1737 92349.3930  95.9%     -    5s
     0     0 90422.9553    0  643 47150.1737 90422.9553  91.8%     -    5s
     0     0 90073.7454    0  691 47150.1737 90073.7454  91.0%     -    6s
     0     0 89959.7826    0  694 47150.1737 89959.7826  90.8%     -    6s
     0     0 89939.7286    0  708 47150.1737 89939.7286  90.8%     -    6s
     0     0 88506.5873    0  689 47150.1737 88506.5873  87.7%     -    6s
     0     0 88114.6425    0  729 47150.1737 88114.6425  86.9%     -    7s
     0     0 88051.5772    0  732 47150.1737 88051.5772  86.7%     -    7s
     0     0 88033.3076    0  738 47150.1737 88033.3076  86.7%     -    7s
H    0     0                    49606.484871 87042.4848  75.5%     -    8s
H    0     0                    49628.613734 87042.4848  75.4%     -    8s
H    0     0                    50285.234168 87042.4848  73.1%     -    8s
H    0     0                    50789.008418 87042.4848  71.4%     -    8s
H    0     0                    50911.455774 87042.4848  71.0%     -    8s
H    0     0                    51147.021160 87042.4848  70.2%     -    8s
H    0     0                    51381.721706 87042.4848  69.4%     -    8s
     0     0 87042.4848    0  693 51381.7217 87042.4848  69.4%     -    8s
H    0     0                    51398.410357 86668.9103  68.6%     -    8s
H    0     0                    53658.799884 86668.9103  61.5%     -    8s
H    0     0                    54714.714232 86668.9103  58.4%     -    8s
H    0     0                    54940.188771 86668.9103  57.8%     -    8s
H    0     0                    55004.733558 86668.9103  57.6%     -    8s
     0     0 86668.9103    0  705 55004.7336 86668.9103  57.6%     -    8s
     0     0 86609.8899    0  727 55004.7336 86609.8899  57.5%     -    8s
H    0     0                    55077.811033 86549.7068  57.1%     -    8s
     0     0 86549.7068    0  748 55077.8110 86549.7068  57.1%     -    8s
     0     0 86537.3306    0  735 55077.8110 86537.3306  57.1%     -    8s
H    0     0                    55209.891382 86537.3306  56.7%     -    8s
     0     0 85748.2712    0  681 55209.8914 85748.2712  55.3%     -    9s
     0     0 85555.7659    0  716 55209.8914 85555.7659  55.0%     -    9s
     0     0 85479.2757    0  727 55209.8914 85479.2757  54.8%     -   10s
     0     0 85464.6734    0  729 55209.8914 85464.6734  54.8%     -   10s
     0     0 84954.3661    0  662 55209.8914 84954.3661  53.9%     -   10s
     0     0 84821.0172    0  777 55209.8914 84821.0172  53.6%     -   11s
     0     0 84748.1208    0  809 55209.8914 84748.1208  53.5%     -   11s
     0     0 84697.6279    0  744 55209.8914 84697.6279  53.4%     -   11s
     0     0 84685.6321    0  823 55209.8914 84685.6321  53.4%     -   11s
H    0     0                    55279.548989 84372.2859  52.6%     -   12s
H    0     0                    55329.494997 84372.2859  52.5%     -   12s
     0     0 84372.2859    0  668 55329.4950 84372.2859  52.5%     -   12s
     0     0 84291.9854    0  682 55329.4950 84291.9854  52.3%     -   12s
     0     0 84264.2855    0  681 55329.4950 84264.2855  52.3%     -   12s
     0     0 84051.4313    0  720 55329.4950 84051.4313  51.9%     -   13s
     0     0 84050.9436    0  720 55329.4950 84050.9436  51.9%     -   13s
     0     2 84050.6713    0  720 55329.4950 84050.6713  51.9%     -   14s
     3     8 83699.7186    2  538 55329.4950 83861.9769  51.6%  1088   15s
H  115   236                    55915.583249 82934.1791  48.3%  1086   19s
H  321   410                    56018.080175 82934.1791  48.0%   631   20s
H  321   410                    56205.585976 82934.1791  47.6%   631   20s
H  526   555                    56276.776712 82934.1791  47.4%   545   21s
H  542   555                    56312.469556 82934.1791  47.3%   542   21s
H  702   729                    56383.660291 82934.1791  47.1%   567   22s
H 1014  1053                    56956.609983 82918.6865  45.6%   540   24s
  1084  1138 70497.5159   25  339 56956.6100 82918.6865  45.6%   519   25s
H 1191  1234                    56966.652299 82829.1288  45.4%   509   26s
H 1210  1234                    57151.258692 82829.1288  44.9%   504   26s
H 1350  1315                    57189.660329 82758.1978  44.7%   503   27s
H 1362  1315                    57191.385678 82758.1978  44.7%   503   27s
H 1579  1577                    57229.787315 82758.1978  44.6%   477   28s
H 1604  1577                    57242.027163 82758.1978  44.6%   474   28s
  2267  2353 61963.4359   69  173 57242.0272 82748.8052  44.6%   416   30s
H 2396  2351                    57512.623259 82748.8052  43.9%   403   30s
H 2836  2709                    57560.928930 82748.8052  43.8%   369   31s
H 2937  3048                    57578.186105 82748.8052  43.7%   362   32s
H 3216  3048                    57616.837314 82748.8052  43.6%   343   32s
  4286  3883 80529.3598   18  720 57616.8373 82726.8575  43.6%   303   40s
  4349  3958 78963.3492   16  332 57616.8373 79928.1235  38.7%   305   45s
H 4647  3933                    58299.703646 79403.0269  36.2%   310   46s
H 4877  3767                    58575.048032 78944.4728  34.8%   305   47s
H 4883  3588                    58609.801450 78944.4728  34.7%   305   47s
H 4887  3419                    58680.872518 78944.4728  34.5%   305   47s
H 4901  3255                    58823.361378 78944.4728  34.2%   305   47s
H 5054  3121                    58837.493584 77399.2038  31.5%   304   47s
  5689  3213 71420.0569   18  249 58837.4936 76391.6506  29.8%   295   50s
H 5803  3065                    58988.049145 76391.6506  29.5%   294   50s
  7574  3046 60824.4174   29  126 58988.0491 73112.9743  23.9%   271   55s
H 8420  2797                    59160.774245 72398.9848  22.4%   265   58s
H 8523  2745                    59862.794939 72398.9848  20.9%   265   59s
H 8595  2598                    60337.749692 72398.9848  20.0%   264   59s
H 8892  2408                    60476.786494 71274.9969  17.9%   262   59s
H 8962  2273                    60502.348694 71274.9969  17.8%   262   59s
  9275  2203 63163.8695   24  212 60502.3487 71209.4312  17.7%   260   60s
H10721  1712                    60533.190093 69361.8360  14.6%   251   61s
H10733  1705                    60613.340150 69329.8331  14.4%   251   61s
*12847  1703              47    61101.630978 68111.9989  11.5%   244   64s
 13433  1643 62373.3861   27  226 61101.6310 67613.9727  10.7%   242   65s
H17839  1801                    61460.129529 64328.2258  4.67%   227   69s
H17842  1801                    61752.445155 64328.2258  4.17%   227   69s
*19670  1801              64    61854.561806 64318.9087  3.98%   210   69s
*20722  3290              62    62207.642311 63926.4897  2.76%   201   69s
*25554  2581              82    62338.238486 63090.6908  1.21%   168   69s
 27266  1661     cutoff   50      62338.2385 62666.5224  0.53%   159   70s
*28350  1661              54    62390.191109 62656.1413  0.43%   153   70s
*28354  1661              53    62416.986057 62656.1413  0.38%   153   70s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 2
  MIR: 349
  Mixing: 2
  Flow cover: 466
  RLT: 10
  Relax-and-lift: 51

Explored 33908 nodes (4485706 simplex iterations) in 71.11 seconds (159.76 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 62417 62390.2 62338.2 ... 60533.2

Optimal solution found (tolerance 1.00e-04)
Best objective 6.241698605738e+04, best bound 6.241698605738e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 71.12s
  Master Objective (UB) = 62416.99, θ = 229282.02
  Upper Bound (UB) = 62416.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229282.02
  [DEBUG]   ✓ Scenario 0: θ = 229282.02 ≤ Q = 229282.02 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2879e147
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2879e147
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.270470e+13
Presolve removed 2599 rows and 1890 columns
Presolve time: 0.00s
Presolved: 494 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6068764.9158
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.562800e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156279.96    0  123 6068764.92 -156279.96   103%     -    0s
H    0     0                    -121596.0174 -156279.96  28.5%     -    0s
H    0     0                    -122602.6226 -156279.96  27.5%     -    0s
H    0     0                    -124975.2423 -124975.24  0.00%     -    0s
     0     0          -    0      -124975.24 -124975.24  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 203

Explored 1 nodes (370 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -124975 -122603 -121596 ... 1.27047e+13
No other solutions better than -124975

Optimal solution found (tolerance 1.00e-04)
Best objective -1.249752422817e+05, best bound -1.249752422817e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 195333.12
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124975.24
  [DEBUG]   S×d_nominal = 320308.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320308.36 + -124975.24 = 195333.12
  [DEBUG]   Current θ from Master = 229282.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33948.90 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28468.08
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 33948.9015, Absolute Gap = 33948.9015, Relative Gap = 0.543905
  Not converged yet (gap = 33948.90 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xa828b15b
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 28468.1 (0.01s)
MIP start from previous solve produced solution with objective 28468.1 (0.01s)
Loaded MIP start from previous solve with objective 28468.1

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.29s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 7.473278e+04, 8416 iterations, 0.90 seconds (1.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 74732.7810    0  251 28468.0846 74732.7810   163%     -    1s
H    0     0                    28470.545969 74732.7810   162%     -    1s
H    0     0                    29520.277177 74732.7810   153%     -    1s
H    0     0                    29655.678443 74732.7810   152%     -    1s
     0     0 68799.2912    0  269 29655.6784 68799.2912   132%     -    2s
     0     0 68540.2582    0  270 29655.6784 68540.2582   131%     -    2s
     0     0 68540.2451    0  270 29655.6784 68540.2451   131%     -    2s
     0     0 64315.2084    0  327 29655.6784 64315.2084   117%     -    3s
     0     0 63574.4622    0  359 29655.6784 63574.4622   114%     -    3s
     0     0 63499.7776    0  368 29655.6784 63499.7776   114%     -    3s
     0     0 63492.0392    0  364 29655.6784 63492.0392   114%     -    3s
     0     0 63490.6534    0  371 29655.6784 63490.6534   114%     -    3s
     0     0 60426.5522    0  437 29655.6784 60426.5522   104%     -    5s
     0     0 59900.8076    0  452 29655.6784 59900.8076   102%     -    6s
     0     0 59722.9604    0  460 29655.6784 59722.9604   101%     -    6s
     0     0 59645.5308    0  460 29655.6784 59645.5308   101%     -    6s
     0     0 59632.9821    0  476 29655.6784 59632.9821   101%     -    6s
     0     0 59626.7553    0  473 29655.6784 59626.7553   101%     -    6s
     0     0 59626.0461    0  480 29655.6784 59626.0461   101%     -    6s
H    0     0                    29673.495310 57533.3614  93.9%     -    8s
H    0     0                    29770.230666 57533.3614  93.3%     -    8s
H    0     0                    29809.824537 57533.3614  93.0%     -    8s
     0     0 57533.3614    0  448 29809.8245 57533.3614  93.0%     -    8s
     0     0 56939.6249    0  466 29809.8245 56939.6249  91.0%     -    9s
     0     0 56719.0256    0  489 29809.8245 56719.0256  90.3%     -    9s
     0     0 56671.3173    0  493 29809.8245 56671.3173  90.1%     -    9s
H    0     0                    30394.627212 56638.9961  86.3%     -   10s
     0     0 56638.9961    0  489 30394.6272 56638.9961  86.3%     -   10s
H    0     0                    30421.769327 56617.1310  86.1%     -   10s
H    0     0                    30654.994363 56617.1310  84.7%     -   10s
H    0     0                    31534.883313 56617.1310  79.5%     -   10s
H    0     0                    31635.933844 56617.1310  79.0%     -   10s
H    0     0                    31733.710257 56617.1310  78.4%     -   10s
H    0     0                    31830.649430 56617.1310  77.9%     -   10s
H    0     0                    32022.297585 56617.1310  76.8%     -   10s
     0     0 56617.1310    0  484 32022.2976 56617.1310  76.8%     -   10s
     0     0 56607.9432    0  493 32022.2976 56607.9432  76.8%     -   10s
     0     0 56565.7024    0  509 32022.2976 56565.7024  76.6%     -   10s
     0     0 56556.3538    0  505 32022.2976 56556.3538  76.6%     -   10s
     0     0 56555.6639    0  507 32022.2976 56555.6639  76.6%     -   10s
     0     0 55592.5826    0  366 32022.2976 55592.5826  73.6%     -   11s
     0     0 55370.4308    0  462 32022.2976 55370.4308  72.9%     -   12s
     0     0 55253.0653    0  414 32022.2976 55253.0653  72.5%     -   12s
     0     0 55238.1188    0  475 32022.2976 55238.1188  72.5%     -   12s
     0     0 55199.9287    0  468 32022.2976 55199.9287  72.4%     -   12s
     0     0 55170.6816    0  466 32022.2976 55170.6816  72.3%     -   13s
     0     0 55168.6503    0  468 32022.2976 55168.6503  72.3%     -   13s
     0     0 54956.7699    0  455 32022.2976 54956.7699  71.6%     -   13s
H    0     0                    32135.762966 54816.4472  70.6%     -   14s
     0     0 54816.4472    0  518 32135.7630 54816.4472  70.6%     -   14s
     0     0 54781.2294    0  470 32135.7630 54781.2294  70.5%     -   14s
     0     0 54775.8239    0  465 32135.7630 54775.8239  70.5%     -   15s
H    0     0                    32136.441100 54666.7961  70.1%     -   15s
H    0     0                    32174.186020 54666.7961  69.9%     -   15s
H    0     0                    32206.197098 54666.7961  69.7%     -   15s
     0     0 54666.7961    0  398 32206.1971 54666.7961  69.7%     -   15s
     0     0 54635.5674    0  388 32206.1971 54635.5674  69.6%     -   15s
     0     0 54630.6291    0  382 32206.1971 54630.6291  69.6%     -   15s
     0     0 54606.6237    0  396 32206.1971 54606.6237  69.6%     -   16s
H    0     0                    32292.724115 54602.9147  69.1%     -   16s
H    0     0                    32521.668670 54602.9147  67.9%     -   16s
     0     0 54597.8750    0  385 32521.6687 54597.8750  67.9%     -   16s
     0     0 54593.2343    0  391 32521.6687 54593.2343  67.9%     -   16s
     0     0 54568.7410    0  391 32521.6687 54568.7410  67.8%     -   17s
     0     0 54563.0873    0  392 32521.6687 54563.0873  67.8%     -   17s
H    0     0                    32637.280643 54563.0873  67.2%     -   17s
     0     0 54538.6250    0  380 32637.2806 54538.6250  67.1%     -   17s
     0     0 54538.5819    0  380 32637.2806 54538.5819  67.1%     -   17s
     0     2 54538.5819    0  380 32637.2806 54538.5819  67.1%     -   20s
H   31    64                    32640.363159 53794.0183  64.8%  1230   24s
    63    96 53429.6334    6  398 32640.3632 53637.2080  64.3%  1167   25s
H   97   170                    33173.520344 53637.0996  61.7%  1067   27s
H  259   334                    33744.417162 53637.0996  59.0%   743   29s
H  269   334                    33903.181980 53637.0996  58.2%   750   29s
H  308   334                    35364.825647 53637.0996  51.7%   731   29s
   333   422 51813.1423    9  459 35364.8256 53637.0996  51.7%   695   30s
H  437   487                    35410.906704 53637.0996  51.5%   630   30s
H  443   487                    37160.282508 53637.0996  44.3%   632   30s
H  457   487                    37186.982131 53637.0996  44.2%   627   30s
H  458   487                    38255.031414 53637.0996  40.2%   626   30s
   791   763 50367.3552   12  392 38255.0314 53534.8089  39.9%   519   35s
  1336  1357 48319.4281   21  340 38255.0314 53224.4083  39.1%   430   40s
  2427  2261 46577.6117   25  314 38255.0314 53150.3674  38.9%   312   45s
  3304  2915 39737.5386   35  220 38255.0314 52996.5316  38.5%   295   50s
H 3768  3064                    38452.015027 52996.5316  37.8%   286   53s
H 3768  3064                    38477.708116 52996.5316  37.7%   286   53s
  3769  3065 39047.2102   52  380 38477.7081 52996.5316  37.7%   286   59s
  3771  3066 44325.4638   42  125 38477.7081 52996.5316  37.7%   285   60s
  3783  3074 47389.7841   12  376 38477.7081 52996.5316  37.7%   285   65s
  3798  3084 40963.1838   43  395 38477.7081 52996.5316  37.7%   283   70s
  3809  3092 50008.4802    9  398 38477.7081 52996.5316  37.7%   283   75s
  3825  3119 51210.1168   15  337 38477.7081 52996.5316  37.7%   292   80s
  3998  3290 44234.0949   20  309 38477.7081 50981.1099  32.5%   312   85s
H 4352  3172                    39258.432222 50981.1099  29.9%   325   89s
  4400  3163     cutoff   25      39258.4322 50981.1099  29.9%   327   90s
H 4490  3005                    39776.707971 49692.7319  24.9%   328   91s
H 4678  2841                    40606.045360 49113.7953  21.0%   331   93s
  4806  2819 44212.7716   18  303 40606.0454 49113.7953  21.0%   331   95s
  5368  2724 44304.5065   19  202 40606.0454 47646.2966  17.3%   338  100s
H 5482  2574                    40886.994197 47295.2537  15.7%   340  101s
H 5514  2437                    41012.618088 47210.9205  15.1%   340  101s
* 5976  2150              30    41016.044317 46807.5145  14.1%   341  104s
  6101  2088     cutoff   24      41016.0443 46807.5145  14.1%   342  105s
H 6752  1731                    41057.766055 45400.7965  10.6%   344  109s
  6813  1669     cutoff   21      41057.7661 45370.4865  10.5%   344  110s

Cutting planes:
  Lift-and-project: 1
  MIR: 352
  Mixing: 2
  Flow cover: 500
  RLT: 4
  Relax-and-lift: 59

Explored 8200 nodes (2763461 simplex iterations) in 114.74 seconds (278.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 41057.8 41016 41012.6 ... 38255

Optimal solution found (tolerance 1.00e-04)
Best objective 4.105776605546e+04, best bound 4.105776605546e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 114.75s
  Master Objective (UB) = 41057.77, θ = 193793.97
  Upper Bound (UB) = 41057.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 193793.97
  [DEBUG]   ✓ Scenario 0: θ = 193793.97 ≤ Q = 193793.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 193793.97 ≤ Q = 193793.97 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7059e7fe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8fa61802
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.389457e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6869474.5981
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.638860e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163886.04    0  129 6869474.60 -163886.04   102%     -    0s
H    0     0                    -125067.8830 -163886.04  31.0%     -    0s
H    0     0                    -126735.8173 -163886.04  29.3%     -    0s
H    0     0                    -141274.7228 -163886.04  16.0%     -    0s
H    0     0                    -146641.5531 -163886.04  11.8%     -    0s
     0     0 -152246.74    0   94 -146641.55 -152246.74  3.82%     -    0s
H    0     0                    -148814.2733 -152095.80  2.21%     -    0s
H    0     0                    -149132.3207 -152095.80  1.99%     -    0s
H    0     0                    -149637.2443 -152095.80  1.64%     -    0s
H    0     0                    -149955.2918 -152095.80  1.43%     -    0s
     0     0 -151741.64    0   96 -149955.29 -151741.64  1.19%     -    0s
     0     0 -150412.15    0   53 -149955.29 -150412.15  0.30%     -    0s
     0     0 -150401.52    0   51 -149955.29 -150401.52  0.30%     -    0s
     0     0 -150395.13    0   50 -149955.29 -150395.13  0.29%     -    0s
     0     0 -150311.87    0   44 -149955.29 -150311.87  0.24%     -    0s
     0     0 -150309.19    0   43 -149955.29 -150309.19  0.24%     -    0s
     0     0 -150309.04    0   43 -149955.29 -150309.04  0.24%     -    0s
H    0     0                    -149967.9311 -150309.04  0.23%     -    0s
     0     0 -149991.29    0    9 -149967.93 -149991.29  0.02%     -    0s
     0     0 -149982.80    0    7 -149967.93 -149982.80  0.01%     -    0s

Cutting planes:
  Gomory: 35
  Implied bound: 17
  MIR: 70
  Flow cover: 12
  RLT: 118
  Relax-and-lift: 8
  BQP: 5

Explored 1 nodes (661 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -149968 -149968 -149955 ... 1.38946e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.499679310894e+05, best bound -1.499828029352e+05, gap 0.0099%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 171174.10
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149967.93
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -149967.93 = 171174.10
  [DEBUG]   Current θ from Master = 193793.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22619.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18437.89
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 12589.6815, Absolute Gap = 12589.6815, Relative Gap = 0.306633
  Not converged yet (gap = 12589.68 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xd34d19d3
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 18437.9 (0.02s)
MIP start from previous solve produced solution with objective 18437.9 (0.02s)
Loaded MIP start from previous solve with objective 18437.9

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.40s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.12s

Solved with dual simplex

Root relaxation: objective 6.460021e+04, 16044 iterations, 2.75 seconds (5.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64600.2091    0  125 18437.8945 64600.2091   250%     -    3s
H    0     0                    30682.198632 64600.2091   111%     -    3s
H    0     0                    33617.808097 64600.2091  92.2%     -    3s
H    0     0                    33715.910243 64600.2091  91.6%     -    3s
H    0     0                    33750.452651 64600.2091  91.4%     -    3s
H    0     0                    33767.993974 64600.2091  91.3%     -    3s
H    0     0                    33862.754902 59749.4357  76.4%     -    4s
H    0     0                    33900.052936 59749.4357  76.3%     -    4s
H    0     0                    33917.594259 59749.4357  76.2%     -    4s
     0     0 59712.7752    0  178 33917.5943 59712.7752  76.1%     -    4s
     0     0 59273.5004    0  213 33917.5943 59273.5004  74.8%     -    5s
     0     0 59077.9765    0  214 33917.5943 59077.9765  74.2%     -    5s
     0     0 59074.0999    0  211 33917.5943 59074.0999  74.2%     -    5s
     0     0 59074.0999    0  213 33917.5943 59074.0999  74.2%     -    5s
     0     0 59074.0999    0  213 33917.5943 59074.0999  74.2%     -    5s
     0     0 57200.7653    0  233 33917.5943 57200.7653  68.6%     -    7s
     0     0 56607.5468    0  257 33917.5943 56607.5468  66.9%     -    7s
     0     0 56433.8043    0  260 33917.5943 56433.8043  66.4%     -    8s
     0     0 56327.2039    0  261 33917.5943 56327.2039  66.1%     -    8s
     0     0 56297.0734    0  271 33917.5943 56297.0734  66.0%     -    8s
     0     0 56291.9113    0  268 33917.5943 56291.9113  66.0%     -    8s
     0     0 56290.5027    0  269 33917.5943 56290.5027  66.0%     -    8s
     0     0 56290.4878    0  269 33917.5943 56290.4878  66.0%     -    8s
H    0     0                    34096.627495 54849.4218  60.9%     -   10s
H    0     0                    34107.400865 54849.4218  60.8%     -   10s
     0     0 54849.4218    0  305 34107.4009 54849.4218  60.8%     -   10s
H    0     0                    34203.844848 54848.9314  60.4%     -   11s
     0     0 54101.4292    0  340 34203.8448 54101.4292  58.2%     -   11s
     0     0 53960.5911    0  360 34203.8448 53960.5911  57.8%     -   12s
H    0     0                    35038.623720 53845.7567  53.7%     -   13s
H    0     0                    35191.345326 53845.7567  53.0%     -   13s
     0     0 53845.7567    0  341 35191.3453 53845.7567  53.0%     -   13s
H    0     0                    35406.314501 53796.8286  51.9%     -   13s
     0     0 53796.8286    0  359 35406.3145 53796.8286  51.9%     -   13s
     0     0 53776.6070    0  356 35406.3145 53776.6070  51.9%     -   13s
     0     0 53772.4136    0  354 35406.3145 53772.4136  51.9%     -   13s
     0     0 53771.5582    0  353 35406.3145 53771.5582  51.9%     -   13s
     0     0 52921.7405    0  357 35406.3145 52921.7405  49.5%     -   16s
     0     0 52739.1984    0  339 35406.3145 52739.1984  49.0%     -   16s
     0     0 52701.9561    0  346 35406.3145 52701.9561  48.8%     -   17s
     0     0 52671.8808    0  352 35406.3145 52671.8808  48.8%     -   17s
     0     0 52643.4854    0  361 35406.3145 52643.4854  48.7%     -   17s
     0     0 52629.5851    0  353 35406.3145 52629.5851  48.6%     -   17s
     0     0 52623.3056    0  352 35406.3145 52623.3056  48.6%     -   17s
     0     0 52618.3006    0  351 35406.3145 52618.3006  48.6%     -   17s
     0     0 52617.3016    0  354 35406.3145 52617.3016  48.6%     -   17s
     0     0 52528.7769    0  368 35406.3145 52528.7769  48.4%     -   18s
     0     0 52514.3948    0  363 35406.3145 52514.3948  48.3%     -   18s
     0     0 52505.9707    0  362 35406.3145 52505.9707  48.3%     -   18s
     0     0 52503.8703    0  368 35406.3145 52503.8703  48.3%     -   19s
     0     0 52500.7092    0  371 35406.3145 52500.7092  48.3%     -   19s
     0     0 52500.4859    0  363 35406.3145 52500.4859  48.3%     -   19s
     0     0 52464.5285    0  380 35406.3145 52464.5285  48.2%     -   19s
     0     0 52444.6925    0  376 35406.3145 52444.6925  48.1%     -   20s
     0     0 52443.7869    0  375 35406.3145 52443.7869  48.1%     -   20s
     0     0 52435.3933    0  367 35406.3145 52435.3933  48.1%     -   20s
     0     0 52434.4222    0  372 35406.3145 52434.4222  48.1%     -   20s
     0     0 52403.3895    0  357 35406.3145 52403.3895  48.0%     -   21s
     0     0 52400.9235    0  347 35406.3145 52400.9235  48.0%     -   21s
     0     0 52399.7716    0  349 35406.3145 52399.7716  48.0%     -   21s
     0     0 52397.6558    0  353 35406.3145 52397.6558  48.0%     -   21s
     0     0 52397.3401    0  357 35406.3145 52397.3401  48.0%     -   22s
     0     0 52397.3401    0  357 35406.3145 52397.3401  48.0%     -   22s
     0     0 52393.4025    0  357 35406.3145 52393.4025  48.0%     -   22s
     0     0 52393.4025    0  357 35406.3145 52393.4025  48.0%     -   22s
     0     0 52393.4025    0  357 35406.3145 52393.4025  48.0%     -   22s
H    0     0                    35432.196854 52393.4025  47.9%     -   26s
     0     2 52393.4025    0  357 35432.1969 52393.4025  47.9%     -   26s
     7    16 52114.0677    3  377 35432.1969 52166.0248  47.2%  2048   30s
H   37    64                    35445.138077 52092.5698  47.0%  2840   32s
H   60    64                    35746.581651 51739.7615  44.7%  2537   32s
    95   187 51441.1741    7  353 35746.5817 51734.8476  44.7%  2259   36s
H  141   187                    36098.230609 51734.8476  43.3%  1840   36s
H  260   318                    36183.577882 51734.8476  43.0%  1573   39s
H  274   318                    36249.161788 51734.8476  42.7%  1554   39s
H  302   318                    36316.763743 51734.8476  42.5%  1525   39s
   317   372 50534.5036   11  341 36316.7637 51734.8476  42.5%  1495   41s
H  397   425                    36376.233648 51734.8476  42.2%  1602   42s
   486   521 48116.6189   13  337 36376.2336 51734.8476  42.2%  1520   46s
H  514   521                    36400.621035 51734.8476  42.1%  1558   46s
   605   617 46779.1001   14  321 36400.6210 51734.8476  42.1%  1590   50s
H  607   617                    36508.334478 51734.8476  41.7%  1591   50s
H  610   617                    36603.682294 51734.8476  41.3%  1596   50s
H  638   617                    36608.725505 51734.8476  41.3%  1601   50s
H  758   699                    36694.927108 51553.4247  40.5%  1564   54s
   788   743 44270.6386   16  305 36694.9271 51503.6437  40.4%  1549   56s
   969   904 41691.5360   20  211 36694.9271 51503.6437  40.4%  1513   60s
H 1040   937                    36758.833894 51503.6437  40.1%  1481   61s
H 1080  1011                    36807.827057 51356.0955  39.5%  1461   63s
H 1084  1011                    37107.710855 51356.0955  38.4%  1458   63s
H 1100  1011                    37125.786097 51356.0955  38.3%  1449   63s
H 1136  1011                    37168.389316 51356.0955  38.2%  1436   63s
  1158  1084 43342.8595   26  254 37168.3893 51308.5141  38.0%  1432   65s
H 1274  1150                    37195.176309 51308.5141  37.9%  1405   67s
H 1309  1150                    37203.961036 51308.5141  37.9%  1396   67s
H 1423  1250                    37240.561329 51308.5141  37.8%  1364   71s
H 1535  1250                    37257.608786 51267.8716  37.6%  1336   71s
  1673  1354 38504.7572   35  190 37257.6088 51233.7182  37.5%  1300   76s
H 1680  1354                    37264.039572 51233.7182  37.5%  1302   76s
H 1710  1432                    37272.872684 51233.7182  37.5%  1298   78s
H 1721  1432                    37309.472976 51233.7182  37.3%  1291   78s
H 1744  1432                    37316.883871 51233.7182  37.3%  1284   78s
H 1754  1432                    37319.102830 51233.7182  37.3%  1281   78s
H 1810  1432                    37327.485286 51233.7182  37.3%  1268   78s
  1848  1509 infeasible   23      37327.4853 51233.7182  37.3%  1260   80s
  2132  1672 41564.4333   16  200 37327.4853 51233.7182  37.3%  1213   85s
  2391  1737     cutoff   19      37327.4853 50886.8877  36.3%  1186   90s
  2552  1828 47633.6302   10  327 37327.4853 50834.7310  36.2%  1171   96s
  2807  2034 42479.3945   14  243 37327.4853 50834.7310  36.2%  1153  101s
  3305  2226 39410.2260   18  205 37327.4853 50364.9674  34.9%  1083  106s
  3733  2483 44687.8150   14  293 37327.4853 50170.0043  34.4%  1057  112s
  3965  2557     cutoff   18      37327.4853 50169.5718  34.4%  1041  115s
H 4235  2655                    37328.261094 50113.0023  34.2%  1025  118s
  4417  2744 infeasible   22      37328.2611 49999.6070  33.9%  1028  121s
  4637  2745 47696.3291   11  357 37328.2611 49999.6070  33.9%  1029  128s
  4639  2746 47247.7538   13  125 37328.2611 49999.6070  33.9%  1028  131s
  4641  2748 41737.5772   13  342 37328.2611 49999.6070  33.9%  1028  135s
  4651  2754 37773.2968   36  369 37328.2611 49999.6070  33.9%  1026  140s
  4660  2760 43214.4790   12  413 37328.2611 49999.6070  33.9%  1024  146s
  4665  2764 45190.0391   23  373 37328.2611 49999.6070  33.9%  1023  151s
  4667  2768 49999.6070   11  334 37328.2611 49999.6070  33.9%  1032  156s
  4673  2778 42403.7986   13  335 37328.2611 49664.9613  33.0%  1036  160s
  4729  2837 39674.7244   16  292 37328.2611 48467.3831  29.8%  1056  165s
  4836  2886 37998.8556   19  297 37328.2611 48467.3831  29.8%  1092  171s
  4948  2884 42625.5240   18  246 37328.2611 48467.3831  29.8%  1098  176s
  5149  2906 40706.1449   19  235 37328.2611 47853.5419  28.2%  1099  181s
  5278  2891 38896.9320   20  203 37328.2611 47853.5419  28.2%  1101  185s
  5504  2852 41296.2974   18  244 37328.2611 46222.5903  23.8%  1099  190s
  5613  2846 40347.0508   21  183 37328.2611 46222.5903  23.8%  1100  195s
H 5634  2700                    37394.203776 46222.5903  23.6%  1100  195s
  5850  2680 41058.4855   21  150 37394.2038 45762.1276  22.4%  1098  201s
  6055  2634     cutoff   25      37394.2038 44805.4409  19.8%  1094  205s
  6390  2526 37510.0973   25  161 37394.2038 44490.6811  19.0%  1088  212s
  6628  2481     cutoff   26      37394.2038 43387.2868  16.0%  1087  217s
  6913  2395 38567.1355   21  225 37394.2038 42201.7483  12.9%  1081  222s
  7093  2336 39555.6784   20  255 37394.2038 42198.5073  12.8%  1071  225s
  7463  2233     cutoff   25      37394.2038 42198.5073  12.8%  1058  230s
H 7545  2074                    37765.451138 42198.5073  11.7%  1053  230s
  7827  1899 39217.2308   24  216 37765.4511 40956.6565  8.45%  1046  236s
* 8107  1611              40    38523.924993 40791.9730  5.89%  1033  238s
* 8184  1467              48    38844.712672 40791.9730  5.01%  1028  238s
  8369  1057     cutoff   23      38844.7127 40791.9730  5.01%  1022  240s
* 8696   835              41    38940.097139 40000.2882  2.72%   987  240s
* 8744   712              29    39028.729569 40000.2882  2.49%   982  240s
* 8781   598              30    39030.672466 39971.0255  2.41%   978  240s
* 8827   485              32    39049.930241 39055.5047  0.01%   974  240s

Cutting planes:
  Gomory: 1
  MIR: 187
  Flow cover: 462
  RLT: 12
  Relax-and-lift: 38

Explored 8877 nodes (8660284 simplex iterations) in 240.27 seconds (752.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 39049.9 39030.7 39028.7 ... 37327.5

Optimal solution found (tolerance 1.00e-04)
Best objective 3.904993024104e+04, best bound 3.904993024104e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 240.28s
  Master Objective (UB) = 39049.93, θ = 190846.61
  Upper Bound (UB) = 39049.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190846.61
  [DEBUG]   ✓ Scenario 0: θ = 190846.61 ≤ Q = 190846.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190846.61 ≤ Q = 190846.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190846.61 ≤ Q = 190846.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x15de918d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x15de918d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.405529e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6872104.3674
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.619212e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161921.18    0  124 6872104.37 -161921.18   102%     -    0s
H    0     0                    -127228.1307 -161921.18  27.3%     -    0s
H    0     0                    -128050.1212 -161921.18  26.5%     -    0s
H    0     0                    -140584.8095 -145299.49  3.35%     -    0s
     0     0 -145299.49    0   98 -140584.81 -145299.49  3.35%     -    0s
H    0     0                    -141569.2223 -145252.43  2.60%     -    0s
     0     0 -143586.73    0   95 -141569.22 -143586.73  1.43%     -    0s
H    0     0                    -141753.9569 -143478.78  1.22%     -    0s
     0     0 -143303.41    0   95 -141753.96 -143303.41  1.09%     -    0s
     0     0 -142997.85    0   67 -141753.96 -142997.85  0.88%     -    0s
     0     0 -142879.85    0   73 -141753.96 -142879.85  0.79%     -    0s
     0     0 -142870.94    0   74 -141753.96 -142870.94  0.79%     -    0s
     0     0 -142337.58    0   54 -141753.96 -142337.58  0.41%     -    0s
     0     0 -142305.49    0   52 -141753.96 -142305.49  0.39%     -    0s
     0     0 -142293.63    0   52 -141753.96 -142293.63  0.38%     -    0s
     0     0 -142109.18    0   27 -141753.96 -142109.18  0.25%     -    0s
     0     0 -142108.87    0   16 -141753.96 -142108.87  0.25%     -    0s
     0     0 -142052.32    0   22 -141753.96 -142052.32  0.21%     -    0s
     0     0 -142047.57    0   21 -141753.96 -142047.57  0.21%     -    0s
     0     0 -141901.89    0   15 -141753.96 -141901.89  0.10%     -    0s
     0     0 -141895.39    0   13 -141753.96 -141895.39  0.10%     -    0s
     0     0 -141883.90    0   11 -141753.96 -141883.90  0.09%     -    0s
     0     0 -141883.60    0   12 -141753.96 -141883.60  0.09%     -    0s
     0     0 -141831.17    0   10 -141753.96 -141831.17  0.05%     -    0s
     0     0 -141793.67    0    9 -141753.96 -141793.67  0.03%     -    0s
H    0     0                    -141771.2462 -141793.67  0.02%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  Flow cover: 5
  Relax-and-lift: 4

Explored 1 nodes (860 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -141771 -141754 -141732 ... 1.40553e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.417712461793e+05, best bound -1.417835628590e+05, gap 0.0087%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 179370.78
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141771.25
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -141771.25 = 179370.78
  [DEBUG]   Current θ from Master = 190846.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11475.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27574.10
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 10581.8456, Absolute Gap = 10581.8456, Relative Gap = 0.270982
  Not converged yet (gap = 10581.85 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0xac9e45a9
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 27574.1 (0.02s)
MIP start from previous solve produced solution with objective 27574.1 (0.02s)
Loaded MIP start from previous solve with objective 27574.1

Presolve removed 28280 rows and 11480 columns
Presolve time: 0.53s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54036    5.0483307e+04   0.000000e+00   1.146816e+07      5s
Concurrent spin time: 0.48s

Solved with dual simplex

Root relaxation: objective 6.456605e+04, 24267 iterations, 5.87 seconds (12.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64566.0536    0  131 27574.0998 64566.0536   134%     -    6s
H    0     0                    32626.995379 64566.0536  97.9%     -    6s
H    0     0                    34507.354106 64566.0536  87.1%     -    6s
H    0     0                    36812.409267 64566.0536  75.4%     -    6s
H    0     0                    38381.488712 59787.1679  55.8%     -    9s
H    0     0                    38401.273159 59787.1679  55.7%     -    9s
H    0     0                    38567.124270 59787.1679  55.0%     -    9s
     0     0 59787.1679    0  204 38567.1243 59787.1679  55.0%     -    9s
     0     0 59334.3161    0  210 38567.1243 59334.3161  53.8%     -    9s
     0     0 59282.8118    0  221 38567.1243 59282.8118  53.7%     -   10s
     0     0 59140.2403    0  220 38567.1243 59140.2403  53.3%     -   11s
     0     0 59140.2403    0  216 38567.1243 59140.2403  53.3%     -   11s
     0     0 57135.2926    0  247 38567.1243 57135.2926  48.1%     -   13s
     0     0 56616.8957    0  270 38567.1243 56616.8957  46.8%     -   14s
     0     0 56464.6270    0  269 38567.1243 56464.6270  46.4%     -   15s
     0     0 56409.1127    0  266 38567.1243 56409.1127  46.3%     -   15s
     0     0 56364.6895    0  268 38567.1243 56364.6895  46.1%     -   15s
     0     0 56359.6320    0  272 38567.1243 56359.6320  46.1%     -   15s
     0     0 56345.3901    0  266 38567.1243 56345.3901  46.1%     -   15s
     0     0 56344.9706    0  265 38567.1243 56344.9706  46.1%     -   15s
     0     0 54697.0716    0  295 38567.1243 54697.0716  41.8%     -   20s
     0     0 54251.7173    0  314 38567.1243 54251.7173  40.7%     -   21s
     0     0 53939.3183    0  350 38567.1243 53939.3183  39.9%     -   23s
     0     0 53902.8825    0  343 38567.1243 53902.8825  39.8%     -   23s
     0     0 53893.2963    0  350 38567.1243 53893.2963  39.7%     -   23s
     0     0 53869.8380    0  342 38567.1243 53869.8380  39.7%     -   24s
     0     0 53868.1285    0  348 38567.1243 53868.1285  39.7%     -   24s
     0     0 53867.6148    0  349 38567.1243 53867.6148  39.7%     -   24s
     0     0 53261.9938    0  345 38567.1243 53261.9938  38.1%     -   28s
     0     0 52888.5674    0  356 38567.1243 52888.5674  37.1%     -   29s
     0     0 52688.4349    0  353 38567.1243 52688.4349  36.6%     -   31s
     0     0 52622.3286    0  357 38567.1243 52622.3286  36.4%     -   31s
     0     0 52597.6728    0  363 38567.1243 52597.6728  36.4%     -   31s
     0     0 52582.5476    0  365 38567.1243 52582.5476  36.3%     -   32s
     0     0 52574.3610    0  362 38567.1243 52574.3610  36.3%     -   32s
     0     0 52567.9697    0  367 38567.1243 52567.9697  36.3%     -   32s
     0     0 52566.4200    0  363 38567.1243 52566.4200  36.3%     -   32s
     0     0 52566.1497    0  368 38567.1243 52566.1497  36.3%     -   32s
     0     0 52517.2439    0  365 38567.1243 52517.2439  36.2%     -   33s
     0     0 52486.5748    0  364 38567.1243 52486.5748  36.1%     -   34s
     0     0 52470.1562    0  374 38567.1243 52470.1562  36.0%     -   35s
     0     0 52458.6780    0  369 38567.1243 52458.6780  36.0%     -   35s
     0     0 52456.5768    0  373 38567.1243 52456.5768  36.0%     -   35s
     0     0 52454.7742    0  369 38567.1243 52454.7742  36.0%     -   35s
     0     0 52454.0511    0  376 38567.1243 52454.0511  36.0%     -   35s
H    0     0                    38738.852459 52425.7215  35.3%     -   36s
     0     0 52425.7215    0  367 38738.8525 52425.7215  35.3%     -   36s
     0     0 52419.0910    0  373 38738.8525 52419.0910  35.3%     -   37s
     0     0 52419.0910    0  373 38738.8525 52419.0910  35.3%     -   37s
     0     0 52414.5969    0  371 38738.8525 52414.5969  35.3%     -   38s
     0     0 52408.9365    0  381 38738.8525 52408.9365  35.3%     -   38s
     0     0 52406.6290    0  378 38738.8525 52406.6290  35.3%     -   38s
     0     0 52405.0093    0  375 38738.8525 52405.0093  35.3%     -   38s
     0     0 52404.1271    0  378 38738.8525 52404.1271  35.3%     -   38s
     0     0 52389.4780    0  382 38738.8525 52389.4780  35.2%     -   39s
     0     0 52384.4954    0  381 38738.8525 52384.4954  35.2%     -   41s
     0     0 52382.0409    0  384 38738.8525 52382.0409  35.2%     -   41s
     0     0 52380.3986    0  384 38738.8525 52380.3986  35.2%     -   41s
     0     0 52379.4875    0  380 38738.8525 52379.4875  35.2%     -   41s
     0     0 52336.3791    0  370 38738.8525 52336.3791  35.1%     -   42s
     0     0 52309.6615    0  372 38738.8525 52309.6615  35.0%     -   42s
     0     0 52307.0177    0  377 38738.8525 52307.0177  35.0%     -   43s
     0     0 52306.4964    0  379 38738.8525 52306.4964  35.0%     -   43s
     0     0 52292.5916    0  384 38738.8525 52292.5916  35.0%     -   44s
     0     0 52290.7177    0  412 38738.8525 52290.7177  35.0%     -   44s
     0     0 52288.7272    0  394 38738.8525 52288.7272  35.0%     -   44s
     0     0 52287.7642    0  391 38738.8525 52287.7642  35.0%     -   44s
     0     0 52277.0308    0  383 38738.8525 52277.0308  34.9%     -   45s
     0     0 52271.4158    0  372 38738.8525 52271.4158  34.9%     -   45s
     0     0 52270.6869    0  412 38738.8525 52270.6869  34.9%     -   45s
     0     0 52256.7117    0  378 38738.8525 52256.7117  34.9%     -   46s
     0     0 52253.5330    0  383 38738.8525 52253.5330  34.9%     -   46s
     0     0 52252.8700    0  382 38738.8525 52252.8700  34.9%     -   46s
     0     0 52239.4357    0  377 38738.8525 52239.4357  34.9%     -   47s
     0     0 52237.3919    0  381 38738.8525 52237.3919  34.8%     -   47s
     0     0 52236.7170    0  384 38738.8525 52236.7170  34.8%     -   47s
     0     0 52234.5803    0  383 38738.8525 52234.5803  34.8%     -   48s
     0     0 52232.5470    0  381 38738.8525 52232.5470  34.8%     -   48s
     0     0 52231.5592    0  378 38738.8525 52231.5592  34.8%     -   48s
     0     0 52214.1824    0  378 38738.8525 52214.1824  34.8%     -   49s
     0     0 52211.4498    0  386 38738.8525 52211.4498  34.8%     -   49s
     0     0 52211.1955    0  386 38738.8525 52211.1955  34.8%     -   49s
     0     0 52210.0163    0  383 38738.8525 52210.0163  34.8%     -   50s
     0     0 52207.7551    0  384 38738.8525 52207.7551  34.8%     -   50s
     0     0 52206.1636    0  380 38738.8525 52206.1636  34.8%     -   50s
     0     0 52205.0331    0  382 38738.8525 52205.0331  34.8%     -   51s
     0     0 52204.7322    0  384 38738.8525 52204.7322  34.8%     -   51s
     0     0 52203.0579    0  384 38738.8525 52203.0579  34.8%     -   51s
     0     2 52203.0579    0  384 38738.8525 52203.0579  34.8%     -   58s
     3     8 52019.6294    2  356 38738.8525 52164.5457  34.7%  2393   60s
    15    32 51753.5312    4  359 38738.8525 51919.8179  34.0%  3784   66s
    31    57 51446.4952    5  351 38738.8525 51809.5112  33.7%  5857   79s
    56    89 49492.8618    6  390 38738.8525 51809.5112  33.7%  5774   88s
    88   246 49335.9847    7  345 38738.8525 51809.5112  33.7%  5055   92s
   245   287 48793.7355   11  308 38738.8525 51809.5112  33.7%  2615   95s
   332   385 48763.9797   12  334 38738.8525 51809.5112  33.7%  2439  101s
   448   489 48060.6162   13  312 38738.8525 51809.5112  33.7%  2267  107s
   592   645 48747.0391   12  346 38738.8525 51809.5112  33.7%  1959  110s
   766   811 47882.7374   14  350 38738.8525 51809.5112  33.7%  1686  115s
   941   938 48144.1217   15  331 38738.8525 51809.5112  33.7%  1513  120s
  1056  1018 48175.9126   14  327 38738.8525 51750.2071  33.6%  1481  128s
  1113  1059 48054.1364   14  310 38738.8525 51750.2071  33.6%  1478  132s
  1192  1088 47293.0452   14  289 38738.8525 51750.2071  33.6%  1457  136s
  1290  1160 46578.8751   16  265 38738.8525 51741.6720  33.6%  1469  141s
  1406  1287 47496.5917   20  331 38738.8525 51741.6720  33.6%  1434  147s
  1593  1438 47553.6438   20  333 38738.8525 51741.6720  33.6%  1375  152s
  1694  1524 46426.8080   21  263 38738.8525 51670.2416  33.4%  1367  156s
  1824  1605 45725.7749   21  336 38738.8525 51199.9179  32.2%  1357  160s
  2076  1718 45011.1600   22  287 38738.8525 51199.9179  32.2%  1337  168s
  2155  1805 45462.5348   23  327 38738.8525 51199.9179  32.2%  1361  172s
  2284  1961 45724.1782   24  368 38738.8525 51199.9179  32.2%  1353  175s
  2668  2236 44372.3872   30  262 38738.8525 51199.9179  32.2%  1274  183s
  2859  2379 44063.3208   33  205 38738.8525 50919.9364  31.4%  1251  187s
  3052  2489 43503.5431   38  186 38738.8525 50897.9476  31.4%  1237  193s
  3217  2519 39496.5403   39  136 38738.8525 50810.6606  31.2%  1240  196s
  3251  2552 42227.3875   37  189 38738.8525 50810.6606  31.2%  1249  200s
  3288  2590 43106.3933   39  196 38738.8525 50810.6606  31.2%  1268  205s
  3460  2734 42641.4836   40  191 38738.8525 50067.1024  29.2%  1280  213s
  3618  2807 41195.4123   40  206 38738.8525 49993.6093  29.1%  1266  219s
  3751  2932 41027.0714   41  183 38738.8525 49993.6093  29.1%  1263  224s
  3949  2933 41961.0299   26  384 38738.8525 49993.6093  29.1%  1246  237s
  3951  2934 44704.4229   19  131 38738.8525 49993.6093  29.1%  1246  243s
  3952  2935 40147.5416   32  298 38738.8525 49993.6093  29.1%  1246  248s
  3953  2936 41843.0970   38  325 38738.8525 49993.6093  29.1%  1245  251s
  3955  2937 45006.8766   17  356 38738.8525 49993.6093  29.1%  1245  255s
  3959  2940 41191.8863   38  377 38738.8525 49993.6093  29.1%  1243  260s
  3964  2943 40974.9538   23  380 38738.8525 49993.6093  29.1%  1242  265s
  3968  2946 46356.4922   17  369 38738.8525 49993.6093  29.1%  1241  270s
  3974  2950 46901.0583   21  375 38738.8525 49993.6093  29.1%  1239  275s
  3977  2952 41881.0778   21  375 38738.8525 49993.6093  29.1%  1238  284s
  3978  2952 44450.0750   26  375 38738.8525 49993.6093  29.1%  1237  289s
  3979  2956 49993.6093   15  400 38738.8525 49993.6093  29.1%  1257  294s
  3981  2959 49993.6093   16  398 38738.8525 49993.6093  29.1%  1258  299s
  3985  2966 49993.6093   17  387 38738.8525 49993.6093  29.1%  1262  303s
  3993  2979 49993.6093   18  439 38738.8525 49993.6093  29.1%  1267  309s
  4009  2998 47946.6386   19  335 38738.8525 49993.6093  29.1%  1287  318s
  4033  3022 48699.3731   20  287 38738.8525 49993.6093  29.1%  1322  322s
  4065  3076 46188.5374   21  251 38738.8525 49993.6093  29.1%  1345  327s
  4138  3099 46005.8838   22  311 38738.8525 49993.6093  29.1%  1381  332s
  4223  3102 44899.5568   23  278 38738.8525 49993.6093  29.1%  1396  338s
  4300  3107 43111.2860   23  219 38738.8525 49993.6093  29.1%  1406  343s
  4367  3087 40435.4557   23  246 38738.8525 49993.6093  29.1%  1416  347s
  4442  3085 41128.6433   24  312 38738.8525 49164.2109  26.9%  1423  353s
  4502  3097 43850.6880   25  235 38738.8525 48816.2778  26.0%  1437  357s
  4561  3108     cutoff   27      38738.8525 48685.4390  25.7%  1447  362s
  4614  3113 40679.5696   28  246 38738.8525 48288.2016  24.7%  1457  367s
  4674  3117 39312.2449   28  261 38738.8525 48288.2016  24.7%  1468  373s
  4732  3137 40519.8474   29  238 38738.8525 48288.2016  24.7%  1476  376s
  4787  3138 38959.0389   31  200 38738.8525 48230.9570  24.5%  1487  382s
  4826  3146 39094.3389   29  237 38738.8525 48230.9570  24.5%  1496  386s
  4882  3148 39890.0125   30  248 38738.8525 48230.9570  24.5%  1504  390s
  5005  3146 39440.6616   32  227 38738.8525 47320.3004  22.2%  1521  400s
  5107  3140 43415.8746   21  242 38738.8525 47160.3652  21.7%  1530  408s
  5149  3142 42441.4945   22  256 38738.8525 47035.0190  21.4%  1531  411s
  5202  3146 42300.0072   23  280 38738.8525 47035.0190  21.4%  1533  416s
  5263  3144 40932.9644   24  186 38738.8525 47024.7304  21.4%  1534  421s
  5334  3139 40000.3786   25  191 38738.8525 47024.7304  21.4%  1538  426s
  5405  3123 39925.3864   26  175 38738.8525 47024.7304  21.4%  1541  430s
  5468  3119 39682.7038   27  150 38738.8525 46597.3848  20.3%  1542  436s
  5572  3135 41940.1815   21  204 38738.8525 46232.2205  19.3%  1545  440s
  5668  3110 39314.5741   22  197 38738.8525 46232.2205  19.3%  1550  445s
  5809  3083     cutoff   26      38738.8525 46148.5931  19.1%  1550  452s
  5940  3048 infeasible   24      38738.8525 45970.4571  18.7%  1557  458s
  6028  3019 41695.1722   24  278 38738.8525 45904.6279  18.5%  1562  464s
  6153  3015 40679.2854   25  289 38738.8525 45904.6279  18.5%  1568  470s
  6273  2989 39289.5001   26  215 38738.8525 45904.6279  18.5%  1573  477s
  6424  2970     cutoff   28      38738.8525 45267.7466  16.9%  1578  483s
  6582  2931     cutoff   30      38738.8525 45201.8622  16.7%  1582  490s
  6762  2878     cutoff   24      38738.8525 44903.3128  15.9%  1584  497s
  6952  2821 40215.9537   25  306 38738.8525 44903.3128  15.9%  1587  503s
  7131  2790     cutoff   25      38738.8525 44708.4683  15.4%  1593  511s
  7311  2742 39524.1985   25  224 38738.8525 44256.8175  14.2%  1602  518s
  7459  2722 38847.2110   28  229 38738.8525 44211.8225  14.1%  1604  526s
  7669  2685 39841.4213   27  240 38738.8525 44103.5995  13.8%  1606  533s
  7898  2615 38924.5381   28  233 38738.8525 44103.5995  13.8%  1606  541s
  8148  2530 39598.0674   26  232 38738.8525 43661.3698  12.7%  1610  549s
  8411  2436     cutoff   27      38738.8525 43384.5941  12.0%  1610  557s
  8663  2358 39026.2728   32  207 38738.8525 43088.9724  11.2%  1616  565s
  8871  2272     cutoff   28      38738.8525 43088.9724  11.2%  1619  577s
  8976  2216 40224.2400   30  275 38738.8525 43088.9724  11.2%  1618  585s
  9186  2111     cutoff   31      38738.8525 42906.3096  10.8%  1617  596s
  9542  1921     cutoff   29      38738.8525 42522.7734  9.77%  1613  605s
  9917  1763     cutoff   27      38738.8525 42144.1931  8.79%  1609  615s
 10227  1586     cutoff   26      38738.8525 42144.1931  8.79%  1605  624s
 10669  1294 39344.5240   24  175 38738.8525 41627.4572  7.46%  1596  635s
 11153   858 39157.6853   28  298 38738.8525 41315.0055  6.65%  1584  645s
 11738   376     cutoff   28      38738.8525 40852.0468  5.45%  1560  653s
 12216   206     cutoff   27      38738.8525 40202.5185  3.78%  1525  655s

Cutting planes:
  MIR: 276
  Flow cover: 656
  RLT: 14
  Relax-and-lift: 53

Explored 12230 nodes (18737931 simplex iterations) in 655.46 seconds (1991.24 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: 38738.9 38567.1 38401.3 ... 27574.1

Optimal solution found (tolerance 1.00e-04)
Best objective 3.873885245935e+04, best bound 3.873885245935e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 655.48s
  Master Objective (UB) = 38738.85, θ = 191065.77
  Upper Bound (UB) = 38738.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191065.77
  [DEBUG]   ✓ Scenario 0: θ = 191065.77 ≤ Q = 191065.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191065.77 ≤ Q = 191065.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191065.77 ≤ Q = 191065.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 191065.77 ≤ Q = 191065.77 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4ab109dd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4ab109dd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.392367e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6835000.8196
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.642381e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164238.10    0  129 6835000.82 -164238.10   102%     -    0s
H    0     0                    -128380.1843 -164238.10  27.9%     -    0s
H    0     0                    -128779.9807 -164238.10  27.5%     -    0s
H    0     0                    -129790.0617 -164238.10  26.5%     -    0s
H    0     0                    -136439.7115 -164238.10  20.4%     -    0s
     0     0 -145481.29    0   93 -136439.71 -145481.29  6.63%     -    0s
H    0     0                    -141635.7753 -145351.88  2.62%     -    0s
     0     0 -145056.43    0   96 -141635.78 -145056.43  2.42%     -    0s
     0     0 -145049.83    0   96 -141635.78 -145049.83  2.41%     -    0s
     0     0 -144055.60    0   89 -141635.78 -144055.60  1.71%     -    0s
H    0     0                    -142388.6638 -143982.30  1.12%     -    0s
     0     0 -143885.73    0   89 -142388.66 -143885.73  1.05%     -    0s
     0     0 -143567.32    0   72 -142388.66 -143567.32  0.83%     -    0s
     0     0 -143557.54    0   72 -142388.66 -143557.54  0.82%     -    0s
     0     0 -143036.61    0   68 -142388.66 -143036.61  0.46%     -    0s
     0     0 -143032.79    0   69 -142388.66 -143032.79  0.45%     -    0s
     0     0 -142834.70    0   52 -142388.66 -142834.70  0.31%     -    0s
     0     0 -142762.27    0   54 -142388.66 -142762.27  0.26%     -    0s
     0     0 -142740.46    0   55 -142388.66 -142740.46  0.25%     -    0s
     0     0 -142639.72    0   52 -142388.66 -142639.72  0.18%     -    0s
     0     0 -142631.57    0   52 -142388.66 -142631.57  0.17%     -    0s
H    0     0                    -142400.4575 -142622.41  0.16%     -    0s
H    0     0                    -142463.1624 -142622.41  0.11%     -    0s
     0     0 -142622.41    0   64 -142463.16 -142622.41  0.11%     -    0s
     0     0 -142622.41    0   64 -142463.16 -142622.41  0.11%     -    0s
     0     0 -142622.41    0   43 -142463.16 -142622.41  0.11%     -    0s
H    0     0                    -142471.5887 -142622.41  0.11%     -    0s
     0     0 -142586.41    0   44 -142471.59 -142586.41  0.08%     -    0s
     0     0 -142571.35    0   42 -142471.59 -142571.35  0.07%     -    0s
     0     0 -142541.94    0   12 -142471.59 -142541.94  0.05%     -    0s
     0     0 -142491.63    0    3 -142471.59 -142491.63  0.01%     -    0s
     0     0 -142491.28    0    2 -142471.59 -142491.28  0.01%     -    0s
H    0     0                    -142491.2629 -142491.28  0.00%     -    0s

Explored 1 nodes (1033 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -142491 -142472 -142463 ... -128780

Optimal solution found (tolerance 1.00e-04)
Best objective -1.424912629459e+05, best bound -1.424912848788e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 178650.77
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142491.26
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -142491.26 = 178650.77
  [DEBUG]   Current θ from Master = 191065.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12415.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26323.85
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 10270.7679, Absolute Gap = 10270.7679, Relative Gap = 0.265128
  Not converged yet (gap = 10270.77 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x177323b2
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 0.66s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33358    1.2331893e+04   0.000000e+00   4.555697e+06      5s
Concurrent spin time: 0.49s

Solved with dual simplex

Root relaxation: objective 6.454895e+04, 28177 iterations, 8.37 seconds (17.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64548.9499    0  127 -170340.08 64548.9499   138%     -    9s
H    0     0                    -161203.3818 64548.9499   140%     -    9s
H    0     0                    -160298.5806 64548.9499   140%     -    9s
H    0     0                    -159375.9895 64548.9499   141%     -    9s
H    0     0                    -159170.6680 64548.9499   141%     -    9s
H    0     0                    -158734.8759 64548.9499   141%     -    9s
H    0     0                    -23536.93476 64548.9499   374%     -    9s
H    0     0                    7261.4186102 64548.9499   789%     -    9s
H    0     0                    9746.5959226 64548.9499   562%     -    9s
H    0     0                    10172.825128 64548.9499   535%     -    9s
H    0     0                    10653.582974 64548.9499   506%     -    9s
H    0     0                    10680.590635 64548.9499   504%     -    9s
H    0     0                    12021.889509 64548.9499   437%     -    9s
H    0     0                    12177.489145 64548.9499   430%     -    9s
H    0     0                    13050.733444 64548.9499   395%     -    9s
H    0     0                    14464.503225 64548.9499   346%     -    9s
H    0     0                    14858.820990 64548.9499   334%     -   10s
H    0     0                    16163.277675 64548.9499   299%     -   10s
     0     0 59507.4333    0  180 16163.2777 59507.4333   268%     -   14s
H    0     0                    16454.068194 59507.4333   262%     -   14s
H    0     0                    18472.780243 59507.4333   222%     -   15s
H    0     0                    19176.745864 59507.4333   210%     -   15s
H    0     0                    19179.841267 59507.4333   210%     -   15s
H    0     0                    19879.699944 59507.4333   199%     -   15s
H    0     0                    20042.077892 59507.4333   197%     -   15s
H    0     0                    20048.002675 59507.4333   197%     -   15s
H    0     0                    20066.028931 59507.4333   197%     -   15s
H    0     0                    20075.296218 59507.4333   196%     -   15s
     0     0 59383.2379    0  184 20075.2962 59383.2379   196%     -   17s
     0     0 59383.2379    0  188 20075.2962 59383.2379   196%     -   17s
     0     0 59383.2379    0  184 20075.2962 59383.2379   196%     -   18s
     0     0 59383.2379    0  186 20075.2962 59383.2379   196%     -   18s
     0     0 59383.2379    0  193 20075.2962 59383.2379   196%     -   19s
     0     0 59383.2379    0  192 20075.2962 59383.2379   196%     -   19s
     0     0 59383.2379    0  190 20075.2962 59383.2379   196%     -   19s
     0     0 56916.5271    0  235 20075.2962 56916.5271   184%     -   24s
H    0     0                    24718.674155 56916.5271   130%     -   25s
H    0     0                    26209.658279 56916.5271   117%     -   25s
H    0     0                    26904.956050 56916.5271   112%     -   25s
H    0     0                    26956.921824 56916.5271   111%     -   25s
     0     0 56228.5441    0  253 26956.9218 56228.5441   109%     -   28s
     0     0 55946.1945    0  261 26956.9218 55946.1945   108%     -   30s
     0     0 55850.9077    0  288 26956.9218 55850.9077   107%     -   31s
     0     0 55821.9442    0  288 26956.9218 55821.9442   107%     -   31s
     0     0 55804.5899    0  295 26956.9218 55804.5899   107%     -   31s
     0     0 55803.7612    0  267 26956.9218 55803.7612   107%     -   31s
     0     0 55802.7043    0  269 26956.9218 55802.7043   107%     -   31s
     0     0 55802.5324    0  294 26956.9218 55802.5324   107%     -   32s
     0     0 54798.6948    0  308 26956.9218 54798.6948   103%     -   39s
H    0     0                    27341.454463 54798.6126   100%     -   39s
H    0     0                    27873.688702 54798.6126  96.6%     -   39s
H    0     0                    27941.771097 54798.6126  96.1%     -   39s
     0     0 54242.4813    0  303 27941.7711 54242.4813  94.1%     -   41s
     0     0 54067.9835    0  323 27941.7711 54067.9835  93.5%     -   44s
     0     0 53969.6043    0  346 27941.7711 53969.6043  93.2%     -   45s
     0     0 53921.6193    0  328 27941.7711 53921.6193  93.0%     -   46s
     0     0 53875.0036    0  329 27941.7711 53875.0036  92.8%     -   47s
     0     0 53853.8768    0  325 27941.7711 53853.8768  92.7%     -   48s
     0     0 53834.3688    0  336 27941.7711 53834.3688  92.7%     -   48s
     0     0 53828.2950    0  340 27941.7711 53828.2950  92.6%     -   49s
     0     0 53827.0155    0  340 27941.7711 53827.0155  92.6%     -   49s
     0     0 53826.3509    0  332 27941.7711 53826.3509  92.6%     -   49s
     0     0 53158.3302    0  351 27941.7711 53158.3302  90.2%     -   56s
     0     0 52925.0042    0  343 27941.7711 52925.0042  89.4%     -   58s
     0     0 52817.4836    0  354 27941.7711 52817.4836  89.0%     -   59s
     0     0 52739.9693    0  360 27941.7711 52739.9693  88.7%     -   60s
     0     0 52659.0907    0  361 27941.7711 52659.0907  88.5%     -   62s
     0     0 52615.5541    0  362 27941.7711 52615.5541  88.3%     -   63s
     0     0 52597.9536    0  360 27941.7711 52597.9536  88.2%     -   63s
     0     0 52589.0942    0  358 27941.7711 52589.0942  88.2%     -   63s
     0     0 52577.2831    0  366 27941.7711 52577.2831  88.2%     -   64s
     0     0 52573.3630    0  370 27941.7711 52573.3630  88.2%     -   64s
     0     0 52572.5084    0  368 27941.7711 52572.5084  88.2%     -   64s
     0     0 52452.8787    0  359 27941.7711 52452.8787  87.7%     -   66s
     0     0 52417.8782    0  366 27941.7711 52417.8782  87.6%     -   67s
     0     0 52409.1618    0  374 27941.7711 52409.1618  87.6%     -   67s
     0     0 52399.5162    0  379 27941.7711 52399.5162  87.5%     -   67s
     0     0 52396.5672    0  380 27941.7711 52396.5672  87.5%     -   67s
     0     0 52394.3493    0  379 27941.7711 52394.3493  87.5%     -   68s
     0     0 52392.6101    0  379 27941.7711 52392.6101  87.5%     -   68s
     0     0 52390.2841    0  382 27941.7711 52390.2841  87.5%     -   68s
     0     0 52387.4863    0  381 27941.7711 52387.4863  87.5%     -   68s
     0     0 52387.2780    0  380 27941.7711 52387.2780  87.5%     -   68s
     0     0 52364.0293    0  378 27941.7711 52364.0293  87.4%     -   69s
     0     0 52349.6965    0  377 27941.7711 52349.6965  87.4%     -   70s
     0     0 52348.1671    0  377 27941.7711 52348.1671  87.3%     -   70s
     0     0 52347.5848    0  384 27941.7711 52347.5848  87.3%     -   71s
     0     0 52325.5918    0  382 27941.7711 52325.5918  87.3%     -   71s
     0     0 52322.5973    0  371 27941.7711 52322.5973  87.3%     -   72s
     0     0 52321.5254    0  374 27941.7711 52321.5254  87.3%     -   72s
     0     0 52298.0125    0  372 27941.7711 52298.0125  87.2%     -   73s
     0     0 52277.4314    0  379 27941.7711 52277.4314  87.1%     -   75s
     0     0 52272.5465    0  384 27941.7711 52272.5465  87.1%     -   75s
     0     0 52271.4799    0  375 27941.7711 52271.4799  87.1%     -   75s
     0     0 52253.1753    0  377 27941.7711 52253.1753  87.0%     -   77s
     0     0 52248.4600    0  382 27941.7711 52248.4600  87.0%     -   77s
     0     0 52246.9892    0  384 27941.7711 52246.9892  87.0%     -   78s
     0     0 52241.9234    0  387 27941.7711 52241.9234  87.0%     -   78s
H    0     0                    28038.242477 52241.2950  86.3%     -   79s
     0     0 52238.7305    0  389 28038.2425 52238.7305  86.3%     -   79s
     0     0 52236.9861    0  396 28038.2425 52236.9861  86.3%     -   80s
     0     0 52236.7197    0  396 28038.2425 52236.7197  86.3%     -   80s
     0     0 52231.1190    0  388 28038.2425 52231.1190  86.3%     -   81s
     0     0 52228.8020    0  384 28038.2425 52228.8020  86.3%     -   81s
     0     0 52228.2553    0  385 28038.2425 52228.2553  86.3%     -   82s
     0     0 52226.6220    0  385 28038.2425 52226.6220  86.3%     -   82s
     0     0 52226.5176    0  385 28038.2425 52226.5176  86.3%     -   82s
H    0     0                    28060.836358 52226.5176  86.1%     -   94s
H    0     0                    28271.875076 52226.5176  84.7%     -   96s
H    0     0                    28663.539503 52226.5176  82.2%     -   96s
H    0     0                    29178.909636 52226.5176  79.0%     -   96s
     0     2 52226.5176    0  385 29178.9096 52226.5176  79.0%     -   96s
     3     8 51743.4521    2  370 29178.9096 52120.6093  78.6%  2665  101s
     7    16 51665.8738    3  376 29178.9096 51738.3331  77.3%  3968  106s
    15    32 51275.9961    4  385 29178.9096 51662.8321  77.1%  5524  112s
    31    51 50321.2679    5  400 29178.9096 51275.8107  75.7%  6692  123s
H   50    83                    29199.095130 51275.8107  75.6%  6616  129s
    82   188 49954.2437    7  373 29199.0951 51275.8107  75.6%  5645  136s
   187   301 49849.4299    9  373 29199.0951 51275.8107  75.6%  3620  141s
   300   391 49782.8277   11  366 29199.0951 51275.8107  75.6%  2868  146s
   422   460 49751.3303   10  332 29199.0951 51275.8107  75.6%  2635  153s
   459   491 47962.7338   11  353 29199.0951 51275.8107  75.6%  2616  156s
   492   521 49696.0842   12  370 29199.0951 51275.8107  75.6%  2617  161s
   524   553 49678.0030   12  361 29199.0951 51275.8107  75.6%  2700  165s
H  559   553                    29693.754654 51275.8107  72.7%  2648  165s
   669   756 47446.3573   11  320 29693.7547 51275.8107  72.7%  2412  173s
   773   846 47940.8014   13  329 29693.7547 51275.8107  72.7%  2219  178s
   875   920 46977.4837   13  360 29693.7547 51231.6234  72.5%  2087  183s
   967  1004 47885.9719   13  324 29693.7547 51167.9188  72.3%  2025  189s
  1069  1056 47149.6381   13  350 29693.7547 51167.9188  72.3%  1945  194s
H 1070  1056                    31423.779138 51167.9188  62.8%  1943  194s
  1143  1128 45407.9989   12  339 31423.7791 51167.9188  62.8%  1896  201s
  1263  1197 45926.7155   12  322 31423.7791 51167.9188  62.8%  1817  207s
  1357  1270 47670.5505   14  321 31423.7791 51016.6818  62.4%  1797  213s
  1468  1315 43149.3749   14  324 31423.7791 51016.6818  62.4%  1776  219s
  1548  1377 46333.0436   14  383 31423.7791 51016.6818  62.4%  1799  224s
  1628  1447 47639.7719   14  324 31423.7791 51016.6818  62.4%  1816  229s
  1714  1520 43292.1252   14  368 31423.7791 50752.8637  61.5%  1834  235s
  1811  1624 44194.9224   14  361 31423.7791 50752.8637  61.5%  1835  241s
  1931  1719 47629.7460   15  348 31423.7791 50752.8637  61.5%  1825  248s
H 2080  1745                    32241.557789 50752.8637  57.4%  1791  252s
H 2094  1745                    32333.466855 50752.8637  57.0%  1802  252s
H 2098  1745                    32600.117635 50752.8637  55.7%  1803  252s
H 2116  1745                    32611.987894 50752.8637  55.6%  1804  252s
  2118  1858 45142.3443   17  316 32611.9879 50752.8637  55.6%  1806  258s
  2265  1906 39775.3347   18  274 32611.9879 50752.8637  55.6%  1778  266s
  2416  1994 35383.7261   16  268 32611.9879 50752.8637  55.6%  1764  271s
  2538  2096 40993.8091   20  202 32611.9879 50752.8637  55.6%  1766  278s
  2670  2199 39865.9467   22  190 32611.9879 50393.2335  54.5%  1776  285s
  2811  2228 33990.7892   22  209 32611.9879 49749.4073  52.5%  1775  292s
H 2813  2221                    32867.818318 49749.4073  51.4%  1774  292s
H 2815  2221                    32872.856906 49749.4073  51.3%  1776  292s
H 2816  2199                    33397.199803 49749.4073  49.0%  1776  292s
  2846  2356 38124.7647   22  195 33397.1998 49678.7863  48.8%  1785  299s
  3094  2580 34365.3865   20  208 33397.1998 49644.4609  48.6%  1725  306s
  3384  2747 34148.7415   21  194 33397.1998 49552.1059  48.4%  1649  312s
* 3434  2727              73    33588.971335 49552.1059  47.5%  1637  312s
* 3451  2456              63    35122.500295 49552.1059  41.1%  1629  312s
H 3637  2362                    35283.364940 49552.1059  40.4%  1611  328s
H 3637  2357                    35319.873180 49552.1059  40.3%  1611  328s
  3638  2332 37295.8882   24  385 35319.8732 49552.1059  40.3%  1610  360s
  3640  2333 37122.3173   29  127 35319.8732 49552.1059  40.3%  1609  372s
  3641  2334 40760.3780   23  285 35319.8732 49552.1059  40.3%  1609  382s
  3642  2335 47505.0991   12  280 35319.8732 49552.1059  40.3%  1609  387s
  3643  2335 43190.9277   15  380 35319.8732 49552.1059  40.3%  1608  391s
  3645  2337 37715.5105   54  366 35319.8732 49552.1059  40.3%  1607  396s
  3647  2338 38457.5672   51  376 35319.8732 49552.1059  40.3%  1606  400s
  3651  2341 36323.3191   39  390 35319.8732 49552.1059  40.3%  1605  406s
  3655  2343 36973.3465   38  414 35319.8732 49552.1059  40.3%  1603  411s
  3658  2345 38170.2392   22  425 35319.8732 49552.1059  40.3%  1602  415s
  3662  2348 38688.5171   29  381 35319.8732 49552.1059  40.3%  1600  421s
  3664  2349 48852.6757   11  417 35319.8732 49552.1059  40.3%  1599  426s
  3667  2351 38831.5623   31  423 35319.8732 49552.1059  40.3%  1598  430s
  3670  2353 47897.2062   13  382 35319.8732 49552.1059  40.3%  1596  435s
  3672  2355 35711.1218   59  382 35319.8732 49552.1059  40.3%  1595  448s
  3673  2355 46121.6478   19  382 35319.8732 49552.1059  40.3%  1595  460s
  3674  2359 49552.1059   16  365 35319.8732 49552.1059  40.3%  1630  467s
  3676  2362 49552.1059   17  358 35319.8732 49552.1059  40.3%  1633  476s
  3680  2369 49552.1059   18  349 35319.8732 49552.1059  40.3%  1636  486s
  3688  2382 49552.1059   19  357 35319.8732 49552.1059  40.3%  1644  492s
  3704  2406 49552.1059   20  355 35319.8732 49552.1059  40.3%  1689  506s
  3733  2428 47483.3536   21  403 35319.8732 49552.1059  40.3%  1742  516s
  3765  2493 47167.1598   22  388 35319.8732 49552.1059  40.3%  1786  526s
H 3771  2372                    35352.442114 49552.1059  40.2%  1792  526s
H 3813  2246                    35774.833367 49552.1059  38.5%  1833  526s
  3840  2296 45089.3863   24  318 35774.8334 49552.1059  38.5%  1844  536s
  3910  2324 44468.7371   24  323 35774.8334 49552.1059  38.5%  1884  545s
H 3915  2216                    36118.302391 49552.1059  37.2%  1886  545s
H 3945  2104                    36199.619749 49552.1059  36.9%  1905  545s
H 3947  2007                    36667.134394 49552.1059  35.1%  1906  545s
  3985  2039 43556.8920   26  271 36667.1344 49552.1059  35.1%  1911  553s
  4062  2060 40888.3506   27  262 36667.1344 49552.1059  35.1%  1941  560s
H 4077  1963                    36770.889526 49552.1059  34.8%  1944  560s
H 4084  1873                    37005.842128 49552.1059  33.9%  1946  560s
H 4091  1789                    37473.695913 49552.1059  32.2%  1950  560s
  4139  1806 41729.3593   30  194 37473.6959 49552.1059  32.2%  1957  569s
  4220  1799 40925.3811   33  230 37473.6959 49552.1059  32.2%  1966  577s
H 4230  1717                    37847.746604 49552.1059  30.9%  1964  577s
H 4246  1637                    38015.563697 49552.1059  30.3%  1968  577s
H 4261  1561                    38392.866710 49552.1059  29.1%  1968  577s
  4293  1580 39557.4338   34  211 38392.8667 49552.1059  29.1%  1973  586s
  4358  1593 39247.4904   36  196 38392.8667 49007.9457  27.6%  1991  593s
  4405  1620     cutoff   40      38392.8667 48754.8369  27.0%  2011  601s
  4475  1621 44956.5690   22  363 38392.8667 48754.8369  27.0%  2020  607s
H 4478  1553                    38394.768658 48754.8369  27.0%  2021  607s
H 4481  1488                    38414.067382 48754.8369  26.9%  2020  607s
  4516  1493 43680.2731   23  285 38414.0674 48754.8369  26.9%  2032  615s
  4603  1485 42365.3251   24  316 38414.0674 48754.8369  26.9%  2029  622s
  4657  1494 40982.5295   25  274 38414.0674 48754.8369  26.9%  2039  629s
  4734  1484 40977.9274   26  281 38414.0674 48754.8369  26.9%  2044  637s
  4781  1476 40029.5738   27  214 38414.0674 47809.3213  24.5%  2050  642s
  4843  1469 39683.6147   30  155 38414.0674 47809.3213  24.5%  2052  649s
  4927  1466 39148.4519   32  147 38414.0674 47421.3016  23.4%  2054  657s
  5022  1451 44730.4271   22  404 38414.0674 47292.9183  23.1%  2066  664s
  5072  1462 43158.2095   23  338 38414.0674 47144.1326  22.7%  2074  673s
  5149  1467 41701.5698   24  291 38414.0674 47144.1326  22.7%  2080  683s
  5235  1478 41291.0503   25  287 38414.0674 47144.1326  22.7%  2085  692s
  5328  1480 41270.5300   26  255 38414.0674 47021.3406  22.4%  2089  701s
  5450  1476 39591.9332   30  176 38414.0674 47021.3406  22.4%  2092  711s
  5558  1479 41922.2176   23  283 38414.0674 46686.7829  21.5%  2107  720s
  5668  1457 42444.2220   23  292 38414.0674 46638.3636  21.4%  2122  729s
  5732  1469 41976.4606   24  290 38414.0674 46248.1807  20.4%  2131  738s
  5805  1467 40001.4145   25  283 38414.0674 46248.1807  20.4%  2143  746s
  5908  1444 38812.3996   26  296 38414.0674 46172.3246  20.2%  2154  757s
  6026  1436     cutoff   27      38414.0674 46172.3246  20.2%  2159  767s
  6171  1405 39817.7299   25  296 38414.0674 45749.0611  19.1%  2168  779s
  6339  1364 39161.3057   27  217 38414.0674 45749.0611  19.1%  2165  790s
  6490  1332 41227.9330   25  283 38414.0674 45643.7307  18.8%  2172  804s
  6656  1316     cutoff   28      38414.0674 45435.1135  18.3%  2181  816s
  6834  1292 41631.2818   26  272 38414.0674 45435.1135  18.3%  2188  829s
  7022  1250     cutoff   28      38414.0674 45106.0986  17.4%  2201  842s
  7240  1221 40895.5966   25  306 38414.0674 45002.5291  17.2%  2205  854s
  7473  1239 38900.5710   26  200 38414.0674 44515.3446  15.9%  2207  866s
  7745  1244 39835.6605   24  264 38414.0674 44485.7770  15.8%  2204  882s
  7998  1268 infeasible   25      38414.0674 44243.7494  15.2%  2209  896s
  8247  1305 39275.4114   27  267 38414.0674 44019.0217  14.6%  2219  910s
  8525  1340 38982.3482   31  195 38414.0674 43978.2873  14.5%  2225  924s
  8838  1370     cutoff   22      38414.0674 43790.2357  14.0%  2223  939s
  9067  1395 39764.7279   26  299 38414.0674 43564.9380  13.4%  2228  957s
  9397  1406 39819.5025   26  329 38414.0674 43464.4960  13.1%  2227  973s
  9729  1402 38920.7907   29  146 38414.0674 43239.5280  12.6%  2228  986s
  9795  1404     cutoff   30      38414.0674 43239.5280  12.6%  2231 1000s
  9858  1400     cutoff   29      38414.0674 43239.5280  12.6%  2234 1017s
 10001  1371     cutoff   29      38414.0674 42939.1751  11.8%  2234 1036s
 10344  1351     cutoff   27      38414.0674 42801.3704  11.4%  2231 1053s
 10700  1308     cutoff   31      38414.0674 42476.6468  10.6%  2241 1073s
 11136  1290     cutoff   28      38414.0674 42303.3390  10.1%  2239 1093s
 11587  1216 38976.5951   34  232 38414.0674 42092.3550  9.58%  2236 1115s
 12081  1140 39797.9387   32  311 38414.0674 41699.3263  8.55%  2231 1135s
 12620  1008 38533.5433   28  229 38414.0674 41489.3094  8.01%  2219 1155s
 13185   820     cutoff   31      38414.0674 41061.9531  6.89%  2209 1177s
 13761   496     cutoff   24      38414.0674 40682.5445  5.91%  2202 1197s
 14459    33     cutoff   28      38414.0674 40286.4944  4.87%  2171 1214s
 15131     0     cutoff   31      38414.0674 39576.9230  3.03%  2119 1215s

Cutting planes:
  Learned: 2
  MIR: 590
  Flow cover: 1213
  RLT: 26
  Relax-and-lift: 104

Explored 15195 nodes (32228403 simplex iterations) in 1215.86 seconds (3753.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 38414.1 38394.8 38392.9 ... 36199.6

Optimal solution found (tolerance 1.00e-04)
Best objective 3.841406738206e+04, best bound 3.841406738206e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1215.90s
  Master Objective (UB) = 38414.07, θ = 191323.77
  Upper Bound (UB) = 38414.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191323.77
  [DEBUG]   ✓ Scenario 0: θ = 191323.77 ≤ Q = 191323.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191323.77 ≤ Q = 191323.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191323.77 ≤ Q = 191323.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 191323.77 ≤ Q = 191323.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 191323.77 ≤ Q = 191323.77 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x21d73aee
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde28c512
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.388260e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6808425.8194
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.646860e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164686.01    0  133 6808425.82 -164686.01   102%     -    0s
H    0     0                    -128127.1967 -164686.01  28.5%     -    0s
H    0     0                    -128951.5410 -164686.01  27.7%     -    0s
H    0     0                    -132674.2415 -164686.01  24.1%     -    0s
     0     0 -147466.26    0   51 -132674.24 -147466.26  11.1%     -    0s
H    0     0                    -144540.3053 -147355.51  1.95%     -    0s
     0     0 -146338.63    0   51 -144540.31 -146338.63  1.24%     -    0s
     0     0 -146337.91    0   51 -144540.31 -146337.91  1.24%     -    0s
     0     0 -145955.32    0   17 -144540.31 -145955.32  0.98%     -    0s
H    0     0                    -145795.9735 -145955.32  0.11%     -    0s
     0     0 -145953.41    0   15 -145795.97 -145953.41  0.11%     -    0s
     0     0 -145953.41    0   14 -145795.97 -145953.41  0.11%     -    0s
     0     0 -145936.38    0    8 -145795.97 -145936.38  0.10%     -    0s
     0     0 -145934.56    0    9 -145795.97 -145934.56  0.10%     -    0s
     0     0 -145934.56    0   15 -145795.97 -145934.56  0.10%     -    0s
H    0     0                    -145829.9397 -145934.56  0.07%     -    0s
     0     0 -145922.56    0    5 -145829.94 -145922.56  0.06%     -    0s
H    0     0                    -145879.5192 -145919.23  0.03%     -    0s
H    0     0                    -145880.8774 -145919.23  0.03%     -    0s
     0     0 -145917.01    0    7 -145880.88 -145917.01  0.02%     -    0s
     0     0 -145906.35    0    6 -145880.88 -145906.35  0.02%     -    0s
     0     0 -145906.30    0    4 -145880.88 -145906.30  0.02%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 7
  Flow cover: 6
  RLT: 1
  Relax-and-lift: 2

Explored 1 nodes (645 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -145881 -145880 -145830 ... 6.80843e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.458808774135e+05, best bound -1.458943274932e+05, gap 0.0092%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 175261.15
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145880.88
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -145880.88 = 175261.15
  [DEBUG]   Current θ from Master = 191323.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16062.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22351.45
  Lower Bound (LB) = 28468.08
  Gap (UB-LB) = 9945.9828, Absolute Gap = 9945.9828, Relative Gap = 0.258915
  Not converged yet (gap = 9945.98 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0xb4e55873
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 0.80s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35802    2.7891220e+04   0.000000e+00   2.589312e+07      5s
   49756    3.8984686e+04   0.000000e+00   5.140781e+07     10s
Concurrent spin time: 0.65s

Solved with dual simplex

Root relaxation: objective 6.450941e+04, 37996 iterations, 12.27 seconds (25.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64509.4081    0  134 -170340.08 64509.4081   138%     -   13s
H    0     0                    -157000.5782 64509.4081   141%     -   13s
H    0     0                    -14875.94658 64509.4081   534%     -   13s
H    0     0                    10525.398425 64509.4081   513%     -   13s
H    0     0                    12773.292254 64509.4081   405%     -   14s
H    0     0                    13265.741698 64509.4081   386%     -   14s
H    0     0                    13365.149771 64509.4081   383%     -   14s
H    0     0                    13382.983282 64509.4081   382%     -   14s
H    0     0                    13876.913932 64509.4081   365%     -   14s
H    0     0                    16362.871424 64509.4081   294%     -   14s
H    0     0                    16856.802073 64509.4081   283%     -   14s
H    0     0                    17496.263791 59578.6710   241%     -   19s
H    0     0                    17615.503398 59578.6710   238%     -   19s
H    0     0                    17889.022802 59578.6710   233%     -   19s
H    0     0                    19067.275408 59578.6710   212%     -   19s
     0     0 59578.6710    0  204 19067.2754 59578.6710   212%     -   19s
H    0     0                    19280.424557 59578.6313   209%     -   19s
H    0     0                    19363.516587 59578.6313   208%     -   19s
H    0     0                    19375.565754 59578.6313   207%     -   19s
H    0     0                    19438.106544 59578.6313   207%     -   19s
     0     0 59080.6744    0  213 19438.1065 59080.6744   204%     -   21s
     0     0 59008.8625    0  213 19438.1065 59008.8625   204%     -   22s
     0     0 58857.2863    0  203 19438.1065 58857.2863   203%     -   23s
     0     0 58837.2470    0  211 19438.1065 58837.2470   203%     -   24s
     0     0 58816.0448    0  211 19438.1065 58816.0448   203%     -   24s
     0     0 58814.6071    0  216 19438.1065 58814.6071   203%     -   24s
     0     0 58814.6071    0  215 19438.1065 58814.6071   203%     -   24s
     0     0 58814.6071    0  215 19438.1065 58814.6071   203%     -   25s
H    0     0                    19640.423771 56532.4816   188%     -   32s
H    0     0                    19867.291908 56532.4816   185%     -   32s
     0     0 56532.4816    0  263 19867.2919 56532.4816   185%     -   32s
H    0     0                    22857.694063 56532.0303   147%     -   32s
     0     0 55994.3824    0  279 22857.6941 55994.3824   145%     -   35s
     0     0 55657.3194    0  283 22857.6941 55657.3194   143%     -   37s
     0     0 55535.7245    0  284 22857.6941 55535.7245   143%     -   39s
     0     0 55510.4959    0  285 22857.6941 55510.4959   143%     -   39s
     0     0 55479.5326    0  287 22857.6941 55479.5326   143%     -   40s
     0     0 55455.9679    0  282 22857.6941 55455.9679   143%     -   40s
     0     0 55420.0150    0  289 22857.6941 55420.0150   142%     -   41s
     0     0 55404.6407    0  291 22857.6941 55404.6407   142%     -   41s
     0     0 55396.8694    0  292 22857.6941 55396.8694   142%     -   42s
     0     0 55396.6271    0  292 22857.6941 55396.6271   142%     -   42s
H    0     0                    24254.801400 54164.4079   123%     -   51s
H    0     0                    24505.938637 54164.4079   121%     -   51s
H    0     0                    24622.958926 54164.4079   120%     -   51s
H    0     0                    24844.958213 54164.4079   118%     -   51s
     0     0 54164.4079    0  298 24844.9582 54164.4079   118%     -   51s
H    0     0                    24920.561976 54163.9170   117%     -   51s
H    0     0                    26100.721775 54163.9170   108%     -   51s
     0     0 53739.4799    0  324 26100.7218 53739.4799   106%     -   55s
     0     0 53622.3355    0  327 26100.7218 53622.3355   105%     -   57s
     0     0 53561.0168    0  334 26100.7218 53561.0168   105%     -   58s
     0     0 53498.7094    0  344 26100.7218 53498.7094   105%     -   60s
     0     0 53437.1747    0  340 26100.7218 53437.1747   105%     -   61s
H    0     0                    26735.507024 53389.7419   100%     -   62s
     0     0 53389.7419    0  341 26735.5070 53389.7419   100%     -   62s
     0     0 53353.2251    0  336 26735.5070 53353.2251   100%     -   63s
     0     0 53325.0735    0  342 26735.5070 53325.0735  99.5%     -   64s
     0     0 53311.9224    0  339 26735.5070 53311.9224  99.4%     -   65s
     0     0 53300.1066    0  348 26735.5070 53300.1066  99.4%     -   66s
     0     0 53288.0598    0  351 26735.5070 53288.0598  99.3%     -   67s
     0     0 53285.0071    0  352 26735.5070 53285.0071  99.3%     -   67s
     0     0 53274.0275    0  345 26735.5070 53274.0275  99.3%     -   68s
     0     0 53257.3552    0  337 26735.5070 53257.3552  99.2%     -   68s
     0     0 53253.6090    0  341 26735.5070 53253.6090  99.2%     -   68s
     0     0 53251.4849    0  347 26735.5070 53251.4849  99.2%     -   69s
     0     0 53251.0913    0  345 26735.5070 53251.0913  99.2%     -   69s
H    0     0                    28984.420977 52698.2279  81.8%     -   76s
H    0     0                    29078.829551 52698.2279  81.2%     -   76s
H    0     0                    29204.180037 52698.2279  80.4%     -   76s
     0     0 52698.2279    0  361 29204.1800 52698.2279  80.4%     -   76s
H    0     0                    29320.969617 52698.1965  79.7%     -   76s
H    0     0                    29324.386424 52698.1965  79.7%     -   77s
H    0     0                    29326.819390 52698.1965  79.7%     -   77s
H    0     0                    29410.148379 52698.1965  79.2%     -   77s
     0     0 52623.3494    0  371 29410.1484 52623.3494  78.9%     -   79s
     0     0 52598.2384    0  362 29410.1484 52598.2384  78.8%     -   80s
     0     0 52569.6508    0  369 29410.1484 52569.6508  78.7%     -   81s
     0     0 52510.5019    0  363 29410.1484 52510.5019  78.5%     -   83s
H    0     0                    33813.463764 52490.6557  55.2%     -   84s
H    0     0                    33819.968254 52490.6557  55.2%     -   84s
H    0     0                    34137.621699 52490.6557  53.8%     -   84s
     0     0 52490.6557    0  365 34137.6217 52490.6557  53.8%     -   84s
H    0     0                    34214.948177 52482.6357  53.4%     -   85s
H    0     0                    34222.729191 52482.6357  53.4%     -   85s
H    0     0                    34230.298421 52482.6357  53.3%     -   85s
     0     0 52482.6357    0  367 34230.2984 52482.6357  53.3%     -   85s
     0     0 52466.7007    0  370 34230.2984 52466.7007  53.3%     -   86s
     0     0 52453.0429    0  371 34230.2984 52453.0429  53.2%     -   86s
     0     0 52452.1050    0  369 34230.2984 52452.1050  53.2%     -   87s
     0     0 52345.5795    0  362 34230.2984 52345.5795  52.9%     -   90s
     0     0 52327.6850    0  370 34230.2984 52327.6850  52.9%     -   91s
     0     0 52325.2584    0  374 34230.2984 52325.2584  52.9%     -   91s
     0     0 52318.7323    0  374 34230.2984 52318.7323  52.8%     -   92s
     0     0 52316.9684    0  361 34230.2984 52316.9684  52.8%     -   92s
     0     0 52314.7427    0  373 34230.2984 52314.7427  52.8%     -   92s
     0     0 52312.3972    0  375 34230.2984 52312.3972  52.8%     -   93s
     0     0 52311.2503    0  379 34230.2984 52311.2503  52.8%     -   93s
     0     0 52277.7023    0  368 34230.2984 52277.7023  52.7%     -   94s
     0     0 52268.5364    0  382 34230.2984 52268.5364  52.7%     -   96s
     0     0 52266.9563    0  377 34230.2984 52266.9563  52.7%     -   96s
     0     0 52265.2244    0  376 34230.2984 52265.2244  52.7%     -   97s
     0     0 52264.7889    0  374 34230.2984 52264.7889  52.7%     -   97s
     0     0 52244.8734    0  376 34230.2984 52244.8734  52.6%     -   98s
     0     0 52234.8598    0  393 34230.2984 52234.8598  52.6%     -   99s
     0     0 52231.9380    0  423 34230.2984 52231.9380  52.6%     -   99s
     0     0 52229.5321    0  418 34230.2984 52229.5321  52.6%     -  100s
     0     0 52227.9749    0  378 34230.2984 52227.9749  52.6%     -  100s
     0     0 52227.3874    0  379 34230.2984 52227.3874  52.6%     -  100s
     0     0 52196.4550    0  427 34230.2984 52196.4550  52.5%     -  101s
H    0     0                    34233.267986 52196.2197  52.5%     -  102s
H    0     0                    34289.923529 52196.2197  52.2%     -  102s
H    0     0                    34345.558087 52196.2197  52.0%     -  102s
H    0     0                    34360.656928 52196.2197  51.9%     -  102s
     0     0 52190.4743    0  397 34360.6569 52190.4743  51.9%     -  103s
     0     0 52188.2993    0  432 34360.6569 52188.2993  51.9%     -  103s
     0     0 52187.2998    0  434 34360.6569 52187.2998  51.9%     -  104s
     0     0 52180.4750    0  386 34360.6569 52180.4750  51.9%     -  105s
     0     0 52163.3462    0  390 34360.6569 52163.3462  51.8%     -  105s
     0     0 52163.0327    0  437 34360.6569 52163.0327  51.8%     -  106s
     0     0 52136.0803    0  398 34360.6569 52136.0803  51.7%     -  107s
     0     0 52131.3150    0  396 34360.6569 52131.3150  51.7%     -  109s
     0     0 52129.8033    0  390 34360.6569 52129.8033  51.7%     -  109s
     0     0 52129.2485    0  403 34360.6569 52129.2485  51.7%     -  110s
     0     0 52127.1294    0  405 34360.6569 52127.1294  51.7%     -  111s
     0     0 52126.9341    0  393 34360.6569 52126.9341  51.7%     -  111s
     0     0 52125.1988    0  399 34360.6569 52125.1988  51.7%     -  112s
     0     0 52124.0771    0  399 34360.6569 52124.0771  51.7%     -  112s
     0     0 52122.3280    0  380 34360.6569 52122.3280  51.7%     -  113s
     0     0 52122.1995    0  380 34360.6569 52122.1995  51.7%     -  113s
     0     2 52121.9082    0  380 34360.6569 52121.9082  51.7%     -  133s
     1     4 52022.4076    1  375 34360.6569 52121.6709  51.7%  3831  136s
     3     8 51429.1470    2  377 34360.6569 52020.7875  51.4%  5316  142s
     7    16 51203.7621    3  321 34360.6569 51425.9995  49.7%  6018  148s
    15    32 50920.4067    4  385 34360.6569 51202.4424  49.0%  7006  154s
    31    51 49784.2729    5  351 34360.6569 50920.3253  48.2%  8606  169s
    50    83 49399.6759    6  377 34360.6569 50920.1733  48.2%  8275  177s
H   57    83                    34370.170971 50920.1733  48.2%  7752  177s
H   64    83                    34373.488483 50920.1733  48.1%  7556  177s
H   70    83                    34388.716827 50920.1733  48.1%  7169  177s
H   78    83                    34390.269935 50920.1733  48.1%  6657  177s
    82   187 48976.2953    7  346 34390.2699 50920.1733  48.1%  6471  189s
   186   292 48944.4899    9  334 34390.2699 50920.1733  48.1%  3817  197s
   291   370 48856.9244    9  363 34390.2699 50920.1733  48.1%  3345  205s
   373   402 48895.4297   10  329 34390.2699 50920.1733  48.1%  3084  210s
   405   435 48685.4098   10  364 34390.2699 50920.1733  48.1%  3002  215s
   441   462 48801.2008   10  344 34390.2699 50920.1733  48.1%  2980  221s
   479   494 47960.9779   10  378 34390.2699 50920.1733  48.1%  2945  226s
   514   528 48743.4899   11  333 34390.2699 50920.1733  48.1%  2901  231s
   554   567 48454.2611   11  360 34390.2699 50920.1733  48.1%  2869  235s
   593   604 48760.2853   11  308 34390.2699 50920.1733  48.1%  2811  241s
   632   643 48555.9828   12  302 34390.2699 50920.1733  48.1%  2773  248s
H  661   643                    34416.891528 50920.1733  48.0%  2732  248s
   675   719 48396.6924   13  318 34416.8915 50920.1733  48.0%  2717  255s
   771   789 47615.9560   15  271 34416.8915 50920.1733  48.0%  2562  261s
   872   861 46646.9834   15  277 34416.8915 50920.1733  48.0%  2464  268s
   952   960 47150.0409   14  243 34416.8915 50920.1733  48.0%  2414  275s
  1067  1070 47034.5272   16  221 34416.8915 50920.1733  48.0%  2279  282s
  1198  1195 46070.0801   17  292 34416.8915 50309.0185  46.2%  2167  287s
  1343  1271 46819.2271   17  310 34416.8915 50309.0185  46.2%  2045  294s
  1456  1334 46176.3466   17  220 34416.8915 50309.0185  46.2%  2010  301s
  1575  1386 45945.3327   18  367 34416.8915 50309.0185  46.2%  1983  309s
  1660  1459 42514.4871   18  234 34416.8915 50309.0185  46.2%  2020  318s
  1751  1516 44308.0289   18  229 34416.8915 50309.0185  46.2%  2040  326s
  1820  1580 43926.5025   18  272 34416.8915 50309.0185  46.2%  2051  334s
  1926  1667 43706.0282   19  326 34416.8915 50309.0185  46.2%  2056  341s
  2039  1771 43047.6393   19  322 34416.8915 50309.0185  46.2%  2058  348s
  2177  1899 41994.1518   19  226 34416.8915 50309.0185  46.2%  2032  355s
  2351  2004 43348.6379   20  293 34416.8915 50309.0185  46.2%  1990  363s
  2521  2108 42859.4385   21  229 34416.8915 49944.2601  45.1%  1962  371s
  2693  2206 42256.7325   23  286 34416.8915 49807.6537  44.7%  1947  380s
  2843  2322 42139.9396   24  274 34416.8915 49807.6537  44.7%  1952  390s
  2998  2436 39262.7120   27  259 34416.8915 49807.6537  44.7%  1953  400s
  3158  2552 40921.4883   29  230 34416.8915 49457.4454  43.7%  1951  409s
  3315  2641 40528.2144   31  200 34416.8915 49394.6697  43.5%  1962  419s
  3475  2717 40351.0409   33  245 34416.8915 49394.6697  43.5%  1979  430s
  3613  2738 40309.4843   34  233 34416.8915 49287.5814  43.2%  2005  437s
H 3626  2737                    34474.618634 49287.5814  43.0%  2012  437s
  3654  2798 40192.0658   35  275 34474.6186 48915.6499  41.9%  2020  446s
H 3660  2745                    34805.803514 48915.6499  40.5%  2023  446s
H 3687  2713                    34936.645118 48915.6499  40.0%  2025  446s
H 3725  2710                    34947.760369 48915.6499  40.0%  2032  446s
H 3736  2667                    35128.159172 48915.6499  39.2%  2031  472s
  3737  2663 42978.1381   15  380 35128.1592 48915.6499  39.2%  2030  514s
  3739  2664 36714.1397   19  134 35128.1592 48915.6499  39.2%  2029  542s
  3740  2665 47669.5797   14  321 35128.1592 48915.6499  39.2%  2029  557s
  3741  2666 42139.1127   25  335 35128.1592 48915.6499  39.2%  2028  564s
  3742  2666 48237.7780   14  387 35128.1592 48915.6499  39.2%  2028  569s
  3743  2667 35291.3563   31  401 35128.1592 48915.6499  39.2%  2027  572s
  3744  2668 46062.4943   12  351 35128.1592 48915.6499  39.2%  2027  576s
  3746  2669 43581.5452   31  435 35128.1592 48915.6499  39.2%  2026  585s
  3748  2670 43457.5271   32  414 35128.1592 48915.6499  39.2%  2024  590s
  3751  2672 36356.4159   40  389 35128.1592 48915.6499  39.2%  2023  595s
  3753  2674 46838.6185   10  386 35128.1592 48915.6499  39.2%  2022  600s
  3756  2676 48759.9293   12  385 35128.1592 48915.6499  39.2%  2020  605s
  3759  2678 36297.4953   48  464 35128.1592 48915.6499  39.2%  2019  611s
  3761  2679 42552.7266   39  465 35128.1592 48915.6499  39.2%  2017  615s
  3765  2682 37769.0009   16  384 35128.1592 48915.6499  39.2%  2015  622s
  3766  2682 39932.9599   39  384 35128.1592 48915.6499  39.2%  2015  648s
  3767  2683 36262.0835   26  384 35128.1592 48915.6499  39.2%  2014  662s
  3768  2687 48915.6499   16  385 35128.1592 48915.6499  39.2%  2057  672s
  3770  2690 48915.6499   17  363 35128.1592 48915.6499  39.2%  2060  685s
  3774  2697 48915.6499   18  322 35128.1592 48915.6499  39.2%  2066  695s
  3782  2710 48915.6499   19  444 35128.1592 48915.6499  39.2%  2079  709s
  3798  2721 48915.6499   20  379 35128.1592 48915.6499  39.2%  2119  727s
  3814  2745 47135.4314   21  378 35128.1592 48915.6499  39.2%  2182  737s
  3846  2832 47023.7917   22  371 35128.1592 48915.6499  39.2%  2205  748s
  3945  2832 46236.8054   25  338 35128.1592 48915.6499  39.2%  2266  756s
  3978  2863 45863.1284   25  326 35128.1592 48915.6499  39.2%  2274  764s
  4022  2905 44742.9802   23  319 35128.1592 48915.6499  39.2%  2297  774s
  4089  2927 44395.4718   24  380 35128.1592 48915.6499  39.2%  2313  782s
  4158  2946 44819.7954   26  340 35128.1592 48915.6499  39.2%  2330  792s
  4234  2976 44556.7374   26  289 35128.1592 48915.6499  39.2%  2339  800s
  4316  2979 44119.4569   27  278 35128.1592 48915.6499  39.2%  2337  808s
  4384  2966 44522.3296   26  328 35128.1592 48915.6499  39.2%  2338  815s
  4455  2941 43087.5172   28  266 35128.1592 48915.6499  39.2%  2341  824s
  4501  2930 41378.1244   28  252 35128.1592 48915.6499  39.2%  2351  836s
  4555  2933 40571.2512   29  230 35128.1592 48915.6499  39.2%  2361  847s
H 4585  2788                    35174.659453 48915.6499  39.1%  2372  847s
  4594  2810 40601.7217   29  286 35174.6595 48915.6499  39.1%  2379  856s
  4665  2806 39842.8584   30  243 35174.6595 48915.6499  39.1%  2385  865s
  4700  2809 39133.8674   31  204 35174.6595 48915.6499  39.1%  2392  873s
  4740  2810 37895.7120   32  257 35174.6595 48915.6499  39.1%  2412  880s
H 4744  2680                    36461.646595 48915.6499  34.2%  2411  880s
  4782  2673 37811.9694   33  241 36461.6466 48915.6499  34.2%  2418  889s
  4833  2675 37651.8784   34  178 36461.6466 48915.6499  34.2%  2433  898s
H 4836  2552                    36730.561079 48915.6499  33.2%  2434  898s
  4880  2568 37540.1613   35  219 36730.5611 48915.6499  33.2%  2453  909s
  4949  2569 37231.9838   39  209 36730.5611 48915.6499  33.2%  2466  919s
  5019  2583 40454.7655   26  360 36730.5611 48915.6499  33.2%  2487  931s
  5101  2584 39140.6488   27  242 36730.5611 48915.6499  33.2%  2508  941s
  5176  2586 37105.9669   28  239 36730.5611 48915.6499  33.2%  2521  957s
  5248  2584 37092.7510   29  235 36730.5611 48915.6499  33.2%  2548  968s
  5332  2584     cutoff   29      36730.5611 48915.6499  33.2%  2572  980s
  5411  2576 40286.8242   30  346 36730.5611 48915.6499  33.2%  2600  991s
  5453  2579 39181.7396   31  329 36730.5611 48915.6499  33.2%  2614 1002s
  5501  2578 39123.9421   32  354 36730.5611 48915.6499  33.2%  2630 1011s
  5560  2560 39107.2669   33  345 36730.5611 48915.6499  33.2%  2640 1023s
  5621  2564 38003.4327   34  278 36730.5611 48915.6499  33.2%  2657 1037s
  5681  2565 37961.2210   35  270 36730.5611 48360.1066  31.7%  2671 1049s
  5745  2573 37698.5535   38  188 36730.5611 48084.7555  30.9%  2685 1064s
  5824  2572 infeasible   27      36730.5611 48084.7555  30.9%  2690 1077s
  5924  2584 42379.3826   24  345 36730.5611 48084.7555  30.9%  2708 1091s
  6030  2589 38038.1944   27  226 36730.5611 48084.7555  30.9%  2727 1106s
  6146  2574 36852.4562   29  285 36730.5611 46749.2790  27.3%  2750 1119s
  6268  2574 36851.3773   30  286 36730.5611 46749.2790  27.3%  2758 1137s
  6392  2578 42418.1197   28  292 36730.5611 46202.1298  25.8%  2791 1153s
  6521  2596 41577.6277   29  304 36730.5611 46048.1074  25.4%  2818 1170s
  6689  2577 39322.0590   33  200 36730.5611 46048.1074  25.4%  2833 1188s
  6835  2580 37650.6788   33  276 36730.5611 46048.1074  25.4%  2858 1205s
  6995  2574     cutoff   39      36730.5611 45815.2373  24.7%  2881 1226s
  7121  2589 40194.4531   26  194 36730.5611 45748.6720  24.6%  2908 1244s
  7319  2559 37752.5009   30  200 36730.5611 45748.6720  24.6%  2922 1263s
  7553  2527     cutoff   31      36730.5611 45430.4212  23.7%  2926 1282s
  7782  2464     cutoff   32      36730.5611 45340.9938  23.4%  2939 1305s
  7978  2450     cutoff   30      36730.5611 45208.7034  23.1%  2971 1328s
  8170  2458 38555.4891   32  205 36730.5611 45206.5058  23.1%  2993 1351s
  8386  2392 37434.0713   27  369 36730.5611 45106.4269  22.8%  3020 1368s
  8444  2392     cutoff   28      36730.5611 45106.4269  22.8%  3027 1388s
H 8460  2272                    37274.710535 45106.4269  21.0%  3030 1388s
  8553  2264 40829.9047   27  267 37274.7105 44969.2413  20.6%  3040 1410s
  8806  2221     cutoff   33      37274.7105 44883.2267  20.4%  3062 1437s
  9059  2129 43012.4877   30  279 37274.7105 44765.9820  20.1%  3086 1460s
  9341  2049 37594.8335   38   92 37274.7105 44700.8390  19.9%  3108 1486s
H 9375  1928                    37351.049973 44700.8390  19.7%  3105 1486s
  9588  1922 38996.1048   30  168 37351.0500 44358.7766  18.8%  3112 1510s
  9897  1874 41883.2584   26  343 37351.0500 44292.4300  18.6%  3129 1538s
 10223  1895 42494.5316   25  390 37351.0500 44135.3293  18.2%  3143 1564s
 10604  1984 infeasible   31      37351.0500 44027.1243  17.9%  3145 1592s
 10956  2043 37538.3698   28  202 37351.0500 43670.7293  16.9%  3161 1624s
 11385  2073 39803.3924   24  220 37351.0500 43552.4549  16.6%  3156 1655s
 11756  2092 infeasible   30      37351.0500 43319.1909  16.0%  3175 1685s
 12209  2129 infeasible   34      37351.0500 43146.8820  15.5%  3178 1720s
 12638  2141 infeasible   30      37351.0500 42976.1409  15.1%  3185 1754s
 13070  2176 39784.5150   27  350 37351.0500 42782.8070  14.5%  3200 1789s
 13526  2187 infeasible   32      37351.0500 42594.8007  14.0%  3214 1823s
 14056  2217 39461.0386   31  314 37351.0500 42410.7479  13.5%  3218 1868s
 14583  2293 37547.9884   37  157 37351.0500 42123.3562  12.8%  3223 1908s
H15120  2280                    37414.231920 42039.9952  12.4%  3216 1908s
*15122  2278              65    37422.507650 42039.9952  12.3%  3216 1908s
 15202  2269 37605.7947   28  237 37422.5076 41932.4892  12.1%  3215 1951s
 15721  2246 infeasible   27      37422.5076 41811.4306  11.7%  3220 1996s
 16239  2205 infeasible   28      37422.5076 41607.9105  11.2%  3237 2044s
 16883  2126 38160.1212   26  142 37422.5076 41316.6178  10.4%  3235 2093s
 17481  2073 infeasible   34      37422.5076 41208.9623  10.1%  3248 2145s
 18194  1952 infeasible   31      37422.5076 40906.0019  9.31%  3247 2194s
 18903  1822     cutoff   25      37422.5076 40640.8310  8.60%  3251 2244s
 19731  1645 infeasible   29      37422.5076 40334.6117  7.78%  3239 2291s
 20350  1296 38062.6316   30  152 37422.5076 40110.7458  7.18%  3242 2345s
 21277   664 infeasible   29      37422.5076 39695.4806  6.07%  3227 2394s
 22341    89     cutoff   32      37422.5076 39164.6587  4.66%  3200 2432s
*22488    89              61    37438.994392 39164.6587  4.61%  3186 2432s
*22511    89              82    37565.752219 39164.6587  4.26%  3183 2432s
*23325    89              54    37633.257393 39045.0761  3.75%  3108 2432s

Cutting planes:
  Learned: 2
  MIR: 691
  Mixing: 3
  Flow cover: 1447
  RLT: 29
  Relax-and-lift: 136

Explored 23984 nodes (73188206 simplex iterations) in 2434.02 seconds (7880.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 37633.3 37565.8 37439 ... 35128.2

Optimal solution found (tolerance 1.00e-04)
Best objective 3.763325739294e+04, best bound 3.763325739294e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2434.03s
  Master Objective (UB) = 37633.26, θ = 186718.00
  Upper Bound (UB) = 37633.26

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 186718.00
  [DEBUG]   ✓ Scenario 0: θ = 186718.00 ≤ Q = 186718.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 186718.00 ≤ Q = 186718.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 186718.00 ≤ Q = 186718.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 186718.00 ≤ Q = 186718.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 186718.00 ≤ Q = 186718.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 186718.00 ≤ Q = 186718.00 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x28cd0aea
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x28cd0aea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.390637e+13
Presolve removed 2601 rows and 1893 columns
Presolve time: 0.00s
Presolved: 492 rows, 496 columns, 1387 nonzeros
Found heuristic solution: objective 6746326.3872
Variable types: 336 continuous, 160 integer (160 binary)

Root relaxation: objective -1.650958e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165095.83    0  125 6746326.39 -165095.83   102%     -    0s
H    0     0                    -130214.6734 -165095.83  26.8%     -    0s
H    0     0                    -130853.0289 -165095.83  26.2%     -    0s
     0     0 -145483.25    0   92 -130853.03 -145483.25  11.2%     -    0s
H    0     0                    -140720.3799 -145436.18  3.35%     -    0s
H    0     0                    -141019.0869 -145436.18  3.13%     -    0s
H    0     0                    -141621.4409 -145436.18  2.69%     -    0s
H    0     0                    -141920.1480 -145436.18  2.48%     -    0s
     0     0 -144027.14    0   91 -141920.15 -144027.14  1.48%     -    0s
H    0     0                    -142111.4991 -144020.92  1.34%     -    0s
     0     0 -144014.64    0   91 -142111.50 -144014.64  1.34%     -    0s
     0     0 -143562.23    0   50 -142111.50 -143562.23  1.02%     -    0s
     0     0 -143412.29    0   69 -142111.50 -143412.29  0.92%     -    0s
     0     0 -143009.33    0   58 -142111.50 -143009.33  0.63%     -    0s
H    0     0                    -142130.0017 -143003.57  0.61%     -    0s
     0     0 -142967.52    0   60 -142130.00 -142967.52  0.59%     -    0s
     0     0 -142665.40    0   49 -142130.00 -142665.40  0.38%     -    0s
     0     0 -142603.54    0   49 -142130.00 -142603.54  0.33%     -    0s
     0     0 -142601.48    0   51 -142130.00 -142601.48  0.33%     -    0s
     0     0 -142444.91    0   44 -142130.00 -142444.91  0.22%     -    0s
H    0     0                    -142140.7970 -142428.27  0.20%     -    0s
     0     0 -142418.26    0   43 -142140.80 -142418.26  0.20%     -    0s
     0     0 -142417.11    0   44 -142140.80 -142417.11  0.19%     -    0s
     0     0 -142415.85    0   47 -142140.80 -142415.85  0.19%     -    0s
     0     0 -142330.58    0   40 -142140.80 -142330.58  0.13%     -    0s
     0     0 -142310.40    0   40 -142140.80 -142310.40  0.12%     -    0s
H    0     0                    -142167.2819 -142310.40  0.10%     -    0s
     0     0 -142310.40    0   83 -142167.28 -142310.40  0.10%     -    0s
     0     0 -142310.40    0   43 -142167.28 -142310.40  0.10%     -    0s
     0     0 -142221.28    0   38 -142167.28 -142221.28  0.04%     -    0s
     0     0 -142211.18    0   21 -142167.28 -142211.18  0.03%     -    0s
     0     0 -142199.12    0   12 -142167.28 -142199.12  0.02%     -    0s
     0     0          -    0      -142167.28 -142176.36  0.01%     -    0s

Cutting planes:
  Gomory: 18
  Implied bound: 12
  MIR: 66
  Flow cover: 7
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (1156 simplex iterations) in 0.12 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -142167 -142141 -142130 ... 1.39064e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.421672819449e+05, best bound -1.421763631214e+05, gap 0.0064%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 177811.54
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142167.28
  [DEBUG]   S×d_nominal = 319978.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 319978.82 + -142167.28 = 177811.54
  [DEBUG]   Current θ from Master = 186718.00
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8906.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28726.80
  Lower Bound (LB) = 28726.80
  Gap (UB-LB) = 8906.4623, Absolute Gap = 8906.4623, Relative Gap = 0.236665
  Not converged yet (gap = 8906.46 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x6b92306b
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 0.97s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35633    5.3037849e+03   0.000000e+00   3.426879e+06      5s
   50184    3.8275037e+04   0.000000e+00   1.924904e+06     10s
   65526    4.7136458e+04   0.000000e+00   1.467706e+06     15s
   76279    5.3242198e+04   0.000000e+00   1.449885e+07     20s
Concurrent spin time: 5.76s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 6.449227e+04, 59592 iterations, 26.13 seconds (46.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64492.2711    0  130 -170340.08 64492.2711   138%     -   27s
H    0     0                    -157000.5782 64492.2711   141%     -   27s
H    0     0                    -40492.09561 64492.2711   259%     -   27s
H    0     0                    -40397.74303 64492.2711   260%     -   27s
H    0     0                    -1470.094700 64492.2711  4487%     -   27s
H    0     0                    1301.4983118 64492.2711  4855%     -   28s
H    0     0                    8720.5308154 64492.2711   640%     -   28s
H    0     0                    14734.192203 64492.2711   338%     -   28s
     0     0 59634.6396    0  186 14734.1922 59634.6396   305%     -   36s
     0     0 59028.6216    0  192 14734.1922 59028.6216   301%     -   40s
     0     0 59006.6658    0  192 14734.1922 59006.6658   300%     -   41s
     0     0 59006.5638    0  196 14734.1922 59006.5638   300%     -   41s
     0     0 59006.5638    0  192 14734.1922 59006.5638   300%     -   42s
     0     0 59006.5638    0  197 14734.1922 59006.5638   300%     -   44s
     0     0 59006.5638    0  189 14734.1922 59006.5638   300%     -   44s
     0     0 59006.5638    0  193 14734.1922 59006.5638   300%     -   45s
     0     0 59006.5638    0  193 14734.1922 59006.5638   300%     -   45s
     0     0 56726.5089    0  279 14734.1922 56726.5089   285%     -   52s
H    0     0                    14900.856691 56726.1811   281%     -   53s
     0     0 56257.2812    0  280 14900.8567 56257.2812   278%     -   56s
H    0     0                    15148.747378 55856.8329   269%     -   60s
H    0     0                    15848.196934 55856.8329   252%     -   60s
H    0     0                    17622.852322 55856.8329   217%     -   60s
H    0     0                    17681.038297 55856.8329   216%     -   60s
H    0     0                    24055.772116 55856.8329   132%     -   60s
H    0     0                    24351.998819 55856.8329   129%     -   60s
H    0     0                    24633.523693 55856.8329   127%     -   60s
     0     0 55856.8329    0  277 24633.5237 55856.8329   127%     -   60s
     0     0 55699.2057    0  286 24633.5237 55699.2057   126%     -   63s
     0     0 55659.8277    0  287 24633.5237 55659.8277   126%     -   65s
     0     0 55606.4873    0  287 24633.5237 55606.4873   126%     -   67s
     0     0 55575.3779    0  290 24633.5237 55575.3779   126%     -   68s
     0     0 55537.9327    0  289 24633.5237 55537.9327   125%     -   69s
     0     0 55525.4359    0  295 24633.5237 55525.4359   125%     -   69s
     0     0 55517.7970    0  288 24633.5237 55517.7970   125%     -   70s
     0     0 55512.8832    0  295 24633.5237 55512.8832   125%     -   70s
     0     0 55494.5813    0  284 24633.5237 55494.5813   125%     -   71s
     0     0 55477.3903    0  289 24633.5237 55477.3903   125%     -   72s
     0     0 55473.1734    0  293 24633.5237 55473.1734   125%     -   72s
     0     0 55471.1516    0  296 24633.5237 55471.1516   125%     -   72s
     0     0 55470.8657    0  297 24633.5237 55470.8657   125%     -   73s
H    0     0                    25061.971519 53886.9711   115%     -   86s
H    0     0                    25378.348135 53886.9711   112%     -   86s
     0     0 53886.9711    0  321 25378.3481 53886.9711   112%     -   87s
H    0     0                    25381.619035 53886.7068   112%     -   87s
     0     0 53481.2306    0  328 25381.6190 53481.2306   111%     -   93s
     0     0 53316.3898    0  330 25381.6190 53316.3898   110%     -   97s
     0     0 53273.1089    0  333 25381.6190 53273.1089   110%     -   99s
     0     0 53249.9064    0  335 25381.6190 53249.9064   110%     -  101s
     0     0 53190.3532    0  331 25381.6190 53190.3532   110%     -  103s
     0     0 53166.9043    0  336 25381.6190 53166.9043   109%     -  105s
H    0     0                    30347.347002 53156.1372  75.2%     -  106s
H    0     0                    31258.831786 53156.1372  70.1%     -  106s
H    0     0                    32151.368654 53156.1372  65.3%     -  106s
H    0     0                    33057.163349 53156.1372  60.8%     -  106s
     0     0 53156.1372    0  338 33057.1633 53156.1372  60.8%     -  106s
     0     0 53138.2140    0  337 33057.1633 53138.2140  60.7%     -  108s
     0     0 53133.0098    0  344 33057.1633 53133.0098  60.7%     -  109s
     0     0 53129.3629    0  340 33057.1633 53129.3629  60.7%     -  109s
     0     0 53127.9131    0  340 33057.1633 53127.9131  60.7%     -  110s
     0     0 53125.9446    0  342 33057.1633 53125.9446  60.7%     -  110s
     0     0 53125.8132    0  342 33057.1633 53125.8132  60.7%     -  110s
     0     0 52906.9249    0  361 33057.1633 52906.9249  60.0%     -  119s
H    0     0                    33412.611582 52906.5017  58.3%     -  119s
     0     0 52748.1362    0  364 33412.6116 52748.1362  57.9%     -  122s
     0     0 52616.5283    0  392 33412.6116 52616.5283  57.5%     -  126s
     0     0 52568.9732    0  402 33412.6116 52568.9732  57.3%     -  128s
     0     0 52553.5161    0  369 33412.6116 52553.5161  57.3%     -  129s
     0     0 52550.4952    0  397 33412.6116 52550.4952  57.3%     -  129s
     0     0 52540.5631    0  400 33412.6116 52540.5631  57.2%     -  130s
     0     0 52537.0120    0  366 33412.6116 52537.0120  57.2%     -  131s
     0     0 52536.8589    0  364 33412.6116 52536.8589  57.2%     -  131s
     0     0 52424.3050    0  365 33412.6116 52424.3050  56.9%     -  134s
H    0     0                    33649.368676 52423.9051  55.8%     -  134s
H    0     0                    33682.938783 52423.9051  55.6%     -  134s
     0     0 52407.6584    0  362 33682.9388 52407.6584  55.6%     -  135s
     0     0 52403.2955    0  367 33682.9388 52403.2955  55.6%     -  135s
     0     0 52402.3313    0  369 33682.9388 52402.3313  55.6%     -  136s
     0     0 52377.5070    0  401 33682.9388 52377.5070  55.5%     -  138s
H    0     0                    33917.057493 52377.4200  54.4%     -  140s
     0     0 52371.9464    0  408 33917.0575 52371.9464  54.4%     -  141s
     0     0 52364.1758    0  409 33917.0575 52364.1758  54.4%     -  142s
     0     0 52360.1148    0  408 33917.0575 52360.1148  54.4%     -  142s
     0     0 52357.9375    0  410 33917.0575 52357.9375  54.4%     -  143s
     0     0 52349.9686    0  408 33917.0575 52349.9686  54.3%     -  144s
     0     0 52344.6094    0  409 33917.0575 52344.6094  54.3%     -  144s
     0     0 52340.1252    0  408 33917.0575 52340.1252  54.3%     -  145s
     0     0 52338.4241    0  404 33917.0575 52338.4241  54.3%     -  145s
     0     0 52338.0024    0  411 33917.0575 52338.0024  54.3%     -  145s
     0     0 52301.2084    0  363 33917.0575 52301.2084  54.2%     -  147s
     0     0 52287.7980    0  370 33917.0575 52287.7980  54.2%     -  149s
     0     0 52283.2821    0  367 33917.0575 52283.2821  54.2%     -  150s
     0     0 52281.3757    0  364 33917.0575 52281.3757  54.1%     -  150s
     0     0 52280.9927    0  369 33917.0575 52280.9927  54.1%     -  150s
     0     0 52271.0578    0  376 33917.0575 52271.0578  54.1%     -  152s
H    0     0                    35811.753906 52270.5189  46.0%     -  152s
H    0     0                    35898.426904 52270.5189  45.6%     -  153s
     0     0 52269.3359    0  373 35898.4269 52269.3359  45.6%     -  154s
     0     0 52269.0190    0  370 35898.4269 52269.0190  45.6%     -  154s
     0     0 52263.9211    0  368 35898.4269 52263.9211  45.6%     -  155s
H    0     0                    35949.188167 52263.8984  45.4%     -  156s
     0     0 52261.3580    0  372 35949.1882 52261.3580  45.4%     -  156s
     0     0 52260.4822    0  363 35949.1882 52260.4822  45.4%     -  156s
     0     0 52256.5241    0  363 35949.1882 52256.5241  45.4%     -  158s
H    0     0                    36166.157536 52256.3567  44.5%     -  158s
     0     0 52252.0325    0  372 36166.1575 52252.0325  44.5%     -  161s
     0     0 52251.5731    0  373 36166.1575 52251.5731  44.5%     -  161s
     0     0 52250.7036    0  381 36166.1575 52250.7036  44.5%     -  162s
     0     0 52250.5946    0  381 36166.1575 52250.5946  44.5%     -  162s
     0     2 52250.5946    0  381 36166.1575 52250.5946  44.5%     -  181s
     3     8 52065.9852    2  389 36166.1575 52171.6356  44.3%  3423  189s
     7    16 51849.2717    3  324 36166.1575 52065.7730  44.0%  5383  195s
    15    32 51678.2004    4  385 36166.1575 51849.1479  43.4%  7211  205s
    31    50 51030.0535    5  346 36166.1575 51718.7374  43.0% 11143  222s
    49    82 49566.2713    6  364 36166.1575 51713.6218  43.0% 10122  232s
    81   116 49528.8193    7  355 36166.1575 51713.6218  43.0%  8108  241s
H  105   116                    36348.249884 51713.6218  42.3%  6755  241s
   115   244 49092.2608    8  350 36348.2499 51713.6218  42.3%  6316  253s
H  122   244                    36529.545133 51713.6218  41.6%  6099  253s
H  169   244                    36546.868452 51713.6218  41.5%  5227  253s
H  174   244                    36793.311968 51713.6218  40.6%  5093  253s
   243   333 48967.3491    9  348 36793.3120 51713.6218  40.6%  4362  263s
   332   394 48861.7932   10  335 36793.3120 51713.6218  40.6%  3982  272s
H  354   394                    36921.546936 51713.6218  40.1%  3952  272s
   393   451 47824.6141   10  313 36921.5469 51713.6218  40.1%  4078  281s
   460   518 48016.4614    9  324 36921.5469 51713.6218  40.1%  3991  290s
   531   592 48379.5289   10  329 36921.5469 51713.6218  40.1%  3858  298s
   617   640 47484.4343   10  310 36921.5469 51713.6218  40.1%  3612  306s
   695   690 45441.6295   11  319 36921.5469 51713.6218  40.1%  3461  315s
   771   730 42125.5743   33  325 36921.5469 51713.6218  40.1%  3370  322s
   841   780 41152.1029   34  310 36921.5469 51713.6218  40.1%  3289  330s
   917   829 46167.9946   11  320 36921.5469 51677.3527  40.0%  3219  339s
  1000   851 46512.6206   12  321 36921.5469 51677.3527  40.0%  3133  347s
  1040   882 45944.2311   13  249 36921.5469 51677.3527  40.0%  3144  356s
H 1061   882                    36935.955981 51677.3527  39.9%  3150  356s
  1105   930 43514.1857   12  263 36935.9560 51677.3527  39.9%  3162  366s
  1199  1005 44597.1577   13  303 36935.9560 51677.3527  39.9%  3094  376s
  1294  1079 40454.1431   15  227 36935.9560 51677.3527  39.9%  3040  384s
  1404  1099 42917.3434   14  221 36935.9560 51677.3527  39.9%  2953  393s
  1444  1114 43361.9212   15  281 36935.9560 51677.3527  39.9%  2950  402s
  1499  1143 43774.9049   14  299 36935.9560 51677.3527  39.9%  2935  408s
  1534  1164 43254.0951   16  223 36935.9560 51677.3527  39.9%  2935  418s
  1581  1196 43153.1598   17  324 36935.9560 51677.3527  39.9%  2948  426s
  1643  1223 42616.9919   18  289 36935.9560 51677.3527  39.9%  2916  434s
  1718  1266 43039.1094   17  231 36935.9560 50773.8660  37.5%  2882  446s
  1809  1317 42913.5585   18  230 36935.9560 50773.8660  37.5%  2846  457s
  1912  1388 41026.1587   18  225 36935.9560 50773.8660  37.5%  2814  470s
  2003  1446 42651.3837   19  218 36935.9560 50773.8660  37.5%  2807  481s
  2103  1550 42908.5563   18  234 36935.9560 50773.8660  37.5%  2782  492s
  2235  1631 41957.1057   19  195 36935.9560 50773.8660  37.5%  2751  503s
  2384  1698 40870.7153   20  214 36935.9560 50615.0543  37.0%  2719  516s
  2515  1770 40125.6550   20  206 36935.9560 50586.3378  37.0%  2722  529s
  2688  1851 39788.3714   23  199 36935.9560 50586.3378  37.0%  2685  543s
  2845  1939     cutoff   24      36935.9560 50586.3378  37.0%  2690  556s
  3016  2024     cutoff   25      36935.9560 50586.3378  37.0%  2683  569s
  3204  2132     cutoff   25      36935.9560 50088.6482  35.6%  2666  584s
  3400  2216 43027.9241    9  306 36935.9560 50088.6482  35.6%  2657  600s
  3544  2344 41260.0345   11  304 36935.9560 49920.3789  35.2%  2688  615s
  3711  2466 39412.1659   14  265 36935.9560 49920.3789  35.2%  2703  631s
  3948  2647 37268.4750   17  207 36935.9560 49901.0624  35.1%  2673  647s
  4228  2648 43023.6723   19  381 36935.9560 49835.7528  34.9%  2627  684s
  4230  2649 40766.6676   24  130 36935.9560 49835.7528  34.9%  2626  712s
  4231  2650 43727.7566   18  290 36935.9560 49835.7528  34.9%  2625  729s
  4232  2651 39114.9385   33  340 36935.9560 49835.7528  34.9%  2624  743s
  4233  2651 39541.3098   38  345 36935.9560 49835.7528  34.9%  2624  750s
  4234  2652 44332.3886   11  382 36935.9560 49835.7528  34.9%  2623  756s
  4235  2653 37714.5062   33  363 36935.9560 49835.7528  34.9%  2622  760s
  4238  2655 38237.3596   15  373 36935.9560 49835.7528  34.9%  2621  767s
  4240  2656 39400.1066   62  364 36935.9560 49835.7528  34.9%  2619  771s
  4242  2657 39669.6269   14  376 36935.9560 49835.7528  34.9%  2618  778s
  4243  2658 47352.7354   13  376 36935.9560 49835.7528  34.9%  2618  780s
  4246  2660 43162.4309   14  376 36935.9560 49835.7528  34.9%  2616  786s
  4248  2661 41315.4317   16  414 36935.9560 49835.7528  34.9%  2614  791s
  4250  2663 40141.1102   22  384 36935.9560 49835.7528  34.9%  2613  795s
  4252  2664 41922.2466   17  379 36935.9560 49835.7528  34.9%  2612  802s
  4255  2666 47587.9837   15  386 36935.9560 49835.7528  34.9%  2610  809s
  4256  2667 39950.6981   31  372 36935.9560 49835.7528  34.9%  2610  810s
  4259  2669 48490.4444   12  377 36935.9560 49835.7528  34.9%  2608  815s
  4260  2669 38275.9782   21  384 36935.9560 49835.7528  34.9%  2607  820s
  4262  2671 45100.6070   22  365 36935.9560 49835.7528  34.9%  2606  826s
  4265  2673 39790.1760   33  367 36935.9560 49835.7528  34.9%  2604  854s
  4266  2673 37751.0887   30  367 36935.9560 49835.7528  34.9%  2603  872s
  4267  2677 49835.7528   16  358 36935.9560 49835.7528  34.9%  2647  887s
  4269  2680 49835.7528   17  397 36935.9560 49835.7528  34.9%  2650  894s
  4273  2687 49835.7528   18  395 36935.9560 49835.7528  34.9%  2654  924s
  4281  2700 49835.7528   19  406 36935.9560 49835.7528  34.9%  2658  944s
  4297  2711 49835.7528   20  329 36935.9560 49835.7528  34.9%  2726  973s
  4313  2738 47855.3907   21  353 36935.9560 49835.7528  34.9%  2746  991s
  4345  2759 45395.3481   22  254 36935.9560 49835.7528  34.9%  2802 1005s
  4377  2783 45391.7071   23  252 36935.9560 49835.7528  34.9%  2828 1022s
  4414  2802 45234.9018   24  245 36935.9560 49835.7528  34.9%  2854 1039s
  4472  2814 45217.1036   24  244 36935.9560 49835.7528  34.9%  2872 1056s
  4565  2830 44905.4477   25  290 36935.9560 49835.7528  34.9%  2894 1074s
  4670  2803 41072.2731   27  252 36935.9560 49835.7528  34.9%  2909 1088s
  4784  2796 43830.8339   26  348 36935.9560 49835.7528  34.9%  2903 1101s
  4873  2785 41131.1310   26  316 36935.9560 49835.7528  34.9%  2908 1113s
  4914  2799 40558.9373   27  268 36935.9560 49835.7528  34.9%  2923 1122s
  4952  2804 40289.0212   28  280 36935.9560 49835.7528  34.9%  2939 1134s
  4993  2812 40080.0882   27  230 36935.9560 49835.7528  34.9%  2944 1145s
  5031  2811     cutoff   28      36935.9560 49835.7528  34.9%  2955 1156s
  5078  2806 38767.6589   28  252 36935.9560 49835.7528  34.9%  2966 1168s
  5135  2809 38767.0377   29  253 36935.9560 49364.0034  33.6%  2976 1179s
  5170  2815     cutoff   30      36935.9560 49364.0034  33.6%  2984 1189s
  5216  2817 41972.4685   25  287 36935.9560 49364.0034  33.6%  2987 1201s
  5264  2824 40173.8529   26  222 36935.9560 49364.0034  33.6%  2989 1211s
  5301  2839 39379.9750   27  252 36935.9560 48401.7904  31.0%  2999 1220s
  5342  2852 37321.1755   28  217 36935.9560 48401.7904  31.0%  3007 1230s
  5391  2850     cutoff   29      36935.9560 48133.5095  30.3%  3012 1245s
  5460  2859 37692.8716   29  212 36935.9560 47467.2318  28.5%  3011 1257s
  5534  2870     cutoff   30      36935.9560 47467.2318  28.5%  3011 1268s
  5621  2867 37081.6348   30  193 36935.9560 47158.0519  27.7%  3011 1280s
  5714  2868 44475.2810   25  270 36935.9560 47158.0519  27.7%  3010 1294s
  5827  2867 44305.2431   25  321 36935.9560 46811.8531  26.7%  3009 1314s
  5937  2866 42275.2881   27  250 36935.9560 46398.8694  25.6%  3022 1329s
  6076  2866 41113.8418   28  205 36935.9560 46398.8694  25.6%  3023 1349s
  6223  2864 38585.9488   29  194 36935.9560 45748.4242  23.9%  3029 1366s
  6368  2875 40452.6449   29  250 36935.9560 45589.5637  23.4%  3034 1386s
  6502  2861     cutoff   33      36935.9560 45388.1939  22.9%  3044 1408s
  6669  2841     cutoff   27      36935.9560 45388.1939  22.9%  3049 1428s
  6828  2816 39920.2739   28  305 36935.9560 45388.1939  22.9%  3060 1448s
  6980  2815     cutoff   34      36935.9560 45388.1939  22.9%  3072 1467s
  7113  2811 41261.3168   29  241 36935.9560 45388.1939  22.9%  3090 1486s
  7313  2778     cutoff   32      36935.9560 44590.4030  20.7%  3089 1507s
  7489  2767 41698.1837   27  286 36935.9560 44590.4030  20.7%  3099 1529s
  7688  2735 39897.7201   34  133 36935.9560 44271.2547  19.9%  3109 1551s
  7902  2705 40870.0237   27  228 36935.9560 44271.2547  19.9%  3112 1576s
  8116  2694 38616.1633   32  170 36935.9560 43808.6362  18.6%  3119 1600s
  8348  2641     cutoff   35      36935.9560 43548.3312  17.9%  3125 1626s
  8650  2592 38609.5795   25  354 36935.9560 43303.7115  17.2%  3105 1652s
  8975  2522 41484.4387   25  306 36935.9560 43216.0786  17.0%  3089 1679s
  9271  2433 37352.9558   30  275 36935.9560 42944.3775  16.3%  3083 1708s
  9554  2372 infeasible   29      36935.9560 42695.5976  15.6%  3094 1733s
  9835  2296 37179.5482   29  220 36935.9560 42695.5976  15.6%  3104 1760s
 10030  2231 37324.4687   29  246 36935.9560 42431.8430  14.9%  3119 1785s
 10213  2202 infeasible   26      36935.9560 42361.7227  14.7%  3117 1824s
 10364  2160 39197.1457   27  236 36935.9560 42212.2216  14.3%  3126 1851s
 10554  2130 39122.3288   28  226 36935.9560 42149.0785  14.1%  3128 1877s
 10837  2008     cutoff   27      36935.9560 42149.0785  14.1%  3124 1908s
 11246  1902 37648.3660   28  107 36935.9560 41856.6863  13.3%  3119 1942s
 11681  1727 37439.3108   30  214 36935.9560 41509.6044  12.4%  3116 1975s
 12117  1614     cutoff   26      36935.9560 41294.1540  11.8%  3113 2008s
 12446  1521 39302.7440   28  306 36935.9560 41209.3150  11.6%  3117 2045s
*12722  1521              55    36991.105924 41082.0378  11.1%  3114 2045s
 12924  1476 38290.6710   29  225 36991.1059 40925.6230  10.6%  3115 2081s
 13446  1412 37844.2334   24  258 36991.1059 40642.3539  9.87%  3108 2119s
 13978  1280     cutoff   29      36991.1059 40310.6313  8.97%  3104 2157s
 14669  1110 37151.7620   30  200 36991.1059 40128.5156  8.48%  3071 2196s
 15429   702     cutoff   26      36991.1059 39703.2635  7.33%  3032 2240s
 16388   801     cutoff   30      36991.1059 39273.3968  6.17%  2964 2274s
*16635   801              55    37046.117141 39204.6434  5.83%  2933 2274s
*16812   801              81    37086.743570 39204.6434  5.71%  2909 2274s
*17210   801             110    37148.423094 39094.8666  5.24%  2855 2274s
*18314   801              87    37422.507650 39002.1521  4.22%  2711 2274s
 18479     0 37540.6310   52   28 37422.5076 38095.9531  1.80%  2691 2276s

Cutting planes:
  MIR: 749
  Mixing: 3
  Flow cover: 1579
  RLT: 25
  Relax-and-lift: 146

Explored 19323 nodes (49985319 simplex iterations) in 2276.83 seconds (7013.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 37422.5 37148.4 37086.7 ... 36529.5

Optimal solution found (tolerance 1.00e-04)
Best objective 3.742250764992e+04, best bound 3.742250764992e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2276.84s
  Master Objective (UB) = 37422.51, θ = 191367.87
  Upper Bound (UB) = 37422.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191367.87
  [DEBUG]   ✓ Scenario 0: θ = 191367.87 ≤ Q = 191367.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191367.87 ≤ Q = 191367.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191367.87 ≤ Q = 191367.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 191367.87 ≤ Q = 191367.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 191367.87 ≤ Q = 191367.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 191367.87 ≤ Q = 191367.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 191367.87 ≤ Q = 191367.87 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x57806199
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa87f9e67
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.422489e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6891458.0557
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.620635e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162063.45    0  129 6891458.06 -162063.45   102%     -    0s
H    0     0                    -125041.3634 -162063.45  29.6%     -    0s
H    0     0                    -125896.2522 -162063.45  28.7%     -    0s
H    0     0                    -126765.6604 -162063.45  27.8%     -    0s
H    0     0                    -128313.1767 -147753.11  15.2%     -    0s
H    0     0                    -133184.5031 -147753.11  10.9%     -    0s
     0     0 -147753.11    0   88 -133184.50 -147753.11  10.9%     -    0s
H    0     0                    -143733.7681 -147646.47  2.72%     -    0s
     0     0 -147361.90    0   90 -143733.77 -147361.90  2.52%     -    0s
     0     0 -147344.52    0   90 -143733.77 -147344.52  2.51%     -    0s
     0     0 -146543.77    0   73 -143733.77 -146543.77  1.96%     -    0s
H    0     0                    -144271.2715 -146542.95  1.57%     -    0s
     0     0 -146532.26    0   74 -144271.27 -146532.26  1.57%     -    0s
     0     0 -146266.05    0   67 -144271.27 -146266.05  1.38%     -    0s
H    0     0                    -144334.8220 -146224.78  1.31%     -    0s
     0     0 -145990.22    0   68 -144334.82 -145990.22  1.15%     -    0s
     0     0 -145937.46    0   68 -144334.82 -145937.46  1.11%     -    0s
     0     0 -145899.48    0   68 -144334.82 -145899.48  1.08%     -    0s
     0     0 -145838.98    0   68 -144334.82 -145838.98  1.04%     -    0s
     0     2 -145808.29    0   68 -144334.82 -145808.29  1.02%     -    0s
H  382   124                    -144366.7364 -145248.69  0.61%   3.7    0s

Cutting planes:
  Gomory: 30
  Implied bound: 4
  MIR: 138
  Flow cover: 15
  RLT: 49
  Relax-and-lift: 3

Explored 2461 nodes (10376 simplex iterations) in 0.17 seconds (0.19 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -144367 -144335 -144271 ... 6.89146e+06
No other solutions better than -144367

Optimal solution found (tolerance 1.00e-04)
Best objective -1.443667364484e+05, best bound -1.443667364484e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 176775.29
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144366.74
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -144366.74 = 176775.29
  [DEBUG]   Current θ from Master = 191367.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14592.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22829.93
  Lower Bound (LB) = 28726.80
  Gap (UB-LB) = 8695.7126, Absolute Gap = 8695.7126, Relative Gap = 0.232366
  Not converged yet (gap = 8695.71 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x34145d61
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 1.08s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33979   -3.5341508e+04   0.000000e+00   9.781905e+06      5s
   51194    2.8379917e+04   0.000000e+00   1.853108e+07     10s
   64689    3.4900173e+04   0.000000e+00   9.907346e+07     15s
   74394    3.8485535e+04   0.000000e+00   5.089568e+06     20s
   84415    4.7087056e+04   0.000000e+00   6.349429e+06     25s
Concurrent spin time: 7.73s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 6.438260e+04, 67224 iterations, 32.33 seconds (55.80 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64382.5991    0  126 -170340.08 64382.5991   138%     -   33s
H    0     0                    -157466.0590 64382.5991   141%     -   33s
H    0     0                    -153695.3843 64382.5991   142%     -   34s
H    0     0                    -152175.5787 64382.5991   142%     -   34s
H    0     0                    -151636.9599 64382.5991   142%     -   34s
H    0     0                    -33220.86477 64382.5991   294%     -   34s
H    0     0                    -33126.51219 64382.5991   294%     -   34s
H    0     0                    -19656.89952 64382.5991   428%     -   34s
H    0     0                    -19323.53124 64382.5991   433%     -   34s
H    0     0                    10517.664734 64382.5991   512%     -   34s
H    0     0                    14120.020170 64382.5991   356%     -   34s
H    0     0                    14145.297407 64382.5991   355%     -   34s
H    0     0                    14664.299714 64382.5991   339%     -   35s
     0     0 59819.1446    0  183 14664.2997 59819.1446   308%     -   43s
     0     0 59469.8861    0  188 14664.2997 59469.8861   306%     -   47s
     0     0 59369.7012    0  180 14664.2997 59369.7012   305%     -   49s
     0     0 59339.5259    0  184 14664.2997 59339.5259   305%     -   50s
     0     0 59337.2378    0  182 14664.2997 59337.2378   305%     -   50s
     0     0 59337.2089    0  182 14664.2997 59337.2089   305%     -   50s
     0     0 56964.2792    0  266 14664.2997 56964.2792   288%     -   61s
H    0     0                    14839.071694 56964.2699   284%     -   62s
     0     0 56341.6159    0  266 14839.0717 56341.6159   280%     -   67s
     0     0 56091.0826    0  269 14839.0717 56091.0826   278%     -   72s
     0     0 56055.3643    0  273 14839.0717 56055.3643   278%     -   73s
     0     0 55951.8294    0  277 14839.0717 55951.8294   277%     -   75s
H    0     0                    22318.363589 55903.3994   150%     -   78s
H    0     0                    22748.882779 55903.3994   146%     -   78s
     0     0 55903.3994    0  275 22748.8828 55903.3994   146%     -   78s
     0     0 55875.4493    0  281 22748.8828 55875.4493   146%     -   78s
     0     0 55839.9595    0  279 22748.8828 55839.9595   145%     -   79s
     0     0 55827.4131    0  280 22748.8828 55827.4131   145%     -   80s
     0     0 55803.4035    0  285 22748.8828 55803.4035   145%     -   82s
     0     0 55797.4976    0  286 22748.8828 55797.4976   145%     -   83s
     0     0 55794.1602    0  278 22748.8828 55794.1602   145%     -   83s
     0     0 55792.0029    0  280 22748.8828 55792.0029   145%     -   84s
     0     0 55779.5118    0  280 22748.8828 55779.5118   145%     -   84s
     0     0 55776.4242    0  282 22748.8828 55776.4242   145%     -   85s
     0     0 55774.9886    0  283 22748.8828 55774.9886   145%     -   85s
     0     0 55772.9636    0  282 22748.8828 55772.9636   145%     -   85s
     0     0 55772.7374    0  283 22748.8828 55772.7374   145%     -   85s
H    0     0                    24196.179382 55772.7374   131%     -   91s
H    0     0                    24361.349209 55772.7374   129%     -   91s
H    0     0                    24819.634359 55772.7374   125%     -   91s
H    0     0                    24873.143306 55772.7374   124%     -   91s
H    0     0                    24876.522798 55772.7374   124%     -   91s
     0     0 54192.9226    0  311 24876.5228 54192.9226   118%     -   99s
H    0     0                    25049.222308 54192.1800   116%     -   99s
H    0     0                    25155.599413 54192.1800   115%     -   99s
     0     0 53792.3544    0  355 25155.5994 53792.3544   114%     -  104s
     0     0 53683.9857    0  363 25155.5994 53683.9857   113%     -  107s
H    0     0                    26214.979995 53608.3817   104%     -  111s
H    0     0                    26242.769471 53608.3817   104%     -  111s
H    0     0                    28759.302852 53608.3817  86.4%     -  111s
     0     0 53608.3817    0  358 28759.3029 53608.3817  86.4%     -  111s
H    0     0                    33965.626711 53551.3753  57.7%     -  113s
H    0     0                    34014.309178 53551.3753  57.4%     -  113s
H    0     0                    34040.378122 53551.3753  57.3%     -  113s
     0     0 53551.3753    0  330 34040.3781 53551.3753  57.3%     -  113s
     0     0 53505.0477    0  340 34040.3781 53505.0477  57.2%     -  116s
     0     0 53491.7399    0  341 34040.3781 53491.7399  57.1%     -  117s
     0     0 53473.3880    0  340 34040.3781 53473.3880  57.1%     -  118s
     0     0 53467.4526    0  341 34040.3781 53467.4526  57.1%     -  119s
     0     0 53465.3677    0  340 34040.3781 53465.3677  57.1%     -  119s
     0     0 53464.7416    0  340 34040.3781 53464.7416  57.1%     -  119s
     0     0 52726.3119    0  345 34040.3781 52726.3119  54.9%     -  131s
H    0     0                    34087.779535 52725.9715  54.7%     -  132s
     0     0 52590.3194    0  347 34087.7795 52590.3194  54.3%     -  135s
     0     0 52521.8068    0  354 34087.7795 52521.8068  54.1%     -  138s
     0     0 52472.1935    0  367 34087.7795 52472.1935  53.9%     -  141s
     0     0 52461.5494    0  361 34087.7795 52461.5494  53.9%     -  142s
     0     0 52442.4850    0  374 34087.7795 52442.4850  53.8%     -  144s
     0     0 52431.4170    0  365 34087.7795 52431.4170  53.8%     -  145s
     0     0 52426.8482    0  370 34087.7795 52426.8482  53.8%     -  145s
     0     0 52408.2270    0  371 34087.7795 52408.2270  53.7%     -  146s
     0     0 52395.6088    0  370 34087.7795 52395.6088  53.7%     -  147s
     0     0 52391.0212    0  396 34087.7795 52391.0212  53.7%     -  148s
     0     0 52387.2734    0  398 34087.7795 52387.2734  53.7%     -  149s
     0     0 52386.4757    0  400 34087.7795 52386.4757  53.7%     -  149s
     0     0 52335.4157    0  387 34087.7795 52335.4157  53.5%     -  152s
H    0     0                    34187.587530 52334.2900  53.1%     -  153s
     0     0 52327.4653    0  361 34187.5875 52327.4653  53.1%     -  153s
     0     0 52325.2908    0  362 34187.5875 52325.2908  53.1%     -  154s
     0     0 52324.3150    0  362 34187.5875 52324.3150  53.1%     -  155s
     0     0 52314.2652    0  377 34187.5875 52314.2652  53.0%     -  156s
H    0     0                    34318.293045 52314.0169  52.4%     -  158s
     0     0 52303.7946    0  369 34318.2930 52303.7946  52.4%     -  160s
     0     0 52301.5185    0  373 34318.2930 52301.5185  52.4%     -  160s
     0     0 52299.4410    0  371 34318.2930 52299.4410  52.4%     -  161s
     0     0 52296.7502    0  368 34318.2930 52296.7502  52.4%     -  161s
     0     0 52291.6557    0  362 34318.2930 52291.6557  52.4%     -  162s
     0     0 52288.8508    0  366 34318.2930 52288.8508  52.4%     -  163s
     0     0 52286.9681    0  367 34318.2930 52286.9681  52.4%     -  164s
     0     0 52286.6820    0  366 34318.2930 52286.6820  52.4%     -  164s
     0     0 52242.1823    0  375 34318.2930 52242.1823  52.2%     -  168s
     0     0 52236.2086    0  366 34318.2930 52236.2086  52.2%     -  169s
     0     0 52232.2287    0  370 34318.2930 52232.2287  52.2%     -  169s
     0     0 52228.9230    0  374 34318.2930 52228.9230  52.2%     -  171s
     0     0 52226.7295    0  376 34318.2930 52226.7295  52.2%     -  172s
     0     0 52225.8788    0  371 34318.2930 52225.8788  52.2%     -  172s
     0     0 52218.1095    0  367 34318.2930 52218.1095  52.2%     -  174s
H    0     0                    34349.707477 52217.5836  52.0%     -  175s
     0     0 52213.7257    0  364 34349.7075 52213.7257  52.0%     -  177s
     0     0 52212.0343    0  368 34349.7075 52212.0343  52.0%     -  177s
     0     0 52210.8602    0  369 34349.7075 52210.8602  52.0%     -  178s
     0     0 52202.6809    0  373 34349.7075 52202.6809  52.0%     -  180s
     0     0 52199.7485    0  369 34349.7075 52199.7485  52.0%     -  180s
     0     0 52197.9364    0  373 34349.7075 52197.9364  52.0%     -  181s
     0     0 52197.1692    0  369 34349.7075 52197.1692  52.0%     -  182s
     0     0 52193.1715    0  374 34349.7075 52193.1715  51.9%     -  183s
     0     0 52192.0997    0  374 34349.7075 52192.0997  51.9%     -  184s
     0     0 52184.4989    0  369 34349.7075 52184.4989  51.9%     -  186s
     0     0 52181.4136    0  371 34349.7075 52181.4136  51.9%     -  188s
     0     0 52180.3086    0  369 34349.7075 52180.3086  51.9%     -  188s
     0     0 52174.8730    0  366 34349.7075 52174.8730  51.9%     -  189s
     0     0 52174.4459    0  366 34349.7075 52174.4459  51.9%     -  190s
H    0     2                    34370.170971 52174.4459  51.8%     -  243s
     0     2 52174.4459    0  366 34370.1710 52174.4459  51.8%     -  243s
     1     4 51774.5270    1  355 34370.1710 52172.2191  51.8%  6718  251s
     3     8 51541.7318    2  357 34370.1710 51770.1871  50.6%  8193  255s
     7    16 51279.8726    3  411 34370.1710 51599.0091  50.1%  7162  263s
    15    32 51148.6260    4  419 34370.1710 51280.5963  49.2%  8302  276s
    31    49 48482.6792    5  337 34370.1710 51148.4586  48.8% 13164  304s
    48    81 49719.6368    6  337 34370.1710 51146.7283  48.8% 12165  314s
H   53    81                    34401.055460 51146.7283  48.7% 11691  314s
H   77    81                    34447.972416 51146.7283  48.5%  9585  314s
    80   148 49627.9290    7  357 34447.9724 51146.7283  48.5%  9431  327s
   147   205 49397.1263    9  344 34447.9724 51146.7283  48.5%  6578  339s
H  149   205                    34511.439691 51146.7283  48.2%  6512  339s
H  153   205                    34558.017044 51146.7283  48.0%  6422  339s
   204   288 49386.7120    8  317 34558.0170 51146.7283  48.0%  5611  351s
   287   320 49316.2048   11  341 34558.0170 51146.7283  48.0%  5035  363s
   319   356 49216.2474   11  353 34558.0170 51146.7283  48.0%  4904  380s
   357   395 49197.9808   11  305 34558.0170 51146.7283  48.0%  4861  387s
   398   436 48931.1817    9  302 34558.0170 51146.7283  48.0%  4658  395s
   441   478 49248.6559   11  335 34558.0170 51146.7283  48.0%  4537  405s
   483   514 49091.4319   12  341 34558.0170 51146.7283  48.0%  4376  412s
   523   561 48241.2267   12  327 34558.0170 51146.7283  48.0%  4263  420s
   570   600 49034.0688   12  339 34558.0170 51146.7283  48.0%  4106  432s
   611   638 48990.9433   12  325 34558.0170 51146.7283  48.0%  4004  441s
   655   683 48079.8636   12  285 34558.0170 51146.7283  48.0%  3929  451s
   704   723 47456.6375   22  303 34558.0170 51146.7283  48.0%  3813  460s
   746   765 48996.3305   12  326 34558.0170 51146.7283  48.0%  3752  468s
   794   804 49034.3167   13  341 34558.0170 51146.7283  48.0%  3641  477s
   839   850 48411.4190   13  330 34558.0170 51146.7283  48.0%  3557  483s
   887   895 48123.5422   13  320 34558.0170 51146.7283  48.0%  3471  489s
   940   921 47428.9915   13  325 34558.0170 51146.7283  48.0%  3411  513s
   980   951 48839.3003   14  337 34558.0170 51146.7283  48.0%  3374  524s
  1020   985 48209.6683   13  259 34558.0170 51146.7283  48.0%  3378  533s
  1067  1017 47822.8395   15  282 34558.0170 51146.7283  48.0%  3347  543s
  1107  1039 47851.5634   15  337 34558.0170 51079.9987  47.8%  3335  555s
  1157  1078 47712.2795   16  269 34558.0170 51079.9987  47.8%  3355  566s
  1206  1130 45867.5146   17  269 34558.0170 51079.9987  47.8%  3373  577s
  1270  1187 43966.8986   16  292 34558.0170 51079.9987  47.8%  3332  586s
  1355  1232 46271.3415   16  302 34558.0170 50857.9118  47.2%  3240  598s
  1446  1274 45433.6080   17  275 34558.0170 50857.9118  47.2%  3153  611s
H 1489  1274                    34612.865417 50857.9118  46.9%  3136  611s
  1514  1307 45830.5630   16  329 34612.8654 50857.9118  46.9%  3133  621s
H 1518  1307                    34637.646411 50857.9118  46.8%  3132  621s
H 1522  1307                    34655.984299 50857.9118  46.8%  3136  621s
H 1525  1307                    34737.867166 50857.9118  46.4%  3139  621s
  1547  1420 45781.8853   18  261 34737.8672 50857.9118  46.4%  3164  637s
  1698  1596 45302.5343   19  292 34737.8672 50857.9118  46.4%  3091  650s
  1890  1752 45098.7621   20  253 34737.8672 50857.9118  46.4%  2965  663s
  2080  1897 45052.5526   20  230 34737.8672 50857.9118  46.4%  2886  678s
  2291  2051 44998.2343   21  277 34737.8672 50857.9118  46.4%  2801  693s
  2507  2189 43485.5769   22  321 34737.8672 50857.9118  46.4%  2730  708s
  2697  2292 43624.1427   22  237 34737.8672 50038.2611  44.0%  2704  722s
H 2710  2254                    35625.250344 50038.2611  40.5%  2713  722s
  2849  2343 42884.7145   23  311 35625.2503 49945.6025  40.2%  2710  740s
  2976  2492 42467.0054   24  299 35625.2503 49945.6025  40.2%  2757  758s
  3141  2674 38986.1088   24  140 35625.2503 49945.6025  40.2%  2772  773s
H 3363  2657                    35796.164183 49857.3691  39.3%  2738  785s
  3364  2658 40735.3240   45  366 35796.1642 49857.3691  39.3%  2737  855s
  3366  2659 39238.9064   49  126 35796.1642 49857.3691  39.3%  2736  902s
  3367  2660 47456.4210   21  284 35796.1642 49857.3691  39.3%  2735  922s
H 3367  2526                    35797.381734 49857.3691  39.3%  2735  940s
  3369  2527 44055.4525   21  342 35797.3817 49857.3691  39.3%  2733  948s
  3370  2528 36402.8441   55  381 35797.3817 49857.3691  39.3%  2733  953s
  3371  2529 46799.5971   30  367 35797.3817 49857.3691  39.3%  2732  959s
  3372  2529 38090.6836   66  362 35797.3817 49857.3691  39.3%  2731  965s
  3374  2531 46993.1983   21  364 35797.3817 49857.3691  39.3%  2729  971s
  3375  2531 43605.4768   23  405 35797.3817 49857.3691  39.3%  2728  975s
  3378  2533 36478.9710   43  368 35797.3817 49857.3691  39.3%  2726  984s
  3379  2534 48175.3368   17  376 35797.3817 49857.3691  39.3%  2725  986s
  3381  2535 36856.0701   31  375 35797.3817 49857.3691  39.3%  2724  993s
  3382  2536 47312.8262   18  449 35797.3817 49857.3691  39.3%  2723  996s
  3383  2537 43276.5428   18  372 35797.3817 49857.3691  39.3%  2722 1000s
  3385  2538 46391.1916   13  432 35797.3817 49857.3691  39.3%  2720 1007s
  3386  2539 44738.2724    9  362 35797.3817 49857.3691  39.3%  2720 1010s
  3388  2540 38123.9232   32  375 35797.3817 49857.3691  39.3%  2718 1016s
  3389  2541 48184.7610   16  372 35797.3817 49857.3691  39.3%  2717 1020s
  3391  2542 38112.7353   50  374 35797.3817 49857.3691  39.3%  2716 1025s
  3393  2543 44936.0637   23  368 35797.3817 49857.3691  39.3%  2714 1030s
  3396  2545 37709.2899   36  373 35797.3817 49857.3691  39.3%  2712 1070s
  3397  2546 37624.3332   46  373 35797.3817 49857.3691  39.3%  2711 1095s
  3398  2550 49857.3691   11  362 35797.3817 49857.3691  39.3%  2769 1114s
  3400  2553 49857.3691   12  368 35797.3817 49857.3691  39.3%  2772 1129s
  3404  2560 49857.3691   13  362 35797.3817 49857.3691  39.3%  2777 1147s
  3412  2573 49857.3691   14  378 35797.3817 49857.3691  39.3%  2795 1164s
  3428  2584 49733.5783   15  351 35797.3817 49857.3691  39.3%  2849 1203s
  3444  2610 48436.9629   16  328 35797.3817 49857.3691  39.3%  2900 1217s
H 3454  2480                    35797.812299 49857.3691  39.3%  2916 1217s
H 3457  2357                    35803.149895 49857.3691  39.3%  2920 1217s
  3476  2456 48157.6199   17  325 35803.1499 49857.3691  39.3%  2938 1236s
  3587  2474 46242.1064   20  270 35803.1499 49857.3691  39.3%  3034 1248s
H 3603  2353                    35809.483376 49857.3691  39.2%  3043 1248s
H 3613  2240                    35813.410841 49857.3691  39.2%  3046 1248s
  3647  2274 45759.3080   20  293 35813.4108 49857.3691  39.2%  3067 1262s
  3707  2276 46024.3716   18  279 35813.4108 49857.3691  39.2%  3102 1273s
  3741  2296 46961.5652   19  282 35813.4108 49857.3691  39.2%  3119 1283s
  3786  2302 44148.5538   21  307 35813.4108 49857.3691  39.2%  3127 1299s
  3836  2303 43449.0782   21  233 35813.4108 49857.3691  39.2%  3130 1311s
H 3871  2187                    35878.624294 49857.3691  39.0%  3144 1311s
  3880  2208 36397.2641   22  197 35878.6243 49857.3691  39.0%  3147 1326s
  3951  2203 45167.2517   21  272 35878.6243 49857.3691  39.0%  3163 1338s
H 3999  2088                    36366.431164 49857.3691  37.1%  3178 1338s
  4013  2090 43419.4187   21  344 36366.4312 49857.3691  37.1%  3180 1350s
H 4086  1983                    36503.409841 49857.3691  36.6%  3183 1361s
H 4103  1888                    36591.537983 49857.3691  36.3%  3185 1361s
  4147  1891 39758.6003   22  251 36591.5380 49857.3691  36.3%  3199 1377s
H 4201  1821                    36697.228262 49857.3691  35.9%  3225 1393s
H 4208  1738                    37148.246417 49857.3691  34.2%  3230 1393s
  4263  1742 38773.7400   25  153 37148.2464 49857.3691  34.2%  3243 1411s
  4326  1744     cutoff   27      37148.2464 49857.3691  34.2%  3262 1423s
H 4342  1662                    37271.818542 49857.3691  33.8%  3263 1423s
  4398  1675 42648.7479   20  228 37271.8185 49857.3691  33.8%  3276 1437s
  4455  1673 42412.9998   21  264 37271.8185 49857.3691  33.8%  3295 1449s
H 4461  1599                    37273.377802 49857.3691  33.8%  3300 1449s
  4503  1604 41934.5778   22  209 37273.3778 49857.3691  33.8%  3312 1462s
H 4572  1546                    37318.811207 49857.3691  33.6%  3333 1476s
H 4613  1467                    37319.102830 49857.3691  33.6%  3350 1476s
H 4636  1397                    37327.485286 49857.3691  33.6%  3359 1476s
  4638  1441 37962.3570   26  190 37327.4853 49857.3691  33.6%  3362 1494s
  4719  1446 42512.9015   19  226 37327.4853 49588.6306  32.8%  3382 1508s
H 4724  1385                    37328.261094 49588.6306  32.8%  3381 1508s
  4794  1376 41963.2710   21  256 37328.2611 49588.6306  32.8%  3402 1525s
  4840  1379 39991.3950   22  236 37328.2611 49588.6306  32.8%  3406 1539s
  4888  1385 39701.1261   23  197 37328.2611 49588.6306  32.8%  3418 1556s
  4936  1388     cutoff   24      37328.2611 48421.0195  29.7%  3427 1572s
  4989  1387 38269.0564   24  196 37328.2611 48421.0195  29.7%  3440 1588s
  5063  1374     cutoff   25      37328.2611 48421.0195  29.7%  3441 1604s
  5151  1362 43257.5863   21  274 37328.2611 48140.6712  29.0%  3448 1623s
  5246  1377     cutoff   23      37328.2611 47113.3022  26.2%  3457 1641s
  5330  1396 41899.1937   23  176 37328.2611 47113.3022  26.2%  3487 1661s
  5439  1384 39242.9221   25  222 37328.2611 47113.3022  26.2%  3504 1679s
  5514  1390     cutoff   28      37328.2611 47098.2924  26.2%  3516 1700s
  5635  1372 43588.4391   20  239 37328.2611 47098.2924  26.2%  3535 1723s
  5721  1398 43175.4464   21  254 37328.2611 47098.2924  26.2%  3538 1750s
  5840  1400 39705.1500   24  216 37328.2611 46846.5906  25.5%  3563 1773s
  5995  1373     cutoff   24      37328.2611 46714.5635  25.1%  3580 1799s
  6141  1372 43548.1438   19  287 37328.2611 46659.5999  25.0%  3609 1823s
  6272  1353 39690.1752   21  324 37328.2611 46659.5999  25.0%  3648 1849s
  6465  1348 37528.6187   23  301 37328.2611 46659.5999  25.0%  3653 1874s
  6659  1341     cutoff   21      37328.2611 46035.7049  23.3%  3664 1902s
  6855  1345 39634.0822   20  306 37328.2611 46015.4832  23.3%  3673 1932s
  7110  1388     cutoff   23      37328.2611 45802.0673  22.7%  3664 1959s
  7361  1436 40395.7831   21  269 37328.2611 45667.4418  22.3%  3662 1989s
  7598  1473 37568.7053   24  260 37328.2611 45373.0414  21.6%  3674 2021s
  7848  1467     cutoff   25      37328.2611 45058.0273  20.7%  3683 2050s
  7924  1499 40738.7401   21  290 37328.2611 44974.9521  20.5%  3690 2082s
  8125  1551 41278.9879   20  276 37328.2611 44904.5345  20.3%  3695 2118s
  8414  1575     cutoff   26      37328.2611 44863.3068  20.2%  3702 2148s
  8631  1618 38249.3406   25  264 37328.2611 44822.3764  20.1%  3695 2185s
  8967  1660 39719.6015   23  234 37328.2611 44428.3830  19.0%  3684 2221s
  9306  1693 37509.2929   21  325 37328.2611 44311.9842  18.7%  3681 2259s
  9633  1725 40027.2834   24  321 37328.2611 43950.9319  17.7%  3694 2299s
 10009  1733 infeasible   23      37328.2611 43847.7615  17.5%  3691 2338s
 10443  1766 38408.3044   22  222 37328.2611 43506.2274  16.6%  3673 2380s
 10855  1793     cutoff   26      37328.2611 43412.1242  16.3%  3670 2435s
 11275  1821 38459.1928   21  213 37328.2611 43155.2154  15.6%  3669 2480s
 11731  1840 39661.8907   22  228 37328.2611 42960.9471  15.1%  3664 2528s
 12206  1847 38877.5234   24  233 37328.2611 42808.0220  14.7%  3662 2575s
 12692  1853 37439.7994   27  189 37328.2611 42739.2559  14.5%  3659 2624s
 13243  1843     cutoff   21      37328.2611 42399.9148  13.6%  3644 2679s
 13809  1834 39508.1757   22  363 37328.2611 41966.4404  12.4%  3632 2735s
 14319  1841     cutoff   22      37328.2611 41792.9763  12.0%  3614 2794s
 14865  1790 38216.6058   28  308 37328.2611 41579.3058  11.4%  3615 2852s
 15520  1698     cutoff   25      37328.2611 41280.6420  10.6%  3602 2909s
 16189  1583     cutoff   22      37328.2611 41034.7871  9.93%  3589 2973s
 16901  1389 38101.1055   24  201 37328.2611 40807.7056  9.32%  3571 3043s
 17692  1183 38093.1180   26  301 37328.2611 40509.8902  8.52%  3546 3109s
 18429   819     cutoff   23      37328.2611 40151.5660  7.56%  3526 3179s
 19343   729     cutoff   29      37328.2611 39698.8264  6.35%  3491 3235s
 19529   221 37655.2589   30  206 37328.2611 39694.6388  6.34%  3485 3289s
 20598     4 38157.1339   22  311 37328.2611 39231.1146  5.10%  3370 3321s

Cutting planes:
  Learned: 1
  MIR: 638
  Mixing: 1
  Flow cover: 1461
  RLT: 23
  Relax-and-lift: 141

Explored 21470 nodes (70014488 simplex iterations) in 3321.72 seconds (10395.42 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 37328.3 37327.5 37319.1 ... 36503.4

Optimal solution found (tolerance 1.00e-04)
Best objective 3.732826109414e+04, best bound 3.732826109414e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3321.73s
  Master Objective (UB) = 37328.26, θ = 189844.21
  Upper Bound (UB) = 37328.26

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 189844.21
  [DEBUG]   ✓ Scenario 0: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 189844.21 ≤ Q = 189844.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x10f4a4e2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xef0b5b1e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-14, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.389622e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6892719.6866
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.584969e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158496.94    0  125 6892719.69 -158496.94   102%     -    0s
H    0     0                    -122258.1296 -158496.94  29.6%     -    0s
H    0     0                    -123017.1295 -158496.94  28.8%     -    0s
H    0     0                    -124144.3412 -158496.94  27.7%     -    0s
H    0     0                    -124829.6354 -137924.94  10.5%     -    0s
     0     0 -137924.94    0   84 -124829.64 -137924.94  10.5%     -    0s
H    0     0                    -135201.2609 -137874.22  1.98%     -    0s
     0     0 -137309.44    0   85 -135201.26 -137309.44  1.56%     -    0s
     0     0 -137300.70    0   85 -135201.26 -137300.70  1.55%     -    0s
     0     0 -136624.96    0   69 -135201.26 -136624.96  1.05%     -    0s
H    0     0                    -135277.1149 -136613.96  0.99%     -    0s
H    0     0                    -135661.0716 -136613.96  0.70%     -    0s
     0     0 -136559.76    0   69 -135661.07 -136559.76  0.66%     -    0s
H    0     0                    -135707.3733 -136559.56  0.63%     -    0s
     0     0 -136559.56    0   69 -135707.37 -136559.56  0.63%     -    0s
     0     0 -136195.49    0   50 -135707.37 -136195.49  0.36%     -    0s
     0     0 -136153.94    0   49 -135707.37 -136153.94  0.33%     -    0s
     0     0 -136068.49    0   55 -135707.37 -136068.49  0.27%     -    0s
     0     0 -136046.13    0   48 -135707.37 -136046.13  0.25%     -    0s
     0     0 -136021.76    0   51 -135707.37 -136021.76  0.23%     -    0s
     0     0 -136001.33    0   51 -135707.37 -136001.33  0.22%     -    0s
     0     0 -135998.10    0   50 -135707.37 -135998.10  0.21%     -    0s
     0     0 -135993.09    0   48 -135707.37 -135993.09  0.21%     -    0s
     0     0 -135837.50    0   25 -135707.37 -135837.50  0.10%     -    0s
     0     0 -135822.27    0   16 -135707.37 -135822.27  0.08%     -    0s
     0     0 -135815.43    0   11 -135707.37 -135815.43  0.08%     -    0s
H    0     0                    -135766.3499 -135813.53  0.03%     -    0s
     0     0 -135813.53    0   11 -135766.35 -135813.53  0.03%     -    0s
     0     0 -135791.40    0    6 -135766.35 -135791.40  0.02%     -    0s
     0     0 -135781.21    0    4 -135766.35 -135781.21  0.01%     -    0s
H    0     0                    -135768.7206 -135781.21  0.01%     -    0s

Explored 1 nodes (687 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135769 -135769 -135766 ... -123017

Optimal solution found (tolerance 1.00e-04)
Best objective -1.357687206305e+05, best bound -1.357812075111e+05, gap 0.0092%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 178650.94
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135768.72
  [DEBUG]   S×d_nominal = 314419.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314419.66 + -135768.72 = 178650.94
  [DEBUG]   Current θ from Master = 189844.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11193.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26134.99
  Lower Bound (LB) = 28726.80
  Gap (UB-LB) = 8601.4660, Absolute Gap = 8601.4660, Relative Gap = 0.230428
  Not converged yet (gap = 8601.47 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x6be86efb
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 1.22s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32101   -3.1682514e+04   0.000000e+00   3.525324e+07      5s
   46430    1.6419753e+04   0.000000e+00   3.354356e+06     10s
   56099    2.4247493e+04   0.000000e+00   4.394276e+06     15s
   62176    2.4833345e+04   0.000000e+00   3.531995e+08     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 6.432557e+04, 42671 iterations, 20.00 seconds (41.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 64325.5702    0  136 -170340.08 64325.5702   138%     -   22s
H    0     0                    -161668.8626 64325.5702   140%     -   22s
H    0     0                    -32815.30939 64325.5702   296%     -   22s
H    0     0                    5301.8323424 64325.5702  1113%     -   22s
H    0     0                    6946.5028501 64325.5702   826%     -   23s
H    0     0                    8720.5308154 64325.5702   638%     -   23s
H    0     0                    14833.543754 64325.5702   334%     -   23s
H    0     0                    14858.820990 64325.5702   333%     -   23s
H    0     0                    16363.089665 64325.5702   293%     -   23s
H    0     0                    17550.284469 64325.5702   267%     -   23s
     0     0 59401.1214    0  210 17550.2845 59401.1214   238%     -   37s
H    0     0                    17944.386809 59401.1214   231%     -   38s
H    0     0                    18057.473584 59401.1214   229%     -   38s
H    0     0                    19103.624521 59401.1214   211%     -   38s
H    0     0                    19140.082406 59401.1214   210%     -   38s
H    0     0                    19228.736828 59401.1214   209%     -   38s
H    0     0                    19234.661611 59401.1214   209%     -   38s
H    0     0                    19476.253026 59401.1214   205%     -   38s
H    0     0                    19527.216682 59401.1214   204%     -   38s
     0     0 59262.9957    0  187 19527.2167 59262.9957   203%     -   43s
     0     0 59161.1635    0  216 19527.2167 59161.1635   203%     -   44s
     0     0 59127.8878    0  226 19527.2167 59127.8878   203%     -   45s
     0     0 59127.8878    0  189 19527.2167 59127.8878   203%     -   46s
     0     0 59127.8878    0  199 19527.2167 59127.8878   203%     -   47s
     0     0 59127.8878    0  202 19527.2167 59127.8878   203%     -   48s
     0     0 59127.8878    0  201 19527.2167 59127.8878   203%     -   52s
     0     0 59127.8878    0  207 19527.2167 59127.8878   203%     -   54s
     0     0 59127.8878    0  203 19527.2167 59127.8878   203%     -   54s
     0     0 56923.9187    0  254 19527.2167 56923.9187   192%     -   67s
H    0     0                    22980.948823 56923.9187   148%     -   68s
H    0     0                    25086.707940 56923.9187   127%     -   68s
H    0     0                    25165.136473 56923.9187   126%     -   68s
     0     0 56679.3267    0  263 25165.1365 56679.3267   125%     -   74s
     0     0 56399.2433    0  273 25165.1365 56399.2433   124%     -   79s
     0     0 56314.0142    0  273 25165.1365 56314.0142   124%     -   82s
     0     0 56238.8483    0  282 25165.1365 56238.8483   123%     -   85s
     0     0 56188.7170    0  277 25165.1365 56188.7170   123%     -   86s
     0     0 56181.8672    0  283 25165.1365 56181.8672   123%     -   86s
     0     0 56128.3570    0  273 25165.1365 56128.3570   123%     -   87s
     0     0 56126.3186    0  275 25165.1365 56126.3186   123%     -   88s
     0     0 56125.6761    0  279 25165.1365 56125.6761   123%     -   88s
     0     0 54591.5546    0  297 25165.1365 54591.5546   117%     -  108s
H    0     0                    25206.247446 54591.5442   117%     -  108s
H    0     0                    25356.676629 54591.5442   115%     -  108s
H    0     0                    26731.420630 54190.2557   103%     -  117s
H    0     0                    27170.550884 54190.2557  99.4%     -  117s
     0     0 54190.2557    0  302 27170.5509 54190.2557  99.4%     -  117s
     0     0 53821.0495    0  312 27170.5509 53821.0495  98.1%     -  128s
     0     0 53678.5855    0  340 27170.5509 53678.5855  97.6%     -  133s
     0     0 53635.7166    0  317 27170.5509 53635.7166  97.4%     -  136s
     0     0 53595.6787    0  312 27170.5509 53595.6787  97.3%     -  138s
     0     0 53567.4446    0  326 27170.5509 53567.4446  97.2%     -  140s
     0     0 53560.3443    0  326 27170.5509 53560.3443  97.1%     -  142s
     0     0 53559.8817    0  327 27170.5509 53559.8817  97.1%     -  142s
     0     0 52790.0502    0  356 27170.5509 52790.0502  94.3%     -  158s
     0     0 52688.9760    0  346 27170.5509 52688.9760  93.9%     -  162s
     0     0 52613.3689    0  349 27170.5509 52613.3689  93.6%     -  165s
     0     0 52580.5076    0  345 27170.5509 52580.5076  93.5%     -  167s
     0     0 52564.5840    0  383 27170.5509 52564.5840  93.5%     -  169s
     0     0 52549.3737    0  385 27170.5509 52549.3737  93.4%     -  170s
     0     0 52540.1285    0  383 27170.5509 52540.1285  93.4%     -  171s
     0     0 52535.9633    0  393 27170.5509 52535.9633  93.4%     -  172s
     0     0 52534.6879    0  390 27170.5509 52534.6879  93.4%     -  173s
     0     0 52411.2544    0  369 27170.5509 52411.2544  92.9%     -  178s
H    0     0                    27207.097506 52411.0556  92.6%     -  178s
     0     0 52388.8764    0  411 27207.0975 52388.8764  92.6%     -  180s
     0     0 52384.9250    0  377 27207.0975 52384.9250  92.5%     -  181s
     0     0 52383.3539    0  378 27207.0975 52383.3539  92.5%     -  182s
     0     0 52381.4733    0  380 27207.0975 52381.4733  92.5%     -  182s
     0     0 52380.4928    0  379 27207.0975 52380.4928  92.5%     -  183s
     0     0 52357.0468    0  408 27207.0975 52357.0468  92.4%     -  186s
H    0     0                    27236.703871 52356.8326  92.2%     -  188s
     0     0 52336.2447    0  373 27236.7039 52336.2447  92.2%     -  190s
     0     0 52334.2311    0  380 27236.7039 52334.2311  92.1%     -  190s
     0     0 52332.3992    0  379 27236.7039 52332.3992  92.1%     -  191s
     0     0 52332.1792    0  381 27236.7039 52332.1792  92.1%     -  192s
     0     0 52320.9973    0  375 27236.7039 52320.9973  92.1%     -  195s
     0     0 52316.2206    0  379 27236.7039 52316.2206  92.1%     -  196s
     0     0 52312.9504    0  373 27236.7039 52312.9504  92.1%     -  197s
     0     0 52312.0118    0  369 27236.7039 52312.0118  92.1%     -  197s
     0     0 52306.7755    0  382 27236.7039 52306.7755  92.0%     -  199s
H    0     0                    27240.530515 52304.4660  92.0%     -  200s
H    0     0                    27352.082680 52304.4660  91.2%     -  201s
H    0     0                    27541.623051 52304.4660  89.9%     -  201s
     0     0 52304.4660    0  382 27541.6231 52304.4660  89.9%     -  201s
     0     0 52304.0855    0  382 27541.6231 52304.0855  89.9%     -  201s
     0     0 52302.4415    0  382 27541.6231 52302.4415  89.9%     -  202s
     0     0 52300.7149    0  382 27541.6231 52300.7149  89.9%     -  203s
     0     0 52299.2125    0  375 27541.6231 52299.2125  89.9%     -  205s
H    0     0                    27561.808545 52298.9450  89.8%     -  207s
     0     0 52297.9668    0  380 27561.8085 52297.9668  89.7%     -  208s
     0     0 52297.3967    0  380 27561.8085 52297.3967  89.7%     -  209s
     0     0 52296.4722    0  380 27561.8085 52296.4722  89.7%     -  210s
     0     2 52296.4722    0  380 27561.8085 52296.4722  89.7%     -  249s
     1     3 51983.4511    1  358 27561.8085 52296.1201  89.7%  9112  255s
     2     4 51999.3718    1  397 27561.8085 51999.3718  88.7%  6050  262s
     3     6 50952.0042    2  345 27561.8085 51999.2165  88.7%  6022  269s
     5    11 50086.7750    3  357 27561.8085 51999.2165  88.7%  7120  280s
    10    21 49918.0737    4  353 27561.8085 51214.6983  85.8%  8269  292s
    20    31 49672.7500    4  336 27561.8085 51213.2387  85.8% 12359  315s
    30    62 48804.9691    5  337 27561.8085 51057.4482  85.2% 11599  343s
H   50    62                    28140.177470 51057.0937  81.4% 10119  343s
    61    94 48683.0422    6  329 28140.1775 50850.6285  80.7% 13132  352s
    93   171 48572.5144    7  322 28140.1775 50674.2081  80.1% 11989  369s
   170   250 48468.7568    9  324 28140.1775 50673.6406  80.1%  9399  381s
   249   282 47197.6625   11  284 28140.1775 50673.6406  80.1%  7672  391s
   281   315 42924.1267   12  233 28140.1775 50673.6406  80.1%  7369  408s
H  291   315                    28249.992393 50673.6406  79.4%  7230  408s
   314   395 42906.4514   13  238 28249.9924 50673.6406  79.4%  7022  424s
   394   455 42240.8706   18  160 28249.9924 50673.6406  79.4%  6370  437s
   454   521 41728.2045   21  241 28249.9924 50673.6406  79.4%  6177  447s
   524   584 41043.0446   26  149 28249.9924 50673.6406  79.4%  6100  458s
   587   640 37980.5078   31  176 28249.9924 50673.6406  79.4%  6031  470s
H  606   640                    29630.728186 50673.6406  71.0%  5981  470s
   651   674 37810.7357   33  213 29630.7282 50673.6406  71.0%  5968  484s
   701   723 37217.6819   35  197 29630.7282 50673.6406  71.0%  6016  498s
   750   780 36836.6401   40  190 29630.7282 50673.6406  71.0%  6124  508s
   811   827 32163.0740   45   35 29630.7282 50673.6406  71.0%  6219  518s
   872   886 31950.0344   51   19 29630.7282 50673.6406  71.0%  6207  528s
   935   943 31526.8008   57   17 29630.7282 50673.6406  71.0%  6202  537s
  1009   994 30772.3987   63   33 29630.7282 50673.6406  71.0%  6218  548s
  1092  1055     cutoff   64      29630.7282 50482.2918  70.4%  6148  560s
H 1171  1100                    29641.285554 50481.3064  70.3%  6159  571s
H 1193  1100                    30285.068702 50481.3064  66.7%  6103  571s
H 1199  1100                    30997.107656 50481.3064  62.9%  6100  571s
  1226  1154 37040.8632   31  201 30997.1077 50481.3064  62.9%  6166  583s
  1314  1178 38015.0606   17  278 30997.1077 50481.3064  62.9%  6140  593s
H 1315  1178                    31497.932095 50481.3064  60.3%  6136  593s
H 1316  1178                    31628.794422 50481.3064  59.6%  6133  593s
  1354  1255 37702.2967   18  263 31628.7944 50481.3064  59.6%  6208  606s
  1452  1306 35629.5984   20  171 31628.7944 50481.3064  59.6%  6231  618s
  1561  1360 35296.2008   19  260 31628.7944 50481.3064  59.6%  6188  631s
  1659  1437 34145.5919   20  238 31628.7944 50481.3064  59.6%  6198  645s
  1768  1505 33464.6834   22  222 31628.7944 50481.3064  59.6%  6168  658s
  1886  1589 32505.5611   24  265 31628.7944 50481.3064  59.6%  6170  672s
  2032  1611 45757.6206   10  373 31628.7944 50481.3064  59.6%  6113  684s
H 2051  1611                    33075.310693 50481.3064  52.6%  6130  684s
  2072  1693 44741.8431   11  373 33075.3107 50481.3064  52.6%  6156  698s
  2229  1774 42410.2125   12  322 33075.3107 50481.3064  52.6%  6084  713s
  2368  1826 41238.3852   14  234 33075.3107 50481.3064  52.6%  6080  730s
  2489  1850 39135.8749   17  220 33075.3107 50481.3064  52.6%  6132  746s
  2636  1884 34874.9231   20  137 33075.3107 50481.3064  52.6%  6065  763s
  2774  1968 33796.0649   26   56 33075.3107 50481.3064  52.6%  6079  782s
  2926  2072 46029.6820   13  283 33075.3107 50481.3064  52.6%  6090  800s
  3097  2100 40809.3573   16  182 33075.3107 49801.8627  50.6%  6066  816s
H 3099  2006                    33680.199875 49801.8627  47.9%  6062  816s
  3133  2026 43189.9994   16  241 33680.1999 49417.6144  46.7%  6085  833s
H 3134  1958                    33923.126453 49417.6144  45.7%  6083  833s
H 3136  1920                    34199.927525 49417.6144  44.5%  6083  833s
H 3146  1852                    34525.002511 49417.6144  43.1%  6103  833s
H 3151  1771                    34998.983503 49417.6144  41.2%  6097  833s
  3176  1799 42565.4052   15  222 34998.9835 49417.6144  41.2%  6116  854s
  3358  1864 41911.8296   19  231 34998.9835 49417.6144  41.2%  6060  873s
  3517  1921 40357.4904   21  205 34998.9835 49417.6144  41.2%  6116  895s
H 3662  1910                    35344.096712 49417.6144  39.8%  6181  916s
H 3666  1895                    35479.116806 49417.6144  39.3%  6186  916s
H 3670  1869                    35707.143248 49417.6144  38.4%  6187  916s
  3749  1936 38036.7164   23  134 35707.1432 49148.1965  37.6%  6196  938s
  3874  2032     cutoff   23      35707.1432 48955.3233  37.1%  6321  960s
  4066  2093 36830.4283   29  100 35707.1432 48867.9099  36.9%  6328  982s
  4253  2176 45401.4732    8  304 35707.1432 48867.9099  36.9%  6369 1006s
  4454  2257 40136.0927   11  151 35707.1432 48867.9099  36.9%  6408 1031s
  4696  2266 37153.5852   15  162 35707.1432 48867.9099  36.9%  6406 1051s
  4751  2287     cutoff   16      35707.1432 48867.9099  36.9%  6411 1076s
H 4764  2248                    35834.654713 48867.9099  36.4%  6410 1076s
  4836  2287     cutoff   17      35834.6547 48867.9099  36.4%  6409 1102s
  4994  2361 38065.7034   16  135 35834.6547 48762.2757  36.1%  6383 1129s
  5232  2466 36766.9824   32   94 35834.6547 48702.1018  35.9%  6398 1161s
  5435  2467 43224.5053   22  380 35834.6547 48702.1018  35.9%  6496 1213s
  5437  2468 36940.6029   16  136 35834.6547 48702.1018  35.9%  6494 1273s
  5438  2469 43124.1649   16  297 35834.6547 48702.1018  35.9%  6493 1305s
  5439  2470 37360.9113   31  316 35834.6547 48702.1018  35.9%  6492 1328s
  5440  2470 36450.9944   20  322 35834.6547 48702.1018  35.9%  6490 1339s
  5441  2471 46857.9617   11  363 35834.6547 48702.1018  35.9%  6489 1347s
  5442  2472 38480.9704   19  355 35834.6547 48702.1018  35.9%  6488 1352s
  5443  2472 36986.1539   29  366 35834.6547 48702.1018  35.9%  6487 1356s
  5444  2473 44170.9970   15  367 35834.6547 48702.1018  35.9%  6486 1364s
  5445  2474 46913.5759   10  397 35834.6547 48702.1018  35.9%  6484 1371s
  5447  2475 36595.6817   23  397 35834.6547 48702.1018  35.9%  6482 1376s
  5449  2476 45485.5224   10  374 35834.6547 48702.1018  35.9%  6480 1382s
  5450  2477 44741.5085   17  378 35834.6547 48702.1018  35.9%  6479 1386s
  5451  2478 38162.7390   23  378 35834.6547 48702.1018  35.9%  6477 1391s
  5452  2478 40996.1172   17  406 35834.6547 48702.1018  35.9%  6476 1396s
  5454  2480 44977.5687   19  381 35834.6547 48702.1018  35.9%  6474 1404s
  5455  2480 37159.1423   21  363 35834.6547 48702.1018  35.9%  6473 1407s
  5456  2481 38961.1761   18  375 35834.6547 48702.1018  35.9%  6471 1413s
  5457  2482 36956.9536   34  385 35834.6547 48702.1018  35.9%  6470 1417s
  5458  2482 42020.2869   16  382 35834.6547 48702.1018  35.9%  6469 1423s
  5459  2483 38975.9671   30  375 35834.6547 48702.1018  35.9%  6468 1426s
  5460  2484 46320.7212   13  375 35834.6547 48702.1018  35.9%  6467 1438s
  5461  2484 39006.8174   21  380 35834.6547 48702.1018  35.9%  6465 1440s
  5462  2485 46740.7371   10  375 35834.6547 48702.1018  35.9%  6464 1446s
  5464  2486 38262.4493   39  378 35834.6547 48702.1018  35.9%  6462 1457s
  5465  2487 46913.5759   10  425 35834.6547 48702.1018  35.9%  6461 1461s
  5466  2488 36524.2081   28  434 35834.6547 48702.1018  35.9%  6460 1466s
  5467  2488 42140.4841   14  434 35834.6547 48702.1018  35.9%  6458 1514s
  5468  2489 44410.0935   18  434 35834.6547 48702.1018  35.9%  6457 1574s
  5469  2493 48702.1018   15  400 35834.6547 48702.1018  35.9%  6506 1597s
  5471  2496 48702.1018   16  354 35834.6547 48702.1018  35.9%  6506 1615s
  5475  2503 48702.1018   17  419 35834.6547 48702.1018  35.9%  6511 1634s
  5483  2516 48702.1018   18  393 35834.6547 48702.1018  35.9%  6515 1654s
  5499  2527 48702.1018   19  291 35834.6547 48702.1018  35.9%  6551 1711s
  5515  2553 47607.7726   20  251 35834.6547 48702.1018  35.9%  6566 1735s
  5547  2579 47087.3534   21  289 35834.6547 48702.1018  35.9%  6585 1755s
  5583  2609 47015.4527   22  285 35834.6547 48702.1018  35.9%  6587 1777s
H 5626  2533                    35852.854321 48702.1018  35.8%  6568 1798s
  5704  2547 44685.5622   24  226 35852.8543 48702.1018  35.8%  6565 1819s
  5771  2573 44951.3935   23  257 35852.8543 48702.1018  35.8%  6548 1839s
  5869  2560 44762.7363   24  216 35852.8543 48702.1018  35.8%  6508 1862s
  5947  2565 42683.8156   25  262 35852.8543 48702.1018  35.8%  6480 1880s
  6015  2569 42095.0909   27  271 35852.8543 48702.1018  35.8%  6471 1903s
  6086  2568 40891.8655   28  209 35852.8543 48702.1018  35.8%  6445 1924s
  6163  2577 37836.7850   31  157 35852.8543 48702.1018  35.8%  6420 1945s
  6236  2569 36602.7392   29  238 35852.8543 48702.1018  35.8%  6400 1960s
  6309  2562 36841.5002   33  146 35852.8543 48702.1018  35.8%  6371 1973s
  6349  2567     cutoff   32      35852.8543 48702.1018  35.8%  6365 1987s
  6402  2573 40608.8818   24  280 35852.8543 48702.1018  35.8%  6351 2005s
  6454  2576 40016.0041   25  260 35852.8543 48702.1018  35.8%  6333 2024s
  6518  2576 39164.5912   25  226 35852.8543 48702.1018  35.8%  6316 2040s
  6577  2579 38738.3814   26  214 35852.8543 48702.1018  35.8%  6299 2055s
  6644  2578 37791.7973   26  228 35852.8543 48702.1018  35.8%  6278 2069s
  6685  2580 37775.6382   27  200 35852.8543 48702.1018  35.8%  6272 2084s
  6732  2585 37396.5728   28  142 35852.8543 48702.1018  35.8%  6260 2101s
  6771  2594 36486.7934   28  160 35852.8543 48702.1018  35.8%  6256 2116s
  6815  2607 37346.4853   29  197 35852.8543 48702.1018  35.8%  6249 2132s
  6862  2620     cutoff   29      35852.8543 48702.1018  35.8%  6238 2153s
  6922  2636     cutoff   30      35852.8543 48572.3780  35.5%  6225 2172s
  7016  2645 36054.1576   32   99 35852.8543 48572.3780  35.5%  6193 2195s
  7106  2681 38518.3632   32  123 35852.8543 47999.4297  33.9%  6177 2219s
  7216  2690     cutoff   34      35852.8543 47999.4297  33.9%  6157 2242s
  7345  2686     cutoff   41      35852.8543 47929.4086  33.7%  6124 2269s
  7482  2696 42924.3411   23  369 35852.8543 47601.1168  32.8%  6088 2294s
  7630  2694 40611.4626   25  315 35852.8543 47323.4291  32.0%  6050 2321s
* 7726  2543              51    35869.307283 46693.6984  30.2%  6022 2321s
  7769  2589 38367.2287   28  255 35869.3073 46539.0797  29.7%  6019 2351s
  7927  2590 37115.3754   30  262 35869.3073 46527.6584  29.7%  5986 2379s
  8103  2578 42090.0215   26  260 35869.3073 46527.6584  29.7%  5942 2407s
  8274  2585 36855.1253   30  230 35869.3073 46081.0272  28.5%  5912 2437s
  8456  2625 39339.5081   24  247 35869.3073 46081.0272  28.5%  5876 2470s
  8670  2662 36789.4537   29  150 35869.3073 46081.0272  28.5%  5822 2501s
  8895  2669 40764.6383   26  225 35869.3073 46055.8716  28.4%  5764 2536s
  9107  2640     cutoff   32      35869.3073 46016.8164  28.3%  5727 2565s
H 9116  2524                    35937.956495 46016.8164  28.0%  5726 2565s
H 9152  2405                    36349.117422 46016.8164  26.6%  5716 2565s
  9237  2431 38436.3264   25  238 36349.1174 46016.8164  26.6%  5704 2603s
  9446  2423 41110.1491   25  307 36349.1174 46016.8164  26.6%  5674 2641s
  9663  2408 39062.5159   27  277 36349.1174 46016.8164  26.6%  5647 2678s
  9934  2377     cutoff   31      36349.1174 45222.9612  24.4%  5593 2716s
 10193  2387 39455.2147   26  228 36349.1174 45222.9612  24.4%  5559 2754s
*10411  2204             108    36409.949548 44856.9861  23.2%  5513 2754s
 10497  2240     cutoff   35      36409.9495 44856.9861  23.2%  5505 2796s
*10704  2061             135    36474.644614 44617.8008  22.3%  5470 2796s
 10772  2153 37078.6120   29  174 36474.6446 44454.7266  21.9%  5470 2837s
 11088  2182 38216.9164   29  303 36474.6446 44290.1095  21.4%  5422 2878s
 11418  2290 37451.2220   28  258 36474.6446 44269.7732  21.4%  5378 2922s
*11519  2241             123    36622.762762 44269.7732  20.9%  5358 2922s
*11526  2235             129    36645.964366 44269.7732  20.8%  5355 2922s
 11747  2261 38912.3675   26  265 36645.9644 44031.1529  20.2%  5344 2970s
 12091  2305 37220.2186   29  234 36645.9644 43962.5597  20.0%  5314 3016s
 12428  2340 37187.7782   26  228 36645.9644 43602.5083  19.0%  5293 3062s
 12800  2417     cutoff   26      36645.9644 43223.1760  17.9%  5255 3118s
 13220  2434 37412.7589   30  339 36645.9644 43059.3815  17.5%  5215 3173s
H13296  2434                    36652.126371 43059.3815  17.5%  5200 3173s
H13310  2373                    36822.695037 43059.3815  16.9%  5199 3173s
H13367  2331                    36937.104039 43059.3815  16.6%  5192 3173s
 13686  2317     cutoff   28      36937.1040 42934.0924  16.2%  5162 3228s
H13753  2268                    37069.911463 42934.0924  15.8%  5154 3228s
 14088  2300 38117.6832   23  214 37069.9115 42898.7837  15.7%  5133 3291s
 14596  2302     cutoff   25      37069.9115 42596.0675  14.9%  5081 3349s
 14928  2282 38094.3940   27  305 37069.9115 42375.4202  14.3%  5065 3416s
 15435  2275     cutoff   27      37069.9115 42126.5818  13.6%  5025 3480s
 15951  2259 infeasible   29      37069.9115 42126.5818  13.6%  4992 3549s
 16414  2201 38354.5509   28  248 37069.9115 41879.4075  13.0%  4967 3600s

Cutting planes:
  MIR: 632
  Mixing: 2
  Flow cover: 1602
  RLT: 26
  Relax-and-lift: 175

Explored 16873 nodes (83486738 simplex iterations) in 3600.05 seconds (11162.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 37069.9 36937.1 36822.7 ... 35938

Time limit reached
Best objective 3.706991146321e+04, best bound 4.147819398584e+04, gap 11.8918%
  WARNING: Time limit reached. Using best solution found (gap: 11.89%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 37069.91, θ = 189597.66
  Upper Bound (UB) = 37069.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 189597.66
  [DEBUG]   ✓ Scenario 0: θ = 189597.66 ≤ Q = 189597.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 189597.66 ≤ Q = 189597.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 189597.66 ≤ Q = 189597.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 189597.66 ≤ Q = 189597.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 189597.66 ≤ Q = 189597.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 189597.66 ≤ Q = 189597.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 189597.66 ≤ Q = 189597.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 189597.66 ≤ Q = 189597.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 189597.66 ≤ Q = 189597.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x39757980
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc68a8680
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.403884e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6878206.0594
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.607624e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160762.41    0  127 6878206.06 -160762.41   102%     -    0s
H    0     0                    -123842.5557 -160762.41  29.8%     -    0s
H    0     0                    -125067.5847 -160762.41  28.5%     -    0s
H    0     0                    -125735.1008 -145532.05  15.7%     -    0s
H    0     0                    -133540.6322 -145532.05  8.98%     -    0s
     0     0 -145532.05    0   83 -133540.63 -145532.05  8.98%     -    0s
H    0     0                    -141280.1429 -145393.34  2.91%     -    0s
     0     0 -144040.22    0   86 -141280.14 -144040.22  1.95%     -    0s
H    0     0                    -142071.3962 -144026.34  1.38%     -    0s
     0     0 -143468.19    0   66 -142071.40 -143468.19  0.98%     -    0s
     0     0 -143430.41    0   70 -142071.40 -143430.41  0.96%     -    0s
     0     0 -142955.25    0   51 -142071.40 -142955.25  0.62%     -    0s
     0     0 -142877.57    0   54 -142071.40 -142877.57  0.57%     -    0s
     0     0 -142669.11    0   49 -142071.40 -142669.11  0.42%     -    0s
     0     0 -142610.00    0   45 -142071.40 -142610.00  0.38%     -    0s
     0     0 -142609.95    0   49 -142071.40 -142609.95  0.38%     -    0s
     0     0 -142503.70    0   52 -142071.40 -142503.70  0.30%     -    0s
     0     0 -142470.41    0   53 -142071.40 -142470.41  0.28%     -    0s
     0     0 -142438.52    0   42 -142071.40 -142438.52  0.26%     -    0s
     0     0 -142411.95    0   48 -142071.40 -142411.95  0.24%     -    0s
     0     0 -142411.95    0   48 -142071.40 -142411.95  0.24%     -    0s
     0     0 -142316.18    0   36 -142071.40 -142316.18  0.17%     -    0s
     0     0 -142305.39    0   37 -142071.40 -142305.39  0.16%     -    0s
     0     0 -142266.91    0   34 -142071.40 -142266.91  0.14%     -    0s
     0     0 -142266.53    0   34 -142071.40 -142266.53  0.14%     -    0s
     0     0 -142266.53    0   31 -142071.40 -142266.53  0.14%     -    0s
     0     0 -142266.40    0   43 -142071.40 -142266.40  0.14%     -    0s
     0     0 -142266.40    0   43 -142071.40 -142266.40  0.14%     -    0s
     0     0 -142266.40    0   31 -142071.40 -142266.40  0.14%     -    0s
H    0     0                    -142084.4182 -142266.40  0.13%     -    0s
     0     0 -142266.40    0   28 -142084.42 -142266.40  0.13%     -    0s
     0     0 -142220.30    0   29 -142084.42 -142220.30  0.10%     -    0s
     0     0 -142220.08    0   29 -142084.42 -142220.08  0.10%     -    0s
     0     0 -142204.02    0   26 -142084.42 -142204.02  0.08%     -    0s
     0     0 -142188.80    0   26 -142084.42 -142188.80  0.07%     -    0s
H    0     0                    -142103.9802 -142188.80  0.06%     -    0s
     0     0 -142188.80    0   38 -142103.98 -142188.80  0.06%     -    0s
     0     0 -142188.80    0   27 -142103.98 -142188.80  0.06%     -    0s
     0     0 -142188.80    0   26 -142103.98 -142188.80  0.06%     -    0s
     0     0 -142188.80    0   26 -142103.98 -142188.80  0.06%     -    0s
     0     0 -142188.80    0   26 -142103.98 -142188.80  0.06%     -    0s
     0     2 -142173.63    0   26 -142103.98 -142173.63  0.05%     -    0s

Cutting planes:
  Gomory: 35
  Implied bound: 3
  MIR: 23
  Flow cover: 5

Explored 7 nodes (1245 simplex iterations) in 0.11 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -142104 -142084 -142071 ... -123843

Optimal solution found (tolerance 1.00e-04)
Best objective -1.421039802019e+05, best bound -1.421134541540e+05, gap 0.0067%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 176532.67
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142103.98
  [DEBUG]   S×d_nominal = 318636.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 318636.65 + -142103.98 = 176532.67
  [DEBUG]   Current θ from Master = 189597.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13064.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24004.93
  Lower Bound (LB) = 28726.80
  Gap (UB-LB) = 8343.1164, Absolute Gap = 8343.1164, Relative Gap = 0.225064
  Not converged yet (gap = 8343.12 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xf731281c
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 1.21s
Presolved: 83583 rows, 35960 columns, 511899 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.540e+06
 Factor NZ  : 7.602e+06 (roughly 100 MB of memory)
 Factor Ops : 1.284e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59307354e+07  1.63546733e+08  1.11e+05 1.81e+01  7.86e+04     2s
   1  -1.19519052e+07  1.49502862e+08  7.69e+04 7.42e+01  5.40e+04     2s
   2  -3.99269949e+06  1.09933132e+08  2.58e+04 2.50e+00  1.93e+04     2s
   3  -1.31412880e+06  8.76538500e+07  4.40e+03 1.29e+00  3.68e+03     2s
   4  -5.05454512e+05  5.38351884e+07  6.42e+02 4.60e-01  7.70e+02     2s
   5  -4.33430115e+05  3.04609141e+07  3.70e+02 2.09e-01  4.16e+02     2s
   6  -3.10567931e+05  2.16110044e+07  8.46e+01 1.33e-01  1.88e+02     2s
   7  -2.43605862e+05  1.51444586e+07  3.61e+01 8.84e-02  1.17e+02     2s
   8  -1.32055567e+05  9.91788425e+06  1.33e+00 5.61e-02  6.59e+01     2s
   9  -9.25306866e+04  4.75992009e+06  7.58e-01 2.69e-02  3.17e+01     2s
  10  -5.68897883e+04  2.05610869e+06  2.70e-01 1.13e-02  1.38e+01     3s
  11  -1.91017053e+04  5.29438688e+05  1.00e-01 2.80e-03  3.57e+00     3s
  12   3.22260844e+03  2.70648913e+05  6.28e-02 1.27e-03  1.74e+00     3s
  13   1.35455934e+04  2.32153715e+05  4.93e-02 1.15e-03  1.42e+00     3s
  14   2.11357638e+04  1.72867304e+05  4.04e-02 1.24e-03  9.88e-01     3s
  15   2.93632771e+04  1.48615478e+05  3.18e-02 1.33e-03  7.76e-01     3s
  16   3.99851567e+04  1.28875969e+05  2.12e-02 1.02e-03  5.79e-01     3s
  17   4.61687743e+04  1.04020780e+05  1.58e-02 5.53e-04  3.77e-01     3s
  18   5.09431177e+04  9.69309200e+04  1.19e-02 4.45e-04  2.99e-01     3s
  19   5.52982534e+04  9.03777071e+04  8.55e-03 3.53e-04  2.28e-01     3s
  20   5.77598261e+04  8.31700208e+04  6.84e-03 2.45e-04  1.65e-01     3s
  21   5.86929721e+04  7.88546897e+04  6.23e-03 2.00e-04  1.31e-01     3s
  22   6.22030042e+04  7.80561967e+04  4.00e-03 2.11e-04  1.03e-01     3s
  23   6.35495343e+04  7.47857410e+04  3.18e-03 1.42e-04  7.31e-02     3s
  24   6.48871883e+04  7.40835448e+04  2.37e-03 1.24e-04  5.99e-02     3s
  25   6.59411220e+04  7.27428500e+04  1.77e-03 8.91e-05  4.43e-02     3s
  26   6.65503519e+04  7.22982205e+04  1.44e-03 7.86e-05  3.74e-02     3s
  27   6.68559668e+04  7.18897389e+04  1.27e-03 6.82e-05  3.28e-02     3s
  28   6.74952596e+04  7.12140950e+04  9.03e-04 5.06e-05  2.42e-02     3s
  29   6.79306131e+04  7.08822827e+04  6.73e-04 4.20e-05  1.92e-02     3s
  30   6.83326666e+04  7.03010105e+04  4.52e-04 2.70e-05  1.28e-02     3s
  31   6.85225286e+04  6.99669482e+04  3.50e-04 1.88e-05  9.40e-03     3s
  32   6.86398294e+04  6.98492633e+04  2.91e-04 1.60e-05  7.87e-03     3s
  33   6.86767226e+04  6.98401127e+04  2.73e-04 1.58e-05  7.57e-03     4s
  34   6.88104651e+04  6.97789111e+04  2.06e-04 1.43e-05  6.30e-03     4s
  35   6.88665896e+04  6.97330203e+04  1.78e-04 1.30e-05  5.64e-03     4s
  36   6.88895840e+04  6.96900194e+04  1.67e-04 1.19e-05  5.21e-03     4s
  37   6.89335243e+04  6.96613337e+04  1.45e-04 1.11e-05  4.74e-03     4s
  38   6.90452896e+04  6.94144907e+04  9.02e-05 4.59e-06  2.40e-03     4s
  39   6.91202446e+04  6.93395173e+04  5.45e-05 4.63e-06  1.43e-03     4s
  40   6.91584283e+04  6.93213497e+04  3.64e-05 3.79e-06  1.06e-03     4s
  41   6.91711850e+04  6.93140317e+04  3.05e-05 3.46e-06  9.30e-04     4s
  42   6.91745601e+04  6.92948948e+04  2.89e-05 2.61e-06  7.83e-04     4s
  43   6.91905648e+04  6.92706115e+04  2.10e-05 1.52e-06  5.21e-04     4s
  44   6.92189566e+04  6.92554086e+04  7.84e-06 8.13e-07  2.37e-04     4s
  45   6.92301062e+04  6.92482991e+04  2.53e-06 4.92e-07  1.18e-04     4s
  46   6.92315413e+04  6.92454859e+04  1.90e-06 3.74e-07  9.08e-05     4s
  47   6.92332975e+04  6.92403943e+04  1.21e-06 1.61e-07  4.62e-05     4s
  48   6.92348208e+04  6.92384796e+04  5.96e-07 7.74e-08  2.38e-05     4s
  49   6.92353968e+04  6.92381838e+04  3.71e-07 6.60e-08  1.81e-05     4s
  50   6.92357390e+04  6.92372741e+04  2.42e-07 3.10e-08  9.99e-06     4s
  51   6.92360038e+04  6.92368102e+04  1.48e-07 1.35e-08  5.25e-06     4s
  52   6.92363413e+04  6.92365859e+04  4.61e-08 6.11e-09  1.59e-06     4s
  53   6.92364389e+04  6.92364589e+04  4.92e-09 4.57e-10  1.30e-07     5s
  54   6.92364475e+04  6.92364476e+04  1.22e-08 2.12e-09  9.50e-10     5s

Barrier solved model in 54 iterations and 4.62 seconds (8.81 work units)
Optimal objective 6.92364475e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    4157 PPushes remaining with PInf 3.2959401e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.3196982e+03      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40880    6.9236448e+04   0.000000e+00   5.319698e+03      7s
   41137    6.9236448e+04   0.000000e+00   0.000000e+00      8s
   41137    6.9236448e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 1.73s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.923645e+04, 41137 iterations, 7.72 seconds (14.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 69236.4476    0  175 -170340.08 69236.4476   141%     -    9s
H    0     0                    -161668.8626 69236.4476   143%     -    9s
H    0     0                    -49177.19054 69236.4476   241%     -   10s
H    0     0                    24555.320903 69236.4476   182%     -   10s
H    0     0                    24732.125559 69236.4476   180%     -   10s
H    0     0                    25381.625967 69236.4476   173%     -   11s
H    0     0                    25857.587717 69236.4476   168%     -   11s
H    0     0                    25956.645267 69236.4476   167%     -   11s
H    0     0                    26071.521412 69236.4476   166%     -   11s
     0     0 63368.1874    0  223 26071.5214 63368.1874   143%     -   37s
H    0     0                    26189.417562 63368.1874   142%     -   37s
     0     0 62860.7599    0  239 26189.4176 62860.7599   140%     -   47s
     0     0 62860.7324    0  238 26189.4176 62860.7324   140%     -   50s
     0     0 62860.0455    0  241 26189.4176 62860.0455   140%     -   52s
     0     0 62859.1879    0  239 26189.4176 62859.1879   140%     -   53s
     0     0 62859.1745    0  241 26189.4176 62859.1745   140%     -   53s
     0     0 59066.4145    0  300 26189.4176 59066.4145   126%     -   83s
H    0     0                    33213.346303 59066.3859  77.8%     -   84s
H    0     0                    33385.849142 59066.3859  76.9%     -   84s
     0     0 58748.1125    0  305 33385.8491 58748.1125  76.0%     -   93s
     0     0 58598.8639    0  310 33385.8491 58598.8639  75.5%     -  102s
     0     0 58542.6242    0  321 33385.8491 58542.6242  75.4%     -  105s
     0     0 58511.3197    0  317 33385.8491 58511.3197  75.3%     -  108s
     0     0 58478.3735    0  316 33385.8491 58478.3735  75.2%     -  111s
     0     0 58336.3682    0  310 33385.8491 58336.3682  74.7%     -  118s
     0     0 58325.6905    0  322 33385.8491 58325.6905  74.7%     -  120s
     0     0 58320.8178    0  316 33385.8491 58320.8178  74.7%     -  122s
     0     0 58288.3966    0  313 33385.8491 58288.3966  74.6%     -  126s
     0     0 58279.1683    0  311 33385.8491 58279.1683  74.6%     -  127s
     0     0 58276.6418    0  310 33385.8491 58276.6418  74.6%     -  130s
     0     0 58275.0929    0  316 33385.8491 58275.0929  74.6%     -  131s
     0     0 58273.4903    0  318 33385.8491 58273.4903  74.5%     -  132s
     0     0 58273.3173    0  319 33385.8491 58273.3173  74.5%     -  132s
     0     0 56309.1118    0  341 33385.8491 56309.1118  68.7%     -  164s
H    0     0                    33416.934667 56308.6950  68.5%     -  165s
     0     0 55876.3181    0  362 33416.9347 55876.3181  67.2%     -  177s
     0     0 55730.7237    0  380 33416.9347 55730.7237  66.8%     -  185s
     0     0 55680.1037    0  382 33416.9347 55680.1037  66.6%     -  189s
H    0     0                    33444.620559 55647.4579  66.4%     -  193s
     0     0 55647.4579    0  364 33444.6206 55647.4579  66.4%     -  193s
     0     0 55630.8229    0  396 33444.6206 55630.8229  66.3%     -  196s
     0     0 55597.5217    0  393 33444.6206 55597.5217  66.2%     -  199s
     0     0 55521.4892    0  390 33444.6206 55521.4892  66.0%     -  204s
H    0     0                    33475.706083 55507.0266  65.8%     -  207s
     0     0 55507.0266    0  387 33475.7061 55507.0266  65.8%     -  207s
     0     0 55502.7214    0  390 33475.7061 55502.7214  65.8%     -  209s
     0     0 55499.5749    0  394 33475.7061 55499.5749  65.8%     -  210s
     0     0 55487.3541    0  396 33475.7061 55487.3541  65.8%     -  212s
     0     0 55483.5973    0  401 33475.7061 55483.5973  65.7%     -  213s
     0     0 55479.0254    0  400 33475.7061 55479.0254  65.7%     -  214s
     0     0 55478.0201    0  398 33475.7061 55478.0201  65.7%     -  215s
     0     0 54174.5502    0  337 33475.7061 54174.5502  61.8%     -  242s
     0     0 53788.4737    0  325 33475.7061 53788.4737  60.7%     -  256s
     0     0 53636.4283    0  332 33475.7061 53636.4283  60.2%     -  263s
H    0     0                    34239.611887 53511.0561  56.3%     -  273s
     0     0 53511.0561    0  337 34239.6119 53511.0561  56.3%     -  273s
     0     0 53489.7869    0  345 34239.6119 53489.7869  56.2%     -  277s
     0     0 53459.0076    0  347 34239.6119 53459.0076  56.1%     -  280s
     0     0 53411.2020    0  348 34239.6119 53411.2020  56.0%     -  286s
     0     0 53400.4876    0  346 34239.6119 53400.4876  56.0%     -  289s
     0     0 53392.2505    0  345 34239.6119 53392.2505  55.9%     -  291s
     0     0 53348.0729    0  330 34239.6119 53348.0729  55.8%     -  296s
     0     0 53304.0440    0  340 34239.6119 53304.0440  55.7%     -  299s
     0     0 53295.0450    0  343 34239.6119 53295.0450  55.7%     -  302s
     0     0 53280.9413    0  390 34239.6119 53280.9413  55.6%     -  305s
     0     0 53250.0422    0  340 34239.6119 53250.0422  55.5%     -  307s
     0     0 53236.5343    0  386 34239.6119 53236.5343  55.5%     -  309s
     0     0 53232.4846    0  357 34239.6119 53232.4846  55.5%     -  310s
     0     0 53230.5025    0  352 34239.6119 53230.5025  55.5%     -  311s
     0     0 52658.7644    0  390 34239.6119 52658.7644  53.8%     -  324s
H    0     0                    34307.965943 52658.6934  53.5%     -  325s
     0     0 52525.5513    0  401 34307.9659 52525.5513  53.1%     -  332s
     0     0 52504.8019    0  411 34307.9659 52504.8019  53.0%     -  335s
     0     0 52485.8323    0  407 34307.9659 52485.8323  53.0%     -  337s
H    0     0                    34430.342519 52453.3194  52.3%     -  339s
     0     0 52453.3194    0  382 34430.3425 52453.3194  52.3%     -  339s
     0     0 52444.4416    0  383 34430.3425 52444.4416  52.3%     -  341s
     0     0 52433.1497    0  374 34430.3425 52433.1497  52.3%     -  343s
     0     0 52418.6977    0  378 34430.3425 52418.6977  52.2%     -  345s
     0     0 52412.5783    0  378 34430.3425 52412.5783  52.2%     -  346s
     0     0 52406.5792    0  378 34430.3425 52406.5792  52.2%     -  347s
     0     0 52404.0415    0  381 34430.3425 52404.0415  52.2%     -  348s
     0     0 52398.5819    0  379 34430.3425 52398.5819  52.2%     -  349s
     0     0 52398.4471    0  381 34430.3425 52398.4471  52.2%     -  350s
     0     0 52237.5402    0  423 34430.3425 52237.5402  51.7%     -  360s
     0     0 52199.2286    0  384 34430.3425 52199.2286  51.6%     -  370s
     0     0 52180.8239    0  371 34430.3425 52180.8239  51.6%     -  373s
     0     0 52162.6450    0  376 34430.3425 52162.6450  51.5%     -  376s
     0     0 52151.9214    0  425 34430.3425 52151.9214  51.5%     -  379s
     0     0 52150.8334    0  433 34430.3425 52150.8334  51.5%     -  380s
     0     0 52071.0320    0  378 34430.3425 52071.0320  51.2%     -  388s
     0     0 52052.9387    0  379 34430.3425 52052.9387  51.2%     -  393s
     0     0 52039.5380    0  381 34430.3425 52039.5380  51.1%     -  397s
     0     0 52034.8648    0  382 34430.3425 52034.8648  51.1%     -  399s
     0     0 52032.4156    0  384 34430.3425 52032.4156  51.1%     -  401s
     0     0 52013.8916    0  380 34430.3425 52013.8916  51.1%     -  405s
H    0     0                    34533.775789 52013.6361  50.6%     -  407s
H    0     0                    34639.769102 52013.6361  50.2%     -  408s
     0     0 52010.2025    0  384 34639.7691 52010.2025  50.1%     -  409s
     0     0 52007.9283    0  379 34639.7691 52007.9283  50.1%     -  412s
     0     0 52000.6562    0  390 34639.7691 52000.6562  50.1%     -  415s
     0     0 51996.8387    0  387 34639.7691 51996.8387  50.1%     -  418s
     0     0 51991.8603    0  389 34639.7691 51991.8603  50.1%     -  421s
     0     0 51989.6553    0  394 34639.7691 51989.6553  50.1%     -  424s
     0     0 51962.3718    0  384 34639.7691 51962.3718  50.0%     -  429s
H    0     0                    34710.399986 51962.2597  49.7%     -  431s
     0     0 51950.2655    0  382 34710.4000 51950.2655  49.7%     -  434s
     0     0 51940.7171    0  383 34710.4000 51940.7171  49.6%     -  436s
     0     0 51940.3588    0  385 34710.4000 51940.3588  49.6%     -  437s
     0     0 51934.2323    0  387 34710.4000 51934.2323  49.6%     -  440s
     0     0 51933.4557    0  387 34710.4000 51933.4557  49.6%     -  441s
     0     0 51930.2211    0  382 34710.4000 51930.2211  49.6%     -  442s
H    0     0                    34716.283450 51926.7928  49.6%     -  446s
     0     0 51926.7928    0  386 34716.2835 51926.7928  49.6%     -  447s
     0     0 51917.4878    0  389 34716.2835 51917.4878  49.5%     -  451s
     0     0 51917.1835    0  389 34716.2835 51917.1835  49.5%     -  452s
     0     2 51916.4291    0  389 34716.2835 51916.4291  49.5%     -  519s
     1     3 51339.6960    1  350 34716.2835 51916.4291  49.5% 10490  528s
     2     4 51730.8599    1  381 34716.2835 51730.8599  49.0%  8646  535s
     3     7 50065.8526    2  346 34716.2835 51730.4310  49.0%  7620  544s
     6    14 51175.6656    3  381 34716.2835 51730.4310  49.0%  7519  556s
    13    28 50916.6317    4  367 34716.2835 51282.0735  47.7%  8353  577s
    27    42 50578.0824    5  390 34716.2835 51043.6321  47.0% 14962  607s
    41    74 48956.7628    6  365 34716.2835 51043.6321  47.0% 14012  648s
H   56    74                    34817.050292 51043.6321  46.6% 13452  648s
    73   166 48789.9314    7  358 34817.0503 50952.7726  46.3% 13934  691s
   165   244 48248.7409   10  355 34817.0503 50952.7726  46.3%  9484  708s
   243   294 48448.9250   10  347 34817.0503 50952.7726  46.3%  7779  727s
   293   341 48476.3179   10  349 34817.0503 50952.7726  46.3%  7428  743s
   340   409 48217.4134   11  365 34817.0503 50952.7726  46.3%  7319  758s
   408   433 48424.4468   11  339 34817.0503 50952.7726  46.3%  7072  771s
   432   463 48144.8830   11  301 34817.0503 50952.7726  46.3%  6976  786s
   462   509 43789.7725   18  261 34817.0503 50952.7726  46.3%  6973  799s
   508   576 43652.0175   19  312 34817.0503 50952.7726  46.3%  6818  814s
   575   654 43634.3165   20  309 34817.0503 50952.7726  46.3%  6741  827s
   659   714 43027.3037   22  322 34817.0503 50952.7726  46.3%  6568  842s
   741   774 37785.1437   38   79 34817.0503 50952.7726  46.3%  6394  856s
   834   846 45456.5184   12  309 34817.0503 50952.7726  46.3%  6170  869s
   932   916 45338.4614   12  273 34817.0503 50952.7726  46.3%  5955  882s
  1032   987 38659.2064   24  211 34817.0503 50952.7726  46.3%  5760  895s
  1139  1050     cutoff   27      34817.0503 50952.7726  46.3%  5552  909s
  1249  1121 38014.9938   31  205 34817.0503 50586.3276  45.3%  5405  923s
  1346  1208 44248.7942   13  241 34817.0503 50586.3276  45.3%  5401  938s
  1453  1319 43395.8969   13  295 34817.0503 50586.3276  45.3%  5343  953s
  1586  1362 43392.0060   14  201 34817.0503 50586.3276  45.3%  5226  968s
  1711  1380 42683.6367   14  260 34817.0503 50586.3276  45.3%  5152  984s
H 1718  1380                    34839.141207 50586.3276  45.2%  5158  984s
H 1771  1380                    34852.556347 50586.3276  45.1%  5129  984s
H 1778  1380                    34897.319871 50586.3276  45.0%  5129  984s
  1785  1421 44999.7505   13  282 34897.3199 50586.3276  45.0%  5144 1000s
  1862  1479 40442.5660   16  182 34897.3199 50586.3276  45.0%  5139 1018s
  1976  1573 40431.0197   17  204 34897.3199 50586.3276  45.0%  5164 1034s
  2104  1658 41429.1193   18  222 34897.3199 50586.3276  45.0%  5157 1053s
  2266  1679 40926.3079   18  255 34897.3199 50586.3276  45.0%  5077 1071s
  2399  1721 36807.8062   19  184 34897.3199 50586.3276  45.0%  5056 1092s
  2497  1792 39823.0591   19  229 34897.3199 50586.3276  45.0%  5165 1114s
  2605  1822 38527.1302   22  190 34897.3199 50586.3276  45.0%  5240 1132s
  2655  1851 38312.4285   23  173 34897.3199 50093.4888  43.5%  5321 1149s
H 2666  1851                    34906.738317 50093.4888  43.5%  5340 1149s
H 2676  1850                    34948.573800 50093.4888  43.3%  5343 1149s
  2688  1935 38222.0954   24  170 34948.5738 50093.4888  43.3%  5377 1169s
H 2801  2011                    35424.572297 50078.2012  41.4%  5454 1191s
  2917  2103 37020.9389   28  150 35424.5723 49997.9106  41.1%  5498 1214s
H 3031  2199                    35466.472337 49964.7726  40.9%  5570 1236s
H 3048  2190                    35609.761004 49964.7726  40.3%  5567 1236s
H 3078  2181                    35712.232062 49964.7726  39.9%  5565 1236s
  3167  2260     cutoff   38      35712.2321 49746.2921  39.3%  5600 1259s
  3358  2283 46333.9018   12  391 35712.2321 49682.7290  39.1%  5597 1283s
H 3363  2260                    35903.921516 49682.7290  38.4%  5604 1283s
H 3369  2235                    36084.107011 49682.7290  37.7%  5623 1283s
  3397  2284 46135.4328   13  350 36084.1070 49682.7290  37.7%  5644 1311s
H 3538  2213                    36475.529957 49667.3638  36.2%  5670 1334s
H 3543  2187                    36522.747306 49561.8515  35.7%  5687 1334s
H 3546  2138                    36675.259889 49561.8515  35.1%  5693 1334s
  3575  2240 43961.1669   15  292 36675.2599 49561.8515  35.1%  5770 1364s
  3711  2360 42427.7958   18  269 36675.2599 49561.8515  35.1%  5863 1395s
H 3889  2353                    36710.636610 49561.8515  35.0%  5867 1411s
H 3889  2341                    36750.940157 49561.8515  34.9%  5867 1420s
  3890  2342 41185.2155   31  389 36750.9402 49561.8515  34.9%  5866 1458s
  3892  2343 38490.9447   15  198 36750.9402 49561.8515  34.9%  5863 1468s
  3893  2344 38312.3227   29  322 36750.9402 49561.8515  34.9%  5861 1525s
  3894  2345 48423.3098   12  356 36750.9402 49561.8515  34.9%  5860 1568s
  3895  2345 41568.5676   40  345 36750.9402 49561.8515  34.9%  5858 1596s
  3896  2346 39717.3785   22  358 36750.9402 49561.8515  34.9%  5857 1613s
  3897  2347 37303.3916   55  342 36750.9402 49561.8515  34.9%  5855 1625s
  3898  2347 46120.0076   11  356 36750.9402 49561.8515  34.9%  5854 1634s
  3899  2348 38885.1264   40  368 36750.9402 49561.8515  34.9%  5852 1644s
  3900  2349 49073.2922   10  363 36750.9402 49561.8515  34.9%  5851 1654s
  3901  2349 39292.1572   20  376 36750.9402 49561.8515  34.9%  5849 1662s
  3902  2350 46609.1646   11  409 36750.9402 49561.8515  34.9%  5848 1669s
  3903  2351 36933.9024   28  378 36750.9402 49561.8515  34.9%  5846 1673s
  3904  2351 42030.9832   13  454 36750.9402 49561.8515  34.9%  5845 1686s
  3905  2352 46567.3625   12  417 36750.9402 49561.8515  34.9%  5843 1692s
  3906  2353 43173.7772   35  443 36750.9402 49561.8515  34.9%  5842 1698s
  3907  2353 36760.1902   30  407 36750.9402 49561.8515  34.9%  5840 1701s
  3909  2355 42411.8080   19  411 36750.9402 49561.8515  34.9%  5837 1706s
H 3909  2236                    36935.955981 49561.8515  34.2%  5837 1715s
  3912  2238 38689.1430   37  411 36935.9560 49561.8515  34.2%  5833 1728s
  3913  2238 40011.3421   10  382 36935.9560 49561.8515  34.2%  5831 1732s
  3914  2239 48064.9291   15  424 36935.9560 49561.8515  34.2%  5830 1735s
  3915  2240 41386.1147   35  393 36935.9560 49561.8515  34.2%  5828 1742s
  3916  2240 40412.6793   14  394 36935.9560 49561.8515  34.2%  5827 1747s
  3917  2241 41334.8415   17  398 36935.9560 49561.8515  34.2%  5826 1754s
  3918  2242 37679.1233   39  383 36935.9560 49561.8515  34.2%  5824 1758s
  3919  2242 39103.6617   29  434 36935.9560 49561.8515  34.2%  5823 1766s
  3921  2244 42398.5915   16  409 36935.9560 49561.8515  34.2%  5820 1774s
  3922  2244 40586.4894   35  397 36935.9560 49561.8515  34.2%  5818 1777s
  3923  2245 36998.1594   31  397 36935.9560 49561.8515  34.2%  5817 1784s
  3924  2246 45029.1319   19  385 36935.9560 49561.8515  34.2%  5815 1787s
  3925  2246 40913.9790   30  389 36935.9560 49561.8515  34.2%  5814 1793s
  3926  2247 39191.7716   31  389 36935.9560 49561.8515  34.2%  5812 1810s
  3927  2248 37607.2224   25  389 36935.9560 49561.8515  34.2%  5811 1865s
  3928  2250 49561.8515   15  369 36935.9560 49561.8515  34.2%  5890 1932s
  3929  2252 48917.3905   16  326 36935.9560 49561.8515  34.2%  5894 1950s
  3931  2256 48469.4263   17  333 36935.9560 49561.8515  34.2%  5894 1985s
  3936  2264 48216.3483   18  344 36935.9560 49561.8515  34.2%  5899 2023s
  3945  2280 46992.2214   19  339 36935.9560 49561.8515  34.2%  5920 2061s
  3964  2287 45541.2355   20  336 36935.9560 49561.8515  34.2%  6023 2129s
  3978  2313 47849.9035   19  385 36935.9560 49561.8515  34.2%  6052 2177s
  4008  2371 47045.2010   20  380 36935.9560 49561.8515  34.2%  6151 2218s
  4076  2426 46465.2238   23  363 36935.9560 49561.8515  34.2%  6211 2259s
  4154  2454 42767.2990   25  335 36935.9560 49561.8515  34.2%  6236 2294s
  4227  2450 42203.0327   26  329 36935.9560 49561.8515  34.2%  6291 2323s
  4263  2456 40626.8043   27  302 36935.9560 49561.8515  34.2%  6326 2351s
  4303  2460 40254.4225   28  302 36935.9560 49561.8515  34.2%  6391 2375s
  4345  2463 39775.1183   29  297 36935.9560 49561.8515  34.2%  6438 2393s
  4380  2471 39496.3586   30  288 36935.9560 49561.8515  34.2%  6470 2414s
  4416  2482 39388.0644   31  254 36935.9560 49479.4544  34.0%  6496 2435s
  4451  2484 39135.1965   32  251 36935.9560 49479.4544  34.0%  6531 2455s
  4493  2483 39135.1822   33  250 36935.9560 49479.4544  34.0%  6556 2482s
  4530  2491 38815.8409   34  237 36935.9560 49165.6428  33.1%  6598 2511s
  4574  2492 38632.8284   35  235 36935.9560 48977.6610  32.6%  6621 2541s
  4622  2493 38399.4011   36  239 36935.9560 48977.6610  32.6%  6659 2564s
  4669  2492 37928.4196   38  215 36935.9560 48977.6610  32.6%  6696 2589s
  4726  2488     cutoff   42      36935.9560 48977.6610  32.6%  6729 2615s
  4765  2492 42337.2724   25  312 36935.9560 48977.6610  32.6%  6773 2637s
  4813  2503 40956.9053   27  259 36935.9560 48977.6610  32.6%  6821 2660s
  4867  2496 38493.3284   32  149 36935.9560 48977.6610  32.6%  6854 2683s
  4930  2506 infeasible   28      36935.9560 48977.6610  32.6%  6885 2708s
  5016  2490 41257.0862   28  241 36935.9560 48836.2627  32.2%  6902 2740s
  5089  2495 38651.0253   30  203 36935.9560 48836.2627  32.2%  6967 2767s
  5159  2500 37036.8247   33  209 36935.9560 48836.2627  32.2%  7023 2799s
  5231  2500     cutoff   32      36935.9560 47985.0069  29.9%  7079 2828s
  5328  2496 42571.6944   21  275 36935.9560 47892.2623  29.7%  7136 2858s
  5413  2503 42448.9325   22  272 36935.9560 47892.2623  29.7%  7211 2886s
  5519  2502 41326.5793   23  245 36935.9560 47892.2623  29.7%  7271 2925s
  5610  2515 39724.9069   25  238 36935.9560 47892.2623  29.7%  7339 2959s
  5729  2510 37067.7253   26  261 36935.9560 47892.2623  29.7%  7414 2998s
  5847  2513 39095.0457   26  210 36935.9560 47892.2623  29.7%  7473 3035s
  5972  2505 37768.4417   28  157 36935.9560 47207.3784  27.8%  7528 3074s
  6081  2524 infeasible   29      36935.9560 47084.5597  27.5%  7613 3116s
  6223  2492 40322.6330   25  293 36935.9560 47024.3826  27.3%  7681 3156s
  6355  2497 40657.4262   26  340 36935.9560 47024.3826  27.3%  7773 3201s
  6489  2497 40193.3918   26  286 36935.9560 46615.6010  26.2%  7852 3242s
  6637  2459 40387.7203   27  296 36935.9560 46615.6010  26.2%  7924 3280s
  6684  2461 38271.4570   27  259 36935.9560 46615.6010  26.2%  7975 3320s
  6736  2475 37832.3765   28  296 36935.9560 46162.6042  25.0%  8005 3361s
  6815  2466 37666.7178   28  215 36935.9560 46111.6509  24.8%  8020 3407s
  6914  2473 38061.0347   26  284 36935.9560 46111.6509  24.8%  8066 3456s
  7031  2481 40083.2227   27  283 36935.9560 46089.6576  24.8%  8142 3508s
  7200  2474 37684.8904   27  187 36935.9560 45985.7221  24.5%  8207 3560s
  7383  2451 38202.6511   26  327 36935.9560 45985.7221  24.5%  8307 3600s

Cutting planes:
  Gomory: 12
  Implied bound: 23
  Projected implied bound: 235
  MIR: 1332
  Mixing: 3
  Flow cover: 2057
  RLT: 30
  Relax-and-lift: 281

Explored 7522 nodes (63463710 simplex iterations) in 3600.04 seconds (10388.42 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 36936 36750.9 36710.6 ... 35609.8

Time limit reached
Best objective 3.693595598144e+04, best bound 4.598572209222e+04, gap 24.5012%
  WARNING: Time limit reached. Using best solution found (gap: 24.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 36935.96, θ = 190575.11
  Upper Bound (UB) = 36935.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190575.11
  [DEBUG]   ✓ Scenario 0: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 190575.11 ≤ Q = 190575.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 190575.11 ≤ Q = 190575.11 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x616c7989
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x616c7989
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.413530e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6859528.1608
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.647517e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164751.66    0  128 6859528.16 -164751.66   102%     -    0s
H    0     0                    -129137.2715 -164751.66  27.6%     -    0s
H    0     0                    -129822.4290 -164751.66  26.9%     -    0s
H    0     0                    -131483.2195 -143514.28  9.15%     -    0s
H    0     0                    -136997.7133 -143514.28  4.76%     -    0s
     0     0 -143514.28    0   95 -136997.71 -143514.28  4.76%     -    0s
H    0     0                    -140341.2120 -143419.85  2.19%     -    0s
     0     0 -143388.26    0   83 -140341.21 -143388.26  2.17%     -    0s
     0     0 -143388.26    0   95 -140341.21 -143388.26  2.17%     -    0s
     0     0 -142370.95    0   79 -140341.21 -142370.95  1.45%     -    0s
     0     0 -142350.64    0   80 -140341.21 -142350.64  1.43%     -    0s
     0     0 -142122.80    0   80 -140341.21 -142122.80  1.27%     -    0s
     0     0 -142096.25    0   80 -140341.21 -142096.25  1.25%     -    0s
     0     0 -141944.02    0   73 -140341.21 -141944.02  1.14%     -    0s
     0     0 -141934.04    0   73 -140341.21 -141934.04  1.13%     -    0s
H    0     0                    -140823.0443 -141934.04  0.79%     -    0s
H    0     0                    -141555.9328 -141934.04  0.27%     -    0s
H    0     0                    -141834.8663 -141934.04  0.07%     -    0s
H    0     0                    -141851.9494 -141934.04  0.06%     -    0s
     0     2 -141934.04    0   63 -141851.95 -141934.04  0.06%     -    0s
H   31    21                    -141870.2447 -141882.69  0.01%   3.9    0s

Cutting planes:
  Gomory: 29
  MIR: 148
  Flow cover: 1
  RLT: 25
  BQP: 2

Explored 45 nodes (703 simplex iterations) in 0.06 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -141870 -141852 -141835 ... -129137

Optimal solution found (tolerance 1.00e-04)
Best objective -1.418702447177e+05, best bound -1.418765452534e+05, gap 0.0044%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 179271.78
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141870.24
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -141870.24 = 179271.78
  [DEBUG]   Current θ from Master = 190575.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11303.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25632.62
  Lower Bound (LB) = 28726.80
  Gap (UB-LB) = 8209.1609, Absolute Gap = 8209.1609, Relative Gap = 0.222254
  Not converged yet (gap = 8209.16 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x14e32d5b
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 1.35s
Presolved: 91803 rows, 39330 columns, 558907 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340071.5881
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 620
 AA' NZ     : 3.175e+06
 Factor NZ  : 7.276e+06 (roughly 110 MB of memory)
 Factor Ops : 1.305e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59383837e+07  1.77730582e+08  1.11e+05 1.75e+01  7.82e+04     2s
   1  -1.20623317e+07  1.62799419e+08  7.74e+04 7.14e+01  5.40e+04     2s
   2  -4.46500984e+06  1.19422642e+08  2.88e+04 3.18e+00  2.15e+04     2s
   3  -8.22877762e+05  9.41202262e+07  1.31e+03 1.71e+00  1.50e+03     3s
   4  -6.32646510e+05  6.86362726e+07  3.67e+02 1.12e+00  6.55e+02     3s
   5  -4.46070911e+05  3.96959095e+07  2.52e+02 5.85e-01  3.87e+02     3s
   6  -3.68873678e+05  2.93649911e+07  1.12e+02 4.09e-01  2.37e+02     3s
   7  -3.17727232e+05  2.12903540e+07  4.68e+01 2.82e-01  1.50e+02     3s
   8  -2.09153636e+05  1.56021436e+07  1.37e+00 2.00e-01  9.43e+01     3s
   9  -1.25381930e+05  7.41424980e+06  1.43e-01 9.40e-02  4.48e+01     3s
  10  -7.34309610e+04  2.17572864e+06  6.88e-02 2.53e-02  1.33e+01     3s
  11  -8.59150417e+03  8.15590924e+05  1.41e-02 8.23e-03  4.89e+00     3s
  12   6.36517291e+03  3.66774482e+05  7.82e-03 3.44e-03  2.14e+00     3s
  13   1.48645963e+04  2.22944030e+05  5.73e-03 1.89e-03  1.23e+00     3s
  14   2.53202948e+04  1.86755179e+05  4.19e-03 1.46e-03  9.58e-01     3s
  15   3.44521349e+04  1.41004116e+05  3.08e-03 9.23e-04  6.32e-01     3s
  16   3.74261006e+04  1.27432128e+05  2.74e-03 7.67e-04  5.34e-01     3s
  17   4.35480329e+04  1.12721874e+05  2.12e-03 5.83e-04  4.10e-01     3s
  18   4.86498202e+04  9.94165888e+04  1.62e-03 4.17e-04  3.01e-01     3s
  19   5.44547931e+04  9.25364939e+04  1.07e-03 3.34e-04  2.26e-01     3s
  20   5.70098886e+04  8.61753000e+04  8.44e-04 2.47e-04  1.73e-01     3s
  21   5.87810910e+04  7.92640561e+04  6.98e-04 1.59e-04  1.22e-01     3s
  22   6.07289864e+04  7.53879796e+04  5.49e-04 1.06e-04  8.70e-02     3s
  23   6.29786963e+04  7.42388728e+04  3.80e-04 8.81e-05  6.68e-02     3s
  24   6.40821446e+04  7.29511881e+04  2.96e-04 6.80e-05  5.26e-02     3s
  25   6.50154013e+04  7.20661956e+04  2.30e-04 5.43e-05  4.18e-02     3s
  26   6.58235642e+04  7.11037475e+04  1.73e-04 4.01e-05  3.13e-02     3s
  27   6.67045529e+04  7.01063371e+04  1.13e-04 2.46e-05  2.02e-02     4s
  28   6.72553589e+04  6.95538458e+04  7.62e-05 1.58e-05  1.36e-02     4s
  29   6.77222581e+04  6.91727104e+04  4.48e-05 1.02e-05  8.61e-03     4s
  30   6.78353318e+04  6.89894150e+04  3.79e-05 7.36e-06  6.85e-03     4s
  31   6.80558496e+04  6.88514192e+04  2.46e-05 5.33e-06  4.72e-03     4s
  32   6.82010142e+04  6.87620877e+04  1.60e-05 3.98e-06  3.33e-03     4s
  33   6.83441876e+04  6.86675675e+04  7.65e-06 2.57e-06  1.92e-03     4s
  34   6.84054577e+04  6.86221616e+04  4.26e-06 1.91e-06  1.29e-03     4s
  35   6.84447062e+04  6.85762914e+04  2.16e-06 1.21e-06  7.81e-04     4s
  36   6.84752021e+04  6.85553564e+04  6.39e-07 9.08e-07  4.76e-04     4s
  37   6.84839700e+04  6.85089793e+04  2.56e-07 2.48e-07  1.48e-04     4s
  38   6.84867326e+04  6.84946534e+04  1.55e-07 4.62e-08  4.70e-05     4s
  39   6.84899103e+04  6.84924739e+04  5.31e-08 1.65e-08  1.52e-05     4s
  40   6.84911180e+04  6.84916801e+04  1.50e-08 5.64e-09  3.33e-06     4s
  41   6.84912456e+04  6.84912530e+04  1.66e-08 1.97e-10  4.40e-08     4s
  42   6.84912491e+04  6.84912503e+04  8.61e-08 6.56e-09  6.62e-09     4s
  43   6.84912502e+04  6.84912503e+04  4.98e-08 2.86e-10  1.97e-10     4s

Barrier solved model in 43 iterations and 4.35 seconds (8.11 work units)
Optimal objective 6.84912502e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2216 PPushes remaining with PInf 1.0055376e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.0308093e-01      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34503    6.8491250e+04   0.000000e+00   6.030809e-01      7s
   34517    6.8491250e+04   0.000000e+00   0.000000e+00      7s
   34517    6.8491250e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.73s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.849125e+04, 34517 iterations, 5.97 seconds (12.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 68491.2503    0  244 -170340.08 68491.2503   140%     -    8s
H    0     0                    -163580.7755 68491.2503   142%     -    8s
H    0     0                    -143160.3317 68491.2503   148%     -    8s
H    0     0                    -140474.8178 68491.2503   149%     -    8s
H    0     0                    -124024.0553 68491.2503   155%     -    9s
H    0     0                    -122559.0735 68491.2503   156%     -    9s
H    0     0                    -119416.3435 68491.2503   157%     -    9s
H    0     0                    -119382.9722 68491.2503   157%     -    9s
H    0     0                    -119187.6153 68491.2503   157%     -    9s
H    0     0                    -118999.0748 68491.2503   158%     -   24s
H    0     0                    -12948.40212 68491.2503   629%     -   24s
H    0     0                    -8971.373737 68491.2503   863%     -   24s
H    0     0                    -8551.001576 68491.2503   901%     -   24s
H    0     0                    8300.6609094 68491.2503   725%     -   26s
H    0     0                    19956.788556 68491.2503   243%     -   26s
H    0     0                    20962.735221 68491.2503   227%     -   26s
H    0     0                    21672.620313 68491.2503   216%     -   26s
H    0     0                    24191.819469 68491.2503   183%     -   26s
H    0     0                    24237.126857 68277.8671   182%     -   34s
H    0     0                    24508.278598 68277.8671   179%     -   34s
H    0     0                    24550.380448 68277.8671   178%     -   34s
H    0     0                    24565.454668 68277.8671   178%     -   34s
H    0     0                    24573.270649 68277.8671   178%     -   34s
H    0     0                    25569.849948 62699.3124   145%     -   71s
     0     0 62179.3272    0  312 25569.8499 62179.3272   143%     -   71s
     0     0 62110.8959    0  329 25569.8499 62110.8959   143%     -   94s
     0     0 62110.8959    0  321 25569.8499 62110.8959   143%     -  106s
H    0     0                    25890.018810 62110.8959   140%     -  113s
H    0     0                    26081.685224 62110.8959   138%     -  113s
H    0     0                    26091.581310 62110.8959   138%     -  113s
H    0     0                    26116.858546 62110.8959   138%     -  113s
     0     0 59296.4183    0  321 26116.8585 59296.4183   127%     -  113s
     0     0 59296.4183    0  319 26116.8585 59296.4183   127%     -  118s
     0     0 59296.4183    0  276 26116.8585 59296.4183   127%     -  121s
     0     0 59296.4183    0  323 26116.8585 59296.4183   127%     -  124s
     0     0 59296.4183    0  331 26116.8585 59296.4183   127%     -  125s
     0     0 59296.4183    0  331 26116.8585 59296.4183   127%     -  127s
H    0     0                    26357.587168 58501.6349   122%     -  173s
H    0     0                    26406.788198 58501.6349   122%     -  173s
H    0     0                    26435.910825 58501.6349   121%     -  173s
H    0     0                    26556.341033 58501.6349   120%     -  173s
     0     0 58501.6349    0  302 26556.3410 58501.6349   120%     -  173s
H    0     0                    27888.673756 58500.8263   110%     -  173s
H    0     0                    28488.395541 58500.8263   105%     -  174s
     0     0 57865.2519    0  385 28488.3955 57865.2519   103%     -  204s
     0     0 57768.9178    0  386 28488.3955 57768.9178   103%     -  218s
     0     0 57675.8361    0  389 28488.3955 57675.8361   102%     -  233s
     0     0 57614.0526    0  442 28488.3955 57614.0526   102%     -  243s
     0     0 57595.4573    0  405 28488.3955 57595.4573   102%     -  249s
     0     0 57577.2952    0  411 28488.3955 57577.2952   102%     -  255s
     0     0 57569.8897    0  401 28488.3955 57569.8897   102%     -  259s
     0     0 57475.4863    0  406 28488.3955 57475.4863   102%     -  269s
     0     0 57442.8913    0  395 28488.3955 57442.8913   102%     -  275s
     0     0 57436.4650    0  397 28488.3955 57436.4650   102%     -  278s
     0     0 57434.6978    0  397 28488.3955 57434.6978   102%     -  281s
H    0     0                    31533.655269 57424.6636  82.1%     -  283s
     0     0 57424.6636    0  399 31533.6553 57424.6636  82.1%     -  283s
     0     0 57420.5576    0  395 31533.6553 57420.5576  82.1%     -  285s
     0     0 57420.0878    0  392 31533.6553 57420.0878  82.1%     -  286s
H    0     0                    31803.252820 55544.6924  74.7%     -  340s
     0     0 55544.6924    0  311 31803.2528 55544.6924  74.7%     -  340s
     0     0 54991.4485    0  325 31803.2528 54991.4485  72.9%     -  363s
     0     0 54871.8112    0  331 31803.2528 54871.8112  72.5%     -  373s
     0     0 54771.5304    0  347 31803.2528 54771.5304  72.2%     -  381s
     0     0 54661.7024    0  332 31803.2528 54661.7024  71.9%     -  389s
     0     0 54572.3227    0  323 31803.2528 54572.3227  71.6%     -  397s
     0     0 54526.3542    0  388 31803.2528 54526.3542  71.4%     -  404s
     0     0 54479.1246    0  333 31803.2528 54479.1246  71.3%     -  412s
     0     0 54450.0142    0  336 31803.2528 54450.0142  71.2%     -  417s
     0     0 54417.9907    0  342 31803.2528 54417.9907  71.1%     -  423s
     0     0 54383.4001    0  399 31803.2528 54383.4001  71.0%     -  428s
     0     0 54373.7318    0  330 31803.2528 54373.7318  71.0%     -  433s
     0     0 54371.7985    0  338 31803.2528 54371.7985  71.0%     -  434s
     0     0 53262.4271    0  407 31803.2528 53262.4271  67.5%     -  475s
H    0     0                    32901.509539 53032.0405  61.2%     -  490s
H    0     0                    32904.848180 53032.0405  61.2%     -  490s
H    0     0                    33060.875676 53032.0405  60.4%     -  490s
     0     0 53032.0405    0  426 33060.8757 53032.0405  60.4%     -  490s
H    0     0                    33207.428062 52955.0994  59.5%     -  498s
     0     0 52955.0994    0  414 33207.4281 52955.0994  59.5%     -  498s
     0     0 52908.4799    0  365 33207.4281 52908.4799  59.3%     -  505s
     0     0 52898.1106    0  459 33207.4281 52898.1106  59.3%     -  509s
     0     0 52890.8539    0  463 33207.4281 52890.8539  59.3%     -  511s
     0     0 52885.0052    0  474 33207.4281 52885.0052  59.3%     -  513s
     0     0 52876.0846    0  461 33207.4281 52876.0846  59.2%     -  517s
     0     0 52873.7280    0  458 33207.4281 52873.7280  59.2%     -  519s
     0     0 52871.9329    0  460 33207.4281 52871.9329  59.2%     -  520s
H    0     0                    33237.625934 52645.8397  58.4%     -  532s
     0     0 52645.8397    0  373 33237.6259 52645.8397  58.4%     -  532s
H    0     0                    33452.679768 52644.9541  57.4%     -  533s
     0     0 52610.9392    0  376 33452.6798 52610.9392  57.3%     -  538s
     0     0 52591.6341    0  423 33452.6798 52591.6341  57.2%     -  541s
     0     0 52572.6932    0  377 33452.6798 52572.6932  57.2%     -  547s
     0     0 52565.7430    0  375 33452.6798 52565.7430  57.1%     -  549s
     0     0 52529.0647    0  375 33452.6798 52529.0647  57.0%     -  554s
     0     0 52506.4643    0  384 33452.6798 52506.4643  57.0%     -  560s
     0     0 52481.7356    0  380 33452.6798 52481.7356  56.9%     -  562s
     0     0 52475.3831    0  380 33452.6798 52475.3831  56.9%     -  564s
     0     0 52471.6977    0  386 33452.6798 52471.6977  56.9%     -  565s
     0     0 52470.8265    0  386 33452.6798 52470.8265  56.9%     -  565s
     0     0 52372.8523    0  423 33452.6798 52372.8523  56.6%     -  577s
     0     0 52350.5141    0  356 33452.6798 52350.5141  56.5%     -  584s
     0     0 52348.0753    0  424 33452.6798 52348.0753  56.5%     -  587s
     0     0 52297.9046    0  388 33452.6798 52297.9046  56.3%     -  593s
H    0     0                    33459.943846 52297.8561  56.3%     -  594s
     0     0 52294.7042    0  384 33459.9438 52294.7042  56.3%     -  596s
     0     0 52293.1497    0  387 33459.9438 52293.1497  56.3%     -  598s
     0     0 52253.0102    0  386 33459.9438 52253.0102  56.2%     -  604s
     0     0 52235.4400    0  388 33459.9438 52235.4400  56.1%     -  608s
     0     0 52234.2121    0  388 33459.9438 52234.2121  56.1%     -  609s
     0     0 52219.7558    0  376 33459.9438 52219.7558  56.1%     -  613s
H    0     0                    33532.594432 52219.6898  55.7%     -  613s
     0     0 52216.6476    0  379 33532.5944 52216.6476  55.7%     -  614s
     0     0 52214.4150    0  375 33532.5944 52214.4150  55.7%     -  615s
     0     0 52200.8727    0  360 33532.5944 52200.8727  55.7%     -  620s
H    0     0                    33595.881403 52200.7146  55.4%     -  623s
     0     0 52185.8171    0  367 33595.8814 52185.8171  55.3%     -  626s
     0     0 52182.9037    0  373 33595.8814 52182.9037  55.3%     -  628s
     0     0 52182.5256    0  374 33595.8814 52182.5256  55.3%     -  629s
     0     0 52171.9709    0  377 33595.8814 52171.9709  55.3%     -  631s
H    0     0                    33643.470038 52171.9028  55.1%     -  631s
H    0     0                    33697.577516 52171.9028  54.8%     -  631s
     0     0 52168.7004    0  378 33697.5775 52168.7004  54.8%     -  633s
     0     0 52168.0866    0  373 33697.5775 52168.0866  54.8%     -  633s
     0     0 52165.9819    0  376 33697.5775 52165.9819  54.8%     -  635s
H    0     0                    33930.534399 52165.8195  53.7%     -  647s
     0     0 52165.8195    0  382 33930.5344 52165.8195  53.7%     -  647s
     0     0 52161.8090    0  373 33930.5344 52161.8090  53.7%     -  651s
     0     0 52161.6631    0  373 33930.5344 52161.6631  53.7%     -  652s
H    0     0                    33934.401936 52161.6631  53.7%     -  703s
H    0     0                    34020.414316 52161.6631  53.3%     -  703s
H    0     0                    34040.305787 52161.6631  53.2%     -  738s
     0     2 52161.6631    0  373 34040.3058 52161.6631  53.2%     -  739s
     1     3 51873.9663    1  349 34040.3058 52161.6631  53.2%  5974  744s
     2     5 51695.4432    2  368 34040.3058 52161.6631  53.2%  6316  750s
     4    10 51737.0719    2  422 34040.3058 52058.3051  52.9%  7684  758s
     9    17 51571.2053    3  412 34040.3058 51928.2875  52.5%  7572  773s
    16    32 50789.9512    4  416 34040.3058 51864.1909  52.4% 10789  791s
    31    47 50141.3373    5  355 34040.3058 51863.9895  52.4% 14220  850s
    46    77 50396.2291    5  350 34040.3058 51567.0531  51.5% 14626  880s
H   53    77                    34284.326297 51567.0531  50.4% 14417  880s
H   61    77                    34500.833977 51567.0531  49.5% 14102  880s
H   65    77                    34691.296977 51567.0531  48.6% 13768  880s
H   67    77                    34735.464046 51567.0531  48.5% 13561  880s
    76   188 50252.2124    6  350 34735.4640 51567.0531  48.5% 12987  904s
H  187   226                    34740.362287 51567.0531  48.4%  9185  937s
H  190   226                    34743.621056 51567.0531  48.4%  9087  937s
H  195   226                    34820.731918 51567.0531  48.1%  9091  937s
H  199   226                    34844.344282 51567.0531  48.0%  8989  937s
H  209   226                    34874.641492 51567.0531  47.9%  8790  937s
H  222   226                    34889.293082 51567.0531  47.8%  8591  937s
   225   277 49979.0679    8  293 34889.2931 51567.0531  47.8%  8587  954s
   276   334 49826.9674   10  331 34889.2931 51567.0531  47.8%  8092  969s
H  277   334                    34923.552491 51567.0531  47.7%  8063  969s
H  307   334                    34925.149781 51567.0531  47.7%  7730  969s
   335   385 49423.6521   10  290 34925.1498 51567.0531  47.7%  7536  985s
   392   414 49187.5521   11  340 34925.1498 51567.0531  47.7%  7406  999s
   421   442 49096.4223   12  337 34925.1498 51567.0531  47.7%  7327 1013s
   455   473 48885.6311   13  331 34925.1498 51567.0531  47.7%  7659 1036s
   486   516 46858.6188   15  222 34925.1498 51567.0531  47.7%  7458 1049s
   529   559 48811.9678   14  384 34925.1498 51567.0531  47.7%  7167 1066s
   572   605 48662.6938   15  388 34925.1498 51567.0531  47.7%  6919 1089s
   622   653 47037.9358   14  223 34925.1498 51567.0531  47.7%  6672 1113s
   678   702 48209.1150   16  300 34925.1498 51567.0531  47.7%  6424 1128s
   731   765 48154.4836   17  351 34925.1498 51567.0531  47.7%  6295 1146s
   798   812 47602.5833   18  365 34925.1498 51567.0531  47.7%  6041 1169s
   862   843 46827.4317   16  223 34925.1498 51567.0531  47.7%  5792 1193s
   919   877 46298.4511   19  279 34925.1498 51567.0531  47.7%  5698 1215s
   961   936 46276.6480   18  188 34925.1498 51567.0531  47.7%  5648 1231s
  1030  1020 45485.3201   20  344 34925.1498 51567.0531  47.7%  5544 1245s
  1142  1046 41761.0146   40  151 34925.1498 51567.0531  47.7%  5251 1262s
  1198  1110 45468.1676   21  341 34925.1498 51567.0531  47.7%  5137 1278s
  1292  1198 45278.9436   22  352 34925.1498 51567.0531  47.7%  4978 1295s
  1410  1274 44414.0537   22  198 34925.1498 51567.0531  47.7%  4761 1314s
  1522  1356 45273.9019   23  354 34925.1498 51567.0531  47.7%  4596 1330s
  1652  1407 45241.2306   24  292 34925.1498 51540.1391  47.6%  4370 1350s
  1751  1451 45137.4855   25  277 34925.1498 51540.1391  47.6%  4288 1369s
H 1773  1451                    34954.336382 51540.1391  47.4%  4266 1369s
  1838  1527 44977.2195   26  275 34954.3364 51540.1391  47.4%  4245 1392s
  1956  1597 42856.7299   28  272 34954.3364 51540.1391  47.4%  4189 1415s
  2056  1684 43884.7473   30  266 34954.3364 51540.1391  47.4%  4184 1438s
  2183  1786 43209.4741   33  248 34954.3364 51540.1391  47.4%  4156 1464s
  2327  1815 40894.8774   34  189 34954.3364 51540.1391  47.4%  4110 1485s
  2360  1841 41439.5338   35  255 34954.3364 51540.1391  47.4%  4131 1506s
H 2373  1840                    35039.549454 51539.4796  47.1%  4127 1506s
  2397  1980 41389.3563   36  254 35039.5495 50981.3786  45.5%  4127 1531s
  2603  2081 40493.3473   40  242 35039.5495 50789.9366  45.0%  4023 1558s
  2796  2175 38579.4770   51  155 35039.5495 50789.9366  45.0%  3949 1586s
  2962  2339 37047.2863   63  112 35039.5495 50700.0788  44.7%  3922 1614s
  3161  2477     cutoff   74      35039.5495 50608.1348  44.4%  3858 1644s
  3359  2596 48587.4279   11  358 35039.5495 50608.1348  44.4%  3815 1675s
  3551  2655 47636.0020   14  348 35039.5495 50368.8901  43.7%  3798 1712s
  3660  2765 46645.3405   16  344 35039.5495 50368.8901  43.7%  3839 1748s
  3783  2766 41458.3173   48  373 35039.5495 50232.2505  43.4%  3890 1929s
H 3784  2628                    35054.301507 50232.2505  43.3%  3889 1939s
  3785  2628 44335.8834   10  234 35054.3015 50232.2505  43.3%  3888 1941s
  3786  2629 35960.6272   46  337 35054.3015 50232.2505  43.3%  3887 2013s
  3787  2630 36719.5270   36  335 35054.3015 50232.2505  43.3%  3886 2066s
  3788  2630 39384.3540   29  329 35054.3015 50232.2505  43.3%  3885 2107s
  3789  2631 41216.0142   31  350 35054.3015 50232.2505  43.3%  3884 2136s
  3790  2632 37167.4850   59  350 35054.3015 50232.2505  43.3%  3883 2155s
  3791  2632 47803.6524   14  348 35054.3015 50232.2505  43.3%  3882 2181s
  3792  2633 48094.0932   13  401 35054.3015 50232.2505  43.3%  3881 2197s
  3793  2634 36980.1772   28  372 35054.3015 50232.2505  43.3%  3880 2207s
  3794  2634 37547.0648   56  378 35054.3015 50232.2505  43.3%  3879 2215s
  3795  2635 42671.8310   30  374 35054.3015 50232.2505  43.3%  3878 2227s
  3796  2636 36644.8528   35  417 35054.3015 50232.2505  43.3%  3877 2235s
  3797  2636 45237.8861   19  380 35054.3015 50232.2505  43.3%  3876 2245s
  3798  2637 36145.1412   65  373 35054.3015 50232.2505  43.3%  3875 2251s
  3799  2638 43499.8400   25  371 35054.3015 50232.2505  43.3%  3874 2257s
  3800  2638 45841.7111   17  375 35054.3015 50232.2505  43.3%  3873 2261s
  3801  2639 47737.3287   16  384 35054.3015 50232.2505  43.3%  3872 2265s
  3803  2640 43935.0863   21  374 35054.3015 50232.2505  43.3%  3870 2279s
  3804  2641 45563.8130   22  372 35054.3015 50232.2505  43.3%  3869 2287s
  3805  2642 37514.1794   59  377 35054.3015 50232.2505  43.3%  3868 2291s
  3806  2642 39693.4298   39  384 35054.3015 50232.2505  43.3%  3867 2296s
  3807  2643 37947.8285   30  421 35054.3015 50232.2505  43.3%  3866 2311s
  3809  2644 42075.9700   13  386 35054.3015 50232.2505  43.3%  3864 2318s
  3810  2645 36198.9521   37  421 35054.3015 50232.2505  43.3%  3862 2325s
  3812  2646 47188.3574   17  367 35054.3015 50232.2505  43.3%  3860 2334s
  3813  2647 39597.0117   48  374 35054.3015 50232.2505  43.3%  3859 2337s
  3814  2648 39514.7322   27  375 35054.3015 50232.2505  43.3%  3858 2348s
  3815  2648 46938.5049   21  370 35054.3015 50232.2505  43.3%  3857 2355s
  3816  2649 40533.1892   55  357 35054.3015 50232.2505  43.3%  3856 2367s
  3817  2650 37343.8804   33  357 35054.3015 50232.2505  43.3%  3855 2370s
  3818  2650 43441.6516   21  359 35054.3015 50232.2505  43.3%  3854 2376s
  3820  2652 48619.8435    8  361 35054.3015 50232.2505  43.3%  3852 2385s
  3821  2652 36709.5112   39  361 35054.3015 50232.2505  43.3%  3851 2400s
  3822  2653 38560.4117   19  361 35054.3015 50232.2505  43.3%  3850 2496s
  3823  2656 50232.2505   13  408 35054.3015 50232.2505  43.3%  3946 2536s
  3824  2658 50232.2505   14  344 35054.3015 50232.2505  43.3%  3948 2581s
  3827  2663 50031.9527   15  291 35054.3015 50232.2505  43.3%  3953 2627s
  3833  2673 49327.6733   16  404 35054.3015 50232.2505  43.3%  3977 2671s
  3845  2681 49533.9427   16  408 35054.3015 50232.2505  43.3%  4048 2736s
  3857  2709 47871.9103   17  460 35054.3015 50232.2505  43.3%  4133 2811s
  3889  2817 47003.4982   18  380 35054.3015 49928.6350  42.4%  4309 2861s
  4007  2809 46599.7428   20  414 35054.3015 49928.3526  42.4%  4510 2887s
  4039  2831 46037.7884   20  413 35054.3015 49928.3526  42.4%  4551 2936s
  4073  2850 45557.1329   20  345 35054.3015 49928.3526  42.4%  4595 2964s
  4107  2864 45694.9182   21  400 35054.3015 49928.3526  42.4%  4667 2993s
  4144  2881 45110.4737   21  382 35054.3015 49928.3526  42.4%  4751 3023s
  4178  2898 42171.8078   21  318 35054.3015 49928.3526  42.4%  4782 3061s
  4212  2920 42045.4329   22  311 35054.3015 49928.3526  42.4%  4816 3092s
  4252  2942 42606.2966   21  354 35054.3015 49627.5878  41.6%  4845 3120s
  4289  2966 45211.5117   22  395 35054.3015 49627.5878  41.6%  4869 3144s
  4329  2983 42564.9494   22  368 35054.3015 49627.5878  41.6%  4876 3171s
  4372  3001 40245.2356   22  205 35054.3015 49627.5878  41.6%  4889 3200s
  4412  3020 42258.8114   23  334 35054.3015 49627.5878  41.6%  4903 3224s
  4451  3044 41202.2037   22  327 35054.3015 49627.5878  41.6%  4932 3247s
  4494  3066 40868.0241   23  289 35054.3015 49627.5878  41.6%  4943 3272s
  4541  3078 40854.9587   24  283 35054.3015 49627.5878  41.6%  4954 3310s
  4588  3087 41334.5563   23  298 35054.3015 49627.5878  41.6%  4963 3339s
  4640  3098 41147.5548   24  322 35054.3015 49627.5878  41.6%  4974 3376s
  4682  3115 40005.5552   24  263 35054.3015 49627.5878  41.6%  4989 3405s
  4737  3117 38249.2198   25  271 35054.3015 49627.5878  41.6%  5000 3434s
  4796  3120 39510.0275   25  271 35054.3015 49627.5878  41.6%  5010 3471s
  4833  3133 40287.1989   25  299 35054.3015 49627.5878  41.6%  5033 3502s
  4871  3148 39839.8131   26  296 35054.3015 48813.1211  39.3%  5054 3532s
  4905  3161 39404.3730   27  320 35054.3015 48813.1211  39.3%  5075 3561s
  4946  3175 38248.4093   28  308 35054.3015 48813.1211  39.3%  5086 3596s
  4985  3161 35217.9741   47  143 35054.3015 48695.2496  38.9%  5123 3600s

Cutting planes:
  Learned: 3
  Gomory: 42
  Implied bound: 42
  Projected implied bound: 225
  MIR: 1459
  Mixing: 5
  Flow cover: 1670
  RLT: 52
  Relax-and-lift: 394

Explored 4999 nodes (26138849 simplex iterations) in 3600.05 seconds (8722.79 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 35054.3 35039.5 34954.3 ... 34743.6

Time limit reached
Best objective 3.505430150670e+04, best bound 4.869524956784e+04, gap 38.9138%
  WARNING: Time limit reached. Using best solution found (gap: 38.91%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 35054.30, θ = 187909.90
  Upper Bound (UB) = 35054.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 187909.90
  [DEBUG]   ✓ Scenario 0: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 187909.90 ≤ Q = 187909.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 187909.90 ≤ Q = 187909.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 187909.90 ≤ Q = 187909.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 187909.90 ≤ Q = 187909.90 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x53bf2bc2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xac40d43e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.400925e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6840515.6121
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.588451e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158845.10    0  124 6840515.61 -158845.10   102%     -    0s
H    0     0                    -124194.6760 -158845.10  27.9%     -    0s
H    0     0                    -125275.5116 -158845.10  26.8%     -    0s
     0     0 -141930.53    0   81 -125275.51 -141930.53  13.3%     -    0s
H    0     0                    -137787.8473 -141804.27  2.91%     -    0s
H    0     0                    -138618.1295 -141804.27  2.30%     -    0s
     0     0 -140104.26    0   82 -138618.13 -140104.26  1.07%     -    0s
     0     0 -139954.21    0   82 -138618.13 -139954.21  0.96%     -    0s
     0     0 -139452.94    0   36 -138618.13 -139452.94  0.60%     -    0s
     0     0 -139255.01    0   39 -138618.13 -139255.01  0.46%     -    0s
     0     0 -139189.39    0   40 -138618.13 -139189.39  0.41%     -    0s
     0     0 -139159.69    0   37 -138618.13 -139159.69  0.39%     -    0s
     0     0 -138908.04    0   14 -138618.13 -138908.04  0.21%     -    0s
     0     0 -138826.89    0   30 -138618.13 -138826.89  0.15%     -    0s
     0     0 -138821.41    0   22 -138618.13 -138821.41  0.15%     -    0s
     0     0 -138817.97    0   22 -138618.13 -138817.97  0.14%     -    0s
     0     0 -138745.72    0    7 -138618.13 -138745.72  0.09%     -    0s
     0     0 -138745.72    0   12 -138618.13 -138745.72  0.09%     -    0s
H    0     0                    -138644.6813 -138745.72  0.07%     -    0s
     0     0 -138673.56    0    4 -138644.68 -138673.56  0.02%     -    0s
     0     0 -138673.49    0    2 -138644.68 -138673.49  0.02%     -    0s
H    0     0                    -138671.5858 -138673.01  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (832 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -138672 -138645 -138618 ... 1.40092e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.386715858240e+05, best bound -1.386730085129e+05, gap 0.0010%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 176525.46
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138671.59
  [DEBUG]   S×d_nominal = 315197.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 315197.04 + -138671.59 = 176525.46
  [DEBUG]   Current θ from Master = 187909.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11384.44 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23669.86
  Lower Bound (LB) = 28726.80
  Gap (UB-LB) = 6327.5064, Absolute Gap = 6327.5064, Relative Gap = 0.180506
  Not converged yet (gap = 6327.51 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0xa2d298d4
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 1.74s
Presolved: 100023 rows, 42700 columns, 606983 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -341299.9943
Found heuristic solution: objective -170340.0845

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 613
 AA' NZ     : 3.659e+06
 Factor NZ  : 8.480e+06 (roughly 130 MB of memory)
 Factor Ops : 1.584e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59397545e+07  1.91759301e+08  1.11e+05 1.69e+01  7.78e+04     3s
   1  -1.20727965e+07  1.75832026e+08  7.73e+04 6.78e+01  5.37e+04     3s
   2  -4.71090145e+06  1.28973926e+08  3.01e+04 2.53e+00  2.23e+04     3s
   3  -1.22597061e+06  1.06320945e+08  3.61e+03 1.51e+00  3.12e+03     3s
   4  -7.00823222e+05  8.20220574e+07  6.60e+02 1.00e+00  8.93e+02     3s
   5  -4.71420233e+05  4.53735942e+07  3.70e+02 4.64e-01  4.71e+02     3s
   6  -3.38361615e+05  3.43894717e+07  1.10e+02 3.28e-01  2.51e+02     3s
   7  -3.04892414e+05  2.37253209e+07  5.96e+01 2.15e-01  1.60e+02     3s
   8  -2.12122556e+05  1.53149903e+07  2.99e+00 1.32e-01  8.58e+01     3s
   9  -1.17854910e+05  6.06340907e+06  4.12e-01 5.12e-02  3.38e+01     3s
  10  -5.80257541e+04  2.53737109e+06  1.90e-01 2.06e-02  1.42e+01     3s
  11  -1.68083023e+04  6.52761355e+05  9.01e-02 4.65e-03  3.65e+00     3s
  12  -5.49226009e+02  3.41028297e+05  6.10e-02 2.04e-03  1.86e+00     3s
  13   7.69913421e+03  2.44198933e+05  4.90e-02 1.66e-03  1.29e+00     3s
  14   2.17674005e+04  1.99000749e+05  3.30e-02 1.24e-03  9.67e-01     3s
  15   2.79714198e+04  1.60180963e+05  2.74e-02 9.85e-04  7.21e-01     3s
  16   3.80531342e+04  1.31405487e+05  1.92e-02 7.05e-04  5.09e-01     3s
  17   4.61812138e+04  1.12634864e+05  1.32e-02 4.87e-04  3.62e-01     4s
  18   5.16798623e+04  9.75080238e+04  9.21e-03 3.91e-04  2.50e-01     4s
  19   5.52755954e+04  8.78134586e+04  6.81e-03 2.65e-04  1.77e-01     4s
  20   5.78355093e+04  8.43586687e+04  5.26e-03 2.24e-04  1.45e-01     4s
  21   5.95774651e+04  8.08189561e+04  4.24e-03 1.88e-04  1.16e-01     4s
  22   6.08544087e+04  7.60042467e+04  3.52e-03 1.21e-04  8.26e-02     4s
  23   6.17293584e+04  7.42479557e+04  3.04e-03 9.68e-05  6.83e-02     4s
  24   6.41228174e+04  7.16353986e+04  1.80e-03 5.64e-05  4.10e-02     4s
  25   6.52237974e+04  7.06896059e+04  1.28e-03 4.16e-05  2.98e-02     4s
  26   6.59748591e+04  6.98920195e+04  8.99e-04 2.95e-05  2.14e-02     4s
  27   6.64876218e+04  6.91478036e+04  6.61e-04 1.84e-05  1.45e-02     4s
  28   6.68388002e+04  6.88210886e+04  4.91e-04 1.34e-05  1.08e-02     4s
  29   6.71467224e+04  6.85477435e+04  3.44e-04 9.37e-06  7.64e-03     4s
  30   6.71793600e+04  6.84975142e+04  3.29e-04 8.62e-06  7.19e-03     4s
  31   6.72506621e+04  6.84147561e+04  2.96e-04 7.38e-06  6.35e-03     4s
  32   6.74560734e+04  6.82111014e+04  2.01e-04 4.25e-06  4.12e-03     4s
  33   6.75812456e+04  6.81030042e+04  1.45e-04 2.62e-06  2.85e-03     4s
  34   6.76993174e+04  6.80524880e+04  9.46e-05 1.87e-06  1.93e-03     4s
  35   6.77370896e+04  6.79940247e+04  7.69e-05 1.01e-06  1.40e-03     4s
  36   6.78002740e+04  6.79638205e+04  5.03e-05 6.59e-07  8.92e-04     5s
  37   6.78532429e+04  6.79560603e+04  2.84e-05 5.61e-07  5.61e-04     5s
  38   6.78744636e+04  6.79403010e+04  1.93e-05 3.14e-07  3.59e-04     5s
  39   6.79050760e+04  6.79289552e+04  5.89e-06 1.35e-07  1.30e-04     5s
  40   6.79137065e+04  6.79213505e+04  2.38e-06 4.05e-07  4.17e-05     5s
  41   6.79174915e+04  6.79202712e+04  9.95e-07 1.63e-08  1.52e-05     5s
  42   6.79202012e+04  6.79202254e+04  1.48e-08 4.99e-10  1.32e-07     5s
  43   6.79202185e+04  6.79202187e+04  6.93e-09 9.36e-10  9.99e-10     5s

Barrier solved model in 43 iterations and 4.82 seconds (8.47 work units)
Optimal objective 6.79202185e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 8s

    8146 PPushes remaining with PInf 5.1599995e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.1052146e+03      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44344    6.7920219e+04   0.000000e+00   8.105215e+03      8s
   44489    6.7920219e+04   0.000000e+00   0.000000e+00      8s
   44489    6.7920219e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 4.51s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.792022e+04, 44489 iterations, 10.59 seconds (15.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67920.2187    0  248 -170340.08 67920.2187   140%     -   13s
H    0     0                    -161668.8626 67920.2187   142%     -   13s
H    0     0                    -59345.50176 67920.2187   214%     -   13s
H    0     0                    20595.711351 67920.2187   230%     -   13s
H    0     0                    20919.525410 67920.2187   225%     -   13s
H    0     0                    21664.155104 67920.2187   214%     -   14s
H    0     0                    21850.248628 67920.2187   211%     -   14s
H    0     0                    22576.211477 67920.2187   201%     -   15s
H    0     0                    22829.688672 67920.2187   198%     -   15s
H    0     0                    23092.453441 67920.2187   194%     -   15s
H    0     0                    23098.814057 67920.2187   194%     -   15s
H    0     0                    23137.439815 67920.2187   194%     -   15s
H    0     0                    23157.804780 67920.2187   193%     -   15s
H    0     0                    23197.199707 62762.3693   171%     -   56s
H    0     0                    23278.847146 62762.3693   170%     -   56s
     0     0 62751.9027    0  301 23278.8471 62751.9027   170%     -   56s
H    0     0                    23372.439687 62751.9027   168%     -   56s
     0     0 62079.8084    0  346 23372.4397 62079.8084   166%     -   72s
     0     0 61925.7984    0  341 23372.4397 61925.7984   165%     -   84s
     0     0 61898.8184    0  348 23372.4397 61898.8184   165%     -   93s
     0     0 61898.8184    0  351 23372.4397 61898.8184   165%     -   95s
     0     0 61898.8184    0  349 23372.4397 61898.8184   165%     -   97s
     0     0 61898.8184    0  356 23372.4397 61898.8184   165%     -   99s
     0     0 61898.8184    0  354 23372.4397 61898.8184   165%     -   99s
     0     0 61881.9561    0  356 23372.4397 61881.9561   165%     -  101s
     0     0 61881.9252    0  354 23372.4397 61881.9252   165%     -  102s
H    0     0                    25711.411981 58268.8323   127%     -  158s
H    0     0                    25901.645511 58268.8323   125%     -  158s
H    0     0                    25906.176471 58268.8323   125%     -  158s
H    0     0                    25931.783844 58268.8323   125%     -  158s
     0     0 58268.8323    0  380 25931.7838 58268.8323   125%     -  158s
H    0     0                    30578.334459 58268.7977  90.6%     -  158s
H    0     0                    30649.793483 58268.7977  90.1%     -  159s
H    0     0                    30893.854933 58268.7977  88.6%     -  159s
H    0     0                    31029.477060 58268.7977  87.8%     -  159s
     0     0 57793.7741    0  399 31029.4771 57793.7741  86.3%     -  183s
     0     0 57686.9743    0  379 31029.4771 57686.9743  85.9%     -  204s
     0     0 57564.5160    0  383 31029.4771 57564.5160  85.5%     -  218s
     0     0 57446.3588    0  414 31029.4771 57446.3588  85.1%     -  236s
     0     0 57363.8627    0  389 31029.4771 57363.8627  84.9%     -  251s
     0     0 57337.0562    0  381 31029.4771 57337.0562  84.8%     -  259s
     0     0 57218.5408    0  432 31029.4771 57218.5408  84.4%     -  274s
     0     0 57188.0559    0  434 31029.4771 57188.0559  84.3%     -  284s
     0     0 57170.4417    0  423 31029.4771 57170.4417  84.2%     -  292s
     0     0 56918.5547    0  408 31029.4771 56918.5547  83.4%     -  311s
     0     0 56857.6144    0  415 31029.4771 56857.6144  83.2%     -  321s
     0     0 56843.9770    0  434 31029.4771 56843.9770  83.2%     -  328s
     0     0 56836.0647    0  423 31029.4771 56836.0647  83.2%     -  331s
     0     0 56814.9564    0  441 31029.4771 56814.9564  83.1%     -  337s
     0     0 56803.5861    0  398 31029.4771 56803.5861  83.1%     -  342s
     0     0 56799.1215    0  445 31029.4771 56799.1215  83.0%     -  344s
     0     0 56798.4604    0  443 31029.4771 56798.4604  83.0%     -  345s
H    0     0                    32255.082291 56798.4604  76.1%     -  360s
H    0     0                    32687.157968 56798.4604  73.8%     -  360s
H    0     0                    32742.236721 56798.4604  73.5%     -  360s
H    0     0                    32761.780759 56798.4604  73.4%     -  360s
     0     0 54760.9576    0  402 32761.7808 54760.9576  67.1%     -  408s
H    0     0                    33024.680763 54499.1346  65.0%     -  430s
     0     0 54499.1346    0  442 33024.6808 54499.1346  65.0%     -  430s
     0     0 54432.1742    0  464 33024.6808 54432.1742  64.8%     -  442s
     0     0 54395.0196    0  463 33024.6808 54395.0196  64.7%     -  450s
     0     0 54348.0404    0  470 33024.6808 54348.0404  64.6%     -  458s
     0     0 54318.2510    0  468 33024.6808 54318.2510  64.5%     -  465s
     0     0 54238.8382    0  438 33024.6808 54238.8382  64.2%     -  472s
     0     0 54191.1030    0  373 33024.6808 54191.1030  64.1%     -  480s
     0     0 54174.1894    0  377 33024.6808 54174.1894  64.0%     -  484s
     0     0 54163.5845    0  430 33024.6808 54163.5845  64.0%     -  489s
     0     0 54148.6893    0  381 33024.6808 54148.6893  64.0%     -  495s
     0     0 54142.9294    0  433 33024.6808 54142.9294  63.9%     -  498s
     0     0 54141.3702    0  368 33024.6808 54141.3702  63.9%     -  500s
H    0     0                    33115.214586 54141.3702  63.5%     -  512s
     0     0 53280.9988    0  362 33115.2146 53280.9988  60.9%     -  541s
     0     0 53067.0004    0  382 33115.2146 53067.0004  60.2%     -  558s
     0     0 52968.2164    0  411 33115.2146 52968.2164  60.0%     -  569s
     0     0 52879.6327    0  442 33115.2146 52879.6327  59.7%     -  578s
     0     0 52841.7216    0  477 33115.2146 52841.7216  59.6%     -  586s
     0     0 52789.4543    0  524 33115.2146 52789.4543  59.4%     -  594s
     0     0 52772.7470    0  520 33115.2146 52772.7470  59.4%     -  598s
     0     0 52760.9347    0  376 33115.2146 52760.9347  59.3%     -  603s
     0     0 52748.5099    0  484 33115.2146 52748.5099  59.3%     -  607s
     0     0 52747.2552    0  484 33115.2146 52747.2552  59.3%     -  609s
     0     0 52564.9907    0  516 33115.2146 52564.9907  58.7%     -  626s
H    0     0                    33206.856418 52564.9736  58.3%     -  627s
H    0     0                    33351.402848 52564.9736  57.6%     -  639s
     0     0 52491.8207    0  357 33351.4028 52491.8207  57.4%     -  655s
     0     0 52463.8355    0  371 33351.4028 52463.8355  57.3%     -  664s
     0     0 52437.9532    0  385 33351.4028 52437.9532  57.2%     -  670s
     0     0 52434.2665    0  379 33351.4028 52434.2665  57.2%     -  673s
     0     0 52431.0779    0  377 33351.4028 52431.0779  57.2%     -  674s
     0     0 52423.4226    0  378 33351.4028 52423.4226  57.2%     -  676s
     0     0 52420.2054    0  377 33351.4028 52420.2054  57.2%     -  680s
     0     0 52418.1157    0  373 33351.4028 52418.1157  57.2%     -  681s
     0     0 52310.3800    0  448 33351.4028 52310.3800  56.8%     -  691s
H    0     0                    33469.942134 52309.2821  56.3%     -  692s
H    0     0                    33667.149409 52309.2821  55.4%     -  692s
H    0     0                    33698.234934 52309.2821  55.2%     -  692s
     0     0 52298.5792    0  378 33698.2349 52298.5792  55.2%     -  697s
     0     0 52293.2252    0  509 33698.2349 52293.2252  55.2%     -  701s
     0     0 52289.7338    0  385 33698.2349 52289.7338  55.2%     -  703s
     0     0 52287.2083    0  393 33698.2349 52287.2083  55.2%     -  705s
     0     0 52278.0160    0  392 33698.2349 52278.0160  55.1%     -  707s
     0     0 52273.9299    0  397 33698.2349 52273.9299  55.1%     -  709s
     0     0 52272.0684    0  393 33698.2349 52272.0684  55.1%     -  710s
     0     0 52245.1944    0  380 33698.2349 52245.1944  55.0%     -  715s
     0     0 52234.2530    0  368 33698.2349 52234.2530  55.0%     -  719s
     0     0 52232.2314    0  370 33698.2349 52232.2314  55.0%     -  721s
     0     0 52216.2592    0  376 33698.2349 52216.2592  55.0%     -  726s
     0     0 52210.2679    0  382 33698.2349 52210.2679  54.9%     -  730s
     0     0 52209.3125    0  379 33698.2349 52209.3125  54.9%     -  731s
     0     0 52205.7665    0  382 33698.2349 52205.7665  54.9%     -  733s
     0     0 52204.7020    0  373 33698.2349 52204.7020  54.9%     -  735s
     0     0 52198.3183    0  379 33698.2349 52198.3183  54.9%     -  738s
     0     0 52197.1732    0  379 33698.2349 52197.1732  54.9%     -  740s
     0     2 52196.4235    0  379 33698.2349 52196.4235  54.9%     -  853s
     1     3 51594.0299    1  460 33698.2349 52196.4235  54.9% 16411  871s
     2     4 51971.7443    1  394 33698.2349 51971.7443  54.2% 14396  881s
     3     5 50840.1069    2  426 33698.2349 51971.7418  54.2% 12837  895s
     4    10 50505.9996    3  357 33698.2349 51971.7418  54.2% 13084  906s
     9    17 48988.2971    4  325 33698.2349 51585.3760  53.1% 11248  926s
    16    33 48724.2841    5  280 33698.2349 51458.0212  52.7% 13360  953s
    32    48 49616.7816    4  391 33698.2349 51261.8371  52.1% 16409 1727s
    47    78 49586.0345    6  351 33698.2349 51261.8371  52.1% 22043 1766s
H   56    78                    33795.320433 51261.8371  51.7% 20915 1766s
    77   175 49557.6850    7  345 33795.3204 51179.7874  51.4% 19281 1835s
   174   270 49379.9942    9  397 33795.3204 51179.7874  51.4% 12489 1860s
H  176   270                    33803.865416 51179.7874  51.4% 12417 1860s
   269   351 49187.0998   11  403 33803.8654 51179.7874  51.4% 10456 1883s
   350   382 49092.4660   13  386 33803.8654 51179.7874  51.4%  9094 1898s
   381   419 49074.6845   14  396 33803.8654 51179.7874  51.4%  8983 1914s
   418   458 46907.6753   15  278 33803.8654 51179.7874  51.4%  8610 1929s
   457   490 49065.4347   15  394 33803.8654 51179.7874  51.4%  8287 1948s
   489   529 46356.2603   17  236 33803.8654 51179.7874  51.4%  8208 1963s
H  495   529                    33814.845522 51179.7874  51.4%  8200 1963s
H  513   529                    33935.036167 51179.7874  50.8%  8224 1963s
   528   592 46325.0439   18  288 33935.0362 51179.7874  50.8%  8224 1982s
   591   652 48956.1887   14  395 33935.0362 51179.7874  50.8%  7855 2002s
   651   714 45548.6406   26  266 33935.0362 51179.7874  50.8%  7563 2022s
   713   801 45595.6558   15  392 33935.0362 51179.7874  50.8%  7275 2038s
   800   860 45089.6740   16  369 33935.0362 51179.7874  50.8%  6854 2056s
H  818   860                    34001.820454 51179.7874  50.5%  6786 2056s
   863   910 44979.0848   17  334 34001.8205 51179.7874  50.5%  6682 2073s
   935   980 44875.5403   18  328 34001.8205 51179.7874  50.5%  6501 2090s
  1017  1062 44769.2449   20  360 34001.8205 51179.7874  50.5%  6239 2108s
  1137  1173 44362.8745   22  231 34001.8205 51179.7874  50.5%  5877 2128s
  1260  1275 43462.2292   26  352 34001.8205 51176.3768  50.5%  5543 2148s
  1376  1351 43164.9623   28  179 34001.8205 51176.3768  50.5%  5288 2168s
  1500  1411 41126.4765   29  250 34001.8205 51176.3768  50.5%  5025 2193s
  1609  1507 40863.8595   33  283 34001.8205 51176.3768  50.5%  4885 2214s
  1721  1594 39515.8798   38  290 34001.8205 51176.3768  50.5%  4784 2237s
  1860  1600 39112.8197   39  282 34001.8205 51176.3768  50.5%  4617 2260s
H 1893  1600                    34081.245831 51176.3768  50.2%  4615 2260s
  1906  1666 39028.4495   40  252 34081.2458 51176.3768  50.2%  4619 2282s
  2033  1748 37769.2025   45  233 34081.2458 51176.3768  50.2%  4549 2307s
  2159  1820 36305.4138   57  140 34081.2458 51176.3768  50.2%  4472 2335s
  2280  1835 34876.1045   71  122 34081.2458 51176.3768  50.2%  4410 2361s
H 2290  1827                    34617.164991 51176.3768  47.8%  4405 2361s
  2315  1878     cutoff   72      34617.1650 51176.3768  47.8%  4410 2390s
  2426  1973     cutoff   52      34617.1650 50837.0866  46.9%  4371 2419s
  2596  2009 47707.0667    6  323 34617.1650 50734.3004  46.6%  4255 2447s
H 2664  2005                    34766.297689 50734.3004  45.9%  4248 2447s
  2680  2070 45143.6051    7  241 34766.2977 50734.3004  45.9%  4250 2481s
  2825  2150 44118.9065    8  222 34766.2977 50734.3004  45.9%  4194 2519s
  2931  2241 42405.1748   10  229 34766.2977 50734.3004  45.9%  4226 2558s
  3066  2316 40927.1519   12  133 34766.2977 50734.3004  45.9%  4218 2595s
  3187  2396 39246.7472   17   86 34766.2977 50734.3004  45.9%  4247 2629s
  3299  2472 38584.1114   23  138 34766.2977 50734.3004  45.9%  4263 2667s
  3399  2569 38020.7750   36   98 34766.2977 50734.3004  45.9%  4339 2706s
H 3565  2624                    35013.730835 50734.3004  44.9%  4332 2741s
H 3577  2601                    35202.358981 50734.3004  44.1%  4327 2741s
H 3627  2586                    35320.255131 50540.2441  43.1%  4310 2741s
  3689  2621 45571.0881    8  318 35320.2551 50540.2441  43.1%  4340 2781s
H 3700  2556                    35619.442767 50540.2441  41.9%  4334 2781s
H 3707  2543                    35669.047188 50540.2441  41.7%  4340 2781s
H 3707  2508                    35799.700899 50540.2441  41.2%  4340 2781s
  3788  2552 45228.7960    9  307 35799.7009 50540.2441  41.2%  4314 2832s
  3901  2582 43782.7090   12  276 35799.7009 50540.2441  41.2%  4351 2876s
H 3918  2530                    35973.595552 50540.2441  40.5%  4379 2876s
  3933  2584 43395.8071   13  264 35973.5956 50540.2441  40.5%  4410 2918s
  4028  2659 42126.8234   15  227 35973.5956 50540.2441  40.5%  4471 2978s
  4152  2660 37031.4685   49  379 35973.5956 50540.2441  40.5%  4527 3181s
  4154  2661 44869.3228   31  227 35973.5956 50540.2441  40.5%  4525 3195s
  4155  2662 41207.1158   21  296 35973.5956 50540.2441  40.5%  4524 3278s
  4156  2663 40687.4366   15  343 35973.5956 50540.2441  40.5%  4522 3387s
  4157  2663 41504.9974   59  336 35973.5956 50540.2441  40.5%  4521 3453s
  4158  2664 44759.5032   14  354 35973.5956 50540.2441  40.5%  4520 3495s
  4159  2665 42546.3813   27  336 35973.5956 50540.2441  40.5%  4519 3556s
  4160  2665 37913.5563   39  385 35973.5956 50540.2441  40.5%  4518 3577s
  4161  2666 36328.5309   35  349 35973.5956 50540.2441  40.5%  4517 3595s

Cutting planes:
  Learned: 1
  Gomory: 40
  Implied bound: 58
  Projected implied bound: 254
  MIR: 994
  Mixing: 2
  Flow cover: 615
  RLT: 54
  Relax-and-lift: 278

Explored 4161 nodes (19758862 simplex iterations) in 3600.03 seconds (7489.64 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 35973.6 35799.7 35669 ... 34081.2

Time limit reached
Best objective 3.597359555198e+04, best bound 5.054024411933e+04, gap 40.4926%
  WARNING: Time limit reached. Using best solution found (gap: 40.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 35973.60, θ = 190685.88
  Upper Bound (UB) = 35973.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190685.88
  [DEBUG]   ✓ Scenario 0: θ = 190685.88 ≤ Q = 190685.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190685.88 ≤ Q = 190685.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 190685.88 ≤ Q = 190685.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 190685.88 ≤ Q = 190685.88 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1e42a127
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe1bd5ed9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.415754e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1393 nonzeros
Found heuristic solution: objective 6826580.6412
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.621258e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162125.76    0  123 6826580.64 -162125.76   102%     -    0s
H    0     0                    -127520.6177 -162125.76  27.1%     -    0s
H    0     0                    -128330.7185 -162125.76  26.3%     -    0s
     0     0 -143682.90    0  126 -128330.72 -143682.90  12.0%     -    0s
H    0     0                    -137552.9018 -143522.84  4.34%     -    0s
     0     0 -141417.61    0  125 -137552.90 -141417.61  2.81%     -    0s
H    0     0                    -139274.9782 -141409.56  1.53%     -    0s
     0     0 -140584.05    0  106 -139274.98 -140584.05  0.94%     -    0s
     0     0 -140502.22    0  121 -139274.98 -140502.22  0.88%     -    0s
     0     0 -140489.80    0  120 -139274.98 -140489.80  0.87%     -    0s
     0     0 -140090.15    0   87 -139274.98 -140090.15  0.59%     -    0s
     0     0 -140048.90    0   87 -139274.98 -140048.90  0.56%     -    0s
     0     0 -140048.57    0   87 -139274.98 -140048.57  0.56%     -    0s
     0     0 -139823.03    0   61 -139274.98 -139823.03  0.39%     -    0s
H    0     0                    -139275.2290 -139762.93  0.35%     -    0s
     0     0 -139762.93    0   73 -139275.23 -139762.93  0.35%     -    0s
     0     0 -139762.93    0   74 -139275.23 -139762.93  0.35%     -    0s
     0     0 -139706.03    0   53 -139275.23 -139706.03  0.31%     -    0s
     0     0 -139685.35    0   53 -139275.23 -139685.35  0.29%     -    0s
     0     0 -139644.13    0   54 -139275.23 -139644.13  0.26%     -    0s
     0     0 -139634.63    0   54 -139275.23 -139634.63  0.26%     -    0s
     0     2 -139634.63    0   54 -139275.23 -139634.63  0.26%     -    0s
H   30    16                    -139282.8151 -139453.92  0.12%  14.6    0s
H   73    20                    -139329.9266 -139419.54  0.06%   8.7    0s
H  176    12                    -139352.1282 -139365.02  0.01%   4.8    0s

Cutting planes:
  Gomory: 42
  Implied bound: 16
  MIR: 115
  Flow cover: 20
  RLT: 99
  Relax-and-lift: 14
  BQP: 4

Explored 243 nodes (1803 simplex iterations) in 0.09 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139352 -139330 -139283 ... 1.41575e+13
No other solutions better than -139352

Optimal solution found (tolerance 1.00e-04)
Best objective -1.393521281940e+05, best bound -1.393521281940e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 181789.90
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139352.13
  [DEBUG]   S×d_nominal = 321142.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 321142.03 + -139352.13 = 181789.90
  [DEBUG]   Current θ from Master = 190685.88
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8895.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27077.62
  Lower Bound (LB) = 28726.80
  Gap (UB-LB) = 7246.8005, Absolute Gap = 7246.8005, Relative Gap = 0.201448
  Not converged yet (gap = 7246.80 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0xd0279b25
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 1.60s
Presolved: 108243 rows, 46070 columns, 654544 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -347235.2356
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 4.202e+06
 Factor NZ  : 1.010e+07 (roughly 140 MB of memory)
 Factor Ops : 2.244e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62117157e+07  2.06532300e+08  1.19e+05 1.63e+01  7.88e+04     3s
   1  -1.22692231e+07  1.89946224e+08  8.25e+04 7.49e+01  5.42e+04     3s
   2  -4.39881295e+06  1.39428992e+08  2.95e+04 2.42e+00  2.08e+04     3s
   3  -9.77414385e+05  1.04100647e+08  2.39e+03 1.43e+00  2.11e+03     3s
   4  -5.42807797e+05  6.54888057e+07  5.78e+02 7.18e-01  6.85e+02     3s
   5  -4.53708530e+05  3.69168218e+07  3.32e+02 3.21e-01  3.68e+02     3s
   6  -3.47741045e+05  2.58026488e+07  9.64e+01 2.02e-01  1.79e+02     3s
   7  -2.96071815e+05  1.83504816e+07  5.46e+01 1.37e-01  1.17e+02     3s
   8  -1.44363104e+05  1.30053319e+07  1.22e+00 9.17e-02  6.67e+01     3s
   9  -8.89522300e+04  6.46598396e+06  3.55e-01 4.42e-02  3.31e+01     3s
  10  -5.29011593e+04  3.12741040e+06  1.40e-01 2.07e-02  1.61e+01     3s
  11  -1.92354960e+04  1.26072634e+06  5.42e-02 7.75e-03  6.46e+00     3s
  12  -3.13059675e+03  6.49712154e+05  3.39e-02 3.70e-03  3.29e+00     3s
  13   1.07112137e+04  3.06793143e+05  1.69e-02 1.81e-03  1.49e+00     3s
  14   1.73122146e+04  2.28301764e+05  1.29e-02 1.26e-03  1.06e+00     3s
  15   2.56486668e+04  1.87363045e+05  9.41e-03 9.58e-04  8.16e-01     3s
  16   3.24157266e+04  1.48586706e+05  7.18e-03 7.12e-04  5.86e-01     4s
  17   4.12599349e+04  1.14342950e+05  4.72e-03 4.24e-04  3.69e-01     4s
  18   4.50461558e+04  1.02084270e+05  3.89e-03 3.50e-04  2.88e-01     4s
  19   4.95437687e+04  9.10634466e+04  2.89e-03 2.47e-04  2.09e-01     4s
  20   5.16146504e+04  8.40979210e+04  2.48e-03 1.80e-04  1.64e-01     4s
  21   5.49525805e+04  7.99011624e+04  1.84e-03 1.38e-04  1.26e-01     4s
  22   5.61144465e+04  7.87274612e+04  1.63e-03 1.26e-04  1.14e-01     4s
  23   5.75931178e+04  7.63104063e+04  1.35e-03 1.03e-04  9.44e-02     4s
  24   5.90399768e+04  7.47014814e+04  1.11e-03 8.78e-05  7.90e-02     4s
  25   6.07810530e+04  7.20238638e+04  8.20e-04 5.97e-05  5.67e-02     4s
  26   6.15600652e+04  7.01103498e+04  6.95e-04 3.94e-05  4.31e-02     4s
  27   6.27200043e+04  6.85970517e+04  5.12e-04 2.36e-05  2.96e-02     4s
  28   6.36523939e+04  6.75149753e+04  3.71e-04 1.28e-05  1.95e-02     4s
  29   6.44368308e+04  6.72404491e+04  2.56e-04 9.86e-06  1.41e-02     4s
  30   6.50559537e+04  6.67886808e+04  1.67e-04 5.08e-06  8.74e-03     4s
  31   6.53254717e+04  6.66872174e+04  1.29e-04 4.03e-06  6.87e-03     4s
  32   6.55498772e+04  6.65917981e+04  9.78e-05 3.04e-06  5.26e-03     4s
  33   6.58427597e+04  6.64930234e+04  5.68e-05 2.06e-06  3.28e-03     5s
  34   6.60034391e+04  6.64050085e+04  3.47e-05 1.28e-06  2.03e-03     5s
  35   6.61890086e+04  6.63453785e+04  1.06e-05 9.70e-07  7.89e-04     5s
  36   6.62340189e+04  6.63208192e+04  5.43e-06 6.82e-07  4.38e-04     5s
  37   6.62404181e+04  6.63020906e+04  4.67e-06 3.55e-07  3.11e-04     5s
  38   6.62606525e+04  6.63004745e+04  2.36e-06 3.26e-07  2.01e-04     5s
  39   6.62692514e+04  6.62848625e+04  1.35e-06 5.76e-08  7.88e-05     5s
  40   6.62804358e+04  6.62823614e+04  6.78e-08 1.39e-08  9.71e-06     5s
  41   6.62813101e+04  6.62813760e+04  1.10e-08 2.41e-10  3.32e-07     5s
  42   6.62813537e+04  6.62813538e+04  1.56e-10 1.49e-10  2.75e-11     5s

Barrier solved model in 42 iterations and 5.02 seconds (9.31 work units)
Optimal objective 6.62813537e+04


Root crossover log...

   92629 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1761 PPushes remaining with PInf 3.9065099e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.6936122e+00      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35545    6.6281354e+04   0.000000e+00   2.693612e+00      8s
   35547    6.6281354e+04   0.000000e+00   0.000000e+00      8s
   35547    6.6281354e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.39s

Solved with barrier

Root relaxation: objective 6.628135e+04, 35547 iterations, 5.95 seconds (12.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 66281.3538    0  230 -180179.68 66281.3538   137%     -    8s
H    0     0                    -175941.3672 66281.3538   138%     -    8s
H    0     0                    -138549.7795 66281.3538   148%     -    8s
H    0     0                    -137190.6217 66281.3538   148%     -    8s
H    0     0                    -133301.3455 66281.3538   150%     -    8s
H    0     0                    -61021.19226 66281.3538   209%     -    8s
H    0     0                    -3937.802491 66281.3538  1783%     -    9s
H    0     0                    -2006.472631 66281.3538  3403%     -    9s
H    0     0                    6485.5082784 66281.3538   922%     -    9s
H    0     0                    16230.414387 66281.3538   308%     -    9s
H    0     0                    16378.910024 66281.3538   305%     -    9s
H    0     0                    16429.894010 66281.3538   303%     -    9s
H    0     0                    16509.429560 66281.3538   301%     -    9s
H    0     0                    16590.097302 66281.3538   300%     -    9s
H    0     0                    16592.738551 66281.3538   299%     -    9s
H    0     0                    19111.183832 66281.3538   247%     -   11s
H    0     0                    19814.120845 66281.3538   235%     -   11s
H    0     0                    20227.013162 66281.3538   228%     -   11s
H    0     0                    20255.736580 66281.3538   227%     -   11s
     0     0 61531.7412    0  353 20255.7366 61531.7412   204%     -   45s
H    0     0                    20764.184478 61531.7412   196%     -   46s
H    0     0                    21262.780233 61531.7412   189%     -   46s
H    0     0                    21396.358809 61531.7412   188%     -   46s
H    0     0                    21467.946763 61531.7412   187%     -   46s
     0     0 60971.0023    0  345 21467.9468 60971.0023   184%     -   60s
     0     0 60884.6601    0  355 21467.9468 60884.6601   184%     -   68s
     0     0 60861.6645    0  353 21467.9468 60861.6645   184%     -   77s
     0     0 60861.6645    0  359 21467.9468 60861.6645   184%     -   81s
     0     0 60861.6645    0  347 21467.9468 60861.6645   184%     -   85s
     0     0 60861.6645    0  347 21467.9468 60861.6645   184%     -   86s
     0     0 60861.6645    0  349 21467.9468 60861.6645   184%     -   86s
     0     0 57233.1984    0  370 21467.9468 57233.1984   167%     -  129s
H    0     0                    23011.255258 57232.9065   149%     -  130s
H    0     0                    23267.834998 57232.9065   146%     -  130s
H    0     0                    24259.038702 57232.9065   136%     -  130s
H    0     0                    24393.250413 57232.9065   135%     -  130s
H    0     0                    24431.549597 57232.9065   134%     -  130s
H    0     0                    24466.830195 57232.9065   134%     -  130s
     0     0 56843.2901    0  372 24466.8302 56843.2901   132%     -  156s
     0     0 56556.2460    0  389 24466.8302 56556.2460   131%     -  175s
     0     0 56497.1998    0  392 24466.8302 56497.1998   131%     -  186s
     0     0 56360.7265    0  390 24466.8302 56360.7265   130%     -  195s
     0     0 56263.4025    0  405 24466.8302 56263.4025   130%     -  207s
     0     0 56204.7660    0  383 24466.8302 56204.7660   130%     -  214s
     0     0 56132.2898    0  406 24466.8302 56132.2898   129%     -  224s
     0     0 56120.0424    0  399 24466.8302 56120.0424   129%     -  228s
     0     0 56100.9726    0  392 24466.8302 56100.9726   129%     -  235s
     0     0 56090.7133    0  404 24466.8302 56090.7133   129%     -  239s
     0     0 55987.0220    0  407 24466.8302 55987.0220   129%     -  248s
     0     0 55981.3936    0  418 24466.8302 55981.3936   129%     -  250s
     0     0 55976.6423    0  416 24466.8302 55976.6423   129%     -  253s
     0     0 55973.9247    0  416 24466.8302 55973.9247   129%     -  256s
     0     0 55973.4047    0  415 24466.8302 55973.4047   129%     -  257s
H    0     0                    28756.410942 55973.4047  94.6%     -  270s
H    0     0                    28840.346240 55973.4047  94.1%     -  270s
H    0     0                    29013.396014 55973.4047  92.9%     -  270s
H    0     0                    29768.620828 55973.4047  88.0%     -  270s
     0     0 53963.2937    0  318 29768.6208 53963.2937  81.3%     -  317s
     0     0 53696.1996    0  331 29768.6208 53696.1996  80.4%     -  334s
H    0     0                    29786.805685 53463.0687  79.5%     -  350s
H    0     0                    29808.166824 53463.0687  79.4%     -  350s
     0     0 53463.0687    0  416 29808.1668 53463.0687  79.4%     -  350s
     0     0 53352.5895    0  420 29808.1668 53352.5895  79.0%     -  364s
     0     0 53254.3918    0  431 29808.1668 53254.3918  78.7%     -  375s
     0     0 53227.9179    0  427 29808.1668 53227.9179  78.6%     -  380s
     0     0 53200.7071    0  419 29808.1668 53200.7071  78.5%     -  384s
     0     0 53161.1699    0  430 29808.1668 53161.1699  78.3%     -  392s
     0     0 53140.3249    0  422 29808.1668 53140.3249  78.3%     -  396s
     0     0 53105.0175    0  404 29808.1668 53105.0175  78.2%     -  401s
     0     0 53096.3981    0  413 29808.1668 53096.3981  78.1%     -  404s
     0     0 53091.3971    0  424 29808.1668 53091.3971  78.1%     -  408s
     0     0 53043.9134    0  413 29808.1668 53043.9134  78.0%     -  412s
H    0     0                    30002.817369 52997.3790  76.6%     -  418s
H    0     0                    30007.040629 52997.3790  76.6%     -  418s
H    0     0                    30026.822081 52997.3790  76.5%     -  418s
H    0     0                    30038.457583 52997.3790  76.4%     -  418s
H    0     0                    30091.891222 52997.3790  76.1%     -  418s
     0     0 52997.3790    0  405 30091.8912 52997.3790  76.1%     -  418s
H    0     0                    30129.449151 52959.9671  75.8%     -  425s
H    0     0                    30156.339216 52959.9671  75.6%     -  425s
H    0     0                    30202.602014 52959.9671  75.3%     -  425s
     0     0 52959.9671    0  427 30202.6020 52959.9671  75.3%     -  425s
     0     0 52944.5582    0  405 30202.6020 52944.5582  75.3%     -  429s
     0     0 52935.0491    0  409 30202.6020 52935.0491  75.3%     -  431s
     0     0 52933.0328    0  406 30202.6020 52933.0328  75.3%     -  433s
     0     0 52928.7498    0  409 30202.6020 52928.7498  75.2%     -  435s
     0     0 52920.6572    0  415 30202.6020 52920.6572  75.2%     -  438s
     0     0 52912.9275    0  419 30202.6020 52912.9275  75.2%     -  440s
     0     0 52908.6816    0  410 30202.6020 52908.6816  75.2%     -  441s
     0     0 52908.3872    0  411 30202.6020 52908.3872  75.2%     -  441s
H    0     0                    30264.583354 52908.3872  74.8%     -  450s
     0     0 52010.3919    0  348 30264.5834 52010.3919  71.9%     -  479s
     0     0 51735.5406    0  352 30264.5834 51735.5406  70.9%     -  493s
     0     0 51605.9835    0  356 30264.5834 51605.9835  70.5%     -  502s
     0     0 51582.1873    0  362 30264.5834 51582.1873  70.4%     -  507s
     0     0 51528.1465    0  371 30264.5834 51528.1465  70.3%     -  514s
     0     0 51475.6275    0  373 30264.5834 51475.6275  70.1%     -  520s
     0     0 51434.5691    0  373 30264.5834 51434.5691  69.9%     -  528s
     0     0 51403.0249    0  365 30264.5834 51403.0249  69.8%     -  534s
     0     0 51391.2046    0  371 30264.5834 51391.2046  69.8%     -  537s
     0     0 51384.3558    0  368 30264.5834 51384.3558  69.8%     -  539s
     0     0 51373.9747    0  367 30264.5834 51373.9747  69.7%     -  542s
     0     0 51369.3993    0  370 30264.5834 51369.3993  69.7%     -  545s
     0     0 51368.9057    0  372 30264.5834 51368.9057  69.7%     -  546s
     0     0 51143.3764    0  424 30264.5834 51143.3764  69.0%     -  562s
H    0     0                    30273.864397 51141.9134  68.9%     -  563s
     0     0 51091.0636    0  375 30273.8644 51091.0636  68.8%     -  569s
     0     0 51078.3873    0  367 30273.8644 51078.3873  68.7%     -  572s
     0     0 51075.5462    0  373 30273.8644 51075.5462  68.7%     -  573s
     0     0 51067.8475    0  416 30273.8644 51067.8475  68.7%     -  576s
     0     0 51055.1112    0  374 30273.8644 51055.1112  68.6%     -  579s
     0     0 51041.2718    0  369 30273.8644 51041.2718  68.6%     -  582s
     0     0 51034.2054    0  367 30273.8644 51034.2054  68.6%     -  584s
     0     0 51028.2794    0  445 30273.8644 51028.2794  68.6%     -  586s
     0     0 51026.7424    0  368 30273.8644 51026.7424  68.6%     -  587s
     0     0 50774.8617    0  494 30273.8644 50774.8617  67.7%     -  599s
     0     0 50725.4487    0  503 30273.8644 50725.4487  67.6%     -  609s
     0     0 50719.5243    0  520 30273.8644 50719.5243  67.5%     -  611s
     0     0 50715.6190    0  524 30273.8644 50715.6190  67.5%     -  614s
     0     0 50711.7834    0  523 30273.8644 50711.7834  67.5%     -  615s
     0     0 50704.7504    0  530 30273.8644 50704.7504  67.5%     -  618s
     0     0 50698.2007    0  528 30273.8644 50698.2007  67.5%     -  620s
     0     0 50696.1893    0  519 30273.8644 50696.1893  67.5%     -  621s
     0     0 50662.9836    0  382 30273.8644 50662.9836  67.3%     -  628s
     0     0 50656.0681    0  385 30273.8644 50656.0681  67.3%     -  630s
     0     0 50654.9596    0  380 30273.8644 50654.9596  67.3%     -  631s
     0     0 50619.5764    0  535 30273.8644 50619.5764  67.2%     -  640s
     0     0 50588.8366    0  492 30273.8644 50588.8366  67.1%     -  645s
     0     0 50581.6184    0  495 30273.8644 50581.6184  67.1%     -  647s
     0     0 50577.2149    0  520 30273.8644 50577.2149  67.1%     -  649s
     0     0 50576.7428    0  512 30273.8644 50576.7428  67.1%     -  649s
     0     0 50567.8023    0  378 30273.8644 50567.8023  67.0%     -  653s
     0     0 50561.2601    0  390 30273.8644 50561.2601  67.0%     -  656s
     0     0 50559.0686    0  386 30273.8644 50559.0686  67.0%     -  658s
     0     0 50550.3338    0  386 30273.8644 50550.3338  67.0%     -  661s
H    0     0                    30295.688032 50549.2796  66.9%     -  663s
     0     0 50545.9583    0  385 30295.6880 50545.9583  66.8%     -  664s
     0     0 50544.0257    0  381 30295.6880 50544.0257  66.8%     -  667s
     0     0 50535.3002    0  393 30295.6880 50535.3002  66.8%     -  672s
     0     0 50534.8071    0  393 30295.6880 50534.8071  66.8%     -  673s
H    0     0                    30436.339288 50534.4361  66.0%     -  772s
H    0     2                    30442.662285 50534.4361  66.0%     -  778s
     0     2 50534.4361    0  393 30442.6623 50534.4361  66.0%     -  778s
     1     4 50502.0624    1  512 30442.6623 50534.4361  66.0%  6396  793s
     3     7 49503.3953    2  337 30442.6623 50495.7080  65.9% 13096  810s
     6    10 47768.6435    3  373 30442.6623 50495.7080  65.9% 16562  863s
     9    20 47635.5213    3  365 30442.6623 49909.9092  63.9% 19935  886s
    19    40 47344.3727    4  360 30442.6623 49651.9372  63.1% 17823  912s
    39    52 48270.3175    5  354 30442.6623 49528.5419  62.7% 21377 1915s
    51    75 46998.7298    6  352 30442.6623 49528.5419  62.7% 27526 1963s
H   54    75                    30494.496682 49528.5419  62.4% 26691 1963s
    74   212 46876.8516    7  340 30494.4967 49528.5419  62.4% 22927 2002s
   211   298 46325.9568   10  330 30494.4967 49528.5419  62.4% 12854 2025s
   297   361 46208.3895   12  321 30494.4967 49528.5419  62.4% 10382 2044s
   360   390 46105.0522   14  319 30494.4967 49528.5419  62.4%  9350 2059s
   389   418 44012.9466   15  318 30494.4967 49528.5419  62.4%  9118 2073s
H  399   418                    30691.976920 49528.5419  61.4%  9017 2073s
H  404   418                    31252.052851 49528.5419  58.5%  8960 2073s
   417   448 46033.4541   15  334 31252.0529 49528.5419  58.5%  8872 2088s
   447   482 46015.8473   16  330 31252.0529 49528.5419  58.5%  8664 2105s
   481   500 45509.8379   16  282 31252.0529 49528.5419  58.5%  8447 2125s
   499   539 43951.8421   17  289 31252.0529 49528.5419  58.5%  8471 2141s
   538   570 44300.0908   17  318 31252.0529 49528.5419  58.5%  8806 2160s
   569   598 44212.5847   18  326 31252.0529 49528.5419  58.5%  8675 2176s
   597   626 43393.7505   18  312 31252.0529 49528.5419  58.5%  8531 2194s
   625   665 43660.2315   19  321 31252.0529 49528.5419  58.5%  8501 2211s
   664   696 43048.8873   14  290 31252.0529 49528.5419  58.5%  8393 2233s
   695   760 42945.6497   20  389 31252.0529 49528.5419  58.5%  8419 2250s
   759   819 40394.2368   20  368 31252.0529 49528.5419  58.5%  8387 2265s
   822   860 42937.4102   21  389 31252.0529 49528.5419  58.5%  8392 2282s
   875   887 35934.0640   21  316 31252.0529 49528.5419  58.5%  8599 2303s
   932   938 37942.2919   22  299 31252.0529 49528.5419  58.5%  8845 2322s
  1003   966 38898.5761   22  356 31252.0529 49528.5419  58.5%  8953 2348s
  1057  1044 37546.3673   23  344 31252.0529 49528.5419  58.5%  9077 2367s
  1153  1106 33950.0136   18  211 31252.0529 49528.5419  58.5%  9079 2384s
  1239  1151 37329.1932   24  353 31252.0529 49528.5419  58.5%  9079 2406s
  1334  1181 32850.9145   25  374 31252.0529 49528.5419  58.5%  9011 2429s
  1425  1243 31930.3792   26  319 31252.0529 49528.5419  58.5%  9052 2449s
  1533  1285 infeasible   27      31252.0529 49528.5419  58.5%  9058 2473s
  1643  1358 infeasible   27      31252.0529 48944.7023  56.6%  9064 2497s
  1745  1443 33849.4589   34  206 31252.0529 48944.6619  56.6%  9150 2523s
  1856  1531 32211.4983   36  199 31252.0529 48944.6619  56.6%  9171 2551s
  1976  1550 33270.1437   37  204 31252.0529 48944.4708  56.6%  9126 2576s
  2021  1582 33049.5752   38  228 31252.0529 48944.4708  56.6%  9231 2601s
H 2031  1582                    31275.464713 48944.4708  56.5%  9265 2601s
  2055  1686 32986.1218   39  214 31275.4647 48944.4708  56.5%  9336 2630s
  2197  1785 31804.3463   42  157 31275.4647 48944.4708  56.5%  9295 2658s
  2358  1842 31596.6776   51  134 31275.4647 47948.2018  53.3%  9175 2689s
H 2478  1788                    34615.524272 47948.2018  38.5%  9062 2689s
  2491  1773 infeasible   39      34615.5243 47948.2018  38.5%  9043 2729s
  2624  1783 38782.0112   23  214 34615.5243 47948.2018  38.5%  9054 2760s
  2750  1732 38464.7767   28  187 34615.5243 47948.2018  38.5%  9140 2790s
H 2756  1732                    34677.043818 47948.2018  38.3%  9144 2790s
  2787  1816 38449.4036   29  174 34677.0438 46970.5738  35.5%  9210 2823s
  2922  1851 37900.4270   35  205 34677.0438 46970.5738  35.5%  9254 2859s
  3123  1866 37515.7700   47  183 34677.0438 46970.5738  35.5%  9166 2895s
  3318  1938 36185.2355   60  117 34677.0438 46522.8640  34.2%  9164 2934s
  3514  1991 43387.6106    7  336 34677.0438 46522.8640  34.2%  9194 2973s
  3662  2107 42265.1564    8  324 34677.0438 46522.8640  34.2%  9324 3014s
  3818  2200 40944.4061   10  301 34677.0438 46522.8640  34.2%  9451 3057s
H 3962  2277                    34818.601607 46138.0577  32.5%  9529 3100s
H 3971  2272                    34855.771375 46138.0577  32.4%  9537 3100s
H 3986  2268                    34877.858956 46138.0577  32.3%  9553 3100s
H 4036  2267                    34891.574881 46138.0577  32.2%  9547 3100s
H 4093  2258                    34940.094175 46138.0577  32.0%  9484 3266s
H 4093  2258                    34946.540137 46138.0577  32.0%  9484 3279s
  4094  2257 40816.5233   18  393 34946.5401 46138.0577  32.0%  9481 3439s
  4096  2258 36308.9816   23  206 34946.5401 46138.0577  32.0%  9477 3448s
  4097  2259 35280.0674   37  310 34946.5401 46138.0577  32.0%  9474 3516s
H 4097  2146                    35003.550897 46138.0577  31.8%  9474 3561s

Cutting planes:
  Gomory: 19
  Implied bound: 49
  Projected implied bound: 313
  MIR: 1099
  Mixing: 7
  Flow cover: 695
  RLT: 55
  Relax-and-lift: 300

Explored 4098 nodes (39676322 simplex iterations) in 3600.04 seconds (8182.44 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 35003.6 34946.5 34940.1 ... 31275.5

Time limit reached
Best objective 3.500355089745e+04, best bound 4.613805773769e+04, gap 31.8096%
  WARNING: Time limit reached. Using best solution found (gap: 31.81%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 35003.55, θ = 187532.86
  Upper Bound (UB) = 35003.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 187532.86
  [DEBUG]   ✓ Scenario 0: θ = 187532.86 ≤ Q = 187532.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 187532.86 ≤ Q = 187532.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 187532.86 ≤ Q = 187532.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 187532.86 ≤ Q = 187532.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 187532.86 ≤ Q = 187532.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 187532.86 ≤ Q = 187532.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 187532.86 ≤ Q = 187532.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 187532.86 ≤ Q = 187532.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 187532.86 ≤ Q = 187532.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 187532.86 ≤ Q = 187532.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 187532.86 ≤ Q = 187532.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 187532.86 ≤ Q = 187532.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 187532.86 ≤ Q = 187532.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6ebd6634
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6ebd6634
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.403056e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6913272.4471
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.576440e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157644.02    0  124 6913272.45 -157644.02   102%     -    0s
H    0     0                    -123013.0009 -157644.02  28.2%     -    0s
H    0     0                    -123877.7335 -157644.02  27.3%     -    0s
     0     0 -132738.83    0   54 -123877.73 -132738.83  7.15%     -    0s
H    0     0                    -129917.6474 -132621.89  2.08%     -    0s
     0     0 -132095.43    0   54 -129917.65 -132095.43  1.68%     -    0s
H    0     0                    -130558.9740 -132088.48  1.17%     -    0s
     0     0 -132082.68    0   52 -130558.97 -132082.68  1.17%     -    0s
     0     0 -131697.45    0   42 -130558.97 -131697.45  0.87%     -    0s
     0     0 -131671.70    0   40 -130558.97 -131671.70  0.85%     -    0s
     0     0 -131666.77    0   42 -130558.97 -131666.77  0.85%     -    0s
     0     0 -131577.01    0   37 -130558.97 -131577.01  0.78%     -    0s
     0     0 -131543.05    0   41 -130558.97 -131543.05  0.75%     -    0s
     0     0 -131457.02    0   40 -130558.97 -131457.02  0.69%     -    0s
     0     0 -131440.35    0   40 -130558.97 -131440.35  0.68%     -    0s
H    0     0                    -130566.9879 -131440.35  0.67%     -    0s
     0     2 -131440.35    0   40 -130566.99 -131440.35  0.67%     -    0s
H   54    40                    -130766.3811 -131092.85  0.25%  10.8    0s
*   81    56               6    -130818.3235 -131004.06  0.14%   9.6    0s

Cutting planes:
  Gomory: 13
  Implied bound: 7
  MIR: 145
  Flow cover: 9
  RLT: 19
  Relax-and-lift: 2
  BQP: 1

Explored 198 nodes (1864 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -130818 -130766 -130567 ... 1.40306e+13
No other solutions better than -130818

Optimal solution found (tolerance 1.00e-04)
Best objective -1.308183235080e+05, best bound -1.308183235080e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 182892.12
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130818.32
  [DEBUG]   S×d_nominal = 313710.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 313710.45 + -130818.32 = 182892.12
  [DEBUG]   Current θ from Master = 187532.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4640.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30362.81
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 4640.7384, Absolute Gap = 4640.7384, Relative Gap = 0.132579
  Not converged yet (gap = 4640.74 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x634a17e4
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 1.95s
Presolved: 116463 rows, 49440 columns, 702607 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -351213.2896
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 605
 AA' NZ     : 4.682e+06
 Factor NZ  : 1.112e+07 (roughly 160 MB of memory)
 Factor Ops : 2.262e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66640170e+07  2.19584582e+08  1.22e+05 1.58e+01  8.05e+04     3s
   1  -1.26534278e+07  2.02533203e+08  8.50e+04 7.58e+01  5.55e+04     3s
   2  -4.64607626e+06  1.49151717e+08  3.11e+04 3.28e+00  2.17e+04     3s
   3  -1.42555597e+06  1.21654211e+08  5.03e+03 1.56e+00  3.91e+03     3s
   4  -7.22450342e+05  9.32391449e+07  7.92e+02 9.58e-01  9.41e+02     4s
   5  -4.39840596e+05  5.12318409e+07  4.25e+02 4.36e-01  4.83e+02     4s
   6  -3.42851823e+05  3.76584144e+07  1.11e+02 3.02e-01  2.37e+02     4s
   7  -3.14701264e+05  2.60491631e+07  6.87e+01 1.97e-01  1.55e+02     4s
   8  -2.19248276e+05  1.63326662e+07  2.81e+00 1.16e-01  7.87e+01     4s
   9  -1.15778914e+05  9.19408545e+06  1.76e-01 6.33e-02  4.37e+01     4s
  10  -6.21409423e+04  3.78675820e+06  6.57e-02 2.53e-02  1.81e+01     4s
  11  -2.36270895e+04  7.23686713e+05  3.06e-02 4.24e-03  3.51e+00     4s
  12  -1.34677695e+03  3.24660396e+05  1.84e-02 1.85e-03  1.53e+00     4s
  13   9.06743924e+03  2.40264278e+05  1.38e-02 1.28e-03  1.09e+00     4s
  14   1.84399718e+04  1.81302633e+05  1.06e-02 8.68e-04  7.64e-01     4s
  15   2.54728054e+04  1.41037847e+05  8.61e-03 5.73e-04  5.42e-01     4s
  16   2.96018789e+04  1.18425398e+05  7.59e-03 4.22e-04  4.17e-01     4s
  17   3.93679879e+04  1.03839535e+05  5.48e-03 3.05e-04  3.03e-01     4s
  18   4.54737235e+04  9.19815314e+04  4.14e-03 2.10e-04  2.18e-01     4s
  19   5.02903144e+04  8.48392453e+04  3.07e-03 1.53e-04  1.62e-01     4s
  20   5.22845566e+04  7.96260829e+04  2.65e-03 1.15e-04  1.28e-01     4s
  21   5.53972985e+04  7.72968087e+04  2.04e-03 9.41e-05  1.03e-01     4s
  22   5.67812407e+04  7.45185541e+04  1.77e-03 8.05e-05  8.32e-02     5s
  23   5.90703733e+04  7.25382407e+04  1.33e-03 6.04e-05  6.32e-02     5s
  24   6.07923966e+04  7.13049488e+04  1.01e-03 4.77e-05  4.93e-02     5s
  25   6.16739582e+04  6.95425473e+04  8.48e-04 3.05e-05  3.69e-02     5s
  26   6.28062058e+04  6.87071482e+04  6.44e-04 2.21e-05  2.77e-02     5s
  27   6.36157173e+04  6.79866914e+04  5.00e-04 1.47e-05  2.05e-02     5s
  28   6.43175803e+04  6.76580191e+04  3.76e-04 1.12e-05  1.57e-02     5s
  29   6.49495668e+04  6.73031049e+04  2.66e-04 7.58e-06  1.10e-02     5s
  30   6.53281916e+04  6.69460289e+04  2.02e-04 3.87e-06  7.59e-03     5s
  31   6.57212148e+04  6.68811946e+04  1.36e-04 3.11e-06  5.44e-03     5s
  32   6.58756274e+04  6.68416320e+04  1.10e-04 2.72e-06  4.53e-03     5s
  33   6.59508115e+04  6.67709079e+04  9.73e-05 2.10e-06  3.85e-03     5s
  34   6.62536686e+04  6.66989894e+04  4.81e-05 1.29e-06  2.09e-03     5s
  35   6.64936251e+04  6.66546822e+04  1.04e-05 8.59e-07  7.56e-04     5s
  36   6.65341635e+04  6.66417018e+04  4.41e-06 7.28e-07  5.05e-04     6s
  37   6.65407215e+04  6.65976612e+04  3.53e-06 2.91e-07  2.67e-04     6s
  38   6.65561086e+04  6.65870944e+04  1.51e-06 1.91e-07  1.45e-04     6s
  39   6.65626643e+04  6.65852825e+04  7.23e-07 1.65e-07  1.06e-04     6s
  40   6.65664719e+04  6.65821782e+04  1.77e-07 1.33e-07  7.37e-05     6s
  41   6.65675376e+04  6.65758088e+04  1.87e-07 7.23e-08  3.88e-05     6s
  42   6.65682833e+04  6.65710199e+04  1.04e-07 2.28e-08  1.28e-05     6s
  43   6.65685699e+04  6.65694822e+04  6.96e-08 7.03e-09  4.28e-06     6s
  44   6.65686502e+04  6.65687871e+04  4.47e-08 1.47e-10  6.43e-07     6s
  45   6.65687706e+04  6.65687710e+04  9.62e-10 1.91e-09  1.91e-09     6s

Barrier solved model in 45 iterations and 6.26 seconds (11.41 work units)
Optimal objective 6.65687706e+04


Root crossover log...

   99865 DPushes remaining with DInf 0.0000000e+00                 6s
   19629 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   16529 PPushes remaining with PInf 7.3109953e-05                14s
    5299 PPushes remaining with PInf 1.8123090e-04                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2441897e+04     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   61324    6.6568771e+04   0.000000e+00   1.244190e+04     16s
   61596    6.6568771e+04   0.000000e+00   0.000000e+00     16s
   61596    6.6568771e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.656877e+04, 61596 iterations, 13.80 seconds (24.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 66568.7709    0  238 -180179.68 66568.7709   137%     -   16s
H    0     0                    -172954.8865 66568.7709   138%     -   16s
H    0     0                    -160259.2751 66568.7709   142%     -   17s
H    0     0                    -159530.9414 66568.7709   142%     -   17s
H    0     0                    -158781.8926 66568.7709   142%     -   17s
H    0     0                    -156881.0655 66568.7709   142%     -   17s
H    0     0                    -156433.0600 66568.7709   143%     -   18s
H    0     0                    -155977.6133 66568.7709   143%     -   18s
H    0     0                    -74632.56162 66568.7709   189%     -   18s
H    0     0                    -74506.79781 66568.7709   189%     -   18s
H    0     0                     968.1299940 66568.7709  6776%     -   18s
H    0     0                    7457.5653219 66568.7709   793%     -   18s
H    0     0                    11180.795070 61595.5267   451%     -   65s
     0     0 61595.5267    0  300 11180.7951 61595.5267   451%     -   65s
H    0     0                    13988.948647 61594.9562   340%     -   66s
H    0     0                    14436.042331 61045.8615   323%     -   87s
H    0     0                    14697.470637 61045.8615   315%     -   87s
     0     0 61045.8615    0  367 14697.4706 61045.8615   315%     -   87s
     0     0 60918.7541    0  362 14697.4706 60918.7541   314%     -   96s
     0     0 60875.3826    0  369 14697.4706 60875.3826   314%     -  104s
     0     0 60819.0650    0  372 14697.4706 60819.0650   314%     -  111s
     0     0 60763.9589    0  384 14697.4706 60763.9589   313%     -  117s
     0     0 60761.3586    0  372 14697.4706 60761.3586   313%     -  118s
     0     0 60753.2002    0  369 14697.4706 60753.2002   313%     -  120s
     0     0 60750.6173    0  374 14697.4706 60750.6173   313%     -  121s
     0     0 60734.1128    0  362 14697.4706 60734.1128   313%     -  124s
     0     0 60733.9014    0  367 14697.4706 60733.9014   313%     -  127s
H    0     0                    14761.050888 57412.8843   289%     -  192s
H    0     0                    15270.049551 57412.8843   276%     -  192s
H    0     0                    15330.540258 57412.8843   275%     -  192s
     0     0 57412.8843    0  369 15330.5403 57412.8843   275%     -  193s
H    0     0                    15372.309215 57412.8207   273%     -  193s
H    0     0                    15745.612672 57412.8207   265%     -  193s
H    0     0                    15805.208357 57412.8207   263%     -  193s
H    0     0                    16529.283737 57412.8207   247%     -  193s
H    0     0                    16533.407200 57412.8207   247%     -  193s
H    0     0                    16622.424662 57412.8207   245%     -  193s
H    0     0                    16773.089567 57412.8207   242%     -  193s
     0     0 56751.1903    0  413 16773.0896 56751.1903   238%     -  238s
     0     0 56610.2005    0  401 16773.0896 56610.2005   238%     -  257s
     0     0 56561.6017    0  388 16773.0896 56561.6017   237%     -  274s
     0     0 56543.9287    0  392 16773.0896 56543.9287   237%     -  282s
     0     0 56505.6182    0  397 16773.0896 56505.6182   237%     -  291s
     0     0 56307.5719    0  418 16773.0896 56307.5719   236%     -  308s
     0     0 56301.2871    0  428 16773.0896 56301.2871   236%     -  312s
     0     0 56296.6511    0  412 16773.0896 56296.6511   236%     -  315s
     0     0 56287.8414    0  414 16773.0896 56287.8414   236%     -  318s
     0     0 56271.5489    0  410 16773.0896 56271.5489   235%     -  322s
     0     0 56263.0957    0  378 16773.0896 56263.0957   235%     -  326s
     0     0 56125.5753    0  411 16773.0896 56125.5753   235%     -  339s
     0     0 56062.9997    0  433 16773.0896 56062.9997   234%     -  349s
     0     0 56060.0669    0  427 16773.0896 56060.0669   234%     -  352s
     0     0 56042.9919    0  431 16773.0896 56042.9919   234%     -  356s
     0     0 56042.4326    0  435 16773.0896 56042.4326   234%     -  357s
H    0     0                    18676.122864 54218.2712   190%     -  424s
H    0     0                    19084.733628 54218.2712   184%     -  424s
H    0     0                    19110.430402 54218.2712   184%     -  424s
H    0     0                    19123.169162 54218.2712   184%     -  424s
H    0     0                    19139.652657 54218.2712   183%     -  424s
H    0     0                    19149.902836 54218.2712   183%     -  424s
H    0     0                    21547.190634 54218.2712   152%     -  424s
H    0     0                    21550.202317 54218.2712   152%     -  424s
     0     0 54218.2712    0  300 21550.2023 54218.2712   152%     -  424s
     0     0 53399.1212    0  446 21550.2023 53399.1212   148%     -  473s
H    0     0                    21706.778866 52955.3057   144%     -  508s
H    0     0                    21770.686221 52955.3057   143%     -  508s
H    0     0                    22033.014895 52955.3057   140%     -  508s
H    0     0                    22056.494757 52955.3057   140%     -  508s
H    0     0                    22073.432462 52955.3057   140%     -  508s
H    0     0                    22078.093864 52955.3057   140%     -  508s
H    0     0                    22080.540917 52955.3057   140%     -  508s
H    0     0                    22478.296004 52955.3057   136%     -  508s
H    0     0                    22525.380844 52955.3057   135%     -  508s
H    0     0                    22556.202776 52955.3057   135%     -  508s
H    0     0                    22588.639263 52955.3057   134%     -  508s
     0     0 52955.3057    0  480 22588.6393 52955.3057   134%     -  508s
     0     0 52814.8988    0  446 22588.6393 52814.8988   134%     -  529s
     0     0 52761.7730    0  360 22588.6393 52761.7730   134%     -  541s
     0     0 52730.4413    0  361 22588.6393 52730.4413   133%     -  551s
     0     0 52705.2549    0  363 22588.6393 52705.2549   133%     -  559s
     0     0 52621.3954    0  446 22588.6393 52621.3954   133%     -  571s
     0     0 52604.3127    0  430 22588.6393 52604.3127   133%     -  580s
     0     0 52584.6558    0  359 22588.6393 52584.6558   133%     -  590s
H    0     0                    22784.101701 52524.1330   131%     -  603s
H    0     0                    22919.035412 52524.1330   129%     -  603s
H    0     0                    22923.859684 52524.1330   129%     -  603s
H    0     0                    22926.906734 52524.1330   129%     -  603s
     0     0 52524.1330    0  433 22926.9067 52524.1330   129%     -  603s
     0     0 52506.8373    0  434 22926.9067 52506.8373   129%     -  610s
H    0     0                    22929.919107 52501.0953   129%     -  614s
H    0     0                    23020.504482 52501.0953   128%     -  614s
H    0     0                    23030.939862 52501.0953   128%     -  614s
     0     0 52501.0953    0  436 23030.9399 52501.0953   128%     -  614s
     0     0 52499.8490    0  439 23030.9399 52499.8490   128%     -  617s
     0     0 51709.9407    0  343 23030.9399 51709.9407   125%     -  677s
H    0     0                    23083.488664 51709.7629   124%     -  678s
H    0     0                    23626.610659 51709.7629   119%     -  678s
H    0     0                    23905.283223 51709.7629   116%     -  678s
H    0     0                    23930.550891 51709.7629   116%     -  678s
H    0     0                    23935.473675 51709.7629   116%     -  678s
     0     0 51528.9011    0  349 23935.4737 51528.9011   115%     -  698s
     0     0 51359.4445    0  356 23935.4737 51359.4445   115%     -  720s
     0     0 51331.8027    0  356 23935.4737 51331.8027   114%     -  729s
     0     0 51302.0577    0  356 23935.4737 51302.0577   114%     -  737s
     0     0 51294.7439    0  358 23935.4737 51294.7439   114%     -  740s
     0     0 51269.0770    0  357 23935.4737 51269.0770   114%     -  747s
     0     0 51258.7337    0  360 23935.4737 51258.7337   114%     -  752s
     0     0 51252.6049    0  360 23935.4737 51252.6049   114%     -  757s
     0     0 51232.7585    0  373 23935.4737 51232.7585   114%     -  762s
     0     0 51207.6129    0  369 23935.4737 51207.6129   114%     -  768s
     0     0 51200.0270    0  364 23935.4737 51200.0270   114%     -  772s
     0     0 51199.4714    0  368 23935.4737 51199.4714   114%     -  773s
     0     0 51004.9902    0  420 23935.4737 51004.9902   113%     -  796s
     0     0 50942.7114    0  515 23935.4737 50942.7114   113%     -  811s
     0     0 50913.6433    0  429 23935.4737 50913.6433   113%     -  818s
     0     0 50898.3822    0  506 23935.4737 50898.3822   113%     -  824s
     0     0 50888.0132    0  432 23935.4737 50888.0132   113%     -  829s
     0     0 50883.9745    0  434 23935.4737 50883.9745   113%     -  831s
     0     0 50863.8146    0  485 23935.4737 50863.8146   113%     -  836s
     0     0 50851.3511    0  424 23935.4737 50851.3511   112%     -  839s
     0     0 50848.0256    0  425 23935.4737 50848.0256   112%     -  841s
     0     0 50840.6670    0  428 23935.4737 50840.6670   112%     -  843s
     0     0 50840.4168    0  427 23935.4737 50840.4168   112%     -  844s
     0     0 50782.3131    0  437 23935.4737 50782.3131   112%     -  856s
     0     0 50752.1483    0  496 23935.4737 50752.1483   112%     -  867s
     0     0 50742.3125    0  367 23935.4737 50742.3125   112%     -  872s
     0     0 50733.2368    0  362 23935.4737 50733.2368   112%     -  876s
     0     0 50729.9400    0  365 23935.4737 50729.9400   112%     -  879s
     0     0 50726.4341    0  441 23935.4737 50726.4341   112%     -  881s
     0     0 50725.6790    0  359 23935.4737 50725.6790   112%     -  883s
     0     0 50691.9426    0  362 23935.4737 50691.9426   112%     -  891s
     0     0 50678.8688    0  356 23935.4737 50678.8688   112%     -  894s
     0     0 50627.8554    0  366 23935.4737 50627.8554   112%     -  901s
H    0     0                    24366.034644 50607.5653   108%     -  908s
H    0     0                    24523.415914 50607.5653   106%     -  908s
H    0     0                    24684.267269 50607.5653   105%     -  908s
H    0     0                    24785.800657 50607.5653   104%     -  908s
     0     0 50607.5653    0  509 24785.8007 50607.5653   104%     -  908s
     0     0 50604.1223    0  369 24785.8007 50604.1223   104%     -  911s
     0     0 50600.0526    0  364 24785.8007 50600.0526   104%     -  913s
     0     0 50598.0817    0  369 24785.8007 50598.0817   104%     -  914s
     0     0 50547.8897    0  516 24785.8007 50547.8897   104%     -  926s
H    0     0                    28146.355550 50547.8230  79.6%     -  926s
H    0     0                    28225.646139 50547.8230  79.1%     -  926s
H    0     0                    28294.061887 50547.8230  78.7%     -  926s
H    0     0                    28523.206766 50547.8230  77.2%     -  926s
     0     0 50518.2522    0  475 28523.2068 50518.2522  77.1%     -  934s
     0     0 50511.1908    0  468 28523.2068 50511.1908  77.1%     -  939s
     0     0 50508.7685    0  462 28523.2068 50508.7685  77.1%     -  940s
     0     0 50485.2625    0  531 28523.2068 50485.2625  77.0%     -  950s
     0     0 50476.1067    0  381 28523.2068 50476.1067  77.0%     -  956s
     0     0 50474.3567    0  551 28523.2068 50474.3567  77.0%     -  959s
     0     0 50466.3281    0  383 28523.2068 50466.3281  76.9%     -  964s
     0     0 50465.3258    0  386 28523.2068 50465.3258  76.9%     -  967s
     0     0 50461.5171    0  377 28523.2068 50461.5171  76.9%     -  973s
     0     0 50460.1811    0  374 28523.2068 50460.1811  76.9%     -  978s
     0     0 50457.6812    0  492 28523.2068 50457.6812  76.9%     -  983s
     0     0 50454.7957    0  492 28523.2068 50454.7957  76.9%     -  986s
H    0     0                    29047.097681 50454.7957  73.7%     - 1088s
H    0     0                    29130.942617 50454.7957  73.2%     - 1088s
H    0     2                    29232.904408 50454.7957  72.6%     - 1096s
     0     2 50454.7957    0  492 29232.9044 50454.7957  72.6%     - 1096s
     1     4 50417.6102    1  477 29232.9044 50454.7957  72.6%  6677 1125s
     3     7 49105.8229    2  472 29232.9044 50417.1443  72.5% 16654 1149s
     6    13 49026.3146    3  362 29232.9044 50417.1443  72.5% 17625 1186s
    12    25 48672.0235    4  359 29232.9044 49677.2359  69.9% 19429 1223s
    24    37 47884.3215    5  372 29232.9044 49677.2155  69.9% 24661 1326s
    36    68 47538.8898    6  371 29232.9044 49526.8668  69.4% 30543 1446s
H   37    68                    29280.831364 49526.8668  69.1% 29717 1446s
H   38    68                    29284.003536 49526.8668  69.1% 29463 1446s
H   43    68                    29902.328788 49526.8668  65.6% 27940 1446s
    67   190 47495.7396    7  363 29902.3288 49526.8668  65.6% 28664 1514s
H  189   247                    30019.981005 49526.8668  65.0% 17036 1541s
H  191   247                    30043.093076 49526.8668  64.9% 16967 1541s
H  205   247                    30261.807680 49526.8668  63.7% 16252 1541s
   246   312 45643.3605   14  265 30261.8077 49526.8668  63.7% 15529 1571s
   311   356 45374.6946   16  280 30261.8077 49526.8668  63.7% 13780 1597s
H  312   356                    30303.412165 49526.8668  63.4% 13736 1597s
H  314   356                    30347.443347 49526.8668  63.2% 13740 1597s
H  317   356                    30558.230419 49526.8668  62.1% 13637 1597s
H  320   356                    30806.877133 49526.8668  60.8% 13632 1597s
H  346   356                    30890.510974 49526.8668  60.3% 13244 1597s
   355   422 45265.7047   17  289 30890.5110 49526.8668  60.3% 13085 1624s
   421   482 45203.7244   18  292 30890.5110 49526.8668  60.3% 12196 1648s
H  423   482                    30915.940479 49526.8668  60.2% 12147 1648s
H  449   482                    30996.619263 49526.8668  59.8% 11971 1648s
   481   523 44648.3713   20  252 30996.6193 49526.8668  59.8% 11758 1667s
H  484   523                    31041.136747 49526.8668  59.6% 11757 1667s
   522   592 44571.5421   21  241 31041.1367 49526.8668  59.6% 11658 1691s
   591   652 32569.9357   31  184 31041.1367 49526.8668  59.6% 11191 1715s
   657   677 42122.1744   23  307 31041.1367 49526.8668  59.6% 10822 1743s
   682   704 41554.4643   24  232 31041.1367 49526.8668  59.6% 10837 1781s
   715   729 41495.9912   25  302 31041.1367 49526.8668  59.6% 10755 1802s
   742   758 41148.8314   26  394 31041.1367 49526.8668  59.6% 10784 1822s
   777   807 31704.6418   27  241 31041.1367 49526.8668  59.6% 10899 1842s
   826   852 31241.5111   28  200 31041.1367 49526.8668  59.6% 10756 1863s
   875   888 infeasible   29      31041.1367 49526.8668  59.6% 10559 1885s
H  878   888                    31053.108907 49526.8668  59.5% 10540 1885s
   933   898 infeasible   29      31053.1089 49526.8668  59.5% 10378 1905s
H  938   898                    31063.784647 49526.8668  59.4% 10349 1905s
H  949   898                    31112.138613 49526.8668  59.2% 10363 1905s
   971   950 infeasible   42      31112.1386 49526.8668  59.2% 10509 1933s
  1053  1017 48745.6020    9  373 31112.1386 49526.8668  59.2% 10577 1960s
  1141  1088 37917.0793   43  371 31112.1386 49526.8668  59.2% 10490 1987s
  1242  1153 45001.9308    8  312 31112.1386 49526.8668  59.2% 10223 2017s
  1341  1218 43372.6014   12  290 31112.1386 49526.8668  59.2% 10163 2049s
  1454  1247 43111.5097   16  277 31112.1386 49526.8668  59.2%  9989 2079s
  1495  1336 43016.0579   17  271 31112.1386 49526.8668  59.2% 10022 2110s
  1614  1443 42272.7984   21  270 31112.1386 49526.8668  59.2%  9855 2138s
  1753  1548 41481.0554   25  232 31112.1386 49526.8668  59.2%  9740 2169s
  1912  1639 40817.7336   33  222 31112.1386 49526.8668  59.2%  9509 2201s
  2051  1667 40665.8587   39  289 31112.1386 49457.8153  59.0%  9434 2227s
  2087  1740 40662.7655   40  206 31112.1386 49457.7830  59.0%  9471 2254s
  2170  1893 40482.9062   46  156 31112.1386 49457.7830  59.0%  9376 2281s
  2351  2056 38890.0289   55  185 31112.1386 49457.7830  59.0%  9124 2317s
  2548  2200 37750.4359   69  138 31112.1386 49457.7830  59.0%  8869 2351s
  2758  2353 36662.3207   85  125 31112.1386 49382.2062  58.7%  8681 2384s
  2961  2456 31747.8412  102   74 31112.1386 48484.9794  55.8%  8557 2423s
  3124  2603 34539.1945   61  323 31112.1386 48484.9794  55.8%  8596 2461s
  3323  2762 32654.1142   67  229 31112.1386 48484.9794  55.8%  8514 2502s
H 3542  2760                    31140.390210 48484.9794  55.7%  8369 2609s
  3543  2761 36064.9106   42  492 31140.3902 48484.9794  55.7%  8367 3038s
  3545  2762 39724.8051   49  209 31140.3902 48484.9794  55.7%  8362 3051s
  3546  2763 35473.1293   46  327 31140.3902 48484.9794  55.7%  8360 3127s
  3547  2764 36046.0739   22  293 31140.3902 48484.9794  55.7%  8358 3177s
  3548  2764 35183.5226   35  321 31140.3902 48484.9794  55.7%  8355 3217s
  3549  2765 36289.4341   38  340 31140.3902 48484.9794  55.7%  8353 3245s
  3550  2766 37519.5305   80  389 31140.3902 48484.9794  55.7%  8350 3274s
  3551  2766 40006.0548   53  352 31140.3902 48484.9794  55.7%  8348 3287s
  3552  2767 46808.1992   11  367 31140.3902 48484.9794  55.7%  8346 3299s
  3553  2768 33452.6278   80  377 31140.3902 48484.9794  55.7%  8343 3306s
  3554  2768 32457.0333   89  378 31140.3902 48484.9794  55.7%  8341 3313s
  3555  2769 32434.0846   48  372 31140.3902 48484.9794  55.7%  8339 3324s
  3556  2770 40885.5834   15  377 31140.3902 48484.9794  55.7%  8336 3335s
  3557  2770 41012.2471   28  370 31140.3902 48484.9794  55.7%  8334 3344s
  3558  2771 39401.2515   35  393 31140.3902 48484.9794  55.7%  8332 3354s
  3559  2772 38043.4351   71  374 31140.3902 48484.9794  55.7%  8329 3360s
  3560  2772 42061.7387   23  369 31140.3902 48484.9794  55.7%  8327 3365s
  3561  2773 37788.7824   39  379 31140.3902 48484.9794  55.7%  8325 3376s
  3562  2774 32817.5337  114  389 31140.3902 48484.9794  55.7%  8322 3381s
  3564  2775 36891.0909   43  373 31140.3902 48484.9794  55.7%  8318 3389s
  3565  2776 43215.8222   27  376 31140.3902 48484.9794  55.7%  8315 3398s
  3566  2776 36214.2615   74  367 31140.3902 48484.9794  55.7%  8313 3402s
  3567  2777 39996.4125   21  361 31140.3902 48484.9794  55.7%  8311 3412s
  3568  2778 34006.3373   56  470 31140.3902 48484.9794  55.7%  8308 3418s
  3569  2778 42627.2623   10  369 31140.3902 48484.9794  55.7%  8306 3422s
  3570  2779 44030.8965   24  374 31140.3902 48484.9794  55.7%  8304 3427s
  3571  2780 38068.5214   66  372 31140.3902 48484.9794  55.7%  8301 3431s
  3572  2780 42820.8715   10  380 31140.3902 48484.9794  55.7%  8299 3440s
  3574  2782 36889.3774   64  365 31140.3902 48484.9794  55.7%  8294 3451s
  3575  2782 35907.8989   22  367 31140.3902 48484.9794  55.7%  8292 3455s
  3576  2783 39004.2357   46  360 31140.3902 48484.9794  55.7%  8290 3463s
  3577  2784 40681.1441   33  369 31140.3902 48484.9794  55.7%  8287 3467s
  3578  2784 40274.2495   27  364 31140.3902 48484.9794  55.7%  8285 3472s
  3579  2785 45726.6559    9  364 31140.3902 48484.9794  55.7%  8283 3492s
  3580  2786 40609.2536   26  364 31140.3902 48484.9794  55.7%  8280 3586s

Cutting planes:
  Learned: 1
  Gomory: 19
  Implied bound: 35
  Projected implied bound: 275
  MIR: 860
  Flow cover: 646
  RLT: 40
  Relax-and-lift: 233

Explored 3581 nodes (30846557 simplex iterations) in 3600.04 seconds (7816.53 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 31140.4 31112.1 31063.8 ... 30558.2

Time limit reached
Best objective 3.114039021046e+04, best bound 4.848497936467e+04, gap 55.6980%
  WARNING: Time limit reached. Using best solution found (gap: 55.70%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 31140.39, θ = 182995.94
  Upper Bound (UB) = 31140.39

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 182995.94
  [DEBUG]   ✓ Scenario 0: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 182995.94 ≤ Q = 182995.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 182995.94 ≤ Q = 182995.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 182995.94 ≤ Q = 182995.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 182995.94 ≤ Q = 182995.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 182995.94 ≤ Q = 182995.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 182995.94 ≤ Q = 182995.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 182995.94 ≤ Q = 182995.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x33da5d4b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x33da5d4b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.400218e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.00s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 6654768.7013
Variable types: 334 continuous, 159 integer (159 binary)

Root relaxation: objective -1.594727e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159472.72    0  125 6654768.70 -159472.72   102%     -    0s
H    0     0                    -115334.6969 -159472.72  38.3%     -    0s
H    0     0                    -115720.9499 -159360.11  37.7%     -    0s
H    0     0                    -122891.5168 -134987.65  9.84%     -    0s
H    0     0                    -126226.7107 -134987.65  6.94%     -    0s
     0     0 -134987.65    0   49 -126226.71 -134987.65  6.94%     -    0s
H    0     0                    -131727.6465 -134951.88  2.45%     -    0s
     0     0 -134503.98    0   49 -131727.65 -134503.98  2.11%     -    0s
     0     0 -134502.96    0   49 -131727.65 -134502.96  2.11%     -    0s
     0     0 -134137.96    0   31 -131727.65 -134137.96  1.83%     -    0s
H    0     0                    -132947.4286 -134023.49  0.81%     -    0s
H    0     0                    -132956.7440 -134023.49  0.80%     -    0s
     0     0 -134007.69    0   30 -132956.74 -134007.69  0.79%     -    0s
     0     0 -133948.81    0   35 -132956.74 -133948.81  0.75%     -    0s
     0     0 -133947.57    0   35 -132956.74 -133947.57  0.75%     -    0s
     0     2 -133947.57    0   35 -132956.74 -133947.57  0.75%     -    0s
*    9     8               3    -133869.1514 -133869.15  0.00%   8.4    0s

Cutting planes:
  Gomory: 38
  Implied bound: 1
  MIR: 110
  Flow cover: 1
  RLT: 31
  Relax-and-lift: 2

Explored 15 nodes (613 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -133869 -132957 -132947 ... 1.40022e+13
No other solutions better than -133869

Optimal solution found (tolerance 1.00e-04)
Best objective -1.338691513556e+05, best bound -1.338691513556e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 173801.61
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133869.15
  [DEBUG]   S×d_nominal = 307670.76
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307670.76 + -133869.15 = 173801.61
  [DEBUG]   Current θ from Master = 182995.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9194.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21946.06
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 777.5777, Absolute Gap = 777.5777, Relative Gap = 0.024970
  Not converged yet (gap = 777.58 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0xf355e20d
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 2.07s
Presolved: 124683 rows, 52810 columns, 767870 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 624
 AA' NZ     : 5.853e+06
 Factor NZ  : 1.357e+07 (roughly 180 MB of memory)
 Factor Ops : 3.915e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72525711e+07  2.32593190e+08  1.28e+05 1.55e+01  8.29e+04     4s
   1  -1.32240644e+07  2.14432328e+08  9.00e+04 7.49e+01  5.81e+04     4s
   2  -5.01841723e+06  1.59349945e+08  3.36e+04 2.59e+00  2.32e+04     4s
   3  -1.16730018e+06  1.30129202e+08  3.44e+03 2.46e+00  2.85e+03     4s
   4  -6.36540924e+05  7.85769967e+07  6.16e+02 9.28e-01  7.20e+02     4s
   5  -4.96680449e+05  4.72419673e+07  3.88e+02 4.92e-01  4.21e+02     4s
   6  -3.95220984e+05  3.65318805e+07  1.52e+02 3.57e-01  2.40e+02     4s
   7  -3.56470954e+05  2.46550311e+07  8.59e+01 2.24e-01  1.48e+02     4s
   8  -2.44493259e+05  1.64116176e+07  5.57e+00 1.39e-01  7.51e+01     4s
   9  -1.42880963e+05  9.78699898e+06  7.28e-01 8.04e-02  4.37e+01     4s
  10  -1.13688737e+05  3.32332653e+06  4.79e-01 2.71e-02  1.51e+01     4s
  11  -7.70328856e+04  1.31740396e+06  2.45e-01 1.05e-02  6.13e+00     4s
  12  -4.66418479e+04  6.55432960e+05  1.38e-01 5.11e-03  3.08e+00     4s
  13  -1.32662953e+04  3.46360417e+05  7.17e-02 2.76e-03  1.58e+00     4s
  14   6.62670246e+03  2.67853443e+05  4.60e-02 2.15e-03  1.15e+00     4s
  15   1.98237517e+04  2.13470967e+05  3.32e-02 1.44e-03  8.50e-01     4s
  16   2.88906199e+04  1.41540432e+05  2.52e-02 7.15e-04  4.94e-01     4s
  17   3.88315947e+04  1.14876066e+05  1.74e-02 4.77e-04  3.34e-01     4s
  18   4.37133307e+04  1.02984094e+05  1.38e-02 3.74e-04  2.60e-01     5s
  19   4.55839097e+04  9.91544470e+04  1.25e-02 3.36e-04  2.35e-01     5s
  20   4.75552829e+04  8.96987431e+04  1.11e-02 2.47e-04  1.85e-01     5s
  21   5.20707875e+04  8.32864744e+04  8.25e-03 1.78e-04  1.37e-01     5s
  22   5.67473511e+04  7.96510286e+04  5.38e-03 1.41e-04  1.01e-01     5s
  23   5.87928138e+04  7.60527329e+04  4.21e-03 1.23e-04  7.58e-02     5s
  24   6.00018308e+04  7.38777729e+04  3.56e-03 1.11e-04  6.09e-02     5s
  25   6.20813921e+04  7.22742599e+04  2.48e-03 8.43e-05  4.47e-02     5s
  26   6.28655056e+04  7.03987725e+04  2.08e-03 5.22e-05  3.31e-02     5s
  27   6.34219545e+04  6.95429445e+04  1.80e-03 3.78e-05  2.69e-02     5s
  28   6.44618005e+04  6.87884209e+04  1.28e-03 2.84e-05  1.90e-02     5s
  29   6.54623852e+04  6.83774570e+04  7.98e-04 5.47e-05  1.28e-02     5s
  30   6.58858097e+04  6.80507253e+04  5.94e-04 3.90e-05  9.50e-03     5s
  31   6.60655493e+04  6.79935226e+04  5.09e-04 3.63e-05  8.46e-03     5s
  32   6.62090348e+04  6.77183659e+04  4.41e-04 2.31e-05  6.63e-03     6s
  33   6.67130552e+04  6.76411038e+04  2.15e-04 2.01e-05  4.07e-03     6s
  34   6.68073999e+04  6.74784366e+04  1.71e-04 1.27e-05  2.95e-03     6s
  35   6.68564822e+04  6.74280409e+04  1.49e-04 1.05e-05  2.51e-03     6s
  36   6.69360581e+04  6.73808880e+04  1.14e-04 7.47e-06  1.95e-03     6s
  37   6.70389895e+04  6.73148937e+04  6.63e-05 4.71e-06  1.21e-03     6s
  38   6.71238520e+04  6.72412498e+04  2.81e-05 1.67e-06  5.15e-04     6s
  39   6.71761016e+04  6.72190459e+04  7.29e-06 8.13e-07  1.88e-04     6s
  40   6.71877920e+04  6.72024545e+04  3.03e-06 1.97e-07  6.44e-05     6s
  41   6.71956282e+04  6.71970636e+04  3.98e-07 3.46e-07  6.30e-06     6s
  42   6.71968485e+04  6.71970095e+04  1.66e-07 1.58e-07  7.07e-07     6s
  43   6.71969607e+04  6.71969607e+04  8.42e-10 6.22e-11  1.61e-10     6s

Barrier solved model in 43 iterations and 6.30 seconds (11.46 work units)
Optimal objective 6.71969607e+04


Root crossover log...

  112341 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    2272 PPushes remaining with PInf 1.1954547e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.4384850e-10      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52041    6.7196961e+04   0.000000e+00   0.000000e+00      9s
   52041    6.7196961e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 1.32s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.719696e+04, 52041 iterations, 8.11 seconds (15.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67196.9607    0  150 -180179.68 67196.9607   137%     -   11s
H    0     0                    -174029.4543 67196.9607   139%     -   11s
H    0     0                    -101131.3767 67196.9607   166%     -   11s
H    0     0                    -60625.07026 67196.9607   211%     -   11s
H    0     0                    2153.9586121 67196.9607  3020%     -   11s
H    0     0                    20020.971838 67196.9607   236%     -   12s
H    0     0                    20025.255672 67196.9607   236%     -   12s
H    0     0                    20107.184649 67196.9607   234%     -   12s
H    0     0                    21075.905746 67196.9607   219%     -   12s
H    0     0                    21215.126640 67196.9607   217%     -   12s
H    0     0                    21410.042288 67196.9607   214%     -   12s
H    0     0                    21414.803166 67196.9607   214%     -   12s
H    0     0                    21435.709642 67196.9607   213%     -   12s
H    0     0                    21437.581985 67196.9607   213%     -   12s
H    0     0                    21464.547617 67196.9607   213%     -   12s
H    0     0                    21512.821337 61667.0904   187%     -   43s
     0     0 61573.4671    0  204 21512.8213 61573.4671   186%     -   44s
     0     0 61208.9474    0  186 21512.8213 61208.9474   185%     -   60s
     0     0 61055.8205    0  212 21512.8213 61055.8205   184%     -   73s
     0     0 60633.5613    0  217 21512.8213 60633.5613   182%     -   82s
     0     0 60433.4906    0  222 21512.8213 60433.4906   181%     -   96s
     0     0 60433.4906    0  221 21512.8213 60433.4906   181%     -   97s
     0     0 60433.4906    0  223 21512.8213 60433.4906   181%     -   98s
     0     0 60433.4906    0  224 21512.8213 60433.4906   181%     -  107s
     0     0 60433.4906    0  228 21512.8213 60433.4906   181%     -  108s
     0     0 60433.4906    0  229 21512.8213 60433.4906   181%     -  109s
H    0     0                    21537.547583 57229.9162   166%     -  149s
H    0     0                    21668.908879 57229.9162   164%     -  149s
H    0     0                    21727.060632 57229.9162   163%     -  149s
H    0     0                    21913.027414 57229.9162   161%     -  149s
     0     0 57083.2368    0  270 21913.0274 57083.2368   160%     -  150s
H    0     0                    28495.844576 57083.2368   100%     -  150s
H    0     0                    28975.192298 57083.2368  97.0%     -  150s
H    0     0                    29303.367930 57083.2368  94.8%     -  150s
     0     0 56499.2778    0  311 29303.3679 56499.2778  92.8%     -  173s
     0     0 56461.1189    0  286 29303.3679 56461.1189  92.7%     -  179s
     0     0 56429.0517    0  289 29303.3679 56429.0517  92.6%     -  186s
     0     0 56362.5389    0  295 29303.3679 56362.5389  92.3%     -  193s
     0     0 56351.8371    0  300 29303.3679 56351.8371  92.3%     -  197s
     0     0 56332.9425    0  302 29303.3679 56332.9425  92.2%     -  203s
     0     0 56302.0919    0  306 29303.3679 56302.0919  92.1%     -  208s
     0     0 56265.4646    0  299 29303.3679 56265.4646  92.0%     -  212s
     0     0 56251.9827    0  303 29303.3679 56251.9827  92.0%     -  216s
     0     0 56242.5714    0  305 29303.3679 56242.5714  91.9%     -  218s
     0     0 56241.9106    0  305 29303.3679 56241.9106  91.9%     -  219s
     0     0 53898.5349    0  338 29303.3679 53898.5349  83.9%     -  280s
H    0     0                    29340.206381 53898.4971  83.7%     -  281s
H    0     0                    29382.856893 53898.4971  83.4%     -  281s
H    0     0                    29390.511156 53898.4971  83.4%     -  281s
H    0     0                    29633.533250 53898.4971  81.9%     -  281s
H    0     0                    29965.504034 53898.4971  79.9%     -  281s
     0     0 53634.2357    0  335 29965.5040 53634.2357  79.0%     -  297s
     0     0 53417.4136    0  350 29965.5040 53417.4136  78.3%     -  309s
     0     0 53211.6662    0  340 29965.5040 53211.6662  77.6%     -  326s
     0     0 53104.8628    0  342 29965.5040 53104.8628  77.2%     -  338s
     0     0 53050.0633    0  345 29965.5040 53050.0633  77.0%     -  345s
     0     0 53033.1321    0  348 29965.5040 53033.1321  77.0%     -  353s
     0     0 53024.2122    0  346 29965.5040 53024.2122  77.0%     -  357s
     0     0 52991.2664    0  354 29965.5040 52991.2664  76.8%     -  362s
     0     0 52988.9694    0  352 29965.5040 52988.9694  76.8%     -  364s
     0     0 52963.9562    0  351 29965.5040 52963.9562  76.7%     -  371s
     0     0 52960.4283    0  354 29965.5040 52960.4283  76.7%     -  373s
     0     0 52960.2101    0  354 29965.5040 52960.2101  76.7%     -  374s
     0     0 51800.3403    0  363 29965.5040 51800.3403  72.9%     -  418s
     0     0 51688.0480    0  350 29965.5040 51688.0480  72.5%     -  428s
     0     0 51596.2745    0  374 29965.5040 51596.2745  72.2%     -  436s
     0     0 51562.8305    0  385 29965.5040 51562.8305  72.1%     -  440s
     0     0 51432.8286    0  358 29965.5040 51432.8286  71.6%     -  447s
     0     0 51400.0295    0  366 29965.5040 51400.0295  71.5%     -  452s
     0     0 51374.4219    0  373 29965.5040 51374.4219  71.4%     -  456s
     0     0 51307.3275    0  366 29965.5040 51307.3275  71.2%     -  466s
     0     0 51298.7602    0  377 29965.5040 51298.7602  71.2%     -  468s
     0     0 51282.3660    0  371 29965.5040 51282.3660  71.1%     -  472s
     0     0 51275.5022    0  370 29965.5040 51275.5022  71.1%     -  474s
     0     0 51271.7179    0  374 29965.5040 51271.7179  71.1%     -  476s
     0     0 51266.0072    0  383 29965.5040 51266.0072  71.1%     -  481s
     0     0 51256.5949    0  378 29965.5040 51256.5949  71.1%     -  483s
     0     0 51240.0642    0  370 29965.5040 51240.0642  71.0%     -  486s
     0     0 51232.1272    0  378 29965.5040 51232.1272  71.0%     -  489s
     0     0 51225.4003    0  385 29965.5040 51225.4003  70.9%     -  492s
     0     0 51221.1561    0  380 29965.5040 51221.1561  70.9%     -  494s
     0     0 51218.0540    0  382 29965.5040 51218.0540  70.9%     -  495s
     0     0 51216.4893    0  384 29965.5040 51216.4893  70.9%     -  496s
     0     0 51014.0297    0  388 29965.5040 51014.0297  70.2%     -  510s
     0     0 50948.9943    0  387 29965.5040 50948.9943  70.0%     -  519s
     0     0 50930.8914    0  356 29965.5040 50930.8914  70.0%     -  523s
     0     0 50911.1421    0  352 29965.5040 50911.1421  69.9%     -  527s
     0     0 50903.9381    0  350 29965.5040 50903.9381  69.9%     -  529s
     0     0 50883.1617    0  353 29965.5040 50883.1617  69.8%     -  533s
     0     0 50880.7642    0  355 29965.5040 50880.7642  69.8%     -  535s
     0     0 50879.2958    0  358 29965.5040 50879.2958  69.8%     -  536s
     0     0 50817.9483    0  365 29965.5040 50817.9483  69.6%     -  544s
     0     0 50790.4077    0  371 29965.5040 50790.4077  69.5%     -  547s
     0     0 50782.1133    0  396 29965.5040 50782.1133  69.5%     -  549s
     0     0 50776.7515    0  377 29965.5040 50776.7515  69.5%     -  551s
     0     0 50774.5751    0  378 29965.5040 50774.5751  69.4%     -  552s
     0     0 50719.8422    0  359 29965.5040 50719.8422  69.3%     -  558s
H    0     0                    30093.078279 50705.8490  68.5%     -  563s
H    0     0                    30155.950362 50705.8490  68.1%     -  563s
H    0     0                    30233.660607 50705.8490  67.7%     -  563s
H    0     0                    30240.320046 50705.8490  67.7%     -  563s
H    0     0                    30258.364001 50705.8490  67.6%     -  563s
H    0     0                    30293.740721 50705.8490  67.4%     -  563s
H    0     0                    30371.662954 50705.8490  67.0%     -  563s
H    0     0                    30396.254725 50705.8490  66.8%     -  563s
H    0     0                    30446.888733 50705.8490  66.5%     -  563s
     0     0 50705.8490    0  375 30446.8887 50705.8490  66.5%     -  563s
     0     0 50698.0949    0  375 30446.8887 50698.0949  66.5%     -  567s
     0     0 50686.2829    0  363 30446.8887 50686.2829  66.5%     -  571s
     0     0 50679.6416    0  366 30446.8887 50679.6416  66.5%     -  574s
     0     0 50677.5033    0  389 30446.8887 50677.5033  66.4%     -  575s
     0     0 50634.8120    0  372 30446.8887 50634.8120  66.3%     -  583s
H    0     0                    30486.934154 50634.4858  66.1%     -  584s
H    0     0                    30498.960321 50634.4858  66.0%     -  584s
H    0     0                    30530.174098 50634.4858  65.9%     -  584s
H    0     0                    30539.592544 50634.4858  65.8%     -  584s
H    0     0                    30543.104259 50634.4858  65.8%     -  584s
H    0     0                    30548.498739 50634.4858  65.8%     -  584s
H    0     0                    30549.777220 50634.4858  65.7%     -  584s
H    0     0                    30557.917185 50634.4858  65.7%     -  584s
H    0     0                    30636.837858 50621.8838  65.2%     -  589s
     0     0 50621.8838    0  375 30636.8379 50621.8838  65.2%     -  589s
     0     0 50618.4172    0  363 30636.8379 50618.4172  65.2%     -  592s
     0     0 50616.0767    0  377 30636.8379 50616.0767  65.2%     -  594s
H    0     0                    30743.966448 50589.5993  64.6%     -  600s
     0     0 50589.5993    0  372 30743.9664 50589.5993  64.6%     -  600s
H    0     0                    30858.713112 50588.5554  63.9%     -  601s
H    0     0                    30901.131198 50588.5554  63.7%     -  601s
     0     0 50579.5105    0  384 30901.1312 50579.5105  63.7%     -  603s
     0     0 50570.9337    0  381 30901.1312 50570.9337  63.7%     -  606s
     0     0 50566.5864    0  382 30901.1312 50566.5864  63.6%     -  608s
     0     0 50560.0162    0  377 30901.1312 50560.0162  63.6%     -  610s
     0     0 50558.4296    0  384 30901.1312 50558.4296  63.6%     -  612s
     0     0 50551.5109    0  377 30901.1312 50551.5109  63.6%     -  615s
H    0     0                    30910.423717 50551.3449  63.5%     -  616s
     0     0 50547.6937    0  368 30910.4237 50547.6937  63.5%     -  618s
     0     0 50542.4638    0  371 30910.4237 50542.4638  63.5%     -  621s
     0     0 50540.2052    0  377 30910.4237 50540.2052  63.5%     -  624s
     0     0 50510.9488    0  364 30910.4237 50510.9488  63.4%     -  630s
     0     0 50505.4298    0  394 30910.4237 50505.4298  63.4%     -  633s
     0     0 50499.0064    0  364 30910.4237 50499.0064  63.4%     -  635s
     0     0 50496.7461    0  360 30910.4237 50496.7461  63.4%     -  635s
     0     0 50476.3200    0  396 30910.4237 50476.3200  63.3%     -  639s
     0     0 50474.3130    0  364 30910.4237 50474.3130  63.3%     -  641s
     0     0 50469.2937    0  388 30910.4237 50469.2937  63.3%     -  644s
     0     0 50466.5488    0  396 30910.4237 50466.5488  63.3%     -  645s
     0     0 50465.5054    0  401 30910.4237 50465.5054  63.3%     -  647s
     0     0 50462.6118    0  413 30910.4237 50462.6118  63.3%     -  649s
     0     0 50461.2571    0  414 30910.4237 50461.2571  63.2%     -  651s
     0     0 50457.8148    0  370 30910.4237 50457.8148  63.2%     -  654s
     0     0 50457.7406    0  370 30910.4237 50457.7406  63.2%     -  656s
H    0     0                    30970.450445 50457.7367  62.9%     -  708s
     0     2 50457.7367    0  370 30970.4504 50457.7367  62.9%     -  769s
     1     3 49720.9005    1  342 30970.4504 50457.0276  62.9% 18241  787s
     2     4 50335.3571    1  365 30970.4504 50335.3571  62.5% 13549  796s
     3     8 49954.3398    2  415 30970.4504 50335.2700  62.5% 13755  809s
     7    16 49861.7399    3  412 30970.4504 50292.7047  62.4% 10063  824s
    15    29 49708.3114    4  398 30970.4504 50189.4569  62.1% 11238  846s
    28    42 48532.7641    5  388 30970.4504 50055.9606  61.6% 18800  898s
    41    71 48496.0330    6  368 30970.4504 50055.9606  61.6% 17344  983s
H   62    71                    30973.507054 50055.9606  61.6% 14402  983s
    70   145 48424.4461    7  355 30973.5071 50055.9606  61.6% 16165 1027s
   144   232 47772.7244    9  335 30973.5071 50055.9606  61.6% 12989 1061s
   231   286 47849.3595    8  307 30973.5071 50055.9606  61.6% 10258 1086s
   285   314 47060.1639   13  319 30973.5071 50055.9606  61.6%  9691 1106s
   313   354 48196.2987   11  338 30973.5071 50055.9606  61.6%  9660 1128s
   353   383 47732.7177   10  334 30973.5071 50055.9606  61.6%  9439 1150s
   382   416 47359.7126   10  271 30973.5071 50055.9606  61.6%  9470 1170s
   415   449 47657.8352   12  347 30973.5071 50055.9606  61.6%  9363 1191s
   448   486 48150.7993   12  339 30973.5071 50055.9606  61.6%  9235 1210s
   485   523 47985.9283   13  340 30973.5071 50055.9606  61.6%  8961 1227s
   522   560 47911.4822   13  328 30973.5071 50055.9606  61.6%  8724 1248s
   559   594 47838.1061   14  370 30973.5071 50055.9606  61.6%  8487 1269s
   593   628 43638.7981   30  302 30973.5071 50055.9606  61.6%  8330 1289s
   627   666 47814.0709   14  329 30973.5071 50055.9606  61.6%  8208 1305s
H  652   666                    31000.725273 50055.9606  61.5%  8037 1305s
   665   752 47533.2124   15  331 31000.7253 50055.9606  61.5%  7990 1330s
   751   782 47411.2423   15  321 31000.7253 50055.9606  61.5%  7619 1348s
H  758   782                    31171.892213 50055.9606  60.6%  7607 1348s
   783   857 47691.0409   15  366 31171.8922 50055.9606  60.6%  7543 1372s
   860   962 47463.7522   16  339 31171.8922 50055.9606  60.6%  7330 1394s
   965  1066 47197.7246   16  346 31171.8922 50055.9606  60.6%  6961 1417s
  1073  1180 47066.7362   18  322 31171.8922 50055.9606  60.6%  6632 1441s
  1191  1287 46567.3974   17  328 31171.8922 50055.9606  60.6%  6303 1468s
  1308  1385 47001.4683   19  317 31171.8922 50055.9606  60.6%  6074 1494s
  1443  1480 46508.8590   18  324 31171.8922 50055.9606  60.6%  5798 1523s
  1568  1535 46312.3075   20  263 31171.8922 50055.9606  60.6%  5587 1551s
  1687  1583 44750.0548   20  311 31171.8922 50055.9606  60.6%  5491 1582s
  1808  1598 42027.2461   20  327 31171.8922 50055.9606  60.6%  5381 1614s
  1843  1636 40484.7075   20  377 31171.8922 50055.9606  60.6%  5433 1646s
  1899  1672 43071.8806   21  304 31171.8922 50055.9606  60.6%  5457 1673s
H 1911  1672                    31183.579848 50055.9606  60.5%  5455 1673s
  1941  1771 42644.7156   22  304 31183.5798 50055.9606  60.5%  5476 1720s
  2069  1873 42527.8869   23  304 31183.5798 50055.9606  60.5%  5383 1757s
  2227  1898 41014.6803   25  285 31183.5798 50055.9606  60.5%  5265 1784s
  2268  1997 40637.1950   25  275 31183.5798 50055.9606  60.5%  5279 1819s
  2379  2081 42038.6401   23  298 31183.5798 50055.9606  60.5%  5204 1857s
  2528  2214 40827.5785   26  289 31183.5798 50055.9606  60.5%  5132 1894s
  2689  2322 40405.2524   27  263 31183.5798 50055.9606  60.5%  5060 1936s
  2882  2455 39984.5815   30  259 31183.5798 50055.9606  60.5%  4950 1978s
  3079  2591 39377.3430   34  240 31183.5798 50055.9606  60.5%  4853 2023s
  3293  2684 38990.5629   41  204 31183.5798 50055.9606  60.5%  4728 2068s
  3468  2807 34772.5973   41  218 31183.5798 50055.9606  60.5%  4728 2118s
  3651  2927 34566.0312   45  176 31183.5798 49979.4492  60.3%  4693 2170s
  3834  2928 33882.2163   26  370 31183.5798 49979.4492  60.3%  4689 2434s
  3836  2929 40076.9481   32  164 31183.5798 49979.4492  60.3%  4687 2449s
  3837  2930 47909.4188    8  293 31183.5798 49979.4492  60.3%  4685 2525s
  3838  2931 44142.0498   14  349 31183.5798 49979.4492  60.3%  4684 2584s
  3839  2931 34129.1841   36  350 31183.5798 49979.4492  60.3%  4683 2619s
  3840  2932 40827.5759   27  357 31183.5798 49979.4492  60.3%  4682 2644s
  3841  2933 46055.5127    7  367 31183.5798 49979.4492  60.3%  4681 2660s
  3842  2933 38833.7081   29  352 31183.5798 49979.4492  60.3%  4679 2670s
  3843  2934 32878.2532   38  402 31183.5798 49979.4492  60.3%  4678 2684s
  3844  2935 37257.0744   49  367 31183.5798 49979.4492  60.3%  4677 2694s
  3845  2935 44345.8574   23  369 31183.5798 49979.4492  60.3%  4676 2703s
  3846  2936 34169.1410   65  357 31183.5798 49979.4492  60.3%  4674 2707s
  3847  2937 36070.5108   57  363 31183.5798 49979.4492  60.3%  4673 2712s
  3848  2937 47670.1799   16  367 31183.5798 49979.4492  60.3%  4672 2716s
  3849  2938 38959.4599   46  367 31183.5798 49979.4492  60.3%  4671 2722s
  3850  2939 45692.9606   10  308 31183.5798 49979.4492  60.3%  4670 2728s
  3851  2939 32528.8702   31  319 31183.5798 49979.4492  60.3%  4668 2735s
  3852  2940 32676.9829   52  367 31183.5798 49979.4492  60.3%  4667 2746s
  3854  2941 40885.5390   24  370 31183.5798 49979.4492  60.3%  4665 2750s
  3857  2943 34107.6626   63  366 31183.5798 49979.4492  60.3%  4661 2757s
  3858  2944 44939.8375   16  421 31183.5798 49979.4492  60.3%  4660 2772s
  3859  2945 41776.0166   21  432 31183.5798 49979.4492  60.3%  4659 2778s
  3860  2945 40827.5759   27  424 31183.5798 49979.4492  60.3%  4657 2781s
  3863  2947 38408.0041   48  414 31183.5798 49979.4492  60.3%  4654 2785s
  3864  2948 42813.5128   20  316 31183.5798 49979.4492  60.3%  4653 2794s
  3865  2949 45793.4606   16  406 31183.5798 49979.4492  60.3%  4651 2798s
  3866  2949 33031.0484   42  368 31183.5798 49979.4492  60.3%  4650 2802s
  3867  2950 38428.2461   50  430 31183.5798 49979.4492  60.3%  4649 2808s
  3868  2951 38996.6526   14  448 31183.5798 49979.4492  60.3%  4648 2811s
  3869  2951 46834.2208   17  450 31183.5798 49979.4492  60.3%  4647 2815s
  3870  2952 45786.2677   22  360 31183.5798 49979.4492  60.3%  4645 2822s
  3871  2953 41679.4098   39  356 31183.5798 49979.4492  60.3%  4644 2825s
  3872  2953 35674.6990   52  367 31183.5798 49979.4492  60.3%  4643 2833s
  3873  2954 38236.5289   52  446 31183.5798 49979.4492  60.3%  4642 2839s
  3874  2955 38860.2060   57  405 31183.5798 49979.4492  60.3%  4641 2843s
H 3874  2806                    31211.265511 49979.4492  60.1%  4641 2847s
  3876  2807 31922.7385   58  371 31211.2655 49979.4492  60.1%  4638 2850s
  3877  2808 37088.2807   53  382 31211.2655 49979.4492  60.1%  4637 2873s
  3878  2808 32672.1845   56  377 31211.2655 49979.4492  60.1%  4636 2875s
  3880  2810 32676.1533   51  419 31211.2655 49979.4492  60.1%  4633 2886s
  3882  2811 32798.3372   57  384 31211.2655 49979.4492  60.1%  4631 2892s
  3883  2812 39767.5223   40  421 31211.2655 49979.4492  60.1%  4630 2896s
  3884  2812 45943.4739    9  408 31211.2655 49979.4492  60.1%  4629 2909s
  3885  2813 41172.2806   30  376 31211.2655 49979.4492  60.1%  4628 2911s
  3887  2814 33540.4413   34  377 31211.2655 49979.4492  60.1%  4625 2921s
  3889  2816 41119.2753   30  389 31211.2655 49979.4492  60.1%  4623 2937s
  3890  2816 33195.8202   74  386 31211.2655 49979.4492  60.1%  4622 2941s
  3891  2817 32834.8041   43  386 31211.2655 49979.4492  60.1%  4620 2946s
  3893  2818 43746.5359   24  383 31211.2655 49979.4492  60.1%  4618 2954s
  3894  2819 34208.8153   60  382 31211.2655 49979.4492  60.1%  4617 2957s
  3895  2820 42285.2862   20  395 31211.2655 49979.4492  60.1%  4616 2962s
  3896  2820 38731.7833   48  419 31211.2655 49979.4492  60.1%  4614 2974s
  3897  2821 32835.5841   56  436 31211.2655 49979.4492  60.1%  4613 2976s
  3899  2822 34548.2632   51  426 31211.2655 49979.4492  60.1%  4611 2980s
  3901  2824 33698.5047   18  380 31211.2655 49910.0145  59.9%  4609 2996s
  3902  2824 44965.2186   18  403 31211.2655 49846.3723  59.7%  4607 3007s
  3903  2825 38740.3115   45  405 31211.2655 49798.1383  59.6%  4606 3016s
  3904  2826 36174.7573   18  389 31211.2655 49785.2493  59.5%  4605 3020s
  3906  2827 43965.7320   18  427 31211.2655 49743.3390  59.4%  4603 3035s
  3908  2828 35511.5457   27  394 31211.2655 49738.5331  59.4%  4600 3041s
  3909  2829 36023.2461   54  397 31211.2655 49736.5997  59.4%  4599 3045s
  3910  2830 31931.2683   48  394 31211.2655 49632.0596  59.0%  4598 3058s
  3911  2830 45845.6756   19  406 31211.2655 49626.3333  59.0%  4597 3062s
  3912  2831 35649.7425   39  391 31211.2655 49616.9243  59.0%  4596 3066s
  3914  2832 45193.0934   16  392 31211.2655 49610.4901  59.0%  4593 3074s
  3915  2833 34990.1501   40  440 31211.2655 49579.8911  58.9%  4592 3086s
  3916  2834 48064.5341    8  393 31211.2655 49578.4385  58.8%  4591 3091s
  3918  2835 41172.2806   30  447 31211.2655 49573.2446  58.8%  4589 3098s
  3919  2836 33789.8772   31  401 31211.2655 49546.6384  58.7%  4587 3148s
  3920  2836 35368.9820   43  488 31211.2655 49546.6384  58.7%  4586 3153s
  3921  2837 34908.1609   50  448 31211.2655 49546.6384  58.7%  4585 3160s
  3923  2838 33329.2000   34  493 31211.2655 49546.6384  58.7%  4583 3170s
  3925  2840 36036.3300   59  441 31211.2655 49533.9617  58.7%  4580 3181s
  3926  2840 47721.2908   10  395 31211.2655 49533.9617  58.7%  4579 3185s
  3927  2841 38861.3878   42  398 31211.2655 49533.9617  58.7%  4578 3191s
  3928  2842 34876.6104   44  398 31211.2655 49533.7465  58.7%  4577 3215s
  3929  2842 43543.0378   18  398 31211.2655 49533.7465  58.7%  4576 3331s
  3930  2845 49498.8107   10  386 31211.2655 49533.7465  58.7%  4722 3368s
  3931  2846 49520.7571   10  391 31211.2655 49520.7571  58.7%  4721 3382s
  3932  2849 48728.0248   11  344 31211.2655 49518.6006  58.7%  4724 3415s
  3936  2856 48400.1596   12  373 31211.2655 49389.0040  58.2%  4731 3482s
  3944  2869 47893.1482   13  384 31211.2655 49294.6903  57.9%  4749 3548s

Cutting planes:
  Gomory: 8
  Implied bound: 10
  Projected implied bound: 74
  MIR: 1321
  Mixing: 1
  Flow cover: 1818
  RLT: 30
  Relax-and-lift: 247

Explored 3960 nodes (19892130 simplex iterations) in 3600.10 seconds (9110.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 31211.3 31183.6 31171.9 ... 30744

Time limit reached
Warning: max constraint violation (1.3315e-09) exceeds tolerance
Best objective 3.121126551115e+04, best bound 4.870067356210e+04, gap 56.0356%
  WARNING: Time limit reached. Using best solution found (gap: 56.04%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 31211.27, θ = 183639.30
  Upper Bound (UB) = 31211.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183639.30
  [DEBUG]   ✓ Scenario 0: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183639.30 ≤ Q = 183639.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183639.30 ≤ Q = 183639.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5a920c92
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5a920c92
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.410133e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6948674.3126
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.553069e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155306.88    0  124 6948674.31 -155306.88   102%     -    0s
H    0     0                    -120677.0262 -155306.88  28.7%     -    0s
H    0     0                    -121766.8931 -155306.88  27.5%     -    0s
H    0     0                    -128787.2998 -133805.03  3.90%     -    0s
     0     0 -133805.03    0  105 -128787.30 -133805.03  3.90%     -    0s
     0     0 -131811.55    0  110 -128787.30 -131811.55  2.35%     -    0s
H    0     0                    -129819.4668 -131805.52  1.53%     -    0s
     0     0 -131639.71    0  110 -129819.47 -131639.71  1.40%     -    0s
     0     0 -131281.74    0   89 -129819.47 -131281.74  1.13%     -    0s
     0     0 -131122.23    0   83 -129819.47 -131122.23  1.00%     -    0s
     0     0 -131121.55    0   83 -129819.47 -131121.55  1.00%     -    0s
     0     0 -130908.95    0   78 -129819.47 -130908.95  0.84%     -    0s
     0     0 -130882.03    0   78 -129819.47 -130882.03  0.82%     -    0s
     0     0 -130769.81    0   74 -129819.47 -130769.81  0.73%     -    0s
     0     0 -130767.62    0   74 -129819.47 -130767.62  0.73%     -    0s
     0     2 -130767.62    0   74 -129819.47 -130767.62  0.73%     -    0s
H   33    25                    -129971.7991 -130501.04  0.41%  18.3    0s
H  312   196                    -129972.0162 -130277.42  0.23%   8.0    0s
H  336   196                    -130034.1736 -130277.42  0.19%   7.8    0s
H  372   196                    -130082.3018 -130277.42  0.15%   7.4    0s
*  490   150              21    -130146.6813 -130260.93  0.09%   6.9    0s
*  634    37              21    -130157.3639 -130247.23  0.07%   6.1    0s
*  675    37              18    -130175.7238 -130245.91  0.05%   6.0    0s
*  687    37              16    -130180.6016 -130245.91  0.05%   5.9    0s

Cutting planes:
  Gomory: 54
  Implied bound: 13
  MIR: 181
  Flow cover: 10
  RLT: 23
  Relax-and-lift: 2
  BQP: 2

Explored 808 nodes (4887 simplex iterations) in 0.09 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130181 -130176 -130157 ... -128787

Optimal solution found (tolerance 1.00e-04)
Best objective -1.301806016262e+05, best bound -1.301920127979e+05, gap 0.0088%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 177368.15
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130180.60
  [DEBUG]   S×d_nominal = 307548.75
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307548.75 + -130180.60 = 177368.15
  [DEBUG]   Current θ from Master = 183639.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6271.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24940.11
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 848.4530, Absolute Gap = 848.4530, Relative Gap = 0.027184
  Not converged yet (gap = 848.45 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x626f49ca
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 2.23s
Presolved: 132903 rows, 56180 columns, 818088 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.13s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 6.507e+06
 Factor NZ  : 1.433e+07 (roughly 200 MB of memory)
 Factor Ops : 3.111e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.77001846e+07  2.46071234e+08  1.31e+05 1.51e+01  8.47e+04     4s
   1  -1.36051887e+07  2.27553442e+08  9.23e+04 7.49e+01  5.93e+04     5s
   2  -5.46922308e+06  1.68419264e+08  3.65e+04 2.78e+00  2.51e+04     5s
   3  -1.01959723e+06  1.28688706e+08  2.82e+03 1.75e+00  2.37e+03     5s
   4  -5.41821842e+05  7.88232515e+07  5.91e+02 6.76e-01  6.80e+02     5s
   5  -4.72915974e+05  4.67602807e+07  3.35e+02 3.47e-01  3.76e+02     5s
   6  -4.03766946e+05  3.52062959e+07  1.32e+02 2.42e-01  2.13e+02     5s
   7  -3.69435281e+05  2.62881474e+07  8.12e+01 1.71e-01  1.46e+02     5s
   8  -2.76474535e+05  1.77375137e+07  1.27e+01 1.09e-01  7.89e+01     5s
   9  -1.71338903e+05  1.48006585e+07  1.50e+00 8.98e-02  6.21e+01     5s
  10  -1.16645711e+05  4.97216497e+06  5.85e-01 2.97e-02  2.10e+01     5s
  11  -8.10612168e+04  2.60038751e+06  2.18e-01 1.61e-02  1.11e+01     5s
  12  -5.34386421e+04  1.26141547e+06  1.07e-01 7.60e-03  5.42e+00     5s
  13  -2.06507812e+04  4.89068253e+05  4.99e-02 2.64e-03  2.10e+00     5s
  14   3.08697442e+03  3.41150496e+05  2.88e-02 1.80e-03  1.39e+00     5s
  15   1.20875311e+04  2.66357115e+05  2.33e-02 1.96e-03  1.05e+00     5s
  16   2.75205117e+04  1.81145959e+05  1.46e-02 1.15e-03  6.33e-01     5s
  17   3.08178219e+04  1.55686316e+05  1.30e-02 9.05e-04  5.14e-01     6s
  18   3.74890045e+04  1.21227056e+05  1.00e-02 5.73e-04  3.45e-01     6s
  19   4.21881725e+04  1.11730936e+05  8.03e-03 4.68e-04  2.87e-01     6s
  20   4.55875351e+04  1.01630956e+05  6.65e-03 3.66e-04  2.31e-01     6s
  21   5.03744470e+04  9.72512466e+04  4.80e-03 3.39e-04  1.93e-01     6s
  22   5.28168996e+04  8.95371958e+04  3.95e-03 2.69e-04  1.51e-01     6s
  23   5.43184819e+04  8.55986701e+04  3.46e-03 2.23e-04  1.29e-01     6s
  24   5.82015148e+04  8.02228446e+04  2.26e-03 1.58e-04  9.07e-02     6s
  25   5.98000329e+04  7.65601539e+04  1.81e-03 1.14e-04  6.90e-02     6s
  26   6.12892021e+04  7.50889881e+04  1.41e-03 9.65e-05  5.69e-02     6s
  27   6.22987740e+04  7.08843455e+04  1.15e-03 4.49e-05  3.54e-02     6s
  28   6.39244578e+04  7.00478263e+04  7.51e-04 3.45e-05  2.52e-02     6s
  29   6.52802668e+04  6.91751707e+04  4.27e-04 2.93e-05  1.60e-02     6s
  30   6.58371184e+04  6.87726815e+04  3.00e-04 2.26e-05  1.21e-02     7s
  31   6.63286352e+04  6.79848156e+04  1.84e-04 1.06e-05  6.82e-03     7s
  32   6.64500088e+04  6.76172415e+04  1.59e-04 5.42e-06  4.81e-03     7s
  33   6.67232220e+04  6.74589193e+04  1.02e-04 4.05e-06  3.03e-03     7s
  34   6.68423645e+04  6.74034639e+04  7.60e-05 3.02e-06  2.31e-03     7s
  35   6.69615061e+04  6.73637936e+04  5.19e-05 2.30e-06  1.66e-03     7s
  36   6.70529000e+04  6.72743069e+04  3.39e-05 6.60e-07  9.12e-04     7s
  37   6.70942222e+04  6.72583002e+04  2.57e-05 8.31e-07  6.76e-04     7s
  38   6.71147522e+04  6.72516859e+04  2.18e-05 2.32e-06  5.64e-04     7s
  39   6.72018885e+04  6.72451618e+04  5.56e-06 1.52e-06  1.78e-04     7s
  40   6.72154988e+04  6.72396090e+04  2.93e-06 8.50e-07  9.93e-05     7s
  41   6.72286015e+04  6.72364191e+04  5.83e-07 4.61e-07  3.22e-05     7s
  42   6.72318261e+04  6.72355365e+04  7.99e-08 3.57e-07  1.53e-05     8s
  43   6.72324069e+04  6.72329885e+04  4.34e-08 6.36e-08  2.40e-06     8s
  44   6.72324377e+04  6.72324955e+04  3.95e-09 6.26e-09  2.38e-07     8s
  45   6.72324404e+04  6.72324405e+04  1.21e-09 4.74e-10  4.80e-10     8s

Barrier solved model in 45 iterations and 7.78 seconds (13.44 work units)
Optimal objective 6.72324404e+04


Root crossover log...

  118899 DPushes remaining with DInf 0.0000000e+00                 8s
    1573 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    3416 PPushes remaining with PInf 2.9139580e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.6514450e+00     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56468    6.7232440e+04   0.000000e+00   4.651445e+00     11s
   56470    6.7232440e+04   0.000000e+00   0.000000e+00     11s
   56470    6.7232440e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.25s

Solved with barrier

Root relaxation: objective 6.723244e+04, 56470 iterations, 8.42 seconds (16.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67232.4404    0  158 -180179.68 67232.4404   137%     -   11s
H    0     0                    -174029.4543 67232.4404   139%     -   11s
H    0     0                    -159861.2421 67232.4404   142%     -   12s
H    0     0                    -50446.15442 67232.4404   233%     -   12s
H    0     0                    19581.239918 67232.4404   243%     -   13s
H    0     0                    21793.908313 67232.4404   208%     -   14s
H    0     0                    22031.374513 67232.4404   205%     -   14s
     0     0 61660.6668    0  211 22031.3745 61660.6668   180%     -   50s
     0     0 61352.3195    0  207 22031.3745 61352.3195   178%     -   69s
     0     0 61123.5153    0  206 22031.3745 61123.5153   177%     -   80s
     0     0 60786.8217    0  218 22031.3745 60786.8217   176%     -   91s
     0     0 60782.7674    0  221 22031.3745 60782.7674   176%     -   93s
     0     0 60781.1907    0  217 22031.3745 60781.1907   176%     -   94s
     0     0 60780.7243    0  217 22031.3745 60780.7243   176%     -   95s
     0     0 57892.9217    0  247 22031.3745 57892.9217   163%     -  131s
H    0     0                    28093.862245 57892.7365   106%     -  132s
H    0     0                    28125.992578 57892.7365   106%     -  132s
H    0     0                    28130.753456 57892.7365   106%     -  132s
H    0     0                    28134.807097 57892.7365   106%     -  132s
H    0     0                    28217.945528 57892.7365   105%     -  132s
     0     0 57354.1023    0  292 28217.9455 57354.1023   103%     -  150s
     0     0 57314.7444    0  288 28217.9455 57314.7444   103%     -  157s
     0     0 57288.7851    0  290 28217.9455 57288.7851   103%     -  163s
     0     0 57234.2651    0  278 28217.9455 57234.2651   103%     -  169s
     0     0 57113.5943    0  301 28217.9455 57113.5943   102%     -  179s
     0     0 57061.8921    0  286 28217.9455 57061.8921   102%     -  187s
     0     0 57050.8056    0  286 28217.9455 57050.8056   102%     -  190s
     0     0 56970.3006    0  295 28217.9455 56970.3006   102%     -  197s
     0     0 56636.2831    0  282 28217.9455 56636.2831   101%     -  208s
     0     0 56583.5666    0  275 28217.9455 56583.5666   101%     -  214s
     0     0 56571.2645    0  290 28217.9455 56571.2645   100%     -  216s
     0     0 56570.9989    0  289 28217.9455 56570.9989   100%     -  218s
     0     0 54182.1185    0  310 28217.9455 54182.1185  92.0%     -  270s
H    0     0                    28433.147514 54182.0389  90.6%     -  270s
H    0     0                    28503.869711 54182.0389  90.1%     -  270s
H    0     0                    28608.399667 54182.0389  89.4%     -  270s
     0     0 53790.3679    0  333 28608.3997 53790.3679  88.0%     -  292s
     0     0 53482.1181    0  338 28608.3997 53482.1181  86.9%     -  308s
     0     0 53285.5472    0  348 28608.3997 53285.5472  86.3%     -  324s
     0     0 53198.3901    0  335 28608.3997 53198.3901  86.0%     -  336s
     0     0 53144.9230    0  383 28608.3997 53144.9230  85.8%     -  345s
     0     0 53120.1451    0  342 28608.3997 53120.1451  85.7%     -  349s
     0     0 53089.0685    0  333 28608.3997 53089.0685  85.6%     -  352s
     0     0 53075.9982    0  336 28608.3997 53075.9982  85.5%     -  355s
     0     0 53059.1371    0  332 28608.3997 53059.1371  85.5%     -  360s
     0     0 53001.3420    0  336 28608.3997 53001.3420  85.3%     -  365s
     0     0 52976.8165    0  345 28608.3997 52976.8165  85.2%     -  369s
     0     0 52971.6402    0  347 28608.3997 52971.6402  85.2%     -  372s
     0     0 52963.8444    0  347 28608.3997 52963.8444  85.1%     -  375s
     0     0 52961.4096    0  339 28608.3997 52961.4096  85.1%     -  378s
     0     0 52959.9028    0  373 28608.3997 52959.9028  85.1%     -  379s
     0     0 51639.4475    0  377 28608.3997 51639.4475  80.5%     -  419s
H    0     0                    28908.166592 51639.2318  78.6%     -  419s
H    0     0                    29192.683557 51639.2318  76.9%     -  419s
     0     0 51449.3505    0  417 29192.6836 51449.3505  76.2%     -  435s
     0     0 51319.7739    0  378 29192.6836 51319.7739  75.8%     -  446s
     0     0 51276.4188    0  389 29192.6836 51276.4188  75.6%     -  452s
     0     0 51236.5630    0  375 29192.6836 51236.5630  75.5%     -  460s
     0     0 51211.8254    0  378 29192.6836 51211.8254  75.4%     -  466s
     0     0 51169.4246    0  372 29192.6836 51169.4246  75.3%     -  471s
     0     0 51155.4681    0  368 29192.6836 51155.4681  75.2%     -  477s
     0     0 51145.2069    0  413 29192.6836 51145.2069  75.2%     -  481s
     0     0 51129.3207    0  410 29192.6836 51129.3207  75.1%     -  484s
     0     0 51122.2263    0  379 29192.6836 51122.2263  75.1%     -  487s
     0     0 51121.0716    0  383 29192.6836 51121.0716  75.1%     -  489s
     0     0 50804.9534    0  428 29192.6836 50804.9534  74.0%     -  511s
H    0     0                    29333.949604 50804.2782  73.2%     -  511s
H    0     0                    29370.027758 50804.2782  73.0%     -  511s
H    0     0                    29427.680740 50804.2782  72.6%     -  511s
H    0     0                    29509.985822 50804.2782  72.2%     -  512s
H    0     0                    29555.827749 50804.2782  71.9%     -  512s
     0     0 50787.7441    0  395 29555.8277 50787.7441  71.8%     -  519s
     0     0 50748.7872    0  429 29555.8277 50748.7872  71.7%     -  528s
     0     0 50731.2597    0  389 29555.8277 50731.2597  71.6%     -  533s
     0     0 50717.1089    0  430 29555.8277 50717.1089  71.6%     -  539s
     0     0 50707.5089    0  402 29555.8277 50707.5089  71.6%     -  543s
     0     0 50702.3049    0  401 29555.8277 50702.3049  71.5%     -  547s
     0     0 50697.6848    0  440 29555.8277 50697.6848  71.5%     -  550s
     0     0 50690.1804    0  438 29555.8277 50690.1804  71.5%     -  551s
     0     0 50682.2459    0  394 29555.8277 50682.2459  71.5%     -  555s
     0     0 50680.5684    0  442 29555.8277 50680.5684  71.5%     -  558s
     0     0 50604.2051    0  386 29555.8277 50604.2051  71.2%     -  569s
     0     0 50590.3671    0  373 29555.8277 50590.3671  71.2%     -  577s
     0     0 50585.1757    0  427 29555.8277 50585.1757  71.2%     -  579s
     0     0 50575.5550    0  421 29555.8277 50575.5550  71.1%     -  584s
     0     0 50572.7641    0  412 29555.8277 50572.7641  71.1%     -  586s
     0     0 50570.4299    0  422 29555.8277 50570.4299  71.1%     -  587s
     0     0 50567.9118    0  414 29555.8277 50567.9118  71.1%     -  589s
     0     0 50567.0261    0  420 29555.8277 50567.0261  71.1%     -  590s
     0     0 50544.0498    0  380 29555.8277 50544.0498  71.0%     -  596s
H    0     0                    29665.915774 50542.2423  70.4%     -  597s
     0     0 50535.1141    0  431 29665.9158 50535.1141  70.3%     -  601s
     0     0 50531.8446    0  377 29665.9158 50531.8446  70.3%     -  603s
     0     0 50528.6332    0  382 29665.9158 50528.6332  70.3%     -  604s
     0     0 50528.0223    0  378 29665.9158 50528.0223  70.3%     -  605s
     0     0 50509.3273    0  419 29665.9158 50509.3273  70.3%     -  612s
     0     0 50500.2208    0  424 29665.9158 50500.2208  70.2%     -  617s
     0     0 50499.3813    0  425 29665.9158 50499.3813  70.2%     -  619s
     0     0 50486.1394    0  373 29665.9158 50486.1394  70.2%     -  623s
     0     0 50478.8735    0  379 29665.9158 50478.8735  70.2%     -  626s
     0     0 50475.8012    0  418 29665.9158 50475.8012  70.1%     -  629s
     0     0 50475.0210    0  379 29665.9158 50475.0210  70.1%     -  629s
     0     0 50467.6343    0  376 29665.9158 50467.6343  70.1%     -  633s
H    0     0                    29681.829278 50467.5532  70.0%     -  637s
H    0     0                    29720.316150 50467.5532  69.8%     -  637s
     0     0 50465.3073    0  374 29720.3161 50465.3073  69.8%     -  639s
     0     0 50460.7872    0  410 29720.3161 50460.7872  69.8%     -  642s
H    0     0                    29721.869258 50459.9081  69.8%     -  643s
     0     0 50457.4226    0  388 29721.8693 50457.4226  69.8%     -  645s
     0     0 50456.3115    0  378 29721.8693 50456.3115  69.8%     -  646s
     0     0 50442.2904    0  395 29721.8693 50442.2904  69.7%     -  652s
     0     0 50440.0995    0  395 29721.8693 50440.0995  69.7%     -  655s
H    0     0                    29758.314874 50440.0995  69.5%     -  718s
H    0     0                    29781.251412 50440.0995  69.4%     -  777s
H    0     0                    29864.243822 50440.0995  68.9%     -  777s
H    0     0                    29906.033630 50440.0995  68.7%     -  784s
     0     2 50440.0995    0  395 29906.0336 50440.0995  68.7%     -  814s
     1     4 50338.3840    1  404 29906.0336 50440.0995  68.7%  9439  824s
     3     8 50241.7827    2  360 29906.0336 50338.2280  68.3%  9492  845s
     7    16 50012.9358    3  360 29906.0336 50241.1524  68.0% 12604  872s
    15    31 49807.3934    4  417 29906.0336 50011.4883  67.2% 15604  902s
    30    46 48269.0757    5  365 29906.0336 49806.7838  66.5% 22994  976s
    45    77 47644.1746    6  324 29906.0336 49806.7838  66.5% 21125 1053s
H   46    77                    30184.468263 49806.7838  65.0% 20666 1053s
H   66    77                    30188.001091 49806.7838  65.0% 18075 1053s
    76   225 47605.1113    7  325 30188.0011 49806.7838  65.0% 17384 1101s
   224   268 47246.3600   12  301 30188.0011 49806.7838  65.0%  9623 1127s
H  261   268                    30219.204152 49806.7838  64.8%  9058 1127s
   267   320 46690.7831    9  347 30219.2042 49806.7838  64.8%  9022 1148s
   319   383 46863.5471   14  297 30219.2042 49806.7838  64.8%  8479 1170s
   382   440 46703.7609   15  294 30219.2042 49806.7838  64.8%  8120 1190s
   439   471 46450.9892   17  292 30219.2042 49806.7838  64.8%  7858 1207s
   470   516 46350.2486   18  286 30219.2042 49806.7838  64.8%  7864 1224s
   515   545 45872.5122   19  279 30219.2042 49806.7838  64.8%  7611 1241s
   544   575 45811.0346   20  276 30219.2042 49806.7838  64.8%  7508 1258s
   574   609 45806.3584   21  276 30219.2042 49806.7838  64.8%  7550 1272s
   608   641 45261.2151   22  289 30219.2042 49806.7838  64.8%  7708 1290s
   640   666 46688.4901   12  321 30219.2042 49806.7838  64.8%  7666 1312s
   665   693 46706.2448   13  344 30219.2042 49806.7838  64.8%  7886 1332s
   692   722 45427.3353   22  324 30219.2042 49806.7838  64.8%  7895 1351s
   721   753 46125.8490   13  316 30219.2042 49806.7838  64.8%  8041 1370s
   754   779 43460.6301   23  302 30219.2042 49806.7838  64.8%  7927 1390s
   782   806 43173.8653   24  304 30219.2042 49806.7838  64.8%  7794 1411s
   813   836 38085.6386   25  300 30219.2042 49806.7838  64.8%  7714 1428s
   845   865 38062.5146   26  300 30219.2042 49806.7838  64.8%  7596 1449s
   878   892 37898.9978   27  292 30219.2042 49806.7838  64.8%  7562 1467s
H  897   892                    30230.632116 49806.7838  64.8%  7488 1467s
   907   976 37701.4068   28  285 30230.6321 49806.7838  64.8%  7428 1493s
   993  1008 37323.5928   31  271 30230.6321 49806.7838  64.8%  7088 1510s
  1025  1036 37099.1143   32  194 30230.6321 49806.7838  64.8%  6979 1530s
H 1044  1036                    30271.112308 49806.7838  64.5%  6928 1530s
  1061  1182 37063.6068   33  226 30271.1123 49806.7838  64.5%  6866 1556s
  1217  1328 36118.6848   40  224 30271.1123 49806.7838  64.5%  6312 1581s
  1373  1491 34511.3835   45  163 30271.1123 49806.7838  64.5%  5897 1605s
  1546  1607 33698.7516   52  132 30271.1123 49806.7838  64.5%  5500 1628s
  1689  1754     cutoff   55      30271.1123 49806.7838  64.5%  5310 1656s
  1872  1871 32551.2828   61  178 30271.1123 49806.7838  64.5%  5060 1685s
  2038  1956 31551.9691   71  166 30271.1123 49806.7838  64.5%  4885 1719s
  2209  1997     cutoff   71      30271.1123 49668.5249  64.1%  4732 1750s
  2296  2034 49447.2740    6  403 30271.1123 49668.5249  64.1%  4699 1780s
  2421  2089 47455.1289    7  354 30271.1123 49668.5249  64.1%  4684 1817s
  2553  2144 47279.1891    8  359 30271.1123 49668.5249  64.1%  4653 1853s
  2698  2222 46587.3594    8  334 30271.1123 49668.5249  64.1%  4614 1891s
  2866  2279 46370.5720    9  349 30271.1123 49608.9436  63.9%  4551 1931s
  2986  2338 40775.7472   10  331 30271.1123 49608.9436  63.9%  4584 1976s
  3091  2406 infeasible   28      30271.1123 49608.9436  63.9%  4616 2021s
  3185  2502 39786.4407   11  325 30271.1123 49608.9436  63.9%  4684 2068s
  3302  2624 39274.9472   12  315 30271.1123 49608.9436  63.9%  4709 2113s
  3442  2755 38275.3566   14  309 30271.1123 49608.9436  63.9%  4728 2156s
H 3617  2755                    30278.173664 49315.6849  62.9%  4709 2244s
H 3617  2755                    30281.844751 49315.6849  62.9%  4709 2366s
  3618  2756 37765.0676   33  395 30281.8448 49315.6849  62.9%  4708 2600s
H 3619  2619                    30298.576086 49315.6849  62.8%  4707 2617s
H 3619  2488                    30299.263664 49315.6849  62.8%  4707 2617s
  3621  2489 34319.9178   46  286 30299.2637 49315.6849  62.8%  4704 2699s
  3622  2490 38637.5463   42  354 30299.2637 49315.6849  62.8%  4703 2769s
  3623  2490 46395.0571    7  360 30299.2637 49315.6849  62.8%  4702 2811s
  3624  2491 38606.1474   33  364 30299.2637 49315.6849  62.8%  4700 2838s
  3625  2492 37249.3105   58  405 30299.2637 49315.6849  62.8%  4699 2851s
  3626  2492 32394.8119   46  378 30299.2637 49315.6849  62.8%  4698 2869s
  3627  2493 44770.5531   15  379 30299.2637 49315.6849  62.8%  4696 2883s
  3628  2494 35552.4476   42  378 30299.2637 49315.6849  62.8%  4695 2891s
  3629  2494 35753.8262   48  387 30299.2637 49315.6849  62.8%  4694 2898s
  3630  2495 41418.3864   23  422 30299.2637 49315.6849  62.8%  4693 2905s
  3631  2496 37880.5295   53  380 30299.2637 49315.6849  62.8%  4691 2912s
  3632  2496 37408.7497   56  371 30299.2637 49315.6849  62.8%  4690 2926s
  3633  2497 40052.6858   20  410 30299.2637 49315.6849  62.8%  4689 2935s
  3634  2498 44571.2471    8  374 30299.2637 49315.6849  62.8%  4687 2941s
  3636  2499 36561.0657   28  418 30299.2637 49315.6849  62.8%  4685 2948s
  3637  2500 44835.5804   19  387 30299.2637 49315.6849  62.8%  4684 2950s
H 3638  2374                    30302.773587 49315.6849  62.7%  4682 2967s
  3639  2375 31237.6907   59  379 30302.7736 49315.6849  62.7%  4681 2973s
  3640  2376 43868.7533   20  422 30302.7736 49315.6849  62.7%  4680 2983s
  3641  2376 42297.7984   41  387 30302.7736 49315.6849  62.7%  4678 2996s
  3642  2377 42914.6207   14  423 30302.7736 49315.6849  62.7%  4677 3002s
  3643  2378 46481.8426   23  421 30302.7736 49315.6849  62.7%  4676 3008s
  3644  2378 44642.3987   20  391 30302.7736 49315.6849  62.7%  4675 3021s
  3645  2379 42703.7524   29  392 30302.7736 49315.6849  62.7%  4673 3029s
  3646  2380 38951.3461   35  394 30302.7736 49315.6849  62.7%  4672 3037s
  3647  2380 47579.2366   16  396 30302.7736 49315.6849  62.7%  4671 3040s
  3648  2381 39533.8133   17  404 30302.7736 49315.6849  62.7%  4669 3045s
  3649  2382 46639.6138   14  381 30302.7736 49315.6849  62.7%  4668 3056s
  3650  2382 42465.6885   25  382 30302.7736 49315.6849  62.7%  4667 3061s
  3651  2383 46951.8036    9  387 30302.7736 49315.6849  62.7%  4666 3072s
  3652  2384 39948.8911   41  433 30302.7736 49315.6849  62.7%  4664 3080s
  3654  2385 46853.1757   14  393 30302.7736 49315.6849  62.7%  4662 3087s
  3655  2386 45550.7982   23  391 30302.7736 49315.6849  62.7%  4660 3100s
  3657  2387 36823.7975   41  379 30302.7736 49315.6849  62.7%  4658 3105s
H 3658  2268                    30328.985445 49315.6849  62.6%  4657 3120s
H 3658  2154                    30483.291650 49315.6849  61.8%  4657 3120s
H 3658  2046                    30595.525409 49315.6849  61.2%  4657 3120s
  3659  2046 34097.1710   43  389 30595.5254 49315.6849  61.2%  4655 3125s
  3661  2048 33152.2073   53  387 30595.5254 49315.6849  61.2%  4653 3149s
  3662  2048 47843.6562   10  381 30595.5254 49315.6849  61.2%  4652 3153s
  3663  2049 44373.4255   21  396 30595.5254 49315.6849  61.2%  4650 3162s
  3664  2050 34458.9613   20  390 30595.5254 49315.6849  61.2%  4649 3167s
  3665  2050 35855.8183   30  387 30595.5254 49315.6849  61.2%  4648 3171s
H 3665  1946                    30619.240383 49315.6849  61.1%  4648 3185s
H 3665  1848                    30629.152443 49315.6849  61.0%  4648 3186s
H 3665  1755                    30650.416387 49315.6849  60.9%  4648 3187s
H 3666  1667                    30733.428666 49315.6849  60.5%  4646 3189s
H 3666  1583                    30738.474174 49315.6849  60.4%  4646 3189s
  3667  1584 46910.3720   17  379 30738.4742 49315.6849  60.4%  4645 3191s
  3668  1584 33029.9222   67  383 30738.4742 49315.6849  60.4%  4644 3197s
  3669  1585 30738.4742   39  383 30738.4742 49315.6849  60.4%  4643 3215s
H 3669  1505                    30772.259681 49315.6849  60.3%  4643 3315s
H 3670  1432                    30953.300735 49315.6849  59.3%  4770 3336s
  3671  1433 49315.6849   14  388 30953.3007 49315.6849  59.3%  4770 3422s
  3673  1437 49315.6849   15  385 30953.3007 49315.6849  59.3%  4775 3497s
  3677  1443 49315.6849   16  367 30953.3007 49315.6849  59.3%  4786 3554s
  3685  1455 49315.6849   17  387 30953.3007 49315.6849  59.3%  4819 3600s

Cutting planes:
  Learned: 1
  Gomory: 9
  Implied bound: 8
  Projected implied bound: 185
  MIR: 1184
  Mixing: 2
  Flow cover: 1391
  RLT: 14
  Relax-and-lift: 238

Explored 3699 nodes (18822827 simplex iterations) in 3600.11 seconds (9027.90 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 30953.3 30772.3 30738.5 ... 30329

Time limit reached
Best objective 3.095330073478e+04, best bound 4.931568485253e+04, gap 59.3229%
  WARNING: Time limit reached. Using best solution found (gap: 59.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 30953.30, θ = 183591.79
  Upper Bound (UB) = 30953.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183591.79
  [DEBUG]   ✓ Scenario 0: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183591.79 ≤ Q = 183591.79 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e87b4d7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa1784b29
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.413412e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6951865.7942
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.557940e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155794.04    0  124 6951865.79 -155794.04   102%     -    0s
H    0     0                    -121156.9277 -155794.04  28.6%     -    0s
H    0     0                    -122280.5054 -155794.04  27.4%     -    0s
     0     0 -136681.89    0   74 -122280.51 -136681.89  11.8%     -    0s
H    0     0                    -132935.7738 -136531.86  2.71%     -    0s
H    0     0                    -133963.2736 -136531.86  1.92%     -    0s
     0     0 -135839.44    0   73 -133963.27 -135839.44  1.40%     -    0s
H    0     0                    -134157.4472 -135746.49  1.18%     -    0s
     0     0 -135489.57    0   71 -134157.45 -135489.57  0.99%     -    0s
     0     0 -135022.00    0   24 -134157.45 -135022.00  0.64%     -    0s
     0     0 -134864.21    0   30 -134157.45 -134864.21  0.53%     -    0s
     0     0 -134850.27    0   26 -134157.45 -134850.27  0.52%     -    0s
     0     0 -134646.44    0   27 -134157.45 -134646.44  0.36%     -    0s
     0     0 -134622.25    0   28 -134157.45 -134622.25  0.35%     -    0s
     0     0 -134622.25    0   28 -134157.45 -134622.25  0.35%     -    0s
     0     0 -134506.69    0   27 -134157.45 -134506.69  0.26%     -    0s
     0     0 -134486.70    0   26 -134157.45 -134486.70  0.25%     -    0s
     0     0 -134486.70    0   21 -134157.45 -134486.70  0.25%     -    0s
     0     0 -134486.70    0   21 -134157.45 -134486.70  0.25%     -    0s
     0     0 -134486.70    0   47 -134157.45 -134486.70  0.25%     -    0s
     0     0 -134254.88    0   17 -134157.45 -134254.88  0.07%     -    0s
H    0     0                    -134227.4126 -134252.83  0.02%     -    0s
     0     0 -134252.64    0   11 -134227.41 -134252.64  0.02%     -    0s
     0     0 -134249.89    0   11 -134227.41 -134249.89  0.02%     -    0s
     0     0 -134249.70    0   11 -134227.41 -134249.70  0.02%     -    0s
     0     0          -    0      -134227.41 -134240.56  0.01%     -    0s

Cutting planes:
  Gomory: 16
  Implied bound: 8
  MIR: 21
  Flow cover: 12
  RLT: 6
  Relax-and-lift: 1

Explored 1 nodes (911 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -134227 -134157 -133963 ... 1.41341e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.342274125572e+05, best bound -1.342405640605e+05, gap 0.0098%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 173666.86
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134227.41
  [DEBUG]   S×d_nominal = 307894.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307894.27 + -134227.41 = 173666.86
  [DEBUG]   Current θ from Master = 183591.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9924.94 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21028.36
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 590.4882, Absolute Gap = 590.4882, Relative Gap = 0.019077
  Not converged yet (gap = 590.49 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x207d8b9f
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns
Presolve time: 2.34s
Presolved: 141123 rows, 59550 columns, 869493 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 623
 AA' NZ     : 7.347e+06
 Factor NZ  : 1.703e+07 (roughly 200 MB of memory)
 Factor Ops : 5.391e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.81220029e+07  2.59211024e+08  1.34e+05 1.48e+01  8.62e+04     4s
   1  -1.39717342e+07  2.40298273e+08  9.46e+04 7.48e+01  6.05e+04     4s
   2  -5.55872824e+06  1.77697028e+08  3.69e+04 4.74e+00  2.53e+04     4s
   3  -1.05360613e+06  1.37505199e+08  3.01e+03 2.05e+00  2.50e+03     4s
   4  -5.77287807e+05  8.86538396e+07  8.33e+02 8.81e-01  8.46e+02     4s
   5  -4.86251808e+05  4.75121608e+07  4.20e+02 3.62e-01  4.13e+02     4s
   6  -4.08334825e+05  3.52872572e+07  1.75e+02 2.45e-01  2.27e+02     4s
   7  -3.63464806e+05  2.45329141e+07  8.14e+01 1.56e-01  1.33e+02     5s
   8  -2.64233479e+05  1.74834707e+07  1.52e+01 1.04e-01  7.47e+01     5s
   9  -1.84489508e+05  1.46080814e+07  2.77e+00 8.63e-02  5.83e+01     5s
  10  -1.32936553e+05  5.07675624e+06  1.01e+00 2.90e-02  2.03e+01     5s
  11  -8.59909589e+04  1.94076953e+06  4.11e-01 1.08e-02  7.89e+00     5s
  12  -4.69679440e+04  9.09687573e+05  1.85e-01 4.75e-03  3.72e+00     5s
  13  -1.44809893e+04  3.92610175e+05  7.38e-02 1.99e-03  1.58e+00     5s
  14   8.15986669e+03  2.86709104e+05  4.34e-02 1.49e-03  1.08e+00     5s
  15   2.09072649e+04  2.07804254e+05  3.03e-02 2.04e-03  7.26e-01     5s
  16   2.93770128e+04  1.35054047e+05  2.28e-02 1.12e-03  4.10e-01     5s
  17   3.70869216e+04  1.17201950e+05  1.73e-02 8.46e-04  3.11e-01     5s
  18   4.18244600e+04  1.05847572e+05  1.40e-02 6.70e-04  2.49e-01     5s
  19   4.34691927e+04  9.59789386e+04  1.28e-02 5.28e-04  2.04e-01     5s
  20   4.64897736e+04  9.13073723e+04  1.09e-02 4.55e-04  1.74e-01     5s
  21   4.91903008e+04  8.70172042e+04  9.26e-03 3.77e-04  1.47e-01     5s
  22   5.31921530e+04  8.35694975e+04  6.90e-03 3.13e-04  1.18e-01     6s
  23   5.60418874e+04  7.98998388e+04  5.31e-03 2.46e-04  9.27e-02     6s
  24   5.79965058e+04  7.55989360e+04  4.28e-03 1.65e-04  6.84e-02     6s
  25   6.00238469e+04  7.39430433e+04  3.25e-03 1.33e-04  5.41e-02     6s
  26   6.17859325e+04  7.19452513e+04  2.37e-03 9.54e-05  3.95e-02     6s
  27   6.23873299e+04  7.07346550e+04  2.10e-03 7.25e-05  3.24e-02     6s
  28   6.35514352e+04  6.96193283e+04  1.55e-03 4.96e-05  2.36e-02     6s
  29   6.41674183e+04  6.93355594e+04  1.28e-03 4.43e-05  2.01e-02     6s
  30   6.52019415e+04  6.85668131e+04  8.16e-04 2.84e-05  1.31e-02     6s
  31   6.57027890e+04  6.79245706e+04  6.04e-04 1.52e-05  8.63e-03     6s
  32   6.63742746e+04  6.76285136e+04  3.11e-04 8.96e-06  4.87e-03     6s
  33   6.66527628e+04  6.74653041e+04  1.88e-04 5.83e-06  3.16e-03     6s
  34   6.67916726e+04  6.73705987e+04  1.33e-04 4.05e-06  2.25e-03     7s
  35   6.68516665e+04  6.73489877e+04  1.09e-04 3.66e-06  1.93e-03     7s
  36   6.69021125e+04  6.73113449e+04  9.01e-05 2.97e-06  1.59e-03     7s
  37   6.69938893e+04  6.72763064e+04  5.37e-05 2.35e-06  1.10e-03     7s
  38   6.70613576e+04  6.72100865e+04  2.74e-05 1.39e-06  5.78e-04     7s
  39   6.70782245e+04  6.71596416e+04  2.16e-05 2.86e-07  3.16e-04     7s
  40   6.70948261e+04  6.71549912e+04  1.58e-05 2.10e-07  2.34e-04     7s
  41   6.70992082e+04  6.71539162e+04  1.42e-05 1.92e-07  2.12e-04     7s
  42   6.71198338e+04  6.71491365e+04  6.89e-06 1.18e-07  1.14e-04     7s
  43   6.71257298e+04  6.71451572e+04  4.90e-06 5.62e-08  7.55e-05     7s
  44   6.71337712e+04  6.71432278e+04  2.32e-06 2.88e-08  3.67e-05     7s
  45   6.71394024e+04  6.71425269e+04  6.50e-07 1.63e-08  1.21e-05     8s
  46   6.71411655e+04  6.71418682e+04  1.27e-07 4.04e-09  2.73e-06     8s
  47   6.71415401e+04  6.71416222e+04  2.11e-08 2.52e-10  3.19e-07     8s
  48   6.71415593e+04  6.71416161e+04  5.46e-06 2.51e-08  2.20e-07     8s
  49   6.71415932e+04  6.71416029e+04  9.60e-07 2.87e-07  3.77e-08     8s
  50   6.71416006e+04  6.71416022e+04  9.07e-07 7.23e-08  6.26e-09     8s
  51   6.71416020e+04  6.71416020e+04  9.67e-08 7.25e-08  1.42e-10     8s

Barrier solved model in 51 iterations and 8.04 seconds (16.32 work units)
Optimal objective 6.71416020e+04


Root crossover log...

  126031 DPushes remaining with DInf 0.0000000e+00                 8s
    2712 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2618 PPushes remaining with PInf 1.4082123e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2648624e-01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57357    6.7141602e+04   0.000000e+00   1.264862e-01     11s
   57361    6.7141602e+04   0.000000e+00   0.000000e+00     11s
   57361    6.7141602e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 1.39s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.714160e+04, 57361 iterations, 9.49 seconds (19.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67141.6020    0  162 -180179.68 67141.6020   137%     -   12s
H    0     0                    -174029.4543 67141.6020   139%     -   12s
H    0     0                    -111709.3406 67141.6020   160%     -   13s
H    0     0                    -110444.2484 67141.6020   161%     -   13s
H    0     0                    -60797.57310 67141.6020   210%     -   13s
H    0     0                    13415.388244 67141.6020   400%     -   13s
H    0     0                    20728.984727 67141.6020   224%     -   14s
H    0     0                    21013.513630 67141.6020   220%     -   14s
H    0     0                    21130.677434 67141.6020   218%     -   14s
H    0     0                    21149.307240 67141.6020   217%     -   14s
H    0     0                    21252.228037 67141.6020   216%     -   14s
H    0     0                    21288.144355 67141.6020   215%     -   14s
     0     0 61701.2954    0  198 21288.1444 61701.2954   190%     -   58s
H    0     0                    21310.904956 61701.2233   190%     -   59s
H    0     0                    21327.836919 61701.2233   189%     -   59s
     0     0 61233.6559    0  206 21327.8369 61233.6559   187%     -   83s
     0     0 61139.7243    0  224 21327.8369 61139.7243   187%     -   93s
     0     0 60926.2985    0  213 21327.8369 60926.2985   186%     -  105s
     0     0 60706.8766    0  212 21327.8369 60706.8766   185%     -  116s
     0     0 60516.6752    0  218 21327.8369 60516.6752   184%     -  125s
     0     0 60488.4533    0  217 21327.8369 60488.4533   184%     -  128s
     0     0 60487.2990    0  219 21327.8369 60487.2990   184%     -  129s
     0     0 60479.8690    0  222 21327.8369 60479.8690   184%     -  131s
     0     0 60479.5398    0  222 21327.8369 60479.5398   184%     -  131s
     0     0 57091.7640    0  292 21327.8369 57091.7640   168%     -  171s
H    0     0                    25027.307541 57091.7598   128%     -  172s
H    0     0                    27305.604722 57091.7598   109%     -  172s
H    0     0                    27717.101069 57091.7598   106%     -  172s
H    0     0                    28256.267320 57091.7598   102%     -  172s
     0     0 56658.0798    0  273 28256.2673 56658.0798   101%     -  194s
     0     0 56328.0359    0  303 28256.2673 56328.0359  99.3%     -  212s
     0     0 56293.1719    0  306 28256.2673 56293.1719  99.2%     -  220s
     0     0 56272.8074    0  283 28256.2673 56272.8074  99.2%     -  226s
     0     0 56252.9806    0  290 28256.2673 56252.9806  99.1%     -  233s
     0     0 56117.9364    0  306 28256.2673 56117.9364  98.6%     -  245s
     0     0 56032.7632    0  298 28256.2673 56032.7632  98.3%     -  256s
     0     0 55965.1429    0  294 28256.2673 55965.1429  98.1%     -  263s
     0     0 55961.7340    0  298 28256.2673 55961.7340  98.1%     -  265s
     0     0 55961.0363    0  303 28256.2673 55961.0363  98.0%     -  267s
     0     0 53780.0779    0  374 28256.2673 53780.0779  90.3%     -  342s
     0     0 53779.8581    0  373 28256.2673 53779.8581  90.3%     -  342s
H    0     0                    28522.997198 53779.7791  88.5%     -  343s
     0     0 53264.2825    0  335 28522.9972 53264.2825  86.7%     -  369s
     0     0 53177.5406    0  339 28522.9972 53177.5406  86.4%     -  379s
     0     0 53135.9206    0  357 28522.9972 53135.9206  86.3%     -  386s
     0     0 53100.8624    0  363 28522.9972 53100.8624  86.2%     -  392s
     0     0 53075.3087    0  346 28522.9972 53075.3087  86.1%     -  397s
     0     0 53026.6844    0  353 28522.9972 53026.6844  85.9%     -  402s
     0     0 52971.4407    0  352 28522.9972 52971.4407  85.7%     -  409s
     0     0 52948.3642    0  353 28522.9972 52948.3642  85.6%     -  414s
     0     0 52937.6195    0  360 28522.9972 52937.6195  85.6%     -  417s
     0     0 52932.4385    0  358 28522.9972 52932.4385  85.6%     -  419s
     0     0 52868.5306    0  356 28522.9972 52868.5306  85.4%     -  425s
     0     0 52782.8010    0  367 28522.9972 52782.8010  85.1%     -  434s
     0     0 52761.4291    0  373 28522.9972 52761.4291  85.0%     -  439s
     0     0 52727.8933    0  385 28522.9972 52727.8933  84.9%     -  443s
     0     0 52709.0404    0  367 28522.9972 52709.0404  84.8%     -  447s
     0     0 52698.3770    0  367 28522.9972 52698.3770  84.8%     -  449s
     0     0 52694.6332    0  371 28522.9972 52694.6332  84.7%     -  450s
     0     0 52691.9998    0  371 28522.9972 52691.9998  84.7%     -  451s
     0     0 52690.4807    0  369 28522.9972 52690.4807  84.7%     -  452s
     0     0 51668.0615    0  370 28522.9972 51668.0615  81.1%     -  483s
     0     0 51485.5738    0  385 28522.9972 51485.5738  80.5%     -  497s
     0     0 51441.2480    0  380 28522.9972 51441.2480  80.4%     -  506s
     0     0 51422.4734    0  399 28522.9972 51422.4734  80.3%     -  510s
     0     0 51413.1265    0  391 28522.9972 51413.1265  80.3%     -  513s
     0     0 51390.9096    0  390 28522.9972 51390.9096  80.2%     -  517s
     0     0 51380.0169    0  383 28522.9972 51380.0169  80.1%     -  521s
     0     0 51372.3386    0  375 28522.9972 51372.3386  80.1%     -  523s
     0     0 51370.3936    0  379 28522.9972 51370.3936  80.1%     -  524s
     0     0 51177.1594    0  392 28522.9972 51177.1594  79.4%     -  544s
     0     0 51095.7268    0  377 28522.9972 51095.7268  79.1%     -  554s
     0     0 51016.5498    0  394 28522.9972 51016.5498  78.9%     -  566s
     0     0 51000.0002    0  376 28522.9972 51000.0002  78.8%     -  572s
     0     0 50988.8889    0  386 28522.9972 50988.8889  78.8%     -  576s
     0     0 50985.0103    0  377 28522.9972 50985.0103  78.8%     -  579s
     0     0 50979.7410    0  377 28522.9972 50979.7410  78.7%     -  582s
     0     0 50964.8962    0  380 28522.9972 50964.8962  78.7%     -  585s
     0     0 50953.5582    0  375 28522.9972 50953.5582  78.6%     -  589s
     0     0 50949.9274    0  378 28522.9972 50949.9274  78.6%     -  591s
     0     0 50943.6713    0  378 28522.9972 50943.6713  78.6%     -  594s
     0     0 50942.2157    0  377 28522.9972 50942.2157  78.6%     -  595s
     0     0 50820.1161    0  371 28522.9972 50820.1161  78.2%     -  610s
     0     0 50801.7102    0  368 28522.9972 50801.7102  78.1%     -  615s
     0     0 50791.3068    0  389 28522.9972 50791.3068  78.1%     -  620s
     0     0 50789.0347    0  374 28522.9972 50789.0347  78.1%     -  622s
     0     0 50752.9869    0  374 28522.9972 50752.9869  77.9%     -  629s
     0     0 50737.8478    0  368 28522.9972 50737.8478  77.9%     -  638s
     0     0 50734.3269    0  378 28522.9972 50734.3269  77.9%     -  640s
     0     0 50722.7769    0  375 28522.9972 50722.7769  77.8%     -  646s
     0     0 50711.6435    0  373 28522.9972 50711.6435  77.8%     -  651s
     0     0 50705.0692    0  370 28522.9972 50705.0692  77.8%     -  653s
     0     0 50701.3691    0  375 28522.9972 50701.3691  77.8%     -  654s
     0     0 50700.5872    0  377 28522.9972 50700.5872  77.8%     -  655s
     0     0 50681.2645    0  381 28522.9972 50681.2645  77.7%     -  661s
     0     0 50669.7891    0  374 28522.9972 50669.7891  77.6%     -  664s
     0     0 50662.8807    0  375 28522.9972 50662.8807  77.6%     -  667s
     0     0 50659.3086    0  375 28522.9972 50659.3086  77.6%     -  670s
     0     0 50657.7467    0  386 28522.9972 50657.7467  77.6%     -  672s
     0     0 50650.7084    0  382 28522.9972 50650.7084  77.6%     -  677s
     0     0 50645.3880    0  377 28522.9972 50645.3880  77.6%     -  681s
     0     0 50642.8077    0  377 28522.9972 50642.8077  77.6%     -  683s
     0     0 50641.6362    0  389 28522.9972 50641.6362  77.5%     -  686s
     0     0 50628.5206    0  385 28522.9972 50628.5206  77.5%     -  692s
H    0     0                    29122.498314 50628.5134  73.8%     -  693s
H    0     0                    29201.377031 50628.5134  73.4%     -  693s
H    0     0                    29321.292149 50628.5134  72.7%     -  693s
H    0     0                    29389.857234 50628.5134  72.3%     -  693s
H    0     0                    29516.124422 50628.5134  71.5%     -  693s
H    0     0                    29520.630522 50628.5134  71.5%     -  693s
     0     0 50623.8403    0  433 29520.6305 50623.8403  71.5%     -  697s
     0     0 50621.8716    0  382 29520.6305 50621.8716  71.5%     -  698s
     0     0 50614.6113    0  376 29520.6305 50614.6113  71.5%     -  703s
     0     0 50610.6437    0  371 29520.6305 50610.6437  71.4%     -  707s
     0     0 50610.3149    0  376 29520.6305 50610.3149  71.4%     -  707s
     0     0 50603.8465    0  381 29520.6305 50603.8465  71.4%     -  713s
     0     0 50603.7696    0  381 29520.6305 50603.7696  71.4%     -  716s
H    0     0                    29802.701691 50603.7007  69.8%     -  874s
H    0     0                    29832.148303 50603.7007  69.6%     -  874s
     0     2 50603.7007    0  381 29832.1483 50603.7007  69.6%     -  885s
     1     4 50521.9642    1  368 29832.1483 50603.6782  69.6%  8068  902s
     3     7 50497.9618    2  371 29832.1483 50521.3185  69.4%  8949  920s
     6    13 50196.2745    3  373 29832.1483 50496.7977  69.3% 12007  941s
    12    25 50010.8343    4  366 29832.1483 50195.9368  68.3% 14264  968s
    24    37 48996.4741    5  360 29832.1483 50195.9368  68.3% 19134 1022s
    36    64 46729.6864    6  349 29832.1483 50010.7186  67.6% 17882 1138s
H   38    64                    29915.011210 50010.7186  67.2% 17368 1138s
H   40    64                    30370.949242 50010.7186  64.7% 17300 1138s
H   53    64                    30392.335921 50010.7186  64.6% 17854 1138s
    63    96 48845.5922    6  349 30392.3359 50010.7186  64.6% 24051 1181s
    95   128 48782.0790    7  353 30392.3359 50010.7186  64.6% 21858 1209s
H   96   128                    30429.247264 50010.7186  64.4% 21631 1209s
H   97   128                    30429.729066 50010.7186  64.3% 21448 1209s
H   98   128                    30502.059884 50010.7186  64.0% 21326 1209s
H  122   128                    30543.716577 50010.7186  63.7% 19166 1209s
   127   229 48690.8264    8  344 30543.7166 50010.7186  63.7% 18925 1250s
   228   307 48429.2117   11  334 30543.7166 50010.7186  63.7% 13263 1278s
   306   377 48427.1021   12  323 30543.7166 50010.7186  63.7% 11242 1302s
   376   404 47917.0801   15  327 30543.7166 50010.7186  63.7% 10370 1428s
   403   431 47781.2978   16  319 30543.7166 50010.7186  63.7% 10221 1452s
   430   467 47308.9725   17  310 30543.7166 50010.7186  63.7% 10322 1478s
   466   496 47198.7320   18  313 30543.7166 50010.7186  63.7% 10698 1500s
   495   527 46341.3474   19  311 30543.7166 50010.7186  63.7% 10762 1520s
H  514   527                    30566.506203 50010.7186  63.6% 10705 1520s
   526   624 46313.3376   20  240 30566.5062 50010.7186  63.6% 10691 1542s
   623   691 45444.7463   25  289 30566.5062 50010.7186  63.6% 10135 1563s
   692   774 44968.6302   26  288 30566.5062 50010.7186  63.6%  9985 1582s
   775   857 44757.5409   28  200 30566.5062 50010.7186  63.6%  9761 1603s
   860   887 41079.6288   29  173 30566.5062 50010.7186  63.6%  9506 1623s
   890   919 40815.9139   30  169 30566.5062 50010.7186  63.6%  9541 1643s
   922   950 40790.1018   31  175 30566.5062 50010.7186  63.6%  9521 1661s
H  931   950                    30681.436402 50010.7186  63.0%  9502 1661s
H  933   950                    30728.741530 50010.7186  62.7%  9499 1661s
   953  1030 40104.6258   32  156 30728.7415 50010.7186  62.7%  9545 1682s
  1045  1129 38155.4277   38  140 30728.7415 50010.7186  62.7%  9273 1706s
  1146  1235 36689.0589   43  161 30728.7415 50010.7186  62.7%  9045 1729s
  1260  1355 34278.8756   50  115 30728.7415 50010.7186  62.7%  8771 1753s
  1388  1455 33510.0720   58   88 30728.7415 50010.7186  62.7%  8474 1775s
  1532  1503 31720.7309   65   70 30728.7415 50010.7186  62.7%  8173 1802s
  1639  1557 42046.8905   18  298 30728.7415 50010.7186  62.7%  8077 1831s
  1756  1590 37406.1167   19  190 30728.7415 50010.7186  62.7%  8008 1863s
  1843  1634 36340.3225   21  220 30728.7415 50010.7186  62.7%  8006 1893s
  1932  1675 infeasible   24      30728.7415 50010.7186  62.7%  8035 1925s
  2027  1689     cutoff   24      30728.7415 50010.7186  62.7%  8038 1956s
H 2029  1689                    30754.463853 50010.7186  62.6%  8037 1956s
H 2041  1689                    30777.370598 50010.7186  62.5%  8091 1956s
H 2047  1689                    30798.693514 50010.7186  62.4%  8081 1956s
  2079  1762 33169.6540   22  230 30798.6935 50010.7186  62.4%  8074 1990s
  2201  1830 infeasible   25      30798.6935 50010.7186  62.4%  8023 2024s
  2331  1850 infeasible   28      30798.6935 50010.7186  62.4%  7977 2057s
H 2335  1846                    30973.888996 50010.7186  61.5%  7976 2057s
H 2356  1845                    31004.810921 50010.7186  61.3%  8012 2057s
  2371  1933 44294.5332   11  263 31004.8109 50010.7186  61.3%  8097 2093s
  2509  1999 41673.2532   13  213 31004.8109 49761.2802  60.5%  8058 2131s
  2626  2082 39897.7833   17  175 31004.8109 49761.2802  60.5%  8121 2171s
  2735  2112 38422.0889   20  157 31004.8109 49761.2802  60.5%  8181 2211s
  2767  2143 35169.0112   20  137 31004.8109 49761.2802  60.5%  8330 2244s
  2800  2176 37122.8111   18  200 31004.8109 49761.2802  60.5%  8417 2274s
H 2808  2174                    31032.686249 49761.2802  60.4%  8449 2274s
H 2828  2172                    31074.968068 49761.2802  60.1%  8481 2274s
  2847  2264 37889.1179   21  135 31074.9681 49761.2802  60.1%  8481 2316s
  2968  2364 37529.6206   24  116 31074.9681 49761.2802  60.1%  8562 2359s
  3094  2494 36593.8136   33  107 31074.9681 48825.8521  57.1%  8699 2402s
  3263  2659 35643.8495   49   72 31074.9681 48825.8521  57.1%  8725 2449s
  3476  2660 33242.1910   38  381 31074.9681 48787.0679  57.0%  8642 2769s
  3478  2661 46044.8275    8  123 31074.9681 48787.0679  57.0%  8637 2785s
  3479  2662 39279.5493   22  263 31074.9681 48787.0679  57.0%  8634 2864s
  3480  2663 37048.0361   54  328 31074.9681 48787.0679  57.0%  8632 2937s
  3481  2663 42428.0237   29  366 31074.9681 48787.0679  57.0%  8629 2999s
  3482  2664 44334.1631   26  362 31074.9681 48787.0679  57.0%  8627 3026s
  3483  2665 33704.0534   39  357 31074.9681 48787.0679  57.0%  8624 3051s
  3484  2665 47933.1688    8  356 31074.9681 48787.0679  57.0%  8622 3065s
  3485  2666 31411.8617   37  397 31074.9681 48787.0679  57.0%  8619 3082s
  3486  2667 46167.0763   13  374 31074.9681 48787.0679  57.0%  8617 3095s
  3487  2667 36563.5796   71  374 31074.9681 48787.0679  57.0%  8614 3108s
  3488  2668 37576.9561   42  369 31074.9681 48787.0679  57.0%  8612 3119s
  3489  2669 37457.6996   30  373 31074.9681 48787.0679  57.0%  8609 3130s
  3490  2669 31853.8841   28  368 31074.9681 48787.0679  57.0%  8607 3140s
  3491  2670 41248.4258   16  368 31074.9681 48787.0679  57.0%  8604 3147s
H 3491  2536                    31098.482856 48787.0679  56.9%  8604 3155s
  3493  2537 43336.9962   25  379 31098.4829 48787.0679  56.9%  8600 3162s
  3494  2538 39082.2117   32  381 31098.4829 48787.0679  56.9%  8597 3168s
  3495  2539 43797.7206   21  379 31098.4829 48787.0679  56.9%  8595 3175s
  3496  2539 44860.1506   10  374 31098.4829 48787.0679  56.9%  8592 3200s
  3497  2540 46009.9489    9  375 31098.4829 48787.0679  56.9%  8590 3216s
  3498  2541 47378.4491   12  373 31098.4829 48787.0679  56.9%  8587 3225s
  3499  2541 46793.0777    7  380 31098.4829 48787.0679  56.9%  8585 3232s
  3500  2542 41662.5384   33  415 31098.4829 48787.0679  56.9%  8582 3249s
  3501  2543 32493.2044   69  385 31098.4829 48787.0679  56.9%  8580 3256s
  3502  2543 33340.6776   30  384 31098.4829 48787.0679  56.9%  8577 3262s
  3503  2544 32021.4011   82  389 31098.4829 48787.0679  56.9%  8575 3269s
  3504  2545 42429.1043   30  389 31098.4829 48787.0679  56.9%  8573 3286s
  3505  2545 33991.4409   71  448 31098.4829 48787.0679  56.9%  8570 3303s
  3506  2546 33677.3412   40  384 31098.4829 48787.0679  56.9%  8568 3316s
  3507  2547 44879.1910   21  425 31098.4829 48787.0679  56.9%  8565 3325s
  3508  2547 46324.8060   16  423 31098.4829 48787.0679  56.9%  8563 3330s
  3510  2549 36284.8025   22  390 31098.4829 48787.0679  56.9%  8558 3339s
  3511  2549 38400.9014   37  385 31098.4829 48787.0679  56.9%  8555 3354s
  3512  2550 44764.4416   18  389 31098.4829 48787.0679  56.9%  8553 3363s
  3513  2551 31674.6547   49  402 31098.4829 48787.0679  56.9%  8551 3370s
  3514  2551 44097.5867   11  435 31098.4829 48787.0679  56.9%  8548 3377s
  3515  2552 46070.8028    9  434 31098.4829 48787.0679  56.9%  8546 3381s
  3516  2553 40812.2572   34  443 31098.4829 48787.0679  56.9%  8543 3411s
H 3516  2424                    31108.014753 48787.0679  56.8%  8543 3425s
  3518  2425 31287.1788   34  529 31108.0148 48787.0679  56.8%  8538 3432s
  3519  2426 41472.2643   16  482 31108.0148 48787.0679  56.8%  8536 3447s
  3520  2426 39160.1512   19  449 31108.0148 48787.0679  56.8%  8534 3453s
  3521  2427 36398.2864   30  417 31108.0148 48787.0679  56.8%  8531 3458s
  3522  2428 33416.8799   52  458 31108.0148 48787.0679  56.8%  8529 3474s
  3523  2428 32248.3808   63  446 31108.0148 48787.0679  56.8%  8526 3481s
  3524  2429 37204.9038   35  452 31108.0148 48787.0679  56.8%  8524 3487s
  3525  2430 36288.8901   22  425 31108.0148 48787.0679  56.8%  8521 3495s
  3526  2430 34120.7453   38  423 31108.0148 48787.0679  56.8%  8519 3500s
  3527  2431 36675.0680   34  411 31108.0148 48787.0679  56.8%  8517 3516s
  3528  2432 37267.6124   63  449 31108.0148 48787.0679  56.8%  8514 3522s
  3529  2432 41246.5712   18  441 31108.0148 48787.0679  56.8%  8512 3533s
  3530  2433 33042.8177   23  433 31108.0148 48787.0679  56.8%  8509 3538s
  3531  2434 32298.7124   81  393 31108.0148 48787.0679  56.8%  8507 3546s
  3532  2434 32449.1021   57  400 31108.0148 48787.0679  56.8%  8505 3550s
  3533  2435 35820.9546   45  395 31108.0148 48787.0679  56.8%  8502 3555s
  3534  2436 36885.6679   20  396 31108.0148 48787.0679  56.8%  8500 3563s
  3535  2436 36262.8175   63  396 31108.0148 48787.0679  56.8%  8497 3578s

Cutting planes:
  Gomory: 10
  Implied bound: 5
  Projected implied bound: 63
  MIR: 835
  Mixing: 2
  Flow cover: 822
  RLT: 9
  Relax-and-lift: 192

Explored 3535 nodes (31290616 simplex iterations) in 3600.02 seconds (8859.36 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 31108 31098.5 31075 ... 30728.7

Time limit reached
Best objective 3.110801475349e+04, best bound 4.878706788850e+04, gap 56.8312%
  WARNING: Time limit reached. Using best solution found (gap: 56.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 31108.01, θ = 183802.55
  Upper Bound (UB) = 31108.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183802.55
  [DEBUG]   ✓ Scenario 0: θ = 183802.55 ≤ Q = 183802.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183802.55 ≤ Q = 183802.55 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x406ea368
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x406ea368
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.404204e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6892227.3362
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.555999e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155599.87    0  124 6892227.34 -155599.87   102%     -    0s
H    0     0                    -121006.2764 -155599.87  28.6%     -    0s
H    0     0                    -122129.8541 -155599.87  27.4%     -    0s
     0     0 -130588.13    0  100 -122129.85 -130588.13  6.93%     -    0s
H    0     0                    -126245.1040 -130465.26  3.34%     -    0s
H    0     0                    -126509.7141 -130465.26  3.13%     -    0s
H    0     0                    -126833.3941 -130465.26  2.86%     -    0s
H    0     0                    -127098.0042 -130465.26  2.65%     -    0s
     0     0 -128952.00    0  102 -127098.00 -128952.00  1.46%     -    0s
H    0     0                    -127185.0988 -128625.51  1.13%     -    0s
     0     0 -128625.51    0   88 -127185.10 -128625.51  1.13%     -    0s
     0     0 -128611.00    0   88 -127185.10 -128611.00  1.12%     -    0s
     0     0 -128514.07    0   89 -127185.10 -128514.07  1.04%     -    0s
     0     0 -128500.39    0   89 -127185.10 -128500.39  1.03%     -    0s
     0     2 -128500.39    0   89 -127185.10 -128500.39  1.03%     -    0s
H   40    59                    -127230.5915 -128091.73  0.68%  17.1    0s
H   43    55                    -127846.3344 -128047.44  0.16%  16.0    0s
H   48    53                    -127908.2842 -128047.44  0.11%  14.9    0s
H  105    14                    -127921.0754 -128004.68  0.07%  11.3    0s
*  140    10              14    -127944.2231 -127987.21  0.03%   9.9    0s
*  141    10              14    -127954.9232 -127987.21  0.03%   9.8    0s
*  171     0              15    -127957.0143 -127967.99  0.01%   9.0    0s

Cutting planes:
  Gomory: 54
  Implied bound: 3
  MIR: 177
  Flow cover: 7
  RLT: 4
  BQP: 1

Explored 178 nodes (2111 simplex iterations) in 0.07 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -127957 -127955 -127944 ... -126833
No other solutions better than -127957

Optimal solution found (tolerance 1.00e-04)
Best objective -1.279570142574e+05, best bound -1.279570142574e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 180030.63
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127957.01
  [DEBUG]   S×d_nominal = 307987.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307987.65 + -127957.01 = 180030.63
  [DEBUG]   Current θ from Master = 183802.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3771.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 27336.10
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 745.2022, Absolute Gap = 745.2022, Relative Gap = 0.023955
  Not converged yet (gap = 745.20 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0x28b3f1d6
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns
Presolve time: 2.53s
Presolved: 149343 rows, 62920 columns, 919976 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.45s

Barrier statistics:
 Dense cols : 622
 AA' NZ     : 8.148e+06
 Factor NZ  : 1.825e+07 (roughly 230 MB of memory)
 Factor Ops : 4.562e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85479500e+07  2.72491129e+08  1.37e+05 1.44e+01  8.78e+04     4s
   1  -1.43388071e+07  2.53266425e+08  9.71e+04 7.47e+01  6.17e+04     5s
   2  -5.90983623e+06  1.87445636e+08  3.92e+04 5.04e+00  2.67e+04     5s
   3  -2.41434966e+06  1.54100705e+08  1.14e+04 1.73e+00  8.06e+03     5s
   4  -7.91221499e+05  1.16903737e+08  1.14e+03 6.30e-01  1.15e+03     5s
   5  -5.67335930e+05  9.51672016e+07  8.00e+02 4.79e-01  8.35e+02     5s
   6  -4.77254233e+05  5.40739230e+07  3.96e+02 2.17e-01  4.20e+02     5s
   7  -3.74244489e+05  4.12593785e+07  1.06e+02 1.54e-01  2.08e+02     5s
   8  -3.42992750e+05  2.58957879e+07  5.27e+01 8.92e-02  1.19e+02     5s
   9  -2.45592675e+05  2.08576781e+07  5.72e+00 7.01e-02  7.96e+01     5s
  10  -1.39980515e+05  9.44037093e+06  1.09e+00 3.10e-02  3.54e+01     5s
  11  -1.01982545e+05  3.40775949e+06  5.89e-01 1.10e-02  1.29e+01     5s
  12  -6.98682162e+04  1.07643971e+06  2.79e-01 3.40e-03  4.21e+00     5s
  13  -3.69483485e+04  5.63902696e+05  1.48e-01 1.62e-03  2.21e+00     5s
  14  -1.14968007e+04  3.25510554e+05  8.14e-02 1.09e-03  1.24e+00     5s
  15   9.92911253e+03  2.33283421e+05  4.70e-02 1.11e-03  8.20e-01     5s
  16   2.57838055e+04  1.73252932e+05  3.04e-02 1.28e-03  5.41e-01     6s
  17   3.22094195e+04  1.40732583e+05  2.42e-02 9.04e-04  3.98e-01     6s
  18   3.90925771e+04  1.18830636e+05  1.84e-02 6.53e-04  2.93e-01     6s
  19   4.34764600e+04  1.05177433e+05  1.48e-02 5.02e-04  2.27e-01     6s
  20   4.66872266e+04  9.40414973e+04  1.25e-02 3.62e-04  1.74e-01     6s
  21   5.11668061e+04  8.77017509e+04  9.29e-03 2.86e-04  1.34e-01     6s
  22   5.45600728e+04  8.17138166e+04  7.03e-03 3.15e-04  9.97e-02     6s
  23   5.84825604e+04  7.72689817e+04  4.58e-03 2.21e-04  6.90e-02     6s
  24   6.01209737e+04  7.39994647e+04  3.62e-03 1.48e-04  5.10e-02     6s
  25   6.16639765e+04  7.29865574e+04  2.78e-03 1.27e-04  4.16e-02     6s
  26   6.27931312e+04  7.12787249e+04  2.17e-03 8.97e-05  3.12e-02     6s
  27   6.41382709e+04  7.01021565e+04  1.47e-03 6.38e-05  2.19e-02     7s
  28   6.50011212e+04  6.98259094e+04  1.03e-03 5.85e-05  1.77e-02     7s
  29   6.58705252e+04  6.85679126e+04  5.90e-04 3.11e-05  9.90e-03     7s
  30   6.63368125e+04  6.78027269e+04  3.71e-04 1.42e-05  5.38e-03     7s
  31   6.64979212e+04  6.77279460e+04  2.97e-04 1.25e-05  4.52e-03     7s
  32   6.67459061e+04  6.74830528e+04  1.78e-04 7.15e-06  2.71e-03     7s
  33   6.68306540e+04  6.73927620e+04  1.39e-04 5.18e-06  2.06e-03     7s
  34   6.68704079e+04  6.73735884e+04  1.20e-04 4.77e-06  1.85e-03     7s
  35   6.69161201e+04  6.72661814e+04  9.87e-05 2.54e-06  1.29e-03     7s
  36   6.69924433e+04  6.71952006e+04  6.29e-05 1.07e-06  7.45e-04     7s
  37   6.70330903e+04  6.71899642e+04  4.51e-05 9.69e-07  5.76e-04     7s
  38   6.70710978e+04  6.71669024e+04  2.78e-05 5.10e-07  3.52e-04     7s
  39   6.70865623e+04  6.71601119e+04  2.14e-05 3.77e-07  2.70e-04     8s
  40   6.70914757e+04  6.71574748e+04  1.93e-05 3.26e-07  2.42e-04     8s
  41   6.71089985e+04  6.71514793e+04  1.25e-05 2.05e-07  1.56e-04     8s
  42   6.71146215e+04  6.71469446e+04  1.03e-05 8.21e-07  1.19e-04     8s
  43   6.71242532e+04  6.71453693e+04  6.55e-06 5.89e-07  7.76e-05     8s
  44   6.71373108e+04  6.71433205e+04  1.23e-06 3.70e-07  2.21e-05     8s
  45   6.71389979e+04  6.71415905e+04  5.82e-07 1.12e-07  9.52e-06     8s
  46   6.71401481e+04  6.71409421e+04  1.86e-07 1.82e-08  2.92e-06     8s
  47   6.71406721e+04  6.71408371e+04  3.23e-08 5.10e-09  6.06e-07     8s
  48   6.71407747e+04  6.71407937e+04  7.63e-08 1.67e-07  6.99e-08     8s
  49   6.71407916e+04  6.71407923e+04  2.28e-08 5.45e-08  2.37e-09     8s

Barrier solved model in 49 iterations and 8.42 seconds (15.91 work units)
Optimal objective 6.71407916e+04


Root crossover log...

  133751 DPushes remaining with DInf 0.0000000e+00                 8s
   36640 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   24692 PPushes remaining with PInf 1.2456667e-04                14s
    1216 PPushes remaining with PInf 1.2325419e-04                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.2789968e+04     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   97007    6.7140792e+04   0.000000e+00   4.278997e+04     15s
   98190    6.7140792e+04   0.000000e+00   0.000000e+00     16s
   98190    6.7140792e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 3.82s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.714079e+04, 98190 iterations, 17.08 seconds (31.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67140.7922    0  159 -180179.68 67140.7922   137%     -   20s
H    0     0                    -67194.70253 67140.7922   200%     -   21s
H    0     0                    17312.843505 67140.7922   288%     -   21s
H    0     0                    20014.794863 67140.7922   235%     -   22s
H    0     0                    20221.431768 67140.7922   232%     -   22s
H    0     0                    20264.300414 67140.7922   231%     -   22s
H    0     0                    20310.535308 67140.7922   231%     -   22s
H    0     0                    20358.357421 67140.7922   230%     -   22s
H    0     0                    20359.981730 67140.7922   230%     -   22s
     0     0 61784.7349    0  194 20359.9817 61784.7349   203%     -   66s
     0     0 61550.9513    0  203 20359.9817 61550.9513   202%     -   81s
     0     0 61449.8836    0  209 20359.9817 61449.8836   202%     -   89s
     0     0 61023.6383    0  216 20359.9817 61023.6383   200%     -  103s
     0     0 60989.3289    0  216 20359.9817 60989.3289   200%     -  107s
     0     0 60903.9159    0  224 20359.9817 60903.9159   199%     -  113s
     0     0 60897.0708    0  226 20359.9817 60897.0708   199%     -  115s
     0     0 60890.2235    0  222 20359.9817 60890.2235   199%     -  116s
     0     0 60745.9823    0  211 20359.9817 60745.9823   198%     -  124s
     0     0 60745.7577    0  213 20359.9817 60745.7577   198%     -  125s
     0     0 57484.5182    0  289 20359.9817 57484.5182   182%     -  170s
     0     0 57484.1419    0  281 20359.9817 57484.1419   182%     -  171s
H    0     0                    25605.511317 57484.0602   124%     -  171s
H    0     0                    26013.696120 57484.0602   121%     -  171s
H    0     0                    26174.729791 57484.0602   120%     -  171s
     0     0 56901.1266    0  285 26174.7298 56901.1266   117%     -  192s
     0     0 56838.9231    0  280 26174.7298 56838.9231   117%     -  200s
     0     0 56804.7460    0  274 26174.7298 56804.7460   117%     -  205s
     0     0 56794.1650    0  286 26174.7298 56794.1650   117%     -  208s
     0     0 56763.0182    0  277 26174.7298 56763.0182   117%     -  211s
     0     0 56676.1617    0  280 26174.7298 56676.1617   117%     -  220s
     0     0 56507.3339    0  300 26174.7298 56507.3339   116%     -  232s
     0     0 56463.4820    0  282 26174.7298 56463.4820   116%     -  238s
     0     0 56459.3888    0  286 26174.7298 56459.3888   116%     -  240s
     0     0 56458.9397    0  282 26174.7298 56458.9397   116%     -  241s
     0     0 54302.7820    0  299 26174.7298 54302.7820   107%     -  311s
     0     0 53871.4145    0  328 26174.7298 53871.4145   106%     -  337s
     0     0 53733.3275    0  338 26174.7298 53733.3275   105%     -  349s
     0     0 53634.6346    0  326 26174.7298 53634.6346   105%     -  360s
     0     0 53597.8546    0  360 26174.7298 53597.8546   105%     -  366s
     0     0 53550.9092    0  373 26174.7298 53550.9092   105%     -  374s
     0     0 53535.4051    0  363 26174.7298 53535.4051   105%     -  378s
     0     0 53521.6930    0  364 26174.7298 53521.6930   104%     -  382s
     0     0 53507.7196    0  379 26174.7298 53507.7196   104%     -  386s
     0     0 53487.7881    0  367 26174.7298 53487.7881   104%     -  390s
     0     0 53476.0922    0  368 26174.7298 53476.0922   104%     -  394s
     0     0 53475.1556    0  368 26174.7298 53475.1556   104%     -  397s
     0     0 52585.1597    0  343 26174.7298 52585.1597   101%     -  446s
H    0     0                    28010.773922 52584.7550  87.7%     -  446s
H    0     0                    28280.769199 52584.7550  85.9%     -  446s
H    0     0                    28534.308086 52584.7550  84.3%     -  446s
H    0     0                    28576.509644 52584.7550  84.0%     -  446s
H    0     0                    28621.330402 52584.7550  83.7%     -  446s
     0     0 52147.2448    0  351 28621.3304 52147.2448  82.2%     -  467s
     0     0 51969.3967    0  372 28621.3304 51969.3967  81.6%     -  480s
     0     0 51863.5124    0  361 28621.3304 51863.5124  81.2%     -  491s
     0     0 51846.6583    0  368 28621.3304 51846.6583  81.1%     -  496s
     0     0 51828.3565    0  359 28621.3304 51828.3565  81.1%     -  500s
     0     0 51809.8490    0  362 28621.3304 51809.8490  81.0%     -  506s
     0     0 51778.1734    0  360 28621.3304 51778.1734  80.9%     -  514s
     0     0 51765.8830    0  364 28621.3304 51765.8830  80.9%     -  518s
     0     0 51759.4645    0  370 28621.3304 51759.4645  80.8%     -  521s
     0     0 51742.4568    0  374 28621.3304 51742.4568  80.8%     -  526s
     0     0 51732.8413    0  375 28621.3304 51732.8413  80.7%     -  529s
     0     0 51726.3985    0  377 28621.3304 51726.3985  80.7%     -  532s
     0     0 51719.7789    0  376 28621.3304 51719.7789  80.7%     -  535s
     0     0 51718.3814    0  380 28621.3304 51718.3814  80.7%     -  536s
     0     0 51292.2650    0  380 28621.3304 51292.2650  79.2%     -  563s
H    0     0                    28646.736135 51292.2328  79.1%     -  564s
H    0     0                    28653.630583 51292.2328  79.0%     -  564s
H    0     0                    28672.845849 51292.2328  78.9%     -  564s
     0     0 51162.2373    0  378 28672.8458 51162.2373  78.4%     -  577s
     0     0 51141.8191    0  386 28672.8458 51141.8191  78.4%     -  585s
     0     0 51115.4260    0  391 28672.8458 51115.4260  78.3%     -  594s
     0     0 51102.6066    0  381 28672.8458 51102.6066  78.2%     -  600s
     0     0 51099.3152    0  379 28672.8458 51099.3152  78.2%     -  603s
     0     0 51093.4210    0  386 28672.8458 51093.4210  78.2%     -  607s
     0     0 51077.7204    0  379 28672.8458 51077.7204  78.1%     -  614s
     0     0 51070.5244    0  390 28672.8458 51070.5244  78.1%     -  617s
     0     0 51068.9979    0  389 28672.8458 51068.9979  78.1%     -  619s
     0     0 50955.1137    0  407 28672.8458 50955.1137  77.7%     -  634s
H    0     0                    28796.325312 50954.6163  76.9%     -  637s
     0     0 50861.0336    0  405 28796.3253 50861.0336  76.6%     -  653s
     0     0 50839.6760    0  447 28796.3253 50839.6760  76.5%     -  661s
     0     0 50833.0598    0  446 28796.3253 50833.0598  76.5%     -  665s
     0     0 50831.3254    0  438 28796.3253 50831.3254  76.5%     -  668s
     0     0 50760.5381    0  393 28796.3253 50760.5381  76.3%     -  679s
H    0     0                    28801.141490 50759.4583  76.2%     -  680s
     0     0 50713.8710    0  384 28801.1415 50713.8710  76.1%     -  687s
     0     0 50706.8808    0  393 28801.1415 50706.8808  76.1%     -  692s
     0     0 50686.9963    0  390 28801.1415 50686.9963  76.0%     -  697s
     0     0 50678.7214    0  392 28801.1415 50678.7214  76.0%     -  699s
     0     0 50676.8753    0  397 28801.1415 50676.8753  76.0%     -  701s
     0     0 50638.5350    0  410 28801.1415 50638.5350  75.8%     -  711s
     0     0 50624.6743    0  387 28801.1415 50624.6743  75.8%     -  717s
     0     0 50615.2379    0  407 28801.1415 50615.2379  75.7%     -  722s
     0     0 50609.0857    0  400 28801.1415 50609.0857  75.7%     -  724s
     0     0 50606.4670    0  405 28801.1415 50606.4670  75.7%     -  726s
     0     0 50605.5743    0  392 28801.1415 50605.5743  75.7%     -  727s
     0     0 50597.4894    0  422 28801.1415 50597.4894  75.7%     -  733s
     0     0 50595.0695    0  403 28801.1415 50595.0695  75.7%     -  737s
     0     0 50594.9070    0  411 28801.1415 50594.9070  75.7%     -  739s
     0     0 50585.3913    0  389 28801.1415 50585.3913  75.6%     -  743s
     0     0 50582.5213    0  394 28801.1415 50582.5213  75.6%     -  748s
     0     0 50579.5062    0  409 28801.1415 50579.5062  75.6%     -  752s
     0     0 50578.7686    0  409 28801.1415 50578.7686  75.6%     -  753s
     0     0 50572.0449    0  394 28801.1415 50572.0449  75.6%     -  758s
     0     0 50565.4637    0  389 28801.1415 50565.4637  75.6%     -  762s
     0     0 50562.3375    0  389 28801.1415 50562.3375  75.6%     -  766s
     0     0 50562.0842    0  393 28801.1415 50562.0842  75.6%     -  767s
     0     0 50531.5459    0  379 28801.1415 50531.5459  75.4%     -  774s
H    0     0                    29229.100195 50531.2445  72.9%     -  792s
H    0     0                    29240.132789 50531.2445  72.8%     -  799s
H    0     0                    29317.500497 50531.2445  72.4%     -  799s
     0     0 50525.7712    0  389 29317.5005 50525.7712  72.3%     -  801s
     0     0 50522.1542    0  390 29317.5005 50522.1542  72.3%     -  804s
     0     0 50520.9624    0  394 29317.5005 50520.9624  72.3%     -  805s
     0     0 50506.6130    0  398 29317.5005 50506.6130  72.3%     -  811s
H    0     0                    29342.613529 50505.9904  72.1%     -  812s
     0     0 50487.3304    0  440 29342.6135 50487.3304  72.1%     -  816s
     0     0 50485.2403    0  403 29342.6135 50485.2403  72.1%     -  817s
     0     0 50477.0500    0  441 29342.6135 50477.0500  72.0%     -  821s
     0     0 50473.7901    0  435 29342.6135 50473.7901  72.0%     -  823s
     0     0 50472.7459    0  404 29342.6135 50472.7459  72.0%     -  824s
     0     0 50448.9987    0  435 29342.6135 50448.9987  71.9%     -  831s
     0     0 50446.8299    0  438 29342.6135 50446.8299  71.9%     -  833s
     0     0 50444.7024    0  408 29342.6135 50444.7024  71.9%     -  836s
     0     0 50443.5309    0  408 29342.6135 50443.5309  71.9%     -  838s
     0     0 50441.0517    0  393 29342.6135 50441.0517  71.9%     -  842s
     0     0 50439.2371    0  401 29342.6135 50439.2371  71.9%     -  844s
     0     0 50438.5619    0  399 29342.6135 50438.5619  71.9%     -  846s
     0     0 50438.4693    0  399 29342.6135 50438.4693  71.9%     -  850s
H    0     0                    29730.911283 50438.4323  69.6%     -  999s
H    0     0                    29734.904241 50438.4323  69.6%     - 1002s
H    0     0                    29735.526564 50438.4323  69.6%     - 1002s
H    0     0                    29822.758729 50438.4323  69.1%     - 1030s
     0     2 50438.4323    0  399 29822.7587 50438.4323  69.1%     - 1031s
     1     3 50186.0612    1  371 29822.7587 50437.1550  69.1% 12040 1044s
     2     4 50362.5395    1  386 29822.7587 50362.5395  68.9%  8898 1052s
     3     5 49084.5448    2  451 29822.7587 50360.9659  68.9% 11278 1067s
     4     8 50138.6378    2  448 29822.7587 50359.9411  68.9% 10804 1086s
     7    16 49995.1266    3  451 29822.7587 50137.9372  68.1% 11613 1112s
    15    32 49955.5244    4  430 29822.7587 50044.5590  67.8% 12558 1140s
    31    48 49167.7654    5  395 29822.7587 50001.2456  67.7% 18836 2787s
    47    79 47562.5852    6  381 29822.7587 50001.2456  67.7% 25366 2841s
H   52    79                    30413.558551 50001.2456  64.4% 24421 2841s
    78   164 47407.1619    7  373 30413.5586 50001.2456  64.4% 19955 2993s
   163   272 47248.1562   10  366 30413.5586 50001.2456  64.4% 13546 3044s
H  224   272                    30421.080588 50001.2456  64.4% 11332 3044s
   271   342 45936.0082   14  342 30421.0806 50001.2456  64.4% 10548 3082s
   341   395 45730.8545   15  347 30421.0806 50001.2456  64.4% 10228 3133s
   394   452 45522.8192   16  342 30421.0806 50001.2456  64.4%  9826 3167s
   451   481 45377.0755   18  340 30421.0806 50001.2456  64.4%  9964 3218s
   480   508 45328.6529   19  339 30421.0806 50001.2456  64.4%  9809 3306s
   507   541 45311.1706   20  339 30421.0806 50001.2456  64.4%  9663 3375s
   540   575 45291.7191   21  335 30421.0806 50001.2456  64.4%  9479 3416s
   574   612 44030.5877   22  307 30421.0806 50001.2456  64.4%  9516 3447s
   611   653 43699.6558   23  293 30421.0806 50001.2456  64.4%  9447 3474s
   652   694 43694.8743   24  282 30421.0806 50001.2456  64.4%  9440 3500s
H  663   694                    30459.760297 50001.2456  64.2%  9403 3500s
H  672   694                    30460.084462 50001.2456  64.2%  9380 3500s
H  691   694                    30684.133800 50001.2456  63.0%  9366 3500s
   693   778 43133.2206   25  281 30684.1338 50001.2456  63.0%  9374 3535s
   781   860 36409.3916   28  217 30684.1338 50001.2456  63.0%  9438 3566s
   873   952 31834.3398   29  175 30684.1338 50001.2456  63.0%  9422 3598s
   973   951 45127.9552   31  366 30684.1338 50001.2456  63.0%  9283 3600s

Cutting planes:
  Gomory: 20
  Implied bound: 95
  MIR: 3696
  Flow cover: 3322
  RLT: 49
  Relax-and-lift: 445
  BQP: 1

Explored 976 nodes (9843096 simplex iterations) in 3600.08 seconds (7070.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 30684.1 30460.1 30459.8 ... 29342.6

Time limit reached
Best objective 3.068413379987e+04, best bound 5.000124562252e+04, gap 62.9547%
  WARNING: Time limit reached. Using best solution found (gap: 62.95%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 30684.13, θ = 183923.55
  Upper Bound (UB) = 30684.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183923.55
  [DEBUG]   ✓ Scenario 0: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183923.55 ≤ Q = 183923.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183923.55 ≤ Q = 183923.55 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1332d6e4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeccd291c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.414405e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6937223.9383
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.552508e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155250.80    0  128 6937223.94 -155250.80   102%     -    0s
H    0     0                    -118356.0288 -155250.80  31.2%     -    0s
H    0     0                    -119770.9271 -155250.80  29.6%     -    0s
     0     0 -132696.14    0   65 -119770.93 -132696.14  10.8%     -    0s
H    0     0                    -129951.3281 -132575.53  2.02%     -    0s
     0     0 -132575.53    0   54 -129951.33 -132575.53  2.02%     -    0s
     0     0 -132573.78    0   63 -129951.33 -132573.78  2.02%     -    0s
     0     0 -131747.58    0   45 -129951.33 -131747.58  1.38%     -    0s
H    0     0                    -131165.1318 -131700.43  0.41%     -    0s
     0     0 -131589.57    0   54 -131165.13 -131589.57  0.32%     -    0s
     0     0 -131562.69    0   60 -131165.13 -131562.69  0.30%     -    0s
     0     0 -131362.51    0   16 -131165.13 -131362.51  0.15%     -    0s
     0     0 -131356.44    0   13 -131165.13 -131356.44  0.15%     -    0s
     0     0 -131320.18    0   13 -131165.13 -131320.18  0.12%     -    0s
     0     0 -131283.90    0    7 -131165.13 -131283.90  0.09%     -    0s
H    0     0                    -131204.4223 -131283.90  0.06%     -    0s
     0     0 -131256.06    0    7 -131204.42 -131256.06  0.04%     -    0s
     0     0 -131256.06    0    8 -131204.42 -131256.06  0.04%     -    0s
H    0     0                    -131240.0654 -131256.06  0.01%     -    0s
     0     0          -    0      -131240.07 -131251.72  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  Clique: 1
  MIR: 3
  Flow cover: 4
  RLT: 4

Explored 1 nodes (633 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -131240 -131204 -131165 ... 1.4144e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.312400653923e+05, best bound -1.312517171725e+05, gap 0.0089%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 175938.71
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131240.07
  [DEBUG]   S×d_nominal = 307178.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307178.78 + -131240.07 = 175938.71
  [DEBUG]   Current θ from Master = 183923.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7984.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22699.30
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 321.3213, Absolute Gap = 321.3213, Relative Gap = 0.010472
  Not converged yet (gap = 321.32 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x452c971e
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns
Presolve time: 2.87s
Presolved: 157563 rows, 66290 columns, 969673 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.47s

Barrier statistics:
 Dense cols : 625
 AA' NZ     : 8.883e+06
 Factor NZ  : 1.992e+07 (roughly 250 MB of memory)
 Factor Ops : 5.161e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89687502e+07  2.85561695e+08  1.40e+05 1.41e+01  8.94e+04     5s
   1  -1.46951507e+07  2.66156589e+08  9.92e+04 7.49e+01  6.28e+04     5s
   2  -6.26681043e+06  1.97376933e+08  4.14e+04 7.33e+00  2.80e+04     5s
   3  -2.00933356e+06  1.64767419e+08  8.67e+03 1.58e+00  6.20e+03     5s
   4  -7.80389222e+05  1.28387945e+08  1.16e+03 8.01e-01  1.17e+03     5s
   5  -5.47867012e+05  9.99510905e+07  5.70e+02 5.66e-01  6.88e+02     5s
   6  -4.83712770e+05  6.23837587e+07  3.74e+02 3.20e-01  4.20e+02     5s
   7  -3.88906459e+05  4.81977683e+07  1.10e+02 2.37e-01  2.25e+02     5s
   8  -3.55599351e+05  3.02012721e+07  4.20e+01 1.40e-01  1.24e+02     6s
   9  -2.73090195e+05  2.29265479e+07  3.92e+00 1.03e-01  8.21e+01     6s
  10  -1.57329567e+05  7.62955504e+06  3.81e-01 3.22e-02  2.72e+01     6s
  11  -1.02263745e+05  3.18545898e+06  2.12e-01 1.34e-02  1.15e+01     6s
  12  -7.66355178e+04  2.05343476e+06  1.23e-01 8.61e-03  7.42e+00     6s
  13  -5.18653229e+04  1.29520814e+06  6.62e-02 5.29e-03  4.69e+00     6s
  14  -2.21515569e+04  5.03960291e+05  2.99e-02 1.91e-03  1.83e+00     6s
  15   2.49476451e+03  3.52543080e+05  1.75e-02 1.31e-03  1.22e+00     6s
  16   2.31569995e+04  2.41760269e+05  1.03e-02 8.37e-04  7.61e-01     6s
  17   3.23007191e+04  1.68990419e+05  7.37e-03 5.66e-04  4.76e-01     6s
  18   3.84855259e+04  1.49983473e+05  5.55e-03 4.89e-04  3.88e-01     6s
  19   4.27220294e+04  1.30452728e+05  4.43e-03 3.78e-04  3.05e-01     6s
  20   4.52803473e+04  1.13482314e+05  3.81e-03 2.94e-04  2.37e-01     7s
  21   4.99601073e+04  1.00226106e+05  2.75e-03 2.86e-04  1.75e-01     7s
  22   5.42650933e+04  9.02961241e+04  1.89e-03 2.03e-04  1.25e-01     7s
  23   5.67355929e+04  8.53619450e+04  1.45e-03 1.61e-04  9.96e-02     7s
  24   5.97093857e+04  8.10996278e+04  9.57e-04 1.27e-04  7.44e-02     7s
  25   6.15055358e+04  7.55703098e+04  6.87e-04 7.76e-05  4.90e-02     7s
  26   6.25502023e+04  7.41711844e+04  5.45e-04 6.57e-05  4.04e-02     7s
  27   6.39717882e+04  7.14595373e+04  3.49e-04 4.11e-05  2.61e-02     7s
  28   6.52305101e+04  6.92985069e+04  1.90e-04 2.12e-05  1.42e-02     7s
  29   6.53883758e+04  6.83067915e+04  1.71e-04 1.33e-05  1.02e-02     8s
  30   6.58118660e+04  6.77732010e+04  1.22e-04 8.01e-06  6.83e-03     8s
  31   6.63268851e+04  6.74846253e+04  6.44e-05 5.16e-06  4.03e-03     8s
  32   6.65574967e+04  6.72609908e+04  3.89e-05 2.96e-06  2.45e-03     8s
  33   6.67202228e+04  6.71415040e+04  2.24e-05 1.83e-06  1.47e-03     8s
  34   6.67608909e+04  6.70742789e+04  1.83e-05 1.19e-06  1.09e-03     8s
  35   6.68470971e+04  6.70149462e+04  9.07e-06 6.48e-07  5.84e-04     8s
  36   6.68930779e+04  6.69741818e+04  4.53e-06 2.73e-07  2.82e-04     8s
  37   6.69175432e+04  6.69527826e+04  2.27e-06 8.71e-08  1.23e-04     8s
  38   6.69268997e+04  6.69524692e+04  1.41e-06 8.43e-08  8.90e-05     8s
  39   6.69386242e+04  6.69463046e+04  4.11e-07 3.27e-08  2.67e-05     9s
  40   6.69413295e+04  6.69434373e+04  1.28e-07 9.57e-09  7.34e-06     9s
  41   6.69421960e+04  6.69422661e+04  1.84e-08 1.12e-10  2.44e-07     9s
  42   6.69422332e+04  6.69422332e+04  1.14e-09 1.42e-10  5.24e-11     9s

Barrier solved model in 42 iterations and 8.85 seconds (15.71 work units)
Optimal objective 6.69422332e+04


Root crossover log...

  141108 DPushes remaining with DInf 0.0000000e+00                 9s
   15057 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2239 PPushes remaining with PInf 8.0288078e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.3216389e+00     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62061    6.6942233e+04   0.000000e+00   7.321639e+00     12s
   62081    6.6942233e+04   0.000000e+00   0.000000e+00     12s
   62081    6.6942233e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.694223e+04, 62081 iterations, 8.01 seconds (15.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 66942.2332    0  162 -180179.68 66942.2332   137%     -   12s
H    0     0                    -175941.3672 66942.2332   138%     -   12s
H    0     0                    -83762.33952 66942.2332   180%     -   12s
H    0     0                    -68062.31985 66942.2332   198%     -   13s
H    0     0                    -68008.95385 66942.2332   198%     -   13s
H    0     0                    -63358.86846 66942.2332   206%     -   13s
H    0     0                    8473.4773102 66942.2332   690%     -   14s
H    0     0                    19724.372552 66942.2332   239%     -   14s
H    0     0                    19922.511677 66942.2332   236%     -   14s
H    0     0                    21168.375252 66942.2332   216%     -   14s
H    0     0                    21333.253361 66942.2332   214%     -   14s
H    0     0                    21449.915162 66942.2332   212%     -   14s
H    0     0                    21484.086288 66942.2332   212%     -   14s
H    0     0                    21501.613076 66942.2332   211%     -   14s
     0     0 61969.0469    0  171 21501.6131 61969.0469   188%     -   60s
     0     0 61807.5466    0  185 21501.6131 61807.5466   187%     -   78s
     0     0 61738.6337    0  190 21501.6131 61738.6337   187%     -   88s
     0     0 61652.1444    0  211 21501.6131 61652.1444   187%     -  107s
     0     0 61484.3367    0  197 21501.6131 61484.3367   186%     -  122s
     0     0 61188.2249    0  217 21501.6131 61188.2249   185%     -  145s
     0     0 61099.9836    0  213 21501.6131 61099.9836   184%     -  153s
     0     0 61055.0973    0  219 21501.6131 61055.0973   184%     -  157s
     0     0 61041.9429    0  217 21501.6131 61041.9429   184%     -  162s
     0     0 60782.1111    0  230 21501.6131 60782.1111   183%     -  173s
     0     0 60754.6248    0  234 21501.6131 60754.6248   183%     -  178s
     0     0 60742.9120    0  234 21501.6131 60742.9120   183%     -  181s
     0     0 60725.3514    0  239 21501.6131 60725.3514   182%     -  184s
     0     0 60689.0540    0  242 21501.6131 60689.0540   182%     -  191s
     0     0 60633.3907    0  236 21501.6131 60633.3907   182%     -  202s
     0     0 60631.3045    0  237 21501.6131 60631.3045   182%     -  204s
     0     0 60631.2690    0  237 21501.6131 60631.2690   182%     -  205s
     0     0 57878.9323    0  274 21501.6131 57878.9323   169%     -  257s
H    0     0                    28561.083529 57878.9289   103%     -  258s
H    0     0                    29100.766351 57878.9289  98.9%     -  258s
H    0     0                    29116.815109 57878.9289  98.8%     -  258s
H    0     0                    29218.948576 57878.9289  98.1%     -  258s
H    0     0                    29374.885783 57878.9289  97.0%     -  258s
H    0     0                    29422.445272 57878.9289  96.7%     -  258s
H    0     0                    29423.396745 57878.9289  96.7%     -  258s
H    0     0                    29428.125914 57878.9289  96.7%     -  258s
     0     0 57367.7219    0  265 29428.1259 57367.7219  94.9%     -  285s
     0     0 57258.2691    0  278 29428.1259 57258.2691  94.6%     -  296s
     0     0 57192.9104    0  272 29428.1259 57192.9104  94.3%     -  309s
     0     0 57107.2896    0  283 29428.1259 57107.2896  94.1%     -  322s
     0     0 56984.4096    0  257 29428.1259 56984.4096  93.6%     -  335s
     0     0 56976.4675    0  280 29428.1259 56976.4675  93.6%     -  339s
     0     0 56971.1029    0  276 29428.1259 56971.1029  93.6%     -  343s
     0     0 56961.9463    0  283 29428.1259 56961.9463  93.6%     -  349s
     0     0 56896.6912    0  281 29428.1259 56896.6912  93.3%     -  360s
     0     0 56890.9798    0  278 29428.1259 56890.9798  93.3%     -  367s
     0     0 56886.0111    0  273 29428.1259 56886.0111  93.3%     -  371s
     0     0 56645.1108    0  292 29428.1259 56645.1108  92.5%     -  388s
     0     0 56642.0578    0  295 29428.1259 56642.0578  92.5%     -  390s
     0     0 56641.2635    0  291 29428.1259 56641.2635  92.5%     -  391s
     0     0 54219.9091    0  328 29428.1259 54219.9091  84.2%     -  478s
     0     0 53720.1332    0  342 29428.1259 53720.1332  82.5%     -  510s
     0     0 53584.5010    0  347 29428.1259 53584.5010  82.1%     -  521s
     0     0 53489.7111    0  346 29428.1259 53489.7111  81.8%     -  533s
     0     0 53469.4040    0  354 29428.1259 53469.4040  81.7%     -  540s
     0     0 53441.6041    0  352 29428.1259 53441.6041  81.6%     -  548s
     0     0 53391.6091    0  346 29428.1259 53391.6091  81.4%     -  557s
     0     0 53373.0442    0  363 29428.1259 53373.0442  81.4%     -  562s
     0     0 53351.5559    0  358 29428.1259 53351.5559  81.3%     -  566s
     0     0 53347.5632    0  355 29428.1259 53347.5632  81.3%     -  568s
     0     0 53337.2849    0  356 29428.1259 53337.2849  81.2%     -  572s
     0     0 53334.3204    0  360 29428.1259 53334.3204  81.2%     -  573s
     0     0 53334.0773    0  360 29428.1259 53334.0773  81.2%     -  575s
     0     0 51856.8017    0  363 29428.1259 51856.8017  76.2%     -  632s
     0     0 51618.0677    0  386 29428.1259 51618.0677  75.4%     -  652s
     0     0 51481.1526    0  400 29428.1259 51481.1526  74.9%     -  668s
     0     0 51445.3797    0  404 29428.1259 51445.3797  74.8%     -  677s
     0     0 51397.3227    0  374 29428.1259 51397.3227  74.7%     -  684s
     0     0 51368.5881    0  383 29428.1259 51368.5881  74.6%     -  690s
     0     0 51360.1558    0  387 29428.1259 51360.1558  74.5%     -  695s
     0     0 51346.2723    0  384 29428.1259 51346.2723  74.5%     -  700s
     0     0 51328.0845    0  384 29428.1259 51328.0845  74.4%     -  705s
     0     0 51323.4870    0  391 29428.1259 51323.4870  74.4%     -  707s
     0     0 51315.3742    0  379 29428.1259 51315.3742  74.4%     -  711s
     0     0 51310.1631    0  380 29428.1259 51310.1631  74.4%     -  714s
     0     0 51308.5729    0  392 29428.1259 51308.5729  74.4%     -  715s
     0     0 51150.7229    0  426 29428.1259 51150.7229  73.8%     -  733s
     0     0 51034.9702    0  419 29428.1259 51034.9702  73.4%     -  745s
     0     0 51008.7479    0  420 29428.1259 51008.7479  73.3%     -  752s
     0     0 51000.1228    0  422 29428.1259 51000.1228  73.3%     -  756s
     0     0 50990.4638    0  428 29428.1259 50990.4638  73.3%     -  760s
     0     0 50987.6041    0  424 29428.1259 50987.6041  73.3%     -  762s
     0     0 50983.9868    0  424 29428.1259 50983.9868  73.2%     -  764s
     0     0 50974.8941    0  416 29428.1259 50974.8941  73.2%     -  768s
     0     0 50967.6206    0  417 29428.1259 50967.6206  73.2%     -  771s
     0     0 50958.0191    0  415 29428.1259 50958.0191  73.2%     -  775s
     0     0 50956.9793    0  420 29428.1259 50956.9793  73.2%     -  776s
     0     0 50882.3009    0  379 29428.1259 50882.3009  72.9%     -  790s
H    0     0                    29623.518467 50881.6748  71.8%     -  802s
     0     0 50838.7879    0  380 29623.5185 50838.7879  71.6%     -  810s
     0     0 50829.2626    0  383 29623.5185 50829.2626  71.6%     -  816s
     0     0 50820.7903    0  379 29623.5185 50820.7903  71.6%     -  819s
     0     0 50791.7327    0  375 29623.5185 50791.7327  71.5%     -  826s
     0     0 50782.6845    0  370 29623.5185 50782.6845  71.4%     -  829s
     0     0 50758.0665    0  360 29623.5185 50758.0665  71.3%     -  833s
     0     0 50754.0275    0  384 29623.5185 50754.0275  71.3%     -  837s
     0     0 50752.5197    0  370 29623.5185 50752.5197  71.3%     -  838s
     0     0 50721.9656    0  384 29623.5185 50721.9656  71.2%     -  846s
     0     0 50697.8220    0  387 29623.5185 50697.8220  71.1%     -  853s
     0     0 50684.4913    0  392 29623.5185 50684.4913  71.1%     -  856s
     0     0 50676.4068    0  385 29623.5185 50676.4068  71.1%     -  858s
     0     0 50670.5085    0  388 29623.5185 50670.5085  71.0%     -  861s
     0     0 50666.9558    0  388 29623.5185 50666.9558  71.0%     -  863s
     0     0 50665.5173    0  387 29623.5185 50665.5173  71.0%     -  865s
     0     0 50632.2996    0  414 29623.5185 50632.2996  70.9%     -  875s
H    0     0                    29657.123246 50631.5690  70.7%     -  878s
H    0     0                    29781.045351 50631.5690  70.0%     -  878s
H    0     0                    29828.950669 50631.5690  69.7%     -  878s
     0     0 50624.9059    0  432 29828.9507 50624.9059  69.7%     -  882s
     0     0 50621.0128    0  435 29828.9507 50621.0128  69.7%     -  884s
     0     0 50617.2171    0  436 29828.9507 50617.2171  69.7%     -  886s
     0     0 50611.2420    0  425 29828.9507 50611.2420  69.7%     -  888s
     0     0 50609.1941    0  429 29828.9507 50609.1941  69.7%     -  890s
     0     0 50577.1140    0  382 29828.9507 50577.1140  69.6%     -  899s
     0     0 50570.7874    0  390 29828.9507 50570.7874  69.5%     -  903s
     0     0 50569.1247    0  386 29828.9507 50569.1247  69.5%     -  905s
     0     0 50551.4196    0  383 29828.9507 50551.4196  69.5%     -  911s
H    0     0                    29930.102432 50550.8325  68.9%     -  931s
H    0     0                    30049.539026 50550.8325  68.2%     -  931s
H    0     0                    30064.007704 50550.8325  68.1%     -  932s
     0     0 50546.9153    0  383 30064.0077 50546.9153  68.1%     -  935s
     0     0 50545.9469    0  437 30064.0077 50545.9469  68.1%     -  938s
     0     0 50539.6881    0  379 30064.0077 50539.6881  68.1%     -  942s
     0     0 50532.6282    0  385 30064.0077 50532.6282  68.1%     -  947s
     0     0 50530.9642    0  429 30064.0077 50530.9642  68.1%     -  949s
     0     0 50522.9629    0  382 30064.0077 50522.9629  68.1%     -  955s
     0     0 50521.4618    0  381 30064.0077 50521.4618  68.0%     -  957s
     0     0 50519.8128    0  387 30064.0077 50519.8128  68.0%     -  961s
     0     0 50519.6283    0  387 30064.0077 50519.6283  68.0%     -  964s
H    0     0                    30074.847188 50519.6283  68.0%     - 1104s
H    0     0                    30173.932042 50519.6283  67.4%     - 1108s
     0     2 50519.6283    0  387 30173.9320 50519.6283  67.4%     - 1111s
     1     3 49949.8439    1  389 30173.9320 50519.4973  67.4% 20324 1136s
     2     4 50378.8453    1  375 30173.9320 50378.8453  67.0% 16207 1148s
     3     7 50277.3525    2  427 30173.9320 50378.3776  67.0% 14427 1164s
     6    13 50229.7692    3  382 30173.9320 50352.7332  66.9% 12182 1200s
    12    25 50078.3796    4  374 30173.9320 50229.2521  66.5% 17062 1237s
    24    37 48834.0474    5  366 30173.9320 50229.2521  66.5% 26495 1341s
H   36    68                    30206.521510 50078.3639  65.8% 23478 1524s
H   36    68                    30211.658531 50078.3639  65.8% 23478 1524s
H   39    68                    30289.531945 50078.3639  65.3% 23958 1524s
H   40    68                    30524.853114 50078.3639  64.1% 23673 1524s
    67   128 47034.3116    7  285 30524.8531 50078.3639  64.1% 27834 1595s
H  127   172                    30587.430819 50078.3639  63.7% 21048 1637s
H  130   172                    30722.470864 50078.3639  63.0% 20801 1637s
H  137   172                    30809.323842 50078.3639  62.5% 20243 1637s
H  145   172                    34481.703735 50078.3639  45.2% 19544 1637s
   171   278 45132.9710   11  252 34481.7037 50078.3639  45.2% 18914 1685s
   277   365 44644.9167   16  274 34481.7037 50078.3639  45.2% 15248 1720s
   364   427 44020.5856   21  242 34481.7037 50078.3639  45.2% 13363 1748s
   426   454 45517.1279   22  225 34481.7037 50078.3639  45.2% 12851 1791s
   453   491 43263.5187   24  218 34481.7037 50078.3639  45.2% 12599 1863s
   490   530 42749.0348   27  252 34481.7037 50078.3639  45.2% 12457 1925s
   529   567 41875.1287   30  238 34481.7037 50078.3639  45.2% 12243 1953s
H  534   567                    34628.193444 50078.3639  44.6% 12201 1953s
   566   638 41425.8177   33  232 34628.1934 50078.3639  44.6% 12146 1982s
   639   701 41307.1650   35  286 34628.1934 50078.3639  44.6% 12138 2009s
   704   770 40998.3195   37  276 34628.1934 50078.3639  44.6% 12034 2039s
   781   820 40877.1666   40  314 34628.1934 50078.3639  44.6% 11691 2067s
   841   883 40326.3480   41  214 34628.1934 50078.3639  44.6% 11653 2092s
   906   922 37133.6492   44  241 34628.1934 50078.3639  44.6% 11543 2123s
   961   986 36478.7082   50  148 34628.1934 50078.3639  44.6% 11573 2153s
  1031  1078 36325.4527   52  139 34628.1934 50078.3639  44.6% 11494 2184s
  1139  1102 34790.3752   59  131 34628.1934 50078.3639  44.6% 11151 2213s
H 1143  1102                    34793.159279 50078.3639  43.9% 11130 2213s
  1169  1184     cutoff   60      34793.1593 50078.3639  43.9% 11167 2239s
  1286  1259 35214.7569   71  135 34793.1593 50078.3639  43.9% 10746 2269s
  1395  1320 48585.8643    8  309 34793.1593 50078.3639  43.9% 10548 2301s
  1504  1397 41502.9711   20  296 34793.1593 50078.3639  43.9% 10420 2331s
  1607  1467 40511.9350   21  324 34793.1593 50078.3639  43.9% 10461 2365s
  1735  1528 40261.2367   24  270 34793.1593 50078.3639  43.9% 10280 2398s
  1851  1598 37142.2853   29  234 34793.1593 50078.3639  43.9% 10288 2433s
  1969  1681 35598.9233   33  211 34793.1593 50078.3639  43.9% 10332 2470s
  2076  1758 35734.8512   34  213 34793.1593 50078.3639  43.9% 10421 2511s
  2183  1784 35772.1987   56  336 34793.1593 50078.3639  43.9% 10500 2547s
  2225  1842 35460.8391   57  279 34793.1593 50078.3639  43.9% 10557 2581s
H 2297  1893                    34816.093194 50078.3639  43.8% 10546 2621s
H 2301  1892                    34883.838982 50078.3639  43.6% 10561 2621s
  2356  1989 infeasible   60      34883.8390 50078.3639  43.6% 10537 2667s
H 2375  1987                    34887.325362 50078.3639  43.5% 10519 2667s
  2495  2091 infeasible   33      34887.3254 50078.3639  43.5% 10316 2710s
  2695  2176 infeasible   29      34887.3254 50078.3639  43.5% 10112 2757s
  2868  2322 infeasible   64      34887.3254 49877.8171  43.0% 10065 2804s
  3056  2438 49272.9109    6  412 34887.3254 49877.8058  43.0% 10011 2854s
  3242  2531 44902.0306    7  311 34887.3254 49877.8058  43.0%  9964 2904s
  3416  2612 44018.9814    8  258 34887.3254 49877.8058  43.0%  9973 2959s
  3559  2691 38201.3171   10  329 34887.3254 48992.2729  40.4% 10073 3014s
  3700  2766 37826.9706   12  248 34887.3254 48992.2729  40.4% 10211 3070s
  3827  2875 37155.7636   15  265 34887.3254 48992.2729  40.4% 10366 3129s
  3975  2876 43655.2990   18  387 34887.3254 48992.2729  40.4% 10501 3487s
  3977  2877 45497.0870    6  172 34887.3254 48992.2729  40.4% 10496 3513s

Cutting planes:
  Gomory: 28
  Implied bound: 1
  Projected implied bound: 29
  MIR: 1191
  Mixing: 26
  Flow cover: 1127
  RLT: 34
  Relax-and-lift: 158

Explored 3977 nodes (42684424 simplex iterations) in 3600.03 seconds (9293.40 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 34887.3 34883.8 34816.1 ... 30524.9

Time limit reached
Best objective 3.488732536216e+04, best bound 4.899227289912e+04, gap 40.4300%
  WARNING: Time limit reached. Using best solution found (gap: 40.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 34887.33, θ = 186147.56
  Upper Bound (UB) = 34887.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 186147.56
  [DEBUG]   ✓ Scenario 0: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 186147.56 ≤ Q = 186147.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 186147.56 ≤ Q = 186147.56 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7c7ca4da
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7c7ca4da
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-13, 2e+02]
Found heuristic solution: objective 1.399777e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6875083.5581
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.586756e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158675.57    0  123 6875083.56 -158675.57   102%     -    0s
H    0     0                    -124053.4225 -158675.57  27.9%     -    0s
H    0     0                    -124845.8328 -158675.57  27.1%     -    0s
     0     0 -133719.27    0   54 -124845.83 -133719.27  7.11%     -    0s
H    0     0                    -131158.5275 -133603.55  1.86%     -    0s
     0     0 -132882.85    0   55 -131158.53 -132882.85  1.31%     -    0s
H    0     0                    -131743.4253 -132858.89  0.85%     -    0s
     0     0 -132381.16    0   55 -131743.43 -132381.16  0.48%     -    0s
     0     0 -132348.79    0   54 -131743.43 -132348.79  0.46%     -    0s
     0     0 -132090.25    0   27 -131743.43 -132090.25  0.26%     -    0s
     0     0 -132028.62    0   31 -131743.43 -132028.62  0.22%     -    0s
     0     0 -132026.89    0   31 -131743.43 -132026.89  0.22%     -    0s
     0     0 -131908.80    0   27 -131743.43 -131908.80  0.13%     -    0s
     0     0 -131899.02    0   27 -131743.43 -131899.02  0.12%     -    0s
     0     0 -131899.02    0   39 -131743.43 -131899.02  0.12%     -    0s
     0     0 -131899.02    0   39 -131743.43 -131899.02  0.12%     -    0s
     0     0 -131899.02    0   26 -131743.43 -131899.02  0.12%     -    0s
H    0     0                    -131778.9180 -131899.02  0.09%     -    0s
H    0     0                    -131792.3183 -131839.59  0.04%     -    0s
     0     0 -131831.71    0   23 -131792.32 -131831.71  0.03%     -    0s
     0     0 -131820.98    0    6 -131792.32 -131820.98  0.02%     -    0s
     0     0 -131812.30    0    4 -131792.32 -131812.30  0.02%     -    0s
     0     0 -131807.73    0    4 -131792.32 -131807.73  0.01%     -    0s

Explored 1 nodes (780 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -131792 -131785 -131779 ... 1.39978e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.317923183253e+05, best bound -1.318034750956e+05, gap 0.0085%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 181465.99
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131792.32
  [DEBUG]   S×d_nominal = 313258.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 313258.31 + -131792.32 = 181465.99
  [DEBUG]   Current θ from Master = 186147.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4681.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30205.75
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 4524.5129, Absolute Gap = 4524.5129, Relative Gap = 0.129689
  Not converged yet (gap = 4524.51 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0x63dc93b8
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141400 rows and 57400 columns
Presolve time: 3.32s
Presolved: 165783 rows, 69660 columns, 1020088 nonzeros
Variable types: 67401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 1143
 AA' NZ     : 4.080e+06
 Factor NZ  : 1.148e+07 (roughly 200 MB of memory)
 Factor Ops : 3.879e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93618025e+07  2.98396436e+08  1.43e+05 1.38e+01  9.08e+04     5s
   1  -1.50334167e+07  2.78742837e+08  1.01e+05 7.52e+01  6.39e+04     5s
   2  -6.50957075e+06  2.07256148e+08  4.30e+04 5.94e+00  2.89e+04     5s
   3  -1.19909447e+06  1.73178047e+08  3.45e+03 2.57e+00  2.81e+03     5s
   4  -5.71100454e+05  1.00450411e+08  7.18e+02 8.37e-01  7.59e+02     5s
   5  -4.89828035e+05  6.20893955e+07  3.96e+02 4.40e-01  4.21e+02     6s
   6  -4.05206097e+05  4.86755155e+07  9.53e+01 3.25e-01  2.11e+02     6s
   7  -3.85522128e+05  3.23592263e+07  6.56e+01 2.03e-01  1.37e+02     6s
   8  -3.21887397e+05  2.24664593e+07  2.00e+01 1.35e-01  8.26e+01     6s
   9  -2.27446519e+05  1.01089737e+07  4.13e-01 5.88e-02  3.43e+01     6s
  10  -1.33435574e+05  2.41918939e+06  1.41e-01 1.31e-02  8.45e+00     6s
  11  -8.63511949e+04  1.65280647e+06  8.02e-02 8.90e-03  5.76e+00     6s
  12  -5.84654258e+04  9.79477654e+05  4.99e-02 5.33e-03  3.44e+00     6s
  13  -3.09154484e+04  5.97078320e+05  2.93e-02 3.29e-03  2.08e+00     6s
  14   1.35344565e+03  3.03683526e+05  1.45e-02 1.70e-03  1.00e+00     6s
  15   1.73941336e+04  2.24905994e+05  9.82e-03 1.18e-03  6.87e-01     6s
  16   2.84000748e+04  1.51361529e+05  7.27e-03 6.66e-04  4.07e-01     6s
  17   3.55015004e+04  1.29298457e+05  5.63e-03 4.97e-04  3.10e-01     6s
  18   4.18369246e+04  1.14147214e+05  4.23e-03 3.75e-04  2.39e-01     6s
  19   4.70506907e+04  1.01912078e+05  3.12e-03 2.84e-04  1.82e-01     6s
  20   4.98353432e+04  9.51306276e+04  2.57e-03 2.30e-04  1.50e-01     7s
  21   5.40751770e+04  8.95402757e+04  1.81e-03 2.04e-04  1.17e-01     7s
  22   5.59977169e+04  8.36193919e+04  1.50e-03 1.51e-04  9.14e-02     7s
  23   5.79211749e+04  8.10101215e+04  1.20e-03 1.28e-04  7.64e-02     7s
  24   5.92690855e+04  7.64130274e+04  1.00e-03 1.06e-04  5.67e-02     7s
  25   6.15509914e+04  7.34565190e+04  6.91e-04 6.95e-05  3.94e-02     7s
  26   6.23102681e+04  7.13843698e+04  5.93e-04 4.68e-05  3.00e-02     7s
  27   6.48304065e+04  7.09314580e+04  2.80e-04 4.15e-05  2.02e-02     7s
  28   6.57620042e+04  6.96410271e+04  1.64e-04 2.68e-05  1.28e-02     7s
  29   6.59007962e+04  6.89551835e+04  1.48e-04 1.95e-05  1.01e-02     7s
  30   6.61124843e+04  6.84614815e+04  1.24e-04 1.39e-05  7.77e-03     7s
  31   6.65697635e+04  6.82253217e+04  7.26e-05 1.11e-05  5.48e-03     7s
  32   6.68660717e+04  6.80101554e+04  4.28e-05 8.50e-06  3.79e-03     8s
  33   6.70417669e+04  6.78443715e+04  2.38e-05 6.56e-06  2.66e-03     8s
  34   6.71646427e+04  6.75927544e+04  1.17e-05 3.53e-06  1.42e-03     8s
  35   6.72150534e+04  6.74674758e+04  6.92e-06 2.00e-06  8.35e-04     8s
  36   6.72486231e+04  6.74170671e+04  4.16e-06 1.39e-06  5.57e-04     8s
  37   6.72596570e+04  6.73378077e+04  3.10e-06 4.34e-07  2.59e-04     8s
  38   6.72771916e+04  6.73216650e+04  1.65e-06 2.48e-07  1.47e-04     8s
  39   6.72868586e+04  6.73113530e+04  8.99e-07 1.29e-07  8.11e-05     8s
  40   6.72917277e+04  6.73066241e+04  5.49e-07 7.61e-08  4.93e-05     8s
  41   6.72950085e+04  6.73052898e+04  3.03e-07 6.16e-08  3.40e-05     8s
  42   6.72958867e+04  6.73045503e+04  2.40e-07 5.35e-08  2.87e-05     8s
  43   6.72959862e+04  6.73026390e+04  2.32e-07 3.33e-08  2.20e-05     9s
  44   6.72971013e+04  6.73012209e+04  1.59e-07 1.78e-08  1.36e-05     9s
  45   6.72978906e+04  6.72998608e+04  1.01e-07 4.07e-09  6.52e-06     9s
  46   6.72986920e+04  6.72995366e+04  4.78e-08 6.55e-09  2.79e-06     9s
  47   6.72990053e+04  6.72994755e+04  2.80e-08 1.64e-09  1.56e-06     9s
  48   6.72991567e+04  6.72994624e+04  3.05e-07 2.45e-07  1.01e-06     9s
  49   6.72994422e+04  6.72994506e+04  1.21e-06 9.01e-08  2.76e-08     9s
  50   6.72994493e+04  6.72994498e+04  1.51e-06 1.70e-08  2.18e-09     9s

Barrier solved model in 50 iterations and 9.29 seconds (16.67 work units)
Optimal objective 6.72994493e+04


Root crossover log...

  149406 DPushes remaining with DInf 0.0000000e+00                 9s
   58741 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   19653 PPushes remaining with PInf 2.1572520e-04                13s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.0640518e+04     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   96043    6.7299450e+04   0.000000e+00   2.064052e+04     15s
   96424    6.7299450e+04   0.000000e+00   0.000000e+00     15s
   96424    6.7299450e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.72s

Solved with barrier

Root relaxation: objective 6.729945e+04, 96424 iterations, 12.10 seconds (22.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67299.4496    0  171 -180179.68 67299.4496   137%     -   16s
H    0     0                    -174029.4543 67299.4496   139%     -   16s
H    0     0                    -63358.86846 67299.4496   206%     -   17s
H    0     0                    8096.5019766 67299.4496   731%     -   17s
H    0     0                    16070.644802 67299.4496   319%     -   17s
H    0     0                    20978.761917 67299.4496   221%     -   18s
H    0     0                    21247.919185 67299.4496   217%     -   18s
H    0     0                    21436.442270 67299.4496   214%     -   19s
H    0     0                    21449.915162 67299.4496   214%     -   19s
H    0     0                    21501.613076 67299.4496   213%     -   19s
     0     0 61430.7468    0  225 21501.6131 61430.7468   186%     -   79s
     0     0 61189.1231    0  200 21501.6131 61189.1231   185%     -   96s
     0     0 61068.5373    0  238 21501.6131 61068.5373   184%     -  103s
     0     0 61049.5172    0  226 21501.6131 61049.5172   184%     -  108s
     0     0 60695.7944    0  226 21501.6131 60695.7944   182%     -  121s
     0     0 60618.7607    0  238 21501.6131 60618.7607   182%     -  132s
     0     0 60612.1043    0  237 21501.6131 60612.1043   182%     -  135s
     0     0 60611.8852    0  237 21501.6131 60611.8852   182%     -  136s
     0     0 57536.0336    0  277 21501.6131 57536.0336   168%     -  190s
H    0     0                    26781.336750 57535.4339   115%     -  191s
H    0     0                    27153.931186 57535.4339   112%     -  191s
H    0     0                    27254.126576 57535.4339   111%     -  191s
H    0     0                    27403.904474 57535.4339   110%     -  191s
H    0     0                    27486.118161 57535.4339   109%     -  191s
H    0     0                    27604.781519 57535.4339   108%     -  191s
     0     0 57041.4760    0  306 27604.7815 57041.4760   107%     -  221s
     0     0 56954.0371    0  305 27604.7815 56954.0371   106%     -  233s
     0     0 56897.9024    0  293 27604.7815 56897.9024   106%     -  246s
     0     0 56850.2719    0  294 27604.7815 56850.2719   106%     -  256s
     0     0 56816.9924    0  281 27604.7815 56816.9924   106%     -  264s
     0     0 56815.4223    0  288 27604.7815 56815.4223   106%     -  266s
     0     0 56805.1940    0  291 27604.7815 56805.1940   106%     -  269s
     0     0 56797.9883    0  299 27604.7815 56797.9883   106%     -  273s
     0     0 56786.9429    0  294 27604.7815 56786.9429   106%     -  280s
     0     0 56739.9425    0  285 27604.7815 56739.9425   106%     -  289s
     0     0 56704.0417    0  282 27604.7815 56704.0417   105%     -  297s
     0     0 56690.3870    0  299 27604.7815 56690.3870   105%     -  302s
     0     0 56663.4275    0  291 27604.7815 56663.4275   105%     -  308s
     0     0 56466.1904    0  286 27604.7815 56466.1904   105%     -  325s
     0     0 56452.9157    0  291 27604.7815 56452.9157   105%     -  329s
     0     0 56451.6061    0  295 27604.7815 56451.6061   104%     -  331s
     0     0 56445.5447    0  297 27604.7815 56445.5447   104%     -  334s
     0     0 56445.0141    0  297 27604.7815 56445.0141   104%     -  335s
     0     0 53943.1308    0  301 27604.7815 53943.1308  95.4%     -  402s
H    0     0                    27918.999087 53942.4330  93.2%     -  403s
H    0     0                    28266.618196 53942.4330  90.8%     -  403s
H    0     0                    28397.355094 53942.4330  90.0%     -  403s
     0     0 53490.7922    0  334 28397.3551 53490.7922  88.4%     -  432s
     0     0 53285.5966    0  332 28397.3551 53285.5966  87.6%     -  450s
     0     0 53222.5350    0  333 28397.3551 53222.5350  87.4%     -  460s
     0     0 53195.5359    0  345 28397.3551 53195.5359  87.3%     -  467s
     0     0 53171.0547    0  338 28397.3551 53171.0547  87.2%     -  472s
     0     0 53131.3403    0  328 28397.3551 53131.3403  87.1%     -  478s
     0     0 53119.5946    0  336 28397.3551 53119.5946  87.1%     -  482s
     0     0 53093.2015    0  332 28397.3551 53093.2015  87.0%     -  487s
     0     0 53081.9899    0  335 28397.3551 53081.9899  86.9%     -  490s
     0     0 53064.0881    0  325 28397.3551 53064.0881  86.9%     -  496s
     0     0 53048.6001    0  329 28397.3551 53048.6001  86.8%     -  503s
     0     0 53025.6961    0  331 28397.3551 53025.6961  86.7%     -  511s
     0     0 53008.7714    0  336 28397.3551 53008.7714  86.7%     -  519s
     0     0 53001.0288    0  341 28397.3551 53001.0288  86.6%     -  525s
     0     0 52999.8805    0  347 28397.3551 52999.8805  86.6%     -  529s
     0     0 52109.5294    0  352 28397.3551 52109.5294  83.5%     -  574s
H    0     0                    28832.691465 52109.0603  80.7%     -  575s
H    0     0                    28980.223146 52109.0603  79.8%     -  575s
     0     0 51741.1762    0  373 28980.2231 51741.1762  78.5%     -  598s
     0     0 51654.4976    0  387 28980.2231 51654.4976  78.2%     -  612s
     0     0 51613.0315    0  394 28980.2231 51613.0315  78.1%     -  620s
     0     0 51587.0169    0  375 28980.2231 51587.0169  78.0%     -  626s
     0     0 51578.8985    0  381 28980.2231 51578.8985  78.0%     -  629s
     0     0 51569.6775    0  385 28980.2231 51569.6775  77.9%     -  633s
     0     0 51563.3538    0  375 28980.2231 51563.3538  77.9%     -  637s
     0     0 51556.2419    0  381 28980.2231 51556.2419  77.9%     -  641s
     0     0 51544.2443    0  377 28980.2231 51544.2443  77.9%     -  647s
     0     0 51510.7719    0  376 28980.2231 51510.7719  77.7%     -  654s
     0     0 51355.1291    0  383 28980.2231 51355.1291  77.2%     -  669s
     0     0 51338.0040    0  378 28980.2231 51338.0040  77.1%     -  675s
     0     0 51329.0353    0  380 28980.2231 51329.0353  77.1%     -  679s
     0     0 51317.0016    0  383 28980.2231 51317.0016  77.1%     -  683s
     0     0 51314.8695    0  393 28980.2231 51314.8695  77.1%     -  684s
     0     0 51307.8859    0  379 28980.2231 51307.8859  77.0%     -  687s
     0     0 51300.4671    0  384 28980.2231 51300.4671  77.0%     -  692s
     0     0 51296.1929    0  384 28980.2231 51296.1929  77.0%     -  695s
     0     0 51295.6829    0  386 28980.2231 51295.6829  77.0%     -  696s
     0     0 51050.3183    0  404 28980.2231 51050.3183  76.2%     -  725s
     0     0 51033.3254    0  368 28980.2231 51033.3254  76.1%     -  731s
     0     0 51020.0436    0  378 28980.2231 51020.0436  76.1%     -  736s
     0     0 51017.9562    0  379 28980.2231 51017.9562  76.0%     -  739s
     0     0 50912.2349    0  421 28980.2231 50912.2349  75.7%     -  755s
H    0     0                    29000.303472 50910.6998  75.6%     -  757s
     0     0 50881.8691    0  394 29000.3035 50881.8691  75.5%     -  763s
     0     0 50865.3763    0  384 29000.3035 50865.3763  75.4%     -  768s
     0     0 50860.3489    0  382 29000.3035 50860.3489  75.4%     -  771s
     0     0 50856.9065    0  384 29000.3035 50856.9065  75.4%     -  773s
     0     0 50854.1983    0  382 29000.3035 50854.1983  75.4%     -  775s
     0     0 50846.5958    0  384 29000.3035 50846.5958  75.3%     -  777s
     0     0 50828.5051    0  392 29000.3035 50828.5051  75.3%     -  782s
     0     0 50823.4648    0  395 29000.3035 50823.4648  75.3%     -  785s
     0     0 50818.6995    0  390 29000.3035 50818.6995  75.2%     -  787s
     0     0 50816.1362    0  392 29000.3035 50816.1362  75.2%     -  789s
     0     0 50813.6557    0  390 29000.3035 50813.6557  75.2%     -  790s
     0     0 50808.9720    0  447 29000.3035 50808.9720  75.2%     -  793s
     0     0 50799.3768    0  434 29000.3035 50799.3768  75.2%     -  797s
     0     0 50792.6385    0  437 29000.3035 50792.6385  75.1%     -  800s
     0     0 50791.1518    0  438 29000.3035 50791.1518  75.1%     -  801s
     0     0 50745.7793    0  378 29000.3035 50745.7793  75.0%     -  810s
     0     0 50731.9772    0  385 29000.3035 50731.9772  74.9%     -  816s
     0     0 50728.4156    0  387 29000.3035 50728.4156  74.9%     -  819s
     0     0 50724.7027    0  390 29000.3035 50724.7027  74.9%     -  821s
     0     0 50719.6566    0  390 29000.3035 50719.6566  74.9%     -  824s
     0     0 50718.9371    0  395 29000.3035 50718.9371  74.9%     -  826s
     0     0 50671.3190    0  384 29000.3035 50671.3190  74.7%     -  839s
H    0     0                    29604.303616 50670.9734  71.2%     -  840s
H    0     0                    29746.627127 50670.9734  70.3%     -  840s
H    0     0                    29773.618954 50670.9734  70.2%     -  840s
H    0     0                    29795.340890 50670.9734  70.1%     -  840s
H    0     0                    29803.753550 50670.9734  70.0%     -  840s
H    0     0                    29897.730266 50670.9734  69.5%     -  840s
H    0     0                    29944.637964 50670.9734  69.2%     -  840s
H    0     0                    29972.409718 50670.9734  69.1%     -  840s
     0     0 50654.1981    0  392 29972.4097 50654.1981  69.0%     -  846s
     0     0 50645.4892    0  401 29972.4097 50645.4892  69.0%     -  850s
     0     0 50642.7525    0  399 29972.4097 50642.7525  69.0%     -  852s
     0     0 50639.9450    0  400 29972.4097 50639.9450  69.0%     -  855s
     0     0 50638.2465    0  381 29972.4097 50638.2465  68.9%     -  856s
     0     0 50624.9317    0  380 29972.4097 50624.9317  68.9%     -  863s
H    0     0                    30003.036415 50624.8627  68.7%     -  865s
     0     0 50615.8660    0  387 30003.0364 50615.8660  68.7%     -  870s
     0     0 50613.2420    0  392 30003.0364 50613.2420  68.7%     -  873s
     0     0 50612.3975    0  394 30003.0364 50612.3975  68.7%     -  875s
     0     0 50556.0895    0  375 30003.0364 50556.0895  68.5%     -  887s
H    0     0                    30133.157472 50555.7983  67.8%     -  889s
     0     0 50546.9346    0  387 30133.1575 50546.9346  67.7%     -  894s
     0     0 50545.3257    0  391 30133.1575 50545.3257  67.7%     -  898s
     0     0 50528.8065    0  386 30133.1575 50528.8065  67.7%     -  904s
     0     0 50524.4628    0  395 30133.1575 50524.4628  67.7%     -  907s
     0     0 50517.7120    0  385 30133.1575 50517.7120  67.6%     -  909s
     0     0 50515.3362    0  393 30133.1575 50515.3362  67.6%     -  910s
     0     0 50499.8606    0  392 30133.1575 50499.8606  67.6%     -  915s
     0     0 50492.3476    0  395 30133.1575 50492.3476  67.6%     -  929s
     0     0 50487.3917    0  392 30133.1575 50487.3917  67.5%     -  931s
     0     0 50479.1030    0  386 30133.1575 50479.1030  67.5%     -  934s
     0     0 50470.2532    0  383 30133.1575 50470.2532  67.5%     -  938s
     0     0 50467.8393    0  385 30133.1575 50467.8393  67.5%     -  940s
     0     0 50466.9687    0  385 30133.1575 50466.9687  67.5%     -  941s
     0     0 50449.0170    0  381 30133.1575 50449.0170  67.4%     -  947s
     0     0 50445.1573    0  385 30133.1575 50445.1573  67.4%     -  950s
     0     0 50443.5337    0  388 30133.1575 50443.5337  67.4%     -  950s
     0     0 50428.0670    0  389 30133.1575 50428.0670  67.4%     -  957s
H    0     0                    30157.369464 50426.6584  67.2%     -  969s
     0     0 50421.0452    0  387 30157.3695 50421.0452  67.2%     -  973s
     0     0 50413.7844    0  385 30157.3695 50413.7844  67.2%     -  976s
     0     0 50412.8539    0  381 30157.3695 50412.8539  67.2%     -  977s
     0     0 50405.1663    0  381 30157.3695 50405.1663  67.1%     -  981s
     0     0 50399.6115    0  379 30157.3695 50399.6115  67.1%     -  985s
     0     0 50398.7285    0  383 30157.3695 50398.7285  67.1%     -  987s
     0     0 50390.7761    0  424 30157.3695 50390.7761  67.1%     -  996s
     0     0 50390.5681    0  424 30157.3695 50390.5681  67.1%     - 1001s
H    0     0                    30192.208817 50390.5681  66.9%     - 1174s
H    0     0                    30211.192273 50390.5681  66.8%     - 1174s
H    0     2                    30249.066344 50390.5681  66.6%     - 1203s
     0     2 50390.5681    0  424 30249.0663 50390.5681  66.6%     - 1203s
     1     4 50279.6001    1  368 30249.0663 50390.5681  66.6% 10449 1216s
     3     8 50219.8957    2  420 30249.0663 50279.5627  66.2% 10621 1236s
     7    15 49958.1392    3  365 30249.0663 50219.4551  66.0% 13668 1269s
    14    29 49795.5929    4  364 30249.0663 50141.9331  65.8% 17315 1309s
    28    43 49526.4419    5  363 30249.0663 50048.1121  65.5% 26469 1381s
    42    73 48494.5078    6  359 30249.0663 50048.1121  65.5% 26690 1594s
H   43    73                    30609.195596 50048.1121  63.5% 26069 1594s
H   52    73                    30774.444984 50048.1121  62.6% 24843 1594s
    72   105 49055.5067    6  366 30774.4450 50048.1121  62.6% 25932 1768s
   104   254 48988.4802    7  347 30774.4450 50048.1121  62.6% 22304 1846s
   253   317 48428.1835   11  330 30774.4450 50048.1121  62.6% 14904 1886s
   316   367 48184.5983   13  328 30774.4450 50048.1121  62.6% 13266 1920s
H  318   367                    30840.110756 50048.1121  62.3% 13202 1920s
   366   437 47983.8881   15  308 30840.1108 50048.1121  62.3% 12258 1954s
   436   486 47633.9843   19  302 30840.1108 50048.1121  62.3% 11228 1985s
   485   547 46737.4751   20  245 30840.1108 50048.1121  62.3% 10828 2016s
   546   613 46259.8015   21  225 30840.1108 50048.1121  62.3% 10315 2049s
   612   664 45536.1954   23  221 30840.1108 50048.1121  62.3%  9909 2079s
   663   693 45240.5055   25  211 30840.1108 50048.1121  62.3%  9618 2150s
   692   727 45127.7062   26  211 30840.1108 50048.1121  62.3%  9513 2258s
   726   759 45119.4081   27  213 30840.1108 50048.1121  62.3%  9352 2334s
H  747   759                    30874.199395 50048.1121  62.1%  9305 2334s
   758   848 45072.7278   28  207 30874.1994 50048.1121  62.1%  9246 2367s
   847   878 44558.8853   33  205 30874.1994 50048.1121  62.1%  8787 2394s
   877   915 44040.3450   34  217 30874.1994 50048.1121  62.1%  8711 2421s
   916   956 41807.3588   35  175 30874.1994 50048.1121  62.1%  8607 2449s
   957   998 41721.0447   36  177 30874.1994 50048.1121  62.1%  8478 2473s
  1001  1043 41502.6989   37  169 30874.1994 50048.1121  62.1%  8309 2500s
  1046  1092 41454.9697   38  160 30874.1994 50048.1121  62.1%  8165 2528s
  1095  1152 40925.3624   39  151 30874.1994 50048.1121  62.1%  7986 2566s
H 1131  1152                    30878.044520 50048.1121  62.1%  7953 2566s
  1163  1232 40900.8204   40  146 30878.0445 50048.1121  62.1%  7856 2607s
  1267  1323 35670.1242   48  127 30878.0445 50048.1121  62.1%  7633 2652s
  1380  1400 31880.7922   51  123 30878.0445 50048.1121  62.1%  7379 2695s
  1489  1485 infeasible   51      30878.0445 50048.1121  62.1%  7206 2744s
  1622  1579 46863.4162    7  333 30878.0445 50048.1121  62.1%  7027 2790s
  1768  1660 44563.1696    8  273 30878.0445 50048.1121  62.1%  6794 2840s
  1905  1754 43152.9118   10  254 30878.0445 50048.1121  62.1%  6631 2889s
  2051  1847 42936.3032   12  264 30878.0445 50048.1121  62.1%  6477 2939s
  2210  1868 36551.8279   14  230 30878.0445 50048.1121  62.1%  6337 2985s
  2243  1895 36543.6942   15  234 30878.0445 50048.1121  62.1%  6360 3029s
  2281  1920 36236.6784   16  224 30878.0445 50048.1121  62.1%  6388 3077s
  2328  1951 36088.0120   17  225 30878.0445 49588.3783  60.6%  6413 3148s
  2363  2017 36082.0842   18  230 30878.0445 49588.3783  60.6%  6438 3196s
  2447  2123 35916.7193   19  219 30878.0445 49578.7504  60.6%  6373 3246s
  2565  2201 35820.1662   20  230 30878.0445 49578.7504  60.6%  6222 3300s
  2750  2297 34717.1220   22  207 30878.0445 49431.3722  60.1%  6041 3361s
  2911  2393 34051.3891   31  241 30878.0445 49431.3722  60.1%  5939 3427s
  3070  2504 32637.1803   42  125 30878.0445 49431.3722  60.1%  5895 3495s
  3225  2634 31607.9123   61  148 30878.0445 49431.3722  60.1%  5898 3569s
  3411  2710 39389.7997   18  322 30878.0445 49431.3722  60.1%  5884 3600s

Cutting planes:
  Learned: 1
  Gomory: 11
  Implied bound: 174
  MIR: 4371
  Flow cover: 3703
  RLT: 65
  Relax-and-lift: 479
  BQP: 1

Explored 3495 nodes (21369180 simplex iterations) in 3600.08 seconds (9426.62 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 30878 30874.2 30840.1 ... 30133.2

Time limit reached
Best objective 3.087804451960e+04, best bound 4.943137219947e+04, gap 60.0858%
  WARNING: Time limit reached. Using best solution found (gap: 60.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 30878.04, θ = 183873.12
  Upper Bound (UB) = 30878.04

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183873.12
  [DEBUG]   ✓ Scenario 0: θ = 183873.12 ≤ Q = 183873.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183873.12 ≤ Q = 183873.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183873.12 ≤ Q = 183873.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183873.12 ≤ Q = 183873.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183873.12 ≤ Q = 183873.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 183873.12 ≤ Q = 183873.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 183873.12 ≤ Q = 183873.12 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6a0c2fa3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x95f3d05d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.401753e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6930570.8509
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.582312e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158231.22    0  123 6930570.85 -158231.22   102%     -    0s
H    0     0                    -120342.2032 -158231.22  31.5%     -    0s
H    0     0                    -121172.6327 -158231.22  30.6%     -    0s
H    0     0                    -129546.4116 -158231.22  22.1%     -    0s
H    0     0                    -131376.0189 -135002.99  2.76%     -    0s
     0     0 -135002.99    0   65 -131376.02 -135002.99  2.76%     -    0s
H    0     0                    -134236.2623 -134989.17  0.56%     -    0s
     0     0 -134565.50    0   24 -134236.26 -134565.50  0.25%     -    0s
     0     0 -134345.64    0   12 -134236.26 -134345.64  0.08%     -    0s
     0     0 -134319.55    0   14 -134236.26 -134319.55  0.06%     -    0s
     0     0 -134291.40    0   13 -134236.26 -134291.40  0.04%     -    0s
     0     0 -134274.36    0    3 -134236.26 -134274.36  0.03%     -    0s
     0     0          -    0      -134236.26 -134248.60  0.01%     -    0s

Cutting planes:
  Gomory: 39
  Implied bound: 4
  MIR: 96
  RLT: 53
  Relax-and-lift: 1

Explored 1 nodes (502 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -134236 -131376 -129546 ... 1.40175e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.342362622704e+05, best bound -1.342485978247e+05, gap 0.0092%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 172042.16
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134236.26
  [DEBUG]   S×d_nominal = 306278.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 306278.42 + -134236.26 = 172042.16
  [DEBUG]   Current θ from Master = 183873.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11830.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19047.08
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 515.2320, Absolute Gap = 515.2320, Relative Gap = 0.016686
  Not converged yet (gap = 515.23 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913370 nonzeros
Model fingerprint: 0xe4336314
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148470 rows and 60270 columns
Presolve time: 3.53s
Presolved: 174003 rows, 73030 columns, 1070673 nonzeros
Variable types: 70771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.42s

Barrier statistics:
 Dense cols : 1142
 AA' NZ     : 4.424e+06
 Factor NZ  : 1.242e+07 (roughly 200 MB of memory)
 Factor Ops : 4.272e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.97341801e+07  3.10986687e+08  1.46e+05 1.35e+01  9.21e+04     6s
   1  -1.53564638e+07  2.91073663e+08  1.03e+05 7.56e+01  6.49e+04     6s
   2  -6.77006327e+06  2.18757598e+08  4.46e+04 3.43e+00  2.98e+04     6s
   3  -1.48394856e+06  1.91612103e+08  5.11e+03 1.22e+00  3.90e+03     6s
   4  -8.07003295e+05  1.25476957e+08  9.34e+02 4.90e-01  9.56e+02     6s
   5  -7.02542911e+05  7.27998720e+07  7.04e+02 2.53e-01  6.14e+02     6s
   6  -6.23723203e+05  5.48013129e+07  3.42e+02 1.74e-01  3.51e+02     6s
   7  -5.30815397e+05  4.28812347e+07  1.08e+02 1.27e-01  1.90e+02     6s
   8  -4.65491104e+05  2.79673094e+07  4.65e+01 7.64e-02  1.09e+02     6s
   9  -2.81861067e+05  1.82583323e+07  2.03e+00 4.65e-02  5.91e+01     6s
  10  -2.25382944e+05  7.13845469e+06  1.14e+00 1.79e-02  2.34e+01     6s
  11  -2.05533341e+05  5.09324603e+06  9.84e-01 1.28e-02  1.68e+01     6s
  12  -1.25290166e+05  2.85949768e+06  5.04e-01 7.10e-03  9.44e+00     6s
  13  -9.04522950e+04  2.03150140e+06  2.81e-01 5.00e-03  6.71e+00     6s
  14  -4.50618759e+04  8.96103752e+05  9.33e-02 2.08e-03  2.97e+00     6s
  15  -1.94488207e+04  5.15645782e+05  5.13e-02 1.17e-03  1.69e+00     6s
  16   6.42716067e+03  3.32932176e+05  2.75e-02 1.14e-03  1.03e+00     6s
  17   1.77756133e+04  2.33606067e+05  2.06e-02 1.66e-03  6.81e-01     6s
  18   3.00616166e+04  1.80736407e+05  1.30e-02 1.26e-03  4.75e-01     7s
  19   3.61467002e+04  1.31430152e+05  1.02e-02 7.74e-04  3.01e-01     7s
  20   3.95753934e+04  1.17471384e+05  8.76e-03 6.27e-04  2.46e-01     7s
  21   4.57162770e+04  1.08094468e+05  6.20e-03 5.15e-04  1.97e-01     7s
  22   4.80746627e+04  9.94369387e+04  5.31e-03 4.12e-04  1.62e-01     7s
  23   5.03886374e+04  9.02269533e+04  4.53e-03 2.99e-04  1.26e-01     7s
  24   5.38274337e+04  8.81127657e+04  3.40e-03 2.72e-04  1.08e-01     7s
  25   5.68492872e+04  8.17813133e+04  2.50e-03 1.88e-04  7.87e-02     7s
  26   5.93725007e+04  7.87373365e+04  1.80e-03 1.50e-04  6.11e-02     7s
  27   6.10431975e+04  7.55444145e+04  1.37e-03 1.09e-04  4.58e-02     7s
  28   6.27160058e+04  7.32373700e+04  9.63e-04 7.97e-05  3.32e-02     7s
  29   6.36491377e+04  7.11536148e+04  7.50e-04 5.33e-05  2.37e-02     7s
  30   6.44361143e+04  6.98018036e+04  5.75e-04 3.44e-05  1.69e-02     8s
  31   6.53945112e+04  6.90938532e+04  3.73e-04 2.45e-05  1.17e-02     8s
  32   6.57348400e+04  6.84058626e+04  3.02e-04 1.50e-05  8.43e-03     8s
  33   6.58314889e+04  6.82833645e+04  2.83e-04 1.33e-05  7.74e-03     8s
  34   6.61233636e+04  6.78219686e+04  2.23e-04 7.01e-06  5.36e-03     8s
  35   6.67057281e+04  6.76282507e+04  1.06e-04 4.39e-06  2.91e-03     8s
  36   6.70221389e+04  6.74553241e+04  4.60e-05 2.09e-06  1.37e-03     8s
  37   6.71683175e+04  6.73631898e+04  1.82e-05 9.51e-07  6.15e-04     8s
  38   6.72072815e+04  6.73331215e+04  1.16e-05 6.02e-07  3.97e-04     8s
  39   6.72367581e+04  6.73210386e+04  6.76e-06 4.56e-07  2.66e-04     8s
  40   6.72519372e+04  6.73113458e+04  4.48e-06 3.39e-07  1.87e-04     8s
  41   6.72534708e+04  6.73085747e+04  4.25e-06 3.07e-07  1.74e-04     8s
  42   6.72541243e+04  6.73022392e+04  4.15e-06 2.35e-07  1.52e-04     8s
  43   6.72589202e+04  6.72996385e+04  3.43e-06 2.04e-07  1.28e-04     9s
  44   6.72613864e+04  6.72980543e+04  3.06e-06 1.85e-07  1.16e-04     9s
  45   6.72672916e+04  6.72975643e+04  2.10e-06 1.80e-07  9.55e-05     9s
  46   6.72709548e+04  6.72907265e+04  1.56e-06 9.97e-08  6.24e-05     9s
  47   6.72781323e+04  6.72863894e+04  4.31e-07 5.21e-08  2.61e-05     9s
  48   6.72792995e+04  6.72852889e+04  2.74e-07 4.00e-08  1.89e-05     9s
  49   6.72795091e+04  6.72835048e+04  2.49e-07 2.07e-08  1.26e-05     9s
  50   6.72802047e+04  6.72825007e+04  1.56e-07 9.60e-09  7.25e-06     9s
  51   6.72805472e+04  6.72816810e+04  1.15e-07 9.07e-10  3.58e-06     9s
  52   6.72807726e+04  6.72816348e+04  8.77e-08 6.35e-10  2.72e-06    10s
  53   6.72811018e+04  6.72816171e+04  4.89e-08 5.08e-10  1.63e-06    10s
  54   6.72814537e+04  6.72815503e+04  2.34e-08 1.90e-10  3.05e-07    10s
  55   6.72814536e+04  6.72815503e+04  3.79e-06 9.07e-09  3.05e-07    10s
  56   6.72815090e+04  6.72815496e+04  1.07e-06 2.15e-09  1.28e-07    10s
  57   6.72815438e+04  6.72815440e+04  1.81e-08 9.24e-10  5.08e-10    10s

Barrier solved model in 57 iterations and 10.00 seconds (18.55 work units)
Optimal objective 6.72815438e+04


Root crossover log...

  155061 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    8335 PPushes remaining with PInf 7.1418743e-05                15s
     415 PPushes remaining with PInf 1.5709691e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.9697596e+01     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   79169    6.7281544e+04   0.000000e+00   9.969760e+01     15s
   79234    6.7281544e+04   0.000000e+00   0.000000e+00     15s
   79234    6.7281544e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 1.30s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.728154e+04, 79234 iterations, 12.49 seconds (24.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67281.5440    0  171 -180179.68 67281.5440   137%     -   17s
H    0     0                    -178267.7634 67281.5440   138%     -   17s
H    0     0                    -173121.9517 67281.5440   139%     -   18s
H    0     0                    -65105.53679 67281.5440   203%     -   18s
H    0     0                    -3354.235208 67281.5440  2106%     -   18s
H    0     0                    4619.9076178 67281.5440  1356%     -   18s
H    0     0                    19499.251098 67281.5440   245%     -   19s
H    0     0                    19514.949893 67281.5440   245%     -   19s
H    0     0                    20963.631875 67281.5440   221%     -   19s
H    0     0                    21075.416346 67281.5440   219%     -   20s
H    0     0                    21167.213416 67281.5440   218%     -   20s
H    0     0                    21167.870340 67281.5440   218%     -   20s
H    0     0                    21263.939431 67281.5440   216%     -   20s
H    0     0                    21436.947182 67281.5440   214%     -   20s
H    0     0                    21439.894226 67281.5440   214%     -   20s
H    0     0                    21449.915162 67281.5440   214%     -   20s
H    0     0                    21456.486882 67281.5440   214%     -   20s
H    0     0                    21501.613076 67281.5440   213%     -   20s
     0     0 61392.6554    0  213 21501.6131 61392.6554   186%     -   87s
H    0     0                    21690.715159 61391.4758   183%     -   89s
     0     0 60781.6371    0  212 21690.7152 60781.6371   180%     -  122s
     0     0 60686.8351    0  222 21690.7152 60686.8351   180%     -  134s
     0     0 60644.5628    0  214 21690.7152 60644.5628   180%     -  142s
     0     0 60620.0751    0  224 21690.7152 60620.0751   179%     -  147s
     0     0 60597.6880    0  224 21690.7152 60597.6880   179%     -  152s
     0     0 60440.1023    0  233 21690.7152 60440.1023   179%     -  169s
     0     0 60424.4098    0  233 21690.7152 60424.4098   179%     -  172s
     0     0 60422.8708    0  233 21690.7152 60422.8708   179%     -  173s
     0     0 60415.9020    0  230 21690.7152 60415.9020   179%     -  177s
     0     0 60414.6315    0  234 21690.7152 60414.6315   179%     -  179s
     0     0 60414.5273    0  230 21690.7152 60414.5273   179%     -  179s
     0     0 57281.1098    0  279 21690.7152 57281.1098   164%     -  234s
H    0     0                    28096.164216 57280.9995   104%     -  234s
H    0     0                    28652.855260 57280.9995   100%     -  234s
H    0     0                    28928.366948 57280.9995  98.0%     -  234s
H    0     0                    29390.624776 57280.9995  94.9%     -  234s
H    0     0                    29493.364120 57280.9995  94.2%     -  234s
H    0     0                    29750.111118 57280.9995  92.5%     -  235s
H    0     0                    29773.737043 57280.9995  92.4%     -  235s
H    0     0                    29802.322637 57280.9995  92.2%     -  235s
     0     0 56927.6898    0  285 29802.3226 56927.6898  91.0%     -  267s
     0     0 56854.9500    0  287 29802.3226 56854.9500  90.8%     -  286s
     0     0 56766.7787    0  277 29802.3226 56766.7787  90.5%     -  300s
     0     0 56643.7564    0  281 29802.3226 56643.7564  90.1%     -  316s
     0     0 56597.6901    0  283 29802.3226 56597.6901  89.9%     -  326s
     0     0 56589.8280    0  278 29802.3226 56589.8280  89.9%     -  331s
     0     0 56577.1043    0  275 29802.3226 56577.1043  89.8%     -  336s
     0     0 56565.5607    0  284 29802.3226 56565.5607  89.8%     -  341s
     0     0 56525.8264    0  287 29802.3226 56525.8264  89.7%     -  352s
     0     0 56285.8784    0  301 29802.3226 56285.8784  88.9%     -  373s
     0     0 56266.3141    0  300 29802.3226 56266.3141  88.8%     -  380s
     0     0 56262.1262    0  297 29802.3226 56262.1262  88.8%     -  384s
     0     0 56214.8057    0  303 29802.3226 56214.8057  88.6%     -  393s
     0     0 56193.9332    0  298 29802.3226 56193.9332  88.6%     -  399s
     0     0 56187.4459    0  307 29802.3226 56187.4459  88.5%     -  403s
     0     0 56185.6811    0  302 29802.3226 56185.6811  88.5%     -  404s
     0     0 56184.4468    0  306 29802.3226 56184.4468  88.5%     -  406s
     0     0 54075.1573    0  327 29802.3226 54075.1573  81.4%     -  496s
H    0     0                    29847.213758 54074.9694  81.2%     -  498s
     0     0 53568.5790    0  332 29847.2138 53568.5790  79.5%     -  536s
     0     0 53362.2974    0  332 29847.2138 53362.2974  78.8%     -  557s
     0     0 53282.0019    0  346 29847.2138 53282.0019  78.5%     -  573s
     0     0 53255.3882    0  335 29847.2138 53255.3882  78.4%     -  580s
     0     0 53225.2023    0  351 29847.2138 53225.2023  78.3%     -  586s
     0     0 53190.7981    0  344 29847.2138 53190.7981  78.2%     -  593s
     0     0 53160.7900    0  357 29847.2138 53160.7900  78.1%     -  600s
     0     0 53148.8137    0  354 29847.2138 53148.8137  78.1%     -  607s
     0     0 53109.1144    0  354 29847.2138 53109.1144  77.9%     -  615s
     0     0 53096.3129    0  359 29847.2138 53096.3129  77.9%     -  621s
     0     0 53085.1742    0  358 29847.2138 53085.1742  77.9%     -  627s
     0     0 53078.1619    0  360 29847.2138 53078.1619  77.8%     -  632s
     0     0 53065.5151    0  359 29847.2138 53065.5151  77.8%     -  637s
     0     0 53052.8671    0  354 29847.2138 53052.8671  77.7%     -  642s
     0     0 53048.7782    0  352 29847.2138 53048.7782  77.7%     -  646s
     0     0 52989.9270    0  340 29847.2138 52989.9270  77.5%     -  660s
     0     0 52950.9649    0  383 29847.2138 52950.9649  77.4%     -  671s
     0     0 52941.6121    0  352 29847.2138 52941.6121  77.4%     -  677s
     0     0 52928.9000    0  386 29847.2138 52928.9000  77.3%     -  684s
     0     0 52923.1352    0  384 29847.2138 52923.1352  77.3%     -  688s
     0     0 52922.1740    0  384 29847.2138 52922.1740  77.3%     -  690s
     0     0 51839.4792    0  352 29847.2138 51839.4792  73.7%     -  769s
     0     0 51638.6568    0  356 29847.2138 51638.6568  73.0%     -  798s
     0     0 51530.4940    0  397 29847.2138 51530.4940  72.6%     -  814s
     0     0 51445.5508    0  408 29847.2138 51445.5508  72.4%     -  829s
     0     0 51374.5851    0  378 29847.2138 51374.5851  72.1%     -  842s
     0     0 51351.8369    0  371 29847.2138 51351.8369  72.0%     -  848s
     0     0 51299.7386    0  363 29847.2138 51299.7386  71.9%     -  856s
     0     0 51292.8991    0  369 29847.2138 51292.8991  71.9%     -  860s
     0     0 51289.6487    0  365 29847.2138 51289.6487  71.8%     -  862s
     0     0 51282.9210    0  371 29847.2138 51282.9210  71.8%     -  866s
     0     0 51259.5028    0  380 29847.2138 51259.5028  71.7%     -  872s
     0     0 51243.7903    0  374 29847.2138 51243.7903  71.7%     -  879s
     0     0 51233.5359    0  378 29847.2138 51233.5359  71.7%     -  884s
     0     0 51206.6616    0  387 29847.2138 51206.6616  71.6%     -  892s
     0     0 51184.9571    0  391 29847.2138 51184.9571  71.5%     -  899s
     0     0 51180.4323    0  427 29847.2138 51180.4323  71.5%     -  903s
     0     0 51176.7661    0  395 29847.2138 51176.7661  71.5%     -  906s
     0     0 51168.2033    0  389 29847.2138 51168.2033  71.4%     -  910s
     0     0 51146.3777    0  393 29847.2138 51146.3777  71.4%     -  915s
     0     0 51134.2837    0  393 29847.2138 51134.2837  71.3%     -  920s
     0     0 51126.1792    0  392 29847.2138 51126.1792  71.3%     -  921s
     0     0 51124.6576    0  398 29847.2138 51124.6576  71.3%     -  924s
     0     0 50866.8956    0  402 29847.2138 50866.8956  70.4%     -  950s
H    0     0                    29877.209083 50866.8754  70.3%     -  951s
     0     0 50836.3979    0  416 29877.2091 50836.3979  70.2%     -  964s
     0     0 50821.9118    0  417 29877.2091 50821.9118  70.1%     -  971s
     0     0 50802.6791    0  454 29877.2091 50802.6791  70.0%     -  981s
     0     0 50797.5763    0  451 29877.2091 50797.5763  70.0%     -  986s
     0     0 50790.3898    0  451 29877.2091 50790.3898  70.0%     -  991s
     0     0 50779.2601    0  493 29877.2091 50779.2601  70.0%     -  997s
     0     0 50774.5455    0  446 29877.2091 50774.5455  69.9%     -  999s
     0     0 50769.9173    0  449 29877.2091 50769.9173  69.9%     - 1000s
     0     0 50767.0076    0  455 29877.2091 50767.0076  69.9%     - 1003s
     0     0 50761.9732    0  454 29877.2091 50761.9732  69.9%     - 1004s
     0     0 50758.7313    0  457 29877.2091 50758.7313  69.9%     - 1006s
     0     0 50758.4916    0  456 29877.2091 50758.4916  69.9%     - 1006s
     0     0 50726.9158    0  466 29877.2091 50726.9158  69.8%     - 1020s
     0     0 50718.7350    0  418 29877.2091 50718.7350  69.8%     - 1027s
     0     0 50716.8718    0  413 29877.2091 50716.8718  69.8%     - 1029s
     0     0 50705.0635    0  413 29877.2091 50705.0635  69.7%     - 1035s
     0     0 50701.4452    0  424 29877.2091 50701.4452  69.7%     - 1039s
     0     0 50699.7351    0  422 29877.2091 50699.7351  69.7%     - 1041s
     0     0 50687.0210    0  409 29877.2091 50687.0210  69.7%     - 1047s
     0     0 50675.3901    0  414 29877.2091 50675.3901  69.6%     - 1051s
     0     0 50663.7893    0  405 29877.2091 50663.7893  69.6%     - 1056s
     0     0 50660.7497    0  400 29877.2091 50660.7497  69.6%     - 1058s
     0     0 50659.1737    0  401 29877.2091 50659.1737  69.6%     - 1061s
     0     0 50603.4111    0  404 29877.2091 50603.4111  69.4%     - 1072s
     0     0 50600.7108    0  411 29877.2091 50600.7108  69.4%     - 1076s
     0     0 50598.8080    0  404 29877.2091 50598.8080  69.4%     - 1078s
     0     0 50545.1404    0  411 29877.2091 50545.1404  69.2%     - 1091s
     0     0 50538.3435    0  428 29877.2091 50538.3435  69.2%     - 1096s
     0     0 50537.4795    0  428 29877.2091 50537.4795  69.2%     - 1097s
     0     0 50520.1908    0  419 29877.2091 50520.1908  69.1%     - 1107s
     0     0 50507.8174    0  410 29877.2091 50507.8174  69.1%     - 1116s
     0     0 50505.5157    0  415 29877.2091 50505.5157  69.0%     - 1119s
     0     0 50497.9923    0  420 29877.2091 50497.9923  69.0%     - 1126s
     0     0 50494.7133    0  427 29877.2091 50494.7133  69.0%     - 1131s
     0     0 50493.6943    0  434 29877.2091 50493.6943  69.0%     - 1133s
     0     0 50474.8661    0  418 29877.2091 50474.8661  68.9%     - 1142s
     0     0 50466.5355    0  385 29877.2091 50466.5355  68.9%     - 1147s
     0     0 50463.9652    0  387 29877.2091 50463.9652  68.9%     - 1150s
     0     0 50463.0424    0  384 29877.2091 50463.0424  68.9%     - 1153s
     0     0 50458.0313    0  384 29877.2091 50458.0313  68.9%     - 1157s
     0     0 50457.7130    0  384 29877.2091 50457.7130  68.9%     - 1162s
H    0     0                    29878.793107 50457.5942  68.9%     - 1413s
H    0     0                    29885.446014 50457.5942  68.8%     - 1413s
H    0     0                    29924.360688 50457.5942  68.6%     - 1425s
     0     2 50457.5942    0  384 29924.3607 50457.5942  68.6%     - 1431s
     1     3 50169.1023    1  350 29924.3607 50457.5942  68.6% 14499 1449s
     2     4 50349.6866    1  430 29924.3607 50349.6866  68.3% 13864 1465s
     3     6 50244.6240    2  382 29924.3607 50349.5905  68.3% 11208 1490s
     5    10 50035.0907    3  405 29924.3607 50349.5905  68.3% 13684 1570s
     9    18 49917.0698    4  366 29924.3607 50227.3661  67.8% 17769 1609s
    17    36 49805.3348    5  372 29924.3607 50227.3661  67.8% 17842 1654s
    35    50 49440.1711    6  384 29924.3607 49902.7211  66.8% 26112 1751s
    49    74 46920.9550    7  362 29924.3607 49902.7211  66.8% 29438 1820s
H   58    74                    29957.388291 49902.7211  66.6% 28314 1820s
    73   166 46694.1430    8  351 29957.3883 49902.7211  66.6% 25160 1918s
   165   240 46036.9004   11  349 29957.3883 49902.7211  66.6% 18230 1970s
H  181   240                    29974.656587 49902.7211  66.5% 17471 1970s
H  210   240                    29984.599262 49902.7211  66.4% 16159 1970s
H  227   240                    30009.923893 49902.7211  66.3% 15583 1970s
   239   293 45854.1514   13  325 30009.9239 49902.7211  66.3% 15246 2012s
   292   319 44969.7458   15  327 30009.9239 49902.7211  66.3% 13789 2046s
H  303   319                    30151.942462 49902.7211  65.5% 13553 2046s
H  312   319                    30203.478333 49902.7211  65.2% 13316 2046s
   318   347 44864.3003   16  323 30203.4783 49902.7211  65.2% 13170 2082s
H  319   347                    30354.255027 49902.7211  64.4% 13129 2082s
H  325   347                    30494.653704 49902.7211  63.6% 13044 2082s
   346   375 45193.4456   14  318 30494.6537 49902.7211  63.6% 12794 2121s
   374   406 44721.1734   17  324 30494.6537 49902.7211  63.6% 12396 2157s
H  378   406                    30571.971461 49902.7211  63.2% 12350 2157s
H  391   406                    30897.957057 49902.7211  61.5% 12140 2157s
   405   469 44308.1720   18  321 30897.9571 49902.7211  61.5% 12027 2195s
H  468   512                    31230.106253 49902.7211  59.8% 11871 2231s
H  471   512                    31278.407262 49902.7211  59.5% 11876 2231s
H  480   512                    31341.689398 49902.7211  59.2% 11788 2231s
H  494   512                    31417.229056 49902.7211  58.8% 11641 2231s
H  501   512                    31492.567083 49902.7211  58.5% 11626 2231s
   511   578 43151.5747   21  334 31492.5671 49902.7211  58.5% 11554 2270s
   577   648 42865.2004   22  363 31492.5671 49902.7211  58.5% 10943 2312s
   647   701 42502.0709   25  344 31492.5671 49902.7211  58.5% 10441 2344s
H  700   755                    31557.566554 49902.7211  58.1% 10022 2382s
H  728   755                    31637.635657 49902.7211  57.7%  9823 2382s
H  729   755                    31659.826585 49902.7211  57.6%  9813 2382s
   754   804 43693.6347   21  384 31659.8266 49902.7211  57.6%  9703 2419s
   805   860 42636.3392   25  351 31659.8266 49902.7211  57.6%  9472 2454s
   863   907 41406.9688   27  282 31659.8266 49902.7211  57.6%  9239 2491s
   914   979 40911.8902   28  308 31659.8266 49902.7211  57.6%  9042 2528s
   990  1064 40905.6587   29  332 31659.8266 49902.7211  57.6%  8807 2563s
H 1033  1064                    32194.028739 49902.7211  55.0%  8668 2563s
  1075  1172 39487.5799   32  306 32194.0287 49902.7211  55.0%  8565 2598s
  1193  1201 39279.5201   34  268 32194.0287 49902.7211  55.0%  8147 2633s
  1222  1233 infeasible   35      32194.0287 49902.7211  55.0%  8099 2668s
  1256  1267 38345.9227   36  249 32194.0287 49902.7211  55.0%  8036 2699s
H 1260  1267                    32578.112186 49902.7211  53.2%  8028 2699s
  1292  1294 38127.1012   37  275 32578.1122 49902.7211  53.2%  7973 2736s
  1325  1326 38106.4174   38  270 32578.1122 49902.7211  53.2%  7926 2789s
H 1337  1326                    32795.392997 49902.7211  52.2%  7889 2789s
H 1342  1326                    33152.896483 49902.7211  50.5%  7881 2789s
  1367  1478 38052.5573   39  291 33152.8965 49902.7211  50.5%  7835 2853s
  1545  1612 33568.6916   42  181 33152.8965 49902.7211  50.5%  7339 2899s
  1730  1756 33336.8502   45  179 33152.8965 49902.7211  50.5%  6920 2948s
  1922  1888 35370.9800   91  215 33152.8965 49902.7211  50.5%  6569 2991s
  2147  1953 33863.6404  103  190 33152.8965 49902.7211  50.5%  6222 3039s
  2351  1966 33372.5200  110  148 33152.8965 49902.7211  50.5%  5946 3082s
  2394  1977     cutoff  111      33152.8965 49902.7211  50.5%  6001 3128s
  2437  2000     cutoff  111      33152.8965 49902.7211  50.5%  6025 3173s
  2495  2059 infeasible   91      33152.8965 49805.1764  50.2%  6041 3222s
H 2519  2059                    33156.560115 49805.1764  50.2%  6020 3222s
  2592  2093 36809.3265   52  182 33156.5601 49805.1764  50.2%  5997 3281s
  2704  2156 infeasible   45      33156.5601 49477.6560  49.2%  5995 3343s
  2789  2259 49393.1685    7  380 33156.5601 49477.4186  49.2%  6077 3406s
  2914  2372 48485.5450    8  366 33156.5601 49477.4186  49.2%  6079 3468s
  3051  2497 47475.2612    9  418 33156.5601 49477.4186  49.2%  6061 3537s
  3192  2633 47704.5263   10  339 33156.5601 49477.4186  49.2%  6062 3600s

Cutting planes:
  Learned: 1
  Gomory: 17
  Implied bound: 265
  MIR: 4396
  Flow cover: 4024
  RLT: 71
  Relax-and-lift: 568

Explored 3382 nodes (21151579 simplex iterations) in 3600.05 seconds (8939.51 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 33156.6 33152.9 32795.4 ... 31417.2

Time limit reached
Best objective 3.315656011511e+04, best bound 4.947741861576e+04, gap 49.2236%
  WARNING: Time limit reached. Using best solution found (gap: 49.22%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 33156.56, θ = 185639.66
  Upper Bound (UB) = 33156.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 185639.66
  [DEBUG]   ✓ Scenario 0: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 185639.66 ≤ Q = 185672.27 (slack: 32.61)
  [DEBUG]   ✓ Scenario 2: θ = 185639.66 ≤ Q = 186124.66 (slack: 485.00)
  [DEBUG]   ✓ Scenario 3: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 185639.66 ≤ Q = 185639.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 185639.66 ≤ Q = 185639.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2b5ed180
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd4a12e80
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.402109e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 7037190.2074
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.527666e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152766.62    0  123 7037190.21 -152766.62   102%     -    0s
H    0     0                    -118366.7284 -152766.62  29.1%     -    0s
H    0     0                    -119361.3028 -152766.62  28.0%     -    0s
     0     0 -130674.72    0   65 -119361.30 -130674.72  9.48%     -    0s
H    0     0                    -127923.9978 -130543.67  2.05%     -    0s
     0     0 -129380.84    0   65 -127924.00 -129380.84  1.14%     -    0s
H    0     0                    -128663.8123 -129348.20  0.53%     -    0s
     0     0 -129033.48    0   29 -128663.81 -129033.48  0.29%     -    0s
     0     0 -128983.70    0   38 -128663.81 -128983.70  0.25%     -    0s
     0     0 -128980.76    0   35 -128663.81 -128980.76  0.25%     -    0s
     0     0 -128980.36    0   33 -128663.81 -128980.36  0.25%     -    0s
     0     0 -128888.15    0   24 -128663.81 -128888.15  0.17%     -    0s
     0     0 -128869.46    0   24 -128663.81 -128869.46  0.16%     -    0s
     0     0 -128838.22    0   24 -128663.81 -128838.22  0.14%     -    0s
     0     0 -128830.27    0   24 -128663.81 -128830.27  0.13%     -    0s
     0     0 -128828.23    0   72 -128663.81 -128828.23  0.13%     -    0s
     0     0 -128828.23    0   32 -128663.81 -128828.23  0.13%     -    0s
     0     0 -128749.09    0   18 -128663.81 -128749.09  0.07%     -    0s
     0     0 -128689.15    0    3 -128663.81 -128689.15  0.02%     -    0s
     0     0          -    0      -128663.81 -128672.30  0.01%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 15
  MIR: 61
  Flow cover: 5
  RLT: 1

Explored 1 nodes (868 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -128664 -128084 -127924 ... 1.40211e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.286638122714e+05, best bound -1.286722981655e+05, gap 0.0066%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 178300.76
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128663.81
  [DEBUG]   S×d_nominal = 306964.57
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 306964.57 + -128663.81 = 178300.76
  [DEBUG]   Current θ from Master = 185639.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7338.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25817.65
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 2793.7476, Absolute Gap = 2793.7476, Relative Gap = 0.084259
  Not converged yet (gap = 2793.75 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956601 nonzeros
Model fingerprint: 0x86c58e3f
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 155540 rows and 63140 columns
Presolve time: 3.75s
Presolved: 182223 rows, 76400 columns, 1121946 nonzeros
Variable types: 74141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.46s

Barrier statistics:
 Dense cols : 1149
 AA' NZ     : 4.734e+06
 Factor NZ  : 1.330e+07 (roughly 200 MB of memory)
 Factor Ops : 4.653e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.01087252e+07  3.23712059e+08  1.49e+05 1.32e+01  9.35e+04     6s
   1  -1.56753446e+07  3.03569701e+08  1.05e+05 7.58e+01  6.58e+04     6s
   2  -6.89902022e+06  2.29103864e+08  4.52e+04 4.49e+00  3.01e+04     6s
   3  -1.63122847e+06  2.03485302e+08  6.39e+03 1.82e+00  4.72e+03     6s
   4  -7.49923417e+05  1.18258823e+08  1.02e+03 4.37e-01  9.65e+02     6s
   5  -5.27776387e+05  6.79012995e+07  4.62e+02 1.89e-01  4.56e+02     6s
   6  -4.47563723e+05  5.29034202e+07  2.15e+02 1.33e-01  2.71e+02     6s
   7  -4.05882525e+05  3.97078759e+07  9.33e+01 9.34e-02  1.65e+02     6s
   8  -3.78739649e+05  2.83936780e+07  5.18e+01 6.38e-02  1.08e+02     6s
   9  -2.79020407e+05  2.04922498e+07  9.14e+00 4.45e-02  6.57e+01     7s
  10  -1.93992489e+05  1.14380788e+07  3.60e+00 2.42e-02  3.58e+01     7s
  11  -1.45905914e+05  4.86828423e+06  2.17e+00 1.00e-02  1.53e+01     7s
  12  -1.08371994e+05  3.79402968e+06  1.40e+00 7.75e-03  1.19e+01     7s
  13  -9.93239575e+04  2.61945064e+06  1.18e+00 5.32e-03  8.26e+00     7s
  14  -5.84038654e+04  1.92221712e+06  4.45e-01 3.83e-03  5.99e+00     7s
  15  -3.95780744e+04  7.86350596e+05  2.50e-01 1.51e-03  2.49e+00     7s
  16  -1.06935760e+04  3.00103841e+05  1.24e-01 9.02e-04  9.38e-01     7s
  17   6.05056895e+03  2.23119952e+05  8.32e-02 1.48e-03  6.55e-01     7s
  18   2.38197278e+04  1.65418883e+05  5.50e-02 2.44e-03  4.27e-01     7s
  19   3.15641920e+04  1.30797358e+05  4.33e-02 2.07e-03  2.99e-01     7s
  20   3.55404121e+04  1.09779927e+05  3.74e-02 1.53e-03  2.24e-01     7s
  21   3.86028764e+04  1.06991877e+05  3.30e-02 1.44e-03  2.06e-01     7s
  22   4.19821888e+04  1.00643147e+05  2.84e-02 1.25e-03  1.77e-01     7s
  23   4.42122217e+04  9.32453633e+04  2.52e-02 1.06e-03  1.48e-01     7s
  24   4.79890402e+04  9.02541598e+04  2.04e-02 9.43e-04  1.28e-01     8s
  25   5.14261248e+04  8.77469478e+04  1.60e-02 8.35e-04  1.10e-01     8s
  26   5.25612797e+04  8.45739699e+04  1.47e-02 7.58e-04  9.66e-02     8s
  27   5.39946452e+04  8.08762283e+04  1.30e-02 6.22e-04  8.11e-02     8s
  28   5.72170381e+04  7.80888449e+04  9.38e-03 5.12e-04  6.30e-02     8s
  29   5.87375351e+04  7.62706183e+04  7.77e-03 4.26e-04  5.29e-02     8s
  30   6.08266495e+04  7.49816759e+04  5.66e-03 3.66e-04  4.27e-02     8s
  31   6.24556545e+04  7.34398820e+04  4.06e-03 2.92e-04  3.31e-02     8s
  32   6.30902333e+04  7.06722677e+04  3.46e-03 1.78e-04  2.29e-02     8s
  33   6.39706128e+04  6.99385100e+04  2.67e-03 1.39e-04  1.80e-02     8s
  34   6.50611833e+04  6.95830032e+04  1.76e-03 1.22e-04  1.36e-02     8s
  35   6.52921881e+04  6.93325176e+04  1.56e-03 1.10e-04  1.22e-02     9s
  36   6.54713099e+04  6.87671800e+04  1.41e-03 8.08e-05  9.94e-03     9s
  37   6.59385793e+04  6.84208011e+04  1.02e-03 6.24e-05  7.49e-03     9s
  38   6.60662289e+04  6.82782841e+04  9.16e-04 5.52e-05  6.67e-03     9s
  39   6.65177244e+04  6.79401568e+04  5.41e-04 3.72e-05  4.29e-03     9s
  40   6.67707652e+04  6.76092051e+04  3.47e-04 1.95e-05  2.53e-03     9s
  41   6.69581837e+04  6.74454597e+04  1.91e-04 1.09e-05  1.47e-03     9s
  42   6.70933868e+04  6.73832514e+04  9.17e-05 7.70e-06  8.74e-04     9s
  43   6.71501734e+04  6.73303114e+04  5.13e-05 5.00e-06  5.43e-04     9s
  44   6.71678171e+04  6.72916520e+04  3.96e-05 3.11e-06  3.73e-04     9s
  45   6.71843233e+04  6.72861800e+04  2.78e-05 2.84e-06  3.07e-04     9s
  46   6.71998473e+04  6.72516064e+04  1.74e-05 1.39e-06  1.56e-04    10s
  47   6.72073844e+04  6.72423047e+04  1.22e-05 8.44e-07  1.05e-04    10s
  48   6.72146602e+04  6.72343449e+04  7.79e-06 3.72e-07  5.94e-05    10s
  49   6.72226938e+04  6.72318082e+04  2.85e-06 2.30e-07  2.75e-05    10s
  50   6.72240965e+04  6.72301242e+04  2.00e-06 1.35e-07  1.82e-05    10s
  51   6.72250945e+04  6.72296752e+04  1.41e-06 1.11e-07  1.38e-05    10s
  52   6.72251872e+04  6.72285152e+04  1.35e-06 1.39e-07  1.00e-05    10s
  53   6.72265671e+04  6.72282064e+04  5.71e-07 9.87e-08  4.94e-06    10s
  54   6.72268858e+04  6.72276859e+04  3.94e-07 2.09e-08  2.42e-06    10s
  55   6.72275725e+04  6.72276296e+04  3.37e-08 5.61e-08  1.73e-07    10s
  56   6.72276229e+04  6.72276235e+04  6.01e-09 1.30e-09  1.70e-09    10s

Barrier solved model in 56 iterations and 10.47 seconds (18.28 work units)
Optimal objective 6.72276229e+04


Root crossover log...

  162746 DPushes remaining with DInf 0.0000000e+00                11s
   24756 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

   28584 PPushes remaining with PInf 1.6247941e-04                18s
       0 PPushes remaining with PInf 3.1246689e-07                20s

  Push phase complete: Pinf 3.1246689e-07, Dinf 1.3158642e+06     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  113728    6.7227623e+04   0.000000e+00   1.315864e+06     20s
  114472    6.7227623e+04   0.000000e+00   0.000000e+00     21s
  114472    6.7227623e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 3.37s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.722762e+04, 114472 iterations, 19.91 seconds (37.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67227.6235    0  158 -180179.68 67227.6235   137%     -   25s
H    0     0                    -175941.3672 67227.6235   138%     -   25s
H    0     0                    -64929.72380 67227.6235   204%     -   25s
H    0     0                    2206.5989243 67227.6235  2947%     -   26s
H    0     0                    8569.8462685 67227.6235   684%     -   26s
H    0     0                    11456.622064 67227.6235   487%     -   26s
H    0     0                    20377.065698 67227.6235   230%     -   27s
H    0     0                    20592.275896 67227.6235   226%     -   27s
H    0     0                    20662.326964 67227.6235   225%     -   27s
H    0     0                    20712.250662 67227.6235   225%     -   27s
H    0     0                    20733.784848 67227.6235   224%     -   27s
H    0     0                    20860.598984 67227.6235   222%     -   27s
H    0     0                    20868.409810 67227.6235   222%     -   27s
H    0     0                    20870.369371 67227.6235   222%     -   27s
     0     0 61740.2579    0  199 20870.3694 61740.2579   196%     -   93s
H    0     0                    20998.185124 61740.2159   194%     -   94s
H    0     0                    21063.569667 61740.2159   193%     -   94s
     0     0 61418.4039    0  204 21063.5697 61418.4039   192%     -  111s
     0     0 61325.3206    0  213 21063.5697 61325.3206   191%     -  118s
     0     0 61303.0218    0  223 21063.5697 61303.0218   191%     -  123s
     0     0 61300.1372    0  233 21063.5697 61300.1372   191%     -  128s
     0     0 60948.2362    0  217 21063.5697 60948.2362   189%     -  145s
     0     0 60850.2047    0  220 21063.5697 60850.2047   189%     -  155s
     0     0 60789.1954    0  223 21063.5697 60789.1954   189%     -  161s
     0     0 60759.5572    0  220 21063.5697 60759.5572   188%     -  165s
     0     0 60672.1104    0  217 21063.5697 60672.1104   188%     -  175s
     0     0 60668.3797    0  226 21063.5697 60668.3797   188%     -  178s
     0     0 60668.2012    0  226 21063.5697 60668.2012   188%     -  179s
     0     0 57549.5674    0  273 21063.5697 57549.5674   173%     -  250s
H    0     0                    21181.249838 57549.1704   172%     -  251s
H    0     0                    21311.470929 57549.1704   170%     -  251s
H    0     0                    21313.488151 57549.1704   170%     -  251s
H    0     0                    21543.752388 57549.1704   167%     -  251s
     0     0 57025.0662    0  264 21543.7524 57025.0662   165%     -  280s
     0     0 56954.3962    0  264 21543.7524 56954.3962   164%     -  288s
     0     0 56859.5365    0  277 21543.7524 56859.5365   164%     -  301s
     0     0 56813.9979    0  287 21543.7524 56813.9979   164%     -  314s
     0     0 56793.5697    0  278 21543.7524 56793.5697   164%     -  323s
     0     0 56782.2933    0  281 21543.7524 56782.2933   164%     -  327s
     0     0 56776.4208    0  277 21543.7524 56776.4208   164%     -  329s
     0     0 56722.9259    0  274 21543.7524 56722.9259   163%     -  337s
     0     0 56621.1238    0  288 21543.7524 56621.1238   163%     -  351s
     0     0 56553.3411    0  280 21543.7524 56553.3411   163%     -  362s
     0     0 56435.7397    0  281 21543.7524 56435.7397   162%     -  378s
     0     0 56141.8627    0  318 21543.7524 56141.8627   161%     -  397s
     0     0 56110.7040    0  316 21543.7524 56110.7040   160%     -  405s
     0     0 56106.0553    0  318 21543.7524 56106.0553   160%     -  407s
     0     0 56098.5478    0  317 21543.7524 56098.5478   160%     -  410s
     0     0 56072.6837    0  290 21543.7524 56072.6837   160%     -  414s
     0     0 56051.3990    0  326 21543.7524 56051.3990   160%     -  421s
     0     0 56044.9991    0  301 21543.7524 56044.9991   160%     -  426s
     0     0 56044.7217    0  330 21543.7524 56044.7217   160%     -  428s
     0     0 53785.0019    0  323 21543.7524 53785.0019   150%     -  517s
     0     0 53784.8527    0  354 21543.7524 53784.8527   150%     -  518s
H    0     0                    21672.405446 53782.7831   148%     -  520s
H    0     0                    21761.548457 53782.7831   147%     -  520s
H    0     0                    21874.859884 53782.7831   146%     -  520s
H    0     0                    22080.973904 53782.7831   144%     -  520s
     0     0 53100.2558    0  335 22080.9739 53100.2558   140%     -  555s
     0     0 52948.6757    0  352 22080.9739 52948.6757   140%     -  580s
     0     0 52880.8824    0  344 22080.9739 52880.8824   139%     -  594s
     0     0 52783.8158    0  347 22080.9739 52783.8158   139%     -  613s
     0     0 52731.0623    0  368 22080.9739 52731.0623   139%     -  631s
     0     0 52706.0052    0  356 22080.9739 52706.0052   139%     -  638s
     0     0 52686.4748    0  376 22080.9739 52686.4748   139%     -  648s
     0     0 52672.0322    0  371 22080.9739 52672.0322   139%     -  656s
     0     0 52630.8991    0  368 22080.9739 52630.8991   138%     -  666s
     0     0 52610.5712    0  360 22080.9739 52610.5712   138%     -  674s
     0     0 52604.1762    0  356 22080.9739 52604.1762   138%     -  679s
     0     0 52597.1632    0  363 22080.9739 52597.1632   138%     -  683s
     0     0 52593.4336    0  376 22080.9739 52593.4336   138%     -  688s
     0     0 52589.2102    0  353 22080.9739 52589.2102   138%     -  694s
     0     0 52584.0305    0  375 22080.9739 52584.0305   138%     -  700s
     0     0 52580.9906    0  368 22080.9739 52580.9906   138%     -  705s
     0     0 52578.9447    0  358 22080.9739 52578.9447   138%     -  708s
     0     0 52575.6093    0  368 22080.9739 52575.6093   138%     -  714s
     0     0 52574.6541    0  356 22080.9739 52574.6541   138%     -  716s
     0     0 51773.3768    0  365 22080.9739 51773.3768   134%     -  780s
H    0     0                    23106.639027 51773.3069   124%     -  782s
H    0     0                    23197.234042 51773.3069   123%     -  783s
H    0     0                    23237.956046 51773.3069   123%     -  783s
H    0     0                    23252.079062 51773.3069   123%     -  783s
     0     0 51630.6901    0  381 23252.0791 51630.6901   122%     -  811s
     0     0 51579.4019    0  377 23252.0791 51579.4019   122%     -  820s
     0     0 51534.8393    0  390 23252.0791 51534.8393   122%     -  830s
     0     0 51505.0760    0  384 23252.0791 51505.0760   122%     -  841s
     0     0 51484.1806    0  388 23252.0791 51484.1806   121%     -  851s
     0     0 51463.4213    0  378 23252.0791 51463.4213   121%     -  858s
     0     0 51447.2345    0  386 23252.0791 51447.2345   121%     -  865s
     0     0 51425.9045    0  387 23252.0791 51425.9045   121%     -  871s
     0     0 51413.7367    0  387 23252.0791 51413.7367   121%     -  878s
     0     0 51393.1950    0  389 23252.0791 51393.1950   121%     -  885s
     0     0 51370.0619    0  380 23252.0791 51370.0619   121%     -  892s
     0     0 51367.6542    0  390 23252.0791 51367.6542   121%     -  895s
     0     0 51365.7962    0  386 23252.0791 51365.7962   121%     -  897s
     0     0 51079.4878    0  384 23252.0791 51079.4878   120%     -  931s
     0     0 51010.2995    0  426 23252.0791 51010.2995   119%     -  947s
     0     0 50969.6415    0  423 23252.0791 50969.6415   119%     -  960s
     0     0 50952.9501    0  396 23252.0791 50952.9501   119%     -  966s
     0     0 50944.8320    0  397 23252.0791 50944.8320   119%     -  970s
     0     0 50932.0243    0  395 23252.0791 50932.0243   119%     -  973s
     0     0 50888.1421    0  389 23252.0791 50888.1421   119%     -  980s
     0     0 50853.2146    0  401 23252.0791 50853.2146   119%     -  989s
     0     0 50827.0458    0  390 23252.0791 50827.0458   119%     -  996s
     0     0 50821.4431    0  394 23252.0791 50821.4431   119%     - 1000s
     0     0 50811.3262    0  393 23252.0791 50811.3262   119%     - 1006s
     0     0 50808.7493    0  392 23252.0791 50808.7493   119%     - 1010s
     0     0 50806.0312    0  409 23252.0791 50806.0312   119%     - 1014s
     0     0 50795.1226    0  400 23252.0791 50795.1226   118%     - 1020s
     0     0 50793.3145    0  430 23252.0791 50793.3145   118%     - 1023s
     0     0 50686.7980    0  376 23252.0791 50686.7980   118%     - 1038s
     0     0 50655.2720    0  398 23252.0791 50655.2720   118%     - 1048s
     0     0 50643.5930    0  378 23252.0791 50643.5930   118%     - 1051s
     0     0 50637.8726    0  383 23252.0791 50637.8726   118%     - 1054s
     0     0 50633.2357    0  413 23252.0791 50633.2357   118%     - 1057s
     0     0 50625.6893    0  408 23252.0791 50625.6893   118%     - 1064s
     0     0 50623.0242    0  379 23252.0791 50623.0242   118%     - 1066s
     0     0 50620.3911    0  378 23252.0791 50620.3911   118%     - 1069s
     0     0 50618.0967    0  453 23252.0791 50618.0967   118%     - 1072s
     0     0 50560.4826    0  384 23252.0791 50560.4826   117%     - 1088s
     0     0 50546.6182    0  415 23252.0791 50546.6182   117%     - 1097s
     0     0 50542.3986    0  380 23252.0791 50542.3986   117%     - 1101s
     0     0 50541.1265    0  381 23252.0791 50541.1265   117%     - 1103s
     0     0 50527.2983    0  369 23252.0791 50527.2983   117%     - 1112s
H    0     0                    28213.370496 50526.9996  79.1%     - 1113s
H    0     0                    29809.219048 50526.9996  69.5%     - 1113s
H    0     0                    29836.309254 50526.9996  69.3%     - 1114s
H    0     0                    29902.329399 50526.9996  69.0%     - 1114s
     0     0 50519.6514    0  372 29902.3294 50519.6514  68.9%     - 1118s
     0     0 50516.8374    0  380 29902.3294 50516.8374  68.9%     - 1121s
     0     0 50515.6939    0  373 29902.3294 50515.6939  68.9%     - 1122s
     0     0 50502.4747    0  375 29902.3294 50502.4747  68.9%     - 1129s
     0     0 50499.0269    0  368 29902.3294 50499.0269  68.9%     - 1136s
     0     0 50497.5106    0  416 29902.3294 50497.5106  68.9%     - 1138s
     0     0 50487.5780    0  368 29902.3294 50487.5780  68.8%     - 1147s
H    0     0                    29950.225949 50486.9647  68.6%     - 1150s
     0     0 50485.2109    0  422 29950.2259 50485.2109  68.6%     - 1154s
     0     0 50465.4574    0  383 29950.2259 50465.4574  68.5%     - 1163s
     0     0 50456.2938    0  386 29950.2259 50456.2938  68.5%     - 1168s
     0     0 50451.2041    0  383 29950.2259 50451.2041  68.5%     - 1171s
     0     0 50445.9316    0  387 29950.2259 50445.9316  68.4%     - 1173s
     0     0 50445.2025    0  392 29950.2259 50445.2025  68.4%     - 1175s
     0     0 50435.8170    0  379 29950.2259 50435.8170  68.4%     - 1179s
H    0     0                    30060.584999 50435.6841  67.8%     - 1184s
     0     0 50433.7455    0  370 30060.5850 50433.7455  67.8%     - 1188s
     0     0 50425.9709    0  378 30060.5850 50425.9709  67.7%     - 1195s
     0     0 50420.6994    0  389 30060.5850 50420.6994  67.7%     - 1200s
     0     0 50419.5579    0  392 30060.5850 50419.5579  67.7%     - 1201s
     0     0 50415.2446    0  414 30060.5850 50415.2446  67.7%     - 1208s
     0     0 50413.7975    0  413 30060.5850 50413.7975  67.7%     - 1212s
     0     0 50411.5592    0  424 30060.5850 50411.5592  67.7%     - 1216s
     0     0 50411.4400    0  424 30060.5850 50411.4400  67.7%     - 1222s
H    0     0                    30098.150914 50411.2877  67.5%     - 1309s
H    0     0                    30294.922980 50411.2877  66.4%     - 1430s
     0     2 50411.2877    0  424 30294.9230 50411.2877  66.4%     - 1433s
     1     3 50107.1052    1  360 30294.9230 50411.2877  66.4% 13162 1450s
     2     4 50367.9059    1  362 30294.9230 50367.9059  66.3%  8815 1461s
     3     5 49719.9170    2  366 30294.9230 50367.6482  66.3%  9033 1478s
     4     9 49822.9891    2  397 30294.9230 50366.2860  66.3%  9416 1498s
     8    14 50188.7008    3  358 30294.9230 50229.0623  65.8%  9391 1546s
    13    28 49522.2964    4  398 30294.9230 50229.0623  65.8% 18745 1586s
    27    42 49285.8681    5  397 30294.9230 50064.2343  65.3% 26597 1740s
    41    73 47055.3394    6  392 30294.9230 50064.2343  65.3% 25187 1918s
H   42    73                    30466.993114 50064.2343  64.3% 24588 1918s
H   43    73                    30493.176353 50064.2343  64.2% 24574 1918s
H   44    73                    30503.073961 50064.2343  64.1% 24371 1918s
H   49    73                    30522.016885 50064.2343  64.0% 23978 1918s
H   56    73                    30526.169850 50064.2343  64.0% 22602 1918s
    72   104 46946.4904    7  362 30526.1698 49810.5744  63.2% 24250 2085s
   103   228 46816.9305    8  358 30526.1698 49810.5744  63.2% 22593 2182s
   227   319 46162.3726   12  323 30526.1698 49810.5744  63.2% 14670 2233s
   318   379 45699.1255   14  326 30526.1698 49810.5744  63.2% 12201 2276s
   378   440 45541.2929   15  322 30526.1698 49810.5744  63.2% 11188 2317s
   439   497 44944.3669   17  321 30526.1698 49810.5744  63.2% 10594 2354s
   496   572 44395.8424   20  315 30526.1698 49810.5744  63.2%  9997 2392s
   571   600 44343.8203   22  298 30526.1698 49810.5744  63.2%  9336 2421s
   599   628 43512.7337   23  305 30526.1698 49810.5744  63.2%  9193 2451s
   627   655 43108.5049   24  305 30526.1698 49810.5744  63.2%  9156 2479s
   654   686 43087.2898   25  303 30526.1698 49810.5744  63.2%  9034 2509s
H  672   686                    30534.729493 49810.5744  63.1%  9017 2509s
H  678   686                    30640.639162 49810.5744  62.6%  9001 2509s
H  679   686                    30718.581593 49810.5744  62.2%  8995 2509s
   685   715 42855.5000   26  299 30718.5816 49810.5744  62.2%  8954 2538s
H  690   715                    30795.317061 49810.5744  61.7%  8919 2538s
H  714   770                    30804.735507 49810.5744  61.7%  8813 2571s
H  717   770                    30820.095066 49810.5744  61.6%  8792 2571s
   771   827 41845.4228   30  263 30820.0951 49724.5436  61.3%  8567 2604s
   840   853 41393.1012   34  253 30820.0951 49724.5436  61.3%  8251 2634s
   866   881 39379.7308   35  214 30820.0951 49724.5436  61.3%  8155 2664s
H  879   881                    30847.864035 49724.5436  61.2%  8120 2664s
   896   967 39356.3249   36  213 30847.8640 49724.5436  61.2%  8128 2701s
   989  1046 38824.0934   42  207 30847.8640 49724.5436  61.2%  7751 2737s
H 1080  1046                    30868.158556 49724.5436  61.1%  7442 2737s
  1089  1168 37563.7203   47  177 30868.1586 49724.5436  61.1%  7432 2771s
  1221  1195 37147.2056   54  162 30868.1586 49724.5436  61.1%  6992 2799s
  1258  1314 37068.4988   55  167 30868.1586 49724.5436  61.1%  6927 2834s
  1387  1486 36294.8172   59  144 30868.1586 49724.5436  61.1%  6546 2874s
  1577  1613 34963.5217   66  142 30868.1586 49724.5436  61.1%  6118 2910s
  1742  1666 34776.8368   68  126 30868.1586 49724.5436  61.1%  5847 2960s
  1887  1693 33255.4787   75  129 30868.1586 49724.5436  61.1%  5713 3003s
  2006  1720 infeasible   80      30868.1586 49724.5436  61.1%  5629 3047s
  2116  1761 45457.3506    7  308 30868.1586 49724.5436  61.1%  5592 3094s
  2211  1782 44559.7788    8  309 30868.1586 49724.5436  61.1%  5571 3145s
  2253  1809 44246.5739    9  257 30868.1586 49724.5436  61.1%  5627 3194s
  2292  1852 43793.5688   10  306 30868.1586 49090.9244  59.0%  5703 3247s
H 2323  1850                    30914.552090 49090.9244  58.8%  5765 3247s
  2345  1904 42752.0844   11  302 30914.5521 49090.9244  58.8%  5791 3304s
  2428  1965 42411.4116   13  306 30914.5521 49090.9244  58.8%  5847 3357s
  2506  2060 42033.4711   15  267 30914.5521 49090.9244  58.8%  5914 3418s
  2607  2155 38342.9969   19  189 30914.5521 49090.9244  58.8%  5977 3483s
  2726  2292 37567.6101   22  232 30914.5521 49090.9244  58.8%  5987 3545s
  2893  2480 36709.6796   28  210 30914.5521 49090.9244  58.8%  5927 3600s

Cutting planes:
  Learned: 1
  Gomory: 20
  Implied bound: 275
  MIR: 4619
  Flow cover: 4254
  RLT: 62
  Relax-and-lift: 499
  BQP: 1

Explored 3110 nodes (19038082 simplex iterations) in 3600.05 seconds (8813.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 30914.6 30868.2 30847.9 ... 30526.2

Time limit reached
Best objective 3.091455208961e+04, best bound 4.909092439849e+04, gap 58.7955%
  WARNING: Time limit reached. Using best solution found (gap: 58.80%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 30914.55, θ = 182259.38
  Upper Bound (UB) = 30914.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 182259.38
  [DEBUG]   ✓ Scenario 0: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 182259.38 ≤ Q = 182801.55 (slack: 542.17)
  [DEBUG]   ✓ Scenario 15: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 182259.38 ≤ Q = 182259.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 182259.38 ≤ Q = 182259.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1896140d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe769ebf3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.405032e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6849344.7261
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.567763e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156776.33    0  124 6849344.73 -156776.33   102%     -    0s
H    0     0                    -122145.4007 -156776.33  28.4%     -    0s
H    0     0                    -123235.2676 -156776.33  27.2%     -    0s
     0     0 -133496.41    0   48 -123235.27 -133496.41  8.33%     -    0s
H    0     0                    -131344.4604 -133386.16  1.55%     -    0s
H    0     0                    -131678.3800 -133386.16  1.30%     -    0s
     0     0 -132293.32    0   46 -131678.38 -132293.32  0.47%     -    0s
H    0     0                    -131760.6143 -132220.68  0.35%     -    0s
     0     0 -132189.80    0   33 -131760.61 -132189.80  0.33%     -    0s
     0     0 -132009.42    0   10 -131760.61 -132009.42  0.19%     -    0s
H    0     0                    -131774.7009 -131961.70  0.14%     -    0s
     0     0 -131918.54    0    9 -131774.70 -131918.54  0.11%     -    0s
     0     0 -131889.31    0    8 -131774.70 -131889.31  0.09%     -    0s
     0     0 -131889.31    0   23 -131774.70 -131889.31  0.09%     -    0s
     0     0 -131861.88    0    5 -131774.70 -131861.88  0.07%     -    0s
H    0     0                    -131781.6120 -131849.41  0.05%     -    0s
H    0     0                    -131790.8260 -131849.41  0.04%     -    0s
*    0     0               0    -131839.8455 -131839.85  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 14
  Flow cover: 9
  Relax-and-lift: 4

Explored 1 nodes (634 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -131840 -131791 -131782 ... 1.40503e+13
No other solutions better than -131840

Optimal solution found (tolerance 1.00e-04)
Best objective -1.318398454934e+05, best bound -1.318398454934e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 175693.28
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131839.85
  [DEBUG]   S×d_nominal = 307533.13
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307533.13 + -131839.85 = 175693.28
  [DEBUG]   Current θ from Master = 182259.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6566.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24348.46
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 551.7396, Absolute Gap = 551.7396, Relative Gap = 0.017847
  Not converged yet (gap = 551.74 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999832 nonzeros
Model fingerprint: 0x693eea28
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162610 rows and 66010 columns
Presolve time: 3.96s
Presolved: 190443 rows, 79770 columns, 1172686 nonzeros
Variable types: 77511 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.62s

Barrier statistics:
 Dense cols : 1149
 AA' NZ     : 5.094e+06
 Factor NZ  : 1.411e+07 (roughly 220 MB of memory)
 Factor Ops : 4.903e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.04956106e+07  3.36084060e+08  1.52e+05 1.29e+01  9.48e+04     7s
   1  -1.60045448e+07  3.15794159e+08  1.07e+05 7.65e+01  6.68e+04     7s
   2  -7.09766992e+06  2.38792001e+08  4.65e+04 4.74e+00  3.07e+04     8s
   3  -1.67792274e+06  2.08325451e+08  6.93e+03 2.48e+00  5.04e+03     8s
   4  -7.42742763e+05  1.23048282e+08  1.09e+03 4.48e-01  1.00e+03     8s
   5  -5.45477712e+05  6.96308456e+07  4.80e+02 1.98e-01  4.61e+02     8s
   6  -4.41168966e+05  5.39300813e+07  1.83e+02 1.41e-01  2.50e+02     8s
   7  -4.06554030e+05  3.83960359e+07  8.70e+01 9.40e-02  1.52e+02     8s
   8  -3.67659564e+05  2.77577272e+07  4.29e+01 6.41e-02  9.81e+01     8s
   9  -2.74361117e+05  1.65678784e+07  4.85e+00 3.68e-02  5.00e+01     8s
  10  -1.59404890e+05  9.29865943e+06  4.77e-01 2.03e-02  2.74e+01     8s
  11  -1.09230559e+05  4.95937061e+06  2.66e-01 1.08e-02  1.46e+01     8s
  12  -1.01865114e+05  3.81079489e+06  2.24e-01 8.32e-03  1.13e+01     8s
  13  -8.68192757e+04  2.72075637e+06  1.57e-01 5.86e-03  8.11e+00     8s
  14  -5.71189440e+04  1.87851867e+06  5.52e-02 3.94e-03  5.58e+00     8s
  15  -3.75350255e+04  6.18164255e+05  2.92e-02 1.26e-03  1.89e+00     8s
  16  -9.58692559e+03  3.02535389e+05  1.62e-02 9.80e-04  9.00e-01     8s
  17   7.36176617e+03  2.27722324e+05  1.09e-02 6.76e-04  6.36e-01     9s
  18   2.20470399e+04  1.59401907e+05  8.09e-03 4.03e-04  3.96e-01     9s
  19   3.08889139e+04  1.22494661e+05  6.31e-03 2.51e-04  2.64e-01     9s
  20   3.52303252e+04  1.07391174e+05  5.42e-03 2.32e-04  2.08e-01     9s
  21   3.93198932e+04  1.00076071e+05  4.63e-03 1.92e-04  1.75e-01     9s
  22   4.33670584e+04  9.42378955e+04  3.82e-03 1.71e-04  1.47e-01     9s
  23   4.58645938e+04  8.99772003e+04  3.35e-03 1.46e-04  1.27e-01     9s
  24   4.87413669e+04  8.74593107e+04  2.82e-03 1.30e-04  1.12e-01     9s
  25   5.07271813e+04  8.35920500e+04  2.46e-03 1.07e-04  9.48e-02     9s
  26   5.23754173e+04  8.18806735e+04  2.18e-03 9.61e-05  8.51e-02     9s
  27   5.38756817e+04  7.93763762e+04  1.93e-03 8.37e-05  7.36e-02     9s
  28   5.54059042e+04  7.80576509e+04  1.68e-03 7.54e-05  6.53e-02    10s
  29   5.78272962e+04  7.58796110e+04  1.30e-03 7.79e-05  5.21e-02    10s
  30   6.01366673e+04  7.38105460e+04  9.46e-04 6.03e-05  3.94e-02    10s
  31   6.13028882e+04  7.21899456e+04  7.79e-04 4.68e-05  3.14e-02    10s
  32   6.16906380e+04  7.05927092e+04  7.26e-04 3.22e-05  2.57e-02    10s
  33   6.31165236e+04  6.96801256e+04  5.28e-04 2.43e-05  1.89e-02    10s
  34   6.40710578e+04  6.94426064e+04  4.03e-04 2.21e-05  1.55e-02    10s
  35   6.46674119e+04  6.84996274e+04  3.24e-04 1.22e-05  1.11e-02    10s
  36   6.51171968e+04  6.83025735e+04  2.64e-04 1.03e-05  9.19e-03    10s
  37   6.56223128e+04  6.79623248e+04  1.98e-04 6.29e-06  6.75e-03    10s
  38   6.60552408e+04  6.78429011e+04  1.43e-04 5.22e-06  5.16e-03    11s
  39   6.64158099e+04  6.75640807e+04  9.53e-05 2.85e-06  3.31e-03    11s
  40   6.67400302e+04  6.73959229e+04  5.58e-05 1.25e-06  1.89e-03    11s
  41   6.69633455e+04  6.73374399e+04  2.94e-05 7.96e-07  1.08e-03    11s
  42   6.70878193e+04  6.72988681e+04  1.53e-05 5.07e-07  6.09e-04    11s
  43   6.71399661e+04  6.72617157e+04  9.27e-06 2.35e-07  3.51e-04    11s
  44   6.71611051e+04  6.72485619e+04  6.96e-06 1.40e-07  2.52e-04    11s
  45   6.71769795e+04  6.72431875e+04  5.21e-06 1.03e-07  1.91e-04    11s
  46   6.71887520e+04  6.72372879e+04  3.95e-06 6.46e-08  1.40e-04    11s
  47   6.71981660e+04  6.72340167e+04  2.96e-06 4.26e-08  1.03e-04    11s
  48   6.72105681e+04  6.72309382e+04  1.68e-06 2.09e-08  5.88e-05    11s
  49   6.72221634e+04  6.72291502e+04  5.01e-07 1.54e-07  2.02e-05    12s
  50   6.72233903e+04  6.72286894e+04  3.85e-07 1.09e-07  1.53e-05    12s
  51   6.72254140e+04  6.72283439e+04  1.94e-07 7.51e-08  8.45e-06    12s
  52   6.72267213e+04  6.72280122e+04  7.04e-08 3.85e-08  3.72e-06    12s
  53   6.72267687e+04  6.72278420e+04  6.65e-08 2.20e-08  3.10e-06    12s
  54   6.72275809e+04  6.72276304e+04  7.66e-09 2.31e-09  1.43e-07    12s
  55   6.72276044e+04  6.72276238e+04  1.25e-06 1.50e-06  5.62e-08    12s
  56   6.72276043e+04  6.72276238e+04  1.37e-06 1.47e-06  5.61e-08    12s
  57   6.72276045e+04  6.72276239e+04  1.37e-06 1.43e-06  5.59e-08    12s
  58   6.72276178e+04  6.72276235e+04  7.76e-07 1.19e-08  1.64e-08    12s
  59   6.72276231e+04  6.72276235e+04  8.65e-08 8.70e-10  1.15e-09    13s

Barrier solved model in 59 iterations and 12.57 seconds (21.71 work units)
Optimal objective 6.72276231e+04


Root crossover log...

  170331 DPushes remaining with DInf 0.0000000e+00                13s
   30763 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

   21192 PPushes remaining with PInf 1.2986119e-04                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.1190285e+05     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  107114    6.7227623e+04   0.000000e+00   5.119028e+05     19s
  108130    6.7227623e+04   0.000000e+00   2.019892e+01     20s
  108307    6.7227623e+04   0.000000e+00   0.000000e+00     20s
  108307    6.7227623e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 1.58s

Solved with barrier

Root relaxation: objective 6.722762e+04, 108307 iterations, 17.20 seconds (33.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67227.6235    0  158 -180179.68 67227.6235   137%     -   22s
H    0     0                    -175941.3672 67227.6235   138%     -   22s
H    0     0                    -161210.6623 67227.6235   142%     -   23s
H    0     0                    -64929.72380 67227.6235   204%     -   23s
H    0     0                    14306.759626 67227.6235   370%     -   23s
H    0     0                    18949.292860 67227.6235   255%     -   24s
H    0     0                    19848.615823 67227.6235   239%     -   24s
H    0     0                    20608.890934 67227.6235   226%     -   24s
H    0     0                    20640.912510 67227.6235   226%     -   24s
H    0     0                    20869.841500 67227.6235   222%     -   24s
H    0     0                    20896.380596 67227.6235   222%     -   24s
     0     0 62045.3602    0  205 20896.3806 62045.3602   197%     -   92s
H    0     0                    20902.813703 62045.3027   197%     -   93s
H    0     0                    21024.196349 62045.3027   195%     -   93s
H    0     0                    21075.385157 62045.3027   194%     -   93s
     0     0 61951.3335    0  211 21075.3852 61951.3335   194%     -  110s
     0     0 61543.3398    0  219 21075.3852 61543.3398   192%     -  146s
     0     0 61194.1092    0  215 21075.3852 61194.1092   190%     -  170s
     0     0 61172.4300    0  221 21075.3852 61172.4300   190%     -  178s
     0     0 61143.1139    0  219 21075.3852 61143.1139   190%     -  185s
     0     0 61140.9259    0  215 21075.3852 61140.9259   190%     -  187s
     0     0 61102.2689    0  216 21075.3852 61102.2689   190%     -  192s
     0     0 61101.1104    0  216 21075.3852 61101.1104   190%     -  194s
     0     0 61080.6619    0  220 21075.3852 61080.6619   190%     -  196s
     0     0 61055.6551    0  208 21075.3852 61055.6551   190%     -  202s
     0     0 61035.0349    0  225 21075.3852 61035.0349   190%     -  210s
     0     0 60911.6353    0  218 21075.3852 60911.6353   189%     -  220s
     0     0 60910.3462    0  220 21075.3852 60910.3462   189%     -  222s
     0     0 60909.8770    0  219 21075.3852 60909.8770   189%     -  223s
     0     0 57770.8200    0  247 21075.3852 57770.8200   174%     -  292s
     0     0 57770.8200    0  247 21075.3852 57770.8200   174%     -  292s
H    0     0                    25864.337284 57770.8097   123%     -  293s
H    0     0                    26037.764144 57770.8097   122%     -  293s
     0     0 57253.4912    0  294 26037.7641 57253.4912   120%     -  333s
     0     0 57155.6712    0  279 26037.7641 57155.6712   120%     -  346s
     0     0 57067.1274    0  277 26037.7641 57067.1274   119%     -  363s
     0     0 57029.1495    0  281 26037.7641 57029.1495   119%     -  371s
     0     0 56894.8987    0  274 26037.7641 56894.8987   119%     -  384s
     0     0 56866.0104    0  276 26037.7641 56866.0104   118%     -  391s
     0     0 56792.5455    0  281 26037.7641 56792.5455   118%     -  404s
     0     0 56777.2384    0  277 26037.7641 56777.2384   118%     -  408s
     0     0 56582.4759    0  286 26037.7641 56582.4759   117%     -  424s
     0     0 56563.9171    0  279 26037.7641 56563.9171   117%     -  431s
     0     0 56549.8376    0  283 26037.7641 56549.8376   117%     -  435s
     0     0 56549.3881    0  283 26037.7641 56549.3881   117%     -  437s
     0     0 54150.0829    0  365 26037.7641 54150.0829   108%     -  526s
H    0     0                    26113.764262 54149.6361   107%     -  527s
     0     0 53677.0080    0  382 26113.7643 53677.0080   106%     -  561s
     0     0 53490.4956    0  353 26113.7643 53490.4956   105%     -  582s
     0     0 53359.5291    0  341 26113.7643 53359.5291   104%     -  600s
     0     0 53307.3072    0  387 26113.7643 53307.3072   104%     -  618s
     0     0 53292.9811    0  354 26113.7643 53292.9811   104%     -  625s
     0     0 53276.3235    0  360 26113.7643 53276.3235   104%     -  631s
     0     0 53260.4157    0  360 26113.7643 53260.4157   104%     -  637s
     0     0 53139.1562    0  371 26113.7643 53139.1562   103%     -  651s
     0     0 53095.4238    0  357 26113.7643 53095.4238   103%     -  665s
     0     0 53091.0586    0  363 26113.7643 53091.0586   103%     -  670s
     0     0 53089.8012    0  364 26113.7643 53089.8012   103%     -  673s
     0     0 52171.9561    0  376 26113.7643 52171.9561   100%     -  741s
H    0     0                    26286.981333 52171.8850  98.5%     -  742s
H    0     0                    26375.523559 52171.8850  97.8%     -  742s
H    0     0                    26830.046472 52171.8850  94.5%     -  742s
H    0     0                    26869.189123 52171.8850  94.2%     -  742s
H    0     0                    27003.227626 52171.8850  93.2%     -  742s
H    0     0                    27022.613571 52171.8850  93.1%     -  742s
H    0     0                    27032.674136 52171.8850  93.0%     -  742s
     0     0 51991.4756    0  406 27032.6741 51991.4756  92.3%     -  767s
     0     0 51935.4112    0  403 27032.6741 51935.4112  92.1%     -  783s
     0     0 51901.4078    0  408 27032.6741 51901.4078  92.0%     -  796s
     0     0 51890.1021    0  367 27032.6741 51890.1021  92.0%     -  803s
     0     0 51868.9708    0  401 27032.6741 51868.9708  91.9%     -  812s
     0     0 51863.6446    0  377 27032.6741 51863.6446  91.9%     -  817s
     0     0 51824.8972    0  398 27032.6741 51824.8972  91.7%     -  834s
     0     0 51794.5955    0  403 27032.6741 51794.5955  91.6%     -  850s
     0     0 51765.7901    0  396 27032.6741 51765.7901  91.5%     -  862s
     0     0 51740.2153    0  366 27032.6741 51740.2153  91.4%     -  870s
     0     0 51725.2504    0  368 27032.6741 51725.2504  91.3%     -  877s
     0     0 51710.3308    0  368 27032.6741 51710.3308  91.3%     -  885s
     0     0 51695.2391    0  403 27032.6741 51695.2391  91.2%     -  895s
     0     0 51675.9672    0  372 27032.6741 51675.9672  91.2%     -  903s
     0     0 51667.7809    0  372 27032.6741 51667.7809  91.1%     -  908s
     0     0 51664.4019    0  374 27032.6741 51664.4019  91.1%     -  911s
     0     0 51662.8056    0  374 27032.6741 51662.8056  91.1%     -  913s
     0     0 51468.5649    0  415 27032.6741 51468.5649  90.4%     -  943s
     0     0 51316.7109    0  431 27032.6741 51316.7109  89.8%     -  972s
     0     0 51246.4525    0  439 27032.6741 51246.4525  89.6%     -  995s
     0     0 51209.2713    0  429 27032.6741 51209.2713  89.4%     - 1009s
     0     0 51203.2859    0  432 27032.6741 51203.2859  89.4%     - 1013s
     0     0 51187.7702    0  438 27032.6741 51187.7702  89.4%     - 1020s
     0     0 51182.6392    0  436 27032.6741 51182.6392  89.3%     - 1024s
     0     0 51166.1429    0  438 27032.6741 51166.1429  89.3%     - 1034s
     0     0 51158.2792    0  440 27032.6741 51158.2792  89.2%     - 1039s
     0     0 51151.0900    0  433 27032.6741 51151.0900  89.2%     - 1045s
     0     0 51149.4383    0  442 27032.6741 51149.4383  89.2%     - 1048s
     0     0 51014.5703    0  452 27032.6741 51014.5703  88.7%     - 1071s
H    0     0                    27033.217246 51014.5478  88.7%     - 1072s
H    0     0                    27425.252584 51014.5478  86.0%     - 1072s
H    0     0                    27944.192984 51014.5478  82.6%     - 1072s
H    0     0                    28033.810278 51014.5478  82.0%     - 1072s
H    0     0                    28204.933401 51014.5478  80.9%     - 1072s
H    0     0                    28224.035956 51014.5478  80.7%     - 1072s
H    0     0                    28343.842084 51014.5478  80.0%     - 1072s
     0     0 50976.5841    0  472 28343.8421 50976.5841  79.9%     - 1085s
     0     0 50964.0492    0  466 28343.8421 50964.0492  79.8%     - 1093s
     0     0 50950.1540    0  472 28343.8421 50950.1540  79.8%     - 1101s
     0     0 50945.5079    0  462 28343.8421 50945.5079  79.7%     - 1106s
     0     0 50938.9476    0  459 28343.8421 50938.9476  79.7%     - 1112s
     0     0 50926.5848    0  466 28343.8421 50926.5848  79.7%     - 1119s
     0     0 50922.2306    0  468 28343.8421 50922.2306  79.7%     - 1122s
     0     0 50898.7975    0  476 28343.8421 50898.7975  79.6%     - 1130s
     0     0 50891.0539    0  471 28343.8421 50891.0539  79.5%     - 1138s
     0     0 50885.7616    0  461 28343.8421 50885.7616  79.5%     - 1144s
     0     0 50876.0276    0  461 28343.8421 50876.0276  79.5%     - 1149s
     0     0 50867.4554    0  462 28343.8421 50867.4554  79.5%     - 1153s
     0     0 50863.5088    0  466 28343.8421 50863.5088  79.5%     - 1155s
     0     0 50858.0589    0  460 28343.8421 50858.0589  79.4%     - 1158s
     0     0 50855.5820    0  466 28343.8421 50855.5820  79.4%     - 1161s
     0     0 50852.0649    0  461 28343.8421 50852.0649  79.4%     - 1163s
     0     0 50849.6876    0  460 28343.8421 50849.6876  79.4%     - 1166s
     0     0 50848.7703    0  470 28343.8421 50848.7703  79.4%     - 1168s
     0     0 50775.6838    0  390 28343.8421 50775.6838  79.1%     - 1189s
     0     0 50762.6022    0  436 28343.8421 50762.6022  79.1%     - 1199s
     0     0 50754.6777    0  394 28343.8421 50754.6777  79.1%     - 1206s
     0     0 50748.3785    0  395 28343.8421 50748.3785  79.0%     - 1211s
     0     0 50741.2680    0  385 28343.8421 50741.2680  79.0%     - 1216s
     0     0 50733.0416    0  394 28343.8421 50733.0416  79.0%     - 1219s
     0     0 50731.4318    0  398 28343.8421 50731.4318  79.0%     - 1221s
     0     0 50712.1387    0  389 28343.8421 50712.1387  78.9%     - 1230s
H    0     0                    28402.547058 50711.9295  78.5%     - 1231s
     0     0 50699.6717    0  395 28402.5471 50699.6717  78.5%     - 1236s
     0     0 50692.1997    0  391 28402.5471 50692.1997  78.5%     - 1243s
     0     0 50684.5061    0  402 28402.5471 50684.5061  78.5%     - 1248s
     0     0 50680.5679    0  399 28402.5471 50680.5679  78.4%     - 1254s
     0     0 50678.4943    0  402 28402.5471 50678.4943  78.4%     - 1257s
     0     0 50637.6646    0  399 28402.5471 50637.6646  78.3%     - 1269s
     0     0 50626.0987    0  408 28402.5471 50626.0987  78.2%     - 1280s
     0     0 50621.3411    0  404 28402.5471 50621.3411  78.2%     - 1285s
     0     0 50618.0287    0  398 28402.5471 50618.0287  78.2%     - 1290s
     0     0 50616.6585    0  399 28402.5471 50616.6585  78.2%     - 1293s
     0     0 50602.9953    0  405 28402.5471 50602.9953  78.2%     - 1303s
H    0     0                    28872.507310 50601.7855  75.3%     - 1304s
H    0     0                    29321.474270 50601.7855  72.6%     - 1304s
     0     0 50601.3278    0  400 29321.4743 50601.3278  72.6%     - 1306s
     0     0 50589.8995    0  403 29321.4743 50589.8995  72.5%     - 1314s
     0     0 50587.8738    0  402 29321.4743 50587.8738  72.5%     - 1318s
     0     0 50553.5950    0  399 29321.4743 50553.5950  72.4%     - 1329s
     0     0 50543.9850    0  395 29321.4743 50543.9850  72.4%     - 1336s
     0     0 50539.9432    0  410 29321.4743 50539.9432  72.4%     - 1339s
     0     0 50535.6132    0  412 29321.4743 50535.6132  72.4%     - 1343s
     0     0 50527.6506    0  408 29321.4743 50527.6506  72.3%     - 1346s
     0     0 50525.7676    0  407 29321.4743 50525.7676  72.3%     - 1349s
     0     0 50513.4530    0  411 29321.4743 50513.4530  72.3%     - 1357s
     0     0 50512.1155    0  405 29321.4743 50512.1155  72.3%     - 1361s
     0     0 50496.6460    0  400 29321.4743 50496.6460  72.2%     - 1369s
H    0     0                    29423.768313 50495.6778  71.6%     - 1370s
     0     0 50494.0117    0  409 29423.7683 50494.0117  71.6%     - 1372s
     0     0 50492.9314    0  410 29423.7683 50492.9314  71.6%     - 1373s
     0     0 50490.7945    0  407 29423.7683 50490.7945  71.6%     - 1377s
     0     0 50489.1533    0  404 29423.7683 50489.1533  71.6%     - 1379s
     0     0 50476.5054    0  393 29423.7683 50476.5054  71.6%     - 1386s
     0     0 50476.2989    0  393 29423.7683 50476.2989  71.5%     - 1393s
H    0     0                    29429.173309 50476.2989  71.5%     - 1617s
     0     2 50476.2989    0  393 29429.1733 50476.2989  71.5%     - 1622s
     1     3 50304.4846    1  371 29429.1733 50475.4899  71.5% 13192 1638s
     2     4 50366.4580    1  397 29429.1733 50366.4580  71.1% 16522 1663s
     3     5 49298.5201    2  360 29429.1733 50366.3753  71.1% 17968 1690s
     4     8 50277.5275    2  386 29429.1733 50364.2340  71.1% 14622 1737s
     7    16 49954.2722    3  375 29429.1733 50277.4340  70.8% 16382 1795s
    15    32 49897.5528    4  367 29429.1733 50163.8724  70.5% 17398 1849s
    31    48 48524.3880    5  352 29429.1733 49897.5375  69.6% 27481 1975s
    47    80 49311.8400    6  376 29429.1733 49897.5375  69.6% 25653 2040s
H   49    80                    29808.628291 49897.5375  67.4% 25098 2040s
H   70    80                    29841.875280 49897.5375  67.2% 22274 2040s
    79   142 49223.9761    7  367 29841.8753 49897.5375  67.2% 21324 2308s
   141   250 49000.5726    9  359 29841.8753 49897.5375  67.2% 17174 2388s
H  145   250                    29969.860045 49897.5375  66.5% 17060 2388s
H  163   250                    30231.789791 49897.5375  65.0% 16000 2388s
H  175   250                    30512.321934 49897.5375  63.5% 15399 2388s
H  175   250                    30646.904050 49897.5375  62.8% 15399 2388s
H  180   250                    30662.373382 49897.5375  62.7% 15139 2388s
H  219   250                    30738.717169 49897.5375  62.3% 13891 2388s
   249   318 48346.8916   12  325 30738.7172 49897.5375  62.3% 13220 2444s
H  317   371                    30818.219371 49897.5375  61.9% 12384 2492s
H  319   371                    30955.456081 49897.5375  61.2% 12340 2492s
   370   423 46554.9328   12  297 30955.4561 49897.5375  61.2% 11586 2562s
   422   468 47908.9900   16  308 30955.4561 49897.5375  61.2% 11027 2628s
   467   522 47309.1260   17  291 30955.4561 49897.5375  61.2% 10848 2691s
   521   546 47278.8999   19  290 30955.4561 49897.5375  61.2% 11058 2750s
   545   580 47265.8871   20  295 30955.4561 49897.5375  61.2% 10861 2791s
   579   607 47255.3627   21  296 30955.4561 49897.5375  61.2% 10813 2831s
   606   639 46751.3849   22  272 30955.4561 49897.5375  61.2% 10659 2871s
   638   675 46619.2100   23  287 30955.4561 49897.5375  61.2% 10574 2902s
H  646   675                    30986.573655 49897.5375  61.0% 10548 2902s
   674   706 43814.5210   24  240 30986.5737 49897.5375  61.0% 10719 2933s
H  703   706                    31026.647035 49897.5375  60.8% 10696 2933s
   705   819 43402.1213   25  280 31026.6470 49897.5375  60.8% 10709 2967s
   818   938 42370.6883   29  210 31026.6470 49897.5375  60.8% 10460 3000s
   937  1052 41482.4674   34  195 31026.6470 49897.5375  60.8%  9993 3029s
  1055  1176 40772.1756   39  193 31026.6470 49897.5375  60.8%  9699 3059s
  1183  1308 39494.7120   46  177 31026.6470 49897.5375  60.8%  9312 3086s
  1319  1429 38375.8252   54  212 31026.6470 49897.5375  60.8%  9048 3113s
  1474  1542 36580.2705   59  154 31026.6470 49897.5375  60.8%  8752 3151s
  1641  1558 35096.9383   65  180 31026.6470 49897.5375  60.8%  8469 3189s
  1789  1572 31266.6735   70  168 31026.6470 49897.5375  60.8%  8317 3227s
  1825  1587 infeasible   71      31026.6470 49897.5375  60.8%  8458 3265s
  1864  1606 48531.9055    8  304 31026.6470 49897.5375  60.8%  8643 3301s
H 1877  1606                    31040.427003 49897.5375  60.8%  8664 3301s
  1905  1693 35524.5434   39  140 31040.4270 49897.5375  60.8%  8773 3346s
  2034  1797 46746.8543    9  277 31040.4270 49897.5375  60.8%  8756 3386s
  2202  1901 45828.1450   10  262 31040.4270 49897.5375  60.8%  8627 3428s
  2373  2056 45173.1415   11  239 31040.4270 49897.5375  60.8%  8450 3470s
  2584  2073 44569.1064   15  256 31040.4270 49897.5375  60.8%  8222 3517s
  2620  2110 44278.3329   16  261 31040.4270 49897.5375  60.8%  8243 3559s
  2688  2130 44229.6489   17  245 31040.4270 49897.5375  60.8%  8245 3600s

Cutting planes:
  Learned: 1
  Gomory: 21
  Implied bound: 294
  MIR: 4359
  Flow cover: 4801
  RLT: 66
  Relax-and-lift: 701

Explored 2724 nodes (23561519 simplex iterations) in 3600.06 seconds (8959.17 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 31040.4 31026.6 30986.6 ... 30231.8

Time limit reached
Best objective 3.104042700327e+04, best bound 4.989753752750e+04, gap 60.7502%
  WARNING: Time limit reached. Using best solution found (gap: 60.75%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 31040.43, θ = 183386.66
  Upper Bound (UB) = 31040.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183386.66
  [DEBUG]   ✓ Scenario 0: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 183386.66 ≤ Q = 183386.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 183386.66 ≤ Q = 183386.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x35527dec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcaad8214
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.410133e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6907683.2207
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.556892e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155689.24    0  124 6907683.22 -155689.24   102%     -    0s
H    0     0                    -120990.5629 -155689.24  28.7%     -    0s
H    0     0                    -122114.1406 -155689.24  27.5%     -    0s
     0     0 -129474.09    0  105 -122114.14 -129474.09  6.03%     -    0s
H    0     0                    -124626.9894 -129344.66  3.79%     -    0s
     0     0 -127617.44    0  109 -124626.99 -127617.44  2.40%     -    0s
H    0     0                    -125464.6935 -127610.77  1.71%     -    0s
     0     0 -127438.29    0  109 -125464.69 -127438.29  1.57%     -    0s
     0     0 -127262.14    0  108 -125464.69 -127262.14  1.43%     -    0s
     0     0 -127257.38    0  109 -125464.69 -127257.38  1.43%     -    0s
     0     0 -127046.62    0   96 -125464.69 -127046.62  1.26%     -    0s
     0     0 -127039.22    0   95 -125464.69 -127039.22  1.25%     -    0s
     0     0 -126914.54    0  109 -125464.69 -126914.54  1.16%     -    0s
     0     0 -126911.10    0  109 -125464.69 -126911.10  1.15%     -    0s
     0     2 -126911.10    0  109 -125464.69 -126911.10  1.15%     -    0s
H  519   440                    -125472.9120 -126276.67  0.64%   6.8    0s
H  764   659                    -125708.9835 -126276.67  0.45%   5.9    0s
* 1886  1103              44    -125712.5456 -126104.00  0.31%   5.3    0s
* 2146  1210              41    -125738.8344 -126080.32  0.27%   5.1    0s
H 2587  1353                    -125759.5583 -126067.41  0.24%   5.0    0s
H 2812  1456                    -125779.2354 -126067.41  0.23%   4.9    0s
* 2817  1456              33    -125779.2613 -126067.41  0.23%   4.9    0s
H 3353  1456                    -125801.1753 -125990.61  0.15%   4.8    0s
H 3773  1469                    -125805.4027 -125956.62  0.12%   4.7    0s
H 4038  1459                    -125815.8523 -125933.95  0.09%   4.7    0s

Cutting planes:
  Gomory: 50
  Implied bound: 1
  MIR: 208
  Flow cover: 2
  RLT: 1

Explored 6785 nodes (28936 simplex iterations) in 0.19 seconds (0.23 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -125816 -125805 -125801 ... -125465
No other solutions better than -125816

Optimal solution found (tolerance 1.00e-04)
Best objective -1.258158522676e+05, best bound -1.258158522676e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 181814.92
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125815.85
  [DEBUG]   S×d_nominal = 307630.78
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307630.78 + -125815.85 = 181814.92
  [DEBUG]   Current θ from Master = 183386.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1571.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 29468.69
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 677.6145, Absolute Gap = 677.6145, Relative Gap = 0.021830
  Not converged yet (gap = 677.61 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043063 nonzeros
Model fingerprint: 0x01ac42e0
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 169680 rows and 68880 columns
Presolve time: 4.11s
Presolved: 198663 rows, 83140 columns, 1223978 nonzeros
Variable types: 80881 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.49s

Barrier statistics:
 Dense cols : 1148
 AA' NZ     : 5.472e+06
 Factor NZ  : 1.543e+07 (roughly 240 MB of memory)
 Factor Ops : 5.687e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.10985817e+07  3.49159707e+08  1.56e+05 1.26e+01  9.72e+04     6s
   1  -1.64927802e+07  3.29372980e+08  1.11e+05 7.76e+01  6.85e+04     6s
   2  -7.41067268e+06  2.48826829e+08  4.85e+04 4.41e+00  3.19e+04     7s
   3  -1.88352579e+06  2.25954042e+08  8.62e+03 2.27e+00  6.13e+03     7s
   4  -7.49594895e+05  1.39994076e+08  1.29e+03 4.31e-01  1.16e+03     7s
   5  -5.60408782e+05  7.76282854e+07  5.78e+02 2.05e-01  5.32e+02     7s
   6  -4.88144157e+05  6.02275714e+07  3.45e+02 1.47e-01  3.47e+02     7s
   7  -4.16374625e+05  4.62197281e+07  1.14e+02 1.04e-01  1.85e+02     7s
   8  -3.76750753e+05  3.12938302e+07  4.75e+01 6.56e-02  1.07e+02     7s
   9  -2.84612131e+05  2.07460662e+07  2.75e+00 4.02e-02  5.91e+01     7s
  10  -1.80900190e+05  9.06924454e+06  6.23e-01 1.71e-02  2.57e+01     7s
  11  -1.39771094e+05  5.03161447e+06  3.98e-01 9.53e-03  1.43e+01     7s
  12  -1.08226402e+05  3.64501501e+06  2.65e-01 6.92e-03  1.04e+01     7s
  13  -8.25423881e+04  2.50841974e+06  1.53e-01 4.73e-03  7.17e+00     7s
  14  -5.35490698e+04  1.43092452e+06  6.50e-02 2.60e-03  4.11e+00     7s
  15  -2.74676219e+04  5.07006163e+05  3.40e-02 9.86e-04  1.48e+00     7s
  16  -4.30737985e+02  3.02891442e+05  1.94e-02 1.51e-03  8.39e-01     7s
  17   1.10183074e+04  2.41967903e+05  1.53e-02 1.33e-03  6.39e-01     8s
  18   2.65557270e+04  1.79418756e+05  9.98e-03 8.58e-04  4.23e-01     8s
  19   3.41065567e+04  1.33082365e+05  7.69e-03 5.29e-04  2.74e-01     8s
  20   3.90755867e+04  1.09687980e+05  6.22e-03 3.92e-04  1.95e-01     8s
  21   4.07299567e+04  1.06271943e+05  5.78e-03 3.63e-04  1.81e-01     8s
  22   4.40963409e+04  9.96721934e+04  4.90e-03 3.05e-04  1.54e-01     8s
  23   4.66998289e+04  9.60511878e+04  4.23e-03 2.73e-04  1.37e-01     8s
  24   5.10931469e+04  9.11504093e+04  3.14e-03 2.29e-04  1.11e-01     8s
  25   5.21602013e+04  8.80414713e+04  2.89e-03 2.04e-04  9.93e-02     8s
  26   5.55893757e+04  8.47171507e+04  2.12e-03 1.73e-04  8.06e-02     8s
  27   5.74692512e+04  8.06991578e+04  1.72e-03 1.34e-04  6.43e-02     9s
  28   5.96177714e+04  7.74202883e+04  1.29e-03 1.02e-04  4.92e-02     9s
  29   6.18761713e+04  7.44558041e+04  8.62e-04 7.32e-05  3.48e-02     9s
  30   6.33016731e+04  7.19137462e+04  6.10e-04 4.74e-05  2.38e-02     9s
  31   6.43754150e+04  7.05586833e+04  4.30e-04 3.41e-05  1.71e-02     9s
  32   6.51343915e+04  6.91729234e+04  3.08e-04 1.97e-05  1.12e-02     9s
  33   6.57271969e+04  6.86629180e+04  2.15e-04 1.45e-05  8.12e-03     9s
  34   6.60604087e+04  6.83398043e+04  1.61e-04 1.13e-05  6.31e-03     9s
  35   6.65757767e+04  6.79930472e+04  8.68e-05 7.81e-06  3.92e-03     9s
  36   6.67410359e+04  6.75660785e+04  6.37e-05 3.44e-06  2.28e-03     9s
  37   6.68443936e+04  6.74380905e+04  4.97e-05 2.13e-06  1.64e-03     9s
  38   6.69630907e+04  6.73744218e+04  3.38e-05 1.46e-06  1.14e-03    10s
  39   6.70906916e+04  6.73288882e+04  1.62e-05 9.89e-07  6.59e-04    10s
  40   6.71508271e+04  6.72713774e+04  8.83e-06 4.04e-07  3.33e-04    10s
  41   6.71811377e+04  6.72593204e+04  5.20e-06 2.89e-07  2.16e-04    10s
  42   6.71936824e+04  6.72465819e+04  3.73e-06 1.73e-07  1.46e-04    10s
  43   6.72022199e+04  6.72413240e+04  2.74e-06 1.24e-07  1.08e-04    10s
  44   6.72106676e+04  6.72363616e+04  1.79e-06 7.96e-08  7.11e-05    10s
  45   6.72178361e+04  6.72319062e+04  1.00e-06 3.78e-08  3.89e-05    10s
  46   6.72254859e+04  6.72282702e+04  2.00e-07 9.44e-09  7.70e-06    10s
  47   6.72260363e+04  6.72280825e+04  1.46e-07 7.01e-09  5.66e-06    10s
  48   6.72268372e+04  6.72278858e+04  7.19e-08 4.00e-09  2.90e-06    11s
  49   6.72271716e+04  6.72276974e+04  3.97e-08 8.02e-10  1.45e-06    11s
  50   6.72275301e+04  6.72276488e+04  1.25e-07 7.99e-09  3.29e-07    11s
  51   6.72275803e+04  6.72276387e+04  4.53e-08 5.54e-09  1.62e-07    11s
  52   6.72276038e+04  6.72276248e+04  1.30e-08 2.16e-09  5.81e-08    11s
  53   6.72276146e+04  6.72276161e+04  8.89e-08 2.67e-09  4.12e-09    11s
  54   6.72276153e+04  6.72276154e+04  4.85e-08 9.67e-09  4.97e-10    11s

Barrier solved model in 54 iterations and 11.25 seconds (20.84 work units)
Optimal objective 6.72276153e+04


Root crossover log...

  178052 DPushes remaining with DInf 0.0000000e+00                11s
    6918 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   11452 PPushes remaining with PInf 9.4411549e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.4105221e+02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   92592    6.7227615e+04   0.000000e+00   4.410522e+02     18s
   92723    6.7227615e+04   0.000000e+00   0.000000e+00     18s
   92723    6.7227615e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 3.05s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.722762e+04, 92723 iterations, 15.74 seconds (29.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67227.6154    0  156 -180179.68 67227.6154   137%     -   21s
H    0     0                    -175941.3672 67227.6154   138%     -   21s
H    0     0                    -64929.72380 67227.6154   204%     -   23s
H    0     0                    3796.0757926 67227.6154  1671%     -   23s
H    0     0                    18949.292860 67227.6154   255%     -   24s
H    0     0                    20662.326964 67227.6154   225%     -   24s
H    0     0                    20777.776890 67227.6154   224%     -   24s
H    0     0                    20858.838061 67227.6154   222%     -   24s
H    0     0                    20867.042981 67227.6154   222%     -   24s
     0     0 61730.3083    0  207 20867.0430 61730.3083   196%     -   84s
H    0     0                    21067.473508 61730.2515   193%     -   86s
H    0     0                    21102.170534 61730.2515   193%     -   86s
     0     0 61203.8319    0  205 21102.1705 61203.8319   190%     -  110s
     0     0 61152.4908    0  214 21102.1705 61152.4908   190%     -  121s
     0     0 61141.4759    0  220 21102.1705 61141.4759   190%     -  126s
     0     0 61115.9905    0  214 21102.1705 61115.9905   190%     -  129s
     0     0 61102.6185    0  211 21102.1705 61102.6185   190%     -  131s
     0     0 60981.9766    0  218 21102.1705 60981.9766   189%     -  142s
     0     0 60977.3395    0  224 21102.1705 60977.3395   189%     -  145s
     0     0 60976.9177    0  228 21102.1705 60976.9177   189%     -  147s
     0     0 58038.7848    0  279 21102.1705 58038.7848   175%     -  245s
     0     0 58038.7848    0  279 21102.1705 58038.7848   175%     -  245s
H    0     0                    21301.457411 58037.9228   172%     -  246s
H    0     0                    21449.857487 58037.9228   171%     -  246s
H    0     0                    21450.814076 58037.9228   171%     -  246s
H    0     0                    21561.161449 58037.9228   169%     -  246s
     0     0 57255.9344    0  262 21561.1614 57255.9344   166%     -  302s
     0     0 57147.2145    0  307 21561.1614 57147.2145   165%     -  322s
     0     0 57107.2125    0  309 21561.1614 57107.2125   165%     -  332s
     0     0 57006.4114    0  285 21561.1614 57006.4114   164%     -  352s
     0     0 56977.8760    0  323 21561.1614 56977.8760   164%     -  361s
     0     0 56893.9703    0  312 21561.1614 56893.9703   164%     -  377s
     0     0 56881.0871    0  314 21561.1614 56881.0871   164%     -  383s
     0     0 56872.0702    0  307 21561.1614 56872.0702   164%     -  388s
     0     0 56862.2121    0  310 21561.1614 56862.2121   164%     -  392s
     0     0 56851.4086    0  316 21561.1614 56851.4086   164%     -  397s
     0     0 56845.5335    0  310 21561.1614 56845.5335   164%     -  400s
     0     0 56843.6808    0  320 21561.1614 56843.6808   164%     -  404s
     0     0 56831.7731    0  324 21561.1614 56831.7731   164%     -  409s
     0     0 56508.6023    0  318 21561.1614 56508.6023   162%     -  428s
     0     0 56495.6426    0  322 21561.1614 56495.6426   162%     -  435s
     0     0 56479.2775    0  340 21561.1614 56479.2775   162%     -  444s
     0     0 56469.5268    0  345 21561.1614 56469.5268   162%     -  449s
     0     0 56467.3658    0  345 21561.1614 56467.3658   162%     -  451s
     0     0 56466.7247    0  351 21561.1614 56466.7247   162%     -  453s
     0     0 53965.0293    0  319 21561.1614 53965.0293   150%     -  548s
H    0     0                    21577.794178 53964.1769   150%     -  550s
H    0     0                    21592.889845 53964.1769   150%     -  550s
H    0     0                    21676.775850 53964.1769   149%     -  550s
     0     0 53419.3852    0  328 21676.7758 53419.3852   146%     -  591s
     0     0 53301.1897    0  349 21676.7758 53301.1897   146%     -  615s
     0     0 53231.5894    0  340 21676.7758 53231.5894   146%     -  632s
     0     0 53166.9988    0  340 21676.7758 53166.9988   145%     -  646s
     0     0 53133.0513    0  339 21676.7758 53133.0513   145%     -  659s
     0     0 53118.3528    0  345 21676.7758 53118.3528   145%     -  666s
     0     0 53104.7276    0  341 21676.7758 53104.7276   145%     -  674s
     0     0 53096.4027    0  341 21676.7758 53096.4027   145%     -  682s
     0     0 53095.2810    0  345 21676.7758 53095.2810   145%     -  683s
     0     0 52206.4094    0  348 21676.7758 52206.4094   141%     -  760s
     0     0 51931.0195    0  362 21676.7758 51931.0195   140%     -  789s
     0     0 51792.6621    0  360 21676.7758 51792.6621   139%     -  814s
     0     0 51760.1359    0  367 21676.7758 51760.1359   139%     -  829s
     0     0 51716.1217    0  372 21676.7758 51716.1217   139%     -  845s
     0     0 51682.2736    0  382 21676.7758 51682.2736   138%     -  857s
     0     0 51662.8311    0  376 21676.7758 51662.8311   138%     -  867s
     0     0 51649.7566    0  378 21676.7758 51649.7566   138%     -  875s
     0     0 51629.4359    0  370 21676.7758 51629.4359   138%     -  882s
     0     0 51611.8840    0  363 21676.7758 51611.8840   138%     -  888s
     0     0 51595.4460    0  374 21676.7758 51595.4460   138%     -  896s
     0     0 51587.9513    0  381 21676.7758 51587.9513   138%     -  900s
     0     0 51585.1031    0  376 21676.7758 51585.1031   138%     -  903s
     0     0 51578.8258    0  376 21676.7758 51578.8258   138%     -  907s
     0     0 51577.1653    0  375 21676.7758 51577.1653   138%     -  909s
     0     0 51271.8926    0  396 21676.7758 51271.8926   137%     -  944s
     0     0 51229.0488    0  393 21676.7758 51229.0488   136%     -  963s
     0     0 51160.0956    0  393 21676.7758 51160.0956   136%     -  988s
     0     0 51149.6474    0  398 21676.7758 51149.6474   136%     -  998s
     0     0 51109.7439    0  375 21676.7758 51109.7439   136%     - 1009s
     0     0 51080.1075    0  378 21676.7758 51080.1075   136%     - 1018s
     0     0 51065.3042    0  389 21676.7758 51065.3042   136%     - 1024s
     0     0 51061.8429    0  392 21676.7758 51061.8429   136%     - 1027s
     0     0 51059.7840    0  395 21676.7758 51059.7840   136%     - 1030s
     0     0 50897.8033    0  392 21676.7758 50897.8033   135%     - 1059s
H    0     0                    22852.857620 50897.7682   123%     - 1077s
H    0     0                    23410.926156 50897.7682   117%     - 1077s
H    0     0                    25156.362610 50897.7682   102%     - 1078s
H    0     0                    26564.730547 50897.7682  91.6%     - 1078s
     0     0 50852.1156    0  427 26564.7305 50852.1156  91.4%     - 1092s
     0     0 50811.1975    0  401 26564.7305 50811.1975  91.3%     - 1112s
     0     0 50791.8982    0  390 26564.7305 50791.8982  91.2%     - 1122s
     0     0 50770.4728    0  385 26564.7305 50770.4728  91.1%     - 1131s
     0     0 50764.6254    0  433 26564.7305 50764.6254  91.1%     - 1136s
     0     0 50743.8799    0  425 26564.7305 50743.8799  91.0%     - 1142s
     0     0 50738.2534    0  396 26564.7305 50738.2534  91.0%     - 1148s
     0     0 50733.4344    0  433 26564.7305 50733.4344  91.0%     - 1154s
     0     0 50732.3661    0  400 26564.7305 50732.3661  91.0%     - 1157s
     0     0 50669.9535    0  397 26564.7305 50669.9535  90.7%     - 1175s
H    0     0                    26733.097461 50669.1775  89.5%     - 1176s
H    0     0                    26864.201222 50669.1775  88.6%     - 1176s
H    0     0                    26911.302125 50669.1775  88.3%     - 1176s
     0     0 50648.0984    0  385 26911.3021 50648.0984  88.2%     - 1186s
     0     0 50634.4521    0  389 26911.3021 50634.4521  88.2%     - 1193s
     0     0 50616.8554    0  386 26911.3021 50616.8554  88.1%     - 1199s
     0     0 50606.5914    0  389 26911.3021 50606.5914  88.0%     - 1203s
     0     0 50601.3053    0  439 26911.3021 50601.3053  88.0%     - 1210s
     0     0 50598.6325    0  397 26911.3021 50598.6325  88.0%     - 1214s
     0     0 50597.7550    0  398 26911.3021 50597.7550  88.0%     - 1215s
     0     0 50572.1457    0  378 26911.3021 50572.1457  87.9%     - 1224s
H    0     0                    27099.969489 50572.1087  86.6%     - 1227s
H    0     0                    27707.016346 50572.1087  82.5%     - 1228s
H    0     0                    28021.085978 50572.1087  80.5%     - 1228s
     0     0 50567.1398    0  377 28021.0860 50567.1398  80.5%     - 1233s
     0     0 50564.3629    0  378 28021.0860 50564.3629  80.5%     - 1238s
     0     0 50563.3655    0  389 28021.0860 50563.3655  80.4%     - 1240s
     0     0 50537.7871    0  369 28021.0860 50537.7871  80.4%     - 1252s
H    0     0                    28345.637494 50535.8465  78.3%     - 1253s
H    0     0                    28891.452169 50535.8465  74.9%     - 1253s
     0     0 50533.8360    0  429 28891.4522 50533.8360  74.9%     - 1257s
     0     0 50532.0966    0  427 28891.4522 50532.0966  74.9%     - 1260s
     0     0 50517.0748    0  377 28891.4522 50517.0748  74.9%     - 1267s
H    0     0                    28947.544102 50517.0552  74.5%     - 1306s
H    0     0                    29026.681326 50517.0552  74.0%     - 1306s
     0     0 50508.6780    0  384 29026.6813 50508.6780  74.0%     - 1315s
     0     0 50506.8147    0  380 29026.6813 50506.8147  74.0%     - 1319s
     0     0 50499.5029    0  379 29026.6813 50499.5029  74.0%     - 1328s
     0     0 50493.7286    0  391 29026.6813 50493.7286  74.0%     - 1336s
     0     0 50490.8487    0  393 29026.6813 50490.8487  73.9%     - 1339s
     0     0 50489.7823    0  392 29026.6813 50489.7823  73.9%     - 1342s
     0     0 50437.2293    0  418 29026.6813 50437.2293  73.8%     - 1360s
     0     0 50411.1447    0  425 29026.6813 50411.1447  73.7%     - 1371s
     0     0 50407.0006    0  417 29026.6813 50407.0006  73.7%     - 1375s
     0     0 50403.8039    0  424 29026.6813 50403.8039  73.6%     - 1379s
     0     0 50402.1837    0  429 29026.6813 50402.1837  73.6%     - 1381s
     0     0 50367.9428    0  397 29026.6813 50367.9428  73.5%     - 1395s
     0     0 50359.7720    0  396 29026.6813 50359.7720  73.5%     - 1401s
     0     0 50354.5768    0  390 29026.6813 50354.5768  73.5%     - 1405s
     0     0 50351.0830    0  393 29026.6813 50351.0830  73.5%     - 1409s
     0     0 50350.3776    0  396 29026.6813 50350.3776  73.5%     - 1411s
     0     0 50348.5166    0  385 29026.6813 50348.5166  73.5%     - 1415s
     0     0 50347.6196    0  392 29026.6813 50347.6196  73.5%     - 1417s
     0     0 50343.3519    0  397 29026.6813 50343.3519  73.4%     - 1422s
H    0     0                    29038.822104 50343.2647  73.4%     - 1423s
H    0     0                    29186.474762 50343.2647  72.5%     - 1423s
     0     0 50340.9716    0  388 29186.4748 50340.9716  72.5%     - 1425s
     0     0 50336.3971    0  392 29186.4748 50336.3971  72.5%     - 1432s
     0     0 50335.6323    0  392 29186.4748 50335.6323  72.5%     - 1438s
H    0     0                    29246.115458 50335.6323  72.1%     - 1581s
H    0     0                    29285.072975 50335.6323  71.9%     - 1581s
H    0     0                    29291.049817 50335.6323  71.8%     - 1581s
H    0     0                    29331.365711 50335.6323  71.6%     - 1581s
H    0     0                    29333.251342 50335.6323  71.6%     - 1700s
H    0     0                    29341.992682 50335.6323  71.5%     - 1700s
H    0     0                    29349.568033 50335.6323  71.5%     - 1700s
H    0     0                    29547.188911 50335.6323  70.4%     - 1705s
H    0     2                    30338.111923 50335.6323  65.9%     - 1733s
     0     2 50335.6323    0  392 30338.1119 50335.6323  65.9%     - 1733s
     1     4 50283.4002    1  388 30338.1119 50335.6323  65.9%  7433 1759s
     3     8 50248.2919    2  375 30338.1119 50283.1079  65.7% 11601 1782s
     7    15 50090.3572    3  384 30338.1119 50247.5050  65.6% 13834 1871s
    14    29 49891.5067    4  392 30338.1119 50090.3010  65.1% 21817 1933s
    28    43 48343.8098    5  319 30338.1119 49891.3117  64.5% 32411 2101s
    42    73 47889.4934    6  378 30338.1119 49891.3117  64.5% 31797 2318s
H   54    73                    30629.711802 49891.3117  62.9% 29444 2318s
    72   144 47470.8791    7  414 30629.7118 49891.3117  62.9% 30158 2459s
   143   274 47334.0753    8  414 30629.7118 49891.3117  62.9% 22411 2531s
   273   364 46763.5154   13  394 30629.7118 49891.3117  62.9% 16346 2574s
   367   390 46654.0314   17  377 30629.7118 49891.3117  62.9% 13697 2633s
   393   417 46583.6986   18  373 30629.7118 49891.3117  62.9% 13581 2669s
   422   443 46065.0373   18  284 30629.7118 49891.3117  62.9% 13572 2707s
   448   470 46415.6598   19  376 30629.7118 49891.3117  62.9% 13696 2742s
   483   498 46159.0861   20  372 30629.7118 49891.3117  62.9% 13677 2798s
   513   527 46149.7912   21  373 30629.7118 49891.3117  62.9% 13987 2909s
H  542   558                    30665.654230 49891.3117  62.7% 14015 2944s
H  544   558                    30670.239987 49891.3117  62.7% 13982 2944s
H  549   558                    31313.702392 49891.3117  59.3% 13985 2944s
   573   653 46086.6135   23  366 31313.7024 49891.3117  59.3% 13996 2978s
   676   688 45133.3971   25  290 31313.7024 49891.3117  59.3% 13298 3012s
   725   715 45709.6661   14  321 31313.7024 49891.3117  59.3% 13352 3041s
   766   750 44869.1184   25  294 31313.7024 49891.3117  59.3% 13397 3070s
   809   796 43397.2713   27  288 31313.7024 49891.3117  59.3% 13495 3105s
   875   858 42878.2741   30  289 31313.7024 49891.3117  59.3% 13555 3138s
   955   941 42529.4576   35  321 31313.7024 49891.3117  59.3% 13188 3171s
  1052  1054 42244.0324   38  322 31313.7024 49891.3117  59.3% 12899 3200s
  1167  1206 41947.4391   42  289 31313.7024 49891.3117  59.3% 12430 3229s
  1331  1322 41498.0099   47  277 31313.7024 49891.3117  59.3% 11799 3257s
  1479  1401 40311.7521   49  316 31313.7024 49891.3117  59.3% 11375 3288s
  1609  1418     cutoff   50      31313.7024 49891.3117  59.3% 11090 3323s
H 1636  1418                    31379.306639 49891.3117  59.0% 11097 3323s
  1646  1495 35519.4019   49  204 31379.3066 49891.3117  59.0% 11136 3359s
H 1785  1511                    31387.727865 49891.3117  59.0% 10824 3392s
H 1786  1511                    31794.618049 49891.3117  56.9% 10829 3392s
H 1801  1511                    31859.083203 49891.3117  56.6% 10855 3392s
  1823  1644 infeasible   51      31859.0832 49891.3117  56.6% 10864 3433s
  2012  1819 34444.5210   58  174 31859.0832 49891.3117  56.6% 10391 3471s
  2239  1999 34133.1411   62  138 31859.0832 49891.3117  56.6%  9814 3513s
  2520  2164 33832.8242   71  109 31859.0832 49891.3117  56.6%  9165 3551s
H 2642  2164                    31914.558508 49891.3117  56.3%  8904 3551s
  2757  2174 33434.5061   82  102 31914.5585 49891.3117  56.3%  8678 3594s
  2939  2175 32604.8045   87  101 31914.5585 49458.6731  55.0%  8483 3600s

Cutting planes:
  Learned: 3
  Gomory: 15
  Implied bound: 341
  MIR: 5341
  Flow cover: 4767
  RLT: 69
  Relax-and-lift: 659
  PSD: 4

Explored 2960 nodes (26112328 simplex iterations) in 3600.08 seconds (8969.37 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 31914.6 31859.1 31794.6 ... 29547.2

Time limit reached
Best objective 3.191455850768e+04, best bound 4.945867309723e+04, gap 54.9721%
  WARNING: Time limit reached. Using best solution found (gap: 54.97%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 31914.56, θ = 182146.68
  Upper Bound (UB) = 31914.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 182146.68
  [DEBUG]   ✓ Scenario 0: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 182146.68 ≤ Q = 182146.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 182146.68 ≤ Q = 182146.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x61f63a56
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x61f63a56
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.419341e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6890730.0698
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.584292e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158429.22    0  129 6890730.07 -158429.22   102%     -    0s
H    0     0                    -121844.2365 -158429.22  30.0%     -    0s
H    0     0                    -122690.1267 -158429.22  29.1%     -    0s
H    0     0                    -133278.9545 -135622.33  1.76%     -    0s
     0     0 -135606.40    0   64 -133278.95 -135606.40  1.75%     -    0s
H    0     0                    -133567.4464 -135496.40  1.44%     -    0s
H    0     0                    -134348.0817 -135496.40  0.85%     -    0s
     0     0 -135496.40    0   51 -134348.08 -135496.40  0.85%     -    0s
     0     0 -135496.40    0   61 -134348.08 -135496.40  0.85%     -    0s
     0     0 -134782.02    0   44 -134348.08 -134782.02  0.32%     -    0s
     0     0 -134719.36    0   44 -134348.08 -134719.36  0.28%     -    0s
     0     0 -134554.03    0   16 -134348.08 -134554.03  0.15%     -    0s
     0     0 -134546.42    0   14 -134348.08 -134546.42  0.15%     -    0s
     0     0 -134452.23    0   11 -134348.08 -134452.23  0.08%     -    0s
     0     0 -134419.51    0   10 -134348.08 -134419.51  0.05%     -    0s
     0     0 -134419.29    0   11 -134348.08 -134419.29  0.05%     -    0s
     0     0 -134406.52    0   11 -134348.08 -134406.52  0.04%     -    0s
     0     0 -134406.52    0   10 -134348.08 -134406.52  0.04%     -    0s
H    0     0                    -134378.3114 -134406.52  0.02%     -    0s
H    0     0                    -134389.0961 -134406.52  0.01%     -    0s
     0     0          -    0      -134389.10 -134400.78  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  MIR: 2
  Flow cover: 4
  RLT: 8
  Relax-and-lift: 1

Explored 1 nodes (608 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -134389 -134378 -134348 ... 1.41934e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.343890961130e+05, best bound -1.344007798165e+05, gap 0.0087%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 172685.12
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134389.10
  [DEBUG]   S×d_nominal = 307074.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307074.21 + -134389.10 = 172685.12
  [DEBUG]   Current θ from Master = 182146.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9461.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22453.00
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 1551.7460, Absolute Gap = 1551.7460, Relative Gap = 0.048622
  Not converged yet (gap = 1551.75 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086294 nonzeros
Model fingerprint: 0x97b2dbf6
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 176750 rows and 71750 columns
Presolve time: 4.31s
Presolved: 206883 rows, 86510 columns, 1274529 nonzeros
Variable types: 84251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -335473.7764
Found heuristic solution: objective -180179.6763

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.94s

Barrier statistics:
 Dense cols : 1147
 AA' NZ     : 5.863e+06
 Factor NZ  : 1.640e+07 (roughly 250 MB of memory)
 Factor Ops : 6.161e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.18273204e+07  3.61707753e+08  1.61e+05 1.23e+01  1.00e+05     8s
   1  -1.70898203e+07  3.42918400e+08  1.14e+05 7.92e+01  7.06e+04     8s
   2  -7.68608956e+06  2.60108742e+08  5.02e+04 5.14e+00  3.29e+04     8s
   3  -1.37829259e+06  2.16347468e+08  4.34e+03 4.69e+00  3.33e+03     8s
   4  -7.98435073e+05  1.32160153e+08  7.99e+02 1.51e+00  8.19e+02     9s
   5  -7.19902716e+05  1.12581007e+08  4.34e+02 1.24e+00  5.47e+02     9s
   6  -5.35073182e+05  7.40562818e+07  2.41e+02 7.47e-01  3.24e+02     9s
   7  -4.54813200e+05  5.78090931e+07  1.12e+02 5.55e-01  2.09e+02     9s
   8  -4.10595809e+05  3.75854837e+07  4.35e+01 3.42e-01  1.19e+02     9s
   9  -3.41830979e+05  2.44514166e+07  1.00e+01 2.20e-01  6.91e+01     9s
  10  -2.49817697e+05  1.49952144e+07  2.32e+00 1.32e-01  4.10e+01     9s
  11  -1.67709523e+05  5.32437668e+06  8.28e-01 4.35e-02  1.47e+01     9s
  12  -1.17944326e+05  3.64509345e+06  4.87e-01 2.99e-02  1.00e+01     9s
  13  -9.04241733e+04  3.09447883e+06  2.88e-01 2.51e-02  8.48e+00     9s
  14  -6.25092558e+04  1.94248297e+06  1.25e-01 1.55e-02  5.33e+00     9s
  15  -3.68635647e+04  7.47908080e+05  5.39e-02 5.43e-03  2.09e+00     9s
  16  -1.22921812e+04  3.07518778e+05  2.92e-02 2.18e-03  8.50e-01     9s
  17   8.72619474e+03  2.33881114e+05  1.91e-02 1.73e-03  5.98e-01    10s
  18   2.46958834e+04  1.74004700e+05  1.27e-02 1.12e-03  3.97e-01    10s
  19   2.99202333e+04  1.48668098e+05  1.07e-02 8.66e-04  3.16e-01    10s
  20   3.48279334e+04  1.29498524e+05  8.86e-03 7.03e-04  2.52e-01    10s
  21   4.13465626e+04  1.08589102e+05  6.62e-03 4.87e-04  1.79e-01    10s
  22   4.42751899e+04  1.00028695e+05  5.66e-03 3.96e-04  1.48e-01    10s
  23   4.67644668e+04  9.49854497e+04  4.90e-03 3.41e-04  1.28e-01    10s
  24   5.07317107e+04  9.07411057e+04  3.74e-03 2.94e-04  1.06e-01    10s
  25   5.15525490e+04  8.78924982e+04  3.52e-03 2.62e-04  9.66e-02    10s
  26   5.53270430e+04  8.38427178e+04  2.52e-03 2.17e-04  7.58e-02    11s
  27   5.73987393e+04  7.96183608e+04  2.01e-03 1.65e-04  5.90e-02    11s
  28   5.99696338e+04  7.70830309e+04  1.41e-03 1.33e-04  4.55e-02    11s
  29   6.16946004e+04  7.32128507e+04  1.03e-03 8.25e-05  3.06e-02    11s
  30   6.30581222e+04  7.10884416e+04  7.57e-04 5.32e-05  2.13e-02    11s
  31   6.39558965e+04  6.96133174e+04  5.82e-04 3.39e-05  1.50e-02    11s
  32   6.43937476e+04  6.92141640e+04  5.00e-04 2.83e-05  1.28e-02    11s
  33   6.51250527e+04  6.86719216e+04  3.66e-04 2.04e-05  9.42e-03    11s
  34   6.55977045e+04  6.80882633e+04  2.80e-04 1.23e-05  6.62e-03    11s
  35   6.61225039e+04  6.79354725e+04  1.85e-04 1.00e-05  4.82e-03    12s
  36   6.64545209e+04  6.77349476e+04  1.27e-04 7.10e-06  3.40e-03    12s
  37   6.66997001e+04  6.76344548e+04  8.46e-05 5.69e-06  2.48e-03    12s
  38   6.68183759e+04  6.74944477e+04  6.46e-05 3.73e-06  1.80e-03    12s
  39   6.69177307e+04  6.74023802e+04  4.79e-05 2.40e-06  1.29e-03    12s
  40   6.70716484e+04  6.73354687e+04  2.26e-05 1.47e-06  7.01e-04    12s
  41   6.71452352e+04  6.72585948e+04  1.13e-05 5.82e-07  3.01e-04    12s
  42   6.71598867e+04  6.72486907e+04  9.14e-06 3.91e-07  2.36e-04    12s
  43   6.71823878e+04  6.72397166e+04  5.99e-06 2.15e-07  1.52e-04    12s
  44   6.71913388e+04  6.72364308e+04  4.76e-06 1.59e-07  1.20e-04    12s
  45   6.72007866e+04  6.72338709e+04  3.47e-06 1.10e-07  8.79e-05    13s
  46   6.72148998e+04  6.72308376e+04  1.54e-06 5.75e-08  4.23e-05    13s
  47   6.72226959e+04  6.72284957e+04  5.65e-07 1.32e-08  1.54e-05    13s
  48   6.72242082e+04  6.72281135e+04  3.85e-07 7.51e-09  1.04e-05    13s
  49   6.72253384e+04  6.72279309e+04  2.54e-07 4.21e-09  6.89e-06    13s
  50   6.72263314e+04  6.72278368e+04  1.43e-07 3.00e-09  4.00e-06    13s
  51   6.72266420e+04  6.72276979e+04  1.07e-07 9.31e-10  2.81e-06    13s
  52   6.72269723e+04  6.72276604e+04  6.77e-08 5.08e-10  1.83e-06    13s
  53   6.72274326e+04  6.72276236e+04  2.33e-08 8.91e-11  5.08e-07    13s
  54   6.72275604e+04  6.72276205e+04  8.51e-09 6.86e-11  1.60e-07    14s
  55   6.72275817e+04  6.72276199e+04  2.30e-07 6.47e-11  1.01e-07    14s
  56   6.72276112e+04  6.72276154e+04  7.30e-08 1.02e-10  1.12e-08    14s
  57   6.72276151e+04  6.72276151e+04  6.08e-08 8.39e-09  6.56e-11    14s

Barrier solved model in 57 iterations and 13.94 seconds (23.93 work units)
Optimal objective 6.72276151e+04


Root crossover log...

  185311 DPushes remaining with DInf 0.0000000e+00                14s
   68104 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    3718 PPushes remaining with PInf 2.2244960e-05                20s
    2849 PPushes remaining with PInf 1.0733562e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6789143e-01     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   80929    6.7227615e+04   0.000000e+00   3.678914e-01     20s
   80944    6.7227615e+04   0.000000e+00   0.000000e+00     20s
   80944    6.7227615e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 3.81s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 6.722762e+04, 80944 iterations, 19.12 seconds (33.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67227.6151    0  156 -180179.68 67227.6151   137%     -   25s
H    0     0                    -178267.7634 67227.6151   138%     -   25s
H    0     0                    -78164.87758 67227.6151   186%     -   25s
H    0     0                    -64929.72380 67227.6151   204%     -   26s
H    0     0                    -2054.928977 67227.6151  3372%     -   26s
H    0     0                    17377.946534 67227.6151   287%     -   26s
H    0     0                    18949.292860 67227.6151   255%     -   27s
H    0     0                    20358.668621 67227.6151   230%     -   27s
H    0     0                    20361.317194 67227.6151   230%     -   27s
H    0     0                    20554.746767 67227.6151   227%     -   27s
H    0     0                    20573.019299 67227.6151   227%     -   27s
H    0     0                    20860.598984 67227.6151   222%     -   27s
H    0     0                    20869.841500 67227.6151   222%     -   27s
     0     0 61806.7698    0  209 20869.8415 61806.7698   196%     -   91s
H    0     0                    21074.387908 61806.6722   193%     -   93s
     0     0 61482.7365    0  212 21074.3879 61482.7365   192%     -  123s
     0     0 61432.1484    0  230 21074.3879 61432.1484   192%     -  133s
     0     0 61370.4758    0  213 21074.3879 61370.4758   191%     -  140s
     0     0 61362.4454    0  220 21074.3879 61362.4454   191%     -  145s
     0     0 61329.7281    0  221 21074.3879 61329.7281   191%     -  153s
     0     0 61017.7644    0  224 21074.3879 61017.7644   190%     -  171s
     0     0 60984.0713    0  224 21074.3879 60984.0713   189%     -  176s
     0     0 60972.4756    0  218 21074.3879 60972.4756   189%     -  179s
     0     0 60941.7380    0  222 21074.3879 60941.7380   189%     -  182s
     0     0 60941.7193    0  226 21074.3879 60941.7193   189%     -  185s
     0     0 57755.1697    0  239 21074.3879 57755.1697   174%     -  277s
H    0     0                    28678.962492 57754.8824   101%     -  278s
H    0     0                    29177.972918 57754.8824  97.9%     -  279s
H    0     0                    29298.087887 57754.8824  97.1%     -  279s
H    0     0                    29386.670786 57754.8824  96.5%     -  279s
H    0     0                    29411.971083 57754.8824  96.4%     -  279s
     0     0 57202.0628    0  292 29411.9711 57202.0628  94.5%     -  321s
     0     0 57098.7201    0  292 29411.9711 57098.7201  94.1%     -  337s
     0     0 57003.9429    0  318 29411.9711 57003.9429  93.8%     -  355s
     0     0 56943.9205    0  279 29411.9711 56943.9205  93.6%     -  366s
     0     0 56877.7696    0  303 29411.9711 56877.7696  93.4%     -  380s
     0     0 56872.9614    0  307 29411.9711 56872.9614  93.4%     -  384s
     0     0 56855.2173    0  313 29411.9711 56855.2173  93.3%     -  391s
     0     0 56852.8471    0  313 29411.9711 56852.8471  93.3%     -  394s
     0     0 56849.9238    0  306 29411.9711 56849.9238  93.3%     -  401s
     0     0 56755.1997    0  294 29411.9711 56755.1997  93.0%     -  421s
     0     0 56716.1284    0  303 29411.9711 56716.1284  92.8%     -  431s
     0     0 56706.3189    0  299 29411.9711 56706.3189  92.8%     -  436s
     0     0 56702.4674    0  297 29411.9711 56702.4674  92.8%     -  440s
     0     0 56661.5032    0  303 29411.9711 56661.5032  92.6%     -  457s
     0     0 56641.2197    0  298 29411.9711 56641.2197  92.6%     -  463s
     0     0 56490.3353    0  300 29411.9711 56490.3353  92.1%     -  489s
     0     0 56468.4207    0  305 29411.9711 56468.4207  92.0%     -  497s
     0     0 56424.0545    0  304 29411.9711 56424.0545  91.8%     -  512s
     0     0 56414.4828    0  313 29411.9711 56414.4828  91.8%     -  517s
     0     0 56395.9458    0  312 29411.9711 56395.9458  91.7%     -  522s
     0     0 56391.8590    0  314 29411.9711 56391.8590  91.7%     -  524s
     0     0 56357.1913    0  310 29411.9711 56357.1913  91.6%     -  532s
     0     0 56354.8295    0  313 29411.9711 56354.8295  91.6%     -  535s
     0     0 56353.8775    0  314 29411.9711 56353.8775  91.6%     -  536s
     0     0 54127.2808    0  306 29411.9711 54127.2808  84.0%     -  613s
     0     0 53523.8194    0  320 29411.9711 53523.8194  82.0%     -  662s
     0     0 53281.0903    0  310 29411.9711 53281.0903  81.2%     -  692s
     0     0 53147.6145    0  313 29411.9711 53147.6145  80.7%     -  719s
     0     0 53081.0112    0  335 29411.9711 53081.0112  80.5%     -  736s
     0     0 53028.9757    0  337 29411.9711 53028.9757  80.3%     -  756s
     0     0 52964.2251    0  332 29411.9711 52964.2251  80.1%     -  777s
     0     0 52932.3781    0  342 29411.9711 52932.3781  80.0%     -  789s
     0     0 52927.1497    0  340 29411.9711 52927.1497  80.0%     -  793s
     0     0 52920.9263    0  340 29411.9711 52920.9263  79.9%     -  801s
     0     0 52902.4259    0  344 29411.9711 52902.4259  79.9%     -  809s
     0     0 52890.9644    0  354 29411.9711 52890.9644  79.8%     -  814s
     0     0 52883.8528    0  350 29411.9711 52883.8528  79.8%     -  819s
     0     0 52873.4908    0  347 29411.9711 52873.4908  79.8%     -  826s
     0     0 52871.1579    0  354 29411.9711 52871.1579  79.8%     -  829s
     0     0 52869.7126    0  354 29411.9711 52869.7126  79.8%     -  831s
     0     0 51890.7779    0  377 29411.9711 51890.7779  76.4%     -  904s
H    0     0                    29462.858463 51889.3970  76.1%     -  906s
H    0     0                    29512.783629 51889.3970  75.8%     -  906s
     0     0 51668.2743    0  373 29512.7836 51668.2743  75.1%     -  939s
     0     0 51582.6495    0  371 29512.7836 51582.6495  74.8%     -  960s
     0     0 51549.1827    0  372 29512.7836 51549.1827  74.7%     -  970s
     0     0 51538.8076    0  372 29512.7836 51538.8076  74.6%     -  976s
     0     0 51524.4627    0  373 29512.7836 51524.4627  74.6%     -  984s
     0     0 51517.3271    0  417 29512.7836 51517.3271  74.6%     -  990s
     0     0 51509.0788    0  433 29512.7836 51509.0788  74.5%     -  997s
     0     0 51500.6007    0  388 29512.7836 51500.6007  74.5%     - 1003s
     0     0 51496.1426    0  390 29512.7836 51496.1426  74.5%     - 1006s
     0     0 51495.8131    0  429 29512.7836 51495.8131  74.5%     - 1009s
     0     0 51335.5843    0  386 29512.7836 51335.5843  73.9%     - 1038s
H    0     0                    29800.603920 51335.3678  72.3%     - 1039s
     0     0 51231.9205    0  427 29800.6039 51231.9205  71.9%     - 1063s
     0     0 51172.4404    0  423 29800.6039 51172.4404  71.7%     - 1082s
     0     0 51146.8845    0  421 29800.6039 51146.8845  71.6%     - 1091s
     0     0 51095.2570    0  424 29800.6039 51095.2570  71.5%     - 1105s
     0     0 51085.9473    0  434 29800.6039 51085.9473  71.4%     - 1113s
     0     0 51080.8436    0  429 29800.6039 51080.8436  71.4%     - 1119s
     0     0 51076.8588    0  430 29800.6039 51076.8588  71.4%     - 1124s
     0     0 51072.0624    0  435 29800.6039 51072.0624  71.4%     - 1127s
     0     0 51071.4235    0  431 29800.6039 51071.4235  71.4%     - 1129s
     0     0 50933.7669    0  373 29800.6039 50933.7669  70.9%     - 1151s
H    0     0                    30028.146864 50933.6246  69.6%     - 1159s
     0     0 50909.2067    0  377 30028.1469 50909.2067  69.5%     - 1169s
     0     0 50894.2187    0  376 30028.1469 50894.2187  69.5%     - 1178s
     0     0 50886.8411    0  383 30028.1469 50886.8411  69.5%     - 1184s
     0     0 50884.6740    0  387 30028.1469 50884.6740  69.5%     - 1187s
     0     0 50804.7058    0  377 30028.1469 50804.7058  69.2%     - 1205s
     0     0 50776.7067    0  377 30028.1469 50776.7067  69.1%     - 1214s
     0     0 50771.3464    0  380 30028.1469 50771.3464  69.1%     - 1218s
     0     0 50762.2605    0  366 30028.1469 50762.2605  69.0%     - 1225s
     0     0 50754.2088    0  375 30028.1469 50754.2088  69.0%     - 1232s
     0     0 50747.1081    0  369 30028.1469 50747.1081  69.0%     - 1238s
     0     0 50740.4001    0  374 30028.1469 50740.4001  69.0%     - 1242s
     0     0 50738.8146    0  372 30028.1469 50738.8146  69.0%     - 1244s
     0     0 50713.4869    0  368 30028.1469 50713.4869  68.9%     - 1255s
     0     0 50700.4872    0  371 30028.1469 50700.4872  68.8%     - 1265s
     0     0 50693.7144    0  373 30028.1469 50693.7144  68.8%     - 1269s
     0     0 50691.0071    0  379 30028.1469 50691.0071  68.8%     - 1272s
     0     0 50690.2359    0  377 30028.1469 50690.2359  68.8%     - 1274s
     0     0 50681.0154    0  388 30028.1469 50681.0154  68.8%     - 1283s
     0     0 50677.4182    0  388 30028.1469 50677.4182  68.8%     - 1288s
     0     0 50674.9681    0  383 30028.1469 50674.9681  68.8%     - 1291s
     0     0 50673.4558    0  385 30028.1469 50673.4558  68.8%     - 1293s
     0     0 50664.9916    0  377 30028.1469 50664.9916  68.7%     - 1302s
H    0     0                    30051.398690 50664.7359  68.6%     - 1303s
H    0     0                    30078.485148 50664.7359  68.4%     - 1304s
H    0     0                    30124.812221 50664.7359  68.2%     - 1304s
     0     0 50659.8255    0  380 30124.8122 50659.8255  68.2%     - 1310s
     0     0 50658.7916    0  384 30124.8122 50658.7916  68.2%     - 1312s
     0     0 50600.9552    0  381 30124.8122 50600.9552  68.0%     - 1327s
H    0     0                    30125.211348 50600.8914  68.0%     - 1329s
     0     0 50588.9716    0  385 30125.2113 50588.9716  67.9%     - 1336s
     0     0 50585.2789    0  386 30125.2113 50585.2789  67.9%     - 1340s
     0     0 50584.6523    0  379 30125.2113 50584.6523  67.9%     - 1341s
     0     0 50572.2012    0  390 30125.2113 50572.2012  67.9%     - 1354s
     0     0 50564.0749    0  390 30125.2113 50564.0749  67.8%     - 1374s
     0     0 50558.8633    0  388 30125.2113 50558.8633  67.8%     - 1378s
     0     0 50556.8838    0  389 30125.2113 50556.8838  67.8%     - 1381s
     0     0 50539.9823    0  391 30125.2113 50539.9823  67.8%     - 1390s
     0     0 50538.4037    0  382 30125.2113 50538.4037  67.8%     - 1395s
     0     0 50529.0451    0  380 30125.2113 50529.0451  67.7%     - 1403s
     0     0 50528.4894    0  380 30125.2113 50528.4894  67.7%     - 1413s
     0     0 50523.1029    0  384 30125.2113 50523.1029  67.7%     - 1422s
     0     0 50519.9607    0  394 30125.2113 50519.9607  67.7%     - 1426s
     0     0 50519.1830    0  396 30125.2113 50519.1830  67.7%     - 1428s
     0     0 50518.0565    0  376 30125.2113 50518.0565  67.7%     - 1433s
     0     0 50517.7937    0  376 30125.2113 50517.7937  67.7%     - 1439s
H    0     0                    30139.121064 50517.7937  67.6%     - 1724s
     0     2 50517.7937    0  376 30139.1211 50517.7937  67.6%     - 1839s
     1     4 50448.6748    1  379 30139.1211 50516.7488  67.6% 20300 1875s
     3     8 50400.6074    2  430 30139.1211 50448.5275  67.4% 19283 1911s
     7    16 50338.9189    3  415 30139.1211 50400.4753  67.2% 19856 1946s
    15    30 49753.2735    4  369 30139.1211 50338.7723  67.0% 19850 2010s
    29    44 48693.2277    5  375 30139.1211 49840.9331  65.4% 35412 2158s
    43    72 47219.5233    6  360 30139.1211 49840.9331  65.4% 32472 2405s
    71   107 47023.4384    7  287 30139.1211 49840.9331  65.4% 33669 2481s
H   85   107                    30145.490741 49840.9331  65.3% 30959 2481s
H   89   107                    30298.943693 49840.9331  64.5% 30710 2481s
   106   139 44225.0594    8  225 30298.9437 49840.9331  64.5% 28418 2549s
   138   173 44178.1141    9  228 30298.9437 49840.9331  64.5% 27301 2618s
H  161   173                    30468.737581 49840.9331  63.6% 24331 2618s
   172   310 44013.1157   11  327 30468.7376 49840.9331  63.6% 23230 2712s
   309   403 43724.1513   15  315 30468.7376 49840.9331  63.6% 16729 2765s
   402   468 43448.0833   19  223 30468.7376 49840.9331  63.6% 14884 2825s
   475   524 43216.0343   22  314 30468.7376 49840.9331  63.6% 14053 2882s
   531   605 42885.0557   23  200 30468.7376 49840.9331  63.6% 13997 2918s
   620   678 42339.7943   25  234 30468.7376 49840.9331  63.6% 13678 2949s
   703   744 42278.7062   28  187 30468.7376 49840.9331  63.6% 13254 2986s
   775   808 41986.9360   32  220 30468.7376 49840.9331  63.6% 12976 3018s
   849   840 31798.9926   33  128 30468.7376 49840.9331  63.6% 12664 3107s
   891   937 31770.6804   34  124 30468.7376 49840.9331  63.6% 12584 3136s
   992  1020 30840.9559   40  126 30468.7376 49840.9331  63.6% 12094 3172s
  1104  1071 30571.2403   46  110 30468.7376 49840.9331  63.6% 11663 3208s
  1196  1112 34499.7838   30  122 30468.7376 49840.9331  63.6% 11428 3242s
  1255  1150 34302.6695   31  124 30468.7376 49840.9331  63.6% 11351 3278s
  1347  1201 33429.0137   35  119 30468.7376 49840.9331  63.6% 11128 3321s
  1459  1279 32343.3008   40   97 30468.7376 49840.9331  63.6% 10937 3361s
  1592  1355 31467.0381   50   55 30468.7376 49840.9331  63.6% 10625 3399s
  1747  1375 36164.8308   31  224 30468.7376 49840.9331  63.6% 10200 3442s
  1863  1444 36113.6693   32  211 30468.7376 49840.9331  63.6% 10076 3485s
  1956  1524     cutoff   33      30468.7376 49840.9331  63.6% 10178 3526s
  2065  1624 35069.7461   45  200 30468.7376 49840.9331  63.6% 10230 3573s
  2185  1720 34901.4799   51  276 30468.7376 49840.9331  63.6% 10242 3600s

Cutting planes:
  Learned: 1
  Gomory: 18
  Implied bound: 359
  MIR: 5294
  Flow cover: 4870
  RLT: 72
  Relax-and-lift: 613
  BQP: 2

Explored 2325 nodes (24325518 simplex iterations) in 3600.10 seconds (9203.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 30468.7 30298.9 30145.5 ... 29512.8

Time limit reached
Best objective 3.046873758073e+04, best bound 4.984093312862e+04, gap 63.5806%
  WARNING: Time limit reached. Using best solution found (gap: 63.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 30468.74, θ = 184239.86
  Upper Bound (UB) = 30468.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 184239.86
  [DEBUG]   ✓ Scenario 0: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 184239.86 ≤ Q = 184239.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 184239.86 ≤ Q = 184239.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 184239.86 ≤ Q = 184239.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xf80b930
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0f80b930
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.412349e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 6840891.5217
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.550626e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155062.58    0  124 6840891.52 -155062.58   102%     -    0s
H    0     0                    -120458.8245 -155062.58  28.7%     -    0s
H    0     0                    -121516.8296 -155062.58  27.6%     -    0s
H    0     0                    -126968.6754 -131547.39  3.61%     -    0s
     0     0 -131547.39    0   89 -126968.68 -131547.39  3.61%     -    0s
H    0     0                    -127534.8241 -131425.14  3.05%     -    0s
     0     0 -130220.72    0   81 -127534.82 -130220.72  2.11%     -    0s
H    0     0                    -129171.3506 -130217.94  0.81%     -    0s
H    0     0                    -129183.9274 -130217.94  0.80%     -    0s
H    0     0                    -129197.4919 -130217.94  0.79%     -    0s
H    0     0                    -129218.2932 -129741.19  0.40%     -    0s
     0     0 -129741.19    0   56 -129218.29 -129741.19  0.40%     -    0s
     0     0 -129630.64    0   67 -129218.29 -129630.64  0.32%     -    0s
     0     0 -129628.55    0   68 -129218.29 -129628.55  0.32%     -    0s
     0     0 -129421.99    0   50 -129218.29 -129421.99  0.16%     -    0s
H    0     0                    -129231.9792 -129402.36  0.13%     -    0s
     0     0 -129402.36    0   51 -129231.98 -129402.36  0.13%     -    0s
     0     0 -129347.71    0   46 -129231.98 -129347.71  0.09%     -    0s
     0     0 -129347.71    0   32 -129231.98 -129347.71  0.09%     -    0s
     0     0 -129347.71    0    7 -129231.98 -129347.71  0.09%     -    0s
     0     0 -129259.27    0    2 -129231.98 -129259.27  0.02%     -    0s
H    0     0                    -129255.6881 -129259.27  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 3
  MIR: 24
  Flow cover: 8

Explored 1 nodes (744 simplex iterations) in 0.05 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -129256 -129232 -129218 ... 6.84089e+06
No other solutions better than -129256

Optimal solution found (tolerance 1.00e-04)
Best objective -1.292556880686e+05, best bound -1.292556880686e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 178665.61
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129255.69
  [DEBUG]   S×d_nominal = 307921.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307921.30 + -129255.69 = 178665.61
  [DEBUG]   Current θ from Master = 184239.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5574.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24894.49
  Lower Bound (LB) = 30362.81
  Gap (UB-LB) = 105.9251, Absolute Gap = 105.9251, Relative Gap = 0.003477
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 25
Total Time: 71546.98s
Converged: True
Final Lower Bound: 30362.8125
Final Upper Bound: 30468.7376
Final Gap: 105.925073
Number of Critical Scenarios: 25
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 4, 5, 9] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 9 customers  Mode 2: 41 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 25
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-05 08:23:23
Total Time: 71546.98s
Optimal Value: 30362.81
Lower Bound: 30362.81
Upper Bound: 30468.74
Gap: 105.925073
Plants Opened: {0: [0], 1: [2], 2: [0]} (3 plants)
DCs Opened: [0, 4, 5, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed13_HD_gamma20_20260105_082324.csv

Total Execution Time: 71547.53 seconds
End Time: 2026-01-05 08:23:24

All tasks completed successfully!

