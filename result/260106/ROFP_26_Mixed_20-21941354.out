
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 26
DI Scenario: Mixed
Start Time: 2026-01-04 12:31:24
================================================================================
Loading data from data/DH_data_full_seed26.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
  Product 1: ['1.000', '1.207', '1.456'] (k=0.463)
  Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1015, max=1762
  DC capacity (MC): min=419, max=830

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.89, max=34.98, count=80
  Deviation (μ̂): min=4.07, max=9.87

Costs:
  Plant fixed cost: min=5727, max=9546
  DC fixed cost: min=3464, max=5845
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
    Product 1: ['1.000', '1.468', '2.155'] (k=0.947)
    Product 2: ['1.000', '1.491', '2.223'] (k=0.985)
  MD:
    Product 0: ['1.000', '1.174', '1.378'] (k=0.396)
    Product 1: ['1.000', '1.207', '1.456'] (k=0.463)
    Product 2: ['1.000', '1.190', '1.416'] (k=0.429)
  LD:
    Product 0: ['1.000', '1.097', '1.204'] (k=0.229)
    Product 1: ['1.000', '1.011', '1.023'] (k=0.028)
    Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
  Mixed:
    Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
    Product 1: ['1.000', '1.207', '1.456'] (k=0.463)
    Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x8ae632be
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.13s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -308073.5422
Found heuristic solution: objective -192490.8375

Root relaxation: objective 7.452505e+04, 5412 iterations, 0.41 seconds (0.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 74525.0476    0  644 -192490.84 74525.0476   139%     -    0s
H    0     0                    -187673.8941 74525.0476   140%     -    0s
     0     0 70812.5491    0  924 -187673.89 70812.5491   138%     -    1s
H    0     0                    -177783.3964 70812.3246   140%     -    1s
     0     0 70719.3973    0  933 -177783.40 70719.3973   140%     -    1s
     0     0 70719.0645    0  932 -177783.40 70719.0645   140%     -    1s
     0     0 70717.4519    0  931 -177783.40 70717.4519   140%     -    1s
     0     0 70601.7179    0  931 -177783.40 70601.7179   140%     -    1s
H    0     0                    -169597.5969 67825.7176   140%     -    2s
     0     0 67825.7176    0 1025 -169597.60 67825.7176   140%     -    2s
     0     0 67642.0691    0 1042 -169597.60 67642.0691   140%     -    2s
     0     0 67601.3252    0 1041 -169597.60 67601.3252   140%     -    3s
     0     0 67601.3252    0 1041 -169597.60 67601.3252   140%     -    3s
H    0     0                    -166656.8621 64426.2739   139%     -    5s
     0     0 64426.2739    0 1177 -166656.86 64426.2739   139%     -    5s
H    0     0                    -150386.6558 64095.7693   143%     -    5s
H    0     0                    -137157.8095 64095.7693   147%     -    5s
     0     0 64095.7693    0 1177 -137157.81 64095.7693   147%     -    5s
     0     0 64022.7607    0 1186 -137157.81 64022.7607   147%     -    6s
     0     0 64014.1522    0 1181 -137157.81 64014.1522   147%     -    6s
     0     0 64011.1276    0 1186 -137157.81 64011.1276   147%     -    6s
H    0     0                    -137153.3526 64011.1276   147%     -    7s
H    0     0                    -136494.5763 64011.1276   147%     -    7s
H    0     0                    -132696.3064 64011.1276   148%     -    7s
H    0     0                    -130128.4742 64011.1276   149%     -    7s
H    0     0                    -130102.0038 64011.1276   149%     -    7s
H    0     0                    -127576.4293 64011.1276   150%     -    7s
H    0     0                    -27053.24050 64011.1276   337%     -    7s
H    0     0                    -18783.85630 64011.1276   441%     -    7s
     0     0 59939.1277    0 1199 -18783.856 59939.1277   419%     -    9s
     0     0 59629.4163    0 1213 -18783.856 59629.4163   417%     -   10s
H    0     0                    -18472.14926 59529.3675   422%     -   10s
     0     0 59529.3675    0 1219 -18472.149 59529.3675   422%     -   10s
     0     0 59514.1767    0 1232 -18472.149 59514.1767   422%     -   10s
H    0     0                    -18296.32458 59512.2471   425%     -   10s
H    0     0                    -17571.13856 59512.2471   439%     -   10s
     0     0 59512.2471    0 1227 -17571.139 59512.2471   439%     -   10s
H    0     0                    -15314.90689 59512.2471   489%     -   10s
H    0     0                    -15074.86603 59512.2471   495%     -   10s
H    0     0                    -12801.34200 59512.2471   565%     -   10s
H    0     0                    -12605.20013 57595.8477   557%     -   12s
H    0     0                    -12449.82497 57595.8477   563%     -   12s
H    0     0                    -12432.69100 57595.8477   563%     -   12s
H    0     0                    -12381.09046 57595.8477   565%     -   12s
H    0     0                    -12196.91639 57595.8477   572%     -   12s
H    0     0                    -12161.78796 57595.8477   574%     -   12s
H    0     0                    -12091.39191 57595.8477   576%     -   12s
H    0     0                    -12056.26348 57595.8477   578%     -   12s
     0     0 57595.8477    0 1171 -12056.263 57595.8477   578%     -   12s
     0     0 57264.2285    0 1213 -12056.263 57264.2285   575%     -   13s
     0     0 57184.6938    0 1248 -12056.263 57184.6938   574%     -   14s
     0     0 57177.7824    0 1246 -12056.263 57177.7824   574%     -   14s
H    0     0                    -11647.88422 55949.8425   580%     -   16s
H    0     0                    -11477.76344 55949.8425   587%     -   16s
H    0     0                    -11431.37299 55949.8425   589%     -   16s
H    0     0                    -11336.13507 55949.8425   594%     -   16s
H    0     0                    -11237.87078 55949.8425   598%     -   16s
H    0     0                    -11205.01204 55949.8425   599%     -   16s
H    0     0                    -11076.56569 55949.8425   605%     -   16s
H    0     0                    -10932.81729 55949.8425   612%     -   16s
H    0     0                    -6833.140715 55949.8425   919%     -   16s
     0     0 55949.8425    0 1197 -6833.1407 55949.8425   919%     -   16s
     0     0 55741.1287    0 1226 -6833.1407 55741.1287   916%     -   17s
H    0     0                    -6730.010539 55710.2154   928%     -   17s
H    0     0                    -6553.506687 55710.2154   950%     -   17s
     0     0 55710.2154    0 1227 -6553.5067 55710.2154   950%     -   17s
     0     0 55702.0208    0 1235 -6553.5067 55702.0208   950%     -   18s
H    0     0                    -6451.296726 53599.9127   931%     -   20s
H    0     0                    -5710.209350 53599.9127  1039%     -   20s
H    0     0                    -5689.913161 53599.9127  1042%     -   20s
     0     0 53599.9127    0 1160 -5689.9132 53599.9127  1042%     -   20s
     0     0 53273.7491    0 1232 -5689.9132 53273.7491  1036%     -   21s
     0     0 53179.1503    0 1263 -5689.9132 53179.1503  1035%     -   22s
     0     0 53157.8451    0 1253 -5689.9132 53157.8451  1034%     -   22s
     0     0 53152.7405    0 1258 -5689.9132 53152.7405  1034%     -   22s
H    0     0                    7646.5544945 51016.5810   567%     -   26s
H    0     0                    7889.2125339 51016.5810   547%     -   26s
H    0     0                    8190.2373751 51016.5810   523%     -   26s
H    0     0                    8194.4058850 51016.5810   523%     -   26s
H    0     0                    8344.9153504 51016.5810   511%     -   26s
H    0     0                    8362.4305793 51016.5810   510%     -   26s
H    0     0                    8396.0723832 51016.5810   508%     -   26s
H    0     0                    8543.9803339 51016.5810   497%     -   26s
H    0     0                    8554.6125471 51016.5810   496%     -   26s
H    0     0                    8626.6251123 51016.5810   491%     -   26s
H    0     0                    8885.3728107 51016.5810   474%     -   26s
     0     0 51016.5810    0 1140 8885.37281 51016.5810   474%     -   26s
H    0     0                    9051.2573598 50617.4190   459%     -   28s
H    0     0                    9127.2751791 50617.4190   455%     -   28s
H    0     0                    9174.1575787 50617.4190   452%     -   28s
H    0     0                    9216.1043401 50617.4190   449%     -   28s
H    0     0                    9562.6318970 50617.4190   429%     -   28s
     0     0 50617.4190    0 1190 9562.63190 50617.4190   429%     -   28s
H    0     0                    9604.8105065 50540.3638   426%     -   28s
H    0     0                    9679.2504278 50540.3638   422%     -   28s
     0     0 50540.3638    0 1192 9679.25043 50540.3638   422%     -   28s
     0     0 50524.6850    0 1197 9679.25043 50524.6850   422%     -   29s
H    0     0                    9853.4765961 44014.0754   347%     -   34s
     0     0 44014.0754    0 1044 9853.47660 44014.0754   347%     -   34s
     0     0 43090.6359    0 1078 9853.47660 43090.6359   337%     -   35s
     0     0 42892.3306    0 1107 9853.47660 42892.3306   335%     -   36s
     0     0 42853.9279    0 1118 9853.47660 42853.9279   335%     -   37s
     0     0 42842.1462    0 1130 9853.47660 42842.1462   335%     -   37s
     0     0 32795.3632    0  762 9853.47660 32795.3632   233%     -   41s
H    0     0                    9875.2954040 31750.4257   222%     -   42s
     0     0 31750.4257    0  786 9875.29540 31750.4257   222%     -   42s
     0     0 31356.5771    0  803 9875.29540 31356.5771   218%     -   43s
     0     0 31261.3409    0  814 9875.29540 31261.3409   217%     -   43s
     0     0 31228.7581    0  800 9875.29540 31228.7581   216%     -   43s
     0     0 29728.5788    0  824 9875.29540 29728.5788   201%     -   46s
     0     0 29297.1416    0  892 9875.29540 29297.1416   197%     -   47s
     0     0 29170.4659    0  913 9875.29540 29170.4659   195%     -   47s
     0     0 29130.9282    0  918 9875.29540 29130.9282   195%     -   48s
H    0     0                    10024.620026 28007.0148   179%     -   50s
     0     0 28007.0148    0  891 10024.6200 28007.0148   179%     -   50s
     0     0 27708.5176    0  925 10024.6200 27708.5176   176%     -   51s
     0     0 27625.3512    0  948 10024.6200 27625.3512   176%     -   52s
     0     0 27595.7259    0  967 10024.6200 27595.7259   175%     -   52s
     0     0 26783.5185    0  885 10024.6200 26783.5185   167%     -   54s
     0     0 26585.6030    0  897 10024.6200 26585.6030   165%     -   55s
     0     0 26540.2480    0  885 10024.6200 26540.2480   165%     -   56s
     0     0 26133.2127    0  883 10024.6200 26133.2127   161%     -   58s
     0     0 25987.8161    0  945 10024.6200 25987.8161   159%     -   58s
     0     0 25940.0997    0  958 10024.6200 25940.0997   159%     -   59s
H    0     0                    10056.368040 25612.8429   155%     -   61s
     0     0 25612.8429    0  900 10056.3680 25612.8429   155%     -   61s
     0     0 25612.7077    0  900 10056.3680 25612.7077   155%     -   61s
     0     2 25612.6413    0  900 10056.3680 25612.6413   155%     -   64s
     1     4 25040.6346    1  847 10056.3680 25612.6413   155%  3994   66s
     7    16 23794.9660    3  726 10056.3680 25051.6649   149%  3281   71s
    31    63 22684.4698    5  721 10056.3680 24330.0600   142%  3806   90s
H   32    63                    10059.021571 24330.0600   142%  3687   90s
H   36    63                    10095.625572 24330.0600   141%  3977   90s
H   52    63                    10107.259772 24326.7597   141%  4723   90s
H   94   242                    10424.956919 24326.7597   133%  3996   95s
H  176   242                    10433.872634 24326.7597   133%  2565   95s
   387   407 11458.7330   12  413 10433.8726 24296.2893   133%  1562  101s
H  405   407                    10473.608698 24296.2893   132%  1525  101s
H  603   616                    10504.302595 24296.2893   131%  1203  103s
   661   719 12872.6769   17  476 10504.3026 24296.2893   131%  1126  105s
H  856   821                    10557.776423 23993.8854   127%   968  107s
  1339  1376 10870.3844   32  351 10557.7764 23993.8854   127%   726  110s
  1846  1734 20615.4951   22  382 10557.7764 23884.2105   126%   606  115s
H 2164  1898                    10580.691266 23721.4618   124%   573  118s
H 2166  1898                    10676.867412 23721.4618   122%   573  118s
H 2174  1898                    10703.937170 23721.4618   122%   572  118s
  2410  2230 16204.5936   40  200 10703.9372 23721.4618   122%   545  120s
  2928  2460 19783.8587   10  334 10703.9372 23360.0127   118%   519  125s
H 2984  2454                    10847.712864 23360.0127   115%   516  125s
  3536  2918 14159.2355   20  383 10847.7129 23360.0127   115%   486  131s
H 3989  3039                    11182.625492 23214.7407   108%   474  149s
H 3989  3039                    11191.626106 23214.7407   107%   474  149s
H 3989  2955                    11549.918034 23214.7407   101%   474  153s
H 3989  2882                    11785.051957 23214.7407  97.0%   474  153s
H 3989  2861                    11843.813997 23214.7407  96.0%   474  154s
H 3989  2848                    11895.374538 23214.7407  95.2%   474  155s
H 3989  2823                    11964.486704 23214.7407  94.0%   474  157s
  3990  2816 13227.7550   29  900 11964.4867 23214.7407  94.0%   474  171s
  4002  2824 19490.1423   14  474 11964.4867 23037.5844  92.5%   473  175s
  4027  2841 13653.5297   34  396 11964.4867 21862.4591  82.7%   470  181s
  4187  2934     cutoff   19      11964.4867 18222.1417  52.3%   474  185s
H 4371  2782                    11993.729532 18222.1417  51.9%   467  186s
* 4873  2530              27    12055.861840 16668.1727  38.3%   445  189s
  4989  2503     cutoff   24      12055.8618 16587.0043  37.6%   439  190s
  5972  1921     cutoff   25      12055.8618 13616.0498  12.9%   399  195s

Cutting planes:
  Implied bound: 2
  Projected implied bound: 3
  MIR: 169
  Flow cover: 348
  RLT: 3
  Relax-and-lift: 54

Explored 5998 nodes (2504216 simplex iterations) in 196.70 seconds (236.87 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12055.9 11993.7 11964.5 ... 10703.9

Optimal solution found (tolerance 1.00e-04)
Best objective 1.205586184012e+04, best bound 1.205586184012e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 196.70s
  Master Objective (UB) = 12055.86, θ = 159923.48
  Upper Bound (UB) = 12055.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 159923.48
  [DEBUG]   ✓ Scenario 0: θ = 159923.48 ≤ Q = 159923.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x114c5c1a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeeb3a3e6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.304052e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5781034.1623
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.544968e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154496.76    0  125 5781034.16 -154496.76   103%     -    0s
H    0     0                    -120594.4269 -154496.76  28.1%     -    0s
H    0     0                    -120899.6273 -154496.76  27.8%     -    0s
H    0     0                    -123425.8226 -123425.82  0.00%     -    0s
     0     0          -    0      -123425.82 -123425.82  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (371 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -123426 -120900 -120594 ... 1.30405e+13
No other solutions better than -123426

Optimal solution found (tolerance 1.00e-04)
Best objective -1.234258226163e+05, best bound -1.234258226163e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 131041.82
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123425.82
  [DEBUG]   S×d_nominal = 254467.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254467.64 + -123425.82 = 131041.82
  [DEBUG]   Current θ from Master = 159923.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 28881.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16825.79
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 28881.6554, Absolute Gap = 28881.6554, Relative Gap = 2.395652
  Not converged yet (gap = 28881.66 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xac34fde6
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -16825.8 (0.02s)
MIP start from previous solve produced solution with objective -16825.8 (0.02s)
Loaded MIP start from previous solve with objective -16825.8

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.45s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.213229e+04, 10415 iterations, 2.25 seconds (3.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22132.2907    0  411 -16825.794 22132.2907   232%     -    2s
H    0     0                    -16557.42891 22132.2907   234%     -    3s
H    0     0                    -11579.56929 22132.2907   291%     -    3s
H    0     0                    -10228.12858 22132.2907   316%     -    3s
H    0     0                    -10126.37204 22132.2907   319%     -    3s
H    0     0                    -10035.91904 22132.2907   321%     -    3s
H    0     0                    -10022.82376 22132.2907   321%     -    3s
H    0     0                    -9991.313195 22132.2907   322%     -    3s
H    0     0                    -9985.051582 22132.2907   322%     -    3s
H    0     0                    -9926.602704 22132.2907   323%     -    3s
H    0     0                    -9885.125138 22132.2907   324%     -    3s
H    0     0                    -9786.961492 22132.2907   326%     -    3s
H    0     0                    -9779.971046 22132.2907   326%     -    3s
H    0     0                    -9620.571066 22132.2907   330%     -    3s
H    0     0                    -9566.650790 22132.2907   331%     -    3s
     0     0 14644.3870    0  565 -9566.6508 14644.3870   253%     -    5s
H    0     0                    -9490.355444 14644.1036   254%     -    5s
H    0     0                    -9465.859801 14644.1036   255%     -    5s
     0     0 14567.2922    0  562 -9465.8598 14567.2922   254%     -    5s
     0     0 9518.27143    0  591 -9465.8598 9518.27143   201%     -    8s
H    0     0                    -9440.005966 9518.23123   201%     -    8s
H    0     0                    -9353.974973 9518.23123   202%     -    8s
H    0     0                    -9351.282323 9518.23123   202%     -    8s
H    0     0                    -9244.272703 9518.23123   203%     -    8s
     0     0 9030.86425    0  618 -9244.2727 9030.86425   198%     -    8s
     0     0 8972.64134    0  612 -9244.2727 8972.64134   197%     -    9s
     0     0 8960.87290    0  613 -9244.2727 8960.87290   197%     -    9s
     0     0 8960.67971    0  606 -9244.2727 8960.67971   197%     -    9s
H    0     0                    -9192.209501 5206.75521   157%     -   13s
H    0     0                    -9190.383862 5206.75521   157%     -   13s
H    0     0                    -9111.242859 5206.75521   157%     -   13s
H    0     0                    -9015.595057 5206.75521   158%     -   13s
H    0     0                    -8798.015305 5206.75521   159%     -   13s
H    0     0                    -8703.575806 5206.75521   160%     -   13s
H    0     0                    -8671.812112 5206.75521   160%     -   13s
H    0     0                    -8643.952363 5206.75521   160%     -   13s
H    0     0                    -8595.166624 5206.75521   161%     -   13s
     0     0 5206.75521    0  669 -8595.1666 5206.75521   161%     -   13s
H    0     0                    -8584.469458 4436.35839   152%     -   15s
H    0     0                    -8578.516217 4436.35839   152%     -   15s
H    0     0                    -8536.212894 4436.35839   152%     -   15s
H    0     0                    -8499.863557 4436.35839   152%     -   15s
     0     0 4436.35839    0  658 -8499.8636 4436.35839   152%     -   15s
     0     0 4100.63707    0  669 -8499.8636 4100.63707   148%     -   15s
     0     0 3974.58740    0  672 -8499.8636 3974.58740   147%     -   16s
     0     0 3933.15522    0  684 -8499.8636 3933.15522   146%     -   16s
     0     0 3922.62321    0  703 -8499.8636 3922.62321   146%     -   16s
     0     0 3915.27463    0  694 -8499.8636 3915.27463   146%     -   16s
     0     0 3915.21467    0  694 -8499.8636 3915.21467   146%     -   16s
     0     0 1568.49509    0  689 -8499.8636 1568.49509   118%     -   21s
     0     0 1262.70726    0  712 -8499.8636 1262.70726   115%     -   22s
     0     0 1186.62680    0  739 -8499.8636 1186.62680   114%     -   23s
     0     0 1158.02800    0  738 -8499.8636 1158.02800   114%     -   23s
     0     0 1153.92671    0  748 -8499.8636 1153.92671   114%     -   23s
     0     0  248.45424    0  611 -8499.8636  248.45424   103%     -   26s
     0     0   70.50157    0  629 -8499.8636   70.50157   101%     -   27s
     0     0  -31.00648    0  631 -8499.8636  -31.00648   100%     -   27s
     0     0  -53.55382    0  635 -8499.8636  -53.55382  99.4%     -   28s
     0     0  -58.63971    0  649 -8499.8636  -58.63971  99.3%     -   28s
     0     0 -397.07513    0  593 -8499.8636 -397.07513  95.3%     -   30s
     0     0 -467.06189    0  608 -8499.8636 -467.06189  94.5%     -   31s
     0     0 -477.85785    0  610 -8499.8636 -477.85785  94.4%     -   31s
     0     0 -478.97376    0  677 -8499.8636 -478.97376  94.4%     -   32s
     0     0 -631.35750    0  570 -8499.8636 -631.35750  92.6%     -   33s
     0     0 -671.37360    0  582 -8499.8636 -671.37360  92.1%     -   33s
     0     0 -685.77857    0  483 -8499.8636 -685.77857  91.9%     -   34s
     0     0 -686.97335    0  538 -8499.8636 -686.97335  91.9%     -   34s
     0     0 -756.57901    0  597 -8499.8636 -756.57901  91.1%     -   35s
     0     0 -770.13998    0  609 -8499.8636 -770.13998  90.9%     -   36s
     0     0 -775.57588    0  675 -8499.8636 -775.57588  90.9%     -   36s
     0     0 -801.40402    0  674 -8499.8636 -801.40402  90.6%     -   37s
     0     0 -804.34325    0  614 -8499.8636 -804.34325  90.5%     -   37s
     0     0 -812.19426    0  616 -8499.8636 -812.19426  90.4%     -   38s
     0     0 -812.75055    0  616 -8499.8636 -812.75055  90.4%     -   39s
     0     2 -812.75055    0  616 -8499.8636 -812.75055  90.4%     -   46s
     7    16 -1287.7570    3  548 -8499.8636 -1215.6593  85.7%  1151   50s
    95   130 -3031.4683    7  506 -8499.8636 -1892.4657  77.7%  1096   56s
H  128   130                    -8472.488326 -1892.4657  77.7%   984   56s
   352   368 -5253.1284   11  450 -8472.4883 -1892.4657  77.7%   661   61s
   551   477 -4867.7189   17  288 -8472.4883 -1911.6434  77.4%   655   65s
   751   640     cutoff   20      -8472.4883 -1911.6434  77.4%   634   71s
   997   764 -4478.9865    8  263 -8472.4883 -2225.6432  73.7%   600   76s
  1251   944     cutoff   12      -8472.4883 -2429.4874  71.3%   576   80s
  1509  1033 -7209.5513   13  212 -8472.4883 -2451.6245  71.1%   543   85s
  1812  1189 -4645.4430   11  276 -8472.4883 -2516.5169  70.3%   534   91s
  2115  1376     cutoff   14      -8472.4883 -2660.5386  68.6%   515   96s
  2507  1515 infeasible   30      -8472.4883 -2660.5386  68.6%   485  100s
  2938  1643 -3799.6105   11  362 -8472.4883 -2965.9635  65.0%   482  106s
  3106  1727 -5191.2308   13  297 -8472.4883 -2966.4147  65.0%   478  110s
  3502  1887 -7421.7053   31  180 -8472.4883 -3075.9143  63.7%   476  116s
  3921  1994 -7080.6341   16  302 -8472.4883 -3182.1214  62.4%   474  121s
  4169  2024 -7594.4661   20  272 -8472.4883 -3393.5758  59.9%   471  125s
  4405  2190 -7521.1495   14  239 -8472.4883 -3542.4877  58.2%   475  132s
  4634  2316 -4994.8280    8  321 -8472.4883 -3593.4340  57.6%   472  136s
  5309  2460 -6116.0668   25  616 -8472.4883 -3658.9540  56.8%   455  154s
  5311  2461 -7323.3965   12  176 -8472.4883 -3658.9540  56.8%   455  157s
  5312  2462 -7275.2638   23  378 -8472.4883 -3658.9540  56.8%   455  160s
  5315  2464 -3879.7633   11  495 -8472.4883 -3658.9540  56.8%   455  165s
  5322  2469 -7622.4085   34  449 -8472.4883 -3658.9540  56.8%   454  170s
  5326  2471 -6894.2692   33  520 -8472.4883 -3658.9540  56.8%   454  175s
  5330  2474 -8067.0869   47  585 -8472.4883 -3658.9540  56.8%   453  180s
  5333  2476 -6275.5239   16  473 -8472.4883 -3658.9540  56.8%   453  186s
  5335  2480 -3658.9540   14  381 -8472.4883 -3658.9540  56.8%   459  192s
  5337  2484 -3658.9540   15  491 -8472.4883 -3658.9540  56.8%   460  195s
  5365  2521 -4831.6729   18  454 -8472.4883 -3658.9540  56.8%   466  200s
  5531  2537     cutoff   22      -8472.4883 -3737.5258  55.9%   471  206s
  5667  2472     cutoff   25      -8472.4883 -3737.5258  55.9%   469  210s
  6015  2297 -6800.8924   25  131 -8472.4883 -4192.2170  50.5%   464  215s
  6370  2145 -8471.8994   42   35 -8472.4883 -8352.4205  1.42%   447  220s
* 7257  1743              65    -8468.111224 -8432.7722  0.42%   394  221s
* 7268  1621              60    -8466.584949 -8432.7722  0.40%   393  221s

Cutting planes:
  Implied bound: 5
  Projected implied bound: 2
  MIR: 184
  Flow cover: 385
  RLT: 3
  Relax-and-lift: 42

Explored 7402 nodes (2904412 simplex iterations) in 221.69 seconds (330.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8466.58 -8468.11 -8472.49 ... -8671.81
No other solutions better than -8466.58

Optimal solution found (tolerance 1.00e-04)
Best objective -8.466584949176e+03, best bound -8.466584949176e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 221.70s
  Master Objective (UB) = -8466.58, θ = 122880.99
  Upper Bound (UB) = -8466.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 122880.99
  [DEBUG]   ✓ Scenario 0: θ = 122880.99 ≤ Q = 122880.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 122880.99 ≤ Q = 122880.99 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7bd6117d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7bd6117d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.337685e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6146368.5322
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.504540e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150454.01    0  133 6146368.53 -150454.01   102%     -    0s
H    0     0                    -112566.7058 -150454.01  33.7%     -    0s
H    0     0                    -135160.2589 -150454.01  11.3%     -    0s
H    0     0                    -135408.5330 -149818.16  10.6%     -    0s
     0     0 -139061.83    0  122 -135408.53 -139061.83  2.70%     -    0s
H    0     0                    -135952.8687 -139005.60  2.25%     -    0s
     0     0 -138422.87    0  116 -135952.87 -138422.87  1.82%     -    0s
     0     0 -138416.36    0  116 -135952.87 -138416.36  1.81%     -    0s
H    0     0                    -136266.7320 -138408.85  1.57%     -    0s
     0     0 -138408.85    0  116 -136266.73 -138408.85  1.57%     -    0s
     0     0 -137770.49    0   81 -136266.73 -137770.49  1.10%     -    0s
H    0     0                    -136435.6609 -137742.25  0.96%     -    0s
     0     0 -137677.82    0   87 -136435.66 -137677.82  0.91%     -    0s
     0     0 -137675.57    0   83 -136435.66 -137675.57  0.91%     -    0s
H    0     0                    -136501.4780 -137675.57  0.86%     -    0s
     0     0 -137521.04    0   19 -136501.48 -137521.04  0.75%     -    0s
H    0     0                    -137345.2132 -137514.16  0.12%     -    0s
     0     0 -137491.63    0   17 -137345.21 -137491.63  0.11%     -    0s
     0     0 -137476.53    0   14 -137345.21 -137476.53  0.10%     -    0s
     0     0 -137471.81    0   16 -137345.21 -137471.81  0.09%     -    0s
     0     0 -137461.85    0   12 -137345.21 -137461.85  0.08%     -    0s
H    0     0                    -137404.4920 -137459.72  0.04%     -    0s
H    0     0                    -137435.8826 -137459.72  0.02%     -    0s
     0     0 -137454.89    0    7 -137435.88 -137454.89  0.01%     -    0s
     0     0 -137454.89    0    6 -137435.88 -137454.89  0.01%     -    0s
     0     0 -137454.89    0    4 -137435.88 -137454.89  0.01%     -    0s
H    0     0                    -137447.7416 -137454.89  0.01%     -    0s

Explored 1 nodes (778 simplex iterations) in 0.20 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -137448 -137436 -137404 ... -135409

Optimal solution found (tolerance 1.00e-04)
Best objective -1.374477416205e+05, best bound -1.374548915935e+05, gap 0.0052%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 100895.11
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137447.74
  [DEBUG]   S×d_nominal = 238342.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 238342.85 + -137447.74 = 100895.11
  [DEBUG]   Current θ from Master = 122880.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21985.89 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30452.47
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 8359.2086, Absolute Gap = 8359.2086, Relative Gap = 0.987318
  Not converged yet (gap = 8359.21 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x5bd25f41
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -30452.5 (0.03s)
MIP start from previous solve produced solution with objective -30452.5 (0.03s)
Loaded MIP start from previous solve with objective -30452.5

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.65s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24818    6.3024068e+03   0.000000e+00   1.611968e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16132    1.0495034e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 1.049503e+04, 16132 iterations, 4.78 seconds (6.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10495.0343    0  164 -30452.473 10495.0343   134%     -    5s
H    0     0                    -15196.49762 10495.0343   169%     -    5s
H    0     0                    -13748.57380 10495.0343   176%     -    5s
H    0     0                    -13367.21629 10495.0343   179%     -    5s
H    0     0                    -13275.55041 10495.0343   179%     -    6s
     0     0 6914.96478    0  343 -13275.550 6914.96478   152%     -    8s
     0     0 5661.73072    0  325 -13275.550 5661.73072   143%     -   10s
     0     0 5659.29123    0  315 -13275.550 5659.29123   143%     -   11s
     0     0 5659.29123    0  318 -13275.550 5659.29123   143%     -   12s
     0     0 5659.29123    0  317 -13275.550 5659.29123   143%     -   12s
     0     0 5659.05466    0  319 -13275.550 5659.05466   143%     -   12s
     0     0 5658.04344    0  319 -13275.550 5658.04344   143%     -   12s
H    0     0                    -13249.16285 3550.87625   127%     -   16s
     0     0 3323.67315    0  389 -13249.163 3323.67315   125%     -   16s
H    0     0                    -11656.10630 3323.67315   129%     -   16s
H    0     0                    -11203.04674 3323.67315   130%     -   16s
H    0     0                    -11181.99609 3323.67315   130%     -   16s
H    0     0                    -10992.23449 3323.67315   130%     -   16s
H    0     0                    -10891.01497 3323.67315   131%     -   16s
H    0     0                    -10868.40798 3323.67315   131%     -   16s
H    0     0                    -10856.97796 3323.67315   131%     -   16s
     0     0 2895.94537    0  436 -10856.978 2895.94537   127%     -   17s
     0     0 2631.47831    0  421 -10856.978 2631.47831   124%     -   18s
     0     0 2563.62738    0  430 -10856.978 2563.62738   124%     -   18s
     0     0 2553.00911    0  430 -10856.978 2553.00911   124%     -   19s
     0     0 2551.54128    0  434 -10856.978 2551.54128   124%     -   19s
     0     0 2551.21049    0  437 -10856.978 2551.21049   123%     -   19s
H    0     0                    -10810.57803 2551.21049   124%     -   21s
H    0     0                    -10801.76872 2551.21049   124%     -   21s
H    0     0                    -10793.26696 2551.21049   124%     -   21s
H    0     0                    -10768.06190 2551.21049   124%     -   21s
H    0     0                    -10736.02817 1367.04118   113%     -   23s
H    0     0                    -10729.62714 1367.04118   113%     -   23s
H    0     0                    -10719.73543 1367.04118   113%     -   23s
     0     0 1367.04118    0  438 -10719.735 1367.04118   113%     -   23s
H    0     0                    -10701.21816 1365.28427   113%     -   23s
     0     0  735.62669    0  438 -10701.218  735.62669   107%     -   25s
     0     0  510.58459    0  465 -10701.218  510.58459   105%     -   26s
     0     0  481.63038    0  453 -10701.218  481.63038   105%     -   26s
     0     0  462.37099    0  431 -10701.218  462.37099   104%     -   27s
     0     0  453.64557    0  423 -10701.218  453.64557   104%     -   27s
     0     0  448.32571    0  482 -10701.218  448.32571   104%     -   27s
     0     0  447.62993    0  485 -10701.218  447.62993   104%     -   27s
     0     0 -383.23052    0  427 -10701.218 -383.23052  96.4%     -   32s
H    0     0                    -10672.04708 -386.42231  96.4%     -   33s
H    0     0                    -10670.71801 -386.42231  96.4%     -   33s
     0     0 -773.28853    0  464 -10670.718 -773.28853  92.8%     -   34s
     0     0 -917.44552    0  569 -10670.718 -917.44552  91.4%     -   36s
     0     0 -1033.0276    0  539 -10670.718 -1033.0276  90.3%     -   37s
     0     0 -1064.4658    0  547 -10670.718 -1064.4658  90.0%     -   37s
     0     0 -1076.2747    0  547 -10670.718 -1076.2747  89.9%     -   38s
     0     0 -1081.5882    0  555 -10670.718 -1081.5882  89.9%     -   38s
     0     0 -1082.2191    0  554 -10670.718 -1082.2191  89.9%     -   38s
     0     0 -1211.1718    0  487 -10670.718 -1211.1718  88.6%     -   40s
     0     0 -1268.0066    0  498 -10670.718 -1268.0066  88.1%     -   41s
     0     0 -1290.5752    0  509 -10670.718 -1290.5752  87.9%     -   41s
     0     0 -1296.3159    0  503 -10670.718 -1296.3159  87.9%     -   42s
     0     0 -1298.9802    0  508 -10670.718 -1298.9802  87.8%     -   42s
     0     0 -1299.7183    0  510 -10670.718 -1299.7183  87.8%     -   42s
     0     0 -1362.6799    0  568 -10670.718 -1362.6799  87.2%     -   43s
     0     0 -1379.9858    0  518 -10670.718 -1379.9858  87.1%     -   44s
     0     0 -1385.9408    0  513 -10670.718 -1385.9408  87.0%     -   44s
     0     0 -1389.1366    0  518 -10670.718 -1389.1366  87.0%     -   45s
     0     0 -1389.9378    0  521 -10670.718 -1389.9378  87.0%     -   45s
     0     0 -1410.7566    0  621 -10670.718 -1410.7566  86.8%     -   46s
H    0     0                    -10656.51225 -1419.7835  86.7%     -   47s
     0     0 -1419.7835    0  584 -10656.512 -1419.7835  86.7%     -   47s
     0     0 -1422.9358    0  590 -10656.512 -1422.9358  86.6%     -   47s
     0     0 -1424.9613    0  589 -10656.512 -1424.9613  86.6%     -   47s
     0     0 -1425.1978    0  596 -10656.512 -1425.1978  86.6%     -   47s
     0     0 -1446.0472    0  515 -10656.512 -1446.0472  86.4%     -   49s
H    0     0                    -10654.10073 -1448.1901  86.4%     -   49s
H    0     0                    -10652.53799 -1448.1901  86.4%     -   49s
H    0     0                    -10640.89720 -1448.1901  86.4%     -   49s
H    0     0                    -10626.93381 -1448.1901  86.4%     -   49s
     0     0 -1458.8353    0  525 -10626.934 -1458.8353  86.3%     -   49s
     0     0 -1465.5147    0  533 -10626.934 -1465.5147  86.2%     -   50s
     0     0 -1466.8337    0  534 -10626.934 -1466.8337  86.2%     -   50s
     0     0 -1484.6418    0  514 -10626.934 -1484.6418  86.0%     -   51s
     0     0 -1488.8699    0  516 -10626.934 -1488.8699  86.0%     -   52s
     0     0 -1490.4470    0  519 -10626.934 -1490.4470  86.0%     -   52s
     0     0 -1495.6269    0  529 -10626.934 -1495.6269  85.9%     -   53s
     0     0 -1499.4029    0  524 -10626.934 -1499.4029  85.9%     -   54s
     0     0 -1500.3015    0  523 -10626.934 -1500.3015  85.9%     -   54s
     0     0 -1519.9799    0  545 -10626.934 -1519.9799  85.7%     -   55s
     0     0 -1525.3869    0  543 -10626.934 -1525.3869  85.6%     -   56s
     0     0 -1526.9778    0  557 -10626.934 -1526.9778  85.6%     -   56s
     0     0 -1536.1812    0  574 -10626.934 -1536.1812  85.5%     -   57s
     0     0 -1538.8838    0  571 -10626.934 -1538.8838  85.5%     -   58s
     0     0 -1542.4865    0  565 -10626.934 -1542.4865  85.5%     -   58s
     0     0 -1543.4260    0  566 -10626.934 -1543.4260  85.5%     -   58s
     0     0 -1549.5194    0  565 -10626.934 -1549.5194  85.4%     -   59s
     0     0 -1550.7203    0  566 -10626.934 -1550.7203  85.4%     -   60s
     0     0 -1558.3370    0  563 -10626.934 -1558.3370  85.3%     -   61s
     0     0 -1558.4274    0  563 -10626.934 -1558.4274  85.3%     -   61s
     0     2 -1558.4274    0  563 -10626.934 -1558.4274  85.3%     -   83s
     3     8 -1727.3379    2  560 -10626.934 -1601.5170  84.9%  1389   85s
    15    32 -1997.4425    4  625 -10626.934 -1843.6447  82.7%  2512   93s
    31    64 -2395.7109    5  639 -10626.934 -1998.2265  81.2%  3717   96s
    95   210 -2813.0004    7  640 -10626.934 -2396.7820  77.4%  3002  102s
   209   298 -3284.9252   10  623 -10626.934 -2396.7820  77.4%  1782  105s
   373   398 -3344.9276   11  571 -10626.934 -2396.7820  77.4%  1325  110s
   483   501 -6504.2958   14  473 -10626.934 -2396.7820  77.4%  1212  119s
H  521   501                    -10618.26249 -2617.1176  75.4%  1175  119s
   522   578 -3637.1270   14  620 -10618.262 -2617.1176  75.4%  1178  122s
   607   648 -3867.9259   15  496 -10618.262 -2617.1176  75.4%  1118  127s
   760   757 -3888.8269   16  503 -10618.262 -2753.5312  74.1%  1030  133s
   826   825 -6090.1577   17  622 -10618.262 -2753.5312  74.1%  1023  137s
   904   855 -4037.5322   17  506 -10618.262 -2813.4879  73.5%  1001  141s
   977   913 -4326.1285   19  495 -10618.262 -2813.4879  73.5%  1001  148s
  1018   973 -4651.3950   20  499 -10618.262 -2813.4879  73.5%  1002  150s
H 1133  1036                    -10616.02659 -2813.4879  73.5%   966  154s
  1165  1117 -4793.7621   21  501 -10616.027 -3118.7623  70.6%   957  156s
  1258  1186 -5527.7030   23  441 -10616.027 -3118.7623  70.6%   937  161s
  1434  1331 -5814.2928   25  427 -10616.027 -3236.0687  69.5%   928  166s
  1574  1466 -6203.0083   27  522 -10616.027 -3236.0687  69.5%   908  172s
  1665  1533 -6858.4028   31  479 -10616.027 -3236.0687  69.5%   887  175s
  1885  1736 -7464.3972   40  411 -10616.027 -3236.0687  69.5%   841  182s
  2014  1813 -7849.1028   47  453 -10616.027 -3236.0687  69.5%   825  186s
  2266  1979     cutoff   59      -10616.027 -3236.0687  69.5%   813  194s
  2407  2003 -9620.4902   63  303 -10616.027 -3335.2825  68.6%   806  199s
  2523  2037 -9965.9051   67  291 -10616.027 -3339.1135  68.5%   827  205s
  2717  2132 -6608.3059   12  386 -10616.027 -3456.7453  67.4%   875  214s
  2840  2171 -7702.9529   14  395 -10616.027 -3486.6556  67.2%   885  219s
H 2879  2171                    -10611.51711 -3501.0518  67.0%   889  219s
  2905  2299 -9039.4757   16  296 -10611.517 -3555.8128  66.5%   892  226s
  3091  2416 infeasible   26      -10611.517 -3555.8128  66.5%   885  233s
  3300  2521 -10429.377   32  158 -10611.517 -3583.4611  66.2%   878  239s
  3485  2611 -5552.2850    9  521 -10611.517 -3720.7669  64.9%   879  245s
  3672  2682 -6468.5830   11  390 -10611.517 -3720.7669  64.9%   881  252s
  3812  2826 -7278.2001   13  417 -10611.517 -3742.3240  64.7%   882  258s
  4027  2827 -7769.4569   49  563 -10611.517 -3742.3240  64.7%   877  278s
  4029  2828 -4778.1325   10  164 -10611.517 -3742.3240  64.7%   876  286s
  4030  2829 -10260.500   61  415 -10611.517 -3742.3240  64.7%   876  291s
  4032  2830 -8189.4995   19  470 -10611.517 -3742.3240  64.7%   876  296s
  4034  2832 -6993.8488   21  552 -10611.517 -3742.3240  64.7%   875  300s
  4037  2834 -6231.3544   19  614 -10611.517 -3742.3240  64.7%   874  305s
  4041  2836 -4687.6877   17  506 -10611.517 -3742.3240  64.7%   874  310s
  4046  2840 -9983.6157   30  578 -10611.517 -3742.3240  64.7%   873  316s
  4049  2842 -9565.6839   43  508 -10611.517 -3742.3240  64.7%   872  320s
  4052  2844 -9072.7895   21  570 -10611.517 -3742.3240  64.7%   871  325s
  4055  2846 -8258.3452   49  511 -10611.517 -3742.3240  64.7%   871  330s
  4059  2848 -8595.4237   19  568 -10611.517 -3742.3240  64.7%   870  336s
  4062  2850 -5636.2044   17  516 -10611.517 -3742.3240  64.7%   869  341s
  4063  2851 -6018.1245    9  516 -10611.517 -3742.3240  64.7%   869  350s
  4064  2852 -7502.6909   16  516 -10611.517 -3742.3240  64.7%   869  355s
  4067  2859 -3742.3240   12  482 -10611.517 -3742.3240  64.7%   887  362s
  4071  2865 -3742.3240   13  472 -10611.517 -3742.3240  64.7%   889  368s
  4079  2877 -3742.3240   14  476 -10611.517 -3742.3240  64.7%   891  372s
  4095  2897 -3742.3240   15  529 -10611.517 -3742.3240  64.7%   909  376s
  4125  2917 -3757.3899   16  521 -10611.517 -3742.3240  64.7%   923  381s
  4157  2947 -4537.1413   17  546 -10611.517 -3758.0425  64.6%   932  387s
  4211  2971 -5019.3893   18  526 -10611.517 -4635.0856  56.3%   953  395s
  4342  2964 -6026.6270   20  493 -10611.517 -4635.0856  56.3%   986  403s
  4417  2941 -7018.5526   20  458 -10611.517 -4817.7872  54.6%   991  410s
  4486  2946 -6688.3877   21  429 -10611.517 -4966.5710  53.2%   996  415s
  4601  2963 -7432.3449   22  412 -10611.517 -5585.2812  47.4%  1016  424s
  4684  2961 -8805.9887   22  378 -10611.517 -5618.7000  47.1%  1014  428s
  4754  2951 -7636.3414   23  382 -10611.517 -5688.9027  46.4%  1013  433s
  4835  2929     cutoff   24      -10611.517 -5688.9027  46.4%  1012  436s
  4885  2933 -9279.3175   25  294 -10611.517 -5816.5130  45.2%  1014  440s
  5008  2933 -8274.3043   26  279 -10611.517 -6133.4331  42.2%  1015  448s
H 5023  2784                    -10598.67820 -6133.4331  42.1%  1014  448s
  5101  2774 -8772.4308   27  227 -10598.678 -6133.4331  42.1%  1010  453s
H 5102  2638                    -10587.56078 -6133.4331  42.1%  1010  453s
  5169  2642 -8618.2509   27  327 -10587.561 -6321.8219  40.3%  1009  457s
  5255  2637     cutoff   28      -10587.561 -6321.8219  40.3%  1009  461s
  5351  2626 -10250.471   30  260 -10587.561 -6321.8219  40.3%  1007  466s
  5454  2609     cutoff   32      -10587.561 -6811.0732  35.7%  1006  470s
H 5566  2452                    -10575.81897 -7019.4476  33.6%  1003  474s
  5606  2440     cutoff   19      -10575.819 -7019.4476  33.6%  1004  479s
  5736  2430     cutoff   20      -10575.819 -7192.2780  32.0%  1002  485s
  5871  2403 -9049.1079   21  190 -10575.819 -7281.7905  31.1%   999  490s
  6053  2378 -9760.8405   23  190 -10575.819 -7455.2620  29.5%   991  500s
  6204  2337     cutoff   24      -10575.819 -7455.2620  29.5%   988  505s
  6398  2301 -10203.865   23  265 -10575.819 -7716.4740  27.0%   977  511s
  6541  2309 -10406.897   26  130 -10575.819 -7922.9393  25.1%   972  515s
  6735  2279 -10403.891   23  332 -10575.819 -8137.4730  23.1%   961  520s
  6952  2246 -10036.464   24  234 -10575.819 -8159.1120  22.9%   951  526s
  7230  2139     cutoff   25      -10575.819 -8193.9290  22.5%   934  531s
  7501  2030     cutoff   29      -10575.819 -8479.8807  19.8%   920  536s
  7778  1872 -10104.663   21  357 -10575.819 -8588.8135  18.8%   908  543s
  8124  1646     cutoff   23      -10575.819 -8706.5930  17.7%   889  549s
  8569  1414 -10501.272   28  243 -10575.819 -8950.0877  15.4%   866  554s
H 8602  1280                    -10566.77525 -8950.0877  15.3%   864  554s
  8768  1016     cutoff   29      -10566.775 -8950.0877  15.3%   855  559s
  9407   695     cutoff   27      -10566.775 -9521.5652  9.89%   816  562s
*11551    26              87    -10560.49512 -10454.282  1.01%   675  563s

Cutting planes:
  MIR: 278
  Flow cover: 729
  RLT: 7
  Relax-and-lift: 46

Explored 11726 nodes (7873896 simplex iterations) in 564.29 seconds (984.77 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -10560.5 -10566.8 -10575.8 ... -10640.9
No other solutions better than -10560.5

Optimal solution found (tolerance 1.00e-04)
Best objective -1.056049512392e+04, best bound -1.056049512392e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 564.32s
  Master Objective (UB) = -10560.50, θ = 121115.74
  Upper Bound (UB) = -10560.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 121115.74
  [DEBUG]   ✓ Scenario 0: θ = 121115.74 ≤ Q = 121115.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 121115.74 ≤ Q = 121115.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 121115.74 ≤ Q = 121115.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x497b2fb1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x497b2fb1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-01, 2e+02]
Found heuristic solution: objective 1.351502e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6235333.3920
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.476100e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147609.99    0  127 6235333.39 -147609.99   102%     -    0s
H    0     0                    -110148.0653 -147609.99  34.0%     -    0s
H    0     0                    -111641.2247 -147609.99  32.2%     -    0s
H    0     0                    -128097.9226 -147609.99  15.2%     -    0s
     0     0 -134088.91    0   69 -128097.92 -134088.91  4.68%     -    0s
H    0     0                    -131531.3703 -133997.41  1.87%     -    0s
     0     0 -133587.35    0   74 -131531.37 -133587.35  1.56%     -    0s
     0     0 -133584.31    0   75 -131531.37 -133584.31  1.56%     -    0s
     0     0 -133097.85    0   71 -131531.37 -133097.85  1.19%     -    0s
H    0     0                    -132391.0093 -133095.30  0.53%     -    0s
     0     0 -133095.30    0   71 -132391.01 -133095.30  0.53%     -    0s
     0     0 -132786.82    0   35 -132391.01 -132786.82  0.30%     -    0s
     0     0 -132780.52    0   34 -132391.01 -132780.52  0.29%     -    0s
H    0     0                    -132413.1834 -132729.21  0.24%     -    0s
     0     0 -132640.51    0   24 -132413.18 -132640.51  0.17%     -    0s
     0     0 -132639.47    0   22 -132413.18 -132639.47  0.17%     -    0s
     0     0 -132633.79    0   27 -132413.18 -132633.79  0.17%     -    0s
     0     0 -132582.68    0   13 -132413.18 -132582.68  0.13%     -    0s
     0     0 -132582.68    0   21 -132413.18 -132582.68  0.13%     -    0s
     0     0 -132509.20    0   12 -132413.18 -132509.20  0.07%     -    0s
H    0     0                    -132452.4131 -132493.03  0.03%     -    0s
H    0     0                    -132455.0400 -132488.42  0.03%     -    0s
     0     0 -132488.42    0    9 -132455.04 -132488.42  0.03%     -    0s
H    0     0                    -132473.0800 -132488.42  0.01%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 8
  MIR: 12
  Flow cover: 10
  Relax-and-lift: 2

Explored 1 nodes (829 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -132473 -132455 -132452 ... -110148
No other solutions better than -132473

Optimal solution found (tolerance 1.00e-04)
Best objective -1.324730800103e+05, best bound -1.324730800103e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 102236.01
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132473.08
  [DEBUG]   S×d_nominal = 234709.09
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 234709.09 + -132473.08 = 102236.01
  [DEBUG]   Current θ from Master = 121115.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18879.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -29440.23
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 6265.2985, Absolute Gap = 6265.2985, Relative Gap = 0.593277
  Not converged yet (gap = 6265.30 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x3ed864dd
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -29440.2 (0.10s)
Loaded MIP start from previous solve with objective -29440.2

Presolve removed 28280 rows and 11480 columns
Presolve time: 1.68s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39808   -2.0434775e+04   0.000000e+00   4.536268e+07      5s
   52574    5.1810963e+03   0.000000e+00   3.149927e+05     10s
   62661    8.1359094e+03   0.000000e+00   6.458265e+05     15s
Concurrent spin time: 1.18s

Solved with dual simplex

Root relaxation: objective 9.962651e+03, 26179 iterations, 13.30 seconds (17.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 9962.65134    0  168 -29440.226 9962.65134   134%     -   15s
H    0     0                    -25459.53157 9962.65134   139%     -   15s
H    0     0                    -25269.16124 9962.65134   139%     -   15s
H    0     0                    -21740.31884 9962.65134   146%     -   15s
H    0     0                    -19273.52693 9962.65134   152%     -   15s
H    0     0                    -17779.58124 9962.65134   156%     -   15s
H    0     0                    -16333.86933 9962.65134   161%     -   16s
H    0     0                    -16302.11608 9962.65134   161%     -   16s
H    0     0                    -15978.98698 9962.65134   162%     -   16s
H    0     0                    -15964.22989 9962.65134   162%     -   16s
H    0     0                    -15957.63197 9962.65134   162%     -   16s
H    0     0                    -15879.46627 9962.65134   163%     -   16s
H    0     0                    -15857.04634 9962.65134   163%     -   16s
H    0     0                    -15765.81097 9962.65134   163%     -   16s
H    0     0                    -15508.69367 9959.54320   164%     -   16s
H    0     0                    -15464.27025 9959.54320   164%     -   16s
H    0     0                    -15459.38251 9959.54320   164%     -   16s
H    0     0                    -15457.26940 9959.54320   164%     -   16s
H    0     0                    -15445.00961 9959.54320   164%     -   16s
H    0     0                    -15395.73026 9959.54320   165%     -   16s
H    0     0                    -15056.77250 6704.70856   145%     -   21s
H    0     0                    -14840.10051 6704.70856   145%     -   21s
     0     0 6581.79272    0  360 -14840.101 6581.79272   144%     -   21s
H    0     0                    -14026.19047 6581.79272   147%     -   22s
     0     0 6418.24053    0  366 -14026.190 6418.24053   146%     -   22s
     0     0 6406.40206    0  365 -14026.190 6406.40206   146%     -   22s
     0     0 6406.40206    0  367 -14026.190 6406.40206   146%     -   22s
     0     0 6384.43658    0  361 -14026.190 6384.43658   146%     -   23s
     0     0 6383.29468    0  362 -14026.190 6383.29468   146%     -   23s
     0     0 2883.80375    0  413 -14026.190 2883.80375   121%     -   29s
H    0     0                    -13760.27641 2883.80375   121%     -   29s
H    0     0                    -12756.63037 2883.80375   123%     -   29s
H    0     0                    -12625.37881 2883.80375   123%     -   29s
H    0     0                    -12601.85000 2883.80375   123%     -   29s
H    0     0                    -12565.82874 2883.80375   123%     -   29s
H    0     0                    -12528.70706 2883.80375   123%     -   29s
H    0     0                    -12483.52500 2883.80375   123%     -   29s
H    0     0                    -12483.35611 2883.80375   123%     -   29s
     0     0 2532.83191    0  341 -12483.356 2532.83191   120%     -   32s
     0     0 2433.90691    0  432 -12483.356 2433.90691   119%     -   33s
     0     0 2394.58040    0  434 -12483.356 2394.58040   119%     -   34s
     0     0 2382.91897    0  395 -12483.356 2382.91897   119%     -   34s
     0     0 2381.62404    0  387 -12483.356 2381.62404   119%     -   34s
     0     0 2380.22335    0  432 -12483.356 2380.22335   119%     -   34s
     0     0 2380.16662    0  432 -12483.356 2380.16662   119%     -   35s
H    0     0                    -12445.49132  510.77773   104%     -   44s
H    0     0                    -12420.05627  510.77773   104%     -   44s
H    0     0                    -12400.62740  510.77773   104%     -   44s
H    0     0                    -12341.74749  510.77773   104%     -   44s
H    0     0                    -12290.90745  510.77773   104%     -   44s
H    0     0                    -12122.98702  510.77773   104%     -   44s
H    0     0                    -12093.58341  510.77773   104%     -   44s
H    0     0                    -12089.31122  510.77773   104%     -   44s
     0     0  510.77773    0  499 -12089.311  510.77773   104%     -   44s
     0     0   67.56890    0  410 -12089.311   67.56890   101%     -   48s
     0     0 -212.50526    0  447 -12089.311 -212.50526  98.2%     -   51s
     0     0 -366.95674    0  410 -12089.311 -366.95674  97.0%     -   53s
     0     0 -453.77509    0  468 -12089.311 -453.77509  96.2%     -   55s
     0     0 -474.25771    0  418 -12089.311 -474.25771  96.1%     -   55s
     0     0 -486.92686    0  474 -12089.311 -486.92686  96.0%     -   56s
     0     0 -487.72801    0  422 -12089.311 -487.72801  96.0%     -   56s
H    0     0                    -12022.49687 -1267.5032  89.5%     -   66s
     0     0 -1267.5032    0  488 -12022.497 -1267.5032  89.5%     -   66s
H    0     0                    -11988.49286 -1267.5810  89.4%     -   67s
H    0     0                    -11973.67023 -1267.5810  89.4%     -   67s
     0     0 -1468.5940    0  494 -11973.670 -1468.5940  87.7%     -   70s
     0     0 -1681.5832    0  533 -11973.670 -1681.5832  86.0%     -   74s
     0     0 -1729.3819    0  573 -11973.670 -1729.3819  85.6%     -   75s
     0     0 -1741.2028    0  576 -11973.670 -1741.2028  85.5%     -   76s
     0     0 -1753.3391    0  578 -11973.670 -1753.3391  85.4%     -   77s
     0     0 -1765.4581    0  574 -11973.670 -1765.4581  85.3%     -   77s
     0     0 -1770.1910    0  576 -11973.670 -1770.1910  85.2%     -   77s
     0     0 -1773.0355    0  587 -11973.670 -1773.0355  85.2%     -   78s
     0     0 -1773.1932    0  587 -11973.670 -1773.1932  85.2%     -   78s
H    0     0                    -11951.51394 -1914.1495  84.0%     -   82s
H    0     0                    -11947.94225 -1914.1495  84.0%     -   82s
     0     0 -1914.1495    0  530 -11947.942 -1914.1495  84.0%     -   82s
     0     0 -1974.3316    0  544 -11947.942 -1974.3316  83.5%     -   83s
     0     0 -1992.7833    0  547 -11947.942 -1992.7833  83.3%     -   84s
     0     0 -1996.8315    0  556 -11947.942 -1996.8315  83.3%     -   85s
     0     0 -2001.7730    0  552 -11947.942 -2001.7730  83.2%     -   85s
     0     0 -2004.3960    0  554 -11947.942 -2004.3960  83.2%     -   85s
     0     0 -2005.0316    0  549 -11947.942 -2005.0316  83.2%     -   85s
     0     0 -2083.9442    0  561 -11947.942 -2083.9442  82.6%     -   88s
     0     0 -2109.9812    0  571 -11947.942 -2109.9812  82.3%     -   89s
     0     0 -2115.0588    0  577 -11947.942 -2115.0588  82.3%     -   90s
     0     0 -2117.9449    0  564 -11947.942 -2117.9449  82.3%     -   90s
     0     0 -2118.3378    0  566 -11947.942 -2118.3378  82.3%     -   90s
     0     0 -2151.2739    0  513 -11947.942 -2151.2739  82.0%     -   92s
     0     0 -2155.1049    0  515 -11947.942 -2155.1049  82.0%     -   93s
     0     0 -2156.3009    0  515 -11947.942 -2156.3009  82.0%     -   93s
H    0     0                    -11922.30128 -2156.3009  81.9%     -   94s
     0     0 -2206.5147    0  510 -11922.301 -2206.5147  81.5%     -   94s
     0     0 -2209.9582    0  509 -11922.301 -2209.9582  81.5%     -   95s
     0     0 -2211.8917    0  522 -11922.301 -2211.8917  81.4%     -   96s
     0     0 -2212.8008    0  516 -11922.301 -2212.8008  81.4%     -   96s
     0     0 -2229.4850    0  510 -11922.301 -2229.4850  81.3%     -   98s
     0     0 -2233.7901    0  514 -11922.301 -2233.7901  81.3%     -   98s
     0     0 -2235.0257    0  516 -11922.301 -2235.0257  81.3%     -   98s
     0     0 -2250.0255    0  519 -11922.301 -2250.0255  81.1%     -  100s
     0     0 -2258.0924    0  513 -11922.301 -2258.0924  81.1%     -  102s
     0     0 -2261.3265    0  521 -11922.301 -2261.3265  81.0%     -  102s
     0     0 -2261.6370    0  524 -11922.301 -2261.6370  81.0%     -  102s
     0     0 -2266.1884    0  516 -11922.301 -2266.1884  81.0%     -  103s
     0     0 -2268.3289    0  508 -11922.301 -2268.3289  81.0%     -  104s
     0     0 -2269.5307    0  517 -11922.301 -2269.5307  81.0%     -  104s
     0     0 -2276.2005    0  503 -11922.301 -2276.2005  80.9%     -  105s
     0     0 -2279.5404    0  509 -11922.301 -2279.5404  80.9%     -  109s
     0     0 -2280.5651    0  506 -11922.301 -2280.5651  80.9%     -  110s
     0     0 -2281.0029    0  506 -11922.301 -2281.0029  80.9%     -  111s
     0     2 -2281.3264    0  506 -11922.301 -2281.3264  80.9%     -  128s
     1     4 -2409.0876    1  492 -11922.301 -2281.8560  80.9%  1496  133s
     3     8 -2474.0159    2  498 -11922.301 -2409.7307  79.8%  3618  136s
    15    32 -2900.6261    4  569 -11922.301 -2609.1113  78.1%  3794  144s
    31    48 -4196.5186    5  533 -11922.301 -2900.7183  75.7%  4978  157s
    47    70 -5037.2295    6  470 -11922.301 -2900.7183  75.7%  4832  163s
H   49    70                    -11884.80535 -2900.7183  75.6%  4689  163s
H   51    70                    -11869.45980 -2900.7183  75.6%  4625  163s
H   54    70                    -11843.85345 -2900.7183  75.5%  4475  163s
H   61    70                    -11824.66296 -2900.7183  75.5%  4107  163s
H   66    70                    -11823.28557 -2900.7183  75.5%  3888  163s
H   77    70                    -11761.68902 -2900.7183  75.3%  3422  163s
    79   140 -6068.1656    7  417 -11761.689 -2900.7183  75.3%  3405  175s
   153   282 -6076.5952    9  424 -11761.689 -2900.7183  75.3%  2195  181s
   305   369 -6287.0238   10  383 -11761.689 -2900.7183  75.3%  1467  190s
   489   513 -6412.1491   11  386 -11761.689 -2900.7183  75.3%  1213  197s
   560   569 -6389.1557   11  386 -11761.689 -2900.7183  75.3%  1188  202s
   618   631 -6528.8812   12  398 -11761.689 -2900.7183  75.3%  1195  205s
   696   689 -6714.4075   12  386 -11761.689 -2900.7183  75.3%  1157  210s
   766   752 -7143.7071   13  381 -11761.689 -2900.7183  75.3%  1124  219s
   867   783 infeasible   12      -11761.689 -2900.7183  75.3%  1078  222s
   927   830 -7898.9041   13  328 -11761.689 -3276.6420  72.1%  1066  230s
  1012   856 -7461.2764   14  389 -11761.689 -3278.6866  72.1%  1068  235s
  1056   900 -7992.6199   14  371 -11761.689 -3278.6866  72.1%  1067  244s
  1114   928 -8207.8852   15  378 -11761.689 -3278.6866  72.1%  1072  251s
  1194  1020 -8174.9077   14  365 -11761.689 -3278.6866  72.1%  1085  259s
  1281  1067 -8627.5864   15  359 -11761.689 -3278.6866  72.1%  1075  265s
  1372  1132 -8362.7073   16  329 -11761.689 -3278.6866  72.1%  1066  270s
  1464  1202 -8507.3669   17  327 -11761.689 -3278.6866  72.1%  1058  275s
  1558  1260 -8709.5990   18  374 -11761.689 -3278.6866  72.1%  1057  283s
  1666  1342 -9083.7946   17  264 -11761.689 -3933.9805  66.6%  1058  290s
  1776  1429 -8942.1772   19  403 -11761.689 -3943.6278  66.5%  1054  295s
  1887  1538 -8872.1015   19  327 -11761.689 -3943.6278  66.5%  1044  302s
  2016  1624 -9346.6526   21  333 -11761.689 -4089.2640  65.2%  1034  309s
  2122  1749 -9504.0386   22  253 -11761.689 -4089.2640  65.2%  1039  313s
  2268  1790 -9889.5333   25  220 -11761.689 -4089.2640  65.2%  1023  320s
  2329  1865 -10044.694   28  211 -11761.689 -4423.1408  62.4%  1019  327s
  2445  1981 -10814.611   34  243 -11761.689 -4423.1408  62.4%  1009  334s
  2584  2140 -10964.625   37  232 -11761.689 -4450.7884  62.2%  1000  342s
  2794  2287 -11277.714   43  238 -11761.689 -4450.7884  62.2%   975  349s
  2981  2431 -6327.0279   12  416 -11761.689 -4450.7884  62.2%   964  355s
  3177  2586 -7315.5713   16  352 -11761.689 -4458.4320  62.1%   954  361s
  3388  2770 -7808.6943   20  394 -11761.689 -4625.6923  60.7%   943  368s
  3605  2771 -10395.737   41  506 -11761.689 -4732.8789  59.8%   934  398s
  3607  2772 -9447.9833   42  168 -11761.689 -4732.8789  59.8%   933  408s
  3608  2773 -8932.3027   19  383 -11761.689 -4732.8789  59.8%   933  416s
  3609  2774 -7666.9912   15  475 -11761.689 -4732.8789  59.8%   933  425s
  3610  2774 -10040.824   21  493 -11761.689 -4732.8789  59.8%   932  432s
  3611  2775 -7846.6369   28  477 -11761.689 -4732.8789  59.8%   932  436s
  3612  2776 -7101.5498   20  544 -11761.689 -4732.8789  59.8%   932  441s
  3614  2777 -8259.4778   30  536 -11761.689 -4732.8789  59.8%   931  447s
  3616  2778 -11356.880   29  555 -11761.689 -4732.8789  59.8%   931  451s
  3618  2780 -11293.036   53  600 -11761.689 -4732.8789  59.8%   930  457s
  3620  2781 -9914.8746   42  506 -11761.689 -4732.8789  59.8%   930  461s
  3621  2782 -9386.5124   53  503 -11761.689 -4732.8789  59.8%   930  465s
  3624  2784 -7448.6646    8  568 -11761.689 -4732.8789  59.8%   929  471s
  3626  2785 -5288.3502    7  567 -11761.689 -4732.8789  59.8%   928  476s
  3628  2786 -10284.608   46  467 -11761.689 -4732.8789  59.8%   928  480s
  3631  2788 -8195.5092   19  475 -11761.689 -4732.8789  59.8%   927  485s
  3634  2790 -8940.3003   28  510 -11761.689 -4732.8789  59.8%   926  492s
  3635  2791 -10669.471   44  510 -11761.689 -4732.8789  59.8%   926  504s
  3636  2792 -6829.7829    9  510 -11761.689 -4732.8789  59.8%   926  522s
  3637  2795 -4732.8789   15  503 -11761.689 -4732.8789  59.8%   952  535s
  3639  2799 -4732.8789   16  502 -11761.689 -4732.8789  59.8%   954  542s
  3643  2805 -4732.8789   17  505 -11761.689 -4732.8789  59.8%   956  550s
  3651  2819 -4732.8789   18  500 -11761.689 -4732.8789  59.8%   967  560s
  3667  2834 -4732.8789   19  420 -11761.689 -4732.8789  59.8%   992  578s
  3692  2858 -5379.6338   20  552 -11761.689 -4732.8789  59.8%  1032  585s
  3724  2943 -5604.4802   21  537 -11761.689 -4732.8789  59.8%  1052  595s
  3822  2973 -5930.6262   24  534 -11761.689 -4732.8789  59.8%  1093  603s
H 3824  2831                    -11755.59743 -4732.8789  59.7%  1093  603s
  3891  2860 -6535.8309   23  385 -11755.597 -4732.8789  59.7%  1111  612s
  3950  2878 -7043.7375   23  292 -11755.597 -4732.8789  59.7%  1133  620s
  4009  2904 -6094.2002   24  501 -11755.597 -4732.8789  59.7%  1150  627s
  4080  2902 -7226.2466   26  385 -11755.597 -4732.8789  59.7%  1162  639s
  4117  2919 -6607.6304   26  470 -11755.597 -4732.8789  59.7%  1168  644s
  4167  2939 -9122.3783   26  349 -11755.597 -4732.8789  59.7%  1179  651s
H 4183  2800                    -11737.24309 -4732.8789  59.7%  1182  651s
  4214  2837 -7224.6680   26  473 -11737.243 -4732.8789  59.7%  1186  657s
  4289  2846 -7631.2840   27  427 -11737.243 -4732.8789  59.7%  1191  663s
  4328  2876 -8016.6225   28  364 -11737.243 -4732.8789  59.7%  1197  670s
  4397  2898 -7933.7054   28  403 -11737.243 -4732.8789  59.7%  1203  675s
  4478  2912 -8391.8716   30  339 -11737.243 -4732.8789  59.7%  1201  686s
  4568  2928 -8590.1508   31  296 -11737.243 -4732.8789  59.7%  1202  693s
  4633  2922 -9096.0259   33  342 -11737.243 -4732.8789  59.7%  1205  701s
  4696  2926 -10399.344   34  324 -11737.243 -4822.8243  58.9%  1212  710s
  4764  2922 -10099.058   34  316 -11737.243 -4822.8243  58.9%  1222  718s
  4806  2933     cutoff   33      -11737.243 -4822.8243  58.9%  1228  727s
  4855  2953 -9336.4222   34  367 -11737.243 -4953.0836  57.8%  1237  733s
  4904  2980 -9734.2430   37  156 -11737.243 -4953.0836  57.8%  1244  742s
  4968  3007 -10181.483   41  184 -11737.243 -4983.7385  57.5%  1248  751s
  5046  3028 -10438.997   45  199 -11737.243 -4983.7385  57.5%  1255  760s
  5142  3046 -10671.464   50  142 -11737.243 -4983.7385  57.5%  1258  769s
  5252  3036 -11033.678   55  150 -11737.243 -4983.7385  57.5%  1263  780s
  5385  3027     cutoff   62      -11737.243 -5124.5909  56.3%  1265  788s
  5488  3022 -6172.9844   25  465 -11737.243 -5399.0461  54.0%  1277  801s
  5563  3051 -6725.8595   26  505 -11737.243 -5399.0461  54.0%  1288  812s
  5660  3057 -7247.8447   28  511 -11737.243 -5399.0461  54.0%  1303  823s
  5783  3041 -10236.739   31  318 -11737.243 -5399.0461  54.0%  1312  832s
  5880  3056 -10831.680   31  340 -11737.243 -5399.0461  54.0%  1313  842s
  5993  3079     cutoff   34      -11737.243 -5468.7617  53.4%  1323  858s
  6139  3097 -9477.3307   24  395 -11737.243 -5513.9229  53.0%  1332  871s
  6307  3106 -11065.488   26  206 -11737.243 -5648.3119  51.9%  1334  883s
  6510  3090 -11496.292   26  338 -11737.243 -5771.5180  50.8%  1330  895s
  6712  3072     cutoff   27      -11737.243 -5771.5180  50.8%  1331  906s
  6917  3060 -8129.1353   25  246 -11737.243 -5771.5180  50.8%  1334  921s
  7089  3088 infeasible   29      -11737.243 -5907.4774  49.7%  1331  934s
  7329  3082 -11488.167   40   86 -11737.243 -5907.4774  49.7%  1329  948s
  7549  3062 -8894.8283   28  444 -11737.243 -5907.4774  49.7%  1331  963s
  7761  3098 -10282.041   30  292 -11737.243 -5907.4774  49.7%  1342  977s
  7983  3102     cutoff   32      -11737.243 -5907.4774  49.7%  1350  992s
  8261  3059 -7810.9301   27  490 -11737.243 -5907.4774  49.7%  1350 1006s
  8468  3082 -8130.3194   28  439 -11737.243 -6419.3181  45.3%  1352 1023s
  8702  3118 -8424.5750   29  468 -11737.243 -6519.1870  44.5%  1357 1039s
  9051  3079 -9477.0517   33  410 -11737.243 -6650.3845  43.3%  1351 1055s
  9355  2983 -10687.048   40  414 -11737.243 -6653.9982  43.3%  1356 1068s
  9413  2981 -10770.969   41  414 -11737.243 -6693.9764  43.0%  1360 1081s
  9457  2988 -10969.165   42  384 -11737.243 -6693.9764  43.0%  1361 1097s
  9532  3022 -11046.747   43  360 -11737.243 -6693.9764  43.0%  1361 1115s
H 9581  2880                    -11734.61005 -6693.9764  43.0%  1361 1115s
  9764  2929 -9274.0254   24  323 -11734.610 -6693.9764  43.0%  1359 1133s
 10178  2885     cutoff   31      -11734.610 -6842.3498  41.7%  1358 1151s
 10604  2867 -10192.838   30  435 -11734.610 -7062.2915  39.8%  1354 1172s
 11004  2901     cutoff   26      -11734.610 -7195.4215  38.7%  1360 1192s
 11381  2999     cutoff   29      -11734.610 -7303.9633  37.8%  1368 1212s
 11788  3120     cutoff   27      -11734.610 -7309.1667  37.7%  1369 1233s
 12244  3235 -11286.428   26  498 -11734.610 -7456.2595  36.5%  1367 1255s
H12385  3232                    -11719.32537 -7456.2595  36.4%  1364 1255s
 12718  3389 -9596.5048   28  361 -11719.325 -7584.3026  35.3%  1367 1279s
H13041  3388                    -11713.32786 -7669.6854  34.5%  1367 1279s
 13292  3505 -9744.6787   26  240 -11713.328 -7837.1099  33.1%  1361 1308s
 13853  3635 -10085.694   28  304 -11713.328 -7936.0447  32.2%  1361 1332s
 14403  3739 -11219.801   40  204 -11713.328 -7952.3659  32.1%  1365 1357s
H14624  3738                    -11704.60380 -8078.0264  31.0%  1363 1357s
 14968  3813 infeasible   29      -11704.604 -8205.3266  29.9%  1367 1385s
 15560  3885 -9961.6768   34  491 -11704.604 -8371.8387  28.5%  1365 1413s
 16285  3981 -11538.971   29  310 -11704.604 -8428.7780  28.0%  1359 1441s
 16977  3968 -11652.484   27  448 -11704.604 -8633.8344  26.2%  1357 1475s
 17695  4016 -10577.011   32  125 -11704.604 -8743.9304  25.3%  1356 1504s
 18166  4069 -10904.762   24  189 -11704.604 -8790.1188  24.9%  1353 1534s
 18942  4191 -11176.996   33  370 -11704.604 -8951.1173  23.5%  1348 1566s
 19823  4228 -11438.586   28  340 -11704.604 -9071.9793  22.5%  1333 1600s
 20699  4233     cutoff   33      -11704.604 -9238.3151  21.1%  1329 1633s
 21659  4255 -10929.757   38   84 -11704.604 -9347.9708  20.1%  1317 1667s
 22849  4102 -11700.401   29  518 -11704.604 -9575.7199  18.2%  1299 1705s
 24203  3953 infeasible   45      -11704.604 -9794.8554  16.3%  1276 1739s
 25805  3616     cutoff   33      -11704.604 -10028.330  14.3%  1243 1773s
 27750  3427 -11447.802   41  224 -11704.604 -10228.624  12.6%  1199 1805s
 30474  3230 -11147.096   34  208 -11704.604 -10517.569  10.1%  1130 1833s
 33032  3172     cutoff   56      -11704.604 -10667.303  8.86%  1062 1859s
 33245  2663 infeasible   30      -11704.604 -10726.636  8.36%  1058 1884s
 38043  2484 -11565.670   54  293 -11704.604 -11081.033  5.33%   947 1899s
 44955  3235 -11697.170   68   49 -11704.604 -11465.608  2.04%   814 1906s
 53243  2216     cutoff   76      -11704.604 -11621.152  0.71%   693 1915s
H58657  2135                    -11700.41337 -11624.148  0.65%   631 1915s

Cutting planes:
  Learned: 1
  MIR: 603
  Flow cover: 1523
  RLT: 21
  Relax-and-lift: 111

Explored 66726 nodes (37370071 simplex iterations) in 1918.94 seconds (3872.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -11700.4 -11700.4 -11704.6 ... -11823.3
No other solutions better than -11700.4

Optimal solution found (tolerance 1.00e-04)
Best objective -1.170041336995e+04, best bound -1.170041336995e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1919.03s
  Master Objective (UB) = -11700.41, θ = 120003.27
  Upper Bound (UB) = -11700.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120003.27
  [DEBUG]   ✓ Scenario 0: θ = 120003.27 ≤ Q = 120003.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120003.27 ≤ Q = 120003.48 (slack: 0.21)
  [DEBUG]   ✓ Scenario 2: θ = 120003.27 ≤ Q = 120003.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120003.27 ≤ Q = 120003.27 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4aa7abae
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4aa7abae
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362767e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6304326.8429
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.463671e+05, 270 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146367.06    0  134 6304326.84 -146367.06   102%     -    0s
H    0     0                    -105642.6862 -146367.06  38.5%     -    0s
H    0     0                    -126662.1937 -146367.06  15.6%     -    0s
H    0     0                    -129434.6443 -137744.82  6.42%     -    0s
     0     0 -137744.82    0   77 -129434.64 -137744.82  6.42%     -    0s
H    0     0                    -135350.8637 -137661.53  1.71%     -    0s
H    0     0                    -136039.0982 -136655.03  0.45%     -    0s
     0     0 -136655.03    0   88 -136039.10 -136655.03  0.45%     -    0s
     0     0 -136641.40    0   88 -136039.10 -136641.40  0.44%     -    0s
     0     0 -136580.53    0   84 -136039.10 -136580.53  0.40%     -    0s
     0     0 -136576.38    0   84 -136039.10 -136576.38  0.39%     -    0s
     0     0 -136221.32    0   28 -136039.10 -136221.32  0.13%     -    0s
     0     0 -136209.93    0   18 -136039.10 -136209.93  0.13%     -    0s
     0     0 -136183.90    0   15 -136039.10 -136183.90  0.11%     -    0s
     0     0 -136180.42    0   15 -136039.10 -136180.42  0.10%     -    0s
H    0     0                    -136062.4935 -136180.42  0.09%     -    0s
H    0     0                    -136079.1090 -136180.42  0.07%     -    0s
     0     0 -136150.99    0   14 -136079.11 -136150.99  0.05%     -    0s
     0     0 -136150.99    0   10 -136079.11 -136150.99  0.05%     -    0s
*    0     0               0    -136107.2617 -136107.26  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 3
  MIR: 3
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (792 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -136107 -136079 -136062 ... 1.36277e+13
No other solutions better than -136107

Optimal solution found (tolerance 1.00e-04)
Best objective -1.361072617433e+05, best bound -1.361072617433e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 96616.59
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136107.26
  [DEBUG]   S×d_nominal = 232723.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 232723.85 + -136107.26 = 96616.59
  [DEBUG]   Current θ from Master = 120003.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23386.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -35087.10
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 5125.3802, Absolute Gap = 5125.3802, Relative Gap = 0.438051
  Not converged yet (gap = 5125.38 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x4dd5052a
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 1.66s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -188195.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24932   -4.6470835e+04   0.000000e+00   1.617358e+08      5s
   37766   -4.0174286e+03   0.000000e+00   3.214170e+07     10s
   47210    2.9757825e+03   0.000000e+00   5.791460e+07     15s
Concurrent spin time: 0.91s

Solved with dual simplex

Root relaxation: objective 9.498172e+03, 28747 iterations, 15.58 seconds (20.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 9498.17211    0  171 -188195.78 9498.17211   105%     -   17s
H    0     0                    -182265.3332 9498.17211   105%     -   17s
H    0     0                    -125166.0534 9498.17211   108%     -   17s
H    0     0                    -122342.4848 9498.17211   108%     -   17s
H    0     0                    -121922.9873 9498.17211   108%     -   18s
H    0     0                    -87154.08207 9498.17211   111%     -   18s
H    0     0                    -86195.84907 9498.17211   111%     -   18s
H    0     0                    -40210.67301 9498.17211   124%     -   18s
H    0     0                    -27441.27007 9498.17211   135%     -   18s
H    0     0                    -26915.88460 9498.17211   135%     -   18s
H    0     0                    -26748.55273 5832.38715   122%     -   26s
H    0     0                    -26729.41510 5832.38715   122%     -   26s
H    0     0                    -26669.05863 5832.38715   122%     -   26s
H    0     0                    -26555.84280 5832.38715   122%     -   26s
     0     0 5792.13975    0  361 -26555.843 5792.13975   122%     -   26s
     0     0 5655.23758    0  366 -26555.843 5655.23758   121%     -   27s
     0     0 5401.03897    0  357 -26555.843 5401.03897   120%     -   29s
     0     0 5401.03897    0  355 -26555.843 5401.03897   120%     -   30s
     0     0 5401.03897    0  357 -26555.843 5401.03897   120%     -   30s
H    0     0                    -25136.88823 2911.59292   112%     -   40s
H    0     0                    -25088.76503 2911.59292   112%     -   40s
H    0     0                    -25084.82623 2911.59292   112%     -   40s
     0     0 2642.10464    0  350 -25084.826 2642.10464   111%     -   40s
H    0     0                    -21116.45693 2642.10464   113%     -   41s
H    0     0                    -20068.72864 2642.10464   113%     -   41s
     0     0 1921.66811    0  435 -20068.729 1921.66811   110%     -   47s
     0     0 1570.40081    0  380 -20068.729 1570.40081   108%     -   50s
     0     0 1470.33026    0  436 -20068.729 1470.33026   107%     -   52s
     0     0 1359.60795    0  444 -20068.729 1359.60795   107%     -   53s
     0     0 1353.78701    0  446 -20068.729 1353.78701   107%     -   53s
     0     0 1344.91515    0  442 -20068.729 1344.91515   107%     -   54s
     0     0 1341.57747    0  448 -20068.729 1341.57747   107%     -   54s
     0     0 1341.03804    0  448 -20068.729 1341.03804   107%     -   54s
H    0     0                    -18997.05761 1341.03804   107%     -   59s
H    0     0                    -18343.84518 1341.03804   107%     -   59s
H    0     0                    -18201.78640 1341.03804   107%     -   59s
H    0     0                    -17856.77936 1341.03804   108%     -   59s
H    0     0                    -17339.03449   -1.39337   100%     -   70s
     0     0   -1.39337    0  415 -17339.034   -1.39337   100%     -   70s
H    0     0                    -17116.02365   -1.66191   100%     -   70s
     0     0 -630.51652    0  462 -17116.024 -630.51652  96.3%     -   77s
H    0     0                    -16408.19547 -933.34394  94.3%     -   82s
     0     0 -933.34394    0  512 -16408.195 -933.34394  94.3%     -   82s
H    0     0                    -16233.04026 -1013.7551  93.8%     -   84s
H    0     0                    -15773.55401 -1013.7551  93.6%     -   84s
H    0     0                    -15765.04148 -1013.7551  93.6%     -   84s
H    0     0                    -14764.89853 -1013.7551  93.1%     -   84s
H    0     0                    -14503.65754 -1013.7551  93.0%     -   84s
H    0     0                    -14494.97530 -1013.7551  93.0%     -   84s
     0     0 -1013.7551    0  458 -14494.975 -1013.7551  93.0%     -   84s
     0     0 -1044.6663    0  424 -14494.975 -1044.6663  92.8%     -   85s
     0     0 -1099.6297    0  412 -14494.975 -1099.6297  92.4%     -   86s
     0     0 -1147.7227    0  459 -14494.975 -1147.7227  92.1%     -   87s
     0     0 -1158.6605    0  416 -14494.975 -1158.6605  92.0%     -   88s
     0     0 -1165.1816    0  417 -14494.975 -1165.1816  92.0%     -   89s
     0     0 -1168.9833    0  422 -14494.975 -1168.9833  91.9%     -   89s
     0     0 -1169.9756    0  424 -14494.975 -1169.9756  91.9%     -   89s
H    0     0                    -14467.97836 -1169.9756  91.9%     -   96s
H    0     0                    -14288.96997 -1169.9756  91.8%     -   96s
     0     0 -1693.4720    0  433 -14288.970 -1693.4720  88.1%     -  105s
H    0     0                    -14146.09459 -1693.7663  88.0%     -  106s
H    0     0                    -14138.44720 -1693.7663  88.0%     -  106s
     0     0 -1865.2914    0  435 -14138.447 -1865.2914  86.8%     -  110s
     0     0 -1902.5676    0  442 -14138.447 -1902.5676  86.5%     -  113s
     0     0 -1943.4684    0  502 -14138.447 -1943.4684  86.3%     -  116s
     0     0 -1964.3277    0  508 -14138.447 -1964.3277  86.1%     -  117s
     0     0 -1972.1760    0  508 -14138.447 -1972.1760  86.1%     -  118s
     0     0 -1999.2448    0  503 -14138.447 -1999.2448  85.9%     -  119s
     0     0 -2007.5383    0  510 -14138.447 -2007.5383  85.8%     -  120s
     0     0 -2016.6228    0  505 -14138.447 -2016.6228  85.7%     -  120s
     0     0 -2019.7973    0  505 -14138.447 -2019.7973  85.7%     -  121s
     0     0 -2021.9687    0  508 -14138.447 -2021.9687  85.7%     -  121s
     0     0 -2022.5618    0  514 -14138.447 -2022.5618  85.7%     -  121s
     0     0 -2184.4516    0  516 -14138.447 -2184.4516  84.5%     -  125s
H    0     0                    -14069.28158 -2184.9262  84.5%     -  125s
     0     0 -2210.6692    0  491 -14069.282 -2210.6692  84.3%     -  126s
     0     0 -2221.2649    0  501 -14069.282 -2221.2649  84.2%     -  127s
     0     0 -2231.0389    0  507 -14069.282 -2231.0389  84.1%     -  128s
     0     0 -2236.4471    0  496 -14069.282 -2236.4471  84.1%     -  128s
     0     0 -2273.5077    0  540 -14069.282 -2273.5077  83.8%     -  130s
     0     0 -2281.8982    0  498 -14069.282 -2281.8982  83.8%     -  130s
     0     0 -2287.1397    0  500 -14069.282 -2287.1397  83.7%     -  131s
     0     0 -2289.4584    0  505 -14069.282 -2289.4584  83.7%     -  131s
     0     0 -2289.7772    0  506 -14069.282 -2289.7772  83.7%     -  131s
     0     0 -2324.5727    0  498 -14069.282 -2324.5727  83.5%     -  133s
     0     0 -2328.9030    0  509 -14069.282 -2328.9030  83.4%     -  135s
     0     0 -2332.5971    0  514 -14069.282 -2332.5971  83.4%     -  135s
     0     0 -2334.2186    0  514 -14069.282 -2334.2186  83.4%     -  135s
     0     0 -2334.8589    0  514 -14069.282 -2334.8589  83.4%     -  136s
     0     0 -2372.2600    0  570 -14069.282 -2372.2600  83.1%     -  138s
     0     0 -2383.9934    0  576 -14069.282 -2383.9934  83.1%     -  139s
     0     0 -2389.7794    0  518 -14069.282 -2389.7794  83.0%     -  140s
     0     0 -2391.2085    0  526 -14069.282 -2391.2085  83.0%     -  140s
     0     0 -2431.3935    0  567 -14069.282 -2431.3935  82.7%     -  142s
     0     0 -2437.9385    0  580 -14069.282 -2437.9385  82.7%     -  143s
     0     0 -2442.4187    0  531 -14069.282 -2442.4187  82.6%     -  144s
     0     0 -2446.5982    0  522 -14069.282 -2446.5982  82.6%     -  144s
     0     0 -2447.0662    0  526 -14069.282 -2447.0662  82.6%     -  144s
     0     0 -2460.9164    0  568 -14069.282 -2460.9164  82.5%     -  146s
     0     0 -2464.2876    0  575 -14069.282 -2464.2876  82.5%     -  147s
     0     0 -2464.7240    0  581 -14069.282 -2464.7240  82.5%     -  147s
     0     0 -2478.3560    0  524 -14069.282 -2478.3560  82.4%     -  149s
     0     0 -2481.0730    0  527 -14069.282 -2481.0730  82.4%     -  150s
     0     0 -2482.9760    0  532 -14069.282 -2482.9760  82.4%     -  150s
     0     0 -2483.8938    0  523 -14069.282 -2483.8938  82.3%     -  151s
     0     0 -2490.0129    0  585 -14069.282 -2490.0129  82.3%     -  152s
     0     0 -2492.3762    0  522 -14069.282 -2492.3762  82.3%     -  153s
     0     0 -2492.7354    0  591 -14069.282 -2492.7354  82.3%     -  153s
     0     0 -2498.0065    0  530 -14069.282 -2498.0065  82.2%     -  155s
     0     0 -2499.6793    0  532 -14069.282 -2499.6793  82.2%     -  155s
     0     0 -2500.2651    0  540 -14069.282 -2500.2651  82.2%     -  156s
     0     0 -2503.1085    0  540 -14069.282 -2503.1085  82.2%     -  157s
     0     0 -2503.2171    0  540 -14069.282 -2503.2171  82.2%     -  158s
H    0     0                    -14068.48246 -2503.8553  82.2%     -  163s
H    0     0                    -14009.97105 -2503.8553  82.1%     -  175s
     0     2 -2503.8553    0  540 -14009.971 -2503.8553  82.1%     -  176s
     1     4 -2543.1114    1  564 -14009.971 -2505.7409  82.1%   922  182s
     3     8 -2662.8737    2  524 -14009.971 -2543.2294  81.8%  2989  186s
     7    16 -2842.3177    3  558 -14009.971 -2620.7897  81.3%  3562  193s
    15    32 -2945.6341    4  523 -14009.971 -2846.8850  79.7%  4930  201s
    31    48 -4016.0669    5  450 -14009.971 -2947.7785  79.0%  6012  220s
H   47    72                    -13980.38094 -2947.7785  78.9%  7847  228s
H   48    72                    -13951.95619 -2947.7785  78.9%  7838  228s
H   50    72                    -13838.71997 -2947.7785  78.7%  7699  228s
H   78    72                    -13811.88100 -2947.7785  78.7%  6048  228s
    79   132 -5080.0686    7  434 -13811.881 -2947.7785  78.7%  5996  245s
H  143   257                    -13806.17339 -2947.7785  78.6%  4254  255s
H  147   257                    -13704.06833 -2947.7785  78.5%  4191  255s
   270   356 -5584.2020   11  480 -13704.068 -2947.7785  78.5%  2924  262s
   373   427 -5705.2072   12  450 -13704.068 -2947.7785  78.5%  2430  268s
H  381   427                    -13579.85705 -2947.7785  78.3%  2408  268s
H  387   427                    -13394.85698 -2947.7785  78.0%  2402  269s
   454   506 -5754.2670   13  440 -13394.857 -2947.7785  78.0%  2242  275s
   568   571 -9108.4839   13  370 -13394.857 -2947.7785  78.0%  2040  283s
H  571   571                    -13306.14018 -2947.7785  77.8%  2035  283s
H  575   571                    -13115.29357 -2947.7785  77.5%  2032  283s
   608   600 -6241.9185   14  356 -13115.294 -2947.7785  77.5%  2009  287s
   641   637 -6224.3716   15  455 -13115.294 -2947.7785  77.5%  1977  290s
H  645   637                    -13009.45669 -2947.7785  77.3%  1970  290s
   682   666 -6128.4156   16  488 -13009.457 -2947.7785  77.3%  1929  301s
   715   706 -6742.3420   16  191 -13009.457 -2947.7785  77.3%  1895  306s
H  721   706                    -12904.72350 -2947.7785  77.2%  1881  306s
   757   765 -6382.5254   15  464 -12904.723 -2947.7785  77.2%  1858  315s
   844   821 infeasible   15      -12904.723 -2947.7785  77.2%  1792  325s
   922   904 -7014.3112   17  193 -12904.723 -2947.7785  77.2%  1746  335s
  1037   944 -6853.9066   17  478 -12904.723 -2947.7785  77.2%  1636  346s
H 1119   944                    -12897.95286 -3343.5532  74.1%  1572  346s
H 1132   944                    -12871.14953 -3343.5532  74.0%  1563  346s
  1163  1002 -6906.6062   16  438 -12871.150 -3343.5532  74.0%  1554  357s
  1259  1074 -7273.9916   17  186 -12871.150 -3343.5532  74.0%  1536  367s
H 1285  1074                    -12863.09005 -3343.5532  74.0%  1524  367s
  1365  1136 -6972.8208   18  473 -12863.090 -3343.5532  74.0%  1510  375s
  1477  1206 -10986.511   18  454 -12863.090 -3390.1950  73.6%  1488  382s
  1579  1294 -8658.1218   18  162 -12863.090 -3390.1950  73.6%  1480  390s
  1692  1361 -8458.0646   19  163 -12863.090 -3390.1950  73.6%  1466  398s
H 1716  1361                    -12845.01472 -3495.8425  72.8%  1455  398s
H 1722  1361                    -12843.76532 -3495.8425  72.8%  1457  398s
H 1804  1361                    -12832.12012 -3495.8425  72.8%  1445  398s
  1813  1473 -8653.5302   22  222 -12832.120 -3495.8425  72.8%  1448  406s
  1960  1564 -8982.1708   26  402 -12832.120 -3495.8425  72.8%  1418  417s
  2081  1606 -9541.5641   30  291 -12832.120 -3546.7453  72.4%  1404  427s
  2157  1658 -9669.7006   32  400 -12832.120 -3546.7453  72.4%  1403  436s
H 2223  1658                    -12784.88328 -3546.7453  72.3%  1399  436s
  2227  1780 -9744.5344   35  384 -12784.883 -3546.7453  72.3%  1402  445s
  2386  1883 -9940.0986   40  137 -12784.883 -3546.7453  72.3%  1375  455s
H 2390  1883                    -12782.92629 -3546.7453  72.3%  1374  455s
H 2392  1883                    -12770.60719 -3546.7453  72.2%  1375  455s
H 2408  1883                    -12768.02503 -3546.7453  72.2%  1374  455s
H 2450  1883                    -12766.29566 -3546.7453  72.2%  1362  455s
H 2480  1883                    -12763.68901 -3546.7453  72.2%  1361  455s
  2539  2017 -10166.795   41  351 -12763.689 -3546.7453  72.2%  1353  467s
  2746  2126 -10241.577   44  250 -12763.689 -3633.5648  71.5%  1326  480s
  2911  2262 -10564.392   55  284 -12763.689 -3991.3919  68.7%  1313  489s
  3085  2392 -11729.810   66  213 -12763.689 -4143.7586  67.5%  1304  498s
  3265  2528 -11211.252   77  230 -12763.689 -4143.7586  67.5%  1288  512s
  3473  2598 -11510.070   85  175 -12763.689 -4143.7586  67.5%  1274  523s
  3572  2599 -11307.495   22  540 -12763.689 -4143.7586  67.5%  1277  659s
  3574  2600 -9422.5361   18  171 -12763.689 -4143.7586  67.5%  1276  677s
  3575  2601 -7666.9913   15  417 -12763.689 -4143.7586  67.5%  1276  692s
  3576  2602 -9034.4178   25  514 -12763.689 -4143.7586  67.5%  1275  704s
  3577  2602 -6356.7801   14  518 -12763.689 -4143.7586  67.5%  1275  711s
  3578  2603 -8444.5334   21  530 -12763.689 -4143.7586  67.5%  1275  717s
  3579  2604 -11808.453   39  486 -12763.689 -4143.7586  67.5%  1274  722s
  3580  2604 -7168.7658   10  510 -12763.689 -4143.7586  67.5%  1274  728s
  3581  2605 -9745.3840   25  552 -12763.689 -4143.7586  67.5%  1274  731s
  3582  2606 -9667.0725   36  510 -12763.689 -4143.7586  67.5%  1273  735s
  3585  2608 -9699.6491   21  524 -12763.689 -4143.7586  67.5%  1272  741s
  3588  2610 -9630.7984   31  521 -12763.689 -4143.7586  67.5%  1271  745s
  3591  2612 -10980.295   38  558 -12763.689 -4143.7586  67.5%  1270  754s
  3592  2612 -10675.071   57  497 -12763.689 -4143.7586  67.5%  1270  756s
  3595  2614 -6492.6827   14  502 -12763.689 -4143.7586  67.5%  1269  761s
  3596  2615 -9386.2231   17  551 -12763.689 -4143.7586  67.5%  1268  766s
  3599  2617 -7551.9057    8  548 -12763.689 -4143.7586  67.5%  1267  773s
  3600  2618 -11354.461   35  555 -12763.689 -4143.7586  67.5%  1267  775s
  3603  2620 -8492.6507   18  545 -12763.689 -4143.7586  67.5%  1266  784s
  3604  2620 -11766.156   79  544 -12763.689 -4143.7586  67.5%  1265  786s
  3606  2622 -11455.687   39  511 -12763.689 -4143.7586  67.5%  1265  792s
  3607  2622 -11832.539   87  479 -12763.689 -4143.7586  67.5%  1264  795s
  3610  2624 -12127.837   35  547 -12763.689 -4143.7586  67.5%  1263  802s
  3611  2625 -9377.9256   25  448 -12763.689 -4143.7586  67.5%  1263  805s
  3614  2627 -7211.2715   14  482 -12763.689 -4143.7586  67.5%  1262  827s
  3615  2628 -5933.9767    7  482 -12763.689 -4143.7586  67.5%  1262  842s
  3616  2631 -4143.7586   16  492 -12763.689 -4143.7586  67.5%  1298  859s
  3618  2635 -4143.7586   17  513 -12763.689 -4143.7586  67.5%  1301  871s
  3622  2641 -4143.7586   18  501 -12763.689 -4143.7586  67.5%  1305  881s
  3630  2655 -4143.7586   19  508 -12763.689 -4143.7586  67.5%  1313  895s
  3646  2667 -6312.7207   20  490 -12763.689 -4143.7586  67.5%  1352  915s
  3664  2693 -5957.2004   21  375 -12763.689 -4143.7586  67.5%  1373  924s
  3696  2777 -6386.7724   22  450 -12763.689 -4143.7586  67.5%  1396  940s
  3792  2779 -7243.6351   24  374 -12763.689 -4143.7586  67.5%  1437  951s
  3828  2828 -7723.4199   25  385 -12763.689 -4143.7586  67.5%  1446  963s
  3899  2885 -8566.8470   24  428 -12763.689 -4143.7586  67.5%  1471  972s
  3983  2927 -7353.9404   25  363 -12763.689 -4143.7586  67.5%  1479  983s
  4064  2951 -11011.415   24  294 -12763.689 -4143.7586  67.5%  1495  995s
  4145  2974 -8744.0288   26  416 -12763.689 -4143.7586  67.5%  1506 1005s
  4213  2982 -8130.3805   26  469 -12763.689 -4143.7586  67.5%  1528 1017s
  4289  2993 -7762.0578   26  414 -12763.689 -4143.7586  67.5%  1537 1033s
  4370  2990 -8551.0903   27  497 -12763.689 -4143.7586  67.5%  1558 1047s
  4438  2995 -8469.1830   27  355 -12763.689 -4212.6515  67.0%  1583 1060s
  4506  2994 -8583.5352   28  226 -12763.689 -4219.0928  66.9%  1608 1077s
  4575  3000 -8885.9393   29  213 -12763.689 -4219.0928  66.9%  1626 1090s
  4648  2995 infeasible   31      -12763.689 -4219.0928  66.9%  1652 1106s
  4696  3002     cutoff   32      -12763.689 -4219.0928  66.9%  1677 1115s
  4734  3017 -11105.266   33  245 -12763.689 -4703.2696  63.2%  1704 1129s
  4781  3033 infeasible   33      -12763.689 -4703.2696  63.2%  1727 1139s
H 4787  2898                    -12721.49720 -4703.2696  63.0%  1731 1139s
  4826  2893 -12293.750   35  338 -12721.497 -4703.2696  63.0%  1754 1153s
  4894  2917 infeasible   35      -12721.497 -4837.2066  62.0%  1768 1163s
  4980  2901     cutoff   38      -12721.497 -5227.9109  58.9%  1791 1178s
  5035  2917 -7076.8363   21  384 -12721.497 -5230.8954  58.9%  1806 1190s
  5106  2932 -6853.0121   21  438 -12721.497 -5327.5060  58.1%  1839 1205s
  5183  2951 -8609.3770   22  354 -12721.497 -5327.5060  58.1%  1872 1220s
  5268  2955 -7564.9094   22  455 -12721.497 -5617.0875  55.8%  1899 1237s
  5369  2951 -9240.9442   23  304 -12721.497 -5617.0875  55.8%  1921 1254s
  5430  2967 -9288.1482   22  272 -12721.497 -5617.0875  55.8%  1958 1269s
  5522  2958 -8744.4879   23  408 -12721.497 -5713.5160  55.1%  1992 1283s
  5568  2971 -9269.8684   24  299 -12721.497 -5713.5160  55.1%  2012 1294s
  5614  2986 -7285.8690   22  388 -12721.497 -5713.5160  55.1%  2028 1307s
  5663  2993 -11002.643   24  428 -12721.497 -5713.5160  55.1%  2045 1322s
H 5666  2867                    -12721.20222 -5713.5160  55.1%  2045 1322s
  5741  2859 -11478.017   25  297 -12721.202 -5713.5160  55.1%  2061 1340s
  5869  2860 -10750.257   26  217 -12721.202 -6307.8947  50.4%  2073 1358s
  6025  2871 -11105.246   26  471 -12721.202 -6387.0136  49.8%  2091 1377s
  6158  2903     cutoff   29      -12721.202 -6406.3208  49.6%  2124 1394s
  6320  2909 -12105.163   29  203 -12721.202 -6567.9179  48.4%  2141 1415s
  6491  2900 -9920.2427   22  460 -12721.202 -6567.9179  48.4%  2156 1431s
  6688  2900 -11215.001   25  370 -12721.202 -6630.6552  47.9%  2168 1450s
  6862  2898 -12119.834   29  319 -12721.202 -6660.5838  47.6%  2204 1471s
  6963  2943 -12559.838   35  244 -12721.202 -6699.5945  47.3%  2236 1493s
  7139  2954 -8454.5242   31  456 -12721.202 -6842.8133  46.2%  2267 1516s
  7377  2986 -10254.452   35  350 -12721.202 -6842.8133  46.2%  2279 1538s
* 7637  2748              45    -12428.52025 -7056.9379  43.2%  2271 1538s
  7669  2820 -11163.646   37  323 -12428.520 -7056.9379  43.2%  2270 1561s
  7912  2819     cutoff   42      -12428.520 -7284.3081  41.4%  2286 1586s
  8153  2814 -9571.6231   24  405 -12428.520 -7293.1004  41.3%  2312 1611s
H 8167  2650                    -12205.37984 -7293.1004  40.2%  2314 1611s
H 8257  2478                    -12081.45666 -7293.1004  39.6%  2314 1611s
H 8310  2299                    -11948.14595 -7293.1004  39.0%  2320 1611s
H 8318  2199                    -11947.23711 -7293.1004  39.0%  2319 1611s
  8379  2231 -10452.099   29  186 -11947.237 -7293.1004  39.0%  2324 1639s
  8658  2201 -11843.168   24  501 -11947.237 -7493.5117  37.3%  2347 1665s
  8943  2152 -10123.856   28  404 -11947.237 -7565.0243  36.7%  2370 1693s
  9252  2145 -11535.561   32  406 -11947.237 -7714.2927  35.4%  2389 1721s
H 9292  2143                    -11941.77272 -7714.2927  35.4%  2395 1721s
H 9442  2121                    -11881.06420 -7714.2927  35.1%  2410 1721s
  9484  2128     cutoff   35      -11881.064 -7714.2927  35.1%  2417 1750s
  9741  2204 -11442.694   29  398 -11881.064 -7880.3840  33.7%  2441 1780s
 10118  2253 -10535.424   27  372 -11881.064 -8078.7166  32.0%  2451 1812s
 10477  2354     cutoff   26      -11881.064 -8158.0260  31.3%  2473 1844s
 10865  2428     cutoff   29      -11881.064 -8158.0260  31.3%  2488 1875s
 11239  2463 -11539.955   32  248 -11881.064 -8294.1221  30.2%  2513 1908s
 11613  2496     cutoff   31      -11881.064 -8444.9822  28.9%  2539 1946s
 12057  2577     cutoff   34      -11881.064 -8581.8486  27.8%  2548 1981s
 12489  2590 infeasible   39      -11881.064 -8658.8640  27.1%  2565 2019s
 12968  2644 -11305.414   33  182 -11881.064 -8753.0331  26.3%  2577 2058s
 13512  2699     cutoff   33      -11881.064 -8977.5329  24.4%  2581 2096s
 14178  2697 -11804.356   26  359 -11881.064 -9121.8751  23.2%  2567 2136s
 14742  2743     cutoff   31      -11881.064 -9190.9976  22.6%  2575 2179s
 15427  2687 -10764.471   26  362 -11881.064 -9365.7960  21.2%  2568 2222s
 16057  2603 -10926.545   26  485 -11881.064 -9481.4721  20.2%  2560 2266s
 16793  2488     cutoff   41      -11881.064 -9663.7954  18.7%  2559 2307s
 17610  2255 -11130.830   43  211 -11881.064 -9817.6123  17.4%  2542 2350s
 18560  1900     cutoff   35      -11881.064 -10010.054  15.7%  2514 2392s
 19596  1452     cutoff   34      -11881.064 -10237.680  13.8%  2480 2441s
 20793   141     cutoff   33      -11881.064 -10558.063  11.1%  2428 2481s
 22624     0 -11658.392   34  162 -11881.064 -10973.250  7.64%  2300 2487s

Cutting planes:
  Gomory: 2
  MIR: 617
  Flow cover: 1346
  RLT: 12
  Relax-and-lift: 143

Explored 22804 nodes (52277652 simplex iterations) in 2487.99 seconds (4816.46 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -11881.1 -11941.8 -11947.2 ... -12763.7
No other solutions better than -11881.1

Optimal solution found (tolerance 1.00e-04)
Best objective -1.188106419771e+04, best bound -1.188106419771e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2487.99s
  Master Objective (UB) = -11881.06, θ = 131953.44
  Upper Bound (UB) = -11881.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131953.44
  [DEBUG]   ✓ Scenario 0: θ = 131953.44 ≤ Q = 131953.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131953.44 ≤ Q = 131953.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131953.44 ≤ Q = 131953.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131953.44 ≤ Q = 131953.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131953.44 ≤ Q = 131953.44 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x40e76cda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x40e76cda
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.160504e+13
Presolve removed 2606 rows and 1897 columns
Presolve time: 0.01s
Presolved: 487 rows, 492 columns, 1374 nonzeros
Found heuristic solution: objective 5069815.5358
Variable types: 333 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5069498.7501

Root relaxation: objective -1.554425e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155442.45    0  127 5069498.75 -155442.45   103%     -    0s
H    0     0                    -127701.5779 -155442.45  21.7%     -    0s
H    0     0                    -133121.4576 -135369.82  1.69%     -    0s
     0     0 -135369.82    0   71 -133121.46 -135369.82  1.69%     -    0s
H    0     0                    -133392.6455 -135338.52  1.46%     -    0s
H    0     0                    -133395.4920 -135338.52  1.46%     -    0s
H    0     0                    -133666.6800 -135338.52  1.25%     -    0s
     0     0 -134895.55    0   72 -133666.68 -134895.55  0.92%     -    0s
     0     0 -134380.82    0   52 -133666.68 -134380.82  0.53%     -    0s
     0     0 -134226.36    0   43 -133666.68 -134226.36  0.42%     -    0s
     0     0 -134208.35    0   43 -133666.68 -134208.35  0.41%     -    0s
     0     0 -134208.21    0   43 -133666.68 -134208.21  0.41%     -    0s
     0     0 -133983.15    0   28 -133666.68 -133983.15  0.24%     -    0s
     0     0 -133982.59    0   22 -133666.68 -133982.59  0.24%     -    0s
     0     0 -133934.49    0   25 -133666.68 -133934.49  0.20%     -    0s
     0     0 -133934.42    0   26 -133666.68 -133934.42  0.20%     -    0s
     0     0 -133930.45    0   25 -133666.68 -133930.45  0.20%     -    0s
     0     0 -133884.87    0   18 -133666.68 -133884.87  0.16%     -    0s
     0     0 -133862.84    0   23 -133666.68 -133862.84  0.15%     -    0s
     0     0 -133849.83    0   18 -133666.68 -133849.83  0.14%     -    0s
     0     0 -133849.83    0   49 -133666.68 -133849.83  0.14%     -    0s
     0     0 -133764.43    0   10 -133666.68 -133764.43  0.07%     -    0s
     0     0 -133719.12    0    3 -133666.68 -133719.12  0.04%     -    0s
     0     0 -133711.88    0    2 -133666.68 -133711.88  0.03%     -    0s
     0     0 -133711.88    0   16 -133666.68 -133711.88  0.03%     -    0s
H    0     0                    -133667.3195 -133711.88  0.03%     -    0s
     0     0 -133711.88    0    9 -133667.32 -133711.88  0.03%     -    0s
H    0     0                    -133704.6404 -133711.88  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 2
  Flow cover: 7

Explored 1 nodes (964 simplex iterations) in 0.18 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -133705 -133667 -133667 ... 5.06982e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.337046404294e+05, best bound -1.337118812804e+05, gap 0.0054%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 120457.37
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133704.64
  [DEBUG]   S×d_nominal = 254162.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254162.01 + -133704.64 = 120457.37
  [DEBUG]   Current θ from Master = 131953.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11496.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23377.14
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 4944.7294, Absolute Gap = 4944.7294, Relative Gap = 0.416186
  Not converged yet (gap = 4944.73 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0xbe3d6ceb
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 1.41s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -188195.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23941   -7.7871318e+04   0.000000e+00   9.958966e+07      5s
   35968   -1.1179582e+04   0.000000e+00   1.644765e+07     10s
   44611   -4.1516927e+03   0.000000e+00   6.900035e+06     15s
   52562    2.3185501e+03   0.000000e+00   3.726128e+07     20s
   60572    5.6822501e+03   0.000000e+00   3.610326e+05     25s
   66408    5.9699225e+03   0.000000e+00   7.242511e+05     30s
Concurrent spin time: 0.51s

Solved with dual simplex

Root relaxation: objective 9.498172e+03, 48534 iterations, 33.01 seconds (45.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 9498.17211    0  171 -188195.78 9498.17211   105%     -   35s
H    0     0                    -178397.7188 9498.17211   105%     -   35s
H    0     0                    -78675.50098 9498.17211   112%     -   35s
H    0     0                    -77414.68669 9498.17211   112%     -   35s
H    0     0                    -70579.96750 9498.17211   113%     -   35s
H    0     0                    -56474.64059 9498.17211   117%     -   35s
H    0     0                    -52704.02932 9498.17211   118%     -   35s
H    0     0                    -39973.49513 9498.17211   124%     -   35s
H    0     0                    -34441.88699 9498.17211   128%     -   35s
H    0     0                    -26482.31980 9498.17211   136%     -   36s
H    0     0                    -25297.26656 9498.17211   138%     -   36s
H    0     0                    -24629.47732 9498.17211   139%     -   36s
     0     0 6450.37159    0  290 -24629.477 6450.37159   126%     -   47s
H    0     0                    -24174.22678 6450.13694   127%     -   48s
H    0     0                    -24144.23107 6450.13694   127%     -   48s
H    0     0                    -24033.71340 6450.13694   127%     -   48s
     0     0 5484.04532    0  355 -24033.713 5484.04532   123%     -   54s
     0     0 5484.04532    0  349 -24033.713 5484.04532   123%     -   55s
     0     0 5484.04532    0  347 -24033.713 5484.04532   123%     -   55s
     0     0 5484.04532    0  350 -24033.713 5484.04532   123%     -   56s
     0     0 5484.04532    0  346 -24033.713 5484.04532   123%     -   56s
     0     0 5484.04532    0  346 -24033.713 5484.04532   123%     -   57s
     0     0 5484.04532    0  346 -24033.713 5484.04532   123%     -   57s
H    0     0                    -23466.23921 2678.59519   111%     -   69s
H    0     0                    -23394.77220 2678.59519   111%     -   69s
H    0     0                    -23273.06302 2678.59519   112%     -   69s
     0     0 2678.59519    0  342 -23273.063 2678.59519   112%     -   69s
H    0     0                    -23136.14037 1824.17252   108%     -   77s
H    0     0                    -22639.53859 1824.17252   108%     -   77s
     0     0 1824.17252    0  348 -22639.539 1824.17252   108%     -   77s
     0     0 1636.00787    0  388 -22639.539 1636.00787   107%     -   83s
     0     0 1560.47198    0  358 -22639.539 1560.47198   107%     -   86s
     0     0 1515.54510    0  383 -22639.539 1515.54510   107%     -   88s
     0     0 1471.97220    0  369 -22639.539 1471.97220   107%     -   89s
     0     0 1468.18611    0  364 -22639.539 1468.18611   106%     -   89s
     0     0 1465.95799    0  363 -22639.539 1465.95799   106%     -   90s
     0     0 1414.93723    0  406 -22639.539 1414.93723   106%     -   91s
     0     0 1405.39384    0  408 -22639.539 1405.39384   106%     -   92s
     0     0 1403.51477    0  408 -22639.539 1403.51477   106%     -   92s
     0     0 1403.46172    0  409 -22639.539 1403.46172   106%     -   92s
H    0     0                    -17388.14953 1403.46172   108%     -  100s
H    0     0                    -16777.48241 1403.46172   108%     -  100s
     0     0 -118.02962    0  459 -16777.482 -118.02962  99.3%     -  114s
H    0     0                    -16608.08187 -118.43954  99.3%     -  114s
     0     0 -526.69419    0  504 -16608.082 -526.69419  96.8%     -  122s
     0     0 -698.31076    0  532 -16608.082 -698.31076  95.8%     -  127s
     0     0 -919.33266    0  492 -16608.082 -919.33266  94.5%     -  131s
     0     0 -1053.3977    0  487 -16608.082 -1053.3977  93.7%     -  134s
     0     0 -1103.2357    0  481 -16608.082 -1103.2357  93.4%     -  136s
     0     0 -1118.9160    0  482 -16608.082 -1118.9160  93.3%     -  137s
     0     0 -1171.9346    0  486 -16608.082 -1171.9346  92.9%     -  139s
     0     0 -1187.4868    0  482 -16608.082 -1187.4868  92.8%     -  140s
     0     0 -1197.8455    0  489 -16608.082 -1197.8455  92.8%     -  141s
     0     0 -1203.0218    0  493 -16608.082 -1203.0218  92.8%     -  142s
     0     0 -1215.5150    0  472 -16608.082 -1215.5150  92.7%     -  143s
     0     0 -1230.0668    0  477 -16608.082 -1230.0668  92.6%     -  143s
H    0     0                    -15156.83490 -1236.4702  91.8%     -  144s
H    0     0                    -14534.86238 -1236.4702  91.5%     -  144s
     0     0 -1236.4702    0  479 -14534.862 -1236.4702  91.5%     -  144s
H    0     0                    -14439.01086 -1236.9651  91.4%     -  144s
     0     0 -1236.9651    0  483 -14439.011 -1236.9651  91.4%     -  144s
H    0     0                    -14428.39764 -1236.9651  91.4%     -  156s
H    0     0                    -14235.28453 -1236.9651  91.3%     -  156s
     0     0 -1941.6892    0  537 -14235.285 -1941.6892  86.4%     -  164s
H    0     0                    -14208.59037 -1941.9202  86.3%     -  164s
H    0     0                    -14117.71986 -1941.9202  86.2%     -  165s
H    0     0                    -14033.90764 -1941.9202  86.2%     -  165s
H    0     0                    -13897.79845 -1941.9202  86.0%     -  165s
     0     0 -2123.5476    0  483 -13897.798 -2123.5476  84.7%     -  170s
     0     0 -2191.8214    0  479 -13897.798 -2191.8214  84.2%     -  174s
     0     0 -2215.7129    0  520 -13897.798 -2215.7129  84.1%     -  177s
     0     0 -2237.8405    0  540 -13897.798 -2237.8405  83.9%     -  179s
     0     0 -2266.6754    0  552 -13897.798 -2266.6754  83.7%     -  180s
     0     0 -2307.1562    0  547 -13897.798 -2307.1562  83.4%     -  182s
     0     0 -2314.2804    0  554 -13897.798 -2314.2804  83.3%     -  183s
     0     0 -2317.3057    0  566 -13897.798 -2317.3057  83.3%     -  183s
     0     0 -2318.5781    0  518 -13897.798 -2318.5781  83.3%     -  184s
     0     0 -2443.7225    0  540 -13897.798 -2443.7225  82.4%     -  189s
H    0     0                    -13890.86784 -2444.1336  82.4%     -  190s
     0     0 -2478.8651    0  539 -13890.868 -2478.8651  82.2%     -  191s
     0     0 -2493.8716    0  546 -13890.868 -2493.8716  82.0%     -  193s
     0     0 -2496.5508    0  600 -13890.868 -2496.5508  82.0%     -  193s
     0     0 -2497.6485    0  546 -13890.868 -2497.6485  82.0%     -  194s
     0     0 -2530.9285    0  539 -13890.868 -2530.9285  81.8%     -  196s
H    0     0                    -13803.47859 -2531.4258  81.7%     -  197s
H    0     0                    -13691.33943 -2531.4258  81.5%     -  197s
     0     0 -2536.7928    0  545 -13691.339 -2536.7928  81.5%     -  198s
     0     0 -2538.7969    0  557 -13691.339 -2538.7969  81.5%     -  199s
     0     0 -2539.3842    0  555 -13691.339 -2539.3842  81.5%     -  199s
     0     0 -2583.3361    0  545 -13691.339 -2583.3361  81.1%     -  202s
     0     0 -2590.9128    0  563 -13691.339 -2590.9128  81.1%     -  204s
     0     0 -2591.7258    0  598 -13691.339 -2591.7258  81.1%     -  204s
     0     0 -2624.4918    0  554 -13691.339 -2624.4918  80.8%     -  208s
H    0     0                    -13652.51437 -2624.5231  80.8%     -  209s
H    0     0                    -13522.82695 -2624.5231  80.6%     -  209s
     0     0 -2634.1145    0  501 -13522.827 -2634.1145  80.5%     -  209s
     0     0 -2639.0535    0  547 -13522.827 -2639.0535  80.5%     -  211s
     0     0 -2640.4350    0  502 -13522.827 -2640.4350  80.5%     -  211s
     0     0 -2647.7876    0  516 -13522.827 -2647.7876  80.4%     -  213s
H    0     0                    -13495.56772 -2647.8659  80.4%     -  213s
     0     0 -2651.4828    0  568 -13495.568 -2651.4828  80.4%     -  214s
     0     0 -2652.9979    0  575 -13495.568 -2652.9979  80.3%     -  215s
     0     0 -2654.5543    0  521 -13495.568 -2654.5543  80.3%     -  215s
     0     0 -2654.7892    0  521 -13495.568 -2654.7892  80.3%     -  215s
     0     0 -2671.6861    0  525 -13495.568 -2671.6861  80.2%     -  217s
H    0     0                    -13495.37847 -2673.2107  80.2%     -  220s
H    0     0                    -13489.27573 -2673.2107  80.2%     -  220s
H    0     0                    -13475.93181 -2673.2107  80.2%     -  220s
     0     0 -2674.7840    0  528 -13475.932 -2674.7840  80.2%     -  221s
     0     0 -2675.3563    0  533 -13475.932 -2675.3563  80.1%     -  221s
     0     0 -2686.7388    0  565 -13475.932 -2686.7388  80.1%     -  223s
     0     0 -2688.6781    0  618 -13475.932 -2688.6781  80.0%     -  223s
     0     0 -2689.9411    0  614 -13475.932 -2689.9411  80.0%     -  224s
     0     0 -2691.6228    0  572 -13475.932 -2691.6228  80.0%     -  226s
     0     0 -2692.2553    0  624 -13475.932 -2692.2553  80.0%     -  227s
     0     0 -2693.7663    0  573 -13475.932 -2693.7663  80.0%     -  229s
     0     0 -2694.1365    0  573 -13475.932 -2694.1365  80.0%     -  230s
H    0     0                    -13382.71434 -2695.1290  79.9%     -  256s
     0     2 -2695.1290    0  573 -13382.714 -2695.1290  79.9%     -  257s
     1     4 -2737.8536    1  606 -13382.714 -2695.1290  79.9%  1702  261s
     3     8 -3024.2585    2  580 -13382.714 -2739.1811  79.5%  3479  269s
     7    16 -3157.5775    3  588 -13382.714 -2930.6692  78.1%  4914  276s
    15    32 -3314.0870    4  620 -13382.714 -3157.8538  76.4%  5412  286s
    31    48 -4205.6951    5  552 -13382.714 -3315.2745  75.2%  7948  312s
H   47    80                    -13321.62968 -3315.2745  75.1%  7211  325s
H   75    80                    -13264.56023 -3315.2745  75.0%  5717  325s
    79   154 -4010.5374    7  526 -13264.560 -3315.2745  75.0%  5512  348s
   155   282 -4137.0827    9  580 -13264.560 -3315.2745  75.0%  3619  360s
   287   362 -4396.6244    8  344 -13264.560 -3315.2745  75.0%  2812  370s
   377   426 -4241.4465    9  469 -13264.560 -3315.2745  75.0%  2594  383s
   449   491 -4884.2730   11  437 -13264.560 -3315.2745  75.0%  2510  394s
   530   554 -4476.9080   12  578 -13264.560 -3315.2745  75.0%  2409  405s
H  566   554                    -13262.84264 -3315.2745  75.0%  2342  405s
   608   627 -4761.7943   13  552 -13262.843 -3315.2745  75.0%  2315  416s
   698   660 -7118.2227   13  448 -13262.843 -3315.2745  75.0%  2210  426s
   763   707 -7027.8116   13  445 -13262.843 -3315.2745  75.0%  2204  436s
   844   760 -5105.5046   14  560 -13262.843 -3315.2745  75.0%  2163  447s
   915   805 -5193.8525   14  519 -13262.843 -3315.2745  75.0%  2116  458s
   994   843 -5302.6953   15  490 -13262.843 -3315.2745  75.0%  2083  469s
  1036   914 -5501.0309   16  436 -13262.843 -3315.2745  75.0%  2086  479s
H 1045   914                    -13248.99810 -3315.2745  75.0%  2087  479s
  1109   982 -7245.7837   15  541 -13248.998 -3315.2745  75.0%  2056  490s
  1197  1084 -6395.3996   17  359 -13248.998 -3315.2745  75.0%  2020  501s
  1317  1174 -6204.1579   18  530 -13248.998 -3315.2745  75.0%  1953  512s
  1445  1242 -6922.3781   20  410 -13248.998 -3315.2745  75.0%  1892  525s
  1577  1307 -7026.1366   21  402 -13248.998 -3315.2745  75.0%  1828  537s
  1685  1373 -7177.3111   22  396 -13248.998 -3315.2745  75.0%  1811  550s
  1813  1433 -8959.7728   21  174 -13248.998 -3315.2745  75.0%  1796  562s
H 1820  1433                    -13248.86774 -3315.2745  75.0%  1800  562s
  1923  1502     cutoff   21      -13248.868 -3750.9892  71.7%  1799  578s
  2033  1542 -7609.4304   24  315 -13248.868 -3750.9892  71.7%  1812  590s
H 2039  1542                    -13214.32527 -3750.9892  71.6%  1815  590s
  2087  1625 -8512.8659   25  343 -13214.325 -3750.9892  71.6%  1821  604s
  2212  1724 -9723.1366   25  299 -13214.325 -3750.9892  71.6%  1818  618s
  2341  1821 -9163.6374   26  343 -13214.325 -3750.9892  71.6%  1811  633s
  2490  1914 -9303.7857   27  333 -13214.325 -3750.9892  71.6%  1804  646s
  2669  2003 -10851.714   27  245 -13214.325 -4094.4744  69.0%  1780  661s
  2806  2095 -11005.578   30  245 -13214.325 -4127.7366  68.8%  1793  676s
  2950  2198     cutoff   31      -13214.325 -4127.7366  68.8%  1798  691s
  3117  2231 -7503.8144    7  502 -13214.325 -4127.7366  68.8%  1797  708s
H 3132  2231                    -13186.79597 -4182.4105  68.3%  1804  708s
H 3140  2231                    -13114.29286 -4182.4105  68.1%  1808  708s
H 3140  2231                    -13097.11916 -4182.4105  68.1%  1808  708s
  3180  2305 -7868.3700    8  497 -13097.119 -4182.4105  68.1%  1797  726s
  3302  2434 -8541.2887   11  432 -13097.119 -4311.8583  67.1%  1830  744s
  3465  2557 -9289.4306   16  296 -13097.119 -4325.2409  67.0%  1841  762s
  3621  2558 -9723.8171   26  573 -13097.119 -4349.8167  66.8%  1858  824s
  3623  2559 -12308.268   12  171 -13097.119 -4349.8167  66.8%  1857  859s
  3624  2560 -11415.461   20  438 -13097.119 -4349.8167  66.8%  1856  877s
  3625  2561 -10764.781   38  453 -13097.119 -4349.8167  66.8%  1856  893s
  3626  2561 -12598.626   21  557 -13097.119 -4349.8167  66.8%  1855  905s
  3627  2562 -10599.401   46  542 -13097.119 -4349.8167  66.8%  1855  916s
  3628  2563 -9568.0288   30  520 -13097.119 -4349.8167  66.8%  1854  926s
  3629  2563 -12475.423   38  550 -13097.119 -4349.8167  66.8%  1854  930s
  3630  2564 -12194.903   47  541 -13097.119 -4349.8167  66.8%  1853  937s
  3631  2565 -9252.8405   22  599 -13097.119 -4349.8167  66.8%  1853  941s
  3632  2565 -11740.597   27  534 -13097.119 -4349.8167  66.8%  1852  945s
  3634  2567 -6513.8725   12  543 -13097.119 -4349.8167  66.8%  1851  954s
  3635  2567 -7711.4210   13  557 -13097.119 -4349.8167  66.8%  1851  956s
  3637  2569 -11110.679   47  570 -13097.119 -4349.8167  66.8%  1850  961s
  3638  2569 -9445.8449   20  563 -13097.119 -4349.8167  66.8%  1849  967s
  3640  2571 -9849.2774   39  621 -13097.119 -4349.8167  66.8%  1848  972s
  3641  2571 -6128.8359   18  562 -13097.119 -4349.8167  66.8%  1848  976s
  3643  2573 -7928.3770   14  623 -13097.119 -4349.8167  66.8%  1847  981s
  3645  2574 -7593.1900   10  622 -13097.119 -4349.8167  66.8%  1846  990s
  3647  2575 -10306.173   14  516 -13097.119 -4349.8167  66.8%  1845  995s
  3649  2577 -10018.982   19  503 -13097.119 -4349.8167  66.8%  1844 1002s
  3650  2577 -10830.059   17  506 -13097.119 -4349.8167  66.8%  1843 1005s
  3651  2578 -11521.956   47  506 -13097.119 -4349.8167  66.8%  1843 1010s
  3653  2579 -11203.523   24  564 -13097.119 -4349.8167  66.8%  1842 1017s
  3654  2580 -9961.0718   18  557 -13097.119 -4349.8167  66.8%  1841 1020s
  3656  2581 -7524.3857   18  570 -13097.119 -4349.8167  66.8%  1840 1026s
  3657  2582 -7550.2822   25  512 -13097.119 -4349.8167  66.8%  1840 1030s
  3659  2583 -10827.875   18  510 -13097.119 -4349.8167  66.8%  1839 1037s
  3660  2584 -11964.348   36  510 -13097.119 -4349.8167  66.8%  1838 1069s
  3661  2585 -9194.5679   20  510 -13097.119 -4349.8167  66.8%  1838 1084s
  3662  2588 -4349.8167   16  500 -13097.119 -4349.8167  66.8%  1888 1102s
  3664  2592 -4349.8167   17  502 -13097.119 -4349.8167  66.8%  1890 1117s
  3668  2598 -4349.8167   18  557 -13097.119 -4349.8167  66.8%  1896 1142s
  3676  2612 -4349.8167   19  450 -13097.119 -4349.8167  66.8%  1902 1158s
  3692  2621 -5560.2174   20  441 -13097.119 -4349.8167  66.8%  1962 1272s
  3709  2645 -5552.6769   21  386 -13097.119 -4349.8167  66.8%  1997 1288s
  3741  2748 -5897.0649   22  267 -13097.119 -4349.8167  66.8%  2043 1308s
H 3752  2614                    -13081.85673 -4349.8167  66.7%  2048 1308s
  3859  2642 -6397.0902   24  321 -13081.857 -4349.8167  66.7%  2069 1322s
  3928  2654 -6868.0969   24  287 -13081.857 -4349.8167  66.7%  2086 1332s
  3968  2692 -6978.3531   25  289 -13081.857 -4349.8167  66.7%  2088 1346s
  4038  2710     cutoff   24      -13081.857 -4349.8167  66.7%  2095 1363s
  4104  2723 -7419.8790   26  298 -13081.857 -4349.8167  66.7%  2107 1378s
  4180  2711 -8584.8542   27  199 -13081.857 -4349.8167  66.7%  2110 1396s
  4253  2704 -10196.960   28  265 -13081.857 -4349.8167  66.7%  2112 1409s
H 4322  2586                    -13054.25644 -4349.8167  66.7%  2121 1421s
  4375  2610 -9074.5564   29  152 -13054.256 -4349.8167  66.7%  2126 1435s
  4447  2607 -10125.947   32  217 -13054.256 -4349.8167  66.7%  2131 1447s
H 4449  2489                    -13031.23993 -4349.8167  66.6%  2132 1447s
H 4488  2365                    -13024.82941 -4349.8167  66.6%  2138 1447s
  4499  2394 -9696.0628   30  235 -13024.829 -4349.8167  66.6%  2137 1462s
  4561  2405 -9778.6254   32  210 -13024.829 -4349.8167  66.6%  2149 1475s
H 4616  2280                    -13014.29392 -4349.8167  66.6%  2151 1475s
  4618  2318 -10025.100   34  168 -13014.294 -4349.8167  66.6%  2152 1488s
  4690  2321 -9992.5363   36  148 -13014.294 -4349.8167  66.6%  2155 1502s
H 4695  2218                    -13007.90425 -4349.8167  66.6%  2154 1502s
  4739  2232 -10192.172   39  199 -13007.904 -4349.8167  66.6%  2163 1517s
  4818  2228 -10400.316   41  135 -13007.904 -4349.8167  66.6%  2170 1531s
  4856  2236 -10471.726   42  107 -13007.904 -4664.7480  64.1%  2179 1546s
H 4893  2129                    -13002.87203 -4741.7980  63.5%  2191 1546s
  4896  2177 -10614.367   42  170 -13002.872 -4741.7980  63.5%  2194 1562s
  4978  2180 -10815.681   44  246 -13002.872 -4741.7980  63.5%  2197 1578s
H 4980  2088                    -12927.19094 -4741.7980  63.3%  2197 1578s
  5049  2116 -11265.284   46  109 -12927.191 -4741.7980  63.3%  2201 1596s
  5152  2105 infeasible   50      -12927.191 -4741.7980  63.3%  2201 1607s
H 5155  2018                    -12841.50161 -4741.7980  63.1%  2200 1607s
  5194  2062 -12008.038   52  185 -12841.502 -4984.8085  61.2%  2204 1624s
  5305  2059     cutoff   59      -12841.502 -4984.8085  61.2%  2206 1646s
H 5328  1969                    -12770.42013 -4984.8085  61.0%  2208 1646s
  5411  1982 -8688.2561   23  374 -12770.420 -5620.6083  56.0%  2211 1664s
H 5525  1891                    -12765.19145 -5637.9221  55.8%  2217 1684s
  5648  1894 -10264.999   26  411 -12765.191 -5637.9221  55.8%  2223 1705s
  5753  1880 -11084.961   28  362 -12765.191 -5661.0061  55.7%  2241 1721s
  5809  1900 -11102.178   29  360 -12765.191 -5661.0061  55.7%  2247 1741s
  5912  1932 -12235.987   32  315 -12765.191 -5677.7117  55.5%  2257 1763s
  6054  1912     cutoff   28      -12765.191 -5804.0104  54.5%  2259 1783s
H 6108  1820                    -12762.20695 -5804.0104  54.5%  2264 1783s
  6125  1871 -8013.3645   26  360 -12762.207 -5804.0104  54.5%  2268 1805s
  6270  1860 -8472.1132   28  278 -12762.207 -6102.2031  52.2%  2275 1830s
  6418  1871 -9350.2872   30  288 -12762.207 -6102.2031  52.2%  2288 1854s
  6580  1850 -12454.168   33  101 -12762.207 -6445.0641  49.5%  2300 1878s
  6754  1838 -10768.027   36  272 -12762.207 -6445.0641  49.5%  2308 1900s
  6903  1845 -11862.165   40  156 -12762.207 -6646.7177  47.9%  2314 1925s
  7053  1818 -12703.521   43  146 -12762.207 -6839.0587  46.4%  2305 1954s
  7237  1784 -11588.280   27  556 -12762.207 -7347.3497  42.4%  2313 1983s
  7446  1761 -12588.652   28  559 -12762.207 -7350.5943  42.4%  2319 2009s
  7643  1768 -10793.865   28  441 -12762.207 -7350.5943  42.4%  2333 2037s
  7877  1748     cutoff   30      -12762.207 -7766.4938  39.1%  2337 2070s
  8111  1781     cutoff   29      -12762.207 -7820.5929  38.7%  2347 2101s
  8218  1874 -10858.769   32  177 -12762.207 -7820.5929  38.7%  2350 2129s
  8489  1924     cutoff   44      -12762.207 -7890.6457  38.2%  2332 2160s
  8764  1951 -11657.651   28  536 -12762.207 -8128.4558  36.3%  2339 2195s
  9099  2094     cutoff   33      -12762.207 -8358.9505  34.5%  2336 2228s
  9486  2201 -12301.671   29  256 -12762.207 -8514.0691  33.3%  2321 2263s
H 9600  2084                    -12412.60366 -8514.0691  31.4%  2311 2263s
  9860  2066     cutoff   31      -12412.604 -8514.0691  31.4%  2300 2305s
 10199  2120 -11940.813   31  207 -12412.604 -8792.0595  29.2%  2304 2343s
 10548  2166 -12263.856   29  349 -12412.604 -8959.8773  27.8%  2309 2382s
 10972  2190     cutoff   27      -12412.604 -9153.4214  26.3%  2302 2423s
 11479  2221 -12101.037   32  502 -12412.604 -9387.1477  24.4%  2280 2470s
 11986  2211     cutoff   29      -12412.604 -9642.7546  22.3%  2269 2512s
 12450  2168     cutoff   29      -12412.604 -9763.5542  21.3%  2264 2553s
 13057  2063     cutoff   39      -12412.604 -9969.2051  19.7%  2239 2599s
 13659  1910 -11597.036   32  216 -12412.604 -10155.187  18.2%  2222 2647s
 14355  1592 -12388.373   28  282 -12412.604 -10367.015  16.5%  2193 2696s
 15116  1024 infeasible   29      -12412.604 -10615.625  14.5%  2162 2741s
H15139  1024                    -12288.64800 -10615.625  13.6%  2161 2741s
H15290  1024                    -12272.46586 -10615.625  13.5%  2147 2741s
H15322  1024                    -12074.14052 -10664.261  11.7%  2145 2741s
 16143     0     cutoff   39      -12074.141 -10907.147  9.67%  2092 2763s
*16681     0              42    -12047.36942 -11031.178  8.43%  2035 2763s

Cutting planes:
  Learned: 2
  MIR: 551
  Mixing: 3
  Flow cover: 1309
  RLT: 18
  Relax-and-lift: 93

Explored 17352 nodes (34305493 simplex iterations) in 2763.51 seconds (5051.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12047.4 -12074.1 -12272.5 ... -12927.2
No other solutions better than -12047.4

Optimal solution found (tolerance 1.00e-04)
Best objective -1.204736942210e+04, best bound -1.204736942210e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2763.54s
  Master Objective (UB) = -12047.37, θ = 132690.54
  Upper Bound (UB) = -12047.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 132690.54
  [DEBUG]   ✓ Scenario 0: θ = 132690.54 ≤ Q = 132690.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 132690.54 ≤ Q = 132690.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 132690.54 ≤ Q = 132690.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 132690.54 ≤ Q = 132690.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 132690.54 ≤ Q = 132690.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 132690.54 ≤ Q = 132690.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x576252ec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x576252ec
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-14, 2e+02]
Found heuristic solution: objective 1.148025e+13
Presolve removed 2606 rows and 1897 columns
Presolve time: 0.01s
Presolved: 487 rows, 492 columns, 1374 nonzeros
Found heuristic solution: objective 5045008.3496
Variable types: 333 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5044691.5639

Root relaxation: objective -1.525399e+05, 233 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152539.93    0  124 5044691.56 -152539.93   103%     -    0s
H    0     0                    -125314.4468 -152539.93  21.7%     -    0s
H    0     0                    -125631.2326 -152539.93  21.4%     -    0s
H    0     0                    -125938.0115 -152287.90  20.9%     -    0s
     0     0 -134883.57    0   79 -125938.01 -134883.57  7.10%     -    0s
H    0     0                    -132439.9797 -134854.15  1.82%     -    0s
     0     0 -134048.21    0   73 -132439.98 -134048.21  1.21%     -    0s
H    0     0                    -132609.0591 -134030.49  1.07%     -    0s
H    0     0                    -132690.3501 -134030.49  1.01%     -    0s
     0     0 -133992.19    0   71 -132690.35 -133992.19  0.98%     -    0s
H    0     0                    -132941.4640 -133992.19  0.79%     -    0s
H    0     0                    -132959.1991 -133641.33  0.51%     -    0s
     0     0 -133641.33    0   45 -132959.20 -133641.33  0.51%     -    0s
     0     0 -133522.37    0   44 -132959.20 -133522.37  0.42%     -    0s
     0     0 -133516.44    0   38 -132959.20 -133516.44  0.42%     -    0s
     0     0 -133422.47    0   33 -132959.20 -133422.47  0.35%     -    0s
H    0     0                    -133082.3077 -133414.05  0.25%     -    0s
H    0     0                    -133303.4115 -133414.05  0.08%     -    0s
H    0     0                    -133327.8773 -133414.05  0.06%     -    0s
     0     0 -133407.72    0   31 -133327.88 -133407.72  0.06%     -    0s
     0     0 -133372.88    0    3 -133327.88 -133372.88  0.03%     -    0s
     0     0 -133372.88    0   28 -133327.88 -133372.88  0.03%     -    0s
     0     0 -133372.88    0   28 -133327.88 -133372.88  0.03%     -    0s
H    0     0                    -133341.0273 -133372.88  0.02%     -    0s
     0     0          -    0      -133341.03 -133353.39  0.01%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 23
  Flow cover: 5

Explored 1 nodes (668 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -133341 -133328 -133303 ... -132440

Optimal solution found (tolerance 1.00e-04)
Best objective -1.333410273031e+05, best bound -1.333533879930e+05, gap 0.0093%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 120820.98
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133341.03
  [DEBUG]   S×d_nominal = 254162.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254162.01 + -133341.03 = 120820.98
  [DEBUG]   Current θ from Master = 132690.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11869.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23916.93
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 4778.4242, Absolute Gap = 4778.4242, Relative Gap = 0.396636
  Not converged yet (gap = 4778.42 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xa544a021
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 2.02s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -188195.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21400   -9.4887759e+04   0.000000e+00   1.645753e+08      5s
   33152   -2.5163347e+04   0.000000e+00   3.042671e+07     10s
   40998   -1.6250466e+04   0.000000e+00   5.676647e+07     15s
   48981   -1.0410055e+04   0.000000e+00   9.067968e+06     20s
   56852   -4.8754050e+03   0.000000e+00   4.933309e+08     25s
   63139   -3.3765600e+03   0.000000e+00   2.112542e+07     30s
   68661   -2.5388427e+03   0.000000e+00   9.517322e+06     35s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 9.482333e+03, 47312 iterations, 37.01 seconds (49.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 9482.33263    0  181 -188195.78 9482.33263   105%     -   40s
H    0     0                    -182265.3332 9482.33263   105%     -   40s
H    0     0                    -148245.2126 9482.33263   106%     -   40s
H    0     0                    -130099.6483 9482.33263   107%     -   40s
H    0     0                    -111978.6887 9482.33263   108%     -   40s
H    0     0                    -111612.4631 9482.33263   108%     -   40s
H    0     0                    -72058.78401 9482.33263   113%     -   40s
H    0     0                    -28452.01817 9482.33263   133%     -   40s
H    0     0                    -23277.78450 9482.33263   141%     -   40s
H    0     0                    -23276.97080 9482.33263   141%     -   40s
H    0     0                    -23116.71795 9482.33263   141%     -   40s
H    0     0                    -22751.34705 9482.33263   142%     -   40s
H    0     0                    -22435.83165 9482.33263   142%     -   42s
H    0     0                    -22389.02348 9482.33263   142%     -   42s
     0     0 5518.14679    0  363 -22389.023 5518.14679   125%     -   57s
H    0     0                    -21857.04276 5518.14679   125%     -   57s
H    0     0                    -21628.74954 5518.14679   126%     -   57s
     0     0 5342.15304    0  358 -21628.750 5342.15304   125%     -   60s
     0     0 5342.15304    0  352 -21628.750 5342.15304   125%     -   63s
     0     0 5341.19895    0  358 -21628.750 5341.19895   125%     -   64s
     0     0 5341.19835    0  358 -21628.750 5341.19835   125%     -   64s
     0     0 2461.75249    0  389 -21628.750 2461.75249   111%     -   79s
H    0     0                    -20763.40759 2461.65908   112%     -   79s
     0     0 1742.44713    0  372 -20763.408 1742.44713   108%     -   88s
     0     0 1600.87416    0  403 -20763.408 1600.87416   108%     -   92s
     0     0 1576.06201    0  400 -20763.408 1576.06201   108%     -   96s
     0     0 1542.82993    0  386 -20763.408 1542.82993   107%     -  100s
     0     0 1480.45467    0  390 -20763.408 1480.45467   107%     -  103s
     0     0 1461.01252    0  398 -20763.408 1461.01252   107%     -  105s
     0     0 1412.12662    0  397 -20763.408 1412.12662   107%     -  107s
     0     0 1400.38645    0  395 -20763.408 1400.38645   107%     -  108s
     0     0 1399.39368    0  403 -20763.408 1399.39368   107%     -  108s
     0     0 1399.12808    0  397 -20763.408 1399.12808   107%     -  108s
H    0     0                    -20673.97559 1399.12808   107%     -  117s
H    0     0                    -20592.62793 1399.12808   107%     -  117s
H    0     0                    -20537.39445 1399.12808   107%     -  117s
H    0     0                    -18633.56495 -334.10676  98.2%     -  129s
H    0     0                    -18207.99723 -334.10676  98.2%     -  129s
H    0     0                    -17995.39267 -334.10676  98.1%     -  129s
H    0     0                    -17372.70646 -334.10676  98.1%     -  129s
H    0     0                    -17059.60251 -334.10676  98.0%     -  129s
H    0     0                    -16996.70601 -334.10676  98.0%     -  129s
     0     0 -334.10676    0  501 -16996.706 -334.10676  98.0%     -  129s
     0     0 -745.65266    0  515 -16996.706 -745.65266  95.6%     -  137s
     0     0 -933.25299    0  512 -16996.706 -933.25299  94.5%     -  143s
     0     0 -1058.3235    0  513 -16996.706 -1058.3235  93.8%     -  150s
     0     0 -1184.5149    0  478 -16996.706 -1184.5149  93.0%     -  154s
     0     0 -1212.5978    0  470 -16996.706 -1212.5978  92.9%     -  156s
     0     0 -1229.7775    0  479 -16996.706 -1229.7775  92.8%     -  157s
     0     0 -1246.0013    0  477 -16996.706 -1246.0013  92.7%     -  158s
     0     0 -1252.4396    0  488 -16996.706 -1252.4396  92.6%     -  159s
     0     0 -1255.1298    0  490 -16996.706 -1255.1298  92.6%     -  160s
     0     0 -1256.1021    0  488 -16996.706 -1256.1021  92.6%     -  160s
H    0     0                    -16945.33294 -1256.1021  92.6%     -  167s
H    0     0                    -16808.94874 -1256.1021  92.5%     -  167s
H    0     0                    -16800.32527 -1256.1021  92.5%     -  167s
H    0     0                    -16795.81792 -1256.1021  92.5%     -  167s
     0     0 -2023.5309    0  501 -16795.818 -2023.5309  88.0%     -  178s
     0     0 -2106.4176    0  510 -16795.818 -2106.4176  87.5%     -  183s
     0     0 -2152.1815    0  569 -16795.818 -2152.1815  87.2%     -  185s
     0     0 -2168.6942    0  567 -16795.818 -2168.6942  87.1%     -  187s
     0     0 -2184.9996    0  571 -16795.818 -2184.9996  87.0%     -  188s
     0     0 -2195.2573    0  521 -16795.818 -2195.2573  86.9%     -  189s
     0     0 -2199.7425    0  567 -16795.818 -2199.7425  86.9%     -  190s
     0     0 -2206.2147    0  571 -16795.818 -2206.2147  86.9%     -  191s
     0     0 -2211.9843    0  570 -16795.818 -2211.9843  86.8%     -  191s
     0     0 -2213.3144    0  571 -16795.818 -2213.3144  86.8%     -  192s
     0     0 -2364.7396    0  560 -16795.818 -2364.7396  85.9%     -  198s
H    0     0                    -16556.86774 -2365.6998  85.7%     -  198s
H    0     0                    -16529.09725 -2365.6998  85.7%     -  198s
H    0     0                    -14033.98740 -2403.9334  82.9%     -  200s
     0     0 -2403.9334    0  558 -14033.987 -2403.9334  82.9%     -  200s
     0     0 -2425.0480    0  557 -14033.987 -2425.0480  82.7%     -  202s
     0     0 -2429.7473    0  565 -14033.987 -2429.7473  82.7%     -  203s
     0     0 -2430.7674    0  568 -14033.987 -2430.7674  82.7%     -  203s
H    0     0                    -14030.68419 -2480.8579  82.3%     -  207s
     0     0 -2480.8579    0  485 -14030.684 -2480.8579  82.3%     -  207s
H    0     0                    -13882.60191 -2481.8580  82.1%     -  210s
     0     0 -2508.3826    0  495 -13882.602 -2508.3826  81.9%     -  213s
     0     0 -2518.9726    0  502 -13882.602 -2518.9726  81.9%     -  215s
     0     0 -2522.0142    0  514 -13882.602 -2522.0142  81.8%     -  215s
     0     0 -2524.6002    0  513 -13882.602 -2524.6002  81.8%     -  216s
     0     0 -2524.8851    0  515 -13882.602 -2524.8851  81.8%     -  216s
     0     0 -2544.0846    0  489 -13882.602 -2544.0846  81.7%     -  219s
H    0     0                    -13753.62561 -2544.5136  81.5%     -  220s
     0     0 -2547.9224    0  487 -13753.626 -2547.9224  81.5%     -  221s
     0     0 -2549.9969    0  499 -13753.626 -2549.9969  81.5%     -  222s
     0     0 -2550.8105    0  554 -13753.626 -2550.8105  81.5%     -  223s
     0     0 -2568.3327    0  564 -13753.626 -2568.3327  81.3%     -  225s
H    0     0                    -13544.01417 -2571.4970  81.0%     -  227s
H    0     0                    -13506.04071 -2571.4970  81.0%     -  227s
     0     0 -2571.4970    0  521 -13506.041 -2571.4970  81.0%     -  228s
     0     0 -2574.1168    0  528 -13506.041 -2574.1168  80.9%     -  228s
     0     0 -2574.3050    0  527 -13506.041 -2574.3050  80.9%     -  229s
     0     0 -2592.3281    0  517 -13506.041 -2592.3281  80.8%     -  232s
     0     0 -2594.6621    0  519 -13506.041 -2594.6621  80.8%     -  233s
     0     0 -2595.2433    0  521 -13506.041 -2595.2433  80.8%     -  234s
     0     0 -2601.5030    0  518 -13506.041 -2601.5030  80.7%     -  236s
H    0     0                    -13417.08254 -2602.7590  80.6%     -  243s
     0     0 -2603.1908    0  520 -13417.083 -2603.1908  80.6%     -  244s
     0     0 -2603.9425    0  524 -13417.083 -2603.9425  80.6%     -  244s
     0     0 -2607.6100    0  584 -13417.083 -2607.6100  80.6%     -  247s
     0     0 -2609.6187    0  534 -13417.083 -2609.6187  80.6%     -  248s
     0     0 -2609.8629    0  589 -13417.083 -2609.8629  80.5%     -  249s
     0     0 -2614.8374    0  572 -13417.083 -2614.8374  80.5%     -  252s
     0     0 -2614.8555    0  572 -13417.083 -2614.8555  80.5%     -  253s
H    0     0                    -13384.50992 -2615.2293  80.5%     -  291s
     0     2 -2615.2293    0  572 -13384.510 -2615.2293  80.5%     -  293s
     1     4 -2720.8570    1  501 -13384.510 -2615.2293  80.5%  3653  298s
     3     8 -2801.8812    2  552 -13384.510 -2721.9266  79.7%  4025  306s
     7    16 -2993.7927    3  507 -13384.510 -2801.8920  79.1%  5573  314s
    15    32 -3166.7993    4  517 -13384.510 -2994.2205  77.6%  5898  326s
    31    44 -4248.6511    5  429 -13384.510 -3167.1208  76.3%  9703  348s
H   47    74                    -13153.03660 -3167.1208  75.9%  8594  369s
H   51    74                    -13142.37981 -3167.1208  75.9%  8185  369s
H   52    74                    -13116.94766 -3167.1208  75.9%  8088  369s
H   54    74                    -13073.59456 -3167.1208  75.8%  7890  369s
H   57    74                    -13069.98704 -3167.1208  75.8%  7658  369s
    77   157 -4284.4608    7  514 -13069.987 -3167.1208  75.8%  7189  404s
   164   270 -4579.3810    9  344 -13069.987 -3167.1208  75.8%  4720  419s
   287   358 -4488.7184   11  499 -13069.987 -3167.1208  75.8%  3786  431s
   381   426 -4675.6251   10  393 -13069.987 -3167.1208  75.8%  3341  442s
   461   486 -4545.2158   12  464 -13069.987 -3167.1208  75.8%  3158  452s
H  533   519                    -13015.12024 -3167.1208  75.7%  3023  463s
   570   572 -4796.5684   16  511 -13015.120 -3167.1208  75.7%  3013  474s
   627   612 -4779.5626   16  514 -13015.120 -3212.6174  75.3%  2985  486s
   677   659 -5903.1617   16  548 -13015.120 -3212.6174  75.3%  3143  498s
H  682   659                    -13006.49722 -3212.6174  75.3%  3137  498s
   740   713 -5567.7293   17  547 -13006.497 -3212.6174  75.3%  3119  508s
H  743   713                    -12987.10061 -3212.6174  75.3%  3114  508s
   802   755 -5310.4947   17  402 -12987.101 -3212.6174  75.3%  3054  522s
   866   798 -5614.2489   18  354 -12987.101 -3351.6196  74.2%  3002  535s
H  903   798                    -12934.46511 -3351.6196  74.1%  2977  535s
   921   854 -5846.3131   18  529 -12934.465 -3351.6196  74.1%  2982  546s
   993   886 -6214.9868   18  542 -12934.465 -3351.6196  74.1%  2926  557s
  1047   926 -7679.2764   19  398 -12934.465 -3596.1583  72.2%  2879  571s
  1123   992 -6070.1963   19  338 -12934.465 -3603.6637  72.1%  2816  588s
  1205  1040 -6148.3676   20  351 -12934.465 -3603.6637  72.1%  2769  603s
  1301  1088 -6411.5920   22  312 -12934.465 -3603.6637  72.1%  2698  617s
  1395  1157 -6665.1951   25  253 -12934.465 -3603.6637  72.1%  2674  632s
  1489  1208 -6846.7111   28  366 -12934.465 -3603.6637  72.1%  2643  647s
  1570  1265 -8058.8936   29  310 -12934.465 -3603.6637  72.1%  2664  662s
  1675  1337 -9031.1648   29  351 -12934.465 -3603.6637  72.1%  2645  678s
  1799  1367 -7948.2076   29  304 -12934.465 -3789.4678  70.7%  2617  689s
H 1802  1367                    -12882.51365 -3789.4678  70.6%  2618  689s
  1845  1464 -9067.9681   27  135 -12882.514 -4004.5919  68.9%  2641  707s
  1984  1502 -8123.7123   30  316 -12882.514 -4004.5919  68.9%  2589  723s
  2040  1532 -8108.8595   30  304 -12882.514 -4004.5919  68.9%  2578  739s
  2115  1571 -8115.7209   30  301 -12882.514 -4004.5919  68.9%  2567  758s
  2213  1593 -8180.9509   32  303 -12882.514 -4018.7736  68.8%  2563  773s
H 2243  1593                    -12804.85031 -4037.9375  68.5%  2580  773s
  2253  1658 -8310.4823   32  307 -12804.850 -4037.9375  68.5%  2583  792s
  2406  1750 -9052.8601   36  271 -12804.850 -4140.1682  67.7%  2553  814s
  2577  1852 -9944.1687   42  237 -12804.850 -4140.1682  67.7%  2520  835s
  2731  1964 -10959.140   46   82 -12804.850 -4156.5506  67.5%  2499  856s
  2880  2043 -10535.836   50  183 -12804.850 -4236.6335  66.9%  2481  878s
  3063  2168     cutoff   56      -12804.850 -4236.6335  66.9%  2461  902s
  3238  2243     cutoff   62      -12804.850 -4356.1085  66.0%  2450  922s
  3381  2306 -4929.8970   11  573 -12804.850 -4356.1085  66.0%  2425  942s
  3519  2400 -5224.5808   12  519 -12804.850 -4356.1085  66.0%  2423  968s
  3667  2511 -5507.9375   13  372 -12804.850 -4373.8298  65.8%  2438  997s
  3816  2545 -6823.6688   16  371 -12804.850 -4373.8298  65.8%  2460 1022s
H 3818  2543                    -12725.29940 -4373.8298  65.6%  2459 1022s
  3894  2651 -7248.6564   18  336 -12725.299 -4412.5173  65.3%  2481 1051s
  4071  2652 -11867.919   17  572 -12725.299 -4462.2941  64.9%  2495 1128s
  4073  2653 -12481.786   30  181 -12725.299 -4462.2941  64.9%  2494 1180s
  4074  2654 -5648.1260    9  422 -12725.299 -4462.2941  64.9%  2493 1210s
  4075  2655 -10410.298   25  447 -12725.299 -4462.2941  64.9%  2493 1236s
  4076  2655 -9647.5610   21  519 -12725.299 -4462.2941  64.9%  2492 1256s
  4077  2656 -11319.233   43  528 -12725.299 -4462.2941  64.9%  2491 1268s
  4078  2657 -7263.7236   17  540 -12725.299 -4462.2941  64.9%  2491 1279s
  4079  2657 -11923.512   38  547 -12725.299 -4462.2941  64.9%  2490 1288s
  4080  2658 -8054.1819   17  520 -12725.299 -4462.2941  64.9%  2489 1294s
  4081  2659 -7239.9237   20  497 -12725.299 -4462.2941  64.9%  2489 1297s
  4082  2659 -7131.8742   27  566 -12725.299 -4462.2941  64.9%  2488 1301s
  4084  2661 -7504.3656   11  486 -12725.299 -4462.2941  64.9%  2487 1307s
  4085  2661 -8642.6827   30  540 -12725.299 -4462.2941  64.9%  2486 1311s
  4086  2662 -5142.9565   18  574 -12725.299 -4462.2941  64.9%  2486 1315s
  4087  2663 -5837.4275    7  504 -12725.299 -4462.2941  64.9%  2485 1323s
  4088  2663 -12228.393   17  502 -12725.299 -4462.2941  64.9%  2485 1325s
  4090  2665 -6923.3050   18  489 -12725.299 -4462.2941  64.9%  2483 1336s
  4092  2666 -5182.8023    7  509 -12725.299 -4462.2941  64.9%  2482 1341s
  4093  2667 -9701.0213   40  538 -12725.299 -4462.2941  64.9%  2482 1349s
  4094  2667 -5844.4481    7  533 -12725.299 -4462.2941  64.9%  2481 1351s
  4096  2669 -5493.8726   14  559 -12725.299 -4462.2941  64.9%  2480 1361s
  4099  2671 -6967.8473   16  510 -12725.299 -4462.2941  64.9%  2478 1367s
  4100  2671 -5922.9961   21  519 -12725.299 -4462.2941  64.9%  2477 1373s
  4101  2672 -12411.667   32  607 -12725.299 -4462.2941  64.9%  2477 1375s
  4103  2673 -7733.0055   21  546 -12725.299 -4462.2941  64.9%  2475 1383s
  4104  2674 -12097.421   63  451 -12725.299 -4462.2941  64.9%  2475 1386s
  4105  2675 -11819.020   40  558 -12725.299 -4462.2941  64.9%  2474 1392s
  4106  2675 -11082.721   38  500 -12725.299 -4462.2941  64.9%  2474 1395s
  4107  2676 -5338.9411   18  513 -12725.299 -4462.2941  64.9%  2473 1402s
  4109  2677 -4967.8220   17  456 -12725.299 -4462.2941  64.9%  2472 1408s
  4110  2678 -8284.5864   40  456 -12725.299 -4462.2941  64.9%  2471 1455s
  4111  2679 -6898.0830   21  456 -12725.299 -4462.2941  64.9%  2471 1480s
  4112  2682 -4462.2941   16  437 -12725.299 -4462.2941  64.9%  2526 1499s
  4114  2686 -4462.2941   17  434 -12725.299 -4462.2941  64.9%  2527 1513s
  4118  2692 -4462.2941   18  535 -12725.299 -4462.2941  64.9%  2530 1533s
  4126  2706 -4462.2941   19  543 -12725.299 -4462.2941  64.9%  2534 1550s
  4142  2716 -4462.2941   20  457 -12725.299 -4462.2941  64.9%  2574 1582s
  4158  2743 -6278.4052   21  595 -12725.299 -4462.2941  64.9%  2587 1605s
  4190  2808 -6426.5210   22  582 -12725.299 -4462.2941  64.9%  2639 1630s
  4270  2835 -6478.9241   23  514 -12725.299 -4462.2941  64.9%  2683 1648s
  4345  2846 -6961.8862   24  310 -12725.299 -4462.2941  64.9%  2704 1667s
  4428  2854 -7872.8531   26  444 -12725.299 -4462.2941  64.9%  2705 1682s
  4484  2892 -9252.9698   27  393 -12725.299 -4462.2941  64.9%  2705 1698s
  4570  2890 -8422.8957   25  394 -12725.299 -4462.2941  64.9%  2693 1714s
  4638  2899 -8481.8144   27  457 -12725.299 -4462.2941  64.9%  2681 1730s
  4721  2894 -8746.3862   26  485 -12725.299 -4462.2941  64.9%  2673 1746s
  4763  2917 -9431.8098   27  413 -12725.299 -4462.2941  64.9%  2669 1760s
H 4799  2770                    -12714.68317 -4462.2941  64.9%  2667 1760s
  4819  2810 -10975.488   28  433 -12714.683 -4462.2941  64.9%  2662 1780s
  4904  2816 -10311.886   28  365 -12714.683 -4462.2941  64.9%  2649 1796s
  4992  2824 -10631.233   30  406 -12714.683 -4462.2941  64.9%  2635 1812s
  5061  2846 -11959.651   32  250 -12714.683 -4462.2941  64.9%  2628 1828s
  5143  2851 -12204.500   33  175 -12714.683 -4462.2941  64.9%  2617 1843s
  5212  2869 -12466.511   35  248 -12714.683 -4462.2941  64.9%  2606 1857s
  5295  2884 -8973.7494   23  333 -12714.683 -4462.2941  64.9%  2600 1871s
  5375  2902 -9388.5904   24  259 -12714.683 -4462.2941  64.9%  2592 1888s
  5473  2894 -10900.125   26  138 -12714.683 -4462.2941  64.9%  2580 1904s
  5550  2908 -11324.060   28  226 -12714.683 -4462.2941  64.9%  2576 1922s
  5630  2947 -11160.185   27  225 -12714.683 -4462.2941  64.9%  2577 1939s
  5715  2971     cutoff   28      -12714.683 -4462.2941  64.9%  2580 1957s
  5819  2994 -12252.021   33  221 -12714.683 -4462.2941  64.9%  2575 1976s
  5926  3003 -12594.027   36  225 -12714.683 -4462.2941  64.9%  2565 1996s
  6047  3002 -7594.9194   21  276 -12714.683 -4913.2320  61.4%  2561 2014s
  6083  2990 -11139.623   26  527 -12714.683 -4913.2320  61.4%  2566 2015s
  6118  3032 -8817.9298   23  242 -12714.683 -4913.2320  61.4%  2562 2033s
  6224  3045 -9359.6668   25  412 -12714.683 -4913.2320  61.4%  2560 2052s
  6340  3045     cutoff   26      -12714.683 -4913.2320  61.4%  2543 2073s
  6441  3060     cutoff   25      -12714.683 -4913.2320  61.4%  2548 2096s
  6554  3088 -11098.953   25  214 -12714.683 -5478.3469  56.9%  2550 2118s
  6656  3121 -11320.280   26  361 -12714.683 -5562.3926  56.3%  2554 2141s
  6780  3145 -11731.957   28  147 -12714.683 -5562.3926  56.3%  2552 2164s
  6955  3133     cutoff   33      -12714.683 -5562.3926  56.3%  2538 2189s
  7100  3142 -9494.9650   25  468 -12714.683 -6046.5925  52.4%  2544 2217s
  7193  3165 -11719.567   27  501 -12714.683 -6046.5925  52.4%  2575 2244s
  7322  3157     cutoff   30      -12714.683 -6046.5925  52.4%  2586 2271s
  7492  3158     cutoff   25      -12714.683 -6046.5925  52.4%  2595 2300s
  7678  3143     cutoff   25      -12714.683 -6876.5714  45.9%  2591 2335s
  7845  3148 -9976.9873   24  416 -12714.683 -6946.8341  45.4%  2602 2366s
  7997  3147 -11191.487   26  279 -12714.683 -6946.8341  45.4%  2602 2401s
  8187  3101 -12011.245   27  356 -12714.683 -7495.2573  41.1%  2611 2430s
H 8197  2953                    -12636.13867 -7495.2573  40.7%  2612 2430s
  8234  3025 -12056.243   28  164 -12636.139 -7626.5398  39.6%  2616 2468s
  8467  3073 -9187.7927   24  436 -12636.139 -7626.5398  39.6%  2620 2502s
  8722  3150 -10022.887   29  256 -12636.139 -7647.7255  39.5%  2615 2539s
  9073  3111 -12611.247   56  110 -12636.139 -7691.1178  39.1%  2591 2578s
  9419  3043 -10483.486   31  348 -12636.139 -7691.1178  39.1%  2575 2616s
  9682  3048 infeasible   28      -12636.139 -8203.8395  35.1%  2576 2655s
 10036  3040 -11969.498   29  126 -12636.139 -8362.9963  33.8%  2561 2696s
 10381  3061 -12543.585   27  228 -12636.139 -8449.7158  33.1%  2552 2736s
 10828  3047     cutoff   25      -12636.139 -8489.7624  32.8%  2523 2779s
 11358  2970 -12171.588   36  205 -12636.139 -8767.4254  30.6%  2484 2823s
 11782  3038     cutoff   27      -12636.139 -8918.3507  29.4%  2474 2869s
H12108  3028                    -12601.68909 -9032.8955  28.3%  2468 2869s
 12184  3077 -11851.182   30  432 -12601.689 -9032.8955  28.3%  2467 2923s
H12343  3015                    -12462.85114 -9061.8170  27.3%  2463 2923s
 12620  3033 -11546.675   29  414 -12462.851 -9166.5376  26.4%  2459 2975s
H12632  3013                    -12426.09741 -9166.5376  26.2%  2460 2975s
 13013  3018     cutoff   32      -12426.097 -9215.0464  25.8%  2463 3027s
H13027  3005                    -12396.25389 -9215.0464  25.7%  2462 3027s
 13467  2991 -11589.146   26  446 -12396.254 -9426.5349  24.0%  2455 3079s
 13928  3002     cutoff   27      -12396.254 -9451.5316  23.8%  2443 3140s
 14493  3055 -10289.838   33  117 -12396.254 -9637.5864  22.3%  2425 3196s
 15097  3050 -12115.720   32  341 -12396.254 -9706.4579  21.7%  2411 3252s
 15688  3016 -10987.408   37  364 -12396.254 -9881.1433  20.3%  2389 3305s
 15842  2938 -11196.845   38  344 -12396.254 -9937.4472  19.8%  2391 3365s
 16391  2708 -11352.177   52   98 -12396.254 -10007.344  19.3%  2381 3436s
 17167  2490     cutoff   32      -12396.254 -10258.511  17.2%  2356 3502s
 18167  2172     cutoff   31      -12396.254 -10498.610  15.3%  2307 3574s
 19340  1772 -12269.213   42  212 -12396.254 -10812.250  12.8%  2242 3600s

Cutting planes:
  Learned: 3
  MIR: 689
  Mixing: 2
  Flow cover: 1591
  RLT: 17
  Relax-and-lift: 140

Explored 20193 nodes (44212113 simplex iterations) in 3600.05 seconds (6740.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12396.3 -12426.1 -12462.9 ... -12934.5

Time limit reached
Best objective -1.239625389109e+04, best bound -1.103741118337e+04, gap 10.9617%
  WARNING: Time limit reached. Using best solution found (gap: 10.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -12396.25, θ = 132256.34
  Upper Bound (UB) = -12396.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 132256.34
  [DEBUG]   ✓ Scenario 0: θ = 132256.34 ≤ Q = 132256.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 132256.34 ≤ Q = 132256.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 132256.34 ≤ Q = 132256.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 132256.34 ≤ Q = 132256.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 132256.34 ≤ Q = 132256.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 132256.34 ≤ Q = 132256.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 132256.34 ≤ Q = 132256.34 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6fd399cf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6fd399cf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.154119e+13
Presolve removed 2606 rows and 1897 columns
Presolve time: 0.01s
Presolved: 487 rows, 492 columns, 1374 nonzeros
Found heuristic solution: objective 5070507.7191
Variable types: 333 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5070190.9333

Root relaxation: objective -1.552371e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155237.12    0  126 5070190.93 -155237.12   103%     -    0s
H    0     0                    -126366.1137 -155237.12  22.8%     -    0s
H    0     0                    -126653.3531 -154977.08  22.4%     -    0s
     0     0 -133604.52    0   99 -126653.35 -133604.52  5.49%     -    0s
H    0     0                    -130248.9274 -133482.55  2.48%     -    0s
     0     0 -133178.60    0   98 -130248.93 -133178.60  2.25%     -    0s
     0     0 -132518.07    0   75 -130248.93 -132518.07  1.74%     -    0s
H    0     0                    -131226.6356 -132502.62  0.97%     -    0s
     0     0 -132383.01    0   75 -131226.64 -132383.01  0.88%     -    0s
     0     0 -132273.99    0   75 -131226.64 -132273.99  0.80%     -    0s
H    0     0                    -131252.1565 -132266.16  0.77%     -    0s
     0     0 -132266.16    0   73 -131252.16 -132266.16  0.77%     -    0s
     0     0 -132053.82    0   55 -131252.16 -132053.82  0.61%     -    0s
H    0     0                    -131349.9749 -132052.80  0.54%     -    0s
     0     0 -131970.92    0   66 -131349.97 -131970.92  0.47%     -    0s
     0     0 -131969.16    0   66 -131349.97 -131969.16  0.47%     -    0s
     0     0 -131931.68    0   72 -131349.97 -131931.68  0.44%     -    0s
     0     0 -131929.20    0   59 -131349.97 -131929.20  0.44%     -    0s
H    0     0                    -131359.0825 -131929.20  0.43%     -    0s
H    0     0                    -131612.9389 -131929.20  0.24%     -    0s
     0     2 -131929.20    0   59 -131612.94 -131929.20  0.24%     -    0s
H   48    50                    -131615.2838 -131773.97  0.12%  11.3    0s
H  129   140                    -131656.7577 -131754.92  0.07%   8.6    0s
*  157   140               8    -131683.0722 -131754.92  0.05%   7.9    0s
H  244   140                    -131706.4084 -131744.36  0.03%   6.6    0s
*  289     0              12    -131710.3422 -131729.20  0.01%   5.8    0s

Cutting planes:
  Gomory: 31
  Implied bound: 7
  MIR: 154
  Flow cover: 12
  RLT: 44
  Relax-and-lift: 1

Explored 346 nodes (2350 simplex iterations) in 0.17 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -131710 -131706 -131683 ... -131227
No other solutions better than -131710

Optimal solution found (tolerance 1.00e-04)
Best objective -1.317103421789e+05, best bound -1.317103421789e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 121901.98
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131710.34
  [DEBUG]   S×d_nominal = 253612.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253612.32 + -131710.34 = 121901.98
  [DEBUG]   Current θ from Master = 132256.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10354.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22750.62
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 4429.5397, Absolute Gap = 4429.5397, Relative Gap = 0.357329
  Not converged yet (gap = 4429.54 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x03437895
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 2.99s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -188195.7828

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   18111   -2.2794427e+05   0.000000e+00   7.112362e+06      5s
   35501   -2.1084949e+04   0.000000e+00   1.726434e+07     10s
   44131   -9.8755523e+03   0.000000e+00   1.441990e+06     15s
   50905   -3.8315773e+03   0.000000e+00   1.639944e+06     20s
   57532    1.0593252e+03   0.000000e+00   1.549641e+08     25s
   63775    3.6024623e+03   0.000000e+00   5.894621e+06     30s
   69877    5.5806267e+03   0.000000e+00   1.229570e+06     35s
   75562    6.5453956e+03   0.000000e+00   8.684366e+06     40s
   81154    7.6576095e+03   0.000000e+00   2.067129e+06     45s
   86720    7.9785504e+03   0.000000e+00   1.377132e+05     50s
   92529    8.6621309e+03   0.000000e+00   1.711659e+05     55s
   96999    8.7102262e+03   0.000000e+00   2.274048e+05     60s
  102964    9.3239080e+03   0.000000e+00   1.281625e+06     65s
  108328    9.4604798e+03   0.000000e+00   2.167674e+05     70s
  113245    9.4904155e+03   0.000000e+00   6.287401e+04     75s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 9.482333e+03, 92288 iterations, 74.89 seconds (88.55 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 9482.33263    0  181 -188195.78 9482.33263   105%     -   79s
H    0     0                    -173308.2230 9482.33263   105%     -   79s
H    0     0                    -132198.9000 9482.33263   107%     -   79s
H    0     0                    -130831.1956 9482.33263   107%     -   79s
H    0     0                    -68953.43011 9482.33263   114%     -   79s
H    0     0                    -30249.43504 9482.33263   131%     -   79s
H    0     0                    -29138.20589 9482.33263   133%     -   79s
H    0     0                    -29091.24488 9482.33263   133%     -   79s
H    0     0                    -29090.51755 9482.33263   133%     -   79s
H    0     0                    -28262.16775 9482.33263   134%     -   81s
     0     0 5355.89706    0  377 -28262.168 5355.89706   119%     -  104s
H    0     0                    -27817.15817 5355.43039   119%     -  104s
H    0     0                    -27425.41410 5355.43039   120%     -  104s
H    0     0                    -27349.25359 5355.43039   120%     -  104s
H    0     0                    -27261.54438 5355.43039   120%     -  104s
     0     0 4857.10687    0  391 -27261.544 4857.10687   118%     -  114s
     0     0 4844.43537    0  392 -27261.544 4844.43537   118%     -  115s
     0     0 4839.70344    0  392 -27261.544 4839.70344   118%     -  115s
     0     0 4610.98508    0  383 -27261.544 4610.98508   117%     -  119s
     0     0 4610.63272    0  383 -27261.544 4610.63272   117%     -  120s
     0     0 2570.26860    0  302 -27261.544 2570.26860   109%     -  142s
H    0     0                    -22245.44679 2570.26860   112%     -  143s
     0     0 1907.13366    0  401 -22245.447 1907.13366   109%     -  155s
     0     0 1618.26893    0  413 -22245.447 1618.26893   107%     -  164s
     0     0 1530.59815    0  415 -22245.447 1530.59815   107%     -  170s
     0     0 1446.41643    0  365 -22245.447 1446.41643   107%     -  176s
     0     0 1354.34914    0  457 -22245.447 1354.34914   106%     -  182s
     0     0 1284.88795    0  379 -22245.447 1284.88795   106%     -  185s
     0     0 1246.45860    0  369 -22245.447 1246.45860   106%     -  188s
     0     0 1181.72755    0  374 -22245.447 1181.72755   105%     -  191s
     0     0 1175.38860    0  412 -22245.447 1175.38860   105%     -  192s
     0     0 1170.35443    0  371 -22245.447 1170.35443   105%     -  193s
     0     0 1169.06592    0  375 -22245.447 1169.06592   105%     -  193s
H    0     0                    -17720.70137 1168.16610   107%     -  194s
     0     0 1168.16610    0  374 -17720.701 1168.16610   107%     -  194s
     0     0 1168.04368    0  374 -17720.701 1168.04368   107%     -  194s
H    0     0                    -16954.49920 1168.04368   107%     -  207s
H    0     0                    -16739.13054 1168.04368   107%     -  207s
     0     0 -336.16888    0  446 -16739.131 -336.16888  98.0%     -  226s
H    0     0                    -16569.73000 -337.10836  98.0%     -  227s
H    0     0                    -16561.28385 -337.10836  98.0%     -  227s
     0     0 -765.40178    0  451 -16561.284 -765.40178  95.4%     -  238s
     0     0 -1022.2912    0  514 -16561.284 -1022.2912  93.8%     -  245s
     0     0 -1145.0759    0  531 -16561.284 -1145.0759  93.1%     -  251s
     0     0 -1189.1152    0  533 -16561.284 -1189.1152  92.8%     -  254s
     0     0 -1207.5601    0  519 -16561.284 -1207.5601  92.7%     -  255s
     0     0 -1259.5743    0  527 -16561.284 -1259.5743  92.4%     -  260s
     0     0 -1275.4629    0  531 -16561.284 -1275.4629  92.3%     -  262s
     0     0 -1279.4972    0  533 -16561.284 -1279.4972  92.3%     -  264s
     0     0 -1291.8984    0  528 -16561.284 -1291.8984  92.2%     -  265s
     0     0 -1293.1559    0  529 -16561.284 -1293.1559  92.2%     -  266s
     0     0 -1295.4613    0  530 -16561.284 -1295.4613  92.2%     -  266s
     0     0 -1296.0183    0  531 -16561.284 -1296.0183  92.2%     -  267s
     0     0 -2056.9247    0  580 -16561.284 -2056.9247  87.6%     -  290s
     0     0 -2241.0737    0  597 -16561.284 -2241.0737  86.5%     -  296s
     0     0 -2310.1156    0  593 -16561.284 -2310.1156  86.1%     -  301s
     0     0 -2340.7409    0  608 -16561.284 -2340.7409  85.9%     -  303s
     0     0 -2354.5293    0  560 -16561.284 -2354.5293  85.8%     -  306s
     0     0 -2383.3735    0  552 -16561.284 -2383.3735  85.6%     -  309s
H    0     0                    -16457.29828 -2396.5940  85.4%     -  311s
     0     0 -2396.5940    0  556 -16457.298 -2396.5940  85.4%     -  311s
H    0     0                    -14211.64679 -2403.2155  83.1%     -  312s
H    0     0                    -14163.29473 -2403.2155  83.0%     -  312s
     0     0 -2403.2155    0  561 -14163.295 -2403.2155  83.0%     -  312s
     0     0 -2404.0048    0  569 -14163.295 -2404.0048  83.0%     -  313s
H    0     0                    -14033.10493 -2483.9034  82.3%     -  318s
H    0     0                    -13876.25179 -2483.9034  82.1%     -  318s
     0     0 -2483.9034    0  527 -13876.252 -2483.9034  82.1%     -  318s
     0     0 -2492.7612    0  524 -13876.252 -2492.7612  82.0%     -  320s
     0     0 -2498.5973    0  574 -13876.252 -2498.5973  82.0%     -  322s
H    0     0                    -13741.68593 -2501.6837  81.8%     -  323s
     0     0 -2501.6837    0  571 -13741.686 -2501.6837  81.8%     -  323s
     0     0 -2503.8783    0  529 -13741.686 -2503.8783  81.8%     -  323s
     0     0 -2504.5555    0  534 -13741.686 -2504.5555  81.8%     -  323s
     0     0 -2535.2586    0  506 -13741.686 -2535.2586  81.6%     -  328s
H    0     0                    -13386.36277 -2535.2779  81.1%     -  332s
     0     0 -2540.4578    0  527 -13386.363 -2540.4578  81.0%     -  334s
     0     0 -2541.5786    0  529 -13386.363 -2541.5786  81.0%     -  335s
     0     0 -2581.3397    0  576 -13386.363 -2581.3397  80.7%     -  341s
     0     0 -2586.4377    0  586 -13386.363 -2586.4377  80.7%     -  342s
     0     0 -2588.0148    0  589 -13386.363 -2588.0148  80.7%     -  343s
     0     0 -2588.2455    0  589 -13386.363 -2588.2455  80.7%     -  343s
     0     0 -2604.6486    0  522 -13386.363 -2604.6486  80.5%     -  346s
H    0     0                    -13379.70058 -2605.1703  80.5%     -  348s
H    0     0                    -13343.69704 -2605.1703  80.5%     -  348s
H    0     0                    -13272.25837 -2605.1703  80.4%     -  348s
H    0     0                    -13253.16190 -2605.1703  80.3%     -  348s
H    0     0                    -13142.45469 -2605.1703  80.2%     -  348s
     0     0 -2606.1800    0  525 -13142.455 -2606.1800  80.2%     -  349s
     0     0 -2606.6639    0  528 -13142.455 -2606.6639  80.2%     -  350s
     0     0 -2612.6208    0  530 -13142.455 -2612.6208  80.1%     -  353s
     0     0 -2613.5238    0  522 -13142.455 -2613.5238  80.1%     -  354s
     0     0 -2614.7231    0  530 -13142.455 -2614.7231  80.1%     -  357s
H    0     0                    -13088.83198 -2615.1228  80.0%     -  362s
H    0     0                    -13085.93487 -2615.1228  80.0%     -  364s
     0     0 -2615.1228    0  530 -13085.935 -2615.1228  80.0%     -  365s
     0     0 -2617.2913    0  533 -13085.935 -2617.2913  80.0%     -  367s
     0     0 -2618.0911    0  533 -13085.935 -2618.0911  80.0%     -  369s
     0     2 -2618.0911    0  533 -13085.935 -2618.0911  80.0%     -  424s
     1     4 -2744.4851    1  535 -13085.935 -2618.0911  80.0%  3446  430s
     3     8 -2783.2925    2  527 -13085.935 -2744.8820  79.0%  3584  439s
     7    15 -2866.6751    3  525 -13085.935 -2783.3809  78.7%  4869  457s
    14    30 -3129.0460    4  516 -13085.935 -2821.0018  78.4%  6823  470s
    29    45 -4042.0617    5  397 -13085.935 -3129.0773  76.1%  7457  497s
    44    77 -5420.4070    6  355 -13085.935 -3129.0773  76.1%  9983  553s
H   49    77                    -13080.00120 -3129.0773  76.1%  9670  553s
H   50    77                    -13020.57796 -3129.0773  76.0%  9523  553s
H   56    77                    -12989.35972 -3129.0773  75.9%  9139  553s
H   61    77                    -12958.37576 -3129.0773  75.9%  8891  553s
    76   197 -5528.3176    7  271 -12958.376 -3503.8027  73.0%  9247  587s
   196   307 -5792.1165   11  324 -12958.376 -3503.8027  73.0%  5352  599s
   308   372 -6027.9564   16  312 -12958.376 -3503.8027  73.0%  4241  616s
   373   401 -7089.1879   18  204 -12958.376 -3503.8027  73.0%  4073  629s
   402   432 -7405.6131   19  191 -12958.376 -3503.8027  73.0%  4109  643s
H  431   432                    -12925.27955 -3503.8027  72.9%  4172  643s
   435   501 -7902.4165   20  245 -12925.280 -3503.8027  72.9%  4153  656s
   512   576 -8506.1358   22  203 -12925.280 -3503.8027  72.9%  4031  670s
   593   647 -9454.4524   24  217 -12925.280 -3503.8027  72.9%  3876  682s
   676   694 -9926.7957   25  216 -12925.280 -3503.8027  72.9%  3807  695s
   747   712     cutoff   26      -12925.280 -3686.0158  71.5%  3754  708s
H  754   712                    -12903.94795 -3686.0158  71.4%  3739  708s
   783   763 -8976.6563   13  204 -12903.948 -3686.0158  71.4%  3761  719s
   856   787 -9496.3400   14  222 -12903.948 -3686.0158  71.4%  3749  733s
   892   822 -9950.0112   15  205 -12903.948 -3686.0158  71.4%  3744  744s
   947   855 -9999.4768   16  200 -12903.948 -3686.0158  71.4%  3738  757s
  1020   897 -10217.709   17  193 -12903.948 -3686.0158  71.4%  3727  772s
  1090   941 -10159.982   16  178 -12903.948 -3822.3819  70.4%  3763  786s
  1166   970 -10747.202   17  180 -12903.948 -3822.3819  70.4%  3745  803s
  1245   995 -9863.3065   15  276 -12903.948 -3822.3819  70.4%  3736  816s
H 1268   995                    -12893.88330 -3822.3819  70.4%  3791  816s
  1282  1070 -10896.812   17  222 -12893.883 -3822.3819  70.4%  3800  830s
  1374  1132 -10578.369   18  171 -12893.883 -3822.3819  70.4%  3770  848s
  1488  1216 -11245.789   19  178 -12893.883 -3822.3819  70.4%  3709  865s
  1608  1285 -11176.722   24  151 -12893.883 -3822.3819  70.4%  3677  884s
  1726  1371 -11299.170   27  151 -12893.883 -3822.3819  70.4%  3641  901s
  1844  1392 -11491.517   31  159 -12893.883 -3822.3819  70.4%  3645  919s
H 1845  1392                    -12887.99629 -3822.3819  70.3%  3643  919s
  1885  1474 -11979.878   32  237 -12887.996 -3822.3819  70.3%  3682  937s
  2011  1576 -12250.975   34  195 -12887.996 -3822.3819  70.3%  3660  954s
  2178  1652 -12433.297   36  148 -12887.996 -3822.3819  70.3%  3572  973s
  2349  1719 -5870.0858   12  403 -12887.996 -3822.3819  70.3%  3490  993s
  2490  1822 -7046.0190   15  443 -12887.996 -3837.0187  70.2%  3484 1014s
  2643  1876 -7463.3572   16  448 -12887.996 -3837.0187  70.2%  3480 1034s
  2800  1943 -8912.1499   18  311 -12887.996 -3935.8638  69.5%  3466 1055s
  2915  1969 -9225.6829   19  378 -12887.996 -3935.8638  69.5%  3535 1075s
  2949  2014 -9206.5582   19  205 -12887.996 -3935.8638  69.5%  3576 1093s
H 2962  2012                    -12837.37734 -4241.9594  67.0%  3575 1093s
  3018  2099 -9541.2789   20  213 -12837.377 -4241.9594  67.0%  3594 1118s
  3170  2180 -10145.213   23  214 -12837.377 -4241.9594  67.0%  3641 1142s
  3319  2295     cutoff   23      -12837.377 -4608.8051  64.1%  3671 1168s
  3506  2449 -11002.726   27  248 -12837.377 -4975.3853  61.2%  3679 1192s
  3713  2578 -11478.473   34  245 -12837.377 -4975.3853  61.2%  3681 1216s
  3956  2602 -11931.594   46  221 -12837.377 -5015.3903  60.9%  3673 1242s
H 3988  2591                    -12763.70100 -5015.3903  60.7%  3709 1242s
  3997  2592 -12426.471   51  533 -12763.701 -5015.3903  60.7%  3716 1347s
  3999  2593 -8735.8861   18  181 -12763.701 -5015.3903  60.7%  3714 1416s
  4000  2594 -8606.8444   22  421 -12763.701 -5015.3903  60.7%  3713 1450s
  4001  2595 -11535.364   17  444 -12763.701 -5015.3903  60.7%  3712 1484s
  4002  2595 -11462.642   28  524 -12763.701 -5015.3903  60.7%  3711 1501s
  4003  2596 -12092.849   72  499 -12763.701 -5015.3903  60.7%  3710 1523s
  4004  2597 -12685.276   42  588 -12763.701 -5015.3903  60.7%  3709 1537s
  4005  2597 -10480.032   27  608 -12763.701 -5015.3903  60.7%  3709 1548s
  4006  2598 -11884.430   36  501 -12763.701 -5015.3903  60.7%  3708 1556s
  4007  2599 -7794.8678   17  501 -12763.701 -5015.3903  60.7%  3707 1562s
  4008  2599 -11279.867   31  514 -12763.701 -5015.3903  60.7%  3706 1568s
  4009  2600 -5376.2463    8  505 -12763.701 -5015.3903  60.7%  3705 1573s
  4010  2601 -10883.275   16  512 -12763.701 -5015.3903  60.7%  3704 1576s
  4011  2601 -12403.183   18  504 -12763.701 -5015.3903  60.7%  3703 1581s
  4012  2602 -10293.181   22  575 -12763.701 -5015.3903  60.7%  3702 1592s
  4013  2603 -12554.494   58  573 -12763.701 -5015.3903  60.7%  3701 1596s
  4015  2604 -10576.734   26  561 -12763.701 -5015.3903  60.7%  3699 1603s
  4016  2605 -10465.096   17  526 -12763.701 -5015.3903  60.7%  3698 1607s
  4017  2605 -6326.3048    9  503 -12763.701 -5015.3903  60.7%  3697 1617s
  4019  2607 -12703.357   47  496 -12763.701 -5015.3903  60.7%  3696 1621s
  4021  2608 -11131.188   28  503 -12763.701 -5015.3903  60.7%  3694 1626s
  4022  2609 -5220.5824   12  490 -12763.701 -5015.3903  60.7%  3693 1636s
  4024  2610 -10155.049   32  487 -12763.701 -5015.3903  60.7%  3691 1643s
  4025  2611 -5015.3903    7  504 -12763.701 -5015.3903  60.7%  3690 1650s
  4027  2612 -10228.815   42  495 -12763.701 -5015.3903  60.7%  3688 1655s
  4028  2613 -6065.1637    8  487 -12763.701 -5015.3903  60.7%  3687 1663s
  4029  2613 -10752.366   32  537 -12763.701 -5015.3903  60.7%  3686 1667s
  4030  2614 -11224.031   21  534 -12763.701 -5015.3903  60.7%  3686 1672s
  4031  2615 -10161.283   18  525 -12763.701 -5015.3903  60.7%  3685 1679s
  4032  2615 -11831.987   24  526 -12763.701 -5015.3903  60.7%  3684 1683s
  4033  2616 -9788.3106   22  483 -12763.701 -5015.3903  60.7%  3683 1689s
  4034  2617 -10163.841   31  493 -12763.701 -5015.3903  60.7%  3682 1692s
  4035  2617 -11288.124   24  485 -12763.701 -5015.3903  60.7%  3681 1698s
  4036  2618 -9966.6586   15  489 -12763.701 -5015.3903  60.7%  3680 1701s
  4037  2619 -12707.954   32  489 -12763.701 -5015.3903  60.7%  3679 1705s
  4038  2619 -11906.781   29  489 -12763.701 -5015.3903  60.7%  3678 1799s
  4039  2620 -8300.5294   19  489 -12763.701 -5015.3903  60.7%  3677 1824s
  4040  2624 -5015.3903   11  513 -12763.701 -5015.3903  60.7%  3739 1842s
  4042  2627 -5015.3903   12  525 -12763.701 -5015.3903  60.7%  3740 1864s
  4046  2634 -5015.3903   13  507 -12763.701 -5015.3903  60.7%  3743 1887s
  4054  2647 -5015.3903   14  542 -12763.701 -5015.3903  60.7%  3752 1908s
  4070  2658 -5578.3867   15  455 -12763.701 -5015.3903  60.7%  3801 1947s
  4086  2680 -6337.5516   16  393 -12763.701 -5015.3903  60.7%  3821 1971s
  4118  2755 -6736.2226   17  424 -12763.701 -5015.3903  60.7%  3833 1998s
  4203  2768 -7886.4614   19  375 -12763.701 -5015.3903  60.7%  3856 2016s
  4253  2800 -7219.1182   18  371 -12763.701 -5015.3903  60.7%  3874 2036s
H 4273  2661                    -12760.03066 -5015.3903  60.7%  3876 2036s
  4316  2689 -7924.2934   20  347 -12760.031 -5015.3903  60.7%  3882 2053s
  4383  2698 -9397.6057   20  393 -12760.031 -5015.3903  60.7%  3871 2076s
  4457  2718 -8171.1106   19  371 -12760.031 -5015.3903  60.7%  3861 2094s
H 4480  2585                    -12721.49720 -5015.3903  60.6%  3852 2094s
  4534  2602 -8829.0876   19  267 -12721.497 -5015.3903  60.6%  3844 2112s
  4601  2597 -8570.2657   21  311 -12721.497 -5015.3903  60.6%  3828 2133s
  4639  2596 -9673.9442   22  296 -12721.497 -5015.3903  60.6%  3829 2150s
  4692  2589 -9778.8422   23  217 -12721.497 -5015.3903  60.6%  3820 2167s
  4745  2584 -9882.0644   24  337 -12721.497 -5015.3903  60.6%  3808 2182s
  4799  2583 -10713.909   25  270 -12721.497 -5015.3903  60.6%  3797 2201s
  4846  2586 infeasible   24      -12721.497 -5015.3903  60.6%  3791 2223s
  4903  2578     cutoff   27      -12721.497 -5015.3903  60.6%  3779 2241s
  4963  2589     cutoff   30      -12721.497 -5015.3903  60.6%  3769 2259s
  5016  2603 -5046.6624   16  584 -12721.497 -5015.3903  60.6%  3767 2278s
  5077  2606 -5729.0181   17  525 -12721.497 -5015.3903  60.6%  3756 2296s
  5148  2618 -6894.4564   18  477 -12721.497 -5015.3903  60.6%  3741 2322s
  5224  2628 -7492.5529   19  427 -12721.497 -5015.3903  60.6%  3723 2342s
  5294  2634 -7737.4981   20  418 -12721.497 -5015.3903  60.6%  3716 2363s
  5376  2657 -8697.8920   21  414 -12721.497 -5015.3903  60.6%  3699 2380s
  5460  2677 -9349.0924   22  346 -12721.497 -5015.3903  60.6%  3681 2405s
  5553  2687 -9581.9771   23  354 -12721.497 -5015.3903  60.6%  3666 2429s
  5660  2698 -12211.512   24  251 -12721.497 -5015.3903  60.6%  3653 2454s
  5771  2726 -12491.608   25  245 -12721.497 -5015.3903  60.6%  3638 2479s
  5889  2734     cutoff   26      -12721.497 -5015.3903  60.6%  3615 2503s
  6007  2739     cutoff   22      -12721.497 -5497.4980  56.8%  3598 2531s
  6144  2738 -7274.9357   16  496 -12721.497 -5498.8748  56.8%  3574 2560s
  6285  2742 -8197.3005   18  306 -12721.497 -5498.8748  56.8%  3559 2586s
  6429  2749 -9049.8809   20  385 -12721.497 -5498.8748  56.8%  3539 2618s
  6615  2756 -9266.9019   22  401 -12721.497 -6131.8729  51.8%  3494 2647s
  6791  2754 -10532.953   24  377 -12721.497 -6131.8729  51.8%  3468 2679s
  6973  2736 -12421.832   27  334 -12721.497 -6131.8729  51.8%  3438 2713s
  7148  2757 -10582.413   21  525 -12721.497 -6466.0134  49.2%  3417 2746s
  7281  2767 -11257.112   24  425 -12721.497 -6466.0134  49.2%  3422 2781s
  7445  2749     cutoff   30      -12721.497 -7265.4462  42.9%  3411 2818s
  7610  2737 -10987.773   21  467 -12721.497 -7265.4462  42.9%  3407 2854s
  7821  2727 -11324.477   23  376 -12721.497 -7265.4462  42.9%  3386 2892s
  7994  2704     cutoff   23      -12721.497 -7265.4462  42.9%  3382 2928s
  8174  2701     cutoff   23      -12721.497 -7514.9728  40.9%  3366 2969s
  8374  2690 -10142.171   21  135 -12721.497 -7655.6937  39.8%  3359 3014s
  8595  2669 infeasible   24      -12721.497 -7737.6059  39.2%  3352 3066s
  8882  2652 infeasible   32      -12721.497 -7857.2913  38.2%  3327 3118s
  9153  2607 -10879.591   20  248 -12721.497 -8006.0044  37.1%  3311 3168s
  9430  2554     cutoff   23      -12721.497 -8067.1815  36.6%  3299 3210s
  9656  2528     cutoff   34      -12721.497 -8213.6031  35.4%  3280 3258s
  9944  2466     cutoff   24      -12721.497 -8224.6577  35.3%  3263 3314s
 10242  2426 -12375.730   24  189 -12721.497 -8453.9464  33.5%  3262 3372s
 10572  2373     cutoff   21      -12721.497 -8532.7982  32.9%  3250 3432s
 10890  2313 -10701.325   20  310 -12721.497 -8615.4640  32.3%  3244 3498s
 11206  2311 -11987.336   23   93 -12721.497 -8685.2287  31.7%  3243 3563s
 11622  2344     cutoff   24      -12721.497 -8801.0932  30.8%  3220 3600s

Cutting planes:
  Learned: 1
  MIR: 681
  Mixing: 2
  Flow cover: 1699
  RLT: 17
  Relax-and-lift: 133

Explored 11909 nodes (38397237 simplex iterations) in 3600.05 seconds (6228.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12721.5 -12760 -12763.7 ... -12989.4

Time limit reached
Best objective -1.272149720026e+04, best bound -8.873705006564e+03, gap 30.2464%
  WARNING: Time limit reached. Using best solution found (gap: 30.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -12721.50, θ = 118800.40
  Upper Bound (UB) = -12721.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118800.40
  [DEBUG]   ✓ Scenario 0: θ = 118800.40 ≤ Q = 118800.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118800.40 ≤ Q = 118800.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118800.40 ≤ Q = 118800.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118800.40 ≤ Q = 118800.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118800.40 ≤ Q = 118800.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118800.40 ≤ Q = 118800.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118800.40 ≤ Q = 118800.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118800.40 ≤ Q = 118800.40 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xbf6f43f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0bf6f43f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-01, 2e+02]
Found heuristic solution: objective 1.340024e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6231270.1241
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.426726e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142672.55    0  124 6231270.12 -142672.55   102%     -    0s
H    0     0                    -108896.3782 -142672.55  31.0%     -    0s
H    0     0                    -109233.4156 -142672.55  30.6%     -    0s
H    0     0                    -118787.2830 -142672.55  20.1%     -    0s
     0     0 -126886.01    0  124 -118787.28 -126886.01  6.82%     -    0s
H    0     0                    -122889.4903 -126803.09  3.18%     -    0s
     0     0 -125813.86    0  124 -122889.49 -125813.86  2.38%     -    0s
H    0     0                    -123923.8203 -125804.55  1.52%     -    0s
H    0     0                    -123955.8426 -125804.29  1.49%     -    0s
     0     0 -125781.17    0  124 -123955.84 -125781.17  1.47%     -    0s
     0     0 -125291.76    0  107 -123955.84 -125291.76  1.08%     -    0s
H    0     0                    -123969.4259 -125226.44  1.01%     -    0s
     0     0 -125226.44    0  118 -123969.43 -125226.44  1.01%     -    0s
     0     0 -125226.41    0  118 -123969.43 -125226.41  1.01%     -    0s
     0     0 -124715.49    0   71 -123969.43 -124715.49  0.60%     -    0s
     0     0 -124661.97    0   73 -123969.43 -124661.97  0.56%     -    0s
     0     0 -124661.97    0   74 -123969.43 -124661.97  0.56%     -    0s
     0     0 -124500.44    0   65 -123969.43 -124500.44  0.43%     -    0s
     0     0 -124443.58    0   60 -123969.43 -124443.58  0.38%     -    0s
     0     0 -124437.64    0   78 -123969.43 -124437.64  0.38%     -    0s
     0     0 -124358.79    0   65 -123969.43 -124358.79  0.31%     -    0s
     0     0 -124339.69    0   52 -123969.43 -124339.69  0.30%     -    0s
     0     2 -124339.69    0   52 -123969.43 -124339.69  0.30%     -    0s
H   44    55                    -123969.8409 -124168.88  0.16%   8.3    0s
H   60    55                    -123984.6538 -124162.74  0.14%   7.7    0s
*  673   128              21    -123988.1848 -124143.35  0.13%   5.1    0s
H  829   111                    -124003.6937 -124143.35  0.11%   5.1    0s

Cutting planes:
  Gomory: 43
  Implied bound: 12
  MIR: 137
  Flow cover: 28
  RLT: 79
  Relax-and-lift: 2
  BQP: 2

Explored 1234 nodes (7061 simplex iterations) in 0.36 seconds (0.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -124004 -123988 -123985 ... -109233
No other solutions better than -124004

Optimal solution found (tolerance 1.00e-04)
Best objective -1.240036937413e+05, best bound -1.240036937413e+05, gap 0.0000%
  Subproblem solved in 0.39s
  Worst-case operational profit (Z_SP) = 106541.17
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124003.69
  [DEBUG]   S×d_nominal = 230544.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 230544.87 + -124003.69 = 106541.17
  [DEBUG]   Current θ from Master = 118800.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12259.22 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24980.72
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 4104.2964, Absolute Gap = 4104.2964, Relative Gap = 0.322627
  Not converged yet (gap = 4104.30 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x485c818a
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.34s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19353   -2.4845461e+05   0.000000e+00   5.298990e+06      5s
   39652   -1.0453734e+05   0.000000e+00   5.195995e+07     10s
   50026   -4.7231375e+04   0.000000e+00   7.429465e+07     15s
   58569   -2.9688525e+04   0.000000e+00   3.849956e+06     20s
   64074   -2.1126313e+04   0.000000e+00   4.713721e+06     25s
   69620   -1.5134744e+04   0.000000e+00   2.995600e+06     30s
   73760   -1.4106632e+04   0.000000e+00   9.991445e+06     35s
   79328   -7.8288104e+03   0.000000e+00   2.210628e+07     40s
   83556   -6.4643487e+03   0.000000e+00   9.999934e+06     45s
   87987   -5.4006791e+03   0.000000e+00   4.889931e+06     50s
   92298   -4.4201391e+03   0.000000e+00   9.934573e+05     55s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 7.766895e+03, 62880 iterations, 56.80 seconds (74.72 work units)
Total elapsed time = 60.12s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7766.89546    0  174 -201902.96 7766.89546   104%     -   60s
H    0     0                    -184647.1165 7766.89546   104%     -   60s
H    0     0                    -76453.58452 7766.89546   110%     -   60s
H    0     0                    -75855.97914 7766.89546   110%     -   60s
H    0     0                    -75680.26056 7766.89546   110%     -   60s
H    0     0                    -67632.95852 7766.89546   111%     -   60s
H    0     0                    -31463.89144 7766.89546   125%     -   60s
H    0     0                    -27075.30572 7766.89546   129%     -   60s
H    0     0                    -23943.25728 7766.89546   132%     -   60s
H    0     0                    -23914.92561 7766.89546   132%     -   61s
H    0     0                    -23877.69998 7766.89546   133%     -   61s
H    0     0                    -21202.32970 3478.94691   116%     -   83s
H    0     0                    -21176.69392 3478.94691   116%     -   83s
H    0     0                    -21159.77334 3478.94691   116%     -   83s
H    0     0                    -21139.08385 3478.94691   116%     -   83s
H    0     0                    -21109.19627 3478.94691   116%     -   83s
     0     0 2947.67555    0  318 -21109.196 2947.67555   114%     -   83s
     0     0 2629.19539    0  342 -21109.196 2629.19539   112%     -   93s
     0     0 2629.19539    0  349 -21109.196 2629.19539   112%     -   94s
     0     0 2629.19539    0  373 -21109.196 2629.19539   112%     -   98s
     0     0 2629.19539    0  375 -21109.196 2629.19539   112%     -   98s
     0     0 2629.19539    0  375 -21109.196 2629.19539   112%     -   99s
H    0     0                    -20980.64782  455.75998   102%     -  123s
H    0     0                    -20886.24318  455.75998   102%     -  123s
H    0     0                    -20873.94209  455.75998   102%     -  123s
     0     0  455.75998    0  366 -20873.942  455.75998   102%     -  123s
H    0     0                    -18646.71407  455.60428   102%     -  124s
H    0     0                    -18264.82633  455.60428   102%     -  124s
     0     0 -201.04384    0  360 -18264.826 -201.04384  98.9%     -  132s
H    0     0                    -17263.88996 -318.83490  98.2%     -  136s
H    0     0                    -16951.28005 -318.83490  98.1%     -  136s
     0     0 -318.83490    0  370 -16951.280 -318.83490  98.1%     -  137s
H    0     0                    -16557.42891 -360.45849  97.8%     -  140s
     0     0 -360.45849    0  373 -16557.429 -360.45849  97.8%     -  140s
     0     0 -573.49465    0  364 -16557.429 -573.49465  96.5%     -  145s
     0     0 -718.27339    0  370 -16557.429 -718.27339  95.7%     -  149s
     0     0 -735.90886    0  415 -16557.429 -735.90886  95.6%     -  151s
     0     0 -860.07993    0  417 -16557.429 -860.07993  94.8%     -  155s
     0     0 -892.22747    0  425 -16557.429 -892.22747  94.6%     -  157s
     0     0 -894.44183    0  426 -16557.429 -894.44183  94.6%     -  158s
     0     0 -922.06675    0  330 -16557.429 -922.06675  94.4%     -  159s
     0     0 -927.71386    0  414 -16557.429 -927.71386  94.4%     -  160s
     0     0 -928.41584    0  415 -16557.429 -928.41584  94.4%     -  161s
     0     0 -2305.5320    0  328 -16557.429 -2305.5320  86.1%     -  174s
H    0     0                    -16536.98222 -2306.0668  86.1%     -  175s
     0     0 -3247.9025    0  487 -16536.982 -3247.9025  80.4%     -  184s
     0     0 -3507.6757    0  548 -16536.982 -3507.6757  78.8%     -  190s
     0     0 -3598.9819    0  552 -16536.982 -3598.9819  78.2%     -  193s
     0     0 -3792.1900    0  560 -16536.982 -3792.1900  77.1%     -  198s
     0     0 -3895.2072    0  499 -16536.982 -3895.2072  76.4%     -  201s
     0     0 -3945.3399    0  501 -16536.982 -3945.3399  76.1%     -  204s
     0     0 -3963.0094    0  502 -16536.982 -3963.0094  76.0%     -  205s
     0     0 -3969.0386    0  508 -16536.982 -3969.0386  76.0%     -  206s
     0     0 -3996.0697    0  506 -16536.982 -3996.0697  75.8%     -  208s
     0     0 -4009.5807    0  508 -16536.982 -4009.5807  75.8%     -  209s
     0     0 -4015.2268    0  499 -16536.982 -4015.2268  75.7%     -  210s
     0     0 -4023.6848    0  506 -16536.982 -4023.6848  75.7%     -  211s
     0     0 -4024.0005    0  508 -16536.982 -4024.0005  75.7%     -  211s
     0     0 -4561.9633    0  542 -16536.982 -4561.9633  72.4%     -  224s
     0     0 -4668.0244    0  563 -16536.982 -4668.0244  71.8%     -  229s
     0     0 -4710.9179    0  512 -16536.982 -4710.9179  71.5%     -  232s
     0     0 -4744.3956    0  557 -16536.982 -4744.3956  71.3%     -  234s
     0     0 -4755.6321    0  568 -16536.982 -4755.6321  71.2%     -  235s
     0     0 -4790.2461    0  550 -16536.982 -4790.2461  71.0%     -  237s
     0     0 -4813.4347    0  560 -16536.982 -4813.4347  70.9%     -  239s
     0     0 -4820.2833    0  595 -16536.982 -4820.2833  70.9%     -  240s
     0     0 -4822.4922    0  563 -16536.982 -4822.4922  70.8%     -  241s
     0     0 -4823.3451    0  565 -16536.982 -4823.3451  70.8%     -  241s
H    0     0                    -16529.09725 -4956.6394  70.0%     -  247s
     0     0 -4956.6394    0  502 -16529.097 -4956.6394  70.0%     -  247s
     0     0 -4979.1882    0  517 -16529.097 -4979.1882  69.9%     -  249s
     0     0 -4989.7217    0  523 -16529.097 -4989.7217  69.8%     -  250s
     0     0 -4992.7718    0  518 -16529.097 -4992.7718  69.8%     -  251s
     0     0 -4994.3606    0  519 -16529.097 -4994.3606  69.8%     -  251s
     0     0 -4996.3341    0  515 -16529.097 -4996.3341  69.8%     -  252s
     0     0 -4996.7440    0  515 -16529.097 -4996.7440  69.8%     -  252s
     0     0 -5023.0704    0  519 -16529.097 -5023.0704  69.6%     -  256s
     0     0 -5038.5981    0  523 -16529.097 -5038.5981  69.5%     -  259s
     0     0 -5047.8527    0  523 -16529.097 -5047.8527  69.5%     -  260s
     0     0 -5051.8596    0  528 -16529.097 -5051.8596  69.4%     -  261s
     0     0 -5052.7714    0  523 -16529.097 -5052.7714  69.4%     -  261s
     0     0 -5080.0093    0  524 -16529.097 -5080.0093  69.3%     -  264s
     0     0 -5081.6641    0  532 -16529.097 -5081.6641  69.3%     -  265s
     0     0 -5081.9985    0  527 -16529.097 -5081.9985  69.3%     -  265s
     0     0 -5085.7670    0  536 -16529.097 -5085.7670  69.2%     -  268s
     0     0 -5086.6986    0  534 -16529.097 -5086.6986  69.2%     -  269s
     0     0 -5088.0362    0  536 -16529.097 -5088.0362  69.2%     -  271s
     0     0 -5088.5036    0  538 -16529.097 -5088.5036  69.2%     -  271s
     0     0 -5092.7027    0  547 -16529.097 -5092.7027  69.2%     -  274s
     0     0 -5095.8909    0  547 -16529.097 -5095.8909  69.2%     -  277s
H    0     0                    -14975.83887 -5095.8909  66.0%     -  328s
H    0     0                    -14955.95335 -5095.8909  65.9%     -  329s
H    0     0                    -14935.30298 -5095.8909  65.9%     -  329s
H    0     0                    -14842.67101 -5095.8909  65.7%     -  329s
H    0     0                    -14748.53654 -5095.8909  65.4%     -  329s
H    0     2                    -14742.01218 -5095.8909  65.4%     -  365s
     0     2 -5095.8909    0  547 -14742.012 -5095.8909  65.4%     -  365s
     1     4 -5168.4955    1  528 -14742.012 -5095.8909  65.4%  2781  375s
     3     8 -5342.8907    2  463 -14742.012 -5168.5435  64.9%  6869  382s
     7    16 -5637.6268    3  556 -14742.012 -5263.8772  64.3%  6305  392s
    15    32 -5772.9368    4  575 -14742.012 -5586.8175  62.1%  6826  404s
    31    48 -6252.7895    5  290 -14742.012 -5721.5823  61.2% 10896  430s
    47    80 -7637.0007    6  471 -14742.012 -5721.5823  61.2%  9909  447s
H   55    80                    -14657.06145 -5721.5823  61.0%  9783  447s
    79   149 -7751.4199    7  458 -14657.061 -5721.5823  61.0%  8619  481s
H  148   275                    -14628.91566 -5721.5823  60.9%  6293  497s
H  158   275                    -14563.14917 -5721.5823  60.7%  5991  497s
H  162   275                    -14547.12974 -5721.5823  60.7%  5914  497s
H  274   342                    -14191.47897 -5721.5823  59.7%  4503  510s
   341   383 -8266.8173   12  441 -14191.479 -5721.5823  59.7%  4268  527s
   390   433 -8617.7564   14  357 -14191.479 -5721.5823  59.7%  4229  541s
   446   488 -8391.5956   15  425 -14191.479 -5721.5823  59.7%  4499  554s
   513   544 -8650.1160   15  436 -14191.479 -5721.5823  59.7%  4414  566s
   587   594 -9462.2123   15  386 -14191.479 -5721.5823  59.7%  4242  580s
   654   654 -10078.459   15  294 -14191.479 -5721.5823  59.7%  4081  593s
   740   703 -9651.0856   15  393 -14191.479 -5721.5823  59.7%  3847  606s
   829   749 -11052.455   15  280 -14191.479 -5721.5823  59.7%  3600  620s
   907   782 -9954.1097   16  296 -14191.479 -5721.5823  59.7%  3462  633s
   998   797 -9902.4697   16  352 -14191.479 -5721.5823  59.7%  3319  649s
  1045   802 -9471.3121   16  417 -14191.479 -5721.5823  59.7%  3308  663s
  1099   844 -10948.889   16  373 -14191.479 -5721.5823  59.7%  3313  676s
  1157   868 -11147.913   17  363 -14191.479 -5721.5823  59.7%  3327  694s
  1193   903 -13168.834   18  320 -14191.479 -5773.4522  59.3%  3358  707s
  1246   949 infeasible   18      -14191.479 -5773.4522  59.3%  3333  722s
  1314   999     cutoff   20      -14191.479 -5773.4522  59.3%  3265  737s
  1408  1088     cutoff   19      -14191.479 -5773.4522  59.3%  3160  752s
  1550  1138     cutoff   27      -14191.479 -5773.4522  59.3%  3006  770s
  1699  1202 -12623.020   29  383 -14191.479 -5773.4522  59.3%  2878  789s
  1803  1305 -12903.337   31  264 -14191.479 -5773.4522  59.3%  2846  807s
  1965  1409 -13148.642   33  247 -14191.479 -5773.4522  59.3%  2755  826s
  2134  1436 -13498.448   38  284 -14191.479 -5773.4522  59.3%  2678  844s
  2175  1469 -13560.377   38  288 -14191.479 -5773.4522  59.3%  2689  872s
  2253  1506     cutoff   43      -14191.479 -5773.4522  59.3%  2669  891s
  2345  1558 -9036.2866    9  258 -14191.479 -5773.4522  59.3%  2654  910s
  2437  1599 -10207.017   13  181 -14191.479 -5974.1371  57.9%  2648  932s
  2528  1649     cutoff   16      -14191.479 -5974.2442  57.9%  2637  949s
  2600  1698 -13373.269   17  173 -14191.479 -5974.2442  57.9%  2663  969s
  2709  1755 -13496.140   19  198 -14191.479 -6327.0923  55.4%  2653  988s
  2828  1791     cutoff   28      -14191.479 -6327.0923  55.4%  2637 1010s
  2939  1847 -9254.4806    8  477 -14191.479 -6327.0923  55.4%  2637 1034s
  3029  1922 -10719.944    9  372 -14191.479 -6327.0923  55.4%  2655 1058s
  3149  1973 -12099.608   11  346 -14191.479 -6610.3196  53.4%  2653 1084s
  3288  2044 -12863.721   13  247 -14191.479 -6821.7373  51.9%  2652 1108s
  3450  2098 -13978.110   16  263 -14191.479 -6821.7373  51.9%  2648 1136s
  3605  2117 -9830.0490   14  379 -14191.479 -6821.7373  51.9%  2641 1166s
  3650  2159 -10167.060   15  371 -14191.479 -7183.1644  49.4%  2664 1186s
  3708  2202 -10875.431   16  423 -14191.479 -7183.1644  49.4%  2672 1212s
  3809  2299 -11426.031   17  408 -14191.479 -7183.1644  49.4%  2667 1243s
  3968  2353     cutoff   20      -14191.479 -7457.7898  47.4%  2645 1275s
  4154  2435 -13303.397   22  270 -14191.479 -7493.8867  47.2%  2641 1310s
  4330  2551 -9040.7842   13  439 -14191.479 -7501.5387  47.1%  2677 1343s
  4540  2552 -10264.668   15  547 -14191.479 -7501.5387  47.1%  2697 1628s
  4542  2553 -8923.6975   11  174 -14191.479 -7501.5387  47.1%  2696 1675s
  4543  2554 -13963.150   38  376 -14191.479 -7501.5387  47.1%  2695 1716s
  4544  2555 -9268.0085   14  529 -14191.479 -7501.5387  47.1%  2694 1748s
  4545  2555 -13801.172   53  530 -14191.479 -7501.5387  47.1%  2694 1765s
  4546  2556 -12994.470   34  509 -14191.479 -7501.5387  47.1%  2693 1776s
  4547  2557 -11830.123   19  551 -14191.479 -7501.5387  47.1%  2693 1783s
  4548  2557 -13595.211   48  575 -14191.479 -7501.5387  47.1%  2692 1791s
  4549  2558 -13228.920   29  467 -14191.479 -7501.5387  47.1%  2692 1796s
  4550  2559 -12062.181   36  524 -14191.479 -7501.5387  47.1%  2691 1801s
  4552  2560 -13864.144   35  577 -14191.479 -7501.5387  47.1%  2690 1808s
  4554  2561 -11847.109   17  577 -14191.479 -7501.5387  47.1%  2689 1814s
  4555  2562 -12044.275   16  517 -14191.479 -7501.5387  47.1%  2688 1823s
  4556  2563 -12843.560   19  446 -14191.479 -7501.5387  47.1%  2687 1826s
  4557  2563 -13103.766   35  516 -14191.479 -7501.5387  47.1%  2687 1831s
  4558  2564 -10049.425   13  540 -14191.479 -7501.5387  47.1%  2686 1840s
  4561  2566 -8196.0931   15  496 -14191.479 -7501.5387  47.1%  2684 1848s
  4562  2567 -10865.732   16  504 -14191.479 -7501.5387  47.1%  2684 1856s
  4564  2568 -8685.9053    9  512 -14191.479 -7501.5387  47.1%  2683 1861s
  4565  2569 -11784.715   39  561 -14191.479 -7501.5387  47.1%  2682 1870s
  4566  2569 -11096.165   17  575 -14191.479 -7501.5387  47.1%  2681 1875s
  4567  2570 -10411.944   16  564 -14191.479 -7501.5387  47.1%  2681 1891s
  4569  2571 -13799.319   51  503 -14191.479 -7501.5387  47.1%  2680 1900s
  4571  2573 -10997.368   22  503 -14191.479 -7501.5387  47.1%  2679 1914s
  4572  2573 -8165.3134    8  577 -14191.479 -7501.5387  47.1%  2678 1919s
  4573  2574 -11787.852   18  457 -14191.479 -7501.5387  47.1%  2677 1923s
  4574  2575 -11139.324   16  572 -14191.479 -7501.5387  47.1%  2677 1927s
  4575  2575 -14001.961   34  456 -14191.479 -7501.5387  47.1%  2676 1931s
  4576  2576 -11366.263   14  456 -14191.479 -7501.5387  47.1%  2676 1976s
  4577  2577 -12754.157   39  456 -14191.479 -7501.5387  47.1%  2675 2018s
  4578  2580 -7501.5387   15  566 -14191.479 -7501.5387  47.1%  2724 2074s
  4580  2584 -7501.5387   16  560 -14191.479 -7501.5387  47.1%  2729 2094s
  4584  2590 -7501.5387   17  547 -14191.479 -7501.5387  47.1%  2732 2116s
  4592  2604 -7501.5387   18  555 -14191.479 -7501.5387  47.1%  2739 2151s
  4608  2613 -8166.3661   19  528 -14191.479 -7501.5387  47.1%  2782 2191s
  4625  2628 -8172.2009   20  373 -14191.479 -7501.5387  47.1%  2830 2213s
  4657  2711 -8270.2877   21  374 -14191.479 -7501.5387  47.1%  2861 2247s
  4761  2696 -9602.1020   24  402 -14191.479 -7501.5387  47.1%  2932 2269s
  4795  2725 -10221.280   23  400 -14191.479 -7501.5387  47.1%  2960 2308s
  4838  2751 -10693.827   24  246 -14191.479 -7501.5387  47.1%  2988 2329s
  4894  2765 -9040.6791   23  343 -14191.479 -7501.5387  47.1%  3014 2351s
  4958  2758 -9872.6670   25  398 -14191.479 -7501.5387  47.1%  3047 2368s
  5022  2749 -11131.585   25  391 -14191.479 -7501.5387  47.1%  3075 2393s
  5077  2745 -10856.831   26  326 -14191.479 -7501.5387  47.1%  3103 2411s
  5128  2752 -11603.087   28  151 -14191.479 -7501.5387  47.1%  3147 2429s
  5184  2741 -13053.048   31  105 -14191.479 -7501.5387  47.1%  3171 2447s
  5239  2750 -11758.297   28  304 -14191.479 -7501.5387  47.1%  3187 2467s
  5286  2743 -13269.540   30  270 -14191.479 -7501.5387  47.1%  3224 2485s
  5339  2737 -13566.761   32  253 -14191.479 -7501.5387  47.1%  3249 2511s
  5396  2733 -9678.2069   23  405 -14191.479 -7501.5387  47.1%  3279 2529s
  5455  2718 -10755.708   23  232 -14191.479 -7501.5387  47.1%  3307 2552s
  5509  2713 -11149.544   24  227 -14191.479 -7501.5387  47.1%  3323 2570s
  5565  2732 -11768.934   25  267 -14191.479 -7501.5387  47.1%  3365 2587s
  5619  2736 -12405.175   26  245 -14191.479 -7501.5387  47.1%  3406 2607s
  5664  2747 -13051.284   27  174 -14191.479 -7501.5387  47.1%  3422 2620s
  5706  2745     cutoff   27      -14191.479 -7501.5387  47.1%  3430 2640s
  5777  2739 -13579.517   29  128 -14191.479 -7501.5387  47.1%  3439 2661s
  5836  2723 -13881.703   31  121 -14191.479 -7501.5387  47.1%  3458 2692s
  5911  2716 -12837.980   27  309 -14191.479 -7501.5387  47.1%  3483 2715s
  5966  2720 -12976.611   28  266 -14191.479 -7501.5387  47.1%  3518 2735s
  6031  2716 -13038.848   30  333 -14191.479 -7501.5387  47.1%  3540 2759s
  6088  2730     cutoff   32      -14191.479 -7501.5387  47.1%  3561 2780s
  6156  2730     cutoff   30      -14191.479 -7601.7528  46.4%  3578 2807s
  6240  2722 -9159.1626   21  580 -14191.479 -7601.7528  46.4%  3594 2839s
  6330  2711 -9613.1162   22  584 -14191.479 -7844.3348  44.7%  3615 2861s
  6378  2720 -10470.687   23  515 -14191.479 -7844.3348  44.7%  3639 2892s
  6445  2729 -10591.559   24  580 -14191.479 -8490.6494  40.2%  3660 2919s
  6529  2727 -11267.095   25  517 -14191.479 -8490.6494  40.2%  3696 2947s
  6623  2726 -11964.492   26  440 -14191.479 -8490.6494  40.2%  3727 2978s
  6735  2702 -13720.955   28  297 -14191.479 -8490.6494  40.2%  3752 3007s
  6828  2696 -13094.786   27  444 -14191.479 -8490.6494  40.2%  3778 3036s
  6917  2706     cutoff   29      -14191.479 -8641.9008  39.1%  3792 3070s
  7015  2690 -12404.192   24  449 -14191.479 -8641.9008  39.1%  3841 3104s
  7170  2687 -13142.456   25  401 -14191.479 -8865.3264  37.5%  3879 3140s
  7332  2664 -14124.614   28  256 -14191.479 -9520.9448  32.9%  3927 3180s
  7507  2668 -11985.345   25  229 -14191.479 -9612.0834  32.3%  3963 3220s
  7703  2660     cutoff   29      -14191.479 -9612.0834  32.3%  3985 3259s
  7930  2625 -13195.462   26  452 -14191.479 -9733.9423  31.4%  4010 3298s
  8082  2629 -13776.451   27  432 -14191.479 -9961.8312  29.8%  4033 3341s
  8294  2605     cutoff   30      -14191.479 -10024.938  29.4%  4073 3388s
  8581  2535 -11470.100   29  348 -14191.479 -10155.800  28.4%  4096 3431s
  8877  2472 -13357.947   31  234 -14191.479 -10229.118  27.9%  4121 3477s
  9192  2370 -11828.782   30  360 -14191.479 -10366.108  27.0%  4153 3522s
  9397  2332 -13469.463   32  398 -14191.479 -10761.684  24.2%  4166 3569s
  9703  2208 -13334.856   30  274 -14191.479 -10870.951  23.4%  4197 3600s

Cutting planes:
  Learned: 2
  MIR: 652
  Flow cover: 1649
  RLT: 23
  Relax-and-lift: 154

Explored 9940 nodes (42117770 simplex iterations) in 3600.04 seconds (6817.55 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14191.5 -14547.1 -14563.1 ... -14956

Time limit reached
Best objective -1.419147896829e+04, best bound -1.087095062840e+04, gap 23.3980%
  WARNING: Time limit reached. Using best solution found (gap: 23.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -14191.48, θ = 129267.99
  Upper Bound (UB) = -14191.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 129267.99
  [DEBUG]   ✓ Scenario 0: θ = 129267.99 ≤ Q = 129267.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 129267.99 ≤ Q = 129267.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 129267.99 ≤ Q = 129267.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 129267.99 ≤ Q = 129267.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 129267.99 ≤ Q = 129267.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 129267.99 ≤ Q = 129267.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 129267.99 ≤ Q = 129267.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 129267.99 ≤ Q = 129267.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 129267.99 ≤ Q = 129267.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5f91e073
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa06e1f8d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.184403e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5182913.6517
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5182459.6104

Root relaxation: objective -1.513322e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151332.18    0  129 5182459.61 -151332.18   103%     -    0s
H    0     0                    -117223.3432 -151332.18  29.1%     -    0s
H    0     0                    -117300.3188 -151029.95  28.8%     -    0s
     0     0 -130699.28    0   58 -117300.32 -130699.28  11.4%     -    0s
H    0     0                    -128351.4718 -130594.68  1.75%     -    0s
H    0     0                    -128654.9539 -130594.68  1.51%     -    0s
H    0     0                    -128799.0576 -130594.68  1.39%     -    0s
H    0     0                    -129102.5397 -130594.68  1.16%     -    0s
     0     0 -130285.52    0   60 -129102.54 -130285.52  0.92%     -    0s
     0     0 -130285.46    0   60 -129102.54 -130285.46  0.92%     -    0s
     0     0 -129952.55    0   21 -129102.54 -129952.55  0.66%     -    0s
H    0     0                    -129704.2691 -129950.55  0.19%     -    0s
     0     0 -129930.27    0   23 -129704.27 -129930.27  0.17%     -    0s
     0     0 -129930.04    0   11 -129704.27 -129930.04  0.17%     -    0s
H    0     0                    -129757.9134 -129929.52  0.13%     -    0s
     0     0 -129929.52    0    9 -129757.91 -129929.52  0.13%     -    0s
H    0     0                    -129767.9389 -129929.52  0.12%     -    0s
     0     0 -129886.44    0    9 -129767.94 -129886.44  0.09%     -    0s
     0     0 -129886.44    0   36 -129767.94 -129886.44  0.09%     -    0s
H    0     0                    -129840.1717 -129886.44  0.04%     -    0s
     0     0 -129857.36    0    7 -129840.17 -129857.36  0.01%     -    0s
     0     0 -129857.29    0    6 -129840.17 -129857.29  0.01%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 2
  MIR: 30
  Flow cover: 1

Explored 1 nodes (698 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -129840 -129768 -129758 ... 1.1844e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.298401717079e+05, best bound -1.298519306492e+05, gap 0.0091%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 119518.32
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129840.17
  [DEBUG]   S×d_nominal = 249358.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249358.50 + -129840.17 = 119518.32
  [DEBUG]   Current θ from Master = 129267.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9749.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23941.15
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2634.3146, Absolute Gap = 2634.3146, Relative Gap = 0.185627
  Not converged yet (gap = 2634.31 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xc299f5ab
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 3.42s
Presolved: 83583 rows, 35960 columns, 511289 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387895.7675
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.531e+06
 Factor NZ  : 7.611e+06 (roughly 100 MB of memory)
 Factor Ops : 1.289e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.43892450e+07  1.65023307e+08  8.75e+04 2.09e+01  6.93e+04     5s
   1  -1.06921385e+07  1.40319176e+08  5.90e+04 8.01e+01  4.61e+04     5s
   2  -4.36997879e+06  1.05136609e+08  2.31e+04 1.26e-11  1.87e+04     5s
   3  -8.36542199e+05  7.50488125e+07  1.89e+03 1.21e+00  1.92e+03     5s
   4  -4.95896497e+05  2.40930320e+07  3.58e+02 1.82e-01  3.93e+02     6s
   5  -3.86868003e+05  1.58144971e+07  1.51e+02 1.05e-01  1.95e+02     6s
   6  -2.94694608e+05  1.19388799e+07  8.05e+01 7.36e-02  1.22e+02     6s
   7  -1.63055465e+05  9.14248308e+06  2.89e+01 5.21e-02  7.38e+01     6s
   8  -1.26161714e+05  5.31989922e+06  1.36e+01 2.78e-02  3.97e+01     6s
   9  -1.11739368e+05  3.44426248e+06  8.97e+00 1.73e-02  2.51e+01     6s
  10  -8.80065069e+04  1.13900200e+06  2.95e+00 5.14e-03  8.26e+00     6s
  11  -5.74044570e+04  3.31500692e+05  8.06e-01 1.76e-03  2.56e+00     6s
  12  -4.31307534e+04  1.58119159e+05  5.45e-01 1.22e-03  1.32e+00     6s
  13  -3.55086313e+04  1.04002479e+05  4.39e-01 1.19e-03  9.16e-01     6s
  14  -2.85374849e+04  7.76202844e+04  3.59e-01 1.80e-03  6.97e-01     6s
  15  -2.32994160e+04  6.69376195e+04  3.05e-01 1.69e-03  5.92e-01     6s
  16  -1.87486663e+04  4.69688336e+04  2.60e-01 1.92e-03  4.31e-01     6s
  17  -1.26458392e+04  4.55809581e+04  2.05e-01 1.83e-03  3.82e-01     7s
  18  -1.13562829e+04  4.07183049e+04  1.92e-01 1.92e-03  3.41e-01     7s
  19  -1.01057154e+04  3.67514279e+04  1.81e-01 2.07e-03  3.07e-01     7s
  20  -5.77522160e+03  3.18610466e+04  1.42e-01 1.94e-03  2.47e-01     7s
  21  -3.84843257e+03  2.58733141e+04  1.24e-01 2.46e-03  1.95e-01     7s
  22  -1.61122289e+03  2.28674844e+04  1.06e-01 2.37e-03  1.61e-01     7s
  23   1.33900571e+03  2.08551265e+04  8.20e-02 1.60e-03  1.28e-01     7s
  24   2.96857983e+03  1.87654256e+04  6.94e-02 1.79e-03  1.04e-01     7s
  25   5.10907170e+03  1.73951552e+04  5.27e-02 1.79e-03  8.06e-02     7s
  26   5.73945556e+03  1.64739855e+04  4.79e-02 1.53e-03  7.04e-02     7s
  27   6.45524495e+03  1.59906446e+04  4.27e-02 1.80e-03  6.26e-02     7s
  28   7.43958792e+03  1.55645721e+04  3.58e-02 1.49e-03  5.33e-02     7s
  29   7.62007866e+03  1.54310912e+04  3.45e-02 1.41e-03  5.12e-02     8s
  30   8.51921064e+03  1.48250251e+04  2.82e-02 1.20e-03  4.14e-02     8s
  31   9.23475335e+03  1.44311888e+04  2.30e-02 1.09e-03  3.41e-02     8s
  32   9.83581859e+03  1.42353403e+04  1.89e-02 9.67e-04  2.88e-02     8s
  33   1.01249131e+04  1.39537363e+04  1.69e-02 8.00e-04  2.51e-02     8s
  34   1.06553018e+04  1.37429308e+04  1.32e-02 6.63e-04  2.02e-02     8s
  35   1.11406898e+04  1.35979422e+04  9.95e-03 5.82e-04  1.61e-02     8s
  36   1.13169051e+04  1.34033196e+04  8.77e-03 4.62e-04  1.37e-02     8s
  37   1.14991382e+04  1.32605897e+04  7.56e-03 3.45e-04  1.15e-02     8s
  38   1.16803667e+04  1.30796572e+04  6.37e-03 2.36e-04  9.18e-03     8s
  39   1.18339452e+04  1.29786550e+04  5.34e-03 1.93e-04  7.51e-03     9s
  40   1.20132047e+04  1.29205292e+04  4.13e-03 1.55e-04  5.95e-03     9s
  41   1.21453004e+04  1.28463225e+04  3.27e-03 1.25e-04  4.60e-03     9s
  42   1.22292178e+04  1.28311706e+04  2.76e-03 1.14e-04  3.95e-03     9s
  43   1.22624388e+04  1.28243398e+04  2.55e-03 1.06e-04  3.69e-03     9s
  44   1.23119724e+04  1.27409640e+04  2.25e-03 1.11e-04  2.82e-03     9s
  45   1.23593718e+04  1.27249176e+04  1.96e-03 8.02e-05  2.40e-03     9s
  46   1.24844977e+04  1.27169623e+04  1.21e-03 6.37e-05  1.53e-03     9s
  47   1.25257521e+04  1.27147985e+04  9.49e-04 5.92e-05  1.24e-03     9s
  48   1.25785523e+04  1.26941143e+04  6.13e-04 2.08e-05  7.59e-04    10s
  49   1.26222276e+04  1.26890283e+04  3.47e-04 8.75e-06  4.39e-04    10s
  50   1.26375215e+04  1.26873676e+04  2.57e-04 6.52e-06  3.27e-04    10s
  51   1.26509218e+04  1.26853520e+04  1.78e-04 4.06e-06  2.26e-04    10s
  52   1.26598852e+04  1.26849277e+04  1.28e-04 3.43e-06  1.64e-04    10s
  53   1.26758869e+04  1.26835487e+04  3.65e-05 1.40e-06  5.03e-05    10s
  54   1.26766908e+04  1.26828374e+04  3.21e-05 2.16e-07  4.04e-05    10s
  55   1.26824277e+04  1.26825848e+04  5.14e-07 1.15e-06  1.03e-06    10s
  56   1.26825595e+04  1.26825602e+04  2.99e-09 9.91e-10  4.54e-09    10s
  57   1.26825598e+04  1.26825602e+04  4.87e-07 2.88e-09  2.46e-09    10s
  58   1.26825599e+04  1.26825601e+04  5.15e-07 2.00e-08  2.39e-09    10s
  59   1.26825596e+04  1.26825601e+04  1.09e-05 2.47e-08  2.39e-09    11s
  60   1.26825597e+04  1.26825602e+04  1.00e-05 2.17e-08  2.39e-09    11s

Barrier solved model in 60 iterations and 10.69 seconds (8.26 work units)
Optimal objective 1.26825597e+04


Root crossover log...

   71841 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                15s

   15520 PPushes remaining with PInf 1.1580776e-04                15s
    7234 PPushes remaining with PInf 6.4794329e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.1518000e+04     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53266    1.2682560e+04   0.000000e+00   4.151800e+04     16s
   53812    1.2682560e+04   0.000000e+00   0.000000e+00     16s
   53812    1.2682560e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.268256e+04, 53812 iterations, 12.13 seconds (15.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12682.5601    0  252 -201902.96 12682.5601   106%     -   17s
H    0     0                    -188224.6336 12682.5601   107%     -   17s
H    0     0                    -186605.3771 12682.5601   107%     -   17s
H    0     0                    -186557.6798 12682.5601   107%     -   17s
H    0     0                    -78629.49208 12682.5601   116%     -   18s
H    0     0                    -72006.98809 12682.5601   118%     -   18s
H    0     0                    -40497.99743 12682.5601   131%     -   18s
H    0     0                    -38773.37357 12682.5601   133%     -   18s
H    0     0                    -38593.40419 12682.5601   133%     -   18s
H    0     0                    -38584.51552 12682.5601   133%     -   18s
H    0     0                    -37707.07545 12682.5601   134%     -   18s
H    0     0                    -35185.99203 12682.5601   136%     -   20s
H    0     0                    -29038.36064 12682.5601   144%     -   20s
H    0     0                    -25233.67168 12682.5601   150%     -   20s
H    0     0                    -25224.39221 12682.5601   150%     -   20s
H    0     0                    -25176.24771 12682.5601   150%     -   20s
H    0     0                    -25164.37072 12682.5601   150%     -   20s
     0     0 4326.07930    0  424 -25164.371 4326.07930   117%     -   63s
H    0     0                    -24255.68892 4325.18486   118%     -   64s
H    0     0                    -24038.06621 4325.18486   118%     -   64s
H    0     0                    -23810.14586 4325.18486   118%     -   64s
H    0     0                    -23759.18410 4325.18486   118%     -   64s
     0     0 3819.37165    0  419 -23759.184 3819.37165   116%     -   82s
     0     0 3428.48747    0  440 -23759.184 3428.48747   114%     -  101s
     0     0 3428.48747    0  442 -23759.184 3428.48747   114%     -  103s
     0     0 3428.48747    0  442 -23759.184 3428.48747   114%     -  103s
     0     0 1030.74605    0  378 -23759.184 1030.74605   104%     -  136s
H    0     0                    -18179.92619 1030.48639   106%     -  137s
H    0     0                    -18163.79678 1030.48639   106%     -  137s
H    0     0                    -17669.92712 1030.48639   106%     -  137s
     0     0  634.59190    0  392 -17669.927  634.59190   104%     -  163s
     0     0  233.30298    0  400 -17669.927  233.30298   101%     -  183s
     0     0  125.98976    0  417 -17669.927  125.98976   101%     -  195s
     0     0   17.66681    0  418 -17669.927   17.66681   100%     -  203s
     0     0  -81.10135    0  419 -17669.927  -81.10135   100%     -  213s
     0     0 -247.28732    0  422 -17669.927 -247.28732  98.6%     -  225s
     0     0 -296.94906    0  404 -17669.927 -296.94906  98.3%     -  230s
     0     0 -305.12066    0  416 -17669.927 -305.12066  98.3%     -  232s
     0     0 -347.56149    0  425 -17669.927 -347.56149  98.0%     -  236s
     0     0 -354.83677    0  428 -17669.927 -354.83677  98.0%     -  238s
     0     0 -356.90856    0  425 -17669.927 -356.90856  98.0%     -  240s
     0     0 -357.13846    0  415 -17669.927 -357.13846  98.0%     -  242s
     0     0 -2297.0393    0  477 -17669.927 -2297.0393  87.0%     -  283s
H    0     0                    -17384.07679 -2297.3264  86.8%     -  284s
H    0     0                    -16829.85539 -2297.3264  86.3%     -  284s
H    0     0                    -16826.60560 -2297.3264  86.3%     -  284s
     0     0 -2681.4902    0  525 -16826.606 -2681.4902  84.1%     -  297s
     0     0 -2868.1122    0  565 -16826.606 -2868.1122  83.0%     -  306s
     0     0 -2937.6269    0  535 -16826.606 -2937.6269  82.5%     -  313s
     0     0 -2963.5085    0  573 -16826.606 -2963.5085  82.4%     -  317s
     0     0 -3013.1991    0  530 -16826.606 -3013.1991  82.1%     -  324s
     0     0 -3022.2279    0  536 -16826.606 -3022.2279  82.0%     -  327s
     0     0 -3065.5074    0  524 -16826.606 -3065.5074  81.8%     -  332s
     0     0 -3083.3026    0  573 -16826.606 -3083.3026  81.7%     -  335s
     0     0 -3134.8766    0  583 -16826.606 -3134.8766  81.4%     -  339s
     0     0 -3144.0862    0  582 -16826.606 -3144.0862  81.3%     -  342s
     0     0 -3151.9225    0  604 -16826.606 -3151.9225  81.3%     -  344s
     0     0 -3154.4358    0  590 -16826.606 -3154.4358  81.3%     -  344s
     0     0 -3155.0168    0  601 -16826.606 -3155.0168  81.2%     -  345s
     0     0 -3857.4694    0  553 -16826.606 -3857.4694  77.1%     -  370s
     0     0 -4065.4798    0  553 -16826.606 -4065.4798  75.8%     -  383s
     0     0 -4168.9679    0  517 -16826.606 -4168.9679  75.2%     -  390s
     0     0 -4227.5124    0  499 -16826.606 -4227.5124  74.9%     -  394s
     0     0 -4263.3751    0  460 -16826.606 -4263.3751  74.7%     -  397s
     0     0 -4285.0613    0  457 -16826.606 -4285.0613  74.5%     -  400s
     0     0 -4304.8909    0  459 -16826.606 -4304.8909  74.4%     -  402s
     0     0 -4319.8786    0  465 -16826.606 -4319.8786  74.3%     -  404s
     0     0 -4326.6175    0  462 -16826.606 -4326.6175  74.3%     -  405s
     0     0 -4344.0313    0  448 -16826.606 -4344.0313  74.2%     -  407s
     0     0 -4353.0844    0  515 -16826.606 -4353.0844  74.1%     -  408s
     0     0 -4357.1088    0  469 -16826.606 -4357.1088  74.1%     -  409s
     0     0 -4357.4102    0  470 -16826.606 -4357.4102  74.1%     -  409s
     0     0 -4532.0786    0  511 -16826.606 -4532.0786  73.1%     -  417s
     0     0 -4549.6596    0  566 -16826.606 -4549.6596  73.0%     -  421s
     0     0 -4555.8533    0  564 -16826.606 -4555.8533  72.9%     -  422s
     0     0 -4556.5873    0  522 -16826.606 -4556.5873  72.9%     -  422s
     0     0 -4596.3058    0  519 -16826.606 -4596.3058  72.7%     -  428s
     0     0 -4603.7065    0  506 -16826.606 -4603.7065  72.6%     -  437s
     0     0 -4608.5981    0  462 -16826.606 -4608.5981  72.6%     -  437s
     0     0 -4611.2658    0  462 -16826.606 -4611.2658  72.6%     -  438s
     0     0 -4612.6826    0  464 -16826.606 -4612.6826  72.6%     -  439s
     0     0 -4654.0056    0  512 -16826.606 -4654.0056  72.3%     -  445s
     0     0 -4657.1287    0  516 -16826.606 -4657.1287  72.3%     -  447s
     0     0 -4658.7555    0  518 -16826.606 -4658.7555  72.3%     -  447s
     0     0 -4686.2701    0  523 -16826.606 -4686.2701  72.1%     -  452s
     0     0 -4693.5525    0  529 -16826.606 -4693.5525  72.1%     -  456s
     0     0 -4695.7201    0  477 -16826.606 -4695.7201  72.1%     -  457s
     0     0 -4705.4481    0  493 -16826.606 -4705.4481  72.0%     -  460s
     0     0 -4708.0567    0  500 -16826.606 -4708.0567  72.0%     -  461s
     0     0 -4708.3022    0  492 -16826.606 -4708.3022  72.0%     -  462s
     0     0 -4710.5322    0  537 -16826.606 -4710.5322  72.0%     -  464s
     0     0 -4711.4229    0  546 -16826.606 -4711.4229  72.0%     -  467s
     0     0 -4714.9770    0  530 -16826.606 -4714.9770  72.0%     -  469s
     0     0 -4715.0272    0  530 -16826.606 -4715.0272  72.0%     -  472s
H    0     0                    -16394.09916 -4715.0272  71.2%     -  536s
H    0     0                    -16307.80364 -4715.0272  71.1%     -  536s
     0     2 -4715.0272    0  530 -16307.804 -4715.0272  71.1%     -  538s
     1     3 -5091.8958    1  446 -16307.804 -4715.0930  71.1%  7544  546s
     2     5 -5476.0228    2  436 -16307.804 -4715.0930  71.1%  8389  556s
     4     9 -5806.0838    3  434 -16307.804 -4955.8685  69.6%  7438  571s
     8    18 -6910.4442    3  536 -16307.804 -4955.8685  69.6% 10161  593s
    17    36 -7023.8232    4  579 -16307.804 -5434.4838  66.7%  9378  610s
    35    50 -6947.9273    5  407 -16307.804 -5877.5889  64.0% 12128  647s
    49    78 -7189.9038    6  444 -16307.804 -5877.5889  64.0% 14040  681s
H   77   127                    -16283.28220 -5877.5889  63.9% 10591  702s
H   89   127                    -16167.19666 -5877.5889  63.6%  9745  702s
H  115   127                    -15071.30796 -5877.5889  61.0%  8601  702s
   126   265 -7286.8882    8  435 -15071.308 -5877.5889  61.0%  8195  728s
H  164   265                    -15052.51274 -5877.5889  61.0%  6922  728s
   264   352 -7407.0521   13  439 -15052.513 -5877.5889  61.0%  5180  747s
   356   419 -7520.3146   16  418 -15052.513 -5877.5889  61.0%  4569  765s
   425   456 -7920.2482   19  340 -15052.513 -5877.5889  61.0%  4486  783s
   473   476 -8590.0997   22  341 -15052.513 -5877.5889  61.0%  4389  808s
   510   519 -8705.7652   23  328 -15052.513 -5926.3413  60.6%  4383  825s
   569   547 -10802.242   18  325 -15052.513 -5926.3413  60.6%  4658  844s
H  581   547                    -14597.24230 -5926.3413  59.4%  4625  844s
   611   556 -10857.540   25  264 -14597.242 -5926.3413  59.4%  4689  861s
   658   565 -13085.664   26  245 -14597.242 -5926.3413  59.4%  4801  877s
H  671   565                    -14568.32934 -5926.3413  59.3%  4830  877s
   703   588     cutoff   28      -14568.329 -5926.3413  59.3%  4968  895s
   759   598 -11321.428   24  447 -14568.329 -5926.3413  59.3%  5110  913s
   791   622 -12921.755   21  353 -14568.329 -5926.3413  59.3%  5072  933s
   834   642     cutoff   10      -14568.329 -5926.3413  59.3%  5029  950s
H  864   642                    -14533.73457 -5926.3413  59.2%  5068  950s
   870   689 infeasible   22      -14533.735 -5926.3413  59.2%  5103  972s
   943   736 -12648.031   41  337 -14533.735 -5926.3413  59.2%  4941  989s
H  949   736                    -14531.77878 -5926.3413  59.2%  4914  989s
  1024   763 -13648.164   34  216 -14531.779 -5926.3413  59.2%  4722 1007s
  1078   799 -13757.078   35  200 -14531.779 -5926.3413  59.2%  4630 1026s
  1158   835 -13954.446   38  189 -14531.779 -5926.3413  59.2%  4472 1045s
  1254   862 -14142.587   41  174 -14531.779 -5926.3413  59.2%  4295 1067s
  1336   882 infeasible   42      -14531.779 -5926.3413  59.2%  4201 1092s
  1442   927 -11603.950   11  252 -14531.779 -5992.0014  58.8%  4085 1118s
  1505   977 -11835.870   12  251 -14531.779 -5992.0014  58.8%  4086 1143s
  1581  1016     cutoff   15      -14531.779 -5992.0014  58.8%  4070 1169s
  1676  1055 infeasible   15      -14531.779 -5992.0014  58.8%  4021 1196s
  1756  1086 -13813.077   15  224 -14531.779 -5992.0014  58.8%  4011 1224s
  1851  1140 infeasible   15      -14531.779 -6548.6568  54.9%  3991 1254s
  1953  1196 -9174.9017    6  400 -14531.779 -6548.6568  54.9%  3960 1285s
  2065  1215 -10523.596    7  337 -14531.779 -6548.6568  54.9%  3924 1310s
  2115  1245 -11241.074    8  441 -14531.779 -6548.6568  54.9%  3911 1340s
H 2163  1245                    -14526.48672 -6651.6613  54.2%  3903 1340s
  2191  1329 -11700.567    9  322 -14526.487 -6651.6613  54.2%  3881 1373s
  2333  1426 -12441.594   11  370 -14526.487 -6651.6613  54.2%  3847 1412s
  2481  1533 -13582.599   13  319 -14526.487 -6738.0029  53.6%  3803 1447s
  2646  1599 -14145.452   16  198 -14526.487 -6738.0029  53.6%  3734 1482s
  2814  1657 -12353.797   12  388 -14526.487 -6921.9049  52.3%  3704 1522s
  2947  1747 -12851.687   15  214 -14526.487 -6921.9049  52.3%  3710 1560s
  3088  1875 -13189.757   18  398 -14526.487 -7090.7626  51.2%  3713 1604s
  3251  1948 -14226.821   32  141 -14526.487 -7090.7626  51.2%  3694 1652s
  3423  2020     cutoff   18      -14526.487 -7090.7626  51.2%  3673 1689s
H 3480  2020                    -14522.20579 -7090.7626  51.2%  3669 1689s
  3547  2094 infeasible   17      -14522.206 -7090.7626  51.2%  3662 1737s
  3725  2181 -9673.7187   15  281 -14522.206 -7343.1185  49.4%  3668 1786s
  3917  2269 -10810.794   17  468 -14522.206 -7343.1185  49.4%  3663 1839s
  4050  2387 -11281.412   19  427 -14522.206 -7486.5943  48.4%  3715 1894s
  4246  2388 -10639.979   14  530 -14522.206 -7486.5943  48.4%  3714 2026s
  4248  2389 -13386.245   20  259 -14522.206 -7486.5943  48.4%  3712 2042s
  4249  2390 -12992.082   39  451 -14522.206 -7486.5943  48.4%  3712 2095s
  4250  2391 -9203.7621   10  459 -14522.206 -7486.5943  48.4%  3711 2149s
  4251  2391 -13531.542   37  488 -14522.206 -7486.5943  48.4%  3710 2177s
  4252  2392 -12819.227   29  487 -14522.206 -7486.5943  48.4%  3709 2205s
  4253  2393 -12769.739   38  477 -14522.206 -7486.5943  48.4%  3708 2221s
  4254  2393 -12764.014   23  563 -14522.206 -7486.5943  48.4%  3707 2232s
  4255  2394 -13626.170   39  561 -14522.206 -7486.5943  48.4%  3706 2240s
  4256  2395 -14299.470   31  571 -14522.206 -7486.5943  48.4%  3706 2250s
  4257  2395 -10558.984   12  509 -14522.206 -7486.5943  48.4%  3705 2258s
  4258  2396 -8313.5087   13  536 -14522.206 -7486.5943  48.4%  3704 2264s
  4259  2397 -12769.235   28  473 -14522.206 -7486.5943  48.4%  3703 2271s
  4260  2397 -13181.558   30  476 -14522.206 -7486.5943  48.4%  3702 2275s
  4262  2399 -11003.353   20  529 -14522.206 -7486.5943  48.4%  3700 2301s
  4263  2399 -12650.344   40  532 -14522.206 -7486.5943  48.4%  3699 2307s
  4264  2400 -8716.2969   19  525 -14522.206 -7486.5943  48.4%  3699 2311s
  4266  2401 -12200.741   19  523 -14522.206 -7486.5943  48.4%  3697 2318s
  4267  2402 -7828.6912   12  517 -14522.206 -7486.5943  48.4%  3696 2335s
  4269  2403 -12832.414   24  511 -14522.206 -7486.5943  48.4%  3694 2344s
  4270  2404 -14051.611   35  522 -14522.206 -7486.5943  48.4%  3693 2354s
  4271  2405 -14129.471   57  517 -14522.206 -7486.5943  48.4%  3693 2358s
  4272  2405 -9779.4298   16  514 -14522.206 -7486.5943  48.4%  3692 2364s
  4273  2406 -11505.310   32  524 -14522.206 -7486.5943  48.4%  3691 2378s
  4274  2407 -13295.337   19  577 -14522.206 -7486.5943  48.4%  3690 2385s
  4275  2407 -11763.649   22  590 -14522.206 -7486.5943  48.4%  3689 2397s
  4276  2408 -13706.956   20  587 -14522.206 -7486.5943  48.4%  3688 2402s
  4277  2409 -12920.164   25  584 -14522.206 -7486.5943  48.4%  3687 2409s
  4278  2409 -12669.994   15  519 -14522.206 -7486.5943  48.4%  3686 2419s
  4279  2410 -13293.446   31  543 -14522.206 -7486.5943  48.4%  3686 2426s
  4280  2411 -8393.3451    7  571 -14522.206 -7486.5943  48.4%  3685 2436s
  4281  2411 -8278.4565   13  518 -14522.206 -7486.5943  48.4%  3684 2442s
  4282  2412 -11998.330   18  504 -14522.206 -7486.5943  48.4%  3683 2451s
  4283  2413 -11803.921    8  515 -14522.206 -7486.5943  48.4%  3682 2457s
  4284  2413 -12471.215   34  519 -14522.206 -7486.5943  48.4%  3681 2465s
  4285  2414 -11738.968   32  519 -14522.206 -7486.5943  48.4%  3680 2482s
  4286  2415 -13679.490   38  519 -14522.206 -7486.5943  48.4%  3680 2521s
  4287  2417 -7486.5943   13  452 -14522.206 -7486.5943  48.4%  3749 2550s
  4288  2420 -7486.5943   14  484 -14522.206 -7486.5943  48.4%  3751 2579s
  4291  2425 -7486.5943   15  478 -14522.206 -7486.5943  48.4%  3753 2612s
  4297  2435 -7486.5943   16  462 -14522.206 -7486.5943  48.4%  3765 2665s
  4309  2443 -8166.0588   16  560 -14522.206 -7486.5943  48.4%  3798 3306s
  4321  2471 -8932.3123   18  292 -14522.206 -7486.5943  48.4%  3876 3511s
  4353  2565 -9649.5992   19  423 -14522.206 -7486.5943  48.4%  4007 3568s
  4462  2559 -11909.145   21  428 -14522.206 -7486.5943  48.4%  4153 3595s
  4494  2559 -9672.3470   20  420 -14522.206 -7486.5943  48.4%  4184 3600s

Cutting planes:
  Learned: 2
  Gomory: 7
  Implied bound: 8
  Projected implied bound: 106
  MIR: 1188
  Mixing: 3
  Flow cover: 1623
  RLT: 33
  Relax-and-lift: 194

Explored 4505 nodes (19224379 simplex iterations) in 3600.06 seconds (5392.49 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14522.2 -14526.5 -14531.8 ... -16283.3

Time limit reached
Best objective -1.452220579379e+04, best bound -7.486594285223e+03, gap 48.4473%
  WARNING: Time limit reached. Using best solution found (gap: 48.45%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -14522.21, θ = 132361.96
  Upper Bound (UB) = -14522.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 132361.96
  [DEBUG]   ✓ Scenario 0: θ = 132361.96 ≤ Q = 132361.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 132361.96 ≤ Q = 132361.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 132361.96 ≤ Q = 132361.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 132361.96 ≤ Q = 132361.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 132361.96 ≤ Q = 132361.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 132361.96 ≤ Q = 132361.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 132361.96 ≤ Q = 132361.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 132361.96 ≤ Q = 132361.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 132361.96 ≤ Q = 132361.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 132361.96 ≤ Q = 132361.96 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3f94766b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3f94766b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.207054e+13
Presolve removed 2612 rows and 1902 columns
Presolve time: 0.01s
Presolved: 481 rows, 487 columns, 1358 nonzeros
Found heuristic solution: objective 5213885.4165
Variable types: 329 continuous, 158 integer (158 binary)
Found heuristic solution: objective 5213006.8534

Root relaxation: objective -1.557010e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155701.04    0  123 5213006.85 -155701.04   103%     -    0s
H    0     0                    -118977.4911 -155701.04  30.9%     -    0s
H    0     0                    -119650.3601 -155701.04  30.1%     -    0s
H    0     0                    -129520.2877 -155701.04  20.2%     -    0s
     0     0 -133707.85    0   26 -129520.29 -133707.85  3.23%     -    0s
H    0     0                    -132805.5113 -133618.33  0.61%     -    0s
H    0     0                    -133007.4937 -133246.16  0.18%     -    0s
     0     0 -133246.16    0   29 -133007.49 -133246.16  0.18%     -    0s
     0     0 -133215.40    0   16 -133007.49 -133215.40  0.16%     -    0s
     0     0 -133215.36    0   16 -133007.49 -133215.36  0.16%     -    0s
     0     0 -133182.93    0    3 -133007.49 -133182.93  0.13%     -    0s
H    0     0                    -133092.0464 -133182.87  0.07%     -    0s
     0     0 -133181.32    0    3 -133092.05 -133181.32  0.07%     -    0s
H    0     0                    -133093.7866 -133181.32  0.07%     -    0s
     0     0 -133163.74    0    4 -133093.79 -133163.74  0.05%     -    0s
     0     0 -133163.74    0   20 -133093.79 -133163.74  0.05%     -    0s
     0     0 -133163.74    0   19 -133093.79 -133163.74  0.05%     -    0s
H    0     0                    -133133.9258 -133163.74  0.02%     -    0s
     0     0          -    0      -133133.93 -133145.45  0.01%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 13
  Flow cover: 2
  RLT: 10

Explored 1 nodes (506 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -133134 -133094 -133007 ... 1.20705e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.331339257613e+05, best bound -1.331454496587e+05, gap 0.0087%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 120680.96
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133133.93
  [DEBUG]   S×d_nominal = 253814.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253814.89 + -133133.93 = 120680.96
  [DEBUG]   Current θ from Master = 132361.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11681.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26203.21
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2303.5878, Absolute Gap = 2303.5878, Relative Gap = 0.158625
  Not converged yet (gap = 2303.59 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x0953edeb
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 2.74s
Presolved: 91803 rows, 39330 columns, 558599 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -390280.4906
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 620
 AA' NZ     : 3.165e+06
 Factor NZ  : 7.259e+06 (roughly 110 MB of memory)
 Factor Ops : 1.301e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.50592325e+07  1.79088976e+08  9.15e+04 1.94e+01  7.20e+04     4s
   1  -1.13115003e+07  1.53451972e+08  6.23e+04 8.00e+01  4.83e+04     5s
   2  -4.90174752e+06  1.14941024e+08  2.60e+04 5.48e-01  2.09e+04     5s
   3  -1.03501660e+06  8.56613526e+07  3.03e+03 2.13e+00  2.79e+03     5s
   4  -5.28177377e+05  5.44254040e+07  4.72e+02 9.25e-01  6.57e+02     5s
   5  -4.34383914e+05  2.64766656e+07  1.90e+02 3.52e-01  2.77e+02     5s
   6  -3.75526128e+05  1.92164929e+07  9.48e+01 2.38e-01  1.69e+02     5s
   7  -2.44760861e+05  1.48263843e+07  2.02e+01 1.74e-01  9.95e+01     5s
   8  -1.54704273e+05  1.01207900e+07  5.90e+00 1.15e-01  6.32e+01     5s
   9  -1.10721802e+05  5.50177494e+06  3.12e+00 6.10e-02  3.40e+01     5s
  10  -9.22430223e+04  1.97667297e+06  1.82e+00 2.11e-02  1.24e+01     5s
  11  -6.47653128e+04  9.31294562e+05  7.66e-01 9.91e-03  5.95e+00     5s
  12  -4.35499214e+04  5.35000387e+05  4.18e-01 5.79e-03  3.45e+00     6s
  13  -3.78663087e+04  3.42087188e+05  2.97e-01 3.63e-03  2.26e+00     6s
  14  -2.76643917e+04  1.93971304e+05  1.69e-01 2.12e-03  1.32e+00     6s
  15  -2.31664736e+04  1.35566511e+05  1.36e-01 1.63e-03  9.43e-01     6s
  16  -1.70678860e+04  8.59372928e+04  1.04e-01 1.72e-03  6.12e-01     6s
  17  -1.31310761e+04  7.37955924e+04  8.59e-02 1.44e-03  5.16e-01     6s
  18  -8.62266225e+03  5.59216480e+04  6.76e-02 1.63e-03  3.83e-01     6s
  19  -4.54899673e+03  4.74422489e+04  5.25e-02 1.14e-03  3.09e-01     6s
  20  -1.81236963e+03  4.57010153e+04  4.27e-02 1.08e-03  2.82e-01     6s
  21   4.92017663e+02  3.37552464e+04  3.46e-02 7.35e-04  1.98e-01     6s
  22   2.46998606e+03  2.97133649e+04  2.85e-02 5.95e-04  1.62e-01     7s
  23   4.67124995e+03  2.52608481e+04  2.15e-02 7.55e-04  1.22e-01     7s
  24   6.08299062e+03  2.26916127e+04  1.74e-02 6.47e-04  9.86e-02     7s
  25   7.32776462e+03  2.11293328e+04  1.38e-02 5.47e-04  8.20e-02     7s
  26   7.99596087e+03  1.93546239e+04  1.19e-02 4.61e-04  6.75e-02     7s
  27   8.69977928e+03  1.73536432e+04  9.93e-03 3.31e-04  5.14e-02     7s
  28   9.54997948e+03  1.64180317e+04  7.60e-03 2.59e-04  4.08e-02     7s
  29   1.02366200e+04  1.54537872e+04  5.77e-03 1.95e-04  3.10e-02     7s
  30   1.06590958e+04  1.50219724e+04  4.70e-03 1.63e-04  2.59e-02     8s
  31   1.08345656e+04  1.45654381e+04  4.28e-03 1.31e-04  2.22e-02     8s
  32   1.12763994e+04  1.43720020e+04  3.21e-03 1.18e-04  1.84e-02     8s
  33   1.15008239e+04  1.39469108e+04  2.67e-03 8.97e-05  1.45e-02     8s
  34   1.18774590e+04  1.35831483e+04  1.81e-03 6.23e-05  1.01e-02     8s
  35   1.19578412e+04  1.34120592e+04  1.63e-03 5.14e-05  8.64e-03     8s
  36   1.19816265e+04  1.33749869e+04  1.58e-03 4.89e-05  8.28e-03     8s
  37   1.20420587e+04  1.32951499e+04  1.43e-03 4.32e-05  7.44e-03     9s
  38   1.22267568e+04  1.32348172e+04  1.02e-03 3.87e-05  5.99e-03     9s
  39   1.23725170e+04  1.29217776e+04  6.97e-04 7.65e-05  3.26e-03     9s
  40   1.24924480e+04  1.28350560e+04  4.39e-04 4.45e-05  2.03e-03     9s
  41   1.25549349e+04  1.27800345e+04  3.08e-04 2.50e-05  1.34e-03     9s
  42   1.25697552e+04  1.27727332e+04  2.76e-04 2.25e-05  1.21e-03     9s
  43   1.25791220e+04  1.27594656e+04  2.56e-04 1.75e-05  1.07e-03     9s
  44   1.26421143e+04  1.27380334e+04  1.30e-04 1.31e-05  5.70e-04     9s
  45   1.26510563e+04  1.27235677e+04  1.12e-04 7.16e-06  4.31e-04    10s
  46   1.26600152e+04  1.27205332e+04  9.46e-05 5.68e-06  3.60e-04    10s
  47   1.26728653e+04  1.27162658e+04  6.90e-05 3.45e-06  2.58e-04    10s
  48   1.26823522e+04  1.27136960e+04  5.08e-05 2.20e-06  1.86e-04    10s
  49   1.27006477e+04  1.27102303e+04  1.58e-05 3.58e-07  5.69e-05    10s
  50   1.27088648e+04  1.27092572e+04  2.98e-07 2.05e-07  2.33e-06    10s
  51   1.27090807e+04  1.27091093e+04  6.46e-09 2.72e-08  1.69e-07    10s
  52   1.27090851e+04  1.27090852e+04  1.11e-09 1.29e-09  4.90e-10    10s

Barrier solved model in 52 iterations and 10.46 seconds (8.35 work units)
Optimal objective 1.27090851e+04


Root crossover log...

   78566 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    4884 PPushes remaining with PInf 4.0226787e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0691103e+02     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38884    1.2709085e+04   0.000000e+00   1.069110e+02     14s
   38938    1.2709085e+04   0.000000e+00   0.000000e+00     14s
   38938    1.2709085e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 1.270909e+04, 38938 iterations, 10.83 seconds (11.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12709.0852    0  286 -201902.96 12709.0852   106%     -   15s
H    0     0                    -192658.2263 12709.0852   107%     -   15s
H    0     0                    -157871.6544 12709.0852   108%     -   15s
H    0     0                    -155508.0672 12709.0852   108%     -   15s
H    0     0                    -153135.0944 12709.0852   108%     -   15s
H    0     0                    -72057.88147 12709.0852   118%     -   15s
H    0     0                    -46638.33659 12709.0852   127%     -   16s
H    0     0                    -46058.52613 12709.0852   128%     -   16s
H    0     0                    -44761.79645 12709.0852   128%     -   16s
H    0     0                    -41003.66541 12709.0852   131%     -   18s
H    0     0                    -39284.29203 12709.0852   132%     -   18s
H    0     0                    -38471.66248 12709.0852   133%     -   18s
H    0     0                    -37066.22187 5554.94759   115%     -   65s
H    0     0                    -28872.30744 5554.94759   119%     -   65s
     0     0 5416.19614    0  396 -28872.307 5416.19614   119%     -   66s
H    0     0                    -28869.89166 5416.19614   119%     -   67s
     0     0 4906.97327    0  416 -28869.892 4906.97327   117%     -   84s
     0     0 4905.82836    0  419 -28869.892 4905.82836   117%     -   99s
     0     0 4881.66590    0  427 -28869.892 4881.66590   117%     -  109s
     0     0 4880.00913    0  416 -28869.892 4880.00913   117%     -  110s
     0     0 4878.88252    0  419 -28869.892 4878.88252   117%     -  112s
     0     0 4877.98334    0  418 -28869.892 4877.98334   117%     -  113s
     0     0 4877.81528    0  418 -28869.892 4877.81528   117%     -  115s
H    0     0                    -28753.17782 2122.08501   107%     -  166s
H    0     0                    -28502.53426 2122.08501   107%     -  166s
     0     0 2122.08501    0  477 -28502.534 2122.08501   107%     -  166s
H    0     0                    -19589.76337 2121.95187   111%     -  167s
     0     0 1676.81448    0  489 -19589.763 1676.81448   109%     -  204s
     0     0 1554.78097    0  480 -19589.763 1554.78097   108%     -  218s
     0     0 1432.98622    0  504 -19589.763 1432.98622   107%     -  239s
     0     0 1391.99784    0  514 -19589.763 1391.99784   107%     -  248s
     0     0 1265.60561    0  485 -19589.763 1265.60561   106%     -  260s
     0     0 1245.78033    0  500 -19589.763 1245.78033   106%     -  265s
     0     0 1242.47779    0  494 -19589.763 1242.47779   106%     -  268s
     0     0 1229.72112    0  492 -19589.763 1229.72112   106%     -  271s
     0     0 1218.05394    0  496 -19589.763 1218.05394   106%     -  275s
     0     0 1167.40165    0  493 -19589.763 1167.40165   106%     -  282s
     0     0 1162.83714    0  502 -19589.763 1162.83714   106%     -  285s
     0     0 1162.00924    0  512 -19589.763 1162.00924   106%     -  286s
     0     0 -1104.3814    0  492 -19589.763 -1104.3814  94.4%     -  371s
H    0     0                    -18384.55629 -1104.4598  94.0%     -  372s
H    0     0                    -18308.45678 -1104.4598  94.0%     -  372s
H    0     0                    -18050.59728 -1412.1253  92.2%     -  409s
H    0     0                    -17791.14317 -1412.1253  92.1%     -  410s
     0     0 -1412.1253    0  524 -17791.143 -1412.1253  92.1%     -  410s
     0     0 -1614.1029    0  583 -17791.143 -1614.1029  90.9%     -  437s
     0     0 -1763.9184    0  552 -17791.143 -1763.9184  90.1%     -  464s
     0     0 -2175.3181    0  604 -17791.143 -2175.3181  87.8%     -  489s
     0     0 -2336.6789    0  585 -17791.143 -2336.6789  86.9%     -  508s
     0     0 -2378.4800    0  588 -17791.143 -2378.4800  86.6%     -  514s
     0     0 -2399.1561    0  597 -17791.143 -2399.1561  86.5%     -  522s
     0     0 -2415.4562    0  591 -17791.143 -2415.4562  86.4%     -  527s
     0     0 -2487.6406    0  593 -17791.143 -2487.6406  86.0%     -  535s
     0     0 -2490.5567    0  600 -17791.143 -2490.5567  86.0%     -  538s
     0     0 -2493.6672    0  597 -17791.143 -2493.6672  86.0%     -  542s
     0     0 -2494.0975    0  605 -17791.143 -2494.0975  86.0%     -  543s
H    0     0                    -17545.86712 -2494.0975  85.8%     -  555s
H    0     0                    -17357.79328 -2494.0975  85.6%     -  555s
     0     0 -3509.6469    0  495 -17357.793 -3509.6469  79.8%     -  596s
     0     0 -3853.6754    0  521 -17357.793 -3853.6754  77.8%     -  619s
H    0     0                    -17345.49219 -3961.1033  77.2%     -  628s
     0     0 -3961.1033    0  519 -17345.492 -3961.1033  77.2%     -  628s
     0     0 -3977.7054    0  517 -17345.492 -3977.7054  77.1%     -  632s
     0     0 -4019.3783    0  535 -17345.492 -4019.3783  76.8%     -  638s
     0     0 -4043.1374    0  533 -17345.492 -4043.1374  76.7%     -  642s
     0     0 -4050.4328    0  547 -17345.492 -4050.4328  76.6%     -  646s
     0     0 -4093.3980    0  536 -17345.492 -4093.3980  76.4%     -  650s
     0     0 -4107.4017    0  538 -17345.492 -4107.4017  76.3%     -  654s
     0     0 -4117.3397    0  543 -17345.492 -4117.3397  76.3%     -  658s
     0     0 -4125.4366    0  537 -17345.492 -4125.4366  76.2%     -  660s
     0     0 -4131.3179    0  532 -17345.492 -4131.3179  76.2%     -  662s
     0     0 -4137.1312    0  543 -17345.492 -4137.1312  76.1%     -  664s
     0     0 -4143.4966    0  542 -17345.492 -4143.4966  76.1%     -  667s
H    0     0                    -17322.61372 -4146.4305  76.1%     -  669s
H    0     0                    -17179.15934 -4146.4305  75.9%     -  669s
H    0     0                    -16342.77958 -4146.4305  74.6%     -  669s
     0     0 -4146.4305    0  547 -16342.780 -4146.4305  74.6%     -  669s
     0     0 -4157.1709    0  547 -16342.780 -4157.1709  74.6%     -  672s
     0     0 -4166.9477    0  554 -16342.780 -4166.9477  74.5%     -  674s
     0     0 -4167.6117    0  544 -16342.780 -4167.6117  74.5%     -  675s
     0     0 -4337.9058    0  518 -16342.780 -4337.9058  73.5%     -  687s
H    0     0                    -16335.13740 -4338.2645  73.4%     -  688s
     0     0 -4417.2082    0  531 -16335.137 -4417.2082  73.0%     -  694s
     0     0 -4451.1791    0  533 -16335.137 -4451.1791  72.8%     -  700s
     0     0 -4460.2799    0  532 -16335.137 -4460.2799  72.7%     -  703s
     0     0 -4466.4052    0  534 -16335.137 -4466.4052  72.7%     -  704s
     0     0 -4473.3266    0  531 -16335.137 -4473.3266  72.6%     -  707s
     0     0 -4477.6102    0  533 -16335.137 -4477.6102  72.6%     -  708s
     0     0 -4478.6587    0  540 -16335.137 -4478.6587  72.6%     -  709s
     0     0 -4649.7579    0  510 -16335.137 -4649.7579  71.5%     -  722s
H    0     0                    -16326.24873 -4650.2835  71.5%     -  729s
H    0     0                    -16224.73375 -4650.2835  71.3%     -  729s
H    0     0                    -16212.43266 -4650.2835  71.3%     -  731s
     0     0 -4695.2511    0  607 -16212.433 -4695.2511  71.0%     -  737s
     0     0 -4710.0994    0  578 -16212.433 -4710.0994  70.9%     -  741s
     0     0 -4714.7625    0  576 -16212.433 -4714.7625  70.9%     -  743s
     0     0 -4718.2869    0  580 -16212.433 -4718.2869  70.9%     -  744s
     0     0 -4724.6472    0  639 -16212.433 -4724.6472  70.9%     -  746s
     0     0 -4726.8753    0  641 -16212.433 -4726.8753  70.8%     -  748s
     0     0 -4767.2118    0  567 -16212.433 -4767.2118  70.6%     -  754s
     0     0 -4772.8791    0  504 -16212.433 -4772.8791  70.6%     -  757s
     0     0 -4773.8429    0  567 -16212.433 -4773.8429  70.6%     -  758s
     0     0 -4808.7879    0  575 -16212.433 -4808.7879  70.3%     -  763s
H    0     0                    -16095.01701 -4808.9757  70.1%     -  766s
     0     0 -4815.3563    0  468 -16095.017 -4815.3563  70.1%     -  770s
     0     0 -4817.7431    0  539 -16095.017 -4817.7431  70.1%     -  771s
H    0     0                    -15970.65425 -4817.7431  69.8%     -  773s
     0     0 -4849.3084    0  528 -15970.654 -4849.3084  69.6%     -  778s
H    0     0                    -15902.00327 -4850.0073  69.5%     -  778s
H    0     0                    -15889.70218 -4850.0073  69.5%     -  778s
     0     0 -4860.7933    0  577 -15889.702 -4860.7933  69.4%     -  782s
     0     0 -4862.1488    0  530 -15889.702 -4862.1488  69.4%     -  784s
     0     0 -4865.5518    0  481 -15889.702 -4865.5518  69.4%     -  788s
H    0     0                    -15885.27035 -4866.3761  69.4%     -  797s
H    0     0                    -15860.52378 -4866.3761  69.3%     -  797s
     0     0 -4866.3761    0  476 -15860.524 -4866.3761  69.3%     -  801s
     0     0 -4870.8609    0  474 -15860.524 -4870.8609  69.3%     -  805s
     0     0 -4873.2069    0  526 -15860.524 -4873.2069  69.3%     -  806s
     0     0 -4874.0615    0  481 -15860.524 -4874.0615  69.3%     -  810s
     0     0 -4874.2085    0  481 -15860.524 -4874.2085  69.3%     -  814s
     0     2 -4874.3825    0  481 -15860.524 -4874.3825  69.3%     -  978s
     1     4 -5025.8240    1  469 -15860.524 -4874.7003  69.3%  5133  993s
     3     8 -5062.3732    2  477 -15860.524 -5025.8379  68.3%  7252 1007s
     7    15 -5138.1136    3  463 -15860.524 -5063.0884  68.1%  7651 1049s
    14    30 -5216.9950    4  514 -15860.524 -5068.8779  68.0%  9982 1077s
    29    45 -6066.6102    5  377 -15860.524 -5217.2482  67.1% 13986 1122s
    44    77 -6462.9449    6  356 -15860.524 -5217.2482  67.1% 15868 1297s
    76   172 -7326.9550    7  326 -15860.524 -5403.5570  65.9% 14587 1353s
   183   204 -7443.6786   10  383 -15860.524 -5404.5778  65.9%  9278 1366s
H  194   204                    -15804.74269 -5404.5778  65.8%  9099 1366s
   215   266 -7948.0756   11  390 -15804.743 -5404.5778  65.8%  8999 1389s
   281   298 -8474.2938   13  330 -15804.743 -5404.5778  65.8%  8220 1405s
   313   327 -8497.8111   14  280 -15804.743 -5404.5778  65.8%  8056 1428s
   344   367 -8598.1468   15  319 -15804.743 -5404.5778  65.8%  7775 1448s
   384   405 -8737.0827   16  313 -15804.743 -5404.5778  65.8%  7417 1467s
   430   452 -8826.2416   17  312 -15804.743 -5404.5778  65.8%  7183 1490s
   481   501 -8860.3849   18  386 -15804.743 -5404.5778  65.8%  6887 1518s
H  493   501                    -15804.43844 -5404.5778  65.8%  6881 1518s
   536   568 -9120.1719   19  329 -15804.438 -5404.5778  65.8%  6801 1535s
   624   631 -9493.6582   21  214 -15804.438 -5404.5778  65.8%  6560 1552s
   715   698 -10382.276   24  286 -15804.438 -5404.5778  65.8%  6401 1569s
   817   738 -10655.145   26  361 -15804.438 -5404.5778  65.8%  6139 1588s
   906   798 -10981.463   28  262 -15804.438 -5404.5778  65.8%  5956 1606s
   982   848 -11434.826   30  321 -15804.438 -5404.5778  65.8%  5994 1624s
  1063   905 -11581.140   34  267 -15804.438 -5404.5778  65.8%  6018 1645s
  1145   952 -12053.996   37  312 -15804.438 -5404.5778  65.8%  6043 1663s
  1217  1004 -12979.977   40  247 -15804.438 -5404.5778  65.8%  6130 1683s
  1291  1059 -13243.821   48  216 -15804.438 -5404.5778  65.8%  6206 1704s
  1362  1119 -14419.639   54  161 -15804.438 -5425.8166  65.7%  6330 1724s
  1438  1193 -14867.472   58  250 -15804.438 -5425.8166  65.7%  6418 1744s
  1529  1263 infeasible   61      -15804.438 -5425.8166  65.7%  6441 1766s
  1622  1331 infeasible   65      -15804.438 -5425.8166  65.7%  6423 1787s
  1721  1416 -11268.281   14  206 -15804.438 -5425.8166  65.7%  6438 1809s
  1835  1507 -12342.312   17  183 -15804.438 -5425.8166  65.7%  6477 1833s
  1982  1590 -12638.597   19  228 -15804.438 -5425.8166  65.7%  6358 1860s
  2118  1650 -13495.681   24  277 -15804.438 -5425.8166  65.7%  6288 1884s
  2232  1734 -13765.989   29  107 -15804.438 -5425.8166  65.7%  6272 1912s
  2347  1799 -14285.306   35  105 -15804.438 -6122.2326  61.3%  6323 1938s
H 2373  1799                    -15761.65447 -6122.2326  61.2%  6291 1938s
  2430  1888 -14446.515   47  111 -15761.654 -6122.2326  61.2%  6312 1971s
  2541  1984 infeasible   53      -15761.654 -6122.2326  61.2%  6371 2000s
  2675  2073     cutoff   63      -15761.654 -6354.3724  59.7%  6340 2030s
  2820  2166 -8623.8415    9  316 -15761.654 -6354.3724  59.7%  6348 2067s
  2945  2242 -8795.0536   10  267 -15761.654 -6354.3724  59.7%  6421 2102s
  3090  2263 -10606.737   12  241 -15761.654 -6375.8572  59.5%  6439 2139s
  3131  2286 -10203.961   12  225 -15761.654 -6375.8572  59.5%  6469 2168s
H 3146  2147                    -15184.17339 -6375.8572  58.0%  6475 2168s
  3170  2231 -10375.547   13  220 -15184.173 -6375.8572  58.0%  6506 2209s
H 3328  2237                    -15122.86968 -6420.4695  57.5%  6523 2242s
H 3329  2203                    -15041.22594 -6420.4695  57.3%  6522 2242s
H 3350  2159                    -14932.14429 -6420.4695  57.0%  6551 2243s
  3367  2251 -11255.365   18  215 -14932.144 -6420.4695  57.0%  6568 2280s
  3560  2355 -11703.972   22  204 -14932.144 -6574.6929  56.0%  6544 2323s
  3736  2447     cutoff   24      -14932.144 -6574.6929  56.0%  6568 2366s
  3944  2567 -12240.419   25  181 -14932.144 -6574.6929  56.0%  6553 2415s
  4161  2568 -9322.5507   11  481 -14932.144 -6900.2451  53.8%  6496 2598s
H 4162  2440                    -14915.25611 -6900.2451  53.7%  6495 2613s
H 4162  2318                    -14875.85804 -6900.2451  53.6%  6495 2613s
  4163  2318 -12726.799   30  229 -14875.858 -6900.2451  53.6%  6493 2616s
  4164  2319 -14482.433   47  461 -14875.858 -6900.2451  53.6%  6492 2710s
  4165  2320 -11855.871   26  507 -14875.858 -6900.2451  53.6%  6490 2804s
  4166  2320 -10634.521   26  500 -14875.858 -6900.2451  53.6%  6489 2863s
  4167  2321 -10263.829    8  566 -14875.858 -6900.2451  53.6%  6487 2908s
  4168  2322 -14231.558   40  498 -14875.858 -6900.2451  53.6%  6485 2923s
  4169  2322 -13006.002   30  518 -14875.858 -6900.2451  53.6%  6484 2938s
  4170  2323 -14096.079   33  576 -14875.858 -6900.2451  53.6%  6482 2949s
  4171  2324 -8901.7729   11  578 -14875.858 -6900.2451  53.6%  6481 2958s
  4172  2324 -13346.260   33  498 -14875.858 -6900.2451  53.6%  6479 2968s
  4173  2325 -12203.034   29  493 -14875.858 -6900.2451  53.6%  6478 2973s
  4174  2326 -9297.6959   12  508 -14875.858 -6900.2451  53.6%  6476 2978s
  4175  2326 -10138.918   18  492 -14875.858 -6900.2451  53.6%  6475 2981s
  4176  2327 -11317.429   16  500 -14875.858 -6900.2451  53.6%  6473 2992s
  4177  2328 -10387.857   26  559 -14875.858 -6900.2451  53.6%  6472 2997s
  4178  2328 -9732.5446   10  461 -14875.858 -6900.2451  53.6%  6470 3001s
  4179  2329 -13924.443   24  448 -14875.858 -6900.2451  53.6%  6468 3013s
  4180  2330 -9528.2152   19  452 -14875.858 -6900.2451  53.6%  6467 3020s
  4182  2331 -7609.7952    9  451 -14875.858 -6900.2451  53.6%  6464 3028s
  4183  2332 -9836.9826   14  529 -14875.858 -6900.2451  53.6%  6462 3039s
  4184  2332 -8815.2482    9  493 -14875.858 -6900.2451  53.6%  6461 3043s
  4185  2333 -14848.963   24  522 -14875.858 -6900.2451  53.6%  6459 3049s
  4186  2334 -14413.924   64  445 -14875.858 -6900.2451  53.6%  6458 3058s
  4187  2334 -12262.446    9  508 -14875.858 -6900.2451  53.6%  6456 3061s
  4188  2335 -14747.756   27  505 -14875.858 -6900.2451  53.6%  6455 3067s
  4189  2336 -12662.828   29  500 -14875.858 -6900.2451  53.6%  6453 3078s
  4190  2336 -13355.437   30  552 -14875.858 -6900.2451  53.6%  6451 3083s
  4191  2337 -11495.464   24  550 -14875.858 -6900.2451  53.6%  6450 3094s
  4192  2338 -9994.5542   21  506 -14875.858 -6900.2451  53.6%  6448 3099s
  4193  2338 -14875.858   51  513 -14875.858 -6900.2451  53.6%  6447 3105s
  4194  2339 -10648.621   20  512 -14875.858 -6900.2451  53.6%  6445 3110s
  4195  2340 -12885.455   42  505 -14875.858 -6900.2451  53.6%  6444 3123s
  4196  2340 -10001.754   21  512 -14875.858 -6900.2451  53.6%  6442 3126s
  4197  2341 -14747.756   27  517 -14875.858 -6900.2451  53.6%  6441 3131s
  4198  2342 -12861.312   43  498 -14875.858 -6900.2451  53.6%  6439 3140s
  4200  2343 -14432.228   28  450 -14875.858 -6900.2451  53.6%  6436 3156s
  4201  2344 -14187.683   44  450 -14875.858 -6900.2451  53.6%  6435 3176s
  4202  2344 -9604.3971   16  450 -14875.858 -6900.2451  53.6%  6433 3227s
  4203  2347 -6900.2451   11  297 -14875.858 -6900.2451  53.6%  6515 3256s
  4204  2350 -6900.2451   12  295 -14875.858 -6900.2451  53.6%  6515 3280s
  4207  2355 -6900.2451   13  420 -14875.858 -6900.2451  53.6%  6517 3310s
  4213  2365 -7063.4998   14  431 -14875.858 -6900.2451  53.6%  6524 3331s
  4225  2373 -6900.2451   14  478 -14875.858 -6900.2451  53.6%  6540 3375s
  4237  2397 -7289.7432   15  560 -14875.858 -6900.2451  53.6%  6569 3485s
  4268  2437 -7598.5356   16  479 -14875.858 -6900.2451  53.6%  6664 3532s
H 4277  2316                    -14851.61663 -6900.2451  53.5%  6678 3532s
  4323  2358 -8212.9159   18  552 -14851.617 -6900.2451  53.5%  6732 3578s
  4390  2378 -8311.7466   18  552 -14851.617 -6970.7558  53.1%  6776 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 22
  Projected implied bound: 141
  MIR: 1073
  Flow cover: 1526
  RLT: 47
  Relax-and-lift: 243

Explored 4440 nodes (30786075 simplex iterations) in 3600.05 seconds (5830.30 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14851.6 -14875.9 -14915.3 ... -15804.7

Time limit reached
Best objective -1.485161663349e+04, best bound -6.975300154719e+03, gap 53.0334%
  WARNING: Time limit reached. Using best solution found (gap: 53.03%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -14851.62, θ = 128868.30
  Upper Bound (UB) = -14851.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128868.30
  [DEBUG]   ✓ Scenario 0: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128868.30 ≤ Q = 128868.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 128868.30 ≤ Q = 128868.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 128868.30 ≤ Q = 128868.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7189bba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf8e76446
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.180245e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5176865.8307
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.530998e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153099.85    0  126 5176865.83 -153099.85   103%     -    0s
H    0     0                    -117968.3574 -153099.85  29.8%     -    0s
H    0     0                    -118750.2041 -153099.85  28.9%     -    0s
     0     0 -128977.11    0   60 -118750.20 -128977.11  8.61%     -    0s
H    0     0                    -126922.9082 -128952.17  1.60%     -    0s
H    0     0                    -127944.2711 -128952.17  0.79%     -    0s
     0     0 -128896.90    0   58 -127944.27 -128896.90  0.74%     -    0s
     0     0 -128636.53    0   46 -127944.27 -128636.53  0.54%     -    0s
     0     0 -128622.18    0   42 -127944.27 -128622.18  0.53%     -    0s
     0     0 -128469.45    0   44 -127944.27 -128469.45  0.41%     -    0s
     0     0 -128407.14    0   44 -127944.27 -128407.14  0.36%     -    0s
     0     0 -128407.14    0   75 -127944.27 -128407.14  0.36%     -    0s
H    0     0                    -127964.9339 -128407.14  0.35%     -    0s
     0     0 -128407.14    0   43 -127964.93 -128407.14  0.35%     -    0s
     0     0 -128373.35    0   41 -127964.93 -128373.35  0.32%     -    0s
     0     0 -128370.99    0   41 -127964.93 -128370.99  0.32%     -    0s
     0     0 -128363.56    0   40 -127964.93 -128363.56  0.31%     -    0s
     0     0 -128363.49    0   40 -127964.93 -128363.49  0.31%     -    0s
H    0     0                    -127966.5115 -128363.49  0.31%     -    0s
     0     0 -128222.98    0   12 -127966.51 -128222.98  0.20%     -    0s
     0     0 -128192.00    0   12 -127966.51 -128192.00  0.18%     -    0s
     0     0 -128192.00    0   13 -127966.51 -128192.00  0.18%     -    0s
     0     0 -128107.96    0   12 -127966.51 -128107.96  0.11%     -    0s
     0     0 -128107.96    0   17 -127966.51 -128107.96  0.11%     -    0s
H    0     0                    -127991.5089 -128107.96  0.09%     -    0s
     0     0 -128036.67    0    2 -127991.51 -128036.67  0.04%     -    0s
H    0     0                    -128036.4149 -128036.41  0.00%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 3
  MIR: 2
  Flow cover: 6
  Relax-and-lift: 3

Explored 1 nodes (1046 simplex iterations) in 0.31 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128036 -127992 -127967 ... 1.18024e+13
No other solutions better than -128036

Optimal solution found (tolerance 1.00e-04)
Best objective -1.280364149199e+05, best bound -1.280364149199e+05, gap 0.0000%
  Subproblem solved in 0.34s
  Worst-case operational profit (Z_SP) = 120173.96
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128036.41
  [DEBUG]   S×d_nominal = 248210.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 248210.38 + -128036.41 = 120173.96
  [DEBUG]   Current θ from Master = 128868.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8694.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23545.95
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 1974.1770, Absolute Gap = 1974.1770, Relative Gap = 0.132927
  Not converged yet (gap = 1974.18 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0xd6133a6b
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 2.80s
Presolved: 100023 rows, 42700 columns, 606167 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -389255.3788
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 611
 AA' NZ     : 3.649e+06
 Factor NZ  : 8.491e+06 (roughly 130 MB of memory)
 Factor Ops : 1.584e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.54166806e+07  1.93954164e+08  9.35e+04 1.84e+01  7.41e+04     5s
   1  -1.16590790e+07  1.66923468e+08  6.36e+04 7.96e+01  4.98e+04     5s
   2  -5.01757664e+06  1.25777915e+08  2.64e+04 5.74e-01  2.14e+04     5s
   3  -9.05634859e+05  9.32357549e+07  2.14e+03 1.28e+00  2.14e+03     5s
   4  -5.36719637e+05  4.82201485e+07  4.13e+02 3.19e-01  5.51e+02     5s
   5  -4.50429914e+05  2.66761185e+07  1.80e+02 1.38e-01  2.58e+02     5s
   6  -3.78155377e+05  2.02356471e+07  7.45e+01 9.84e-02  1.54e+02     5s
   7  -2.95711613e+05  1.54056631e+07  2.77e+01 7.12e-02  9.92e+01     5s
   8  -2.02451510e+05  1.13419443e+07  7.03e+00 5.13e-02  6.58e+01     5s
   9  -1.30028829e+05  6.88169612e+06  3.12e+00 2.93e-02  3.91e+01     5s
  10  -1.01184573e+05  1.68191912e+06  1.64e+00 7.25e-03  9.86e+00     5s
  11  -8.24949345e+04  9.08615937e+05  1.18e+00 3.98e-03  5.46e+00     6s
  12  -5.48724365e+04  4.65126200e+05  6.76e-01 2.10e-03  2.85e+00     6s
  13  -4.49462229e+04  2.74994730e+05  4.90e-01 1.25e-03  1.75e+00     6s
  14  -3.15862652e+04  1.62707371e+05  2.73e-01 9.23e-04  1.06e+00     6s
  15  -2.45104370e+04  1.14764307e+05  2.01e-01 1.25e-03  7.61e-01     6s
  16  -1.71337123e+04  7.21329141e+04  1.46e-01 1.63e-03  4.88e-01     6s
  17  -1.43902530e+04  6.61970621e+04  1.28e-01 1.45e-03  4.40e-01     6s
  18  -1.15903325e+04  5.06532124e+04  1.10e-01 1.95e-03  3.40e-01     6s
  19  -5.42792926e+03  3.76256665e+04  7.54e-02 2.29e-03  2.35e-01     6s
  20  -2.14775698e+03  3.13886723e+04  5.91e-02 2.03e-03  1.83e-01     6s
  21   6.02323217e+02  2.65471733e+04  4.59e-02 2.41e-03  1.42e-01     6s
  22   2.09398228e+03  2.13555087e+04  3.92e-02 3.27e-03  1.05e-01     6s
  23   2.78587348e+03  2.00369220e+04  3.62e-02 2.85e-03  9.43e-02     7s
  24   4.44828781e+03  1.82589730e+04  2.87e-02 2.57e-03  7.55e-02     7s
  25   5.93910653e+03  1.69085720e+04  2.21e-02 2.08e-03  5.99e-02     7s
  26   6.21509370e+03  1.56435470e+04  2.10e-02 1.62e-03  5.15e-02     7s
  27   7.27794894e+03  1.46107239e+04  1.64e-02 1.21e-03  4.01e-02     7s
  28   7.70700862e+03  1.39687711e+04  1.45e-02 9.72e-04  3.42e-02     7s
  29   8.05978275e+03  1.36626308e+04  1.31e-02 8.64e-04  3.06e-02     7s
  30   8.65609164e+03  1.34344996e+04  1.05e-02 7.87e-04  2.61e-02     7s
  31   8.73203189e+03  1.31313680e+04  1.02e-02 6.84e-04  2.40e-02     8s
  32   9.21971103e+03  1.26728140e+04  8.12e-03 5.18e-04  1.89e-02     8s
  33   9.49155952e+03  1.23804373e+04  6.99e-03 4.19e-04  1.58e-02     8s
  34   9.75604882e+03  1.21695449e+04  5.90e-03 3.39e-04  1.32e-02     8s
  35   1.02220864e+04  1.20489087e+04  3.98e-03 2.95e-04  9.98e-03     8s
  36   1.03888800e+04  1.17832246e+04  3.30e-03 1.98e-04  7.62e-03     8s
  37   1.04694785e+04  1.16268152e+04  2.96e-03 1.38e-04  6.32e-03     8s
  38   1.07076520e+04  1.16055538e+04  2.05e-03 1.30e-04  4.91e-03     8s
  39   1.07648975e+04  1.15523134e+04  1.82e-03 1.11e-04  4.30e-03     9s
  40   1.08371833e+04  1.15228772e+04  1.52e-03 9.97e-05  3.75e-03     9s
  41   1.08831780e+04  1.14516127e+04  1.34e-03 7.51e-05  3.11e-03     9s
  42   1.09760471e+04  1.14157111e+04  9.77e-04 6.18e-05  2.40e-03     9s
  43   1.10524151e+04  1.14003758e+04  6.85e-04 5.61e-05  1.90e-03     9s
  44   1.11148223e+04  1.13734073e+04  4.41e-04 4.62e-05  1.41e-03     9s
  45   1.11480635e+04  1.13240984e+04  3.28e-04 2.74e-05  9.61e-04     9s
  46   1.11919632e+04  1.12938531e+04  1.83e-04 1.57e-05  5.56e-04     9s
  47   1.12091740e+04  1.12904484e+04  1.29e-04 1.45e-05  4.44e-04    10s
  48   1.12277052e+04  1.12744191e+04  7.04e-05 8.41e-06  2.55e-04    10s
  49   1.12363536e+04  1.12580224e+04  4.31e-05 2.37e-06  1.18e-04    10s
  50   1.12398781e+04  1.12576569e+04  3.26e-05 2.24e-06  9.71e-05    10s
  51   1.12492776e+04  1.12523043e+04  5.32e-06 3.40e-07  1.65e-05    10s
  52   1.12511285e+04  1.12514017e+04  3.25e-07 5.63e-08  1.49e-06    10s
  53   1.12512719e+04  1.12512724e+04  1.33e-09 7.21e-08  2.81e-09    10s
  54   1.12512723e+04  1.12512723e+04  7.10e-08 5.89e-10  1.92e-10    10s

Barrier solved model in 54 iterations and 10.30 seconds (9.39 work units)
Optimal objective 1.12512723e+04


Root crossover log...

   85649 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    4486 PPushes remaining with PInf 3.3205517e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.1713619e+03     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40132    1.1251272e+04   0.000000e+00   9.171362e+03     14s
   40440    1.1251272e+04   0.000000e+00   0.000000e+00     15s
   40440    1.1251272e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.125127e+04, 40440 iterations, 11.27 seconds (13.68 work units)
Total elapsed time = 15.04s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11251.2723    0  283 -201902.96 11251.2723   106%     -   15s
H    0     0                    -196235.7434 11251.2723   106%     -   15s
H    0     0                    -116425.6721 11251.2723   110%     -   15s
H    0     0                    -97747.72120 11251.2723   112%     -   15s
H    0     0                    -93961.78219 11251.2723   112%     -   15s
H    0     0                    -93288.89218 11251.2723   112%     -   15s
H    0     0                    -86454.17299 11251.2723   113%     -   15s
H    0     0                    -54109.78920 11251.2723   121%     -   16s
H    0     0                    -53341.44402 11251.2723   121%     -   16s
H    0     0                    -52528.51048 11251.2723   121%     -   18s
H    0     0                    -52312.20597 11251.2723   122%     -   18s
H    0     0                    -52164.01834 11251.2723   122%     -   18s
H    0     0                    -46447.60044 5703.56052   112%     -   68s
H    0     0                    -36496.28529 5703.56052   116%     -   68s
H    0     0                    -36486.17103 5703.56052   116%     -   68s
H    0     0                    -36116.33314 5703.56052   116%     -   68s
     0     0 5692.53367    0  380 -36116.333 5692.53367   116%     -   68s
H    0     0                    -36001.98858 5692.53367   116%     -   69s
H    0     0                    -35711.96757 5692.53367   116%     -   69s
H    0     0                    -35588.68324 5692.53367   116%     -   69s
H    0     0                    -35356.04374 5692.53367   116%     -   69s
     0     0 5506.57740    0  377 -35356.044 5506.57740   116%     -   87s
     0     0 5489.14196    0  377 -35356.044 5489.14196   116%     -   90s
     0     0 5362.42953    0  377 -35356.044 5362.42953   115%     -   96s
     0     0 5351.00490    0  420 -35356.044 5351.00490   115%     -   99s
     0     0 5334.19907    0  379 -35356.044 5334.19907   115%     -  103s
     0     0 5288.41211    0  420 -35356.044 5288.41211   115%     -  116s
     0     0 5288.41211    0  418 -35356.044 5288.41211   115%     -  117s
     0     0 5288.41211    0  418 -35356.044 5288.41211   115%     -  119s
H    0     0                    -34378.06296 2051.63701   106%     -  187s
H    0     0                    -31927.35063 2051.63701   106%     -  187s
H    0     0                    -31603.41685 2051.63701   106%     -  187s
H    0     0                    -31533.59319 2051.63701   107%     -  187s
H    0     0                    -31510.39301 2051.63701   107%     -  187s
     0     0 2051.63701    0  425 -31510.393 2051.63701   107%     -  187s
H    0     0                    -27766.96303 2051.62202   107%     -  188s
H    0     0                    -27052.19328 2051.62202   108%     -  188s
H    0     0                    -26922.44341 2051.62202   108%     -  188s
     0     0 1452.44516    0  522 -26922.443 1452.44516   105%     -  250s
H    0     0                    -25267.59354 1256.96227   105%     -  281s
H    0     0                    -23442.06698 1256.96227   105%     -  281s
H    0     0                    -23101.91157 1256.96227   105%     -  281s
H    0     0                    -22983.38716 1256.96227   105%     -  281s
H    0     0                    -22903.31836 1256.96227   105%     -  281s
     0     0 1256.96227    0  490 -22903.318 1256.96227   105%     -  281s
     0     0 1219.46551    0  482 -22903.318 1219.46551   105%     -  295s
     0     0 1211.43146    0  492 -22903.318 1211.43146   105%     -  303s
     0     0 1171.84088    0  509 -22903.318 1171.84088   105%     -  319s
     0     0 1154.30920    0  503 -22903.318 1154.30920   105%     -  334s
     0     0 1125.03915    0  524 -22903.318 1125.03915   105%     -  344s
     0     0 1116.60874    0  517 -22903.318 1116.60874   105%     -  348s
     0     0 1082.32649    0  520 -22903.318 1082.32649   105%     -  360s
     0     0 1058.61001    0  521 -22903.318 1058.61001   105%     -  368s
     0     0 1035.07066    0  523 -22903.318 1035.07066   105%     -  374s
     0     0 1034.95738    0  522 -22903.318 1034.95738   105%     -  375s
H    0     0                    -20036.18787 -668.17791  96.7%     -  469s
     0     0 -668.17791    0  413 -20036.188 -668.17791  96.7%     -  469s
H    0     0                    -19906.43800 -1236.4718  93.8%     -  505s
H    0     0                    -19553.28948 -1236.4718  93.7%     -  505s
H    0     0                    -19516.48220 -1236.4718  93.7%     -  505s
     0     0 -1236.4718    0  474 -19516.482 -1236.4718  93.7%     -  506s
     0     0 -1680.2550    0  426 -19516.482 -1680.2550  91.4%     -  535s
     0     0 -1927.8864    0  528 -19516.482 -1927.8864  90.1%     -  560s
     0     0 -2011.6226    0  501 -19516.482 -2011.6226  89.7%     -  581s
     0     0 -2074.5898    0  521 -19516.482 -2074.5898  89.4%     -  594s
     0     0 -2118.9046    0  540 -19516.482 -2118.9046  89.1%     -  609s
     0     0 -2127.9109    0  490 -19516.482 -2127.9109  89.1%     -  614s
     0     0 -2137.7550    0  481 -19516.482 -2137.7550  89.0%     -  620s
     0     0 -2143.4248    0  530 -19516.482 -2143.4248  89.0%     -  624s
     0     0 -2163.9409    0  493 -19516.482 -2163.9409  88.9%     -  631s
     0     0 -2177.1806    0  542 -19516.482 -2177.1806  88.8%     -  635s
     0     0 -2181.2464    0  541 -19516.482 -2181.2464  88.8%     -  637s
     0     0 -2213.9317    0  481 -19516.482 -2213.9317  88.7%     -  642s
     0     0 -2221.0933    0  477 -19516.482 -2221.0933  88.6%     -  645s
     0     0 -2224.9304    0  474 -19516.482 -2224.9304  88.6%     -  648s
     0     0 -2225.1917    0  476 -19516.482 -2225.1917  88.6%     -  649s
H    0     0                    -18335.04896 -3428.2755  81.3%     -  702s
H    0     0                    -17809.40273 -3428.2755  80.8%     -  702s
     0     0 -3428.2755    0  615 -17809.403 -3428.2755  80.8%     -  702s
H    0     0                    -17800.59023 -3428.3064  80.7%     -  703s
     0     0 -3742.2787    0  612 -17800.590 -3742.2787  79.0%     -  725s
     0     0 -3800.1596    0  591 -17800.590 -3800.1596  78.7%     -  734s
     0     0 -3835.1254    0  555 -17800.590 -3835.1254  78.5%     -  740s
     0     0 -3888.3901    0  598 -17800.590 -3888.3901  78.2%     -  749s
     0     0 -3929.0847    0  594 -17800.590 -3929.0847  77.9%     -  755s
     0     0 -3939.6292    0  608 -17800.590 -3939.6292  77.9%     -  758s
     0     0 -3961.4727    0  604 -17800.590 -3961.4727  77.7%     -  762s
     0     0 -3988.0599    0  593 -17800.590 -3988.0599  77.6%     -  766s
     0     0 -3998.2146    0  605 -17800.590 -3998.2146  77.5%     -  768s
     0     0 -4024.2829    0  606 -17800.590 -4024.2829  77.4%     -  772s
     0     0 -4047.4209    0  563 -17800.590 -4047.4209  77.3%     -  776s
     0     0 -4056.8604    0  611 -17800.590 -4056.8604  77.2%     -  780s
     0     0 -4065.7453    0  613 -17800.590 -4065.7453  77.2%     -  784s
     0     0 -4068.6237    0  629 -17800.590 -4068.6237  77.1%     -  786s
     0     0 -4070.9012    0  623 -17800.590 -4070.9012  77.1%     -  788s
     0     0 -4073.3452    0  626 -17800.590 -4073.3452  77.1%     -  789s
     0     0 -4075.0630    0  557 -17800.590 -4075.0630  77.1%     -  790s
     0     0 -4257.7121    0  560 -17800.590 -4257.7121  76.1%     -  802s
H    0     0                    -17719.24266 -4258.9118  76.0%     -  802s
H    0     0                    -17620.41272 -4258.9118  75.8%     -  802s
H    0     0                    -17558.52720 -4258.9118  75.7%     -  802s
     0     0 -4307.6122    0  562 -17558.527 -4307.6122  75.5%     -  809s
     0     0 -4369.3687    0  521 -17558.527 -4369.3687  75.1%     -  814s
     0     0 -4376.9916    0  563 -17558.527 -4376.9916  75.1%     -  817s
     0     0 -4380.3994    0  567 -17558.527 -4380.3994  75.1%     -  819s
     0     0 -4384.6749    0  570 -17558.527 -4384.6749  75.0%     -  820s
     0     0 -4386.8344    0  612 -17558.527 -4386.8344  75.0%     -  822s
     0     0 -4494.7351    0  436 -17558.527 -4494.7351  74.4%     -  831s
     0     0 -4504.4534    0  633 -17558.527 -4504.4534  74.3%     -  840s
     0     0 -4506.7185    0  445 -17558.527 -4506.7185  74.3%     -  842s
     0     0 -4538.4253    0  565 -17558.527 -4538.4253  74.2%     -  850s
H    0     0                    -17554.05371 -4540.4029  74.1%     -  850s
H    0     0                    -17531.53984 -4540.4029  74.1%     -  850s
     0     0 -4549.7146    0  627 -17531.540 -4549.7146  74.0%     -  854s
     0     0 -4551.7120    0  437 -17531.540 -4551.7120  74.0%     -  857s
     0     0 -4576.8379    0  668 -17531.540 -4576.8379  73.9%     -  868s
     0     0 -4579.6543    0  650 -17531.540 -4579.6543  73.9%     -  872s
     0     0 -4580.6850    0  386 -17531.540 -4580.6850  73.9%     -  873s
     0     0 -4587.2134    0  671 -17531.540 -4587.2134  73.8%     -  880s
H    0     0                    -17523.89766 -4587.2311  73.8%     -  880s
     0     0 -4589.4409    0  444 -17523.898 -4589.4409  73.8%     -  882s
     0     0 -4607.1798    0  651 -17523.898 -4607.1798  73.7%     -  890s
     0     0 -4614.9118    0  666 -17523.898 -4614.9118  73.7%     -  895s
     0     0 -4615.5572    0  664 -17523.898 -4615.5572  73.7%     -  898s
     0     0 -4619.9376    0  623 -17523.898 -4619.9376  73.6%     -  904s
     0     0 -4620.2109    0  623 -17523.898 -4620.2109  73.6%     -  909s
H    0     0                    -17505.77878 -4620.2109  73.6%     -  939s
H    0     0                    -15630.39332 -4620.2109  70.4%     -  996s
H    0     0                    -15502.15407 -4620.2109  70.2%     -  997s
H    0     2                    -15446.74252 -4620.2109  70.1%     -  999s
     0     2 -4620.2109    0  623 -15446.743 -4620.2109  70.1%     -  999s
     1     3 -4939.5349    1  485 -15446.743 -4620.2129  70.1% 12548 1015s
     2     4 -4701.8904    1  532 -15446.743 -4701.8904  69.6%  8662 1030s
     3     7 -5531.8139    2  503 -15446.743 -4701.9393  69.6%  9601 1047s
     6    13 -5622.1458    3  488 -15446.743 -4701.9393  69.6%  8950 1067s
    12    26 -6445.8661    4  456 -15446.743 -4885.7877  68.4% 10185 1093s
    25    39 -5319.5846    5  615 -15446.743 -5110.5065  66.9% 15955 1152s
    38    70 -5848.6825    6  559 -15446.743 -5110.5065  66.9% 14789 1282s
H   50    70                    -15415.38065 -5110.5065  66.8% 13178 1282s
H   53    70                    -15383.65827 -5110.5065  66.8% 12894 1282s
    69   211 -5920.5080    7  612 -15383.658 -5381.5361  65.0% 16412 1332s
   212   241 -6112.6791   12  509 -15383.658 -5400.8095  64.9%  8850 1348s
   246   271 -6127.7511   13  514 -15383.658 -5400.8095  64.9%  8428 1370s
   276   302 -6310.5856   14  548 -15383.658 -5400.8095  64.9%  8179 1392s
H  279   302                    -15305.54418 -5400.8095  64.7%  8147 1392s
H  287   302                    -15149.90716 -5400.8095  64.4%  8077 1392s
   309   356 -6866.2978   15  460 -15149.907 -5400.8095  64.4%  7989 1418s
   365   400 -7009.4439   17  456 -15149.907 -5400.8095  64.4%  7681 1445s
   409   470 -7252.1198   19  442 -15149.907 -5400.8095  64.4%  7637 1471s
   479   532 -7402.4712   22  447 -15149.907 -5400.8095  64.4%  7409 1496s
   543   605 -7458.1039   26  441 -15149.907 -5400.8095  64.4%  7122 1518s
   616   669 -7630.0493   29  430 -15149.907 -5400.8095  64.4%  6913 1536s
   680   738 -8240.7157   31  419 -15149.907 -5400.8095  64.4%  6963 1553s
   753   805 -8242.4145   32  416 -15149.907 -5400.8095  64.4%  6864 1580s
   824   883 -13143.106   35  198 -15149.907 -5400.8095  64.4%  6775 1598s
   906   932 -13143.361   36  190 -15149.907 -5400.8095  64.4%  6671 1618s
   977   978 -14368.675   40  166 -15149.907 -5400.8095  64.4%  6706 1638s
H  979   978                    -15113.11043 -5400.8095  64.3%  6694 1638s
  1049   997     cutoff   45      -15113.110 -5400.8095  64.3%  6732 1659s
  1108  1050 -5994.4949   12  645 -15113.110 -5400.8095  64.3%  6843 1680s
  1187  1137 -6239.2313   13  632 -15113.110 -5400.8095  64.3%  6952 1705s
  1302  1216 -6653.0832   14  643 -15113.110 -5400.8095  64.3%  6792 1729s
  1421  1277 -6683.3164   15  579 -15113.110 -5400.8095  64.3%  6654 1755s
  1536  1339 infeasible   26      -15113.110 -5400.8095  64.3%  6556 1783s
  1676  1391 -6670.4838   14  561 -15113.110 -5400.8095  64.3%  6404 1812s
  1789  1424 -14733.909   27  272 -15113.110 -5400.8095  64.3%  6380 1842s
  1895  1493 -11134.224   15  457 -15113.110 -5400.8095  64.3%  6399 1875s
  1974  1546 -11456.083   16  397 -15113.110 -5400.8095  64.3%  6526 1907s
  2039  1584 -12088.467   17  452 -15113.110 -5400.8095  64.3%  6654 1931s
  2079  1616 -12129.670   18  382 -15113.110 -5502.6650  63.6%  6686 1955s
H 2101  1616                    -15010.34279 -5502.6650  63.3%  6701 1955s
  2111  1756 -12221.806   19  390 -15010.343 -5502.6650  63.3%  6720 1981s
  2270  1873 -12375.885   22  390 -15010.343 -5502.6650  63.3%  6639 2009s
  2406  2023 -12716.497   26  375 -15010.343 -5585.5811  62.8%  6640 2040s
  2569  2155 -12801.443   28  382 -15010.343 -5585.5811  62.8%  6594 2072s
  2744  2274 -13523.436   29  182 -15010.343 -5592.2694  62.7%  6529 2106s
  2926  2296 -13648.182   33  159 -15010.343 -5801.5433  61.3%  6488 2140s
  2964  2326 -13790.202   34  160 -15010.343 -5801.5433  61.3%  6538 2170s
H 2970  2305                    -14844.03422 -5801.5433  60.9%  6536 2170s
  3006  2321 infeasible   34      -14844.034 -5801.5433  60.9%  6568 2215s
H 3016  2316                    -14770.91070 -5801.5433  60.7%  6560 2215s
H 3064  2307                    -14742.25871 -5801.5433  60.6%  6560 2215s
  3086  2396 infeasible   37      -14742.259 -5860.8166  60.2%  6569 2254s
  3224  2494 -7859.4449   13  504 -14742.259 -5923.3130  59.8%  6675 2297s
H 3227  2467                    -14637.49611 -5923.3130  59.5%  6679 2297s
H 3228  2467                    -14635.49091 -5923.3130  59.5%  6684 2297s
  3326  2558 -8293.0806   14  481 -14635.491 -5923.3130  59.5%  6739 2341s
  3467  2675 -9265.3741   17  340 -14635.491 -5923.3130  59.5%  6818 2380s
H 3476  2672                    -14621.59337 -5923.3130  59.5%  6816 2380s
H 3483  2671                    -14594.80138 -5923.3130  59.4%  6819 2380s
H 3606  2666                    -14555.52456 -6000.8840  58.8%  6825 2421s
H 3606  2663                    -14521.18548 -6000.8840  58.7%  6825 2425s
  3607  2662 -11983.922   25  623 -14521.185 -6000.8840  58.7%  6823 2608s
  3609  2663 -10651.709   31  278 -14521.185 -6000.8840  58.7%  6819 2627s
H 3609  2529                    -14514.65939 -6000.8840  58.7%  6819 2723s
H 3609  2403                    -14512.59935 -6000.8840  58.7%  6819 2723s
  3611  2405 -12812.415   28  512 -14512.599 -6000.8840  58.7%  6815 2886s
  3612  2405 -13343.472   32  460 -14512.599 -6000.8840  58.7%  6813 2933s
  3613  2406 -12728.537   42  544 -14512.599 -6000.8840  58.7%  6812 2971s
  3614  2407 -14238.081   57  485 -14512.599 -6000.8840  58.7%  6810 2998s
  3615  2407 -6829.3987   11  428 -14512.599 -6000.8840  58.7%  6808 3019s
  3616  2408 -11663.711   35  554 -14512.599 -6000.8840  58.7%  6806 3032s
H 3616  2287                    -14321.17675 -6000.8840  58.1%  6806 3045s
H 3616  2173                    -14269.64544 -6000.8840  57.9%  6806 3045s
  3618  2174 -8851.3326   22  586 -14269.645 -6000.8840  57.9%  6802 3053s
  3619  2175 -10483.622   29  531 -14269.645 -6000.8840  57.9%  6800 3060s
  3620  2176 -7859.5591   10  578 -14269.645 -6000.8840  57.9%  6798 3066s
  3621  2176 -11977.223   39  593 -14269.645 -6000.8840  57.9%  6796 3074s
  3622  2177 -11842.113   39  525 -14269.645 -6000.8840  57.9%  6795 3078s
  3623  2178 -13871.637   24  581 -14269.645 -6000.8840  57.9%  6793 3081s
  3624  2178 -12422.039   32  509 -14269.645 -6000.8840  57.9%  6791 3086s
  3625  2179 -8786.6295   25  516 -14269.645 -6000.8840  57.9%  6789 3090s
  3626  2180 -11757.931   43  609 -14269.645 -6000.8840  57.9%  6787 3098s
  3627  2180 -7859.3001    8  584 -14269.645 -6000.8840  57.9%  6785 3129s
  3628  2181 -11430.835   26  546 -14269.645 -6000.8840  57.9%  6783 3139s
  3629  2182 -14207.221   57  605 -14269.645 -6000.8840  57.9%  6782 3146s
  3631  2183 -11960.984   37  585 -14269.645 -6000.8840  57.9%  6778 3155s
  3633  2184 -7122.7772   11  549 -14269.645 -6000.8840  57.9%  6774 3161s
  3634  2185 -9311.6531   20  560 -14269.645 -6000.8840  57.9%  6772 3166s
  3635  2186 -8795.2809   18  450 -14269.645 -6000.8840  57.9%  6770 3184s
  3636  2186 -10188.296   25  557 -14269.645 -6000.8840  57.9%  6768 3189s
  3637  2187 -8856.4008   19  523 -14269.645 -6000.8840  57.9%  6767 3193s
  3638  2188 -7019.5117    8  541 -14269.645 -6000.8840  57.9%  6765 3197s
  3639  2188 -8816.5160   17  549 -14269.645 -6000.8840  57.9%  6763 3201s
  3641  2190 -10609.892   11  583 -14269.645 -6000.8840  57.9%  6759 3207s
  3642  2190 -12561.505   42  516 -14269.645 -6000.8840  57.9%  6757 3213s
  3643  2191 -11926.872   37  579 -14269.645 -6000.8840  57.9%  6755 3230s
  3644  2192 -10020.746   24  519 -14269.645 -6000.8840  57.9%  6754 3236s
  3645  2192 -8200.2389   15  627 -14269.645 -6000.8840  57.9%  6752 3241s
  3646  2193 -14269.645   55  561 -14269.645 -6000.8840  57.9%  6750 3248s
  3647  2194 -14269.645   22  532 -14269.645 -6000.8840  57.9%  6748 3261s
  3648  2194 -10669.751   31  607 -14269.645 -6000.8840  57.9%  6746 3268s
  3649  2195 -9253.6658   21  598 -14269.645 -6000.8840  57.9%  6744 3291s
  3651  2196 -9038.1215   25  620 -14269.645 -6000.8840  57.9%  6741 3301s
  3652  2197 -10560.217   27  618 -14269.645 -6000.8840  57.9%  6739 3312s
  3653  2198 -8944.2927   17  629 -14269.645 -6000.8840  57.9%  6737 3319s
  3654  2198 -12085.389   41  606 -14269.645 -6000.8840  57.9%  6735 3334s
  3655  2199 -13808.542   35  570 -14269.645 -6000.8840  57.9%  6733 3344s
  3656  2200 -7703.2347   20  576 -14269.645 -6000.8840  57.9%  6731 3356s
  3657  2200 -13858.098   68  575 -14269.645 -6000.8840  57.9%  6730 3362s
  3658  2201 -12069.249   43  617 -14269.645 -6000.8840  57.9%  6728 3374s
  3659  2202 -6929.8118   15  617 -14269.645 -6000.8840  57.9%  6726 3403s
  3660  2202 -14269.645   56  617 -14269.645 -6000.8840  57.9%  6724 3451s
  3661  2206 -6000.8840   12  563 -14269.645 -6000.8840  57.9%  6843 3557s
  3663  2209 -6000.8840   13  557 -14269.645 -6000.8840  57.9%  6841 3589s
  3667  2210 -6332.9782   14  419 -14269.645 -6000.8840  57.9%  6840 3600s

Cutting planes:
  Gomory: 3
  Implied bound: 29
  Projected implied bound: 153
  MIR: 843
  Mixing: 2
  Flow cover: 904
  RLT: 46
  Relax-and-lift: 137

Explored 3669 nodes (25669529 simplex iterations) in 3600.10 seconds (5764.23 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14269.6 -14321.2 -14512.6 ... -14637.5

Time limit reached
Best objective -1.426964543501e+04, best bound -6.000884028056e+03, gap 57.9465%
  WARNING: Time limit reached. Using best solution found (gap: 57.95%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = -14269.65, θ = 128324.81
  Upper Bound (UB) = -14269.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128324.81
  [DEBUG]   ✓ Scenario 0: θ = 128324.81 ≤ Q = 128324.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128324.81 ≤ Q = 128324.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128324.81 ≤ Q = 128324.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128324.81 ≤ Q = 128324.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128324.81 ≤ Q = 128324.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128324.81 ≤ Q = 128324.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128324.81 ≤ Q = 128324.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128324.81 ≤ Q = 128324.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128324.81 ≤ Q = 128324.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 128324.81 ≤ Q = 128324.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 128324.81 ≤ Q = 128324.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 128324.81 ≤ Q = 128324.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x378e26a8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc871d958
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.179139e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5126030.6700
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5125576.6288

Root relaxation: objective -1.525095e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152509.47    0  122 5125576.63 -152509.47   103%     -    0s
H    0     0                    -115629.0898 -152509.47  31.9%     -    0s
H    0     0                    -116409.1393 -152509.47  31.0%     -    0s
     0     0 -130986.66    0   67 -116409.14 -130986.66  12.5%     -    0s
H    0     0                    -128312.9535 -130955.21  2.06%     -    0s
H    0     0                    -128616.4356 -130955.21  1.82%     -    0s
H    0     0                    -128743.2283 -130955.21  1.72%     -    0s
     0     0 -130160.20    0   74 -128743.23 -130160.20  1.10%     -    0s
     0     0 -130119.54    0   68 -128743.23 -130119.54  1.07%     -    0s
     0     0 -129647.01    0   47 -128743.23 -129647.01  0.70%     -    0s
     0     0 -129502.61    0   45 -128743.23 -129502.61  0.59%     -    0s
     0     0 -129502.16    0   45 -128743.23 -129502.16  0.59%     -    0s
     0     0 -129333.51    0   21 -128743.23 -129333.51  0.46%     -    0s
H    0     0                    -128784.2569 -129306.75  0.41%     -    0s
     0     0 -129306.75    0   49 -128784.26 -129306.75  0.41%     -    0s
     0     0 -129273.10    0   35 -128784.26 -129273.10  0.38%     -    0s
     0     0 -129271.64    0   35 -128784.26 -129271.64  0.38%     -    0s
     0     2 -129271.64    0   35 -128784.26 -129271.64  0.38%     -    0s
H   49    78                    -128876.9654 -129086.21  0.16%   6.3    0s
*  702   328              22    -128883.0235 -129008.54  0.10%   3.6    0s
H  705   328                    -128898.6013 -129008.54  0.09%   3.6    0s
* 1094   347              18    -128898.6110 -128999.10  0.08%   3.7    0s
* 1326   361              19    -128904.2563 -128983.12  0.06%   3.8    0s

Cutting planes:
  Gomory: 20
  Implied bound: 2
  MIR: 144
  Flow cover: 8
  RLT: 30
  Relax-and-lift: 5

Explored 2421 nodes (10006 simplex iterations) in 0.30 seconds (0.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -128904 -128899 -128899 ... -115629
No other solutions better than -128904

Optimal solution found (tolerance 1.00e-04)
Best objective -1.289042563225e+05, best bound -1.289042563225e+05, gap 0.0000%
  Subproblem solved in 0.34s
  Worst-case operational profit (Z_SP) = 120720.22
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128904.26
  [DEBUG]   S×d_nominal = 249624.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249624.47 + -128904.26 = 120720.22
  [DEBUG]   Current θ from Master = 128324.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7604.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21874.24
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2556.1482, Absolute Gap = 2556.1482, Relative Gap = 0.179132
  Not converged yet (gap = 2556.15 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x1bee443a
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 3.11s
Presolved: 108243 rows, 46070 columns, 653608 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -390222.4994
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 600
 AA' NZ     : 4.185e+06
 Factor NZ  : 1.047e+07 (roughly 150 MB of memory)
 Factor Ops : 2.911e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59021289e+07  2.08114497e+08  9.64e+04 1.77e+01  7.60e+04     5s
   1  -1.20448606e+07  1.80007672e+08  6.54e+04 7.89e+01  5.09e+04     5s
   2  -4.71394280e+06  1.39824924e+08  2.49e+04 7.39e-01  2.04e+04     5s
   3  -1.07212178e+06  1.01749078e+08  3.12e+03 1.32e+00  2.91e+03     5s
   4  -5.54005298e+05  6.07968640e+07  4.50e+02 4.37e-01  6.29e+02     5s
   5  -4.60783354e+05  3.20996783e+07  1.93e+02 1.76e-01  2.85e+02     6s
   6  -4.06547403e+05  2.42499801e+07  1.05e+02 1.22e-01  1.85e+02     6s
   7  -3.32429180e+05  1.87428173e+07  3.99e+01 8.92e-02  1.17e+02     6s
   8  -2.12099746e+05  1.10280822e+07  9.48e+00 4.81e-02  6.02e+01     6s
   9  -1.34053426e+05  6.02223649e+06  5.18e+00 2.53e-02  3.22e+01     6s
  10  -1.10419011e+05  2.68308539e+06  3.06e+00 1.15e-02  1.45e+01     6s
  11  -9.30632121e+04  1.56956338e+06  2.20e+00 6.74e-03  8.55e+00     6s
  12  -6.03673492e+04  1.16780060e+06  9.66e-01 5.03e-03  6.25e+00     6s
  13  -4.79568093e+04  5.22159777e+05  6.48e-01 2.23e-03  2.89e+00     6s
  14  -3.71239965e+04  2.05702491e+05  3.61e-01 8.95e-04  1.23e+00     7s
  15  -3.13273371e+04  1.33715326e+05  2.66e-01 6.14e-04  8.35e-01     7s
  16  -2.42362836e+04  1.14809670e+05  1.98e-01 6.18e-04  7.03e-01     7s
  17  -1.64178810e+04  6.04485903e+04  1.35e-01 2.05e-03  3.89e-01     7s
  18  -1.25567484e+04  4.89503653e+04  1.12e-01 1.78e-03  3.11e-01     7s
  19  -1.02380412e+04  3.79710170e+04  9.95e-02 2.15e-03  2.44e-01     7s
  20  -5.63521355e+03  3.04447293e+04  7.66e-02 1.91e-03  1.82e-01     7s
  21  -3.61989514e+03  2.63037952e+04  6.67e-02 1.74e-03  1.51e-01     7s
  22  -6.87327835e+02  2.27085882e+04  5.21e-02 1.93e-03  1.18e-01     8s
  23   2.06009028e+03  1.92458356e+04  3.91e-02 1.39e-03  8.69e-02     8s
  24   3.79826216e+03  1.72902588e+04  3.11e-02 1.23e-03  6.82e-02     8s
  25   4.89697097e+03  1.66393883e+04  2.61e-02 1.10e-03  5.94e-02     8s
  26   5.75853875e+03  1.45599802e+04  2.22e-02 7.07e-04  4.45e-02     8s
  27   6.61069877e+03  1.42209219e+04  1.85e-02 6.39e-04  3.85e-02     8s
  28   7.19618287e+03  1.31483988e+04  1.60e-02 4.19e-04  3.01e-02     8s
  29   7.54216479e+03  1.28161933e+04  1.43e-02 3.60e-04  2.67e-02     9s
  30   8.05155794e+03  1.25115643e+04  1.21e-02 3.06e-04  2.26e-02     9s
  31   8.77836516e+03  1.20797251e+04  8.84e-03 2.32e-04  1.67e-02     9s
  32   9.04440794e+03  1.19286720e+04  7.75e-03 2.02e-04  1.46e-02     9s
  33   9.23778080e+03  1.17441574e+04  6.92e-03 2.69e-04  1.27e-02     9s
  34   9.45990862e+03  1.16729171e+04  5.99e-03 2.57e-04  1.12e-02     9s
  35   9.77037371e+03  1.14834108e+04  4.70e-03 1.85e-04  8.66e-03    10s
  36   9.87702757e+03  1.13380662e+04  4.26e-03 1.35e-04  7.39e-03    10s
  37   1.02197729e+04  1.12822546e+04  2.85e-03 1.06e-04  5.37e-03    10s
  38   1.02935761e+04  1.11773808e+04  2.54e-03 7.28e-05  4.47e-03    10s
  39   1.04050821e+04  1.11623042e+04  2.11e-03 6.77e-05  3.83e-03    10s
  40   1.04524658e+04  1.11532185e+04  1.93e-03 6.44e-05  3.54e-03    10s
  41   1.05032631e+04  1.11225974e+04  1.73e-03 5.37e-05  3.13e-03    11s
  42   1.05406229e+04  1.10946998e+04  1.58e-03 4.50e-05  2.80e-03    11s
  43   1.05951107e+04  1.10739686e+04  1.37e-03 3.90e-05  2.42e-03    11s
  44   1.06191735e+04  1.10482635e+04  1.27e-03 3.14e-05  2.17e-03    11s
  45   1.06770614e+04  1.10365153e+04  1.05e-03 2.73e-05  1.82e-03    11s
  46   1.07345579e+04  1.10304432e+04  8.29e-04 2.47e-05  1.50e-03    11s
  47   1.07419595e+04  1.10185222e+04  8.01e-04 2.13e-05  1.40e-03    12s
  48   1.07604136e+04  1.10111141e+04  7.31e-04 1.91e-05  1.27e-03    12s
  49   1.07795545e+04  1.10031575e+04  6.56e-04 1.66e-05  1.13e-03    12s
  50   1.07993106e+04  1.10006209e+04  5.78e-04 1.59e-05  1.02e-03    12s
  51   1.08056433e+04  1.09981371e+04  5.54e-04 1.52e-05  9.73e-04    12s
  52   1.08188573e+04  1.09949503e+04  5.03e-04 1.43e-05  8.90e-04    13s
  53   1.08315039e+04  1.09889717e+04  4.54e-04 1.24e-05  7.96e-04    13s
  54   1.08420505e+04  1.09857652e+04  4.14e-04 1.14e-05  7.27e-04    13s
  55   1.08475892e+04  1.09826806e+04  3.92e-04 1.04e-05  6.83e-04    13s
  56   1.08570939e+04  1.09767839e+04  3.55e-04 9.40e-06  6.05e-04    13s
  57   1.08697062e+04  1.09755309e+04  3.03e-04 9.01e-06  5.35e-04    13s
  58   1.08902831e+04  1.09655374e+04  2.22e-04 5.49e-06  3.81e-04    14s
  59   1.08928995e+04  1.09608519e+04  2.11e-04 4.03e-06  3.44e-04    14s
  60   1.09064914e+04  1.09588656e+04  1.56e-04 3.46e-06  2.65e-04    14s
  61   1.09094203e+04  1.09571224e+04  1.44e-04 2.97e-06  2.41e-04    14s
  62   1.09145193e+04  1.09561224e+04  1.25e-04 2.61e-06  2.10e-04    14s
  63   1.09234407e+04  1.09534122e+04  8.93e-05 1.79e-06  1.52e-04    15s
  64   1.09338088e+04  1.09530109e+04  5.10e-05 2.04e-06  9.71e-05    15s
  65   1.09388851e+04  1.09497888e+04  3.21e-05 8.15e-07  5.51e-05    15s
  66   1.09411424e+04  1.09485537e+04  2.37e-05 4.03e-07  3.75e-05    15s
  67   1.09464521e+04  1.09483311e+04  4.71e-06 2.68e-07  9.50e-06    15s
  68   1.09475571e+04  1.09478018e+04  7.54e-07 9.91e-09  1.24e-06    15s
  69   1.09477827e+04  1.09477860e+04  5.05e-09 3.12e-10  1.68e-08    16s
  70   1.09477836e+04  1.09477852e+04  3.11e-07 8.28e-10  7.84e-09    16s
  71   1.09477852e+04  1.09477852e+04  2.31e-08 7.21e-08  2.24e-10    16s

Barrier solved model in 71 iterations and 15.79 seconds (13.17 work units)
Optimal objective 1.09477852e+04


Root crossover log...

   89676 DPushes remaining with DInf 0.0000000e+00                16s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    5653 PPushes remaining with PInf 3.3315421e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.6165929e-01     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43671    1.0947785e+04   0.000000e+00   5.616593e-01     20s
   43672    1.0947785e+04   0.000000e+00   0.000000e+00     20s
   43672    1.0947785e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.97s

Solved with barrier

Root relaxation: objective 1.094779e+04, 43672 iterations, 17.14 seconds (17.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10947.7852    0  306 -201902.96 10947.7852   105%     -   21s
H    0     0                    -165647.8922 10947.7852   107%     -   22s
H    0     0                    -150584.4853 10947.7852   107%     -   22s
H    0     0                    -75617.65723 10947.7852   114%     -   22s
H    0     0                    -27052.48613 10947.7852   140%     -   23s
H    0     0                    -26734.80032 10947.7852   141%     -   23s
H    0     0                    -25807.46135 10947.7852   142%     -   25s
H    0     0                    -23391.38925 10947.7852   147%     -   25s
H    0     0                    -23355.01112 10947.7852   147%     -   25s
H    0     0                    -23254.70402 10947.7852   147%     -   25s
     0     0 4778.12452    0  457 -23254.704 4778.12452   121%     -   77s
H    0     0                    -23063.79752 4777.93036   121%     -   78s
     0     0 4445.41845    0  481 -23063.798 4445.41845   119%     -  104s
     0     0 4334.50861    0  513 -23063.798 4334.50861   119%     -  117s
     0     0 4330.23267    0  519 -23063.798 4330.23267   119%     -  120s
     0     0 4253.03486    0  508 -23063.798 4253.03486   118%     -  129s
     0     0 4252.37044    0  510 -23063.798 4252.37044   118%     -  130s
     0     0 1467.36947    0  555 -23063.798 1467.36947   106%     -  221s
H    0     0                    -17685.06227 1467.36947   108%     -  222s
H    0     0                    -17434.40937 1467.36947   108%     -  222s
     0     0 1001.76596    0  526 -17434.409 1001.76596   106%     -  279s
     0     0  815.69695    0  536 -17434.409  815.69695   105%     -  306s
     0     0  616.81264    0  524 -17434.409  616.81264   104%     -  328s
     0     0  536.30734    0  532 -17434.409  536.30734   103%     -  350s
     0     0  443.19140    0  541 -17434.409  443.19140   103%     -  367s
     0     0  380.32999    0  535 -17434.409  380.32999   102%     -  381s
     0     0  343.79084    0  536 -17434.409  343.79084   102%     -  394s
     0     0  231.24269    0  541 -17434.409  231.24269   101%     -  413s
     0     0  185.33628    0  540 -17434.409  185.33628   101%     -  429s
     0     0  164.72668    0  487 -17434.409  164.72668   101%     -  440s
     0     0  160.89185    0  540 -17434.409  160.89185   101%     -  444s
     0     0  159.26091    0  538 -17434.409  159.26091   101%     -  446s
     0     0  158.16620    0  539 -17434.409  158.16620   101%     -  448s
H    0     0                    -17318.31608 -1855.8589  89.3%     -  562s
H    0     0                    -17036.29390 -1855.8589  89.1%     -  562s
H    0     0                    -16970.98010 -1855.8589  89.1%     -  562s
H    0     0                    -16924.38979 -1855.8589  89.0%     -  562s
     0     0 -1855.8589    0  555 -16924.390 -1855.8589  89.0%     -  563s
H    0     0                    -16224.94822 -1855.8846  88.6%     -  563s
H    0     0                    -16006.30321 -1855.8846  88.4%     -  564s
     0     0 -2295.9960    0  568 -16006.303 -2295.9960  85.7%     -  628s
     0     0 -2416.5925    0  627 -16006.303 -2416.5925  84.9%     -  658s
     0     0 -2492.1909    0  557 -16006.303 -2492.1909  84.4%     -  681s
     0     0 -2545.1975    0  581 -16006.303 -2545.1975  84.1%     -  695s
     0     0 -2671.4042    0  598 -16006.303 -2671.4042  83.3%     -  720s
     0     0 -2679.5033    0  602 -16006.303 -2679.5033  83.3%     -  729s
     0     0 -2713.9932    0  610 -16006.303 -2713.9932  83.0%     -  743s
     0     0 -2762.0759    0  518 -16006.303 -2762.0759  82.7%     -  754s
     0     0 -2770.9182    0  506 -16006.303 -2770.9182  82.7%     -  759s
     0     0 -2785.9862    0  511 -16006.303 -2785.9862  82.6%     -  762s
     0     0 -2811.7889    0  505 -16006.303 -2811.7889  82.4%     -  769s
     0     0 -2827.2400    0  625 -16006.303 -2827.2400  82.3%     -  774s
     0     0 -2836.7103    0  568 -16006.303 -2836.7103  82.3%     -  778s
     0     0 -2854.0899    0  576 -16006.303 -2854.0899  82.2%     -  782s
     0     0 -2859.1358    0  573 -16006.303 -2859.1358  82.1%     -  786s
     0     0 -2868.3827    0  565 -16006.303 -2868.3827  82.1%     -  789s
     0     0 -2868.4063    0  562 -16006.303 -2868.4063  82.1%     -  790s
     0     0 -3805.0302    0  609 -16006.303 -3805.0302  76.2%     -  856s
H    0     0                    -15997.41454 -3805.3640  76.2%     -  857s
     0     0 -3992.4199    0  633 -15997.415 -3992.4199  75.0%     -  879s
     0     0 -4146.5967    0  642 -15997.415 -4146.5967  74.1%     -  894s
     0     0 -4227.0868    0  701 -15997.415 -4227.0868  73.6%     -  902s
     0     0 -4252.8958    0  640 -15997.415 -4252.8958  73.4%     -  908s
     0     0 -4287.1143    0  643 -15997.415 -4287.1143  73.2%     -  913s
     0     0 -4298.7199    0  540 -15997.415 -4298.7199  73.1%     -  915s
     0     0 -4320.2559    0  534 -15997.415 -4320.2559  73.0%     -  919s
     0     0 -4332.4037    0  642 -15997.415 -4332.4037  72.9%     -  922s
     0     0 -4346.3306    0  640 -15997.415 -4346.3306  72.8%     -  926s
     0     0 -4347.9910    0  639 -15997.415 -4347.9910  72.8%     -  927s
     0     0 -4562.7147    0  476 -15997.415 -4562.7147  71.5%     -  944s
     0     0 -4651.1187    0  579 -15997.415 -4651.1187  70.9%     -  954s
     0     0 -4687.6889    0  501 -15997.415 -4687.6889  70.7%     -  959s
     0     0 -4695.5869    0  553 -15997.415 -4695.5869  70.6%     -  964s
     0     0 -4701.2132    0  634 -15997.415 -4701.2132  70.6%     -  968s
     0     0 -4707.6618    0  646 -15997.415 -4707.6618  70.6%     -  972s
     0     0 -4710.2998    0  572 -15997.415 -4710.2998  70.6%     -  974s
     0     0 -4712.4360    0  558 -15997.415 -4712.4360  70.5%     -  975s
     0     0 -4806.0606    0  582 -15997.415 -4806.0606  70.0%     -  990s
H    0     0                    -15995.46822 -4806.2695  70.0%     -  997s
H    0     0                    -15865.33087 -4806.2695  69.7%     -  997s
H    0     0                    -15761.65447 -4806.2695  69.5%     -  998s
     0     0 -4819.4143    0  573 -15761.654 -4819.4143  69.4%     - 1002s
     0     0 -4828.8564    0  564 -15761.654 -4828.8564  69.4%     - 1005s
     0     0 -4838.1179    0  567 -15761.654 -4838.1179  69.3%     - 1007s
     0     0 -4839.9961    0  509 -15761.654 -4839.9961  69.3%     - 1008s
     0     0 -4891.6690    0  483 -15761.654 -4891.6690  69.0%     - 1026s
     0     0 -4903.6882    0  509 -15761.654 -4903.6882  68.9%     - 1032s
     0     0 -4909.7502    0  518 -15761.654 -4909.7502  68.9%     - 1035s
     0     0 -4911.9090    0  515 -15761.654 -4911.9090  68.8%     - 1037s
     0     0 -4936.1686    0  529 -15761.654 -4936.1686  68.7%     - 1044s
     0     0 -4942.8756    0  527 -15761.654 -4942.8756  68.6%     - 1054s
     0     0 -4945.1112    0  525 -15761.654 -4945.1112  68.6%     - 1055s
     0     0 -4953.3159    0  579 -15761.654 -4953.3159  68.6%     - 1062s
     0     0 -4955.8170    0  530 -15761.654 -4955.8170  68.6%     - 1065s
     0     0 -4956.4404    0  533 -15761.654 -4956.4404  68.6%     - 1066s
     0     0 -4959.5240    0  533 -15761.654 -4959.5240  68.5%     - 1071s
     0     0 -4959.6945    0  533 -15761.654 -4959.6945  68.5%     - 1076s
H    0     0                    -15510.50869 -4959.6945  68.0%     - 1203s
H    0     2                    -15131.95324 -4959.6945  67.2%     - 1342s
     0     2 -4959.6945    0  533 -15131.953 -4959.6945  67.2%     - 1342s
     1     4 -5131.0755    1  506 -15131.953 -4959.6945  67.2%  6461 1356s
     3     8 -5161.5733    2  504 -15131.953 -5131.1375  66.1%  7316 1370s
     7    16 -5301.0298    3  578 -15131.953 -5161.5867  65.9%  8666 1409s
    15    32 -5402.9695    4  530 -15131.953 -5301.1849  65.0% 10479 1443s
    31    44 -6367.7119    5  661 -15131.953 -5403.9597  64.3% 18180 1549s
    47    69 -6888.4624    6  511 -15131.953 -5403.9597  64.3% 17861 1601s
H   50    69                    -15034.83843 -5403.9597  64.1% 17383 1601s
    74   163 -6914.4542    7  510 -15034.838 -5403.9597  64.1% 14863 1656s
   168   226 -6962.4788    9  445 -15034.838 -5403.9597  64.1%  9497 1695s
   231   254 -7378.9202   11  528 -15034.838 -5403.9597  64.1%  8519 1719s
H  259   276                    -15010.34279 -5403.9597  64.0%  8264 1750s
   285   327 -8921.5637   12  269 -15010.343 -5403.9597  64.0%  8360 1781s
   354   381 -7764.0686   11  687 -15010.343 -5403.9597  64.0%  8389 1811s
H  403   381                    -14886.65661 -5403.9597  63.7%  8030 1811s
   424   430     cutoff   14      -14886.657 -5403.9597  63.7%  7979 1841s
   493   450 -11905.938   13  281 -14886.657 -5403.9597  63.7%  7846 1863s
H  507   450                    -14807.39810 -5403.9597  63.5%  7908 1863s
   523   519 -7552.4523   10  286 -14807.398 -5403.9597  63.5%  7933 1889s
   622   535 -12809.054   14  249 -14807.398 -5403.9597  63.5%  7701 1913s
   654   551 -14413.840   15  232 -14807.398 -5403.9597  63.5%  7688 1935s
   692   576 infeasible   16      -14807.398 -5403.9597  63.5%  7611 1960s
H  721   576                    -14762.52266 -5403.9597  63.4%  7751 1960s
   725   626 infeasible   16      -14762.523 -5403.9597  63.4%  7730 1982s
   803   642 infeasible   17      -14762.523 -5403.9597  63.4%  7517 2005s
H  815   642                    -14750.82155 -5403.9597  63.4%  7475 2005s
H  816   642                    -14746.00092 -5403.9597  63.4%  7468 2005s
   841   698 infeasible   19      -14746.001 -5403.9597  63.4%  7425 2030s
   928   714 infeasible   36      -14746.001 -5403.9597  63.4%  7214 2053s
H  935   714                    -14731.81157 -5403.9597  63.3%  7213 2053s
   968   765 -12863.935   18  158 -14731.812 -5403.9597  63.3%  7265 2077s
  1051   789 infeasible   20      -14731.812 -5403.9597  63.3%  7276 2103s
H 1052   789                    -14719.51049 -5403.9597  63.3%  7269 2103s
H 1059   789                    -14624.63389 -5403.9597  63.0%  7238 2103s
  1099   835 -13305.633   22  125 -14624.634 -5403.9597  63.0%  7230 2130s
  1195   868 -13812.553   25  122 -14624.634 -5403.9597  63.0%  7273 2158s
  1310   875     cutoff   27      -14624.634 -5403.9597  63.0%  7090 2188s
  1411   902 infeasible   31      -14624.634 -5403.9597  63.0%  6975 2223s
  1488   929 -8918.7103    7  359 -14624.634 -5403.9597  63.0%  7023 2257s
  1559   950 -9901.4603    8  472 -14624.634 -5403.9597  63.0%  7126 2293s
H 1594   976                    -14533.65940 -5403.9597  62.8%  7286 2343s
H 1633   976                    -14503.00560 -5403.9597  62.7%  7388 2343s
H 1636   976                    -14483.06932 -5403.9597  62.7%  7393 2343s
  1642  1034 -10883.302   10  389 -14483.069 -5403.9597  62.7%  7436 2376s
  1712  1061 -11300.957   12  435 -14483.069 -5403.9597  62.7%  7546 2405s
  1751  1100 -11774.689   15  423 -14483.069 -5403.9597  62.7%  7614 2436s
H 1758  1100                    -14452.70337 -5403.9597  62.6%  7620 2436s
H 1765  1100                    -14441.75776 -5403.9597  62.6%  7644 2436s
  1812  1168 -12407.130   16  411 -14441.758 -5403.9597  62.6%  7654 2470s
  1914  1255 -14137.548   17  140 -14441.758 -5595.1490  61.3%  7765 2507s
  2031  1352 infeasible   18      -14441.758 -5907.0980  59.1%  7828 2550s
  2176  1423 -7665.9659    7  562 -14441.758 -6160.4023  57.3%  7835 2593s
  2315  1496 -9148.6372    8  518 -14441.758 -6160.4023  57.3%  7789 2636s
  2438  1590 -9527.3519    9  335 -14441.758 -6160.4023  57.3%  7792 2680s
  2589  1682 -9781.6504   12  505 -14441.758 -6394.2213  55.7%  7801 2726s
  2733  1778 -10324.411   15  539 -14441.758 -6424.3443  55.5%  7846 2778s
  2867  1793 -11273.515   16  288 -14441.758 -6424.3443  55.5%  7907 2818s
  2931  1862 -11332.754   17  225 -14441.758 -6424.3443  55.5%  7918 2859s
  3036  1949 -11866.708   21  219 -14441.758 -6424.3443  55.5%  7951 2907s
  3179  2037 -13690.663   25  151 -14441.758 -6535.1825  54.7%  7970 2962s
H 3230  2037                    -14434.14216 -6535.1825  54.7%  7964 2962s
  3325  2148     cutoff   26      -14434.142 -6535.1825  54.7%  8033 3018s
  3502  2260 -14010.186   21  230 -14434.142 -6757.3983  53.2%  8044 3078s
  3695  2378 -9389.1594   10  403 -14434.142 -6772.9752  53.1%  8062 3140s
  3874  2379 -13009.446   31  533 -14434.142 -6894.1414  52.2%  8105 3447s
  3876  2380 -8956.1273   16  229 -14434.142 -6894.1414  52.2%  8100 3467s

Cutting planes:
  Gomory: 14
  Implied bound: 5
  Projected implied bound: 274
  MIR: 1086
  Mixing: 22
  Flow cover: 598
  RLT: 37
  Relax-and-lift: 114

Explored 3876 nodes (32192011 simplex iterations) in 3600.15 seconds (6033.21 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14434.1 -14441.8 -14452.7 ... -14746

Time limit reached
Best objective -1.443414215596e+04, best bound -6.894141446485e+03, gap 52.2373%
  WARNING: Time limit reached. Using best solution found (gap: 52.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.27s
  Master Objective (UB) = -14434.14, θ = 129160.39
  Upper Bound (UB) = -14434.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 129160.39
  [DEBUG]   ✓ Scenario 0: θ = 129160.39 ≤ Q = 129160.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 129160.39 ≤ Q = 129160.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 129160.39 ≤ Q = 129160.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 129160.39 ≤ Q = 129160.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 129160.39 ≤ Q = 129160.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 129160.39 ≤ Q = 129160.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 129160.39 ≤ Q = 129160.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 129160.39 ≤ Q = 129160.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 129160.39 ≤ Q = 129160.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 129160.39 ≤ Q = 129160.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 129160.39 ≤ Q = 129160.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 129160.39 ≤ Q = 129160.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 129160.39 ≤ Q = 129160.39 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7b5041d4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x84afbe2c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.165813e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5118702.9476
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5118248.9064

Root relaxation: objective -1.511122e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151112.24    0  122 5118248.91 -151112.24   103%     -    0s
H    0     0                    -114634.9997 -151112.24  31.8%     -    0s
H    0     0                    -114967.5660 -151112.24  31.4%     -    0s
     0     0 -124248.56    0   94 -114967.57 -124248.56  8.07%     -    0s
H    0     0                    -119826.2000 -124090.80  3.56%     -    0s
     0     0 -123225.95    0   70 -119826.20 -123225.95  2.84%     -    0s
H    0     0                    -121798.0652 -123223.89  1.17%     -    0s
H    0     0                    -121880.7141 -122983.47  0.90%     -    0s
     0     0 -122983.47    0   70 -121880.71 -122983.47  0.90%     -    0s
     0     0 -122978.73    0   71 -121880.71 -122978.73  0.90%     -    0s
H    0     0                    -122184.8894 -122975.42  0.65%     -    0s
H    0     0                    -122184.8900 -122975.42  0.65%     -    0s
H    0     0                    -122508.8681 -122975.42  0.38%     -    0s
     0     2 -122969.63    0   70 -122508.87 -122969.63  0.38%     -    0s
H   34     3                    -122519.3606 -122565.68  0.04%   9.6    0s

Cutting planes:
  Gomory: 44
  Implied bound: 3
  MIR: 166
  RLT: 2

Explored 44 nodes (869 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -122519 -122509 -122185 ... 5.1187e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.225193606377e+05, best bound -1.225252546382e+05, gap 0.0048%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 126639.30
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122519.36
  [DEBUG]   S×d_nominal = 249158.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249158.66 + -122519.36 = 126639.30
  [DEBUG]   Current θ from Master = 129160.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2521.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16955.23
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2391.6514, Absolute Gap = 2391.6514, Relative Gap = 0.165694
  Not converged yet (gap = 2391.65 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x5bf5599f
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 4.19s
Presolved: 116463 rows, 49440 columns, 702705 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -389255.3788
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 605
 AA' NZ     : 4.699e+06
 Factor NZ  : 1.116e+07 (roughly 160 MB of memory)
 Factor Ops : 2.280e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.63437011e+07  2.21433298e+08  9.91e+04 1.72e+01  7.75e+04     6s
   1  -1.24323291e+07  1.91903542e+08  6.73e+04 7.83e+01  5.20e+04     6s
   2  -5.48815452e+06  1.49046771e+08  2.91e+04 7.49e-01  2.35e+04     6s
   3  -1.02573073e+06  1.12528438e+08  2.75e+03 1.47e+00  2.63e+03     6s
   4  -5.72209721e+05  6.60791870e+07  4.89e+02 5.18e-01  6.56e+02     7s
   5  -4.89340455e+05  3.45306721e+07  2.48e+02 2.13e-01  3.17e+02     7s
   6  -4.03002992e+05  2.57396160e+07  8.30e+01 1.47e-01  1.70e+02     7s
   7  -3.37617781e+05  1.94118288e+07  3.47e+01 1.06e-01  1.10e+02     7s
   8  -2.15883072e+05  1.17999798e+07  6.34e+00 6.22e-02  5.87e+01     7s
   9  -1.33932267e+05  6.21411419e+06  3.23e+00 3.13e-02  3.05e+01     7s
  10  -1.09871420e+05  3.04557362e+06  1.84e+00 1.57e-02  1.50e+01     7s
  11  -9.27258652e+04  1.76448697e+06  1.32e+00 9.12e-03  8.81e+00     7s
  12  -6.09422900e+04  1.25127935e+06  6.10e-01 6.44e-03  6.19e+00     7s
  13  -4.95734973e+04  5.35651445e+05  4.28e-01 2.74e-03  2.76e+00     7s
  14  -3.73279013e+04  2.66495577e+05  2.41e-01 1.40e-03  1.43e+00     7s
  15  -2.81694224e+04  1.84766998e+05  1.49e-01 1.07e-03  1.00e+00     8s
  16  -2.06661723e+04  1.14711744e+05  9.79e-02 6.89e-04  6.36e-01     8s
  17  -1.58946805e+04  8.62887153e+04  7.55e-02 1.06e-03  4.80e-01     8s
  18  -1.18388724e+04  6.66784433e+04  5.99e-02 1.05e-03  3.69e-01     8s
  19  -7.45014055e+03  4.66608185e+04  4.40e-02 1.35e-03  2.54e-01     8s
  20  -3.31322347e+03  4.17547308e+04  3.26e-02 1.12e-03  2.12e-01     8s
  21  -2.21490075e+03  3.37643930e+04  2.96e-02 8.38e-04  1.69e-01     8s
  22  -8.23272364e+00  3.03262132e+04  2.38e-02 7.28e-04  1.42e-01     8s
  23   2.03002796e+03  2.61699378e+04  1.87e-02 5.95e-04  1.13e-01     8s
  24   3.94715725e+03  2.26799393e+04  1.42e-02 4.58e-04  8.80e-02     9s
  25   4.77957927e+03  2.12008835e+04  1.20e-02 4.02e-04  7.71e-02     9s
  26   5.97047126e+03  1.84326127e+04  9.54e-03 2.96e-04  5.85e-02     9s
  27   7.03712771e+03  1.69073411e+04  7.36e-03 2.34e-04  4.63e-02     9s
  28   7.61432036e+03  1.54886399e+04  6.25e-03 1.78e-04  3.70e-02     9s
  29   8.21929491e+03  1.40192075e+04  5.04e-03 1.21e-04  2.72e-02     9s
  30   8.57124003e+03  1.33361481e+04  4.33e-03 9.41e-05  2.24e-02     9s
  31   8.89948499e+03  1.28907208e+04  3.69e-03 7.61e-05  1.87e-02    10s
  32   9.48418886e+03  1.26221059e+04  2.62e-03 6.44e-05  1.47e-02    10s
  33   9.64255206e+03  1.24158251e+04  2.32e-03 5.65e-05  1.30e-02    10s
  34   9.88194063e+03  1.21059154e+04  1.88e-03 4.75e-05  1.04e-02    10s
  35   1.01431977e+04  1.17573820e+04  1.39e-03 3.27e-05  7.58e-03    10s
  36   1.03190879e+04  1.15854286e+04  1.07e-03 2.55e-05  5.95e-03    10s
  37   1.05276443e+04  1.15442472e+04  7.19e-04 2.40e-05  4.77e-03    10s
  38   1.05450016e+04  1.14473958e+04  6.86e-04 2.00e-05  4.24e-03    11s
  39   1.07068495e+04  1.13860370e+04  4.16e-04 1.77e-05  3.19e-03    11s
  40   1.07574433e+04  1.12941373e+04  3.25e-04 1.37e-05  2.52e-03    11s
  41   1.08013479e+04  1.11872368e+04  2.49e-04 8.97e-06  1.81e-03    11s
  42   1.08582886e+04  1.11010538e+04  1.59e-04 5.39e-06  1.14e-03    11s
  43   1.08972220e+04  1.10683066e+04  1.01e-04 4.04e-06  8.03e-04    11s
  44   1.09133342e+04  1.10390862e+04  7.62e-05 2.84e-06  5.90e-04    11s
  45   1.09209300e+04  1.10075194e+04  6.48e-05 1.57e-06  4.07e-04    11s
  46   1.09299348e+04  1.09940280e+04  5.21e-05 1.03e-06  3.01e-04    12s
  47   1.09387289e+04  1.09891614e+04  3.96e-05 8.50e-07  2.37e-04    12s
  48   1.09483013e+04  1.09852820e+04  2.61e-05 6.75e-07  1.74e-04    12s
  49   1.09503340e+04  1.09823296e+04  2.33e-05 5.61e-07  1.50e-04    12s
  50   1.09593943e+04  1.09732493e+04  1.00e-05 2.19e-07  6.51e-05    12s
  51   1.09621544e+04  1.09673824e+04  6.23e-06 1.29e-08  2.46e-05    12s
  52   1.09644405e+04  1.09672981e+04  3.03e-06 1.03e-08  1.34e-05    12s
  53   1.09659936e+04  1.09671161e+04  1.06e-06 5.75e-09  5.27e-06    13s
  54   1.09664873e+04  1.09669262e+04  4.68e-07 3.03e-09  2.06e-06    13s
  55   1.09666524e+04  1.09668956e+04  2.68e-07 4.35e-09  1.14e-06    13s
  56   1.09667066e+04  1.09668941e+04  1.97e-07 7.78e-09  8.81e-07    13s
  57   1.09668356e+04  1.09668840e+04  4.95e-08 1.64e-10  2.27e-07    13s
  58   1.09668757e+04  1.09668821e+04  4.67e-07 7.05e-08  2.99e-08    13s
  59   1.09668797e+04  1.09668820e+04  5.21e-07 3.71e-07  1.08e-08    13s
  60   1.09668813e+04  1.09668820e+04  1.95e-07 1.23e-07  2.98e-09    13s
  61   1.09668816e+04  1.09668820e+04  4.94e-07 5.20e-08  1.64e-09    14s
  62   1.09668820e+04  1.09668820e+04  3.38e-08 7.13e-08  2.98e-12    14s

Barrier solved model in 62 iterations and 13.69 seconds (12.93 work units)
Optimal objective 1.09668820e+04


Root crossover log...

   90268 DPushes remaining with DInf 0.0000000e+00                14s
   21529 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    3473 PPushes remaining with PInf 6.9736993e-06                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.7881416e-02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35731    1.0966882e+04   0.000000e+00   6.788142e-02     17s
   35734    1.0966882e+04   0.000000e+00   0.000000e+00     17s
   35734    1.0966882e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.97s

Solved with barrier

Root relaxation: objective 1.096688e+04, 35734 iterations, 13.39 seconds (15.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10966.8820    0  450 -201902.96 10966.8820   105%     -   19s
H    0     0                    -159229.6990 10966.8820   107%     -   19s
H    0     0                    -116800.8717 10966.8820   109%     -   19s
H    0     0                    -68956.94852 10966.8820   116%     -   20s
H    0     0                    -68891.81435 10966.8820   116%     -   20s
H    0     0                    -64247.65708 10966.8820   117%     -   20s
H    0     0                    -27544.06811 10966.8820   140%     -   20s
H    0     0                    -26655.06514 10966.8820   141%     -   20s
H    0     0                    -26484.34640 10966.8820   141%     -   20s
H    0     0                    -26358.07626 10966.8820   142%     -   24s
H    0     0                    -26010.28679 4862.17749   119%     -  104s
H    0     0                    -25028.14980 4862.17749   119%     -  104s
     0     0 4784.88930    0  485 -25028.150 4784.88930   119%     -  105s
     0     0 3944.22630    0  528 -25028.150 3944.22630   116%     -  176s
     0     0 3920.59934    0  504 -25028.150 3920.59934   116%     -  205s
     0     0 3920.59934    0  494 -25028.150 3920.59934   116%     -  235s
     0     0 3920.59934    0  499 -25028.150 3920.59934   116%     -  241s
     0     0 3920.59934    0  545 -25028.150 3920.59934   116%     -  259s
     0     0 3920.59934    0  541 -25028.150 3920.59934   116%     -  263s
     0     0 3920.59934    0  542 -25028.150 3920.59934   116%     -  271s
     0     0 3920.59934    0  509 -25028.150 3920.59934   116%     -  280s
     0     0 3920.59934    0  540 -25028.150 3920.59934   116%     -  284s
     0     0 1374.54973    0  495 -25028.150 1374.54973   105%     -  286s
H    0     0                    -24795.78047 1374.54973   106%     -  287s
     0     0 1374.52244    0  503 -24795.780 1374.52244   106%     -  287s
H    0     0                    -23145.50453 1092.31435   105%     -  418s
H    0     0                    -22877.97995 1092.31435   105%     -  418s
H    0     0                    -22869.47266 1092.31435   105%     -  418s
H    0     0                    -22015.93890 1092.31435   105%     -  418s
H    0     0                    -20810.15792 1092.31435   105%     -  418s
     0     0 1092.31435    0  516 -20810.158 1092.31435   105%     -  418s
     0     0  554.26289    0  438 -20810.158  554.26289   103%     -  474s
     0     0  244.28730    0  424 -20810.158  244.28730   101%     -  515s
H    0     0                    -18535.21987  194.28978   101%     -  529s
H    0     0                    -17591.60443  194.28978   101%     -  529s
H    0     0                    -16937.64462  194.28978   101%     -  529s
     0     0  194.28978    0  558 -16937.645  194.28978   101%     -  529s
     0     0  143.53413    0  561 -16937.645  143.53413   101%     -  548s
H    0     0                    -16829.99406  -62.74785   100%     -  583s
H    0     0                    -16326.24873  -62.74785   100%     -  583s
     0     0  -62.74785    0  478 -16326.249  -62.74785   100%     -  583s
     0     0 -186.94778    0  470 -16326.249 -186.94778  98.9%     -  608s
     0     0 -287.95126    0  478 -16326.249 -287.95126  98.2%     -  631s
     0     0 -308.09019    0  485 -16326.249 -308.09019  98.1%     -  641s
     0     0 -323.82210    0  492 -16326.249 -323.82210  98.0%     -  652s
     0     0 -374.58391    0  413 -16326.249 -374.58391  97.7%     -  669s
     0     0 -379.66236    0  415 -16326.249 -379.66236  97.7%     -  676s
     0     0 -384.42028    0  409 -16326.249 -384.42028  97.6%     -  682s
     0     0 -408.48464    0  574 -16326.249 -408.48464  97.5%     -  696s
     0     0 -438.80572    0  594 -16326.249 -438.80572  97.3%     -  712s
     0     0 -442.69633    0  593 -16326.249 -442.69633  97.3%     -  717s
     0     0 -443.17459    0  596 -16326.249 -443.17459  97.3%     -  720s
     0     0 -1816.1357    0  581 -16326.249 -1816.1357  88.9%     -  834s
H    0     0                    -16241.65702 -2601.7547  84.0%     -  891s
     0     0 -2601.7547    0  537 -16241.657 -2601.7547  84.0%     -  891s
     0     0 -2866.2975    0  561 -16241.657 -2866.2975  82.4%     -  920s
     0     0 -2997.2566    0  572 -16241.657 -2997.2566  81.5%     -  937s
     0     0 -3067.9011    0  563 -16241.657 -3067.9011  81.1%     -  950s
     0     0 -3117.3520    0  562 -16241.657 -3117.3520  80.8%     -  961s
     0     0 -3223.5885    0  557 -16241.657 -3223.5885  80.2%     -  977s
H    0     0                    -16087.77369 -3255.6770  79.8%     -  987s
     0     0 -3255.6770    0  557 -16087.774 -3255.6770  79.8%     -  987s
     0     0 -3295.6748    0  569 -16087.774 -3295.6748  79.5%     -  996s
     0     0 -3332.9524    0  564 -16087.774 -3332.9524  79.3%     - 1006s
     0     0 -3342.4716    0  565 -16087.774 -3342.4716  79.2%     - 1009s
     0     0 -3395.5291    0  567 -16087.774 -3395.5291  78.9%     - 1017s
     0     0 -3428.7386    0  600 -16087.774 -3428.7386  78.7%     - 1028s
     0     0 -3442.7727    0  570 -16087.774 -3442.7727  78.6%     - 1035s
     0     0 -3446.9784    0  572 -16087.774 -3446.9784  78.6%     - 1039s
     0     0 -3448.2301    0  576 -16087.774 -3448.2301  78.6%     - 1042s
     0     0 -4131.7082    0  606 -16087.774 -4131.7082  74.3%     - 1099s
     0     0 -4278.0482    0  629 -16087.774 -4278.0482  73.4%     - 1124s
     0     0 -4338.7617    0  697 -16087.774 -4338.7617  73.0%     - 1139s
     0     0 -4353.2688    0  702 -16087.774 -4353.2688  72.9%     - 1145s
     0     0 -4465.5341    0  601 -16087.774 -4465.5341  72.2%     - 1162s
     0     0 -4491.2159    0  538 -16087.774 -4491.2159  72.1%     - 1169s
     0     0 -4498.5030    0  606 -16087.774 -4498.5030  72.0%     - 1173s
     0     0 -4504.3379    0  599 -16087.774 -4504.3379  72.0%     - 1177s
     0     0 -4509.0980    0  553 -16087.774 -4509.0980  72.0%     - 1180s
     0     0 -4513.8743    0  553 -16087.774 -4513.8743  71.9%     - 1184s
     0     0 -4516.8809    0  557 -16087.774 -4516.8809  71.9%     - 1188s
     0     0 -4535.8383    0  544 -16087.774 -4535.8383  71.8%     - 1192s
     0     0 -4538.9811    0  533 -16087.774 -4538.9811  71.8%     - 1195s
     0     0 -4540.4551    0  541 -16087.774 -4540.4551  71.8%     - 1197s
     0     0 -4653.3027    0  553 -16087.774 -4653.3027  71.1%     - 1215s
H    0     0                    -15905.68873 -4653.8702  70.7%     - 1216s
H    0     0                    -15872.82487 -4653.8702  70.7%     - 1216s
H    0     0                    -15860.52378 -4653.8702  70.7%     - 1216s
     0     0 -4695.4289    0  573 -15860.524 -4695.4289  70.4%     - 1228s
     0     0 -4707.0563    0  581 -15860.524 -4707.0563  70.3%     - 1233s
     0     0 -4776.4184    0  578 -15860.524 -4776.4184  69.9%     - 1243s
     0     0 -4785.4355    0  525 -15860.524 -4785.4355  69.8%     - 1247s
     0     0 -4793.5873    0  518 -15860.524 -4793.5873  69.8%     - 1251s
     0     0 -4795.0549    0  521 -15860.524 -4795.0549  69.8%     - 1253s
     0     0 -4823.9577    0  569 -15860.524 -4823.9577  69.6%     - 1262s
     0     0 -4854.1653    0  576 -15860.524 -4854.1653  69.4%     - 1287s
     0     0 -4860.4251    0  581 -15860.524 -4860.4251  69.4%     - 1289s
     0     0 -4861.3780    0  590 -15860.524 -4861.3780  69.3%     - 1290s
     0     0 -4892.4178    0  526 -15860.524 -4892.4178  69.2%     - 1301s
     0     0 -4898.5430    0  524 -15860.524 -4898.5430  69.1%     - 1305s
     0     0 -4900.1326    0  525 -15860.524 -4900.1326  69.1%     - 1307s
     0     0 -4930.8348    0  520 -15860.524 -4930.8348  68.9%     - 1315s
     0     0 -4934.1491    0  531 -15860.524 -4934.1491  68.9%     - 1417s
     0     0 -4934.6366    0  534 -15860.524 -4934.6366  68.9%     - 1418s
     0     0 -4944.6275    0  528 -15860.524 -4944.6275  68.8%     - 1425s
     0     0 -4946.9636    0  538 -15860.524 -4946.9636  68.8%     - 1429s
     0     0 -4952.3448    0  589 -15860.524 -4952.3448  68.8%     - 1435s
     0     0 -4952.4617    0  589 -15860.524 -4952.4617  68.8%     - 1442s
     0     2 -4952.4750    0  589 -15860.524 -4952.4750  68.8%     - 1535s
     1     3 -5406.1362    1  623 -15860.524 -4952.4750  68.8% 13190 1553s
     2     5 -5555.8900    2  565 -15860.524 -4952.4750  68.8% 10825 1564s
     4     9 -5581.3324    3  575 -15860.524 -5089.2642  67.9%  8411 1616s
     8    18 -5467.0497    3  585 -15860.524 -5090.1991  67.9% 11838 1679s
    17    36 -5516.6955    4  558 -15860.524 -5469.0195  65.5% 12649 1719s
    35    49 -6194.5497    5  634 -15860.524 -5516.8572  65.2% 20737 3600s

Cutting planes:
  Learned: 1
  Gomory: 9
  Implied bound: 182
  MIR: 2576
  Flow cover: 2683
  RLT: 149
  Relax-and-lift: 563

Explored 48 nodes (1711021 simplex iterations) in 3600.21 seconds (4163.73 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15860.5 -15872.8 -15905.7 ... -18535.2

Time limit reached
Best objective -1.586052378405e+04, best bound -5.516857175401e+03, gap 65.2164%
  WARNING: Time limit reached. Using best solution found (gap: 65.22%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.23s
  Master Objective (UB) = -15860.52, θ = 131284.04
  Upper Bound (UB) = -15860.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131284.04
  [DEBUG]   ✓ Scenario 0: θ = 131284.04 ≤ Q = 131284.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 131284.04 ≤ Q = 131284.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 131284.04 ≤ Q = 131284.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 131284.04 ≤ Q = 131284.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 131284.04 ≤ Q = 132553.70 (slack: 1269.66)
  [DEBUG]   ✓ Scenario 9: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 131284.04 ≤ Q = 131284.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x15aba2a9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xea545d57
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-15, 2e+02]
Found heuristic solution: objective 1.206365e+13
Presolve removed 2611 rows and 1901 columns
Presolve time: 0.01s
Presolved: 482 rows, 488 columns, 1361 nonzeros
Found heuristic solution: objective 5067009.7818
Variable types: 330 continuous, 158 integer (158 binary)
Found heuristic solution: objective 5066072.4431

Root relaxation: objective -1.593052e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159305.17    0  124 5066072.44 -159305.17   103%     -    0s
H    0     0                    -120232.2621 -159305.17  32.5%     -    0s
H    0     0                    -129672.3063 -159305.17  22.9%     -    0s
H    0     0                    -129875.2199 -159305.17  22.7%     -    0s
     0     0 -139784.29    0   56 -129875.22 -139784.29  7.63%     -    0s
H    0     0                    -137257.3993 -139689.25  1.77%     -    0s
H    0     0                    -137545.4745 -139689.25  1.56%     -    0s
H    0     0                    -137935.6528 -139689.25  1.27%     -    0s
H    0     0                    -138223.7279 -139689.25  1.06%     -    0s
     0     0 -139327.16    0   56 -138223.73 -139327.16  0.80%     -    0s
     0     0 -139326.21    0   56 -138223.73 -139326.21  0.80%     -    0s
     0     0 -138693.05    0   20 -138223.73 -138693.05  0.34%     -    0s
H    0     0                    -138268.2779 -138586.01  0.23%     -    0s
     0     0 -138585.79    0   31 -138268.28 -138585.79  0.23%     -    0s
     0     0 -138580.76    0   30 -138268.28 -138580.76  0.23%     -    0s
     0     0 -138560.64    0   30 -138268.28 -138560.64  0.21%     -    0s
     0     0 -138559.96    0   30 -138268.28 -138559.96  0.21%     -    0s
     0     0 -138415.00    0   17 -138268.28 -138415.00  0.11%     -    0s
     0     0 -138415.00    0   20 -138268.28 -138415.00  0.11%     -    0s
H    0     0                    -138268.9359 -138415.00  0.11%     -    0s
     0     0 -138345.84    0   12 -138268.94 -138345.84  0.06%     -    0s
H    0     0                    -138295.3168 -138336.29  0.03%     -    0s
H    0     0                    -138306.3640 -138336.29  0.02%     -    0s
     0     0 -138336.29    0    8 -138306.36 -138336.29  0.02%     -    0s
     0     0 -138336.29    0    8 -138306.36 -138336.29  0.02%     -    0s
     0     0 -138320.70    0    2 -138306.36 -138320.70  0.01%     -    0s
H    0     0                    -138314.5374 -138320.25  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 8
  MIR: 4
  Flow cover: 6
  Relax-and-lift: 4

Explored 1 nodes (717 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -138315 -138306 -138295 ... -129672

Optimal solution found (tolerance 1.00e-04)
Best objective -1.383145374386e+05, best bound -1.383202511132e+05, gap 0.0041%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 116679.02
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138314.54
  [DEBUG]   S×d_nominal = 254993.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254993.56 + -138314.54 = 116679.02
  [DEBUG]   Current θ from Master = 131284.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14605.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30465.54
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 965.2698, Absolute Gap = 965.2698, Relative Gap = 0.060860
  Not converged yet (gap = 965.27 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0x4ef5ff3e
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 4.02s
Presolved: 124683 rows, 52810 columns, 767643 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.42s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 5.817e+06
 Factor NZ  : 1.359e+07 (roughly 200 MB of memory)
 Factor Ops : 4.017e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70139590e+07  2.34799936e+08  1.04e+05 1.71e+01  8.03e+04     6s
   1  -1.30654903e+07  2.03952104e+08  7.23e+04 7.56e+01  5.51e+04     6s
   2  -5.94163125e+06  1.57063045e+08  3.13e+04 6.28e-01  2.50e+04     7s
   3  -1.00822127e+06  1.15562930e+08  2.46e+03 2.01e+00  2.38e+03     7s
   4  -5.93364659e+05  5.46682024e+07  5.00e+02 6.15e-01  5.83e+02     7s
   5  -5.18397652e+05  3.18814010e+07  2.89e+02 2.88e-01  3.20e+02     7s
   6  -4.01464269e+05  2.37080147e+07  8.03e+01 1.96e-01  1.52e+02     7s
   7  -3.23183544e+05  1.71560856e+07  3.00e+01 1.34e-01  9.15e+01     7s
   8  -2.21311794e+05  1.35952897e+07  1.22e+01 1.04e-01  6.58e+01     7s
   9  -1.53221923e+05  6.31766370e+06  6.90e+00 4.78e-02  3.01e+01     7s
  10  -1.16347369e+05  4.24810472e+06  2.75e+00 3.12e-02  1.96e+01     7s
  11  -1.07746241e+05  2.02739383e+06  1.90e+00 1.48e-02  9.54e+00     8s
  12  -8.52580001e+04  1.10327564e+06  8.74e-01 8.13e-03  5.26e+00     8s
  13  -6.55317798e+04  3.86325222e+05  4.02e-01 2.99e-03  1.99e+00     8s
  14  -3.76817025e+04  1.89581323e+05  1.64e-01 1.59e-03  1.00e+00     8s
  15  -2.83198585e+04  1.37130861e+05  1.20e-01 1.58e-03  7.28e-01     8s
  16  -2.02458711e+04  8.15115708e+04  8.79e-02 1.43e-03  4.47e-01     8s
  17  -1.35166394e+04  5.72116592e+04  6.54e-02 2.42e-03  3.11e-01     8s
  18  -1.06295661e+04  4.82768264e+04  5.59e-02 2.31e-03  2.59e-01     8s
  19  -8.81317305e+03  3.92715394e+04  5.03e-02 2.27e-03  2.11e-01     9s
  20  -3.79021965e+03  3.18522050e+04  3.52e-02 2.97e-03  1.57e-01     9s
  21  -1.88918882e+03  2.65957030e+04  3.00e-02 2.23e-03  1.25e-01     9s
  22   8.37182095e+02  2.39731890e+04  2.28e-02 1.83e-03  1.02e-01     9s
  23   2.10208861e+03  2.27102752e+04  1.97e-02 1.66e-03  9.06e-02     9s
  24   3.81799397e+03  2.03584994e+04  1.56e-02 1.34e-03  7.27e-02     9s
  25   4.90763941e+03  2.00283946e+04  1.31e-02 1.30e-03  6.65e-02     9s
  26   6.05461830e+03  1.80466259e+04  1.05e-02 1.01e-03  5.27e-02    10s
  27   7.01143181e+03  1.65408545e+04  8.42e-03 6.46e-04  4.19e-02    10s
  28   7.43154789e+03  1.57970804e+04  7.51e-03 5.58e-04  3.68e-02    10s
  29   7.87860759e+03  1.46889605e+04  6.59e-03 4.27e-04  2.99e-02    10s
  30   8.51594287e+03  1.41246895e+04  5.32e-03 3.56e-04  2.47e-02    10s
  31   9.04867334e+03  1.36559464e+04  4.33e-03 2.96e-04  2.03e-02    10s
  32   9.15630635e+03  1.34010624e+04  4.12e-03 2.61e-04  1.87e-02    11s
  33   9.63673140e+03  1.30927172e+04  3.19e-03 2.19e-04  1.52e-02    11s
  34   9.87778439e+03  1.29149850e+04  2.76e-03 1.96e-04  1.34e-02    11s
  35   9.91560893e+03  1.28121231e+04  2.68e-03 1.83e-04  1.27e-02    11s
  36   1.02066688e+04  1.26442593e+04  2.14e-03 1.61e-04  1.07e-02    11s
  37   1.04806721e+04  1.25656917e+04  1.66e-03 1.50e-04  9.16e-03    12s
  38   1.05446093e+04  1.24370239e+04  1.54e-03 1.33e-04  8.32e-03    12s
  39   1.06532678e+04  1.22536998e+04  1.33e-03 1.09e-04  7.03e-03    12s
  40   1.07903798e+04  1.20390095e+04  1.08e-03 8.05e-05  5.49e-03    12s
  41   1.08895346e+04  1.19276014e+04  8.98e-04 6.56e-05  4.56e-03    12s
  42   1.10877386e+04  1.17306120e+04  5.54e-04 3.95e-05  2.83e-03    12s
  43   1.11600335e+04  1.16451276e+04  4.31e-04 2.78e-05  2.13e-03    13s
  44   1.12295752e+04  1.15855429e+04  3.12e-04 2.00e-05  1.56e-03    13s
  45   1.12518214e+04  1.15248017e+04  2.76e-04 1.22e-05  1.20e-03    13s
  46   1.12902392e+04  1.14975266e+04  2.14e-04 8.50e-06  9.12e-04    13s
  47   1.13057772e+04  1.14728193e+04  1.90e-04 4.69e-06  7.35e-04    13s
  48   1.13651156e+04  1.14696992e+04  1.00e-04 4.30e-06  4.60e-04    13s
  49   1.13976915e+04  1.14454438e+04  4.97e-05 1.44e-06  2.10e-04    14s
  50   1.14172642e+04  1.14350119e+04  2.00e-05 3.60e-07  7.81e-05    14s
  51   1.14248061e+04  1.14333552e+04  9.64e-06 9.84e-07  3.76e-05    14s
  52   1.14288200e+04  1.14326992e+04  4.17e-06 5.01e-07  1.71e-05    14s
  53   1.14314407e+04  1.14321656e+04  8.34e-07 2.43e-08  3.19e-06    14s
  54   1.14321170e+04  1.14321220e+04  3.07e-08 2.36e-08  2.21e-08    14s
  55   1.14321214e+04  1.14321216e+04  1.83e-07 1.05e-10  6.05e-10    15s
  56   1.14321216e+04  1.14321216e+04  1.84e-08 5.90e-11  5.17e-12    15s

Barrier solved model in 56 iterations and 14.72 seconds (13.63 work units)
Optimal objective 1.14321216e+04


Root crossover log...

  106849 DPushes remaining with DInf 0.0000000e+00                15s
   52903 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    2070 PPushes remaining with PInf 1.7929074e-06                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7873745e-10     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   49002    1.1432122e+04   0.000000e+00   0.000000e+00     20s
   49002    1.1432122e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.65s

Solved with barrier

Root relaxation: objective 1.143212e+04, 49002 iterations, 15.73 seconds (18.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11432.1216    0  273 -201902.96 11432.1216   106%     -   21s
H    0     0                    -59201.19526 11432.1216   119%     -   22s
H    0     0                    -58613.37088 11432.1216   120%     -   22s
H    0     0                    -51778.65169 11432.1216   122%     -   22s
H    0     0                    -31359.72144 11432.1216   136%     -   22s
H    0     0                    -26226.95788 11432.1216   144%     -   24s
H    0     0                    -26223.70808 11432.1216   144%     -   26s
H    0     0                    -25360.63740 5085.58930   120%     -  103s
     0     0 5085.58930    0  321 -25360.637 5085.58930   120%     -  103s
     0     0 3942.39175    0  345 -25360.637 3942.39175   116%     -  157s
     0     0 3883.33873    0  334 -25360.637 3883.33873   115%     -  172s
     0     0 3883.25333    0  377 -25360.637 3883.25333   115%     -  201s
     0     0 3883.25333    0  379 -25360.637 3883.25333   115%     -  204s
     0     0 3883.25333    0  379 -25360.637 3883.25333   115%     -  205s
H    0     0                    -24340.89566 1395.64466   106%     -  307s
H    0     0                    -23887.76818 1395.64466   106%     -  307s
     0     0 1395.64466    0  473 -23887.768 1395.64466   106%     -  307s
H    0     0                    -22587.70866 1395.22865   106%     -  308s
H    0     0                    -21769.24805 1395.22865   106%     -  308s
H    0     0                    -21004.66972 1395.22865   107%     -  308s
H    0     0                    -20701.22583 1395.22865   107%     -  308s
     0     0  619.95801    0  483 -20701.226  619.95801   103%     -  373s
     0     0  556.56471    0  440 -20701.226  556.56471   103%     -  395s
     0     0  482.04947    0  496 -20701.226  482.04947   102%     -  415s
     0     0  429.58624    0  506 -20701.226  429.58624   102%     -  430s
     0     0  373.03554    0  502 -20701.226  373.03554   102%     -  448s
     0     0  207.46047    0  501 -20701.226  207.46047   101%     -  469s
     0     0  187.70036    0  493 -20701.226  187.70036   101%     -  480s
H    0     0                    -18279.38491   81.64573   100%     -  496s
H    0     0                    -17919.81727   81.64573   100%     -  496s
H    0     0                    -17851.35994   81.64573   100%     -  496s
     0     0   81.64573    0  488 -17851.360   81.64573   100%     -  496s
     0     0   65.15795    0  487 -17851.360   65.15795   100%     -  504s
     0     0  -67.96832    0  488 -17851.360  -67.96832   100%     -  529s
     0     0 -117.20744    0  503 -17851.360 -117.20744  99.3%     -  538s
     0     0 -154.97522    0  498 -17851.360 -154.97522  99.1%     -  545s
     0     0 -184.32192    0  490 -17851.360 -184.32192  99.0%     -  552s
     0     0 -194.06943    0  505 -17851.360 -194.06943  98.9%     -  556s
     0     0 -200.64953    0  505 -17851.360 -200.64953  98.9%     -  559s
     0     0 -209.15086    0  504 -17851.360 -209.15086  98.8%     -  562s
     0     0 -210.97334    0  510 -17851.360 -210.97334  98.8%     -  563s
     0     0 -211.39239    0  508 -17851.360 -211.39239  98.8%     -  564s
H    0     0                    -17835.23053 -1780.9779  90.0%     -  633s
H    0     0                    -17782.78382 -1780.9779  90.0%     -  633s
     0     0 -1780.9779    0  454 -17782.784 -1780.9779  90.0%     -  633s
H    0     0                    -17591.48769 -1781.7558  89.9%     -  634s
H    0     0                    -17486.29421 -1781.7558  89.8%     -  634s
H    0     0                    -17259.83480 -1781.7558  89.7%     -  634s
H    0     0                    -17203.00733 -1781.7558  89.6%     -  634s
H    0     0                    -17082.53406 -1781.7558  89.6%     -  634s
H    0     0                    -16930.83081 -1781.7558  89.5%     -  634s
H    0     0                    -16925.93811 -1781.7558  89.5%     -  634s
H    0     0                    -16869.11064 -1781.7558  89.4%     -  634s
     0     0 -2242.3375    0  456 -16869.111 -2242.3375  86.7%     -  677s
     0     0 -2431.3427    0  471 -16869.111 -2431.3427  85.6%     -  699s
     0     0 -2534.6076    0  469 -16869.111 -2534.6076  85.0%     -  718s
     0     0 -2634.6529    0  467 -16869.111 -2634.6529  84.4%     -  733s
     0     0 -2696.6288    0  474 -16869.111 -2696.6288  84.0%     -  741s
     0     0 -2797.0305    0  459 -16869.111 -2797.0305  83.4%     -  750s
     0     0 -2875.4324    0  463 -16869.111 -2875.4324  83.0%     -  760s
     0     0 -2900.4420    0  467 -16869.111 -2900.4420  82.8%     -  766s
     0     0 -2940.9882    0  506 -16869.111 -2940.9882  82.6%     -  775s
     0     0 -2971.2994    0  470 -16869.111 -2971.2994  82.4%     -  783s
     0     0 -2976.9234    0  430 -16869.111 -2976.9234  82.4%     -  787s
     0     0 -2981.8378    0  420 -16869.111 -2981.8378  82.3%     -  789s
     0     0 -2987.9578    0  431 -16869.111 -2987.9578  82.3%     -  791s
     0     0 -3000.3682    0  511 -16869.111 -3000.3682  82.2%     -  794s
     0     0 -3027.8975    0  456 -16869.111 -3027.8975  82.1%     -  800s
     0     0 -3031.0873    0  463 -16869.111 -3031.0873  82.0%     -  802s
     0     0 -3092.2659    0  467 -16869.111 -3092.2659  81.7%     -  813s
     0     0 -3101.6158    0  522 -16869.111 -3101.6158  81.6%     -  817s
     0     0 -3105.5407    0  464 -16869.111 -3105.5407  81.6%     -  821s
     0     0 -3110.6091    0  519 -16869.111 -3110.6091  81.6%     -  825s
     0     0 -3111.8827    0  516 -16869.111 -3111.8827  81.6%     -  827s
     0     0 -3904.5471    0  548 -16869.111 -3904.5471  76.9%     -  870s
     0     0 -4085.6783    0  592 -16869.111 -4085.6783  75.8%     -  893s
     0     0 -4219.2917    0  547 -16869.111 -4219.2917  75.0%     -  908s
     0     0 -4289.1762    0  612 -16869.111 -4289.1762  74.6%     -  921s
     0     0 -4315.9506    0  602 -16869.111 -4315.9506  74.4%     -  928s
     0     0 -4331.7349    0  617 -16869.111 -4331.7349  74.3%     -  933s
     0     0 -4406.0250    0  605 -16869.111 -4406.0250  73.9%     -  942s
     0     0 -4430.8219    0  548 -16869.111 -4430.8219  73.7%     -  948s
     0     0 -4444.3461    0  611 -16869.111 -4444.3461  73.7%     -  952s
     0     0 -4447.0945    0  611 -16869.111 -4447.0945  73.6%     -  954s
     0     0 -4451.6920    0  558 -16869.111 -4451.6920  73.6%     -  956s
     0     0 -4451.8884    0  605 -16869.111 -4451.8884  73.6%     -  957s
     0     0 -4633.7604    0  494 -16869.111 -4633.7604  72.5%     -  977s
     0     0 -4672.9667    0  514 -16869.111 -4672.9667  72.3%     -  985s
     0     0 -4700.9161    0  509 -16869.111 -4700.9161  72.1%     -  990s
     0     0 -4706.5844    0  509 -16869.111 -4706.5844  72.1%     -  992s
     0     0 -4707.7188    0  507 -16869.111 -4707.7188  72.1%     -  994s
H    0     0                    -16826.60560 -4856.8237  71.1%     - 1009s
     0     0 -4856.8237    0  554 -16826.606 -4856.8237  71.1%     - 1009s
     0     0 -4884.4539    0  564 -16826.606 -4884.4539  71.0%     - 1024s
     0     0 -4890.5172    0  560 -16826.606 -4890.5172  70.9%     - 1027s
     0     0 -4896.2217    0  573 -16826.606 -4896.2217  70.9%     - 1031s
     0     0 -4899.0653    0  567 -16826.606 -4899.0653  70.9%     - 1033s
     0     0 -4904.1842    0  574 -16826.606 -4904.1842  70.9%     - 1036s
     0     0 -4909.5336    0  576 -16826.606 -4909.5336  70.8%     - 1039s
     0     0 -4912.1942    0  577 -16826.606 -4912.1942  70.8%     - 1041s
     0     0 -4913.9395    0  523 -16826.606 -4913.9395  70.8%     - 1043s
     0     0 -4967.7464    0  569 -16826.606 -4967.7464  70.5%     - 1053s
     0     0 -4972.6488    0  566 -16826.606 -4972.6488  70.4%     - 1057s
     0     0 -4973.3370    0  568 -16826.606 -4973.3370  70.4%     - 1058s
     0     0 -4998.4361    0  567 -16826.606 -4998.4361  70.3%     - 1066s
     0     0 -5002.6270    0  565 -16826.606 -5002.6270  70.3%     - 1072s
     0     0 -5003.6542    0  569 -16826.606 -5003.6542  70.3%     - 1074s
     0     0 -5011.9633    0  565 -16826.606 -5011.9633  70.2%     - 1081s
     0     0 -5014.4791    0  571 -16826.606 -5014.4791  70.2%     - 1084s
     0     0 -5015.3230    0  571 -16826.606 -5015.3230  70.2%     - 1084s
     0     0 -5022.9913    0  576 -16826.606 -5022.9913  70.1%     - 1090s
     0     0 -5024.5361    0  584 -16826.606 -5024.5361  70.1%     - 1094s
     0     0 -5028.7987    0  579 -16826.606 -5028.7987  70.1%     - 1099s
     0     0 -5029.0676    0  579 -16826.606 -5029.0676  70.1%     - 1107s
H    0     0                    -16740.69432 -5029.0676  70.0%     - 1237s
     0     2 -5029.0676    0  579 -16740.694 -5029.0676  70.0%     - 1244s
     1     4 -5053.3292    1  543 -16740.694 -5030.6065  69.9%  4001 1253s
     3     8 -5164.7147    2  542 -16740.694 -5053.3833  69.8%  5812 1274s
     7    15 -5343.3040    3  552 -16740.694 -5164.7781  69.1%  8713 1312s
    14    30 -5427.2428    4  559 -16740.694 -5317.1913  68.2% 11086 1349s
    29    43 -6353.5098    5  431 -16740.694 -5392.5530  67.8% 16648 1415s
    44    66 -8785.2269    6  371 -16740.694 -5392.5530  67.8% 18599 1555s
    71   114 -7064.5093    7  356 -16740.694 -5392.5530  67.8% 18717 1676s
   119   210 -7235.5192    9  350 -16740.694 -5392.5530  67.8% 15154 1727s
   227   311 -7443.5684   13  337 -16740.694 -5392.5530  67.8% 10042 1761s
   330   385 -11577.854   18  252 -16740.694 -5392.5530  67.8%  8016 1789s
   404   447 -11598.486   19  253 -16740.694 -5392.5530  67.8%  7191 1815s
   466   510 -12343.485   21  296 -16740.694 -5392.5530  67.8%  6884 1839s
H  489   510                    -16541.89979 -5392.5530  67.4%  6711 1839s
   533   582 -12406.471   22  287 -16541.900 -5392.5530  67.4%  6519 1867s
H  609   632                    -16477.77151 -5392.5530  67.3%  6229 1886s
H  620   632                    -16281.56085 -5392.5530  66.9%  6185 1886s
   663   691 -13191.566   25  267 -16281.561 -5392.5530  66.9%  6161 1907s
   734   739 -13288.312   26  269 -16281.561 -5392.5530  66.9%  6209 1924s
   796   801 -13308.570   27  231 -16281.561 -5392.5530  66.9%  6158 1940s
   876   860 -13606.451   28  201 -16281.561 -5392.5530  66.9%  6156 1960s
   945   929 -13730.810   30  194 -16281.561 -5392.5530  66.9%  6109 1981s
H 1038   957                    -16220.35412 -5392.5530  66.8%  5976 2014s
  1087  1034 -14617.963   37  165 -16220.354 -5392.5530  66.8%  5992 2034s
  1184  1060 -15363.367   40  175 -16220.354 -5392.5530  66.8%  5929 2046s
H 1218  1084                    -16139.82646 -5392.5530  66.6%  5923 2067s
  1272  1184     cutoff   42      -16139.826 -5392.5530  66.6%  5900 2092s
  1406  1196     cutoff   41      -16139.826 -5392.5530  66.6%  5764 2117s
  1446  1222 -11496.640   26  312 -16139.826 -5392.5530  66.6%  5747 2138s
H 1457  1222                    -16097.04249 -5392.5530  66.5%  5738 2138s
  1488  1309 -11667.988   28  296 -16097.042 -5392.5530  66.5%  5757 2163s
  1627  1357 -12201.069   31  272 -16097.042 -5392.5530  66.5%  5648 2194s
  1757  1415 infeasible   33      -16097.042 -5392.5530  66.5%  5585 2224s
  1860  1485 -15202.430   36  213 -16097.042 -5392.5530  66.5%  5699 2254s
  2001  1517     cutoff   41      -16097.042 -5392.5530  66.5%  5640 2286s
  2099  1566 -11155.382   33  425 -16097.042 -5392.5530  66.5%  5654 2320s
  2203  1609 -11168.526   34  374 -16097.042 -5392.5530  66.5%  5680 2352s
H 2204  1609                    -16026.90190 -5392.5530  66.4%  5677 2352s
  2276  1699 -11253.343   35  378 -16026.902 -5392.5530  66.4%  5734 2385s
  2406  1770 -11464.262   38  358 -16026.902 -5392.5530  66.4%  5757 2423s
  2534  1857 -12655.757   42  208 -16026.902 -5392.5530  66.4%  5787 2462s
  2668  1964 -13588.540   47  312 -16026.902 -5392.5530  66.4%  5816 2498s
  2814  2037 -13960.684   53  249 -16026.902 -5714.0756  64.3%  5801 2541s
  2951  2117 -14361.441   61  289 -16026.902 -5714.0756  64.3%  5843 2584s
  3081  2177 infeasible   65      -16026.902 -5714.0756  64.3%  5856 2625s
  3181  2267 -8555.2037    9  467 -16026.902 -5714.0756  64.3%  5904 2668s
  3330  2339 -8907.7067   10  459 -16026.902 -6571.1273  59.0%  5937 2712s
  3437  2466 -10067.591   11  367 -16026.902 -6574.1597  59.0%  5957 2762s
  3606  2567 -10953.976   13  259 -16026.902 -6574.1597  59.0%  5941 2811s
  3791  2639 -14286.602   16  174 -16026.902 -6615.1043  58.7%  5939 2858s
H 3838  2596                    -15727.06266 -6615.1043  57.9%  5933 2858s
H 3902  2557                    -15591.89534 -6615.1043  57.6%  5944 2894s
H 3902  2538                    -15530.55887 -6615.1043  57.4%  5944 2903s
H 3902  2500                    -15408.00424 -6615.1043  57.1%  5944 2912s
H 3902  2472                    -15329.00294 -6615.1043  56.8%  5944 2920s
H 3902  2411                    -15156.68960 -6615.1043  56.4%  5944 2935s
H 3902  2258                    -14800.59275 -6615.1043  55.3%  5944 2941s
H 3902  2250                    -14772.71163 -6615.1043  55.2%  5944 2946s
  3903  2228 -11628.920   48  579 -14772.712 -6615.1043  55.2%  5942 3208s
  3905  2229 -13592.679   18  219 -14772.712 -6615.1043  55.2%  5939 3232s
H 3905  2117                    -14710.42723 -6615.1043  55.0%  5939 3378s
H 3905  2011                    -14692.69835 -6615.1043  55.0%  5939 3378s
H 3905  1910                    -14671.19573 -6615.1043  54.9%  5939 3378s
H 3905  1815                    -14661.39185 -6615.1043  54.9%  5939 3378s
H 3905  1724                    -14649.19729 -6615.1043  54.8%  5939 3378s
  3907  1726 -8381.4370   15  465 -14649.197 -6615.1043  54.8%  5936 3481s
  3908  1726 -9972.6807   28  487 -14649.197 -6615.1043  54.8%  5935 3552s
  3909  1727 -9138.2039   20  475 -14649.197 -6615.1043  54.8%  5933 3587s

Cutting planes:
  Gomory: 5
  Implied bound: 4
  Projected implied bound: 51
  MIR: 863
  Mixing: 3
  Flow cover: 737
  RLT: 28
  Relax-and-lift: 83

Explored 3909 nodes (24001968 simplex iterations) in 3600.04 seconds (5216.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14649.2 -14661.4 -14671.2 ... -15408

Time limit reached
Best objective -1.464919729260e+04, best bound -6.615104294135e+03, gap 54.8432%
  WARNING: Time limit reached. Using best solution found (gap: 54.84%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -14649.20, θ = 128998.49
  Upper Bound (UB) = -14649.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128998.49
  [DEBUG]   ✓ Scenario 0: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128998.49 ≤ Q = 128998.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128998.49 ≤ Q = 128998.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128998.49 ≤ Q = 128998.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128998.49 ≤ Q = 128998.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 128998.49 ≤ Q = 128998.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 128998.49 ≤ Q = 128998.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 128998.49 ≤ Q = 128998.49 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x66b5ba92
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x66b5ba92
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.182865e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5134958.9619
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5134504.9207

Root relaxation: objective -1.514961e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151496.11    0  122 5134504.92 -151496.11   103%     -    0s
H    0     0                    -114800.4047 -151496.11  32.0%     -    0s
H    0     0                    -115335.9236 -151496.11  31.4%     -    0s
     0     0 -129432.35    0   98 -115335.92 -129432.35  12.2%     -    0s
H    0     0                    -125621.1014 -129277.37  2.91%     -    0s
     0     0 -128541.81    0   60 -125621.10 -128541.81  2.33%     -    0s
H    0     0                    -127305.8817 -128488.24  0.93%     -    0s
     0     0 -128441.44    0   56 -127305.88 -128441.44  0.89%     -    0s
H    0     0                    -127375.2380 -128441.44  0.84%     -    0s
     0     0 -128044.46    0   52 -127375.24 -128044.46  0.53%     -    0s
     0     0 -127945.61    0   49 -127375.24 -127945.61  0.45%     -    0s
     0     0 -127940.62    0   49 -127375.24 -127940.62  0.44%     -    0s
     0     0 -127669.48    0   17 -127375.24 -127669.48  0.23%     -    0s
     0     0 -127579.67    0   19 -127375.24 -127579.67  0.16%     -    0s
     0     0 -127578.67    0   19 -127375.24 -127578.67  0.16%     -    0s
     0     0 -127510.45    0   11 -127375.24 -127510.45  0.11%     -    0s
     0     0 -127487.42    0   13 -127375.24 -127487.42  0.09%     -    0s
     0     0 -127458.39    0    9 -127375.24 -127458.39  0.07%     -    0s
     0     0 -127458.39    0   23 -127375.24 -127458.39  0.07%     -    0s
     0     0          -    0      -127375.24 -127387.35  0.01%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 2
  MIR: 14
  Flow cover: 4
  Relax-and-lift: 6

Explored 1 nodes (743 simplex iterations) in 0.16 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -127375 -127306 -125621 ... 1.18287e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.273752380012e+05, best bound -1.273873543759e+05, gap 0.0095%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 121971.35
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127375.24
  [DEBUG]   S×d_nominal = 249346.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249346.59 + -127375.24 = 121971.35
  [DEBUG]   Current θ from Master = 128998.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7027.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21676.33
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2176.5963, Absolute Gap = 2176.5963, Relative Gap = 0.148581
  Not converged yet (gap = 2176.60 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x4729c0d1
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 4.14s
Presolved: 132903 rows, 56180 columns, 818430 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.63s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 6.534e+06
 Factor NZ  : 1.436e+07 (roughly 200 MB of memory)
 Factor Ops : 3.124e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.74653353e+07  2.48203964e+08  1.07e+05 1.62e+01  8.19e+04     8s
   1  -1.34614816e+07  2.16302197e+08  7.44e+04 7.47e+01  5.64e+04     8s
   2  -6.18590689e+06  1.66500491e+08  3.26e+04 6.38e-01  2.59e+04     8s
   3  -1.02974884e+06  1.22815868e+08  2.54e+03 1.74e+00  2.43e+03     8s
   4  -6.03227482e+05  6.04969486e+07  5.16e+02 6.09e-01  6.04e+02     8s
   5  -5.28087456e+05  3.66208644e+07  3.00e+02 2.97e-01  3.40e+02     9s
   6  -4.12782033e+05  2.67104846e+07  7.39e+01 1.97e-01  1.55e+02     9s
   7  -3.49014433e+05  1.93503307e+07  3.03e+01 1.34e-01  9.62e+01     9s
   8  -2.27096311e+05  1.36562289e+07  7.47e+00 9.22e-02  6.02e+01     9s
   9  -1.53709322e+05  6.73569385e+06  4.30e+00 4.34e-02  2.93e+01     9s
  10  -1.32525599e+05  3.41932445e+06  2.63e+00 2.24e-02  1.50e+01     9s
  11  -1.19079515e+05  2.50264780e+06  1.96e+00 1.63e-02  1.10e+01     9s
  12  -9.80114780e+04  2.29579402e+06  1.02e+00 1.49e-02  9.95e+00    10s
  13  -7.92228906e+04  1.28482277e+06  4.66e-01 8.18e-03  5.64e+00    10s
  14  -5.38632791e+04  2.59447114e+05  1.53e-01 1.64e-03  1.29e+00    10s
  15  -3.97713798e+04  1.52592238e+05  1.03e-01 1.42e-03  7.94e-01    10s
  16  -3.03498992e+04  1.08577104e+05  8.12e-02 1.71e-03  5.73e-01    10s
  17  -2.35446724e+04  8.01748233e+04  6.63e-02 1.46e-03  4.28e-01    10s
  18  -1.73717937e+04  6.41780080e+04  5.34e-02 2.07e-03  3.36e-01    10s
  19  -1.13879600e+04  4.75183672e+04  4.04e-02 2.02e-03  2.43e-01    11s
  20  -8.55091482e+03  3.89507399e+04  3.46e-02 1.67e-03  1.96e-01    11s
  21  -4.90581132e+03  3.19826252e+04  2.70e-02 1.29e-03  1.52e-01    11s
  22  -3.58292740e+03  2.85935531e+04  2.45e-02 1.11e-03  1.33e-01    11s
  23   2.26887130e+02  2.47687009e+04  1.72e-02 8.64e-04  1.01e-01    11s
  24   1.81446839e+03  2.28027252e+04  1.44e-02 7.39e-04  8.66e-02    12s
  25   3.88688496e+03  2.01311711e+04  1.09e-02 5.40e-04  6.70e-02    12s
  26   4.57821024e+03  1.78671676e+04  9.79e-03 4.20e-04  5.48e-02    12s
  27   6.01548956e+03  1.67772294e+04  7.58e-03 4.02e-04  4.44e-02    12s
  28   7.21129459e+03  1.56197899e+04  5.73e-03 3.13e-04  3.47e-02    13s
  29   7.92230755e+03  1.44697975e+04  4.67e-03 2.45e-04  2.70e-02    13s
  30   8.40066519e+03  1.42695958e+04  3.98e-03 2.28e-04  2.42e-02    13s
  31   9.04599492e+03  1.34501150e+04  3.07e-03 1.54e-04  1.82e-02    13s
  32   9.41784071e+03  1.31183619e+04  2.55e-03 1.29e-04  1.53e-02    13s
  33   9.58600340e+03  1.28811943e+04  2.33e-03 1.11e-04  1.36e-02    14s
  34   1.00734675e+04  1.24785208e+04  1.71e-03 8.18e-05  9.92e-03    14s
  35   1.03254744e+04  1.22372549e+04  1.38e-03 6.61e-05  7.89e-03    14s
  36   1.05103345e+04  1.20313288e+04  1.14e-03 4.84e-05  6.28e-03    14s
  37   1.06088815e+04  1.19124751e+04  9.98e-04 3.91e-05  5.38e-03    15s
  38   1.08404249e+04  1.17803337e+04  6.98e-04 3.68e-05  3.88e-03    15s
  39   1.09655934e+04  1.16340288e+04  5.40e-04 2.16e-05  2.76e-03    15s
  40   1.10915683e+04  1.16036876e+04  3.82e-04 1.85e-05  2.11e-03    15s
  41   1.11957374e+04  1.15387027e+04  2.55e-04 1.24e-05  1.42e-03    16s
  42   1.12431732e+04  1.15253590e+04  2.01e-04 9.92e-06  1.16e-03    16s
  43   1.12703847e+04  1.15036423e+04  1.68e-04 7.97e-06  9.62e-04    16s
  44   1.13181654e+04  1.14860718e+04  1.13e-04 6.27e-06  6.93e-04    16s
  45   1.13383435e+04  1.14800781e+04  8.96e-05 6.06e-06  5.85e-04    16s
  46   1.13586799e+04  1.14537745e+04  6.60e-05 3.74e-06  3.92e-04    17s
  47   1.14016991e+04  1.14331206e+04  1.86e-05 2.01e-06  1.30e-04    17s
  48   1.14120321e+04  1.14219943e+04  6.87e-06 3.26e-07  4.11e-05    17s
  49   1.14153370e+04  1.14214405e+04  3.52e-06 2.63e-07  2.52e-05    17s
  50   1.14172912e+04  1.14194375e+04  1.52e-06 2.61e-08  8.86e-06    18s
  51   1.14189733e+04  1.14191392e+04  5.06e-08 1.90e-08  6.84e-07    18s
  52   1.14190383e+04  1.14191342e+04  2.35e-09 1.80e-08  3.95e-07    18s
  53   1.14190388e+04  1.14191219e+04  1.07e-07 1.56e-08  3.42e-07    18s
  54   1.14190404e+04  1.14190445e+04  4.09e-08 1.52e-09  1.69e-08    19s
  55   1.14190417e+04  1.14190417e+04  1.13e-09 1.01e-09  1.84e-10    19s

Barrier solved model in 55 iterations and 18.91 seconds (15.32 work units)
Optimal objective 1.14190417e+04


Root crossover log...

  114396 DPushes remaining with DInf 0.0000000e+00                19s
   59571 DPushes remaining with DInf 0.0000000e+00                20s
    6115 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    4610 PPushes remaining with PInf 3.1884962e-05                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.4112902e-01     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57384    1.1419042e+04   0.000000e+00   7.411290e-01     28s
   57390    1.1419042e+04   0.000000e+00   0.000000e+00     28s
   57390    1.1419042e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 1.47s

Solved with barrier

Root relaxation: objective 1.141904e+04, 57390 iterations, 24.70 seconds (27.83 work units)
Total elapsed time = 30.28s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11419.0417    0  263 -201902.96 11419.0417   106%     -   30s
H    0     0                    -198035.3455 11419.0417   106%     -   31s
H    0     0                    -132057.2531 11419.0417   109%     -   32s
H    0     0                    -63894.81190 11419.0417   118%     -   32s
H    0     0                    -63740.33642 11419.0417   118%     -   32s
H    0     0                    -20781.08188 11419.0417   155%     -   32s
H    0     0                    -20555.13001 11419.0417   156%     -   34s
H    0     0                    -20456.69335 11419.0417   156%     -   34s
     0     0 4968.88678    0  365 -20456.693 4968.88678   124%     -  108s
H    0     0                    -17643.24196 4949.92978   128%     -  109s
H    0     0                    -17521.58093 4949.92978   128%     -  109s
H    0     0                    -17501.69542 4949.92978   128%     -  110s
     0     0 4642.18142    0  349 -17501.695 4642.18142   127%     -  141s
     0     0 4577.30215    0  347 -17501.695 4577.30215   126%     -  151s
     0     0 4569.72189    0  349 -17501.695 4569.72189   126%     -  152s
     0     0 4569.72189    0  349 -17501.695 4569.72189   126%     -  155s
     0     0 1858.97547    0  444 -17501.695 1858.97547   111%     -  230s
H    0     0                    -17498.44563 1858.87205   111%     -  231s
     0     0 1452.31938    0  461 -17498.446 1452.31938   108%     -  285s
     0     0 1249.14493    0  457 -17498.446 1249.14493   107%     -  315s
     0     0 1183.66212    0  461 -17498.446 1183.66212   107%     -  328s
     0     0 1124.81843    0  456 -17498.446 1124.81843   106%     -  343s
     0     0 1064.51423    0  478 -17498.446 1064.51423   106%     -  362s
     0     0  990.62076    0  464 -17498.446  990.62076   106%     -  375s
     0     0  935.23768    0  476 -17498.446  935.23768   105%     -  387s
     0     0  887.94677    0  480 -17498.446  887.94677   105%     -  398s
     0     0  880.10795    0  463 -17498.446  880.10795   105%     -  404s
     0     0  851.51685    0  475 -17498.446  851.51685   105%     -  411s
     0     0  789.76309    0  482 -17498.446  789.76309   105%     -  421s
     0     0  772.91845    0  474 -17498.446  772.91845   104%     -  428s
     0     0  744.29356    0  478 -17498.446  744.29356   104%     -  436s
     0     0  742.47797    0  485 -17498.446  742.47797   104%     -  439s
     0     0  719.33779    0  466 -17498.446  719.33779   104%     -  452s
     0     0  703.04244    0  468 -17498.446  703.04244   104%     -  460s
     0     0  678.76270    0  473 -17498.446  678.76270   104%     -  470s
     0     0  669.99271    0  475 -17498.446  669.99271   104%     -  475s
     0     0  666.47873    0  474 -17498.446  666.47873   104%     -  478s
     0     0  665.67484    0  473 -17498.446  665.67484   104%     -  480s
     0     0 -1076.6807    0  511 -17498.446 -1076.6807  93.8%     -  586s
H    0     0                    -17135.20328 -1076.7247  93.7%     -  587s
H    0     0                    -17046.86044 -1076.7247  93.7%     -  587s
     0     0 -1819.6381    0  509 -17046.860 -1819.6381  89.3%     -  652s
     0     0 -1966.0277    0  513 -17046.860 -1966.0277  88.5%     -  672s
     0     0 -2022.8089    0  461 -17046.860 -2022.8089  88.1%     -  684s
     0     0 -2066.8181    0  447 -17046.860 -2066.8181  87.9%     -  697s
     0     0 -2111.4558    0  492 -17046.860 -2111.4558  87.6%     -  711s
     0     0 -2152.1240    0  511 -17046.860 -2152.1240  87.4%     -  723s
     0     0 -2242.4227    0  547 -17046.860 -2242.4227  86.8%     -  744s
     0     0 -2289.2388    0  567 -17046.860 -2289.2388  86.6%     -  755s
     0     0 -2302.9367    0  569 -17046.860 -2302.9367  86.5%     -  759s
     0     0 -2317.9399    0  578 -17046.860 -2317.9399  86.4%     -  765s
     0     0 -2370.7701    0  570 -17046.860 -2370.7701  86.1%     -  777s
     0     0 -2417.4965    0  522 -17046.860 -2417.4965  85.8%     -  788s
     0     0 -2427.8525    0  571 -17046.860 -2427.8525  85.8%     -  792s
     0     0 -2436.9089    0  558 -17046.860 -2436.9089  85.7%     -  796s
     0     0 -2438.8191    0  561 -17046.860 -2438.8191  85.7%     -  798s
     0     0 -2452.4590    0  561 -17046.860 -2452.4590  85.6%     -  801s
     0     0 -2458.2014    0  563 -17046.860 -2458.2014  85.6%     -  805s
     0     0 -2459.5866    0  563 -17046.860 -2459.5866  85.6%     -  806s
     0     0 -3456.8510    0  463 -17046.860 -3456.8510  79.7%     -  866s
     0     0 -3786.2478    0  566 -17046.860 -3786.2478  77.8%     -  894s
     0     0 -3836.5005    0  567 -17046.860 -3836.5005  77.5%     -  903s
     0     0 -3913.6213    0  557 -17046.860 -3913.6213  77.0%     -  914s
     0     0 -3948.2217    0  569 -17046.860 -3948.2217  76.8%     -  924s
     0     0 -3963.9572    0  579 -17046.860 -3963.9572  76.7%     -  929s
     0     0 -3974.1548    0  592 -17046.860 -3974.1548  76.7%     -  936s
     0     0 -3975.5892    0  591 -17046.860 -3975.5892  76.7%     -  938s
     0     0 -4165.5685    0  569 -17046.860 -4165.5685  75.6%     -  962s
     0     0 -4253.2304    0  583 -17046.860 -4253.2304  75.0%     -  976s
     0     0 -4279.3106    0  582 -17046.860 -4279.3106  74.9%     -  984s
     0     0 -4312.7621    0  587 -17046.860 -4312.7621  74.7%     -  989s
     0     0 -4331.9749    0  584 -17046.860 -4331.9749  74.6%     -  994s
     0     0 -4336.4082    0  600 -17046.860 -4336.4082  74.6%     -  998s
     0     0 -4347.2969    0  537 -17046.860 -4347.2969  74.5%     - 1003s
     0     0 -4349.2188    0  528 -17046.860 -4349.2188  74.5%     - 1008s
     0     0 -4461.4356    0  515 -17046.860 -4461.4356  73.8%     - 1024s
H    0     0                    -17014.26777 -4461.4558  73.8%     - 1036s
H    0     0                    -16988.73439 -4461.4558  73.7%     - 1038s
H    0     0                    -16798.61604 -4461.4558  73.4%     - 1038s
     0     0 -4478.4395    0  459 -16798.616 -4478.4395  73.3%     - 1045s
     0     0 -4488.8879    0  501 -16798.616 -4488.8879  73.3%     - 1051s
     0     0 -4497.0683    0  401 -16798.616 -4497.0683  73.2%     - 1054s
     0     0 -4502.0486    0  518 -16798.616 -4502.0486  73.2%     - 1058s
     0     0 -4502.6487    0  522 -16798.616 -4502.6487  73.2%     - 1059s
     0     0 -4553.8682    0  516 -16798.616 -4553.8682  72.9%     - 1074s
     0     0 -4571.1833    0  531 -16798.616 -4571.1833  72.8%     - 1080s
     0     0 -4577.0087    0  601 -16798.616 -4577.0087  72.8%     - 1085s
     0     0 -4578.2610    0  524 -16798.616 -4578.2610  72.7%     - 1087s
     0     0 -4597.4706    0  533 -16798.616 -4597.4706  72.6%     - 1094s
     0     0 -4601.3203    0  524 -16798.616 -4601.3203  72.6%     - 1101s
     0     0 -4605.7104    0  541 -16798.616 -4605.7104  72.6%     - 1105s
     0     0 -4609.0157    0  529 -16798.616 -4609.0157  72.6%     - 1108s
     0     0 -4612.2343    0  408 -16798.616 -4612.2343  72.5%     - 1110s
     0     0 -4613.1638    0  549 -16798.616 -4613.1638  72.5%     - 1113s
     0     0 -4655.1116    0  588 -16798.616 -4655.1116  72.3%     - 1125s
     0     0 -4664.4217    0  603 -16798.616 -4664.4217  72.2%     - 1131s
     0     0 -4666.8253    0  479 -16798.616 -4666.8253  72.2%     - 1133s
     0     0 -4670.0654    0  607 -16798.616 -4670.0654  72.2%     - 1137s
     0     0 -4672.5386    0  464 -16798.616 -4672.5386  72.2%     - 1140s
     0     0 -4674.7523    0  603 -16798.616 -4674.7523  72.2%     - 1142s
     0     0 -4698.3504    0  591 -16798.616 -4698.3504  72.0%     - 1151s
     0     0 -4704.4633    0  606 -16798.616 -4704.4633  72.0%     - 1184s
     0     0 -4706.4531    0  492 -16798.616 -4706.4531  72.0%     - 1185s
     0     0 -4752.9046    0  596 -16798.616 -4752.9046  71.7%     - 1200s
     0     0 -4780.1717    0  583 -16798.616 -4780.1717  71.5%     - 1209s
     0     0 -4787.6417    0  582 -16798.616 -4787.6417  71.5%     - 1212s
     0     0 -4790.1272    0  590 -16798.616 -4790.1272  71.5%     - 1213s
     0     0 -4794.8261    0  591 -16798.616 -4794.8261  71.5%     - 1216s
     0     0 -4796.3011    0  592 -16798.616 -4796.3011  71.4%     - 1218s
     0     0 -4808.6898    0  602 -16798.616 -4808.6898  71.4%     - 1224s
     0     0 -4812.8214    0  604 -16798.616 -4812.8214  71.3%     - 1227s
     0     0 -4814.0371    0  498 -16798.616 -4814.0371  71.3%     - 1229s
     0     0 -4826.6162    0  592 -16798.616 -4826.6162  71.3%     - 1237s
     0     0 -4828.8683    0  604 -16798.616 -4828.8683  71.3%     - 1240s
     0     0 -4835.3650    0  471 -16798.616 -4835.3650  71.2%     - 1248s
     0     0 -4838.4125    0  523 -16798.616 -4838.4125  71.2%     - 1257s
     0     0 -4839.5772    0  628 -16798.616 -4839.5772  71.2%     - 1261s
     0     0 -4842.3970    0  476 -16798.616 -4842.3970  71.2%     - 1267s
     0     0 -4843.1329    0  596 -16798.616 -4843.1329  71.2%     - 1269s
     0     0 -4844.8514    0  492 -16798.616 -4844.8514  71.2%     - 1275s
     0     0 -4845.1800    0  492 -16798.616 -4845.1800  71.2%     - 1282s
     0     2 -4845.2514    0  492 -16798.616 -4845.2514  71.2%     - 1438s
     1     4 -4936.9563    1  451 -16798.616 -4845.2514  71.2%  7097 1453s
     3     8 -5130.5379    2  577 -16798.616 -4937.7429  70.6%  8984 1480s
     7    16 -5289.1140    3  596 -16798.616 -5130.5881  69.5% 11833 1516s
    15    32 -5495.1934    4  594 -16798.616 -5289.3466  68.5% 12715 1540s
    31    48 -5874.3359    5  466 -16798.616 -5495.3713  67.3% 17541 1612s
    47    79 -7619.2224    6  348 -16798.616 -5495.3713  67.3% 20334 1674s
    78   148 -6383.3821    7  462 -16798.616 -5495.3713  67.3% 17465 1773s
   147   181 -6594.3639    8  503 -16798.616 -5495.3713  67.3% 12988 1803s
   180   234 -6650.9488    9  443 -16798.616 -5495.3713  67.3% 12043 1846s
   235   272 -7865.5455   10  359 -16798.616 -5495.3713  67.3% 10561 1891s
   285   326 -10364.108   11  333 -16798.616 -5495.3713  67.3% 10089 1934s
   349   377 -10883.859   12  338 -16798.616 -5495.3713  67.3% 10049 1969s
   416   458 -11264.666   13  312 -16798.616 -5495.3713  67.3%  9633 2005s
   499   517 -11383.072   14  366 -16798.616 -5495.3713  67.3%  9142 2039s
   567   567 -11576.217   15  365 -16798.616 -5495.3713  67.3%  8854 2069s
   635   599 -12214.823   18  429 -16798.616 -5495.3713  67.3%  8828 2099s
   698   638 -12412.194   19  427 -16798.616 -5495.3713  67.3%  8661 2128s
   766   683 -12738.716   21  379 -16798.616 -5495.3713  67.3%  8553 2153s
H  806   683                    -16765.87638 -5495.3713  67.2%  8423 2153s
   829   719 -14631.174   23  359 -16765.876 -5495.3713  67.2%  8408 2181s
   920   748 -15965.112   25  324 -16765.876 -5495.3713  67.2%  8186 2209s
H  940   748                    -15516.63876 -5495.3713  64.6%  8118 2209s
H  945   748                    -15301.74412 -5495.3713  64.1%  8097 2209s
   995   718     cutoff   27      -15301.744 -5495.3713  64.1%  7975 2242s
H 1005   718                    -15205.79063 -5495.3713  63.9%  7932 2242s
H 1007   718                    -15160.52952 -5495.3713  63.8%  7922 2242s
H 1015   718                    -15056.91079 -5495.3713  63.5%  7918 2242s
H 1027   718                    -15021.55140 -5495.3713  63.4%  7860 2242s
  1057   772 -10166.658   20  335 -15021.551 -5495.3713  63.4%  7814 2274s
  1120   848 -10357.144   22  255 -15021.551 -5495.3713  63.4%  7971 2306s
  1206   919 -10840.553   24  234 -15021.551 -5495.3713  63.4%  7926 2338s
H 1321   962                    -14806.16754 -5495.3713  62.9%  7743 2368s
H 1333   962                    -14632.55455 -5495.3713  62.4%  7747 2368s
  1390  1002 -12398.192   29  199 -14632.555 -5495.3713  62.4%  7705 2404s
  1487  1080 -12673.631   31  177 -14632.555 -5495.3713  62.4%  7636 2435s
  1593  1137 -13632.367   40  143 -14632.555 -5495.3713  62.4%  7554 2474s
  1694  1177 -14334.436   49  119 -14632.555 -5495.3713  62.4%  7489 2512s
  1800  1235 -14471.560   60   33 -14632.555 -5495.3713  62.4%  7394 2553s
  1922  1276 -14523.220   71   63 -14632.555 -5495.3713  62.4%  7280 2597s
  2025  1311 -8793.2311    8  453 -14632.555 -5495.3713  62.4%  7264 2637s
H 2036  1311                    -14578.78153 -5495.3713  62.3%  7283 2637s
H 2046  1311                    -14558.78825 -5495.3713  62.3%  7299 2637s
  2142  1322 -9808.7612    9  450 -14558.788 -5495.3713  62.3%  7237 2680s
  2194  1381 -12391.672   10  443 -14558.788 -5495.3713  62.3%  7356 2726s
  2297  1424 -13109.871   11  414 -14558.788 -5495.3713  62.3%  7329 2771s
  2409  1457 -14176.884   12  413 -14558.788 -5495.3713  62.3%  7329 2822s
  2491  1509     cutoff   13      -14558.788 -5495.3713  62.3%  7450 2869s
  2588  1550 -13854.986   12  331 -14558.788 -5495.3713  62.3%  7547 2916s
  2683  1608 -14412.780   13  241 -14558.788 -5580.0864  61.7%  7701 2970s
  2818  1660     cutoff   14      -14558.788 -5580.0864  61.7%  7770 3025s
  2930  1734     cutoff   12      -14558.788 -5580.0864  61.7%  7912 3081s
  3088  1784 -10832.848   11  440 -14558.788 -5580.0864  61.7%  7923 3140s
  3249  1771 -13469.554   14  327 -14558.788 -6291.8644  56.8%  7935 3208s
  3408  1801 -12426.193   13  326 -14558.788 -6291.8644  56.8%  7969 3275s
H 3420  1789                    -14502.31577 -6291.8644  56.6%  7987 3275s
  3543  1891 -12638.236   14  272 -14502.316 -6291.8644  56.6%  7933 3339s
  3701  1988 infeasible   16      -14502.316 -6291.8644  56.6%  8007 3405s
  3868  2045 infeasible   19      -14502.316 -6291.8644  56.6%  8089 3473s
  4045  2103 -8855.3448   10  310 -14502.316 -6291.8644  56.6%  8193 3549s
  4224  2124 -11357.828   13  408 -14502.316 -6291.8644  56.6%  8298 3600s
H 4225  2118                    -14485.96534 -6291.8644  56.6%  8296 3600s

Cutting planes:
  Learned: 2
  Gomory: 5
  Implied bound: 217
  MIR: 3214
  Flow cover: 3586
  RLT: 91
  Relax-and-lift: 574

Explored 4265 nodes (36310138 simplex iterations) in 3600.13 seconds (5910.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14486 -14502.3 -14558.8 ... -15205.8

Time limit reached
Best objective -1.448596533672e+04, best bound -7.327572757715e+03, gap 49.4161%
  WARNING: Time limit reached. Using best solution found (gap: 49.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = -14485.97, θ = 128643.50
  Upper Bound (UB) = -14485.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128643.50
  [DEBUG]   ✓ Scenario 0: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128643.50 ≤ Q = 128643.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128643.50 ≤ Q = 129417.87 (slack: 774.38)
  [DEBUG]   ✓ Scenario 5: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 128643.50 ≤ Q = 128643.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 128643.50 ≤ Q = 128643.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 128643.50 ≤ Q = 128643.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 128643.50 ≤ Q = 128643.50 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x76c25143
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x76c25143
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.176341e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5127719.9231
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5127265.8819

Root relaxation: objective -1.516848e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151684.83    0  122 5127265.88 -151684.83   103%     -    0s
H    0     0                    -115102.2804 -151684.83  31.8%     -    0s
H    0     0                    -115434.8467 -151684.83  31.4%     -    0s
     0     0 -125166.45    0   80 -115434.85 -125166.45  8.43%     -    0s
H    0     0                    -120326.4774 -125050.60  3.93%     -    0s
H    0     0                    -120614.5525 -125050.60  3.68%     -    0s
H    0     0                    -121849.5638 -125050.60  2.63%     -    0s
H    0     0                    -122137.6390 -125050.60  2.38%     -    0s
     0     0 -123882.55    0   57 -122137.64 -123882.55  1.43%     -    0s
H    0     0                    -122477.8214 -123866.88  1.13%     -    0s
H    0     0                    -122761.4435 -123866.88  0.90%     -    0s
     0     0 -123578.28    0   54 -122761.44 -123578.28  0.67%     -    0s
H    0     0                    -122951.2474 -123531.66  0.47%     -    0s
     0     0 -123522.56    0   54 -122951.25 -123522.56  0.46%     -    0s
     0     0 -123501.73    0   60 -122951.25 -123501.73  0.45%     -    0s
     0     0 -123310.25    0   40 -122951.25 -123310.25  0.29%     -    0s
     0     0 -123275.39    0   35 -122951.25 -123275.39  0.26%     -    0s
     0     0 -123183.08    0   32 -122951.25 -123183.08  0.19%     -    0s
H    0     0                    -122976.3543 -123182.37  0.17%     -    0s
     0     0 -123180.62    0   32 -122976.35 -123180.62  0.17%     -    0s
     0     0 -123130.54    0   13 -122976.35 -123130.54  0.13%     -    0s
     0     0 -123130.00    0   11 -122976.35 -123130.00  0.12%     -    0s
     0     0 -123129.64    0   11 -122976.35 -123129.64  0.12%     -    0s
     0     0 -123110.31    0   29 -122976.35 -123110.31  0.11%     -    0s
     0     0 -123109.89    0   29 -122976.35 -123109.89  0.11%     -    0s
H    0     0                    -122994.6245 -123109.89  0.09%     -    0s
     0     0 -123109.89    0   72 -122994.62 -123109.89  0.09%     -    0s
     0     0 -123109.89    0   72 -122994.62 -123109.89  0.09%     -    0s
     0     0 -123109.89    0   29 -122994.62 -123109.89  0.09%     -    0s
H    0     0                    -123025.1274 -123109.89  0.07%     -    0s
     0     0 -123109.89    0   28 -123025.13 -123109.89  0.07%     -    0s
     0     0 -123109.89    0   27 -123025.13 -123109.89  0.07%     -    0s
H    0     0                    -123028.8788 -123095.97  0.05%     -    0s
H    0     0                    -123043.1010 -123095.97  0.04%     -    0s
     0     0 -123095.97    0   27 -123043.10 -123095.97  0.04%     -    0s
     0     0 -123095.75    0   27 -123043.10 -123095.75  0.04%     -    0s
     0     0 -123083.67    0   27 -123043.10 -123083.67  0.03%     -    0s
     0     0 -123083.67    0   31 -123043.10 -123083.67  0.03%     -    0s
     0     0 -123083.67    0   25 -123043.10 -123083.67  0.03%     -    0s
     0     0 -123083.67    0   23 -123043.10 -123083.67  0.03%     -    0s
     0     0 -123075.30    0   24 -123043.10 -123075.30  0.03%     -    0s
     0     0 -123072.74    0   25 -123043.10 -123072.74  0.02%     -    0s
     0     0 -123071.23    0   25 -123043.10 -123071.23  0.02%     -    0s
     0     0 -123068.42    0   25 -123043.10 -123068.42  0.02%     -    0s
     0     0 -123063.40    0   24 -123043.10 -123063.40  0.02%     -    0s
     0     0 -123062.82    0   24 -123043.10 -123062.82  0.02%     -    0s
     0     0 -123054.75    0   24 -123043.10 -123054.75  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 4
  MIR: 36
  Flow cover: 3
  RLT: 1

Explored 1 nodes (1216 simplex iterations) in 0.27 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -123043 -123029 -123025 ... -121850

Optimal solution found (tolerance 1.00e-04)
Best objective -1.230431010102e+05, best bound -1.230547464242e+05, gap 0.0095%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 126115.56
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123043.10
  [DEBUG]   S×d_nominal = 249158.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249158.66 + -123043.10 = 126115.56
  [DEBUG]   Current θ from Master = 128643.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2527.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17013.90
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2339.8283, Absolute Gap = 2339.8283, Relative Gap = 0.161524
  Not converged yet (gap = 2339.83 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x084d3498
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns (presolve time = 5s)...
Presolve removed 120190 rows and 48790 columns
Presolve time: 5.01s
Presolved: 141123 rows, 59550 columns, 869071 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.54s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 7.293e+06
 Factor NZ  : 1.634e+07 (roughly 200 MB of memory)
 Factor Ops : 3.907e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78841199e+07  2.61590108e+08  1.10e+05 1.56e+01  8.34e+04     8s
   1  -1.38325251e+07  2.28479178e+08  7.64e+04 7.42e+01  5.76e+04     8s
   2  -6.41019038e+06  1.75928428e+08  3.37e+04 8.25e-01  2.67e+04     8s
   3  -1.05343413e+06  1.30964873e+08  2.64e+03 2.21e+00  2.50e+03     8s
   4  -6.12768497e+05  6.55355556e+07  5.33e+02 7.40e-01  6.21e+02     8s
   5  -5.36143928e+05  3.92103302e+07  3.10e+02 3.63e-01  3.47e+02     8s
   6  -4.25962525e+05  2.85713577e+07  8.71e+01 2.39e-01  1.63e+02     8s
   7  -3.43608203e+05  2.11042682e+07  3.43e+01 1.68e-01  1.00e+02     9s
   8  -2.23689616e+05  1.39993527e+07  4.99e+00 1.05e-01  5.71e+01     9s
   9  -1.45899248e+05  8.36432049e+06  2.42e+00 6.12e-02  3.36e+01     9s
  10  -1.24598802e+05  4.70566844e+06  1.37e+00 3.50e-02  1.90e+01     9s
  11  -1.13350347e+05  2.56840505e+06  9.89e-01 1.92e-02  1.05e+01     9s
  12  -9.04797456e+04  1.68187823e+06  4.32e-01 1.23e-02  6.91e+00     9s
  13  -6.84041796e+04  4.90056951e+05  1.77e-01 3.76e-03  2.17e+00     9s
  14  -4.30925479e+04  2.06798387e+05  7.69e-02 1.86e-03  9.71e-01     9s
  15  -3.20038504e+04  1.38967632e+05  5.58e-02 1.63e-03  6.64e-01     9s
  16  -2.56667606e+04  9.16719964e+04  4.66e-02 1.66e-03  4.56e-01    10s
  17  -2.07829296e+04  7.44820828e+04  4.00e-02 2.18e-03  3.70e-01    10s
  18  -1.55568806e+04  6.12726686e+04  3.27e-02 1.97e-03  2.99e-01    10s
  19  -1.06853074e+04  5.15737577e+04  2.57e-02 1.56e-03  2.42e-01    10s
  20  -8.10504130e+03  4.07133874e+04  2.22e-02 1.15e-03  1.90e-01    10s
  21  -4.98987640e+03  3.22982504e+04  1.80e-02 8.35e-04  1.45e-01    10s
  22  -2.51223578e+03  2.86587547e+04  1.50e-02 6.92e-04  1.21e-01    10s
  23  -1.18459137e+02  2.49520863e+04  1.21e-02 5.48e-04  9.74e-02    11s
  24   1.80369590e+03  2.25644346e+04  9.87e-03 4.51e-04  8.07e-02    11s
  25   4.42923841e+03  2.01750073e+04  6.91e-03 3.55e-04  6.12e-02    11s
  26   4.77648202e+03  1.86358229e+04  6.54e-03 2.99e-04  5.39e-02    11s
  27   6.39324030e+03  1.70923816e+04  4.91e-03 2.30e-04  4.16e-02    11s
  28   7.19533430e+03  1.58221515e+04  4.11e-03 1.75e-04  3.35e-02    11s
  29   7.60293407e+03  1.47149874e+04  3.71e-03 1.31e-04  2.76e-02    12s
  30   8.10349114e+03  1.39286667e+04  3.24e-03 9.57e-05  2.26e-02    12s
  31   8.70152962e+03  1.37289291e+04  2.69e-03 8.75e-05  1.95e-02    12s
  32   8.92011700e+03  1.35755087e+04  2.49e-03 8.09e-05  1.81e-02    12s
  33   9.40534390e+03  1.33826659e+04  2.03e-03 7.18e-05  1.55e-02    12s
  34   9.99014920e+03  1.29045079e+04  1.50e-03 5.32e-05  1.13e-02    12s
  35   1.01669421e+04  1.26975689e+04  1.34e-03 4.41e-05  9.83e-03    13s
  36   1.05200364e+04  1.24296486e+04  1.00e-03 3.09e-05  7.42e-03    13s
  37   1.07347572e+04  1.22979584e+04  8.04e-04 2.56e-05  6.07e-03    13s
  38   1.10010425e+04  1.20509250e+04  5.67e-04 1.52e-05  4.08e-03    13s
  39   1.11514435e+04  1.19799872e+04  4.37e-04 1.22e-05  3.22e-03    13s
  40   1.12835687e+04  1.18953020e+04  3.24e-04 8.63e-06  2.38e-03    13s
  41   1.13711893e+04  1.18323544e+04  2.51e-04 5.90e-06  1.79e-03    14s
  42   1.14373221e+04  1.17916835e+04  1.96e-04 6.57e-06  1.38e-03    14s
  43   1.14605390e+04  1.17840922e+04  1.77e-04 6.11e-06  1.26e-03    14s
  44   1.15030868e+04  1.17706990e+04  1.42e-04 5.28e-06  1.04e-03    14s
  45   1.15868804e+04  1.17354346e+04  7.74e-05 2.97e-06  5.77e-04    14s
  46   1.16253882e+04  1.17046903e+04  4.62e-05 1.15e-06  3.08e-04    14s
  47   1.16517974e+04  1.16942981e+04  2.53e-05 4.08e-07  1.65e-04    15s
  48   1.16722401e+04  1.16926039e+04  9.91e-06 3.28e-07  7.91e-05    15s
  49   1.16823929e+04  1.16906924e+04  2.36e-06 4.24e-07  3.22e-05    15s
  50   1.16844019e+04  1.16892762e+04  1.07e-06 2.91e-07  1.89e-05    15s
  51   1.16853004e+04  1.16885636e+04  5.04e-07 2.25e-07  1.27e-05    15s
  52   1.16855200e+04  1.16880450e+04  3.65e-07 1.77e-07  9.80e-06    15s
  53   1.16856735e+04  1.16871103e+04  2.69e-07 9.02e-08  5.58e-06    16s
  54   1.16860557e+04  1.16864388e+04  2.45e-08 3.06e-08  1.49e-06    16s
  55   1.16860571e+04  1.16862511e+04  2.38e-08 1.34e-08  7.54e-07    16s
  56   1.16861048e+04  1.16861061e+04  3.42e-09 1.91e-08  4.76e-09    16s
  57   1.16861058e+04  1.16861059e+04  4.21e-07 7.81e-10  4.06e-10    16s

Barrier solved model in 57 iterations and 16.24 seconds (16.64 work units)
Optimal objective 1.16861058e+04


Root crossover log...

  121275 DPushes remaining with DInf 0.0000000e+00                16s
   26762 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    9505 PPushes remaining with PInf 6.8268929e-05                24s
    1047 PPushes remaining with PInf 1.5036742e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9634597e+02     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66816    1.1686106e+04   0.000000e+00   1.963460e+02     25s
   66968    1.1686106e+04   0.000000e+00   0.000000e+00     26s
   66968    1.1686106e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 7.00s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.168611e+04, 66968 iterations, 26.66 seconds (30.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11686.1059    0  266 -201902.96 11686.1059   106%     -   34s
H    0     0                    -198035.3455 11686.1059   106%     -   34s
H    0     0                    -191657.5150 11686.1059   106%     -   36s
H    0     0                    -191181.1424 11686.1059   106%     -   36s
H    0     0                    -191129.2806 11686.1059   106%     -   36s
H    0     0                    -63894.81190 11686.1059   118%     -   37s
H    0     0                    -63740.33642 11686.1059   118%     -   37s
H    0     0                    -26233.61553 11686.1059   145%     -   38s
H    0     0                    -21544.34351 11686.1059   154%     -   38s
H    0     0                    -21077.58715 11686.1059   155%     -   39s
H    0     0                    -20955.01130 11686.1059   156%     -   39s
H    0     0                    -20456.69335 11686.1059   157%     -   39s
     0     0 5142.17705    0  342 -20456.693 5142.17705   125%     -  132s
H    0     0                    -17798.41923 5135.55172   129%     -  133s
H    0     0                    -17286.32676 5135.55172   130%     -  134s
     0     0 4717.41592    0  374 -17286.327 4717.41592   127%     -  157s
     0     0 4688.66523    0  369 -17286.327 4688.66523   127%     -  166s
     0     0 4688.65592    0  369 -17286.327 4688.65592   127%     -  171s
     0     0 2091.23310    0  489 -17286.327 2091.23310   112%     -  239s
H    0     0                    -17283.07696 2090.99742   112%     -  240s
     0     0 1241.69517    0  441 -17283.077 1241.69517   107%     -  294s
     0     0  614.12956    0  448 -17283.077  614.12956   104%     -  337s
     0     0  486.26115    0  471 -17283.077  486.26115   103%     -  366s
     0     0  440.66024    0  484 -17283.077  440.66024   103%     -  384s
     0     0  414.21236    0  485 -17283.077  414.21236   102%     -  401s
     0     0  402.36633    0  470 -17283.077  402.36633   102%     -  409s
     0     0  381.79958    0  483 -17283.077  381.79958   102%     -  419s
     0     0  348.09250    0  474 -17283.077  348.09250   102%     -  429s
     0     0  333.02094    0  475 -17283.077  333.02094   102%     -  436s
     0     0  313.34095    0  479 -17283.077  313.34095   102%     -  447s
     0     0  300.54880    0  485 -17283.077  300.54880   102%     -  454s
     0     0  245.21591    0  482 -17283.077  245.21591   101%     -  469s
     0     0  233.13774    0  503 -17283.077  233.13774   101%     -  477s
     0     0  231.80141    0  506 -17283.077  231.80141   101%     -  482s
     0     0  135.61677    0  496 -17283.077  135.61677   101%     -  494s
     0     0  132.31617    0  501 -17283.077  132.31617   101%     -  496s
     0     0  131.89063    0  503 -17283.077  131.89063   101%     -  499s
     0     0 -2003.4849    0  537 -17283.077 -2003.4849  88.4%     -  600s
     0     0 -2446.1965    0  501 -17283.077 -2446.1965  85.8%     -  644s
     0     0 -2642.6528    0  571 -17283.077 -2642.6528  84.7%     -  671s
     0     0 -2726.4269    0  571 -17283.077 -2726.4269  84.2%     -  691s
     0     0 -2771.3918    0  578 -17283.077 -2771.3918  84.0%     -  701s
     0     0 -2780.5731    0  586 -17283.077 -2780.5731  83.9%     -  708s
     0     0 -2867.6813    0  585 -17283.077 -2867.6813  83.4%     -  720s
     0     0 -2923.9938    0  595 -17283.077 -2923.9938  83.1%     -  731s
     0     0 -2967.5916    0  547 -17283.077 -2967.5916  82.8%     -  741s
     0     0 -2973.7048    0  546 -17283.077 -2973.7048  82.8%     -  744s
     0     0 -2975.4931    0  546 -17283.077 -2975.4931  82.8%     -  746s
     0     0 -2979.3489    0  548 -17283.077 -2979.3489  82.8%     -  750s
     0     0 -3017.7608    0  588 -17283.077 -3017.7608  82.5%     -  760s
     0     0 -3061.6318    0  556 -17283.077 -3061.6318  82.3%     -  773s
     0     0 -3082.5828    0  546 -17283.077 -3082.5828  82.2%     -  779s
     0     0 -3086.0292    0  540 -17283.077 -3086.0292  82.1%     -  781s
     0     0 -3088.5216    0  546 -17283.077 -3088.5216  82.1%     -  783s
     0     0 -3094.3390    0  591 -17283.077 -3094.3390  82.1%     -  787s
     0     0 -3174.1658    0  570 -17283.077 -3174.1658  81.6%     -  798s
     0     0 -3205.7255    0  594 -17283.077 -3205.7255  81.5%     -  806s
     0     0 -3213.5937    0  596 -17283.077 -3213.5937  81.4%     -  810s
     0     0 -3216.8297    0  603 -17283.077 -3216.8297  81.4%     -  813s
     0     0 -3217.5448    0  600 -17283.077 -3217.5448  81.4%     -  814s
     0     0 -3926.3178    0  541 -17283.077 -3926.3178  77.3%     -  861s
     0     0 -4162.8677    0  521 -17283.077 -4162.8677  75.9%     -  903s
     0     0 -4294.4742    0  593 -17283.077 -4294.4742  75.2%     -  927s
     0     0 -4380.2593    0  591 -17283.077 -4380.2593  74.7%     -  939s
     0     0 -4417.5194    0  592 -17283.077 -4417.5194  74.4%     -  950s
     0     0 -4458.9872    0  602 -17283.077 -4458.9872  74.2%     -  960s
     0     0 -4471.5655    0  609 -17283.077 -4471.5655  74.1%     -  964s
     0     0 -4472.8960    0  608 -17283.077 -4472.8960  74.1%     -  966s
     0     0 -4603.5334    0  571 -17283.077 -4603.5334  73.4%     -  984s
     0     0 -4655.2159    0  536 -17283.077 -4655.2159  73.1%     -  996s
     0     0 -4677.5984    0  541 -17283.077 -4677.5984  72.9%     - 1002s
     0     0 -4683.1305    0  537 -17283.077 -4683.1305  72.9%     - 1005s
     0     0 -4684.1033    0  539 -17283.077 -4684.1033  72.9%     - 1009s
     0     0 -4773.2586    0  549 -17283.077 -4773.2586  72.4%     - 1023s
     0     0 -4799.5021    0  512 -17283.077 -4799.5021  72.2%     - 1035s
     0     0 -4806.5782    0  518 -17283.077 -4806.5782  72.2%     - 1039s
     0     0 -4808.8405    0  537 -17283.077 -4808.8405  72.2%     - 1041s
     0     0 -4842.6097    0  532 -17283.077 -4842.6097  72.0%     - 1051s
     0     0 -4857.6607    0  538 -17283.077 -4857.6607  71.9%     - 1057s
     0     0 -4871.0340    0  532 -17283.077 -4871.0340  71.8%     - 1062s
     0     0 -4879.1417    0  579 -17283.077 -4879.1417  71.8%     - 1064s
     0     0 -4885.2946    0  584 -17283.077 -4885.2946  71.7%     - 1068s
     0     0 -4889.2195    0  598 -17283.077 -4889.2195  71.7%     - 1070s
     0     0 -4891.0855    0  585 -17283.077 -4891.0855  71.7%     - 1072s
     0     0 -4899.8181    0  591 -17283.077 -4899.8181  71.6%     - 1079s
     0     0 -4903.4386    0  587 -17283.077 -4903.4386  71.6%     - 1083s
     0     0 -4904.9388    0  592 -17283.077 -4904.9388  71.6%     - 1085s
     0     0 -4915.0159    0  594 -17283.077 -4915.0159  71.6%     - 1092s
     0     0 -4919.5599    0  589 -17283.077 -4919.5599  71.5%     - 1096s
     0     0 -4921.1081    0  601 -17283.077 -4921.1081  71.5%     - 1097s
     0     0 -4927.7206    0  590 -17283.077 -4927.7206  71.5%     - 1104s
     0     0 -4930.9947    0  588 -17283.077 -4930.9947  71.5%     - 1109s
     0     0 -4932.7171    0  594 -17283.077 -4932.7171  71.5%     - 1111s
     0     0 -4934.8168    0  606 -17283.077 -4934.8168  71.4%     - 1116s
     0     0 -4935.0842    0  606 -17283.077 -4935.0842  71.4%     - 1126s
H    0     0                    -17074.38814 -4935.1073  71.1%     - 1259s
H    0     0                    -17054.50262 -4935.1073  71.1%     - 1262s
H    0     2                    -17046.86044 -4935.1073  71.0%     - 1268s
     0     2 -4935.1073    0  606 -17046.860 -4935.1073  71.0%     - 1268s
     1     4 -5008.9700    1  530 -17046.860 -4935.1073  71.0%  4586 1278s
     3     6 -5660.1037    2  537 -17046.860 -5010.7623  70.6% 10315 1318s
     5     9 -5911.2387    3  546 -17046.860 -5010.7623  70.6% 12427 1343s
     8    17 -5680.3466    3  535 -17046.860 -5276.8089  69.0% 12817 1377s
    16    34 -5835.6494    4  576 -17046.860 -5383.1316  68.4% 12334 1397s
    33    49 -7098.1205    5  518 -17046.860 -5467.6819  67.9% 16499 1486s
    48    75 -8132.4755    6  402 -17046.860 -5467.6819  67.9% 22955 1647s
    78   132 -8239.6945    7  329 -17046.860 -5467.6819  67.9% 17657 1708s
H   81   132                    -16536.98222 -5467.6819  66.9% 17113 1708s
   135   249 -9042.6005    9  290 -16536.982 -5467.6819  66.9% 13575 1770s
   260   277 -9099.0667   10  298 -16536.982 -5467.6819  66.9%  9825 1798s
   290   311 -7994.3551   13  400 -16536.982 -5467.6819  66.9%  9249 1832s
   324   335 -8562.1669   10  378 -16536.982 -5467.6819  66.9%  8998 1868s
H  326   335                    -16331.93200 -5467.6819  66.5%  8949 1869s
   350   384 -8856.9575   18  386 -16331.932 -5467.6819  66.5%  8816 1906s
   401   448 -8721.8685   10  317 -16331.932 -5467.6819  66.5%  8464 1943s
   472   512 -9209.2015   11  318 -16331.932 -5467.6819  66.5%  8169 1976s
   546   539 -9818.7993   12  355 -16331.932 -5467.6819  66.5%  8028 2001s
H  552   539                    -16111.18530 -5467.6819  66.1%  8035 2001s
H  560   539                    -16109.77868 -5467.6819  66.1%  8026 2001s
   580   589 -9471.5889   28  420 -16109.779 -5467.6819  66.1%  8020 2030s
   652   648 -10070.633   12  305 -16109.779 -5467.6819  66.1%  8129 2059s
   731   722 -14088.457   13  340 -16109.779 -5467.6819  66.1%  7968 2082s
   813   766 -10002.079   13  291 -16109.779 -5467.6819  66.1%  7768 2108s
   897   817 -10813.371   14  298 -16109.779 -5467.6819  66.1%  7566 2135s
   982   878 -14410.802   14  355 -16109.779 -5467.6819  66.1%  7407 2164s
  1083   890     cutoff   15      -16109.779 -5467.6819  66.1%  7206 2191s
H 1094   890                    -15947.87098 -5467.6819  65.7%  7208 2191s
H 1116   890                    -15744.11518 -5467.6819  65.3%  7170 2191s
  1121   928 -15743.007   15  325 -15744.115 -5588.3783  64.5%  7161 2221s
  1216   952 -5878.7344    6  514 -15744.115 -5588.6648  64.5%  7089 2251s
  1316   960 -5909.3334    7  402 -15744.115 -5588.6648  64.5%  7012 2281s
  1396   974 -6290.4674    8  383 -15744.115 -5588.6648  64.5%  6995 2313s
  1472   995 -6459.0784   10  446 -15744.115 -5588.6648  64.5%  7027 2350s
  1563  1074 -6759.8621   12  423 -15744.115 -5588.6648  64.5%  7049 2386s
  1678  1120 -7116.1276   15  279 -15744.115 -5588.6648  64.5%  7016 2420s
  1789  1181 -7739.0674   19  353 -15744.115 -5588.6648  64.5%  6973 2459s
  1923  1232 -8282.2869   22  350 -15744.115 -5588.6648  64.5%  6939 2498s
  2038  1307 -9920.1679   26  360 -15744.115 -5588.6648  64.5%  6946 2533s
  2143  1380 -11710.311   29  281 -15744.115 -5588.6648  64.5%  6992 2570s
  2264  1487 -12698.982   35  280 -15744.115 -5588.6648  64.5%  6993 2615s
  2388  1586 -13288.219   41  272 -15744.115 -5588.6648  64.5%  7049 2656s
  2555  1630 -14776.564   52  243 -15744.115 -5588.6648  64.5%  6991 2706s
  2671  1667     cutoff   21      -15744.115 -5742.0083  63.5%  7031 2752s
  2786  1734 -9091.9539   15  446 -15744.115 -5742.0083  63.5%  7060 2805s
  2923  1798 -13045.904   17  291 -15744.115 -5742.0083  63.5%  7115 2855s
  3053  1906 -13505.700   18  261 -15744.115 -5742.0083  63.5%  7178 2907s
  3198  2009 -14369.567   20  291 -15744.115 -5742.0083  63.5%  7180 2964s
H 3321  1918                    -15153.52652 -5900.5533  61.1%  7242 2964s
  3341  1945 -15135.054   24  149 -15153.527 -5900.5533  61.1%  7251 3025s
* 3450  1937              65    -15133.96144 -5900.5533  61.0%  7355 3025s
* 3455  1924              69    -15080.89924 -5900.5533  60.9%  7344 3025s
  3477  1945     cutoff   25      -15080.899 -5900.5533  60.9%  7341 3081s
H 3485  1873                    -14921.99707 -5900.5533  60.5%  7371 3081s
H 3511  1864                    -14899.90352 -5900.5533  60.4%  7394 3081s
H 3516  1817                    -14762.29290 -5900.5533  60.0%  7401 3081s
  3552  1869 -9786.0990   17  213 -14762.293 -5900.5533  60.0%  7436 3140s
  3658  1902 -13871.430   22  212 -14762.293 -6728.7368  54.4%  7599 3204s
H 3662  1901                    -14752.22963 -6728.7368  54.4%  7610 3204s
H 3679  1888                    -14691.97910 -6728.7368  54.2%  7657 3204s
  3709  1995 -13940.224   23  205 -14691.979 -6728.7368  54.2%  7686 3270s
  3866  2087 -14605.113   28  152 -14691.979 -6728.7368  54.2%  7810 3334s
H 3892  2080                    -14678.60458 -6728.7368  54.2%  7836 3334s
H 3945  2056                    -14623.75995 -6728.7368  54.0%  7897 3334s
H 4010  2043                    -14558.33320 -6728.7368  53.8%  7924 3417s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 236
  MIR: 3208
  Flow cover: 3572
  RLT: 72
  Relax-and-lift: 647
  PSD: 1

Explored 4010 nodes (32423681 simplex iterations) in 3600.12 seconds (5720.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14558.3 -14623.8 -14678.6 ... -15134

Time limit reached
Best objective -1.455833319603e+04, best bound -6.728736813330e+03, gap 53.7809%
  WARNING: Time limit reached. Using best solution found (gap: 53.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = -14558.33, θ = 128599.07
  Upper Bound (UB) = -14558.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128599.07
  [DEBUG]   ✓ Scenario 0: θ = 128599.07 ≤ Q = 128599.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128599.07 ≤ Q = 128599.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128599.07 ≤ Q = 128599.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 128599.07 ≤ Q = 128599.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 128599.07 ≤ Q = 128599.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 128599.07 ≤ Q = 128599.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xd89f44c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0d89f44c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.164275e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5101050.9172
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5100596.8760

Root relaxation: objective -1.514948e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151494.80    0  122 5100596.88 -151494.80   103%     -    0s
H    0     0                    -114322.6077 -151494.80  32.5%     -    0s
H    0     0                    -115138.1155 -151494.80  31.6%     -    0s
     0     0 -125027.51    0   55 -115138.12 -125027.51  8.59%     -    0s
H    0     0                    -122835.5950 -124961.95  1.73%     -    0s
H    0     0                    -123139.0771 -124961.95  1.48%     -    0s
H    0     0                    -123213.5916 -124961.95  1.42%     -    0s
H    0     0                    -123517.0737 -124961.95  1.17%     -    0s
     0     0 -124325.18    0   59 -123517.07 -124325.18  0.65%     -    0s
     0     0 -124008.37    0   45 -123517.07 -124008.37  0.40%     -    0s
H    0     0                    -123550.1419 -123925.28  0.30%     -    0s
     0     0 -123925.28    0   53 -123550.14 -123925.28  0.30%     -    0s
     0     0 -123917.22    0   55 -123550.14 -123917.22  0.30%     -    0s
     0     0 -123853.12    0   32 -123550.14 -123853.12  0.25%     -    0s
H    0     0                    -123584.9345 -123836.04  0.20%     -    0s
     0     0 -123836.04    0   30 -123584.93 -123836.04  0.20%     -    0s
     0     0 -123805.91    0   11 -123584.93 -123805.91  0.18%     -    0s
     0     0 -123803.40    0   11 -123584.93 -123803.40  0.18%     -    0s
     0     0 -123776.68    0   11 -123584.93 -123776.68  0.16%     -    0s
     0     0 -123776.35    0   11 -123584.93 -123776.35  0.15%     -    0s
H    0     0                    -123592.9413 -123776.35  0.15%     -    0s
     0     0 -123776.35    0   53 -123592.94 -123776.35  0.15%     -    0s
     0     0 -123657.01    0    5 -123592.94 -123657.01  0.05%     -    0s
H    0     0                    -123645.7382 -123651.59  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 13
  MIR: 33
  Flow cover: 11
  RLT: 1

Explored 1 nodes (819 simplex iterations) in 0.28 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -123646 -123593 -123585 ... 5.10105e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.236457381656e+05, best bound -1.236515898297e+05, gap 0.0047%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 125217.98
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123645.74
  [DEBUG]   S×d_nominal = 248863.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 248863.72 + -123645.74 = 125217.98
  [DEBUG]   Current θ from Master = 128599.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3381.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17939.42
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2267.4604, Absolute Gap = 2267.4604, Relative Gap = 0.155750
  Not converged yet (gap = 2267.46 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0xbbe27cf4
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns (presolve time = 5s)...
Presolve removed 127260 rows and 51660 columns
Presolve time: 5.11s
Presolved: 149343 rows, 62920 columns, 919432 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.59s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 8.073e+06
 Factor NZ  : 1.872e+07 (roughly 240 MB of memory)
 Factor Ops : 6.007e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82811296e+07  2.74313623e+08  1.12e+05 1.52e+01  8.47e+04     8s
   1  -1.41901458e+07  2.40154359e+08  7.83e+04 7.38e+01  5.86e+04     9s
   2  -6.62541906e+06  1.85017152e+08  3.49e+04 7.60e-01  2.75e+04     9s
   3  -1.06762031e+06  1.38544873e+08  2.70e+03 1.92e+00  2.54e+03     9s
   4  -6.19583496e+05  7.06505492e+07  5.46e+02 6.21e-01  6.34e+02     9s
   5  -5.41742403e+05  4.17172196e+07  3.19e+02 2.98e-01  3.53e+02     9s
   6  -4.33610431e+05  3.04176008e+07  9.44e+01 1.95e-01  1.68e+02     9s
   7  -3.80023881e+05  2.16119632e+07  5.59e+01 1.29e-01  1.09e+02     9s
   8  -2.65511248e+05  1.48400116e+07  1.78e+01 8.16e-02  6.26e+01     9s
   9  -1.67150221e+05  9.12938481e+06  5.24e+00 4.75e-02  3.56e+01    10s
  10  -1.31318051e+05  4.92567287e+06  2.95e+00 2.48e-02  1.90e+01    10s
  11  -1.17949081e+05  2.86831799e+06  2.06e+00 1.40e-02  1.12e+01    10s
  12  -9.56924131e+04  2.30462098e+06  8.67e-01 1.11e-02  8.88e+00    10s
  13  -7.69344701e+04  6.37572138e+05  3.68e-01 3.05e-03  2.63e+00    10s
  14  -5.13914862e+04  2.62150682e+05  1.53e-01 1.37e-03  1.15e+00    10s
  15  -3.76849390e+04  1.73750190e+05  1.02e-01 9.66e-04  7.77e-01    10s
  16  -2.81541165e+04  1.00704485e+05  7.67e-02 1.63e-03  4.74e-01    10s
  17  -1.96275719e+04  7.17718682e+04  5.74e-02 1.50e-03  3.36e-01    11s
  18  -1.38338142e+04  5.49743209e+04  4.50e-02 1.53e-03  2.53e-01    11s
  19  -1.15722587e+04  4.81317870e+04  4.03e-02 1.45e-03  2.19e-01    11s
  20  -8.96712147e+03  4.26723346e+04  3.51e-02 1.21e-03  1.90e-01    11s
  21  -6.51817955e+03  3.36424841e+04  3.02e-02 1.18e-03  1.48e-01    11s
  22  -2.68537386e+03  2.98957221e+04  2.28e-02 8.68e-04  1.20e-01    11s
  23  -8.21743457e+02  2.63697004e+04  1.95e-02 7.04e-04  1.00e-01    12s
  24   1.88654549e+03  2.33176853e+04  1.47e-02 4.46e-04  7.88e-02    12s
  25   2.90434245e+03  2.06045204e+04  1.31e-02 3.42e-04  6.51e-02    12s
  26   5.35312890e+03  1.86590256e+04  9.12e-03 2.65e-04  4.89e-02    12s
  27   6.25702641e+03  1.80318332e+04  7.79e-03 2.39e-04  4.33e-02    12s
  28   7.46826677e+03  1.60576436e+04  6.04e-03 1.58e-04  3.16e-02    13s
  29   8.11177646e+03  1.52022586e+04  5.13e-03 3.58e-04  2.61e-02    13s
  30   8.84331031e+03  1.48220051e+04  4.15e-03 3.26e-04  2.20e-02    13s
  31   9.11069311e+03  1.46087131e+04  3.77e-03 3.01e-04  2.02e-02    13s
  32   9.36667246e+03  1.43452339e+04  3.41e-03 2.71e-04  1.83e-02    14s
  33   9.58496031e+03  1.38610658e+04  3.11e-03 1.81e-04  1.57e-02    14s
  34   9.93209699e+03  1.34381908e+04  2.68e-03 1.18e-04  1.29e-02    14s
  35   1.01876774e+04  1.32194796e+04  2.34e-03 1.03e-04  1.11e-02    14s
  36   1.02515221e+04  1.29848758e+04  2.26e-03 7.60e-05  1.01e-02    14s
  37   1.06529437e+04  1.28761694e+04  1.77e-03 6.63e-05  8.17e-03    15s
  38   1.08755266e+04  1.26717131e+04  1.48e-03 4.72e-05  6.60e-03    15s
  39   1.10783996e+04  1.26312139e+04  1.22e-03 4.42e-05  5.71e-03    15s
  40   1.13039084e+04  1.25149964e+04  9.33e-04 3.44e-05  4.45e-03    15s
  41   1.13476443e+04  1.23367267e+04  8.71e-04 2.12e-05  3.64e-03    15s
  42   1.15043064e+04  1.22773198e+04  6.76e-04 1.67e-05  2.84e-03    16s
  43   1.15566517e+04  1.22499988e+04  6.11e-04 1.46e-05  2.55e-03    16s
  44   1.16487773e+04  1.21884810e+04  5.01e-04 9.32e-06  1.98e-03    16s
  45   1.17360018e+04  1.21579193e+04  3.94e-04 7.27e-06  1.55e-03    16s
  46   1.18225051e+04  1.21362634e+04  2.89e-04 5.25e-06  1.15e-03    17s
  47   1.18445616e+04  1.21244208e+04  2.62e-04 4.25e-06  1.03e-03    17s
  48   1.18564999e+04  1.21212185e+04  2.47e-04 3.96e-06  9.74e-04    17s
  49   1.19517825e+04  1.20909641e+04  1.35e-04 1.32e-06  5.12e-04    17s
  50   1.19951836e+04  1.20835025e+04  8.57e-05 8.01e-07  3.25e-04    17s
  51   1.20134299e+04  1.20799619e+04  6.46e-05 1.35e-06  2.45e-04    18s
  52   1.20458268e+04  1.20750171e+04  2.77e-05 4.98e-07  1.07e-04    18s
  53   1.20552298e+04  1.20744772e+04  1.73e-05 3.66e-07  7.08e-05    18s
  54   1.20584830e+04  1.20735441e+04  1.38e-05 1.92e-07  5.54e-05    18s
  55   1.20652905e+04  1.20727071e+04  6.73e-06 1.82e-06  2.73e-05    18s
  56   1.20683777e+04  1.20722361e+04  3.51e-06 3.87e-07  1.42e-05    18s
  57   1.20715304e+04  1.20719794e+04  3.45e-07 4.41e-08  1.65e-06    19s
  58   1.20719198e+04  1.20719284e+04  7.98e-09 1.04e-09  3.15e-08    19s
  59   1.20719280e+04  1.20719281e+04  2.11e-08 4.81e-11  4.90e-10    19s
  60   1.20719281e+04  1.20719281e+04  2.25e-08 2.90e-10  1.84e-11    19s

Barrier solved model in 60 iterations and 19.19 seconds (18.58 work units)
Optimal objective 1.20719281e+04


Root crossover log...

  128569 DPushes remaining with DInf 0.0000000e+00                19s
   55731 DPushes remaining with DInf 0.0000000e+00                20s
     793 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    2535 PPushes remaining with PInf 4.9694811e-06                26s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5224065e-03     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59616    1.2071928e+04   0.000000e+00   1.522406e-03     26s
   59617    1.2071928e+04   0.000000e+00   0.000000e+00     26s
   59617    1.2071928e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 1.27s

Solved with barrier

Root relaxation: objective 1.207193e+04, 59617 iterations, 20.96 seconds (25.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12071.9281    0  268 -201902.96 12071.9281   106%     -   28s
H    0     0                    -77378.78463 12071.9281   116%     -   29s
H    0     0                    -77196.65055 12071.9281   116%     -   29s
H    0     0                    -63638.18971 12071.9281   119%     -   29s
H    0     0                    -63483.71423 12071.9281   119%     -   30s
H    0     0                    -26626.06379 12071.9281   145%     -   30s
H    0     0                    -21083.08801 12071.9281   157%     -   30s
H    0     0                    -20955.01130 12071.9281   158%     -   31s
H    0     0                    -20456.69335 12071.9281   159%     -   31s
     0     0 4994.92864    0  261 -20456.693 4994.92864   124%     -  112s
H    0     0                    -17886.91346 4993.86128   128%     -  114s
H    0     0                    -17496.48201 4993.86128   129%     -  114s
     0     0 4790.93817    0  264 -17496.482 4790.93817   127%     -  144s
     0     0 4752.90641    0  333 -17496.482 4752.90641   127%     -  158s
     0     0 4554.74820    0  271 -17496.482 4554.74820   126%     -  174s
     0     0 4548.79637    0  280 -17496.482 4548.79637   126%     -  178s
     0     0 4544.78965    0  274 -17496.482 4544.78965   126%     -  180s
     0     0 4512.65830    0  269 -17496.482 4512.65830   126%     -  184s
     0     0 4452.30230    0  276 -17496.482 4452.30230   125%     -  196s
     0     0 4430.13288    0  398 -17496.482 4430.13288   125%     -  209s
     0     0 4430.03429    0  398 -17496.482 4430.03429   125%     -  210s
     0     0 1718.49659    0  424 -17496.482 1718.49659   110%     -  296s
     0     0 1167.88268    0  430 -17496.482 1167.88268   107%     -  334s
     0     0 1092.46709    0  433 -17496.482 1092.46709   106%     -  350s
     0     0 1059.28193    0  432 -17496.482 1059.28193   106%     -  360s
     0     0  978.15527    0  405 -17496.482  978.15527   106%     -  375s
     0     0  926.17169    0  404 -17496.482  926.17169   105%     -  391s
     0     0  912.96380    0  409 -17496.482  912.96380   105%     -  399s
     0     0  868.63965    0  469 -17496.482  868.63965   105%     -  413s
     0     0  857.08479    0  472 -17496.482  857.08479   105%     -  419s
     0     0  852.17531    0  478 -17496.482  852.17531   105%     -  424s
     0     0  794.78530    0  473 -17496.482  794.78530   105%     -  440s
     0     0  791.61874    0  494 -17496.482  791.61874   105%     -  445s
     0     0  695.94094    0  468 -17496.482  695.94094   104%     -  460s
     0     0  637.28785    0  427 -17496.482  637.28785   104%     -  478s
     0     0  627.47430    0  446 -17496.482  627.47430   104%     -  486s
     0     0  625.19853    0  443 -17496.482  625.19853   104%     -  489s
     0     0  625.17789    0  443 -17496.482  625.17789   104%     -  491s
     0     0 -1950.4897    0  485 -17496.482 -1950.4897  88.9%     -  592s
H    0     0                    -17404.73799 -1950.7319  88.8%     -  593s
H    0     0                    -17302.71670 -1950.7319  88.7%     -  594s
H    0     0                    -17171.77126 -1950.7319  88.6%     -  594s
H    0     0                    -17168.52147 -1950.7319  88.6%     -  594s
     0     0 -2392.0072    0  496 -17168.521 -2392.0072  86.1%     -  634s
     0     0 -2612.8385    0  504 -17168.521 -2612.8385  84.8%     -  661s
     0     0 -2718.5854    0  552 -17168.521 -2718.5854  84.2%     -  682s
     0     0 -2822.6764    0  518 -17168.521 -2822.6764  83.6%     -  698s
     0     0 -2903.0239    0  552 -17168.521 -2903.0239  83.1%     -  716s
     0     0 -2979.4289    0  504 -17168.521 -2979.4289  82.6%     -  738s
     0     0 -3019.2247    0  561 -17168.521 -3019.2247  82.4%     -  754s
     0     0 -3080.2683    0  526 -17168.521 -3080.2683  82.1%     -  767s
     0     0 -3094.0035    0  577 -17168.521 -3094.0035  82.0%     -  773s
     0     0 -3097.8963    0  574 -17168.521 -3097.8963  82.0%     -  777s
     0     0 -3101.7342    0  585 -17168.521 -3101.7342  81.9%     -  781s
     0     0 -3103.4839    0  578 -17168.521 -3103.4839  81.9%     -  783s
     0     0 -3996.9544    0  569 -17168.521 -3996.9544  76.7%     -  855s
     0     0 -4176.6705    0  564 -17168.521 -4176.6705  75.7%     -  880s
     0     0 -4207.3390    0  548 -17168.521 -4207.3390  75.5%     -  895s
     0     0 -4248.5097    0  557 -17168.521 -4248.5097  75.3%     -  908s
     0     0 -4267.4759    0  565 -17168.521 -4267.4759  75.1%     -  916s
     0     0 -4346.6237    0  544 -17168.521 -4346.6237  74.7%     -  932s
     0     0 -4360.1574    0  601 -17168.521 -4360.1574  74.6%     -  940s
     0     0 -4362.4912    0  551 -17168.521 -4362.4912  74.6%     -  944s
     0     0 -4375.4438    0  545 -17168.521 -4375.4438  74.5%     -  950s
     0     0 -4384.3376    0  546 -17168.521 -4384.3376  74.5%     -  956s
     0     0 -4390.2504    0  552 -17168.521 -4390.2504  74.4%     -  961s
     0     0 -4392.7183    0  600 -17168.521 -4392.7183  74.4%     -  966s
     0     0 -4395.6304    0  594 -17168.521 -4395.6304  74.4%     -  970s
     0     0 -4397.8651    0  600 -17168.521 -4397.8651  74.4%     -  972s
     0     0 -4401.2590    0  592 -17168.521 -4401.2590  74.4%     -  974s
     0     0 -4402.5003    0  603 -17168.521 -4402.5003  74.4%     -  976s
     0     0 -4614.3714    0  554 -17168.521 -4614.3714  73.1%     - 1008s
H    0     0                    -17074.38814 -4614.5622  73.0%     - 1009s
H    0     0                    -17066.74596 -4614.5622  73.0%     - 1009s
H    0     0                    -17046.86044 -4614.5622  72.9%     - 1010s
     0     0 -4633.2716    0  499 -17046.860 -4633.2716  72.8%     - 1018s
     0     0 -4643.6534    0  563 -17046.860 -4643.6534  72.8%     - 1025s
     0     0 -4656.0580    0  574 -17046.860 -4656.0580  72.7%     - 1031s
     0     0 -4665.1249    0  567 -17046.860 -4665.1249  72.6%     - 1038s
     0     0 -4671.8214    0  561 -17046.860 -4671.8214  72.6%     - 1041s
     0     0 -4676.4115    0  556 -17046.860 -4676.4115  72.6%     - 1045s
     0     0 -4681.8196    0  564 -17046.860 -4681.8196  72.5%     - 1049s
     0     0 -4684.3426    0  616 -17046.860 -4684.3426  72.5%     - 1053s
     0     0 -4696.6983    0  564 -17046.860 -4696.6983  72.4%     - 1056s
     0     0 -4699.9256    0  577 -17046.860 -4699.9256  72.4%     - 1060s
     0     0 -4707.1428    0  580 -17046.860 -4707.1428  72.4%     - 1062s
     0     0 -4711.9797    0  588 -17046.860 -4711.9797  72.4%     - 1065s
     0     0 -4712.5874    0  590 -17046.860 -4712.5874  72.4%     - 1068s
     0     0 -4790.8979    0  540 -17046.860 -4790.8979  71.9%     - 1083s
H    0     0                    -16478.71517 -4791.8137  70.9%     - 1099s
     0     0 -4803.0794    0  565 -16478.715 -4803.0794  70.9%     - 1103s
     0     0 -4806.7733    0  563 -16478.715 -4806.7733  70.8%     - 1106s
     0     0 -4817.9577    0  565 -16478.715 -4817.9577  70.8%     - 1109s
     0     0 -4819.8880    0  577 -16478.715 -4819.8880  70.8%     - 1110s
     0     0 -4888.6976    0  573 -16478.715 -4888.6976  70.3%     - 1126s
H    0     0                    -15402.37631 -4889.4746  68.3%     - 1127s
H    0     0                    -15269.89901 -4889.4746  68.0%     - 1127s
     0     0 -4911.8033    0  577 -15269.899 -4911.8033  67.8%     - 1132s
     0     0 -4915.9125    0  571 -15269.899 -4915.9125  67.8%     - 1136s
     0     0 -4918.6695    0  574 -15269.899 -4918.6695  67.8%     - 1139s
     0     0 -4922.2698    0  571 -15269.899 -4922.2698  67.8%     - 1143s
     0     0 -4922.6676    0  569 -15269.899 -4922.6676  67.8%     - 1145s
     0     0 -4938.2303    0  507 -15269.899 -4938.2303  67.7%     - 1155s
H    0     0                    -15176.17583 -4944.1026  67.4%     - 1180s
     0     0 -4944.1026    0  511 -15176.176 -4944.1026  67.4%     - 1183s
     0     0 -4944.1026    0  512 -15176.176 -4944.1026  67.4%     - 1185s
     0     0 -4955.2073    0  512 -15176.176 -4955.2073  67.3%     - 1193s
     0     0 -4959.7113    0  524 -15176.176 -4959.7113  67.3%     - 1198s
     0     0 -4963.7689    0  521 -15176.176 -4963.7689  67.3%     - 1202s
     0     0 -4964.7034    0  509 -15176.176 -4964.7034  67.3%     - 1203s
     0     0 -4974.2171    0  575 -15176.176 -4974.2171  67.2%     - 1210s
H    0     0                    -15151.04160 -4974.4651  67.2%     - 1243s
     0     0 -4975.9799    0  571 -15151.042 -4975.9799  67.2%     - 1247s
     0     0 -4982.3958    0  519 -15151.042 -4982.3958  67.1%     - 1257s
     0     0 -4982.5509    0  519 -15151.042 -4982.5509  67.1%     - 1265s
     0     2 -4982.5509    0  519 -15151.042 -4982.5509  67.1%     - 1415s
     1     3 -5521.6192    1  437 -15151.042 -4982.6810  67.1% 11033 1433s
     2     4 -5070.4056    1  571 -15151.042 -5070.4056  66.5%  7537 1446s
     3     6 -5991.7468    2  534 -15151.042 -5071.8194  66.5%  7822 1464s
     5    12 -6840.1121    3  451 -15151.042 -5071.8194  66.5%  8725 1489s
    11    24 -7138.9572    4  477 -15151.042 -5434.8122  64.1%  9509 1516s
    23    36 -6270.7372    4  549 -15151.042 -5689.0717  62.5% 15586 1590s
    35    68 -6555.6068    5  552 -15151.042 -5689.0717  62.5% 15615 1941s
    67   180 -6579.1106    6  540 -15151.042 -5910.6356  61.0% 23892 2022s
   179   209 -6771.1650   11  530 -15151.042 -5910.6396  61.0% 13702 2060s
H  181   209                    -15122.89581 -5910.6396  60.9% 13614 2060s
H  203   209                    -14873.42395 -5910.6396  60.3% 13207 2060s
   208   275 -6797.4203   12  528 -14873.424 -5910.6396  60.3% 13011 2112s
   282   336 -6960.6685   14  535 -14873.424 -5910.6396  60.3% 11358 2150s
H  285   336                    -14845.27816 -5910.6396  60.2% 11275 2150s
H  317   336                    -14839.87317 -5910.6396  60.2% 10950 2150s
   354   383 -7879.1348   15  464 -14839.873 -5910.6396  60.2% 10584 2187s
   420   413 -8033.1558   16  470 -14839.873 -5910.6396  60.2%  9852 2214s
H  422   413                    -14803.71755 -5910.6396  60.1%  9815 2214s
   454   473 -8135.1330   17  472 -14803.718 -6168.6264  58.3%  9917 2250s
   517   501 -9390.3362   18  461 -14803.718 -6168.6264  58.3%  9782 2278s
H  519   501                    -14732.49640 -6168.6264  58.1%  9760 2278s
H  520   501                    -14683.46102 -6168.6264  58.0%  9746 2278s
H  521   501                    -14646.77560 -6168.6264  57.9%  9744 2278s
   551   534 -9452.4127   19  395 -14646.776 -6168.6264  57.9%  9869 2308s
   602   563 -9491.8718   20  398 -14646.776 -6168.6264  57.9%  9992 2337s
   645   595 -10579.196   21  441 -14646.776 -6168.6264  57.9%  9992 2364s
   706   608 -11918.417   22  341 -14646.776 -6168.6264  57.9%  9825 2390s
   759   630 infeasible   24      -14646.776 -6168.6264  57.9%  9827 2422s
   825   652 -10725.067   21  392 -14646.776 -6168.6264  57.9%  9651 2453s
   887   681 -11561.693   22  420 -14646.776 -6168.6264  57.9%  9619 2487s
   958   713 -11605.918   23  433 -14646.776 -6168.6264  57.9%  9538 2519s
  1033   734 -11753.794   24  436 -14646.776 -6168.6264  57.9%  9573 2563s
  1094   755 -11828.830   25  436 -14646.776 -6168.6264  57.9%  9540 2613s
  1153   801 -12061.695   26  490 -14646.776 -6168.6264  57.9%  9502 2664s
  1209   825 -12396.225   29  429 -14646.776 -6168.6264  57.9%  9569 2701s
H 1211   825                    -14627.16481 -6168.6264  57.8%  9576 2701s
  1241   888 -12682.111   30  437 -14627.165 -6168.6264  57.8%  9733 2734s
  1321   967 -13047.730   32  379 -14627.165 -6168.6264  57.8%  9660 2766s
  1412  1048 -13741.482   36  373 -14627.165 -6709.5232  54.1%  9621 2803s
  1535  1111 -14147.582   40  358 -14627.165 -6709.5232  54.1%  9412 2839s
  1659  1176 infeasible   42      -14627.165 -6716.2270  54.1%  9204 2881s
  1808  1230 -8717.8508    7  325 -14627.165 -6716.2270  54.1%  9008 2922s
  1936  1256 -9869.9143    8  321 -14627.165 -6716.2270  54.1%  8933 2967s
H 1968  1256                    -14603.95660 -6716.2270  54.0%  8983 2967s
H 1980  1256                    -14583.07635 -6716.2270  53.9%  8963 2967s
  1988  1287 -14456.967    9  178 -14583.076 -6716.2270  53.9%  9017 3019s
  2083  1362 -13568.040   37   78 -14583.076 -6716.2270  53.9%  8999 3068s
H 2098  1362                    -14482.29737 -6716.2270  53.6%  8946 3068s
  2202  1397 infeasible   50      -14482.297 -6716.2270  53.6%  8960 3118s
  2295  1443 -9644.3569   14  480 -14482.297 -6716.2270  53.6%  9099 3170s
  2391  1460 -10440.980   15  373 -14482.297 -6716.2270  53.6%  9285 3214s
  2434  1495 -10631.558   16  430 -14482.297 -6716.2270  53.6%  9378 3271s
  2495  1528 -11079.875   17  472 -14482.297 -6730.2414  53.5%  9450 3329s
  2602  1579 -11159.089   18  478 -14482.297 -6730.2414  53.5%  9470 3385s
  2690  1672 -11799.365   19  355 -14482.297 -6730.2414  53.5%  9562 3443s
  2822  1752 -13676.500   22  263 -14482.297 -6730.2414  53.5%  9596 3511s
  2998  1806     cutoff   25      -14482.297 -6730.2414  53.5%  9511 3580s
  3142  1811 infeasible   25      -14482.297 -6730.2414  53.5%  9558 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 199
  MIR: 3052
  Flow cover: 3728
  RLT: 74
  Relax-and-lift: 571

Explored 3173 nodes (30965468 simplex iterations) in 3600.10 seconds (5546.44 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14482.3 -14583.1 -14604 ... -14845.3

Time limit reached
Best objective -1.448229736949e+04, best bound -6.730241449694e+03, gap 53.5278%
  WARNING: Time limit reached. Using best solution found (gap: 53.53%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -14482.30, θ = 128711.95
  Upper Bound (UB) = -14482.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128711.95
  [DEBUG]   ✓ Scenario 0: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128711.95 ≤ Q = 128711.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128711.95 ≤ Q = 128711.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 128711.95 ≤ Q = 128711.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 128711.95 ≤ Q = 128711.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 128711.95 ≤ Q = 128711.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4b752ae6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4b752ae6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.169540e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5099661.9439
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5099207.9027

Root relaxation: objective -1.517515e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151751.49    0  122 5099207.90 -151751.49   103%     -    0s
H    0     0                    -115324.0022 -151751.49  31.6%     -    0s
H    0     0                    -115656.5685 -151751.49  31.2%     -    0s
     0     0 -126413.10    0   81 -115656.57 -126413.10  9.30%     -    0s
H    0     0                    -121596.3869 -126396.86  3.95%     -    0s
H    0     0                    -121884.4621 -126396.86  3.70%     -    0s
H    0     0                    -122870.4051 -126396.86  2.87%     -    0s
H    0     0                    -123158.4803 -126396.86  2.63%     -    0s
     0     0 -124864.36    0   87 -123158.48 -124864.36  1.39%     -    0s
     0     0 -124590.75    0   51 -123158.48 -124590.75  1.16%     -    0s
     0     0 -124570.20    0   49 -123158.48 -124570.20  1.15%     -    0s
     0     0 -124509.02    0   43 -123158.48 -124509.02  1.10%     -    0s
H    0     0                    -123720.0931 -124488.84  0.62%     -    0s
H    0     0                    -123971.3361 -124488.84  0.42%     -    0s
H    0     0                    -124228.3767 -124488.84  0.21%     -    0s
     0     0 -124472.84    0   30 -124228.38 -124472.84  0.20%     -    0s
H    0     0                    -124330.0021 -124464.89  0.11%     -    0s
     0     0 -124464.89    0   29 -124330.00 -124464.89  0.11%     -    0s
     0     0 -124445.22    0   28 -124330.00 -124445.22  0.09%     -    0s
     0     0 -124436.31    0   28 -124330.00 -124436.31  0.09%     -    0s
     0     0 -124436.31    0   49 -124330.00 -124436.31  0.09%     -    0s
     0     0 -124436.31    0   49 -124330.00 -124436.31  0.09%     -    0s
     0     0 -124436.31    0   30 -124330.00 -124436.31  0.09%     -    0s
H    0     0                    -124354.7320 -124436.31  0.07%     -    0s
     0     0 -124396.42    0    8 -124354.73 -124396.42  0.03%     -    0s
     0     0          -    0      -124354.73 -124366.45  0.01%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 22
  MIR: 46
  Flow cover: 2
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (760 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -124355 -124330 -124228 ... -115324

Optimal solution found (tolerance 1.00e-04)
Best objective -1.243547320224e+05, best bound -1.243664549238e+05, gap 0.0094%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 125003.76
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124354.73
  [DEBUG]   S×d_nominal = 249358.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249358.50 + -124354.73 = 125003.76
  [DEBUG]   Current θ from Master = 128711.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3708.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18190.48
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2343.4962, Absolute Gap = 2343.4962, Relative Gap = 0.161818
  Not converged yet (gap = 2343.50 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x368b11e8
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns (presolve time = 5s)...
Presolve removed 134330 rows and 54530 columns
Presolve time: 6.40s
Presolved: 157563 rows, 66290 columns, 970090 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.64s

Barrier statistics:
 Dense cols : 625
 AA' NZ     : 8.930e+06
 Factor NZ  : 1.998e+07 (roughly 250 MB of memory)
 Factor Ops : 5.193e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86488621e+07  2.86965420e+08  1.14e+05 1.50e+01  8.59e+04    10s
   1  -1.45325168e+07  2.51621470e+08  8.01e+04 7.34e+01  5.96e+04    10s
   2  -6.79061396e+06  1.93941070e+08  3.58e+04 9.89e-01  2.80e+04    10s
   3  -1.08352369e+06  1.46185552e+08  2.76e+03 1.73e+00  2.57e+03    10s
   4  -6.27604075e+05  7.55143353e+07  5.62e+02 5.77e-01  6.48e+02    10s
   5  -5.48164641e+05  4.41693224e+07  3.28e+02 2.69e-01  3.59e+02    10s
   6  -4.39296603e+05  3.25444219e+07  9.72e+01 1.72e-01  1.71e+02    11s
   7  -3.93107005e+05  2.30919457e+07  6.14e+01 1.14e-01  1.12e+02    11s
   8  -2.91939325e+05  1.76996526e+07  3.02e+01 8.28e-02  7.57e+01    11s
   9  -2.00715681e+05  1.07396597e+07  1.54e+01 4.65e-02  4.29e+01    11s
  10  -1.59154929e+05  6.60050328e+06  9.78e+00 2.73e-02  2.56e+01    11s
  11  -1.26945783e+05  3.84528614e+06  5.28e+00 1.55e-02  1.45e+01    11s
  12  -1.18037453e+05  2.46354054e+06  4.09e+00 9.83e-03  9.35e+00    12s
  13  -9.35458556e+04  1.71535416e+06  1.72e+00 6.84e-03  6.41e+00    12s
  14  -7.22599653e+04  3.66580194e+05  7.57e-01 1.34e-03  1.54e+00    12s
  15  -5.48011078e+04  1.87460183e+05  4.29e-01 9.41e-04  8.49e-01    12s
  16  -3.26989078e+04  1.35954155e+05  2.02e-01 1.36e-03  5.89e-01    12s
  17  -2.39454513e+04  8.66298852e+04  1.52e-01 1.39e-03  3.86e-01    12s
  18  -1.78432840e+04  6.72555061e+04  1.23e-01 1.48e-03  2.97e-01    13s
  19  -1.48521476e+04  5.52736131e+04  1.08e-01 1.49e-03  2.45e-01    13s
  20  -1.05916268e+04  4.93263189e+04  8.71e-02 2.10e-03  2.09e-01    13s
  21  -7.77208127e+03  3.82845321e+04  7.42e-02 1.81e-03  1.61e-01    13s
  22  -6.24588927e+03  3.57009993e+04  6.71e-02 1.59e-03  1.47e-01    13s
  23  -3.05077419e+03  3.07370460e+04  5.25e-02 1.76e-03  1.18e-01    13s
  24  -8.40588958e+02  2.76078551e+04  4.35e-02 1.51e-03  9.94e-02    14s
  25   1.23670124e+03  2.48919304e+04  3.52e-02 1.44e-03  8.26e-02    14s
  26   2.84062404e+03  2.19869277e+04  2.91e-02 1.51e-03  6.69e-02    14s
  27   3.98772511e+03  1.94871237e+04  2.50e-02 1.22e-03  5.42e-02    14s
  28   5.61553764e+03  1.91506974e+04  1.95e-02 1.16e-03  4.73e-02    14s
  29   6.32106298e+03  1.75263316e+04  1.71e-02 9.16e-04  3.91e-02    15s
  30   7.18278626e+03  1.71169346e+04  1.44e-02 8.52e-04  3.47e-02    15s
  31   7.73343354e+03  1.63810423e+04  1.26e-02 7.30e-04  3.02e-02    15s
  32   8.44878880e+03  1.60683554e+04  1.03e-02 6.80e-04  2.66e-02    15s
  33   8.80324261e+03  1.46929805e+04  9.17e-03 4.47e-04  2.06e-02    16s
  34   9.24726833e+03  1.45013852e+04  7.84e-03 4.13e-04  1.84e-02    16s
  35   9.71461803e+03  1.40401146e+04  6.51e-03 3.38e-04  1.51e-02    16s
  36   9.89400899e+03  1.39984002e+04  5.99e-03 3.31e-04  1.43e-02    16s
  37   1.01944011e+04  1.38837784e+04  5.13e-03 3.09e-04  1.29e-02    17s
  38   1.04092258e+04  1.34280639e+04  4.49e-03 2.31e-04  1.05e-02    17s
  39   1.06535658e+04  1.33056870e+04  3.82e-03 2.11e-04  9.26e-03    17s
  40   1.08439194e+04  1.30570284e+04  3.29e-03 1.71e-04  7.73e-03    17s
  41   1.10052904e+04  1.29114730e+04  2.84e-03 1.45e-04  6.66e-03    18s
  42   1.12539186e+04  1.27899465e+04  2.15e-03 1.25e-04  5.36e-03    18s
  43   1.12743116e+04  1.26068832e+04  2.07e-03 9.48e-05  4.65e-03    18s
  44   1.14756764e+04  1.24251120e+04  1.52e-03 6.26e-05  3.32e-03    18s
  45   1.16105050e+04  1.23367207e+04  1.16e-03 4.62e-05  2.54e-03    19s
  46   1.16717410e+04  1.22445962e+04  9.94e-04 3.04e-05  2.00e-03    19s
  47   1.17903771e+04  1.22067887e+04  6.90e-04 2.79e-05  1.45e-03    19s
  48   1.18227971e+04  1.21860801e+04  6.10e-04 2.22e-05  1.27e-03    19s
  49   1.18546127e+04  1.21813702e+04  5.29e-04 2.12e-05  1.14e-03    20s
  50   1.19323598e+04  1.21475785e+04  3.30e-04 1.65e-05  7.52e-04    20s
  51   1.20026387e+04  1.21052937e+04  1.57e-04 7.20e-06  3.59e-04    20s
  52   1.20382014e+04  1.20952086e+04  7.35e-05 4.97e-06  1.99e-04    20s
  53   1.20531197e+04  1.20809278e+04  4.08e-05 1.87e-06  9.71e-05    21s
  54   1.20625252e+04  1.20798139e+04  1.95e-05 1.63e-06  6.03e-05    21s
  55   1.20633603e+04  1.20760837e+04  1.76e-05 8.62e-07  4.44e-05    21s
  56   1.20662521e+04  1.20755378e+04  1.13e-05 7.45e-07  3.24e-05    21s
  57   1.20708154e+04  1.20738583e+04  1.95e-06 3.91e-07  1.06e-05    21s
  58   1.20714350e+04  1.20726710e+04  7.99e-07 1.46e-07  4.31e-06    22s
  59   1.20714444e+04  1.20723626e+04  7.84e-07 8.94e-08  3.20e-06    22s
  60   1.20717941e+04  1.20720174e+04  2.00e-07 1.65e-08  7.79e-07    22s
  61   1.20717953e+04  1.20720048e+04  2.63e-07 1.61e-06  7.31e-07    22s
  62   1.20718637e+04  1.20719333e+04  1.29e-07 1.05e-07  2.43e-07    23s
  63   1.20719276e+04  1.20719281e+04  6.76e-09 2.21e-08  1.77e-09    23s
  64   1.20719279e+04  1.20719281e+04  2.41e-07 6.04e-09  6.57e-10    23s
  65   1.20719281e+04  1.20719281e+04  9.47e-08 2.47e-10  4.65e-11    23s

Barrier solved model in 65 iterations and 23.47 seconds (20.03 work units)
Optimal objective 1.20719281e+04


Root crossover log...

  135543 DPushes remaining with DInf 0.0000000e+00                24s
   38696 DPushes remaining with DInf 0.0000000e+00                25s
     252 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                30s

    3293 PPushes remaining with PInf 1.5815319e-05                30s
       0 PPushes remaining with PInf 0.0000000e+00                31s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9952803e-01     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64219    1.2071928e+04   0.000000e+00   3.995280e-01     31s
   64223    1.2071928e+04   0.000000e+00   0.000000e+00     31s
   64223    1.2071928e+04   0.000000e+00   0.000000e+00     31s
Concurrent spin time: 3.50s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.207193e+04, 64223 iterations, 27.08 seconds (28.44 work units)
Total elapsed time = 35.35s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12071.9281    0  268 -201902.96 12071.9281   106%     -   36s
H    0     0                    -87883.88573 12071.9281   114%     -   37s
H    0     0                    -87083.60225 12071.9281   114%     -   37s
H    0     0                    -87021.04831 12071.9281   114%     -   37s
H    0     0                    -86856.90031 12071.9281   114%     -   37s
H    0     0                    -63638.18971 12071.9281   119%     -   37s
H    0     0                    -63483.71423 12071.9281   119%     -   38s
H    0     0                    -26626.06379 12071.9281   145%     -   38s
H    0     0                    -21083.08801 12071.9281   157%     -   38s
H    0     0                    -20955.01130 12071.9281   158%     -   39s
H    0     0                    -20456.69335 12071.9281   159%     -   39s
     0     0 5330.34186    0  305 -20456.693 5330.34186   126%     -  140s
H    0     0                    -19089.01306 5329.79647   128%     -  141s
H    0     0                    -17407.98778 5329.79647   131%     -  142s
H    0     0                    -17286.32676 5329.79647   131%     -  142s
     0     0 4949.56752    0  369 -17286.327 4949.56752   129%     -  166s
     0     0 4946.77207    0  415 -17286.327 4946.77207   129%     -  175s
     0     0 4942.14562    0  350 -17286.327 4942.14562   129%     -  184s
     0     0 4872.35763    0  365 -17286.327 4872.35763   128%     -  205s
     0     0 4801.75640    0  363 -17286.327 4801.75640   128%     -  232s
     0     0 4794.71763    0  376 -17286.327 4794.71763   128%     -  243s
     0     0 4759.59966    0  348 -17286.327 4759.59966   128%     -  254s
     0     0 4759.59823    0  348 -17286.327 4759.59823   128%     -  257s
     0     0 2504.94990    0  443 -17286.327 2504.94990   114%     -  354s
     0     0 1968.29555    0  443 -17286.327 1968.29555   111%     -  415s
     0     0 1884.59902    0  448 -17286.327 1884.59902   111%     -  439s
     0     0 1693.60000    0  453 -17286.327 1693.60000   110%     -  472s
     0     0 1648.58910    0  458 -17286.327 1648.58910   110%     -  490s
     0     0 1618.67940    0  456 -17286.327 1618.67940   109%     -  503s
     0     0 1511.00932    0  461 -17286.327 1511.00932   109%     -  520s
     0     0 1443.05030    0  453 -17286.327 1443.05030   108%     -  538s
     0     0 1338.53801    0  462 -17286.327 1338.53801   108%     -  557s
     0     0 1299.95108    0  481 -17286.327 1299.95108   108%     -  572s
     0     0 1285.26940    0  472 -17286.327 1285.26940   107%     -  581s
     0     0 1256.02216    0  477 -17286.327 1256.02216   107%     -  591s
     0     0 1200.12561    0  470 -17286.327 1200.12561   107%     -  602s
     0     0 1198.34704    0  465 -17286.327 1198.34704   107%     -  605s
     0     0 1184.45042    0  476 -17286.327 1184.45042   107%     -  612s
     0     0 1181.62642    0  478 -17286.327 1181.62642   107%     -  614s
     0     0 1180.47750    0  476 -17286.327 1180.47750   107%     -  616s
     0     0 -983.99905    0  522 -17286.327 -983.99905  94.3%     -  731s
H    0     0                    -17050.11024 -984.67878  94.2%     -  732s
     0     0 -1584.0682    0  591 -17050.110 -1584.0682  90.7%     -  831s
     0     0 -1870.3810    0  543 -17050.110 -1870.3810  89.0%     -  878s
     0     0 -2148.0937    0  585 -17050.110 -2148.0937  87.4%     -  920s
     0     0 -2257.5787    0  582 -17050.110 -2257.5787  86.8%     -  950s
     0     0 -2314.7862    0  594 -17050.110 -2314.7862  86.4%     -  968s
     0     0 -2340.6446    0  595 -17050.110 -2340.6446  86.3%     -  979s
     0     0 -2398.4832    0  573 -17050.110 -2398.4832  85.9%     -  996s
     0     0 -2434.9580    0  580 -17050.110 -2434.9580  85.7%     - 1007s
     0     0 -2486.9163    0  588 -17050.110 -2486.9163  85.4%     - 1023s
     0     0 -2517.6283    0  592 -17050.110 -2517.6283  85.2%     - 1033s
     0     0 -2525.5341    0  596 -17050.110 -2525.5341  85.2%     - 1040s
     0     0 -2541.2238    0  601 -17050.110 -2541.2238  85.1%     - 1045s
     0     0 -2550.4020    0  596 -17050.110 -2550.4020  85.0%     - 1048s
     0     0 -2555.3752    0  598 -17050.110 -2555.3752  85.0%     - 1051s
     0     0 -2556.8601    0  600 -17050.110 -2556.8601  85.0%     - 1052s
     0     0 -3395.2348    0  482 -17050.110 -3395.2348  80.1%     - 1131s
     0     0 -3637.8687    0  481 -17050.110 -3637.8687  78.7%     - 1157s
     0     0 -3702.3511    0  553 -17050.110 -3702.3511  78.3%     - 1173s
     0     0 -3783.9522    0  507 -17050.110 -3783.9522  77.8%     - 1189s
     0     0 -3812.4751    0  568 -17050.110 -3812.4751  77.6%     - 1198s
     0     0 -3829.2501    0  567 -17050.110 -3829.2501  77.5%     - 1206s
     0     0 -3836.6949    0  521 -17050.110 -3836.6949  77.5%     - 1212s
     0     0 -3859.0957    0  521 -17050.110 -3859.0957  77.4%     - 1223s
     0     0 -3905.7102    0  519 -17050.110 -3905.7102  77.1%     - 1236s
     0     0 -3967.4833    0  577 -17050.110 -3967.4833  76.7%     - 1249s
     0     0 -3980.2565    0  585 -17050.110 -3980.2565  76.7%     - 1257s
     0     0 -3993.5306    0  583 -17050.110 -3993.5306  76.6%     - 1264s
     0     0 -4007.5272    0  579 -17050.110 -4007.5272  76.5%     - 1268s
     0     0 -4010.2968    0  588 -17050.110 -4010.2968  76.5%     - 1271s
     0     0 -4011.4515    0  582 -17050.110 -4011.4515  76.5%     - 1273s
     0     0 -4283.8207    0  508 -17050.110 -4283.8207  74.9%     - 1308s
     0     0 -4318.6140    0  501 -17050.110 -4318.6140  74.7%     - 1325s
     0     0 -4360.9520    0  508 -17050.110 -4360.9520  74.4%     - 1340s
     0     0 -4369.0930    0  520 -17050.110 -4369.0930  74.4%     - 1348s
     0     0 -4405.2890    0  503 -17050.110 -4405.2890  74.2%     - 1356s
     0     0 -4434.3914    0  553 -17050.110 -4434.3914  74.0%     - 1364s
     0     0 -4454.0381    0  563 -17050.110 -4454.0381  73.9%     - 1373s
     0     0 -4466.8470    0  564 -17050.110 -4466.8470  73.8%     - 1377s
     0     0 -4472.9810    0  573 -17050.110 -4472.9810  73.8%     - 1381s
     0     0 -4479.8000    0  574 -17050.110 -4479.8000  73.7%     - 1385s
     0     0 -4488.4379    0  571 -17050.110 -4488.4379  73.7%     - 1387s
     0     0 -4495.7601    0  566 -17050.110 -4495.7601  73.6%     - 1391s
     0     0 -4500.9689    0  566 -17050.110 -4500.9689  73.6%     - 1394s
     0     0 -4502.3092    0  577 -17050.110 -4502.3092  73.6%     - 1395s
     0     0 -4612.9812    0  568 -17050.110 -4612.9812  72.9%     - 1413s
H    0     0                    -17046.86044 -4615.4248  72.9%     - 1416s
     0     0 -4686.3731    0  564 -17046.860 -4686.3731  72.5%     - 1428s
     0     0 -4700.6047    0  576 -17046.860 -4700.6047  72.4%     - 1437s
     0     0 -4713.3595    0  587 -17046.860 -4713.3595  72.4%     - 1445s
     0     0 -4716.7282    0  598 -17046.860 -4716.7282  72.3%     - 1448s
     0     0 -4721.5891    0  581 -17046.860 -4721.5891  72.3%     - 1453s
     0     0 -4730.8874    0  586 -17046.860 -4730.8874  72.2%     - 1458s
     0     0 -4735.3351    0  589 -17046.860 -4735.3351  72.2%     - 1461s
     0     0 -4737.3303    0  589 -17046.860 -4737.3303  72.2%     - 1464s
     0     0 -4806.3817    0  513 -17046.860 -4806.3817  71.8%     - 1485s
     0     0 -4827.9526    0  521 -17046.860 -4827.9526  71.7%     - 1496s
     0     0 -4837.2492    0  552 -17046.860 -4837.2492  71.6%     - 1504s
     0     0 -4840.5628    0  521 -17046.860 -4840.5628  71.6%     - 1507s
     0     0 -4844.4215    0  524 -17046.860 -4844.4215  71.6%     - 1514s
     0     0 -4848.1656    0  579 -17046.860 -4848.1656  71.6%     - 1518s
     0     0 -4849.1620    0  578 -17046.860 -4849.1620  71.6%     - 1523s
     0     0 -4868.7013    0  519 -17046.860 -4868.7013  71.4%     - 1533s
     0     0 -4880.2534    0  571 -17046.860 -4880.2534  71.4%     - 1547s
     0     0 -4885.1156    0  516 -17046.860 -4885.1156  71.3%     - 1551s
     0     0 -4885.8174    0  517 -17046.860 -4885.8174  71.3%     - 1554s
     0     0 -4896.4223    0  563 -17046.860 -4896.4223  71.3%     - 1564s
     0     0 -4899.5631    0  570 -17046.860 -4899.5631  71.3%     - 1568s
     0     0 -4911.6538    0  579 -17046.860 -4911.6538  71.2%     - 1573s
     0     0 -4912.9522    0  573 -17046.860 -4912.9522  71.2%     - 1576s
     0     0 -4930.3080    0  580 -17046.860 -4930.3080  71.1%     - 1586s
     0     0 -4931.9235    0  571 -17046.860 -4931.9235  71.1%     - 1595s
     0     0 -4938.0533    0  570 -17046.860 -4938.0533  71.0%     - 1602s
     0     0 -4939.1005    0  579 -17046.860 -4939.1005  71.0%     - 1607s
     0     0 -4956.4974    0  529 -17046.860 -4956.4974  70.9%     - 1617s
     0     0 -4959.5722    0  533 -17046.860 -4959.5722  70.9%     - 1624s
     0     0 -4961.5538    0  532 -17046.860 -4961.5538  70.9%     - 1627s
     0     0 -4968.3993    0  526 -17046.860 -4968.3993  70.9%     - 1634s
     0     0 -4968.4743    0  526 -17046.860 -4968.4743  70.9%     - 1645s
H    0     0                    -17042.42985 -4968.4743  70.8%     - 1830s
H    0     0                    -17010.37140 -4968.4743  70.8%     - 1830s
     0     2 -4968.4743    0  526 -17010.371 -4968.4743  70.8%     - 1836s
     1     3 -5573.5187    1  459 -17010.371 -4968.4777  70.8% 11843 1857s
     2     5 -5927.4169    2  484 -17010.371 -4968.4777  70.8% 10642 1876s
     4    10 -5355.9285    2  520 -17010.371 -5015.2193  70.5%  9668 1906s
     9    17 -5622.5533    3  524 -17010.371 -5088.6405  70.1% 10562 1978s
    16    34 -5788.1319    4  586 -17010.371 -5088.6405  70.1% 14616 2020s
    33    47 -6248.8796    4  596 -17010.371 -5449.3407  68.0% 23892 2113s
    48    75 -6876.7186    5  482 -17010.371 -5449.3407  68.0% 25285 2287s
    76   106 -7006.0720    6  470 -17010.371 -5449.3407  68.0% 20298 2361s
H   81   106                    -16892.61426 -5449.3407  67.7% 19684 2361s
   109   231 -7314.4979    7  484 -16892.614 -5449.3407  67.7% 18932 2467s
H  114   231                    -16849.28498 -5449.3407  67.7% 18529 2467s
H  122   231                    -16774.69046 -5449.3407  67.5% 17819 2467s
H  209   231                    -16757.43286 -5449.3407  67.5% 12777 2467s
H  212   231                    -16254.18683 -5449.3407  66.5% 12725 2467s
   236   302 -7357.7951    8  467 -16254.187 -5449.3407  66.5% 12106 2523s
   307   385 -7505.2603   11  461 -16254.187 -5449.3407  66.5% 11058 2577s
H  320   385                    -16225.35336 -5449.3407  66.4% 10852 2577s
H  331   385                    -16169.98629 -5449.3407  66.3% 10735 2577s
   390   454 -7727.7318   13  467 -16169.986 -5449.3407  66.3%  9945 2622s
   461   508 -7847.3458   14  529 -16169.986 -5449.3407  66.3%  9528 2661s
   515   570 -7940.3799   15  460 -16169.986 -5449.3407  66.3%  9250 2698s
   577   598 -8036.4095   16  456 -16169.986 -5449.3407  66.3%  8947 2737s
   607   632 -8331.6573   17  459 -16169.986 -5449.3407  66.3%  9054 2774s
   641   661 -8091.1772   17  443 -16169.986 -5449.3407  66.3%  9144 2814s
H  663   661                    -16089.45863 -5449.3407  66.1%  9225 2814s
   670   713 -8387.5546   18  441 -16089.459 -5449.3407  66.1%  9273 2845s
   747   741 -8509.5818   20  501 -16089.459 -5449.3407  66.1%  9304 2882s
   779   766 -8634.2719   21  473 -16089.459 -5449.3407  66.1%  9407 2910s
   814   790 -8906.7663   22  483 -16089.459 -5449.3407  66.1%  9472 2941s
   852   806 infeasible   19      -16089.459 -5449.3407  66.1%  9550 2971s
   888   828 -9202.3675   23  487 -16089.459 -5449.3407  66.1%  9585 3003s
   922   854 infeasible   19      -16089.459 -5449.3407  66.1%  9638 3032s
   954   873 -9363.6776   24  436 -16089.459 -5449.3407  66.1%  9673 3069s
H  967   873                    -16026.90190 -5449.3407  66.0%  9656 3069s
   987   905 -12950.605   25  330 -16026.902 -5449.3407  66.0%  9713 3106s
  1073   945 -11005.603   25  437 -16026.902 -5449.3407  66.0%  9579 3150s
  1145  1001 -11664.751   26  362 -16026.902 -5449.3407  66.0%  9444 3195s
  1255  1034 -12892.967   28  296 -16026.902 -5449.3407  66.0%  9189 3241s
  1367  1081 -15982.778   31  338 -16026.902 -5449.3407  66.0%  9032 3288s
  1456  1157 infeasible   32      -16026.902 -5449.3407  66.0%  9122 3335s
  1554  1223 -15902.682   33  247 -16026.902 -5449.3407  66.0%  9208 3388s
  1667  1304 -9840.2200   15  395 -16026.902 -5449.3407  66.0%  9228 3438s
  1788  1388 -11118.498   17  514 -16026.902 -5449.3407  66.0%  9204 3494s
  1912  1532 infeasible   18      -16026.902 -5449.3407  66.0%  9114 3546s
  2078  1569 -10658.690   19  374 -16026.902 -5449.3407  66.0%  8962 3593s
  2131  1568 -13648.495   40  360 -16026.902 -5449.3407  66.0%  9017 3600s

Cutting planes:
  Learned: 2
  Gomory: 1
  Implied bound: 257
  MIR: 3752
  Flow cover: 4241
  RLT: 76
  Relax-and-lift: 611

Explored 2154 nodes (20094337 simplex iterations) in 3600.09 seconds (5332.97 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -16026.9 -16089.5 -16170 ... -17010.4

Time limit reached
Best objective -1.602690190379e+04, best bound -5.449340707609e+03, gap 65.9988%
  WARNING: Time limit reached. Using best solution found (gap: 66.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -16026.90, θ = 130267.10
  Upper Bound (UB) = -16026.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 130267.10
  [DEBUG]   ✓ Scenario 0: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 130267.10 ≤ Q = 130267.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 130267.10 ≤ Q = 130267.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 130267.10 ≤ Q = 130267.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 130267.10 ≤ Q = 130267.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 130267.10 ≤ Q = 130267.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 130267.10 ≤ Q = 130267.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1e53de9d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1e53de9d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.219829e+13
Presolve removed 2611 rows and 1901 columns
Presolve time: 0.01s
Presolved: 482 rows, 488 columns, 1361 nonzeros
Found heuristic solution: objective 5116733.9740
Variable types: 330 continuous, 158 integer (158 binary)
Found heuristic solution: objective 5115796.6353

Root relaxation: objective -1.558299e+05, 233 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155829.88    0  121 5115796.64 -155829.88   103%     -    0s
H    0     0                    -119764.2558 -155829.88  30.1%     -    0s
H    0     0                    -129516.9417 -155829.88  20.3%     -    0s
H    0     0                    -130025.9421 -155829.88  19.8%     -    0s
     0     0 -135518.28    0   96 -130025.94 -135518.28  4.22%     -    0s
H    0     0                    -132266.1444 -135506.87  2.45%     -    0s
     0     0 -134624.29    0  104 -132266.14 -134624.29  1.78%     -    0s
H    0     0                    -132469.6304 -134618.72  1.62%     -    0s
     0     0 -134316.76    0  100 -132469.63 -134316.76  1.39%     -    0s
H    0     0                    -132514.0552 -134256.75  1.32%     -    0s
     0     0 -134256.75    0  100 -132514.06 -134256.75  1.32%     -    0s
     0     0 -133892.72    0   68 -132514.06 -133892.72  1.04%     -    0s
H    0     0                    -132551.1235 -133859.64  0.99%     -    0s
H    0     0                    -132556.6581 -133859.64  0.98%     -    0s
     0     0 -133859.64    0   91 -132556.66 -133859.64  0.98%     -    0s
     0     0 -133859.64    0   91 -132556.66 -133859.64  0.98%     -    0s
     0     0 -133628.52    0   56 -132556.66 -133628.52  0.81%     -    0s
     0     0 -133582.85    0   62 -132556.66 -133582.85  0.77%     -    0s
     0     0 -133578.54    0   68 -132556.66 -133578.54  0.77%     -    0s
     0     0 -133488.90    0   61 -132556.66 -133488.90  0.70%     -    0s
     0     0 -133456.67    0   61 -132556.66 -133456.67  0.68%     -    0s
     0     2 -133456.67    0   61 -132556.66 -133456.67  0.68%     -    0s
H  349   223                    -132570.5733 -133063.95  0.37%   4.5    0s
H  369   223                    -132591.1904 -133063.95  0.36%   4.6    0s
H 1679   614                    -132600.9555 -132905.17  0.23%   4.5    0s

Cutting planes:
  Gomory: 31
  Implied bound: 3
  MIR: 167
  Flow cover: 6
  RLT: 45
  BQP: 1

Explored 6956 nodes (29849 simplex iterations) in 0.40 seconds (0.22 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -132601 -132591 -132571 ... -129517
No other solutions better than -132601

Optimal solution found (tolerance 1.00e-04)
Best objective -1.326009555130e+05, best bound -1.326009555130e+05, gap 0.0000%
  Subproblem solved in 0.44s
  Worst-case operational profit (Z_SP) = 121561.05
  Scenario: 49 demand increases, 11 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132600.96
  [DEBUG]   S×d_nominal = 254162.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254162.01 + -132600.96 = 121561.05
  [DEBUG]   Current θ from Master = 130267.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8706.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24732.95
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 798.8917, Absolute Gap = 798.8917, Relative Gap = 0.049847
  Not converged yet (gap = 798.89 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 49 increases, 11 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0x9637f582
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141400 rows and 57400 columns (presolve time = 5s)...
Presolve removed 141400 rows and 57400 columns
Presolve time: 5.80s
Presolved: 165783 rows, 69660 columns, 1020509 nonzeros
Variable types: 67401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.04s

Barrier statistics:
 Dense cols : 1154
 AA' NZ     : 3.996e+06
 Factor NZ  : 1.118e+07 (roughly 200 MB of memory)
 Factor Ops : 3.749e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89857118e+07  3.00839370e+08  1.16e+05 1.43e+01  8.70e+04    10s
   1  -1.48384067e+07  2.64306926e+08  8.17e+04 7.19e+01  6.05e+04    11s
   2  -6.91092912e+06  2.04068056e+08  3.64e+04 1.09e+00  2.83e+04    11s
   3  -1.09873545e+06  1.54318554e+08  2.80e+03 3.03e+00  2.60e+03    11s
   4  -6.36496818e+05  8.06271448e+07  5.75e+02 1.05e+00  6.60e+02    11s
   5  -5.58907218e+05  4.68777912e+07  3.33e+02 4.88e-01  3.63e+02    11s
   6  -4.47978016e+05  3.53092453e+07  9.96e+01 3.38e-01  1.76e+02    11s
   7  -4.08743000e+05  2.58075335e+07  6.66e+01 2.32e-01  1.21e+02    11s
   8  -2.79041208e+05  1.80402972e+07  5.70e+00 1.50e-01  6.30e+01    11s
   9  -1.93411998e+05  1.01908327e+07  2.47e+00 8.21e-02  3.50e+01    12s
  10  -1.51876168e+05  7.10942457e+06  1.55e+00 5.87e-02  2.43e+01    12s
  11  -1.31675781e+05  5.75727320e+06  9.64e-01 4.72e-02  1.96e+01    12s
  12  -1.20517179e+05  3.79535064e+06  7.03e-01 3.12e-02  1.30e+01    12s
  13  -1.07038282e+05  3.07420841e+06  4.39e-01 2.54e-02  1.06e+01    12s
  14  -8.68311042e+04  2.15655402e+06  1.74e-01 1.73e-02  7.43e+00    12s
  15  -6.79855420e+04  4.00105859e+05  6.91e-02 3.08e-03  1.55e+00    12s
  16  -4.93364677e+04  2.01872701e+05  4.10e-02 1.95e-03  8.32e-01    13s
  17  -2.88789196e+04  1.29869982e+05  1.98e-02 2.48e-03  5.26e-01    13s
  18  -2.41975318e+04  1.06437100e+05  1.71e-02 2.00e-03  4.32e-01    13s
  19  -1.80529119e+04  7.51041115e+04  1.35e-02 1.34e-03  3.08e-01    13s
  20  -1.17861333e+04  5.99329693e+04  9.97e-03 1.04e-03  2.37e-01    13s
  21  -9.79253554e+03  5.23414286e+04  8.87e-03 8.81e-04  2.06e-01    13s
  22  -7.11889600e+03  4.06579990e+04  7.54e-03 6.34e-04  1.58e-01    14s
  23  -4.88753969e+03  3.44607003e+04  6.50e-03 5.11e-04  1.30e-01    14s
  24  -2.07206794e+03  3.08466902e+04  5.21e-03 4.31e-04  1.09e-01    14s
  25  -5.49508575e+02  2.79312763e+04  4.53e-03 3.73e-04  9.43e-02    14s
  26   1.42812494e+03  2.57265191e+04  3.69e-03 3.24e-04  8.04e-02    14s
  27   2.43933568e+03  2.38976779e+04  3.28e-03 2.79e-04  7.10e-02    15s
  28   4.00810121e+03  2.08313759e+04  2.68e-03 2.45e-04  5.57e-02    15s
  29   5.26786409e+03  1.89483634e+04  2.22e-03 1.93e-04  4.53e-02    15s
  30   6.05220487e+03  1.80171444e+04  1.94e-03 1.68e-04  3.96e-02    15s
  31   7.07393485e+03  1.69776824e+04  1.59e-03 1.39e-04  3.28e-02    16s
  32   7.32635083e+03  1.63287363e+04  1.50e-03 1.22e-04  2.98e-02    16s
  33   8.13897808e+03  1.51676874e+04  1.23e-03 8.77e-05  2.33e-02    16s
  34   8.66118780e+03  1.47152196e+04  1.06e-03 8.17e-05  2.00e-02    16s
  35   9.33699654e+03  1.41729826e+04  8.43e-04 7.09e-05  1.60e-02    16s
  36   9.87791334e+03  1.39198641e+04  6.73e-04 6.92e-05  1.34e-02    17s
  37   1.03507009e+04  1.36411819e+04  5.17e-04 5.64e-05  1.09e-02    17s
  38   1.05039180e+04  1.35001203e+04  4.70e-04 5.45e-05  9.92e-03    17s
  39   1.06781874e+04  1.34277436e+04  4.16e-04 5.15e-05  9.10e-03    17s
  40   1.07769651e+04  1.30197540e+04  3.83e-04 4.60e-05  7.42e-03    18s
  41   1.10014828e+04  1.29004565e+04  3.16e-04 4.06e-05  6.29e-03    18s
  42   1.12550300e+04  1.26887995e+04  2.35e-04 3.20e-05  4.75e-03    18s
  43   1.14683884e+04  1.25477275e+04  1.69e-04 2.47e-05  3.57e-03    18s
  44   1.15655896e+04  1.24262074e+04  1.40e-04 1.99e-05  2.85e-03    18s
  45   1.17262950e+04  1.23231051e+04  9.26e-05 1.52e-05  1.98e-03    19s
  46   1.18388858e+04  1.22040031e+04  6.03e-05 7.73e-06  1.21e-03    19s
  47   1.18461331e+04  1.21836230e+04  5.82e-05 6.36e-06  1.12e-03    19s
  48   1.19119465e+04  1.21737985e+04  4.04e-05 5.88e-06  8.67e-04    19s
  49   1.19505349e+04  1.21228740e+04  3.01e-05 2.95e-06  5.71e-04    19s
  50   1.19947549e+04  1.21045423e+04  1.87e-05 1.83e-06  3.63e-04    20s
  51   1.20297650e+04  1.20873313e+04  9.56e-06 8.14e-07  1.91e-04    20s
  52   1.20537853e+04  1.20749318e+04  3.80e-06 1.68e-07  7.00e-05    20s
  53   1.20623204e+04  1.20738289e+04  1.97e-06 1.03e-07  3.81e-05    20s
  54   1.20671886e+04  1.20728696e+04  9.45e-07 6.36e-08  1.88e-05    20s
  55   1.20695018e+04  1.20722965e+04  4.71e-07 4.38e-08  9.25e-06    21s
  56   1.20712612e+04  1.20719796e+04  1.22e-07 4.04e-09  2.38e-06    21s
  57   1.20719251e+04  1.20719289e+04  3.06e-09 1.23e-10  1.25e-08    21s
  58   1.20719278e+04  1.20719281e+04  1.69e-07 3.10e-10  8.43e-10    21s
  59   1.20719280e+04  1.20719281e+04  3.09e-07 8.31e-10  2.99e-10    21s

Barrier solved model in 59 iterations and 21.34 seconds (18.26 work units)
Optimal objective 1.20719280e+04


Root crossover log...

  142512 DPushes remaining with DInf 0.0000000e+00                21s
   40139 DPushes remaining with DInf 0.0000000e+00                25s
    4409 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                32s

   10074 PPushes remaining with PInf 5.8909560e-05                32s
       0 PPushes remaining with PInf 0.0000000e+00                34s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3335649e+02     34s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77219    1.2071928e+04   0.000000e+00   1.333565e+02     34s
   77364    1.2071928e+04   0.000000e+00   0.000000e+00     34s
   77364    1.2071928e+04   0.000000e+00   0.000000e+00     35s
Concurrent spin time: 5.58s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.207193e+04, 77364 iterations, 33.00 seconds (37.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12071.9281    0  268 -201902.96 12071.9281   106%     -   41s
H    0     0                    -190733.8320 12071.9281   106%     -   43s
H    0     0                    -190658.0159 12071.9281   106%     -   43s
H    0     0                    -63638.18971 12071.9281   119%     -   43s
H    0     0                    -63483.71423 12071.9281   119%     -   44s
H    0     0                    -26626.06379 12071.9281   145%     -   44s
H    0     0                    -21286.72792 12071.9281   157%     -   44s
H    0     0                    -20955.01130 12071.9281   158%     -   45s
H    0     0                    -20456.69335 12071.9281   159%     -   46s
     0     0 5379.62100    0  364 -20456.693 5379.62100   126%     -  184s
H    0     0                    -17728.65080 5379.45344   130%     -  186s
H    0     0                    -17286.32676 5379.45344   131%     -  186s
     0     0 5085.18068    0  362 -17286.327 5085.18068   129%     -  221s
     0     0 4881.75278    0  366 -17286.327 4881.75278   128%     -  239s
     0     0 4847.29249    0  368 -17286.327 4847.29249   128%     -  252s
     0     0 4835.13834    0  378 -17286.327 4835.13834   128%     -  258s
     0     0 4758.10243    0  344 -17286.327 4758.10243   128%     -  271s
     0     0 4757.43272    0  342 -17286.327 4757.43272   128%     -  272s
     0     0 2151.08039    0  451 -17286.327 2151.08039   112%     -  375s
     0     0 1785.25235    0  444 -17286.327 1785.25235   110%     -  417s
     0     0 1666.38498    0  461 -17286.327 1666.38498   110%     -  445s
     0     0 1617.13341    0  457 -17286.327 1617.13341   109%     -  468s
     0     0 1463.08107    0  461 -17286.327 1463.08107   108%     -  496s
     0     0 1440.54869    0  462 -17286.327 1440.54869   108%     -  512s
     0     0 1422.21635    0  466 -17286.327 1422.21635   108%     -  521s
     0     0 1406.83650    0  462 -17286.327 1406.83650   108%     -  530s
     0     0 1360.61753    0  471 -17286.327 1360.61753   108%     -  544s
     0     0 1354.26070    0  470 -17286.327 1354.26070   108%     -  549s
     0     0 1352.75219    0  477 -17286.327 1352.75219   108%     -  551s
     0     0 1351.95319    0  477 -17286.327 1351.95319   108%     -  553s
     0     0 -1570.8849    0  448 -17286.327 -1570.8849  90.9%     -  694s
H    0     0                    -17283.07696 -1570.9958  90.9%     -  696s
     0     0 -1989.9671    0  539 -17283.077 -1989.9671  88.5%     -  750s
     0     0 -2235.3085    0  496 -17283.077 -2235.3085  87.1%     -  786s
     0     0 -2430.0934    0  453 -17283.077 -2430.0934  85.9%     -  812s
     0     0 -2544.3981    0  497 -17283.077 -2544.3981  85.3%     -  835s
     0     0 -2642.6553    0  516 -17283.077 -2642.6553  84.7%     -  859s
     0     0 -2659.9364    0  475 -17283.077 -2659.9364  84.6%     -  872s
     0     0 -2732.1296    0  558 -17283.077 -2732.1296  84.2%     -  895s
     0     0 -2822.3277    0  567 -17283.077 -2822.3277  83.7%     -  914s
     0     0 -2839.3893    0  576 -17283.077 -2839.3893  83.6%     -  922s
     0     0 -2843.8765    0  576 -17283.077 -2843.8765  83.5%     -  927s
     0     0 -2869.5088    0  583 -17283.077 -2869.5088  83.4%     -  938s
     0     0 -2873.1327    0  583 -17283.077 -2873.1327  83.4%     -  943s
     0     0 -2932.2717    0  570 -17283.077 -2932.2717  83.0%     -  958s
     0     0 -2944.7368    0  563 -17283.077 -2944.7368  83.0%     -  967s
     0     0 -2958.7544    0  560 -17283.077 -2958.7544  82.9%     -  973s
     0     0 -2960.6115    0  564 -17283.077 -2960.6115  82.9%     -  977s
     0     0 -2965.6251    0  574 -17283.077 -2965.6251  82.8%     -  982s
     0     0 -2971.2732    0  524 -17283.077 -2971.2732  82.8%     -  991s
     0     0 -2972.0519    0  516 -17283.077 -2972.0519  82.8%     -  993s
     0     0 -3769.9940    0  556 -17283.077 -3769.9940  78.2%     - 1062s
     0     0 -3936.4462    0  571 -17283.077 -3936.4462  77.2%     - 1081s
     0     0 -4010.8510    0  555 -17283.077 -4010.8510  76.8%     - 1098s
     0     0 -4029.3559    0  553 -17283.077 -4029.3559  76.7%     - 1106s
     0     0 -4049.8588    0  560 -17283.077 -4049.8588  76.6%     - 1115s
     0     0 -4067.2736    0  554 -17283.077 -4067.2736  76.5%     - 1121s
     0     0 -4079.8855    0  555 -17283.077 -4079.8855  76.4%     - 1130s
     0     0 -4084.3053    0  557 -17283.077 -4084.3053  76.4%     - 1134s
     0     0 -4099.8738    0  556 -17283.077 -4099.8738  76.3%     - 1143s
     0     0 -4101.9407    0  563 -17283.077 -4101.9407  76.3%     - 1146s
     0     0 -4378.3578    0  518 -17283.077 -4378.3578  74.7%     - 1184s
     0     0 -4438.7074    0  533 -17283.077 -4438.7074  74.3%     - 1197s
     0     0 -4462.9364    0  550 -17283.077 -4462.9364  74.2%     - 1208s
     0     0 -4474.9260    0  561 -17283.077 -4474.9260  74.1%     - 1219s
     0     0 -4481.9423    0  555 -17283.077 -4481.9423  74.1%     - 1224s
     0     0 -4484.6092    0  556 -17283.077 -4484.6092  74.1%     - 1229s
     0     0 -4511.2312    0  556 -17283.077 -4511.2312  73.9%     - 1236s
     0     0 -4527.8487    0  565 -17283.077 -4527.8487  73.8%     - 1239s
     0     0 -4536.9685    0  563 -17283.077 -4536.9685  73.7%     - 1241s
     0     0 -4542.2250    0  561 -17283.077 -4542.2250  73.7%     - 1244s
     0     0 -4546.5014    0  566 -17283.077 -4546.5014  73.7%     - 1249s
     0     0 -4549.5417    0  574 -17283.077 -4549.5417  73.7%     - 1252s
     0     0 -4552.1077    0  565 -17283.077 -4552.1077  73.7%     - 1255s
     0     0 -4554.4867    0  570 -17283.077 -4554.4867  73.6%     - 1257s
     0     0 -4554.9944    0  567 -17283.077 -4554.9944  73.6%     - 1258s
     0     0 -4660.5816    0  550 -17283.077 -4660.5816  73.0%     - 1279s
H    0     0                    -16981.12006 -4662.1818  72.5%     - 1298s
     0     0 -4671.8763    0  562 -16981.120 -4671.8763  72.5%     - 1303s
     0     0 -4689.0657    0  575 -16981.120 -4689.0657  72.4%     - 1312s
     0     0 -4712.1614    0  570 -16981.120 -4712.1614  72.3%     - 1320s
     0     0 -4718.3399    0  579 -16981.120 -4718.3399  72.2%     - 1324s
     0     0 -4721.1125    0  577 -16981.120 -4721.1125  72.2%     - 1326s
     0     0 -4722.0751    0  578 -16981.120 -4722.0751  72.2%     - 1327s
     0     0 -4773.0758    0  584 -16981.120 -4773.0758  71.9%     - 1344s
H    0     0                    -16894.29984 -4773.5310  71.7%     - 1345s
     0     0 -4789.0674    0  589 -16894.300 -4789.0674  71.7%     - 1356s
     0     0 -4806.9602    0  581 -16894.300 -4806.9602  71.5%     - 1366s
     0     0 -4818.8318    0  595 -16894.300 -4818.8318  71.5%     - 1373s
     0     0 -4823.0478    0  595 -16894.300 -4823.0478  71.5%     - 1376s
     0     0 -4824.3139    0  587 -16894.300 -4824.3139  71.4%     - 1379s
     0     0 -4846.6127    0  514 -16894.300 -4846.6127  71.3%     - 1391s
H    0     0                    -16806.84110 -4847.0682  71.2%     - 1415s
H    0     0                    -16664.13465 -4847.0682  70.9%     - 1415s
     0     0 -4851.3358    0  518 -16664.135 -4851.3358  70.9%     - 1420s
     0     0 -4852.8685    0  519 -16664.135 -4852.8685  70.9%     - 1424s
     0     0 -4855.0051    0  510 -16664.135 -4855.0051  70.9%     - 1432s
H    0     0                    -16644.24913 -4855.7537  70.8%     - 1433s
     0     0 -4856.6922    0  550 -16644.249 -4856.6922  70.8%     - 1437s
     0     0 -4861.9489    0  555 -16644.249 -4861.9489  70.8%     - 1443s
H    0     0                    -16536.98222 -4862.3167  70.6%     - 1464s
     0     0 -4863.0635    0  574 -16536.982 -4863.0635  70.6%     - 1474s
     0     0 -4867.2490    0  618 -16536.982 -4867.2490  70.6%     - 1481s
     0     0 -4868.2958    0  618 -16536.982 -4868.2958  70.6%     - 1491s
H    0     0                    -16240.74783 -4868.2958  70.0%     - 1725s
H    0     2                    -15413.46785 -4868.2958  68.4%     - 1731s
     0     2 -4868.2958    0  618 -15413.468 -4868.2958  68.4%     - 1731s
     1     4 -4898.4465    1  569 -15413.468 -4868.2958  68.4%  3816 1744s
     3     7 -4928.9168    2  564 -15413.468 -4898.6420  68.2%  9692 1785s
     6    10 -6506.7271    3  472 -15413.468 -4929.6603  68.0% 16286 1848s
     9    17 -6800.3849    4  441 -15413.468 -4929.6603  68.0% 14432 1883s
    16    34 -6552.5017    4  507 -15413.468 -4929.6603  68.0% 14723 1922s
    33    49 -6094.6682    5  507 -15413.468 -5471.9890  64.5% 22383 2107s
    48    76 -6530.8411    6  503 -15413.468 -5471.9890  64.5% 20895 2293s
    75   108 -6548.0677    7  491 -15413.468 -5471.9890  64.5% 18320 2353s
H   77   108                    -15333.95694 -5471.9890  64.3% 17936 2353s
H   87   108                    -15082.04664 -5471.9890  63.7% 16888 2353s
   107   252 -6728.6784    8  474 -15082.047 -5471.9890  63.7% 16080 2448s
   251   321 -6988.2046   13  473 -15082.047 -5471.9890  63.7% 10728 2498s
   326   373 -7414.1547   16  450 -15082.047 -5471.9890  63.7%  9290 2544s
H  345   373                    -15054.52320 -5471.9890  63.7%  9038 2544s
   384   425 -7636.1264   18  446 -15054.523 -5471.9890  63.7%  8680 2595s
H  438   465                    -14991.21343 -5471.9890  63.5%  8180 2640s
   480   505 -7819.9189   23  436 -14991.213 -5471.9890  63.5%  7931 2690s
   528   524 -10415.839   24  300 -14991.213 -5471.9890  63.5%  7711 2745s
   547   567 -10552.555   25  293 -14991.213 -5471.9890  63.5%  7651 2801s
H  553   567                    -14943.69456 -5471.9890  63.4%  7647 2801s
H  568   567                    -14623.79732 -5471.9890  62.6%  7510 2801s
   590   588 -11088.358   28  367 -14623.797 -5471.9890  62.6%  7458 2854s
   617   609 -12159.602   28  182 -14623.797 -5471.9890  62.6%  7429 2933s
   651   632 -9237.5407   17  404 -14623.797 -5471.9890  62.6%  7341 2986s
   693   666 -12810.852   25  395 -14623.797 -5471.9890  62.6%  7240 3039s
   743   701 -12859.534   26  396 -14623.797 -5471.9890  62.6%  7109 3088s
   796   720 -12830.552   29  173 -14623.797 -5471.9890  62.6%  6931 3155s
   837   742 -12996.286   27  344 -14623.797 -5471.9890  62.6%  6802 3206s
H  853   742                    -14582.74023 -5471.9890  62.5%  6778 3206s
   902   791 -13037.888   28  271 -14582.740 -5471.9890  62.5%  6639 3260s
   985   856 -13426.625   32  247 -14582.740 -5471.9890  62.5%  6404 3312s
  1074   892 -14044.919   35  234 -14582.740 -5471.9890  62.5%  6220 3366s
  1159   929 -14424.608   39  211 -14582.740 -5471.9890  62.5%  6019 3424s
  1256   979 infeasible   40      -14582.740 -5614.7322  61.5%  5844 3482s
  1378   997 -5698.9375    6  466 -14582.740 -5615.1123  61.5%  5662 3551s
  1472  1049 -5777.8864    7  451 -14582.740 -5615.1123  61.5%  5523 3600s

Cutting planes:
  Gomory: 5
  Implied bound: 343
  MIR: 3380
  Flow cover: 3856
  RLT: 71
  Relax-and-lift: 679

Explored 1595 nodes (9278600 simplex iterations) in 3600.16 seconds (4829.85 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14582.7 -14623.8 -14943.7 ... -16537

Time limit reached
Best objective -1.458274023369e+04, best bound -5.615112327147e+03, gap 61.4948%
  WARNING: Time limit reached. Using best solution found (gap: 61.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = -14582.74, θ = 129125.72
  Upper Bound (UB) = -14582.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 129125.72
  [DEBUG]   ✓ Scenario 0: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 129125.72 ≤ Q = 129125.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 129125.72 ≤ Q = 129125.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x13a3520a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xec5cadf6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.183004e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5156553.8154
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5156099.7742

Root relaxation: objective -1.514416e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151441.60    0  122 5156099.77 -151441.60   103%     -    0s
H    0     0                    -115274.6450 -151441.60  31.4%     -    0s
H    0     0                    -115345.1320 -151441.60  31.3%     -    0s
     0     0 -127178.55    0   99 -115345.13 -127178.55  10.3%     -    0s
H    0     0                    -122719.2203 -127047.52  3.53%     -    0s
     0     0 -125898.44    0  104 -122719.22 -125898.44  2.59%     -    0s
H    0     0                    -123546.7054 -125875.73  1.89%     -    0s
H    0     0                    -123800.3816 -125229.81  1.15%     -    0s
     0     0 -125229.81    0  110 -123800.38 -125229.81  1.15%     -    0s
     0     0 -125179.39    0  100 -123800.38 -125179.39  1.11%     -    0s
     0     0 -125178.80    0  108 -123800.38 -125178.80  1.11%     -    0s
     0     0 -124866.04    0   97 -123800.38 -124866.04  0.86%     -    0s
     0     0 -124786.08    0   81 -123800.38 -124786.08  0.80%     -    0s
     0     0 -124776.69    0  105 -123800.38 -124776.69  0.79%     -    0s
     0     0 -124726.15    0   51 -123800.38 -124726.15  0.75%     -    0s
H    0     0                    -123968.2144 -124725.21  0.61%     -    0s
     0     0 -124725.07    0   50 -123968.21 -124725.07  0.61%     -    0s
     0     0 -124710.57    0   50 -123968.21 -124710.57  0.60%     -    0s
     0     0 -124705.60    0   50 -123968.21 -124705.60  0.59%     -    0s
     0     2 -124705.60    0   50 -123968.21 -124705.60  0.59%     -    0s
H   31    25                    -124003.5653 -124641.48  0.51%  14.3    0s
H   34    24                    -124188.5439 -124641.48  0.36%  13.4    0s
H   38    23                    -124279.2080 -124641.48  0.29%  15.1    0s
H  348   235                    -124306.2916 -124568.49  0.21%   7.0    0s
H  496   249                    -124308.6212 -124568.49  0.21%   5.9    0s
*  500   249              25    -124312.6364 -124568.49  0.21%   5.9    0s
*  503   249              24    -124320.6956 -124568.49  0.20%   5.9    0s
H  516   249                    -124325.5360 -124568.49  0.20%   5.8    0s
H  556   249                    -124360.6036 -124568.49  0.17%   5.6    0s
*  907   156              23    -124371.6453 -124543.86  0.14%   4.9    0s
*  944   156              25    -124375.2458 -124543.86  0.14%   4.9    0s

Cutting planes:
  Gomory: 44
  Implied bound: 6
  MIR: 183
  Flow cover: 7
  RLT: 38
  Relax-and-lift: 4
  BQP: 3

Explored 1208 nodes (6160 simplex iterations) in 0.24 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -124375 -124372 -124361 ... -124189
No other solutions better than -124375

Optimal solution found (tolerance 1.00e-04)
Best objective -1.243752458186e+05, best bound -1.243752458186e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 125079.95
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124375.25
  [DEBUG]   S×d_nominal = 249455.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 249455.20 + -124375.25 = 125079.95
  [DEBUG]   Current θ from Master = 129125.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4045.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18628.51
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 2243.0534, Absolute Gap = 2243.0534, Relative Gap = 0.153816
  Not converged yet (gap = 2243.05 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913370 nonzeros
Model fingerprint: 0x7fd23e85
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148470 rows and 60270 columns (presolve time = 5s)...
Presolve removed 148470 rows and 60270 columns
Presolve time: 6.88s
Presolved: 174003 rows, 73030 columns, 1071071 nonzeros
Variable types: 70771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.84s

Barrier statistics:
 Dense cols : 1154
 AA' NZ     : 4.324e+06
 Factor NZ  : 1.208e+07 (roughly 200 MB of memory)
 Factor Ops : 4.139e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.92873094e+07  3.13692692e+08  1.18e+05 1.39e+01  8.79e+04    11s
   1  -1.51097438e+07  2.75908939e+08  8.30e+04 7.11e+01  6.12e+04    11s
   2  -7.02295822e+06  2.13126322e+08  3.69e+04 1.24e+00  2.86e+04    11s
   3  -1.11004691e+06  1.61694943e+08  2.85e+03 2.73e+00  2.62e+03    12s
   4  -6.40937018e+05  8.55947529e+07  5.80e+02 9.01e-01  6.66e+02    12s
   5  -5.60187532e+05  4.95336183e+07  3.44e+02 4.05e-01  3.70e+02    12s
   6  -4.49948232e+05  3.66786065e+07  1.03e+02 2.69e-01  1.77e+02    12s
   7  -4.06455994e+05  2.65218086e+07  6.49e+01 1.81e-01  1.18e+02    12s
   8  -2.86809911e+05  1.92439317e+07  1.01e+01 1.23e-01  6.59e+01    12s
   9  -1.85352569e+05  1.17244715e+07  2.69e+00 7.20e-02  3.83e+01    12s
  10  -1.49142218e+05  7.27842767e+06  1.72e+00 4.57e-02  2.37e+01    12s
  11  -1.40684541e+05  5.96732507e+06  1.39e+00 3.74e-02  1.95e+01    13s
  12  -1.22409717e+05  3.97760553e+06  9.01e-01 2.47e-02  1.30e+01    13s
  13  -1.06222805e+05  2.92590101e+06  5.15e-01 1.83e-02  9.60e+00    13s
  14  -8.57316416e+04  1.77120915e+06  1.88e-01 1.10e-02  5.87e+00    13s
  15  -6.87940265e+04  5.53173270e+05  9.37e-02 3.46e-03  1.96e+00    13s
  16  -4.81253570e+04  2.19626994e+05  5.10e-02 1.76e-03  8.45e-01    13s
  17  -2.73766160e+04  1.18214497e+05  2.37e-02 2.43e-03  4.59e-01    13s
  18  -2.12940754e+04  8.51327559e+04  1.96e-02 1.96e-03  3.36e-01    14s
  19  -1.77682759e+04  7.46649734e+04  1.72e-02 1.69e-03  2.92e-01    14s
  20  -1.40924064e+04  6.55756702e+04  1.45e-02 1.46e-03  2.51e-01    14s
  21  -1.10564372e+04  5.23137720e+04  1.25e-02 1.26e-03  2.00e-01    14s
  22  -7.78208536e+03  4.13888545e+04  1.03e-02 1.03e-03  1.55e-01    14s
  23  -6.91055518e+03  3.70111566e+04  9.80e-03 8.84e-04  1.39e-01    14s
  24  -2.64833258e+03  3.28091524e+04  7.18e-03 7.49e-04  1.12e-01    15s
  25  -9.27356064e+02  2.97419983e+04  6.19e-03 6.44e-04  9.68e-02    15s
  26   1.74456229e+03  2.61098512e+04  4.68e-03 5.18e-04  7.69e-02    15s
  27   3.19896570e+03  2.36450613e+04  3.91e-03 4.35e-04  6.45e-02    15s
  28   4.61091666e+03  2.08738737e+04  3.20e-03 3.33e-04  5.13e-02    15s
  29   5.93134712e+03  1.92210223e+04  2.58e-03 2.65e-04  4.19e-02    16s
  30   7.02692002e+03  1.78668702e+04  2.08e-03 2.16e-04  3.42e-02    16s
  31   7.70840006e+03  1.64410048e+04  1.77e-03 1.66e-04  2.76e-02    16s
  32   8.49839423e+03  1.54993582e+04  1.43e-03 1.29e-04  2.21e-02    16s
  33   8.89228341e+03  1.47385695e+04  1.26e-03 1.00e-04  1.84e-02    16s
  34   9.21806576e+03  1.42525434e+04  1.13e-03 8.27e-05  1.59e-02    17s
  35   1.00469823e+04  1.40850828e+04  7.83e-04 7.62e-05  1.27e-02    17s
  36   1.01903891e+04  1.39845727e+04  7.25e-04 7.26e-05  1.20e-02    17s
  37   1.04803773e+04  1.37690389e+04  6.11e-04 6.41e-05  1.04e-02    17s
  38   1.05953208e+04  1.34619074e+04  5.65e-04 5.35e-05  9.05e-03    17s
  39   1.08093093e+04  1.30299285e+04  4.80e-04 5.65e-05  7.01e-03    18s
  40   1.09192924e+04  1.27372324e+04  4.35e-04 5.16e-05  5.74e-03    18s
  41   1.11011619e+04  1.26141970e+04  3.66e-04 3.40e-05  4.77e-03    18s
  42   1.11802367e+04  1.25791933e+04  3.33e-04 3.23e-05  4.41e-03    18s
  43   1.13199019e+04  1.24415046e+04  2.78e-04 2.26e-05  3.54e-03    18s
  44   1.15007240e+04  1.23059829e+04  2.11e-04 1.43e-05  2.54e-03    19s
  45   1.16254092e+04  1.22693094e+04  1.63e-04 1.22e-05  2.03e-03    19s
  46   1.17503401e+04  1.22171266e+04  1.17e-04 9.26e-06  1.47e-03    19s
  47   1.18261711e+04  1.21876156e+04  8.86e-05 7.36e-06  1.14e-03    19s
  48   1.18344106e+04  1.21639123e+04  8.52e-05 5.86e-06  1.04e-03    20s
  49   1.19026112e+04  1.21310357e+04  5.98e-05 3.69e-06  7.21e-04    20s
  50   1.19511953e+04  1.21031308e+04  4.21e-05 1.88e-06  4.80e-04    20s
  51   1.19987070e+04  1.20979220e+04  2.54e-05 1.56e-06  3.13e-04    20s
  52   1.20343843e+04  1.20873964e+04  1.28e-05 9.09e-07  1.67e-04    20s
  53   1.20489831e+04  1.20773356e+04  7.64e-06 2.80e-07  8.95e-05    21s
  54   1.20610353e+04  1.20758479e+04  3.48e-06 1.98e-07  4.67e-05    21s
  55   1.20683791e+04  1.20741927e+04  1.05e-06 1.09e-07  1.83e-05    21s
  56   1.20704543e+04  1.20733737e+04  4.14e-07 6.04e-08  9.21e-06    21s
  57   1.20710198e+04  1.20723129e+04  2.55e-07 1.73e-08  4.08e-06    21s
  58   1.20717975e+04  1.20722290e+04  2.76e-08 1.35e-08  1.36e-06    21s
  59   1.20718320e+04  1.20721143e+04  2.86e-08 8.32e-09  8.91e-07    22s
  60   1.20719203e+04  1.20719375e+04  3.79e-09 3.02e-09  5.41e-08    22s
  61   1.20719281e+04  1.20719281e+04  1.36e-09 4.04e-10  1.15e-10    22s

Barrier solved model in 61 iterations and 22.04 seconds (19.73 work units)
Optimal objective 1.20719281e+04


Root crossover log...

  149483 DPushes remaining with DInf 0.0000000e+00                22s
   57226 DPushes remaining with DInf 0.0000000e+00                25s
   14036 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                35s

    5697 PPushes remaining with PInf 3.1625300e-05                35s
    3380 PPushes remaining with PInf 5.9375547e-06                35s
       0 PPushes remaining with PInf 0.0000000e+00                36s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.4980539e+01     36s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72320    1.2071928e+04   0.000000e+00   8.498054e+01     36s
   72376    1.2071928e+04   0.000000e+00   0.000000e+00     36s
   72376    1.2071928e+04   0.000000e+00   0.000000e+00     36s
Concurrent spin time: 8.12s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.207193e+04, 72376 iterations, 35.94 seconds (38.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12071.9281    0  268 -201902.96 12071.9281   106%     -   45s
H    0     0                    -151954.9499 12071.9281   108%     -   46s
H    0     0                    -133605.6599 12071.9281   109%     -   46s
H    0     0                    -127875.2936 12071.9281   109%     -   46s
H    0     0                    -121772.5280 12071.9281   110%     -   48s
H    0     0                    -120166.6268 12071.9281   110%     -   48s
H    0     0                    -63638.18971 12071.9281   119%     -   48s
H    0     0                    -63483.71423 12071.9281   119%     -   49s
H    0     0                    -26626.06379 12071.9281   145%     -   49s
H    0     0                    -21641.74855 12071.9281   156%     -   50s
H    0     0                    -20955.01130 12071.9281   158%     -   50s
H    0     0                    -20456.69335 12071.9281   159%     -   51s
     0     0 5469.60780    0  291 -20456.693 5469.60780   127%     -  175s
H    0     0                    -17886.91346 5469.50845   131%     -  176s
H    0     0                    -17496.48201 5469.50845   131%     -  176s
     0     0 5229.80414    0  336 -17496.482 5229.80414   130%     -  216s
     0     0 5160.72117    0  298 -17496.482 5160.72117   129%     -  237s
     0     0 5127.40389    0  298 -17496.482 5127.40389   129%     -  258s
     0     0 5127.30383    0  299 -17496.482 5127.30383   129%     -  261s
     0     0 2023.50357    0  422 -17496.482 2023.50357   112%     -  367s
H    0     0                    -17493.23221 2023.45694   112%     -  369s
     0     0 1752.74258    0  412 -17493.232 1752.74258   110%     -  419s
     0     0 1639.78852    0  422 -17493.232 1639.78852   109%     -  449s
     0     0 1520.06313    0  426 -17493.232 1520.06313   109%     -  473s
     0     0 1468.28733    0  418 -17493.232 1468.28733   108%     -  490s
     0     0 1455.31751    0  423 -17493.232 1455.31751   108%     -  497s
     0     0 1426.30504    0  431 -17493.232 1426.30504   108%     -  509s
     0     0 1416.00749    0  425 -17493.232 1416.00749   108%     -  515s
     0     0 1411.47851    0  436 -17493.232 1411.47851   108%     -  521s
     0     0 1410.89275    0  436 -17493.232 1410.89275   108%     -  523s
     0     0 -936.69656    0  453 -17493.232 -936.69656  94.6%     -  703s
H    0     0                    -17063.25045 -936.79576  94.5%     -  705s
H    0     0                    -17046.86044 -936.79576  94.5%     -  705s
     0     0 -1461.4713    0  472 -17046.860 -1461.4713  91.4%     -  789s
     0     0 -1668.9778    0  493 -17046.860 -1668.9778  90.2%     -  839s
     0     0 -1738.1236    0  497 -17046.860 -1738.1236  89.8%     -  868s
     0     0 -1776.1759    0  506 -17046.860 -1776.1759  89.6%     -  889s
     0     0 -1796.6025    0  513 -17046.860 -1796.6025  89.5%     -  901s
     0     0 -1802.3516    0  511 -17046.860 -1802.3516  89.4%     -  908s
     0     0 -1814.6042    0  473 -17046.860 -1814.6042  89.4%     -  919s
     0     0 -1831.0037    0  569 -17046.860 -1831.0037  89.3%     -  934s
     0     0 -1840.4104    0  565 -17046.860 -1840.4104  89.2%     -  939s
     0     0 -1855.7106    0  535 -17046.860 -1855.7106  89.1%     -  947s
     0     0 -1892.1378    0  480 -17046.860 -1892.1378  88.9%     -  964s
     0     0 -1901.0575    0  516 -17046.860 -1901.0575  88.8%     -  975s
     0     0 -1904.9512    0  519 -17046.860 -1904.9512  88.8%     -  981s
     0     0 -1911.5824    0  531 -17046.860 -1911.5824  88.8%     -  987s
     0     0 -1945.8623    0  522 -17046.860 -1945.8623  88.6%     -  999s
     0     0 -1980.2265    0  518 -17046.860 -1980.2265  88.4%     - 1010s
     0     0 -1980.6683    0  520 -17046.860 -1980.6683  88.4%     - 1013s
     0     0 -3070.1074    0  531 -17046.860 -3070.1074  82.0%     - 1108s
     0     0 -3385.8445    0  546 -17046.860 -3385.8445  80.1%     - 1167s
     0     0 -3484.1508    0  596 -17046.860 -3484.1508  79.6%     - 1197s
     0     0 -3552.2513    0  546 -17046.860 -3552.2513  79.2%     - 1220s
     0     0 -3618.5530    0  606 -17046.860 -3618.5530  78.8%     - 1242s
     0     0 -3677.6888    0  608 -17046.860 -3677.6888  78.4%     - 1267s
     0     0 -3699.3897    0  618 -17046.860 -3699.3897  78.3%     - 1281s
     0     0 -3705.8331    0  603 -17046.860 -3705.8331  78.3%     - 1288s
     0     0 -3711.8074    0  613 -17046.860 -3711.8074  78.2%     - 1292s
     0     0 -3718.6044    0  612 -17046.860 -3718.6044  78.2%     - 1300s
     0     0 -3779.2132    0  561 -17046.860 -3779.2132  77.8%     - 1322s
     0     0 -3807.0506    0  558 -17046.860 -3807.0506  77.7%     - 1334s
     0     0 -3816.5900    0  566 -17046.860 -3816.5900  77.6%     - 1342s
     0     0 -3829.5723    0  560 -17046.860 -3829.5723  77.5%     - 1347s
     0     0 -3831.0724    0  563 -17046.860 -3831.0724  77.5%     - 1350s
     0     0 -4145.7543    0  514 -17046.860 -4145.7543  75.7%     - 1394s
     0     0 -4233.9698    0  566 -17046.860 -4233.9698  75.2%     - 1426s
     0     0 -4258.4291    0  576 -17046.860 -4258.4291  75.0%     - 1439s
     0     0 -4266.4941    0  575 -17046.860 -4266.4941  75.0%     - 1447s
     0     0 -4290.8217    0  570 -17046.860 -4290.8217  74.8%     - 1454s
     0     0 -4297.1729    0  588 -17046.860 -4297.1729  74.8%     - 1461s
     0     0 -4299.5411    0  591 -17046.860 -4299.5411  74.8%     - 1464s
     0     0 -4307.7458    0  586 -17046.860 -4307.7458  74.7%     - 1470s
     0     0 -4317.3149    0  577 -17046.860 -4317.3149  74.7%     - 1473s
     0     0 -4351.3465    0  569 -17046.860 -4351.3465  74.5%     - 1485s
     0     0 -4354.9488    0  573 -17046.860 -4354.9488  74.5%     - 1489s
     0     0 -4356.2329    0  571 -17046.860 -4356.2329  74.4%     - 1492s
     0     0 -4521.8411    0  504 -17046.860 -4521.8411  73.5%     - 1521s
     0     0 -4564.2094    0  563 -17046.860 -4564.2094  73.2%     - 1555s
     0     0 -4580.6643    0  554 -17046.860 -4580.6643  73.1%     - 1564s
     0     0 -4590.4898    0  565 -17046.860 -4590.4898  73.1%     - 1570s
     0     0 -4599.7713    0  568 -17046.860 -4599.7713  73.0%     - 1576s
     0     0 -4601.2550    0  558 -17046.860 -4601.2550  73.0%     - 1578s
     0     0 -4662.1562    0  505 -17046.860 -4662.1562  72.7%     - 1605s
     0     0 -4672.9413    0  558 -17046.860 -4672.9413  72.6%     - 1621s
     0     0 -4680.3572    0  514 -17046.860 -4680.3572  72.5%     - 1625s
     0     0 -4691.5248    0  508 -17046.860 -4691.5248  72.5%     - 1631s
     0     0 -4694.8002    0  565 -17046.860 -4694.8002  72.5%     - 1637s
     0     0 -4696.4271    0  563 -17046.860 -4696.4271  72.4%     - 1640s
     0     0 -4743.3825    0  568 -17046.860 -4743.3825  72.2%     - 1654s
     0     0 -4752.6968    0  526 -17046.860 -4752.6968  72.1%     - 1669s
     0     0 -4757.5854    0  567 -17046.860 -4757.5854  72.1%     - 1676s
     0     0 -4764.6358    0  563 -17046.860 -4764.6358  72.0%     - 1683s
     0     0 -4773.2224    0  510 -17046.860 -4773.2224  72.0%     - 1688s
     0     0 -4777.4479    0  558 -17046.860 -4777.4479  72.0%     - 1692s
     0     0 -4780.9681    0  576 -17046.860 -4780.9681  72.0%     - 1696s
     0     0 -4784.9031    0  570 -17046.860 -4784.9031  71.9%     - 1700s
     0     0 -4785.5225    0  577 -17046.860 -4785.5225  71.9%     - 1702s
     0     0 -4807.3413    0  514 -17046.860 -4807.3413  71.8%     - 1711s
     0     0 -4814.8042    0  561 -17046.860 -4814.8042  71.8%     - 1717s
     0     0 -4818.9077    0  567 -17046.860 -4818.9077  71.7%     - 1721s
     0     0 -4822.0431    0  569 -17046.860 -4822.0431  71.7%     - 1723s
     0     0 -4822.5846    0  565 -17046.860 -4822.5846  71.7%     - 1724s
     0     0 -4843.7257    0  511 -17046.860 -4843.7257  71.6%     - 1734s
     0     0 -4847.7685    0  520 -17046.860 -4847.7685  71.6%     - 1743s
     0     0 -4850.0538    0  514 -17046.860 -4850.0538  71.5%     - 1747s
     0     0 -4857.9592    0  516 -17046.860 -4857.9592  71.5%     - 1756s
     0     0 -4863.2274    0  529 -17046.860 -4863.2274  71.5%     - 1763s
     0     0 -4865.2927    0  530 -17046.860 -4865.2927  71.5%     - 1767s
     0     0 -4872.0997    0  533 -17046.860 -4872.0997  71.4%     - 1776s
H    0     0                    -16826.60560 -4872.6600  71.0%     - 1838s
H    0     0                    -16802.41449 -4872.6600  71.0%     - 1854s
     0     0 -4873.2519    0  531 -16802.414 -4873.2519  71.0%     - 1859s
     0     0 -4879.0580    0  519 -16802.414 -4879.0580  71.0%     - 1866s
     0     0 -4879.9749    0  519 -16802.414 -4879.9749  71.0%     - 1879s
     0     2 -4880.4389    0  519 -16802.414 -4880.4389  71.0%     - 2081s
     1     3 -5263.1287    1  427 -16802.414 -4881.1601  70.9% 13937 2115s
     2     4 -4993.4437    1  520 -16802.414 -4993.4437  70.3% 14652 2141s
     3     5 -5752.3073    2  481 -16802.414 -4994.5630  70.3% 16793 2186s
     4    10 -6640.6463    3  483 -16802.414 -4994.5630  70.3% 16377 2224s
     9    19 -7050.4921    4  464 -16802.414 -5311.9939  68.4% 12829 2326s
    18    38 -7430.9175    5  478 -16802.414 -5373.7585  68.0% 15574 2379s
    37    51 -6194.2844    5  549 -16802.414 -5626.7684  66.5% 24766 2507s
    50    73 -6964.3400    6  382 -16802.414 -5626.7684  66.5% 26778 2606s
    72   105 -7067.0108    7  537 -16802.414 -5626.7684  66.5% 23332 2884s
   104   137 -7110.6775    8  454 -16802.414 -5626.7684  66.5% 21144 2958s
   136   200 -7147.4660    9  455 -16802.414 -5626.7684  66.5% 17947 3049s
   199   278 -7202.1083   10  545 -16802.414 -5626.7684  66.5% 14310 3145s
   277   353 -7314.0192   11  549 -16802.414 -5626.7684  66.5% 12211 3227s
   355   414 -7538.6174   14  542 -16802.414 -5626.7684  66.5% 11394 3294s
   427   451 -8145.0529   15  332 -16802.414 -5626.7684  66.5% 11335 3352s
   494   472 -10237.697   16  250 -16802.414 -5626.7684  66.5% 11373 3402s
H  503   472                    -16478.52702 -5626.7684  65.9% 11358 3402s
   531   537 -10653.200   17  357 -16478.527 -5626.7684  65.9% 11552 3464s
   628   555 -10874.378   20  347 -16478.527 -5626.7684  65.9% 11492 3510s
H  642   555                    -16352.23747 -5626.7684  65.6% 11479 3510s
H  647   555                    -16232.24125 -5626.7684  65.3% 11448 3510s
H  662   555                    -16149.50169 -5626.7684  65.2% 11518 3510s
H  665   555                    -15655.45045 -5626.7684  64.1% 11515 3510s
   666   601 -10876.260   21  292 -15655.450 -5626.7684  64.1% 11509 3555s
   769   662 -11406.384   22  286 -15655.450 -5626.7684  64.1% 11122 3592s
   858   669 -11860.386   25  267 -15655.450 -5626.7684  64.1% 10785 3600s

Cutting planes:
  Learned: 3
  Gomory: 2
  Implied bound: 330
  MIR: 3592
  Flow cover: 4735
  RLT: 79
  Relax-and-lift: 801

Explored 877 nodes (10158778 simplex iterations) in 3600.12 seconds (5150.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15655.5 -16149.5 -16232.2 ... -17493.2

Time limit reached
Best objective -1.565545045469e+04, best bound -5.626768392225e+03, gap 64.0587%
  WARNING: Time limit reached. Using best solution found (gap: 64.06%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = -15655.45, θ = 128724.16
  Upper Bound (UB) = -15655.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128724.16
  [DEBUG]   ✓ Scenario 0: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128724.16 ≤ Q = 128750.06 (slack: 25.91)
  [DEBUG]   ✓ Scenario 2: θ = 128724.16 ≤ Q = 128724.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128724.16 ≤ Q = 128724.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128724.16 ≤ Q = 128724.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 128724.16 ≤ Q = 128724.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 128724.16 ≤ Q = 128724.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 128724.16 ≤ Q = 128724.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 128724.16 ≤ Q = 128724.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 128724.16 ≤ Q = 128724.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x56e1ee31
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x56e1ee31
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.186908e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5193812.9765
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.501530e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150152.99    0  128 5193812.98 -150152.99   103%     -    0s
H    0     0                    -115791.2410 -150152.99  29.7%     -    0s
H    0     0                    -116528.8712 -150152.99  28.9%     -    0s
     0     0 -127198.58    0   96 -116528.87 -127198.58  9.16%     -    0s
H    0     0                    -123553.8765 -127084.00  2.86%     -    0s
     0     0 -127084.00    0   93 -123553.88 -127084.00  2.86%     -    0s
     0     0 -127084.00    0   93 -123553.88 -127084.00  2.86%     -    0s
H    0     0                    -124210.2116 -127084.00  2.31%     -    0s
     0     0 -126068.20    0   90 -124210.21 -126068.20  1.50%     -    0s
H    0     0                    -125183.8443 -126064.29  0.70%     -    0s
     0     0 -126062.65    0   92 -125183.84 -126062.65  0.70%     -    0s
H    0     0                    -125305.0779 -125695.93  0.31%     -    0s
     0     0 -125695.93    0   43 -125305.08 -125695.93  0.31%     -    0s
     0     0 -125662.73    0   45 -125305.08 -125662.73  0.29%     -    0s
     0     0 -125662.46    0   45 -125305.08 -125662.46  0.29%     -    0s
     0     0 -125544.06    0   35 -125305.08 -125544.06  0.19%     -    0s
     0     0 -125544.05    0   34 -125305.08 -125544.05  0.19%     -    0s
H    0     0                    -125313.5932 -125533.16  0.18%     -    0s
     0     0 -125528.64    0   32 -125313.59 -125528.64  0.17%     -    0s
     0     0 -125507.41    0   30 -125313.59 -125507.41  0.15%     -    0s
     0     0 -125470.43    0   14 -125313.59 -125470.43  0.13%     -    0s
     0     0 -125455.92    0   16 -125313.59 -125455.92  0.11%     -    0s
     0     0 -125415.14    0   11 -125313.59 -125415.14  0.08%     -    0s
     0     0 -125415.14    0   56 -125313.59 -125415.14  0.08%     -    0s
     0     0 -125415.14    0   56 -125313.59 -125415.14  0.08%     -    0s
H    0     0                    -125321.6034 -125415.14  0.07%     -    0s
     0     0 -125368.25    0    2 -125321.60 -125368.25  0.04%     -    0s
H    0     0                    -125365.6870 -125365.69  0.00%     -    0s

Cutting planes:
  Gomory: 7
  MIR: 44
  Flow cover: 5

Explored 1 nodes (871 simplex iterations) in 0.16 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -125366 -125322 -125314 ... 5.19381e+06
No other solutions better than -125366

Optimal solution found (tolerance 1.00e-04)
Best objective -1.253656869987e+05, best bound -1.253656869987e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 122393.94
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125365.69
  [DEBUG]   S×d_nominal = 247759.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 247759.63 + -125365.69 = 122393.94
  [DEBUG]   Current θ from Master = 128724.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6330.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21985.66
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 1170.3431, Absolute Gap = 1170.3431, Relative Gap = 0.074756
  Not converged yet (gap = 1170.34 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956601 nonzeros
Model fingerprint: 0xf6d789b2
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 155540 rows and 63140 columns (presolve time = 5s)...
Presolve removed 155540 rows and 63140 columns
Presolve time: 7.89s
Presolved: 182223 rows, 76400 columns, 1121536 nonzeros
Variable types: 74141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.34s

Barrier statistics:
 Dense cols : 1153
 AA' NZ     : 4.667e+06
 Factor NZ  : 1.303e+07 (roughly 200 MB of memory)
 Factor Ops : 4.584e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.95963178e+07  3.26132682e+08  1.20e+05 1.35e+01  8.88e+04    13s
   1  -1.53892025e+07  2.87131384e+08  8.45e+04 7.08e+01  6.19e+04    13s
   2  -7.16026524e+06  2.21991888e+08  3.76e+04 1.43e+00  2.89e+04    13s
   3  -1.12744168e+06  1.69161710e+08  2.92e+03 2.61e+00  2.67e+03    13s
   4  -6.42837891e+05  8.97437491e+07  5.69e+02 9.97e-01  6.56e+02    13s
   5  -5.63691563e+05  5.19434776e+07  3.41e+02 4.52e-01  3.67e+02    14s
   6  -4.56600651e+05  3.87180425e+07  1.08e+02 3.07e-01  1.80e+02    14s
   7  -4.18499399e+05  2.91604939e+07  7.17e+01 2.17e-01  1.26e+02    14s
   8  -2.76092839e+05  2.07047462e+07  8.03e+00 1.43e-01  6.67e+01    14s
   9  -1.61997660e+05  1.27323727e+07  2.74e+00 8.55e-02  3.96e+01    14s
  10  -1.44947906e+05  4.66739127e+06  2.11e+00 3.10e-02  1.47e+01    14s
  11  -1.22290687e+05  2.89539616e+06  1.33e+00 1.89e-02  9.19e+00    15s
  12  -1.03684729e+05  1.87755930e+06  7.48e-01 1.24e-02  6.01e+00    15s
  13  -8.26527715e+04  1.02629871e+06  4.07e-01 6.91e-03  3.35e+00    15s
  14  -5.69407927e+04  2.84146350e+05  1.62e-01 1.93e-03  1.03e+00    15s
  15  -3.85908427e+04  1.77458737e+05  9.85e-02 1.26e-03  6.52e-01    15s
  16  -2.73421663e+04  1.10520450e+05  7.28e-02 2.71e-03  4.16e-01    15s
  17  -1.88428429e+04  7.32048579e+04  5.42e-02 1.73e-03  2.78e-01    15s
  18  -1.49795261e+04  5.91482032e+04  4.62e-02 2.31e-03  2.24e-01    16s
  19  -1.12010304e+04  4.82339362e+04  3.87e-02 1.76e-03  1.79e-01    16s
  20  -8.74351680e+03  4.08539401e+04  3.39e-02 1.44e-03  1.50e-01    16s
  21  -6.17904149e+03  3.56510665e+04  2.91e-02 1.18e-03  1.26e-01    16s
  22  -3.30528891e+03  3.10615425e+04  2.39e-02 9.54e-04  1.04e-01    16s
  23  -1.62628315e+03  2.60481724e+04  2.09e-02 7.16e-04  8.35e-02    17s
  24   2.40687989e+02  2.36109748e+04  1.77e-02 5.97e-04  7.05e-02    17s
  25   1.88799892e+03  2.20194451e+04  1.50e-02 5.15e-04  6.08e-02    17s
  26   3.68310163e+03  1.92762571e+04  1.21e-02 3.97e-04  4.71e-02    17s
  27   4.72976773e+03  1.81964984e+04  1.05e-02 3.37e-04  4.06e-02    17s
  28   5.84933236e+03  1.72852759e+04  8.78e-03 2.87e-04  3.45e-02    18s
  29   6.99200916e+03  1.59966467e+04  7.11e-03 2.14e-04  2.72e-02    18s
  30   7.66699528e+03  1.49194838e+04  6.15e-03 2.12e-04  2.19e-02    18s
  31   8.65936083e+03  1.44542912e+04  4.74e-03 1.69e-04  1.75e-02    18s
  32   9.08787330e+03  1.41585329e+04  4.11e-03 1.68e-04  1.53e-02    18s
  33   9.29908778e+03  1.40488383e+04  3.80e-03 1.59e-04  1.43e-02    19s
  34   9.57326791e+03  1.37770083e+04  3.39e-03 1.36e-04  1.27e-02    19s
  35   1.00098951e+04  1.35883686e+04  2.79e-03 1.20e-04  1.08e-02    19s
  36   1.03213675e+04  1.32693142e+04  2.35e-03 9.04e-05  8.90e-03    19s
  37   1.05437649e+04  1.30981015e+04  2.05e-03 7.70e-05  7.71e-03    20s
  38   1.07600104e+04  1.27659959e+04  1.74e-03 1.05e-04  6.06e-03    20s
  39   1.09658319e+04  1.26508656e+04  1.44e-03 8.84e-05  5.09e-03    20s
  40   1.12164665e+04  1.24364023e+04  1.10e-03 5.49e-05  3.68e-03    20s
  41   1.14583210e+04  1.23781153e+04  7.72e-04 4.54e-05  2.78e-03    20s
  42   1.15146164e+04  1.22909610e+04  6.97e-04 3.27e-05  2.34e-03    21s
  43   1.15988749e+04  1.22543878e+04  5.86e-04 2.70e-05  1.98e-03    21s
  44   1.16967065e+04  1.22286060e+04  4.59e-04 2.30e-05  1.61e-03    21s
  45   1.18016005e+04  1.21610069e+04  3.27e-04 1.20e-05  1.09e-03    21s
  46   1.18451623e+04  1.21388739e+04  2.70e-04 8.49e-06  8.87e-04    22s
  47   1.19070304e+04  1.21302411e+04  1.94e-04 7.28e-06  6.74e-04    22s
  48   1.19485723e+04  1.21035381e+04  1.42e-04 3.79e-06  4.68e-04    22s
  49   1.19949952e+04  1.20873406e+04  8.73e-05 1.91e-06  2.79e-04    22s
  50   1.20317087e+04  1.20774282e+04  4.42e-05 6.77e-07  1.38e-04    23s
  51   1.20434183e+04  1.20737118e+04  3.06e-05 1.55e-07  9.15e-05    23s
  52   1.20550752e+04  1.20734386e+04  1.78e-05 1.23e-07  5.55e-05    23s
  53   1.20649994e+04  1.20723564e+04  7.28e-06 8.90e-07  2.22e-05    23s
  54   1.20693778e+04  1.20720577e+04  2.59e-06 3.46e-07  8.09e-06    23s
  55   1.20717891e+04  1.20719443e+04  1.17e-07 9.97e-08  4.69e-07    23s
  56   1.20719272e+04  1.20719281e+04  1.55e-09 1.32e-09  2.67e-09    24s
  57   1.20719280e+04  1.20719281e+04  5.58e-07 1.21e-09  4.96e-10    24s
  58   1.20719281e+04  1.20719281e+04  5.95e-08 1.12e-09  4.58e-11    24s

Barrier solved model in 58 iterations and 24.00 seconds (19.81 work units)
Optimal objective 1.20719281e+04


Root crossover log...

  156454 DPushes remaining with DInf 0.0000000e+00                24s
   78295 DPushes remaining with DInf 0.0000000e+00                25s
   23072 DPushes remaining with DInf 0.0000000e+00                30s
     348 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                35s

    4001 PPushes remaining with PInf 2.6122124e-05                35s
       0 PPushes remaining with PInf 0.0000000e+00                36s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7557203e-01     36s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71021    1.2071928e+04   0.000000e+00   1.755720e-01     36s
   71027    1.2071928e+04   0.000000e+00   0.000000e+00     36s
   71027    1.2071928e+04   0.000000e+00   0.000000e+00     36s
Concurrent spin time: 8.19s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.207193e+04, 71027 iterations, 35.29 seconds (36.37 work units)
Total elapsed time = 45.09s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12071.9281    0  268 -201902.96 12071.9281   106%     -   46s
H    0     0                    -130212.1544 12071.9281   109%     -   47s
H    0     0                    -128671.9819 12071.9281   109%     -   47s
H    0     0                    -63638.18971 12071.9281   119%     -   47s
H    0     0                    -63483.71423 12071.9281   119%     -   48s
H    0     0                    -26626.06379 12071.9281   145%     -   48s
H    0     0                    -21641.74855 12071.9281   156%     -   48s
H    0     0                    -20955.01130 12071.9281   158%     -   49s
H    0     0                    -20456.69335 12071.9281   159%     -   50s
     0     0 5543.69600    0  381 -20456.693 5543.69600   127%     -  174s
H    0     0                    -17955.37079 5541.32245   131%     -  176s
H    0     0                    -17748.68770 5541.32245   131%     -  176s
H    0     0                    -17564.93933 5541.32245   132%     -  176s
H    0     0                    -17496.48201 5541.32245   132%     -  176s
     0     0 5101.56128    0  394 -17496.482 5101.56128   129%     -  220s
     0     0 5021.66094    0  415 -17496.482 5021.66094   129%     -  238s
     0     0 4977.16729    0  397 -17496.482 4977.16729   128%     -  259s
     0     0 4790.57402    0  415 -17496.482 4790.57402   127%     -  282s
     0     0 4754.34631    0  358 -17496.482 4754.34631   127%     -  291s
     0     0 4648.20110    0  415 -17496.482 4648.20110   127%     -  301s
     0     0 4646.10839    0  415 -17496.482 4646.10839   127%     -  303s
     0     0 4645.52816    0  417 -17496.482 4645.52816   127%     -  304s
     0     0 2045.95505    0  463 -17496.482 2045.95505   112%     -  409s
H    0     0                    -17493.23221 2045.94715   112%     -  411s
     0     0 1612.30823    0  463 -17493.232 1612.30823   109%     -  483s
     0     0 1466.91400    0  475 -17493.232 1466.91400   108%     -  555s
     0     0 1420.27713    0  480 -17493.232 1420.27713   108%     -  575s
     0     0 1399.97317    0  478 -17493.232 1399.97317   108%     -  591s
     0     0 1359.13142    0  476 -17493.232 1359.13142   108%     -  610s
     0     0 1346.02664    0  487 -17493.232 1346.02664   108%     -  619s
     0     0 1339.80431    0  479 -17493.232 1339.80431   108%     -  626s
     0     0 1294.50668    0  482 -17493.232 1294.50668   107%     -  641s
     0     0 1242.48758    0  486 -17493.232 1242.48758   107%     -  659s
     0     0 1237.32015    0  477 -17493.232 1237.32015   107%     -  668s
     0     0 1211.14657    0  475 -17493.232 1211.14657   107%     -  682s
     0     0 1155.20525    0  473 -17493.232 1155.20525   107%     -  705s
     0     0 1110.63352    0  475 -17493.232 1110.63352   106%     -  720s
     0     0 1075.15640    0  485 -17493.232 1075.15640   106%     -  731s
     0     0 1072.13069    0  491 -17493.232 1072.13069   106%     -  735s
     0     0  957.70992    0  490 -17493.232  957.70992   105%     -  757s
     0     0  889.91649    0  493 -17493.232  889.91649   105%     -  783s
     0     0  879.46262    0  501 -17493.232  879.46262   105%     -  793s
     0     0  877.26185    0  504 -17493.232  877.26185   105%     -  798s
     0     0  875.50918    0  508 -17493.232  875.50918   105%     -  803s
     0     0  864.59655    0  500 -17493.232  864.59655   105%     -  808s
     0     0  864.24467    0  497 -17493.232  864.24467   105%     -  810s
     0     0 -1137.1665    0  480 -17493.232 -1137.1665  93.5%     - 1002s
H    0     0                    -17412.38017 -1137.2040  93.5%     - 1003s
H    0     0                    -17290.71914 -1137.2040  93.4%     - 1003s
H    0     0                    -17283.07696 -1137.2040  93.4%     - 1003s
     0     0 -1817.6776    0  483 -17283.077 -1817.6776  89.5%     - 1112s
     0     0 -1939.2688    0  534 -17283.077 -1939.2688  88.8%     - 1150s
     0     0 -2020.7562    0  534 -17283.077 -2020.7562  88.3%     - 1185s
     0     0 -2091.0751    0  518 -17283.077 -2091.0751  87.9%     - 1220s
     0     0 -2137.8001    0  533 -17283.077 -2137.8001  87.6%     - 1247s
     0     0 -2157.1706    0  539 -17283.077 -2157.1706  87.5%     - 1263s
     0     0 -2203.1501    0  580 -17283.077 -2203.1501  87.3%     - 1290s
     0     0 -2233.5753    0  542 -17283.077 -2233.5753  87.1%     - 1307s
     0     0 -2276.9161    0  540 -17283.077 -2276.9161  86.8%     - 1323s
     0     0 -2330.6017    0  545 -17283.077 -2330.6017  86.5%     - 1343s
     0     0 -2348.2356    0  547 -17283.077 -2348.2356  86.4%     - 1350s
     0     0 -2365.4458    0  544 -17283.077 -2365.4458  86.3%     - 1357s
     0     0 -2373.9053    0  545 -17283.077 -2373.9053  86.3%     - 1363s
     0     0 -2409.0334    0  530 -17283.077 -2409.0334  86.1%     - 1375s
     0     0 -2411.5434    0  578 -17283.077 -2411.5434  86.0%     - 1380s
     0     0 -2414.4987    0  537 -17283.077 -2414.4987  86.0%     - 1382s
     0     0 -2421.0389    0  579 -17283.077 -2421.0389  86.0%     - 1386s
     0     0 -2426.1832    0  579 -17283.077 -2426.1832  86.0%     - 1390s
     0     0 -2432.6706    0  587 -17283.077 -2432.6706  85.9%     - 1395s
     0     0 -2439.3409    0  588 -17283.077 -2439.3409  85.9%     - 1398s
     0     0 -2440.1484    0  585 -17283.077 -2440.1484  85.9%     - 1399s
     0     0 -3310.1050    0  552 -17283.077 -3310.1050  80.8%     - 1470s
     0     0 -3564.2313    0  496 -17283.077 -3564.2313  79.4%     - 1509s
     0     0 -3651.7509    0  572 -17283.077 -3651.7509  78.9%     - 1536s
     0     0 -3713.6072    0  507 -17283.077 -3713.6072  78.5%     - 1550s
     0     0 -3813.0213    0  514 -17283.077 -3813.0213  77.9%     - 1569s
     0     0 -3822.5509    0  524 -17283.077 -3822.5509  77.9%     - 1576s
     0     0 -3838.5419    0  515 -17283.077 -3838.5419  77.8%     - 1584s
     0     0 -3841.3204    0  517 -17283.077 -3841.3204  77.8%     - 1588s
     0     0 -3845.9890    0  520 -17283.077 -3845.9890  77.7%     - 1593s
     0     0 -3851.5795    0  524 -17283.077 -3851.5795  77.7%     - 1601s
     0     0 -3863.5887    0  570 -17283.077 -3863.5887  77.6%     - 1607s
     0     0 -3864.7046    0  516 -17283.077 -3864.7046  77.6%     - 1609s
     0     0 -4194.5041    0  554 -17283.077 -4194.5041  75.7%     - 1659s
     0     0 -4268.3747    0  576 -17283.077 -4268.3747  75.3%     - 1683s
     0     0 -4293.0738    0  513 -17283.077 -4293.0738  75.2%     - 1691s
     0     0 -4294.6265    0  518 -17283.077 -4294.6265  75.2%     - 1695s
     0     0 -4408.3037    0  576 -17283.077 -4408.3037  74.5%     - 1721s
H    0     0                    -17046.86044 -4410.2926  74.1%     - 1746s
H    0     0                    -16937.38431 -4410.2926  74.0%     - 1752s
H    0     0                    -16826.60560 -4410.2926  73.8%     - 1752s
     0     0 -4427.1192    0  573 -16826.606 -4427.1192  73.7%     - 1766s
     0     0 -4445.6157    0  581 -16826.606 -4445.6157  73.6%     - 1775s
     0     0 -4462.4212    0  586 -16826.606 -4462.4212  73.5%     - 1785s
     0     0 -4471.0550    0  595 -16826.606 -4471.0550  73.4%     - 1793s
     0     0 -4479.2663    0  587 -16826.606 -4479.2663  73.4%     - 1799s
     0     0 -4489.6019    0  593 -16826.606 -4489.6019  73.3%     - 1805s
     0     0 -4491.2541    0  607 -16826.606 -4491.2541  73.3%     - 1808s
     0     0 -4545.5882    0  558 -16826.606 -4545.5882  73.0%     - 1825s
     0     0 -4570.0476    0  578 -16826.606 -4570.0476  72.8%     - 1834s
     0     0 -4589.8126    0  585 -16826.606 -4589.8126  72.7%     - 1843s
     0     0 -4590.9071    0  589 -16826.606 -4590.9071  72.7%     - 1846s
     0     0 -4631.2189    0  562 -16826.606 -4631.2189  72.5%     - 1865s
     0     0 -4652.1924    0  549 -16826.606 -4652.1924  72.4%     - 1885s
     0     0 -4656.6750    0  564 -16826.606 -4656.6750  72.3%     - 1890s
     0     0 -4668.3790    0  574 -16826.606 -4668.3790  72.3%     - 1893s
     0     0 -4674.7582    0  586 -16826.606 -4674.7582  72.2%     - 1898s
     0     0 -4682.1218    0  587 -16826.606 -4682.1218  72.2%     - 1906s
     0     0 -4683.3360    0  577 -16826.606 -4683.3360  72.2%     - 1908s
     0     0 -4702.1270    0  584 -16826.606 -4702.1270  72.1%     - 1920s
     0     0 -4706.2411    0  534 -16826.606 -4706.2411  72.0%     - 1925s
     0     0 -4707.1592    0  530 -16826.606 -4707.1592  72.0%     - 1928s
     0     0 -4717.4629    0  600 -16826.606 -4717.4629  72.0%     - 1939s
H    0     0                    -16802.41449 -4718.0558  71.9%     - 1984s
     0     0 -4728.6527    0  597 -16802.414 -4728.6527  71.9%     - 1993s
     0     0 -4731.9261    0  605 -16802.414 -4731.9261  71.8%     - 1998s
     0     0 -4735.4438    0  605 -16802.414 -4735.4438  71.8%     - 2005s
     0     0 -4735.6181    0  547 -16802.414 -4735.6181  71.8%     - 2010s
     0     0 -4745.5216    0  535 -16802.414 -4745.5216  71.8%     - 2021s
     0     0 -4750.6507    0  594 -16802.414 -4750.6507  71.7%     - 2029s
     0     0 -4753.2077    0  592 -16802.414 -4753.2077  71.7%     - 2033s
     0     0 -4753.9902    0  600 -16802.414 -4753.9902  71.7%     - 2036s
     0     0 -4767.7333    0  588 -16802.414 -4767.7333  71.6%     - 2049s
     0     0 -4774.4592    0  593 -16802.414 -4774.4592  71.6%     - 2056s
     0     0 -4776.8177    0  598 -16802.414 -4776.8177  71.6%     - 2060s
     0     0 -4777.7256    0  594 -16802.414 -4777.7256  71.6%     - 2063s
     0     0 -4779.8204    0  601 -16802.414 -4779.8204  71.6%     - 2070s
     0     0 -4783.7946    0  541 -16802.414 -4783.7946  71.5%     - 2077s
     0     0 -4785.0080    0  541 -16802.414 -4785.0080  71.5%     - 2081s
     0     0 -4785.8512    0  601 -16802.414 -4785.8512  71.5%     - 2089s
     0     0 -4785.9765    0  601 -16802.414 -4785.9765  71.5%     - 2104s
H    0     0                    -16490.36134 -4786.0701  71.0%     - 2394s
H    0     0                    -15719.64789 -4786.0701  69.6%     - 2401s
H    0     0                    -15535.89676 -4786.0701  69.2%     - 2422s
     0     2 -4786.0701    0  601 -15535.897 -4786.0701  69.2%     - 2426s
     1     3 -5153.8951    1  562 -15535.897 -4786.0701  69.2% 25667 2478s
     2     4 -4933.1450    1  581 -15535.897 -4933.1450  68.2% 18175 2501s
     3     6 -5597.3983    2  573 -15535.897 -4933.2022  68.2% 16551 2541s
     5     9 -5679.3268    3  541 -15535.897 -4933.2022  68.2% 16591 2583s
     8    18 -5881.6246    3  509 -15535.897 -5258.2707  66.2% 16056 2630s
    17    36 -6103.4319    4  525 -15535.897 -5449.4783  64.9% 14798 2692s
    35    50 -5866.2233    5  593 -15535.897 -5629.8194  63.8% 23926 2810s
    49    74 -7319.5170    6  462 -15535.897 -5629.8194  63.8% 27116 2903s
H   73   162                    -15471.58939 -5629.8194  63.6% 21675 3013s
H   78   162                    -15433.92394 -5629.8194  63.5% 21072 3013s
H   81   162                    -15421.95938 -5629.8194  63.5% 20523 3013s
H   93   162                    -15324.84457 -5629.8194  63.3% 18783 3013s
   165   192 -7275.5533    8  349 -15324.845 -5629.8194  63.3% 14843 3126s
   195   228 -7335.0348    9  348 -15324.845 -5629.8194  63.3% 13533 3271s
   231   258 -7472.6299   12  334 -15324.845 -5629.8194  63.3% 12276 3409s
H  255   258                    -15314.96106 -5629.8194  63.2% 11813 3409s
   265   330 -7518.5083   13  322 -15314.961 -5629.8194  63.2% 11571 3500s
   349   372 -7549.6411   14  333 -15314.961 -5629.8194  63.2% 10277 3558s
   404   424 -8130.7223   14  371 -15314.961 -5629.8194  63.2% 10194 3600s

Cutting planes:
  Learned: 2
  Gomory: 1
  Implied bound: 334
  MIR: 3951
  Flow cover: 4512
  RLT: 98
  Relax-and-lift: 631

Explored 462 nodes (5576501 simplex iterations) in 3600.09 seconds (4738.48 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15315 -15324.8 -15422 ... -16826.6

Time limit reached
Best objective -1.531496105530e+04, best bound -5.629819365450e+03, gap 63.2397%
  WARNING: Time limit reached. Using best solution found (gap: 63.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -15314.96, θ = 129567.72
  Upper Bound (UB) = -15314.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 129567.72
  [DEBUG]   ✓ Scenario 0: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 129567.72 ≤ Q = 129567.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 129567.72 ≤ Q = 129567.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xf10c5c8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0f10c5c8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.179556e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.01s
Presolved: 488 rows, 493 columns, 1377 nonzeros
Found heuristic solution: objective 5192090.4556
Variable types: 334 continuous, 159 integer (159 binary)
Found heuristic solution: objective 5191773.6699

Root relaxation: objective -1.528246e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152824.64    0  124 5191773.67 -152824.64   103%     -    0s
H    0     0                    -116157.2066 -152824.64  31.6%     -    0s
H    0     0                    -116473.9923 -152824.64  31.2%     -    0s
H    0     0                    -116758.7605 -152824.64  30.9%     -    0s
H    0     0                    -128063.8729 -131298.26  2.53%     -    0s
     0     0 -131298.26    0   71 -128063.87 -131298.26  2.53%     -    0s
     0     0 -130642.21    0   71 -128063.87 -130642.21  2.01%     -    0s
H    0     0                    -129131.0218 -130545.84  1.10%     -    0s
     0     0 -130545.84    0   71 -129131.02 -130545.84  1.10%     -    0s
     0     0 -130066.24    0   53 -129131.02 -130066.24  0.72%     -    0s
     0     0 -130024.50    0   55 -129131.02 -130024.50  0.69%     -    0s
H    0     0                    -129154.2237 -130024.50  0.67%     -    0s
     0     0 -129835.62    0   42 -129154.22 -129835.62  0.53%     -    0s
     0     0 -129786.60    0   42 -129154.22 -129786.60  0.49%     -    0s
     0     0 -129751.93    0   45 -129154.22 -129751.93  0.46%     -    0s
     0     0 -129735.24    0   45 -129154.22 -129735.24  0.45%     -    0s
     0     2 -129735.24    0   45 -129154.22 -129735.24  0.45%     -    0s
H  544   349                    -129185.8456 -129381.86  0.15%   5.2    0s
H  990   380                    -129197.4773 -129308.63  0.09%   5.0    0s

Cutting planes:
  Gomory: 21
  Implied bound: 7
  MIR: 147
  Flow cover: 11
  RLT: 31
  Relax-and-lift: 1
  BQP: 3

Explored 1797 nodes (8742 simplex iterations) in 0.21 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -129197 -129186 -129154 ... 5.19209e+06
No other solutions better than -129197

Optimal solution found (tolerance 1.00e-04)
Best objective -1.291974773038e+05, best bound -1.291974773038e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 122051.45
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129197.48
  [DEBUG]   S×d_nominal = 251248.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 251248.93 + -129197.48 = 122051.45
  [DEBUG]   Current θ from Master = 129567.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7516.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22831.24
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = 1510.8325, Absolute Gap = 1510.8325, Relative Gap = 0.098651
  Not converged yet (gap = 1510.83 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999832 nonzeros
Model fingerprint: 0x3546d599
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162610 rows and 66010 columns (presolve time = 5s)...
Presolve removed 162610 rows and 66010 columns
Presolve time: 6.80s
Presolved: 190443 rows, 79770 columns, 1172256 nonzeros
Variable types: 77511 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -385958.1010
Found heuristic solution: objective -201902.9599

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.39s

Barrier statistics:
 Dense cols : 1154
 AA' NZ     : 5.017e+06
 Factor NZ  : 1.393e+07 (roughly 220 MB of memory)
 Factor Ops : 4.869e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.98650708e+07  3.39013382e+08  1.22e+05 1.32e+01  8.96e+04    12s
   1  -1.56383894e+07  2.98806737e+08  8.58e+04 6.97e+01  6.25e+04    12s
   2  -5.23635839e+06  2.33389984e+08  2.77e+04 1.22e+00  2.14e+04    12s
   3  -1.16784856e+06  1.74050320e+08  2.76e+03 2.11e+00  2.51e+03    13s
   4  -6.92655813e+05  7.70819217e+07  5.31e+02 4.88e-01  5.72e+02    13s
   5  -5.52134685e+05  4.73686060e+07  3.05e+02 2.53e-01  3.21e+02    13s
   6  -4.39867064e+05  3.72680467e+07  9.86e+01 1.86e-01  1.64e+02    13s
   7  -3.74536889e+05  2.67229530e+07  4.02e+01 1.24e-01  9.78e+01    13s
   8  -2.51202570e+05  2.21938765e+07  6.38e+00 1.00e-01  6.75e+01    14s
   9  -1.75326526e+05  1.18131096e+07  2.57e+00 5.14e-02  3.52e+01    14s
  10  -1.46771950e+05  6.27513189e+06  1.64e+00 2.64e-02  1.88e+01    14s
  11  -1.23391301e+05  3.54952099e+06  9.92e-01 1.45e-02  1.07e+01    14s
  12  -1.06640164e+05  2.63868044e+06  5.70e-01 1.07e-02  7.96e+00    14s
  13  -8.77220145e+04  2.13612747e+06  2.88e-01 8.53e-03  6.43e+00    14s
  14  -6.96629994e+04  4.21089369e+05  1.30e-01 1.67e-03  1.42e+00    15s
  15  -5.07459338e+04  2.03163431e+05  7.79e-02 1.20e-03  7.33e-01    15s
  16  -2.88250450e+04  1.42472768e+05  3.65e-02 1.12e-03  4.94e-01    15s
  17  -2.26735661e+04  9.32490216e+04  3.02e-02 1.28e-03  3.35e-01    15s
  18  -1.61724825e+04  7.33172799e+04  2.35e-02 9.76e-04  2.58e-01    16s
  19  -1.39341229e+04  6.06299081e+04  2.12e-02 7.79e-04  2.15e-01    16s
  20  -1.05940545e+04  4.62674989e+04  1.80e-02 5.46e-04  1.64e-01    16s
  21  -8.22106984e+03  3.86420312e+04  1.58e-02 4.27e-04  1.35e-01    16s
  22  -5.94207873e+03  3.53002611e+04  1.37e-02 3.76e-04  1.19e-01    17s
  23  -2.54609469e+03  3.01945712e+04  1.07e-02 2.96e-04  9.45e-02    17s
  24  -2.48820437e+02  2.76708523e+04  8.70e-03 2.61e-04  8.06e-02    17s
  25   1.69645992e+03  2.37072286e+04  7.10e-03 1.94e-04  6.35e-02    17s
  26   3.52087279e+03  2.12177043e+04  5.71e-03 2.92e-04  5.11e-02    18s
  27   5.17540939e+03  1.89771097e+04  4.49e-03 2.22e-04  3.98e-02    18s
  28   5.59834489e+03  1.81922459e+04  4.20e-03 1.99e-04  3.63e-02    18s
  29   6.26298221e+03  1.69491741e+04  3.73e-03 1.58e-04  3.08e-02    19s
  30   6.89175477e+03  1.61570112e+04  3.31e-03 1.34e-04  2.67e-02    19s
  31   7.96357054e+03  1.57645390e+04  2.59e-03 1.21e-04  2.25e-02    19s
  32   8.32113380e+03  1.51118723e+04  2.35e-03 9.95e-05  1.96e-02    19s
  33   8.60897659e+03  1.45133792e+04  2.17e-03 7.88e-05  1.70e-02    20s
  34   9.37323383e+03  1.41193185e+04  1.68e-03 6.57e-05  1.37e-02    20s
  35   9.88452039e+03  1.39307250e+04  1.36e-03 6.56e-05  1.17e-02    20s
  36   1.01594513e+04  1.36614452e+04  1.18e-03 5.60e-05  1.01e-02    21s
  37   1.04774845e+04  1.32491391e+04  9.76e-04 4.90e-05  8.00e-03    21s
  38   1.07453882e+04  1.30804547e+04  8.05e-04 6.54e-05  6.74e-03    21s
  39   1.09740649e+04  1.29238448e+04  6.58e-04 5.73e-05  5.63e-03    22s
  40   1.11526210e+04  1.26829602e+04  5.49e-04 5.05e-05  4.42e-03    22s
  41   1.13224429e+04  1.25753740e+04  4.43e-04 4.11e-05  3.62e-03    22s
  42   1.14503814e+04  1.24460909e+04  3.67e-04 3.09e-05  2.87e-03    22s
  43   1.16392851e+04  1.23662974e+04  2.55e-04 2.63e-05  2.10e-03    23s
  44   1.17778417e+04  1.22834074e+04  1.70e-04 1.87e-05  1.46e-03    23s
  45   1.18699591e+04  1.22506658e+04  1.15e-04 1.56e-05  1.10e-03    23s
  46   1.19000773e+04  1.22161688e+04  9.76e-05 1.24e-05  9.12e-04    24s
  47   1.19379618e+04  1.21692878e+04  7.56e-05 8.09e-06  6.68e-04    24s
  48   1.19840743e+04  1.21276695e+04  4.97e-05 4.24e-06  4.14e-04    24s
  49   1.20269682e+04  1.21167773e+04  2.64e-05 3.29e-06  2.59e-04    25s
  50   1.20470352e+04  1.20868134e+04  1.58e-05 6.67e-07  1.15e-04    25s
  51   1.20714763e+04  1.20829995e+04  3.54e-06 3.32e-07  3.33e-05    25s
  52   1.20765283e+04  1.20819700e+04  1.05e-06 2.41e-07  1.57e-05    25s
  53   1.20787373e+04  1.20795312e+04  1.85e-07 2.29e-08  2.29e-06    26s
  54   1.20792532e+04  1.20792653e+04  4.64e-09 8.00e-10  3.50e-08    26s
  55   1.20792573e+04  1.20792573e+04  2.69e-10 2.92e-10  6.55e-12    26s

Barrier solved model in 55 iterations and 26.05 seconds (20.81 work units)
Optimal objective 1.20792573e+04


Root crossover log...

  163342 DPushes remaining with DInf 0.0000000e+00                26s
    9548 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                32s

    3322 PPushes remaining with PInf 4.1967490e-06                32s
       0 PPushes remaining with PInf 0.0000000e+00                33s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7212753e-03     33s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71527    1.2079257e+04   0.000000e+00   1.721275e-03     33s
   71530    1.2079257e+04   0.000000e+00   0.000000e+00     33s
   71530    1.2079257e+04   0.000000e+00   0.000000e+00     33s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 1.207926e+04, 71530 iterations, 24.91 seconds (24.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12079.2573    0  269 -201902.96 12079.2573   106%     -   35s
H    0     0                    -145613.3245 12079.2573   108%     -   36s
H    0     0                    -99989.51436 12079.2573   112%     -   36s
H    0     0                    -91423.71238 12079.2573   113%     -   36s
H    0     0                    -63638.18971 12079.2573   119%     -   37s
H    0     0                    -63483.71423 12079.2573   119%     -   37s
H    0     0                    -26626.06379 12079.2573   145%     -   38s
H    0     0                    -21438.10864 12079.2573   156%     -   38s
H    0     0                    -20955.01130 12079.2573   158%     -   39s
H    0     0                    -20456.69335 12079.2573   159%     -   40s
     0     0 4827.60440    0  349 -20456.693 4827.60440   124%     -  214s
H    0     0                    -17955.37079 4826.57400   127%     -  216s
H    0     0                    -17564.93933 4826.57400   127%     -  216s
H    0     0                    -17496.48201 4826.57400   128%     -  216s
     0     0 4489.06233    0  351 -17496.482 4489.06233   126%     -  245s
     0     0 4481.57135    0  359 -17496.482 4481.57135   126%     -  251s
     0     0 4478.42417    0  366 -17496.482 4478.42417   126%     -  264s
     0     0 4465.24296    0  352 -17496.482 4465.24296   126%     -  276s
     0     0 4464.67678    0  357 -17496.482 4464.67678   126%     -  278s
     0     0 1550.02136    0  474 -17496.482 1550.02136   109%     -  459s
     0     0 1070.46820    0  447 -17496.482 1070.46820   106%     -  557s
     0     0  969.61138    0  461 -17496.482  969.61138   106%     -  604s
     0     0  727.31483    0  457 -17496.482  727.31483   104%     -  669s
     0     0  714.16146    0  468 -17496.482  714.16146   104%     -  686s
     0     0  693.15719    0  462 -17496.482  693.15719   104%     -  714s
     0     0  618.65146    0  462 -17496.482  618.65146   104%     -  754s
     0     0  609.00254    0  475 -17496.482  609.00254   103%     -  769s
     0     0  593.40748    0  475 -17496.482  593.40748   103%     -  796s
     0     0  579.89416    0  481 -17496.482  579.89416   103%     -  813s
     0     0  570.95340    0  477 -17496.482  570.95340   103%     -  823s
     0     0  530.86121    0  491 -17496.482  530.86121   103%     -  856s
     0     0  506.79606    0  483 -17496.482  506.79606   103%     -  879s
     0     0  500.43651    0  492 -17496.482  500.43651   103%     -  895s
     0     0  498.47985    0  491 -17496.482  498.47985   103%     -  901s
     0     0  498.02771    0  492 -17496.482  498.02771   103%     -  904s
     0     0 -1599.4060    0  509 -17496.482 -1599.4060  90.9%     - 1154s
H    0     0                    -17487.12700 -1599.4465  90.9%     - 1155s
H    0     0                    -17260.26549 -1599.4465  90.7%     - 1156s
H    0     0                    -17250.91048 -1599.4465  90.7%     - 1156s
     0     0 -2060.1898    0  542 -17250.910 -2060.1898  88.1%     - 1258s
     0     0 -2326.6404    0  562 -17250.910 -2326.6404  86.5%     - 1348s
     0     0 -2543.9319    0  523 -17250.910 -2543.9319  85.3%     - 1388s
     0     0 -2608.0409    0  523 -17250.910 -2608.0409  84.9%     - 1408s
     0     0 -2615.9906    0  527 -17250.910 -2615.9906  84.8%     - 1417s
     0     0 -2637.5426    0  529 -17250.910 -2637.5426  84.7%     - 1429s
     0     0 -2648.3097    0  530 -17250.910 -2648.3097  84.6%     - 1437s
     0     0 -2676.5735    0  519 -17250.910 -2676.5735  84.5%     - 1454s
     0     0 -2708.6672    0  575 -17250.910 -2708.6672  84.3%     - 1474s
     0     0 -2724.6443    0  585 -17250.910 -2724.6443  84.2%     - 1481s
     0     0 -2732.1074    0  586 -17250.910 -2732.1074  84.2%     - 1489s
     0     0 -2737.3273    0  540 -17250.910 -2737.3273  84.1%     - 1497s
     0     0 -2796.1800    0  573 -17250.910 -2796.1800  83.8%     - 1516s
     0     0 -2804.2761    0  576 -17250.910 -2804.2761  83.7%     - 1523s
     0     0 -2833.0494    0  581 -17250.910 -2833.0494  83.6%     - 1533s
     0     0 -2839.0805    0  569 -17250.910 -2839.0805  83.5%     - 1541s
     0     0 -2840.6945    0  577 -17250.910 -2840.6945  83.5%     - 1544s
     0     0 -3384.7685    0  570 -17250.910 -3384.7685  80.4%     - 1626s
     0     0 -3597.1688    0  594 -17250.910 -3597.1688  79.1%     - 1671s
     0     0 -3715.6731    0  547 -17250.910 -3715.6731  78.5%     - 1696s
     0     0 -3757.8548    0  558 -17250.910 -3757.8548  78.2%     - 1711s
     0     0 -3793.3606    0  605 -17250.910 -3793.3606  78.0%     - 1724s
     0     0 -3817.0859    0  564 -17250.910 -3817.0859  77.9%     - 1736s
     0     0 -3826.1440    0  602 -17250.910 -3826.1440  77.8%     - 1745s
     0     0 -3845.9374    0  491 -17250.910 -3845.9374  77.7%     - 1753s
     0     0 -3867.6980    0  538 -17250.910 -3867.6980  77.6%     - 1767s
     0     0 -3909.0975    0  601 -17250.910 -3909.0975  77.3%     - 1785s
     0     0 -3927.8442    0  549 -17250.910 -3927.8442  77.2%     - 1801s
     0     0 -3940.7582    0  595 -17250.910 -3940.7582  77.2%     - 1811s
     0     0 -3944.8900    0  544 -17250.910 -3944.8900  77.1%     - 1816s
     0     0 -3977.4100    0  529 -17250.910 -3977.4100  76.9%     - 1836s
     0     0 -4009.0158    0  541 -17250.910 -4009.0158  76.8%     - 1849s
     0     0 -4017.1324    0  608 -17250.910 -4017.1324  76.7%     - 1857s
     0     0 -4023.4312    0  559 -17250.910 -4023.4312  76.7%     - 1863s
     0     0 -4044.6548    0  579 -17250.910 -4044.6548  76.6%     - 1875s
     0     0 -4048.1056    0  564 -17250.910 -4048.1056  76.5%     - 1879s
     0     0 -4049.7807    0  605 -17250.910 -4049.7807  76.5%     - 1883s
     0     0 -4256.7783    0  630 -17250.910 -4256.7783  75.3%     - 1935s
H    0     0                    -17050.11024 -4256.7834  75.0%     - 1937s
     0     0 -4357.2460    0  579 -17050.110 -4357.2460  74.4%     - 1960s
     0     0 -4405.7029    0  513 -17050.110 -4405.7029  74.2%     - 1980s
     0     0 -4419.8013    0  519 -17050.110 -4419.8013  74.1%     - 1989s
     0     0 -4424.3162    0  538 -17050.110 -4424.3162  74.1%     - 1996s
     0     0 -4431.4769    0  516 -17050.110 -4431.4769  74.0%     - 2003s
     0     0 -4439.9809    0  513 -17050.110 -4439.9809  74.0%     - 2009s
     0     0 -4452.5183    0  521 -17050.110 -4452.5183  73.9%     - 2023s
     0     0 -4454.6910    0  560 -17050.110 -4454.6910  73.9%     - 2042s
     0     0 -4532.1208    0  572 -17050.110 -4532.1208  73.4%     - 2083s
H    0     0                    -17046.86044 -4532.1979  73.4%     - 2087s
     0     0 -4573.0186    0  530 -17046.860 -4573.0186  73.2%     - 2107s
     0     0 -4593.1828    0  582 -17046.860 -4593.1828  73.1%     - 2115s
     0     0 -4598.4143    0  511 -17046.860 -4598.4143  73.0%     - 2121s
     0     0 -4600.5330    0  596 -17046.860 -4600.5330  73.0%     - 2126s
     0     0 -4627.8664    0  572 -17046.860 -4627.8664  72.9%     - 2143s
     0     0 -4636.2162    0  540 -17046.860 -4636.2162  72.8%     - 2150s
     0     0 -4648.7132    0  593 -17046.860 -4648.7132  72.7%     - 2157s
     0     0 -4657.8507    0  532 -17046.860 -4657.8507  72.7%     - 2182s
     0     0 -4661.1170    0  596 -17046.860 -4661.1170  72.7%     - 2189s
     0     0 -4662.9040    0  582 -17046.860 -4662.9040  72.6%     - 2190s
     0     0 -4698.0053    0  532 -17046.860 -4698.0053  72.4%     - 2209s
     0     0 -4727.6090    0  536 -17046.860 -4727.6090  72.3%     - 2233s
     0     0 -4730.6017    0  547 -17046.860 -4730.6017  72.2%     - 2238s
     0     0 -4760.1777    0  545 -17046.860 -4760.1777  72.1%     - 2252s
     0     0 -4793.3531    0  553 -17046.860 -4793.3531  71.9%     - 2271s
     0     0 -4809.3722    0  555 -17046.860 -4809.3722  71.8%     - 2282s
     0     0 -4813.0579    0  554 -17046.860 -4813.0579  71.8%     - 2286s
     0     0 -4815.0290    0  553 -17046.860 -4815.0290  71.8%     - 2291s
     0     0 -4845.3386    0  545 -17046.860 -4845.3386  71.6%     - 2306s
     0     0 -4852.7675    0  547 -17046.860 -4852.7675  71.5%     - 2315s
     0     0 -4854.3759    0  542 -17046.860 -4854.3759  71.5%     - 2320s
     0     0 -4880.0559    0  548 -17046.860 -4880.0559  71.4%     - 2341s
     0     0 -4887.9812    0  546 -17046.860 -4887.9812  71.3%     - 2352s
     0     0 -4891.3394    0  538 -17046.860 -4891.3394  71.3%     - 2357s
     0     0 -4892.1821    0  528 -17046.860 -4892.1821  71.3%     - 2359s
     0     0 -4899.1246    0  544 -17046.860 -4899.1246  71.3%     - 2370s
     0     0 -4899.8715    0  547 -17046.860 -4899.8715  71.3%     - 2375s
     0     0 -4900.7924    0  539 -17046.860 -4900.7924  71.3%     - 2382s
     0     0 -4901.6042    0  548 -17046.860 -4901.6042  71.2%     - 2387s
     0     0 -4903.2678    0  544 -17046.860 -4903.2678  71.2%     - 2394s
     0     0 -4903.2720    0  544 -17046.860 -4903.2720  71.2%     - 2408s
H    0     0                    -16946.69592 -4903.2720  71.1%     - 2605s
H    0     0                    -16925.93811 -4903.2720  71.0%     - 2614s
     0     2 -4903.2720    0  544 -16925.938 -4903.2720  71.0%     - 2629s
     1     3 -5550.1371    1  491 -16925.938 -4904.3726  71.0% 27161 2649s
     2     4 -5090.4350    1  546 -16925.938 -5090.4350  69.9% 20189 2672s
     3     7 -5353.6333    2  542 -16925.938 -5090.6002  69.9% 17937 2708s
     6    14 -5559.0825    3  522 -16925.938 -5090.6002  69.9% 15763 2789s
    13    28 -5598.1859    4  512 -16925.938 -5283.4062  68.8% 15693 2847s
    27    42 -5604.3219    4  542 -16925.938 -5359.6645  68.3% 21762 2949s
    41    68 -6223.6744    5  548 -16925.938 -5359.6645  68.3% 27340 3472s
    67   106 -7452.0425    6  506 -16925.938 -5508.8280  67.5% 29948 3583s
   105   125 -6274.7132    6  602 -16925.938 -5786.7552  65.8% 29180 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 337
  MIR: 4044
  Flow cover: 4833
  RLT: 97
  Relax-and-lift: 795

Explored 124 nodes (4235009 simplex iterations) in 3600.19 seconds (4288.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -16925.9 -16946.7 -17046.9 ... -17955.4

Time limit reached
Best objective -1.692593811498e+04, best bound -5.786755229250e+03, gap 65.8113%
  WARNING: Time limit reached. Using best solution found (gap: 65.81%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.22s
  Master Objective (UB) = -16925.94, θ = 132353.07
  Upper Bound (UB) = -16925.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 132353.07
  [DEBUG]   ✓ Scenario 0: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 132353.07 ≤ Q = 132353.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 132353.07 ≤ Q = 132353.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 132353.07 ≤ Q = 132353.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 132353.07 ≤ Q = 132353.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 132353.07 ≤ Q = 132353.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 132353.07 ≤ Q = 132353.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x435add54
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x435add54
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.215649e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5288785.0233
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.565767e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156576.73    0  127 5288785.02 -156576.73   103%     -    0s
H    0     0                    -124422.1211 -156576.73  25.8%     -    0s
H    0     0                    -124749.6056 -156576.73  25.5%     -    0s
H    0     0                    -130412.6100 -133292.13  2.21%     -    0s
     0     0 -133292.13    0   51 -130412.61 -133292.13  2.21%     -    0s
     0     0 -133215.31    0   49 -130412.61 -133215.31  2.15%     -    0s
     0     0 -133211.97    0   49 -130412.61 -133211.97  2.15%     -    0s
     0     0 -132383.17    0   43 -130412.61 -132383.17  1.51%     -    0s
H    0     0                    -131088.7927 -132355.56  0.97%     -    0s
H    0     0                    -131376.8679 -132355.56  0.74%     -    0s
     0     0 -132338.09    0   43 -131376.87 -132338.09  0.73%     -    0s
     0     0 -132248.56    0   48 -131376.87 -132248.56  0.66%     -    0s
     0     0 -132241.79    0   48 -131376.87 -132241.79  0.66%     -    0s
H    0     0                    -131452.9369 -132232.56  0.59%     -    0s
     0     2 -132232.56    0   48 -131452.94 -132232.56  0.59%     -    0s
H   31    40                    -131524.9584 -131852.54  0.25%   5.4    0s
H   34    40                    -131525.1425 -131852.54  0.25%   5.2    0s
H   40    40                    -131643.9484 -131852.54  0.16%   4.9    0s
H  137    16                    -131708.5798 -131770.99  0.05%   6.4    0s

Cutting planes:
  Gomory: 31
  Implied bound: 9
  MIR: 116
  Flow cover: 3
  RLT: 29
  Relax-and-lift: 1
  BQP: 2

Explored 219 nodes (1642 simplex iterations) in 0.28 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -131709 -131644 -131525 ... -124422
No other solutions better than -131709

Optimal solution found (tolerance 1.00e-04)
Best objective -1.317085798160e+05, best bound -1.317085798160e+05, gap 0.0000%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 123284.98
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131708.58
  [DEBUG]   S×d_nominal = 254993.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254993.56 + -131708.58 = 123284.98
  [DEBUG]   Current θ from Master = 132353.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9068.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25994.03
  Lower Bound (LB) = -16825.79
  Gap (UB-LB) = -100.1445, Absolute Gap = 100.1445, Relative Gap = -0.005917
  *** CONVERGED (small negative gap: -100.14 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 23
Total Time: 69376.84s
Converged: True
Final Lower Bound: -16825.7936
Final Upper Bound: -16925.9381
Final Gap: -100.144517
Number of Critical Scenarios: 23
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 1, 5, 9] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 9 customers  Mode 1: 0 customers  Mode 2: 41 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 23
Start Time: 2026-01-04 12:31:24
End Time: 2026-01-05 07:47:41
Total Time: 69376.84s
Optimal Value: -16825.79
Lower Bound: -16825.79
Upper Bound: -16925.94
Gap: -100.144517
Plants Opened: {0: [1], 1: [0], 2: [2]} (3 plants)
DCs Opened: [0, 1, 5, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed26_Mixed_gamma20_20260105_074741.csv

Total Execution Time: 69377.58 seconds
End Time: 2026-01-05 07:47:42

All tasks completed successfully!

