
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 35
DI Scenario: MD
Start Time: 2026-01-05 12:31:08
================================================================================
Loading data from data/DH_data_full_seed35.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.220', '1.488'] (k=0.490)
  Product 1: ['1.000', '1.152', '1.327'] (k=0.349)
  Product 2: ['1.000', '1.232', '1.517'] (k=0.514)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=918, max=1770
  DC capacity (MC): min=522, max=896

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.61, max=34.83, count=83
  Deviation (μ̂): min=4.05, max=9.98

Costs:
  Plant fixed cost: min=6086, max=9811
  DC fixed cost: min=3121, max=5698
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.313', '1.723'] (k=0.671)
    Product 1: ['1.000', '1.449', '2.100'] (k=0.915)
    Product 2: ['1.000', '1.403', '1.969'] (k=0.836)
  MD:
    Product 0: ['1.000', '1.220', '1.488'] (k=0.490)
    Product 1: ['1.000', '1.152', '1.327'] (k=0.349)
    Product 2: ['1.000', '1.232', '1.517'] (k=0.514)
  LD:
    Product 0: ['1.000', '1.117', '1.249'] (k=0.274)
    Product 1: ['1.000', '1.005', '1.010'] (k=0.012)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
  Mixed:
    Product 0: ['1.000', '1.313', '1.723'] (k=0.671)
    Product 1: ['1.000', '1.152', '1.327'] (k=0.349)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0x143fdb2b
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.06s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -292002.6957
Found heuristic solution: objective -186301.5197

Root relaxation: objective 9.699355e+04, 4657 iterations, 0.16 seconds (0.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 96993.5537    0  494 -186301.52 96993.5537   152%     -    0s
H    0     0                    -175245.2582 96993.5537   155%     -    0s
H    0     0                    -175144.4055 96993.5537   155%     -    0s
     0     0 90285.4081    0  821 -175144.41 90285.4081   152%     -    0s
H    0     0                    -153236.7137 90282.1411   159%     -    0s
H    0     0                    -153159.7936 90282.1411   159%     -    0s
     0     0 90155.7969    0  827 -153159.79 90155.7969   159%     -    0s
     0     0 90151.0479    0  837 -153159.79 90151.0479   159%     -    0s
     0     0 90150.9262    0  839 -153159.79 90150.9262   159%     -    0s
     0     0 87474.0317    0  812 -153159.79 87474.0317   157%     -    1s
     0     0 87301.6082    0  839 -153159.79 87301.6082   157%     -    1s
     0     0 87280.9547    0  839 -153159.79 87280.9547   157%     -    1s
     0     0 87273.6207    0  835 -153159.79 87273.6207   157%     -    1s
     0     0 87273.3595    0  840 -153159.79 87273.3595   157%     -    1s
H    0     0                    -138216.6533 84249.3699   161%     -    2s
     0     0 84249.3699    0 1093 -138216.65 84249.3699   161%     -    2s
H    0     0                    -137086.2526 83924.6733   161%     -    2s
     0     0 83924.6733    0 1094 -137086.25 83924.6733   161%     -    2s
H    0     0                    -129040.8687 83854.2425   165%     -    3s
H    0     0                    -18346.72925 83854.2425   557%     -    3s
H    0     0                    23258.497459 83854.2425   261%     -    3s
     0     0 83854.2425    0 1188 23258.4975 83854.2425   261%     -    3s
     0     0 83835.0878    0 1113 23258.4975 83835.0878   260%     -    3s
     0     0 83832.3463    0 1199 23258.4975 83832.3463   260%     -    3s
H    0     0                    26306.189901 81246.3314   209%     -    4s
H    0     0                    28987.321772 81246.3314   180%     -    4s
H    0     0                    29162.024915 81246.3314   179%     -    4s
     0     0 81246.3314    0 1014 29162.0249 81246.3314   179%     -    4s
     0     0 80956.0815    0 1042 29162.0249 80956.0815   178%     -    4s
     0     0 80863.8502    0 1133 29162.0249 80863.8502   177%     -    5s
H    0     0                    29180.586791 80829.9454   177%     -    5s
H    0     0                    29252.016999 80829.9454   176%     -    5s
     0     0 80829.9454    0 1245 29252.0170 80829.9454   176%     -    5s
     0     0 80822.9104    0 1156 29252.0170 80822.9104   176%     -    5s
     0     0 80821.3951    0 1164 29252.0170 80821.3951   176%     -    5s
H    0     0                    30781.643786 79543.9821   158%     -    6s
     0     0 79543.9821    0 1132 30781.6438 79543.9821   158%     -    6s
H    0     0                    30877.015518 79221.1992   157%     -    6s
H    0     0                    31107.198459 79221.1992   155%     -    6s
H    0     0                    31315.211406 79221.1992   153%     -    6s
H    0     0                    32500.827550 79221.1992   144%     -    6s
H    0     0                    32649.696685 79221.1992   143%     -    6s
H    0     0                    32869.490664 79221.1992   141%     -    6s
H    0     0                    33006.784468 79221.1992   140%     -    6s
     0     0 79221.1992    0 1269 33006.7845 79221.1992   140%     -    6s
     0     0 79149.8453    0 1262 33006.7845 79149.8453   140%     -    7s
     0     0 79131.4467    0 1283 33006.7845 79131.4467   140%     -    7s
     0     0 79129.8491    0 1279 33006.7845 79129.8491   140%     -    7s
H    0     0                    33353.172343 79129.8491   137%     -    7s
H    0     0                    34460.664619 79129.8491   130%     -    7s
H    0     0                    34737.939047 79129.8491   128%     -    7s
H    0     0                    39781.790917 77163.4862  94.0%     -    8s
     0     0 77163.4862    0 1213 39781.7909 77163.4862  94.0%     -    8s
H    0     0                    40537.706705 76739.9664  89.3%     -    9s
H    0     0                    40732.943670 76739.9664  88.4%     -    9s
H    0     0                    40821.908997 76739.9664  88.0%     -    9s
H    0     0                    40855.234874 76739.9664  87.8%     -    9s
H    0     0                    40924.048699 76739.9664  87.5%     -    9s
     0     0 76739.9664    0 1272 40924.0487 76739.9664  87.5%     -    9s
     0     0 76619.9987    0 1281 40924.0487 76619.9987  87.2%     -    9s
     0     0 76606.6742    0 1276 40924.0487 76606.6742  87.2%     -    9s
     0     0 76598.5479    0 1278 40924.0487 76598.5479  87.2%     -    9s
H    0     0                    48839.206101 75151.5324  53.9%     -   11s
H    0     0                    48873.886022 75151.5324  53.8%     -   11s
H    0     0                    49181.102527 75151.5324  52.8%     -   11s
     0     0 75151.5324    0 1201 49181.1025 75151.5324  52.8%     -   11s
H    0     0                    50341.539854 74847.0716  48.7%     -   11s
H    0     0                    50353.039325 74847.0716  48.6%     -   11s
H    0     0                    50512.843448 74847.0716  48.2%     -   11s
H    0     0                    50705.413782 74847.0716  47.6%     -   11s
H    0     0                    50710.598389 74847.0716  47.6%     -   11s
H    0     0                    50785.549197 74847.0716  47.4%     -   11s
     0     0 74847.0716    0 1222 50785.5492 74847.0716  47.4%     -   11s
     0     0 74810.1720    0 1250 50785.5492 74810.1720  47.3%     -   12s
     0     0 74797.3849    0 1252 50785.5492 74797.3849  47.3%     -   12s
     0     0 73682.0968    0 1192 50785.5492 73682.0968  45.1%     -   13s
     0     0 73425.4891    0 1239 50785.5492 73425.4891  44.6%     -   14s
     0     0 73379.4767    0 1245 50785.5492 73379.4767  44.5%     -   14s
     0     0 73364.4133    0 1261 50785.5492 73364.4133  44.5%     -   15s
     0     0 72716.3760    0 1229 50785.5492 72716.3760  43.2%     -   16s
     0     0 72564.3173    0 1248 50785.5492 72564.3173  42.9%     -   17s
     0     0 72530.8358    0 1258 50785.5492 72530.8358  42.8%     -   17s
     0     0 72515.8604    0 1264 50785.5492 72515.8604  42.8%     -   17s
     0     0 71203.7166    0 1145 50785.5492 71203.7166  40.2%     -   19s
H    0     0                    50945.630630 70909.1288  39.2%     -   20s
     0     0 70909.1288    0 1189 50945.6306 70909.1288  39.2%     -   20s
H    0     0                    50955.475111 70833.7223  39.0%     -   20s
H    0     0                    51049.084588 70833.7223  38.8%     -   20s
     0     0 70833.7223    0 1207 51049.0846 70833.7223  38.8%     -   20s
     0     0 70812.2891    0 1229 51049.0846 70812.2891  38.7%     -   21s
     0     0 70005.3243    0 1207 51049.0846 70005.3243  37.1%     -   22s
     0     0 69857.5328    0 1226 51049.0846 69857.5328  36.8%     -   23s
     0     0 69817.1548    0 1228 51049.0846 69817.1548  36.8%     -   23s
     0     0 69802.9504    0 1235 51049.0846 69802.9504  36.7%     -   23s
     0     0 69209.4557    0 1204 51049.0846 69209.4557  35.6%     -   25s
     0     0 69099.9296    0 1190 51049.0846 69099.9296  35.4%     -   25s
     0     0 69063.6067    0 1261 51049.0846 69063.6067  35.3%     -   26s
     0     0 69049.7404    0 1261 51049.0846 69049.7404  35.3%     -   26s
     0     0 68520.7435    0 1221 51049.0846 68520.7435  34.2%     -   27s
     0     0 68435.5878    0 1239 51049.0846 68435.5878  34.1%     -   28s
     0     0 68411.6161    0 1251 51049.0846 68411.6161  34.0%     -   28s
     0     0 67960.9101    0 1173 51049.0846 67960.9101  33.1%     -   30s
     0     0 67853.9689    0 1186 51049.0846 67853.9689  32.9%     -   30s
     0     0 67822.2892    0 1195 51049.0846 67822.2892  32.9%     -   31s
     0     0 67427.3338    0 1182 51049.0846 67427.3338  32.1%     -   32s
     0     0 67339.5806    0 1182 51049.0846 67339.5806  31.9%     -   33s
     0     0 67319.9421    0 1219 51049.0846 67319.9421  31.9%     -   33s
     0     0 67096.2146    0 1027 51049.0846 67096.2146  31.4%     -   34s
     0     0 67034.4381    0 1163 51049.0846 67034.4381  31.3%     -   35s
     0     0 67022.9324    0 1167 51049.0846 67022.9324  31.3%     -   35s
     0     0 66812.5529    0 1171 51049.0846 66812.5529  30.9%     -   36s
     0     0 66812.2042    0 1171 51049.0846 66812.2042  30.9%     -   36s
     0     2 66812.2042    0 1171 51049.0846 66812.2042  30.9%     -   38s
     1     4 66529.9957    1  996 51049.0846 66810.4209  30.9%  2697   40s
    15    28 64068.7107    4  650 51049.0846 66120.0050  29.5%  2916   45s
   427   332 59904.0523   12  488 51049.0846 61194.6249  19.9%   937   50s
  1175  1021 57997.4387   20  351 51049.0846 60700.7263  18.9%   482   55s
  3438  2399 54288.9306   22  411 51049.0846 59864.1239  17.3%   320   60s
  4214  2683 55266.7953   17 1171 51049.0846 59683.7908  16.9%   297   76s
  4234  2696 51538.5278    8  301 51049.0846 57594.7781  12.8%   296   80s

Cutting planes:
  Gomory: 1
  MIR: 107
  Flow cover: 170
  RLT: 3
  Relax-and-lift: 21

Explored 4563 nodes (1423535 simplex iterations) in 82.67 seconds (167.36 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51049.1 50955.5 50945.6 ... 49181.1

Optimal solution found (tolerance 1.00e-04)
Best objective 5.104908458823e+04, best bound 5.104908458823e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 82.68s
  Master Objective (UB) = 51049.08, θ = 172696.71
  Upper Bound (UB) = 51049.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172696.71
  [DEBUG]   ✓ Scenario 0: θ = 172696.71 ≤ Q = 172696.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x63b24dc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x063b24dc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.510786e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7854959.1776
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.407813e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140781.26    0  124 7854959.18 -140781.26   102%     -    0s
H    0     0                    -105740.9937 -140781.26  33.1%     -    0s
H    0     0                    -106128.7969 -140781.26  32.7%     -    0s
H    0     0                    -108759.7419 -108759.74  0.00%     -    0s
     0     0          -    0      -108759.74 -108759.74  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 207

Explored 1 nodes (373 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -108760 -106129 -105741 ... 1.51079e+13
No other solutions better than -108760

Optimal solution found (tolerance 1.00e-04)
Best objective -1.087597418765e+05, best bound -1.087597418765e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 139329.29
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108759.74
  [DEBUG]   S×d_nominal = 248089.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 248089.03 + -108759.74 = 139329.29
  [DEBUG]   Current θ from Master = 172696.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33367.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17681.66
  Lower Bound (LB) = 17681.66
  Gap (UB-LB) = 33367.4201, Absolute Gap = 33367.4201, Relative Gap = 0.653634
  Not converged yet (gap = 33367.42 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0xf032ef46
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 17681.7 (0.01s)
MIP start from previous solve produced solution with objective 17681.7 (0.01s)
Loaded MIP start from previous solve with objective 17681.7

Presolve removed 13535 rows and 5494 columns
Presolve time: 0.30s
Presolved: 18428 rows, 9246 columns, 102088 nonzeros
Variable types: 6987 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.858541e+04, 9387 iterations, 0.98 seconds (2.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48585.4133    0  407 17681.6645 48585.4133   175%     -    1s
H    0     0                    19385.127170 48585.4133   151%     -    1s
H    0     0                    19743.483030 48585.4133   146%     -    1s
     0     0 40681.8255    0  543 19743.4830 40681.8255   106%     -    2s
H    0     0                    19761.291698 40681.0831   106%     -    3s
     0     0 40325.6802    0  533 19761.2917 40325.6802   104%     -    3s
     0     0 40321.0105    0  534 19761.2917 40321.0105   104%     -    3s
     0     0 40320.9716    0  534 19761.2917 40320.9716   104%     -    3s
     0     0 36179.3571    0  407 19761.2917 36179.3571  83.1%     -    5s
     0     0 35473.6591    0  430 19761.2917 35473.6591  79.5%     -    5s
     0     0 35352.8954    0  611 19761.2917 35352.8954  78.9%     -    6s
     0     0 35329.9573    0  455 19761.2917 35329.9573  78.8%     -    6s
     0     0 35328.2901    0  460 19761.2917 35328.2901  78.8%     -    6s
H    0     0                    19761.734099 33040.8871  67.2%     -    8s
H    0     0                    19788.900191 33040.8871  67.0%     -    8s
     0     0 33040.8871    0  392 19788.9002 33040.8871  67.0%     -    8s
     0     0 32516.7925    0  470 19788.9002 32516.7925  64.3%     -    9s
H    0     0                    21685.189402 32390.5119  49.4%     -    9s
H    0     0                    21704.302345 32390.5119  49.2%     -    9s
     0     0 32390.5119    0  474 21704.3023 32390.5119  49.2%     -    9s
     0     0 32335.4423    0  476 21704.3023 32335.4423  49.0%     -    9s
     0     0 32322.6646    0  473 21704.3023 32322.6646  48.9%     -    9s
     0     0 32318.1928    0  465 21704.3023 32318.1928  48.9%     -    9s
     0     0 32317.9947    0  471 21704.3023 32317.9947  48.9%     -    9s
H    0     0                    22846.240978 31141.5945  36.3%     -   11s
H    0     0                    22866.530938 31141.5945  36.2%     -   11s
H    0     0                    22915.123051 31141.5945  35.9%     -   11s
     0     0 31141.5945    0  411 22915.1231 31141.5945  35.9%     -   11s
H    0     0                    22954.452127 31141.4194  35.7%     -   12s
H    0     0                    23017.819878 30855.1832  34.0%     -   12s
     0     0 30855.1832    0  407 23017.8199 30855.1832  34.0%     -   12s
     0     0 30814.2091    0  405 23017.8199 30814.2091  33.9%     -   12s
     0     0 30806.7671    0  414 23017.8199 30806.7671  33.8%     -   12s
     0     0 30804.7830    0  414 23017.8199 30804.7830  33.8%     -   12s
     0     0 30505.8520    0  384 23017.8199 30505.8520  32.5%     -   13s
     0     0 30465.5213    0  307 23017.8199 30465.5213  32.4%     -   14s
     0     0 30455.5890    0  405 23017.8199 30455.5890  32.3%     -   14s
     0     0 30444.3523    0  388 23017.8199 30444.3523  32.3%     -   14s
     0     0 30440.0054    0  408 23017.8199 30440.0054  32.2%     -   14s
     0     0 30376.4100    0  298 23017.8199 30376.4100  32.0%     -   15s
     0     0 30355.7605    0  517 23017.8199 30355.7605  31.9%     -   17s
     0     0 30346.6294    0  307 23017.8199 30346.6294  31.8%     -   17s
     0     0 30346.6294    0  307 23017.8199 30346.6294  31.8%     -   17s
     0     0 30344.2754    0  316 23017.8199 30344.2754  31.8%     -   17s
     0     0 30299.2369    0  514 23017.8199 30299.2369  31.6%     -   18s
     0     0 30287.0346    0  524 23017.8199 30287.0346  31.6%     -   18s
     0     0 30281.6659    0  378 23017.8199 30281.6659  31.6%     -   18s
     0     0 30278.3025    0  376 23017.8199 30278.3025  31.5%     -   19s
     0     0 30263.6649    0  379 23017.8199 30263.6649  31.5%     -   19s
     0     0 30262.8407    0  319 23017.8199 30262.8407  31.5%     -   19s
     0     0 30242.8712    0  308 23017.8199 30242.8712  31.4%     -   20s
     0     0 30231.7090    0  316 23017.8199 30231.7090  31.3%     -   20s
     0     0 30228.4511    0  314 23017.8199 30228.4511  31.3%     -   20s
     0     0 30217.6232    0  311 23017.8199 30217.6232  31.3%     -   20s
     0     0 30214.3553    0  306 23017.8199 30214.3553  31.3%     -   20s
     0     0 30206.8086    0  461 23017.8199 30206.8086  31.2%     -   21s
     0     0 30204.2231    0  461 23017.8199 30204.2231  31.2%     -   21s
H    0     0                    23673.979943 30204.2231  27.6%     -   24s
     0     2 30204.2231    0  461 23673.9799 30204.2231  27.6%     -   24s
     1     4 30093.7134    1  305 23673.9799 30202.6483  27.6%   492   25s
H   35    64                    23769.428599 29068.0906  22.3%  1365   28s
    95   128 25893.4544    7  516 23769.4286 28915.5741  21.7%   966   30s
   397   258     cutoff   11      23769.4286 28369.2965  19.4%   568   35s
   895   345     cutoff   10      23769.4286 27919.5826  17.5%   480   40s
  1262   338 26458.9670    9  450 23769.4286 27371.2905  15.2%   449   45s
  1663   323 24778.9864   13  351 23769.4286 27079.7425  13.9%   421   50s
  2751     6     cutoff    9      23769.4286 24511.9092  3.12%   373   55s

Cutting planes:
  Learned: 1
  Gomory: 9
  Implied bound: 11
  MIR: 1054
  Flow cover: 654
  RLT: 49
  Relax-and-lift: 244

Explored 2799 nodes (1074733 simplex iterations) in 56.42 seconds (142.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23769.4 23674 23017.8 ... 19788.9

Optimal solution found (tolerance 1.00e-04)
Best objective 2.376942859935e+04, best bound 2.376942859935e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 56.43s
  Master Objective (UB) = 23769.43, θ = 143879.25
  Upper Bound (UB) = 23769.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 143879.25
  [DEBUG]   ✓ Scenario 0: θ = 143879.25 ≤ Q = 143879.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 143879.25 ≤ Q = 143879.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x21b8e26f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde471d91
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.433789e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7399261.4656
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.454741e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145474.12    0  132 7399261.47 -145474.12   102%     -    0s
H    0     0                    -108370.4706 -145474.12  34.2%     -    0s
H    0     0                    -114872.6456 -145474.12  26.6%     -    0s
H    0     0                    -127038.1721 -145474.12  14.5%     -    0s
     0     0 -132803.21    0   90 -127038.17 -132803.21  4.54%     -    0s
H    0     0                    -130483.0489 -132722.47  1.72%     -    0s
H    0     0                    -130815.8763 -132722.47  1.46%     -    0s
H    0     0                    -131102.2936 -132418.56  1.00%     -    0s
     0     0 -132418.56    0   87 -131102.29 -132418.56  1.00%     -    0s
     0     0 -132409.19    0   87 -131102.29 -132409.19  1.00%     -    0s
     0     0 -131841.06    0   56 -131102.29 -131841.06  0.56%     -    0s
H    0     0                    -131170.5971 -131795.11  0.48%     -    0s
     0     0 -131627.37    0   55 -131170.60 -131627.37  0.35%     -    0s
     0     0 -131619.71    0   52 -131170.60 -131619.71  0.34%     -    0s
     0     0 -131602.49    0   27 -131170.60 -131602.49  0.33%     -    0s
     0     0 -131347.97    0   23 -131170.60 -131347.97  0.14%     -    0s
     0     0 -131344.92    0   22 -131170.60 -131344.92  0.13%     -    0s
H    0     0                    -131173.3511 -131334.00  0.12%     -    0s
     0     0 -131316.92    0   22 -131173.35 -131316.92  0.11%     -    0s
     0     0 -131315.41    0   21 -131173.35 -131315.41  0.11%     -    0s
     0     0 -131243.91    0   13 -131173.35 -131243.91  0.05%     -    0s
     0     0 -131243.91    0   11 -131173.35 -131243.91  0.05%     -    0s
H    0     0                    -131186.9554 -131243.91  0.04%     -    0s
     0     0 -131232.86    0    6 -131186.96 -131232.86  0.03%     -    0s
H    0     0                    -131204.2832 -131225.84  0.02%     -    0s
H    0     0                    -131208.5510 -131225.64  0.01%     -    0s
     0     0 -131225.64    0    5 -131208.55 -131225.64  0.01%     -    0s
H    0     0                    -131210.2712 -131225.64  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 6
  Flow cover: 8
  Relax-and-lift: 2

Explored 1 nodes (806 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -131210 -131209 -131204 ... -114873

Optimal solution found (tolerance 1.00e-04)
Best objective -1.312102712000e+05, best bound -1.312125176480e+05, gap 0.0017%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 121290.76
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131210.27
  [DEBUG]   S×d_nominal = 252501.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252501.03 + -131210.27 = 121290.76
  [DEBUG]   Current θ from Master = 143879.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22588.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1180.94
  Lower Bound (LB) = 17681.66
  Gap (UB-LB) = 6087.7641, Absolute Gap = 6087.7641, Relative Gap = 0.256117
  Not converged yet (gap = 6087.76 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0x8bb7429b
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 1180.94 (0.02s)
Loaded MIP start from previous solve with objective 1180.94

Presolve removed 20301 rows and 8241 columns
Presolve time: 0.41s
Presolved: 26952 rows, 12739 columns, 165764 nonzeros
Variable types: 10480 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.964696e+04, 18543 iterations, 4.06 seconds (8.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39646.9582    0   95 1180.94263 39646.9582  3257%     -    4s
H    0     0                    23425.201128 39646.9582  69.2%     -    4s
H    0     0                    23532.651545 39646.9582  68.5%     -    4s
H    0     0                    23575.818325 39646.9582  68.2%     -    4s
     0     0 36159.2189    0  207 23575.8183 36159.2189  53.4%     -    6s
     0     0 36155.1755    0  208 23575.8183 36155.1755  53.4%     -    6s
     0     0 36155.1755    0  209 23575.8183 36155.1755  53.4%     -    6s
     0     0 36155.1755    0  209 23575.8183 36155.1755  53.4%     -    6s
     0     0 33237.3980    0  295 23575.8183 33237.3980  41.0%     -    8s
     0     0 32731.9064    0  276 23575.8183 32731.9064  38.8%     -    9s
     0     0 32577.2228    0  284 23575.8183 32577.2228  38.2%     -    9s
     0     0 32573.6006    0  280 23575.8183 32573.6006  38.2%     -    9s
     0     0 32571.1066    0  285 23575.8183 32571.1066  38.2%     -    9s
     0     0 32569.7275    0  285 23575.8183 32569.7275  38.1%     -    9s
     0     0 32569.6363    0  287 23575.8183 32569.6363  38.1%     -    9s
     0     0 31062.1639    0  246 23575.8183 31062.1639  31.8%     -   12s
     0     0 30729.7029    0  257 23575.8183 30729.7029  30.3%     -   12s
     0     0 30547.0382    0  256 23575.8183 30547.0382  29.6%     -   13s
     0     0 30522.8809    0  257 23575.8183 30522.8809  29.5%     -   13s
     0     0 30516.5434    0  255 23575.8183 30516.5434  29.4%     -   13s
     0     0 30515.7559    0  258 23575.8183 30515.7559  29.4%     -   13s
     0     0 29916.3898    0  288 23575.8183 29916.3898  26.9%     -   15s
     0     0 29669.8654    0  348 23575.8183 29669.8654  25.8%     -   16s
     0     0 29536.3105    0  282 23575.8183 29536.3105  25.3%     -   16s
     0     0 29482.5022    0  273 23575.8183 29482.5022  25.1%     -   16s
     0     0 29461.4296    0  280 23575.8183 29461.4296  25.0%     -   16s
     0     0 29459.9321    0  277 23575.8183 29459.9321  25.0%     -   16s
     0     0 29459.1675    0  279 23575.8183 29459.1675  25.0%     -   16s
     0     0 29358.6183    0  280 23575.8183 29358.6183  24.5%     -   17s
     0     0 29328.3253    0  285 23575.8183 29328.3253  24.4%     -   17s
     0     0 29319.3513    0  289 23575.8183 29319.3513  24.4%     -   17s
     0     0 29315.3755    0  286 23575.8183 29315.3755  24.3%     -   18s
     0     0 29313.3397    0  287 23575.8183 29313.3397  24.3%     -   18s
     0     0 29313.2057    0  287 23575.8183 29313.2057  24.3%     -   18s
     0     0 29281.7878    0  281 23575.8183 29281.7878  24.2%     -   18s
     0     0 29269.7702    0  283 23575.8183 29269.7702  24.2%     -   19s
     0     0 29266.9762    0  277 23575.8183 29266.9762  24.1%     -   19s
     0     0 29264.5589    0  293 23575.8183 29264.5589  24.1%     -   19s
     0     0 29264.3351    0  286 23575.8183 29264.3351  24.1%     -   19s
     0     0 29258.8478    0  281 23575.8183 29258.8478  24.1%     -   20s
     0     0 29251.6920    0  279 23575.8183 29251.6920  24.1%     -   20s
     0     0 29251.6920    0  273 23575.8183 29251.6920  24.1%     -   20s
     0     0 29251.6920    0  276 23575.8183 29251.6920  24.1%     -   20s
     0     0 29244.8989    0  278 23575.8183 29244.8989  24.0%     -   21s
     0     0 29244.6730    0  273 23575.8183 29244.6730  24.0%     -   21s
     0     0 29233.8785    0  278 23575.8183 29233.8785  24.0%     -   21s
     0     0 29233.8006    0  278 23575.8183 29233.8006  24.0%     -   21s
     0     2 29233.7916    0  278 23575.8183 29233.7916  24.0%     -   24s
     3     8 29166.8827    2  288 23575.8183 29182.2908  23.8%   599   25s
    31    60 28203.1920    5  304 23575.8183 28851.6874  22.4%  1797   30s
   217   231 27242.5554   10  301 23575.8183 28119.0195  19.3%  1088   35s
   415   339 25901.9559   13  271 23575.8183 28020.9382  18.9%   890   41s
   674   422 25184.0703   16  321 23575.8183 28020.9382  18.9%   816   46s
   872   449     cutoff   18      23575.8183 27661.8178  17.3%   818   51s
  1107   449 26103.1911   14  198 23575.8183 27208.9139  15.4%   810   56s
  1373   485 23951.4246   16  144 23575.8183 27208.9139  15.4%   784   61s
  1613   481     cutoff   11      23575.8183 26709.2261  13.3%   755   65s
  1984   411     cutoff   14      23575.8183 26357.9723  11.8%   745   70s
  2434   260 23747.3255   15  143 23575.8183 25627.8677  8.70%   720   75s

Cutting planes:
  Learned: 1
  Implied bound: 39
  MIR: 347
  Flow cover: 367
  RLT: 23
  Relax-and-lift: 18

Explored 3071 nodes (2053308 simplex iterations) in 78.89 seconds (240.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 4: 23575.8 23532.7 23425.2 1180.94 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.357581832487e+04, best bound 2.357581832487e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 78.91s
  Master Objective (UB) = 23575.82, θ = 143833.77
  Upper Bound (UB) = 23575.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 143833.77
  [DEBUG]   ✓ Scenario 0: θ = 143833.77 ≤ Q = 143833.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 143833.77 ≤ Q = 143833.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 143833.77 ≤ Q = 143833.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2ae2bda4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd51d425c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.433000e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7386140.8221
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.406488e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140648.78    0  123 7386140.82 -140648.78   102%     -    0s
H    0     0                    -105640.4180 -140648.78  33.1%     -    0s
H    0     0                    -106613.8415 -124389.76  16.7%     -    0s
     0     0 -124389.76    0   85 -106613.84 -124389.76  16.7%     -    0s
H    0     0                    -121867.2043 -124282.69  1.98%     -    0s
     0     0 -123563.00    0   71 -121867.20 -123563.00  1.39%     -    0s
H    0     0                    -122528.4241 -123503.52  0.80%     -    0s
H    0     0                    -122566.6794 -123470.01  0.74%     -    0s
     0     0 -123470.01    0   63 -122566.68 -123470.01  0.74%     -    0s
     0     0 -123454.89    0   64 -122566.68 -123454.89  0.72%     -    0s
     0     0 -123014.58    0   34 -122566.68 -123014.58  0.37%     -    0s
     0     0 -122943.08    0   40 -122566.68 -122943.08  0.31%     -    0s
     0     0 -122942.94    0   39 -122566.68 -122942.94  0.31%     -    0s
     0     0 -122904.59    0   37 -122566.68 -122904.59  0.28%     -    0s
     0     0 -122900.99    0   38 -122566.68 -122900.99  0.27%     -    0s
     0     0 -122739.82    0   14 -122566.68 -122739.82  0.14%     -    0s
     0     0 -122738.03    0   11 -122566.68 -122738.03  0.14%     -    0s
     0     0 -122700.14    0   10 -122566.68 -122700.14  0.11%     -    0s
     0     0 -122696.27    0   10 -122566.68 -122696.27  0.11%     -    0s
     0     0 -122687.73    0    6 -122566.68 -122687.73  0.10%     -    0s
     0     0 -122687.73    0   12 -122566.68 -122687.73  0.10%     -    0s
H    0     0                    -122591.7738 -122687.73  0.08%     -    0s
*    0     0               0    -122673.5962 -122673.60  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 7
  Flow cover: 7

Explored 1 nodes (906 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -122674 -122592 -122567 ... 1.433e+13
No other solutions better than -122674

Optimal solution found (tolerance 1.00e-04)
Best objective -1.226735962071e+05, best bound -1.226735962071e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 129827.44
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122673.60
  [DEBUG]   S×d_nominal = 252501.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252501.03 + -122673.60 = 129827.44
  [DEBUG]   Current θ from Master = 143833.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14006.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9569.49
  Lower Bound (LB) = 17681.66
  Gap (UB-LB) = 5894.1539, Absolute Gap = 5894.1539, Relative Gap = 0.250008
  Not converged yet (gap = 5894.15 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0x48f4b119
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 9569.49 (0.05s)
MIP start from previous solve produced solution with objective 9569.49 (0.06s)
Loaded MIP start from previous solve with objective 9569.49

Presolve removed 27068 rows and 10988 columns
Presolve time: 0.55s
Presolved: 35475 rows, 16232 columns, 219179 nonzeros
Variable types: 13973 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35475 rows, 16232 columns, 219179 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52978    2.2782983e+04   0.000000e+00   9.432104e+05      5s
Concurrent spin time: 0.50s

Solved with dual simplex

Root relaxation: objective 3.940013e+04, 26745 iterations, 5.93 seconds (12.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39400.1268    0  207 9569.48733 39400.1268   312%     -    6s
H    0     0                    23106.707137 39400.1268  70.5%     -    6s
H    0     0                    23532.651545 39400.1268  67.4%     -    6s
     0     0 34009.5673    0  270 23532.6515 34009.5673  44.5%     -   11s
     0     0 33972.6667    0  268 23532.6515 33972.6667  44.4%     -   11s
     0     0 33972.6667    0  270 23532.6515 33972.6667  44.4%     -   12s
     0     0 33972.6667    0  269 23532.6515 33972.6667  44.4%     -   12s
     0     0 33972.6667    0  275 23532.6515 33972.6667  44.4%     -   13s
     0     0 33972.6667    0  275 23532.6515 33972.6667  44.4%     -   13s
     0     0 32506.2064    0  263 23532.6515 32506.2064  38.1%     -   15s
     0     0 32277.8345    0  245 23532.6515 32277.8345  37.2%     -   16s
     0     0 32161.3661    0  257 23532.6515 32161.3661  36.7%     -   16s
     0     0 32116.2673    0  246 23532.6515 32116.2673  36.5%     -   17s
     0     0 32115.2602    0  247 23532.6515 32115.2602  36.5%     -   17s
     0     0 32094.9769    0  251 23532.6515 32094.9769  36.4%     -   17s
     0     0 32090.0851    0  249 23532.6515 32090.0851  36.4%     -   17s
     0     0 32086.9100    0  248 23532.6515 32086.9100  36.4%     -   17s
     0     0 32085.8133    0  250 23532.6515 32085.8133  36.3%     -   17s
     0     0 32085.3803    0  254 23532.6515 32085.3803  36.3%     -   17s
     0     0 30645.3950    0  313 23532.6515 30645.3950  30.2%     -   23s
     0     0 30323.8576    0  264 23532.6515 30323.8576  28.9%     -   25s
     0     0 30231.8937    0  272 23532.6515 30231.8937  28.5%     -   25s
     0     0 30207.4692    0  315 23532.6515 30207.4692  28.4%     -   26s
     0     0 30193.7206    0  317 23532.6515 30193.7206  28.3%     -   26s
     0     0 30168.6148    0  260 23532.6515 30168.6148  28.2%     -   26s
     0     0 30162.8263    0  266 23532.6515 30162.8263  28.2%     -   27s
     0     0 30159.2415    0  264 23532.6515 30159.2415  28.2%     -   27s
     0     0 30159.0736    0  264 23532.6515 30159.0736  28.2%     -   27s
     0     0 29612.4446    0  327 23532.6515 29612.4446  25.8%     -   30s
     0     0 29537.6851    0  325 23532.6515 29537.6851  25.5%     -   31s
     0     0 29509.6802    0  329 23532.6515 29509.6802  25.4%     -   31s
     0     0 29493.4865    0  283 23532.6515 29493.4865  25.3%     -   32s
     0     0 29484.7255    0  294 23532.6515 29484.7255  25.3%     -   32s
     0     0 29483.4743    0  293 23532.6515 29483.4743  25.3%     -   32s
     0     0 29483.1630    0  289 23532.6515 29483.1630  25.3%     -   32s
     0     0 29405.1413    0  267 23532.6515 29405.1413  25.0%     -   33s
     0     0 29386.3900    0  338 23532.6515 29386.3900  24.9%     -   34s
     0     0 29380.5512    0  289 23532.6515 29380.5512  24.9%     -   34s
     0     0 29376.8841    0  280 23532.6515 29376.8841  24.8%     -   34s
     0     0 29376.0092    0  280 23532.6515 29376.0092  24.8%     -   34s
     0     0 29364.9609    0  268 23532.6515 29364.9609  24.8%     -   35s
     0     0 29357.9570    0  269 23532.6515 29357.9570  24.8%     -   36s
     0     0 29355.9962    0  273 23532.6515 29355.9962  24.7%     -   36s
     0     0 29355.8976    0  275 23532.6515 29355.8976  24.7%     -   36s
     0     0 29322.9959    0  271 23532.6515 29322.9959  24.6%     -   37s
     0     0 29321.0449    0  280 23532.6515 29321.0449  24.6%     -   37s
     0     0 29320.7954    0  279 23532.6515 29320.7954  24.6%     -   37s
     0     0 29294.7754    0  277 23532.6515 29294.7754  24.5%     -   38s
     0     0 29287.3814    0  318 23532.6515 29287.3814  24.5%     -   40s
     0     0 29282.8953    0  332 23532.6515 29282.8953  24.4%     -   40s
     0     0 29277.0370    0  284 23532.6515 29277.0370  24.4%     -   41s
     0     0 29276.9521    0  287 23532.6515 29276.9521  24.4%     -   41s
     0     0 29272.4789    0  283 23532.6515 29272.4789  24.4%     -   41s
     0     0 29268.8931    0  344 23532.6515 29268.8931  24.4%     -   41s
     0     0 29268.6809    0  340 23532.6515 29268.6809  24.4%     -   42s
     0     0 29164.7641    0  338 23532.6515 29164.7641  23.9%     -   43s
     0     0 29130.1144    0  342 23532.6515 29130.1144  23.8%     -   43s
     0     0 29123.1596    0  339 23532.6515 29123.1596  23.8%     -   44s
     0     0 29122.6421    0  337 23532.6515 29122.6421  23.8%     -   44s
     0     0 29087.8236    0  343 23532.6515 29087.8236  23.6%     -   45s
     0     0 29077.0808    0  337 23532.6515 29077.0808  23.6%     -   45s
     0     0 29074.3971    0  344 23532.6515 29074.3971  23.5%     -   45s
     0     0 29068.9592    0  339 23532.6515 29068.9592  23.5%     -   46s
     0     0 29068.0496    0  341 23532.6515 29068.0496  23.5%     -   46s
     0     0 29053.7125    0  337 23532.6515 29053.7125  23.5%     -   46s
     0     0 29049.0686    0  292 23532.6515 29049.0686  23.4%     -   47s
     0     0 29048.5739    0  347 23532.6515 29048.5739  23.4%     -   47s
     0     0 29041.9646    0  335 23532.6515 29041.9646  23.4%     -   48s
     0     0 29038.7283    0  334 23532.6515 29038.7283  23.4%     -   48s
     0     0 29037.7378    0  334 23532.6515 29037.7378  23.4%     -   49s
     0     0 29036.5486    0  330 23532.6515 29036.5486  23.4%     -   49s
     0     0 29035.6216    0  329 23532.6515 29035.6216  23.4%     -   49s
     0     0 29034.6260    0  332 23532.6515 29034.6260  23.4%     -   50s
     0     0 29034.4094    0  332 23532.6515 29034.4094  23.4%     -   51s
     0     2 29034.0078    0  332 23532.6515 29034.0078  23.4%     -   53s
     3     8 28851.1094    2  339 23532.6515 29019.7502  23.3%  1447   57s
    15    32 28360.6940    4  374 23532.6515 28627.7524  21.7%  4570   61s
    63    92 27898.6442    6  333 23532.6515 28237.0061  20.0%  3124   66s
    95   166 27805.1311    7  338 23532.6515 28095.9972  19.4%  2461   70s
   257   243 26124.2391    9  454 23532.6515 28095.9972  19.4%  1771   77s
   321   265 27024.0491   10  279 23532.6515 28095.9972  19.4%  1845   80s
   421   319 25871.3862   12  265 23532.6515 27803.7563  18.1%  2117   86s
   526   396 25787.8381   13  264 23532.6515 27770.9666  18.0%  2236   92s
   661   459 25360.5802   17  258 23532.6515 27565.0450  17.1%  2073   96s
   791   506 25291.2375   18  254 23532.6515 27404.4012  16.5%  1943  101s
   944   567 24736.4808   19  255 23532.6515 27404.4012  16.5%  1809  107s
  1036   578 24133.2285   20  252 23532.6515 27404.4012  16.5%  1735  110s
  1168   632 24262.3985   21  250 23532.6515 27170.4776  15.5%  1652  117s
  1221   646     cutoff   22      23532.6515 27170.4776  15.5%  1631  121s
  1317   647 25886.5399   11  241 23532.6515 27170.4776  15.5%  1585  125s
  1565   729 25204.9721   15  178 23532.6515 26749.6493  13.7%  1508  132s
  1659   743 24540.9468   17  244 23532.6515 26749.6493  13.7%  1479  136s
  1897   755     cutoff   18      23532.6515 26479.2486  12.5%  1422  143s
  2027   774     cutoff   22      23532.6515 26479.2486  12.5%  1401  145s
  2193   799     cutoff    8      23532.6515 26264.9621  11.6%  1377  153s
  2338   794     cutoff    8      23532.6515 26263.9810  11.6%  1348  157s
  2513   836 24690.2259   19  240 23532.6515 26263.9810  11.6%  1314  162s
  2682   849     cutoff   21      23532.6515 26138.1004  11.1%  1291  166s
  2847   870 23891.0661   18  100 23532.6515 25902.5469  10.1%  1280  170s
  3028   859 24007.9029   13  277 23532.6515 25845.8515  9.83%  1266  175s
  3410   857 23783.4545   11  101 23532.6515 25707.1910  9.24%  1238  185s
  3648   832 24050.7108   14  324 23532.6515 25707.1910  9.24%  1215  190s
  4137   774 23703.1185   18  237 23532.6515 25418.6714  8.01%  1177  201s
  4340   756 24351.9583   16  133 23532.6515 25217.6329  7.16%  1177  207s
  4588   698     cutoff   16      23532.6515 25129.1523  6.78%  1167  213s
  4840   614     cutoff   12      23532.6515 25008.1971  6.27%  1155  219s
  5125   521 24215.3577   13  246 23532.6515 24825.6410  5.49%  1142  224s
  5459   353 24032.6931   20  158 23532.6515 24803.2694  5.40%  1123  229s
  5811   262 23587.1103   18  235 23532.6515 24604.3851  4.55%  1103  233s
  5952   138     cutoff   19      23532.6515 24474.0571  4.00%  1092  237s
  6143    52     cutoff   18      23532.6515 24465.6327  3.96%  1073  241s
  6259    10 infeasible   19      23532.6515 24260.7048  3.09%  1062  245s

Cutting planes:
  Implied bound: 16
  MIR: 392
  Flow cover: 478
  RLT: 19
  Relax-and-lift: 11

Explored 6325 nodes (6770801 simplex iterations) in 248.78 seconds (765.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 3: 23532.7 23106.7 9569.49 

Optimal solution found (tolerance 1.00e-04)
Best objective 2.353265154549e+04, best bound 2.353265154549e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 248.79s
  Master Objective (UB) = 23532.65, θ = 143133.58
  Upper Bound (UB) = 23532.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 143133.58
  [DEBUG]   ✓ Scenario 0: θ = 143133.58 ≤ Q = 143133.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 143133.58 ≤ Q = 143133.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 143133.58 ≤ Q = 143133.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 143133.58 ≤ Q = 143133.58 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x40d9133a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x40d9133a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.436613e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7402076.9405
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.413497e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141349.67    0  124 7402076.94 -141349.67   102%     -    0s
H    0     0                    -106320.4052 -141349.67  32.9%     -    0s
H    0     0                    -107994.5376 -127243.29  17.8%     -    0s
H    0     0                    -117501.8566 -127243.29  8.29%     -    0s
     0     0 -127243.29    0   85 -117501.86 -127243.29  8.29%     -    0s
H    0     0                    -124573.2201 -127189.55  2.10%     -    0s
H    0     0                    -125041.0373 -127189.55  1.72%     -    0s
     0     0 -126642.08    0   72 -125041.04 -126642.08  1.28%     -    0s
     0     0 -126586.37    0   65 -125041.04 -126586.37  1.24%     -    0s
     0     0 -126443.84    0   70 -125041.04 -126443.84  1.12%     -    0s
     0     0 -125776.70    0   47 -125041.04 -125776.70  0.59%     -    0s
     0     0 -125692.01    0   37 -125041.04 -125692.01  0.52%     -    0s
     0     0 -125633.77    0   40 -125041.04 -125633.77  0.47%     -    0s
     0     0 -125626.17    0   42 -125041.04 -125626.17  0.47%     -    0s
     0     0 -125363.78    0   21 -125041.04 -125363.78  0.26%     -    0s
     0     0 -125347.87    0   22 -125041.04 -125347.87  0.25%     -    0s
     0     0 -125237.10    0   15 -125041.04 -125237.10  0.16%     -    0s
     0     0 -125223.04    0   15 -125041.04 -125223.04  0.15%     -    0s
     0     0 -125166.37    0    8 -125041.04 -125166.37  0.10%     -    0s
     0     0 -125166.37    0   14 -125041.04 -125166.37  0.10%     -    0s
H    0     0                    -125075.5431 -125166.37  0.07%     -    0s
*    0     0               0    -125097.6893 -125097.69  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 2
  MIR: 3
  Flow cover: 9
  Relax-and-lift: 3

Explored 1 nodes (891 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -125098 -125076 -125041 ... 1.43661e+13
No other solutions better than -125098

Optimal solution found (tolerance 1.00e-04)
Best objective -1.250976892937e+05, best bound -1.250976892937e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 127403.34
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125097.69
  [DEBUG]   S×d_nominal = 252501.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252501.03 + -125097.69 = 127403.34
  [DEBUG]   Current θ from Master = 143133.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15730.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7802.41
  Lower Bound (LB) = 17681.66
  Gap (UB-LB) = 5850.9871, Absolute Gap = 5850.9871, Relative Gap = 0.248633
  Not converged yet (gap = 5850.99 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0xb6bd6545
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33835 rows and 13735 columns
Presolve time: 0.69s
Presolved: 43998 rows, 19725 columns, 272594 nonzeros
Variable types: 17466 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -192516.0046

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43998 rows, 19725 columns, 272594 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25217    1.6725999e+04   0.000000e+00   6.009534e+06      5s
Concurrent spin time: 0.23s

Solved with dual simplex

Root relaxation: objective 3.921426e+04, 20974 iterations, 6.63 seconds (13.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39214.2587    0  200 -192516.00 39214.2587   120%     -    7s
H    0     0                    -181718.4560 39214.2587   122%     -    7s
H    0     0                    -145933.1720 39214.2587   127%     -    7s
H    0     0                    -145911.9408 39214.2587   127%     -    7s
H    0     0                    -145830.4644 39214.2587   127%     -    7s
H    0     0                    -145810.3971 39214.2587   127%     -    7s
H    0     0                    -35864.05326 39214.2587   209%     -    7s
H    0     0                    17612.866383 39214.2587   123%     -    7s
H    0     0                    17655.607385 39214.2587   122%     -    8s
H    0     0                    19946.438305 39214.2587  96.6%     -    8s
H    0     0                    19975.348947 34253.7834  71.5%     -   13s
     0     0 34253.7834    0  280 19975.3489 34253.7834  71.5%     -   13s
     0     0 33966.3552    0  275 19975.3489 33966.3552  70.0%     -   15s
     0     0 33966.3552    0  271 19975.3489 33966.3552  70.0%     -   16s
     0     0 33966.3552    0  269 19975.3489 33966.3552  70.0%     -   16s
     0     0 33966.3552    0  267 19975.3489 33966.3552  70.0%     -   16s
     0     0 33966.2568    0  271 19975.3489 33966.2568  70.0%     -   16s
H    0     0                    19985.834030 32085.0140  60.5%     -   20s
     0     0 32085.0140    0  229 19985.8340 32085.0140  60.5%     -   20s
H    0     0                    22962.129628 32084.2458  39.7%     -   20s
H    0     0                    22966.627670 32084.2458  39.7%     -   20s
     0     0 31800.5546    0  242 22966.6277 31800.5546  38.5%     -   22s
     0     0 31741.0022    0  245 22966.6277 31741.0022  38.2%     -   22s
     0     0 31730.9004    0  243 22966.6277 31730.9004  38.2%     -   23s
     0     0 31729.9476    0  247 22966.6277 31729.9476  38.2%     -   23s
     0     0 31729.9476    0  247 22966.6277 31729.9476  38.2%     -   23s
H    0     0                    23096.029399 30887.5546  33.7%     -   28s
     0     0 30887.5546    0  268 23096.0294 30887.5546  33.7%     -   28s
     0     0 30618.0272    0  269 23096.0294 30618.0272  32.6%     -   29s
H    0     0                    23097.920692 30406.1108  31.6%     -   31s
     0     0 30406.1108    0  277 23097.9207 30406.1108  31.6%     -   31s
     0     0 30372.7110    0  276 23097.9207 30372.7110  31.5%     -   31s
     0     0 30346.9301    0  273 23097.9207 30346.9301  31.4%     -   32s
     0     0 30299.0374    0  271 23097.9207 30299.0374  31.2%     -   33s
     0     0 30160.5405    0  333 23097.9207 30160.5405  30.6%     -   34s
     0     0 30134.1085    0  274 23097.9207 30134.1085  30.5%     -   34s
     0     0 30129.1826    0  272 23097.9207 30129.1826  30.4%     -   35s
     0     0 30126.9256    0  328 23097.9207 30126.9256  30.4%     -   35s
     0     0 30126.2794    0  328 23097.9207 30126.2794  30.4%     -   35s
     0     0 29739.2635    0  278 23097.9207 29739.2635  28.8%     -   40s
     0     0 29618.7446    0  287 23097.9207 29618.7446  28.2%     -   41s
     0     0 29543.1058    0  271 23097.9207 29543.1058  27.9%     -   42s
     0     0 29526.1560    0  270 23097.9207 29526.1560  27.8%     -   43s
     0     0 29501.4918    0  266 23097.9207 29501.4918  27.7%     -   43s
H    0     0                    23111.452833 29485.1213  27.6%     -   43s
H    0     0                    23147.536172 29485.1213  27.4%     -   43s
     0     0 29485.1213    0  269 23147.5362 29485.1213  27.4%     -   43s
     0     0 29477.0554    0  267 23147.5362 29477.0554  27.3%     -   44s
     0     0 29476.1692    0  269 23147.5362 29476.1692  27.3%     -   44s
     0     0 29361.1846    0  258 23147.5362 29361.1846  26.8%     -   45s
     0     0 29310.4946    0  257 23147.5362 29310.4946  26.6%     -   46s
     0     0 29298.2961    0  258 23147.5362 29298.2961  26.6%     -   46s
     0     0 29295.2419    0  257 23147.5362 29295.2419  26.6%     -   47s
     0     0 29288.9993    0  264 23147.5362 29288.9993  26.5%     -   47s
     0     0 29288.4050    0  268 23147.5362 29288.4050  26.5%     -   47s
     0     0 29241.2850    0  269 23147.5362 29241.2850  26.3%     -   48s
     0     0 29230.8588    0  270 23147.5362 29230.8588  26.3%     -   49s
     0     0 29226.4405    0  255 23147.5362 29226.4405  26.3%     -   49s
     0     0 29226.1101    0  257 23147.5362 29226.1101  26.3%     -   49s
     0     0 29220.4628    0  253 23147.5362 29220.4628  26.2%     -   50s
     0     0 29214.5308    0  257 23147.5362 29214.5308  26.2%     -   51s
     0     0 29212.9081    0  315 23147.5362 29212.9081  26.2%     -   51s
     0     0 29212.1817    0  311 23147.5362 29212.1817  26.2%     -   52s
     0     0 29188.9606    0  247 23147.5362 29188.9606  26.1%     -   53s
     0     0 29172.2473    0  267 23147.5362 29172.2473  26.0%     -   54s
     0     0 29153.5345    0  264 23147.5362 29153.5345  25.9%     -   55s
     0     0 29145.4780    0  310 23147.5362 29145.4780  25.9%     -   55s
     0     0 29134.4756    0  272 23147.5362 29134.4756  25.9%     -   56s
     0     0 29131.9951    0  320 23147.5362 29131.9951  25.9%     -   56s
     0     0 29131.0655    0  323 23147.5362 29131.0655  25.8%     -   56s
     0     0 29117.9211    0  322 23147.5362 29117.9211  25.8%     -   57s
     0     0 29112.1906    0  328 23147.5362 29112.1906  25.8%     -   58s
     0     0 29106.8038    0  324 23147.5362 29106.8038  25.7%     -   58s
     0     0 29103.5452    0  278 23147.5362 29103.5452  25.7%     -   58s
     0     0 29103.0686    0  277 23147.5362 29103.0686  25.7%     -   58s
     0     0 29088.1271    0  332 23147.5362 29088.1271  25.7%     -   60s
     0     0 29086.4759    0  328 23147.5362 29086.4759  25.7%     -   60s
     0     0 29085.8427    0  331 23147.5362 29085.8427  25.7%     -   61s
     0     0 29077.5558    0  331 23147.5362 29077.5558  25.6%     -   62s
     0     0 29064.2598    0  327 23147.5362 29064.2598  25.6%     -   62s
     0     0 29063.3253    0  272 23147.5362 29063.3253  25.6%     -   62s
     0     0 29039.3608    0  273 23147.5362 29039.3608  25.5%     -   63s
H    0     0                    23150.978939 29037.7100  25.4%     -   65s
     0     0 29035.9242    0  272 23150.9789 29035.9242  25.4%     -   65s
     0     0 29034.9269    0  274 23150.9789 29034.9269  25.4%     -   65s
     0     0 29032.5259    0  277 23150.9789 29032.5259  25.4%     -   66s
H    0     0                    23151.536567 29029.4800  25.4%     -   66s
H    0     0                    23153.014525 29029.4800  25.4%     -   66s
H    0     0                    23210.122299 29029.4800  25.1%     -   66s
     0     0 29029.4800    0  282 23210.1223 29029.4800  25.1%     -   66s
     0     0 29028.0643    0  286 23210.1223 29028.0643  25.1%     -   67s
     0     0 29027.3764    0  285 23210.1223 29027.3764  25.1%     -   67s
     0     0 29019.7899    0  276 23210.1223 29019.7899  25.0%     -   68s
     0     0 29018.9126    0  278 23210.1223 29018.9126  25.0%     -   68s
     0     0 28997.3344    0  276 23210.1223 28997.3344  24.9%     -   69s
     0     0 28995.5919    0  280 23210.1223 28995.5919  24.9%     -   69s
     0     0 28995.5919    0  282 23210.1223 28995.5919  24.9%     -   70s
     0     0 28994.0552    0  284 23210.1223 28994.0552  24.9%     -   70s
     0     0 28994.0552    0  280 23210.1223 28994.0552  24.9%     -   70s
     0     0 28994.0552    0  284 23210.1223 28994.0552  24.9%     -   71s
     0     0 28994.0552    0  284 23210.1223 28994.0552  24.9%     -   71s
     0     0 28994.0552    0  284 23210.1223 28994.0552  24.9%     -   72s
     0     2 28994.0552    0  284 23210.1223 28994.0552  24.9%     -   74s
     1     4 28920.2829    1  281 23210.1223 28991.8630  24.9%  2180   76s
     7    16 28064.8082    3  280 23210.1223 28460.8442  22.6%  3913   80s
    31    64 27589.9793    5  286 23210.1223 27983.7483  20.6%  3492   86s
    95   174 26399.8926    7  332 23210.1223 27589.7126  18.9%  4109   92s
   177   224 26346.1250    8  384 23210.1223 27589.7126  18.9%  3149   96s
   321   274 26010.3792    9  375 23210.1223 27380.8611  18.0%  2944  103s
   373   299 25334.0712    9  323 23210.1223 27380.8611  18.0%  3171  106s
   409   312 25412.8802   10  331 23210.1223 27196.1087  17.2%  3249  110s
   513   378     cutoff   11      23210.1223 27043.5744  16.5%  3217  119s
   572   414 24612.2696   12  358 23210.1223 26979.0637  16.2%  3087  123s
   630   447 24453.3269   13  352 23210.1223 26954.1365  16.1%  3022  126s
   753   493 23617.8592   16  288 23210.1223 26678.9255  14.9%  2889  132s
   811   523 24167.5474   16  393 23210.1223 26678.9255  14.9%  2860  136s
   915   574 23813.3733   17  390 23210.1223 26668.6642  14.9%  2844  143s
   970   595 23764.2048   18  349 23210.1223 26558.2705  14.4%  2790  146s
  1121   617 23425.5754   21  388 23210.1223 26558.2705  14.4%  2650  152s
  1198   626     cutoff   21      23210.1223 26485.7520  14.1%  2605  157s
  1295   640 25760.0066    8  250 23210.1223 26485.7520  14.1%  2540  161s
  1384   668 24951.0725   10  241 23210.1223 26360.3869  13.6%  2528  165s
  1591   677 24139.2146   16  248 23210.1223 26230.3686  13.0%  2454  172s
  1672   686 23979.4956   17  238 23210.1223 26200.6398  12.9%  2428  177s
  1781   688     cutoff   17      23210.1223 26200.6398  12.9%  2405  182s
  1876   684 23440.4562   17  221 23210.1223 26138.5296  12.6%  2382  186s
  1974   680 23974.9402   15  301 23210.1223 26116.8109  12.5%  2399  191s
  2160   683 23421.6375   19  249 23210.1223 25926.2092  11.7%  2385  199s
  2237   692 infeasible   16      23210.1223 25853.3811  11.4%  2373  203s
  2351   675 23785.8271   10  241 23210.1223 25845.5326  11.4%  2352  209s
  2520   655 23936.1152   10  252 23210.1223 25712.9065  10.8%  2330  214s
  2663   661     cutoff   11      23210.1223 25712.9065  10.8%  2338  221s
  2865   632     cutoff   15      23210.1223 25517.8830  9.94%  2295  226s
  3048   598 23695.6806   16  252 23210.1223 25298.0693  9.00%  2282  232s
  3207   551 23232.8124   11  302 23210.1223 25182.7704  8.50%  2306  238s
  3371   481 23285.9606   13  264 23210.1223 24960.2422  7.54%  2308  246s
  3569   385     cutoff   10      23210.1223 24822.8772  6.95%  2292  251s
  3797   243     cutoff   11      23210.1223 24694.2542  6.39%  2271  258s
  4134    34     cutoff   10      23210.1223 24341.0778  4.87%  2202  262s
  4582     2     cutoff   13      23210.1223 23932.1977  3.11%  2046  267s

Cutting planes:
  Learned: 3
  Implied bound: 28
  MIR: 528
  Flow cover: 641
  RLT: 17
  Relax-and-lift: 17

Explored 4707 nodes (9540789 simplex iterations) in 267.52 seconds (880.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23210.1 23210.1 23153 ... 22966.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.321012229902e+04, best bound 2.321012229902e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 267.52s
  Master Objective (UB) = 23210.12, θ = 143953.72
  Upper Bound (UB) = 23210.12

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 143953.72
  [DEBUG]   ✓ Scenario 0: θ = 143953.72 ≤ Q = 143953.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 143953.72 ≤ Q = 143953.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 143953.72 ≤ Q = 143953.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 143953.72 ≤ Q = 143953.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 143953.72 ≤ Q = 143953.72 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xce5bda7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf31a4259
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7409196.3162
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.405222e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140522.25    0  123 7409196.32 -140522.25   102%     -    0s
H    0     0                    -105537.1475 -140522.25  33.1%     -    0s
     0     0 -120552.00    0  132 -105537.15 -120552.00  14.2%     -    0s
H    0     0                    -115377.2388 -120442.85  4.39%     -    0s
H    0     0                    -116936.9323 -120442.85  3.00%     -    0s
     0     0 -119223.61    0  135 -116936.93 -119223.61  1.96%     -    0s
H    0     0                    -117260.8670 -119150.40  1.61%     -    0s
     0     0 -118442.08    0   97 -117260.87 -118442.08  1.01%     -    0s
H    0     0                    -117342.6677 -118313.46  0.83%     -    0s
     0     0 -118313.46    0   73 -117342.67 -118313.46  0.83%     -    0s
     0     0 -118306.45    0   73 -117342.67 -118306.45  0.82%     -    0s
     0     0 -118066.31    0   67 -117342.67 -118066.31  0.62%     -    0s
     0     0 -118045.33    0   71 -117342.67 -118045.33  0.60%     -    0s
     0     0 -117985.07    0   57 -117342.67 -117985.07  0.55%     -    0s
     0     0 -117961.83    0   57 -117342.67 -117961.83  0.53%     -    0s
     0     0 -117921.38    0   57 -117342.67 -117921.38  0.49%     -    0s
     0     0 -117888.96    0   57 -117342.67 -117888.96  0.47%     -    0s
     0     2 -117888.96    0   57 -117342.67 -117888.96  0.47%     -    0s
*   26    21               5    -117599.9095 -117706.23  0.09%   7.4    0s
*   31    20               5    -117600.7264 -117686.92  0.07%   7.7    0s
H   39     7                    -117604.3057 -117686.92  0.07%   7.4    0s
H   40     7                    -117622.3315 -117686.92  0.05%   7.3    0s
*   43     6               6    -117647.6870 -117686.92  0.03%   7.0    0s

Cutting planes:
  Gomory: 30
  Implied bound: 3
  MIR: 155
  Flow cover: 24
  RLT: 60
  Relax-and-lift: 3
  BQP: 1

Explored 55 nodes (1110 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -117648 -117622 -117604 ... 7.4092e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.176476870405e+05, best bound -1.176546896261e+05, gap 0.0060%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 134853.34
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117647.69
  [DEBUG]   S×d_nominal = 252501.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252501.03 + -117647.69 = 134853.34
  [DEBUG]   Current θ from Master = 143953.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9100.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14109.74
  Lower Bound (LB) = 17681.66
  Gap (UB-LB) = 5528.4578, Absolute Gap = 5528.4578, Relative Gap = 0.238192
  Not converged yet (gap = 5528.46 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0xc35e3634
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40602 rows and 16482 columns
Presolve time: 0.83s
Presolved: 52521 rows, 23218 columns, 326009 nonzeros
Variable types: 20959 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -192516.0046

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52521 rows, 23218 columns, 326009 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34052   -1.4069280e+03   0.000000e+00   9.652187e+05      5s
   47444    7.9181888e+03   0.000000e+00   6.876155e+05     10s
   58984    2.4308714e+04   0.000000e+00   1.699476e+06     15s
   68997    2.7394512e+04   0.000000e+00   1.483434e+06     20s
Concurrent spin time: 3.54s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.921205e+04, 50874 iterations, 24.17 seconds (48.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39212.0468    0  202 -192516.00 39212.0468   120%     -   25s
H    0     0                    -183751.9948 39212.0468   121%     -   25s
H    0     0                    -41295.66964 39212.0468   195%     -   25s
H    0     0                    -40979.81896 39212.0468   196%     -   25s
H    0     0                    -35864.05326 39212.0468   209%     -   25s
H    0     0                    -4857.679020 39212.0468   907%     -   25s
H    0     0                    16469.143882 39212.0468   138%     -   25s
H    0     0                    17655.607385 39212.0468   122%     -   25s
H    0     0                    19946.438305 39212.0468  96.6%     -   25s
H    0     0                    19975.348947 34656.7069  73.5%     -   33s
     0     0 34656.7069    0  266 19975.3489 34656.7069  73.5%     -   33s
     0     0 34467.3833    0  266 19975.3489 34467.3833  72.5%     -   35s
     0     0 34371.2791    0  271 19975.3489 34371.2791  72.1%     -   35s
     0     0 34371.2791    0  272 19975.3489 34371.2791  72.1%     -   36s
     0     0 34371.2791    0  271 19975.3489 34371.2791  72.1%     -   36s
     0     0 34371.2791    0  275 19975.3489 34371.2791  72.1%     -   37s
     0     0 34371.2791    0  273 19975.3489 34371.2791  72.1%     -   37s
H    0     0                    19981.655546 32676.1744  63.5%     -   42s
     0     0 32657.3832    0  248 19981.6555 32657.3832  63.4%     -   42s
H    0     0                    22127.772620 32657.3832  47.6%     -   42s
     0     0 32249.0649    0  254 22127.7726 32249.0649  45.7%     -   46s
     0     0 32048.8303    0  261 22127.7726 32048.8303  44.8%     -   49s
     0     0 31954.2781    0  255 22127.7726 31954.2781  44.4%     -   51s
     0     0 31946.1051    0  257 22127.7726 31946.1051  44.4%     -   52s
     0     0 31869.6084    0  264 22127.7726 31869.6084  44.0%     -   53s
     0     0 31868.5393    0  263 22127.7726 31868.5393  44.0%     -   53s
     0     0 31868.4475    0  263 22127.7726 31868.4475  44.0%     -   53s
H    0     0                    23096.029399 31868.4475  38.0%     -   56s
     0     0 30663.5669    0  277 23096.0294 30663.5669  32.8%     -   62s
     0     0 30423.4765    0  279 23096.0294 30423.4765  31.7%     -   65s
     0     0 30253.4744    0  327 23096.0294 30253.4744  31.0%     -   68s
     0     0 30205.1647    0  271 23096.0294 30205.1647  30.8%     -   69s
     0     0 30175.2542    0  273 23096.0294 30175.2542  30.7%     -   69s
     0     0 30140.5779    0  271 23096.0294 30140.5779  30.5%     -   70s
     0     0 30127.7718    0  269 23096.0294 30127.7718  30.4%     -   71s
H    0     0                    23147.536172 30113.2064  30.1%     -   72s
     0     0 30113.2064    0  267 23147.5362 30113.2064  30.1%     -   72s
     0     0 30111.1433    0  272 23147.5362 30111.1433  30.1%     -   73s
     0     0 30110.5379    0  274 23147.5362 30110.5379  30.1%     -   73s
     0     0 29752.0034    0  270 23147.5362 29752.0034  28.5%     -   79s
     0     0 29665.7972    0  283 23147.5362 29665.7972  28.2%     -   81s
     0     0 29653.3563    0  341 23147.5362 29653.3563  28.1%     -   81s
     0     0 29643.7347    0  281 23147.5362 29643.7347  28.1%     -   82s
     0     0 29640.0848    0  336 23147.5362 29640.0848  28.0%     -   82s
     0     0 29638.8355    0  277 23147.5362 29638.8355  28.0%     -   82s
     0     0 29637.2532    0  343 23147.5362 29637.2532  28.0%     -   82s
     0     0 29636.0911    0  337 23147.5362 29636.0911  28.0%     -   83s
     0     0 29631.4883    0  335 23147.5362 29631.4883  28.0%     -   83s
     0     0 29628.9766    0  342 23147.5362 29628.9766  28.0%     -   83s
     0     0 29628.2428    0  342 23147.5362 29628.2428  28.0%     -   83s
     0     0 29524.0916    0  347 23147.5362 29524.0916  27.5%     -   86s
     0     0 29468.3304    0  340 23147.5362 29468.3304  27.3%     -   87s
     0     0 29455.5003    0  336 23147.5362 29455.5003  27.3%     -   88s
     0     0 29451.8232    0  285 23147.5362 29451.8232  27.2%     -   89s
     0     0 29450.3315    0  284 23147.5362 29450.3315  27.2%     -   89s
     0     0 29448.6325    0  283 23147.5362 29448.6325  27.2%     -   89s
     0     0 29448.1187    0  283 23147.5362 29448.1187  27.2%     -   90s
     0     0 29373.0076    0  287 23147.5362 29373.0076  26.9%     -   91s
     0     0 29365.1018    0  281 23147.5362 29365.1018  26.9%     -   92s
     0     0 29362.6138    0  280 23147.5362 29362.6138  26.8%     -   92s
     0     0 29360.5508    0  290 23147.5362 29360.5508  26.8%     -   92s
     0     0 29360.1904    0  288 23147.5362 29360.1904  26.8%     -   93s
     0     0 29331.9758    0  283 23147.5362 29331.9758  26.7%     -   94s
     0     0 29322.4271    0  352 23147.5362 29322.4271  26.7%     -   95s
     0     0 29319.8357    0  293 23147.5362 29319.8357  26.7%     -   95s
     0     0 29319.0743    0  303 23147.5362 29319.0743  26.7%     -   95s
     0     0 29313.7580    0  295 23147.5362 29313.7580  26.6%     -   96s
     0     0 29307.8877    0  304 23147.5362 29307.8877  26.6%     -   97s
     0     0 29305.7149    0  308 23147.5362 29305.7149  26.6%     -   98s
     0     0 29304.5313    0  307 23147.5362 29304.5313  26.6%     -   98s
     0     0 29303.4818    0  311 23147.5362 29303.4818  26.6%     -   98s
     0     0 29270.3615    0  357 23147.5362 29270.3615  26.5%     -  100s
     0     0 29264.8252    0  350 23147.5362 29264.8252  26.4%     -  100s
     0     0 29263.6987    0  360 23147.5362 29263.6987  26.4%     -  100s
     0     0 29215.2275    0  353 23147.5362 29215.2275  26.2%     -  103s
     0     0 29201.4435    0  344 23147.5362 29201.4435  26.2%     -  104s
     0     0 29199.1067    0  351 23147.5362 29199.1067  26.1%     -  104s
     0     0 29197.9190    0  292 23147.5362 29197.9190  26.1%     -  104s
     0     0 29197.1328    0  353 23147.5362 29197.1328  26.1%     -  104s
     0     0 29132.8721    0  350 23147.5362 29132.8721  25.9%     -  106s
     0     0 29124.3481    0  344 23147.5362 29124.3481  25.8%     -  107s
     0     0 29123.6448    0  347 23147.5362 29123.6448  25.8%     -  107s
     0     0 29119.5550    0  359 23147.5362 29119.5550  25.8%     -  108s
     0     0 29116.7066    0  350 23147.5362 29116.7066  25.8%     -  109s
     0     0 29116.4508    0  348 23147.5362 29116.4508  25.8%     -  109s
     0     0 29113.3452    0  342 23147.5362 29113.3452  25.8%     -  110s
     0     0 29112.6202    0  353 23147.5362 29112.6202  25.8%     -  110s
     0     0 29109.1103    0  349 23147.5362 29109.1103  25.8%     -  111s
     0     0 29108.1650    0  354 23147.5362 29108.1650  25.8%     -  112s
     0     0 29102.0984    0  351 23147.5362 29102.0984  25.7%     -  113s
     0     0 29101.9573    0  351 23147.5362 29101.9573  25.7%     -  114s
H    0     0                    23150.978939 29101.7955  25.7%     -  120s
H    0     0                    23151.536567 29101.7955  25.7%     -  120s
     0     2 29101.7955    0  351 23151.5366 29101.7955  25.7%     -  120s
     3     8 28890.0328    2  282 23151.5366 29089.2528  25.6%  2097  126s
     7    16 28644.1947    3  339 23151.5366 28894.4464  24.8%  3594  131s
    31    45 25284.0055    5  163 23151.5366 28541.4457  23.3%  4464  140s
    48    73 24764.1259    6  176 23151.5366 28541.4457  23.3%  6077  149s
    78   132 24683.8876    7  140 23151.5366 28541.4457  23.3%  4606  154s
   141   182 24405.3984   11  135 23151.5366 28541.4457  23.3%  3905  157s
   207   231 24230.4140   12  122 23151.5366 28541.4457  23.3%  2975  161s
   322   238 24094.3716   13  108 23151.5366 28541.4457  23.3%  2258  168s
   422   236 23512.1660   14  127 23151.5366 28541.4457  23.3%  2048  174s
   490   250 infeasible   15      23151.5366 28541.4457  23.3%  2088  179s
   532   262     cutoff   16      23151.5366 28394.8862  22.6%  2216  184s
   578   288 23573.1485   10  252 23151.5366 28394.8862  22.6%  2352  188s
   632   312     cutoff   11      23151.5366 28394.8862  22.6%  2402  191s
   686   341 23932.6920   11  236 23151.5366 28394.8862  22.6%  2400  197s
   743   373 23731.8200   12  232 23151.5366 28394.8862  22.6%  2379  200s
   802   387 23214.3363   15  226 23151.5366 28394.8862  22.6%  2322  206s
   879   403     cutoff   15      23151.5366 28080.1348  21.3%  2269  212s
   937   417 27156.4960    7  386 23151.5366 28080.1348  21.3%  2306  217s
  1012   423 26594.0145    8  331 23151.5366 28080.1348  21.3%  2309  223s
  1076   447 25142.6808    9  146 23151.5366 28080.1348  21.3%  2339  229s
  1158   448 23910.6377   10  294 23151.5366 28080.1348  21.3%  2312  234s
  1261   446     cutoff   11      23151.5366 27723.0493  19.7%  2259  240s
  1357   459 24595.2023   10  188 23151.5366 27723.0493  19.7%  2262  246s
  1412   460 24120.5389   11  307 23151.5366 27723.0493  19.7%  2313  252s
  1491   473 23920.1390   12  244 23151.5366 27723.0493  19.7%  2308  258s
  1554   462 23502.6026   13  179 23151.5366 27723.0493  19.7%  2316  264s
  1654   448 23484.4936   14  173 23151.5366 27551.6335  19.0%  2313  272s
  1728   464     cutoff   15      23151.5366 27551.6335  19.0%  2322  278s
  1825   453     cutoff   14      23151.5366 27551.6335  19.0%  2318  285s
  1907   455 23588.6897   13  160 23151.5366 27551.6335  19.0%  2306  294s
  2013   445     cutoff   17      23151.5366 27551.6335  19.0%  2302  301s
  2160   430 24337.1469   12  122 23151.5366 25980.8813  12.2%  2256  308s
  2275   410     cutoff   22      23151.5366 25980.8813  12.2%  2251  315s
  2426   370 23421.9572    9  271 23151.5366 25717.6147  11.1%  2231  323s
  2584   314 infeasible   12      23151.5366 25334.3184  9.43%  2218  331s
  2798   213 23694.2646   10  125 23151.5366 24752.2405  6.91%  2161  338s
  3095   203     cutoff   12      23151.5366 24577.0822  6.16%  2054  342s
  3172   144     cutoff    9      23151.5366 24577.0822  6.16%  2032  347s
  3404    59 infeasible    9      23151.5366 24192.8852  4.50%  1930  352s
  3599    13     cutoff   10      23151.5366 24061.4181  3.93%  1845  356s

Cutting planes:
  Learned: 2
  Implied bound: 23
  MIR: 640
  Flow cover: 732
  RLT: 28
  Relax-and-lift: 20

Explored 3794 nodes (6851104 simplex iterations) in 359.41 seconds (1049.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23151.5 23151 23147.5 ... 16469.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.315153656673e+04, best bound 2.315153656673e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 359.43s
  Master Objective (UB) = 23151.54, θ = 144022.79
  Upper Bound (UB) = 23151.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144022.79
  [DEBUG]   ✓ Scenario 0: θ = 144022.79 ≤ Q = 144022.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144022.79 ≤ Q = 144022.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144022.79 ≤ Q = 144022.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144022.79 ≤ Q = 144022.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144022.79 ≤ Q = 144022.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144022.79 ≤ Q = 144022.79 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6edff250
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x91200db0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7415304.0045
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.403839e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140383.86    0  123 7415304.00 -140383.86   102%     -    0s
H    0     0                    -105353.5003 -140383.86  33.3%     -    0s
     0     0 -120437.37    0  135 -105353.50 -120437.37  14.3%     -    0s
H    0     0                    -115695.0346 -120328.22  4.00%     -    0s
H    0     0                    -116828.9343 -120328.22  3.00%     -    0s
     0     0 -119211.39    0  136 -116828.93 -119211.39  2.04%     -    0s
     0     0 -118487.47    0  135 -116828.93 -118487.47  1.42%     -    0s
H    0     0                    -116833.8560 -118486.47  1.41%     -    0s
     0     0 -118401.33    0  119 -116833.86 -118401.33  1.34%     -    0s
     0     0 -118379.08    0  133 -116833.86 -118379.08  1.32%     -    0s
     0     0 -118378.74    0  133 -116833.86 -118378.74  1.32%     -    0s
     0     0 -117896.67    0  123 -116833.86 -117896.67  0.91%     -    0s
     0     0 -117797.50    0   99 -116833.86 -117797.50  0.82%     -    0s
     0     0 -117772.64    0   97 -116833.86 -117772.64  0.80%     -    0s
     0     0 -117762.37    0   97 -116833.86 -117762.37  0.79%     -    0s
     0     0 -117282.96    0   57 -116833.86 -117282.96  0.38%     -    0s
H    0     0                    -116898.6807 -117225.52  0.28%     -    0s
     0     0 -117225.52    0   55 -116898.68 -117225.52  0.28%     -    0s
     0     0 -117225.52    0   55 -116898.68 -117225.52  0.28%     -    0s
     0     0 -117120.51    0   14 -116898.68 -117120.51  0.19%     -    0s
     0     0 -117049.74    0   14 -116898.68 -117049.74  0.13%     -    0s
     0     0 -117049.71    0   13 -116898.68 -117049.71  0.13%     -    0s
     0     0 -117043.20    0   15 -116898.68 -117043.20  0.12%     -    0s
     0     0 -116981.45    0   12 -116898.68 -116981.45  0.07%     -    0s
     0     0 -116981.45    0   21 -116898.68 -116981.45  0.07%     -    0s
     0     0 -116922.46    0    3 -116898.68 -116922.46  0.02%     -    0s
H    0     0                    -116918.8286 -116922.07  0.00%     -    0s

Cutting planes:
  Gomory: 10
  MIR: 10
  Flow cover: 10
  Relax-and-lift: 5

Explored 1 nodes (991 simplex iterations) in 0.11 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -116919 -116899 -116834 ... 1.43567e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.169188286228e+05, best bound -1.169220713673e+05, gap 0.0028%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 135582.20
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116918.83
  [DEBUG]   S×d_nominal = 252501.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252501.03 + -116918.83 = 135582.20
  [DEBUG]   Current θ from Master = 144022.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8440.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14710.95
  Lower Bound (LB) = 17681.66
  Gap (UB-LB) = 5469.8721, Absolute Gap = 5469.8721, Relative Gap = 0.236264
  Not converged yet (gap = 5469.87 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308199 nonzeros
Model fingerprint: 0x624f675f
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47369 rows and 19229 columns
Presolve time: 1.00s
Presolved: 61044 rows, 26711 columns, 379424 nonzeros
Variable types: 24452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 61044 rows, 26711 columns, 379424 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35995    7.5606282e+03   0.000000e+00   1.115814e+07      5s
   48366    2.7177024e+04   0.000000e+00   5.204266e+06     10s
   57543    3.2485214e+04   0.000000e+00   7.059748e+07     15s
   65584    3.3316578e+04   0.000000e+00   3.881976e+06     20s
   74312    3.4486239e+04   0.000000e+00   4.269737e+05     25s
Concurrent spin time: 0.23s

Solved with dual simplex

Root relaxation: objective 3.799960e+04, 53214 iterations, 24.44 seconds (51.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37999.6034    0   95 -208513.72 37999.6034   118%     -   25s
H    0     0                    -201213.6473 37999.6034   119%     -   25s
H    0     0                    -130732.5822 37999.6034   129%     -   26s
H    0     0                    -130675.2153 37999.6034   129%     -   26s
H    0     0                    -45457.03517 37999.6034   184%     -   26s
H    0     0                    -1133.295683 37999.6034  3453%     -   26s
H    0     0                    11065.322724 37999.6034   243%     -   26s
H    0     0                    11562.082870 37999.6034   229%     -   26s
H    0     0                    13518.009245 37999.6034   181%     -   26s
H    0     0                    16205.305310 37999.6034   134%     -   26s
H    0     0                    16381.695852 37999.3272   132%     -   27s
     0     0 32742.3108    0  245 16381.6959 32742.3108   100%     -   34s
     0     0 32650.2447    0  244 16381.6959 32650.2447  99.3%     -   36s
     0     0 32650.2447    0  246 16381.6959 32650.2447  99.3%     -   37s
     0     0 32649.8960    0  248 16381.6959 32649.8960  99.3%     -   38s
     0     0 32649.8830    0  248 16381.6959 32649.8830  99.3%     -   38s
     0     0 30722.7833    0  201 16381.6959 30722.7833  87.5%     -   43s
H    0     0                    18133.214075 30722.6819  69.4%     -   43s
H    0     0                    19388.646865 30722.6819  58.5%     -   43s
H    0     0                    19564.537520 30722.6819  57.0%     -   43s
H    0     0                    19609.063614 30722.6819  56.7%     -   43s
H    0     0                    19613.055558 30722.6819  56.6%     -   43s
H    0     0                    19637.055870 30722.6819  56.5%     -   43s
H    0     0                    19638.437949 30722.6819  56.4%     -   43s
     0     0 30289.5030    0  210 19638.4379 30289.5030  54.2%     -   48s
     0     0 30113.5371    0  216 19638.4379 30113.5371  53.3%     -   50s
     0     0 30021.7028    0  212 19638.4379 30021.7028  52.9%     -   51s
     0     0 29947.0245    0  221 19638.4379 29947.0245  52.5%     -   52s
     0     0 29909.4060    0  225 19638.4379 29909.4060  52.3%     -   52s
     0     0 29906.4721    0  227 19638.4379 29906.4721  52.3%     -   53s
     0     0 29903.7441    0  229 19638.4379 29903.7441  52.3%     -   53s
     0     0 29903.4189    0  228 19638.4379 29903.4189  52.3%     -   53s
H    0     0                    19828.674314 29903.4189  50.8%     -   56s
H    0     0                    19967.460477 28305.3329  41.8%     -   61s
H    0     0                    20260.919905 28305.3329  39.7%     -   61s
H    0     0                    20432.279565 28305.3329  38.5%     -   61s
H    0     0                    20490.361740 28305.3329  38.1%     -   61s
H    0     0                    20515.649913 28305.3329  38.0%     -   61s
     0     0 28305.3329    0  318 20515.6499 28305.3329  38.0%     -   61s
H    0     0                    20555.531388 28004.2135  36.2%     -   64s
H    0     0                    20590.358860 28004.2135  36.0%     -   64s
     0     0 28004.2135    0  317 20590.3589 28004.2135  36.0%     -   64s
     0     0 27839.3837    0  329 20590.3589 27839.3837  35.2%     -   68s
     0     0 27769.4961    0  329 20590.3589 27769.4961  34.9%     -   69s
     0     0 27715.2656    0  268 20590.3589 27715.2656  34.6%     -   71s
     0     0 27695.9180    0  324 20590.3589 27695.9180  34.5%     -   72s
     0     0 27686.6225    0  330 20590.3589 27686.6225  34.5%     -   72s
     0     0 27682.2223    0  327 20590.3589 27682.2223  34.4%     -   73s
     0     0 27679.1125    0  327 20590.3589 27679.1125  34.4%     -   73s
     0     0 27678.9223    0  327 20590.3589 27678.9223  34.4%     -   73s
H    0     0                    20644.328101 27484.1140  33.1%     -   77s
     0     0 27484.1140    0  280 20644.3281 27484.1140  33.1%     -   77s
     0     0 27402.3285    0  271 20644.3281 27402.3285  32.7%     -   81s
     0     0 27386.6385    0  241 20644.3281 27386.6385  32.7%     -   81s
     0     0 27378.1050    0  265 20644.3281 27378.1050  32.6%     -   82s
     0     0 27373.2565    0  274 20644.3281 27373.2565  32.6%     -   84s
     0     0 27371.5056    0  272 20644.3281 27371.5056  32.6%     -   84s
     0     0 27371.1382    0  267 20644.3281 27371.1382  32.6%     -   85s
     0     0 27361.2985    0  279 20644.3281 27361.2985  32.5%     -   86s
     0     0 27360.4467    0  283 20644.3281 27360.4467  32.5%     -   87s
     0     0 27328.6529    0  280 20644.3281 27328.6529  32.4%     -   90s
H    0     0                    20660.375853 27324.3304  32.3%     -   92s
     0     0 27324.3304    0  274 20660.3759 27324.3304  32.3%     -   92s
     0     0 27321.7219    0  282 20660.3759 27321.7219  32.2%     -   92s
     0     0 27321.4605    0  281 20660.3759 27321.4605  32.2%     -   93s
     0     0 27208.6844    0  335 20660.3759 27208.6844  31.7%     -   96s
H    0     0                    20665.181080 27162.0118  31.4%     -   99s
H    0     0                    20690.353412 27162.0118  31.3%     -   99s
     0     0 27162.0118    0  350 20690.3534 27162.0118  31.3%     -   99s
     0     0 27154.9275    0  345 20690.3534 27154.9275  31.2%     -  100s
     0     0 27154.0254    0  342 20690.3534 27154.0254  31.2%     -  100s
     0     0 27151.4750    0  347 20690.3534 27151.4750  31.2%     -  102s
H    0     0                    20699.458194 27149.9228  31.2%     -  102s
     0     0 27148.9000    0  293 20699.4582 27148.9000  31.2%     -  102s
     0     0 27146.9520    0  341 20699.4582 27146.9520  31.1%     -  103s
     0     0 27146.4876    0  289 20699.4582 27146.4876  31.1%     -  103s
     0     0 27136.4039    0  337 20699.4582 27136.4039  31.1%     -  105s
     0     0 27130.5519    0  339 20699.4582 27130.5519  31.1%     -  106s
     0     0 27129.0631    0  341 20699.4582 27129.0631  31.1%     -  107s
     0     0 27128.3344    0  286 20699.4582 27128.3344  31.1%     -  107s
     0     0 27123.3708    0  292 20699.4582 27123.3708  31.0%     -  109s
     0     0 27122.3581    0  296 20699.4582 27122.3581  31.0%     -  109s
     0     0 27119.6305    0  296 20699.4582 27119.6305  31.0%     -  110s
     0     0 27119.4257    0  298 20699.4582 27119.4257  31.0%     -  111s
     0     0 27119.3984    0  298 20699.4582 27119.3984  31.0%     -  111s
     0     0 27119.2460    0  293 20699.4582 27119.2460  31.0%     -  112s
     0     0 27119.1953    0  295 20699.4582 27119.1953  31.0%     -  113s
     0     0 27118.8918    0  295 20699.4582 27118.8918  31.0%     -  113s
     0     2 27117.8542    0  295 20699.4582 27117.8542  31.0%     -  128s
     1     4 26882.1381    1  338 20699.4582 27117.8542  31.0%  6836  132s
     3     8 26406.3853    2  287 20699.4582 26881.9849  29.9%  6310  136s
     7    16 25949.8426    3  336 20699.4582 26405.0582  27.6%  5383  140s
    31    48 24957.4651    5  281 20699.4582 25953.9268  25.4%  4512  152s
    47    80 24154.0518    6  282 20699.4582 25953.9268  25.4%  7488  156s
H   49    80                    20711.790494 25953.9268  25.3%  7302  156s
H   56    80                    20718.075385 25953.9268  25.3%  7226  156s
    79   221 24080.7956    7  282 20718.0754 25953.9268  25.3%  5864  162s
   220   281 23887.1105   11  256 20718.0754 25953.9268  25.3%  2988  167s
H  222   281                    20725.167522 25953.9268  25.2%  2969  167s
H  259   281                    20749.073389 25953.9268  25.1%  2690  167s
   284   348 23576.9991   11  254 20749.0734 25953.9268  25.1%  2569  171s
H  401   396                    20771.827792 25953.9268  24.9%  2279  173s
   412   427 23131.3243   13  210 20771.8278 25953.9268  24.9%  2248  177s
   499   458 23407.0063   13  263 20771.8278 25953.9268  24.9%  2066  183s
H  500   458                    20779.671557 25953.9268  24.9%  2062  183s
   581   487 22909.6269   12  220 20779.6716 25953.9268  24.9%  1933  188s
   651   507 23100.5701   12  266 20779.6716 25953.9268  24.9%  1898  194s
   724   522 23225.9959   14  223 20779.6716 25897.8065  24.6%  1846  199s
   773   533 23162.7146   14  227 20779.6716 25897.8065  24.6%  1833  205s
   830   564 21947.5007   14  244 20779.6716 25897.8065  24.6%  1877  211s
   885   608     cutoff   15      20779.6716 25897.8065  24.6%  1890  217s
   949   658     cutoff   15      20779.6716 25897.8065  24.6%  1885  222s
  1022   697 22230.3006   16  184 20779.6716 25897.8065  24.6%  1850  229s
  1089   716 22139.0624   17  210 20779.6716 25897.8065  24.6%  1802  235s
  1132   752 21948.2061   18  200 20779.6716 25897.8065  24.6%  1795  241s
  1198   783 21902.7030   19  196 20779.6716 25897.8065  24.6%  1766  248s
  1300   799 21611.0997   20  204 20779.6716 25897.8065  24.6%  1693  252s
  1357   842 21783.5309   18  202 20779.6716 25897.8065  24.6%  1690  259s
  1435   863 21327.4495   21  199 20779.6716 25897.8065  24.6%  1682  265s
  1522   882 21235.2965   22  188 20779.6716 25897.8065  24.6%  1669  270s
  1632   893     cutoff   23      20779.6716 25767.5864  24.0%  1658  276s
  1689   924 22731.4616   10  214 20779.6716 25767.5864  24.0%  1697  282s
  1782   986 22190.7521   11  209 20779.6716 25767.5864  24.0%  1695  290s
  1901  1053 22182.5426   12  204 20779.6716 25767.5864  24.0%  1683  295s
  2075  1140 21356.5045   18  164 20779.6716 25767.5864  24.0%  1626  302s
  2239  1219 20927.6552   21  249 20779.6716 25767.5864  24.0%  1584  310s
  2411  1231     cutoff   18      20779.6716 24664.7398  18.7%  1556  317s
  2459  1259 22701.7290    6  245 20779.6716 24664.7398  18.7%  1567  323s
  2519  1316 21681.6313    9  181 20779.6716 24664.7398  18.7%  1574  330s
  2682  1412 20976.3076   15  152 20779.6716 24124.4396  16.1%  1536  337s
  2867  1504 22389.2627   12  187 20779.6716 24052.4488  15.7%  1500  344s
  3021  1525 22273.3558   14  182 20779.6716 24010.9215  15.6%  1497  352s
  3163  1531 21143.0512   16  171 20779.6716 23991.1947  15.5%  1488  360s
  3297  1528     cutoff   11      20779.6716 23991.1947  15.5%  1514  368s
  3366  1525 23045.0584   15  315 20779.6716 23926.1572  15.1%  1534  376s
  3485  1532     cutoff   18      20779.6716 23704.9343  14.1%  1560  384s
  3668  1561     cutoff   17      20779.6716 23648.7734  13.8%  1574  392s
  3882  1571 21300.2884    9  154 20779.6716 23586.6855  13.5%  1574  400s
  4066  1596 20780.8487    9  124 20779.6716 23484.3897  13.0%  1590  408s
  4292  1583 21893.0005   19  175 20779.6716 23461.2481  12.9%  1592  417s
  4501  1591 22483.1527   18  296 20779.6716 23403.9921  12.6%  1602  426s
  4732  1637     cutoff   20      20779.6716 23403.9921  12.6%  1598  436s
  5032  1590 20967.3729   11  205 20779.6716 23131.1136  11.3%  1586  445s
  5241  1570 21495.8578   14  220 20779.6716 23116.0227  11.2%  1605  455s
  5468  1525     cutoff   14      20779.6716 23034.0561  10.8%  1623  465s
  5626  1509     cutoff   11      20779.6716 22893.7381  10.2%  1634  476s
  5876  1541     cutoff   12      20779.6716 22826.5573  9.85%  1642  486s
  6272  1591 21292.0556   10  227 20779.6716 22639.8601  8.95%  1636  496s
  6760  1628     cutoff   16      20779.6716 22556.2149  8.55%  1631  505s
  7270  1637 21234.1235   23  224 20779.6716 22301.2580  7.32%  1617  514s
  7959  1637 21819.4673   24  180 20779.6716 22151.4821  6.60%  1580  525s
  8853  1629 21508.7977   40  141 20779.6716 21851.5249  5.16%  1515  533s
  9744  1615 20881.0111   62   42 20779.6716 21792.3686  4.87%  1429  542s
 11578  1889 20931.7243   35   67 20779.6716 21514.8959  3.54%  1265  548s
 13880  2237     cutoff   33      20779.6716 21480.2959  3.37%  1090  553s
 16665  2238 20895.0996   21  295 20779.6716 21122.7819  1.65%   930  642s
 16667  2239 21001.7604   32   95 20779.6716 21122.7819  1.65%   930  673s
 16668  2240 21000.3263   39  302 20779.6716 21122.7819  1.65%   930  688s
 16669  2241 20912.2271   55  311 20779.6716 21122.7819  1.65%   930  699s
 16670  2241 20966.0259   30  330 20779.6716 21122.7819  1.65%   930  705s
 16672  2243 20936.6120   35  329 20779.6716 21122.7819  1.65%   929  712s
 16674  2244 21007.6557   25  274 20779.6716 21122.7819  1.65%   929  717s
 16675  2245 20939.3726   32  279 20779.6716 21122.7819  1.65%   929  722s
 16676  2245 20947.3279   42  332 20779.6716 21122.7819  1.65%   929  725s
 16677  2246 21020.1035   24  326 20779.6716 21122.7819  1.65%   929  731s
 16678  2247 20933.6236   35  284 20779.6716 21122.7819  1.65%   929  735s
 16679  2247 20935.0829   40  340 20779.6716 21122.7819  1.65%   929  740s
 16681  2249 20943.5736   43  337 20779.6716 21122.7819  1.65%   929  746s
 16683  2250 20807.0377   51  340 20779.6716 21122.7819  1.65%   929  753s
 16684  2251 20834.2856   45  342 20779.6716 21122.7819  1.65%   929  755s
 16685  2251 20863.4608   46  337 20779.6716 21122.7819  1.65%   929  760s
 16687  2253 20893.6329   42  418 20779.6716 21122.7819  1.65%   929  768s
 16688  2253 20799.8488   46  418 20779.6716 21122.7819  1.65%   929  797s
 16689  2254 21017.3116   42  418 20779.6716 21122.7819  1.65%   929  811s
 16690  2258 21122.7819   10  374 20779.6716 21122.7819  1.65%   940  824s
 16692  2261 21122.7819   11  386 20779.6716 21122.7819  1.65%   941  834s
 16696  2268 21122.7819   12  377 20779.6716 21122.7819  1.65%   942  841s
 16704  2281 21122.7819   13  406 20779.6716 21122.7819  1.65%   944  851s
 16720  2292 21122.7819   14  333 20779.6716 21122.7819  1.65%   949  861s
 16736  2311 21122.7819   15  288 20779.6716 21122.7819  1.65%   960  872s
 16768  2326 21122.7819   16  281 20779.6716 21122.7819  1.65%   969  885s
 16862  2285 21122.7819   18  253 20779.6716 21122.7819  1.65%   983  895s
 16942  2255     cutoff   19      20779.6716 21122.7819  1.65%   994  904s
 17011  2223     cutoff   21      20779.6716 21122.7819  1.65%  1003  912s
 17071  2195 21122.7819   16  284 20779.6716 21122.7819  1.65%  1010  926s
 17139  2188 21122.7819   17  248 20779.6716 21122.7819  1.65%  1016  933s
 17208  2164 21116.0718   18  228 20779.6716 21122.7819  1.65%  1019  940s
 17303  2114     cutoff   19      20779.6716 21122.7819  1.65%  1021  948s
 17359  2082 21122.7819   28  222 20779.6716 21122.7819  1.65%  1026  954s
 17434  2050     cutoff   29      20779.6716 21122.7819  1.65%  1027  961s
 17498  2020 21122.7819   15  259 20779.6716 21122.7819  1.65%  1031  967s
 17547  1997 21122.7819   16  248 20779.6716 21122.7819  1.65%  1035  974s
 17590  1978 21122.7819   17  254 20779.6716 21122.7819  1.65%  1038  980s
 17631  1966     cutoff   18      20779.6716 21122.7819  1.65%  1041  985s
 17710  1939     cutoff   19      20779.6716 21122.7819  1.65%  1045  996s
 17751  1926 21122.7819   24  248 20779.6716 21122.7819  1.65%  1046 1001s
 17800  1921 21122.7819   26  243 20779.6716 21122.7819  1.65%  1046 1005s
 17996  1822 20851.5541   41   39 20779.6716 21122.7819  1.65%  1038 1010s
 18083  1884 21017.7418   39   68 20779.6716 21122.7819  1.65%  1033 1016s
 19413  1418 20847.6661   43   28 20779.6716 20959.2956  0.86%   968 1020s
 20115  1143 20802.6490   57   11 20779.6716 20803.3040  0.11%   936 1025s
 20263  1072 20797.1556   62   12 20779.6716 20798.1923  0.09%   929 1030s

Cutting planes:
  Learned: 2
  Implied bound: 18
  MIR: 257
  Flow cover: 760
  RLT: 13
  Relax-and-lift: 58

Explored 20299 nodes (19023338 simplex iterations) in 1033.90 seconds (3115.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20779.7 20749.1 20725.2 ... 20644.3

Optimal solution found (tolerance 1.00e-04)
Best objective 2.077967155728e+04, best bound 2.077967155728e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1033.92s
  Master Objective (UB) = 20779.67, θ = 140283.31
  Upper Bound (UB) = 20779.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140283.31
  [DEBUG]   ✓ Scenario 0: θ = 140283.31 ≤ Q = 140283.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140283.31 ≤ Q = 140310.12 (slack: 26.82)
  [DEBUG]   ✓ Scenario 2: θ = 140283.31 ≤ Q = 140283.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140283.31 ≤ Q = 140283.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140283.31 ≤ Q = 140283.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140283.31 ≤ Q = 140283.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140283.31 ≤ Q = 140283.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5a387382
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5a387382
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7513381.0937
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.359922e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135992.18    0  123 7513381.09 -135992.18   102%     -    0s
H    0     0                    -101131.5463 -135992.18  34.5%     -    0s
     0     0 -111024.66    0   87 -101131.55 -111024.66  9.78%     -    0s
H    0     0                    -109186.8778 -110974.41  1.64%     -    0s
H    0     0                    -109663.6300 -110974.41  1.20%     -    0s
     0     0 -110509.00    0   61 -109663.63 -110509.00  0.77%     -    0s
H    0     0                    -109788.7247 -110506.95  0.65%     -    0s
     0     0 -110371.10    0   67 -109788.72 -110371.10  0.53%     -    0s
     0     0 -110351.90    0   53 -109788.72 -110351.90  0.51%     -    0s
H    0     0                    -110237.6034 -110351.90  0.10%     -    0s
H    0     0                    -110240.9235 -110351.90  0.10%     -    0s
     0     0 -110270.23    0   46 -110240.92 -110270.23  0.03%     -    0s
     0     0 -110257.35    0    4 -110240.92 -110257.35  0.01%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 2
  MIR: 154
  Flow cover: 6
  RLT: 12
  Relax-and-lift: 2

Explored 1 nodes (605 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -110241 -109789 -109664 ... 1.4374e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.102409234610e+05, best bound -1.102466717103e+05, gap 0.0052%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 134089.44
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110240.92
  [DEBUG]   S×d_nominal = 244330.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244330.36 + -110240.92 = 134089.44
  [DEBUG]   Current θ from Master = 140283.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6193.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14585.80
  Lower Bound (LB) = 17681.66
  Gap (UB-LB) = 3098.0071, Absolute Gap = 3098.0071, Relative Gap = 0.149088
  Not converged yet (gap = 3098.01 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351439 nonzeros
Model fingerprint: 0xdc647d85
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54136 rows and 21976 columns
Presolve time: 1.13s
Presolved: 69567 rows, 30204 columns, 432839 nonzeros
Variable types: 27945 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 69567 rows, 30204 columns, 432839 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37389   -2.6690678e+04   0.000000e+00   4.423908e+08      5s
   50502    5.6292716e+03   0.000000e+00   1.414577e+07     10s
   59102    2.4186462e+04   0.000000e+00   3.400688e+06     15s
   67122    2.8249683e+04   0.000000e+00   1.175129e+06     20s
   76091    3.1429172e+04   0.000000e+00   1.235050e+07     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.799610e+04, 54971 iterations, 24.90 seconds (53.61 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37996.0972    0   95 -208513.72 37996.0972   118%     -   26s
H    0     0                    -199468.7808 37996.0972   119%     -   26s
H    0     0                    -93152.50232 37996.0972   141%     -   26s
H    0     0                    -45457.03517 37996.0972   184%     -   26s
H    0     0                    12207.602015 37996.0972   211%     -   26s
H    0     0                    12327.896190 37996.0972   208%     -   26s
H    0     0                    15557.984417 37996.0972   144%     -   27s
H    0     0                    15680.767996 37996.0972   142%     -   27s
H    0     0                    16064.559394 37996.0972   137%     -   27s
H    0     0                    18269.443825 37996.0894   108%     -   27s
H    0     0                    19109.904312 37996.0894  98.8%     -   27s
H    0     0                    19151.965843 37996.0894  98.4%     -   27s
H    0     0                    19407.810736 37996.0894  95.8%     -   27s
H    0     0                    19411.415831 37996.0894  95.7%     -   27s
     0     0 32929.3698    0  245 19411.4158 32929.3698  69.6%     -   35s
     0     0 32752.3069    0  250 19411.4158 32752.3069  68.7%     -   37s
     0     0 32746.0565    0  246 19411.4158 32746.0565  68.7%     -   37s
     0     0 32746.0471    0  246 19411.4158 32746.0471  68.7%     -   38s
     0     0 30865.1343    0  196 19411.4158 30865.1343  59.0%     -   43s
H    0     0                    19466.700102 30864.8005  58.6%     -   44s
H    0     0                    19476.725363 30864.8005  58.5%     -   44s
H    0     0                    19512.223355 30864.8005  58.2%     -   44s
H    0     0                    19521.841483 30864.8005  58.1%     -   44s
H    0     0                    19620.065796 30864.8005  57.3%     -   44s
H    0     0                    19687.885654 30864.8005  56.8%     -   44s
     0     0 30428.8310    0  214 19687.8857 30428.8310  54.6%     -   47s
     0     0 30254.3231    0  213 19687.8857 30254.3231  53.7%     -   49s
     0     0 30159.9438    0  211 19687.8857 30159.9438  53.2%     -   51s
     0     0 30151.0213    0  216 19687.8857 30151.0213  53.1%     -   52s
     0     0 30091.6449    0  215 19687.8857 30091.6449  52.8%     -   53s
     0     0 30091.6169    0  215 19687.8857 30091.6169  52.8%     -   54s
H    0     0                    19819.044961 28714.4553  44.9%     -   68s
H    0     0                    19843.889300 28714.4553  44.7%     -   68s
H    0     0                    19913.380392 28714.4553  44.2%     -   68s
H    0     0                    19948.900564 28714.4553  43.9%     -   68s
H    0     0                    19975.052751 28714.4553  43.8%     -   68s
     0     0 28714.4553    0  265 19975.0528 28714.4553  43.8%     -   68s
     0     0 28455.4988    0  264 19975.0528 28455.4988  42.5%     -   71s
     0     0 28304.4717    0  267 19975.0528 28304.4717  41.7%     -   74s
     0     0 28289.4719    0  267 19975.0528 28289.4719  41.6%     -   74s
     0     0 28270.8206    0  271 19975.0528 28270.8206  41.5%     -   75s
     0     0 28266.0242    0  270 19975.0528 28266.0242  41.5%     -   75s
     0     0 28257.4084    0  266 19975.0528 28257.4084  41.5%     -   76s
     0     0 28256.2693    0  272 19975.0528 28256.2693  41.5%     -   77s
H    0     0                    19989.143998 28251.0777  41.3%     -   78s
H    0     0                    20007.007350 28251.0777  41.2%     -   78s
H    0     0                    20009.291085 28251.0777  41.2%     -   78s
H    0     0                    20043.108591 28251.0777  41.0%     -   78s
     0     0 28251.0777    0  264 20043.1086 28251.0777  41.0%     -   78s
H    0     0                    20251.641688 28182.1520  39.2%     -   80s
H    0     0                    20270.659750 28182.1520  39.0%     -   80s
H    0     0                    20350.705818 28182.1520  38.5%     -   80s
H    0     0                    20358.690569 28182.1520  38.4%     -   80s
     0     0 28182.1520    0  263 20358.6906 28182.1520  38.4%     -   80s
     0     0 28119.6825    0  323 20358.6906 28119.6825  38.1%     -   83s
     0     0 28096.9168    0  274 20358.6906 28096.9168  38.0%     -   85s
     0     0 28094.8486    0  275 20358.6906 28094.8486  38.0%     -   85s
     0     0 28093.9096    0  272 20358.6906 28093.9096  38.0%     -   86s
     0     0 27546.3040    0  333 20358.6906 27546.3040  35.3%     -   94s
H    0     0                    20397.109126 27539.3781  35.0%     -   94s
     0     0 27452.4973    0  326 20397.1091 27452.4973  34.6%     -   97s
     0     0 27437.4239    0  253 20397.1091 27437.4239  34.5%     -   98s
     0     0 27436.0614    0  250 20397.1091 27436.0614  34.5%     -   98s
     0     0 27434.9265    0  267 20397.1091 27434.9265  34.5%     -   99s
     0     0 27378.0332    0  324 20397.1091 27378.0332  34.2%     -  102s
     0     0 27366.1518    0  261 20397.1091 27366.1518  34.2%     -  103s
     0     0 27364.4950    0  325 20397.1091 27364.4950  34.2%     -  104s
     0     0 27363.4147    0  271 20397.1091 27363.4147  34.2%     -  105s
     0     0 27353.3193    0  323 20397.1091 27353.3193  34.1%     -  106s
     0     0 27352.4613    0  241 20397.1091 27352.4613  34.1%     -  107s
     0     0 27345.9550    0  264 20397.1091 27345.9550  34.1%     -  108s
     0     0 27344.4505    0  269 20397.1091 27344.4505  34.1%     -  109s
     0     0 27344.0339    0  270 20397.1091 27344.0339  34.1%     -  110s
     0     0 27341.0052    0  282 20397.1091 27341.0052  34.0%     -  111s
     0     0 27337.6302    0  243 20397.1091 27337.6302  34.0%     -  111s
     0     0 27337.6302    0  245 20397.1091 27337.6302  34.0%     -  111s
     0     0 27337.6302    0  239 20397.1091 27337.6302  34.0%     -  113s
     0     0 27337.5677    0  239 20397.1091 27337.5677  34.0%     -  113s
     0     0 27333.9925    0  274 20397.1091 27333.9925  34.0%     -  114s
     0     0 27333.8266    0  274 20397.1091 27333.8266  34.0%     -  115s
     0     2 27333.8266    0  274 20397.1091 27333.8266  34.0%     -  123s
     1     4 26977.1335    1  265 20397.1091 27333.8266  34.0%  3978  128s
     3     8 26725.8170    2  336 20397.1091 26975.0578  32.2%  5591  132s
     7    16 26429.3826    3  340 20397.1091 26725.7624  31.0%  5830  138s
    15    32 26260.8110    4  328 20397.1091 26428.2707  29.6%  6421  143s
    31    46 25233.0734    5  276 20397.1091 26260.5835  28.7%  7901  155s
    47    73 23494.9872    6  238 20397.1091 26260.5835  28.7%  9635  167s
H   49    73                    20445.171902 26260.5835  28.4%  9393  167s
H   57    73                    20490.123787 26260.5835  28.2%  8805  167s
H   66    72                    20611.757745 26178.2807  27.0%  8322  167s
    78   143 22963.5736    7  278 20611.7577 26178.2807  27.0%  7335  180s
H  155   245                    20632.726115 26178.2807  26.9%  4892  186s
H  173   245                    20632.935586 26178.2807  26.9%  4797  186s
H  194   245                    20653.442582 26178.2807  26.8%  4630  186s
H  222   245                    20660.168498 26178.2807  26.7%  4488  186s
H  227   245                    20680.603347 26178.2807  26.6%  4414  186s
   265   270 22171.4578   11  204 20680.6033 26178.2807  26.6%  4067  192s
   343   299 22592.1936    9  223 20680.6033 26178.2807  26.6%  3909  200s
   418   326     cutoff   11      20680.6033 26178.2807  26.6%  3747  207s
   498   343 20783.3066   12  105 20680.6033 26178.2807  26.6%  3688  214s
   568   381     cutoff   12      20680.6033 26178.2807  26.6%  3619  218s
   651   393     cutoff   13      20680.6033 26178.2807  26.6%  3507  225s
H  709   393                    20680.641270 26178.2807  26.6%  3454  225s
   728   421 25120.2585    6  318 20680.6413 26178.2807  26.6%  3473  232s
   812   450 24521.1190    8  319 20680.6413 26178.2807  26.6%  3360  237s
   882   474 24063.8053    9  251 20680.6413 26178.2807  26.6%  3289  243s
   943   513 23531.9611   10  302 20680.6413 26178.2807  26.6%  3361  247s
H  997   513                    20687.235312 25941.3524  25.4%  3354  247s
  1008   544 22774.4013   12  200 20687.2353 25941.3524  25.4%  3360  254s
  1057   570 22417.2824   13  206 20687.2353 25941.3369  25.4%  3373  259s
  1123   606 22149.2027   15  123 20687.2353 25941.3369  25.4%  3329  265s
  1196   644 21389.6701   21   99 20687.2353 25941.3369  25.4%  3312  271s
  1275   676     cutoff   28      20687.2353 25941.3369  25.4%  3308  276s
  1363   696 24370.8759    9  301 20687.2353 25941.3369  25.4%  3291  283s
  1407   742 23511.9692   10  303 20687.2353 25941.3369  25.4%  3327  290s
  1498   781 22400.2329   11  292 20687.2353 25941.3369  25.4%  3344  296s
H 1503   781                    20711.097978 25941.3369  25.3%  3345  297s
  1600   818 22288.6219   12  289 20711.0980 25809.2372  24.6%  3312  304s
  1719   842 21208.7174   14  174 20711.0980 25368.0699  22.5%  3288  312s
H 1756   842                    20717.913988 25368.0699  22.4%  3279  312s
  1785   862 21128.6967   15  171 20717.9140 25368.0699  22.4%  3279  319s
H 1927   903                    20722.487553 25368.0699  22.4%  3241  327s
  2043   917 21457.5523   11  213 20722.4876 24934.9372  20.3%  3243  332s
  2086   963     cutoff   12      20722.4876 24934.9372  20.3%  3270  339s
  2175  1006 infeasible   14      20722.4876 24788.7504  19.6%  3246  346s
  2308  1055 21311.9626   14  208 20722.4876 24641.6437  18.9%  3227  353s
  2454  1100 infeasible   16      20722.4876 24611.6086  18.8%  3217  361s
  2645  1170     cutoff   10      20722.4876 24584.7950  18.6%  3183  369s
  2864  1216 22014.8582   11  293 20722.4876 24584.7950  18.6%  3112  378s
  3073  1239     cutoff   12      20722.4876 24584.7950  18.6%  3066  387s
  3211  1283     cutoff   10      20722.4876 24584.7950  18.6%  3091  396s
  3397  1356 21262.9837   10  175 20722.4876 24288.7007  17.2%  3090  404s
  3612  1432 22522.9329   10  185 20722.4876 24288.7007  17.2%  3068  415s
  3802  1449 21766.2947   17  117 20722.4876 24157.2202  16.6%  3029  424s
  4007  1467 21329.5372   12  254 20722.4876 23994.4732  15.8%  3030  434s
  4193  1486     cutoff   14      20722.4876 23849.8793  15.1%  3022  444s
H 4241  1486                    20727.585068 23849.8793  15.1%  3029  444s
  4260  1479 20890.9049   14  151 20727.5851 23849.8793  15.1%  3036  453s
  4500  1441     cutoff   15      20727.5851 23849.8793  15.1%  3041  466s
  4734  1437 21076.0949   13  214 20727.5851 23658.8084  14.1%  3049  476s
  4929  1410 21090.6337   12  229 20727.5851 23437.7523  13.1%  3083  488s
  5126  1389     cutoff   13      20727.5851 23435.1059  13.1%  3085  499s
  5351  1395 21493.3736   12  273 20727.5851 23274.4108  12.3%  3110  511s
  5657  1363     cutoff   14      20727.5851 23174.3130  11.8%  3098  525s
  5922  1340 infeasible   16      20727.5851 23025.6333  11.1%  3113  537s
H 5923  1340                    20729.292434 23025.6333  11.1%  3112  537s
H 5986  1340                    20740.326113 23025.6333  11.0%  3107  537s
  6078  1308     cutoff   19      20740.3261 23025.6333  11.0%  3115  550s
  6414  1289     cutoff   20      20740.3261 22766.9803  9.77%  3097  564s
  6700  1271 20950.7581   16  231 20740.3261 22544.9883  8.70%  3084  579s
  7150  1296 21763.2963   14  175 20740.3261 22338.1295  7.70%  3025  592s
  7489  1382 21736.8962   18  166 20740.3261 22202.2107  7.05%  2963  606s
  7776  1598 infeasible   23      20740.3261 22139.7027  6.75%  2895  620s
  8600  1597 21615.0778   12  274 20740.3261 22025.2559  6.20%  2714  646s
  8602  1598 21706.1998   36   95 20740.3261 22025.2559  6.20%  2714  678s
  8603  1599 21172.8153   50  301 20740.3261 22025.2559  6.20%  2713  692s
  8604  1600 20892.4673   17  301 20740.3261 22025.2559  6.20%  2713  700s
  8605  1600 21643.8732   24  325 20740.3261 22025.2559  6.20%  2713  707s
  8606  1601 21486.3293   22  323 20740.3261 22025.2559  6.20%  2712  711s
  8607  1602 21516.6282   13  333 20740.3261 22025.2559  6.20%  2712  715s
  8609  1603 21582.0523   13  348 20740.3261 22025.2559  6.20%  2711  720s
  8610  1604 21452.6368   12  341 20740.3261 22025.2559  6.20%  2711  727s
  8612  1605 21248.3753   31  345 20740.3261 22025.2559  6.20%  2710  731s
  8614  1606 21067.4494   34  378 20740.3261 22025.2559  6.20%  2710  741s
  8615  1607 20879.0661   40  332 20740.3261 22025.2559  6.20%  2709  746s
  8616  1608 21395.8600   24  300 20740.3261 22025.2559  6.20%  2709  750s
  8617  1608 21615.0778   12  441 20740.3261 22025.2559  6.20%  2709  757s
  8618  1609 21477.7841   13  386 20740.3261 22025.2559  6.20%  2708  760s
  8619  1610 20971.0078   51  412 20740.3261 22025.2559  6.20%  2708  767s
  8620  1610 21327.3820   23  383 20740.3261 22025.2559  6.20%  2708  771s
  8621  1611 21025.4174   13  419 20740.3261 22025.2559  6.20%  2708  778s
  8622  1612 21611.3683   22  370 20740.3261 22025.2559  6.20%  2707  780s
  8623  1612 20832.6711   26  307 20740.3261 22025.2559  6.20%  2707  787s
  8625  1614 21362.1890   52  375 20740.3261 22025.2559  6.20%  2706  792s
  8626  1614 21057.1044   19  420 20740.3261 22025.2559  6.20%  2706  797s
  8627  1615 21042.1535   26  420 20740.3261 22025.2559  6.20%  2706  833s
  8628  1616 20849.0788   14  420 20740.3261 22025.2559  6.20%  2705  842s
  8629  1619 22025.2559   15  366 20740.3261 22025.2559  6.20%  2729  850s
  8631  1623 22025.2559   16  362 20740.3261 22025.2559  6.20%  2730  864s
  8635  1629 22025.2559   17  409 20740.3261 22025.2559  6.20%  2733  873s
  8643  1635 22025.2559   18  354 20740.3261 22025.2559  6.20%  2740  889s
  8651  1650 22025.2559   19  286 20740.3261 22025.2559  6.20%  2746  913s
  8675  1664 22025.2559   20  272 20740.3261 22025.2559  6.20%  2765  921s
  8707  1706 22025.2559   21  262 20740.3261 22025.2559  6.20%  2795  932s
  8771  1709 22025.2559   23  255 20740.3261 22025.2559  6.20%  2816  941s
  8821  1701 21318.8188   25  167 20740.3261 22025.2559  6.20%  2833  950s
  8899  1692 21790.9798   25  317 20740.3261 22025.2559  6.20%  2853  959s
  8960  1675 21255.6134   27  227 20740.3261 22025.2559  6.20%  2860  966s
  9045  1640     cutoff   30      20740.3261 22025.2559  6.20%  2863  975s
  9126  1616 21398.5368   20  202 20740.3261 22025.2559  6.20%  2867  983s
  9203  1569     cutoff   23      20740.3261 22025.2559  6.20%  2878  991s
  9301  1523 20746.4051   25  168 20740.3261 22025.2559  6.20%  2877 1000s
  9369  1496     cutoff   21      20740.3261 22025.2559  6.20%  2882 1007s
  9438  1460     cutoff   21      20740.3261 22025.2559  6.20%  2883 1014s
  9524  1407     cutoff   24      20740.3261 22025.2559  6.20%  2886 1019s
  9604  1362     cutoff   26      20740.3261 22025.2559  6.20%  2881 1026s
  9684  1324 20843.5314   23  247 20740.3261 22025.2559  6.20%  2881 1033s
  9742  1293 20833.4646   24  245 20740.3261 22025.2559  6.20%  2877 1038s
  9786  1272     cutoff   25      20740.3261 22025.2559  6.20%  2880 1044s
  9843  1243 21806.7439   23  200 20740.3261 22025.2559  6.20%  2875 1049s
  9899  1212 21792.6996   24  196 20740.3261 22025.2559  6.20%  2868 1055s
 10002  1173     cutoff   27      20740.3261 21724.4795  4.75%  2850 1064s
 10062  1158 21444.4176   31  125 20740.3261 21569.8175  4.00%  2836 1070s
 10210  1196 21179.0343   40  153 20740.3261 21179.0343  2.12%  2800 1077s
 10838  1198 20856.9116   63   36 20740.3261 21052.9873  1.51%  2646 1081s
 12204  1023 20791.0263   62   57 20740.3261 20949.5879  1.01%  2364 1086s
 14393   419 20753.6209   65   30 20740.3261 20834.3700  0.45%  2022 1091s

Cutting planes:
  Learned: 1
  Implied bound: 2
  MIR: 378
  Flow cover: 915
  RLT: 15
  Relax-and-lift: 71

Explored 16291 nodes (29456041 simplex iterations) in 1093.76 seconds (3440.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20740.3 20729.3 20727.6 ... 20660.2

Optimal solution found (tolerance 1.00e-04)
Best objective 2.074032611327e+04, best bound 2.074032611327e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1093.77s
  Master Objective (UB) = 20740.33, θ = 140391.15
  Upper Bound (UB) = 20740.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140391.15
  [DEBUG]   ✓ Scenario 0: θ = 140391.15 ≤ Q = 140391.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140391.15 ≤ Q = 140391.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140391.15 ≤ Q = 140391.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140391.15 ≤ Q = 140391.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140391.15 ≤ Q = 140391.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140391.15 ≤ Q = 140391.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140391.15 ≤ Q = 140391.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140391.15 ≤ Q = 140391.15 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3baa1a5d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3baa1a5d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7492361.5342
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.359870e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135986.99    0  123 7492361.53 -135986.99   102%     -    0s
H    0     0                    -101062.6828 -135986.99  34.6%     -    0s
     0     0 -106890.94    0  134 -101062.68 -106890.94  5.77%     -    0s
H    0     0                    -104033.8610 -106869.58  2.73%     -    0s
     0     0 -106059.32    0  138 -104033.86 -106059.32  1.95%     -    0s
H    0     0                    -104070.3457 -106000.04  1.85%     -    0s
     0     0 -106000.04    0  138 -104070.35 -106000.04  1.85%     -    0s
     0     0 -105602.10    0  142 -104070.35 -105602.10  1.47%     -    0s
     0     0 -105563.57    0  142 -104070.35 -105563.57  1.43%     -    0s
     0     0 -105437.75    0  139 -104070.35 -105437.75  1.31%     -    0s
     0     0 -105429.96    0  139 -104070.35 -105429.96  1.31%     -    0s
     0     2 -105428.13    0  139 -104070.35 -105428.13  1.30%     -    0s
H   32    57                    -104178.9806 -105204.06  0.98%  23.1    0s
H   40    57                    -104309.4141 -105195.84  0.85%  20.7    0s
H   48    54                    -104735.7076 -105195.84  0.44%  19.6    0s
H  112    67                    -104757.4659 -105171.72  0.40%  13.4    0s
H  147    67                    -104851.5449 -105171.72  0.31%  12.3    0s
H  348   103                    -104868.9039 -105091.73  0.21%   9.0    0s
H  422   103                    -104905.9798 -105062.65  0.15%   8.3    0s
H  438   103                    -104914.5834 -105062.65  0.14%   8.2    0s

Cutting planes:
  Gomory: 28
  Implied bound: 2
  MIR: 257
  RLT: 2
  BQP: 1

Explored 1337 nodes (7934 simplex iterations) in 0.12 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104915 -104906 -104869 ... -104034
No other solutions better than -104915

Optimal solution found (tolerance 1.00e-04)
Best objective -1.049145834270e+05, best bound -1.049145834270e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 139494.76
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104914.58
  [DEBUG]   S×d_nominal = 244409.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244409.34 + -104914.58 = 139494.76
  [DEBUG]   Current θ from Master = 140391.15
  [DEBUG]   ⚠️  Z_SP ≤ θ by 896.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19843.94
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 896.3893, Absolute Gap = 896.3893, Relative Gap = 0.043220
  Not converged yet (gap = 896.39 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394679 nonzeros
Model fingerprint: 0x29b4c0f1
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 60903 rows and 24723 columns
Presolve time: 1.08s
Presolved: 78090 rows, 33697 columns, 478406 nonzeros
Variable types: 31438 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 78090 rows, 33697 columns, 478406 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35835   -1.2504670e+05   0.000000e+00   5.710278e+07      5s
   47773   -5.2513457e+04   0.000000e+00   3.356767e+10     10s
   58130   -2.0212893e+04   0.000000e+00   7.750192e+08     15s
   67486   -2.5039181e+03   0.000000e+00   1.204867e+08     20s
   76052    5.1603368e+03   0.000000e+00   3.562719e+06     25s
   83246    1.2168215e+04   0.000000e+00   9.709774e+06     30s
Concurrent spin time: 8.15s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.168491e+04, 87183 iterations, 39.73 seconds (74.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41684.9127    0  177 -208513.72 41684.9127   120%     -   41s
H    0     0                    -197716.1697 41684.9127   121%     -   41s
H    0     0                    -146539.8642 41684.9127   128%     -   41s
H    0     0                    -146040.6261 41684.9127   129%     -   41s
H    0     0                    -40551.90398 41684.9127   203%     -   41s
H    0     0                    14588.705742 41684.9127   186%     -   42s
H    0     0                    15616.950205 41684.9127   167%     -   42s
H    0     0                    15651.513942 41684.9127   166%     -   42s
H    0     0                    15687.461527 41684.9127   166%     -   42s
H    0     0                    15737.418792 41684.9127   165%     -   42s
H    0     0                    15775.695870 41684.9127   164%     -   42s
H    0     0                    15778.287116 41684.9127   164%     -   42s
H    0     0                    15799.106155 36451.1195   131%     -   55s
     0     0 35741.2160    0  260 15799.1062 35741.2160   126%     -   55s
     0     0 35111.1657    0  265 15799.1062 35111.1657   122%     -   60s
H    0     0                    15910.937623 35111.1657   121%     -   64s
H    0     0                    15926.438757 35111.1657   120%     -   64s
H    0     0                    15930.957777 35111.1657   120%     -   64s
H    0     0                    15933.609144 35111.1657   120%     -   64s
H    0     0                    15956.121073 35111.1657   120%     -   64s
H    0     0                    15958.504165 35111.1657   120%     -   64s
H    0     0                    15960.717352 35111.1657   120%     -   64s
     0     0 35111.1657    0  257 15960.7174 35111.1657   120%     -   65s
     0     0 31181.3862    0  261 15960.7174 31181.3862  95.4%     -   70s
H    0     0                    15961.958834 31181.3862  95.3%     -   71s
H    0     0                    16080.268895 31181.3862  93.9%     -   71s
H    0     0                    16163.827428 31181.3862  92.9%     -   71s
H    0     0                    16177.170219 31181.3862  92.7%     -   71s
H    0     0                    16299.946941 31181.3862  91.3%     -   71s
H    0     0                    16309.785140 31181.3862  91.2%     -   71s
     0     0 31181.2300    0  262 16309.7851 31181.2300  91.2%     -   71s
     0     0 31181.2300    0  262 16309.7851 31181.2300  91.2%     -   71s
     0     0 31142.4503    0  231 16309.7851 31142.4503  90.9%     -   86s
H    0     0                    18063.907653 31142.4503  72.4%     -   86s
H    0     0                    18667.570216 31142.4503  66.8%     -   86s
H    0     0                    19071.653532 31142.4503  63.3%     -   86s
H    0     0                    19239.433725 31142.4503  61.9%     -   86s
H    0     0                    19242.159002 31142.4503  61.8%     -   86s
H    0     0                    19292.217233 31142.4503  61.4%     -   86s
H    0     0                    19293.917836 31142.4503  61.4%     -   86s
H    0     0                    19516.304062 31142.4503  59.6%     -   87s
     0     0 30776.4728    0  237 19516.3041 30776.4728  57.7%     -   94s
     0     0 30646.5981    0  241 19516.3041 30646.5981  57.0%     -   97s
     0     0 30583.1053    0  269 19516.3041 30583.1053  56.7%     -  101s
     0     0 30486.9941    0  278 19516.3041 30486.9941  56.2%     -  103s
H    0     0                    19546.566449 30403.4008  55.5%     -  105s
     0     0 30403.4008    0  278 19546.5664 30403.4008  55.5%     -  106s
     0     0 30386.2147    0  278 19546.5664 30386.2147  55.5%     -  107s
     0     0 30344.8454    0  334 19546.5664 30344.8454  55.2%     -  109s
H    0     0                    19552.854037 30303.3075  55.0%     -  112s
H    0     0                    19571.461471 30303.3075  54.8%     -  112s
H    0     0                    19578.950556 30303.3075  54.8%     -  112s
H    0     0                    19579.371638 30303.3075  54.8%     -  112s
     0     0 30303.3075    0  325 19579.3716 30303.3075  54.8%     -  112s
     0     0 30293.9380    0  331 19579.3716 30293.9380  54.7%     -  113s
     0     0 30293.5099    0  329 19579.3716 30293.5099  54.7%     -  113s
H    0     0                    19585.717124 28793.5517  47.0%     -  131s
H    0     0                    19593.206209 28793.5517  47.0%     -  131s
H    0     0                    19598.822544 28793.5517  46.9%     -  131s
H    0     0                    19699.000722 28793.5517  46.2%     -  131s
H    0     0                    19732.036256 28793.5517  45.9%     -  131s
H    0     0                    19739.525341 28793.5517  45.9%     -  131s
H    0     0                    19850.025240 28793.5517  45.1%     -  131s
H    0     0                    19860.452804 28793.5517  45.0%     -  131s
H    0     0                    20003.641221 28793.5517  43.9%     -  131s
H    0     0                    20025.627826 28793.5517  43.8%     -  131s
H    0     0                    20052.405116 28793.5517  43.6%     -  131s
H    0     0                    20110.601644 28793.5517  43.2%     -  131s
H    0     0                    20148.195080 28793.5517  42.9%     -  131s
H    0     0                    20180.964034 28793.5517  42.7%     -  131s
H    0     0                    20245.039955 28793.5517  42.2%     -  131s
H    0     0                    20278.870683 28793.5517  42.0%     -  131s
H    0     0                    20296.297369 28793.5517  41.9%     -  131s
     0     0 28793.5517    0  332 20296.2974 28793.5517  41.9%     -  131s
H    0     0                    20439.215591 28792.0725  40.9%     -  131s
H    0     0                    20458.209030 28792.0725  40.7%     -  131s
H    0     0                    20547.591463 28792.0725  40.1%     -  131s
     0     0 28362.0487    0  384 20547.5915 28362.0487  38.0%     -  138s
     0     0 28183.1347    0  327 20547.5915 28183.1347  37.2%     -  143s
     0     0 28110.3302    0  387 20547.5915 28110.3302  36.8%     -  144s
     0     0 28049.6932    0  389 20547.5915 28049.6932  36.5%     -  147s
     0     0 28036.5117    0  393 20547.5915 28036.5117  36.4%     -  148s
     0     0 28027.7006    0  392 20547.5915 28027.7006  36.4%     -  150s
     0     0 28026.2914    0  389 20547.5915 28026.2914  36.4%     -  150s
     0     0 27659.2816    0  397 20547.5915 27659.2816  34.6%     -  160s
     0     0 27484.4175    0  301 20547.5915 27484.4175  33.8%     -  166s
     0     0 27453.5423    0  348 20547.5915 27453.5423  33.6%     -  168s
     0     0 27443.9820    0  356 20547.5915 27443.9820  33.6%     -  169s
     0     0 27438.0398    0  348 20547.5915 27438.0398  33.5%     -  170s
     0     0 27432.7142    0  345 20547.5915 27432.7142  33.5%     -  170s
     0     0 27431.7960    0  348 20547.5915 27431.7960  33.5%     -  171s
     0     0 27377.6079    0  341 20547.5915 27377.6079  33.2%     -  176s
     0     0 27367.3709    0  329 20547.5915 27367.3709  33.2%     -  178s
     0     0 27365.8564    0  330 20547.5915 27365.8564  33.2%     -  179s
     0     0 27353.1375    0  327 20547.5915 27353.1375  33.1%     -  182s
     0     0 27352.7898    0  275 20547.5915 27352.7898  33.1%     -  185s
     0     0 27344.1218    0  319 20547.5915 27344.1218  33.1%     -  187s
H    0     0                    20553.955293 27343.9556  33.0%     -  187s
H    0     0                    20653.562258 27343.9556  32.4%     -  187s
H    0     0                    20696.899560 27343.9556  32.1%     -  187s
     0     0 27343.2688    0  326 20696.8996 27343.2688  32.1%     -  188s
     0     0 27342.5914    0  378 20696.8996 27342.5914  32.1%     -  190s
H    0     0                    20710.303555 27342.1223  32.0%     -  191s
     0     0 27342.1223    0  263 20710.3036 27342.1223  32.0%     -  191s
     0     0 27342.0295    0  375 20710.3036 27342.0295  32.0%     -  192s
     0     0 27341.8605    0  373 20710.3036 27341.8605  32.0%     -  193s
     0     0 27341.3059    0  269 20710.3036 27341.3059  32.0%     -  194s
     0     0 27340.3492    0  323 20710.3036 27340.3492  32.0%     -  197s
     0     0 27337.8204    0  324 20710.3036 27337.8204  32.0%     -  198s
     0     0 27333.4714    0  324 20710.3036 27333.4714  32.0%     -  200s
     0     2 27333.4714    0  324 20710.3036 27333.4714  32.0%     -  228s
     1     3 26840.5159    1  275 20710.3036 27333.4714  32.0%  8480  233s
     2     5 26266.0280    2  283 20710.3036 27333.4714  32.0%  9040  240s
     4    10 26716.7714    2  345 20710.3036 27115.6751  30.9%  8139  247s
     9    20 26461.7279    3  286 20710.3036 26965.5404  30.2%  7766  257s
    19    30 25513.5189    4  293 20710.3036 26583.1851  28.4% 10097  273s
    29    60 25192.5699    5  284 20710.3036 26583.1851  28.4%  9387  301s
    59    92 24836.2291    6  337 20710.3036 26059.4947  25.8% 11734  314s
    91   203 24438.4088    7  330 20710.3036 25779.9326  24.5% 11060  328s
   206   267 24312.2759   10  325 20710.3036 25779.7712  24.5%  7454  337s
   281   293 23989.0253   11  252 20710.3036 25779.7712  24.5%  6613  345s
   315   324 23840.5930   12  251 20710.3036 25779.7712  24.5%  6552  353s
   356   347 23542.9620   14  255 20710.3036 25779.7712  24.5%  6551  361s
   391   370 23407.2855   15  246 20710.3036 25779.7712  24.5%  6457  369s
   426   392 23389.4750   16  248 20710.3036 25779.7712  24.5%  6295  377s
   464   413 23332.1622   17  252 20710.3036 25736.7332  24.3%  6211  387s
   505   434 22451.8134   18  230 20710.3036 25736.7332  24.3%  6017  396s
   546   466 22299.8220   19  231 20710.3036 25736.7332  24.3%  6022  402s
   592   497 22022.1282   20  225 20710.3036 25736.7332  24.3%  5872  411s
   631   531 21743.2541   21  219 20710.3036 25587.6067  23.6%  5873  418s
   675   573 21430.8717   22  212 20710.3036 25587.6067  23.6%  5815  426s
   729   603     cutoff   23      20710.3036 25190.9024  21.6%  5697  435s
   784   630 infeasible   23      20710.3036 25190.9024  21.6%  5583  442s
H  789   630                    20715.507314 25190.9024  21.6%  5572  442s
   835   681 20917.2244   23  221 20715.5073 25190.9024  21.6%  5510  451s
   926   720 20883.9020   24  219 20715.5073 25190.9024  21.6%  5328  460s
  1017   778 20893.0238   14  139 20715.5073 25190.9024  21.6%  5210  468s
  1115   808     cutoff   15      20715.5073 25190.9024  21.6%  5075  478s
  1223   855 20761.3531   10  346 20715.5073 25190.9024  21.6%  4957  488s
  1330   883     cutoff   11      20715.5073 25190.9024  21.6%  4846  498s
  1436   905 22607.9033    6  258 20715.5073 24792.4891  19.7%  4843  509s
  1537   912 21388.9597    7  240 20715.5073 24653.2861  19.0%  4793  519s
  1636   929 20864.2464   13  166 20715.5073 24653.2861  19.0%  4767  531s
  1731   970 22563.0720    9  313 20715.5073 24647.5714  19.0%  4765  541s
H 1841   984                    20719.423491 24575.8573  18.6%  4773  553s
  1893  1036 21008.0405   11  306 20719.4235 24295.8234  17.3%  4807  563s
  2042  1074     cutoff   14      20719.4235 24295.8234  17.3%  4747  576s
  2224  1102     cutoff   10      20719.4235 24220.1673  16.9%  4616  588s
  2418  1186 22028.4976    8  150 20719.4235 24220.1673  16.9%  4477  601s
  2633  1218 21220.0232   15   71 20719.4235 24149.4353  16.6%  4339  614s
  2810  1243 21318.3435   13  258 20719.4235 24054.9640  16.1%  4270  624s
  2849  1262 21200.8717   14  264 20719.4235 24054.9640  16.1%  4295  634s
  2893  1270     cutoff   15      20719.4235 24054.9640  16.1%  4314  647s
  2956  1302 21975.3203   10  223 20719.4235 23949.8492  15.6%  4314  657s
  3022  1364 21479.3654   11  224 20719.4235 23938.8826  15.5%  4298  670s
  3172  1421 21079.9640   12  183 20719.4235 23938.8826  15.5%  4205  684s
  3378  1523 20767.6300   17  179 20719.4235 23921.0887  15.5%  4110  700s
  3629  1617 22042.7294   15  271 20719.4235 23921.0887  15.5%  4010  718s
  3882  1646 21210.2205   20  304 20719.4235 23921.0887  15.5%  3950  734s
  4166  1723 21004.6807   15  226 20719.4235 23659.0618  14.2%  3894  751s
  4440  1813     cutoff   20      20719.4235 23448.0508  13.2%  3875  769s
  4799  1905 infeasible   13      20719.4235 23438.1103  13.1%  3778  786s
  5110  1999 20735.6349   15  192 20719.4235 23416.6137  13.0%  3702  805s
  5489  2108 21952.1746   10  259 20719.4235 23347.7928  12.7%  3625  823s
  5908  2130 21496.9812   28  199 20719.4235 23214.0859  12.0%  3550  841s
  6296  2127 21342.3813   12  194 20719.4235 22951.9043  10.8%  3511  860s
  6576  2129 21089.7403   16  149 20719.4235 22858.6694  10.3%  3500  880s
  6951  2122     cutoff   14      20719.4235 22622.8549  9.19%  3486  902s
  7359  2304 20866.3050   22  127 20719.4235 22419.3843  8.20%  3455  923s
  7975  2540     cutoff   15      20719.4235 22300.5685  7.63%  3347  943s
  8550  2541 21448.8829   24  324 20719.4235 22170.2659  7.00%  3229  983s
  8552  2542 21093.6929   16  141 20719.4235 22170.2659  7.00%  3228 1018s
  8553  2543 21372.2046   14  346 20719.4235 22170.2659  7.00%  3228 1037s
  8554  2544 22036.4255   16  321 20719.4235 22170.2659  7.00%  3227 1050s
  8555  2544 21176.8839   31  342 20719.4235 22170.2659  7.00%  3227 1059s
  8556  2545 21720.2548   21  281 20719.4235 22170.2659  7.00%  3227 1064s
  8557  2546 21389.7663   17  354 20719.4235 22170.2659  7.00%  3226 1066s
  8559  2547 21449.0856   28  274 20719.4235 22170.2659  7.00%  3225 1075s
  8561  2548 21516.9604   17  325 20719.4235 22170.2659  7.00%  3225 1082s
  8562  2549 21168.4761   15  331 20719.4235 22170.2659  7.00%  3224 1086s
  8563  2550 21367.3226   14  307 20719.4235 22170.2659  7.00%  3224 1093s
  8564  2550 21426.5310   18  369 20719.4235 22170.2659  7.00%  3223 1098s
  8565  2551 21302.4026   27  289 20719.4235 22170.2659  7.00%  3223 1105s
  8568  2553 21204.8264   26  337 20719.4235 22170.2659  7.00%  3222 1115s
  8570  2554 21574.5880   33  341 20719.4235 22170.2659  7.00%  3221 1121s
  8571  2555 21349.6939   43  404 20719.4235 22170.2659  7.00%  3221 1129s
  8572  2556 20892.4860   44  344 20719.4235 22170.2659  7.00%  3220 1134s
  8573  2556 21785.3837   15  414 20719.4235 22170.2659  7.00%  3220 1137s
  8574  2557 20745.4805   13  421 20719.4235 22170.2659  7.00%  3220 1142s
  8575  2558 21768.0227   25  461 20719.4235 22170.2659  7.00%  3219 1148s
  8576  2558 21701.9283   12  461 20719.4235 22170.2659  7.00%  3219 1181s
  8577  2559 21440.7230   11  461 20719.4235 22170.2659  7.00%  3219 1198s
  8578  2563 22170.2659   11  395 20719.4235 22170.2659  7.00%  3244 1212s
  8580  2566 22170.2659   12  449 20719.4235 22170.2659  7.00%  3244 1218s
  8584  2573 22170.2659   13  389 20719.4235 22170.2659  7.00%  3246 1232s
  8592  2578 22170.2659   14  301 20719.4235 22170.2659  7.00%  3249 1251s
  8600  2597 22170.2659   15  281 20719.4235 22170.2659  7.00%  3256 1278s
  8624  2619 22170.2659   16  277 20719.4235 22170.2659  7.00%  3306 1298s
  8656  2618 21296.7934   17  284 20719.4235 22170.2659  7.00%  3316 1316s
  8718  2595 22170.2659   17  316 20719.4235 22170.2659  7.00%  3339 1330s
  8783  2603 21591.7875   18  392 20719.4235 22170.2659  7.00%  3368 1343s
  8845  2614 20953.1177   19  249 20719.4235 22170.2659  7.00%  3372 1355s
  8957  2577 infeasible   21      20719.4235 22170.2659  7.00%  3354 1366s
  9045  2556     cutoff   20      20719.4235 22170.2659  7.00%  3343 1376s
  9160  2527 21797.0709   17  222 20719.4235 22170.2659  7.00%  3320 1387s
  9256  2489 21679.1164   18  226 20719.4235 22170.2659  7.00%  3301 1395s
  9344  2480     cutoff   19      20719.4235 22170.2659  7.00%  3285 1403s
  9439  2465 21087.3296   18  187 20719.4235 22170.2659  7.00%  3268 1410s
  9544  2432     cutoff   19      20719.4235 22170.2659  7.00%  3245 1416s
  9587  2418     cutoff   33      20719.4235 22170.2659  7.00%  3237 1424s
  9627  2396     cutoff   29      20719.4235 22170.2659  7.00%  3229 1431s
  9678  2381 21140.3143   19  268 20719.4235 22170.2659  7.00%  3219 1436s
  9742  2364     cutoff   19      20719.4235 22170.2659  7.00%  3203 1444s
  9848  2329 21492.4802   25  268 20719.4235 22170.2659  7.00%  3177 1451s
  9994  2301 21475.7278   27  229 20719.4235 22170.2659  7.00%  3143 1458s
 10174  2261 21320.6818   31   79 20719.4235 22170.2659  7.00%  3097 1464s
 10352  2231 21105.7796   34  102 20719.4235 22170.2659  7.00%  3054 1474s
 10564  2193 20938.5617   36   49 20719.4235 22170.2659  7.00%  3005 1481s
 10827  2114 20772.9800   40   53 20719.4235 21819.8924  5.31%  2944 1489s
 11157  2073 21281.1515   18  300 20719.4235 21810.2080  5.26%  2870 1493s
 11575  2088 21144.7531   20  271 20719.4235 21810.2080  5.26%  2777 1497s
 12039  2055 20980.3612   24  163 20719.4235 21808.7806  5.26%  2680 1502s
 13447  1960 20769.0229   74   31 20719.4235 21280.9627  2.71%  2419 1507s
 14377  1880     cutoff   45      20719.4235 20967.4693  1.20%  2273 1510s
 16576  1378 20729.2048   57   36 20719.4235 20911.0167  0.92%  1989 1515s
 16722  1375     cutoff   58      20719.4235 20901.2896  0.88%  1974 1521s
 16829  1381 20839.3274   57   36 20719.4235 20894.3720  0.84%  1962 1525s
 17010  1448 20751.2329   58   39 20719.4235 20894.3720  0.84%  1943 1530s
 18673  1596 20745.7497   49   36 20719.4235 20881.1656  0.78%  1781 1538s
 19479  1644 20763.9790   64   36 20719.4235 20868.7575  0.72%  1713 1541s
 21592  1646     cutoff   66      20719.4235 20841.2182  0.59%  1558 1546s
 24172  1277 20720.4919   78   41 20719.4235 20813.4904  0.45%  1405 1552s
 25808   514 20736.2432   67   16 20719.4235 20807.0405  0.42%  1323 1555s

Cutting planes:
  Learned: 1
  Gomory: 21
  Projected implied bound: 75
  MIR: 747
  Mixing: 1
  Flow cover: 1235
  RLT: 17
  Relax-and-lift: 111

Explored 28808 nodes (34641459 simplex iterations) in 1556.41 seconds (4800.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20719.4 20710.3 20696.9 ... 20278.9

Optimal solution found (tolerance 1.00e-04)
Best objective 2.071942349107e+04, best bound 2.071942349107e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1556.44s
  Master Objective (UB) = 20719.42, θ = 140721.93
  Upper Bound (UB) = 20719.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140721.93
  [DEBUG]   ✓ Scenario 0: θ = 140721.93 ≤ Q = 160973.59 (slack: 20251.66)
  [DEBUG]   ✓ Scenario 1: θ = 140721.93 ≤ Q = 140738.01 (slack: 16.08)
  [DEBUG]   ✓ Scenario 2: θ = 140721.93 ≤ Q = 140721.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140721.93 ≤ Q = 140721.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140721.93 ≤ Q = 140721.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140721.93 ≤ Q = 140721.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140721.93 ≤ Q = 140721.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140721.93 ≤ Q = 140721.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140721.93 ≤ Q = 140721.93 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2a4e8747
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2a4e8747
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7501584.0145
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.356260e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135625.95    0  123 7501584.01 -135625.95   102%     -    0s
H    0     0                    -100731.1864 -135625.95  34.6%     -    0s
     0     0 -106698.54    0  119 -100731.19 -106698.54  5.92%     -    0s
H    0     0                    -104852.7081 -106637.91  1.70%     -    0s
     0     0 -106052.39    0   81 -104852.71 -106052.39  1.14%     -    0s
H    0     0                    -105032.5273 -106039.13  0.96%     -    0s
H    0     0                    -105597.3950 -106039.13  0.42%     -    0s
H    0     0                    -105752.1789 -106039.13  0.27%     -    0s
     0     0 -106032.49    0   80 -105752.18 -106032.49  0.27%     -    0s
     0     0 -106008.35    0   55 -105752.18 -106008.35  0.24%     -    0s
     0     0 -106008.00    0   54 -105752.18 -106008.00  0.24%     -    0s
H    0     0                    -105803.1330 -105973.37  0.16%     -    0s
     0     0 -105973.37    0   56 -105803.13 -105973.37  0.16%     -    0s
     0     0 -105904.51    0    8 -105803.13 -105904.51  0.10%     -    0s
     0     0 -105891.70    0    9 -105803.13 -105891.70  0.08%     -    0s
     0     0 -105891.70    0    9 -105803.13 -105891.70  0.08%     -    0s
     0     0 -105891.70    0    9 -105803.13 -105891.70  0.08%     -    0s
H    0     0                    -105819.6997 -105891.70  0.07%     -    0s
H    0     0                    -105869.1187 -105891.70  0.02%     -    0s
     0     0 -105891.70    0   64 -105869.12 -105891.70  0.02%     -    0s
     0     0 -105891.70    0   13 -105869.12 -105891.70  0.02%     -    0s
     0     0          -    0      -105869.12 -105878.73  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 25
  MIR: 69
  Flow cover: 1

Explored 1 nodes (823 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105869 -105820 -105803 ... 1.4374e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.058691187384e+05, best bound -1.058787297622e+05, gap 0.0091%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 138496.22
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105869.12
  [DEBUG]   S×d_nominal = 244365.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244365.34 + -105869.12 = 138496.22
  [DEBUG]   Current θ from Master = 140721.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2225.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18493.72
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 875.4866, Absolute Gap = 875.4866, Relative Gap = 0.042254
  Not converged yet (gap = 875.49 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437919 nonzeros
Model fingerprint: 0x0972bfec
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67670 rows and 27470 columns
Presolve time: 1.24s
Presolved: 86613 rows, 37190 columns, 528475 nonzeros
Variable types: 34931 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -358856.2339
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.664e+06
 Factor NZ  : 7.896e+06 (roughly 110 MB of memory)
 Factor Ops : 1.324e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78942066e+07  1.53384672e+08  1.02e+05 2.55e+01  7.28e+04     2s
   1  -1.33924122e+07  1.33596327e+08  7.11e+04 7.64e+01  4.99e+04     2s
   2  -3.95720371e+06  9.88239921e+07  2.08e+04 1.96e-11  1.55e+04     2s
   3  -7.81888753e+05  6.72992615e+07  1.81e+03 1.06e+00  1.68e+03     2s
   4  -4.67049501e+05  2.34750122e+07  3.80e+02 2.00e-01  3.80e+02     2s
   5  -3.22203893e+05  1.64251063e+07  1.16e+02 1.21e-01  1.70e+02     2s
   6  -2.06518918e+05  1.28771658e+07  4.61e+01 8.93e-02  1.06e+02     2s
   7  -1.51795748e+05  9.24954310e+06  2.56e+01 6.00e-02  6.97e+01     2s
   8  -1.10553206e+05  6.43116243e+06  1.46e+01 3.94e-02  4.58e+01     3s
   9  -8.49015694e+04  4.38283076e+06  8.40e+00 2.58e-02  3.01e+01     3s
  10  -6.36184861e+04  1.57219280e+06  4.81e+00 8.50e-03  1.08e+01     3s
  11  -2.27197234e+04  4.76803934e+05  1.80e+00 2.03e-03  3.21e+00     3s
  12  -1.27135293e+04  2.21010210e+05  1.27e+00 1.11e-03  1.50e+00     3s
  13  -5.27541701e+03  1.81660398e+05  9.52e-01 9.23e-04  1.19e+00     3s
  14   8.76933955e+01  1.27515255e+05  7.84e-01 8.68e-04  8.12e-01     3s
  15   6.08420165e+03  1.01422058e+05  6.39e-01 1.13e-03  6.07e-01     3s
  16   1.14945215e+04  8.32169432e+04  5.22e-01 1.52e-03  4.56e-01     3s
  17   1.65881048e+04  7.49137431e+04  4.21e-01 1.58e-03  3.71e-01     3s
  18   2.14468979e+04  6.39393116e+04  3.26e-01 1.36e-03  2.70e-01     3s
  19   2.49266404e+04  5.95957182e+04  2.64e-01 1.14e-03  2.20e-01     3s
  20   2.79360667e+04  5.39952712e+04  2.11e-01 2.55e-03  1.65e-01     3s
  21   3.12780632e+04  5.22762711e+04  1.54e-01 2.10e-03  1.33e-01     3s
  22   3.29827765e+04  5.05537495e+04  1.29e-01 1.82e-03  1.11e-01     3s
  23   3.65513464e+04  4.80407117e+04  7.43e-02 2.26e-03  7.28e-02     3s
  24   3.76770996e+04  4.69026585e+04  5.86e-02 1.90e-03  5.84e-02     3s
  25   3.81510599e+04  4.58477526e+04  5.23e-02 1.30e-03  4.88e-02     3s
  26   3.92741080e+04  4.48498630e+04  3.77e-02 1.18e-03  3.53e-02     3s
  27   3.95893517e+04  4.44153053e+04  3.35e-02 9.33e-04  3.06e-02     3s
  28   4.02847246e+04  4.40082946e+04  2.53e-02 9.99e-04  2.36e-02     3s
  29   4.06247418e+04  4.36076374e+04  2.13e-02 1.01e-03  1.89e-02     3s
  30   4.11320716e+04  4.31357427e+04  1.55e-02 6.09e-04  1.27e-02     3s
  31   4.15870958e+04  4.30322659e+04  1.02e-02 4.94e-04  9.16e-03     3s
  32   4.18622035e+04  4.28022796e+04  7.15e-03 4.04e-04  5.96e-03     3s
  33   4.20024491e+04  4.27414328e+04  5.56e-03 3.17e-04  4.68e-03     3s
  34   4.20278281e+04  4.27256920e+04  5.26e-03 2.95e-04  4.42e-03     3s
  35   4.21071053e+04  4.27074474e+04  4.42e-03 2.61e-04  3.80e-03     3s
  36   4.21628748e+04  4.26673995e+04  3.82e-03 2.07e-04  3.20e-03     3s
  37   4.22934341e+04  4.25863458e+04  2.36e-03 9.43e-05  1.86e-03     4s
  38   4.23126899e+04  4.25635480e+04  2.15e-03 6.31e-05  1.59e-03     4s
  39   4.23647813e+04  4.25577635e+04  1.61e-03 5.59e-05  1.22e-03     4s
  40   4.23938344e+04  4.25428126e+04  1.27e-03 3.68e-05  9.45e-04     4s
  41   4.24110616e+04  4.25418305e+04  1.09e-03 3.53e-05  8.30e-04     4s
  42   4.24191344e+04  4.25384729e+04  1.00e-03 3.05e-05  7.57e-04     4s
  43   4.24471647e+04  4.25321207e+04  6.98e-04 2.94e-05  5.39e-04     4s
  44   4.24838834e+04  4.25193527e+04  3.10e-04 8.44e-05  2.25e-04     4s
  45   4.24874263e+04  4.25189550e+04  2.72e-04 7.88e-05  2.00e-04     4s
  46   4.24900836e+04  4.25188718e+04  2.46e-04 7.52e-05  1.83e-04     4s
  47   4.24925643e+04  4.25179440e+04  2.16e-04 6.32e-05  1.61e-04     4s
  48   4.24932964e+04  4.25169597e+04  2.09e-04 3.74e-05  1.50e-04     4s
  49   4.24943885e+04  4.25159694e+04  1.98e-04 2.54e-05  1.37e-04     4s
  50   4.24963990e+04  4.25154428e+04  1.76e-04 2.01e-05  1.21e-04     4s
  51   4.25022915e+04  4.25148569e+04  1.10e-04 1.47e-05  7.97e-05     4s
  52   4.25057714e+04  4.25146994e+04  7.61e-05 9.36e-06  5.67e-05     4s
  53   4.25076222e+04  4.25143605e+04  5.72e-05 7.20e-06  4.28e-05     4s
  54   4.25091692e+04  4.25144676e+04  4.26e-05 6.88e-06  3.36e-05     4s
  55   4.25094195e+04  4.25141164e+04  3.99e-05 4.03e-06  2.98e-05     4s
  56   4.25095660e+04  4.25139717e+04  3.81e-05 2.96e-06  2.80e-05     4s
  57   4.25107024e+04  4.25137989e+04  2.71e-05 1.84e-06  1.97e-05     4s
  58   4.25121774e+04  4.25137021e+04  1.28e-05 8.26e-07  9.67e-06     4s
  59   4.25126691e+04  4.25137538e+04  8.25e-06 5.23e-07  6.87e-06     4s
  60   4.25133727e+04  4.25136552e+04  1.49e-06 2.41e-07  1.79e-06     4s
  61   4.25133818e+04  4.25136044e+04  1.43e-06 1.79e-08  1.41e-06     4s
  62   4.25135545e+04  4.25135684e+04  7.62e-08 8.06e-10  8.73e-08     5s
  63   4.25135551e+04  4.25135681e+04  1.32e-05 1.67e-09  8.06e-08     5s
  64   4.25135598e+04  4.25135607e+04  1.92e-06 8.98e-08  5.18e-09     5s
  65   4.25135606e+04  4.25135606e+04  7.32e-07 2.42e-08  7.58e-10     5s

Barrier solved model in 65 iterations and 4.63 seconds (8.91 work units)
Optimal objective 4.25135606e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    5168 PPushes remaining with PInf 2.4433581e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2365249e+01      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36094    4.2513561e+04   0.000000e+00   3.236525e+01      7s
   36119    4.2513561e+04   0.000000e+00   0.000000e+00      7s
   36119    4.2513561e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.77s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.251356e+04, 36119 iterations, 5.87 seconds (12.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42513.5606    0  335 -208513.72 42513.5606   120%     -    7s
H    0     0                    -199468.7808 42513.5606   121%     -    7s
H    0     0                    -142396.0163 42513.5606   130%     -    8s
H    0     0                    -141706.6765 42513.5606   130%     -    8s
H    0     0                    -141618.6771 42513.5606   130%     -    8s
H    0     0                    -45837.14663 42513.5606   193%     -    8s
H    0     0                    16415.980629 42513.5606   159%     -    8s
H    0     0                    16455.490580 42513.5606   158%     -    9s
H    0     0                    16713.955425 42513.5606   154%     -    9s
H    0     0                    16718.513485 42513.5606   154%     -    9s
H    0     0                    16774.009633 42513.5606   153%     -    9s
H    0     0                    16844.985200 42513.5606   152%     -    9s
H    0     0                    16845.461106 42513.5606   152%     -    9s
H    0     0                    16857.261291 42513.5606   152%     -    9s
H    0     0                    16897.933287 42513.5606   152%     -    9s
H    0     0                    16921.743700 42513.5606   151%     -    9s
     0     0 37318.5769    0  229 16921.7437 37318.5769   121%     -   26s
     0     0 36159.4139    0  229 16921.7437 36159.4139   114%     -   40s
     0     0 35985.6394    0  242 16921.7437 35985.6394   113%     -   46s
     0     0 35957.8000    0  298 16921.7437 35957.8000   112%     -   48s
     0     0 35650.1913    0  317 16921.7437 35650.1913   111%     -   54s
     0     0 35616.8121    0  312 16921.7437 35616.8121   110%     -   61s
     0     0 35614.3333    0  314 16921.7437 35614.3333   110%     -   62s
     0     0 35614.3057    0  314 16921.7437 35614.3057   110%     -   62s
     0     0 32013.4567    0  346 16921.7437 32013.4567  89.2%     -   90s
H    0     0                    19355.706789 32013.2374  65.4%     -   90s
H    0     0                    19478.578738 32013.2374  64.4%     -   90s
H    0     0                    19528.648886 32013.2374  63.9%     -   90s
H    0     0                    19593.803888 32013.2374  63.4%     -   90s
H    0     0                    19936.799482 31464.0467  57.8%     -  106s
H    0     0                    19943.220431 31464.0467  57.8%     -  106s
H    0     0                    19944.489309 31464.0467  57.8%     -  106s
H    0     0                    19983.186103 31464.0467  57.5%     -  106s
     0     0 31464.0467    0  380 19983.1861 31464.0467  57.5%     -  106s
     0     0 30932.8531    0  312 19983.1861 30932.8531  54.8%     -  119s
     0     0 30877.6410    0  373 19983.1861 30877.6410  54.5%     -  123s
     0     0 30867.7779    0  377 19983.1861 30867.7779  54.5%     -  125s
     0     0 30829.1320    0  389 19983.1861 30829.1320  54.3%     -  128s
H    0     0                    20001.288107 30589.2729  52.9%     -  134s
H    0     0                    20017.674415 30589.2729  52.8%     -  134s
     0     0 30589.2729    0  335 20017.6744 30589.2729  52.8%     -  134s
     0     0 30578.1631    0  374 20017.6744 30578.1631  52.8%     -  135s
     0     0 30575.1523    0  377 20017.6744 30575.1523  52.7%     -  137s
H    0     0                    20057.928534 30570.8293  52.4%     -  138s
H    0     0                    20065.417619 30570.8293  52.4%     -  138s
     0     0 30570.8293    0  346 20065.4176 30570.8293  52.4%     -  138s
     0     0 30569.6990    0  345 20065.4176 30569.6990  52.4%     -  139s
     0     0 28993.0305    0  354 20065.4176 28993.0305  44.5%     -  164s
     0     0 28526.6371    0  322 20065.4176 28526.6371  42.2%     -  179s
     0     0 28399.6838    0  337 20065.4176 28399.6838  41.5%     -  187s
     0     0 28329.5053    0  409 20065.4176 28329.5053  41.2%     -  192s
     0     0 28285.2069    0  408 20065.4176 28285.2069  41.0%     -  196s
     0     0 28255.9268    0  306 20065.4176 28255.9268  40.8%     -  200s
     0     0 28200.5190    0  297 20065.4176 28200.5190  40.5%     -  204s
     0     0 28181.8623    0  357 20065.4176 28181.8623  40.4%     -  205s
H    0     0                    20224.082430 28147.3313  39.2%     -  207s
H    0     0                    20335.593876 28147.3313  38.4%     -  207s
H    0     0                    20356.338658 28147.3313  38.3%     -  207s
H    0     0                    20381.644202 28147.3313  38.1%     -  207s
H    0     0                    20388.144529 28147.3313  38.1%     -  207s
     0     0 28147.3313    0  298 20388.1445 28147.3313  38.1%     -  207s
     0     0 28108.0852    0  287 20388.1445 28108.0852  37.9%     -  208s
     0     0 28104.9438    0  289 20388.1445 28104.9438  37.8%     -  209s
     0     0 28096.4449    0  290 20388.1445 28096.4449  37.8%     -  211s
     0     0 28095.1561    0  298 20388.1445 28095.1561  37.8%     -  212s
H    0     0                    20432.908490 27773.1912  35.9%     -  224s
     0     0 27773.1912    0  277 20432.9085 27773.1912  35.9%     -  224s
     0     0 27605.4612    0  353 20432.9085 27605.4612  35.1%     -  233s
     0     0 27587.0999    0  410 20432.9085 27587.0999  35.0%     -  236s
     0     0 27581.1316    0  345 20432.9085 27581.1316  35.0%     -  238s
     0     0 27570.5125    0  346 20432.9085 27570.5125  34.9%     -  239s
     0     0 27569.2963    0  343 20432.9085 27569.2963  34.9%     -  240s
     0     0 27395.2891    0  283 20432.9085 27395.2891  34.1%     -  248s
     0     0 27384.9810    0  283 20432.9085 27384.9810  34.0%     -  252s
     0     0 27381.6159    0  342 20432.9085 27381.6159  34.0%     -  254s
     0     0 27379.1097    0  274 20432.9085 27379.1097  34.0%     -  255s
     0     0 27376.7648    0  270 20432.9085 27376.7648  34.0%     -  257s
     0     0 27375.9773    0  261 20432.9085 27375.9773  34.0%     -  258s
     0     0 27359.0331    0  284 20432.9085 27359.0331  33.9%     -  261s
     0     0 27357.2326    0  281 20432.9085 27357.2326  33.9%     -  263s
     0     0 27353.2613    0  326 20432.9085 27353.2613  33.9%     -  266s
     0     0 27352.9610    0  326 20432.9085 27352.9610  33.9%     -  267s
     0     0 27352.6548    0  334 20432.9085 27352.6548  33.9%     -  268s
     0     0 27352.1121    0  332 20432.9085 27352.1121  33.9%     -  269s
     0     0 27352.0584    0  320 20432.9085 27352.0584  33.9%     -  270s
H    0     0                    20475.096900 27351.0377  33.6%     -  271s
     0     0 27351.0377    0  273 20475.0969 27351.0377  33.6%     -  272s
     0     0 27349.2733    0  275 20475.0969 27349.2733  33.6%     -  273s
     0     0 27349.2439    0  275 20475.0969 27349.2439  33.6%     -  274s
     0     2 27349.2439    0  275 20475.0969 27349.2439  33.6%     -  305s
     1     3 26915.8345    1  264 20475.0969 27349.2439  33.6% 11420  314s
     2     5 26722.5823    2  260 20475.0969 27349.2439  33.6%  8849  321s
     4    10 26963.6997    2  404 20475.0969 27159.3552  32.6%  8255  327s
     9    20 26508.3111    3  344 20475.0969 26963.4618  31.7%  6574  337s
    19    40 26442.6146    4  336 20475.0969 26678.8762  30.3%  7581  349s
    39    52 25870.7858    5  336 20475.0969 26562.7838  29.7% 10083  372s
H   51    76                    20501.211353 26562.7838  29.6% 11821  389s
H   57    76                    20539.777895 26562.7838  29.3% 11122  389s
H   61    76                    20565.900424 26562.7838  29.2% 10783  389s
    75   166 25354.2868    7  391 20565.9004 26562.7838  29.2%  9579  406s
   165   241 25279.1141   10  389 20565.9004 26562.7838  29.2%  6549  417s
H  169   241                    20589.451660 26562.7838  29.0%  6455  417s
H  218   241                    20593.931614 26562.7838  29.0%  5920  417s
H  219   241                    20595.757699 26562.7838  29.0%  5898  417s
   242   292 23151.4652   14  224 20595.7577 26562.7838  29.0%  5737  427s
   308   314 22575.1746   17  192 20595.7577 26562.7838  29.0%  5735  437s
   350   334     cutoff   18      20595.7577 26562.7838  29.0%  5836  448s
   418   357 23141.0907   18  260 20595.7577 26562.7838  29.0%  6055  458s
H  445   357                    20623.787829 26562.7838  28.8%  6081  458s
   480   399 infeasible   18      20623.7878 26562.7838  28.8%  5955  469s
   562   439 infeasible   17      20623.7878 26562.7838  28.8%  5767  482s
H  574   439                    20652.204172 26562.7838  28.6%  5763  482s
H  587   439                    20652.684449 26562.7838  28.6%  5695  482s
   624   503 22350.5503   25  181 20652.6844 26562.7838  28.6%  5598  491s
   714   524 21683.1034   27  294 20652.6844 26562.7838  28.6%  5315  501s
   779   577 21588.3667   28  295 20652.6844 26562.7838  28.6%  5200  511s
   864   620 21250.0453   30  157 20652.6844 26562.7838  28.6%  5077  519s
   945   645 21098.1747   33  237 20652.6844 26562.7838  28.6%  4950  530s
  1020   651 20931.4726   35  211 20652.6844 26562.7838  28.6%  4852  540s
H 1038   651                    20668.716026 26562.7838  28.5%  4848  540s
  1082   679 20886.7937   36  188 20668.7160 26562.7838  28.5%  4807  550s
  1166   687 20840.5693   37  198 20668.7160 26562.7838  28.5%  4707  560s
H 1176   687                    20678.119846 26562.7838  28.5%  4692  560s
  1247   734 20960.9640   19   97 20678.1198 26562.7838  28.5%  4633  571s
  1344   749 20798.9824   21  145 20678.1198 26562.7838  28.5%  4625  583s
  1422   784 20719.0775   23  141 20678.1198 26562.7838  28.5%  4567  596s
  1517   799 22038.1336   11  227 20678.1198 26562.7838  28.5%  4641  606s
  1580   827 21988.3982   12  211 20678.1198 26562.7838  28.5%  4647  618s
H 1594   827                    20699.131487 26562.7838  28.3%  4652  618s
  1680   866 21441.2186   16  204 20699.1315 26562.7838  28.3%  4621  631s
  1766   899 20919.3982   21  165 20699.1315 26562.7838  28.3%  4642  645s
  1863   946 infeasible   23      20699.1315 26562.7838  28.3%  4612  659s
  1989   962 infeasible   14      20699.1315 26562.7838  28.3%  4597  672s
H 2054   962                    20710.303555 25705.5734  24.1%  4604  672s
  2075   994 22852.0500    8  255 20710.3036 25705.5734  24.1%  4634  687s
  2151  1021 22352.9986   10  168 20710.3036 25698.7269  24.1%  4678  703s
  2276  1070 21694.9332   13  246 20710.3036 25698.7269  24.1%  4671  719s
  2389  1108 infeasible   17      20710.3036 25698.7269  24.1%  4678  734s
  2517  1154 21020.0890   16  230 20710.3036 25103.0062  21.2%  4688  751s
  2657  1187 21735.2671   10  283 20710.3036 25103.0062  21.2%  4680  766s
  2766  1261 21665.8355   11  266 20710.3036 25103.0062  21.2%  4690  784s
  2931  1313 21034.2554   14  206 20710.3036 25102.2696  21.2%  4664  801s
  3107  1366 infeasible   17      20710.3036 24810.8287  19.8%  4665  819s
  3228  1434 21710.7782   15  281 20710.3036 24810.8287  19.8%  4681  837s
  3407  1474 infeasible   18      20710.3036 24655.1015  19.0%  4616  856s
  3593  1477 21436.1193   18  239 20710.3036 24580.8579  18.7%  4615  876s
  3718  1521 21883.6228    8  305 20710.3036 24564.7340  18.6%  4717  896s
  3866  1596 21376.8575   11  222 20710.3036 24463.1826  18.1%  4786  918s
  4069  1680 21991.8157   11  377 20710.3036 24463.1826  18.1%  4773  940s
  4321  1752     cutoff   13      20710.3036 24463.1826  18.1%  4737  962s
  4571  1804 21795.5127   12  269 20710.3036 24463.1826  18.1%  4703  986s
  4780  1879 21490.3852   19  268 20710.3036 24463.1826  18.1%  4682 1009s
  5056  1921 21263.4370   40   94 20710.3036 23927.1039  15.5%  4649 1035s
  5305  1970 21106.7621   14  147 20710.3036 23898.1968  15.4%  4671 1060s
  5598  2079 infeasible   16      20710.3036 23468.6617  13.3%  4660 1086s
  5876  2256 21657.9847   17  338 20710.3036 23256.0669  12.3%  4627 1114s
  6243  2257 21081.2762   42  275 20710.3036 23148.7457  11.8%  4548 1193s
  6245  2258 20969.1945   16  168 20710.3036 23148.7457  11.8%  4546 1203s
  6246  2259 20925.2914   21  343 20710.3036 23148.7457  11.8%  4545 1244s
  6247  2260 21190.9095   18  348 20710.3036 23148.7457  11.8%  4545 1281s
  6248  2260 20984.4302   40  374 20710.3036 23148.7457  11.8%  4544 1299s
  6249  2261 21164.2302   12  352 20710.3036 23148.7457  11.8%  4543 1309s
  6250  2262 22390.2487   26  404 20710.3036 23148.7457  11.8%  4543 1318s
  6251  2262 21318.7428   16  393 20710.3036 23148.7457  11.8%  4542 1326s
  6252  2263 21020.7809   18  392 20710.3036 23148.7457  11.8%  4541 1331s
  6254  2264 21496.5838   12  390 20710.3036 23148.7457  11.8%  4540 1347s
  6255  2265 22675.3302   14  251 20710.3036 23148.7457  11.8%  4539 1350s
  6256  2266 21944.0014   22  441 20710.3036 23148.7457  11.8%  4538 1361s
  6257  2266 21507.3769   21  402 20710.3036 23148.7457  11.8%  4537 1373s
  6258  2267 22930.3977   10  351 20710.3036 23148.7457  11.8%  4537 1379s
  6259  2268 21633.2763   29  399 20710.3036 23148.7457  11.8%  4536 1387s
  6260  2268 21239.3221   16  368 20710.3036 23148.7457  11.8%  4535 1404s
  6261  2269 20829.4637   19  451 20710.3036 23148.7457  11.8%  4535 1412s
  6262  2270 21180.8755   14  449 20710.3036 23148.7457  11.8%  4534 1417s
  6263  2270 21517.5409   11  381 20710.3036 23148.7457  11.8%  4533 1432s
  6264  2271 20876.0824   20  349 20710.3036 23148.7457  11.8%  4532 1438s
  6265  2272 21664.5910   33  395 20710.3036 23148.7457  11.8%  4532 1445s
  6266  2272 22068.3359   20  412 20710.3036 23148.7457  11.8%  4531 1455s
  6267  2273 21168.6982   18  371 20710.3036 23148.7457  11.8%  4530 1462s
  6268  2274 21335.1006   32  416 20710.3036 23148.7457  11.8%  4529 1475s
  6269  2274 21651.9402   11  416 20710.3036 23148.7457  11.8%  4529 1480s
  6270  2275 21918.2344   10  385 20710.3036 23148.7457  11.8%  4528 1488s
  6271  2276 22163.2205   12  375 20710.3036 23148.7457  11.8%  4527 1491s
  6272  2276 21346.2627   19  375 20710.3036 23148.7457  11.8%  4527 1501s
  6273  2277 21035.2170   15  380 20710.3036 23148.7457  11.8%  4526 1506s
  6274  2278 20917.5273   15  417 20710.3036 23148.7457  11.8%  4525 1514s
  6275  2278 20904.3021   28  417 20710.3036 23148.7457  11.8%  4524 1530s
  6276  2279 21024.8476   28  417 20710.3036 23148.7457  11.8%  4524 1558s
  6277  2283 23148.7457   10  358 20710.3036 23148.7457  11.8%  4573 1578s
  6279  2286 23148.7457   11  367 20710.3036 23148.7457  11.8%  4574 1606s
  6283  2293 23148.7457   12  417 20710.3036 23148.7457  11.8%  4578 1619s
  6291  2298 23148.7457   13  369 20710.3036 23148.7457  11.8%  4585 1662s
  6299  2319 23148.7457   14  378 20710.3036 23148.7457  11.8%  4592 1715s
  6323  2343 23148.7457   15  404 20710.3036 23148.7457  11.8%  4715 1729s
  6355  2423 23148.7457   16  367 20710.3036 23148.7457  11.8%  4728 1753s
  6462  2407 22295.9383   18  285 20710.3036 23148.7457  11.8%  4710 1766s
  6501  2415 21557.6428   22  218 20710.3036 23148.7457  11.8%  4714 1781s
  6554  2411     cutoff   19      20710.3036 23148.7457  11.8%  4709 1796s
  6622  2392 23148.7457   18  394 20710.3036 23148.7457  11.8%  4690 1810s
  6687  2367 21666.9505   19  297 20710.3036 23148.7457  11.8%  4675 1821s
  6721  2355 21477.5855   20  272 20710.3036 23148.7457  11.8%  4670 1835s
  6787  2340 21195.7100   21  282 20710.3036 23148.7457  11.8%  4649 1858s
  6828  2321     cutoff   22      20710.3036 23148.7457  11.8%  4643 1876s
  6885  2305 infeasible   22      20710.3036 23148.7457  11.8%  4636 1890s
  6943  2301 21917.0880   17  237 20710.3036 23148.7457  11.8%  4630 1906s
  7012  2292 21794.5264   18  236 20710.3036 23148.7457  11.8%  4613 1920s
  7074  2292 21326.0772   19  232 20710.3036 23148.7457  11.8%  4607 1933s
  7142  2261     cutoff   21      20710.3036 23148.7457  11.8%  4591 1947s
  7229  2232 20900.8682   19  375 20710.3036 23148.7457  11.8%  4563 1962s
  7316  2193 20806.2342   24  304 20710.3036 23148.7457  11.8%  4536 1975s
  7362  2168 20774.2265   25  292 20710.3036 23148.7457  11.8%  4531 1990s
  7408  2154 20757.5366   26  284 20710.3036 23148.7457  11.8%  4530 2004s
  7458  2137 20742.9858   27  282 20710.3036 23148.7457  11.8%  4530 2024s
  7515  2116     cutoff   19      20710.3036 23148.7457  11.8%  4522 2041s
  7601  2070     cutoff   16      20710.3036 23148.7457  11.8%  4505 2063s
  7684  2038     cutoff   17      20710.3036 23148.7457  11.8%  4496 2081s
  7758  2005 infeasible   22      20710.3036 22850.5465  10.3%  4490 2101s
  7875  1964 20807.0796   17  179 20710.3036 22798.5701  10.1%  4465 2120s
  8032  1890     cutoff   17      20710.3036 22798.5701  10.1%  4417 2139s
  8209  1785 21571.0929   18  199 20710.3036 22798.5701  10.1%  4363 2157s
  8403  1683 21146.2408   20  158 20710.3036 22798.5701  10.1%  4306 2175s
  8583  1626 21016.4232   31  129 20710.3036 21956.3360  6.02%  4257 2192s
  8794  1549 infeasible   21      20710.3036 21756.9657  5.05%  4190 2206s
  9081  1526 21374.5735   38  179 20710.3036 21690.5963  4.73%  4088 2218s
  9562  1508 21173.0933   54   86 20710.3036 21690.5963  4.73%  3904 2229s
 10189  1444 20969.9485   71   97 20710.3036 21690.5963  4.73%  3690 2238s
 10944  1353 20759.1446   79   53 20710.3036 21310.8530  2.90%  3461 2247s
 11837  1222 20859.5472   81   81 20710.3036 21126.9030  2.01%  3227 2254s
 12845  1008 20826.7178   86   76 20710.3036 21126.9030  2.01%  3002 2260s
 13827   918 20723.8972   93   10 20710.3036 21126.9030  2.01%  2817 2266s
 14790   863     cutoff   78      20710.3036 20800.4643  0.44%  2659 2272s
 15642   763 20716.1289   86   27 20710.3036 20789.5176  0.38%  2539 2279s
 16367   753 20738.4135   75   32 20710.3036 20773.8589  0.31%  2447 2285s
 16429   721 20718.1423   76   30 20710.3036 20773.8589  0.31%  2440 2291s
 16505   689     cutoff   77      20710.3036 20773.8589  0.31%  2431 2298s
 16612   584 20725.8109   76   34 20710.3036 20773.8589  0.31%  2419 2304s
 16972   294 infeasible   76      20710.3036 20764.1325  0.26%  2377 2311s
 17752    35     cutoff   92      20710.3036 20758.2556  0.23%  2294 2317s

Cutting planes:
  Learned: 2
  Gomory: 51
  Implied bound: 17
  Projected implied bound: 312
  MIR: 939
  Mixing: 9
  Flow cover: 1643
  Inf proof: 1
  RLT: 64
  Relax-and-lift: 206

Explored 18466 nodes (41372755 simplex iterations) in 2319.73 seconds (6714.63 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20710.3 20699.1 20678.1 ... 20565.9

Optimal solution found (tolerance 1.00e-04)
Best objective 2.071030355507e+04, best bound 2.071030355507e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2319.76s
  Master Objective (UB) = 20710.30, θ = 140522.47
  Upper Bound (UB) = 20710.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140522.47
  [DEBUG]   ✓ Scenario 0: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140522.47 ≤ Q = 140522.47 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7154d76e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8eab2892
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.438343e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7504019.5621
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.360133e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136013.32    0  123 7504019.56 -136013.32   102%     -    0s
H    0     0                    -101113.5024 -136013.32  34.5%     -    0s
     0     0 -108689.06    0   84 -101113.50 -108689.06  7.49%     -    0s
H    0     0                    -106310.1982 -108582.54  2.14%     -    0s
H    0     0                    -106800.1796 -108582.54  1.67%     -    0s
     0     0 -108026.33    0   85 -106800.18 -108026.33  1.15%     -    0s
     0     0 -108003.68    0   85 -106800.18 -108003.68  1.13%     -    0s
     0     0 -107569.13    0   87 -106800.18 -107569.13  0.72%     -    0s
     0     0 -107516.44    0   86 -106800.18 -107516.44  0.67%     -    0s
     0     0 -107515.96    0   85 -106800.18 -107515.96  0.67%     -    0s
     0     0 -107347.00    0   72 -106800.18 -107347.00  0.51%     -    0s
     0     0 -107317.35    0   81 -106800.18 -107317.35  0.48%     -    0s
     0     0 -107297.15    0   81 -106800.18 -107297.15  0.47%     -    0s
     0     0 -107036.08    0   60 -106800.18 -107036.08  0.22%     -    0s
     0     0 -107028.64    0   55 -106800.18 -107028.64  0.21%     -    0s
     0     0 -107006.59    0   61 -106800.18 -107006.59  0.19%     -    0s
     0     0 -106948.71    0   56 -106800.18 -106948.71  0.14%     -    0s
     0     0 -106936.81    0   56 -106800.18 -106936.81  0.13%     -    0s
H    0     0                    -106824.0784 -106936.81  0.11%     -    0s
     0     0 -106936.81    0   59 -106824.08 -106936.81  0.11%     -    0s
     0     0 -106936.81    0   48 -106824.08 -106936.81  0.11%     -    0s
     0     0 -106936.81    0   44 -106824.08 -106936.81  0.11%     -    0s
     0     0 -106936.81    0   42 -106824.08 -106936.81  0.11%     -    0s
     0     0 -106931.05    0   16 -106824.08 -106931.05  0.10%     -    0s
     0     0 -106908.28    0   11 -106824.08 -106908.28  0.08%     -    0s
     0     0 -106881.87    0   11 -106824.08 -106881.87  0.05%     -    0s
     0     0 -106867.75    0   10 -106824.08 -106867.75  0.04%     -    0s
     0     0 -106867.51    0   10 -106824.08 -106867.51  0.04%     -    0s
     0     0 -106837.61    0    2 -106824.08 -106837.61  0.01%     -    0s
H    0     0                    -106828.4562 -106837.61  0.01%     -    0s

Explored 1 nodes (1144 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -106828 -106824 -106800 ... 1.43834e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.068284562256e+05, best bound -1.068376097122e+05, gap 0.0086%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 137760.78
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106828.46
  [DEBUG]   S×d_nominal = 244589.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244589.23 + -106828.46 = 137760.78
  [DEBUG]   Current θ from Master = 140522.47
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2761.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17948.61
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 866.3667, Absolute Gap = 866.3667, Relative Gap = 0.041833
  Not converged yet (gap = 866.37 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481159 nonzeros
Model fingerprint: 0x3487c928
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74437 rows and 30217 columns
Presolve time: 1.40s
Presolved: 95136 rows, 40683 columns, 576760 nonzeros
Variable types: 38424 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364358.5343
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.205e+06
 Factor NZ  : 9.181e+06 (roughly 130 MB of memory)
 Factor Ops : 1.638e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79135990e+07  1.67291839e+08  1.03e+05 2.45e+01  7.25e+04     3s
   1  -1.34270467e+07  1.45962982e+08  7.10e+04 7.39e+01  4.96e+04     3s
   2  -3.79539283e+06  1.07735849e+08  1.97e+04 9.83e-12  1.47e+04     3s
   3  -7.55583586e+05  7.34905801e+07  1.58e+03 6.35e-01  1.51e+03     3s
   4  -4.83077002e+05  3.17336465e+07  3.82e+02 1.87e-01  4.20e+02     3s
   5  -3.58168500e+05  2.21504441e+07  1.15e+02 1.23e-01  1.95e+02     3s
   6  -2.86152462e+05  1.71497713e+07  4.83e+01 9.07e-02  1.25e+02     3s
   7  -1.90897462e+05  1.28678116e+07  1.99e+01 6.52e-02  8.36e+01     3s
   8  -1.10480385e+05  7.28753457e+06  5.86e+00 3.52e-02  4.41e+01     3s
   9  -8.51573580e+04  5.20142991e+06  3.77e+00 2.46e-02  3.11e+01     3s
  10  -5.50737657e+04  1.75464350e+06  1.92e+00 7.74e-03  1.05e+01     3s
  11  -2.07716380e+04  5.20055957e+05  6.90e-01 2.11e-03  3.12e+00     3s
  12  -7.88152484e+03  2.75772672e+05  3.83e-01 1.16e-03  1.63e+00     3s
  13  -1.59592438e+03  2.01631128e+05  2.91e-01 9.79e-04  1.17e+00     3s
  14   3.00893367e+03  1.37744684e+05  2.37e-01 8.28e-04  7.74e-01     3s
  15   7.05367518e+03  1.23045646e+05  1.95e-01 6.78e-04  6.66e-01     3s
  16   1.28554642e+04  9.93200900e+04  1.43e-01 1.23e-03  4.97e-01     3s
  17   1.75877549e+04  8.64339330e+04  1.14e-01 1.20e-03  3.95e-01     3s
  18   2.13210949e+04  7.44259003e+04  9.20e-02 1.33e-03  3.05e-01     3s
  19   2.44359971e+04  6.71238245e+04  7.38e-02 1.13e-03  2.45e-01     3s
  20   2.77720487e+04  5.96346768e+04  5.60e-02 1.59e-03  1.83e-01     3s
  21   3.04908132e+04  5.72924689e+04  4.31e-02 1.47e-03  1.54e-01     3s
  22   3.22862938e+04  5.21454982e+04  3.50e-02 1.67e-03  1.14e-01     3s
  23   3.37764074e+04  4.96817163e+04  2.89e-02 1.30e-03  9.13e-02     3s
  24   3.47949402e+04  4.72861705e+04  2.47e-02 8.83e-04  7.17e-02     3s
  25   3.69674698e+04  4.60566784e+04  1.61e-02 6.78e-04  5.22e-02     3s
  26   3.79631425e+04  4.52816863e+04  1.24e-02 5.59e-04  4.20e-02     4s
  27   3.82702400e+04  4.43082958e+04  1.12e-02 4.34e-04  3.47e-02     4s
  28   3.90276601e+04  4.33891972e+04  8.57e-03 2.84e-04  2.50e-02     4s
  29   3.95984396e+04  4.29927665e+04  6.41e-03 2.73e-04  1.95e-02     4s
  30   4.01019430e+04  4.27098543e+04  4.78e-03 2.14e-04  1.50e-02     4s
  31   4.02731582e+04  4.26146985e+04  4.18e-03 1.95e-04  1.34e-02     4s
  32   4.06794845e+04  4.22103565e+04  2.76e-03 1.55e-04  8.79e-03     4s
  33   4.07322423e+04  4.21426286e+04  2.58e-03 1.50e-04  8.09e-03     4s
  34   4.09992276e+04  4.19939165e+04  1.75e-03 1.33e-04  5.71e-03     4s
  35   4.12648723e+04  4.19016387e+04  9.04e-04 1.03e-04  3.65e-03     4s
  36   4.13187843e+04  4.17949887e+04  7.57e-04 6.58e-05  2.73e-03     4s
  37   4.13668071e+04  4.17423072e+04  6.19e-04 4.79e-05  2.15e-03     4s
  38   4.14483757e+04  4.16618696e+04  3.85e-04 2.10e-05  1.23e-03     4s
  39   4.14822987e+04  4.16411984e+04  2.93e-04 1.44e-05  9.12e-04     4s
  40   4.15343856e+04  4.16335268e+04  1.54e-04 1.18e-05  5.69e-04     4s
  41   4.15355686e+04  4.16307333e+04  1.51e-04 1.09e-05  5.46e-04     4s
  42   4.15585059e+04  4.16286890e+04  9.39e-05 1.03e-05  4.03e-04     4s
  43   4.15902535e+04  4.15997627e+04  1.15e-05 1.33e-06  5.45e-05     4s
  44   4.15962222e+04  4.15966481e+04  5.00e-07 1.79e-07  2.44e-06     4s
  45   4.15965604e+04  4.15965617e+04  1.85e-09 1.93e-09  7.40e-09     4s
  46   4.15965615e+04  4.15965615e+04  3.59e-10 3.56e-12  4.78e-12     4s

Barrier solved model in 46 iterations and 4.42 seconds (8.22 work units)
Optimal objective 4.15965615e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

    1289 PPushes remaining with PInf 6.4105272e-07                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.1353202e-11      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31730    4.1596562e+04   0.000000e+00   0.000000e+00      5s
   31730    4.1596562e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.159656e+04, 31730 iterations, 3.60 seconds (7.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41596.5615    0  208 -208513.72 41596.5615   120%     -    5s
H    0     0                    -199468.7808 41596.5615   121%     -    5s
H    0     0                    -167175.4481 41596.5615   125%     -    6s
H    0     0                    -127997.3468 41596.5615   132%     -    6s
H    0     0                    -127291.7309 41596.5615   133%     -    6s
H    0     0                    -42137.21343 41596.5615   199%     -    6s
H    0     0                    8615.6266041 41596.5615   383%     -    6s
H    0     0                    16308.917886 41596.5615   155%     -    6s
H    0     0                    16611.826872 41596.5615   150%     -    6s
H    0     0                    16749.755656 41596.5615   148%     -    6s
H    0     0                    17141.491094 41596.5615   143%     -    6s
H    0     0                    17145.630751 41596.5615   143%     -    6s
H    0     0                    17145.963888 41596.5615   143%     -    7s
H    0     0                    17157.337826 41586.1984   142%     -    8s
H    0     0                    17163.205654 41586.1984   142%     -    8s
H    0     0                    17182.232847 41586.1984   142%     -    8s
H    0     0                    17187.316541 41586.1984   142%     -    8s
     0     0 37347.1396    0  269 17187.3165 37347.1396   117%     -   30s
     0     0 36597.2687    0  372 17187.3165 36597.2687   113%     -   51s
     0     0 36590.5732    0  381 17187.3165 36590.5732   113%     -   61s
     0     0 36590.5732    0  392 17187.3165 36590.5732   113%     -   65s
     0     0 36590.5732    0  391 17187.3165 36590.5732   113%     -   68s
     0     0 36588.7956    0  431 17187.3165 36588.7956   113%     -   70s
     0     0 36588.6551    0  439 17187.3165 36588.6551   113%     -   71s
H    0     0                    17208.859921 32867.4797  91.0%     -  104s
H    0     0                    17246.350992 32867.4797  90.6%     -  104s
H    0     0                    17289.466024 32867.4797  90.1%     -  104s
     0     0 32867.4797    0  274 17289.4660 32867.4797  90.1%     -  104s
H    0     0                    19761.229927 32866.8353  66.3%     -  105s
H    0     0                    20278.657792 32866.8353  62.1%     -  105s
H    0     0                    20307.287312 32866.8353  61.8%     -  105s
H    0     0                    20314.375943 32866.8353  61.8%     -  105s
     0     0 32235.0206    0  287 20314.3759 32235.0206  58.7%     -  120s
     0     0 32065.2678    0  357 20314.3759 32065.2678  57.8%     -  132s
H    0     0                    20352.523934 31845.7196  56.5%     -  142s
H    0     0                    20450.384125 31845.7196  55.7%     -  142s
     0     0 31845.7196    0  317 20450.3841 31845.7196  55.7%     -  142s
H    0     0                    20466.051738 31660.5603  54.7%     -  157s
     0     0 31660.5603    0  361 20466.0517 31660.5603  54.7%     -  157s
     0     0 31639.6627    0  307 20466.0517 31639.6627  54.6%     -  162s
     0     0 31623.6109    0  311 20466.0517 31623.6109  54.5%     -  168s
H    0     0                    20510.751284 31575.8788  53.9%     -  171s
H    0     0                    20511.854915 31575.8788  53.9%     -  171s
H    0     0                    20512.894773 31575.8788  53.9%     -  171s
H    0     0                    20534.257671 31575.8788  53.8%     -  171s
     0     0 31575.8788    0  310 20534.2577 31575.8788  53.8%     -  171s
     0     0 31575.1497    0  310 20534.2577 31575.1497  53.8%     -  172s
     0     0 29320.4867    0  347 20534.2577 29320.4867  42.8%     -  201s
     0     0 28961.7881    0  271 20534.2577 28961.7881  41.0%     -  215s
     0     0 28709.7367    0  335 20534.2577 28709.7367  39.8%     -  224s
     0     0 28546.9841    0  336 20534.2577 28546.9841  39.0%     -  232s
     0     0 28456.2562    0  419 20534.2577 28456.2562  38.6%     -  240s
     0     0 28424.7994    0  357 20534.2577 28424.7994  38.4%     -  244s
     0     0 28208.3107    0  359 20534.2577 28208.3107  37.4%     -  254s
     0     0 28202.4629    0  369 20534.2577 28202.4629  37.3%     -  256s
     0     0 28183.2472    0  355 20534.2577 28183.2472  37.2%     -  259s
     0     0 28176.0334    0  367 20534.2577 28176.0334  37.2%     -  261s
     0     0 28149.3024    0  356 20534.2577 28149.3024  37.1%     -  265s
     0     0 28135.0720    0  362 20534.2577 28135.0720  37.0%     -  267s
     0     0 28131.5908    0  349 20534.2577 28131.5908  37.0%     -  269s
     0     0 28129.7782    0  360 20534.2577 28129.7782  37.0%     -  270s
     0     0 28119.3825    0  357 20534.2577 28119.3825  36.9%     -  272s
     0     0 28118.2331    0  349 20534.2577 28118.2331  36.9%     -  273s
     0     0 27694.3880    0  480 20534.2577 27694.3880  34.9%     -  293s
H    0     0                    20553.207888 27626.5597  34.4%     -  300s
H    0     0                    20596.479065 27626.5597  34.1%     -  300s
H    0     0                    20596.843953 27626.5597  34.1%     -  300s
     0     0 27626.5597    0  308 20596.8440 27626.5597  34.1%     -  300s
     0     0 27613.7975    0  362 20596.8440 27613.7975  34.1%     -  306s
     0     0 27600.3950    0  327 20596.8440 27600.3950  34.0%     -  310s
     0     0 27583.8516    0  270 20596.8440 27583.8516  33.9%     -  312s
     0     0 27574.1776    0  266 20596.8440 27574.1776  33.9%     -  314s
     0     0 27547.0823    0  402 20596.8440 27547.0823  33.7%     -  320s
     0     0 27543.9062    0  352 20596.8440 27543.9062  33.7%     -  322s
     0     0 27543.2478    0  397 20596.8440 27543.2478  33.7%     -  324s
     0     0 27442.3480    0  401 20596.8440 27442.3480  33.2%     -  335s
     0     0 27418.4983    0  399 20596.8440 27418.4983  33.1%     -  341s
     0     0 27408.2186    0  404 20596.8440 27408.2186  33.1%     -  345s
     0     0 27404.6413    0  353 20596.8440 27404.6413  33.1%     -  347s
     0     0 27401.2060    0  348 20596.8440 27401.2060  33.0%     -  349s
     0     0 27399.6900    0  407 20596.8440 27399.6900  33.0%     -  350s
     0     0 27378.7754    0  277 20596.8440 27378.7754  32.9%     -  356s
     0     0 27365.8600    0  330 20596.8440 27365.8600  32.9%     -  363s
     0     0 27360.9464    0  328 20596.8440 27360.9464  32.8%     -  365s
     0     0 27359.0468    0  417 20596.8440 27359.0468  32.8%     -  366s
     0     0 27352.8711    0  419 20596.8440 27352.8711  32.8%     -  370s
     0     0 27351.8298    0  494 20596.8440 27351.8298  32.8%     -  372s
     0     0 27347.5927    0  488 20596.8440 27347.5927  32.8%     -  373s
H    0     0                    20605.357806 27347.5409  32.7%     -  375s
     0     0 27347.5409    0  496 20605.3578 27347.5409  32.7%     -  375s
     0     0 27344.3322    0  489 20605.3578 27344.3322  32.7%     -  377s
H    0     0                    20629.707889 27344.1771  32.5%     -  378s
     0     0 27344.1771    0  489 20629.7079 27344.1771  32.5%     -  378s
     0     0 27344.1771    0  489 20629.7079 27344.1771  32.5%     -  378s
     0     0 27344.1771    0  490 20629.7079 27344.1771  32.5%     -  379s
     0     0 27344.1771    0  490 20629.7079 27344.1771  32.5%     -  382s
     0     2 27344.1218    0  490 20629.7079 27344.1218  32.5%     -  431s
     1     4 27083.2145    1  475 20629.7079 27343.8279  32.5%  9260  439s
     3     8 27019.9806    2  475 20629.7079 27081.8603  31.3%  8201  449s
     7    16 26950.2832    3  476 20629.7079 27019.7532  31.0%  8303  461s
    15    32 26901.0054    4  481 20629.7079 26949.6211  30.6%  8487  478s
    31    48 26158.6302    5  367 20629.7079 26900.2150  30.4% 11956  526s
    47    79 25747.6943    6  345 20629.7079 26900.2150  30.4% 15083  545s
    78   131 25561.3824    7  426 20629.7079 26900.2150  30.4% 10529  560s
   130   163 25508.8877    8  341 20629.7079 26900.2150  30.4%  8315  573s
   162   194 25824.8435   11  287 20629.7079 26900.2150  30.4%  8699  584s
H  171   194                    20672.333408 26900.2150  30.1%  8510  584s
   193   263 25499.3223    9  347 20672.3334 26900.2150  30.1%  8238  598s
   262   317 25453.9726   10  340 20672.3334 26900.2150  30.1%  6987  611s
   331   360 25169.3930   12  283 20672.3334 26900.2150  30.1%  6449  623s
   406   381 25103.0461   12  292 20672.3334 26900.2150  30.1%  5912  635s
   475   390 24887.1738   11  279 20672.3334 26900.2150  30.1%  5609  648s
   528   394 24467.7187   12  264 20672.3334 26900.2150  30.1%  5597  661s
   574   401 24816.2152   12  269 20672.3334 26900.2150  30.1%  5579  673s
   623   422 22028.7712   23  194 20672.3334 26900.2150  30.1%  5984  687s
   664   443 21622.6223   14  347 20672.3334 26900.2150  30.1%  5972  705s
   701   465 21606.5007   15  352 20672.3334 26900.2150  30.1%  5860  717s
   760   481 21010.1888   17  248 20672.3334 26900.2150  30.1%  5660  730s
   812   483 infeasible   18      20672.3334 26900.2150  30.1%  5549  744s
   881   504 21386.8160   16  345 20672.3334 26900.2150  30.1%  5402  758s
   939   500     cutoff   17      20672.3334 26900.2150  30.1%  5263  773s
H  963   500                    20675.058378 26900.2150  30.1%  5205  773s
H  966   500                    20680.603347 26900.2150  30.1%  5193  773s
   984   508 22103.9579   14  264 20680.6033 26900.2150  30.1%  5157  788s
  1047   526 21744.0273   15  224 20680.6033 26900.2150  30.1%  5095  802s
  1081   548 21771.4054   15  388 20680.6033 26900.2150  30.1%  5136  818s
  1130   562     cutoff   16      20680.6033 26900.2150  30.1%  5143  834s
  1196   566 infeasible   16      20680.6033 26900.2150  30.1%  5122  850s
  1260   588 infeasible   18      20680.6033 26900.2150  30.1%  5056  866s
  1330   643     cutoff   20      20680.6033 26900.2150  30.1%  5046  883s
  1413   664 21734.0821   12  225 20680.6033 26900.2150  30.1%  4994  898s
  1450   693 21129.9070   13   95 20680.6033 26900.2150  30.1%  5007  913s
  1501   744 20949.3285   14   69 20680.6033 26900.2150  30.1%  5004  929s
  1569   767 infeasible   15      20680.6033 26900.2150  30.1%  4897  948s
  1652   784 21049.8687   14   90 20680.6033 26900.2150  30.1%  4816  968s
  1743   821 20724.4635   18   56 20680.6033 26900.2150  30.1%  4754  989s
  1848   873 21879.8082   13  252 20680.6033 26662.1285  28.9%  4680 1009s
  1976   891 21271.8794   15  270 20680.6033 26662.1285  28.9%  4585 1026s
  2021   912 infeasible   16      20680.6033 26662.1285  28.9%  4599 1046s
  2115   941 21064.7510   16  198 20680.6033 26662.1285  28.9%  4574 1066s
  2241   980     cutoff   27      20680.6033 26662.1285  28.9%  4489 1092s
  2383  1063 21966.4451   12  232 20680.6033 26662.1285  28.9%  4401 1119s
  2552  1114 21658.4195   13  205 20680.6033 26662.1285  28.9%  4308 1144s
  2722  1175 20938.5413   19  206 20680.6033 26662.1285  28.9%  4260 1173s
  2900  1265     cutoff   21      20680.6033 26662.1285  28.9%  4212 1201s
  3115  1328 21233.0834   15  419 20680.6033 24797.7535  19.9%  4103 1231s
  3331  1348 21054.2404   16  339 20680.6033 24797.7535  19.9%  4041 1262s
H 3414  1348                    20686.050974 24797.7535  19.9%  4052 1262s
  3450  1396     cutoff   17      20686.0510 24786.4111  19.8%  4043 1294s
  3620  1427 infeasible   14      20686.0510 24780.6161  19.8%  4070 1327s
  3780  1458 23382.3763    6  270 20686.0510 24780.6161  19.8%  4106 1363s
  3964  1470 22060.8446    9  354 20686.0510 24680.2203  19.3%  4132 1397s
H 3997  1470                    20692.539931 24350.5470  17.7%  4164 1397s
  4052  1508 21296.8228   10  387 20692.5399 24350.5470  17.7%  4177 1438s
  4266  1503 21844.7983   10  191 20692.5399 24350.5470  17.7%  4191 1475s
  4456  1532 21037.4698   16  187 20692.5399 24350.5470  17.7%  4230 1515s
  4617  1564 22377.2636   12  349 20692.5399 24350.5470  17.7%  4309 1556s
  4805  1582 21743.9770   14  353 20692.5399 24350.5470  17.7%  4322 1597s
  5049  1575 infeasible   14      20692.5399 23663.1221  14.4%  4329 1642s
  5256  1654 21631.9768   17  209 20692.5399 23521.7246  13.7%  4368 1687s
  5565  1714 21039.4184   45  106 20692.5399 23362.5503  12.9%  4345 1732s
  5868  1742 infeasible   16      20692.5399 23321.4401  12.7%  4328 1780s
  6138  1756     cutoff   13      20692.5399 23321.4401  12.7%  4323 1832s
  6469  1800 21342.2051   15  173 20692.5399 23056.9904  11.4%  4316 1884s
  6816  1801     cutoff   17      20692.5399 22793.8438  10.2%  4309 1938s
  7143  1829 infeasible   22      20692.5399 22625.6713  9.34%  4316 1990s
  7546  1961 21338.8750   15  188 20692.5399 22491.8153  8.70%  4267 2047s
  8125  1962 21353.6193   18  490 20692.5399 22287.3811  7.71%  4167 2109s
  8127  1963 21116.2018   27  160 20692.5399 22287.3811  7.71%  4166 2116s
  8128  1964 21703.6269   19  309 20692.5399 22287.3811  7.71%  4165 2158s
  8129  1965 21086.7091   32  332 20692.5399 22287.3811  7.71%  4165 2195s
  8130  1965 21490.7880   40  392 20692.5399 22287.3811  7.71%  4164 2224s
  8131  1966 21116.1735   22  344 20692.5399 22287.3811  7.71%  4164 2244s
  8132  1967 20971.5574   21  279 20692.5399 22287.3811  7.71%  4163 2252s
  8133  1967 21217.5158   42  324 20692.5399 22287.3811  7.71%  4163 2257s
  8134  1968 21121.7462   29  340 20692.5399 22287.3811  7.71%  4162 2262s
  8136  1969 21272.4136   13  330 20692.5399 22287.3811  7.71%  4161 2274s
  8137  1970 21138.1019   28  388 20692.5399 22287.3811  7.71%  4161 2280s
  8139  1971 21523.4751   28  383 20692.5399 22287.3811  7.71%  4160 2295s
  8141  1973 21373.3950   19  385 20692.5399 22287.3811  7.71%  4159 2310s
  8142  1973 21192.4357   21  339 20692.5399 22287.3811  7.71%  4158 2316s
  8143  1974 21301.0766   13  346 20692.5399 22287.3811  7.71%  4158 2320s
  8144  1975 22191.7337   18  342 20692.5399 22287.3811  7.71%  4157 2330s
  8145  1975 21058.2049   16  423 20692.5399 22287.3811  7.71%  4157 2336s
  8146  1976 21510.5279   17  285 20692.5399 22287.3811  7.71%  4156 2347s
  8147  1977 21563.3199   20  359 20692.5399 22287.3811  7.71%  4156 2353s
  8148  1977 21171.1707   42  352 20692.5399 22287.3811  7.71%  4155 2358s
  8149  1978 20881.2103   32  392 20692.5399 22287.3811  7.71%  4155 2372s
  8150  1979 21543.9363   14  369 20692.5399 22287.3811  7.71%  4154 2375s
  8151  1979 20926.2482   78  273 20692.5399 22287.3811  7.71%  4154 2384s
  8152  1980 21392.0013   49  273 20692.5399 22287.3811  7.71%  4153 2393s
  8153  1981 20882.4638   38  273 20692.5399 22287.3811  7.71%  4153 2406s
  8154  1983 22287.3811   15  288 20692.5399 22287.3811  7.71%  4186 2422s
  8155  1985 22287.3811   16  292 20692.5399 22287.3811  7.71%  4186 2431s
  8157  1989 22287.3811   16  280 20692.5399 22287.3811  7.71%  4187 2445s
  8162  1998 22287.3811   17  296 20692.5399 22287.3811  7.71%  4189 2454s
  8172  2003 22287.3811   18  380 20692.5399 22287.3811  7.71%  4201 2491s
  8182  2018 22287.3811   19  364 20692.5399 22287.3811  7.71%  4209 2538s
  8210  2041 22287.3811   20  362 20692.5399 22287.3811  7.71%  4259 2559s
  8242  2062 22287.3811   21  300 20692.5399 22287.3811  7.71%  4271 2576s
  8277  2103 22287.3811   22  399 20692.5399 22287.3811  7.71%  4322 2595s
  8355  2111 22287.3811   25  388 20692.5399 22287.3811  7.71%  4355 2610s
  8427  2098 21583.8061   27  269 20692.5399 22287.3811  7.71%  4385 2625s
  8501  2067 20973.8112   28  175 20692.5399 22287.3811  7.71%  4410 2639s
  8553  2046     cutoff   29      20692.5399 22287.3811  7.71%  4444 2652s
  8621  2027 21816.4818   27  337 20692.5399 22287.3811  7.71%  4465 2670s
  8674  2010     cutoff   28      20692.5399 22287.3811  7.71%  4486 2682s
  8740  1996 22221.0288   25  164 20692.5399 22287.3811  7.71%  4509 2695s
  8785  1991 22110.0065   26  208 20692.5399 22287.3811  7.71%  4520 2710s
  8854  1979 infeasible   27      20692.5399 22287.3811  7.71%  4535 2725s
  8927  1957 21314.6042   27  224 20692.5399 22287.3811  7.71%  4554 2737s
  8998  1929 21305.8573   28  210 20692.5399 22287.3811  7.71%  4571 2748s
  9036  1919     cutoff   29      20692.5399 22287.3811  7.71%  4581 2758s
  9073  1908 20735.4807   28  130 20692.5399 22287.3811  7.71%  4588 2773s
  9121  1906     cutoff   29      20692.5399 22287.3811  7.71%  4593 2785s
  9170  1895 22287.3811   20  363 20692.5399 22287.3811  7.71%  4599 2798s
H 9201  1784                    20694.227257 22287.3811  7.70%  4600 2798s
  9217  1803 22287.3811   21  388 20694.2273 22287.3811  7.70%  4603 2812s
  9335  1760 22287.3811   22  388 20694.2273 22287.3811  7.70%  4594 2826s
  9441  1727     cutoff   23      20694.2273 22287.3811  7.70%  4604 2840s
  9564  1694 22287.3811   21  364 20694.2273 22287.3811  7.70%  4608 2856s
  9690  1632 22206.6008   22  321 20694.2273 22287.3811  7.70%  4609 2871s
  9812  1590 20838.2618   27  307 20694.2273 22287.3811  7.70%  4610 2893s
  9953  1522 21538.2505   26  334 20694.2273 22287.3811  7.70%  4599 2909s
 10110  1399 21167.7035   28  211 20694.2273 22287.3811  7.70%  4590 2927s
 10300  1285 infeasible   35      20694.2273 22287.3811  7.70%  4570 2942s
 10438  1235 infeasible   28      20694.2273 22287.3811  7.70%  4555 2958s
 10633  1163 21689.1681   24  260 20694.2273 22287.3811  7.70%  4503 2973s
 10957  1131 20978.2344   25  187 20694.2273 22040.8584  6.51%  4407 2986s
 11406  1085 20972.8667   26  252 20694.2273 22040.8584  6.51%  4259 2997s
 12006  1024 infeasible   26      20694.2273 22040.8584  6.51%  4072 3008s
 12717   972     cutoff   73      20694.2273 21466.0692  3.73%  3870 3015s
 13624   888 20760.6761   85   27 20694.2273 21054.1701  1.74%  3637 3021s
 14670  1039 20781.3188   77   54 20694.2273 20955.0930  1.26%  3404 3027s
 15733  1136 20704.6334   95   28 20694.2273 20934.8512  1.16%  3198 3033s
 16097  1285 20772.1038   83   43 20694.2273 20926.4576  1.12%  3134 3039s
H16363  1285                    20700.678048 20924.2288  1.08%  3089 3039s
 16685  1442 20744.6345   83   35 20700.6780 20924.2288  1.08%  3035 3045s
 17821  1504 20705.0820   96   40 20700.6780 20837.6759  0.66%  2864 3051s
 18343  1541 infeasible   78      20700.6780 20826.9564  0.61%  2793 3057s
 19246  1639 20781.7155   88   65 20700.6780 20817.2695  0.56%  2680 3063s
 20352  1673 20728.7092   90   26 20700.6780 20808.6520  0.52%  2555 3069s
 21481  1540     cutoff   84      20700.6780 20794.3516  0.45%  2442 3075s
 22671  1449 20709.7207   92   36 20700.6780 20778.1114  0.37%  2334 3082s
 23853  1265     cutoff   74      20700.6780 20764.3872  0.31%  2237 3088s
 25025  1014 infeasible   93      20700.6780 20749.2953  0.23%  2153 3094s
 26231   646     cutoff   88      20700.6780 20737.8590  0.18%  2073 3100s
 27473    93     cutoff   83      20700.6780 20728.8553  0.14%  1998 3106s

Cutting planes:
  Learned: 1
  Gomory: 60
  Implied bound: 27
  Projected implied bound: 234
  MIR: 984
  Mixing: 11
  Flow cover: 1767
  Inf proof: 1
  RLT: 40
  Relax-and-lift: 303

Explored 28691 nodes (55925251 simplex iterations) in 3109.28 seconds (9201.29 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20700.7 20694.2 20692.5 ... 20596.8

Optimal solution found (tolerance 1.00e-04)
Best objective 2.070067804814e+04, best bound 2.070067804814e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3109.29s
  Master Objective (UB) = 20700.68, θ = 140485.36
  Upper Bound (UB) = 20700.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140485.36
  [DEBUG]   ✓ Scenario 0: θ = 140485.36 ≤ Q = 140485.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140485.36 ≤ Q = 140485.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140485.36 ≤ Q = 140485.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140485.36 ≤ Q = 140485.36 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5ecf4758
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5ecf4758
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7501739.7242
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.358873e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135887.27    0  123 7501739.72 -135887.27   102%     -    0s
H    0     0                    -100970.0794 -135887.27  34.6%     -    0s
     0     0 -106726.65    0  134 -100970.08 -106726.65  5.70%     -    0s
H    0     0                    -103583.2008 -106696.24  3.01%     -    0s
     0     0 -105765.48    0  142 -103583.20 -105765.48  2.11%     -    0s
H    0     0                    -103931.2734 -105753.57  1.75%     -    0s
     0     0 -105349.65    0  122 -103931.27 -105349.65  1.36%     -    0s
H    0     0                    -104357.7171 -105347.25  0.95%     -    0s
     0     0 -105324.74    0  130 -104357.72 -105324.74  0.93%     -    0s
     0     0 -105199.33    0  122 -104357.72 -105199.33  0.81%     -    0s
     0     0 -105199.00    0  122 -104357.72 -105199.00  0.81%     -    0s
H    0     0                    -104385.5774 -105197.81  0.78%     -    0s
     0     2 -105197.81    0  122 -104385.58 -105197.81  0.78%     -    0s
H   39    30                    -104465.8502 -105032.19  0.54%  16.9    0s
H   45    24                    -104857.3180 -105032.19  0.17%  16.2    0s
H  129    18                    -104887.6312 -104914.19  0.03%   8.6    0s
*  130    18              17    -104887.7794 -104914.19  0.03%   8.6    0s

Cutting planes:
  Gomory: 15
  Implied bound: 2
  MIR: 223
  Flow cover: 6
  RLT: 1

Explored 167 nodes (1883 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104888 -104857 -104466 ... 1.43567e+13
No other solutions better than -104888

Optimal solution found (tolerance 1.00e-04)
Best objective -1.048877794260e+05, best bound -1.048877794260e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 139495.83
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104887.78
  [DEBUG]   S×d_nominal = 244383.61
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244383.61 + -104887.78 = 139495.83
  [DEBUG]   Current θ from Master = 140485.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 989.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19711.15
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 856.7412, Absolute Gap = 856.7412, Relative Gap = 0.041387
  Not converged yet (gap = 856.74 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524399 nonzeros
Model fingerprint: 0xd64dc58e
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81204 rows and 32964 columns
Presolve time: 1.52s
Presolved: 103659 rows, 44176 columns, 627479 nonzeros
Variable types: 41917 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361187.2557
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 617
 AA' NZ     : 3.835e+06
 Factor NZ  : 8.896e+06 (roughly 130 MB of memory)
 Factor Ops : 1.656e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79220919e+07  1.80092437e+08  1.03e+05 2.38e+01  7.21e+04     3s
   1  -1.34846580e+07  1.57088646e+08  7.13e+04 7.18e+01  4.95e+04     3s
   2  -4.01240573e+06  1.15708378e+08  2.08e+04 7.61e-01  1.54e+04     3s
   3  -7.94141006e+05  7.94811763e+07  1.80e+03 1.28e+00  1.66e+03     3s
   4  -4.89878682e+05  3.27176499e+07  4.00e+02 1.90e-01  4.20e+02     3s
   5  -3.68689516e+05  2.23538986e+07  1.42e+02 1.16e-01  2.00e+02     3s
   6  -2.76780141e+05  1.66339556e+07  4.99e+01 8.12e-02  1.14e+02     3s
   7  -1.73671528e+05  1.24255043e+07  2.07e+01 5.75e-02  7.52e+01     3s
   8  -1.05832202e+05  7.22132500e+06  8.40e+00 3.16e-02  4.10e+01     3s
   9  -8.60743649e+04  4.78715903e+06  5.36e+00 2.05e-02  2.67e+01     3s
  10  -6.18978390e+04  1.68079628e+06  3.08e+00 6.78e-03  9.44e+00     3s
  11  -2.31944596e+04  5.04257802e+05  1.37e+00 1.76e-03  2.82e+00     3s
  12  -1.32872239e+04  2.68013135e+05  9.17e-01 1.43e-03  1.50e+00     3s
  13  -4.47960767e+03  1.96379030e+05  6.61e-01 1.39e-03  1.07e+00     3s
  14   5.38927540e+02  1.42492639e+05  5.30e-01 1.13e-03  7.53e-01     3s
  15   5.28243862e+03  1.08175862e+05  4.39e-01 8.82e-04  5.46e-01     3s
  16   1.01967608e+04  9.48527625e+04  3.66e-01 8.73e-04  4.49e-01     3s
  17   1.48762964e+04  7.30156899e+04  3.01e-01 1.93e-03  3.08e-01     3s
  18   1.68241626e+04  6.75863451e+04  2.76e-01 1.74e-03  2.69e-01     3s
  19   1.96353871e+04  6.20528033e+04  2.40e-01 1.64e-03  2.25e-01     3s
  20   2.38168687e+04  5.89381674e+04  1.85e-01 1.64e-03  1.86e-01     3s
  21   2.61126107e+04  5.55741794e+04  1.58e-01 1.33e-03  1.56e-01     3s
  22   2.93664037e+04  5.31726355e+04  1.19e-01 1.36e-03  1.26e-01     3s
  23   3.18034631e+04  5.25953221e+04  9.14e-02 1.33e-03  1.10e-01     3s
  24   3.26938324e+04  4.97282228e+04  8.17e-02 1.22e-03  9.01e-02     3s
  25   3.42745573e+04  4.84507447e+04  6.62e-02 1.61e-03  7.50e-02     4s
  26   3.49830623e+04  4.55157843e+04  5.92e-02 1.42e-03  5.58e-02     4s
  27   3.64981148e+04  4.47256583e+04  4.46e-02 1.38e-03  4.36e-02     4s
  28   3.74707615e+04  4.41896653e+04  3.56e-02 1.59e-03  3.56e-02     4s
  29   3.80668385e+04  4.34490070e+04  2.99e-02 1.79e-03  2.85e-02     4s
  30   3.87856009e+04  4.32208616e+04  2.35e-02 1.67e-03  2.35e-02     4s
  31   3.89401989e+04  4.29203873e+04  2.20e-02 1.33e-03  2.11e-02     4s
  32   3.95231439e+04  4.25683318e+04  1.71e-02 1.02e-03  1.61e-02     4s
  33   3.98406872e+04  4.23694082e+04  1.42e-02 8.26e-04  1.34e-02     4s
  34   4.01488853e+04  4.20784724e+04  1.14e-02 5.44e-04  1.02e-02     4s
  35   4.03011875e+04  4.20221260e+04  1.02e-02 4.87e-04  9.11e-03     4s
  36   4.04483832e+04  4.18553140e+04  8.91e-03 3.23e-04  7.45e-03     4s
  37   4.06313774e+04  4.18457082e+04  7.40e-03 3.15e-04  6.43e-03     4s
  38   4.06582958e+04  4.17875036e+04  7.18e-03 2.62e-04  5.98e-03     4s
  39   4.07010779e+04  4.17608396e+04  6.82e-03 2.31e-04  5.61e-03     4s
  40   4.09409888e+04  4.16840611e+04  4.72e-03 1.51e-04  3.94e-03     4s
  41   4.10037481e+04  4.16699154e+04  4.20e-03 1.38e-04  3.53e-03     4s
  42   4.10962666e+04  4.16504810e+04  3.43e-03 1.20e-04  2.94e-03     4s
  43   4.12166010e+04  4.16143590e+04  2.42e-03 9.00e-05  2.11e-03     4s
  44   4.12991028e+04  4.15956635e+04  1.71e-03 7.28e-05  1.57e-03     4s
  45   4.13485748e+04  4.15457108e+04  1.31e-03 2.98e-05  1.04e-03     4s
  46   4.14309940e+04  4.15307997e+04  5.78e-04 4.45e-05  5.28e-04     4s
  47   4.14508170e+04  4.15186682e+04  4.25e-04 2.00e-05  3.59e-04     4s
  48   4.14643323e+04  4.15151804e+04  3.22e-04 1.26e-05  2.69e-04     4s
  49   4.14704542e+04  4.15144851e+04  2.74e-04 1.15e-05  2.33e-04     5s
  50   4.14858850e+04  4.15127686e+04  1.59e-04 7.91e-06  1.42e-04     5s
  51   4.15040809e+04  4.15109736e+04  2.84e-05 4.37e-06  3.64e-05     5s
  52   4.15078772e+04  4.15089309e+04  3.39e-06 4.67e-06  5.56e-06     5s
  53   4.15083237e+04  4.15085565e+04  7.07e-07 8.97e-07  1.23e-06     5s
  54   4.15084509e+04  4.15084659e+04  5.43e-08 4.54e-08  7.89e-08     5s
  55   4.15084599e+04  4.15084599e+04  1.95e-09 3.19e-10  2.64e-11     5s

Barrier solved model in 55 iterations and 4.76 seconds (9.28 work units)
Optimal objective 4.15084599e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1620 PPushes remaining with PInf 3.1835084e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.0478179e-11      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34811    4.1508460e+04   0.000000e+00   0.000000e+00      6s
   34811    4.1508460e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.19s

Solved with barrier

Root relaxation: objective 4.150846e+04, 34811 iterations, 3.99 seconds (8.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41508.4599    0  202 -208513.72 41508.4599   120%     -    6s
H    0     0                    -203328.8297 41508.4599   120%     -    6s
H    0     0                    -109151.0571 41508.4599   138%     -    6s
H    0     0                    -84893.70607 41508.4599   149%     -    6s
H    0     0                    -84470.18172 41508.4599   149%     -    6s
H    0     0                    -64913.65558 41508.4599   164%     -    6s
H    0     0                    -43525.08400 41508.4599   195%     -    6s
H    0     0                    8511.3226508 41508.4599   388%     -    6s
H    0     0                    16212.841715 41508.4599   156%     -    7s
H    0     0                    17135.696891 41508.4599   142%     -    7s
H    0     0                    17145.630751 41508.4599   142%     -    7s
H    0     0                    17145.963888 41508.4599   142%     -    7s
     0     0 36985.8628    0  365 17145.9639 36985.8628   116%     -   31s
     0     0 36344.3732    0  449 17145.9639 36344.3732   112%     -   42s
     0     0 36265.5788    0  446 17145.9639 36265.5788   112%     -   47s
     0     0 36213.0769    0  455 17145.9639 36213.0769   111%     -   50s
     0     0 36210.0164    0  453 17145.9639 36210.0164   111%     -   51s
     0     0 36210.0164    0  453 17145.9639 36210.0164   111%     -   51s
H    0     0                    17178.284366 33419.0708  94.5%     -   88s
H    0     0                    17212.750942 33419.0708  94.2%     -   88s
H    0     0                    17222.421743 33419.0708  94.0%     -   88s
H    0     0                    17252.917532 33419.0708  93.7%     -   88s
H    0     0                    17286.947024 33419.0708  93.3%     -   88s
     0     0 33288.3751    0  379 17286.9470 33288.3751  92.6%     -   90s
H    0     0                    20031.496294 33288.3751  66.2%     -   90s
H    0     0                    20200.388845 33288.3751  64.8%     -   90s
H    0     0                    20249.672853 33288.3751  64.4%     -   90s
     0     0 33064.5974    0  365 20249.6729 33064.5974  63.3%     -  118s
H    0     0                    20317.053071 32737.8249  61.1%     -  135s
H    0     0                    20317.133762 32737.8249  61.1%     -  135s
H    0     0                    20414.677581 32737.8249  60.4%     -  135s
H    0     0                    20451.309228 32737.8249  60.1%     -  135s
H    0     0                    20461.582052 32737.8249  60.0%     -  135s
     0     0 32737.8249    0  407 20461.5821 32737.8249  60.0%     -  135s
     0     0 32694.7647    0  361 20461.5821 32694.7647  59.8%     -  139s
     0     0 32458.7535    0  370 20461.5821 32458.7535  58.6%     -  149s
     0     0 32445.7670    0  372 20461.5821 32445.7670  58.6%     -  153s
     0     0 32430.3561    0  428 20461.5821 32430.3561  58.5%     -  156s
     0     0 32354.6426    0  377 20461.5821 32354.6426  58.1%     -  161s
     0     0 32350.6463    0  374 20461.5821 32350.6463  58.1%     -  163s
     0     0 32344.5697    0  371 20461.5821 32344.5697  58.1%     -  164s
     0     0 32344.4874    0  371 20461.5821 32344.4874  58.1%     -  165s
     0     0 29882.7986    0  306 20461.5821 29882.7986  46.0%     -  206s
     0     0 29085.7176    0  421 20461.5821 29085.7176  42.1%     -  234s
     0     0 28885.4959    0  320 20461.5821 28885.4959  41.2%     -  251s
     0     0 28860.8554    0  328 20461.5821 28860.8554  41.0%     -  257s
     0     0 28813.3892    0  326 20461.5821 28813.3892  40.8%     -  265s
     0     0 28801.2325    0  326 20461.5821 28801.2325  40.8%     -  267s
     0     0 28786.2933    0  325 20461.5821 28786.2933  40.7%     -  270s
     0     0 28775.3994    0  323 20461.5821 28775.3994  40.6%     -  273s
     0     0 28751.1388    0  427 20461.5821 28751.1388  40.5%     -  281s
     0     0 28747.5994    0  319 20461.5821 28747.5994  40.5%     -  283s
     0     0 28743.8919    0  436 20461.5821 28743.8919  40.5%     -  285s
     0     0 28741.9715    0  441 20461.5821 28741.9715  40.5%     -  287s
     0     0 28741.3125    0  424 20461.5821 28741.3125  40.5%     -  289s
H    0     0                    20518.267151 28741.3125  40.1%     -  294s
H    0     0                    20548.682091 28741.3125  39.9%     -  294s
     0     0 28131.5960    0  462 20548.6821 28131.5960  36.9%     -  317s
     0     0 27778.1191    0  414 20548.6821 27778.1191  35.2%     -  333s
     0     0 27616.0290    0  333 20548.6821 27616.0290  34.4%     -  344s
     0     0 27580.4383    0  330 20548.6821 27580.4383  34.2%     -  351s
     0     0 27553.3356    0  425 20548.6821 27553.3356  34.1%     -  359s
H    0     0                    20551.913722 27519.3532  33.9%     -  367s
     0     0 27519.3532    0  422 20551.9137 27519.3532  33.9%     -  368s
     0     0 27507.8311    0  425 20551.9137 27507.8311  33.8%     -  372s
     0     0 27499.9592    0  419 20551.9137 27499.9592  33.8%     -  375s
     0     0 27499.1602    0  425 20551.9137 27499.1602  33.8%     -  376s
     0     0 27427.1035    0  283 20551.9137 27427.1035  33.5%     -  389s
     0     0 27406.1155    0  347 20551.9137 27406.1155  33.4%     -  396s
     0     0 27393.5969    0  412 20551.9137 27393.5969  33.3%     -  400s
     0     0 27388.6504    0  414 20551.9137 27388.6504  33.3%     -  403s
     0     0 27387.4546    0  421 20551.9137 27387.4546  33.3%     -  406s
     0     0 27364.1365    0  325 20551.9137 27364.1365  33.1%     -  413s
     0     0 27356.3293    0  344 20551.9137 27356.3293  33.1%     -  415s
     0     0 27352.4628    0  338 20551.9137 27352.4628  33.1%     -  418s
     0     0 27350.1830    0  332 20551.9137 27350.1830  33.1%     -  419s
     0     0 27349.6684    0  332 20551.9137 27349.6684  33.1%     -  420s
     0     0 27335.4250    0  338 20551.9137 27335.4250  33.0%     -  425s
     0     0 27332.5769    0  263 20551.9137 27332.5769  33.0%     -  429s
     0     0 27330.4821    0  269 20551.9137 27330.4821  33.0%     -  431s
     0     0 27330.4781    0  269 20551.9137 27330.4781  33.0%     -  431s
     0     0 27319.9794    0  328 20551.9137 27319.9794  32.9%     -  434s
     0     0 27317.6563    0  338 20551.9137 27317.6563  32.9%     -  436s
     0     0 27316.3115    0  326 20551.9137 27316.3115  32.9%     -  438s
     0     0 27311.2255    0  404 20551.9137 27311.2255  32.9%     -  442s
     0     0 27304.7455    0  332 20551.9137 27304.7455  32.9%     -  444s
     0     0 27303.5584    0  406 20551.9137 27303.5584  32.9%     -  445s
     0     0 27275.0924    0  336 20551.9137 27275.0924  32.7%     -  453s
     0     0 27272.5203    0  338 20551.9137 27272.5203  32.7%     -  456s
     0     0 27272.2223    0  325 20551.9137 27272.2223  32.7%     -  457s
     0     0 27271.8020    0  233 20551.9137 27271.8020  32.7%     -  460s
     0     0 27269.8893    0  233 20551.9137 27269.8893  32.7%     -  461s
     0     0 27267.4788    0  234 20551.9137 27267.4788  32.7%     -  463s
H    0     0                    20554.144989 27263.8763  32.6%     -  468s
     0     0 27263.8763    0  234 20554.1450 27263.8763  32.6%     -  468s
     0     0 27263.8763    0  270 20554.1450 27263.8763  32.6%     -  474s
     0     0 27263.7788    0  237 20554.1450 27263.7788  32.6%     -  479s
     0     0 27263.7534    0  270 20554.1450 27263.7534  32.6%     -  480s
     0     0 27263.2759    0  270 20554.1450 27263.2759  32.6%     -  482s
H    0     0                    20596.928670 27263.2759  32.4%     -  494s
H    0     0                    20679.197139 27263.2759  31.8%     -  495s
     0     2 27263.2759    0  270 20679.1971 27263.2759  31.8%     -  506s
     1     4 27128.1437    1  320 20679.1971 27263.0067  31.8%  9024  517s
     3     7 26243.6569    2  337 20679.1971 27128.1161  31.2% 12053  537s
     6    14 25419.2524    3  348 20679.1971 27127.2582  31.2% 16115  551s
    13    22 24225.9062    4  286 20679.1971 26742.6266  29.3% 12123  570s
    25    31 22511.2175    5  152 20679.1971 26739.4414  29.3% 16065  598s
    34    60 25855.7966    4  546 20679.1971 26053.0331  26.0% 14404  660s
H   36    60                    20700.418427 26053.0331  25.9% 13853  660s
    63    82 25575.7810    5  345 20700.4184 25909.5707  25.2% 16207  686s
    95   190 25556.8342    6  344 20700.4184 25714.0395  24.2% 17614  718s
   203   281 25551.2916    7  338 20700.4184 25714.0395  24.2% 10810  738s
   308   300 25072.9831    8  333 20700.4184 25714.0395  24.2%  8330  751s
   341   319 23389.7837   15  453 20700.4184 25714.0395  24.2%  7969  767s
   380   339 25000.9466    9  339 20700.4184 25714.0395  24.2%  7500  781s
   411   362 24694.5349   10  338 20700.4184 25714.0395  24.2%  7318  800s
   447   376 24729.4289   10  339 20700.4184 25714.0395  24.2%  7142  817s
   481   398 24602.6874   11  342 20700.4184 25714.0395  24.2%  7008  833s
   515   438 24635.0686   11  334 20700.4184 25714.0395  24.2%  6832  850s
   561   465 21599.9704   20  352 20700.4184 25714.0395  24.2%  6551  867s
   625   509 22663.7089   12  400 20700.4184 25714.0395  24.2%  6240  883s
   685   537 22386.9723   13  335 20700.4184 25714.0395  24.2%  5996  898s
   744   552 22231.2560   14  322 20700.4184 25714.0395  24.2%  5740  912s
   803   558 21627.1475   14  239 20700.4184 25714.0395  24.2%  5521  928s
   864   568 21923.2945   15  324 20700.4184 25714.0395  24.2%  5340  943s
   910   583 21938.3406   15  409 20700.4184 25714.0395  24.2%  5282  959s
   979   606 infeasible   16      20700.4184 25514.9179  23.3%  5087  975s
  1058   660 21102.6311   17  391 20700.4184 25514.9179  23.3%  4948  992s
  1156   687 infeasible   18      20700.4184 25514.9179  23.3%  4708 1010s
  1254   704     cutoff   19      20700.4184 25514.9179  23.3%  4547 1028s
  1347   732     cutoff   20      20700.4184 25514.9179  23.3%  4442 1046s
  1458   758 infeasible   21      20700.4184 25514.9179  23.3%  4338 1067s
  1545   814 24179.9853    8  263 20700.4184 25514.9179  23.3%  4294 1089s
  1633   917 22825.9616    9  255 20700.4184 25514.9179  23.3%  4256 1107s
  1784   931 22155.0461    9  292 20700.4184 25514.9179  23.3%  4078 1128s
  1826   943 22197.0498   10  312 20700.4184 25514.9179  23.3%  4077 1147s
  1873   970 21415.1826   10  278 20700.4184 25514.9179  23.3%  4069 1165s
  1934  1046 infeasible   10      20700.4184 25514.9179  23.3%  4014 1185s
  2070  1088 22191.6656   11  298 20700.4184 25514.9179  23.3%  3867 1207s
  2212  1128 21844.1420   13  260 20700.4184 25514.9179  23.3%  3753 1243s
  2341  1165 21093.0967   14  267 20700.4184 25514.9179  23.3%  3681 1269s
  2462  1252 20965.4021   15  274 20700.4184 24751.0355  19.6%  3653 1297s
  2613  1319     cutoff   16      20700.4184 24536.9577  18.5%  3588 1326s
  2800  1396 22694.8734   12  371 20700.4184 24508.8909  18.4%  3527 1355s
  2976  1430 22019.1463   14  186 20700.4184 24508.8909  18.4%  3516 1388s
  3107  1477 21810.6819   16  141 20700.4184 24508.8909  18.4%  3543 1421s
  3238  1550 infeasible   20      20700.4184 24404.3179  17.9%  3579 1452s
  3412  1647 22028.8379   12  204 20700.4184 24404.3179  17.9%  3564 1485s
  3625  1800 infeasible   17      20700.4184 24201.9011  16.9%  3534 1521s
  3893  1918     cutoff   38      20700.4184 24201.9011  16.9%  3478 1557s
  4167  2033 21682.9016   15  197 20700.4184 24139.2642  16.6%  3434 1593s
  4391  2159 20862.8116   22  212 20700.4184 24037.2296  16.1%  3396 1630s
  4611  2160 21085.8607   42  270 20700.4184 24037.2296  16.1%  3387 1762s
  4613  2161 22276.9823   14  160 20700.4184 24037.2296  16.1%  3385 1771s
  4614  2162 21329.7497   21  310 20700.4184 24037.2296  16.1%  3384 1821s
  4615  2163 21107.9843   20  267 20700.4184 24037.2296  16.1%  3384 1856s
  4616  2163 21286.1580   45  387 20700.4184 24037.2296  16.1%  3383 1883s
  4617  2164 21394.7871   22  348 20700.4184 24037.2296  16.1%  3382 1904s
  4618  2165 21879.4255   13  363 20700.4184 24037.2296  16.1%  3382 1911s
  4619  2165 20836.6904   43  351 20700.4184 24037.2296  16.1%  3381 1922s
  4620  2166 21415.7420   36  339 20700.4184 24037.2296  16.1%  3380 1931s
  4621  2167 21530.1223   28  346 20700.4184 24037.2296  16.1%  3379 1937s
  4622  2167 22643.0018   15  350 20700.4184 24037.2296  16.1%  3379 1957s
  4623  2168 22181.1795    9  389 20700.4184 24037.2296  16.1%  3378 1966s
  4624  2169 20872.5401   56  351 20700.4184 24037.2296  16.1%  3377 1974s
  4625  2169 21419.8991   31  344 20700.4184 24037.2296  16.1%  3376 1993s
  4626  2170 22916.2676   14  444 20700.4184 24037.2296  16.1%  3376 2007s
  4627  2171 21050.5100   37  397 20700.4184 24037.2296  16.1%  3375 2017s
  4628  2171 22153.6856   21  440 20700.4184 24037.2296  16.1%  3374 2034s
  4629  2172 23148.3059    7  397 20700.4184 24037.2296  16.1%  3373 2044s
  4630  2173 21301.7628   20  347 20700.4184 24037.2296  16.1%  3373 2047s
  4631  2173 21387.2653   17  341 20700.4184 24037.2296  16.1%  3372 2051s
  4632  2174 21440.6218   34  351 20700.4184 24037.2296  16.1%  3371 2064s
  4633  2175 20742.6804   65  360 20700.4184 24037.2296  16.1%  3371 2070s
  4635  2176 21092.2337   28  414 20700.4184 24037.2296  16.1%  3369 2087s
  4636  2177 21351.6076   25  406 20700.4184 24037.2296  16.1%  3368 2095s
  4637  2177 21031.8488   19  416 20700.4184 24037.2296  16.1%  3368 2109s
  4638  2178 21386.2339   38  424 20700.4184 24037.2296  16.1%  3367 2116s
  4639  2179 23614.4239    8  364 20700.4184 24037.2296  16.1%  3366 2125s
  4640  2179 21462.4128   24  414 20700.4184 24037.2296  16.1%  3365 2130s
  4641  2180 23392.7293    9  419 20700.4184 24037.2296  16.1%  3365 2137s
  4642  2181 20863.5788   36  419 20700.4184 24037.2296  16.1%  3364 2150s
  4643  2181 21657.3953   15  419 20700.4184 24037.2296  16.1%  3363 2175s
  4644  2184 24037.2296   16  350 20700.4184 24037.2296  16.1%  3433 2203s
  4645  2186 24037.2296   17  356 20700.4184 24037.2296  16.1%  3434 2225s
  4647  2190 24037.2296   17  414 20700.4184 24037.2296  16.1%  3437 2257s
  4652  2198 24037.2296   18  457 20700.4184 24037.2296  16.1%  3442 2275s
  4662  2201 23972.8431   19  288 20700.4184 24037.2296  16.1%  3461 2319s
  4672  2221 22629.3292   20  251 20700.4184 24037.2296  16.1%  3485 2360s
  4695  2239 22425.3430   21  258 20700.4184 24037.2296  16.1%  3594 2379s
  4727  2311 22332.6943   22  258 20700.4184 24037.2296  16.1%  3630 2404s
  4826  2305 22131.8340   23  220 20700.4184 24037.2296  16.1%  3619 2421s
  4876  2301 infeasible   25      20700.4184 24037.2296  16.1%  3612 2438s
  4944  2290 21992.4299   25  235 20700.4184 24037.2296  16.1%  3618 2462s
  5008  2270 21541.4396   26  232 20700.4184 24037.2296  16.1%  3619 2484s
  5076  2252     cutoff   27      20700.4184 24037.2296  16.1%  3617 2500s
  5151  2234     cutoff   33      20700.4184 24037.2296  16.1%  3617 2513s
  5186  2226 infeasible   27      20700.4184 24037.2296  16.1%  3621 2535s
  5235  2210 infeasible   28      20700.4184 24037.2296  16.1%  3611 2550s
  5310  2172 infeasible   30      20700.4184 24037.2296  16.1%  3594 2566s
  5400  2148 20798.8047   36  128 20700.4184 24037.2296  16.1%  3573 2586s
  5482  2128 21359.3041   25  256 20700.4184 24037.2296  16.1%  3548 2600s
  5562  2106     cutoff   26      20700.4184 24037.2296  16.1%  3525 2612s
  5651  2079 21979.3570   28  254 20700.4184 24037.2296  16.1%  3499 2630s
  5764  2067 21965.6112   31  298 20700.4184 24037.2296  16.1%  3464 2644s
  5874  2049 infeasible   34      20700.4184 24037.2296  16.1%  3432 2659s
  5991  2017 infeasible   32      20700.4184 24037.2296  16.1%  3397 2674s
  6130  1993 23443.3482   21  262 20700.4184 24037.2296  16.1%  3355 2690s
  6267  1960 21881.2767   22  255 20700.4184 23903.9323  15.5%  3316 2706s
  6369  1937 21865.1901   23  245 20700.4184 23903.9323  15.5%  3285 2723s
  6409  1932 21272.7407   24  215 20700.4184 23903.9323  15.5%  3283 2741s
  6452  1924 21268.4420   25  213 20700.4184 23903.9323  15.5%  3284 2755s
  6493  1919 21498.3645   26  256 20700.4184 23903.9323  15.5%  3279 2771s
  6561  1918 20871.5826   26  187 20700.4184 23903.9323  15.5%  3269 2788s
  6693  1886 20852.8238   27  185 20700.4184 23903.9323  15.5%  3227 2804s
  6878  1815 20826.4662   28  187 20700.4184 23903.9323  15.5%  3169 2822s
  7053  1794 infeasible   24      20700.4184 23903.9323  15.5%  3130 2839s
  7334  1753 21731.6981   45  245 20700.4184 23903.9323  15.5%  3039 2860s
  7657  1677 infeasible   56      20700.4184 23903.9323  15.5%  2956 2877s
  7899  1646 21608.8682   43  129 20700.4184 23903.9323  15.5%  2897 2894s
  8216  1592 21288.4763   60  151 20700.4184 23903.9323  15.5%  2832 2912s
  8651  1453 21141.8465   70  109 20700.4184 23903.9323  15.5%  2728 2929s
  9164  1301     cutoff   85      20700.4184 23903.9323  15.5%  2626 2949s
  9677  1153 infeasible   35      20700.4184 21760.1920  5.12%  2530 2967s
 10308   940 21040.3724   45  103 20700.4184 21760.1920  5.12%  2418 2982s
 11014   764 20970.6223   37  116 20700.4184 21639.4621  4.54%  2309 2995s
 11849   812 20843.7557  106   34 20700.4184 21429.2511  3.52%  2188 3009s
 12969   982 infeasible   72      20700.4184 21025.5722  1.57%  2046 3020s
 14286  1028 20724.4501   98   34 20700.4184 20926.9433  1.09%  1902 3030s
 15615  1012     cutoff  102      20700.4184 20864.8983  0.79%  1781 3040s
 15681  1017     cutoff  117      20700.4184 20858.8085  0.77%  1777 3049s
 15728  1012 20837.9046   85   32 20700.4184 20858.8085  0.77%  1774 3058s
 15786  1014 20792.8906   86   28 20700.4184 20854.9832  0.75%  1769 3068s
 15832  1021     cutoff   85      20700.4184 20850.4444  0.72%  1765 3078s
 16135  1033 20732.3743   88   34 20700.4184 20847.8833  0.71%  1740 3089s
 16943  1040 20755.7732   87   27 20700.4184 20845.5415  0.70%  1679 3101s
 17991   949     cutoff   73      20700.4184 20833.8481  0.64%  1611 3113s
 19503   685 20723.4821  118   28 20700.4184 20799.8031  0.48%  1524 3123s
 21066   351 20747.7718   78   26 20700.4184 20770.6190  0.34%  1448 3135s
 22885    18 20736.2489   82    8 20700.4184 20737.4355  0.18%  1367 3145s

Cutting planes:
  Gomory: 43
  Implied bound: 52
  Projected implied bound: 289
  MIR: 1068
  Mixing: 10
  Flow cover: 2095
  RLT: 35
  Relax-and-lift: 279

Explored 23717 nodes (32207579 simplex iterations) in 3145.97 seconds (8690.47 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20700.4 20679.2 20596.9 ... 20414.7

Optimal solution found (tolerance 1.00e-04)
Best objective 2.070041842658e+04, best bound 2.070041842658e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3146.01s
  Master Objective (UB) = 20700.42, θ = 140351.24
  Upper Bound (UB) = 20700.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140351.24
  [DEBUG]   ✓ Scenario 0: θ = 140351.24 ≤ Q = 140351.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140351.24 ≤ Q = 140373.19 (slack: 21.95)
  [DEBUG]   ✓ Scenario 2: θ = 140351.24 ≤ Q = 140351.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140351.24 ≤ Q = 140351.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140351.24 ≤ Q = 140351.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140351.24 ≤ Q = 140351.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140351.24 ≤ Q = 140351.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140351.24 ≤ Q = 140351.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140351.24 ≤ Q = 140351.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140351.24 ≤ Q = 140351.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140351.24 ≤ Q = 140351.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140351.24 ≤ Q = 140351.24 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x143f7850
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xebc087b0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7496039.4731
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.360259e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136025.95    0  123 7496039.47 -136025.95   102%     -    0s
H    0     0                    -101160.3252 -136025.95  34.5%     -    0s
     0     0 -106985.02    0  127 -101160.33 -106985.02  5.76%     -    0s
H    0     0                    -105015.3520 -106985.01  1.88%     -    0s
     0     0 -106201.13    0   84 -105015.35 -106201.13  1.13%     -    0s
H    0     0                    -105071.1871 -106195.05  1.07%     -    0s
H    0     0                    -105173.2235 -106195.05  0.97%     -    0s
     0     0 -105924.27    0   85 -105173.22 -105924.27  0.71%     -    0s
     0     0 -105866.94    0   85 -105173.22 -105866.94  0.66%     -    0s
     0     0 -105693.71    0   86 -105173.22 -105693.71  0.49%     -    0s
     0     0 -105685.43    0   86 -105173.22 -105685.43  0.49%     -    0s
     0     2 -105677.67    0   86 -105173.22 -105677.67  0.48%     -    0s
H   72    16                    -105204.1714 -105316.05  0.11%  12.9    0s
H   97    11                    -105205.9846 -105266.10  0.06%  11.5    0s
*  150     3              18    -105215.9688 -105236.50  0.02%   9.0    0s

Cutting planes:
  Gomory: 43
  Implied bound: 9
  MIR: 177
  Flow cover: 7
  BQP: 2

Explored 157 nodes (1917 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -105216 -105206 -105204 ... 1.43567e+13
No other solutions better than -105216

Optimal solution found (tolerance 1.00e-04)
Best objective -1.052159687599e+05, best bound -1.052159687599e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 139212.69
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105215.97
  [DEBUG]   S×d_nominal = 244428.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244428.66 + -105215.97 = 139212.69
  [DEBUG]   Current θ from Master = 140351.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1138.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19561.87
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 856.4816, Absolute Gap = 856.4816, Relative Gap = 0.041375
  Not converged yet (gap = 856.48 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567639 nonzeros
Model fingerprint: 0x1cdb526a
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87971 rows and 35711 columns
Presolve time: 1.64s
Presolved: 112182 rows, 47669 columns, 675682 nonzeros
Variable types: 45410 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361157.3128
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 599
 AA' NZ     : 4.409e+06
 Factor NZ  : 1.102e+07 (roughly 150 MB of memory)
 Factor Ops : 3.003e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79336166e+07  1.93357731e+08  1.03e+05 2.31e+01  7.17e+04     3s
   1  -1.35233356e+07  1.68735059e+08  7.10e+04 6.90e+01  4.90e+04     3s
   2  -4.45505592e+06  1.24207122e+08  2.32e+04 8.21e-01  1.69e+04     3s
   3  -8.07996209e+05  8.67483199e+07  1.91e+03 2.06e+00  1.73e+03     3s
   4  -4.81902159e+05  4.28985485e+07  4.55e+02 7.48e-01  4.89e+02     3s
   5  -3.79524454e+05  2.71789662e+07  1.82e+02 3.90e-01  2.36e+02     3s
   6  -2.85310204e+05  2.08881226e+07  6.35e+01 2.81e-01  1.36e+02     3s
   7  -1.83204059e+05  1.53616938e+07  1.79e+01 1.97e-01  8.34e+01     3s
   8  -1.18693702e+05  8.64339691e+06  7.31e+00 1.05e-01  4.47e+01     3s
   9  -8.91024769e+04  4.97567405e+06  4.76e+00 5.86e-02  2.55e+01     3s
  10  -5.16721374e+04  1.98974919e+06  2.06e+00 2.17e-02  1.01e+01     3s
  11  -2.92701363e+04  9.05360769e+05  1.19e+00 9.69e-03  4.60e+00     3s
  12  -1.51785827e+04  3.86046076e+05  7.18e-01 3.40e-03  1.97e+00     3s
  13  -6.66461492e+03  2.19376886e+05  4.78e-01 1.83e-03  1.11e+00     3s
  14  -5.48572225e+02  1.54819989e+05  3.57e-01 1.96e-03  7.60e-01     3s
  15   4.25819652e+03  1.28276236e+05  2.82e-01 2.37e-03  6.06e-01     4s
  16   1.18798437e+04  1.03784139e+05  1.81e-01 2.68e-03  4.49e-01     4s
  17   1.59072176e+04  8.65860652e+04  1.50e-01 1.44e-03  3.45e-01     4s
  18   2.02434717e+04  7.38890549e+04  1.18e-01 1.62e-03  2.62e-01     4s
  19   2.20761982e+04  6.73415037e+04  1.05e-01 1.38e-03  2.21e-01     4s
  20   2.47462389e+04  6.19079262e+04  8.72e-02 1.65e-03  1.81e-01     4s
  21   2.77971677e+04  5.63813260e+04  6.81e-02 1.80e-03  1.40e-01     4s
  22   3.06641075e+04  5.45556475e+04  5.07e-02 1.61e-03  1.17e-01     4s
  23   3.20979513e+04  5.17325668e+04  4.26e-02 1.54e-03  9.58e-02     4s
  24   3.25149150e+04  4.86272010e+04  4.03e-02 1.67e-03  7.87e-02     4s
  25   3.50262544e+04  4.65586790e+04  2.75e-02 1.25e-03  5.63e-02     4s
  26   3.54932387e+04  4.58900800e+04  2.53e-02 1.11e-03  5.07e-02     4s
  27   3.61807652e+04  4.50821487e+04  2.18e-02 9.32e-04  4.34e-02     4s
  28   3.71012612e+04  4.44200014e+04  1.74e-02 7.91e-04  3.57e-02     4s
  29   3.81506777e+04  4.37075216e+04  1.26e-02 1.12e-03  2.71e-02     4s
  30   3.87957813e+04  4.32225520e+04  9.68e-03 8.94e-04  2.16e-02     4s
  31   3.89886590e+04  4.29846451e+04  8.78e-03 8.03e-04  1.95e-02     4s
  32   3.92651366e+04  4.28973709e+04  7.64e-03 7.67e-04  1.77e-02     4s
  33   3.94900808e+04  4.25550730e+04  6.67e-03 6.01e-04  1.50e-02     4s
  34   3.97059305e+04  4.21112227e+04  5.75e-03 3.73e-04  1.17e-02     4s
  35   4.00614460e+04  4.19421791e+04  4.29e-03 3.08e-04  9.18e-03     5s
  36   4.04684671e+04  4.17768957e+04  2.55e-03 2.42e-04  6.38e-03     5s
  37   4.06212464e+04  4.15916034e+04  1.90e-03 1.75e-04  4.73e-03     5s
  38   4.06495765e+04  4.14210509e+04  1.78e-03 1.20e-04  3.76e-03     5s
  39   4.07870399e+04  4.13586987e+04  1.25e-03 9.18e-05  2.79e-03     5s
  40   4.08804321e+04  4.13257297e+04  8.89e-04 7.94e-05  2.17e-03     5s
  41   4.09555961e+04  4.13119258e+04  5.99e-04 7.47e-05  1.74e-03     5s
  42   4.09950250e+04  4.11962834e+04  4.32e-04 3.02e-05  9.82e-04     5s
  43   4.10728049e+04  4.11333022e+04  1.43e-04 1.40e-05  2.95e-04     5s
  44   4.11034616e+04  4.11271320e+04  3.24e-05 9.62e-06  1.15e-04     5s
  45   4.11073698e+04  4.11211879e+04  1.83e-05 5.58e-06  6.74e-05     5s
  46   4.11084920e+04  4.11144942e+04  1.45e-05 1.56e-06  2.93e-05     5s
  47   4.11110336e+04  4.11134662e+04  5.35e-06 6.08e-07  1.19e-05     5s
  48   4.11123224e+04  4.11128548e+04  1.33e-06 3.79e-08  2.60e-06     5s
  49   4.11127580e+04  4.11128017e+04  8.93e-08 1.22e-09  2.13e-07     5s
  50   4.11127976e+04  4.11127976e+04  3.82e-09 2.25e-09  5.95e-11     5s

Barrier solved model in 50 iterations and 5.34 seconds (10.10 work units)
Optimal objective 4.11127976e+04


Root crossover log...

   98154 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2070 PPushes remaining with PInf 1.3795452e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.3216546e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38517    4.1112798e+04   0.000000e+00   0.000000e+00      7s
   38517    4.1112798e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.09s

Solved with barrier

Root relaxation: objective 4.111280e+04, 38517 iterations, 4.95 seconds (10.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41112.7976    0  199 -208513.72 41112.7976   120%     -    7s
H    0     0                    -201835.2637 41112.7976   120%     -    7s
H    0     0                    -201255.9636 41112.7976   120%     -    7s
H    0     0                    -166965.9044 41112.7976   125%     -    7s
H    0     0                    -166545.5462 41112.7976   125%     -    7s
H    0     0                    -157465.6359 41112.7976   126%     -    8s
H    0     0                    -152372.2147 41112.7976   127%     -    8s
H    0     0                    -152324.5498 41112.7976   127%     -    8s
H    0     0                    -152086.5334 41112.7976   127%     -    8s
H    0     0                    -152082.7906 41112.7976   127%     -    8s
H    0     0                    -152036.9278 41112.7976   127%     -    8s
H    0     0                    -152008.2655 41112.7976   127%     -    8s
H    0     0                    -151970.7363 41112.7976   127%     -    8s
H    0     0                    -151970.0353 41112.7976   127%     -    8s
H    0     0                    -41877.67473 41112.7976   198%     -    8s
H    0     0                    8709.8804818 41112.7976   372%     -    8s
H    0     0                    16053.696878 41112.7976   156%     -    9s
H    0     0                    17135.696891 41112.7976   140%     -    9s
H    0     0                    17141.491094 41112.7976   140%     -    9s
H    0     0                    17235.035857 36526.6629   112%     -   33s
     0     0 36526.6629    0  445 17235.0359 36526.6629   112%     -   34s
     0     0 35932.1720    0  443 17235.0359 35932.1720   108%     -   45s
     0     0 35883.4594    0  452 17235.0359 35883.4594   108%     -   49s
     0     0 35834.7281    0  441 17235.0359 35834.7281   108%     -   53s
     0     0 35834.7281    0  447 17235.0359 35834.7281   108%     -   54s
     0     0 35834.7281    0  456 17235.0359 35834.7281   108%     -   57s
     0     0 33086.0493    0  324 17235.0359 33086.0493  92.0%     -  107s
H    0     0                    19892.127748 33086.0493  66.3%     -  107s
H    0     0                    20024.325643 33086.0493  65.2%     -  107s
H    0     0                    20025.227422 33086.0493  65.2%     -  107s
     0     0 32495.4250    0  448 20025.2274 32495.4250  62.3%     -  148s
     0     0 32375.4465    0  493 20025.2274 32375.4465  61.7%     -  170s
H    0     0                    20113.380736 32226.1860  60.2%     -  190s
H    0     0                    20256.447729 32226.1860  59.1%     -  190s
H    0     0                    20266.118530 32226.1860  59.0%     -  190s
     0     0 32226.1860    0  503 20266.1185 32226.1860  59.0%     -  190s
H    0     0                    20269.851724 32141.0038  58.6%     -  211s
     0     0 32141.0038    0  504 20269.8517 32141.0038  58.6%     -  211s
     0     0 32103.0693    0  507 20269.8517 32103.0693  58.4%     -  222s
     0     0 32068.4518    0  553 20269.8517 32068.4518  58.2%     -  234s
     0     0 32017.6539    0  567 20269.8517 32017.6539  58.0%     -  242s
     0     0 31997.9461    0  574 20269.8517 31997.9461  57.9%     -  250s
H    0     0                    20293.519105 31986.2664  57.6%     -  256s
     0     0 31986.2664    0  528 20293.5191 31986.2664  57.6%     -  256s
H    0     0                    20301.851393 31978.9528  57.5%     -  263s
     0     0 31978.9528    0  523 20301.8514 31978.9528  57.5%     -  263s
H    0     0                    20316.473932 31951.1231  57.3%     -  268s
H    0     0                    20358.925643 31951.1231  56.9%     -  268s
     0     0 31951.1231    0  512 20358.9256 31951.1231  56.9%     -  268s
     0     0 31950.0365    0  566 20358.9256 31950.0365  56.9%     -  270s
     0     0 29891.0534    0  246 20358.9256 29891.0534  46.8%     -  332s
H    0     0                    20431.397006 29890.7202  46.3%     -  333s
H    0     0                    20465.678988 29890.7202  46.1%     -  333s
     0     0 29316.8025    0  254 20465.6790 29316.8025  43.2%     -  357s
H    0     0                    20499.417206 29154.2595  42.2%     -  371s
H    0     0                    20545.782525 29154.2595  41.9%     -  371s
H    0     0                    20593.931614 29154.2595  41.6%     -  371s
     0     0 29154.2595    0  242 20593.9316 29154.2595  41.6%     -  371s
     0     0 29048.1078    0  309 20593.9316 29048.1078  41.1%     -  381s
     0     0 28945.3949    0  251 20593.9316 28945.3949  40.6%     -  388s
     0     0 28904.7484    0  265 20593.9316 28904.7484  40.4%     -  393s
     0     0 28899.9169    0  319 20593.9316 28899.9169  40.3%     -  397s
     0     0 28788.1730    0  250 20593.9316 28788.1730  39.8%     -  407s
     0     0 28735.0246    0  258 20593.9316 28735.0246  39.5%     -  413s
     0     0 28694.6595    0  252 20593.9316 28694.6595  39.3%     -  419s
     0     0 28687.9772    0  254 20593.9316 28687.9772  39.3%     -  421s
     0     0 28675.0495    0  252 20593.9316 28675.0495  39.2%     -  425s
     0     0 28665.1778    0  254 20593.9316 28665.1778  39.2%     -  432s
     0     0 28646.7719    0  262 20593.9316 28646.7719  39.1%     -  436s
     0     0 28643.9014    0  259 20593.9316 28643.9014  39.1%     -  440s
     0     0 28643.5556    0  262 20593.9316 28643.5556  39.1%     -  441s
     0     0 28019.7450    0  424 20593.9316 28019.7450  36.1%     -  480s
     0     0 27797.2857    0  325 20593.9316 27797.2857  35.0%     -  494s
     0     0 27762.5766    0  331 20593.9316 27762.5766  34.8%     -  507s
     0     0 27751.0061    0  324 20593.9316 27751.0061  34.8%     -  514s
     0     0 27682.0614    0  412 20593.9316 27682.0614  34.4%     -  527s
     0     0 27649.3082    0  423 20593.9316 27649.3082  34.3%     -  539s
     0     0 27601.8482    0  426 20593.9316 27601.8482  34.0%     -  547s
     0     0 27590.0410    0  405 20593.9316 27590.0410  34.0%     -  551s
     0     0 27588.9755    0  412 20593.9316 27588.9755  34.0%     -  554s
     0     0 27470.0950    0  403 20593.9316 27470.0950  33.4%     -  570s
     0     0 27447.3288    0  461 20593.9316 27447.3288  33.3%     -  578s
     0     0 27444.1431    0  469 20593.9316 27444.1431  33.3%     -  582s
     0     0 27439.4490    0  464 20593.9316 27439.4490  33.2%     -  586s
     0     0 27436.1906    0  265 20593.9316 27436.1906  33.2%     -  588s
     0     0 27431.5147    0  319 20593.9316 27431.5147  33.2%     -  589s
     0     0 27431.0575    0  322 20593.9316 27431.0575  33.2%     -  590s
     0     0 27386.4419    0  455 20593.9316 27386.4419  33.0%     -  600s
     0     0 27366.6149    0  465 20593.9316 27366.6149  32.9%     -  606s
     0     0 27364.5960    0  471 20593.9316 27364.5960  32.9%     -  608s
     0     0 27364.2565    0  477 20593.9316 27364.2565  32.9%     -  610s
     0     0 27362.7998    0  471 20593.9316 27362.7998  32.9%     -  613s
     0     0 27361.6003    0  472 20593.9316 27361.6003  32.9%     -  615s
     0     0 27360.7085    0  231 20593.9316 27360.7085  32.9%     -  619s
     0     0 27360.5574    0  231 20593.9316 27360.5574  32.9%     -  620s
     0     0 27359.7555    0  323 20593.9316 27359.7555  32.9%     -  623s
     0     0 27359.0092    0  318 20593.9316 27359.0092  32.8%     -  625s
     0     0 27357.2337    0  233 20593.9316 27357.2337  32.8%     -  627s
     0     0 27357.0804    0  458 20593.9316 27357.0804  32.8%     -  628s
     0     0 27330.7661    0  381 20593.9316 27330.7661  32.7%     -  634s
H    0     0                    20595.979290 27289.4399  32.5%     -  643s
H    0     0                    20608.321891 27289.4399  32.4%     -  643s
     0     0 27289.4399    0  468 20608.3219 27289.4399  32.4%     -  643s
     0     0 27272.2109    0  489 20608.3219 27272.2109  32.3%     -  649s
     0     0 27267.3534    0  399 20608.3219 27267.3534  32.3%     -  651s
     0     0 27266.1191    0  399 20608.3219 27266.1191  32.3%     -  653s
     0     0 27209.5731    0  490 20608.3219 27209.5731  32.0%     -  664s
     0     0 27186.3905    0  608 20608.3219 27186.3905  31.9%     -  673s
     0     0 27179.6640    0  612 20608.3219 27179.6640  31.9%     -  676s
     0     0 27174.4904    0  612 20608.3219 27174.4904  31.9%     -  679s
     0     0 27163.3551    0  545 20608.3219 27163.3551  31.8%     -  683s
     0     0 27159.5215    0  529 20608.3219 27159.5215  31.8%     -  686s
     0     0 27157.9078    0  348 20608.3219 27157.9078  31.8%     -  688s
     0     0 27145.6819    0  526 20608.3219 27145.6819  31.7%     -  694s
     0     0 27143.9620    0  529 20608.3219 27143.9620  31.7%     -  697s
     0     0 27142.8869    0  528 20608.3219 27142.8869  31.7%     -  700s
     0     0 27142.2074    0  529 20608.3219 27142.2074  31.7%     -  701s
     0     0 27138.8944    0  535 20608.3219 27138.8944  31.7%     -  707s
     0     0 27138.6457    0  478 20608.3219 27138.6457  31.7%     -  709s
     0     0 27135.9248    0  477 20608.3219 27135.9248  31.7%     -  714s
     0     0 27135.8195    0  477 20608.3219 27135.8195  31.7%     -  718s
     0     2 27135.7459    0  477 20608.3219 27135.7459  31.7%     -  757s
     1     3 26598.7100    1  394 20608.3219 27135.6342  31.7% 19569  776s
     2     4 26750.7696    1  480 20608.3219 26750.7696  29.8% 14622  792s
     3     8 26361.7966    2  528 20608.3219 26750.2395  29.8% 16900  811s
     7    16 25971.5890    3  509 20608.3219 26361.3089  27.9% 13735  832s
    15    32 25961.3311    4  525 20608.3219 26052.3695  26.4% 14083  857s
    31    44 24460.4508    5  377 20608.3219 25961.3296  26.0% 17988  906s
    47    61 23938.9508    6  273 20608.3219 25961.3296  26.0% 20625  942s
    74   122 23924.2066    7  269 20608.3219 25961.3296  26.0% 16199  976s
   157   142 22746.6146    9  339 20608.3219 25961.3296  26.0% 13163 1001s
   189   184 23164.3654    9  267 20608.3219 25961.3296  26.0% 12242 1023s
H  196   184                    20610.677952 25961.3296  26.0% 12007 1023s
H  234   184                    20623.480595 25961.3296  25.9% 11831 1023s
   254   255 22400.5813   12  237 20623.4806 25961.3296  25.9% 11694 1044s
   345   330 22232.7122   14  243 20623.4806 25961.3296  25.9% 10193 1063s
   431   388 22070.3915   16  296 20623.4806 25961.3296  25.9%  8984 1079s
   499   466 21960.9912   20  300 20623.4806 25961.3296  25.9%  8518 1093s
   583   529 21812.8494   23  280 20623.4806 25961.3296  25.9%  7783 1108s
   663   553 21648.4119   26  283 20623.4806 25961.3296  25.9%  7219 1128s
   695   578 21628.9516   27  275 20623.4806 25961.3296  25.9%  7059 1149s
   734   600 21584.8435   28  360 20623.4806 25961.3296  25.9%  6869 1166s
   781   628 21507.6464   29  440 20623.4806 25961.3296  25.9%  6666 1179s
   822   647 21503.1577   30  427 20623.4806 25961.3296  25.9%  6512 1192s
H  844   647                    20631.144615 25961.3296  25.8%  6419 1192s
   865   683 21198.5730   31  399 20631.1446 25961.3296  25.8%  6359 1206s
   932   695 21103.2811   32  396 20631.1446 25961.3296  25.8%  6096 1225s
  1019   729 21051.3556   33  425 20631.1446 25961.3296  25.8%  5856 1240s
  1095   753 21046.9731   34  423 20631.1446 25961.3296  25.8%  5630 1255s
H 1131   753                    20642.372482 25961.3296  25.8%  5532 1255s
  1187   841 21026.0424   35  322 20642.3725 25961.3296  25.8%  5429 1273s
  1319   918     cutoff   41      20642.3725 25961.3296  25.8%  5102 1291s
  1479  1015 20699.8083   39  388 20642.3725 25961.3296  25.8%  4729 1312s
  1650  1047     cutoff   41      20642.3725 25737.1989  24.7%  4410 1329s
H 1765  1047                    20655.563994 25737.1989  24.6%  4221 1329s
  1770  1084 25099.5691    6  282 20655.5640 25737.1989  24.6%  4230 1349s
  1894  1133 24947.7043    7  359 20655.5640 25737.1989  24.6%  4103 1371s
  1975  1145 24647.4083    8  477 20655.5640 25737.1989  24.6%  4084 1390s
  2009  1167 infeasible   11      20655.5640 25737.1989  24.6%  4111 1411s
  2062  1191 24353.8176    9  326 20655.5640 25737.1989  24.6%  4102 1432s
  2112  1215 23822.3868   11  318 20655.5640 25737.1989  24.6%  4120 1451s
  2148  1248 23689.0525   12  319 20655.5640 25737.1989  24.6%  4159 1473s
  2209  1275 23205.9387   13  386 20655.5640 25737.1989  24.6%  4200 1497s
  2298  1324 21482.6837   14  224 20655.5640 25737.1989  24.6%  4201 1521s
  2407  1362 20803.8041   17  179 20655.5640 25737.1989  24.6%  4209 1550s
  2545  1419 22500.1130   11  246 20655.5640 25737.1989  24.6%  4171 1578s
  2645  1496 21838.8991   12  216 20655.5640 25737.1989  24.6%  4171 1604s
  2784  1575 infeasible   21      20655.5640 25737.1989  24.6%  4167 1631s
  2966  1659 22517.3846   12  500 20655.5640 25737.1989  24.6%  4103 1661s
  3129  1688 22377.5913   14  492 20655.5640 25737.1989  24.6%  4078 1683s
H 3153  1688                    20665.752922 25350.8037  22.7%  4082 1683s
  3174  1749 22329.4121   15  513 20665.7529 25350.8037  22.7%  4091 1713s
  3324  1775 21651.2006   19  498 20665.7529 25345.9336  22.6%  4095 1748s
  3439  1769 infeasible   19      20665.7529 24989.4885  20.9%  4118 1785s
  3525  1788 20827.9567   13  262 20665.7529 24989.4885  20.9%  4178 1821s
  3614  1797     cutoff    7      20665.7529 24989.4885  20.9%  4215 1860s
  3712  1820 20755.8616   40  109 20665.7529 24432.6796  18.2%  4264 1895s
  3793  1859 21448.7976   11  205 20665.7529 23764.5454  15.0%  4313 1936s
  3937  1902 21272.2195   14  322 20665.7529 23764.5454  15.0%  4326 1976s
  4062  1970 21179.9891   20  197 20665.7529 23695.6925  14.7%  4362 2020s
  4250  1989 20810.6540   29  341 20665.7529 23643.6295  14.4%  4344 2066s
  4435  1995 21192.1495   14  388 20665.7529 23513.2654  13.8%  4348 2104s
H 4438  1990                    20677.553146 23513.2654  13.7%  4346 2104s
H 4488  1983                    20699.131487 23513.2654  13.6%  4383 2104s
  4499  2088 21129.2999   15  434 20699.1315 23513.2654  13.6%  4382 2148s
  4735  2130 20874.7571   21  329 20699.1315 23401.9722  13.1%  4349 2199s
  4954  2182 21444.4842   16  348 20699.1315 23377.2415  12.9%  4352 2245s
  5096  2293 21139.8093   18  353 20699.1315 23347.4495  12.8%  4355 2301s
  5354  2294 22716.9618   16  477 20699.1315 23240.9796  12.3%  4337 2447s
  5356  2295 21728.5237   17  164 20699.1315 23240.9796  12.3%  4336 2456s
  5357  2296 20886.7344   21  373 20699.1315 23240.9796  12.3%  4335 2504s
  5358  2297 22263.7507   12  322 20699.1315 23240.9796  12.3%  4334 2541s
  5359  2297 22300.8905   14  345 20699.1315 23240.9796  12.3%  4333 2570s
  5360  2298 21127.2263   38  398 20699.1315 23240.9796  12.3%  4333 2589s
  5361  2299 21911.5329    9  352 20699.1315 23240.9796  12.3%  4332 2597s
  5362  2299 22337.5391   12  400 20699.1315 23240.9796  12.3%  4331 2606s
  5363  2300 21077.9559   27  354 20699.1315 23240.9796  12.3%  4330 2611s
  5364  2301 22102.0774   13  403 20699.1315 23240.9796  12.3%  4329 2634s
  5365  2301 20849.5380   23  289 20699.1315 23240.9796  12.3%  4329 2639s
  5366  2302 21298.7453   40  356 20699.1315 23240.9796  12.3%  4328 2647s
  5367  2303 21115.8588   32  375 20699.1315 23240.9796  12.3%  4327 2661s
  5368  2303 22543.3228   12  353 20699.1315 23240.9796  12.3%  4326 2666s
  5369  2304 21109.4455   55  358 20699.1315 23240.9796  12.3%  4325 2672s
  5370  2305 22446.1739   17  432 20699.1315 23240.9796  12.3%  4325 2686s
  5371  2305 20745.3979   59  419 20699.1315 23240.9796  12.3%  4324 2694s
  5372  2306 23203.3788   12  399 20699.1315 23240.9796  12.3%  4323 2704s
  5373  2307 22200.2128   14  393 20699.1315 23240.9796  12.3%  4322 2710s
  5374  2307 21143.1997   34  363 20699.1315 23240.9796  12.3%  4321 2728s
  5375  2308 22416.8459   24  410 20699.1315 23240.9796  12.3%  4321 2733s
  5376  2309 21064.2167   13  407 20699.1315 23240.9796  12.3%  4320 2738s
  5377  2309 20733.0574   32  354 20699.1315 23240.9796  12.3%  4319 2749s
  5378  2310 21201.0264   22  300 20699.1315 23240.9796  12.3%  4318 2753s
  5379  2311 21542.8935   11  358 20699.1315 23240.9796  12.3%  4317 2767s
  5380  2311 21002.8488   15  357 20699.1315 23240.9796  12.3%  4317 2770s
  5381  2312 21886.0260   20  351 20699.1315 23240.9796  12.3%  4316 2780s
  5382  2313 21571.3578   28  351 20699.1315 23240.9796  12.3%  4315 2797s
  5383  2313 22139.5784   13  351 20699.1315 23240.9796  12.3%  4314 2845s
  5384  2317 23240.9796   13  293 20699.1315 23240.9796  12.3%  4367 2866s
  5386  2320 23240.9796   14  350 20699.1315 23240.9796  12.3%  4369 2882s
  5390  2326 23240.9796   15  284 20699.1315 23240.9796  12.3%  4373 2911s
  5397  2339 23240.9796   16  287 20699.1315 23240.9796  12.3%  4376 2927s
  5412  2346 21015.5842   17  146 20699.1315 23240.9796  12.3%  4427 2970s
  5428  2351 22623.3969   17  307 20699.1315 23240.9796  12.3%  4449 3021s
  5458  2376     cutoff   18      20699.1315 23240.9796  12.3%  4515 3062s
  5522  2365 22631.4688   24  289 20699.1315 23240.9796  12.3%  4553 3093s
  5589  2360 20814.4654   26  196 20699.1315 23240.9796  12.3%  4582 3118s
  5653  2370 infeasible   27      20699.1315 23240.9796  12.3%  4609 3138s
  5748  2354 21273.6119   26  175 20699.1315 23240.9796  12.3%  4632 3157s
  5839  2334 21260.8947   27  192 20699.1315 23240.9796  12.3%  4643 3182s
  5929  2312 20931.9612   31  150 20699.1315 23240.9796  12.3%  4666 3195s
  6005  2297 20717.6184   33  127 20699.1315 23240.9796  12.3%  4679 3208s
  6073  2286 infeasible   29      20699.1315 23240.9796  12.3%  4682 3222s
  6171  2253 22195.3598   19  247 20699.1315 23240.9796  12.3%  4671 3235s
  6249  2217 20746.2648   59   55 20699.1315 23240.9796  12.3%  4654 3248s
  6345  2179 21085.7955   21  192 20699.1315 23240.9796  12.3%  4635 3263s
  6443  2142     cutoff   22      20699.1315 23240.9796  12.3%  4620 3278s
  6525  2111 infeasible   36      20699.1315 23240.9796  12.3%  4611 3292s
  6634  2064 infeasible   28      20699.1315 23240.9796  12.3%  4585 3307s
  6722  2026 infeasible   19      20699.1315 23240.9796  12.3%  4578 3321s
  6776  2003 20799.2238   27  180 20699.1315 23240.9796  12.3%  4569 3336s
  6860  1969     cutoff   30      20699.1315 22804.6190  10.2%  4539 3349s
  6982  1951 21219.4422   20  271 20699.1315 22529.3408  8.84%  4504 3362s
  7122  1931 infeasible   23      20699.1315 22529.3408  8.84%  4444 3375s
  7337  1882     cutoff   24      20699.1315 22077.9380  6.66%  4358 3389s
  7611  1829     cutoff   21      20699.1315 22077.9380  6.66%  4249 3402s
  7937  1802 20792.8756   60   36 20699.1315 22077.9380  6.66%  4121 3411s
  8356  1748 20733.5891   68   45 20699.1315 22077.9380  6.66%  3955 3421s
  8887  1687 20735.4437   65   42 20699.1315 22077.9380  6.66%  3759 3435s
  9496  1563 20751.0378   65   49 20699.1315 21454.8516  3.65%  3554 3441s
 10126  1427 20722.8648   59   31 20699.1315 21454.8516  3.65%  3366 3448s
 10901  1201     cutoff   60      20699.1315 20832.8517  0.65%  3163 3453s
 11636   917 20720.9214   60   27 20699.1315 20812.6393  0.55%  2998 3459s
 12397   579 20715.9653   65   16 20699.1315 20804.2344  0.51%  2847 3465s
 13129   316 20719.9946   56   19 20699.1315 20783.4518  0.41%  2720 3472s
 13900    46 20705.0698   58   20 20699.1315 20762.2908  0.31%  2602 3477s

Cutting planes:
  Gomory: 40
  Implied bound: 35
  Projected implied bound: 229
  MIR: 1192
  Mixing: 6
  Flow cover: 1735
  RLT: 38
  Relax-and-lift: 216

Explored 14561 nodes (37247102 simplex iterations) in 3479.77 seconds (9396.68 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20699.1 20677.6 20665.8 ... 20596

Optimal solution found (tolerance 1.00e-04)
Best objective 2.069913148730e+04, best bound 2.069913148730e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3479.79s
  Master Objective (UB) = 20699.13, θ = 140793.13
  Upper Bound (UB) = 20699.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140793.13
  [DEBUG]   ✓ Scenario 0: θ = 140793.13 ≤ Q = 140793.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140793.13 ≤ Q = 140793.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140793.13 ≤ Q = 140793.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140793.13 ≤ Q = 140793.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140793.13 ≤ Q = 140793.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140793.13 ≤ Q = 140793.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140793.13 ≤ Q = 140793.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140793.13 ≤ Q = 140793.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140793.13 ≤ Q = 140793.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140793.13 ≤ Q = 140793.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140793.13 ≤ Q = 140793.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140793.13 ≤ Q = 141275.61 (slack: 482.47)
  [DEBUG]   ✓ Scenario 12: θ = 140793.13 ≤ Q = 140793.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x55e41ab3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x55e41ab3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7500273.2021
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.356586e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135658.57    0  123 7500273.20 -135658.57   102%     -    0s
H    0     0                    -100716.9785 -135658.57  34.7%     -    0s
     0     0 -107254.49    0   86 -100716.98 -107254.49  6.49%     -    0s
H    0     0                    -105139.8771 -107198.07  1.96%     -    0s
H    0     0                    -105787.8784 -107198.07  1.33%     -    0s
     0     0 -106615.08    0   87 -105787.88 -106615.08  0.78%     -    0s
     0     0 -106355.92    0   72 -105787.88 -106355.92  0.54%     -    0s
H    0     0                    -105793.3958 -106273.27  0.45%     -    0s
     0     0 -106273.27    0   85 -105793.40 -106273.27  0.45%     -    0s
     0     0 -106244.04    0   87 -105793.40 -106244.04  0.43%     -    0s
     0     0 -106241.00    0   86 -105793.40 -106241.00  0.42%     -    0s
     0     0 -106124.85    0   57 -105793.40 -106124.85  0.31%     -    0s
     0     0 -106108.70    0   52 -105793.40 -106108.70  0.30%     -    0s
     0     0 -106057.61    0   49 -105793.40 -106057.61  0.25%     -    0s
H    0     0                    -105821.6168 -106055.80  0.22%     -    0s
     0     0 -106055.80    0   49 -105821.62 -106055.80  0.22%     -    0s
     0     0 -106036.46    0   50 -105821.62 -106036.46  0.20%     -    0s
     0     0 -106034.23    0   50 -105821.62 -106034.23  0.20%     -    0s
H    0     0                    -105850.6246 -106034.23  0.17%     -    0s
     0     0 -106034.23    0   85 -105850.62 -106034.23  0.17%     -    0s
     0     0 -106034.23    0   52 -105850.62 -106034.23  0.17%     -    0s
     0     0 -106034.23    0   48 -105850.62 -106034.23  0.17%     -    0s
     0     0 -106031.08    0   48 -105850.62 -106031.08  0.17%     -    0s
     0     0 -106029.46    0   48 -105850.62 -106029.46  0.17%     -    0s
     0     0 -105985.15    0   47 -105850.62 -105985.15  0.13%     -    0s
     0     0 -105980.12    0   47 -105850.62 -105980.12  0.12%     -    0s
     0     0 -105976.45    0   47 -105850.62 -105976.45  0.12%     -    0s
     0     0 -105969.22    0   47 -105850.62 -105969.22  0.11%     -    0s
     0     0 -105968.01    0   57 -105850.62 -105968.01  0.11%     -    0s
     0     0 -105968.01    0   28 -105850.62 -105968.01  0.11%     -    0s
     0     0 -105968.01    0   48 -105850.62 -105968.01  0.11%     -    0s
     0     0 -105968.01    0   46 -105850.62 -105968.01  0.11%     -    0s
     0     0 -105968.01    0   46 -105850.62 -105968.01  0.11%     -    0s
     0     0 -105966.11    0   46 -105850.62 -105966.11  0.11%     -    0s
     0     0 -105964.59    0   46 -105850.62 -105964.59  0.11%     -    0s
     0     0 -105940.63    0   43 -105850.62 -105940.63  0.09%     -    0s
     0     0 -105928.52    0   43 -105850.62 -105928.52  0.07%     -    0s
     0     0 -105928.52    0   43 -105850.62 -105928.52  0.07%     -    0s
     0     0 -105923.81    0   43 -105850.62 -105923.81  0.07%     -    0s
     0     2 -105923.58    0   43 -105850.62 -105923.58  0.07%     -    0s
H    8     2                    -105857.7680 -105863.74  0.01%   8.4    0s

Cutting planes:
  Gomory: 11
  Implied bound: 3
  MIR: 59
  Flow cover: 21

Explored 10 nodes (1599 simplex iterations) in 0.17 seconds (0.12 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -105858 -105851 -105822 ... 1.4374e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.058577679522e+05, best bound -1.058584902162e+05, gap 0.0007%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 138666.34
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105857.77
  [DEBUG]   S×d_nominal = 244524.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244524.10 + -105857.77 = 138666.34
  [DEBUG]   Current θ from Master = 140793.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2126.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18572.33
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 855.1946, Absolute Gap = 855.1946, Relative Gap = 0.041315
  Not converged yet (gap = 855.19 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610879 nonzeros
Model fingerprint: 0x4fa1d511
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94738 rows and 38458 columns
Presolve time: 1.88s
Presolved: 120705 rows, 51162 columns, 742842 nonzeros
Variable types: 48903 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.07s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 5.506e+06
 Factor NZ  : 1.213e+07 (roughly 170 MB of memory)
 Factor Ops : 2.518e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79202607e+07  2.06583243e+08  1.03e+05 2.08e+01  7.14e+04     4s
   1  -1.36423560e+07  1.79574397e+08  7.28e+04 6.31e+01  4.98e+04     4s
   2  -4.54865031e+06  1.30158634e+08  2.38e+04 6.18e-01  1.73e+04     4s
   3  -8.16923647e+05  9.13810865e+07  1.93e+03 1.77e+00  1.73e+03     4s
   4  -4.83762554e+05  2.85586521e+07  4.16e+02 2.57e-01  3.76e+02     4s
   5  -3.42771134e+05  2.04525097e+07  1.23e+02 1.63e-01  1.62e+02     4s
   6  -2.59233089e+05  1.62997210e+07  5.57e+01 1.21e-01  1.03e+02     4s
   7  -1.78196889e+05  1.21788964e+07  3.00e+01 8.58e-02  6.88e+01     4s
   8  -1.30316383e+05  7.67771642e+06  1.61e+01 5.04e-02  4.04e+01     4s
   9  -1.03926183e+05  5.16917535e+06  9.21e+00 3.25e-02  2.60e+01     4s
  10  -8.47847520e+04  1.68283439e+06  4.86e+00 9.13e-03  8.46e+00     5s
  11  -5.81400930e+04  4.96099663e+05  1.99e+00 2.37e-03  2.58e+00     5s
  12  -2.18432786e+04  2.45749009e+05  7.31e-01 1.13e-03  1.23e+00     5s
  13  -1.52798678e+04  1.81981542e+05  6.01e-01 1.38e-03  9.05e-01     5s
  14  -9.38741014e+03  1.30302440e+05  5.06e-01 1.09e-03  6.41e-01     5s
  15  -6.58335214e+02  1.07358838e+05  3.89e-01 1.58e-03  4.95e-01     5s
  16   7.96591333e+03  9.94718927e+04  2.84e-01 1.55e-03  4.19e-01     5s
  17   1.28209854e+04  8.15788355e+04  2.27e-01 1.67e-03  3.15e-01     5s
  18   1.71286110e+04  7.00373972e+04  1.83e-01 1.44e-03  2.42e-01     5s
  19   2.17013664e+04  6.22592817e+04  1.39e-01 1.26e-03  1.86e-01     5s
  20   2.54473311e+04  5.86245477e+04  1.05e-01 1.34e-03  1.52e-01     5s
  21   2.84022859e+04  5.38493705e+04  8.18e-02 2.41e-03  1.16e-01     5s
  22   3.05455566e+04  5.05709265e+04  6.56e-02 2.03e-03  9.15e-02     5s
  23   3.15499139e+04  4.93136895e+04  5.92e-02 1.74e-03  8.12e-02     5s
  24   3.46000659e+04  4.81847015e+04  3.90e-02 2.33e-03  6.20e-02     5s
  25   3.52770384e+04  4.64547501e+04  3.51e-02 2.25e-03  5.11e-02     5s
  26   3.66403094e+04  4.46773514e+04  2.73e-02 1.45e-03  3.67e-02     5s
  27   3.82115525e+04  4.41513561e+04  1.85e-02 1.17e-03  2.71e-02     5s
  28   3.93520424e+04  4.30734256e+04  1.24e-02 6.45e-04  1.70e-02     5s
  29   4.00462432e+04  4.27861239e+04  8.80e-03 4.91e-04  1.25e-02     5s
  30   4.05017384e+04  4.24233927e+04  6.56e-03 3.15e-04  8.79e-03     6s
  31   4.08138825e+04  4.22392688e+04  5.03e-03 2.57e-04  6.52e-03     6s
  32   4.08785615e+04  4.22150656e+04  4.73e-03 2.37e-04  6.11e-03     6s
  33   4.13507423e+04  4.20234706e+04  2.47e-03 2.43e-04  3.08e-03     6s
  34   4.16783592e+04  4.19732504e+04  9.04e-04 1.28e-04  1.35e-03     6s
  35   4.16878752e+04  4.19588412e+04  8.58e-04 1.03e-04  1.24e-03     6s
  36   4.17608616e+04  4.19398169e+04  5.55e-04 6.82e-05  8.18e-04     6s
  37   4.18607495e+04  4.19154109e+04  1.40e-04 1.82e-05  2.49e-04     6s
  38   4.18679462e+04  4.19114453e+04  1.12e-04 1.38e-05  1.98e-04     6s
  39   4.18846804e+04  4.19038740e+04  4.99e-05 5.19e-06  8.76e-05     6s
  40   4.18901675e+04  4.18993797e+04  3.00e-05 5.65e-06  4.21e-05     6s
  41   4.18967388e+04  4.18990951e+04  7.12e-06 1.02e-06  1.08e-05     6s
  42   4.18989149e+04  4.18989334e+04  1.14e-07 8.49e-07  8.41e-08     6s
  43   4.18989290e+04  4.18989294e+04  4.34e-08 1.33e-07  1.64e-09     6s

Barrier solved model in 43 iterations and 6.30 seconds (10.20 work units)
Optimal objective 4.18989290e+04


Root crossover log...

  107002 DPushes remaining with DInf 0.0000000e+00                 6s
   22803 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   15062 PPushes remaining with PInf 1.2332077e-04                13s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7703870e+03     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   76565    4.1898929e+04   0.000000e+00   3.770387e+03     15s
   76837    4.1898929e+04   0.000000e+00   0.000000e+00     15s
   76837    4.1898929e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.189893e+04, 76837 iterations, 12.76 seconds (21.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41898.9294    0  196 -208513.72 41898.9294   120%     -   15s
H    0     0                    -124543.8802 41898.9294   134%     -   16s
H    0     0                    -121419.3309 41898.9294   135%     -   16s
H    0     0                    -117744.1916 41898.9294   136%     -   16s
H    0     0                    -43809.56343 41898.9294   196%     -   16s
H    0     0                    -6468.267264 41898.9294   748%     -   16s
H    0     0                    10485.652733 41898.9294   300%     -   16s
H    0     0                    13608.642353 41898.9294   208%     -   17s
H    0     0                    13808.927887 41898.9294   203%     -   17s
H    0     0                    16199.227026 41898.9294   159%     -   17s
H    0     0                    16235.006575 41898.9294   158%     -   17s
     0     0 36046.2428    0  211 16235.0066 36046.2428   122%     -   58s
H    0     0                    16269.778184 36046.2428   122%     -   59s
H    0     0                    16271.059740 36046.2428   122%     -   59s
H    0     0                    16493.506969 36046.2428   119%     -   59s
     0     0 35679.1286    0  279 16493.5070 35679.1286   116%     -   74s
     0     0 35446.3851    0  285 16493.5070 35446.3851   115%     -   87s
     0     0 35220.7058    0  289 16493.5070 35220.7058   114%     -   97s
     0     0 35189.2852    0  286 16493.5070 35189.2852   113%     -  103s
     0     0 35186.0227    0  286 16493.5070 35186.0227   113%     -  103s
     0     0 35183.9620    0  286 16493.5070 35183.9620   113%     -  104s
     0     0 35183.4805    0  286 16493.5070 35183.4805   113%     -  104s
H    0     0                    18930.081889 31440.4894  66.1%     -  143s
H    0     0                    19223.459859 31440.4894  63.6%     -  143s
H    0     0                    19301.756904 31440.4894  62.9%     -  143s
H    0     0                    19311.785253 31440.4894  62.8%     -  143s
H    0     0                    19387.832864 31440.4894  62.2%     -  143s
     0     0 31440.4894    0  243 19387.8329 31440.4894  62.2%     -  143s
H    0     0                    19420.557362 31437.9933  61.9%     -  144s
H    0     0                    19423.522673 31437.9933  61.9%     -  144s
H    0     0                    19488.962581 31437.9933  61.3%     -  144s
     0     0 30639.6425    0  236 19488.9626 30639.6425  57.2%     -  167s
     0     0 30380.3439    0  246 19488.9626 30380.3439  55.9%     -  186s
     0     0 30326.8026    0  249 19488.9626 30326.8026  55.6%     -  194s
H    0     0                    19514.294162 30300.5465  55.3%     -  199s
H    0     0                    19549.456107 30300.5465  55.0%     -  199s
     0     0 30300.5465    0  251 19549.4561 30300.5465  55.0%     -  199s
H    0     0                    19563.278285 30262.2616  54.7%     -  207s
H    0     0                    19587.560153 30262.2616  54.5%     -  207s
     0     0 30262.2616    0  252 19587.5602 30262.2616  54.5%     -  207s
     0     0 30251.7474    0  255 19587.5602 30251.7474  54.4%     -  212s
     0     0 30189.3568    0  302 19587.5602 30189.3568  54.1%     -  221s
     0     0 30187.5845    0  259 19587.5602 30187.5845  54.1%     -  222s
     0     0 30145.1696    0  311 19587.5602 30145.1696  53.9%     -  227s
     0     0 30143.5609    0  305 19587.5602 30143.5609  53.9%     -  230s
     0     0 30134.0819    0  300 19587.5602 30134.0819  53.8%     -  233s
     0     0 30133.4184    0  308 19587.5602 30133.4184  53.8%     -  235s
H    0     0                    19627.313474 28496.1467  45.2%     -  284s
     0     0 28496.1467    0  349 19627.3135 28496.1467  45.2%     -  284s
H    0     0                    19711.053124 28494.8319  44.6%     -  284s
     0     0 28030.7558    0  342 19711.0531 28030.7558  42.2%     -  298s
H    0     0                    19745.227752 27952.9104  41.6%     -  303s
H    0     0                    19756.547785 27952.9104  41.5%     -  303s
     0     0 27952.9104    0  337 19756.5478 27952.9104  41.5%     -  303s
     0     0 27934.1053    0  346 19756.5478 27934.1053  41.4%     -  306s
     0     0 27926.4330    0  344 19756.5478 27926.4330  41.4%     -  309s
     0     0 27917.1893    0  351 19756.5478 27917.1893  41.3%     -  313s
     0     0 27914.7999    0  349 19756.5478 27914.7999  41.3%     -  314s
     0     0 27910.2246    0  353 19756.5478 27910.2246  41.3%     -  316s
     0     0 27908.1879    0  357 19756.5478 27908.1879  41.3%     -  318s
     0     0 27903.4956    0  353 19756.5478 27903.4956  41.2%     -  321s
     0     0 27900.4291    0  351 19756.5478 27900.4291  41.2%     -  323s
     0     0 27896.2955    0  350 19756.5478 27896.2955  41.2%     -  325s
     0     0 27890.4986    0  354 19756.5478 27890.4986  41.2%     -  327s
     0     0 27887.6317    0  354 19756.5478 27887.6317  41.2%     -  328s
     0     0 27878.4681    0  351 19756.5478 27878.4681  41.1%     -  329s
H    0     0                    19923.611710 27874.8394  39.9%     -  330s
H    0     0                    19931.100795 27874.8394  39.9%     -  330s
     0     0 27874.8394    0  354 19931.1008 27874.8394  39.9%     -  330s
H    0     0                    19978.266450 27860.7411  39.5%     -  333s
H    0     0                    20135.343183 27860.7411  38.4%     -  333s
H    0     0                    20145.758503 27860.7411  38.3%     -  333s
H    0     0                    20158.893398 27860.7411  38.2%     -  333s
H    0     0                    20196.742715 27860.7411  37.9%     -  333s
     0     0 27860.7411    0  290 20196.7427 27860.7411  37.9%     -  334s
     0     0 27851.3843    0  293 20196.7427 27851.3843  37.9%     -  336s
     0     0 27850.1776    0  294 20196.7427 27850.1776  37.9%     -  337s
H    0     0                    20230.007543 27405.7539  35.5%     -  359s
H    0     0                    20231.145579 27405.7539  35.5%     -  359s
H    0     0                    20279.197902 27405.7539  35.1%     -  359s
H    0     0                    20289.429799 27405.7539  35.1%     -  359s
H    0     0                    20296.918884 27405.7539  35.0%     -  359s
H    0     0                    20301.230022 27405.7539  35.0%     -  359s
H    0     0                    20308.719107 27405.7539  34.9%     -  359s
     0     0 27405.7539    0  303 20308.7191 27405.7539  34.9%     -  359s
H    0     0                    20426.864351 27358.7961  33.9%     -  367s
H    0     0                    20448.544330 27358.7961  33.8%     -  367s
H    0     0                    20461.921886 27358.7961  33.7%     -  367s
H    0     0                    20579.001685 27358.7961  32.9%     -  367s
     0     0 27358.7961    0  296 20579.0017 27358.7961  32.9%     -  367s
     0     0 27348.9924    0  348 20579.0017 27348.9924  32.9%     -  371s
     0     0 27342.5330    0  341 20579.0017 27342.5330  32.9%     -  373s
     0     0 27341.5294    0  334 20579.0017 27341.5294  32.9%     -  374s
     0     0 27311.0100    0  275 20579.0017 27311.0100  32.7%     -  383s
     0     0 27295.7076    0  270 20579.0017 27295.7076  32.6%     -  389s
     0     0 27292.7126    0  353 20579.0017 27292.7126  32.6%     -  392s
     0     0 27292.1534    0  283 20579.0017 27292.1534  32.6%     -  394s
     0     0 27281.9266    0  336 20579.0017 27281.9266  32.6%     -  400s
H    0     0                    20608.441294 27279.4519  32.4%     -  400s
     0     0 27279.4519    0  226 20608.4413 27279.4519  32.4%     -  401s
     0     0 27279.4519    0  226 20608.4413 27279.4519  32.4%     -  403s
     0     0 27279.4519    0  226 20608.4413 27279.4519  32.4%     -  404s
     0     0 27279.4519    0  226 20608.4413 27279.4519  32.4%     -  408s
H    0     0                    20637.793386 27279.4519  32.2%     -  466s
     0     2 27279.4519    0  226 20637.7934 27279.4519  32.2%     -  468s
     1     3 26406.4661    1  259 20637.7934 27279.4519  32.2% 11531  479s
     2     5 25756.2889    2  247 20637.7934 27279.4519  32.2%  8596  488s
     4     9 26284.1420    2  330 20637.7934 26978.1679  30.7%  9672  499s
     8    18 26191.4911    3  332 20637.7934 26978.1679  30.7%  7536  511s
    17    36 25909.5606    4  337 20637.7934 26243.5275  27.2%  9834  522s
    35    50 25316.9557    4  289 20637.7934 26200.5508  27.0% 11026  558s
    49    77 23392.1433    5  263 20637.7934 26200.5508  27.0% 12664  579s
H   51    77                    20645.282471 26200.5508  26.9% 12321  579s
H   64    77                    20658.971227 26200.5508  26.8% 11390  579s
    76   210 23327.3276    6  268 20658.9712 26200.5508  26.8% 10468  599s
   211   274 23076.4232   11  264 20658.9712 26200.5508  26.8%  7100  612s
   275   355 22569.9155   14  259 20658.9712 26200.5508  26.8%  6263  622s
   371   383 21551.8713   16  136 20658.9712 26200.5508  26.8%  5435  629s
   403   409 21527.3325   17  128 20658.9712 26200.5508  26.8%  5335  639s
   451   422 21494.1010   17  132 20658.9712 26200.5508  26.8%  5176  652s
   500   444     cutoff   19      20658.9712 26200.5508  26.8%  5093  664s
   546   460 22516.0695   13  270 20658.9712 26200.5508  26.8%  5192  675s
H  550   460                    20663.023533 26200.5508  26.8%  5186  675s
   592   467 21059.2645   20  139 20663.0235 26200.5508  26.8%  5029  687s
H  612   467                    20680.603347 26200.5508  26.7%  4968  687s
   661   448     cutoff   14      20680.6033 26200.5508  26.7%  4851  699s
   720   437 22399.8450   19  285 20680.6033 26200.5508  26.7%  4730  709s
   777   435 22627.5195   18  222 20680.6033 26200.5508  26.7%  4704  721s
   812   432     cutoff   14      20680.6033 26200.5508  26.7%  4676  734s
   850   440     cutoff   15      20680.6033 26200.5508  26.7%  4711  745s
   882   458 21591.5804    9  294 20680.6033 26200.5508  26.7%  4762  758s
   917   450 20908.2566   13  291 20680.6033 26200.5508  26.7%  4862  772s
   976   457 20835.5258   14  272 20680.6033 26200.5508  26.7%  4731  785s
  1041   476 21688.8388    9  250 20680.6033 26200.5508  26.7%  4706  797s
  1081   521 21647.4699   10  243 20680.6033 26200.5508  26.7%  4841  812s
  1163   574 21246.4209   15  230 20680.6033 26200.5508  26.7%  4818  828s
  1287   679 21081.9422   18  132 20680.6033 26200.5508  26.7%  4622  840s
  1434   811     cutoff   25      20680.6033 26200.5508  26.7%  4446  852s
  1598   883 22410.3078   13  224 20680.6033 26200.5508  26.7%  4212  865s
  1689  1000 22091.4576   14  201 20680.6033 26200.5508  26.7%  4096  877s
  1895  1063 21875.8113   17  255 20680.6033 26200.5508  26.7%  3828  892s
  2068  1175     cutoff   23      20680.6033 25883.1491  25.2%  3687  907s
  2270  1253     cutoff   26      20680.6033 25883.1491  25.2%  3527  923s
  2447  1286 20975.4551   51  131 20680.6033 25883.1271  25.2%  3446  939s
  2585  1298     cutoff   63      20680.6033 25883.1271  25.2%  3460  953s
  2647  1393     cutoff    9      20680.6033 25883.1271  25.2%  3516  968s
  2778  1496 21929.6099   12  288 20680.6033 25883.1271  25.2%  3512  983s
  2978  1620 21351.6579   14  162 20680.6033 25883.1271  25.2%  3469  998s
  3229  1723 21846.3563   12  261 20680.6033 23850.9274  15.3%  3375 1014s
  3447  1875     cutoff   12      20680.6033 23850.9274  15.3%  3347 1031s
  3742  1956 21025.6989   17  209 20680.6033 23850.9274  15.3%  3231 1048s
  4000  2032 21232.3975   14  323 20680.6033 23850.9274  15.3%  3166 1065s
  4193  2092     cutoff   17      20680.6033 23508.1870  13.7%  3169 1085s
  4370  2131 21079.8469    9  223 20680.6033 23384.4734  13.1%  3176 1106s
  4587  2148 20844.1133   22  204 20680.6033 23384.4734  13.1%  3184 1124s
H 4666  2142                    20691.034417 23384.4734  13.0%  3200 1124s
  4697  2154     cutoff   23      20691.0344 23384.4734  13.0%  3198 1145s
  4906  2148     cutoff   11      20691.0344 23250.8193  12.4%  3229 1168s
  5135  2178 20714.1239   16  115 20691.0344 23186.4933  12.1%  3251 1193s
  5322  2205 20986.2887   16  218 20691.0344 23001.0658  11.2%  3247 1219s
  5556  2205     cutoff   16      20691.0344 22957.0137  11.0%  3242 1243s
  5791  2214     cutoff   14      20691.0344 22854.6138  10.5%  3264 1268s
  6086  2246 infeasible   17      20691.0344 22769.1997  10.0%  3267 1295s
  6396  2299     cutoff   19      20691.0344 22590.0683  9.18%  3273 1323s
  6707  2369     cutoff   10      20691.0344 22440.3479  8.45%  3250 1348s
  7103  2571 20901.2254   50  106 20691.0344 22326.2676  7.90%  3224 1376s
  7589  2572 21542.7162   46  226 20691.0344 22224.9921  7.41%  3167 1546s
  7591  2573 21330.3494   22  148 20691.0344 22224.9921  7.41%  3167 1557s
  7592  2574 20846.2876   60  339 20691.0344 22224.9921  7.41%  3166 1606s
  7593  2575 20706.3524   60  287 20691.0344 22224.9921  7.41%  3166 1637s
  7594  2575 20938.3878   47  339 20691.0344 22224.9921  7.41%  3165 1655s
  7595  2576 20843.6258   58  336 20691.0344 22224.9921  7.41%  3165 1671s
  7596  2577 21305.9984   16  376 20691.0344 22224.9921  7.41%  3164 1688s
  7597  2577 20765.0323   22  303 20691.0344 22224.9921  7.41%  3164 1694s
  7598  2578 20859.9844   70  351 20691.0344 22224.9921  7.41%  3164 1700s
  7599  2579 21879.2820   19  359 20691.0344 22224.9921  7.41%  3163 1717s
  7600  2579 21580.9985   11  303 20691.0344 22224.9921  7.41%  3163 1725s
  7601  2580 21377.7923   44  296 20691.0344 22224.9921  7.41%  3162 1731s
  7602  2581 20898.7719   15  291 20691.0344 22224.9921  7.41%  3162 1745s
  7603  2581 20769.0961   52  292 20691.0344 22224.9921  7.41%  3162 1752s
  7604  2582 21426.2804   40  381 20691.0344 22224.9921  7.41%  3161 1766s
  7605  2583 21789.4291   29  351 20691.0344 22224.9921  7.41%  3161 1775s
  7606  2583 20954.1432   23  346 20691.0344 22224.9921  7.41%  3160 1782s
  7607  2584 21030.4717   50  447 20691.0344 22224.9921  7.41%  3160 1797s
  7608  2585 20892.4864   19  354 20691.0344 22224.9921  7.41%  3159 1809s
  7609  2585 21643.9795   23  452 20691.0344 22224.9921  7.41%  3159 1825s
  7610  2586 21250.6159   12  451 20691.0344 22224.9921  7.41%  3159 1833s
  7611  2587 21052.6595   15  436 20691.0344 22224.9921  7.41%  3158 1849s
  7612  2587 21391.2674   31  308 20691.0344 22224.9921  7.41%  3158 1856s
  7613  2588 21465.2742   21  343 20691.0344 22224.9921  7.41%  3157 1871s
  7614  2589 21092.2574   41  343 20691.0344 22224.9921  7.41%  3157 1896s
  7615  2589 21671.6955   22  343 20691.0344 22224.9921  7.41%  3157 1946s
  7616  2592 22224.9921   10  246 20691.0344 22224.9921  7.41%  3198 1961s
  7617  2594 22224.9921   11  237 20691.0344 22224.9921  7.41%  3198 1979s
  7619  2598 22224.9921   11  369 20691.0344 22224.9921  7.41%  3199 2010s
  7624  2606 22224.9921   12  313 20691.0344 22224.9921  7.41%  3202 2030s
  7634  2613 22224.9921   13  271 20691.0344 22224.9921  7.41%  3216 2082s
  7644  2638 22224.9921   14  279 20691.0344 22224.9921  7.41%  3231 2190s
  7674  2653 22147.4389   15  272 20691.0344 22224.9921  7.41%  3398 2211s
  7706  2678 22021.4322   16  282 20691.0344 22224.9921  7.41%  3413 2242s
  7769  2666 21057.1115   19  131 20691.0344 22224.9921  7.41%  3438 2276s
  7829  2659 infeasible   23      20691.0344 22224.9921  7.41%  3457 2297s
  7864  2652 22224.9921   17  391 20691.0344 22224.9921  7.41%  3469 2323s
  7902  2631 infeasible   18      20691.0344 22224.9921  7.41%  3474 2347s
  7970  2616 22069.0716   18  351 20691.0344 22224.9921  7.41%  3494 2367s
  8022  2608 21532.7208   19  272 20691.0344 22224.9921  7.41%  3503 2386s
  8078  2592 21326.4930   20  323 20691.0344 22224.9921  7.41%  3504 2403s
  8136  2569 22215.0450   17  370 20691.0344 22224.9921  7.41%  3512 2421s
  8194  2553 21896.5482   18  315 20691.0344 22224.9921  7.41%  3520 2442s
  8252  2525 21792.7067   19  364 20691.0344 22224.9921  7.41%  3527 2461s
  8313  2508 infeasible   20      20691.0344 22224.9921  7.41%  3533 2479s
  8380  2502 21647.1470   16  255 20691.0344 22224.9921  7.41%  3533 2496s
  8468  2465 21332.6906   17  248 20691.0344 22224.9921  7.41%  3520 2512s
  8574  2422 21268.6295   17  221 20691.0344 22224.9921  7.41%  3505 2530s
  8676  2395 21248.0359   18  207 20691.0344 22224.9921  7.41%  3489 2556s
  8779  2359 20993.7063   20  228 20691.0344 22224.9921  7.41%  3477 2578s
  8884  2334 infeasible   21      20691.0344 22224.9921  7.41%  3469 2596s
  9002  2306 21611.0257   18  273 20691.0344 22224.9921  7.41%  3457 2616s
  9116  2267 21534.0396   19  267 20691.0344 22224.9921  7.41%  3443 2635s
  9290  2207 21087.3777   20  257 20691.0344 22224.9921  7.41%  3410 2656s
  9449  2123 infeasible   22      20691.0344 22224.9921  7.41%  3381 2675s
  9661  2061 21004.4017   51  139 20691.0344 22224.9921  7.41%  3334 2709s
  9957  2003 20734.1607   60   35 20691.0344 22224.9921  7.41%  3264 2724s
 10348  1944 20718.1913   64   25 20691.0344 21915.9542  5.92%  3172 2743s
 10820  1809 20692.0962   61   20 20691.0344 21614.4324  4.46%  3065 2753s
 11033  1811 20882.5174   55   40 20691.0344 21614.4324  4.46%  3017 2764s
 11547  1727     cutoff   69      20691.0344 21348.3123  3.18%  2906 2776s
 12057  1734 20741.8374   69   38 20691.0344 21146.2390  2.20%  2808 2787s
 12730  1681 20877.2575   59  142 20691.0344 21045.9469  1.72%  2684 2797s
 13302  1669 20902.5120   59   44 20691.0344 20956.7653  1.28%  2592 2806s
 13990  1596 20797.9957   62   38 20691.0344 20956.7653  1.28%  2492 2816s
 14722  1458     cutoff   65      20691.0344 20881.5571  0.92%  2399 2827s
 15530  1396 20701.3535   65   23 20691.0344 20881.5571  0.92%  2306 2836s
 16282  1469     cutoff   59      20691.0344 20826.4918  0.65%  2228 2846s
 17086  1547 20741.4586   63   35 20691.0344 20817.6007  0.61%  2153 2857s
 17936  1620 20729.7147   59   24 20691.0344 20806.6196  0.56%  2081 2867s
 18657  1613 infeasible   70      20691.0344 20802.3421  0.54%  2026 2877s
 18713  1617     cutoff   71      20691.0344 20793.0059  0.49%  2022 2888s
 18769  1630 20701.7773   73   31 20691.0344 20793.0059  0.49%  2019 2898s
 18814  1631     cutoff   74      20691.0344 20793.0059  0.49%  2015 2907s
 18902  1608 20751.9404   66   38 20691.0344 20790.8015  0.48%  2009 2918s
 19155  1652 20720.6416   67   41 20691.0344 20790.8015  0.48%  1992 2930s
 19863  1603 infeasible   72      20691.0344 20788.9701  0.47%  1944 2943s
 20842  1542 20739.8047   65   34 20691.0344 20776.4677  0.41%  1885 2955s
 21835  1373 20718.3991   60   32 20691.0344 20765.6935  0.36%  1831 2968s
 22766  1126 20713.4890   62  125 20691.0344 20756.5465  0.32%  1787 2981s
 23665   800 20698.2988   61   26 20691.0344 20747.9742  0.28%  1751 2996s
 24651   291     cutoff   65      20691.0344 20736.5197  0.22%  1712 3011s
 25773     8 20697.7712   84   12 20691.0344 20722.5989  0.15%  1667 3022s

Cutting planes:
  Learned: 1
  Gomory: 17
  Implied bound: 8
  Projected implied bound: 148
  MIR: 1001
  Flow cover: 1967
  RLT: 20
  Relax-and-lift: 147

Explored 26204 nodes (43697495 simplex iterations) in 3023.60 seconds (8429.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20691 20680.6 20663 ... 20448.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.069103441739e+04, best bound 2.069103441739e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3023.64s
  Master Objective (UB) = 20691.03, θ = 140567.21
  Upper Bound (UB) = 20691.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140567.21
  [DEBUG]   ✓ Scenario 0: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140567.21 ≤ Q = 140567.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140567.21 ≤ Q = 140567.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140567.21 ≤ Q = 140567.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140567.21 ≤ Q = 140567.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140567.21 ≤ Q = 140567.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x127b111d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x127b111d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7495643.1356
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.357720e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135771.99    0  123 7495643.14 -135771.99   102%     -    0s
H    0     0                    -100779.8446 -135771.99  34.7%     -    0s
H    0     0                    -104469.0810 -106848.19  2.28%     -    0s
     0     0 -106848.19    0   86 -104469.08 -106848.19  2.28%     -    0s
H    0     0                    -105467.9478 -106759.19  1.22%     -    0s
     0     0 -106278.91    0   88 -105467.95 -106278.91  0.77%     -    0s
     0     0 -106241.96    0   89 -105467.95 -106241.96  0.73%     -    0s
     0     0 -105964.04    0   91 -105467.95 -105964.04  0.47%     -    0s
     0     0 -105935.68    0   91 -105467.95 -105935.68  0.44%     -    0s
     0     0 -105786.03    0   89 -105467.95 -105786.03  0.30%     -    0s
     0     0 -105766.80    0   82 -105467.95 -105766.80  0.28%     -    0s
H    0     0                    -105469.7691 -105766.80  0.28%     -    0s
     0     2 -105766.80    0   82 -105469.77 -105766.80  0.28%     -    0s
*  128    41              21    -105476.3924 -105537.89  0.06%   7.0    0s
*  168    26              22    -105489.2094 -105521.90  0.03%   6.4    0s
*  173    26              21    -105498.8957 -105519.31  0.02%   6.3    0s
*  187    26              22    -105501.8797 -105518.56  0.02%   6.0    0s

Cutting planes:
  Gomory: 24
  Implied bound: 3
  MIR: 178
  Flow cover: 17
  RLT: 4
  BQP: 1

Explored 267 nodes (1909 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -105502 -105499 -105489 ... 1.43567e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.055018796781e+05, best bound -1.055104618271e+05, gap 0.0081%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 138907.46
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105501.88
  [DEBUG]   S×d_nominal = 244409.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244409.34 + -105501.88 = 138907.46
  [DEBUG]   Current θ from Master = 140567.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1659.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19031.28
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 847.0976, Absolute Gap = 847.0976, Relative Gap = 0.040940
  Not converged yet (gap = 847.10 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654119 nonzeros
Model fingerprint: 0x71a7538c
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101505 rows and 41205 columns
Presolve time: 2.04s
Presolved: 129228 rows, 54655 columns, 795572 nonzeros
Variable types: 52396 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 628
 AA' NZ     : 6.212e+06
 Factor NZ  : 1.386e+07 (roughly 200 MB of memory)
 Factor Ops : 3.046e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79219162e+07  2.19866837e+08  1.03e+05 2.00e+01  7.10e+04     4s
   1  -1.36966952e+07  1.90949768e+08  7.30e+04 6.07e+01  4.96e+04     4s
   2  -4.75406990e+06  1.38204314e+08  2.48e+04 8.81e-01  1.79e+04     4s
   3  -8.15754429e+05  9.76510403e+07  1.93e+03 1.54e+00  1.72e+03     4s
   4  -4.99062229e+05  3.98562088e+07  4.76e+02 4.10e-01  4.54e+02     4s
   5  -3.83624929e+05  2.62654296e+07  1.65e+02 2.31e-01  2.04e+02     4s
   6  -3.07628514e+05  2.08567211e+07  6.41e+01 1.73e-01  1.22e+02     4s
   7  -2.21712817e+05  1.47796842e+07  2.94e+01 1.14e-01  7.61e+01     4s
   8  -1.27919291e+05  9.08501502e+06  1.02e+01 6.51e-02  4.22e+01     4s
   9  -1.10353305e+05  5.71535931e+06  6.94e+00 3.94e-02  2.61e+01     4s
  10  -8.42891077e+04  2.23434111e+06  3.29e+00 1.44e-02  1.01e+01     4s
  11  -5.98477482e+04  5.86046839e+05  1.37e+00 3.45e-03  2.78e+00     4s
  12  -2.55183472e+04  2.70377485e+05  5.31e-01 1.53e-03  1.26e+00     4s
  13  -1.41720675e+04  1.94489483e+05  3.80e-01 1.53e-03  8.90e-01     4s
  14  -3.35675183e+03  1.33307832e+05  2.85e-01 2.14e-03  5.83e-01     4s
  15   1.82961275e+03  1.11087343e+05  2.46e-01 2.12e-03  4.66e-01     4s
  16   7.40193870e+03  8.91547282e+04  2.03e-01 2.61e-03  3.49e-01     4s
  17   1.35527457e+04  8.06616927e+04  1.57e-01 2.53e-03  2.86e-01     4s
  18   1.74330680e+04  7.09428795e+04  1.29e-01 1.93e-03  2.28e-01     5s
  19   2.21371916e+04  6.48423686e+04  9.65e-02 1.72e-03  1.82e-01     5s
  20   2.48812791e+04  6.04347984e+04  8.05e-02 1.34e-03  1.52e-01     5s
  21   2.71393643e+04  5.34085375e+04  6.80e-02 1.23e-03  1.12e-01     5s
  22   2.88593635e+04  5.11011330e+04  5.92e-02 1.37e-03  9.49e-02     5s
  23   3.22161247e+04  4.92903681e+04  4.30e-02 1.13e-03  7.28e-02     5s
  24   3.38421051e+04  4.76515950e+04  3.55e-02 1.39e-03  5.89e-02     5s
  25   3.56609590e+04  4.54296372e+04  2.72e-02 1.40e-03  4.17e-02     5s
  26   3.69948330e+04  4.45634114e+04  2.12e-02 9.57e-04  3.23e-02     5s
  27   3.82632714e+04  4.37393242e+04  1.56e-02 6.08e-04  2.34e-02     5s
  28   3.88577235e+04  4.34686567e+04  1.31e-02 5.04e-04  1.97e-02     5s
  29   4.00603024e+04  4.31717451e+04  8.03e-03 5.87e-04  1.33e-02     5s
  30   4.03135842e+04  4.28944002e+04  6.99e-03 4.14e-04  1.10e-02     5s
  31   4.06092967e+04  4.25937967e+04  5.79e-03 6.50e-04  8.47e-03     5s
  32   4.13250014e+04  4.23985868e+04  2.99e-03 4.77e-04  4.58e-03     5s
  33   4.16436513e+04  4.22595914e+04  1.70e-03 2.35e-04  2.63e-03     5s
  34   4.17757910e+04  4.21809625e+04  1.19e-03 1.19e-04  1.73e-03     6s
  35   4.17817795e+04  4.21514232e+04  1.16e-03 8.05e-05  1.58e-03     6s
  36   4.19324654e+04  4.21245618e+04  5.68e-04 4.48e-05  8.20e-04     6s
  37   4.20048573e+04  4.21085031e+04  3.04e-04 4.77e-05  4.42e-04     6s
  38   4.20329895e+04  4.20991987e+04  1.99e-04 2.35e-05  2.83e-04     6s
  39   4.20706697e+04  4.20963817e+04  6.93e-05 1.54e-05  1.10e-04     6s
  40   4.20744122e+04  4.20941354e+04  5.60e-05 9.30e-06  8.42e-05     6s
  41   4.20779890e+04  4.20912614e+04  4.34e-05 3.60e-07  5.67e-05     6s
  42   4.20895638e+04  4.20910366e+04  3.91e-06 5.26e-06  6.28e-06     6s
  43   4.20908535e+04  4.20908874e+04  6.70e-08 1.33e-07  1.45e-07     6s
  44   4.20908844e+04  4.20908845e+04  4.97e-10 7.44e-11  7.22e-11     6s

Barrier solved model in 44 iterations and 6.11 seconds (10.87 work units)
Optimal objective 4.20908844e+04


Root crossover log...

  114349 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    1879 PPushes remaining with PInf 1.1702732e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7029003e-10     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53737    4.2090884e+04   0.000000e+00   0.000000e+00     10s
   53737    4.2090884e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.08s

Solved with barrier

Root relaxation: objective 4.209088e+04, 53737 iterations, 7.05 seconds (16.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42090.8845    0  200 -208513.72 42090.8845   120%     -   10s
H    0     0                    -82802.16838 42090.8845   151%     -   10s
H    0     0                    -71394.81484 42090.8845   159%     -   10s
H    0     0                    -71268.23060 42090.8845   159%     -   10s
H    0     0                    -70881.17016 42090.8845   159%     -   10s
H    0     0                    -70726.59505 42090.8845   160%     -   10s
H    0     0                    -70004.67067 42090.8845   160%     -   10s
H    0     0                    -69567.43187 42090.8845   161%     -   10s
H    0     0                    -40633.58546 42090.8845   204%     -   11s
H    0     0                    14710.580822 42090.8845   186%     -   11s
H    0     0                    15995.375406 42090.8845   163%     -   11s
H    0     0                    15996.372867 42090.8845   163%     -   11s
H    0     0                    16199.227026 42090.8845   160%     -   11s
H    0     0                    16204.113351 42089.9302   160%     -   13s
H    0     0                    16235.006575 42089.9302   159%     -   13s
H    0     0                    16304.072099 36973.7656   127%     -   47s
     0     0 36973.7656    0  227 16304.0721 36973.7656   127%     -   47s
     0     0 35827.4638    0  284 16304.0721 35827.4638   120%     -   60s
     0     0 35671.8851    0  280 16304.0721 35671.8851   119%     -   79s
     0     0 35671.8851    0  284 16304.0721 35671.8851   119%     -   84s
     0     0 35671.8851    0  283 16304.0721 35671.8851   119%     -   86s
     0     0 35671.8851    0  284 16304.0721 35671.8851   119%     -   88s
     0     0 35671.8851    0  284 16304.0721 35671.8851   119%     -   88s
H    0     0                    16311.854054 31781.4294  94.8%     -  121s
     0     0 31781.4294    0  246 16311.8541 31781.4294  94.8%     -  121s
H    0     0                    18928.180887 31781.1031  67.9%     -  122s
H    0     0                    19184.480579 31781.1031  65.7%     -  122s
H    0     0                    19211.991668 31781.1031  65.4%     -  122s
H    0     0                    19525.029371 31781.1031  62.8%     -  122s
H    0     0                    19578.822983 31781.1031  62.3%     -  122s
H    0     0                    19603.350551 31781.1031  62.1%     -  122s
H    0     0                    19610.003189 31781.1031  62.1%     -  122s
     0     0 30960.0088    0  320 19610.0032 30960.0088  57.9%     -  141s
     0     0 30813.9195    0  303 19610.0032 30813.9195  57.1%     -  151s
     0     0 30757.5372    0  307 19610.0032 30757.5372  56.8%     -  156s
     0     0 30642.5904    0  313 19610.0032 30642.5904  56.3%     -  166s
     0     0 30515.5559    0  311 19610.0032 30515.5559  55.6%     -  171s
     0     0 30237.9344    0  322 19610.0032 30237.9344  54.2%     -  180s
     0     0 30186.0970    0  323 19610.0032 30186.0970  53.9%     -  186s
     0     0 30059.9401    0  327 19610.0032 30059.9401  53.3%     -  197s
     0     0 30044.5005    0  327 19610.0032 30044.5005  53.2%     -  200s
     0     0 30038.5675    0  325 19610.0032 30038.5675  53.2%     -  202s
     0     0 30010.7015    0  322 19610.0032 30010.7015  53.0%     -  206s
H    0     0                    19674.561354 30002.2660  52.5%     -  208s
H    0     0                    19999.785581 30002.2660  50.0%     -  208s
     0     0 30002.2660    0  313 19999.7856 30002.2660  50.0%     -  208s
     0     0 29991.2177    0  315 19999.7856 29991.2177  50.0%     -  210s
     0     0 29989.4212    0  317 19999.7856 29989.4212  49.9%     -  211s
     0     0 29988.7382    0  321 19999.7856 29988.7382  49.9%     -  211s
H    0     0                    20019.711176 28892.6987  44.3%     -  251s
     0     0 28892.6987    0  338 20019.7112 28892.6987  44.3%     -  251s
H    0     0                    20298.839464 28891.8626  42.3%     -  252s
H    0     0                    20356.306976 28891.8626  41.9%     -  252s
H    0     0                    20366.664444 28891.8626  41.9%     -  252s
     0     0 28349.9401    0  278 20366.6644 28349.9401  39.2%     -  273s
     0     0 28244.8471    0  279 20366.6644 28244.8471  38.7%     -  283s
     0     0 28163.9083    0  277 20366.6644 28163.9083  38.3%     -  292s
     0     0 28072.3170    0  268 20366.6644 28072.3170  37.8%     -  299s
     0     0 28033.2325    0  278 20366.6644 28033.2325  37.6%     -  305s
     0     0 28009.3115    0  284 20366.6644 28009.3115  37.5%     -  309s
     0     0 28007.7979    0  284 20366.6644 28007.7979  37.5%     -  311s
     0     0 27684.7269    0  330 20366.6644 27684.7269  35.9%     -  328s
     0     0 27572.5323    0  335 20366.6644 27572.5323  35.4%     -  337s
     0     0 27536.9887    0  341 20366.6644 27536.9887  35.2%     -  343s
     0     0 27520.5788    0  345 20366.6644 27520.5788  35.1%     -  347s
H    0     0                    20404.471159 27504.9396  34.8%     -  349s
     0     0 27504.9396    0  351 20404.4712 27504.9396  34.8%     -  349s
H    0     0                    20412.651576 27434.1438  34.4%     -  354s
H    0     0                    20446.878215 27434.1438  34.2%     -  354s
     0     0 27434.1438    0  333 20446.8782 27434.1438  34.2%     -  354s
     0     0 27398.9268    0  340 20446.8782 27398.9268  34.0%     -  359s
     0     0 27377.3939    0  345 20446.8782 27377.3939  33.9%     -  362s
     0     0 27361.6420    0  283 20446.8782 27361.6420  33.8%     -  364s
     0     0 27358.9150    0  283 20446.8782 27358.9150  33.8%     -  365s
     0     0 27353.7158    0  274 20446.8782 27353.7158  33.8%     -  367s
     0     0 27351.3570    0  273 20446.8782 27351.3570  33.8%     -  368s
     0     0 27350.0332    0  276 20446.8782 27350.0332  33.8%     -  369s
     0     0 27273.7761    0  396 20446.8782 27273.7761  33.4%     -  377s
H    0     0                    20484.562895 27266.8181  33.1%     -  381s
H    0     0                    20567.421629 27266.8181  32.6%     -  381s
H    0     0                    20596.426161 27266.8181  32.4%     -  381s
H    0     0                    20614.252977 27266.8181  32.3%     -  381s
H    0     0                    20644.941781 27266.8181  32.1%     -  381s
     0     0 27266.8181    0  343 20644.9418 27266.8181  32.1%     -  381s
     0     0 27259.6182    0  393 20644.9418 27259.6182  32.0%     -  384s
     0     0 27254.0452    0  394 20644.9418 27254.0452  32.0%     -  385s
     0     0 27252.2566    0  395 20644.9418 27252.2566  32.0%     -  387s
     0     0 27193.5140    0  331 20644.9418 27193.5140  31.7%     -  394s
     0     0 27189.2696    0  330 20644.9418 27189.2696  31.7%     -  397s
     0     0 27182.4484    0  336 20644.9418 27182.4484  31.7%     -  400s
     0     0 27179.9040    0  347 20644.9418 27179.9040  31.7%     -  402s
     0     0 27178.1883    0  338 20644.9418 27178.1883  31.6%     -  403s
     0     0 27143.7108    0  344 20644.9418 27143.7108  31.5%     -  408s
     0     0 27133.5917    0  349 20644.9418 27133.5917  31.4%     -  412s
     0     0 27131.8511    0  353 20644.9418 27131.8511  31.4%     -  413s
     0     0 27123.0197    0  346 20644.9418 27123.0197  31.4%     -  419s
H    0     0                    20649.768823 27121.5016  31.3%     -  421s
     0     0 27120.3195    0  335 20649.7688 27120.3195  31.3%     -  422s
     0     0 27120.0170    0  335 20649.7688 27120.0170  31.3%     -  424s
     0     0 27113.6765    0  340 20649.7688 27113.6765  31.3%     -  428s
     0     0 27113.0950    0  337 20649.7688 27113.0950  31.3%     -  430s
     0     0 27106.0569    0  337 20649.7688 27106.0569  31.3%     -  435s
     0     0 27102.9710    0  338 20649.7688 27102.9710  31.3%     -  439s
     0     0 27068.3221    0  351 20649.7688 27068.3221  31.1%     -  446s
     0     0 27062.8157    0  359 20649.7688 27062.8157  31.1%     -  449s
     0     0 27062.4051    0  359 20649.7688 27062.4051  31.1%     -  450s
     0     0 27045.2991    0  362 20649.7688 27045.2991  31.0%     -  454s
     0     0 27037.6960    0  353 20649.7688 27037.6960  30.9%     -  459s
     0     0 27030.0658    0  399 20649.7688 27030.0658  30.9%     -  463s
     0     0 27028.1267    0  347 20649.7688 27028.1267  30.9%     -  465s
     0     0 27027.0590    0  364 20649.7688 27027.0590  30.9%     -  467s
     0     0 27026.4138    0  353 20649.7688 27026.4138  30.9%     -  470s
     0     0 27025.9510    0  349 20649.7688 27025.9510  30.9%     -  472s
     0     0 27025.8719    0  350 20649.7688 27025.8719  30.9%     -  521s
     0     0 27025.7297    0  351 20649.7688 27025.7297  30.9%     -  523s
     0     0 27025.6824    0  351 20649.7688 27025.6824  30.9%     -  528s
     0     2 27025.6824    0  351 20649.7688 27025.6824  30.9%     -  571s
     1     3 26618.1281    1  337 20649.7688 27025.6824  30.9% 13874  583s
     2     4 26653.4640    1  338 20649.7688 26653.4640  29.1% 12876  592s
     3     6 25761.2507    2  287 20649.7688 26653.3849  29.1%  9547  604s
     5    12 25605.3313    3  345 20649.7688 26653.3849  29.1%  9488  614s
    11    24 25205.8961    4  334 20649.7688 26216.2233  27.0%  8052  626s
    23    36 24737.9436    4  404 20649.7688 25756.6389  24.7% 12408  674s
    35    68 24094.2368    5  296 20649.7688 25756.6389  24.7% 12783  899s
    67   100 23928.5659    6  294 20649.7688 25127.7084  21.7% 20009  928s
    99   167 23909.2085    7  296 20649.7688 25127.7084  21.7% 15427  959s
H  114   167                    20656.185925 25127.7084  21.6% 13588  959s
   166   307 23904.6685    8  288 20656.1859 25127.7084  21.6% 10582  986s
   306   336 23555.4864   11  300 20656.1859 25127.7084  21.6%  8102  998s
   339   367 23459.2124   12  352 20656.1859 25127.7084  21.6%  7898 1013s
   374   406 23376.3774   13  396 20656.1859 25127.7084  21.6%  7783 1025s
   413   438 23339.1692   14  392 20656.1859 25127.7084  21.6%  7791 1046s
   455   471 23308.3048   15  397 20656.1859 25127.7084  21.6%  7784 1056s
   501   498 23277.5737   16  391 20656.1859 25127.7084  21.6%  7593 1071s
   540   549 23178.8370   17  429 20656.1859 24996.8050  21.0%  7561 1084s
   601   623 22365.4715   18  208 20656.1859 24996.8050  21.0%  7478 1099s
   682   659 22081.9226   21  221 20656.1859 24996.8050  21.0%  7202 1113s
   756   702 21978.1223   23  228 20656.1859 24996.8050  21.0%  7119 1131s
   834   751 21847.2201   27  206 20656.1859 24996.8050  21.0%  6960 1144s
   916   767 21547.7602   31  214 20656.1859 24996.8050  21.0%  6751 1161s
   987   773 20722.3375   34  244 20656.1859 24996.8050  21.0%  6791 1177s
  1053   811     cutoff   35      20656.1859 24996.8050  21.0%  6803 1192s
  1125   842 21507.3708   16  211 20656.1859 24996.8050  21.0%  6741 1208s
  1210   856 20901.0866   18  213 20656.1859 24996.8050  21.0%  6616 1226s
  1282   901 20688.4456   19  183 20656.1859 24996.8050  21.0%  6629 1243s
  1374   972     cutoff   11      20656.1859 24996.8050  21.0%  6623 1260s
  1499  1031 20872.8403   13  229 20656.1859 24996.8050  21.0%  6436 1278s
  1623  1058 20680.2100   15  221 20656.1859 24996.8050  21.0%  6262 1297s
  1747  1083     cutoff   10      20656.1859 24996.8050  21.0%  6220 1315s
  1849  1123 22588.0471   11  332 20656.1859 24996.8050  21.0%  6240 1334s
  1933  1162 22536.4399   12  281 20656.1859 24996.8050  21.0%  6368 1360s
  2020  1192 22205.8731   14  317 20656.1859 24996.8050  21.0%  6506 1383s
  2112  1227 21652.3203   16  235 20656.1859 24996.8050  21.0%  6540 1406s
  2238  1295 21564.4709   17  236 20656.1859 24996.8050  21.0%  6555 1429s
  2391  1328 21345.3924   22  220 20656.1859 24996.8050  21.0%  6536 1451s
  2522  1377 21171.2616   27  191 20656.1859 24996.8050  21.0%  6564 1475s
  2663  1436 21018.2557   31  223 20656.1859 24996.8050  21.0%  6511 1500s
  2796  1499 infeasible   38      20656.1859 24571.4715  19.0%  6560 1528s
  2934  1551 23120.5200   11  348 20656.1859 24462.3352  18.4%  6617 1556s
  3095  1599     cutoff   13      20656.1859 24462.3352  18.4%  6625 1584s
  3227  1673 21216.4854   13  262 20656.1859 24155.0970  16.9%  6724 1613s
  3395  1716 21060.8170   13  219 20656.1859 24063.0356  16.5%  6769 1641s
  3482  1774 infeasible   16      20656.1859 24063.0356  16.5%  6794 1674s
  3678  1809 23119.3677   14  333 20656.1859 24013.1556  16.3%  6775 1708s
  3849  1891 21568.6258   18  387 20656.1859 23949.8084  15.9%  6818 1738s
  4037  1986 infeasible   25      20656.1859 23929.0030  15.8%  6865 1772s
  4251  2088 22541.0059    8  286 20656.1859 23929.0030  15.8%  6871 1809s
  4456  2197 21742.6452   11  267 20656.1859 23922.1204  15.8%  6895 1846s
  4714  2301     cutoff   15      20656.1859 23922.1204  15.8%  6867 1884s
  4951  2302 22577.1959   12  351 20656.1859 23854.5652  15.5%  6878 2059s
  4953  2303 22714.2893   17  148 20656.1859 23854.5652  15.5%  6875 2073s
  4954  2304 21174.3510   20  343 20656.1859 23854.5652  15.5%  6874 2130s
  4955  2305 21565.0307   17  332 20656.1859 23854.5652  15.5%  6872 2165s
  4956  2305 21698.2090   40  345 20656.1859 23854.5652  15.5%  6871 2198s
  4957  2306 21447.1543   16  343 20656.1859 23854.5652  15.5%  6869 2216s
  4958  2307 21305.1733   23  395 20656.1859 23854.5652  15.5%  6868 2234s
  4959  2307 22778.8234    9  354 20656.1859 23854.5652  15.5%  6867 2239s
  4960  2308 21472.1559   41  350 20656.1859 23854.5652  15.5%  6865 2246s
  4961  2309 21347.3707   31  412 20656.1859 23854.5652  15.5%  6864 2254s
  4962  2309 21788.2949   18  329 20656.1859 23854.5652  15.5%  6862 2267s
  4963  2310 23682.7721    8  329 20656.1859 23854.5652  15.5%  6861 2271s
  4964  2311 23574.5650    9  274 20656.1859 23854.5652  15.5%  6860 2280s
  4965  2311 20746.5765   34  244 20656.1859 23854.5652  15.5%  6858 2285s
  4966  2312 21125.3333   28  412 20656.1859 23854.5652  15.5%  6857 2290s
  4967  2313 23355.3570   11  371 20656.1859 23854.5652  15.5%  6856 2298s
  4968  2313 21993.1239   14  369 20656.1859 23854.5652  15.5%  6854 2306s
  4969  2314 21786.1981   29  338 20656.1859 23854.5652  15.5%  6853 2314s
  4970  2315 21981.0727   15  247 20656.1859 23854.5652  15.5%  6851 2321s
  4971  2315 23750.8630    9  337 20656.1859 23854.5652  15.5%  6850 2342s
  4972  2316 22124.5979   15  278 20656.1859 23854.5652  15.5%  6849 2348s
  4973  2317 21575.9195   18  395 20656.1859 23854.5652  15.5%  6847 2354s
  4974  2317 21413.4659   16  383 20656.1859 23854.5652  15.5%  6846 2367s
  4975  2318 20892.8268   21  331 20656.1859 23854.5652  15.5%  6845 2375s
  4976  2319 22533.7753   11  345 20656.1859 23854.5652  15.5%  6843 2382s
  4977  2319 21243.2387   23  353 20656.1859 23854.5652  15.5%  6842 2395s
  4978  2320 23564.8871   14  361 20656.1859 23854.5652  15.5%  6840 2401s
  4979  2321 22183.7331   24  370 20656.1859 23854.5652  15.5%  6839 2406s
  4980  2321 21028.3410   35  369 20656.1859 23854.5652  15.5%  6838 2424s
  4981  2322 21358.5490   14  355 20656.1859 23854.5652  15.5%  6836 2432s
  4982  2323 21369.3802   22  352 20656.1859 23854.5652  15.5%  6835 2438s
  4983  2323 22362.2017   13  372 20656.1859 23854.5652  15.5%  6834 2450s
  4984  2324 22910.9298   10  286 20656.1859 23854.5652  15.5%  6832 2455s
  4985  2325 23703.7786   17  371 20656.1859 23854.5652  15.5%  6831 2472s
  4986  2325 22422.8106   13  439 20656.1859 23854.5652  15.5%  6829 2482s
  4987  2326 21228.7641   17  452 20656.1859 23854.5652  15.5%  6828 2487s
  4988  2327 21413.4659   16  372 20656.1859 23854.5652  15.5%  6827 2492s
  4989  2327 22021.7841   17  374 20656.1859 23854.5652  15.5%  6825 2507s
  4990  2328 21552.8469   21  419 20656.1859 23854.5652  15.5%  6824 2513s
  4991  2329 21118.6553   32  380 20656.1859 23854.5652  15.5%  6823 2524s
  4992  2329 20967.9792   21  380 20656.1859 23854.5652  15.5%  6821 2537s
  4993  2330 23436.8026    6  380 20656.1859 23854.5652  15.5%  6820 2576s
  4994  2333 23854.5652   16  313 20656.1859 23854.5652  15.5%  6904 2611s
  4995  2335 23854.5652   17  285 20656.1859 23854.5652  15.5%  6905 2641s
  4998  2340 23854.5652   18  299 20656.1859 23854.5652  15.5%  6907 2659s
  5004  2350 23701.8337   19  277 20656.1859 23854.5652  15.5%  6916 2680s
  5016  2352 23629.6378   19  282 20656.1859 23854.5652  15.5%  6931 3392s
  5028  2366 22836.6592   21  342 20656.1859 23854.5652  15.5%  6975 3474s
  5052  2390 22322.5006   22  339 20656.1859 23854.5652  15.5%  7040 3500s
  5084  2412 21486.1891   23  293 20656.1859 23854.5652  15.5%  7070 3526s
  5130  2435 21359.7408   24  287 20656.1859 23854.5652  15.5%  7137 3552s
  5202  2431 20925.3508   25  340 20656.1859 23854.5652  15.5%  7139 3572s
  5275  2406     cutoff   25      20656.1859 23854.5652  15.5%  7170 3600s

Cutting planes:
  Gomory: 22
  Implied bound: 10
  Projected implied bound: 198
  MIR: 965
  Mixing: 3
  Flow cover: 1559
  RLT: 19
  Relax-and-lift: 120

Explored 5346 nodes (39020719 simplex iterations) in 3600.09 seconds (8531.47 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20656.2 20649.8 20644.9 ... 20404.5

Time limit reached
Best objective 2.065618592524e+04, best bound 2.385456519947e+04, gap 15.4839%
  WARNING: Time limit reached. Using best solution found (gap: 15.48%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 20656.19, θ = 140576.60
  Upper Bound (UB) = 20656.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140576.60
  [DEBUG]   ✓ Scenario 0: θ = 140576.60 ≤ Q = 140576.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140576.60 ≤ Q = 140582.54 (slack: 5.94)
  [DEBUG]   ✓ Scenario 2: θ = 140576.60 ≤ Q = 140576.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140576.60 ≤ Q = 140576.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140576.60 ≤ Q = 140576.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140576.60 ≤ Q = 140576.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140576.60 ≤ Q = 140576.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140576.60 ≤ Q = 140576.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140576.60 ≤ Q = 140576.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140576.60 ≤ Q = 140576.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140576.60 ≤ Q = 140576.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140576.60 ≤ Q = 140576.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140576.60 ≤ Q = 140576.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140576.60 ≤ Q = 140576.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140576.60 ≤ Q = 140576.60 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x120a7a56
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x120a7a56
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7498105.5199
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.357652e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135765.24    0  123 7498105.52 -135765.24   102%     -    0s
H    0     0                    -100868.9776 -135765.24  34.6%     -    0s
     0     0 -109482.54    0   82 -100868.98 -109482.54  8.54%     -    0s
H    0     0                    -106966.7645 -109372.35  2.25%     -    0s
     0     0 -108790.44    0   83 -106966.76 -108790.44  1.70%     -    0s
H    0     0                    -107619.9235 -108772.14  1.07%     -    0s
H    0     0                    -107623.7656 -108772.14  1.07%     -    0s
     0     0 -108379.50    0   82 -107623.77 -108379.50  0.70%     -    0s
H    0     0                    -107643.2754 -108334.02  0.64%     -    0s
H    0     0                    -107689.1624 -108299.98  0.57%     -    0s
     0     0 -108299.98    0   81 -107689.16 -108299.98  0.57%     -    0s
     0     0 -108293.15    0   82 -107689.16 -108293.15  0.56%     -    0s
     0     0 -107980.00    0   32 -107689.16 -107980.00  0.27%     -    0s
     0     0 -107960.94    0   24 -107689.16 -107960.94  0.25%     -    0s
     0     0 -107892.42    0   33 -107689.16 -107892.42  0.19%     -    0s
     0     0 -107890.05    0   26 -107689.16 -107890.05  0.19%     -    0s
     0     0 -107874.21    0   27 -107689.16 -107874.21  0.17%     -    0s
     0     0 -107801.26    0    9 -107689.16 -107801.26  0.10%     -    0s
     0     0 -107801.26    0   17 -107689.16 -107801.26  0.10%     -    0s
H    0     0                    -107713.0974 -107801.26  0.08%     -    0s
     0     0 -107762.04    0    7 -107713.10 -107762.04  0.05%     -    0s
H    0     0                    -107761.0764 -107761.49  0.00%     -    0s
     0     0 -107761.49    0    5 -107761.08 -107761.49  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 6
  Flow cover: 9
  Relax-and-lift: 3

Explored 1 nodes (849 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -107761 -107713 -107689 ... 1.43567e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.077610763935e+05, best bound -1.077614909309e+05, gap 0.0004%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 136678.83
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107761.08
  [DEBUG]   S×d_nominal = 244439.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244439.91 + -107761.08 = 136678.83
  [DEBUG]   Current θ from Master = 140576.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3897.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16758.41
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 812.2491, Absolute Gap = 812.2491, Relative Gap = 0.039322
  Not converged yet (gap = 812.25 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697359 nonzeros
Model fingerprint: 0x224761e5
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 108272 rows and 43952 columns
Presolve time: 2.26s
Presolved: 137751 rows, 58148 columns, 847918 nonzeros
Variable types: 55889 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.18s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 6.998e+06
 Factor NZ  : 1.529e+07 (roughly 200 MB of memory)
 Factor Ops : 3.344e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79404064e+07  2.32705580e+08  1.04e+05 1.95e+01  7.07e+04     5s
   1  -1.37289203e+07  2.01935927e+08  7.30e+04 5.90e+01  4.94e+04     5s
   2  -4.88552598e+06  1.46022403e+08  2.54e+04 1.06e+00  1.83e+04     5s
   3  -8.47940764e+05  1.03661714e+08  2.10e+03 1.59e+00  1.83e+03     5s
   4  -4.91320349e+05  3.55825295e+07  4.52e+02 2.51e-01  4.11e+02     5s
   5  -3.64948388e+05  2.45781695e+07  1.40e+02 1.43e-01  1.76e+02     5s
   6  -2.90885190e+05  1.90452647e+07  6.24e+01 1.03e-01  1.08e+02     5s
   7  -2.12184213e+05  1.51640727e+07  3.41e+01 7.78e-02  7.61e+01     5s
   8  -1.30292845e+05  1.00559181e+07  1.14e+01 4.77e-02  4.43e+01     5s
   9  -1.14454157e+05  7.01537593e+06  7.98e+00 3.23e-02  3.03e+01     5s
  10  -8.87447101e+04  3.95057731e+06  3.50e+00 1.74e-02  1.66e+01     5s
  11  -7.68518433e+04  6.37009147e+05  2.14e+00 2.49e-03  2.91e+00     5s
  12  -4.21958804e+04  3.25022761e+05  1.02e+00 1.55e-03  1.48e+00     5s
  13  -2.48408937e+04  2.10225718e+05  7.14e-01 9.46e-04  9.46e-01     5s
  14  -1.68423435e+04  1.52347343e+05  6.08e-01 1.87e-03  6.81e-01     6s
  15  -4.45047076e+03  1.20638332e+05  4.67e-01 2.01e-03  5.03e-01     6s
  16   4.55591668e+03  1.03547409e+05  3.64e-01 1.87e-03  3.98e-01     6s
  17   1.26017304e+04  8.87987602e+04  2.69e-01 1.50e-03  3.06e-01     6s
  18   1.61596793e+04  7.19855987e+04  2.27e-01 2.21e-03  2.25e-01     6s
  19   2.10948691e+04  6.45356705e+04  1.73e-01 1.31e-03  1.75e-01     6s
  20   2.48126781e+04  6.05834141e+04  1.36e-01 1.29e-03  1.44e-01     6s
  21   2.66511101e+04  5.58022875e+04  1.18e-01 1.15e-03  1.17e-01     6s
  22   2.88630925e+04  5.17696698e+04  9.76e-02 1.75e-03  9.21e-02     6s
  23   3.10572675e+04  4.90940977e+04  7.89e-02 1.33e-03  7.26e-02     6s
  24   3.35875276e+04  4.68559507e+04  5.90e-02 1.88e-03  5.34e-02     6s
  25   3.56307555e+04  4.48759581e+04  4.37e-02 3.38e-03  3.72e-02     6s
  26   3.74014417e+04  4.37830135e+04  3.05e-02 3.93e-03  2.57e-02     6s
  27   3.85292891e+04  4.33178913e+04  2.23e-02 3.51e-03  1.93e-02     6s
  28   3.97644143e+04  4.28478166e+04  1.35e-02 2.50e-03  1.24e-02     6s
  29   4.02878015e+04  4.24480840e+04  9.87e-03 1.50e-03  8.69e-03     6s
  30   4.06762198e+04  4.23402298e+04  7.14e-03 1.25e-03  6.69e-03     6s
  31   4.08560212e+04  4.22160580e+04  5.95e-03 9.64e-04  5.47e-03     6s
  32   4.11078489e+04  4.20450700e+04  4.32e-03 5.44e-04  3.77e-03     7s
  33   4.14165380e+04  4.19080651e+04  2.33e-03 2.30e-04  1.98e-03     7s
  34   4.15443713e+04  4.18474021e+04  1.58e-03 1.51e-04  1.22e-03     7s
  35   4.15896960e+04  4.18233604e+04  1.29e-03 5.16e-05  9.43e-04     7s
  36   4.16891162e+04  4.18183893e+04  6.59e-04 3.75e-05  5.21e-04     7s
  37   4.17246675e+04  4.18141126e+04  4.44e-04 2.35e-05  3.60e-04     7s
  38   4.17274209e+04  4.18100716e+04  4.28e-04 1.25e-05  3.33e-04     7s
  39   4.17947673e+04  4.18092100e+04  4.78e-05 9.54e-06  5.79e-05     7s
  40   4.17988643e+04  4.18070885e+04  2.89e-05 4.01e-06  3.30e-05     7s
  41   4.18000207e+04  4.18059866e+04  2.40e-05 2.99e-06  2.40e-05     7s
  42   4.18042831e+04  4.18057693e+04  4.82e-06 3.76e-06  5.96e-06     7s
  43   4.18055341e+04  4.18056346e+04  3.30e-07 5.58e-07  4.02e-07     7s
  44   4.18056150e+04  4.18056155e+04  7.28e-08 9.77e-08  1.70e-09     7s
  45   4.18056153e+04  4.18056153e+04  1.44e-08 7.64e-10  1.21e-10     8s

Barrier solved model in 45 iterations and 7.57 seconds (12.80 work units)
Optimal objective 4.18056153e+04


Root crossover log...

  122379 DPushes remaining with DInf 0.0000000e+00                 8s
   16796 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    2771 PPushes remaining with PInf 2.8400288e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.0310213e-10     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57316    4.1805615e+04   0.000000e+00   0.000000e+00     14s
   57316    4.1805615e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.180562e+04, 57316 iterations, 11.02 seconds (18.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41805.6153    0  189 -208513.72 41805.6153   120%     -   14s
H    0     0                    -206826.3073 41805.6153   120%     -   14s
H    0     0                    -141247.5614 41805.6153   130%     -   15s
H    0     0                    -125098.0123 41805.6153   133%     -   15s
H    0     0                    -125049.8389 41805.6153   133%     -   15s
H    0     0                    -40633.58546 41805.6153   203%     -   15s
H    0     0                    14710.580822 41805.6153   184%     -   15s
H    0     0                    15737.992428 41805.6153   166%     -   16s
H    0     0                    16002.000652 41805.6153   161%     -   16s
H    0     0                    16051.513301 41805.6153   160%     -   16s
H    0     0                    16067.652972 41805.6153   160%     -   16s
H    0     0                    16104.019148 41805.6153   160%     -   16s
H    0     0                    16125.650405 41805.6153   159%     -   16s
     0     0 36944.9597    0  272 16125.6504 36944.9597   129%     -   53s
H    0     0                    16196.075963 36944.7984   128%     -   54s
H    0     0                    16213.481013 36944.7984   128%     -   54s
H    0     0                    16310.222397 36944.7984   127%     -   54s
     0     0 36169.8360    0  283 16310.2224 36169.8360   122%     -   72s
     0     0 36075.1786    0  286 16310.2224 36075.1786   121%     -   79s
     0     0 35966.3664    0  291 16310.2224 35966.3664   121%     -   90s
     0     0 35909.0463    0  296 16310.2224 35909.0463   120%     -   97s
     0     0 35907.8292    0  294 16310.2224 35907.8292   120%     -   99s
     0     0 35855.5476    0  287 16310.2224 35855.5476   120%     -  106s
     0     0 35654.9292    0  284 16310.2224 35654.9292   119%     -  119s
     0     0 35606.6689    0  292 16310.2224 35606.6689   118%     -  125s
     0     0 35601.1923    0  295 16310.2224 35601.1923   118%     -  127s
     0     0 35601.1923    0  295 16310.2224 35601.1923   118%     -  129s
     0     0 31451.2466    0  269 16310.2224 31451.2466  92.8%     -  171s
H    0     0                    18472.635892 31450.7504  70.3%     -  172s
H    0     0                    18822.001640 31450.7504  67.1%     -  172s
H    0     0                    19053.493673 31450.7504  65.1%     -  172s
H    0     0                    19152.577521 31450.7504  64.2%     -  172s
H    0     0                    19206.887943 31450.7504  63.7%     -  172s
H    0     0                    19322.812277 31450.7504  62.8%     -  172s
H    0     0                    19359.739117 31450.7504  62.5%     -  172s
H    0     0                    19371.746319 31450.7504  62.4%     -  172s
     0     0 30927.8602    0  318 19371.7463 30927.8602  59.7%     -  198s
     0     0 30660.1430    0  298 19371.7463 30660.1430  58.3%     -  208s
     0     0 30425.5949    0  334 19371.7463 30425.5949  57.1%     -  219s
     0     0 30367.6888    0  299 19371.7463 30367.6888  56.8%     -  226s
     0     0 30366.0078    0  308 19371.7463 30366.0078  56.8%     -  229s
     0     0 30267.9654    0  341 19371.7463 30267.9654  56.2%     -  241s
     0     0 30239.4455    0  327 19371.7463 30239.4455  56.1%     -  247s
     0     0 30210.5535    0  334 19371.7463 30210.5535  56.0%     -  252s
     0     0 30158.7607    0  337 19371.7463 30158.7607  55.7%     -  261s
     0     0 30142.5746    0  390 19371.7463 30142.5746  55.6%     -  267s
     0     0 30128.0962    0  332 19371.7463 30128.0962  55.5%     -  272s
     0     0 30085.2575    0  391 19371.7463 30085.2575  55.3%     -  278s
     0     0 30054.5659    0  385 19371.7463 30054.5659  55.1%     -  284s
     0     0 30040.9877    0  385 19371.7463 30040.9877  55.1%     -  288s
     0     0 30037.9928    0  394 19371.7463 30037.9928  55.1%     -  290s
     0     0 30037.0671    0  392 19371.7463 30037.0671  55.1%     -  290s
     0     0 28444.0134    0  341 19371.7463 28444.0134  46.8%     -  333s
H    0     0                    19438.302084 28443.9437  46.3%     -  334s
     0     0 28180.8229    0  355 19438.3021 28180.8229  45.0%     -  349s
     0     0 28040.1732    0  355 19438.3021 28040.1732  44.3%     -  358s
     0     0 28000.9045    0  360 19438.3021 28000.9045  44.1%     -  367s
     0     0 27977.4966    0  356 19438.3021 27977.4966  43.9%     -  373s
     0     0 27941.6061    0  353 19438.3021 27941.6061  43.7%     -  378s
     0     0 27932.6981    0  362 19438.3021 27932.6981  43.7%     -  382s
     0     0 27912.4637    0  359 19438.3021 27912.4637  43.6%     -  387s
     0     0 27901.0604    0  353 19438.3021 27901.0604  43.5%     -  391s
     0     0 27896.1495    0  364 19438.3021 27896.1495  43.5%     -  393s
     0     0 27883.6494    0  368 19438.3021 27883.6494  43.4%     -  396s
     0     0 27863.4640    0  372 19438.3021 27863.4640  43.3%     -  401s
     0     0 27858.3066    0  373 19438.3021 27858.3066  43.3%     -  404s
     0     0 27857.2868    0  377 19438.3021 27857.2868  43.3%     -  406s
     0     0 27568.3068    0  350 19438.3021 27568.3068  41.8%     -  435s
H    0     0                    19462.006987 27566.5102  41.6%     -  436s
H    0     0                    19495.786624 27566.5102  41.4%     -  436s
     0     0 27484.6802    0  352 19495.7866 27484.6802  41.0%     -  447s
     0     0 27469.2176    0  353 19495.7866 27469.2176  40.9%     -  453s
     0     0 27431.8121    0  408 19495.7866 27431.8121  40.7%     -  462s
     0     0 27426.5991    0  406 19495.7866 27426.5991  40.7%     -  465s
     0     0 27423.6836    0  420 19495.7866 27423.6836  40.7%     -  467s
     0     0 27419.5237    0  415 19495.7866 27419.5237  40.6%     -  469s
     0     0 27411.9844    0  412 19495.7866 27411.9844  40.6%     -  472s
     0     0 27408.5698    0  419 19495.7866 27408.5698  40.6%     -  473s
     0     0 27405.5334    0  343 19495.7866 27405.5334  40.6%     -  475s
     0     0 27404.2786    0  357 19495.7866 27404.2786  40.6%     -  478s
     0     0 27341.3160    0  287 19495.7866 27341.3160  40.2%     -  490s
H    0     0                    19630.364793 27340.3352  39.3%     -  490s
     0     0 27332.1089    0  345 19630.3648 27332.1089  39.2%     -  496s
     0     0 27329.5405    0  360 19630.3648 27329.5405  39.2%     -  499s
     0     0 27328.3807    0  369 19630.3648 27328.3807  39.2%     -  502s
     0     0 27318.3429    0  358 19630.3648 27318.3429  39.2%     -  507s
H    0     0                    19767.985325 27318.3389  38.2%     -  509s
H    0     0                    19817.580028 27318.3389  37.8%     -  509s
     0     0 27314.0350    0  361 19817.5800 27314.0350  37.8%     -  513s
     0     0 27313.2524    0  360 19817.5800 27313.2524  37.8%     -  515s
     0     0 27297.1392    0  298 19817.5800 27297.1392  37.7%     -  523s
     0     0 27293.6349    0  364 19817.5800 27293.6349  37.7%     -  527s
     0     0 27292.3747    0  360 19817.5800 27292.3747  37.7%     -  529s
     0     0 27287.5656    0  403 19817.5800 27287.5656  37.7%     -  534s
     0     0 27287.1037    0  350 19817.5800 27287.1037  37.7%     -  537s
     0     0 27240.6396    0  341 19817.5800 27240.6396  37.5%     -  547s
     0     0 27211.7840    0  353 19817.5800 27211.7840  37.3%     -  555s
     0     0 27204.4308    0  396 19817.5800 27204.4308  37.3%     -  561s
     0     0 27202.6426    0  398 19817.5800 27202.6426  37.3%     -  564s
     0     0 27198.1806    0  393 19817.5800 27198.1806  37.2%     -  569s
     0     0 27195.4403    0  341 19817.5800 27195.4403  37.2%     -  572s
     0     0 27194.0236    0  352 19817.5800 27194.0236  37.2%     -  573s
     0     0 27173.1608    0  344 19817.5800 27173.1608  37.1%     -  581s
     0     0 27170.0509    0  353 19817.5800 27170.0509  37.1%     -  584s
     0     0 27169.5735    0  350 19817.5800 27169.5735  37.1%     -  585s
     0     0 27040.4753    0  357 19817.5800 27040.4753  36.4%     -  599s
     0     0 27034.5958    0  283 19817.5800 27034.5958  36.4%     -  601s
     0     0 27033.9280    0  349 19817.5800 27033.9280  36.4%     -  603s
     0     0 27021.4006    0  339 19817.5800 27021.4006  36.4%     -  613s
     0     0 27004.9772    0  289 19817.5800 27004.9772  36.3%     -  619s
     0     0 27003.6556    0  286 19817.5800 27003.6556  36.3%     -  621s
     0     0 27000.1108    0  288 19817.5800 27000.1108  36.2%     -  624s
H    0     0                    19834.185411 26999.9105  36.1%     -  625s
H    0     0                    19880.745162 26999.9105  35.8%     -  625s
H    0     0                    19888.234247 26999.9105  35.8%     -  625s
H    0     0                    19891.600299 26999.9105  35.7%     -  625s
     0     0 26997.3644    0  346 19891.6003 26997.3644  35.7%     -  628s
     0     0 26996.6192    0  356 19891.6003 26996.6192  35.7%     -  632s
     0     0 26995.9180    0  352 19891.6003 26995.9180  35.7%     -  634s
     0     0 26994.9587    0  355 19891.6003 26994.9587  35.7%     -  637s
     0     0 26994.2400    0  358 19891.6003 26994.2400  35.7%     -  643s
     0     0 26994.2276    0  358 19891.6003 26994.2276  35.7%     -  644s
     0     0 26994.0070    0  357 19891.6003 26994.0070  35.7%     -  647s
     0     0 26992.9003    0  357 19891.6003 26992.9003  35.7%     -  654s
     0     2 26992.8332    0  357 19891.6003 26992.8332  35.7%     -  719s
     1     3 26300.7086    1  333 19891.6003 26987.2410  35.7% 18893  738s
     2     4 26777.5979    1  287 19891.6003 26777.5979  34.6% 14395  747s
     3     7 25899.2068    2  336 19891.6003 26777.4659  34.6% 11780  761s
     6    14 25921.9871    3  400 19891.6003 26777.4659  34.6% 13524  777s
    13    28 25309.4873    4  455 19891.6003 26419.3115  32.8% 11790  792s
    27    42 25770.6984    5  405 19891.6003 26316.4653  32.3% 16642  832s
    41    72 24467.8347    6  341 19891.6003 26316.4653  32.3% 17074  935s
H   44    72                    19892.557055 26316.4653  32.3% 16623  935s
H   46    72                    20298.832640 26316.4653  29.6% 16265  935s
H   57    72                    20305.647130 26316.4653  29.6% 14899  935s
H   60    72                    20320.257830 26316.4653  29.5% 14717  935s
H   62    72                    20343.688397 26316.4653  29.4% 14435  935s
    73   200 24068.9618    7  291 20343.6884 25844.0639  27.0% 17439  962s
   203   251 23669.8576   10  315 20343.6884 25565.0890  25.7% 10278  974s
H  211   251                    20411.967496 25565.0890  25.2% 10075  974s
H  215   251                    20423.785079 25565.0890  25.2%  9971  974s
H  218   251                    20467.252544 25565.0890  24.9%  9873  974s
   254   301 23650.8415    9  327 20467.2525 25565.0890  24.9%  9155  989s
   318   337 23754.7945   10  269 20467.2525 25565.0890  24.9%  8541 1002s
H  322   337                    20478.765135 25565.0890  24.8%  8494 1002s
H  326   337                    20490.494675 25565.0890  24.8%  8499 1002s
H  346   337                    20525.856197 25565.0890  24.6%  8369 1002s
   376   354 23392.2918    9  282 20525.8562 25565.0890  24.6%  8374 1032s
   412   377 23269.7223   11  256 20525.8562 25565.0890  24.6%  8257 1045s
H  434   377                    20674.322322 25565.0890  23.7%  8314 1045s
   445   462 23115.2146   10  306 20674.3223 25565.0890  23.7%  8337 1059s
   538   524 23640.7564   12  284 20674.3223 25565.0890  23.7%  7754 1070s
H  580   524                    20687.614328 25565.0890  23.6%  7488 1070s
   624   542 23444.6303   14  272 20687.6143 25565.0890  23.6%  7271 1083s
   653   563 22829.3717   14  249 20687.6143 25565.0890  23.6%  7179 1094s
   692   571 23389.1525   15  264 20687.6143 25565.0890  23.6%  7068 1106s
   728   585 20990.6686   23  207 20687.6143 25565.0890  23.6%  7066 1120s
   772   601 22205.3462   15  278 20687.6143 25565.0890  23.6%  6967 1133s
   807   619 22345.4948   15  258 20687.6143 25565.0890  23.6%  6922 1147s
   847   629 22161.2645   16  279 20687.6143 25565.0890  23.6%  6852 1161s
   896   657 21442.5435   16  198 20687.6143 25565.0890  23.6%  6839 1176s
   955   699 21935.4351   17  270 20687.6143 25565.0890  23.6%  6776 1190s
  1031   735 21829.7106   18  275 20687.6143 25565.0890  23.6%  6625 1203s
  1105   771 21507.5051   19  273 20687.6143 25565.0890  23.6%  6492 1218s
  1179   819 21782.3184   18  271 20687.6143 25565.0890  23.6%  6444 1233s
  1265   871 21557.3527   19  266 20687.6143 25565.0890  23.6%  6345 1247s
  1357   921 20950.4355   19  267 20687.6143 25565.0890  23.6%  6285 1262s
  1468   976 21306.6074   20  302 20687.6143 25309.4806  22.3%  6166 1278s
  1561  1027 20893.6101   20  274 20687.6143 25309.4806  22.3%  6230 1295s
  1652  1057     cutoff   19      20687.6143 25309.4806  22.3%  6284 1312s
  1742  1114 21067.9167   21  305 20687.6143 25309.4806  22.3%  6322 1331s
  1829  1176     cutoff   17      20687.6143 25309.4806  22.3%  6411 1350s
  1925  1233 21980.4573   12  301 20687.6143 25309.4806  22.3%  6432 1371s
  2035  1294 21513.0524   13  292 20687.6143 25309.4806  22.3%  6421 1390s
  2173  1357 infeasible   14      20687.6143 25309.4806  22.3%  6337 1411s
  2295  1430 21059.2896   16  258 20687.6143 25309.4806  22.3%  6370 1432s
  2438  1503 infeasible   16      20687.6143 25309.4806  22.3%  6348 1457s
  2553  1555 21251.0440   14  176 20687.6143 25309.4806  22.3%  6335 1477s
  2644  1634 infeasible   19      20687.6143 25309.4806  22.3%  6281 1500s
  2770  1738     cutoff   23      20687.6143 25165.7863  21.6%  6235 1522s
  2919  1853 22226.6529    6  119 20687.6143 25165.7863  21.6%  6211 1546s
  3099  1967 21706.7559    9  125 20687.6143 25165.7863  21.6%  6156 1574s
  3285  2058 21981.3133    7  158 20687.6143 25069.1090  21.2%  6102 1605s
  3451  2120 21012.4484   32  298 20687.6143 24695.5355  19.4%  6121 1632s
  3604  2171 23527.7496    8  277 20687.6143 24695.5355  19.4%  6163 1664s
  3741  2205 22414.8926   11  260 20687.6143 24695.5355  19.4%  6261 1694s
  3874  2220     cutoff   12      20687.6143 24497.3017  18.4%  6328 1726s
  3994  2254 21127.0388   25  344 20687.6143 24497.3017  18.4%  6395 1770s
  4101  2299 20833.5651   36  265 20687.6143 24497.3017  18.4%  6522 1804s
  4240  2348 23136.9116   10  231 20687.6143 24159.7568  16.8%  6591 1841s
  4377  2443 infeasible   12      20687.6143 24159.7568  16.8%  6577 1879s
  4602  2537 22088.1693   17  301 20687.6143 24159.7568  16.8%  6514 1927s
  4804  2581 21673.5525   27  299 20687.6143 23991.0838  16.0%  6499 1970s
  4992  2686 21281.1950   48  116 20687.6143 23991.0838  16.0%  6571 2013s
  5238  2687 20747.6211   65  357 20687.6143 23916.0424  15.6%  6591 2320s
  5240  2688 20902.0212   34  145 20687.6143 23916.0424  15.6%  6589 2333s
  5241  2689 21402.3202   22  322 20687.6143 23916.0424  15.6%  6587 2400s
  5242  2690 21535.8361   15  330 20687.6143 23916.0424  15.6%  6586 2450s
  5243  2690 21080.5612   26  349 20687.6143 23916.0424  15.6%  6585 2476s
  5244  2691 20873.3209   49  347 20687.6143 23916.0424  15.6%  6584 2493s
  5245  2692 21509.7931   18  355 20687.6143 23916.0424  15.6%  6582 2509s
  5246  2692 22811.2451    8  349 20687.6143 23916.0424  15.6%  6581 2521s
  5247  2693 23016.5219   13  353 20687.6143 23916.0424  15.6%  6580 2527s
  5248  2694 20998.9459   40  254 20687.6143 23916.0424  15.6%  6579 2542s
  5249  2694 21094.7109   42  354 20687.6143 23916.0424  15.6%  6577 2555s
  5250  2695 20975.3065   13  387 20687.6143 23916.0424  15.6%  6576 2578s
  5251  2696 20901.4275   25  361 20687.6143 23916.0424  15.6%  6575 2589s
  5252  2696 21741.5100   33  396 20687.6143 23916.0424  15.6%  6574 2597s
  5253  2697 21216.3646   12  345 20687.6143 23916.0424  15.6%  6572 2612s
  5254  2698 22270.6798   15  353 20687.6143 23916.0424  15.6%  6571 2617s
  5255  2698 22984.7102   14  352 20687.6143 23916.0424  15.6%  6570 2632s
  5256  2699 21110.0948    8  344 20687.6143 23916.0424  15.6%  6569 2638s
  5257  2700 21069.0785   52  349 20687.6143 23916.0424  15.6%  6567 2653s
  5258  2700 21300.7912   43  351 20687.6143 23916.0424  15.6%  6566 2659s
  5259  2701 23344.6169    8  347 20687.6143 23916.0424  15.6%  6565 2673s
  5260  2702 20858.3146   29  356 20687.6143 23916.0424  15.6%  6564 2677s
  5261  2702 21965.9003   16  356 20687.6143 23916.0424  15.6%  6562 2686s
  5262  2703 22804.1729   12  360 20687.6143 23916.0424  15.6%  6561 2690s
  5263  2704 21480.3392   24  355 20687.6143 23916.0424  15.6%  6560 2699s
  5264  2704 21798.8692   33  355 20687.6143 23916.0424  15.6%  6559 2727s
  5265  2705 21490.1692   26  355 20687.6143 23916.0424  15.6%  6557 2796s
  5266  2708 23916.0424   15  271 20687.6143 23916.0424  15.6%  6613 2824s
  5267  2709 23916.0424   16  254 20687.6143 23916.0424  15.6%  6613 2846s
  5269  2712 23916.0424   17  266 20687.6143 23916.0424  15.6%  6614 2863s
  5272  2719 23916.0424   18  267 20687.6143 23916.0424  15.6%  6615 2892s
  5280  2732 23916.0424   19  273 20687.6143 23916.0424  15.6%  6618 2914s
  5296  2743 23916.0424   18  289 20687.6143 23916.0424  15.6%  6648 2962s
  5312  2763 23916.0424   19  322 20687.6143 23916.0424  15.6%  6675 2993s
  5343  2808 23561.2571   20  268 20687.6143 23916.0424  15.6%  6682 3024s
  5446  2790 22448.2135   22  237 20687.6143 23916.0424  15.6%  6735 3059s
  5510  2765 22797.0117   22  269 20687.6143 23916.0424  15.6%  6711 3090s
  5548  2750 21853.8106   23  263 20687.6143 23916.0424  15.6%  6710 3113s
  5585  2741 23138.8065   21  175 20687.6143 23916.0424  15.6%  6716 3133s
  5630  2746 22450.8934   22  259 20687.6143 23916.0424  15.6%  6755 3154s
  5684  2754 22296.2570   23  268 20687.6143 23916.0424  15.6%  6776 3178s
  5781  2733 infeasible   24      20687.6143 23916.0424  15.6%  6767 3196s
  5842  2724 infeasible   24      20687.6143 23916.0424  15.6%  6767 3212s
  5924  2706 infeasible   23      20687.6143 23916.0424  15.6%  6744 3228s
  6006  2695 21605.3503   45  317 20687.6143 23916.0424  15.6%  6704 3244s
  6096  2665 infeasible   47      20687.6143 23916.0424  15.6%  6670 3259s
  6139  2645 infeasible   43      20687.6143 23916.0424  15.6%  6655 3274s
  6212  2627 21703.8708   21  245 20687.6143 23916.0424  15.6%  6622 3290s
  6302  2603 21397.2575   22  131 20687.6143 23916.0424  15.6%  6570 3306s
  6380  2587 infeasible   23      20687.6143 23916.0424  15.6%  6539 3322s
  6487  2547 infeasible   23      20687.6143 23916.0424  15.6%  6473 3338s
  6532  2546 21302.0001   21  227 20687.6143 23916.0424  15.6%  6472 3355s
  6645  2512 21180.6014   22  219 20687.6143 23916.0424  15.6%  6421 3373s
  6772  2519 20995.0029   23  246 20687.6143 23916.0424  15.6%  6365 3393s
  6928  2519 infeasible   24      20687.6143 23916.0424  15.6%  6294 3416s
  7112  2484 20782.7986   23  267 20687.6143 23916.0424  15.6%  6195 3434s
  7305  2422     cutoff   23      20687.6143 23916.0424  15.6%  6101 3454s
  7496  2359 21449.1251   26  347 20687.6143 23916.0424  15.6%  6019 3471s
  7570  2333 21447.2918   27  338 20687.6143 23916.0424  15.6%  5996 3491s
  7705  2303 infeasible   30      20687.6143 23916.0424  15.6%  5953 3510s
  7927  2258 20906.1808   65   80 20687.6143 23916.0424  15.6%  5850 3531s
  8218  2209 20702.4876   82   46 20687.6143 23916.0424  15.6%  5710 3574s
  8551  2096 21470.0972   47  309 20687.6143 23916.0424  15.6%  5556 3597s
  8879  2048 21382.3224   56   90 20687.6143 23916.0424  15.6%  5427 3600s

Cutting planes:
  Learned: 1
  Gomory: 35
  Implied bound: 49
  Projected implied bound: 91
  MIR: 1177
  Flow cover: 2601
  RLT: 15
  Relax-and-lift: 211

Explored 9020 nodes (48842439 simplex iterations) in 3600.05 seconds (9338.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20687.6 20674.3 20525.9 ... 20320.3

Time limit reached
Best objective 2.068761432777e+04, best bound 2.391604243660e+04, gap 15.6056%
  WARNING: Time limit reached. Using best solution found (gap: 15.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 20687.61, θ = 140472.30
  Upper Bound (UB) = 20687.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140472.30
  [DEBUG]   ✓ Scenario 0: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140472.30 ≤ Q = 140472.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140472.30 ≤ Q = 140472.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140472.30 ≤ Q = 140472.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140472.30 ≤ Q = 140472.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140472.30 ≤ Q = 140472.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140472.30 ≤ Q = 140472.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x36f9ed84
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc906127c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7501089.0379
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.359976e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135997.58    0  123 7501089.04 -135997.58   102%     -    0s
H    0     0                    -101114.8804 -135997.58  34.5%     -    0s
     0     0 -107262.88    0   82 -101114.88 -107262.88  6.08%     -    0s
H    0     0                    -104915.2689 -107156.37  2.14%     -    0s
H    0     0                    -105414.8209 -107156.37  1.65%     -    0s
     0     0 -106611.91    0   99 -105414.82 -106611.91  1.14%     -    0s
     0     0 -106596.00    0   99 -105414.82 -106596.00  1.12%     -    0s
     0     0 -106214.27    0  101 -105414.82 -106214.27  0.76%     -    0s
     0     0 -106208.12    0  103 -105414.82 -106208.12  0.75%     -    0s
     0     0 -105992.06    0  104 -105414.82 -105992.06  0.55%     -    0s
     0     0 -105991.56    0  104 -105414.82 -105991.56  0.55%     -    0s
     0     2 -105991.56    0  104 -105414.82 -105991.56  0.55%     -    0s
H  419    53                    -105453.2542 -105623.18  0.16%   7.4    0s
*  792    20              31    -105462.9829 -105532.75  0.07%   6.2    0s
*  799    20              32    -105463.7476 -105532.75  0.07%   6.2    0s

Cutting planes:
  Gomory: 36
  Implied bound: 9
  MIR: 188
  Flow cover: 15
  RLT: 3
  BQP: 2

Explored 854 nodes (5743 simplex iterations) in 0.11 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -105464 -105463 -105453 ... 1.43567e+13
No other solutions better than -105464

Optimal solution found (tolerance 1.00e-04)
Best objective -1.054637475613e+05, best bound -1.054637475613e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 138998.64
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105463.75
  [DEBUG]   S×d_nominal = 244462.39
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244462.39 + -105463.75 = 138998.64
  [DEBUG]   Current θ from Master = 140472.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1473.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19213.96
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 843.6775, Absolute Gap = 843.6775, Relative Gap = 0.040782
  Not converged yet (gap = 843.68 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740599 nonzeros
Model fingerprint: 0x859a9c60
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 115039 rows and 46699 columns
Presolve time: 2.53s
Presolved: 146274 rows, 61641 columns, 900486 nonzeros
Variable types: 59382 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 7.809e+06
 Factor NZ  : 1.811e+07 (roughly 230 MB of memory)
 Factor Ops : 5.884e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79699891e+07  2.45575215e+08  1.04e+05 1.88e+01  7.05e+04     4s
   1  -1.37849371e+07  2.12889115e+08  7.32e+04 5.72e+01  4.93e+04     4s
   2  -4.90317903e+06  1.53851203e+08  2.55e+04 2.40e+00  1.82e+04     4s
   3  -8.86265655e+05  1.09452267e+08  2.30e+03 1.89e+00  1.96e+03     5s
   4  -5.10930345e+05  4.75623667e+07  4.73e+02 3.02e-01  4.66e+02     5s
   5  -4.00532761e+05  3.13853499e+07  1.71e+02 1.73e-01  2.14e+02     5s
   6  -3.39066795e+05  2.44765318e+07  7.73e+01 1.29e-01  1.33e+02     5s
   7  -2.89592371e+05  1.84544544e+07  4.47e+01 9.13e-02  9.03e+01     5s
   8  -1.67322339e+05  1.27394245e+07  1.25e+01 6.26e-02  5.30e+01     5s
   9  -1.35922451e+05  1.07969434e+07  7.86e+00 5.23e-02  4.35e+01     5s
  10  -1.13040094e+05  6.95532360e+06  4.74e+00 3.25e-02  2.75e+01     5s
  11  -8.47273523e+04  2.51561081e+06  2.03e+00 1.12e-02  9.93e+00     5s
  12  -6.35953050e+04  1.03399510e+06  8.35e-01 4.51e-03  4.15e+00     5s
  13  -4.05633550e+04  5.31658880e+05  4.17e-01 2.38e-03  2.15e+00     5s
  14  -1.81950156e+04  2.70300758e+05  2.12e-01 1.14e-03  1.08e+00     5s
  15  -1.26719198e+04  2.26965798e+05  1.80e-01 8.98e-04  9.00e-01     5s
  16  -4.77353532e+03  1.53233892e+05  1.50e-01 1.04e-03  5.94e-01     5s
  17   1.31187708e+03  1.25625946e+05  1.26e-01 1.42e-03  4.67e-01     5s
  18   4.49881141e+03  9.74163136e+04  1.14e-01 1.22e-03  3.49e-01     6s
  19   1.06022516e+04  8.28865607e+04  9.15e-02 1.33e-03  2.72e-01     6s
  20   1.37418311e+04  7.59205947e+04  8.02e-02 1.43e-03  2.34e-01     6s
  21   1.72911004e+04  6.60467539e+04  6.79e-02 1.92e-03  1.83e-01     6s
  22   2.32347002e+04  6.20088658e+04  4.84e-02 1.85e-03  1.46e-01     6s
  23   2.54353735e+04  5.84577052e+04  4.16e-02 1.69e-03  1.24e-01     6s
  24   2.82859074e+04  5.38612703e+04  3.32e-02 1.71e-03  9.61e-02     6s
  25   3.04346319e+04  5.09921715e+04  2.74e-02 1.35e-03  7.73e-02     6s
  26   3.20253637e+04  4.81055820e+04  2.34e-02 9.93e-04  6.05e-02     6s
  27   3.49627723e+04  4.66900728e+04  1.61e-02 7.63e-04  4.41e-02     6s
  28   3.62203197e+04  4.56993916e+04  1.30e-02 6.03e-04  3.56e-02     6s
  29   3.76571144e+04  4.43561083e+04  9.39e-03 4.22e-04  2.52e-02     6s
  30   3.85298091e+04  4.40253676e+04  7.30e-03 3.70e-04  2.07e-02     6s
  31   3.86282508e+04  4.32121574e+04  7.08e-03 2.30e-04  1.72e-02     6s
  32   3.93635664e+04  4.28806496e+04  5.37e-03 1.68e-04  1.32e-02     7s
  33   4.02591087e+04  4.27119057e+04  3.31e-03 2.03e-04  9.22e-03     7s
  34   4.06598566e+04  4.23764838e+04  2.42e-03 1.44e-04  6.46e-03     7s
  35   4.10790320e+04  4.21711740e+04  1.50e-03 1.66e-04  4.11e-03     7s
  36   4.11489466e+04  4.20095350e+04  1.36e-03 8.02e-05  3.24e-03     7s
  37   4.14438766e+04  4.19523746e+04  7.38e-04 5.56e-05  1.91e-03     7s
  38   4.15117184e+04  4.18906317e+04  5.97e-04 3.32e-05  1.43e-03     7s
  39   4.15505877e+04  4.18690556e+04  5.16e-04 2.36e-05  1.20e-03     7s
  40   4.16688782e+04  4.18432629e+04  2.72e-04 1.73e-05  6.56e-04     7s
  41   4.16947939e+04  4.18256632e+04  2.21e-04 7.14e-06  4.92e-04     7s
  42   4.17207520e+04  4.18234539e+04  1.69e-04 6.05e-06  3.86e-04     7s
  43   4.17437827e+04  4.18210218e+04  1.25e-04 4.79e-06  2.91e-04     7s
  44   4.17580604e+04  4.18190425e+04  9.71e-05 3.77e-06  2.29e-04     8s
  45   4.17832366e+04  4.18158586e+04  4.76e-05 2.39e-06  1.23e-04     8s
  46   4.18026154e+04  4.18130712e+04  1.37e-05 1.11e-06  3.93e-05     8s
  47   4.18045575e+04  4.18108904e+04  1.04e-05 5.54e-08  2.38e-05     8s
  48   4.18065831e+04  4.18106721e+04  6.86e-06 4.47e-09  1.54e-05     8s
  49   4.18104510e+04  4.18105880e+04  8.47e-08 1.82e-09  5.15e-07     8s
  50   4.18105543e+04  4.18105547e+04  5.93e-09 2.19e-09  1.43e-09     8s

Barrier solved model in 50 iterations and 8.05 seconds (14.65 work units)
Optimal objective 4.18105543e+04


Root crossover log...

  129900 DPushes remaining with DInf 0.0000000e+00                 8s
   37451 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   20372 PPushes remaining with PInf 1.9381570e-04                14s
    6043 PPushes remaining with PInf 1.0981375e-04                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.8348561e+04     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   91458    4.1810555e+04   0.000000e+00   7.834856e+04     16s
   92360    4.1810555e+04   0.000000e+00   0.000000e+00     16s
   92360    4.1810555e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 4.13s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.181055e+04, 92360 iterations, 17.44 seconds (33.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41810.5547    0  188 -208513.72 41810.5547   120%     -   21s
H    0     0                    -146381.5893 41810.5547   129%     -   22s
H    0     0                    -143780.4781 41810.5547   129%     -   22s
H    0     0                    -101672.5214 41810.5547   141%     -   22s
H    0     0                    -44200.61439 41810.5547   195%     -   22s
H    0     0                    10661.156529 41810.5547   292%     -   22s
H    0     0                    13404.841786 41810.5547   212%     -   22s
H    0     0                    13491.214351 41810.5547   210%     -   23s
H    0     0                    15313.053195 41810.5547   173%     -   23s
H    0     0                    16002.000652 41810.5547   161%     -   23s
H    0     0                    16002.317368 41810.5547   161%     -   23s
H    0     0                    16087.173554 41810.5547   160%     -   23s
H    0     0                    16143.866950 41810.5547   159%     -   23s
H    0     0                    16169.304523 41810.5547   159%     -   23s
     0     0 37084.0728    0  219 16169.3045 37084.0728   129%     -   75s
     0     0 36231.2512    0  243 16169.3045 36231.2512   124%     -  101s
     0     0 36133.4232    0  242 16169.3045 36133.4232   123%     -  107s
     0     0 35946.7786    0  282 16169.3045 35946.7786   122%     -  118s
     0     0 35902.2292    0  290 16169.3045 35902.2292   122%     -  124s
     0     0 35601.0809    0  295 16169.3045 35601.0809   120%     -  136s
     0     0 35552.3026    0  296 16169.3045 35552.3026   120%     -  143s
     0     0 35535.7943    0  302 16169.3045 35535.7943   120%     -  151s
     0     0 35498.6732    0  295 16169.3045 35498.6732   120%     -  156s
     0     0 35496.3810    0  295 16169.3045 35496.3810   120%     -  157s
     0     0 35496.3669    0  298 16169.3045 35496.3669   120%     -  157s
     0     0 31606.2831    0  279 16169.3045 31606.2831  95.5%     -  204s
H    0     0                    19363.913814 31606.2253  63.2%     -  205s
H    0     0                    19411.305261 31606.2253  62.8%     -  205s
H    0     0                    19472.868589 31606.2253  62.3%     -  205s
H    0     0                    19478.296534 31606.2253  62.3%     -  205s
H    0     0                    19501.262417 31606.2253  62.1%     -  205s
     0     0 31156.1641    0  291 19501.2624 31156.1641  59.8%     -  226s
     0     0 31062.2541    0  337 19501.2624 31062.2541  59.3%     -  239s
     0     0 31037.1462    0  329 19501.2624 31037.1462  59.2%     -  244s
     0     0 31029.9668    0  330 19501.2624 31029.9668  59.1%     -  249s
     0     0 30963.0623    0  309 19501.2624 30963.0623  58.8%     -  260s
     0     0 30951.3740    0  303 19501.2624 30951.3740  58.7%     -  262s
     0     0 30895.7693    0  311 19501.2624 30895.7693  58.4%     -  265s
     0     0 30882.3315    0  311 19501.2624 30882.3315  58.4%     -  267s
     0     0 30842.0189    0  332 19501.2624 30842.0189  58.2%     -  273s
     0     0 30774.3732    0  336 19501.2624 30774.3732  57.8%     -  281s
     0     0 30757.0663    0  329 19501.2624 30757.0663  57.7%     -  286s
     0     0 30737.8701    0  335 19501.2624 30737.8701  57.6%     -  290s
     0     0 30734.6435    0  335 19501.2624 30734.6435  57.6%     -  293s
     0     0 30726.7565    0  335 19501.2624 30726.7565  57.6%     -  294s
     0     0 30724.2500    0  335 19501.2624 30724.2500  57.6%     -  295s
     0     0 30698.7647    0  338 19501.2624 30698.7647  57.4%     -  299s
     0     0 30697.6032    0  335 19501.2624 30697.6032  57.4%     -  301s
     0     0 29049.9072    0  347 19501.2624 29049.9072  49.0%     -  351s
H    0     0                    19620.833919 29049.8714  48.1%     -  352s
H    0     0                    19732.938622 29049.8714  47.2%     -  352s
     0     0 28707.0450    0  354 19732.9386 28707.0450  45.5%     -  368s
     0     0 28650.5761    0  353 19732.9386 28650.5761  45.2%     -  375s
     0     0 28580.6454    0  347 19732.9386 28580.6454  44.8%     -  384s
     0     0 28515.0120    0  347 19732.9386 28515.0120  44.5%     -  391s
     0     0 28493.5828    0  341 19732.9386 28493.5828  44.4%     -  394s
     0     0 28480.4344    0  337 19732.9386 28480.4344  44.3%     -  397s
     0     0 28474.4621    0  344 19732.9386 28474.4621  44.3%     -  400s
     0     0 28473.0139    0  345 19732.9386 28473.0139  44.3%     -  401s
     0     0 27674.7756    0  373 19732.9386 27674.7756  40.2%     -  432s
     0     0 27585.7836    0  376 19732.9386 27585.7836  39.8%     -  442s
     0     0 27565.4881    0  376 19732.9386 27565.4881  39.7%     -  445s
     0     0 27546.8003    0  364 19732.9386 27546.8003  39.6%     -  451s
     0     0 27535.2405    0  358 19732.9386 27535.2405  39.5%     -  454s
     0     0 27521.8058    0  375 19732.9386 27521.8058  39.5%     -  457s
     0     0 27481.1007    0  369 19732.9386 27481.1007  39.3%     -  466s
     0     0 27463.4412    0  364 19732.9386 27463.4412  39.2%     -  472s
     0     0 27453.8285    0  358 19732.9386 27453.8285  39.1%     -  475s
     0     0 27443.1911    0  368 19732.9386 27443.1911  39.1%     -  479s
     0     0 27440.1340    0  360 19732.9386 27440.1340  39.1%     -  482s
     0     0 27434.8982    0  423 19732.9386 27434.8982  39.0%     -  486s
     0     0 27434.3303    0  428 19732.9386 27434.3303  39.0%     -  488s
     0     0 27373.8265    0  399 19732.9386 27373.8265  38.7%     -  499s
     0     0 27367.7959    0  296 19732.9386 27367.7959  38.7%     -  503s
     0     0 27365.7532    0  353 19732.9386 27365.7532  38.7%     -  505s
     0     0 27364.3848    0  357 19732.9386 27364.3848  38.7%     -  508s
     0     0 27314.7882    0  339 19732.9386 27314.7882  38.4%     -  515s
H    0     0                    19990.227087 27314.5579  36.6%     -  516s
     0     0 27313.3151    0  334 19990.2271 27313.3151  36.6%     -  518s
     0     0 27293.3918    0  345 19990.2271 27293.3918  36.5%     -  524s
     0     0 27289.4029    0  350 19990.2271 27289.4029  36.5%     -  528s
     0     0 27288.2590    0  348 19990.2271 27288.2590  36.5%     -  528s
     0     0 27287.4701    0  338 19990.2271 27287.4701  36.5%     -  531s
H    0     0                    20000.161514 27286.6252  36.4%     -  532s
H    0     0                    20036.534882 27286.6252  36.2%     -  532s
H    0     0                    20044.023967 27286.6252  36.1%     -  532s
     0     0 27286.6252    0  342 20044.0240 27286.6252  36.1%     -  532s
     0     0 27286.3072    0  352 20044.0240 27286.3072  36.1%     -  534s
     0     0 27286.0933    0  351 20044.0240 27286.0933  36.1%     -  538s
     0     0 27285.8591    0  350 20044.0240 27285.8591  36.1%     -  541s
     0     0 27284.7022    0  350 20044.0240 27284.7022  36.1%     -  548s
H    0     0                    20203.144162 27284.7022  35.1%     -  601s
H    0     0                    20296.618268 27284.7022  34.4%     -  602s
H    0     2                    20311.648570 27284.7022  34.3%     -  605s
     0     2 27284.7022    0  350 20311.6486 27284.7022  34.3%     -  605s
     1     3 27057.2880    1  352 20311.6486 27281.1923  34.3% 12391  615s
     2     4 27029.4731    1  346 20311.6486 27057.2661  33.2% 11367  624s
     3     8 26202.2763    2  390 20311.6486 27057.2661  33.2% 11845  637s
     7    16 25774.8957    3  346 20311.6486 26682.0706  31.4% 11717  661s
    15    32 25189.7365    4  392 20311.6486 26290.1331  29.4% 12931  674s
    31    48 25208.6187    5  285 20311.6486 25742.3125  26.7% 16059 1779s
    47    80 22478.3883    6  163 20311.6486 25742.3125  26.7% 20386 1808s
H   48    80                    20342.674529 25742.3125  26.5% 19961 1808s
H   49    80                    20349.708149 25742.3125  26.5% 19821 1808s
H   56    80                    20417.582262 25742.3125  26.1% 19038 1808s
    79   153 22370.7829    7  160 20417.5823 25742.3125  26.1% 16259 1874s
   152   266 22097.3971   10  150 20417.5823 25742.3125  26.1% 10085 1899s
   274   338 20958.8772   15  106 20417.5823 25742.3125  26.1%  7961 1920s
   381   357 20942.2742   16   97 20417.5823 25742.3125  26.1%  7112 1936s
   414   380 20919.2920   17   90 20417.5823 25742.3125  26.1%  6993 1951s
H  418   380                    20440.737520 25742.3125  25.9%  6996 1951s
H  426   380                    20471.017672 25742.3125  25.8%  6980 1951s
   447   413 20784.1603   18   90 20471.0177 25742.3125  25.8%  6943 1970s
   501   434     cutoff   20      20471.0177 25742.3125  25.8%  7049 1985s
H  503   434                    20474.534424 25742.3125  25.7%  7033 1985s
H  506   434                    20557.231010 25742.3125  25.2%  7072 1985s
H  538   434                    20603.288528 25742.3125  24.9%  7153 1985s
   546   458 22781.0265   12  282 20603.2885 25742.3125  24.9%  7245 2001s
   607   480     cutoff   20      20603.2885 25742.3125  24.9%  7306 2016s
   663   490 20639.1019   13  227 20603.2885 25742.3125  24.9%  7249 2032s
   723   491     cutoff   15      20603.2885 25742.3125  24.9%  7186 2049s
   756   496 infeasible   12      20603.2885 25742.3125  24.9%  7199 2063s
   796   498 22028.6522   14  260 20603.2885 25742.3125  24.9%  7218 2081s
   852   526 21046.3140   13  357 20603.2885 25742.3125  24.9%  7164 2098s
   923   556 20812.8705   14  240 20603.2885 25742.3125  24.9%  7045 2115s
  1015   570 infeasible   15      20603.2885 25742.3125  24.9%  6751 2132s
  1100   590     cutoff   12      20603.2885 25742.3125  24.9%  6487 2149s
  1173   618 21069.6861   24  116 20603.2885 25742.3125  24.9%  6357 2167s
  1265   646 20770.0132   31  135 20603.2885 25742.3125  24.9%  6177 2186s
  1355   666 infeasible   10      20603.2885 25742.3125  24.9%  6000 2203s
  1411   683 infeasible   26      20603.2885 25742.3125  24.9%  5989 2220s
  1515   707 infeasible   10      20603.2885 25742.3125  24.9%  5851 2239s
  1595   718 21016.7607   15  251 20603.2885 25742.3125  24.9%  5877 2258s
  1638   742 20874.3618   16  240 20603.2885 25742.3125  24.9%  5978 2276s
  1673   768 20850.6771   17  165 20603.2885 25742.3125  24.9%  5990 2293s
  1723   800 20823.8156   18  117 20603.2885 25742.3125  24.9%  6008 2311s
  1803   822 20787.9849   19  126 20603.2885 25742.3125  24.9%  5960 2332s
  1889   859 20748.6042   20  147 20603.2885 25742.3125  24.9%  5930 2357s
  1975   868     cutoff   21      20603.2885 25742.3125  24.9%  5931 2386s
  2018   884 20805.5245   15  221 20603.2885 25742.3125  24.9%  5988 2409s
  2070   904 21944.0072   13  264 20603.2885 25742.3125  24.9%  6037 2439s
  2136   954 21603.6251   14  243 20603.2885 25742.3125  24.9%  6093 2462s
H 2188   954                    20653.562258 25742.3125  24.6%  6115 2462s
  2229  1014 21277.9950   16  242 20653.5623 25742.3125  24.6%  6135 2487s
  2416  1099 21002.2494   18  222 20653.5623 25742.3125  24.6%  6110 2516s
  2601  1139 infeasible   20      20653.5623 25742.3125  24.6%  6081 2544s
  2782  1194 infeasible   11      20653.5623 24991.2748  21.0%  6010 2576s
  2930  1281 22067.4365    7  250 20653.5623 24991.2748  21.0%  6062 2606s
  3102  1328     cutoff    9      20653.5623 24991.2748  21.0%  6070 2642s
  3289  1398 infeasible   10      20653.5623 24599.1817  19.1%  6083 2675s
  3474  1508 22048.0002   10  318 20653.5623 24599.1817  19.1%  6099 2707s
  3746  1624 20851.0897   13  238 20653.5623 24599.1817  19.1%  6015 2742s
  4069  1673 21108.0646   13  192 20653.5623 23885.9814  15.7%  5909 2784s
  4275  1812 20778.4630   16  295 20653.5623 23885.9814  15.7%  5918 2823s
  4564  1918 21488.0682   10  289 20653.5623 23885.9814  15.7%  5894 2860s
  4887  2024 20819.0929   14  224 20653.5623 23885.9814  15.7%  5804 2898s
  5192  2094 21518.3884   11  239 20653.5623 23607.3871  14.3%  5792 2936s
H 5199  2093                    20658.971227 23607.3871  14.3%  5788 2936s
  5399  2094 20731.2972   63  350 20658.9712 23607.3871  14.3%  5758 3149s
  5401  2095 21890.0634   13  147 20658.9712 23607.3871  14.3%  5756 3166s
  5402  2096 20877.8982   21  317 20658.9712 23607.3871  14.3%  5755 3226s
  5403  2097 20925.6928   31  281 20658.9712 23607.3871  14.3%  5754 3267s
  5404  2097 20879.8026   25  396 20658.9712 23607.3871  14.3%  5753 3296s
  5405  2098 21196.3482   19  363 20658.9712 23607.3871  14.3%  5752 3312s
  5406  2099 20937.9891   35  360 20658.9712 23607.3871  14.3%  5751 3327s
  5407  2099 22899.0613   11  352 20658.9712 23607.3871  14.3%  5750 3336s
  5408  2100 20896.7601   18  355 20658.9712 23607.3871  14.3%  5749 3342s
  5409  2101 20989.7794   28  340 20658.9712 23607.3871  14.3%  5748 3356s
  5410  2101 21103.5345   10  362 20658.9712 23607.3871  14.3%  5747 3366s
  5411  2102 21740.5900   13  352 20658.9712 23607.3871  14.3%  5746 3374s
  5412  2103 21311.8234   42  349 20658.9712 23607.3871  14.3%  5745 3391s
  5413  2103 20783.6335   25  348 20658.9712 23607.3871  14.3%  5744 3400s
  5415  2105 22369.0226   12  389 20658.9712 23607.3871  14.3%  5741 3421s
  5416  2105 20823.3087   26  345 20658.9712 23607.3871  14.3%  5740 3426s
  5417  2106 21162.9232   35  395 20658.9712 23607.3871  14.3%  5739 3433s
  5418  2107 21168.1571   22  395 20658.9712 23607.3871  14.3%  5738 3449s
  5419  2107 21702.5315   11  356 20658.9712 23607.3871  14.3%  5737 3454s
  5420  2108 23354.3883    9  356 20658.9712 23607.3871  14.3%  5736 3461s
  5421  2109 23354.3883    9  340 20658.9712 23607.3871  14.3%  5735 3473s
  5422  2109 20788.0281   28  344 20658.9712 23607.3871  14.3%  5734 3477s
  5423  2110 21136.6435   26  322 20658.9712 23607.3871  14.3%  5733 3491s
  5424  2111 21170.6377   17  384 20658.9712 23607.3871  14.3%  5732 3497s
  5425  2111 20754.5772   20  346 20658.9712 23607.3871  14.3%  5731 3515s
  5426  2112 21389.4384    8  405 20658.9712 23607.3871  14.3%  5730 3523s
  5427  2113 20790.3617   23  400 20658.9712 23607.3871  14.3%  5729 3531s
  5428  2113 21060.9867   13  414 20658.9712 23607.3871  14.3%  5728 3544s
  5429  2114 21971.5627   10  408 20658.9712 23607.3871  14.3%  5727 3551s
  5430  2115 21181.9850   17  406 20658.9712 23607.3871  14.3%  5726 3564s
  5431  2115 20943.2262   49  406 20658.9712 23607.3871  14.3%  5725 3580s

Cutting planes:
  Learned: 1
  Gomory: 21
  Implied bound: 7
  Projected implied bound: 203
  MIR: 664
  Flow cover: 805
  RLT: 10
  Relax-and-lift: 115

Explored 5431 nodes (31998159 simplex iterations) in 3600.03 seconds (8154.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20659 20653.6 20603.3 ... 20342.7

Time limit reached
Best objective 2.065897122699e+04, best bound 2.360738706366e+04, gap 14.2718%
  WARNING: Time limit reached. Using best solution found (gap: 14.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 20658.97, θ = 140591.07
  Upper Bound (UB) = 20658.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140591.07
  [DEBUG]   ✓ Scenario 0: θ = 140591.07 ≤ Q = 140591.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140591.07 ≤ Q = 140591.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140591.07 ≤ Q = 140591.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140591.07 ≤ Q = 140678.07 (slack: 87.00)
  [DEBUG]   ✓ Scenario 8: θ = 140591.07 ≤ Q = 140591.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140591.07 ≤ Q = 140591.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140591.07 ≤ Q = 140591.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140591.07 ≤ Q = 140591.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140591.07 ≤ Q = 140591.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5f5bc8ef
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa0a43711
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7496097.8613
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.359350e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135934.99    0  123 7496097.86 -135934.99   102%     -    0s
H    0     0                    -101013.6931 -135934.99  34.6%     -    0s
     0     0 -108804.92    0   80 -101013.69 -108804.92  7.71%     -    0s
H    0     0                    -105867.7943 -108694.73  2.67%     -    0s
H    0     0                    -106768.8946 -108694.73  1.80%     -    0s
     0     0 -107869.03    0   84 -106768.89 -107869.03  1.03%     -    0s
     0     0 -107846.63    0   84 -106768.89 -107846.63  1.01%     -    0s
     0     0 -107418.17    0   81 -106768.89 -107418.17  0.61%     -    0s
H    0     0                    -106787.2606 -107365.05  0.54%     -    0s
H    0     0                    -106797.7066 -107365.05  0.53%     -    0s
     0     0 -107365.05    0   78 -106797.71 -107365.05  0.53%     -    0s
     0     0 -107357.01    0   80 -106797.71 -107357.01  0.52%     -    0s
     0     0 -107056.05    0   54 -106797.71 -107056.05  0.24%     -    0s
     0     0 -106969.84    0   54 -106797.71 -106969.84  0.16%     -    0s
     0     0 -106959.56    0   60 -106797.71 -106959.56  0.15%     -    0s
     0     0 -106931.99    0   49 -106797.71 -106931.99  0.13%     -    0s
     0     0 -106926.56    0   49 -106797.71 -106926.56  0.12%     -    0s
H    0     0                    -106807.6908 -106926.56  0.11%     -    0s
     0     0 -106926.56    0   63 -106807.69 -106926.56  0.11%     -    0s
     0     0 -106926.56    0   63 -106807.69 -106926.56  0.11%     -    0s
     0     0 -106926.56    0   51 -106807.69 -106926.56  0.11%     -    0s
H    0     0                    -106844.6739 -106926.56  0.08%     -    0s
     0     0 -106926.56    0   41 -106844.67 -106926.56  0.08%     -    0s
     0     0 -106926.56    0   31 -106844.67 -106926.56  0.08%     -    0s
     0     0 -106908.90    0   13 -106844.67 -106908.90  0.06%     -    0s
     0     0 -106902.46    0   11 -106844.67 -106902.46  0.05%     -    0s
     0     0 -106888.60    0   10 -106844.67 -106888.60  0.04%     -    0s
     0     0 -106860.66    0    5 -106844.67 -106860.66  0.01%     -    0s

Explored 1 nodes (1084 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -106858 -106845 -106808 ... 1.43567e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.068578201903e+05, best bound -1.068606644330e+05, gap 0.0027%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 137731.41
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106857.82
  [DEBUG]   S×d_nominal = 244589.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244589.23 + -106857.82 = 137731.41
  [DEBUG]   Current θ from Master = 140591.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2859.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17799.32
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 815.0344, Absolute Gap = 815.0344, Relative Gap = 0.039452
  Not converged yet (gap = 815.03 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783839 nonzeros
Model fingerprint: 0x3d34cc5f
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 121806 rows and 49446 columns
Presolve time: 2.76s
Presolved: 154797 rows, 65134 columns, 953043 nonzeros
Variable types: 62875 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 8.672e+06
 Factor NZ  : 2.017e+07 (roughly 250 MB of memory)
 Factor Ops : 7.051e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79768982e+07  2.58368681e+08  1.04e+05 1.84e+01  7.02e+04     5s
   1  -1.38224731e+07  2.23721940e+08  7.33e+04 5.56e+01  4.91e+04     5s
   2  -4.92925169e+06  1.61598347e+08  2.56e+04 1.41e+00  1.82e+04     5s
   3  -9.21690155e+05  1.15110711e+08  2.49e+03 2.27e+00  2.07e+03     5s
   4  -5.14537766e+05  5.03693082e+07  4.77e+02 2.79e-01  4.68e+02     5s
   5  -4.04040514e+05  3.35225129e+07  1.70e+02 1.60e-01  2.15e+02     5s
   6  -3.46548189e+05  2.59188654e+07  7.99e+01 1.16e-01  1.34e+02     5s
   7  -2.97550717e+05  1.97872054e+07  4.57e+01 8.37e-02  9.15e+01     5s
   8  -1.77436208e+05  1.59722088e+07  1.18e+01 6.66e-02  6.19e+01     5s
   9  -1.30001309e+05  9.54966487e+06  4.99e+00 4.10e-02  3.56e+01     5s
  10  -1.08118791e+05  6.23046558e+06  2.89e+00 2.61e-02  2.30e+01     5s
  11  -9.00165846e+04  3.19190916e+06  1.67e+00 1.29e-02  1.18e+01     6s
  12  -8.05419714e+04  2.17514005e+06  1.24e+00 8.71e-03  8.08e+00     6s
  13  -5.73925605e+04  7.15727195e+05  6.01e-01 2.57e-03  2.76e+00     6s
  14  -2.23115079e+04  2.94255611e+05  2.48e-01 1.10e-03  1.13e+00     6s
  15  -1.21568223e+04  2.15096095e+05  1.92e-01 7.98e-04  8.07e-01     6s
  16  -7.41718795e+03  1.53347020e+05  1.72e-01 1.43e-03  5.71e-01     6s
  17  -1.05941209e+03  1.26096406e+05  1.47e-01 1.52e-03  4.52e-01     6s
  18   4.14400267e+03  1.13921820e+05  1.26e-01 1.50e-03  3.90e-01     6s
  19   1.16585420e+04  9.11118835e+04  9.43e-02 1.48e-03  2.82e-01     6s
  20   1.43220358e+04  7.55241596e+04  8.32e-02 1.54e-03  2.18e-01     6s
  21   1.84565218e+04  6.89865150e+04  6.78e-02 1.39e-03  1.80e-01     6s
  22   2.12224574e+04  6.20047660e+04  5.87e-02 1.43e-03  1.45e-01     6s
  23   2.42633566e+04  5.76504849e+04  4.87e-02 1.95e-03  1.19e-01     6s
  24   2.57190797e+04  5.26213950e+04  4.40e-02 2.00e-03  9.57e-02     6s
  25   2.77810947e+04  4.96810931e+04  3.79e-02 1.88e-03  7.79e-02     6s
  26   2.92910347e+04  4.85808212e+04  3.36e-02 1.64e-03  6.86e-02     7s
  27   3.30560395e+04  4.74264357e+04  2.30e-02 1.42e-03  5.11e-02     7s
  28   3.47207726e+04  4.54493505e+04  1.83e-02 9.47e-04  3.82e-02     7s
  29   3.49748391e+04  4.42893848e+04  1.76e-02 6.65e-04  3.32e-02     7s
  30   3.77429514e+04  4.34653928e+04  1.04e-02 4.67e-04  2.04e-02     7s
  31   3.88844834e+04  4.30109055e+04  7.44e-03 3.70e-04  1.47e-02     7s
  32   3.96031632e+04  4.25973804e+04  5.55e-03 2.33e-04  1.07e-02     7s
  33   4.02091176e+04  4.24185299e+04  3.97e-03 1.82e-04  7.86e-03     7s
  34   4.03554345e+04  4.23077498e+04  3.60e-03 1.49e-04  6.95e-03     7s
  35   4.06729713e+04  4.22127789e+04  2.79e-03 1.21e-04  5.48e-03     7s
  36   4.09390157e+04  4.21462997e+04  2.11e-03 1.09e-04  4.30e-03     7s
  37   4.11887617e+04  4.20246066e+04  1.49e-03 7.18e-05  2.97e-03     7s
  38   4.14906022e+04  4.19664843e+04  7.39e-04 5.30e-05  1.69e-03     7s
  39   4.15272069e+04  4.19091101e+04  6.51e-04 5.31e-05  1.36e-03     8s
  40   4.15737740e+04  4.18747355e+04  5.35e-04 3.34e-05  1.07e-03     8s
  41   4.16257275e+04  4.18650538e+04  4.10e-04 2.84e-05  8.52e-04     8s
  42   4.16981880e+04  4.18378232e+04  2.49e-04 2.07e-05  4.97e-04     8s
  43   4.17205998e+04  4.18311660e+04  1.96e-04 1.57e-05  3.93e-04     8s
  44   4.17519539e+04  4.18266244e+04  1.26e-04 1.21e-05  2.66e-04     8s
  45   4.17626864e+04  4.18195410e+04  1.03e-04 6.49e-06  2.02e-04     8s
  46   4.17710642e+04  4.18187604e+04  8.45e-05 5.96e-06  1.70e-04     8s
  47   4.17733326e+04  4.18174464e+04  7.93e-05 5.02e-06  1.57e-04     8s
  48   4.17899957e+04  4.18152444e+04  4.23e-05 3.34e-06  8.98e-05     8s
  49   4.18028105e+04  4.18147525e+04  1.59e-05 2.97e-06  4.24e-05     8s
  50   4.18065023e+04  4.18128310e+04  8.26e-06 1.54e-06  2.25e-05     8s
  51   4.18098304e+04  4.18124223e+04  7.98e-07 1.26e-06  9.19e-06     9s
  52   4.18101158e+04  4.18106145e+04  4.81e-07 2.28e-08  1.77e-06     9s
  53   4.18105167e+04  4.18105658e+04  9.22e-08 2.77e-09  1.75e-07     9s
  54   4.18105547e+04  4.18105547e+04  1.24e-09 2.84e-10  1.42e-10     9s

Barrier solved model in 54 iterations and 8.77 seconds (16.84 work units)
Optimal objective 4.18105547e+04


Root crossover log...

  137391 DPushes remaining with DInf 0.0000000e+00                 9s
   42207 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    3327 PPushes remaining with PInf 2.8785242e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.2278116e+00     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64879    4.1810555e+04   0.000000e+00   5.227812e+00     14s
   64881    4.1810555e+04   0.000000e+00   0.000000e+00     14s
   64881    4.1810555e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 3.75s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.181055e+04, 64881 iterations, 14.66 seconds (27.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41810.5547    0  188 -208513.72 41810.5547   120%     -   18s
H    0     0                    -115595.9400 41810.5547   136%     -   19s
H    0     0                    -114809.2722 41810.5547   136%     -   19s
H    0     0                    -44200.61439 41810.5547   195%     -   19s
H    0     0                    10613.170136 41810.5547   294%     -   20s
H    0     0                    13667.563770 41810.5547   206%     -   20s
H    0     0                    14598.527801 41810.5547   186%     -   20s
H    0     0                    16002.000652 41810.5547   161%     -   20s
H    0     0                    16041.561662 41810.5547   161%     -   21s
H    0     0                    16073.178225 41810.5547   160%     -   21s
H    0     0                    16078.523954 41810.5547   160%     -   21s
H    0     0                    16087.173554 41810.5547   160%     -   21s
H    0     0                    16101.449341 41810.5547   160%     -   21s
H    0     0                    16131.657761 41810.5547   159%     -   21s
     0     0 36596.0161    0  272 16131.6578 36596.0161   127%     -   60s
     0     0 36596.0161    0  272 16131.6578 36596.0161   127%     -   60s
H    0     0                    16256.692160 36595.7194   125%     -   61s
     0     0 36346.8239    0  266 16256.6922 36346.8239   124%     -   79s
     0     0 36141.6962    0  281 16256.6922 36141.6962   122%     -   93s
     0     0 35907.2529    0  280 16256.6922 35907.2529   121%     -  105s
     0     0 35880.0382    0  285 16256.6922 35880.0382   121%     -  110s
     0     0 35876.0995    0  286 16256.6922 35876.0995   121%     -  113s
     0     0 35874.8293    0  292 16256.6922 35874.8293   121%     -  114s
     0     0 35870.8029    0  286 16256.6922 35870.8029   121%     -  115s
     0     0 35867.8920    0  290 16256.6922 35867.8920   121%     -  118s
     0     0 35860.8526    0  291 16256.6922 35860.8526   121%     -  123s
     0     0 35856.2465    0  290 16256.6922 35856.2465   121%     -  124s
     0     0 35856.2465    0  290 16256.6922 35856.2465   121%     -  124s
     0     0 31989.6627    0  312 16256.6922 31989.6627  96.8%     -  168s
H    0     0                    18589.145011 31988.9907  72.1%     -  169s
H    0     0                    18756.188513 31988.9907  70.6%     -  169s
H    0     0                    19205.172765 31988.9907  66.6%     -  169s
H    0     0                    19274.549176 31988.9907  66.0%     -  169s
H    0     0                    19309.042765 31988.9907  65.7%     -  169s
H    0     0                    19675.171837 31988.9907  62.6%     -  174s
     0     0 31196.8991    0  306 19675.1718 31196.8991  58.6%     -  197s
     0     0 30829.5411    0  313 19675.1718 30829.5411  56.7%     -  217s
     0     0 30624.6225    0  305 19675.1718 30624.6225  55.7%     -  227s
     0     0 30436.7879    0  384 19675.1718 30436.7879  54.7%     -  238s
     0     0 30208.7327    0  399 19675.1718 30208.7327  53.5%     -  246s
     0     0 30204.1099    0  394 19675.1718 30204.1099  53.5%     -  251s
     0     0 30178.7370    0  401 19675.1718 30178.7370  53.4%     -  256s
     0     0 30170.9761    0  402 19675.1718 30170.9761  53.3%     -  259s
     0     0 30167.7727    0  402 19675.1718 30167.7727  53.3%     -  261s
     0     0 30166.8411    0  405 19675.1718 30166.8411  53.3%     -  263s
     0     0 28492.5034    0  340 19675.1718 28492.5034  44.8%     -  311s
H    0     0                    19741.727603 28492.1805  44.3%     -  312s
     0     0 28178.8283    0  347 19741.7276 28178.8283  42.7%     -  340s
     0     0 28092.2279    0  351 19741.7276 28092.2279  42.3%     -  354s
     0     0 28050.9163    0  346 19741.7276 28050.9163  42.1%     -  363s
     0     0 28035.7719    0  284 19741.7276 28035.7719  42.0%     -  370s
     0     0 28014.9891    0  362 19741.7276 28014.9891  41.9%     -  376s
     0     0 28008.7918    0  353 19741.7276 28008.7918  41.9%     -  380s
     0     0 28001.0400    0  349 19741.7276 28001.0400  41.8%     -  384s
     0     0 27999.8023    0  350 19741.7276 27999.8023  41.8%     -  386s
     0     0 27524.2287    0  336 19741.7276 27524.2287  39.4%     -  414s
H    0     0                    19756.551002 27523.1666  39.3%     -  416s
     0     0 27444.9417    0  341 19756.5510 27444.9417  38.9%     -  427s
     0     0 27424.5271    0  353 19756.5510 27424.5271  38.8%     -  431s
     0     0 27414.6975    0  349 19756.5510 27414.6975  38.8%     -  435s
     0     0 27402.4417    0  330 19756.5510 27402.4417  38.7%     -  437s
     0     0 27394.0515    0  328 19756.5510 27394.0515  38.7%     -  439s
     0     0 27392.2085    0  348 19756.5510 27392.2085  38.6%     -  441s
     0     0 27339.8375    0  342 19756.5510 27339.8375  38.4%     -  450s
     0     0 27331.3482    0  334 19756.5510 27331.3482  38.3%     -  455s
     0     0 27330.8184    0  340 19756.5510 27330.8184  38.3%     -  456s
     0     0 27289.7283    0  327 19756.5510 27289.7283  38.1%     -  467s
H    0     0                    19768.337243 27288.6074  38.0%     -  469s
H    0     0                    19772.730661 27288.6074  38.0%     -  470s
H    0     0                    19804.271380 27288.6074  37.8%     -  470s
H    0     0                    19915.282309 27288.6074  37.0%     -  470s
H    0     0                    19980.376418 27288.6074  36.6%     -  470s
     0     0 27279.3612    0  327 19980.3764 27279.3612  36.5%     -  475s
     0     0 27277.0024    0  339 19980.3764 27277.0024  36.5%     -  477s
     0     0 27273.9895    0  335 19980.3764 27273.9895  36.5%     -  480s
     0     0 27272.0673    0  334 19980.3764 27272.0673  36.5%     -  482s
     0     0 27246.8579    0  324 19980.3764 27246.8579  36.4%     -  494s
     0     0 27241.9934    0  325 19980.3764 27241.9934  36.3%     -  499s
     0     0 27240.6587    0  327 19980.3764 27240.6587  36.3%     -  500s
     0     0 27224.7167    0  337 19980.3764 27224.7167  36.3%     -  504s
H    0     0                    20303.135561 27220.2690  34.1%     -  506s
H    0     0                    20491.934221 27220.2690  32.8%     -  506s
H    0     0                    20518.495780 27220.2690  32.7%     -  506s
     0     0 27220.2690    0  335 20518.4958 27220.2690  32.7%     -  508s
     0     0 27220.2690    0  331 20518.4958 27220.2690  32.7%     -  510s
H    0     0                    20543.753566 27218.9737  32.5%     -  511s
     0     0 27218.9737    0  334 20543.7536 27218.9737  32.5%     -  513s
     0     0 27209.8139    0  331 20543.7536 27209.8139  32.4%     -  517s
H    0     0                    20574.048467 27209.7382  32.3%     -  519s
H    0     0                    20591.274695 27209.7382  32.1%     -  519s
     0     0 27209.6691    0  250 20591.2747 27209.6691  32.1%     -  519s
     0     0 27204.3532    0  342 20591.2747 27204.3532  32.1%     -  523s
     0     0 27204.0693    0  342 20591.2747 27204.0693  32.1%     -  530s
     0     2 27203.6709    0  342 20591.2747 27203.6709  32.1%     -  585s
     1     3 26683.2205    1  324 20591.2747 27201.0958  32.1% 14935  598s
     2     4 26893.7351    1  340 20591.2747 26893.7351  30.6% 12661  607s
     3     7 26591.1237    2  346 20591.2747 26891.6310  30.6% 11712  619s
     6    14 26410.4068    3  337 20591.2747 26831.6671  30.3% 11004  642s
    13    28 25632.8780    4  299 20591.2747 26718.9981  29.8% 12108  659s
    27    42 25242.2347    5  293 20591.2747 26143.8520  27.0% 17086  709s
    41    74 24540.8927    6  286 20591.2747 26143.8520  27.0% 20014  965s
H   45    74                    20602.562239 26143.8520  26.9% 19130  965s
H   56    74                    20610.762770 26143.8520  26.8% 17734  965s
    73   177 24423.8811    7  275 20610.7628 25810.6334  25.2% 20778 1004s
   176   265 23847.1559   10  282 20610.7628 25810.6334  25.2% 13808 1028s
   264   344 23655.2139    9  267 20610.7628 25810.6334  25.2% 11657 1046s
   343   376 23771.0806   11  283 20610.7628 25810.6334  25.2% 10540 1072s
   375   409 23564.4775   10  265 20610.7628 25810.6334  25.2% 10438 1113s
   408   446 23118.0291   11  276 20610.7628 25810.6334  25.2% 10546 1129s
   448   478 22887.0175   11  271 20610.7628 25810.6334  25.2% 10146 1144s
   494   507 23332.0337   12  272 20610.7628 25810.6334  25.2%  9777 1157s
H  509   507                    20631.940611 25810.6334  25.1%  9664 1157s
   539   553 22691.2088   12  236 20631.9406 25810.6334  25.1%  9520 1177s
   623   601 23251.6971   12  279 20631.9406 25810.6334  25.1%  9082 1194s
   718   625 23191.8444   13  279 20631.9406 25810.6334  25.1%  8524 1213s
   816   650 23084.8385   14  247 20631.9406 25810.6334  25.1%  8059 1229s
   903   681 22604.2752   16  214 20631.9406 25810.6334  25.1%  7599 1251s
   992   732 23098.7940   14  274 20631.9406 25810.6334  25.1%  7259 1272s
  1104   812 21676.5351   17  227 20631.9406 25810.6334  25.1%  6895 1288s
  1224   924 21288.8489   18  280 20631.9406 25810.6334  25.1%  6598 1304s
  1356   945 21229.9335   19  225 20631.9406 25810.6334  25.1%  6281 1320s
  1392   983     cutoff   20      20631.9406 25810.6334  25.1%  6310 1336s
  1465  1044     cutoff   20      20631.9406 25810.6334  25.1%  6160 1353s
  1585  1064 21156.4650   20  229 20631.9406 25810.6334  25.1%  5845 1369s
  1629  1085     cutoff   20      20631.9406 25810.6334  25.1%  5816 1387s
  1695  1110 23797.0997   10  353 20631.9406 25810.6334  25.1%  5743 1403s
  1765  1131 22933.8353   11  354 20631.9406 25656.3629  24.4%  5740 1424s
  1840  1155 21845.3456   12  329 20631.9406 25656.3629  24.4%  5737 1445s
  1932  1191 21732.2349   13  298 20631.9406 25656.3629  24.4%  5664 1466s
  2042  1212 20871.1416   16  300 20631.9406 25656.3629  24.4%  5666 1488s
  2143  1255 21778.4394   13  329 20631.9406 25619.5593  24.2%  5647 1510s
  2236  1308 21472.9670   15  299 20631.9406 25619.5593  24.2%  5737 1531s
  2355  1328     cutoff   20      20631.9406 25619.5593  24.2%  5746 1555s
  2513  1398 23326.3079    7  303 20631.9406 25619.5593  24.2%  5751 1580s
  2643  1451 20728.6777    9  191 20631.9406 25619.5593  24.2%  5838 1605s
  2809  1495 22806.4769    9  303 20631.9406 25619.5593  24.2%  5807 1631s
  2945  1605 21804.0377   12  301 20631.9406 25465.1373  23.4%  5861 1656s
  3099  1716 21242.0602   15  224 20631.9406 25465.1373  23.4%  5924 1684s
  3320  1838     cutoff   14      20631.9406 24582.3968  19.1%  5833 1711s
  3594  1898 24068.0304    6  346 20631.9406 24309.3336  17.8%  5681 1743s
  3835  1957 23331.2813    8  336 20631.9406 24294.8874  17.8%  5632 1776s
  4017  2009 22861.4002   10  333 20631.9406 24294.8874  17.8%  5686 1805s
  4257  2066 22639.2918   11  343 20631.9406 24181.7114  17.2%  5690 1837s
  4510  2117 22581.6156   12  325 20631.9406 24176.1728  17.2%  5673 1864s
  4681  2156 22062.2757   13  294 20631.9406 24176.1728  17.2%  5624 1902s
  4886  2182 21760.2334   14  293 20631.9406 24059.9400  16.6%  5638 1939s
  5090  2193 21465.4494   15  298 20631.9406 24054.6735  16.6%  5699 1975s
  5250  2271     cutoff   16      20631.9406 24054.6735  16.6%  5802 2013s
  5471  2313 20910.8420   28  210 20631.9406 24003.8609  16.3%  5819 2054s
  5789  2388 21259.1874   12  228 20631.9406 23903.4328  15.9%  5766 2100s
  6027  2420 21314.3684   15  260 20631.9406 23903.4328  15.9%  5814 2148s
  6306  2491 22296.5570    8  378 20631.9406 23810.9309  15.4%  5849 2194s
  6606  2503     cutoff   12      20631.9406 23810.9309  15.4%  5875 2236s
  6656  2512     cutoff   12      20631.9406 23810.9309  15.4%  5922 2272s
  6710  2517 21206.6950   13  364 20631.9406 23696.8235  14.9%  5949 2314s
  6769  2534 21070.1036   14  356 20631.9406 23682.1877  14.8%  5988 2356s
  6848  2555     cutoff   15      20631.9406 23654.5026  14.6%  5993 2400s
  6927  2577     cutoff    9      20631.9406 23636.1432  14.6%  6010 2445s
  7096  2635 22128.1948   15  312 20631.9406 23636.1432  14.6%  5992 2499s
  7327  2636 21167.0428   11  342 20631.9406 23614.2106  14.5%  5980 2681s
  7329  2637 21029.5480   13  148 20631.9406 23614.2106  14.5%  5978 2698s
  7330  2638 22494.5923   16  346 20631.9406 23614.2106  14.5%  5978 2775s
  7331  2639 22066.8940   11  330 20631.9406 23614.2106  14.5%  5977 2831s
  7332  2639 21214.1919   20  399 20631.9406 23614.2106  14.5%  5976 2894s
  7333  2640 21303.5134   23  350 20631.9406 23614.2106  14.5%  5975 2909s
  7334  2641 21229.0265   22  345 20631.9406 23614.2106  14.5%  5974 2922s
  7335  2641 21486.7111   32  345 20631.9406 23614.2106  14.5%  5973 2931s
  7336  2642 21013.4691   26  354 20631.9406 23614.2106  14.5%  5973 2943s
  7337  2643 20826.7044   20  349 20631.9406 23614.2106  14.5%  5972 2949s
  7338  2643 20855.7365   41  348 20631.9406 23614.2106  14.5%  5971 2956s
  7339  2644 20996.1024   12  283 20631.9406 23614.2106  14.5%  5970 2974s
  7340  2645 21967.1280    9  349 20631.9406 23614.2106  14.5%  5969 2981s
  7341  2645 20868.8387   45  303 20631.9406 23614.2106  14.5%  5969 2997s
  7342  2646 21417.2958   21  339 20631.9406 23614.2106  14.5%  5968 3004s
  7343  2647 22039.9138    9  336 20631.9406 23614.2106  14.5%  5967 3017s
  7344  2647 21279.7838   40  263 20631.9406 23614.2106  14.5%  5966 3023s
  7345  2648 20945.3988   32  344 20631.9406 23614.2106  14.5%  5965 3039s
  7346  2649 23065.0291   17  282 20631.9406 23614.2106  14.5%  5965 3045s
  7347  2649 23332.4608   10  365 20631.9406 23614.2106  14.5%  5964 3071s
  7348  2650 22610.6645   10  388 20631.9406 23614.2106  14.5%  5963 3080s
  7349  2651 20784.3802   37  395 20631.9406 23614.2106  14.5%  5962 3090s
  7350  2651 21523.0224   12  399 20631.9406 23614.2106  14.5%  5961 3096s
  7351  2652 21562.3260   10  352 20631.9406 23614.2106  14.5%  5960 3112s
  7352  2653 20732.8409   36  404 20631.9406 23614.2106  14.5%  5960 3123s
  7353  2653 21012.0736   19  360 20631.9406 23614.2106  14.5%  5959 3129s
  7354  2654 22249.7390   13  357 20631.9406 23614.2106  14.5%  5958 3137s
  7355  2655 20747.4531   17  373 20631.9406 23614.2106  14.5%  5957 3161s
  7356  2655 22180.3459    8  425 20631.9406 23614.2106  14.5%  5956 3171s
  7357  2656 20748.3706   24  378 20631.9406 23614.2106  14.5%  5956 3176s
  7358  2657 21155.9421   15  413 20631.9406 23614.2106  14.5%  5955 3190s
  7359  2657 21481.3967   35  412 20631.9406 23614.2106  14.5%  5954 3195s
  7360  2658 21637.1253    8  365 20631.9406 23614.2106  14.5%  5953 3217s
  7361  2659 21196.2838   19  358 20631.9406 23614.2106  14.5%  5952 3221s
  7362  2659 22740.9751   13  411 20631.9406 23614.2106  14.5%  5952 3228s
  7363  2660 21343.8617   18  422 20631.9406 23614.2106  14.5%  5951 3239s
  7364  2661 21930.6053   16  370 20631.9406 23614.2106  14.5%  5950 3245s
  7365  2661 21631.0539   23  417 20631.9406 23614.2106  14.5%  5949 3254s
  7366  2662 21634.8689   13  417 20631.9406 23614.2106  14.5%  5948 3275s
  7367  2663 21982.2695   13  417 20631.9406 23614.2106  14.5%  5948 3362s
  7368  2665 23614.2106   15  358 20631.9406 23614.2106  14.5%  6007 3377s
  7369  2667 23614.2106   16  357 20631.9406 23614.2106  14.5%  6007 3409s
  7371  2670 23614.2106   17  340 20631.9406 23614.2106  14.5%  6009 3438s
  7375  2678 23614.2106   18  354 20631.9406 23614.2106  14.5%  6015 3468s
  7384  2684 23614.2106   17  419 20631.9406 23614.2106  14.5%  6028 3511s
  7393  2704 23614.2106   19  304 20631.9406 23614.2106  14.5%  6036 3600s

Cutting planes:
  Learned: 1
  Gomory: 24
  Implied bound: 18
  Projected implied bound: 287
  MIR: 1120
  Mixing: 3
  Flow cover: 1891
  RLT: 24
  Relax-and-lift: 226

Explored 7416 nodes (45564340 simplex iterations) in 3600.09 seconds (9785.19 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20631.9 20610.8 20602.6 ... 19980.4

Time limit reached
Best objective 2.063194061103e+04, best bound 2.361421063524e+04, gap 14.4546%
  WARNING: Time limit reached. Using best solution found (gap: 14.45%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 20631.94, θ = 140517.50
  Upper Bound (UB) = 20631.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140517.50
  [DEBUG]   ✓ Scenario 0: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140517.50 ≤ Q = 140517.50 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1a7bb16f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1a7bb16f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.438343e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7498914.1409
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.359163e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135916.27    0  123 7498914.14 -135916.27   102%     -    0s
H    0     0                    -100995.4192 -135916.27  34.6%     -    0s
     0     0 -107838.35    0   83 -100995.42 -107838.35  6.78%     -    0s
H    0     0                    -104697.1622 -107836.53  3.00%     -    0s
H    0     0                    -105382.1033 -107836.53  2.33%     -    0s
     0     0 -107323.92    0   84 -105382.10 -107323.92  1.84%     -    0s
     0     0 -107294.09    0   80 -105382.10 -107294.09  1.81%     -    0s
     0     0 -107143.87    0   68 -105382.10 -107143.87  1.67%     -    0s
H    0     0                    -105808.0194 -107133.46  1.25%     -    0s
H    0     0                    -106409.1690 -107133.46  0.68%     -    0s
     0     0 -107114.15    0   75 -106409.17 -107114.15  0.66%     -    0s
     0     0 -107113.95    0   65 -106409.17 -107113.95  0.66%     -    0s
     0     0 -106927.96    0   20 -106409.17 -106927.96  0.49%     -    0s
H    0     0                    -106438.6838 -106920.90  0.45%     -    0s
     0     0 -106866.66    0   16 -106438.68 -106866.66  0.40%     -    0s
     0     0 -106848.25    0   16 -106438.68 -106848.25  0.38%     -    0s
H    0     0                    -106653.8860 -106848.25  0.18%     -    0s
     0     0 -106836.41    0   12 -106653.89 -106836.41  0.17%     -    0s
H    0     0                    -106679.3668 -106817.73  0.13%     -    0s
     0     0 -106817.73    0   14 -106679.37 -106817.73  0.13%     -    0s
     0     0 -106785.14    0   12 -106679.37 -106785.14  0.10%     -    0s
     0     0 -106784.45    0    7 -106679.37 -106784.45  0.10%     -    0s
     0     0 -106781.19    0    6 -106679.37 -106781.19  0.10%     -    0s
     0     0 -106764.55    0    2 -106679.37 -106764.55  0.08%     -    0s
     0     0 -106764.55    0   65 -106679.37 -106764.55  0.08%     -    0s
H    0     0                    -106706.6816 -106764.55  0.05%     -    0s
     0     0 -106762.96    0    3 -106706.68 -106762.96  0.05%     -    0s
H    0     0                    -106741.8635 -106760.57  0.02%     -    0s
     0     0 -106760.57    0    2 -106741.86 -106760.57  0.02%     -    0s
     0     0 -106760.44    0    3 -106741.86 -106760.44  0.02%     -    0s
H    0     0                    -106757.6147 -106760.44  0.00%     -    0s

Cutting planes:
  Gomory: 7
  MIR: 59
  Flow cover: 4
  Relax-and-lift: 1

Explored 1 nodes (826 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106758 -106742 -106707 ... -104697
No other solutions better than -106758

Optimal solution found (tolerance 1.00e-04)
Best objective -1.067576146693e+05, best bound -1.067576146693e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 137675.79
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106757.61
  [DEBUG]   S×d_nominal = 244433.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244433.41 + -106757.61 = 137675.79
  [DEBUG]   Current θ from Master = 140517.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2841.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17790.23
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 788.0038, Absolute Gap = 788.0038, Relative Gap = 0.038193
  Not converged yet (gap = 788.00 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827079 nonzeros
Model fingerprint: 0x4ddfc0dc
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 128573 rows and 52193 columns
Presolve time: 2.85s
Presolved: 163320 rows, 68627 columns, 1005513 nonzeros
Variable types: 66368 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.49s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 9.574e+06
 Factor NZ  : 2.128e+07 (roughly 270 MB of memory)
 Factor Ops : 5.582e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80550763e+07  2.70355525e+08  1.04e+05 1.79e+01  7.01e+04     5s
   1  -1.38212742e+07  2.33906402e+08  7.37e+04 5.47e+01  4.93e+04     5s
   2  -4.51415063e+06  1.82049361e+08  2.38e+04 3.77e-01  1.69e+04     5s
   3  -8.64321528e+05  1.30212194e+08  1.73e+03 1.28e+00  1.59e+03     5s
   4  -5.61117076e+05  4.43107509e+07  4.47e+02 2.34e-01  4.16e+02     5s
   5  -4.32101672e+05  3.15193957e+07  1.54e+02 1.47e-01  1.92e+02     5s
   6  -3.52795666e+05  2.44481059e+07  6.06e+01 1.07e-01  1.14e+02     5s
   7  -2.70036331e+05  1.93944503e+07  3.31e+01 8.07e-02  8.09e+01     5s
   8  -1.48828264e+05  1.36271400e+07  1.10e+01 5.36e-02  5.02e+01     6s
   9  -1.32933600e+05  9.35597251e+06  8.30e+00 3.57e-02  3.41e+01     6s
  10  -1.12108280e+05  4.69350945e+06  5.18e+00 1.68e-02  1.69e+01     6s
  11  -8.56187363e+04  2.12890210e+06  2.59e+00 7.23e-03  7.63e+00     6s
  12  -5.73830410e+04  9.08911351e+05  1.05e+00 3.02e-03  3.28e+00     6s
  13  -2.75737039e+04  3.37861285e+05  4.27e-01 1.37e-03  1.23e+00     6s
  14  -1.53653022e+04  2.54360579e+05  2.89e-01 1.02e-03  9.10e-01     6s
  15  -6.89893397e+03  1.99510896e+05  2.18e-01 9.64e-04  6.96e-01     6s
  16   1.57613107e+03  1.37248765e+05  1.64e-01 1.01e-03  4.58e-01     6s
  17   5.09053019e+03  1.18408404e+05  1.43e-01 9.71e-04  3.82e-01     6s
  18   8.45057017e+03  9.79092693e+04  1.25e-01 1.09e-03  3.02e-01     6s
  19   1.30609419e+04  8.74223235e+04  9.93e-02 1.16e-03  2.51e-01     6s
  20   1.55257488e+04  7.77302733e+04  8.80e-02 1.13e-03  2.10e-01     6s
  21   2.10752075e+04  7.02147284e+04  6.48e-02 1.39e-03  1.66e-01     6s
  22   2.35964640e+04  6.17647345e+04  5.49e-02 1.61e-03  1.29e-01     6s
  23   2.55997496e+04  5.88914880e+04  4.77e-02 1.37e-03  1.12e-01     6s
  24   2.83641745e+04  5.46137990e+04  3.80e-02 1.77e-03  8.85e-02     7s
  25   3.04422209e+04  5.13398755e+04  3.11e-02 2.30e-03  7.05e-02     7s
  26   3.20226097e+04  4.99094342e+04  2.65e-02 2.00e-03  6.03e-02     7s
  27   3.41561246e+04  4.76132482e+04  2.04e-02 1.57e-03  4.54e-02     7s
  28   3.64221145e+04  4.58939634e+04  1.40e-02 1.11e-03  3.19e-02     7s
  29   3.66908158e+04  4.45713095e+04  1.32e-02 7.80e-04  2.66e-02     7s
  30   3.88276572e+04  4.38086835e+04  7.55e-03 5.59e-04  1.68e-02     7s
  31   3.93638305e+04  4.33061470e+04  6.19e-03 4.10e-04  1.33e-02     7s
  32   3.98436762e+04  4.28981527e+04  4.93e-03 2.81e-04  1.03e-02     7s
  33   4.02897871e+04  4.25707481e+04  3.78e-03 2.39e-04  7.70e-03     7s
  34   4.09160688e+04  4.23846643e+04  2.25e-03 1.75e-04  4.95e-03     7s
  35   4.12047398e+04  4.21723880e+04  1.53e-03 1.53e-04  3.26e-03     8s
  36   4.13403090e+04  4.20252148e+04  1.20e-03 7.89e-05  2.31e-03     8s
  37   4.14912536e+04  4.19594014e+04  8.31e-04 4.68e-05  1.58e-03     8s
  38   4.16191679e+04  4.19003138e+04  5.38e-04 1.91e-05  9.49e-04     8s
  39   4.16262697e+04  4.18905857e+04  5.19e-04 1.51e-05  8.93e-04     8s
  40   4.17171580e+04  4.18740646e+04  3.04e-04 8.98e-06  5.30e-04     8s
  41   4.17982996e+04  4.18606991e+04  1.20e-04 2.90e-05  2.11e-04     8s
  42   4.18446098e+04  4.18552056e+04  1.61e-05 1.18e-05  3.57e-05     8s
  43   4.18533349e+04  4.18536718e+04  2.99e-07 1.58e-06  1.13e-06     8s
  44   4.18535828e+04  4.18535889e+04  4.40e-08 9.06e-08  2.04e-08     8s
  45   4.18535833e+04  4.18535833e+04  1.74e-08 1.17e-10  5.11e-11     8s

Barrier solved model in 45 iterations and 8.34 seconds (15.25 work units)
Optimal objective 4.18535833e+04


Root crossover log...

  144704 DPushes remaining with DInf 0.0000000e+00                 8s
   34185 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2429 PPushes remaining with PInf 9.9362452e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5618609e-10     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64440    4.1853583e+04   0.000000e+00   0.000000e+00     14s
   64440    4.1853583e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 2.19s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185358e+04, 64440 iterations, 12.32 seconds (24.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41853.5833    0  194 -208513.72 41853.5833   120%     -   16s
H    0     0                    -205016.2406 41853.5833   120%     -   16s
H    0     0                    -93292.94810 41853.5833   145%     -   17s
H    0     0                    -92962.82213 41853.5833   145%     -   17s
H    0     0                    -92284.76716 41853.5833   145%     -   17s
H    0     0                    -91221.13733 41853.5833   146%     -   17s
H    0     0                    -41554.87577 41853.5833   201%     -   17s
H    0     0                    10747.800822 41853.5833   289%     -   17s
H    0     0                    14473.611984 41853.5833   189%     -   18s
H    0     0                    15726.978484 41853.5833   166%     -   18s
H    0     0                    16002.000652 41853.5833   162%     -   18s
H    0     0                    16087.173554 41853.5833   160%     -   18s
H    0     0                    16131.657761 41853.5833   159%     -   18s
H    0     0                    16137.694507 41853.5833   159%     -   18s
     0     0 36500.2159    0  284 16137.6945 36500.2159   126%     -   60s
H    0     0                    16245.704644 36499.9687   125%     -   61s
     0     0 36128.3150    0  288 16245.7046 36128.3150   122%     -   81s
     0     0 35728.6935    0  292 16245.7046 35728.6935   120%     -   94s
     0     0 35624.5034    0  304 16245.7046 35624.5034   119%     -  101s
     0     0 35592.2726    0  306 16245.7046 35592.2726   119%     -  106s
     0     0 35589.5514    0  309 16245.7046 35589.5514   119%     -  108s
     0     0 35589.5288    0  309 16245.7046 35589.5288   119%     -  109s
     0     0 31940.1299    0  270 16245.7046 31940.1299  96.6%     -  149s
H    0     0                    19512.717185 31939.4509  63.7%     -  150s
H    0     0                    19589.698197 31939.4509  63.0%     -  150s
H    0     0                    19603.232898 31939.4509  62.9%     -  150s
H    0     0                    19615.677874 31939.4509  62.8%     -  151s
     0     0 31212.7021    0  318 19615.6779 31212.7021  59.1%     -  174s
     0     0 31044.3652    0  319 19615.6779 31044.3652  58.3%     -  182s
     0     0 30989.8603    0  270 19615.6779 30989.8603  58.0%     -  191s
     0     0 30906.3379    0  270 19615.6779 30906.3379  57.6%     -  203s
     0     0 30890.5307    0  275 19615.6779 30890.5307  57.5%     -  208s
     0     0 30889.5518    0  275 19615.6779 30889.5518  57.5%     -  212s
     0     0 29238.7447    0  280 19615.6779 29238.7447  49.1%     -  257s
     0     0 28775.5185    0  293 19615.6779 28775.5185  46.7%     -  281s
     0     0 28626.9880    0  301 19615.6779 28626.9880  45.9%     -  298s
     0     0 28471.8733    0  366 19615.6779 28471.8733  45.1%     -  308s
     0     0 28439.0564    0  319 19615.6779 28439.0564  45.0%     -  315s
     0     0 28359.4690    0  319 19615.6779 28359.4690  44.6%     -  324s
     0     0 28340.0555    0  294 19615.6779 28340.0555  44.5%     -  330s
     0     0 28318.9978    0  359 19615.6779 28318.9978  44.4%     -  337s
     0     0 28309.9556    0  362 19615.6779 28309.9556  44.3%     -  340s
     0     0 28289.1727    0  375 19615.6779 28289.1727  44.2%     -  345s
     0     0 28268.7217    0  364 19615.6779 28268.7217  44.1%     -  349s
     0     0 28266.9223    0  380 19615.6779 28266.9223  44.1%     -  352s
     0     0 28260.8205    0  369 19615.6779 28260.8205  44.1%     -  355s
     0     0 28258.5482    0  373 19615.6779 28258.5482  44.1%     -  357s
     0     0 28256.6686    0  376 19615.6779 28256.6686  44.1%     -  359s
     0     0 28246.2941    0  387 19615.6779 28246.2941  44.0%     -  362s
     0     0 28242.4772    0  386 19615.6779 28242.4772  44.0%     -  364s
     0     0 28235.5746    0  390 19615.6779 28235.5746  43.9%     -  364s
     0     0 28196.5778    0  387 19615.6779 28196.5778  43.7%     -  368s
     0     0 28192.0418    0  382 19615.6779 28192.0418  43.7%     -  370s
     0     0 28192.0418    0  382 19615.6779 28192.0418  43.7%     -  371s
     0     0 27566.7145    0  416 19615.6779 27566.7145  40.5%     -  400s
H    0     0                    19734.305985 27566.5231  39.7%     -  402s
H    0     0                    19750.057568 27566.5231  39.6%     -  402s
     0     0 27539.2142    0  404 19750.0576 27539.2142  39.4%     -  411s
     0     0 27535.2500    0  403 19750.0576 27535.2500  39.4%     -  413s
     0     0 27531.0211    0  403 19750.0576 27531.0211  39.4%     -  417s
     0     0 27530.0839    0  403 19750.0576 27530.0839  39.4%     -  417s
     0     0 27472.0765    0  400 19750.0576 27472.0765  39.1%     -  429s
     0     0 27463.4685    0  395 19750.0576 27463.4685  39.1%     -  433s
     0     0 27462.9072    0  401 19750.0576 27462.9072  39.1%     -  438s
     0     0 27461.7434    0  348 19750.0576 27461.7434  39.0%     -  440s
     0     0 27435.4976    0  337 19750.0576 27435.4976  38.9%     -  453s
H    0     0                    19773.435674 27433.4516  38.7%     -  456s
H    0     0                    19867.785820 27433.4516  38.1%     -  456s
H    0     0                    19968.497967 27433.4516  37.4%     -  456s
H    0     0                    20036.782262 27433.4516  36.9%     -  456s
H    0     0                    20057.020406 27433.4516  36.8%     -  456s
     0     0 27430.6336    0  406 20057.0204 27430.6336  36.8%     -  460s
     0     0 27429.7439    0  401 20057.0204 27429.7439  36.8%     -  462s
     0     0 27425.9380    0  391 20057.0204 27425.9380  36.7%     -  468s
     0     0 27425.6096    0  350 20057.0204 27425.6096  36.7%     -  470s
     0     0 27420.0143    0  395 20057.0204 27420.0143  36.7%     -  476s
     0     0 27418.6514    0  393 20057.0204 27418.6514  36.7%     -  481s
     0     0 27416.3795    0  397 20057.0204 27416.3795  36.7%     -  487s
     0     0 27415.9726    0  400 20057.0204 27415.9726  36.7%     -  491s
     0     0 27393.7158    0  390 20057.0204 27393.7158  36.6%     -  506s
H    0     0                    20084.509685 27392.6635  36.4%     -  508s
     0     0 27386.8355    0  397 20084.5097 27386.8355  36.4%     -  516s
     0     0 27386.4786    0  396 20084.5097 27386.4786  36.4%     -  518s
     0     0 27374.1918    0  402 20084.5097 27374.1918  36.3%     -  524s
     0     0 27372.6751    0  258 20084.5097 27372.6751  36.3%     -  526s
     0     0 27339.2926    0  331 20084.5097 27339.2926  36.1%     -  537s
     0     0 27332.0321    0  395 20084.5097 27332.0321  36.1%     -  563s
     0     0 27317.6132    0  325 20084.5097 27317.6132  36.0%     -  567s
     0     0 27316.7373    0  392 20084.5097 27316.7373  36.0%     -  570s
     0     0 27312.2647    0  387 20084.5097 27312.2647  36.0%     -  575s
     0     0 27310.6840    0  393 20084.5097 27310.6840  36.0%     -  577s
     0     0 27310.6840    0  393 20084.5097 27310.6840  36.0%     -  579s
     0     0 27310.6840    0  391 20084.5097 27310.6840  36.0%     -  580s
     0     0 27310.6840    0  389 20084.5097 27310.6840  36.0%     -  583s
     0     0 27310.6840    0  389 20084.5097 27310.6840  36.0%     -  584s
     0     0 27310.6840    0  389 20084.5097 27310.6840  36.0%     -  586s
     0     0 27310.6840    0  389 20084.5097 27310.6840  36.0%     -  595s
H    0     0                    20271.462164 27310.6840  34.7%     -  662s
H    0     2                    20279.165834 27310.6840  34.7%     -  684s
     0     2 27310.6840    0  389 20279.1658 27310.6840  34.7%     -  684s
     1     3 26784.3690    1  331 20279.1658 27310.6840  34.7% 13430  708s
     2     6 25506.0111    2  288 20279.1658 27310.6840  34.7% 17826  728s
     5    12 25230.0505    3  306 20279.1658 26952.5921  32.9% 12882  749s
    11    24 24416.7238    4  293 20279.1658 26526.8666  30.8% 14620  772s
    23    36 25327.6127    4  344 20279.1658 26232.7481  29.4% 21100 1448s
    35    66 24815.4000    5  354 20279.1658 26232.7481  29.4% 22240 1611s
H   38    66                    20380.676023 26232.7481  28.7% 21365 1611s
H   65   116                    20534.498502 25966.6335  26.5% 26110 1657s
H   67   116                    20568.473746 25966.4871  26.2% 26068 1657s
H   69   116                    20569.139755 25966.4871  26.2% 25550 1657s
H   94   116                    20581.160828 25966.4871  26.2% 21708 1657s
   115   215 24562.7687    7  345 20581.1608 25544.5281  24.1% 19660 1693s
   218   289 24462.6981    7  339 20581.1608 25544.0230  24.1% 13259 1720s
   322   319 22189.2164   10  246 20581.1608 25544.0230  24.1% 11381 1741s
   396   348 23811.3919    9  349 20581.1608 25544.0230  24.1% 10924 1762s
   469   360 22634.1092    9  243 20581.1608 25544.0230  24.1% 10475 1789s
   529   384 20772.9755    9  304 20581.1608 25544.0230  24.1% 10211 1810s
   601   423     cutoff   10      20581.1608 25544.0230  24.1%  9997 1828s
   683   471 21667.3636   33  170 20581.1608 25544.0230  24.1%  9461 1845s
   765   505 21350.1643   38  127 20581.1608 25544.0230  24.1%  8910 1863s
   853   555 21158.0089   43  119 20581.1608 25544.0230  24.1%  8535 1878s
   969   595 infeasible   49      20581.1608 25544.0230  24.1%  8028 1894s
  1089   592     cutoff   54      20581.1608 25544.0230  24.1%  7590 1911s
  1159   611 22344.9466    9  367 20581.1608 25544.0230  24.1%  7458 1928s
  1234   649 22168.1450   10  347 20581.1608 25544.0230  24.1%  7398 1945s
  1314   655 22055.5521   12  325 20581.1608 25544.0230  24.1%  7259 1963s
  1391   678 21975.1120   15  269 20581.1608 25544.0230  24.1%  7145 1981s
  1483   701 21895.9562   18  254 20581.1608 25544.0230  24.1%  7130 2001s
  1587   716 21602.8615   21  302 20581.1608 24585.7696  19.5%  7059 2020s
  1666   765 21380.2807   23  271 20581.1608 24585.7696  19.5%  7005 2042s
  1793   820 20810.1636   29  219 20581.1608 24585.7696  19.5%  6886 2063s
  1950   886 21222.2789   32  265 20581.1608 24585.7696  19.5%  6736 2086s
  2122   990 20940.9728   45  191 20581.1608 24585.7696  19.5%  6535 2109s
  2329  1007 20629.8642   56   93 20581.1608 24378.1279  18.4%  6291 2129s
  2377  1020     cutoff   57      20581.1608 24378.1279  18.4%  6337 2153s
H 2450  1020                    20584.764557 24378.1279  18.4%  6302 2153s
  2494  1114 21801.5322    9  308 20584.7646 24378.1279  18.4%  6265 2178s
  2683  1132 21633.6391   11  286 20584.7646 24378.1279  18.4%  6074 2203s
  2831  1212 21349.5710   14  258 20584.7646 23708.6716  15.2%  6042 2231s
  2992  1236 20960.8405   23  205 20584.7646 23708.6716  15.2%  6038 2264s
  3120  1291 20805.5986   26  197 20584.7646 23542.0862  14.4%  6052 2291s
  3245  1345 20790.7288   29  178 20584.7646 23542.0862  14.4%  6076 2320s
  3423  1399 21527.9033   18  308 20584.7646 23333.8830  13.4%  6062 2350s
H 3517  1399                    20585.067128 23333.8830  13.4%  6043 2350s
  3564  1512 21509.3311   19  222 20585.0671 23333.8830  13.4%  6055 2380s
  3775  1587 20948.3822   24  279 20585.0671 23333.8830  13.4%  6005 2413s
  3994  1624 21251.8999   24  137 20585.0671 23333.8830  13.4%  5973 2449s
  4165  1684 20909.7056   34  150 20585.0671 23333.8830  13.4%  5955 2487s
  4375  1709 21233.1200   12  301 20585.0671 23149.7701  12.5%  5940 2523s
  4565  1718 20823.7593   15  194 20585.0671 23149.7701  12.5%  5976 2558s
  4662  1742 infeasible   16      20585.0671 22968.8323  11.6%  6035 2595s
  4790  1759 infeasible    9      20585.0671 22841.5993  11.0%  6059 2634s
  4922  1784 21965.3916   14  278 20585.0671 22805.6991  10.8%  6138 2675s
  5029  1835 21789.9624   17  320 20585.0671 22714.0095  10.3%  6206 2715s
  5213  1940 21348.6871   27  217 20585.0671 22702.5841  10.3%  6229 2756s
  5479  2037 20824.3821   56  150 20585.0671 22639.4220  10.0%  6200 2800s
  5810  2081 infeasible   22      20585.0671 22594.5448  9.76%  6136 2847s
  6064  2094 infeasible   23      20585.0671 22557.1313  9.58%  6164 2890s
H 6086  2094                    20587.444046 22468.7366  9.14%  6173 2890s
  6157  2252 infeasible   29      20587.4440 22447.9277  9.04%  6198 2939s
  6606  2253 21498.0300   27  389 20587.4440 22422.1851  8.91%  6073 3138s
  6608  2254 20982.0899   31  151 20587.4440 22422.1851  8.91%  6072 3158s
  6609  2255 20990.9868   28  329 20587.4440 22422.1851  8.91%  6071 3248s
  6610  2256 20892.0497   17  277 20587.4440 22422.1851  8.91%  6070 3303s
  6611  2256 21351.8819    8  337 20587.4440 22422.1851  8.91%  6069 3344s
  6612  2257 21530.1868   16  342 20587.4440 22422.1851  8.91%  6068 3381s
  6613  2258 20964.7914   31  286 20587.4440 22422.1851  8.91%  6067 3392s
  6614  2258 21224.3153   14  341 20587.4440 22422.1851  8.91%  6066 3404s
  6615  2259 21055.1662   46  359 20587.4440 22422.1851  8.91%  6065 3429s
  6616  2260 20816.1720   16  390 20587.4440 22422.1851  8.91%  6064 3440s
  6617  2260 20728.0959   56  386 20587.4440 22422.1851  8.91%  6063 3452s
  6618  2261 20866.9861   12  415 20587.4440 22422.1851  8.91%  6062 3476s
  6619  2262 21150.7470   23  391 20587.4440 22422.1851  8.91%  6061 3494s
  6620  2262 20690.2627   26  433 20587.4440 22422.1851  8.91%  6061 3506s
  6621  2263 20691.4659   23  443 20587.4440 22422.1851  8.91%  6060 3535s
  6622  2264 22102.8200   12  435 20587.4440 22422.1851  8.91%  6059 3547s
  6623  2264 21118.2238   17  387 20587.4440 22422.1851  8.91%  6058 3562s
  6624  2265 20890.2826   28  388 20587.4440 22422.1851  8.91%  6057 3569s
  6625  2266 21136.6898   22  343 20587.4440 22422.1851  8.91%  6056 3592s

Cutting planes:
  Gomory: 23
  Implied bound: 2
  Projected implied bound: 174
  MIR: 840
  Mixing: 2
  Flow cover: 1257
  RLT: 15
  Relax-and-lift: 128

Explored 6625 nodes (41011416 simplex iterations) in 3600.06 seconds (8639.79 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20587.4 20585.1 20584.8 ... 20271.5

Time limit reached
Best objective 2.058744404599e+04, best bound 2.242218510653e+04, gap 8.9119%
  WARNING: Time limit reached. Using best solution found (gap: 8.91%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 20587.44, θ = 140712.52
  Upper Bound (UB) = 20587.44

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140712.52
  [DEBUG]   ✓ Scenario 0: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140712.52 ≤ Q = 140718.34 (slack: 5.82)
  [DEBUG]   ✓ Scenario 2: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140712.52 ≤ Q = 140712.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140712.52 ≤ Q = 140712.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140712.52 ≤ Q = 140712.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140712.52 ≤ Q = 140712.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140712.52 ≤ Q = 140712.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140712.52 ≤ Q = 140712.52 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x79ce8fb0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x79ce8fb0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7521347.7507
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.357837e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135783.68    0  123 7521347.75 -135783.68   102%     -    0s
H    0     0                    -100824.8350 -135783.68  34.7%     -    0s
     0     0 -109191.89    0   87 -100824.83 -109191.89  8.30%     -    0s
H    0     0                    -106804.4596 -109083.52  2.13%     -    0s
H    0     0                    -107241.8532 -109083.52  1.72%     -    0s
     0     0 -108401.07    0   90 -107241.85 -108401.07  1.08%     -    0s
     0     0 -108353.19    0   93 -107241.85 -108353.19  1.04%     -    0s
     0     0 -108347.12    0   95 -107241.85 -108347.12  1.03%     -    0s
     0     0 -108188.47    0   64 -107241.85 -108188.47  0.88%     -    0s
H    0     0                    -107281.0723 -108143.63  0.80%     -    0s
     0     0 -108143.63    0   79 -107281.07 -108143.63  0.80%     -    0s
     0     0 -108117.47    0   63 -107281.07 -108117.47  0.78%     -    0s
     0     0 -108117.28    0   63 -107281.07 -108117.28  0.78%     -    0s
     0     0 -108048.80    0   46 -107281.07 -108048.80  0.72%     -    0s
H    0     0                    -107399.9436 -108047.27  0.60%     -    0s
H    0     0                    -107596.2374 -108047.27  0.42%     -    0s
     0     0 -108018.95    0   39 -107596.24 -108018.95  0.39%     -    0s
H    0     0                    -107678.2641 -108018.76  0.32%     -    0s
H    0     0                    -107886.0775 -108018.76  0.12%     -    0s
H    0     0                    -107988.6211 -108012.70  0.02%     -    0s
     0     0 -108012.70    0    4 -107988.62 -108012.70  0.02%     -    0s
     0     0 -108005.86    0    4 -107988.62 -108005.86  0.02%     -    0s
     0     0 -108005.86    0    8 -107988.62 -108005.86  0.02%     -    0s
H    0     0                    -107994.9815 -108005.86  0.01%     -    0s
     0     0          -    0      -107994.98 -108003.97  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 3
  Flow cover: 1
  RLT: 3
  PSD: 1

Explored 1 nodes (721 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -107995 -107989 -107985 ... -107242

Optimal solution found (tolerance 1.00e-04)
Best objective -1.079949815450e+05, best bound -1.080039669445e+05, gap 0.0083%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 136589.64
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107994.98
  [DEBUG]   S×d_nominal = 244584.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244584.62 + -107994.98 = 136589.64
  [DEBUG]   Current θ from Master = 140712.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4122.88 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16464.57
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 743.5072, Absolute Gap = 743.5072, Relative Gap = 0.036115
  Not converged yet (gap = 743.51 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870319 nonzeros
Model fingerprint: 0x9ed0537c
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 135340 rows and 54940 columns
Presolve time: 3.19s
Presolved: 171843 rows, 72120 columns, 1057471 nonzeros
Variable types: 69861 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357058.9883
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.65s

Barrier statistics:
 Dense cols : 625
 AA' NZ     : 1.051e+07
 Factor NZ  : 2.297e+07 (roughly 300 MB of memory)
 Factor Ops : 5.981e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84306342e+07  2.81917006e+08  1.06e+05 1.75e+01  7.12e+04     7s
   1  -1.41388986e+07  2.44441484e+08  7.54e+04 5.56e+01  5.02e+04     7s
   2  -4.61364295e+06  1.91102578e+08  2.43e+04 6.44e-01  1.72e+04     7s
   3  -8.47881727e+05  1.38682750e+08  1.42e+03 1.39e+00  1.39e+03     7s
   4  -5.83585040e+05  4.81720446e+07  4.15e+02 1.94e-01  3.96e+02     7s
   5  -4.58463460e+05  3.28372966e+07  1.62e+02 1.11e-01  1.93e+02     7s
   6  -3.68884106e+05  2.58634041e+07  6.10e+01 8.25e-02  1.14e+02     7s
   7  -2.79318317e+05  1.98926610e+07  3.16e+01 6.05e-02  7.81e+01     7s
   8  -1.50893079e+05  1.33742790e+07  1.08e+01 3.84e-02  4.68e+01     7s
   9  -1.33931730e+05  9.85401827e+06  7.97e+00 2.76e-02  3.40e+01     7s
  10  -1.15737742e+05  5.67643016e+06  5.10e+00 1.53e-02  1.93e+01     7s
  11  -8.98496837e+04  3.30910400e+06  2.37e+00 8.56e-03  1.11e+01     7s
  12  -6.97457456e+04  1.17990995e+06  1.04e+00 2.95e-03  4.03e+00     8s
  13  -4.49239225e+04  4.64339700e+05  4.94e-01 1.26e-03  1.64e+00     8s
  14  -2.04322610e+04  2.68975993e+05  2.62e-01 7.21e-04  9.28e-01     8s
  15  -1.28475241e+04  2.21276507e+05  2.20e-01 8.97e-04  7.50e-01     8s
  16  -9.87896396e+03  1.43028630e+05  2.05e-01 1.22e-03  4.90e-01     8s
  17  -3.17531173e+03  1.23869476e+05  1.75e-01 1.05e-03  4.07e-01     8s
  18   5.64914652e+03  1.12056616e+05  1.35e-01 1.09e-03  3.41e-01     8s
  19   8.82714117e+03  9.16518598e+04  1.20e-01 9.69e-04  2.66e-01     8s
  20   1.26443231e+04  8.35692149e+04  1.03e-01 1.19e-03  2.27e-01     8s
  21   1.51492737e+04  6.85506180e+04  9.25e-02 1.32e-03  1.71e-01     8s
  22   2.00511211e+04  6.38525587e+04  7.27e-02 1.61e-03  1.41e-01     8s
  23   2.34432941e+04  6.07207379e+04  5.90e-02 1.36e-03  1.20e-01     8s
  24   2.51235937e+04  5.74574082e+04  5.27e-02 1.54e-03  1.04e-01     8s
  25   2.80113716e+04  5.38391081e+04  4.20e-02 1.82e-03  8.28e-02     8s
  26   2.90683349e+04  5.22374751e+04  3.84e-02 1.61e-03  7.43e-02     9s
  27   3.15279123e+04  5.01061554e+04  3.01e-02 1.56e-03  5.96e-02     9s
  28   3.24566430e+04  4.91187745e+04  2.71e-02 1.44e-03  5.34e-02     9s
  29   3.46504010e+04  4.82981274e+04  2.00e-02 1.14e-03  4.38e-02     9s
  30   3.59887171e+04  4.66003925e+04  1.59e-02 8.46e-04  3.40e-02     9s
  31   3.73586250e+04  4.54247045e+04  1.19e-02 6.03e-04  2.59e-02     9s
  32   3.80825452e+04  4.40549453e+04  9.87e-03 3.86e-04  1.92e-02     9s
  33   3.88530242e+04  4.32579438e+04  7.76e-03 2.42e-04  1.41e-02     9s
  34   3.91299184e+04  4.31215407e+04  7.02e-03 2.19e-04  1.28e-02     9s
  35   3.97869930e+04  4.28009911e+04  5.28e-03 1.66e-04  9.67e-03     9s
  36   4.02681858e+04  4.26834511e+04  3.98e-03 1.46e-04  7.75e-03    10s
  37   4.07883133e+04  4.23673851e+04  2.68e-03 8.81e-05  5.07e-03    10s
  38   4.10649432e+04  4.22625359e+04  1.95e-03 6.98e-05  3.84e-03    10s
  39   4.11527395e+04  4.21029022e+04  1.73e-03 4.21e-05  3.05e-03    10s
  40   4.13114972e+04  4.20309541e+04  1.32e-03 4.05e-05  2.31e-03    10s
  41   4.15236972e+04  4.19619308e+04  7.86e-04 2.69e-05  1.41e-03    10s
  42   4.16273242e+04  4.19083656e+04  5.39e-04 1.33e-05  9.02e-04    10s
  43   4.16330953e+04  4.18973388e+04  5.23e-04 1.91e-05  8.48e-04    10s
  44   4.17372452e+04  4.18772795e+04  2.68e-04 1.01e-05  4.50e-04    10s
  45   4.17904469e+04  4.18693692e+04  1.41e-04 6.43e-06  2.53e-04    11s
  46   4.18075047e+04  4.18585525e+04  1.01e-04 1.13e-05  1.64e-04    11s
  47   4.18252339e+04  4.18542629e+04  6.09e-05 6.16e-06  9.32e-05    11s
  48   4.18525394e+04  4.18540593e+04  1.79e-06 3.90e-06  4.87e-06    11s
  49   4.18535792e+04  4.18536380e+04  4.96e-09 4.65e-07  1.88e-07    11s
  50   4.18535833e+04  4.18535834e+04  2.00e-09 1.22e-09  2.96e-10    11s

Barrier solved model in 50 iterations and 10.92 seconds (18.71 work units)
Optimal objective 4.18535833e+04


Root crossover log...

  151994 DPushes remaining with DInf 0.0000000e+00                11s
    4266 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    3918 PPushes remaining with PInf 4.8792696e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.8758180e-02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70810    4.1853583e+04   0.000000e+00   6.875818e-02     17s
   70811    4.1853583e+04   0.000000e+00   0.000000e+00     17s
   70811    4.1853583e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 1.92s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185358e+04, 70811 iterations, 14.65 seconds (29.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41853.5833    0  194 -208513.72 41853.5833   120%     -   19s
H    0     0                    -127633.5315 41853.5833   133%     -   19s
H    0     0                    -119574.1647 41853.5833   135%     -   20s
H    0     0                    -40634.99258 41853.5833   203%     -   20s
H    0     0                    8966.9785279 41853.5833   367%     -   20s
H    0     0                    14864.007568 41853.5833   182%     -   20s
H    0     0                    16002.000652 41853.5833   162%     -   21s
H    0     0                    16087.173554 41853.5833   160%     -   21s
H    0     0                    16118.171001 41853.5833   160%     -   21s
H    0     0                    16131.657761 41853.5833   159%     -   21s
H    0     0                    16169.304523 41853.5833   159%     -   21s
     0     0 37271.7186    0  315 16169.3045 37271.7186   131%     -   60s
H    0     0                    16305.276991 37271.4938   129%     -   61s
     0     0 36205.7809    0  328 16305.2770 36205.7809   122%     -   84s
     0     0 36070.7607    0  330 16305.2770 36070.7607   121%     -   98s
     0     0 36058.1052    0  339 16305.2770 36058.1052   121%     -  101s
     0     0 36012.5463    0  339 16305.2770 36012.5463   121%     -  104s
     0     0 36009.4424    0  334 16305.2770 36009.4424   121%     -  107s
     0     0 35796.0180    0  336 16305.2770 35796.0180   120%     -  117s
     0     0 35774.2945    0  336 16305.2770 35774.2945   119%     -  121s
     0     0 35652.3672    0  335 16305.2770 35652.3672   119%     -  127s
     0     0 35628.8659    0  336 16305.2770 35628.8659   119%     -  133s
     0     0 35627.4532    0  338 16305.2770 35627.4532   119%     -  136s
     0     0 35623.0769    0  337 16305.2770 35623.0769   118%     -  138s
     0     0 35621.6735    0  342 16305.2770 35621.6735   118%     -  140s
     0     0 35616.7951    0  339 16305.2770 35616.7951   118%     -  143s
     0     0 35614.7882    0  341 16305.2770 35614.7882   118%     -  143s
     0     0 35611.9321    0  341 16305.2770 35611.9321   118%     -  144s
     0     0 35611.5104    0  342 16305.2770 35611.5104   118%     -  145s
     0     0 31845.6626    0  287 16305.2770 31845.6626  95.3%     -  186s
H    0     0                    19841.198138 31845.6437  60.5%     -  187s
H    0     0                    19844.588067 31845.6437  60.5%     -  187s
H    0     0                    19876.075120 31845.6437  60.2%     -  187s
     0     0 31201.0737    0  319 19876.0751 31201.0737  57.0%     -  208s
     0     0 30995.4295    0  322 19876.0751 30995.4295  55.9%     -  220s
     0     0 30682.0088    0  321 19876.0751 30682.0088  54.4%     -  234s
     0     0 30634.1339    0  254 19876.0751 30634.1339  54.1%     -  247s
     0     0 30542.3482    0  256 19876.0751 30542.3482  53.7%     -  259s
     0     0 30488.5040    0  261 19876.0751 30488.5040  53.4%     -  265s
     0     0 30429.3647    0  260 19876.0751 30429.3647  53.1%     -  275s
     0     0 30424.0972    0  262 19876.0751 30424.0972  53.1%     -  278s
     0     0 30416.5973    0  262 19876.0751 30416.5973  53.0%     -  282s
     0     0 30349.6752    0  265 19876.0751 30349.6752  52.7%     -  298s
     0     0 30296.4752    0  268 19876.0751 30296.4752  52.4%     -  308s
     0     0 30294.1278    0  267 19876.0751 30294.1278  52.4%     -  310s
     0     0 30293.2658    0  265 19876.0751 30293.2658  52.4%     -  311s
     0     0 28811.2650    0  319 19876.0751 28811.2650  45.0%     -  360s
     0     0 28414.2113    0  265 19876.0751 28414.2113  43.0%     -  388s
     0     0 28346.0321    0  346 19876.0751 28346.0321  42.6%     -  402s
     0     0 28291.0040    0  357 19876.0751 28291.0040  42.3%     -  413s
     0     0 28233.5922    0  341 19876.0751 28233.5922  42.0%     -  421s
     0     0 28180.3322    0  341 19876.0751 28180.3322  41.8%     -  428s
     0     0 28143.8900    0  347 19876.0751 28143.8900  41.6%     -  435s
     0     0 28129.3842    0  344 19876.0751 28129.3842  41.5%     -  438s
     0     0 28025.6857    0  347 19876.0751 28025.6857  41.0%     -  446s
     0     0 28015.9699    0  350 19876.0751 28015.9699  41.0%     -  451s
     0     0 28012.6776    0  352 19876.0751 28012.6776  40.9%     -  454s
     0     0 28012.0845    0  352 19876.0751 28012.0845  40.9%     -  455s
     0     0 27681.0478    0  297 19876.0751 27681.0478  39.3%     -  480s
     0     0 27619.3539    0  298 19876.0751 27619.3539  39.0%     -  491s
     0     0 27601.6629    0  306 19876.0751 27601.6629  38.9%     -  495s
     0     0 27597.8336    0  307 19876.0751 27597.8336  38.8%     -  496s
     0     0 27590.7414    0  299 19876.0751 27590.7414  38.8%     -  501s
     0     0 27587.2125    0  300 19876.0751 27587.2125  38.8%     -  503s
     0     0 27585.2952    0  301 19876.0751 27585.2952  38.8%     -  504s
     0     0 27585.0998    0  303 19876.0751 27585.0998  38.8%     -  505s
     0     0 27540.7226    0  339 19876.0751 27540.7226  38.6%     -  512s
     0     0 27527.3553    0  292 19876.0751 27527.3553  38.5%     -  516s
     0     0 27525.3306    0  344 19876.0751 27525.3306  38.5%     -  519s
     0     0 27522.9057    0  339 19876.0751 27522.9057  38.5%     -  522s
     0     0 27522.7840    0  338 19876.0751 27522.7840  38.5%     -  523s
     0     0 27429.5100    0  382 19876.0751 27429.5100  38.0%     -  533s
H    0     0                    20041.042115 27429.2458  36.9%     -  535s
H    0     0                    20145.685861 27429.2458  36.2%     -  535s
H    0     0                    20151.772704 27429.2458  36.1%     -  535s
     0     0 27390.5677    0  327 20151.7727 27390.5677  35.9%     -  547s
     0     0 27383.5358    0  391 20151.7727 27383.5358  35.9%     -  553s
     0     0 27376.7051    0  390 20151.7727 27376.7051  35.9%     -  558s
     0     0 27376.1151    0  390 20151.7727 27376.1151  35.8%     -  560s
     0     0 27331.2306    0  325 20151.7727 27331.2306  35.6%     -  569s
H    0     0                    20324.054730 27331.0323  34.5%     -  570s
     0     0 27328.7370    0  333 20324.0547 27328.7370  34.5%     -  572s
     0     0 27327.7291    0  333 20324.0547 27327.7291  34.5%     -  575s
     0     0 27316.4936    0  321 20324.0547 27316.4936  34.4%     -  582s
H    0     0                    20341.358040 27316.0904  34.3%     -  583s
     0     0 27315.0421    0  236 20341.3580 27315.0421  34.3%     -  584s
     0     0 27309.9564    0  379 20341.3580 27309.9564  34.3%     -  591s
     0     0 27307.2441    0  316 20341.3580 27307.2441  34.2%     -  596s
     0     0 27307.1221    0  325 20341.3580 27307.1221  34.2%     -  597s
     0     0 27306.1466    0  378 20341.3580 27306.1466  34.2%     -  601s
     0     0 27306.0654    0  378 20341.3580 27306.0654  34.2%     -  612s
H    0     0                    20350.343212 27306.0654  34.2%     -  682s
     0     2 27306.0654    0  378 20350.3432 27306.0654  34.2%     -  683s
     1     3 26658.3568    1  254 20350.3432 27305.8776  34.2% 14764  700s
     2     4 26960.0196    1  379 20350.3432 26960.0196  32.5% 14426  715s
     3     8 26163.5001    2  269 20350.3432 26959.7592  32.5% 13757  728s
     7    16 25824.2388    3  257 20350.3432 26749.2384  31.4% 12289  763s
    15    32 25292.0167    4  251 20350.3432 26426.3765  29.9% 12371  781s
    31    48 25954.3955    5  341 20350.3432 26231.3302  28.9% 15197  815s
    47    77 25272.7221    6  341 20350.3432 26231.3302  28.9% 16565  838s
H   54    77                    20521.729213 26231.3302  27.8% 15878  838s
    78   175 24498.9516    7  322 20521.7292 26231.3302  27.8% 13588  862s
   195   190 23702.4712    8  260 20521.7292 26231.3302  27.8%  9342  875s
H  236   207                    20556.471081 26231.3302  27.6%  8919  890s
   277   234 23234.3493   11  288 20556.4711 26231.3302  27.6%  8596  905s
   349   235     cutoff   13      20556.4711 26231.3302  27.6%  7949  922s
   403   236 23363.7577   11  245 20556.4711 26231.3302  27.6%  7836  936s
   436   238 22121.9715   10  223 20556.4711 26231.3302  27.6%  7768  952s
   469   243 22458.5946    9  252 20556.4711 26231.3302  27.6%  7691  969s
   499   280 22406.2725   10  244 20556.4711 26231.3302  27.6%  7730  984s
   556   332 21742.5871   12  202 20556.4711 26231.3302  27.6%  7649  998s
   637   379 21456.1717   15  287 20556.4711 26231.3302  27.6%  7259 1011s
   722   405 20953.5645   18  278 20556.4711 26231.3302  27.6%  6909 1024s
   807   419 infeasible   23      20556.4711 26231.3302  27.6%  6557 1036s
   867   456 infeasible   23      20556.4711 26231.3302  27.6%  6380 1049s
   955   469 21839.9871   15  218 20556.4711 26231.3302  27.6%  6156 1062s
  1014   466 21769.3014   16  200 20556.4711 26231.3302  27.6%  6034 1076s
  1065   479 21208.9485   17  204 20556.4711 26231.3302  27.6%  6043 1100s
  1138   474 infeasible   22      20556.4711 26231.3302  27.6%  5943 1115s
  1201   486     cutoff   17      20556.4711 26231.3302  27.6%  5894 1130s
  1273   494 21087.0141   17  217 20556.4711 26231.3302  27.6%  5838 1144s
  1320   504 infeasible   18      20556.4711 26231.3302  27.6%  5846 1160s
  1388   512 22069.6506   10  437 20556.4711 26231.3302  27.6%  5890 1176s
  1451   528 21572.4942   12  246 20556.4711 26231.3302  27.6%  5926 1195s
  1504   542 21305.4508   10  257 20556.4711 26063.9655  26.8%  6045 1213s
  1568   545 infeasible   11      20556.4711 26063.9655  26.8%  6076 1231s
  1607   564 21593.2432   17  167 20556.4711 26063.9655  26.8%  6138 1249s
  1670   581     cutoff   19      20556.4711 26063.9655  26.8%  6174 1268s
  1725   590 20935.4706   21  257 20556.4711 26063.9655  26.8%  6229 1287s
  1799   593     cutoff   26      20556.4711 26063.9655  26.8%  6293 1307s
  1877   634 22049.6520   11  211 20556.4711 26063.9655  26.8%  6327 1328s
  1970   694 21483.9284   12  196 20556.4711 26063.9655  26.8%  6377 1348s
  2074   726 infeasible   16      20556.4711 26063.9655  26.8%  6368 1372s
  2161   796 21861.5989   10  354 20556.4711 26063.9655  26.8%  6375 1393s
  2328   872 21776.7378   11  344 20556.4711 26063.9655  26.8%  6261 1419s
  2476   882 infeasible   13      20556.4711 26063.9655  26.8%  6187 1446s
  2587   885 21693.3138   21  170 20556.4711 26063.9655  26.8%  6176 1473s
  2675   948 21497.5324   25   87 20556.4711 26063.9655  26.8%  6263 1501s
  2834  1018 21133.9110   41  129 20556.4711 24866.3756  21.0%  6264 1528s
  3040  1071 infeasible   54      20556.4711 24072.5945  17.1%  6160 1557s
  3254  1065     cutoff    8      20556.4711 24072.5945  17.1%  6088 1588s
  3362  1071 22057.1109    7  345 20556.4711 23879.5565  16.2%  6184 1617s
  3479  1091 21077.8297    9  244 20556.4711 23879.5565  16.2%  6308 1650s
  3607  1165 20808.6717   10  243 20556.4711 23879.5565  16.2%  6380 1683s
  3798  1284 20867.9358   21  142 20556.4711 23345.2645  13.6%  6387 1718s
  4095  1385 22635.0054    9  359 20556.4711 22915.2197  11.5%  6259 1750s
H 4177  1385                    20560.058555 22915.2197  11.5%  6197 1750s
  4429  1383 21918.6672   10  364 20560.0586 22915.2197  11.5%  6025 1790s
  4674  1388 21609.6551   11  288 20560.0586 22915.2197  11.5%  6007 1828s
H 4686  1388                    20566.355543 22915.2197  11.4%  6014 1828s
H 4718  1388                    20581.236396 22915.2197  11.3%  6022 1828s
  4883  1500 infeasible   14      20581.2364 22915.2197  11.3%  6041 1865s
H 5118  1500                    20593.036619 22915.2197  11.3%  5949 1865s
  5268  1721 21599.2194   22  104 20593.0366 22915.2197  11.3%  5915 1903s
  5789  1711 20678.2908   37  378 20593.0366 22915.2197  11.3%  5660 2100s
  5791  1712 21191.4414   49  147 20593.0366 22915.2197  11.3%  5658 2121s
  5792  1713 20607.4386   58  342 20593.0366 22915.2197  11.3%  5657 2209s
  5793  1714 20815.7228   21  286 20593.0366 22915.2197  11.3%  5656 2271s
  5794  1714 20675.8046   13  331 20593.0366 22915.2197  11.3%  5655 2301s
  5795  1715 21054.1985   17  371 20593.0366 22915.2197  11.3%  5654 2323s
  5796  1716 21085.7806   10  350 20593.0366 22915.2197  11.3%  5653 2343s
  5797  1716 20998.2140   39  294 20593.0366 22915.2197  11.3%  5652 2363s
  5798  1717 20713.3276   19  348 20593.0366 22915.2197  11.3%  5651 2378s
  5799  1718 21747.1134   12  275 20593.0366 22915.2197  11.3%  5650 2392s
  5800  1718 20877.7786   25  329 20593.0366 22915.2197  11.3%  5649 2398s
  5801  1719 20812.8260   43  280 20593.0366 22915.2197  11.3%  5648 2408s
  5802  1720 21011.5008   22  340 20593.0366 22915.2197  11.3%  5647 2419s
  5803  1720 20926.7881   18  341 20593.0366 22915.2197  11.3%  5646 2425s
  5804  1721 21418.5420   13  335 20593.0366 22915.2197  11.3%  5645 2445s
  5805  1722 21707.6268   30  292 20593.0366 22915.2197  11.3%  5644 2456s
  5806  1722 20886.3178   19  387 20593.0366 22915.2197  11.3%  5643 2483s
  5807  1723 20708.9116   58  392 20593.0366 22915.2197  11.3%  5642 2493s
  5808  1724 21246.4323   10  340 20593.0366 22915.2197  11.3%  5641 2502s
  5809  1724 20938.1031   27  364 20593.0366 22915.2197  11.3%  5640 2531s
  5810  1725 20878.1883   48  317 20593.0366 22915.2197  11.3%  5639 2541s
  5811  1726 21212.0143   41  289 20593.0366 22915.2197  11.3%  5638 2551s
  5812  1726 21019.5315   25  290 20593.0366 22915.2197  11.3%  5637 2559s
  5813  1727 20661.6460   54  427 20593.0366 22915.2197  11.3%  5636 2584s
  5814  1728 20613.3176   59  384 20593.0366 22915.2197  11.3%  5635 2595s
  5815  1728 21496.9356   11  420 20593.0366 22915.2197  11.3%  5635 2607s
  5816  1729 21060.9710   15  378 20593.0366 22915.2197  11.3%  5634 2624s
  5817  1730 20728.6999   53  437 20593.0366 22915.2197  11.3%  5633 2634s
  5818  1730 20825.3060   17  319 20593.0366 22915.2197  11.3%  5632 2650s
  5819  1731 21538.8917   30  393 20593.0366 22915.2197  11.3%  5631 2659s
  5820  1732 21291.3209   13  392 20593.0366 22915.2197  11.3%  5630 2680s
  5821  1732 21008.4119   27  392 20593.0366 22915.2197  11.3%  5629 2705s
  5822  1733 21332.5874   14  392 20593.0366 22915.2197  11.3%  5628 2749s
  5823  1736 22915.2197   16  279 20593.0366 22915.2197  11.3%  5706 2778s
  5824  1736 22915.2197   16  354 20593.0366 22915.2197  11.3%  5707 2807s
  5825  1739 22915.2197   17  260 20593.0366 22915.2197  11.3%  5708 2827s
  5828  1745 22915.2197   18  280 20593.0366 22915.2197  11.3%  5711 2848s
  5835  1757 22915.2197   19  274 20593.0366 22915.2197  11.3%  5715 2879s
  5849  1766 22915.2197   19  287 20593.0366 22915.2197  11.3%  5736 2943s
  5863  1793 22915.2197   21  280 20593.0366 22915.2197  11.3%  5775 3075s
H 5864  1705                    20609.281916 22915.2197  11.2%  5774 3075s
H 5878  1617                    20612.988912 22915.2197  11.2%  5786 3075s
  5895  1691 22915.2197   22  278 20612.9889 22915.2197  11.2%  5853 3119s
  6006  1667 22915.2197   25  268 20612.9889 22915.2197  11.2%  5944 3153s
  6043  1664 22882.3781   24  277 20612.9889 22915.2197  11.2%  5988 3176s
H 6044  1586                    20613.804671 22915.2197  11.2%  5987 3176s
  6092  1566 22444.0834   24  276 20613.8047 22915.2197  11.2%  6053 3199s
  6147  1543 20711.9093   26  299 20613.8047 22915.2197  11.2%  6095 3221s
H 6148  1467                    20629.122656 22915.2197  11.1%  6094 3221s
H 6172  1388                    20642.580731 22915.2197  11.0%  6122 3221s
  6207  1371 21197.4811   25  259 20642.5807 22915.2197  11.0%  6139 3253s
  6273  1345 infeasible   26      20642.5807 22915.2197  11.0%  6150 3283s
  6308  1349 20942.8866   25  288 20642.5807 22915.2197  11.0%  6205 3314s
  6351  1339 21521.8560   24  185 20642.5807 22915.2197  11.0%  6221 3341s
  6411  1316 20937.5991   25  205 20642.5807 22915.2197  11.0%  6232 3363s
  6469  1300 20873.8701   28  175 20642.5807 22915.2197  11.0%  6254 3385s
  6522  1285 21576.7657   24  225 20642.5807 22915.2197  11.0%  6262 3406s
  6586  1266 21544.8922   25  277 20642.5807 22915.2197  11.0%  6276 3426s
  6652  1266 infeasible   26      20642.5807 22915.2197  11.0%  6265 3445s
  6752  1252 20971.7658   50   52 20642.5807 22915.2197  11.0%  6230 3468s
  6877  1250 21034.0615   55  101 20642.5807 22915.2197  11.0%  6170 3487s
  7014  1236 20819.3870   61   37 20642.5807 22915.2197  11.0%  6112 3506s
  7141  1196 20715.3992   67   24 20642.5807 22915.2197  11.0%  6048 3527s
  7270  1146 22300.4402   24  346 20642.5807 22915.2197  11.0%  6004 3551s
  7344  1119     cutoff   25      20642.5807 22915.2197  11.0%  6021 3580s
  7422  1090 21642.6001   26  232 20642.5807 22915.2197  11.0%  6038 3600s

Cutting planes:
  Learned: 3
  Gomory: 18
  Implied bound: 17
  Projected implied bound: 177
  MIR: 1415
  Mixing: 4
  Flow cover: 2719
  Inf proof: 1
  RLT: 19
  Relax-and-lift: 216

Explored 7526 nodes (45944887 simplex iterations) in 3600.08 seconds (9594.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20642.6 20629.1 20613.8 ... 20556.5

Time limit reached
Best objective 2.064258073062e+04, best bound 2.291521974826e+04, gap 11.0095%
  WARNING: Time limit reached. Using best solution found (gap: 11.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 20642.58, θ = 141057.99
  Upper Bound (UB) = 20642.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141057.99
  [DEBUG]   ✓ Scenario 0: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141057.99 ≤ Q = 141057.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141057.99 ≤ Q = 141057.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141057.99 ≤ Q = 141057.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x9b6ef12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x09b6ef12
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7512316.2374
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.354314e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135431.45    0  123 7512316.24 -135431.45   102%     -    0s
H    0     0                    -100534.3002 -135431.45  34.7%     -    0s
H    0     0                    -104206.0319 -107152.33  2.83%     -    0s
     0     0 -107152.33    0   83 -104206.03 -107152.33  2.83%     -    0s
     0     0 -106464.07    0   84 -104206.03 -106464.07  2.17%     -    0s
     0     0 -106416.72    0   84 -104206.03 -106416.72  2.12%     -    0s
H    0     0                    -105237.7884 -106416.72  1.12%     -    0s
     0     0 -106116.72    0   86 -105237.79 -106116.72  0.84%     -    0s
     0     0 -106108.98    0   85 -105237.79 -106108.98  0.83%     -    0s
     0     0 -105864.66    0   87 -105237.79 -105864.66  0.60%     -    0s
     0     0 -105817.20    0   87 -105237.79 -105817.20  0.55%     -    0s
     0     0 -105812.56    0   87 -105237.79 -105812.56  0.55%     -    0s
     0     0 -105640.79    0   79 -105237.79 -105640.79  0.38%     -    0s
     0     0 -105613.83    0   79 -105237.79 -105613.83  0.36%     -    0s
     0     2 -105613.83    0   79 -105237.79 -105613.83  0.36%     -    0s
*  220    14              21    -105270.0987 -105315.29  0.04%   8.1    0s

Cutting planes:
  Gomory: 34
  Implied bound: 2
  MIR: 171
  Flow cover: 5
  RLT: 2
  BQP: 2

Explored 265 nodes (2565 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -105270 -105238 -100534 ... 1.43567e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.052700987279e+05, best bound -1.052704616103e+05, gap 0.0003%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 139281.87
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105270.10
  [DEBUG]   S×d_nominal = 244551.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244551.97 + -105270.10 = 139281.87
  [DEBUG]   Current θ from Master = 141057.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1776.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18866.47
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 798.6439, Absolute Gap = 798.6439, Relative Gap = 0.038689
  Not converged yet (gap = 798.64 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913559 nonzeros
Model fingerprint: 0x485ed53e
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 142107 rows and 57687 columns
Presolve time: 3.64s
Presolved: 180366 rows, 75613 columns, 1109669 nonzeros
Variable types: 73354 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357058.9883
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.43s

Barrier statistics:
 Dense cols : 1222
 AA' NZ     : 4.273e+06
 Factor NZ  : 1.220e+07 (roughly 200 MB of memory)
 Factor Ops : 4.316e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87868245e+07  2.94177446e+08  1.08e+05 1.69e+01  7.22e+04     7s
   1  -1.44260239e+07  2.55347319e+08  7.68e+04 5.52e+01  5.09e+04     7s
   2  -4.67398833e+06  2.00084834e+08  2.47e+04 1.03e+00  1.73e+04     7s
   3  -1.07612332e+06  1.55380002e+08  2.27e+03 3.43e+00  1.98e+03     7s
   4  -6.87608043e+05  8.88242417e+07  5.34e+02 1.57e+00  5.95e+02     7s
   5  -5.59391895e+05  5.15708056e+07  2.97e+02 7.09e-01  3.21e+02     7s
   6  -5.57590880e+05  3.94448938e+07  1.25e+02 6.20e-02  1.86e+02     7s
   7  -4.28537535e+05  3.21089311e+07  6.18e+01 4.82e-02  1.29e+02     7s
   8  -3.34763251e+05  2.34118544e+07  2.61e+01 3.35e-02  8.29e+01     7s
   9  -2.01724395e+05  1.61464988e+07  6.70e+00 2.30e-02  5.20e+01     7s
  10  -1.36449006e+05  7.35946817e+06  3.01e+00 9.97e-03  2.33e+01     7s
  11  -1.17663623e+05  5.68830254e+06  2.05e+00 7.68e-03  1.79e+01     7s
  12  -9.98610495e+04  4.03951742e+06  1.30e+00 5.39e-03  1.27e+01     7s
  13  -9.13372297e+04  3.12850381e+06  1.02e+00 4.18e-03  9.88e+00     8s
  14  -6.58290235e+04  2.26304716e+06  3.64e-01 3.02e-03  7.11e+00     8s
  15  -4.38785406e+04  4.94831064e+05  1.60e-01 5.83e-04  1.64e+00     8s
  16  -2.20909387e+04  2.63391682e+05  9.18e-02 3.07e-04  8.70e-01     8s
  17  -1.45478963e+04  2.13828373e+05  7.57e-02 7.71e-04  6.96e-01     8s
  18  -6.61049777e+03  1.63482132e+05  6.30e-02 1.68e-03  5.19e-01     8s
  19   1.34923702e+03  1.45043467e+05  5.10e-02 1.87e-03  4.38e-01     8s
  20   5.64672992e+03  1.21165116e+05  4.42e-02 2.54e-03  3.52e-01     8s
  21   1.16386099e+04  9.63411887e+04  3.48e-02 1.71e-03  2.58e-01     8s
  22   1.48038435e+04  8.71829014e+04  3.03e-02 1.27e-03  2.21e-01     8s
  23   1.87827692e+04  7.05324739e+04  2.49e-02 2.80e-03  1.58e-01     8s
  24   2.21313949e+04  6.46819673e+04  2.06e-02 2.26e-03  1.30e-01     8s
  25   2.51841669e+04  5.89270643e+04  1.69e-02 1.73e-03  1.03e-01     8s
  26   2.72029541e+04  5.59024022e+04  1.45e-02 1.43e-03  8.75e-02     8s
  27   2.91212145e+04  5.20683078e+04  1.23e-02 1.09e-03  7.00e-02     8s
  28   3.06376554e+04  5.04318761e+04  1.08e-02 9.27e-04  6.04e-02     9s
  29   3.23917328e+04  4.85242026e+04  9.02e-03 7.21e-04  4.92e-02     9s
  30   3.41702847e+04  4.61652449e+04  7.23e-03 4.65e-04  3.66e-02     9s
  31   3.65054544e+04  4.48064525e+04  4.90e-03 3.18e-04  2.53e-02     9s
  32   3.80245127e+04  4.38449576e+04  3.44e-03 2.14e-04  1.77e-02     9s
  33   3.88861643e+04  4.36850292e+04  2.64e-03 1.97e-04  1.46e-02     9s
  34   3.91879827e+04  4.26470793e+04  2.35e-03 1.39e-04  1.05e-02     9s
  35   3.96329443e+04  4.24803898e+04  1.96e-03 9.51e-05  8.68e-03     9s
  36   4.00865349e+04  4.23833674e+04  1.56e-03 7.94e-05  7.00e-03     9s
  37   4.06209732e+04  4.21942329e+04  1.09e-03 1.03e-04  4.80e-03     9s
  38   4.09348514e+04  4.20437924e+04  8.07e-04 5.66e-05  3.38e-03     9s
  39   4.11278906e+04  4.19936992e+04  6.35e-04 4.59e-05  2.64e-03     9s
  40   4.13980526e+04  4.19369021e+04  3.81e-04 2.56e-05  1.64e-03    10s
  41   4.15391806e+04  4.18887238e+04  2.60e-04 3.02e-05  1.07e-03    10s
  42   4.15476410e+04  4.18802727e+04  2.52e-04 2.11e-05  1.01e-03    10s
  43   4.16897796e+04  4.18696664e+04  1.31e-04 1.11e-05  5.49e-04    10s
  44   4.17557444e+04  4.18616054e+04  7.62e-05 6.49e-06  3.23e-04    10s
  45   4.17995224e+04  4.18560155e+04  4.07e-05 7.18e-06  1.72e-04    10s
  46   4.18516953e+04  4.18538608e+04  9.15e-07 2.50e-06  6.60e-06    10s
  47   4.18535713e+04  4.18535862e+04  5.98e-09 1.04e-08  4.54e-08    10s
  48   4.18535833e+04  4.18535833e+04  1.40e-09 9.00e-11  6.76e-11    10s

Barrier solved model in 48 iterations and 10.12 seconds (16.79 work units)
Optimal objective 4.18535833e+04


Root crossover log...

  159468 DPushes remaining with DInf 0.0000000e+00                10s
      20 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    2979 PPushes remaining with PInf 2.6637032e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9740072e-02     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70119    4.1853583e+04   0.000000e+00   1.974007e-02     15s
   70120    4.1853583e+04   0.000000e+00   0.000000e+00     16s
   70120    4.1853583e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 1.89s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185358e+04, 70120 iterations, 12.94 seconds (25.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41853.5833    0  194 -208513.72 41853.5833   120%     -   18s
H    0     0                    -114241.6369 41853.5833   137%     -   19s
H    0     0                    -108295.3303 41853.5833   139%     -   19s
H    0     0                    -108124.2618 41853.5833   139%     -   19s
H    0     0                    -40634.99258 41853.5833   203%     -   19s
H    0     0                    15588.371316 41853.5833   168%     -   19s
H    0     0                    16002.000652 41853.5833   162%     -   20s
H    0     0                    16006.970882 41853.5833   161%     -   20s
H    0     0                    16041.561662 41853.5833   161%     -   20s
H    0     0                    16131.657761 41853.5833   159%     -   20s
H    0     0                    16133.139490 41853.5833   159%     -   20s
H    0     0                    16137.694507 41853.5833   159%     -   20s
     0     0 36683.7483    0  224 16137.6945 36683.7483   127%     -   65s
H    0     0                    16245.704644 36682.1021   126%     -   67s
     0     0 36444.6287    0  226 16245.7046 36444.6287   124%     -   77s
     0     0 35915.0864    0  294 16245.7046 35915.0864   121%     -   88s
     0     0 35879.1598    0  304 16245.7046 35879.1598   121%     -   92s
     0     0 35853.9544    0  308 16245.7046 35853.9544   121%     -   94s
     0     0 35813.6254    0  298 16245.7046 35813.6254   120%     -   99s
     0     0 35812.2761    0  297 16245.7046 35812.2761   120%     -  100s
     0     0 35812.2761    0  297 16245.7046 35812.2761   120%     -  101s
     0     0 31994.8125    0  249 16245.7046 31994.8125  96.9%     -  145s
H    0     0                    19073.144861 31994.7727  67.7%     -  146s
H    0     0                    19350.513444 31994.7727  65.3%     -  146s
H    0     0                    19401.838520 31994.7727  64.9%     -  146s
H    0     0                    19456.337788 31994.7727  64.4%     -  146s
H    0     0                    19567.093631 31994.7727  63.5%     -  146s
H    0     0                    19623.397914 31994.7727  63.0%     -  146s
H    0     0                    19635.102482 31994.7727  62.9%     -  146s
H    0     0                    19659.857019 31994.7727  62.7%     -  146s
H    0     0                    19678.493271 31994.7727  62.6%     -  146s
     0     0 31552.4737    0  379 19678.4933 31552.4737  60.3%     -  178s
     0     0 31418.0447    0  329 19678.4933 31418.0447  59.7%     -  201s
     0     0 31352.4711    0  326 19678.4933 31352.4711  59.3%     -  209s
     0     0 31296.5221    0  348 19678.4933 31296.5221  59.0%     -  221s
     0     0 31287.6230    0  353 19678.4933 31287.6230  59.0%     -  224s
     0     0 31281.3925    0  333 19678.4933 31281.3925  59.0%     -  230s
     0     0 31279.7910    0  323 19678.4933 31279.7910  59.0%     -  233s
     0     0 31279.4301    0  329 19678.4933 31279.4301  59.0%     -  234s
     0     0 29581.7027    0  334 19678.4933 29581.7027  50.3%     -  292s
     0     0 29106.5271    0  354 19678.4933 29106.5271  47.9%     -  330s
     0     0 28873.6013    0  348 19678.4933 28873.6013  46.7%     -  349s
     0     0 28851.3222    0  355 19678.4933 28851.3222  46.6%     -  356s
     0     0 28823.5096    0  357 19678.4933 28823.5096  46.5%     -  365s
     0     0 28817.7077    0  362 19678.4933 28817.7077  46.4%     -  370s
     0     0 28795.7801    0  361 19678.4933 28795.7801  46.3%     -  375s
     0     0 28776.8322    0  354 19678.4933 28776.8322  46.2%     -  380s
     0     0 28750.9592    0  349 19678.4933 28750.9592  46.1%     -  388s
     0     0 28743.9805    0  360 19678.4933 28743.9805  46.1%     -  391s
     0     0 28671.9191    0  351 19678.4933 28671.9191  45.7%     -  398s
     0     0 28652.6345    0  359 19678.4933 28652.6345  45.6%     -  404s
     0     0 28582.6984    0  356 19678.4933 28582.6984  45.2%     -  413s
     0     0 28580.5141    0  357 19678.4933 28580.5141  45.2%     -  416s
     0     0 28574.9370    0  350 19678.4933 28574.9370  45.2%     -  418s
     0     0 28573.3265    0  350 19678.4933 28573.3265  45.2%     -  420s
     0     0 27812.2017    0  381 19678.4933 27812.2017  41.3%     -  465s
     0     0 27634.6485    0  363 19678.4933 27634.6485  40.4%     -  484s
     0     0 27592.8339    0  325 19678.4933 27592.8339  40.2%     -  494s
     0     0 27526.9608    0  321 19678.4933 27526.9608  39.9%     -  507s
     0     0 27500.3935    0  365 19678.4933 27500.3935  39.7%     -  518s
     0     0 27489.3180    0  423 19678.4933 27489.3180  39.7%     -  525s
     0     0 27485.1160    0  419 19678.4933 27485.1160  39.7%     -  529s
     0     0 27484.3463    0  371 19678.4933 27484.3463  39.7%     -  531s
     0     0 27431.5195    0  357 19678.4933 27431.5195  39.4%     -  549s
H    0     0                    20253.424975 27431.4985  35.4%     -  550s
H    0     0                    20307.659767 27431.4985  35.1%     -  550s
     0     0 27419.8770    0  363 20307.6598 27419.8770  35.0%     -  558s
     0     0 27415.6792    0  366 20307.6598 27415.6792  35.0%     -  564s
     0     0 27412.3883    0  375 20307.6598 27412.3883  35.0%     -  568s
     0     0 27411.2572    0  372 20307.6598 27411.2572  35.0%     -  572s
     0     0 27396.6945    0  349 20307.6598 27396.6945  34.9%     -  581s
H    0     0                    20373.649455 27396.6370  34.5%     -  583s
     0     0 27393.1905    0  369 20373.6495 27393.1905  34.5%     -  588s
     0     0 27392.5273    0  369 20373.6495 27392.5273  34.5%     -  589s
     0     0 27333.6221    0  348 20373.6495 27333.6221  34.2%     -  602s
     0     0 27322.2600    0  401 20373.6495 27322.2600  34.1%     -  611s
     0     0 27318.7420    0  404 20373.6495 27318.7420  34.1%     -  615s
     0     0 27318.0095    0  411 20373.6495 27318.0095  34.1%     -  618s
     0     0 27303.7787    0  362 20373.6495 27303.7787  34.0%     -  627s
H    0     0                    20403.958861 27303.7631  33.8%     -  628s
H    0     0                    20405.414764 27303.7631  33.8%     -  628s
H    0     0                    20427.814371 27303.7631  33.7%     -  628s
H    0     0                    20434.793136 27303.7631  33.6%     -  628s
     0     0 27289.7674    0  413 20434.7931 27289.7674  33.5%     -  635s
     0     0 27288.0627    0  432 20434.7931 27288.0627  33.5%     -  638s
     0     0 27280.7552    0  324 20434.7931 27280.7552  33.5%     -  647s
     0     0 27279.5409    0  324 20434.7931 27279.5409  33.5%     -  649s
     0     0 27279.5409    0  448 20434.7931 27279.5409  33.5%     -  655s
     0     0 27279.2501    0  278 20434.7931 27279.2501  33.5%     -  660s
     0     0 27279.1703    0  282 20434.7931 27279.1703  33.5%     -  663s
     0     0 27278.1173    0  254 20434.7931 27278.1173  33.5%     -  665s
     0     0 27276.7890    0  280 20434.7931 27276.7890  33.5%     -  669s
     0     0 27276.6829    0  252 20434.7931 27276.6829  33.5%     -  673s
     0     0 27275.9628    0  251 20434.7931 27275.9628  33.5%     -  676s
     0     0 27274.8618    0  251 20434.7931 27274.8618  33.5%     -  678s
     0     0 27270.0022    0  279 20434.7931 27270.0022  33.4%     -  684s
     0     0 27269.9515    0  279 20434.7931 27269.9515  33.4%     -  691s
H    0     0                    20438.553892 27269.6862  33.4%     -  783s
     0     2 27269.6862    0  279 20438.5539 27269.6862  33.4%     -  797s
     1     3 26048.6743    1  285 20438.5539 27268.4945  33.4% 17126  816s
     2     5 25949.0460    2  269 20438.5539 27268.4945  33.4% 11024  835s
     4    10 26217.1354    2  418 20438.5539 27020.1357  32.2% 12776  860s
     9    19 26144.6934    3  409 20438.5539 26356.5419  29.0% 13639  880s
    18    38 25660.7005    4  412 20438.5539 26356.3606  29.0% 12630  899s
    37    51 25369.7554    4  292 20438.5539 25740.1787  25.9% 19817  949s
    50    76 25405.2527    6  429 20438.5539 25740.1787  25.9% 19850 1012s
    75   122 25051.9212    7  407 20438.5539 25740.1787  25.9% 16636 1079s
   121   154 24877.7847    8  396 20438.5539 25740.1787  25.9% 13036 1108s
H  131   154                    20505.139183 25740.1787  25.5% 12719 1108s
   153   300 24845.6794    9  383 20505.1392 25740.1787  25.5% 12248 1140s
   301   324 24104.3817   10  380 20505.1392 25740.1787  25.5%  8723 1156s
   331   354 24073.6824   11  319 20505.1392 25740.1787  25.5%  8443 1176s
   361   382 23648.9775   12  255 20505.1392 25740.1787  25.5%  8491 1191s
H  369   382                    20512.536997 25740.1787  25.5%  8561 1191s
   393   446 23616.4319   13  249 20512.5370 25740.1787  25.5%  8568 1212s
   472   480 22924.7663   15  296 20512.5370 25740.1787  25.5%  8340 1239s
   536   494 22448.3910   17  299 20512.5370 25740.1787  25.5%  8306 1258s
   598   491     cutoff   18      20512.5370 25740.1787  25.5%  8346 1276s
   656   497 22392.8419   17  320 20512.5370 25740.1787  25.5%  8368 1295s
   712   503 infeasible   18      20512.5370 25740.1787  25.5%  8427 1314s
   760   547 22043.1691   17  270 20512.5370 25740.1787  25.5%  8559 1333s
   829   615 21982.1189   18  324 20512.5370 25740.1787  25.5%  8412 1351s
   933   643 21703.4946   20  291 20512.5370 25740.1787  25.5%  7884 1370s
  1039   661 21650.5070   23  303 20512.5370 25740.1787  25.5%  7541 1388s
  1117   684 infeasible   23      20512.5370 25740.1787  25.5%  7364 1408s
  1196   743 21507.2063   23  306 20512.5370 25740.1787  25.5%  7279 1425s
  1304   803 21463.3722   24  253 20512.5370 25740.1787  25.5%  7085 1445s
  1420   830 21431.4718   25  250 20512.5370 25740.1787  25.5%  6918 1467s
  1521   845 21395.1621   27  262 20512.5370 25740.1787  25.5%  6760 1487s
  1616   888 21315.4308   31  312 20512.5370 25740.1787  25.5%  6727 1510s
  1710   942 infeasible   35      20512.5370 25740.1787  25.5%  6724 1529s
  1798  1038 infeasible   16      20512.5370 25736.5347  25.5%  6726 1549s
H 1840  1038                    20525.536143 25736.5347  25.4%  6688 1549s
  1930  1117 21063.7900   28  159 20525.5361 25736.5347  25.4%  6574 1572s
  2119  1189 21027.5642   29  194 20525.5361 25736.5347  25.4%  6308 1597s
  2281  1260 20915.4762   36  107 20525.5361 25736.5347  25.4%  6094 1624s
  2416  1303 20590.5263   49   49 20525.5361 25736.5347  25.4%  6018 1650s
  2540  1306 20895.7648   12  274 20525.5361 25515.2750  24.3%  6089 1677s
H 2574  1306                    20528.243614 25515.2750  24.3%  6137 1677s
  2607  1322 20734.6667   13  276 20528.2436 25515.2750  24.3%  6183 1705s
  2709  1324     cutoff   15      20528.2436 25515.2750  24.3%  6335 1735s
  2779  1326     cutoff   13      20528.2436 24412.9676  18.9%  6507 1764s
  2859  1340 22145.5053    7  314 20528.2436 24412.9676  18.9%  6654 1797s
  2951  1393     cutoff    8      20528.2436 24401.9338  18.9%  6799 1829s
  3057  1445 infeasible    9      20528.2436 24401.9338  18.9%  6916 1863s
  3203  1524 21084.2265   10  287 20528.2436 24334.6864  18.5%  6973 1897s
  3412  1529 infeasible   13      20528.2436 24334.6864  18.5%  6878 1932s
H 3429  1529                    20534.743941 24197.0030  17.8%  6897 1932s
H 3451  1529                    20560.055985 24197.0030  17.7%  6925 1932s
  3461  1641 21454.1300   10  313 20560.0560 24197.0030  17.7%  6967 1965s
  3728  1670 21076.2345   11  367 20560.0560 24197.0030  17.7%  6828 2004s
  3919  1690     cutoff   13      20560.0560 24197.0030  17.7%  6807 2043s
  4047  1675 21858.2952   11  220 20560.0560 23973.3709  16.6%  6935 2088s
  4194  1677 infeasible   16      20560.0560 23973.3709  16.6%  7032 2124s
H 4256  1660                    20610.794464 23973.3709  16.3%  7111 2124s
  4278  1698 infeasible   15      20610.7945 23973.3709  16.3%  7141 2163s
  4437  1795 21112.1694   12  251 20610.7945 23851.3287  15.7%  7289 2210s
  4697  1839 infeasible   48      20610.7945 23805.8359  15.5%  7213 2255s
  4933  1876 22382.7586    6  321 20610.7945 23805.8359  15.5%  7203 2304s
  5109  1962 21899.0707    9  302 20610.7945 23805.8359  15.5%  7276 2350s
H 5324  1958                    20622.899542 23390.5589  13.4%  7333 2400s
  5374  2101 21335.8467   16  228 20622.8995 23390.5589  13.4%  7387 2449s
H 5702  2090                    20633.933221 23315.7151  13.0%  7320 2463s
  5703  2090 21563.2399   20  279 20633.9332 23315.7151  13.0%  7319 2656s
  5705  2091 21209.1113   17  144 20633.9332 23315.7151  13.0%  7316 2675s
  5706  2092 21465.5544   22  337 20633.9332 23315.7151  13.0%  7315 2763s
  5707  2093 21194.8075   20  271 20633.9332 23315.7151  13.0%  7314 2820s
  5708  2093 23008.7828   12  387 20633.9332 23315.7151  13.0%  7313 2868s
  5709  2094 22623.3053    9  340 20633.9332 23315.7151  13.0%  7311 2904s
  5710  2095 22141.9273   21  292 20633.9332 23315.7151  13.0%  7310 2929s
  5711  2095 21478.3563    8  294 20633.9332 23315.7151  13.0%  7309 2944s
  5712  2096 21684.0170   12  355 20633.9332 23315.7151  13.0%  7307 2961s
  5713  2097 20859.0157   40  354 20633.9332 23315.7151  13.0%  7306 2980s
  5714  2097 21055.9390   17  361 20633.9332 23315.7151  13.0%  7305 2991s
  5715  2098 21842.1232   12  354 20633.9332 23315.7151  13.0%  7304 3026s
  5716  2099 21558.7836   12  303 20633.9332 23315.7151  13.0%  7302 3035s
  5717  2099 22968.8970   11  298 20633.9332 23315.7151  13.0%  7301 3043s
  5718  2100 20828.9728   25  352 20633.9332 23315.7151  13.0%  7300 3065s
  5719  2101 22637.5290   17  425 20633.9332 23315.7151  13.0%  7299 3082s
  5720  2101 22116.9164   16  370 20633.9332 23315.7151  13.0%  7297 3121s
  5721  2102 21941.9598   19  420 20633.9332 23315.7151  13.0%  7296 3143s
  5722  2103 21545.9987   22  363 20633.9332 23315.7151  13.0%  7295 3150s
  5723  2103 21783.9185   38  367 20633.9332 23315.7151  13.0%  7293 3157s
  5724  2104 21365.2560   22  350 20633.9332 23315.7151  13.0%  7292 3183s
  5725  2105 20905.7748   43  413 20633.9332 23315.7151  13.0%  7291 3195s
  5726  2105 21375.4828   17  408 20633.9332 23315.7151  13.0%  7290 3205s
  5727  2106 23008.7828   12  412 20633.9332 23315.7151  13.0%  7288 3232s
  5728  2107 21032.8222   29  389 20633.9332 23315.7151  13.0%  7287 3241s
  5729  2107 21678.5699   15  374 20633.9332 23315.7151  13.0%  7286 3248s
  5730  2108 22721.1845   13  381 20633.9332 23315.7151  13.0%  7285 3263s
  5731  2109 22906.3020    9  377 20633.9332 23315.7151  13.0%  7283 3273s
  5732  2109 21529.4002   18  425 20633.9332 23315.7151  13.0%  7282 3290s
  5733  2110 22016.7415   13  377 20633.9332 23315.7151  13.0%  7281 3299s
  5734  2111 21194.4427   18  378 20633.9332 23315.7151  13.0%  7279 3312s
  5735  2111 21512.4858   17  423 20633.9332 23315.7151  13.0%  7278 3320s
  5736  2112 21136.1889   28  369 20633.9332 23315.7151  13.0%  7277 3330s
  5737  2113 21293.8201   17  369 20633.9332 23315.7151  13.0%  7276 3347s
  5738  2113 22837.1039   17  369 20633.9332 23315.7151  13.0%  7274 3431s
  5739  2117 23315.7151   12  415 20633.9332 23315.7151  13.0%  7357 3478s
  5741  2120 23315.7151   13  421 20633.9332 23315.7151  13.0%  7358 3509s
  5745  2127 23315.7151   14  435 20633.9332 23315.7151  13.0%  7364 3537s
  5753  2131 23315.7151   15  279 20633.9332 23315.7151  13.0%  7375 3600s

Cutting planes:
  Learned: 1
  Gomory: 27
  Implied bound: 10
  Projected implied bound: 206
  MIR: 955
  Flow cover: 1228
  RLT: 11
  Relax-and-lift: 184

Explored 5760 nodes (43114332 simplex iterations) in 3600.05 seconds (9593.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20633.9 20622.9 20610.8 ... 20438.6

Time limit reached
Best objective 2.063393322139e+04, best bound 2.331571505769e+04, gap 12.9969%
  WARNING: Time limit reached. Using best solution found (gap: 13.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 20633.93, θ = 140629.83
  Upper Bound (UB) = 20633.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140629.83
  [DEBUG]   ✓ Scenario 0: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140629.83 ≤ Q = 140629.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140629.83 ≤ Q = 140629.83 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4919df1c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4919df1c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7496201.4900
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.357024e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135702.43    0  123 7496201.49 -135702.43   102%     -    0s
H    0     0                    -100721.6684 -135702.43  34.7%     -    0s
     0     0 -106930.14    0  116 -100721.67 -106930.14  6.16%     -    0s
H    0     0                    -105061.6715 -106819.95  1.67%     -    0s
     0     0 -106074.78    0   82 -105061.67 -106074.78  0.96%     -    0s
     0     0 -105916.44    0   67 -105061.67 -105916.44  0.81%     -    0s
     0     0 -105831.44    0   83 -105061.67 -105831.44  0.73%     -    0s
     0     0 -105812.81    0   83 -105061.67 -105812.81  0.71%     -    0s
     0     0 -105650.29    0   56 -105061.67 -105650.29  0.56%     -    0s
     0     0 -105615.46    0   85 -105061.67 -105615.46  0.53%     -    0s
     0     0 -105532.61    0   64 -105061.67 -105532.61  0.45%     -    0s
     0     0 -105525.66    0   64 -105061.67 -105525.66  0.44%     -    0s
     0     2 -105525.66    0   64 -105061.67 -105525.66  0.44%     -    0s
H   45    27                    -105258.1954 -105380.69  0.12%  19.1    0s
H   46    26                    -105320.6263 -105380.69  0.06%  18.7    0s
H   47    26                    -105325.7809 -105380.69  0.05%  18.8    0s
H   56    23                    -105349.2773 -105380.46  0.03%  17.5    0s
H   72     4                    -105370.3526 -105375.48  0.00%  15.2    0s
*   84     4              10    -105370.7643 -105370.76  0.00%  13.6    0s

Cutting planes:
  Gomory: 32
  Implied bound: 1
  MIR: 184
  Flow cover: 15
  RLT: 6
  BQP: 1

Explored 105 nodes (1869 simplex iterations) in 0.12 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105371 -105370 -105349 ... 1.43567e+13
No other solutions better than -105371

Optimal solution found (tolerance 1.00e-04)
Best objective -1.053707643466e+05, best bound -1.053707643466e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 139038.58
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105370.76
  [DEBUG]   S×d_nominal = 244409.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244409.34 + -105370.76 = 139038.58
  [DEBUG]   Current θ from Master = 140629.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1591.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19042.68
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 789.9964, Absolute Gap = 789.9964, Relative Gap = 0.038286
  Not converged yet (gap = 790.00 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956799 nonzeros
Model fingerprint: 0xe74a2708
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148874 rows and 60434 columns
Presolve time: 3.85s
Presolved: 188889 rows, 79106 columns, 1162114 nonzeros
Variable types: 76847 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.45s

Barrier statistics:
 Dense cols : 1222
 AA' NZ     : 4.606e+06
 Factor NZ  : 1.310e+07 (roughly 200 MB of memory)
 Factor Ops : 4.697e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.91250928e+07  3.05833028e+08  1.10e+05 1.65e+01  7.31e+04     7s
   1  -1.47106431e+07  2.65665562e+08  7.83e+04 5.56e+01  5.16e+04     7s
   2  -4.78078587e+06  2.08850686e+08  2.52e+04 1.04e+00  1.76e+04     7s
   3  -1.38382214e+06  1.84321396e+08  3.54e+03 1.22e+01  2.90e+03     7s
   4  -8.11722981e+05  1.31664173e+08  7.46e+02 6.70e+00  8.58e+02     7s
   5  -7.20490910e+05  7.32457217e+07  4.22e+02 3.13e+00  4.56e+02     7s
   6  -6.21857244e+05  5.14824543e+07  2.90e+02 1.96e+00  3.05e+02     7s
   7  -5.19775209e+05  4.23145706e+07  1.95e+02 1.44e+00  2.24e+02     7s
   8  -4.32881051e+05  3.76156947e+07  7.00e+01 1.07e+00  1.45e+02     8s
   9  -3.42565847e+05  2.33331110e+07  2.50e+01 2.08e-01  7.87e+01     8s
  10  -2.26393649e+05  1.43280520e+07  9.01e+00 2.24e-02  4.50e+01     8s
  11  -1.48002836e+05  9.30486789e+06  4.06e+00 1.41e-02  2.83e+01     8s
  12  -1.27011080e+05  6.81502753e+06  2.76e+00 1.03e-02  2.06e+01     8s
  13  -1.12067135e+05  4.37895002e+06  1.94e+00 6.55e-03  1.33e+01     8s
  14  -9.37224552e+04  2.93277034e+06  1.19e+00 5.34e-02  8.89e+00     8s
  15  -6.61591366e+04  2.32613959e+06  4.57e-01 1.89e-02  6.99e+00     8s
  16  -4.54887905e+04  9.23066159e+05  1.94e-01 2.15e-02  2.82e+00     8s
  17  -2.24936100e+04  4.32804456e+05  7.92e-02 7.73e-03  1.33e+00     8s
  18  -7.73722187e+03  2.72990501e+05  4.76e-02 3.14e-03  8.18e-01     8s
  19  -8.46075205e+01  1.62959404e+05  3.60e-02 2.06e-03  4.75e-01     8s
  20   5.36430694e+03  1.39707056e+05  2.99e-02 1.44e-03  3.91e-01     8s
  21   7.68250200e+03  1.17493954e+05  2.72e-02 1.16e-03  3.20e-01     8s
  22   1.10721784e+04  9.87352496e+04  2.35e-02 1.19e-03  2.55e-01     8s
  23   1.56090257e+04  9.06922480e+04  1.91e-02 9.64e-04  2.19e-01     8s
  24   2.04504778e+04  8.44609652e+04  1.43e-02 1.00e-03  1.86e-01     9s
  25   2.41051356e+04  7.31474421e+04  1.10e-02 9.69e-04  1.43e-01     9s
  26   2.51886317e+04  6.13218276e+04  1.01e-02 1.59e-03  1.05e-01     9s
  27   2.86676049e+04  5.94131804e+04  7.57e-03 1.75e-03  8.95e-02     9s
  28   2.98324060e+04  5.42845350e+04  6.77e-03 1.47e-03  7.12e-02     9s
  29   3.17869983e+04  5.25868926e+04  5.58e-03 1.42e-03  6.06e-02     9s
  30   3.38940027e+04  4.98873866e+04  4.29e-03 9.29e-04  4.66e-02     9s
  31   3.52799609e+04  4.78585332e+04  3.47e-03 5.81e-04  3.66e-02     9s
  32   3.63059610e+04  4.67250125e+04  2.89e-03 4.81e-04  3.03e-02     9s
  33   3.69920620e+04  4.51469669e+04  2.50e-03 3.34e-04  2.38e-02     9s
  34   3.84584083e+04  4.42005550e+04  1.71e-03 2.36e-04  1.67e-02     9s
  35   3.95815108e+04  4.35285659e+04  1.12e-03 1.67e-04  1.15e-02     9s
  36   4.01144341e+04  4.27266049e+04  8.46e-04 8.49e-05  7.61e-03     9s
  37   4.07668154e+04  4.24517897e+04  5.17e-04 5.68e-05  4.91e-03    10s
  38   4.10261182e+04  4.23011493e+04  3.90e-04 4.19e-05  3.71e-03    10s
  39   4.11432341e+04  4.22307334e+04  3.32e-04 3.52e-05  3.17e-03    10s
  40   4.12965464e+04  4.20673979e+04  2.61e-04 1.92e-05  2.24e-03    10s
  41   4.15897023e+04  4.19643703e+04  1.19e-04 2.47e-05  1.09e-03    10s
  42   4.16279849e+04  4.19379911e+04  1.01e-04 1.85e-05  9.03e-04    10s
  43   4.16296063e+04  4.19339559e+04  1.01e-04 1.76e-05  8.86e-04    10s
  44   4.16345015e+04  4.19161016e+04  9.84e-05 1.35e-05  8.20e-04    10s
  45   4.17668628e+04  4.18910105e+04  3.76e-05 7.48e-06  3.61e-04    10s
  46   4.18450761e+04  4.18671200e+04  4.74e-06 2.07e-06  6.42e-05    10s
  47   4.18557970e+04  4.18576365e+04  3.51e-07 1.35e-06  5.35e-06    10s
  48   4.18571184e+04  4.18571205e+04  3.84e-10 1.28e-09  6.28e-09    10s
  49   4.18571198e+04  4.18571199e+04  6.09e-08 7.48e-11  1.14e-10    11s

Barrier solved model in 49 iterations and 10.51 seconds (17.59 work units)
Optimal objective 4.18571198e+04


Root crossover log...

  166944 DPushes remaining with DInf 0.0000000e+00                11s
    2011 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    4613 PPushes remaining with PInf 3.6294851e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0328074e-01     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   76578    4.1857120e+04   0.000000e+00   1.032807e-01     16s
   76580    4.1857120e+04   0.000000e+00   0.000000e+00     16s
   76580    4.1857120e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 2.13s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185712e+04, 76580 iterations, 13.72 seconds (27.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41857.1199    0  194 -208513.72 41857.1199   120%     -   19s
H    0     0                    -156785.9864 41857.1199   127%     -   19s
H    0     0                    -125194.8375 41857.1199   133%     -   19s
H    0     0                    -109367.1394 41857.1199   138%     -   20s
H    0     0                    -108391.9395 41857.1199   139%     -   20s
H    0     0                    -41554.87577 41857.1199   201%     -   20s
H    0     0                    6974.9638303 41857.1199   500%     -   20s
H    0     0                    8118.6863319 41857.1199   416%     -   20s
H    0     0                    9575.7884356 41857.1199   337%     -   21s
H    0     0                    13448.077532 41857.1199   211%     -   21s
H    0     0                    16022.907709 41857.1199   161%     -   21s
H    0     0                    16137.694507 41857.1199   159%     -   21s
H    0     0                    16155.815941 41857.1199   159%     -   21s
H    0     0                    16169.304523 41857.1199   159%     -   21s
     0     0 37213.4598    0  279 16169.3045 37213.4598   130%     -   69s
H    0     0                    16305.276991 37213.2813   128%     -   71s
     0     0 36544.1056    0  271 16305.2770 36544.1056   124%     -  101s
     0     0 36130.4973    0  288 16305.2770 36130.4973   122%     -  117s
     0     0 36072.8150    0  297 16305.2770 36072.8150   121%     -  124s
     0     0 35997.6548    0  294 16305.2770 35997.6548   121%     -  130s
     0     0 35789.4539    0  282 16305.2770 35789.4539   119%     -  141s
     0     0 35754.6759    0  283 16305.2770 35754.6759   119%     -  145s
     0     0 35751.8537    0  295 16305.2770 35751.8537   119%     -  148s
     0     0 35750.3010    0  300 16305.2770 35750.3010   119%     -  149s
     0     0 35750.3010    0  300 16305.2770 35750.3010   119%     -  150s
     0     0 32208.9686    0  245 16305.2770 32208.9686  97.5%     -  196s
H    0     0                    19615.288640 32208.1763  64.2%     -  197s
H    0     0                    19627.069769 32208.1763  64.1%     -  197s
H    0     0                    19684.661573 32208.1763  63.6%     -  197s
H    0     0                    19688.524643 32208.1763  63.6%     -  198s
H    0     0                    19693.202127 32208.1763  63.5%     -  198s
     0     0 31443.7382    0  252 19693.2021 31443.7382  59.7%     -  238s
     0     0 31259.8236    0  252 19693.2021 31259.8236  58.7%     -  253s
     0     0 31238.0954    0  256 19693.2021 31238.0954  58.6%     -  262s
     0     0 31168.6189    0  241 19693.2021 31168.6189  58.3%     -  274s
     0     0 31138.4526    0  294 19693.2021 31138.4526  58.1%     -  284s
     0     0 31041.5675    0  245 19693.2021 31041.5675  57.6%     -  293s
     0     0 31028.4385    0  252 19693.2021 31028.4385  57.6%     -  296s
     0     0 30965.4379    0  296 19693.2021 30965.4379  57.2%     -  310s
     0     0 30946.0469    0  303 19693.2021 30946.0469  57.1%     -  317s
     0     0 30899.1170    0  312 19693.2021 30899.1170  56.9%     -  326s
     0     0 30853.3765    0  304 19693.2021 30853.3765  56.7%     -  334s
     0     0 30848.5628    0  303 19693.2021 30848.5628  56.6%     -  337s
     0     0 30846.7585    0  308 19693.2021 30846.7585  56.6%     -  339s
     0     0 30846.7423    0  308 19693.2021 30846.7423  56.6%     -  341s
     0     0 29113.0208    0  332 19693.2021 29113.0208  47.8%     -  405s
H    0     0                    19719.880513 29111.2279  47.6%     -  407s
     0     0 28725.7803    0  333 19719.8805 28725.7803  45.7%     -  426s
     0     0 28549.8169    0  331 19719.8805 28549.8169  44.8%     -  443s
     0     0 28459.5948    0  390 19719.8805 28459.5948  44.3%     -  462s
     0     0 28416.1910    0  383 19719.8805 28416.1910  44.1%     -  470s
     0     0 28321.8375    0  337 19719.8805 28321.8375  43.6%     -  482s
     0     0 28302.1649    0  343 19719.8805 28302.1649  43.5%     -  488s
     0     0 28284.8672    0  347 19719.8805 28284.8672  43.4%     -  497s
     0     0 28261.8620    0  351 19719.8805 28261.8620  43.3%     -  511s
     0     0 28208.2959    0  351 19719.8805 28208.2959  43.0%     -  517s
     0     0 28207.1945    0  352 19719.8805 28207.1945  43.0%     -  518s
     0     0 27673.6552    0  354 19719.8805 27673.6552  40.3%     -  553s
H    0     0                    20022.328721 27672.4928  38.2%     -  555s
H    0     0                    20050.818993 27672.4928  38.0%     -  556s
     0     0 27638.1641    0  349 20050.8190 27638.1641  37.8%     -  561s
     0     0 27580.2510    0  351 20050.8190 27580.2510  37.6%     -  567s
     0     0 27563.9675    0  352 20050.8190 27563.9675  37.5%     -  570s
     0     0 27559.9805    0  346 20050.8190 27559.9805  37.5%     -  571s
     0     0 27559.2459    0  342 20050.8190 27559.2459  37.4%     -  572s
     0     0 27465.9953    0  348 20050.8190 27465.9953  37.0%     -  589s
     0     0 27422.9567    0  355 20050.8190 27422.9567  36.8%     -  600s
     0     0 27412.4513    0  354 20050.8190 27412.4513  36.7%     -  605s
     0     0 27411.2557    0  353 20050.8190 27411.2557  36.7%     -  608s
     0     0 27385.7057    0  364 20050.8190 27385.7057  36.6%     -  618s
     0     0 27348.2199    0  349 20050.8190 27348.2199  36.4%     -  632s
     0     0 27341.5769    0  352 20050.8190 27341.5769  36.4%     -  637s
     0     0 27338.5973    0  348 20050.8190 27338.5973  36.3%     -  640s
     0     0 27335.4547    0  349 20050.8190 27335.4547  36.3%     -  643s
     0     0 27334.6899    0  353 20050.8190 27334.6899  36.3%     -  644s
     0     0 27308.4931    0  306 20050.8190 27308.4931  36.2%     -  653s
     0     0 27305.0193    0  304 20050.8190 27305.0193  36.2%     -  657s
     0     0 27304.8596    0  306 20050.8190 27304.8596  36.2%     -  658s
     0     0 27281.4507    0  289 20050.8190 27281.4507  36.1%     -  665s
H    0     0                    20109.455474 27281.3919  35.7%     -  668s
H    0     0                    20208.264306 27281.3919  35.0%     -  668s
     0     0 27277.8432    0  302 20208.2643 27277.8432  35.0%     -  672s
     0     0 27277.1008    0  305 20208.2643 27277.1008  35.0%     -  675s
     0     0 27271.5245    0  296 20208.2643 27271.5245  35.0%     -  685s
     0     0 27269.5514    0  303 20208.2643 27269.5514  34.9%     -  688s
     0     0 27269.4959    0  305 20208.2643 27269.4959  34.9%     -  689s
     0     0 27264.3058    0  297 20208.2643 27264.3058  34.9%     -  698s
H    0     0                    20297.143298 27263.2821  34.3%     -  702s
     0     0 27263.2821    0  282 20297.1433 27263.2821  34.3%     -  704s
     0     0 27262.8638    0  239 20297.1433 27262.8638  34.3%     -  706s
     0     0 27261.2085    0  239 20297.1433 27261.2085  34.3%     -  707s
     0     0 27258.5635    0  286 20297.1433 27258.5635  34.3%     -  715s
     0     0 27258.3233    0  286 20297.1433 27258.3233  34.3%     -  726s
H    0     0                    20356.295783 27258.3233  33.9%     -  826s
H    0     0                    20458.990694 27258.3233  33.2%     -  827s
H    0     0                    20471.449599 27258.3233  33.2%     -  831s
H    0     0                    20480.604515 27258.3233  33.1%     -  831s
H    0     2                    20500.978116 27258.3233  33.0%     -  852s
     0     2 27258.3233    0  286 20500.9781 27258.3233  33.0%     -  852s
     1     4 27094.6287    1  337 20500.9781 27258.0178  33.0% 14074  874s
     3     8 27070.1494    2  337 20500.9781 27093.3351  32.2% 13477  889s
     7    16 26849.7904    3  345 20500.9781 27069.7676  32.0% 10832  911s
    15    32 26796.3097    4  348 20500.9781 26849.5129  31.0% 13050  930s
    31    48 26567.4852    5  363 20500.9781 26794.4224  30.7% 18831  980s
    47    74 23700.9991    6  268 20500.9781 26794.4224  30.7% 21909 1023s
H   60    74                    20584.741804 26794.4224  30.2% 20570 1023s
    73   109 24886.7314    7  278 20584.7418 26794.4224  30.2% 19645 1066s
H   74   109                    20598.230385 26794.4224  30.1% 19379 1066s
H   75   109                    20607.500936 26794.4224  30.0% 19418 1066s
H   81   109                    20618.233629 26794.4224  30.0% 18984 1066s
   108   199 24278.5855    8  266 20618.2336 26794.4224  30.0% 15539 1100s
   198   315 24164.4282   11  268 20618.2336 26794.4224  30.0% 12237 1129s
   314   368 23475.1690   15  256 20618.2336 26794.4224  30.0%  9928 1149s
   374   419 22449.4438   16  230 20618.2336 26794.4224  30.0%  9586 1182s
   433   458 21212.4208   20  213 20618.2336 26794.4224  30.0%  9546 1198s
   496   505 21840.4094   17  179 20618.2336 26794.4224  30.0%  9391 1217s
   569   536 21770.7857   18  176 20618.2336 26794.4224  30.0%  9090 1241s
   626   562 21658.8761   20  184 20618.2336 26794.4224  30.0%  8903 1258s
   696   600 21489.1117   24  167 20618.2336 26794.4224  30.0%  8628 1277s
   772   635     cutoff   28      20618.2336 26794.4224  30.0%  8390 1294s
   849   652 21386.6197   27  168 20618.2336 26794.4224  30.0%  8038 1320s
   899   686 20741.8757   28  136 20618.2336 26794.4224  30.0%  7885 1337s
   979   718 infeasible   29      20618.2336 26794.4224  30.0%  7660 1355s
  1069   766 21179.3017   30  188 20618.2336 26794.4224  30.0%  7405 1374s
  1155   824 21114.6291   35  176 20618.2336 26794.4224  30.0%  7291 1392s
  1256   843 20908.5870   40  131 20618.2336 26794.4224  30.0%  7008 1411s
  1365   878 21261.9473   15  261 20618.2336 26794.4224  30.0%  6833 1432s
  1457   926 20770.6715   14  186 20618.2336 26794.4224  30.0%  6767 1454s
  1557   971 20759.8109   15  177 20618.2336 26794.4224  30.0%  6744 1476s
  1647   976     cutoff   22      20618.2336 26794.4224  30.0%  6657 1507s
  1729  1023 20993.2828   18  273 20618.2336 26794.4224  30.0%  6727 1528s
  1823  1057 infeasible   20      20618.2336 26794.4224  30.0%  6695 1549s
  1908  1095 20774.1744   19  308 20618.2336 26794.4224  30.0%  6728 1575s
  2007  1125 22611.6914   15  340 20618.2336 26794.4224  30.0%  6757 1598s
  2118  1145 22159.6124   12  227 20618.2336 26794.4224  30.0%  6704 1622s
  2213  1165 21814.9759   16  205 20618.2336 26794.4224  30.0%  6731 1649s
  2303  1206 21402.3073   19  216 20618.2336 26794.4224  30.0%  6829 1680s
  2383  1252 20895.8956   23  207 20618.2336 26794.4224  30.0%  7002 1709s
  2447  1309 infeasible   26      20618.2336 26794.4224  30.0%  7156 1735s
  2548  1389 23100.4021   10  297 20618.2336 26794.4224  30.0%  7273 1763s
  2680  1461 22836.9438   11  291 20618.2336 26794.4224  30.0%  7285 1791s
  2851  1519 22810.1206   12  288 20618.2336 26714.3774  29.6%  7201 1824s
  3013  1587 21729.9248   16  275 20618.2336 26714.3774  29.6%  7234 1855s
  3175  1674 21226.6722   19  258 20618.2336 26714.3774  29.6%  7308 1889s
  3348  1756 20831.9200   22  283 20618.2336 26714.3774  29.6%  7351 1923s
  3527  1835 24408.4684    8  337 20618.2336 26714.3774  29.6%  7377 1959s
  3700  1889 22438.7605   11  178 20618.2336 26714.3774  29.6%  7407 1997s
  3852  1906 21062.0478   16   97 20618.2336 26291.5046  27.5%  7490 2040s
H 3890  1905                    20624.036549 26291.5046  27.5%  7537 2040s
  3926  1992 20842.4106   18  150 20624.0365 26291.5046  27.5%  7564 2082s
  4059  2011 20676.6545   25  248 20624.0365 26291.5046  27.5%  7699 2122s
  4104  2029     cutoff   26      20624.0365 25829.8263  25.2%  7779 2157s
  4148  2065 25210.2397    7  358 20624.0365 25829.8263  25.2%  7863 2191s
  4193  2096 24959.9432    9  357 20624.0365 25829.8263  25.2%  7904 2229s
  4226  2138 24550.5468   10  348 20624.0365 25612.4594  24.2%  7972 2270s
  4297  2139 21407.4929   22  286 20624.0365 25612.4594  24.2%  8025 2525s
  4299  2140 22664.9913   11  149 20624.0365 25612.4594  24.2%  8021 2543s
  4300  2141 22614.1845   14  298 20624.0365 25612.4594  24.2%  8019 2628s
  4301  2142 22528.3719   13  350 20624.0365 25612.4594  24.2%  8017 2701s
  4302  2142 21267.8600   41  389 20624.0365 25612.4594  24.2%  8016 2758s
  4303  2143 20698.8766   47  352 20624.0365 25612.4594  24.2%  8014 2794s
  4304  2144 24277.6954    6  353 20624.0365 25612.4594  24.2%  8012 2821s
  4305  2144 22792.9108   11  354 20624.0365 25612.4594  24.2%  8010 2837s
  4306  2145 21720.0904   21  356 20624.0365 25612.4594  24.2%  8008 2850s
  4307  2146 23468.6863   14  346 20624.0365 25612.4594  24.2%  8006 2862s
  4308  2146 23763.1856   10  355 20624.0365 25612.4594  24.2%  8004 2868s
  4309  2147 23727.2292   11  346 20624.0365 25612.4594  24.2%  8003 2876s
  4310  2148 23646.9004    8  346 20624.0365 25612.4594  24.2%  8001 2905s
  4311  2148 21626.1600   16  343 20624.0365 25612.4594  24.2%  7999 2920s
  4312  2149 20975.6378   44  354 20624.0365 25612.4594  24.2%  7997 2930s
  4313  2150 20879.8460   14  360 20624.0365 25612.4594  24.2%  7995 2954s
  4314  2150 21922.0628   17  350 20624.0365 25612.4594  24.2%  7993 2961s
  4315  2151 23564.3823   14  343 20624.0365 25612.4594  24.2%  7991 2967s
  4316  2152 21031.0804   34  342 20624.0365 25612.4594  24.2%  7990 2996s
  4317  2152 22220.9469   19  284 20624.0365 25612.4594  24.2%  7988 3006s
  4318  2153 22837.9365   13  284 20624.0365 25612.4594  24.2%  7986 3013s
  4319  2154 22846.9805   11  375 20624.0365 25612.4594  24.2%  7984 3022s
  4320  2154 22979.8587   17  359 20624.0365 25612.4594  24.2%  7982 3046s
  4321  2155 22097.1128   16  296 20624.0365 25612.4594  24.2%  7980 3052s
  4322  2156 24081.1446   12  297 20624.0365 25612.4594  24.2%  7979 3058s
  4323  2156 20652.0508   41  248 20624.0365 25612.4594  24.2%  7977 3067s
  4324  2157 20820.8019   44  251 20624.0365 25612.4594  24.2%  7975 3073s
  4325  2158 21753.2214   12  354 20624.0365 25612.4594  24.2%  7973 3094s
  4326  2158 20766.9578   41  368 20624.0365 25612.4594  24.2%  7971 3103s
  4327  2159 21248.9505   35  369 20624.0365 25612.4594  24.2%  7969 3121s
  4328  2160 23031.0744   16  352 20624.0365 25612.4594  24.2%  7967 3132s
  4329  2160 23686.1673    7  359 20624.0365 25612.4594  24.2%  7966 3152s
  4330  2161 20948.1028   24  368 20624.0365 25612.4594  24.2%  7964 3161s
  4331  2162 21415.7793   17  361 20624.0365 25612.4594  24.2%  7962 3177s
  4332  2162 20683.9562   24  363 20624.0365 25612.4594  24.2%  7960 3187s
  4333  2163 20928.4451   21  351 20624.0365 25612.4594  24.2%  7958 3202s
  4334  2164 22506.9346   14  351 20624.0365 25612.4594  24.2%  7956 3221s
  4335  2164 21588.7713   18  351 20624.0365 25612.4594  24.2%  7955 3270s
  4336  2167 25612.4594   15  350 20624.0365 25612.4594  24.2%  8062 3323s
  4337  2169 25612.4594   16  350 20624.0365 25612.4594  24.2%  8063 3346s
  4339  2173 25612.4594   16  276 20624.0365 25612.4594  24.2%  8065 3418s
  4344  2180 24509.8509   17  347 20624.0365 25612.4594  24.2%  8070 3493s
  4353  2185 24351.2785   18  324 20624.0365 25612.4594  24.2%  8107 3600s

Cutting planes:
  Gomory: 17
  Implied bound: 5
  Projected implied bound: 235
  MIR: 1127
  Flow cover: 1782
  RLT: 11
  Relax-and-lift: 192

Explored 4361 nodes (36008524 simplex iterations) in 3600.07 seconds (9610.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20624 20618.2 20607.5 ... 20356.3

Time limit reached
Best objective 2.062403654942e+04, best bound 2.560689034959e+04, gap 24.1604%
  WARNING: Time limit reached. Using best solution found (gap: 24.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 20624.04, θ = 141130.94
  Upper Bound (UB) = 20624.04

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141130.94
  [DEBUG]   ✓ Scenario 0: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141130.94 ≤ Q = 141130.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141130.94 ≤ Q = 141130.94 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x153d4d7a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeac2b286
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7514406.9941
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.354766e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135476.57    0  123 7514406.99 -135476.57   102%     -    0s
H    0     0                    -100581.7792 -135476.57  34.7%     -    0s
     0     0 -106674.97    0  129 -100581.78 -106674.97  6.06%     -    0s
H    0     0                    -104558.5300 -106670.78  2.02%     -    0s
H    0     0                    -104566.2535 -106670.78  2.01%     -    0s
     0     0 -105966.77    0   83 -104566.25 -105966.77  1.34%     -    0s
     0     0 -105931.99    0   84 -104566.25 -105931.99  1.31%     -    0s
     0     0 -105593.36    0  105 -104566.25 -105593.36  0.98%     -    0s
     0     0 -105565.41    0  103 -104566.25 -105565.41  0.96%     -    0s
     0     0 -105564.00    0  103 -104566.25 -105564.00  0.95%     -    0s
     0     0 -105416.17    0   88 -104566.25 -105416.17  0.81%     -    0s
     0     0 -105377.28    0  104 -104566.25 -105377.28  0.78%     -    0s
     0     0 -105377.08    0  104 -104566.25 -105377.08  0.78%     -    0s
     0     0 -105129.60    0   82 -104566.25 -105129.60  0.54%     -    0s
     0     0 -105077.23    0   90 -104566.25 -105077.23  0.49%     -    0s
     0     0 -105046.74    0   90 -104566.25 -105046.74  0.46%     -    0s
     0     0 -105045.66    0   90 -104566.25 -105045.66  0.46%     -    0s
H    0     0                    -104594.7026 -105045.38  0.43%     -    0s
     0     2 -105045.38    0   90 -104594.70 -105045.38  0.43%     -    0s
H   28    18                    -104605.1960 -104845.54  0.23%  19.3    0s
H  548    62                    -104614.4155 -104720.51  0.10%   5.6    0s
*  723    26              33    -104616.3470 -104688.89  0.07%   5.1    0s
*  724    26              30    -104621.9533 -104688.89  0.06%   5.1    0s
*  796    14              29    -104631.6820 -104684.36  0.05%   4.9    0s
*  814     0              29    -104632.4467 -104684.36  0.05%   4.9    0s

Cutting planes:
  Gomory: 40
  Implied bound: 5
  MIR: 202
  Flow cover: 7
  RLT: 2
  BQP: 2

Explored 823 nodes (4731 simplex iterations) in 0.12 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104632 -104632 -104622 ... -100582
No other solutions better than -104632

Optimal solution found (tolerance 1.00e-04)
Best objective -1.046324466963e+05, best bound -1.046324466963e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 140086.34
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104632.45
  [DEBUG]   S×d_nominal = 244718.79
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244718.79 + -104632.45 = 140086.34
  [DEBUG]   Current θ from Master = 141130.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1044.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19579.44
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 780.0997, Absolute Gap = 780.0997, Relative Gap = 0.037825
  Not converged yet (gap = 780.10 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 1000039 nonzeros
Model fingerprint: 0x4cccfb2f
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 155641 rows and 63181 columns
Presolve time: 4.26s
Presolved: 197412 rows, 82599 columns, 1214487 nonzeros
Variable types: 80340 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.62s

Barrier statistics:
 Dense cols : 1221
 AA' NZ     : 4.960e+06
 Factor NZ  : 1.410e+07 (roughly 230 MB of memory)
 Factor Ops : 5.145e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.94484617e+07  3.17908493e+08  1.12e+05 1.61e+01  7.40e+04     8s
   1  -1.49840836e+07  2.76392434e+08  7.97e+04 5.53e+01  5.23e+04     8s
   2  -4.88737707e+06  2.17703675e+08  2.58e+04 1.16e+00  1.80e+04     8s
   3  -9.32263351e+05  1.68617733e+08  1.87e+03 1.81e+00  1.70e+03     8s
   4  -6.17174848e+05  1.04398881e+08  5.31e+02 9.76e-01  6.13e+02     8s
   5  -5.45745407e+05  8.73175676e+07  3.00e+02 7.73e-01  4.19e+02     8s
   6  -4.74880524e+05  5.45237213e+07  9.39e+01 4.30e-01  2.02e+02     8s
   7  -4.42075346e+05  3.75170772e+07  4.17e+01 2.82e-01  1.24e+02     8s
   8  -3.81674762e+05  3.05197004e+07  1.44e+01 2.25e-01  9.18e+01     8s
   9  -2.87048661e+05  1.66454838e+07  3.25e+00 1.18e-01  4.80e+01     8s
  10  -1.48610219e+05  6.33006092e+06  6.56e-01 4.17e-02  1.81e+01     9s
  11  -1.23989089e+05  4.35607142e+06  4.62e-01 2.87e-02  1.25e+01     9s
  12  -1.05299241e+05  3.20462836e+06  3.32e-01 2.10e-02  9.23e+00     9s
  13  -1.00424133e+05  2.86432529e+06  2.98e-01 1.88e-02  8.27e+00     9s
  14  -8.69273708e+04  2.03934950e+06  2.36e-01 1.34e-02  5.93e+00     9s
  15  -6.66505142e+04  1.54525095e+06  1.48e-01 1.03e-02  4.49e+00     9s
  16  -3.91049875e+04  6.13507850e+05  5.68e-02 3.80e-03  1.82e+00     9s
  17  -1.58859080e+04  2.85622042e+05  2.82e-02 1.80e-03  8.39e-01     9s
  18  -8.02390929e+03  2.07015564e+05  2.22e-02 1.38e-03  5.99e-01     9s
  19  -1.45883079e+03  1.63377722e+05  1.87e-02 1.29e-03  4.59e-01     9s
  20   3.22321351e+03  1.10289870e+05  1.62e-02 1.09e-03  2.98e-01     9s
  21   9.62049771e+03  9.60094267e+04  1.31e-02 8.51e-04  2.41e-01     9s
  22   1.33136536e+04  8.56618992e+04  1.13e-02 7.02e-04  2.01e-01     9s
  23   1.71159244e+04  7.29859338e+04  9.53e-03 5.11e-04  1.56e-01     9s
  24   2.07854049e+04  6.65092433e+04  7.90e-03 4.09e-04  1.27e-01    10s
  25   2.23003764e+04  6.12155940e+04  7.24e-03 3.28e-04  1.08e-01    10s
  26   2.67538964e+04  5.80167172e+04  5.34e-03 2.76e-04  8.70e-02    10s
  27   2.84950313e+04  5.36778659e+04  4.67e-03 2.05e-04  7.01e-02    10s
  28   3.06761061e+04  5.09850113e+04  3.85e-03 1.59e-04  5.66e-02    10s
  29   3.20545355e+04  4.99793892e+04  3.34e-03 1.42e-04  4.99e-02    10s
  30   3.51259525e+04  4.82318376e+04  2.21e-03 1.18e-04  3.65e-02    10s
  31   3.56345743e+04  4.59821979e+04  2.03e-03 7.89e-05  2.88e-02    10s
  32   3.69626435e+04  4.47528863e+04  1.57e-03 5.52e-05  2.17e-02    10s
  33   3.81099294e+04  4.36470841e+04  1.18e-03 3.43e-05  1.54e-02    10s
  34   3.89709704e+04  4.29436868e+04  9.00e-04 2.12e-05  1.11e-02    10s
  35   3.94767364e+04  4.26544018e+04  7.37e-04 1.53e-05  8.85e-03    11s
  36   4.00403706e+04  4.25306681e+04  5.56e-04 1.29e-05  6.93e-03    11s
  37   4.05763043e+04  4.22228842e+04  3.86e-04 1.51e-05  4.59e-03    11s
  38   4.07772076e+04  4.20772376e+04  3.23e-04 3.37e-05  3.62e-03    11s
  39   4.12061785e+04  4.20024813e+04  1.91e-04 1.81e-05  2.22e-03    11s
  40   4.15791963e+04  4.19406695e+04  7.24e-05 9.88e-06  1.01e-03    11s
  41   4.16128052e+04  4.18870754e+04  6.35e-05 3.15e-06  7.64e-04    11s
  42   4.17318390e+04  4.18766791e+04  3.07e-05 1.71e-06  4.03e-04    11s
  43   4.17455779e+04  4.18718713e+04  2.71e-05 1.32e-06  3.52e-04    11s
  44   4.17839393e+04  4.18638678e+04  1.74e-05 7.26e-07  2.23e-04    11s
  45   4.17979750e+04  4.18577970e+04  1.39e-05 2.63e-07  1.67e-04    11s
  46   4.18459539e+04  4.18564752e+04  1.49e-06 2.05e-07  2.93e-05    12s
  47   4.18517341e+04  4.18537903e+04  3.45e-07 1.27e-08  5.73e-06    12s
  48   4.18535658e+04  4.18535844e+04  3.57e-09 5.43e-08  5.18e-08    12s
  49   4.18535832e+04  4.18535833e+04  3.91e-09 8.86e-11  4.41e-10    12s

Barrier solved model in 49 iterations and 11.73 seconds (19.47 work units)
Optimal objective 4.18535832e+04


Root crossover log...

  174409 DPushes remaining with DInf 0.0000000e+00                12s
   32644 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   10739 PPushes remaining with PInf 1.1881512e-04                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8884418e+00     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   94090    4.1853583e+04   0.000000e+00   1.888442e+00     20s
   94117    4.1853583e+04   0.000000e+00   0.000000e+00     20s
   94117    4.1853583e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 3.31s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185358e+04, 94117 iterations, 17.89 seconds (34.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41853.5833    0  194 -208513.72 41853.5833   120%     -   24s
H    0     0                    -184731.0270 41853.5833   123%     -   25s
H    0     0                    -182892.5994 41853.5833   123%     -   25s
H    0     0                    -161247.4090 41853.5833   126%     -   26s
H    0     0                    -161010.4295 41853.5833   126%     -   27s
H    0     0                    -156787.8622 41853.5833   127%     -   29s
H    0     0                    -155405.5115 41853.5833   127%     -   29s
H    0     0                    -153157.6979 41853.5833   127%     -   29s
H    0     0                    -152909.0788 41853.5833   127%     -   30s
H    0     0                    -152171.6150 41853.5833   128%     -   30s
H    0     0                    -151301.8104 41853.5833   128%     -   30s
H    0     0                    -151297.1354 41853.5833   128%     -   30s
H    0     0                    -9147.301886 41853.5833   558%     -   30s
H    0     0                    3584.2158410 41853.5833  1068%     -   31s
H    0     0                    3922.9271335 41853.5833   967%     -   31s
H    0     0                    3948.5114116 41853.5833   960%     -   31s
H    0     0                    4054.9885411 41853.5833   932%     -   31s
H    0     0                    4060.5018376 41853.5833   931%     -   31s
     0     0 36684.1234    0  274 4060.50184 36684.1234   803%     -   83s
H    0     0                    6729.3098418 36683.8150   445%     -   85s
H    0     0                    7298.2646122 36683.8150   403%     -   85s
H    0     0                    15104.200160 36683.8150   143%     -   85s
H    0     0                    15531.965955 36683.8150   136%     -   85s
H    0     0                    15649.767250 36683.8150   134%     -   85s
H    0     0                    15798.890565 36683.8150   132%     -   85s
H    0     0                    15805.730771 36683.8150   132%     -   85s
     0     0 36321.2282    0  286 15805.7308 36321.2282   130%     -  101s
     0     0 36281.6831    0  291 15805.7308 36281.6831   130%     -  118s
     0     0 35830.6299    0  295 15805.7308 35830.6299   127%     -  130s
     0     0 35794.7391    0  300 15805.7308 35794.7391   126%     -  138s
     0     0 35794.6958    0  300 15805.7308 35794.6958   126%     -  138s
     0     0 31962.5373    0  294 15805.7308 31962.5373   102%     -  190s
H    0     0                    17915.911485 31962.0049  78.4%     -  190s
H    0     0                    18242.727711 31962.0049  75.2%     -  191s
H    0     0                    18331.967544 31962.0049  74.4%     -  191s
H    0     0                    18706.978788 31962.0049  70.9%     -  191s
H    0     0                    18755.241059 31962.0049  70.4%     -  191s
H    0     0                    18800.353108 31962.0049  70.0%     -  191s
H    0     0                    18818.896597 31962.0049  69.8%     -  191s
H    0     0                    18856.960677 31962.0049  69.5%     -  191s
H    0     0                    18901.647424 31962.0049  69.1%     -  191s
H    0     0                    18911.674106 31962.0049  69.0%     -  191s
H    0     0                    18924.661509 31962.0049  68.9%     -  191s
     0     0 31541.7007    0  325 18924.6615 31541.7007  66.7%     -  219s
     0     0 31248.0319    0  250 18924.6615 31248.0319  65.1%     -  245s
     0     0 31115.5987    0  321 18924.6615 31115.5987  64.4%     -  265s
     0     0 31023.8184    0  324 18924.6615 31023.8184  63.9%     -  277s
     0     0 30916.1551    0  324 18924.6615 30916.1551  63.4%     -  290s
     0     0 30877.8313    0  328 18924.6615 30877.8313  63.2%     -  300s
     0     0 30876.1376    0  329 18924.6615 30876.1376  63.2%     -  303s
     0     0 30872.2337    0  346 18924.6615 30872.2337  63.1%     -  305s
     0     0 30871.5877    0  346 18924.6615 30871.5877  63.1%     -  307s
     0     0 29342.5255    0  253 18924.6615 29342.5255  55.0%     -  351s
     0     0 28882.9347    0  340 18924.6615 28882.9347  52.6%     -  378s
     0     0 28821.1247    0  279 18924.6615 28821.1247  52.3%     -  388s
     0     0 28805.2980    0  280 18924.6615 28805.2980  52.2%     -  392s
     0     0 28763.1876    0  276 18924.6615 28763.1876  52.0%     -  398s
     0     0 28759.2944    0  275 18924.6615 28759.2944  52.0%     -  401s
     0     0 28698.5016    0  281 18924.6615 28698.5016  51.6%     -  411s
     0     0 28633.6230    0  344 18924.6615 28633.6230  51.3%     -  421s
     0     0 28627.3832    0  343 18924.6615 28627.3832  51.3%     -  426s
     0     0 28578.8186    0  352 18924.6615 28578.8186  51.0%     -  434s
     0     0 28573.2611    0  349 18924.6615 28573.2611  51.0%     -  439s
     0     0 28565.6221    0  341 18924.6615 28565.6221  50.9%     -  442s
     0     0 28561.5507    0  352 18924.6615 28561.5507  50.9%     -  447s
     0     0 28559.9853    0  347 18924.6615 28559.9853  50.9%     -  449s
     0     0 27756.9256    0  399 18924.6615 27756.9256  46.7%     -  496s
H    0     0                    18951.928225 27755.9716  46.5%     -  497s
H    0     0                    19029.912882 27755.9716  45.9%     -  497s
     0     0 27581.5272    0  404 19029.9129 27581.5272  44.9%     -  516s
     0     0 27539.7446    0  390 19029.9129 27539.7446  44.7%     -  524s
     0     0 27523.3407    0  389 19029.9129 27523.3407  44.6%     -  531s
     0     0 27516.3074    0  404 19029.9129 27516.3074  44.6%     -  537s
     0     0 27509.8282    0  409 19029.9129 27509.8282  44.6%     -  540s
     0     0 27497.5476    0  405 19029.9129 27497.5476  44.5%     -  545s
     0     0 27492.7380    0  404 19029.9129 27492.7380  44.5%     -  550s
     0     0 27491.9662    0  405 19029.9129 27491.9662  44.5%     -  552s
     0     0 27377.3853    0  338 19029.9129 27377.3853  43.9%     -  572s
     0     0 27375.8166    0  346 19029.9129 27375.8166  43.9%     -  579s
     0     0 27351.0332    0  340 19029.9129 27351.0332  43.7%     -  594s
H    0     0                    19473.397627 27351.0281  40.5%     -  595s
H    0     0                    19493.496836 27351.0281  40.3%     -  595s
     0     0 27348.0082    0  335 19493.4968 27348.0082  40.3%     -  601s
     0     0 27342.8337    0  285 19493.4968 27342.8337  40.3%     -  609s
     0     0 27342.8154    0  289 19493.4968 27342.8154  40.3%     -  610s
     0     0 27339.2216    0  345 19493.4968 27339.2216  40.2%     -  619s
H    0     0                    19535.584661 27335.0999  39.9%     -  620s
     0     0 27335.0999    0  288 19535.5847 27335.0999  39.9%     -  625s
     0     0 27335.0999    0  281 19535.5847 27335.0999  39.9%     -  626s
     0     0 27304.1613    0  364 19535.5847 27304.1613  39.8%     -  639s
H    0     0                    19564.698921 27300.3151  39.5%     -  640s
H    0     0                    19756.580815 27300.3151  38.2%     -  640s
H    0     0                    19807.070543 27300.3151  37.8%     -  640s
H    0     0                    19813.425031 27300.3151  37.8%     -  640s
H    0     0                    19831.931018 27300.3151  37.7%     -  640s
H    0     0                    19835.203214 27300.3151  37.6%     -  640s
H    0     0                    19858.948283 27300.3151  37.5%     -  641s
     0     0 27270.5715    0  330 19858.9483 27270.5715  37.3%     -  650s
     0     0 27266.4534    0  369 19858.9483 27266.4534  37.3%     -  654s
     0     0 27266.4490    0  369 19858.9483 27266.4490  37.3%     -  655s
     0     0 27254.1034    0  374 19858.9483 27254.1034  37.2%     -  664s
     0     0 27253.4570    0  367 19858.9483 27253.4570  37.2%     -  669s
     0     0 27251.6960    0  367 19858.9483 27251.6960  37.2%     -  673s
     0     0 27250.4772    0  361 19858.9483 27250.4772  37.2%     -  675s
     0     0 27250.4772    0  361 19858.9483 27250.4772  37.2%     -  678s
     0     0 27250.4772    0  359 19858.9483 27250.4772  37.2%     -  680s
     0     0 27250.4772    0  362 19858.9483 27250.4772  37.2%     -  684s
     0     0 27249.6088    0  362 19858.9483 27249.6088  37.2%     -  696s
H    0     0                    19890.733183 27249.6088  37.0%     -  717s
H    0     0                    19925.504049 27249.6088  36.8%     -  717s
H    0     0                    19994.495267 27249.6088  36.3%     -  774s
H    0     0                    20117.828304 27249.6088  35.5%     -  775s
H    0     0                    20147.997432 27249.6088  35.2%     -  782s
     0     2 27249.6088    0  362 20147.9974 27249.6088  35.2%     -  792s
     1     3 26812.8837    1  316 20147.9974 27249.3491  35.2% 12325  805s
     2     4 26930.5528    1  361 20147.9974 26930.5528  33.7% 12578  824s
     3     8 26110.0199    2  288 20147.9974 26929.7512  33.7% 16493  851s
     7    16 25944.5504    3  295 20147.9974 26666.9808  32.4% 13182  894s
    15    32 25687.3630    4  278 20147.9974 26582.1785  31.9% 15866  914s
    31    48 24604.9962    5  296 20147.9974 26267.9789  30.4% 20910  978s
    47    77 23782.3779    6  273 20147.9974 26267.9789  30.4% 25437 1031s
H   50    77                    20254.833111 26267.9789  29.7% 24725 1031s
H   52    77                    20286.734769 26267.9789  29.5% 24136 1031s
H   53    77                    20393.071887 26267.9789  28.8% 23833 1031s
H   71    77                    20397.876258 26267.9789  28.8% 20005 1031s
    76   207 24649.3922    7  338 20397.8763 26267.9789  28.8% 19487 1071s
   210   253 24477.8254   10  316 20397.8763 26267.9789  28.8% 12488 1090s
H  223   253                    20412.529954 26267.9789  28.7% 12120 1090s
H  236   253                    20420.702826 26267.9789  28.6% 11804 1090s
   264   311 24609.8864    8  330 20420.7028 26267.9789  28.6% 11541 1108s
   337   343 24259.3626   11  312 20420.7028 26267.9789  28.6% 10792 1129s
   392   372     cutoff   21      20420.7028 26267.9789  28.6% 10354 1147s
   437   385 23847.4150   12  327 20420.7028 26267.9789  28.6% 10337 1167s
   468   413 23503.7820   13  254 20420.7028 26267.9789  28.6% 10381 1196s
H  512   413                    20444.475385 26267.9789  28.5% 10141 1196s
   520   427     cutoff   14      20444.4754 26267.9789  28.5% 10163 1217s
   558   469 21345.1730   15  302 20444.4754 26267.9789  28.5%  9950 1234s
   617   515 21191.6235   18  292 20444.4754 26267.9789  28.5%  9479 1252s
   701   541 21384.9099   26  251 20444.4754 26267.9789  28.5%  8849 1269s
   767   561 20753.5074   23  185 20444.4754 26267.9789  28.5%  8625 1287s
   826   580 infeasible   27      20444.4754 26267.9789  28.5%  8372 1305s
   904   638 20755.3653   25  237 20444.4754 26267.9789  28.5%  8094 1324s
H 1017   663                    20484.207331 26267.9789  28.2%  7604 1342s
  1089   680 infeasible   28      20484.2073 26267.9789  28.2%  7325 1363s
  1209   674     cutoff   29      20484.2073 26267.9789  28.2%  6997 1384s
  1270   704 infeasible   11      20484.2073 26267.9789  28.2%  6913 1408s
  1331   727 21585.3786   15  209 20484.2073 26267.9789  28.2%  6882 1430s
  1399   755 21416.4521   16  208 20484.2073 26267.9789  28.2%  6969 1450s
  1473   785 21113.1546   19  265 20484.2073 26267.9789  28.2%  6984 1471s
  1558   807 20823.9062   21  136 20484.2073 26267.9789  28.2%  7043 1494s
  1668   836 20768.2448   23  177 20484.2073 26267.9789  28.2%  6876 1518s
  1750   844 infeasible   26      20484.2073 26267.9789  28.2%  6979 1541s
  1792   870 21168.5568   28  260 20484.2073 26267.9789  28.2%  7121 1567s
H 1836   870                    20486.215056 26267.9789  28.2%  7199 1567s
  1846   940 infeasible   26      20486.2151 26267.9789  28.2%  7216 1593s
  1967  1019 21422.3165   12  363 20486.2151 26267.9789  28.2%  7091 1617s
  2090  1116 20679.1719   13  183 20486.2151 26267.9789  28.2%  6982 1642s
H 2118  1116                    20503.594766 26267.9789  28.1%  6979 1642s
  2245  1149 infeasible   14      20503.5948 26267.9789  28.1%  6835 1668s
H 2273  1149                    20520.462429 26267.9789  28.0%  6852 1668s
H 2321  1149                    20547.181351 26267.9789  27.8%  6811 1668s
  2365  1217     cutoff   10      20547.1814 26267.9789  27.8%  6784 1696s
  2515  1312 20849.2366   24  220 20547.1814 26267.9789  27.8%  6787 1725s
  2668  1365 infeasible   39      20547.1814 26267.9789  27.8%  6712 1754s
  2800  1486 21993.2875    8  195 20547.1814 26267.9789  27.8%  6766 1787s
  2974  1574 infeasible   13      20547.1814 26267.9789  27.8%  6785 1820s
  3181  1600 20625.4404   22  115 20547.1814 26267.9789  27.8%  6761 1854s
H 3202  1600                    20549.121622 26267.9789  27.8%  6749 1854s
H 3209  1600                    20550.942107 26267.9789  27.8%  6749 1854s
H 3224  1600                    20555.634308 26267.9789  27.8%  6766 1854s
  3273  1677 21513.0077   14  128 20555.6343 26267.9789  27.8%  6829 1888s
  3441  1685 20962.6315   21  143 20555.6343 26267.9789  27.8%  6841 1918s
H 3456  1685                    20557.206925 26007.0954  26.5%  6845 1918s
  3493  1783 20780.6521   22  139 20557.2069 26007.0954  26.5%  6924 1953s
  3714  1793     cutoff   35      20557.2069 26007.0954  26.5%  6907 1993s
  3871  1837 21485.3944   12  222 20557.2069 26007.0954  26.5%  6991 2034s
  4013  1877 infeasible   16      20557.2069 26007.0954  26.5%  7108 2074s
  4027  1877 21530.8133   12  219 20557.2069 26007.0954  26.5%  7108 2075s
  4175  1944 infeasible   42      20557.2069 23996.1484  16.7%  7174 2116s
  4352  1984 23646.0422    7  328 20557.2069 23996.1484  16.7%  7242 2162s
H 4369  1974                    20566.192097 23996.1484  16.7%  7230 2162s
H 4443  1972                    20568.281133 23996.1484  16.7%  7269 2162s
  4493  2078 23286.4977    8  229 20568.2811 23996.1484  16.7%  7261 2207s
  4730  2188 22931.8631   11  299 20568.2811 23996.1484  16.7%  7247 2259s
  4948  2189 20822.4177   24  362 20568.2811 23645.0672  15.0%  7263 2580s
H 4949  2080                    20595.770411 23645.0672  14.8%  7261 2602s
  4950  2080 21368.3393   15  144 20595.7704 23645.0672  14.8%  7260 2605s
  4951  2081 20672.6586   10  345 20595.7704 23645.0672  14.8%  7258 2708s
  4952  2082 20894.1597   29  310 20595.7704 23645.0672  14.8%  7257 2778s
  4953  2082 21768.5066   10  329 20595.7704 23645.0672  14.8%  7255 2813s
  4954  2083 21682.7901   14  333 20595.7704 23645.0672  14.8%  7254 2851s
  4955  2084 20734.5592    9  331 20595.7704 23645.0672  14.8%  7252 2873s
  4956  2084 22758.7352    8  344 20595.7704 23645.0672  14.8%  7251 2887s
  4957  2085 20595.7704   36  349 20595.7704 23645.0672  14.8%  7249 2901s
  4958  2086 20800.8995   21  337 20595.7704 23645.0672  14.8%  7248 2912s
  4959  2086 21273.5475   16  330 20595.7704 23645.0672  14.8%  7246 2946s
  4960  2087 21262.6199   20  322 20595.7704 23645.0672  14.8%  7245 2960s
  4961  2088 20819.5484   30  333 20595.7704 23645.0672  14.8%  7244 2979s
  4962  2088 20740.3072   40  331 20595.7704 23645.0672  14.8%  7242 2991s
  4963  2089 21242.5627   13  334 20595.7704 23645.0672  14.8%  7241 2999s
  4964  2090 21262.6199   20  334 20595.7704 23645.0672  14.8%  7239 3032s
  4965  2090 22629.7373   14  343 20595.7704 23645.0672  14.8%  7238 3043s
  4966  2091 21165.9763   17  348 20595.7704 23645.0672  14.8%  7236 3051s
  4967  2092 21613.7319   24  349 20595.7704 23645.0672  14.8%  7235 3058s
  4968  2092 20965.6947   20  348 20595.7704 23645.0672  14.8%  7233 3080s
  4969  2093 22058.9599   17  344 20595.7704 23645.0672  14.8%  7232 3097s
  4970  2094 20862.0572   26  354 20595.7704 23645.0672  14.8%  7230 3108s
  4971  2094 21723.7038   22  351 20595.7704 23645.0672  14.8%  7229 3115s
  4972  2095 23202.1409    9  367 20595.7704 23645.0672  14.8%  7228 3140s
  4973  2096 20790.1793   30  423 20595.7704 23645.0672  14.8%  7226 3154s
  4974  2096 21570.1985   13  425 20595.7704 23645.0672  14.8%  7225 3177s
  4975  2097 21171.6563   19  407 20595.7704 23645.0672  14.8%  7223 3189s
  4976  2098 21175.5066   48  410 20595.7704 23645.0672  14.8%  7222 3205s
  4977  2098 21021.6805   27  378 20595.7704 23645.0672  14.8%  7220 3213s
  4978  2099 22562.2148   10  415 20595.7704 23645.0672  14.8%  7219 3231s
  4979  2100 21633.2520   23  414 20595.7704 23645.0672  14.8%  7217 3240s
  4980  2100 21993.1594   12  376 20595.7704 23645.0672  14.8%  7216 3264s
  4981  2101 21977.0169    8  376 20595.7704 23645.0672  14.8%  7214 3294s
  4982  2102 20921.7380   40  376 20595.7704 23645.0672  14.8%  7213 3395s
  4983  2104 23645.0672   14  331 20595.7704 23645.0672  14.8%  7317 3432s
  4984  2106 23645.0672   15  336 20595.7704 23645.0672  14.8%  7317 3463s
  4986  2109 23645.0672   16  341 20595.7704 23645.0672  14.8%  7316 3508s
  4990  2117 23645.0672   16  341 20595.7704 23645.0672  14.8%  7322 3552s
  4999  2115 23645.0672   18  272 20595.7704 23645.0672  14.8%  7354 3600s

Cutting planes:
  Gomory: 14
  Implied bound: 5
  Projected implied bound: 154
  MIR: 1048
  Flow cover: 1453
  RLT: 13
  Relax-and-lift: 217

Explored 5001 nodes (37448442 simplex iterations) in 3600.07 seconds (9584.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20595.8 20568.3 20566.2 ... 20503.6

Time limit reached
Best objective 2.059577041140e+04, best bound 2.364506723607e+04, gap 14.8055%
  WARNING: Time limit reached. Using best solution found (gap: 14.81%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 20595.77, θ = 141454.36
  Upper Bound (UB) = 20595.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141454.36
  [DEBUG]   ✓ Scenario 0: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141454.36 ≤ Q = 141454.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141454.36 ≤ Q = 141454.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141454.36 ≤ Q = 141454.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141454.36 ≤ Q = 141454.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141454.36 ≤ Q = 141454.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141454.36 ≤ Q = 141454.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141454.36 ≤ Q = 141454.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141454.36 ≤ Q = 141454.36 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x73d41ab1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8c2be54f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7523398.0506
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.349761e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134976.05    0  123 7523398.05 -134976.05   102%     -    0s
H    0     0                    -100040.7018 -134976.05  34.9%     -    0s
     0     0 -106631.55    0   82 -100040.70 -106631.55  6.59%     -    0s
H    0     0                    -104174.9195 -106551.31  2.28%     -    0s
H    0     0                    -104694.2396 -106551.31  1.77%     -    0s
     0     0 -106291.82    0   40 -104694.24 -106291.82  1.53%     -    0s
H    0     0                    -105573.7475 -106289.27  0.68%     -    0s
     0     0 -106266.91    0   37 -105573.75 -106266.91  0.66%     -    0s
H    0     0                    -106004.3409 -106266.91  0.25%     -    0s
     0     0 -106151.93    0   14 -106004.34 -106151.93  0.14%     -    0s
     0     0 -106151.46    0   13 -106004.34 -106151.46  0.14%     -    0s
H    0     0                    -106005.1593 -106121.07  0.11%     -    0s
H    0     0                    -106028.5621 -106090.77  0.06%     -    0s
     0     0 -106090.77    0    6 -106028.56 -106090.77  0.06%     -    0s
     0     0 -106090.21    0    7 -106028.56 -106090.21  0.06%     -    0s
     0     0 -106066.93    0    6 -106028.56 -106066.93  0.04%     -    0s
     0     0 -106066.93    0   15 -106028.56 -106066.93  0.04%     -    0s
     0     0 -106066.93    0   14 -106028.56 -106066.93  0.04%     -    0s
H    0     0                    -106037.6308 -106066.93  0.03%     -    0s
     0     0          -    0      -106037.63 -106043.46  0.01%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 12
  Flow cover: 4
  Relax-and-lift: 2
  PSD: 3

Explored 1 nodes (604 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -106038 -106029 -106005 ... 1.4374e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.060376308112e+05, best bound -1.060434610815e+05, gap 0.0055%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 138485.28
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106037.63
  [DEBUG]   S×d_nominal = 244522.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244522.91 + -106037.63 = 138485.28
  [DEBUG]   Current θ from Master = 141454.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2969.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17626.69
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 751.8336, Absolute Gap = 751.8336, Relative Gap = 0.036504
  Not converged yet (gap = 751.83 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043279 nonzeros
Model fingerprint: 0x857dd48a
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162408 rows and 65928 columns
Presolve time: 4.09s
Presolved: 205935 rows, 86092 columns, 1266719 nonzeros
Variable types: 83833 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356600.0589
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.60s

Barrier statistics:
 Dense cols : 1221
 AA' NZ     : 5.313e+06
 Factor NZ  : 1.518e+07 (roughly 240 MB of memory)
 Factor Ops : 5.702e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.97617295e+07  3.29230192e+08  1.14e+05 1.57e+01  7.48e+04     8s
   1  -1.53012897e+07  2.86222997e+08  8.14e+04 5.53e+01  5.31e+04     8s
   2  -5.44150881e+06  2.25247618e+08  2.88e+04 1.16e+00  1.98e+04     8s
   3  -1.84168497e+06  1.93799442e+08  5.77e+03 8.18e+00  4.33e+03     8s
   4  -8.59408966e+05  1.49259343e+08  8.80e+02 4.67e+00  9.59e+02     8s
   5  -7.70309959e+05  7.44685715e+07  4.57e+02 1.81e+00  4.60e+02     8s
   6  -7.43104450e+05  6.05155521e+07  3.81e+02 1.36e+00  3.71e+02     8s
   7  -4.82705560e+05  5.08012826e+07  1.37e+02 1.08e+00  2.09e+02     8s
   8  -4.22317143e+05  3.31386792e+07  5.99e+01 1.93e-01  1.17e+02     8s
   9  -3.10341379e+05  2.51777280e+07  1.64e+01 3.81e-02  7.46e+01     8s
  10  -1.78938535e+05  1.60542126e+07  4.04e+00 1.68e-02  4.45e+01     8s
  11  -1.51695353e+05  8.77100930e+06  2.75e+00 8.97e-03  2.43e+01     8s
  12  -1.21828428e+05  7.16794626e+06  1.70e+00 7.26e-03  1.97e+01     8s
  13  -1.03991640e+05  4.99864826e+06  1.09e+00 5.00e-03  1.37e+01     8s
  14  -9.22743903e+04  3.26202664e+06  7.79e-01 3.33e-03  9.01e+00     9s
  15  -6.55146183e+04  2.68399017e+06  3.19e-01 2.73e-03  7.36e+00     9s
  16  -4.59359530e+04  1.03906727e+06  1.28e-01 9.67e-04  2.90e+00     9s
  17  -1.96161437e+04  4.85496855e+05  4.83e-02 5.10e-04  1.35e+00     9s
  18  -8.91240313e+03  3.02879975e+05  3.29e-02 3.94e-04  8.33e-01     9s
  19  -3.59062200e+02  1.98864603e+05  2.38e-02 3.81e-04  5.32e-01     9s
  20   3.45629924e+03  1.40022518e+05  2.08e-02 6.79e-04  3.65e-01     9s
  21   6.32684727e+03  1.28751633e+05  1.87e-02 9.46e-04  3.27e-01     9s
  22   9.81004763e+03  1.00576196e+05  1.62e-02 1.50e-03  2.42e-01     9s
  23   1.54713136e+04  9.18664033e+04  1.24e-02 1.47e-03  2.04e-01     9s
  24   1.67984167e+04  7.99344194e+04  1.16e-02 2.03e-03  1.69e-01     9s
  25   2.10653373e+04  7.41357053e+04  8.99e-03 2.10e-03  1.42e-01     9s
  26   2.35761617e+04  6.60181341e+04  7.64e-03 1.59e-03  1.13e-01     9s
  27   2.57683934e+04  6.24198032e+04  6.49e-03 1.62e-03  9.79e-02     9s
  28   2.77373385e+04  5.90126892e+04  5.55e-03 1.37e-03  8.36e-02    10s
  29   2.99647139e+04  5.57744938e+04  4.52e-03 1.13e-03  6.90e-02    10s
  30   3.26973707e+04  5.27521195e+04  3.36e-03 8.91e-04  5.36e-02    10s
  31   3.32879012e+04  4.93652363e+04  3.12e-03 6.43e-04  4.30e-02    10s
  32   3.54827971e+04  4.82155024e+04  2.26e-03 5.44e-04  3.40e-02    10s
  33   3.62335162e+04  4.56091892e+04  1.98e-03 3.38e-04  2.50e-02    10s
  34   3.74562157e+04  4.42983536e+04  1.54e-03 2.18e-04  1.83e-02    10s
  35   3.84964225e+04  4.38675942e+04  1.16e-03 1.79e-04  1.43e-02    10s
  36   3.94093481e+04  4.32178023e+04  8.29e-04 1.20e-04  1.02e-02    10s
  37   3.99570840e+04  4.27994175e+04  6.36e-04 8.32e-05  7.59e-03    10s
  38   4.04219467e+04  4.26236270e+04  4.74e-04 6.77e-05  5.88e-03    10s
  39   4.07733623e+04  4.23523656e+04  3.53e-04 4.29e-05  4.22e-03    11s
  40   4.11552820e+04  4.21977114e+04  2.28e-04 2.91e-05  2.78e-03    11s
  41   4.13052935e+04  4.20854181e+04  1.77e-04 1.95e-05  2.08e-03    11s
  42   4.13439622e+04  4.20792496e+04  1.64e-04 1.90e-05  1.96e-03    11s
  43   4.14816364e+04  4.19360465e+04  1.20e-04 1.15e-05  1.21e-03    11s
  44   4.16470244e+04  4.18928471e+04  6.63e-05 5.30e-06  6.57e-04    11s
  45   4.16536463e+04  4.18860778e+04  6.40e-05 5.47e-06  6.21e-04    11s
  46   4.17310801e+04  4.18675844e+04  3.77e-05 1.69e-06  3.65e-04    11s
  47   4.17845522e+04  4.18617277e+04  2.12e-05 9.02e-07  2.06e-04    11s
  48   4.18203461e+04  4.18575955e+04  9.98e-06 4.71e-07  9.95e-05    11s
  49   4.18423098e+04  4.18548036e+04  3.29e-06 1.64e-07  3.34e-05    12s
  50   4.18532097e+04  4.18536118e+04  1.03e-07 1.51e-08  1.07e-06    12s
  51   4.18535833e+04  4.18535833e+04  2.16e-09 2.65e-08  2.03e-10    12s

Barrier solved model in 51 iterations and 11.67 seconds (20.23 work units)
Optimal objective 4.18535833e+04


Root crossover log...

  181880 DPushes remaining with DInf 0.0000000e+00                12s
   37449 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    6388 PPushes remaining with PInf 7.0314405e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.2380488e+00     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   87975    4.1853583e+04   0.000000e+00   4.238049e+00     20s
   87984    4.1853583e+04   0.000000e+00   0.000000e+00     20s
   87984    4.1853583e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 3.72s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185358e+04, 87984 iterations, 18.84 seconds (37.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41853.5833    0  194 -208513.72 41853.5833   120%     -   24s
H    0     0                    -179689.2412 41853.5833   123%     -   26s
H    0     0                    -178323.3753 41853.5833   123%     -   26s
H    0     0                    -175660.9514 41853.5833   124%     -   26s
H    0     0                    -175436.5950 41853.5833   124%     -   27s
H    0     0                    -175268.3419 41853.5833   124%     -   27s
H    0     0                    -174989.4805 41853.5833   124%     -   28s
H    0     0                    -41554.87577 41853.5833   201%     -   28s
H    0     0                    9348.3345823 41853.5833   348%     -   28s
H    0     0                    15139.337443 41853.5833   176%     -   29s
H    0     0                    16002.000652 41853.5833   162%     -   29s
H    0     0                    16006.970882 41853.5833   161%     -   29s
H    0     0                    16041.561662 41853.5833   161%     -   29s
H    0     0                    16131.657761 41853.5833   159%     -   30s
H    0     0                    16137.694507 41853.5833   159%     -   30s
H    0     0                    16169.304523 41853.5833   159%     -   30s
     0     0 37174.7616    0  278 16169.3045 37174.7616   130%     -   80s
H    0     0                    16305.276991 37174.7514   128%     -   81s
     0     0 36777.0647    0  280 16305.2770 36777.0647   126%     -  120s
     0     0 36558.2046    0  292 16305.2770 36558.2046   124%     -  139s
     0     0 36421.6838    0  306 16305.2770 36421.6838   123%     -  159s
     0     0 36387.7108    0  303 16305.2770 36387.7108   123%     -  164s
     0     0 35803.1580    0  292 16305.2770 35803.1580   120%     -  191s
     0     0 35750.7988    0  302 16305.2770 35750.7988   119%     -  196s
     0     0 35750.3965    0  302 16305.2770 35750.3965   119%     -  197s
     0     0 31927.1727    0  270 16305.2770 31927.1727  95.8%     -  239s
H    0     0                    19040.287519 31925.3843  67.7%     -  240s
H    0     0                    19625.868271 31925.3843  62.7%     -  240s
     0     0 31314.7281    0  271 19625.8683 31314.7281  59.6%     -  279s
     0     0 30786.5645    0  274 19625.8683 30786.5645  56.9%     -  306s
     0     0 30647.2700    0  343 19625.8683 30647.2700  56.2%     -  335s
     0     0 30518.3471    0  339 19625.8683 30518.3471  55.5%     -  351s
     0     0 30483.3303    0  339 19625.8683 30483.3303  55.3%     -  361s
     0     0 30458.5565    0  347 19625.8683 30458.5565  55.2%     -  368s
     0     0 30440.0183    0  346 19625.8683 30440.0183  55.1%     -  374s
     0     0 30403.1958    0  349 19625.8683 30403.1958  54.9%     -  380s
     0     0 30381.2380    0  347 19625.8683 30381.2380  54.8%     -  385s
     0     0 30369.6968    0  341 19625.8683 30369.6968  54.7%     -  388s
     0     0 30362.9625    0  349 19625.8683 30362.9625  54.7%     -  393s
     0     0 30359.1204    0  353 19625.8683 30359.1204  54.7%     -  395s
     0     0 30350.7788    0  350 19625.8683 30350.7788  54.6%     -  401s
     0     0 30345.7019    0  355 19625.8683 30345.7019  54.6%     -  404s
     0     0 30344.9495    0  351 19625.8683 30344.9495  54.6%     -  405s
     0     0 28734.7000    0  369 19625.8683 28734.7000  46.4%     -  462s
H    0     0                    19680.023516 28734.4418  46.0%     -  463s
     0     0 28179.9464    0  365 19680.0235 28179.9464  43.2%     -  490s
     0     0 28066.7220    0  350 19680.0235 28066.7220  42.6%     -  511s
     0     0 28022.3858    0  362 19680.0235 28022.3858  42.4%     -  521s
     0     0 28000.5674    0  359 19680.0235 28000.5674  42.3%     -  527s
     0     0 27987.2819    0  360 19680.0235 27987.2819  42.2%     -  533s
     0     0 27974.9471    0  368 19680.0235 27974.9471  42.1%     -  535s
     0     0 27970.1468    0  362 19680.0235 27970.1468  42.1%     -  537s
     0     0 27964.1729    0  369 19680.0235 27964.1729  42.1%     -  540s
     0     0 27962.0568    0  367 19680.0235 27962.0568  42.1%     -  540s
     0     0 27958.4907    0  366 19680.0235 27958.4907  42.1%     -  542s
     0     0 27954.9447    0  366 19680.0235 27954.9447  42.0%     -  543s
     0     0 27953.2952    0  365 19680.0235 27953.2952  42.0%     -  544s
     0     0 27657.4322    0  344 19680.0235 27657.4322  40.5%     -  572s
H    0     0                    19783.787298 27652.6772  39.8%     -  573s
     0     0 27606.9532    0  348 19783.7873 27606.9532  39.5%     -  581s
     0     0 27601.7963    0  352 19783.7873 27601.7963  39.5%     -  584s
     0     0 27594.6212    0  346 19783.7873 27594.6212  39.5%     -  588s
     0     0 27591.1427    0  352 19783.7873 27591.1427  39.5%     -  590s
     0     0 27590.6287    0  353 19783.7873 27590.6287  39.5%     -  591s
     0     0 27403.2240    0  358 19783.7873 27403.2240  38.5%     -  608s
     0     0 27353.8023    0  374 19783.7873 27353.8023  38.3%     -  621s
     0     0 27341.3365    0  358 19783.7873 27341.3365  38.2%     -  628s
     0     0 27334.0148    0  365 19783.7873 27334.0148  38.2%     -  633s
     0     0 27324.0084    0  355 19783.7873 27324.0084  38.1%     -  640s
     0     0 27322.2448    0  350 19783.7873 27322.2448  38.1%     -  642s
     0     0 27254.3923    0  342 19783.7873 27254.3923  37.8%     -  658s
H    0     0                    19833.279979 27253.5994  37.4%     -  661s
H    0     0                    19862.865710 27253.5994  37.2%     -  661s
H    0     0                    19925.626912 27253.5994  36.8%     -  661s
H    0     0                    20036.438837 27253.5994  36.0%     -  661s
H    0     0                    20189.260369 27253.5994  35.0%     -  661s
     0     0 27250.4181    0  339 20189.2604 27250.4181  35.0%     -  664s
     0     0 27246.3779    0  345 20189.2604 27246.3779  35.0%     -  668s
     0     0 27242.3828    0  343 20189.2604 27242.3828  34.9%     -  671s
     0     0 27242.0534    0  341 20189.2604 27242.0534  34.9%     -  672s
     0     0 27203.7405    0  297 20189.2604 27203.7405  34.7%     -  685s
     0     0 27176.8835    0  353 20189.2604 27176.8835  34.6%     -  692s
     0     0 27172.5025    0  352 20189.2604 27172.5025  34.6%     -  697s
     0     0 27171.4225    0  352 20189.2604 27171.4225  34.6%     -  698s
     0     0 27118.4113    0  343 20189.2604 27118.4113  34.3%     -  709s
H    0     0                    20259.376974 27117.5447  33.9%     -  711s
H    0     0                    20321.799624 27117.5447  33.4%     -  711s
H    0     0                    20341.112362 27117.5447  33.3%     -  711s
H    0     0                    20383.611791 27117.5447  33.0%     -  711s
     0     0 27097.4687    0  343 20383.6118 27097.4687  32.9%     -  715s
     0     0 27093.5012    0  350 20383.6118 27093.5012  32.9%     -  717s
     0     0 27092.5243    0  337 20383.6118 27092.5243  32.9%     -  719s
     0     0 27089.8460    0  331 20383.6118 27089.8460  32.9%     -  723s
     0     0 27087.8048    0  339 20383.6118 27087.8048  32.9%     -  725s
     0     0 27085.0383    0  336 20383.6118 27085.0383  32.9%     -  728s
     0     0 27083.9669    0  288 20383.6118 27083.9669  32.9%     -  732s
     0     0 27072.6032    0  304 20383.6118 27072.6032  32.8%     -  739s
     0     0 27053.4715    0  295 20383.6118 27053.4715  32.7%     -  748s
     0     0 27041.9465    0  291 20383.6118 27041.9465  32.7%     -  756s
     0     0 27039.3894    0  342 20383.6118 27039.3894  32.7%     -  760s
     0     0 27038.4996    0  349 20383.6118 27038.4996  32.6%     -  763s
     0     0 27036.2924    0  294 20383.6118 27036.2924  32.6%     -  770s
     0     0 27035.4747    0  295 20383.6118 27035.4747  32.6%     -  773s
     0     0 27034.8922    0  305 20383.6118 27034.8922  32.6%     -  778s
     0     0 27034.1208    0  313 20383.6118 27034.1208  32.6%     -  785s
     0     0 27032.9598    0  360 20383.6118 27032.9598  32.6%     -  789s
     0     0 27031.7651    0  406 20383.6118 27031.7651  32.6%     -  795s
     0     0 27031.1045    0  353 20383.6118 27031.1045  32.6%     -  801s
     0     0 27031.0069    0  353 20383.6118 27031.0069  32.6%     -  813s
     0     2 27031.0069    0  353 20383.6118 27031.0069  32.6%     -  931s
     1     3 26054.7941    1  285 20383.6118 27030.5931  32.6% 25762  965s
     2     6 25659.1788    2  279 20383.6118 27030.5931  32.6% 16751  980s
     5     9 25395.3641    2  314 20383.6118 26818.2824  31.6% 15530 1017s
     8    18 24766.9654    3  277 20383.6118 26818.2824  31.6% 15252 1032s
    17    36 24709.6261    4  283 20383.6118 26660.5311  30.8% 11155 1054s
    35    50 25944.4370    4  426 20383.6118 26507.4482  30.0% 16520 1137s
    49    60 22690.0424    7  254 20383.6118 26507.4482  30.0% 19618 1178s
    67    99 24845.9700    6  363 20383.6118 26507.4482  30.0% 16898 1225s
H   93    99                    20407.781255 26507.4482  29.9% 15192 1225s
H   96    99                    20426.253786 26507.4482  29.8% 14829 1225s
   108   183 24190.7009    7  276 20426.2538 26507.4482  29.8% 13809 1272s
   202   258 23925.8039    9  266 20426.2538 26507.4482  29.8% 10209 1303s
   283   283 23581.6005   13  258 20426.2538 26507.4482  29.8%  8608 1324s
H  285   283                    20478.411494 26507.4482  29.4%  8564 1324s
H  296   283                    20504.998287 26507.4482  29.3%  8435 1324s
   310   300 20593.1210   11  111 20504.9983 26507.4482  29.3%  8289 1353s
   354   309 22576.6426   14  242 20504.9983 26507.4482  29.3%  7822 1382s
   392   320 22417.7684   15  233 20504.9983 26507.4482  29.3%  7682 1408s
H  393   320                    20540.203665 26507.4482  29.1%  7662 1408s
   421   349 22320.7114   16  225 20540.2037 26507.4482  29.1%  7638 1434s
   478   394 22116.7090   18  274 20540.2037 26507.4482  29.1%  7291 1463s
   552   469 21733.5372   20  206 20540.2037 26507.4482  29.1%  6860 1488s
   659   485 21536.5475   21  254 20540.2037 26507.4482  29.1%  6248 1512s
   735   538 21424.9071   22  199 20540.2037 26507.4482  29.1%  5967 1534s
   827   556     cutoff   24      20540.2037 26507.4482  29.1%  5607 1551s
   859   600 21319.4541   24  207 20540.2037 26507.4482  29.1%  5502 1571s
   924   656 21084.0123   28  187 20540.2037 26507.4482  29.1%  5310 1590s
  1034   708 20950.6962   31  186 20540.2037 26507.4482  29.1%  4950 1611s
  1161   727 infeasible   35      20540.2037 26507.4482  29.1%  4625 1635s
  1264   739 20960.8366   23  216 20540.2037 26507.4482  29.1%  4493 1657s
  1343   742     cutoff   24      20540.2037 26507.4482  29.1%  4464 1684s
  1439   750 infeasible   13      20540.2037 26507.4482  29.1%  4342 1709s
  1499   765 22943.8914   10  384 20540.2037 26507.4482  29.1%  4285 1739s
  1533   779 22375.1126   10  284 20540.2037 26507.4482  29.1%  4326 1763s
H 1534   779                    20560.179736 26507.4482  28.9%  4323 1763s
H 1536   779                    20573.292371 26507.4482  28.8%  4329 1763s
H 1554   779                    20581.240947 26507.4482  28.8%  4331 1763s
  1563   816 22014.5907   11  279 20581.2409 26507.4482  28.8%  4357 1792s
  1626   852 20779.2652   18  310 20581.2409 26507.4482  28.8%  4365 1821s
  1715   902 20718.1652   20  309 20581.2409 26507.4482  28.8%  4369 1850s
  1817   946 20681.7004   20  299 20581.2409 26507.4482  28.8%  4363 1882s
  1954   988 20701.1834   19  285 20581.2409 26507.4482  28.8%  4282 1912s
  2056  1011 infeasible   17      20581.2409 26507.4482  28.8%  4281 1949s
  2163  1041 21666.6994   16  231 20581.2409 26507.4482  28.8%  4292 1977s
  2221  1108 21620.9120   17  260 20581.2409 26507.4482  28.8%  4309 2009s
H 2229  1108                    20586.375074 26507.4482  28.8%  4302 2009s
H 2284  1108                    20587.528534 26507.4482  28.8%  4281 2009s
  2343  1170 21279.1687   18  244 20587.5285 26507.4482  28.8%  4259 2047s
  2513  1226 infeasible   20      20587.5285 26507.4482  28.8%  4185 2099s
  2653  1271 20754.2043   24  227 20587.5285 26507.4482  28.8%  4166 2140s
  2780  1289 20792.5594   15  212 20587.5285 26507.4482  28.8%  4188 2182s
  2896  1301 20684.8340   17  192 20587.5285 26507.4482  28.8%  4219 2223s
  3004  1340 infeasible   18      20587.5285 26507.4482  28.8%  4254 2267s
  3106  1394 21703.0453   17  147 20587.5285 26507.4482  28.8%  4297 2308s
  3194  1519 21636.6729   19  263 20587.5285 26507.4482  28.8%  4303 2354s
  3398  1631 21349.1363   30  248 20587.5285 26507.4482  28.8%  4256 2393s
  3545  1799 21115.7275   36  203 20587.5285 26507.4482  28.8%  4207 2441s
  3882  1892 20814.8892   59   86 20587.5285 26507.4482  28.8%  4052 2508s
  4115  2009 infeasible   17      20587.5285 26507.4482  28.8%  4024 2563s
  4384  2050 20796.3905   14  289 20587.5285 26507.4482  28.8%  3972 2622s
  4588  2057 22639.6336   13  267 20587.5285 25825.7690  25.4%  3966 2670s
  4635  2106 22559.8321   14  220 20587.5285 25825.6966  25.4%  4003 2722s
  4753  2161 21787.2448   27  220 20587.5285 24326.2282  18.2%  4011 2778s
  4917  2210 21557.9534   37  247 20587.5285 24326.2282  18.2%  4015 2840s
  5051  2251 21410.7673   44  243 20587.5285 24326.2282  18.2%  4041 2904s
  5229  2339 20787.4787   64  141 20587.5285 24008.5217  16.6%  4067 2971s
  5474  2406 22092.1911   11  325 20587.5285 23498.3608  14.1%  4096 3043s
  5743  2418 20985.9810   13  236 20587.5285 23498.3608  14.1%  4115 3108s
  5791  2447     cutoff   14      20587.5285 23236.5203  12.9%  4165 3167s
  5863  2448 20782.8979   28  353 20587.5285 23236.1668  12.9%  4182 3532s
  5865  2449 21063.6532   50  144 20587.5285 23236.1668  12.9%  4181 3553s

Cutting planes:
  Gomory: 33
  Implied bound: 11
  Projected implied bound: 111
  MIR: 1248
  Mixing: 13
  Flow cover: 1281
  RLT: 90
  Relax-and-lift: 249

Explored 5865 nodes (25375268 simplex iterations) in 3600.06 seconds (9104.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20587.5 20581.2 20573.3 ... 20383.6

Time limit reached
Best objective 2.058752853439e+04, best bound 2.323616683891e+04, gap 12.8653%
  WARNING: Time limit reached. Using best solution found (gap: 12.87%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.27s
  Master Objective (UB) = 20587.53, θ = 140493.98
  Upper Bound (UB) = 20587.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140493.98
  [DEBUG]   ✓ Scenario 0: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 140493.98 ≤ Q = 140493.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 140493.98 ≤ Q = 140493.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4a285c9a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4a285c9a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7500349.5656
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.361261e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136126.08    0  123 7500349.57 -136126.08   102%     -    0s
H    0     0                    -101278.4259 -136126.08  34.4%     -    0s
     0     0 -107534.44    0   84 -101278.43 -107534.44  6.18%     -    0s
H    0     0                    -104587.0218 -107427.92  2.72%     -    0s
H    0     0                    -105470.1224 -106731.46  1.20%     -    0s
     0     0 -106731.46    0   85 -105470.12 -106731.46  1.20%     -    0s
     0     0 -106459.41    0  103 -105470.12 -106459.41  0.94%     -    0s
     0     0 -106417.17    0   87 -105470.12 -106417.17  0.90%     -    0s
     0     0 -106410.52    0   87 -105470.12 -106410.52  0.89%     -    0s
     0     0 -106236.25    0   88 -105470.12 -106236.25  0.73%     -    0s
     0     0 -106211.23    0   88 -105470.12 -106211.23  0.70%     -    0s
     0     0 -106141.07    0  104 -105470.12 -106141.07  0.64%     -    0s
     0     0 -106126.68    0  104 -105470.12 -106126.68  0.62%     -    0s
     0     2 -106126.68    0  104 -105470.12 -106126.68  0.62%     -    0s
H  273    30                    -105519.9678 -105617.97  0.09%   6.7    0s
*  613     7              43    -105520.6568 -105545.44  0.02%   5.1    0s

Cutting planes:
  Gomory: 48
  Implied bound: 4
  MIR: 216
  Flow cover: 7
  RLT: 3
  BQP: 2

Explored 625 nodes (3740 simplex iterations) in 0.09 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -105521 -105470 -101278 ... 1.43567e+13
No other solutions better than -105521

Optimal solution found (tolerance 1.00e-04)
Best objective -1.055206568021e+05, best bound -1.055206568021e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 139123.91
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105520.66
  [DEBUG]   S×d_nominal = 244644.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244644.56 + -105520.66 = 139123.91
  [DEBUG]   Current θ from Master = 140493.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1370.07 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19217.46
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 743.5917, Absolute Gap = 743.5917, Relative Gap = 0.036119
  Not converged yet (gap = 743.59 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086519 nonzeros
Model fingerprint: 0x7b07e3ad
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 169175 rows and 68675 columns
Presolve time: 4.62s
Presolved: 214458 rows, 89585 columns, 1319045 nonzeros
Variable types: 87326 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.86s

Barrier statistics:
 Dense cols : 1221
 AA' NZ     : 5.680e+06
 Factor NZ  : 1.613e+07 (roughly 250 MB of memory)
 Factor Ops : 6.087e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.00549865e+07  3.41135209e+08  1.16e+05 1.55e+01  7.56e+04     9s
   1  -1.56269108e+07  2.96797081e+08  8.33e+04 5.51e+01  5.41e+04     9s
   2  -5.83619393e+06  2.32818076e+08  3.09e+04 1.42e+00  2.12e+04     9s
   3  -1.63049496e+06  2.09953801e+08  4.64e+03 1.08e+01  3.60e+03     9s
   4  -9.12674194e+05  1.70060610e+08  1.08e+03 7.21e+00  1.13e+03     9s
   5  -7.82739498e+05  1.01142162e+08  4.57e+02 3.79e+00  5.31e+02     9s
   6  -7.29085832e+05  7.33996628e+07  2.40e+02 2.56e+00  3.24e+02     9s
   7  -5.49229408e+05  5.94816043e+07  9.71e+01 1.99e+00  2.05e+02     9s
   8  -4.47028523e+05  3.98717249e+07  4.19e+01 1.22e+00  1.23e+02     9s
   9  -3.53785138e+05  2.82792401e+07  1.06e+01 6.82e-01  7.75e+01     9s
  10  -2.38881368e+05  1.85522589e+07  2.86e+00 3.69e-02  4.90e+01     9s
  11  -1.77439529e+05  8.32899399e+06  1.66e+00 1.62e-02  2.21e+01     9s
  12  -1.51850119e+05  6.89191477e+06  1.26e+00 1.33e-02  1.82e+01    10s
  13  -1.16997379e+05  5.37346731e+06  7.59e-01 4.69e-02  1.42e+01    10s
  14  -9.69345393e+04  2.92119091e+06  4.97e-01 3.02e-02  7.77e+00    10s
  15  -7.39140048e+04  2.36809643e+06  2.71e-01 4.54e-03  6.28e+00    10s
  16  -4.91016371e+04  1.68920187e+06  1.03e-01 3.78e-03  4.46e+00    10s
  17  -3.62799616e+04  5.76028489e+05  6.17e-02 1.07e-03  1.57e+00    10s
  18  -1.67253012e+04  3.14369038e+05  3.68e-02 4.97e-04  8.50e-01    10s
  19  -3.77815543e+03  1.90959392e+05  2.63e-02 5.86e-04  5.00e-01    10s
  20   2.87840645e+03  1.45474080e+05  2.18e-02 1.14e-03  3.66e-01    10s
  21   8.05757538e+03  1.22244475e+05  1.82e-02 7.60e-04  2.93e-01    10s
  22   9.20964570e+03  1.10406048e+05  1.75e-02 9.80e-04  2.60e-01    10s
  23   1.70790718e+04  1.01700414e+05  1.20e-02 9.71e-04  2.17e-01    10s
  24   1.97811424e+04  8.14719724e+04  1.02e-02 7.55e-04  1.58e-01    10s
  25   2.25908746e+04  7.45598042e+04  8.59e-03 1.29e-03  1.33e-01    10s
  26   2.42466356e+04  6.66532562e+04  7.68e-03 1.52e-03  1.09e-01    11s
  27   2.82314610e+04  6.23198144e+04  5.57e-03 1.25e-03  8.75e-02    11s
  28   3.00347794e+04  5.76875743e+04  4.71e-03 9.91e-04  7.10e-02    11s
  29   3.25095326e+04  5.42608242e+04  3.59e-03 9.80e-04  5.58e-02    11s
  30   3.35932962e+04  5.07520550e+04  3.14e-03 7.39e-04  4.40e-02    11s
  31   3.43727325e+04  4.88126925e+04  2.82e-03 5.80e-04  3.71e-02    11s
  32   3.61093036e+04  4.65553636e+04  2.13e-03 3.91e-04  2.68e-02    11s
  33   3.71425802e+04  4.54250853e+04  1.72e-03 2.96e-04  2.13e-02    11s
  34   3.79389054e+04  4.45257268e+04  1.42e-03 3.19e-04  1.69e-02    11s
  35   3.88085999e+04  4.40606174e+04  1.09e-03 2.57e-04  1.35e-02    11s
  36   3.90019334e+04  4.31879484e+04  1.02e-03 1.58e-04  1.07e-02    11s
  37   3.98423861e+04  4.27722125e+04  7.16e-04 9.80e-05  7.52e-03    12s
  38   4.05745751e+04  4.25781507e+04  4.47e-04 8.82e-05  5.14e-03    12s
  39   4.09453443e+04  4.24276028e+04  3.12e-04 7.58e-05  3.80e-03    12s
  40   4.10217714e+04  4.21651658e+04  2.85e-04 1.75e-04  2.93e-03    12s
  41   4.12245628e+04  4.21019076e+04  2.14e-04 1.39e-04  2.25e-03    12s
  42   4.14932277e+04  4.19745057e+04  1.20e-04 5.94e-05  1.24e-03    12s
  43   4.15807113e+04  4.19176167e+04  9.02e-05 2.88e-05  8.65e-04    12s
  44   4.15898340e+04  4.19033860e+04  8.69e-05 2.20e-05  8.05e-04    12s
  45   4.17350430e+04  4.18830670e+04  3.86e-05 1.20e-05  3.80e-04    12s
  46   4.17826834e+04  4.18732156e+04  2.31e-05 6.88e-06  2.32e-04    12s
  47   4.18469910e+04  4.18607455e+04  2.84e-06 1.11e-05  3.53e-05    12s
  48   4.18568560e+04  4.18572293e+04  5.10e-08 5.07e-07  9.59e-07    13s
  49   4.18571196e+04  4.18571200e+04  3.12e-09 3.23e-09  9.59e-10    13s

Barrier solved model in 49 iterations and 12.70 seconds (20.83 work units)
Optimal objective 4.18571196e+04


Root crossover log...

  189354 DPushes remaining with DInf 0.0000000e+00                13s
   61824 DPushes remaining with DInf 0.0000000e+00                15s
   19450 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

   22945 PPushes remaining with PInf 1.7869792e-04                24s
    2484 PPushes remaining with PInf 5.4739697e-05                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.4800148e+03     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  118168    4.1857120e+04   0.000000e+00   5.480015e+03     26s
  118400    4.1857120e+04   0.000000e+00   0.000000e+00     26s
  118400    4.1857120e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 3.16s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185712e+04, 118400 iterations, 23.25 seconds (43.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41857.1199    0  194 -208513.72 41857.1199   120%     -   29s
H    0     0                    -206645.1207 41857.1199   120%     -   32s
H    0     0                    -206421.2551 41857.1199   120%     -   33s
H    0     0                    -203732.7423 41857.1199   121%     -   34s
H    0     0                    -202427.2465 41857.1199   121%     -   34s
H    0     0                    -202375.2459 41857.1199   121%     -   35s
H    0     0                    -201822.2104 41857.1199   121%     -   36s
H    0     0                    -200722.4267 41857.1199   121%     -   36s
H    0     0                    -200671.6692 41857.1199   121%     -   36s
H    0     0                    -200138.7281 41857.1199   121%     -   36s
H    0     0                    -199976.2125 41857.1199   121%     -   36s
H    0     0                    -23174.12273 41857.1199   281%     -   37s
H    0     0                    -17803.52897 41857.1199   335%     -   37s
H    0     0                    2480.0357002 41857.1199  1588%     -   37s
H    0     0                    2574.2662334 41857.1199  1526%     -   37s
H    0     0                    3143.2881999 41857.1199  1232%     -   37s
H    0     0                    4054.9885411 41857.1199   932%     -   37s
     0     0 36710.6368    0  228 4054.98854 36710.6368   805%     -  112s
H    0     0                    7311.7467698 36707.6610   402%     -  113s
H    0     0                    15522.708410 36707.6610   136%     -  113s
H    0     0                    15575.714575 36707.6610   136%     -  114s
H    0     0                    15713.582490 36707.6610   134%     -  114s
     0     0 36445.9408    0  231 15713.5825 36445.9408   132%     -  125s
     0     0 35980.3015    0  298 15713.5825 35980.3015   129%     -  139s
     0     0 35948.8899    0  301 15713.5825 35948.8899   129%     -  148s
     0     0 35711.4723    0  304 15713.5825 35711.4723   127%     -  166s
     0     0 35691.7261    0  307 15713.5825 35691.7261   127%     -  175s
     0     0 35677.6065    0  303 15713.5825 35677.6065   127%     -  179s
     0     0 35672.8732    0  301 15713.5825 35672.8732   127%     -  181s
     0     0 35659.0870    0  296 15713.5825 35659.0870   127%     -  185s
     0     0 35623.5609    0  304 15713.5825 35623.5609   127%     -  190s
     0     0 35620.7341    0  305 15713.5825 35620.7341   127%     -  195s
     0     0 35617.8675    0  296 15713.5825 35617.8675   127%     -  198s
     0     0 35617.5898    0  299 15713.5825 35617.5898   127%     -  201s
     0     0 31839.5338    0  252 15713.5825 31839.5338   103%     -  265s
H    0     0                    18227.796673 31839.4648  74.7%     -  266s
H    0     0                    18580.346617 31839.4648  71.4%     -  266s
H    0     0                    18798.811967 31839.4648  69.4%     -  266s
H    0     0                    19034.492578 31839.4648  67.3%     -  266s
H    0     0                    19133.927771 31839.4648  66.4%     -  266s
     0     0 31368.5553    0  252 19133.9278 31368.5553  63.9%     -  316s
     0     0 31136.5868    0  257 19133.9278 31136.5868  62.7%     -  344s
     0     0 31003.0118    0  370 19133.9278 31003.0118  62.0%     -  363s
     0     0 30808.8325    0  330 19133.9278 30808.8325  61.0%     -  384s
     0     0 30733.0029    0  319 19133.9278 30733.0029  60.6%     -  396s
     0     0 30709.9647    0  329 19133.9278 30709.9647  60.5%     -  405s
     0     0 30698.3496    0  329 19133.9278 30698.3496  60.4%     -  410s
     0     0 30611.4681    0  329 19133.9278 30611.4681  60.0%     -  420s
     0     0 30608.2440    0  336 19133.9278 30608.2440  60.0%     -  424s
     0     0 30576.7465    0  331 19133.9278 30576.7465  59.8%     -  431s
     0     0 30526.1271    0  332 19133.9278 30526.1271  59.5%     -  443s
     0     0 30510.9398    0  343 19133.9278 30510.9398  59.5%     -  447s
     0     0 30504.6292    0  343 19133.9278 30504.6292  59.4%     -  449s
     0     0 30500.3527    0  345 19133.9278 30500.3527  59.4%     -  452s
     0     0 30498.7684    0  343 19133.9278 30498.7684  59.4%     -  454s
     0     0 30498.7397    0  343 19133.9278 30498.7397  59.4%     -  455s
     0     0 28633.5607    0  396 19133.9278 28633.5607  49.6%     -  536s
     0     0 28391.2094    0  404 19133.9278 28391.2094  48.4%     -  576s
     0     0 28183.1535    0  401 19133.9278 28183.1535  47.3%     -  608s
     0     0 28152.9972    0  406 19133.9278 28152.9972  47.1%     -  628s
     0     0 28093.6266    0  411 19133.9278 28093.6266  46.8%     -  638s
     0     0 28085.7357    0  412 19133.9278 28085.7357  46.8%     -  641s
     0     0 28070.1730    0  358 19133.9278 28070.1730  46.7%     -  650s
     0     0 28067.5063    0  357 19133.9278 28067.5063  46.7%     -  656s
     0     0 28028.7010    0  351 19133.9278 28028.7010  46.5%     -  671s
     0     0 28019.8569    0  352 19133.9278 28019.8569  46.4%     -  676s
     0     0 27991.3306    0  361 19133.9278 27991.3306  46.3%     -  683s
     0     0 27980.4176    0  356 19133.9278 27980.4176  46.2%     -  690s
     0     0 27976.3851    0  409 19133.9278 27976.3851  46.2%     -  695s
     0     0 27975.1475    0  409 19133.9278 27975.1475  46.2%     -  698s
     0     0 27530.4450    0  408 19133.9278 27530.4450  43.9%     -  741s
H    0     0                    19158.726149 27529.0194  43.7%     -  742s
     0     0 27424.0471    0  407 19158.7261 27424.0471  43.1%     -  759s
     0     0 27399.4986    0  413 19158.7261 27399.4986  43.0%     -  767s
     0     0 27386.6641    0  412 19158.7261 27386.6641  42.9%     -  772s
     0     0 27383.9127    0  416 19158.7261 27383.9127  42.9%     -  775s
     0     0 27380.1564    0  356 19158.7261 27380.1564  42.9%     -  779s
     0     0 27379.6450    0  354 19158.7261 27379.6450  42.9%     -  780s
     0     0 27355.5073    0  348 19158.7261 27355.5073  42.8%     -  794s
H    0     0                    19201.147088 27355.1451  42.5%     -  794s
     0     0 27348.0791    0  404 19201.1471 27348.0791  42.4%     -  799s
     0     0 27345.8011    0  356 19201.1471 27345.8011  42.4%     -  802s
     0     0 27343.1852    0  355 19201.1471 27343.1852  42.4%     -  804s
     0     0 27342.7766    0  353 19201.1471 27342.7766  42.4%     -  805s
     0     0 27327.5447    0  339 19201.1471 27327.5447  42.3%     -  812s
H    0     0                    19211.595881 27326.2752  42.2%     -  813s
H    0     0                    19344.562242 27326.2752  41.3%     -  813s
     0     0 27324.2254    0  344 19344.5622 27324.2254  41.3%     -  817s
     0     0 27323.4741    0  337 19344.5622 27323.4741  41.2%     -  819s
     0     0 27301.6063    0  241 19344.5622 27301.6063  41.1%     -  830s
H    0     0                    19465.394001 27300.9153  40.3%     -  831s
     0     0 27297.4310    0  345 19465.3940 27297.4310  40.2%     -  837s
     0     0 27295.7909    0  342 19465.3940 27295.7909  40.2%     -  841s
     0     0 27294.9667    0  343 19465.3940 27294.9667  40.2%     -  845s
H    0     0                    19517.004420 27294.6666  39.9%     -  847s
H    0     0                    19666.852202 27294.6666  38.8%     -  847s
H    0     0                    19685.205219 27294.6666  38.7%     -  847s
H    0     0                    19716.044609 27294.6666  38.4%     -  847s
     0     0 27294.6545    0  338 19716.0446 27294.6545  38.4%     -  848s
     0     0 27280.8539    0  333 19716.0446 27280.8539  38.4%     -  857s
H    0     0                    19878.158682 27274.8528  37.2%     -  858s
     0     0 27274.8528    0  250 19878.1587 27274.8528  37.2%     -  862s
     0     0 27274.8528    0  276 19878.1587 27274.8528  37.2%     -  865s
     0     0 27266.5231    0  352 19878.1587 27266.5231  37.2%     -  873s
     0     0 27265.5783    0  352 19878.1587 27265.5783  37.2%     -  889s
H    0     0                    19975.848276 27265.5159  36.5%     - 1000s
H    0     0                    20245.760478 27265.5159  34.7%     - 1001s
H    0     0                    20291.283730 27265.5159  34.4%     - 1001s
H    0     0                    20294.704173 27265.5159  34.3%     - 1001s
     0     2 27265.5159    0  352 20294.7042 27265.5159  34.3%     - 1005s
     1     3 26537.4348    1  251 20294.7042 27265.5159  34.3% 19209 1026s
     2     5 26514.2645    2  248 20294.7042 27265.5159  34.3% 10190 1041s
     4     8 27005.2645    2  405 20294.7042 27149.9420  33.8% 11722 1075s
     7    15 25592.0558    3  267 20294.7042 27149.9420  33.8% 13759 1097s
    14    28 24390.9593    4  254 20294.7042 27005.1284  33.1% 11928 1125s
    27    41 25449.6506    5  386 20294.7042 26847.3451  32.3% 24131 1187s
H   40    72                    20410.796199 26606.8169  30.4% 20484 1357s
H   42    72                    20537.776428 26606.8169  29.6% 20234 1357s
    71   136 25381.4708    5  353 20537.7764 26606.8169  29.6% 20873 1490s
   135   270 25341.8113    7  337 20537.7764 26606.8169  29.6% 17142 1537s
H  167   270                    20551.045329 26606.8169  29.5% 15027 1537s
H  167   270                    20561.521496 26606.8169  29.4% 15027 1537s
   269   332 24574.9470   11  238 20561.5215 26606.8169  29.4% 12033 1576s
   333   357 24574.1991   12  251 20561.5215 26606.8169  29.4% 11247 1601s
   362   386 24514.1867   13  301 20561.5215 26606.8169  29.4% 11111 1623s
   393   407 24382.0839   14  301 20561.5215 26606.8169  29.4% 11183 1646s
   423   434 24089.0587   15  268 20561.5215 26606.8169  29.4% 11344 1665s
   454   467 23831.1664   16  249 20561.5215 26606.8169  29.4% 11461 1690s
H  457   467                    20589.769506 26606.8169  29.2% 11448 1690s
   493   502 23663.1535   17  255 20589.7695 26606.8169  29.2% 11441 1719s
H  494   502                    20606.990473 26606.8169  29.1% 11417 1719s
   558   520 22875.0945   18  322 20606.9905 26606.8169  29.1% 11309 1743s
   628   529 22840.0358   19  311 20606.9905 26606.8169  29.1% 11400 1767s
   669   545 22825.3380   20  326 20606.9905 26606.8169  29.1% 11434 1786s
   706   560 22916.1787   17  260 20606.9905 26606.8169  29.1% 11523 1806s
   753   590 22517.1173   21  322 20606.9905 26606.8169  29.1% 11506 1830s
   803   605 21357.3888   23  301 20606.9905 26606.8169  29.1% 11620 1853s
   860   627 infeasible   24      20606.9905 26606.8169  29.1% 11407 1877s
   910   652 20876.7654   23  175 20606.9905 26606.8169  29.1% 11511 1902s
   971   695 24026.6655    9  373 20606.9905 26606.8169  29.1% 11475 1927s
  1052   747 23804.8080   11  326 20606.9905 26606.8169  29.1% 11323 1954s
  1143   810 23192.5582   12  367 20606.9905 26606.8169  29.1% 11145 1979s
  1236   858 22904.3984   13  359 20606.9905 26606.8169  29.1% 10995 2007s
  1336   939 22384.3243   17  281 20606.9905 26606.8169  29.1% 10957 2033s
  1442  1040 21483.5562   21  219 20606.9905 26606.8169  29.1% 10891 2061s
  1585  1055 20992.7918   25  204 20606.9905 25622.6977  24.3% 10614 2087s
  1625  1075 20964.1169   26  209 20606.9905 25622.6977  24.3% 10607 2114s
  1671  1108     cutoff   27      20606.9905 25622.2669  24.3% 10686 2147s
  1732  1144     cutoff   28      20606.9905 25622.2669  24.3% 10659 2177s
  1801  1191     cutoff   16      20606.9905 25622.2669  24.3% 10674 2207s
  1896  1268 21296.6985   20  241 20606.9905 25622.2669  24.3% 10640 2239s
  2006  1338 21290.8363   21  235 20606.9905 25622.2669  24.3% 10522 2273s
  2126  1403 20966.3184   23  237 20606.9905 25622.2669  24.3% 10519 2308s
  2263  1496 infeasible   26      20606.9905 25622.2669  24.3% 10514 2345s
  2454  1608 infeasible   16      20606.9905 25162.9114  22.1% 10323 2385s
  2630  1658 23547.5866    7  284 20606.9905 25119.9782  21.9% 10216 2425s
  2788  1722 23250.4553    9  317 20606.9905 25119.9782  21.9% 10161 2471s
  2934  1779 22405.9545   12  313 20606.9905 25119.9782  21.9% 10201 2517s
  3101  1843 22247.1241   13  309 20606.9905 25119.9782  21.9% 10215 2561s
  3245  1903 21634.8520   16  199 20606.9905 25119.9782  21.9% 10345 2611s
  3408  1969 20893.7919   23  217 20606.9905 25053.2795  21.6% 10358 2662s
  3591  1980 infeasible   30      20606.9905 24787.2695  20.3% 10400 2717s
  3642  2011 22406.8938   12  261 20606.9905 24766.1448  20.2% 10477 2772s
  3688  2045 22116.6601   13  259 20606.9905 24744.0946  20.1% 10495 2812s
  3738  2061 21786.5315   14  258 20606.9905 24744.0946  20.1% 10534 2873s
  3805  2090 21710.9745   15  263 20606.9905 24713.9691  19.9% 10540 2922s
  3846  2114 21463.0161   16  245 20606.9905 24689.4879  19.8% 10563 2979s
  3894  2147 21258.8278   17  250 20606.9905 24669.3515  19.7% 10589 3026s
  3961  2176 21103.5551   18  232 20606.9905 24669.3515  19.7% 10581 3084s
  4074  2244 20752.9901   21  203 20606.9905 24665.4500  19.7% 10541 3145s
  4237  2275 23367.6898    9  247 20606.9905 24630.8895  19.5% 10559 3211s
  4353  2363 22362.0677   14  201 20606.9905 24622.3620  19.5% 10554 3276s
  4553  2458 infeasible   24      20606.9905 24622.3620  19.5% 10546 3351s
  4810  2591     cutoff   23      20606.9905 24578.5506  19.3% 10522 3432s

Cutting planes:
  Learned: 2
  Gomory: 27
  Implied bound: 414
  MIR: 3750
  Flow cover: 3690
  RLT: 67
  Relax-and-lift: 550
  BQP: 1

Explored 5081 nodes (54194422 simplex iterations) in 3600.04 seconds (10385.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20607 20589.8 20561.5 ... 19975.8

Time limit reached
Best objective 2.060699047285e+04, best bound 2.453378804452e+04, gap 19.0557%
  WARNING: Time limit reached. Using best solution found (gap: 19.06%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 20606.99, θ = 140834.85
  Upper Bound (UB) = 20606.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140834.85
  [DEBUG]   ✓ Scenario 0: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 140834.85 ≤ Q = 140834.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 140834.85 ≤ Q = 140834.85 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x54d92d3f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xab26d2c1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7502957.0506
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.354421e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135442.10    0  123 7502957.05 -135442.10   102%     -    0s
H    0     0                    -100492.6115 -135442.10  34.8%     -    0s
     0     0 -106870.96    0   85 -100492.61 -106870.96  6.35%     -    0s
H    0     0                    -104744.8743 -106826.20  1.99%     -    0s
H    0     0                    -105507.6775 -106826.20  1.25%     -    0s
     0     0 -106339.40    0   89 -105507.68 -106339.40  0.79%     -    0s
     0     0 -106324.00    0   72 -105507.68 -106324.00  0.77%     -    0s
     0     0 -106152.76    0   83 -105507.68 -106152.76  0.61%     -    0s
     0     0 -106150.08    0   83 -105507.68 -106150.08  0.61%     -    0s
H    0     0                    -105533.3376 -106144.38  0.58%     -    0s
     0     2 -106144.38    0   83 -105533.34 -106144.38  0.58%     -    0s
H   34    30                    -105600.2318 -105964.32  0.34%  15.3    0s
H  103   134                    -105888.5248 -105962.01  0.07%   9.2    0s
*  262    77              12    -105905.7921 -105955.58  0.05%   5.8    0s
*  413     4              17    -105911.9663 -105955.58  0.04%   4.6    0s

Cutting planes:
  Gomory: 16
  Implied bound: 1
  MIR: 165
  Flow cover: 12
  RLT: 30
  Relax-and-lift: 3
  BQP: 4

Explored 476 nodes (2644 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -105912 -105906 -105889 ... 1.4374e+13
No other solutions better than -105912

Optimal solution found (tolerance 1.00e-04)
Best objective -1.059119662740e+05, best bound -1.059119662740e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 138417.46
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105911.97
  [DEBUG]   S×d_nominal = 244329.43
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244329.43 + -105911.97 = 138417.46
  [DEBUG]   Current θ from Master = 140834.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2417.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18189.60
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 763.0536, Absolute Gap = 763.0536, Relative Gap = 0.037029
  Not converged yet (gap = 763.05 > ε = 200)

  [DEBUG] Adding NEW scenario 25 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 25 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 25 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 25]
    [DEBUG]   - Total constraints in model: 398923
    [DEBUG]   - Total variables in model: 164500
  [DEBUG] Total scenarios in Master: 26
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 26
================================================================================
[Iteration 26] Solving Master Problem...
  Current scenarios in Master: 26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 398923 rows, 164500 columns and 1129759 nonzeros
Model fingerprint: 0x4c08307b
Variable types: 162241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 175942 rows and 71422 columns
Presolve time: 4.88s
Presolved: 222981 rows, 93078 columns, 1371451 nonzeros
Variable types: 90819 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.98s

Barrier statistics:
 Dense cols : 1221
 AA' NZ     : 6.058e+06
 Factor NZ  : 1.727e+07 (roughly 270 MB of memory)
 Factor Ops : 6.721e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.03422710e+07  3.52461713e+08  1.17e+05 1.56e+01  7.63e+04     9s
   1  -1.59171822e+07  3.06727554e+08  8.49e+04 5.53e+01  5.49e+04     9s
   2  -6.01355444e+06  2.40649275e+08  3.19e+04 1.43e+00  2.17e+04     9s
   3  -1.75093312e+06  2.18004343e+08  5.27e+03 1.07e+01  4.00e+03     9s
   4  -9.47209948e+05  1.77669727e+08  1.26e+03 6.85e+00  1.24e+03     9s
   5  -7.90365959e+05  1.14941816e+08  5.06e+02 3.96e+00  5.87e+02    10s
   6  -7.34201598e+05  7.63917809e+07  2.69e+02 2.40e+00  3.39e+02    10s
   7  -5.26376186e+05  6.11984631e+07  1.01e+02 1.84e+00  2.05e+02    10s
   8  -4.63863774e+05  4.08450984e+07  4.54e+01 1.11e+00  1.23e+02    10s
   9  -3.45439901e+05  2.85969127e+07  1.15e+01 6.67e-01  7.58e+01    10s
  10  -2.96555322e+05  1.91772494e+07  7.37e+00 3.84e-01  5.01e+01    10s
  11  -1.97081563e+05  9.88527647e+06  3.89e+00 1.10e-01  2.55e+01    10s
  12  -1.47228346e+05  6.28007501e+06  2.46e+00 5.03e-02  1.61e+01    10s
  13  -1.34735663e+05  5.09091914e+06  2.02e+00 8.01e-02  1.31e+01    10s
  14  -1.08084694e+05  3.23438723e+06  1.27e+00 5.59e-03  8.32e+00    10s
  15  -9.28101393e+04  2.56495553e+06  9.32e-01 4.40e-03  6.61e+00    10s
  16  -5.45100118e+04  1.76724476e+06  3.18e-01 2.69e-02  4.51e+00    10s
  17  -3.47714324e+04  4.75334584e+05  1.54e-01 7.61e-04  1.26e+00    10s
  18  -1.86785632e+04  3.09103318e+05  1.01e-01 4.37e-04  8.10e-01    10s
  19  -8.24015085e+03  2.34562200e+05  7.38e-02 3.69e-04  6.00e-01    11s
  20  -1.31670220e+03  1.69317225e+05  6.05e-02 1.24e-03  4.22e-01    11s
  21   3.34200003e+03  1.12902094e+05  5.22e-02 1.57e-03  2.71e-01    11s
  22   9.61693311e+03  9.65447945e+04  4.22e-02 1.99e-03  2.15e-01    11s
  23   1.23811750e+04  8.43770786e+04  3.79e-02 2.46e-03  1.78e-01    11s
  24   1.66834649e+04  7.52166082e+04  3.14e-02 2.26e-03  1.45e-01    11s
  25   2.01350643e+04  6.83300084e+04  2.63e-02 2.65e-03  1.19e-01    11s
  26   2.22286832e+04  6.38611473e+04  2.33e-02 3.00e-03  1.03e-01    11s
  27   2.63541754e+04  5.88917805e+04  1.76e-02 2.83e-03  8.04e-02    11s
  28   2.85777098e+04  5.52034464e+04  1.48e-02 2.24e-03  6.58e-02    11s
  29   3.10988203e+04  5.31798204e+04  1.16e-02 1.92e-03  5.46e-02    11s
  30   3.33968749e+04  5.09052733e+04  8.89e-03 1.54e-03  4.33e-02    11s
  31   3.52234832e+04  4.94285162e+04  6.73e-03 1.31e-03  3.51e-02    12s
  32   3.66068371e+04  4.76498274e+04  5.21e-03 1.01e-03  2.73e-02    12s
  33   3.77884165e+04  4.64766248e+04  3.90e-03 8.16e-04  2.15e-02    12s
  34   3.88258656e+04  4.49349059e+04  2.82e-03 5.62e-04  1.51e-02    12s
  35   3.91298663e+04  4.42040936e+04  2.52e-03 4.33e-04  1.25e-02    12s
  36   3.93416043e+04  4.40925352e+04  2.32e-03 4.13e-04  1.17e-02    12s
  37   3.94411088e+04  4.39144432e+04  2.23e-03 3.81e-04  1.11e-02    12s
  38   3.97320030e+04  4.35529380e+04  1.94e-03 3.12e-04  9.44e-03    12s
  39   4.01837212e+04  4.30361099e+04  1.51e-03 2.19e-04  7.05e-03    12s
  40   4.06101830e+04  4.29565942e+04  1.12e-03 2.03e-04  5.80e-03    13s
  41   4.08430071e+04  4.24684718e+04  9.03e-04 1.31e-04  4.02e-03    13s
  42   4.08979860e+04  4.23450260e+04  8.52e-04 1.06e-04  3.58e-03    13s
  43   4.09642470e+04  4.23033201e+04  7.93e-04 9.68e-05  3.31e-03    13s
  44   4.11476604e+04  4.22254844e+04  6.24e-04 7.94e-05  2.66e-03    13s
  45   4.12584439e+04  4.20556345e+04  5.23e-04 5.10e-05  1.97e-03    13s
  46   4.14194659e+04  4.19839253e+04  3.77e-04 2.97e-05  1.39e-03    13s
  47   4.14738494e+04  4.19486785e+04  3.29e-04 1.57e-05  1.17e-03    13s
  48   4.15355630e+04  4.19254917e+04  2.74e-04 1.13e-05  9.64e-04    13s
  49   4.15840266e+04  4.19149427e+04  2.31e-04 1.10e-05  8.18e-04    13s
  50   4.16681840e+04  4.18813272e+04  1.58e-04 5.76e-05  5.27e-04    14s
  51   4.18192377e+04  4.18650328e+04  2.81e-05 1.39e-05  1.13e-04    14s
  52   4.18543296e+04  4.18576938e+04  1.35e-06 5.41e-07  8.31e-06    14s
  53   4.18571017e+04  4.18571237e+04  6.63e-09 3.97e-07  5.44e-08    14s
  54   4.18571199e+04  4.18571199e+04  7.86e-10 5.19e-11  8.88e-12    14s

Barrier solved model in 54 iterations and 13.93 seconds (23.29 work units)
Optimal objective 4.18571199e+04


Root crossover log...

  196832 DPushes remaining with DInf 0.0000000e+00                14s
   75373 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    3097 PPushes remaining with PInf 4.9696628e-06                20s
     523 PPushes remaining with PInf 0.0000000e+00                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9943678e-10     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   82792    4.1857120e+04   0.000000e+00   0.000000e+00     20s
   82792    4.1857120e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 2.58s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185712e+04, 82792 iterations, 16.77 seconds (31.93 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41857.1199    0  194 -208513.72 41857.1199   120%     -   23s
H    0     0                    -82743.43350 41857.1199   151%     -   24s
H    0     0                    -82532.14251 41857.1199   151%     -   24s
H    0     0                    -40634.99258 41857.1199   203%     -   24s
H    0     0                    14710.580822 41857.1199   185%     -   25s
H    0     0                    16002.000652 41857.1199   162%     -   26s
H    0     0                    16006.970882 41857.1199   161%     -   26s
H    0     0                    16041.561662 41857.1199   161%     -   26s
H    0     0                    16045.775665 41857.1199   161%     -   26s
H    0     0                    16091.047518 41857.1199   160%     -   26s
H    0     0                    16104.703865 41857.1199   160%     -   26s
H    0     0                    16110.769001 41857.1199   160%     -   26s
H    0     0                    16169.304523 41857.1199   159%     -   26s
     0     0 37322.8424    0  186 16169.3045 37322.8424   131%     -   91s
H    0     0                    16200.973038 37322.8309   130%     -   92s
H    0     0                    16250.729081 37322.8309   130%     -   92s
     0     0 36451.0553    0  281 16250.7291 36451.0553   124%     -  128s
     0     0 36072.2186    0  330 16250.7291 36072.2186   122%     -  151s
     0     0 36030.5781    0  338 16250.7291 36030.5781   122%     -  158s
     0     0 35917.0445    0  304 16250.7291 35917.0445   121%     -  174s
     0     0 35904.0285    0  365 16250.7291 35904.0285   121%     -  182s
     0     0 35891.8513    0  363 16250.7291 35891.8513   121%     -  186s
     0     0 35888.3970    0  361 16250.7291 35888.3970   121%     -  195s
     0     0 35620.1258    0  287 16250.7291 35620.1258   119%     -  212s
     0     0 35601.3184    0  300 16250.7291 35601.3184   119%     -  220s
     0     0 35601.1752    0  300 16250.7291 35601.1752   119%     -  222s
     0     0 31936.5853    0  237 16250.7291 31936.5853  96.5%     -  277s
H    0     0                    18414.285415 31935.7643  73.4%     -  278s
H    0     0                    18534.725146 31935.7643  72.3%     -  278s
H    0     0                    18763.138858 31935.7643  70.2%     -  278s
     0     0 31103.4352    0  245 18763.1389 31103.4352  65.8%     -  331s
     0     0 30909.4182    0  320 18763.1389 30909.4182  64.7%     -  362s
     0     0 30848.4846    0  324 18763.1389 30848.4846  64.4%     -  381s
     0     0 30834.5360    0  315 18763.1389 30834.5360  64.3%     -  391s
     0     0 30810.1817    0  317 18763.1389 30810.1817  64.2%     -  396s
     0     0 30809.5512    0  317 18763.1389 30809.5512  64.2%     -  399s
     0     0 28858.4743    0  275 18763.1389 28858.4743  53.8%     -  470s
H    0     0                    18798.751528 28857.9548  53.5%     -  472s
H    0     0                    18903.332530 28857.9548  52.7%     -  472s
H    0     0                    18931.179918 28857.9548  52.4%     -  472s
     0     0 28522.8355    0  339 18931.1799 28522.8355  50.7%     -  526s
     0     0 28362.6396    0  327 18931.1799 28362.6396  49.8%     -  568s
     0     0 28324.2111    0  314 18931.1799 28324.2111  49.6%     -  589s
     0     0 28279.0193    0  341 18931.1799 28279.0193  49.4%     -  611s
     0     0 28260.1389    0  338 18931.1799 28260.1389  49.3%     -  627s
     0     0 28244.4348    0  337 18931.1799 28244.4348  49.2%     -  634s
     0     0 28238.6303    0  335 18931.1799 28238.6303  49.2%     -  638s
     0     0 28231.9287    0  334 18931.1799 28231.9287  49.1%     -  647s
     0     0 28230.2332    0  338 18931.1799 28230.2332  49.1%     -  653s
     0     0 27628.9460    0  362 18931.1799 27628.9460  45.9%     -  700s
H    0     0                    18970.089047 27628.4424  45.6%     -  701s
H    0     0                    19122.722321 27628.4424  44.5%     -  701s
H    0     0                    19139.270388 27628.4424  44.4%     -  701s
H    0     0                    19148.870784 27628.4424  44.3%     -  701s
H    0     0                    19167.564642 27628.4424  44.1%     -  702s
     0     0 27501.3078    0  380 19167.5646 27501.3078  43.5%     -  724s
     0     0 27478.1518    0  367 19167.5646 27478.1518  43.4%     -  736s
     0     0 27455.0118    0  378 19167.5646 27455.0118  43.2%     -  747s
     0     0 27441.1462    0  390 19167.5646 27441.1462  43.2%     -  756s
     0     0 27436.7125    0  383 19167.5646 27436.7125  43.1%     -  761s
     0     0 27427.8401    0  379 19167.5646 27427.8401  43.1%     -  767s
     0     0 27386.9447    0  420 19167.5646 27386.9447  42.9%     -  783s
     0     0 27376.8915    0  372 19167.5646 27376.8915  42.8%     -  791s
     0     0 27367.6055    0  359 19167.5646 27367.6055  42.8%     -  813s
     0     0 27362.6149    0  364 19167.5646 27362.6149  42.8%     -  820s
     0     0 27355.4421    0  356 19167.5646 27355.4421  42.7%     -  827s
     0     0 27353.3131    0  366 19167.5646 27353.3131  42.7%     -  830s
     0     0 27352.2928    0  360 19167.5646 27352.2928  42.7%     -  833s
     0     0 27333.3742    0  362 19167.5646 27333.3742  42.6%     -  853s
     0     0 27329.6725    0  363 19167.5646 27329.6725  42.6%     -  861s
     0     0 27329.1969    0  244 19167.5646 27329.1969  42.6%     -  867s
     0     0 27313.3271    0  245 19167.5646 27313.3271  42.5%     -  881s
H    0     0                    19215.208015 27313.2291  42.1%     -  883s
     0     0 27310.6169    0  414 19215.2080 27310.6169  42.1%     -  890s
     0     0 27309.2498    0  399 19215.2080 27309.2498  42.1%     -  892s
     0     0 27295.1881    0  423 19215.2080 27295.1881  42.0%     -  903s
     0     0 27290.1535    0  330 19215.2080 27290.1535  42.0%     -  909s
     0     0 27289.4655    0  325 19215.2080 27289.4655  42.0%     -  912s
     0     0 27285.9156    0  267 19215.2080 27285.9156  42.0%     -  920s
H    0     0                    19222.742916 27285.8954  41.9%     -  921s
H    0     0                    19285.847818 27285.8954  41.5%     -  921s
H    0     0                    19343.002430 27285.8954  41.1%     -  921s
H    0     0                    19348.342424 27285.8954  41.0%     -  921s
     0     0 27284.7672    0  420 19348.3424 27284.7672  41.0%     -  928s
     0     0 27283.1331    0  235 19348.3424 27283.1331  41.0%     -  932s
     0     0 27282.5707    0  235 19348.3424 27282.5707  41.0%     -  933s
     0     0 27282.5707    0  226 19348.3424 27282.5707  41.0%     -  936s
     0     0 27282.5707    0  226 19348.3424 27282.5707  41.0%     -  945s
H    0     0                    19593.062007 27282.5707  39.2%     -  993s
     0     2 27282.5065    0  226 19593.0620 27282.5065  39.2%     - 1022s
     1     4 27111.8972    1  362 19593.0620 27282.2617  39.2% 15492 1054s
     3     8 27072.0451    2  349 19593.0620 27111.8142  38.4% 17455 1072s
     7    12 25847.3269    3  358 19593.0620 27071.9890  38.2% 16444 1121s
    11    24 26343.1292    4  390 19593.0620 27071.9890  38.2% 21427 1161s
    23    36 26186.3567    4  408 19593.0620 26817.2822  36.9% 22161 1222s
    35    68 25687.2768    5  359 19593.0620 26817.2822  36.9% 24355 1442s
H   37    68                    19669.098067 26817.2822  36.3% 24388 1442s
H   42    68                    19852.843814 26817.2822  35.1% 25470 1442s
    67   183 25428.7569    6  290 19852.8438 26295.6622  32.5% 48334 1515s
   186   219 25372.3983   10  288 19852.8438 26295.5381  32.5% 21847 1566s
H  200   219                    19853.831627 26295.5381  32.4% 20495 1566s
   222   254 25334.6030   11  288 19853.8316 26295.5381  32.4% 19213 1604s
   278   278 25019.3225    9  274 19853.8316 26295.5381  32.4% 16478 1670s
   313   300 24751.2759   10  260 19853.8316 26295.5381  32.4% 15600 1744s
   350   330 24493.2602   11  270 19853.8316 26295.5381  32.4% 14433 1824s
H  370   330                    20057.055384 26295.5381  31.1% 14007 1824s
   390   371 20536.7241   13  201 20057.0554 26295.5381  31.1% 13800 1864s
   447   388 20483.7961   14  212 20057.0554 26295.5381  31.1% 12701 1901s
   470   403 20470.0662   15  218 20057.0554 26295.5381  31.1% 12463 1958s
H  472   403                    20264.553967 26295.5381  29.8% 12414 1958s
H  484   403                    20271.893865 26295.5381  29.7% 12298 1958s
H  489   403                    20278.535474 26295.5381  29.7% 12216 1958s
   493   444 20459.5092   16  216 20278.5355 26295.5381  29.7% 12173 1998s
   569   470 20353.5578   21  166 20278.5355 26295.5381  29.7% 11123 2033s
   649   513 21419.3644   18  348 20278.5355 26295.5381  29.7% 10201 2063s
   731   541 21322.1260   22  288 20278.5355 26295.5381  29.7%  9487 2095s
   804   550 20904.2858   26  256 20278.5355 26295.5381  29.7%  8999 2126s
   878   552 infeasible   28      20278.5355 26295.5381  29.7%  8532 2156s
   938   552 24748.0928   11  322 20278.5355 26295.5381  29.7%  8296 2192s
   988   561 21273.6086   18  260 20278.5355 26295.5381  29.7%  8115 2228s
  1030   619 21598.7389    7  270 20278.5355 26295.5381  29.7%  8003 2261s
  1104   629 21420.5011    9  241 20278.5355 26295.5381  29.7%  7750 2296s
  1192   634 infeasible   10      20278.5355 25835.6377  27.4%  7660 2335s
  1261   659 20731.1310   10  257 20278.5355 25835.6377  27.4%  7577 2441s
  1294   684 infeasible   11      20278.5355 25835.6377  27.4%  7615 2567s
  1339   708 infeasible    9      20278.5355 25835.6377  27.4%  7557 2659s
H 1342   708                    20311.267537 25835.6377  27.2%  7548 2659s
  1383   811 20962.3385   10  233 20311.2675 25835.6377  27.2%  7454 2702s
  1550   869 20470.7818   14  198 20311.2675 25835.6377  27.2%  7017 2746s
  1707   886 infeasible   11      20311.2675 25835.6377  27.2%  6699 2795s
  1820   898 21801.3245   13  333 20311.2675 25835.6377  27.2%  6541 2879s
  1856   927 21675.4470   14  299 20311.2675 25835.6377  27.2%  6607 2967s
H 1869   927                    20405.899641 25835.6377  26.6%  6628 2967s
  1903   956 21346.4244   15  288 20405.8996 25835.6377  26.6%  6656 3019s
  1983  1015 21122.3979   16  286 20405.8996 25835.6377  26.6%  6650 3077s
  2082  1070 20540.5072   19  202 20405.8996 25835.6377  26.6%  6615 3133s
  2195  1121 20597.9005   18  223 20405.8996 25636.1953  25.6%  6588 3191s
  2301  1194 20814.9149   12  234 20405.8996 25636.1953  25.6%  6554 3254s
  2464  1241 20686.1285   13  228 20405.8996 25636.1953  25.6%  6391 3312s
  2625  1297 22789.7695   12  232 20405.8996 25636.1953  25.6%  6327 3378s
  2754  1360 22173.9366   14  185 20405.8996 25636.1953  25.6%  6328 3445s
H 2756  1360                    20455.082492 25636.1953  25.3%  6328 3445s
H 2781  1360                    20471.886243 25489.4130  24.5%  6288 3445s
H 2786  1360                    20484.568521 25489.4130  24.4%  6286 3445s
H 2790  1360                    20508.768726 25489.4130  24.3%  6298 3445s
H 2810  1360                    20547.694759 25489.4130  24.0%  6306 3445s
  2916  1385 22122.0406   15  186 20547.6948 25489.4130  24.0%  6218 3517s
  3023  1421     cutoff   18      20547.6948 25489.4130  24.0%  6291 3600s

Cutting planes:
  Learned: 2
  Gomory: 36
  Implied bound: 353
  MIR: 3864
  Flow cover: 3597
  RLT: 63
  Relax-and-lift: 623

Explored 3129 nodes (20681601 simplex iterations) in 3600.08 seconds (8397.87 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20547.7 20508.8 20484.6 ... 20264.6

Time limit reached
Best objective 2.054769475910e+04, best bound 2.548941299068e+04, gap 24.0500%
  WARNING: Time limit reached. Using best solution found (gap: 24.05%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 20547.69, θ = 140990.58
  Upper Bound (UB) = 20547.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140990.58
  [DEBUG]   ✓ Scenario 0: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 140990.58 ≤ Q = 140990.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 140990.58 ≤ Q = 140990.58 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 26] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3cd6b085
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc3294f7b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.438343e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7515730.0230
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.355533e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135553.27    0  123 7515730.02 -135553.27   102%     -    0s
H    0     0                    -100598.0159 -135553.27  34.7%     -    0s
     0     0 -108112.21    0   88 -100598.02 -108112.21  7.47%     -    0s
H    0     0                    -105354.2352 -108005.69  2.52%     -    0s
H    0     0                    -105946.1936 -107353.41  1.33%     -    0s
     0     0 -107353.41    0   88 -105946.19 -107353.41  1.33%     -    0s
     0     0 -106957.03    0   89 -105946.19 -106957.03  0.95%     -    0s
     0     0 -106909.13    0   85 -105946.19 -106909.13  0.91%     -    0s
     0     0 -106895.68    0   84 -105946.19 -106895.68  0.90%     -    0s
     0     0 -106626.01    0   57 -105946.19 -106626.01  0.64%     -    0s
H    0     0                    -105982.8225 -106624.52  0.61%     -    0s
     0     0 -106533.68    0   63 -105982.82 -106533.68  0.52%     -    0s
     0     0 -106500.16    0   61 -105982.82 -106500.16  0.49%     -    0s
     0     0 -106500.02    0   61 -105982.82 -106500.02  0.49%     -    0s
     0     0 -106452.13    0   54 -105982.82 -106452.13  0.44%     -    0s
     0     0 -106444.17    0   54 -105982.82 -106444.17  0.44%     -    0s
H    0     0                    -106021.6453 -106444.17  0.40%     -    0s
H    0     0                    -106210.8362 -106444.17  0.22%     -    0s
H    0     0                    -106312.8726 -106444.17  0.12%     -    0s
     0     0 -106444.17    0   76 -106312.87 -106444.17  0.12%     -    0s
     0     0 -106444.17    0   54 -106312.87 -106444.17  0.12%     -    0s
     0     0 -106440.80    0   50 -106312.87 -106440.80  0.12%     -    0s
     0     0 -106421.79    0   49 -106312.87 -106421.79  0.10%     -    0s
     0     0 -106421.17    0   49 -106312.87 -106421.17  0.10%     -    0s
     0     0 -106381.11    0   44 -106312.87 -106381.11  0.06%     -    0s
     0     0 -106372.20    0   44 -106312.87 -106372.20  0.06%     -    0s
     0     0 -106372.20    0   43 -106312.87 -106372.20  0.06%     -    0s
     0     0 -106353.04    0    6 -106312.87 -106353.04  0.04%     -    0s
     0     0 -106352.27    0    6 -106312.87 -106352.27  0.04%     -    0s
     0     0 -106352.27    0   14 -106312.87 -106352.27  0.04%     -    0s
     0     0 -106352.27    0    8 -106312.87 -106352.27  0.04%     -    0s
     0     0 -106333.38    0    4 -106312.87 -106333.38  0.02%     -    0s
H    0     0                    -106325.1568 -106333.38  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 5
  MIR: 7
  Flow cover: 2
  Relax-and-lift: 1

Explored 1 nodes (1219 simplex iterations) in 0.11 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106325 -106313 -106253 ... 1.43834e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.063251567733e+05, best bound -1.063258185627e+05, gap 0.0006%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 138306.86
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106325.16
  [DEBUG]   S×d_nominal = 244632.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244632.02 + -106325.16 = 138306.86
  [DEBUG]   Current θ from Master = 140990.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2683.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17863.98
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 703.7579, Absolute Gap = 703.7579, Relative Gap = 0.034250
  Not converged yet (gap = 703.76 > ε = 200)

  [DEBUG] Adding NEW scenario 26 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 26 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 26 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 26]
    [DEBUG]   - Total constraints in model: 414213
    [DEBUG]   - Total variables in model: 170740
  [DEBUG] Total scenarios in Master: 27
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 27
================================================================================
[Iteration 27] Solving Master Problem...
  Current scenarios in Master: 27
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 414213 rows, 170740 columns and 1172999 nonzeros
Model fingerprint: 0x349ad152
Variable types: 168481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 182709 rows and 74169 columns (presolve time = 5s)...
Presolve removed 182709 rows and 74169 columns
Presolve time: 5.10s
Presolved: 231504 rows, 96571 columns, 1423327 nonzeros
Variable types: 94312 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.26s

Barrier statistics:
 Dense cols : 1218
 AA' NZ     : 6.465e+06
 Factor NZ  : 1.845e+07 (roughly 300 MB of memory)
 Factor Ops : 7.339e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.05724834e+07  3.63339580e+08  1.19e+05 1.55e+01  7.68e+04    10s
   1  -1.61731536e+07  3.16194433e+08  8.63e+04 5.54e+01  5.54e+04    10s
   2  -6.13797684e+06  2.48125650e+08  3.25e+04 1.15e+00  2.20e+04    10s
   3  -1.72073675e+06  2.24257536e+08  5.10e+03 1.01e+01  3.86e+03    10s
   4  -9.53852466e+05  1.84094714e+08  1.29e+03 6.64e+00  1.25e+03    10s
   5  -7.91794494e+05  1.23343127e+08  5.10e+02 4.02e+00  5.98e+02    10s
   6  -7.38072630e+05  8.38651318e+07  2.79e+02 2.50e+00  3.56e+02    10s
   7  -6.54021400e+05  6.69302465e+07  1.07e+02 1.92e+00  2.17e+02    10s
   8  -4.77469769e+05  4.64925427e+07  4.74e+01 1.23e+00  1.34e+02    10s
   9  -3.73353249e+05  3.24128019e+07  1.21e+01 7.38e-01  8.27e+01    10s
  10  -2.64442022e+05  2.20585441e+07  4.66e+00 2.46e-01  5.45e+01    10s
  11  -1.84273345e+05  9.27295445e+06  2.29e+00 1.49e-02  2.28e+01    10s
  12  -1.51845654e+05  6.11157863e+06  1.66e+00 9.66e-03  1.51e+01    11s
  13  -1.17349669e+05  4.58256891e+06  1.02e+00 2.60e-02  1.13e+01    11s
  14  -9.43757654e+04  3.09650957e+06  6.37e-01 4.91e-03  7.62e+00    11s
  15  -7.41757227e+04  2.40725030e+06  3.62e-01 3.79e-03  5.92e+00    11s
  16  -4.84198549e+04  1.68129938e+06  1.26e-01 9.34e-03  4.12e+00    11s
  17  -3.55821811e+04  7.81654070e+05  8.01e-02 1.16e-03  1.94e+00    11s
  18  -1.49591917e+04  4.15411619e+05  3.83e-02 5.96e-04  1.02e+00    11s
  19  -6.94773446e+03  2.45257392e+05  2.94e-02 3.78e-04  6.00e-01    11s
  20   1.35104108e+03  1.81511116e+05  2.29e-02 4.37e-04  4.29e-01    11s
  21   4.97541830e+03  1.53210771e+05  2.01e-02 4.43e-04  3.53e-01    11s
  22   6.37650794e+03  1.41784894e+05  1.91e-02 1.78e-03  3.22e-01    11s
  23   1.12445133e+04  1.04580233e+05  1.56e-02 1.35e-03  2.22e-01    11s
  24   1.36523715e+04  9.40559658e+04  1.42e-02 1.20e-03  1.91e-01    11s
  25   1.71641544e+04  8.23143627e+04  1.20e-02 1.39e-03  1.55e-01    12s
  26   1.97230159e+04  7.44310648e+04  1.05e-02 1.82e-03  1.30e-01    12s
  27   2.25642219e+04  6.73472230e+04  8.91e-03 9.84e-04  1.07e-01    12s
  28   2.70605243e+04  6.14105838e+04  6.50e-03 2.26e-03  8.17e-02    12s
  29   2.81768956e+04  5.42550922e+04  5.91e-03 1.32e-03  6.20e-02    12s
  30   2.95766709e+04  5.27915871e+04  5.28e-03 1.17e-03  5.52e-02    12s
  31   3.23177077e+04  5.01339010e+04  4.02e-03 8.22e-04  4.24e-02    12s
  32   3.27153463e+04  4.83226142e+04  3.85e-03 6.49e-04  3.71e-02    12s
  33   3.45185854e+04  4.70932283e+04  3.04e-03 5.29e-04  2.99e-02    12s
  34   3.59794458e+04  4.60962382e+04  2.41e-03 4.29e-04  2.41e-02    12s
  35   3.70437508e+04  4.42245766e+04  1.95e-03 6.16e-04  1.71e-02    13s
  36   3.82787593e+04  4.36125750e+04  1.45e-03 4.52e-04  1.27e-02    13s
  37   3.93797522e+04  4.30375677e+04  9.81e-04 3.99e-04  8.70e-03    13s
  38   4.00935442e+04  4.26314565e+04  6.85e-04 2.54e-04  6.04e-03    13s
  39   4.05329557e+04  4.24514652e+04  5.05e-04 2.00e-04  4.56e-03    13s
  40   4.11626172e+04  4.23149629e+04  2.52e-04 1.60e-04  2.74e-03    13s
  41   4.11977038e+04  4.22739270e+04  2.38e-04 1.46e-04  2.56e-03    13s
  42   4.13668815e+04  4.21059295e+04  1.72e-04 8.86e-05  1.76e-03    13s
  43   4.14627357e+04  4.19523449e+04  1.36e-04 3.58e-05  1.16e-03    13s
  44   4.16144872e+04  4.18946516e+04  7.98e-05 1.81e-05  6.66e-04    14s
  45   4.16429779e+04  4.18732732e+04  6.86e-05 1.21e-05  5.48e-04    14s
  46   4.17008010e+04  4.18470024e+04  4.70e-05 4.24e-06  3.48e-04    14s
  47   4.17315135e+04  4.18465896e+04  3.57e-05 4.14e-06  2.74e-04    14s
  48   4.17611025e+04  4.18417629e+04  2.49e-05 2.97e-06  1.92e-04    14s
  49   4.17631710e+04  4.18398198e+04  2.41e-05 2.48e-06  1.82e-04    14s
  50   4.18067971e+04  4.18357621e+04  7.97e-06 1.37e-06  6.89e-05    14s
  51   4.18282404e+04  4.18305843e+04  6.66e-07 1.22e-06  5.57e-06    14s
  52   4.18302568e+04  4.18302884e+04  1.42e-07 6.62e-08  7.52e-08    14s
  53   4.18302771e+04  4.18302771e+04  1.23e-09 7.50e-11  3.08e-11    14s

Barrier solved model in 53 iterations and 14.36 seconds (23.47 work units)
Optimal objective 4.18302771e+04


Root crossover log...

  204577 DPushes remaining with DInf 0.0000000e+00                14s
  103302 DPushes remaining with DInf 0.0000000e+00                15s
    1586 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    3620 PPushes remaining with PInf 1.6763579e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.9456103e-03     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   84480    4.1830277e+04   0.000000e+00   7.945610e-03     21s
   84481    4.1830277e+04   0.000000e+00   0.000000e+00     21s
   84481    4.1830277e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 1.11s

Solved with barrier

Root relaxation: objective 4.183028e+04, 84481 iterations, 15.97 seconds (32.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41830.2771    0  193 -208513.72 41830.2771   120%     -   23s
H    0     0                    -88107.16139 41830.2771   147%     -   24s
H    0     0                    -87098.63284 41830.2771   148%     -   24s
H    0     0                    -44754.57740 41830.2771   193%     -   24s
H    0     0                    8754.0440302 41830.2771   378%     -   25s
H    0     0                    14496.612029 41830.2771   189%     -   25s
H    0     0                    15619.260980 41830.2771   168%     -   26s
H    0     0                    15704.696144 41830.2771   166%     -   26s
H    0     0                    15725.917432 41830.2771   166%     -   26s
H    0     0                    15746.492396 41830.2771   166%     -   26s
H    0     0                    15840.321390 41830.2771   164%     -   26s
H    0     0                    15930.094417 41830.2771   163%     -   26s
H    0     0                    15948.096027 41830.2771   162%     -   26s
H    0     0                    15948.534915 41830.2771   162%     -   26s
H    0     0                    15988.614052 41830.2771   162%     -   26s
H    0     0                    15991.291982 41830.2771   162%     -   26s
H    0     0                    16017.772263 41830.2771   161%     -   26s
     0     0 37016.5948    0  319 16017.7723 37016.5948   131%     -  106s
H    0     0                    16019.692767 37016.5818   131%     -  108s
H    0     0                    16046.027080 37016.5818   131%     -  108s
H    0     0                    16095.279636 37016.5818   130%     -  108s
H    0     0                    16139.496146 37016.5818   129%     -  108s
H    0     0                    16140.438085 37016.5818   129%     -  108s
     0     0 36718.7846    0  279 16140.4381 36718.7846   127%     -  140s
     0     0 36619.7044    0  287 16140.4381 36619.7044   127%     -  158s
     0     0 36611.1250    0  293 16140.4381 36611.1250   127%     -  169s
     0     0 36529.3969    0  288 16140.4381 36529.3969   126%     -  183s
     0     0 36525.8629    0  287 16140.4381 36525.8629   126%     -  189s
     0     0 36335.5924    0  292 16140.4381 36335.5924   125%     -  201s
     0     0 36041.7722    0  298 16140.4381 36041.7722   123%     -  227s
     0     0 35959.2836    0  301 16140.4381 35959.2836   123%     -  241s
     0     0 35957.7153    0  305 16140.4381 35957.7153   123%     -  244s
     0     0 35957.7153    0  305 16140.4381 35957.7153   123%     -  246s
     0     0 31970.0779    0  234 16140.4381 31970.0779  98.1%     -  308s
H    0     0                    18908.875812 31970.0353  69.1%     -  309s
H    0     0                    18956.471947 31970.0353  68.6%     -  310s
H    0     0                    18970.452136 31970.0353  68.5%     -  310s
     0     0 31496.8003    0  224 18970.4521 31496.8003  66.0%     -  355s
     0     0 31410.5075    0  234 18970.4521 31410.5075  65.6%     -  376s
     0     0 31346.3752    0  310 18970.4521 31346.3752  65.2%     -  396s
     0     0 31280.3029    0  318 18970.4521 31280.3029  64.9%     -  411s
     0     0 31276.9688    0  325 18970.4521 31276.9688  64.9%     -  415s
     0     0 31199.4825    0  330 18970.4521 31199.4825  64.5%     -  436s
     0     0 31183.9622    0  322 18970.4521 31183.9622  64.4%     -  448s
     0     0 31173.5535    0  285 18970.4521 31173.5535  64.3%     -  456s
     0     0 31171.2695    0  288 18970.4521 31171.2695  64.3%     -  460s
     0     0 30981.6423    0  274 18970.4521 30981.6423  63.3%     -  483s
     0     0 30949.8796    0  272 18970.4521 30949.8796  63.1%     -  491s
     0     0 30945.1341    0  284 18970.4521 30945.1341  63.1%     -  495s
     0     0 30938.9328    0  275 18970.4521 30938.9328  63.1%     -  500s
     0     0 30932.6436    0  273 18970.4521 30932.6436  63.1%     -  508s
     0     0 30907.0806    0  277 18970.4521 30907.0806  62.9%     -  518s
     0     0 30904.9531    0  279 18970.4521 30904.9531  62.9%     -  522s
     0     0 30903.0377    0  278 18970.4521 30903.0377  62.9%     -  525s
     0     0 30900.3352    0  277 18970.4521 30900.3352  62.9%     -  529s
     0     0 30898.4190    0  283 18970.4521 30898.4190  62.9%     -  532s
     0     0 30877.6502    0  283 18970.4521 30877.6502  62.8%     -  542s
     0     0 30872.1078    0  287 18970.4521 30872.1078  62.7%     -  546s
     0     0 30870.7800    0  283 18970.4521 30870.7800  62.7%     -  548s
     0     0 30870.7022    0  283 18970.4521 30870.7022  62.7%     -  549s
     0     0 29299.5109    0  283 18970.4521 29299.5109  54.4%     -  613s
     0     0 29065.3866    0  339 18970.4521 29065.3866  53.2%     -  639s
     0     0 28981.6481    0  355 18970.4521 28981.6481  52.8%     -  660s
     0     0 28945.2881    0  349 18970.4521 28945.2881  52.6%     -  673s
     0     0 28902.7815    0  358 18970.4521 28902.7815  52.4%     -  686s
     0     0 28870.4381    0  363 18970.4521 28870.4381  52.2%     -  697s
     0     0 28854.1065    0  357 18970.4521 28854.1065  52.1%     -  705s
     0     0 28800.4051    0  353 18970.4521 28800.4051  51.8%     -  716s
     0     0 28722.8744    0  356 18970.4521 28722.8744  51.4%     -  726s
     0     0 28712.0933    0  358 18970.4521 28712.0933  51.4%     -  731s
     0     0 28695.3927    0  357 18970.4521 28695.3927  51.3%     -  738s
     0     0 28687.8968    0  361 18970.4521 28687.8968  51.2%     -  743s
     0     0 28685.0182    0  360 18970.4521 28685.0182  51.2%     -  746s
     0     0 28678.7519    0  361 18970.4521 28678.7519  51.2%     -  748s
     0     0 28623.4024    0  342 18970.4521 28623.4024  50.9%     -  759s
     0     0 28588.9501    0  359 18970.4521 28588.9501  50.7%     -  768s
     0     0 28586.5538    0  360 18970.4521 28586.5538  50.7%     -  774s
     0     0 28578.1207    0  353 18970.4521 28578.1207  50.6%     -  779s
     0     0 28563.3088    0  364 18970.4521 28563.3088  50.6%     -  786s
     0     0 28555.2244    0  360 18970.4521 28555.2244  50.5%     -  790s
     0     0 28550.2961    0  361 18970.4521 28550.2961  50.5%     -  794s
     0     0 28547.6243    0  361 18970.4521 28547.6243  50.5%     -  798s
     0     0 28536.2026    0  365 18970.4521 28536.2026  50.4%     -  801s
     0     0 28528.7214    0  361 18970.4521 28528.7214  50.4%     -  804s
     0     0 28527.1985    0  357 18970.4521 28527.1985  50.4%     -  807s
     0     0 27834.9792    0  364 18970.4521 27834.9792  46.7%     -  869s
     0     0 27705.0705    0  360 18970.4521 27705.0705  46.0%     -  892s
     0     0 27662.9360    0  410 18970.4521 27662.9360  45.8%     -  906s
     0     0 27649.9092    0  344 18970.4521 27649.9092  45.8%     -  912s
     0     0 27640.6427    0  304 18970.4521 27640.6427  45.7%     -  915s
     0     0 27640.3732    0  287 18970.4521 27640.3732  45.7%     -  917s
     0     0 27577.5088    0  341 18970.4521 27577.5088  45.4%     -  934s
     0     0 27559.8942    0  349 18970.4521 27559.8942  45.3%     -  943s
     0     0 27493.0713    0  347 18970.4521 27493.0713  44.9%     -  954s
     0     0 27458.7240    0  355 18970.4521 27458.7240  44.7%     -  964s
     0     0 27455.9737    0  346 18970.4521 27455.9737  44.7%     -  967s
     0     0 27453.3435    0  285 18970.4521 27453.3435  44.7%     -  970s
     0     0 27452.0374    0  352 18970.4521 27452.0374  44.7%     -  973s
     0     0 27416.6141    0  341 18970.4521 27416.6141  44.5%     -  985s
     0     0 27397.7657    0  359 18970.4521 27397.7657  44.4%     -  996s
     0     0 27394.4136    0  351 18970.4521 27394.4136  44.4%     - 1000s
     0     0 27393.1899    0  345 18970.4521 27393.1899  44.4%     - 1001s
     0     0 27384.0512    0  405 18970.4521 27384.0512  44.4%     - 1010s
     0     0 27380.4593    0  401 18970.4521 27380.4593  44.3%     - 1015s
     0     0 27378.6197    0  404 18970.4521 27378.6197  44.3%     - 1016s
     0     0 27364.7539    0  397 18970.4521 27364.7539  44.2%     - 1023s
     0     0 27364.7468    0  394 18970.4521 27364.7468  44.2%     - 1024s
     0     0 27357.4006    0  402 18970.4521 27357.4006  44.2%     - 1030s
     0     0 27356.2835    0  283 18970.4521 27356.2835  44.2%     - 1032s
     0     0 27354.3911    0  327 18970.4521 27354.3911  44.2%     - 1037s
H    0     0                    19048.806622 27354.1069  43.6%     - 1039s
     0     0 27354.1069    0  327 19048.8066 27354.1069  43.6%     - 1039s
     0     0 27354.1069    0  327 19048.8066 27354.1069  43.6%     - 1042s
     0     0 27354.1069    0  327 19048.8066 27354.1069  43.6%     - 1043s
     0     0 27354.1069    0  327 19048.8066 27354.1069  43.6%     - 1047s
     0     0 27354.1069    0  327 19048.8066 27354.1069  43.6%     - 1058s
H    0     0                    19592.074194 27354.1069  39.6%     - 1128s
     0     2 27354.1069    0  327 19592.0742 27354.1069  39.6%     - 1130s
     1     3 26883.0704    1  323 19592.0742 27352.8034  39.6% 12192 1144s
     2     4 27133.8218    1  344 19592.0742 27133.8218  38.5% 13202 1160s
     3     6 26332.9282    2  329 19592.0742 27133.7037  38.5% 13049 1177s
     5     8 26301.0233    2  336 19592.0742 27133.1379  38.5% 14240 1200s
     7    15 25558.5748    3  344 19592.0742 26445.1149  35.0% 13979 1227s
    14    28 25624.6006    4  289 19592.0742 26445.1149  35.0% 15091 1253s
    27    41 25459.0781    5  294 19592.0742 25873.4372  32.1% 15552 1324s
    40    71 23627.3999    6  258 19592.0742 25673.6548  31.0% 20084 1524s
H   47    71                    19593.062007 25673.6548  31.0% 20271 1524s
H   55    71                    19668.110253 25673.3040  30.5% 20026 1524s
    70   150 23621.3540    7  243 19668.1103 25673.3040  30.5% 22937 1598s
   149   182 23445.7228    8  247 19668.1103 25673.3040  30.5% 16612 1628s
H  151   182                    19751.552245 25673.3040  30.0% 16434 1628s
H  153   182                    19857.716739 25673.3040  29.3% 16514 1628s
H  167   182                    19895.838720 25673.3040  29.0% 16010 1628s
   181   290 22626.0061   10  234 19895.8387 25673.3040  29.0% 16056 1667s
H  291   335                    20209.665694 25673.3040  27.0% 12810 1700s
H  299   335                    20222.290736 25673.3040  27.0% 12626 1700s
   336   394 22423.7313   12  215 20222.2907 25673.3040  27.0% 12082 1727s
   403   446 22258.2182   13  222 20222.2907 25673.3040  27.0% 11573 1749s
   469   497 22226.0286   14  229 20222.2907 25673.3040  27.0% 11357 1772s
   534   550 22597.5248   13  229 20222.2907 25673.3040  27.0% 11128 1796s
   619   607 21776.9723   15  218 20222.2907 25673.3040  27.0% 10852 1819s
   706   663 21632.7098   19  212 20222.2907 25673.3040  27.0% 10454 1843s
   801   677 21090.3298   19  237 20222.2907 25673.3040  27.0%  9871 1860s
   844   703 21499.4725   21  212 20222.2907 25673.3040  27.0%  9801 1880s
   899   760 infeasible   22      20222.2907 25673.3040  27.0%  9645 1899s
H  937   760                    20225.030308 25673.3040  26.9%  9477 1899s
   970   832 infeasible   22      20225.0303 25673.3040  26.9%  9334 1917s
  1073   925 20637.9990   25  188 20225.0303 25673.3040  26.9%  8957 1936s
  1199   981 20458.8657   26  125 20225.0303 25673.3040  26.9%  8559 1956s
H 1333  1001                    20268.351781 25673.3040  26.7%  8179 1975s
H 1364  1001                    20277.370968 25673.3040  26.6%  8102 1975s
  1377  1059 infeasible   30      20277.3710 25673.3040  26.6%  8113 1998s
  1515  1071 infeasible   30      20277.3710 25673.3040  26.6%  7733 2023s
H 1542  1071                    20306.979041 25673.3040  26.4%  7720 2023s
H 1566  1071                    20319.163804 25673.3040  26.4%  7692 2023s
  1571  1074     cutoff   12      20319.1638 25673.3040  26.4%  7706 2049s
  1662  1094 infeasible   10      20319.1638 25673.3040  26.4%  7576 2075s
  1762  1143 20604.0610   26  166 20319.1638 25673.3040  26.4%  7564 2101s
  1876  1163 20462.1188   29  136 20319.1638 25673.3040  26.4%  7564 2128s
  1981  1173 20450.0817   10  106 20319.1638 25673.3040  26.4%  7544 2154s
  2051  1195 23718.8405    8  243 20319.1638 25673.3040  26.4%  7678 2183s
  2129  1253 22909.6088    9  263 20319.1638 25673.3040  26.4%  7863 2212s
  2237  1310 22318.1587   10  139 20319.1638 25673.3040  26.4%  7851 2239s
  2357  1358 21736.8626   11  125 20319.1638 25673.3040  26.4%  7859 2270s
  2487  1367 20738.3867   17  135 20319.1638 25673.3040  26.4%  7816 2313s
  2534  1389 20552.6464   18  127 20319.1638 25673.3040  26.4%  7909 2367s
H 2573  1389                    20438.215816 25673.3040  25.6%  7963 2367s
H 2576  1389                    20479.319425 25673.3040  25.4%  7960 2367s
  2582  1414     cutoff   19      20479.3194 25673.3040  25.4%  7974 2402s
H 2584  1414                    20521.980427 25673.3040  25.1%  7967 2402s
  2661  1476 21424.8809   12  255 20521.9804 25673.3040  25.1%  8062 2437s
  2761  1556 21382.4875   13  255 20521.9804 25673.3040  25.1%  8176 2474s
  2905  1597 20776.1404   18  236 20521.9804 25673.3040  25.1%  8140 2513s
  3048  1666 22470.9876    8  259 20521.9804 25673.3040  25.1%  8162 2552s
  3167  1774 22074.8698    9  170 20521.9804 25673.3040  25.1%  8176 2594s
  3404  1793 21738.1719   15  126 20521.9804 25046.8795  22.0%  7985 2639s
  3554  1892 21290.4595   26  126 20521.9804 25046.0939  22.0%  8045 2684s
  3721  1931     cutoff   47      20521.9804 25046.0939  22.0%  8069 2732s
  3840  2014 22459.4353   10  207 20521.9804 25046.0939  22.0%  8165 2781s
  4014  2073 20737.4817   15  199 20521.9804 25046.0939  22.0%  8159 2836s
  4190  2117 20752.8679   20  207 20521.9804 25046.0939  22.0%  8229 2882s
H 4239  2103                    20541.392821 24165.8054  17.6%  8220 2882s
  4308  2218 20661.1384   21  212 20541.3928 24165.8054  17.6%  8227 2934s
  4526  2299 23084.9910   13  292 20541.3928 24152.3254  17.6%  8301 2990s
H 4743  2296                    20574.296185 24104.7443  17.2%  8350 3048s
H 4761  2295                    20574.485075 24023.7305  16.8%  8368 3048s
H 4778  2294                    20576.551761 24023.7305  16.8%  8386 3048s
H 4792  2292                    20585.004408 24023.7305  16.7%  8408 3048s
  4796  2412 21112.4060   21  177 20585.0044 24023.7305  16.7%  8411 3109s
  5059  2412 22542.7585   16  327 20585.0044 24023.7305  16.7%  8405 3481s
  5061  2413 22264.4539   23  150 20585.0044 24023.7305  16.7%  8401 3511s

Cutting planes:
  Gomory: 34
  Implied bound: 27
  Projected implied bound: 178
  MIR: 1311
  Mixing: 18
  Flow cover: 1390
  RLT: 95
  Relax-and-lift: 326

Explored 5061 nodes (43567251 simplex iterations) in 3600.05 seconds (9195.26 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20585 20576.6 20574.5 ... 20307

Time limit reached
Best objective 2.058500440793e+04, best bound 2.402373048324e+04, gap 16.7050%
  WARNING: Time limit reached. Using best solution found (gap: 16.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.24s
  Master Objective (UB) = 20585.00, θ = 140358.41
  Upper Bound (UB) = 20585.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140358.41
  [DEBUG]   ✓ Scenario 0: θ = 140358.41 ≤ Q = 140358.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140358.41 ≤ Q = 140360.49 (slack: 2.08)
  [DEBUG]   ✓ Scenario 2: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140358.41 ≤ Q = 140358.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140358.41 ≤ Q = 140358.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140358.41 ≤ Q = 140358.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140358.41 ≤ Q = 140358.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 25: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 26: θ = 140358.41 ≤ Q = 140358.41 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 27] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5a8521a6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5a8521a6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7499000.2387
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.361489e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136148.94    0  123 7499000.24 -136148.94   102%     -    0s
H    0     0                    -101248.8429 -136148.94  34.5%     -    0s
     0     0 -107114.44    0  134 -101248.84 -107114.44  5.79%     -    0s
H    0     0                    -103837.1261 -107090.72  3.13%     -    0s
     0     0 -106205.37    0  138 -103837.13 -106205.37  2.28%     -    0s
H    0     0                    -104189.5674 -106145.33  1.88%     -    0s
     0     0 -105800.55    0  135 -104189.57 -105800.55  1.55%     -    0s
     0     0 -105712.75    0  142 -104189.57 -105712.75  1.46%     -    0s
     0     0 -105709.63    0  142 -104189.57 -105709.63  1.46%     -    0s
     0     0 -105555.09    0  140 -104189.57 -105555.09  1.31%     -    0s
     0     0 -105554.95    0  140 -104189.57 -105554.95  1.31%     -    0s
     0     2 -105554.95    0  140 -104189.57 -105554.95  1.31%     -    0s
H    7    16                    -104544.9760 -105516.34  0.93%  10.1    0s
H    9    16                    -104879.4076 -105503.54  0.60%  14.8    0s
H   11    16                    -104957.2406 -105503.54  0.52%  18.5    0s
H   36    21                    -104967.0995 -105377.08  0.39%  17.3    0s
H   38    21                    -104988.8578 -105377.08  0.37%  17.2    0s
H  124    65                    -105005.7938 -105304.08  0.28%  11.7    0s
H  135    65                    -105069.0171 -105272.08  0.19%  11.5    0s
*  306   125              18    -105134.1973 -105269.62  0.13%   8.4    0s
*  585     0              18    -105148.1955 -105185.35  0.04%   6.7    0s

Cutting planes:
  Gomory: 35
  Implied bound: 2
  MIR: 234
  RLT: 2

Explored 630 nodes (4764 simplex iterations) in 0.11 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -105148 -105134 -105069 ... -104190
No other solutions better than -105148

Optimal solution found (tolerance 1.00e-04)
Best objective -1.051481955394e+05, best bound -1.051481955394e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 139343.13
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105148.20
  [DEBUG]   S×d_nominal = 244491.33
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244491.33 + -105148.20 = 139343.13
  [DEBUG]   Current θ from Master = 140358.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1015.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19569.73
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 741.0676, Absolute Gap = 741.0676, Relative Gap = 0.036000
  Not converged yet (gap = 741.07 > ε = 200)

  [DEBUG] Adding NEW scenario 27 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 27 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 27 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 27]
    [DEBUG]   - Total constraints in model: 429503
    [DEBUG]   - Total variables in model: 176980
  [DEBUG] Total scenarios in Master: 28
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 28
================================================================================
[Iteration 28] Solving Master Problem...
  Current scenarios in Master: 28
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 429503 rows, 176980 columns and 1216239 nonzeros
Model fingerprint: 0x53cd2c61
Variable types: 174721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 189476 rows and 76916 columns (presolve time = 5s)...
Presolve removed 189476 rows and 76916 columns
Presolve time: 5.10s
Presolved: 240027 rows, 100064 columns, 1476019 nonzeros
Variable types: 97805 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.26s

Barrier statistics:
 Dense cols : 1230
 AA' NZ     : 6.713e+06
 Factor NZ  : 1.914e+07 (roughly 300 MB of memory)
 Factor Ops : 7.767e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.08473262e+07  3.74291021e+08  1.20e+05 1.49e+01  7.75e+04    10s
   1  -1.64404599e+07  3.25852389e+08  8.78e+04 5.56e+01  5.62e+04    10s
   2  -6.21583048e+06  2.55660550e+08  3.29e+04 1.28e+00  2.21e+04    10s
   3  -1.65264835e+06  2.30260720e+08  4.75e+03 9.45e+00  3.62e+03    10s
   4  -9.56706834e+05  1.88794302e+08  1.29e+03 6.43e+00  1.25e+03    10s
   5  -7.94647053e+05  1.27897268e+08  5.11e+02 3.94e+00  5.99e+02    10s
   6  -7.41890557e+05  9.11361698e+07  2.82e+02 2.61e+00  3.68e+02    10s
   7  -6.80101408e+05  6.70974926e+07  1.11e+02 1.83e+00  2.13e+02    10s
   8  -4.96659756e+05  4.99926534e+07  5.63e+01 1.28e+00  1.42e+02    10s
   9  -4.00882388e+05  3.44299661e+07  1.44e+01 7.52e-01  8.57e+01    10s
  10  -3.72084192e+05  2.19239087e+07  1.02e+01 4.05e-01  5.41e+01    11s
  11  -2.44006889e+05  1.59374013e+07  5.07e+00 1.24e-01  3.83e+01    11s
  12  -1.66671377e+05  9.03986211e+06  2.36e+00 4.56e-02  2.14e+01    11s
  13  -1.34266768e+05  6.26764978e+06  1.52e+00 6.00e-02  1.48e+01    11s
  14  -1.12283810e+05  3.48068992e+06  1.02e+00 4.22e-02  8.30e+00    11s
  15  -9.81663994e+04  2.83941941e+06  7.60e-01 4.80e-03  6.78e+00    11s
  16  -6.51071053e+04  1.87446340e+06  2.52e-01 3.13e-03  4.46e+00    11s
  17  -4.72005575e+04  7.77102693e+05  1.32e-01 1.51e-02  1.89e+00    11s
  18  -2.17413862e+04  3.56900799e+05  6.25e-02 4.24e-03  8.69e-01    11s
  19  -1.22828212e+04  2.55578802e+05  4.91e-02 2.64e-03  6.15e-01    11s
  20  -3.38107615e+03  1.84511880e+05  3.98e-02 1.22e-03  4.31e-01    11s
  21   1.71225766e+03  1.47815728e+05  3.47e-02 1.17e-03  3.35e-01    11s
  22   8.65231260e+03  1.20943199e+05  2.75e-02 1.54e-03  2.58e-01    12s
  23   1.18844901e+04  1.02962102e+05  2.41e-02 1.54e-03  2.09e-01    12s
  24   1.72005069e+04  8.78826113e+04  1.89e-02 1.18e-03  1.62e-01    12s
  25   2.18907867e+04  7.43547328e+04  1.45e-02 1.66e-03  1.20e-01    12s
  26   2.46554923e+04  6.33265780e+04  1.21e-02 1.93e-03  8.88e-02    12s
  27   2.77809061e+04  5.78365802e+04  9.53e-03 1.44e-03  6.90e-02    12s
  28   3.05243864e+04  5.19143079e+04  7.50e-03 9.82e-04  4.91e-02    12s
  29   3.22188221e+04  5.02768239e+04  6.29e-03 8.31e-04  4.15e-02    12s
  30   3.43263007e+04  4.76840081e+04  4.83e-03 6.05e-04  3.07e-02    13s
  31   3.55964279e+04  4.62218071e+04  3.96e-03 4.54e-04  2.44e-02    13s
  32   3.68847399e+04  4.53771908e+04  3.12e-03 3.71e-04  1.95e-02    13s
  33   3.81639166e+04  4.39542476e+04  2.29e-03 2.25e-04  1.33e-02    13s
  34   3.88112321e+04  4.32522150e+04  1.88e-03 1.61e-04  1.02e-02    13s
  35   3.92185213e+04  4.30246778e+04  1.62e-03 1.35e-04  8.74e-03    13s
  36   3.99667343e+04  4.26671968e+04  1.15e-03 9.16e-05  6.20e-03    13s
  37   4.05470080e+04  4.24041741e+04  7.91e-04 7.19e-05  4.26e-03    14s
  38   4.09547478e+04  4.22180141e+04  5.31e-04 4.63e-05  2.90e-03    14s
  39   4.10805662e+04  4.20986474e+04  4.56e-04 3.10e-05  2.34e-03    14s
  40   4.12452306e+04  4.20630412e+04  3.62e-04 2.87e-05  1.88e-03    14s
  41   4.15365184e+04  4.19667548e+04  1.84e-04 1.71e-05  9.88e-04    14s
  42   4.16253817e+04  4.18834940e+04  1.33e-04 3.87e-05  5.92e-04    14s
  43   4.16496047e+04  4.18768168e+04  1.17e-04 2.99e-05  5.22e-04    14s
  44   4.17556843e+04  4.18684926e+04  5.61e-05 1.60e-05  2.59e-04    14s
  45   4.17815095e+04  4.18639670e+04  4.12e-05 9.25e-06  1.89e-04    15s
  46   4.18166871e+04  4.18605663e+04  2.09e-05 4.40e-06  1.01e-04    15s
  47   4.18369634e+04  4.18574865e+04  9.69e-06 1.29e-06  4.71e-05    15s
  48   4.18461078e+04  4.18563021e+04  4.72e-06 3.50e-07  2.34e-05    15s
  49   4.18470120e+04  4.18558445e+04  4.24e-06 1.76e-07  2.03e-05    15s
  50   4.18540434e+04  4.18555539e+04  6.21e-07 6.35e-08  3.47e-06    15s
  51   4.18553484e+04  4.18553518e+04  2.26e-09 2.34e-08  7.87e-09    15s
  52   4.18553512e+04  4.18553514e+04  1.42e-07 2.33e-10  2.92e-10    15s

Barrier solved model in 52 iterations and 15.23 seconds (25.57 work units)
Optimal objective 4.18553512e+04


Root crossover log...

  211753 DPushes remaining with DInf 0.0000000e+00                15s
   39059 DPushes remaining with DInf 0.0000000e+00                20s
     203 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                25s

   10958 PPushes remaining with PInf 1.1195469e-04                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.0510098e+02     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  107214    4.1855351e+04   0.000000e+00   9.051010e+02     26s
  107363    4.1855351e+04   0.000000e+00   0.000000e+00     26s
  107363    4.1855351e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 5.29s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.185535e+04, 107363 iterations, 25.34 seconds (46.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41855.3514    0  194 -208513.72 41855.3514   120%     -   32s
H    0     0                    -161520.7784 41855.3514   126%     -   35s
H    0     0                    -157492.6850 41855.3514   127%     -   37s
H    0     0                    -156840.1642 41855.3514   127%     -   37s
H    0     0                    -154097.1336 41855.3514   127%     -   38s
H    0     0                    -153112.2208 41855.3514   127%     -   38s
H    0     0                    -152874.7775 41855.3514   127%     -   38s
H    0     0                    -151917.2807 41855.3514   128%     -   38s
H    0     0                    -151881.5115 41855.3514   128%     -   38s
H    0     0                    -20335.12675 41855.3514   306%     -   39s
H    0     0                      83.4689757 41855.3514      -     -   39s
H    0     0                    2495.2003341 41855.3514  1577%     -   39s
H    0     0                    2650.0204244 41855.3514  1479%     -   39s
     0     0 37164.9717    0  227 2650.02042 37164.9717  1302%     -  140s
H    0     0                    3969.2685556 37164.9563   836%     -  142s
H    0     0                    4981.6144340 37164.9563   646%     -  142s
     0     0 36397.9522    0  289 4981.61443 36397.9522   631%     -  192s
     0     0 36379.3384    0  291 4981.61443 36379.3384   630%     -  206s
     0     0 36022.6599    0  301 4981.61443 36022.6599   623%     -  247s
     0     0 35972.9109    0  302 4981.61443 35972.9109   622%     -  255s
     0     0 35966.5751    0  304 4981.61443 35966.5751   622%     -  261s
     0     0 35915.1126    0  293 4981.61443 35915.1126   621%     -  279s
     0     0 35907.1864    0  292 4981.61443 35907.1864   621%     -  282s
     0     0 35905.1680    0  301 4981.61443 35905.1680   621%     -  284s
     0     0 35702.6045    0  296 4981.61443 35702.6045   617%     -  300s
     0     0 35668.7031    0  302 4981.61443 35668.7031   616%     -  311s
     0     0 35665.4010    0  304 4981.61443 35665.4010   616%     -  316s
     0     0 35665.2088    0  304 4981.61443 35665.2088   616%     -  318s
     0     0 32380.7706    0  252 4981.61443 32380.7706   550%     -  389s
H    0     0                    7717.6693772 32380.5544   320%     -  390s
H    0     0                    17321.014065 32380.5544  86.9%     -  390s
     0     0 31764.3962    0  328 17321.0141 31764.3962  83.4%     -  457s
     0     0 31539.5718    0  262 17321.0141 31539.5718  82.1%     -  504s
     0     0 31347.7481    0  340 17321.0141 31347.7481  81.0%     -  544s
     0     0 31316.2232    0  321 17321.0141 31316.2232  80.8%     -  559s
     0     0 31311.2406    0  321 17321.0141 31311.2406  80.8%     -  566s
     0     0 31243.8475    0  285 17321.0141 31243.8475  80.4%     -  578s
     0     0 31239.4888    0  283 17321.0141 31239.4888  80.4%     -  584s
     0     0 31237.4603    0  285 17321.0141 31237.4603  80.3%     -  589s
     0     0 31230.1676    0  286 17321.0141 31230.1676  80.3%     -  592s
     0     0 31220.8501    0  286 17321.0141 31220.8501  80.2%     -  594s
     0     0 31220.0186    0  285 17321.0141 31220.0186  80.2%     -  597s
     0     0 29093.3987    0  343 17321.0141 29093.3987  68.0%     -  721s
H    0     0                    17912.248810 29093.2740  62.4%     -  724s
H    0     0                    18198.627074 29093.2740  59.9%     -  724s
H    0     0                    19088.361230 29093.2740  52.4%     -  724s
H    0     0                    19154.708603 29093.2740  51.9%     -  724s
H    0     0                    19446.619568 29093.2740  49.6%     -  724s
     0     0 28784.8828    0  280 19446.6196 28784.8828  48.0%     -  767s
     0     0 28706.9848    0  347 19446.6196 28706.9848  47.6%     -  799s
     0     0 28662.4641    0  343 19446.6196 28662.4641  47.4%     -  821s
     0     0 28649.2734    0  351 19446.6196 28649.2734  47.3%     -  831s
     0     0 28636.6622    0  350 19446.6196 28636.6622  47.3%     -  840s
     0     0 28628.9953    0  345 19446.6196 28628.9953  47.2%     -  846s
     0     0 28625.7248    0  349 19446.6196 28625.7248  47.2%     -  850s
     0     0 28596.6583    0  355 19446.6196 28596.6583  47.1%     -  859s
     0     0 28589.9607    0  293 19446.6196 28589.9607  47.0%     -  865s
     0     0 28544.2315    0  351 19446.6196 28544.2315  46.8%     -  881s
     0     0 28517.6203    0  349 19446.6196 28517.6203  46.6%     -  892s
     0     0 28508.6185    0  352 19446.6196 28508.6185  46.6%     -  897s
     0     0 28501.9331    0  351 19446.6196 28501.9331  46.6%     -  901s
     0     0 28497.9309    0  353 19446.6196 28497.9309  46.5%     -  906s
     0     0 28491.5199    0  353 19446.6196 28491.5199  46.5%     -  910s
     0     0 28490.1436    0  352 19446.6196 28490.1436  46.5%     -  913s
     0     0 27999.6518    0  308 19446.6196 27999.6518  44.0%     -  978s
H    0     0                    19549.709099 27998.7636  43.2%     -  979s
H    0     0                    19689.863187 27998.7636  42.2%     -  979s
H    0     0                    19730.382240 27998.7636  41.9%     -  980s
H    0     0                    19850.386598 27998.7636  41.0%     -  980s
     0     0 27899.0329    0  346 19850.3866 27899.0329  40.5%     - 1007s
     0     0 27869.4968    0  385 19850.3866 27869.4968  40.4%     - 1017s
     0     0 27855.1047    0  406 19850.3866 27855.1047  40.3%     - 1027s
     0     0 27851.6143    0  388 19850.3866 27851.6143  40.3%     - 1033s
     0     0 27849.6962    0  349 19850.3866 27849.6962  40.3%     - 1035s
     0     0 27849.0607    0  345 19850.3866 27849.0607  40.3%     - 1038s
     0     0 27728.7352    0  363 19850.3866 27728.7352  39.7%     - 1058s
     0     0 27688.6154    0  346 19850.3866 27688.6154  39.5%     - 1073s
     0     0 27677.6821    0  350 19850.3866 27677.6821  39.4%     - 1078s
     0     0 27676.0293    0  359 19850.3866 27676.0293  39.4%     - 1082s
     0     0 27587.7827    0  276 19850.3866 27587.7827  39.0%     - 1102s
     0     0 27574.1476    0  334 19850.3866 27574.1476  38.9%     - 1113s
     0     0 27565.0664    0  345 19850.3866 27565.0664  38.9%     - 1119s
     0     0 27564.0592    0  348 19850.3866 27564.0592  38.9%     - 1121s
     0     0 27513.8318    0  284 19850.3866 27513.8318  38.6%     - 1139s
     0     0 27508.5289    0  280 19850.3866 27508.5289  38.6%     - 1148s
     0     0 27504.4490    0  285 19850.3866 27504.4490  38.6%     - 1155s
     0     0 27504.2641    0  283 19850.3866 27504.2641  38.6%     - 1157s
     0     0 27483.4319    0  260 19850.3866 27483.4319  38.5%     - 1172s
     0     0 27466.6752    0  256 19850.3866 27466.6752  38.4%     - 1178s
     0     0 27425.7907    0  251 19850.3866 27425.7907  38.2%     - 1190s
     0     0 27424.7654    0  320 19850.3866 27424.7654  38.2%     - 1195s
     0     0 27369.3329    0  377 19850.3866 27369.3329  37.9%     - 1218s
     0     0 27367.4318    0  247 19850.3866 27367.4318  37.9%     - 1221s
     0     0 27366.8898    0  247 19850.3866 27366.8898  37.9%     - 1222s
     0     0 27344.0416    0  332 19850.3866 27344.0416  37.8%     - 1232s
     0     0 27341.9674    0  258 19850.3866 27341.9674  37.7%     - 1235s
     0     0 27340.6654    0  260 19850.3866 27340.6654  37.7%     - 1236s
     0     0 27303.2044    0  383 19850.3866 27303.2044  37.5%     - 1250s
     0     0 27295.4726    0  258 19850.3866 27295.4726  37.5%     - 1255s
     0     0 27292.6734    0  249 19850.3866 27292.6734  37.5%     - 1257s
     0     0 27292.3638    0  251 19850.3866 27292.3638  37.5%     - 1258s
     0     0 27287.0727    0  236 19850.3866 27287.0727  37.5%     - 1263s
     0     0 27286.2641    0  240 19850.3866 27286.2641  37.5%     - 1266s
     0     0 27284.8484    0  238 19850.3866 27284.8484  37.5%     - 1272s
     0     0 27284.2570    0  238 19850.3866 27284.2570  37.4%     - 1273s
     0     0 27284.2570    0  238 19850.3866 27284.2570  37.4%     - 1275s
H    0     0                    19886.612129 27284.2570  37.2%     - 1277s
H    0     0                    19893.439341 27284.2570  37.2%     - 1277s
H    0     0                    19913.694627 27284.2570  37.0%     - 1277s
H    0     0                    19954.742326 27284.2570  36.7%     - 1277s
H    0     0                    19955.550116 27284.2570  36.7%     - 1277s
H    0     0                    19963.902735 27284.2570  36.7%     - 1277s
     0     0 27267.9339    0  241 19963.9027 27267.9339  36.6%     - 1279s
     0     0 27267.8900    0  241 19963.9027 27267.8900  36.6%     - 1279s
     0     0 27267.8900    0  241 19963.9027 27267.8900  36.6%     - 1282s
     0     0 27267.0989    0  241 19963.9027 27267.0989  36.6%     - 1295s
H    0     0                    19975.847360 27266.3770  36.5%     - 1410s
H    0     0                    20092.172238 27266.3770  35.7%     - 1410s
     0     2 27266.3770    0  241 20092.1722 27266.3770  35.7%     - 1413s
     1     3 26577.3191    1  376 20092.1722 27265.5279  35.7% 23191 1442s
     2     4 27032.1354    1  266 20092.1722 27032.1354  34.5% 19710 1459s
     3     5 26122.3370    2  383 20092.1722 27030.9853  34.5% 19766 1489s
     4     8 26865.8681    2  382 20092.1722 27030.9319  34.5% 18153 1515s
     7    15 26150.4763    3  391 20092.1722 27030.9319  34.5% 17282 1551s
    14    30 25405.0992    4  328 20092.1722 26658.3482  32.7% 15129 1581s
    29    45 25911.1144    5  365 20092.1722 26359.8294  31.2% 23637 1660s
    44    75 25438.7495    6  325 20092.1722 26359.8294  31.2% 26410 2325s
H   45    75                    20116.492079 26359.8294  31.0% 25823 2325s
H   49    75                    20138.651016 26359.8294  30.9% 25067 2325s
H   62    75                    20144.791667 26359.8294  30.9% 23965 2325s
    74   202 25142.3630    7  331 20144.7917 26200.3514  30.1% 28760 2394s
   201   236 23864.7480    9  312 20144.7917 25969.9919  28.9% 18251 2425s
H  202   236                    20272.920082 25969.9919  28.1% 18160 2425s
H  203   236                    20306.173644 25969.9919  27.9% 18144 2425s
   239   312 23862.9047   10  309 20306.1736 25969.9919  27.9% 17323 2453s
   316   368 22893.9521   13  205 20306.1736 25969.9919  27.9% 15499 2478s
   384   412 22326.8148   14  189 20306.1736 25969.9919  27.9% 14361 2502s
   450   424 22108.9877   15  182 20306.1736 25969.9919  27.9% 13465 2526s
H  466   424                    20310.213124 25969.9919  27.9% 13408 2526s
H  474   424                    20369.075253 25969.9919  27.5% 13262 2526s
   489   439 22011.9643   16  190 20369.0753 25969.9919  27.5% 13204 2552s
   534   451     cutoff   17      20369.0753 25969.9919  27.5% 12954 2579s
H  536   451                    20422.994026 25969.9919  27.2% 12961 2579s
   566   460 21703.6644   16  186 20422.9940 25969.9919  27.2% 13049 2606s
   598   468     cutoff   17      20422.9940 25969.9919  27.2% 13110 2638s
H  607   468                    20425.341509 25969.9919  27.1% 13199 2638s
   650   492     cutoff   14      20425.3415 25969.9919  27.1% 12803 2667s
H  682   492                    20426.849253 25969.9919  27.1% 12529 2667s
   711   532 20699.5877   42   99 20426.8493 25969.9919  27.1% 12329 2697s
H  720   532                    20455.131963 25969.9919  27.0% 12232 2697s
H  749   532                    20464.131888 25969.9919  26.9% 11870 2697s
   808   548 infeasible   44      20464.1319 25969.9919  26.9% 11415 2722s
   899   526 24012.6290    9  310 20464.1319 25969.9919  26.9% 10712 2752s
   970   532 22353.2439   10  337 20464.1319 25969.9919  26.9% 10357 2781s
   992   535 24478.9405    8  277 20464.1319 25969.9919  26.9% 10480 2818s
  1013   546 21428.9772   12  322 20464.1319 25969.9919  26.9% 10552 2865s
  1036   558 22475.5199    8  258 20464.1319 25969.9919  26.9% 10686 2896s
  1054   579 23605.3892   10  454 20464.1319 25843.1573  26.3% 10882 2928s
  1085   600 21381.7904   10  222 20464.1319 25843.1573  26.3% 10976 2959s
  1120   638 21483.7092   12  294 20464.1319 25843.1573  26.3% 10967 2989s
  1207   680 21010.9932   20  148 20464.1319 25843.1573  26.3% 10757 3020s
  1307   729 20820.7449   23  108 20464.1319 25843.1573  26.3% 10515 3052s
  1442   731 infeasible   28      20464.1319 25843.1573  26.3% 10125 3091s
  1494   772 21674.5180   10  205 20464.1319 25668.1259  25.4% 10236 3140s
  1560   816 21518.6282   11  196 20464.1319 25668.0887  25.4% 10229 3185s
  1650   843     cutoff   12      20464.1319 25628.0213  25.2% 10106 3225s
H 1679   843                    20490.606072 25628.0213  25.1% 10227 3225s
  1750   865     cutoff   11      20490.6061 25628.0213  25.1% 10094 3262s
  1857   876 22496.9625    7  238 20490.6061 25628.0213  25.1% 10065 3307s
H 1871   876                    20504.315419 25628.0213  25.0% 10102 3307s
  1900   931 22121.8021   15  146 20504.3154 25628.0213  25.0% 10167 3344s
  2020   950 21756.5228   16  137 20504.3154 25628.0213  25.0% 10163 3386s
H 2039   950                    20515.340414 25628.0213  24.9% 10173 3386s
  2151  1009     cutoff   19      20515.3404 25628.0213  24.9% 10097 3432s
  2298  1040 20606.4783   26  120 20515.3404 25628.0213  24.9%  9985 3481s
H 2303  1040                    20533.042974 25628.0213  24.8%  9970 3481s
  2412  1108     cutoff   16      20533.0430 25628.0213  24.8%  9917 3527s
  2548  1206 21264.9781   13  228 20533.0430 25628.0213  24.8%  9842 3580s
H 2587  1206                    20570.175261 25628.0213  24.6%  9769 3580s
H 2597  1206                    20583.579257 25628.0213  24.5%  9793 3580s
H 2644  1206                    20590.412644 25628.0213  24.5%  9773 3580s
  2749  1234 infeasible   17      20590.4126 25628.0213  24.5%  9622 3600s

Cutting planes:
  Learned: 2
  Gomory: 26
  Implied bound: 328
  MIR: 3976
  Flow cover: 4245
  RLT: 50
  Relax-and-lift: 765

Explored 2850 nodes (28037762 simplex iterations) in 3600.10 seconds (8763.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20590.4 20583.6 20570.2 ... 20426.8

Time limit reached
Best objective 2.059041264362e+04, best bound 2.562802131116e+04, gap 24.4658%
  WARNING: Time limit reached. Using best solution found (gap: 24.47%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 20590.41, θ = 140478.99
  Upper Bound (UB) = 20590.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140478.99
  [DEBUG]   ✓ Scenario 0: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140478.99 ≤ Q = 140486.75 (slack: 7.76)
  [DEBUG]   ✓ Scenario 7: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 140478.99 ≤ Q = 140478.99 (slack: -0.00)
  [DEBUG]   ✓ Scenario 27: θ = 140478.99 ≤ Q = 140478.99 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 28] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x8472807
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x08472807
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.437402e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7496753.5014
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.359130e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135913.05    0  123 7496753.50 -135913.05   102%     -    0s
H    0     0                    -100989.6770 -135913.05  34.6%     -    0s
     0     0 -106865.20    0  131 -100989.68 -106865.20  5.82%     -    0s
H    0     0                    -102539.7991 -106849.25  4.20%     -    0s
     0     0 -106125.61    0  133 -102539.80 -106125.61  3.50%     -    0s
H    0     0                    -104345.7933 -106121.09  1.70%     -    0s
H    0     0                    -104844.2536 -106121.09  1.22%     -    0s
     0     0 -105872.98    0  130 -104844.25 -105872.98  0.98%     -    0s
     0     0 -105835.30    0  126 -104844.25 -105835.30  0.95%     -    0s
     0     0 -105834.49    0  127 -104844.25 -105834.49  0.94%     -    0s
     0     0 -105708.06    0   64 -104844.25 -105708.06  0.82%     -    0s
     0     0 -105701.37    0  124 -104844.25 -105701.37  0.82%     -    0s
     0     0 -105636.59    0   57 -104844.25 -105636.59  0.76%     -    0s
H    0     0                    -105213.0589 -105636.45  0.40%     -    0s
H    0     0                    -105318.5797 -105636.45  0.30%     -    0s
     0     0 -105624.64    0   76 -105318.58 -105624.64  0.29%     -    0s
     0     0 -105583.64    0   46 -105318.58 -105583.64  0.25%     -    0s
     0     0 -105577.55    0   71 -105318.58 -105577.55  0.25%     -    0s
     0     0 -105575.50    0   45 -105318.58 -105575.50  0.24%     -    0s
     0     0 -105574.62    0   45 -105318.58 -105574.62  0.24%     -    0s
H    0     0                    -105561.9092 -105574.62  0.01%     -    0s
     0     0 -105574.62    0   87 -105561.91 -105574.62  0.01%     -    0s
     0     0 -105574.62    0   49 -105561.91 -105574.62  0.01%     -    0s
     0     0 -105574.62    0   42 -105561.91 -105574.62  0.01%     -    0s
     0     0 -105574.62    0   41 -105561.91 -105574.62  0.01%     -    0s
     0     0          -    0      -105561.91 -105571.80  0.01%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 15
  MIR: 82
  Flow cover: 9
  RLT: 11

Explored 1 nodes (1083 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -105562 -105319 -105213 ... 1.4374e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.055619092363e+05, best bound -1.055717963626e+05, gap 0.0094%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 138847.43
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105561.91
  [DEBUG]   S×d_nominal = 244409.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244409.34 + -105561.91 = 138847.43
  [DEBUG]   Current θ from Master = 140478.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1631.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18958.86
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 746.4758, Absolute Gap = 746.4758, Relative Gap = 0.036254
  Not converged yet (gap = 746.48 > ε = 200)

  [DEBUG] Adding NEW scenario 28 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 28 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 28 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 28]
    [DEBUG]   - Total constraints in model: 444793
    [DEBUG]   - Total variables in model: 183220
  [DEBUG] Total scenarios in Master: 29
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 29
================================================================================
[Iteration 29] Solving Master Problem...
  Current scenarios in Master: 29
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 444793 rows, 183220 columns and 1259479 nonzeros
Model fingerprint: 0x89d16f69
Variable types: 180961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 196243 rows and 79663 columns (presolve time = 5s)...
Presolve removed 196243 rows and 79663 columns
Presolve time: 5.43s
Presolved: 248550 rows, 103557 columns, 1527897 nonzeros
Variable types: 101298 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.28s

Barrier statistics:
 Dense cols : 1226
 AA' NZ     : 7.159e+06
 Factor NZ  : 2.048e+07 (roughly 300 MB of memory)
 Factor Ops : 8.491e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.10872830e+07  3.85235140e+08  1.22e+05 1.49e+01  7.80e+04    10s
   1  -1.66934034e+07  3.35338371e+08  8.92e+04 5.60e+01  5.68e+04    10s
   2  -6.26245508e+06  2.63299893e+08  3.31e+04 1.08e+00  2.22e+04    10s
   3  -1.48730334e+06  2.34384028e+08  3.90e+03 8.47e+00  3.05e+03    11s
   4  -9.43225562e+05  1.77038437e+08  1.21e+03 5.35e+00  1.15e+03    11s
   5  -7.83444773e+05  9.26671478e+07  4.53e+02 2.09e+00  4.60e+02    11s
   6  -6.87676993e+05  7.33325922e+07  1.81e+02 1.57e+00  2.61e+02    11s
   7  -4.84249970e+05  5.36814186e+07  1.00e+02 1.05e+00  1.69e+02    11s
   8  -4.35904971e+05  3.96218921e+07  4.67e+01 4.09e-01  1.09e+02    11s
   9  -3.36719594e+05  2.44968635e+07  9.97e+00 1.60e-01  5.85e+01    11s
  10  -1.71194779e+05  1.60539182e+07  1.23e-01 9.14e-02  3.60e+01    11s
  11  -1.44728203e+05  8.16521461e+06  9.22e-02 1.05e-02  1.84e+01    11s
  12  -1.21320464e+05  6.78275848e+06  6.20e-02 8.70e-03  1.53e+01    11s
  13  -1.07484174e+05  4.71104046e+06  4.44e-02 5.96e-03  1.07e+01    11s
  14  -9.13291928e+04  3.90934816e+06  2.91e-02 2.72e-02  8.87e+00    12s
  15  -6.92136007e+04  2.21920829e+06  1.05e-02 2.89e-03  5.07e+00    12s
  16  -5.00094978e+04  5.18018921e+05  4.76e-03 6.40e-04  1.26e+00    12s
  17  -2.40148818e+04  3.17425710e+05  2.61e-03 2.08e-03  7.56e-01    12s
  18  -1.82217122e+04  2.24815637e+05  2.26e-03 6.94e-04  5.38e-01    12s
  19  -8.65131233e+03  1.66537562e+05  1.84e-03 5.84e-04  3.88e-01    12s
  20  -2.74475426e+03  1.30307737e+05  1.62e-03 1.34e-03  2.95e-01    12s
  21   4.57059457e+03  1.07553581e+05  1.34e-03 9.66e-04  2.28e-01    12s
  22   1.05392299e+04  9.23038287e+04  1.10e-03 9.62e-04  1.81e-01    12s
  23   1.69226002e+04  7.33867519e+04  8.48e-04 1.87e-03  1.25e-01    12s
  24   1.91464890e+04  6.60346598e+04  7.59e-04 1.47e-03  1.04e-01    13s
  25   2.10439698e+04  6.36854497e+04  6.88e-04 1.36e-03  9.45e-02    13s
  26   2.38837710e+04  5.87339969e+04  5.79e-04 1.08e-03  7.72e-02    13s
  27   2.82301059e+04  5.41849082e+04  4.21e-04 8.10e-04  5.75e-02    13s
  28   3.11625004e+04  5.07125343e+04  3.23e-04 9.55e-04  4.33e-02    13s
  29   3.21964282e+04  4.86246060e+04  2.90e-04 7.76e-04  3.64e-02    13s
  30   3.31014951e+04  4.76287327e+04  2.62e-04 6.74e-04  3.22e-02    14s
  31   3.50737142e+04  4.65684113e+04  2.00e-04 5.61e-04  2.55e-02    14s
  32   3.60876906e+04  4.52992042e+04  1.69e-04 4.16e-04  2.04e-02    14s
  33   3.71692439e+04  4.50414180e+04  1.36e-04 3.85e-04  1.74e-02    14s
  34   3.78988786e+04  4.42453672e+04  1.13e-04 2.95e-04  1.41e-02    14s
  35   3.90005988e+04  4.35721899e+04  8.00e-05 2.48e-04  1.01e-02    14s
  36   3.93027669e+04  4.31526566e+04  7.11e-05 2.32e-04  8.53e-03    14s
  37   3.98501416e+04  4.26825976e+04  5.55e-05 9.99e-05  6.27e-03    15s
  38   4.02681036e+04  4.25884382e+04  4.38e-05 8.84e-05  5.14e-03    15s
  39   4.05482962e+04  4.23686690e+04  3.57e-05 6.27e-05  4.03e-03    15s
  40   4.09531339e+04  4.22069579e+04  2.38e-05 4.31e-05  2.78e-03    15s
  41   4.10805857e+04  4.21519677e+04  2.02e-05 3.67e-05  2.37e-03    15s
  42   4.13197905e+04  4.20737503e+04  1.36e-05 2.75e-05  1.67e-03    15s
  43   4.14153689e+04  4.19621328e+04  1.10e-05 1.48e-05  1.21e-03    15s
  44   4.15044764e+04  4.19167573e+04  8.64e-06 9.67e-06  9.13e-04    16s
  45   4.15564304e+04  4.18626105e+04  7.24e-06 3.29e-06  6.78e-04    16s
  46   4.16751007e+04  4.18511136e+04  3.99e-06 4.00e-06  3.90e-04    16s
  47   4.17832309e+04  4.18390637e+04  1.14e-06 2.11e-06  1.24e-04    16s
  48   4.17918907e+04  4.18324720e+04  9.25e-07 5.42e-07  8.98e-05    16s
  49   4.18174816e+04  4.18323011e+04  2.87e-07 5.26e-07  3.28e-05    16s
  50   4.18297212e+04  4.18307942e+04  2.60e-08 1.29e-07  2.38e-06    17s
  51   4.18302674e+04  4.18302791e+04  4.15e-09 2.64e-08  2.59e-08    17s
  52   4.18302751e+04  4.18302771e+04  1.87e-07 5.12e-10  4.30e-09    17s
  53   4.18302758e+04  4.18302771e+04  1.57e-07 2.48e-10  2.92e-09    17s
  54   4.18302770e+04  4.18302771e+04  1.25e-08 6.05e-11  2.31e-10    17s

Barrier solved model in 54 iterations and 16.98 seconds (28.72 work units)
Optimal objective 4.18302770e+04


Root crossover log...

  219297 DPushes remaining with DInf 0.0000000e+00                17s
   62285 DPushes remaining with DInf 0.0000000e+00                20s
    6374 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

   10735 PPushes remaining with PInf 1.1280449e-04                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7008380e+02     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  108056    4.1830277e+04   0.000000e+00   2.700838e+02     28s
  108060    4.1830277e+04   0.000000e+00   0.000000e+00     28s
  108060    4.1830277e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 6.90s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.183028e+04, 108060 iterations, 28.54 seconds (52.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41830.2771    0  193 -208513.72 41830.2771   120%     -   36s
H    0     0                    -196593.0432 41830.2771   121%     -   37s
H    0     0                    -196385.5920 41830.2771   121%     -   38s
H    0     0                    -158039.0693 41830.2771   126%     -   38s
H    0     0                    -153908.8126 41830.2771   127%     -   38s
H    0     0                    -44754.57740 41830.2771   193%     -   39s
H    0     0                    10952.595279 41830.2771   282%     -   40s
H    0     0                    12096.317780 41830.2771   246%     -   40s
H    0     0                    14469.260711 41830.2771   189%     -   40s
H    0     0                    15298.541496 41830.2771   173%     -   41s
H    0     0                    15738.492417 41830.2771   166%     -   41s
H    0     0                    15840.321390 41830.2771   164%     -   41s
H    0     0                    15919.234678 41830.2771   163%     -   41s
H    0     0                    15948.534915 41830.2771   162%     -   41s
H    0     0                    15966.511694 41830.2771   162%     -   41s
H    0     0                    15975.496866 41830.2771   162%     -   41s
H    0     0                    15988.614052 41830.2771   162%     -   41s
H    0     0                    15990.880957 41830.2771   162%     -   41s
H    0     0                    15991.291982 41830.2771   162%     -   41s
H    0     0                    15994.131897 41830.2771   162%     -   41s
     0     0 36872.9787    0  285 15994.1319 36872.9787   131%     -  138s
     0     0 36726.9589    0  282 15994.1319 36726.9589   130%     -  172s
     0     0 36678.3145    0  287 15994.1319 36678.3145   129%     -  188s
     0     0 36254.2303    0  230 15994.1319 36254.2303   127%     -  210s
     0     0 35932.4643    0  303 15994.1319 35932.4643   125%     -  236s
     0     0 35917.5202    0  300 15994.1319 35917.5202   125%     -  247s
     0     0 35896.1029    0  302 15994.1319 35896.1029   124%     -  250s
     0     0 35896.0573    0  302 15994.1319 35896.0573   124%     -  252s
     0     0 31584.0955    0  239 15994.1319 31584.0955  97.5%     -  332s
H    0     0                    19146.377978 31583.0159  65.0%     -  333s
H    0     0                    19163.706195 31583.0159  64.8%     -  334s
H    0     0                    19163.793426 31583.0159  64.8%     -  334s
     0     0 31266.2238    0  230 19163.7934 31266.2238  63.2%     -  387s
     0     0 31082.2255    0  328 19163.7934 31082.2255  62.2%     -  428s
     0     0 30961.1500    0  297 19163.7934 30961.1500  61.6%     -  462s
     0     0 30926.8411    0  236 19163.7934 30926.8411  61.4%     -  479s
     0     0 30894.9440    0  289 19163.7934 30894.9440  61.2%     -  493s
     0     0 30888.0504    0  297 19163.7934 30888.0504  61.2%     -  500s
     0     0 30884.2304    0  293 19163.7934 30884.2304  61.2%     -  510s
     0     0 30864.4989    0  324 19163.7934 30864.4989  61.1%     -  519s
     0     0 30849.2430    0  280 19163.7934 30849.2430  61.0%     -  528s
     0     0 30798.6034    0  298 19163.7934 30798.6034  60.7%     -  544s
     0     0 30788.3000    0  299 19163.7934 30788.3000  60.7%     -  553s
     0     0 30749.5877    0  320 19163.7934 30749.5877  60.5%     -  572s
     0     0 30747.7814    0  325 19163.7934 30747.7814  60.4%     -  576s
     0     0 30747.3799    0  332 19163.7934 30747.3799  60.4%     -  579s
     0     0 29435.9882    0  274 19163.7934 29435.9882  53.6%     -  666s
H    0     0                    19539.633094 29435.9378  50.6%     -  668s
     0     0 29036.5192    0  331 19539.6331 29036.5192  48.6%     -  696s
     0     0 28897.1665    0  386 19539.6331 28897.1665  47.9%     -  727s
     0     0 28825.7998    0  374 19539.6331 28825.7998  47.5%     -  744s
     0     0 28766.5797    0  383 19539.6331 28766.5797  47.2%     -  764s
     0     0 28740.8368    0  399 19539.6331 28740.8368  47.1%     -  774s
     0     0 28730.9650    0  383 19539.6331 28730.9650  47.0%     -  779s
     0     0 28706.2922    0  389 19539.6331 28706.2922  46.9%     -  784s
     0     0 28702.0663    0  381 19539.6331 28702.0663  46.9%     -  788s
     0     0 28697.9282    0  388 19539.6331 28697.9282  46.9%     -  790s
     0     0 28625.4418    0  341 19539.6331 28625.4418  46.5%     -  802s
     0     0 28604.3021    0  387 19539.6331 28604.3021  46.4%     -  812s
     0     0 28554.2156    0  352 19539.6331 28554.2156  46.1%     -  824s
     0     0 28470.6198    0  336 19539.6331 28470.6198  45.7%     -  838s
     0     0 28460.9906    0  337 19539.6331 28460.9906  45.7%     -  849s
     0     0 28457.5249    0  382 19539.6331 28457.5249  45.6%     -  860s
     0     0 28451.8148    0  337 19539.6331 28451.8148  45.6%     -  865s
     0     0 28389.3371    0  336 19539.6331 28389.3371  45.3%     -  878s
     0     0 28381.3276    0  379 19539.6331 28381.3276  45.3%     -  887s
     0     0 28380.5362    0  381 19539.6331 28380.5362  45.2%     -  890s
     0     0 27893.7158    0  338 19539.6331 27893.7158  42.8%     -  936s
H    0     0                    19669.566525 27887.8135  41.8%     -  937s
H    0     0                    19675.854112 27887.8135  41.7%     -  937s
     0     0 27837.4986    0  351 19675.8541 27837.4986  41.5%     -  946s
     0     0 27822.7202    0  293 19675.8541 27822.7202  41.4%     -  956s
     0     0 27810.5493    0  298 19675.8541 27810.5493  41.3%     -  965s
     0     0 27808.2857    0  297 19675.8541 27808.2857  41.3%     -  969s
     0     0 27803.6706    0  347 19675.8541 27803.6706  41.3%     -  975s
     0     0 27802.4128    0  361 19675.8541 27802.4128  41.3%     -  978s
     0     0 27506.8910    0  354 19675.8541 27506.8910  39.8%     - 1014s
     0     0 27451.9446    0  359 19675.8541 27451.9446  39.5%     - 1033s
     0     0 27420.7619    0  356 19675.8541 27420.7619  39.4%     - 1046s
     0     0 27406.0836    0  291 19675.8541 27406.0836  39.3%     - 1055s
     0     0 27337.0068    0  364 19675.8541 27337.0068  38.9%     - 1065s
     0     0 27330.6104    0  362 19675.8541 27330.6104  38.9%     - 1071s
     0     0 27312.5711    0  355 19675.8541 27312.5711  38.8%     - 1084s
     0     0 27302.9614    0  369 19675.8541 27302.9614  38.8%     - 1095s
     0     0 27300.5817    0  368 19675.8541 27300.5817  38.8%     - 1100s
     0     0 27298.4619    0  365 19675.8541 27298.4619  38.7%     - 1103s
     0     0 27297.1284    0  371 19675.8541 27297.1284  38.7%     - 1105s
     0     0 27211.0805    0  348 19675.8541 27211.0805  38.3%     - 1128s
H    0     0                    19687.738885 27210.6312  38.2%     - 1130s
H    0     0                    19723.274293 27210.6312  38.0%     - 1130s
H    0     0                    19752.042860 27210.6312  37.8%     - 1130s
H    0     0                    19759.865882 27210.6312  37.7%     - 1130s
H    0     0                    19811.667248 27210.6312  37.3%     - 1130s
     0     0 27204.3133    0  347 19811.6672 27204.3133  37.3%     - 1136s
     0     0 27199.3675    0  342 19811.6672 27199.3675  37.3%     - 1144s
     0     0 27197.4792    0  344 19811.6672 27197.4792  37.3%     - 1147s
     0     0 27161.7122    0  341 19811.6672 27161.7122  37.1%     - 1163s
     0     0 27160.5373    0  354 19811.6672 27160.5373  37.1%     - 1171s
     0     0 27158.1508    0  346 19811.6672 27158.1508  37.1%     - 1180s
H    0     0                    19890.586638 27158.1268  36.5%     - 1181s
H    0     0                    20028.027660 27158.1268  35.6%     - 1181s
H    0     0                    20104.608079 27158.1268  35.1%     - 1181s
     0     0 27157.3030    0  347 20104.6081 27157.3030  35.1%     - 1191s
     0     0 27155.6403    0  347 20104.6081 27155.6403  35.1%     - 1199s
     0     0 27155.5014    0  343 20104.6081 27155.5014  35.1%     - 1201s
     0     0 27105.0565    0  353 20104.6081 27105.0565  34.8%     - 1211s
H    0     0                    20108.482918 27104.0142  34.8%     - 1212s
H    0     0                    20111.145205 27104.0142  34.8%     - 1212s
H    0     0                    20158.042453 27104.0142  34.5%     - 1212s
     0     0 27104.0142    0  350 20158.0425 27104.0142  34.5%     - 1214s
     0     0 27104.0142    0  292 20158.0425 27104.0142  34.5%     - 1222s
     0     0 27104.0079    0  295 20158.0425 27104.0079  34.5%     - 1225s
     0     0 27103.9688    0  295 20158.0425 27103.9688  34.5%     - 1229s
     0     0 27103.8780    0  349 20158.0425 27103.8780  34.5%     - 1233s
     0     0 27102.5045    0  347 20158.0425 27102.5045  34.5%     - 1241s
     0     0 27102.2690    0  348 20158.0425 27102.2690  34.4%     - 1246s
     0     0 27075.5062    0  261 20158.0425 27075.5062  34.3%     - 1257s
     0     0 27071.6525    0  279 20158.0425 27071.6525  34.3%     - 1261s
     0     0 27071.6525    0  270 20158.0425 27071.6525  34.3%     - 1266s
     0     0 27071.6525    0  270 20158.0425 27071.6525  34.3%     - 1268s
     0     0 27071.6525    0  314 20158.0425 27071.6525  34.3%     - 1271s
     0     0 27071.6525    0  314 20158.0425 27071.6525  34.3%     - 1272s
     0     0 27071.6525    0  314 20158.0425 27071.6525  34.3%     - 1275s
     0     0 27071.6525    0  314 20158.0425 27071.6525  34.3%     - 1287s
H    0     0                    20158.359215 27071.6525  34.3%     - 1409s
     0     2 27071.6525    0  314 20158.3592 27071.6525  34.3%     - 1411s
     1     3 26936.0019    1  336 20158.3592 27071.6525  34.3% 13742 1428s
     2     4 27022.3945    1  331 20158.3592 27022.3945  34.1% 12802 1440s
     3     5 25600.3953    2  286 20158.3592 27021.1215  34.0% 21599 1488s
     4     8 25112.2031    3  271 20158.3592 27021.1215  34.0% 19946 1508s
     7    14 24826.0044    4  292 20158.3592 27021.1215  34.0% 17084 1542s
    13    26 24517.4171    5  284 20158.3592 26804.2008  33.0% 17375 1575s
    25    37 23833.2867    4  252 20158.3592 26337.2938  30.7% 22948 1655s
    36    62 23750.1675    6  311 20158.3592 26048.7882  29.2% 25060 1913s
H   38    62                    20244.279520 26048.7882  28.7% 24282 1913s
H   48    62                    20304.614689 26048.7882  28.3% 22711 1913s
H   50    62                    20345.429131 26048.7882  28.0% 22392 1913s
    61    94 24546.9736    6  378 20345.4291 26048.7882  28.0% 28903 1950s
H   93   197                    20430.717238 26048.7882  27.5% 28495 2008s
H  120   197                    20471.358319 26048.7882  27.2% 23738 2008s
   198   267 23892.3482    8  357 20471.3583 26048.7882  27.2% 18759 2042s
   274   293 22639.1984    9  362 20471.3583 26048.7882  27.2% 16333 2068s
   302   319 22437.7852   10  361 20471.3583 26048.7882  27.2% 15760 2096s
   342   338     cutoff   11      20471.3583 26048.7882  27.2% 16269 2121s
   381   347 22154.5890   10  293 20471.3583 26048.7882  27.2% 15802 2145s
   412   353 infeasible   11      20471.3583 26048.7882  27.2% 15621 2172s
H  424   353                    20539.681135 26048.7882  26.8% 15573 2172s
   454   349 22192.6571   14  172 20539.6811 26048.7882  26.8% 15540 2203s
H  478   349                    20550.038385 26048.7882  26.8% 15163 2203s
   519   374 22033.4103   15  169 20550.0384 26048.7882  26.8% 14840 2232s
   598   416 21694.5404   16  178 20550.0384 26048.7882  26.8% 14156 2259s
H  614   416                    20554.129127 26048.7882  26.7% 13977 2259s
H  646   416                    20564.795902 26048.7882  26.7% 13598 2259s
   664   463 21382.8601   19  167 20564.7959 26048.7882  26.7% 13572 2290s
   740   494 21347.0253   21  172 20564.7959 26048.7882  26.7% 12754 2313s
   841   527 21289.0480   22  174 20564.7959 26048.7882  26.7% 11931 2335s
   941   558 infeasible   26      20564.7959 26048.7882  26.7% 11364 2358s
  1030   583 20859.8351   28  164 20564.7959 26048.7882  26.7% 10849 2380s
  1123   604 21604.5332    9  225 20564.7959 26048.7882  26.7% 10484 2404s
  1233   625 20811.0047   10  186 20564.7959 26048.7882  26.7%  9912 2431s
  1308   634 20626.6381   12  174 20564.7959 26048.7882  26.7%  9650 2456s
  1349   654     cutoff   11      20564.7959 26048.7882  26.7%  9746 2482s
H 1364   654                    20565.000684 26048.7882  26.7%  9704 2482s
  1401   760 21818.6586   12  196 20565.0007 26048.7882  26.7%  9746 2511s
  1557   841 21551.8584   15  199 20565.0007 26048.7882  26.7%  9264 2540s
  1718   965 21244.6900   18  149 20565.0007 26048.7882  26.7%  8809 2566s
  1905  1070 21162.9891   22  281 20565.0007 26048.7882  26.7%  8314 2595s
  2099  1118 20839.7814   27  201 20565.0007 26048.7882  26.7%  7894 2624s
  2249  1202 20798.5021   30  192 20565.0007 26048.7882  26.7%  7700 2655s
  2456  1217 21064.0737   10  241 20565.0007 26048.7882  26.7%  7410 2684s
  2507  1238 20842.4043   11  225 20565.0007 26048.7882  26.7%  7470 2715s
  2550  1269     cutoff   12      20565.0007 26048.7882  26.7%  7528 2739s
  2637  1331 20722.0187   13  212 20565.0007 26048.7882  26.7%  7500 2770s
  2745  1365     cutoff   14      20565.0007 26048.7882  26.7%  7413 2805s
  2879  1391 20623.6294   30   30 20565.0007 26048.7882  26.7%  7416 2841s
  2917  1402     cutoff   31      20565.0007 25653.3690  24.7%  7471 2872s
  2972  1414 22497.3864   10  206 20565.0007 25653.3690  24.7%  7526 2906s
  3016  1447 23152.1321    5  242 20565.0007 25653.3690  24.7%  7576 2939s
  3063  1485 22811.9069    6  249 20565.0007 25653.3690  24.7%  7631 2973s
H 3125  1485                    20567.224578 25653.3690  24.7%  7600 2973s
  3141  1588 22441.8521    7  257 20567.2246 25653.3690  24.7%  7597 3016s
  3367  1640 22145.8834    9  233 20567.2246 25653.3690  24.7%  7469 3061s
H 3373  1640                    20588.798106 25653.3690  24.6%  7464 3061s
H 3377  1640                    20594.146708 25653.3690  24.6%  7468 3061s
H 3524  1640                    20602.335599 25653.3690  24.5%  7426 3061s
  3525  1767 21754.1448   15  165 20602.3356 25653.3690  24.5%  7434 3103s
  3740  1813 21201.6470   21  140 20602.3356 24767.0412  20.2%  7351 3150s
  3919  1885 22163.3538    8  336 20602.3356 24767.0412  20.2%  7364 3197s
  4063  1932 21509.4062   10  299 20602.3356 24767.0412  20.2%  7500 3242s
  4158  2009 20871.1538   11  239 20602.3356 24255.0922  17.7%  7589 3294s
  4341  2052 20908.3658   10  316 20602.3356 24255.0922  17.7%  7651 3349s
  4505  2145     cutoff   11      20602.3356 24015.3053  16.6%  7734 3411s
  4677  2214 21588.6866    7  217 20602.3356 24015.3053  16.6%  7812 3470s

Cutting planes:
  Gomory: 18
  Implied bound: 483
  MIR: 4608
  Flow cover: 4492
  RLT: 62
  Relax-and-lift: 787

Explored 4862 nodes (39102702 simplex iterations) in 3600.03 seconds (9558.64 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20602.3 20594.1 20588.8 ... 20471.4

Time limit reached
Best objective 2.060233559914e+04, best bound 2.401530529377e+04, gap 16.5659%
  WARNING: Time limit reached. Using best solution found (gap: 16.57%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 20602.34, θ = 140478.51
  Upper Bound (UB) = 20602.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140478.51
  [DEBUG]   ✓ Scenario 0: θ = 140478.51 ≤ Q = 140478.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 140478.51 ≤ Q = 140478.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 140478.51 ≤ Q = 140478.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 140478.51 ≤ Q = 140478.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 140478.51 ≤ Q = 140478.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 140478.51 ≤ Q = 140478.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 25: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 27: θ = 140478.51 ≤ Q = 140478.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 28: θ = 140478.51 ≤ Q = 140478.51 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 29] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6194811a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6194811a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-16, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.435671e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7500572.1476
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.360070e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136007.04    0  123 7500572.15 -136007.04   102%     -    0s
H    0     0                    -101067.5086 -136007.04  34.6%     -    0s
     0     0 -107569.72    0   85 -101067.51 -107569.72  6.43%     -    0s
H    0     0                    -105154.0138 -107461.36  2.19%     -    0s
H    0     0                    -105621.6243 -107461.36  1.74%     -    0s
     0     0 -106777.86    0   88 -105621.62 -106777.86  1.09%     -    0s
     0     0 -106755.82    0   88 -105621.62 -106755.82  1.07%     -    0s
     0     0 -106315.44    0   85 -105621.62 -106315.44  0.66%     -    0s
     0     0 -106290.72    0   86 -105621.62 -106290.72  0.63%     -    0s
     0     0 -106289.05    0   77 -105621.62 -106289.05  0.63%     -    0s
     0     0 -105939.52    0   64 -105621.62 -105939.52  0.30%     -    0s
     0     0 -105936.89    0   62 -105621.62 -105936.89  0.30%     -    0s
     0     0 -105875.16    0   58 -105621.62 -105875.16  0.24%     -    0s
     0     0 -105875.10    0   57 -105621.62 -105875.10  0.24%     -    0s
     0     0 -105867.78    0   54 -105621.62 -105867.78  0.23%     -    0s
     0     0 -105831.85    0   50 -105621.62 -105831.85  0.20%     -    0s
     0     0 -105823.32    0   56 -105621.62 -105823.32  0.19%     -    0s
     0     0 -105819.52    0   47 -105621.62 -105819.52  0.19%     -    0s
     0     0 -105818.94    0   47 -105621.62 -105818.94  0.19%     -    0s
H    0     0                    -105728.7248 -105818.47  0.08%     -    0s
     0     0 -105818.47    0   64 -105728.72 -105818.47  0.08%     -    0s
     0     0 -105818.47    0   49 -105728.72 -105818.47  0.08%     -    0s
     0     0 -105818.47    0   42 -105728.72 -105818.47  0.08%     -    0s
     0     0 -105818.47    0   46 -105728.72 -105818.47  0.08%     -    0s
     0     0 -105817.39    0   45 -105728.72 -105817.39  0.08%     -    0s
     0     0 -105817.18    0   45 -105728.72 -105817.18  0.08%     -    0s
     0     0 -105816.16    0   45 -105728.72 -105816.16  0.08%     -    0s
     0     0 -105812.37    0   44 -105728.72 -105812.37  0.08%     -    0s
     0     0 -105810.79    0   44 -105728.72 -105810.79  0.08%     -    0s
     0     2 -105810.79    0   44 -105728.72 -105810.79  0.08%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 5
  MIR: 74
  Flow cover: 15
  Relax-and-lift: 2

Explored 18 nodes (1103 simplex iterations) in 0.13 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -105729 -105622 -101068 ... 1.43567e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.057287247607e+05, best bound -1.057315764450e+05, gap 0.0027%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 138868.20
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105728.72
  [DEBUG]   S×d_nominal = 244596.92
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244596.92 + -105728.72 = 138868.20
  [DEBUG]   Current θ from Master = 140478.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1610.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18992.02
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = 758.3988, Absolute Gap = 758.3988, Relative Gap = 0.036811
  Not converged yet (gap = 758.40 > ε = 200)

  [DEBUG] Adding NEW scenario 29 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 29 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 29 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 29]
    [DEBUG]   - Total constraints in model: 460083
    [DEBUG]   - Total variables in model: 189460
  [DEBUG] Total scenarios in Master: 30
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 30
================================================================================
[Iteration 30] Solving Master Problem...
  Current scenarios in Master: 30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 460083 rows, 189460 columns and 1302719 nonzeros
Model fingerprint: 0x7f1102be
Variable types: 187201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 203010 rows and 82410 columns (presolve time = 5s)...
Presolve removed 203010 rows and 82410 columns
Presolve time: 5.58s
Presolved: 257073 rows, 107050 columns, 1580211 nonzeros
Variable types: 104791 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -357490.9560
Found heuristic solution: objective -208513.7182

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.20s

Barrier statistics:
 Dense cols : 1300
 AA' NZ     : 6.470e+06
 Factor NZ  : 1.814e+07 (roughly 300 MB of memory)
 Factor Ops : 7.918e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.13336224e+07  3.95861520e+08  1.23e+05 1.45e+01  7.86e+04    10s
   1  -1.69426604e+07  3.44602693e+08  9.05e+04 5.63e+01  5.74e+04    10s
   2  -6.31634111e+06  2.70689365e+08  3.33e+04 1.48e+00  2.22e+04    11s
   3  -2.49651823e+06  2.39937434e+08  9.17e+03 7.82e+00  6.41e+03    11s
   4  -1.07118044e+06  1.91715963e+08  1.99e+03 4.09e+00  1.65e+03    11s
   5  -7.99696445e+05  1.12699366e+08  6.43e+02 1.67e+00  6.13e+02    11s
   6  -7.05332726e+05  9.46595043e+07  3.41e+02 1.34e+00  3.94e+02    11s
   7  -4.92670578e+05  6.16383368e+07  2.01e+02 7.22e-01  2.36e+02    11s
   8  -4.70130301e+05  5.05262810e+07  6.48e+01 5.61e-01  1.41e+02    11s
   9  -3.57760377e+05  3.33915363e+07  2.35e+01 2.92e-01  8.16e+01    11s
  10  -2.36651276e+05  2.08240314e+07  7.63e+00 1.25e-01  4.73e+01    11s
  11  -1.60568547e+05  1.24166268e+07  3.79e+00 3.68e-02  2.77e+01    11s
  12  -1.41232533e+05  8.79601930e+06  2.73e+00 9.67e-03  1.95e+01    11s
  13  -1.24401358e+05  5.16528072e+06  1.96e+00 1.59e-02  1.15e+01    12s
  14  -1.07718405e+05  3.88066217e+06  1.38e+00 4.24e-03  8.64e+00    12s
  15  -9.43350631e+04  2.88647033e+06  9.90e-01 3.13e-03  6.44e+00    12s
  16  -6.72573680e+04  2.00442832e+06  3.88e-01 2.15e-03  4.45e+00    12s
  17  -3.97919979e+04  4.35505952e+05  1.27e-01 4.16e-04  1.02e+00    12s
  18  -1.83848764e+04  2.52040385e+05  7.06e-02 7.06e-04  5.80e-01    12s
  19  -1.07192410e+04  1.91966033e+05  6.09e-02 8.22e-04  4.35e-01    12s
  20  -3.82748754e+03  1.56176275e+05  5.21e-02 3.66e-04  3.43e-01    12s
  21   6.08073398e+02  1.27746651e+05  4.64e-02 1.08e-03  2.73e-01    12s
  22   6.50558905e+03  1.10398089e+05  3.92e-02 2.07e-03  2.23e-01    12s
  23   1.22885945e+04  8.87396040e+04  3.18e-02 2.22e-03  1.64e-01    13s
  24   1.66656613e+04  7.48853800e+04  2.65e-02 2.18e-03  1.25e-01    13s
  25   2.10092259e+04  6.72182838e+04  2.11e-02 1.71e-03  9.91e-02    13s
  26   2.50949497e+04  5.99241092e+04  1.62e-02 1.27e-03  7.47e-02    13s
  27   2.84196773e+04  5.46427256e+04  1.25e-02 9.39e-04  5.62e-02    13s
  28   3.07071699e+04  5.01528758e+04  1.01e-02 6.30e-04  4.17e-02    13s
  29   3.20340342e+04  4.92937595e+04  8.83e-03 5.66e-04  3.70e-02    13s
  30   3.30213614e+04  4.75032991e+04  7.86e-03 4.41e-04  3.11e-02    13s
  31   3.54202620e+04  4.63616983e+04  5.60e-03 3.56e-04  2.35e-02    14s
  32   3.64753463e+04  4.54849395e+04  4.63e-03 2.86e-04  1.93e-02    14s
  33   3.72374567e+04  4.46857527e+04  3.94e-03 2.22e-04  1.60e-02    14s
  34   3.89366538e+04  4.39677472e+04  2.43e-03 1.79e-04  1.08e-02    14s
  35   3.94793984e+04  4.33074533e+04  1.95e-03 1.23e-04  8.21e-03    14s
  36   3.97431399e+04  4.32341534e+04  1.73e-03 1.17e-04  7.49e-03    14s
  37   4.01162038e+04  4.29087598e+04  1.41e-03 8.89e-05  5.99e-03    15s
  38   4.03830408e+04  4.27969993e+04  1.19e-03 7.83e-05  5.18e-03    15s
  39   4.07422822e+04  4.24415615e+04  8.87e-04 4.12e-05  3.64e-03    15s
  40   4.10395332e+04  4.22924802e+04  6.37e-04 3.04e-05  2.69e-03    15s
  41   4.12640516e+04  4.20263582e+04  4.50e-04 1.31e-05  1.63e-03    15s
  42   4.14452887e+04  4.19243866e+04  3.02e-04 3.46e-05  1.03e-03    15s
  43   4.15443781e+04  4.19028621e+04  2.21e-04 2.64e-05  7.69e-04    16s
  44   4.15710295e+04  4.18830421e+04  2.00e-04 1.89e-05  6.69e-04    16s
  45   4.15966363e+04  4.18760794e+04  1.79e-04 1.62e-05  5.99e-04    16s
  46   4.16792947e+04  4.18587818e+04  1.11e-04 9.68e-06  3.85e-04    16s
  47   4.17846144e+04  4.18378788e+04  3.00e-05 9.10e-06  1.14e-04    16s
  48   4.18042382e+04  4.18333057e+04  1.65e-05 3.27e-06  6.23e-05    16s
  49   4.18097751e+04  4.18330906e+04  1.30e-05 3.00e-06  5.00e-05    16s
  50   4.18250012e+04  4.18309390e+04  3.11e-06 4.38e-07  1.27e-05    16s
  51   4.18293345e+04  4.18304940e+04  5.03e-07 1.22e-07  2.49e-06    17s
  52   4.18302274e+04  4.18302963e+04  1.69e-08 6.86e-09  1.48e-07    17s
  53   4.18302769e+04  4.18302771e+04  1.19e-09 1.52e-09  3.26e-10    17s

Barrier solved model in 53 iterations and 16.77 seconds (26.93 work units)
Optimal objective 4.18302769e+04


Root crossover log...

  226785 DPushes remaining with DInf 0.0000000e+00                17s
   63949 DPushes remaining with DInf 0.0000000e+00                20s
    4719 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

   14513 PPushes remaining with PInf 9.9770656e-05                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.1013822e+04     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  118307    4.1830277e+04   0.000000e+00   7.101382e+04     28s
  118385    4.1830277e+04   0.000000e+00   0.000000e+00     28s
  118385    4.1830277e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 4.65s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.183028e+04, 118385 iterations, 26.16 seconds (48.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 41830.2771    0  193 -208513.72 41830.2771   120%     -   34s
H    0     0                    -185568.6627 41830.2771   123%     -   35s
H    0     0                    -183707.5895 41830.2771   123%     -   39s
H    0     0                    -183534.2267 41830.2771   123%     -   40s
H    0     0                    -183156.1049 41830.2771   123%     -   40s
H    0     0                    -43585.05708 41830.2771   196%     -   41s
H    0     0                    1003.7527283 41830.2771  4067%     -   42s
H    0     0                    2545.7164711 41830.2771  1543%     -   42s
H    0     0                    3168.9578493 41830.2771  1220%     -   42s
H    0     0                    3431.2502700 41830.2771  1119%     -   42s
     0     0 36888.7369    0  243 3431.25027 36888.7369   975%     -  147s
     0     0 36888.7369    0  243 3431.25027 36888.7369   975%     -  147s
H    0     0                    5197.2507212 36887.8731   610%     -  148s
H    0     0                    5562.2663130 36887.8731   563%     -  148s
     0     0 36318.5111    0  236 5562.26631 36318.5111   553%     -  184s
     0     0 36176.8942    0  299 5562.26631 36176.8942   550%     -  214s
     0     0 35976.9006    0  290 5562.26631 35976.9006   547%     -  246s
     0     0 35972.2881    0  290 5562.26631 35972.2881   547%     -  251s
     0     0 35966.4158    0  290 5562.26631 35966.4158   547%     -  258s
     0     0 35955.2140    0  296 5562.26631 35955.2140   546%     -  263s
     0     0 35937.2720    0  303 5562.26631 35937.2720   546%     -  270s
     0     0 35922.4399    0  295 5562.26631 35922.4399   546%     -  276s
     0     0 35871.2100    0  301 5562.26631 35871.2100   545%     -  294s
     0     0 35860.6232    0  304 5562.26631 35860.6232   545%     -  300s
     0     0 35860.5783    0  304 5562.26631 35860.5783   545%     -  301s
     0     0 31875.9564    0  245 5562.26631 31875.9564   473%     -  387s
H    0     0                    17614.559674 31875.9033  81.0%     -  388s
H    0     0                    17733.910279 31875.9033  79.7%     -  388s
H    0     0                    17863.516188 31875.9033  78.4%     -  388s
H    0     0                    17867.021127 31875.9033  78.4%     -  388s
     0     0 31437.5852    0  253 17867.0211 31437.5852  76.0%     -  451s
     0     0 31052.6185    0  317 17867.0211 31052.6185  73.8%     -  526s
     0     0 30868.5204    0  260 17867.0211 30868.5204  72.8%     -  561s
     0     0 30823.3711    0  255 17867.0211 30823.3711  72.5%     -  575s
     0     0 30688.6694    0  341 17867.0211 30688.6694  71.8%     -  609s
     0     0 30628.1264    0  332 17867.0211 30628.1264  71.4%     -  632s
     0     0 30577.7609    0  395 17867.0211 30577.7609  71.1%     -  661s
     0     0 30437.3278    0  338 17867.0211 30437.3278  70.4%     -  688s
     0     0 30426.4118    0  341 17867.0211 30426.4118  70.3%     -  708s
     0     0 30389.1963    0  346 17867.0211 30389.1963  70.1%     -  731s
     0     0 30380.8837    0  346 17867.0211 30380.8837  70.0%     -  741s
     0     0 30376.3751    0  338 17867.0211 30376.3751  70.0%     -  748s
     0     0 30370.4055    0  344 17867.0211 30370.4055  70.0%     -  753s
     0     0 30368.9246    0  344 17867.0211 30368.9246  70.0%     -  762s
     0     0 30364.0128    0  341 17867.0211 30364.0128  69.9%     -  767s
     0     0 30362.3680    0  343 17867.0211 30362.3680  69.9%     -  770s
     0     0 30361.9722    0  350 17867.0211 30361.9722  69.9%     -  773s
     0     0 28786.4116    0  345 17867.0211 28786.4116  61.1%     -  874s
H    0     0                    17979.985167 28786.1529  60.1%     -  875s
     0     0 28292.0165    0  301 17979.9852 28292.0165  57.4%     -  935s
     0     0 28142.3777    0  374 17979.9852 28142.3777  56.5%     -  969s
     0     0 28108.4440    0  312 17979.9852 28108.4440  56.3%     -  984s
     0     0 28057.2087    0  317 17979.9852 28057.2087  56.0%     - 1008s
     0     0 28029.4336    0  348 17979.9852 28029.4336  55.9%     - 1021s
     0     0 28013.4081    0  349 17979.9852 28013.4081  55.8%     - 1030s
     0     0 27993.8507    0  350 17979.9852 27993.8507  55.7%     - 1038s
     0     0 27991.8725    0  351 17979.9852 27991.8725  55.7%     - 1041s
     0     0 27991.5101    0  351 17979.9852 27991.5101  55.7%     - 1044s
     0     0 27644.1931    0  371 17979.9852 27644.1931  53.7%     - 1091s
H    0     0                    18011.343571 27641.3932  53.5%     - 1092s
     0     0 27511.4135    0  361 18011.3436 27511.4135  52.7%     - 1112s
     0     0 27463.1775    0  367 18011.3436 27463.1775  52.5%     - 1123s
     0     0 27452.4314    0  372 18011.3436 27452.4314  52.4%     - 1132s
     0     0 27437.9539    0  380 18011.3436 27437.9539  52.3%     - 1142s
     0     0 27434.4099    0  381 18011.3436 27434.4099  52.3%     - 1144s
     0     0 27433.8666    0  382 18011.3436 27433.8666  52.3%     - 1147s
     0     0 27401.8282    0  356 18011.3436 27401.8282  52.1%     - 1172s
     0     0 27395.8891    0  362 18011.3436 27395.8891  52.1%     - 1181s
     0     0 27393.1638    0  356 18011.3436 27393.1638  52.1%     - 1192s
     0     0 27391.8711    0  295 18011.3436 27391.8711  52.1%     - 1196s
     0     0 27369.8919    0  343 18011.3436 27369.8919  52.0%     - 1213s
H    0     0                    18413.326512 27369.6983  48.6%     - 1215s
H    0     0                    18471.709484 27369.6983  48.2%     - 1215s
H    0     0                    18837.648085 27369.6983  45.3%     - 1215s
     0     0 27366.5932    0  290 18837.6481 27366.5932  45.3%     - 1219s
     0     0 27366.0433    0  294 18837.6481 27366.0433  45.3%     - 1223s
     0     0 27342.7420    0  281 18837.6481 27342.7420  45.1%     - 1237s
     0     0 27339.7788    0  348 18837.6481 27339.7788  45.1%     - 1245s
     0     0 27339.2537    0  233 18837.6481 27339.2537  45.1%     - 1246s
     0     0 27328.4209    0  291 18837.6481 27328.4209  45.1%     - 1255s
H    0     0                    18868.402571 27327.6046  44.8%     - 1256s
H    0     0                    19131.464768 27327.6046  42.8%     - 1256s
H    0     0                    19149.887780 27327.6046  42.7%     - 1256s
H    0     0                    19175.343720 27327.6046  42.5%     - 1256s
     0     0 27324.3998    0  289 19175.3437 27324.3998  42.5%     - 1257s
     0     0 27324.3998    0  289 19175.3437 27324.3998  42.5%     - 1257s
     0     0 27324.3613    0  233 19175.3437 27324.3613  42.5%     - 1260s
     0     0 27319.7051    0  287 19175.3437 27319.7051  42.5%     - 1265s
     0     0 27318.8949    0  233 19175.3437 27318.8949  42.5%     - 1267s
     0     0 27318.5341    0  230 19175.3437 27318.5341  42.5%     - 1271s
H    0     0                    19254.321421 27317.8387  41.9%     - 1272s
H    0     0                    19263.752614 27317.8387  41.8%     - 1273s
     0     0 27317.8387    0  230 19263.7526 27317.8387  41.8%     - 1273s
     0     0 27312.8504    0  391 19263.7526 27312.8504  41.8%     - 1288s
     0     0 27312.2559    0  391 19263.7526 27312.2559  41.8%     - 1311s
H    0     0                    19278.622863 27312.2559  41.7%     - 1335s
H    0     0                    19338.213046 27312.2559  41.2%     - 1335s
H    0     0                    19610.556706 27312.2559  39.3%     - 1462s
H    0     0                    19668.110253 27312.2559  38.9%     - 1468s
     0     2 27312.2559    0  391 19668.1103 27312.2559  38.9%     - 1477s
     1     3 27281.3361    1  342 19668.1103 27312.2559  38.9%  6789 1486s
     2     4 27295.8950    1  343 19668.1103 27295.8950  38.8%  7575 1497s
     3     5 26504.6916    2  290 19668.1103 27295.8669  38.8% 15916 1544s
     4     8 27210.4060    2  404 19668.1103 27295.8388  38.8% 14070 1563s
     7    12 26404.5314    3  376 19668.1103 27210.2192  38.3% 14285 1609s
    11    24 25480.8697    4  306 19668.1103 27210.2192  38.3% 20509 1643s
    23    36 26176.6202    4  370 19668.1103 26756.9456  36.0% 28577 1735s
    35    62 24829.5844    5  311 19668.1103 26756.9456  36.0% 31580 2493s
H   42    62                    19669.098067 26756.9456  36.0% 28917 2493s
    63    94 24599.7266    6  278 19669.0981 26388.3035  34.2% 38062 2538s
    95   182 24473.3905    7  296 19669.0981 26103.9531  32.7% 34640 2606s
   185   244 24279.7186   10  282 19669.0981 26103.9531  32.7% 23746 2649s
   249   269 23307.6217   14  177 19669.0981 26103.9531  32.7% 20757 2684s
   278   300 23060.2001   15  180 19669.0981 26103.9531  32.7% 20643 2721s
   320   327 22966.4566   16  254 19669.0981 26103.9531  32.7% 19630 2758s
   357   343 23394.5461   13  298 19669.0981 26103.9531  32.7% 19194 2796s
   385   377 22465.9885   17  202 19669.0981 26103.9531  32.7% 19105 2834s
   429   404 22184.7704   19  281 19669.0981 26103.9531  32.7% 18717 2874s
   459   436 infeasible   20      19669.0981 26103.9531  32.7% 18518 2908s
   497   470 20580.8229   21  121 19669.0981 26103.9531  32.7% 18240 2939s
   541   508 20331.8881   22  105 19669.0981 26103.9531  32.7% 17696 2971s
   599   539 20129.5703   23  117 19669.0981 26103.9531  32.7% 17035 3000s
   665   577 20390.0899   23  100 19669.0981 26103.9531  32.7% 16228 3034s
   732   602 infeasible   27      19669.0981 26103.9531  32.7% 15609 3066s
   806   628     cutoff   19      19669.0981 26103.9531  32.7% 15171 3099s
   885   667 20107.3877   19  190 19669.0981 26103.9531  32.7% 14733 3135s
   973   683     cutoff   22      19669.0981 26103.9531  32.7% 14273 3169s
  1062   688 20890.2893   15  262 19669.0981 26103.9531  32.7% 13813 3204s
  1145   725 20864.9388   16  259 19669.0981 26103.9531  32.7% 13508 3239s
  1220   775 20224.6929   21  252 19669.0981 26103.9531  32.7% 13404 3273s
  1326   859 20312.3573   28  257 19669.0981 26103.9531  32.7% 13078 3306s
  1447   930 20230.7812   37  181 19669.0981 26103.9531  32.7% 12648 3342s
  1572  1019 20072.8230   47  155 19669.0981 26103.9531  32.7% 12384 3379s
  1712  1065     cutoff   56      19669.0981 26103.9531  32.7% 12092 3418s
  1831  1115 infeasible   17      19669.0981 25516.0879  29.7% 11986 3469s
  1943  1142 24223.6632    7  259 19669.0981 25516.0879  29.7% 12016 3510s
  2041  1195 23612.2195    8  223 19669.0981 25516.0879  29.7% 12026 3548s
  2143  1306 22920.6229   10  193 19669.0981 25516.0879  29.7% 12066 3593s
  2305  1328 22404.2675   14  195 19669.0981 25516.0879  29.7% 11820 3600s

Cutting planes:
  Learned: 2
  Gomory: 19
  Implied bound: 405
  MIR: 4638
  Flow cover: 3885
  RLT: 59
  Relax-and-lift: 798

Explored 2345 nodes (28308794 simplex iterations) in 3600.09 seconds (7918.00 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19669.1 19668.1 19610.6 ... 19131.5

Time limit reached
Best objective 1.966909806660e+04, best bound 2.551608786291e+04, gap 29.7268%
  WARNING: Time limit reached. Using best solution found (gap: 29.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 19669.10, θ = 141163.49
  Upper Bound (UB) = 19669.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141163.49
  [DEBUG]   ✓ Scenario 0: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 141163.49 ≤ Q = 143050.89 (slack: 1887.39)
  [DEBUG]   ✓ Scenario 8: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 141163.49 ≤ Q = 141895.91 (slack: 732.42)
  [DEBUG]   ✓ Scenario 15: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 25: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 26: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 27: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 28: θ = 141163.49 ≤ Q = 141163.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 29: θ = 141163.49 ≤ Q = 141163.49 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 30] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4e4eb01
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x04e4eb01
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.510786e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7778157.4930
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.446948e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144694.76    0  130 7778157.49 -144694.76   102%     -    0s
H    0     0                    -104526.5390 -144694.76  38.4%     -    0s
H    0     0                    -109806.0493 -122524.82  11.6%     -    0s
H    0     0                    -118638.8233 -122524.82  3.28%     -    0s
     0     0 -122524.82    0   44 -118638.82 -122524.82  3.28%     -    0s
H    0     0                    -120179.2765 -122432.78  1.88%     -    0s
H    0     0                    -121248.8194 -122320.10  0.88%     -    0s
     0     0 -122320.10    0   40 -121248.82 -122320.10  0.88%     -    0s
H    0     0                    -121845.5658 -122302.26  0.37%     -    0s
     0     0 -122302.26    0   41 -121845.57 -122302.26  0.37%     -    0s
     0     0 -122298.54    0   41 -121845.57 -122298.54  0.37%     -    0s
     0     0 -121981.63    0   14 -121845.57 -121981.63  0.11%     -    0s
     0     0 -121975.62    0   13 -121845.57 -121975.62  0.11%     -    0s
H    0     0                    -121855.5656 -121974.10  0.10%     -    0s
H    0     0                    -121877.7143 -121974.10  0.08%     -    0s
H    0     0                    -121891.3714 -121946.75  0.05%     -    0s
     0     0 -121946.75    0    8 -121891.37 -121946.75  0.05%     -    0s
     0     0 -121945.86    0    7 -121891.37 -121945.86  0.04%     -    0s
     0     0          -    0      -121891.37 -121903.06  0.01%     -    0s

Cutting planes:
  Gomory: 19
  Implied bound: 1
  MIR: 111
  Flow cover: 1
  RLT: 44
  Relax-and-lift: 2
  BQP: 4

Explored 1 nodes (516 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121891 -121878 -121856 ... 7.77816e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.218913714491e+05, best bound -1.219030644869e+05, gap 0.0096%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 130609.66
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121891.37
  [DEBUG]   S×d_nominal = 252501.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 252501.03 + -121891.37 = 130609.66
  [DEBUG]   Current θ from Master = 141163.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10553.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9115.27
  Lower Bound (LB) = 19843.94
  Gap (UB-LB) = -174.8388, Absolute Gap = 174.8388, Relative Gap = -0.008889
  *** CONVERGED (small negative gap: -174.84 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 30
Total Time: 77477.11s
Converged: True
Final Lower Bound: 19843.9368
Final Upper Bound: 19669.0981
Final Gap: -174.838780
Number of Critical Scenarios: 30
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 3, 5] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 30
Start Time: 2026-01-05 12:31:08
End Time: 2026-01-06 10:02:26
Total Time: 77477.11s
Optimal Value: 19843.94
Lower Bound: 19843.94
Upper Bound: 19669.10
Gap: -174.838780
Plants Opened: {0: [0], 1: [2], 2: [1]} (3 plants)
DCs Opened: [1, 3, 5] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed35_MD_gamma20_20260106_100226.csv

Total Execution Time: 77478.22 seconds
End Time: 2026-01-06 10:02:27

All tasks completed successfully!

