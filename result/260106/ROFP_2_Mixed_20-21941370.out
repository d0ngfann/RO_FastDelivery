
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 2
DI Scenario: Mixed
Start Time: 2026-01-04 23:36:28
================================================================================
Loading data from data/DH_data_full_seed2.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
  Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
  Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1012, max=1692
  DC capacity (MC): min=538, max=877

Demand Structure (s_rk matrix):
  Total customer-product pairs: 85/150 (43.3% sparse)
  Average products per customer: 1.70

Demand (only non-zero entries):
  Nominal (μ): min=8.09, max=34.97, count=85
  Deviation (μ̂): min=4.00, max=9.83

Costs:
  Plant fixed cost: min=5209, max=8462
  DC fixed cost: min=3490, max=5712
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
    Product 1: ['1.000', '1.395', '1.945'] (k=0.820)
    Product 2: ['1.000', '1.386', '1.922'] (k=0.805)
  MD:
    Product 0: ['1.000', '1.242', '1.542'] (k=0.534)
    Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
    Product 2: ['1.000', '1.211', '1.467'] (k=0.473)
  LD:
    Product 0: ['1.000', '1.018', '1.037'] (k=0.045)
    Product 1: ['1.000', '1.093', '1.194'] (k=0.219)
    Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
  Mixed:
    Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
    Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
    Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48765 nonzeros
Model fingerprint: 0x5e17c2b9
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11666 rows and 2666 columns
Presolve time: 0.08s
Presolved: 5007 rows, 5834 columns, 34720 nonzeros
Variable types: 3575 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -277691.3686
Found heuristic solution: objective -180534.4700

Root relaxation: objective 1.057932e+05, 4456 iterations, 0.13 seconds (0.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 105793.201    0  397 -180534.47 105793.201   159%     -    0s
H    0     0                    -156278.1431 105793.201   168%     -    0s
     0     0 99694.6751    0  718 -156278.14 99694.6751   164%     -    0s
     0     0 99407.6804    0  738 -156278.14 99407.6804   164%     -    0s
     0     0 99394.9165    0  740 -156278.14 99394.9165   164%     -    0s
     0     0 99390.7641    0  740 -156278.14 99390.7641   164%     -    0s
     0     0 99389.0638    0  740 -156278.14 99389.0638   164%     -    0s
     0     0 99380.1346    0  740 -156278.14 99380.1346   164%     -    0s
     0     0 99367.6562    0  737 -156278.14 99367.6562   164%     -    0s
H    0     0                    -148891.6605 94591.5893   164%     -    1s
     0     0 94591.5893    0  999 -148891.66 94591.5893   164%     -    1s
H    0     0                    -131484.6967 94590.7865   172%     -    1s
H    0     0                    -57712.13900 94290.9045   263%     -    1s
H    0     0                    -57548.62603 94290.9045   264%     -    1s
H    0     0                    -57391.79632 94290.9045   264%     -    1s
H    0     0                    -56845.25833 94290.9045   266%     -    1s
H    0     0                    -56655.95089 94290.9045   266%     -    1s
     0     0 94290.9045    0  987 -56655.951 94290.9045   266%     -    1s
     0     0 94224.6582    0 1080 -56655.951 94224.6582   266%     -    1s
     0     0 94217.2503    0 1080 -56655.951 94217.2503   266%     -    1s
     0     0 94216.8752    0 1082 -56655.951 94216.8752   266%     -    2s
     0     0 91254.5961    0 1046 -56655.951 91254.5961   261%     -    3s
H    0     0                    -53624.20300 91251.5914   270%     -    3s
H    0     0                    -42148.81312 90908.9245   316%     -    3s
H    0     0                    3736.2557588 90908.9245  2333%     -    3s
H    0     0                    38990.751307 90908.9245   133%     -    3s
     0     0 90908.9245    0 1042 38990.7513 90908.9245   133%     -    3s
     0     0 90855.7359    0 1066 38990.7513 90855.7359   133%     -    3s
     0     0 90840.9178    0 1061 38990.7513 90840.9178   133%     -    3s
     0     0 90839.5729    0 1064 38990.7513 90839.5729   133%     -    3s
     0     0 88727.3818    0 1108 38990.7513 88727.3818   128%     -    5s
H    0     0                    39031.058707 88269.9923   126%     -    5s
H    0     0                    39061.809138 88269.9923   126%     -    5s
H    0     0                    39246.681575 88269.9923   125%     -    5s
H    0     0                    39261.526719 88269.9923   125%     -    5s
H    0     0                    39299.619937 88269.9923   125%     -    5s
H    0     0                    39314.465081 88269.9923   125%     -    5s
H    0     0                    39325.661960 88269.9923   124%     -    5s
     0     0 88269.9923    0 1121 39325.6620 88269.9923   124%     -    5s
     0     0 88158.5343    0 1144 39325.6620 88158.5343   124%     -    6s
     0     0 88116.2742    0 1167 39325.6620 88116.2742   124%     -    6s
     0     0 88108.3518    0 1188 39325.6620 88108.3518   124%     -    6s
     0     0 88107.2823    0 1189 39325.6620 88107.2823   124%     -    6s
H    0     0                    39474.816167 86448.6714   119%     -    7s
H    0     0                    40182.906894 86448.6714   115%     -    7s
H    0     0                    40210.516639 86448.6714   115%     -    7s
H    0     0                    40228.339781 86448.6714   115%     -    7s
H    0     0                    40235.544614 86448.6714   115%     -    7s
H    0     0                    40567.429590 86448.6714   113%     -    7s
H    0     0                    40611.567343 86448.6714   113%     -    7s
H    0     0                    40655.642046 86448.6714   113%     -    7s
H    0     0                    40680.005401 86448.6714   113%     -    7s
H    0     0                    40686.270917 86448.6714   112%     -    7s
H    0     0                    41297.184029 86448.6714   109%     -    7s
H    0     0                    42025.514158 86448.6714   106%     -    7s
H    0     0                    42483.718333 86448.6714   103%     -    7s
H    0     0                    43324.636465 86448.6714   100%     -    7s
H    0     0                    43763.242510 86448.6714  97.5%     -    7s
H    0     0                    43883.677302 86448.6714  97.0%     -    7s
H    0     0                    43950.936759 86448.6714  96.7%     -    7s
H    0     0                    44447.489502 86448.6714  94.5%     -    7s
H    0     0                    44830.045425 86448.6714  92.8%     -    7s
     0     0 86448.6714    0 1154 44830.0454 86448.6714  92.8%     -    7s
     0     0 86183.8359    0 1185 44830.0454 86183.8359  92.2%     -    7s
     0     0 86122.2632    0 1190 44830.0454 86122.2632  92.1%     -    8s
     0     0 86109.8347    0 1193 44830.0454 86109.8347  92.1%     -    8s
     0     0 86107.2926    0 1205 44830.0454 86107.2926  92.1%     -    8s
     0     0 84868.0186    0 1170 44830.0454 84868.0186  89.3%     -    9s
     0     0 84654.1201    0 1212 44830.0454 84654.1201  88.8%     -    9s
H    0     0                    45125.067200 84555.1302  87.4%     -   10s
H    0     0                    45423.470304 84555.1302  86.1%     -   10s
H    0     0                    45442.042810 84555.1302  86.1%     -   10s
     0     0 84555.1302    0 1199 45442.0428 84555.1302  86.1%     -   10s
     0     0 84527.6577    0 1226 45442.0428 84527.6577  86.0%     -   10s
     0     0 84524.5699    0 1224 45442.0428 84524.5699  86.0%     -   10s
     0     0 83004.4317    0 1171 45442.0428 83004.4317  82.7%     -   11s
     0     0 82666.4708    0 1171 45442.0428 82666.4708  81.9%     -   12s
     0     0 82588.8614    0 1207 45442.0428 82588.8614  81.7%     -   12s
     0     0 82572.8633    0 1209 45442.0428 82572.8633  81.7%     -   13s
     0     0 82570.1474    0 1215 45442.0428 82570.1474  81.7%     -   13s
     0     0 81414.4972    0 1202 45442.0428 81414.4972  79.2%     -   14s
     0     0 81052.8875    0 1261 45442.0428 81052.8875  78.4%     -   15s
     0     0 80980.8450    0 1266 45442.0428 80980.8450  78.2%     -   15s
     0     0 80965.1784    0 1247 45442.0428 80965.1784  78.2%     -   15s
H    0     0                    45452.362966 80267.7272  76.6%     -   17s
H    0     0                    45487.824960 80267.7272  76.5%     -   17s
H    0     0                    45601.314827 80267.7272  76.0%     -   17s
H    0     0                    46045.837546 80267.7272  74.3%     -   17s
H    0     0                    46402.625059 80267.7272  73.0%     -   17s
H    0     0                    46562.345094 80267.7272  72.4%     -   17s
H    0     0                    46717.841366 80267.7272  71.8%     -   17s
     0     0 80267.7272    0 1148 46717.8414 80267.7272  71.8%     -   17s
     0     0 80141.2279    0 1153 46717.8414 80141.2279  71.5%     -   18s
     0     0 80093.7503    0 1194 46717.8414 80093.7503  71.4%     -   18s
     0     0 80087.3598    0 1186 46717.8414 80087.3598  71.4%     -   18s
H    0     0                    46761.062299 79480.9402  70.0%     -   19s
     0     0 79480.9402    0 1161 46761.0623 79480.9402  70.0%     -   19s
H    0     0                    46950.603666 79480.6601  69.3%     -   19s
     0     0 79321.2273    0 1176 46950.6037 79321.2273  68.9%     -   20s
     0     0 79283.8505    0 1235 46950.6037 79283.8505  68.9%     -   20s
     0     0 79275.7417    0 1236 46950.6037 79275.7417  68.8%     -   20s
     0     0 78847.2921    0 1149 46950.6037 78847.2921  67.9%     -   22s
H    0     0                    46985.586555 78740.1996  67.6%     -   23s
H    0     0                    47181.416129 78740.1996  66.9%     -   23s
H    0     0                    47183.634582 78740.1996  66.9%     -   23s
H    0     0                    47229.086979 78740.1996  66.7%     -   23s
H    0     0                    47257.785847 78740.1996  66.6%     -   23s
     0     0 78740.1996    0 1176 47257.7858 78740.1996  66.6%     -   23s
     0     0 78701.6004    0 1176 47257.7858 78701.6004  66.5%     -   23s
     0     0 78689.1539    0 1172 47257.7858 78689.1539  66.5%     -   23s
H    0     0                    47257.938447 78322.0391  65.7%     -   25s
H    0     0                    47282.244329 78322.0391  65.6%     -   25s
H    0     0                    47303.205609 78322.0391  65.6%     -   25s
H    0     0                    47322.164577 78322.0391  65.5%     -   25s
H    0     0                    47450.724831 78322.0391  65.1%     -   25s
H    0     0                    47500.463654 78322.0391  64.9%     -   25s
     0     0 78322.0391    0 1156 47500.4637 78322.0391  64.9%     -   25s
     0     0 78233.8729    0 1189 47500.4637 78233.8729  64.7%     -   25s
     0     0 78206.4725    0 1177 47500.4637 78206.4725  64.6%     -   26s
     0     0 77879.7583    0 1147 47500.4637 77879.7583  64.0%     -   27s
     0     0 77823.0537    0 1174 47500.4637 77823.0537  63.8%     -   27s
     0     0 77801.8241    0 1195 47500.4637 77801.8241  63.8%     -   28s
     0     0 77524.2823    0 1164 47500.4637 77524.2823  63.2%     -   29s
     0     0 77447.3922    0 1089 47500.4637 77447.3922  63.0%     -   30s
     0     0 77401.8735    0 1111 47500.4637 77401.8735  62.9%     -   30s
     0     0 77385.6877    0 1141 47500.4637 77385.6877  62.9%     -   31s
     0     0 77169.8582    0 1096 47500.4637 77169.8582  62.5%     -   32s
     0     0 77112.2377    0 1103 47500.4637 77112.2377  62.3%     -   32s
     0     0 77093.9521    0 1074 47500.4637 77093.9521  62.3%     -   32s
     0     0 76851.6680    0 1095 47500.4637 76851.6680  61.8%     -   34s
     0     0 76851.3457    0 1095 47500.4637 76851.3457  61.8%     -   34s
     0     2 76851.3319    0 1095 47500.4637 76851.3319  61.8%     -   38s
     1     4 76122.2245    1  957 47500.4637 76851.3319  61.8%  3398   40s
    15    32 74621.7286    4  724 47500.4637 75096.2591  58.1%  3592   46s
    63    96 73235.1349    6  692 47500.4637 74422.5564  56.7%  5322   50s
H  416   438                    47519.913901 74421.9160  56.6%  1369   54s
   437   561 70979.3501   15  454 47519.9139 74421.9160  56.6%  1323   55s
H  924   914                    47613.176949 74104.5913  55.6%   803   58s
   943  1021 67180.3328   31  378 47613.1769 74104.5913  55.6%   795   60s
  2080  1971 53630.1072   46  222 47613.1769 73948.1336  55.3%   507   65s
H 2124  2013                    47645.525896 73948.1336  55.2%   502   65s
  2776  2523     cutoff   54      47645.5259 73595.4383  54.5%   428   70s
H 2857  2566                    48517.505193 73595.4383  51.7%   423   71s
H 3234  2825                    49188.658598 73231.0693  48.9%   396   73s
H 3246  2814                    49349.941198 73231.0693  48.4%   395   73s
H 3951  3198                    49430.733083 73088.5902  47.9%   360   76s
  3952  3199 58837.4852   32 1095 49430.7331 73088.5902  47.9%   359   86s
  3975  3214 60794.0390   25  446 49430.7331 62050.2410  25.5%   357   90s
H 3986  3060                    49556.460174 61643.6078  24.4%   356   91s
  4051  3113 50933.5956   16  458 49556.4602 58628.7860  18.3%   364   95s
H 4311  2989                    50519.355895 58332.8362  15.5%   370   96s
H 4320  2840                    50916.014196 57823.9853  13.6%   370   96s
H 4637  2701                    50928.714286 57452.7174  12.8%   361   98s
H 4639  2568                    50936.482021 57452.7174  12.8%   361   98s
H 4643  2442                    50939.814972 57452.7174  12.8%   360   98s
H 4644  2322                    50942.733189 57452.7174  12.8%   360   98s
H 4645  2209                    50959.279041 57452.7174  12.7%   360   98s
H 4753  2076                    51001.029896 57181.3210  12.1%   358   98s
H 4761  1971                    51006.103317 57013.0551  11.8%   358   98s
H 4797  1862                    51039.805434 57013.0551  11.7%   358   98s
  5067  1832 54960.6348   26  399 51039.8054 56585.2896  10.9%   355  100s
H 5999  1363                    51047.854172 55367.9262  8.46%   337  103s
  6824   842 51108.0564   64   12 51047.8542 51613.8046  1.11%   310  105s

Cutting planes:
  Gomory: 3
  Implied bound: 5
  Projected implied bound: 30
  MIR: 251
  Flow cover: 652
  RLT: 16
  Relax-and-lift: 118

Explored 7563 nodes (2230857 simplex iterations) in 105.86 seconds (230.84 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51047.9 51039.8 51006.1 ... 50916

Optimal solution found (tolerance 1.00e-04)
Best objective 5.104785417231e+04, best bound 5.104785417231e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 105.87s
  Master Objective (UB) = 51047.85, θ = 181188.71
  Upper Bound (UB) = 51047.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 181188.71
  [DEBUG]   ✓ Scenario 0: θ = 181188.71 ≤ Q = 181188.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x562463fb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa9db9c05
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.548810e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8330836.5350
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.364614e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136461.37    0  124 8330836.54 -136461.37   102%     -    0s
H    0     0                    -101758.6929 -136461.37  34.1%     -    0s
H    0     0                    -102235.8965 -136461.37  33.5%     -    0s
H    0     0                    -105061.5028 -105061.50  0.00%     -    0s
     0     0          -    0      -105061.50 -105061.50  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 209

Explored 1 nodes (375 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -105062 -102236 -101759 ... 1.54881e+13
No other solutions better than -105062

Optimal solution found (tolerance 1.00e-04)
Best objective -1.050615027965e+05, best bound -1.050615027965e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 148666.89
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105061.50
  [DEBUG]   S×d_nominal = 253728.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253728.40 + -105061.50 = 148666.89
  [DEBUG]   Current θ from Master = 181188.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32521.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18526.04
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 32521.8167, Absolute Gap = 32521.8167, Relative Gap = 0.637085
  Not converged yet (gap = 32521.82 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92011 nonzeros
Model fingerprint: 0x57600b45
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 18526 (0.01s)
MIP start from previous solve produced solution with objective 18526 (0.01s)
Loaded MIP start from previous solve with objective 18526

Presolve removed 13161 rows and 5340 columns
Presolve time: 0.32s
Presolved: 18802 rows, 9400 columns, 104218 nonzeros
Variable types: 7141 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.643425e+04, 9601 iterations, 1.24 seconds (2.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56434.2522    0  289 18526.0375 56434.2522   205%     -    1s
H    0     0                    20466.361930 56434.2522   176%     -    1s
H    0     0                    21403.265534 56434.2522   164%     -    1s
     0     0 49787.4315    0  365 21403.2655 49787.4315   133%     -    2s
H    0     0                    21525.103569 49782.9497   131%     -    3s
     0     0 49553.0336    0  467 21525.1036 49553.0336   130%     -    3s
     0     0 49532.5366    0  468 21525.1036 49532.5366   130%     -    3s
     0     0 45583.1973    0  574 21525.1036 45583.1973   112%     -    5s
     0     0 44973.2959    0  635 21525.1036 44973.2959   109%     -    5s
     0     0 44924.0322    0  594 21525.1036 44924.0322   109%     -    5s
     0     0 44920.4397    0  619 21525.1036 44920.4397   109%     -    5s
     0     0 44920.2148    0  613 21525.1036 44920.2148   109%     -    5s
H    0     0                    26200.651471 44920.2148  71.4%     -    6s
H    0     0                    26541.419643 44920.2148  69.2%     -    6s
H    0     0                    26803.458294 44920.2148  67.6%     -    6s
H    0     0                    26843.365186 42522.1961  58.4%     -    7s
     0     0 42522.1961    0  263 26843.3652 42522.1961  58.4%     -    8s
     0     0 41681.7628    0  364 26843.3652 41681.7628  55.3%     -    8s
     0     0 41481.2240    0  348 26843.3652 41481.2240  54.5%     -    9s
     0     0 41432.7653    0  284 26843.3652 41432.7653  54.4%     -    9s
     0     0 41430.3298    0  277 26843.3652 41430.3298  54.3%     -    9s
H    0     0                    26869.161114 41430.3298  54.2%     -   10s
H    0     0                    26877.385278 41430.3298  54.1%     -   10s
H    0     0                    26941.953827 41430.3298  53.8%     -   10s
H    0     0                    26951.846376 39257.1770  45.7%     -   12s
     0     0 39257.1770    0  556 26951.8464 39257.1770  45.7%     -   12s
     0     0 38652.9879    0  496 26951.8464 38652.9879  43.4%     -   13s
     0     0 38512.3896    0  606 26951.8464 38512.3896  42.9%     -   13s
     0     0 38423.4966    0  527 26951.8464 38423.4966  42.6%     -   14s
     0     0 38403.7307    0  530 26951.8464 38403.7307  42.5%     -   14s
     0     0 38400.8071    0  536 26951.8464 38400.8071  42.5%     -   14s
     0     0 37486.4726    0  695 26951.8464 37486.4726  39.1%     -   16s
     0     0 37261.1705    0  781 26951.8464 37261.1705  38.3%     -   16s
     0     0 37183.6655    0  809 26951.8464 37183.6655  38.0%     -   17s
     0     0 37142.0585    0  793 26951.8464 37142.0585  37.8%     -   17s
     0     0 37129.0863    0  816 26951.8464 37129.0863  37.8%     -   17s
     0     0 37126.3139    0  828 26951.8464 37126.3139  37.8%     -   17s
     0     0 36665.9717    0  443 26951.8464 36665.9717  36.0%     -   19s
H    0     0                    26968.147014 36665.3880  36.0%     -   19s
     0     0 36516.9664    0  461 26968.1470 36516.9664  35.4%     -   20s
     0     0 36458.3752    0  487 26968.1470 36458.3752  35.2%     -   20s
     0     0 36443.0105    0  472 26968.1470 36443.0105  35.1%     -   20s
     0     0 36439.0796    0  476 26968.1470 36439.0796  35.1%     -   20s
     0     0 36194.3560    0  435 26968.1470 36194.3560  34.2%     -   21s
     0     0 36087.5026    0  451 26968.1470 36087.5026  33.8%     -   22s
     0     0 36051.1178    0  466 26968.1470 36051.1178  33.7%     -   22s
     0     0 36022.5044    0  472 26968.1470 36022.5044  33.6%     -   22s
     0     0 36010.4172    0  481 26968.1470 36010.4172  33.5%     -   22s
     0     0 36003.3595    0  486 26968.1470 36003.3595  33.5%     -   22s
     0     0 36002.7467    0  485 26968.1470 36002.7467  33.5%     -   22s
     0     0 35901.8043    0  455 26968.1470 35901.8043  33.1%     -   23s
     0     0 35875.1679    0  463 26968.1470 35875.1679  33.0%     -   24s
     0     0 35868.7738    0  466 26968.1470 35868.7738  33.0%     -   24s
     0     0 35807.7411    0  449 26968.1470 35807.7411  32.8%     -   24s
     0     0 35791.0458    0  454 26968.1470 35791.0458  32.7%     -   25s
     0     0 35787.2068    0  456 26968.1470 35787.2068  32.7%     -   25s
     0     0 35751.6726    0  477 26968.1470 35751.6726  32.6%     -   25s
     0     0 35730.1895    0  476 26968.1470 35730.1895  32.5%     -   26s
     0     0 35717.3630    0  499 26968.1470 35717.3630  32.4%     -   26s
     0     0 35715.5195    0  489 26968.1470 35715.5195  32.4%     -   26s
     0     0 35695.9652    0  545 26968.1470 35695.9652  32.4%     -   27s
     0     0 35694.0852    0  545 26968.1470 35694.0852  32.4%     -   27s
     0     2 35694.0852    0  545 26968.1470 35694.0852  32.4%     -   31s
    31    64 34235.3409    5  444 26968.1470 35172.3080  30.4%  1182   35s
   333   363 32025.7019    9  277 26968.1470 34799.9060  29.0%   582   40s
   697   605 30150.3001   14  363 26968.1470 34218.3954  26.9%   576   45s
   983   715 32485.4806    9  258 26968.1470 33876.6024  25.6%   571   50s
  1385   852     cutoff   13      26968.1470 33737.9476  25.1%   559   55s
  1696   929 29428.3432   17  382 26968.1470 33737.9476  25.1%   551   60s
  2025  1006     cutoff   20      26968.1470 33150.4271  22.9%   537   65s
  2439  1058 31563.4587   13  334 26968.1470 33076.0904  22.6%   518   70s
  2973  1145     cutoff   15      26968.1470 32617.6511  20.9%   528   76s
  3382  1190 31670.3755   11  237 26968.1470 32300.4455  19.8%   519   80s
  3983  1282     cutoff   16      26968.1470 32166.6186  19.3%   526   86s
  4779  1343 28574.1310   16  104 26968.1470 31597.4701  17.2%   518   91s
  5294  1337 29923.3071   13  189 26968.1470 31396.5838  16.4%   519   95s
  5859  1332 28089.8723   13  481 26968.1470 31229.8427  15.8%   525  102s
  6379  1299     cutoff   16      26968.1470 30990.7340  14.9%   534  107s
  6683  1269 28156.2009   10  256 26968.1470 30850.4374  14.4%   537  110s
  7628  1076 28371.0911    8  280 26968.1470 30449.3178  12.9%   543  117s
  8523   831     cutoff   14      26968.1470 29963.1677  11.1%   534  122s
  9606   581 infeasible   18      26968.1470 29424.1848  9.11%   523  127s
  9959   102     cutoff   16      26968.1470 29116.8905  7.97%   520  132s

Cutting planes:
  Learned: 1
  Implied bound: 1
  MIR: 1525
  Flow cover: 1043
  RLT: 41
  Relax-and-lift: 350

Explored 10635 nodes (5404022 simplex iterations) in 134.54 seconds (381.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26968.1 26951.8 26942 ... 21525.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.696814701402e+04, best bound 2.696814701402e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 134.56s
  Master Objective (UB) = 26968.15, θ = 149627.98
  Upper Bound (UB) = 26968.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 149627.98
  [DEBUG]   ✓ Scenario 0: θ = 149627.98 ≤ Q = 149627.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 149627.98 ≤ Q = 149627.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x479c77b4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb863884c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.454065e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7593399.4230
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.468126e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146812.63    0  136 7593399.42 -146812.63   102%     -    0s
H    0     0                    -110125.2063 -146812.63  33.3%     -    0s
H    0     0                    -127394.2604 -146812.63  15.2%     -    0s
     0     0 -135404.14    0   77 -127394.26 -135404.14  6.29%     -    0s
H    0     0                    -133124.7914 -135281.29  1.62%     -    0s
     0     0 -134675.48    0   81 -133124.79 -134675.48  1.16%     -    0s
     0     0 -134667.12    0   81 -133124.79 -134667.12  1.16%     -    0s
     0     0 -134057.62    0   32 -133124.79 -134057.62  0.70%     -    0s
H    0     0                    -133870.3030 -134033.40  0.12%     -    0s
     0     0 -133998.07    0   29 -133870.30 -133998.07  0.10%     -    0s
     0     0 -133970.72    0   18 -133870.30 -133970.72  0.08%     -    0s
     0     0 -133950.11    0   16 -133870.30 -133950.11  0.06%     -    0s
     0     0 -133932.89    0   12 -133870.30 -133932.89  0.05%     -    0s
     0     0 -133926.26    0   10 -133870.30 -133926.26  0.04%     -    0s
     0     0 -133923.91    0   10 -133870.30 -133923.91  0.04%     -    0s
     0     0 -133894.03    0    8 -133870.30 -133894.03  0.02%     -    0s
     0     0 -133891.21    0    6 -133870.30 -133891.21  0.02%     -    0s
H    0     0                    -133877.7805 -133891.21  0.01%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 4
  Flow cover: 3
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (675 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -133878 -133870 -133125 ... 1.45406e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.338777804784e+05, best bound -1.338870506495e+05, gap 0.0069%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 126854.13
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133877.78
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -133877.78 = 126854.13
  [DEBUG]   Current θ from Master = 149627.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22773.85 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4194.30
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 8442.1095, Absolute Gap = 8442.1095, Relative Gap = 0.313040
  Not converged yet (gap = 8442.11 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135257 nonzeros
Model fingerprint: 0xf637cc65
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4194.3 (0.02s)
MIP start from previous solve produced solution with objective 4194.3 (0.02s)
Loaded MIP start from previous solve with objective 4194.3

Presolve removed 19715 rows and 8005 columns
Presolve time: 0.41s
Presolved: 27538 rows, 12975 columns, 169514 nonzeros
Variable types: 10716 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.842825e+04, 17238 iterations, 4.28 seconds (8.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48428.2517    0  213 4194.29526 48428.2517  1055%     -    4s
H    0     0                    6954.2648279 48428.2517   596%     -    4s
H    0     0                    17625.275402 48428.2517   175%     -    4s
H    0     0                    17764.842161 48428.2517   173%     -    5s
H    0     0                    17784.506571 48428.2517   172%     -    5s
H    0     0                    20127.917692 48428.2517   141%     -    5s
H    0     0                    23567.405602 48427.5452   105%     -    5s
H    0     0                    23704.130260 42718.3539  80.2%     -    6s
H    0     0                    24218.411951 42718.3539  76.4%     -    6s
     0     0 42718.3539    0  260 24218.4120 42718.3539  76.4%     -    6s
H    0     0                    25617.083420 42717.4092  66.8%     -    6s
H    0     0                    25774.774739 42717.4092  65.7%     -    6s
H    0     0                    25806.527879 42717.4092  65.5%     -    6s
H    0     0                    25975.183380 42476.9863  63.5%     -    7s
H    0     0                    25978.429611 42476.9863  63.5%     -    7s
H    0     0                    26009.727986 42476.9863  63.3%     -    7s
     0     0 42411.4863    0  262 26009.7280 42411.4863  63.1%     -    7s
     0     0 42410.0442    0  219 26009.7280 42410.0442  63.1%     -    7s
     0     0 42410.0442    0  217 26009.7280 42410.0442  63.1%     -    7s
     0     0 42410.0442    0  218 26009.7280 42410.0442  63.1%     -    7s
     0     0 40854.3756    0  259 26009.7280 40854.3756  57.1%     -    8s
     0     0 40346.9240    0  255 26009.7280 40346.9240  55.1%     -    9s
     0     0 40288.0295    0  259 26009.7280 40288.0295  54.9%     -    9s
     0     0 40210.6055    0  325 26009.7280 40210.6055  54.6%     -   10s
     0     0 40180.5733    0  265 26009.7280 40180.5733  54.5%     -   10s
     0     0 40176.0043    0  268 26009.7280 40176.0043  54.5%     -   10s
     0     0 40175.1500    0  266 26009.7280 40175.1500  54.5%     -   10s
     0     0 40175.0712    0  268 26009.7280 40175.0712  54.5%     -   10s
     0     0 38457.6510    0  370 26009.7280 38457.6510  47.9%     -   12s
H    0     0                    26053.777978 38456.4229  47.6%     -   13s
     0     0 38015.9057    0  375 26053.7780 38015.9057  45.9%     -   13s
     0     0 37788.6929    0  374 26053.7780 37788.6929  45.0%     -   14s
     0     0 37638.4298    0  388 26053.7780 37638.4298  44.5%     -   15s
     0     0 37575.3911    0  390 26053.7780 37575.3911  44.2%     -   15s
     0     0 37566.7270    0  387 26053.7780 37566.7270  44.2%     -   16s
     0     0 37564.6276    0  386 26053.7780 37564.6276  44.2%     -   16s
     0     0 37564.4411    0  386 26053.7780 37564.4411  44.2%     -   16s
     0     0 36782.6605    0  446 26053.7780 36782.6605  41.2%     -   19s
     0     0 36334.1956    0  433 26053.7780 36334.1956  39.5%     -   21s
     0     0 36101.8631    0  486 26053.7780 36101.8631  38.6%     -   22s
     0     0 35972.8102    0  448 26053.7780 35972.8102  38.1%     -   22s
     0     0 35940.6033    0  447 26053.7780 35940.6033  37.9%     -   23s
     0     0 35930.5252    0  459 26053.7780 35930.5252  37.9%     -   23s
     0     0 35926.0801    0  455 26053.7780 35926.0801  37.9%     -   23s
     0     0 35925.3408    0  461 26053.7780 35925.3408  37.9%     -   23s
     0     0 35750.9249    0  403 26053.7780 35750.9249  37.2%     -   24s
H    0     0                    26121.880678 35750.5265  36.9%     -   24s
H    0     0                    26157.774888 35750.5265  36.7%     -   24s
     0     0 35649.2130    0  464 26157.7749 35649.2130  36.3%     -   25s
     0     0 35624.0953    0  454 26157.7749 35624.0953  36.2%     -   25s
     0     0 35609.4276    0  466 26157.7749 35609.4276  36.1%     -   26s
     0     0 35606.8228    0  470 26157.7749 35606.8228  36.1%     -   26s
     0     0 35602.8066    0  418 26157.7749 35602.8066  36.1%     -   26s
     0     0 35601.8172    0  474 26157.7749 35601.8172  36.1%     -   26s
     0     0 35555.5624    0  457 26157.7749 35555.5624  35.9%     -   27s
     0     0 35537.0506    0  477 26157.7749 35537.0506  35.9%     -   27s
     0     0 35525.6222    0  489 26157.7749 35525.6222  35.8%     -   28s
     0     0 35522.9478    0  488 26157.7749 35522.9478  35.8%     -   28s
     0     0 35521.1008    0  539 26157.7749 35521.1008  35.8%     -   28s
     0     0 35520.5695    0  488 26157.7749 35520.5695  35.8%     -   28s
     0     0 35478.1622    0  477 26157.7749 35478.1622  35.6%     -   28s
     0     0 35460.6783    0  445 26157.7749 35460.6783  35.6%     -   29s
     0     0 35457.6771    0  475 26157.7749 35457.6771  35.6%     -   29s
     0     0 35456.6008    0  477 26157.7749 35456.6008  35.5%     -   29s
     0     0 35426.4286    0  521 26157.7749 35426.4286  35.4%     -   30s
     0     0 35420.2398    0  527 26157.7749 35420.2398  35.4%     -   31s
     0     0 35419.5246    0  526 26157.7749 35419.5246  35.4%     -   31s
     0     0 35390.6132    0  460 26157.7749 35390.6132  35.3%     -   32s
     0     0 35382.6397    0  473 26157.7749 35382.6397  35.3%     -   32s
     0     0 35381.2755    0  473 26157.7749 35381.2755  35.3%     -   32s
     0     0 35345.9881    0  471 26157.7749 35345.9881  35.1%     -   33s
     0     0 35333.1501    0  525 26157.7749 35333.1501  35.1%     -   33s
     0     0 35331.1739    0  468 26157.7749 35331.1739  35.1%     -   33s
     0     0 35331.0637    0  520 26157.7749 35331.0637  35.1%     -   34s
     0     0 35317.1799    0  529 26157.7749 35317.1799  35.0%     -   34s
     0     0 35315.0085    0  477 26157.7749 35315.0085  35.0%     -   35s
     0     0 35314.2608    0  533 26157.7749 35314.2608  35.0%     -   35s
     0     0 35306.0719    0  520 26157.7749 35306.0719  35.0%     -   35s
     0     0 35302.5634    0  479 26157.7749 35302.5634  35.0%     -   35s
     0     0 35301.6325    0  477 26157.7749 35301.6325  35.0%     -   35s
     0     0 35293.5812    0  482 26157.7749 35293.5812  34.9%     -   36s
     0     0 35291.1922    0  483 26157.7749 35291.1922  34.9%     -   36s
     0     0 35289.6596    0  481 26157.7749 35289.6596  34.9%     -   36s
     0     0 35257.9967    0  477 26157.7749 35257.9967  34.8%     -   37s
H    0     0                    26236.495653 35257.7290  34.4%     -   37s
H    0     0                    26241.106455 35257.7290  34.4%     -   37s
H    0     0                    26244.604711 35257.7290  34.3%     -   37s
H    0     0                    26284.510203 35257.7290  34.1%     -   37s
     0     0 35249.4161    0  470 26284.5102 35249.4161  34.1%     -   38s
     0     0 35244.1886    0  471 26284.5102 35244.1886  34.1%     -   38s
     0     0 35240.7488    0  470 26284.5102 35240.7488  34.1%     -   38s
     0     0 35240.3577    0  470 26284.5102 35240.3577  34.1%     -   38s
     0     0 35223.3792    0  464 26284.5102 35223.3792  34.0%     -   38s
H    0     0                    26290.306402 35222.7190  34.0%     -   39s
H    0     0                    26328.185849 35222.7190  33.8%     -   39s
H    0     0                    26335.318560 35222.7190  33.7%     -   39s
H    0     0                    26352.297877 35222.7190  33.7%     -   39s
H    0     0                    26365.893452 35222.7190  33.6%     -   39s
     0     0 35219.2450    0  473 26365.8935 35219.2450  33.6%     -   39s
     0     0 35212.6140    0  478 26365.8935 35212.6140  33.6%     -   39s
     0     0 35209.3966    0  476 26365.8935 35209.3966  33.5%     -   39s
     0     0 35209.3401    0  480 26365.8935 35209.3401  33.5%     -   39s
     0     0 35202.5967    0  480 26365.8935 35202.5967  33.5%     -   40s
H    0     0                    26375.786001 35202.4391  33.5%     -   40s
     0     0 35202.0145    0  476 26375.7860 35202.0145  33.5%     -   40s
     0     0 35186.8740    0  527 26375.7860 35186.8740  33.4%     -   40s
     0     0 35180.6502    0  527 26375.7860 35180.6502  33.4%     -   41s
     0     0 35178.8939    0  481 26375.7860 35178.8939  33.4%     -   41s
     0     0 35174.8713    0  477 26375.7860 35174.8713  33.4%     -   41s
     0     0 35171.9018    0  481 26375.7860 35171.9018  33.3%     -   42s
     0     0 35170.3132    0  484 26375.7860 35170.3132  33.3%     -   42s
     0     0 35163.0036    0  478 26375.7860 35163.0036  33.3%     -   43s
     0     0 35162.1714    0  478 26375.7860 35162.1714  33.3%     -   43s
     0     2 35162.1387    0  478 26375.7860 35162.1387  33.3%     -   54s
     1     4 35015.4041    1  470 26375.7860 35162.1387  33.3%   869   55s
     7    16 34788.1660    3  518 26375.7860 34910.5329  32.4%  2663   60s
    31    64 33900.9335    5  535 26375.7860 34336.1612  30.2%  3632   65s
H   82    96                    26390.050597 33900.5323  28.5%  2506   65s
H   84    96                    26479.048156 33900.5323  28.0%  2454   65s
   283   282 33646.1866   10  531 26479.0482 33900.5323  28.0%  1193   70s
   364   340 33459.7442   11  466 26479.0482 33893.6857  28.0%  1381   76s
   446   397 33345.8676   12  454 26479.0482 33852.5366  27.8%  1458   80s
   574   474 31765.3992   14  425 26479.0482 33581.5776  26.8%  1570   86s
   660   530 31443.1410   15  414 26479.0482 33581.5776  26.8%  1663   91s
   741   592 26982.9191   16  370 26479.0482 33581.5776  26.8%  1690   96s
   844   644 29355.5600   18  423 26479.0482 33515.5756  26.6%  1670  100s
  1010   730 28694.5785   20  367 26479.0482 32924.3138  24.3%  1658  106s
  1120   784 28417.8056   22  341 26479.0482 32924.3138  24.3%  1650  110s
  1339   844     cutoff   25      26479.0482 32698.3536  23.5%  1629  117s
  1427   865 27394.0465   27  225 26479.0482 32537.4578  22.9%  1615  120s
  1634   916     cutoff   30      26479.0482 32416.8506  22.4%  1594  126s
  1869   975 26572.7254   13  370 26479.0482 32399.9121  22.4%  1579  132s
  1997   995 26548.9488   17  241 26479.0482 32370.7567  22.3%  1570  135s
  2210  1038 28945.0981   14  312 26479.0482 32182.0731  21.5%  1580  141s
  2431  1076     cutoff   16      26479.0482 31744.4552  19.9%  1613  148s
  2551  1124 28110.3739   17  307 26479.0482 31711.0961  19.8%  1619  151s
  2809  1202     cutoff   23      26479.0482 31711.0961  19.8%  1624  158s
  2962  1243     cutoff   24      26479.0482 31711.0961  19.8%  1611  161s
  3133  1293 infeasible   16      26479.0482 31711.0961  19.8%  1606  165s
  3572  1394 27372.3178   18  390 26479.0482 31339.6596  18.4%  1564  172s
  3805  1432 infeasible   22      26479.0482 31339.6596  18.4%  1543  176s
  4027  1461 27760.2376    9  437 26479.0482 31339.6596  18.4%  1525  180s
  4447  1539 28245.6888   19  238 26479.0482 31155.2615  17.7%  1507  188s
  4765  1563     cutoff   23      26479.0482 30727.3258  16.0%  1479  193s
  5047  1556 27184.1996   26  186 26479.0482 30613.1185  15.6%  1473  197s
  5284  1588 29111.0301   17  259 26479.0482 30578.8701  15.5%  1463  201s
  5489  1564 28290.1753   20  354 26479.0482 30424.5206  14.9%  1457  206s
  5827  1575 27266.9203   23  386 26479.0482 30424.5206  14.9%  1434  210s
  6117  1570     cutoff   28      26479.0482 30084.2807  13.6%  1426  216s
  6421  1573 26699.1223   19  391 26479.0482 29992.8737  13.3%  1421  221s
  6482  1593 26568.0110   20  386 26479.0482 29992.8737  13.3%  1423  226s
  6557  1583 26554.1587   21  389 26479.0482 29992.8737  13.3%  1420  232s
  6869  1560 26891.0823   22  240 26479.0482 29992.8737  13.3%  1403  237s
  7227  1551 26893.9372   21  216 26479.0482 29691.1524  12.1%  1398  243s
  7593  1500 27341.2832   13  484 26479.0482 29486.6499  11.4%  1394  249s
  8026  1463 27861.9853   15  464 26479.0482 29362.7468  10.9%  1384  254s
  8478  1406 26991.4773   18  422 26479.0482 29194.2107  10.3%  1374  260s
  8942  1330 27174.3867   26  275 26479.0482 28886.6186  9.09%  1364  266s
  9424  1189     cutoff   16      26479.0482 28720.3489  8.46%  1353  273s
 10012  1018     cutoff   19      26479.0482 28524.0284  7.72%  1337  278s
 10650   780     cutoff   26      26479.0482 28274.1861  6.78%  1311  284s
 11252   447     cutoff   26      26479.0482 28089.6839  6.08%  1297  290s
 12119    20     cutoff   23      26479.0482 27791.1114  4.96%  1253  296s

Cutting planes:
  Learned: 1
  Implied bound: 13
  MIR: 377
  Flow cover: 862
  RLT: 27
  Relax-and-lift: 66

Explored 12789 nodes (15621855 simplex iterations) in 296.91 seconds (995.47 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26479 26390.1 26375.8 ... 26244.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.647904815577e+04, best bound 2.647904815577e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 296.93s
  Master Objective (UB) = 26479.05, θ = 149345.82
  Upper Bound (UB) = 26479.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 149345.82
  [DEBUG]   ✓ Scenario 0: θ = 149345.82 ≤ Q = 149345.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 149345.82 ≤ Q = 149345.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 149345.82 ≤ Q = 149345.82 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x9961988
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x09961988
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.458963e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7558222.0193
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.445195e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144519.47    0  135 7558222.02 -144519.47   102%     -    0s
H    0     0                    -105396.1451 -144519.47  37.1%     -    0s
H    0     0                    -106256.9062 -144519.47  36.0%     -    0s
H    0     0                    -123689.5133 -144519.47  16.8%     -    0s
H    0     0                    -124048.2680 -144519.47  16.5%     -    0s
     0     0 -133809.78    0   81 -124048.27 -133809.78  7.87%     -    0s
H    0     0                    -130755.4146 -133755.37  2.29%     -    0s
H    0     0                    -131058.4532 -133755.37  2.06%     -    0s
H    0     0                    -131722.0827 -133755.37  1.54%     -    0s
H    0     0                    -132025.1213 -133755.37  1.31%     -    0s
     0     0 -132931.57    0   81 -132025.12 -132931.57  0.69%     -    0s
     0     0 -132931.24    0   81 -132025.12 -132931.24  0.69%     -    0s
     0     0 -132497.40    0   41 -132025.12 -132497.40  0.36%     -    0s
H    0     0                    -132171.2990 -132489.22  0.24%     -    0s
     0     0 -132423.44    0   36 -132171.30 -132423.44  0.19%     -    0s
     0     0 -132412.88    0   29 -132171.30 -132412.88  0.18%     -    0s
     0     0 -132392.28    0   30 -132171.30 -132392.28  0.17%     -    0s
     0     0 -132386.54    0   30 -132171.30 -132386.54  0.16%     -    0s
     0     0 -132329.24    0   11 -132171.30 -132329.24  0.12%     -    0s
     0     0 -132329.24    0   14 -132188.47 -132329.24  0.11%     -    0s
H    0     0                    -132204.0190 -132329.24  0.09%     -    0s
     0     0 -132283.74    0    7 -132204.02 -132283.74  0.06%     -    0s
     0     0 -132282.83    0    5 -132204.02 -132282.83  0.06%     -    0s
H    0     0                    -132256.9961 -132282.40  0.02%     -    0s
H    0     0                    -132277.2560 -132282.40  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 4
  Flow cover: 7
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (823 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -132277 -132257 -132204 ... -123690

Optimal solution found (tolerance 1.00e-04)
Best objective -1.322772560098e+05, best bound -1.322823990044e+05, gap 0.0039%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 127120.17
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132277.26
  [DEBUG]   S×d_nominal = 259397.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 259397.42 + -132277.26 = 127120.17
  [DEBUG]   Current θ from Master = 149345.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22225.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4253.39
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 7953.0107, Absolute Gap = 7953.0107, Relative Gap = 0.300351
  Not converged yet (gap = 7953.01 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178503 nonzeros
Model fingerprint: 0xf051e8c5
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4253.39 (0.06s)
Loaded MIP start from previous solve with objective 4253.39

Presolve removed 26280 rows and 10670 columns
Presolve time: 0.55s
Presolved: 36263 rows, 16550 columns, 224199 nonzeros
Variable types: 14291 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 36263 rows, 16550 columns, 224199 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54288    2.2451286e+04   0.000000e+00   6.371550e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.772126e+04, 23845 iterations, 6.97 seconds (14.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 47721.2596    0  174 4253.39237 47721.2596  1022%     -    7s
H    0     0                    8749.0260355 47721.2596   445%     -    7s
H    0     0                    24821.468713 47721.2596  92.3%     -    7s
H    0     0                    25057.535211 47721.2596  90.4%     -    7s
H    0     0                    25167.648749 47721.2596  89.6%     -    8s
H    0     0                    25168.534032 47721.2596  89.6%     -    8s
     0     0 43543.9880    0  228 25168.5340 43543.9880  73.0%     -   11s
     0     0 42687.5294    0  218 25168.5340 42687.5294  69.6%     -   12s
     0     0 42687.5294    0  218 25168.5340 42687.5294  69.6%     -   12s
     0     0 42687.5294    0  218 25168.5340 42687.5294  69.6%     -   12s
     0     0 40344.4912    0  232 25168.5340 40344.4912  60.3%     -   15s
H    0     0                    25748.415011 40343.7160  56.7%     -   15s
     0     0 40105.1122    0  257 25748.4150 40105.1122  55.8%     -   16s
     0     0 39624.5674    0  301 25748.4150 39624.5674  53.9%     -   18s
     0     0 39481.5189    0  300 25748.4150 39481.5189  53.3%     -   18s
     0     0 39466.3870    0  300 25748.4150 39466.3870  53.3%     -   19s
     0     0 39465.1050    0  301 25748.4150 39465.1050  53.3%     -   19s
     0     0 39464.5767    0  305 25748.4150 39464.5767  53.3%     -   19s
     0     0 37829.8390    0  408 25748.4150 37829.8390  46.9%     -   23s
     0     0 37433.5769    0  382 25748.4150 37433.5769  45.4%     -   25s
     0     0 37164.2518    0  384 25748.4150 37164.2518  44.3%     -   27s
     0     0 37073.6404    0  384 25748.4150 37073.6404  44.0%     -   28s
     0     0 37033.4215    0  390 25748.4150 37033.4215  43.8%     -   28s
     0     0 36914.2789    0  391 25748.4150 36914.2789  43.4%     -   29s
     0     0 36840.0500    0  401 25748.4150 36840.0500  43.1%     -   30s
     0     0 36820.7705    0  397 25748.4150 36820.7705  43.0%     -   31s
     0     0 36815.6923    0  394 25748.4150 36815.6923  43.0%     -   31s
     0     0 36812.9803    0  400 25748.4150 36812.9803  43.0%     -   31s
     0     0 36812.5576    0  401 25748.4150 36812.5576  43.0%     -   31s
     0     0 35980.9723    0  462 25748.4150 35980.9723  39.7%     -   37s
     0     0 35587.4285    0  478 25748.4150 35587.4285  38.2%     -   39s
     0     0 35501.2023    0  432 25748.4150 35501.2023  37.9%     -   40s
     0     0 35440.6855    0  488 25748.4150 35440.6855  37.6%     -   41s
     0     0 35423.3003    0  490 25748.4150 35423.3003  37.6%     -   41s
     0     0 35418.7814    0  489 25748.4150 35418.7814  37.6%     -   41s
     0     0 35417.1798    0  488 25748.4150 35417.1798  37.6%     -   42s
     0     0 35416.4712    0  493 25748.4150 35416.4712  37.5%     -   42s
     0     0 35270.5358    0  444 25748.4150 35270.5358  37.0%     -   44s
H    0     0                    25749.218112 35270.0100  37.0%     -   44s
H    0     0                    25751.186440 35270.0100  37.0%     -   44s
H    0     0                    25779.214670 35222.8277  36.6%     -   44s
H    0     0                    25781.838980 35222.8277  36.6%     -   44s
     0     0 35222.8277    0  447 25781.8390 35222.8277  36.6%     -   45s
     0     0 35207.1278    0  446 25781.8390 35207.1278  36.6%     -   45s
     0     0 35194.7714    0  445 25781.8390 35194.7714  36.5%     -   45s
     0     0 35183.8159    0  460 25781.8390 35183.8159  36.5%     -   46s
     0     0 35178.3170    0  455 25781.8390 35178.3170  36.4%     -   46s
     0     0 35176.4628    0  461 25781.8390 35176.4628  36.4%     -   46s
     0     0 35176.2684    0  457 25781.8390 35176.2684  36.4%     -   46s
     0     0 35101.5063    0  445 25781.8390 35101.5063  36.1%     -   47s
H    0     0                    25787.163849 35100.0990  36.1%     -   47s
     0     0 35076.1900    0  503 25787.1638 35076.1900  36.0%     -   48s
     0     0 35061.1724    0  463 25787.1638 35061.1724  36.0%     -   49s
     0     0 35052.6904    0  463 25787.1638 35052.6904  35.9%     -   49s
     0     0 35045.0563    0  461 25787.1638 35045.0563  35.9%     -   49s
     0     0 35043.9846    0  466 25787.1638 35043.9846  35.9%     -   49s
     0     0 35009.9178    0  460 25787.1638 35009.9178  35.8%     -   50s
H    0     0                    25788.049131 35009.2540  35.8%     -   50s
     0     0 35006.4800    0  467 25788.0491 35006.4800  35.7%     -   50s
     0     0 35001.6186    0  475 25788.0491 35001.6186  35.7%     -   51s
     0     0 35000.9954    0  473 25788.0491 35000.9954  35.7%     -   51s
     0     0 34985.9514    0  468 25788.0491 34985.9514  35.7%     -   52s
     0     0 34980.4313    0  474 25788.0491 34980.4313  35.6%     -   52s
     0     0 34979.4814    0  471 25788.0491 34979.4814  35.6%     -   52s
     0     0 34969.3184    0  468 25788.0491 34969.3184  35.6%     -   53s
     0     0 34958.2299    0  470 25788.0491 34958.2299  35.6%     -   54s
     0     0 34956.3882    0  464 25788.0491 34956.3882  35.6%     -   55s
     0     0 34954.8367    0  466 25788.0491 34954.8367  35.5%     -   55s
     0     0 34945.6784    0  476 25788.0491 34945.6784  35.5%     -   55s
     0     0 34942.7214    0  472 25788.0491 34942.7214  35.5%     -   55s
     0     0 34942.7214    0  471 25788.0491 34942.7214  35.5%     -   56s
     0     0 34942.7214    0  468 25788.0491 34942.7214  35.5%     -   56s
     0     0 34942.1542    0  473 25788.0491 34942.1542  35.5%     -   57s
     0     0 34941.3224    0  472 25788.0491 34941.3224  35.5%     -   57s
     0     0 34936.8915    0  413 25788.0491 34936.8915  35.5%     -   58s
     0     0 34936.2172    0  415 25788.0491 34936.2172  35.5%     -   58s
     0     0 34936.2172    0  415 25788.0491 34936.2172  35.5%     -   58s
     0     0 34936.2172    0  415 25788.0491 34936.2172  35.5%     -   59s
H    0     0                    25789.088782 34936.2090  35.5%     -   72s
H    0     2                    25791.860210 34936.2090  35.5%     -   73s
     0     2 34936.2090    0  415 25791.8602 34936.2090  35.5%     -   73s
     3     8 34155.7081    2  443 25791.8602 34491.9734  33.7%  2124   76s
    15    32 33706.5570    4  442 25791.8602 33832.3022  31.2%  2697   81s
    31    64 33395.3681    5  449 25791.8602 33705.8966  30.7%  2888   85s
    95   170 32687.4976    7  447 25791.8602 33390.1233  29.5%  2829   91s
   171   252 32629.0942    8  502 25791.8602 33390.1233  29.5%  2050   95s
   322   322 32222.4139    9  513 25791.8602 33390.1233  29.5%  1545  100s
   425   414 30466.8669   10  365 25791.8602 32569.4223  26.3%  1488  107s
   553   495 32047.7762   13  474 25791.8602 32568.8057  26.3%  1388  112s
   628   531 31284.5707   15  479 25791.8602 32568.8057  26.3%  1332  116s
H  630   531                    25811.015376 32568.8057  26.2%  1337  116s
   688   560 31427.9119   15  535 25811.0154 32484.4472  25.9%  1336  120s
   725   603 31129.0024   16  480 25811.0154 32349.3595  25.3%  1361  125s
   850   696 31009.9000   18  427 25811.0154 32349.3595  25.3%  1320  132s
   927   771 30948.9485   20  509 25811.0154 32220.6554  24.8%  1296  136s
   984   811 30748.5431   22  415 25811.0154 32220.6554  24.8%  1258  140s
  1105   894 29845.7603   27  429 25811.0154 32206.6470  24.8%  1208  148s
  1173   936 29484.0624   29  431 25811.0154 32079.2623  24.3%  1200  150s
  1240   971 29234.3193   30  418 25811.0154 32079.2623  24.3%  1193  155s
  1375  1060 28660.7419   33  367 25811.0154 31905.5344  23.6%  1195  162s
  1440  1117 28363.1931   33  402 25811.0154 31905.5344  23.6%  1204  166s
  1636  1247 28265.4341   38  305 25811.0154 31880.3116  23.5%  1182  174s
  1737  1304 27135.4789   42  294 25811.0154 31880.3116  23.5%  1179  177s
  1859  1364 25932.5841   43  310 25811.0154 31880.3116  23.5%  1166  180s
  1957  1452 26792.4730   43  243 25811.0154 31594.9793  22.4%  1164  185s
  2136  1479 26548.9748   48  271 25811.0154 31594.9793  22.4%  1120  190s
  2227  1502 infeasible   49      25811.0154 31476.3697  21.9%  1116  195s
  2372  1594 28585.3018    9  154 25811.0154 31422.9737  21.7%  1112  200s
  2512  1677 27319.9833   14   78 25811.0154 31422.9737  21.7%  1110  205s
  2677  1728 27924.2827   13  173 25811.0154 31404.2453  21.7%  1101  211s
  2846  1808     cutoff   16      25811.0154 31265.3439  21.1%  1095  216s
  3020  1875 infeasible   17      25811.0154 31259.5269  21.1%  1096  221s
  3247  1944     cutoff   18      25811.0154 31259.5269  21.1%  1083  229s
  3405  1989 26085.9190   20  265 25811.0154 31187.5109  20.8%  1090  236s
  3583  2036 28493.6380   20  287 25811.0154 31033.4099  20.2%  1094  241s
  3760  2102 26813.4993   21  252 25811.0154 31028.2581  20.2%  1094  246s
  3926  2165 26726.9092   22  279 25811.0154 30985.7276  20.0%  1092  252s
  4105  2234     cutoff   23      25811.0154 30985.7276  20.0%  1100  258s
  4343  2270     cutoff    9      25811.0154 30829.5461  19.4%  1097  264s
  4576  2322 26585.3440    9  451 25811.0154 30780.5266  19.3%  1098  271s
  4778  2387 25846.9704   13  202 25811.0154 30767.5234  19.2%  1101  277s
  5051  2501 infeasible   11      25811.0154 30672.5958  18.8%  1093  285s
  5286  2582 28020.6853   13  275 25811.0154 30529.7044  18.3%  1082  291s
  5530  2583 27253.2243   25  415 25811.0154 30487.2650  18.1%  1080  305s
  5532  2584 26206.2283   30  174 25811.0154 30487.2650  18.1%  1080  314s
  5533  2585 27486.8662   43  399 25811.0154 30487.2650  18.1%  1080  323s
  5534  2586 26553.9057   33  380 25811.0154 30487.2650  18.1%  1080  326s
  5535  2586 28754.2545   22  417 25811.0154 30487.2650  18.1%  1079  331s
  5536  2587 27239.1973   53  485 25811.0154 30487.2650  18.1%  1079  335s
  5540  2590 30368.3421   12  444 25811.0154 30487.2650  18.1%  1078  340s
  5542  2591 26943.4807   18  471 25811.0154 30487.2650  18.1%  1078  345s
  5545  2593 27685.6721   21  528 25811.0154 30487.2650  18.1%  1077  350s
  5548  2595 30426.6134    6  472 25811.0154 30487.2650  18.1%  1077  355s
  5550  2596 26917.8629   16  467 25811.0154 30487.2650  18.1%  1076  360s
  5553  2598 27831.2976   17  477 25811.0154 30487.2650  18.1%  1076  366s
  5555  2600 28699.8404   23  538 25811.0154 30487.2650  18.1%  1075  377s
  5556  2600 27964.5271   38  538 25811.0154 30487.2650  18.1%  1075  384s
  5557  2604 30487.2650   14  507 25811.0154 30487.2650  18.1%  1093  397s
  5559  2607 30487.2650   15  499 25811.0154 30487.2650  18.1%  1094  400s
  5563  2614 30487.2650   16  498 25811.0154 30487.2650  18.1%  1096  409s
  5571  2627 30487.2650   17  547 25811.0154 30487.2650  18.1%  1098  414s
  5587  2654 30487.2650   18  565 25811.0154 30487.2650  18.1%  1111  422s
  5619  2668 30487.2650   19  604 25811.0154 30487.2650  18.1%  1120  428s
  5651  2687 30487.2650   20  544 25811.0154 30487.2650  18.1%  1135  433s
  5691  2699 30487.2650   21  535 25811.0154 30487.2650  18.1%  1146  438s
  5755  2696 30487.2650   21  585 25811.0154 30487.2650  18.1%  1154  443s
  5823  2702 30487.2650   22  555 25811.0154 30487.2650  18.1%  1158  448s
  5871  2723 30327.1936   22  352 25811.0154 30487.2650  18.1%  1174  453s
  5931  2712 29225.1976   23  346 25811.0154 30487.2650  18.1%  1180  458s
  6004  2713 29077.2474   23  193 25811.0154 30487.2650  18.1%  1181  465s
  6122  2705     cutoff   25      25811.0154 30487.2650  18.1%  1197  474s
  6192  2697     cutoff   26      25811.0154 30487.2650  18.1%  1200  480s
  6258  2690 26233.8268   27  199 25811.0154 30487.2650  18.1%  1205  488s
  6334  2681     cutoff   27      25811.0154 30487.2650  18.1%  1208  494s
  6399  2658 27872.9289   25  448 25811.0154 30487.2650  18.1%  1217  499s
  6451  2666 27863.5551   26  511 25811.0154 30487.2650  18.1%  1223  506s
H 6550  2518                    25930.759240 30487.2650  17.6%  1227  509s
  6556  2526 27428.0257   28  486 25930.7592 30487.2650  17.6%  1226  515s
  6628  2501 27325.4202   29  447 25930.7592 30487.2650  17.6%  1225  520s
  6690  2479 26849.1894   30  450 25930.7592 30487.2650  17.6%  1226  527s
  6775  2457 26778.2002   31  445 25930.7592 30487.2650  17.6%  1230  532s
  6862  2471     cutoff   33      25930.7592 30487.2650  17.6%  1233  539s
  6947  2468     cutoff   33      25930.7592 30487.2650  17.6%  1234  546s
  7067  2464 27555.8828   24  446 25930.7592 30487.2650  17.6%  1235  551s
  7204  2419 27080.2869   27  273 25930.7592 29882.9353  15.2%  1231  558s
  7329  2388 26339.2157   30  249 25930.7592 29296.1112  13.0%  1236  566s
  7463  2351     cutoff   34      25930.7592 29272.1835  12.9%  1238  573s
  7537  2333 26752.3203   26  318 25930.7592 28959.9048  11.7%  1243  579s
  7695  2292 26248.0705   28  384 25930.7592 28875.4837  11.4%  1242  587s
  7851  2226 27509.7579   30  355 25930.7592 28843.2493  11.2%  1242  594s
  8026  2163 26188.1611   33  230 25930.7592 28737.2929  10.8%  1239  602s
  8197  2083     cutoff   34      25930.7592 28242.8273  8.92%  1237  608s
  8354  2006     cutoff   32      25930.7592 28162.7401  8.61%  1237  615s
  8528  1891     cutoff   26      25930.7592 27983.0480  7.91%  1237  623s
  8741  1722 26205.2340   29  304 25930.7592 27906.5095  7.62%  1234  630s
  8982  1498 26180.9649   27  324 25930.7592 27519.2131  6.13%  1229  636s
  9256  1245 26901.5940   31  325 25930.7592 27221.9032  4.98%  1219  641s

Cutting planes:
  Learned: 2
  Gomory: 3
  MIR: 348
  Flow cover: 977
  RLT: 14
  Relax-and-lift: 118

Explored 9474 nodes (11479765 simplex iterations) in 642.05 seconds (1817.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25930.8 25811 25791.9 ... 25748.4

Optimal solution found (tolerance 1.00e-04)
Best objective 2.593075923984e+04, best bound 2.593075923984e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 642.06s
  Master Objective (UB) = 25930.76, θ = 152699.16
  Upper Bound (UB) = 25930.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152699.16
  [DEBUG]   ✓ Scenario 0: θ = 152699.16 ≤ Q = 152699.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152699.16 ≤ Q = 152699.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152699.16 ≤ Q = 152699.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152699.16 ≤ Q = 152699.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x30749994
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcf8b666c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.462017e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7716652.1213
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.412248e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141224.80    0  130 7716652.12 -141224.80   102%     -    0s
H    0     0                    -106012.0483 -141224.80  33.2%     -    0s
H    0     0                    -106261.2469 -141224.80  32.9%     -    0s
H    0     0                    -112084.4718 -141224.80  26.0%     -    0s
H    0     0                    -112166.4480 -124999.75  11.4%     -    0s
     0     0 -124999.75    0  127 -112166.45 -124999.75  11.4%     -    0s
H    0     0                    -119634.1555 -124912.45  4.41%     -    0s
     0     0 -124455.85    0  128 -119634.16 -124455.85  4.03%     -    0s
     0     0 -123787.86    0  130 -119634.16 -123787.86  3.47%     -    0s
     0     0 -123638.98    0  130 -119634.16 -123638.98  3.35%     -    0s
     0     0 -123638.98    0  130 -119634.16 -123638.98  3.35%     -    0s
H    0     0                    -120594.9410 -123638.98  2.52%     -    0s
H    0     0                    -120888.8790 -123638.98  2.27%     -    0s
     0     0 -123428.09    0  133 -120888.88 -123428.09  2.10%     -    0s
     0     0 -123391.11    0  132 -120888.88 -123391.11  2.07%     -    0s
     0     0 -123390.24    0  132 -120888.88 -123390.24  2.07%     -    0s
     0     0 -122745.47    0  127 -120888.88 -122745.47  1.54%     -    0s
     0     0 -122730.08    0  127 -120888.88 -122730.08  1.52%     -    0s
     0     0 -122184.08    0  115 -120888.88 -122184.08  1.07%     -    0s
     0     0 -122143.53    0  123 -120888.88 -122143.53  1.04%     -    0s
     0     0 -122143.09    0  123 -120888.88 -122143.09  1.04%     -    0s
     0     0 -121897.84    0  104 -120888.88 -121897.84  0.83%     -    0s
     0     0 -121796.38    0  110 -120888.88 -121796.38  0.75%     -    0s
     0     0 -121796.25    0  110 -120888.88 -121796.25  0.75%     -    0s
     0     0 -121692.61    0   96 -120888.88 -121692.61  0.66%     -    0s
     0     0 -121684.87    0   97 -120888.88 -121684.87  0.66%     -    0s
     0     0 -121629.18    0   97 -120888.88 -121629.18  0.61%     -    0s
     0     0 -121604.18    0   97 -120888.88 -121604.18  0.59%     -    0s
     0     2 -121604.14    0   97 -120888.88 -121604.14  0.59%     -    0s
H  457   301                    -120894.7389 -121342.36  0.37%   6.4    0s

Cutting planes:
  Gomory: 31
  Implied bound: 10
  MIR: 247
  Flow cover: 10
  RLT: 50
  BQP: 3

Explored 7593 nodes (33651 simplex iterations) in 0.26 seconds (0.31 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -120895 -120889 -119634 ... 1.46202e+13
No other solutions better than -120895

Optimal solution found (tolerance 1.00e-04)
Best objective -1.208947389497e+05, best bound -1.208947389497e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 139533.70
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120894.74
  [DEBUG]   S×d_nominal = 260428.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260428.44 + -120894.74 = 139533.70
  [DEBUG]   Current θ from Master = 152699.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13165.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12765.30
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 7404.7218, Absolute Gap = 7404.7218, Relative Gap = 0.285557
  Not converged yet (gap = 7404.72 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221749 nonzeros
Model fingerprint: 0x00ef3546
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 32845 rows and 13335 columns
Presolve time: 0.69s
Presolved: 44988 rows, 20125 columns, 278884 nonzeros
Variable types: 17866 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 44988 rows, 20125 columns, 278884 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32469    2.9233238e+04   0.000000e+00   1.031550e+07      5s
   44718    3.8042084e+04   0.000000e+00   1.483582e+08     10s
Concurrent spin time: 0.55s

Solved with dual simplex

Root relaxation: objective 4.598770e+04, 34189 iterations, 11.24 seconds (23.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45987.7034    0  165 -194556.81 45987.7034   124%     -   12s
H    0     0                    -176098.9492 45987.7034   126%     -   12s
H    0     0                    -91906.04070 45987.7034   150%     -   12s
H    0     0                    -83677.62480 45987.7034   155%     -   12s
H    0     0                    -83530.99165 45987.7034   155%     -   12s
H    0     0                    -41335.05675 45987.7034   211%     -   12s
H    0     0                    -41125.90653 45987.7034   212%     -   12s
H    0     0                     379.7677371 45987.7034      -     -   12s
H    0     0                    4325.3078429 45987.7034   963%     -   12s
H    0     0                    4338.5992306 45987.7034   960%     -   12s
H    0     0                    5780.6269133 45987.7034   696%     -   13s
H    0     0                    6149.7108391 45987.7034   648%     -   13s
H    0     0                    7149.9312184 45987.7034   543%     -   13s
     0     0 41419.3078    0  235 7149.93122 41419.3078   479%     -   16s
     0     0 41097.8448    0  236 7149.93122 41097.8448   475%     -   18s
     0     0 41097.8448    0  208 7149.93122 41097.8448   475%     -   19s
     0     0 41097.8448    0  210 7149.93122 41097.8448   475%     -   19s
     0     0 41097.8448    0  210 7149.93122 41097.8448   475%     -   19s
     0     0 38678.1199    0  288 7149.93122 38678.1199   441%     -   24s
H    0     0                    11935.590490 38673.8545   224%     -   24s
     0     0 38283.3876    0  332 11935.5905 38283.3876   221%     -   27s
     0     0 38117.9966    0  299 11935.5905 38117.9966   219%     -   29s
     0     0 38049.5719    0  344 11935.5905 38049.5719   219%     -   30s
     0     0 37979.4344    0  347 11935.5905 37979.4344   218%     -   31s
     0     0 37973.0780    0  356 11935.5905 37973.0780   218%     -   31s
     0     0 37969.9699    0  360 11935.5905 37969.9699   218%     -   32s
     0     0 37967.0619    0  355 11935.5905 37967.0619   218%     -   32s
     0     0 37966.7198    0  355 11935.5905 37966.7198   218%     -   32s
     0     0 36084.9573    0  403 11935.5905 36084.9573   202%     -   39s
     0     0 35493.3869    0  427 11935.5905 35493.3869   197%     -   43s
     0     0 35105.8903    0  475 11935.5905 35105.8903   194%     -   45s
     0     0 34954.8095    0  487 11935.5905 34954.8095   193%     -   47s
     0     0 34898.4812    0  435 11935.5905 34898.4812   192%     -   48s
     0     0 34872.1050    0  438 11935.5905 34872.1050   192%     -   49s
     0     0 34863.3638    0  487 11935.5905 34863.3638   192%     -   49s
     0     0 34856.3919    0  490 11935.5905 34856.3919   192%     -   49s
     0     0 34848.3643    0  485 11935.5905 34848.3643   192%     -   50s
     0     0 34840.1024    0  489 11935.5905 34840.1024   192%     -   50s
     0     0 34839.1132    0  487 11935.5905 34839.1132   192%     -   50s
H    0     0                    12367.219431 34839.1132   182%     -   53s
H    0     0                    12550.203403 34839.1132   178%     -   53s
     0     0 34149.0023    0  412 12550.2034 34149.0023   172%     -   56s
     0     0 33714.1901    0  416 12550.2034 33714.1901   169%     -   59s
     0     0 33513.8750    0  471 12550.2034 33513.8750   167%     -   60s
     0     0 33474.8411    0  422 12550.2034 33474.8411   167%     -   61s
     0     0 33452.0822    0  360 12550.2034 33452.0822   167%     -   61s
     0     0 33433.2228    0  365 12550.2034 33433.2228   166%     -   62s
     0     0 33428.3171    0  365 12550.2034 33428.3171   166%     -   62s
     0     0 33424.1144    0  372 12550.2034 33424.1144   166%     -   62s
     0     0 33422.9829    0  372 12550.2034 33422.9829   166%     -   63s
     0     0 33241.0841    0  438 12550.2034 33241.0841   165%     -   65s
H    0     0                    12822.791111 33240.0842   159%     -   65s
     0     0 33201.7485    0  445 12822.7911 33201.7485   159%     -   66s
     0     0 33178.8514    0  447 12822.7911 33178.8514   159%     -   67s
     0     0 33143.8745    0  493 12822.7911 33143.8745   158%     -   68s
     0     0 33103.2685    0  493 12822.7911 33103.2685   158%     -   68s
H    0     0                    13278.049059 33074.8025   149%     -   69s
H    0     0                    13552.665361 33074.8025   144%     -   69s
H    0     0                    13570.374087 33074.8025   144%     -   69s
H    0     0                    13583.191074 33074.8025   143%     -   69s
H    0     0                    13669.356133 33074.8025   142%     -   69s
H    0     0                    13985.031218 33074.8025   137%     -   69s
H    0     0                    13987.598399 33074.8025   136%     -   69s
H    0     0                    14000.566599 33074.8025   136%     -   69s
H    0     0                    14705.203888 33074.8025   125%     -   69s
H    0     0                    14911.535834 33074.8025   122%     -   69s
H    0     0                    15451.167305 33074.8025   114%     -   69s
H    0     0                    15471.849982 33074.8025   114%     -   69s
     0     0 33074.8025    0  450 15471.8500 33074.8025   114%     -   69s
H    0     0                    15489.328814 33056.1885   113%     -   69s
H    0     0                    15511.203377 33056.1885   113%     -   69s
H    0     0                    15545.675846 33056.1885   113%     -   69s
     0     0 33056.1885    0  509 15545.6758 33056.1885   113%     -   69s
     0     0 33050.2627    0  510 15545.6758 33050.2627   113%     -   70s
     0     0 33048.9045    0  514 15545.6758 33048.9045   113%     -   70s
     0     0 32951.1485    0  460 15545.6758 32951.1485   112%     -   71s
H    0     0                    15659.813607 32949.5074   110%     -   72s
H    0     0                    16105.854347 32949.5074   105%     -   72s
     0     0 32924.3271    0  473 16105.8543 32924.3271   104%     -   73s
     0     0 32910.0644    0  469 16105.8543 32910.0644   104%     -   73s
     0     0 32897.7337    0  462 16105.8543 32897.7337   104%     -   73s
     0     0 32894.5716    0  465 16105.8543 32894.5716   104%     -   73s
     0     0 32892.6558    0  464 16105.8543 32892.6558   104%     -   74s
     0     0 32891.6695    0  467 16105.8543 32891.6695   104%     -   74s
H    0     0                    16705.941438 32865.5999  96.7%     -   75s
H    0     0                    16731.133408 32865.5999  96.4%     -   75s
     0     0 32865.5999    0  474 16731.1334 32865.5999  96.4%     -   75s
H    0     0                    17724.738291 32865.4760  85.4%     -   75s
H    0     0                    17772.074829 32865.4760  84.9%     -   75s
     0     0 32856.3367    0  467 17772.0748 32856.3367  84.9%     -   76s
     0     0 32844.7624    0  471 17772.0748 32844.7624  84.8%     -   76s
     0     0 32841.1936    0  481 17772.0748 32841.1936  84.8%     -   76s
     0     0 32839.1491    0  480 17772.0748 32839.1491  84.8%     -   76s
     0     0 32838.8483    0  479 17772.0748 32838.8483  84.8%     -   76s
     0     0 32819.5569    0  474 17772.0748 32819.5569  84.7%     -   77s
H    0     0                    19627.762716 32817.5448  67.2%     -   78s
H    0     0                    19726.751841 32817.5448  66.4%     -   78s
H    0     0                    19824.405745 32817.5448  65.5%     -   78s
H    0     0                    19865.402553 32817.5448  65.2%     -   78s
     0     0 32817.2782    0  479 19865.4026 32817.2782  65.2%     -   78s
     0     0 32815.0998    0  473 19865.4026 32815.0998  65.2%     -   78s
     0     0 32814.5481    0  477 19865.4026 32814.5481  65.2%     -   78s
     0     0 32790.0152    0  460 19865.4026 32790.0152  65.1%     -   79s
     0     0 32786.2523    0  462 19865.4026 32786.2523  65.0%     -   80s
     0     0 32782.3657    0  478 19865.4026 32782.3657  65.0%     -   80s
     0     0 32781.1542    0  525 19865.4026 32781.1542  65.0%     -   81s
     0     0 32771.4807    0  470 19865.4026 32771.4807  65.0%     -   81s
     0     0 32768.6533    0  474 19865.4026 32768.6533  65.0%     -   82s
     0     0 32767.4430    0  475 19865.4026 32767.4430  64.9%     -   83s
     0     0 32759.2413    0  473 19865.4026 32759.2413  64.9%     -   84s
     0     0 32757.3325    0  468 19865.4026 32757.3325  64.9%     -   84s
     0     0 32755.4779    0  470 19865.4026 32755.4779  64.9%     -   85s
     0     0 32753.0027    0  469 19865.4026 32753.0027  64.9%     -   85s
     0     0 32752.2308    0  474 19865.4026 32752.2308  64.9%     -   85s
     0     0 32738.6920    0  464 19865.4026 32738.6920  64.8%     -   86s
H    0     0                    19891.044744 32738.4335  64.6%     -   86s
H    0     0                    19921.566852 32738.4335  64.3%     -   86s
H    0     0                    19932.440088 32738.4335  64.2%     -   86s
H    0     0                    19938.239743 32738.4335  64.2%     -   86s
H    0     0                    20027.304862 32738.4335  63.5%     -   86s
     0     0 32733.4422    0  474 20027.3049 32733.4422  63.4%     -   87s
     0     0 32732.6497    0  480 20027.3049 32732.6497  63.4%     -   87s
     0     0 32723.4876    0  469 20027.3049 32723.4876  63.4%     -   88s
     0     0 32719.4692    0  467 20027.3049 32719.4692  63.4%     -   88s
     0     0 32718.8796    0  475 20027.3049 32718.8796  63.4%     -   88s
     0     0 32712.1279    0  475 20027.3049 32712.1279  63.3%     -   89s
H    0     0                    20067.577036 32711.4945  63.0%     -   90s
H    0     0                    20078.051713 32711.4945  62.9%     -   90s
H    0     0                    20111.371659 32711.4945  62.7%     -   90s
H    0     0                    20119.146324 32711.4945  62.6%     -   90s
     0     0 32707.1622    0  471 20119.1463 32707.1622  62.6%     -   91s
     0     0 32705.2260    0  474 20119.1463 32705.2260  62.6%     -   91s
     0     0 32704.2026    0  475 20119.1463 32704.2026  62.6%     -   91s
     0     0 32703.3374    0  472 20119.1463 32703.3374  62.5%     -   92s
     0     0 32702.7640    0  472 20119.1463 32702.7640  62.5%     -   92s
H    0     0                    20587.938431 32702.7640  58.8%     -  104s
     0     2 32702.7640    0  472 20587.9384 32702.7640  58.8%     -  105s
     3     8 32115.8848    2  462 20587.9384 32533.9604  58.0%  5114  114s
     7    16 31974.9248    3  458 20587.9384 32114.0878  56.0%  4774  119s
    15    32 31874.8092    4  454 20587.9384 31974.8078  55.3%  5601  123s
    31    48 29642.5761    5  383 20587.9384 31874.0909  54.8%  6856  133s
H   47    80                    20723.671683 31874.0909  53.8%  7852  138s
H   52    80                    20837.388687 31874.0909  53.0%  7610  138s
H   77    80                    20850.216218 31874.0909  52.9%  5850  138s
    79   147 29355.1679    7  458 20850.2162 31874.0909  52.9%  5852  149s
   146   256 28937.2980    9  470 20850.2162 31874.0909  52.9%  5064  157s
   255   327 27141.9181   10  440 20850.2162 31874.0909  52.9%  4021  162s
   344   357 28528.8212   10  456 20850.2162 31874.0909  52.9%  3521  168s
   436   383 28283.2752    9  469 20850.2162 31874.0909  52.9%  3182  175s
   517   401 28250.8191    9  457 20850.2162 31874.0909  52.9%  2985  183s
   561   432 27544.7505    9  406 20850.2162 31874.0909  52.9%  2929  190s
   626   459 27079.1694   11  467 20850.2162 31874.0909  52.9%  2793  197s
   663   502 28107.8910   11  456 20850.2162 31874.0909  52.9%  2782  204s
   722   538 26544.7140   11  427 20850.2162 31874.0909  52.9%  2692  211s
H  727   538                    20895.727710 31874.0909  52.5%  2681  211s
   790   579 25855.6432   11  443 20895.7277 31874.0909  52.5%  2614  217s
   880   644 27910.2351   12  432 20895.7277 31874.0909  52.5%  2522  222s
   979   727 26523.5954   13  370 20895.7277 31874.0909  52.5%  2415  227s
  1093   791 26574.9617   14  398 20895.7277 31874.0909  52.5%  2298  232s
  1201   833 23616.0541   14  315 20895.7277 31524.8500  50.9%  2215  237s
  1297   888 23413.1239   15  406 20895.7277 31524.8500  50.9%  2182  243s
  1384   938 25931.3305   16  323 20895.7277 31524.8500  50.9%  2170  248s
  1442  1023 25712.8404   17  323 20895.7277 31524.8500  50.9%  2140  255s
H 1456  1023                    20911.869022 31524.8500  50.8%  2133  255s
  1558  1084 25774.2489   17  335 20911.8690 31524.8500  50.8%  2054  263s
  1697  1174 25207.6679   20  325 20911.8690 31524.8500  50.8%  1998  269s
  1827  1260     cutoff   20      20911.8690 31524.8500  50.8%  1969  276s
  1999  1324     cutoff   21      20911.8690 31524.8500  50.8%  1896  282s
  2154  1420 22185.2298   21  230 20911.8690 30066.5437  43.8%  1859  290s
  2298  1495     cutoff   21      20911.8690 30033.0134  43.6%  1834  297s
  2436  1508     cutoff   24      20911.8690 29936.6002  43.2%  1820  302s
H 2442  1508                    20915.127167 29936.6002  43.1%  1819  302s
H 2445  1508                    20924.120874 29936.6002  43.1%  1820  302s
H 2464  1508                    20930.383436 29936.6002  43.0%  1820  302s
H 2483  1508                    20932.041664 29936.6002  43.0%  1823  302s
  2484  1595 27602.1695    9  284 20932.0417 29936.6002  43.0%  1823  310s
  2630  1708 26120.7400   13  206 20932.0417 29936.6002  43.0%  1814  318s
  2829  1826 21451.2051   16  144 20932.0417 29936.6002  43.0%  1774  327s
  3025  1904 26313.6056    8  322 20932.0417 29936.6002  43.0%  1740  334s
  3204  1927 25782.2000   11  298 20932.0417 29936.6002  43.0%  1729  340s
  3245  1991 24528.7663   10  185 20932.0417 29665.8260  41.7%  1738  348s
H 3264  1990                    20938.090805 29665.8260  41.7%  1746  348s
  3333  2067 23830.0529   11  182 20938.0908 29665.8260  41.7%  1736  358s
  3532  2142 22743.2903   17  169 20938.0908 29665.8260  41.7%  1731  365s
  3686  2238 21936.3703   26  132 20938.0908 29255.3837  39.7%  1722  372s
  3920  2363     cutoff   37      20938.0908 29255.3837  39.7%  1688  381s
  4172  2477 26098.9711   12  245 20938.0908 28793.5929  37.5%  1660  391s
  4438  2610 24570.4991   17  217 20938.0908 28661.1239  36.9%  1644  400s
  4689  2611 24553.5767   19  472 20938.0908 28565.7171  36.4%  1633  423s
  4691  2612 25086.2954   12  165 20938.0908 28565.7171  36.4%  1632  438s
  4692  2613 27311.5026   12  342 20938.0908 28565.7171  36.4%  1632  448s
  4693  2614 27093.9672    9  404 20938.0908 28565.7171  36.4%  1631  454s
  4694  2614 27560.1638   10  507 20938.0908 28565.7171  36.4%  1631  460s
  4696  2616 22315.1983   40  437 20938.0908 28565.7171  36.4%  1630  465s
  4699  2618 21449.2768   32  459 20938.0908 28565.7171  36.4%  1629  470s
  4703  2620 26469.8719   15  405 20938.0908 28565.7171  36.4%  1628  477s
  4706  2622 25845.8627   13  525 20938.0908 28565.7171  36.4%  1627  480s
  4708  2624 22312.4780   36  529 20938.0908 28565.7171  36.4%  1626  485s
  4710  2625 22848.2896   30  571 20938.0908 28565.7171  36.4%  1625  490s
  4713  2627 25310.7682    9  524 20938.0908 28565.7171  36.4%  1624  495s
  4716  2629 25420.4839   15  475 20938.0908 28565.7171  36.4%  1623  501s
  4717  2630 23210.3897   16  475 20938.0908 28565.7171  36.4%  1623  517s
  4718  2630 27633.8495    8  475 20938.0908 28565.7171  36.4%  1623  526s
  4719  2634 28565.7171   11  510 20938.0908 28565.7171  36.4%  1652  533s
  4721  2637 28565.7171   12  466 20938.0908 28565.7171  36.4%  1653  537s
  4725  2644 28565.7171   13  499 20938.0908 28565.7171  36.4%  1657  543s
  4733  2657 28565.7171   14  512 20938.0908 28565.7171  36.4%  1662  551s
  4749  2671 27166.2957   15  289 20938.0908 28565.7171  36.4%  1690  568s
  4768  2697 27193.7344   16  314 20938.0908 28565.7171  36.4%  1715  576s
  4800  2808 26665.0335   17  312 20938.0908 28565.7171  36.4%  1736  585s
  4922  2796 25024.2493   20  274 20938.0908 28565.7171  36.4%  1761  590s
  4956  2816 24537.4305   21  274 20938.0908 28565.7171  36.4%  1770  596s
  5010  2822 25015.7497   19  353 20938.0908 28565.7171  36.4%  1781  604s
  5056  2854 23581.7572   22  246 20938.0908 28565.7171  36.4%  1785  610s
  5129  2878 23226.5160   24  245 20938.0908 28565.7171  36.4%  1787  620s
  5213  2879 22349.8189   25  212 20938.0908 28565.7171  36.4%  1785  628s
  5293  2886 21564.9067   28  145 20938.0908 28565.7171  36.4%  1786  635s
  5384  2880 21430.9336   31  136 20938.0908 28565.7171  36.4%  1779  642s
  5465  2875 28290.7749   16  486 20938.0908 28565.7171  36.4%  1780  649s
  5540  2871 27793.5452   17  457 20938.0908 28565.7171  36.4%  1781  661s
  5611  2871 27527.4762   18  396 20938.0908 28565.7171  36.4%  1786  667s
  5686  2865 26862.2348   19  362 20938.0908 28565.7171  36.4%  1788  674s
  5722  2873 24501.0479   20  358 20938.0908 28565.7171  36.4%  1794  681s
  5757  2902 23736.1969   21  322 20938.0908 28565.7171  36.4%  1796  687s
  5828  2906 23575.0548   22  320 20938.0908 28565.7171  36.4%  1797  694s
  5902  2917 23192.5038   24  359 20938.0908 28565.7171  36.4%  1798  706s
  5987  2914 22234.1382   28  421 20938.0908 28565.7171  36.4%  1803  713s
  6045  2933 21688.5991   30  410 20938.0908 28148.5794  34.4%  1812  720s
  6144  2934 21186.3588   33  290 20938.0908 28148.5794  34.4%  1814  727s
  6233  2953     cutoff   35      20938.0908 28148.5794  34.4%  1817  734s
  6344  2942 22617.0569   19  362 20938.0908 28118.6144  34.3%  1815  742s
  6444  2951 23102.3958   20  313 20938.0908 27963.1705  33.6%  1817  749s
  6550  2962 24279.5467   21  278 20938.0908 27762.9122  32.6%  1820  756s
  6655  2962 22832.2436   22  189 20938.0908 27762.9122  32.6%  1828  764s
  6774  2964 22404.0782   24  216 20938.0908 27762.9122  32.6%  1835  771s
H 6799  2824                    21053.846367 27762.9122  31.9%  1832  771s
  6857  2837     cutoff   24      21053.8464 27762.9122  31.9%  1833  779s
  6987  2825 22387.3978   22  293 21053.8464 27381.8500  30.1%  1838  789s
H 6992  2697                    21074.710242 27381.8500  29.9%  1837  789s
H 7011  2572                    21246.398876 27381.8500  28.9%  1834  789s
  7165  2587 24043.9069   24  259 21246.3989 27184.2234  27.9%  1828  797s
  7322  2571 23447.6477   27  316 21246.3989 27184.2234  27.9%  1826  807s
H 7332  2455                    21446.230539 27184.2234  26.8%  1824  807s
H 7365  2336                    21451.430406 27029.2222  26.0%  1827  807s
  7506  2327     cutoff   34      21451.4304 26947.3262  25.6%  1820  818s
  7673  2302     cutoff   24      21451.4304 26891.8825  25.4%  1823  828s
  7841  2295 23269.4381   26  222 21451.4304 26647.7986  24.2%  1821  837s
  8014  2268 21934.5046   29  244 21451.4304 26602.0118  24.0%  1820  847s
  8209  2218 21966.2429   28  213 21451.4304 26447.0642  23.3%  1813  858s
  8434  2180 25052.4807   19  452 21451.4304 26447.0642  23.3%  1807  868s
  8639  2156 24344.2511   22  347 21451.4304 26131.1970  21.8%  1806  877s
  8878  2170 23648.8613   25  209 21451.4304 25871.6679  20.6%  1799  889s
  9095  2150 22077.7669   19  415 21451.4304 25682.9545  19.7%  1800  899s
  9349  2158 23759.0069   19  254 21451.4304 25647.8390  19.6%  1793  910s
  9638  2106     cutoff   25      21451.4304 25387.9544  18.4%  1787  923s
  9963  1981 23248.0278   25  423 21451.4304 25275.4394  17.8%  1780  937s
 10246  1898 22175.0322   25  240 21451.4304 25122.7352  17.1%  1782  951s
 10561  1831 23890.4738   23  425 21451.4304 25122.7352  17.1%  1777  963s
 10918  1799 22082.8381   28  368 21451.4304 24958.7855  16.4%  1771  976s
 11290  1799     cutoff   39      21451.4304 24693.3088  15.1%  1763  988s
 11696  1812 22966.4745   27  444 21451.4304 24511.5094  14.3%  1756 1003s
 12069  1868 infeasible   29      21451.4304 24267.5399  13.1%  1751 1017s
 12475  1842 21945.6876   30  196 21451.4304 24092.2502  12.3%  1738 1033s
 12798  1807 22848.1518   24  202 21451.4304 23975.7435  11.8%  1730 1050s
 13293  1776     cutoff   28      21451.4304 23769.9680  10.8%  1714 1065s
 13989  1681 21649.8763   21  211 21451.4304 23461.3919  9.37%  1683 1081s
 14676  1529 22008.4298   32  373 21451.4304 23224.6596  8.27%  1658 1097s
 15586  1171     cutoff   26      21451.4304 23047.7494  7.44%  1611 1114s
 16763   376 21818.1966   32  485 21451.4304 22727.5149  5.95%  1547 1128s
 18137     0 21807.8417   31  379 21451.4304 22334.7381  4.12%  1467 1136s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 448
  Mixing: 2
  Flow cover: 1298
  RLT: 15
  Relax-and-lift: 145

Explored 18696 nodes (26974516 simplex iterations) in 1137.02 seconds (3575.36 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21451.4 21446.2 21246.4 ... 20915.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.145143040603e+04, best bound 2.145143040603e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1137.03s
  Master Objective (UB) = 21451.43, θ = 151547.75
  Upper Bound (UB) = 21451.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151547.75
  [DEBUG]   ✓ Scenario 0: θ = 151547.75 ≤ Q = 151547.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151547.75 ≤ Q = 151547.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151547.75 ≤ Q = 151547.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151547.75 ≤ Q = 151547.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151547.75 ≤ Q = 151547.75 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x64848825
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x64848825
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.549478e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8242550.8241
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.424715e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142471.48    0  136 8242550.82 -142471.48   102%     -    0s
H    0     0                    -104245.0579 -142471.48  36.7%     -    0s
H    0     0                    -104977.4313 -142471.48  35.7%     -    0s
H    0     0                    -106585.3221 -121683.04  14.2%     -    0s
H    0     0                    -115246.1422 -121683.04  5.59%     -    0s
     0     0 -121683.04    0   44 -115246.14 -121683.04  5.59%     -    0s
H    0     0                    -120573.0439 -121601.82  0.85%     -    0s
H    0     0                    -120997.7658 -121601.82  0.50%     -    0s
     0     0 -121473.54    0   42 -120997.77 -121473.54  0.39%     -    0s
     0     0 -121472.87    0   42 -120997.77 -121472.87  0.39%     -    0s
     0     0 -121099.05    0   14 -120997.77 -121099.05  0.08%     -    0s
     0     0 -121099.05    0   14 -120997.77 -121099.05  0.08%     -    0s
H    0     0                    -121026.3000 -121099.05  0.06%     -    0s
     0     0 -121049.58    0    6 -121026.30 -121049.58  0.02%     -    0s
     0     0 -121041.00    0    5 -121026.30 -121041.00  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 5
  Flow cover: 4

Explored 1 nodes (557 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121026 -120998 -120724 ... 1.54948e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.210262999658e+05, best bound -1.210334681845e+05, gap 0.0059%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 139705.61
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121026.30
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -121026.30 = 139705.61
  [DEBUG]   Current θ from Master = 151547.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11842.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9609.29
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 2925.3929, Absolute Gap = 2925.3929, Relative Gap = 0.136373
  Not converged yet (gap = 2925.39 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264995 nonzeros
Model fingerprint: 0x7e1a224d
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 39430 rows and 16010 columns
Presolve time: 0.84s
Presolved: 53693 rows, 23690 columns, 333509 nonzeros
Variable types: 21431 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53693 rows, 23690 columns, 333509 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28940   -1.5551830e+04   0.000000e+00   1.022655e+08      5s
   41710    1.6553759e+04   0.000000e+00   5.343845e+06     10s
Concurrent spin time: 0.69s

Solved with dual simplex

Root relaxation: objective 4.598770e+04, 37113 iterations, 13.87 seconds (30.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45987.7034    0  165 -194556.81 45987.7034   124%     -   15s
H    0     0                    -182159.7807 45987.7034   125%     -   15s
H    0     0                    -107809.3657 45987.7034   143%     -   15s
H    0     0                    -76752.11116 45987.7034   160%     -   15s
H    0     0                    -76548.75870 45987.7034   160%     -   15s
H    0     0                    -44339.40925 45987.7034   204%     -   15s
H    0     0                    -44130.25903 45987.7034   204%     -   15s
H    0     0                     379.7677371 45987.7034      -     -   15s
H    0     0                    3807.8750173 45987.7034  1108%     -   15s
H    0     0                    4305.6552594 45987.7034   968%     -   15s
H    0     0                    4325.3078429 45987.7034   963%     -   15s
H    0     0                    5665.6193276 45987.7034   712%     -   16s
H    0     0                    7149.9312184 45987.7034   543%     -   16s
     0     0 41543.9455    0  254 7149.93122 41543.9455   481%     -   20s
H    0     0                    8044.1605985 41543.6843   416%     -   21s
H    0     0                    9427.6001390 41543.6843   341%     -   21s
H    0     0                    9961.6656188 41543.6843   317%     -   21s
H    0     0                    11840.379783 41543.6843   251%     -   21s
H    0     0                    11935.590490 41543.6843   248%     -   21s
H    0     0                    11949.186066 41543.6843   248%     -   21s
     0     0 41104.2032    0  292 11949.1861 41104.2032   244%     -   22s
     0     0 41104.2032    0  260 11949.1861 41104.2032   244%     -   23s
     0     0 41104.2032    0  261 11949.1861 41104.2032   244%     -   24s
     0     0 41104.2032    0  261 11949.1861 41104.2032   244%     -   24s
     0     0 41104.2032    0  261 11949.1861 41104.2032   244%     -   24s
     0     0 38222.3263    0  282 11949.1861 38222.3263   220%     -   31s
     0     0 37632.9832    0  348 11949.1861 37632.9832   215%     -   35s
     0     0 37537.4290    0  363 11949.1861 37537.4290   214%     -   36s
     0     0 37433.9996    0  350 11949.1861 37433.9996   213%     -   37s
     0     0 37370.1494    0  354 11949.1861 37370.1494   213%     -   38s
     0     0 37366.5828    0  352 11949.1861 37366.5828   213%     -   38s
     0     0 37363.1040    0  352 11949.1861 37363.1040   213%     -   38s
     0     0 37361.9726    0  355 11949.1861 37361.9726   213%     -   39s
     0     0 37353.7404    0  352 11949.1861 37353.7404   213%     -   39s
     0     0 37348.5206    0  359 11949.1861 37348.5206   213%     -   39s
     0     0 37348.2143    0  358 11949.1861 37348.2143   213%     -   39s
     0     0 36086.3175    0  376 11949.1861 36086.3175   202%     -   48s
     0     0 35450.5007    0  430 11949.1861 35450.5007   197%     -   53s
     0     0 35161.4269    0  429 11949.1861 35161.4269   194%     -   56s
     0     0 35041.2857    0  422 11949.1861 35041.2857   193%     -   59s
     0     0 34987.9056    0  482 11949.1861 34987.9056   193%     -   60s
     0     0 34912.3266    0  433 11949.1861 34912.3266   192%     -   62s
     0     0 34897.2748    0  448 11949.1861 34897.2748   192%     -   63s
     0     0 34880.1248    0  435 11949.1861 34880.1248   192%     -   63s
     0     0 34875.7336    0  439 11949.1861 34875.7336   192%     -   64s
     0     0 34874.8853    0  438 11949.1861 34874.8853   192%     -   64s
H    0     0                    11969.151118 33866.4246   183%     -   74s
H    0     0                    11969.467437 33866.4246   183%     -   74s
     0     0 33866.4246    0  435 11969.4674 33866.4246   183%     -   74s
H    0     0                    12098.991251 33866.3377   180%     -   74s
     0     0 33588.5498    0  482 12098.9913 33588.5498   178%     -   76s
     0     0 33440.3777    0  431 12098.9913 33440.3777   176%     -   78s
     0     0 33340.6355    0  447 12098.9913 33340.6355   176%     -   80s
     0     0 33302.4332    0  451 12098.9913 33302.4332   175%     -   81s
     0     0 33240.4689    0  452 12098.9913 33240.4689   175%     -   82s
     0     0 33220.6666    0  448 12098.9913 33220.6666   175%     -   83s
     0     0 33217.1570    0  451 12098.9913 33217.1570   175%     -   83s
H    0     0                    12147.916774 33214.9643   173%     -   84s
     0     0 33214.9643    0  452 12147.9168 33214.9643   173%     -   84s
     0     0 33214.3295    0  451 12147.9168 33214.3295   173%     -   84s
     0     0 33122.5417    0  464 12147.9168 33122.5417   173%     -   86s
H    0     0                    12464.802062 33121.7361   166%     -   86s
H    0     0                    12564.842722 33121.7361   164%     -   86s
     0     0 33089.3959    0  462 12564.8427 33089.3959   163%     -   87s
     0     0 33077.6418    0  456 12564.8427 33077.6418   163%     -   88s
     0     0 33071.3523    0  461 12564.8427 33071.3523   163%     -   88s
     0     0 33068.3077    0  465 12564.8427 33068.3077   163%     -   88s
     0     0 33067.3277    0  466 12564.8427 33067.3277   163%     -   89s
     0     0 33009.1963    0  468 12564.8427 33009.1963   163%     -   91s
H    0     0                    12654.623291 33009.0933   161%     -   92s
     0     0 32986.6136    0  477 12654.6233 32986.6136   161%     -   93s
     0     0 32982.6812    0  483 12654.6233 32982.6812   161%     -   94s
     0     0 32980.9113    0  482 12654.6233 32980.9113   161%     -   94s
     0     0 32977.9224    0  479 12654.6233 32977.9224   161%     -   94s
     0     0 32976.9410    0  480 12654.6233 32976.9410   161%     -   94s
     0     0 32942.6883    0  491 12654.6233 32942.6883   160%     -   96s
H    0     0                    12982.902763 32941.7907   154%     -   96s
H    0     0                    13923.878263 32941.7907   137%     -   96s
H    0     0                    14472.177607 32941.7907   128%     -   96s
H    0     0                    14475.262081 32941.7907   128%     -   96s
H    0     0                    14638.030549 32941.7907   125%     -   96s
H    0     0                    14710.021676 32941.7907   124%     -   96s
H    0     0                    14723.617252 32941.7907   124%     -   96s
     0     0 32931.0102    0  485 14723.6173 32931.0102   124%     -   97s
     0     0 32923.7833    0  537 14723.6173 32923.7833   124%     -   97s
     0     0 32914.6112    0  525 14723.6173 32914.6112   124%     -   98s
     0     0 32912.1669    0  517 14723.6173 32912.1669   124%     -   98s
     0     0 32910.5131    0  466 14723.6173 32910.5131   124%     -   99s
     0     0 32910.0212    0  527 14723.6173 32910.0212   124%     -   99s
     0     0 32873.1674    0  476 14723.6173 32873.1674   123%     -  101s
H    0     0                    14779.147323 32870.9268   122%     -  101s
H    0     0                    14842.821792 32870.9268   121%     -  101s
     0     0 32858.8047    0  528 14842.8218 32858.8047   121%     -  102s
     0     0 32853.6054    0  476 14842.8218 32853.6054   121%     -  102s
     0     0 32850.7498    0  477 14842.8218 32850.7498   121%     -  103s
     0     0 32850.3675    0  480 14842.8218 32850.3675   121%     -  103s
     0     0 32820.7318    0  476 14842.8218 32820.7318   121%     -  104s
     0     0 32811.0078    0  530 14842.8218 32811.0078   121%     -  106s
     0     0 32805.1473    0  478 14842.8218 32805.1473   121%     -  106s
     0     0 32804.6711    0  481 14842.8218 32804.6711   121%     -  107s
     0     0 32792.2551    0  584 14842.8218 32792.2551   121%     -  108s
H    0     0                    14845.855152 32789.2814   121%     -  110s
H    0     0                    14910.414102 32789.2814   120%     -  110s
     0     0 32788.6174    0  474 14910.4141 32788.6174   120%     -  110s
     0     0 32788.2733    0  477 14910.4141 32788.2733   120%     -  110s
     0     0 32782.4587    0  538 14910.4141 32782.4587   120%     -  111s
H    0     0                    14995.496728 32782.3833   119%     -  112s
H    0     0                    15000.031024 32782.3833   119%     -  112s
     0     0 32780.4136    0  537 15000.0310 32780.4136   119%     -  112s
     0     0 32779.8275    0  537 15000.0310 32779.8275   119%     -  112s
     0     0 32769.8164    0  533 15000.0310 32769.8164   118%     -  113s
     0     0 32765.4683    0  533 15000.0310 32765.4683   118%     -  114s
     0     0 32764.5476    0  482 15000.0310 32764.5476   118%     -  114s
     0     0 32753.0850    0  538 15000.0310 32753.0850   118%     -  115s
     0     0 32750.9143    0  538 15000.0310 32750.9143   118%     -  115s
     0     0 32750.2449    0  536 15000.0310 32750.2449   118%     -  115s
     0     0 32741.0112    0  473 15000.0310 32741.0112   118%     -  116s
     0     0 32738.3751    0  473 15000.0310 32738.3751   118%     -  117s
     0     0 32737.3868    0  475 15000.0310 32737.3868   118%     -  117s
     0     0 32735.5514    0  531 15000.0310 32735.5514   118%     -  118s
     0     0 32734.9961    0  538 15000.0310 32734.9961   118%     -  119s
     0     0 32727.1149    0  481 15000.0310 32727.1149   118%     -  120s
     0     0 32726.7241    0  529 15000.0310 32726.7241   118%     -  120s
     0     0 32726.1512    0  491 15000.0310 32726.1512   118%     -  121s
     0     0 32725.0086    0  491 15000.0310 32725.0086   118%     -  122s
H    0     0                    16937.115597 32725.0086  93.2%     -  131s
H    0     0                    18075.300262 32725.0086  81.0%     -  136s
H    0     0                    18377.202879 32725.0086  78.1%     -  136s
H    0     0                    18957.229293 32725.0086  72.6%     -  138s
H    0     0                    19226.155174 32725.0086  70.2%     -  138s
H    0     0                    19262.961131 32725.0086  69.9%     -  138s
H    0     2                    19412.024546 32725.0086  68.6%     -  138s
     0     2 32725.0086    0  491 19412.0245 32725.0086  68.6%     -  138s
     1     4 32418.8751    1  528 19412.0245 32725.0086  68.6%  5682  144s
     3     8 32336.9736    2  522 19412.0245 32417.1741  67.0%  5753  148s
     7    16 32068.1836    3  504 19412.0245 32335.0309  66.6%  6494  153s
    15    32 31585.4692    4  510 19412.0245 32062.2442  65.2%  6457  159s
    31    50 29942.6029    5  310 19412.0245 31585.3289  62.7%  8934  172s
    49    82 24898.2651    6  343 19412.0245 31585.0483  62.7%  9928  181s
H   50    82                    19462.404648 31585.0483  62.3%  9729  181s
H   51    82                    19576.964298 31585.0483  61.3%  9630  181s
H   52    82                    19979.795345 31585.0483  58.1%  9570  181s
H   55    82                    20383.024201 31585.0483  55.0%  9248  182s
H   62    82                    20487.725750 31585.0483  54.2%  9099  182s
    81   147 24678.2505    7  266 20487.7257 31585.0483  54.2%  7730  189s
   146   267 24228.9023    9  253 20487.7257 31585.0483  54.2%  5761  196s
H  198   267                    20490.627765 31585.0483  54.1%  4786  196s
   268   368 21380.0833   11  235 20490.6278 31585.0483  54.1%  4032  202s
   371   445 24041.6879   11  247 20490.6278 31585.0483  54.1%  3350  211s
   451   502 21640.5251   12  224 20490.6278 31585.0483  54.1%  3074  217s
   538   554 21558.8810   12  235 20490.6278 31585.0483  54.1%  2856  224s
   608   607 27565.6509   18  306 20490.6278 31585.0483  54.1%  2773  230s
   685   632 27357.9747   19  301 20490.6278 31585.0483  54.1%  2628  237s
H  739   632                    20515.122757 31462.0827  53.4%  2584  237s
   752   667 25245.1174   20  303 20515.1228 31462.0827  53.4%  2567  244s
   817   693 21221.9808   12  234 20515.1228 31462.0827  53.4%  2544  250s
H  826   693                    20532.457486 31462.0827  53.2%  2539  250s
H  853   693                    20537.441554 31462.0827  53.2%  2546  250s
H  858   693                    20572.746974 31462.0827  52.9%  2539  250s
   865   742     cutoff   12      20572.7470 31462.0827  52.9%  2530  256s
   944   781 infeasible   13      20572.7470 31086.1974  51.1%  2467  263s
  1007   823     cutoff   15      20572.7470 30837.7274  49.9%  2415  270s
  1075   885 28509.1839    6  350 20572.7470 30646.6629  49.0%  2384  276s
  1165   976 27407.8661    9  284 20572.7470 30646.6629  49.0%  2329  283s
  1278   995 27069.2900   10  262 20572.7470 30646.6629  49.0%  2237  289s
  1323  1041 26999.0739   11  242 20572.7470 30646.6629  49.0%  2243  295s
H 1398  1041                    20574.238374 30646.6629  49.0%  2208  295s
  1421  1058 26302.7478   12  221 20574.2384 30646.6629  49.0%  2193  304s
  1498  1088 25937.0774   13  178 20574.2384 30180.2001  46.7%  2178  311s
  1590  1107 23262.3211   16  114 20574.2384 30180.2001  46.7%  2196  317s
H 1591  1107                    20725.893479 30180.2001  45.6%  2194  317s
H 1628  1107                    20818.386875 30180.2001  45.0%  2215  317s
  1633  1181     cutoff   17      20818.3869 30180.2001  45.0%  2220  325s
  1750  1286 24459.4612   16  137 20818.3869 30180.2001  45.0%  2189  332s
H 1874  1286                    20839.683912 30180.2001  44.8%  2153  332s
  1883  1385 22725.3082   24  133 20839.6839 30180.2001  44.8%  2152  339s
H 2062  1415                    20851.230547 29619.3222  42.1%  2063  348s
  2136  1512 25099.7524   12  258 20851.2305 29363.9987  40.8%  2059  356s
  2316  1637 24005.2907   15  227 20851.2305 29222.8442  40.1%  1999  365s
  2498  1662     cutoff   14      20851.2305 29222.8442  40.1%  1939  370s
  2540  1698 21542.4595   16  246 20851.2305 29222.8442  40.1%  1948  375s
H 2589  1698                    20856.208023 29222.8442  40.1%  1936  375s
  2596  1797     cutoff   16      20856.2080 29222.8442  40.1%  1940  384s
  2785  1871 25754.2912   14  352 20856.2080 29222.8442  40.1%  1904  392s
H 2802  1871                    20857.922265 29222.8442  40.1%  1898  392s
  2900  2021 23735.8990   15  216 20857.9223 29222.8442  40.1%  1869  400s
  3115  2188 22794.3108   21  159 20857.9223 28876.5090  38.4%  1824  410s
  3385  2288 21400.3569   31  118 20857.9223 28874.8365  38.4%  1758  422s
  3655  2397     cutoff   48      20857.9223 28874.8365  38.4%  1717  433s
  3855  2458 22142.2440   16  150 20857.9223 28843.3733  38.3%  1709  443s
  4040  2506     cutoff   31      20857.9223 28627.1963  37.2%  1713  450s
H 4199  2506                    20864.231607 28627.1963  37.2%  1695  451s
  4210  2561 26941.8541   11  439 20864.2316 28627.1963  37.2%  1697  461s
  4425  2664 25299.9448   13  409 20864.2316 28627.1963  37.2%  1700  472s
  4650  2795 22605.2347   18  246 20864.2316 28564.3605  36.9%  1702  483s
  4936  2796 26032.3309   12  491 20864.2316 28354.9394  35.9%  1680  521s
  4938  2797 22377.2193   18  165 20864.2316 28354.9394  35.9%  1679  541s
  4939  2798 21705.5437   47  305 20864.2316 28354.9394  35.9%  1679  552s
  4940  2799 21398.3674   31  481 20864.2316 28354.9394  35.9%  1679  563s
  4941  2799 27330.3329   12  441 20864.2316 28354.9394  35.9%  1678  570s
  4942  2800 22919.3004   26  493 20864.2316 28354.9394  35.9%  1678  575s
  4944  2801 28237.7222   11  511 20864.2316 28354.9394  35.9%  1677  582s
  4946  2803 24755.0681   19  466 20864.2316 28354.9394  35.9%  1677  586s
  4949  2805 22243.5146   34  535 20864.2316 28354.9394  35.9%  1676  590s
  4952  2807 21411.2759   37  470 20864.2316 28354.9394  35.9%  1675  595s
  4955  2809 23466.4334   37  566 20864.2316 28354.9394  35.9%  1674  601s
  4957  2810 22123.2588   25  537 20864.2316 28354.9394  35.9%  1673  605s
  4959  2811 25659.3850   18  595 20864.2316 28354.9394  35.9%  1672  611s
  4960  2812 22122.9758   41  551 20864.2316 28354.9394  35.9%  1672  615s
  4962  2813 22179.7965   26  545 20864.2316 28354.9394  35.9%  1671  620s
  4964  2815 22567.5137   13  590 20864.2316 28354.9394  35.9%  1671  625s
  4965  2815 23170.8539   20  590 20864.2316 28354.9394  35.9%  1670  644s
  4966  2816 23035.5218   26  590 20864.2316 28354.9394  35.9%  1670  654s
  4967  2820 28354.9394   13  548 20864.2316 28354.9394  35.9%  1704  667s
  4969  2823 28354.9394   14  502 20864.2316 28354.9394  35.9%  1706  680s
  4973  2830 28354.9394   15  499 20864.2316 28354.9394  35.9%  1710  689s
  4981  2843 28354.9394   16  501 20864.2316 28354.9394  35.9%  1720  700s
  4997  2854 28354.9394   17  359 20864.2316 28354.9394  35.9%  1738  713s
  5013  2878 28354.9394   18  299 20864.2316 28354.9394  35.9%  1776  722s
  5045  2932 27675.0684   19  374 20864.2316 28354.9394  35.9%  1791  734s
  5130  2930 27494.1720   20  420 20864.2316 28354.9394  35.9%  1881  744s
  5169  2956 26449.1697   20  327 20864.2316 28354.9394  35.9%  1897  752s
  5233  2987 26590.6618   21  352 20864.2316 28354.9394  35.9%  1906  760s
  5314  3001 25290.5119   22  253 20864.2316 28354.9394  35.9%  1913  769s
  5405  2999 26659.0894   21  411 20864.2316 28354.9394  35.9%  1908  778s
  5492  3000 25171.0681   21  455 20864.2316 28354.9394  35.9%  1901  786s
  5574  3007 25321.7158   22  300 20864.2316 28354.9394  35.9%  1903  795s
  5645  3022 25414.3547   21  313 20864.2316 28354.9394  35.9%  1901  802s
  5719  3022 23602.7977   23  280 20864.2316 28354.9394  35.9%  1900  809s
  5790  3019 22450.8722   24  324 20864.2316 28354.9394  35.9%  1900  817s
  5850  3018 22122.7479   24  253 20864.2316 28354.9394  35.9%  1901  825s
  5928  3030 21511.1968   25  282 20864.2316 28354.9394  35.9%  1904  832s
  6002  3027     cutoff   26      20864.2316 28354.9394  35.9%  1905  837s
  6068  3039     cutoff   25      20864.2316 28354.9394  35.9%  1905  845s
  6148  3055 26117.1307   19  502 20864.2316 28354.9394  35.9%  1905  856s
  6235  3049 24536.1900   19  419 20864.2316 28354.9394  35.9%  1902  865s
  6333  3039 25592.0322   20  465 20864.2316 28354.9394  35.9%  1902  871s
  6392  3044 24484.1378   20  486 20864.2316 28354.9394  35.9%  1906  885s
  6495  3032     cutoff   21      20864.2316 28354.9394  35.9%  1909  894s
  6569  3040     cutoff   22      20864.2316 28354.9394  35.9%  1922  903s
  6668  3033 21016.7185   22  275 20864.2316 28354.9394  35.9%  1927  912s
  6726  3060     cutoff   23      20864.2316 28354.9394  35.9%  1935  926s
  6824  3079 24544.4262   20  442 20864.2316 28354.9394  35.9%  1940  935s
  6935  3053 24296.3073   21  475 20864.2316 28354.9394  35.9%  1943  944s
  7069  3019 23887.8665   23  313 20864.2316 28354.9394  35.9%  1946  954s
H 7132  2856                    20880.015827 28354.9394  35.8%  1950  954s
  7151  2892     cutoff   25      20880.0158 27733.9108  32.8%  1952  966s
H 7180  2748                    20895.952639 27733.9108  32.7%  1956  966s
  7255  2750     cutoff   27      20895.9526 27383.6700  31.0%  1965  977s
  7374  2737     cutoff   28      20895.9526 27017.2622  29.3%  1977  991s
H 7378  2608                    20948.436733 27017.2622  29.0%  1977  991s
H 7405  2478                    20954.664261 27017.2622  28.9%  1975  991s
H 7432  2354                    21007.148355 27017.2622  28.6%  1975  991s
H 7443  2241                    21278.955348 27017.2622  27.0%  1975  991s
  7466  2257 23363.9443   23  431 21278.9553 27017.2622  27.0%  1980 1003s
H 7625  2139                    21374.404447 26815.1973  25.5%  1983 1015s
H 7770  2009                    21446.230539 25972.6381  21.1%  1986 1025s
  7878  1992 22270.5679   22  482 21446.2305 25896.3740  20.8%  1994 1037s
  8028  1955 21631.5727   24  405 21446.2305 25661.8083  19.7%  2003 1050s
  8206  1914     cutoff   25      21446.2305 25539.3849  19.1%  2010 1062s
  8357  1903 23516.1071   24  267 21446.2305 25539.3849  19.1%  2011 1074s
  8584  1857 21676.0433   29  104 21446.2305 25539.3849  19.1%  2007 1089s
  8823  1765 22706.7431   26  278 21446.2305 25080.0492  16.9%  1999 1104s
  9068  1685     cutoff   32      21446.2305 24755.1805  15.4%  1998 1120s
  9345  1586     cutoff   28      21446.2305 24454.9140  14.0%  1995 1134s
  9593  1452 21549.1296   29  425 21446.2305 24313.9395  13.4%  1993 1149s
  9923  1330 23331.8301   33  157 21446.2305 24081.7280  12.3%  1984 1165s
 10340  1149 21598.8202   27  463 21446.2305 23807.3687  11.0%  1961 1181s
 10684   902 infeasible   31      21446.2305 23663.6379  10.3%  1943 1196s
 11291   585     cutoff   29      21446.2305 23116.1524  7.79%  1897 1210s
 12104    36     cutoff   27      21446.2305 22879.4914  6.68%  1818 1221s

Cutting planes:
  Learned: 3
  MIR: 568
  Mixing: 2
  Flow cover: 1516
  RLT: 23
  Relax-and-lift: 212

Explored 12951 nodes (22509035 simplex iterations) in 1223.68 seconds (3711.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21446.2 21374.4 21279 ... 20857.9

Optimal solution found (tolerance 1.00e-04)
Best objective 2.144623053945e+04, best bound 2.144623053945e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1223.69s
  Master Objective (UB) = 21446.23, θ = 151463.48
  Upper Bound (UB) = 21446.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151463.48
  [DEBUG]   ✓ Scenario 0: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151463.48 ≤ Q = 151463.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2d11e431
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2d11e431
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.552218e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8262943.9943
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.408032e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140803.21    0  124 8262943.99 -140803.21   102%     -    0s
H    0     0                    -105815.7326 -140803.21  33.1%     -    0s
H    0     0                    -106377.7530 -140803.21  32.4%     -    0s
H    0     0                    -115385.4980 -118029.71  2.29%     -    0s
     0     0 -118029.71    0   86 -115385.50 -118029.71  2.29%     -    0s
     0     0 -117588.12    0   87 -115385.50 -117588.12  1.91%     -    0s
H    0     0                    -115540.8203 -117568.40  1.75%     -    0s
H    0     0                    -116346.0387 -117568.40  1.05%     -    0s
H    0     0                    -116369.1046 -117568.40  1.03%     -    0s
     0     0 -117522.40    0   87 -116369.10 -117522.40  0.99%     -    0s
     0     0 -117311.27    0   75 -116369.10 -117311.27  0.81%     -    0s
     0     0 -117195.54    0   65 -116369.10 -117195.54  0.71%     -    0s
     0     0 -117166.62    0   61 -116369.10 -117166.62  0.69%     -    0s
     0     0 -117166.45    0   61 -116369.10 -117166.45  0.69%     -    0s
     0     0 -117060.38    0   48 -116369.10 -117060.38  0.59%     -    0s
     0     0 -117046.15    0   51 -116369.10 -117046.15  0.58%     -    0s
     0     0 -116985.78    0   51 -116369.10 -116985.78  0.53%     -    0s
     0     0 -116961.10    0   51 -116369.10 -116961.10  0.51%     -    0s
     0     2 -116961.10    0   51 -116369.10 -116961.10  0.51%     -    0s
H   37    10                    -116746.5600 -116820.65  0.06%   9.4    0s
*   43    10               6    -116806.8457 -116820.65  0.01%   9.4    0s

Cutting planes:
  Gomory: 22
  MIR: 145
  Flow cover: 8
  RLT: 41
  BQP: 3

Explored 58 nodes (1258 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -116807 -116747 -116369 ... 1.55222e+13
No other solutions better than -116807

Optimal solution found (tolerance 1.00e-04)
Best objective -1.168068456675e+05, best bound -1.168068456675e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 143925.07
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116806.85
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -116806.85 = 143925.07
  [DEBUG]   Current θ from Master = 151463.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7538.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13907.82
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 2920.1931, Absolute Gap = 2920.1931, Relative Gap = 0.136163
  Not converged yet (gap = 2920.19 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308241 nonzeros
Model fingerprint: 0x2cb5372d
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 46015 rows and 18685 columns
Presolve time: 0.98s
Presolved: 62398 rows, 27255 columns, 388134 nonzeros
Variable types: 24996 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 62398 rows, 27255 columns, 388134 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34600   -1.1036563e+04   0.000000e+00   2.899921e+07      5s
   49352    1.8597269e+04   0.000000e+00   3.867824e+07     10s
   62118    3.8083986e+04   0.000000e+00   4.603417e+06     15s
Concurrent spin time: 1.14s

Solved with dual simplex

Root relaxation: objective 4.598347e+04, 48600 iterations, 19.74 seconds (42.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45983.4722    0  165 -194556.81 45983.4722   124%     -   21s
H    0     0                    -180924.6486 45983.4722   125%     -   21s
H    0     0                    -134854.7861 45983.4722   134%     -   21s
H    0     0                    -119674.5567 45983.4722   138%     -   21s
H    0     0                    -119332.7446 45983.4722   139%     -   21s
H    0     0                    -117951.1393 45983.4722   139%     -   21s
H    0     0                    -117486.3441 45983.4722   139%     -   21s
H    0     0                    -117468.1352 45983.4722   139%     -   21s
H    0     0                    -117466.4409 45983.4722   139%     -   21s
H    0     0                    -117428.4814 45983.4722   139%     -   21s
H    0     0                    -44477.01379 45983.4722   203%     -   21s
H    0     0                    -44267.86357 45983.4722   204%     -   21s
H    0     0                    -19065.38057 45983.4722   341%     -   21s
H    0     0                    -829.0219441 45983.4722  5647%     -   21s
H    0     0                    -614.7967714 45983.4722  7579%     -   21s
H    0     0                    4325.3078429 45983.4722   963%     -   21s
H    0     0                    4404.2932030 45983.4722   944%     -   21s
H    0     0                    5765.8563605 45983.4722   698%     -   22s
H    0     0                    6131.3661155 45983.4722   650%     -   22s
H    0     0                    6203.1939434 45983.4722   641%     -   22s
H    0     0                    7050.8048380 45983.4722   552%     -   22s
H    0     0                    7058.9571260 45983.4722   551%     -   22s
H    0     0                    7149.9312184 45983.4722   543%     -   22s
     0     0 41466.4574    0  235 7149.93122 41466.4574   480%     -   30s
H    0     0                    8139.3713062 41466.4574   409%     -   30s
H    0     0                    9281.8066840 41466.4574   347%     -   30s
H    0     0                    10183.383825 41466.4574   307%     -   30s
H    0     0                    11949.186066 41466.4574   247%     -   30s
     0     0 41217.2703    0  277 11949.1861 41217.2703   245%     -   33s
     0     0 41217.2703    0  291 11949.1861 41217.2703   245%     -   36s
     0     0 41217.2703    0  287 11949.1861 41217.2703   245%     -   36s
     0     0 41217.2703    0  289 11949.1861 41217.2703   245%     -   36s
     0     0 41216.6385    0  289 11949.1861 41216.6385   245%     -   36s
     0     0 38508.7615    0  360 11949.1861 38508.7615   222%     -   48s
     0     0 37862.2721    0  327 11949.1861 37862.2721   217%     -   53s
     0     0 37610.2327    0  367 11949.1861 37610.2327   215%     -   56s
     0     0 37178.7247    0  355 11949.1861 37178.7247   211%     -   59s
     0     0 37131.1722    0  319 11949.1861 37131.1722   211%     -   60s
     0     0 37103.7841    0  317 11949.1861 37103.7841   211%     -   61s
     0     0 37102.4190    0  323 11949.1861 37102.4190   211%     -   62s
     0     0 37098.5490    0  326 11949.1861 37098.5490   210%     -   62s
     0     0 37098.3933    0  326 11949.1861 37098.3933   210%     -   62s
     0     0 35924.0575    0  374 11949.1861 35924.0575   201%     -   74s
     0     0 35376.3392    0  385 11949.1861 35376.3392   196%     -   79s
     0     0 35126.1280    0  378 11949.1861 35126.1280   194%     -   82s
     0     0 35040.6474    0  384 11949.1861 35040.6474   193%     -   84s
     0     0 34840.9558    0  432 11949.1861 34840.9558   192%     -   88s
     0     0 34784.4488    0  450 11949.1861 34784.4488   191%     -   89s
     0     0 34735.1454    0  413 11949.1861 34735.1454   191%     -   91s
     0     0 34723.7376    0  414 11949.1861 34723.7376   191%     -   91s
     0     0 34717.7754    0  414 11949.1861 34717.7754   191%     -   92s
     0     0 34715.1660    0  417 11949.1861 34715.1660   191%     -   92s
     0     0 34714.0574    0  417 11949.1861 34714.0574   191%     -   92s
H    0     0                    11961.153885 34714.0574   190%     -   96s
H    0     0                    11973.637862 34714.0574   190%     -   96s
H    0     0                    12007.120769 34714.0574   189%     -   96s
H    0     0                    12084.102606 34714.0574   187%     -   96s
H    0     0                    12196.191690 34714.0574   185%     -   96s
H    0     0                    12379.697622 34714.0574   180%     -   96s
H    0     0                    12548.338659 33914.0386   170%     -  101s
H    0     0                    12562.726364 33914.0386   170%     -  101s
     0     0 33914.0386    0  389 12562.7264 33914.0386   170%     -  101s
H    0     0                    12796.995522 33616.3731   163%     -  105s
H    0     0                    12869.050110 33616.3731   161%     -  105s
     0     0 33616.3731    0  443 12869.0501 33616.3731   161%     -  105s
     0     0 33377.7623    0  500 12869.0501 33377.7623   159%     -  107s
     0     0 33342.3811    0  439 12869.0501 33342.3811   159%     -  108s
     0     0 33273.2178    0  494 12869.0501 33273.2178   159%     -  109s
     0     0 33221.0680    0  499 12869.0501 33221.0680   158%     -  110s
     0     0 33199.4513    0  451 12869.0501 33199.4513   158%     -  111s
     0     0 33190.3468    0  503 12869.0501 33190.3468   158%     -  112s
     0     0 33184.5537    0  502 12869.0501 33184.5537   158%     -  112s
     0     0 33167.1448    0  503 12869.0501 33167.1448   158%     -  113s
     0     0 33151.0270    0  500 12869.0501 33151.0270   158%     -  114s
     0     0 33136.8730    0  499 12869.0501 33136.8730   157%     -  115s
     0     0 33136.0579    0  493 12869.0501 33136.0579   157%     -  115s
     0     0 33031.0029    0  450 12869.0501 33031.0029   157%     -  118s
     0     0 32975.6543    0  457 12869.0501 32975.6543   156%     -  119s
     0     0 32964.3958    0  456 12869.0501 32964.3958   156%     -  120s
     0     0 32959.1111    0  456 12869.0501 32959.1111   156%     -  121s
     0     0 32955.3221    0  456 12869.0501 32955.3221   156%     -  121s
     0     0 32954.5587    0  457 12869.0501 32954.5587   156%     -  121s
     0     0 32914.3657    0  445 12869.0501 32914.3657   156%     -  123s
H    0     0                    13509.676951 32911.6661   144%     -  125s
H    0     0                    13923.701251 32911.6661   136%     -  125s
H    0     0                    14192.785962 32911.6661   132%     -  126s
     0     0 32887.6858    0  510 14192.7860 32887.6858   132%     -  127s
     0     0 32872.0630    0  523 14192.7860 32872.0630   132%     -  128s
     0     0 32867.9355    0  466 14192.7860 32867.9355   132%     -  129s
     0     0 32865.4912    0  467 14192.7860 32865.4912   132%     -  129s
     0     0 32863.4671    0  471 14192.7860 32863.4671   132%     -  129s
     0     0 32862.0239    0  470 14192.7860 32862.0239   132%     -  129s
     0     0 32818.6108    0  511 14192.7860 32818.6108   131%     -  132s
H    0     0                    14654.197512 32818.5745   124%     -  132s
H    0     0                    14802.724288 32818.5745   122%     -  132s
H    0     0                    14876.979713 32818.5745   121%     -  132s
     0     0 32807.9377    0  514 14876.9797 32807.9377   121%     -  133s
     0     0 32806.3983    0  519 14876.9797 32806.3983   121%     -  133s
     0     0 32787.9443    0  472 14876.9797 32787.9443   120%     -  134s
H    0     0                    15433.802107 32787.9120   112%     -  138s
H    0     0                    15501.155383 32787.9120   112%     -  138s
H    0     0                    15943.127838 32787.9120   106%     -  138s
H    0     0                    16082.134013 32787.9120   104%     -  138s
H    0     0                    16310.655655 32787.9120   101%     -  138s
     0     0 32783.0065    0  470 16310.6557 32783.0065   101%     -  138s
     0     0 32778.3471    0  472 16310.6557 32778.3471   101%     -  139s
     0     0 32776.3669    0  478 16310.6557 32776.3669   101%     -  139s
     0     0 32775.9222    0  476 16310.6557 32775.9222   101%     -  139s
     0     0 32763.7002    0  535 16310.6557 32763.7002   101%     -  140s
H    0     0                    16387.835391 32763.6605   100%     -  141s
H    0     0                    16421.620107 32763.6605   100%     -  141s
H    0     0                    16493.032944 32763.6605  98.7%     -  141s
H    0     0                    16537.713394 32763.6605  98.1%     -  141s
H    0     0                    16558.757983 32763.6605  97.9%     -  141s
     0     0 32755.8871    0  479 16558.7580 32755.8871  97.8%     -  141s
     0     0 32754.8165    0  485 16558.7580 32754.8165  97.8%     -  141s
     0     0 32735.7386    0  467 16558.7580 32735.7386  97.7%     -  143s
H    0     0                    16618.003065 32735.6912  97.0%     -  147s
     0     0 32728.7663    0  469 16618.0031 32728.7663  96.9%     -  147s
     0     0 32726.8346    0  473 16618.0031 32726.8346  96.9%     -  147s
     0     0 32723.6150    0  470 16618.0031 32723.6150  96.9%     -  148s
     0     0 32721.1952    0  470 16618.0031 32721.1952  96.9%     -  148s
     0     0 32720.4694    0  474 16618.0031 32720.4694  96.9%     -  148s
     0     0 32705.7912    0  479 16618.0031 32705.7912  96.8%     -  149s
     0     0 32698.1348    0  483 16618.0031 32698.1348  96.8%     -  150s
     0     0 32697.0442    0  481 16618.0031 32697.0442  96.8%     -  150s
     0     0 32684.3525    0  519 16618.0031 32684.3525  96.7%     -  152s
     0     0 32682.8404    0  526 16618.0031 32682.8404  96.7%     -  152s
     0     0 32679.0693    0  537 16618.0031 32679.0693  96.6%     -  154s
     0     0 32676.8336    0  583 16618.0031 32676.8336  96.6%     -  155s
     0     0 32676.2717    0  588 16618.0031 32676.2717  96.6%     -  155s
     0     0 32670.3904    0  575 16618.0031 32670.3904  96.6%     -  156s
     0     0 32666.6243    0  584 16618.0031 32666.6243  96.6%     -  157s
     0     0 32665.8800    0  592 16618.0031 32665.8800  96.6%     -  158s
     0     0 32660.6977    0  479 16618.0031 32660.6977  96.5%     -  159s
     0     0 32660.5784    0  479 16618.0031 32660.5784  96.5%     -  160s
H    0     0                    16637.415606 32660.0978  96.3%     -  174s
H    0     0                    16683.526354 32660.0978  95.8%     -  186s
     0     2 32660.0978    0  479 16683.5264 32660.0978  95.8%     -  187s
     3     8 32326.5982    2  565 16683.5264 32587.9853  95.3%  3861  197s
     7    16 32076.0856    3  553 16683.5264 32448.1419  94.5%  6210  207s
    15    32 31820.2187    4  614 16683.5264 32075.6562  92.3%  7586  212s
    31    48 30128.5478    5  391 16683.5264 31819.7701  90.7%  9391  227s
    47    80 29708.6084    6  368 16683.5264 31819.7701  90.7% 10846  234s
    79   112 29302.4601    7  360 16683.5264 31819.7701  90.7%  8296  241s
   111   144 29281.2425    8  409 16683.5264 31819.7701  90.7%  7344  250s
H  114   144                    17073.096290 31819.7701  86.4%  7191  250s
H  121   144                    17737.034672 31819.7701  79.4%  6878  250s
H  126   144                    19045.311617 31819.7701  67.1%  6774  250s
H  143   176                    19313.231535 31819.7701  64.8%  6351  256s
H  145   176                    19337.406150 31819.7701  64.6%  6310  256s
H  146   176                    19860.343737 31819.7701  60.2%  6289  256s
H  163   176                    20735.144104 31819.7701  53.5%  5924  256s
   175   268 28536.0637    9  441 20735.1441 31819.7701  53.5%  5760  265s
   269   364 28897.9185    9  355 20735.1441 31819.7701  53.5%  4811  272s
   371   422 28250.8781   10  380 20735.1441 31819.7701  53.5%  4224  279s
   449   486 28482.5132   10  344 20735.1441 31819.7701  53.5%  4098  286s
   524   544 27892.9806   10  269 20735.1441 31819.7701  53.5%  3999  294s
   600   633 26664.1206   10  252 20735.1441 31819.7701  53.5%  3900  301s
   695   696 27746.7791   11  383 20735.1441 31819.7701  53.5%  3685  307s
   784   745 28119.9670   11  441 20735.1441 31819.7701  53.5%  3605  315s
H  789   745                    21372.557376 31819.7701  48.9%  3606  315s
   867   796 26385.3028   11  267 21372.5574 31819.7701  48.9%  3496  323s
   950   850 28047.8247   12  434 21372.5574 31819.7701  48.9%  3396  330s
  1043   891 26803.9468   11  280 21372.5574 31819.7701  48.9%  3377  337s
  1131   946 27028.7161   13  289 21372.5574 31819.7701  48.9%  3337  345s
  1214   991 26490.9494   13  440 21372.5574 31819.7701  48.9%  3327  354s
  1297  1050 26882.0982   14  253 21372.5574 31819.7701  48.9%  3342  361s
  1392  1119 26376.4360   17  285 21372.5574 31819.7701  48.9%  3333  369s
  1489  1154 25975.3507   19  226 21372.5574 31504.9782  47.4%  3328  377s
  1545  1188 25848.1354   19  204 21372.5574 31504.9782  47.4%  3331  387s
  1645  1257 26303.8730   18  281 21372.5574 31504.9782  47.4%  3309  394s
  1736  1337 25098.1961   20  198 21372.5574 31323.0362  46.6%  3362  401s
  1826  1412 25486.5873   21  196 21372.5574 31323.0362  46.6%  3406  409s
  1937  1500 25202.0448   22  187 21372.5574 31323.0362  46.6%  3402  418s
  2073  1565 23103.1556   24  173 21372.5574 31323.0362  46.6%  3366  428s
  2190  1679 24229.6407   26  179 21372.5574 31323.0362  46.6%  3375  437s
  2338  1711 23756.8507   27  188 21372.5574 31323.0362  46.6%  3361  448s
  2386  1765 23615.7173   28  174 21372.5574 30226.5175  41.4%  3382  454s
  2479  1827 23181.6846   28  181 21372.5574 30226.5175  41.4%  3374  463s
  2595  1901 22807.9336   33  236 21372.5574 30051.8052  40.6%  3377  474s
  2723  1963 22537.4456   38  228 21372.5574 30031.3175  40.5%  3367  485s
  2852  2060 22213.6958   48  148 21372.5574 29931.6666  40.0%  3363  497s
  3017  2112 infeasible   56      21372.5574 29708.4438  39.0%  3344  508s
  3155  2164 28276.3320   10  479 21372.5574 29662.5556  38.8%  3393  519s
  3307  2233 22335.2046   12  416 21372.5574 29514.5312  38.1%  3438  530s
  3438  2313 infeasible   12      21372.5574 29356.2336  37.4%  3497  542s
  3556  2447 23185.0032   13  408 21372.5574 29356.2336  37.4%  3573  555s
  3732  2596 22187.1107   15  390 21372.5574 29275.2872  37.0%  3593  567s
  3989  2597 21578.3465   50  479 21372.5574 29275.2872  37.0%  3541  610s
  3991  2598 24570.6166   15  165 21372.5574 29275.2872  37.0%  3539  650s
  3992  2599 25761.2203    9  305 21372.5574 29275.2872  37.0%  3538  670s
  3993  2600 25777.1362   14  492 21372.5574 29275.2872  37.0%  3537  683s
  3994  2600 24047.4794   14  432 21372.5574 29275.2872  37.0%  3536  694s
  3995  2601 24473.2121   49  461 21372.5574 29275.2872  37.0%  3535  699s
  3996  2602 22463.8845   28  610 21372.5574 29275.2872  37.0%  3534  703s
  3997  2602 26230.1112   20  485 21372.5574 29275.2872  37.0%  3534  707s
  3999  2604 23027.7183   19  523 21372.5574 29275.2872  37.0%  3532  711s
  4001  2605 22403.6907   43  520 21372.5574 29275.2872  37.0%  3530  715s
  4004  2607 24444.4796   20  472 21372.5574 29275.2872  37.0%  3527  720s
  4007  2609 23648.9165   14  568 21372.5574 29275.2872  37.0%  3525  728s
  4008  2610 22772.1678   16  507 21372.5574 29275.2872  37.0%  3524  730s
  4011  2612 27706.9622    7  513 21372.5574 29275.2872  37.0%  3521  738s
  4012  2612 26649.1925   23  518 21372.5574 29275.2872  37.0%  3520  740s
  4014  2614 26802.8145   12  517 21372.5574 29275.2872  37.0%  3519  747s
  4016  2615 23578.1741   35  474 21372.5574 29275.2872  37.0%  3517  753s
  4017  2616 22838.5330   44  529 21372.5574 29275.2872  37.0%  3516  756s
  4018  2616 25275.0784   21  475 21372.5574 29275.2872  37.0%  3515  762s
  4020  2618 23306.1697   40  543 21372.5574 29275.2872  37.0%  3513  769s
  4021  2618 22703.4602   35  549 21372.5574 29275.2872  37.0%  3513  771s
  4023  2620 27059.9752   11  576 21372.5574 29275.2872  37.0%  3511  778s
  4024  2620 22792.5854   32  589 21372.5574 29275.2872  37.0%  3510  780s
  4026  2622 27134.3231   11  583 21372.5574 29275.2872  37.0%  3508  819s
  4027  2622 25283.3248   35  583 21372.5574 29275.2872  37.0%  3507  857s
  4028  2625 29275.2872   12  508 21372.5574 29275.2872  37.0%  3568  874s
  4029  2628 28867.0807   13  290 21372.5574 29275.2872  37.0%  3569  881s
  4032  2633 28600.5726   14  268 21372.5574 29275.2872  37.0%  3570  888s
  4038  2643 27154.5288   15  287 21372.5574 29275.2872  37.0%  3574  900s
  4050  2652 26247.5833   16  260 21372.5574 29275.2872  37.0%  3598  917s
  4063  2678 26320.1613   16  364 21372.5574 29275.2872  37.0%  3620  951s
  4094  2714 28152.4509   16  308 21372.5574 29275.2872  37.0%  3691  965s
  4140  2731 26282.9222   18  266 21372.5574 29275.2872  37.0%  3761  981s
  4178  2753 21972.2905   19  232 21372.5574 29275.2872  37.0%  3805  994s
  4224  2777 26125.6802   19  255 21372.5574 29275.2872  37.0%  3833 1008s
  4293  2790 26069.9338   20  269 21372.5574 29275.2872  37.0%  3879 1024s
  4363  2813     cutoff   21      21372.5574 29275.2872  37.0%  3892 1036s
  4447  2826     cutoff   23      21372.5574 29275.2872  37.0%  3878 1048s
  4531  2833 23735.2218   22  197 21372.5574 29275.2872  37.0%  3860 1058s
  4622  2836 infeasible   23      21372.5574 29275.2872  37.0%  3835 1069s
  4704  2843     cutoff   25      21372.5574 29275.2872  37.0%  3816 1079s
  4787  2847     cutoff   25      21372.5574 29275.2872  37.0%  3790 1090s
  4867  2848 24028.2175   21  350 21372.5574 29275.2872  37.0%  3769 1099s
  4939  2841 23655.8961   22  314 21372.5574 29275.2872  37.0%  3752 1108s
  5012  2842 23218.3099   24  225 21372.5574 29275.2872  37.0%  3741 1118s
  5071  2843 22922.6197   27  182 21372.5574 29275.2872  37.0%  3731 1128s
  5141  2843 22849.6816   29  179 21372.5574 29275.2872  37.0%  3720 1139s
  5206  2843 22401.1008   31  114 21372.5574 29275.2872  37.0%  3707 1150s
  5285  2839 22073.5050   36   83 21372.5574 29275.2872  37.0%  3700 1160s
  5362  2824 21521.4927   42   92 21372.5574 28326.3471  32.5%  3686 1172s
  5462  2818 27986.7092   19  482 21372.5574 28271.6683  32.3%  3670 1183s
  5532  2826 27313.9592   20  503 21372.5574 28271.6683  32.3%  3662 1197s
  5627  2826 27244.3471   21  493 21372.5574 28271.6683  32.3%  3649 1211s
  5706  2831 26731.3607   23  473 21372.5574 28271.6683  32.3%  3641 1224s
  5801  2836 25793.9708   25  383 21372.5574 28271.6683  32.3%  3637 1236s
  5892  2857 25476.8172   26  383 21372.5574 27310.9445  27.8%  3626 1251s
  6012  2852 23968.9540   29  314 21372.5574 27310.9445  27.8%  3606 1265s
  6139  2832 22281.2119   33  313 21372.5574 27310.9445  27.8%  3584 1279s
  6260  2843 22247.2047   33  293 21372.5574 27310.9445  27.8%  3569 1294s
  6373  2843 infeasible   25      21372.5574 26991.6631  26.3%  3560 1309s
  6528  2826 21484.0521   24  437 21372.5574 26991.6631  26.3%  3541 1325s
  6682  2800 21744.5095   25  445 21372.5574 26919.3712  26.0%  3527 1345s
  6823  2790 23264.4598   21  435 21372.5574 26564.2333  24.3%  3524 1363s
  6968  2775 infeasible   23      21372.5574 26564.2333  24.3%  3523 1384s
  7132  2742 infeasible   24      21372.5574 26296.7187  23.0%  3520 1402s
  7233  2755 infeasible   24      21372.5574 26227.0509  22.7%  3522 1425s
  7375  2752 24629.4837   22  295 21372.5574 26227.0509  22.7%  3516 1445s
  7574  2717 22810.7636   25  346 21372.5574 26227.0509  22.7%  3504 1467s
  7731  2686 22369.7319   27  270 21372.5574 25752.4437  20.5%  3504 1488s
  7902  2679 21542.5856   29  299 21372.5574 25752.4437  20.5%  3504 1511s
  8087  2656 infeasible   31      21372.5574 25683.0112  20.2%  3502 1532s
  8287  2652     cutoff   25      21372.5574 25356.7888  18.6%  3500 1553s
  8516  2569     cutoff   23      21372.5574 25296.0813  18.4%  3491 1581s
  8757  2475 23778.7797   19  366 21372.5574 25091.0138  17.4%  3489 1606s
  8962  2424 22356.7651   22  272 21372.5574 24868.6713  16.4%  3506 1631s
  9135  2428     cutoff   35      21372.5574 24826.0246  16.2%  3516 1655s
  9410  2326 23000.5413   27  383 21372.5574 24657.8977  15.4%  3510 1684s
  9707  2228 21864.0722   25  392 21372.5574 24476.1587  14.5%  3506 1713s
 10036  2122 22591.8204   25  384 21372.5574 24464.5547  14.5%  3498 1741s
 10395  1992 infeasible   34      21372.5574 24035.0630  12.5%  3481 1769s
 10727  1817 22217.9159   22  363 21372.5574 23937.9613  12.0%  3455 1802s
 11182  1610 infeasible   28      21372.5574 23655.3870  10.7%  3420 1832s
 11784  1350 infeasible   39      21372.5574 23280.6228  8.93%  3348 1862s
 12440   960 21750.1252   28  114 21372.5574 23078.5308  7.98%  3264 1893s
 13340   297     cutoff   28      21372.5574 22613.1151  5.80%  3139 1921s
 14564     0 21522.4031   31  115 21372.5574 22166.5217  3.71%  2957 1932s

Cutting planes:
  Learned: 1
  MIR: 476
  Mixing: 1
  Flow cover: 1403
  RLT: 22
  Relax-and-lift: 131

Explored 14979 nodes (43555337 simplex iterations) in 1932.59 seconds (6002.96 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21372.6 20735.1 19860.3 ... 16637.4

Optimal solution found (tolerance 1.00e-04)
Best objective 2.137255737627e+04, best bound 2.137255737627e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1932.60s
  Master Objective (UB) = 21372.56, θ = 151566.05
  Upper Bound (UB) = 21372.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151566.05
  [DEBUG]   ✓ Scenario 0: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151566.05 ≤ Q = 151566.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x34d9953a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcb266ac6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.550514e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8249206.3250
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.406834e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140683.40    0  124 8249206.33 -140683.40   102%     -    0s
H    0     0                    -105713.1672 -140683.40  33.1%     -    0s
H    0     0                    -106275.1876 -140683.40  32.4%     -    0s
     0     0 -111176.61    0   87 -106275.19 -111176.61  4.61%     -    0s
H    0     0                    -107837.3288 -111047.00  2.98%     -    0s
H    0     0                    -108112.9635 -111047.00  2.71%     -    0s
H    0     0                    -108847.6583 -111047.00  2.02%     -    0s
H    0     0                    -109123.2931 -111047.00  1.76%     -    0s
     0     0 -110642.69    0   89 -109123.29 -110642.69  1.39%     -    0s
     0     0 -110577.00    0   88 -109123.29 -110577.00  1.33%     -    0s
H    0     0                    -109370.4234 -110577.00  1.10%     -    0s
     0     0 -110484.24    0   84 -109370.42 -110484.24  1.02%     -    0s
     0     0 -110476.08    0   84 -109370.42 -110476.08  1.01%     -    0s
     0     2 -110473.57    0   84 -109370.42 -110473.57  1.01%     -    0s
*  502   329              19    -109471.2902 -109974.06  0.46%   6.8    0s
*  512   329              19    -109509.1566 -109974.06  0.42%   6.7    0s
*  529   329              21    -109521.1883 -109974.06  0.41%   6.5    0s
*  737   337              29    -109667.6338 -109833.03  0.15%   5.9    0s
*  916   222              28    -109764.5055 -109785.57  0.02%   5.8    0s
* 1109     2              27    -109769.3158 -109771.78  0.00%   5.2    0s

Cutting planes:
  Gomory: 29
  Implied bound: 2
  MIR: 196

Explored 1299 nodes (6263 simplex iterations) in 0.16 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109769 -109765 -109668 ... -106275
No other solutions better than -109769

Optimal solution found (tolerance 1.00e-04)
Best objective -1.097693157674e+05, best bound -1.097693157674e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 150962.60
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109769.32
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -109769.32 = 150962.60
  [DEBUG]   Current θ from Master = 151566.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 603.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20769.11
  Lower Bound (LB) = 20769.11
  Gap (UB-LB) = 603.4490, Absolute Gap = 603.4490, Relative Gap = 0.028235
  Not converged yet (gap = 603.45 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351487 nonzeros
Model fingerprint: 0x99ae8835
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 52600 rows and 21360 columns
Presolve time: 1.14s
Presolved: 71103 rows, 30820 columns, 442759 nonzeros
Variable types: 28561 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 71103 rows, 30820 columns, 442759 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34225   -4.9694532e+04   0.000000e+00   3.572620e+07      5s
   47244    1.1907103e+04   0.000000e+00   3.158572e+06     10s
   56083    1.8190028e+04   0.000000e+00   3.086862e+06     15s
   64111    2.2229133e+04   0.000000e+00   6.599017e+06     20s
   71932    2.7522742e+04   0.000000e+00   8.897158e+07     25s
   79439    3.4107243e+04   0.000000e+00   4.746952e+06     30s
Concurrent spin time: 3.46s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.598347e+04, 68522 iterations, 32.75 seconds (68.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45983.4722    0  165 -194556.81 45983.4722   124%     -   34s
H    0     0                    -178234.8369 45983.4722   126%     -   34s
H    0     0                    -78258.13273 45983.4722   159%     -   34s
H    0     0                    -70382.09052 45983.4722   165%     -   34s
H    0     0                    -63490.95476 45983.4722   172%     -   34s
H    0     0                    -63281.80454 45983.4722   173%     -   34s
H    0     0                    -43065.38222 45983.4722   207%     -   34s
H    0     0                    -16059.34201 45983.4722   386%     -   34s
H    0     0                    -15266.15777 45983.4722   401%     -   34s
H    0     0                    -10443.27238 45983.4722   540%     -   34s
H    0     0                    -10219.18602 45983.4722   550%     -   34s
H    0     0                    -7461.338106 45983.4722   716%     -   35s
H    0     0                    -5068.786474 45983.4722  1007%     -   35s
H    0     0                    -4930.383367 45983.4722  1033%     -   35s
H    0     0                    -4921.929921 45983.4722  1034%     -   35s
H    0     0                    -4871.864636 45983.4722  1044%     -   35s
H    0     0                    -4863.539940 45983.4722  1045%     -   35s
H    0     0                    5780.6269133 45983.4722   695%     -   35s
H    0     0                    6462.9810247 45983.4722   611%     -   35s
H    0     0                    7149.9312184 45983.4722   543%     -   35s
     0     0 41107.1382    0  259 7149.93122 41107.1382   475%     -   48s
H    0     0                    10234.619612 41107.1382   302%     -   48s
H    0     0                    11383.656424 41107.1382   261%     -   48s
H    0     0                    11445.285346 41107.1382   259%     -   48s
H    0     0                    11935.590490 41107.1382   244%     -   48s
H    0     0                    11949.186066 41107.1382   244%     -   48s
     0     0 41107.1382    0  295 11949.1861 41107.1382   244%     -   52s
     0     0 41107.1382    0  268 11949.1861 41107.1382   244%     -   53s
     0     0 41107.1382    0  264 11949.1861 41107.1382   244%     -   53s
     0     0 41107.1382    0  266 11949.1861 41107.1382   244%     -   53s
     0     0 41107.1382    0  274 11949.1861 41107.1382   244%     -   53s
     0     0 41107.1382    0  266 11949.1861 41107.1382   244%     -   54s
     0     0 38520.0753    0  325 11949.1861 38520.0753   222%     -   64s
     0     0 37522.5067    0  345 11949.1861 37522.5067   214%     -   69s
     0     0 37419.6046    0  360 11949.1861 37419.6046   213%     -   73s
     0     0 37375.8393    0  356 11949.1861 37375.8393   213%     -   74s
     0     0 37361.4634    0  357 11949.1861 37361.4634   213%     -   75s
     0     0 37358.7730    0  359 11949.1861 37358.7730   213%     -   76s
     0     0 37358.3187    0  359 11949.1861 37358.3187   213%     -   76s
     0     0 35667.6517    0  381 11949.1861 35667.6517   198%     -   89s
H    0     0                    11976.400779 35667.3336   198%     -   89s
H    0     0                    11976.717098 35667.3336   198%     -   89s
H    0     0                    12014.150931 35667.3336   197%     -   89s
H    0     0                    12016.479209 35667.3336   197%     -   89s
H    0     0                    12061.987482 35667.3336   196%     -   89s
     0     0 35226.6953    0  376 12061.9875 35226.6953   192%     -   94s
     0     0 34850.9940    0  386 12061.9875 34850.9940   189%     -   98s
     0     0 34654.3659    0  410 12061.9875 34654.3659   187%     -  102s
     0     0 34471.5703    0  403 12061.9875 34471.5703   186%     -  104s
     0     0 34450.3367    0  407 12061.9875 34450.3367   186%     -  105s
     0     0 34420.7800    0  405 12061.9875 34420.7800   185%     -  105s
     0     0 34372.9196    0  409 12061.9875 34372.9196   185%     -  107s
     0     0 34369.2076    0  402 12061.9875 34369.2076   185%     -  107s
     0     0 34365.1807    0  415 12061.9875 34365.1807   185%     -  108s
     0     0 34346.0952    0  421 12061.9875 34346.0952   185%     -  108s
     0     0 34338.5379    0  412 12061.9875 34338.5379   185%     -  109s
     0     0 34333.9485    0  416 12061.9875 34333.9485   185%     -  109s
     0     0 34332.9619    0  410 12061.9875 34332.9619   185%     -  110s
     0     0 33734.4130    0  437 12061.9875 33734.4130   180%     -  116s
     0     0 33601.6400    0  500 12061.9875 33601.6400   179%     -  119s
     0     0 33527.1228    0  439 12061.9875 33527.1228   178%     -  121s
     0     0 33480.5497    0  438 12061.9875 33480.5497   178%     -  122s
     0     0 33459.4794    0  495 12061.9875 33459.4794   177%     -  124s
     0     0 33446.1625    0  501 12061.9875 33446.1625   177%     -  125s
     0     0 33441.0616    0  496 12061.9875 33441.0616   177%     -  125s
     0     0 33434.8077    0  507 12061.9875 33434.8077   177%     -  126s
     0     0 33423.0628    0  503 12061.9875 33423.0628   177%     -  127s
     0     0 33416.2138    0  505 12061.9875 33416.2138   177%     -  127s
     0     0 33414.2363    0  509 12061.9875 33414.2363   177%     -  128s
     0     0 33412.5159    0  510 12061.9875 33412.5159   177%     -  128s
     0     0 33411.7970    0  504 12061.9875 33411.7970   177%     -  128s
     0     0 33264.2418    0  457 12061.9875 33264.2418   176%     -  132s
     0     0 33210.9418    0  453 12061.9875 33210.9418   175%     -  134s
     0     0 33203.6251    0  465 12061.9875 33203.6251   175%     -  134s
     0     0 33181.5058    0  469 12061.9875 33181.5058   175%     -  135s
     0     0 33176.5146    0  474 12061.9875 33176.5146   175%     -  136s
     0     0 33156.2991    0  466 12061.9875 33156.2991   175%     -  137s
     0     0 33154.8884    0  461 12061.9875 33154.8884   175%     -  137s
     0     0 33114.6130    0  463 12061.9875 33114.6130   175%     -  140s
H    0     0                    12963.231601 33114.0709   155%     -  142s
H    0     0                    13354.921613 33114.0709   148%     -  143s
     0     0 33052.2267    0  454 13354.9216 33052.2267   147%     -  145s
     0     0 33035.7721    0  454 13354.9216 33035.7721   147%     -  146s
     0     0 33026.2848    0  465 13354.9216 33026.2848   147%     -  147s
     0     0 33020.0010    0  465 13354.9216 33020.0010   147%     -  147s
     0     0 33017.4880    0  481 13354.9216 33017.4880   147%     -  148s
     0     0 33014.5246    0  472 13354.9216 33014.5246   147%     -  148s
     0     0 33013.8688    0  472 13354.9216 33013.8688   147%     -  149s
     0     0 32969.3329    0  481 13354.9216 32969.3329   147%     -  151s
H    0     0                    13368.572082 32967.5203   147%     -  151s
H    0     0                    13412.230902 32967.5203   146%     -  151s
     0     0 32955.2210    0  473 13412.2309 32955.2210   146%     -  153s
     0     0 32949.5927    0  473 13412.2309 32949.5927   146%     -  153s
     0     0 32942.5352    0  473 13412.2309 32942.5352   146%     -  153s
     0     0 32940.7875    0  473 13412.2309 32940.7875   146%     -  154s
     0     0 32940.1052    0  467 13412.2309 32940.1052   146%     -  154s
     0     0 32924.1621    0  464 13412.2309 32924.1621   145%     -  155s
H    0     0                    14449.403730 32924.0601   128%     -  158s
H    0     0                    14534.729896 32924.0601   127%     -  158s
H    0     0                    14706.314155 32924.0601   124%     -  158s
H    0     0                    14753.406925 32924.0601   123%     -  159s
H    0     0                    14762.295372 32924.0601   123%     -  159s
H    0     0                    15028.669580 32924.0601   119%     -  159s
     0     0 32918.9486    0  475 15028.6696 32918.9486   119%     -  159s
     0     0 32915.8295    0  467 15028.6696 32915.8295   119%     -  160s
     0     0 32915.1176    0  473 15028.6696 32915.1176   119%     -  160s
     0     0 32892.2491    0  468 15028.6696 32892.2491   119%     -  162s
     0     0 32887.1357    0  479 15028.6696 32887.1357   119%     -  163s
     0     0 32885.5809    0  478 15028.6696 32885.5809   119%     -  163s
     0     0 32860.1012    0  486 15028.6696 32860.1012   119%     -  165s
     0     0 32837.2688    0  485 15028.6696 32837.2688   118%     -  166s
     0     0 32835.0894    0  491 15028.6696 32835.0894   118%     -  166s
     0     0 32833.3934    0  496 15028.6696 32833.3934   118%     -  167s
     0     0 32833.0647    0  489 15028.6696 32833.0647   118%     -  167s
     0     0 32827.0250    0  491 15028.6696 32827.0250   118%     -  169s
     0     0 32822.6746    0  489 15028.6696 32822.6746   118%     -  170s
     0     0 32821.4766    0  491 15028.6696 32821.4766   118%     -  171s
     0     0 32814.7582    0  490 15028.6696 32814.7582   118%     -  172s
     0     0 32812.8777    0  498 15028.6696 32812.8777   118%     -  173s
     0     0 32809.3365    0  484 15028.6696 32809.3365   118%     -  174s
     0     0 32806.8814    0  493 15028.6696 32806.8814   118%     -  175s
     0     0 32805.0431    0  489 15028.6696 32805.0431   118%     -  175s
     0     0 32804.7649    0  493 15028.6696 32804.7649   118%     -  175s
     0     0 32802.0307    0  492 15028.6696 32802.0307   118%     -  177s
     0     0 32801.9598    0  492 15028.6696 32801.9598   118%     -  178s
H    0     0                    15320.833486 32801.9159   114%     -  221s
H    0     0                    15342.054923 32801.9159   114%     -  222s
H    0     0                    15572.334106 32801.9159   111%     -  227s
H    0     0                    15704.893437 32801.9159   109%     -  227s
H    0     0                    15722.756540 32801.9159   109%     -  230s
H    0     0                    15750.599409 32801.9159   108%     -  230s
H    0     0                    15806.363717 32801.9159   108%     -  233s
H    0     2                    16330.556383 32801.9159   101%     -  291s
     0     2 32801.9159    0  492 16330.5564 32801.9159   101%     -  291s
     1     4 32740.4363    1  468 16330.5564 32801.0636   101%  4596  296s
     3     8 32305.6697    2  515 16330.5564 32737.6086   100%  7285  307s
     7    16 32024.9164    3  469 16330.5564 32302.6534  97.8%  9338  316s
    15    32 31891.1020    4  475 16330.5564 32024.8444  96.1%  9248  327s
    31    48 29734.9584    5  570 16330.5564 31890.1302  95.3% 11849  346s
    47    80 28908.8255    6  284 16330.5564 31890.1302  95.3% 12997  353s
H   79   144                    16381.883720 31890.1302  94.7%  9455  393s
H  100   144                    17185.079059 31890.1302  85.6%  8114  393s
H  106   144                    17873.400730 31890.1302  78.4%  7804  393s
   143   268 28816.9105    9  253 17873.4007 31890.1302  78.4%  6791  405s
H  267   341                    19140.579398 31890.1302  66.6%  4889  412s
H  270   341                    19251.248859 31890.1302  65.7%  4891  412s
H  284   341                    19616.982243 31890.1302  62.6%  4772  412s
H  293   341                    19844.208121 31890.1302  60.7%  4718  412s
   344   400 28711.8759   10  260 19844.2081 31890.1302  60.7%  4564  421s
H  417   443                    19850.389674 31890.1302  60.7%  4396  430s
H  418   443                    20216.878648 31890.1302  57.7%  4408  430s
H  433   443                    20311.588444 31890.1302  57.0%  4339  430s
   476   497 26309.4203   12  225 20311.5884 31890.1302  57.0%  4331  438s
   547   544 27358.7657   13  229 20311.5884 31890.1302  57.0%  4329  448s
H  549   544                    20413.586932 31890.1302  56.2%  4335  448s
H  576   544                    20485.285746 31890.1302  55.7%  4280  448s
   610   600 26057.3402   13  208 20485.2857 31890.1302  55.7%  4296  456s
H  690   663                    20508.315460 31890.1302  55.5%  4155  463s
H  698   663                    20535.890572 31890.1302  55.3%  4174  463s
   780   715 26066.7031   15  203 20535.8906 31890.1302  55.3%  4037  472s
   873   746 25402.7315   16  196 20535.8906 31890.1302  55.3%  3998  481s
H  885   746                    20564.799034 31890.1302  55.1%  3985  481s
H  891   746                    20602.676488 31890.1302  54.8%  3985  481s
   914   787 25735.0541   17  192 20602.6765 31890.1302  54.8%  3977  490s
H 1011   821                    20644.483149 31890.1302  54.5%  3852  498s
H 1018   821                    20665.351614 31890.1302  54.3%  3884  498s
H 1037   821                    20728.033499 31890.1302  53.9%  3908  498s
  1083   882 21832.1942   17  177 20728.0335 31890.1302  53.9%  3862  507s
  1166   973     cutoff   19      20728.0335 31672.2609  52.8%  3849  514s
  1279  1058 21313.3427   20  197 20728.0335 31672.2609  52.8%  3811  525s
  1394  1144 21235.1408   20  149 20728.0335 31672.2609  52.8%  3740  534s
  1514  1207     cutoff   22      20728.0335 31672.2609  52.8%  3692  544s
  1635  1223 27114.3888   14  420 20728.0335 31672.2609  52.8%  3636  555s
H 1639  1223                    20781.604384 31672.2609  52.4%  3633  555s
H 1664  1223                    20843.274116 31672.2609  52.0%  3660  555s
  1679  1262 26739.8646   15  352 20843.2741 31672.2609  52.0%  3671  565s
  1793  1311 25940.9940   18  253 20843.2741 31672.2609  52.0%  3655  576s
  1894  1340 25269.7076   21  388 20843.2741 31672.2609  52.0%  3707  586s
  1953  1406 25221.2030   22  363 20843.2741 31672.2609  52.0%  3767  595s
  2063  1431 24600.7468   26  177 20843.2741 31308.0728  50.2%  3774  603s
  2102  1458 24508.0079   27  256 20843.2741 31306.7988  50.2%  3841  613s
H 2122  1458                    20854.729264 31306.7988  50.1%  3864  613s
H 2126  1458                    20857.922265 31306.7988  50.1%  3866  613s
  2153  1555 24447.0389   28  248 20857.9223 31306.7988  50.1%  3880  623s
  2288  1605     cutoff   37      20857.9223 31306.7988  50.1%  3902  635s
  2422  1620     cutoff   36      20857.9223 30306.8756  45.3%  3892  647s
H 2437  1620                    20862.950783 30306.8756  45.3%  3911  647s
  2467  1656 29603.3552    8  451 20862.9508 30306.8756  45.3%  3940  660s
  2615  1708 28251.0263    9  471 20862.9508 30306.8756  45.3%  3931  671s
  2743  1729 27861.0317   11  455 20862.9508 30306.8756  45.3%  3979  682s
  2786  1748 25229.2199   12  418 20862.9508 30306.8756  45.3%  4036  693s
  2836  1779 25140.5936   13  415 20862.9508 30144.3315  44.5%  4089  705s
H 2845  1779                    20864.231607 30144.3315  44.5%  4089  705s
  2879  1856     cutoff   14      20864.2316 30144.3315  44.5%  4135  717s
  3027  1941 23600.2471   15  442 20864.2316 29975.5864  43.7%  4185  732s
  3186  2016 22108.1971   17  291 20864.2316 29975.5864  43.7%  4225  744s
  3327  2028 21786.8224   20  355 20864.2316 29603.2645  41.9%  4261  758s
  3381  2055 21607.0431   21  395 20864.2316 29603.2645  41.9%  4311  773s
  3476  2098     cutoff   22      20864.2316 29494.0941  41.4%  4324  788s
  3615  2161 21378.4138   23  333 20864.2316 29278.0657  40.3%  4345  805s
  3752  2221 21021.0451   24  342 20864.2316 29278.0657  40.3%  4388  822s
  3926  2242 26264.6370   16  470 20864.2316 29142.4877  39.7%  4428  839s
  3967  2261 26195.7726   17  445 20864.2316 29142.4877  39.7%  4448  855s
  4024  2288 23806.3639   19  358 20864.2316 29097.1795  39.5%  4469  870s
  4155  2359 22521.5261   20  377 20864.2316 29077.3859  39.4%  4502  888s
  4328  2437 23738.2028   19  338 20864.2316 29010.6693  39.0%  4561  905s
  4533  2475     cutoff   20      20864.2316 28990.9839  39.0%  4597  921s
  4647  2566 21227.0242   21  260 20864.2316 28990.9839  39.0%  4624  940s
  4836  2737 21131.5192   34  140 20864.2316 28874.8204  38.4%  4634  958s
  5139  2738 22598.7971   35  492 20864.2316 28874.8204  38.4%  4582 1021s
  5141  2739 22713.0794   21  165 20864.2316 28874.8204  38.4%  4580 1075s
  5142  2740 21958.1757   48  391 20864.2316 28874.8204  38.4%  4579 1092s
  5143  2741 23069.2659   26  415 20864.2316 28874.8204  38.4%  4578 1109s
  5144  2741 23769.6118   22  409 20864.2316 28874.8204  38.4%  4578 1120s
  5145  2742 21829.6005   34  522 20864.2316 28874.8204  38.4%  4577 1126s
  5146  2743 22630.6300   46  494 20864.2316 28874.8204  38.4%  4576 1130s
  5148  2744 21283.5262   41  513 20864.2316 28874.8204  38.4%  4574 1136s
  5150  2745 23832.0497   26  471 20864.2316 28874.8204  38.4%  4572 1140s
  5153  2747 26594.3945   12  565 20864.2316 28874.8204  38.4%  4570 1151s
  5155  2749 23613.3503   31  573 20864.2316 28874.8204  38.4%  4568 1159s
  5156  2749 21332.7461   55  479 20864.2316 28874.8204  38.4%  4567 1161s
  5158  2751 24888.8965   14  469 20864.2316 28874.8204  38.4%  4565 1168s
  5159  2751 27912.4150    8  528 20864.2316 28874.8204  38.4%  4564 1171s
  5161  2753 22670.6016   39  503 20864.2316 28874.8204  38.4%  4562 1175s
  5163  2754 22718.2301   25  500 20864.2316 28874.8204  38.4%  4561 1182s
  5164  2755 23809.4331   22  502 20864.2316 28874.8204  38.4%  4560 1187s
  5165  2755 25729.2645   16  511 20864.2316 28874.8204  38.4%  4559 1190s
  5167  2757 23650.7497   19  487 20864.2316 28874.8204  38.4%  4557 1197s
  5168  2757 26407.5688   18  493 20864.2316 28874.8204  38.4%  4556 1200s
  5170  2759 24013.1709   21  492 20864.2316 28874.8204  38.4%  4555 1207s
  5171  2759 24084.0437   16  492 20864.2316 28874.8204  38.4%  4554 1250s
  5172  2760 25618.1775   21  492 20864.2316 28874.8204  38.4%  4553 1294s
  5173  2763 28874.8204   10  447 20864.2316 28874.8204  38.4%  4597 1310s
  5174  2765 28655.1898   11  296 20864.2316 28874.8204  38.4%  4598 1319s
  5177  2770 28221.0729   12  292 20864.2316 28874.8204  38.4%  4598 1330s
  5183  2780 26951.7027   13  283 20864.2316 28874.8204  38.4%  4601 1338s
  5195  2789 28874.8204   14  513 20864.2316 28874.8204  38.4%  4617 1357s
  5208  2817 28309.1430   14  302 20864.2316 28874.8204  38.4%  4630 1391s
  5240  2916 27667.1115   15  301 20864.2316 28874.8204  38.4%  4696 1407s
  5358  2927 26616.7673   17  296 20864.2316 28874.8204  38.4%  4692 1416s
  5424  2950 24597.3579   20  295 20864.2316 28874.8204  38.4%  4699 1425s
  5477  2965 21824.8887   19  304 20864.2316 28874.8204  38.4%  4715 1433s
  5521  2982     cutoff   18      20864.2316 28874.8204  38.4%  4723 1444s
  5580  3000 23518.6397   21  307 20864.2316 28874.8204  38.4%  4739 1451s
  5628  3018     cutoff   20      20864.2316 28874.8204  38.4%  4746 1461s
  5709  3030 21170.4824   22  304 20864.2316 28874.8204  38.4%  4739 1469s
  5774  3038 22491.3497   22  218 20864.2316 28874.8204  38.4%  4734 1485s
  5850  3026 infeasible   23      20864.2316 28874.8204  38.4%  4709 1494s
  5920  3029 22260.6598   23  211 20864.2316 28874.8204  38.4%  4712 1504s
  5975  3036     cutoff   23      20864.2316 28874.8204  38.4%  4725 1513s
  6029  3037 21274.3183   26  186 20864.2316 28874.8204  38.4%  4737 1522s
  6062  3047 21267.2459   27  184 20864.2316 28874.8204  38.4%  4746 1533s
  6115  3039     cutoff   28      20864.2316 28874.8204  38.4%  4750 1545s
  6176  3045 26860.8860   18  506 20864.2316 28874.8204  38.4%  4756 1562s
  6218  3045 25984.9220   18  500 20864.2316 28874.8204  38.4%  4782 1572s
  6276  3041 21025.8091   25  353 20864.2316 28874.8204  38.4%  4805 1582s
  6329  3034 26189.2152   19  505 20864.2316 28874.8204  38.4%  4813 1592s
  6385  3031 24310.8863   19  459 20864.2316 28874.8204  38.4%  4826 1602s
  6456  3033 26118.4756   20  464 20864.2316 28874.8204  38.4%  4834 1613s
  6525  3043 25752.2495   21  453 20864.2316 28874.8204  38.4%  4842 1625s
  6614  3063 25477.5971   22  428 20864.2316 28874.8204  38.4%  4840 1643s
  6709  3065 23881.3335   22  294 20864.2316 28017.8336  34.3%  4831 1656s
  6816  3052 24981.3232   23  520 20864.2316 27844.2653  33.5%  4837 1668s
  6936  3035 24776.8683   24  461 20864.2316 27844.2653  33.5%  4825 1682s
  7040  3035 24152.2786   26  376 20864.2316 27455.5929  31.6%  4826 1697s
  7168  3027     cutoff   28      20864.2316 27455.5929  31.6%  4808 1712s
  7290  3002     cutoff   30      20864.2316 27455.5342  31.6%  4801 1726s
  7377  3016     cutoff   31      20864.2316 27455.5342  31.6%  4802 1739s
  7476  3039     cutoff   29      20864.2316 27455.5342  31.6%  4802 1756s
  7607  3036 23014.7188   27  351 20864.2316 27455.5342  31.6%  4793 1772s
  7780  3035     cutoff   29      20864.2316 27455.5342  31.6%  4765 1790s
  7934  3046     cutoff   24      20864.2316 26949.9197  29.2%  4760 1809s
  8113  3050 24585.9088   19  413 20864.2316 26857.3971  28.7%  4741 1834s
  8337  3050 21810.2397   22  126 20864.2316 26857.3971  28.7%  4700 1852s
  8502  3061 23594.8425   24  349 20864.2316 26630.9464  27.6%  4709 1870s
  8709  3046     cutoff   28      20864.2316 26573.7972  27.4%  4685 1893s
  8861  3088     cutoff   27      20864.2316 26454.1908  26.8%  4669 1913s
  9054  3084     cutoff   24      20864.2316 26454.1908  26.8%  4653 1933s
  9270  3082 21950.4898   22  383 20864.2316 26454.1908  26.8%  4632 1954s
  9509  3021 20940.8644   28  308 20864.2316 26204.0128  25.6%  4624 1976s
  9608  3080 20935.2866   29  309 20864.2316 26184.6812  25.5%  4626 1998s
  9822  3054 24436.2404   19  304 20864.2316 26137.3959  25.3%  4625 2021s
 10085  3017 21196.5713   22  214 20864.2316 26091.6181  25.1%  4628 2043s
 10321  3010 22029.7362   26  158 20864.2316 25981.7979  24.5%  4643 2067s
 10606  3021 23608.9909   23  331 20864.2316 25957.6253  24.4%  4643 2093s
H10623  2821                    21189.592516 25957.6253  22.5%  4642 2093s
 10944  2771     cutoff   32      21189.5925 25957.6253  22.5%  4630 2120s
 11265  2678     cutoff   26      21189.5925 25925.6382  22.4%  4632 2149s
 11593  2595     cutoff   23      21189.5925 25364.6720  19.7%  4637 2178s
 11909  2540 infeasible   22      21189.5925 25074.8128  18.3%  4653 2211s
 12265  2419 21256.3021   22  197 21189.5925 24928.7855  17.6%  4653 2242s
H12281  2232                    21277.423534 24928.7855  17.2%  4649 2242s
 12650  2112     cutoff   28      21277.4235 24891.0975  17.0%  4648 2273s
H12736  2092                    21308.131692 24891.0975  16.8%  4641 2273s
H12841  2078                    21329.592371 24775.2787  16.2%  4645 2273s
 13033  2069     cutoff   26      21329.5924 24643.5535  15.5%  4641 2305s
 13448  2089     cutoff   25      21329.5924 24457.0337  14.7%  4647 2339s
 13867  2037 21506.3767   27  136 21329.5924 24349.4723  14.2%  4641 2373s
 14398  2028     cutoff   27      21329.5924 24192.1458  13.4%  4627 2408s
 14844  2022     cutoff   29      21329.5924 23917.6528  12.1%  4611 2441s
 14920  1954 22211.5299   31  198 21329.5924 23841.6105  11.8%  4617 2480s
 15259  1874     cutoff   30      21329.5924 23763.6190  11.4%  4602 2518s
 15802  1668 21759.7791   48  128 21329.5924 23564.5802  10.5%  4577 2556s
 16669  1184     cutoff   23      21329.5924 23313.6425  9.30%  4482 2596s
 18133   143 22467.4267   30  228 21329.5924 22811.4864  6.95%  4246 2629s
 20091     0 infeasible   23      21329.5924 22238.5454  4.26%  3912 2635s

Cutting planes:
  MIR: 753
  Mixing: 4
  Flow cover: 2085
  RLT: 28
  Relax-and-lift: 261

Explored 20289 nodes (78962627 simplex iterations) in 2635.92 seconds (8625.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21329.6 21308.1 21277.4 ... 20781.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.132959237091e+04, best bound 2.132959237091e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2635.95s
  Master Objective (UB) = 21329.59, θ = 151470.45
  Upper Bound (UB) = 21329.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151470.45
  [DEBUG]   ✓ Scenario 0: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151470.45 ≤ Q = 151470.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6976bd91
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6976bd91
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-09, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-11, 2e+02]
Found heuristic solution: objective 1.548810e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8235899.8806
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.408046e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140804.59    0  124 8235899.88 -140804.59   102%     -    0s
H    0     0                    -105872.7561 -140804.59  33.0%     -    0s
H    0     0                    -106370.7835 -140804.59  32.4%     -    0s
     0     0 -110487.16    0   72 -106370.78 -110487.16  3.87%     -    0s
H    0     0                    -109583.7456 -110430.53  0.77%     -    0s
     0     0 -110167.80    0   38 -109583.75 -110167.80  0.53%     -    0s
     0     0 -110059.26    0   37 -109583.75 -110059.26  0.43%     -    0s
H    0     0                    -109604.7526 -110059.26  0.41%     -    0s
     0     0 -110059.26    0   35 -109604.75 -110059.26  0.41%     -    0s
     0     0 -110059.26    0   34 -109604.75 -110059.26  0.41%     -    0s
     0     0 -109868.39    0   18 -109604.75 -109868.39  0.24%     -    0s
     0     0 -109852.09    0   15 -109604.75 -109852.09  0.23%     -    0s
H    0     0                    -109606.8212 -109852.09  0.22%     -    0s
     0     0 -109841.07    0   15 -109606.82 -109841.07  0.21%     -    0s
     0     0 -109695.06    0   13 -109606.82 -109695.06  0.08%     -    0s
     0     0 -109689.40    0   11 -109606.82 -109689.40  0.08%     -    0s
     0     0 -109685.44    0   11 -109606.82 -109685.44  0.07%     -    0s
     0     0 -109685.41    0   10 -109606.82 -109685.41  0.07%     -    0s
H    0     0                    -109621.2457 -109685.40  0.06%     -    0s
     0     0 -109654.43    0    8 -109621.25 -109654.43  0.03%     -    0s
     0     0 -109643.64    0    4 -109621.25 -109643.64  0.02%     -    0s
     0     0 -109643.64    0   10 -109621.25 -109643.64  0.02%     -    0s
H    0     0                    -109634.9467 -109634.95  0.00%     -    0s
     0     0          -    0      -109634.95 -109634.95  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 7
  Flow cover: 3
  RLT: 1
  PSD: 2

Explored 1 nodes (601 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -109635 -109621 -109607 ... 1.54881e+13
No other solutions better than -109635

Optimal solution found (tolerance 1.00e-04)
Best objective -1.096349467109e+05, best bound -1.096349467109e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 151096.97
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109634.95
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -109634.95 = 151096.97
  [DEBUG]   Current θ from Master = 151470.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 373.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20956.11
  Lower Bound (LB) = 20956.11
  Gap (UB-LB) = 373.4840, Absolute Gap = 373.4840, Relative Gap = 0.017510
  Not converged yet (gap = 373.48 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394733 nonzeros
Model fingerprint: 0x3ebc3d03
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 59185 rows and 24035 columns
Presolve time: 1.10s
Presolved: 79808 rows, 34385 columns, 488420 nonzeros
Variable types: 32126 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 79808 rows, 34385 columns, 488420 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35502   -7.7418489e+04   0.000000e+00   4.560459e+08      5s
   52153    1.4451356e+04   0.000000e+00   5.986966e+06     10s
   61848    2.5503794e+04   0.000000e+00   1.134115e+07     15s
   68822    2.8111909e+04   0.000000e+00   9.397553e+05     20s
Concurrent spin time: 2.27s

Solved with dual simplex

Root relaxation: objective 4.961551e+04, 53469 iterations, 23.80 seconds (50.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49615.5145    0  178 -194556.81 49615.5145   126%     -   25s
H    0     0                    -178389.3811 49615.5145   128%     -   25s
H    0     0                    -119406.0258 49615.5145   142%     -   25s
H    0     0                    -80430.86945 49615.5145   162%     -   25s
H    0     0                    -80119.20513 49615.5145   162%     -   25s
H    0     0                    -42459.53613 49615.5145   217%     -   25s
H    0     0                    1500.8338156 49615.5145  3206%     -   26s
H    0     0                    9370.2667727 49615.5145   429%     -   26s
H    0     0                    12393.750928 49615.5145   300%     -   26s
H    0     0                    13808.848014 49615.5145   259%     -   26s
H    0     0                    19270.339373 49615.5145   157%     -   26s
H    0     0                    19411.218338 44091.0375   127%     -   35s
     0     0 44015.6797    0  271 19411.2183 44015.6797   127%     -   35s
     0     0 43847.1227    0  283 19411.2183 43847.1227   126%     -   39s
     0     0 43847.0600    0  280 19411.2183 43847.0600   126%     -   41s
     0     0 43847.0600    0  284 19411.2183 43847.0600   126%     -   42s
     0     0 43847.0600    0  288 19411.2183 43847.0600   126%     -   42s
     0     0 43847.0600    0  288 19411.2183 43847.0600   126%     -   42s
H    0     0                    19442.058997 40336.6286   107%     -   55s
     0     0 40336.6286    0  427 19442.0590 40336.6286   107%     -   55s
H    0     0                    19647.912086 40336.5602   105%     -   55s
H    0     0                    19666.214783 40336.5602   105%     -   55s
H    0     0                    19681.802078 40336.5602   105%     -   55s
H    0     0                    19694.955568 40336.5602   105%     -   55s
     0     0 39553.4806    0  399 19694.9556 39553.4806   101%     -   63s
     0     0 39200.8463    0  361 19694.9556 39200.8463  99.0%     -   68s
     0     0 39161.2102    0  379 19694.9556 39161.2102  98.8%     -   71s
     0     0 39144.2766    0  374 19694.9556 39144.2766  98.8%     -   72s
     0     0 39128.2626    0  419 19694.9556 39128.2626  98.7%     -   74s
     0     0 39101.3777    0  403 19694.9556 39101.3777  98.5%     -   75s
     0     0 39097.5102    0  409 19694.9556 39097.5102  98.5%     -   75s
     0     0 39094.6190    0  415 19694.9556 39094.6190  98.5%     -   76s
     0     0 38859.1284    0  427 19694.9556 38859.1284  97.3%     -   79s
     0     0 38844.1848    0  389 19694.9556 38844.1848  97.2%     -   80s
     0     0 38843.4207    0  390 19694.9556 38843.4207  97.2%     -   81s
H    0     0                    19696.146683 38843.4207  97.2%     -   86s
H    0     0                    19805.109912 38843.4207  96.1%     -   86s
H    0     0                    19927.041260 38843.4207  94.9%     -   86s
H    0     0                    19951.331421 38843.4207  94.7%     -   86s
H    0     0                    19951.666681 38843.4207  94.7%     -   86s
H    0     0                    19990.519722 36293.9966  81.6%     -  100s
H    0     0                    20008.619897 36293.9966  81.4%     -  100s
H    0     0                    20044.783232 36293.9966  81.1%     -  100s
H    0     0                    20045.499840 36293.9966  81.1%     -  100s
H    0     0                    20046.008557 36293.9966  81.1%     -  100s
     0     0 36293.9966    0  368 20046.0086 36293.9966  81.1%     -  100s
H    0     0                    20360.732221 35574.2873  74.7%     -  111s
     0     0 35574.2873    0  485 20360.7322 35574.2873  74.7%     -  111s
     0     0 35284.3335    0  481 20360.7322 35284.3335  73.3%     -  115s
     0     0 35184.5337    0  495 20360.7322 35184.5337  72.8%     -  118s
     0     0 35158.5721    0  487 20360.7322 35158.5721  72.7%     -  119s
     0     0 35125.1883    0  490 20360.7322 35125.1883  72.5%     -  121s
     0     0 34943.3036    0  493 20360.7322 34943.3036  71.6%     -  124s
     0     0 34926.2244    0  500 20360.7322 34926.2244  71.5%     -  125s
     0     0 34881.2861    0  524 20360.7322 34881.2861  71.3%     -  128s
     0     0 34869.9512    0  512 20360.7322 34869.9512  71.3%     -  129s
     0     0 34795.9608    0  497 20360.7322 34795.9608  70.9%     -  133s
     0     0 34778.6853    0  497 20360.7322 34778.6853  70.8%     -  135s
     0     0 34762.1568    0  511 20360.7322 34762.1568  70.7%     -  137s
     0     0 34755.3960    0  515 20360.7322 34755.3960  70.7%     -  139s
     0     0 34750.1754    0  513 20360.7322 34750.1754  70.7%     -  140s
     0     0 34748.9611    0  518 20360.7322 34748.9611  70.7%     -  141s
H    0     0                    20383.108761 33969.4576  66.7%     -  153s
H    0     0                    20431.158628 33969.4576  66.3%     -  153s
H    0     0                    20437.624694 33969.4576  66.2%     -  153s
H    0     0                    20450.274172 33969.4576  66.1%     -  153s
H    0     0                    20451.846551 33969.4576  66.1%     -  153s
     0     0 33969.4576    0  430 20451.8466 33969.4576  66.1%     -  153s
H    0     0                    20504.343339 33968.8668  65.7%     -  154s
     0     0 33771.4804    0  439 20504.3433 33771.4804  64.7%     -  157s
     0     0 33678.2107    0  450 20504.3433 33678.2107  64.2%     -  159s
     0     0 33648.2800    0  450 20504.3433 33648.2800  64.1%     -  160s
     0     0 33626.8407    0  493 20504.3433 33626.8407  64.0%     -  162s
     0     0 33611.1349    0  443 20504.3433 33611.1349  63.9%     -  163s
     0     0 33598.6101    0  439 20504.3433 33598.6101  63.9%     -  163s
     0     0 33587.6590    0  451 20504.3433 33587.6590  63.8%     -  164s
     0     0 33566.0075    0  448 20504.3433 33566.0075  63.7%     -  165s
     0     0 33552.0448    0  447 20504.3433 33552.0448  63.6%     -  166s
     0     0 33549.7438    0  446 20504.3433 33549.7438  63.6%     -  166s
H    0     0                    20538.230066 33379.5489  62.5%     -  171s
H    0     0                    20559.601722 33379.5489  62.4%     -  171s
     0     0 33379.5489    0  437 20559.6017 33379.5489  62.4%     -  171s
H    0     0                    20587.562839 33379.2371  62.1%     -  171s
     0     0 33319.5943    0  452 20587.5628 33319.5943  61.8%     -  173s
H    0     0                    20599.580840 33300.3427  61.7%     -  174s
H    0     0                    20644.736414 33300.3427  61.3%     -  174s
H    0     0                    20666.540394 33300.3427  61.1%     -  174s
     0     0 33300.3427    0  464 20666.5404 33300.3427  61.1%     -  174s
H    0     0                    20666.762662 33291.8700  61.1%     -  175s
     0     0 33291.8700    0  465 20666.7627 33291.8700  61.1%     -  175s
H    0     0                    20704.920377 33290.2016  60.8%     -  176s
     0     0 33290.2016    0  464 20704.9204 33290.2016  60.8%     -  176s
     0     0 33219.7316    0  513 20704.9204 33219.7316  60.4%     -  180s
     0     0 33200.0680    0  521 20704.9204 33200.0680  60.3%     -  182s
     0     0 33181.0271    0  523 20704.9204 33181.0271  60.3%     -  183s
     0     0 33177.7372    0  526 20704.9204 33177.7372  60.2%     -  184s
     0     0 33176.2392    0  530 20704.9204 33176.2392  60.2%     -  184s
     0     0 33136.2830    0  450 20704.9204 33136.2830  60.0%     -  187s
     0     0 33120.4581    0  535 20704.9204 33120.4581  60.0%     -  189s
     0     0 33119.1216    0  534 20704.9204 33119.1216  60.0%     -  189s
     0     0 33055.5081    0  578 20704.9204 33055.5081  59.7%     -  192s
H    0     0                    20729.452933 33055.3720  59.5%     -  193s
H    0     0                    20778.718788 33055.3720  59.1%     -  193s
     0     0 33033.2822    0  516 20778.7188 33033.2822  59.0%     -  195s
     0     0 33021.1787    0  584 20778.7188 33021.1787  58.9%     -  195s
     0     0 32998.0558    0  525 20778.7188 32998.0558  58.8%     -  197s
     0     0 32997.1915    0  529 20778.7188 32997.1915  58.8%     -  197s
     0     0 32953.0147    0  573 20778.7188 32953.0147  58.6%     -  200s
     0     0 32945.5638    0  566 20778.7188 32945.5638  58.6%     -  201s
     0     0 32942.7790    0  566 20778.7188 32942.7790  58.5%     -  202s
     0     0 32941.0333    0  575 20778.7188 32941.0333  58.5%     -  202s
     0     0 32925.8737    0  448 20778.7188 32925.8737  58.5%     -  204s
H    0     0                    20814.683554 32925.6203  58.2%     -  206s
H    0     0                    20847.457917 32925.6203  57.9%     -  206s
     0     0 32922.0124    0  447 20847.4579 32922.0124  57.9%     -  207s
     0     0 32908.4704    0  510 20847.4579 32908.4704  57.9%     -  207s
     0     0 32907.6254    0  450 20847.4579 32907.6254  57.8%     -  208s
     0     0 32869.6412    0  453 20847.4579 32869.6412  57.7%     -  210s
H    0     0                    20855.586996 32868.7126  57.6%     -  211s
H    0     0                    20903.141484 32868.7126  57.2%     -  211s
     0     0 32863.1642    0  462 20903.1415 32863.1642  57.2%     -  211s
     0     0 32856.0406    0  457 20903.1415 32856.0406  57.2%     -  212s
     0     0 32854.8394    0  459 20903.1415 32854.8394  57.2%     -  212s
     0     0 32839.0050    0  525 20903.1415 32839.0050  57.1%     -  214s
     0     0 32824.0472    0  463 20903.1415 32824.0472  57.0%     -  217s
     0     0 32822.6385    0  471 20903.1415 32822.6385  57.0%     -  217s
     0     0 32805.9771    0  469 20903.1415 32805.9771  56.9%     -  219s
     0     0 32802.7835    0  465 20903.1415 32802.7835  56.9%     -  220s
     0     0 32802.3830    0  464 20903.1415 32802.3830  56.9%     -  220s
     0     0 32800.8740    0  466 20903.1415 32800.8740  56.9%     -  221s
     0     0 32800.2783    0  463 20903.1415 32800.2783  56.9%     -  223s
     0     0 32776.0086    0  450 20903.1415 32776.0086  56.8%     -  225s
     0     0 32771.1512    0  456 20903.1415 32771.1512  56.8%     -  226s
     0     0 32770.4982    0  457 20903.1415 32770.4982  56.8%     -  227s
     0     0 32766.1863    0  460 20903.1415 32766.1863  56.8%     -  228s
     0     0 32766.1174    0  460 20903.1415 32766.1174  56.8%     -  230s
H    0     2                    20909.843214 32766.0235  56.7%     -  291s
     0     2 32766.0235    0  460 20909.8432 32766.0235  56.7%     -  291s
     1     4 32319.5347    1  452 20909.8432 32762.0144  56.7%  6376  297s
     3     8 31699.8525    2  457 20909.8432 32315.2976  54.5%  7769  306s
     7    16 31637.5330    3  463 20909.8432 31694.2849  51.6%  9304  315s
    15    32 31497.5129    4  460 20909.8432 31637.2767  51.3%  9029  327s
    31    48 30964.0427    5  527 20909.8432 31497.3624  50.6% 12598  354s
    47    80 29239.6387    6  427 20909.8432 31497.3624  50.6% 11810  369s
H   49    80                    20921.542095 31497.3624  50.5% 11502  369s
H   58    80                    20924.812769 31497.3624  50.5% 11060  369s
    79   228 29234.6772    7  420 20924.8128 31497.3624  50.5%  9524  385s
   227   297 28815.0357   10  358 20924.8128 31497.3624  50.5%  5417  395s
   296   349 27674.6337   12  389 20924.8128 31497.3624  50.5%  4831  410s
   348   405 27804.4498   12  293 20924.8128 31497.3624  50.5%  4604  419s
   404   435 28169.3167   11  407 20924.8128 31497.3624  50.5%  4628  431s
   434   484 28234.2539   11  412 20924.8128 31497.3624  50.5%  4686  443s
   485   548 26963.2988   13  413 20924.8128 31497.3624  50.5%  4684  455s
   575   617 26774.8164   13  296 20924.8128 31497.3624  50.5%  4402  465s
   660   671 27324.9384   13  456 20924.8128 31497.3624  50.5%  4254  472s
   736   731 26579.3804   12  346 20924.8128 31497.3624  50.5%  4302  481s
   814   783 27136.8616   12  360 20924.8128 31497.3624  50.5%  4292  489s
   901   837 26748.2145   14  406 20924.8128 31497.3624  50.5%  4276  497s
   985   890 26597.1878   14  400 20924.8128 31497.3624  50.5%  4233  506s
  1076   911 23365.0871   14  228 20924.8128 31497.3624  50.5%  4196  515s
  1123   930 26318.4270   14  307 20924.8128 31497.3624  50.5%  4177  525s
  1188   985 26276.9148   15  398 20924.8128 31497.3624  50.5%  4159  535s
  1261  1062 26159.1299   16  325 20924.8128 31497.3624  50.5%  4146  545s
  1361  1116 25896.8206   18  315 20924.8128 31497.3624  50.5%  4102  556s
  1445  1171 25524.5379   21  308 20924.8128 31497.3624  50.5%  4106  567s
  1551  1217 25417.9536   22  438 20924.8128 31497.3624  50.5%  4065  578s
  1647  1256 25179.7895   24  373 20924.8128 31497.3624  50.5%  4032  589s
  1742  1309 24994.8105   25  313 20924.8128 31352.0690  49.8%  4077  600s
  1837  1375 24354.6957   27  473 20924.8128 31352.0690  49.8%  4133  611s
  1938  1445 24790.3565   29  381 20924.8128 31067.1988  48.5%  4189  623s
  2040  1528 24705.9258   33  426 20924.8128 31067.1988  48.5%  4248  634s
  2147  1551 24512.2403   32  385 20924.8128 30478.8106  45.7%  4286  642s
  2188  1589 24365.9008   35  414 20924.8128 30478.8106  45.7%  4312  656s
  2254  1670 24174.7349   34  429 20924.8128 30478.8106  45.7%  4347  668s
  2343  1793 24210.2410   34  419 20924.8128 30478.8106  45.7%  4375  680s
  2503  1960 23676.7304   35  278 20924.8128 30349.4217  45.0%  4322  692s
  2680  2094 23824.7574   39  291 20924.8128 30349.4217  45.0%  4275  708s
  2879  2223 23554.3240   44  275 20924.8128 30329.2205  44.9%  4226  724s
  3074  2311 23013.3067   49  178 20924.8128 30329.2205  44.9%  4161  740s
  3231  2422 21695.8163   50  193 20924.8128 30329.2205  44.9%  4167  757s
  3422  2515 22754.2763   58  347 20924.8128 30190.2944  44.3%  4156  771s
  3583  2597 22191.0028   64  262 20924.8128 29817.6318  42.5%  4187  786s
  3716  2626 infeasible   39      20924.8128 29817.6318  42.5%  4151  800s
H 3740  2626                    20928.214576 29817.6318  42.5%  4165  800s
  3755  2771 27375.8329    7  563 20928.2146 29817.6318  42.5%  4174  818s
  3975  2772 21384.0635   41  460 20928.2146 29817.6318  42.5%  4153  888s
  3977  2773 23380.1490   39  150 20928.2146 29817.6318  42.5%  4151  920s
  3978  2774 25441.8605   15  365 20928.2146 29817.6318  42.5%  4149  945s
  3979  2775 23308.4727   30  491 20928.2146 29817.6318  42.5%  4148  962s
  3980  2775 24671.6751   27  474 20928.2146 29817.6318  42.5%  4147  973s
  3981  2776 23946.1030   39  472 20928.2146 29817.6318  42.5%  4146  980s
  3982  2777 22205.1301   60  509 20928.2146 29817.6318  42.5%  4145  985s
  3984  2778 25417.8602   21  460 20928.2146 29817.6318  42.5%  4143  993s
  3985  2779 23806.4347   25  458 20928.2146 29817.6318  42.5%  4142  997s
  3986  2779 22311.3173   52  533 20928.2146 29817.6318  42.5%  4141 1000s
  3989  2781 28036.6772   10  464 20928.2146 29817.6318  42.5%  4138 1007s
  3990  2782 25973.6809   21  479 20928.2146 29817.6318  42.5%  4137 1012s
  3992  2783 21626.4756   53  423 20928.2146 29817.6318  42.5%  4135 1015s
  3995  2785 22553.1129   45  532 20928.2146 29817.6318  42.5%  4132 1024s
  3996  2786 23652.8069   87  474 20928.2146 29817.6318  42.5%  4131 1026s
  3998  2787 22050.0892   51  467 20928.2146 29817.6318  42.5%  4129 1034s
  3999  2788 22720.3778   41  561 20928.2146 29817.6318  42.5%  4128 1038s
  4000  2789 24441.6940   31  445 20928.2146 29817.6318  42.5%  4127 1044s
  4001  2789 27376.7929   13  461 20928.2146 29817.6318  42.5%  4126 1046s
  4003  2791 21900.7393   46  456 20928.2146 29817.6318  42.5%  4124 1053s
  4004  2791 23111.7241   37  456 20928.2146 29817.6318  42.5%  4123 1055s
  4005  2792 23803.6847   34  467 20928.2146 29817.6318  42.5%  4121 1060s
  4007  2793 23479.4734   47  451 20928.2146 29817.6318  42.5%  4119 1066s
  4009  2795 22123.3985   11  466 20928.2146 29817.6318  42.5%  4117 1073s
  4010  2795 25638.6442   30  466 20928.2146 29817.6318  42.5%  4116 1107s
  4011  2796 24096.3895   71  466 20928.2146 29817.6318  42.5%  4115 1156s
  4012  2800 29817.6318   15  433 20928.2146 29817.6318  42.5%  4177 1177s
  4014  2803 29817.6318   16  458 20928.2146 29817.6318  42.5%  4179 1185s
  4018  2810 29817.6318   17  491 20928.2146 29817.6318  42.5%  4183 1206s
  4026  2823 29817.6318   18  511 20928.2146 29817.6318  42.5%  4191 1218s
  4042  2834 29817.6318   19  581 20928.2146 29817.6318  42.5%  4243 1247s
  4058  2859 27910.9995   20  420 20928.2146 29817.6318  42.5%  4252 1267s
  4089  2902 28262.9230   21  435 20928.2146 29817.6318  42.5%  4321 1287s
  4161  2940 27476.7524   23  357 20928.2146 29817.6318  42.5%  4380 1308s
  4270  2942 25772.3539   25  244 20928.2146 29817.6318  42.5%  4360 1324s
  4357  2931 25647.3829   26  297 20928.2146 29817.6318  42.5%  4331 1347s
  4393  2941 25517.8332   27  229 20928.2146 29817.6318  42.5%  4322 1367s
  4435  2938 23846.3510   28  198 20928.2146 29817.6318  42.5%  4325 1381s
  4485  2936 23812.5461   29  195 20928.2146 29817.6318  42.5%  4319 1392s
  4529  2933 23525.7851   30  184 20928.2146 29817.6318  42.5%  4298 1403s
  4573  2941 23420.3472   31  186 20928.2146 29817.6318  42.5%  4284 1413s
  4615  2945 23231.8529   32  256 20928.2146 29817.6318  42.5%  4276 1429s
  4661  2943 22964.1400   33  252 20928.2146 29817.6318  42.5%  4267 1441s
  4706  2946 22811.9332   34  250 20928.2146 29817.6318  42.5%  4261 1451s
  4755  2944 22730.1511   35  184 20928.2146 29817.6318  42.5%  4252 1463s
  4813  2939 22641.8232   36  185 20928.2146 29817.6318  42.5%  4230 1473s
  4852  2943 22138.3071   37  190 20928.2146 29817.6318  42.5%  4221 1485s
  4892  2955 21474.3322   38  193 20928.2146 29817.6318  42.5%  4220 1497s
  4940  2950 21299.2107   39  190 20928.2146 29817.6318  42.5%  4211 1508s
  4985  2950     cutoff   40      20928.2146 29817.6318  42.5%  4196 1540s
  5023  2949 21482.6359   39  293 20928.2146 29817.6318  42.5%  4189 1552s
  5063  2947 21410.1454   40  277 20928.2146 29817.6318  42.5%  4183 1568s
  5099  2956 21369.6323   41  280 20928.2146 29817.6318  42.5%  4181 1580s
  5146  2965 21257.4660   42  288 20928.2146 29817.6318  42.5%  4173 1595s
  5183  2996 21125.5990   43  247 20928.2146 29817.6318  42.5%  4170 1606s
  5239  3005     cutoff   45      20928.2146 29698.1105  41.9%  4161 1622s
  5316  3022 24221.6259   29  320 20928.2146 29698.1105  41.9%  4145 1638s
  5402  3037 26017.6679   22  454 20928.2146 29698.1105  41.9%  4128 1655s
  5512  3055 25666.2321   23  295 20928.2146 29698.1105  41.9%  4110 1670s
  5607  3076 25315.9977   25  474 20928.2146 29698.1105  41.9%  4104 1693s
  5727  3080 24599.5363   25  272 20928.2146 29698.1105  41.9%  4083 1713s
  5830  3099 24783.0020   27  395 20928.2146 29698.1105  41.9%  4068 1734s
  5948  3100 23682.6647   27  170 20928.2146 29698.1105  41.9%  4060 1755s
  6082  3078 22862.8084   29  281 20928.2146 29698.1105  41.9%  4044 1771s
  6121  3091     cutoff   30      20928.2146 29698.1105  41.9%  4047 1787s
  6159  3090 22722.0406   30  211 20928.2146 29698.1105  41.9%  4052 1804s
  6209  3091 21314.0331   29  361 20928.2146 28782.3736  37.5%  4056 1825s
  6290  3120 22685.6809   31  210 20928.2146 28761.5177  37.4%  4048 1847s
  6424  3134     cutoff   33      20928.2146 28761.5177  37.4%  4023 1871s
  6593  3139 21822.1712   34  167 20928.2146 28761.5177  37.4%  3994 1897s
  6771  3164 25671.9763   24  202 20928.2146 28761.5177  37.4%  3970 1924s
  7001  3182 23967.0786   27  132 20928.2146 26990.6673  29.0%  3924 1950s
  7206  3216 22991.7111   32  266 20928.2146 26990.6673  29.0%  3897 1980s
  7471  3222 22791.4262   40   81 20928.2146 26990.6673  29.0%  3838 2007s
  7752  3218 22348.7072   59   94 20928.2146 26990.6673  29.0%  3781 2036s
  8036  3238 21506.5445   72  125 20928.2146 26003.3245  24.3%  3731 2066s
  8354  3210 21913.5947   26  313 20928.2146 25907.4613  23.8%  3681 2097s
  8654  3180     cutoff   38      20928.2146 25748.3554  23.0%  3648 2129s
  8994  3134 23927.5402   30  499 20928.2146 25694.5887  22.8%  3606 2161s
  9256  3108 22776.9676   33  533 20928.2146 25694.5887  22.8%  3597 2194s
  9574  3121 23209.0530   22  293 20928.2146 25352.8220  21.1%  3573 2231s
  9953  3061     cutoff   28      20928.2146 25302.8868  20.9%  3531 2270s
 10340  3020 infeasible   32      20928.2146 25107.4093  20.0%  3492 2309s
 10670  3017 22174.5771   32  446 20928.2146 25079.7615  19.8%  3483 2348s
 11057  2987 22637.2056   25  313 20928.2146 25079.7615  19.8%  3457 2387s
 11522  2913 22232.2834   28  242 20928.2146 24815.1812  18.6%  3416 2436s
 11977  2845 21820.8092   32  207 20928.2146 24677.6053  17.9%  3380 2477s
 12421  2803 21679.8214   30  304 20928.2146 24601.9891  17.6%  3358 2521s
 12945  2898     cutoff   27      20928.2146 24410.9839  16.6%  3319 2568s
H13070  2893                    20956.108383 24392.5072  16.4%  3304 2568s
H13076  2855                    21121.225040 24392.5072  15.5%  3303 2568s
*13096  2811              62    21190.021578 24392.5072  15.1%  3298 2568s
 13466  2924 22633.5688   28  262 21190.0216 24262.1638  14.5%  3290 2612s
 14033  3010     cutoff   22      21190.0216 24178.3988  14.1%  3259 2659s
 14617  3009 infeasible   28      21190.0216 24081.0001  13.6%  3228 2710s
 15137  3029     cutoff   26      21190.0216 23808.4502  12.4%  3216 2765s
 15760  3117 22092.1267   25  296 21190.0216 23660.2857  11.7%  3191 2817s
 16543  3101     cutoff   23      21190.0216 23485.7469  10.8%  3141 2875s
 17315  3016 infeasible   24      21190.0216 23344.3181  10.2%  3101 2933s
 18198  2849     cutoff   33      21190.0216 23170.5979  9.35%  3048 2988s
 19133  2595 21515.8455   27  158 21190.0216 23004.2658  8.56%  2995 3046s
 20409  2113     cutoff   36      21190.0216 22670.6255  6.99%  2901 3100s
 22217   786     cutoff   31      21190.0216 22372.7324  5.58%  2751 3146s
 25014    25 infeasible   35      21190.0216 21989.4774  3.77%  2505 3158s
*25288    25              58    21202.996628 21962.0453  3.58%  2479 3158s
*25298    25              55    21223.166010 21962.0453  3.48%  2479 3158s

Cutting planes:
  Learned: 2
  Gomory: 1
  Projected implied bound: 85
  MIR: 1224
  Mixing: 3
  Flow cover: 2736
  Zero half: 1
  RLT: 25
  Relax-and-lift: 270

Explored 26319 nodes (63240156 simplex iterations) in 3158.78 seconds (9670.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21223.2 21203 21190 ... 20903.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.122316601015e+04, best bound 2.122316601015e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3158.80s
  Master Objective (UB) = 21223.17, θ = 151364.02
  Upper Bound (UB) = 21223.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151364.02
  [DEBUG]   ✓ Scenario 0: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x28c95b17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd736a4e9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.548810e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8244274.3345
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.405009e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140500.90    0  124 8244274.33 -140500.90   102%     -    0s
H    0     0                    -105591.4327 -140500.90  33.1%     -    0s
H    0     0                    -106089.4602 -140500.90  32.4%     -    0s
     0     0 -109685.98    0   72 -106089.46 -109685.98  3.39%     -    0s
H    0     0                    -108844.6212 -109627.10  0.72%     -    0s
     0     0 -109521.97    0   38 -108844.62 -109521.97  0.62%     -    0s
     0     0 -109491.72    0   38 -108844.62 -109491.72  0.59%     -    0s
H    0     0                    -108876.2417 -109404.67  0.49%     -    0s
     0     0 -109404.67    0   39 -108876.24 -109404.67  0.49%     -    0s
     0     0 -109376.09    0   39 -108876.24 -109376.09  0.46%     -    0s
     0     2 -109374.93    0   39 -108876.24 -109374.93  0.46%     -    0s
*   49    18               6    -108980.5247 -109036.13  0.05%  14.1    0s
*   51    18               6    -108985.7005 -109036.13  0.05%  13.7    0s
H   55    17                    -108987.0724 -109036.13  0.05%  13.5    0s
*   77     0               7    -108987.9769 -108987.98  0.00%  11.7    0s

Cutting planes:
  Gomory: 19
  Implied bound: 5
  MIR: 166
  Flow cover: 5
  RLT: 1

Explored 90 nodes (1327 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -108988 -108987 -108986 ... 1.54881e+13
No other solutions better than -108988

Optimal solution found (tolerance 1.00e-04)
Best objective -1.089879768620e+05, best bound -1.089879768620e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 151310.96
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108987.98
  [DEBUG]   S×d_nominal = 260298.94
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260298.94 + -108987.98 = 151310.96
  [DEBUG]   Current θ from Master = 151364.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 53.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21170.11
  Lower Bound (LB) = 21170.11
  Gap (UB-LB) = 53.0580, Absolute Gap = 53.0580, Relative Gap = 0.002500
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 11271.29s
Converged: True
Final Lower Bound: 21170.1081
Final Upper Bound: 21223.1660
Final Gap: 53.057956
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 4, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 0 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-04 23:36:28
End Time: 2026-01-05 02:44:19
Total Time: 11271.29s
Optimal Value: 21170.11
Lower Bound: 21170.11
Upper Bound: 21223.17
Gap: 53.057956
Plants Opened: {0: [0], 1: [1], 2: [1]} (3 plants)
DCs Opened: [2, 4, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed2_Mixed_gamma20_20260105_024419.csv

Total Execution Time: 11271.48 seconds
End Time: 2026-01-05 02:44:19

All tasks completed successfully!

