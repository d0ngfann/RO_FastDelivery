
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 15
DI Scenario: LD
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed15.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.113', '1.238'] (k=0.263)
  Product 1: ['1.000', '1.016', '1.032'] (k=0.039)
  Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=903, max=1768
  DC capacity (MC): min=414, max=867

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.05, max=34.96, count=80
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5260, max=9753
  DC fixed cost: min=3497, max=5949
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.335', '1.783'] (k=0.713)
    Product 2: ['1.000', '1.424', '2.029'] (k=0.873)
  MD:
    Product 0: ['1.000', '1.250', '1.561'] (k=0.549)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.287', '1.656'] (k=0.622)
  LD:
    Product 0: ['1.000', '1.113', '1.238'] (k=0.263)
    Product 1: ['1.000', '1.016', '1.032'] (k=0.039)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
  Mixed:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x03cc8874
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.08s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333501.7915
Found heuristic solution: objective -194606.4683

Root relaxation: objective 7.101466e+04, 5084 iterations, 0.20 seconds (0.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 71014.6558    0  536 -194606.47 71014.6558   136%     -    0s
H    0     0                    -190113.0011 71014.6558   137%     -    0s
     0     0 64738.8015    0  945 -190113.00 64738.8015   134%     -    0s
     0     0 64723.5236    0  937 -190113.00 64723.5236   134%     -    0s
     0     0 64723.5108    0  941 -190113.00 64723.5108   134%     -    0s
H    0     0                    -147439.1953 61995.5752   142%     -    1s
     0     0 61995.5752    0 1096 -147439.20 61995.5752   142%     -    1s
H    0     0                    -144062.7363 61891.5075   143%     -    1s
     0     0 61891.5075    0 1110 -144062.74 61891.5075   143%     -    1s
     0     0 61887.0708    0 1119 -144062.74 61887.0708   143%     -    1s
     0     0 61886.9063    0 1119 -144062.74 61886.9063   143%     -    1s
H    0     0                    -9656.839011 59237.7126   713%     -    3s
     0     0 59237.7126    0 1274 -9656.8390 59237.7126   713%     -    3s
     0     0 58931.4385    0 1285 -9656.8390 58931.4385   710%     -    3s
     0     0 58863.2618    0 1298 -9656.8390 58863.2618   710%     -    3s
     0     0 58854.0752    0 1304 -9656.8390 58854.0752   709%     -    3s
     0     0 58853.1797    0 1305 -9656.8390 58853.1797   709%     -    3s
H    0     0                    15929.850850 56673.3496   256%     -    5s
H    0     0                    15972.571864 56673.3496   255%     -    5s
H    0     0                    15987.701830 56673.3496   254%     -    5s
H    0     0                    15997.053801 56673.3496   254%     -    5s
H    0     0                    16369.010613 56673.3496   246%     -    5s
     0     0 56673.3496    0 1308 16369.0106 56673.3496   246%     -    5s
H    0     0                    16371.912908 56351.6412   244%     -    6s
H    0     0                    16590.535671 56351.6412   240%     -    6s
H    0     0                    16677.380842 56351.6412   238%     -    6s
H    0     0                    16692.664551 56351.6412   238%     -    6s
H    0     0                    16729.898903 56351.6412   237%     -    6s
H    0     0                    16807.492083 56351.6412   235%     -    6s
H    0     0                    16816.947288 56351.6412   235%     -    6s
H    0     0                    16934.013265 56351.6412   233%     -    6s
H    0     0                    16956.924898 56351.6412   232%     -    6s
H    0     0                    16980.389156 56351.6412   232%     -    6s
H    0     0                    17035.396367 56351.6412   231%     -    6s
     0     0 56351.6412    0 1310 17035.3964 56351.6412   231%     -    6s
     0     0 56294.7458    0 1325 17035.3964 56294.7458   230%     -    6s
     0     0 56281.0592    0 1337 17035.3964 56281.0592   230%     -    6s
     0     0 56279.2406    0 1336 17035.3964 56279.2406   230%     -    6s
H    0     0                    17085.416969 54612.6508   220%     -    8s
H    0     0                    17103.033143 54612.6508   219%     -    8s
H    0     0                    17130.255959 54612.6508   219%     -    8s
H    0     0                    17173.177419 54612.6508   218%     -    8s
H    0     0                    17529.513665 54612.6508   212%     -    8s
     0     0 54612.6508    0 1343 17529.5137 54612.6508   212%     -    8s
H    0     0                    17620.407362 54392.4799   209%     -    8s
H    0     0                    17638.103732 54392.4799   208%     -    8s
H    0     0                    17659.324207 54392.4799   208%     -    8s
H    0     0                    17723.575605 54392.4799   207%     -    8s
H    0     0                    17758.568907 54392.4799   206%     -    8s
     0     0 54392.4799    0 1412 17758.5689 54392.4799   206%     -    8s
     0     0 54346.1319    0 1413 17758.5689 54346.1319   206%     -    9s
     0     0 54324.7573    0 1418 17758.5689 54324.7573   206%     -    9s
     0     0 54323.1950    0 1421 17758.5689 54323.1950   206%     -    9s
H    0     0                    17916.270577 54323.1950   203%     -    9s
H    0     0                    18006.831483 54323.1950   202%     -    9s
     0     0 52983.0206    0 1378 18006.8315 52983.0206   194%     -   11s
H    0     0                    18111.423797 52752.3639   191%     -   11s
     0     0 52752.3639    0 1410 18111.4238 52752.3639   191%     -   11s
     0     0 52696.1470    0 1419 18111.4238 52696.1470   191%     -   12s
     0     0 52686.0737    0 1415 18111.4238 52686.0737   191%     -   12s
     0     0 51762.5180    0 1386 18111.4238 51762.5180   186%     -   14s
H    0     0                    21135.385531 51546.4808   144%     -   14s
H    0     0                    21928.104279 51546.4808   135%     -   14s
H    0     0                    21989.066284 51546.4808   134%     -   14s
H    0     0                    22056.856494 51546.4808   134%     -   14s
H    0     0                    22288.925840 51546.4808   131%     -   14s
H    0     0                    22348.676585 51546.4808   131%     -   14s
H    0     0                    22437.744981 51546.4808   130%     -   14s
H    0     0                    22439.950932 51546.4808   130%     -   14s
H    0     0                    22468.451415 51546.4808   129%     -   14s
H    0     0                    22661.866561 51546.4808   127%     -   14s
     0     0 51546.4808    0 1427 22661.8666 51546.4808   127%     -   14s
H    0     0                    22665.398580 51507.1250   127%     -   15s
     0     0 51507.1250    0 1444 22665.3986 51507.1250   127%     -   15s
     0     0 51498.6972    0 1449 22665.3986 51498.6972   127%     -   15s
H    0     0                    23124.794994 51498.6972   123%     -   15s
H    0     0                    23259.666389 51498.6972   121%     -   15s
H    0     0                    23466.036124 50835.5107   117%     -   16s
H    0     0                    23474.947856 50835.5107   117%     -   16s
H    0     0                    23513.456905 50835.5107   116%     -   16s
H    0     0                    23515.698954 50835.5107   116%     -   16s
     0     0 50835.5107    0 1395 23515.6990 50835.5107   116%     -   16s
H    0     0                    24299.024895 50694.7001   109%     -   17s
     0     0 50694.7001    0 1415 24299.0249 50694.7001   109%     -   17s
H    0     0                    24680.959254 50660.2899   105%     -   18s
     0     0 50660.2899    0 1425 24680.9593 50660.2899   105%     -   18s
     0     0 50651.9999    0 1452 24680.9593 50651.9999   105%     -   18s
H    0     0                    24723.492417 50651.9999   105%     -   18s
     0     0 49650.0243    0 1359 24723.4924 49650.0243   101%     -   21s
     0     0 49446.2446    0 1397 24723.4924 49446.2446   100%     -   22s
     0     0 49394.3857    0 1390 24723.4924 49394.3857   100%     -   22s
     0     0 49382.1638    0 1391 24723.4924 49382.1638   100%     -   23s
H    0     0                    24812.109841 48809.3669  96.7%     -   24s
H    0     0                    24846.194260 48809.3669  96.4%     -   24s
H    0     0                    24886.614361 48809.3669  96.1%     -   24s
H    0     0                    24908.430607 48809.3669  96.0%     -   24s
H    0     0                    24943.968009 48809.3669  95.7%     -   24s
H    0     0                    24947.423183 48809.3669  95.6%     -   24s
H    0     0                    24979.402120 48809.3669  95.4%     -   24s
     0     0 48809.3669    0 1395 24979.4021 48809.3669  95.4%     -   25s
H    0     0                    25001.098270 48676.8850  94.7%     -   25s
     0     0 48676.8850    0 1420 25001.0983 48676.8850  94.7%     -   26s
     0     0 48654.0035    0 1415 25001.0983 48654.0035  94.6%     -   26s
     0     0 48647.0390    0 1435 25001.0983 48647.0390  94.6%     -   26s
     0     0 48076.9205    0 1347 25001.0983 48076.9205  92.3%     -   29s
     0     0 47912.4785    0 1375 25001.0983 47912.4785  91.6%     -   30s
     0     0 47858.0992    0 1372 25001.0983 47858.0992  91.4%     -   30s
     0     0 47847.5517    0 1375 25001.0983 47847.5517  91.4%     -   30s
     0     0 47369.7411    0 1366 25001.0983 47369.7411  89.5%     -   33s
     0     0 47216.9791    0 1411 25001.0983 47216.9791  88.9%     -   34s
     0     0 47181.7204    0 1444 25001.0983 47181.7204  88.7%     -   34s
     0     0 47173.1897    0 1448 25001.0983 47173.1897  88.7%     -   35s
     0     0 46764.0019    0 1363 25001.0983 46764.0019  87.0%     -   37s
     0     0 46637.1051    0 1379 25001.0983 46637.1051  86.5%     -   38s
     0     0 46606.6686    0 1381 25001.0983 46606.6686  86.4%     -   38s
     0     0 46595.3800    0 1401 25001.0983 46595.3800  86.4%     -   39s
     0     0 46345.9999    0 1283 25001.0983 46345.9999  85.4%     -   40s
     0     0 46276.3738    0 1388 25001.0983 46276.3738  85.1%     -   41s
     0     0 46244.1335    0 1380 25001.0983 46244.1335  85.0%     -   41s
     0     0 46239.4859    0 1388 25001.0983 46239.4859  84.9%     -   42s
     0     0 46042.7766    0 1353 25001.0983 46042.7766  84.2%     -   43s
     0     0 45968.7195    0 1361 25001.0983 45968.7195  83.9%     -   44s
     0     0 45948.8055    0 1391 25001.0983 45948.8055  83.8%     -   44s
     0     0 45739.2612    0 1352 25001.0983 45739.2612  82.9%     -   46s
     0     0 45681.8572    0 1347 25001.0983 45681.8572  82.7%     -   46s
     0     0 45670.7338    0 1368 25001.0983 45670.7338  82.7%     -   47s
     0     0 45488.6927    0 1334 25001.0983 45488.6927  81.9%     -   48s
     0     0 45488.6184    0 1334 25001.0983 45488.6184  81.9%     -   48s
     0     2 45488.6184    0 1334 25001.0983 45488.6184  81.9%     -   50s
     3     8 44979.2107    2 1067 25001.0983 45114.7732  80.5%  5441   55s
    15    32 42313.6493    4  868 25001.0983 43586.2748  74.3%  4893   60s
    95   169 36711.0120    7  752 25001.0983 39852.8528  59.4%  3707   65s
H  156   169                    25037.277624 39852.8528  59.2%  2601   65s
H  160   169                    25134.115682 39852.8528  58.6%  2584   65s
H  364   257                    25143.386673 39067.0397  55.4%  1498   67s
H  394   257                    25150.319635 39067.0397  55.3%  1461   67s
H  439   306                    25170.836380 39067.0397  55.2%  1427   71s
   867   573 28587.6613   10  181 25170.8364 37490.7774  48.9%  1054   75s
  1601   847     cutoff   16      25170.8364 35651.1075  41.6%   774   80s
  2267  1009 25516.9036   12  417 25170.8364 33511.6046  33.1%   690   85s
  2800  1061 26171.6162   11  254 25170.8364 32756.1376  30.1%   660   90s
  3829  1156     cutoff   13      25170.8364 31312.5431  24.4%   598   96s
  4383  1154 25924.8541   14  128 25170.8364 30672.0463  21.9%   575  100s
  6761   146     cutoff   12      25170.8364 28007.3209  11.3%   466  105s

Cutting planes:
  Gomory: 14
  Implied bound: 435
  MIR: 2711
  Flow cover: 1155
  Zero half: 18
  RLT: 60
  Relax-and-lift: 872

Explored 7929 nodes (3409077 simplex iterations) in 106.38 seconds (223.93 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25170.8 25150.3 25143.4 ... 24908.4

Optimal solution found (tolerance 1.00e-04)
Best objective 2.517083638033e+04, best bound 2.517083638033e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 106.38s
  Master Objective (UB) = 25170.84, θ = 152636.68
  Upper Bound (UB) = 25170.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152636.68
  [DEBUG]   ✓ Scenario 0: θ = 152636.68 ≤ Q = 152636.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69b68702
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69b68702
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.355232e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6778107.0008
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.274182e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127418.18    0  122 6778107.00 -127418.18   102%     -    0s
H    0     0                    -92535.16665 -127418.18  37.7%     -    0s
H    0     0                    -92849.39419 -127418.18  37.2%     -    0s
*    0     0               0    -97020.01252 -97020.013  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 202

Explored 1 nodes (367 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -97020 -92849.4 -92535.2 ... 1.35523e+13
No other solutions better than -97020

Optimal solution found (tolerance 1.00e-04)
Best objective -9.702001252101e+04, best bound -9.702001252101e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 118337.67
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -97020.01
  [DEBUG]   S×d_nominal = 215357.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 215357.69 + -97020.01 = 118337.67
  [DEBUG]   Current θ from Master = 152636.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34299.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9128.18
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 34299.0124, Absolute Gap = 34299.0124, Relative Gap = 1.362649
  Not converged yet (gap = 34299.01 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xd6f7218c
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -9128.18 (0.01s)
MIP start from previous solve produced solution with objective -9128.18 (0.01s)
Loaded MIP start from previous solve with objective -9128.18

Presolve removed 14231 rows and 5770 columns
Presolve time: 0.32s
Presolved: 17732 rows, 8970 columns, 98128 nonzeros
Variable types: 6711 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.622905e+04, 9876 iterations, 1.23 seconds (2.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26229.0467    0  420 -9128.1761 26229.0467   387%     -    1s
H    0     0                    -9096.476931 26229.0467   388%     -    1s
H    0     0                    -8512.906161 26229.0467   408%     -    1s
     0     0 16799.8059    0  677 -8512.9062 16799.8059   297%     -    3s
     0     0 16482.3694    0  670 -8512.9062 16482.3694   294%     -    3s
     0     0 16478.5082    0  671 -8512.9062 16478.5082   294%     -    3s
     0     0 11476.6087    0  569 -8512.9062 11476.6087   235%     -    5s
H    0     0                    -8416.446319 10770.0274   228%     -    6s
     0     0 10770.0274    0  672 -8416.4463 10770.0274   228%     -    6s
     0     0 10745.0488    0  681 -8416.4463 10745.0488   228%     -    6s
     0     0 10742.4195    0  683 -8416.4463 10742.4195   228%     -    6s
     0     0 8068.32622    0  635 -8416.4463 8068.32622   196%     -    8s
H    0     0                    -8238.967644 8065.59622   198%     -    9s
H    0     0                    -7490.989817 7576.89175   201%     -    9s
H    0     0                    -7217.613262 7576.89175   205%     -    9s
H    0     0                    -6805.625432 7576.89175   211%     -    9s
H    0     0                    -6795.424275 7576.89175   211%     -    9s
     0     0 7576.89175    0  639 -6795.4243 7576.89175   211%     -    9s
H    0     0                    -6773.226217 7394.47292   209%     -   10s
H    0     0                    -6721.862578 7394.47292   210%     -   10s
H    0     0                    -6625.896383 7394.47292   212%     -   10s
     0     0 7394.47292    0  758 -6625.8964 7394.47292   212%     -   10s
     0     0 7378.39537    0  755 -6625.8964 7378.39537   211%     -   10s
     0     0 7378.15958    0  647 -6625.8964 7378.15958   211%     -   10s
H    0     0                    -6521.401388 7378.15958   213%     -   11s
H    0     0                    -6498.816107 7378.15958   214%     -   11s
H    0     0                    -6414.623964 6199.97961   197%     -   13s
     0     0 6199.97961    0  554 -6414.6240 6199.97961   197%     -   13s
H    0     0                    -6405.556652 6199.07445   197%     -   13s
     0     0 5921.65078    0  637 -6405.5567 5921.65078   192%     -   14s
     0     0 5853.40095    0  545 -6405.5567 5853.40095   191%     -   14s
     0     0 5838.01433    0  550 -6405.5567 5838.01433   191%     -   14s
     0     0 5833.54747    0  550 -6405.5567 5833.54747   191%     -   14s
     0     0 5492.03225    0  726 -6405.5567 5492.03225   186%     -   15s
     0     0 5376.64239    0  602 -6405.5567 5376.64239   184%     -   16s
     0     0 5330.62830    0  541 -6405.5567 5330.62830   183%     -   16s
     0     0 5325.51362    0  555 -6405.5567 5325.51362   183%     -   16s
     0     0 5183.02821    0  637 -6405.5567 5183.02821   181%     -   18s
     0     0 5140.12425    0  755 -6405.5567 5140.12425   180%     -   19s
     0     0 5127.92128    0  832 -6405.5567 5127.92128   180%     -   19s
     0     0 5123.38765    0  832 -6405.5567 5123.38765   180%     -   19s
     0     0 5057.29241    0  547 -6405.5567 5057.29241   179%     -   20s
     0     0 5038.87377    0  541 -6405.5567 5038.87377   179%     -   20s
     0     0 5031.20119    0  542 -6405.5567 5031.20119   179%     -   20s
     0     0 5029.48493    0  548 -6405.5567 5029.48493   179%     -   21s
     0     0 4951.43437    0  492 -6405.5567 4951.43437   177%     -   22s
     0     0 4931.27824    0  513 -6405.5567 4931.27824   177%     -   22s
     0     0 4923.97461    0  522 -6405.5567 4923.97461   177%     -   22s
     0     0 4907.86941    0  515 -6405.5567 4907.86941   177%     -   23s
     0     0 4901.50607    0  528 -6405.5567 4901.50607   177%     -   23s
     0     0 4888.20777    0  529 -6405.5567 4888.20777   176%     -   24s
     0     0 4888.15128    0  529 -6405.5567 4888.15128   176%     -   24s
H    0     2                    -6323.382600 4888.15128   177%     -   28s
     0     2 4888.15128    0  529 -6323.3826 4888.15128   177%     -   28s
     3     8  582.78591    2  685 -6323.3826 4637.80363   173%  1891   31s
    93    98 -371.12778    7  525 -6323.3826 3742.90007   159%  1074   35s
H  175   160                    -6055.429807 3135.58978   152%   975   37s
H  464   259                    -5240.398263 3134.67160   160%   663   39s
   552   314 -4614.4577   17  171 -5240.3983 2308.17940   144%   612   40s
H  575   314                    -5157.067950 2308.17940   145%   595   40s
H  678   349                    -4455.921384 1882.92952   142%   550   40s
H 1355   617                    -4387.154376 1882.92952   143%   356   44s
H 1366   617                    -3898.044841 1882.92952   148%   355   44s
  1651   910 -2372.4776   27  170 -3898.0448 1882.92952   148%   312   45s
H 2701  1412                    -3844.406410 1882.92952   149%   207   46s
  4115  2173 -3064.7769   51  529 -3844.4064 -1542.5511  59.9%   151   59s
H 4116  2065                    -3842.662272 -1542.5511  59.9%   151   60s
H 4118  1962                    -3807.329406 -1542.5511  59.5%   151   62s
H 4123  1867                    -3778.664486 -1542.5511  59.2%   151   65s
H 4123  1773                    -3756.065818 -1542.5511  58.9%   151   65s
H 4125  1687                    -3744.787323 -1542.5511  58.8%   151   66s
H 4127  1603                    -3721.250629 -1542.5511  58.5%   151   67s
H 4130  1524                    -3713.386269 -1542.5511  58.5%   151   69s
H 4130  1448                    -3703.805054 -1542.5511  58.4%   151   69s
H 4130  1375                    -3702.092397 -1542.5511  58.3%   151   69s
H 4130  1306                    -3695.205061 -1542.5511  58.3%   151   70s
H 4132  1242                    -3691.975263 -1542.5511  58.2%   150   71s
H 4132  1179                    -3689.320790 -1542.5511  58.2%   150   71s
  4135  1181 -2275.8028   22  526 -3689.3208 -1542.5511  58.2%   150   75s
  4164  1204 -1623.6041   14  252 -3689.3208 -1542.5511  58.2%   162   80s
H 4171  1142                    -3656.824165 -1542.5511  57.8%   162   80s
H 4233  1079                    -3652.403619 -1542.5511  57.8%   167   81s
H 4322   968                    -3652.188205 -1542.5511  57.8%   169   82s
H 4328   915                    -3650.199109 -1542.5511  57.7%   170   82s
H 4341   862                    -3645.556414 -1542.5511  57.7%   170   82s
H 4344   815                    -3637.597896 -1542.5511  57.6%   170   82s
H 4775   826                    -3613.776896 -3022.5521  16.4%   160   83s
H 4785   781                    -3613.715290 -3022.5521  16.4%   159   83s
H 4793   739                    -3589.646690 -3022.5521  15.8%   159   83s
H 5546   749                    -3567.225907 -3078.1128  13.7%   139   83s
H 5577   704                    -3557.861673 -3312.7584  6.89%   138   83s
H 8531   643                    -3557.380989 -3504.3803  1.49%  93.0   84s
H 8708   643                    -3557.027658 -3507.7671  1.38%  91.3   84s

Cutting planes:
  MIR: 135
  Flow cover: 412
  Inf proof: 1
  RLT: 5
  Relax-and-lift: 27

Explored 10510 nodes (848920 simplex iterations) in 84.99 seconds (177.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3557.03 -3557.38 -3557.86 ... -3650.2
No other solutions better than -3557.03

Optimal solution found (tolerance 1.00e-04)
Best objective -3.557027657521e+03, best bound -3.557027657521e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 85.00s
  Master Objective (UB) = -3557.03, θ = 111115.17
  Upper Bound (UB) = -3557.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111115.17
  [DEBUG]   ✓ Scenario 0: θ = 111115.17 ≤ Q = 111115.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111115.17 ≤ Q = 111115.17 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x15d1f393
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x15d1f393
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.479041e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.00s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 7994165.6240
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.234263e+05, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123426.31    0  130 7994165.62 -123426.31   102%     -    0s
H    0     0                    -87207.77287 -123426.31  41.5%     -    0s
H    0     0                    -88067.97339 -123426.31  40.1%     -    0s
H    0     0                    -95197.20682 -123426.31  29.7%     -    0s
H    0     0                    -107631.0803 -109423.52  1.67%     -    0s
H    0     0                    -108324.3172 -109423.52  1.01%     -    0s
     0     0 -109423.52    0   59 -108324.32 -109423.52  1.01%     -    0s
     0     0 -109286.20    0   59 -108324.32 -109286.20  0.89%     -    0s
     0     0 -109027.65    0   30 -108324.32 -109027.65  0.65%     -    0s
H    0     0                    -108721.4804 -109026.61  0.28%     -    0s
     0     0 -108907.51    0   33 -108721.48 -108907.51  0.17%     -    0s
     0     0 -108856.68    0   21 -108721.48 -108856.68  0.12%     -    0s
     0     0 -108856.66    0   21 -108721.48 -108856.66  0.12%     -    0s
     0     0 -108845.38    0   18 -108721.48 -108845.38  0.11%     -    0s
     0     0 -108822.33    0   16 -108721.48 -108822.33  0.09%     -    0s
     0     0 -108790.86    0   10 -108721.48 -108790.86  0.06%     -    0s
     0     0 -108773.06    0    8 -108721.48 -108773.06  0.05%     -    0s
     0     0 -108760.98    0    6 -108721.48 -108760.98  0.04%     -    0s
     0     0 -108753.53    0    4 -108721.48 -108753.53  0.03%     -    0s
     0     0 -108746.33    0    3 -108721.48 -108746.33  0.02%     -    0s
     0     0 -108744.26    0    4 -108721.48 -108744.26  0.02%     -    0s
H    0     0                    -108726.6498 -108744.26  0.02%     -    0s
H    0     0                    -108737.1332 -108744.26  0.01%     -    0s

Explored 1 nodes (629 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -108737 -108727 -108721 ... 7.99417e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.087371331638e+05, best bound -1.087442622608e+05, gap 0.0066%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 85954.41
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108737.13
  [DEBUG]   S×d_nominal = 194691.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 194691.55 + -108737.13 = 85954.41
  [DEBUG]   Current θ from Master = 111115.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25160.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28717.79
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 5571.1484, Absolute Gap = 5571.1484, Relative Gap = 1.566237
  Not converged yet (gap = 5571.15 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xa3c9067e
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -28717.8 (0.02s)
Loaded MIP start from previous solve with objective -28717.8

Presolve removed 21310 rows and 8660 columns
Presolve time: 0.40s
Presolved: 25943 rows, 12320 columns, 159749 nonzeros
Variable types: 10061 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 1.383618e+04, 17019 iterations, 4.22 seconds (7.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13836.1760    0  133 -28717.788 13836.1760   148%     -    4s
H    0     0                    -22906.18914 13836.1760   160%     -    4s
H    0     0                    -20016.54154 13836.1760   169%     -    5s
H    0     0                    -18091.37204 13836.1760   176%     -    5s
H    0     0                    -18090.00133 13836.1760   176%     -    5s
H    0     0                    -18080.32766 13836.1760   177%     -    5s
H    0     0                    -18074.19874 13836.1760   177%     -    5s
     0     0 10287.5516    0  403 -18074.199 10287.5516   157%     -    6s
H    0     0                    -15628.89651 10286.3752   166%     -    6s
H    0     0                    -15225.20332 10286.3752   168%     -    6s
H    0     0                    -15176.25005 10286.3752   168%     -    6s
H    0     0                    -15148.22125 10286.3752   168%     -    6s
H    0     0                    -14830.90399 10286.3752   169%     -    6s
H    0     0                    -14655.35021 10286.3752   170%     -    6s
H    0     0                    -14624.99424 10286.3752   170%     -    6s
H    0     0                    -14404.03527 10286.3752   171%     -    6s
H    0     0                    -14378.06350 10286.3752   172%     -    6s
H    0     0                    -14157.10453 10286.3752   173%     -    6s
     0     0 10107.7703    0  405 -14157.105 10107.7703   171%     -    7s
     0     0 10104.6363    0  408 -14157.105 10104.6363   171%     -    7s
     0     0 10091.9915    0  405 -14157.105 10091.9915   171%     -    7s
     0     0 10091.4017    0  402 -14157.105 10091.4017   171%     -    7s
     0     0 10091.3315    0  399 -14157.105 10091.3315   171%     -    7s
     0     0 8076.48682    0  385 -14157.105 8076.48682   157%     -    9s
H    0     0                    -13286.16027 8076.10120   161%     -    9s
H    0     0                    -13212.43553 8076.10120   161%     -    9s
H    0     0                    -13182.47841 8076.10120   161%     -    9s
     0     0 7749.33270    0  394 -13182.478 7749.33270   159%     -    9s
     0     0 7569.35818    0  395 -13182.478 7569.35818   157%     -   10s
     0     0 7556.43744    0  407 -13182.478 7556.43744   157%     -   10s
     0     0 7555.11518    0  405 -13182.478 7555.11518   157%     -   10s
     0     0 7554.75900    0  404 -13182.478 7554.75900   157%     -   10s
     0     0 6380.62171    0  456 -13182.478 6380.62171   148%     -   13s
H    0     0                    -13047.23230 6378.76446   149%     -   13s
H    0     0                    -11403.10498 6378.76446   156%     -   13s
H    0     0                    -11146.34025 6378.76446   157%     -   13s
H    0     0                    -11136.53731 6378.76446   157%     -   13s
H    0     0                    -11013.49345 6378.76446   158%     -   13s
H    0     0                    -10894.26286 6378.76446   159%     -   13s
H    0     0                    -10777.04237 6378.76446   159%     -   13s
     0     0 6263.87823    0  453 -10777.042 6263.87823   158%     -   13s
     0     0 6035.28026    0  465 -10777.042 6035.28026   156%     -   14s
     0     0 6005.81753    0  471 -10777.042 6005.81753   156%     -   14s
     0     0 5992.73930    0  480 -10777.042 5992.73930   156%     -   14s
     0     0 5991.67377    0  480 -10777.042 5991.67377   156%     -   15s
     0     0 5991.65293    0  481 -10777.042 5991.65293   156%     -   15s
H    0     0                    -10632.73408 5991.65293   156%     -   16s
H    0     0                    -10548.20168 5991.65293   157%     -   16s
H    0     0                    -10544.99097 5991.65293   157%     -   16s
     0     0 5542.35269    0  503 -10544.991 5542.35269   153%     -   17s
H    0     0                    -10508.40202 5542.25758   153%     -   17s
H    0     0                    -10503.72385 5542.25758   153%     -   17s
     0     0 5304.18572    0  491 -10503.724 5304.18572   150%     -   18s
     0     0 5268.55197    0  493 -10503.724 5268.55197   150%     -   19s
     0     0 5263.20732    0  495 -10503.724 5263.20732   150%     -   19s
     0     0 5262.65701    0  503 -10503.724 5262.65701   150%     -   19s
     0     0 5127.10609    0  566 -10503.724 5127.10609   149%     -   20s
H    0     0                    -10292.31816 5126.87894   150%     -   20s
H    0     0                    -10197.32047 5126.87894   150%     -   20s
H    0     0                    -9936.798425 5126.87894   152%     -   20s
H    0     0                    -9877.403767 5126.87894   152%     -   20s
H    0     0                    -9874.975874 5126.87894   152%     -   20s
H    0     0                    -9865.908562 5126.87894   152%     -   20s
     0     0 5031.77976    0  505 -9865.9086 5031.77976   151%     -   21s
     0     0 5026.83864    0  513 -9865.9086 5026.83864   151%     -   21s
     0     0 5025.86163    0  509 -9865.9086 5025.86163   151%     -   21s
H    0     0                    -9846.633679 5025.86163   151%     -   21s
H    0     0                    -9723.694207 4958.48573   151%     -   22s
H    0     0                    -8812.078050 4958.48573   156%     -   22s
H    0     0                    -8778.671903 4958.48573   156%     -   22s
H    0     0                    -8612.775900 4958.48573   158%     -   22s
     0     0 4958.48573    0  571 -8612.7759 4958.48573   158%     -   22s
H    0     0                    -8602.683118 4956.38664   158%     -   22s
     0     0 4935.51935    0  508 -8602.6831 4935.51935   157%     -   22s
     0     0 4904.42150    0  516 -8602.6831 4904.42150   157%     -   23s
     0     0 4893.56495    0  519 -8602.6831 4893.56495   157%     -   23s
     0     0 4890.57571    0  523 -8602.6831 4890.57571   157%     -   23s
     0     0 4890.16847    0  520 -8602.6831 4890.16847   157%     -   23s
     0     0 4849.68047    0  526 -8602.6831 4849.68047   156%     -   24s
     0     0 4827.88975    0  528 -8602.6831 4827.88975   156%     -   24s
     0     0 4822.13395    0  532 -8602.6831 4822.13395   156%     -   25s
     0     0 4821.07912    0  536 -8602.6831 4821.07912   156%     -   25s
     0     0 4760.86879    0  516 -8602.6831 4760.86879   155%     -   25s
     0     0 4757.66250    0  529 -8602.6831 4757.66250   155%     -   26s
     0     0 4757.30414    0  533 -8602.6831 4757.30414   155%     -   26s
     0     0 4751.38429    0  532 -8602.6831 4751.38429   155%     -   26s
H    0     0                    -8538.790902 4750.69359   156%     -   27s
     0     0 4750.39184    0  539 -8538.7909 4750.39184   156%     -   27s
     0     0 4746.57339    0  537 -8538.7909 4746.57339   156%     -   27s
     0     0 4745.05630    0  587 -8538.7909 4745.05630   156%     -   28s
     0     0 4744.99275    0  591 -8538.7909 4744.99275   156%     -   28s
     0     0 4736.20876    0  597 -8538.7909 4736.20876   155%     -   28s
     0     0 4736.13322    0  597 -8538.7909 4736.13322   155%     -   29s
     0     2 4736.13322    0  597 -8538.7909 4736.13322   155%     -   34s
     3     8 4120.35497    2  571 -8538.7909 4588.71181   154%  1091   36s
H   35    64                    -8445.549578 4229.41048   150%  1186   39s
    63    96 3651.61703    6  576 -8445.5496 4223.29366   150%  1153   41s
H   98   186                    -8441.671091 4223.29366   150%  1034   43s
H  134   186                    -8438.976818 4223.29366   150%   880   43s
   185   263 3485.16650    8  580 -8438.9768 4223.29366   150%   778   45s
   405   376 2359.41762    9  563 -8438.9768 4223.29366   150%   674   50s
   578   508 3051.91458   11  507 -8438.9768 4129.62213   149%   656   55s
   721   593 2622.88445   13  440 -8438.9768 4075.76875   148%   664   60s
   866   702 -1413.0970   15  493 -8438.9768 4075.76875   148%   699   65s
H  927   702                    -8035.532784 4075.76875   151%   684   65s
H  950   744                    -7793.625520 4075.76875   152%   689   67s
H  962   744                    -7738.893506 4075.76875   153%   688   67s
  1043   804 -2067.2268   16  317 -7738.8935 4075.76875   153%   697   71s
H 1235   937                    -7725.468623 3941.34663   151%   700   74s
  1289  1055 -1963.0343   19  265 -7725.4686 3941.34663   151%   688   76s
  1703  1328 -3496.7913   26  125 -7725.4686 3625.08547   147%   598   80s
H 2040  1542                    -6634.040494 3625.08547   155%   557   83s
H 2058  1542                    -4529.882125 3625.08547   180%   553   83s
H 2059  1542                    -4517.017455 3625.08547   180%   553   83s
H 2175  1566                    -4429.489942 3613.25308   182%   542   84s
H 2206  1566                    -4418.889456 3613.25308   182%   539   84s
  2302  1645 -3876.2301    9  189 -4418.8895 3613.25308   182%   532   87s
  2573  1744 -3056.2582   11  349 -4418.8895 3613.25308   182%   529   92s
  2710  1765 -3178.5672   13  348 -4418.8895 3373.99817   176%   533   95s
  2980  1760 -677.01223   11  212 -4418.8895 3317.46839   175%   538  101s
H 3030  1760                    -4321.666830 3317.46839   177%   539  101s
H 3133  1739                    -4297.379077 3070.04799   171%   539  103s
H 3166  1739                    -4260.898268 3070.04799   172%   539  103s
  3233  1742 -2139.6486   13  165 -4260.8983 3070.04799   172%   540  105s
  3441  1770 infeasible   13      -4260.8983 2781.13288   165%   545  110s
  3771  1757 -2108.0796   12  514 -4260.8983 2746.32926   164%   547  115s
  4054  1773 -3099.2603   18  311 -4260.8983 2746.32926   164%   559  120s
  4245  1808 -2351.5686   14  423 -4260.8983 2613.51207   161%   562  126s
H 4247  1808                    -4259.973273 2613.51207   161%   562  126s
  4544  1947     cutoff   39      -4259.9733 2462.49154   158%   554  131s
  4788  2049     cutoff   38      -4259.9733 2316.93271   154%   549  135s
  5305  2226 -3093.1734   22  335 -4259.9733 2189.96005   151%   547  142s
H 5479  2225                    -4259.676081 2026.34031   148%   545  142s
  5558  2226 1079.73914   19  597 -4259.6761 1919.39949   145%   544  154s
  5560  2227 -3668.1225   31  133 -4259.6761 1919.39949   145%   544  160s
  5562  2229 -3140.4631   31  537 -4259.6761 1919.39949   145%   544  165s
  5567  2232 -724.59911   12  525 -4259.6761 1919.39949   145%   544  170s
  5572  2235 -1267.5892   17  513 -4259.6761 1919.39949   145%   543  176s
  5575  2237  830.82437   20  543 -4259.6761 1919.39949   145%   543  180s
  5579  2240 -3516.6470   34  603 -4259.6761 1919.39949   145%   542  185s
  5580  2241 -3214.0936   20  603 -4259.6761 1919.39949   145%   542  192s
  5581  2241  818.33029   22  603 -4259.6761 1919.39949   145%   542  195s
  5584  2248 1919.39949   13  561 -4259.6761 1919.39949   145%   551  200s
  5612  2288 1919.39949   16  438 -4259.6761 1919.39949   145%   555  205s
  5714  2313 1919.39949   19  313 -4259.6761 1919.39949   145%   562  211s
  5833  2297 1919.39949   20  272 -4259.6761 1919.39949   145%   565  216s
  5964  2275 -1265.5452   21  211 -4259.6761 1919.39949   145%   574  221s
H 6041  2138                    -4228.575649 1919.39949   145%   576  223s
  6091  2127     cutoff   23      -4228.5756 1919.39949   145%   578  225s
H 6173  1994                    -4225.506191 1919.39949   145%   578  227s
H 6176  1892                    -4223.130530 1919.39949   145%   578  227s
H 6177  1795                    -4221.098190 1919.39949   145%   578  227s
H 6188  1700                    -4219.186190 1919.39949   145%   578  227s
H 6202  1608                    -4209.879969 1919.39949   146%   578  227s
H 6219  1520                    -4193.528635 1919.39949   146%   577  227s
  6337  1472     cutoff   27      -4193.5286 1919.39949   146%   576  230s
H 6338  1394                    -4192.708538 1919.39949   146%   576  230s
H 6493  1271                    -4186.071810 1827.65738   144%   575  234s
  6570  1224 infeasible   31      -4186.0718 1192.62415   128%   574  235s
  6922  1140 -2015.7251   23  323 -4186.0718  413.63432   110%   561  241s
H 7315   996                    -4176.276294 -582.49346  86.1%   537  242s
  8086   903     cutoff   28      -4176.2763 -1596.1653  61.8%   489  245s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 194
  Flow cover: 843
  Zero half: 1
  RLT: 3
  Relax-and-lift: 26

Explored 11211 nodes (4032429 simplex iterations) in 247.45 seconds (636.51 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4176.28 -4186.07 -4192.71 ... -4259.97
No other solutions better than -4176.28

Optimal solution found (tolerance 1.00e-04)
Best objective -4.176276293906e+03, best bound -4.176276293906e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 247.47s
  Master Objective (UB) = -4176.28, θ = 110950.64
  Upper Bound (UB) = -4176.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110950.64
  [DEBUG]   ✓ Scenario 0: θ = 110950.64 ≤ Q = 110950.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110950.64 ≤ Q = 110950.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110950.64 ≤ Q = 110950.64 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1418be19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xebe741e7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.483454e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.00s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 8012927.0519
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.162017e+05, 287 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116201.75    0  134 8012927.05 -116201.75   101%     -    0s
H    0     0                    -74852.31835 -116201.75  55.2%     -    0s
H    0     0                    -75192.03338 -116201.75  54.5%     -    0s
H    0     0                    -91927.37715 -116201.75  26.4%     -    0s
H    0     0                    -98964.68332 -116201.75  17.4%     -    0s
H    0     0                    -100657.2747 -108492.92  7.78%     -    0s
H    0     0                    -101323.3532 -108492.92  7.08%     -    0s
     0     0 -108492.92    0  129 -101323.35 -108492.92  7.08%     -    0s
H    0     0                    -105399.2406 -108429.57  2.88%     -    0s
     0     0 -108296.55    0  128 -105399.24 -108296.55  2.75%     -    0s
     0     0 -108287.77    0  128 -105399.24 -108287.77  2.74%     -    0s
     0     0 -107963.74    0  121 -105399.24 -107963.74  2.43%     -    0s
H    0     0                    -106466.7104 -107902.53  1.35%     -    0s
     0     0 -107668.57    0  109 -106466.71 -107668.57  1.13%     -    0s
     0     0 -107653.44    0  114 -106466.71 -107653.44  1.11%     -    0s
     0     0 -107124.38    0   81 -106466.71 -107124.38  0.62%     -    0s
     0     0 -107085.18    0   82 -106466.71 -107085.18  0.58%     -    0s
     0     0 -106980.53    0   78 -106466.71 -106980.53  0.48%     -    0s
     0     0 -106804.48    0   37 -106466.71 -106804.48  0.32%     -    0s
     0     0 -106791.63    0   53 -106466.71 -106791.63  0.31%     -    0s
     0     0 -106783.82    0   36 -106466.71 -106783.82  0.30%     -    0s
     0     0 -106518.44    0   23 -106466.71 -106518.44  0.05%     -    0s
     0     0 -106512.77    0    9 -106466.71 -106512.77  0.04%     -    0s
     0     0 -106502.82    0    4 -106466.71 -106502.82  0.03%     -    0s
     0     0 -106483.61    0    2 -106466.71 -106483.61  0.02%     -    0s
     0     0 -106478.53    0    2 -106466.71 -106478.53  0.01%     -    0s
H    0     0                    -106478.4940 -106478.53  0.00%     -    0s

Explored 1 nodes (989 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106478 -106467 -106391 ... -75192

Optimal solution found (tolerance 1.00e-04)
Best objective -1.064784940489e+05, best bound -1.064785331767e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 88626.11
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106478.49
  [DEBUG]   S×d_nominal = 195104.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 195104.60 + -106478.49 = 88626.11
  [DEBUG]   Current θ from Master = 110950.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22324.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26500.81
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 4951.8998, Absolute Gap = 4951.8998, Relative Gap = 1.185721
  Not converged yet (gap = 4951.90 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x4ac0efde
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -26500.8 (0.03s)
Loaded MIP start from previous solve with objective -26500.8

Presolve removed 28380 rows and 11530 columns
Presolve time: 0.53s
Presolved: 34163 rows, 15690 columns, 211259 nonzeros
Variable types: 13431 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34163 rows, 15690 columns, 211259 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   45278    4.9849153e+03   0.000000e+00   2.983667e+05      5s
   56542    1.1430258e+04   0.000000e+00   7.806851e+04     10s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 1.180236e+04, 31834 iterations, 11.31 seconds (22.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11802.3616    0  120 -26500.806 11802.3616   145%     -   12s
H    0     0                    -26474.73258 11802.3616   145%     -   12s
H    0     0                    -26198.97716 11802.3616   145%     -   12s
H    0     0                    -25283.57121 11802.3616   147%     -   12s
H    0     0                    -23903.96693 11802.3616   149%     -   12s
H    0     0                    -23493.91466 11802.3616   150%     -   12s
H    0     0                    -18146.49301 8032.80156   144%     -   15s
     0     0 8024.13324    0  394 -18146.493 8024.13324   144%     -   15s
H    0     0                    -16964.64388 8024.13324   147%     -   15s
H    0     0                    -12030.85976 8024.13324   167%     -   15s
H    0     0                    -11728.80229 8024.13324   168%     -   15s
H    0     0                    -11368.76224 8024.13324   171%     -   15s
H    0     0                    -10054.56354 8024.13324   180%     -   15s
     0     0 7809.55711    0  390 -10054.564 7809.55711   178%     -   16s
     0     0 7807.87670    0  408 -10054.564 7807.87670   178%     -   16s
     0     0 7740.69972    0  394 -10054.564 7740.69972   177%     -   17s
     0     0 7740.56753    0  395 -10054.564 7740.56753   177%     -   17s
     0     0 4926.42014    0  379 -10054.564 4926.42014   149%     -   20s
H    0     0                    -9892.745407 4925.82364   150%     -   20s
     0     0 4537.90747    0  441 -9892.7454 4537.90747   146%     -   22s
     0     0 4288.25784    0  446 -9892.7454 4288.25784   143%     -   23s
     0     0 4249.76459    0  462 -9892.7454 4249.76459   143%     -   24s
     0     0 4248.97955    0  463 -9892.7454 4248.97955   143%     -   24s
     0     0 4242.73991    0  462 -9892.7454 4242.73991   143%     -   24s
     0     0 4242.56932    0  464 -9892.7454 4242.56932   143%     -   24s
     0     0 3043.73555    0  531 -9892.7454 3043.73555   131%     -   28s
H    0     0                    -9147.867696 3041.94483   133%     -   28s
H    0     0                    -8804.964738 3041.94483   135%     -   28s
     0     0 2740.39437    0  463 -8804.9647 2740.39437   131%     -   29s
H    0     0                    -8787.286702 2664.88716   130%     -   30s
H    0     0                    -8781.437199 2664.88716   130%     -   30s
     0     0 2664.88716    0  415 -8781.4372 2664.88716   130%     -   30s
H    0     0                    -8592.978846 2626.16700   131%     -   30s
H    0     0                    -8543.800752 2626.16700   131%     -   30s
H    0     0                    -8530.930032 2626.16700   131%     -   30s
H    0     0                    -8506.828784 2626.16700   131%     -   31s
H    0     0                    -8461.318881 2626.16700   131%     -   31s
     0     0 2626.16700    0  480 -8461.3189 2626.16700   131%     -   31s
     0     0 2596.96917    0  415 -8461.3189 2596.96917   131%     -   31s
     0     0 2593.56920    0  417 -8461.3189 2593.56920   131%     -   31s
     0     0 2590.87307    0  430 -8461.3189 2590.87307   131%     -   31s
     0     0 2590.04935    0  424 -8461.3189 2590.04935   131%     -   31s
     0     0 2188.85650    0  519 -8461.3189 2188.85650   126%     -   35s
H    0     0                    -8450.141200 2188.79209   126%     -   35s
     0     0 2114.83083    0  519 -8450.1412 2114.83083   125%     -   35s
     0     0 2074.23226    0  504 -8450.1412 2074.23226   125%     -   35s
     0     0 2040.21277    0  523 -8450.1412 2040.21277   124%     -   36s
     0     0 2035.60361    0  526 -8450.1412 2035.60361   124%     -   36s
     0     0 2033.40869    0  532 -8450.1412 2033.40869   124%     -   36s
     0     0 2033.36506    0  532 -8450.1412 2033.36506   124%     -   36s
     0     0 1949.32536    0  521 -8450.1412 1949.32536   123%     -   38s
H    0     0                    -8438.976818 1949.32231   123%     -   38s
     0     0 1933.32623    0  512 -8438.9768 1933.32623   123%     -   38s
     0     0 1929.12139    0  520 -8438.9768 1929.12139   123%     -   38s
     0     0 1880.97489    0  525 -8438.9768 1880.97489   122%     -   39s
     0     0 1865.97841    0  519 -8438.9768 1865.97841   122%     -   39s
     0     0 1859.51079    0  528 -8438.9768 1859.51079   122%     -   40s
     0     0 1857.57950    0  527 -8438.9768 1857.57950   122%     -   40s
     0     0 1857.28300    0  526 -8438.9768 1857.28300   122%     -   40s
     0     0 1780.48915    0  583 -8438.9768 1780.48915   121%     -   41s
     0     0 1760.81932    0  526 -8438.9768 1760.81932   121%     -   43s
     0     0 1754.76090    0  531 -8438.9768 1754.76090   121%     -   43s
     0     0 1746.40170    0  545 -8438.9768 1746.40170   121%     -   43s
     0     0 1744.60691    0  543 -8438.9768 1744.60691   121%     -   43s
     0     0 1744.41415    0  546 -8438.9768 1744.41415   121%     -   44s
     0     0 1714.44204    0  537 -8438.9768 1714.44204   120%     -   44s
     0     0 1706.24967    0  536 -8438.9768 1706.24967   120%     -   45s
     0     0 1705.98491    0  539 -8438.9768 1705.98491   120%     -   45s
     0     0 1685.04091    0  598 -8438.9768 1685.04091   120%     -   46s
     0     0 1679.59583    0  600 -8438.9768 1679.59583   120%     -   46s
     0     0 1675.53195    0  602 -8438.9768 1675.53195   120%     -   46s
     0     0 1674.46561    0  605 -8438.9768 1674.46561   120%     -   46s
     0     0 1668.96095    0  553 -8438.9768 1668.96095   120%     -   47s
     0     0 1646.35427    0  550 -8438.9768 1646.35427   120%     -   48s
     0     0 1645.80286    0  556 -8438.9768 1645.80286   120%     -   48s
     0     0 1641.48765    0  552 -8438.9768 1641.48765   119%     -   49s
     0     0 1638.84686    0  548 -8438.9768 1638.84686   119%     -   49s
     0     0 1638.57886    0  555 -8438.9768 1638.57886   119%     -   49s
     0     0 1634.73071    0  553 -8438.9768 1634.73071   119%     -   50s
     0     0 1633.84979    0  554 -8438.9768 1633.84979   119%     -   50s
     0     0 1631.50699    0  553 -8438.9768 1631.50699   119%     -   51s
     0     0 1629.77747    0  554 -8438.9768 1629.77747   119%     -   51s
     0     0 1629.51014    0  558 -8438.9768 1629.51014   119%     -   51s
     0     0 1628.33508    0  555 -8438.9768 1628.33508   119%     -   52s
     0     0 1628.12493    0  555 -8438.9768 1628.12493   119%     -   53s
     0     2 1627.59665    0  555 -8438.9768 1627.59665   119%     -   61s
     7    16 1030.31281    3  536 -8438.9768 1399.97155   117%  2169   66s
    31    64  379.39886    5  582 -8438.9768 1036.09163   112%  3310   71s
    95   137  145.57017    7  590 -8438.9768  834.49902   110%  2569   77s
   136   213 -675.72838    8  515 -8438.9768  834.49902   110%  2215   81s
H  159   213                    -8430.856110  834.49902   110%  2168   81s
   301   347 -757.38918    9  440 -8430.8561  834.49902   110%  1674   88s
   379   370 -3641.2236   10  322 -8430.8561  834.49902   110%  1570   92s
   426   422 -823.66327   10  446 -8430.8561  717.48015   109%  1515   96s
   486   469 -1080.0707   12  444 -8430.8561  652.31175   108%  1601  100s
   612   582 -2124.3941   14  514 -8430.8561  652.31175   108%  1646  106s
   680   655 -3212.1513   15  467 -8430.8561  632.67554   108%  1622  110s
H  763   683                    -8347.036085  632.67554   108%  1574  113s
   794   759 -4988.0930   16  255 -8347.0361  632.67554   108%  1568  116s
H  877   796                    -8338.724326  632.67554   108%  1502  119s
H  893   796                    -8100.385469  632.67554   108%  1509  119s
H  901   796                    -8083.082099  632.67554   108%  1500  119s
   916   879 -3493.6538   17  426 -8083.0821  632.67554   108%  1490  121s
  1071   990 -3684.7527   19  340 -8083.0821  598.30954   107%  1365  125s
  1228  1061 -3972.8127   21  328 -8083.0821  598.30954   107%  1262  131s
H 1339  1089                    -8079.851887  598.30954   107%  1235  133s
  1349  1156 -5812.5390   22  310 -8079.8519  598.30954   107%  1234  135s
  1558  1272 -6678.7801   23  198 -8079.8519  598.30954   107%  1194  142s
  1683  1386 -7911.8691   24  184 -8079.8519  598.30954   107%  1170  145s
  2048  1488 -5009.8313   11  235 -8079.8519  557.08467   107%  1074  152s
  2085  1520 -5039.3011   12  178 -8079.8519  557.08467   107%  1081  155s
  2210  1588 -6057.7352   14  235 -8079.8519  557.08467   107%  1083  161s
  2297  1623 -6741.4522   15  225 -8079.8519  557.08467   107%  1077  166s
  2401  1670 -6878.1177   16  263 -8079.8519  500.07304   106%  1078  170s
  2632  1777 -476.40620    8  385 -8079.8519  500.07304   106%  1077  180s
  2874  1923 -1499.0827   10  335 -8079.8519  500.07304   106%  1065  190s
  3043  2027 -3433.8598   13  227 -8079.8519  300.65680   104%  1057  195s
  3215  2127 -4010.5266   15  318 -8079.8519  262.95442   103%  1047  201s
  3430  2200 -4580.0363   18  332 -8079.8519  262.95442   103%  1035  207s
  3656  2296 -6598.3466   24  283 -8079.8519   93.31739   101%  1027  212s
  3836  2389 -637.22738   10  559 -8079.8519   93.31739   101%  1030  220s
  4055  2443 -2932.0048   13  324 -8079.8519   93.31739   101%  1025  225s
  4256  2494 -3475.6648   14  400 -8079.8519   93.31739   101%  1014  230s
  4468  2573 -3962.4109   15  398 -8079.8519   93.31739   101%  1009  235s
  4668  2667 -5050.7745   17  368 -8079.8519   93.31739   101%  1009  241s
  4963  2751 -7603.8448   20  364 -8079.8519   88.05506   101%   997  246s
  5254  2836     cutoff   22      -8079.8519 -139.75611  98.3%   991  252s
  5497  2905 -1686.6540   12  288 -8079.8519 -180.97596  97.8%   990  259s
  5800  2967 -3268.8856   17  357 -8079.8519 -266.61009  96.7%   985  267s
  6082  3105 -5390.3142   22  249 -8079.8519 -299.93483  96.3%   988  276s
  6425  3106 -6863.5541   40  555 -8079.8519 -465.80952  94.2%   980  293s
  6427  3107 -6630.1197   20  120 -8079.8519 -465.80952  94.2%   980  302s
  6428  3108 -2310.9269   15  442 -8079.8519 -465.80952  94.2%   980  307s
  6429  3109 -2153.9989   14  463 -8079.8519 -465.80952  94.2%   980  311s
  6431  3110 -7747.6549   41  517 -8079.8519 -465.80952  94.2%   980  316s
  6434  3112 -4121.5066   11  528 -8079.8519 -465.80952  94.2%   979  320s
  6438  3115 -6142.5672   31  530 -8079.8519 -465.80952  94.2%   978  325s
  6443  3118 -1422.5472   12  468 -8079.8519 -465.80952  94.2%   978  330s
  6449  3122 -2980.3630   17  476 -8079.8519 -465.80952  94.2%   977  336s
  6451  3123 -2466.9808   19  624 -8079.8519 -465.80952  94.2%   977  341s
  6454  3125 -6514.5680   37  489 -8079.8519 -465.80952  94.2%   976  345s
  6457  3127 -3985.9829   12  480 -8079.8519 -465.80952  94.2%   976  350s
  6461  3130 -4907.5261   11  565 -8079.8519 -465.80952  94.2%   975  365s
  6462  3131 -5852.8474   13  565 -8079.8519 -465.80952  94.2%   975  372s
  6463  3134 -465.80952   14  474 -8079.8519 -465.80952  94.2%   990  385s
  6469  3144 -465.80952   16  465 -8079.8519 -465.80952  94.2%   992  392s
  6477  3158 -465.80952   17  539 -8079.8519 -465.80952  94.2%   993  398s
  6493  3184 -465.80952   18  605 -8079.8519 -465.80952  94.2%  1000  403s
  6525  3184 -4043.0761   19  584 -8079.8519 -465.80952  94.2%  1014  407s
  6557  3222 -4190.9467   20  537 -8079.8519 -465.80952  94.2%  1039  413s
  6636  3211 -5560.9345   21  547 -8079.8519 -465.80952  94.2%  1047  417s
  6710  3211 -4727.4956   21  586 -8079.8519 -465.80952  94.2%  1052  420s
  6857  3212 -5766.7290   22  475 -8079.8519 -465.80952  94.2%  1058  428s
  6904  3224 -6141.0063   23  520 -8079.8519 -465.80952  94.2%  1063  432s
  7007  3204 -7416.9327   24  210 -8079.8519 -465.80952  94.2%  1072  437s
  7077  3177     cutoff   25      -8079.8519 -465.80952  94.2%  1073  441s
  7145  3172 -7479.0021   24  477 -8079.8519 -465.80952  94.2%  1073  446s
  7198  3170 -7571.4227   25  437 -8079.8519 -543.86605  93.3%  1078  451s
  7256  3164     cutoff   25      -8079.8519 -543.86605  93.3%  1081  455s
  7398  3132     cutoff   28      -8079.8519 -543.86605  93.3%  1083  465s
  7527  3144 -6923.4087   22  273 -8079.8519 -1388.8437  82.8%  1089  471s
  7604  3153     cutoff   24      -8079.8519 -1547.1466  80.9%  1088  476s
  7685  3176     cutoff   26      -8079.8519 -1622.0674  79.9%  1091  481s
  7784  3192 -5652.7647   25  178 -8079.8519 -1622.0674  79.9%  1092  485s
  8022  3151 -3304.3058   25  434 -8079.8519 -1787.5398  77.9%  1089  494s
  8116  3151 -5337.8816   27  491 -8079.8519 -1796.2206  77.8%  1092  499s
  8241  3160 -6257.1343   28  454 -8079.8519 -1871.8006  76.8%  1090  504s
  8367  3108 -6832.7773   30  278 -8079.8519 -1871.8006  76.8%  1089  509s
  8532  3055     cutoff   31      -8079.8519 -2590.6603  67.9%  1086  513s
  8629  3031 -6192.2219   29  135 -8079.8519 -2748.8999  66.0%  1083  518s
  8756  3015 -6871.0531   31  300 -8079.8519 -2941.2026  63.6%  1083  523s
  8913  2956 -7174.3975   30  210 -8079.8519 -3247.2162  59.8%  1081  529s
  9102  2869     cutoff   34      -8079.8519 -3247.2162  59.8%  1079  534s
  9280  2777 -7539.1681   22  332 -8079.8519 -3647.3702  54.9%  1079  541s
  9481  2683 -8001.5743   27  142 -8079.8519 -3924.0704  51.4%  1075  547s
  9563  2644     cutoff   28      -8079.8519 -3924.0704  51.4%  1077  554s
  9630  2603     cutoff   24      -8079.8519 -3924.0704  51.4%  1076  559s
  9703  2579 -7786.0335   25  449 -8079.8519 -4135.7505  48.8%  1076  564s
  9761  2533     cutoff   26      -8079.8519 -4135.7505  48.8%  1075  568s
  9844  2495 -5655.5795   33  247 -8079.8519 -4135.7505  48.8%  1074  573s
  9925  2450 -5940.6886   34  138 -8079.8519 -4310.8895  46.6%  1073  581s
 10049  2389 -7492.1669   35  183 -8079.8519 -4310.8895  46.6%  1069  585s
 10120  2307 -7493.6415   36  181 -8079.8519 -4519.8391  44.1%  1068  591s
 10254  2233 -6920.5453   25  401 -8079.8519 -4764.0827  41.0%  1063  598s
 10402  2092     cutoff   29      -8079.8519 -4912.8257  39.2%  1061  605s
 10643  1973 -6824.8994   24  442 -8079.8519 -4920.7508  39.1%  1049  611s
 10838  1807 -6489.9183   36  209 -8079.8519 -4920.7508  39.1%  1044  617s
 11070  1640     cutoff   25      -8079.8519 -5791.8429  28.3%  1031  623s
 11261  1542     cutoff   31      -8079.8519 -5791.8429  28.3%  1024  628s
 11322  1515     cutoff   41      -8079.8519 -7154.4924  11.5%  1021  633s
 11339  1508 -8025.6557   29  384 -8079.8519 -7787.7437  3.62%  1020  638s
 11343  1504     cutoff   27      -8079.8519 -7790.6107  3.58%  1019  641s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 312
  Flow cover: 1228
  RLT: 29
  Relax-and-lift: 56

Explored 11348 nodes (11654132 simplex iterations) in 641.25 seconds (1789.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8079.85 -8083.08 -8100.39 ... -8530.93
No other solutions better than -8079.85

Optimal solution found (tolerance 1.00e-04)
Best objective -8.079851886778e+03, best bound -8.079851886778e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 641.27s
  Master Objective (UB) = -8079.85, θ = 118046.09
  Upper Bound (UB) = -8079.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118046.09
  [DEBUG]   ✓ Scenario 0: θ = 118046.09 ≤ Q = 118046.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118046.09 ≤ Q = 118046.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118046.09 ≤ Q = 118046.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118046.09 ≤ Q = 118046.09 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6731bf88
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x98ce4078
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.365045e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.00s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 6870377.9940
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.307410e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130740.98    0  122 6870377.99 -130740.98   102%     -    0s
H    0     0                    -95986.53364 -130740.98  36.2%     -    0s
H    0     0                    -96249.78621 -130740.98  35.8%     -    0s
     0     0 -113113.90    0  101 -96249.786 -113113.90  17.5%     -    0s
H    0     0                    -109679.1200 -113010.17  3.04%     -    0s
H    0     0                    -110617.8882 -113010.17  2.16%     -    0s
     0     0 -112339.33    0  102 -110617.89 -112339.33  1.56%     -    0s
H    0     0                    -110924.9927 -112306.72  1.25%     -    0s
     0     0 -111803.40    0   82 -110924.99 -111803.40  0.79%     -    0s
     0     0 -111752.09    0   90 -110924.99 -111752.09  0.75%     -    0s
     0     0 -111642.69    0   61 -110924.99 -111642.69  0.65%     -    0s
     0     0 -111566.35    0   71 -110924.99 -111566.35  0.58%     -    0s
     0     0 -111566.30    0   71 -110924.99 -111566.30  0.58%     -    0s
     0     0 -111310.68    0   56 -110924.99 -111310.68  0.35%     -    0s
     0     0 -111253.20    0   48 -110924.99 -111253.20  0.30%     -    0s
     0     0 -111247.21    0   48 -110924.99 -111247.21  0.29%     -    0s
     0     0 -111157.11    0   47 -110924.99 -111157.11  0.21%     -    0s
     0     0 -111112.67    0   46 -110924.99 -111112.67  0.17%     -    0s
     0     0 -111103.24    0   48 -110924.99 -111103.24  0.16%     -    0s
     0     0 -111077.96    0   47 -110924.99 -111077.96  0.14%     -    0s
     0     0 -111068.51    0   47 -110924.99 -111068.51  0.13%     -    0s
H    0     0                    -110928.1380 -111068.51  0.13%     -    0s
     0     0 -111068.51    0   47 -110928.14 -111068.51  0.13%     -    0s
     0     0 -111068.51    0   47 -110928.14 -111068.51  0.13%     -    0s
     0     0 -111068.51    0   44 -110928.14 -111068.51  0.13%     -    0s
     0     0 -111041.95    0   29 -110928.14 -111041.95  0.10%     -    0s
     0     0 -110984.07    0   10 -110928.14 -110984.07  0.05%     -    0s
     0     0 -110958.96    0    7 -110928.14 -110958.96  0.03%     -    0s
     0     0 -110952.44    0    6 -110928.14 -110952.44  0.02%     -    0s
     0     0          -    0      -110928.14 -110937.33  0.01%     -    0s

Cutting planes:
  Gomory: 22
  Implied bound: 10
  MIR: 40
  Flow cover: 10
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (1145 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -110928 -110925 -110813 ... 1.36505e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.109281380281e+05, best bound -1.109373258579e+05, gap 0.0083%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 107108.57
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110928.14
  [DEBUG]   S×d_nominal = 218036.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 218036.71 + -110928.14 = 107108.57
  [DEBUG]   Current θ from Master = 118046.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10937.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19017.37
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 1048.3242, Absolute Gap = 1048.3242, Relative Gap = 0.129745
  Not converged yet (gap = 1048.32 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x2ab72870
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35470 rows and 14410 columns
Presolve time: 0.68s
Presolved: 42363 rows, 19050 columns, 262709 nonzeros
Variable types: 16791 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42363 rows, 19050 columns, 262709 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29072   -3.3344931e+02   0.000000e+00   1.271421e+07      5s
Concurrent spin time: 0.54s

Solved with dual simplex

Root relaxation: objective 1.180236e+04, 24169 iterations, 6.50 seconds (12.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11802.3616    0  120 -239633.31 11802.3616   105%     -    7s
H    0     0                    -226256.3653 11802.3616   105%     -    7s
H    0     0                    -183842.7923 11802.3616   106%     -    7s
H    0     0                    -183016.9021 11802.3616   106%     -    7s
H    0     0                    -174541.5316 11802.3616   107%     -    7s
H    0     0                    -174384.3537 11802.3616   107%     -    7s
H    0     0                    -54101.62471 11802.3616   122%     -    7s
H    0     0                    -18242.96394 11802.3616   165%     -    7s
H    0     0                    -9128.796146 11802.3616   229%     -    7s
H    0     0                    -9086.256922 11802.3616   230%     -    8s
H    0     0                    -8954.848337 11802.3616   232%     -    8s
H    0     0                    -8516.146280 11802.3616   239%     -    8s
     0     0 8073.27681    0  402 -8516.1463 8073.27681   195%     -   11s
H    0     0                    -8469.793695 8073.27681   195%     -   11s
     0     0 7837.49558    0  393 -8469.7937 7837.49558   193%     -   12s
     0     0 7833.00457    0  413 -8469.7937 7833.00457   192%     -   13s
     0     0 7832.14630    0  416 -8469.7937 7832.14630   192%     -   13s
     0     0 7743.95720    0  398 -8469.7937 7743.95720   191%     -   14s
     0     0 7743.95720    0  398 -8469.7937 7743.95720   191%     -   14s
     0     0 5089.22260    0  417 -8469.7937 5089.22260   160%     -   19s
H    0     0                    -8463.220935 5086.07677   160%     -   19s
     0     0 4537.87696    0  436 -8463.2209 4537.87696   154%     -   21s
     0     0 4408.30070    0  449 -8463.2209 4408.30070   152%     -   22s
     0     0 4391.31446    0  440 -8463.2209 4391.31446   152%     -   22s
     0     0 4390.55036    0  441 -8463.2209 4390.55036   152%     -   22s
     0     0 4370.78645    0  457 -8463.2209 4370.78645   152%     -   22s
     0     0 4369.90624    0  454 -8463.2209 4369.90624   152%     -   22s
     0     0 4369.83860    0  456 -8463.2209 4369.83860   152%     -   22s
     0     0 3206.16457    0  526 -8463.2209 3206.16457   138%     -   27s
     0     0 2889.91512    0  481 -8463.2209 2889.91512   134%     -   30s
     0     0 2809.68819    0  474 -8463.2209 2809.68819   133%     -   31s
     0     0 2793.81916    0  403 -8463.2209 2793.81916   133%     -   31s
     0     0 2752.10844    0  483 -8463.2209 2752.10844   133%     -   32s
     0     0 2744.22806    0  542 -8463.2209 2744.22806   132%     -   32s
     0     0 2741.59155    0  475 -8463.2209 2741.59155   132%     -   32s
     0     0 2737.99840    0  543 -8463.2209 2737.99840   132%     -   32s
     0     0 2736.73294    0  549 -8463.2209 2736.73294   132%     -   32s
     0     0 2736.71625    0  549 -8463.2209 2736.71625   132%     -   32s
     0     0 2329.68485    0  508 -8463.2209 2329.68485   128%     -   37s
     0     0 2195.92131    0  506 -8463.2209 2195.92131   126%     -   39s
     0     0 2147.01463    0  505 -8463.2209 2147.01463   125%     -   40s
H    0     0                    -8453.903439 2095.61350   125%     -   41s
     0     0 2095.61350    0  564 -8453.9034 2095.61350   125%     -   41s
     0     0 2086.51835    0  499 -8453.9034 2086.51835   125%     -   41s
     0     0 2071.10998    0  580 -8453.9034 2071.10998   124%     -   41s
     0     0 2068.92837    0  514 -8453.9034 2068.92837   124%     -   42s
     0     0 2067.24937    0  581 -8453.9034 2067.24937   124%     -   42s
     0     0 2065.57549    0  577 -8453.9034 2065.57549   124%     -   42s
H    0     0                    -8450.141200 2065.39923   124%     -   42s
     0     0 2065.39923    0  577 -8450.1412 2065.39923   124%     -   42s
     0     0 1951.84171    0  441 -8450.1412 1951.84171   123%     -   44s
     0     0 1933.35553    0  446 -8450.1412 1933.35553   123%     -   45s
     0     0 1925.79034    0  445 -8450.1412 1925.79034   123%     -   45s
     0     0 1920.14976    0  431 -8450.1412 1920.14976   123%     -   46s
     0     0 1913.45485    0  444 -8450.1412 1913.45485   123%     -   46s
     0     0 1912.22354    0  519 -8450.1412 1912.22354   123%     -   46s
     0     0 1910.76982    0  522 -8450.1412 1910.76982   123%     -   47s
     0     0 1910.00829    0  447 -8450.1412 1910.00829   123%     -   47s
     0     0 1882.81563    0  516 -8450.1412 1882.81563   122%     -   48s
H    0     0                    -8438.976818 1882.35159   122%     -   49s
     0     0 1867.44041    0  448 -8438.9768 1867.44041   122%     -   50s
     0     0 1853.39585    0  449 -8438.9768 1853.39585   122%     -   50s
     0     0 1848.31492    0  451 -8438.9768 1848.31492   122%     -   51s
     0     0 1846.68851    0  453 -8438.9768 1846.68851   122%     -   51s
     0     0 1846.20413    0  450 -8438.9768 1846.20413   122%     -   51s
     0     0 1814.01928    0  443 -8438.9768 1814.01928   121%     -   52s
     0     0 1806.71538    0  540 -8438.9768 1806.71538   121%     -   53s
     0     0 1761.17570    0  541 -8438.9768 1761.17570   121%     -   54s
     0     0 1750.25977    0  542 -8438.9768 1750.25977   121%     -   54s
     0     0 1747.17447    0  537 -8438.9768 1747.17447   121%     -   55s
     0     0 1744.63124    0  543 -8438.9768 1744.63124   121%     -   55s
     0     0 1744.04762    0  543 -8438.9768 1744.04762   121%     -   55s
     0     0 1718.25578    0  465 -8438.9768 1718.25578   120%     -   56s
     0     0 1712.25760    0  473 -8438.9768 1712.25760   120%     -   56s
     0     0 1705.86544    0  475 -8438.9768 1705.86544   120%     -   57s
     0     0 1703.46884    0  474 -8438.9768 1703.46884   120%     -   57s
     0     0 1703.03870    0  477 -8438.9768 1703.03870   120%     -   57s
     0     0 1688.56746    0  536 -8438.9768 1688.56746   120%     -   58s
     0     0 1684.54254    0  471 -8438.9768 1684.54254   120%     -   59s
     0     0 1673.87824    0  465 -8438.9768 1673.87824   120%     -   59s
     0     0 1671.90756    0  476 -8438.9768 1671.90756   120%     -   59s
     0     0 1667.33537    0  477 -8438.9768 1667.33537   120%     -   59s
     0     0 1666.91468    0  479 -8438.9768 1666.91468   120%     -   60s
     0     0 1660.74859    0  466 -8438.9768 1660.74859   120%     -   60s
     0     0 1658.98313    0  463 -8438.9768 1658.98313   120%     -   60s
     0     0 1657.68856    0  468 -8438.9768 1657.68856   120%     -   61s
     0     0 1656.29886    0  466 -8438.9768 1656.29886   120%     -   61s
     0     0 1644.78709    0  469 -8438.9768 1644.78709   119%     -   62s
     0     0 1641.56434    0  478 -8438.9768 1641.56434   119%     -   62s
     0     0 1640.18960    0  484 -8438.9768 1640.18960   119%     -   63s
     0     0 1639.62852    0  477 -8438.9768 1639.62852   119%     -   63s
     0     0 1637.22917    0  458 -8438.9768 1637.22917   119%     -   63s
     0     0 1637.15602    0  458 -8438.9768 1637.15602   119%     -   64s
     0     2 1637.15602    0  458 -8438.9768 1637.15602   119%     -   73s
     1     4 1518.16391    1  456 -8438.9768 1636.39205   119%  3141   75s
     7    16 1082.49608    3  525 -8438.9768 1423.23267   117%  3087   82s
    15    32  777.43709    4  518 -8438.9768 1147.48672   114%  3987   86s
    31    52  -38.38712    5  474 -8438.9768  898.08424   111%  5658   95s
    87   116 -323.21621    7  265 -8438.9768  896.38973   111%  4241  102s
   119   150 -741.72727    8  264 -8438.9768  896.38973   111%  3423  106s
   153   195 -790.89033    9  254 -8438.9768  896.38973   111%  2981  111s
   198   249 -824.18273    9  261 -8438.9768  896.38973   111%  2624  116s
   270   288 -1095.5660   10  244 -8438.9768  896.38973   111%  2265  120s
   349   321 -1864.3713   10  230 -8438.9768  873.01865   110%  1998  126s
   420   355 -883.41124   10  265 -8438.9768  847.87087   110%  1923  131s
   484   393 -5118.4577   10  175 -8438.9768  847.87087   110%  1906  138s
   549   429 -4201.8376   11  219 -8438.9768  847.87087   110%  1880  142s
   614   469 -2680.3982   11  241 -8438.9768  847.87087   110%  1868  149s
   670   508 -2825.1700   11  243 -8438.9768  847.87087   110%  1881  154s
   720   553 -3334.2762   11  221 -8438.9768  847.87087   110%  1966  159s
   786   587 -4301.0457   11  240 -8438.9768  728.28876   109%  2032  166s
   838   631 -3482.2894   12  224 -8438.9768  728.28876   109%  2045  171s
   918   662 -4503.1578   12  199 -8438.9768  728.28876   109%  2007  176s
   967   704 -5591.5741   14  206 -8438.9768  728.28876   109%  2016  182s
  1031   732 -5131.5415   14  208 -8438.9768  728.28876   109%  2020  185s
  1073   782 -5150.2731   15  200 -8438.9768  549.71678   107%  2018  192s
  1139   844 -5702.4944   16  264 -8438.9768  546.52534   106%  2025  198s
  1235   936 -5722.1874   17  267 -8438.9768  546.52534   106%  1977  205s
  1365  1018 -6058.7201   19  252 -8438.9768  432.36444   105%  1892  212s
  1487  1113 -6437.2833   21  286 -8438.9768  432.36444   105%  1823  219s
  1614  1228 -6554.1433   24  315 -8438.9768  431.42223   105%  1768  224s
  1763  1290 -7609.0187   30  223 -8438.9768  368.58007   104%  1707  230s
  1930  1339     cutoff   32      -8438.9768  368.58007   104%  1660  236s
  2069  1374 -6041.5583    8  217 -8438.9768  368.58007   104%  1647  242s
  2174  1420 -401.10427   12  416 -8438.9768  368.58007   104%  1633  248s
  2295  1492 -1760.2297   16  299 -8438.9768  368.58007   104%  1622  253s
  2442  1546 -2335.4232   19  283 -8438.9768  368.58007   104%  1601  261s
  2622  1619 -6985.9783   23  216 -8438.9768   43.74380   101%  1565  267s
  2803  1676     cutoff   27      -8438.9768   43.74380   101%  1540  273s
  2993  1737 -3494.1574   24  350 -8438.9768  -15.47083   100%  1528  280s
  3157  1824 -5740.8321   27  289 -8438.9768  -15.47083   100%  1514  288s
  3330  1837 -6503.0929   30  196 -8438.9768 -257.13364  97.0%  1509  293s
  3379  1861     cutoff   29      -8438.9768 -335.12691  96.0%  1511  298s
  3445  1901 -7726.6528   32  253 -8438.9768 -335.12691  96.0%  1506  306s
  3621  1907     cutoff   30      -8438.9768 -404.84804  95.2%  1481  316s
  3791  1974 infeasible   32      -8438.9768 -414.57962  95.1%  1477  324s
  3977  2081 -7679.1344   18   51 -8438.9768 -503.29633  94.0%  1487  335s
  4176  2227 -3311.3955   16  279 -8438.9768 -560.15388  93.4%  1488  344s
  4455  2331 -6956.9710   17  264 -8438.9768 -560.15388  93.4%  1470  354s
  4751  2413     cutoff   22      -8438.9768 -560.15388  93.4%  1459  364s
  5088  2535 -7547.9634   24  292 -8438.9768 -910.87625  89.2%  1439  376s
  5416  2536 -7383.2250   10  458 -8438.9768 -910.87625  89.2%  1422  396s
  5418  2537 -8277.1911   20  120 -8438.9768 -910.87625  89.2%  1422  407s
  5419  2538 -6850.1386   19  424 -8438.9768 -910.87625  89.2%  1422  414s
  5420  2539 -7682.0275   17  540 -8438.9768 -910.87625  89.2%  1421  420s
  5422  2540 -7758.6917   31  580 -8438.9768 -910.87625  89.2%  1421  425s
  5425  2542 -8045.8198   10  465 -8438.9768 -910.87625  89.2%  1420  431s
  5428  2544 -7087.9917   20  520 -8438.9768 -910.87625  89.2%  1419  436s
  5433  2547 -2470.8365   31  550 -8438.9768 -910.87625  89.2%  1418  441s
  5434  2548 -6257.3469   24  434 -8438.9768 -910.87625  89.2%  1418  445s
  5437  2550 -2223.8751   18  530 -8438.9768 -910.87625  89.2%  1417  450s
  5441  2553 -6537.2003   36  548 -8438.9768 -910.87625  89.2%  1416  456s
  5444  2555 -5564.5048   16  471 -8438.9768 -910.87625  89.2%  1415  462s
  5446  2556 -7963.3836   14  464 -8438.9768 -910.87625  89.2%  1414  465s
  5449  2558 -7660.8913   44  459 -8438.9768 -910.87625  89.2%  1414  470s
  5451  2559 -6575.5254   27  533 -8438.9768 -910.87625  89.2%  1413  485s
  5452  2560 -6092.0123   19  533 -8438.9768 -910.87625  89.2%  1413  498s
  5453  2564 -910.87625   10  471 -8438.9768 -910.87625  89.2%  1435  508s
  5455  2567 -910.87625   11  526 -8438.9768 -910.87625  89.2%  1437  514s
  5459  2574 -910.87625   12  590 -8438.9768 -910.87625  89.2%  1438  518s
  5467  2587 -910.87625   13  598 -8438.9768 -910.87625  89.2%  1442  524s
  5483  2594 -2602.9714   14  276 -8438.9768 -910.87625  89.2%  1456  535s
  5502  2608 -910.87625   15  471 -8438.9768 -910.87625  89.2%  1477  545s
  5534  2664 -936.31138   16  442 -8438.9768 -910.87625  89.2%  1493  553s
  5643  2640 -3936.4890   20  300 -8438.9768 -910.87625  89.2%  1507  564s
  5731  2632 -1639.1977   20  378 -8438.9768 -910.87625  89.2%  1524  572s
  5785  2634 -7455.1541   18   66 -8438.9768 -910.87625  89.2%  1547  578s
  5846  2622 -1711.1174   19  298 -8438.9768 -910.87625  89.2%  1570  586s
  5917  2634 -4022.7917   21  295 -8438.9768 -910.87625  89.2%  1576  593s
  5988  2616 -2260.9493   23  305 -8438.9768 -910.87625  89.2%  1580  602s
  6047  2621 -2794.6854   24  263 -8438.9768 -910.87625  89.2%  1584  608s
  6117  2607 -6637.5653   25   66 -8438.9768 -910.87625  89.2%  1586  616s
  6179  2600 -3385.2286   25  397 -8438.9768 -910.87625  89.2%  1590  626s
  6257  2597     cutoff   24      -8438.9768 -910.87625  89.2%  1593  632s
  6305  2614 -4219.0958   27  340 -8438.9768 -910.87625  89.2%  1621  639s
  6364  2610 -4445.7617   28  158 -8438.9768 -910.87625  89.2%  1630  644s
  6408  2635 -4639.6567   29  314 -8438.9768 -910.87625  89.2%  1635  650s
  6473  2639 -4901.4682   32  224 -8438.9768 -910.87625  89.2%  1637  658s
  6532  2643     cutoff   32      -8438.9768 -910.87625  89.2%  1636  665s
  6617  2626     cutoff   36      -8438.9768 -910.87625  89.2%  1630  672s
  6712  2624     cutoff   37      -8438.9768 -910.87625  89.2%  1632  680s
  6817  2612     cutoff   42      -8438.9768 -910.87625  89.2%  1633  686s
  6909  2612 -6977.2922   16  285 -8438.9768 -910.87625  89.2%  1637  692s
  7001  2623     cutoff   17      -8438.9768 -1064.9964  87.4%  1638  699s
  7095  2596     cutoff   17      -8438.9768 -1064.9964  87.4%  1640  705s
  7147  2587 -6224.1432   17  397 -8438.9768 -1064.9964  87.4%  1645  713s
  7209  2568 -6582.7332   18  474 -8438.9768 -1064.9964  87.4%  1649  722s
  7285  2548 -6835.1952   19  438 -8438.9768 -1187.3821  85.9%  1651  728s
  7356  2555 -7688.1005   20  451 -8438.9768 -1337.9444  84.1%  1651  736s
  7424  2543 -8350.7482   21  326 -8438.9768 -1410.7563  83.3%  1656  745s
  7503  2535     cutoff   22      -8438.9768 -1410.7563  83.3%  1658  753s
  7604  2529 -7736.9249   24  112 -8438.9768 -1410.7563  83.3%  1659  762s
H 7623  2393                    -8425.383902 -1410.7563  83.3%  1659  762s
  7697  2399 -7842.6169   25  106 -8425.3839 -1410.7563  83.3%  1659  771s
  7876  2365 -3639.7574   22  220 -8425.3839 -2604.3975  69.1%  1656  780s
  8045  2348 -4946.5076   24  214 -8425.3839 -2891.2064  65.7%  1654  789s
  8209  2306 -6368.2012   28  311 -8425.3839 -2891.2064  65.7%  1654  798s
  8376  2267 infeasible   28      -8425.3839 -3125.5998  62.9%  1654  808s
  8573  2210 -6642.9923   28  157 -8425.3839 -3461.1557  58.9%  1656  817s
  8753  2162 infeasible   21      -8425.3839 -3762.9620  55.3%  1657  828s
  8913  2105     cutoff   20      -8425.3839 -3934.5402  53.3%  1656  839s
  9147  1961 -6958.9760   31  141 -8425.3839 -3964.5987  52.9%  1649  851s
  9412  1794 -6807.3542   20  346 -8425.3839 -4358.5325  48.3%  1643  862s
  9689  1644     cutoff   24      -8425.3839 -4675.5041  44.5%  1637  875s
  9968  1533     cutoff   29      -8425.3839 -5080.3240  39.7%  1633  885s
 10046  1482 -6626.9281   19  427 -8425.3839 -5094.5022  39.5%  1634  896s
 10152  1361     cutoff   25      -8425.3839 -5339.2818  36.6%  1633  906s
 10373  1156 -7576.2194   26  536 -8425.3839 -5376.3778  36.2%  1622  919s
 10698   828 -7544.6641   24  482 -8425.3839 -5569.8809  33.9%  1611  932s
 11071   558 -7826.5498   19  434 -8425.3839 -5908.9293  29.9%  1585  939s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 403
  Mixing: 1
  Flow cover: 1473
  RLT: 24
  Relax-and-lift: 97

Explored 11288 nodes (17806739 simplex iterations) in 939.81 seconds (2712.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8425.38 -8438.98 -8450.14 ... -9128.8
No other solutions better than -8425.38

Optimal solution found (tolerance 1.00e-04)
Best objective -8.425383901710e+03, best bound -8.425383901710e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 939.82s
  Master Objective (UB) = -8425.38, θ = 119029.33
  Upper Bound (UB) = -8425.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119029.33
  [DEBUG]   ✓ Scenario 0: θ = 119029.33 ≤ Q = 119029.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119029.33 ≤ Q = 119029.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119029.33 ≤ Q = 119029.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119029.33 ≤ Q = 119029.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119029.33 ≤ Q = 119029.33 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7810e3bc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7810e3bc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.371410e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6821220.1699
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.295310e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129531.00    0  122 6821220.17 -129531.00   102%     -    0s
H    0     0                    -94703.84756 -129531.00  36.8%     -    0s
H    0     0                    -94967.10012 -129531.00  36.4%     -    0s
     0     0 -106685.73    0   93 -94967.100 -106685.73  12.3%     -    0s
H    0     0                    -103563.9004 -106579.81  2.91%     -    0s
     0     0 -106094.16    0   95 -103563.90 -106094.16  2.44%     -    0s
H    0     0                    -104511.7848 -106076.56  1.50%     -    0s
     0     0 -105924.43    0   95 -104511.78 -105924.43  1.35%     -    0s
     0     0 -105582.42    0   68 -104511.78 -105582.42  1.02%     -    0s
     0     0 -105562.68    0   74 -104511.78 -105562.68  1.01%     -    0s
     0     0 -105499.10    0   64 -104511.78 -105499.10  0.94%     -    0s
     0     0 -105334.86    0   53 -104511.78 -105334.86  0.79%     -    0s
     0     0 -105245.77    0   56 -104511.78 -105245.77  0.70%     -    0s
     0     0 -105244.84    0   57 -104511.78 -105244.84  0.70%     -    0s
     0     0 -105191.20    0   57 -104511.78 -105191.20  0.65%     -    0s
     0     0 -105172.23    0   57 -104511.78 -105172.23  0.63%     -    0s
H    0     0                    -104863.5874 -105172.23  0.29%     -    0s
H    0     0                    -104921.6025 -105172.23  0.24%     -    0s
     0     0 -105172.23    0   80 -104921.60 -105172.23  0.24%     -    0s
     0     0 -105172.23    0   60 -104921.60 -105172.23  0.24%     -    0s
     0     0 -105091.10    0   47 -104921.60 -105091.10  0.16%     -    0s
     0     0 -105067.51    0   50 -104921.60 -105067.51  0.14%     -    0s
     0     0 -105065.88    0   51 -104921.60 -105065.88  0.14%     -    0s
     0     0 -105004.87    0   39 -104921.60 -105004.87  0.08%     -    0s
     0     0 -105004.74    0   40 -104921.60 -105004.74  0.08%     -    0s
     0     0 -104991.84    0   40 -104921.60 -104991.84  0.07%     -    0s
     0     0 -104979.22    0   39 -104921.60 -104979.22  0.05%     -    0s
     0     0 -104979.16    0   39 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104979.16    0   41 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104979.16    0   37 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104979.16    0   35 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104974.69    0   34 -104921.60 -104974.69  0.05%     -    0s
     0     0 -104974.28    0   34 -104921.60 -104974.28  0.05%     -    0s
H    0     0                    -104957.0277 -104974.28  0.02%     -    0s

Cutting planes:
  Gomory: 22
  Implied bound: 4
  MIR: 50
  Flow cover: 11

Explored 1 nodes (1360 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104957 -104922 -104864 ... 1.37141e+13
No other solutions better than -104957

Optimal solution found (tolerance 1.00e-04)
Best objective -1.049570276765e+05, best bound -1.049570276765e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 112922.28
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104957.03
  [DEBUG]   S×d_nominal = 217879.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217879.31 + -104957.03 = 112922.28
  [DEBUG]   Current θ from Master = 119029.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6107.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14532.43
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 702.7922, Absolute Gap = 702.7922, Relative Gap = 0.083414
  Not converged yet (gap = 702.79 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x267c4b08
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42600 rows and 17310 columns
Presolve time: 0.81s
Presolved: 50523 rows, 22390 columns, 314039 nonzeros
Variable types: 20131 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50523 rows, 22390 columns, 314039 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30176   -4.7642178e+03   0.000000e+00   1.159817e+09      5s
   39969    1.8956222e+03   0.000000e+00   1.646190e+07     10s
   49112    7.8103277e+03   0.000000e+00   5.777806e+06     15s
Concurrent spin time: 0.36s

Solved with dual simplex

Root relaxation: objective 1.176344e+04, 38217 iterations, 14.79 seconds (30.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11763.4416    0  121 -239633.31 11763.4416   105%     -   16s
H    0     0                    -229155.5646 11763.4416   105%     -   16s
H    0     0                    -165965.7828 11763.4416   107%     -   16s
H    0     0                    -165827.4869 11763.4416   107%     -   16s
H    0     0                    -54197.70364 11763.4416   122%     -   16s
H    0     0                    -10113.67929 11763.4416   216%     -   16s
H    0     0                    -9473.030635 11763.4416   224%     -   16s
H    0     0                    -9333.890222 11763.4416   226%     -   16s
H    0     0                    -8716.707335 11763.4416   235%     -   16s
H    0     0                    -8653.641672 8064.86195   193%     -   23s
H    0     0                    -8589.767844 8064.86195   194%     -   23s
H    0     0                    -8586.132648 8064.86195   194%     -   23s
     0     0 8063.92324    0  389 -8586.1326 8063.92324   194%     -   23s
     0     0 7896.37409    0  338 -8586.1326 7896.37409   192%     -   24s
     0     0 7894.96006    0  344 -8586.1326 7894.96006   192%     -   25s
     0     0 7803.76813    0  345 -8586.1326 7803.76813   191%     -   25s
     0     0 7803.76813    0  345 -8586.1326 7803.76813   191%     -   25s
     0     0 6151.42760    0  259 -8586.1326 6151.42760   172%     -   29s
H    0     0                    -8570.242392 6151.42760   172%     -   30s
     0     0 5296.48126    0  377 -8570.2424 5296.48126   162%     -   33s
     0     0 5162.74266    0  397 -8570.2424 5162.74266   160%     -   35s
     0     0 5051.91738    0  443 -8570.2424 5051.91738   159%     -   36s
     0     0 5015.56958    0  444 -8570.2424 5015.56958   159%     -   37s
     0     0 5008.49473    0  440 -8570.2424 5008.49473   158%     -   37s
     0     0 5002.36209    0  443 -8570.2424 5002.36209   158%     -   38s
     0     0 5000.16603    0  443 -8570.2424 5000.16603   158%     -   38s
     0     0 4999.93530    0  445 -8570.2424 4999.93530   158%     -   38s
     0     0 3525.93246    0  528 -8570.2424 3525.93246   141%     -   45s
     0     0 3204.52261    0  542 -8570.2424 3204.52261   137%     -   48s
     0     0 3157.61054    0  537 -8570.2424 3157.61054   137%     -   49s
     0     0 3098.32012    0  534 -8570.2424 3098.32012   136%     -   50s
     0     0 3074.14193    0  489 -8570.2424 3074.14193   136%     -   51s
     0     0 3068.67475    0  550 -8570.2424 3068.67475   136%     -   51s
     0     0 3008.72212    0  482 -8570.2424 3008.72212   135%     -   52s
     0     0 2992.71227    0  481 -8570.2424 2992.71227   135%     -   52s
     0     0 2989.95796    0  480 -8570.2424 2989.95796   135%     -   52s
     0     0 2989.72949    0  485 -8570.2424 2989.72949   135%     -   52s
     0     0 2560.41226    0  489 -8570.2424 2560.41226   130%     -   57s
     0     0 2288.83867    0  498 -8570.2424 2288.83867   127%     -   59s
     0     0 2235.11931    0  495 -8570.2424 2235.11931   126%     -   60s
     0     0 2158.29165    0  494 -8570.2424 2158.29165   125%     -   61s
     0     0 2146.00140    0  495 -8570.2424 2146.00140   125%     -   62s
     0     0 2141.37727    0  506 -8570.2424 2141.37727   125%     -   62s
     0     0 2140.25273    0  503 -8570.2424 2140.25273   125%     -   62s
     0     0 2140.16518    0  504 -8570.2424 2140.16518   125%     -   62s
     0     0 2040.18848    0  516 -8570.2424 2040.18848   124%     -   64s
     0     0 2024.95108    0  438 -8570.2424 2024.95108   124%     -   65s
     0     0 2019.59217    0  528 -8570.2424 2019.59217   124%     -   65s
     0     0 2015.48348    0  456 -8570.2424 2015.48348   124%     -   65s
     0     0 1984.64986    0  527 -8570.2424 1984.64986   123%     -   66s
     0     0 1972.57244    0  532 -8570.2424 1972.57244   123%     -   67s
     0     0 1967.91484    0  527 -8570.2424 1967.91484   123%     -   67s
     0     0 1967.54170    0  532 -8570.2424 1967.54170   123%     -   67s
H    0     0                    -8504.387390 1967.54170   123%     -   68s
     0     0 1925.32817    0  536 -8504.3874 1925.32817   123%     -   69s
H    0     0                    -8501.693117 1904.21035   122%     -   71s
H    0     0                    -8497.814630 1904.21035   122%     -   71s
     0     0 1904.21035    0  531 -8497.8146 1904.21035   122%     -   71s
     0     0 1900.71093    0  459 -8497.8146 1900.71093   122%     -   72s
     0     0 1900.49913    0  541 -8497.8146 1900.49913   122%     -   72s
     0     0 1847.70508    0  449 -8497.8146 1847.70508   122%     -   74s
     0     0 1826.27996    0  532 -8497.8146 1826.27996   121%     -   75s
     0     0 1818.14062    0  454 -8497.8146 1818.14062   121%     -   75s
     0     0 1816.51854    0  447 -8497.8146 1816.51854   121%     -   75s
     0     0 1816.17540    0  453 -8497.8146 1816.17540   121%     -   75s
     0     0 1798.38008    0  533 -8497.8146 1798.38008   121%     -   77s
     0     0 1791.92488    0  539 -8497.8146 1791.92488   121%     -   77s
     0     0 1790.85431    0  535 -8497.8146 1790.85431   121%     -   77s
     0     0 1755.44969    0  537 -8497.8146 1755.44969   121%     -   79s
     0     0 1751.44421    0  454 -8497.8146 1751.44421   121%     -   79s
     0     0 1750.72422    0  458 -8497.8146 1750.72422   121%     -   79s
     0     0 1740.44807    0  551 -8497.8146 1740.44807   120%     -   80s
     0     0 1737.75472    0  554 -8497.8146 1737.75472   120%     -   81s
     0     0 1737.44793    0  551 -8497.8146 1737.44793   120%     -   82s
     0     0 1728.85929    0  610 -8497.8146 1728.85929   120%     -   83s
     0     0 1726.63255    0  613 -8497.8146 1726.63255   120%     -   83s
     0     0 1725.63560    0  541 -8497.8146 1725.63560   120%     -   84s
     0     0 1667.98599    0  607 -8497.8146 1667.98599   120%     -   85s
     0     0 1635.94947    0  606 -8497.8146 1635.94947   119%     -   86s
     0     0 1628.51913    0  539 -8497.8146 1628.51913   119%     -   87s
     0     0 1625.75008    0  609 -8497.8146 1625.75008   119%     -   87s
     0     0 1625.22638    0  612 -8497.8146 1625.22638   119%     -   87s
     0     0 1618.18634    0  616 -8497.8146 1618.18634   119%     -   88s
     0     0 1609.25491    0  609 -8497.8146 1609.25491   119%     -   89s
     0     0 1607.35070    0  612 -8497.8146 1607.35070   119%     -   89s
     0     0 1606.84240    0  615 -8497.8146 1606.84240   119%     -   89s
     0     0 1596.36818    0  601 -8497.8146 1596.36818   119%     -   91s
     0     0 1591.61900    0  596 -8497.8146 1591.61900   119%     -   91s
     0     0 1591.61900    0  601 -8497.8146 1591.61900   119%     -   91s
     0     0 1590.89763    0  606 -8497.8146 1590.89763   119%     -   92s
     0     0 1588.90263    0  599 -8497.8146 1588.90263   119%     -   93s
     0     0 1588.47309    0  609 -8497.8146 1588.47309   119%     -   93s
     0     0 1580.58211    0  603 -8497.8146 1580.58211   119%     -   94s
     0     0 1577.09863    0  615 -8497.8146 1577.09863   119%     -   94s
     0     0 1576.31587    0  621 -8497.8146 1576.31587   119%     -   95s
     0     0 1575.02146    0  612 -8497.8146 1575.02146   119%     -   95s
     0     0 1573.94185    0  612 -8497.8146 1573.94185   119%     -   97s
     0     2 1573.94185    0  612 -8497.8146 1573.94185   119%     -  112s
     3     8 1305.00232    2  587 -8497.8146 1511.05761   118%  2253  115s
     7    16  927.30891    3  604 -8497.8146 1352.63922   116%  3138  120s
    15    32  632.29725    4  627 -8497.8146 1223.88514   114%  4544  125s
    31    49 -5895.7762    5  178 -8497.8146  919.04791   111%  6738  138s
    48    81 -5754.3780    6  215 -8497.8146  912.02453   111%  6732  149s
    80   222 -5886.4594    7  197 -8497.8146  912.02453   111%  5063  158s
   221   311 -6018.3540    9  189 -8497.8146  912.02453   111%  2572  163s
   339   324 -6053.0520   10  178 -8497.8146  912.02453   111%  1982  169s
   438   333 -6200.1525   12  173 -8497.8146  912.02453   111%  1737  176s
   516   355 -6240.1023   12  180 -8497.8146  912.02453   111%  1649  182s
   576   375     cutoff   13      -8497.8146  912.02453   111%  1656  187s
   614   406 -6159.0807   12  178 -8497.8146  912.02453   111%  1691  193s
   667   448 -7677.3200   13  143 -8497.8146  863.66757   110%  1684  197s
   725   492 -8485.8227   13  101 -8497.8146  632.28803   107%  1661  201s
H  739   492                    -8447.168527  632.28803   107%  1647  201s
   777   546 -610.25907    8  349 -8447.1685  632.28803   107%  1635  207s
   860   602 -717.46312    9  418 -8447.1685  632.28803   107%  1582  211s
   932   676 -929.99122    9  361 -8447.1685  632.28803   107%  1564  217s
  1027   703 -1163.8525   10  393 -8447.1685  632.28803   107%  1522  223s
  1084   742 -1123.1989   11  423 -8447.1685  546.06949   106%  1514  230s
  1151   770 -6563.1535   10  136 -8447.1685  546.06949   106%  1541  236s
  1184   806 -1292.7869   11  372 -8447.1685  546.06949   106%  1554  241s
  1236   827 -5409.8303   11  154 -8447.1685  546.06949   106%  1559  245s
  1297   865 -4842.9467   11  410 -8447.1685  546.06949   106%  1537  252s
  1375   924 -1584.5911   12  376 -8447.1685  546.06949   106%  1509  257s
  1463  1009 -1974.3349   13  264 -8447.1685  -14.04921   100%  1501  262s
  1583  1097 -3126.9784   12  349 -8447.1685  -14.04921   100%  1468  268s
  1725  1183 -8184.2404    8  115 -8447.1685  -14.04921   100%  1427  275s
  1845  1253 -8153.4727   13  115 -8447.1685 -109.09573  98.7%  1415  281s
  1985  1275 -2180.5144   14  261 -8447.1685 -109.09573  98.7%  1397  286s
  2027  1286 -7973.1840   13   97 -8447.1685 -111.77154  98.7%  1404  292s
  2078  1305 -2225.5718   14  220 -8447.1685 -111.94470  98.7%  1414  298s
  2123  1322 -2360.1057   14  318 -8447.1685 -111.94470  98.7%  1420  304s
  2180  1352 -2471.7998   15  245 -8447.1685 -111.94470  98.7%  1426  309s
  2222  1378 -2510.4049   15  249 -8447.1685 -111.94470  98.7%  1434  313s
  2272  1413 -6941.4880   15   58 -8447.1685 -111.94470  98.7%  1441  320s
  2323  1457 -2645.5388   16  222 -8447.1685 -111.94470  98.7%  1454  326s
  2389  1494 -3602.9069   17  335 -8447.1685 -111.94470  98.7%  1453  332s
  2474  1547 -2652.5726   16  278 -8447.1685 -111.94470  98.7%  1448  337s
  2591  1587 -3301.4694   17  223 -8447.1685 -265.00759  96.9%  1430  344s
  2719  1656 -7435.7653   15   72 -8447.1685 -265.00759  96.9%  1422  350s
  2875  1734 -5228.5594   17  213 -8447.1685 -351.85875  95.8%  1408  358s
  3017  1785 -8291.6210   16   70 -8447.1685 -351.85875  95.8%  1406  366s
  3129  1841 -5312.6125   22  252 -8447.1685 -425.25560  95.0%  1401  373s
  3246  1940     cutoff   26      -8447.1685 -490.31319  94.2%  1391  379s
  3441  2061 -8217.1625   29  161 -8447.1685 -490.31319  94.2%  1367  388s
  3701  2150 -1703.9672    9  373 -8447.1685 -503.08971  94.0%  1336  396s
  3965  2247 -2993.9510   14  313 -8447.1685 -647.92223  92.3%  1323  406s
  4180  2351 -5497.5115   20  221 -8447.1685 -685.40243  91.9%  1331  415s
  4430  2428 -1578.3743   10  514 -8447.1685 -699.79907  91.7%  1331  425s
  4683  2516 -2683.3986   13  472 -8447.1685 -699.79907  91.7%  1336  435s
  4948  2589 -4071.2250   17  349 -8447.1685 -898.71821  89.4%  1340  444s
  5173  2696 -7997.3776   20  358 -8447.1685 -904.31177  89.3%  1337  453s
  5433  2697 -6135.7923   10  612 -8447.1685 -982.40249  88.4%  1341  532s
  5435  2698 -3227.9438   12  121 -8447.1685 -982.40249  88.4%  1341  554s
  5436  2699 -8051.3526   11  441 -8447.1685 -982.40249  88.4%  1340  565s
  5437  2700 -7833.2923   51  513 -8447.1685 -982.40249  88.4%  1340  573s
  5438  2700 -1623.7255   14  482 -8447.1685 -982.40249  88.4%  1340  577s
  5439  2701 -2834.6197   14  494 -8447.1685 -982.40249  88.4%  1340  581s
  5441  2702 -4089.7433   13  507 -8447.1685 -982.40249  88.4%  1339  587s
  5444  2704 -3560.5977   20  592 -8447.1685 -982.40249  88.4%  1338  590s
  5447  2706 -7139.0526   43  600 -8447.1685 -982.40249  88.4%  1338  596s
  5449  2708 -5768.1167   12  607 -8447.1685 -982.40249  88.4%  1337  600s
  5451  2709 -4154.9674   15  531 -8447.1685 -982.40249  88.4%  1337  606s
  5454  2711 -4842.0103   33  532 -8447.1685 -982.40249  88.4%  1336  612s
  5456  2712 -6371.2252   10  542 -8447.1685 -982.40249  88.4%  1336  617s
  5458  2714 -6738.4556   19  534 -8447.1685 -982.40249  88.4%  1335  623s
  5459  2714 -8261.7179    9  558 -8447.1685 -982.40249  88.4%  1335  625s
  5462  2716 -6890.6867   14  569 -8447.1685 -982.40249  88.4%  1334  632s
  5464  2718 -6101.6866   11  567 -8447.1685 -982.40249  88.4%  1334  635s
  5465  2718 -5016.8992   19  567 -8447.1685 -982.40249  88.4%  1333  659s
  5466  2719 -7242.0532   12  567 -8447.1685 -982.40249  88.4%  1333  680s
  5467  2723 -982.40249   12  554 -8447.1685 -982.40249  88.4%  1361  687s
  5469  2726 -982.40249   13  532 -8447.1685 -982.40249  88.4%  1361  698s
  5473  2733 -982.40249   14  547 -8447.1685 -982.40249  88.4%  1364  706s
  5481  2746 -982.40249   15  597 -8447.1685 -982.40249  88.4%  1371  715s
  5497  2754 -6404.8157   16  199 -8447.1685 -982.40249  88.4%  1390  731s
  5516  2775 -1449.9026   17  299 -8447.1685 -982.40249  88.4%  1423  738s
  5548  2841 -1609.8924   18  261 -8447.1685 -982.40249  88.4%  1439  748s
  5677  2816 -2265.8852   21  376 -8447.1685 -982.40249  88.4%  1453  757s
  5736  2821 -6782.5262   20  191 -8447.1685 -982.40249  88.4%  1466  765s
  5789  2815 -5912.6627   21  386 -8447.1685 -982.40249  88.4%  1489  774s
  5836  2832 -2548.3736   19  279 -8447.1685 -982.40249  88.4%  1512  781s
  5889  2838 -6332.8487   22  358 -8447.1685 -982.40249  88.4%  1525  789s
  5949  2841     cutoff   23      -8447.1685 -982.40249  88.4%  1540  797s
  6028  2834 -8044.5603   23  489 -8447.1685 -982.40249  88.4%  1545  810s
  6068  2850 -8370.3386   24  331 -8447.1685 -982.40249  88.4%  1554  816s
  6113  2856 infeasible   25      -8447.1685 -982.40249  88.4%  1568  824s
  6151  2860 -3967.1956   23  342 -8447.1685 -982.40249  88.4%  1582  832s
  6200  2869 -4012.9151   24  260 -8447.1685 -982.40249  88.4%  1593  838s
  6242  2876 -4246.5385   25  359 -8447.1685 -982.40249  88.4%  1603  846s
  6290  2885 -4465.2995   26  408 -8447.1685 -982.40249  88.4%  1610  853s
  6339  2895 -4993.5426   28  309 -8447.1685 -982.40249  88.4%  1614  860s
  6401  2888 -5496.3493   30  325 -8447.1685 -982.40249  88.4%  1621  868s
  6471  2889     cutoff   32      -8447.1685 -982.40249  88.4%  1635  876s
  6548  2893 -5866.8937   34  348 -8447.1685 -982.40249  88.4%  1643  887s
  6628  2899 -7212.7067   39  205 -8447.1685 -982.40249  88.4%  1656  896s
  6732  2886 -2965.7151   21  244 -8447.1685 -982.40249  88.4%  1665  904s
  6829  2882 -3663.8203   24  230 -8447.1685 -1090.8378  87.1%  1680  912s
  6910  2907 -4598.1238   26  302 -8447.1685 -1090.8378  87.1%  1693  922s
  7021  2922 -5083.0298   29  273 -8447.1685 -1143.1541  86.5%  1710  931s
  7135  2918 -5477.3475   33  186 -8447.1685 -1164.2389  86.2%  1725  941s
  7274  2900 -7886.7757   39  255 -8447.1685 -1177.2591  86.1%  1743  952s
  7413  2864 -6576.0463   18  432 -8447.1685 -1333.7448  84.2%  1753  962s
  7507  2860 -6618.5394   19  420 -8447.1685 -1333.7448  84.2%  1770  971s
  7625  2880 -6763.6534   20  407 -8447.1685 -1669.4769  80.2%  1783  979s
  7779  2875 -7324.7259   22  377 -8447.1685 -1669.4769  80.2%  1789  988s
  7953  2863 -7956.8642   24  388 -8447.1685 -1958.6678  76.8%  1799  999s
  8120  2815     cutoff   24      -8447.1685 -2337.7896  72.3%  1811 1010s
  8340  2776     cutoff   20      -8447.1685 -2391.4936  71.7%  1817 1024s
  8554  2732 -3715.0620   22  318 -8447.1685 -2391.4936  71.7%  1827 1036s
  8731  2676 -5994.2623   24  343 -8447.1685 -2564.8904  69.6%  1837 1047s
  8929  2628 -8304.5657   27  294 -8447.1685 -2725.4679  67.7%  1847 1056s
  8971  2624     cutoff   28      -8447.1685 -2840.2413  66.4%  1852 1066s
  9037  2587     cutoff   22      -8447.1685 -2906.7059  65.6%  1859 1075s
  9170  2512     cutoff   23      -8447.1685 -2906.7059  65.6%  1861 1087s
  9346  2466 -5270.4271   31  299 -8447.1685 -3341.7018  60.4%  1871 1099s
  9556  2394     cutoff   38      -8447.1685 -3341.7018  60.4%  1883 1112s
  9867  2291 -6697.5234   33  400 -8447.1685 -3445.7153  59.2%  1879 1124s
 10137  2209 -5298.2609   21  362 -8447.1685 -3777.3763  55.3%  1881 1135s
 10478  1984     cutoff   25      -8447.1685 -3949.7848  53.2%  1882 1150s
 10914  1740     cutoff   28      -8447.1685 -4200.7578  50.3%  1874 1162s
 11362  1474 -7108.3066   26  343 -8447.1685 -4429.4977  47.6%  1870 1176s
 11807  1189 -8105.7898   30  511 -8447.1685 -4429.4977  47.6%  1866 1190s
 12275   834     cutoff   22      -8447.1685 -5208.2273  38.3%  1859 1205s
 12791   366 -7806.8543   24  305 -8447.1685 -5818.7464  31.1%  1847 1217s
 13304   109 infeasible   22      -8447.1685 -6588.6263  22.0%  1816 1229s

Cutting planes:
  Gomory: 2
  MIR: 490
  Mixing: 1
  Flow cover: 1853
  Zero half: 3
  RLT: 19
  Relax-and-lift: 125

Explored 13445 nodes (24523115 simplex iterations) in 1229.92 seconds (3543.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8447.17 -8497.81 -8501.69 ... -9333.89
No other solutions better than -8447.17

Optimal solution found (tolerance 1.00e-04)
Best objective -8.447168527211e+03, best bound -8.447168527211e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1229.96s
  Master Objective (UB) = -8447.17, θ = 118247.23
  Upper Bound (UB) = -8447.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118247.23
  [DEBUG]   ✓ Scenario 0: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118247.23 ≤ Q = 118247.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118247.23 ≤ Q = 118247.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6d01bb68
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6d01bb68
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.467526e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.00s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 7480008.5855
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.301989e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130198.89    0  123 7480008.59 -130198.89   102%     -    0s
H    0     0                    -95122.78847 -130198.89  36.9%     -    0s
H    0     0                    -95386.04103 -130198.89  36.5%     -    0s
H    0     0                    -99032.97110 -130198.89  31.5%     -    0s
H    0     0                    -105766.1882 -130198.89  23.1%     -    0s
     0     0 -114075.37    0  103 -105766.19 -114075.37  7.86%     -    0s
H    0     0                    -111171.7983 -113977.85  2.52%     -    0s
H    0     0                    -111881.8762 -113977.85  1.87%     -    0s
     0     0 -113482.82    0  102 -111881.88 -113482.82  1.43%     -    0s
     0     0 -113424.46    0  102 -111881.88 -113424.46  1.38%     -    0s
     0     0 -112993.98    0   88 -111881.88 -112993.98  0.99%     -    0s
     0     0 -112653.60    0   63 -111881.88 -112653.60  0.69%     -    0s
     0     0 -112467.22    0   43 -111881.88 -112467.22  0.52%     -    0s
     0     0 -112389.86    0   50 -111881.88 -112389.86  0.45%     -    0s
     0     0 -112384.82    0   51 -111881.88 -112384.82  0.45%     -    0s
     0     0 -112113.76    0   21 -111881.88 -112113.76  0.21%     -    0s
     0     0 -112113.67    0   20 -111881.88 -112113.67  0.21%     -    0s
     0     0 -112089.06    0   18 -111881.88 -112089.06  0.19%     -    0s
     0     0 -111937.60    0   11 -111881.88 -111937.60  0.05%     -    0s
     0     0 -111914.31    0    8 -111881.88 -111914.31  0.03%     -    0s
     0     0 -111896.24    0    2 -111881.88 -111896.24  0.01%     -    0s
H    0     0                    -111887.4098 -111894.55  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 1
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (783 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -111887 -111882 -111076 ... 1.46753e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.118874097536e+05, best bound -1.118945516541e+05, gap 0.0064%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 105787.21
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111887.41
  [DEBUG]   S×d_nominal = 217674.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217674.62 + -111887.41 = 105787.21
  [DEBUG]   Current θ from Master = 118247.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12460.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20907.19
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 681.0075, Absolute Gap = 681.0075, Relative Gap = 0.080620
  Not converged yet (gap = 681.01 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xa4981992
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49690 rows and 20190 columns
Presolve time: 0.95s
Presolved: 58723 rows, 25750 columns, 365489 nonzeros
Variable types: 23491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58723 rows, 25750 columns, 365489 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25487   -1.1500344e+04   0.000000e+00   3.347610e+08      5s
   37212    6.9598933e+03   0.000000e+00   5.356303e+06     10s
   45268    9.5700235e+03   0.000000e+00   1.199171e+06     15s
   51913    9.9582001e+03   0.000000e+00   6.818953e+06     20s
   59411    1.1660119e+04   0.000000e+00   1.315803e+06     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.176344e+04, 49207 iterations, 24.27 seconds (48.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11763.4416    0  121 -239633.31 11763.4416   105%     -   25s
H    0     0                    -230937.9157 11763.4416   105%     -   25s
H    0     0                    -128053.3136 11763.4416   109%     -   25s
H    0     0                    -127646.0292 11763.4416   109%     -   25s
H    0     0                    -123765.0256 11763.4416   110%     -   25s
H    0     0                    -123513.8169 11763.4416   110%     -   25s
H    0     0                    -54103.93929 11763.4416   122%     -   25s
H    0     0                    -22029.35629 11763.4416   153%     -   26s
H    0     0                    -19142.11907 11763.4416   161%     -   26s
H    0     0                    -9436.102068 11763.4416   225%     -   26s
H    0     0                    -9333.890222 11763.4416   226%     -   26s
H    0     0                    -9220.737162 11763.4416   228%     -   26s
H    0     0                    -8716.707335 11763.4416   235%     -   26s
H    0     0                    -8688.642018 8444.74772   197%     -   34s
H    0     0                    -8586.132648 8444.74772   198%     -   34s
     0     0 8444.74772    0  408 -8586.1326 8444.74772   198%     -   34s
     0     0 7952.29529    0  400 -8586.1326 7952.29529   193%     -   37s
     0     0 7945.11510    0  341 -8586.1326 7945.11510   193%     -   37s
     0     0 7825.57615    0  345 -8586.1326 7825.57615   191%     -   38s
     0     0 7817.20864    0  344 -8586.1326 7817.20864   191%     -   38s
     0     0 7816.88287    0  348 -8586.1326 7816.88287   191%     -   39s
     0     0 5501.37984    0  378 -8586.1326 5501.37984   164%     -   46s
     0     0 5291.04757    0  380 -8586.1326 5291.04757   162%     -   48s
     0     0 5259.35149    0  380 -8586.1326 5259.35149   161%     -   49s
     0     0 5236.45777    0  379 -8586.1326 5236.45777   161%     -   50s
     0     0 5231.68558    0  380 -8586.1326 5231.68558   161%     -   51s
     0     0 5230.25258    0  381 -8586.1326 5230.25258   161%     -   51s
     0     0 5087.07493    0  380 -8586.1326 5087.07493   159%     -   53s
     0     0 5055.38567    0  381 -8586.1326 5055.38567   159%     -   54s
     0     0 5053.80689    0  377 -8586.1326 5053.80689   159%     -   54s
     0     0 5052.47884    0  381 -8586.1326 5052.47884   159%     -   55s
     0     0 5052.47884    0  381 -8586.1326 5052.47884   159%     -   55s
     0     0 3562.54562    0  437 -8586.1326 3562.54562   141%     -   63s
H    0     0                    -8513.704885 3561.91073   142%     -   63s
     0     0 3083.15162    0  439 -8513.7049 3083.15162   136%     -   66s
     0     0 2864.76595    0  454 -8513.7049 2864.76595   134%     -   68s
     0     0 2601.89615    0  395 -8513.7049 2601.89615   131%     -   70s
     0     0 2562.08528    0  485 -8513.7049 2562.08528   130%     -   72s
     0     0 2538.88844    0  479 -8513.7049 2538.88844   130%     -   73s
     0     0 2537.73925    0  399 -8513.7049 2537.73925   130%     -   73s
     0     0 2537.47325    0  402 -8513.7049 2537.47325   130%     -   73s
     0     0 2165.53362    0  508 -8513.7049 2165.53362   125%     -   78s
H    0     0                    -8501.693117 2163.66179   125%     -   79s
     0     0 2076.49080    0  518 -8501.6931 2076.49080   124%     -   80s
     0     0 2029.86036    0  507 -8501.6931 2029.86036   124%     -   81s
     0     0 1995.63737    0  516 -8501.6931 1995.63737   123%     -   82s
     0     0 1971.96125    0  453 -8501.6931 1971.96125   123%     -   83s
     0     0 1963.79739    0  461 -8501.6931 1963.79739   123%     -   84s
     0     0 1960.83952    0  529 -8501.6931 1960.83952   123%     -   84s
     0     0 1959.87027    0  467 -8501.6931 1959.87027   123%     -   84s
     0     0 1816.64282    0  506 -8501.6931 1816.64282   121%     -   88s
     0     0 1787.53986    0  516 -8501.6931 1787.53986   121%     -   89s
     0     0 1773.53332    0  522 -8501.6931 1773.53332   121%     -   90s
     0     0 1759.88318    0  516 -8501.6931 1759.88318   121%     -   90s
     0     0 1755.53756    0  516 -8501.6931 1755.53756   121%     -   90s
     0     0 1753.69506    0  519 -8501.6931 1753.69506   121%     -   91s
     0     0 1753.63045    0  519 -8501.6931 1753.63045   121%     -   91s
     0     0 1720.46999    0  503 -8501.6931 1720.46999   120%     -   93s
     0     0 1710.53712    0  508 -8501.6931 1710.53712   120%     -   96s
     0     0 1698.73620    0  570 -8501.6931 1698.73620   120%     -   97s
     0     0 1698.47003    0  570 -8501.6931 1698.47003   120%     -   97s
     0     0 1678.51764    0  513 -8501.6931 1678.51764   120%     -   98s
     0     0 1674.84200    0  573 -8501.6931 1674.84200   120%     -   99s
     0     0 1673.10267    0  513 -8501.6931 1673.10267   120%     -   99s
     0     0 1672.92368    0  520 -8501.6931 1672.92368   120%     -   99s
     0     0 1664.71718    0  571 -8501.6931 1664.71718   120%     -  100s
     0     0 1653.61455    0  522 -8501.6931 1653.61455   119%     -  101s
     0     0 1652.38149    0  528 -8501.6931 1652.38149   119%     -  101s
     0     0 1651.55949    0  535 -8501.6931 1651.55949   119%     -  102s
     0     0 1643.75034    0  522 -8501.6931 1643.75034   119%     -  103s
     0     0 1639.25972    0  526 -8501.6931 1639.25972   119%     -  103s
     0     0 1639.01608    0  525 -8501.6931 1639.01608   119%     -  104s
     0     0 1633.67030    0  525 -8501.6931 1633.67030   119%     -  105s
     0     0 1630.25065    0  526 -8501.6931 1630.25065   119%     -  105s
     0     0 1628.85652    0  536 -8501.6931 1628.85652   119%     -  105s
     0     0 1628.83381    0  535 -8501.6931 1628.83381   119%     -  106s
     0     0 1625.68199    0  536 -8501.6931 1625.68199   119%     -  107s
     0     0 1623.86423    0  536 -8501.6931 1623.86423   119%     -  107s
     0     0 1623.10448    0  538 -8501.6931 1623.10448   119%     -  108s
     0     0 1622.76180    0  538 -8501.6931 1622.76180   119%     -  109s
H    0     2                    -8497.814630 1622.76180   119%     -  126s
     0     2 1622.76180    0  538 -8497.8146 1622.76180   119%     -  126s
     3     8 1341.23096    2  560 -8497.8146 1576.10112   119%  3686  136s
     7    16 1240.02105    3  576 -8497.8146 1347.55397   116%  4641  148s
    15    32  552.90952    4  581 -8497.8146 1269.67706   115%  6176  152s
    31    48 -3826.2172    5  263 -8497.8146 1088.07485   113%  6878  174s
    47    80 -1365.7328    6  273 -8497.8146 1088.07485   113%  7222  181s
    79   162 -1373.6921    7  266 -8497.8146 1088.07485   113%  5862  194s
   163   240 -1427.3516    9  262 -8497.8146 1088.07485   113%  3789  201s
   243   285 -1620.8182    8  253 -8497.8146 1088.07485   113%  2938  206s
   292   373 -1470.8053    9  266 -8497.8146 1088.07485   113%  2779  212s
   393   417 -1711.0055    9  321 -8497.8146 1088.07485   113%  2421  219s
   504   440 -1796.6778   11  249 -8497.8146 1088.07485   113%  2155  226s
   594   471 -1797.7066   12  247 -8497.8146 1046.45694   112%  2076  233s
   673   490 -4798.1656   12  324 -8497.8146 1046.45694   112%  2152  239s
   756   522 -3099.0071   13  291 -8497.8146 1046.45694   112%  2164  246s
   824   547 -4953.0281   12  329 -8497.8146 1046.45694   112%  2169  253s
   885   591 -3305.9130   13  284 -8497.8146 1046.45694   112%  2258  259s
   957   631 -3311.0238   14  295 -8497.8146 1046.45694   112%  2297  264s
  1021   676 -4499.1828   13  230 -8497.8146 1046.45694   112%  2354  270s
  1088   732 -3457.9543   15  353 -8497.8146 1046.45694   112%  2429  277s
  1156   799 -3650.2817   16  423 -8497.8146 1046.45694   112%  2488  281s
  1250   854 -3762.9444   17  426 -8497.8146 1046.45694   112%  2507  289s
  1329   897 -6816.6733   19  258 -8497.8146 1046.45694   112%  2562  296s
  1404   965 -4455.1662   19  203 -8497.8146  896.65504   111%  2572  301s
  1492  1046 -4663.5402   21  258 -8497.8146  896.65504   111%  2583  308s
  1607  1086 infeasible   24      -8497.8146  867.24786   110%  2560  316s
  1752  1144 -5205.1878   25  314 -8497.8146  867.24786   110%  2531  323s
  1886  1229 -5381.0533   28  254 -8497.8146  866.88530   110%  2515  331s
  2026  1298 -5702.2748   28  255 -8497.8146  795.93881   109%  2491  339s
  2157  1362     cutoff   31      -8497.8146  795.93881   109%  2500  348s
  2283  1390 -6571.1457   37  304 -8497.8146  795.93881   109%  2507  355s
  2323  1416 -6783.9692   36  300 -8497.8146  445.77932   105%  2539  361s
  2361  1441 -6641.3004   38  306 -8497.8146  445.77932   105%  2553  368s
  2422  1515 -6680.9235   39  302 -8497.8146  445.77932   105%  2550  376s
  2530  1578 -7061.5988   49  181 -8497.8146  445.77932   105%  2528  384s
  2667  1658 -7153.8457   50  264 -8497.8146  438.41446   105%  2501  393s
  2792  1788 -7795.0268   55  162 -8497.8146  386.46233   105%  2489  400s
  2991  1881     cutoff   62      -8497.8146  386.46233   105%  2437  410s
H 3108  1880                    -8474.281788  386.46233   105%  2413  410s
  3158  2014 -519.52116   14  399 -8474.2818  286.80290   103%  2412  420s
  3396  2118 -2125.6755   18  277 -8474.2818  286.80290   103%  2384  431s
  3602  2196 -7724.7737   21  221 -8474.2818  205.09942   102%  2379  442s
  3806  2293 -8048.9538   22  219 -8474.2818   80.54484   101%  2375  452s
  3990  2418 -571.23986    8  396 -8474.2818   18.15866   100%  2400  462s
  4166  2419 -3808.5788   19  538 -8474.2818   18.15866   100%  2429  498s
  4168  2420 -7749.4057   23  121 -8474.2818   18.15866   100%  2428  528s
  4169  2421 -6588.2644   18  447 -8474.2818   18.15866   100%  2427  540s
  4170  2422 -7463.9729   26  511 -8474.2818   18.15866   100%  2427  550s
  4171  2422 -6473.5935   23  485 -8474.2818   18.15866   100%  2426  557s
  4172  2423 -7204.2381   42  548 -8474.2818   18.15866   100%  2425  562s
  4173  2424 -4187.4160   26  516 -8474.2818   18.15866   100%  2425  565s
  4176  2426 -7656.7013   16  535 -8474.2818   18.15866   100%  2423  570s
  4179  2428 -7787.1021   37  542 -8474.2818   18.15866   100%  2421  579s
  4180  2428 -3883.7254   33  573 -8474.2818   18.15866   100%  2421  582s
  4183  2430 -6773.0056   28  534 -8474.2818   18.15866   100%  2419  589s
  4184  2431 -4442.7239   18  522 -8474.2818   18.15866   100%  2418  590s
  4189  2434 -4325.0693   28  518 -8474.2818   18.15866   100%  2416  598s
  4191  2436 -6605.8924   18  525 -8474.2818   18.15866   100%  2414  600s
  4193  2437 -2637.0783   19  372 -8474.2818   18.15866   100%  2413  605s
  4194  2438 -4628.4908   13  516 -8474.2818   18.15866   100%  2413  611s
  4197  2440 -7033.7993   13  457 -8474.2818   18.15866   100%  2411  615s
  4200  2442 -6921.9207   12  481 -8474.2818   18.15866   100%  2409  622s
  4202  2443 -6112.8492   29  543 -8474.2818   18.15866   100%  2408  627s
  4204  2444 -4393.2762   18  548 -8474.2818   18.15866   100%  2407  631s
  4205  2445 -8325.7643   41  548 -8474.2818   18.15866   100%  2406  665s
  4206  2446 -6473.7939   10  548 -8474.2818   18.15866   100%  2406  678s
  4207  2449   18.15866   12  532 -8474.2818   18.15866   100%  2450  706s
  4209  2453   18.15866   13  534 -8474.2818   18.15866   100%  2454  718s
  4213  2459   18.15866   14  540 -8474.2818   18.15866   100%  2458  737s
  4221  2473   18.15866   15  542 -8474.2818   18.15866   100%  2472  747s
  4237  2488 -1878.1312   16  524 -8474.2818   18.15866   100%  2515  768s
  4258  2511 -2888.5889   17  288 -8474.2818   18.15866   100%  2572  783s
  4290  2577 -3798.9144   18  347 -8474.2818   18.15866   100%  2608  800s
  4405  2557 -4347.8478   20  364 -8474.2818   18.15866   100%  2677  810s
  4455  2544 -5785.4757   20  226 -8474.2818   18.15866   100%  2673  825s
  4518  2543 -6568.8570   19  273 -8474.2818   18.15866   100%  2675  836s
  4576  2540 -5051.7693   21  350 -8474.2818   18.15866   100%  2677  846s
  4639  2534 -4619.6541   21  257 -8474.2818   18.15866   100%  2682  859s
  4700  2534 -7029.8137   21  231 -8474.2818   18.15866   100%  2687  868s
  4745  2529 -5563.4904   22  230 -8474.2818   18.15866   100%  2692  878s
  4800  2519     cutoff   23      -8474.2818   18.15866   100%  2685  888s
  4862  2514     cutoff   22      -8474.2818   18.15866   100%  2684  898s
  4924  2506 -3402.3571   17  464 -8474.2818   18.15866   100%  2685  907s
  4968  2526 -4409.5771   18  440 -8474.2818   18.15866   100%  2686  916s
  5024  2539 -4506.0890   19  424 -8474.2818   18.15866   100%  2680  925s
  5091  2534 -4913.7931   20  445 -8474.2818 -100.78520  98.8%  2673  935s
  5165  2539 -5869.9801   21  501 -8474.2818 -376.44976  95.6%  2670  945s
  5241  2552 -7149.2518   22  416 -8474.2818 -376.44976  95.6%  2671  953s
  5313  2560 -7244.0178   23  385 -8474.2818 -376.44976  95.6%  2665  963s
  5410  2568 -7676.8226   24  387 -8474.2818 -376.44976  95.6%  2657  974s
  5507  2542     cutoff   25      -8474.2818 -376.44976  95.6%  2639  986s
  5604  2547     cutoff   21      -8474.2818 -1113.4022  86.9%  2633  997s
  5702  2541     cutoff   22      -8474.2818 -2228.4903  73.7%  2630 1008s
  5815  2524 -2821.2318   26  336 -8474.2818 -2228.4903  73.7%  2621 1018s
  5935  2490     cutoff   26      -8474.2818 -2228.4903  73.7%  2607 1031s
  6065  2467 -3138.3652   28  182 -8474.2818 -2475.4560  70.8%  2588 1045s
  6179  2462     cutoff   28      -8474.2818 -2827.0668  66.6%  2589 1057s
  6299  2419 -7105.2294   29   86 -8474.2818 -2832.1164  66.6%  2589 1070s
  6357  2408     cutoff   30      -8474.2818 -2832.1164  66.6%  2589 1082s
  6459  2372 -8197.4763   33   83 -8474.2818 -3236.6102  61.8%  2578 1097s
  6627  2299     cutoff   21      -8474.2818 -3311.1664  60.9%  2562 1111s
  6788  2277 -8416.9180   25  199 -8474.2818 -3474.6129  59.0%  2557 1130s
  6948  2231 -7225.8611   39  160 -8474.2818 -3702.2412  56.3%  2555 1145s
  7186  2175 -7943.1744   24  318 -8474.2818 -4209.0143  50.3%  2534 1161s
  7412  2062 -8373.8650   25  324 -8474.2818 -4342.7725  48.8%  2519 1177s
  7663  1943 -5883.7298   31   86 -8474.2818 -4385.3559  48.3%  2496 1193s
  7964  1763     cutoff   37      -8474.2818 -4912.9437  42.0%  2461 1209s
  8294  1557 infeasible   37      -8474.2818 -5280.2448  37.7%  2424 1225s
  8661  1287     cutoff   34      -8474.2818 -5280.2448  37.7%  2381 1243s
  9056  1022 infeasible   33      -8474.2818 -5988.6765  29.3%  2338 1260s
  9472   709 -7924.6600   25  223 -8474.2818 -6345.5336  25.1%  2282 1275s

Cutting planes:
  Learned: 5
  Gomory: 3
  MIR: 396
  Flow cover: 2094
  RLT: 25
  Relax-and-lift: 142

Explored 9829 nodes (22033678 simplex iterations) in 1275.85 seconds (3539.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8474.28 -8497.81 -8501.69 ... -9436.1
No other solutions better than -8474.28

Optimal solution found (tolerance 1.00e-04)
Best objective -8.474281788357e+03, best bound -8.474281788357e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1275.86s
  Master Objective (UB) = -8474.28, θ = 118803.71
  Upper Bound (UB) = -8474.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118803.71
  [DEBUG]   ✓ Scenario 0: θ = 118803.71 ≤ Q = 118803.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118803.71 ≤ Q = 118803.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118803.71 ≤ Q = 118803.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118803.71 ≤ Q = 118803.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118803.71 ≤ Q = 118803.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118803.71 ≤ Q = 118803.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118803.71 ≤ Q = 118803.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3e630086
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3e630086
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.369583e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6798722.4216
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.297589e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129758.93    0  122 6798722.42 -129758.93   102%     -    0s
H    0     0                    -94901.52020 -129758.93  36.7%     -    0s
H    0     0                    -95164.77276 -129758.93  36.4%     -    0s
     0     0 -106783.06    0   94 -95164.773 -106783.06  12.2%     -    0s
H    0     0                    -104177.4661 -106770.51  2.49%     -    0s
H    0     0                    -104633.7137 -106770.51  2.04%     -    0s
     0     0 -106252.89    0   92 -104633.71 -106252.89  1.55%     -    0s
     0     0 -106216.05    0   93 -104633.71 -106216.05  1.51%     -    0s
     0     0 -105969.54    0   69 -104633.71 -105969.54  1.28%     -    0s
H    0     0                    -104648.5691 -105952.73  1.25%     -    0s
     0     0 -105871.49    0   70 -104648.57 -105871.49  1.17%     -    0s
     0     0 -105863.33    0   71 -104648.57 -105863.33  1.16%     -    0s
     0     0 -105776.43    0   69 -104648.57 -105776.43  1.08%     -    0s
     0     0 -105756.31    0   69 -104648.57 -105756.31  1.06%     -    0s
     0     0 -105695.91    0   61 -104648.57 -105695.91  1.00%     -    0s
     0     0 -105680.36    0   62 -104648.57 -105680.36  0.99%     -    0s
     0     0 -105587.61    0   59 -104648.57 -105587.61  0.90%     -    0s
     0     0 -105583.32    0   59 -104648.57 -105583.32  0.89%     -    0s
     0     2 -105583.32    0   59 -104648.57 -105583.32  0.89%     -    0s
H   16    11                    -105148.3403 -105420.73  0.26%   7.5    0s
H   17    11                    -105158.9533 -105420.73  0.25%   7.1    0s
*   28     9               5    -105411.3008 -105419.38  0.01%   5.7    0s

Cutting planes:
  Gomory: 6
  MIR: 112
  Flow cover: 9
  RLT: 55

Explored 32 nodes (816 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -105411 -105159 -105148 ... 1.36958e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.054113007852e+05, best bound -1.054193842951e+05, gap 0.0077%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 112468.01
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105411.30
  [DEBUG]   S×d_nominal = 217879.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217879.31 + -105411.30 = 112468.01
  [DEBUG]   Current θ from Master = 118803.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6335.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14809.98
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 653.8943, Absolute Gap = 653.8943, Relative Gap = 0.077162
  Not converged yet (gap = 653.89 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x63995fb2
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56800 rows and 23080 columns
Presolve time: 1.10s
Presolved: 66903 rows, 29100 columns, 416879 nonzeros
Variable types: 26841 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66903 rows, 29100 columns, 416879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27623   -6.8099951e+04   0.000000e+00   2.085481e+08      5s
   38518   -1.6949031e+04   0.000000e+00   3.495264e+06     10s
   44675   -1.5830557e+04   0.000000e+00   2.991602e+07     15s
   52555   -8.2301575e+03   0.000000e+00   2.124651e+07     20s
   60026   -1.0181762e+03   0.000000e+00   1.435230e+07     25s
   65860    8.8013906e+02   0.000000e+00   2.836156e+06     30s
   71531    5.5180833e+03   0.000000e+00   1.736993e+06     35s
   77273    6.2354924e+03   0.000000e+00   6.014527e+06     40s
   82736    6.4550153e+03   0.000000e+00   4.867428e+05     45s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.175751e+04, 73078 iterations, 48.21 seconds (90.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11757.5112    0  129 -239633.31 11757.5112   105%     -   49s
H    0     0                    -226175.8618 11757.5112   105%     -   49s
H    0     0                    -123966.0650 11757.5112   109%     -   50s
H    0     0                    -123806.9555 11757.5112   109%     -   50s
H    0     0                    -53922.13248 11757.5112   122%     -   50s
H    0     0                    -15677.90507 11757.5112   175%     -   50s
H    0     0                    -14539.94927 11757.5112   181%     -   50s
H    0     0                    -14375.11867 11757.5112   182%     -   50s
H    0     0                    -14023.73406 11757.5112   184%     -   50s
H    0     0                    -13976.25423 11757.5112   184%     -   50s
H    0     0                    -8716.707335 11757.5112   235%     -   50s
H    0     0                    -8589.767844 8231.26172   196%     -   61s
H    0     0                    -8586.132648 8231.26172   196%     -   61s
     0     0 8069.58950    0  352 -8586.1326 8069.58950   194%     -   61s
     0     0 7850.72090    0  341 -8586.1326 7850.72090   191%     -   64s
     0     0 7850.72090    0  338 -8586.1326 7850.72090   191%     -   64s
     0     0 7850.72090    0  335 -8586.1326 7850.72090   191%     -   65s
     0     0 7850.72090    0  335 -8586.1326 7850.72090   191%     -   65s
     0     0 5407.33381    0  356 -8586.1326 5407.33381   163%     -   72s
H    0     0                    -8574.120880 5407.33381   163%     -   72s
     0     0 5350.67791    0  380 -8574.1209 5350.67791   162%     -   78s
     0     0 5208.87261    0  388 -8574.1209 5208.87261   161%     -   81s
     0     0 5167.20880    0  388 -8574.1209 5167.20880   160%     -   83s
     0     0 5147.95336    0  385 -8574.1209 5147.95336   160%     -   84s
     0     0 5038.80714    0  430 -8574.1209 5038.80714   159%     -   87s
H    0     0                    -8513.704885 5036.16651   159%     -   88s
     0     0 5036.16651    0  435 -8513.7049 5036.16651   159%     -   88s
     0     0 5034.83629    0  431 -8513.7049 5034.83629   159%     -   89s
     0     0 5034.23801    0  433 -8513.7049 5034.23801   159%     -   89s
     0     0 5033.96373    0  433 -8513.7049 5033.96373   159%     -   89s
H    0     0                    -8497.814630 3414.94356   140%     -  100s
     0     0 3414.94356    0  462 -8497.8146 3414.94356   140%     -  100s
     0     0 2968.17386    0  513 -8497.8146 2968.17386   135%     -  104s
     0     0 2840.26644    0  459 -8497.8146 2840.26644   133%     -  107s
     0     0 2784.96380    0  457 -8497.8146 2784.96380   133%     -  109s
     0     0 2763.70130    0  458 -8497.8146 2763.70130   133%     -  110s
     0     0 2732.12099    0  461 -8497.8146 2732.12099   132%     -  112s
     0     0 2721.17681    0  462 -8497.8146 2721.17681   132%     -  112s
     0     0 2707.28696    0  455 -8497.8146 2707.28696   132%     -  113s
     0     0 2687.67936    0  456 -8497.8146 2687.67936   132%     -  114s
     0     0 2685.55594    0  458 -8497.8146 2685.55594   132%     -  114s
     0     0 2681.59614    0  458 -8497.8146 2681.59614   132%     -  114s
     0     0 2678.23940    0  454 -8497.8146 2678.23940   132%     -  115s
     0     0 2677.81416    0  459 -8497.8146 2677.81416   132%     -  115s
     0     0 2158.07814    0  415 -8497.8146 2158.07814   125%     -  123s
     0     0 2056.35259    0  515 -8497.8146 2056.35259   124%     -  126s
     0     0 2012.06894    0  523 -8497.8146 2012.06894   124%     -  128s
     0     0 1995.28642    0  534 -8497.8146 1995.28642   123%     -  129s
     0     0 1993.06101    0  531 -8497.8146 1993.06101   123%     -  130s
     0     0 1990.58984    0  523 -8497.8146 1990.58984   123%     -  130s
     0     0 1989.25183    0  525 -8497.8146 1989.25183   123%     -  130s
     0     0 1989.25102    0  525 -8497.8146 1989.25102   123%     -  130s
     0     0 1885.75488    0  526 -8497.8146 1885.75488   122%     -  133s
     0     0 1851.81267    0  588 -8497.8146 1851.81267   122%     -  135s
     0     0 1846.83398    0  520 -8497.8146 1846.83398   122%     -  135s
     0     0 1845.55256    0  519 -8497.8146 1845.55256   122%     -  136s
     0     0 1845.40934    0  530 -8497.8146 1845.40934   122%     -  136s
     0     0 1799.54730    0  531 -8497.8146 1799.54730   121%     -  138s
     0     0 1783.00459    0  520 -8497.8146 1783.00459   121%     -  143s
     0     0 1776.92112    0  535 -8497.8146 1776.92112   121%     -  143s
     0     0 1773.45995    0  539 -8497.8146 1773.45995   121%     -  144s
     0     0 1770.15940    0  545 -8497.8146 1770.15940   121%     -  144s
     0     0 1769.00991    0  549 -8497.8146 1769.00991   121%     -  144s
     0     0 1757.67406    0  538 -8497.8146 1757.67406   121%     -  146s
     0     0 1711.82686    0  526 -8497.8146 1711.82686   120%     -  148s
     0     0 1700.75891    0  539 -8497.8146 1700.75891   120%     -  150s
     0     0 1695.09250    0  538 -8497.8146 1695.09250   120%     -  150s
     0     0 1690.80014    0  536 -8497.8146 1690.80014   120%     -  151s
     0     0 1685.79759    0  546 -8497.8146 1685.79759   120%     -  151s
     0     0 1682.72623    0  542 -8497.8146 1682.72623   120%     -  152s
     0     0 1681.84745    0  548 -8497.8146 1681.84745   120%     -  152s
     0     0 1643.93049    0  536 -8497.8146 1643.93049   119%     -  155s
     0     0 1630.48355    0  541 -8497.8146 1630.48355   119%     -  157s
     0     0 1600.34057    0  546 -8497.8146 1600.34057   119%     -  158s
     0     0 1596.41000    0  601 -8497.8146 1596.41000   119%     -  159s
     0     0 1594.23394    0  557 -8497.8146 1594.23394   119%     -  159s
     0     0 1593.61441    0  553 -8497.8146 1593.61441   119%     -  160s
     0     0 1577.89410    0  609 -8497.8146 1577.89410   119%     -  162s
     0     0 1572.85461    0  615 -8497.8146 1572.85461   119%     -  163s
     0     0 1565.89076    0  556 -8497.8146 1565.89076   118%     -  164s
     0     0 1564.45270    0  559 -8497.8146 1564.45270   118%     -  164s
     0     0 1563.85100    0  561 -8497.8146 1563.85100   118%     -  164s
     0     0 1555.24533    0  554 -8497.8146 1555.24533   118%     -  166s
     0     0 1554.96744    0  556 -8497.8146 1554.96744   118%     -  166s
     0     0 1551.50037    0  545 -8497.8146 1551.50037   118%     -  168s
     0     0 1550.06896    0  549 -8497.8146 1550.06896   118%     -  169s
     0     0 1549.94279    0  546 -8497.8146 1549.94279   118%     -  169s
     0     0 1542.84080    0  552 -8497.8146 1542.84080   118%     -  171s
     0     0 1542.43999    0  556 -8497.8146 1542.43999   118%     -  178s
     0     0 1541.41855    0  556 -8497.8146 1541.41855   118%     -  179s
     0     0 1541.21396    0  556 -8497.8146 1541.21396   118%     -  181s
     0     2 1541.21396    0  556 -8497.8146 1541.21396   118%     -  211s
     1     4 1513.63997    1  553 -8497.8146 1541.04074   118%  2407  221s
     7    16 1254.20736    3  373 -8497.8146 1436.30836   117%  4858  228s
    15    32 1111.76214    4  375 -8497.8146 1287.60443   115%  4621  235s
    31    49 -7016.3984    5  181 -8497.8146 1111.62924   113%  7716  251s
    48    77 -506.66684    6  355 -8497.8146 1110.47877   113%  7310  257s
    80   140 -865.72186    7  326 -8497.8146 1110.47877   113%  5812  273s
   150   214 -932.97328    8  322 -8497.8146 1110.47877   113%  3972  283s
   270   260 -1014.9114    9  322 -8497.8146 1110.47877   113%  2853  291s
   369   277 -5775.4702    9  165 -8497.8146 1110.47877   113%  2497  299s
   452   278 -2760.8557    9  311 -8497.8146 1110.47877   113%  2296  306s
   517   284 -1196.8736   10  313 -8497.8146 1110.47877   113%  2192  314s
   578   302 -3202.9828   11  283 -8497.8146 1110.47877   113%  2220  320s
   624   329 -3509.7434   11  313 -8497.8146 1110.47877   113%  2279  327s
   675   349 -3802.5592   12  202 -8497.8146 1110.47877   113%  2288  334s
   721   389 -5797.6280   12  232 -8497.8146 1110.47877   113%  2297  341s
   771   426 -5224.2959   13  193 -8497.8146 1110.47877   113%  2324  347s
   816   463 -4023.4512   12  212 -8497.8146 1110.47877   113%  2341  354s
   873   491 infeasible   14      -8497.8146  971.10982   111%  2339  360s
   919   535 -8126.6816   14  185 -8497.8146  970.96865   111%  2342  368s
   995   573  235.89321    7  311 -8497.8146  970.96865   111%  2303  374s
  1061   619   66.23306    8  366 -8497.8146  970.96865   111%  2250  381s
  1155   681 -7380.9492    9  107 -8497.8146  970.96865   111%  2199  388s
  1266   733 -7631.7038   10   92 -8497.8146  970.96865   111%  2102  395s
  1384   793     cutoff   12      -8497.8146  970.96865   111%  2018  403s
  1496   865 -584.47176   10  390 -8497.8146  863.81001   110%  1973  411s
  1617   945 -1419.3620   14  269 -8497.8146  863.69548   110%  1930  420s
  1749  1013 -1623.3291   16  270 -8497.8146  863.69548   110%  1894  428s
  1865  1094 -2723.1753   19  374 -8497.8146  863.69548   110%  1886  437s
  1991  1166 -3971.5676   21  372 -8497.8146  661.90839   108%  1878  446s
  2089  1256 -4371.6543   25  320 -8497.8146  661.90839   108%  1888  455s
  2245  1376 -6308.1924   35  247 -8497.8146  552.03023   106%  1850  465s
  2445  1490 -7723.7063   50  250 -8497.8146  552.03023   106%  1792  474s
  2667  1535 -4946.7151   11  363 -8497.8146  552.03023   106%  1741  484s
  2813  1553 -6626.0757   13  351 -8497.8146  552.03023   106%  1744  493s
  2903  1608 -6677.6427   14  347 -8497.8146  141.77780   102%  1747  504s
  2998  1697 -7207.2430   16  270 -8497.8146  112.69888   101%  1779  515s
  3115  1722 -8183.4615   20  194 -8497.8146  112.69888   101%  1792  523s
  3154  1749 -8265.8860   21  186 -8497.8146  112.69888   101%  1803  530s
  3214  1770     cutoff   22      -8497.8146  112.69888   101%  1806  538s
  3257  1801 -7585.3578    9  113 -8497.8146  112.69888   101%  1809  549s
  3340  1841 -7796.5939   10  110 -8497.8146  112.69888   101%  1813  559s
  3451  1905 -6419.8791   12  312 -8497.8146 -345.64389  95.9%  1804  570s
  3568  1975 -8113.6228   14  179 -8497.8146 -441.70399  94.8%  1801  582s
  3700  2042 -8182.4591   11  154 -8497.8146 -574.64311  93.2%  1798  595s
  3891  2077 -8247.0366   14  428 -8497.8146 -585.39554  93.1%  1782  609s
  4065  2129     cutoff   11      -8497.8146 -675.76392  92.0%  1795  623s
  4248  2196 -6028.4568   17  271 -8497.8146 -681.22497  92.0%  1815  638s
  4443  2280 -7332.6897   22  258 -8497.8146 -681.22497  92.0%  1819  654s
  4677  2334 -5225.0568   13  479 -8497.8146 -1044.5056  87.7%  1817  670s
  4887  2363 -4688.9208   14  312 -8497.8146 -1044.5056  87.7%  1830  686s
  5113  2411 -5073.6711   18  358 -8497.8146 -1044.5056  87.7%  1843  703s
  5375  2477     cutoff   20      -8497.8146 -1044.5056  87.7%  1848  722s
  5657  2612 -2519.8137    9  203 -8497.8146 -1044.5056  87.7%  1852  740s
  5939  2613 -7434.0072   20  556 -8497.8146 -1593.8685  81.2%  1857  788s
  5941  2614 -6024.1383   17  129 -8497.8146 -1593.8685  81.2%  1857  824s
  5942  2615 -2297.8102   19  443 -8497.8146 -1593.8685  81.2%  1856  842s
  5943  2616 -6646.8573   18  499 -8497.8146 -1593.8685  81.2%  1856  855s
  5944  2616 -2853.3676   17  489 -8497.8146 -1593.8685  81.2%  1856  862s
  5945  2617 -4415.1548   13  504 -8497.8146 -1593.8685  81.2%  1856  868s
  5946  2618 -6653.8569   14  524 -8497.8146 -1593.8685  81.2%  1855  874s
  5947  2618 -5515.4233   15  445 -8497.8146 -1593.8685  81.2%  1855  877s
  5949  2620 -4262.6492   25  545 -8497.8146 -1593.8685  81.2%  1854  882s
  5951  2621 -5334.3460   11  552 -8497.8146 -1593.8685  81.2%  1854  886s
  5953  2622 -6162.6663   47  581 -8497.8146 -1593.8685  81.2%  1853  897s
  5955  2624 -7311.5614   10  599 -8497.8146 -1593.8685  81.2%  1852  903s
  5956  2624 -6722.6753   38  442 -8497.8146 -1593.8685  81.2%  1852  909s
  5957  2625 -8000.9202   45  587 -8497.8146 -1593.8685  81.2%  1852  911s
  5959  2626 -1980.5777   16  578 -8497.8146 -1593.8685  81.2%  1851  919s
  5960  2627 -6427.6276   14  456 -8497.8146 -1593.8685  81.2%  1851  921s
  5961  2628 -5211.7353   14  544 -8497.8146 -1593.8685  81.2%  1851  927s
  5963  2629 -6627.9003   43  475 -8497.8146 -1593.8685  81.2%  1850  936s
  5965  2630 -4542.2874   16  483 -8497.8146 -1593.8685  81.2%  1849  943s
  5966  2631 -5842.8533   30  461 -8497.8146 -1593.8685  81.2%  1849  945s
  5968  2632 -6064.3734   18  466 -8497.8146 -1593.8685  81.2%  1848  951s
  5969  2633 -5284.6903   13  448 -8497.8146 -1593.8685  81.2%  1848  955s
  5970  2634 -5948.2494   31  448 -8497.8146 -1593.8685  81.2%  1848  989s
  5971  2634 -3594.6993   18  448 -8497.8146 -1593.8685  81.2%  1847 1019s
  5972  2638 -1593.8685   13  455 -8497.8146 -1593.8685  81.2%  1884 1030s
  5974  2641 -1593.8685   14  451 -8497.8146 -1593.8685  81.2%  1886 1040s
  5978  2648 -1593.8685   15  447 -8497.8146 -1593.8685  81.2%  1887 1053s
  5986  2661 -1593.8685   16  464 -8497.8146 -1593.8685  81.2%  1894 1068s
  6002  2673 -5694.1746   17  198 -8497.8146 -1593.8685  81.2%  1929 1088s
  6019  2694 -2946.3048   18  280 -8497.8146 -1593.8685  81.2%  1946 1098s
  6051  2732 -7800.0263   19  238 -8497.8146 -1593.8685  81.2%  1962 1112s
  6130  2718 -5242.5213   22  170 -8497.8146 -1593.8685  81.2%  1982 1134s
  6229  2699 -5558.5759   23  132 -8497.8146 -1593.8685  81.2%  1990 1146s
  6272  2697 -6427.5728   24  123 -8497.8146 -1593.8685  81.2%  2002 1157s
  6333  2693 -6837.1840   25  135 -8497.8146 -1593.8685  81.2%  2007 1166s
  6385  2699 -7067.9867   26  138 -8497.8146 -1593.8685  81.2%  2018 1177s
  6457  2680 -3341.9410   20  187 -8497.8146 -1593.8685  81.2%  2023 1188s
  6523  2671 -3772.5906   21  160 -8497.8146 -1593.8685  81.2%  2025 1199s
  6591  2653 infeasible   22      -8497.8146 -1593.8685  81.2%  2027 1209s
  6658  2649 -4177.6308   22  418 -8497.8146 -1593.8685  81.2%  2029 1220s
  6723  2641 -6600.6501   23  405 -8497.8146 -1593.8685  81.2%  2031 1236s
  6797  2640 -7234.1712   24  154 -8497.8146 -1593.8685  81.2%  2031 1249s
  6868  2631 -7763.0280   25  197 -8497.8146 -1593.8685  81.2%  2036 1259s
  6925  2626 -7844.4810   26  112 -8497.8146 -1593.8685  81.2%  2040 1276s
  6994  2613 -8110.8906   28  285 -8497.8146 -1593.8685  81.2%  2047 1287s
  7044  2636 -7429.3764   18  241 -8497.8146 -1593.8685  81.2%  2051 1297s
  7096  2646 -7602.9679   19  202 -8497.8146 -1593.8685  81.2%  2060 1308s
  7181  2653 -6341.7886   24  414 -8497.8146 -1593.8685  81.2%  2060 1322s
  7252  2656 -6398.2814   25  376 -8497.8146 -1593.8685  81.2%  2064 1331s
  7286  2665 -6422.5518   26  207 -8497.8146 -1593.8685  81.2%  2070 1346s
  7326  2676 -7261.1444   27  196 -8497.8146 -1593.8685  81.2%  2076 1380s
  7373  2684 -7594.5718   28  337 -8497.8146 -1593.8685  81.2%  2076 1391s
  7443  2690 -7623.2694   29  301 -8497.8146 -1593.8685  81.2%  2077 1404s
  7522  2685 -8088.5588   34  188 -8497.8146 -1593.8685  81.2%  2076 1417s
  7618  2683 -7938.9417   23  207 -8497.8146 -1593.8685  81.2%  2085 1429s
  7725  2685 -8205.2831   25  205 -8497.8146 -1593.8685  81.2%  2090 1443s
  7835  2684     cutoff   20      -8497.8146 -1641.3782  80.7%  2099 1457s
  7959  2704 -8252.0082   21  411 -8497.8146 -1641.3782  80.7%  2104 1474s
  8098  2689 -8401.4599   22  302 -8497.8146 -1641.3782  80.7%  2106 1489s
  8249  2652 -8419.9295   22  233 -8497.8146 -1641.3782  80.7%  2109 1506s
  8390  2623     cutoff   28      -8497.8146 -2346.9002  72.4%  2114 1522s
  8561  2586 -5564.0696   27  223 -8497.8146 -2346.9002  72.4%  2115 1537s
  8732  2565 -7171.2698   30  255 -8497.8146 -2927.8432  65.5%  2114 1554s
  8926  2551 -8256.5786   36  207 -8497.8146 -3240.5943  61.9%  2111 1571s
  9102  2487     cutoff   28      -8497.8146 -3356.8349  60.5%  2118 1591s
  9311  2418 -6497.0177   33  334 -8497.8146 -3483.1715  59.0%  2116 1611s
  9536  2308     cutoff   28      -8497.8146 -4144.7182  51.2%  2118 1630s
  9773  2202     cutoff   32      -8497.8146 -4245.2016  50.0%  2116 1651s
 10020  2032 infeasible   30      -8497.8146 -4530.1712  46.7%  2110 1673s
 10277  1907 -8077.3765   27  352 -8497.8146 -4547.1576  46.5%  2106 1694s
 10517  1739 -6254.2080   27  290 -8497.8146 -4919.5852  42.1%  2110 1718s
 10849  1501     cutoff   35      -8497.8146 -5258.6481  38.1%  2095 1740s
 11227  1138     cutoff   23      -8497.8146 -5258.6481  38.1%  2073 1762s
 11657   830     cutoff   24      -8497.8146 -6179.1910  27.3%  2039 1781s
 11973   652     cutoff   25      -8497.8146 -6180.7668  27.3%  2017 1796s

Cutting planes:
  Gomory: 1
  MIR: 436
  Mixing: 1
  Flow cover: 2188
  RLT: 23
  Relax-and-lift: 153

Explored 12165 nodes (24536540 simplex iterations) in 1797.97 seconds (5155.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8497.81 -8513.7 -8574.12 ... -14539.9
No other solutions better than -8497.81

Optimal solution found (tolerance 1.00e-04)
Best objective -8.497814629902e+03, best bound -8.497814629902e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1798.00s
  Master Objective (UB) = -8497.81, θ = 118941.38
  Upper Bound (UB) = -8497.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118941.38
  [DEBUG]   ✓ Scenario 0: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3de7b948
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc21846b8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.458447e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 7359065.3766
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.302462e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130246.23    0  123 7359065.38 -130246.23   102%     -    0s
H    0     0                    -95179.81192 -130246.23  36.8%     -    0s
H    0     0                    -95443.06448 -130246.23  36.5%     -    0s
     0     0 -104497.52    0   49 -95443.064 -104497.52  9.49%     -    0s
H    0     0                    -103158.3195 -104475.08  1.28%     -    0s
     0     0 -104127.91    0   30 -103158.32 -104127.91  0.94%     -    0s
H    0     0                    -103394.4241 -104037.21  0.62%     -    0s
     0     0 -104037.21    0   25 -103394.42 -104037.21  0.62%     -    0s
H    0     0                    -103409.7620 -103990.58  0.56%     -    0s
     0     0 -103990.58    0   25 -103409.76 -103990.58  0.56%     -    0s
     0     0 -103989.04    0   25 -103409.76 -103989.04  0.56%     -    0s
     0     0 -103684.44    0   23 -103409.76 -103684.44  0.27%     -    0s
H    0     0                    -103442.6616 -103661.66  0.21%     -    0s
     0     0 -103661.66    0   14 -103442.66 -103661.66  0.21%     -    0s
H    0     0                    -103450.8558 -103661.66  0.20%     -    0s
     0     0 -103570.95    0   13 -103450.86 -103570.95  0.12%     -    0s
     0     0 -103542.91    0   12 -103450.86 -103542.91  0.09%     -    0s
H    0     0                    -103486.4886 -103542.91  0.05%     -    0s
*    0     0               0    -103503.5310 -103503.53  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 8
  MIR: 7
  Flow cover: 3
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (636 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -103504 -103486 -103451 ... 1.45845e+13
No other solutions better than -103504

Optimal solution found (tolerance 1.00e-04)
Best objective -1.035035309609e+05, best bound -1.035035309609e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 114945.99
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103503.53
  [DEBUG]   S×d_nominal = 218449.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 218449.52 + -103503.53 = 114945.99
  [DEBUG]   Current θ from Master = 118941.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3995.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12493.20
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 630.3614, Absolute Gap = 630.3614, Relative Gap = 0.074179
  Not converged yet (gap = 630.36 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xd615452c
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63930 rows and 25980 columns
Presolve time: 1.26s
Presolved: 75063 rows, 32440 columns, 468209 nonzeros
Variable types: 30181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75063 rows, 32440 columns, 468209 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33648   -5.3345042e+04   0.000000e+00   1.477988e+07      5s
   45668   -4.8958725e+03   0.000000e+00   8.870932e+06     10s
   54225    3.2074960e+03   0.000000e+00   1.870908e+06     15s
   61737    5.1730485e+03   0.000000e+00   2.652581e+07     20s
   68223    6.1388238e+03   0.000000e+00   4.423399e+06     25s
   73276    6.3304199e+03   0.000000e+00   1.985330e+08     30s
   79800    8.7083404e+03   0.000000e+00   2.277130e+06     35s
   85616    9.2642534e+03   0.000000e+00   7.568470e+05     40s
   90732    9.4578300e+03   0.000000e+00   4.445462e+05     45s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.175750e+04, 80037 iterations, 47.98 seconds (96.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11757.4994    0  133 -239633.31 11757.4994   105%     -   49s
H    0     0                    -224138.0420 11757.4994   105%     -   49s
H    0     0                    -105697.7674 11757.4994   111%     -   50s
H    0     0                    -104966.7699 11757.4994   111%     -   50s
H    0     0                    -54015.89683 11757.4994   122%     -   50s
H    0     0                    -10546.49472 11757.4994   211%     -   50s
H    0     0                    -9597.054235 11757.4994   223%     -   50s
H    0     0                    -8716.707335 11757.4994   235%     -   50s
     0     0 7971.80344    0  402 -8716.7073 7971.80344   191%     -   65s
     0     0 7971.80344    0  337 -8716.7073 7971.80344   191%     -   67s
     0     0 7971.80344    0  337 -8716.7073 7971.80344   191%     -   67s
     0     0 5766.34219    0  276 -8716.7073 5766.34219   166%     -   73s
H    0     0                    -8712.828848 5766.34219   166%     -   73s
     0     0 5562.89953    0  384 -8712.8288 5562.89953   164%     -   79s
     0     0 5235.43583    0  373 -8712.8288 5235.43583   160%     -   83s
     0     0 5095.32484    0  382 -8712.8288 5095.32484   158%     -   84s
     0     0 5001.46505    0  429 -8712.8288 5001.46505   157%     -   87s
     0     0 4969.80575    0  431 -8712.8288 4969.80575   157%     -   88s
     0     0 4969.61375    0  430 -8712.8288 4969.61375   157%     -   88s
H    0     0                    -8703.511352 3595.58454   141%     -   99s
     0     0 3595.58454    0  489 -8703.5114 3595.58454   141%     -   99s
     0     0 3201.63208    0  523 -8703.5114 3201.63208   137%     -  104s
     0     0 3126.46350    0  522 -8703.5114 3126.46350   136%     -  106s
     0     0 3063.40143    0  509 -8703.5114 3063.40143   135%     -  108s
     0     0 3050.33304    0  523 -8703.5114 3050.33304   135%     -  109s
     0     0 3013.74584    0  526 -8703.5114 3013.74584   135%     -  111s
     0     0 2974.19949    0  517 -8703.5114 2974.19949   134%     -  112s
     0     0 2966.40505    0  539 -8703.5114 2966.40505   134%     -  113s
     0     0 2949.85007    0  540 -8703.5114 2949.85007   134%     -  114s
     0     0 2933.08261    0  540 -8703.5114 2933.08261   134%     -  114s
     0     0 2921.53166    0  532 -8703.5114 2921.53166   134%     -  115s
     0     0 2915.85471    0  531 -8703.5114 2915.85471   134%     -  115s
     0     0 2913.64265    0  528 -8703.5114 2913.64265   133%     -  115s
     0     0 2912.02402    0  522 -8703.5114 2912.02402   133%     -  116s
     0     0 2911.78010    0  523 -8703.5114 2911.78010   133%     -  116s
     0     0 2505.15434    0  484 -8703.5114 2505.15434   129%     -  125s
H    0     0                    -8700.817080 2504.32625   129%     -  126s
     0     0 2200.96523    0  422 -8700.8171 2200.96523   125%     -  130s
     0     0 2028.14780    0  427 -8700.8171 2028.14780   123%     -  133s
     0     0 1965.14244    0  506 -8700.8171 1965.14244   123%     -  135s
     0     0 1915.55281    0  500 -8700.8171 1915.55281   122%     -  137s
     0     0 1909.61323    0  510 -8700.8171 1909.61323   122%     -  138s
     0     0 1906.05315    0  519 -8700.8171 1906.05315   122%     -  138s
     0     0 1899.45538    0  511 -8700.8171 1899.45538   122%     -  140s
     0     0 1898.45769    0  517 -8700.8171 1898.45769   122%     -  140s
H    0     0                    -8680.691467 1898.45769   122%     -  141s
H    0     0                    -8654.464495 1786.22167   121%     -  144s
H    0     0                    -8650.702255 1786.22167   121%     -  144s
     0     0 1786.22167    0  420 -8650.7023 1786.22167   121%     -  144s
     0     0 1759.86206    0  437 -8650.7023 1759.86206   120%     -  146s
H    0     0                    -8639.949215 1750.64195   120%     -  147s
     0     0 1750.64195    0  430 -8639.9492 1750.64195   120%     -  147s
     0     0 1719.40574    0  433 -8639.9492 1719.40574   120%     -  149s
     0     0 1713.20487    0  438 -8639.9492 1713.20487   120%     -  149s
     0     0 1712.17420    0  435 -8639.9492 1712.17420   120%     -  150s
     0     0 1651.57164    0  513 -8639.9492 1651.57164   119%     -  153s
H    0     0                    -8629.507248 1649.31710   119%     -  157s
     0     0 1596.12497    0  510 -8629.5072 1596.12497   118%     -  159s
     0     0 1584.91400    0  511 -8629.5072 1584.91400   118%     -  160s
     0     0 1579.20843    0  529 -8629.5072 1579.20843   118%     -  161s
     0     0 1575.95505    0  432 -8629.5072 1575.95505   118%     -  161s
     0     0 1574.36540    0  524 -8629.5072 1574.36540   118%     -  162s
     0     0 1568.24500    0  517 -8629.5072 1568.24500   118%     -  162s
     0     0 1561.34743    0  517 -8629.5072 1561.34743   118%     -  163s
     0     0 1559.90003    0  520 -8629.5072 1559.90003   118%     -  164s
     0     0 1557.87963    0  594 -8629.5072 1557.87963   118%     -  164s
     0     0 1555.71896    0  524 -8629.5072 1555.71896   118%     -  165s
     0     0 1555.69155    0  520 -8629.5072 1555.69155   118%     -  165s
     0     0 1538.85857    0  530 -8629.5072 1538.85857   118%     -  167s
     0     0 1532.43092    0  537 -8629.5072 1532.43092   118%     -  168s
     0     0 1532.03001    0  609 -8629.5072 1532.03001   118%     -  168s
     0     0 1524.62892    0  512 -8629.5072 1524.62892   118%     -  170s
H    0     0                    -8613.388093 1524.60550   118%     -  170s
     0     0 1515.74926    0  616 -8613.3881 1515.74926   118%     -  171s
     0     0 1513.16461    0  616 -8613.3881 1513.16461   118%     -  172s
     0     0 1512.17380    0  529 -8613.3881 1512.17380   118%     -  172s
     0     0 1501.81300    0  612 -8613.3881 1501.81300   117%     -  174s
     0     0 1499.92758    0  538 -8613.3881 1499.92758   117%     -  175s
     0     0 1498.49792    0  459 -8613.3881 1498.49792   117%     -  175s
     0     0 1498.09848    0  461 -8613.3881 1498.09848   117%     -  176s
     0     0 1496.27140    0  624 -8613.3881 1496.27140   117%     -  177s
     0     0 1494.80476    0  567 -8613.3881 1494.80476   117%     -  178s
     0     0 1494.72846    0  568 -8613.3881 1494.72846   117%     -  178s
     0     0 1494.34534    0  566 -8613.3881 1494.34534   117%     -  179s
     0     0 1490.77760    0  556 -8613.3881 1490.77760   117%     -  180s
     0     0 1490.71793    0  469 -8613.3881 1490.71793   117%     -  180s
     0     0 1490.20579    0  564 -8613.3881 1490.20579   117%     -  181s
     0     0 1489.75860    0  564 -8613.3881 1489.75860   117%     -  183s
H    0     0                    -8609.509606 1489.75860   117%     -  212s
H    0     0                    -8601.060886 1489.75860   117%     -  212s
     0     2 1489.75860    0  564 -8601.0609 1489.75860   117%     -  220s
     3     8 1353.77056    2  448 -8601.0609 1382.93612   116%  3130  228s
     7    16 1203.52155    3  530 -8601.0609 1351.79616   116%  4517  238s
    15    32 1190.14879    4  527 -8601.0609 1201.18376   114%  5990  248s
    31    50 -5744.2814    5  179 -8601.0609 1190.06481   114%  7293  261s
    49    82   94.87009    6  370 -8601.0609 1190.06481   114%  8991  270s
    81   131 -665.78346    7  416 -8601.0609 1190.06481   114%  7328  279s
   138   207 -1080.3144    8  415 -8601.0609 1190.06481   114%  5664  288s
   237   278 -5140.1619    8  375 -8601.0609 1190.06481   114%  4301  298s
   345   307 -1276.5123    9  352 -8601.0609 1190.06481   114%  3565  306s
H  393   307                    -8567.740884 1190.06481   114%  3323  306s
   416   365 -3361.9976    9  266 -8567.7409 1190.06481   114%  3282  315s
   500   421 -1371.1001   10  358 -8567.7409 1190.06481   114%  3229  321s
   568   473 -1598.9843   11  361 -8567.7409 1190.06481   114%  3203  328s
   638   527 -1688.9369   12  369 -8567.7409 1190.06481   114%  3118  334s
   715   569 -1753.9668   13  416 -8567.7409 1190.06481   114%  3024  341s
   808   596 -1764.9441   14  413 -8567.7409 1190.06481   114%  2920  348s
   855   628 -1943.0971   15  354 -8567.7409 1190.06481   114%  2887  356s
   925   655 -2110.6942   15  356 -8567.7409 1190.06481   114%  2851  364s
   990   690 -2255.7582   16  258 -8567.7409 1190.06481   114%  2809  371s
H 1004   690                    -8560.701347 1190.06481   114%  2824  371s
  1087   731 -7022.2712   14  266 -8560.7013 1190.06481   114%  2743  379s
  1165   778 -2506.9020   17  338 -8560.7013 1190.06481   114%  2755  387s
  1263   834 -2834.1070   19  182 -8560.7013 1190.06481   114%  2716  394s
  1331   884 -3291.8010   20  182 -8560.7013 1190.06481   114%  2714  401s
  1429   916 -3280.9409   20  244 -8560.7013 1155.05283   113%  2690  409s
  1516   953 -3381.3650   21  180 -8560.7013 1155.05283   113%  2688  417s
  1623   996 -3456.2019   21  178 -8560.7013 1155.05283   113%  2655  426s
  1694  1050 -5693.9407   19  121 -8560.7013 1155.05283   113%  2690  435s
  1805  1115 -4353.2131   22  161 -8560.7013 1155.05283   113%  2705  445s
  1910  1206     cutoff   22      -8560.7013 1155.05283   113%  2744  454s
  2057  1248 -4791.9810   24  228 -8560.7013 1155.05283   113%  2729  464s
  2129  1274 -6394.7973   24  162 -8560.7013 1155.05283   113%  2735  474s
  2210  1327 -5003.9451   25  244 -8560.7013  806.38078   109%  2744  482s
  2315  1376 -5155.8475   26  143 -8560.7013  806.38078   109%  2769  492s
  2451  1440 -6179.4567   28  148 -8560.7013  349.98360   104%  2779  502s
  2575  1514     cutoff   32      -8560.7013  349.98360   104%  2821  513s
  2686  1613 -7056.7378   34  158 -8560.7013  349.98360   104%  2872  524s
  2850  1692 -7557.5446   39  170 -8560.7013  349.98360   104%  2858  535s
  3004  1773 -8001.8275   47  155 -8560.7013   62.89024   101%  2870  546s
  3158  1855 -4053.7726   14  497 -8560.7013   62.89024   101%  2868  556s
  3344  1933 -4942.6847   16  384 -8560.7013   62.89024   101%  2851  570s
  3515  2010 -6002.2704   18  360 -8560.7013  -13.41560   100%  2862  582s
  3656  2123 -7738.3401   23  107 -8560.7013 -233.90101  97.3%  2916  597s
  3821  2175 -7819.2192   23  185 -8560.7013 -371.56680  95.7%  2938  609s
  3946  2266 -5698.9821    9  297 -8560.7013 -371.56680  95.7%  2952  622s
  4164  2369 -6083.5217   12  407 -8560.7013 -388.17832  95.5%  2943  634s
  4343  2370 -7605.7028   26  564 -8560.7013 -388.17832  95.5%  2980  748s
  4345  2371 -5119.5357   29  133 -8560.7013 -388.17832  95.5%  2978  798s
  4346  2372 -3893.3112   20  431 -8560.7013 -388.17832  95.5%  2978  813s
  4347  2373 -6890.5469   17  498 -8560.7013 -388.17832  95.5%  2977  827s
  4348  2373 -8115.0411   28  570 -8560.7013 -388.17832  95.5%  2976  836s
  4349  2374 -7056.9030   35  564 -8560.7013 -388.17832  95.5%  2976  841s
  4350  2375 -6061.0980    7  576 -8560.7013 -388.17832  95.5%  2975  847s
  4351  2375 -5707.1885   11  568 -8560.7013 -388.17832  95.5%  2974  850s
  4353  2377 -2078.3899   16  540 -8560.7013 -388.17832  95.5%  2973  855s
  4355  2378 -7642.3434   18  619 -8560.7013 -388.17832  95.5%  2971  860s
  4359  2381 -6587.5571   33  446 -8560.7013 -388.17832  95.5%  2969  866s
  4360  2381 -2148.2293   15  550 -8560.7013 -388.17832  95.5%  2968  873s
  4361  2382 -5743.9772   11  531 -8560.7013 -388.17832  95.5%  2967  875s
  4363  2383 -5632.3359   28  534 -8560.7013 -388.17832  95.5%  2966  884s
  4364  2384 -7218.8983   19  456 -8560.7013 -388.17832  95.5%  2965  886s
  4365  2385 -7659.7969   32  443 -8560.7013 -388.17832  95.5%  2965  891s
  4368  2387 -3087.0855   27  539 -8560.7013 -388.17832  95.5%  2963  897s
  4369  2387 -8298.6931   29  670 -8560.7013 -388.17832  95.5%  2962  904s
  4370  2388 -5306.8825   10  536 -8560.7013 -388.17832  95.5%  2961  906s
  4371  2389 -6409.2489   15  529 -8560.7013 -388.17832  95.5%  2961  914s
  4372  2389 -3027.8432   20  457 -8560.7013 -388.17832  95.5%  2960  916s
  4373  2390 -5377.1610   32  454 -8560.7013 -388.17832  95.5%  2959  920s
  4375  2391 -5004.2260   20  543 -8560.7013 -388.17832  95.5%  2958  929s
  4376  2392 -7413.3354   34  466 -8560.7013 -388.17832  95.5%  2957  931s
  4377  2393 -5775.2806   16  474 -8560.7013 -388.17832  95.5%  2957  935s
  4379  2394 -8374.7452   29  472 -8560.7013 -388.17832  95.5%  2955  941s
  4380  2395 -5666.8064   27  472 -8560.7013 -388.17832  95.5%  2955  996s
  4381  2395 -3302.9968   13  472 -8560.7013 -388.17832  95.5%  2954 1022s
  4382  2399 -388.17832   12  536 -8560.7013 -388.17832  95.5%  3005 1044s
  4384  2402 -388.17832   13  533 -8560.7013 -388.17832  95.5%  3006 1062s
  4388  2409 -388.17832   14  535 -8560.7013 -388.17832  95.5%  3010 1081s
  4396  2422 -388.17832   15  536 -8560.7013 -388.17832  95.5%  3017 1095s
  4412  2433 -388.17832   16  489 -8560.7013 -388.17832  95.5%  3044 1119s
  4428  2454 -388.17832   17  491 -8560.7013 -388.17832  95.5%  3086 1137s
  4460  2531 -695.88448   18  532 -8560.7013 -388.17832  95.5%  3099 1159s
  4587  2489 -850.79095   19  513 -8560.7013 -388.17832  95.5%  3108 1171s
  4684  2455 -998.14511   19  519 -8560.7013 -388.17832  95.5%  3078 1181s
  4748  2449 -1418.0337   20  439 -8560.7013 -388.17832  95.5%  3097 1196s
  4797  2451 -2951.7378   20  240 -8560.7013 -388.17832  95.5%  3122 1206s
  4847  2448 -1641.5853   21  349 -8560.7013 -388.17832  95.5%  3144 1215s
  4904  2443     cutoff   29      -8560.7013 -388.17832  95.5%  3149 1228s
  4955  2443     cutoff   21      -8560.7013 -388.17832  95.5%  3175 1237s
  5003  2446 -1794.4603   22  370 -8560.7013 -388.17832  95.5%  3202 1247s
  5069  2440 -2231.7745   23  243 -8560.7013 -388.17832  95.5%  3190 1256s
  5116  2431 -2573.0076   24  155 -8560.7013 -388.17832  95.5%  3190 1268s
  5167  2429     cutoff   25      -8560.7013 -388.17832  95.5%  3189 1278s
  5213  2438 -5136.8200   25  328 -8560.7013 -388.17832  95.5%  3212 1288s
  5274  2453 -2861.8239   23  293 -8560.7013 -388.17832  95.5%  3220 1299s
  5326  2470 -3529.8441   24  284 -8560.7013 -388.17832  95.5%  3225 1310s
  5387  2454 -4374.9808   25  256 -8560.7013 -388.17832  95.5%  3241 1321s
  5454  2453     cutoff   25      -8560.7013 -388.17832  95.5%  3237 1336s
  5530  2447 -5936.4290   25  181 -8560.7013 -388.17832  95.5%  3236 1346s
  5583  2467 -6860.5117   26  133 -8560.7013 -388.17832  95.5%  3252 1360s
  5652  2459 -8076.5987   27  120 -8560.7013 -388.17832  95.5%  3255 1372s
  5737  2467     cutoff   27      -8560.7013 -388.17832  95.5%  3263 1384s
  5811  2457 -3894.8000   19  338 -8560.7013 -388.17832  95.5%  3266 1396s
  5851  2474 -4164.4077   20  219 -8560.7013 -388.17832  95.5%  3286 1408s
  5906  2473 -4744.8528   21  258 -8560.7013 -388.17832  95.5%  3313 1421s
  5964  2474 -4872.3445   22  251 -8560.7013 -388.17832  95.5%  3327 1432s
  6023  2479     cutoff   23      -8560.7013 -388.17832  95.5%  3326 1443s
  6089  2497 -7156.1684   23  138 -8560.7013 -388.17832  95.5%  3330 1457s
  6166  2505     cutoff   25      -8560.7013 -388.17832  95.5%  3335 1471s
  6270  2527 -4684.7000   27  346 -8560.7013 -388.17832  95.5%  3331 1485s
  6401  2521 -4778.0075   28  167 -8560.7013 -388.17832  95.5%  3313 1501s
  6544  2509 -6230.5476   30  178 -8560.7013 -388.17832  95.5%  3304 1516s
  6642  2523     cutoff   31      -8560.7013 -388.17832  95.5%  3313 1537s
  6762  2536 -6846.6808   37  316 -8560.7013 -1726.8624  79.8%  3325 1555s
  6913  2527 -7352.9734   44  373 -8560.7013 -1823.3144  78.7%  3324 1573s
  7080  2513     cutoff   53      -8560.7013 -1823.3144  78.7%  3319 1592s
  7236  2499 infeasible   22      -8560.7013 -2015.0576  76.5%  3328 1611s
  7431  2461 -3353.6738   22  367 -8560.7013 -2206.7468  74.2%  3333 1631s
  7607  2460 -4299.3346   23  358 -8560.7013 -2206.7468  74.2%  3340 1652s
  7768  2452 -5062.1197   25  455 -8560.7013 -2206.7468  74.2%  3361 1671s
  7910  2504 -5145.9871   26  338 -8560.7013 -2696.0628  68.5%  3371 1697s
  8098  2534 -8021.0769   30  186 -8560.7013 -2696.0628  68.5%  3374 1720s
  8337  2530 infeasible   35      -8560.7013 -2812.6022  67.1%  3370 1745s
  8587  2507     cutoff   23      -8560.7013 -2989.0531  65.1%  3350 1771s
  8846  2478 -8048.9463   33  140 -8560.7013 -3256.0530  62.0%  3342 1797s
  9089  2430     cutoff   44      -8560.7013 -3424.1577  60.0%  3361 1821s
  9355  2376     cutoff   20      -8560.7013 -3519.7258  58.9%  3347 1845s
  9658  2294 -4469.4153   23  287 -8560.7013 -3624.0299  57.7%  3346 1870s
  9983  2202     cutoff   30      -8560.7013 -3697.3269  56.8%  3340 1889s
 10030  2183 -5362.2915   31  250 -8560.7013 -3736.5454  56.4%  3347 1929s
 10095  2170 -5423.3362   32  193 -8560.7013 -3736.5454  56.4%  3354 1962s
 10193  2160 -7582.9999   32   14 -8560.7013 -3896.1707  54.5%  3358 1990s
 10425  2121 -7160.2197   39  190 -8560.7013 -4028.7207  52.9%  3366 2020s
 10772  2022 -6383.6857   31  204 -8560.7013 -4152.9882  51.5%  3364 2049s
 11161  1862     cutoff   23      -8560.7013 -4324.8439  49.5%  3373 2081s
 11576  1673 -8343.2123   29  142 -8560.7013 -4590.5742  46.4%  3379 2115s
 12087  1533     cutoff   31      -8560.7013 -4838.4337  43.5%  3357 2149s
 12604  1422     cutoff   24      -8560.7013 -4936.5121  42.3%  3344 2183s
 13103  1235     cutoff   42      -8560.7013 -5367.4602  37.3%  3334 2218s
 13695   954 -7462.1531   22  502 -8560.7013 -5536.1373  35.3%  3309 2254s
 14392   529 -8303.2806   24  452 -8560.7013 -5828.0805  31.9%  3270 2293s
 15315   383 infeasible   23      -8560.7013 -6504.8904  24.0%  3172 2330s
 15540   280     cutoff   30      -8560.7013 -6504.8904  24.0%  3152 2363s
 15754   104 -8192.7076   31  385 -8560.7013 -6539.4043  23.6%  3139 2400s
 16065     4 infeasible   34      -8560.7013 -6832.4906  20.2%  3102 2429s
 16204     0 infeasible   25      -8560.7013 -7329.8367  14.4%  3083 2450s

Cutting planes:
  MIR: 509
  Mixing: 1
  Flow cover: 2466
  Zero half: 2
  RLT: 17
  Relax-and-lift: 149

Explored 16210 nodes (50231630 simplex iterations) in 2450.70 seconds (7199.44 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8560.7 -8567.74 -8601.06 ... -8680.69
No other solutions better than -8560.7

Optimal solution found (tolerance 1.00e-04)
Best objective -8.560701347051e+03, best bound -8.560701347051e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2450.75s
  Master Objective (UB) = -8560.70, θ = 118890.34
  Upper Bound (UB) = -8560.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118890.34
  [DEBUG]   ✓ Scenario 0: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118890.34 ≤ Q = 118890.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6fe86273
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x90179d8d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.363321e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6792067.4680
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.295932e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129593.22    0  122 6792067.47 -129593.22   102%     -    0s
H    0     0                    -94730.12224 -129593.22  36.8%     -    0s
H    0     0                    -94993.37481 -129593.22  36.4%     -    0s
     0     0 -101146.36    0   94 -94993.375 -101146.36  6.48%     -    0s
H    0     0                    -97848.41586 -101030.15  3.25%     -    0s
H    0     0                    -98589.34584 -101030.15  2.48%     -    0s
     0     0 -100522.49    0   94 -98589.346 -100522.49  1.96%     -    0s
H    0     0                    -98896.45038 -100497.37  1.62%     -    0s
     0     0 -100497.37    0   94 -98896.450 -100497.37  1.62%     -    0s
     0     0 -100338.37    0   97 -98896.450 -100338.37  1.46%     -    0s
     0     0 -100331.92    0   97 -98896.450 -100331.92  1.45%     -    0s
     0     2 -100331.92    0   97 -98896.450 -100331.92  1.45%     -    0s
H   44    48                    -98897.52088 -99922.294  1.04%  17.6    0s
H  526   376                    -98921.39670 -99774.604  0.86%   7.0    0s
H  531   376                    -99061.41679 -99774.604  0.72%   7.0    0s
H  536   376                    -99077.86012 -99774.604  0.70%   6.9    0s
*  546   376              17    -99298.83339 -99774.604  0.48%   6.9    0s
H  774   246                    -99393.13883 -99562.739  0.17%   6.7    0s
H  776   246                    -99415.62815 -99562.739  0.15%   6.6    0s

Cutting planes:
  Gomory: 48
  Implied bound: 8
  MIR: 230

Explored 1081 nodes (6598 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -99415.6 -99393.1 -99298.8 ... -94993.4
No other solutions better than -99415.6

Optimal solution found (tolerance 1.00e-04)
Best objective -9.941562815066e+04, best bound -9.941562815066e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 118436.31
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99415.63
  [DEBUG]   S×d_nominal = 217851.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217851.93 + -99415.63 = 118436.31
  [DEBUG]   Current θ from Master = 118890.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 454.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9014.73
  Lower Bound (LB) = -9014.73
  Gap (UB-LB) = 454.0336, Absolute Gap = 454.0336, Relative Gap = 0.053037
  Not converged yet (gap = 454.03 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x71ed3e53
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 71040 rows and 28870 columns
Presolve time: 1.24s
Presolved: 83243 rows, 35790 columns, 510349 nonzeros
Variable types: 33531 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398565.1771
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.560e+06
 Factor NZ  : 7.673e+06 (roughly 100 MB of memory)
 Factor Ops : 1.319e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80655183e+07  1.51188340e+08  9.73e+04 2.21e+01  7.82e+04     2s
   1  -1.35602130e+07  1.30840191e+08  6.65e+04 7.27e+01  5.29e+04     2s
   2  -4.46268300e+06  1.02659773e+08  2.12e+04 3.32e-11  1.79e+04     2s
   3  -7.08343235e+05  6.80285368e+07  1.33e+03 1.19e+00  1.49e+03     2s
   4  -4.49619599e+05  2.19240186e+07  3.14e+02 2.45e-01  3.60e+02     2s
   5  -3.07457326e+05  1.56367561e+07  9.76e+01 1.55e-01  1.66e+02     3s
   6  -1.69092902e+05  1.13401204e+07  2.16e+01 1.03e-01  8.70e+01     3s
   7  -1.27579838e+05  6.89183629e+06  1.13e+01 5.93e-02  5.01e+01     3s
   8  -9.77219671e+04  3.49459816e+06  5.45e+00 2.82e-02  2.47e+01     3s
   9  -8.64751307e+04  2.09997634e+06  3.87e+00 1.66e-02  1.48e+01     3s
  10  -6.54212086e+04  4.43274519e+05  1.65e+00 3.19e-03  3.40e+00     3s
  11  -3.61249671e+04  1.49967439e+05  6.75e-01 1.02e-03  1.23e+00     3s
  12  -2.66623032e+04  8.68492538e+04  5.22e-01 1.53e-03  7.51e-01     3s
  13  -2.09571396e+04  6.59631025e+04  4.43e-01 1.79e-03  5.75e-01     3s
  14  -1.84546426e+04  5.21012723e+04  4.06e-01 1.56e-03  4.67e-01     3s
  15  -1.28958840e+04  4.37077761e+04  3.29e-01 1.32e-03  3.75e-01     3s
  16  -8.80937297e+03  3.63478642e+04  2.78e-01 1.83e-03  2.99e-01     3s
  17  -5.13573211e+03  3.13382364e+04  2.29e-01 1.66e-03  2.42e-01     3s
  18  -1.95882369e+03  2.64773265e+04  1.90e-01 1.74e-03  1.88e-01     3s
  19   1.08006265e+03  2.32424538e+04  1.52e-01 1.39e-03  1.47e-01     3s
  20   3.03475649e+03  2.08979993e+04  1.28e-01 1.68e-03  1.18e-01     3s
  21   4.74322837e+03  1.97171302e+04  1.07e-01 1.52e-03  9.92e-02     3s
  22   5.59406183e+03  1.79880373e+04  9.73e-02 1.66e-03  8.22e-02     3s
  23   7.27653146e+03  1.72010537e+04  7.81e-02 1.48e-03  6.58e-02     3s
  24   8.54796649e+03  1.65528317e+04  6.37e-02 1.61e-03  5.31e-02     3s
  25   9.54269145e+03  1.59936183e+04  5.28e-02 1.25e-03  4.28e-02     3s
  26   1.05724923e+04  1.57836296e+04  4.26e-02 1.23e-03  3.46e-02     3s
  27   1.13866731e+04  1.53414419e+04  3.41e-02 1.86e-03  2.63e-02     3s
  28   1.21355825e+04  1.51431814e+04  2.64e-02 1.21e-03  2.00e-02     3s
  29   1.29230171e+04  1.50034381e+04  1.79e-02 1.82e-03  1.38e-02     3s
  30   1.34949037e+04  1.48600935e+04  1.20e-02 8.90e-04  9.07e-03     3s
  31   1.37588457e+04  1.47848591e+04  9.37e-03 8.27e-04  6.82e-03     3s
  32   1.39933008e+04  1.47627515e+04  6.90e-03 6.43e-04  5.11e-03     4s
  33   1.41695549e+04  1.47394561e+04  5.14e-03 4.51e-04  3.79e-03     4s
  34   1.43060205e+04  1.47258180e+04  3.73e-03 3.24e-04  2.79e-03     4s
  35   1.44355016e+04  1.47089229e+04  2.46e-03 2.71e-04  1.82e-03     4s
  36   1.44760959e+04  1.47030091e+04  2.03e-03 1.89e-04  1.51e-03     4s
  37   1.45177051e+04  1.47006455e+04  1.61e-03 1.64e-04  1.22e-03     4s
  38   1.46072685e+04  1.46947350e+04  7.51e-04 9.84e-05  5.81e-04     4s
  39   1.46657038e+04  1.46880677e+04  1.91e-04 2.29e-05  1.48e-04     4s
  40   1.46706353e+04  1.46874184e+04  1.45e-04 1.25e-05  1.11e-04     4s
  41   1.46825512e+04  1.46869656e+04  3.63e-05 5.07e-06  2.93e-05     4s
  42   1.46861089e+04  1.46866890e+04  3.83e-06 5.31e-06  3.84e-06     4s
  43   1.46866361e+04  1.46866405e+04  4.77e-08 6.06e-08  2.91e-08     4s
  44   1.46866379e+04  1.46866397e+04  1.42e-07 1.28e-07  1.23e-08     4s
  45   1.46866397e+04  1.46866397e+04  3.11e-08 3.78e-10  7.41e-11     4s

Barrier solved model in 45 iterations and 4.02 seconds (6.74 work units)
Optimal objective 1.46866397e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1351 PPushes remaining with PInf 5.5479943e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7384360e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40377    1.4686640e+04   0.000000e+00   0.000000e+00      6s
   40377    1.4686640e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.468664e+04, 40377 iterations, 4.19 seconds (8.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14686.6397    0  176 -239633.31 14686.6397   106%     -    6s
H    0     0                    -228819.5924 14686.6397   106%     -    6s
H    0     0                    -159770.6811 14686.6397   109%     -    6s
H    0     0                    -157992.8281 14686.6397   109%     -    6s
H    0     0                    -157143.4299 14686.6397   109%     -    6s
H    0     0                    -52399.62526 14686.6397   128%     -    6s
H    0     0                    -42319.92499 14686.6397   135%     -    6s
H    0     0                    -22314.93456 14686.6397   166%     -    6s
H    0     0                    -21982.24317 14686.6397   167%     -    6s
H    0     0                    -19099.66087 14686.6397   177%     -    7s
H    0     0                    -15813.21249 14686.6397   193%     -    8s
H    0     0                    -15477.18727 14686.6397   195%     -    8s
H    0     0                    -13323.03790 14686.6397   210%     -    8s
H    0     0                    -13314.33317 14686.6397   210%     -    8s
H    0     0                    -13269.39921 14686.6397   211%     -    8s
H    0     0                    -13241.47199 14686.6397   211%     -    8s
     0     0 9264.17852    0  336 -13241.472 9264.17852   170%     -   21s
H    0     0                    -13027.33190 9260.15163   171%     -   21s
H    0     0                    -12975.03451 9260.15163   171%     -   21s
H    0     0                    -12944.00839 9260.15163   172%     -   21s
H    0     0                    -12876.13752 9260.15163   172%     -   21s
     0     0 9091.95069    0  336 -12876.138 9091.95069   171%     -   24s
     0     0 8946.02268    0  332 -12876.138 8946.02268   169%     -   28s
     0     0 8320.18873    0  380 -12876.138 8320.18873   165%     -   39s
     0     0 8320.18873    0  361 -12876.138 8320.18873   165%     -   43s
     0     0 8311.42953    0  384 -12876.138 8311.42953   165%     -   45s
     0     0 8311.42953    0  384 -12876.138 8311.42953   165%     -   46s
H    0     0                    -10748.78751 6502.16458   160%     -   64s
H    0     0                    -10217.74167 6502.16458   164%     -   64s
H    0     0                    -10121.38338 6502.16458   164%     -   64s
H    0     0                    -10088.29628 6502.16458   164%     -   64s
H    0     0                    -10073.91392 6502.16458   165%     -   64s
H    0     0                    -10071.58675 6502.16458   165%     -   64s
     0     0 6502.16458    0  362 -10071.587 6502.16458   165%     -   64s
H    0     0                    -9992.241756 6502.13019   165%     -   64s
H    0     0                    -9989.673509 6502.13019   165%     -   64s
     0     0 5737.94671    0  455 -9989.6735 5737.94671   157%     -   72s
     0     0 5664.65402    0  367 -9989.6735 5664.65402   157%     -   75s
     0     0 5654.63250    0  351 -9989.6735 5654.63250   157%     -   76s
     0     0 5615.10242    0  362 -9989.6735 5615.10242   156%     -   79s
     0     0 5609.67407    0  365 -9989.6735 5609.67407   156%     -   80s
     0     0 5609.01137    0  365 -9989.6735 5609.01137   156%     -   81s
     0     0 4086.25909    0  473 -9989.6735 4086.25909   141%     -  102s
H    0     0                    -9761.696893 4085.54835   142%     -  102s
H    0     0                    -9737.509535 4085.54835   142%     -  102s
     0     0 3569.80665    0  481 -9737.5095 3569.80665   137%     -  114s
     0     0 3399.48057    0  492 -9737.5095 3399.48057   135%     -  120s
     0     0 3304.68354    0  484 -9737.5095 3304.68354   134%     -  124s
     0     0 3278.79638    0  494 -9737.5095 3278.79638   134%     -  126s
     0     0 3242.60983    0  498 -9737.5095 3242.60983   133%     -  129s
     0     0 3220.97834    0  502 -9737.5095 3220.97834   133%     -  132s
     0     0 3216.77891    0  504 -9737.5095 3216.77891   133%     -  132s
     0     0 3214.00063    0  566 -9737.5095 3214.00063   133%     -  133s
     0     0 3206.93733    0  566 -9737.5095 3206.93733   133%     -  134s
     0     0 3144.67008    0  575 -9737.5095 3144.67008   132%     -  137s
     0     0 3140.63515    0  511 -9737.5095 3140.63515   132%     -  139s
     0     0 3130.81041    0  578 -9737.5095 3130.81041   132%     -  140s
     0     0 3126.18576    0  579 -9737.5095 3126.18576   132%     -  140s
     0     0 3125.99578    0  579 -9737.5095 3125.99578   132%     -  141s
     0     0 2578.02959    0  571 -9737.5095 2578.02959   126%     -  153s
     0     0 2320.39447    0  497 -9737.5095 2320.39447   124%     -  161s
     0     0 2265.07252    0  444 -9737.5095 2265.07252   123%     -  164s
     0     0 2195.83965    0  448 -9737.5095 2195.83965   123%     -  167s
     0     0 2159.78481    0  454 -9737.5095 2159.78481   122%     -  170s
     0     0 2152.11623    0  445 -9737.5095 2152.11623   122%     -  171s
     0     0 2135.35581    0  455 -9737.5095 2135.35581   122%     -  173s
     0     0 2099.43364    0  582 -9737.5095 2099.43364   122%     -  177s
     0     0 2090.61607    0  455 -9737.5095 2090.61607   121%     -  178s
     0     0 2064.50478    0  522 -9737.5095 2064.50478   121%     -  181s
     0     0 2063.51516    0  465 -9737.5095 2063.51516   121%     -  182s
     0     0 1969.92724    0  585 -9737.5095 1969.92724   120%     -  188s
     0     0 1936.94916    0  581 -9737.5095 1936.94916   120%     -  191s
     0     0 1898.13738    0  600 -9737.5095 1898.13738   119%     -  194s
     0     0 1890.61292    0  587 -9737.5095 1890.61292   119%     -  195s
     0     0 1887.96869    0  579 -9737.5095 1887.96869   119%     -  195s
     0     0 1886.37657    0  579 -9737.5095 1886.37657   119%     -  196s
     0     0 1817.49616    0  526 -9737.5095 1817.49616   119%     -  203s
H    0     0                    -8989.918414 1816.93825   120%     -  204s
H    0     0                    -8986.283218 1816.93825   120%     -  204s
     0     0 1806.11506    0  528 -8986.2832 1806.11506   120%     -  207s
     0     0 1803.14709    0  530 -8986.2832 1803.14709   120%     -  208s
     0     0 1796.36043    0  533 -8986.2832 1796.36043   120%     -  209s
     0     0 1790.67368    0  471 -8986.2832 1790.67368   120%     -  210s
     0     0 1789.21790    0  477 -8986.2832 1789.21790   120%     -  211s
     0     0 1754.40546    0  459 -8986.2832 1754.40546   120%     -  214s
H    0     0                    -8921.218839 1754.13999   120%     -  214s
H    0     0                    -8819.211575 1754.13999   120%     -  214s
H    0     0                    -8681.753344 1754.13999   120%     -  214s
H    0     0                    -8678.118148 1754.13999   120%     -  214s
     0     0 1750.50062    0  463 -8678.1181 1750.50062   120%     -  215s
     0     0 1746.40093    0  472 -8678.1181 1746.40093   120%     -  216s
     0     0 1737.84209    0  463 -8678.1181 1737.84209   120%     -  217s
     0     0 1737.28958    0  467 -8678.1181 1737.28958   120%     -  217s
     0     0 1729.66172    0  474 -8678.1181 1729.66172   120%     -  219s
H    0     0                    -8674.239660 1729.28605   120%     -  219s
     0     0 1727.70970    0  482 -8674.2397 1727.70970   120%     -  220s
     0     0 1727.46494    0  482 -8674.2397 1727.46494   120%     -  220s
     0     0 1720.44657    0  483 -8674.2397 1720.44657   120%     -  222s
     0     0 1717.12750    0  486 -8674.2397 1717.12750   120%     -  223s
     0     0 1716.49297    0  486 -8674.2397 1716.49297   120%     -  223s
     0     0 1714.72349    0  584 -8674.2397 1714.72349   120%     -  225s
H    0     0                    -8652.733857 1714.47935   120%     -  226s
     0     0 1714.47935    0  513 -8652.7339 1714.47935   120%     -  227s
     0     0 1709.45124    0  520 -8652.7339 1709.45124   120%     -  229s
     0     0 1708.88436    0  520 -8652.7339 1708.88436   120%     -  231s
     0     2 1708.88436    0  520 -8652.7339 1708.88436   120%     -  275s
     2     5 1428.11935    2  497 -8652.7339 1707.87192   120%  4838  285s
     4     9 1113.13952    3  488 -8652.7339 1642.39712   119%  6047  295s
     8    18 1274.53194    3  369 -8652.7339 1511.34077   117%  6599  310s
    17    36  733.91327    4  357 -8652.7339 1425.87560   116%  7060  320s
    35    50 1218.18232    5  492 -8652.7339 1331.33296   115%  9421  340s
H   49    78                    -8639.537874 1331.33296   115%  9678  356s
    77   157  382.83595    7  451 -8639.5379 1331.33296   115%  7655  373s
   156   228 -1958.5916    9  236 -8639.5379 1331.33296   115%  5262  385s
   235   289 -2039.6656   10  229 -8639.5379 1331.33296   115%  5038  396s
   302   316 -2942.5528   13  198 -8639.5379 1331.33296   115%  4567  405s
   331   354 -3018.4089   14  191 -8639.5379 1331.33296   115%  4468  414s
   379   371 -3069.6174   15  191 -8639.5379 1331.33296   115%  4341  425s
   410   392 -3441.1690   16  186 -8639.5379 1331.33296   115%  4198  434s
   445   411 -418.23027   16  344 -8639.5379 1331.33296   115%  4099  445s
   482   447 -4316.7376   17  192 -8639.5379 1331.33296   115%  4003  455s
   524   465 -4378.6446   18  207 -8639.5379 1331.33296   115%  3924  465s
   559   495 -4396.6118   19  202 -8639.5379 1331.33296   115%  3817  474s
   609   527 -4442.1342   20  194 -8639.5379 1331.33296   115%  3674  485s
   661   556 -4444.7704   21  196 -8639.5379 1210.29819   114%  3620  497s
   700   598 -4486.3750   22  219 -8639.5379 1210.29819   114%  3585  507s
   752   647 -4511.3423   23  217 -8639.5379 1210.29819   114%  3507  517s
   815   693 -4518.2298   24  215 -8639.5379 1210.29819   114%  3411  525s
   887   725 -4549.3516   25  226 -8639.5379 1210.29819   114%  3287  536s
   961   769 -4562.4925   27  223 -8639.5379 1169.85454   114%  3193  547s
  1035   828 -7646.7080   34  282 -8639.5379 1023.11473   112%  3154  557s
  1110   889 -7681.2071   35  287 -8639.5379  973.72956   111%  3085  568s
  1196   936 infeasible   36      -8639.5379  973.72956   111%  3007  579s
  1294   998 infeasible   37      -8639.5379  973.72956   111%  2937  590s
  1402  1080 -4036.8751   10  533 -8639.5379  973.72956   111%  2888  602s
  1512  1142 -4558.7654   12  382 -8639.5379  973.72956   111%  2860  616s
  1634  1204 -5106.3430   15  364 -8639.5379  973.72956   111%  2803  629s
  1768  1257 -5762.2220   20  286 -8639.5379  973.72956   111%  2744  644s
  1933  1310 -6058.6022   22  444 -8639.5379  973.72956   111%  2674  658s
  2091  1354 -6353.3238   26  352 -8639.5379  895.82899   110%  2618  673s
  2231  1394 -6689.2687   30  342 -8639.5379  895.82899   110%  2602  690s
  2357  1462 -7828.9369   35  338 -8639.5379  895.82899   110%  2598  707s
  2485  1556 -8460.0261   40  271 -8639.5379  895.82899   110%  2589  723s
  2631  1650 -8152.1839   29  324 -8639.5379  803.95615   109%  2586  740s
  2792  1765     cutoff   31      -8639.5379  803.95615   109%  2580  758s
  3005  1812 -5632.7439   17  441 -8639.5379  661.74358   108%  2526  777s
  3134  1886 -6092.7666   19  373 -8639.5379  661.74358   108%  2528  796s
  3288  1978 -7342.2800   24  426 -8639.5379  642.19421   107%  2539  816s
  3450  2076 -8118.5509   30  340 -8639.5379  642.19421   107%  2554  837s
  3641  2174 -8265.9722   34  254 -8639.5379  353.52684   104%  2554  857s
  3875  2269 -5380.0450   13  121 -8639.5379  348.13131   104%  2531  879s
  4080  2306     cutoff   17      -8639.5379  303.39500   104%  2533  897s
  4192  2371 -7926.0844   16  118 -8639.5379  164.45774   102%  2541  929s
  4330  2471 -7060.6682   14  111 -8639.5379  140.21622   102%  2567  954s
  4525  2472 -7403.1128   11  520 -8639.5379  103.40994   101%  2577 1033s
  4527  2473 -7346.0013   54  135 -8639.5379  103.40994   101%  2576 1042s
  4528  2474 -4251.9548    8  430 -8639.5379  103.40994   101%  2575 1070s
  4529  2475 -4505.9765   26  451 -8639.5379  103.40994   101%  2574 1087s
  4530  2475 -3471.3364   17  401 -8639.5379  103.40994   101%  2574 1105s
  4531  2476 -3774.8208   17  486 -8639.5379  103.40994   101%  2573 1119s
  4532  2477 -4505.9765   26  485 -8639.5379  103.40994   101%  2573 1130s
  4533  2477 -7324.0594   53  444 -8639.5379  103.40994   101%  2572 1137s
  4534  2478 -6677.8241   32  509 -8639.5379  103.40994   101%  2572 1143s
  4535  2479 -5395.4475   41  524 -8639.5379  103.40994   101%  2571 1147s
  4536  2479 -4992.7877   14  573 -8639.5379  103.40994   101%  2570 1150s
  4538  2481 -5656.2139   12  518 -8639.5379  103.40994   101%  2569 1157s
  4540  2482 -7654.6920   49  577 -8639.5379  103.40994   101%  2568 1162s
  4541  2483 -2705.7145   20  562 -8639.5379  103.40994   101%  2568 1165s
  4543  2484 -6874.1065   19  599 -8639.5379  103.40994   101%  2567 1180s
  4544  2485 -1108.5287   13  516 -8639.5379  103.40994   101%  2566 1187s
  4545  2485 -5797.9715   19  522 -8639.5379  103.40994   101%  2565 1191s
  4547  2487 -7149.9152   37  540 -8639.5379  103.40994   101%  2564 1195s
  4549  2488 -4670.9152   32  526 -8639.5379  103.40994   101%  2563 1206s
  4550  2489 -8287.2177   30  509 -8639.5379  103.40994   101%  2563 1210s
  4552  2490 -4856.9389   11  609 -8639.5379  103.40994   101%  2561 1217s
  4553  2491 -5976.7380   23  656 -8639.5379  103.40994   101%  2561 1228s
  4554  2491 -7148.6329   13  666 -8639.5379  103.40994   101%  2560 1232s
  4555  2492 -5908.3899   19  618 -8639.5379  103.40994   101%  2560 1236s
  4556  2493 -6420.3461   33  476 -8639.5379  103.40994   101%  2559 1243s
  4557  2493 -4004.9193   33  475 -8639.5379  103.40994   101%  2559 1245s
  4558  2494 -7857.8257   18  475 -8639.5379  103.40994   101%  2558 1253s
  4559  2495 -7678.1382   38  483 -8639.5379  103.40994   101%  2557 1257s
  4560  2495 -5547.6482   26  556 -8639.5379  103.40994   101%  2557 1264s
  4561  2496 -5777.8023   13  484 -8639.5379  103.40994   101%  2556 1268s
  4562  2497 -5182.0388   12  574 -8639.5379  103.40994   101%  2556 1275s
  4564  2498 -1014.8291   12  574 -8639.5379  103.40994   101%  2555 1281s
  4565  2499 -6798.6425   36  487 -8639.5379  103.40994   101%  2554 1288s
  4566  2499 -6206.7711   30  575 -8639.5379  103.40994   101%  2554 1292s
  4567  2500 -7397.4238   15  623 -8639.5379  103.40994   101%  2553 1297s
  4568  2501 -4879.4438   26  623 -8639.5379  103.40994   101%  2552 1310s
  4569  2501 -8048.0387   13  623 -8639.5379  103.40994   101%  2552 1344s
  4570  2505  103.40994   10  614 -8639.5379  103.40994   101%  2611 1379s
  4572  2508  103.40994   11  567 -8639.5379  103.40994   101%  2615 1401s
  4576  2515  103.40994   12  615 -8639.5379  103.40994   101%  2620 1417s
  4584  2528  103.40994   13  545 -8639.5379  103.40994   101%  2626 1431s
  4600  2538 -2409.1515   14  300 -8639.5379  103.40994   101%  2665 1462s
  4616  2558 -6164.7179   15  189 -8639.5379  103.40994   101%  2686 1492s
  4647  2651 -6266.8658   16  180 -8639.5379  103.40994   101%  2744 1521s
  4768  2644 -6984.9940   20  144 -8639.5379  103.40994   101%  2827 1533s
  4821  2640 -7965.3799   21  134 -8639.5379  103.40994   101%  2857 1547s
  4883  2640     cutoff   21      -8639.5379  103.40994   101%  2901 1560s
  4939  2644 infeasible   22      -8639.5379  103.40994   101%  2942 1577s
  5008  2633 -4819.9864   20  464 -8639.5379  103.40994   101%  2972 1600s
  5061  2631 -5535.3548   21  236 -8639.5379  103.40994   101%  3009 1614s
  5113  2628 -7625.9096   23  196 -8639.5379  103.40994   101%  3062 1632s
  5166  2617 infeasible   25      -8639.5379  103.40994   101%  3108 1651s
  5212  2614 -8187.1293   25  195 -8639.5379  103.40994   101%  3148 1674s
  5263  2617 infeasible   26      -8639.5379  103.40994   101%  3189 1693s
  5302  2624 -3756.0201   18  311 -8639.5379  103.40994   101%  3234 1706s
  5347  2629 -1900.2765   24  328 -8639.5379  103.40994   101%  3265 1722s
  5386  2630 -3846.7111   19  385 -8639.5379  103.40994   101%  3295 1739s
  5428  2639 -3888.5572   20  390 -8639.5379  103.40994   101%  3319 1753s
  5470  2653 -3928.5150   21  390 -8639.5379  103.40994   101%  3348 1769s
  5507  2664 -4138.4049   22  402 -8639.5379  103.40994   101%  3380 1786s
  5553  2671 -4190.6474   23  392 -8639.5379  103.40994   101%  3399 1802s
  5597  2680 -5241.9925   24  272 -8639.5379  103.40994   101%  3432 1822s
  5638  2692 -5833.4700   25  362 -8639.5379  103.40994   101%  3463 1839s
  5695  2699 -5925.6063   26  360 -8639.5379  103.40994   101%  3492 1857s
  5750  2709 -6181.5340   28  469 -8639.5379  103.40994   101%  3529 1878s
  5834  2720 infeasible   29      -8639.5379  103.40994   101%  3556 1897s
  5916  2716 -7940.9748   31  508 -8639.5379  103.40994   101%  3600 1916s
  5968  2727 -8255.4550   32  297 -8639.5379  103.40994   101%  3634 1933s
  6045  2723     cutoff   33      -8639.5379  103.40994   101%  3667 1951s
  6136  2728 -8490.5246   33  425 -8639.5379 -561.17601  93.5%  3710 1974s
  6242  2738 -8524.3979   34  425 -8639.5379 -561.17601  93.5%  3734 1998s
  6347  2741 -8535.8518   35  427 -8639.5379 -561.17601  93.5%  3772 2022s
  6452  2744 infeasible   27      -8639.5379 -752.92067  91.3%  3815 2046s
  6563  2760 infeasible   31      -8639.5379 -877.24149  89.8%  3856 2069s
  6668  2749 -5107.5191   23  508 -8639.5379 -923.97753  89.3%  3908 2092s
  6784  2765 -6835.8412   25  184 -8639.5379 -923.97753  89.3%  3967 2115s
  6908  2769 -8068.4170   28  431 -8639.5379 -1323.5856  84.7%  4020 2144s
  7034  2753 infeasible   31      -8639.5379 -1494.8615  82.7%  4067 2168s
H 7078  2612                    -8596.841442 -1686.0472  80.4%  4094 2168s
H 7078  2492                    -8584.714380 -1686.0472  80.4%  4094 2168s
  7109  2553 -2526.8365   24  364 -8584.7144 -1686.0472  80.4%  4110 2197s
  7240  2553 -7252.4720   29   51 -8584.7144 -1693.2594  80.3%  4150 2226s
  7370  2568 -2741.0012   25  528 -8584.7144 -1693.2594  80.3%  4219 2259s
  7500  2582 -3353.7887   30  572 -8584.7144 -1693.2594  80.3%  4276 2293s
  7648  2613 -4613.7906   34  381 -8584.7144 -1963.7112  77.1%  4331 2325s
  7819  2597 -6853.6940   39  452 -8584.7144 -2120.2949  75.3%  4372 2358s
  8016  2575 infeasible   32      -8584.7144 -2188.7752  74.5%  4415 2395s
  8192  2537 -7622.8836   30  325 -8584.7144 -2264.6703  73.6%  4446 2431s
H 8245  2406                    -8569.150067 -2427.5473  71.7%  4466 2431s
  8275  2455 -8242.0228   33  367 -8569.1501 -2427.5473  71.7%  4490 2474s
  8473  2478 -6035.8497   23  434 -8569.1501 -2427.5473  71.7%  4542 2514s
  8676  2487 -7833.4562   27  477 -8569.1501 -2427.5473  71.7%  4589 2554s
  8910  2472 infeasible   29      -8569.1501 -2622.7215  69.4%  4638 2598s
  9136  2476 infeasible   19      -8569.1501 -2727.5890  68.2%  4681 2642s
  9354  2407 -7165.7002   31  338 -8569.1501 -2785.6476  67.5%  4735 2676s
  9410  2427 -7944.2458   32  388 -8569.1501 -2785.6476  67.5%  4762 2714s
  9466  2450 -8068.2493   33  435 -8569.1501 -2785.6476  67.5%  4778 2756s
  9627  2455 -8085.3406   34  318 -8569.1501 -2823.8245  67.0%  4803 2801s
  9888  2447 -3569.7125   22  196 -8569.1501 -2868.8319  66.5%  4844 2853s
 10149  2451 infeasible   23      -8569.1501 -2973.9095  65.3%  4890 2902s
 10414  2422 -4961.6372   31  454 -8569.1501 -3038.3836  64.5%  4952 2957s
 10751  2333 infeasible   36      -8569.1501 -3113.3533  63.7%  5009 3014s
 11055  2332 -7016.6793   40  370 -8569.1501 -3181.8255  62.9%  5073 3072s
 11454  2390 -7940.8689   21  229 -8569.1501 -3273.4309  61.8%  5067 3131s
 11812  2399 -4691.9622   30  380 -8569.1501 -3393.0246  60.4%  5122 3177s
 11876  2464 -4787.5326   31  371 -8569.1501 -3423.1745  60.1%  5144 3234s
 12143  2501 -7987.8613   39  276 -8569.1501 -3447.8841  59.8%  5188 3297s
 12555  2509 -6508.7100   30  349 -8569.1501 -3593.9174  58.1%  5237 3369s
 13001  2554 -5080.8701   24  513 -8569.1501 -3767.6165  56.0%  5282 3435s
 13432  2561 -7374.1977   36  429 -8569.1501 -3781.2920  55.9%  5354 3505s
 13872  2572 -7840.0656   20  215 -8569.1501 -4046.8228  52.8%  5417 3580s
 14371  2562 infeasible   39      -8569.1501 -4227.0301  50.7%  5452 3600s

Cutting planes:
  Learned: 3
  MIR: 794
  Flow cover: 3930
  RLT: 62
  Relax-and-lift: 248

Explored 14520 nodes (79533772 simplex iterations) in 3600.04 seconds (10963.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8569.15 -8584.71 -8639.54 ... -8986.28

Time limit reached
Best objective -8.569150067232e+03, best bound -4.227030055951e+03, gap 50.6715%
  WARNING: Time limit reached. Using best solution found (gap: 50.67%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -8569.15, θ = 118871.33
  Upper Bound (UB) = -8569.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118871.33
  [DEBUG]   ✓ Scenario 0: θ = 118871.33 ≤ Q = 118871.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118871.33 ≤ Q = 118871.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118871.33 ≤ Q = 118871.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118871.33 ≤ Q = 118871.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118871.33 ≤ Q = 118871.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118871.33 ≤ Q = 118871.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118871.33 ≤ Q = 118871.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118871.33 ≤ Q = 118871.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118871.33 ≤ Q = 118871.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 118871.33 ≤ Q = 118871.33 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3187cdcd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3187cdcd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.363321e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6792354.4330
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.296367e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129636.67    0  122 6792354.43 -129636.67   102%     -    0s
H    0     0                    -94776.50398 -129636.67  36.8%     -    0s
H    0     0                    -95039.75654 -129636.67  36.4%     -    0s
     0     0 -102115.88    0   94 -95039.757 -102115.88  7.45%     -    0s
H    0     0                    -98608.70651 -102000.38  3.44%     -    0s
     0     0 -101384.65    0   95 -98608.707 -101384.65  2.82%     -    0s
H    0     0                    -99884.85789 -101345.86  1.46%     -    0s
     0     0 -101200.29    0   96 -99884.858 -101200.29  1.32%     -    0s
     0     0 -101189.81    0   96 -99884.858 -101189.81  1.31%     -    0s
     0     2 -101189.65    0   96 -99884.858 -101189.65  1.31%     -    0s
H   50    27                    -100466.9571 -100676.74  0.21%  14.8    0s

Cutting planes:
  Gomory: 53
  Implied bound: 6
  MIR: 182
  RLT: 1

Explored 173 nodes (1822 simplex iterations) in 0.07 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -100467 -99884.9 -98608.7 ... 1.36332e+13
No other solutions better than -100467

Optimal solution found (tolerance 1.00e-04)
Best objective -1.004669571403e+05, best bound -1.004669571403e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 117412.35
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100466.96
  [DEBUG]   S×d_nominal = 217879.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217879.31 + -100466.96 = 117412.35
  [DEBUG]   Current θ from Master = 118871.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1458.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10028.13
  Lower Bound (LB) = -9014.73
  Gap (UB-LB) = 445.5849, Absolute Gap = 445.5849, Relative Gap = 0.051999
  Not converged yet (gap = 445.58 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x19c307f3
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78170 rows and 31770 columns
Presolve time: 1.35s
Presolved: 91403 rows, 39130 columns, 556211 nonzeros
Variable types: 36871 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398491.9958
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 637
 AA' NZ     : 3.025e+06
 Factor NZ  : 7.068e+06 (roughly 100 MB of memory)
 Factor Ops : 1.287e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84858953e+07  1.65192331e+08  9.95e+04 2.12e+01  7.95e+04     2s
   1  -1.39402352e+07  1.43327879e+08  6.85e+04 7.22e+01  5.43e+04     2s
   2  -4.55111641e+06  1.12462385e+08  2.13e+04 8.06e-01  1.77e+04     2s
   3  -1.05103660e+06  7.62637960e+07  2.94e+03 1.11e+00  2.72e+03     3s
   4  -5.24148361e+05  4.88275382e+07  4.45e+02 4.42e-01  6.16e+02     3s
   5  -4.40605802e+05  2.89213845e+07  2.23e+02 2.18e-01  3.20e+02     3s
   6  -3.37096367e+05  1.99893188e+07  7.56e+01 1.37e-01  1.65e+02     3s
   7  -1.91465177e+05  1.44480834e+07  9.73e+00 9.23e-02  9.22e+01     3s
   8  -1.34737561e+05  6.44276409e+06  4.82e+00 3.88e-02  4.05e+01     3s
   9  -9.79952796e+04  2.68655294e+06  2.93e+00 1.49e-02  1.70e+01     3s
  10  -6.00579754e+04  1.45059469e+06  1.33e+00 7.80e-03  9.11e+00     3s
  11  -3.95929076e+04  3.81232017e+05  6.56e-01 1.77e-03  2.53e+00     3s
  12  -2.57005018e+04  1.52629885e+05  3.34e-01 8.47e-04  1.07e+00     3s
  13  -1.94357198e+04  1.01522445e+05  2.44e-01 1.29e-03  7.24e-01     3s
  14  -1.28169308e+04  7.74271170e+04  1.69e-01 7.98e-04  5.40e-01     3s
  15  -8.68198946e+03  5.57143892e+04  1.32e-01 1.54e-03  3.85e-01     3s
  16  -5.84552042e+03  4.46562875e+04  1.15e-01 1.30e-03  3.02e-01     3s
  17  -1.87568908e+03  3.78678468e+04  9.21e-02 1.50e-03  2.38e-01     3s
  18   1.94142920e+03  3.14818285e+04  6.92e-02 1.72e-03  1.77e-01     3s
  19   3.75679009e+03  2.77098533e+04  5.85e-02 2.00e-03  1.43e-01     3s
  20   6.43239153e+03  2.36639316e+04  4.37e-02 1.59e-03  1.03e-01     3s
  21   7.61647492e+03  2.21695948e+04  3.72e-02 1.20e-03  8.70e-02     3s
  22   8.71521995e+03  2.02637326e+04  3.14e-02 1.32e-03  6.90e-02     3s
  23   9.93158741e+03  1.89112959e+04  2.50e-02 1.04e-03  5.37e-02     3s
  24   1.12212763e+04  1.76373479e+04  1.82e-02 1.08e-03  3.83e-02     3s
  25   1.17875555e+04  1.66593816e+04  1.55e-02 6.50e-04  2.91e-02     3s
  26   1.27045145e+04  1.60743266e+04  1.11e-02 4.51e-04  2.01e-02     3s
  27   1.31631485e+04  1.57985558e+04  8.90e-03 3.06e-04  1.58e-02     3s
  28   1.37288334e+04  1.55734285e+04  6.15e-03 2.29e-04  1.10e-02     3s
  29   1.40954670e+04  1.54592328e+04  4.39e-03 1.81e-04  8.15e-03     3s
  30   1.41764564e+04  1.53544348e+04  4.03e-03 1.34e-04  7.04e-03     3s
  31   1.43237405e+04  1.53383465e+04  3.36e-03 1.31e-04  6.07e-03     4s
  32   1.43596960e+04  1.52680517e+04  3.20e-03 9.89e-05  5.43e-03     4s
  33   1.45305031e+04  1.51929415e+04  2.41e-03 6.06e-05  3.96e-03     4s
  34   1.45787431e+04  1.51813556e+04  2.19e-03 5.59e-05  3.60e-03     4s
  35   1.46523224e+04  1.51641543e+04  1.85e-03 4.84e-05  3.06e-03     4s
  36   1.46989890e+04  1.51379650e+04  1.62e-03 3.86e-05  2.62e-03     4s
  37   1.47532995e+04  1.51045140e+04  1.35e-03 2.23e-05  2.10e-03     4s
  38   1.48828432e+04  1.50837652e+04  7.59e-04 4.52e-05  1.20e-03     4s
  39   1.49421380e+04  1.50731348e+04  4.80e-04 3.54e-05  7.83e-04     4s
  40   1.49843385e+04  1.50631650e+04  2.85e-04 2.59e-05  4.71e-04     4s
  41   1.50141852e+04  1.50577088e+04  1.52e-04 1.51e-05  2.60e-04     4s
  42   1.50317339e+04  1.50526471e+04  7.45e-05 5.68e-06  1.25e-04     4s
  43   1.50405575e+04  1.50512211e+04  3.64e-05 2.84e-06  6.37e-05     4s
  44   1.50484353e+04  1.50500079e+04  4.14e-06 9.64e-07  9.40e-06     4s
  45   1.50495035e+04  1.50495177e+04  1.34e-08 1.13e-07  8.49e-08     4s
  46   1.50495082e+04  1.50495083e+04  2.13e-09 2.37e-11  9.05e-11     4s

Barrier solved model in 46 iterations and 4.18 seconds (7.40 work units)
Optimal objective 1.50495082e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    3184 PPushes remaining with PInf 2.9806847e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2555983e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33990    1.5049508e+04   0.000000e+00   0.000000e+00      6s
   33990    1.5049508e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.504951e+04, 33990 iterations, 4.40 seconds (9.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15049.5083    0  414 -239633.31 15049.5083   106%     -    6s
H    0     0                    -230067.2885 15049.5083   107%     -    6s
H    0     0                    -157784.4029 15049.5083   110%     -    6s
H    0     0                    -157077.5440 15049.5083   110%     -    6s
H    0     0                    -152109.1183 15049.5083   110%     -    6s
H    0     0                    -151549.7516 15049.5083   110%     -    6s
H    0     0                    -49620.50397 15049.5083   130%     -    6s
H    0     0                    -34750.60299 15049.5083   143%     -    7s
H    0     0                    -34454.24633 15049.5083   144%     -    7s
H    0     0                    -33985.88500 15049.5083   144%     -    7s
H    0     0                    -26397.13391 9864.20255   137%     -   37s
H    0     0                    -26204.95755 9864.20255   138%     -   37s
H    0     0                    -26024.97269 9864.20255   138%     -   37s
H    0     0                    -25891.86669 9864.20255   138%     -   37s
     0     0 9813.96939    0  504 -25891.867 9813.96939   138%     -   38s
H    0     0                    -25883.29310 9813.96939   138%     -   38s
     0     0 9558.03189    0  502 -25883.293 9558.03189   137%     -   45s
     0     0 9456.77698    0  466 -25883.293 9456.77698   137%     -   52s
     0     0 9456.77698    0  471 -25883.293 9456.77698   137%     -   53s
     0     0 9456.77698    0  480 -25883.293 9456.77698   137%     -   54s
     0     0 9311.60691    0  479 -25883.293 9311.60691   136%     -   55s
     0     0 9274.58900    0  504 -25883.293 9274.58900   136%     -   64s
     0     0 9260.92344    0  504 -25883.293 9260.92344   136%     -   67s
     0     0 9258.09715    0  497 -25883.293 9258.09715   136%     -   67s
     0     0 9148.08320    0  492 -25883.293 9148.08320   135%     -   70s
     0     0 9134.11007    0  485 -25883.293 9134.11007   135%     -   72s
     0     0 9133.89149    0  487 -25883.293 9133.89149   135%     -   72s
H    0     0                    -12280.74108 6742.82332   155%     -  110s
H    0     0                    -11766.23034 6742.82332   157%     -  110s
H    0     0                    -11672.19922 6742.82332   158%     -  110s
H    0     0                    -11610.52918 6742.82332   158%     -  110s
     0     0 6742.82332    0  323 -11610.529 6742.82332   158%     -  110s
H    0     0                    -10349.09219 6740.87159   165%     -  110s
H    0     0                    -10158.90642 6740.87159   166%     -  111s
H    0     0                    -9989.319589 6740.87159   167%     -  111s
H    0     0                    -9987.618377 6740.87159   167%     -  111s
H    0     0                    -9985.212313 6740.87159   168%     -  111s
H    0     0                    -9966.407380 6740.87159   168%     -  111s
H    0     0                    -9959.453787 6740.87159   168%     -  111s
H    0     0                    -9956.639897 6740.87159   168%     -  111s
     0     0 5966.70395    0  387 -9956.6399 5966.70395   160%     -  126s
     0     0 5917.62525    0  394 -9956.6399 5917.62525   159%     -  131s
     0     0 5758.20392    0  438 -9956.6399 5758.20392   158%     -  136s
H    0     0                    -9709.719816 5471.00665   156%     -  150s
H    0     0                    -9451.008895 5471.00665   158%     -  150s
     0     0 5471.00665    0  558 -9451.0089 5471.00665   158%     -  150s
H    0     0                    -9175.878560 5411.79222   159%     -  160s
H    0     0                    -9026.765048 5411.79222   160%     -  160s
H    0     0                    -8886.830254 5411.79222   161%     -  160s
H    0     0                    -8817.534773 5411.79222   161%     -  160s
     0     0 5411.79222    0  559 -8817.5348 5411.79222   161%     -  160s
     0     0 5406.84533    0  563 -8817.5348 5406.84533   161%     -  163s
     0     0 5398.87580    0  565 -8817.5348 5398.87580   161%     -  164s
     0     0 5390.59655    0  561 -8817.5348 5390.59655   161%     -  166s
     0     0 5388.08944    0  564 -8817.5348 5388.08944   161%     -  167s
     0     0 5381.60118    0  486 -8817.5348 5381.60118   161%     -  169s
     0     0 5381.18702    0  567 -8817.5348 5381.18702   161%     -  169s
     0     0 3634.17315    0  553 -8817.5348 3634.17315   141%     -  207s
H    0     0                    -8807.441991 3633.92047   141%     -  207s
H    0     0                    -8730.007785 3409.71837   139%     -  215s
     0     0 3409.71837    0  486 -8730.0078 3409.71837   139%     -  215s
     0     0 3348.27594    0  551 -8730.0078 3348.27594   138%     -  219s
H    0     0                    -8711.144464 3300.45087   138%     -  223s
H    0     0                    -8702.019949 3300.45087   138%     -  223s
H    0     0                    -8654.464495 3300.45087   138%     -  223s
     0     0 3300.45087    0  565 -8654.4645 3300.45087   138%     -  223s
     0     0 3291.41116    0  561 -8654.4645 3291.41116   138%     -  224s
     0     0 3280.98959    0  511 -8654.4645 3280.98959   138%     -  226s
     0     0 3271.94442    0  518 -8654.4645 3271.94442   138%     -  227s
     0     0 3264.65248    0  519 -8654.4645 3264.65248   138%     -  228s
     0     0 3252.12126    0  517 -8654.4645 3252.12126   138%     -  230s
     0     0 3248.80715    0  514 -8654.4645 3248.80715   138%     -  230s
     0     0 3248.45418    0  516 -8654.4645 3248.45418   138%     -  231s
     0     0 2734.84041    0  530 -8654.4645 2734.84041   132%     -  246s
     0     0 2587.81679    0  471 -8654.4645 2587.81679   130%     -  255s
     0     0 2496.89721    0  480 -8654.4645 2496.89721   129%     -  262s
     0     0 2434.81904    0  489 -8654.4645 2434.81904   128%     -  267s
     0     0 2375.80860    0  411 -8654.4645 2375.80860   127%     -  275s
     0     0 2371.50450    0  409 -8654.4645 2371.50450   127%     -  278s
     0     0 2370.13099    0  494 -8654.4645 2370.13099   127%     -  279s
     0     0 2167.91144    0  495 -8654.4645 2167.91144   125%     -  290s
     0     0 2118.95914    0  510 -8654.4645 2118.95914   124%     -  293s
     0     0 2078.62197    0  501 -8654.4645 2078.62197   124%     -  297s
     0     0 2072.36003    0  501 -8654.4645 2072.36003   124%     -  299s
     0     0 2066.18794    0  507 -8654.4645 2066.18794   124%     -  299s
     0     0 2062.50336    0  510 -8654.4645 2062.50336   124%     -  300s
     0     0 2031.46060    0  559 -8654.4645 2031.46060   123%     -  305s
     0     0 1991.85352    0  506 -8654.4645 1991.85352   123%     -  308s
     0     0 1988.32083    0  510 -8654.4645 1988.32083   123%     -  309s
     0     0 1986.89023    0  425 -8654.4645 1986.89023   123%     -  310s
     0     0 1928.14654    0  559 -8654.4645 1928.14654   122%     -  315s
H    0     0                    -8650.702255 1907.05477   122%     -  322s
     0     0 1907.05477    0  429 -8650.7023 1907.05477   122%     -  322s
     0     0 1894.65620    0  577 -8650.7023 1894.65620   122%     -  324s
     0     0 1889.79027    0  570 -8650.7023 1889.79027   122%     -  326s
     0     0 1885.14747    0  506 -8650.7023 1885.14747   122%     -  328s
     0     0 1884.48787    0  513 -8650.7023 1884.48787   122%     -  329s
     0     0 1837.66830    0  589 -8650.7023 1837.66830   121%     -  334s
H    0     0                    -8639.537874 1836.14292   121%     -  334s
     0     0 1831.24030    0  587 -8639.5379 1831.24030   121%     -  336s
     0     0 1819.01251    0  585 -8639.5379 1819.01251   121%     -  337s
     0     0 1813.00339    0  526 -8639.5379 1813.00339   121%     -  338s
     0     0 1812.57372    0  588 -8639.5379 1812.57372   121%     -  338s
     0     0 1783.47336    0  521 -8639.5379 1783.47336   121%     -  342s
     0     0 1772.50027    0  603 -8639.5379 1772.50027   121%     -  347s
     0     0 1770.67420    0  601 -8639.5379 1770.67420   120%     -  348s
     0     0 1746.32230    0  533 -8639.5379 1746.32230   120%     -  354s
     0     0 1732.62710    0  531 -8639.5379 1732.62710   120%     -  356s
     0     0 1728.04996    0  533 -8639.5379 1728.04996   120%     -  359s
     0     0 1726.78736    0  532 -8639.5379 1726.78736   120%     -  360s
     0     0 1710.61977    0  532 -8639.5379 1710.61977   120%     -  364s
     0     0 1704.46601    0  536 -8639.5379 1704.46601   120%     -  369s
     0     0 1660.53831    0  607 -8639.5379 1660.53831   119%     -  373s
     0     0 1656.67293    0  535 -8639.5379 1656.67293   119%     -  374s
     0     0 1656.37829    0  606 -8639.5379 1656.37829   119%     -  374s
     0     0 1611.63574    0  735 -8639.5379 1611.63574   119%     -  382s
     0     0 1603.04746    0  530 -8639.5379 1603.04746   119%     -  386s
     0     0 1601.32807    0  604 -8639.5379 1601.32807   119%     -  387s
     0     0 1593.80362    0  604 -8639.5379 1593.80362   118%     -  391s
     0     0 1585.23267    0  746 -8639.5379 1585.23267   118%     -  404s
     0     0 1580.74209    0  544 -8639.5379 1580.74209   118%     -  405s
     0     0 1579.11329    0  754 -8639.5379 1579.11329   118%     -  407s
     0     0 1574.98975    0  550 -8639.5379 1574.98975   118%     -  409s
     0     0 1573.53473    0  546 -8639.5379 1573.53473   118%     -  411s
     0     0 1568.17457    0  553 -8639.5379 1568.17457   118%     -  414s
     0     0 1567.33826    0  560 -8639.5379 1567.33826   118%     -  414s
     0     0 1563.50524    0  565 -8639.5379 1563.50524   118%     -  418s
     0     0 1562.72260    0  565 -8639.5379 1562.72260   118%     -  422s
     0     2 1562.72260    0  565 -8639.5379 1562.72260   118%     -  487s
     1     3 1255.33166    1  429 -8639.5379 1562.72260   118%  9223  495s
     2     4 1314.00717    1  613 -8639.5379 1314.00717   115%  8798  503s
     3     8 1149.18669    2  527 -8639.5379 1313.93218   115%  9047  511s
     7    15  621.62607    3  424 -8639.5379 1233.12613   114%  7266  533s
    14    30    8.44076    4  421 -8639.5379 1137.60835   113%  9825  544s
    29    45  899.54763    5  546 -8639.5379 1033.04248   112% 11585  571s
    44    77  665.09815    6  433 -8639.5379 1033.04248   112% 12526  623s
    76   131  600.14272    7  419 -8639.5379  765.64095   109% 10598  644s
   140   158  170.75343    8  376 -8639.5379  760.74482   109%  7340  660s
   220   169  133.79960    9  372 -8639.5379  760.74482   109%  5814  674s
   283   196 -7700.1210   10  122 -8639.5379  760.74482   109%  5604  688s
   325   244 -7763.0530   11  109 -8639.5379  760.74482   109%  5899  701s
   389   281 -7766.4436   12  109 -8639.5379  630.11736   107%  5835  714s
   453   316 -8415.2477   16  109 -8639.5379  630.11736   107%  5598  726s
   517   340 -1881.4807   15  333 -8639.5379  630.11736   107%  5349  737s
   575   388 -1986.0472   16  269 -8639.5379  630.11736   107%  5283  749s
   639   436 -2549.7572   19  266 -8639.5379  630.11736   107%  5297  760s
   707   467 -5269.0229   21  390 -8639.5379  630.11736   107%  5289  775s
   752   492 -5401.5303   22  384 -8639.5379  630.11736   107%  5248  797s
   783   581 -5438.6095   23  177 -8639.5379  630.11736   107%  5215  807s
   886   672 -6096.4448   28  102 -8639.5379  630.11736   107%  5052  819s
   997   706     cutoff   32      -8639.5379  630.11736   107%  4814  829s
  1065   741 -7441.6639   36   70 -8639.5379  630.11736   107%  4722  841s
  1160   782 -8260.8162   42   61 -8639.5379  624.33921   107%  4582  853s
  1253   822     cutoff   42      -8639.5379  624.33921   107%  4506  864s
  1333   895 -5145.8872   25  320 -8639.5379  624.33921   107%  4547  877s
  1440   953 -6496.6880   29  187 -8639.5379  624.33921   107%  4522  890s
  1554  1012 -6819.5266   30  177 -8639.5379  624.33921   107%  4484  903s
  1681  1072 -7810.2189   34  185 -8639.5379  600.12800   107%  4411  918s
  1805  1134     cutoff   37      -8639.5379  245.92177   103%  4351  931s
  1935  1161 -4089.5703    9  418 -8639.5379  245.92177   103%  4334  946s
  2046  1191 -4643.1262   11  375 -8639.5379  207.35161   102%  4366  963s
  2132  1213 -7850.1100   13  322 -8639.5379   65.66780   101%  4475  979s
  2187  1250 -8084.2947   14  391 -8639.5379   65.66780   101%  4568  996s
  2262  1277     cutoff   15      -8639.5379   65.66780   101%  4639 1013s
  2352  1316 -6201.1970   16  266 -8639.5379   65.66780   101%  4657 1034s
  2440  1373 -7391.0728   18  284 -8639.5379    8.42768   100%  4685 1052s
  2567  1392 -8072.2771   20  379 -8639.5379    8.42768   100%  4710 1071s
  2606  1419     cutoff   21      -8639.5379    8.42768   100%  4749 1089s
  2657  1449 infeasible   22      -8639.5379 -267.19308  96.9%  4786 1109s
  2715  1506 -3389.6604    9  437 -8639.5379 -267.19308  96.9%  4818 1126s
  2792  1572 -3494.5228   10  445 -8639.5379 -267.19308  96.9%  4830 1146s
  2926  1655 -4550.4545   11  232 -8639.5379 -267.19308  96.9%  4799 1169s
  3120  1721 -4579.6465   12  238 -8639.5379 -267.19308  96.9%  4710 1189s
  3276  1759 -6653.6004   13  214 -8639.5379 -267.19308  96.9%  4719 1214s
  3358  1825 -7840.9767   14  200 -8639.5379 -267.19308  96.9%  4769 1236s
  3479  1924 -8491.2530   24  118 -8639.5379 -517.08533  94.0%  4820 1259s
  3652  2030 -7255.0772   12  109 -8639.5379 -517.08533  94.0%  4838 1285s
  3906  2148 -8237.7748   35   44 -8639.5379 -517.08533  94.0%  4744 1312s
  4143  2233 infeasible   17      -8639.5379 -517.08533  94.0%  4713 1340s
  4354  2325 -3798.2769   11  253 -8639.5379 -728.85262  91.6%  4742 1369s
  4566  2381 -8208.1156   12  146 -8639.5379 -728.85262  91.6%  4785 1396s
  4759  2474 -4992.0500    8  211 -8639.5379 -728.85262  91.6%  4749 1422s
  4960  2475 -6990.3445   11  565 -8639.5379 -728.85262  91.6%  4788 1625s
  4962  2476 -8064.9567   25  133 -8639.5379 -728.85262  91.6%  4786 1634s
  4963  2477 -3322.3578   11  451 -8639.5379 -728.85262  91.6%  4785 1678s
  4964  2478 -6355.7486   17  528 -8639.5379 -728.85262  91.6%  4784 1710s
  4965  2478 -7459.2837   24  556 -8639.5379 -728.85262  91.6%  4783 1733s
  4966  2479 -3210.4505   18  556 -8639.5379 -728.85262  91.6%  4782 1745s
  4967  2480 -6957.0917   36  556 -8639.5379 -728.85262  91.6%  4781 1756s
  4968  2480 -6066.8152   25  515 -8639.5379 -728.85262  91.6%  4780 1763s
  4969  2481 -5978.0794   19  603 -8639.5379 -728.85262  91.6%  4779 1768s
  4970  2482 -5219.1994   22  525 -8639.5379 -728.85262  91.6%  4778 1771s
  4973  2484 -5381.6037   28  549 -8639.5379 -728.85262  91.6%  4775 1777s
  4974  2484 -6771.5301   21  529 -8639.5379 -728.85262  91.6%  4774 1791s
  4975  2485 -4983.9902   14  531 -8639.5379 -728.85262  91.6%  4773 1796s
  4976  2486 -4462.4969   18  539 -8639.5379 -728.85262  91.6%  4773 1801s
  4977  2486 -6988.6539   14  539 -8639.5379 -728.85262  91.6%  4772 1806s
  4978  2487 -8342.9497   36  596 -8639.5379 -728.85262  91.6%  4771 1813s
  4979  2488 -3076.9185   19  539 -8639.5379 -728.85262  91.6%  4770 1823s
  4980  2488 -7169.5911   37  539 -8639.5379 -728.85262  91.6%  4769 1826s
  4982  2490 -3040.9888   10  448 -8639.5379 -728.85262  91.6%  4767 1838s
  4983  2490 -7841.1094   22  531 -8639.5379 -728.85262  91.6%  4766 1842s
  4984  2491 -5288.1631   24  543 -8639.5379 -728.85262  91.6%  4765 1847s
  4985  2492 -6986.8918   28  519 -8639.5379 -728.85262  91.6%  4764 1854s
  4986  2492 -4890.5526   21  456 -8639.5379 -728.85262  91.6%  4763 1857s
  4987  2493 -4905.0754   25  530 -8639.5379 -728.85262  91.6%  4762 1861s
  4988  2494 -5084.3930   30  539 -8639.5379 -728.85262  91.6%  4761 1872s
  4989  2494 -7700.3365    7  558 -8639.5379 -728.85262  91.6%  4760 1876s
  4990  2495 -1685.9437   14  543 -8639.5379 -728.85262  91.6%  4759 1883s
  4991  2496 -5664.4701   28  555 -8639.5379 -728.85262  91.6%  4758 1887s
  4992  2496 -4808.3031   21  569 -8639.5379 -728.85262  91.6%  4757 1894s
  4993  2497 -8294.5570   37  577 -8639.5379 -728.85262  91.6%  4756 1897s
  4994  2498 -3877.5377   13  575 -8639.5379 -728.85262  91.6%  4755 1906s
  4995  2498 -1307.7392    7  569 -8639.5379 -728.85262  91.6%  4754 1910s
  4996  2499 -5869.1709   10  567 -8639.5379 -728.85262  91.6%  4753 1916s
  4997  2500 -4200.1304   21  567 -8639.5379 -728.85262  91.6%  4752 1937s
  4998  2500 -7390.0403   17  567 -8639.5379 -728.85262  91.6%  4752 1981s
  4999  2504 -728.85262   16  480 -8639.5379 -728.85262  91.6%  4802 2014s
  5001  2507 -728.85262   17  603 -8639.5379 -728.85262  91.6%  4806 2036s
  5005  2514 -728.85262   18  605 -8639.5379 -728.85262  91.6%  4807 2059s
  5013  2527 -728.85262   19  604 -8639.5379 -728.85262  91.6%  4816 2083s
  5029  2537 -7469.1378   20  193 -8639.5379 -728.85262  91.6%  4855 2125s
  5046  2554 -728.85262   21  565 -8639.5379 -728.85262  91.6%  4903 2152s
  5078  2561 -4478.8745   22  478 -8639.5379 -728.85262  91.6%  4927 2186s
  5128  2577 -5189.4181   23  552 -8639.5379 -728.85262  91.6%  5018 2230s
  5194  2597 -5085.1482   24  491 -8639.5379 -728.85262  91.6%  5029 2259s
  5275  2618 -5450.8283   26  492 -8639.5379 -728.85262  91.6%  5021 2280s
  5343  2614 -5584.1019   27  484 -8639.5379 -728.85262  91.6%  5010 2296s
  5393  2622 -6496.5510   28  374 -8639.5379 -728.85262  91.6%  4996 2312s
  5442  2641 -6769.1522   29  470 -8639.5379 -728.85262  91.6%  4986 2329s
  5499  2644 infeasible   28      -8639.5379 -728.85262  91.6%  4974 2349s
  5578  2634 infeasible   29      -8639.5379 -728.85262  91.6%  4946 2373s
  5649  2614 -7047.7588   31  477 -8639.5379 -728.85262  91.6%  4929 2388s
  5687  2605 -7303.5465   32  464 -8639.5379 -728.85262  91.6%  4919 2413s
  5727  2601 -7516.5952   31  346 -8639.5379 -728.85262  91.6%  4911 2434s
  5774  2595 infeasible   32      -8639.5379 -728.85262  91.6%  4898 2460s
  5820  2576 -8400.3943   40  325 -8639.5379 -728.85262  91.6%  4892 2477s
  5874  2563     cutoff   45      -8639.5379 -728.85262  91.6%  4878 2504s
  5920  2560 -4382.0140   28  326 -8639.5379 -728.85262  91.6%  4873 2528s
  5960  2570 infeasible   29      -8639.5379 -728.85262  91.6%  4882 2550s
  6005  2579 -5370.3037   30  402 -8639.5379 -728.85262  91.6%  4886 2570s
  6054  2584 infeasible   28      -8639.5379 -728.85262  91.6%  4876 2590s
  6116  2590     cutoff   31      -8639.5379 -728.85262  91.6%  4870 2609s
  6180  2596 -3280.7622   23  450 -8639.5379 -728.85262  91.6%  4867 2629s
  6254  2589 -3755.6145   24  427 -8639.5379 -728.85262  91.6%  4859 2650s
  6327  2585 -3818.7861   25  362 -8639.5379 -728.85262  91.6%  4855 2673s
  6411  2570 -4044.0818   28  184 -8639.5379 -728.85262  91.6%  4851 2698s
  6479  2585 -4576.6185   29  198 -8639.5379 -728.85262  91.6%  4854 2727s
  6567  2600 -5818.3060   31  370 -8639.5379 -728.85262  91.6%  4853 2764s
  6663  2622 -6638.9478   35  474 -8639.5379 -728.85262  91.6%  4844 2793s
  6781  2596 -7156.3920   39  270 -8639.5379 -728.85262  91.6%  4823 2819s
  6892  2597     cutoff   44      -8639.5379 -728.85262  91.6%  4815 2849s
  7002  2595 -5987.3122   32  323 -8639.5379 -728.85262  91.6%  4807 2887s
  7136  2583 -7125.5926   37  248 -8639.5379 -728.85262  91.6%  4792 2917s
  7226  2589 -7208.3957   38  243 -8639.5379 -728.85262  91.6%  4782 2951s
  7346  2613 infeasible   40      -8639.5379 -1195.5977  86.2%  4775 2984s
  7466  2631 -5793.7519   22  437 -8639.5379 -1195.5977  86.2%  4776 3024s
  7624  2613 -5845.6267   23  340 -8639.5379 -1195.5977  86.2%  4751 3062s
  7815  2576 infeasible   41      -8639.5379 -1461.6950  83.1%  4720 3109s
  7960  2567 -8314.9246   25  143 -8639.5379 -1686.1532  80.5%  4716 3159s
  8107  2522 -8553.2656   26  163 -8639.5379 -1686.1532  80.5%  4718 3198s
  8160  2513 infeasible   27      -8639.5379 -2429.3239  71.9%  4718 3231s
  8212  2517     cutoff   26      -8639.5379 -2434.5513  71.8%  4721 3269s
  8278  2519 -7345.3341   28  424 -8639.5379 -2434.5513  71.8%  4728 3307s
  8376  2525     cutoff   29      -8639.5379 -2434.5513  71.8%  4731 3354s
  8510  2504 -8516.2934   30  416 -8639.5379 -2434.5513  71.8%  4726 3397s
  8675  2483 -8536.7831   31  420 -8639.5379 -2434.5513  71.8%  4715 3446s
  8875  2483 infeasible   32      -8639.5379 -3021.4895  65.0%  4697 3493s
  9098  2450 infeasible   31      -8639.5379 -3021.4895  65.0%  4678 3542s
  9338  2415 -6877.3336   45  297 -8639.5379 -3793.4251  56.1%  4659 3599s
  9595  2331 -8414.4663   45  357 -8639.5379 -3949.7737  54.3%  4644 3600s

Cutting planes:
  Learned: 2
  Implied bound: 10
  Projected implied bound: 60
  MIR: 776
  Flow cover: 3396
  RLT: 39
  Relax-and-lift: 248

Explored 9597 nodes (45021571 simplex iterations) in 3600.04 seconds (9802.74 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8639.54 -8650.7 -8654.46 ... -9026.77

Time limit reached
Best objective -8.639537873705e+03, best bound -3.949773746250e+03, gap 54.2826%
  WARNING: Time limit reached. Using best solution found (gap: 54.28%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -8639.54, θ = 118767.10
  Upper Bound (UB) = -8639.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118767.10
  [DEBUG]   ✓ Scenario 0: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118767.10 ≤ Q = 118767.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 118767.10 ≤ Q = 118767.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 118767.10 ≤ Q = 118767.10 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x15d95ab9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xea26a547
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.456621e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 7346365.1246
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.304473e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130447.27    0  123 7346365.12 -130447.27   102%     -    0s
H    0     0                    -95420.97818 -130447.27  36.7%     -    0s
H    0     0                    -95684.23074 -130447.27  36.3%     -    0s
     0     0 -100780.72    0   49 -95684.231 -100780.72  5.33%     -    0s
H    0     0                    -99340.08398 -100662.80  1.33%     -    0s
     0     0 -100464.47    0   50 -99340.084 -100464.47  1.13%     -    0s
H    0     0                    -99596.25669 -100422.81  0.83%     -    0s
H    0     0                    -99775.72599 -100422.81  0.65%     -    0s
     0     0 -100381.88    0   52 -99775.726 -100381.88  0.61%     -    0s
     0     0 -100381.88    0   52 -99775.726 -100381.88  0.61%     -    0s
     0     0 -100381.88    0   63 -99775.726 -100381.88  0.61%     -    0s
     0     0 -100381.88    0   53 -99775.726 -100381.88  0.61%     -    0s
     0     0 -100357.95    0   51 -99775.726 -100357.95  0.58%     -    0s
     0     0 -100288.84    0   49 -99775.726 -100288.84  0.51%     -    0s
     0     0 -100276.69    0   49 -99775.726 -100276.69  0.50%     -    0s
     0     0 -100265.29    0   50 -99775.726 -100265.29  0.49%     -    0s
     0     0 -100258.10    0   50 -99775.726 -100258.10  0.48%     -    0s
     0     2 -100258.10    0   50 -99775.726 -100258.10  0.48%     -    0s
H    5     6                    -99782.63897 -100246.44  0.46%   9.4    0s
*  182     5              20    -99798.78323 -99811.866  0.01%   5.0    0s

Cutting planes:
  Gomory: 17
  Implied bound: 3
  MIR: 82
  Flow cover: 8
  RLT: 2
  BQP: 1

Explored 199 nodes (1710 simplex iterations) in 0.12 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -99798.8 -99782.6 -99775.7 ... 1.45662e+13
No other solutions better than -99798.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.979878322775e+04, best bound -9.979878322775e+04, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 118650.74
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99798.78
  [DEBUG]   S×d_nominal = 218449.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 218449.52 + -99798.78 = 118650.74
  [DEBUG]   Current θ from Master = 118767.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 116.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8755.89
  Lower Bound (LB) = -8755.89
  Gap (UB-LB) = 116.3569, Absolute Gap = 116.3569, Relative Gap = 0.013468
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 11
Total Time: 15979.29s
Converged: True
Final Lower Bound: -8755.8948
Final Upper Bound: -8639.5379
Final Gap: 116.356887
Number of Critical Scenarios: 11
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 5, 7] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 2 customers  Mode 1: 8 customers  Mode 2: 40 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 11
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-04 16:57:16
Total Time: 15979.29s
Optimal Value: -8755.89
Lower Bound: -8755.89
Upper Bound: -8639.54
Gap: 116.356887
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [3, 5, 7] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed15_LD_gamma20_20260104_165716.csv

Total Execution Time: 15979.95 seconds
End Time: 2026-01-04 16:57:16

All tasks completed successfully!

