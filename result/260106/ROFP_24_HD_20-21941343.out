
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 24
DI Scenario: HD
Start Time: 2026-01-04 12:31:24
================================================================================
Loading data from data/DH_data_full_seed24.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
  Product 1: ['1.000', '1.499', '2.248'] (k=0.999)
  Product 2: ['1.000', '1.406', '1.976'] (k=0.840)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=993, max=1652
  DC capacity (MC): min=447, max=853

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.89, count=87
  Deviation (μ̂): min=4.03, max=9.95

Costs:
  Plant fixed cost: min=5996, max=9615
  DC fixed cost: min=3150, max=5670
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.499', '2.248'] (k=0.999)
    Product 2: ['1.000', '1.406', '1.976'] (k=0.840)
  MD:
    Product 0: ['1.000', '1.251', '1.565'] (k=0.553)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.267', '1.606'] (k=0.584)
  LD:
    Product 0: ['1.000', '1.019', '1.038'] (k=0.045)
    Product 1: ['1.000', '1.001', '1.001'] (k=0.001)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
  Mixed:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0x7ec7cf60
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.14s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -282786.0125
Found heuristic solution: objective -195802.1610

Root relaxation: objective 1.849661e+05, 5502 iterations, 0.41 seconds (0.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 184966.079    0  439 -195802.16 184966.079   194%     -    0s
H    0     0                    -194269.3471 184966.079   195%     -    0s
H    0     0                    -191876.2252 184966.079   196%     -    0s
     0     0 161646.933    0  698 -191876.23 161646.933   184%     -    2s
H    0     0                    -174543.5612 161616.365   193%     -    2s
     0     0 160811.466    0  708 -174543.56 160811.466   192%     -    2s
     0     0 160793.647    0  718 -174543.56 160793.647   192%     -    2s
     0     0 160793.609    0  718 -174543.56 160793.609   192%     -    2s
     0     0 147607.109    0  692 -174543.56 147607.109   185%     -    3s
     0     0 145846.413    0  717 -174543.56 145846.413   184%     -    4s
     0     0 145730.541    0  733 -174543.56 145730.541   183%     -    4s
     0     0 145707.761    0  739 -174543.56 145707.761   183%     -    4s
     0     0 145707.352    0  740 -174543.56 145707.352   183%     -    4s
H    0     0                    -144163.9673 145707.352   201%     -    5s
H    0     0                    -143156.5856 145707.352   202%     -    5s
H    0     0                    47339.290808 126638.313   168%     -    6s
     0     0 126638.313    0  537 47339.2908 126638.313   168%     -    6s
     0     0 125054.741    0  591 47339.2908 125054.741   164%     -    7s
     0     0 124793.479    0  568 47339.2908 124793.479   164%     -    7s
     0     0 124740.970    0  582 47339.2908 124740.970   164%     -    7s
     0     0 124730.481    0  580 47339.2908 124730.481   163%     -    7s
H    0     0                    51078.957082 124730.481   144%     -    8s
H    0     0                    53426.420356 124730.481   133%     -    8s
H    0     0                    58337.476493 124730.481   114%     -    8s
H    0     0                    60189.680321 124730.481   107%     -    8s
H    0     0                    60226.855490 124730.481   107%     -    8s
H    0     0                    61512.725374 118835.298  93.2%     -    9s
     0     0 118835.298    0  571 61512.7254 118835.298  93.2%     -    9s
     0     0 118037.770    0  637 61512.7254 118037.770  91.9%     -    9s
     0     0 117827.075    0  638 61512.7254 117827.075  91.5%     -   10s
     0     0 117803.146    0  629 61512.7254 117803.146  91.5%     -   10s
H    0     0                    62335.260458 115422.399  85.2%     -   11s
H    0     0                    63132.006366 115422.399  82.8%     -   11s
H    0     0                    63319.948861 115422.399  82.3%     -   11s
H    0     0                    63931.409399 115422.399  80.5%     -   11s
H    0     0                    64044.411104 115422.399  80.2%     -   11s
H    0     0                    64114.049459 115422.399  80.0%     -   11s
H    0     0                    64252.631721 115422.399  79.6%     -   11s
H    0     0                    64431.450144 115422.399  79.1%     -   11s
H    0     0                    64516.385561 115422.399  78.9%     -   11s
H    0     0                    65042.992992 115422.399  77.5%     -   11s
H    0     0                    65198.078311 115422.399  77.0%     -   11s
     0     0 115422.399    0  660 65198.0783 115422.399  77.0%     -   11s
     0     0 114908.890    0  685 65198.0783 114908.890  76.2%     -   11s
     0     0 114736.641    0  692 65198.0783 114736.641  76.0%     -   12s
     0     0 114691.808    0  696 65198.0783 114691.808  75.9%     -   12s
     0     0 114677.505    0  714 65198.0783 114677.505  75.9%     -   12s
     0     0 113301.074    0  623 65198.0783 113301.074  73.8%     -   13s
     0     0 112969.969    0  637 65198.0783 112969.969  73.3%     -   13s
     0     0 112886.380    0  657 65198.0783 112886.380  73.1%     -   14s
     0     0 112863.904    0  669 65198.0783 112863.904  73.1%     -   14s
     0     0 112083.740    0  640 65198.0783 112083.740  71.9%     -   15s
     0     0 111838.105    0  629 65198.0783 111838.105  71.5%     -   15s
     0     0 111760.056    0  660 65198.0783 111760.056  71.4%     -   16s
     0     0 111741.430    0  666 65198.0783 111741.430  71.4%     -   16s
     0     0 111171.432    0  694 65198.0783 111171.432  70.5%     -   17s
     0     0 110993.622    0  730 65198.0783 110993.622  70.2%     -   17s
     0     0 110965.308    0  727 65198.0783 110965.308  70.2%     -   17s
H    0     0                    67422.242201 110631.318  64.1%     -   18s
H    0     0                    70400.250623 110631.318  57.1%     -   18s
     0     0 110631.318    0  666 70400.2506 110631.318  57.1%     -   18s
     0     0 110629.046    0  666 70400.2506 110629.046  57.1%     -   19s
     0     2 110629.046    0  666 70400.2506 110629.046  57.1%     -   20s
    15    32 110051.719    4  572 70400.2506 110312.952  56.7%  1710   25s
H   33    64                    70407.544494 110055.227  56.3%  1738   26s
H   34    64                    70615.158010 110055.227  55.9%  1712   26s
H   39    64                    70788.091900 110055.116  55.5%  1648   26s
   138   225 107025.896    8  518 70788.0919 109956.117  55.3%  1474   30s
H  228   337                    70795.385771 109956.117  55.3%  1223   31s
H  232   337                    71808.855907 109956.117  53.1%  1220   31s
H  480   504                    72625.548383 109956.117  51.4%   823   33s
H  545   573                    72924.254638 109956.117  50.8%   779   34s
H  562   573                    73121.891025 109956.117  50.4%   768   34s
   572   672 104657.661   15  457 73121.8910 109956.117  50.4%   763   35s
H  881   955                    73359.952190 109956.117  49.9%   650   37s
H 1079  1192                    73475.108365 109956.117  49.7%   576   39s
H 1176  1192                    73520.804541 109956.117  49.6%   557   39s
  1191  1305 102944.419   21  362 73520.8045 109956.117  49.6%   552   40s
H 1581  1633                    73741.686591 109956.117  49.1%   498   42s
H 1701  1698                    76956.272295 109943.337  42.9%   494   44s
H 1703  1698                    77256.081665 109943.337  42.3%   494   44s
  1739  1810 98571.0305   31  351 77256.0817 109838.386  42.2%   496   46s
H 1877  1865                    77652.562317 109838.386  41.4%   489   47s
H 1878  1861                    78054.213559 109838.386  40.7%   489   47s
H 1883  1859                    78541.312726 109838.386  39.8%   490   47s
H 2117  2083                    78765.126704 109640.844  39.2%   489   49s
H 2158  2083                    78855.247874 109640.844  39.0%   483   49s
H 2203  2082                    78990.553849 109640.844  38.8%   487   49s
  2230  2255 95450.7487   36  373 78990.5538 109640.844  38.8%   485   50s
H 3000  3106                    79011.959188 109640.844  38.8%   423   53s
H 3016  3099                    79248.214539 109640.844  38.4%   421   53s
H 3083  3096                    79309.246442 109640.844  38.2%   414   53s
H 3278  3064                    80818.130064 109640.844  35.7%   401   54s
  3303  3457 87541.1813   77  224 80818.1301 109640.844  35.7%   402   55s
  4645  4272 83491.0237  128   86 80818.1301 109532.907  35.5%   339   60s
  4870  4353 107495.400    7  666 80818.1301 109404.622  35.4%   360   73s
  4875  4356 99533.4223   24  340 80818.1301 106704.127  32.0%   359   75s
  4913  4383 99069.9808   10   81 80818.1301 103710.441  28.3%   360   80s
  4941  4402 91147.6013   51  404 80818.1301 103240.089  27.7%   358   85s
  5038  4506 81853.9634   31  424 80818.1301 97955.2262  21.2%   365   90s
H 5238  4338                    84017.063517 96063.0499  14.3%   365   91s
H 5442  4121                    84234.580166 95207.9933  13.0%   361   93s
  5835  4099 85359.0352   37  229 84234.5802 94435.1056  12.1%   357   95s
H 6009  3880                    84475.607962 94435.1056  11.8%   353   96s
H 6361  3629                    84477.565107 92202.2374  9.14%   348   98s
  6885  3432 84838.8076   34  249 84477.5651 91154.6882  7.90%   340  100s
  7703  3027 85896.3186   37  238 84477.5651 89696.4327  6.18%   331  105s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 2
  MIR: 113
  Flow cover: 268
  Relax-and-lift: 41

Explored 9603 nodes (2778221 simplex iterations) in 107.75 seconds (144.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 84477.6 84475.6 84234.6 ... 78855.2

Optimal solution found (tolerance 1.00e-04)
Best objective 8.447756510730e+04, best bound 8.447756510730e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 107.76s
  Master Objective (UB) = 84477.57, θ = 252885.28
  Upper Bound (UB) = 84477.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 252885.28
  [DEBUG]   ✓ Scenario 0: θ = 252885.28 ≤ Q = 252885.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1a03ae73
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1a03ae73
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.469908e+13
Presolve removed 2562 rows and 1852 columns
Presolve time: 0.01s
Presolved: 531 rows, 537 columns, 1499 nonzeros
Found heuristic solution: objective 7291661.3742
Variable types: 364 continuous, 173 integer (173 binary)
Found heuristic solution: objective 7291350.6595

Root relaxation: objective -1.899895e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189989.55    0  125 7291350.66 -189989.55   103%     -    0s
H    0     0                    -129438.1525 -189989.55  46.8%     -    0s
H    0     0                    -131089.8795 -189989.55  44.9%     -    0s
H    0     0                    -147415.1474 -189989.55  28.9%     -    0s
     0     0 -157776.37    0    2 -147415.15 -157776.37  7.03%     -    0s
H    0     0                    -157775.6083 -157775.61  0.00%     -    0s
     0     0 -157775.61    0    2 -157775.61 -157775.61  0.00%     -    0s

Cutting planes:
  MIR: 151

Explored 1 nodes (370 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -157776 -147415 -131090 ... 1.46991e+13
No other solutions better than -157776

Optimal solution found (tolerance 1.00e-04)
Best objective -1.577756083229e+05, best bound -1.577756083229e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 221734.67
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157775.61
  [DEBUG]   S×d_nominal = 379510.28
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379510.28 + -157775.61 = 221734.67
  [DEBUG]   Current θ from Master = 252885.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31150.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 53326.95
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 31150.6179, Absolute Gap = 31150.6179, Relative Gap = 0.368744
  Not converged yet (gap = 31150.62 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0xc30fd073
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 53326.9 (0.02s)
MIP start from previous solve produced solution with objective 53326.9 (0.02s)
Loaded MIP start from previous solve with objective 53326.9

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.48s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.052165e+05, 11503 iterations, 2.01 seconds (2.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 105216.453    0  240 53326.9472 105216.453  97.3%     -    2s
H    0     0                    61040.217342 105216.453  72.4%     -    2s
     0     0 96055.4791    0  237 61040.2173 96055.4791  57.4%     -    4s
     0     0 95934.6765    0  237 61040.2173 95934.6765  57.2%     -    4s
     0     0 90932.2130    0  354 61040.2173 90932.2130  49.0%     -    6s
     0     0 90514.7900    0  392 61040.2173 90514.7900  48.3%     -    6s
     0     0 90268.5400    0  394 61040.2173 90268.5400  47.9%     -    7s
     0     0 90160.3414    0  400 61040.2173 90160.3414  47.7%     -    7s
     0     0 90140.7340    0  397 61040.2173 90140.7340  47.7%     -    7s
     0     0 90098.2157    0  398 61040.2173 90098.2157  47.6%     -    7s
     0     0 90097.1373    0  407 61040.2173 90097.1373  47.6%     -    7s
     0     0 86759.4948    0  408 61040.2173 86759.4948  42.1%     -   10s
H    0     0                    61083.507084 86758.3428  42.0%     -   10s
H    0     0                    61085.442827 86758.3428  42.0%     -   10s
     0     0 86280.1418    0  371 61085.4428 86280.1418  41.2%     -   10s
     0     0 86114.3547    0  384 61085.4428 86114.3547  41.0%     -   11s
     0     0 86064.4381    0  391 61085.4428 86064.4381  40.9%     -   11s
     0     0 86051.0344    0  392 61085.4428 86051.0344  40.9%     -   11s
     0     0 86042.3939    0  383 61085.4428 86042.3939  40.9%     -   11s
     0     0 86039.2983    0  386 61085.4428 86039.2983  40.9%     -   11s
     0     0 83526.9910    0  499 61085.4428 83526.9910  36.7%     -   15s
     0     0 83246.2229    0  510 61085.4428 83246.2229  36.3%     -   16s
     0     0 83142.3358    0  552 61085.4428 83142.3358  36.1%     -   16s
     0     0 83115.7489    0  548 61085.4428 83115.7489  36.1%     -   16s
     0     0 83105.0336    0  562 61085.4428 83105.0336  36.0%     -   16s
     0     0 83098.8908    0  563 61085.4428 83098.8908  36.0%     -   17s
     0     0 83098.4644    0  564 61085.4428 83098.4644  36.0%     -   17s
     0     0 82351.7333    0  350 61085.4428 82351.7333  34.8%     -   18s
H    0     0                    61522.464647 82351.1737  33.9%     -   18s
H    0     0                    61557.148218 82351.1737  33.8%     -   18s
     0     0 82149.4203    0  386 61557.1482 82149.4203  33.5%     -   19s
     0     0 82110.0380    0  396 61557.1482 82110.0380  33.4%     -   19s
     0     0 82074.4366    0  403 61557.1482 82074.4366  33.3%     -   19s
     0     0 82068.3839    0  407 61557.1482 82068.3839  33.3%     -   20s
     0     0 82059.2533    0  403 61557.1482 82059.2533  33.3%     -   20s
     0     0 82059.0727    0  404 61557.1482 82059.0727  33.3%     -   20s
     0     0 81757.3732    0  464 61557.1482 81757.3732  32.8%     -   21s
     0     0 81627.6000    0  538 61557.1482 81627.6000  32.6%     -   22s
     0     0 81571.2233    0  506 61557.1482 81571.2233  32.5%     -   23s
     0     0 81549.0684    0  467 61557.1482 81549.0684  32.5%     -   23s
     0     0 81545.4746    0  509 61557.1482 81545.4746  32.5%     -   23s
     0     0 81379.3134    0  395 61557.1482 81379.3134  32.2%     -   24s
     0     0 81269.8226    0  433 61557.1482 81269.8226  32.0%     -   25s
     0     0 81243.2903    0  431 61557.1482 81243.2903  32.0%     -   25s
     0     0 81238.8629    0  424 61557.1482 81238.8629  32.0%     -   26s
     0     0 81167.8214    0  430 61557.1482 81167.8214  31.9%     -   26s
     0     0 81089.1974    0  439 61557.1482 81089.1974  31.7%     -   27s
     0     0 81079.8505    0  442 61557.1482 81079.8505  31.7%     -   27s
     0     0 81077.2248    0  444 61557.1482 81077.2248  31.7%     -   27s
     0     0 81020.2605    0  351 61557.1482 81020.2605  31.6%     -   28s
     0     0 81013.3234    0  357 61557.1482 81013.3234  31.6%     -   29s
     0     0 80951.1473    0  411 61557.1482 80951.1473  31.5%     -   29s
     0     0 80942.5849    0  415 61557.1482 80942.5849  31.5%     -   30s
     0     0 80939.4812    0  364 61557.1482 80939.4812  31.5%     -   30s
     0     0 80875.2565    0  494 61557.1482 80875.2565  31.4%     -   30s
     0     0 80845.1905    0  480 61557.1482 80845.1905  31.3%     -   31s
     0     0 80834.7824    0  487 61557.1482 80834.7824  31.3%     -   31s
     0     0 80833.6801    0  488 61557.1482 80833.6801  31.3%     -   31s
     0     0 80796.8809    0  506 61557.1482 80796.8809  31.3%     -   32s
     0     0 80785.9455    0  508 61557.1482 80785.9455  31.2%     -   33s
     0     0 80783.3056    0  511 61557.1482 80783.3056  31.2%     -   33s
     0     0 80778.6340    0  457 61557.1482 80778.6340  31.2%     -   34s
     0     0 80773.7156    0  456 61557.1482 80773.7156  31.2%     -   35s
     0     0 80772.0792    0  442 61557.1482 80772.0792  31.2%     -   36s
     0     0 80769.5492    0  446 61557.1482 80769.5492  31.2%     -   36s
     0     0 80769.4651    0  443 61557.1482 80769.4651  31.2%     -   37s
     0     0 80768.0608    0  443 61557.1482 80768.0608  31.2%     -   37s
H    0     0                    62247.572931 80768.0608  29.8%     -   42s
     0     2 80768.0608    0  443 62247.5729 80768.0608  29.8%     -   42s
     3     8 80586.5802    2  352 62247.5729 80715.5583  29.7%   628   45s
    31    64 79225.7935    5  363 62247.5729 80127.7167  28.7%  1675   51s
    95   184 78776.8020    7  359 62247.5729 80096.5079  28.7%  1189   55s
H  117   184                    62478.281572 80096.5079  28.2%  1072   55s
   283   328 78251.5999   11  324 62478.2816 80096.5079  28.2%   833   60s
   458   534 77966.9799   13  318 62478.2816 80096.5079  28.2%   733   65s
   796   860 75809.0389   17  319 62478.2816 80096.5079  28.2%   593   70s
H 1076  1057                    62820.442177 79761.5218  27.0%   531   74s
  1100  1101 74278.8019   22  289 62820.4422 79761.5218  27.0%   528   75s
H 1254  1206                    63047.946917 79350.3017  25.9%   544   79s
H 1273  1206                    63201.484561 79350.3017  25.6%   549   79s
H 1295  1206                    63327.763298 79350.3017  25.3%   544   79s
  1316  1256 71429.8753   25  257 63327.7633 79347.9173  25.3%   545   82s
  1435  1312 64647.1749   27  225 63327.7633 79347.9173  25.3%   562   85s
  1581  1415 65092.1408   33  166 63327.7633 78904.7271  24.6%   573   92s
H 1632  1415                    63502.242453 78771.9656  24.0%   574   92s
  1773  1597 76383.2396    9  420 63502.2425 78771.9656  24.0%   564   97s
  2044  1799 73655.4912   13  367 63502.2425 78724.5488  24.0%   544  101s
  2204  1842 72672.0035   14  279 63502.2425 78310.7080  23.3%   533  105s
H 2441  1948                    63687.728127 78240.9261  22.9%   537  109s
H 2458  1938                    64033.004421 78240.9261  22.2%   540  109s
H 2461  1885                    64780.806311 78240.9261  20.8%   540  109s
  2502  1927 65761.2255   21  297 64780.8063 78240.9261  20.8%   538  112s
  2732  2042 74502.6164    8  363 64780.8063 78016.6449  20.4%   548  117s
H 2842  2026                    65163.727789 78002.3300  19.7%   554  119s
H 2864  2025                    65185.329144 78002.3300  19.7%   556  119s
H 2876  1985                    65483.785894 78002.3300  19.1%   558  119s
  2882  2027 73975.7565   11  316 65483.7859 77962.4325  19.1%   558  122s
  3026  2102 73245.2167   15  286 65483.7859 77962.4325  19.1%   560  126s
  3294  2255 71780.4420   22  265 65483.7859 77822.1338  18.8%   562  132s
  3473  2361 67645.4461   27  219 65483.7859 77770.5616  18.8%   559  135s
  3794  2504 74519.5712   17  347 65483.7859 77662.9075  18.6%   551  142s
  4005  2606 71802.9800   26  219 65483.7859 77582.4129  18.5%   547  145s
  4243  2689 68261.1781   52  129 65483.7859 77530.8340  18.4%   539  153s
  4464  2786 65790.5986   73   56 65483.7859 77525.1943  18.4%   542  157s
  4656  2787 76582.2809    7  443 65483.7859 77525.1943  18.4%   545  166s
  4659  2789 76350.6139   11  308 65483.7859 77525.1943  18.4%   545  170s
  4665  2793 68877.1709   15  353 65483.7859 77525.1943  18.4%   544  175s
H 4666  2654                    65583.140524 77525.1943  18.2%   544  176s
H 4669  2523                    65599.196781 77525.1943  18.2%   544  178s
H 4669  2396                    65616.966035 77525.1943  18.1%   544  178s
  4672  2398 66023.8908   33  403 65616.9660 77525.1943  18.1%   543  180s
H 4677  2281                    65657.945472 77525.1943  18.1%   543  184s
  4679  2282 70744.6791   13  390 65657.9455 77525.1943  18.1%   542  185s
  4684  2286 73559.1000   13  370 65657.9455 77525.1943  18.1%   542  191s
  4686  2290 77525.1943   10  407 65657.9455 77525.1943  18.1%   548  196s
  4700  2313 70987.3041   13  388 65657.9455 77525.1943  18.1%   549  200s
  4716  2338 70826.1859   14  386 65657.9455 77525.1943  18.1%   552  206s
  4780  2361 69321.7381   16  404 65657.9455 76199.6355  16.1%   558  211s
  4894  2357     cutoff   18      65657.9455 75416.7646  14.9%   565  215s
  5074  2344 72284.1544   16  271 65657.9455 75348.1682  14.8%   566  220s
  5309  2295 70232.2986   17  250 65657.9455 73307.8537  11.7%   562  226s
  5526  2278 66861.2884   17  258 65657.9455 72453.1166  10.3%   560  232s
  5699  2213     cutoff   20      65657.9455 71953.9851  9.59%   555  235s
  6114  2077 66140.4271   22  211 65657.9455 71156.1028  8.37%   541  241s
  6477  1874 67082.6454   25  187 65657.9455 69780.2344  6.28%   530  245s
* 7303  1426              54    65749.535853 67820.1821  3.15%   489  248s
  7734  1192 65977.6049   31  119 65749.5359 67461.2426  2.60%   465  250s

Cutting planes:
  MIR: 191
  Flow cover: 383
  RLT: 3
  Relax-and-lift: 43

Explored 8241 nodes (3660791 simplex iterations) in 251.41 seconds (412.21 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 65749.5 65657.9 65617 ... 63502.2

Optimal solution found (tolerance 1.00e-04)
Best objective 6.574953585309e+04, best bound 6.574953585309e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 251.42s
  Master Objective (UB) = 65749.54, θ = 232379.99
  Upper Bound (UB) = 65749.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 232379.99
  [DEBUG]   ✓ Scenario 0: θ = 232379.99 ≤ Q = 232379.99 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 232379.99 ≤ Q = 232379.99 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2383b219
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2383b219
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.390222e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.01s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 6933855.7524
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.922296e+05, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -192229.55    0  137 6933855.75 -192229.55   103%     -    0s
H    0     0                    -152192.2941 -192229.55  26.3%     -    0s
H    0     0                    -152357.6823 -192229.55  26.2%     -    0s
H    0     0                    -175757.8444 -192229.55  9.37%     -    0s
     0     0 -182091.60    0  117 -175757.84 -182091.60  3.60%     -    0s
H    0     0                    -179543.8064 -181995.93  1.37%     -    0s
     0     0 -180912.77    0   98 -179543.81 -180912.77  0.76%     -    0s
     0     0 -180894.95    0   79 -179543.81 -180894.95  0.75%     -    0s
     0     0 -180357.81    0   64 -179543.81 -180357.81  0.45%     -    0s
     0     0 -180151.06    0   59 -179543.81 -180151.06  0.34%     -    0s
     0     0 -180151.06    0   65 -179543.81 -180151.06  0.34%     -    0s
     0     0 -179891.30    0   58 -179543.81 -179891.30  0.19%     -    0s
     0     0 -179890.52    0   38 -179543.81 -179890.52  0.19%     -    0s
     0     0 -179890.47    0   37 -179543.81 -179890.47  0.19%     -    0s
     0     0 -179804.65    0   30 -179543.81 -179804.65  0.15%     -    0s
     0     0 -179695.20    0   17 -179543.81 -179695.20  0.08%     -    0s
     0     0 -179695.20    0   25 -179543.81 -179695.20  0.08%     -    0s
     0     0 -179603.41    0   16 -179543.81 -179603.41  0.03%     -    0s
     0     0 -179600.67    0   13 -179543.81 -179600.67  0.03%     -    0s
H    0     0                    -179546.6860 -179598.50  0.03%     -    0s
H    0     0                    -179561.0039 -179598.50  0.02%     -    0s
     0     0 -179579.05    0    4 -179561.00 -179579.05  0.01%     -    0s

Cutting planes:
  Gomory: 13
  Implied bound: 4
  MIR: 6
  Flow cover: 9
  Relax-and-lift: 5

Explored 1 nodes (1074 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -179561 -179547 -179544 ... 1.39022e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.795610038569e+05, best bound -1.795768383126e+05, gap 0.0088%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 209519.57
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -179561.00
  [DEBUG]   S×d_nominal = 389080.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 389080.58 + -179561.00 = 209519.57
  [DEBUG]   Current θ from Master = 232379.99
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22860.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 42889.12
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 12422.5886, Absolute Gap = 12422.5886, Relative Gap = 0.188938
  Not converged yet (gap = 12422.59 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0x48a92c2a
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 42889.1 (0.03s)
Loaded MIP start from previous solve with objective 42889.1

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.71s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 9.199622e+04, 14143 iterations, 4.04 seconds (5.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91996.2153    0   78 42889.1193 91996.2153   114%     -    4s
H    0     0                    46802.148696 91996.2153  96.6%     -    5s
H    0     0                    47432.600686 91996.2153  94.0%     -    5s
H    0     0                    52404.821208 91996.2153  75.5%     -    5s
H    0     0                    52411.258839 91996.2153  75.5%     -    5s
H    0     0                    53299.286765 91996.2153  72.6%     -    5s
H    0     0                    53606.691657 86431.1750  61.2%     -    9s
H    0     0                    54029.234452 86431.1750  60.0%     -    9s
H    0     0                    54050.577455 86431.1750  59.9%     -    9s
H    0     0                    54850.095210 86431.1750  57.6%     -    9s
H    0     0                    54926.857810 86431.1750  57.4%     -    9s
H    0     0                    54953.741353 86431.1750  57.3%     -    9s
H    0     0                    55086.748173 86431.1750  56.9%     -    9s
     0     0 85962.7099    0  169 55086.7482 85962.7099  56.0%     -    9s
     0     0 85962.7099    0  181 55086.7482 85962.7099  56.0%     -   10s
     0     0 85962.7099    0  179 55086.7482 85962.7099  56.0%     -   10s
H    0     0                    55188.910405 83677.2337  51.6%     -   12s
H    0     0                    55337.282377 83677.2337  51.2%     -   12s
     0     0 83665.6442    0  231 55337.2824 83665.6442  51.2%     -   12s
H    0     0                    55563.243744 83665.6442  50.6%     -   12s
H    0     0                    56641.272344 83665.6442  47.7%     -   12s
     0     0 82894.9470    0  288 56641.2723 82894.9470  46.4%     -   14s
     0     0 82736.1487    0  279 56641.2723 82736.1487  46.1%     -   15s
     0     0 82719.5608    0  287 56641.2723 82719.5608  46.0%     -   15s
     0     0 82719.0929    0  290 56641.2723 82719.0929  46.0%     -   15s
     0     0 80916.8100    0  325 56641.2723 80916.8100  42.9%     -   20s
H    0     0                    56845.951457 80916.6750  42.3%     -   20s
H    0     0                    57353.757725 80485.0700  40.3%     -   22s
     0     0 80485.0700    0  342 57353.7577 80485.0700  40.3%     -   22s
H    0     0                    58010.893612 80287.9016  38.4%     -   23s
H    0     0                    58283.373583 80287.9016  37.8%     -   23s
     0     0 80287.9016    0  316 58283.3736 80287.9016  37.8%     -   23s
     0     0 80192.6044    0  399 58283.3736 80192.6044  37.6%     -   25s
     0     0 80161.3589    0  364 58283.3736 80161.3589  37.5%     -   25s
     0     0 80120.7091    0  398 58283.3736 80120.7091  37.5%     -   26s
     0     0 80114.4502    0  363 58283.3736 80114.4502  37.5%     -   26s
     0     0 80111.2790    0  406 58283.3736 80111.2790  37.5%     -   26s
     0     0 80109.6775    0  408 58283.3736 80109.6775  37.4%     -   26s
     0     0 80109.2757    0  406 58283.3736 80109.2757  37.4%     -   26s
     0     0 79445.4806    0  388 58283.3736 79445.4806  36.3%     -   31s
H    0     0                    58348.785068 79445.4725  36.2%     -   31s
     0     0 79274.6385    0  399 58348.7851 79274.6385  35.9%     -   33s
     0     0 79228.8887    0  354 58348.7851 79228.8887  35.8%     -   33s
     0     0 79198.2704    0  363 58348.7851 79198.2704  35.7%     -   33s
     0     0 79187.8588    0  348 58348.7851 79187.8588  35.7%     -   34s
     0     0 79186.5470    0  408 58348.7851 79186.5470  35.7%     -   34s
     0     0 79175.5780    0  414 58348.7851 79175.5780  35.7%     -   35s
     0     0 79130.1996    0  426 58348.7851 79130.1996  35.6%     -   36s
     0     0 79127.5823    0  419 58348.7851 79127.5823  35.6%     -   36s
     0     0 79126.6032    0  424 58348.7851 79126.6032  35.6%     -   36s
     0     0 79092.8899    0  375 58348.7851 79092.8899  35.6%     -   37s
H    0     0                    58867.836842 79092.7400  34.4%     -   37s
     0     0 79085.1940    0  449 58867.8368 79085.1940  34.3%     -   37s
     0     0 79083.8819    0  452 58867.8368 79083.8819  34.3%     -   38s
     0     0 79057.5781    0  461 58867.8368 79057.5781  34.3%     -   39s
     0     0 79048.1177    0  472 58867.8368 79048.1177  34.3%     -   39s
     0     0 79036.5773    0  470 58867.8368 79036.5773  34.3%     -   40s
     0     0 79034.3146    0  474 58867.8368 79034.3146  34.3%     -   40s
     0     0 79034.2157    0  474 58867.8368 79034.2157  34.3%     -   40s
     0     0 79028.5900    0  372 58867.8368 79028.5900  34.2%     -   41s
H    0     0                    59451.235141 79027.1109  32.9%     -   41s
H    0     0                    59593.362621 79027.1109  32.6%     -   41s
H    0     0                    59599.211171 79027.1109  32.6%     -   41s
H    0     0                    59735.246447 79027.1109  32.3%     -   41s
H    0     0                    59740.728966 79027.1109  32.3%     -   41s
H    0     0                    59779.241067 79027.1109  32.2%     -   41s
     0     0 79022.1549    0  369 59779.2411 79022.1549  32.2%     -   41s
     0     0 79021.7521    0  368 59779.2411 79021.7521  32.2%     -   41s
     0     0 79012.7599    0  371 59779.2411 79012.7599  32.2%     -   42s
     0     0 79010.4557    0  350 59779.2411 79010.4557  32.2%     -   42s
     0     0 79010.1553    0  351 59779.2411 79010.1553  32.2%     -   42s
     0     0 79008.6313    0  349 59779.2411 79008.6313  32.2%     -   43s
H    0     0                    59791.010616 79008.2792  32.1%     -   43s
     0     0 79008.2210    0  352 59791.0106 79008.2210  32.1%     -   43s
     0     0 79008.1288    0  349 59791.0106 79008.1288  32.1%     -   43s
     0     0 79007.1364    0  349 59791.0106 79007.1364  32.1%     -   44s
H    0     0                    59812.359337 79007.1364  32.1%     -   49s
H    0     0                    59863.180533 79007.1364  32.0%     -   49s
     0     2 79007.1364    0  349 59863.1805 79007.1364  32.0%     -   50s
     3     8 78603.0361    2  399 59863.1805 78918.1146  31.8%  2677   55s
    15    32 78382.1901    4  350 59863.1805 78461.4704  31.1%  2932   62s
    31    64 78233.1541    5  360 59863.1805 78381.1131  30.9%  3449   65s
H   33    64                    59932.141218 78381.1131  30.8%  3313   65s
H   37    64                    59987.688806 78381.1131  30.7%  3155   65s
H   95   190                    60064.787842 78227.2948  30.2%  2965   73s
H  101   190                    60105.767279 78227.2948  30.1%  2899   73s
H  123   190                    60198.671415 78227.2948  29.9%  2688   73s
   189   278 77020.2981    9  379 60198.6714 78227.2948  29.9%  2094   76s
H  279   345                    60229.385544 78227.2948  29.9%  1779   79s
H  292   345                    60292.048332 78227.2948  29.7%  1773   79s
   294   345 74961.8221    9  289 60292.0483 78227.2948  29.7%  1771   80s
H  327   345                    60339.211263 78227.2948  29.6%  1718   80s
   402   455 76387.2855   10  330 60339.2113 78227.2948  29.6%  1700   86s
   510   558 76057.2579   12  403 60339.2113 78227.2948  29.6%  1655   92s
H  516   558                    60372.364354 78227.2948  29.6%  1661   92s
   561   626 75856.0402   13  402 60372.3644 78227.2948  29.6%  1657   95s
   700   731 75468.8579   15  428 60372.3644 77877.4082  29.0%  1585  103s
H  735   731                    60462.998184 77877.4082  28.8%  1610  103s
   768   779 74366.0674   16  383 60462.9982 77877.4082  28.8%  1589  107s
   826   838 74256.0695   16  396 60462.9982 77877.4082  28.8%  1577  110s
   944   936 73864.1460   18  393 60462.9982 77495.4143  28.2%  1517  117s
  1019   967 73796.6743   19  367 60462.9982 77495.4143  28.2%  1491  120s
  1148  1114 72744.0451   21  365 60462.9982 77495.4143  28.2%  1415  127s
  1215  1208 73159.8936   22  381 60462.9982 77495.4143  28.2%  1384  130s
  1422  1416 72830.1570   24  309 60462.9982 77495.4143  28.2%  1287  137s
  1545  1585 73121.0658   24  359 60462.9982 77495.4143  28.2%  1246  140s
  1920  1899 71945.6295   32  282 60462.9982 77495.4143  28.2%  1101  148s
  2092  2005 71845.6758   34  312 60462.9982 77495.4143  28.2%  1069  151s
  2241  2138 71312.6521   39  244 60462.9982 76838.6136  27.1%  1053  156s
  2402  2324 66533.7021   40  222 60462.9982 76838.6136  27.1%  1037  160s
  2846  2755 69836.8175   43  246 60462.9982 76838.6136  27.1%   961  169s
  3111  2958 68853.3311   45  244 60462.9982 76838.6136  27.1%   921  173s
  3381  2959 74687.0113   11  349 60462.9982 76579.8509  26.7%   889  186s
  3383  2960 72376.4311   18   78 60462.9982 76579.8509  26.7%   889  193s
  3384  2961 71314.4543   26  293 60462.9982 76579.8509  26.7%   888  199s
  3385  2962 62550.3358   58  347 60462.9982 76579.8509  26.7%   888  201s
  3387  2963 72565.4517   20  406 60462.9982 76579.8509  26.7%   888  205s
  3392  2966 63244.3148   31  446 60462.9982 76579.8509  26.7%   886  210s
  3397  2970 70920.5532   21  380 60462.9982 76579.8509  26.7%   885  215s
  3402  2973 68865.2048   16  370 60462.9982 76579.8509  26.7%   884  220s
  3405  2975 68796.2525   20  435 60462.9982 76579.8509  26.7%   883  225s
  3406  2976 72492.8026   20  435 60462.9982 76579.8509  26.7%   883  234s
  3407  2976 69109.2866   27  435 60462.9982 76579.8509  26.7%   882  242s
  3408  2980 76579.8509   14  398 60462.9982 76579.8509  26.7%   898  246s
  3410  2983 76579.8509   15  395 60462.9982 76579.8509  26.7%   899  251s
  3414  2990 76579.8509   16  397 60462.9982 76579.8509  26.7%   900  255s
  3422  3003 76579.8509   17  400 60462.9982 76579.8509  26.7%   908  261s
  3438  3029 74542.1013   18  314 60462.9982 76579.8509  26.7%   922  273s
  3469  3051 70227.0491   19  381 60462.9982 76579.8509  26.7%   995  279s
  3501  3149 70026.2483   20  376 60462.9982 76579.8509  26.7%  1010  285s
  3610  3189 69631.7426   22  372 60462.9982 76579.8509  26.7%  1029  290s
  3687  3228 68828.0183   23  368 60462.9982 76579.8509  26.7%  1048  297s
  3755  3262 66875.8498   23  293 60462.9982 76579.8509  26.7%  1067  302s
  3824  3287 67235.1883   22  296 60462.9982 76579.8509  26.7%  1079  307s
  3898  3284 67697.7863   22  334 60462.9982 76579.8509  26.7%  1091  313s
  3981  3282 64322.9103   24  324 60462.9982 76579.8509  26.7%  1098  318s
  4043  3291 67445.1085   24  372 60462.9982 76579.8509  26.7%  1117  323s
  4093  3311 63642.7513   23  334 60462.9982 76579.8509  26.7%  1135  327s
  4149  3329     cutoff   23      60462.9982 76009.3833  25.7%  1145  332s
  4207  3333 65508.4334   24  294 60462.9982 76009.3833  25.7%  1157  338s
  4276  3333 65364.6543   25  260 60462.9982 75264.1100  24.5%  1170  347s
  4337  3329     cutoff   27      60462.9982 75053.8245  24.1%  1189  353s
  4421  3313 63297.3556   26  238 60462.9982 75048.5976  24.1%  1201  358s
  4467  3314     cutoff   27      60462.9982 75048.5976  24.1%  1229  364s
  4533  3316 68098.2311   20  270 60462.9982 75048.5976  24.1%  1238  374s
  4613  3328 66118.3678   22  270 60462.9982 75048.5976  24.1%  1250  380s
  4693  3329 65876.9000   23  246 60462.9982 75048.5976  24.1%  1262  386s
  4785  3326 60647.4186   24  203 60462.9982 75048.5976  24.1%  1273  393s
  4895  3326 64675.9257   25  237 60462.9982 74579.1014  23.3%  1282  399s
  5016  3327 63977.0112   28  235 60462.9982 74579.1014  23.3%  1286  404s
  5133  3308     cutoff   30      60462.9982 74094.9078  22.5%  1292  411s
  5179  3316     cutoff   32      60462.9982 73791.0043  22.0%  1298  416s
H 5219  3152                    61286.198662 73791.0043  20.4%  1302  416s
  5241  3161 66810.4487   23  274 61286.1987 73791.0043  20.4%  1304  423s
  5386  3129 65295.8325   26  244 61286.1987 73600.4465  20.1%  1306  433s
H 5525  2957                    61722.603340 73510.5126  19.1%  1316  439s
H 5528  2822                    61824.743497 73510.5126  18.9%  1316  439s
  5613  2826     cutoff   31      61824.7435 72561.0598  17.4%  1320  447s
  5748  2802 67627.0944   20  279 61824.7435 72402.7928  17.1%  1331  453s
  5903  2784 63583.2753   23  273 61824.7435 72014.8701  16.5%  1337  463s
  6050  2764 64636.2531   23  271 61824.7435 72014.8701  16.5%  1345  470s
  6220  2734     cutoff   25      61824.7435 71839.5584  16.2%  1344  479s
  6387  2689 65085.7800   28  281 61824.7435 71839.5584  16.2%  1353  487s
  6564  2636 67157.8231   22  296 61824.7435 71839.5584  16.2%  1362  494s
  6726  2593 65496.8076   24  368 61824.7435 71056.0097  14.9%  1367  501s
  6780  2616 63399.4515   25  347 61824.7435 71056.0097  14.9%  1371  511s
  6939  2581 62700.3434   26  297 61824.7435 70403.2608  13.9%  1372  522s
  7157  2530 63480.1324   27  174 61824.7435 70101.1810  13.4%  1374  530s
  7405  2453 64026.2493   22  286 61824.7435 70101.1810  13.4%  1376  540s
  7655  2388 66788.4522   23  255 61824.7435 70101.1810  13.4%  1380  550s
  7948  2301 62757.4293   22  288 61824.7435 69156.0525  11.9%  1382  558s
  7999  2286     cutoff   23      61824.7435 68914.2367  11.5%  1386  568s
  8072  2266     cutoff   29      61824.7435 68853.7732  11.4%  1387  582s
  8189  2225 66702.4260   25  289 61824.7435 68853.7732  11.4%  1388  593s
  8332  2199 65392.2822   26  257 61824.7435 68827.2551  11.3%  1392  602s
  8626  2094     cutoff   29      61824.7435 68407.1041  10.6%  1393  613s
  9000  1963 64271.7542   26  364 61824.7435 68000.1187  10.0%  1391  626s
  9376  1864 62340.0147   23  248 61824.7435 67930.1099  9.88%  1392  636s
  9653  1742     cutoff   27      61824.7435 67930.1099  9.88%  1391  651s
 10098  1576 62549.1899   23  308 61824.7435 67312.6939  8.88%  1386  667s
 10581  1318 62324.5803   23  275 61824.7435 66696.1670  7.88%  1379  679s
 11079  1086 63643.5273   24  270 61824.7435 66169.9428  7.03%  1373  692s
 11603   900 62862.7490   30  183 61824.7435 65801.2915  6.43%  1366  706s
 12217   511 infeasible   24      61824.7435 65341.3448  5.69%  1351  722s
 13012    32     cutoff   33      61824.7435 64609.3834  4.50%  1321  733s

Cutting planes:
  Learned: 2
  MIR: 375
  Flow cover: 660
  RLT: 20
  Relax-and-lift: 53

Explored 13772 nodes (17631466 simplex iterations) in 733.94 seconds (1448.66 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 61824.7 61722.6 61286.2 ... 60105.8

Optimal solution found (tolerance 1.00e-04)
Best objective 6.182474349671e+04, best bound 6.182474349671e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 733.95s
  Master Objective (UB) = 61824.74, θ = 229464.35
  Upper Bound (UB) = 61824.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229464.35
  [DEBUG]   ✓ Scenario 0: θ = 229464.35 ≤ Q = 229464.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229464.35 ≤ Q = 229464.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229464.35 ≤ Q = 229464.35 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x64c4737f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9b3b8c81
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.464722e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.01s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7247954.9432
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.968614e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196861.44    0  125 7247954.94 -196861.44   103%     -    0s
H    0     0                    -161094.8568 -196861.44  22.2%     -    0s
H    0     0                    -161284.1578 -196861.44  22.1%     -    0s
     0     0 -177149.64    0   97 -161284.16 -177149.64  9.84%     -    0s
H    0     0                    -166704.3074 -177028.46  6.19%     -    0s
H    0     0                    -172168.5010 -177028.46  2.82%     -    0s
H    0     0                    -173277.4688 -177028.46  2.16%     -    0s
H    0     0                    -174862.7086 -177028.46  1.24%     -    0s
     0     0 -175948.75    0   86 -174862.71 -175948.75  0.62%     -    0s
     0     0 -175927.06    0   86 -174862.71 -175927.06  0.61%     -    0s
     0     0 -175801.72    0   79 -174862.71 -175801.72  0.54%     -    0s
     0     0 -175800.24    0   79 -174862.71 -175800.24  0.54%     -    0s
     0     2 -175799.92    0   79 -174862.71 -175799.92  0.54%     -    0s
H  131   139                    -174890.2052 -175545.80  0.37%  15.6    0s

Cutting planes:
  Gomory: 42
  MIR: 166
  Flow cover: 12
  RLT: 8
  Relax-and-lift: 1

Explored 3038 nodes (20442 simplex iterations) in 0.58 seconds (0.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -174890 -174863 -173277 ... 1.46472e+13
No other solutions better than -174890

Optimal solution found (tolerance 1.00e-04)
Best objective -1.748902051684e+05, best bound -1.748902051684e+05, gap 0.0000%
  Subproblem solved in 0.61s
  Worst-case operational profit (Z_SP) = 218564.43
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -174890.21
  [DEBUG]   S×d_nominal = 393454.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 393454.64 + -174890.21 = 218564.43
  [DEBUG]   Current θ from Master = 229464.35
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10899.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 50924.82
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 8497.7963, Absolute Gap = 8497.7963, Relative Gap = 0.137450
  Not converged yet (gap = 8497.80 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0xdae96af7
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 50924.8 (0.11s)
Loaded MIP start from previous solve with objective 50924.8

Presolve removed 25452 rows and 10332 columns
Presolve time: 1.00s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   51225    2.0150472e+04   0.000000e+00   1.477314e+07      5s
   64502    7.6644619e+04   0.000000e+00   1.558022e+10     10s
Concurrent spin time: 0.83s

Solved with dual simplex

Root relaxation: objective 9.198945e+04, 25341 iterations, 10.34 seconds (13.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91989.4528    0   78 50924.8237 91989.4528  80.6%     -   11s
H    0     0                    51420.169103 91989.4528  78.9%     -   12s
H    0     0                    55640.353573 91989.4528  65.3%     -   12s
H    0     0                    55881.379820 91989.4528  64.6%     -   12s
H    0     0                    57687.284072 91989.4528  59.5%     -   12s
H    0     0                    57791.522206 91989.4528  59.2%     -   12s
H    0     0                    57850.017424 91989.4528  59.0%     -   12s
H    0     0                    58147.786433 87009.5208  49.6%     -   17s
     0     0 86748.4122    0  166 58147.7864 86748.4122  49.2%     -   17s
H    0     0                    58940.304673 86748.4122  47.2%     -   18s
     0     0 86424.4622    0  193 58940.3047 86424.4622  46.6%     -   20s
     0     0 86424.4622    0  192 58940.3047 86424.4622  46.6%     -   20s
     0     0 86424.4622    0  192 58940.3047 86424.4622  46.6%     -   20s
     0     0 86424.4622    0  192 58940.3047 86424.4622  46.6%     -   20s
     0     0 83833.3732    0  268 58940.3047 83833.3732  42.2%     -   25s
     0     0 82948.9303    0  285 58940.3047 82948.9303  40.7%     -   29s
     0     0 82756.5742    0  305 58940.3047 82756.5742  40.4%     -   30s
     0     0 82648.5566    0  303 58940.3047 82648.5566  40.2%     -   31s
     0     0 82588.4893    0  304 58940.3047 82588.4893  40.1%     -   32s
     0     0 82518.5869    0  283 58940.3047 82518.5869  40.0%     -   33s
     0     0 82514.0878    0  281 58940.3047 82514.0878  40.0%     -   33s
     0     0 82513.3182    0  283 58940.3047 82513.3182  40.0%     -   33s
     0     0 81441.7584    0  315 58940.3047 81441.7584  38.2%     -   39s
H    0     0                    58943.830659 81440.4036  38.2%     -   39s
     0     0 80886.9177    0  297 58943.8307 80886.9177  37.2%     -   42s
     0     0 80655.8253    0  366 58943.8307 80655.8253  36.8%     -   45s
     0     0 80590.5789    0  323 58943.8307 80590.5789  36.7%     -   47s
     0     0 80541.0138    0  374 58943.8307 80541.0138  36.6%     -   48s
     0     0 80518.7718    0  367 58943.8307 80518.7718  36.6%     -   49s
     0     0 80507.5204    0  312 58943.8307 80507.5204  36.6%     -   49s
     0     0 80493.6774    0  368 58943.8307 80493.6774  36.6%     -   51s
     0     0 80492.1445    0  317 58943.8307 80492.1445  36.6%     -   51s
     0     0 80490.3761    0  307 58943.8307 80490.3761  36.6%     -   51s
     0     0 80490.2552    0  311 58943.8307 80490.2552  36.6%     -   51s
H    0     0                    59590.718019 80490.2552  35.1%     -   56s
H    0     0                    61622.984939 80490.2552  30.6%     -   56s
     0     0 79755.3159    0  378 61622.9849 79755.3159  29.4%     -   59s
     0     0 79562.2011    0  402 61622.9849 79562.2011  29.1%     -   61s
     0     0 79471.9369    0  408 61622.9849 79471.9369  29.0%     -   63s
     0     0 79336.8040    0  394 61622.9849 79336.8040  28.7%     -   65s
     0     0 79303.6624    0  389 61622.9849 79303.6624  28.7%     -   65s
     0     0 79300.9405    0  392 61622.9849 79300.9405  28.7%     -   65s
     0     0 79298.3260    0  405 61622.9849 79298.3260  28.7%     -   66s
     0     0 79297.9032    0  393 61622.9849 79297.9032  28.7%     -   66s
     0     0 79146.1662    0  361 61622.9849 79146.1662  28.4%     -   69s
     0     0 79106.3681    0  402 61622.9849 79106.3681  28.4%     -   70s
     0     0 79088.2335    0  400 61622.9849 79088.2335  28.3%     -   71s
     0     0 79079.6160    0  411 61622.9849 79079.6160  28.3%     -   71s
     0     0 79077.8860    0  415 61622.9849 79077.8860  28.3%     -   72s
     0     0 79074.1809    0  409 61622.9849 79074.1809  28.3%     -   72s
     0     0 79073.3386    0  414 61622.9849 79073.3386  28.3%     -   72s
     0     0 79032.1143    0  395 61622.9849 79032.1143  28.3%     -   74s
     0     0 79018.2688    0  426 61622.9849 79018.2688  28.2%     -   77s
     0     0 79010.0136    0  428 61622.9849 79010.0136  28.2%     -   78s
     0     0 79009.3954    0  429 61622.9849 79009.3954  28.2%     -   78s
     0     0 79001.2043    0  435 61622.9849 79001.2043  28.2%     -   79s
     0     0 78994.9299    0  441 61622.9849 78994.9299  28.2%     -   82s
     0     0 78994.4886    0  444 61622.9849 78994.4886  28.2%     -   82s
     0     0 78972.3993    0  425 61622.9849 78972.3993  28.2%     -   83s
     0     0 78958.9737    0  333 61622.9849 78958.9737  28.1%     -   86s
     0     0 78956.6042    0  422 61622.9849 78956.6042  28.1%     -   87s
     0     0 78954.6674    0  423 61622.9849 78954.6674  28.1%     -   87s
     0     0 78954.4100    0  425 61622.9849 78954.4100  28.1%     -   87s
     0     0 78952.7234    0  446 61622.9849 78952.7234  28.1%     -   88s
     0     0 78950.2883    0  399 61622.9849 78950.2883  28.1%     -   89s
     0     0 78949.4435    0  400 61622.9849 78949.4435  28.1%     -   89s
     0     0 78942.7695    0  352 61622.9849 78942.7695  28.1%     -   90s
     0     0 78940.1060    0  354 61622.9849 78940.1060  28.1%     -   90s
     0     0 78940.1060    0  337 61622.9849 78940.1060  28.1%     -   91s
     0     0 78940.1060    0  351 61622.9849 78940.1060  28.1%     -   91s
     0     0 78936.8802    0  354 61622.9849 78936.8802  28.1%     -   92s
     0     0 78936.3244    0  356 61622.9849 78936.3244  28.1%     -   92s
     0     0 78935.7671    0  356 61622.9849 78935.7671  28.1%     -   93s
     0     0 78935.0854    0  356 61622.9849 78935.0854  28.1%     -   93s
     0     2 78935.0854    0  356 61622.9849 78935.0854  28.1%     -  104s
     1     4 78893.9422    1  332 61622.9849 78935.0854  28.1%  1275  106s
     3     8 78815.6061    2  391 61622.9849 78893.9219  28.0%  2048  111s
     7    16 78490.9468    3  347 61622.9849 78812.6086  27.9%  2983  116s
    15    32 77834.5620    4  400 61622.9849 78541.1879  27.5%  3956  123s
    31    59 77097.6726    5  395 61622.9849 78074.5099  26.7%  5957  135s
    58    91 76590.5077    6  337 61622.9849 78074.5099  26.7%  5918  144s
    90   124 75866.7117    7  291 61622.9849 78074.5099  26.7%  4759  151s
   123   240 75746.3975    8  285 61622.9849 78074.5099  26.7%  3991  159s
   239   331 75600.7868    9  285 61622.9849 78074.5099  26.7%  2941  166s
   330   411 74914.5044    9  312 61622.9849 78074.5099  26.7%  2632  173s
   410   484 75493.1935   10  287 61622.9849 78074.5099  26.7%  2455  179s
   483   554 75552.0449   10  279 61622.9849 78074.5099  26.7%  2431  185s
   553   642 74843.4004   10  286 61622.9849 78074.5099  26.7%  2361  190s
   641   724 74708.8015   11  272 61622.9849 78074.5099  26.7%  2208  197s
   723   816 74874.1845   11  266 61622.9849 78074.5099  26.7%  2120  203s
   815   848 74322.5075   11  246 61622.9849 78074.5099  26.7%  2040  208s
   847   880 73828.7929   12  319 61622.9849 78074.5099  26.7%  2057  213s
   881   910 71418.4721   12  294 61622.9849 78074.5099  26.7%  2080  218s
   915   940 73855.6047   12  327 61622.9849 78074.5099  26.7%  2095  223s
   949   970 71886.1132   12  276 61622.9849 78074.5099  26.7%  2086  228s
   987  1004 73345.8209   12  273 61622.9849 77911.2401  26.4%  2075  234s
  1032  1066 73330.5839   12  257 61622.9849 77911.2401  26.4%  2067  239s
  1100  1146 71368.1896   12  213 61622.9849 77895.8326  26.4%  2028  245s
  1186  1215 73713.0991   13  313 61622.9849 77895.8326  26.4%  1951  252s
  1289  1302 71797.3614   13  326 61622.9849 77895.8326  26.4%  1895  258s
  1385  1400 73208.9655   13  260 61622.9849 77895.8326  26.4%  1858  267s
  1497  1479 72511.9028   16  251 61622.9849 77895.8326  26.4%  1817  275s
  1611  1557 71520.6637   16  246 61622.9849 77895.8326  26.4%  1774  282s
  1717  1621 71408.0497   17  238 61622.9849 77604.4634  25.9%  1751  289s
  1799  1692 71953.8363   20  237 61622.9849 77604.4634  25.9%  1773  296s
  1890  1775 70307.6542   22  238 61622.9849 77604.4634  25.9%  1787  302s
  1995  1845 68474.9267   21  279 61622.9849 77064.7508  25.1%  1782  313s
  2097  1943 69393.5453   22  232 61622.9849 77064.7508  25.1%  1780  323s
  2247  2101 63487.8914   23  182 61622.9849 76952.0474  24.9%  1755  334s
  2437  2135 66894.3379   23  281 61622.9849 76952.0474  24.9%  1703  343s
  2573  2202 65324.8013   23  204 61622.9849 76921.8231  24.8%  1714  353s
  2682  2291 63763.1589   25  275 61622.9849 76921.8231  24.8%  1742  362s
  2817  2441     cutoff   25      61622.9849 76921.8231  24.8%  1745  372s
  3039  2592     cutoff   28      61622.9849 76763.9094  24.6%  1697  383s
  3308  2736 73650.4338    7  366 61622.9849 76763.9094  24.6%  1640  393s
  3534  2878 69986.2709   11  368 61622.9849 76708.9389  24.5%  1613  407s
  3756  2937     cutoff   14      61622.9849 76708.9389  24.5%  1596  419s
  3937  2987 62134.6148   15  182 61622.9849 76708.9389  24.5%  1604  429s
  4075  3045 74182.3709    8  352 61622.9849 76708.9389  24.5%  1626  441s
  4280  3068 67055.9512   10  357 61622.9849 76590.8927  24.3%  1628  453s
  4387  3146 66236.8187   11  328 61622.9849 76567.4313  24.3%  1638  466s
  4493  3207 64087.0591   13  248 61622.9849 76567.4313  24.3%  1665  479s
  4658  3289 68634.7646    8  368 61622.9849 76567.4313  24.3%  1684  492s
  4839  3290 64668.5504   25  356 61622.9849 76435.5285  24.0%  1696  518s
  4841  3291 64118.5239   26   78 61622.9849 76435.5285  24.0%  1695  531s
  4842  3292 74694.8132   13  271 61622.9849 76435.5285  24.0%  1695  540s
  4844  3293 62059.8021   95  385 61622.9849 76435.5285  24.0%  1694  547s
  4845  3294 70696.8697   14  389 61622.9849 76435.5285  24.0%  1694  550s
  4847  3295 72588.2190   15  416 61622.9849 76435.5285  24.0%  1693  555s
  4851  3298 72341.1622   26  429 61622.9849 76435.5285  24.0%  1692  563s
  4853  3299 68570.7842   29  409 61622.9849 76435.5285  24.0%  1691  566s
  4855  3301 63552.2948   23  350 61622.9849 76435.5285  24.0%  1690  570s
  4858  3303 62983.9696   24  354 61622.9849 76435.5285  24.0%  1689  575s
  4860  3304 62600.7781   73  411 61622.9849 76435.5285  24.0%  1689  581s
  4863  3306 65853.0912   20  402 61622.9849 76435.5285  24.0%  1688  585s
  4866  3308 63079.6213   53  408 61622.9849 76435.5285  24.0%  1686  591s
  4869  3310 64414.3590   23  404 61622.9849 76435.5285  24.0%  1685  609s
  4870  3311 64494.7490   21  404 61622.9849 76435.5285  24.0%  1685  617s
  4871  3314 76435.5285   15  387 61622.9849 76435.5285  24.0%  1701  631s
  4873  3318 76435.5285   16  345 61622.9849 76435.5285  24.0%  1702  639s
  4877  3324 76435.5285   17  355 61622.9849 76435.5285  24.0%  1704  651s
  4885  3338 76435.5285   18  345 61622.9849 76435.5285  24.0%  1711  662s
  4901  3362 76435.5285   19  329 61622.9849 76435.5285  24.0%  1737  678s
  4931  3384 76435.5285   20  400 61622.9849 76435.5285  24.0%  1774  691s
  4963  3427 76044.4249   21  435 61622.9849 76435.5285  24.0%  1797  703s
  5016  3490 75246.6713   22  410 61622.9849 76435.5285  24.0%  1850  717s
  5101  3531 74323.4519   23  411 61622.9849 76435.5285  24.0%  1868  726s
  5177  3563 72918.1363   24  310 61622.9849 76435.5285  24.0%  1881  733s
  5246  3582 70460.9919   24  369 61622.9849 76435.5285  24.0%  1892  743s
  5331  3588 72461.5115   25  350 61622.9849 76435.5285  24.0%  1896  752s
  5409  3593 67581.0973   25  282 61622.9849 76435.5285  24.0%  1899  761s
  5473  3617 71812.4358   26  396 61622.9849 76004.4874  23.3%  1911  767s
  5530  3624 65065.5602   26  333 61622.9849 75386.6788  22.3%  1919  774s
  5568  3637 70013.1209   27  423 61622.9849 75386.6788  22.3%  1928  781s
  5614  3650 69934.1307   27  376 61622.9849 75386.6788  22.3%  1934  790s
  5657  3665 69179.4169   28  347 61622.9849 75386.6788  22.3%  1937  798s
  5709  3676 67079.5399   28  347 61622.9849 75386.6788  22.3%  1945  807s
  5764  3679 67852.7446   29  332 61622.9849 74848.6456  21.5%  1949  814s
  5839  3683 65458.8764   29  330 61622.9849 74848.6456  21.5%  1951  822s
  5914  3685 66909.1015   30  337 61622.9849 74848.6456  21.5%  1951  830s
  5994  3666 infeasible   30      61622.9849 74848.6456  21.5%  1948  840s
  6067  3673 61860.0680   32  248 61622.9849 74472.2349  20.9%  1955  851s
  6142  3678     cutoff   32      61622.9849 74472.2349  20.9%  1960  864s
  6226  3683 69984.6322   21  331 61622.9849 74337.6943  20.6%  1970  875s
  6310  3683 69390.0734   22  335 61622.9849 74266.2948  20.5%  1980  885s
  6402  3688 69202.5139   23  333 61622.9849 74266.2948  20.5%  1987  894s
  6495  3691 67621.7965   24  281 61622.9849 74266.2948  20.5%  1990  905s
  6601  3689 67207.6440   25  251 61622.9849 73942.0279  20.0%  1993  915s
  6715  3693 66610.8876   26  191 61622.9849 73611.9345  19.5%  1996  930s
  6830  3684 65367.5642   27  199 61622.9849 73611.9345  19.5%  2000  942s
  6960  3670 64305.9092   30  166 61622.9849 73611.9345  19.5%  2003  958s
  7114  3659 62715.6308   38  176 61622.9849 73350.6828  19.0%  2004  970s
  7255  3653 62166.0130   52  142 61622.9849 73350.6828  19.0%  2001  982s
  7375  3642 66795.6578   22  357 61622.9849 73224.9800  18.8%  2011  996s
  7531  3638     cutoff   24      61622.9849 73186.9883  18.8%  2016 1010s
  7683  3658 66314.3847   22  250 61622.9849 73186.9883  18.8%  2023 1024s
  7848  3645 63218.3497   27  244 61622.9849 73186.9883  18.8%  2030 1041s
  8019  3622 61733.1999   28  216 61622.9849 72966.4670  18.4%  2035 1059s
  8194  3603 63955.2243   25  301 61622.9849 72798.0978  18.1%  2042 1077s
  8302  3615 61938.9861   26  260 61622.9849 72712.9490  18.0%  2046 1092s
  8439  3591     cutoff   27      61622.9849 72152.4853  17.1%  2054 1107s
  8480  3600 69561.5197   25  304 61622.9849 71920.1435  16.7%  2059 1121s
  8541  3620 67445.5012   26  296 61622.9849 71920.1435  16.7%  2061 1137s
  8635  3610 66379.8624   27  277 61622.9849 71852.7709  16.6%  2064 1154s
  8705  3611 63008.8784   28  253 61622.9849 71679.7308  16.3%  2069 1172s
  8799  3597 61805.6062   29  274 61622.9849 71679.7308  16.3%  2071 1190s
  8925  3569 61801.5611   30  276 61622.9849 71583.2915  16.2%  2068 1209s
  9036  3537     cutoff   31      61622.9849 71556.0111  16.1%  2069 1227s
  9176  3512 64788.5589   28  280 61622.9849 71491.3381  16.0%  2073 1249s
  9354  3489 62759.4976   30  227 61622.9849 71491.3381  16.0%  2082 1274s
  9606  3484 62543.3301   25  321 61622.9849 71491.3381  16.0%  2088 1295s
  9870  3420 63227.5047   26  226 61622.9849 71199.6279  15.5%  2096 1320s
 10196  3377 63779.3973   27  363 61622.9849 70499.4469  14.4%  2102 1344s
 10531  3310 64847.9977   24  301 61622.9849 70492.1394  14.4%  2104 1367s
 10887  3256 63177.1716   26  358 61622.9849 70213.7572  13.9%  2105 1393s
 11349  3146 62702.7255   23  263 61622.9849 69878.0628  13.4%  2091 1420s
 11745  3059     cutoff   25      61622.9849 69578.3613  12.9%  2092 1446s
 12189  2963 64156.3830   27  305 61622.9849 69209.2615  12.3%  2087 1473s
 12662  2811     cutoff   26      61622.9849 69010.1719  12.0%  2079 1507s
 13137  2740 infeasible   33      61622.9849 68726.6225  11.5%  2076 1535s
 13664  2579     cutoff   27      61622.9849 68464.6162  11.1%  2070 1564s
 13744  2577     cutoff   32      61622.9849 68423.4718  11.0%  2069 1591s
 13974  2486 66992.8650   24  330 61622.9849 68423.4718  11.0%  2060 1624s
 14394  2368 65800.2290   25  288 61622.9849 68423.4718  11.0%  2049 1655s
 15028  2256 62796.6177   29  178 61622.9849 67923.1776  10.2%  2034 1686s
 15640  2230     cutoff   27      61622.9849 67453.1815  9.46%  2025 1719s
 16403  2168     cutoff   24      61622.9849 67086.4716  8.87%  2006 1754s
 17190  2152 infeasible   25      61622.9849 66659.6691  8.17%  1989 1792s
 18076  2077 64314.2113   33  306 61622.9849 66273.8160  7.55%  1963 1828s
 19023  1976 63944.5889   31  184 61622.9849 65846.1585  6.85%  1935 1867s
 20016  1784     cutoff   31      61622.9849 65392.4905  6.12%  1907 1906s
 21000  1436     cutoff   27      61622.9849 64839.7438  5.22%  1886 1944s
 22324   700     cutoff   46      61622.9849 64255.6070  4.27%  1841 1984s
 24172     0     cutoff   33      61622.9849 63515.6348  3.07%  1761 2010s

Cutting planes:
  Learned: 1
  MIR: 446
  Mixing: 2
  Flow cover: 776
  RLT: 7
  Relax-and-lift: 87

Explored 25291 nodes (43207358 simplex iterations) in 2010.31 seconds (4171.54 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 61623 59590.7 58943.8 ... 55640.4

Optimal solution found (tolerance 1.00e-04)
Best objective 6.162298493903e+04, best bound 6.162298493903e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2010.33s
  Master Objective (UB) = 61622.98, θ = 230405.02
  Upper Bound (UB) = 61622.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 230405.02
  [DEBUG]   ✓ Scenario 0: θ = 230405.02 ≤ Q = 230405.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 230405.02 ≤ Q = 230405.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 230405.02 ≤ Q = 230405.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 230405.02 ≤ Q = 230405.02 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x43ae48cf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbc51b731
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.462804e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.01s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7245936.7728
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.969533e+05, 278 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196953.33    0  134 7245936.77 -196953.33   103%     -    0s
H    0     0                    -157081.1080 -196953.33  25.4%     -    0s
H    0     0                    -157748.4684 -196953.33  24.9%     -    0s
H    0     0                    -164717.9318 -196953.33  19.6%     -    0s
H    0     0                    -179604.8454 -196953.33  9.66%     -    0s
     0     0 -182600.25    0   92 -179604.85 -182600.25  1.67%     -    0s
H    0     0                    -179709.5507 -182598.75  1.61%     -    0s
H    0     0                    -180301.2875 -182598.75  1.27%     -    0s
     0     0 -181895.01    0   70 -180301.29 -181895.01  0.88%     -    0s
     0     0 -181894.55    0   69 -180301.29 -181894.55  0.88%     -    0s
     0     0 -181434.35    0   81 -180301.29 -181434.35  0.63%     -    0s
H    0     0                    -180501.7704 -181383.84  0.49%     -    0s
H    0     0                    -180581.2935 -181383.84  0.44%     -    0s
     0     0 -181366.18    0   83 -180581.29 -181366.18  0.43%     -    0s
     0     0 -181366.18    0   82 -180581.29 -181366.18  0.43%     -    0s
     0     0 -181280.45    0   76 -180581.29 -181280.45  0.39%     -    0s
     0     0 -181278.48    0   75 -180581.29 -181278.48  0.39%     -    0s
     0     0 -181258.88    0   77 -180581.29 -181258.88  0.38%     -    0s
     0     0 -181258.76    0   77 -180581.29 -181258.76  0.38%     -    0s
     0     0 -181118.16    0   79 -180581.29 -181118.16  0.30%     -    0s
     0     0 -181114.84    0   80 -180581.29 -181114.84  0.30%     -    0s
     0     0 -181053.44    0   76 -180581.29 -181053.44  0.26%     -    0s
     0     0 -181050.62    0   76 -180581.29 -181050.62  0.26%     -    0s
     0     2 -181047.03    0   76 -180581.29 -181047.03  0.26%     -    0s
H   38    16                    -180592.0907 -180737.97  0.08%  13.7    0s
H  166    60                    -180635.7715 -180681.85  0.03%   6.2    0s
H  176    60                    -180636.3161 -180681.85  0.03%   6.0    0s
H  225    60                    -180644.7346 -180681.85  0.02%   5.5    0s

Cutting planes:
  Gomory: 46
  Implied bound: 5
  MIR: 112
  Flow cover: 24
  RLT: 55
  Relax-and-lift: 1

Explored 335 nodes (2449 simplex iterations) in 0.16 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -180645 -180636 -180636 ... -164718

Optimal solution found (tolerance 1.00e-04)
Best objective -1.806447346331e+05, best bound -1.806567627574e+05, gap 0.0067%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 212809.90
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -180644.73
  [DEBUG]   S×d_nominal = 393454.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 393454.64 + -180644.73 = 212809.90
  [DEBUG]   Current θ from Master = 230405.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17595.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44027.86
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 8296.0377, Absolute Gap = 8296.0377, Relative Gap = 0.134626
  Not converged yet (gap = 8296.04 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0xb7cfb177
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 1.17s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -219107.7947

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26801    4.0598405e+04   0.000000e+00   1.865503e+07      5s
   39203    6.3808648e+04   0.000000e+00   9.851000e+06     10s
   51226    8.4622835e+04   0.000000e+00   1.688515e+06     15s
Concurrent spin time: 1.16s

Solved with dual simplex

Root relaxation: objective 9.198945e+04, 33822 iterations, 16.32 seconds (21.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91989.4528    0   78 -219107.79 91989.4528   142%     -   18s
H    0     0                    -208237.5007 91989.4528   144%     -   18s
H    0     0                    -176179.1827 91989.4528   152%     -   18s
H    0     0                    -175786.8457 91989.4528   152%     -   18s
H    0     0                    -121507.1945 91989.4528   176%     -   18s
H    0     0                    -95846.34903 91989.4528   196%     -   18s
H    0     0                    -91524.14574 91989.4528   201%     -   18s
H    0     0                    -91378.12132 91989.4528   201%     -   18s
H    0     0                    -91347.49110 91989.4528   201%     -   18s
H    0     0                    -48562.64880 91989.4528   289%     -   18s
H    0     0                    -5499.718767 91989.4528  1773%     -   18s
H    0     0                    7571.9865293 91989.4528  1115%     -   18s
H    0     0                    38231.943775 91989.4528   141%     -   18s
H    0     0                    44102.566973 91989.4528   109%     -   18s
H    0     0                    44128.701558 91989.4528   108%     -   18s
H    0     0                    44404.462807 91989.4528   107%     -   18s
H    0     0                    44404.651968 91989.4528   107%     -   18s
     0     0 86444.9765    0  169 44404.6520 86444.9765  94.7%     -   26s
H    0     0                    48733.608536 86444.8385  77.4%     -   26s
H    0     0                    48805.598392 86444.8385  77.1%     -   26s
H    0     0                    49257.911212 86444.8385  75.5%     -   26s
     0     0 86040.0466    0  184 49257.9112 86040.0466  74.7%     -   28s
     0     0 86030.7874    0  188 49257.9112 86030.7874  74.7%     -   29s
     0     0 86030.7217    0  204 49257.9112 86030.7217  74.7%     -   29s
     0     0 83335.6263    0  246 49257.9112 83335.6263  69.2%     -   37s
H    0     0                    50248.048310 83335.2106  65.8%     -   37s
H    0     0                    50341.585607 82365.4701  63.6%     -   44s
H    0     0                    50450.521150 82365.4701  63.3%     -   44s
     0     0 82365.4701    0  297 50450.5211 82365.4701  63.3%     -   44s
     0     0 82188.9224    0  272 50450.5211 82188.9224  62.9%     -   46s
     0     0 82114.3234    0  300 50450.5211 82114.3234  62.8%     -   47s
     0     0 82090.1994    0  308 50450.5211 82090.1994  62.7%     -   48s
     0     0 82084.6347    0  312 50450.5211 82084.6347  62.7%     -   49s
     0     0 82084.4137    0  291 50450.5211 82084.4137  62.7%     -   49s
     0     0 80867.1291    0  363 50450.5211 80867.1291  60.3%     -   60s
H    0     0                    50482.008339 80867.0811  60.2%     -   60s
H    0     0                    50485.729161 80867.0811  60.2%     -   60s
H    0     0                    51334.290388 80453.2602  56.7%     -   66s
H    0     0                    52725.739038 80453.2602  52.6%     -   66s
     0     0 80453.2602    0  338 52725.7390 80453.2602  52.6%     -   66s
H    0     0                    52840.366255 80356.9074  52.1%     -   69s
     0     0 80356.9074    0  340 52840.3663 80356.9074  52.1%     -   69s
     0     0 80276.2267    0  382 52840.3663 80276.2267  51.9%     -   73s
     0     0 80222.0589    0  386 52840.3663 80222.0589  51.8%     -   74s
     0     0 80176.9175    0  353 52840.3663 80176.9175  51.7%     -   75s
     0     0 80156.5782    0  394 52840.3663 80156.5782  51.7%     -   76s
     0     0 80153.6556    0  390 52840.3663 80153.6556  51.7%     -   77s
     0     0 80150.5505    0  395 52840.3663 80150.5505  51.7%     -   77s
     0     0 80149.6331    0  396 52840.3663 80149.6331  51.7%     -   77s
     0     0 79539.7228    0  409 52840.3663 79539.7228  50.5%     -   91s
H    0     0                    52966.641288 79539.4287  50.2%     -   91s
     0     0 79339.4666    0  412 52966.6413 79339.4666  49.8%     -   94s
     0     0 79219.1203    0  371 52966.6413 79219.1203  49.6%     -   97s
H    0     0                    53157.475293 79180.4454  49.0%     -   99s
H    0     0                    53624.196450 79180.4454  47.7%     -   99s
     0     0 79180.4454    0  383 53624.1965 79180.4454  47.7%     -   99s
H    0     0                    53632.209269 79158.4590  47.6%     -  100s
     0     0 79158.4590    0  377 53632.2093 79158.4590  47.6%     -  100s
     0     0 79154.0484    0  371 53632.2093 79154.0484  47.6%     -  102s
     0     0 79149.5539    0  375 53632.2093 79149.5539  47.6%     -  103s
     0     0 79145.3141    0  374 53632.2093 79145.3141  47.6%     -  103s
     0     0 79140.1597    0  371 53632.2093 79140.1597  47.6%     -  104s
     0     0 79139.6869    0  378 53632.2093 79139.6869  47.6%     -  104s
H    0     0                    54006.311976 79139.6869  46.5%     -  105s
H    0     0                    54418.198587 79139.6869  45.4%     -  105s
H    0     0                    54494.327165 79092.7161  45.1%     -  106s
H    0     0                    54511.918943 79092.7161  45.1%     -  106s
H    0     0                    55027.970318 79092.7161  43.7%     -  106s
     0     0 79092.7161    0  417 55027.9703 79092.7161  43.7%     -  107s
     0     0 79071.9601    0  449 55027.9703 79071.9601  43.7%     -  108s
     0     0 79060.6688    0  425 55027.9703 79060.6688  43.7%     -  109s
     0     0 79057.0368    0  421 55027.9703 79057.0368  43.7%     -  110s
     0     0 79054.8793    0  421 55027.9703 79054.8793  43.7%     -  110s
     0     0 79054.2626    0  424 55027.9703 79054.2626  43.7%     -  110s
     0     0 79019.3953    0  408 55027.9703 79019.3953  43.6%     -  113s
     0     0 79008.8988    0  351 55027.9703 79008.8988  43.6%     -  114s
     0     0 79001.9100    0  351 55027.9703 79001.9100  43.6%     -  114s
     0     0 78998.5421    0  431 55027.9703 78998.5421  43.6%     -  115s
     0     0 78998.0005    0  432 55027.9703 78998.0005  43.6%     -  115s
     0     0 78919.7989    0  384 55027.9703 78919.7989  43.4%     -  117s
     0     0 78912.5104    0  360 55027.9703 78912.5104  43.4%     -  118s
     0     0 78910.7494    0  360 55027.9703 78910.7494  43.4%     -  118s
     0     0 78910.3275    0  362 55027.9703 78910.3275  43.4%     -  119s
     0     0 78904.1761    0  360 55027.9703 78904.1761  43.4%     -  119s
H    0     0                    55245.465587 78904.0581  42.8%     -  120s
H    0     0                    55302.806748 78904.0581  42.7%     -  120s
H    0     0                    55318.117630 78904.0581  42.6%     -  120s
H    0     0                    55447.497589 78904.0581  42.3%     -  120s
     0     0 78891.3194    0  393 55447.4976 78891.3194  42.3%     -  121s
     0     0 78886.9317    0  443 55447.4976 78886.9317  42.3%     -  121s
     0     0 78886.7139    0  428 55447.4976 78886.7139  42.3%     -  121s
     0     0 78882.6724    0  375 55447.4976 78882.6724  42.3%     -  123s
     0     0 78881.0683    0  379 55447.4976 78881.0683  42.3%     -  124s
     0     0 78880.3771    0  376 55447.4976 78880.3771  42.3%     -  124s
     0     0 78879.0837    0  375 55447.4976 78879.0837  42.3%     -  125s
     0     0 78878.8297    0  376 55447.4976 78878.8297  42.3%     -  125s
     0     0 78878.7251    0  375 55447.4976 78878.7251  42.3%     -  126s
     0     0 78878.5572    0  376 55447.4976 78878.5572  42.3%     -  126s
     0     0 78877.2286    0  376 55447.4976 78877.2286  42.3%     -  127s
H    0     0                    55457.059592 78877.2286  42.2%     -  142s
     0     2 78877.2286    0  376 55457.0596 78877.2286  42.2%     -  143s
     1     4 78656.4703    1  361 55457.0596 78874.9463  42.2%  6051  147s
     3     8 78551.7259    2  359 55457.0596 78653.5028  41.8%  5185  153s
     7    16 78339.7525    3  370 55457.0596 78550.0240  41.6%  6039  160s
    15    32 78170.0334    4  365 55457.0596 78337.2322  41.3%  6504  170s
    31    58 76839.4362    5  330 55457.0596 78170.0155  41.0%  8444  187s
H   40    58                    56494.971154 78170.0155  38.4%  8710  187s
    57    90 76415.3984    6  393 56494.9712 78170.0155  38.4%  8157  196s
H   89   151                    56619.286395 78170.0155  38.1%  6214  204s
H   91   151                    56908.925372 78170.0155  37.4%  6100  204s
H   92   151                    57091.561716 78170.0155  36.9%  6074  204s
H   94   151                    57205.684796 78170.0155  36.6%  5983  204s
H  103   151                    57242.939300 78170.0155  36.6%  5603  204s
H  106   151                    57259.953986 78170.0155  36.5%  5539  204s
   150   252 76255.8305    9  398 57259.9540 78170.0155  36.5%  4405  215s
   251   320 76057.4299    8  371 57259.9540 78170.0155  36.5%  3424  224s
H  267   320                    57324.295696 78170.0155  36.4%  3482  224s
H  319   375                    57347.927323 78170.0155  36.3%  3435  232s
H  322   375                    57397.799889 78170.0155  36.2%  3441  232s
H  331   375                    57481.121348 78170.0155  36.0%  3415  232s
H  341   375                    57763.252273 78170.0155  35.3%  3391  232s
   374   435 75610.1060    9  401 57763.2523 78170.0155  35.3%  3298  244s
   434   504 75736.6561   11  386 57763.2523 78170.0155  35.3%  3169  253s
   505   536 75628.1342   11  410 57763.2523 78170.0155  35.3%  3055  259s
   537   578 75060.4592   11  374 57763.2523 78170.0155  35.3%  3032  266s
H  570   578                    57893.968830 78170.0155  35.0%  3032  266s
   579   608 75556.7132   12  384 57893.9688 78170.0155  35.0%  3003  272s
   611   639 75466.6584   12  341 57893.9688 78170.0155  35.0%  2989  278s
H  625   639                    58036.269320 78170.0155  34.7%  3022  278s
   644   743 74934.1046   11  370 58036.2693 78170.0155  34.7%  3023  286s
   750   804 74728.9450   12  397 58036.2693 78170.0155  34.7%  2767  298s
   815   836 75028.3033   12  341 58036.2693 78170.0155  34.7%  2673  303s
   847   874 74650.4713   13  363 58036.2693 78170.0155  34.7%  2643  309s
   885   911 74838.3520   13  347 58036.2693 78170.0155  34.7%  2608  314s
   922   954 74903.0169   13  356 58036.2693 78170.0155  34.7%  2564  319s
   965   985 74464.5241   13  367 58036.2693 78170.0155  34.7%  2522  324s
   998  1028 74166.7882   12  354 58036.2693 78170.0155  34.7%  2482  330s
  1041  1101 74377.9369   12  346 58036.2693 78170.0155  34.7%  2427  335s
  1122  1199 74555.0410   14  354 58036.2693 78170.0155  34.7%  2325  345s
  1222  1316 74327.2856   14  321 58036.2693 78170.0155  34.7%  2247  352s
  1341  1428 74485.2483   14  366 58036.2693 78170.0155  34.7%  2148  363s
  1485  1528 74326.3596   15  307 58036.2693 78170.0155  34.7%  2034  375s
  1622  1587 72733.7619   15  278 58036.2693 78083.2017  34.5%  1976  385s
  1714  1643 73912.4915   16  359 58036.2693 78083.2017  34.5%  1999  398s
  1794  1704 72435.5037   16  318 58036.2693 77774.6423  34.0%  2038  409s
  1859  1773 72981.2717   17  309 58036.2693 77771.0239  34.0%  2090  421s
  1944  1842 72162.2806   17  274 58036.2693 77771.0239  34.0%  2124  434s
  2031  1915 70478.2814   18  300 58036.2693 77771.0239  34.0%  2155  447s
  2119  2008 71339.4609   17  263 58036.2693 77011.0193  32.7%  2188  459s
  2230  2118 70713.5308   18  214 58036.2693 77011.0193  32.7%  2200  473s
  2356  2238 70706.5448   18  265 58036.2693 77011.0193  32.7%  2199  486s
  2541  2332 64552.1038   19  305 58036.2693 76803.7801  32.3%  2156  501s
  2675  2464 69650.6318   19  331 58036.2693 76795.4063  32.3%  2169  513s
  2841  2620 66910.5338   18  233 58036.2693 76795.4063  32.3%  2156  527s
  3038  2650 65793.6022   19  264 58036.2693 76731.7464  32.2%  2124  542s
  3070  2675 70588.2162   19  249 58036.2693 76731.7464  32.2%  2138  561s
  3111  2683 69488.9481   20  235 58036.2693 76731.7464  32.2%  2150  574s
  3166  2710 67703.9933   20  242 58036.2693 76731.7464  32.2%  2151  585s
  3205  2738 67961.6938   21  228 58036.2693 76731.7464  32.2%  2165  597s
H 3219  2734                    58177.733143 76731.7464  31.9%  2167  597s
  3244  2870 67883.1484   22  220 58177.7331 76731.7464  31.9%  2177  616s
  3420  3046 65646.4593   23  134 58177.7331 76731.7464  31.9%  2177  632s
H 3652  3044                    58282.005859 76421.2932  31.1%  2143  638s
H 3652  3041                    58472.284969 76421.2932  30.7%  2143  639s
  3653  3042 72822.8226   16  376 58472.2850 76421.2932  30.7%  2142  666s
  3655  3043 65708.1788   35   78 58472.2850 76421.2932  30.7%  2141  683s
H 3655  2890                    58492.908825 76421.2932  30.7%  2141  696s
  3657  2892 60752.1747   58  315 58492.9088 76421.2932  30.7%  2140  708s
  3658  2892 61887.3106   46  398 58492.9088 76421.2932  30.7%  2139  715s
  3659  2893 72353.0932   11  415 58492.9088 76421.2932  30.7%  2138  721s
  3660  2894 71928.6112   17  357 58492.9088 76421.2932  30.7%  2138  725s
  3663  2896 69917.2142   34  355 58492.9088 76421.2932  30.7%  2136  731s
  3665  2897 59564.3311   58  350 58492.9088 76421.2932  30.7%  2135  735s
  3668  2899 67479.3276   25  360 58492.9088 76421.2932  30.7%  2133  743s
H 3668  2754                    58565.631218 76421.2932  30.5%  2133  744s
  3669  2755 64655.4635   23  355 58565.6312 76421.2932  30.5%  2133  745s
  3671  2756 64148.5296   28  357 58565.6312 76421.2932  30.5%  2131  750s
  3673  2757 63507.0797   63  343 58565.6312 76421.2932  30.5%  2130  756s
  3675  2759 71986.9977   11  359 58565.6312 76421.2932  30.5%  2129  760s
  3678  2761 73686.4718   11  351 58565.6312 76421.2932  30.5%  2127  766s
  3681  2763 73383.8612   11  365 58565.6312 76421.2932  30.5%  2126  771s
  3682  2763 69010.7688   23  365 58565.6312 76421.2932  30.5%  2125  791s
  3683  2764 72104.8518   29  365 58565.6312 76421.2932  30.5%  2124  814s
  3684  2768 76421.2932   13  354 58565.6312 76421.2932  30.5%  2158  826s
  3686  2771 76421.2932   14  348 58565.6312 76421.2932  30.5%  2160  842s
  3690  2778 76421.2932   15  352 58565.6312 76421.2932  30.5%  2166  854s
  3698  2791 76421.2932   16  361 58565.6312 76421.2932  30.5%  2175  872s
  3714  2807 76421.2932   17  354 58565.6312 76421.2932  30.5%  2227  900s
H 3718  2666                    58568.854205 76421.2932  30.5%  2234  900s
  3735  2693 76421.2932   18  338 58568.8542 76421.2932  30.5%  2270  914s
  3767  2730 74653.1760   19  381 58568.8542 76421.2932  30.5%  2314  931s
  3815  2794 73727.4428   20  335 58568.8542 76421.2932  30.5%  2369  949s
  3899  2820 73091.9031   21  377 58568.8542 76421.2932  30.5%  2425  966s
  3975  2825 72125.1727   21  296 58568.8542 76421.2932  30.5%  2465  980s
  4061  2820 71326.8625   22  320 58568.8542 76421.2932  30.5%  2484  994s
  4129  2815 64762.0572   23  359 58568.8542 76421.2932  30.5%  2505 1010s
  4200  2811 66877.9492   23  304 58568.8542 76421.2932  30.5%  2525 1025s
  4257  2815 66545.8350   24  307 58568.8542 76421.2932  30.5%  2555 1039s
  4323  2815 66296.1890   25  303 58568.8542 76421.2932  30.5%  2575 1054s
  4388  2835 63059.3505   26  328 58568.8542 75952.3929  29.7%  2596 1067s
  4446  2842 65407.4884   26  302 58568.8542 75952.3929  29.7%  2624 1074s
  4479  2851 64133.6721   27  260 58568.8542 75952.3929  29.7%  2638 1085s
  4522  2860 63168.2410   27  332 58568.8542 75952.3929  29.7%  2646 1097s
  4559  2871 63895.8038   28  290 58568.8542 75952.3929  29.7%  2657 1107s
  4606  2896 62242.8032   28  339 58568.8542 75952.3929  29.7%  2671 1117s
  4659  2919 63462.1165   29  288 58568.8542 75952.3929  29.7%  2680 1128s
  4729  2924 60707.4131   29  186 58568.8542 75516.2402  28.9%  2684 1143s
  4786  2946     cutoff   30      58568.8542 75516.2402  28.9%  2691 1157s
  4867  2972 60394.6114   30  247 58568.8542 74414.5992  27.1%  2699 1172s
  4954  2988 59917.6110   31  229 58568.8542 74398.3131  27.0%  2704 1185s
  5065  2979 59894.4673   32  233 58568.8542 74375.0922  27.0%  2694 1200s
  5193  2996 71046.3364   20  361 58568.8542 73760.9853  25.9%  2681 1217s
  5317  2969 67838.5610   23  281 58568.8542 73658.7703  25.8%  2674 1230s
  5361  2973 66517.4947   24  255 58568.8542 73658.7703  25.8%  2677 1240s
  5405  2983 66388.2743   25  203 58568.8542 73614.8192  25.7%  2677 1254s
  5447  2996 66325.4006   26  212 58568.8542 73614.8192  25.7%  2681 1266s
  5483  3013 66074.1412   27  204 58568.8542 73614.8192  25.7%  2683 1278s
  5543  3014 65943.6168   28  204 58568.8542 73437.2117  25.4%  2683 1296s
  5616  3044 63262.2426   31  266 58568.8542 73437.2117  25.4%  2687 1313s
  5712  3070 60420.1576   35  174 58568.8542 73437.2117  25.4%  2690 1329s
H 5773  2918                    58879.516300 73437.2117  24.7%  2689 1329s
H 5785  2788                    59262.194306 73437.2117  23.9%  2691 1329s
  5828  2802     cutoff   41      59262.1943 73437.2117  23.9%  2686 1347s
H 5836  2680                    59356.750132 73437.2117  23.7%  2684 1347s
  5934  2738 70856.7659   24  371 59356.7501 73437.2117  23.7%  2683 1367s
  6099  2783 68317.5069   28  238 59356.7501 73437.2117  23.7%  2685 1386s
  6253  2808 64897.9728   31  171 59356.7501 73327.8222  23.5%  2688 1407s
  6419  2813 infeasible   36      59356.7501 73327.8222  23.5%  2689 1433s
  6611  2814 67844.7499   23  320 59356.7501 73327.8222  23.5%  2688 1457s
  6797  2821 65385.3090   28  308 59356.7501 73327.8222  23.5%  2691 1481s
H 6974  2660                    59408.122245 73327.8222  23.4%  2701 1498s
H 6984  2550                    59494.126026 73327.8222  23.3%  2701 1498s
  7027  2609 62642.0923   36  123 59494.1260 73327.8222  23.3%  2705 1524s
  7244  2608 63285.8676   22  292 59494.1260 73327.8222  23.3%  2705 1548s
  7449  2599 64481.1033   22  265 59494.1260 73327.8222  23.3%  2712 1572s
  7676  2627 59505.1730   27  159 59494.1260 71810.4118  20.7%  2719 1598s
  7900  2631 62004.2572   25  350 59494.1260 71528.4719  20.2%  2733 1631s
  8190  2549     cutoff   28      59494.1260 71528.4719  20.2%  2723 1652s
H 8215  2437                    59509.733738 71528.4719  20.2%  2727 1652s
  8240  2505     cutoff   28      59509.7337 71528.4719  20.2%  2727 1683s
  8521  2488 63539.7454   25  344 59509.7337 71528.4719  20.2%  2726 1712s
  8813  2539 59870.5849   28  313 59509.7337 70949.2644  19.2%  2728 1740s
  9087  2611 63256.7600   22  330 59509.7337 70221.2646  18.0%  2738 1773s
  9517  2503 60148.3680   27  266 59509.7337 70221.2646  18.0%  2702 1806s
  9585  2557     cutoff   28      59509.7337 70221.2646  18.0%  2700 1838s
  9813  2636 61913.6128   23  287 59509.7337 70133.6045  17.9%  2689 1874s
 10149  2741 66371.5530   25  298 59509.7337 69514.7216  16.8%  2691 1911s
 10509  2868     cutoff   36      59509.7337 69511.1205  16.8%  2693 1950s
 10909  2943 60678.7222   25  250 59509.7337 69231.8286  16.3%  2688 1988s
 11283  3033 62233.2277   23  348 59509.7337 68803.9948  15.6%  2701 2030s
 11666  3070     cutoff   24      59509.7337 68480.4588  15.1%  2713 2070s
 12170  3109 60277.8701   25  274 59509.7337 68405.8445  14.9%  2700 2111s
 12639  3219 59740.3375   23  243 59509.7337 68336.6308  14.8%  2696 2156s
 13187  3323 60466.2461   30  205 59509.7337 67982.3762  14.2%  2681 2202s
 13676  3387     cutoff   23      59509.7337 67969.6607  14.2%  2681 2247s
 14006  3515 63360.4843   21  259 59509.7337 67810.4538  13.9%  2672 2295s
 14589  3639 62433.7310   23  274 59509.7337 67441.4884  13.3%  2663 2349s
 15218  3745     cutoff   25      59509.7337 67264.2965  13.0%  2652 2402s
 15875  3843 61109.4376   30  238 59509.7337 67180.9224  12.9%  2640 2459s
 16488  3947     cutoff   24      59509.7337 66770.1120  12.2%  2639 2520s
 17213  4117 61700.1493   23  204 59509.7337 66582.4632  11.9%  2625 2577s
 18117  4232 60365.2120   40  176 59509.7337 66521.0777  11.8%  2589 2634s
 18806  4322 61404.8257   25  389 59509.7337 66259.0305  11.3%  2588 2695s
 19652  4449 61402.1792   32  215 59509.7337 66058.1796  11.0%  2570 2755s
 20392  4586     cutoff   27      59509.7337 65855.0189  10.7%  2555 2819s
 21295  4752 61956.9244   38  143 59509.7337 65645.4747  10.3%  2530 2889s
 22331  4909 61647.2817   25  244 59509.7337 65394.5234  9.89%  2504 2958s
 23365  4925     cutoff   24      59509.7337 65231.0427  9.61%  2481 3018s
 23525  5118 61677.2883   26  251 59509.7337 65231.0427  9.61%  2482 3093s
 24504  5311 59657.3923   30  137 59509.7337 64895.5757  9.05%  2460 3166s
H25436  5088                    60000.981496 64800.2010  8.00%  2436 3166s
 25750  5063     cutoff   41      60000.9815 64662.8457  7.77%  2428 3242s
 26984  5064     cutoff   25      60000.9815 64429.9487  7.38%  2403 3318s
H26987  4426                    60616.641874 64429.9487  6.29%  2403 3318s
H27068  4251                    60752.458324 64429.9487  6.05%  2401 3318s
H27461  3957                    60997.880110 64391.5570  5.56%  2395 3318s
 28103  3467 61479.5918   29  304 60997.8801 64171.1746  5.20%  2384 3396s
 29537  2885 infeasible   33      60997.8801 63746.0390  4.51%  2352 3474s
 31361  1567     cutoff   38      60997.8801 63152.7613  3.53%  2294 3545s
 33703    39     cutoff   44      60997.8801 62376.1261  2.26%  2199 3569s
*34483    39              49    61052.395718 62278.5075  2.01%  2155 3569s

Cutting planes:
  Learned: 4
  MIR: 814
  Mixing: 1
  Flow cover: 1310
  RLT: 23
  Relax-and-lift: 157

Explored 35880 nodes (74807897 simplex iterations) in 3570.01 seconds (7532.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 61052.4 61052.4 60997.9 ... 59356.8

Optimal solution found (tolerance 1.00e-04)
Best objective 6.105239571839e+04, best bound 6.105239571839e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3570.03s
  Master Objective (UB) = 61052.40, θ = 229819.34
  Upper Bound (UB) = 61052.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229819.34
  [DEBUG]   ✓ Scenario 0: θ = 229819.34 ≤ Q = 235770.64 (slack: 5951.30)
  [DEBUG]   ✓ Scenario 1: θ = 229819.34 ≤ Q = 229819.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229819.34 ≤ Q = 229819.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229819.34 ≤ Q = 229874.64 (slack: 55.30)
  [DEBUG]   ✓ Scenario 4: θ = 229819.34 ≤ Q = 229819.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x55185a76
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x55185a76
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.466928e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.01s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7277989.5019
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.968904e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196890.39    0  129 7277989.50 -196890.39   103%     -    0s
H    0     0                    -160977.9470 -196890.39  22.3%     -    0s
H    0     0                    -161167.2480 -196890.39  22.2%     -    0s
     0     0 -176606.11    0   90 -161167.25 -176606.11  9.58%     -    0s
H    0     0                    -172679.4373 -176546.49  2.24%     -    0s
H    0     0                    -173956.3396 -176546.49  1.49%     -    0s
     0     0 -176272.79    0   85 -173956.34 -176272.79  1.33%     -    0s
     0     0 -175646.21    0   72 -173956.34 -175646.21  0.97%     -    0s
H    0     0                    -174413.6706 -175623.12  0.69%     -    0s
     0     0 -175528.57    0   58 -174413.67 -175528.57  0.64%     -    0s
H    0     0                    -174458.5082 -175460.28  0.57%     -    0s
     0     0 -175460.28    0   70 -174458.51 -175460.28  0.57%     -    0s
     0     0 -175406.15    0   64 -174458.51 -175406.15  0.54%     -    0s
     0     0 -175403.99    0   64 -174458.51 -175403.99  0.54%     -    0s
     0     2 -175401.97    0   64 -174458.51 -175401.97  0.54%     -    0s
H  113    70                    -174486.0097 -175109.26  0.36%   9.2    0s
H 1289   307                    -174491.0240 -174826.57  0.19%   5.3    0s

Cutting planes:
  Gomory: 25
  Implied bound: 7
  MIR: 164
  Flow cover: 11
  RLT: 34
  Relax-and-lift: 2

Explored 4256 nodes (21138 simplex iterations) in 0.31 seconds (0.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -174491 -174486 -174459 ... 1.46693e+13
No other solutions better than -174491

Optimal solution found (tolerance 1.00e-04)
Best objective -1.744910240446e+05, best bound -1.744910240446e+05, gap 0.0000%
  Subproblem solved in 0.35s
  Worst-case operational profit (Z_SP) = 218963.61
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -174491.02
  [DEBUG]   S×d_nominal = 393454.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 393454.64 + -174491.02 = 218963.61
  [DEBUG]   Current θ from Master = 229819.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10855.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 50196.67
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 7725.4485, Absolute Gap = 7725.4485, Relative Gap = 0.126538
  Not converged yet (gap = 7725.45 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0x7ddf0612
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 1.43s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -219107.7947

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23000   -8.5115444e+04   0.000000e+00   6.940120e+08      5s
   37420    2.9593062e+04   0.000000e+00   9.568664e+06     10s
   48019    4.1001117e+04   0.000000e+00   1.148557e+06     15s
Concurrent spin time: 1.23s

Solved with dual simplex

Root relaxation: objective 9.164678e+04, 35094 iterations, 18.34 seconds (25.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91646.7762    0   75 -219107.79 91646.7762   142%     -   20s
H    0     0                    -212852.2410 91646.7762   143%     -   20s
H    0     0                    -20468.36853 91646.7762   548%     -   20s
H    0     0                    -13614.08566 91646.7762   773%     -   20s
H    0     0                    7570.7576401 91646.7762  1111%     -   20s
H    0     0                    39515.564546 91646.7762   132%     -   20s
H    0     0                    40524.223109 91646.7762   126%     -   21s
H    0     0                    42316.723352 91646.7762   117%     -   21s
H    0     0                    47687.461484 91646.7762  92.2%     -   21s
H    0     0                    47940.948126 91646.7762  91.2%     -   21s
     0     0 86712.0655    0  184 47940.9481 86712.0655  80.9%     -   30s
H    0     0                    48293.471083 86711.9075  79.6%     -   31s
H    0     0                    48551.086417 86711.9075  78.6%     -   31s
H    0     0                    48631.678523 86711.9075  78.3%     -   31s
     0     0 86370.3195    0  187 48631.6785 86370.3195  77.6%     -   33s
     0     0 86358.4219    0  189 48631.6785 86358.4219  77.6%     -   34s
     0     0 86348.7944    0  186 48631.6785 86348.7944  77.6%     -   34s
     0     0 83436.8320    0  274 48631.6785 83436.8320  71.6%     -   44s
H    0     0                    48744.155304 83436.7693  71.2%     -   44s
     0     0 83031.5484    0  276 48744.1553 83031.5484  70.3%     -   50s
H    0     0                    48748.861981 82964.5676  70.2%     -   52s
H    0     0                    48799.151566 82964.5676  70.0%     -   52s
H    0     0                    48847.808455 82964.5676  69.8%     -   52s
     0     0 82964.5676    0  280 48847.8085 82964.5676  69.8%     -   52s
     0     0 82939.8762    0  287 48847.8085 82939.8762  69.8%     -   54s
     0     0 82934.5148    0  280 48847.8085 82934.5148  69.8%     -   54s
     0     0 82928.9555    0  278 48847.8085 82928.9555  69.8%     -   54s
     0     0 82928.9555    0  278 48847.8085 82928.9555  69.8%     -   55s
     0     0 80756.0476    0  317 48847.8085 80756.0476  65.3%     -   76s
H    0     0                    48865.752881 80755.8584  65.3%     -   76s
H    0     0                    48876.914495 80299.1814  64.3%     -   83s
     0     0 80299.1814    0  338 48876.9145 80299.1814  64.3%     -   83s
     0     0 80093.7768    0  363 48876.9145 80093.7768  63.9%     -   88s
     0     0 80032.8308    0  365 48876.9145 80032.8308  63.7%     -   91s
H    0     0                    50097.245752 79997.6090  59.7%     -   93s
H    0     0                    50122.797749 79997.6090  59.6%     -   93s
     0     0 79997.6090    0  368 50122.7977 79997.6090  59.6%     -   93s
     0     0 79990.3894    0  375 50122.7977 79990.3894  59.6%     -   94s
     0     0 79980.3596    0  373 50122.7977 79980.3596  59.6%     -   95s
     0     0 79974.5945    0  370 50122.7977 79974.5945  59.6%     -   95s
     0     0 79972.6652    0  369 50122.7977 79972.6652  59.6%     -   95s
     0     0 79972.0058    0  371 50122.7977 79972.0058  59.6%     -   96s
H    0     0                    51970.111996 79972.0058  53.9%     -  101s
H    0     0                    52159.328726 79972.0058  53.3%     -  101s
H    0     0                    52159.714960 79972.0058  53.3%     -  101s
H    0     0                    52241.885665 79972.0058  53.1%     -  101s
H    0     0                    52303.440843 79972.0058  52.9%     -  101s
H    0     0                    52327.964477 79972.0058  52.8%     -  101s
H    0     0                    52392.311269 79972.0058  52.6%     -  101s
H    0     0                    52412.421054 79972.0058  52.6%     -  101s
     0     0 79242.1949    0  383 52412.4211 79242.1949  51.2%     -  108s
H    0     0                    52482.912776 79241.1766  51.0%     -  109s
H    0     0                    52516.124731 79014.7971  50.5%     -  114s
H    0     0                    52901.352585 79014.7971  49.4%     -  114s
H    0     0                    53470.984195 79014.7971  47.8%     -  114s
H    0     0                    53524.534900 79014.7971  47.6%     -  114s
     0     0 79014.7971    0  372 53524.5349 79014.7971  47.6%     -  114s
     0     0 78949.0626    0  386 53524.5349 78949.0626  47.5%     -  116s
     0     0 78934.8629    0  387 53524.5349 78934.8629  47.5%     -  117s
     0     0 78925.2291    0  387 53524.5349 78925.2291  47.5%     -  118s
     0     0 78904.0034    0  396 53524.5349 78904.0034  47.4%     -  119s
     0     0 78901.1041    0  395 53524.5349 78901.1041  47.4%     -  120s
     0     0 78899.4535    0  394 53524.5349 78899.4535  47.4%     -  120s
     0     0 78898.9228    0  399 53524.5349 78898.9228  47.4%     -  120s
     0     0 78742.7561    0  387 53524.5349 78742.7561  47.1%     -  124s
     0     0 78669.0333    0  427 53524.5349 78669.0333  47.0%     -  127s
     0     0 78654.2756    0  430 53524.5349 78654.2756  46.9%     -  128s
     0     0 78648.8851    0  426 53524.5349 78648.8851  46.9%     -  129s
     0     0 78647.3133    0  434 53524.5349 78647.3133  46.9%     -  129s
     0     0 78645.3226    0  432 53524.5349 78645.3226  46.9%     -  129s
     0     0 78644.5849    0  440 53524.5349 78644.5849  46.9%     -  129s
     0     0 78604.8770    0  393 53524.5349 78604.8770  46.9%     -  132s
H    0     0                    53595.830214 78596.1609  46.6%     -  134s
H    0     0                    53629.145464 78596.1609  46.6%     -  134s
     0     0 78596.1609    0  392 53629.1455 78596.1609  46.6%     -  134s
     0     0 78590.9760    0  434 53629.1455 78590.9760  46.5%     -  135s
     0     0 78590.3204    0  446 53629.1455 78590.3204  46.5%     -  135s
     0     0 78586.0928    0  395 53629.1455 78586.0928  46.5%     -  137s
     0     0 78580.7819    0  412 53629.1455 78580.7819  46.5%     -  138s
     0     0 78572.7366    0  450 53629.1455 78572.7366  46.5%     -  139s
     0     0 78571.2598    0  448 53629.1455 78571.2598  46.5%     -  140s
     0     0 78554.3741    0  444 53629.1455 78554.3741  46.5%     -  142s
     0     0 78548.1407    0  413 53629.1455 78548.1407  46.5%     -  143s
     0     0 78546.6972    0  411 53629.1455 78546.6972  46.5%     -  144s
     0     0 78537.6817    0  402 53629.1455 78537.6817  46.4%     -  146s
     0     0 78535.9911    0  402 53629.1455 78535.9911  46.4%     -  146s
     0     0 78535.7440    0  399 53629.1455 78535.7440  46.4%     -  147s
     0     0 78535.3420    0  398 53629.1455 78535.3420  46.4%     -  148s
H    0     0                    53723.498085 78535.3254  46.2%     -  150s
     0     0 78534.8393    0  402 53723.4981 78534.8393  46.2%     -  150s
     0     0 78534.6060    0  404 53723.4981 78534.6060  46.2%     -  151s
     0     0 78534.4062    0  400 53723.4981 78534.4062  46.2%     -  152s
     0     0 78534.3279    0  407 53723.4981 78534.3279  46.2%     -  153s
     0     0 78534.1746    0  407 53723.4981 78534.1746  46.2%     -  154s
H    0     0                    53893.216957 78534.0784  45.7%     -  176s
H    0     0                    54146.411640 78534.0784  45.0%     -  176s
H    0     0                    54157.834254 78534.0784  45.0%     -  177s
H    0     0                    54186.200271 78534.0784  44.9%     -  178s
     0     2 78534.0784    0  407 54186.2003 78534.0784  44.9%     -  178s
     1     4 78497.6511    1  393 54186.2003 78533.9164  44.9%  3427  181s
     3     8 78400.7025    2  457 54186.2003 78497.6087  44.9%  3460  190s
     7    16 78211.9914    3  458 54186.2003 78399.8974  44.7%  5980  200s
    15    32 77697.1459    4  470 54186.2003 78207.4900  44.3%  6657  210s
    31    51 76148.6058    5  374 54186.2003 77696.7054  43.4%  9044  232s
H   50    83                    54189.879540 77696.7054  43.4%  8532  244s
H   53    83                    55533.519885 77696.7054  39.9%  8370  244s
H   72    83                    55637.254137 77696.7054  39.6%  7097  244s
    82   163 76880.0258    7  427 55637.2541 77696.7054  39.6%  6484  261s
H  162   276                    55844.582425 77696.7054  39.1%  4316  273s
H  172   276                    55993.511148 77696.7054  38.8%  4215  273s
H  203   276                    56122.949122 77696.7054  38.4%  4035  273s
H  261   276                    56430.838142 77696.7054  37.7%  3655  273s
   275   337 76112.9958    9  336 56430.8381 77696.7054  37.7%  3596  284s
   336   394 76704.6544    9  415 56430.8381 77696.7054  37.7%  3558  296s
H  338   394                    57155.768536 77696.7054  35.9%  3551  296s
   393   463 76482.0048   10  410 57155.7685 77696.7054  35.9%  3607  305s
   462   553 76562.2409   10  410 57155.7685 77696.7054  35.9%  3465  315s
H  532   553                    57186.835053 77696.7054  35.9%  3292  315s
H  549   553                    57214.123623 77696.7054  35.8%  3230  315s
   552   634 76385.9346   11  397 57214.1236 77696.7054  35.8%  3230  322s
   633   666 76319.1767   12  390 57214.1236 77696.7054  35.8%  3059  330s
   665   705 76227.9648   13  393 57214.1236 77696.7054  35.8%  3020  338s
   704   737 76004.5295   13  317 57214.1236 77696.7054  35.8%  3005  345s
   736   769 76181.2012   11  403 57214.1236 77696.7054  35.8%  2980  352s
H  751   769                    57380.275080 77696.7054  35.4%  2975  352s
   768   862 76278.5001   13  389 57380.2751 77696.7054  35.4%  2951  359s
   861   958 76093.9234   13  284 57380.2751 77696.7054  35.4%  2804  366s
   957   990 76071.3244   15  374 57380.2751 77696.7054  35.4%  2678  374s
   989  1032 75849.3649   15  275 57380.2751 77696.7054  35.4%  2643  388s
  1031  1078 75851.1261   14  378 57380.2751 77696.7054  35.4%  2605  396s
  1077  1126 75811.6147   14  324 57380.2751 77696.7054  35.4%  2541  401s
H 1095  1126                    57642.246415 77696.7054  34.8%  2521  401s
  1125  1272 76070.4758   15  383 57642.2464 77696.7054  34.8%  2484  410s
  1271  1434 75791.2517   16  362 57642.2464 77696.7054  34.8%  2338  418s
  1433  1629 76022.4826   17  313 57642.2464 77696.7054  34.8%  2190  426s
  1628  1865 75327.5650   16  242 57642.2464 77696.7054  34.8%  2025  432s
  1876  2049 75658.5589   17  257 57642.2464 77696.7054  34.8%  1838  442s
  2098  2078 75886.7235   18  346 57642.2464 77696.7054  34.8%  1723  454s
  2131  2104 74427.1535   17  305 57642.2464 77696.7054  34.8%  1723  463s
H 2137  2104                    57668.858113 77696.7054  34.7%  1720  463s
  2175  2273 75615.2362   18  376 57668.8581 77696.7054  34.7%  1728  475s
  2391  2291 73928.4173   18  308 57668.8581 77549.9630  34.5%  1660  488s
  2433  2331 75589.2179   18  358 57668.8581 77549.9630  34.5%  1688  501s
H 2443  2331                    57811.500021 77549.9630  34.1%  1690  501s
H 2470  2331                    58024.339554 77549.9630  33.7%  1695  501s
  2483  2441 75580.3577   19  351 58024.3396 77549.9630  33.7%  1703  514s
  2671  2512 72027.4725   19  318 58024.3396 77549.9630  33.7%  1660  530s
  2784  2569 75429.8283   19  369 58024.3396 77549.9630  33.7%  1682  546s
  2865  2636 75416.5305   20  309 58024.3396 77549.9630  33.7%  1725  565s
  2934  2732 71752.5421   20  292 58024.3396 77549.9630  33.7%  1759  580s
  3030  2859 61867.7193   54  176 58024.3396 77549.9630  33.7%  1773  597s
  3165  3038 70429.4917   21  306 58024.3396 77549.9630  33.7%  1769  614s
H 3368  3038                    58036.269320 77549.9630  33.6%  1729  621s
  3369  3039 74410.3013   26  407 58036.2693 77549.9630  33.6%  1729  658s
  3371  3040 65497.8446   90   75 58036.2693 77549.9630  33.6%  1728  698s
  3372  3041 66955.9892   48  262 58036.2693 77549.9630  33.6%  1727  720s
  3373  3042 64820.6348   55  319 58036.2693 77549.9630  33.6%  1727  733s
  3374  3042 72757.7527   23  402 58036.2693 77549.9630  33.6%  1726  742s
  3375  3043 69681.6294   44  424 58036.2693 77549.9630  33.6%  1726  749s
  3376  3044 70806.9278   55  451 58036.2693 77549.9630  33.6%  1725  755s
  3378  3045 69742.7219   53  336 58036.2693 77549.9630  33.6%  1724  760s
  3382  3048 66133.2606   58  445 58036.2693 77549.9630  33.6%  1722  766s
  3383  3048 70092.5498   44  468 58036.2693 77549.9630  33.6%  1722  772s
  3385  3050 61229.8837   92  376 58036.2693 77549.9630  33.6%  1721  776s
  3388  3052 59556.6249   80  416 58036.2693 77549.9630  33.6%  1719  782s
  3390  3053 68292.3623   32  418 58036.2693 77549.9630  33.6%  1718  785s
  3392  3054 64171.6378   72  471 58036.2693 77549.9630  33.6%  1717  790s
  3394  3056 75751.1469    7  351 58036.2693 77549.9630  33.6%  1716  795s
  3397  3058 65145.9463   14  355 58036.2693 77549.9630  33.6%  1715  801s
  3399  3059 71437.6722   38  363 58036.2693 77549.9630  33.6%  1714  807s
  3401  3060 76169.4850   11  358 58036.2693 77549.9630  33.6%  1713  810s
  3403  3062 65551.5958   89  357 58036.2693 77549.9630  33.6%  1711  816s
  3405  3063 68425.9358   43  357 58036.2693 77549.9630  33.6%  1710  857s
  3406  3064 69446.3410   46  357 58036.2693 77549.9630  33.6%  1710  879s
  3407  3067 77549.9630   16  430 58036.2693 77549.9630  33.6%  1759  921s
  3409  3071 77549.9630   17  426 58036.2693 77549.9630  33.6%  1762  940s
  3413  3077 77404.2696   18  446 58036.2693 77549.9630  33.6%  1773  958s
  3421  3091 77233.5773   19  436 58036.2693 77401.5865  33.4%  1790  974s
  3437  3113 75659.3374   20  329 58036.2693 77233.2910  33.1%  1846 1009s
  3465  3136 74877.0499   21  327 58036.2693 77233.2422  33.1%  1949 1029s
  3497  3184 70237.3720   22  285 58036.2693 77233.2422  33.1%  2010 1054s
  3556  3196 69142.1302   23  254 58036.2693 77233.2422  33.1%  2171 1075s
  3589  3223 65434.1781   24  287 58036.2693 77233.2422  33.1%  2217 1096s
  3633  3244 69075.3222   24  242 58036.2693 77233.2422  33.1%  2271 1118s
  3683  3263 66080.3657   24  254 58036.2693 77233.2422  33.1%  2315 1135s
  3723  3306 58953.9705   26  236 58036.2693 76675.9614  32.1%  2340 1155s
  3792  3331 63769.8816   26  208 58036.2693 76675.9614  32.1%  2372 1181s
  3868  3347 63257.7351   26  299 58036.2693 76675.9614  32.1%  2403 1202s
  3939  3367 61652.3933   25  274 58036.2693 76675.9614  32.1%  2449 1221s
  4002  3358 63120.0305   28  237 58036.2693 76675.9614  32.1%  2484 1242s
  4047  3372 60870.2899   29  224 58036.2693 76675.9614  32.1%  2509 1266s
  4091  3378 62499.0194   28  269 58036.2693 76675.9614  32.1%  2541 1284s
  4139  3383 62061.2094   29  257 58036.2693 76675.9614  32.1%  2578 1302s
  4192  3397     cutoff   29      58036.2693 75655.5748  30.4%  2613 1321s
  4245  3403     cutoff   31      58036.2693 75655.5748  30.4%  2643 1339s
  4303  3415     cutoff   29      58036.2693 75655.5748  30.4%  2677 1360s
  4374  3409 58312.6644   34  277 58036.2693 75655.5748  30.4%  2709 1380s
  4454  3415 69235.5448   22  291 58036.2693 75655.5748  30.4%  2735 1400s
  4525  3439 69072.9243   23  326 58036.2693 74815.4642  28.9%  2765 1421s
  4610  3434 67740.5661   25  298 58036.2693 74815.4642  28.9%  2791 1440s
H 4637  3271                    58254.327920 74815.4642  28.4%  2792 1440s
  4671  3296 61680.4941   26  277 58254.3279 74815.4642  28.4%  2799 1466s
  4783  3314 59733.8974   28  235 58254.3279 74815.4642  28.4%  2817 1490s
  4888  3319     cutoff   31      58254.3279 74815.4642  28.4%  2842 1518s
  5018  3341 65423.7254   25  301 58254.3279 74057.1383  27.1%  2847 1549s
  5146  3366 62586.6893   28  302 58254.3279 74057.1383  27.1%  2858 1577s
  5286  3388 59887.0391   30  260 58254.3279 74057.1383  27.1%  2868 1604s
  5453  3401 61473.7925   42  126 58254.3279 73966.9226  27.0%  2861 1629s
  5635  3395     cutoff   51      58254.3279 73966.9226  27.0%  2850 1658s
  5769  3370 68422.8603   22  285 58254.3279 72670.3915  24.7%  2874 1681s
H 5803  3213                    58539.441869 72670.3915  24.1%  2883 1681s
  5815  3277 68017.0559   23  234 58539.4419 72670.3915  24.1%  2888 1711s
  5963  3259 65661.1358   25  192 58539.4419 72436.7245  23.7%  2901 1751s
  6135  3260 63469.7722   29  220 58539.4419 72416.2255  23.7%  2918 1786s
  6276  3290 60275.0353   33  187 58539.4419 72416.2255  23.7%  2948 1818s
  6453  3296 65963.3520   28  353 58539.4419 72416.2255  23.7%  2957 1842s
H 6458  3155                    58590.813982 72416.2255  23.6%  2959 1842s
H 6460  3023                    59007.026260 72416.2255  22.7%  2959 1842s
H 6525  2876                    59728.931420 72416.2255  21.2%  2948 1842s
  6552  2912 63831.0514   29  298 59728.9314 72416.2255  21.2%  2942 1875s
  6731  2914 60904.3750   33  207 59728.9314 72416.2255  21.2%  2965 1916s
  6937  2882 69545.0334   24  329 59728.9314 72416.2255  21.2%  2977 1955s
  7124  2880 64260.8494   28  196 59728.9314 71688.7414  20.0%  3003 1999s
  7323  2812 59835.6660   36  124 59728.9314 71688.7414  20.0%  3026 2040s
  7540  2702     cutoff   26      59728.9314 71380.2154  19.5%  3043 2082s
  7764  2687 66461.1244   35  299 59728.9314 71174.1947  19.2%  3056 2120s
H 7774  2565                    59790.256036 71174.1947  19.0%  3059 2120s
H 7788  2447                    59829.375457 71174.1947  19.0%  3061 2120s
  7895  2429 60984.7909   37  182 59829.3755 71174.1947  19.0%  3081 2167s
  8147  2334 65212.3999   33  316 59829.3755 71174.1947  19.0%  3098 2214s
  8450  2234 60402.6137   38  286 59829.3755 70073.5396  17.1%  3100 2260s
  8755  2181     cutoff   39      59829.3755 69929.5601  16.9%  3108 2307s
H 8761  2061                    59911.684113 69929.5601  16.7%  3106 2307s
H 8785  1947                    59962.260351 69838.2629  16.5%  3107 2307s
  8976  1925 61309.8241   31  218 59962.2604 69522.5809  15.9%  3116 2354s
  9172  1887 62221.1436   24  254 59962.2604 69485.9516  15.9%  3122 2410s
  9592  1956     cutoff   28      59962.2604 69399.7159  15.7%  3107 2468s
  9935  2045 61413.9503   23  263 59962.2604 68751.9906  14.7%  3122 2530s
 10292  2066 60221.0030   28  283 59962.2604 68617.5863  14.4%  3132 2589s
 10616  2116 61108.5009   31  264 59962.2604 68227.3092  13.8%  3155 2650s
 10965  2168 60914.7514   26  264 59962.2604 68060.1991  13.5%  3174 2715s
 11332  2249     cutoff   30      59962.2604 67808.5360  13.1%  3181 2781s
 11797  2269 62042.0240   29  233 59962.2604 67456.2395  12.5%  3178 2846s
 12135  2320 62396.0216   28  304 59962.2604 67197.5930  12.1%  3193 2911s
 12597  2361     cutoff   31      59962.2604 67077.9311  11.9%  3189 2980s
H12757  2279                    60352.266025 66706.9404  10.5%  3186 2980s
 12994  2269 60463.7288   36  157 60352.2660 66646.3695  10.4%  3178 3066s
 13510  2261     cutoff   29      60352.2660 66301.0225  9.86%  3181 3146s
 14012  2252 61655.5306   28  309 60352.2660 66057.2623  9.45%  3192 3210s
 14089  2224 61581.1318   29  259 60352.2660 66057.2623  9.45%  3196 3284s
 14405  2225     cutoff   33      60352.2660 65888.4152  9.17%  3194 3371s
 14927  2166     cutoff   28      60352.2660 65610.7404  8.71%  3202 3460s
 15554  2147     cutoff   27      60352.2660 65292.3932  8.19%  3204 3545s
 16121  2039     cutoff   28      60352.2660 65066.9737  7.81%  3204 3600s

Cutting planes:
  Learned: 2
  MIR: 699
  Mixing: 3
  Flow cover: 1283
  RLT: 29
  Relax-and-lift: 111

Explored 16561 nodes (53048613 simplex iterations) in 3600.03 seconds (7003.78 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 60352.3 59962.3 59911.7 ... 58254.3

Time limit reached
Best objective 6.035226602517e+04, best bound 6.482070757266e+04, gap 7.4039%
  WARNING: Time limit reached. Using best solution found (gap: 7.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 60352.27, θ = 228815.24
  Upper Bound (UB) = 60352.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228815.24
  [DEBUG]   ✓ Scenario 0: θ = 228815.24 ≤ Q = 228815.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228815.24 ≤ Q = 228815.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228815.24 ≤ Q = 228815.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228815.24 ≤ Q = 228815.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228815.24 ≤ Q = 228815.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228815.24 ≤ Q = 228815.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1a4a83de
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe5b57c22
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-15, 2e+02]
Found heuristic solution: objective 1.465662e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.01s
Presolved: 537 rows, 542 columns, 1515 nonzeros
Found heuristic solution: objective 7257573.1062
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.964036e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196403.62    0  125 7257573.11 -196403.62   103%     -    0s
H    0     0                    -160648.1482 -196403.62  22.3%     -    0s
H    0     0                    -160837.4492 -196403.62  22.1%     -    0s
     0     0 -174484.89    0  112 -160837.45 -174484.89  8.49%     -    0s
H    0     0                    -164079.0010 -174340.18  6.25%     -    0s
H    0     0                    -169435.2531 -174340.18  2.89%     -    0s
H    0     0                    -171442.8723 -174340.18  1.69%     -    0s
     0     0 -173818.70    0   96 -171442.87 -173818.70  1.39%     -    0s
H    0     0                    -171572.1872 -173770.97  1.28%     -    0s
     0     0 -173770.97    0   96 -171572.19 -173770.97  1.28%     -    0s
     0     0 -173294.00    0   99 -171572.19 -173294.00  1.00%     -    0s
H    0     0                    -171648.0501 -173284.38  0.95%     -    0s
H    0     0                    -171674.6047 -173284.38  0.94%     -    0s
     0     0 -173284.38    0   99 -171674.60 -173284.38  0.94%     -    0s
H    0     0                    -172058.0005 -173284.38  0.71%     -    0s
H    0     0                    -172093.0981 -173284.38  0.69%     -    0s
     0     0 -173166.68    0  103 -172093.10 -173166.68  0.62%     -    0s
     0     0 -173162.81    0  103 -172093.10 -173162.81  0.62%     -    0s
     0     2 -173162.81    0  103 -172093.10 -173162.81  0.62%     -    0s
H  205   200                    -172096.2219 -172672.62  0.33%  11.0    0s

Cutting planes:
  Gomory: 53
  Implied bound: 2
  MIR: 200
  Flow cover: 4
  RLT: 8
  BQP: 1

Explored 9139 nodes (52701 simplex iterations) in 0.97 seconds (0.36 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -172096 -172093 -171675 ... 1.46566e+13
No other solutions better than -172096

Optimal solution found (tolerance 1.00e-04)
Best objective -1.720962219265e+05, best bound -1.720962219265e+05, gap 0.0000%
  Subproblem solved in 1.01s
  Worst-case operational profit (Z_SP) = 220338.91
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -172096.22
  [DEBUG]   S×d_nominal = 392435.13
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 392435.13 + -172096.22 = 220338.91
  [DEBUG]   Current θ from Master = 228815.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8476.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 51875.93
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 7025.3188, Absolute Gap = 7025.3188, Relative Gap = 0.116405
  Not converged yet (gap = 7025.32 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0x6609ae1c
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 1.86s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -219107.7947

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28334   -8.5689341e+04   0.000000e+00   1.029210e+09      5s
   40939    6.7118448e+03   0.000000e+00   1.074918e+07     10s
   52285    3.5775583e+04   0.000000e+00   2.789483e+06     15s
   61689    4.8303752e+04   0.000000e+00   5.750698e+06     20s
   71706    5.4661889e+04   0.000000e+00   3.264605e+07     25s
   81408    6.4992161e+04   0.000000e+00   1.077280e+07     30s
   89170    7.1016490e+04   0.000000e+00   8.208847e+05     35s
   96397    7.6737091e+04   0.000000e+00   1.238313e+08     40s
Concurrent spin time: 1.87s

Solved with dual simplex

Root relaxation: objective 9.115322e+04, 58885 iterations, 40.31 seconds (57.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 91153.2240    0   84 -219107.79 91153.2240   142%     -   42s
H    0     0                    -211603.3006 91153.2240   143%     -   42s
H    0     0                    -173824.0042 91153.2240   152%     -   43s
H    0     0                    -171416.3949 91153.2240   153%     -   43s
H    0     0                    -170973.9846 91153.2240   153%     -   43s
H    0     0                    -148203.5226 91153.2240   162%     -   43s
H    0     0                    -147931.6924 91153.2240   162%     -   43s
H    0     0                    -38673.85655 91153.2240   336%     -   43s
H    0     0                    -38612.51904 91153.2240   336%     -   43s
H    0     0                    -1076.942505 91153.2240  8564%     -   43s
H    0     0                    9699.5699200 91153.2240   840%     -   43s
H    0     0                    37995.303286 91153.2240   140%     -   43s
H    0     0                    41076.041235 91153.2240   122%     -   44s
H    0     0                    43241.142862 91153.2240   111%     -   44s
H    0     0                    43806.061385 91153.2240   108%     -   44s
H    0     0                    44619.169823 91148.6699   104%     -   45s
H    0     0                    44641.700295 91148.6699   104%     -   45s
H    0     0                    44650.275035 91148.6699   104%     -   45s
H    0     0                    44664.841063 91148.6699   104%     -   45s
H    0     0                    46312.724429 85603.9762  84.8%     -   60s
     0     0 85603.9762    0  205 46312.7244 85603.9762  84.8%     -   60s
H    0     0                    49635.886025 85603.5063  72.5%     -   61s
     0     0 85058.4313    0  202 49635.8860 85058.4313  71.4%     -   70s
     0     0 85058.4313    0  193 49635.8860 85058.4313  71.4%     -   71s
     0     0 85058.4313    0  198 49635.8860 85058.4313  71.4%     -   71s
H    0     0                    49741.093994 82177.5284  65.2%     -   86s
H    0     0                    50541.405981 82177.5284  62.6%     -   86s
H    0     0                    50549.288571 82177.5284  62.6%     -   86s
H    0     0                    50694.277815 82177.5284  62.1%     -   86s
H    0     0                    50698.143740 82177.5284  62.1%     -   86s
     0     0 82177.5284    0  238 50698.1437 82177.5284  62.1%     -   86s
H    0     0                    50825.632954 82177.5079  61.7%     -   87s
H    0     0                    51736.889728 82177.5079  58.8%     -   87s
H    0     0                    51890.927216 82177.5079  58.4%     -   87s
H    0     0                    51898.758842 82177.5079  58.3%     -   87s
H    0     0                    51944.781997 82177.5079  58.2%     -   87s
H    0     0                    51995.394655 82177.5079  58.0%     -   87s
H    0     0                    52057.072455 82177.5079  57.9%     -   87s
H    0     0                    52264.113972 82177.5079  57.2%     -   87s
H    0     0                    52275.337988 82177.5079  57.2%     -   87s
     0     0 81687.7792    0  252 52275.3380 81687.7792  56.3%     -   96s
     0     0 81501.8203    0  290 52275.3380 81501.8203  55.9%     -  102s
     0     0 81422.2602    0  308 52275.3380 81422.2602  55.8%     -  107s
     0     0 81380.5034    0  293 52275.3380 81380.5034  55.7%     -  110s
     0     0 81376.1923    0  297 52275.3380 81376.1923  55.7%     -  111s
     0     0 81374.7774    0  293 52275.3380 81374.7774  55.7%     -  111s
     0     0 81373.3582    0  291 52275.3380 81373.3582  55.7%     -  112s
     0     0 81358.1160    0  289 52275.3380 81358.1160  55.6%     -  114s
     0     0 81354.1840    0  295 52275.3380 81354.1840  55.6%     -  114s
     0     0 81353.1592    0  293 52275.3380 81353.1592  55.6%     -  115s
     0     0 81351.8225    0  293 52275.3380 81351.8225  55.6%     -  115s
     0     0 81351.7841    0  293 52275.3380 81351.7841  55.6%     -  115s
     0     0 79968.2950    0  370 52275.3380 79968.2950  53.0%     -  141s
H    0     0                    52393.175186 79966.9218  52.6%     -  142s
H    0     0                    52510.404544 79966.9218  52.3%     -  142s
     0     0 79512.5006    0  410 52510.4045 79512.5006  51.4%     -  151s
     0     0 79325.9199    0  416 52510.4045 79325.9199  51.1%     -  159s
H    0     0                    53275.444767 79261.3101  48.8%     -  163s
H    0     0                    54994.540951 79261.3101  44.1%     -  163s
     0     0 79261.3101    0  425 54994.5410 79261.3101  44.1%     -  163s
     0     0 79231.0363    0  434 54994.5410 79231.0363  44.1%     -  166s
     0     0 79199.2551    0  426 54994.5410 79199.2551  44.0%     -  168s
     0     0 79191.7437    0  429 54994.5410 79191.7437  44.0%     -  169s
     0     0 79188.2069    0  435 54994.5410 79188.2069  44.0%     -  170s
     0     0 79187.0855    0  435 54994.5410 79187.0855  44.0%     -  170s
     0     0 78848.2085    0  391 54994.5410 78848.2085  43.4%     -  183s
H    0     0                    55003.578439 78848.1950  43.4%     -  184s
H    0     0                    55109.013960 78848.1950  43.1%     -  184s
H    0     0                    55741.441895 78848.1950  41.5%     -  184s
     0     0 78643.4447    0  417 55741.4419 78643.4447  41.1%     -  190s
     0     0 78549.6234    0  388 55741.4419 78549.6234  40.9%     -  194s
     0     0 78527.2234    0  396 55741.4419 78527.2234  40.9%     -  196s
     0     0 78512.9527    0  403 55741.4419 78512.9527  40.9%     -  197s
     0     0 78509.3860    0  403 55741.4419 78509.3860  40.8%     -  198s
     0     0 78508.1105    0  402 55741.4419 78508.1105  40.8%     -  199s
     0     0 78409.0427    0  401 55741.4419 78409.0427  40.7%     -  205s
H    0     0                    55874.872370 78408.6536  40.3%     -  205s
     0     0 78385.8215    0  345 55874.8724 78385.8215  40.3%     -  206s
     0     0 78352.8287    0  352 55874.8724 78352.8287  40.2%     -  208s
     0     0 78338.6142    0  357 55874.8724 78338.6142  40.2%     -  209s
     0     0 78331.1349    0  360 55874.8724 78331.1349  40.2%     -  211s
     0     0 78324.2029    0  357 55874.8724 78324.2029  40.2%     -  212s
     0     0 78322.7301    0  360 55874.8724 78322.7301  40.2%     -  212s
     0     0 78321.8171    0  358 55874.8724 78321.8171  40.2%     -  213s
     0     0 78288.2558    0  442 55874.8724 78288.2558  40.1%     -  217s
     0     0 78271.6799    0  405 55874.8724 78271.6799  40.1%     -  219s
     0     0 78267.6105    0  415 55874.8724 78267.6105  40.1%     -  220s
     0     0 78261.8041    0  398 55874.8724 78261.8041  40.1%     -  221s
     0     0 78260.9722    0  399 55874.8724 78260.9722  40.1%     -  221s
     0     0 78191.5442    0  485 55874.8724 78191.5442  39.9%     -  227s
     0     0 78163.1545    0  362 55874.8724 78163.1545  39.9%     -  231s
     0     0 78156.6015    0  459 55874.8724 78156.6015  39.9%     -  232s
     0     0 78154.0294    0  489 55874.8724 78154.0294  39.9%     -  233s
     0     0 78151.0366    0  454 55874.8724 78151.0366  39.9%     -  233s
     0     0 78150.4713    0  489 55874.8724 78150.4713  39.9%     -  234s
     0     0 78145.1933    0  362 55874.8724 78145.1933  39.9%     -  236s
     0     0 78144.4220    0  359 55874.8724 78144.4220  39.9%     -  237s
     0     0 78142.9483    0  489 55874.8724 78142.9483  39.9%     -  238s
     0     0 78142.2961    0  491 55874.8724 78142.2961  39.9%     -  239s
     0     0 78140.3834    0  493 55874.8724 78140.3834  39.8%     -  241s
     0     0 78140.0296    0  491 55874.8724 78140.0296  39.8%     -  242s
     0     0 78140.0296    0  491 55874.8724 78140.0296  39.8%     -  244s
     0     0 78139.7959    0  491 55874.8724 78139.7959  39.8%     -  245s
H    0     0                    55963.215270 78139.7834  39.6%     -  283s
H    0     0                    56039.141486 78139.7834  39.4%     -  289s
     0     2 78139.7834    0  491 56039.1415 78139.7834  39.4%     -  292s
     1     4 78078.4255    1  468 56039.1415 78139.7831  39.4%  2543  298s
     3     7 77960.5603    2  425 56039.1415 78078.3352  39.3%  4347  312s
     6    14 77792.1896    3  444 56039.1415 77982.4112  39.2%  6010  328s
    13    28 77284.4675    4  444 56039.1415 77791.7178  38.8%  7407  344s
    27    42 74960.7049    5  444 56039.1415 77509.8228  38.3% 10290  378s
H   41    74                    56130.073403 77509.8228  38.1% 10183  423s
H   42    74                    56196.516376 77509.8228  37.9% 10008  423s
H   43    74                    56398.394334 77509.8228  37.4%  9889  423s
H   53    74                    56472.204487 77509.8228  37.3%  9244  423s
    73   169 75176.4086    7  397 56472.2045 77245.5647  36.8%  8715  454s
   168   279 74915.6410   10  407 56472.2045 77245.2148  36.8%  5763  473s
   278   362 74606.1934   15  389 56472.2045 77245.2148  36.8%  4374  489s
   361   394 74081.0917   17  381 56472.2045 77245.2148  36.8%  3936  498s
   393   428 74047.6242   18  384 56472.2045 77245.2148  36.8%  3851  511s
H  414   428                    56532.646555 77245.2148  36.6%  3787  511s
H  422   428                    56729.237037 77245.2148  36.2%  3755  511s
H  426   428                    56754.714849 77245.2148  36.1%  3750  511s
   427   459 73994.4134   19  355 56754.7148 77245.2148  36.1%  3752  523s
   458   492 72685.0681   20  345 56754.7148 77245.2148  36.1%  3675  537s
H  472   492                    56902.894661 77245.2148  35.7%  3626  537s
   491   577 72607.1200   21  336 56902.8947 77245.2148  35.7%  3612  547s
H  576   607                    56959.155976 77245.2148  35.6%  3449  560s
   606   686 72217.0990   26  288 56959.1560 77245.2148  35.6%  3419  572s
   685   761 71254.5376   30  290 56959.1560 77245.2148  35.6%  3370  583s
   760   831 71138.8527   32  327 56959.1560 77245.2148  35.6%  3370  597s
   830   892 71089.3900   34  317 56959.1560 77245.2148  35.6%  3349  609s
   891   970 69747.0909   36  304 56959.1560 77245.2148  35.6%  3467  623s
   969  1067 69113.3168   40  262 56959.1560 77245.2148  35.6%  3396  637s
  1066  1099 68231.6066   43  203 56959.1560 77245.2148  35.6%  3249  648s
  1098  1136 67996.0289   44  205 56959.1560 77245.2148  35.6%  3224  660s
  1135  1176 67211.6241   45  165 56959.1560 77245.2148  35.6%  3214  671s
  1177  1218 67063.7327   46  202 56959.1560 77245.2148  35.6%  3188  683s
  1219  1264 67038.3989   47  156 56959.1560 77245.2148  35.6%  3143  696s
H 1235  1264                    56962.852963 77245.2148  35.6%  3125  696s
  1265  1296 66968.8963   48  193 56962.8530 77245.2148  35.6%  3098  705s
  1297  1329 66853.8468   49  193 56962.8530 77245.2148  35.6%  3072  715s
H 1299  1329                    57036.750592 77245.2148  35.4%  3068  715s
  1330  1510 66717.6612   50  189 57036.7506 77245.2148  35.4%  3058  730s
  1518  1657 65860.3876   59  169 57036.7506 77245.2148  35.4%  2825  746s
  1695  1778 64225.2914   69  147 57036.7506 77041.9745  35.1%  2660  765s
  1858  1874 62861.8967   80  101 57036.7506 77041.9745  35.1%  2562  785s
  1999  1915     cutoff   67      57036.7506 77031.4567  35.1%  2500  806s
  2124  1983 76120.5708    7  415 57036.7506 77031.4567  35.1%  2479  829s
  2226  2068 75598.7619    9  403 57036.7506 77031.4567  35.1%  2499  850s
  2329  2100 74901.2232   10  369 57036.7506 77031.4567  35.1%  2534  870s
  2361  2136 74641.8933   11  361 57036.7506 77031.4567  35.1%  2563  885s
  2405  2175 74328.4259   13  362 57036.7506 77031.4567  35.1%  2583  903s
  2450  2230 73802.0092   15  352 57036.7506 77031.4567  35.1%  2611  920s
  2515  2291 73507.2577   16  350 57036.7506 77031.4567  35.1%  2619  938s
  2588  2365 72765.1290   18  351 57036.7506 77031.4567  35.1%  2616  957s
  2666  2493 72840.9570   21  341 57036.7506 76743.6033  34.6%  2614  978s
  2800  2686 72486.6818   25  289 57036.7506 76743.6033  34.6%  2588 1003s
  2999  2901 71968.0530   29  265 57036.7506 76743.6033  34.6%  2512 1027s
  3223  2902 68828.3179   39  491 57036.7506 76743.6033  34.6%  2431 1084s
  3225  2903 72929.8478   23   84 57036.7506 76743.6033  34.6%  2429 1148s
  3226  2904 73943.0792   12  316 57036.7506 76743.6033  34.6%  2429 1182s
  3227  2905 61786.5815   88  353 57036.7506 76743.6033  34.6%  2428 1206s
  3228  2905 69887.4321   24  390 57036.7506 76743.6033  34.6%  2427 1218s
H 3228  2759                    57151.083765 76743.6033  34.3%  2427 1228s
  3230  2761 73205.4439   24  453 57151.0838 76743.6033  34.3%  2426 1238s
  3231  2761 72400.9120    9  437 57151.0838 76743.6033  34.3%  2425 1245s
  3232  2762 63610.3429   56  351 57151.0838 76743.6033  34.3%  2424 1250s
  3234  2763 59879.8017   67  448 57151.0838 76743.6033  34.3%  2423 1258s
  3235  2764 75102.8365    9  471 57151.0838 76743.6033  34.3%  2422 1262s
  3236  2765 71414.4468   21  448 57151.0838 76743.6033  34.3%  2421 1266s
  3238  2766 58277.0363   87  452 57151.0838 76743.6033  34.3%  2420 1270s
  3240  2767 60952.7880   60  473 57151.0838 76743.6033  34.3%  2418 1276s
  3241  2768 74821.6484   14  449 57151.0838 76743.6033  34.3%  2417 1281s
  3243  2769 64674.9942   62  446 57151.0838 76743.6033  34.3%  2416 1286s
  3245  2771 69209.3024   21  450 57151.0838 76743.6033  34.3%  2414 1293s
  3246  2771 71808.1484   22  478 57151.0838 76743.6033  34.3%  2414 1296s
  3247  2772 61427.7832   90  360 57151.0838 76743.6033  34.3%  2413 1301s
  3249  2773 73403.0266   12  476 57151.0838 76743.6033  34.3%  2411 1309s
  3250  2774 69743.6167   34  363 57151.0838 76743.6033  34.3%  2411 1311s
  3252  2775 70065.3188   30  482 57151.0838 76743.6033  34.3%  2409 1321s
  3254  2777 69860.0134   31  374 57151.0838 76743.6033  34.3%  2408 1326s
  3255  2777 70821.8373   37  451 57151.0838 76743.6033  34.3%  2407 1333s
  3256  2778 61534.9218   95  455 57151.0838 76743.6033  34.3%  2406 1336s
  3257  2779 63114.5653   84  368 57151.0838 76743.6033  34.3%  2405 1344s
  3258  2779 71413.5255   19  380 57151.0838 76743.6033  34.3%  2405 1346s
  3259  2780 72724.7504   21  487 57151.0838 76743.6033  34.3%  2404 1353s
  3260  2781 74969.0543   10  362 57151.0838 76743.6033  34.3%  2403 1355s
  3262  2782 72271.1733   14  368 57151.0838 76743.6033  34.3%  2402 1361s
  3263  2783 63402.9045   87  459 57151.0838 76743.6033  34.3%  2401 1373s
  3265  2784 64834.8483   72  370 57151.0838 76743.6033  34.3%  2400 1378s
  3267  2785 69294.6628   37  373 57151.0838 76743.6033  34.3%  2398 1382s
  3269  2787 73569.0780   22  373 57151.0838 76743.6033  34.3%  2397 1389s
  3270  2787 74869.8152   13  373 57151.0838 76743.6033  34.3%  2396 1452s
  3271  2788 68690.0482   34  373 57151.0838 76743.6033  34.3%  2395 1493s
  3272  2792 76743.6033   10  359 57151.0838 76743.6033  34.3%  2465 1541s
  3274  2794 76743.6033   11  422 57151.0838 76743.6033  34.3%  2468 1590s
  3277  2800 76743.6033   12  470 57151.0838 76743.6033  34.3%  2478 1625s
  3284  2812 76743.6033   13  445 57151.0838 76743.6033  34.3%  2499 1674s
  3293  2809 74674.5481   12  440 57151.0838 76743.6033  34.3%  2539 1675s
  3298  2821 75644.1529   14  421 57151.0838 76743.6033  34.3%  2563 1735s
  3312  2848 74261.7499   15  392 57151.0838 76743.6033  34.3%  2615 1873s
  3344  2874 73601.1471   16  370 57151.0838 76299.6016  33.5%  2723 1918s
H 3371  2725                    57164.380052 76299.6016  33.5%  2822 1918s
  3380  2864 73488.2367   17  371 57164.3801 76298.9417  33.5%  2848 1974s
  3522  2893 71700.8528   21  393 57164.3801 76298.9417  33.5%  2947 2007s
  3599  2946 70633.5817   24  349 57164.3801 76298.9417  33.5%  2998 2032s
  3677  2987 69964.4918   26  351 57164.3801 76298.9417  33.5%  3056 2056s
  3745  2993 68410.6687   28  336 57164.3801 76298.9417  33.5%  3108 2076s
  3778  3015 67314.4030   29  331 57164.3801 76298.9417  33.5%  3152 2098s
  3818  3045 66240.2637   30  367 57164.3801 76298.9417  33.5%  3201 2120s
  3885  3071 66223.7154   31  341 57164.3801 76298.9417  33.5%  3234 2142s
  3969  3073 66147.8271   32  302 57164.3801 76298.9417  33.5%  3254 2170s
  4050  3092 61575.8852   32  192 57164.3801 76298.9417  33.5%  3258 2197s
  4119  3091 60695.5994   33  191 57164.3801 76298.9417  33.5%  3313 2218s
  4178  3089 59000.9667   34  242 57164.3801 76298.9417  33.5%  3364 2241s
  4237  3080     cutoff   35      57164.3801 76298.9417  33.5%  3399 2272s
  4295  3093 62879.8792   32  343 57164.3801 76298.9417  33.5%  3444 2297s
  4353  3099 62101.5391   33  343 57164.3801 76298.9417  33.5%  3523 2329s
  4414  3106 60510.0711   35  266 57164.3801 75261.2388  31.7%  3571 2351s
  4466  3127 59931.9823   36  271 57164.3801 75261.2388  31.7%  3621 2379s
  4528  3146     cutoff   37      57164.3801 75231.0210  31.6%  3646 2407s
  4617  3151     cutoff   36      57164.3801 75231.0210  31.6%  3683 2439s
  4715  3150 63307.8042   32  302 57164.3801 75231.0210  31.6%  3726 2470s
  4792  3174 61885.9134   33  339 57164.3801 75231.0210  31.6%  3795 2512s
  4868  3209 60198.5570   35  239 57164.3801 75231.0210  31.6%  3859 2545s
  4962  3241 58327.3799   40  223 57164.3801 75231.0210  31.6%  3933 2581s
  5087  3256     cutoff   41      57164.3801 75157.4656  31.5%  3969 2616s
  5216  3286     cutoff   38      57164.3801 75157.4656  31.5%  4023 2652s
  5385  3265 61844.3797   28  231 57164.3801 75157.4656  31.5%  4029 2682s
H 5395  3129                    57214.009081 75157.4656  31.4%  4034 2682s
H 5400  3000                    57344.455266 75157.4656  31.1%  4034 2682s
  5436  3080 59971.8677   29  211 57344.4553 75157.4656  31.1%  4054 2720s
  5608  3115 58070.6555   38   76 57344.4553 74674.3245  30.2%  4048 2763s
  5780  3135 65724.7749   18  311 57344.4553 74674.3245  30.2%  4074 2806s
  5945  3154 64467.2740   20  322 57344.4553 74674.3245  30.2%  4104 2849s
  6108  3133 59594.3341   22  234 57344.4553 74674.3245  30.2%  4137 2887s
  6212  3168     cutoff   25      57344.4553 74674.3245  30.2%  4155 2934s
  6319  3186 68949.2410   17  339 57344.4553 74674.3245  30.2%  4212 2983s
  6477  3155 67239.1834   19  324 57344.4553 74336.9253  29.6%  4250 3037s
  6642  3174 61460.6616   23  254 57344.4553 74336.9253  29.6%  4315 3090s
  6759  3213     cutoff   23      57344.4553 72676.4930  26.7%  4399 3144s
  6884  3234 63891.9469   17  366 57344.4553 72676.4930  26.7%  4482 3198s
  7056  3243 64174.5513   16  309 57344.4553 72672.9435  26.7%  4528 3250s
  7218  3233     cutoff   19      57344.4553 72205.7832  25.9%  4591 3302s
  7365  3292 59217.2794   20  258 57344.4553 71943.9287  25.5%  4635 3360s
  7593  3308 60915.3107   21  299 57344.4553 71933.7076  25.4%  4677 3420s
  7810  3310 58334.8330   23  254 57344.4553 71717.9077  25.1%  4730 3480s
  8082  3299     cutoff   23      57344.4553 71697.2695  25.0%  4763 3549s
  8330  3370 66412.5947   23  307 57344.4553 71697.2695  25.0%  4828 3600s

Cutting planes:
  Learned: 2
  MIR: 816
  Flow cover: 1616
  RLT: 21
  Relax-and-lift: 134

Explored 8565 nodes (42057165 simplex iterations) in 3600.04 seconds (6536.93 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 57344.5 57214 57164.4 ... 56729.2

Time limit reached
Best objective 5.734445526558e+04, best bound 7.169726948504e+04, gap 25.0291%
  WARNING: Time limit reached. Using best solution found (gap: 25.03%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 57344.46, θ = 229734.67
  Upper Bound (UB) = 57344.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229734.67
  [DEBUG]   ✓ Scenario 0: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229734.67 ≤ Q = 229734.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 229734.67 ≤ Q = 229734.67 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x29edabc1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x29edabc1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.406935e+13
Presolve removed 2560 rows and 1850 columns
Presolve time: 0.01s
Presolved: 533 rows, 539 columns, 1505 nonzeros
Found heuristic solution: objective 7001042.9203
Variable types: 366 continuous, 173 integer (173 binary)

Root relaxation: objective -1.892645e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189264.46    0  126 7001042.92 -189264.46   103%     -    0s
H    0     0                    -156288.0820 -189264.46  21.1%     -    0s
H    0     0                    -156746.7766 -189013.35  20.6%     -    0s
     0     0 -170821.11    0  107 -156746.78 -170821.11  8.98%     -    0s
H    0     0                    -165767.7269 -170686.96  2.97%     -    0s
     0     0 -170372.53    0  110 -165767.73 -170372.53  2.78%     -    0s
H    0     0                    -167467.1179 -170372.53  1.73%     -    0s
     0     0 -168865.63    0   97 -167467.12 -168865.63  0.84%     -    0s
H    0     0                    -167921.4479 -168843.90  0.55%     -    0s
     0     0 -168843.90    0   97 -167921.45 -168843.90  0.55%     -    0s
     0     0 -168529.09    0   58 -167921.45 -168529.09  0.36%     -    0s
     0     0 -168504.22    0   49 -167921.45 -168504.22  0.35%     -    0s
     0     0 -168503.69    0   48 -167921.45 -168503.69  0.35%     -    0s
     0     0 -168400.08    0   46 -167921.45 -168400.08  0.29%     -    0s
     0     0 -168373.39    0   46 -167921.45 -168373.39  0.27%     -    0s
     0     0 -168364.34    0   44 -167921.45 -168364.34  0.26%     -    0s
     0     0 -168352.87    0   44 -167921.45 -168352.87  0.26%     -    0s
     0     2 -168352.87    0   44 -167921.45 -168352.87  0.26%     -    0s
H   39    24                    -167953.5277 -168153.45  0.12%   8.9    0s
H   98    57                    -167971.7709 -168110.72  0.08%   6.1    0s
H  114    57                    -167981.5137 -168107.23  0.07%   5.9    0s
H  153    57                    -167997.3703 -168062.32  0.04%   5.5    0s

Cutting planes:
  Gomory: 49
  Implied bound: 4
  MIR: 150
  Flow cover: 6
  RLT: 57
  Relax-and-lift: 5
  BQP: 5

Explored 235 nodes (1879 simplex iterations) in 0.17 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -167997 -167982 -167972 ... 1.40693e+13
No other solutions better than -167997

Optimal solution found (tolerance 1.00e-04)
Best objective -1.679973703326e+05, best bound -1.679973703326e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 216497.67
  Scenario: 50 demand increases, 10 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -167997.37
  [DEBUG]   S×d_nominal = 384495.04
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 384495.04 + -167997.37 = 216497.67
  [DEBUG]   Current θ from Master = 229734.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13237.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44107.45
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 4017.5080, Absolute Gap = 4017.5080, Relative Gap = 0.070059
  Not converged yet (gap = 4017.51 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 50 increases, 10 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0x77c9aa3b
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 2.74s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25205   -1.8144188e+05   0.000000e+00   6.234696e+06      5s
   40736   -1.3741249e+04   0.000000e+00   3.733498e+08     10s
   52608    1.7847153e+04   0.000000e+00   3.938793e+08     15s
   59602    2.2168126e+04   0.000000e+00   1.625797e+08     20s
   67239    4.6262132e+04   0.000000e+00   5.825659e+06     25s
   75079    5.6841680e+04   0.000000e+00   9.620591e+06     30s
   83480    6.2464008e+04   0.000000e+00   3.502015e+06     35s
   90156    6.4427573e+04   0.000000e+00   2.322951e+07     40s
   97962    6.7830340e+04   0.000000e+00   3.626492e+07     45s
  105994    7.0131100e+04   0.000000e+00   2.725367e+06     50s
  114778    7.3692018e+04   0.000000e+00   9.631275e+05     55s
Concurrent spin time: 0.84s

Solved with dual simplex

Root relaxation: objective 9.043506e+04, 63167 iterations, 56.54 seconds (78.34 work units)
Total elapsed time = 60.04s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 90435.0570    0   83 -223925.25 90435.0570   140%     -   60s
H    0     0                    -211806.0146 90435.0570   143%     -   60s
H    0     0                    -125313.2823 90435.0570   172%     -   60s
H    0     0                    -125261.3587 90435.0570   172%     -   60s
H    0     0                    -125251.2717 90435.0570   172%     -   60s
H    0     0                    -125204.1591 90435.0570   172%     -   60s
H    0     0                    -54954.85391 90435.0570   265%     -   60s
H    0     0                    7491.4057604 90435.0570  1107%     -   61s
H    0     0                    13469.330139 90435.0570   571%     -   61s
H    0     0                    34726.973174 90435.0570   160%     -   61s
H    0     0                    40328.807318 90435.0570   124%     -   61s
H    0     0                    40651.099650 90435.0570   122%     -   61s
H    0     0                    40867.595758 90435.0570   121%     -   61s
H    0     0                    41778.980057 90435.0570   116%     -   61s
H    0     0                    41944.144135 90435.0570   116%     -   61s
H    0     0                    42088.237780 90435.0570   115%     -   61s
H    0     0                    42203.228364 90435.0570   114%     -   61s
H    0     0                    42464.422090 90435.0570   113%     -   61s
H    0     0                    42643.619885 90434.6457   112%     -   62s
     0     0 84851.8904    0  205 42643.6199 84851.8904  99.0%     -   80s
     0     0 84464.5480    0  208 42643.6199 84464.5480  98.1%     -   90s
     0     0 84454.1520    0  209 42643.6199 84454.1520  98.0%     -   92s
     0     0 84454.1520    0  207 42643.6199 84454.1520  98.0%     -   92s
     0     0 84454.1520    0  212 42643.6199 84454.1520  98.0%     -   93s
     0     0 84454.1520    0  211 42643.6199 84454.1520  98.0%     -   93s
     0     0 84454.1520    0  211 42643.6199 84454.1520  98.0%     -   93s
H    0     0                    42858.892248 81843.9108  91.0%     -  111s
     0     0 81831.0980    0  255 42858.8922 81831.0980  90.9%     -  111s
H    0     0                    48925.452742 81831.0980  67.3%     -  111s
H    0     0                    49006.043662 81831.0980  67.0%     -  111s
H    0     0                    49054.772501 81831.0980  66.8%     -  111s
H    0     0                    49082.225421 81831.0980  66.7%     -  111s
H    0     0                    49115.365081 81831.0980  66.6%     -  111s
     0     0 81365.1418    0  257 49115.3651 81365.1418  65.7%     -  123s
     0     0 81192.7693    0  270 49115.3651 81192.7693  65.3%     -  129s
     0     0 81159.3655    0  273 49115.3651 81159.3655  65.2%     -  131s
     0     0 81147.9449    0  270 49115.3651 81147.9449  65.2%     -  133s
     0     0 81143.4987    0  272 49115.3651 81143.4987  65.2%     -  134s
     0     0 81138.3502    0  270 49115.3651 81138.3502  65.2%     -  135s
     0     0 81136.1363    0  274 49115.3651 81136.1363  65.2%     -  135s
     0     0 81132.7571    0  275 49115.3651 81132.7571  65.2%     -  136s
     0     0 81115.3208    0  288 49115.3651 81115.3208  65.2%     -  138s
     0     0 81114.1080    0  273 49115.3651 81114.1080  65.2%     -  138s
     0     0 81113.8779    0  273 49115.3651 81113.8779  65.1%     -  138s
     0     0 79612.5914    0  325 49115.3651 79612.5914  62.1%     -  171s
     0     0 79020.7107    0  326 49115.3651 79020.7107  60.9%     -  182s
     0     0 78887.6167    0  382 49115.3651 78887.6167  60.6%     -  187s
     0     0 78822.1579    0  343 49115.3651 78822.1579  60.5%     -  192s
     0     0 78761.9355    0  349 49115.3651 78761.9355  60.4%     -  197s
     0     0 78733.7169    0  350 49115.3651 78733.7169  60.3%     -  199s
     0     0 78717.8606    0  391 49115.3651 78717.8606  60.3%     -  201s
     0     0 78711.5657    0  396 49115.3651 78711.5657  60.3%     -  202s
     0     0 78708.3695    0  394 49115.3651 78708.3695  60.3%     -  203s
     0     0 78707.4358    0  356 49115.3651 78707.4358  60.3%     -  203s
H    0     0                    50128.286840 78204.7667  56.0%     -  226s
H    0     0                    50554.103964 78204.7667  54.7%     -  226s
H    0     0                    50674.234482 78204.7667  54.3%     -  226s
H    0     0                    52182.486349 78204.7667  49.9%     -  226s
H    0     0                    52349.247948 78204.7667  49.4%     -  226s
     0     0 78204.7667    0  422 52349.2479 78204.7667  49.4%     -  226s
     0     0 78059.7135    0  428 52349.2479 78059.7135  49.1%     -  236s
     0     0 77975.2864    0  419 52349.2479 77975.2864  49.0%     -  243s
     0     0 77937.0926    0  426 52349.2479 77937.0926  48.9%     -  248s
     0     0 77916.3469    0  431 52349.2479 77916.3469  48.8%     -  250s
     0     0 77912.1908    0  444 52349.2479 77912.1908  48.8%     -  252s
     0     0 77908.3212    0  401 52349.2479 77908.3212  48.8%     -  253s
     0     0 77906.3192    0  401 52349.2479 77906.3192  48.8%     -  254s
     0     0 77905.8206    0  432 52349.2479 77905.8206  48.8%     -  255s
     0     0 77781.7606    0  426 52349.2479 77781.7606  48.6%     -  264s
     0     0 77720.8892    0  361 52349.2479 77720.8892  48.5%     -  268s
     0     0 77702.1491    0  409 52349.2479 77702.1491  48.4%     -  272s
     0     0 77694.4902    0  411 52349.2479 77694.4902  48.4%     -  273s
     0     0 77689.7344    0  436 52349.2479 77689.7344  48.4%     -  275s
     0     0 77688.5453    0  407 52349.2479 77688.5453  48.4%     -  276s
     0     0 77610.8963    0  439 52349.2479 77610.8963  48.3%     -  286s
     0     0 77568.4531    0  419 52349.2479 77568.4531  48.2%     -  290s
     0     0 77552.5556    0  416 52349.2479 77552.5556  48.1%     -  294s
     0     0 77542.3770    0  422 52349.2479 77542.3770  48.1%     -  296s
     0     0 77540.6291    0  424 52349.2479 77540.6291  48.1%     -  296s
     0     0 77537.0102    0  420 52349.2479 77537.0102  48.1%     -  297s
     0     0 77534.4403    0  457 52349.2479 77534.4403  48.1%     -  299s
     0     0 77533.7090    0  423 52349.2479 77533.7090  48.1%     -  299s
H    0     0                    52446.906759 77489.1900  47.7%     -  305s
H    0     0                    52447.804733 77489.1900  47.7%     -  305s
     0     0 77489.1900    0  467 52447.8047 77489.1900  47.7%     -  305s
     0     0 77476.3486    0  477 52447.8047 77476.3486  47.7%     -  309s
     0     0 77472.8434    0  479 52447.8047 77472.8434  47.7%     -  312s
     0     0 77471.7757    0  481 52447.8047 77471.7757  47.7%     -  313s
     0     0 77451.9615    0  371 52447.8047 77451.9615  47.7%     -  317s
     0     0 77447.7296    0  368 52447.8047 77447.7296  47.7%     -  319s
     0     0 77446.2500    0  371 52447.8047 77446.2500  47.7%     -  320s
     0     0 77425.1724    0  415 52447.8047 77425.1724  47.6%     -  323s
     0     0 77419.9837    0  411 52447.8047 77419.9837  47.6%     -  325s
     0     0 77419.2792    0  370 52447.8047 77419.2792  47.6%     -  325s
     0     0 77415.6528    0  364 52447.8047 77415.6528  47.6%     -  327s
     0     0 77414.9379    0  418 52447.8047 77414.9379  47.6%     -  328s
     0     0 77413.0176    0  359 52447.8047 77413.0176  47.6%     -  330s
     0     0 77412.4770    0  422 52447.8047 77412.4770  47.6%     -  331s
     0     0 77411.0442    0  419 52447.8047 77411.0442  47.6%     -  333s
     0     0 77410.8562    0  419 52447.8047 77410.8562  47.6%     -  337s
     0     0 77398.0892    0  460 52447.8047 77398.0892  47.6%     -  341s
     0     0 77397.8795    0  460 52447.8047 77397.8795  47.6%     -  343s
H    0     0                    52594.495175 77397.8795  47.2%     -  370s
H    0     0                    52610.267284 77397.8795  47.1%     -  394s
H    0     0                    52709.808537 77397.8795  46.8%     -  401s
     0     2 77397.8795    0  460 52709.8085 77397.8795  46.8%     -  404s
     1     4 77373.8957    1  417 52709.8085 77397.7328  46.8%  1035  409s
     3     6 76360.7998    2  381 52709.8085 77373.8904  46.8%  6552  430s
     5    10 75733.3754    3  384 52709.8085 77373.8904  46.8%  9116  444s
     9    20 76466.6205    3  414 52709.8085 76967.8007  46.0%  8445  466s
    19    40 75656.3649    4  420 52709.8085 76842.5418  45.8%  8167  482s
    39    52 76010.7319    5  443 52709.8085 76710.0874  45.5% 10682  541s
    51    78 73720.7290    6  413 52709.8085 76710.0874  45.5% 10950  583s
H   70    78                    52807.667252 76710.0874  45.3% 11331  583s
    77   201 73679.0374    7  406 52807.6673 76710.0874  45.3% 10813  617s
   200   233 73268.9365   12  355 52807.6673 76710.0874  45.3%  7171  631s
H  223   233                    52917.280580 76710.0874  45.0%  6817  631s
   232   301 73509.2149   12  376 52917.2806 76710.0874  45.0%  6688  652s
   300   338 72927.3243   13  347 52917.2806 76710.0874  45.0%  6006  668s
   337   411 72923.4984   14  345 52917.2806 76710.0874  45.0%  5627  683s
   410   443 72885.7932   15  345 52917.2806 76710.0874  45.0%  4997  697s
   442   483 72850.7916   16  335 52917.2806 76710.0874  45.0%  4844  711s
   482   514 72669.1358   17  330 52917.2806 76710.0874  45.0%  4687  726s
   513   549 72618.6862   18  362 52917.2806 76710.0874  45.0%  4581  740s
   548   584 72567.2472   19  323 52917.2806 76710.0874  45.0%  4458  758s
   583   618 72517.8065   20  323 52917.2806 76710.0874  45.0%  4366  771s
H  612   618                    53045.569456 76710.0874  44.6%  4294  771s
   617   705 72420.9258   21  355 53045.5695 76710.0874  44.6%  4292  789s
   704   780 72131.9321   23  330 53045.5695 76710.0874  44.6%  4043  807s
   779   857 71728.3963   27  340 53045.5695 76710.0874  44.6%  3909  826s
   856   962 71505.5959   29  317 53045.5695 76710.0874  44.6%  3781  842s
   961  1078 71337.1825   32  275 53045.5695 76710.0874  44.6%  3571  858s
  1077  1213 70790.1458   39  234 53045.5695 76710.0874  44.6%  3376  873s
  1212  1343 70402.0094   42  258 53045.5695 76710.0874  44.6%  3153  891s
  1346  1527 70021.3921   45  179 53045.5695 76710.0874  44.6%  2986  907s
  1534  1647 57926.8226   51  161 53045.5695 76710.0874  44.6%  2749  924s
  1684  1671 55544.5207   61  123 53045.5695 76710.0874  44.6%  2636  940s
  1721  1705 53890.2908   62  124 53045.5695 76710.0874  44.6%  2628  961s
  1757  1732     cutoff   63      53045.5695 76710.0874  44.6%  2645  976s
  1806  1762     cutoff   63      53045.5695 76643.7429  44.5%  2652  995s
  1850  1805 54265.6026   62  116 53045.5695 76643.7429  44.5%  2658 1014s
  1897  1842     cutoff   63      53045.5695 76643.7429  44.5%  2654 1034s
  1957  1886 53821.0309   63  117 53045.5695 76636.6129  44.5%  2627 1052s
H 1960  1881                    54738.024577 76636.6129  40.0%  2630 1052s
  2013  2030     cutoff   64      54738.0246 76636.6129  40.0%  2609 1074s
  2251  2173 65528.1126   38  263 54738.0246 76167.6958  39.1%  2442 1101s
  2474  2237 65497.0376   39  215 54738.0246 76167.6958  39.1%  2321 1127s
  2634  2293 59040.4229   59  132 54738.0246 76167.6958  39.1%  2273 1155s
  2792  2400 56626.8700   61  111 54738.0246 76167.6958  39.1%  2258 1184s
  2945  2466     cutoff   47      54738.0246 75241.4383  37.5%  2253 1215s
  3063  2544 72374.6824    7  378 54738.0246 75241.4383  37.5%  2285 1247s
  3161  2633 67266.1487    8  371 54738.0246 75241.4383  37.5%  2317 1275s
  3292  2731 66349.0829    9  274 54738.0246 75241.4383  37.5%  2326 1307s
  3438  2858 infeasible   91      54738.0246 75241.4383  37.5%  2323 1339s
  3635  2965 64809.2246   11  235 54738.0246 75241.4383  37.5%  2297 1371s
H 3797  2959                    55089.681212 75241.4383  36.6%  2309 1408s
  3798  2960 66714.0362   41  460 55089.6812 75241.4383  36.6%  2309 1487s
  3800  2961 74041.9139   16   83 55089.6812 75241.4383  36.6%  2307 1531s
H 3800  2812                    55111.540810 75241.4383  36.5%  2307 1566s
H 3800  2672                    55267.295445 75241.4383  36.1%  2307 1566s
  3802  2674 74238.2507   17  295 55267.2954 75241.4383  36.1%  2306 1591s
  3803  2674 71228.1566   14  388 55267.2954 75241.4383  36.1%  2306 1608s
  3804  2675 69592.9098   44  368 55267.2954 75241.4383  36.1%  2305 1622s
H 3804  2541                    55695.831568 75241.4383  35.1%  2305 1632s
  3806  2542 58245.8057   51  421 55695.8316 75241.4383  35.1%  2304 1642s
  3807  2543 73262.4621   17  399 55695.8316 75241.4383  35.1%  2303 1652s
  3808  2544 71666.9000   12  417 55695.8316 75241.4383  35.1%  2303 1658s
  3809  2544 67086.1138   32  419 55695.8316 75241.4383  35.1%  2302 1664s
  3810  2545 67330.9758   37  411 55695.8316 75241.4383  35.1%  2301 1666s
  3811  2546 73605.6394    9  482 55695.8316 75241.4383  35.1%  2301 1671s
  3812  2546 57483.4487   38  448 55695.8316 75241.4383  35.1%  2300 1675s
  3814  2548 65531.8220   34  441 55695.8316 75241.4383  35.1%  2299 1685s
  3816  2549 62548.2395   15  488 55695.8316 75241.4383  35.1%  2298 1692s
  3817  2550 73844.2474    8  457 55695.8316 75241.4383  35.1%  2297 1696s
  3818  2550 67481.2155   57  479 55695.8316 75241.4383  35.1%  2297 1706s
  3820  2552 66172.0604   70  459 55695.8316 75241.4383  35.1%  2295 1711s
  3821  2552 57890.3058   46  454 55695.8316 75241.4383  35.1%  2295 1717s
  3822  2553 73762.3656   20  456 55695.8316 75241.4383  35.1%  2294 1721s
  3823  2554 59630.3565   62  414 55695.8316 75241.4383  35.1%  2294 1726s
  3825  2555 55695.8316   39  436 55695.8316 75241.4383  35.1%  2292 1737s
  3826  2556 69316.4594   23  447 55695.8316 75241.4383  35.1%  2292 1742s
  3828  2557 57039.3414   69  415 55695.8316 75241.4383  35.1%  2291 1750s
H 3828  2428                    55913.644730 75241.4383  34.6%  2291 1752s
  3830  2429 61911.0855   57  438 55913.6447 75241.4383  34.6%  2289 1760s
  3832  2431 57131.9587   64  448 55913.6447 75241.4383  34.6%  2288 1772s
  3833  2431 72313.1978   22  409 55913.6447 75241.4383  34.6%  2288 1777s
  3834  2432 62092.6377   65  414 55913.6447 75241.4383  34.6%  2287 1785s
  3835  2433 59709.5887   78  414 55913.6447 75241.4383  34.6%  2286 1832s
  3836  2433 71946.1577   22  414 55913.6447 75241.4383  34.6%  2286 1879s
  3837  2437 75241.4383   11  415 55913.6447 75241.4383  34.6%  2345 1968s
  3839  2440 75241.4383   12  396 55913.6447 75241.4383  34.6%  2347 2036s
  3843  2447 75241.4383   13  395 55913.6447 75241.4383  34.6%  2357 2080s
  3851  2460 75241.4383   14  445 55913.6447 75241.4383  34.6%  2374 2146s
  3867  2473 71820.9963   15  376 55913.6447 75241.4383  34.6%  2453 2222s
  3885  2499 73170.3373   16  426 55913.6447 75241.4383  34.6%  2515 2288s
  3917  2616 72792.5196   17  402 55913.6447 75241.4383  34.6%  2607 2343s
  4045  2640 72055.6334   20  316 55913.6447 75241.4383  34.6%  2732 2375s
  4111  2650 72228.2258   20  428 55913.6447 75241.4383  34.6%  2770 2400s
  4143  2671 70711.8591   20  407 55913.6447 75241.4383  34.6%  2787 2428s
  4175  2692 71195.6689   21  421 55913.6447 75241.4383  34.6%  2819 2449s
  4207  2725 69884.7876   21  311 55913.6447 75241.4383  34.6%  2865 2490s
  4251  2738 70725.1923   21  384 55913.6447 75241.4383  34.6%  2886 2516s
  4285  2759 71418.9245   21  337 55913.6447 75241.4383  34.6%  2909 2538s
  4320  2784 70390.6064   22  332 55913.6447 75241.4383  34.6%  2933 2567s
  4358  2810 70194.6325   23  269 55913.6447 75241.4383  34.6%  2950 2593s
  4401  2839 69436.3599   24  312 55913.6447 75241.4383  34.6%  2966 2615s
  4458  2859 68090.5938   25  327 55913.6447 75241.4383  34.6%  2974 2639s
  4516  2868 67583.8989   26  323 55913.6447 75241.4383  34.6%  2978 2663s
  4578  2878 66666.5313   27  292 55913.6447 75241.4383  34.6%  2983 2705s
  4657  2877 71520.1382   21  403 55913.6447 75241.4383  34.6%  2987 2736s
  4731  2887 66861.3928   25  260 55913.6447 75241.4383  34.6%  2987 2780s
  4813  2875 64469.9010   28  269 55913.6447 75241.4383  34.6%  2986 2817s
  4899  2866 62766.0875   27  321 55913.6447 75241.4383  34.6%  3000 2847s
  4938  2884 61172.7170   28  277 55913.6447 75241.4383  34.6%  3026 2883s
  4990  2912 63783.9570   29  281 55913.6447 75241.4383  34.6%  3044 2931s
  5062  2939 61534.7021   30  236 55913.6447 75241.4383  34.6%  3063 2969s
  5141  2973 60965.8422   34  211 55913.6447 75241.4383  34.6%  3081 3007s
  5216  3011 60451.5931   36  159 55913.6447 75241.4383  34.6%  3090 3048s
  5298  3058 59628.7255   39  115 55913.6447 75241.4383  34.6%  3100 3093s
  5401  3100 58364.1462   44  137 55913.6447 74977.3389  34.1%  3105 3137s
  5521  3100     cutoff   49      55913.6447 74977.3389  34.1%  3102 3182s
  5650  3101     cutoff   52      55913.6447 74770.4265  33.7%  3117 3237s
  5764  3125 59118.1727   26  262 55913.6447 74770.4265  33.7%  3133 3284s
  5868  3140 56635.4770   29  188 55913.6447 74770.4265  33.7%  3157 3332s
  5991  3171 57228.4430   28  219 55913.6447 74770.4265  33.7%  3176 3380s
  6101  3188     cutoff   34      55913.6447 74770.4265  33.7%  3201 3433s
  6231  3196 70110.0187   20  358 55913.6447 74122.1808  32.6%  3223 3503s
  6366  3228 67464.9577   22  333 55913.6447 74122.1808  32.6%  3244 3562s
  6488  3241 64628.2009   24  277 55913.6447 74122.1808  32.6%  3281 3600s

Cutting planes:
  Learned: 2
  MIR: 828
  Mixing: 1
  Flow cover: 1793
  RLT: 34
  Relax-and-lift: 166

Explored 6586 nodes (21947310 simplex iterations) in 3600.05 seconds (5914.23 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 55913.6 55695.8 55267.3 ... 52709.8

Time limit reached
Best objective 5.591364473001e+04, best bound 7.287350386298e+04, gap 30.3322%
  WARNING: Time limit reached. Using best solution found (gap: 30.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 55913.64, θ = 227914.64
  Upper Bound (UB) = 55913.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227914.64
  [DEBUG]   ✓ Scenario 0: θ = 227914.64 ≤ Q = 227914.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227914.64 ≤ Q = 227914.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227914.64 ≤ Q = 227914.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227914.64 ≤ Q = 227914.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227914.64 ≤ Q = 227914.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227914.64 ≤ Q = 227914.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227914.64 ≤ Q = 227914.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227914.64 ≤ Q = 227914.64 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1ebfa983
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1ebfa983
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.401317e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1504 nonzeros
Found heuristic solution: objective 7005283.4179
Variable types: 365 continuous, 173 integer (173 binary)

Root relaxation: objective -1.869070e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -186907.03    0  126 7005283.42 -186907.03   103%     -    0s
H    0     0                    -153766.7080 -186907.03  21.6%     -    0s
H    0     0                    -163001.6932 -186907.03  14.7%     -    0s
H    0     0                    -163510.5884 -186667.35  14.2%     -    0s
     0     0 -170682.06    0   91 -163510.59 -170682.06  4.39%     -    0s
H    0     0                    -166277.0283 -170570.85  2.58%     -    0s
     0     0 -170234.96    0   94 -166277.03 -170234.96  2.38%     -    0s
     0     0 -170216.73    0   94 -166277.03 -170216.73  2.37%     -    0s
     0     0 -168780.26    0  108 -166277.03 -168780.26  1.51%     -    0s
H    0     0                    -168051.8571 -168736.15  0.41%     -    0s
     0     0 -168732.97    0  109 -168051.86 -168732.97  0.41%     -    0s
     0     0 -168412.90    0   58 -168051.86 -168412.90  0.21%     -    0s
     0     0 -168410.74    0   54 -168051.86 -168410.74  0.21%     -    0s
H    0     0                    -168070.4825 -168408.28  0.20%     -    0s
     0     0 -168356.57    0   56 -168070.48 -168356.57  0.17%     -    0s
     0     0 -168356.32    0   55 -168070.48 -168356.32  0.17%     -    0s
     0     0 -168354.83    0   54 -168070.48 -168354.83  0.17%     -    0s
     0     0 -168262.72    0   47 -168070.48 -168262.72  0.11%     -    0s
     0     0 -168254.05    0   43 -168070.48 -168254.05  0.11%     -    0s
     0     0 -168231.66    0   17 -168070.48 -168231.66  0.10%     -    0s
     0     0 -168200.16    0   47 -168070.48 -168200.16  0.08%     -    0s
     0     0 -168196.54    0   47 -168070.48 -168196.54  0.08%     -    0s
     0     0 -168165.50    0   45 -168070.48 -168165.50  0.06%     -    0s
     0     0 -168165.50    0   46 -168070.48 -168165.50  0.06%     -    0s
     0     0 -168165.50    0   47 -168070.48 -168165.50  0.06%     -    0s
     0     0 -168165.50    0   41 -168070.48 -168165.50  0.06%     -    0s
     0     0 -168165.50    0   42 -168070.48 -168165.50  0.06%     -    0s
     0     0 -168123.25    0   42 -168070.48 -168123.25  0.03%     -    0s
     0     0 -168117.39    0   10 -168070.48 -168117.39  0.03%     -    0s
     0     0 -168101.72    0   10 -168070.48 -168101.72  0.02%     -    0s
     0     0 -168092.10    0    8 -168070.48 -168092.10  0.01%     -    0s
     0     0 -168090.69    0    7 -168070.48 -168090.69  0.01%     -    0s
     0     0          -    0      -168070.48 -168084.67  0.01%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 40
  Flow cover: 19
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (1071 simplex iterations) in 0.23 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -168070 -168052 -166793 ... 1.40132e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.680704824904e+05, best bound -1.680846735749e+05, gap 0.0084%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 212694.19
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -168070.48
  [DEBUG]   S×d_nominal = 380764.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380764.67 + -168070.48 = 212694.19
  [DEBUG]   Current θ from Master = 227914.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15220.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 40693.19
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 2586.6975, Absolute Gap = 2586.6975, Relative Gap = 0.046262
  Not converged yet (gap = 2586.70 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0xd4aa507b
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 2.65s
Presolved: 81726 rows, 35173 columns, 500096 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -286903.3548
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.397e+06
 Factor NZ  : 7.331e+06 (roughly 100 MB of memory)
 Factor Ops : 1.231e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.56776857e+07  1.70300975e+08  1.34e+05 1.94e+01  8.29e+04     4s
   1  -1.16769775e+07  1.55095917e+08  9.32e+04 1.08e+02  5.70e+04     4s
   2  -5.84717416e+06  1.23170358e+08  4.54e+04 2.00e+01  2.86e+04     4s
   3  -1.02468195e+06  9.02869971e+07  2.73e+03 2.14e-11  2.24e+03     4s
   4  -7.21014395e+05  3.65565509e+07  6.14e+02 1.09e-02  5.64e+02     4s
   5  -3.81678865e+05  2.48980703e+07  3.83e+02 6.48e-03  3.50e+02     4s
   6  -2.79851370e+05  1.96384048e+07  8.98e+01 5.19e-03  1.73e+02     4s
   7  -1.91911486e+05  1.39817334e+07  3.57e+01 3.79e-03  1.08e+02     5s
   8  -1.07164919e+05  9.01214055e+06  1.62e+01 2.27e-03  6.53e+01     5s
   9  -9.26373335e+04  5.38372531e+06  1.04e+01 1.34e-03  3.85e+01     5s
  10  -4.95363112e+04  1.94009522e+06  2.04e+00 4.75e-04  1.34e+01     5s
  11  -7.06522489e+03  4.28590982e+05  6.89e-01 5.06e-04  2.92e+00     5s
  12   1.40042099e+04  2.82225045e+05  4.94e-01 8.08e-04  1.80e+00     5s
  13   2.35965986e+04  2.37826335e+05  4.20e-01 6.75e-04  1.43e+00     5s
  14   3.92635813e+04  1.88111354e+05  3.00e-01 8.91e-04  9.96e-01     5s
  15   4.80205801e+04  1.60639277e+05  2.46e-01 2.20e-03  7.54e-01     5s
  16   5.93704854e+04  1.37484506e+05  1.77e-01 2.27e-03  5.23e-01     5s
  17   6.67234790e+04  1.22062324e+05  1.38e-01 2.09e-03  3.71e-01     5s
  18   7.29851960e+04  1.19300410e+05  1.05e-01 1.92e-03  3.10e-01     5s
  19   7.60472835e+04  1.14760790e+05  9.05e-02 2.02e-03  2.59e-01     5s
  20   8.04426337e+04  1.09114608e+05  7.01e-02 1.78e-03  1.92e-01     5s
  21   8.32234985e+04  1.05516998e+05  5.73e-02 1.96e-03  1.49e-01     5s
  22   8.60563650e+04  1.02731764e+05  4.47e-02 1.50e-03  1.12e-01     5s
  23   8.74863071e+04  1.01216159e+05  3.85e-02 1.13e-03  9.20e-02     5s
  24   8.96632400e+04  9.98640794e+04  2.93e-02 1.18e-03  6.84e-02     6s
  25   9.09844287e+04  9.90269461e+04  2.38e-02 1.34e-03  5.39e-02     6s
  26   9.19024349e+04  9.85998816e+04  2.02e-02 1.39e-03  4.49e-02     6s
  27   9.24652644e+04  9.82845474e+04  1.77e-02 1.16e-03  3.90e-02     6s
  28   9.35435418e+04  9.79798427e+04  1.33e-02 9.12e-04  2.97e-02     6s
  29   9.41233443e+04  9.75656859e+04  1.08e-02 5.89e-04  2.31e-02     6s
  30   9.44048612e+04  9.74790076e+04  9.65e-03 5.37e-04  2.06e-02     6s
  31   9.54089840e+04  9.73109116e+04  5.57e-03 3.81e-04  1.27e-02     6s
  32   9.57360331e+04  9.71748429e+04  4.27e-03 2.35e-04  9.65e-03     6s
  33   9.61722177e+04  9.70957196e+04  2.50e-03 1.80e-04  6.19e-03     6s
  34   9.63119164e+04  9.70083026e+04  1.97e-03 1.20e-04  4.67e-03     6s
  35   9.63618313e+04  9.69821227e+04  1.78e-03 9.94e-05  4.16e-03     6s
  36   9.65253477e+04  9.69499259e+04  1.17e-03 8.03e-05  2.84e-03     6s
  37   9.65812099e+04  9.69422239e+04  9.71e-04 7.35e-05  2.42e-03     6s
  38   9.66491322e+04  9.68996081e+04  7.36e-04 5.07e-05  1.68e-03     7s
  39   9.67293282e+04  9.68870965e+04  4.49e-04 3.24e-05  1.06e-03     7s
  40   9.67645051e+04  9.68734525e+04  3.27e-04 1.49e-05  7.30e-04     7s
  41   9.67785130e+04  9.68711796e+04  2.80e-04 1.17e-05  6.21e-04     7s
  42   9.67962285e+04  9.68688543e+04  2.18e-04 8.13e-06  4.87e-04     7s
  43   9.68535568e+04  9.68658769e+04  2.45e-05 6.95e-06  8.24e-05     7s
  44   9.68626643e+04  9.68627999e+04  9.70e-08 2.43e-06  9.05e-07     7s
  45   9.68627496e+04  9.68627498e+04  2.97e-10 1.12e-09  8.14e-10     7s

Barrier solved model in 45 iterations and 7.06 seconds (6.59 work units)
Optimal objective 9.68627496e+04


Root crossover log...

   74044 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    2738 PPushes remaining with PInf 1.3303996e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.7387766e+00      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40768    9.6862750e+04   0.000000e+00   6.738777e+00      9s
   40783    9.6862750e+04   0.000000e+00   0.000000e+00      9s
   40783    9.6862750e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.686275e+04, 40783 iterations, 5.95 seconds (7.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 96862.7498    0  166 -223925.25 96862.7498   143%     -    9s
H    0     0                    -214602.8156 96862.7498   145%     -    9s
H    0     0                    -207224.2900 96862.7498   147%     -   10s
H    0     0                    -206502.8071 96862.7498   147%     -   10s
H    0     0                    -205243.3655 96862.7498   147%     -   10s
H    0     0                    -161182.4221 96862.7498   160%     -   10s
H    0     0                    -158170.0238 96862.7498   161%     -   10s
H    0     0                    -151853.8236 96862.7498   164%     -   10s
H    0     0                    -151746.8594 96862.7498   164%     -   11s
H    0     0                    -151645.1949 96862.7498   164%     -   11s
H    0     0                    -150245.3297 96862.7498   164%     -   11s
H    0     0                    -149300.0383 96862.7498   165%     -   11s
H    0     0                    -149208.8190 96862.7498   165%     -   11s
H    0     0                    -148845.9159 96862.7498   165%     -   11s
H    0     0                    -148668.4442 96862.7498   165%     -   11s
H    0     0                    27158.554644 96862.7498   257%     -   11s
H    0     0                    27961.802335 96862.7498   246%     -   11s
H    0     0                    29142.213960 96862.7498   232%     -   12s
H    0     0                    41127.000563 96862.7498   136%     -   12s
H    0     0                    41696.834790 88168.0059   111%     -   56s
H    0     0                    42431.149858 88168.0059   108%     -   56s
H    0     0                    42690.416156 88168.0059   107%     -   56s
H    0     0                    42757.064807 88168.0059   106%     -   56s
H    0     0                    42757.190038 88168.0059   106%     -   56s
     0     0 88168.0059    0  266 42757.1900 88168.0059   106%     -   57s
     0     0 87825.2674    0  262 42757.1900 87825.2674   105%     -   70s
     0     0 87695.3410    0  282 42757.1900 87695.3410   105%     -   77s
     0     0 87624.4162    0  280 42757.1900 87624.4162   105%     -   84s
     0     0 87585.6016    0  300 42757.1900 87585.6016   105%     -   87s
     0     0 87584.8334    0  300 42757.1900 87584.8334   105%     -   88s
     0     0 83760.1152    0  290 42757.1900 83760.1152  95.9%     -  124s
H    0     0                    49581.238417 83759.7204  68.9%     -  125s
H    0     0                    49939.888637 83759.7204  67.7%     -  125s
H    0     0                    51065.046762 83759.7204  64.0%     -  125s
H    0     0                    51549.600958 83759.7204  62.5%     -  126s
H    0     0                    51588.643702 83759.7204  62.4%     -  126s
H    0     0                    51721.670778 83759.7204  61.9%     -  126s
     0     0 83259.9776    0  301 51721.6708 83259.9776  61.0%     -  143s
     0     0 83160.6345    0  306 51721.6708 83160.6345  60.8%     -  152s
     0     0 83134.2875    0  306 51721.6708 83134.2875  60.7%     -  158s
     0     0 83088.2496    0  318 51721.6708 83088.2496  60.6%     -  166s
     0     0 83087.4263    0  341 51721.6708 83087.4263  60.6%     -  167s
     0     0 80859.9138    0  327 51721.6708 80859.9138  56.3%     -  220s
     0     0 80300.5170    0  398 51721.6708 80300.5170  55.3%     -  269s
     0     0 80060.4126    0  399 51721.6708 80060.4126  54.8%     -  286s
     0     0 79951.6701    0  390 51721.6708 79951.6701  54.6%     -  295s
     0     0 79875.3783    0  405 51721.6708 79875.3783  54.4%     -  303s
     0     0 79862.8500    0  406 51721.6708 79862.8500  54.4%     -  306s
     0     0 79857.2390    0  405 51721.6708 79857.2390  54.4%     -  307s
     0     0 79816.8808    0  410 51721.6708 79816.8808  54.3%     -  313s
     0     0 79737.3187    0  408 51721.6708 79737.3187  54.2%     -  323s
     0     0 79680.0285    0  390 51721.6708 79680.0285  54.1%     -  331s
     0     0 79640.7159    0  378 51721.6708 79640.7159  54.0%     -  335s
     0     0 79636.2573    0  378 51721.6708 79636.2573  54.0%     -  337s
     0     0 79632.6406    0  384 51721.6708 79632.6406  54.0%     -  339s
     0     0 79630.7484    0  381 51721.6708 79630.7484  54.0%     -  340s
H    0     0                    51834.138372 78640.7967  51.7%     -  401s
     0     0 78640.7967    0  338 51834.1384 78640.7967  51.7%     -  402s
H    0     0                    51892.472948 78640.6920  51.5%     -  404s
     0     0 78287.8472    0  392 51892.4729 78287.8472  50.9%     -  424s
     0     0 78226.4787    0  415 51892.4729 78226.4787  50.7%     -  436s
     0     0 78153.7131    0  396 51892.4729 78153.7131  50.6%     -  448s
     0     0 78105.8659    0  406 51892.4729 78105.8659  50.5%     -  455s
     0     0 78091.4872    0  407 51892.4729 78091.4872  50.5%     -  459s
     0     0 78078.9514    0  410 51892.4729 78078.9514  50.5%     -  463s
     0     0 78052.1233    0  410 51892.4729 78052.1233  50.4%     -  469s
     0     0 78047.5117    0  444 51892.4729 78047.5117  50.4%     -  471s
     0     0 78046.0126    0  441 51892.4729 78046.0126  50.4%     -  472s
     0     0 77775.3149    0  435 51892.4729 77775.3149  49.9%     -  489s
     0     0 77702.0404    0  412 51892.4729 77702.0404  49.7%     -  499s
     0     0 77677.4964    0  417 51892.4729 77677.4964  49.7%     -  506s
     0     0 77671.2224    0  419 51892.4729 77671.2224  49.7%     -  508s
     0     0 77666.7188    0  417 51892.4729 77666.7188  49.7%     -  510s
     0     0 77664.5965    0  412 51892.4729 77664.5965  49.7%     -  512s
     0     0 77569.6940    0  468 51892.4729 77569.6940  49.5%     -  524s
H    0     0                    53875.960277 77568.9772  44.0%     -  530s
     0     0 77540.3343    0  483 53875.9603 77540.3343  43.9%     -  534s
     0     0 77527.7204    0  477 53875.9603 77527.7204  43.9%     -  537s
     0     0 77518.0865    0  484 53875.9603 77518.0865  43.9%     -  539s
     0     0 77516.7734    0  460 53875.9603 77516.7734  43.9%     -  540s
     0     0 77473.5596    0  453 53875.9603 77473.5596  43.8%     -  550s
     0     0 77450.2186    0  485 53875.9603 77450.2186  43.8%     -  557s
     0     0 77438.0895    0  450 53875.9603 77438.0895  43.7%     -  560s
     0     0 77432.2389    0  450 53875.9603 77432.2389  43.7%     -  562s
     0     0 77429.8267    0  453 53875.9603 77429.8267  43.7%     -  563s
     0     0 77389.4745    0  460 53875.9603 77389.4745  43.6%     -  572s
H    0     0                    53953.295567 77389.1346  43.4%     -  575s
H    0     0                    54060.123880 77389.1346  43.2%     -  575s
     0     0 77375.8815    0  406 54060.1239 77375.8815  43.1%     -  580s
     0     0 77371.5805    0  441 54060.1239 77371.5805  43.1%     -  583s
     0     0 77369.0754    0  354 54060.1239 77369.0754  43.1%     -  585s
     0     0 77366.3707    0  355 54060.1239 77366.3707  43.1%     -  587s
H    0     0                    54061.528433 77365.2934  43.1%     -  588s
H    0     0                    54077.496122 77365.2934  43.1%     -  588s
     0     0 77360.7135    0  357 54077.4961 77360.7135  43.1%     -  590s
     0     0 77360.0184    0  357 54077.4961 77360.0184  43.1%     -  591s
     0     0 77356.1060    0  404 54077.4961 77356.1060  43.0%     -  595s
H    0     0                    54108.119815 77355.8016  43.0%     -  598s
H    0     0                    54124.975865 77355.8016  42.9%     -  599s
     0     0 77354.9517    0  452 54124.9759 77354.9517  42.9%     -  600s
     0     0 77352.5184    0  449 54124.9759 77352.5184  42.9%     -  603s
     0     0 77352.4602    0  449 54124.9759 77352.4602  42.9%     -  606s
H    0     0                    54218.469743 77352.2914  42.7%     -  664s
H    0     0                    54385.409834 77352.2914  42.2%     -  664s
H    0     0                    54804.988765 77352.2914  41.1%     -  723s
     0     2 77352.2914    0  449 54804.9888 77352.2914  41.1%     -  726s
     1     4 77280.7686    1  398 54804.9888 77349.2147  41.1%  3051  740s
     3     7 77229.1029    2  396 54804.9888 77279.0192  41.0%  4332  762s
     6    13 76958.8674    3  412 54804.9888 77221.8289  40.9%  6531  790s
    12    25 76768.2290    4  418 54804.9888 77077.3627  40.6%  8881  824s
    24    37 76129.5298    5  458 54804.9888 77075.9167  40.6% 13832  884s
    36    68 75644.9422    6  391 54804.9888 76981.2375  40.5% 12545 1001s
H   49    68                    54905.595950 76981.2375  40.2% 11453 1001s
    67   117 75612.9632    7  406 54905.5959 76981.2375  40.2% 12387 1063s
   116   149 75501.8840    8  400 54905.5959 76981.2375  40.2%  9660 1097s
   148   181 75304.4402    9  408 54905.5959 76981.2375  40.2%  9172 1133s
H  151   181                    54934.927552 76981.2375  40.1%  9002 1133s
H  177   181                    54938.213929 76981.2375  40.1%  8132 1133s
   180   311 75209.5954   10  393 54938.2139 76981.2375  40.1%  8058 1187s
   310   404 74623.6450   15  416 54938.2139 76981.2375  40.1%  6189 1223s
   403   460 74455.4930   20  423 54938.2139 76981.2375  40.1%  5568 1257s
   459   538 74213.3981   21  395 54938.2139 76981.2375  40.1%  5483 1288s
   537   615 74192.9566   23  397 54938.2139 76981.2375  40.1%  5164 1319s
   614   678 74078.7451   24  374 54938.2139 76981.2375  40.1%  4922 1351s
   677   740 73799.6192   26  393 54938.2139 76981.2375  40.1%  4828 1382s
   741   806 73457.5631   28  398 54938.2139 76981.2375  40.1%  4739 1414s
   817   866 73383.9699   30  398 54938.2139 76981.2375  40.1%  4587 1443s
   883   944 72726.7710   32  316 54938.2139 76981.2375  40.1%  4458 1471s
   961  1033 72569.2396   33  323 54938.2139 76981.2375  40.1%  4272 1502s
  1050  1070 72400.6156   34  317 54938.2139 76981.2375  40.1%  4091 1527s
H 1051  1070                    55009.928511 76981.2375  39.9%  4087 1527s
H 1058  1070                    55161.520101 76981.2375  39.6%  4063 1527s
  1087  1170 72307.4705   35  325 55161.5201 76981.2375  39.6%  4014 1557s
  1189  1284 71859.3596   40  306 55161.5201 76981.2375  39.6%  3873 1588s
  1311  1401 71721.1131   42  276 55161.5201 76981.2375  39.6%  3714 1620s
  1432  1543 70215.1089   45  299 55161.5201 76981.2375  39.6%  3609 1655s
  1576  1695 70133.6798   46  286 55161.5201 76981.2375  39.6%  3458 1688s
  1738  1801 69057.2061   49  295 55161.5201 76981.2375  39.6%  3284 1721s
  1892  1905 68535.2014   52  270 55161.5201 76981.2375  39.6%  3172 1757s
  2042  1983 67368.1090   53  240 55161.5201 76691.4450  39.0%  3070 1799s
  2167  2003 64209.2831   55  197 55161.5201 76652.1557  39.0%  3035 1835s
H 2169  2003                    55162.557553 76652.1557  39.0%  3040 1835s
  2207  2094 62423.0677   56  221 55162.5576 76652.1557  39.0%  3092 1880s
  2334  2173     cutoff   59      55162.5576 76652.1557  39.0%  3075 1926s
H 2461  2204                    55268.895295 76652.1557  38.7%  3055 1965s
H 2525  2204                    55275.824506 76652.1557  38.7%  3062 1965s
  2528  2229 56103.5708   65  153 55275.8245 76652.1557  38.7%  3065 2012s
  2593  2255 73251.4445   10  317 55275.8245 76637.4292  38.6%  3092 2058s
  2631  2283 72954.0573   11  325 55275.8245 76637.4292  38.6%  3134 2102s
  2677  2324 71668.9057   11  307 55275.8245 76579.8160  38.5%  3179 2145s
  2728  2372 69569.5783   13  346 55275.8245 76579.8160  38.5%  3236 2184s
H 2769  2372                    55314.049987 76579.8160  38.4%  3245 2185s
  2792  2468 69071.3885   14  281 55314.0500 76579.8160  38.4%  3272 2238s
H 2904  2527                    55324.352023 76545.4610  38.4%  3309 2283s
  2979  2692 67847.9250   16  273 55324.3520 76545.4610  38.4%  3322 2354s
  3152  2929 67392.1557   20  229 55324.3520 76545.4610  38.4%  3304 2406s
  3400  2930 70211.1234   46  449 55324.3520 76545.4610  38.4%  3225 2558s
  3402  2931 57100.9504  102  128 55324.3520 76545.4610  38.4%  3223 2569s
  3403  2932 63404.9504   26  340 55324.3520 76545.4610  38.4%  3222 2655s
  3404  2933 75274.8693   21  313 55324.3520 76545.4610  38.4%  3221 2712s
  3405  2933 71897.7122   12  432 55324.3520 76545.4610  38.4%  3221 2771s
  3406  2934 70804.1181   46  434 55324.3520 76545.4610  38.4%  3220 2807s
  3407  2935 74588.2824   18  401 55324.3520 76545.4610  38.4%  3219 2823s
  3408  2935 61395.6013   52  436 55324.3520 76545.4610  38.4%  3218 2830s
  3409  2936 67227.6948   19  439 55324.3520 76545.4610  38.4%  3217 2842s
  3410  2937 67712.4208   49  408 55324.3520 76545.4610  38.4%  3216 2847s
  3411  2937 59865.3556   31  437 55324.3520 76545.4610  38.4%  3215 2859s
  3412  2938 56212.1786   94  392 55324.3520 76545.4610  38.4%  3214 2864s
  3413  2939 73294.3985   12  402 55324.3520 76545.4610  38.4%  3213 2867s
  3414  2939 71353.7704   32  396 55324.3520 76545.4610  38.4%  3212 2870s
  3416  2941 64952.2299   16  398 55324.3520 76545.4610  38.4%  3210 2887s
  3417  2941 59997.3119   59  369 55324.3520 76545.4610  38.4%  3209 2891s
  3419  2943 55866.6682  107  392 55324.3520 76545.4610  38.4%  3207 2897s
  3420  2943 58933.4676   72  392 55324.3520 76545.4610  38.4%  3206 2901s
  3421  2944 70088.5319   35  360 55324.3520 76545.4610  38.4%  3205 2909s
  3422  2945 61767.3217   31  424 55324.3520 76545.4610  38.4%  3205 2911s
  3424  2946 57297.8657   63  417 55324.3520 76545.4610  38.4%  3203 2926s
  3425  2947 74544.0699   18  374 55324.3520 76545.4610  38.4%  3202 2931s
  3427  2948 71377.9258   28  373 55324.3520 76545.4610  38.4%  3200 2941s
  3429  2949 60227.9417   62  374 55324.3520 76545.4610  38.4%  3198 2948s
  3430  2950 60739.5211   36  361 55324.3520 76545.4610  38.4%  3197 2958s
  3431  2951 74597.0622   14  358 55324.3520 76545.4610  38.4%  3196 2964s
  3432  2951 71203.1772   34  354 55324.3520 76545.4610  38.4%  3195 2974s
  3433  2952 75209.3203   11  417 55324.3520 76545.4610  38.4%  3194 2979s
  3434  2953 72681.6045   22  415 55324.3520 76545.4610  38.4%  3193 2992s
  3435  2953 62183.7249   62  413 55324.3520 76545.4610  38.4%  3192 2995s
  3437  2955 70233.1303   40  364 55324.3520 76545.4610  38.4%  3191 3011s
  3438  2955 70872.6626   44  409 55324.3520 76545.4610  38.4%  3190 3018s
  3439  2956 72959.5453   15  409 55324.3520 76545.4610  38.4%  3189 3021s
  3440  2957 74688.5921   10  406 55324.3520 76545.4610  38.4%  3188 3027s
  3441  2957 67975.2557   19  406 55324.3520 76545.4610  38.4%  3187 3038s
  3442  2958 67454.3064   21  406 55324.3520 76545.4610  38.4%  3186 3115s
  3443  2962 76545.4610   13  351 55324.3520 76545.4610  38.4%  3254 3274s
  3445  2965 76545.4610   14  406 55324.3520 76545.4610  38.4%  3256 3327s
  3449  2972 76545.4610   15  482 55324.3520 76545.4610  38.4%  3266 3396s
  3457  2985 76319.8228   16  472 55324.3520 76545.4610  38.4%  3303 3480s
  3473  2994 73172.2441   17  435 55324.3520 76318.5493  37.9%  3380 3600s

Cutting planes:
  Learned: 1
  Gomory: 9
  Implied bound: 14
  Projected implied bound: 21
  MIR: 917
  Mixing: 3
  Flow cover: 1131
  RLT: 18
  Relax-and-lift: 243

Explored 3487 nodes (12475403 simplex iterations) in 3600.13 seconds (5621.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 55324.4 55314 55275.8 ... 54805

Time limit reached
Best objective 5.532435202337e+04, best bound 7.631854930121e+04, gap 37.9475%
  WARNING: Time limit reached. Using best solution found (gap: 37.95%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 55324.35, θ = 228403.38
  Upper Bound (UB) = 55324.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228403.38
  [DEBUG]   ✓ Scenario 0: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228403.38 ≤ Q = 228403.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7123a88
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf8edc578
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.398622e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 7001625.0090
Variable types: 365 continuous, 173 integer (173 binary)

Root relaxation: objective -1.859668e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -185966.76    0  129 7001625.01 -185966.76   103%     -    0s
H    0     0                    -150791.8516 -185966.76  23.3%     -    0s
H    0     0                    -150938.4033 -185726.45  23.0%     -    0s
     0     0 -165702.61    0   97 -150938.40 -165702.61  9.78%     -    0s
H    0     0                    -161479.5477 -165577.34  2.54%     -    0s
     0     0 -165525.39    0   87 -161479.55 -165525.39  2.51%     -    0s
H    0     0                    -162927.2483 -165525.39  1.59%     -    0s
     0     0 -164307.48    0   77 -162927.25 -164307.48  0.85%     -    0s
H    0     0                    -163343.4930 -164298.90  0.58%     -    0s
H    0     0                    -163622.1917 -164298.90  0.41%     -    0s
     0     0 -164298.90    0   76 -163622.19 -164298.90  0.41%     -    0s
     0     0 -164123.42    0   35 -163622.19 -164123.42  0.31%     -    0s
     0     0 -164064.72    0   35 -163622.19 -164064.72  0.27%     -    0s
     0     0 -164063.31    0   35 -163622.19 -164063.31  0.27%     -    0s
     0     0 -164029.79    0   36 -163622.19 -164029.79  0.25%     -    0s
     0     0 -164004.42    0   36 -163622.19 -164004.42  0.23%     -    0s
H    0     0                    -163686.5621 -164004.42  0.19%     -    0s
     0     0 -164004.42    0   85 -163686.56 -164004.42  0.19%     -    0s
     0     0 -164004.42    0   57 -163686.56 -164004.42  0.19%     -    0s
     0     0 -163987.16    0   33 -163686.56 -163987.16  0.18%     -    0s
     0     0 -163972.01    0   35 -163686.56 -163972.01  0.17%     -    0s
     0     0 -163891.72    0   11 -163686.56 -163891.72  0.13%     -    0s
H    0     0                    -163845.1915 -163890.67  0.03%     -    0s
     0     0 -163869.70    0   23 -163845.19 -163869.70  0.01%     -    0s
     0     0          -    0      -163845.19 -163861.33  0.01%     -    0s

Cutting planes:
  Gomory: 18
  Implied bound: 15
  MIR: 61
  Flow cover: 20
  RLT: 5

Explored 1 nodes (1055 simplex iterations) in 0.21 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -163845 -163687 -163622 ... 1.39862e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.638451914756e+05, best bound -1.638613331198e+05, gap 0.0099%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 216797.99
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -163845.19
  [DEBUG]   S×d_nominal = 380643.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380643.18 + -163845.19 = 216797.99
  [DEBUG]   Current θ from Master = 228403.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11605.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43718.95
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 1997.4048, Absolute Gap = 1997.4048, Relative Gap = 0.036104
  Not converged yet (gap = 1997.40 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0x665fda56
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.56s
Presolved: 90653 rows, 38830 columns, 550719 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -297282.7295
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.926e+06
 Factor NZ  : 8.519e+06 (roughly 120 MB of memory)
 Factor Ops : 1.467e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.63658682e+07  1.87834084e+08  1.38e+05 1.85e+01  8.60e+04     4s
   1  -1.23386627e+07  1.72367160e+08  9.67e+04 1.07e+02  5.96e+04     4s
   2  -6.47212234e+06  1.41578412e+08  4.93e+04 3.80e+01  3.14e+04     5s
   3  -1.34353690e+06  1.04451752e+08  5.47e+03 1.50e+00  3.97e+03     5s
   4  -6.87826103e+05  5.21296769e+07  6.89e+02 2.30e-01  6.95e+02     5s
   5  -5.34929248e+05  3.22843665e+07  2.97e+02 1.20e-01  3.45e+02     5s
   6  -3.30998938e+05  2.29020859e+07  1.03e+02 7.76e-02  1.86e+02     5s
   7  -2.61838184e+05  1.59747511e+07  5.44e+01 5.12e-02  1.18e+02     5s
   8  -1.74504144e+05  1.40327343e+07  2.25e+01 4.40e-02  9.34e+01     5s
   9  -1.25495320e+05  9.50930213e+06  1.32e+01 2.87e-02  6.15e+01     5s
  10  -8.17199250e+04  4.74354200e+06  8.10e+00 1.34e-02  3.02e+01     5s
  11  -1.39883227e+04  1.37606938e+06  1.51e+00 3.29e-03  8.44e+00     5s
  12   1.48224467e+04  6.15278448e+05  9.60e-01 1.50e-03  3.64e+00     5s
  13   2.86648775e+04  3.74490014e+05  7.21e-01 1.08e-03  2.09e+00     5s
  14   3.86872018e+04  2.96942740e+05  5.43e-01 8.69e-04  1.56e+00     5s
  15   4.38186121e+04  2.20094934e+05  4.66e-01 9.51e-04  1.07e+00     5s
  16   5.78605790e+04  1.78530178e+05  3.07e-01 1.41e-03  7.28e-01     5s
  17   6.64227366e+04  1.56329389e+05  2.34e-01 1.39e-03  5.42e-01     5s
  18   7.72854293e+04  1.39048446e+05  1.41e-01 1.73e-03  3.72e-01     6s
  19   8.13549455e+04  1.27795535e+05  1.09e-01 1.74e-03  2.80e-01     6s
  20   8.54378067e+04  1.17137059e+05  8.04e-02 1.45e-03  1.91e-01     6s
  21   8.68947152e+04  1.12188319e+05  6.93e-02 1.49e-03  1.53e-01     6s
  22   8.98908933e+04  1.08866967e+05  5.01e-02 1.09e-03  1.14e-01     6s
  23   9.17387386e+04  1.06073811e+05  3.87e-02 1.07e-03  8.64e-02     6s
  24   9.32307152e+04  1.03552304e+05  3.00e-02 6.45e-04  6.22e-02     6s
  25   9.35207138e+04  1.03092115e+05  2.84e-02 5.84e-04  5.77e-02     6s
  26   9.42320673e+04  1.02061861e+05  2.45e-02 4.38e-04  4.72e-02     6s
  27   9.55680691e+04  1.01542590e+05  1.72e-02 3.43e-04  3.60e-02     6s
  28   9.61367726e+04  1.01146697e+05  1.40e-02 2.84e-04  3.02e-02     6s
  29   9.71295321e+04  1.00685755e+05  8.57e-03 2.62e-04  2.14e-02     6s
  30   9.74282058e+04  1.00041983e+05  6.99e-03 1.75e-04  1.58e-02     6s
  31   9.78661193e+04  9.98222680e+04  4.72e-03 1.47e-04  1.18e-02     6s
  32   9.80817582e+04  9.95332317e+04  3.57e-03 1.02e-04  8.75e-03     7s
  33   9.82407461e+04  9.93554909e+04  2.80e-03 7.43e-05  6.72e-03     7s
  34   9.84492091e+04  9.93071566e+04  1.82e-03 6.71e-05  5.17e-03     7s
  35   9.85972904e+04  9.91011465e+04  1.13e-03 8.28e-05  3.04e-03     7s
  36   9.86771503e+04  9.90405326e+04  7.70e-04 5.98e-05  2.19e-03     7s
  37   9.87013315e+04  9.90055197e+04  6.64e-04 4.65e-05  1.83e-03     7s
  38   9.87430762e+04  9.89686312e+04  4.81e-04 3.44e-05  1.36e-03     7s
  39   9.87817226e+04  9.89412023e+04  3.14e-04 2.54e-05  9.60e-04     7s
  40   9.88346748e+04  9.88728248e+04  1.04e-04 9.16e-06  2.30e-04     7s
  41   9.88420409e+04  9.88714858e+04  7.66e-05 7.97e-06  1.77e-04     7s
  42   9.88592599e+04  9.88665995e+04  1.13e-05 3.69e-06  4.42e-05     7s
  43   9.88621573e+04  9.88631666e+04  2.16e-06 6.65e-07  6.08e-06     7s
  44   9.88628844e+04  9.88628888e+04  2.15e-08 9.08e-09  2.66e-08     8s
  45   9.88628885e+04  9.88628885e+04  5.29e-07 2.33e-08  2.91e-10     8s

Barrier solved model in 45 iterations and 7.61 seconds (7.55 work units)
Optimal objective 9.88628885e+04


Root crossover log...

   78974 DPushes remaining with DInf 0.0000000e+00                 8s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    2773 PPushes remaining with PInf 1.9107331e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.6429970e+02     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35379    9.8862889e+04   0.000000e+00   2.642997e+02     10s
   35424    9.8862889e+04   0.000000e+00   0.000000e+00     11s
   35424    9.8862889e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.886289e+04, 35424 iterations, 7.16 seconds (9.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 98862.8885    0  264 -223925.25 98862.8885   144%     -   11s
H    0     0                    -214602.8156 98862.8885   146%     -   11s
H    0     0                    -203566.4233 98862.8885   149%     -   11s
H    0     0                    -181464.4387 98862.8885   154%     -   12s
H    0     0                    -170940.4966 98862.8885   158%     -   12s
H    0     0                    -170462.7481 98862.8885   158%     -   12s
H    0     0                    -166665.3024 98862.8885   159%     -   12s
H    0     0                    -165461.2570 98862.8885   160%     -   12s
H    0     0                    -63728.40994 98862.8885   255%     -   12s
H    0     0                    39952.435582 98862.8885   147%     -   13s
H    0     0                    42543.747428 98862.8885   132%     -   14s
H    0     0                    42610.590271 98862.8885   132%     -   14s
H    0     0                    43319.390156 90767.9803   110%     -   74s
H    0     0                    43393.042258 90767.9803   109%     -   74s
H    0     0                    43608.385056 90767.9803   108%     -   74s
H    0     0                    43682.834826 90767.9803   108%     -   74s
     0     0 90684.1888    0  316 43682.8348 90684.1888   108%     -   74s
H    0     0                    43725.669027 90684.1888   107%     -   75s
     0     0 90270.6263    0  327 43725.6690 90270.6263   106%     -   98s
     0     0 90242.5045    0  336 43725.6690 90242.5045   106%     -  101s
     0     0 90242.5045    0  333 43725.6690 90242.5045   106%     -  104s
     0     0 90242.5045    0  333 43725.6690 90242.5045   106%     -  105s
     0     0 90242.5045    0  339 43725.6690 90242.5045   106%     -  110s
     0     0 90234.0640    0  338 43725.6690 90234.0640   106%     -  118s
     0     0 90231.8841    0  336 43725.6690 90231.8841   106%     -  119s
     0     0 90229.3301    0  344 43725.6690 90229.3301   106%     -  121s
     0     0 90229.3180    0  344 43725.6690 90229.3180   106%     -  121s
H    0     0                    43809.289096 86010.6689  96.3%     -  191s
H    0     0                    44091.114211 86010.6689  95.1%     -  191s
H    0     0                    44183.096024 86010.6689  94.7%     -  191s
     0     0 85822.7754    0  352 44183.0960 85822.7754  94.2%     -  191s
H    0     0                    45441.044998 85822.7754  88.9%     -  191s
H    0     0                    46351.966186 85822.7754  85.2%     -  192s
H    0     0                    46622.984013 85822.7754  84.1%     -  192s
H    0     0                    46742.558950 85822.7754  83.6%     -  192s
H    0     0                    46965.184025 85822.7754  82.7%     -  192s
H    0     0                    47062.386480 85822.7754  82.4%     -  192s
     0     0 85269.2143    0  418 47062.3865 85269.2143  81.2%     -  237s
     0     0 85053.7812    0  405 47062.3865 85053.7812  80.7%     -  258s
     0     0 84878.8835    0  402 47062.3865 84878.8835  80.4%     -  283s
     0     0 84824.2882    0  393 47062.3865 84824.2882  80.2%     -  298s
     0     0 84736.5990    0  410 47062.3865 84736.5990  80.1%     -  313s
     0     0 84561.1915    0  413 47062.3865 84561.1915  79.7%     -  338s
     0     0 84451.9319    0  411 47062.3865 84451.9319  79.4%     -  350s
     0     0 84434.3808    0  402 47062.3865 84434.3808  79.4%     -  356s
     0     0 84429.2019    0  407 47062.3865 84429.2019  79.4%     -  360s
     0     0 84426.1662    0  408 47062.3865 84426.1662  79.4%     -  365s
     0     0 84419.4657    0  406 47062.3865 84419.4657  79.4%     -  368s
     0     0 84415.4606    0  409 47062.3865 84415.4606  79.4%     -  369s
     0     0 84410.9922    0  416 47062.3865 84410.9922  79.4%     -  374s
     0     0 84408.8907    0  412 47062.3865 84408.8907  79.4%     -  377s
     0     0 84405.2574    0  412 47062.3865 84405.2574  79.3%     -  379s
     0     0 84403.9404    0  411 47062.3865 84403.9404  79.3%     -  381s
H    0     0                    51323.423287 81164.2924  58.1%     -  471s
H    0     0                    51423.118685 81164.2924  57.8%     -  471s
H    0     0                    51560.631660 81164.2924  57.4%     -  471s
     0     0 81164.2924    0  373 51560.6317 81164.2924  57.4%     -  471s
H    0     0                    51622.182398 81164.1935  57.2%     -  472s
H    0     0                    51666.520447 81164.1935  57.1%     -  472s
     0     0 80507.7711    0  435 51666.5204 80507.7711  55.8%     -  513s
     0     0 80319.0034    0  434 51666.5204 80319.0034  55.5%     -  537s
     0     0 80206.5448    0  433 51666.5204 80206.5448  55.2%     -  555s
     0     0 80167.2506    0  435 51666.5204 80167.2506  55.2%     -  568s
     0     0 80139.5371    0  434 51666.5204 80139.5371  55.1%     -  575s
     0     0 80089.3592    0  427 51666.5204 80089.3592  55.0%     -  586s
     0     0 80027.3144    0  430 51666.5204 80027.3144  54.9%     -  597s
     0     0 79993.6709    0  430 51666.5204 79993.6709  54.8%     -  606s
     0     0 79986.1458    0  439 51666.5204 79986.1458  54.8%     -  611s
     0     0 79979.0351    0  450 51666.5204 79979.0351  54.8%     -  614s
     0     0 79977.2141    0  446 51666.5204 79977.2141  54.8%     -  615s
     0     0 78697.0375    0  385 51666.5204 78697.0375  52.3%     -  669s
H    0     0                    51695.146065 78696.8809  52.2%     -  671s
H    0     0                    51796.839389 78696.8809  51.9%     -  671s
H    0     0                    51841.469802 78696.8809  51.8%     -  671s
H    0     0                    51879.530003 78696.8809  51.7%     -  671s
     0     0 78512.1108    0  381 51879.5300 78512.1108  51.3%     -  690s
     0     0 78446.5972    0  404 51879.5300 78446.5972  51.2%     -  702s
     0     0 78400.8408    0  403 51879.5300 78400.8408  51.1%     -  712s
     0     0 78380.5758    0  413 51879.5300 78380.5758  51.1%     -  719s
     0     0 78335.4646    0  394 51879.5300 78335.4646  51.0%     -  724s
     0     0 78323.6114    0  408 51879.5300 78323.6114  51.0%     -  728s
     0     0 78307.6508    0  410 51879.5300 78307.6508  50.9%     -  730s
     0     0 78291.9196    0  412 51879.5300 78291.9196  50.9%     -  733s
     0     0 78289.7488    0  414 51879.5300 78289.7488  50.9%     -  734s
     0     0 78017.2464    0  438 51879.5300 78017.2464  50.4%     -  757s
H    0     0                    51917.749203 77962.3497  50.2%     -  769s
     0     0 77962.3497    0  444 51917.7492 77962.3497  50.2%     -  769s
     0     0 77936.4050    0  465 51917.7492 77936.4050  50.1%     -  776s
     0     0 77927.6263    0  434 51917.7492 77927.6263  50.1%     -  779s
     0     0 77925.9675    0  434 51917.7492 77925.9675  50.1%     -  780s
     0     0 77709.7992    0  468 51917.7492 77709.7992  49.7%     -  799s
H    0     0                    51957.729545 77671.6949  49.5%     -  812s
     0     0 77671.6949    0  436 51957.7295 77671.6949  49.5%     -  812s
     0     0 77664.4729    0  446 51957.7295 77664.4729  49.5%     -  817s
     0     0 77656.8958    0  445 51957.7295 77656.8958  49.5%     -  821s
     0     0 77652.1022    0  486 51957.7295 77652.1022  49.5%     -  824s
     0     0 77646.1980    0  481 51957.7295 77646.1980  49.4%     -  828s
     0     0 77639.7634    0  447 51957.7295 77639.7634  49.4%     -  829s
     0     0 77639.1251    0  456 51957.7295 77639.1251  49.4%     -  830s
     0     0 77599.6134    0  470 51957.7295 77599.6134  49.4%     -  841s
     0     0 77592.6029    0  471 51957.7295 77592.6029  49.3%     -  847s
     0     0 77589.7443    0  468 51957.7295 77589.7443  49.3%     -  849s
     0     0 77562.2238    0  471 51957.7295 77562.2238  49.3%     -  855s
     0     0 77553.3010    0  471 51957.7295 77553.3010  49.3%     -  862s
     0     0 77542.6546    0  473 51957.7295 77542.6546  49.2%     -  866s
     0     0 77540.0948    0  474 51957.7295 77540.0948  49.2%     -  869s
     0     0 77488.4583    0  411 51957.7295 77488.4583  49.1%     -  879s
     0     0 77473.4157    0  414 51957.7295 77473.4157  49.1%     -  884s
     0     0 77462.2491    0  415 51957.7295 77462.2491  49.1%     -  890s
     0     0 77457.3086    0  446 51957.7295 77457.3086  49.1%     -  892s
     0     0 77453.3240    0  449 51957.7295 77453.3240  49.1%     -  895s
     0     0 77452.7376    0  446 51957.7295 77452.7376  49.1%     -  896s
     0     0 77438.3763    0  445 51957.7295 77438.3763  49.0%     -  906s
     0     0 77433.3218    0  448 51957.7295 77433.3218  49.0%     -  918s
     0     0 77431.4714    0  439 51957.7295 77431.4714  49.0%     -  923s
     0     0 77425.4729    0  439 51957.7295 77425.4729  49.0%     -  928s
     0     0 77424.4512    0  434 51957.7295 77424.4512  49.0%     -  930s
     0     0 77419.8404    0  436 51957.7295 77419.8404  49.0%     -  934s
     0     0 77419.7868    0  436 51957.7295 77419.7868  49.0%     -  938s
H    0     0                    52380.024428 77419.7819  47.8%     - 1032s
H    0     0                    52382.205389 77419.7819  47.8%     - 1100s
H    0     0                    53125.941368 77419.7819  45.7%     - 1105s
H    0     0                    53893.430981 77419.7819  43.7%     - 1138s
     0     2 77419.7819    0  436 53893.4310 77419.7819  43.7%     - 1141s
     1     3 77095.7139    1  418 53893.4310 77419.7819  43.7% 12999 1164s
     2     4 77307.2815    1  441 53893.4310 77307.2815  43.4%  7294 1176s
     3     6 76698.6289    2  400 53893.4310 77305.8179  43.4%  7429 1193s
     5    11 76492.2786    3  407 53893.4310 77305.8179  43.4%  8532 1230s
    10    21 76190.2627    4  395 53893.4310 77007.6449  42.9% 10724 1279s
    20    31 75257.9607    5  392 53893.4310 77007.3518  42.9% 15846 1363s
H   30    60                    54122.503503 76895.2260  42.1% 14862 1568s
H   34    60                    54174.096355 76895.2260  41.9% 14599 1568s
H   46    60                    54185.303666 76895.2260  41.9% 12402 1568s
H   47    60                    54293.460226 76895.2260  41.6% 12214 1568s
    59    92 75508.1557    5  421 54293.4602 76895.2260  41.6% 19287 1658s
    91   220 75461.6291    6  400 54293.4602 76895.2260  41.6% 15391 1741s
H  108   220                    54471.423015 76895.2260  41.2% 13580 1741s
   219   307 75151.7925    8  388 54471.4230 76895.2260  41.2%  9727 1785s
   306   372 75013.7415   11  367 54471.4230 76895.2260  41.2%  8298 1821s
   371   419 74937.0548   11  376 54471.4230 76895.2260  41.2%  7833 1857s
   418   448 74800.8183   12  361 54471.4230 76895.2260  41.2%  7731 1886s
   447   482 74684.1952   13  390 54471.4230 76895.2260  41.2%  7804 1919s
   481   511 74863.4159   12  366 54471.4230 76895.2260  41.2%  7692 1951s
   510   545 74515.4057   14  387 54471.4230 76895.2260  41.2%  7647 1979s
   544   579 73504.1290   15  377 54471.4230 76895.2260  41.2%  7627 2007s
   578   614 73399.4691   16  381 54471.4230 76895.2260  41.2%  7733 2030s
H  607   614                    54569.850953 76895.2260  40.9%  7746 2030s
   613   675 73372.8579   17  343 54569.8510 76895.2260  40.9%  7769 2063s
   674   725 73102.8804   18  367 54569.8510 76895.2260  40.9%  7752 2091s
   724   777 73165.9973   18  371 54569.8510 76895.2260  40.9%  7858 2118s
   776   807 73101.6037   19  369 54569.8510 76895.2260  40.9%  7946 2143s
   806   838 72238.8033   19  358 54569.8510 76895.2260  40.9%  8006 2174s
   837   870 73304.9934   18  345 54569.8510 76895.2260  40.9%  8034 2201s
H  846   870                    54609.732850 76895.2260  40.8%  8024 2201s
   869   930 72786.1485   19  372 54609.7328 76895.2260  40.8%  8079 2234s
   929   960 72861.6965   20  368 54609.7328 76895.2260  40.8%  8132 2262s
H  931   960                    54620.127923 76895.2260  40.8%  8135 2262s
   959  1036 72778.1507   21  366 54620.1279 76895.2260  40.8%  8161 2291s
  1035  1117 72048.6321   22  332 54620.1279 76895.2260  40.8%  8078 2322s
  1116  1154 71165.7272   24  364 54620.1279 76895.2260  40.8%  8019 2351s
  1153  1198 71040.8121   25  351 54620.1279 76895.2260  40.8%  7965 2380s
H 1155  1198                    54691.914182 76895.2260  40.6%  7961 2380s
H 1182  1198                    54784.043816 76895.2260  40.4%  7960 2380s
  1199  1278 70339.4204   27  346 54784.0438 76895.2260  40.4%  7995 2414s
  1289  1381 64998.7873   28  317 54784.0438 76895.2260  40.4%  7923 2450s
  1396  1488 70686.9628   45  289 54784.0438 76895.2260  40.4%  7824 2486s
  1517  1615 64868.4987   29  264 54784.0438 76895.2260  40.4%  7659 2530s
  1656  1752 69642.6758   28  343 54784.0438 76895.2260  40.4%  7428 2567s
  1793  1885 69424.1381   29  298 54784.0438 76895.2260  40.4%  7298 2611s
  1938  2047 59308.2460   32  305 54784.0438 76895.2260  40.4%  7182 2658s
  2106  2166 64386.8582   32  313 54784.0438 76895.2260  40.4%  7031 2706s
  2282  2227 58503.2957   34  237 54784.0438 76605.2918  39.8%  6853 2746s
H 2283  2227                    54874.515486 76605.2918  39.6%  6850 2746s
H 2309  2227                    54899.047335 76605.2918  39.5%  6827 2746s
  2357  2252 57947.7031   35  272 54899.0473 76605.2918  39.5%  6865 2799s
H 2366  2252                    54934.609389 76605.2918  39.4%  6860 2799s
  2396  2354 58431.9757   35  236 54934.6094 76605.2918  39.4%  6915 2852s
  2530  2458 57887.7039   36  268 54934.6094 76605.2918  39.4%  6958 2905s
  2680  2585 56721.8442   36  295 54934.6094 76605.2918  39.4%  6968 2957s
  2831  2687 55365.2040   36  240 54934.6094 76605.2918  39.4%  7014 3021s
  2975  2811 57215.2338   38  309 54934.6094 76605.2918  39.4%  7076 3079s
  3149  2842 57072.9936   39  308 54934.6094 76605.2918  39.4%  7104 3126s
  3182  2863 56778.0165   40  302 54934.6094 76605.2918  39.4%  7166 3169s
  3233  2933 56160.8633   39  260 54934.6094 76605.2918  39.4%  7211 3226s
H 3277  2933                    54971.799822 76605.2918  39.4%  7283 3226s
  3345  3087 56629.7359   40  266 54971.7998 76605.2918  39.4%  7251 3293s

Cutting planes:
  Learned: 2
  Gomory: 22
  Implied bound: 194
  MIR: 2870
  Flow cover: 2410
  RLT: 113
  Relax-and-lift: 806

Explored 3515 nodes (26125337 simplex iterations) in 3600.03 seconds (5860.36 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 54971.8 54934.6 54899 ... 54293.5

Time limit reached
Best objective 5.497179982166e+04, best bound 7.660529183662e+04, gap 39.3538%
  WARNING: Time limit reached. Using best solution found (gap: 39.35%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 54971.80, θ = 227886.37
  Upper Bound (UB) = 54971.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227886.37
  [DEBUG]   ✓ Scenario 0: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227886.37 ≤ Q = 227886.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227886.37 ≤ Q = 227886.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227886.37 ≤ Q = 227886.37 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4fcf643b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb0309bc5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-14, 2e+02]
Found heuristic solution: objective 1.394922e+13
Presolve removed 2560 rows and 1850 columns
Presolve time: 0.01s
Presolved: 533 rows, 539 columns, 1505 nonzeros
Found heuristic solution: objective 7014300.4459
Variable types: 366 continuous, 173 integer (173 binary)

Root relaxation: objective -1.856267e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -185626.70    0  122 7014300.45 -185626.70   103%     -    0s
H    0     0                    -146955.6358 -185626.70  26.3%     -    0s
H    0     0                    -147337.1004 -185626.70  26.0%     -    0s
H    0     0                    -147780.3412 -164434.47  11.3%     -    0s
     0     0 -164434.47    0  102 -147780.34 -164434.47  11.3%     -    0s
H    0     0                    -159312.0142 -164356.74  3.17%     -    0s
H    0     0                    -159620.5320 -164356.74  2.97%     -    0s
H    0     0                    -160623.9523 -164356.74  2.32%     -    0s
H    0     0                    -160907.4360 -164356.74  2.14%     -    0s
H    0     0                    -161166.7169 -164356.74  1.98%     -    0s
     0     0 -162672.43    0  108 -161166.72 -162672.43  0.93%     -    0s
     0     0 -162320.43    0   80 -161166.72 -162320.43  0.72%     -    0s
H    0     0                    -161327.9030 -162316.41  0.61%     -    0s
     0     0 -162217.36    0   78 -161327.90 -162217.36  0.55%     -    0s
     0     0 -162183.17    0   74 -161327.90 -162183.17  0.53%     -    0s
     0     0 -162182.32    0   74 -161327.90 -162182.32  0.53%     -    0s
H    0     0                    -161341.9160 -162174.51  0.52%     -    0s
H    0     0                    -161361.5345 -162174.51  0.50%     -    0s
H    0     0                    -161450.1596 -162174.51  0.45%     -    0s
     0     2 -162174.51    0   74 -161450.16 -162174.51  0.45%     -    0s

Cutting planes:
  Gomory: 57
  Implied bound: 3
  MIR: 169
  Flow cover: 8
  RLT: 8
  BQP: 1

Explored 986 nodes (5474 simplex iterations) in 0.31 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -161450 -161362 -161342 ... -146956
No other solutions better than -161450

Optimal solution found (tolerance 1.00e-04)
Best objective -1.614501596281e+05, best bound -1.614501596281e+05, gap 0.0000%
  Subproblem solved in 0.34s
  Worst-case operational profit (Z_SP) = 219105.75
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -161450.16
  [DEBUG]   S×d_nominal = 380555.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380555.91 + -161450.16 = 219105.75
  [DEBUG]   Current θ from Master = 227886.37
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8780.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 46191.18
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 1644.8526, Absolute Gap = 1644.8526, Relative Gap = 0.029922
  Not converged yet (gap = 1644.85 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0xf60db0cc
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 3.16s
Presolved: 99580 rows, 42487 columns, 602016 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -298918.8765
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.527e+06
 Factor NZ  : 9.980e+06 (roughly 140 MB of memory)
 Factor Ops : 1.829e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69057342e+07  2.04653298e+08  1.42e+05 1.77e+01  8.83e+04     5s
   1  -1.27815004e+07  1.89168385e+08  9.97e+04 1.05e+02  6.12e+04     5s
   2  -7.04055023e+06  1.55426401e+08  5.36e+04 3.98e+01  3.39e+04     5s
   3  -1.34442402e+06  1.15269402e+08  5.37e+03 1.92e+00  3.91e+03     6s
   4  -7.02344861e+05  5.70288921e+07  6.85e+02 1.61e-01  6.94e+02     6s
   5  -5.67362736e+05  3.76785220e+07  2.94e+02 9.16e-02  3.58e+02     6s
   6  -2.85994703e+05  2.66778007e+07  9.03e+01 6.09e-02  1.89e+02     6s
   7  -2.39132939e+05  1.78849460e+07  4.75e+01 3.86e-02  1.17e+02     6s
   8  -1.23824191e+05  1.29944481e+07  7.26e+00 2.73e-02  7.41e+01     6s
   9  -7.46456143e+04  5.04101247e+06  4.28e+00 1.02e-02  2.86e+01     6s
  10  -1.80279817e+04  1.72405283e+06  1.39e+00 3.19e-03  9.62e+00     6s
  11   2.09314912e+04  5.85505320e+05  6.50e-01 1.34e-03  3.11e+00     6s
  12   3.18130539e+04  4.17517377e+05  4.54e-01 8.73e-04  2.12e+00     6s
  13   4.39382485e+04  2.83372177e+05  2.87e-01 6.76e-04  1.32e+00     6s
  14   5.35639773e+04  2.29260826e+05  2.04e-01 8.78e-04  9.64e-01     6s
  15   5.86410361e+04  1.87475287e+05  1.72e-01 9.52e-04  7.07e-01     6s
  16   6.62359608e+04  1.63983820e+05  1.32e-01 1.37e-03  5.36e-01     6s
  17   7.55196248e+04  1.41365173e+05  8.84e-02 2.02e-03  3.61e-01     7s
  18   7.97366063e+04  1.28756466e+05  7.10e-02 1.95e-03  2.69e-01     7s
  19   8.44049740e+04  1.21892000e+05  5.25e-02 1.99e-03  2.06e-01     7s
  20   8.70299172e+04  1.15824064e+05  4.20e-02 1.24e-03  1.58e-01     7s
  21   8.87370133e+04  1.10673241e+05  3.54e-02 2.94e-03  1.20e-01     7s
  22   9.04492733e+04  1.09200134e+05  2.92e-02 2.71e-03  1.03e-01     7s
  23   9.32169905e+04  1.06279874e+05  1.93e-02 1.93e-03  7.17e-02     7s
  24   9.43424151e+04  1.03719428e+05  1.55e-02 1.25e-03  5.15e-02     7s
  25   9.54024157e+04  1.02720847e+05  1.20e-02 9.61e-04  4.02e-02     7s
  26   9.61023976e+04  1.02167007e+05  9.76e-03 7.70e-04  3.33e-02     7s
  27   9.65876324e+04  1.01557251e+05  8.18e-03 6.13e-04  2.73e-02     7s
  28   9.71437271e+04  1.01090764e+05  6.43e-03 4.82e-04  2.17e-02     7s
  29   9.79163743e+04  1.00695200e+05  4.14e-03 4.00e-04  1.52e-02     8s
  30   9.82921596e+04  1.00454486e+05  2.95e-03 3.29e-04  1.19e-02     8s
  31   9.84205113e+04  1.00261778e+05  2.58e-03 2.76e-04  1.01e-02     8s
  32   9.86590855e+04  9.98759228e+04  1.86e-03 1.97e-04  6.68e-03     8s
  33   9.88782724e+04  9.98284386e+04  1.22e-03 1.79e-04  5.21e-03     8s
  34   9.90355137e+04  9.96555714e+04  7.72e-04 1.38e-04  3.40e-03     8s
  35   9.90635872e+04  9.95200740e+04  6.99e-04 7.90e-05  2.50e-03     8s
  36   9.91099755e+04  9.95005010e+04  5.77e-04 6.97e-05  2.14e-03     8s
  37   9.91808832e+04  9.94547869e+04  3.84e-04 5.08e-05  1.50e-03     8s
  38   9.92443874e+04  9.94030215e+04  2.16e-04 2.89e-05  8.70e-04     9s
  39   9.92501763e+04  9.93915886e+04  2.02e-04 2.41e-05  7.76e-04     9s
  40   9.92665391e+04  9.93847806e+04  1.59e-04 2.13e-05  6.49e-04     9s
  41   9.92795956e+04  9.93824167e+04  1.27e-04 2.03e-05  5.64e-04     9s
  42   9.93020808e+04  9.93701203e+04  7.01e-05 1.53e-05  3.73e-04     9s
  43   9.93120686e+04  9.93441542e+04  4.56e-05 4.53e-06  1.76e-04     9s
  44   9.93237482e+04  9.93418541e+04  1.79e-05 3.66e-06  9.93e-05     9s
  45   9.93283964e+04  9.93381282e+04  8.14e-06 2.19e-06  5.34e-05     9s
  46   9.93286841e+04  9.93363042e+04  7.39e-06 1.51e-06  4.18e-05     9s
  47   9.93299020e+04  9.93354862e+04  4.93e-06 1.18e-06  3.06e-05     9s
  48   9.93303367e+04  9.93343404e+04  4.03e-06 7.60e-07  2.20e-05     9s
  49   9.93305734e+04  9.93333277e+04  3.49e-06 3.86e-07  1.51e-05    10s
  50   9.93320720e+04  9.93323877e+04  3.47e-07 3.94e-08  1.73e-06    10s
  51   9.93322359e+04  9.93323134e+04  4.34e-08 1.78e-08  4.24e-07    10s
  52   9.93322399e+04  9.93323090e+04  3.45e-08 1.64e-08  3.78e-07    10s
  53   9.93322482e+04  9.93322505e+04  6.02e-09 1.59e-10  1.24e-08    10s
  54   9.93322502e+04  9.93322502e+04  4.75e-08 1.63e-08  3.13e-11    10s

Barrier solved model in 54 iterations and 10.29 seconds (10.15 work units)
Optimal objective 9.93322502e+04


Root crossover log...

   83936 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    1579 PPushes remaining with PInf 2.0569095e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6760199e-01     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30578    9.9332250e+04   0.000000e+00   1.676020e-01     13s
   30579    9.9332250e+04   0.000000e+00   0.000000e+00     13s
   30579    9.9332250e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.933225e+04, 30579 iterations, 8.87 seconds (11.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99332.2502    0  298 -223925.25 99332.2502   144%     -   13s
H    0     0                    -217669.6954 99332.2502   146%     -   13s
H    0     0                    -63955.75624 99332.2502   255%     -   14s
H    0     0                    -63833.45616 99332.2502   256%     -   14s
H    0     0                    -48605.77229 99332.2502   304%     -   14s
H    0     0                    11126.990133 99332.2502   793%     -   15s
H    0     0                    15729.056312 99332.2502   532%     -   15s
H    0     0                    15947.635243 99332.2502   523%     -   15s
H    0     0                    18959.400854 99332.2502   424%     -   16s
H    0     0                    19166.676822 99332.2502   418%     -   16s
H    0     0                    19476.796154 99332.2502   410%     -   16s
H    0     0                    19608.514547 99332.2502   407%     -   16s
H    0     0                    19663.655620 99332.2502   405%     -   16s
H    0     0                    22979.190227 90553.8606   294%     -   67s
H    0     0                    24365.068589 90553.8606   272%     -   67s
H    0     0                    24366.009094 90553.8606   272%     -   67s
H    0     0                    24399.192590 90553.8606   271%     -   67s
     0     0 90553.8606    0  328 24399.1926 90553.8606   271%     -   68s
H    0     0                    24416.484389 90553.4663   271%     -   69s
H    0     0                    24435.445095 90553.4663   271%     -   69s
H    0     0                    24670.301635 90553.4663   267%     -   69s
H    0     0                    24672.350102 90553.4663   267%     -   70s
     0     0 89846.7804    0  374 24672.3501 89846.7804   264%     -   95s
     0     0 89721.3038    0  410 24672.3501 89721.3038   264%     -  106s
     0     0 89689.3540    0  396 24672.3501 89689.3540   264%     -  116s
     0     0 89689.3540    0  406 24672.3501 89689.3540   264%     -  119s
     0     0 89689.3540    0  396 24672.3501 89689.3540   264%     -  124s
     0     0 89689.3540    0  389 24672.3501 89689.3540   264%     -  126s
     0     0 89689.3540    0  394 24672.3501 89689.3540   264%     -  127s
H    0     0                    24819.498111 85509.3644   245%     -  203s
H    0     0                    24890.098740 85509.3644   244%     -  203s
H    0     0                    24909.133336 85509.3644   243%     -  203s
H    0     0                    25155.755319 85509.3644   240%     -  203s
H    0     0                    25318.359261 85509.3644   238%     -  203s
H    0     0                    25604.841464 85509.3644   234%     -  203s
     0     0 85509.3644    0  415 25604.8415 85509.3644   234%     -  203s
H    0     0                    29886.421653 85509.3348   186%     -  204s
H    0     0                    32512.199264 85509.3348   163%     -  204s
H    0     0                    32778.081963 85509.3348   161%     -  204s
H    0     0                    33775.880412 85509.3348   153%     -  204s
H    0     0                    33895.009013 85509.3348   152%     -  205s
     0     0 84693.7876    0  421 33895.0090 84693.7876   150%     -  288s
     0     0 84464.9907    0  430 33895.0090 84464.9907   149%     -  330s
     0     0 84404.6122    0  432 33895.0090 84404.6122   149%     -  347s
     0     0 84370.7419    0  431 33895.0090 84370.7419   149%     -  362s
     0     0 84361.8026    0  445 33895.0090 84361.8026   149%     -  369s
     0     0 84354.8773    0  449 33895.0090 84354.8773   149%     -  373s
     0     0 84343.6586    0  410 33895.0090 84343.6586   149%     -  380s
     0     0 84343.1509    0  440 33895.0090 84343.1509   149%     -  381s
H    0     0                    40874.066845 84343.1509   106%     -  400s
H    0     0                    41444.202787 84343.1509   104%     -  400s
H    0     0                    41621.452689 84343.1509   103%     -  400s
H    0     0                    47428.762429 81932.5592  72.7%     -  522s
H    0     0                    48405.905502 81932.5592  69.3%     -  522s
H    0     0                    49495.155861 81932.5592  65.5%     -  522s
H    0     0                    49984.335725 81932.5592  63.9%     -  522s
H    0     0                    50210.367684 81932.5592  63.2%     -  522s
H    0     0                    50320.201426 81932.5592  62.8%     -  522s
     0     0 81932.5592    0  431 50320.2014 81932.5592  62.8%     -  522s
H    0     0                    50728.472386 81932.5317  61.5%     -  523s
     0     0 81216.3686    0  459 50728.4724 81216.3686  60.1%     -  579s
H    0     0                    51147.612843 81043.7265  58.5%     -  609s
H    0     0                    51223.502124 81043.7265  58.2%     -  609s
H    0     0                    51246.773457 81043.7265  58.1%     -  609s
H    0     0                    51336.433647 81043.7265  57.9%     -  609s
H    0     0                    51365.576149 81043.7265  57.8%     -  609s
     0     0 81043.7265    0  469 51365.5761 81043.7265  57.8%     -  609s
     0     0 80942.0576    0  473 51365.5761 80942.0576  57.6%     -  631s
     0     0 80917.7946    0  481 51365.5761 80917.7946  57.5%     -  643s
     0     0 80879.2276    0  477 51365.5761 80879.2276  57.5%     -  657s
     0     0 80851.6729    0  479 51365.5761 80851.6729  57.4%     -  666s
     0     0 80828.4802    0  480 51365.5761 80828.4802  57.4%     -  676s
     0     0 80816.0002    0  484 51365.5761 80816.0002  57.3%     -  683s
     0     0 80807.9276    0  489 51365.5761 80807.9276  57.3%     -  691s
     0     0 80797.7049    0  486 51365.5761 80797.7049  57.3%     -  697s
     0     0 80788.6582    0  497 51365.5761 80788.6582  57.3%     -  705s
     0     0 80786.4544    0  505 51365.5761 80786.4544  57.3%     -  709s
     0     0 79312.8988    0  424 51365.5761 79312.8988  54.4%     -  814s
     0     0 78988.2175    0  449 51365.5761 78988.2175  53.8%     -  860s
     0     0 78884.4477    0  423 51365.5761 78884.4477  53.6%     -  884s
     0     0 78844.3254    0  421 51365.5761 78844.3254  53.5%     -  899s
     0     0 78838.3881    0  423 51365.5761 78838.3881  53.5%     -  904s
     0     0 78802.4494    0  436 51365.5761 78802.4494  53.4%     -  916s
     0     0 78786.0504    0  441 51365.5761 78786.0504  53.4%     -  922s
     0     0 78778.1978    0  444 51365.5761 78778.1978  53.4%     -  929s
     0     0 78777.2691    0  432 51365.5761 78777.2691  53.4%     -  931s
H    0     0                    51380.651822 78278.6505  52.4%     -  981s
H    0     0                    51542.679425 78278.6505  51.9%     -  981s
     0     0 78278.6505    0  457 51542.6794 78278.6505  51.9%     -  981s
H    0     0                    51590.962190 78278.4172  51.7%     -  981s
H    0     0                    51658.933180 78108.2575  51.2%     - 1007s
     0     0 78108.2575    0  434 51658.9332 78108.2575  51.2%     - 1007s
     0     0 78034.9405    0  413 51658.9332 78034.9405  51.1%     - 1019s
     0     0 77974.8450    0  435 51658.9332 77974.8450  50.9%     - 1031s
     0     0 77956.6199    0  434 51658.9332 77956.6199  50.9%     - 1038s
     0     0 77954.7637    0  435 51658.9332 77954.7637  50.9%     - 1041s
     0     0 77799.3912    0  426 51658.9332 77799.3912  50.6%     - 1066s
     0     0 77763.6459    0  469 51658.9332 77763.6459  50.5%     - 1083s
     0     0 77756.6164    0  475 51658.9332 77756.6164  50.5%     - 1090s
     0     0 77748.7165    0  496 51658.9332 77748.7165  50.5%     - 1096s
     0     0 77742.2756    0  484 51658.9332 77742.2756  50.5%     - 1100s
     0     0 77741.7317    0  479 51658.9332 77741.7317  50.5%     - 1101s
     0     0 77661.4390    0  442 51658.9332 77661.4390  50.3%     - 1119s
H    0     0                    51725.519989 77661.4297  50.1%     - 1121s
H    0     0                    51760.222550 77626.8964  50.0%     - 1131s
     0     0 77626.8964    0  424 51760.2226 77626.8964  50.0%     - 1131s
     0     0 77604.7491    0  429 51760.2226 77604.7491  49.9%     - 1140s
     0     0 77603.2209    0  423 51760.2226 77603.2209  49.9%     - 1143s
     0     0 77571.0200    0  477 51760.2226 77571.0200  49.9%     - 1158s
     0     0 77557.7931    0  464 51760.2226 77557.7931  49.8%     - 1166s
     0     0 77551.6667    0  466 51760.2226 77551.6667  49.8%     - 1170s
H    0     0                    51838.579030 77547.9795  49.6%     - 1175s
     0     0 77547.9795    0  464 51838.5790 77547.9795  49.6%     - 1175s
     0     0 77521.8257    0  437 51838.5790 77521.8257  49.5%     - 1189s
H    0     0                    51852.089762 77521.5037  49.5%     - 1190s
H    0     0                    52032.611369 77521.5037  49.0%     - 1190s
     0     0 77496.0506    0  463 52032.6114 77496.0506  48.9%     - 1200s
     0     0 77489.5139    0  481 52032.6114 77489.5139  48.9%     - 1204s
     0     0 77486.6625    0  437 52032.6114 77486.6625  48.9%     - 1207s
     0     0 77477.8061    0  458 52032.6114 77477.8061  48.9%     - 1216s
     0     0 77474.6768    0  467 52032.6114 77474.6768  48.9%     - 1226s
     0     0 77468.3910    0  423 52032.6114 77468.3910  48.9%     - 1230s
     0     0 77467.8707    0  431 52032.6114 77467.8707  48.9%     - 1233s
     0     0 77467.1091    0  472 52032.6114 77467.1091  48.9%     - 1237s
     0     0 77467.0965    0  472 52032.6114 77467.0965  48.9%     - 1241s
H    0     0                    52055.013037 77467.0965  48.8%     - 1363s
H    0     0                    52146.596488 77467.0965  48.6%     - 1460s
H    0     0                    52481.757535 77467.0965  47.6%     - 1464s
H    0     0                    52728.904243 77467.0965  46.9%     - 1468s
H    0     0                    53085.344289 77467.0965  45.9%     - 1468s
H    0     0                    53103.589425 77467.0965  45.9%     - 1468s
     0     2 77467.0965    0  472 53103.5894 77467.0965  45.9%     - 1469s
     1     3 77142.6768    1  420 53103.5894 77466.2087  45.9%  9389 1486s
     2     4 77331.5170    1  439 53103.5894 77331.5170  45.6%  5911 1499s
     3     6 76631.8932    2  480 53103.5894 77330.9585  45.6%  6387 1534s
     5    11 76066.6653    3  370 53103.5894 77330.9585  45.6% 10703 1566s
    10    21 75751.6009    4  424 53103.5894 77202.4377  45.4% 10452 1624s
    20    31 75462.1063    4  443 53103.5894 77202.0933  45.4% 18872 1709s
    22    31 75038.7215    5  466 53103.5894 77202.0933  45.4% 19277 1710s
H   30    61                    53458.373463 76843.5621  43.7% 17878 2084s
H   32    61                    53481.645782 76843.5621  43.7% 17672 2084s
H   32    61                    53667.022069 76843.5621  43.2% 17672 2084s
H   38    61                    54000.053196 76843.5621  42.3% 17250 2084s
H   40    61                    54249.473001 76843.5621  41.6% 17155 2084s
    60    93 74280.0513    5  405 54249.4730 76843.5621  41.6% 23149 2136s
    92   182 74264.4437    6  387 54249.4730 76843.5621  41.6% 20282 2281s
   181   256 74114.9006    9  422 54249.4730 76843.5621  41.6% 13406 2333s
   255   288 73946.3313   10  366 54249.4730 76843.5621  41.6% 11357 2372s
   287   323 73878.2219   11  402 54249.4730 76843.5621  41.6% 10814 2411s
   322   358 73648.0558   12  374 54249.4730 76843.5621  41.6% 10355 2449s
   357   392 73632.9295   13  413 54249.4730 76843.5621  41.6% 10154 2488s
H  373   392                    54316.881579 76843.5621  41.5% 10018 2488s
   391   447 73401.9181   14  344 54316.8816 76843.5621  41.5% 10066 2537s
   446   475 73157.5930   16  405 54316.8816 76843.5621  41.5%  9783 2574s
   474   508 72925.3061   17  368 54316.8816 76843.5621  41.5%  9735 2616s
   507   543 72712.9499   18  335 54316.8816 76843.5621  41.5%  9570 2650s
H  512   543                    54778.384057 76843.5621  40.3%  9514 2650s
   542   614 72634.2757   19  327 54778.3841 76843.5621  40.3%  9561 2687s
   613   682 72229.9781   21  311 54778.3841 76843.5621  40.3%  9483 2727s
   681   752 71920.5904   23  298 54778.3841 76843.5621  40.3%  9527 2760s
   751   807 71705.1270   26  287 54778.3841 76843.5621  40.3%  9430 2795s
   806   874 71436.1242   27  283 54778.3841 76843.5621  40.3%  9409 2829s
   873   943 71377.8499   28  280 54778.3841 76843.5621  40.3%  9359 2861s
   942  1024 70650.6290   30  268 54778.3841 76843.5621  40.3%  9318 2897s
  1023  1062 70300.8729   34  274 54778.3841 76843.5621  40.3%  9176 2922s
H 1030  1062                    54967.641514 76843.5621  39.8%  9144 2922s
  1061  1142 69943.3791   35  222 54967.6415 76843.5621  39.8%  9112 2959s
  1141  1230 68943.8527   37  216 54967.6415 76843.5621  39.8%  9089 2997s
  1235  1332 67442.8831   40  199 54967.6415 76843.5621  39.8%  8989 3038s
  1343  1425     cutoff   56      54967.6415 76843.5621  39.8%  8812 3077s
  1450  1522 67207.0827   43  191 54967.6415 76843.5621  39.8%  8633 3127s
  1567  1599 65723.6270   47  186 54967.6415 76843.5621  39.8%  8487 3172s
  1686  1663 61465.5750   54  147 54967.6415 76843.5621  39.8%  8306 3225s
  1800  1691 58680.4931   58  128 54967.6415 76843.5621  39.8%  8337 3281s
  1830  1716 58229.9801   59  132 54967.6415 76843.5621  39.8%  8529 3329s
  1863  1751 57289.1593   60  102 54967.6415 76843.5621  39.8%  8637 3381s
  1902  1784 57206.6596   61  104 54967.6415 76843.5621  39.8%  8784 3427s
  1941  1816 56723.3089   62   98 54967.6415 76843.5621  39.8%  8847 3474s
  1985  1846     cutoff   63      54967.6415 76843.5621  39.8%  8890 3522s
  2039  1871     cutoff   64      54967.6415 76731.5264  39.6%  8933 3580s
  2078  1892 56411.6128   65   91 54967.6415 76731.5264  39.6%  9054 3600s

Cutting planes:
  Gomory: 33
  Implied bound: 330
  MIR: 3047
  Flow cover: 2589
  RLT: 99
  Relax-and-lift: 992

Explored 2103 nodes (19664024 simplex iterations) in 3600.06 seconds (5490.17 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 54967.6 54778.4 54316.9 ... 53085.3

Time limit reached
Best objective 5.496764151370e+04, best bound 7.673152643037e+04, gap 39.5940%
  WARNING: Time limit reached. Using best solution found (gap: 39.59%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 54967.64, θ = 227795.83
  Upper Bound (UB) = 54967.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227795.83
  [DEBUG]   ✓ Scenario 0: θ = 227795.83 ≤ Q = 227795.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227795.83 ≤ Q = 227795.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227795.83 ≤ Q = 227795.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227795.83 ≤ Q = 227795.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227795.83 ≤ Q = 227795.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227795.83 ≤ Q = 227795.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227795.83 ≤ Q = 227795.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227795.83 ≤ Q = 227795.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227795.83 ≤ Q = 227795.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227795.83 ≤ Q = 227795.83 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227795.83 ≤ Q = 227795.83 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3da6c57e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3da6c57e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.400540e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 7028137.4293
Variable types: 365 continuous, 173 integer (173 binary)

Root relaxation: objective -1.862905e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -186290.51    0  127 7028137.43 -186290.51   103%     -    0s
H    0     0                    -150804.6983 -186290.51  23.5%     -    0s
H    0     0                    -152003.2162 -186290.51  22.6%     -    0s
H    0     0                    -164119.0180 -166190.78  1.26%     -    0s
     0     0 -166190.78    0   62 -164119.02 -166190.78  1.26%     -    0s
H    0     0                    -164446.1542 -166088.41  1.00%     -    0s
H    0     0                    -164735.6926 -166088.41  0.82%     -    0s
     0     0 -166088.41    0   52 -164735.69 -166088.41  0.82%     -    0s
     0     0 -166088.41    0   51 -164735.69 -166088.41  0.82%     -    0s
     0     0 -165235.34    0   55 -164735.69 -165235.34  0.30%     -    0s
     0     0 -165200.75    0   46 -164735.69 -165200.75  0.28%     -    0s
     0     0 -165182.32    0   44 -164735.69 -165182.32  0.27%     -    0s
     0     0 -165176.03    0   48 -164735.69 -165176.03  0.27%     -    0s
     0     0 -165173.10    0   47 -164735.69 -165173.10  0.27%     -    0s
     0     0 -164956.74    0   12 -164735.69 -164956.74  0.13%     -    0s
     0     0 -164950.53    0   11 -164735.69 -164950.53  0.13%     -    0s
H    0     0                    -164793.6655 -164937.29  0.09%     -    0s
     0     0 -164937.29    0   12 -164793.67 -164937.29  0.09%     -    0s
     0     0 -164856.05    0    7 -164793.67 -164856.05  0.04%     -    0s
     0     0 -164856.05    0   13 -164793.67 -164856.05  0.04%     -    0s
H    0     0                    -164798.4430 -164856.05  0.03%     -    0s
     0     0 -164843.07    0    2 -164798.44 -164843.07  0.03%     -    0s
H    0     0                    -164821.9344 -164835.52  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 2
  Flow cover: 7
  Relax-and-lift: 2

Explored 1 nodes (682 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -164822 -164798 -164794 ... 1.40054e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.648219344005e+05, best bound -1.648355170226e+05, gap 0.0082%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 215596.02
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -164821.93
  [DEBUG]   S×d_nominal = 380417.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380417.95 + -164821.93 = 215596.02
  [DEBUG]   Current θ from Master = 227795.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12199.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 42767.83
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 1640.6943, Absolute Gap = 1640.6943, Relative Gap = 0.029848
  Not converged yet (gap = 1640.69 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524543 nonzeros
Model fingerprint: 0x72e7e829
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 76356 rows and 30996 columns
Presolve time: 3.31s
Presolved: 108507 rows, 46144 columns, 653411 nonzeros
Variable types: 43885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -295311.5879
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.35s

Barrier statistics:
 Dense cols : 659
 AA' NZ     : 3.756e+06
 Factor NZ  : 9.083e+06 (roughly 140 MB of memory)
 Factor Ops : 1.738e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.74375388e+07  2.20472994e+08  1.47e+05 1.70e+01  9.05e+04     5s
   1  -1.32837140e+07  2.05064205e+08  1.03e+05 1.04e+02  6.28e+04     5s
   2  -7.38615080e+06  1.67636015e+08  5.63e+04 3.94e+01  3.54e+04     5s
   3  -1.29865374e+06  1.27273271e+08  4.84e+03 1.70e+00  3.58e+03     6s
   4  -7.22181106e+05  6.09676398e+07  6.51e+02 2.76e-01  6.66e+02     6s
   5  -6.20362782e+05  4.04486679e+07  2.86e+02 1.49e-01  3.50e+02     6s
   6  -3.54972084e+05  2.90471816e+07  9.52e+01 1.03e-01  1.91e+02     6s
   7  -2.57061497e+05  1.99262211e+07  4.43e+01 6.66e-02  1.18e+02     6s
   8  -1.81344631e+05  1.59137113e+07  1.76e+01 5.22e-02  8.68e+01     6s
   9  -8.63847834e+04  5.37734368e+06  4.95e+00 1.54e-02  2.82e+01     6s
  10  -4.03514041e+04  2.21436857e+06  2.37e+00 5.96e-03  1.15e+01     6s
  11   1.15215017e+04  1.10396995e+06  8.41e-01 2.71e-03  5.53e+00     6s
  12   2.27140761e+04  7.05042956e+05  6.44e-01 1.62e-03  3.45e+00     6s
  13   3.18698555e+04  4.61394306e+05  4.65e-01 7.22e-04  2.17e+00     6s
  14   4.52448493e+04  3.05893714e+05  2.66e-01 7.47e-04  1.31e+00     6s
  15   5.46534247e+04  2.26843570e+05  1.85e-01 7.30e-04  8.68e-01     7s
  16   6.28834902e+04  1.72093310e+05  1.30e-01 1.64e-03  5.51e-01     7s
  17   6.94584944e+04  1.56739037e+05  1.02e-01 1.39e-03  4.40e-01     7s
  18   7.49713194e+04  1.43615155e+05  8.02e-02 1.51e-03  3.46e-01     7s
  19   8.02355534e+04  1.26863663e+05  6.07e-02 2.11e-03  2.35e-01     7s
  20   8.51176626e+04  1.22596228e+05  4.36e-02 1.65e-03  1.89e-01     7s
  21   8.71344053e+04  1.17815412e+05  3.63e-02 1.25e-03  1.55e-01     7s
  22   8.91271996e+04  1.11901208e+05  2.94e-02 8.65e-04  1.15e-01     7s
  23   9.12197732e+04  1.08666337e+05  2.25e-02 6.56e-04  8.79e-02     7s
  24   9.27918141e+04  1.06193606e+05  1.76e-02 4.87e-04  6.76e-02     7s
  25   9.36627317e+04  1.05297398e+05  1.49e-02 4.26e-04  5.86e-02     7s
  26   9.40764030e+04  1.05039428e+05  1.37e-02 4.09e-04  5.53e-02     8s
  27   9.50985189e+04  1.03686314e+05  1.06e-02 3.07e-04  4.33e-02     8s
  28   9.59818733e+04  1.03197310e+05  8.00e-03 2.75e-04  3.64e-02     8s
  29   9.63545554e+04  1.01592048e+05  6.94e-03 1.66e-04  2.64e-02     8s
  30   9.67740151e+04  1.01152020e+05  5.77e-03 1.38e-04  2.21e-02     8s
  31   9.71916431e+04  1.00555544e+05  4.59e-03 1.14e-04  1.70e-02     8s
  32   9.74897504e+04  1.00198902e+05  3.76e-03 1.11e-04  1.37e-02     8s
  33   9.78959834e+04  9.99902665e+04  2.71e-03 9.20e-05  1.06e-02     8s
  34   9.80708079e+04  9.97715981e+04  2.23e-03 9.60e-05  8.57e-03     9s
  35   9.83578051e+04  9.96144871e+04  1.50e-03 7.64e-05  6.33e-03     9s
  36   9.84978579e+04  9.94112154e+04  1.12e-03 5.55e-05  4.60e-03     9s
  37   9.85640040e+04  9.92163777e+04  9.54e-04 2.75e-05  3.29e-03     9s
  38   9.87296885e+04  9.91896826e+04  5.55e-04 2.57e-05  2.32e-03     9s
  39   9.87852290e+04  9.91192099e+04  4.16e-04 1.93e-05  1.68e-03     9s
  40   9.88242557e+04  9.90541160e+04  3.22e-04 1.09e-05  1.16e-03     9s
  41   9.88749943e+04  9.90290155e+04  2.01e-04 7.74e-06  7.76e-04     9s
  42   9.89000960e+04  9.90120693e+04  1.41e-04 5.62e-06  5.64e-04     9s
  43   9.89086272e+04  9.90094561e+04  1.21e-04 5.30e-06  5.08e-04    10s
  44   9.89261066e+04  9.90060822e+04  8.35e-05 4.87e-06  4.03e-04    10s
  45   9.89400082e+04  9.90046071e+04  5.22e-05 4.70e-06  3.25e-04    10s
  46   9.89444252e+04  9.89837786e+04  4.26e-05 2.18e-06  1.98e-04    10s
  47   9.89583532e+04  9.89806441e+04  1.28e-05 1.81e-06  1.12e-04    10s
  48   9.89600199e+04  9.89786074e+04  9.51e-06 1.56e-06  9.36e-05    10s
  49   9.89611817e+04  9.89743510e+04  7.33e-06 1.03e-06  6.63e-05    10s
  50   9.89616070e+04  9.89702764e+04  6.53e-06 5.62e-07  4.37e-05    10s
  51   9.89629916e+04  9.89685319e+04  4.09e-06 3.55e-07  2.79e-05    11s
  52   9.89638051e+04  9.89673623e+04  2.73e-06 2.22e-07  1.79e-05    11s
  53   9.89640580e+04  9.89672094e+04  2.31e-06 2.04e-07  1.59e-05    11s
  54   9.89643262e+04  9.89666308e+04  1.84e-06 1.36e-07  1.16e-05    11s
  55   9.89653209e+04  9.89656723e+04  1.24e-07 2.39e-08  1.77e-06    11s
  56   9.89654293e+04  9.89654425e+04  1.20e-08 1.53e-09  6.67e-08    11s
  57   9.89654399e+04  9.89654418e+04  5.92e-08 3.97e-08  9.64e-09    11s
  58   9.89654418e+04  9.89654418e+04  1.38e-08 2.61e-10  4.88e-11    11s

Barrier solved model in 58 iterations and 11.46 seconds (10.85 work units)
Optimal objective 9.89654418e+04


Root crossover log...

   88925 DPushes remaining with DInf 0.0000000e+00                12s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    2418 PPushes remaining with PInf 1.1116194e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1982265e-10     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32813    9.8965442e+04   0.000000e+00   0.000000e+00     15s
   32813    9.8965442e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.26s

Solved with barrier

Root relaxation: objective 9.896544e+04, 32813 iterations, 11.38 seconds (14.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 98965.4418    0  340 -223925.25 98965.4418   144%     -   16s
H    0     0                    -221025.1558 98965.4418   145%     -   16s
H    0     0                    -150141.1885 98965.4418   166%     -   17s
H    0     0                    -91541.83986 98965.4418   208%     -   17s
H    0     0                    -90760.66706 98965.4418   209%     -   17s
H    0     0                    -81864.80463 98965.4418   221%     -   17s
H    0     0                    -81851.40785 98965.4418   221%     -   17s
H    0     0                    -81108.63039 98965.4418   222%     -   17s
H    0     0                    -58065.84879 98965.4418   270%     -   17s
H    0     0                    16141.664955 98965.4418   513%     -   18s
H    0     0                    16376.818584 98965.4418   504%     -   19s
H    0     0                    20668.535715 98965.4418   379%     -   19s
H    0     0                    20737.613994 98965.4418   377%     -   19s
H    0     0                    20801.928990 98965.4418   376%     -   19s
H    0     0                    21241.500058 98965.4418   366%     -   19s
H    0     0                    21308.918729 98965.4418   364%     -   19s
H    0     0                    21427.547786 98965.4418   362%     -   19s
H    0     0                    21687.186108 98965.4418   356%     -   19s
H    0     0                    32758.072751 98965.4418   202%     -   22s
H    0     0                    33673.868146 98965.4418   194%     -   22s
H    0     0                    35276.114737 98965.4418   181%     -   22s
     0     0 90837.5509    0  370 35276.1147 90837.5509   158%     -   93s
H    0     0                    36446.360106 90837.5509   149%     -   95s
H    0     0                    37996.554210 90837.5509   139%     -   95s
H    0     0                    39455.064233 90837.5509   130%     -   95s
H    0     0                    39542.055913 90837.5509   130%     -   96s
H    0     0                    39607.525958 90837.5509   129%     -   96s
H    0     0                    39634.993758 90837.5509   129%     -   96s
     0     0 90150.6030    0  368 39634.9938 90150.6030   127%     -  138s
     0     0 90150.6030    0  381 39634.9938 90150.6030   127%     -  159s
     0     0 90150.6030    0  370 39634.9938 90150.6030   127%     -  167s
     0     0 90150.6030    0  365 39634.9938 90150.6030   127%     -  172s
     0     0 90150.6030    0  378 39634.9938 90150.6030   127%     -  179s
     0     0 90150.6030    0  372 39634.9938 90150.6030   127%     -  180s
     0     0 85942.8012    0  401 39634.9938 85942.8012   117%     -  250s
H    0     0                    47402.897329 85942.7873  81.3%     -  251s
H    0     0                    47548.467968 85942.7873  80.7%     -  252s
     0     0 84925.2169    0  462 47548.4680 84925.2169  78.6%     -  308s
     0     0 84683.8281    0  379 47548.4680 84683.8281  78.1%     -  334s
     0     0 84500.5122    0  377 47548.4680 84500.5122  77.7%     -  364s
     0     0 84444.2276    0  393 47548.4680 84444.2276  77.6%     -  380s
     0     0 84420.4587    0  417 47548.4680 84420.4587  77.5%     -  392s
     0     0 84382.3863    0  421 47548.4680 84382.3863  77.5%     -  410s
     0     0 84368.1387    0  421 47548.4680 84368.1387  77.4%     -  423s
     0     0 84361.2860    0  389 47548.4680 84361.2860  77.4%     -  432s
     0     0 84345.0072    0  396 47548.4680 84345.0072  77.4%     -  442s
     0     0 84342.8491    0  397 47548.4680 84342.8491  77.4%     -  447s
     0     0 84336.9537    0  390 47548.4680 84336.9537  77.4%     -  455s
     0     0 84336.0217    0  393 47548.4680 84336.0217  77.4%     -  459s
     0     0 81520.8785    0  397 47548.4680 81520.8785  71.4%     -  585s
     0     0 80891.1619    0  446 47548.4680 80891.1619  70.1%     -  652s
     0     0 80739.3065    0  402 47548.4680 80739.3065  69.8%     -  681s
H    0     0                    48390.556663 80653.6818  66.7%     -  709s
H    0     0                    51154.882534 80653.6818  57.7%     -  709s
H    0     0                    51180.698118 80653.6818  57.6%     -  709s
     0     0 80653.6818    0  418 51180.6981 80653.6818  57.6%     -  709s
     0     0 80565.7774    0  410 51180.6981 80565.7774  57.4%     -  734s
H    0     0                    51231.705464 80548.3971  57.2%     -  748s
     0     0 80548.3971    0  414 51231.7055 80548.3971  57.2%     -  748s
     0     0 80514.6786    0  427 51231.7055 80514.6786  57.2%     -  769s
     0     0 80495.1422    0  412 51231.7055 80495.1422  57.1%     -  783s
     0     0 80485.4056    0  416 51231.7055 80485.4056  57.1%     -  792s
     0     0 80480.1460    0  429 51231.7055 80480.1460  57.1%     -  799s
     0     0 80476.6904    0  414 51231.7055 80476.6904  57.1%     -  805s
     0     0 80457.1009    0  425 51231.7055 80457.1009  57.0%     -  821s
     0     0 80452.1641    0  414 51231.7055 80452.1641  57.0%     -  832s
     0     0 80450.5577    0  418 51231.7055 80450.5577  57.0%     -  838s
H    0     0                    51233.559232 79075.4707  54.3%     -  972s
H    0     0                    51348.618828 79075.4707  54.0%     -  972s
H    0     0                    51364.123227 79075.4707  54.0%     -  972s
H    0     0                    51792.342001 79075.4707  52.7%     -  972s
H    0     0                    51887.900721 79075.4707  52.4%     -  972s
H    0     0                    51959.936538 79075.4707  52.2%     -  972s
H    0     0                    52007.534741 79075.4707  52.0%     -  972s
     0     0 79075.4707    0  433 52007.5347 79075.4707  52.0%     -  972s
H    0     0                    52081.715043 79075.2434  51.8%     -  974s
     0     0 78762.6040    0  454 52081.7150 78762.6040  51.2%     - 1028s
     0     0 78662.5389    0  418 52081.7150 78662.5389  51.0%     - 1053s
     0     0 78568.4988    0  419 52081.7150 78568.4988  50.9%     - 1080s
     0     0 78534.4190    0  487 52081.7150 78534.4190  50.8%     - 1100s
     0     0 78505.3925    0  433 52081.7150 78505.3925  50.7%     - 1121s
     0     0 78492.2091    0  421 52081.7150 78492.2091  50.7%     - 1133s
     0     0 78458.9654    0  415 52081.7150 78458.9654  50.6%     - 1144s
     0     0 78455.0289    0  424 52081.7150 78455.0289  50.6%     - 1147s
     0     0 78452.3533    0  421 52081.7150 78452.3533  50.6%     - 1151s
     0     0 78206.1798    0  418 52081.7150 78206.1798  50.2%     - 1191s
H    0     0                    52082.917070 78206.1481  50.2%     - 1192s
H    0     0                    52102.874853 78206.1481  50.1%     - 1192s
     0     0 78104.9549    0  457 52102.8749 78104.9549  49.9%     - 1218s
     0     0 78017.9813    0  460 52102.8749 78017.9813  49.7%     - 1244s
     0     0 77992.0480    0  438 52102.8749 77992.0480  49.7%     - 1254s
     0     0 77976.4846    0  467 52102.8749 77976.4846  49.7%     - 1264s
     0     0 77963.4883    0  434 52102.8749 77963.4883  49.6%     - 1271s
     0     0 77953.9122    0  472 52102.8749 77953.9122  49.6%     - 1279s
     0     0 77950.5918    0  464 52102.8749 77950.5918  49.6%     - 1283s
     0     0 77820.7042    0  435 52102.8749 77820.7042  49.4%     - 1312s
     0     0 77772.3372    0  436 52102.8749 77772.3372  49.3%     - 1333s
     0     0 77726.7161    0  475 52102.8749 77726.7161  49.2%     - 1349s
     0     0 77695.0132    0  464 52102.8749 77695.0132  49.1%     - 1368s
     0     0 77679.8401    0  479 52102.8749 77679.8401  49.1%     - 1379s
     0     0 77668.8216    0  471 52102.8749 77668.8216  49.1%     - 1385s
     0     0 77659.0597    0  432 52102.8749 77659.0597  49.0%     - 1390s
     0     0 77657.0678    0  431 52102.8749 77657.0678  49.0%     - 1394s
     0     0 77630.0989    0  478 52102.8749 77630.0989  49.0%     - 1407s
     0     0 77605.9730    0  508 52102.8749 77605.9730  48.9%     - 1419s
     0     0 77596.6834    0  519 52102.8749 77596.6834  48.9%     - 1425s
     0     0 77591.1141    0  514 52102.8749 77591.1141  48.9%     - 1429s
     0     0 77585.6643    0  484 52102.8749 77585.6643  48.9%     - 1434s
     0     0 77579.7973    0  471 52102.8749 77579.7973  48.9%     - 1438s
     0     0 77577.8055    0  466 52102.8749 77577.8055  48.9%     - 1442s
     0     0 77535.4430    0  434 52102.8749 77535.4430  48.8%     - 1461s
     0     0 77520.7527    0  462 52102.8749 77520.7527  48.8%     - 1479s
     0     0 77518.4664    0  465 52102.8749 77518.4664  48.8%     - 1483s
     0     0 77455.7793    0  431 52102.8749 77455.7793  48.7%     - 1509s
     0     0 77424.9816    0  440 52102.8749 77424.9816  48.6%     - 1524s
     0     0 77413.3083    0  453 52102.8749 77413.3083  48.6%     - 1531s
     0     0 77402.6231    0  481 52102.8749 77402.6231  48.6%     - 1540s
     0     0 77400.0046    0  480 52102.8749 77400.0046  48.6%     - 1543s
H    0     0                    52138.713374 77400.0046  48.5%     - 1545s
     0     0 77361.8600    0  477 52138.7134 77361.8600  48.4%     - 1559s
     0     0 77345.2373    0  484 52138.7134 77345.2373  48.3%     - 1576s
     0     0 77343.2621    0  483 52138.7134 77343.2621  48.3%     - 1581s
     0     0 77337.3655    0  426 52138.7134 77337.3655  48.3%     - 1590s
     0     0 77334.2195    0  431 52138.7134 77334.2195  48.3%     - 1594s
     0     0 77311.1002    0  435 52138.7134 77311.1002  48.3%     - 1606s
H    0     0                    52167.518524 77310.5398  48.2%     - 1653s
H    0     0                    52180.489811 77310.5398  48.2%     - 1656s
     0     0 77287.7861    0  422 52180.4898 77287.7861  48.1%     - 1665s
     0     0 77283.8459    0  458 52180.4898 77283.8459  48.1%     - 1669s
     0     0 77281.6132    0  464 52180.4898 77281.6132  48.1%     - 1673s
     0     0 77279.7158    0  453 52180.4898 77279.7158  48.1%     - 1678s
     0     0 77279.7059    0  453 52180.4898 77279.7059  48.1%     - 1682s
     0     2 77279.3817    0  453 52180.4898 77279.3817  48.1%     - 1868s
     1     3 77004.9432    1  360 52180.4898 77279.3559  48.1%  9630 1885s
     2     4 77173.6818    1  409 52180.4898 77173.6818  47.9%  8513 1900s
     3     6 77107.5747    2  454 52180.4898 77171.9562  47.9%  7634 1931s
     5    11 76475.4645    3  410 52180.4898 77171.9562  47.9% 10985 1964s
    10    21 75910.0325    4  395 52180.4898 76943.2754  47.5% 12495 2021s
    20    31 75069.1718    4  444 52180.4898 76941.7367  47.5% 20620 2174s
    30    61 74999.7444    6  412 52180.4898 76561.0931  46.7% 20015 2497s
H   32    61                    52186.172884 76561.0931  46.7% 19040 2497s
H   34    61                    52339.182369 76561.0931  46.3% 18512 2497s
H   35    61                    52342.251528 76561.0931  46.3% 18070 2497s
H   49    61                    52388.726078 76561.0931  46.1% 14972 2497s
    60    93 74958.0702    7  411 52388.7261 76561.0931  46.1% 23685 2543s
    92   170 74894.1125    8  412 52388.7261 76561.0931  46.1% 20166 2753s
   169   224 74765.5962   11  418 52388.7261 76561.0931  46.1% 14613 2818s
   223   247 74967.5765   10  393 52388.7261 76561.0931  46.1% 13100 2875s
   246   285 74292.3701   13  389 52388.7261 76561.0931  46.1% 12984 2931s
H  254   285                    52519.688827 76561.0931  45.8% 12932 2931s
   284   313 74150.4527   14  436 52519.6888 76561.0931  45.8% 12459 2985s
   312   349 74127.2970   15  427 52519.6888 76561.0931  45.8% 13224 3051s
   348   396 74054.4424   16  420 52519.6888 76561.0931  45.8% 12842 3109s
   395   445 73991.6327   17  346 52519.6888 76561.0931  45.8% 12810 3166s
   444   479 73973.5074   18  418 52519.6888 76561.0931  45.8% 12206 3224s
   478   516 73949.9041   19  430 52519.6888 76561.0931  45.8% 11954 3269s
   515   558 73152.4097   20  331 52519.6888 76561.0931  45.8% 11853 3321s
   557   606 73139.5258   21  384 52519.6888 76561.0931  45.8% 11928 3365s
H  567   606                    52605.805526 76561.0931  45.5% 11874 3365s
H  574   606                    52797.127031 76561.0931  45.0% 11912 3365s
H  605   635                    53474.960904 76561.0931  43.2% 11722 3407s
H  612   635                    53494.516581 76561.0931  43.1% 11654 3407s
H  623   635                    53813.856753 76561.0931  42.3% 11659 3407s
   634   703 72944.9034   23  371 53813.8568 76561.0931  42.3% 11688 3452s
   702   779 72787.6338   24  372 53813.8568 76561.0931  42.3% 11436 3503s
   778   829 72774.2306   26  393 53813.8568 76561.0931  42.3% 11222 3553s
   832   899 72489.3750   29  337 53813.8568 76561.0931  42.3% 11095 3598s
   902   903 54742.7180   37  289 53813.8568 76561.0931  42.3% 10766 3600s

Cutting planes:
  Learned: 6
  Gomory: 17
  Implied bound: 311
  MIR: 3306
  Flow cover: 2776
  RLT: 147
  Relax-and-lift: 1143

Explored 906 nodes (10478407 simplex iterations) in 3600.04 seconds (4840.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53813.9 53494.5 53475 ... 52186.2

Time limit reached
Best objective 5.381385675346e+04, best bound 7.656109311940e+04, gap 42.2702%
  WARNING: Time limit reached. Using best solution found (gap: 42.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 53813.86, θ = 226940.68
  Upper Bound (UB) = 53813.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226940.68
  [DEBUG]   ✓ Scenario 0: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226940.68 ≤ Q = 226940.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226940.68 ≤ Q = 226940.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 226940.68 ≤ Q = 226940.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xc363ed5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0c363ed5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.412534e+13
Presolve removed 2561 rows and 1851 columns
Presolve time: 0.01s
Presolved: 532 rows, 538 columns, 1505 nonzeros
Found heuristic solution: objective 6954171.9263
Variable types: 365 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6953955.4528

Root relaxation: objective -1.882402e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -188240.17    0  130 6953955.45 -188240.17   103%     -    0s
H    0     0                    -152549.0155 -188240.17  23.4%     -    0s
H    0     0                    -152765.4891 -188240.17  23.2%     -    0s
H    0     0                    -153612.0049 -188240.17  22.5%     -    0s
H    0     0                    -153828.4785 -188240.17  22.4%     -    0s
H    0     0                    -154178.1756 -188023.14  22.0%     -    0s
H    0     0                    -154394.6492 -188023.14  21.8%     -    0s
     0     0 -166254.07    0   72 -154394.65 -166254.07  7.68%     -    0s
H    0     0                    -163189.1353 -166122.18  1.80%     -    0s
H    0     0                    -163516.2715 -166122.18  1.59%     -    0s
H    0     0                    -164003.5860 -166122.18  1.29%     -    0s
H    0     0                    -164330.7222 -166122.18  1.09%     -    0s
     0     0 -165762.82    0   56 -164330.72 -165762.82  0.87%     -    0s
     0     0 -165277.74    0   40 -164330.72 -165277.74  0.58%     -    0s
     0     0 -165238.56    0   40 -164330.72 -165238.56  0.55%     -    0s
     0     0 -164974.57    0   93 -164330.72 -164974.57  0.39%     -    0s
     0     0 -164951.08    0   41 -164330.72 -164951.08  0.38%     -    0s
     0     0 -164929.87    0   41 -164330.72 -164929.87  0.36%     -    0s
     0     0 -164923.92    0   41 -164330.72 -164923.92  0.36%     -    0s
     0     0 -164891.30    0   71 -164330.72 -164891.30  0.34%     -    0s
     0     0 -164885.69    0   71 -164330.72 -164885.69  0.34%     -    0s
     0     0 -164885.17    0   67 -164330.72 -164885.17  0.34%     -    0s
     0     2 -164879.79    0   67 -164330.72 -164879.79  0.33%     -    0s
H   59    29                    -164547.0681 -164581.96  0.02%  12.2    0s

Cutting planes:
  Gomory: 47
  Implied bound: 4
  MIR: 123
  Flow cover: 14
  RLT: 40

Explored 96 nodes (1449 simplex iterations) in 0.24 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -164547 -164331 -164004 ... 6.95396e+06
No other solutions better than -164547

Optimal solution found (tolerance 1.00e-04)
Best objective -1.645470681258e+05, best bound -1.645470681258e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 216987.39
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -164547.07
  [DEBUG]   S×d_nominal = 381534.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 381534.46 + -164547.07 = 216987.39
  [DEBUG]   Current θ from Master = 226940.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9953.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43860.57
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 486.9095, Absolute Gap = 486.9095, Relative Gap = 0.009048
  Not converged yet (gap = 486.91 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567795 nonzeros
Model fingerprint: 0xf5d21e54
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82719 rows and 33579 columns
Presolve time: 3.65s
Presolved: 117434 rows, 49801 columns, 705036 nonzeros
Variable types: 47542 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -297481.7992
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 662
 AA' NZ     : 4.196e+06
 Factor NZ  : 1.144e+07 (roughly 160 MB of memory)
 Factor Ops : 4.121e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78470862e+07  2.36128970e+08  1.50e+05 1.63e+01  9.21e+04     6s
   1  -1.36589798e+07  2.20567941e+08  1.06e+05 1.04e+02  6.40e+04     6s
   2  -7.74871749e+06  1.79762765e+08  5.89e+04 3.95e+01  3.68e+04     6s
   3  -1.41856834e+06  1.39974100e+08  5.18e+03 2.99e+00  3.79e+03     6s
   4  -7.74512714e+05  6.32926360e+07  7.09e+02 4.16e-01  6.82e+02     6s
   5  -6.76542777e+05  4.28107345e+07  3.04e+02 2.49e-01  3.54e+02     6s
   6  -4.13169586e+05  3.23182582e+07  6.47e+01 1.78e-01  1.82e+02     6s
   7  -3.08002371e+05  2.28642041e+07  3.47e+01 1.21e-01  1.21e+02     6s
   8  -1.75796601e+05  1.61518022e+07  8.47e+00 8.31e-02  7.86e+01     7s
   9  -7.78547889e+04  3.57036774e+06  2.96e+00 1.62e-02  1.72e+01     7s
  10  -3.57537956e+04  1.63463201e+06  1.72e+00 7.20e-03  7.85e+00     7s
  11   1.18224856e+04  8.26427224e+05  8.33e-01 3.02e-03  3.81e+00     7s
  12   2.55203220e+04  4.82201953e+05  5.91e-01 1.65e-03  2.14e+00     7s
  13   3.80849095e+04  3.22016488e+05  3.99e-01 1.15e-03  1.33e+00     7s
  14   5.67566745e+04  2.32082861e+05  1.86e-01 1.30e-03  8.18e-01     7s
  15   6.12151291e+04  1.91945843e+05  1.56e-01 9.88e-04  6.10e-01     7s
  16   6.97872571e+04  1.59158158e+05  1.11e-01 1.80e-03  4.17e-01     7s
  17   7.73258569e+04  1.39885597e+05  7.89e-02 2.12e-03  2.92e-01     7s
  18   7.98459377e+04  1.32233261e+05  6.84e-02 1.57e-03  2.44e-01     8s
  19   8.53557353e+04  1.23121974e+05  4.68e-02 1.52e-03  1.76e-01     8s
  20   8.76199625e+04  1.18575328e+05  3.81e-02 1.27e-03  1.44e-01     8s
  21   8.96527885e+04  1.14098779e+05  3.03e-02 9.69e-04  1.14e-01     8s
  22   9.21236267e+04  1.10629061e+05  2.12e-02 7.50e-04  8.63e-02     8s
  23   9.32131962e+04  1.05989156e+05  1.73e-02 5.02e-04  5.96e-02     8s
  24   9.44645692e+04  1.04794028e+05  1.33e-02 4.55e-04  4.82e-02     8s
  25   9.47711770e+04  1.03235137e+05  1.23e-02 3.26e-04  3.95e-02     9s
  26   9.56094712e+04  1.02932049e+05  9.80e-03 3.02e-04  3.41e-02     9s
  27   9.64691788e+04  1.02029709e+05  7.18e-03 2.16e-04  2.59e-02     9s
  28   9.69172539e+04  1.01342286e+05  5.84e-03 1.58e-04  2.06e-02     9s
  29   9.72361082e+04  1.00991645e+05  4.94e-03 1.34e-04  1.75e-02     9s
  30   9.74811033e+04  1.00433779e+05  4.21e-03 1.28e-04  1.38e-02     9s
  31   9.77437294e+04  1.00022578e+05  3.43e-03 1.03e-04  1.06e-02     9s
  32   9.81084188e+04  9.97406466e+04  2.38e-03 7.70e-05  7.61e-03    10s
  33   9.82754232e+04  9.96005545e+04  1.91e-03 6.24e-05  6.18e-03    10s
  34   9.83950655e+04  9.94021287e+04  1.58e-03 7.99e-05  4.70e-03    10s
  35   9.84727514e+04  9.93013409e+04  1.37e-03 5.90e-05  3.86e-03    10s
  36   9.86729824e+04  9.92063419e+04  8.36e-04 3.97e-05  2.49e-03    10s
  37   9.87748038e+04  9.91300239e+04  5.71e-04 2.38e-05  1.66e-03    10s
  38   9.88633472e+04  9.90995551e+04  3.46e-04 1.75e-05  1.10e-03    10s
  39   9.88943487e+04  9.90737750e+04  2.70e-04 1.23e-05  8.37e-04    11s
  40   9.89356331e+04  9.90552176e+04  1.68e-04 8.71e-06  5.58e-04    11s
  41   9.89462736e+04  9.90238993e+04  1.43e-04 6.32e-06  3.62e-04    11s
  42   9.89704259e+04  9.90193126e+04  8.47e-05 6.63e-06  2.28e-04    11s
  43   9.89853663e+04  9.90165259e+04  5.05e-05 4.74e-06  1.45e-04    11s
  44   9.89884368e+04  9.90144199e+04  4.35e-05 3.46e-06  1.21e-04    11s
  45   9.89923701e+04  9.90134714e+04  3.51e-05 2.80e-06  9.84e-05    11s
  46   9.89975632e+04  9.90117591e+04  2.36e-05 1.74e-06  6.62e-05    12s
  47   9.90037855e+04  9.90109971e+04  1.06e-05 1.23e-06  3.36e-05    12s
  48   9.90043010e+04  9.90100026e+04  9.49e-06 6.39e-07  2.66e-05    12s
  49   9.90066126e+04  9.90094751e+04  4.77e-06 3.06e-07  1.33e-05    12s
  50   9.90071743e+04  9.90092847e+04  3.63e-06 1.91e-07  9.84e-06    12s
  51   9.90080167e+04  9.90091287e+04  1.85e-06 9.09e-08  5.19e-06    12s
  52   9.90082180e+04  9.90091203e+04  1.43e-06 8.61e-08  4.21e-06    12s
  53   9.90088561e+04  9.90090488e+04  1.97e-07 5.45e-08  8.98e-07    12s
  54   9.90089205e+04  9.90089650e+04  7.19e-08 2.24e-08  2.08e-07    13s
  55   9.90089570e+04  9.90089590e+04  3.60e-09 2.68e-10  9.38e-09    13s
  56   9.90089583e+04  9.90089583e+04  5.03e-09 5.70e-10  9.31e-11    13s

Barrier solved model in 56 iterations and 12.97 seconds (11.93 work units)
Optimal objective 9.90089583e+04


Root crossover log...

   98244 DPushes remaining with DInf 0.0000000e+00                13s
   15461 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    3244 PPushes remaining with PInf 1.2690959e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0976923e-10     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38555    9.9008958e+04   0.000000e+00   0.000000e+00     17s
   38555    9.9008958e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.83s

Solved with barrier

Root relaxation: objective 9.900896e+04, 38555 iterations, 13.50 seconds (15.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99008.9583    0  315 -223925.25 99008.9583   144%     -   18s
H    0     0                    -71032.72892 99008.9583   239%     -   19s
H    0     0                    -67348.99353 99008.9583   247%     -   19s
H    0     0                    -67161.18791 99008.9583   247%     -   19s
H    0     0                    -66767.88964 99008.9583   248%     -   19s
H    0     0                    -55348.21875 99008.9583   279%     -   20s
H    0     0                    11926.699182 99008.9583   730%     -   20s
H    0     0                    31017.265223 99008.9583   219%     -   20s
H    0     0                    31089.731939 99008.9583   218%     -   20s
H    0     0                    31210.961899 99008.9583   217%     -   21s
H    0     0                    31315.763898 99008.9583   216%     -   21s
H    0     0                    37751.932510 91415.2249   142%     -   98s
H    0     0                    39380.880154 91415.2249   132%     -   99s
H    0     0                    41615.749093 91415.2249   120%     -   99s
H    0     0                    42570.560606 91415.2249   115%     -   99s
H    0     0                    42893.252216 91415.2249   113%     -   99s
     0     0 91375.2235    0  357 42893.2522 91375.2235   113%     -   99s
H    0     0                    44450.973635 91375.2235   106%     -  100s
     0     0 90626.6594    0  387 44450.9736 90626.6594   104%     -  155s
     0     0 90518.2153    0  396 44450.9736 90518.2153   104%     -  172s
     0     0 90479.7061    0  407 44450.9736 90479.7061   104%     -  192s
     0     0 90381.0871    0  400 44450.9736 90381.0871   103%     -  206s
     0     0 90307.4774    0  398 44450.9736 90307.4774   103%     -  225s
     0     0 90307.4774    0  400 44450.9736 90307.4774   103%     -  233s
     0     0 90307.4774    0  407 44450.9736 90307.4774   103%     -  235s
     0     0 86403.8584    0  354 44450.9736 86403.8584  94.4%     -  339s
H    0     0                    46727.814276 86403.4696  84.9%     -  341s
H    0     0                    46979.960066 86403.4696  83.9%     -  341s
H    0     0                    47176.880113 86403.4696  83.1%     -  341s
H    0     0                    47218.963523 86403.4696  83.0%     -  341s
H    0     0                    47231.665684 86403.4696  82.9%     -  341s
H    0     0                    47328.681770 86403.4696  82.6%     -  341s
H    0     0                    47390.721003 86403.4696  82.3%     -  341s
H    0     0                    47442.440855 86403.4696  82.1%     -  341s
H    0     0                    47486.548557 86403.4696  82.0%     -  341s
     0     0 85172.5308    0  401 47486.5486 85172.5308  79.4%     -  424s
     0     0 84706.1275    0  391 47486.5486 84706.1275  78.4%     -  495s
     0     0 84465.2961    0  387 47486.5486 84465.2961  77.9%     -  528s
     0     0 84395.8168    0  427 47486.5486 84395.8168  77.7%     -  549s
     0     0 84350.5058    0  431 47486.5486 84350.5058  77.6%     -  563s
     0     0 84340.0743    0  427 47486.5486 84340.0743  77.6%     -  572s
     0     0 84318.5439    0  437 47486.5486 84318.5439  77.6%     -  588s
     0     0 84316.3615    0  437 47486.5486 84316.3615  77.6%     -  593s
     0     0 84286.0285    0  425 47486.5486 84286.0285  77.5%     -  601s
H    0     0                    47647.444836 84282.7860  76.9%     -  606s
     0     0 84282.7860    0  421 47647.4448 84282.7860  76.9%     -  606s
     0     0 84282.4033    0  421 47647.4448 84282.4033  76.9%     -  607s
H    0     0                    47768.094330 81208.4394  70.0%     -  749s
H    0     0                    48436.998719 81208.4394  67.7%     -  749s
H    0     0                    48775.206844 81208.4394  66.5%     -  749s
H    0     0                    48985.181116 81208.4394  65.8%     -  749s
H    0     0                    49050.562929 81208.4394  65.6%     -  749s
     0     0 81208.4394    0  374 49050.5629 81208.4394  65.6%     -  749s
H    0     0                    52667.965645 81208.3170  54.2%     -  751s
H    0     0                    52699.082284 81208.3170  54.1%     -  751s
H    0     0                    52980.911850 81208.3170  53.3%     -  751s
H    0     0                    52983.565219 81208.3170  53.3%     -  751s
H    0     0                    53273.578931 81208.3170  52.4%     -  751s
     0     0 80425.0053    0  385 53273.5789 80425.0053  51.0%     -  846s
     0     0 80177.1806    0  414 53273.5789 80177.1806  50.5%     -  897s
     0     0 80081.7413    0  407 53273.5789 80081.7413  50.3%     -  939s
     0     0 79914.5639    0  399 53273.5789 79914.5639  50.0%     -  986s
     0     0 79886.7859    0  398 53273.5789 79886.7859  50.0%     - 1004s
     0     0 79853.9680    0  410 53273.5789 79853.9680  49.9%     - 1022s
     0     0 79826.1126    0  416 53273.5789 79826.1126  49.8%     - 1046s
     0     0 79819.5788    0  416 53273.5789 79819.5788  49.8%     - 1057s
     0     0 79782.1890    0  405 53273.5789 79782.1890  49.8%     - 1083s
     0     0 79736.8114    0  416 53273.5789 79736.8114  49.7%     - 1103s
     0     0 79728.9686    0  413 53273.5789 79728.9686  49.7%     - 1112s
     0     0 79726.2994    0  411 53273.5789 79726.2994  49.7%     - 1118s
     0     0 78732.5835    0  429 53273.5789 78732.5835  47.8%     - 1202s
     0     0 78539.4573    0  428 53273.5789 78539.4573  47.4%     - 1254s
     0     0 78478.5981    0  442 53273.5789 78478.5981  47.3%     - 1297s
     0     0 78441.4096    0  437 53273.5789 78441.4096  47.2%     - 1315s
     0     0 78407.3680    0  433 53273.5789 78407.3680  47.2%     - 1331s
     0     0 78379.9932    0  443 53273.5789 78379.9932  47.1%     - 1346s
     0     0 78357.7704    0  457 53273.5789 78357.7704  47.1%     - 1357s
     0     0 78350.9323    0  445 53273.5789 78350.9323  47.1%     - 1364s
     0     0 78350.0053    0  443 53273.5789 78350.0053  47.1%     - 1368s
     0     0 78083.5484    0  461 53273.5789 78083.5484  46.6%     - 1420s
     0     0 78010.9576    0  447 53273.5789 78010.9576  46.4%     - 1448s
     0     0 77977.3118    0  433 53273.5789 77977.3118  46.4%     - 1469s
     0     0 77960.2359    0  441 53273.5789 77960.2359  46.3%     - 1490s
     0     0 77953.8353    0  437 53273.5789 77953.8353  46.3%     - 1498s
     0     0 77951.0693    0  415 53273.5789 77951.0693  46.3%     - 1505s
     0     0 77737.8946    0  494 53273.5789 77737.8946  45.9%     - 1559s
     0     0 77669.1665    0  447 53273.5789 77669.1665  45.8%     - 1594s
     0     0 77651.4022    0  446 53273.5789 77651.4022  45.8%     - 1607s
     0     0 77631.9298    0  445 53273.5789 77631.9298  45.7%     - 1623s
     0     0 77625.5260    0  443 53273.5789 77625.5260  45.7%     - 1629s
     0     0 77617.2344    0  443 53273.5789 77617.2344  45.7%     - 1637s
     0     0 77610.0660    0  449 53273.5789 77610.0660  45.7%     - 1646s
     0     0 77608.8160    0  547 53273.5789 77608.8160  45.7%     - 1652s
     0     0 77511.5480    0  538 53273.5789 77511.5480  45.5%     - 1689s
H    0     0                    53445.135722 77511.4986  45.0%     - 1691s
     0     0 77485.1723    0  451 53445.1357 77485.1723  45.0%     - 1710s
     0     0 77475.6137    0  420 53445.1357 77475.6137  45.0%     - 1721s
     0     0 77470.1189    0  436 53445.1357 77470.1189  45.0%     - 1727s
     0     0 77468.5015    0  431 53445.1357 77468.5015  44.9%     - 1730s
     0     0 77418.4340    0  435 53445.1357 77418.4340  44.9%     - 1760s
     0     0 77397.2487    0  474 53445.1357 77397.2487  44.8%     - 1790s
     0     0 77389.9509    0  444 53445.1357 77389.9509  44.8%     - 1801s
     0     0 77388.6756    0  448 53445.1357 77388.6756  44.8%     - 1804s
     0     0 77353.5937    0  460 53445.1357 77353.5937  44.7%     - 1827s
     0     0 77346.8494    0  473 53445.1357 77346.8494  44.7%     - 1840s
     0     0 77343.4131    0  454 53445.1357 77343.4131  44.7%     - 1846s
     0     0 77325.2948    0  471 53445.1357 77325.2948  44.7%     - 1865s
     0     0 77317.8875    0  462 53445.1357 77317.8875  44.7%     - 1880s
     0     0 77314.0544    0  427 53445.1357 77314.0544  44.7%     - 1886s
     0     0 77310.4247    0  433 53445.1357 77310.4247  44.7%     - 1894s
     0     0 77310.3569    0  433 53445.1357 77310.3569  44.7%     - 1898s
H    0     0                    53728.494921 77310.3569  43.9%     - 2213s
     0     2 77310.3569    0  433 53728.4949 77310.3569  43.9%     - 2218s
     1     3 76745.8661    1  336 53728.4949 77310.3124  43.9% 15627 2258s
     2     4 77214.4364    1  421 53728.4949 77214.4364  43.7% 11671 2277s
     3     6 77117.6649    2  434 53728.4949 77214.3656  43.7% 11146 2318s
     5    11 77019.5743    3  368 53728.4949 77214.3656  43.7% 12732 2360s
    10    19 74760.1112    4  352 53728.4949 77019.5628  43.3% 12690 2438s
    18    27 74742.4161    5  396 53728.4949 77019.5628  43.3% 22492 2570s
    26    50 73539.7460    5  354 53728.4949 76534.3500  42.4% 20663 3090s
    49    82 74793.7362    6  481 53728.4949 76533.8697  42.4% 29976 3208s
H   54    82                    54853.089358 76533.8697  39.5% 29459 3208s
    81   120 74716.5218    7  477 54853.0894 76533.8697  39.5% 27545 3311s
   119   247 74694.6856    8  490 54853.0894 76533.8697  39.5% 22452 3446s
   246   291 74624.4736   10  504 54853.0894 76533.8697  39.5% 14204 3520s
   290   347 74592.9290   11  491 54853.0894 76533.8697  39.5% 13544 3592s
   346   350 72542.1436   22  300 54853.0894 76533.8697  39.5% 12754 3600s

Cutting planes:
  Learned: 4
  Gomory: 50
  Implied bound: 310
  MIR: 3655
  Flow cover: 2622
  RLT: 182
  Relax-and-lift: 1158

Explored 349 nodes (5249203 simplex iterations) in 3600.08 seconds (4449.47 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 54853.1 53728.5 53445.1 ... 48985.2

Time limit reached
Best objective 5.485308935751e+04, best bound 7.653386971886e+04, gap 39.5252%
  WARNING: Time limit reached. Using best solution found (gap: 39.53%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 54853.09, θ = 227622.18
  Upper Bound (UB) = 54853.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227622.18
  [DEBUG]   ✓ Scenario 0: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227622.18 ≤ Q = 227622.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227622.18 ≤ Q = 227622.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227622.18 ≤ Q = 227622.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227622.18 ≤ Q = 227622.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6cab4172
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9354be8e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.404297e+13
Presolve removed 2562 rows and 1852 columns
Presolve time: 0.01s
Presolved: 531 rows, 537 columns, 1504 nonzeros
Found heuristic solution: objective 7015736.3465
Variable types: 364 continuous, 173 integer (173 binary)

Root relaxation: objective -1.857318e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -185731.76    0  122 7015736.35 -185731.76   103%     -    0s
H    0     0                    -147142.9760 -185731.76  26.2%     -    0s
H    0     0                    -148269.6324 -185731.76  25.3%     -    0s
H    0     0                    -148851.4379 -165403.82  11.1%     -    0s
     0     0 -165403.82    0  102 -148851.44 -165403.82  11.1%     -    0s
H    0     0                    -160681.1272 -165280.65  2.86%     -    0s
H    0     0                    -162827.6059 -165280.65  1.51%     -    0s
     0     0 -164270.42    0   95 -162827.61 -164270.42  0.89%     -    0s
H    0     0                    -163393.3248 -164265.27  0.53%     -    0s
     0     0 -163940.86    0  101 -163393.32 -163940.86  0.34%     -    0s
     0     0 -163873.12    0   85 -163393.32 -163873.12  0.29%     -    0s
     0     0 -163870.12    0   85 -163393.32 -163870.12  0.29%     -    0s
     0     0 -163605.05    0   54 -163393.32 -163605.05  0.13%     -    0s
     0     0 -163604.31    0   45 -163393.32 -163604.31  0.13%     -    0s
     0     0 -163569.07    0   44 -163393.32 -163569.07  0.11%     -    0s
     0     0 -163569.07    0   50 -163393.32 -163569.07  0.11%     -    0s
     0     0 -163522.23    0   43 -163393.32 -163522.23  0.08%     -    0s
     0     0 -163522.23    0   49 -163393.32 -163522.23  0.08%     -    0s
     0     0 -163522.23    0   47 -163393.32 -163522.23  0.08%     -    0s
     0     0 -163522.23    0   38 -163393.32 -163522.23  0.08%     -    0s
H    0     0                    -163397.4746 -163522.23  0.08%     -    0s
H    0     0                    -163398.8672 -163442.41  0.03%     -    0s
     0     0 -163442.41    0   23 -163398.87 -163442.41  0.03%     -    0s
     0     0 -163416.97    0    5 -163398.87 -163416.97  0.01%     -    0s
     0     0 -163416.95    0    2 -163398.87 -163416.95  0.01%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 39
  Flow cover: 14
  RLT: 3

Explored 1 nodes (1004 simplex iterations) in 0.16 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -163399 -163397 -163393 ... 7.01574e+06
No other solutions better than -163399

Optimal solution found (tolerance 1.00e-04)
Best objective -1.633988671871e+05, best bound -1.633988671871e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 216889.70
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -163398.87
  [DEBUG]   S×d_nominal = 380288.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 380288.56 + -163398.87 = 216889.70
  [DEBUG]   Current θ from Master = 227622.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10732.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44120.61
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = 1526.1421, Absolute Gap = 1526.1421, Relative Gap = 0.027822
  Not converged yet (gap = 1526.14 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611047 nonzeros
Model fingerprint: 0x69ed025c
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89082 rows and 36162 columns
Presolve time: 4.41s
Presolved: 126361 rows, 53458 columns, 776185 nonzeros
Variable types: 51199 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285502.0899
Found heuristic solution: objective -223925.2491

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.82s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 5.305e+06
 Factor NZ  : 1.197e+07 (roughly 170 MB of memory)
 Factor Ops : 2.502e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85302377e+07  2.53153000e+08  1.57e+05 1.57e+01  9.53e+04     8s
   1  -1.42574710e+07  2.36882228e+08  1.12e+05 1.00e+02  6.73e+04     8s
   2  -6.84158749e+06  1.91582326e+08  5.37e+04 3.79e+01  3.34e+04     8s
   3  -1.62668891e+06  1.45745351e+08  6.84e+03 3.09e+00  4.72e+03     8s
   4  -7.98597077e+05  7.76978955e+07  8.45e+02 4.45e-01  8.02e+02     9s
   5  -7.16568617e+05  4.02385714e+07  3.74e+02 1.69e-01  3.58e+02     9s
   6  -6.51833289e+05  3.33565574e+07  3.08e+02 1.31e-01  2.89e+02     9s
   7  -5.06142595e+05  2.50087131e+07  8.21e+01 8.99e-02  1.46e+02     9s
   8  -2.87862751e+05  1.70835734e+07  3.32e+01 5.74e-02  8.70e+01     9s
   9  -1.81023590e+05  1.12501750e+07  1.31e+01 3.55e-02  5.29e+01     9s
  10  -1.31798450e+05  6.57853496e+06  7.59e+00 2.00e-02  3.03e+01     9s
  11  -1.07030905e+05  4.56518647e+06  4.38e+00 1.36e-02  2.08e+01     9s
  12  -8.31074291e+04  2.11911516e+06  2.76e+00 6.16e-03  9.71e+00    10s
  13  -4.13563063e+04  7.76430286e+05  1.20e+00 2.15e-03  3.57e+00    10s
  14   5.96348961e+03  3.95931108e+05  5.09e-01 1.49e-03  1.70e+00    10s
  15   7.37239696e+03  3.10680605e+05  4.96e-01 1.18e-03  1.32e+00    10s
  16   2.94119380e+04  2.39127051e+05  3.38e-01 1.42e-03  9.13e-01    10s
  17   4.17973405e+04  2.05089529e+05  2.64e-01 1.50e-03  7.11e-01    10s
  18   4.71107714e+04  1.59294358e+05  2.33e-01 2.05e-03  4.89e-01    10s
  19   5.80628220e+04  1.35344919e+05  1.75e-01 1.94e-03  3.37e-01    10s
  20   6.51711870e+04  1.24362225e+05  1.38e-01 1.78e-03  2.58e-01    11s
  21   7.04733571e+04  1.16458443e+05  1.11e-01 1.75e-03  2.00e-01    11s
  22   7.35337835e+04  1.10379747e+05  9.62e-02 1.53e-03  1.61e-01    11s
  23   7.76633138e+04  1.07737731e+05  7.73e-02 1.52e-03  1.31e-01    11s
  24   7.93034473e+04  1.03861264e+05  7.00e-02 1.90e-03  1.07e-01    11s
  25   8.45728413e+04  1.01857239e+05  4.64e-02 1.95e-03  7.54e-02    11s
  26   8.56157922e+04  9.96712575e+04  4.18e-02 1.54e-03  6.14e-02    11s
  27   8.74993056e+04  9.91323759e+04  3.40e-02 1.37e-03  5.08e-02    12s
  28   8.82578494e+04  9.81509458e+04  3.05e-02 9.97e-04  4.32e-02    12s
  29   8.86563926e+04  9.79363022e+04  2.88e-02 9.23e-04  4.05e-02    12s
  30   8.97355034e+04  9.73152997e+04  2.41e-02 7.00e-04  3.31e-02    12s
  31   9.07632774e+04  9.70676831e+04  1.96e-02 6.08e-04  2.75e-02    12s
  32   9.16244534e+04  9.68303086e+04  1.60e-02 4.83e-04  2.27e-02    13s
  33   9.20966990e+04  9.62592978e+04  1.39e-02 3.01e-04  1.82e-02    13s
  34   9.24386017e+04  9.62050704e+04  1.25e-02 2.73e-04  1.65e-02    13s
  35   9.30506467e+04  9.61022056e+04  9.89e-03 2.28e-04  1.33e-02    13s
  36   9.36674071e+04  9.59229120e+04  7.21e-03 1.64e-04  9.85e-03    13s
  37   9.40614355e+04  9.58781947e+04  5.65e-03 1.48e-04  7.93e-03    13s
  38   9.43150350e+04  9.56811954e+04  4.56e-03 8.98e-05  5.97e-03    14s
  39   9.46627937e+04  9.56520038e+04  3.17e-03 8.47e-05  4.32e-03    14s
  40   9.48365790e+04  9.55978992e+04  2.45e-03 1.22e-04  3.32e-03    14s
  41   9.48934135e+04  9.55684350e+04  2.21e-03 1.22e-04  2.95e-03    14s
  42   9.50513207e+04  9.55389322e+04  1.55e-03 9.29e-05  2.13e-03    14s
  43   9.51999154e+04  9.55170100e+04  9.46e-04 7.04e-05  1.38e-03    15s
  44   9.52942409e+04  9.54785111e+04  5.67e-04 3.13e-05  8.05e-04    15s
  45   9.53858944e+04  9.54588419e+04  2.07e-04 3.99e-05  3.18e-04    15s
  46   9.54204298e+04  9.54483485e+04  7.83e-05 1.30e-05  1.22e-04    15s
  47   9.54335314e+04  9.54455312e+04  3.38e-05 4.17e-06  5.24e-05    15s
  48   9.54415324e+04  9.54443743e+04  8.32e-06 8.93e-07  1.24e-05    15s
  49   9.54437267e+04  9.54442236e+04  1.00e-06 1.74e-07  2.17e-06    16s
  50   9.54441668e+04  9.54441830e+04  1.21e-07 1.40e-08  7.06e-08    16s
  51   9.54441817e+04  9.54441820e+04  4.08e-08 1.83e-10  1.40e-09    16s

Barrier solved model in 51 iterations and 15.83 seconds (12.04 work units)
Optimal objective 9.54441817e+04


Root crossover log...

  114570 DPushes remaining with DInf 0.0000000e+00                16s
    1566 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

   10090 PPushes remaining with PInf 9.1489410e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3069904e+03     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70563    9.5444182e+04   0.000000e+00   1.306990e+03     22s
   70830    9.5444182e+04   0.000000e+00   0.000000e+00     23s
   70830    9.5444182e+04   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 9.544418e+04, 70830 iterations, 17.44 seconds (19.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 95444.1820    0  166 -223925.25 95444.1820   143%     -   23s
H    0     0                    -220483.0726 95444.1820   143%     -   23s
H    0     0                    -156600.2054 95444.1820   161%     -   24s
H    0     0                    -124851.3412 95444.1820   176%     -   24s
H    0     0                    -121965.1403 95444.1820   178%     -   24s
H    0     0                    -121378.7391 95444.1820   179%     -   25s
H    0     0                    -120614.3084 95444.1820   179%     -   25s
H    0     0                    -120422.6270 95444.1820   179%     -   25s
H    0     0                    -119968.2335 95444.1820   180%     -   25s
H    0     0                    -42521.21026 95444.1820   324%     -   25s
H    0     0                    7119.1680049 95444.1820  1241%     -   26s
H    0     0                    31058.255339 95444.1820   207%     -   27s
H    0     0                    41823.086461 95444.1820   128%     -   28s
H    0     0                    41922.811173 95444.1820   128%     -   28s
H    0     0                    42053.516378 95444.1820   127%     -   29s
H    0     0                    42116.070839 95444.1820   127%     -   29s
H    0     0                    42146.565458 95444.1820   126%     -   29s
H    0     0                    47101.783564 95444.1820   103%     -   31s
H    0     0                    47319.281207 95444.1820   102%     -   31s
H    0     0                    47469.812825 95444.1820   101%     -   31s
H    0     0                    48247.035076 95444.1820  97.8%     -   31s
H    0     0                    48575.136684 95444.1820  96.5%     -   31s
H    0     0                    48639.634011 95444.1820  96.2%     -   31s
     0     0 87808.9079    0  235 48639.6340 87808.9079  80.5%     -  134s
     0     0 87160.7754    0  271 48639.6340 87160.7754  79.2%     -  188s
     0     0 87014.7497    0  261 48639.6340 87014.7497  78.9%     -  223s
     0     0 86982.2381    0  253 48639.6340 86982.2381  78.8%     -  234s
     0     0 86981.0465    0  258 48639.6340 86981.0465  78.8%     -  235s
     0     0 86980.9016    0  259 48639.6340 86980.9016  78.8%     -  236s
     0     0 83889.7139    0  278 48639.6340 83889.7139  72.5%     -  365s
H    0     0                    49793.376753 83889.5880  68.5%     -  367s
H    0     0                    50089.405203 83889.5880  67.5%     -  367s
H    0     0                    50247.060435 83889.5880  67.0%     -  367s
H    0     0                    50263.019916 83889.5880  66.9%     -  367s
H    0     0                    50413.394816 83889.5880  66.4%     -  367s
H    0     0                    50880.188864 83889.5880  64.9%     -  367s
     0     0 83355.8886    0  292 50880.1889 83355.8886  63.8%     -  438s
     0     0 83075.4348    0  312 50880.1889 83075.4348  63.3%     -  479s
     0     0 82900.8330    0  269 50880.1889 82900.8330  62.9%     -  528s
     0     0 82857.7326    0  279 50880.1889 82857.7326  62.8%     -  561s
     0     0 82755.7664    0  279 50880.1889 82755.7664  62.6%     -  587s
H    0     0                    50956.465781 82740.0702  62.4%     -  601s
H    0     0                    51491.391754 82740.0702  60.7%     -  601s
     0     0 82740.0702    0  281 51491.3918 82740.0702  60.7%     -  601s
     0     0 82730.8373    0  270 51491.3918 82730.8373  60.7%     -  606s
     0     0 82728.0430    0  279 51491.3918 82728.0430  60.7%     -  610s
     0     0 82716.2516    0  291 51491.3918 82716.2516  60.6%     -  614s
     0     0 82712.6544    0  294 51491.3918 82712.6544  60.6%     -  617s
     0     0 82708.5182    0  280 51491.3918 82708.5182  60.6%     -  620s
     0     0 82702.9806    0  287 51491.3918 82702.9806  60.6%     -  624s
     0     0 82702.4250    0  285 51491.3918 82702.4250  60.6%     -  625s
     0     0 80333.8493    0  356 51491.3918 80333.8493  56.0%     -  767s
     0     0 79944.7393    0  360 51491.3918 79944.7393  55.3%     -  821s
     0     0 79691.0369    0  433 51491.3918 79691.0369  54.8%     -  857s
     0     0 79589.2803    0  403 51491.3918 79589.2803  54.6%     -  879s
     0     0 79562.3704    0  407 51491.3918 79562.3704  54.5%     -  892s
     0     0 79542.7739    0  385 51491.3918 79542.7739  54.5%     -  904s
     0     0 79508.1417    0  415 51491.3918 79508.1417  54.4%     -  921s
     0     0 79503.6942    0  413 51491.3918 79503.6942  54.4%     -  926s
     0     0 79500.8136    0  411 51491.3918 79500.8136  54.4%     -  930s
     0     0 79494.9534    0  409 51491.3918 79494.9534  54.4%     -  936s
     0     0 79491.6944    0  403 51491.3918 79491.6944  54.4%     -  939s
     0     0 79471.8621    0  410 51491.3918 79471.8621  54.3%     -  944s
     0     0 79460.6941    0  383 51491.3918 79460.6941  54.3%     -  948s
     0     0 79458.7583    0  384 51491.3918 79458.7583  54.3%     -  950s
H    0     0                    51503.887816 78594.8561  52.6%     - 1031s
H    0     0                    51589.659389 78594.8561  52.3%     - 1031s
     0     0 78594.8561    0  403 51589.6594 78594.8561  52.3%     - 1031s
     0     0 78243.8205    0  392 51589.6594 78243.8205  51.7%     - 1081s
     0     0 78177.2529    0  383 51589.6594 78177.2529  51.5%     - 1097s
     0     0 78155.2396    0  387 51589.6594 78155.2396  51.5%     - 1107s
     0     0 78128.4378    0  400 51589.6594 78128.4378  51.4%     - 1118s
     0     0 78122.4826    0  393 51589.6594 78122.4826  51.4%     - 1123s
     0     0 78117.5907    0  393 51589.6594 78117.5907  51.4%     - 1129s
     0     0 78109.9709    0  392 51589.6594 78109.9709  51.4%     - 1132s
     0     0 78108.9741    0  392 51589.6594 78108.9741  51.4%     - 1133s
     0     0 77928.7773    0  406 51589.6594 77928.7773  51.1%     - 1163s
     0     0 77877.0632    0  449 51589.6594 77877.0632  51.0%     - 1188s
     0     0 77854.6337    0  445 51589.6594 77854.6337  50.9%     - 1205s
     0     0 77830.0515    0  432 51589.6594 77830.0515  50.9%     - 1225s
     0     0 77816.5967    0  443 51589.6594 77816.5967  50.8%     - 1234s
     0     0 77809.2730    0  439 51589.6594 77809.2730  50.8%     - 1239s
     0     0 77806.5371    0  443 51589.6594 77806.5371  50.8%     - 1246s
     0     0 77805.0641    0  445 51589.6594 77805.0641  50.8%     - 1250s
     0     0 77746.1223    0  449 51589.6594 77746.1223  50.7%     - 1276s
H    0     0                    51639.614753 77745.9313  50.6%     - 1280s
     0     0 77708.7899    0  443 51639.6148 77708.7899  50.5%     - 1300s
     0     0 77691.0595    0  493 51639.6148 77691.0595  50.4%     - 1317s
     0     0 77667.0042    0  479 51639.6148 77667.0042  50.4%     - 1334s
     0     0 77643.5182    0  493 51639.6148 77643.5182  50.4%     - 1346s
     0     0 77631.4101    0  465 51639.6148 77631.4101  50.3%     - 1354s
     0     0 77625.9298    0  497 51639.6148 77625.9298  50.3%     - 1361s
     0     0 77621.2328    0  475 51639.6148 77621.2328  50.3%     - 1364s
     0     0 77620.8396    0  502 51639.6148 77620.8396  50.3%     - 1366s
     0     0 77551.2419    0  453 51639.6148 77551.2419  50.2%     - 1390s
     0     0 77518.2435    0  474 51639.6148 77518.2435  50.1%     - 1405s
     0     0 77510.2228    0  450 51639.6148 77510.2228  50.1%     - 1411s
     0     0 77506.7725    0  457 51639.6148 77506.7725  50.1%     - 1414s
     0     0 77505.6887    0  458 51639.6148 77505.6887  50.1%     - 1416s
     0     0 77491.2661    0  442 51639.6148 77491.2661  50.1%     - 1430s
H    0     0                    51966.090568 77490.3893  49.1%     - 1432s
H    0     0                    52171.325582 77490.3893  48.5%     - 1432s
     0     0 77483.9608    0  450 52171.3256 77483.9608  48.5%     - 1439s
     0     0 77480.6090    0  422 52171.3256 77480.6090  48.5%     - 1442s
     0     0 77479.9352    0  446 52171.3256 77479.9352  48.5%     - 1443s
     0     0 77466.1951    0  485 52171.3256 77466.1951  48.5%     - 1453s
     0     0 77463.3323    0  446 52171.3256 77463.3323  48.5%     - 1457s
     0     0 77462.2366    0  455 52171.3256 77462.2366  48.5%     - 1461s
     0     0 77449.8917    0  458 52171.3256 77449.8917  48.5%     - 1471s
     0     0 77449.4561    0  458 52171.3256 77449.4561  48.5%     - 1475s
H    0     0                    52368.447662 77449.4561  47.9%     - 1614s
H    0     0                    52496.808575 77449.4561  47.5%     - 1761s
H    0     0                    52698.856328 77449.4561  47.0%     - 1784s
H    0     0                    52823.428130 77449.4561  46.6%     - 1784s
H    0     2                    53028.906537 77449.4561  46.1%     - 1806s
     0     2 77449.4561    0  458 53028.9065 77449.4561  46.1%     - 1806s
     1     4 77390.6360    1  407 53028.9065 77448.1005  46.0%  8530 1835s
     3     7 77216.0496    2  409 53028.9065 77389.5902  45.9%  9354 1907s
     6    13 77035.3659    3  402 53028.9065 77213.5913  45.6% 12464 1981s
    12    25 76591.5169    4  403 53028.9065 77035.3416  45.3% 15387 2057s
    24    37 74886.6241    5  386 53028.9065 77035.3416  45.3% 22165 2247s
    36    68 74519.8794    5  380 53028.9065 76591.3275  44.4% 20890 2557s
H   39    68                    53067.921326 76591.3275  44.3% 19967 2557s
H   41    68                    53201.511066 76591.3275  44.0% 19495 2557s
    67   111 74094.5025    6  373 53201.5111 76591.3275  44.0% 22738 2718s
   110   239 74080.5885    7  363 53201.5111 76591.3275  44.0% 18344 2863s
   238   315 73414.7169   12  392 53201.5111 76591.3275  44.0% 13339 2937s
   314   346 73307.2113   14  408 53201.5111 76591.3275  44.0% 11689 3035s
   345   382 73091.2303   15  410 53201.5111 76591.3275  44.0% 11329 3198s
   381   417 73060.5700   16  414 53201.5111 76591.3275  44.0% 10903 3263s
   416   455 72401.1322   17  336 53201.5111 76591.3275  44.0% 10600 3332s
   454   485 72391.7126   18  340 53201.5111 76591.3275  44.0% 10441 3395s
   484   512 70976.3158   22  287 53201.5111 76591.3275  44.0% 10183 3471s
   511   539 70974.8206   23  288 53201.5111 76591.3275  44.0% 10215 3550s
   538   561 72084.7579   18  314 53201.5111 76591.3275  44.0% 10019 3600s
H  554   561                    53211.926339 76591.3275  43.9%  9923 3600s

Cutting planes:
  Learned: 6
  Gomory: 20
  Implied bound: 198
  MIR: 2901
  Flow cover: 3068
  RLT: 64
  Relax-and-lift: 518

Explored 560 nodes (6173273 simplex iterations) in 3600.10 seconds (4856.62 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 53211.9 53201.5 53067.9 ... 51966.1

Time limit reached
Best objective 5.321192633923e+04, best bound 7.659132752076e+04, gap 43.9364%
  WARNING: Time limit reached. Using best solution found (gap: 43.94%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 53211.93, θ = 227854.79
  Upper Bound (UB) = 53211.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227854.79
  [DEBUG]   ✓ Scenario 0: θ = 227854.79 ≤ Q = 227854.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227854.79 ≤ Q = 228892.50 (slack: 1037.71)
  [DEBUG]   ✓ Scenario 4: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227854.79 ≤ Q = 227854.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227854.79 ≤ Q = 228177.36 (slack: 322.57)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x41a3c3fe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x41a3c3fe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.401183e+13
Presolve removed 2556 rows and 1847 columns
Presolve time: 0.01s
Presolved: 537 rows, 542 columns, 1520 nonzeros
Found heuristic solution: objective 6984430.3845
Variable types: 368 continuous, 174 integer (174 binary)

Root relaxation: objective -1.852971e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -185297.12    0  129 6984430.38 -185297.12   103%     -    0s
H    0     0                    -147235.5920 -185297.12  25.9%     -    0s
H    0     0                    -147631.0139 -185297.12  25.5%     -    0s
H    0     0                    -148790.8013 -185297.12  24.5%     -    0s
H    0     0                    -149266.0833 -162290.90  8.73%     -    0s
     0     0 -162290.90    0   68 -149266.08 -162290.90  8.73%     -    0s
H    0     0                    -159348.6979 -162287.03  1.84%     -    0s
H    0     0                    -159675.8340 -162287.03  1.64%     -    0s
H    0     0                    -160040.6819 -162287.03  1.40%     -    0s
H    0     0                    -160367.8181 -162287.03  1.20%     -    0s
     0     0 -161889.40    0   70 -160367.82 -161889.40  0.95%     -    0s
     0     0 -161868.33    0   70 -160367.82 -161868.33  0.94%     -    0s
     0     0 -161148.44    0   47 -160367.82 -161148.44  0.49%     -    0s
     0     0 -160865.89    0   32 -160367.82 -160865.89  0.31%     -    0s
     0     0 -160849.58    0   32 -160367.82 -160849.58  0.30%     -    0s
H    0     0                    -160392.9276 -160849.58  0.28%     -    0s
     0     0 -160745.98    0   57 -160392.93 -160745.98  0.22%     -    0s
     0     0 -160745.98    0   28 -160392.93 -160745.98  0.22%     -    0s
     0     0 -160745.98    0   53 -160392.93 -160745.98  0.22%     -    0s
     0     0 -160745.98    0   52 -160392.93 -160745.98  0.22%     -    0s
     0     0 -160745.98    0   52 -160392.93 -160745.98  0.22%     -    0s
     0     0 -160745.98    0   50 -160392.93 -160745.98  0.22%     -    0s
     0     0 -160745.98    0   49 -160392.93 -160745.98  0.22%     -    0s
H    0     0                    -160425.6776 -160745.98  0.20%     -    0s
     0     0 -160745.98    0   74 -160425.68 -160745.98  0.20%     -    0s
     0     0 -160745.98    0   31 -160425.68 -160745.98  0.20%     -    0s
     0     0 -160745.98    0   26 -160425.68 -160745.98  0.20%     -    0s
     0     0 -160745.98    0   29 -160425.68 -160745.98  0.20%     -    0s
     0     0 -160745.98    0   26 -160425.68 -160745.98  0.20%     -    0s
     0     0 -160716.70    0   24 -160425.68 -160716.70  0.18%     -    0s
H    0     0                    -160456.6420 -160716.36  0.16%     -    0s
H    0     0                    -160489.3921 -160705.86  0.13%     -    0s
     0     0 -160705.86    0   23 -160489.39 -160705.86  0.13%     -    0s
H    0     0                    -160599.9986 -160705.86  0.07%     -    0s
     0     0 -160704.54    0   23 -160600.00 -160704.54  0.07%     -    0s
     0     0 -160704.54    0   31 -160600.00 -160704.54  0.07%     -    0s
     0     0 -160704.54    0   28 -160600.00 -160704.54  0.07%     -    0s
     0     0 -160704.54    0   27 -160600.00 -160704.54  0.07%     -    0s
     0     0 -160704.54    0   26 -160600.00 -160704.54  0.07%     -    0s
     0     0 -160704.54    0   21 -160600.00 -160704.54  0.07%     -    0s
     0     0 -160704.54    0   22 -160600.00 -160704.54  0.07%     -    0s
     0     0 -160653.31    0   21 -160600.00 -160653.31  0.03%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 44
  Flow cover: 5
  RLT: 12

Explored 1 nodes (1166 simplex iterations) in 0.26 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -160600 -160489 -160457 ... -147631
No other solutions better than -160600

Optimal solution found (tolerance 1.00e-04)
Best objective -1.605999986126e+05, best bound -1.605999986126e+05, gap 0.0000%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 218788.05
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -160600.00
  [DEBUG]   S×d_nominal = 379388.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 379388.05 + -160600.00 = 218788.05
  [DEBUG]   Current θ from Master = 227854.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9066.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44145.19
  Lower Bound (LB) = 53326.95
  Gap (UB-LB) = -115.0209, Absolute Gap = 115.0209, Relative Gap = -0.002162
  *** CONVERGED (small negative gap: -115.02 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 14
Total Time: 39087.06s
Converged: True
Final Lower Bound: 53326.9472
Final Upper Bound: 53211.9263
Final Gap: -115.020907
Number of Critical Scenarios: 14
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 5, 6, 8, 9] (5/10)
Active Routes (Plant→DC): 14
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 5 customers  Mode 2: 45 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 14
Start Time: 2026-01-04 12:31:24
End Time: 2026-01-04 23:22:51
Total Time: 39087.06s
Optimal Value: 53326.95
Lower Bound: 53326.95
Upper Bound: 53211.93
Gap: -115.020907
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [3, 5, 6, 8, 9] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed24_HD_gamma20_20260104_232252.csv

Total Execution Time: 39087.72 seconds
End Time: 2026-01-04 23:22:52

All tasks completed successfully!

