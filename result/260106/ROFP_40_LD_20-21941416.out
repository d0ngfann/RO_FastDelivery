
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 40
DI Scenario: LD
Start Time: 2026-01-05 15:25:04
================================================================================
Loading data from data/DH_data_full_seed40.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.116', '1.247'] (k=0.272)
  Product 1: ['1.000', '1.084', '1.176'] (k=0.200)
  Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=900, max=1732
  DC capacity (MC): min=418, max=894

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.01, max=34.70, count=87
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5661, max=9568
  DC fixed cost: min=3076, max=5936
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
    Product 1: ['1.000', '1.397', '1.953'] (k=0.825)
    Product 2: ['1.000', '1.475', '2.176'] (k=0.959)
  MD:
    Product 0: ['1.000', '1.261', '1.590'] (k=0.572)
    Product 1: ['1.000', '1.272', '1.619'] (k=0.594)
    Product 2: ['1.000', '1.200', '1.439'] (k=0.449)
  LD:
    Product 0: ['1.000', '1.116', '1.247'] (k=0.272)
    Product 1: ['1.000', '1.084', '1.176'] (k=0.200)
    Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
  Mixed:
    Product 0: ['1.000', '1.466', '2.149'] (k=0.943)
    Product 1: ['1.000', '1.272', '1.619'] (k=0.594)
    Product 2: ['1.000', '1.030', '1.062'] (k=0.074)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0x15aa56dc
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.13s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311133.4154
Found heuristic solution: objective -198039.8849

Root relaxation: objective 5.609540e+04, 4621 iterations, 0.20 seconds (0.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56095.3957    0  510 -198039.88 56095.3957   128%     -    0s
H    0     0                    -167104.9831 56095.3957   134%     -    0s
H    0     0                    -165485.4346 51424.1952   131%     -    1s
     0     0 51424.1952    0  842 -165485.43 51424.1952   131%     -    1s
     0     0 51276.1597    0  839 -165485.43 51276.1597   131%     -    1s
     0     0 51264.1846    0  840 -165485.43 51264.1846   131%     -    1s
     0     0 51263.6097    0  848 -165485.43 51263.6097   131%     -    1s
     0     0 49117.6294    0 1179 -165485.43 49117.6294   130%     -    2s
H    0     0                    -159761.7567 48290.6136   130%     -    2s
     0     0 48290.6136    0 1168 -159761.76 48290.6136   130%     -    2s
     0     0 48285.9969    0 1184 -159761.76 48285.9969   130%     -    2s
     0     0 48285.9969    0 1188 -159761.76 48285.9969   130%     -    2s
H    0     0                    -65066.21778 46307.4853   171%     -    5s
     0     0 46212.5724    0 1285 -65066.218 46212.5724   171%     -    5s
     0     0 45882.2632    0 1272 -65066.218 45882.2632   171%     -    5s
H    0     0                    -32800.30113 45737.3110   239%     -    6s
     0     0 45737.3110    0 1283 -32800.301 45737.3110   239%     -    6s
     0     0 45737.3110    0 1288 -32800.301 45737.3110   239%     -    6s
     0     0 45536.1834    0 1292 -32800.301 45536.1834   239%     -    6s
H    0     0                    -32796.09405 43752.3046   233%     -    9s
H    0     0                    -32783.47030 43752.3046   233%     -    9s
H    0     0                    -32685.38499 43752.3046   234%     -    9s
H    0     0                    -32263.50436 43752.3046   236%     -    9s
H    0     0                    -32229.34242 43752.3046   236%     -    9s
H    0     0                    -32132.41462 43752.3046   236%     -    9s
H    0     0                    -32020.08328 43752.3046   237%     -    9s
H    0     0                    -31950.64045 43752.3046   237%     -    9s
H    0     0                    -31934.47493 43752.3046   237%     -    9s
H    0     0                    -31921.85118 43752.3046   237%     -    9s
H    0     0                    -14464.36237 43752.3046   402%     -    9s
     0     0 43752.3046    0 1340 -14464.362 43752.3046   402%     -    9s
     0     0 43267.0966    0 1358 -14464.362 43267.0966   399%     -   10s
     0     0 43155.0121    0 1371 -14464.362 43155.0121   398%     -   11s
H    0     0                    -14144.82100 43043.0298   404%     -   11s
H    0     0                    -14036.77467 43043.0298   407%     -   11s
H    0     0                    -13977.31599 43043.0298   408%     -   11s
     0     0 43043.0298    0 1379 -13977.316 43043.0298   408%     -   11s
     0     0 43030.1369    0 1386 -13977.316 43030.1369   408%     -   11s
H    0     0                    -13368.74248 43014.5139   422%     -   11s
H    0     0                    -13344.61343 43014.5139   422%     -   11s
H    0     0                    -13342.01906 41839.0569   414%     -   14s
H    0     0                    -13341.86259 41839.0569   414%     -   14s
H    0     0                    -13303.88803 41839.0569   414%     -   14s
H    0     0                    -13292.71527 41839.0569   415%     -   14s
H    0     0                    -13190.48310 41839.0569   417%     -   14s
H    0     0                    -13161.83474 41839.0569   418%     -   14s
H    0     0                    -12948.51280 41839.0569   423%     -   14s
H    0     0                    -12641.13555 41839.0569   431%     -   14s
H    0     0                    -12637.11015 41839.0569   431%     -   14s
H    0     0                    -12541.73159 41839.0569   434%     -   14s
H    0     0                    -12518.90514 41839.0569   434%     -   14s
H    0     0                    -12518.62434 41839.0569   434%     -   14s
H    0     0                    -12510.73619 41839.0569   434%     -   14s
H    0     0                    -6196.361952 41839.0569   775%     -   14s
H    0     0                    -535.6569643 41839.0569  7911%     -   14s
H    0     0                    1557.9117869 41839.0569  2586%     -   14s
H    0     0                    1831.7182862 41839.0569  2184%     -   14s
H    0     0                    1832.3130728 41839.0569  2183%     -   14s
H    0     0                    1862.3311482 41839.0569  2147%     -   14s
H    0     0                    1865.2494015 41839.0569  2143%     -   14s
     0     0 41839.0569    0 1227 1865.24940 41839.0569  2143%     -   14s
H    0     0                    5607.9700946 41644.6654   643%     -   15s
H    0     0                    5956.9745698 41644.6654   599%     -   15s
H    0     0                    5993.8944174 41644.6654   595%     -   15s
H    0     0                    6027.7692391 41644.6654   591%     -   15s
H    0     0                    6058.1328488 41644.6654   587%     -   15s
H    0     0                    6300.1843411 41644.6654   561%     -   15s
H    0     0                    6302.0160188 41644.6654   561%     -   15s
     0     0 41644.6654    0 1392 6302.01602 41644.6654   561%     -   15s
     0     0 41596.9111    0 1377 6302.01602 41596.9111   560%     -   15s
     0     0 41584.6855    0 1408 6302.01602 41584.6855   560%     -   16s
     0     0 41581.5554    0 1405 6302.01602 41581.5554   560%     -   16s
H    0     0                    8113.5114868 40217.6687   396%     -   19s
H    0     0                    8532.0796263 40217.6687   371%     -   19s
H    0     0                    9768.8187399 40217.6687   312%     -   19s
H    0     0                    10305.047472 40217.6687   290%     -   19s
H    0     0                    10356.580385 40217.6687   288%     -   19s
H    0     0                    10390.713626 40217.6687   287%     -   19s
     0     0 40217.6687    0 1379 10390.7136 40217.6687   287%     -   19s
H    0     0                    10712.923059 40012.3840   273%     -   20s
H    0     0                    10719.796831 40012.3840   273%     -   20s
H    0     0                    10721.485124 40012.3840   273%     -   20s
H    0     0                    10731.303666 40012.3840   273%     -   20s
     0     0 40012.3840    0 1298 10731.3037 40012.3840   273%     -   20s
     0     0 39978.2689    0 1431 10731.3037 39978.2689   273%     -   21s
     0     0 39974.4154    0 1311 10731.3037 39974.4154   273%     -   21s
H    0     0                    10781.011763 39060.5774   262%     -   23s
H    0     0                    10852.032229 39060.5774   260%     -   23s
H    0     0                    10896.136400 39060.5774   258%     -   23s
H    0     0                    11081.306791 39060.5774   252%     -   23s
H    0     0                    11110.235306 39060.5774   252%     -   23s
H    0     0                    11174.739628 39060.5774   250%     -   23s
H    0     0                    11425.473388 39060.5774   242%     -   23s
H    0     0                    11457.175001 39060.5774   241%     -   23s
H    0     0                    11485.357533 39060.5774   240%     -   23s
H    0     0                    11519.107071 39060.5774   239%     -   23s
     0     0 39060.5774    0 1366 11519.1071 39060.5774   239%     -   24s
     0     0 38855.4187    0 1394 11519.1071 38855.4187   237%     -   25s
     0     0 38804.2224    0 1413 11519.1071 38804.2224   237%     -   26s
     0     0 38794.4717    0 1430 11519.1071 38794.4717   237%     -   26s
     0     0 37876.4044    0 1367 11519.1071 37876.4044   229%     -   30s
     0     0 37689.6365    0 1408 11519.1071 37689.6365   227%     -   32s
     0     0 37659.8735    0 1442 11519.1071 37659.8735   227%     -   32s
     0     0 37650.1143    0 1432 11519.1071 37650.1143   227%     -   33s
H    0     0                    11619.951133 36903.2133   218%     -   37s
H    0     0                    11622.312809 36903.2133   218%     -   37s
H    0     0                    11633.847159 36903.2133   217%     -   37s
     0     0 36903.2133    0 1388 11633.8472 36903.2133   217%     -   37s
H    0     0                    11641.098301 36754.6665   216%     -   39s
H    0     0                    11643.541879 36754.6665   216%     -   39s
H    0     0                    11666.689811 36754.6665   215%     -   39s
H    0     0                    11710.110483 36754.6665   214%     -   39s
     0     0 36754.6665    0 1373 11710.1105 36754.6665   214%     -   39s
     0     0 36718.2064    0 1400 11710.1105 36718.2064   214%     -   40s
     0     0 36712.2857    0 1399 11710.1105 36712.2857   214%     -   40s
H    0     0                    11792.053280 36172.6265   207%     -   43s
     0     0 36172.6265    0 1387 11792.0533 36172.6265   207%     -   43s
     0     0 36044.2975    0 1399 11792.0533 36044.2975   206%     -   45s
     0     0 36005.3486    0 1389 11792.0533 36005.3486   205%     -   46s
     0     0 35993.2189    0 1409 11792.0533 35993.2189   205%     -   47s
     0     0 35556.4645    0 1383 11792.0533 35556.4645   202%     -   50s
     0     0 35457.7039    0 1427 11792.0533 35457.7039   201%     -   52s
H    0     0                    11797.595100 35434.6453   200%     -   53s
     0     0 35434.6453    0 1445 11797.5951 35434.6453   200%     -   53s
     0     0 35429.7280    0 1449 11797.5951 35429.7280   200%     -   54s
     0     0 35092.7955    0 1375 11797.5951 35092.7955   197%     -   57s
     0     0 35027.1486    0 1396 11797.5951 35027.1486   197%     -   59s
     0     0 35009.8655    0 1420 11797.5951 35009.8655   197%     -   60s
     0     0 34739.8662    0 1395 11797.5951 34739.8662   194%     -   63s
     0     0 34690.9836    0 1414 11797.5951 34690.9836   194%     -   64s
     0     0 34677.3478    0 1448 11797.5951 34677.3478   194%     -   65s
H    0     0                    11798.538779 34410.5323   192%     -   68s
     0     0 34410.5323    0 1363 11798.5388 34410.5323   192%     -   68s
     0     0 34306.9534    0 1393 11798.5388 34306.9534   191%     -   70s
     0     0 34284.3017    0 1391 11798.5388 34284.3017   191%     -   72s
     0     0 34114.6927    0 1334 11798.5388 34114.6927   189%     -   75s
     0     0 34070.0794    0 1354 11798.5388 34070.0794   189%     -   76s
     0     0 34054.9069    0 1363 11798.5388 34054.9069   189%     -   77s
     0     0 33891.7544    0 1342 11798.5388 33891.7544   187%     -   80s
     0     0 33891.6884    0 1342 11798.5388 33891.6884   187%     -   80s
     0     2 33891.6884    0 1342 11798.5388 33891.6884   187%     -   89s
     1     4 33561.9027    1 1183 11798.5388 33891.6094   187%  7659   93s
     3     8 31597.7756    2 1163 11798.5388 33561.7335   184%  7390   98s
     7    16 31120.5423    3 1014 11798.5388 31596.3267   168%  7541  101s
    15    32 30485.7000    4 1027 11798.5388 31120.3404   164%  5019  106s
    31    64 27986.2657    5  864 11798.5388 30485.4383   158%  5798  110s
    95   240 25581.9765    7  779 11798.5388 29352.1163   149%  5746  115s
   337   348 13758.6354   12  633 11798.5388 28072.1388   138%  2165  120s
   491   507 17412.7531   15  577 11798.5388 27984.2748   137%  1698  126s
   762   729 12330.7588   27  561 11798.5388 27984.2748   137%  1214  131s
   934   841 25794.3404    8  627 11798.5388 27984.2748   137%  1078  135s
  1180   943 14393.5156   13  519 11798.5388 27598.9799   134%   984  142s
  1286   994 12853.9107   21  517 11798.5388 27598.9799   134%   949  145s
  1611  1255 14363.3569   12  400 11798.5388 26439.5666   124%   873  151s
  1964  1498 19731.4388   11  410 11798.5388 26396.6594   124%   788  155s
  2356  1644 17545.5433   18  528 11798.5388 25969.3181   120%   721  160s
  2946  1865     cutoff   44      11798.5388 25060.3790   112%   672  168s
  3131  1956 23158.6411    8  682 11798.5388 25060.3790   112%   667  170s
  3561  2192 20599.7710   19  521 11798.5388 25033.4940   112%   647  175s
  4047  2355 13363.5990   52  310 11798.5388 24198.1599   105%   628  181s
  4302  2430 15090.3059   14  178 11798.5388 24198.1599   105%   623  185s
  4550  2476 16538.0413   13  132 11798.5388 23422.4374  98.5%   621  191s
  5059  2637 15048.3708   19  464 11798.5388 23261.3484  97.2%   617  197s
  5334  2719 13084.9010   13  426 11798.5388 23250.7631  97.1%   611  201s
  5618  2800 18072.2633   15  518 11798.5388 23019.1268  95.1%   610  205s
  6255  2943     cutoff   27      11798.5388 22374.2877  89.6%   600  211s
  6541  2944 14080.3195   16 1342 11798.5388 22134.4724  87.6%   599  249s
  6543  2945 15810.4239   46  364 11798.5388 22134.4724  87.6%   599  250s
  6557  2955 13656.5838   13  467 11798.5388 19683.0521  66.8%   598  255s
  6562  2961 19237.7124   13  363 11798.5388 19683.0521  66.8%   600  260s
H 6909  2774                    11803.571579 13994.6821  18.6%   581  263s
H 6915  2632                    11823.768711 13994.4375  18.4%   580  263s
H 6935  2492                    11882.508008 13994.4375  17.8%   579  263s
H 7376  2496                    11981.765050 12282.3951  2.51%   545  263s
H 7394  2369                    12102.477606 12282.3951  1.49%   544  263s
H 7467  2185                    12111.245175 12282.3951  1.41%   539  264s
H 7512  2061                    12113.214814 12281.5780  1.39%   536  264s
H 8085  1921                    12121.982382 12266.8542  1.20%   499  264s
H 8161  1820                    12159.086710 12266.8542  0.89%   494  264s
* 8718  1516              61    12166.492770 12213.3180  0.38%   464  264s
H 8873  1365                    12168.853714 12213.3180  0.37%   456  264s
* 9378  1024              58    12184.175988 12210.0853  0.21%   433  264s
* 9657   530              61    12198.900503 12205.4851  0.05%   421  264s
 10035   356     cutoff   46      12198.9005 12200.1827  0.01%   405  265s

Cutting planes:
  Implied bound: 11
  Projected implied bound: 59
  MIR: 321
  Flow cover: 526
  Zero half: 1
  RLT: 26
  Relax-and-lift: 105

Explored 10079 nodes (4192657 simplex iterations) in 265.11 seconds (357.43 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 12198.9 12184.2 12168.9 ... 11981.8

Optimal solution found (tolerance 1.00e-04)
Best objective 1.219890050342e+04, best bound 1.219890050342e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 265.11s
  Master Objective (UB) = 12198.90, θ = 129902.11
  Upper Bound (UB) = 12198.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 129902.11
  [DEBUG]   ✓ Scenario 0: θ = 129902.11 ≤ Q = 129902.11 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xf4d76b3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0f4d76b3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-01, 2e+02]
Found heuristic solution: objective 1.250937e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6600365.1398
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.314585e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -131458.52    0  126 6600365.14 -131458.52   102%     -    0s
H    0     0                    -94094.85321 -131458.52  39.7%     -    0s
H    0     0                    -94520.06458 -131458.52  39.1%     -    0s
*    0     0               0    -98473.88370 -98473.884  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 213

Explored 1 nodes (385 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -98473.9 -94520.1 -94094.9 ... 1.25094e+13
No other solutions better than -98473.9

Optimal solution found (tolerance 1.00e-04)
Best objective -9.847388370342e+04, best bound -9.847388370342e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 99744.73
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98473.88
  [DEBUG]   S×d_nominal = 198218.61
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198218.61 + -98473.88 = 99744.73
  [DEBUG]   Current θ from Master = 129902.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 30157.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17958.48
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 30157.3787, Absolute Gap = 30157.3787, Relative Gap = 2.472139
  Not converged yet (gap = 30157.38 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0x64dd0ca3
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -17958.5 (0.02s)
MIP start from previous solve produced solution with objective -17958.5 (0.02s)
Loaded MIP start from previous solve with objective -17958.5

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.48s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.310235e+04, 11073 iterations, 2.42 seconds (3.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13102.3505    0  489 -17958.478 13102.3505   173%     -    3s
H    0     0                    -16048.18894 13102.3505   182%     -    3s
H    0     0                    -15916.37335 13102.3505   182%     -    3s
     0     0 4662.44021    0  646 -15916.373 4662.44021   129%     -    6s
H    0     0                    -15520.74117 4654.76573   130%     -    6s
H    0     0                    -15319.29663 4654.76573   130%     -    6s
H    0     0                    -15297.17715 4654.76573   130%     -    6s
     0     0 4480.22410    0  659 -15297.177 4480.22410   129%     -    6s
     0     0 4479.11221    0  654 -15297.177 4479.11221   129%     -    6s
H    0     0                    -15275.94037  587.28467   104%     -   10s
     0     0  587.28467    0  583 -15275.940  587.28467   104%     -   10s
H    0     0                    -15137.25228  583.30774   104%     -   10s
H    0     0                    -14544.21067  -18.80160   100%     -   11s
H    0     0                    -14530.42246  -18.80160   100%     -   11s
     0     0  -18.80160    0  613 -14530.422  -18.80160   100%     -   11s
     0     0  -92.34933    0  617 -14530.422  -92.34933  99.4%     -   11s
     0     0 -102.07376    0  631 -14530.422 -102.07376  99.3%     -   12s
     0     0 -102.38710    0  632 -14530.422 -102.38710  99.3%     -   12s
H    0     0                    -14496.85743 -2304.1684  84.1%     -   16s
H    0     0                    -14491.88784 -2304.1684  84.1%     -   16s
H    0     0                    -14396.52305 -2304.1684  84.0%     -   16s
H    0     0                    -14391.55346 -2304.1684  84.0%     -   16s
H    0     0                    -14369.43398 -2304.1684  84.0%     -   16s
H    0     0                    -14322.24323 -2304.1684  83.9%     -   16s
H    0     0                    -14317.27364 -2304.1684  83.9%     -   16s
H    0     0                    -14309.60763 -2304.1684  83.9%     -   16s
H    0     0                    -14304.63804 -2304.1684  83.9%     -   16s
H    0     0                    -14303.57786 -2304.1684  83.9%     -   16s
H    0     0                    -14289.42479 -2304.1684  83.9%     -   16s
H    0     0                    -14264.74612 -2304.1684  83.8%     -   16s
H    0     0                    -14262.88285 -2304.1684  83.8%     -   16s
H    0     0                    -14254.12848 -2304.1684  83.8%     -   16s
H    0     0                    -14253.09883 -2304.1684  83.8%     -   16s
H    0     0                    -14250.13431 -2304.1684  83.8%     -   16s
H    0     0                    -14230.49354 -2304.1684  83.8%     -   16s
H    0     0                    -14221.13896 -2304.1684  83.8%     -   16s
     0     0 -2304.1684    0  614 -14221.139 -2304.1684  83.8%     -   16s
H    0     0                    -14066.17932 -2305.8705  83.6%     -   16s
H    0     0                    -14017.02025 -2305.8705  83.5%     -   16s
     0     0 -2816.9878    0  712 -14017.020 -2816.9878  79.9%     -   18s
     0     0 -2882.7843    0  640 -14017.020 -2882.7843  79.4%     -   18s
     0     0 -2905.8288    0  697 -14017.020 -2905.8288  79.3%     -   19s
     0     0 -2938.9178    0  704 -14017.020 -2938.9178  79.0%     -   19s
     0     0 -2949.0793    0  705 -14017.020 -2949.0793  79.0%     -   19s
     0     0 -2952.6832    0  718 -14017.020 -2952.6832  78.9%     -   20s
     0     0 -3977.3889    0  507 -14017.020 -3977.3889  71.6%     -   25s
H    0     0                    -13828.19129 -3979.9600  71.2%     -   25s
H    0     0                    -13597.55304 -3979.9600  70.7%     -   25s
H    0     0                    -13580.79255 -3979.9600  70.7%     -   25s
H    0     0                    -13578.88627 -3979.9600  70.7%     -   25s
     0     0 -4517.9409    0  537 -13578.886 -4517.9409  66.7%     -   27s
     0     0 -4580.4106    0  541 -13578.886 -4580.4106  66.3%     -   28s
     0     0 -4588.5917    0  532 -13578.886 -4588.5917  66.2%     -   28s
     0     0 -4593.5361    0  533 -13578.886 -4593.5361  66.2%     -   28s
     0     0 -4809.1963    0  507 -13578.886 -4809.1963  64.6%     -   30s
     0     0 -4884.4832    0  515 -13578.886 -4884.4832  64.0%     -   31s
     0     0 -4897.7745    0  515 -13578.886 -4897.7745  63.9%     -   31s
     0     0 -4902.9729    0  524 -13578.886 -4902.9729  63.9%     -   32s
     0     0 -5000.6464    0  498 -13578.886 -5000.6464  63.2%     -   33s
H    0     0                    -13148.88169 -5000.6711  62.0%     -   35s
H    0     0                    -13110.79170 -5000.6711  61.9%     -   35s
H    0     0                    -13101.72181 -5000.6711  61.8%     -   35s
     0     0 -5020.7673    0  511 -13101.722 -5020.7673  61.7%     -   36s
     0     0 -5027.1829    0  501 -13101.722 -5027.1829  61.6%     -   36s
     0     0 -5173.6304    0  486 -13101.722 -5173.6304  60.5%     -   37s
     0     0 -5259.5656    0  499 -13101.722 -5259.5656  59.9%     -   38s
     0     0 -5282.7060    0  491 -13101.722 -5282.7060  59.7%     -   39s
     0     0 -5285.0799    0  494 -13101.722 -5285.0799  59.7%     -   39s
     0     0 -5356.9143    0  520 -13101.722 -5356.9143  59.1%     -   40s
     0     0 -5373.4444    0  508 -13101.722 -5373.4444  59.0%     -   41s
     0     0 -5377.3889    0  513 -13101.722 -5377.3889  59.0%     -   41s
     0     0 -5426.6444    0  515 -13101.722 -5426.6444  58.6%     -   42s
     0     0 -5446.8915    0  509 -13101.722 -5446.8915  58.4%     -   42s
     0     0 -5454.1091    0  517 -13101.722 -5454.1091  58.4%     -   43s
     0     0 -5484.7129    0  510 -13101.722 -5484.7129  58.1%     -   44s
     0     0 -5484.8264    0  510 -13101.722 -5484.8264  58.1%     -   44s
H    0     0                    -13094.62171 -5484.9633  58.1%     -   54s
H    0     0                    -13058.99470 -5484.9633  58.0%     -   54s
H    0     0                    -13016.49817 -5484.9633  57.9%     -   54s
H    0     0                    -12601.48642 -5484.9633  56.5%     -   55s
H    0     0                    -12565.85941 -5484.9633  56.4%     -   55s
     0     2 -5484.9633    0  510 -12565.859 -5484.9633  56.4%     -   55s
    15    30 -11298.103    4  552 -12565.859 -6749.3846  46.3%  1629   62s
H   32    38                    -12536.33538 -7552.0595  39.8%  1748   63s
H   34    38                    -12480.66253 -7552.0595  39.5%  1695   63s
    93    80 -7831.3342    7  246 -12480.663 -7767.5885  37.8%  1120   65s
H  342   262                    -12477.87395 -7831.6859  37.2%   552   68s
   426   301 -8885.2301   17  244 -12477.874 -7831.6859  37.2%   527   71s
   618   354 -9986.2421   22  341 -12477.874 -8007.5358  35.8%   510   75s
   976   492 -9332.9643   14  524 -12477.874 -8172.0279  34.5%   477   80s
  1206   476 -9888.9071   17  284 -12477.874 -8172.0279  34.5%   465   85s
  1607   404     cutoff   17      -12477.874 -8476.1630  32.1%   441   90s
  2032   347 -11467.203   14  301 -12477.874 -9662.9144  22.6%   448   96s
  2333   296     cutoff   25      -12477.874 -9969.1058  20.1%   442  100s
  2802   169 -12064.306   15  404 -12477.874 -10403.786  16.6%   429  105s
  3358     0     cutoff   12      -12477.874 -12027.982  3.61%   396  110s

Cutting planes:
  Gomory: 14
  Implied bound: 12
  MIR: 1929
  Flow cover: 854
  Zero half: 5
  RLT: 85
  Relax-and-lift: 472

Explored 3365 nodes (1380165 simplex iterations) in 110.06 seconds (175.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12477.9 -12480.7 -12536.3 ... -13110.8
No other solutions better than -12477.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.247787394754e+04, best bound -1.247787394754e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 110.07s
  Master Objective (UB) = -12477.87, θ = 101957.54
  Upper Bound (UB) = -12477.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 101957.54
  [DEBUG]   ✓ Scenario 0: θ = 101957.54 ≤ Q = 101957.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 101957.54 ≤ Q = 101957.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x42c00ba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x042c00ba
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.261506e+13
Presolve removed 2566 rows and 1858 columns
Presolve time: 0.01s
Presolved: 527 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 6634733.9844
Variable types: 358 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6634461.4436

Root relaxation: objective -1.417648e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141764.84    0  135 6634461.44 -141764.84   102%     -    0s
H    0     0                    -118639.6484 -141764.84  19.5%     -    0s
H    0     0                    -126884.9176 -141764.84  11.7%     -    0s
     0     0 -129433.10    0  101 -126884.92 -129433.10  2.01%     -    0s
H    0     0                    -127530.6364 -129405.49  1.47%     -    0s
H    0     0                    -127806.8969 -129405.49  1.25%     -    0s
     0     0 -129269.56    0   98 -127806.90 -129269.56  1.14%     -    0s
     0     0 -128605.87    0   54 -127806.90 -128605.87  0.63%     -    0s
     0     0 -128460.55    0   60 -127806.90 -128460.55  0.51%     -    0s
     0     0 -128460.55    0   62 -127806.90 -128460.55  0.51%     -    0s
     0     0 -128426.73    0   62 -127806.90 -128426.73  0.48%     -    0s
     0     0 -128121.24    0   39 -127806.90 -128121.24  0.25%     -    0s
     0     0 -128030.30    0   38 -127806.90 -128030.30  0.17%     -    0s
     0     0 -128030.29    0   37 -127806.90 -128030.29  0.17%     -    0s
     0     0 -128027.13    0   37 -127806.90 -128027.13  0.17%     -    0s
     0     0 -127828.40    0    6 -127806.90 -127828.40  0.02%     -    0s
     0     0          -    0      -127806.90 -127812.11  0.00%     -    0s

Explored 1 nodes (786 simplex iterations) in 0.15 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -127807 -127735 -127717 ... 1.26151e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.278068968908e+05, best bound -1.278121055021e+05, gap 0.0041%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 79370.72
  Scenario: 49 demand increases, 11 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127806.90
  [DEBUG]   S×d_nominal = 207177.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 207177.62 + -127806.90 = 79370.72
  [DEBUG]   Current θ from Master = 101957.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22586.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -35064.70
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 5480.6043, Absolute Gap = 5480.6043, Relative Gap = 0.439226
  Not converged yet (gap = 5480.60 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 49 increases, 11 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0x0cba270c
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -35064.7 (0.03s)
MIP start from previous solve produced solution with objective -35064.7 (0.03s)
Loaded MIP start from previous solve with objective -35064.7

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.76s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26917   -4.8192691e+03   0.000000e+00   5.381534e+07      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20334    2.3291542e+03   0.000000e+00   0.000000e+00      9s

Root relaxation: objective 2.329154e+03, 20334 iterations, 7.76 seconds (9.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2329.15421    0  335 -35064.696 2329.15421   107%     -    8s
H    0     0                    -34336.07218 2329.15421   107%     -    8s
H    0     0                    -34156.92622 2329.15421   107%     -    9s
H    0     0                    -30111.65579 2329.15421   108%     -    9s
H    0     0                    -28996.59824 2329.15421   108%     -    9s
H    0     0                    -28988.95081 2329.15421   108%     -    9s
H    0     0                    -28933.31467 2329.15421   108%     -    9s
     0     0 -1253.7347    0  348 -28933.315 -1253.7347  95.7%     -   14s
     0     0 -1674.6194    0  342 -28933.315 -1674.6194  94.2%     -   15s
     0     0 -1848.8965    0  361 -28933.315 -1848.8965  93.6%     -   17s
     0     0 -1848.8965    0  361 -28933.315 -1848.8965  93.6%     -   17s
     0     0 -1848.9063    0  360 -28933.315 -1848.9063  93.6%     -   17s
H    0     0                    -28232.02198 -3865.2895  86.3%     -   21s
     0     0 -3866.9004    0  398 -28232.022 -3866.9004  86.3%     -   21s
H    0     0                    -28165.82038 -3866.9004  86.3%     -   21s
     0     0 -4357.6689    0  417 -28165.820 -4357.6689  84.5%     -   23s
     0     0 -4422.3812    0  428 -28165.820 -4422.3812  84.3%     -   24s
     0     0 -4426.0957    0  427 -28165.820 -4426.0957  84.3%     -   24s
     0     0 -4429.8023    0  433 -28165.820 -4429.8023  84.3%     -   24s
     0     0 -4429.8845    0  431 -28165.820 -4429.8845  84.3%     -   24s
H    0     0                    -28096.04617 -5724.5669  79.6%     -   31s
     0     0 -5724.5669    0  453 -28096.046 -5724.5669  79.6%     -   31s
H    0     0                    -28068.19720 -5940.6294  78.8%     -   33s
H    0     0                    -28064.26161 -5940.6294  78.8%     -   33s
     0     0 -5940.6294    0  453 -28064.262 -5940.6294  78.8%     -   33s
     0     0 -6107.0891    0  443 -28064.262 -6107.0891  78.2%     -   34s
     0     0 -6151.2123    0  446 -28064.262 -6151.2123  78.1%     -   35s
     0     0 -6171.3726    0  433 -28064.262 -6171.3726  78.0%     -   36s
     0     0 -6213.2050    0  434 -28064.262 -6213.2050  77.9%     -   36s
     0     0 -6218.1196    0  427 -28064.262 -6218.1196  77.8%     -   36s
     0     0 -6218.7917    0  430 -28064.262 -6218.7917  77.8%     -   36s
     0     0 -6832.5818    0  476 -28064.262 -6832.5818  75.7%     -   42s
H    0     0                    -28055.44299 -6833.3492  75.6%     -   42s
     0     0 -6981.0342    0  454 -28055.443 -6981.0342  75.1%     -   44s
     0     0 -7012.8088    0  466 -28055.443 -7012.8088  75.0%     -   45s
     0     0 -7026.2438    0  466 -28055.443 -7026.2438  75.0%     -   45s
     0     0 -7031.9697    0  470 -28055.443 -7031.9697  74.9%     -   45s
     0     0 -7034.4326    0  472 -28055.443 -7034.4326  74.9%     -   46s
     0     0 -7035.5310    0  473 -28055.443 -7035.5310  74.9%     -   46s
     0     0 -7189.6439    0  464 -28055.443 -7189.6439  74.4%     -   49s
H    0     0                    -25733.65645 -7237.4487  71.9%     -   50s
H    0     0                    -23689.20872 -7237.4487  69.4%     -   50s
     0     0 -7237.4487    0  465 -23689.209 -7237.4487  69.4%     -   50s
H    0     0                    -21143.90649 -7246.1656  65.7%     -   50s
H    0     0                    -21110.88644 -7246.1656  65.7%     -   50s
H    0     0                    -21071.67058 -7246.1656  65.6%     -   50s
H    0     0                    -15581.41102 -7246.1656  53.5%     -   50s
H    0     0                    -15471.01729 -7246.1656  53.2%     -   50s
     0     0 -7246.1656    0  468 -15471.017 -7246.1656  53.2%     -   50s
H    0     0                    -15440.68745 -7250.9385  53.0%     -   50s
H    0     0                    -15407.35316 -7250.9385  52.9%     -   50s
H    0     0                    -15381.48796 -7250.9385  52.9%     -   50s
     0     0 -7250.9385    0  482 -15381.488 -7250.9385  52.9%     -   50s
     0     0 -7252.8786    0  475 -15381.488 -7252.8786  52.8%     -   51s
     0     0 -7253.2948    0  473 -15381.488 -7253.2948  52.8%     -   51s
H    0     0                    -15374.65204 -7253.2948  52.8%     -   51s
H    0     0                    -15371.01577 -7253.2948  52.8%     -   51s
     0     0 -7302.0584    0  463 -15371.016 -7302.0584  52.5%     -   52s
H    0     0                    -15308.73128 -7302.1616  52.3%     -   53s
H    0     0                    -15304.19483 -7302.1616  52.3%     -   53s
H    0     0                    -15293.54732 -7302.1616  52.3%     -   54s
H    0     0                    -15231.42816 -7302.1616  52.1%     -   54s
H    0     0                    -15099.24962 -7302.1616  51.6%     -   54s
H    0     0                    -15090.55259 -7302.1616  51.6%     -   54s
H    0     0                    -15084.38075 -7302.1616  51.6%     -   54s
H    0     0                    -15046.05400 -7302.1616  51.5%     -   54s
H    0     0                    -15018.55798 -7323.4616  51.2%     -   54s
H    0     0                    -14935.39455 -7323.4616  51.0%     -   54s
H    0     0                    -14930.38861 -7323.4616  50.9%     -   54s
H    0     0                    -14866.49598 -7323.4616  50.7%     -   54s
H    0     0                    -14782.44661 -7323.4616  50.5%     -   54s
H    0     0                    -14761.62860 -7323.4616  50.4%     -   54s
     0     0 -7323.4616    0  473 -14761.629 -7323.4616  50.4%     -   54s
H    0     0                    -14733.58328 -7330.3092  50.2%     -   55s
     0     0 -7330.3092    0  475 -14733.583 -7330.3092  50.2%     -   55s
     0     0 -7333.5639    0  479 -14733.583 -7333.5639  50.2%     -   55s
     0     0 -7335.5704    0  481 -14733.583 -7335.5704  50.2%     -   55s
     0     0 -7336.1748    0  485 -14733.583 -7336.1748  50.2%     -   56s
     0     0 -7356.1401    0  482 -14733.583 -7356.1401  50.1%     -   57s
     0     0 -7362.8422    0  483 -14733.583 -7362.8422  50.0%     -   58s
     0     0 -7363.7780    0  490 -14733.583 -7363.7780  50.0%     -   58s
     0     0 -7383.2719    0  482 -14733.583 -7383.2719  49.9%     -   59s
     0     0 -7385.7350    0  496 -14733.583 -7385.7350  49.9%     -   60s
     0     0 -7387.3554    0  498 -14733.583 -7387.3554  49.9%     -   60s
     0     0 -7388.9372    0  491 -14733.583 -7388.9372  49.8%     -   60s
     0     0 -7389.1182    0  497 -14733.583 -7389.1182  49.8%     -   60s
     0     0 -7402.7240    0  497 -14733.583 -7402.7240  49.8%     -   61s
     0     0 -7405.5458    0  510 -14733.583 -7405.5458  49.7%     -   62s
     0     0 -7406.6428    0  501 -14733.583 -7406.6428  49.7%     -   62s
     0     0 -7413.1392    0  506 -14733.583 -7413.1392  49.7%     -   63s
     0     0 -7414.2472    0  505 -14733.583 -7414.2472  49.7%     -   63s
     0     0 -7415.8449    0  513 -14733.583 -7415.8449  49.7%     -   64s
     0     0 -7418.0810    0  510 -14733.583 -7418.0810  49.7%     -   65s
     0     0 -7418.4389    0  510 -14733.583 -7418.4389  49.6%     -   65s
     0     0 -7420.7807    0  508 -14733.583 -7420.7807  49.6%     -   66s
     0     0 -7423.9964    0  508 -14733.583 -7423.9964  49.6%     -   66s
H    0     0                    -14487.81024 -7423.9964  48.8%     -   74s
H    0     0                    -14417.97491 -7423.9964  48.5%     -   74s
H    0     0                    -14262.04448 -7423.9964  47.9%     -   74s
H    0     0                    -14228.15733 -7423.9964  47.8%     -   74s
H    0     0                    -14188.40349 -7423.9964  47.7%     -   75s
H    0     0                    -14104.01355 -7423.9964  47.4%     -   78s
H    0     0                    -14093.46562 -7423.9964  47.3%     -   79s
     0     2 -7423.9964    0  508 -14093.466 -7423.9964  47.3%     -   79s
     1     4 -7450.3228    1  495 -14093.466 -7427.5045  47.3%   529   80s
    15    32 -8017.3777    4  471 -14093.466 -7786.1577  44.8%  1881   88s
    31    64 -8087.5342    5  475 -14093.466 -7969.8552  43.4%  3116   91s
H  111   128                    -14086.58975 -7994.0721  43.3%  1583   94s
   127   210 -8226.3997    8  470 -14086.590 -7994.0721  43.3%  1482   98s
   211   265 -8709.4774    9  514 -14086.590 -7994.0721  43.3%  1247  101s
   324   329 -13193.081   10  249 -14086.590 -8054.5545  42.8%  1150  109s
   373   363 -9049.6445   11  374 -14086.590 -8054.5545  42.8%  1123  112s
   421   384 -9277.5310   11  376 -14086.590 -8087.6454  42.6%  1101  115s
   499   442 -9531.2110   12  424 -14086.590 -8087.6454  42.6%  1172  121s
   575   507 -10828.498   13  366 -14086.590 -8087.6454  42.6%  1175  127s
   608   524 -11041.647   14  491 -14086.590 -8087.6454  42.6%  1195  130s
   693   574 -12074.383   16  385 -14086.590 -8259.5069  41.4%  1191  137s
   729   600 -11614.451   16  437 -14086.590 -8259.5069  41.4%  1223  140s
   808   639 infeasible   17      -14086.590 -8335.9033  40.8%  1217  146s
   855   661 -12685.631   19  424 -14086.590 -8335.9033  40.8%  1204  151s
   956   708 -12905.177   21  411 -14086.590 -8355.9025  40.7%  1197  158s
  1007   728 -13094.419   23  342 -14086.590 -8355.9025  40.7%  1200  163s
  1074   754 -13866.878   27  335 -14086.590 -8447.6312  40.0%  1193  166s
  1144   770     cutoff   29      -14086.590 -8447.6312  40.0%  1168  170s
  1208   797 -13685.538   30  338 -14086.590 -8541.5394  39.4%  1163  175s
  1359   897     cutoff   10      -14086.590 -8603.8036  38.9%  1144  182s
  1471   954 -10235.342    9  411 -14086.590 -8603.8036  38.9%  1111  188s
  1625  1016 -10347.547   10  415 -14086.590 -8656.9860  38.5%  1065  193s
  1751  1069 -11314.067   13  337 -14086.590 -8704.5946  38.2%  1044  198s
  1913  1134 -11856.403   15  246 -14086.590 -8704.5946  38.2%  1011  202s
  2076  1151 -13457.763   19  119 -14086.590 -8740.5414  38.0%   983  206s
  2197  1203     cutoff   10      -14086.590 -8758.4256  37.8%   974  211s
  2328  1260 -12781.511   10  201 -14086.590 -8758.4256  37.8%   969  216s
  2521  1307 -13621.905   12  200 -14086.590 -8758.4256  37.8%   948  222s
  2666  1342 -12077.476   13  320 -14086.590 -9000.1596  36.1%   945  227s
  2818  1351 -13507.715   16  294 -14086.590 -9000.1596  36.1%   946  232s
  2954  1380     cutoff   17      -14086.590 -9056.8741  35.7%   938  237s
  3106  1404 -10684.472   11  337 -14086.590 -9142.0500  35.1%   941  242s
  3259  1437 -12344.394   12  288 -14086.590 -9215.9334  34.6%   948  249s
  3384  1453 -12752.251   14  287 -14086.590 -9241.2810  34.4%   950  254s
  3553  1460 -13776.262   17  309 -14086.590 -9349.9729  33.6%   952  263s
  3751  1460 -12919.043   17  320 -14086.590 -9349.9729  33.6%   955  269s
  3911  1458     cutoff   17      -14086.590 -9438.7855  33.0%   962  276s
  4065  1457 -11585.165   14  325 -14086.590 -9584.1028  32.0%   974  282s
  4269  1450     cutoff   17      -14086.590 -9584.1028  32.0%   974  287s
  4461  1446 -12572.338   18  402 -14086.590 -9860.1167  30.0%   979  293s
  4533  1444     cutoff   19      -14086.590 -9860.1167  30.0%   984  299s
H 4537  1444                    -14085.35896 -9860.1167  30.0%   985  299s
  4617  1445 -13701.601   19  291 -14085.359 -9956.1293  29.3%   989  306s
  4847  1421 -12829.430   13  179 -14085.359 -10018.641  28.9%   990  313s
  5120  1394     cutoff   13      -14085.359 -10316.259  26.8%   987  323s
  5384  1401 infeasible   17      -14085.359 -10618.108  24.6%   985  330s
  5683  1394 -12930.836   20  377 -14085.359 -10741.875  23.7%   978  337s
  5983  1330     cutoff   21      -14085.359 -10825.616  23.1%   971  345s
  6301  1260 -13675.391   14  201 -14085.359 -10999.682  21.9%   964  355s
  6643  1194     cutoff   32      -14085.359 -11231.993  20.3%   959  363s
  7047  1064     cutoff   14      -14085.359 -11385.354  19.2%   947  373s
  7555   935 -13125.215   20  293 -14085.359 -11742.033  16.6%   928  381s
  7993   788 -13550.868   13  158 -14085.359 -11927.795  15.3%   915  389s
  8547   513     cutoff   12      -14085.359 -12216.990  13.3%   896  397s
  9238   447     cutoff   18      -14085.359 -12619.248  10.4%   868  405s
  9366   330 infeasible   10      -14085.359 -12637.998  10.3%   862  413s
  9589   183     cutoff   11      -14085.359 -12766.643  9.36%   852  420s
  9844    19 infeasible   26      -14085.359 -12941.509  8.12%   837  428s
 10091     2     cutoff   20      -14085.359 -13304.516  5.54%   824  435s

Cutting planes:
  Implied bound: 20
  MIR: 492
  Flow cover: 722
  Zero half: 6
  RLT: 31
  Relax-and-lift: 39

Explored 10117 nodes (8405571 simplex iterations) in 438.30 seconds (876.71 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14085.4 -14086.6 -14093.5 ... -14733.6
No other solutions better than -14085.4

Optimal solution found (tolerance 1.00e-04)
Best objective -1.408535895863e+04, best bound -1.408535895863e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 438.33s
  Master Objective (UB) = -14085.36, θ = 103221.84
  Upper Bound (UB) = -14085.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 103221.84
  [DEBUG]   ✓ Scenario 0: θ = 103221.84 ≤ Q = 103221.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 103221.84 ≤ Q = 103221.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 103221.84 ≤ Q = 103221.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x18bd8d6d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe7427293
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.220906e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6175505.5883
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.416967e+05, 278 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141696.75    0  139 6175505.59 -141696.75   102%     -    0s
H    0     0                    -103148.1006 -141696.75  37.4%     -    0s
H    0     0                    -103892.3118 -141696.75  36.4%     -    0s
H    0     0                    -107864.0584 -141696.75  31.4%     -    0s
H    0     0                    -124936.1677 -128876.10  3.15%     -    0s
     0     0 -128876.10    0   70 -124936.17 -128876.10  3.15%     -    0s
H    0     0                    -126883.7020 -128819.60  1.53%     -    0s
H    0     0                    -127167.6423 -128819.60  1.30%     -    0s
H    0     0                    -127520.7687 -128819.60  1.02%     -    0s
H    0     0                    -127804.7091 -128819.60  0.79%     -    0s
     0     0 -128357.12    0   71 -127804.71 -128357.12  0.43%     -    0s
     0     0 -128352.86    0   73 -127804.71 -128352.86  0.43%     -    0s
     0     0 -127887.92    0   12 -127804.71 -127887.92  0.07%     -    0s
     0     0 -127879.52    0    5 -127804.71 -127879.52  0.06%     -    0s
H    0     0                    -127822.9808 -127878.55  0.04%     -    0s
     0     0 -127850.74    0    6 -127822.98 -127850.74  0.02%     -    0s
     0     0 -127850.12    0    6 -127822.98 -127850.12  0.02%     -    0s
H    0     0                    -127839.9590 -127850.12  0.01%     -    0s

Cutting planes:
  Gomory: 21
  Implied bound: 4
  MIR: 92
  Flow cover: 3
  RLT: 105
  Relax-and-lift: 2
  BQP: 3

Explored 1 nodes (600 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -127840 -127823 -127805 ... 1.22091e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.278399590318e+05, best bound -1.278501196757e+05, gap 0.0079%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 80777.88
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127839.96
  [DEBUG]   S×d_nominal = 208617.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208617.84 + -127839.96 = 80777.88
  [DEBUG]   Current θ from Master = 103221.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22443.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -36529.31
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 3873.1193, Absolute Gap = 3873.1193, Relative Gap = 0.274975
  Not converged yet (gap = 3873.12 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0x23bba571
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -36529.3 (0.12s)
Loaded MIP start from previous solve with objective -36529.3

Presolve removed 25452 rows and 10332 columns
Presolve time: 0.90s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40405   -2.3817915e+04   0.000000e+00   8.283569e+06      5s
   49705   -1.8702855e+03   0.000000e+00   1.217257e+06     10s
Concurrent spin time: 0.35s

Solved with dual simplex

Root relaxation: objective 2.268578e+03, 22505 iterations, 10.21 seconds (13.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2268.57807    0  340 -36529.311 2268.57807   106%     -   11s
H    0     0                    -33087.40956 2268.57807   107%     -   11s
H    0     0                    -24712.20095 2268.57807   109%     -   13s
H    0     0                    -23115.62440 2268.57807   110%     -   13s
     0     0 -1815.9076    0  365 -23115.624 -1815.9076  92.1%     -   20s
H    0     0                    -23108.53034 -1815.9076  92.1%     -   20s
     0     0 -2186.8126    0  280 -23108.530 -2186.8126  90.5%     -   24s
     0     0 -2186.8126    0  378 -23108.530 -2186.8126  90.5%     -   25s
     0     0 -2186.8126    0  376 -23108.530 -2186.8126  90.5%     -   27s
H    0     0                    -22705.09733 -2186.8126  90.4%     -   27s
     0     0 -3548.8179    0  375 -22705.097 -3548.8179  84.4%     -   27s
H    0     0                    -22420.10494 -3548.8179  84.2%     -   27s
H    0     0                    -21088.35612 -3548.8179  83.2%     -   27s
H    0     0                    -20995.11604 -3548.8179  83.1%     -   27s
     0     0 -3548.9708    0  379 -20995.116 -3548.9708  83.1%     -   27s
     0     0 -3548.9708    0  401 -20995.116 -3548.9708  83.1%     -   33s
H    0     0                    -17267.88458 -3548.9708  79.4%     -   34s
H    0     0                    -16827.74933 -3548.9708  78.9%     -   34s
H    0     0                    -16736.50805 -3548.9708  78.8%     -   34s
H    0     0                    -16716.57131 -3548.9708  78.8%     -   34s
     0     0 -4012.8654    0  411 -16716.571 -4012.8654  76.0%     -   38s
     0     0 -4107.6189    0  404 -16716.571 -4107.6189  75.4%     -   39s
     0     0 -4197.1241    0  403 -16716.571 -4197.1241  74.9%     -   40s
     0     0 -4200.7852    0  412 -16716.571 -4200.7852  74.9%     -   40s
     0     0 -4201.2507    0  412 -16716.571 -4201.2507  74.9%     -   41s
H    0     0                    -16419.01092 -4201.2507  74.4%     -   44s
H    0     0                    -16253.72827 -4201.2507  74.2%     -   44s
H    0     0                    -15982.94136 -4201.2507  73.7%     -   44s
H    0     0                    -15974.79717 -4201.2507  73.7%     -   44s
H    0     0                    -15965.98960 -4201.2507  73.7%     -   44s
H    0     0                    -15964.34385 -4201.2507  73.7%     -   44s
H    0     0                    -15964.24674 -4201.2507  73.7%     -   44s
H    0     0                    -15828.40135 -5491.4505  65.3%     -   51s
H    0     0                    -15774.34090 -5491.4505  65.2%     -   51s
     0     0 -5491.4505    0  458 -15774.341 -5491.4505  65.2%     -   51s
H    0     0                    -15627.41822 -5501.3986  64.8%     -   52s
     0     0 -5886.2423    0  443 -15627.418 -5886.2423  62.3%     -   55s
H    0     0                    -15480.37432 -6090.3254  60.7%     -   57s
H    0     0                    -15467.63927 -6090.3254  60.6%     -   57s
H    0     0                    -15460.04037 -6090.3254  60.6%     -   57s
H    0     0                    -15430.55688 -6090.3254  60.5%     -   57s
     0     0 -6090.3254    0  444 -15430.557 -6090.3254  60.5%     -   57s
     0     0 -6150.5312    0  448 -15430.557 -6150.5312  60.1%     -   58s
     0     0 -6167.8197    0  458 -15430.557 -6167.8197  60.0%     -   58s
     0     0 -6169.1908    0  463 -15430.557 -6169.1908  60.0%     -   59s
     0     0 -6176.6241    0  469 -15430.557 -6176.6241  60.0%     -   59s
     0     0 -6180.5241    0  474 -15430.557 -6180.5241  59.9%     -   59s
     0     0 -6180.5633    0  474 -15430.557 -6180.5633  59.9%     -   59s
     0     0 -6667.7159    0  413 -15430.557 -6667.7159  56.8%     -   70s
H    0     0                    -15384.87471 -6667.8753  56.7%     -   71s
     0     0 -6848.2636    0  478 -15384.875 -6848.2636  55.5%     -   74s
H    0     0                    -15375.52013 -6929.1309  54.9%     -   77s
     0     0 -6929.1309    0  501 -15375.520 -6929.1309  54.9%     -   77s
     0     0 -6944.6368    0  506 -15375.520 -6944.6368  54.8%     -   78s
     0     0 -6972.0036    0  495 -15375.520 -6972.0036  54.7%     -   79s
     0     0 -6976.1913    0  509 -15375.520 -6976.1913  54.6%     -   79s
     0     0 -6976.8141    0  508 -15375.520 -6976.8141  54.6%     -   79s
     0     0 -7185.7895    0  512 -15375.520 -7185.7895  53.3%     -   84s
     0     0 -7250.3896    0  509 -15375.520 -7250.3896  52.8%     -   85s
     0     0 -7270.5525    0  500 -15375.520 -7270.5525  52.7%     -   87s
     0     0 -7277.7080    0  509 -15375.520 -7277.7080  52.7%     -   87s
     0     0 -7278.9892    0  515 -15375.520 -7278.9892  52.7%     -   88s
     0     0 -7279.2920    0  519 -15375.520 -7279.2920  52.7%     -   88s
     0     0 -7433.8074    0  518 -15375.520 -7433.8074  51.7%     -   92s
     0     0 -7470.0013    0  528 -15375.520 -7470.0013  51.4%     -   93s
     0     0 -7499.8583    0  526 -15375.520 -7499.8583  51.2%     -   94s
     0     0 -7506.2762    0  522 -15375.520 -7506.2762  51.2%     -   94s
     0     0 -7508.1377    0  533 -15375.520 -7508.1377  51.2%     -   94s
     0     0 -7509.4599    0  529 -15375.520 -7509.4599  51.2%     -   94s
     0     0 -7509.8898    0  530 -15375.520 -7509.8898  51.2%     -   95s
     0     0 -7553.8933    0  507 -15375.520 -7553.8933  50.9%     -   97s
     0     0 -7567.0675    0  498 -15375.520 -7567.0675  50.8%     -   97s
     0     0 -7569.4081    0  508 -15375.520 -7569.4081  50.8%     -   98s
     0     0 -7570.6241    0  512 -15375.520 -7570.6241  50.8%     -   98s
     0     0 -7593.0380    0  519 -15375.520 -7593.0380  50.6%     -  100s
     0     0 -7597.9553    0  525 -15375.520 -7597.9553  50.6%     -  100s
     0     0 -7599.1864    0  530 -15375.520 -7599.1864  50.6%     -  100s
H    0     0                    -15364.65909 -7599.1864  50.5%     -  101s
H    0     0                    -15297.64322 -7599.1864  50.3%     -  101s
H    0     0                    -15297.12561 -7599.1864  50.3%     -  101s
H    0     0                    -15279.48528 -7599.1864  50.3%     -  101s
     0     0 -7603.9362    0  518 -15279.485 -7603.9362  50.2%     -  102s
     0     0 -7605.1875    0  524 -15279.485 -7605.1875  50.2%     -  102s
     0     0 -7610.4460    0  514 -15279.485 -7610.4460  50.2%     -  103s
     0     0 -7610.8998    0  526 -15279.485 -7610.8998  50.2%     -  104s
     0     0 -7613.9793    0  520 -15279.485 -7613.9793  50.2%     -  105s
     0     0 -7614.0161    0  520 -15279.485 -7614.0161  50.2%     -  106s
H    0     0                    -15270.26541 -7614.0305  50.1%     -  121s
H    0     0                    -15086.19757 -7614.0305  49.5%     -  121s
H    0     0                    -15044.44409 -7614.0305  49.4%     -  121s
H    0     0                    -14986.38558 -7614.0305  49.2%     -  121s
     0     2 -7614.0305    0  520 -14986.386 -7614.0305  49.2%     -  122s
     3     8 -7948.4585    2  488 -14986.386 -7806.0947  47.9%  2046  129s
     7    16 -8157.0046    3  564 -14986.386 -7921.9640  47.1%  2523  137s
    15    32 -8216.2686    4  513 -14986.386 -8003.8449  46.6%  3292  142s
    31    48 -8099.8158    5  488 -14986.386 -8045.5500  46.3%  3691  153s
    47    80 -8548.1372    6  409 -14986.386 -8045.5500  46.3%  3994  157s
H   48    80                    -14961.72325 -8045.5500  46.2%  3911  157s
    79   152 -8616.8673    7  396 -14961.723 -8045.5500  46.2%  3205  166s
   163   181 -8918.8862    9  267 -14961.723 -8045.5500  46.2%  2211  175s
   197   222 -8975.8350   10  273 -14961.723 -8045.5500  46.2%  2070  189s
   248   251 -8997.5413   11  253 -14961.723 -8045.5500  46.2%  1903  194s
   295   276 -8802.7100    9  370 -14961.723 -8045.5500  46.2%  1786  202s
   354   300 -9028.9352   12  260 -14961.723 -8118.3501  45.7%  1655  209s
H  394   300                    -14950.74372 -8120.0178  45.7%  1712  209s
   409   358 -10669.055   13  425 -14950.744 -8120.0178  45.7%  1739  216s
H  424   358                    -14935.39455 -8120.0178  45.6%  1716  216s
   508   416 -10605.913   13  237 -14935.395 -8120.0178  45.6%  1692  224s
   602   476 -9276.2730   12  251 -14935.395 -8120.0178  45.6%  1722  231s
   696   522 -10471.557   12  231 -14935.395 -8216.7807  45.0%  1698  240s
   780   560 -10826.163   13  387 -14935.395 -8216.7807  45.0%  1721  245s
   846   580 -10813.928   13  210 -14935.395 -8301.3984  44.4%  1758  254s
   903   599 -11358.391   14  218 -14935.395 -8387.4243  43.8%  1728  259s
   946   628 -11847.029   14  338 -14935.395 -8387.4243  43.8%  1717  267s
  1005   671 -11606.445   14  196 -14935.395 -8431.2014  43.5%  1748  277s
  1091   732 -11694.924   14  339 -14935.395 -8431.2014  43.5%  1759  283s
  1210   793 -11646.492   15  366 -14935.395 -8576.5357  42.6%  1670  292s
  1323   863 infeasible   17      -14935.395 -8691.7072  41.8%  1626  298s
  1435   887 -12375.001   22  370 -14935.395 -8694.0288  41.8%  1584  305s
  1507   934 -12653.257   24  246 -14935.395 -8694.0288  41.8%  1567  312s
  1608   977 -12865.446   25  326 -14935.395 -8694.0288  41.8%  1544  319s
  1734  1040 -13278.827   28  193 -14935.395 -8694.0288  41.8%  1502  327s
  1853  1093     cutoff   29      -14935.395 -8745.9545  41.4%  1477  335s
  1992  1155 -14606.263   32  233 -14935.395 -8745.9545  41.4%  1445  345s
  2142  1178 -14641.786   11  212 -14935.395 -8858.5959  40.7%  1417  350s
  2183  1205 -14681.707   12  205 -14935.395 -8858.5959  40.7%  1408  356s
  2224  1219 infeasible   13      -14935.395 -8858.5959  40.7%  1402  365s
  2294  1250 -14050.814   12  196 -14935.395 -8880.3653  40.5%  1390  371s
H 2346  1250                    -14915.70481 -8922.8246  40.2%  1377  371s
  2381  1323 -11850.984   11  188 -14915.705 -8922.8246  40.2%  1369  381s
  2615  1358 -13087.527   12  274 -14915.705 -8922.8246  40.2%  1326  393s
  2835  1399 -14265.335   15  238 -14915.705 -8941.7740  40.1%  1301  404s
  3054  1429     cutoff   14      -14915.705 -9004.8168  39.6%  1281  417s
  3239  1488 -12558.835   16  345 -14915.705 -9014.0359  39.6%  1274  425s
  3396  1502     cutoff   18      -14915.705 -9121.2031  38.8%  1279  438s
  3508  1533 -14429.224   16  384 -14915.705 -9121.2031  38.8%  1278  450s
  3656  1562 -14449.405   17  325 -14915.705 -9121.2031  38.8%  1279  460s
  3843  1650 -14502.089   18  325 -14915.705 -9121.2031  38.8%  1272  470s
  4149  1727 -14590.631   19  299 -14915.705 -9121.2031  38.8%  1242  480s
  4421  1791 -13710.246   14  170 -14915.705 -9516.0436  36.2%  1226  491s
  4695  1869 -11285.161   12  409 -14915.705 -9516.0436  36.2%  1215  502s
  4937  1952 -14099.419   15  348 -14915.705 -9541.1023  36.0%  1213  513s
  5247  2031 -12445.087    8  331 -14915.705 -9623.8424  35.5%  1204  525s
  5523  2120 -13315.897   13  269 -14915.705 -10002.155  32.9%  1201  541s
  5858  2236     cutoff   36      -14915.705 -10083.548  32.4%  1190  556s
H 6180  2236                    -14914.13547 -10083.548  32.4%  1183  562s
  6181  2237 -11519.359    9  520 -14914.135 -10083.548  32.4%  1183  588s
  6183  2238 -14576.830   23  340 -14914.135 -10083.548  32.4%  1182  605s
H 6183  2126                    -14905.89252 -10083.548  32.4%  1182  620s
  6185  2128 -14594.659   45  525 -14905.893 -10083.548  32.4%  1182  630s
  6186  2128 -10813.073   17  471 -14905.893 -10083.548  32.4%  1182  636s
H 6186  2021                    -14903.08808 -10083.548  32.3%  1182  640s
  6189  2023 -13057.872    9  486 -14903.088 -10083.548  32.3%  1181  645s
  6193  2026 -12609.281   27  516 -14903.088 -10083.548  32.3%  1180  651s
H 6193  1925                    -14896.17574 -10083.548  32.3%  1180  656s
  6196  1927 -13554.775   27  545 -14896.176 -10083.548  32.3%  1180  661s
  6199  1929 -13287.063   46  533 -14896.176 -10083.548  32.3%  1179  670s
  6202  1931 -12422.944   15  604 -14896.176 -10083.548  32.3%  1179  679s
  6203  1932 -14161.075   16  548 -14896.176 -10083.548  32.3%  1178  681s
  6205  1933 -10679.801   20  528 -14896.176 -10083.548  32.3%  1178  687s
  6207  1934 -13462.182   30  546 -14896.176 -10083.548  32.3%  1178  694s
  6208  1935 -11153.997   19  536 -14896.176 -10083.548  32.3%  1177  697s
  6209  1936 -10709.992   11  531 -14896.176 -10083.548  32.3%  1177  701s
  6211  1937 -14092.676   16  547 -14896.176 -10083.548  32.3%  1177  707s
  6212  1938 -10804.534   12  547 -14896.176 -10083.548  32.3%  1177  726s
  6213  1938 -14087.438   44  547 -14896.176 -10083.548  32.3%  1177  737s
  6214  1942 -10083.548   12  526 -14896.176 -10083.548  32.3%  1192  747s
  6216  1945 -10083.548   13  527 -14896.176 -10083.548  32.3%  1193  755s
  6220  1952 -10083.548   14  530 -14896.176 -10083.548  32.3%  1194  762s
  6228  1963 -10083.548   15  529 -14896.176 -10083.548  32.3%  1197  775s
  6244  1974 -10083.548   16  535 -14896.176 -10083.548  32.3%  1209  786s
  6274  1984 -10083.548   17  585 -14896.176 -10083.548  32.3%  1224  798s
  6306  1999 -10083.548   18  582 -14896.176 -10083.548  32.3%  1248  809s
  6342  2006 -10083.548   19  571 -14896.176 -10083.548  32.3%  1254  820s
  6398  2027 -10544.059   21  552 -14896.176 -10083.548  32.3%  1260  827s
  6458  2039 -11342.664   21  472 -14896.176 -10083.548  32.3%  1265  833s
  6539  2019 -10942.907   22  499 -14896.176 -10083.548  32.3%  1267  844s
  6623  1995 -11227.821   22  486 -14896.176 -10083.548  32.3%  1268  854s
  6702  1989 -11621.480   23  469 -14896.176 -10083.548  32.3%  1272  865s
  6762  1993 -11619.951   23  473 -14896.176 -10565.325  29.1%  1275  874s
  6834  1969     cutoff   24      -14896.176 -10565.325  29.1%  1275  884s
  6907  1982 -12135.736   24  492 -14896.176 -10565.325  29.1%  1281  891s
  6975  1971 -14693.982   24  449 -14896.176 -10565.325  29.1%  1282  899s
  7042  1956 -12390.981   25  516 -14896.176 -10565.325  29.1%  1283  907s
  7124  1938     cutoff   25      -14896.176 -11035.803  25.9%  1282  915s
  7207  1911     cutoff   26      -14896.176 -11035.803  25.9%  1283  922s
  7292  1865     cutoff   27      -14896.176 -11076.337  25.6%  1284  929s
  7357  1833     cutoff   25      -14896.176 -11423.314  23.3%  1284  937s
H 7371  1730                    -14879.14605 -11561.506  22.3%  1285  937s
  7438  1664 -14404.525   18  257 -14879.146 -11561.506  22.3%  1284  946s
  7556  1566 -14485.542   19  283 -14879.146 -11651.896  21.7%  1283  954s
  7688  1463     cutoff   25      -14879.146 -11842.311  20.4%  1281  964s
H 7690  1369                    -14875.70570 -11842.311  20.4%  1282  964s
H 7730  1269                    -14867.71492 -12092.425  18.7%  1280  964s
  7795  1212 -14593.174   24  409 -14867.715 -12226.254  17.8%  1275  970s
  7912  1150 -13848.176   20  395 -14867.715 -12490.820  16.0%  1269  976s
  8027  1088 -13880.255   22  340 -14867.715 -12490.820  16.0%  1259  981s
  8154  1052     cutoff   23      -14867.715 -12490.820  16.0%  1246  985s
* 8185   958              66    -14863.41894 -12490.820  16.0%  1243  985s
* 8309   838              63    -14861.19221 -13834.080  6.91%  1225  985s
* 8338   715              60    -14859.89144 -13834.080  6.90%  1221  988s
* 8363   636              64    -14858.88274 -13834.080  6.90%  1218  988s
* 8406   553              61    -14857.86516 -14559.289  2.01%  1212  988s
* 8416   485              70    -14856.98828 -14559.289  2.00%  1210  988s
  8423   481 -14605.615   30  255 -14856.988 -14605.615  1.69%  1209  990s

Cutting planes:
  Gomory: 1
  Implied bound: 5
  Projected implied bound: 7
  MIR: 595
  Flow cover: 972
  Zero half: 5
  RLT: 18
  Relax-and-lift: 96

Explored 8428 nodes (10301032 simplex iterations) in 990.33 seconds (1796.32 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14857 -14857.9 -14858.9 ... -14896.2
No other solutions better than -14857

Optimal solution found (tolerance 1.00e-04)
Best objective -1.485698827558e+04, best bound -1.485698827558e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 990.35s
  Master Objective (UB) = -14856.99, θ = 101612.29
  Upper Bound (UB) = -14856.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 101612.29
  [DEBUG]   ✓ Scenario 0: θ = 101612.29 ≤ Q = 101612.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 101612.29 ≤ Q = 101612.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 101612.29 ≤ Q = 101612.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 101612.29 ≤ Q = 101612.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x196e34ab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe691cb55
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247304e+13
Presolve removed 2566 rows and 1858 columns
Presolve time: 0.01s
Presolved: 527 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 6517345.6069
Variable types: 358 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6517073.0661

Root relaxation: objective -1.386915e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138691.55    0  135 6517073.07 -138691.55   102%     -    0s
H    0     0                    -99468.05834 -138691.55  39.4%     -    0s
H    0     0                    -99740.59915 -138691.55  39.1%     -    0s
H    0     0                    -103519.3151 -116086.21  12.1%     -    0s
H    0     0                    -110953.7290 -116086.21  4.63%     -    0s
     0     0 -116086.21    0   32 -110953.73 -116086.21  4.63%     -    0s
H    0     0                    -115503.7874 -116079.95  0.50%     -    0s
     0     0 -115776.71    0   25 -115503.79 -115776.71  0.24%     -    0s
     0     0 -115725.55    0   17 -115503.79 -115725.55  0.19%     -    0s
     0     0 -115724.40    0   15 -115503.79 -115724.40  0.19%     -    0s
     0     0 -115724.33    0   15 -115503.79 -115724.33  0.19%     -    0s
     0     0 -115706.30    0    5 -115503.79 -115706.30  0.18%     -    0s
     0     0 -115706.30    0   19 -115503.79 -115706.30  0.18%     -    0s
H    0     0                    -115656.2834 -115706.30  0.04%     -    0s
     0     0 -115706.30    0    5 -115656.28 -115706.30  0.04%     -    0s
H    0     0                    -115673.6792 -115706.30  0.03%     -    0s
     0     0 -115698.84    0    4 -115673.68 -115698.84  0.02%     -    0s
     0     0 -115695.45    0    2 -115673.68 -115695.45  0.02%     -    0s
*    0     0               0    -115694.5184 -115694.52  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 14
  Flow cover: 6

Explored 1 nodes (640 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -115695 -115674 -115656 ... -99468.1
No other solutions better than -115695

Optimal solution found (tolerance 1.00e-04)
Best objective -1.156945184003e+05, best bound -1.156945184003e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 89022.31
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115694.52
  [DEBUG]   S×d_nominal = 204716.83
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204716.83 + -115694.52 = 89022.31
  [DEBUG]   Current θ from Master = 101612.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12589.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27446.97
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 3101.4900, Absolute Gap = 3101.4900, Relative Gap = 0.208756
  Not converged yet (gap = 3101.49 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0xc9afcb70
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 1.29s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407604.8704
Found heuristic solution: objective -203853.8717

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27220   -2.8456387e+04   0.000000e+00   1.816876e+08      5s
   37902   -2.4700276e+03   0.000000e+00   3.625645e+06     10s
   45290    4.3705409e+02   0.000000e+00   5.378108e+05     15s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 2.268578e+03, 25158 iterations, 13.89 seconds (18.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2268.57807    0  340 -203853.87 2268.57807   101%     -   15s
H    0     0                    -198847.2136 2268.57807   101%     -   15s
H    0     0                    -166900.6772 2268.57807   101%     -   16s
H    0     0                    -110666.9675 2268.57807   102%     -   16s
H    0     0                    -90281.62304 2268.57807   103%     -   16s
H    0     0                    -89947.77371 2268.57807   103%     -   16s
H    0     0                    -55713.83776 2268.57807   104%     -   16s
H    0     0                    -50762.72840 2268.57807   104%     -   16s
H    0     0                    -40973.10181 2268.57807   106%     -   16s
H    0     0                    -40443.00286 2268.57807   106%     -   16s
H    0     0                    -40426.94639 2268.57807   106%     -   16s
H    0     0                    -39857.54946 2268.57807   106%     -   16s
     0     0 -1615.6690    0  373 -39857.549 -1615.6690  95.9%     -   28s
H    0     0                    -35705.62136 -1615.8840  95.5%     -   28s
H    0     0                    -35681.86303 -1615.8840  95.5%     -   28s
H    0     0                    -33187.72924 -1615.8840  95.1%     -   28s
H    0     0                    -33175.64783 -1615.8840  95.1%     -   28s
H    0     0                    -33171.52249 -1615.8840  95.1%     -   28s
H    0     0                    -33162.33959 -1615.8840  95.1%     -   28s
H    0     0                    -33158.70532 -1615.8840  95.1%     -   28s
H    0     0                    -33157.09637 -1712.2660  94.8%     -   29s
     0     0 -1712.2660    0  285 -33157.096 -1712.2660  94.8%     -   29s
H    0     0                    -29398.51749 -1966.1737  93.3%     -   31s
     0     0 -1966.1737    0  363 -29398.517 -1966.1737  93.3%     -   31s
H    0     0                    -28311.54279 -2017.0931  92.9%     -   33s
H    0     0                    -22650.83781 -2017.0931  91.1%     -   33s
     0     0 -2031.7302    0  368 -22650.838 -2031.7302  91.0%     -   33s
     0     0 -2162.1268    0  355 -22650.838 -2162.1268  90.5%     -   35s
     0     0 -2162.1268    0  363 -22650.838 -2162.1268  90.5%     -   36s
     0     0 -2162.1268    0  365 -22650.838 -2162.1268  90.5%     -   36s
     0     0 -3881.7456    0  404 -22650.838 -3881.7456  82.9%     -   45s
H    0     0                    -20748.17252 -3881.7456  81.3%     -   46s
H    0     0                    -20538.87661 -3881.7456  81.1%     -   46s
     0     0 -4247.6016    0  417 -20538.877 -4247.6016  79.3%     -   51s
     0     0 -4309.0340    0  416 -20538.877 -4309.0340  79.0%     -   53s
     0     0 -4432.1994    0  409 -20538.877 -4432.1994  78.4%     -   56s
H    0     0                    -19980.17201 -4463.7867  77.7%     -   57s
H    0     0                    -19761.47222 -4463.7867  77.4%     -   57s
H    0     0                    -19725.13657 -4463.7867  77.4%     -   57s
H    0     0                    -19723.54550 -4463.7867  77.4%     -   57s
H    0     0                    -19713.30885 -4463.7867  77.4%     -   57s
     0     0 -4463.7867    0  419 -19713.309 -4463.7867  77.4%     -   57s
     0     0 -4466.3806    0  422 -19713.309 -4466.3806  77.3%     -   57s
H    0     0                    -19680.55428 -4467.8016  77.3%     -   57s
     0     0 -4467.8016    0  423 -19680.554 -4467.8016  77.3%     -   58s
     0     0 -4468.4971    0  418 -19680.554 -4468.4971  77.3%     -   58s
     0     0 -4468.5177    0  422 -19680.554 -4468.5177  77.3%     -   58s
H    0     0                    -18615.11448 -5489.0814  70.5%     -   70s
     0     0 -5489.0814    0  465 -18615.114 -5489.0814  70.5%     -   70s
H    0     0                    -18588.82135 -5832.7415  68.6%     -   75s
     0     0 -5832.7415    0  461 -18588.821 -5832.7415  68.6%     -   75s
     0     0 -5953.7438    0  483 -18588.821 -5953.7438  68.0%     -   78s
     0     0 -5994.2026    0  476 -18588.821 -5994.2026  67.8%     -   79s
     0     0 -6046.3493    0  477 -18588.821 -6046.3493  67.5%     -   81s
     0     0 -6256.1216    0  485 -18588.821 -6256.1216  66.3%     -   85s
     0     0 -6280.5815    0  486 -18588.821 -6280.5815  66.2%     -   86s
     0     0 -6319.2140    0  481 -18588.821 -6319.2140  66.0%     -   88s
     0     0 -6325.7200    0  482 -18588.821 -6325.7200  66.0%     -   88s
     0     0 -6327.9337    0  477 -18588.821 -6327.9337  66.0%     -   89s
     0     0 -6330.5271    0  485 -18588.821 -6330.5271  65.9%     -   89s
     0     0 -6330.9425    0  479 -18588.821 -6330.9425  65.9%     -   89s
     0     0 -6708.0939    0  502 -18588.821 -6708.0939  63.9%     -  101s
     0     0 -6860.1638    0  519 -18588.821 -6860.1638  63.1%     -  105s
     0     0 -6935.0143    0  520 -18588.821 -6935.0143  62.7%     -  108s
     0     0 -6976.2637    0  507 -18588.821 -6976.2637  62.5%     -  109s
     0     0 -6992.0053    0  517 -18588.821 -6992.0053  62.4%     -  110s
     0     0 -6997.0907    0  513 -18588.821 -6997.0907  62.4%     -  110s
     0     0 -7005.9880    0  519 -18588.821 -7005.9880  62.3%     -  111s
     0     0 -7009.1468    0  528 -18588.821 -7009.1468  62.3%     -  112s
     0     0 -7012.9087    0  522 -18588.821 -7012.9087  62.3%     -  112s
     0     0 -7013.5741    0  525 -18588.821 -7013.5741  62.3%     -  113s
     0     0 -7150.6271    0  508 -18588.821 -7150.6271  61.5%     -  120s
     0     0 -7183.2927    0  507 -18588.821 -7183.2927  61.4%     -  123s
     0     0 -7193.3384    0  518 -18588.821 -7193.3384  61.3%     -  123s
     0     0 -7194.7797    0  512 -18588.821 -7194.7797  61.3%     -  124s
     0     0 -7196.0816    0  512 -18588.821 -7196.0816  61.3%     -  124s
     0     0 -7196.2221    0  514 -18588.821 -7196.2221  61.3%     -  124s
     0     0 -7342.7229    0  521 -18588.821 -7342.7229  60.5%     -  130s
     0     0 -7382.2339    0  497 -18588.821 -7382.2339  60.3%     -  138s
     0     0 -7394.3158    0  504 -18588.821 -7394.3158  60.2%     -  139s
     0     0 -7404.6497    0  511 -18588.821 -7404.6497  60.2%     -  140s
     0     0 -7405.8048    0  512 -18588.821 -7405.8048  60.2%     -  141s
     0     0 -7436.6559    0  502 -18588.821 -7436.6559  60.0%     -  143s
     0     0 -7447.7882    0  510 -18588.821 -7447.7882  59.9%     -  144s
     0     0 -7450.3296    0  508 -18588.821 -7450.3296  59.9%     -  145s
     0     0 -7452.9183    0  517 -18588.821 -7452.9183  59.9%     -  146s
     0     0 -7454.4990    0  510 -18588.821 -7454.4990  59.9%     -  146s
     0     0 -7455.0277    0  515 -18588.821 -7455.0277  59.9%     -  147s
     0     0 -7494.1865    0  526 -18588.821 -7494.1865  59.7%     -  151s
     0     0 -7502.3537    0  523 -18588.821 -7502.3537  59.6%     -  152s
     0     0 -7504.6369    0  525 -18588.821 -7504.6369  59.6%     -  153s
     0     0 -7505.9015    0  527 -18588.821 -7505.9015  59.6%     -  153s
     0     0 -7523.8051    0  516 -18588.821 -7523.8051  59.5%     -  156s
     0     0 -7527.8077    0  530 -18588.821 -7527.8077  59.5%     -  157s
     0     0 -7529.6889    0  528 -18588.821 -7529.6889  59.5%     -  158s
     0     0 -7530.1657    0  529 -18588.821 -7530.1657  59.5%     -  158s
     0     0 -7531.5607    0  530 -18588.821 -7531.5607  59.5%     -  159s
     0     0 -7532.1131    0  538 -18588.821 -7532.1131  59.5%     -  160s
     0     0 -7543.3816    0  534 -18588.821 -7543.3816  59.4%     -  162s
     0     0 -7548.5943    0  532 -18588.821 -7548.5943  59.4%     -  163s
     0     0 -7551.0648    0  538 -18588.821 -7551.0648  59.4%     -  163s
     0     0 -7551.6461    0  545 -18588.821 -7551.6461  59.4%     -  164s
     0     0 -7560.0583    0  524 -18588.821 -7560.0583  59.3%     -  166s
     0     0 -7561.5252    0  529 -18588.821 -7561.5252  59.3%     -  166s
     0     0 -7562.1558    0  531 -18588.821 -7562.1558  59.3%     -  167s
     0     0 -7573.3233    0  539 -18588.821 -7573.3233  59.3%     -  169s
     0     0 -7575.4531    0  546 -18588.821 -7575.4531  59.2%     -  170s
     0     0 -7576.5255    0  549 -18588.821 -7576.5255  59.2%     -  171s
     0     0 -7578.3968    0  534 -18588.821 -7578.3968  59.2%     -  172s
     0     0 -7578.9012    0  544 -18588.821 -7578.9012  59.2%     -  173s
     0     0 -7582.1819    0  546 -18588.821 -7582.1819  59.2%     -  174s
     0     0 -7582.2116    0  546 -18588.821 -7582.2116  59.2%     -  176s
     0     2 -7582.2405    0  546 -18588.821 -7582.2405  59.2%     -  203s
     1     4 -7660.7654    1  528 -18588.821 -7582.2429  59.2%  1346  208s
     3     8 -7822.0206    2  573 -18588.821 -7661.0302  58.8%  2416  212s
     7    16 -8145.2164    3  586 -18588.821 -7782.9007  58.1%  2927  219s
    15    32 -8284.0319    4  576 -18588.821 -8147.1897  56.2%  3084  228s
    31    64 -8727.8349    5  573 -18588.821 -8288.4066  55.4%  5535  236s
    63    68 -11453.068    6  290 -18588.821 -8617.0503  53.6%  4500  249s
    67    97 -11517.693    7  257 -18588.821 -8617.0503  53.6%  4563  264s
    96   177 -11759.526    8  328 -18588.821 -8676.2991  53.3%  4676  276s
   176   287 -11977.767    9  242 -18588.821 -8676.5534  53.3%  3892  287s
   286   356 -12113.977   10  283 -18588.821 -8676.5534  53.3%  2973  295s
   367   451 -13085.588   10  357 -18588.821 -8676.5534  53.3%  2710  304s
   479   484 -12179.289   11  295 -18588.821 -8676.5534  53.3%  2285  313s
   547   514 -12460.724   11  201 -18588.821 -8676.5534  53.3%  2079  321s
   622   548 -16027.474   12  254 -18588.821 -8676.5534  53.3%  2019  329s
   706   572 -12872.568   12  332 -18588.821 -8719.9039  53.1%  1912  338s
   749   609 -14784.007   12  288 -18588.821 -8802.6874  52.6%  1919  348s
   812   643 -12973.439   13  327 -18588.821 -8802.6874  52.6%  1886  357s
   883   671 -13879.676   14  316 -18588.821 -8849.8171  52.4%  1830  366s
   950   715 -14023.092   15  331 -18588.821 -8849.8171  52.4%  1808  372s
  1014   751 -15164.889   15  243 -18588.821 -8849.8171  52.4%  1788  380s
  1070   794 -14395.193   15  328 -18588.821 -8849.8171  52.4%  1758  388s
H 1095   794                    -18006.20736 -8849.8171  50.9%  1748  388s
  1147   847 -14033.955   16  265 -18006.207 -8849.8171  50.9%  1711  395s
  1255   922 -16044.120   18  299 -18006.207 -8849.8171  50.9%  1660  404s
  1358   988 infeasible   17      -18006.207 -8849.8171  50.9%  1634  412s
  1460  1072 -16612.204   20  305 -18006.207 -8849.8171  50.9%  1612  421s
H 1513  1072                    -17677.02226 -8849.8171  49.9%  1601  421s
  1564  1117 -16713.993   24  282 -17677.022 -8849.8171  49.9%  1588  429s
  1669  1167 -16880.722   24  222 -17677.022 -8849.8171  49.9%  1575  439s
H 1781  1203                    -16845.00852 -8849.8171  47.5%  1567  448s
H 1797  1203                    -16467.13148 -9125.3847  44.6%  1561  448s
H 1799  1203                    -15780.64560 -9125.3847  42.2%  1561  448s
H 1813  1203                    -15328.80157 -9125.3847  40.5%  1558  448s
H 1841  1203                    -15312.38174 -9125.3847  40.4%  1549  448s
  1850  1235     cutoff   32      -15312.382 -9136.2000  40.3%  1550  457s
  1964  1277 -14485.932   10  216 -15312.382 -9136.2000  40.3%  1549  468s
H 2086  1300                    -15284.62360 -9136.2000  40.2%  1537  478s
H 2119  1300                    -15242.26703 -9136.2000  40.1%  1553  478s
H 2156  1300                    -15230.29608 -9136.2000  40.0%  1543  478s
  2169  1316 -10608.730   11  429 -15230.296 -9136.2000  40.0%  1541  494s
  2215  1341 -11043.722   12  411 -15230.296 -9136.2000  40.0%  1544  515s
H 2217  1341                    -15218.45062 -9136.2000  40.0%  1543  515s
H 2224  1341                    -15160.11788 -9136.2000  39.7%  1548  515s
  2264  1444 -11662.338   13  397 -15160.118 -9136.2000  39.7%  1552  526s
  2414  1528 -12066.499   14  365 -15160.118 -9136.2000  39.7%  1526  540s
  2619  1574 -12623.434   16  254 -15160.118 -9136.2000  39.7%  1477  553s
H 2620  1574                    -15131.62228 -9136.2000  39.6%  1477  553s
H 2645  1574                    -15118.39433 -9136.2000  39.6%  1480  553s
H 2669  1574                    -15115.26012 -9136.2000  39.6%  1479  553s
H 2707  1574                    -15098.37065 -9136.2000  39.5%  1472  553s
  2768  1627 -12768.552   17  264 -15098.371 -9290.2451  38.5%  1450  566s
  2919  1707 -14026.040   25  271 -15098.371 -9516.6425  37.0%  1448  581s
  3095  1727 -14968.937   42  129 -15098.371 -9587.9556  36.5%  1432  595s
  3255  1739     cutoff   16      -15098.371 -9925.0562  34.3%  1445  608s
  3326  1767 -11820.025   12  409 -15098.371 -9925.0562  34.3%  1461  623s
  3459  1770 -13878.840   15  300 -15098.371 -9925.0562  34.3%  1467  637s
  3591  1756 -10878.094   13  457 -15098.371 -10257.326  32.1%  1484  653s
  3733  1752 -11795.890   15  382 -15098.371 -10257.326  32.1%  1498  670s
  3900  1787 -12419.423   19  326 -15098.371 -10442.371  30.8%  1505  685s
  4067  1789 -14040.410   29  396 -15098.371 -10451.121  30.8%  1512  702s
  4307  1763 -12763.566   23  346 -15098.371 -10646.755  29.5%  1500  718s
  4484  1780 -13626.542   29  348 -15098.371 -10646.755  29.5%  1510  737s
  4709  1745     cutoff   46      -15098.371 -10818.422  28.3%  1507  754s
  4938  1761 infeasible   18      -15098.371 -10858.421  28.1%  1507  775s
  5181  1818 -13848.711   21  314 -15098.371 -10875.228  28.0%  1507  795s
H 5406  1832                    -15089.62197 -11042.398  26.8%  1513  809s
  5458  1899 -13855.482   16  391 -15089.622 -11042.398  26.8%  1517  830s
  5758  1931 -12847.181   11  431 -15089.622 -11042.398  26.8%  1508  850s
  6036  1975 -13985.679   14  526 -15089.622 -11146.326  26.1%  1506  873s
  6319  2007     cutoff   14      -15089.622 -11211.984  25.7%  1507  898s
  6588  2030     cutoff   19      -15089.622 -11331.741  24.9%  1515  920s
  6835  2071     cutoff    8      -15089.622 -11390.372  24.5%  1518  943s
  7202  2092 -13969.003   17  327 -15089.622 -11395.397  24.5%  1510  967s
  7507  2134 infeasible    8      -15089.622 -11500.874  23.8%  1502  993s
  7827  2164 -14436.240   16  265 -15089.622 -11586.727  23.2%  1508 1017s
  8220  2189 -14785.915   15  399 -15089.622 -11680.117  22.6%  1504 1043s
  8646  2236 -14712.016   14  421 -15089.622 -11802.814  21.8%  1497 1071s
  9045  2291     cutoff   15      -15089.622 -11845.864  21.5%  1485 1097s
  9496  2305 -14930.358   29  263 -15089.622 -11932.942  20.9%  1483 1128s
  9942  2332     cutoff   16      -15089.622 -12054.084  20.1%  1485 1160s
 10490  2324     cutoff   19      -15089.622 -12081.828  19.9%  1474 1192s
 10972  2294 -14359.451   14  375 -15089.622 -12253.823  18.8%  1478 1223s
 11513  2273 -14057.767   17  382 -15089.622 -12330.906  18.3%  1472 1257s
 12018  2218 -13778.564   13  214 -15089.622 -12592.303  16.5%  1475 1291s
 12665  2166     cutoff   11      -15089.622 -12666.159  16.1%  1464 1327s
 13377  2071 -13808.922   10  159 -15089.622 -12810.525  15.1%  1451 1367s
 14123  1999     cutoff   19      -15089.622 -13063.256  13.4%  1436 1406s
 14831  1821 -14162.869   39  372 -15089.622 -13156.732  12.8%  1423 1448s
 15695  1602     cutoff   18      -15089.622 -13275.469  12.0%  1402 1486s
 16708  1441 -14116.300   31  158 -15089.622 -13527.696  10.4%  1373 1521s
 17561  1137 infeasible   28      -15089.622 -13650.832  9.53%  1345 1560s
 18538   453     cutoff   24      -15089.622 -13780.858  8.67%  1312 1600s
 20349   182     cutoff   28      -15089.622 -14191.983  5.95%  1246 1639s
 20812     0 infeasible   45      -15089.622 -14536.689  3.66%  1228 1647s

Cutting planes:
  Gomory: 1
  Implied bound: 23
  MIR: 869
  Flow cover: 1229
  Zero half: 6
  RLT: 38
  Relax-and-lift: 76

Explored 21151 nodes (25777252 simplex iterations) in 1647.96 seconds (3262.49 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15089.6 -15098.4 -15115.3 ... -15284.6
No other solutions better than -15089.6

Optimal solution found (tolerance 1.00e-04)
Best objective -1.508962196993e+04, best bound -1.508962196993e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1648.01s
  Master Objective (UB) = -15089.62, θ = 103002.31
  Upper Bound (UB) = -15089.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 103002.31
  [DEBUG]   ✓ Scenario 0: θ = 103002.31 ≤ Q = 103002.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 103002.31 ≤ Q = 103002.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 103002.31 ≤ Q = 103002.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 103002.31 ≤ Q = 103002.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 103002.31 ≤ Q = 103002.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x46da2c33
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x46da2c33
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.252509e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6432697.1772
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.387949e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138794.93    0  126 6432697.18 -138794.93   102%     -    0s
H    0     0                    -101403.3242 -138794.93  36.9%     -    0s
H    0     0                    -101760.2518 -138794.93  36.4%     -    0s
     0     0 -111789.98    0   91 -101760.25 -111789.98  9.86%     -    0s
H    0     0                    -108455.6137 -111747.15  3.03%     -    0s
H    0     0                    -108716.9853 -111747.15  2.79%     -    0s
H    0     0                    -109203.7526 -111747.15  2.33%     -    0s
H    0     0                    -109465.1242 -111747.15  2.08%     -    0s
     0     0 -111388.37    0   92 -109465.12 -111388.37  1.76%     -    0s
     0     0 -111236.39    0   94 -109465.12 -111236.39  1.62%     -    0s
H    0     0                    -109717.8398 -111236.39  1.38%     -    0s
     0     0 -111224.99    0   94 -109717.84 -111224.99  1.37%     -    0s
     0     2 -111224.99    0   94 -109717.84 -111224.99  1.37%     -    0s
H   40    39                    -110558.9916 -110896.74  0.31%  12.9    0s
H  169    14                    -110584.0813 -110812.86  0.21%   6.8    0s
*  206     2              16    -110590.3067 -110620.57  0.03%   6.6    0s

Cutting planes:
  Gomory: 54
  MIR: 202

Explored 214 nodes (1888 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -110590 -110584 -110559 ... 1.25251e+13
No other solutions better than -110590

Optimal solution found (tolerance 1.00e-04)
Best objective -1.105903066555e+05, best bound -1.105903066555e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 97858.47
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110590.31
  [DEBUG]   S×d_nominal = 208448.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208448.77 + -110590.31 = 97858.47
  [DEBUG]   Current θ from Master = 103002.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5143.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20233.46
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2868.8563, Absolute Gap = 2868.8563, Relative Gap = 0.190121
  Not converged yet (gap = 2868.86 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0x804a9b92
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 1.41s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407604.8704
Found heuristic solution: objective -203853.8717

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25093   -2.9662677e+04   0.000000e+00   1.534028e+07      5s
   34084   -6.1408850e+03   0.000000e+00   4.476683e+06     10s
   39989   -4.0589909e+03   0.000000e+00   7.919367e+05     15s
   45598   -2.5881247e+03   0.000000e+00   6.863901e+06     20s
   51024   -7.2767727e+02   0.000000e+00   2.199789e+06     25s
   58233   -2.9414474e+02   0.000000e+00   1.968298e+06     30s
   63157    4.3124236e+02   0.000000e+00   3.274038e+06     35s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 2.268578e+03, 43907 iterations, 35.84 seconds (48.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2268.57807    0  340 -203853.87 2268.57807   101%     -   38s
H    0     0                    -198847.2136 2268.57807   101%     -   38s
H    0     0                    -132857.9600 2268.57807   102%     -   38s
H    0     0                    -129107.7753 2268.57807   102%     -   38s
H    0     0                    -90198.33649 2268.57807   103%     -   38s
H    0     0                    -70178.93681 2268.57807   103%     -   38s
H    0     0                    -67648.89374 2268.57807   103%     -   38s
H    0     0                    -44978.96950 2268.57807   105%     -   38s
H    0     0                    -42003.11618 2268.57807   105%     -   38s
H    0     0                    -40628.06715 2268.57807   106%     -   38s
H    0     0                    -39857.54946 2268.57807   106%     -   38s
H    0     0                    -33830.83702 -1359.8625  96.0%     -   53s
H    0     0                    -33285.58556 -1359.8625  95.9%     -   53s
H    0     0                    -33267.08338 -1359.8625  95.9%     -   53s
     0     0 -1359.8625    0  365 -33267.083 -1359.8625  95.9%     -   53s
     0     0 -1943.9310    0  366 -33267.083 -1943.9310  94.2%     -   58s
     0     0 -2130.3675    0  364 -33267.083 -2130.3675  93.6%     -   61s
     0     0 -2130.3675    0  364 -33267.083 -2130.3675  93.6%     -   64s
     0     0 -2130.3675    0  372 -33267.083 -2130.3675  93.6%     -   65s
     0     0 -2130.3675    0  354 -33267.083 -2130.3675  93.6%     -   68s
     0     0 -2130.3675    0  354 -33267.083 -2130.3675  93.6%     -   69s
H    0     0                    -33163.28245 -3866.6425  88.3%     -   85s
     0     0 -3979.6048    0  417 -33163.282 -3979.6048  88.0%     -   85s
H    0     0                    -19887.88305 -3979.6048  80.0%     -   85s
H    0     0                    -18796.08586 -3979.6048  78.8%     -   85s
H    0     0                    -18783.92963 -3979.6048  78.8%     -   85s
     0     0 -4328.5447    0  424 -18783.930 -4328.5447  77.0%     -   93s
     0     0 -4439.4920    0  424 -18783.930 -4439.4920  76.4%     -   97s
     0     0 -4459.6404    0  442 -18783.930 -4459.6404  76.3%     -   99s
     0     0 -4466.6410    0  440 -18783.930 -4466.6410  76.2%     -   99s
H    0     0                    -18770.57123 -4547.4679  75.8%     -  101s
H    0     0                    -18713.41016 -4547.4679  75.7%     -  101s
     0     0 -4547.4679    0  443 -18713.410 -4547.4679  75.7%     -  101s
     0     0 -4550.4656    0  446 -18713.410 -4550.4656  75.7%     -  101s
     0     0 -4551.7734    0  448 -18713.410 -4551.7734  75.7%     -  102s
     0     0 -4557.4538    0  443 -18713.410 -4557.4538  75.6%     -  102s
     0     0 -4557.6772    0  450 -18713.410 -4557.6772  75.6%     -  103s
     0     0 -5924.8171    0  447 -18713.410 -5924.8171  68.3%     -  123s
     0     0 -6337.5133    0  461 -18713.410 -6337.5133  66.1%     -  132s
     0     0 -6421.4055    0  482 -18713.410 -6421.4055  65.7%     -  136s
     0     0 -6477.1129    0  484 -18713.410 -6477.1129  65.4%     -  140s
     0     0 -6486.4841    0  489 -18713.410 -6486.4841  65.3%     -  141s
H    0     0                    -18645.52244 -6494.7559  65.2%     -  142s
     0     0 -6494.7559    0  491 -18645.522 -6494.7559  65.2%     -  142s
H    0     0                    -18606.79739 -6516.1074  65.0%     -  143s
     0     0 -6516.1074    0  475 -18606.797 -6516.1074  65.0%     -  143s
     0     0 -6522.0977    0  486 -18606.797 -6522.0977  64.9%     -  144s
     0     0 -6522.2799    0  490 -18606.797 -6522.2799  64.9%     -  144s
H    0     0                    -18604.87782 -7059.3848  62.1%     -  168s
     0     0 -7059.3848    0  506 -18604.878 -7059.3848  62.1%     -  168s
H    0     0                    -18588.82135 -7060.2547  62.0%     -  169s
     0     0 -7163.5663    0  506 -18588.821 -7163.5663  61.5%     -  174s
     0     0 -7196.1574    0  512 -18588.821 -7196.1574  61.3%     -  176s
     0     0 -7224.6086    0  515 -18588.821 -7224.6086  61.1%     -  179s
     0     0 -7234.2820    0  528 -18588.821 -7234.2820  61.1%     -  180s
     0     0 -7258.3924    0  518 -18588.821 -7258.3924  61.0%     -  182s
     0     0 -7263.3128    0  529 -18588.821 -7263.3128  60.9%     -  183s
     0     0 -7265.3072    0  524 -18588.821 -7265.3072  60.9%     -  183s
     0     0 -7268.1776    0  525 -18588.821 -7268.1776  60.9%     -  184s
     0     0 -7268.4778    0  521 -18588.821 -7268.4778  60.9%     -  185s
     0     0 -7314.5677    0  511 -18588.821 -7314.5677  60.7%     -  188s
     0     0 -7325.0330    0  517 -18588.821 -7325.0330  60.6%     -  191s
     0     0 -7331.5425    0  526 -18588.821 -7331.5425  60.6%     -  192s
     0     0 -7332.4251    0  527 -18588.821 -7332.4251  60.6%     -  192s
     0     0 -7365.7289    0  516 -18588.821 -7365.7289  60.4%     -  197s
     0     0 -7379.4022    0  521 -18588.821 -7379.4022  60.3%     -  204s
     0     0 -7381.0672    0  524 -18588.821 -7381.0672  60.3%     -  204s
     0     0 -7382.7515    0  534 -18588.821 -7382.7515  60.3%     -  205s
     0     0 -7383.3150    0  533 -18588.821 -7383.3150  60.3%     -  205s
     0     0 -7418.2900    0  536 -18588.821 -7418.2900  60.1%     -  208s
     0     0 -7427.4284    0  531 -18588.821 -7427.4284  60.0%     -  210s
     0     0 -7429.8572    0  527 -18588.821 -7429.8572  60.0%     -  211s
     0     0 -7431.0318    0  529 -18588.821 -7431.0318  60.0%     -  211s
     0     0 -7446.6599    0  542 -18588.821 -7446.6599  59.9%     -  214s
     0     0 -7450.6257    0  536 -18588.821 -7450.6257  59.9%     -  217s
     0     0 -7451.7197    0  539 -18588.821 -7451.7197  59.9%     -  217s
     0     0 -7466.2270    0  545 -18588.821 -7466.2270  59.8%     -  220s
     0     0 -7469.8844    0  552 -18588.821 -7469.8844  59.8%     -  221s
     0     0 -7470.3760    0  551 -18588.821 -7470.3760  59.8%     -  221s
     0     0 -7478.3299    0  548 -18588.821 -7478.3299  59.8%     -  223s
     0     0 -7485.9815    0  550 -18588.821 -7485.9815  59.7%     -  225s
     0     0 -7486.9070    0  550 -18588.821 -7486.9070  59.7%     -  226s
     0     0 -7491.0861    0  556 -18588.821 -7491.0861  59.7%     -  227s
     0     0 -7495.2597    0  542 -18588.821 -7495.2597  59.7%     -  228s
     0     0 -7496.6512    0  545 -18588.821 -7496.6512  59.7%     -  229s
     0     0 -7496.7805    0  549 -18588.821 -7496.7805  59.7%     -  229s
     0     0 -7500.4942    0  555 -18588.821 -7500.4942  59.7%     -  231s
     0     0 -7500.5080    0  555 -18588.821 -7500.5080  59.7%     -  233s
H    0     0                    -16965.33460 -7500.5206  55.8%     -  265s
H    0     0                    -16602.24233 -7500.5206  54.8%     -  266s
H    0     0                    -15949.95909 -7500.5206  53.0%     -  266s
H    0     0                    -15691.89178 -7500.5206  52.2%     -  266s
H    0     0                    -15678.10357 -7500.5206  52.2%     -  272s
H    0     0                    -15663.77940 -7500.5206  52.1%     -  275s
H    0     0                    -15661.83733 -7500.5206  52.1%     -  275s
H    0     0                    -15661.25113 -7500.5206  52.1%     -  275s
H    0     0                    -15641.51857 -7500.5206  52.0%     -  275s
H    0     0                    -15628.23622 -7500.5206  52.0%     -  275s
H    0     0                    -15585.72244 -7500.5206  51.9%     -  275s
H    0     0                    -15556.04911 -7500.5206  51.8%     -  277s
H    0     0                    -15324.71684 -7500.5206  51.1%     -  277s
H    0     0                    -15315.36226 -7500.5206  51.0%     -  278s
H    0     0                    -15197.44868 -7500.5206  50.6%     -  278s
H    0     0                    -15188.09410 -7500.5206  50.6%     -  280s
     0     2 -7500.5206    0  555 -15188.094 -7500.5206  50.6%     -  281s
     3     8 -7591.5871    2  529 -15188.094 -7528.5938  50.4%  1723  291s
     7    16 -7687.4263    3  540 -15188.094 -7592.5374  50.0%  2652  297s
    15    31 -8577.8722    4  482 -15188.094 -7688.1848  49.4%  3545  312s
    30    60 -9782.0452    5  384 -15188.094 -7688.1848  49.4%  6771  331s
H   41    60                    -15180.24551 -7688.1848  49.4%  6324  331s
    61    68 -10586.103    6  357 -15180.246 -7883.4251  48.1%  6393  348s
H   69    97                    -15173.36964 -7883.4251  48.0%  6235  369s
H   75    97                    -15164.21289 -7883.4251  48.0%  6175  369s
    98   173 -13721.305    8  222 -15164.213 -7883.4251  48.0%  5827  392s
   174   258 -14610.688   13  223 -15164.213 -7883.4251  48.0%  4936  409s
   283   288     cutoff   18      -15164.213 -7883.4251  48.0%  3964  421s
   340   319 -14954.571   18  163 -15164.213 -7883.4251  48.0%  3602  435s
   410   339 -12462.589   10  309 -15164.213 -7883.4251  48.0%  3322  449s
   449   375 -12601.075   11  294 -15164.213 -7883.4251  48.0%  3303  460s
   506   399 -12941.241   12  283 -15164.213 -7883.4251  48.0%  3372  473s
   567   425 -12994.715   13  287 -15164.213 -7883.4251  48.0%  3333  486s
   609   461 -14103.435   14  217 -15164.213 -7883.4251  48.0%  3362  500s
   673   495 -14111.576   15  230 -15164.213 -7883.4251  48.0%  3365  511s
   733   532 -14139.678   14  260 -15164.213 -7883.4251  48.0%  3339  522s
   811   574 -14751.781   15  289 -15164.213 -8249.2061  45.6%  3240  535s
   903   609 -13387.672   14  323 -15164.213 -8249.2061  45.6%  3122  548s
   999   637     cutoff   15      -15164.213 -8249.2061  45.6%  3009  560s
  1097   654 -13765.973   17  274 -15164.213 -8249.2061  45.6%  2917  574s
  1191   668     cutoff   17      -15164.213 -8249.2061  45.6%  2839  587s
  1277   692 -14361.471   18  295 -15164.213 -8249.2061  45.6%  2847  600s
  1357   737 -14518.829   19  276 -15164.213 -8249.2061  45.6%  2902  615s
  1448   777 -14892.289   22  288 -15164.213 -8249.2061  45.6%  2918  628s
  1548   815     cutoff   25      -15164.213 -8249.2061  45.6%  2927  643s
  1652   858 -12139.013    8  245 -15164.213 -8249.2061  45.6%  2952  659s
  1746   908 -13206.670   10  248 -15164.213 -8249.2061  45.6%  2995  674s
  1814   969 -13700.338   11  304 -15164.213 -8249.2061  45.6%  3001  687s
  1917  1007 -14185.415   12  255 -15164.213 -8249.2061  45.6%  2987  703s
  2040  1014     cutoff   13      -15164.213 -9345.7387  38.4%  2946  718s
  2094  1030     cutoff   14      -15164.213 -9345.7387  38.4%  2971  734s
  2164  1051 -11394.894   11  380 -15164.213 -9345.7387  38.4%  2980  750s
  2251  1086 -11942.046   12  269 -15164.213 -9345.7387  38.4%  3002  767s
  2344  1098     cutoff   13      -15164.213 -9345.7387  38.4%  3011  785s
  2422  1120 -13504.909   14  343 -15164.213 -9345.7387  38.4%  3043  804s
  2530  1152 -14160.694   15  363 -15164.213 -9345.7387  38.4%  3046  822s
  2618  1203 -14594.803   16  361 -15164.213 -9507.2652  37.3%  3091  842s
  2735  1270 -14993.540   17  339 -15164.213 -9507.2652  37.3%  3114  863s
  2897  1296     cutoff   21      -15164.213 -9782.1203  35.5%  3082  883s
  3002  1334 -13136.257    9  341 -15164.213 -9869.3455  34.9%  3104  905s
  3142  1416     cutoff   11      -15164.213 -9869.3455  34.9%  3126  923s
  3306  1514     cutoff   11      -15164.213 -10017.822  33.9%  3127  947s
  3566  1554 -13131.737   16  304 -15164.213 -10017.822  33.9%  3071  970s
  3696  1611 -13815.396   19  212 -15164.213 -10064.657  33.6%  3055  992s
  3882  1651 -14474.238   22  334 -15164.213 -10064.657  33.6%  3058 1018s
  4105  1735     cutoff   14      -15164.213 -10130.840  33.2%  3064 1041s
  4319  1769     cutoff   15      -15164.213 -10177.470  32.9%  3087 1068s
  4583  1801 -15102.875   21   15 -15164.213 -10556.838  30.4%  3071 1096s
  4846  1897 -11555.544   18  275 -15164.213 -10740.500  29.2%  3055 1127s
  5139  1962 -13143.302   27  392 -15164.213 -10864.062  28.4%  3040 1157s
  5333  2063 -13506.479   35  255 -15164.213 -11084.265  26.9%  3047 1186s
  5693  2104     cutoff   21      -15164.213 -11242.891  25.9%  3007 1216s
  5990  2171     cutoff   27      -15164.213 -11330.932  25.3%  3013 1249s
  6345  2278 infeasible   30      -15164.213 -11527.956  24.0%  2986 1282s
  6776  2360 -12495.270   10  297 -15164.213 -11688.911  22.9%  2948 1316s
  7180  2456     cutoff   14      -15164.213 -11724.188  22.7%  2899 1351s
  7654  2457 -12640.057   12  555 -15164.213 -11886.484  21.6%  2851 1423s
  7656  2458 -13759.173   41  340 -15164.213 -11886.484  21.6%  2851 1458s
  7657  2459 -13871.021   27  473 -15164.213 -11886.484  21.6%  2850 1492s
  7658  2460 -13792.135   12  542 -15164.213 -11886.484  21.6%  2850 1507s
  7659  2460 -12426.617   18  496 -15164.213 -11886.484  21.6%  2850 1518s
  7660  2461 -12292.773   13  507 -15164.213 -11886.484  21.6%  2849 1524s
  7661  2462 -13006.121   16  527 -15164.213 -11886.484  21.6%  2849 1528s
  7662  2462 -14907.844   25  532 -15164.213 -11886.484  21.6%  2849 1531s
  7664  2464 -14733.868   33  532 -15164.213 -11886.484  21.6%  2848 1537s
  7665  2464 -14874.248   15  538 -15164.213 -11886.484  21.6%  2847 1540s
  7666  2465 -14834.719   33  519 -15164.213 -11886.484  21.6%  2847 1553s
  7667  2466 -12955.735   14  524 -15164.213 -11886.484  21.6%  2847 1557s
  7668  2466 -14985.595   38  524 -15164.213 -11886.484  21.6%  2846 1562s
  7669  2467 -12843.824   20  542 -15164.213 -11886.484  21.6%  2846 1567s
  7670  2468 -14161.960   17  527 -15164.213 -11886.484  21.6%  2846 1579s
  7671  2468 -13358.650   14  537 -15164.213 -11886.484  21.6%  2845 1582s
  7672  2469 -13857.805   21  542 -15164.213 -11886.484  21.6%  2845 1586s
  7673  2470 -14309.539   18  555 -15164.213 -11886.484  21.6%  2844 1595s
  7675  2471 -12483.164   19  667 -15164.213 -11886.484  21.6%  2844 1612s
  7676  2472 -14435.452   21  551 -15164.213 -11886.484  21.6%  2843 1616s
  7677  2472 -14093.349   24  554 -15164.213 -11886.484  21.6%  2843 1625s
  7679  2474 -13137.273   23  547 -15164.213 -11886.484  21.6%  2842 1636s
  7680  2474 -13886.705   29  547 -15164.213 -11886.484  21.6%  2842 1674s
  7681  2475 -13454.512   27  547 -15164.213 -11886.484  21.6%  2841 1701s
  7682  2479 -11886.484   13  504 -15164.213 -11886.484  21.6%  2861 1712s
  7684  2482 -11886.484   14  505 -15164.213 -11886.484  21.6%  2861 1731s
  7688  2489 -11886.484   15  530 -15164.213 -11886.484  21.6%  2860 1752s
  7696  2500 -11886.484   16  537 -15164.213 -11886.484  21.6%  2863 1777s
  7712  2496     cutoff   17      -15164.213 -11886.484  21.6%  2875 1803s
  7728  2502 -14016.128   18  252 -15164.213 -11886.484  21.6%  2889 1841s
  7754  2528     cutoff   19      -15164.213 -11886.484  21.6%  2897 1866s
  7826  2533 -11886.484   18  523 -15164.213 -11886.484  21.6%  2911 1887s
  7895  2542 -11886.484   19  440 -15164.213 -11886.484  21.6%  2925 1901s
  7987  2524 -11886.484   19  409 -15164.213 -11886.484  21.6%  2923 1916s
  8063  2511 -12164.728   20  286 -15164.213 -11886.484  21.6%  2921 1931s
  8137  2480 -11886.484   20  400 -15164.213 -11886.484  21.6%  2929 1947s
  8211  2449 -12812.472   21  248 -15164.213 -11886.484  21.6%  2933 1961s
  8281  2412 -12766.618   20  360 -15164.213 -11886.484  21.6%  2936 1975s
  8347  2395     cutoff   23      -15164.213 -11886.484  21.6%  2934 1997s
  8414  2370 -12111.613   21  275 -15164.213 -11886.484  21.6%  2930 2011s
  8479  2363 -12175.869   22  268 -15164.213 -11886.484  21.6%  2934 2023s
  8550  2353     cutoff   23      -15164.213 -11886.484  21.6%  2931 2037s
  8635  2331 -14217.978   22  323 -15164.213 -11886.484  21.6%  2927 2055s
  8714  2314 -14569.269   24  305 -15164.213 -11886.484  21.6%  2925 2071s
  8766  2305 -14728.841   25  243 -15164.213 -11886.484  21.6%  2932 2088s
  8851  2250 -15012.931   26  245 -15164.213 -11886.484  21.6%  2922 2101s
  8938  2208     cutoff   27      -15164.213 -11886.484  21.6%  2913 2115s
  9030  2164 -14776.168   27  352 -15164.213 -11886.484  21.6%  2908 2129s
  9142  2088 -14798.248   28  347 -15164.213 -11886.484  21.6%  2890 2146s
  9263  2023 -14884.709   28  464 -15164.213 -11886.484  21.6%  2874 2160s
  9371  1974 -14108.464   35  110 -15164.213 -12761.352  15.8%  2862 2172s
  9487  1908 -15010.570   38   30 -15164.213 -13047.141  14.0%  2843 2184s
  9578  1851     cutoff   41      -15164.213 -13271.639  12.5%  2827 2191s
  9618  1835     cutoff   32      -15164.213 -14136.511  6.78%  2821 2199s
  9632  1827     cutoff   30      -15164.213 -14580.630  3.85%  2819 2207s

Cutting planes:
  MIR: 644
  Mixing: 4
  Flow cover: 1223
  GUB cover: 1
  Zero half: 10
  RLT: 15
  Relax-and-lift: 77

Explored 9648 nodes (27335450 simplex iterations) in 2207.84 seconds (4009.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15164.2 -15173.4 -15180.2 ... -15628.2
No other solutions better than -15164.2

Optimal solution found (tolerance 1.00e-04)
Best objective -1.516421289476e+04, best bound -1.516421289476e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2207.85s
  Master Objective (UB) = -15164.21, θ = 102843.40
  Upper Bound (UB) = -15164.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102843.40
  [DEBUG]   ✓ Scenario 0: θ = 102843.40 ≤ Q = 102843.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102843.40 ≤ Q = 102843.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102843.40 ≤ Q = 102843.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102843.40 ≤ Q = 102843.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102843.40 ≤ Q = 102843.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102843.40 ≤ Q = 102843.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x77667740
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x77667740
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.252509e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6408027.0117
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.389964e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138996.39    0  126 6408027.01 -138996.39   102%     -    0s
H    0     0                    -101517.7170 -138996.39  36.9%     -    0s
H    0     0                    -101960.7453 -138996.39  36.3%     -    0s
     0     0 -114135.06    0   92 -101960.75 -114135.06  11.9%     -    0s
H    0     0                    -111210.2631 -114114.40  2.61%     -    0s
H    0     0                    -111998.4604 -114114.40  1.89%     -    0s
     0     0 -113689.59    0   93 -111998.46 -113689.59  1.51%     -    0s
     0     0 -113490.65    0   94 -111998.46 -113490.65  1.33%     -    0s
H    0     0                    -112229.4967 -113441.68  1.08%     -    0s
     0     0 -113441.68    0   94 -112229.50 -113441.68  1.08%     -    0s
     0     0 -113441.68    0   94 -112229.50 -113441.68  1.08%     -    0s
     0     0 -113232.09    0   86 -112229.50 -113232.09  0.89%     -    0s
     0     0 -113214.50    0   82 -112229.50 -113214.50  0.88%     -    0s
     0     0 -112977.57    0   73 -112229.50 -112977.57  0.67%     -    0s
     0     0 -112972.52    0   78 -112229.50 -112972.52  0.66%     -    0s
     0     0 -112927.59    0   70 -112229.50 -112927.59  0.62%     -    0s
     0     0 -112915.41    0   70 -112229.50 -112915.41  0.61%     -    0s
     0     2 -112906.86    0   70 -112229.50 -112906.86  0.60%     -    0s
H   54    44                    -112232.9320 -112536.39  0.27%   7.6    0s
H   61    44                    -112248.7495 -112526.40  0.25%   7.3    0s
H   65    44                    -112261.4236 -112526.40  0.24%   7.2    0s
*  417     7              30    -112268.0731 -112304.24  0.03%   5.4    0s

Cutting planes:
  Gomory: 32
  Implied bound: 1
  MIR: 141
  Flow cover: 5
  RLT: 40
  Relax-and-lift: 3
  BQP: 1

Explored 448 nodes (3002 simplex iterations) in 0.26 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -112268 -112261 -112249 ... 1.25251e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.122680730983e+05, best bound -1.122757491241e+05, gap 0.0068%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 96269.64
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112268.07
  [DEBUG]   S×d_nominal = 208537.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208537.71 + -112268.07 = 96269.64
  [DEBUG]   Current θ from Master = 102843.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6573.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21737.98
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2794.2653, Absolute Gap = 2794.2653, Relative Gap = 0.184267
  Not converged yet (gap = 2794.27 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0x2c317bf7
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 2.69s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407604.8704
Found heuristic solution: objective -203853.8717

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21902   -1.6179284e+05   0.000000e+00   6.294017e+07      5s
   37504   -2.4401967e+04   0.000000e+00   6.509624e+07     10s
   44773   -1.7049296e+04   0.000000e+00   1.195360e+07     15s
   51303   -1.1658415e+04   0.000000e+00   3.277130e+07     20s
   56878   -8.1158341e+03   0.000000e+00   2.984445e+06     25s
   62358   -4.4412882e+03   0.000000e+00   1.383729e+06     30s
   67034   -3.5320535e+03   0.000000e+00   1.202511e+06     35s
   71706   -1.7187990e+03   0.000000e+00   1.980791e+07     40s
   76296   -6.3201440e+02   0.000000e+00   1.608740e+07     45s
   80976    3.7433570e+01   0.000000e+00   9.772162e+05     50s
   85836    6.7844243e+02   0.000000e+00   6.739422e+05     55s
Concurrent spin time: 0.72s

Solved with dual simplex

Root relaxation: objective 2.268578e+03, 66142 iterations, 54.12 seconds (73.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2268.57807    0  340 -203853.87 2268.57807   101%     -   57s
H    0     0                    -190431.6574 2268.57807   101%     -   57s
H    0     0                    -95630.87122 2268.57807   102%     -   58s
H    0     0                    -89581.74353 2268.57807   103%     -   58s
H    0     0                    -89350.21349 2268.57807   103%     -   58s
H    0     0                    -88087.33478 2268.57807   103%     -   58s
H    0     0                    -87860.45563 2268.57807   103%     -   58s
H    0     0                    -86879.41311 2268.57807   103%     -   58s
H    0     0                    -86482.19900 2268.57807   103%     -   58s
H    0     0                    -70868.56562 2268.57807   103%     -   58s
H    0     0                    -30803.47298 2268.57807   107%     -   58s
H    0     0                    -30488.80484 2268.57807   107%     -   58s
H    0     0                    -27181.83974 2268.57807   108%     -   60s
H    0     0                    -26082.09705 2268.57807   109%     -   60s
H    0     0                    -25904.62505 2268.57807   109%     -   60s
     0     0 -1837.5533    0  299 -25904.625 -1837.5533  92.9%     -   80s
H    0     0                    -20071.05311 -1837.5533  90.8%     -   80s
H    0     0                    -19549.01131 -1837.5533  90.6%     -   81s
H    0     0                    -19443.78691 -1837.5533  90.5%     -   81s
     0     0 -1941.0865    0  289 -19443.787 -1941.0865  90.0%     -   86s
     0     0 -2323.8489    0  379 -19443.787 -2323.8489  88.0%     -   90s
     0     0 -2325.8128    0  362 -19443.787 -2325.8128  88.0%     -   97s
     0     0 -2325.8128    0  372 -19443.787 -2325.8128  88.0%     -   99s
     0     0 -2325.8128    0  371 -19443.787 -2325.8128  88.0%     -  100s
     0     0 -2328.5984    0  372 -19443.787 -2328.5984  88.0%     -  100s
     0     0 -2330.0334    0  384 -19443.787 -2330.0334  88.0%     -  101s
     0     0 -2330.0547    0  382 -19443.787 -2330.0547  88.0%     -  101s
     0     0 -4205.2902    0  426 -19443.787 -4205.2902  78.4%     -  119s
H    0     0                    -19350.17159 -4205.2902  78.3%     -  119s
H    0     0                    -19299.21452 -4205.2902  78.2%     -  119s
H    0     0                    -19129.75423 -4205.2902  78.0%     -  119s
     0     0 -4508.7882    0  426 -19129.754 -4508.7882  76.4%     -  127s
     0     0 -4631.0119    0  434 -19129.754 -4631.0119  75.8%     -  133s
H    0     0                    -19065.57900 -4796.1918  74.8%     -  138s
     0     0 -4796.1918    0  440 -19065.579 -4796.1918  74.8%     -  138s
H    0     0                    -19041.32503 -5087.3285  73.3%     -  147s
H    0     0                    -18950.49470 -5087.3285  73.2%     -  147s
     0     0 -5087.3285    0  434 -18950.495 -5087.3285  73.2%     -  147s
     0     0 -5205.0918    0  437 -18950.495 -5205.0918  72.5%     -  152s
     0     0 -5236.1118    0  435 -18950.495 -5236.1118  72.4%     -  154s
     0     0 -5245.4491    0  438 -18950.495 -5245.4491  72.3%     -  155s
     0     0 -5254.6365    0  448 -18950.495 -5254.6365  72.3%     -  157s
     0     0 -5255.7312    0  448 -18950.495 -5255.7312  72.3%     -  157s
     0     0 -5255.8354    0  448 -18950.495 -5255.8354  72.3%     -  158s
     0     0 -6075.7126    0  443 -18950.495 -6075.7126  67.9%     -  185s
H    0     0                    -18907.76555 -6075.9914  67.9%     -  185s
H    0     0                    -17250.70591 -6445.1309  62.6%     -  196s
     0     0 -6445.1309    0  459 -17250.706 -6445.1309  62.6%     -  196s
H    0     0                    -16366.11130 -6622.7410  59.5%     -  204s
H    0     0                    -16363.87153 -6622.7410  59.5%     -  204s
H    0     0                    -16292.47423 -6622.7410  59.4%     -  204s
     0     0 -6622.7410    0  460 -16292.474 -6622.7410  59.4%     -  204s
     0     0 -6727.6031    0  457 -16292.474 -6727.6031  58.7%     -  209s
     0     0 -6764.0035    0  470 -16292.474 -6764.0035  58.5%     -  212s
     0     0 -6766.9572    0  481 -16292.474 -6766.9572  58.5%     -  213s
     0     0 -6776.3552    0  472 -16292.474 -6776.3552  58.4%     -  214s
     0     0 -6778.7658    0  473 -16292.474 -6778.7658  58.4%     -  215s
     0     0 -6791.2899    0  473 -16292.474 -6791.2899  58.3%     -  216s
     0     0 -6798.3027    0  480 -16292.474 -6798.3027  58.3%     -  217s
     0     0 -6819.0697    0  481 -16292.474 -6819.0697  58.1%     -  219s
     0     0 -6822.6356    0  474 -16292.474 -6822.6356  58.1%     -  220s
     0     0 -6825.6536    0  478 -16292.474 -6825.6536  58.1%     -  220s
     0     0 -6826.5616    0  481 -16292.474 -6826.5616  58.1%     -  221s
     0     0 -7198.3271    0  488 -16292.474 -7198.3271  55.8%     -  238s
     0     0 -7359.5495    0  496 -16292.474 -7359.5495  54.8%     -  251s
     0     0 -7400.9947    0  496 -16292.474 -7400.9947  54.6%     -  255s
     0     0 -7452.2616    0  494 -16292.474 -7452.2616  54.3%     -  259s
     0     0 -7461.0847    0  497 -16292.474 -7461.0847  54.2%     -  261s
     0     0 -7462.8803    0  498 -16292.474 -7462.8803  54.2%     -  262s
     0     0 -7469.3299    0  503 -16292.474 -7469.3299  54.2%     -  264s
     0     0 -7471.4641    0  506 -16292.474 -7471.4641  54.1%     -  265s
     0     0 -7471.8425    0  507 -16292.474 -7471.8425  54.1%     -  265s
     0     0 -7517.1202    0  504 -16292.474 -7517.1202  53.9%     -  271s
     0     0 -7539.6556    0  486 -16292.474 -7539.6556  53.7%     -  273s
     0     0 -7546.5342    0  496 -16292.474 -7546.5342  53.7%     -  275s
     0     0 -7548.9345    0  497 -16292.474 -7548.9345  53.7%     -  276s
     0     0 -7549.9149    0  495 -16292.474 -7549.9149  53.7%     -  276s
     0     0 -7574.5482    0  528 -16292.474 -7574.5482  53.5%     -  281s
H    0     0                    -16220.09441 -7574.5532  53.3%     -  283s
H    0     0                    -16195.09299 -7574.5532  53.2%     -  283s
H    0     0                    -16078.56460 -7574.5532  52.9%     -  283s
H    0     0                    -16074.02816 -7574.5532  52.9%     -  283s
H    0     0                    -15957.49977 -7574.5532  52.5%     -  283s
H    0     0                    -15926.47469 -7574.5532  52.4%     -  283s
H    0     0                    -15919.59882 -7574.5532  52.4%     -  284s
     0     0 -7591.5805    0  501 -15919.599 -7591.5805  52.3%     -  286s
     0     0 -7600.1775    0  503 -15919.599 -7600.1775  52.3%     -  289s
     0     0 -7603.6228    0  509 -15919.599 -7603.6228  52.2%     -  290s
     0     0 -7607.4223    0  516 -15919.599 -7607.4223  52.2%     -  291s
     0     0 -7608.2469    0  519 -15919.599 -7608.2469  52.2%     -  292s
     0     0 -7629.7060    0  519 -15919.599 -7629.7060  52.1%     -  296s
     0     0 -7634.8575    0  511 -15919.599 -7634.8575  52.0%     -  298s
     0     0 -7638.9990    0  519 -15919.599 -7638.9990  52.0%     -  299s
     0     0 -7639.8710    0  524 -15919.599 -7639.8710  52.0%     -  300s
     0     0 -7648.8173    0  524 -15919.599 -7648.8173  52.0%     -  303s
H    0     0                    -15796.85919 -7649.0297  51.6%     -  304s
     0     0 -7649.8753    0  522 -15796.859 -7649.8753  51.6%     -  305s
     0     0 -7658.6468    0  514 -15796.859 -7658.6468  51.5%     -  307s
     0     0 -7661.2080    0  521 -15796.859 -7661.2080  51.5%     -  309s
     0     0 -7662.1127    0  524 -15796.859 -7662.1127  51.5%     -  310s
     0     0 -7663.6707    0  510 -15796.859 -7663.6707  51.5%     -  312s
H    0     0                    -15756.07971 -7663.7525  51.4%     -  317s
H    0     0                    -15730.22786 -7663.7525  51.3%     -  317s
H    0     0                    -15723.19806 -7663.7525  51.3%     -  317s
H    0     0                    -15700.23332 -7663.7525  51.2%     -  317s
H    0     0                    -15689.68539 -7663.7525  51.2%     -  318s
H    0     0                    -15680.33080 -7663.7525  51.1%     -  318s
     0     0 -7664.1262    0  514 -15680.331 -7664.1262  51.1%     -  319s
     0     0 -7666.7299    0  522 -15680.331 -7666.7299  51.1%     -  321s
     0     0 -7666.7407    0  522 -15680.331 -7666.7407  51.1%     -  324s
H    0     0                    -15314.43264 -7666.7427  49.9%     -  349s
H    0     0                    -15305.07806 -7666.7427  49.9%     -  350s
H    0     0                    -15300.64443 -7666.7427  49.9%     -  350s
H    0     0                    -15291.28985 -7666.7427  49.9%     -  350s
     0     2 -7666.7427    0  522 -15291.290 -7666.7427  49.9%     -  351s
     1     4 -7694.0780    1  524 -15291.290 -7666.7644  49.9%  1736  362s
     3     8 -7772.7456    2  511 -15291.290 -7694.0886  49.7%  4608  371s
     7    16 -7945.8720    3  506 -15291.290 -7772.8113  49.2%  5645  382s
    15    32 -7969.9999    4  513 -15291.290 -7946.9590  48.0%  5818  399s
    31    49 -12941.954    5  212 -15291.290 -7970.9563  47.9%  7709  447s
    48    81 -14112.887    6  208 -15291.290 -7970.9563  47.9% 10303  466s
H   49    81                    -15258.26980 -7970.9563  47.8% 10093  466s
H   60    81                    -15244.57402 -7970.9563  47.7%  9030  466s
    80   216 -14141.683    7  198 -15244.574 -7970.9563  47.7%  7329  486s
   225   246 -14176.676   10  179 -15244.574 -7970.9563  47.7%  3820  496s
   257   265 -14339.445    8  189 -15244.574 -7970.9563  47.7%  3608  509s
   297   278     cutoff   11      -15244.574 -7970.9563  47.7%  3487  522s
   352   286 -14655.897   10  150 -15244.574 -7970.9563  47.7%  3183  536s
   399   301 -14700.358   10  144 -15244.574 -7970.9563  47.7%  2967  549s
   436   313     cutoff   12      -15244.574 -7970.9563  47.7%  2856  561s
   476   328     cutoff   13      -15244.574 -7970.9563  47.7%  2710  574s
   513   355 -12162.754   12  409 -15244.574 -7970.9563  47.7%  2654  587s
   554   376 -12765.341   13  361 -15244.574 -7970.9563  47.7%  2582  601s
   593   395 -14211.554   13  393 -15244.574 -7970.9563  47.7%  2547  613s
   634   422     cutoff   20      -15244.574 -7970.9563  47.7%  2497  624s
   669   448 -12797.515   15  317 -15244.574 -7970.9563  47.7%  2468  636s
   709   471 -12978.550   16  301 -15244.574 -7970.9563  47.7%  2460  647s
   748   505 -12985.010   17  299 -15244.574 -7970.9563  47.7%  2405  658s
   794   526 -13098.308   18  305 -15244.574 -7970.9563  47.7%  2365  671s
   843   526 -13558.296   19  292 -15244.574 -7970.9563  47.7%  2317  685s
   904   527 -13735.104   20  305 -15244.574 -8022.2398  47.4%  2278  700s
   973   539 -14016.578   21  203 -15244.574 -8429.7469  44.7%  2233  717s
  1027   569 -14081.294   22  208 -15244.574 -8471.5771  44.4%  2256  732s
  1078   598 -14102.718   23  209 -15244.574 -8471.5771  44.4%  2318  746s
  1139   635     cutoff   24      -15244.574 -8471.5771  44.4%  2314  763s
  1236   644     cutoff   27      -15244.574 -8471.5771  44.4%  2261  782s
  1346   659 -9739.5148   10  412 -15244.574 -8992.6636  41.0%  2209  800s
  1433   695 -11053.296    6  171 -15244.574 -8992.6636  41.0%  2207  816s
  1526   732 -12556.091    8  239 -15244.574 -8992.6636  41.0%  2211  835s
  1618   807 -13699.066   10  188 -15244.574 -8992.6636  41.0%  2206  853s
  1765   858 -14673.510   16  216 -15244.574 -9218.9334  39.5%  2152  872s
  1898   911     cutoff    7      -15244.574 -9448.9423  38.0%  2119  892s
  2057   964 -13036.295    9  280 -15244.574 -9448.9423  38.0%  2074  914s
  2216  1019 -12038.844    9  206 -15244.574 -9448.9423  38.0%  2047  934s
  2367  1099 -13513.321   11  206 -15244.574 -9448.9423  38.0%  2043  957s
  2537  1169 -14008.390   13  324 -15244.574 -9448.9423  38.0%  2037  978s
  2716  1229     cutoff   16      -15244.574 -9708.0228  36.3%  2022 1002s
  2900  1233 -14587.999   17  309 -15244.574 -9708.0228  36.3%  2006 1018s
  2960  1240     cutoff   17      -15244.574 -9708.0228  36.3%  2008 1041s
  3017  1250 infeasible   19      -15244.574 -10333.587  32.2%  2021 1057s
  3069  1266 -15088.162   20  154 -15244.574 -10333.587  32.2%  2026 1073s
  3117  1282 infeasible   21      -15244.574 -10333.587  32.2%  2028 1092s
  3202  1314 infeasible   22      -15244.574 -10432.204  31.6%  2020 1109s
  3328  1329 -10835.235   12  421 -15244.574 -10432.204  31.6%  1994 1133s
  3476  1370 -11040.010   13  388 -15244.574 -10459.254  31.4%  1987 1161s
  3637  1416     cutoff   14      -15244.574 -10459.254  31.4%  1994 1189s
  3844  1492 infeasible   18      -15244.574 -10617.413  30.4%  1982 1217s
  4089  1585 infeasible   19      -15244.574 -10704.103  29.8%  1972 1248s
  4376  1714 -13345.253   27  349 -15244.574 -10724.689  29.6%  1954 1285s
  4674  1863 -14715.696   30  105 -15244.574 -10724.689  29.6%  1938 1319s
  5019  1896 -14780.240   13  446 -15244.574 -10724.689  29.6%  1903 1353s
  5358  1962     cutoff   28      -15244.574 -10950.385  28.2%  1889 1389s
  5626  2064 -14642.435   12  317 -15244.574 -11088.332  27.3%  1903 1425s
  5971  2124 -12297.436   13  187 -15244.574 -11149.399  26.9%  1890 1465s
  6323  2221 -14677.015   25  248 -15244.574 -11202.158  26.5%  1875 1505s
  6737  2282 -14895.631   16  387 -15244.574 -11334.782  25.6%  1859 1544s
  7110  2379 -13571.006   10  261 -15244.574 -11462.862  24.8%  1856 1590s
  7499  2380 -14067.171   18  522 -15244.574 -11462.862  24.8%  1849 1772s
  7501  2381 -12739.050   16  340 -15244.574 -11462.862  24.8%  1848 1815s
  7502  2382 -14704.783   22  463 -15244.574 -11462.862  24.8%  1848 1859s
  7503  2383 -11725.488   15  495 -15244.574 -11462.862  24.8%  1848 1883s
  7504  2383 -13156.437   25  534 -15244.574 -11462.862  24.8%  1848 1902s
  7505  2384 -13075.025   27  511 -15244.574 -11462.862  24.8%  1847 1916s
  7506  2385 -14855.875   35  535 -15244.574 -11462.862  24.8%  1847 1925s
  7507  2385 -13648.640   24  490 -15244.574 -11462.862  24.8%  1847 1935s
  7508  2386 -12616.986   19  512 -15244.574 -11462.862  24.8%  1847 1945s
  7509  2387 -12043.023   11  493 -15244.574 -11462.862  24.8%  1846 1954s
  7510  2387 -12450.539   26  491 -15244.574 -11462.862  24.8%  1846 1959s
  7511  2388 -14546.064   25  495 -15244.574 -11462.862  24.8%  1846 1974s
  7512  2389 -12936.973   16  501 -15244.574 -11462.862  24.8%  1846 1979s
  7513  2389 -14703.116   36  523 -15244.574 -11462.862  24.8%  1845 1982s
  7514  2390 -14259.438   19  533 -15244.574 -11462.862  24.8%  1845 1986s
  7515  2391 -14562.689   24  536 -15244.574 -11462.862  24.8%  1845 1991s
  7516  2391 -15058.254   45  541 -15244.574 -11462.862  24.8%  1845 2003s
  7517  2392 -12551.705   20  534 -15244.574 -11462.862  24.8%  1844 2007s
  7518  2393 -13978.451   30  526 -15244.574 -11462.862  24.8%  1844 2014s
  7519  2393 -12118.651   10  651 -15244.574 -11462.862  24.8%  1844 2028s
  7520  2394 -13559.468   13  555 -15244.574 -11462.862  24.8%  1844 2035s
  7521  2395 -13806.136   21  539 -15244.574 -11462.862  24.8%  1843 2045s
  7522  2395 -12484.325   24  618 -15244.574 -11462.862  24.8%  1843 2050s
  7523  2396 -12250.832   19  569 -15244.574 -11462.862  24.8%  1843 2055s
  7524  2397 -13712.649   30  607 -15244.574 -11462.862  24.8%  1843 2065s
  7525  2397 -12776.600   25  607 -15244.574 -11462.862  24.8%  1842 2107s
  7526  2398 -13446.307   23  607 -15244.574 -11462.862  24.8%  1842 2151s
  7527  2401 -11462.862   16  479 -15244.574 -11462.862  24.8%  1871 2169s
  7528  2403 -11462.862   17  411 -15244.574 -11462.862  24.8%  1871 2185s
  7531  2408 -11462.862   18  406 -15244.574 -11462.862  24.8%  1871 2220s
  7537  2416 -11462.862   19  418 -15244.574 -11462.862  24.8%  1876 2248s
  7549  2421 -11462.862   20  404 -15244.574 -11462.862  24.8%  1894 2329s
  7560  2436 -14329.101   20  254 -15244.574 -11462.862  24.8%  1903 2382s
  7590  2435     cutoff   21      -15244.574 -11462.862  24.8%  1934 2405s
  7622  2447 -11462.862   21  510 -15244.574 -11462.862  24.8%  1981 2440s
  7674  2478     cutoff   22      -15244.574 -11462.862  24.8%  1988 2464s
  7748  2497 -12132.483   23  516 -15244.574 -11462.862  24.8%  1999 2485s
  7819  2499 -12158.956   24  522 -15244.574 -11462.862  24.8%  2009 2513s
  7905  2475 -12293.512   25  564 -15244.574 -11462.862  24.8%  2019 2532s
  7993  2459 -11462.862   20  480 -15244.574 -11462.862  24.8%  2022 2551s
  8067  2437 infeasible   25      -15244.574 -11462.862  24.8%  2025 2578s
  8141  2425 infeasible   28      -15244.574 -11462.862  24.8%  2029 2595s
  8206  2415 -12937.615   23  302 -15244.574 -11462.862  24.8%  2034 2609s
  8273  2410 -13188.436   24  162 -15244.574 -11462.862  24.8%  2035 2625s
  8349  2386 -13710.395   27  403 -15244.574 -11462.862  24.8%  2036 2640s
  8429  2355 -14220.751   29  336 -15244.574 -11462.862  24.8%  2035 2658s
  8519  2331 -14400.292   32  332 -15244.574 -11462.862  24.8%  2036 2673s
  8564  2323 -14447.708   33  323 -15244.574 -11642.604  23.6%  2039 2694s
  8638  2285 -14684.887   34  315 -15244.574 -11642.604  23.6%  2036 2723s
  8711  2257 -14806.551   35  268 -15244.574 -11642.604  23.6%  2037 2744s
  8798  2227     cutoff   36      -15244.574 -11645.629  23.6%  2037 2771s
  8905  2172     cutoff   23      -15244.574 -11761.331  22.8%  2036 2796s
  9014  2129 infeasible   25      -15244.574 -11761.331  22.8%  2036 2819s
  9115  2093 -14649.610   28  239 -15244.574 -11761.331  22.8%  2038 2842s
  9226  2048 -13464.827   31  387 -15244.574 -11761.331  22.8%  2038 2862s
  9364  1986 -13734.863   32  386 -15244.574 -11761.331  22.8%  2036 2884s
  9498  1937 -14027.085   35  180 -15244.574 -11761.331  22.8%  2033 2906s
  9613  1875 -14918.512   40  174 -15244.574 -11761.331  22.8%  2036 2928s
  9783  1773     cutoff   37      -15244.574 -12180.959  20.1%  2027 2951s
  9964  1693 -12852.912   26  498 -15244.574 -12180.959  20.1%  2014 2975s
 10076  1632     cutoff   28      -15244.574 -12180.959  20.1%  2015 3003s
 10227  1571 -13601.740   30  477 -15244.574 -12180.959  20.1%  2008 3024s
 10332  1522     cutoff   31      -15244.574 -12180.959  20.1%  2005 3045s
 10455  1459 infeasible   36      -15244.574 -12519.211  17.9%  2001 3074s
 10553  1416 -14949.476   26  378 -15244.574 -13087.448  14.2%  1996 3094s
 10606  1391 -15226.541   27  351 -15244.574 -13087.448  14.2%  1994 3112s
 10653  1363 infeasible   32      -15244.574 -13568.760  11.0%  1992 3127s
 10693  1344 infeasible   32      -15244.574 -14139.175  7.25%  1988 3141s
 10703  1340     cutoff   34      -15244.574 -14768.196  3.12%  1987 3155s
 10705  1339 -14914.452   35  274 -15244.574 -14914.452  2.17%  1987 3170s

Cutting planes:
  MIR: 748
  Flow cover: 1585
  Zero half: 5
  RLT: 25
  Relax-and-lift: 65

Explored 10708 nodes (21514078 simplex iterations) in 3173.77 seconds (5391.88 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15244.6 -15258.3 -15291.3 ... -15723.2
No other solutions better than -15244.6

Optimal solution found (tolerance 1.00e-04)
Best objective -1.524457401550e+04, best bound -1.524457401550e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3173.82s
  Master Objective (UB) = -15244.57, θ = 102896.29
  Upper Bound (UB) = -15244.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102896.29
  [DEBUG]   ✓ Scenario 0: θ = 102896.29 ≤ Q = 102896.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102896.29 ≤ Q = 102896.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102896.29 ≤ Q = 102896.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102896.29 ≤ Q = 102896.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102896.29 ≤ Q = 102896.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102896.29 ≤ Q = 102896.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102896.29 ≤ Q = 102896.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1e27dc3a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe1d823c6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.252509e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6385733.5922
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.395799e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139579.87    0  126 6385733.59 -139579.87   102%     -    0s
H    0     0                    -102045.2405 -139579.87  36.8%     -    0s
H    0     0                    -102503.4864 -139579.87  36.2%     -    0s
H    0     0                    -102571.8099 -139579.87  36.1%     -    0s
     0     0 -112449.58    0  133 -102571.81 -112449.58  9.63%     -    0s
H    0     0                    -108159.2501 -112422.50  3.94%     -    0s
     0     0 -111887.14    0  136 -108159.25 -111887.14  3.45%     -    0s
H    0     0                    -109285.7834 -111853.83  2.35%     -    0s
     0     0 -111840.15    0  136 -109285.78 -111840.15  2.34%     -    0s
H    0     0                    -109537.0849 -111840.15  2.10%     -    0s
     0     0 -111482.89    0  139 -109537.08 -111482.89  1.78%     -    0s
     0     0 -111424.15    0  139 -109537.08 -111424.15  1.72%     -    0s
     0     0 -111414.86    0  139 -109537.08 -111414.86  1.71%     -    0s
     0     0 -111088.90    0  139 -109537.08 -111088.90  1.42%     -    0s
     0     0 -111058.75    0  139 -109537.08 -111058.75  1.39%     -    0s
     0     0 -110730.06    0  136 -109537.08 -110730.06  1.09%     -    0s
     0     0 -110695.15    0  138 -109537.08 -110695.15  1.06%     -    0s
     0     0 -110677.82    0  138 -109537.08 -110677.82  1.04%     -    0s
     0     0 -110575.12    0  138 -109537.08 -110575.12  0.95%     -    0s
     0     0 -110565.81    0  138 -109537.08 -110565.81  0.94%     -    0s
     0     2 -110565.81    0  138 -109537.08 -110565.81  0.94%     -    0s

Cutting planes:
  Gomory: 48
  Implied bound: 4
  MIR: 274
  Flow cover: 2
  RLT: 3
  BQP: 2

Explored 4173 nodes (26607 simplex iterations) in 0.70 seconds (0.25 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -109537 -109286 -108159 ... 1.25251e+13
No other solutions better than -109537

Optimal solution found (tolerance 1.00e-04)
Best objective -1.095370849211e+05, best bound -1.095370849211e+05, gap 0.0000%
  Subproblem solved in 0.73s
  Worst-case operational profit (Z_SP) = 99641.56
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109537.08
  [DEBUG]   S×d_nominal = 209178.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209178.65 + -109537.08 = 99641.56
  [DEBUG]   Current θ from Master = 102896.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3254.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18499.31
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2713.9042, Absolute Gap = 2713.9042, Relative Gap = 0.178024
  Not converged yet (gap = 2713.90 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0xc26021c2
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 2.33s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407604.8704
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21551   -1.6498410e+05   0.000000e+00   1.721521e+06      5s
   38738   -1.8834947e+04   0.000000e+00   5.927407e+08     10s
   46358   -5.1659483e+03   0.000000e+00   2.849893e+06     15s
   51805   -4.1361612e+03   0.000000e+00   2.415282e+06     20s
   55994   -3.9438195e+03   0.000000e+00   9.762608e+06     25s
   61878   -1.2386935e+03   0.000000e+00   3.309235e+06     30s
   66231   -9.8979640e+02   0.000000e+00   1.711977e+07     35s
   70588   -5.4307194e+02   0.000000e+00   1.851997e+06     40s
   75232   -9.5877147e+01   0.000000e+00   3.792238e+05     45s
   79513   -6.5751054e+01   0.000000e+00   1.701653e+07     50s
   83698    2.3423471e+02   0.000000e+00   3.748359e+05     55s
   87728    8.1584765e+02   0.000000e+00   4.891961e+08     60s
   92378    1.2256695e+03   0.000000e+00   1.926936e+06     65s
   96873    1.4319501e+03   0.000000e+00   4.224872e+06     70s
Concurrent spin time: 2.66s

Solved with dual simplex

Root relaxation: objective 1.615955e+03, 76017 iterations, 71.96 seconds (97.88 work units)
Total elapsed time = 75.32s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1615.95450    0  340 -211403.45 1615.95450   101%     -   75s
H    0     0                    -203993.6056 1615.95450   101%     -   75s
H    0     0                    -91348.89797 1615.95450   102%     -   76s
H    0     0                    -86500.06326 1615.95450   102%     -   76s
H    0     0                    -85977.34665 1615.95450   102%     -   76s
H    0     0                    -85505.22628 1615.95450   102%     -   76s
H    0     0                    -84343.33662 1615.95450   102%     -   76s
H    0     0                    -84282.49681 1615.95450   102%     -   76s
H    0     0                    -75286.09086 1615.95450   102%     -   76s
H    0     0                    -74643.78291 1615.95450   102%     -   76s
H    0     0                    -73607.88955 1615.95450   102%     -   76s
H    0     0                    -73274.06528 1615.95450   102%     -   77s
H    0     0                    -73234.96764 1615.95450   102%     -   77s
H    0     0                    -72821.15511 1615.95450   102%     -   77s
H    0     0                    -71908.47144 1615.95450   102%     -   77s
H    0     0                    -71869.37381 1615.95450   102%     -   77s
H    0     0                    -71799.99529 1615.95450   102%     -   77s
H    0     0                    -27629.68018 1615.95450   106%     -   78s
H    0     0                    -27388.02102 1615.95450   106%     -   78s
H    0     0                    -25262.51146 1615.95450   106%     -   78s
H    0     0                    -25023.51600 1615.95450   106%     -   78s
H    0     0                    -24918.73177 1615.95450   106%     -   78s
H    0     0                    -24785.50809 1615.95450   107%     -   78s
H    0     0                    -20412.25695 -1908.1613  90.7%     -   96s
H    0     0                    -19763.75013 -1908.1613  90.3%     -   96s
     0     0 -1908.1613    0  289 -19763.750 -1908.1613  90.3%     -   96s
H    0     0                    -19682.62724 -1910.1741  90.3%     -   97s
     0     0 -2194.8249    0  377 -19682.627 -2194.8249  88.8%     -  102s
     0     0 -2347.3349    0  377 -19682.627 -2347.3349  88.1%     -  106s
     0     0 -2527.4001    0  382 -19682.627 -2527.4001  87.2%     -  111s
H    0     0                    -19565.46319 -2535.0514  87.0%     -  114s
H    0     0                    -19523.45925 -2535.0514  87.0%     -  114s
H    0     0                    -19516.83935 -2535.0514  87.0%     -  114s
H    0     0                    -19488.39312 -2535.0514  87.0%     -  114s
     0     0 -2688.2259    0  377 -19488.393 -2688.2259  86.2%     -  114s
     0     0 -2772.0655    0  335 -19488.393 -2772.0655  85.8%     -  122s
     0     0 -2772.0655    0  388 -19488.393 -2772.0655  85.8%     -  127s
     0     0 -2781.9493    0  395 -19488.393 -2781.9493  85.7%     -  128s
     0     0 -2781.9997    0  394 -19488.393 -2781.9997  85.7%     -  128s
H    0     0                    -19343.25213 -4268.2361  77.9%     -  146s
     0     0 -4341.7631    0  423 -19343.252 -4341.7631  77.6%     -  146s
H    0     0                    -19232.67365 -4341.7631  77.4%     -  146s
     0     0 -4496.7000    0  417 -19232.674 -4496.7000  76.6%     -  155s
     0     0 -4719.0531    0  408 -19232.674 -4719.0531  75.5%     -  165s
H    0     0                    -18968.43582 -4822.1351  74.6%     -  171s
     0     0 -4822.1351    0  420 -18968.436 -4822.1351  74.6%     -  171s
     0     0 -5098.9950    0  430 -18968.436 -5098.9950  73.1%     -  180s
     0     0 -5107.0509    0  432 -18968.436 -5107.0509  73.1%     -  182s
     0     0 -5110.9515    0  441 -18968.436 -5110.9515  73.1%     -  183s
H    0     0                    -18965.00688 -5111.3805  73.0%     -  183s
     0     0 -5111.3805    0  436 -18965.007 -5111.3805  73.0%     -  183s
     0     0 -6586.3290    0  459 -18965.007 -6586.3290  65.3%     -  211s
H    0     0                    -18773.37427 -6586.7016  64.9%     -  211s
     0     0 -6977.1776    0  467 -18773.374 -6977.1776  62.8%     -  224s
     0     0 -7287.9115    0  464 -18773.374 -7287.9115  61.2%     -  234s
     0     0 -7365.5265    0  462 -18773.374 -7365.5265  60.8%     -  238s
     0     0 -7465.7175    0  467 -18773.374 -7465.7175  60.2%     -  245s
     0     0 -7488.6468    0  467 -18773.374 -7488.6468  60.1%     -  248s
     0     0 -7526.9422    0  466 -18773.374 -7526.9422  59.9%     -  251s
     0     0 -7535.7443    0  462 -18773.374 -7535.7443  59.9%     -  252s
     0     0 -7586.8365    0  469 -18773.374 -7586.8365  59.6%     -  255s
     0     0 -7600.8787    0  473 -18773.374 -7600.8787  59.5%     -  256s
     0     0 -7602.4810    0  476 -18773.374 -7602.4810  59.5%     -  257s
     0     0 -7602.6390    0  478 -18773.374 -7602.6390  59.5%     -  257s
     0     0 -7956.8904    0  492 -18773.374 -7956.8904  57.6%     -  278s
H    0     0                    -18719.39108 -7956.9781  57.5%     -  279s
     0     0 -8030.8801    0  484 -18719.391 -8030.8801  57.1%     -  284s
     0     0 -8062.3215    0  498 -18719.391 -8062.3215  56.9%     -  289s
     0     0 -8084.7886    0  500 -18719.391 -8084.7886  56.8%     -  293s
     0     0 -8093.4385    0  503 -18719.391 -8093.4385  56.8%     -  295s
     0     0 -8104.5002    0  496 -18719.391 -8104.5002  56.7%     -  297s
     0     0 -8112.6684    0  495 -18719.391 -8112.6684  56.7%     -  299s
     0     0 -8120.8002    0  489 -18719.391 -8120.8002  56.6%     -  301s
     0     0 -8133.3859    0  494 -18719.391 -8133.3859  56.6%     -  303s
H    0     0                    -18636.41527 -8142.5756  56.3%     -  305s
     0     0 -8142.5756    0  509 -18636.415 -8142.5756  56.3%     -  305s
     0     0 -8145.9903    0  501 -18636.415 -8145.9903  56.3%     -  306s
     0     0 -8146.6446    0  499 -18636.415 -8146.6446  56.3%     -  306s
     0     0 -8227.6965    0  490 -18636.415 -8227.6965  55.9%     -  317s
     0     0 -8269.5251    0  504 -18636.415 -8269.5251  55.6%     -  322s
     0     0 -8284.2542    0  512 -18636.415 -8284.2542  55.5%     -  326s
     0     0 -8292.3399    0  519 -18636.415 -8292.3399  55.5%     -  328s
     0     0 -8295.0864    0  521 -18636.415 -8295.0864  55.5%     -  329s
     0     0 -8295.4887    0  519 -18636.415 -8295.4887  55.5%     -  329s
     0     0 -8345.5341    0  501 -18636.415 -8345.5341  55.2%     -  336s
H    0     0                    -18619.42817 -8362.8439  55.1%     -  346s
H    0     0                    -18603.37170 -8362.8439  55.0%     -  346s
H    0     0                    -18588.82135 -8362.8439  55.0%     -  346s
     0     0 -8362.8439    0  519 -18588.821 -8362.8439  55.0%     -  346s
     0     0 -8365.9338    0  524 -18588.821 -8365.9338  55.0%     -  347s
     0     0 -8369.3621    0  521 -18588.821 -8369.3621  55.0%     -  348s
     0     0 -8371.5007    0  531 -18588.821 -8371.5007  55.0%     -  349s
     0     0 -8372.0094    0  539 -18588.821 -8372.0094  55.0%     -  350s
     0     0 -8393.4584    0  525 -18588.821 -8393.4584  54.8%     -  355s
     0     0 -8400.1330    0  521 -18588.821 -8400.1330  54.8%     -  359s
     0     0 -8403.0468    0  527 -18588.821 -8403.0468  54.8%     -  361s
     0     0 -8406.1164    0  542 -18588.821 -8406.1164  54.8%     -  362s
     0     0 -8406.6562    0  541 -18588.821 -8406.6562  54.8%     -  363s
     0     0 -8429.9549    0  520 -18588.821 -8429.9549  54.7%     -  369s
     0     0 -8438.4821    0  533 -18588.821 -8438.4821  54.6%     -  373s
     0     0 -8443.0903    0  535 -18588.821 -8443.0903  54.6%     -  374s
     0     0 -8447.1327    0  533 -18588.821 -8447.1327  54.6%     -  376s
     0     0 -8447.8916    0  530 -18588.821 -8447.8916  54.6%     -  377s
     0     0 -8454.6927    0  531 -18588.821 -8454.6927  54.5%     -  381s
     0     0 -8455.9852    0  539 -18588.821 -8455.9852  54.5%     -  383s
     0     0 -8456.4364    0  536 -18588.821 -8456.4364  54.5%     -  383s
     0     0 -8459.9171    0  535 -18588.821 -8459.9171  54.5%     -  386s
     0     0 -8462.5334    0  544 -18588.821 -8462.5334  54.5%     -  390s
     0     0 -8462.8159    0  550 -18588.821 -8462.8159  54.5%     -  391s
     0     0 -8464.6825    0  537 -18588.821 -8464.6825  54.5%     -  393s
     0     0 -8464.9171    0  541 -18588.821 -8464.9171  54.5%     -  394s
     0     0 -8466.7044    0  545 -18588.821 -8466.7044  54.5%     -  396s
     0     0 -8466.8399    0  545 -18588.821 -8466.8399  54.5%     -  400s
H    0     0                    -16482.32776 -8467.0352  48.6%     -  462s
H    0     0                    -16298.67937 -8467.0352  48.1%     -  464s
H    0     0                    -16198.93287 -8467.0352  47.7%     -  464s
H    0     0                    -16091.51005 -8467.0352  47.4%     -  464s
H    0     0                    -15948.35766 -8467.0352  46.9%     -  464s
     0     2 -8467.0352    0  545 -15948.358 -8467.0352  46.9%     -  467s
     1     4 -8476.2294    1  541 -15948.358 -8467.9218  46.9%   816  480s
     3     8 -8584.4903    2  516 -15948.358 -8476.4071  46.9%  4877  489s
     7    16 -8656.5561    3  507 -15948.358 -8584.8562  46.2%  4835  501s
    15    32 -8740.1520    4  511 -15948.358 -8657.4706  45.7%  5447  517s
    31    50 -13719.674    5  212 -15948.358 -8740.8600  45.2%  8900  559s
H   49    82                    -15939.00308 -8740.8600  45.2%  8894  577s
H   51    82                    -15929.82820 -8740.8600  45.1%  8925  577s
H   52    82                    -15850.54676 -8740.8600  44.9%  8821  577s
H   58    82                    -15733.87295 -8740.8600  44.4%  8617  577s
H   62    81                    -15673.08834 -8740.8600  44.2%  8597  577s
    81   186 -9631.7986    7  480 -15673.088 -8740.8600  44.2%  7410  603s
   192   224 -9648.9740    8  470 -15673.088 -8740.8600  44.2%  3752  617s
H  195   224                    -15596.32934 -8740.8600  44.0%  3713  617s
H  235   224                    -15562.31921 -8740.8600  43.8%  3348  617s
   254   245 -9727.7273    9  471 -15562.319 -8740.8600  43.8%  3205  634s
   352   253 -9916.5185    8  464 -15562.319 -8740.8600  43.8%  2820  650s
   395   265 -10856.756   10  413 -15562.319 -8740.8600  43.8%  2797  667s
H  415   265                    -15550.50648 -8740.8600  43.8%  2733  667s
H  438   265                    -15469.78678 -8740.8600  43.5%  2687  667s
   454   279     cutoff   16      -15469.787 -8740.8600  43.5%  2732  682s
   516   296 -12716.323   10  404 -15469.787 -8740.8600  43.5%  2689  698s
H  521   296                    -15434.22915 -8740.8600  43.4%  2686  698s
   549   313 -11727.652   11  417 -15434.229 -8740.8600  43.4%  2712  721s
   622   342 -11826.493   12  425 -15434.229 -8740.8600  43.4%  2636  737s
   681   354 -12252.565   13  415 -15434.229 -8740.8600  43.4%  2606  754s
   721   386 -12668.430   14  405 -15434.229 -8740.8600  43.4%  2629  770s
   765   415 -13923.584   13  223 -15434.229 -8740.8600  43.4%  2628  785s
H  794   415                    -15432.25565 -8740.8600  43.4%  2595  785s
   826   482 -12800.365   15  455 -15432.256 -8740.8600  43.4%  2578  798s
   933   510 -14727.736   15  322 -15432.256 -8740.8600  43.4%  2437  813s
  1035   532 -12940.588   16  403 -15432.256 -8740.8600  43.4%  2325  827s
  1077   554 -13318.454   17  391 -15432.256 -8740.8600  43.4%  2339  842s
H 1115   554                    -15411.28259 -8740.8600  43.3%  2323  842s
  1133   575 -13522.777   17  399 -15411.283 -8740.8600  43.3%  2328  859s
  1218   606 -13642.536   18  414 -15411.283 -9068.7950  41.2%  2320  878s
  1325   635     cutoff   18      -15411.283 -9068.7950  41.2%  2277  898s
  1414   652 -13989.128   20  443 -15411.283 -9068.7950  41.2%  2273  918s
  1503   688     cutoff   22      -15411.283 -9399.5867  39.0%  2301  938s
  1575   726     cutoff   21      -15411.283 -9399.5867  39.0%  2325  959s
  1691   759 -15346.828   23  327 -15411.283 -9399.5867  39.0%  2321  979s
  1818   797     cutoff   11      -15411.283 -9533.2921  38.1%  2284 1002s
  1922   833 -13130.786    9  357 -15411.283 -9852.0839  36.1%  2307 1025s
  2052   859 -12929.869    9  418 -15411.283 -9852.0839  36.1%  2292 1047s
H 2171   886                    -15411.25293 -10312.113  33.1%  2294 1070s
H 2189   886                    -15408.87210 -10312.113  33.1%  2281 1070s
H 2201   886                    -15408.11475 -10312.113  33.1%  2285 1070s
H 2208   886                    -15403.31631 -10312.113  33.1%  2286 1070s
  2244   948 -13329.655   13  401 -15403.316 -10312.113  33.1%  2283 1093s
  2407   975 -14965.877   18  384 -15403.316 -10312.113  33.1%  2266 1120s
  2558  1006 -14808.865   17  427 -15403.316 -10351.074  32.8%  2260 1147s
  2717  1028     cutoff   20      -15403.316 -10351.074  32.8%  2263 1173s
H 2721  1028                    -15399.02226 -10351.074  32.8%  2262 1173s
  2857  1027 -15383.831   10  155 -15399.022 -10351.074  32.8%  2258 1200s
  3006  1029 -14024.228   11  383 -15399.022 -10869.244  29.4%  2294 1227s
  3136  1039 -12398.164    8  408 -15399.022 -11584.656  24.8%  2301 1247s
  3200  1068 -12878.003    9  398 -15399.022 -11584.656  24.8%  2314 1273s
  3323  1109 -13148.893   10  388 -15399.022 -11779.572  23.5%  2314 1304s
  3479  1123 -13195.423   11  438 -15399.022 -11882.968  22.8%  2321 1328s
  3535  1131 -13781.249   12  418 -15399.022 -11882.968  22.8%  2326 1353s
  3599  1149 -15244.492   14  134 -15399.022 -11882.968  22.8%  2334 1381s
  3735  1185     cutoff   11      -15399.022 -12038.377  21.8%  2309 1413s
  3917  1224 -14378.242   13  381 -15399.022 -12076.312  21.6%  2297 1451s
  4134  1324 infeasible   12      -15399.022 -12148.122  21.1%  2284 1488s
  4441  1380 -14651.774   14  213 -15399.022 -12148.122  21.1%  2242 1529s
  4758  1437 -14003.367   14  282 -15399.022 -12396.721  19.5%  2220 1568s
  5033  1439     cutoff   15      -15399.022 -12524.269  18.7%  2215 1609s
  5373  1460     cutoff   11      -15399.022 -12677.838  17.7%  2189 1644s
  5580  1474 -14382.536   14  255 -15399.022 -12677.838  17.7%  2180 1686s
  5922  1500     cutoff   16      -15399.022 -12855.816  16.5%  2165 1734s
  6276  1513 -15319.436   15  224 -15399.022 -12855.816  16.5%  2154 1781s
  6596  1496     cutoff   15      -15399.022 -13154.031  14.6%  2152 1832s
  7011  1493     cutoff   18      -15399.022 -13344.357  13.3%  2132 1878s
  7436  1447 -15106.947   19  384 -15399.022 -13427.844  12.8%  2115 1931s
  7923  1427 -14797.877   19  347 -15399.022 -13666.728  11.2%  2095 1972s
  8273  1401     cutoff   14      -15399.022 -13717.684  10.9%  2075 2024s
  8751  1309     cutoff    7      -15399.022 -13810.283  10.3%  2062 2076s
  9339  1170     cutoff   19      -15399.022 -14013.763  9.00%  2034 2129s
  9932  1060 -14791.521   26  466 -15399.022 -14135.805  8.20%  2010 2184s
 10599   780 -15100.841   22  411 -15399.022 -14345.211  6.84%  1974 2240s
 11397   305 -15039.737   14   84 -15399.022 -14466.529  6.06%  1925 2295s
H11824   305                    -15373.01688 -14559.948  5.29%  1885 2295s
 12854   266 infeasible   21      -15373.017 -14744.206  4.09%  1781 2305s
*12868   266              43    -15372.58261 -14744.206  4.09%  1779 2305s
*12921   266              44    -15364.29601 -14744.206  4.04%  1773 2305s
*12923   266              42    -15362.98046 -14744.206  4.03%  1773 2305s
*12927   266              36    -15350.17215 -14744.206  3.95%  1772 2305s
*13215   266              45    -15324.19511 -14744.206  3.78%  1737 2305s
 14439    84 infeasible   30      -15324.195 -15261.913  0.41%  1599 2310s
*14527    84              42    -15321.25518 -15266.114  0.36%  1590 2310s
*14547    84              43    -15308.74400 -15268.768  0.26%  1588 2310s
*14577    84              38    -15296.74462 -15268.768  0.18%  1584 2310s

Cutting planes:
  Learned: 1
  Implied bound: 44
  MIR: 1077
  Flow cover: 1550
  RLT: 49
  Relax-and-lift: 86

Explored 15227 nodes (23407537 simplex iterations) in 2310.64 seconds (4144.96 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15296.7 -15308.7 -15321.3 ... -15399
No other solutions better than -15296.7

Optimal solution found (tolerance 1.00e-04)
Best objective -1.529674461634e+04, best bound -1.529674461634e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2310.67s
  Master Objective (UB) = -15296.74, θ = 101206.31
  Upper Bound (UB) = -15296.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 101206.31
  [DEBUG]   ✓ Scenario 0: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 101206.31 ≤ Q = 101206.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x720caa79
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x720caa79
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.247304e+13
Presolve removed 2566 rows and 1858 columns
Presolve time: 0.01s
Presolved: 527 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 6547896.0057
Variable types: 358 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6547623.4649

Root relaxation: objective -1.378994e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137899.39    0  126 6547623.46 -137899.39   102%     -    0s
H    0     0                    -97131.81362 -137899.39  42.0%     -    0s
H    0     0                    -97404.35443 -137899.39  41.6%     -    0s
H    0     0                    -97525.91537 -137899.39  41.4%     -    0s
H    0     0                    -97837.99686 -137678.48  40.7%     -    0s
H    0     0                    -98110.53767 -137678.48  40.3%     -    0s
     0     0 -109556.16    0  102 -98110.538 -109556.16  11.7%     -    0s
H    0     0                    -106056.5210 -109555.78  3.30%     -    0s
H    0     0                    -106332.7815 -109555.78  3.03%     -    0s
H    0     0                    -106798.0630 -109555.78  2.58%     -    0s
H    0     0                    -107074.3235 -109555.78  2.32%     -    0s
     0     0 -109265.66    0  103 -107074.32 -109265.66  2.05%     -    0s
     0     0 -109008.51    0   97 -107074.32 -109008.51  1.81%     -    0s
H    0     0                    -107669.8383 -109007.55  1.24%     -    0s
     0     0 -108962.01    0  104 -107669.84 -108962.01  1.20%     -    0s
     0     0 -108961.98    0  104 -107669.84 -108961.98  1.20%     -    0s
     0     0 -108851.85    0  106 -107669.84 -108851.85  1.10%     -    0s
     0     0 -108818.01    0  106 -107669.84 -108818.01  1.07%     -    0s
     0     2 -108812.21    0  106 -107669.84 -108812.21  1.06%     -    0s
H   43    21                    -107683.7253 -108592.74  0.84%  10.8    0s
H   44    19                    -108123.3166 -108592.74  0.43%  10.6    0s
H  125     2                    -108130.8692 -108181.14  0.05%   6.7    0s

Cutting planes:
  Gomory: 25
  Implied bound: 3
  MIR: 188
  RLT: 2
  BQP: 1

Explored 135 nodes (1416 simplex iterations) in 0.20 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -108131 -108123 -107684 ... -97404.4
No other solutions better than -108131

Optimal solution found (tolerance 1.00e-04)
Best objective -1.081308692404e+05, best bound -1.081308692404e+05, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 97365.59
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108130.87
  [DEBUG]   S×d_nominal = 205496.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205496.46 + -108130.87 = 97365.59
  [DEBUG]   Current θ from Master = 101206.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3840.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19137.46
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2661.7336, Absolute Gap = 2661.7336, Relative Gap = 0.174007
  Not converged yet (gap = 2661.73 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0x241b91c5
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 2.42s
Presolved: 81726 rows, 35173 columns, 499754 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407599.3033
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 81726 rows, 35173 columns, 499754 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   17435   -2.0059992e+05   0.000000e+00   2.751880e+06      5s
   34748   -8.0734732e+04   0.000000e+00   1.715174e+07     10s
   44105   -1.9711361e+04   0.000000e+00   2.877149e+07     15s
   50980   -1.1622169e+04   0.000000e+00   4.065388e+06     20s
   56498   -2.5520423e+02   0.000000e+00   1.260071e+09     25s
Concurrent spin time: 3.84s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 7.632208e+03, 42844 iterations, 29.90 seconds (39.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7632.20831    0  234 -211403.45 7632.20831   104%     -   33s
H    0     0                    -207653.2638 7632.20831   104%     -   33s
H    0     0                    -181970.8656 7632.20831   104%     -   33s
H    0     0                    -84906.08705 7632.20831   109%     -   33s
H    0     0                    -56636.86635 7632.20831   113%     -   33s
H    0     0                    -55881.39267 7632.20831   114%     -   34s
H    0     0                    -44849.70694 7632.20831   117%     -   34s
H    0     0                    -32356.20910 7632.20831   124%     -   34s
H    0     0                    -19976.72087 7632.20831   138%     -   34s
H    0     0                    -19844.59185 7632.20831   138%     -   34s
H    0     0                    -19725.18717 7628.38194   139%     -   35s
H    0     0                    -19658.81338 2590.59593   113%     -   48s
H    0     0                    -19655.49594 2590.59593   113%     -   48s
H    0     0                    -19645.02517 2590.59593   113%     -   48s
H    0     0                    -19641.70773 2590.59593   113%     -   48s
     0     0 2590.59593    0  380 -19641.708 2590.59593   113%     -   48s
H    0     0                    -19531.76692 2589.04664   113%     -   49s
     0     0 2391.10951    0  391 -19531.767 2391.10951   112%     -   53s
     0     0 2318.70359    0  395 -19531.767 2318.70359   112%     -   56s
     0     0 2314.00254    0  398 -19531.767 2314.00254   112%     -   56s
     0     0 1981.64314    0  398 -19531.767 1981.64314   110%     -   61s
     0     0 1978.28609    0  400 -19531.767 1978.28609   110%     -   64s
     0     0 1761.64625    0  391 -19531.767 1761.64625   109%     -   68s
     0     0 1761.64625    0  392 -19531.767 1761.64625   109%     -   70s
     0     0 1761.64625    0  392 -19531.767 1761.64625   109%     -   71s
     0     0 1761.64625    0  393 -19531.767 1761.64625   109%     -   71s
     0     0 -2180.5430    0  447 -19531.767 -2180.5430  88.8%     -  100s
H    0     0                    -18934.16273 -2180.8452  88.5%     -  101s
     0     0 -2978.3808    0  449 -18934.163 -2978.3808  84.3%     -  117s
     0     0 -3031.1516    0  449 -18934.163 -3031.1516  84.0%     -  123s
     0     0 -3066.4592    0  460 -18934.163 -3066.4592  83.8%     -  128s
     0     0 -3124.2451    0  456 -18934.163 -3124.2451  83.5%     -  134s
     0     0 -3229.0836    0  453 -18934.163 -3229.0836  82.9%     -  139s
     0     0 -3278.7247    0  467 -18934.163 -3278.7247  82.7%     -  144s
     0     0 -3290.8610    0  470 -18934.163 -3290.8610  82.6%     -  146s
     0     0 -3383.8722    0  466 -18934.163 -3383.8722  82.1%     -  153s
     0     0 -3452.1049    0  476 -18934.163 -3452.1049  81.8%     -  158s
     0     0 -3456.2873    0  473 -18934.163 -3456.2873  81.7%     -  160s
     0     0 -3456.6186    0  474 -18934.163 -3456.6186  81.7%     -  162s
H    0     0                    -18807.85242 -5605.4364  70.2%     -  215s
H    0     0                    -18782.82289 -5605.4364  70.2%     -  215s
     0     0 -5605.4364    0  479 -18782.823 -5605.4364  70.2%     -  215s
H    0     0                    -18743.37867 -5605.5254  70.1%     -  216s
     0     0 -6032.5857    0  487 -18743.379 -6032.5857  67.8%     -  228s
     0     0 -6150.4539    0  499 -18743.379 -6150.4539  67.2%     -  237s
     0     0 -6187.9128    0  503 -18743.379 -6187.9128  67.0%     -  241s
     0     0 -6206.7808    0  499 -18743.379 -6206.7808  66.9%     -  244s
     0     0 -6230.3169    0  492 -18743.379 -6230.3169  66.8%     -  247s
     0     0 -6324.4457    0  494 -18743.379 -6324.4457  66.3%     -  252s
     0     0 -6343.3868    0  497 -18743.379 -6343.3868  66.2%     -  256s
     0     0 -6357.1099    0  494 -18743.379 -6357.1099  66.1%     -  259s
     0     0 -6359.5899    0  501 -18743.379 -6359.5899  66.1%     -  260s
     0     0 -6360.3500    0  504 -18743.379 -6360.3500  66.1%     -  261s
H    0     0                    -18621.63444 -7333.5132  60.6%     -  298s
     0     0 -7333.5132    0  481 -18621.634 -7333.5132  60.6%     -  298s
     0     0 -7516.8944    0  482 -18621.634 -7516.8944  59.6%     -  314s
     0     0 -7619.8401    0  492 -18621.634 -7619.8401  59.1%     -  328s
     0     0 -7648.0745    0  489 -18621.634 -7648.0745  58.9%     -  333s
     0     0 -7711.9715    0  488 -18621.634 -7711.9715  58.6%     -  342s
     0     0 -7750.0724    0  501 -18621.634 -7750.0724  58.4%     -  348s
     0     0 -7754.3992    0  505 -18621.634 -7754.3992  58.4%     -  350s
     0     0 -7755.8279    0  511 -18621.634 -7755.8279  58.4%     -  351s
     0     0 -8030.6872    0  560 -18621.634 -8030.6872  56.9%     -  373s
     0     0 -8073.9673    0  569 -18621.634 -8073.9673  56.6%     -  382s
     0     0 -8094.6494    0  571 -18621.634 -8094.6494  56.5%     -  389s
     0     0 -8109.4512    0  509 -18621.634 -8109.4512  56.5%     -  395s
     0     0 -8121.2985    0  510 -18621.634 -8121.2985  56.4%     -  399s
     0     0 -8123.5493    0  517 -18621.634 -8123.5493  56.4%     -  401s
     0     0 -8209.4060    0  536 -18621.634 -8209.4060  55.9%     -  413s
     0     0 -8229.0864    0  544 -18621.634 -8229.0864  55.8%     -  427s
     0     0 -8234.9767    0  550 -18621.634 -8234.9767  55.8%     -  429s
     0     0 -8239.6935    0  555 -18621.634 -8239.6935  55.8%     -  432s
     0     0 -8241.0357    0  557 -18621.634 -8241.0357  55.7%     -  433s
     0     0 -8264.0665    0  503 -18621.634 -8264.0665  55.6%     -  440s
     0     0 -8287.5928    0  498 -18621.634 -8287.5928  55.5%     -  448s
     0     0 -8296.3868    0  510 -18621.634 -8296.3868  55.4%     -  452s
     0     0 -8302.5345    0  507 -18621.634 -8302.5345  55.4%     -  455s
     0     0 -8307.8299    0  496 -18621.634 -8307.8299  55.4%     -  458s
     0     0 -8309.6239    0  496 -18621.634 -8309.6239  55.4%     -  459s
     0     0 -8326.0354    0  505 -18621.634 -8326.0354  55.3%     -  465s
H    0     0                    -16925.02690 -8330.8422  50.8%     -  469s
     0     0 -8330.8422    0  508 -16925.027 -8330.8422  50.8%     -  469s
     0     0 -8332.2532    0  509 -16925.027 -8332.2532  50.8%     -  471s
H    0     0                    -16445.92809 -8346.9820  49.2%     -  477s
H    0     0                    -16297.68742 -8346.9820  48.8%     -  477s
H    0     0                    -16224.94618 -8346.9820  48.6%     -  477s
H    0     0                    -16161.80934 -8346.9820  48.4%     -  477s
H    0     0                    -16157.26626 -8346.9820  48.3%     -  477s
     0     0 -8346.9820    0  560 -16157.266 -8346.9820  48.3%     -  478s
H    0     0                    -16113.45167 -8352.1294  48.2%     -  481s
H    0     0                    -16012.82486 -8352.1294  47.8%     -  481s
     0     0 -8352.1294    0  509 -16012.825 -8352.1294  47.8%     -  481s
     0     0 -8356.1181    0  499 -16012.825 -8356.1181  47.8%     -  483s
     0     0 -8356.6498    0  503 -16012.825 -8356.6498  47.8%     -  484s
     0     0 -8362.1451    0  512 -16012.825 -8362.1451  47.8%     -  488s
     0     0 -8362.4475    0  512 -16012.825 -8362.4475  47.8%     -  492s
H    0     0                    -16010.91858 -8362.4475  47.8%     -  534s
H    0     0                    -15680.99802 -8362.4475  46.7%     -  577s
H    0     0                    -15623.80097 -8362.4475  46.5%     -  578s
H    0     0                    -15608.49794 -8362.4475  46.4%     -  578s
H    0     2                    -15561.90158 -8362.4475  46.3%     -  645s
     0     2 -8362.4475    0  512 -15561.902 -8362.4475  46.3%     -  645s
     1     4 -8375.8185    1  567 -15561.902 -8363.0355  46.3%  2511  661s
     3     8 -8428.5449    2  551 -15561.902 -8375.8596  46.2%  5573  676s
     7    16 -8470.3872    3  479 -15561.902 -8428.7571  45.8%  5639  699s
    15    32 -8472.4348    4  480 -15561.902 -8470.4198  45.6%  7364  718s
    31    50 -13970.512    5  207 -15561.902 -8478.3108  45.5%  7787  756s
    49    78 -11380.984    6  383 -15561.902 -8478.3108  45.5% 11356  781s
    81   175 -11690.459    7  389 -15561.902 -8478.3108  45.5%  8948  804s
   190   228 -11981.212    9  381 -15561.902 -8478.3108  45.5%  5878  822s
   267   244 -12385.024   11  290 -15561.902 -8478.3108  45.5%  4937  838s
   305   265 -12612.845   12  349 -15561.902 -8478.3108  45.5%  4615  853s
H  342   265                    -15552.80259 -8478.3108  45.5%  4638  853s
   353   304 -14240.921   11  308 -15552.803 -8478.3108  45.5%  4657  870s
   412   336 -13311.338   13  283 -15552.803 -8478.3108  45.5%  4545  886s
   488   355 -12792.990   13  346 -15552.803 -8478.3108  45.5%  4244  904s
H  504   355                    -15530.75260 -8478.3108  45.4%  4218  904s
   541   377 -13359.117   15  324 -15530.753 -8478.3108  45.4%  4172  920s
   603   394     cutoff   14      -15530.753 -8478.3108  45.4%  4170  935s
H  617   394                    -15491.51535 -8478.3108  45.3%  4163  935s
H  631   394                    -15480.05192 -8478.3108  45.2%  4164  935s
   648   426 -13516.471   14  346 -15480.052 -8478.3108  45.2%  4209  951s
   711   457 -14773.980   15  228 -15480.052 -8478.3108  45.2%  4083  963s
H  714   457                    -15477.79140 -8478.3108  45.2%  4073  963s
H  724   457                    -15453.58351 -8478.3108  45.1%  4031  964s
   771   493 -13890.666   15  235 -15453.584 -8478.3108  45.1%  3993  977s
H  878   504                    -15443.70338 -8478.3108  45.1%  3748  993s
   931   516 -15060.188   16  239 -15443.703 -8478.3108  45.1%  3693 1008s
   971   526     cutoff   17      -15443.703 -8478.3108  45.1%  3750 1025s
  1024   537 -11086.975    9  370 -15443.703 -8478.3108  45.1%  3760 1042s
  1065   543 -11603.600   10  341 -15443.703 -8478.3108  45.1%  3823 1061s
  1119   550 -15291.556   11  252 -15443.703 -8478.3108  45.1%  3918 1080s
  1171   576 -15316.806   12  246 -15443.703 -8478.3108  45.1%  3934 1097s
  1217   606     cutoff   13      -15443.703 -8478.3108  45.1%  4004 1113s
  1283   647 -11458.720    8  446 -15443.703 -8478.3108  45.1%  3991 1131s
  1372   681 -11670.432    9  351 -15443.703 -8478.3108  45.1%  3926 1152s
H 1466   681                    -15441.84084 -8478.3108  45.1%  3828 1152s
  1480   673 -12172.941   10  325 -15441.841 -8478.3108  45.1%  3808 1174s
H 1499   673                    -15438.81964 -8478.3108  45.1%  3786 1174s
H 1515   673                    -15433.98117 -8478.3108  45.1%  3804 1174s
  1588   703     cutoff   11      -15433.981 -8478.3108  45.1%  3788 1195s
  1677   724 -14468.691    9  237 -15433.981 -9096.9121  41.1%  3861 1219s
  1751   738 -14775.057   10  203 -15433.981 -9096.9121  41.1%  3933 1241s
  1841   748 -11471.297   12  363 -15433.981 -9096.9121  41.1%  3930 1262s
  1960   780 -11649.836   14  347 -15433.981 -9096.9121  41.1%  3922 1287s
  2080   797 -12910.855   16  316 -15433.981 -9096.9121  41.1%  3968 1311s
  2123   815 -13120.596   17  381 -15433.981 -9096.9121  41.1%  4018 1332s
  2165   833 -13291.723   18  397 -15433.981 -9096.9121  41.1%  4075 1355s
  2209   843 -13371.945   19  383 -15433.981 -9096.9121  41.1%  4108 1379s
  2282   877 -13456.331   20  393 -15433.981 -9246.6889  40.1%  4092 1404s
  2384   866 -13871.342   22  442 -15433.981 -9246.6889  40.1%  4108 1432s
  2500   910 -14006.057   24  311 -15433.981 -9246.6889  40.1%  4103 1459s
  2607   935 -14108.626   25  376 -15433.981 -9246.6889  40.1%  4138 1489s
  2774   960 -14833.089   33  303 -15433.981 -9246.6889  40.1%  4067 1520s
  2911   970     cutoff   16      -15433.981 -9246.6889  40.1%  4114 1552s
  3027   975 -14369.648   15  215 -15433.981 -9246.6889  40.1%  4169 1585s
  3176  1016 -14743.813   17  182 -15433.981 -9246.6889  40.1%  4189 1616s
  3369  1045 -12726.593    8  404 -15433.981 -11316.334  26.7%  4204 1651s
  3564  1062 -13745.669   12  299 -15433.981 -11394.047  26.2%  4236 1687s
  3732  1066 -13103.745    9  161 -15433.981 -11441.990  25.9%  4266 1727s
  3924  1098     cutoff   10      -15433.981 -11441.990  25.9%  4272 1765s
  4139  1117     cutoff   17      -15433.981 -11637.888  24.6%  4265 1806s
  4362  1117 -15234.145   14  354 -15433.981 -11637.888  24.6%  4289 1847s
  4626  1124 infeasible   12      -15433.981 -11800.371  23.5%  4273 1892s
  4890  1117     cutoff   18      -15433.981 -12035.254  22.0%  4271 1932s
H 4952  1117                    -15433.68239 -12163.802  21.2%  4276 1932s
  4978  1083 -15233.513   10  305 -15433.682 -12163.802  21.2%  4294 1977s
  5234  1063 -13688.596   14  314 -15433.682 -12349.404  20.0%  4329 2023s
  5516  1030 -15002.720   14  357 -15433.682 -12637.282  18.1%  4325 2066s
  5755  1017     cutoff   15      -15433.682 -12764.033  17.3%  4310 2117s
  6122  1069 -15294.217   24  208 -15433.682 -12974.050  15.9%  4264 2168s
  6539  1055     cutoff   20      -15433.682 -13125.123  15.0%  4209 2223s
  7045  1073     cutoff   21      -15433.682 -13301.485  13.8%  4112 2272s
  7629  1027     cutoff   31      -15433.682 -13611.904  11.8%  3999 2323s
  8276   937     cutoff   30      -15433.682 -13829.372  10.4%  3884 2372s
  8787   840 -14962.268   25  405 -15433.682 -14039.432  9.03%  3789 2427s
  9636   518     cutoff   26      -15433.682 -14412.304  6.62%  3641 2475s
 11160   388     cutoff   24      -15433.682 -14681.774  4.87%  3299 2501s
 13030   225 -15360.442   30   36 -15433.682 -15102.932  2.14%  2877 2507s
 14895   401     cutoff   31      -15433.682 -15153.526  1.82%  2534 2516s
H16253   401                    -15404.13076 -15184.513  1.43%  2330 2516s
 17108   334     cutoff   25      -15404.131 -15245.169  1.03%  2218 2521s
*18075   334              57    -15395.45703 -15262.162  0.87%  2101 2521s

Cutting planes:
  Learned: 1
  Gomory: 1
  Cover: 1
  Implied bound: 76
  Clique: 1
  MIR: 2755
  Flow cover: 2494
  Zero half: 3
  RLT: 60
  Relax-and-lift: 471
  BQP: 3

Explored 19478 nodes (38404083 simplex iterations) in 2524.33 seconds (4676.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15395.5 -15404.1 -15433.7 ... -15480.1
No other solutions better than -15395.5

Optimal solution found (tolerance 1.00e-04)
Best objective -1.539545703465e+04, best bound -1.539545703465e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2524.45s
  Master Objective (UB) = -15395.46, θ = 101614.79
  Upper Bound (UB) = -15395.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 101614.79
  [DEBUG]   ✓ Scenario 0: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 101614.79 ≤ Q = 101614.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 101614.79 ≤ Q = 101614.79 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x767072f4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x898f8d0c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.256790e+13
Presolve removed 2566 rows and 1858 columns
Presolve time: 0.01s
Presolved: 527 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 6578487.4361
Variable types: 358 continuous, 173 integer (173 binary)
Found heuristic solution: objective 6578214.8953

Root relaxation: objective -1.369489e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136948.94    0  126 6578214.90 -136948.94   102%     -    0s
H    0     0                    -95729.36782 -136948.94  43.1%     -    0s
H    0     0                    -96001.90863 -136948.94  42.7%     -    0s
H    0     0                    -96106.98860 -136948.94  42.5%     -    0s
H    0     0                    -96430.08338 -136770.84  41.8%     -    0s
H    0     0                    -96702.62420 -136770.84  41.4%     -    0s
     0     0 -108842.55    0  105 -96702.624 -108842.55  12.6%     -    0s
H    0     0                    -105074.4499 -108823.47  3.57%     -    0s
H    0     0                    -105350.7104 -108823.47  3.30%     -    0s
H    0     0                    -106274.2096 -108823.47  2.40%     -    0s
H    0     0                    -106550.4701 -108823.47  2.13%     -    0s
H    0     0                    -106805.3038 -108823.47  1.89%     -    0s
     0     0 -108336.22    0  103 -106805.30 -108336.22  1.43%     -    0s
     0     0 -108254.42    0  103 -106805.30 -108254.42  1.36%     -    0s
     0     0 -108225.74    0  103 -106805.30 -108225.74  1.33%     -    0s
     0     0 -108036.43    0  103 -106805.30 -108036.43  1.15%     -    0s
     0     0 -108003.20    0  102 -106805.30 -108003.20  1.12%     -    0s
     0     0 -107866.65    0  106 -106805.30 -107866.65  0.99%     -    0s
     0     0 -107849.99    0  106 -106805.30 -107849.99  0.98%     -    0s
     0     2 -107844.87    0  106 -106805.30 -107844.87  0.97%     -    0s

Cutting planes:
  Gomory: 44
  Implied bound: 2
  MIR: 191
  RLT: 8
  BQP: 1

Explored 2448 nodes (15779 simplex iterations) in 0.27 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -106805 -106550 -106274 ... 6.57849e+06
No other solutions better than -106805

Optimal solution found (tolerance 1.00e-04)
Best objective -1.068053037608e+05, best bound -1.068053037608e+05, gap 0.0000%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 98198.82
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106805.30
  [DEBUG]   S×d_nominal = 205004.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205004.12 + -106805.30 = 98198.82
  [DEBUG]   Current θ from Master = 101614.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3415.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18811.43
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2563.0212, Absolute Gap = 2563.0212, Relative Gap = 0.166479
  Not converged yet (gap = 2563.02 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0xc7a16967
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.74s
Presolved: 90653 rows, 38830 columns, 550629 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -408825.1660
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.964e+06
 Factor NZ  : 8.602e+06 (roughly 120 MB of memory)
 Factor Ops : 1.498e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55123058e+07  1.59720581e+08  8.07e+04 1.86e+01  6.78e+04     5s
   1  -1.14377469e+07  1.37505748e+08  5.57e+04 5.76e+01  4.68e+04     5s
   2  -3.77696264e+06  1.04640367e+08  1.82e+04 5.68e+00  1.60e+04     5s
   3  -6.15012735e+05  6.16045522e+07  9.74e+02 8.43e-01  1.15e+03     5s
   4  -4.52743893e+05  3.06216509e+07  3.54e+02 2.76e-01  4.43e+02     5s
   5  -3.30802313e+05  2.15706222e+07  1.12e+02 1.77e-01  2.07e+02     5s
   6  -2.07884664e+05  1.54087215e+07  1.78e+01 1.19e-01  1.04e+02     5s
   7  -1.33505733e+05  1.10487366e+07  4.54e+00 8.27e-02  6.93e+01     5s
   8  -1.02416318e+05  4.49276367e+06  2.24e+00 3.21e-02  2.81e+01     5s
   9  -7.78405395e+04  1.96547104e+06  1.27e+00 1.37e-02  1.24e+01     5s
  10  -5.14573840e+04  5.27963641e+05  7.56e-01 3.35e-03  3.51e+00     5s
  11  -3.37634381e+04  2.26366208e+05  3.64e-01 2.68e-03  1.57e+00     5s
  12  -2.43976821e+04  1.14208537e+05  2.41e-01 1.52e-03  8.35e-01     6s
  13  -1.77397932e+04  7.33569165e+04  1.78e-01 1.87e-03  5.49e-01     6s
  14  -1.43667014e+04  5.57411494e+04  1.47e-01 2.13e-03  4.22e-01     6s
  15  -1.04582635e+04  4.26880422e+04  1.15e-01 1.87e-03  3.20e-01     6s
  16  -4.95893595e+03  3.52536113e+04  7.90e-02 2.15e-03  2.42e-01     6s
  17  -1.52143416e+03  2.61382287e+04  5.82e-02 2.27e-03  1.67e-01     6s
  18   5.03526154e+02  2.15915777e+04  4.65e-02 2.50e-03  1.27e-01     6s
  19   2.21220757e+03  1.87330601e+04  3.74e-02 1.27e-03  9.95e-02     6s
  20   3.83317458e+03  1.55281285e+04  2.90e-02 8.33e-04  7.04e-02     6s
  21   4.28998176e+03  1.46968070e+04  2.64e-02 7.83e-04  6.27e-02     6s
  22   5.69068359e+03  1.38315503e+04  1.94e-02 6.52e-04  4.90e-02     6s
  23   6.25098191e+03  1.33690960e+04  1.65e-02 6.39e-04  4.28e-02     7s
  24   6.97993009e+03  1.26761569e+04  1.29e-02 5.28e-04  3.43e-02     7s
  25   7.44432024e+03  1.19938321e+04  1.06e-02 4.23e-04  2.74e-02     7s
  26   8.00702273e+03  1.17149643e+04  7.86e-03 3.57e-04  2.23e-02     7s
  27   8.31617366e+03  1.11677559e+04  6.38e-03 2.56e-04  1.72e-02     7s
  28   8.49183836e+03  1.09186549e+04  5.58e-03 2.11e-04  1.46e-02     7s
  29   8.80109736e+03  1.07386421e+04  4.21e-03 1.79e-04  1.17e-02     7s
  30   9.04251041e+03  1.04510190e+04  3.15e-03 1.25e-04  8.48e-03     7s
  31   9.15167363e+03  1.03668149e+04  2.66e-03 1.07e-04  7.31e-03     7s
  32   9.31639955e+03  1.01645682e+04  1.92e-03 7.13e-05  5.10e-03     8s
  33   9.44306832e+03  1.00692675e+04  1.37e-03 5.30e-05  3.77e-03     8s
  34   9.45260351e+03  9.99902921e+03  1.33e-03 4.03e-05  3.29e-03     8s
  35   9.56865910e+03  9.93906639e+03  8.32e-04 2.93e-05  2.23e-03     8s
  36   9.62537652e+03  9.89048214e+03  5.93e-04 2.18e-05  1.60e-03     8s
  37   9.67590415e+03  9.85526485e+03  3.86e-04 1.49e-05  1.08e-03     8s
  38   9.71149219e+03  9.83744423e+03  2.49e-04 1.18e-05  7.58e-04     8s
  39   9.71864678e+03  9.79015026e+03  2.19e-04 2.30e-06  4.31e-04     8s
  40   9.74633169e+03  9.78478882e+03  1.09e-04 1.43e-06  2.32e-04     8s
  41   9.76042849e+03  9.77750933e+03  5.56e-05 5.13e-06  1.03e-04     9s
  42   9.77518646e+03  9.77618031e+03  1.09e-06 4.01e-06  5.98e-06     9s
  43   9.77580733e+03  9.77580793e+03  1.04e-09 1.68e-08  3.60e-09     9s
  44   9.77580760e+03  9.77580760e+03  5.27e-09 1.41e-09  2.57e-12     9s

Barrier solved model in 44 iterations and 8.79 seconds (7.55 work units)
Optimal objective 9.77580760e+03


Root crossover log...

   71890 DPushes remaining with DInf 0.0000000e+00                 9s
    8203 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2447 PPushes remaining with PInf 4.8725281e-08                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.0131097e-11     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27886    9.7758076e+03   0.000000e+00   0.000000e+00     11s
   27886    9.7758076e+03   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 9.775808e+03, 27886 iterations, 7.59 seconds (8.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 9775.80760    0  460 -211403.45 9775.80760   105%     -   12s
H    0     0                    -206253.5705 9775.80760   105%     -   12s
H    0     0                    -85119.76347 9775.80760   111%     -   12s
H    0     0                    -80490.12216 9775.80760   112%     -   12s
H    0     0                    -80368.30822 9775.80760   112%     -   12s
H    0     0                    -55853.48155 9775.80760   118%     -   12s
H    0     0                    -54863.95948 9775.80760   118%     -   12s
H    0     0                    -54820.81222 9775.80760   118%     -   13s
H    0     0                    -37791.23286 9775.80760   126%     -   15s
H    0     0                    -37490.55262 9775.80760   126%     -   15s
H    0     0                    -37453.26238 9775.80760   126%     -   15s
H    0     0                    -37059.27092 9775.80760   126%     -   15s
     0     0 4219.77059    0  544 -37059.271 4219.77059   111%     -   45s
H    0     0                    -32997.32581 4219.77059   113%     -   45s
H    0     0                    -32649.94324 4219.77059   113%     -   46s
H    0     0                    -32490.04479 4219.77059   113%     -   46s
H    0     0                    -30994.12557 4219.77059   114%     -   46s
     0     0 3309.11198    0  543 -30994.126 3309.11198   111%     -   65s
     0     0 3083.03862    0  554 -30994.126 3083.03862   110%     -   71s
     0     0 3032.27718    0  557 -30994.126 3032.27718   110%     -   77s
     0     0 3032.27718    0  548 -30994.126 3032.27718   110%     -   84s
     0     0 3032.27718    0  552 -30994.126 3032.27718   110%     -   89s
     0     0 3032.27718    0  555 -30994.126 3032.27718   110%     -   91s
     0     0 3032.27718    0  530 -30994.126 3032.27718   110%     -   96s
     0     0 3032.27718    0  526 -30994.126 3032.27718   110%     -   98s
     0     0 3032.27718    0  533 -30994.126 3032.27718   110%     -   99s
     0     0 3032.27718    0  533 -30994.126 3032.27718   110%     -  100s
H    0     0                    -23514.08592  -89.89895   100%     -  141s
H    0     0                    -22108.39963  -89.89895   100%     -  141s
     0     0  -89.89895    0  483 -22108.400  -89.89895   100%     -  141s
H    0     0                    -20345.69443  -90.50638   100%     -  142s
H    0     0                    -19825.05185  -90.50638   100%     -  142s
H    0     0                    -19811.35607  -90.50638   100%     -  142s
     0     0 -1227.7128    0  521 -19811.356 -1227.7128  93.8%     -  184s
     0     0 -1503.7506    0  526 -19811.356 -1503.7506  92.4%     -  210s
     0     0 -1645.2385    0  539 -19811.356 -1645.2385  91.7%     -  232s
H    0     0                    -19783.36393 -1806.2301  90.9%     -  248s
     0     0 -1806.2301    0  501 -19783.364 -1806.2301  90.9%     -  248s
H    0     0                    -19673.45345 -1867.3660  90.5%     -  258s
H    0     0                    -18926.67878 -1867.3660  90.1%     -  258s
H    0     0                    -18879.32988 -1867.3660  90.1%     -  258s
     0     0 -1867.3660    0  546 -18879.330 -1867.3660  90.1%     -  258s
     0     0 -1994.8539    0  549 -18879.330 -1994.8539  89.4%     -  268s
     0     0 -2018.6279    0  538 -18879.330 -2018.6279  89.3%     -  275s
     0     0 -2117.5825    0  533 -18879.330 -2117.5825  88.8%     -  284s
     0     0 -2142.2383    0  546 -18879.330 -2142.2383  88.7%     -  290s
     0     0 -2189.8480    0  536 -18879.330 -2189.8480  88.4%     -  297s
     0     0 -2214.6700    0  559 -18879.330 -2214.6700  88.3%     -  300s
     0     0 -2220.7450    0  553 -18879.330 -2220.7450  88.2%     -  303s
     0     0 -2222.6073    0  552 -18879.330 -2222.6073  88.2%     -  304s
     0     0 -2228.7279    0  544 -18879.330 -2228.7279  88.2%     -  305s
     0     0 -2229.5330    0  545 -18879.330 -2229.5330  88.2%     -  306s
H    0     0                    -18822.42683 -5158.8544  72.6%     -  374s
H    0     0                    -18621.63444 -5158.8544  72.3%     -  374s
H    0     0                    -17856.31453 -5158.8544  71.1%     -  374s
H    0     0                    -17710.87984 -5158.8544  70.9%     -  374s
H    0     0                    -17705.81911 -5158.8544  70.9%     -  374s
H    0     0                    -17651.29044 -5158.8544  70.8%     -  374s
H    0     0                    -17624.94781 -5158.8544  70.7%     -  374s
H    0     0                    -17606.64523 -5158.8544  70.7%     -  374s
H    0     0                    -17591.30453 -5158.8544  70.7%     -  374s
H    0     0                    -17581.96557 -5158.8544  70.7%     -  374s
H    0     0                    -17579.84110 -5158.8544  70.7%     -  374s
     0     0 -5158.8544    0  518 -17579.841 -5158.8544  70.7%     -  374s
     0     0 -5545.5620    0  546 -17579.841 -5545.5620  68.5%     -  406s
     0     0 -5714.0259    0  535 -17579.841 -5714.0259  67.5%     -  427s
     0     0 -5990.2575    0  508 -17579.841 -5990.2575  65.9%     -  452s
     0     0 -6073.9516    0  585 -17579.841 -6073.9516  65.4%     -  468s
     0     0 -6212.6511    0  531 -17579.841 -6212.6511  64.7%     -  482s
H    0     0                    -16598.86568 -6338.9926  61.8%     -  498s
H    0     0                    -16370.99534 -6338.9926  61.3%     -  498s
H    0     0                    -16367.96968 -6338.9926  61.3%     -  498s
H    0     0                    -16320.19394 -6338.9926  61.2%     -  498s
H    0     0                    -16278.36781 -6338.9926  61.1%     -  498s
     0     0 -6338.9926    0  556 -16278.368 -6338.9926  61.1%     -  498s
     0     0 -6360.8020    0  564 -16278.368 -6360.8020  60.9%     -  503s
H    0     0                    -15818.53362 -6372.0060  59.7%     -  512s
H    0     0                    -15741.57658 -6372.0060  59.5%     -  512s
     0     0 -6372.0060    0  569 -15741.577 -6372.0060  59.5%     -  512s
     0     0 -6378.9741    0  576 -15741.577 -6378.9741  59.5%     -  517s
     0     0 -6389.1604    0  520 -15741.577 -6389.1604  59.4%     -  521s
     0     0 -6393.2199    0  509 -15741.577 -6393.2199  59.4%     -  523s
     0     0 -6398.9948    0  517 -15741.577 -6398.9948  59.3%     -  526s
     0     0 -6411.4580    0  518 -15741.577 -6411.4580  59.3%     -  538s
     0     0 -6418.7818    0  518 -15741.577 -6418.7818  59.2%     -  544s
     0     0 -6421.4291    0  517 -15741.577 -6421.4291  59.2%     -  548s
     0     0 -6422.2924    0  526 -15741.577 -6422.2924  59.2%     -  550s
H    0     0                    -15686.72788 -7216.4671  54.0%     -  611s
H    0     0                    -15651.38644 -7216.4671  53.9%     -  611s
H    0     0                    -15648.97247 -7216.4671  53.9%     -  611s
     0     0 -7216.4671    0  510 -15648.972 -7216.4671  53.9%     -  611s
     0     0 -7432.8342    0  527 -15648.972 -7432.8342  52.5%     -  639s
     0     0 -7484.0830    0  518 -15648.972 -7484.0830  52.2%     -  657s
     0     0 -7501.6628    0  584 -15648.972 -7501.6628  52.1%     -  665s
     0     0 -7515.5273    0  648 -15648.972 -7515.5273  52.0%     -  672s
     0     0 -7537.8842    0  525 -15648.972 -7537.8842  51.8%     -  683s
     0     0 -7547.1829    0  535 -15648.972 -7547.1829  51.8%     -  692s
     0     0 -7551.7509    0  658 -15648.972 -7551.7509  51.7%     -  695s
     0     0 -7562.7879    0  659 -15648.972 -7562.7879  51.7%     -  701s
     0     0 -7569.7598    0  660 -15648.972 -7569.7598  51.6%     -  705s
     0     0 -7570.3868    0  656 -15648.972 -7570.3868  51.6%     -  708s
     0     0 -7720.0449    0  509 -15648.972 -7720.0449  50.7%     -  744s
     0     0 -7882.2578    0  520 -15648.972 -7882.2578  49.6%     -  774s
     0     0 -7905.7218    0  504 -15648.972 -7905.7218  49.5%     -  790s
     0     0 -7921.9228    0  517 -15648.972 -7921.9228  49.4%     -  799s
     0     0 -7944.0833    0  521 -15648.972 -7944.0833  49.2%     -  811s
     0     0 -7961.1655    0  528 -15648.972 -7961.1655  49.1%     -  819s
     0     0 -7965.5210    0  524 -15648.972 -7965.5210  49.1%     -  822s
     0     0 -7971.8160    0  518 -15648.972 -7971.8160  49.1%     -  828s
     0     0 -7973.8638    0  516 -15648.972 -7973.8638  49.0%     -  830s
     0     0 -8165.7545    0  517 -15648.972 -8165.7545  47.8%     -  861s
H    0     0                    -15647.68485 -8165.8078  47.8%     -  865s
     0     0 -8204.6296    0  518 -15647.685 -8204.6296  47.6%     -  877s
     0     0 -8242.1430    0  498 -15647.685 -8242.1430  47.3%     -  890s
     0     0 -8253.6421    0  512 -15647.685 -8253.6421  47.3%     -  898s
     0     0 -8258.2317    0  510 -15647.685 -8258.2317  47.2%     -  901s
     0     0 -8263.2628    0  511 -15647.685 -8263.2628  47.2%     -  904s
     0     0 -8264.6864    0  585 -15647.685 -8264.6864  47.2%     -  907s
     0     0 -8326.2465    0  515 -15647.685 -8326.2465  46.8%     -  931s
     0     0 -8338.9524    0  519 -15647.685 -8338.9524  46.7%     -  940s
     0     0 -8341.9359    0  513 -15647.685 -8341.9359  46.7%     -  944s
     0     0 -8381.6613    0  587 -15647.685 -8381.6613  46.4%     -  957s
H    0     0                    -15646.09557 -8381.7113  46.4%     -  959s
     0     0 -8394.1426    0  524 -15646.096 -8394.1426  46.3%     -  966s
     0     0 -8395.8247    0  525 -15646.096 -8395.8247  46.3%     -  968s
     0     0 -8446.3118    0  598 -15646.096 -8446.3118  46.0%     -  984s
     0     0 -8453.2060    0  596 -15646.096 -8453.2060  46.0%     -  990s
     0     0 -8455.7208    0  591 -15646.096 -8455.7208  46.0%     -  992s
     0     0 -8464.4582    0  539 -15646.096 -8464.4582  45.9%     - 1000s
H    0     0                    -15641.12598 -8465.1536  45.9%     - 1017s
H    0     0                    -15627.33777 -8465.1536  45.8%     - 1019s
H    0     0                    -15623.80503 -8465.1536  45.8%     - 1020s
     0     0 -8466.5593    0  529 -15623.805 -8466.5593  45.8%     - 1022s
     0     0 -8477.2764    0  536 -15623.805 -8477.2764  45.7%     - 1028s
     0     0 -8481.5181    0  529 -15623.805 -8481.5181  45.7%     - 1033s
     0     0 -8481.7969    0  529 -15623.805 -8481.7969  45.7%     - 1034s
     0     0 -8488.7502    0  552 -15623.805 -8488.7502  45.7%     - 1041s
     0     0 -8488.9549    0  552 -15623.805 -8488.9549  45.7%     - 1047s
H    0     0                    -15557.98536 -8489.6756  45.4%     - 1225s
H    0     0                    -15548.38485 -8489.6756  45.4%     - 1227s
H    0     0                    -15534.64212 -8489.6756  45.4%     - 1229s
H    0     0                    -15449.43655 -8489.6756  45.0%     - 1229s
H    0     0                    -15448.67297 -8489.6756  45.0%     - 1230s
H    0     0                    -15443.70338 -8489.6756  45.0%     - 1231s
     0     2 -8489.6756    0  552 -15443.703 -8489.6756  45.0%     - 1240s
     1     3 -8879.9145    1  410 -15443.703 -8489.6756  45.0%  9145 1256s
     2     6 -11564.893    2  390 -15443.703 -8489.6756  45.0% 12534 1281s
     5    12 -11680.942    3  377 -15443.703 -8613.6720  44.2%  8069 1320s
    11    20 -12613.241    4  365 -15443.703 -8628.4818  44.1% 11187 1373s
    23    24 -11991.773    4  382 -15443.703 -8684.7413  43.8% 14883 1421s
    35    36 -10443.041    5  426 -15443.703 -8684.7413  43.8% 13131 1517s
    57    62 -10663.083    6  420 -15443.703 -8684.9965  43.8% 15026 1557s
    89   115 -10785.319    7  406 -15443.703 -8684.9965  43.8% 14029 1601s
   152   219 -11009.786    9  400 -15443.703 -8684.9965  43.8% 10039 1636s
   262   259 -11202.883   13  380 -15443.703 -8684.9965  43.8%  7122 1663s
   308   326 -11224.759   14  379 -15443.703 -8684.9965  43.8%  6559 1687s
   381   373 -11451.143   16  371 -15443.703 -8684.9965  43.8%  5921 1709s
   438   425 -11454.968   17  377 -15443.703 -8684.9965  43.8%  5474 1733s
   520   441 -11564.016   19  387 -15443.703 -8684.9965  43.8%  5028 1756s
   574   486 -11684.016   21  520 -15443.703 -8684.9965  43.8%  4806 1784s
   642   497 -11769.308   22  518 -15443.703 -8684.9965  43.8%  4573 1809s
   683   530 -11961.213   23  506 -15443.703 -8684.9965  43.8%  4484 1830s
   739   540 -12022.085   24  508 -15443.703 -8684.9965  43.8%  4297 1857s
   779   576 -12062.076   25  496 -15443.703 -8684.9965  43.8%  4208 1877s
   845   601 -12154.695   27  551 -15443.703 -8684.9965  43.8%  4062 1911s
   886   647 -12350.867   29  482 -15443.703 -8684.9965  43.8%  3998 1939s
   960   715 -12380.962   31  477 -15443.703 -8684.9965  43.8%  3897 1963s
  1037   734 -12608.735   34  526 -15443.703 -8684.9965  43.8%  3775 1988s
  1090   772 -12626.877   35  526 -15443.703 -8684.9965  43.8%  3700 2020s
  1138   805 -12947.969   37  320 -15443.703 -8684.9965  43.8%  3686 2046s
  1216   867 -13380.562   38  387 -15443.703 -8930.0667  42.2%  3581 2076s
  1298   932 -13468.535   40  509 -15443.703 -8930.0667  42.2%  3487 2105s
H 1364   932                    -15441.91823 -8930.0667  42.2%  3425 2105s
  1395  1019 -12241.033   35  440 -15441.918 -8930.0667  42.2%  3410 2135s
  1508  1108 -13831.822   43  381 -15441.918 -8994.0724  41.8%  3312 2167s
H 1521  1108                    -15433.98117 -8994.0724  41.7%  3291 2167s
  1633  1176 -14072.990   46  373 -15433.981 -8994.0724  41.7%  3225 2201s
  1767  1252 -14182.378   49  444 -15433.981 -8994.0724  41.7%  3138 2239s
  1921  1340 -14794.476   51  356 -15433.981 -8994.0724  41.7%  3047 2275s
  2065  1440 -14946.343   55  462 -15433.981 -8994.0724  41.7%  2984 2315s
  2245  1497 -15334.366   61  279 -15433.981 -9070.4213  41.2%  2861 2352s
  2408  1558 -14153.141   11  359 -15433.981 -9070.4213  41.2%  2788 2393s
  2516  1616 -15275.668   13  324 -15433.981 -9070.4213  41.2%  2794 2435s
  2620  1697 -14051.225   49  449 -15433.981 -9070.4213  41.2%  2814 2480s
  2733  1792 -14373.896   53  440 -15433.981 -9070.4213  41.2%  2818 2525s
  2889  1829 -14981.103   59  350 -15433.981 -9070.4213  41.2%  2809 2570s
  3029  1897 -12279.283   11  450 -15433.981 -9997.8123  35.2%  2806 2618s
  3185  1986 -12660.679   13  348 -15433.981 -9997.8123  35.2%  2812 2671s
  3369  2015 -13023.573   16  346 -15433.981 -10000.278  35.2%  2783 2722s
H 3397  2015                    -15433.68239 -10000.278  35.2%  2789 2722s
  3448  2080 -13185.630   18  330 -15433.682 -10000.278  35.2%  2797 2771s
  3591  2165 -13424.661   20  412 -15433.682 -10200.004  33.9%  2812 2830s
  3756  2257 -13756.259   23  391 -15433.682 -10231.632  33.7%  2814 2891s
  3929  2337 -14504.466   29  388 -15433.682 -10231.632  33.7%  2831 2949s
  4067  2427     cutoff   32      -15433.682 -10252.189  33.6%  2874 3010s
  4282  2502 -15370.634   37  445 -15433.682 -10422.701  32.5%  2876 3076s
  4478  2538 -11108.474   18  557 -15433.682 -10422.701  32.5%  2884 3131s
  4588  2606 -11246.402   19  551 -15433.682 -10422.701  32.5%  2897 3193s
  4752  2702 -11596.065   20  533 -15433.682 -10422.701  32.5%  2906 3258s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 275
  MIR: 3787
  Flow cover: 2826
  RLT: 211
  Relax-and-lift: 1114

Explored 4932 nodes (15099055 simplex iterations) in 3600.05 seconds (5177.44 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15433.7 -15434 -15441.9 ... -15623.8

Time limit reached
Best objective -1.543368238797e+04, best bound -1.064870781125e+04, gap 31.0035%
  WARNING: Time limit reached. Using best solution found (gap: 31.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -15433.68, θ = 102248.21
  Upper Bound (UB) = -15433.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102248.21
  [DEBUG]   ✓ Scenario 0: θ = 102248.21 ≤ Q = 102248.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102248.21 ≤ Q = 102248.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102248.21 ≤ Q = 102248.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102248.21 ≤ Q = 102248.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102248.21 ≤ Q = 102248.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102248.21 ≤ Q = 102248.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102248.21 ≤ Q = 102248.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102248.21 ≤ Q = 102250.99 (slack: 2.78)
  [DEBUG]   ✓ Scenario 8: θ = 102248.21 ≤ Q = 102249.62 (slack: 1.42)
  [DEBUG]   ✓ Scenario 9: θ = 102248.21 ≤ Q = 102248.21 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1c0fe245
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe3f01dbb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.263567e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6483535.3547
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.370527e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137052.69    0  126 6483535.35 -137052.69   102%     -    0s
H    0     0                    -99661.61821 -137052.69  37.5%     -    0s
H    0     0                    -100086.8296 -137052.69  36.9%     -    0s
     0     0 -109867.22    0   64 -100086.83 -109867.22  9.77%     -    0s
H    0     0                    -109170.3049 -109865.83  0.64%     -    0s
H    0     0                    -109358.2628 -109865.83  0.46%     -    0s
     0     0 -109632.96    0   21 -109358.26 -109632.96  0.25%     -    0s
     0     0 -109561.28    0   14 -109358.26 -109561.28  0.19%     -    0s
H    0     0                    -109358.3242 -109549.64  0.17%     -    0s
     0     0 -109514.94    0   11 -109358.32 -109514.94  0.14%     -    0s
     0     0 -109511.53    0   11 -109358.32 -109511.53  0.14%     -    0s
     0     0 -109436.52    0    6 -109358.32 -109436.52  0.07%     -    0s
     0     0 -109436.52    0   38 -109358.32 -109436.52  0.07%     -    0s
H    0     0                    -109372.2276 -109436.52  0.06%     -    0s
*    0     0               0    -109398.3638 -109398.36  0.00%     -    0s

Cutting planes:
  Implied bound: 9
  MIR: 35
  Flow cover: 3

Explored 1 nodes (624 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -109398 -109372 -109358 ... 1.26357e+13
No other solutions better than -109398

Optimal solution found (tolerance 1.00e-04)
Best objective -1.093983637509e+05, best bound -1.093983637509e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 96567.91
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109398.36
  [DEBUG]   S×d_nominal = 205966.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205966.27 + -109398.36 = 96567.91
  [DEBUG]   Current θ from Master = 102248.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5680.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21113.98
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2524.7958, Absolute Gap = 2524.7958, Relative Gap = 0.163590
  Not converged yet (gap = 2524.80 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0xabac2086
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 2.80s
Presolved: 99580 rows, 42487 columns, 602280 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409450.7602
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.585e+06
 Factor NZ  : 1.009e+07 (roughly 140 MB of memory)
 Factor Ops : 1.871e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55329210e+07  1.72745540e+08  8.08e+04 1.98e+01  6.74e+04     5s
   1  -1.15972290e+07  1.48874528e+08  5.60e+04 5.57e+01  4.65e+04     5s
   2  -4.09462441e+06  1.13994749e+08  1.99e+04 1.42e-11  1.75e+04     5s
   3  -1.02062866e+06  9.57656462e+07  3.15e+03 1.32e+00  3.14e+03     5s
   4  -4.70817726e+05  6.37535328e+07  4.21e+02 4.51e+00  6.80e+02     5s
   5  -3.90340884e+05  2.77174218e+07  1.85e+02 1.10e+00  2.77e+02     5s
   6  -2.79024144e+05  1.48185818e+07  6.32e+01 9.76e-12  1.18e+02     5s
   7  -1.81890242e+05  1.11015863e+07  9.39e+00 1.30e-11  6.65e+01     5s
   8  -1.25619200e+05  5.68090153e+06  5.21e+00 6.63e-12  3.33e+01     5s
   9  -8.88046938e+04  1.46550332e+06  2.18e+00 4.75e-02  8.74e+00     6s
  10  -5.03402519e+04  4.85862648e+05  1.22e+00 1.46e-03  2.99e+00     6s
  11  -3.95905451e+04  2.91625783e+05  8.42e-01 2.28e-12  1.84e+00     6s
  12  -2.56530945e+04  1.46712115e+05  4.22e-01 8.55e-13  9.51e-01     6s
  13  -1.97249867e+04  9.23468065e+04  3.09e-01 5.57e-13  6.17e-01     6s
  14  -1.45780193e+04  6.17509686e+04  2.34e-01 3.55e-13  4.20e-01     6s
  15  -1.06616340e+04  4.80060646e+04  1.82e-01 2.58e-13  3.23e-01     6s
  16  -6.49566158e+03  3.41731882e+04  1.36e-01 1.69e-03  2.24e-01     6s
  17  -2.29395657e+03  2.59771893e+04  9.71e-02 2.25e-03  1.55e-01     6s
  18  -4.23801339e+02  2.16918106e+04  8.12e-02 3.68e-03  1.22e-01     6s
  19   2.28170448e+03  1.90795990e+04  5.94e-02 2.42e-03  9.23e-02     6s
  20   4.06307133e+03  1.79049315e+04  4.55e-02 1.84e-03  7.61e-02     7s
  21   4.94034818e+03  1.60229593e+04  3.84e-02 1.35e-03  6.09e-02     7s
  22   5.98972330e+03  1.52801334e+04  3.05e-02 1.38e-03  5.11e-02     7s
  23   7.28265736e+03  1.44884268e+04  2.09e-02 1.55e-03  3.96e-02     7s
  24   7.67719241e+03  1.33647415e+04  1.79e-02 1.15e-03  3.12e-02     7s
  25   8.15601563e+03  1.29149823e+04  1.46e-02 9.83e-04  2.61e-02     7s
  26   8.46770131e+03  1.24201921e+04  1.25e-02 7.96e-04  2.17e-02     7s
  27   8.60510255e+03  1.21333323e+04  1.15e-02 6.89e-04  1.94e-02     7s
  28   8.96795100e+03  1.19021361e+04  9.09e-03 5.96e-04  1.61e-02     8s
  29   9.18046774e+03  1.16766095e+04  7.62e-03 5.11e-04  1.37e-02     8s
  30   9.44507975e+03  1.14890460e+04  5.88e-03 4.37e-04  1.12e-02     8s
  31   9.56780410e+03  1.13556947e+04  5.05e-03 3.80e-04  9.82e-03     8s
  32   9.60313887e+03  1.11171584e+04  4.81e-03 2.91e-04  8.32e-03     8s
  33   9.82157918e+03  1.10572806e+04  3.43e-03 2.66e-04  6.79e-03     8s
  34   9.95258097e+03  1.08276261e+04  2.60e-03 1.72e-04  4.81e-03     8s
  35   1.00360923e+04  1.06629793e+04  2.08e-03 1.05e-04  3.44e-03     8s
  36   1.00973206e+04  1.06053024e+04  1.69e-03 8.39e-05  2.79e-03     9s
  37   1.01216419e+04  1.05748308e+04  1.54e-03 7.23e-05  2.49e-03     9s
  38   1.01758829e+04  1.05148481e+04  1.20e-03 5.23e-05  1.86e-03     9s
  39   1.02338218e+04  1.04620914e+04  8.64e-04 3.09e-05  1.25e-03     9s
  40   1.02730136e+04  1.04551421e+04  6.41e-04 2.80e-05  1.00e-03     9s
  41   1.02858430e+04  1.04260131e+04  5.63e-04 4.17e-05  7.70e-04     9s
  42   1.03127805e+04  1.04186556e+04  4.10e-04 3.33e-05  5.82e-04     9s
  43   1.03317808e+04  1.04168747e+04  3.03e-04 3.16e-05  4.67e-04     9s
  44   1.03606630e+04  1.04024442e+04  1.25e-04 1.94e-05  2.29e-04    10s
  45   1.03673815e+04  1.03881199e+04  9.05e-05 6.38e-06  1.14e-04    10s
  46   1.03691463e+04  1.03880081e+04  8.12e-05 6.16e-06  1.04e-04    10s
  47   1.03778449e+04  1.03858788e+04  3.57e-05 2.32e-06  4.41e-05    10s
  48   1.03819906e+04  1.03855585e+04  1.39e-05 9.47e-07  1.96e-05    10s
  49   1.03840487e+04  1.03850630e+04  3.94e-06 1.52e-06  5.57e-06    10s
  50   1.03845109e+04  1.03849921e+04  1.81e-06 5.20e-07  2.64e-06    10s
  51   1.03849521e+04  1.03849687e+04  1.03e-08 1.92e-07  9.11e-08    10s
  52   1.03849544e+04  1.03849544e+04  4.56e-09 2.02e-09  4.79e-10    10s

Barrier solved model in 52 iterations and 10.40 seconds (9.27 work units)
Optimal objective 1.03849544e+04


Root crossover log...

   78646 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    4943 PPushes remaining with PInf 1.3311011e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.6017851e-11     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38061    1.0384954e+04   0.000000e+00   0.000000e+00     15s
   38061    1.0384954e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.038495e+04, 38061 iterations, 11.26 seconds (13.54 work units)
Total elapsed time = 15.10s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10384.9544    0  468 -211403.45 10384.9544   105%     -   15s
H    0     0                    -207796.4838 10384.9544   105%     -   15s
H    0     0                    -119733.1226 10384.9544   109%     -   16s
H    0     0                    -83423.57862 10384.9544   112%     -   16s
H    0     0                    -46581.47812 10384.9544   122%     -   17s
H    0     0                    -46571.86116 10384.9544   122%     -   17s
H    0     0                    -46497.03019 10384.9544   122%     -   17s
H    0     0                    -45117.45252 10384.9544   123%     -   20s
H    0     0                    -31453.03914 10384.9544   133%     -   20s
H    0     0                    -31446.16327 10384.9544   133%     -   20s
H    0     0                    -25780.37661 4782.22137   119%     -   48s
H    0     0                    -19920.93804 4782.22137   124%     -   48s
H    0     0                    -19578.99797 4782.22137   124%     -   48s
     0     0 4782.22137    0  507 -19578.998 4782.22137   124%     -   48s
H    0     0                    -19535.24615 4782.20686   124%     -   49s
     0     0 4241.73311    0  508 -19535.246 4241.73311   122%     -   60s
     0     0 4177.50447    0  522 -19535.246 4177.50447   121%     -   65s
     0     0 4046.82086    0  521 -19535.246 4046.82086   121%     -   67s
     0     0 3978.86373    0  518 -19535.246 3978.86373   120%     -   72s
     0     0 3933.94864    0  516 -19535.246 3933.94864   120%     -   76s
     0     0 3905.13888    0  520 -19535.246 3905.13888   120%     -   79s
     0     0 3904.55042    0  520 -19535.246 3904.55042   120%     -   80s
H    0     0                    -19433.88992 1335.36021   107%     -  127s
H    0     0                    -19392.66076 1335.36021   107%     -  127s
     0     0 1080.73991    0  542 -19392.661 1080.73991   106%     -  127s
H    0     0                    -18768.40820 1080.73991   106%     -  128s
     0     0  807.46106    0  686 -18768.408  807.46106   104%     -  169s
     0     0  699.82483    0  667 -18768.408  699.82483   104%     -  203s
     0     0  625.34147    0  680 -18768.408  625.34147   103%     -  228s
     0     0  572.40969    0  587 -18768.408  572.40969   103%     -  253s
     0     0  557.37613    0  655 -18768.408  557.37613   103%     -  269s
     0     0  538.43191    0  654 -18768.408  538.43191   103%     -  276s
     0     0  527.30589    0  662 -18768.408  527.30589   103%     -  285s
     0     0  520.91139    0  665 -18768.408  520.91139   103%     -  291s
     0     0  518.34805    0  656 -18768.408  518.34805   103%     -  294s
     0     0  517.69263    0  655 -18768.408  517.69263   103%     -  297s
     0     0 -2001.8985    0  531 -18768.408 -2001.8985  89.3%     -  425s
H    0     0                    -18720.73963 -2001.9412  89.3%     -  426s
     0     0 -3007.0540    0  529 -18720.740 -3007.0540  83.9%     -  489s
     0     0 -3331.7737    0  549 -18720.740 -3331.7737  82.2%     -  533s
     0     0 -3476.3588    0  535 -18720.740 -3476.3588  81.4%     -  562s
     0     0 -3591.2993    0  529 -18720.740 -3591.2993  80.8%     -  599s
H    0     0                    -18714.78733 -3657.1725  80.5%     -  620s
H    0     0                    -18650.16634 -3657.1725  80.4%     -  620s
     0     0 -3657.1725    0  521 -18650.166 -3657.1725  80.4%     -  620s
     0     0 -3682.9513    0  525 -18650.166 -3682.9513  80.3%     -  634s
     0     0 -3717.0380    0  608 -18650.166 -3717.0380  80.1%     -  647s
     0     0 -3755.7662    0  607 -18650.166 -3755.7662  79.9%     -  658s
     0     0 -3762.4316    0  600 -18650.166 -3762.4316  79.8%     -  667s
     0     0 -3775.7531    0  598 -18650.166 -3775.7531  79.8%     -  674s
H    0     0                    -18625.13681 -3784.5744  79.7%     -  681s
     0     0 -3784.5744    0  600 -18625.137 -3784.5744  79.7%     -  681s
     0     0 -3787.6146    0  620 -18625.137 -3787.6146  79.7%     -  686s
     0     0 -3787.8605    0  614 -18625.137 -3787.8605  79.7%     -  688s
     0     0 -5545.8424    0  534 -18625.137 -5545.8424  70.2%     -  848s
     0     0 -5857.7879    0  505 -18625.137 -5857.7879  68.5%     -  911s
     0     0 -5946.8653    0  582 -18625.137 -5946.8653  68.1%     -  942s
     0     0 -6100.7502    0  513 -18625.137 -6100.7502  67.2%     -  979s
     0     0 -6285.6925    0  504 -18625.137 -6285.6925  66.3%     - 1010s
H    0     0                    -18621.63444 -6418.3067  65.5%     - 1040s
     0     0 -6418.3067    0  516 -18621.634 -6418.3067  65.5%     - 1040s
     0     0 -6474.6351    0  519 -18621.634 -6474.6351  65.2%     - 1061s
     0     0 -6490.9014    0  521 -18621.634 -6490.9014  65.1%     - 1071s
     0     0 -6497.2493    0  532 -18621.634 -6497.2493  65.1%     - 1078s
     0     0 -6503.3160    0  514 -18621.634 -6503.3160  65.1%     - 1084s
     0     0 -6506.7214    0  520 -18621.634 -6506.7214  65.1%     - 1086s
     0     0 -6507.2116    0  510 -18621.634 -6507.2116  65.1%     - 1088s
     0     0 -7024.0927    0  579 -18621.634 -7024.0927  62.3%     - 1143s
     0     0 -7177.7845    0  562 -18621.634 -7177.7845  61.5%     - 1181s
     0     0 -7231.0028    0  565 -18621.634 -7231.0028  61.2%     - 1202s
     0     0 -7249.9101    0  515 -18621.634 -7249.9101  61.1%     - 1217s
     0     0 -7269.8984    0  569 -18621.634 -7269.8984  61.0%     - 1230s
     0     0 -7274.8884    0  563 -18621.634 -7274.8884  60.9%     - 1236s
     0     0 -7276.0948    0  506 -18621.634 -7276.0948  60.9%     - 1239s
     0     0 -7590.0628    0  495 -18621.634 -7590.0628  59.2%     - 1280s
     0     0 -7652.9173    0  493 -18621.634 -7652.9173  58.9%     - 1362s
     0     0 -7682.6722    0  497 -18621.634 -7682.6722  58.7%     - 1377s
     0     0 -7704.8379    0  488 -18621.634 -7704.8379  58.6%     - 1387s
     0     0 -7713.1263    0  480 -18621.634 -7713.1263  58.6%     - 1394s
     0     0 -7715.8429    0  492 -18621.634 -7715.8429  58.6%     - 1397s
     0     0 -7836.8397    0  493 -18621.634 -7836.8397  57.9%     - 1427s
     0     0 -7876.4678    0  490 -18621.634 -7876.4678  57.7%     - 1447s
     0     0 -7891.1859    0  564 -18621.634 -7891.1859  57.6%     - 1462s
     0     0 -7895.0934    0  571 -18621.634 -7895.0934  57.6%     - 1472s
     0     0 -7911.7482    0  552 -18621.634 -7911.7482  57.5%     - 1487s
     0     0 -7926.4949    0  571 -18621.634 -7926.4949  57.4%     - 1505s
     0     0 -7928.3671    0  567 -18621.634 -7928.3671  57.4%     - 1512s
     0     0 -7982.8666    0  498 -18621.634 -7982.8666  57.1%     - 1541s
     0     0 -8002.3964    0  498 -18621.634 -8002.3964  57.0%     - 1559s
     0     0 -8006.6771    0  500 -18621.634 -8006.6771  57.0%     - 1570s
     0     0 -8032.6417    0  503 -18621.634 -8032.6417  56.9%     - 1587s
     0     0 -8036.7421    0  509 -18621.634 -8036.7421  56.8%     - 1597s
     0     0 -8039.1154    0  507 -18621.634 -8039.1154  56.8%     - 1607s
     0     0 -8090.2242    0  504 -18621.634 -8090.2242  56.6%     - 1637s
     0     0 -8111.5647    0  512 -18621.634 -8111.5647  56.4%     - 1656s
     0     0 -8121.5551    0  507 -18621.634 -8121.5551  56.4%     - 1669s
     0     0 -8126.3609    0  521 -18621.634 -8126.3609  56.4%     - 1678s
     0     0 -8130.6873    0  521 -18621.634 -8130.6873  56.3%     - 1688s
     0     0 -8145.0291    0  516 -18621.634 -8145.0291  56.3%     - 1702s
     0     0 -8153.1014    0  517 -18621.634 -8153.1014  56.2%     - 1710s
     0     0 -8154.7096    0  520 -18621.634 -8154.7096  56.2%     - 1713s
     0     0 -8188.7532    0  508 -18621.634 -8188.7532  56.0%     - 1731s
     0     0 -8203.7208    0  523 -18621.634 -8203.7208  55.9%     - 1744s
     0     0 -8205.6968    0  533 -18621.634 -8205.6968  55.9%     - 1750s
     0     0 -8214.1005    0  532 -18621.634 -8214.1005  55.9%     - 1766s
     0     0 -8216.9516    0  529 -18621.634 -8216.9516  55.9%     - 1774s
H    0     0                    -16471.96745 -8237.1781  50.0%     - 1794s
H    0     0                    -16109.97668 -8237.1781  48.9%     - 1794s
H    0     0                    -16068.04327 -8237.1781  48.7%     - 1794s
H    0     0                    -16063.07369 -8237.1781  48.7%     - 1794s
H    0     0                    -15997.81658 -8237.1781  48.5%     - 1794s
H    0     0                    -15982.63692 -8237.1781  48.5%     - 1794s
H    0     0                    -15896.99925 -8237.1781  48.2%     - 1794s
H    0     0                    -15888.60548 -8237.1781  48.2%     - 1794s
H    0     0                    -15885.51001 -8237.1781  48.1%     - 1794s
H    0     0                    -15885.27862 -8237.1781  48.1%     - 1794s
H    0     0                    -15883.20498 -8237.1781  48.1%     - 1794s
H    0     0                    -15880.62625 -8237.1781  48.1%     - 1794s
     0     0 -8237.1781    0  589 -15880.626 -8237.1781  48.1%     - 1794s
     0     0 -8237.2050    0  589 -15880.626 -8237.2050  48.1%     - 1803s
H    0     0                    -15871.13847 -8237.2307  48.1%     - 1842s
H    0     0                    -15862.13813 -8237.2307  48.1%     - 1842s
H    0     0                    -15768.59974 -8237.2307  47.8%     - 1938s
H    0     0                    -15659.02498 -8237.2307  47.4%     - 1943s
H    0     0                    -15651.93092 -8237.2307  47.4%     - 1988s
H    0     0                    -15645.97641 -8237.2307  47.4%     - 1997s
H    0     0                    -15624.84755 -8237.2307  47.3%     - 1997s
H    0     0                    -15616.40552 -8237.2307  47.3%     - 1997s
H    0     0                    -15561.99930 -8237.2307  47.1%     - 1997s
H    0     0                    -15546.22476 -8237.2307  47.0%     - 1997s
H    0     0                    -15537.71847 -8237.2307  47.0%     - 2003s
     0     2 -8237.2307    0  589 -15537.718 -8237.2307  47.0%     - 2006s
     1     3 -8436.8404    1  457 -15537.718 -8237.2699  47.0% 11443 2032s
     2     4 -8337.0604    1  583 -15537.718 -8337.0604  46.3% 10328 2056s
     3     6 -8682.0223    2  415 -15537.718 -8337.0624  46.3%  8861 2080s
     5    10 -8952.1790    3  472 -15537.718 -8337.0624  46.3%  9362 2117s
     9    19 -9124.8584    4  473 -15537.718 -8470.4365  45.5% 10296 2154s
    18    35 -9225.3607    5  469 -15537.718 -8470.4365  45.5% 10546 2210s
    34    48 -12094.570    6  325 -15537.718 -8511.0851  45.2% 17914 2300s
    49    76 -9893.2928    6  459 -15537.718 -8511.0851  45.2% 17183 2367s
    77   171 -10024.876    7  453 -15537.718 -8511.0851  45.2% 13018 2456s
   193   197 -10785.232    9  422 -15537.718 -8511.0851  45.2%  7342 2493s
   227   216 -10418.432    9  511 -15537.718 -8511.0851  45.2%  6816 2529s
   269   242 -10454.751   10  560 -15537.718 -8511.0851  45.2%  6277 2564s
   318   260 -13296.917   10  277 -15537.718 -8511.0851  45.2%  5849 2597s
   361   287 -11008.124   11  403 -15537.718 -8511.0851  45.2%  5586 2630s
   402   312 -10834.458   10  408 -15537.718 -8511.0851  45.2%  5400 2658s
   454   342 -14096.100   16  161 -15537.718 -8604.8791  44.6%  5073 2690s
   511   365 -11169.802   12  413 -15537.718 -8604.8791  44.6%  4758 2722s
   581   373 -11777.969   12  427 -15537.718 -8604.8791  44.6%  4478 2758s
   637   396 -11669.463   13  373 -15537.718 -8604.8791  44.6%  4298 2790s
   692   402 -15371.929   24  124 -15537.718 -8604.8791  44.6%  4182 2823s
   756   417 -12046.119   14  376 -15537.718 -8604.8791  44.6%  4096 2852s
   802   440 -13664.914   23  297 -15537.718 -8604.8791  44.6%  4141 2883s
   849   454 -12773.951   15  447 -15537.718 -8604.8791  44.6%  4184 2919s
   897   483 -12791.249   16  446 -15537.718 -8604.8791  44.6%  4173 2951s
   967   517 -12975.322   17  456 -15537.718 -8604.8791  44.6%  4125 2981s
  1042   563 infeasible   17      -15537.718 -8604.8791  44.6%  4044 3021s
  1134   578 -13198.948   18  455 -15537.718 -8604.8791  44.6%  3936 3061s
  1208   577 -13068.301   18  447 -15537.718 -8605.0299  44.6%  3880 3105s
  1283   581 infeasible   16      -15537.718 -8605.0299  44.6%  3837 3152s
  1333   612 -13457.517   20  469 -15537.718 -8668.7567  44.2%  3896 3201s
  1404   640 -13609.008   21  461 -15537.718 -8668.7567  44.2%  3909 3250s
  1476   685 infeasible   20      -15537.718 -8668.7567  44.2%  3922 3301s
  1549   731 infeasible   25      -15537.718 -8668.7567  44.2%  3995 3353s
  1652   748 -14685.858   29  271 -15537.718 -8668.7567  44.2%  3961 3405s
  1735   826 -14882.529   30  320 -15537.718 -8668.7567  44.2%  3989 3456s
  1853   901     cutoff   33      -15537.718 -8668.7567  44.2%  3945 3509s
  1985   970 infeasible   34      -15537.718 -8668.7567  44.2%  3874 3565s
  2126  1009 -14277.022   20  343 -15537.718 -8668.7567  44.2%  3828 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 227
  MIR: 3800
  Flow cover: 3076
  RLT: 262
  Relax-and-lift: 1468

Explored 2223 nodes (9283521 simplex iterations) in 3600.09 seconds (4973.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15537.7 -15546.2 -15562 ... -15862.1

Time limit reached
Best objective -1.553771846731e+04, best bound -8.668756666419e+03, gap 44.2083%
  WARNING: Time limit reached. Using best solution found (gap: 44.21%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -15537.72, θ = 102296.40
  Upper Bound (UB) = -15537.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102296.40
  [DEBUG]   ✓ Scenario 0: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102296.40 ≤ Q = 102296.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102296.40 ≤ Q = 102296.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102296.40 ≤ Q = 102296.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x419449b6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x419449b6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.261995e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6462922.7248
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.370508e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137050.79    0  126 6462922.72 -137050.79   102%     -    0s
H    0     0                    -99650.81453 -137050.79  37.5%     -    0s
H    0     0                    -100059.0352 -137050.79  37.0%     -    0s
H    0     0                    -107181.2309 -109415.43  2.08%     -    0s
     0     0 -109415.43    0   68 -107181.23 -109415.43  2.08%     -    0s
H    0     0                    -107465.1712 -109332.56  1.74%     -    0s
H    0     0                    -107879.2605 -109332.56  1.35%     -    0s
H    0     0                    -108163.2008 -109332.56  1.08%     -    0s
     0     0 -108754.13    0   65 -108163.20 -108754.13  0.55%     -    0s
     0     0 -108714.28    0   62 -108163.20 -108714.28  0.51%     -    0s
     0     0 -108509.98    0   24 -108163.20 -108509.98  0.32%     -    0s
     0     0 -108454.92    0   29 -108163.20 -108454.92  0.27%     -    0s
     0     0 -108409.39    0   32 -108163.20 -108409.39  0.23%     -    0s
     0     0 -108408.88    0   30 -108163.20 -108408.88  0.23%     -    0s
     0     0 -108397.48    0   30 -108163.20 -108397.48  0.22%     -    0s
     0     0 -108296.51    0   16 -108163.20 -108296.51  0.12%     -    0s
     0     0 -108296.51    0   14 -108163.20 -108296.51  0.12%     -    0s
     0     0 -108214.85    0    4 -108163.20 -108214.85  0.05%     -    0s
H    0     0                    -108182.9240 -108213.98  0.03%     -    0s
     0     0 -108213.56    0    2 -108182.92 -108213.56  0.03%     -    0s
*    0     0               0    -108213.5022 -108213.50  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 2
  MIR: 7
  Flow cover: 8
  Relax-and-lift: 1

Explored 1 nodes (787 simplex iterations) in 0.23 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -108214 -108183 -108163 ... 1.26199e+13
No other solutions better than -108214

Optimal solution found (tolerance 1.00e-04)
Best objective -1.082135022227e+05, best bound -1.082135022227e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 97739.31
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108213.50
  [DEBUG]   S×d_nominal = 205952.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205952.81 + -108213.50 = 97739.31
  [DEBUG]   Current θ from Master = 102296.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4557.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20094.81
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2420.7598, Absolute Gap = 2420.7598, Relative Gap = 0.155799
  Not converged yet (gap = 2420.76 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524543 nonzeros
Model fingerprint: 0xe2c7a3d5
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 76356 rows and 30996 columns
Presolve time: 3.55s
Presolved: 108507 rows, 46144 columns, 653627 nonzeros
Variable types: 43885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -408350.2869
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 692
 AA' NZ     : 3.542e+06
 Factor NZ  : 8.716e+06 (roughly 130 MB of memory)
 Factor Ops : 1.705e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55461753e+07  1.86248275e+08  8.09e+04 2.18e+01  6.70e+04     6s
   1  -1.16343746e+07  1.60717457e+08  5.60e+04 5.31e+01  4.62e+04     6s
   2  -4.83290672e+06  1.23781234e+08  2.27e+04 5.63e-01  1.98e+04     6s
   3  -7.62694101e+05  8.59508137e+07  1.50e+03 1.10e+00  1.67e+03     6s
   4  -4.78535903e+05  2.94194296e+07  3.47e+02 1.30e-01  3.96e+02     6s
   5  -3.47932210e+05  2.07535067e+07  1.25e+02 7.27e-02  1.88e+02     6s
   6  -2.23854967e+05  1.54737172e+07  4.47e+01 4.81e-02  1.05e+02     6s
   7  -1.52917739e+05  1.06481487e+07  2.09e+01 3.08e-02  6.44e+01     6s
   8  -1.08954804e+05  4.50543262e+06  1.10e+01 1.15e-02  2.61e+01     6s
   9  -7.16490844e+04  9.55696978e+05  4.20e+00 2.21e-03  5.53e+00     6s
  10  -5.13053786e+04  5.67918709e+05  2.89e+00 1.34e-03  3.27e+00     7s
  11  -4.06699892e+04  2.97947867e+05  2.10e+00 7.18e-04  1.77e+00     7s
  12  -2.81764856e+04  1.54660450e+05  1.10e+00 6.13e-04  9.40e-01     7s
  13  -2.11570758e+04  9.06300671e+04  7.08e-01 1.03e-03  5.71e-01     7s
  14  -1.53292485e+04  6.01452839e+04  4.78e-01 2.14e-03  3.84e-01     7s
  15  -1.28782488e+04  4.74689333e+04  4.14e-01 1.57e-03  3.07e-01     7s
  16  -9.71133996e+03  3.83405229e+04  3.32e-01 1.98e-03  2.44e-01     7s
  17  -7.64622949e+03  2.60741745e+04  2.88e-01 2.64e-03  1.71e-01     7s
  18  -4.65897136e+03  2.34720820e+04  2.28e-01 2.23e-03  1.43e-01     7s
  19  -2.63747537e+03  1.95887113e+04  1.95e-01 2.31e-03  1.13e-01     7s
  20  -5.25865150e+02  1.77385568e+04  1.62e-01 1.86e-03  9.27e-02     7s
  21   1.62607001e+02  1.68740845e+04  1.50e-01 1.50e-03  8.48e-02     7s
  22   2.11021518e+03  1.55988679e+04  1.20e-01 1.25e-03  6.84e-02     7s
  23   2.68675609e+03  1.43961766e+04  1.11e-01 1.78e-03  5.94e-02     8s
  24   4.57439654e+03  1.39176210e+04  8.29e-02 1.90e-03  4.74e-02     8s
  25   5.04688701e+03  1.33548929e+04  7.58e-02 1.31e-03  4.21e-02     8s
  26   5.84707231e+03  1.27213009e+04  6.37e-02 1.52e-03  3.49e-02     8s
  27   6.20566402e+03  1.25605222e+04  5.85e-02 1.43e-03  3.22e-02     8s
  28   6.64092217e+03  1.19075063e+04  5.22e-02 1.50e-03  2.67e-02     8s
  29   7.61028224e+03  1.15583838e+04  3.85e-02 8.90e-04  2.00e-02     8s
  30   8.00160284e+03  1.13709925e+04  3.31e-02 1.10e-03  1.71e-02     8s
  31   8.15948726e+03  1.12936755e+04  3.06e-02 9.39e-04  1.59e-02     8s
  32   8.25347897e+03  1.10515052e+04  2.92e-02 7.47e-04  1.42e-02     8s
  33   8.57511202e+03  1.09859802e+04  2.47e-02 5.99e-04  1.22e-02     8s
  34   8.79656963e+03  1.08977313e+04  2.16e-02 7.75e-04  1.07e-02     9s
  35   9.15969270e+03  1.08320589e+04  1.66e-02 1.29e-03  8.48e-03     9s
  36   9.33387197e+03  1.08021225e+04  1.41e-02 1.27e-03  7.44e-03     9s
  37   9.39452911e+03  1.07337008e+04  1.33e-02 9.74e-04  6.79e-03     9s
  38   9.55036530e+03  1.07117006e+04  1.12e-02 8.31e-04  5.89e-03     9s
  39   9.64608375e+03  1.06643328e+04  9.76e-03 7.20e-04  5.16e-03     9s
  40   9.75263719e+03  1.05773127e+04  8.22e-03 6.92e-04  4.18e-03     9s
  41   9.88055180e+03  1.05385764e+04  6.40e-03 4.44e-04  3.34e-03     9s
  42   1.00350916e+04  1.04816850e+04  4.29e-03 5.11e-04  2.26e-03     9s
  43   1.00657679e+04  1.04363426e+04  3.88e-03 2.85e-04  1.88e-03     9s
  44   1.01747035e+04  1.04139053e+04  2.48e-03 1.44e-04  1.21e-03     9s
  45   1.02274843e+04  1.04001181e+04  1.80e-03 9.14e-05  8.75e-04    10s
  46   1.02482969e+04  1.03978983e+04  1.54e-03 8.42e-05  7.58e-04    10s
  47   1.02813354e+04  1.03926267e+04  1.12e-03 6.52e-05  5.64e-04    10s
  48   1.03149622e+04  1.03901244e+04  7.09e-04 5.61e-05  3.81e-04    10s
  49   1.03176745e+04  1.03844146e+04  6.74e-04 3.43e-05  3.38e-04    10s
  50   1.03570299e+04  1.03823387e+04  1.70e-04 2.72e-05  1.28e-04    10s
  51   1.03681515e+04  1.03783628e+04  4.80e-05 1.51e-05  5.16e-05    10s
  52   1.03692108e+04  1.03770162e+04  3.72e-05 1.11e-05  3.94e-05    10s
  53   1.03713411e+04  1.03747136e+04  1.71e-05 4.26e-06  1.70e-05    10s
  54   1.03727643e+04  1.03744975e+04  4.52e-06 3.60e-06  8.74e-06    10s
  55   1.03731441e+04  1.03735553e+04  1.08e-06 7.94e-07  2.07e-06    11s
  56   1.03732799e+04  1.03732835e+04  1.41e-08 3.21e-09  1.81e-08    11s
  57   1.03732817e+04  1.03732821e+04  8.25e-08 1.23e-09  2.30e-09    11s
  58   1.03732821e+04  1.03732821e+04  2.34e-07 3.75e-11  2.02e-10    11s

Barrier solved model in 58 iterations and 10.91 seconds (9.58 work units)
Optimal objective 1.03732821e+04


Root crossover log...

   88638 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    4578 PPushes remaining with PInf 1.2471745e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.3385447e-11     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41459    1.0373282e+04   0.000000e+00   0.000000e+00     15s
   41459    1.0373282e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 1.037328e+04, 41459 iterations, 10.56 seconds (12.96 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10373.2821    0  407 -211403.45 10373.2821   105%     -   16s
H    0     0                    -210003.7552 10373.2821   105%     -   16s
H    0     0                    -152028.4433 10373.2821   107%     -   16s
H    0     0                    -83339.83008 10373.2821   112%     -   16s
H    0     0                    -51317.20786 10373.2821   120%     -   17s
H    0     0                    -47860.76432 10373.2821   122%     -   17s
H    0     0                    -46497.03019 10373.2821   122%     -   17s
H    0     0                    -36512.33607 10373.2821   128%     -   19s
H    0     0                    -31426.37599 10373.2821   133%     -   19s
H    0     0                    -31419.50012 10373.2821   133%     -   19s
H    0     0                    -23372.01627 4727.07248   120%     -   70s
H    0     0                    -23304.03969 4727.07248   120%     -   70s
H    0     0                    -23161.17121 4727.07248   120%     -   70s
H    0     0                    -22403.01480 4727.07248   121%     -   70s
H    0     0                    -22396.13893 4727.07248   121%     -   70s
     0     0 4300.24806    0  575 -22396.139 4300.24806   119%     -   70s
H    0     0                    -20589.74153 4300.24806   121%     -   71s
     0     0 3769.21474    0  592 -20589.742 3769.21474   118%     -   88s
     0     0 3612.64662    0  588 -20589.742 3612.64662   118%     -  107s
     0     0 3612.64662    0  595 -20589.742 3612.64662   118%     -  115s
     0     0 3607.29505    0  589 -20589.742 3607.29505   118%     -  124s
     0     0 3598.23477    0  590 -20589.742 3598.23477   117%     -  128s
     0     0 3577.10759    0  590 -20589.742 3577.10759   117%     -  129s
     0     0 3576.93412    0  590 -20589.742 3576.93412   117%     -  131s
H    0     0                    -20313.94430  972.78787   105%     -  195s
H    0     0                    -19612.58440  972.78787   105%     -  195s
H    0     0                    -19591.50630  972.78787   105%     -  195s
H    0     0                    -19562.55091  972.78787   105%     -  195s
H    0     0                    -19543.20991  972.78787   105%     -  195s
     0     0  972.78787    0  508 -19543.210  972.78787   105%     -  197s
H    0     0                    -19501.96647  972.78147   105%     -  198s
     0     0 -881.70792    0  550 -19501.966 -881.70792  95.5%     -  284s
     0     0 -1471.8128    0  597 -19501.966 -1471.8128  92.5%     -  342s
     0     0 -1735.4069    0  593 -19501.966 -1735.4069  91.1%     -  397s
     0     0 -1776.1185    0  613 -19501.966 -1776.1185  90.9%     -  427s
     0     0 -1792.5330    0  611 -19501.966 -1792.5330  90.8%     -  441s
H    0     0                    -19226.13175 -1805.7646  90.6%     -  450s
H    0     0                    -19221.16216 -1805.7646  90.6%     -  450s
H    0     0                    -19199.46860 -1805.7646  90.6%     -  450s
H    0     0                    -19194.49901 -1805.7646  90.6%     -  450s
H    0     0                    -19194.17189 -1805.7646  90.6%     -  450s
H    0     0                    -19189.20230 -1805.7646  90.6%     -  450s
H    0     0                    -19159.15045 -1805.7646  90.6%     -  450s
H    0     0                    -19154.18086 -1805.7646  90.6%     -  450s
H    0     0                    -19133.03572 -1805.7646  90.6%     -  450s
H    0     0                    -19128.06614 -1805.7646  90.6%     -  450s
     0     0 -1805.7646    0  604 -19128.066 -1805.7646  90.6%     -  450s
     0     0 -1843.1835    0  603 -19128.066 -1843.1835  90.4%     -  469s
     0     0 -1854.8251    0  604 -19128.066 -1854.8251  90.3%     -  480s
     0     0 -1867.3458    0  604 -19128.066 -1867.3458  90.2%     -  490s
     0     0 -1869.6687    0  604 -19128.066 -1869.6687  90.2%     -  495s
     0     0 -1911.7060    0  565 -19128.066 -1911.7060  90.0%     -  510s
     0     0 -1918.6706    0  564 -19128.066 -1918.6706  90.0%     -  525s
     0     0 -1923.7461    0  560 -19128.066 -1923.7461  89.9%     -  532s
     0     0 -1925.6412    0  561 -19128.066 -1925.6412  89.9%     -  535s
     0     0 -1927.4476    0  555 -19128.066 -1927.4476  89.9%     -  539s
     0     0 -1927.8119    0  555 -19128.066 -1927.8119  89.9%     -  540s
     0     0 -4282.2587    0  501 -19128.066 -4282.2587  77.6%     -  680s
     0     0 -4709.6067    0  503 -19128.066 -4709.6067  75.4%     -  735s
     0     0 -4814.4357    0  480 -19128.066 -4814.4357  74.8%     -  761s
     0     0 -4909.5097    0  492 -19128.066 -4909.5097  74.3%     -  785s
     0     0 -5056.4239    0  562 -19128.066 -5056.4239  73.6%     -  808s
     0     0 -5124.3817    0  497 -19128.066 -5124.3817  73.2%     -  826s
H    0     0                    -19054.86582 -5151.5355  73.0%     -  835s
H    0     0                    -18931.39698 -5151.5355  72.8%     -  835s
     0     0 -5151.5355    0  485 -18931.397 -5151.5355  72.8%     -  835s
H    0     0                    -18916.46602 -5212.3451  72.4%     -  849s
     0     0 -5212.3451    0  566 -18916.466 -5212.3451  72.4%     -  849s
     0     0 -5227.0385    0  578 -18916.466 -5227.0385  72.4%     -  856s
     0     0 -5241.2952    0  561 -18916.466 -5241.2952  72.3%     -  864s
     0     0 -5243.0443    0  563 -18916.466 -5243.0443  72.3%     -  869s
     0     0 -6450.0029    0  498 -18916.466 -6450.0029  65.9%     -  946s
H    0     0                    -18914.64809 -6450.1006  65.9%     -  947s
     0     0 -6801.7244    0  523 -18914.648 -6801.7244  64.0%     -  994s
     0     0 -6924.8351    0  523 -18914.648 -6924.8351  63.4%     - 1025s
H    0     0                    -18883.19040 -6977.2417  63.1%     - 1053s
H    0     0                    -18867.84123 -6977.2417  63.0%     - 1053s
H    0     0                    -18842.77090 -6977.2417  63.0%     - 1053s
     0     0 -6977.2417    0  587 -18842.771 -6977.2417  63.0%     - 1053s
     0     0 -6997.4418    0  521 -18842.771 -6997.4418  62.9%     - 1074s
     0     0 -7022.1413    0  513 -18842.771 -7022.1413  62.7%     - 1093s
     0     0 -7035.4355    0  514 -18842.771 -7035.4355  62.7%     - 1107s
     0     0 -7050.7936    0  512 -18842.771 -7050.7936  62.6%     - 1123s
     0     0 -7060.6640    0  524 -18842.771 -7060.6640  62.5%     - 1136s
     0     0 -7069.3249    0  519 -18842.771 -7069.3249  62.5%     - 1144s
     0     0 -7072.5041    0  519 -18842.771 -7072.5041  62.5%     - 1150s
     0     0 -7073.4311    0  521 -18842.771 -7073.4311  62.5%     - 1153s
     0     0 -7540.6169    0  581 -18842.771 -7540.6169  60.0%     - 1231s
     0     0 -7657.7442    0  591 -18842.771 -7657.7442  59.4%     - 1270s
H    0     0                    -18819.10868 -7746.2358  58.8%     - 1295s
     0     0 -7746.2358    0  496 -18819.109 -7746.2358  58.8%     - 1295s
     0     0 -7777.4210    0  498 -18819.109 -7777.4210  58.7%     - 1313s
     0     0 -7788.3649    0  513 -18819.109 -7788.3649  58.6%     - 1325s
     0     0 -7793.2004    0  510 -18819.109 -7793.2004  58.6%     - 1333s
     0     0 -7810.1567    0  505 -18819.109 -7810.1567  58.5%     - 1348s
     0     0 -7820.6714    0  570 -18819.109 -7820.6714  58.4%     - 1358s
     0     0 -7823.8155    0  576 -18819.109 -7823.8155  58.4%     - 1362s
     0     0 -7924.2038    0  470 -18819.109 -7924.2038  57.9%     - 1385s
     0     0 -7962.3596    0  560 -18819.109 -7962.3596  57.7%     - 1405s
     0     0 -7973.1500    0  497 -18819.109 -7973.1500  57.6%     - 1414s
     0     0 -7976.6509    0  493 -18819.109 -7976.6509  57.6%     - 1420s
     0     0 -7998.3584    0  495 -18819.109 -7998.3584  57.5%     - 1432s
     0     0 -8008.5587    0  491 -18819.109 -8008.5587  57.4%     - 1442s
     0     0 -8014.1263    0  493 -18819.109 -8014.1263  57.4%     - 1449s
     0     0 -8015.7501    0  489 -18819.109 -8015.7501  57.4%     - 1453s
     0     0 -8103.0243    0  561 -18819.109 -8103.0243  56.9%     - 1484s
     0     0 -8133.4702    0  503 -18819.109 -8133.4702  56.8%     - 1506s
     0     0 -8143.7746    0  518 -18819.109 -8143.7746  56.7%     - 1517s
     0     0 -8147.5827    0  518 -18819.109 -8147.5827  56.7%     - 1525s
     0     0 -8150.1235    0  511 -18819.109 -8150.1235  56.7%     - 1530s
     0     0 -8193.4569    0  508 -18819.109 -8193.4569  56.5%     - 1552s
     0     0 -8203.0408    0  510 -18819.109 -8203.0408  56.4%     - 1567s
     0     0 -8208.5766    0  512 -18819.109 -8208.5766  56.4%     - 1576s
     0     0 -8213.3071    0  521 -18819.109 -8213.3071  56.4%     - 1584s
     0     0 -8217.6275    0  522 -18819.109 -8217.6275  56.3%     - 1591s
     0     0 -8219.0826    0  527 -18819.109 -8219.0826  56.3%     - 1594s
     0     0 -8243.7578    0  516 -18819.109 -8243.7578  56.2%     - 1613s
     0     0 -8248.2594    0  516 -18819.109 -8248.2594  56.2%     - 1621s
     0     0 -8249.2871    0  519 -18819.109 -8249.2871  56.2%     - 1623s
     0     0 -8263.3724    0  521 -18819.109 -8263.3724  56.1%     - 1636s
     0     0 -8267.1891    0  521 -18819.109 -8267.1891  56.1%     - 1643s
     0     0 -8268.5333    0  524 -18819.109 -8268.5333  56.1%     - 1646s
     0     0 -8281.3684    0  525 -18819.109 -8281.3684  56.0%     - 1663s
     0     0 -8281.3785    0  525 -18819.109 -8281.3785  56.0%     - 1673s
H    0     0                    -18652.21605 -8281.4169  55.6%     - 1731s
H    0     0                    -18621.63444 -8281.4169  55.5%     - 1731s
H    0     0                    -16370.22610 -8281.4169  49.4%     - 1796s
H    0     0                    -16360.87152 -8281.4169  49.4%     - 1798s
H    0     0                    -16354.87694 -8281.4169  49.4%     - 1798s
H    0     0                    -16331.73415 -8281.4169  49.3%     - 1798s
     0     2 -8281.4169    0  525 -16331.734 -8281.4169  49.3%     - 1800s
     1     3 -8537.5553    1  472 -16331.734 -8281.4595  49.3% 10677 1825s
     2     4 -8414.1445    1  519 -16331.734 -8414.1445  48.5% 10100 1846s
     3     5 -9033.4496    2  491 -16331.734 -8414.1639  48.5% 11023 1870s
     4     9 -8573.8305    2  516 -16331.734 -8415.0655  48.5% 10973 1898s
     8    17 -8652.2362    3  512 -16331.734 -8573.9403  47.5% 10360 1954s
    16    32 -10069.124    4  500 -16331.734 -8573.9403  47.5%  9830 2010s
    31    47 -9826.6443    6  392 -16331.734 -8652.3513  47.0% 17378 2202s
H   46    76                    -16267.23129 -9124.1705  43.9% 17362 2275s
H   47    76                    -16246.68913 -9124.1705  43.8% 17266 2275s
H   56    76                    -16235.44932 -9124.1705  43.8% 16292 2275s
H   60    76                    -16230.13021 -9124.1705  43.8% 15709 2275s
H   61    76                    -16156.56533 -9124.1705  43.5% 15768 2275s
    75   186 -11026.197    8  342 -16156.565 -9124.1705  43.5% 14328 2349s
   189   212 infeasible   12      -16156.565 -9124.1705  43.5%  8292 2383s
H  199   212                    -16111.05750 -9124.1705  43.4%  8065 2383s
H  200   212                    -16069.84759 -9124.1705  43.2%  8035 2383s
   220   253 -11614.576   13  395 -16069.848 -9124.1705  43.2%  7720 2421s
H  222   253                    -16004.22875 -9124.1705  43.0%  7689 2421s
H  230   253                    -15960.82466 -9124.1705  42.8%  7627 2421s
   284   262 -11900.897    9  269 -15960.825 -9124.1705  42.8%  6846 2459s
   319   274 -12087.765   10  244 -15960.825 -9124.1705  42.8%  6615 2503s
H  326   274                    -15954.97379 -9124.1705  42.8%  6558 2503s
H  337   274                    -15786.76207 -9124.1705  42.2%  6483 2503s
H  355   274                    -15739.30602 -9124.1705  42.0%  6434 2503s
   359   276 -12995.093   12  306 -15739.306 -9124.1705  42.0%  6444 2544s
   417   285 -11194.259   11  332 -15739.306 -9124.1705  42.0%  5988 2587s
H  418   285                    -15732.17799 -9124.1705  42.0%  5974 2587s
H  421   285                    -15725.15115 -9124.1705  42.0%  5975 2587s
   469   288 -12110.028   11  252 -15725.151 -9124.1705  42.0%  5800 2627s
   503   294 -12782.197   12  298 -15725.151 -9124.1705  42.0%  5805 2664s
   546   304 -12831.991   13  282 -15725.151 -9124.1705  42.0%  5724 2699s
   590   316 -13009.498   14  285 -15725.151 -9124.1705  42.0%  5611 2735s
   634   330 -13336.468   15  285 -15725.151 -9124.1705  42.0%  5485 2771s
   683   347 -13369.899   16  357 -15725.151 -9124.1705  42.0%  5347 2810s
   735   354 -14179.407   18  333 -15725.151 -9124.1705  42.0%  5270 2846s
   810   382 -15451.117   20  182 -15725.151 -9124.1705  42.0%  5087 2885s
   876   427 -15616.404   22  153 -15725.151 -9124.1705  42.0%  4933 2924s
   969   442 -10955.775   13  522 -15725.151 -9124.1705  42.0%  4673 2959s
H 1042   442                    -15666.28752 -9124.1705  41.8%  4447 2959s
  1058   440 -10956.658   14  520 -15666.288 -9124.1705  41.8%  4432 2999s
  1152   447 -12213.052   12  363 -15666.288 -9124.1705  41.8%  4272 3045s
H 1183   465                    -15659.41164 -9124.1705  41.7%  4288 3092s
H 1184   465                    -15656.89824 -9124.1705  41.7%  4289 3092s
  1221   483 -12504.424   14  370 -15656.898 -9124.1705  41.7%  4311 3136s
H 1255   508                    -15650.02237 -9124.1705  41.7%  4367 3183s
  1300   543     cutoff   17      -15650.022 -9124.1705  41.7%  4422 3229s
  1389   566     cutoff   17      -15650.022 -9124.1705  41.7%  4401 3282s
  1458   605 -11769.679   21  623 -15650.022 -9124.1705  41.7%  4427 3331s
  1525   629 -11787.321   22  555 -15650.022 -9124.1705  41.7%  4437 3373s
H 1528   629                    -15633.48128 -9124.1705  41.6%  4431 3373s
H 1545   629                    -15567.59126 -9549.3107  38.7%  4445 3373s
  1561   701 -11799.478   23  609 -15567.591 -9549.3107  38.7%  4476 3427s
H 1677   750                    -15560.13054 -9549.3107  38.6%  4424 3485s
H 1722   750                    -15558.40597 -9549.3107  38.6%  4383 3485s
  1760   807 -12005.981   31  547 -15558.406 -9549.3107  38.6%  4392 3551s
  1889   829 -12077.029   32  538 -15558.406 -9549.3107  38.6%  4295 3600s

Cutting planes:
  Learned: 3
  Gomory: 5
  Implied bound: 426
  MIR: 4166
  Flow cover: 3422
  RLT: 215
  Relax-and-lift: 1468

Explored 1963 nodes (9261618 simplex iterations) in 3600.09 seconds (4996.19 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15558.4 -15560.1 -15567.6 ... -15732.2

Time limit reached
Best objective -1.555840597389e+04, best bound -9.549310732567e+03, gap 38.6228%
  WARNING: Time limit reached. Using best solution found (gap: 38.62%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -15558.41, θ = 102128.38
  Upper Bound (UB) = -15558.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102128.38
  [DEBUG]   ✓ Scenario 0: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 102128.38 ≤ Q = 102128.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102128.38 ≤ Q = 102128.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 102128.38 ≤ Q = 102128.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2196474c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde69b8b4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.250937e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6452510.6334
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.371910e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137190.98    0  126 6452510.63 -137190.98   102%     -    0s
H    0     0                    -99867.99407 -137190.98  37.4%     -    0s
H    0     0                    -100224.9216 -137190.98  36.9%     -    0s
H    0     0                    -108523.7182 -110252.77  1.59%     -    0s
     0     0 -110252.77    0   65 -108523.72 -110252.77  1.59%     -    0s
H    0     0                    -108807.6586 -110173.08  1.25%     -    0s
H    0     0                    -109039.1454 -110173.08  1.04%     -    0s
     0     0 -109692.90    0   66 -109039.15 -109692.90  0.60%     -    0s
     0     0 -109572.68    0   63 -109039.15 -109572.68  0.49%     -    0s
     0     0 -109467.26    0   41 -109039.15 -109467.26  0.39%     -    0s
H    0     0                    -109067.9290 -109434.44  0.34%     -    0s
     0     0 -109432.40    0   50 -109067.93 -109432.40  0.33%     -    0s
     0     0 -109423.64    0   40 -109067.93 -109423.64  0.33%     -    0s
     0     0 -109309.57    0   37 -109067.93 -109309.57  0.22%     -    0s
     0     0 -109302.98    0   26 -109067.93 -109302.98  0.22%     -    0s
     0     0 -109302.06    0   59 -109067.93 -109302.06  0.21%     -    0s
     0     0 -109302.06    0   42 -109067.93 -109302.06  0.21%     -    0s
H    0     0                    -109072.9942 -109302.06  0.21%     -    0s
     0     0 -109283.62    0   28 -109072.99 -109283.62  0.19%     -    0s
     0     0 -109260.52    0   17 -109072.99 -109260.52  0.17%     -    0s
     0     0 -109256.46    0   16 -109072.99 -109256.46  0.17%     -    0s
     0     0 -109218.84    0   11 -109072.99 -109218.84  0.13%     -    0s
     0     0 -109184.16    0   10 -109072.99 -109184.16  0.10%     -    0s
     0     0 -109102.45    0    5 -109072.99 -109102.45  0.03%     -    0s
     0     0 -109097.80    0    4 -109072.99 -109097.80  0.02%     -    0s
H    0     0                    -109077.5655 -109097.80  0.02%     -    0s
H    0     0                    -109091.5044 -109097.80  0.01%     -    0s

Explored 1 nodes (997 simplex iterations) in 0.24 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -109092 -109078 -109073 ... 6.45251e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.090915043600e+05, best bound -1.090977980134e+05, gap 0.0058%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 96886.46
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109091.50
  [DEBUG]   S×d_nominal = 205977.96
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205977.96 + -109091.50 = 96886.46
  [DEBUG]   Current θ from Master = 102128.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5241.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20800.33
  Lower Bound (LB) = -17958.48
  Gap (UB-LB) = 2400.0723, Absolute Gap = 2400.0723, Relative Gap = 0.154262
  Not converged yet (gap = 2400.07 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567795 nonzeros
Model fingerprint: 0x0beb3eba
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82719 rows and 33579 columns
Presolve time: 3.25s
Presolved: 117434 rows, 49801 columns, 704633 nonzeros
Variable types: 47542 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -408965.0217
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 683
 AA' NZ     : 4.019e+06
 Factor NZ  : 1.025e+07 (roughly 150 MB of memory)
 Factor Ops : 2.339e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55386257e+07  1.99783557e+08  8.09e+04 2.12e+01  6.66e+04     5s
   1  -1.16045285e+07  1.72639475e+08  5.58e+04 5.19e+01  4.59e+04     5s
   2  -4.42669835e+06  1.34198845e+08  2.09e+04 6.54e-01  1.82e+04     6s
   3  -8.88980005e+05  9.90971152e+07  1.94e+03 2.05e-01  2.05e+03     6s
   4  -5.32772343e+05  6.87581546e+07  4.04e+02 1.06e-01  6.33e+02     6s
   5  -4.68897037e+05  4.25071264e+07  2.27e+02 2.99e-01  3.57e+02     6s
   6  -3.96257247e+05  2.78086549e+07  9.47e+01 3.30e-02  1.90e+02     6s
   7  -2.95797134e+05  1.99339315e+07  2.04e+01 2.20e-02  1.05e+02     6s
   8  -2.27948640e+05  1.63384805e+07  5.54e+00 1.78e-02  7.97e+01     6s
   9  -1.25715127e+05  5.30548663e+06  1.18e+00 5.10e-03  2.55e+01     6s
  10  -8.86944782e+04  2.95514475e+06  5.27e-01 2.77e-03  1.42e+01     6s
  11  -7.45509350e+04  1.91157330e+06  3.82e-01 1.78e-03  9.28e+00     6s
  12  -6.10892174e+04  1.17016639e+06  2.75e-01 1.07e-03  5.75e+00     7s
  13  -4.23110156e+04  4.98954422e+05  1.52e-01 4.49e-04  2.52e+00     7s
  14  -2.64962981e+04  2.02084600e+05  6.55e-02 2.09e-04  1.07e+00     7s
  15  -2.01120826e+04  1.27855769e+05  4.92e-02 3.22e-04  6.89e-01     7s
  16  -1.54543521e+04  7.87470117e+04  3.86e-02 4.18e-04  4.39e-01     7s
  17  -1.12241000e+04  6.06192697e+04  3.02e-02 5.06e-04  3.35e-01     7s
  18  -6.72101018e+03  5.08631995e+04  2.10e-02 9.91e-04  2.68e-01     7s
  19  -3.68040696e+03  3.45924422e+04  1.63e-02 1.30e-03  1.78e-01     7s
  20  -1.01424961e+03  2.73856597e+04  1.29e-02 8.62e-04  1.32e-01     7s
  21   6.31773366e+02  2.19377751e+04  1.08e-02 6.34e-04  9.92e-02     7s
  22   2.31242563e+03  1.99137009e+04  8.85e-03 5.20e-04  8.20e-02     8s
  23   3.20987977e+03  1.75932215e+04  7.83e-03 4.03e-04  6.70e-02     8s
  24   3.82601719e+03  1.68288094e+04  7.13e-03 3.92e-04  6.06e-02     8s
  25   5.23975104e+03  1.56547468e+04  5.56e-03 3.31e-04  4.85e-02     8s
  26   5.54828400e+03  1.46005950e+04  5.21e-03 2.48e-04  4.22e-02     8s
  27   6.21347156e+03  1.37935840e+04  4.47e-03 2.01e-04  3.53e-02     8s
  28   7.29325728e+03  1.32933454e+04  3.28e-03 1.69e-04  2.79e-02     8s
  29   7.65113024e+03  1.25316308e+04  2.87e-03 1.23e-04  2.27e-02     9s
  30   7.89072802e+03  1.21362032e+04  2.59e-03 1.00e-04  1.98e-02     9s
  31   8.12297085e+03  1.18112806e+04  2.30e-03 8.18e-05  1.72e-02     9s
  32   8.58197993e+03  1.16383782e+04  1.83e-03 7.22e-05  1.42e-02     9s
  33   9.12586994e+03  1.14559808e+04  1.26e-03 6.16e-05  1.09e-02     9s
  34   9.26177719e+03  1.12845437e+04  1.12e-03 5.23e-05  9.42e-03     9s
  35   9.49666665e+03  1.11333934e+04  8.69e-04 4.34e-05  7.62e-03    10s
  36   9.59439914e+03  1.10349569e+04  7.62e-04 3.76e-05  6.71e-03    10s
  37   9.70523167e+03  1.08343873e+04  6.43e-04 2.64e-05  5.26e-03    10s
  38   9.86652364e+03  1.07309546e+04  4.76e-04 2.08e-05  4.03e-03    10s
  39   9.97260652e+03  1.06895458e+04  3.71e-04 1.85e-05  3.34e-03    10s
  40   1.00004392e+04  1.06241895e+04  3.46e-04 1.47e-05  2.91e-03    10s
  41   1.01596503e+04  1.04936073e+04  1.93e-04 7.10e-06  1.56e-03    11s
  42   1.02290322e+04  1.04365221e+04  1.28e-04 7.31e-06  9.66e-04    11s
  43   1.02405531e+04  1.04304281e+04  1.18e-04 6.61e-06  8.84e-04    11s
  44   1.02798762e+04  1.04189999e+04  8.17e-05 5.22e-06  6.48e-04    11s
  45   1.03195324e+04  1.03860446e+04  4.48e-05 1.30e-06  3.10e-04    11s
  46   1.03461495e+04  1.03770295e+04  2.13e-05 2.83e-06  1.44e-04    11s
  47   1.03571384e+04  1.03747516e+04  1.24e-05 8.13e-07  8.20e-05    11s
  48   1.03644488e+04  1.03740769e+04  6.62e-06 4.18e-07  4.48e-05    11s
  49   1.03680989e+04  1.03737930e+04  3.80e-06 2.37e-07  2.65e-05    12s
  50   1.03730543e+04  1.03733191e+04  1.45e-07 6.32e-09  1.23e-06    12s
  51   1.03732789e+04  1.03732825e+04  4.47e-09 2.80e-10  1.71e-08    12s
  52   1.03732821e+04  1.03732821e+04  8.14e-09 3.39e-11  1.23e-10    12s

Barrier solved model in 52 iterations and 11.89 seconds (10.89 work units)
Optimal objective 1.03732821e+04


Root crossover log...

   95850 DPushes remaining with DInf 0.0000000e+00                12s
    6169 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    4454 PPushes remaining with PInf 1.3572287e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.2279034e-11     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42927    1.0373282e+04   0.000000e+00   0.000000e+00     16s
   42927    1.0373282e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.037328e+04, 42927 iterations, 12.18 seconds (13.93 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10373.2821    0  407 -211403.45 10373.2821   105%     -   17s
H    0     0                    -210003.7552 10373.2821   105%     -   17s
H    0     0                    -134351.6678 10373.2821   108%     -   18s
H    0     0                    -83137.71371 10373.2821   112%     -   18s
H    0     0                    -51317.20786 10373.2821   120%     -   18s
H    0     0                    -47285.17515 10373.2821   122%     -   19s
H    0     0                    -46497.03019 10373.2821   122%     -   19s
H    0     0                    -36943.63685 10373.2821   128%     -   21s
H    0     0                    -34527.03073 10373.2821   130%     -   21s
H    0     0                    -31426.37599 10373.2821   133%     -   21s
H    0     0                    -31419.50012 10373.2821   133%     -   21s
H    0     0                    -25223.02710 4615.93344   118%     -   57s
H    0     0                    -21858.29344 4615.93344   121%     -   57s
H    0     0                    -21732.52915 4615.93344   121%     -   57s
     0     0 4615.93344    0  560 -21732.529 4615.93344   121%     -   57s
H    0     0                    -19704.44303 4615.47421   123%     -   58s
H    0     0                    -19452.93641 4615.47421   124%     -   58s
H    0     0                    -19429.92733 4615.47421   124%     -   58s
H    0     0                    -19418.20681 4615.47421   124%     -   58s
     0     0 4250.09225    0  594 -19418.207 4250.09225   122%     -   70s
     0     0 3788.29873    0  574 -19418.207 3788.29873   120%     -   78s
     0     0 3732.55697    0  586 -19418.207 3732.55697   119%     -   84s
     0     0 3629.06957    0  583 -19418.207 3629.06957   119%     -   87s
     0     0 3599.53258    0  583 -19418.207 3599.53258   119%     -   90s
     0     0 3591.73242    0  584 -19418.207 3591.73242   118%     -   92s
     0     0 3567.11422    0  583 -19418.207 3567.11422   118%     -   94s
     0     0 3548.99068    0  574 -19418.207 3548.99068   118%     -   97s
     0     0 3548.26841    0  573 -19418.207 3548.26841   118%     -   99s
     0     0 1288.58899    0  519 -19418.207 1288.58899   107%     -  154s
H    0     0                    -19160.38650 1288.55833   107%     -  156s
H    0     0                    -19127.36645 1288.55833   107%     -  156s
H    0     0                    -18979.60563 1288.55833   107%     -  156s
H    0     0                    -18946.58558 1288.55833   107%     -  156s
H    0     0                    -18941.61599 1288.55833   107%     -  156s
H    0     0                    -18914.62571 1288.55833   107%     -  156s
H    0     0                    -18909.65612 1288.55833   107%     -  156s
     0     0  670.47887    0  566 -18909.656  670.47887   104%     -  202s
     0     0  439.24847    0  560 -18909.656  439.24847   102%     -  232s
     0     0  383.15562    0  635 -18909.656  383.15562   102%     -  250s
     0     0  352.18175    0  567 -18909.656  352.18175   102%     -  266s
     0     0  345.20236    0  578 -18909.656  345.20236   102%     -  273s
     0     0  340.36503    0  567 -18909.656  340.36503   102%     -  280s
     0     0  332.65037    0  578 -18909.656  332.65037   102%     -  289s
     0     0  293.07055    0  572 -18909.656  293.07055   102%     -  303s
     0     0  224.91649    0  546 -18909.656  224.91649   101%     -  323s
     0     0  221.08831    0  555 -18909.656  221.08831   101%     -  328s
     0     0  209.32803    0  553 -18909.656  209.32803   101%     -  334s
     0     0  207.45032    0  555 -18909.656  207.45032   101%     -  335s
     0     0  206.95516    0  556 -18909.656  206.95516   101%     -  337s
     0     0 -3062.4503    0  487 -18909.656 -3062.4503  83.8%     -  474s
     0     0 -4247.3302    0  498 -18909.656 -4247.3302  77.5%     -  567s
     0     0 -4531.2229    0  515 -18909.656 -4531.2229  76.0%     -  618s
     0     0 -4645.8063    0  506 -18909.656 -4645.8063  75.4%     -  657s
     0     0 -4710.0343    0  490 -18909.656 -4710.0343  75.1%     -  682s
     0     0 -4721.0958    0  490 -18909.656 -4721.0958  75.0%     -  695s
     0     0 -4733.9569    0  484 -18909.656 -4733.9569  75.0%     -  709s
     0     0 -4753.7834    0  487 -18909.656 -4753.7834  74.9%     -  726s
     0     0 -4759.1298    0  482 -18909.656 -4759.1298  74.8%     -  740s
     0     0 -4764.9924    0  494 -18909.656 -4764.9924  74.8%     -  756s
     0     0 -4774.6699    0  488 -18909.656 -4774.6699  74.8%     -  768s
     0     0 -4847.3094    0  487 -18909.656 -4847.3094  74.4%     -  796s
     0     0 -4868.0485    0  491 -18909.656 -4868.0485  74.3%     -  805s
     0     0 -4870.8244    0  493 -18909.656 -4870.8244  74.2%     -  810s
     0     0 -4871.6413    0  491 -18909.656 -4871.6413  74.2%     -  813s
     0     0 -5888.8899    0  518 -18909.656 -5888.8899  68.9%     -  993s
H    0     0                    -18646.66397 -6159.8549  67.0%     - 1049s
     0     0 -6159.8549    0  505 -18646.664 -6159.8549  67.0%     - 1049s
H    0     0                    -18625.13681 -6525.1978  65.0%     - 1128s
H    0     0                    -18621.63444 -6525.1978  65.0%     - 1128s
     0     0 -6525.1978    0  588 -18621.634 -6525.1978  65.0%     - 1128s
     0     0 -6695.2078    0  500 -18621.634 -6695.2078  64.0%     - 1180s
     0     0 -6815.9545    0  584 -18621.634 -6815.9545  63.4%     - 1217s
     0     0 -6841.0820    0  515 -18621.634 -6841.0820  63.3%     - 1232s
     0     0 -6868.1399    0  673 -18621.634 -6868.1399  63.1%     - 1252s
     0     0 -6892.2683    0  656 -18621.634 -6892.2683  63.0%     - 1267s
     0     0 -6899.2417    0  662 -18621.634 -6899.2417  63.0%     - 1275s
     0     0 -6901.2303    0  611 -18621.634 -6901.2303  62.9%     - 1279s
     0     0 -7294.0032    0  487 -18621.634 -7294.0032  60.8%     - 1329s
     0     0 -7427.0938    0  505 -18621.634 -7427.0938  60.1%     - 1366s
     0     0 -7451.2032    0  519 -18621.634 -7451.2032  60.0%     - 1388s
     0     0 -7487.9374    0  510 -18621.634 -7487.9374  59.8%     - 1423s
     0     0 -7540.8664    0  498 -18621.634 -7540.8664  59.5%     - 1447s
     0     0 -7547.6569    0  516 -18621.634 -7547.6569  59.5%     - 1461s
     0     0 -7550.2578    0  506 -18621.634 -7550.2578  59.5%     - 1471s
     0     0 -7754.2594    0  590 -18621.634 -7754.2594  58.4%     - 1539s
     0     0 -7800.6039    0  670 -18621.634 -7800.6039  58.1%     - 1601s
     0     0 -7812.4431    0  685 -18621.634 -7812.4431  58.0%     - 1626s
     0     0 -7851.8713    0  742 -18621.634 -7851.8713  57.8%     - 1657s
     0     0 -7885.9716    0  741 -18621.634 -7885.9716  57.7%     - 1704s
     0     0 -7897.1253    0  726 -18621.634 -7897.1253  57.6%     - 1719s
     0     0 -7899.8294    0  733 -18621.634 -7899.8294  57.6%     - 1730s
     0     0 -8042.9946    0  778 -18621.634 -8042.9946  56.8%     - 1800s
     0     0 -8085.0941    0  674 -18621.634 -8085.0941  56.6%     - 1836s
     0     0 -8105.8400    0  584 -18621.634 -8105.8400  56.5%     - 1864s
     0     0 -8110.5746    0  733 -18621.634 -8110.5746  56.4%     - 1877s
     0     0 -8112.1886    0  732 -18621.634 -8112.1886  56.4%     - 1882s
     0     0 -8167.7904    0  591 -18621.634 -8167.7904  56.1%     - 1914s
     0     0 -8180.9649    0  585 -18621.634 -8180.9649  56.1%     - 1929s
     0     0 -8192.3281    0  595 -18621.634 -8192.3281  56.0%     - 1941s
     0     0 -8195.1137    0  600 -18621.634 -8195.1137  56.0%     - 1948s
     0     0 -8221.9591    0  601 -18621.634 -8221.9591  55.8%     - 1971s
     0     0 -8228.5659    0  596 -18621.634 -8228.5659  55.8%     - 1984s
     0     0 -8229.8073    0  599 -18621.634 -8229.8073  55.8%     - 1988s
     0     0 -8271.7207    0  622 -18621.634 -8271.7207  55.6%     - 2016s
     0     0 -8286.4489    0  618 -18621.634 -8286.4489  55.5%     - 2045s
     0     0 -8289.8635    0  604 -18621.634 -8289.8635  55.5%     - 2060s
     0     0 -8291.7835    0  525 -18621.634 -8291.7835  55.5%     - 2064s
     0     0 -8300.0048    0  581 -18621.634 -8300.0048  55.4%     - 2081s
     0     0 -8305.4868    0  534 -18621.634 -8305.4868  55.4%     - 2090s
     0     0 -8307.2981    0  534 -18621.634 -8307.2981  55.4%     - 2095s
     0     0 -8315.7709    0  615 -18621.634 -8315.7709  55.3%     - 2113s
     0     0 -8315.8387    0  615 -18621.634 -8315.8387  55.3%     - 2125s
H    0     0                    -17825.35857 -8315.8387  53.3%     - 2258s
H    0     0                    -17566.47556 -8315.8387  52.7%     - 2258s
H    0     0                    -17528.19325 -8315.8387  52.6%     - 2262s
H    0     0                    -17094.06800 -8315.8387  51.4%     - 2262s
H    0     0                    -16644.87135 -8315.8387  50.0%     - 2262s
H    0     0                    -16511.45725 -8315.8387  49.6%     - 2262s
H    0     0                    -16235.41475 -8315.8387  48.8%     - 2263s
H    0     0                    -16226.73509 -8315.8387  48.8%     - 2263s
H    0     0                    -16179.54629 -8315.8387  48.6%     - 2263s
H    0     0                    -16174.98711 -8315.8387  48.6%     - 2263s
H    0     0                    -16172.45223 -8315.8387  48.6%     - 2263s
H    0     0                    -16019.82778 -8315.8387  48.1%     - 2326s
H    0     0                    -15747.53408 -8315.8387  47.2%     - 2335s
H    0     0                    -15730.96177 -8315.8387  47.1%     - 2340s
H    0     0                    -15718.04472 -8315.8387  47.1%     - 2340s
H    0     0                    -15669.25397 -8315.8387  46.9%     - 2340s
H    0     0                    -15660.25776 -8315.8387  46.9%     - 2340s
H    0     0                    -15654.23697 -8315.8387  46.9%     - 2340s
     0     2 -8315.8387    0  615 -15654.237 -8315.8387  46.9%     - 2342s
     1     3 -8737.9423    1  526 -15654.237 -8315.8387  46.9% 13743 2383s
     2     4 -8363.8054    1  618 -15654.237 -8363.8054  46.6%  8526 2402s
     3     6 -8399.5212    2  606 -15654.237 -8363.8618  46.6%  8336 2434s
     5    10 -11200.323    3  364 -15654.237 -8363.8618  46.6% 10857 2467s
     9    18 -11295.504    4  360 -15654.237 -8399.5221  46.3%  8571 2517s
    17    26 -11288.031    5  384 -15654.237 -8543.9780  45.4%  9340 2578s
    25    49 -9827.6216    4  394 -15654.237 -8543.9780  45.4% 11001 2808s
    48    79 -10159.046    5  395 -15654.237 -8543.9780  45.4% 38424 2986s
H   51    79                    -15648.50381 -8543.9780  45.4% 36764 2986s
H   61    79                    -15645.46886 -8543.9780  45.4% 32165 2987s
    80   185 -10194.750    6  387 -15645.469 -8543.9780  45.4% 26395 3097s
H  194   240                    -15645.45568 -8543.9780  45.4% 14398 3149s
   259   275 -10357.570    8  383 -15645.456 -8543.9780  45.4% 12046 3199s
   316   311 -11534.914    9  332 -15645.456 -8543.9780  45.4% 10830 3245s
   369   368 -14410.924   10  175 -15645.456 -8543.9780  45.4%  9966 3293s
   445   411 -14443.363   11  176 -15645.456 -8543.9780  45.4%  8873 3331s
H  512   411                    -15587.65722 -8543.9780  45.2%  8117 3331s
   535   450 -14549.633   13  163 -15587.657 -8543.9780  45.2%  7890 3372s
   626   457 -15027.674   16  166 -15587.657 -8543.9780  45.2%  7077 3408s
   669   471 -15325.674   19  166 -15587.657 -8543.9780  45.2%  6772 3442s
H  672   471                    -15585.53953 -8543.9780  45.2%  6756 3442s
   703   481 -15376.930   19  167 -15585.540 -8543.9780  45.2%  6664 3477s
   739   507 -15357.135   20  150 -15585.540 -8543.9780  45.2%  6540 3513s
   777   537 infeasible   22      -15585.540 -8543.9780  45.2%  6405 3545s
H  821   537                    -15579.77791 -8543.9780  45.2%  6198 3545s
   827   581 -12801.296   21  215 -15579.778 -8543.9780  45.2%  6184 3577s
H  828   581                    -15572.68386 -8543.9780  45.1%  6177 3577s
H  834   581                    -15570.84848 -8543.9780  45.1%  6156 3577s
   919   636 -14197.186   22  204 -15570.848 -8543.9780  45.1%  5754 3600s

Cutting planes:
  Gomory: 5
  Implied bound: 276
  MIR: 4149
  Flow cover: 3377
  Zero half: 1
  RLT: 246
  Relax-and-lift: 1344

Explored 1022 nodes (6489388 simplex iterations) in 3600.13 seconds (4743.79 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15570.8 -15572.7 -15579.8 ... -15669.3

Time limit reached
Best objective -1.557084848264e+04, best bound -8.543978018415e+03, gap 45.1284%
  WARNING: Time limit reached. Using best solution found (gap: 45.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = -15570.85, θ = 102570.02
  Upper Bound (UB) = -15570.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102570.02
  [DEBUG]   ✓ Scenario 0: θ = 102570.02 ≤ Q = 102570.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102570.02 ≤ Q = 102570.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102570.02 ≤ Q = 102570.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102570.02 ≤ Q = 102570.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102570.02 ≤ Q = 102570.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 102570.02 ≤ Q = 102570.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x624445bd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9dbbba43
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.252509e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6448447.6737
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.367950e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136795.02    0  126 6448447.67 -136795.02   102%     -    0s
H    0     0                    -99432.39288 -136795.02  37.6%     -    0s
H    0     0                    -99872.82182 -136795.02  37.0%     -    0s
     0     0 -106418.91    0   68 -99872.822 -106418.91  6.55%     -    0s
H    0     0                    -103830.8801 -106339.91  2.42%     -    0s
H    0     0                    -104116.5318 -106339.91  2.14%     -    0s
H    0     0                    -104758.6828 -106339.91  1.51%     -    0s
H    0     0                    -105044.3345 -106339.91  1.23%     -    0s
     0     0 -106128.31    0   71 -105044.33 -106128.31  1.03%     -    0s
     0     0 -106068.09    0   71 -105044.33 -106068.09  0.97%     -    0s
     0     0 -105953.89    0   69 -105044.33 -105953.89  0.87%     -    0s
     0     0 -105952.36    0   69 -105044.33 -105952.36  0.86%     -    0s
H    0     0                    -105052.6904 -105952.04  0.86%     -    0s
H    0     0                    -105058.4412 -105952.04  0.85%     -    0s
     0     2 -105952.04    0   69 -105058.44 -105952.04  0.85%     -    0s
H   40    19                    -105142.9593 -105685.47  0.52%   8.4    0s
H   90    41                    -105402.6586 -105678.44  0.26%   5.9    0s
H  194    31                    -105552.9615 -105637.91  0.08%   4.2    0s
*  195    31              16    -105561.0825 -105637.91  0.07%   4.2    0s
*  242     3              18    -105568.5385 -105626.82  0.06%   4.2    0s
*  265     0              18    -105571.6482 -105586.31  0.01%   4.1    0s

Cutting planes:
  Gomory: 25
  Implied bound: 6
  MIR: 150

Explored 267 nodes (1597 simplex iterations) in 0.18 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -105572 -105569 -105561 ... -99872.8
No other solutions better than -105572

Optimal solution found (tolerance 1.00e-04)
Best objective -1.055716482280e+05, best bound -1.055716482280e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 100517.71
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105571.65
  [DEBUG]   S×d_nominal = 206089.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206089.36 + -105571.65 = 100517.71
  [DEBUG]   Current θ from Master = 102570.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2052.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17623.16
  Lower Bound (LB) = -17623.16
  Gap (UB-LB) = 2052.3102, Absolute Gap = 2052.3102, Relative Gap = 0.131805
  Not converged yet (gap = 2052.31 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611047 nonzeros
Model fingerprint: 0x2ba7ce0a
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89082 rows and 36162 columns
Presolve time: 4.03s
Presolved: 126361 rows, 53458 columns, 775123 nonzeros
Variable types: 51199 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407599.3033
Found heuristic solution: objective -382192.9609
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 719
 AA' NZ     : 5.045e+06
 Factor NZ  : 1.187e+07 (roughly 170 MB of memory)
 Factor Ops : 2.623e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55271963e+07  2.10004489e+08  8.26e+04 2.05e+01  6.61e+04     6s
   1  -1.15428915e+07  1.81101638e+08  5.72e+04 5.42e+01  4.59e+04     7s
   2  -4.82451870e+06  1.40317138e+08  2.29e+04 2.73e+01  1.89e+04     7s
   3  -9.91505363e+05  1.04836060e+08  1.90e+03 1.20e+00  1.97e+03     7s
   4  -6.20148855e+05  7.66835929e+07  4.48e+02 7.58e-01  6.74e+02     7s
   5  -5.47273366e+05  4.39320987e+07  2.46e+02 3.74e-01  3.59e+02     7s
   6  -4.64918453e+05  3.07370179e+07  9.22e+01 2.45e-01  1.92e+02     7s
   7  -3.72262268e+05  2.24307355e+07  1.57e+01 1.71e-01  1.07e+02     7s
   8  -2.68269097e+05  1.26102185e+07  7.60e-01 9.21e-02  5.61e+01     7s
   9  -1.45892251e+05  2.62359659e+06  1.48e-01 1.77e-02  1.20e+01     7s
  10  -1.13381164e+05  1.62356312e+06  9.35e-02 1.15e-02  7.53e+00     8s
  11  -9.39587848e+04  1.13215411e+06  6.56e-02 7.75e-03  5.31e+00     8s
  12  -7.45701365e+04  6.31527167e+05  4.33e-02 4.28e-03  3.06e+00     8s
  13  -4.63034357e+04  3.79921329e+05  1.77e-02 2.72e-03  1.85e+00     8s
  14  -3.20757884e+04  1.55346044e+05  1.04e-02 1.04e-03  8.12e-01     8s
  15  -2.42365031e+04  1.10575093e+05  7.41e-03 1.20e-03  5.84e-01     8s
  16  -1.57865671e+04  8.43618712e+04  4.66e-03 8.18e-04  4.34e-01     8s
  17  -1.02712509e+04  5.62431977e+04  3.06e-03 5.46e-04  2.88e-01     8s
  18  -6.58004658e+03  4.02727237e+04  2.23e-03 3.84e-04  2.03e-01     8s
  19  -3.71927966e+03  3.45289978e+04  1.68e-03 3.17e-04  1.66e-01     9s
  20  -9.85267663e+02  2.58074049e+04  1.18e-03 2.23e-04  1.16e-01     9s
  21   7.72623711e+02  1.77522671e+04  9.13e-04 1.48e-04  7.35e-02     9s
  22   2.21598057e+03  1.52491575e+04  7.06e-04 1.47e-04  5.64e-02     9s
  23   3.46237040e+03  1.29644055e+04  5.34e-04 1.05e-04  4.12e-02     9s
  24   4.70981676e+03  1.15668434e+04  3.69e-04 7.68e-05  2.97e-02     9s
  25   5.21344654e+03  1.03983797e+04  3.04e-04 5.27e-05  2.25e-02     9s
  26   5.79226800e+03  9.40945564e+03  2.23e-04 3.34e-05  1.57e-02    10s
  27   6.41171466e+03  8.74825817e+03  1.49e-04 2.01e-05  1.01e-02    10s
  28   6.67302932e+03  8.52678621e+03  1.19e-04 1.59e-05  8.03e-03    10s
  29   6.89539079e+03  8.26485351e+03  9.36e-05 1.02e-05  5.93e-03    10s
  30   7.09303494e+03  8.16099293e+03  7.12e-05 8.10e-06  4.63e-03    10s
  31   7.29862626e+03  8.10865087e+03  4.80e-05 7.01e-06  3.51e-03    10s
  32   7.33390176e+03  7.96445546e+03  4.42e-05 4.15e-06  2.73e-03    11s
  33   7.46367614e+03  7.90602659e+03  3.07e-05 2.99e-06  1.92e-03    11s
  34   7.48286011e+03  7.89480434e+03  2.86e-05 2.77e-06  1.78e-03    11s
  35   7.50549070e+03  7.85412039e+03  2.62e-05 1.96e-06  1.51e-03    11s
  36   7.55248694e+03  7.82348267e+03  2.12e-05 1.36e-06  1.17e-03    11s
  37   7.56720891e+03  7.80588561e+03  1.97e-05 1.01e-06  1.03e-03    11s
  38   7.58573678e+03  7.80142936e+03  1.78e-05 9.22e-07  9.34e-04    12s
  39   7.65781645e+03  7.79204026e+03  1.03e-05 7.33e-07  5.81e-04    12s
  40   7.69224078e+03  7.77635915e+03  6.55e-06 3.99e-07  3.64e-04    12s
  41   7.70675305e+03  7.77177181e+03  5.07e-06 3.11e-07  2.82e-04    12s
  42   7.71355995e+03  7.76586315e+03  4.37e-06 1.91e-07  2.27e-04    12s
  43   7.72946501e+03  7.76116346e+03  2.72e-06 9.51e-08  1.37e-04    12s
  44   7.73984432e+03  7.75815494e+03  1.63e-06 4.08e-08  7.93e-05    13s
  45   7.74441319e+03  7.75783532e+03  1.17e-06 4.37e-08  5.81e-05    13s
  46   7.75139422e+03  7.75702318e+03  4.36e-07 2.24e-08  2.44e-05    13s
  47   7.75526020e+03  7.75606604e+03  6.83e-08 4.52e-09  3.49e-06    13s
  48   7.75596087e+03  7.75599982e+03  4.49e-09 4.27e-10  1.69e-07    13s
  49   7.75599660e+03  7.75599667e+03  1.29e-09 2.88e-10  3.05e-10    13s

Barrier solved model in 49 iterations and 13.27 seconds (12.55 work units)
Optimal objective 7.75599660e+03


Root crossover log...

  111576 DPushes remaining with DInf 0.0000000e+00                13s
   33676 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    6965 PPushes remaining with PInf 5.2902066e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4244264e+04     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60139    7.7559967e+03   0.000000e+00   1.424426e+04     20s
   60451    7.7559967e+03   0.000000e+00   4.075909e-01     20s
   60511    7.7559967e+03   0.000000e+00   0.000000e+00     20s
   60511    7.7559967e+03   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 1.47s

Solved with barrier

Root relaxation: objective 7.755997e+03, 60511 iterations, 16.69 seconds (20.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7755.99667    0  239 -211403.45 7755.99667   104%     -   22s
     0     0 7755.99667    0  239 -211403.45 7755.99667   104%     -   23s
H    0     0                    -205393.2989 7755.99667   104%     -   23s
H    0     0                    -109282.3706 7755.99667   107%     -   23s
H    0     0                    -109261.9750 7755.99667   107%     -   23s
H    0     0                    -83596.15176 7755.99667   109%     -   23s
H    0     0                    -34344.82892 7755.99667   123%     -   24s
H    0     0                    -28162.43492 7755.99667   128%     -   24s
H    0     0                    -19792.96535 7755.99667   139%     -   24s
H    0     0                    -19760.68785 7755.99667   139%     -   24s
H    0     0                    -19698.56749 7755.99667   139%     -   27s
     0     0 2239.44053    0  394 -19698.567 2239.44053   111%     -   98s
     0     0 2013.52166    0  393 -19698.567 2013.52166   110%     -  113s
     0     0 2005.59835    0  402 -19698.567 2005.59835   110%     -  118s
     0     0 1618.21449    0  406 -19698.567 1618.21449   108%     -  124s
     0     0 1618.21449    0  406 -19698.567 1618.21449   108%     -  130s
     0     0 1618.21449    0  411 -19698.567 1618.21449   108%     -  135s
     0     0 1618.21449    0  415 -19698.567 1618.21449   108%     -  137s
     0     0 1618.21449    0  409 -19698.567 1618.21449   108%     -  142s
     0     0 1618.21449    0  409 -19698.567 1618.21449   108%     -  155s
     0     0 1618.21449    0  411 -19698.567 1618.21449   108%     -  159s
     0     0 1618.21449    0  408 -19698.567 1618.21449   108%     -  163s
     0     0 1615.20602    0  409 -19698.567 1615.20602   108%     -  166s
     0     0 1614.90432    0  412 -19698.567 1614.90432   108%     -  167s
H    0     0                    -19688.96414 -2058.8832  89.5%     -  227s
     0     0 -2058.8832    0  463 -19688.964 -2058.8832  89.5%     -  227s
H    0     0                    -19259.24672 -2059.5539  89.3%     -  228s
H    0     0                    -19254.27713 -2059.5539  89.3%     -  228s
     0     0 -2887.3334    0  438 -19254.277 -2887.3334  85.0%     -  275s
     0     0 -3106.8451    0  429 -19254.277 -3106.8451  83.9%     -  304s
     0     0 -3174.0760    0  437 -19254.277 -3174.0760  83.5%     -  321s
     0     0 -3183.5681    0  447 -19254.277 -3183.5681  83.5%     -  326s
     0     0 -3395.3269    0  441 -19254.277 -3395.3269  82.4%     -  350s
H    0     0                    -19218.64676 -3469.8158  81.9%     -  364s
H    0     0                    -18887.47839 -3469.8158  81.6%     -  364s
     0     0 -3469.8158    0  453 -18887.478 -3469.8158  81.6%     -  364s
     0     0 -3474.2248    0  456 -18887.478 -3474.2248  81.6%     -  368s
     0     0 -3481.2788    0  451 -18887.478 -3481.2788  81.6%     -  373s
     0     0 -3486.0182    0  454 -18887.478 -3486.0182  81.5%     -  378s
     0     0 -3488.0772    0  456 -18887.478 -3488.0772  81.5%     -  381s
     0     0 -3515.6217    0  451 -18887.478 -3515.6217  81.4%     -  385s
     0     0 -3525.6194    0  446 -18887.478 -3525.6194  81.3%     -  387s
     0     0 -3606.3907    0  463 -18887.478 -3606.3907  80.9%     -  397s
     0     0 -3612.4337    0  462 -18887.478 -3612.4337  80.9%     -  400s
     0     0 -3622.7986    0  456 -18887.478 -3622.7986  80.8%     -  403s
     0     0 -3622.8520    0  463 -18887.478 -3622.8520  80.8%     -  404s
H    0     0                    -17927.25250 -5848.7813  67.4%     -  480s
H    0     0                    -17918.96222 -5848.7813  67.4%     -  480s
H    0     0                    -17157.10587 -5848.7813  65.9%     -  480s
H    0     0                    -16960.77771 -5848.7813  65.5%     -  480s
H    0     0                    -16934.91250 -5848.7813  65.5%     -  480s
H    0     0                    -16923.93906 -5848.7813  65.4%     -  480s
H    0     0                    -16894.50431 -5848.7813  65.4%     -  480s
H    0     0                    -16887.20690 -5848.7813  65.4%     -  480s
H    0     0                    -16885.08243 -5848.7813  65.4%     -  480s
     0     0 -5848.7813    0  555 -16885.082 -5848.7813  65.4%     -  481s
     0     0 -6283.6825    0  476 -16885.082 -6283.6825  62.8%     -  527s
     0     0 -6429.6199    0  541 -16885.082 -6429.6199  61.9%     -  555s
     0     0 -6497.2315    0  500 -16885.082 -6497.2315  61.5%     -  578s
     0     0 -6583.3224    0  509 -16885.082 -6583.3224  61.0%     -  597s
     0     0 -6608.0768    0  508 -16885.082 -6608.0768  60.9%     -  605s
     0     0 -6633.1403    0  499 -16885.082 -6633.1403  60.7%     -  615s
     0     0 -6649.8771    0  501 -16885.082 -6649.8771  60.6%     -  620s
     0     0 -6669.5090    0  498 -16885.082 -6669.5090  60.5%     -  630s
     0     0 -6678.3529    0  502 -16885.082 -6678.3529  60.4%     -  635s
     0     0 -6678.7542    0  501 -16885.082 -6678.7542  60.4%     -  637s
     0     0 -7575.7987    0  547 -16885.082 -7575.7987  55.1%     -  717s
H    0     0                    -16871.49622 -7576.2254  55.1%     -  719s
H    0     0                    -16794.40732 -7780.4987  53.7%     -  749s
H    0     0                    -16742.08801 -7780.4987  53.5%     -  749s
H    0     0                    -16694.24867 -7780.4987  53.4%     -  749s
H    0     0                    -16672.78558 -7780.4987  53.3%     -  749s
H    0     0                    -16669.58672 -7780.4987  53.3%     -  749s
     0     0 -7780.4987    0  555 -16669.587 -7780.4987  53.3%     -  749s
     0     0 -7821.9115    0  544 -16669.587 -7821.9115  53.1%     -  763s
H    0     0                    -16657.57775 -7845.0031  52.9%     -  777s
     0     0 -7845.0031    0  550 -16657.578 -7845.0031  52.9%     -  777s
     0     0 -7889.6616    0  535 -16657.578 -7889.6616  52.6%     -  799s
H    0     0                    -16653.21503 -7913.4676  52.5%     -  810s
     0     0 -7913.4676    0  557 -16653.215 -7913.4676  52.5%     -  810s
     0     0 -7921.1778    0  560 -16653.215 -7921.1778  52.4%     -  820s
     0     0 -7925.1184    0  572 -16653.215 -7925.1184  52.4%     -  828s
     0     0 -7926.0753    0  567 -16653.215 -7926.0753  52.4%     -  830s
     0     0 -8082.9545    0  566 -16653.215 -8082.9545  51.5%     -  863s
     0     0 -8124.7770    0  574 -16653.215 -8124.7770  51.2%     -  882s
     0     0 -8161.3701    0  567 -16653.215 -8161.3701  51.0%     -  906s
     0     0 -8168.0347    0  572 -16653.215 -8168.0347  51.0%     -  920s
     0     0 -8181.0246    0  571 -16653.215 -8181.0246  50.9%     -  933s
     0     0 -8185.3140    0  581 -16653.215 -8185.3140  50.8%     -  939s
     0     0 -8197.2565    0  579 -16653.215 -8197.2565  50.8%     -  948s
     0     0 -8260.8743    0  593 -16653.215 -8260.8743  50.4%     -  966s
     0     0 -8274.4401    0  611 -16653.215 -8274.4401  50.3%     -  977s
     0     0 -8276.7877    0  600 -16653.215 -8276.7877  50.3%     -  985s
     0     0 -8342.6199    0  517 -16653.215 -8342.6199  49.9%     - 1015s
H    0     0                    -16650.41359 -8342.7933  49.9%     - 1016s
     0     0 -8364.8830    0  508 -16650.414 -8364.8830  49.8%     - 1030s
H    0     0                    -16203.95755 -8372.4793  48.3%     - 1039s
     0     0 -8372.4793    0  523 -16203.958 -8372.4793  48.3%     - 1039s
H    0     0                    -16085.18931 -8380.0808  47.9%     - 1048s
H    0     0                    -15879.55679 -8380.0808  47.2%     - 1048s
     0     0 -8380.0808    0  538 -15879.557 -8380.0808  47.2%     - 1048s
     0     0 -8382.9235    0  521 -15879.557 -8382.9235  47.2%     - 1057s
H    0     0                    -15836.23201 -8384.8715  47.1%     - 1067s
     0     0 -8384.8715    0  603 -15836.232 -8384.8715  47.1%     - 1067s
H    0     0                    -15833.49396 -8408.7891  46.9%     - 1091s
H    0     0                    -15832.67499 -8408.7891  46.9%     - 1091s
H    0     0                    -15831.84862 -8408.7891  46.9%     - 1091s
     0     0 -8408.7891    0  535 -15831.849 -8408.7891  46.9%     - 1091s
     0     0 -8417.2836    0  531 -15831.849 -8417.2836  46.8%     - 1112s
     0     0 -8422.8227    0  602 -15831.849 -8422.8227  46.8%     - 1125s
     0     0 -8426.2363    0  605 -15831.849 -8426.2363  46.8%     - 1129s
     0     0 -8429.0624    0  609 -15831.849 -8429.0624  46.8%     - 1135s
     0     0 -8430.2098    0  611 -15831.849 -8430.2098  46.8%     - 1139s
     0     0 -8468.9269    0  520 -15831.849 -8468.9269  46.5%     - 1168s
H    0     0                    -15828.90503 -8468.9899  46.5%     - 1169s
H    0     0                    -15824.58369 -8468.9899  46.5%     - 1169s
H    0     0                    -15821.79762 -8468.9899  46.5%     - 1169s
     0     0 -8482.1874    0  539 -15821.798 -8482.1874  46.4%     - 1182s
     0     0 -8483.1050    0  539 -15821.798 -8483.1050  46.4%     - 1186s
     0     0 -8494.0298    0  525 -15821.798 -8494.0298  46.3%     - 1204s
     0     0 -8500.8678    0  520 -15821.798 -8500.8678  46.3%     - 1214s
     0     0 -8502.8753    0  533 -15821.798 -8502.8753  46.3%     - 1220s
     0     0 -8516.9857    0  592 -15821.798 -8516.9857  46.2%     - 1240s
     0     0 -8517.1017    0  592 -15821.798 -8517.1017  46.2%     - 1253s
H    0     0                    -15604.35938 -8517.2615  45.4%     - 1425s
H    0     0                    -15584.87172 -8517.2615  45.3%     - 1431s
     0     2 -8517.2615    0  592 -15584.872 -8517.2615  45.3%     - 1437s
     1     3 -8686.3738    1  403 -15584.872 -8517.2615  45.3% 13121 1475s
     2     4 -8561.7598    1  503 -15584.872 -8561.7598  45.1%  9606 1493s
     3     6 -8600.6792    2  500 -15584.872 -8564.0695  45.0%  8436 1524s
     5    10 -8842.9687    3  590 -15584.872 -8564.0695  45.0%  9552 1562s
     9    18 -9941.5521    4  467 -15584.872 -8601.6208  44.8%  9840 1617s
    17    35 -9985.0207    5  468 -15584.872 -8843.3880  43.3%  8409 1650s
    34    49 -9824.6155    5  415 -15584.872 -8908.8773  42.8% 10116 1745s
    48    76 -11392.940    6  376 -15584.872 -8908.8773  42.8% 16030 1879s
H   58    76                    -15567.31913 -8908.8773  42.8% 15038 1879s
    77   207 -11645.701    7  364 -15567.319 -8985.7120  42.3% 12909 1946s
   212   256 -11931.345   10  356 -15567.319 -8985.7120  42.3%  8424 1979s
   279   291 -12302.605   13  362 -15567.319 -8985.7120  42.3%  7846 2008s
   351   317 -12347.582   14  360 -15567.319 -8985.7120  42.3%  7469 2033s
   389   337 -13050.063   15  348 -15567.319 -8985.7120  42.3%  7384 2061s
   440   375 -13545.133   16  343 -15567.319 -8985.7120  42.3%  7309 2088s
   504   398 infeasible   17      -15567.319 -8985.7120  42.3%  7151 2118s
   569   407 infeasible   19      -15567.319 -8985.7120  42.3%  7016 2145s
   629   438 -13929.014   20  316 -15567.319 -8985.7120  42.3%  6926 2170s
   681   467 -14083.578   22  298 -15567.319 -8985.7120  42.3%  6777 2194s
   736   484 -14553.128   24  321 -15567.319 -8985.7120  42.3%  6640 2222s
   771   519 -14701.436   25  321 -15567.319 -8985.7120  42.3%  6695 2243s
   816   545 -14752.179   26  322 -15567.319 -8985.7120  42.3%  6629 2266s
   874   576 infeasible   27      -15567.319 -8985.7120  42.3%  6452 2289s
   929   607 -14811.568   28  334 -15567.319 -8985.7120  42.3%  6339 2318s
   988   633 -14848.063   29  323 -15567.319 -8985.7120  42.3%  6248 2342s
  1054   666 -15167.921   30  295 -15567.319 -8985.7120  42.3%  6167 2370s
  1129   693 infeasible   31      -15567.319 -8985.7120  42.3%  6144 2399s
  1209   708 -15423.684   32  301 -15567.319 -8985.7120  42.3%  6035 2431s
  1286   720 infeasible   33      -15567.319 -8985.7120  42.3%  6015 2462s
  1328   738 -11018.774   11  446 -15567.319 -8985.7120  42.3%  6021 2497s
  1398   764 -11314.510   12  478 -15567.319 -8985.7120  42.3%  6031 2532s
  1448   809 -11911.224   23  355 -15567.319 -8985.7120  42.3%  6109 2570s
  1525   830 -12257.407   24  360 -15567.319 -8985.7120  42.3%  6068 2606s
  1593   854 -13063.963   12  407 -15567.319 -8985.7120  42.3%  6075 2645s
  1655   877 -14228.342   13  305 -15567.319 -8985.7120  42.3%  6105 2687s
  1729   907 -15021.323   14  200 -15567.319 -8985.7120  42.3%  6115 2731s
  1807   938 infeasible   17      -15567.319 -8985.7120  42.3%  6154 2780s
  1896   998 infeasible   17      -15567.319 -8985.7120  42.3%  6174 2828s
  2002  1044 -14534.912   16  325 -15567.319 -8985.7120  42.3%  6222 2885s
  2133  1107 infeasible   22      -15567.319 -8985.7120  42.3%  6129 2934s
  2276  1126 infeasible   27      -15567.319 -8985.7120  42.3%  6060 2983s
  2434  1156 -13402.125   21  283 -15567.319 -8985.7120  42.3%  5979 3042s
  2535  1191 -13669.963   22  284 -15567.319 -8985.7120  42.3%  6008 3102s
  2638  1277 -13958.490   24  277 -15567.319 -8985.7120  42.3%  6081 3159s
  2781  1290 -14745.294   26  319 -15567.319 -8985.7120  42.3%  6130 3219s
  2826  1318 -15034.426   27  310 -15567.319 -8985.7120  42.3%  6166 3272s
  2882  1330 infeasible   28      -15567.319 -8985.7120  42.3%  6170 3333s
  2944  1370 -15329.197   29  332 -15567.319 -9578.8898  38.5%  6183 3396s
  3026  1405 infeasible   30      -15567.319 -9578.8898  38.5%  6224 3459s
  3148  1439 -12883.946    7  413 -15567.319 -9578.8898  38.5%  6271 3525s
  3238  1494 -13057.069    9  386 -15567.319 -9578.8898  38.5%  6287 3600s

Cutting planes:
  Gomory: 5
  Implied bound: 291
  MIR: 3884
  Flow cover: 3241
  Zero half: 6
  RLT: 129
  Relax-and-lift: 632
  BQP: 1

Explored 3363 nodes (22035014 simplex iterations) in 3600.06 seconds (5427.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15567.3 -15584.9 -15604.4 ... -15879.6

Time limit reached
Best objective -1.556731913065e+04, best bound -9.578889832003e+03, gap 38.4680%
  WARNING: Time limit reached. Using best solution found (gap: 38.47%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -15567.32, θ = 102171.79
  Upper Bound (UB) = -15567.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102171.79
  [DEBUG]   ✓ Scenario 0: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102171.79 ≤ Q = 102171.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102171.79 ≤ Q = 102171.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102171.79 ≤ Q = 102171.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102171.79 ≤ Q = 102171.96 (slack: 0.18)
  [DEBUG]   ✓ Scenario 8: θ = 102171.79 ≤ Q = 102171.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102171.79 ≤ Q = 102171.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 102171.79 ≤ Q = 102171.79 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4c127350
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb3ed8cb0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.250937e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6504808.3170
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.370842e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137084.18    0  126 6504808.32 -137084.18   102%     -    0s
H    0     0                    -99784.03465 -137084.18  37.4%     -    0s
H    0     0                    -100157.9529 -137084.18  36.9%     -    0s
     0     0 -109075.21    0   68 -100157.95 -109075.21  8.90%     -    0s
H    0     0                    -107278.8862 -109038.57  1.64%     -    0s
H    0     0                    -107564.5379 -109038.57  1.37%     -    0s
H    0     0                    -107799.4427 -109038.57  1.15%     -    0s
     0     0 -108693.27    0   69 -107799.44 -108693.27  0.83%     -    0s
     0     0 -108628.68    0   69 -107799.44 -108628.68  0.77%     -    0s
     0     0 -108121.38    0   22 -107799.44 -108121.38  0.30%     -    0s
     0     0 -108114.33    0   21 -107799.44 -108114.33  0.29%     -    0s
     0     0 -108078.04    0   39 -107799.44 -108078.04  0.26%     -    0s
     0     0 -108076.37    0   36 -107799.44 -108076.37  0.26%     -    0s
     0     0 -108057.55    0   23 -107799.44 -108057.55  0.24%     -    0s
     0     0 -108057.37    0   22 -107799.44 -108057.37  0.24%     -    0s
     0     0 -107926.30    0   10 -107799.44 -107926.30  0.12%     -    0s
     0     0 -107924.09    0   14 -107799.44 -107924.09  0.12%     -    0s
     0     0 -107908.85    0   15 -107799.44 -107908.85  0.10%     -    0s
     0     0 -107908.85    0   17 -107799.44 -107908.85  0.10%     -    0s
     0     0 -107863.49    0    3 -107799.44 -107863.49  0.06%     -    0s
H    0     0                    -107863.4429 -107863.44  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 9
  Flow cover: 8

Explored 1 nodes (777 simplex iterations) in 0.13 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -107863 -107799 -107460 ... 1.25094e+13
No other solutions better than -107863

Optimal solution found (tolerance 1.00e-04)
Best objective -1.078634428743e+05, best bound -1.078634428743e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 98035.92
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107863.44
  [DEBUG]   S×d_nominal = 205899.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205899.37 + -107863.44 = 98035.92
  [DEBUG]   Current θ from Master = 102171.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4135.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19703.18
  Lower Bound (LB) = -17623.16
  Gap (UB-LB) = 2055.8396, Absolute Gap = 2055.8396, Relative Gap = 0.132061
  Not converged yet (gap = 2055.84 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654299 nonzeros
Model fingerprint: 0x7e65c876
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 95445 rows and 38745 columns
Presolve time: 4.14s
Presolved: 135288 rows, 57115 columns, 830447 nonzeros
Variable types: 54856 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407599.3033
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.47s

Barrier statistics:
 Dense cols : 723
 AA' NZ     : 5.682e+06
 Factor NZ  : 1.326e+07 (roughly 200 MB of memory)
 Factor Ops : 3.054e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55173034e+07  2.21775227e+08  8.21e+04 1.98e+01  6.55e+04     7s
   1  -1.15498104e+07  1.91283323e+08  5.69e+04 5.07e+01  4.56e+04     7s
   2  -4.97073881e+06  1.47689934e+08  2.39e+04 2.52e+01  1.97e+04     7s
   3  -1.38540196e+06  1.29468242e+08  3.31e+03 1.22e+01  3.15e+03     7s
   4  -7.49479630e+05  9.11633732e+07  5.43e+02 6.16e+00  7.81e+02     7s
   5  -6.12287645e+05  5.59930314e+07  3.38e+02 3.25e+00  4.62e+02     8s
   6  -5.03329598e+05  4.24508547e+07  1.66e+02 2.25e+00  2.81e+02     8s
   7  -4.80934448e+05  3.18872460e+07  7.26e+01 1.55e+00  1.75e+02     8s
   8  -3.23779829e+05  1.90537186e+07  1.08e+01 7.68e-01  8.38e+01     8s
   9  -2.10859129e+05  6.21180009e+06  1.76e+00 7.59e-03  2.64e+01     8s
  10  -1.44706634e+05  2.61464256e+06  9.27e-01 3.07e-03  1.13e+01     8s
  11  -1.13557194e+05  1.62242160e+06  5.60e-01 4.45e-02  7.07e+00     8s
  12  -9.17816478e+04  1.12459883e+06  3.70e-01 3.91e-02  4.95e+00     8s
  13  -7.18740582e+04  6.41224590e+05  2.29e-01 1.46e-02  2.90e+00     9s
  14  -3.99489503e+04  2.93603639e+05  9.27e-02 3.65e-03  1.35e+00     9s
  15  -3.16710941e+04  1.52062381e+05  6.74e-02 6.70e-04  7.45e-01     9s
  16  -2.40048874e+04  9.78602110e+04  5.14e-02 7.71e-04  4.94e-01     9s
  17  -1.73919637e+04  7.95735794e+04  3.70e-02 1.22e-03  3.93e-01     9s
  18  -1.23011803e+04  6.12733537e+04  2.69e-02 1.42e-03  2.98e-01     9s
  19  -7.81723260e+03  4.42771384e+04  1.88e-02 1.56e-03  2.11e-01     9s
  20  -4.95775338e+03  3.13889351e+04  1.44e-02 1.52e-03  1.47e-01    10s
  21  -2.59003522e+03  2.24279126e+04  1.12e-02 9.74e-04  1.01e-01    10s
  22  -3.52773437e+02  1.93068189e+04  8.43e-03 2.21e-03  7.97e-02    10s
  23   1.03879628e+03  1.52257879e+04  6.83e-03 1.67e-03  5.75e-02    10s
  24   2.64111359e+03  1.16451804e+04  5.08e-03 1.10e-03  3.65e-02    10s
  25   3.14443050e+03  1.09334230e+04  4.55e-03 8.98e-04  3.16e-02    10s
  26   4.22426086e+03  9.94821762e+03  3.45e-03 6.50e-04  2.32e-02    11s
  27   4.71909761e+03  9.21996034e+03  2.93e-03 4.39e-04  1.83e-02    11s
  28   5.56616894e+03  8.58230415e+03  1.98e-03 2.66e-04  1.22e-02    11s
  29   6.12776811e+03  8.45092223e+03  1.40e-03 2.32e-04  9.42e-03    11s
  30   6.55008432e+03  8.02595812e+03  9.85e-04 1.31e-04  5.99e-03    11s
  31   6.74382968e+03  7.90801823e+03  7.93e-04 8.85e-05  4.72e-03    12s
  32   6.84189404e+03  7.84015860e+03  6.94e-04 7.24e-05  4.05e-03    12s
  33   6.98728864e+03  7.80252382e+03  5.41e-04 6.31e-05  3.31e-03    12s
  34   7.11797526e+03  7.76918683e+03  4.15e-04 5.46e-05  2.64e-03    12s
  35   7.22014059e+03  7.73036316e+03  3.14e-04 4.49e-05  2.07e-03    12s
  36   7.26023597e+03  7.71293992e+03  2.75e-04 4.04e-05  1.84e-03    13s
  37   7.28489218e+03  7.68445887e+03  2.51e-04 3.38e-05  1.62e-03    13s
  38   7.31861717e+03  7.67015205e+03  2.18e-04 3.04e-05  1.43e-03    13s
  39   7.35269627e+03  7.65307387e+03  1.86e-04 2.59e-05  1.22e-03    13s
  40   7.37342162e+03  7.63314074e+03  1.66e-04 2.12e-05  1.05e-03    13s
  41   7.42124610e+03  7.60674723e+03  1.16e-04 1.45e-05  7.52e-04    14s
  42   7.42924352e+03  7.60024355e+03  1.09e-04 1.28e-05  6.94e-04    14s
  43   7.44640770e+03  7.59739322e+03  9.39e-05 1.19e-05  6.12e-04    14s
  44   7.49320609e+03  7.57685942e+03  5.00e-05 6.27e-06  3.39e-04    14s
  45   7.52271406e+03  7.56199821e+03  2.52e-05 2.40e-06  1.59e-04    15s
  46   7.54599202e+03  7.55532426e+03  5.37e-06 2.18e-06  3.78e-05    15s
  47   7.55071972e+03  7.55350879e+03  1.57e-06 4.41e-07  1.13e-05    15s
  48   7.55270591e+03  7.55300480e+03  1.45e-07 2.77e-07  1.21e-06    15s
  49   7.55291756e+03  7.55293721e+03  9.01e-09 1.49e-08  7.97e-08    15s
  50   7.55292999e+03  7.55293000e+03  4.07e-10 5.00e-11  4.40e-11    15s

Barrier solved model in 50 iterations and 15.33 seconds (13.02 work units)
Optimal objective 7.55292999e+03


Root crossover log...

  118974 DPushes remaining with DInf 0.0000000e+00                15s
     276 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                20s

    3883 PPushes remaining with PInf 6.9549827e-06                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.0326332e+01     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57560    7.5529300e+03   0.000000e+00   2.032633e+01     21s
   57562    7.5529300e+03   0.000000e+00   0.000000e+00     21s
   57562    7.5529300e+03   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 7.552930e+03, 57562 iterations, 15.36 seconds (17.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7552.93000    0  238 -211403.45 7552.93000   104%     -   21s
H    0     0                    -205393.2989 7552.93000   104%     -   21s
H    0     0                    -66041.53548 7552.93000   111%     -   22s
H    0     0                    -65993.52016 7552.93000   111%     -   22s
H    0     0                    -59135.34297 7552.93000   113%     -   22s
H    0     0                    -28670.97138 7552.93000   126%     -   22s
H    0     0                    -24869.57934 7552.93000   130%     -   22s
H    0     0                    -24686.53695 7552.93000   131%     -   22s
H    0     0                    -19911.99752 7552.93000   138%     -   22s
H    0     0                    -19800.34249 7552.93000   138%     -   22s
     0     0 2383.75615    0  395 -19800.342 2383.75615   112%     -   77s
H    0     0                    -19790.10584 2380.10533   112%     -   79s
H    0     0                    -19704.33269 2380.10533   112%     -   79s
     0     0 2325.31829    0  403 -19704.333 2325.31829   112%     -   93s
     0     0 2257.36354    0  407 -19704.333 2257.36354   111%     -   98s
     0     0 2097.48076    0  415 -19704.333 2097.48076   111%     -  103s
     0     0 2068.53477    0  413 -19704.333 2068.53477   110%     -  109s
     0     0 2063.98856    0  412 -19704.333 2063.98856   110%     -  112s
     0     0 1872.35033    0  417 -19704.333 1872.35033   110%     -  134s
     0     0 1858.08506    0  415 -19704.333 1858.08506   109%     -  145s
     0     0 1847.81675    0  418 -19704.333 1847.81675   109%     -  152s
     0     0 1843.79799    0  418 -19704.333 1843.79799   109%     -  153s
     0     0 1843.79288    0  418 -19704.333 1843.79288   109%     -  156s
     0     0 -1841.1820    0  441 -19704.333 -1841.1820  90.7%     -  288s
H    0     0                    -19658.78837 -1841.4008  90.6%     -  289s
     0     0 -2688.7899    0  460 -19658.788 -2688.7899  86.3%     -  324s
     0     0 -2783.2138    0  464 -19658.788 -2783.2138  85.8%     -  336s
     0     0 -2869.9922    0  469 -19658.788 -2869.9922  85.4%     -  354s
     0     0 -3008.3650    0  474 -19658.788 -3008.3650  84.7%     -  373s
     0     0 -3061.5425    0  475 -19658.788 -3061.5425  84.4%     -  382s
     0     0 -3096.3586    0  467 -19658.788 -3096.3586  84.2%     -  391s
     0     0 -3109.3115    0  471 -19658.788 -3109.3115  84.2%     -  401s
     0     0 -3112.9320    0  480 -19658.788 -3112.9320  84.2%     -  404s
     0     0 -3113.3828    0  481 -19658.788 -3113.3828  84.2%     -  407s
     0     0 -5418.4275    0  524 -19658.788 -5418.4275  72.4%     -  516s
     0     0 -5947.8120    0  512 -19658.788 -5947.8120  69.7%     -  575s
     0     0 -6113.1959    0  545 -19658.788 -6113.1959  68.9%     -  603s
     0     0 -6185.9146    0  538 -19658.788 -6185.9146  68.5%     -  627s
     0     0 -6241.1786    0  538 -19658.788 -6241.1786  68.3%     -  650s
     0     0 -6330.9611    0  533 -19658.788 -6330.9611  67.8%     -  666s
     0     0 -6384.9981    0  547 -19658.788 -6384.9981  67.5%     -  676s
     0     0 -6649.8849    0  550 -19658.788 -6649.8849  66.2%     -  701s
     0     0 -6673.7888    0  542 -19658.788 -6673.7888  66.1%     -  711s
     0     0 -6677.8999    0  541 -19658.788 -6677.8999  66.0%     -  720s
     0     0 -6685.7520    0  545 -19658.788 -6685.7520  66.0%     -  731s
     0     0 -6708.0722    0  481 -19658.788 -6708.0722  65.9%     -  744s
     0     0 -6712.7077    0  554 -19658.788 -6712.7077  65.9%     -  751s
     0     0 -6736.6242    0  479 -19658.788 -6736.6242  65.7%     -  765s
     0     0 -6746.4834    0  490 -19658.788 -6746.4834  65.7%     -  773s
     0     0 -6772.5581    0  476 -19658.788 -6772.5581  65.5%     -  782s
     0     0 -6781.0935    0  490 -19658.788 -6781.0935  65.5%     -  790s
     0     0 -6799.5829    0  493 -19658.788 -6799.5829  65.4%     -  796s
     0     0 -6800.7007    0  492 -19658.788 -6800.7007  65.4%     -  798s
     0     0 -7452.5699    0  482 -19658.788 -7452.5699  62.1%     -  873s
     0     0 -7673.0038    0  596 -19658.788 -7673.0038  61.0%     -  910s
     0     0 -7754.2705    0  539 -19658.788 -7754.2705  60.6%     -  931s
     0     0 -7800.1403    0  551 -19658.788 -7800.1403  60.3%     -  949s
     0     0 -7833.3788    0  560 -19658.788 -7833.3788  60.2%     -  970s
     0     0 -7874.2374    0  531 -19658.788 -7874.2374  59.9%     -  993s
     0     0 -7931.0822    0  495 -19658.788 -7931.0822  59.7%     - 1026s
     0     0 -7951.5665    0  551 -19658.788 -7951.5665  59.6%     - 1053s
     0     0 -7976.2186    0  490 -19658.788 -7976.2186  59.4%     - 1075s
     0     0 -7986.0782    0  486 -19658.788 -7986.0782  59.4%     - 1085s
     0     0 -7989.5037    0  557 -19658.788 -7989.5037  59.4%     - 1089s
     0     0 -7991.0471    0  477 -19658.788 -7991.0471  59.4%     - 1092s
     0     0 -8135.3879    0  557 -19658.788 -8135.3879  58.6%     - 1123s
H    0     0                    -19606.29370 -8135.5220  58.5%     - 1124s
     0     0 -8160.7293    0  476 -19606.294 -8160.7293  58.4%     - 1133s
     0     0 -8197.9752    0  477 -19606.294 -8197.9752  58.2%     - 1158s
     0     0 -8219.2432    0  562 -19606.294 -8219.2432  58.1%     - 1178s
     0     0 -8238.4740    0  495 -19606.294 -8238.4740  58.0%     - 1189s
     0     0 -8244.6716    0  498 -19606.294 -8244.6716  57.9%     - 1197s
     0     0 -8245.8701    0  495 -19606.294 -8245.8701  57.9%     - 1201s
     0     0 -8315.5934    0  559 -19606.294 -8315.5934  57.6%     - 1225s
H    0     0                    -19576.85812 -8316.5077  57.5%     - 1237s
H    0     0                    -19363.68828 -8316.5077  57.1%     - 1238s
H    0     0                    -19120.74472 -8316.5077  56.5%     - 1239s
H    0     0                    -19077.85339 -8316.5077  56.4%     - 1239s
H    0     0                    -19047.27178 -8316.5077  56.3%     - 1239s
H    0     0                    -19031.21531 -8316.5077  56.3%     - 1241s
H    0     0                    -19026.29352 -8316.5077  56.3%     - 1241s
H    0     0                    -19010.23705 -8316.5077  56.3%     - 1241s
     0     0 -8347.0191    0  561 -19010.237 -8347.0191  56.1%     - 1252s
     0     0 -8365.1156    0  566 -19010.237 -8365.1156  56.0%     - 1262s
     0     0 -8369.6926    0  564 -19010.237 -8369.6926  56.0%     - 1267s
     0     0 -8370.4697    0  562 -19010.237 -8370.4697  56.0%     - 1270s
     0     0 -8399.2487    0  487 -19010.237 -8399.2487  55.8%     - 1285s
     0     0 -8409.6237    0  511 -19010.237 -8409.6237  55.8%     - 1294s
     0     0 -8411.4447    0  511 -19010.237 -8411.4447  55.8%     - 1298s
     0     0 -8425.2982    0  499 -19010.237 -8425.2982  55.7%     - 1315s
H    0     0                    -18997.37259 -8425.8820  55.6%     - 1316s
H    0     0                    -18933.56152 -8425.8820  55.5%     - 1317s
     0     0 -8431.7908    0  503 -18933.562 -8431.7908  55.5%     - 1325s
     0     0 -8433.1528    0  510 -18933.562 -8433.1528  55.5%     - 1328s
     0     0 -8452.9401    0  498 -18933.562 -8452.9401  55.4%     - 1347s
     0     0 -8457.9134    0  499 -18933.562 -8457.9134  55.3%     - 1354s
     0     0 -8465.4958    0  499 -18933.562 -8465.4958  55.3%     - 1362s
     0     0 -8467.9477    0  509 -18933.562 -8467.9477  55.3%     - 1366s
     0     0 -8513.5210    0  499 -18933.562 -8513.5210  55.0%     - 1392s
H    0     0                    -18918.15698 -8513.6405  55.0%     - 1407s
     0     0 -8524.4682    0  518 -18918.157 -8524.4682  54.9%     - 1420s
     0     0 -8533.5200    0  508 -18918.157 -8533.5200  54.9%     - 1424s
     0     0 -8538.5043    0  513 -18918.157 -8538.5043  54.9%     - 1429s
     0     0 -8540.0136    0  516 -18918.157 -8540.0136  54.9%     - 1432s
     0     0 -8551.1093    0  513 -18918.157 -8551.1093  54.8%     - 1444s
     0     0 -8556.0599    0  517 -18918.157 -8556.0599  54.8%     - 1452s
     0     0 -8558.5279    0  515 -18918.157 -8558.5279  54.8%     - 1458s
     0     0 -8585.1734    0  523 -18918.157 -8585.1734  54.6%     - 1479s
     0     0 -8588.4139    0  530 -18918.157 -8588.4139  54.6%     - 1487s
     0     0 -8590.3311    0  530 -18918.157 -8590.3311  54.6%     - 1491s
     0     0 -8613.2041    0  520 -18918.157 -8613.2041  54.5%     - 1509s
     0     0 -8629.7106    0  516 -18918.157 -8629.7106  54.4%     - 1522s
     0     0 -8634.0535    0  519 -18918.157 -8634.0535  54.4%     - 1530s
     0     0 -8634.6873    0  522 -18918.157 -8634.6873  54.4%     - 1533s
     0     0 -8642.2354    0  517 -18918.157 -8642.2354  54.3%     - 1543s
H    0     0                    -18903.36172 -8642.2604  54.3%     - 1624s
H    0     0                    -18637.62403 -8642.2604  53.6%     - 1629s
H    0     0                    -18608.67169 -8642.2604  53.6%     - 1629s
     0     0 -8643.1357    0  520 -18608.672 -8643.1357  53.6%     - 1635s
     0     0 -8647.3737    0  535 -18608.672 -8647.3737  53.5%     - 1643s
     0     0 -8649.4667    0  526 -18608.672 -8649.4667  53.5%     - 1647s
     0     0 -8653.3744    0  525 -18608.672 -8653.3744  53.5%     - 1654s
     0     0 -8653.8449    0  525 -18608.672 -8653.8449  53.5%     - 1666s
H    0     0                    -18584.41772 -8653.8449  53.4%     - 1732s
H    0     0                    -17308.57203 -8653.8449  50.0%     - 1792s
H    0     0                    -17020.05694 -8653.8449  49.2%     - 1792s
H    0     0                    -16338.64450 -8653.8449  47.0%     - 1792s
H    0     0                    -16212.61008 -8653.8449  46.6%     - 1795s
H    0     0                    -16171.96335 -8653.8449  46.5%     - 1795s
H    0     0                    -16137.69259 -8653.8449  46.4%     - 1795s
H    0     0                    -16096.54144 -8653.8449  46.2%     - 1795s
H    0     0                    -16045.39592 -8653.8449  46.1%     - 1798s
H    0     0                    -16040.42633 -8653.8449  46.0%     - 1799s
     0     2 -8653.8449    0  525 -16040.426 -8653.8449  46.0%     - 1801s
     1     3 -9046.7941    1  391 -16040.426 -8654.3666  46.0% 14149 1838s
     2     4 -8720.4220    1  533 -16040.426 -8720.4220  45.6%  9627 1854s
     3     7 -9303.0504    2  403 -16040.426 -8720.4311  45.6%  8473 1876s
     6    12 -9702.3679    3  373 -16040.426 -8723.6321  45.6%  7447 1934s
    11    19 -9855.8612    4  394 -16040.426 -8806.1821  45.1% 10896 1971s
    20    24 -15886.974    5  226 -16040.426 -9160.0649  42.9% 14187 2060s
    27    39 -10482.856    4  393 -16040.426 -9160.0649  42.9% 14346 2248s
H   31    39                    -16010.25374 -9160.0649  42.8% 13471 2249s
H   33    39                    -15978.80479 -9160.0649  42.7% 12868 2249s
H   34    38                    -15932.04725 -9160.0649  42.5% 12649 2249s
    44    54 -10588.625    5  385 -15932.047 -9160.0649  42.5% 18153 2443s
    76   156 -10594.030    6  383 -15932.047 -9160.0855  42.5% 18102 2519s
H  103   156                    -15891.99740 -9160.0855  42.4% 14520 2519s
H  131   156                    -15628.78024 -9160.0855  41.4% 12357 2519s
   188   207 -10983.038   10  363 -15628.780 -9160.0855  41.4%  9532 2566s
   260   229 -11134.363   11  455 -15628.780 -9160.0855  41.4%  7983 2608s
H  288   229                    -15576.75896 -9160.0855  41.2%  7631 2608s
   294   252 -11441.368   16  422 -15576.759 -9160.0855  41.2%  7591 2649s
   332   270 -11293.863   12  445 -15576.759 -9160.0855  41.2%  7316 2692s
   368   287 -11671.733   13  454 -15576.759 -9160.0855  41.2%  6997 2729s
   421   292 -12042.070   14  360 -15576.759 -9160.0855  41.2%  6614 2769s
   479   304 -12155.316   15  355 -15576.759 -9160.0855  41.2%  6282 2812s
   527   319 -12158.776   21  329 -15576.759 -9160.0855  41.2%  6178 2854s
   573   356 -15458.115   18  170 -15576.759 -9160.0855  41.2%  6032 2892s
   640   374 -15505.154   19  161 -15576.759 -9160.0855  41.2%  5782 2930s
   713   407 -12521.139   23  315 -15576.759 -9160.0855  41.2%  5493 2963s
   782   431 -12795.560   25  325 -15576.759 -9160.0855  41.2%  5356 2995s
   814   463 -12801.154   26  381 -15576.759 -9160.0855  41.2%  5303 3026s
   876   527 -13202.861   30  300 -15576.759 -9160.0855  41.2%  5126 3061s
   963   624 -13394.135   36  366 -15576.759 -9160.0855  41.2%  4850 3096s
  1072   688 -14063.326   42  351 -15576.759 -9160.0855  41.2%  4528 3130s
  1168   743 -15184.133   46  317 -15576.759 -9160.0855  41.2%  4320 3162s
  1278   727 -14563.549   45  318 -15576.759 -9160.0855  41.2%  4117 3201s
  1376   722 infeasible   48      -15576.759 -9160.0855  41.2%  3981 3240s
  1427   720     cutoff   47      -15576.759 -9160.0855  41.2%  3956 3281s
  1479   736 -13106.743   11  243 -15576.759 -9160.0855  41.2%  3956 3327s
  1531   749 -13402.256   12  238 -15576.759 -9160.0855  41.2%  4018 3370s
  1592   765 -14283.359   14  227 -15576.759 -9160.0855  41.2%  4028 3424s
  1664   796 infeasible   18      -15576.759 -9160.0855  41.2%  4030 3475s
  1744   836 -15450.228   19  203 -15576.759 -9160.0855  41.2%  4019 3523s
  1832   866 -12029.788    7  321 -15576.759 -9160.0855  41.2%  4015 3574s
  1926   879 -12467.516    8  311 -15576.759 -9160.0855  41.2%  3983 3600s

Cutting planes:
  Implied bound: 257
  MIR: 3952
  Flow cover: 3429
  Zero half: 4
  RLT: 91
  Relax-and-lift: 708

Explored 1963 nodes (8552130 simplex iterations) in 3600.08 seconds (4780.57 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15576.8 -15628.8 -15892 ... -16137.7

Time limit reached
Best objective -1.557675896416e+04, best bound -9.160085539742e+03, gap 41.1939%
  WARNING: Time limit reached. Using best solution found (gap: 41.19%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -15576.76, θ = 102603.61
  Upper Bound (UB) = -15576.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102603.61
  [DEBUG]   ✓ Scenario 0: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102603.61 ≤ Q = 102603.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102603.61 ≤ Q = 102603.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102603.61 ≤ Q = 102603.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 102603.61 ≤ Q = 102603.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 102603.61 ≤ Q = 102603.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 102603.61 ≤ Q = 102603.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 102603.61 ≤ Q = 102603.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x733fea1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf8cc015f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.250937e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6475222.3440
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.367154e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136715.43    0  126 6475222.34 -136715.43   102%     -    0s
H    0     0                    -99318.06148 -136715.43  37.7%     -    0s
H    0     0                    -99741.49971 -136715.43  37.1%     -    0s
     0     0 -106766.53    0   70 -99741.500 -106766.53  7.04%     -    0s
H    0     0                    -104493.4314 -106690.48  2.10%     -    0s
H    0     0                    -104793.1898 -106690.48  1.81%     -    0s
H    0     0                    -105218.2748 -106690.48  1.40%     -    0s
H    0     0                    -105518.0331 -106690.48  1.11%     -    0s
     0     0 -106406.77    0   71 -105518.03 -106406.77  0.84%     -    0s
     0     0 -106161.70    0   68 -105518.03 -106161.70  0.61%     -    0s
     0     0 -106115.61    0   68 -105518.03 -106115.61  0.57%     -    0s
     0     0 -105811.54    0   39 -105518.03 -105811.54  0.28%     -    0s
     0     0 -105769.81    0   45 -105518.03 -105769.81  0.24%     -    0s
     0     0 -105766.43    0   46 -105518.03 -105766.43  0.24%     -    0s
     0     0 -105710.15    0   41 -105518.03 -105710.15  0.18%     -    0s
     0     0 -105701.32    0   30 -105518.03 -105701.32  0.17%     -    0s
     0     0 -105701.32    0   77 -105518.03 -105701.32  0.17%     -    0s
     0     0 -105701.32    0   42 -105518.03 -105701.32  0.17%     -    0s
     0     0 -105692.61    0   30 -105518.03 -105692.61  0.17%     -    0s
     0     0 -105612.46    0   12 -105518.03 -105612.46  0.09%     -    0s
     0     0 -105608.55    0    9 -105518.03 -105608.55  0.09%     -    0s
     0     0 -105607.36    0    9 -105518.03 -105607.36  0.08%     -    0s
     0     0 -105531.43    0    4 -105518.03 -105531.43  0.01%     -    0s
     0     0          -    0      -105518.03 -105526.77  0.01%     -    0s

Explored 1 nodes (1012 simplex iterations) in 0.22 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -105518 -105484 -105399 ... 1.25094e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.055180331371e+05, best bound -1.055267705647e+05, gap 0.0083%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 100521.42
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105518.03
  [DEBUG]   S×d_nominal = 206039.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206039.45 + -105518.03 = 100521.42
  [DEBUG]   Current θ from Master = 102603.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2082.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17658.95
  Lower Bound (LB) = -17623.16
  Gap (UB-LB) = 2046.3997, Absolute Gap = 2046.3997, Relative Gap = 0.131375
  Not converged yet (gap = 2046.40 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697551 nonzeros
Model fingerprint: 0xf235477b
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101808 rows and 41328 columns
Presolve time: 4.61s
Presolved: 144215 rows, 60772 columns, 885644 nonzeros
Variable types: 58513 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407604.8704
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.86s

Barrier statistics:
 Dense cols : 725
 AA' NZ     : 6.363e+06
 Factor NZ  : 1.448e+07 (roughly 200 MB of memory)
 Factor Ops : 3.300e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55164547e+07  2.34267394e+08  8.24e+04 1.91e+01  6.51e+04     9s
   1  -1.16696450e+07  2.02006782e+08  5.78e+04 5.67e+01  4.58e+04     9s
   2  -6.38678562e+06  1.56928514e+08  3.05e+04 2.80e+01  2.47e+04     9s
   3  -8.60488859e+05  1.21248465e+08  1.25e+03 2.03e+00  1.44e+03     9s
   4  -6.24928794e+05  8.73125210e+07  4.21e+02 1.19e+00  6.42e+02     9s
   5  -5.63176785e+05  5.17495356e+07  2.53e+02 6.22e-01  3.65e+02     9s
   6  -4.73153112e+05  3.71694690e+07  7.26e+01 4.15e-01  1.87e+02     9s
   7  -4.06103465e+05  2.66621372e+07  1.56e+01 2.83e-01  1.11e+02    10s
   8  -3.61322447e+05  1.88121635e+07  6.05e+00 1.98e-01  7.54e+01    10s
   9  -1.94451907e+05  4.08821867e+06  1.35e-07 3.40e-02  1.63e+01    10s
  10  -1.28000801e+05  2.07494557e+06  1.19e-07 1.70e-02  8.37e+00    10s
  11  -1.02629040e+05  1.24348694e+06  9.42e-08 1.02e-02  5.11e+00    10s
  12  -8.43707030e+04  9.10771572e+05  7.49e-08 7.47e-03  3.78e+00    10s
  13  -7.57920749e+04  7.09689791e+05  6.57e-08 5.80e-03  2.98e+00    11s
  14  -4.04463669e+04  2.12588027e+05  3.31e-08 1.67e-03  9.61e-01    11s
  15  -2.94794930e+04  1.23118302e+05  2.35e-08 9.55e-04  5.80e-01    11s
  16  -2.35473421e+04  9.73637541e+04  1.89e-08 7.45e-04  4.59e-01    11s
  17  -1.62242234e+04  7.74719993e+04  1.30e-08 5.85e-04  3.56e-01    11s
  18  -1.06319803e+04  5.16516100e+04  8.88e-09 7.71e-04  2.37e-01    12s
  19  -7.02448443e+03  3.88372461e+04  6.53e-09 5.82e-04  1.74e-01    12s
  20  -4.40821178e+03  2.97714824e+04  5.07e-09 4.22e-04  1.30e-01    12s
  21  -1.80870224e+03  2.24237636e+04  3.73e-09 2.95e-04  9.21e-02    12s
  22  -1.65024643e+02  1.83412645e+04  2.97e-09 2.16e-04  7.03e-02    13s
  23   1.85313713e+03  1.44252291e+04  2.09e-09 1.40e-04  4.78e-02    13s
  24   2.63353181e+03  1.27203937e+04  1.76e-09 1.06e-04  3.83e-02    13s
  25   4.21724322e+03  1.05010187e+04  1.15e-09 6.08e-05  2.39e-02    13s
  26   4.83665081e+03  9.53749172e+03  9.20e-10 4.12e-05  1.79e-02    14s
  27   5.23423535e+03  8.62344670e+03  7.58e-10 2.44e-05  1.29e-02    14s
  28   5.63730542e+03  8.24668770e+03  6.07e-10 1.73e-05  9.91e-03    14s
  29   5.88094691e+03  8.06823698e+03  5.15e-10 1.38e-05  8.31e-03    15s
  30   6.38057069e+03  7.82636101e+03  3.38e-10 8.72e-06  5.49e-03    15s
  31   6.67933056e+03  7.67216599e+03  2.35e-10 5.34e-06  3.77e-03    15s
  32   6.86871938e+03  7.60111361e+03  1.63e-10 4.03e-06  2.78e-03    15s
  33   6.95219210e+03  7.49588102e+03  1.74e-09 2.28e-06  2.07e-03    16s
  34   7.01960210e+03  7.46698687e+03  6.14e-08 1.83e-06  1.70e-03    16s
  35   7.07331777e+03  7.43707025e+03  2.01e-07 1.35e-06  1.38e-03    16s
  36   7.09056597e+03  7.43176084e+03  2.10e-07 1.25e-06  1.30e-03    16s
  37   7.10490909e+03  7.41915719e+03  2.21e-07 1.04e-06  1.19e-03    17s
  38   7.15998500e+03  7.40811309e+03  4.85e-07 8.59e-07  9.43e-04    17s
  39   7.23095812e+03  7.38516128e+03  6.31e-07 4.88e-07  5.86e-04    17s
  40   7.26364277e+03  7.37842425e+03  5.21e-07 3.75e-07  4.36e-04    18s
  41   7.27125646e+03  7.37397373e+03  5.04e-07 3.15e-07  3.90e-04    18s
  42   7.31020104e+03  7.36496740e+03  3.14e-07 1.78e-07  2.08e-04    18s
  43   7.32578159e+03  7.36065837e+03  3.30e-07 1.12e-07  1.33e-04    19s
  44   7.33836728e+03  7.35664035e+03  1.96e-07 5.61e-08  6.94e-05    19s
  45   7.33973794e+03  7.35559231e+03  1.83e-07 4.36e-08  6.02e-05    20s
  46   7.34526574e+03  7.35419784e+03  1.12e-07 2.39e-08  3.39e-05    20s
  47   7.34830400e+03  7.35410432e+03  6.45e-08 2.28e-08  2.20e-05    20s
  48   7.34833980e+03  7.35364174e+03  6.36e-08 1.69e-08  2.01e-05    21s
  49   7.35130167e+03  7.35320368e+03  2.54e-08 1.15e-08  7.23e-06    21s
  50   7.35180538e+03  7.35260220e+03  3.37e-08 3.58e-08  3.03e-06    22s
  51   7.35185886e+03  7.35257928e+03  3.27e-07 4.00e-08  2.74e-06    22s
  52   7.35198251e+03  7.35249946e+03  2.43e-07 2.17e-08  1.96e-06    22s
  53   7.35208965e+03  7.35244568e+03  1.86e-07 4.05e-06  1.35e-06    23s
  54   7.35228529e+03  7.35235208e+03  4.24e-08 1.73e-07  2.54e-07    23s
  55   7.35229950e+03  7.35234979e+03  8.06e-07 1.93e-06  1.91e-07    23s
  56   7.35234291e+03  7.35234495e+03  4.12e-08 1.59e-07  7.73e-09    23s
  57   7.35234344e+03  7.35234439e+03  5.47e-07 3.51e-09  3.54e-09    23s
  58   7.35234369e+03  7.35234439e+03  1.64e-06 2.59e-09  2.61e-09    24s
  59   7.35234403e+03  7.35234439e+03  8.56e-07 1.31e-09  1.35e-09    24s
  60   7.35234415e+03  7.35234439e+03  7.55e-07 7.63e-10  8.65e-10    24s
  61   7.35234424e+03  7.35234439e+03  4.92e-07 3.43e-10  5.63e-10    24s
  62   7.35234426e+03  7.35234439e+03  1.35e-06 6.37e-09  3.38e-10    24s
  63   7.35234437e+03  7.35234438e+03  1.17e-07 1.30e-07  2.93e-11    24s

Barrier solved model in 63 iterations and 24.50 seconds (19.70 work units)
Optimal objective 7.35234437e+03


Root crossover log...

  116626 DPushes remaining with DInf 0.0000000e+00                25s
   51688 DPushes remaining with DInf 0.0000000e+00                26s
    5280 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                32s

    3967 PPushes remaining with PInf 1.0748895e-05                32s
       0 PPushes remaining with PInf 0.0000000e+00                32s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6454885e-10     32s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   55245    7.3523444e+03   0.000000e+00   0.000000e+00     32s
   55245    7.3523444e+03   0.000000e+00   0.000000e+00     32s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.352344e+03, 55245 iterations, 26.70 seconds (29.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7352.34439    0  407 -211403.45 7352.34439   103%     -   33s
H    0     0                    -93515.83527 7352.34439   108%     -   34s
H    0     0                    -30567.60596 7352.34439   124%     -   34s
H    0     0                    -30518.99430 7352.34439   124%     -   34s
H    0     0                    -19963.76947 7352.34439   137%     -   35s
H    0     0                    -19954.60380 7352.34439   137%     -   35s
H    0     0                    -19217.11007 7352.34439   138%     -   35s
     0     0 1652.84503    0  403 -19217.110 1652.84503   109%     -   98s
H    0     0                    -19035.28638 1633.91820   109%     -  100s
H    0     0                    -18899.03475 1633.91820   109%     -  100s
     0     0 1098.80915    0  411 -18899.035 1098.80915   106%     -  141s
     0     0  987.61361    0  421 -18899.035  987.61361   105%     -  153s
     0     0  969.53284    0  428 -18899.035  969.53284   105%     -  157s
     0     0  962.77367    0  432 -18899.035  962.77367   105%     -  160s
     0     0  962.77367    0  432 -18899.035  962.77367   105%     -  162s
     0     0 -2109.4802    0  473 -18899.035 -2109.4802  88.8%     -  293s
H    0     0                    -18840.95297 -2109.8298  88.8%     -  294s
     0     0 -2646.2388    0  489 -18840.953 -2646.2388  86.0%     -  373s
     0     0 -2755.6746    0  484 -18840.953 -2755.6746  85.4%     -  424s
     0     0 -2850.4696    0  472 -18840.953 -2850.4696  84.9%     -  452s
     0     0 -2922.2056    0  479 -18840.953 -2922.2056  84.5%     -  466s
     0     0 -3010.2907    0  472 -18840.953 -3010.2907  84.0%     -  492s
     0     0 -3195.6346    0  460 -18840.953 -3195.6346  83.0%     -  520s
     0     0 -3562.2724    0  467 -18840.953 -3562.2724  81.1%     -  553s
     0     0 -3683.7152    0  475 -18840.953 -3683.7152  80.4%     -  568s
     0     0 -3798.8876    0  479 -18840.953 -3798.8876  79.8%     -  591s
     0     0 -3814.1201    0  488 -18840.953 -3814.1201  79.8%     -  597s
     0     0 -3817.9729    0  480 -18840.953 -3817.9729  79.7%     -  599s
     0     0 -3879.9447    0  480 -18840.953 -3879.9447  79.4%     -  608s
     0     0 -3891.1402    0  484 -18840.953 -3891.1402  79.3%     -  612s
     0     0 -3914.8157    0  482 -18840.953 -3914.8157  79.2%     -  618s
     0     0 -3927.4095    0  479 -18840.953 -3927.4095  79.2%     -  625s
     0     0 -3928.9679    0  473 -18840.953 -3928.9679  79.1%     -  627s
     0     0 -3929.5979    0  479 -18840.953 -3929.5979  79.1%     -  629s
     0     0 -5710.9216    0  503 -18840.953 -5710.9216  69.7%     -  741s
     0     0 -6281.2085    0  506 -18840.953 -6281.2085  66.7%     -  803s
     0     0 -6435.7261    0  511 -18840.953 -6435.7261  65.8%     -  845s
     0     0 -6498.2067    0  515 -18840.953 -6498.2067  65.5%     -  881s
     0     0 -6550.7186    0  518 -18840.953 -6550.7186  65.2%     -  909s
     0     0 -6719.8728    0  531 -18840.953 -6719.8728  64.3%     -  935s
     0     0 -6779.1465    0  523 -18840.953 -6779.1465  64.0%     -  955s
     0     0 -6799.0987    0  533 -18840.953 -6799.0987  63.9%     -  968s
     0     0 -6826.6104    0  532 -18840.953 -6826.6104  63.8%     -  985s
     0     0 -6883.7040    0  587 -18840.953 -6883.7040  63.5%     - 1003s
     0     0 -6898.2676    0  582 -18840.953 -6898.2676  63.4%     - 1014s
     0     0 -6904.1751    0  595 -18840.953 -6904.1751  63.4%     - 1023s
     0     0 -6906.9286    0  595 -18840.953 -6906.9286  63.3%     - 1032s
     0     0 -6908.6803    0  599 -18840.953 -6908.6803  63.3%     - 1036s
     0     0 -7568.3772    0  504 -18840.953 -7568.3772  59.8%     - 1144s
     0     0 -7787.3155    0  489 -18840.953 -7787.3155  58.7%     - 1187s
     0     0 -7893.1650    0  497 -18840.953 -7893.1650  58.1%     - 1221s
     0     0 -7910.5058    0  494 -18840.953 -7910.5058  58.0%     - 1234s
     0     0 -7920.1657    0  548 -18840.953 -7920.1657  58.0%     - 1243s
     0     0 -7924.3272    0  493 -18840.953 -7924.3272  57.9%     - 1247s
     0     0 -7941.5224    0  494 -18840.953 -7941.5224  57.8%     - 1257s
     0     0 -7953.1187    0  497 -18840.953 -7953.1187  57.8%     - 1269s
     0     0 -7961.4087    0  509 -18840.953 -7961.4087  57.7%     - 1279s
     0     0 -7966.3479    0  502 -18840.953 -7966.3479  57.7%     - 1285s
     0     0 -7983.2707    0  510 -18840.953 -7983.2707  57.6%     - 1293s
     0     0 -7989.0731    0  502 -18840.953 -7989.0731  57.6%     - 1301s
     0     0 -7991.1548    0  562 -18840.953 -7991.1548  57.6%     - 1307s
     0     0 -8072.1971    0  496 -18840.953 -8072.1971  57.2%     - 1334s
     0     0 -8146.2103    0  580 -18840.953 -8146.2103  56.8%     - 1368s
     0     0 -8176.7857    0  570 -18840.953 -8176.7857  56.6%     - 1397s
     0     0 -8198.0123    0  529 -18840.953 -8198.0123  56.5%     - 1410s
     0     0 -8224.6833    0  526 -18840.953 -8224.6833  56.3%     - 1425s
     0     0 -8242.3009    0  527 -18840.953 -8242.3009  56.3%     - 1445s
     0     0 -8265.5624    0  525 -18840.953 -8265.5624  56.1%     - 1460s
     0     0 -8269.5728    0  531 -18840.953 -8269.5728  56.1%     - 1466s
     0     0 -8272.9887    0  532 -18840.953 -8272.9887  56.1%     - 1470s
     0     0 -8274.7977    0  525 -18840.953 -8274.7977  56.1%     - 1472s
     0     0 -8369.3371    0  497 -18840.953 -8369.3371  55.6%     - 1510s
     0     0 -8408.8728    0  510 -18840.953 -8408.8728  55.4%     - 1569s
     0     0 -8445.3703    0  569 -18840.953 -8445.3703  55.2%     - 1590s
     0     0 -8459.6499    0  490 -18840.953 -8459.6499  55.1%     - 1604s
     0     0 -8489.9525    0  494 -18840.953 -8489.9525  54.9%     - 1625s
     0     0 -8498.8821    0  482 -18840.953 -8498.8821  54.9%     - 1631s
     0     0 -8507.5540    0  487 -18840.953 -8507.5540  54.8%     - 1638s
     0     0 -8508.6657    0  491 -18840.953 -8508.6657  54.8%     - 1640s
     0     0 -8545.4909    0  487 -18840.953 -8545.4909  54.6%     - 1656s
     0     0 -8561.9773    0  495 -18840.953 -8561.9773  54.6%     - 1665s
     0     0 -8571.6824    0  499 -18840.953 -8571.6824  54.5%     - 1672s
     0     0 -8577.7360    0  487 -18840.953 -8577.7360  54.5%     - 1679s
     0     0 -8579.7230    0  480 -18840.953 -8579.7230  54.5%     - 1683s
     0     0 -8621.0362    0  490 -18840.953 -8621.0362  54.2%     - 1704s
     0     0 -8643.3238    0  499 -18840.953 -8643.3238  54.1%     - 1718s
     0     0 -8655.6013    0  497 -18840.953 -8655.6013  54.1%     - 1728s
     0     0 -8658.5224    0  493 -18840.953 -8658.5224  54.0%     - 1736s
     0     0 -8658.9391    0  494 -18840.953 -8658.9391  54.0%     - 1738s
     0     0 -8670.8216    0  490 -18840.953 -8670.8216  54.0%     - 1750s
     0     0 -8675.4958    0  515 -18840.953 -8675.4958  54.0%     - 1756s
     0     0 -8680.0413    0  510 -18840.953 -8680.0413  53.9%     - 1763s
     0     0 -8681.0356    0  509 -18840.953 -8681.0356  53.9%     - 1767s
     0     0 -8695.0977    0  514 -18840.953 -8695.0977  53.9%     - 1783s
     0     0 -8700.0685    0  519 -18840.953 -8700.0685  53.8%     - 1792s
     0     0 -8701.5171    0  529 -18840.953 -8701.5171  53.8%     - 1795s
     0     0 -8709.6437    0  513 -18840.953 -8709.6437  53.8%     - 1809s
     0     0 -8710.4937    0  513 -18840.953 -8710.4937  53.8%     - 1824s
H    0     0                    -18654.18176 -8710.4937  53.3%     - 1897s
     0     2 -8710.4937    0  513 -18654.182 -8710.4937  53.3%     - 2022s
     1     4 -8716.9734    1  496 -18654.182 -8710.5667  53.3%  3467 2054s
     3     6 -9837.9952    2  395 -18654.182 -8717.8517  53.3% 11367 2107s
     5    11 -9384.4782    3  394 -18654.182 -8717.8517  53.3% 12024 2137s
    10    18 -10179.746    4  392 -18654.182 -8976.9135  51.9% 12189 2194s
    17    25 -10840.134    5  395 -18654.182 -8976.9135  51.9% 18094 2288s
    24    45 -9843.9113    4  422 -18654.182 -9228.4240  50.5% 17019 2479s
    44    77 -9783.3451    5  494 -18654.182 -9228.5160  50.5% 23481 2554s
H   45    77                    -18638.83259 -9228.5160  50.5% 22959 2554s
H   48    77                    -18625.13681 -9228.5160  50.5% 22391 2554s
H   64    77                    -16878.37636 -9228.5160  45.3% 21414 2554s
H   67    76                    -16381.72205 -9228.5160  43.7% 21054 2554s
    76   179 -9841.4022    6  494 -16381.722 -9228.5160  43.7% 21493 2684s
H  197   250                    -16298.67345 -9228.5160  43.4% 12319 2744s
H  199   250                    -16156.71877 -9228.5160  42.9% 12375 2744s
H  210   250                    -16085.79598 -9228.5160  42.6% 12088 2744s
H  242   250                    -16070.89054 -9228.5160  42.6% 11492 2744s
H  251   250                    -15876.82335 -9228.5160  41.9% 11774 2744s
   273   300 -12695.953    8  341 -15876.823 -9228.5160  41.9% 11527 2795s
   347   332 -10255.872   10  467 -15876.823 -9228.5160  41.9% 10747 2837s
H  382   332                    -15848.00419 -9228.5160  41.8% 10615 2837s
   399   366 -11325.327   11  295 -15848.004 -9228.5160  41.8% 10539 2880s
   444   389 -12195.341   11  261 -15848.004 -9228.5160  41.8% 10491 2918s
H  445   389                    -15813.72847 -9228.5160  41.6% 10467 2918s
H  454   389                    -15699.30357 -9346.8782  40.5% 10459 2918s
   480   435 -12360.484   11  255 -15699.304 -9346.8782  40.5% 10595 2958s
   553   446 -11897.618   12  249 -15699.304 -9346.8782  40.5% 10454 2993s
H  556   446                    -15688.02053 -9346.8782  40.4% 10399 2993s
H  563   446                    -15665.04714 -9346.8782  40.3% 10374 2993s
   599   458 -12476.849   13  258 -15665.047 -9346.8782  40.3% 10175 3031s
   668   490 -15009.196   13  360 -15665.047 -9346.8782  40.3%  9946 3072s
   724   526 -12954.860   14  243 -15665.047 -9346.8782  40.3%  9889 3107s
   785   574 -13176.214   27  293 -15665.047 -9346.8782  40.3%  9553 3141s
   867   645 -13295.782   15  236 -15665.047 -9346.8782  40.3%  9096 3174s
   970   669 infeasible   16      -15665.047 -9346.8782  40.3%  8501 3204s
H  972   669                    -15664.52720 -9346.8782  40.3%  8492 3204s
H  978   669                    -15629.47062 -9487.7534  39.3%  8475 3204s
H 1000   669                    -15620.24761 -9487.7534  39.3%  8346 3204s
  1023   727 -13547.528   15  245 -15620.248 -9487.7534  39.3%  8277 3238s
H 1024   727                    -15611.67259 -9487.7534  39.2%  8269 3238s
  1136   793 -15197.483   18  214 -15611.673 -9487.7534  39.2%  7749 3274s
  1278   886 infeasible   18      -15611.673 -9487.7534  39.2%  7224 3312s
  1424   964 -15487.264   19  214 -15611.673 -9487.7534  39.2%  6789 3350s
  1584  1068 -14942.071   34   48 -15611.673 -9769.8638  37.4%  6373 3388s
  1772  1114 -14996.260   44   40 -15611.673 -9769.8638  37.4%  5896 3422s
H 1834  1114                    -15607.45968 -9920.4005  36.4%  5758 3422s
H 1842  1114                    -15604.31049 -9920.4005  36.4%  5763 3422s
  1898  1169 -15043.439   50   41 -15604.310 -9920.4005  36.4%  5666 3462s
  2072  1181 -15178.049   62   21 -15604.310 -9920.4005  36.4%  5404 3506s
  2182  1179 infeasible   34      -15604.310 -9920.4005  36.4%  5344 3548s
H 2216  1179                    -15603.04670 -9920.4005  36.4%  5390 3548s
  2230  1210 -14792.160    9  348 -15603.047 -9920.4005  36.4%  5436 3594s
  2303  1199 -15032.797   37  419 -15603.047 -9920.4005  36.4%  5543 3600s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 318
  MIR: 4490
  Flow cover: 3426
  Zero half: 4
  RLT: 135
  Relax-and-lift: 934

Explored 2326 nodes (13589843 simplex iterations) in 3600.06 seconds (4844.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15603 -15604.3 -15607.5 ... -15699.3

Time limit reached
Best objective -1.560304670257e+04, best bound -9.920400520458e+03, gap 36.4201%
  WARNING: Time limit reached. Using best solution found (gap: 36.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -15603.05, θ = 102588.42
  Upper Bound (UB) = -15603.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102588.42
  [DEBUG]   ✓ Scenario 0: θ = 102588.42 ≤ Q = 102588.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102588.42 ≤ Q = 102588.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 102588.42 ≤ Q = 102588.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 102588.42 ≤ Q = 102588.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 102588.42 ≤ Q = 102588.42 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x287c729d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x287c729d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.250937e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6475422.2734
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.368759e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136875.89    0  126 6475422.27 -136875.89   102%     -    0s
H    0     0                    -99500.25418 -136875.89  37.6%     -    0s
H    0     0                    -99897.95614 -136875.89  37.0%     -    0s
     0     0 -107281.32    0   66 -99897.956 -107281.32  7.39%     -    0s
H    0     0                    -105368.6719 -107206.17  1.74%     -    0s
H    0     0                    -105668.4303 -107206.17  1.46%     -    0s
H    0     0                    -105927.9228 -107206.17  1.21%     -    0s
     0     0 -107037.51    0   68 -105927.92 -107037.51  1.05%     -    0s
H    0     0                    -105929.0272 -106596.19  0.63%     -    0s
     0     0 -106596.19    0   61 -105929.03 -106596.19  0.63%     -    0s
H    0     0                    -105932.1670 -106549.80  0.58%     -    0s
     0     0 -106549.80    0   58 -105932.17 -106549.80  0.58%     -    0s
     0     0 -106548.08    0   58 -105932.17 -106548.08  0.58%     -    0s
     0     0 -106358.47    0   40 -105932.17 -106358.47  0.40%     -    0s
     0     0 -106301.67    0   48 -105932.17 -106301.67  0.35%     -    0s
     0     0 -106296.10    0   47 -105932.17 -106296.10  0.34%     -    0s
     0     0 -106260.39    0   39 -105932.17 -106260.39  0.31%     -    0s
     0     0 -106260.38    0   39 -105932.17 -106260.38  0.31%     -    0s
H    0     0                    -105960.3797 -106260.23  0.28%     -    0s
     0     0 -106260.23    0   93 -105960.38 -106260.23  0.28%     -    0s
     0     0 -106260.23    0   43 -105960.38 -106260.23  0.28%     -    0s
     0     0 -106257.13    0   32 -105960.38 -106257.13  0.28%     -    0s
     0     0 -106256.53    0   32 -105960.38 -106256.53  0.28%     -    0s
     0     0 -106241.33    0   31 -105960.38 -106241.33  0.27%     -    0s
     0     0 -106232.99    0   29 -105960.38 -106232.99  0.26%     -    0s
     0     0 -106198.11    0   25 -105960.38 -106198.11  0.22%     -    0s
     0     0 -106191.35    0   21 -105960.38 -106191.35  0.22%     -    0s
     0     0 -106190.43    0   20 -105960.38 -106190.43  0.22%     -    0s
     0     0 -106054.98    0   11 -105960.38 -106054.98  0.09%     -    0s
     0     0 -106054.98    0    9 -105960.38 -106054.98  0.09%     -    0s
     0     0 -106010.80    0    4 -105960.38 -106010.80  0.05%     -    0s
H    0     0                    -105972.5088 -106003.75  0.03%     -    0s
     0     0 -106003.75    0    4 -105972.51 -106003.75  0.03%     -    0s
H    0     0                    -105990.6999 -106003.75  0.01%     -    0s
     0     0 -106003.75    0    5 -105990.70 -106003.75  0.01%     -    0s
H    0     0                    -105991.6661 -106003.75  0.01%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 5
  MIR: 2
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (1194 simplex iterations) in 0.32 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -105992 -105991 -105973 ... -99500.3
No other solutions better than -105992

Optimal solution found (tolerance 1.00e-04)
Best objective -1.059916660636e+05, best bound -1.059916660636e+05, gap 0.0000%
  Subproblem solved in 0.35s
  Worst-case operational profit (Z_SP) = 100207.70
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105991.67
  [DEBUG]   S×d_nominal = 206199.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206199.36 + -105991.67 = 100207.70
  [DEBUG]   Current θ from Master = 102588.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2380.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17983.77
  Lower Bound (LB) = -17623.16
  Gap (UB-LB) = 2020.1120, Absolute Gap = 2020.1120, Relative Gap = 0.129469
  Not converged yet (gap = 2020.11 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740803 nonzeros
Model fingerprint: 0x93ac91ad
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 108171 rows and 43911 columns
Presolve time: 4.80s
Presolved: 153142 rows, 64429 columns, 940618 nonzeros
Variable types: 62170 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407604.8704
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.57s

Barrier statistics:
 Dense cols : 725
 AA' NZ     : 7.099e+06
 Factor NZ  : 1.650e+07 (roughly 200 MB of memory)
 Factor Ops : 4.126e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55337837e+07  2.46607618e+08  8.22e+04 1.85e+01  6.48e+04     8s
   1  -1.18461764e+07  2.12521935e+08  5.77e+04 5.69e+01  4.54e+04     8s
   2  -5.70136786e+06  1.66411178e+08  2.68e+04 7.18e+00  2.22e+04     8s
   3  -9.48003521e+05  1.24994817e+08  2.07e+03 3.52e-01  2.08e+03     8s
   4  -5.69509267e+05  8.01944109e+07  4.59e+02 1.35e-01  6.26e+02     9s
   5  -5.04478703e+05  4.44071489e+07  2.66e+02 6.11e-02  3.37e+02     9s
   6  -4.26594799e+05  3.17354289e+07  1.05e+02 3.94e-02  1.80e+02     9s
   7  -3.42508619e+05  2.36216342e+07  2.24e+01 2.77e-02  9.80e+01     9s
   8  -2.26830598e+05  1.38566084e+07  1.03e+00 1.56e-02  5.08e+01     9s
   9  -1.41802071e+05  3.89362218e+06  2.42e-01 4.10e-03  1.45e+01    10s
  10  -1.07908934e+05  1.76674676e+06  1.22e-01 1.93e-03  6.72e+00    10s
  11  -8.40689939e+04  1.19688952e+06  6.97e-02 1.30e-03  4.59e+00    10s
  12  -7.17733699e+04  5.50154768e+05  5.01e-02 6.09e-04  2.23e+00    10s
  13  -5.57455171e+04  2.48654568e+05  3.05e-02 4.20e-04  1.09e+00    10s
  14  -3.59101535e+04  1.34143379e+05  1.66e-02 1.26e-03  6.09e-01    10s
  15  -2.97802759e+04  1.00756321e+05  1.40e-02 1.62e-03  4.68e-01    11s
  16  -1.92832626e+04  8.23708539e+04  9.52e-03 1.30e-03  3.64e-01    11s
  17  -1.32637566e+04  6.02812034e+04  6.75e-03 9.45e-04  2.63e-01    11s
  18  -9.73312701e+03  4.50636042e+04  5.23e-03 6.85e-04  1.96e-01    12s
  19  -6.69648570e+03  3.60665710e+04  4.07e-03 5.77e-04  1.53e-01    12s
  20  -3.97707669e+03  2.79686653e+04  3.10e-03 4.22e-04  1.14e-01    12s
  21  -1.40415499e+03  2.14340101e+04  2.27e-03 2.92e-04  8.18e-02    12s
  22   6.13424218e+02  1.66594942e+04  1.70e-03 2.50e-04  5.75e-02    13s
  23   8.82748793e+02  1.53430727e+04  1.62e-03 2.20e-04  5.18e-02    13s
  24   2.53115344e+03  1.28640049e+04  1.20e-03 1.49e-04  3.70e-02    13s
  25   3.73551230e+03  1.10647708e+04  8.94e-04 9.87e-05  2.63e-02    14s
  26   4.51190065e+03  1.01908890e+04  7.03e-04 7.54e-05  2.03e-02    14s
  27   5.11834617e+03  9.33251989e+03  5.42e-04 5.16e-05  1.51e-02    14s
  28   5.70806056e+03  8.78067936e+03  3.97e-04 3.67e-05  1.10e-02    14s
  29   6.23939775e+03  8.32501649e+03  2.68e-04 2.40e-05  7.47e-03    15s
  30   6.70031733e+03  7.95445433e+03  1.61e-04 1.45e-05  4.49e-03    15s
  31   6.81174097e+03  7.86635682e+03  1.35e-04 1.23e-05  3.78e-03    15s
  32   6.91511452e+03  7.75861075e+03  1.10e-04 9.76e-06  3.02e-03    15s
  33   6.98296434e+03  7.73360316e+03  9.47e-05 9.06e-06  2.69e-03    16s
  34   7.10312150e+03  7.63194925e+03  6.66e-05 7.01e-06  1.89e-03    16s
  35   7.16307282e+03  7.59466250e+03  5.28e-05 4.83e-06  1.55e-03    16s
  36   7.18696554e+03  7.54256746e+03  4.77e-05 3.10e-06  1.27e-03    16s
  37   7.23224158e+03  7.52133813e+03  3.82e-05 2.61e-06  1.04e-03    17s
  38   7.27871152e+03  7.49541059e+03  2.78e-05 2.52e-06  7.76e-04    17s
  39   7.33003108e+03  7.46533586e+03  1.71e-05 1.67e-06  4.85e-04    17s
  40   7.33767556e+03  7.44103738e+03  1.55e-05 1.75e-06  3.70e-04    18s
  41   7.36926265e+03  7.43653191e+03  9.24e-06 1.44e-06  2.41e-04    18s
  42   7.37658630e+03  7.43020826e+03  7.77e-06 8.17e-07  1.92e-04    18s
  43   7.37806128e+03  7.42512315e+03  7.48e-06 5.50e-07  1.69e-04    18s
  44   7.40739386e+03  7.41893682e+03  1.59e-06 7.25e-07  4.13e-05    19s
  45   7.41419316e+03  7.41678682e+03  2.66e-07 1.92e-07  9.29e-06    19s
  46   7.41540614e+03  7.41618932e+03  7.28e-08 4.93e-08  2.81e-06    19s
  47   7.41587541e+03  7.41596667e+03  1.31e-08 3.41e-09  3.27e-07    19s
  48   7.41594067e+03  7.41594866e+03  9.86e-08 2.11e-08  2.87e-08    20s
  49   7.41594540e+03  7.41594640e+03  1.08e-07 2.14e-10  3.59e-09    20s
  50   7.41594639e+03  7.41594639e+03  3.85e-09 2.50e-11  2.11e-11    20s

Barrier solved model in 50 iterations and 20.06 seconds (16.21 work units)
Optimal objective 7.41594639e+03


Root crossover log...

  134613 DPushes remaining with DInf 0.0000000e+00                20s
     739 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                25s

    4666 PPushes remaining with PInf 5.4786853e-06                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.4141778e-10     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63621    7.4159464e+03   0.000000e+00   0.000000e+00     26s
   63621    7.4159464e+03   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.415946e+03, 63621 iterations, 19.82 seconds (19.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7415.94639    0  238 -211403.45 7415.94639   104%     -   27s
H    0     0                    -207796.4838 7415.94639   104%     -   27s
H    0     0                    -185299.2189 7415.94639   104%     -   27s
H    0     0                    -164975.0869 7415.94639   104%     -   27s
H    0     0                    -69703.07580 7415.94639   111%     -   27s
H    0     0                    -57184.19362 7415.94639   113%     -   27s
H    0     0                    -37807.28787 7415.94639   120%     -   28s
H    0     0                    -37583.37062 7415.94639   120%     -   29s
H    0     0                    -37249.59985 7415.94639   120%     -   29s
H    0     0                    -36743.68254 7415.94639   120%     -   31s
H    0     0                    -36739.13813 7415.94639   120%     -   31s
     0     0 2218.35537    0  393 -36739.138 2218.35537   106%     -  114s
H    0     0                    -34023.11269 2213.92294   107%     -  115s
H    0     0                    -33883.52511 2213.92294   107%     -  115s
H    0     0                    -33326.75916 2213.92294   107%     -  116s
H    0     0                    -33286.94353 2213.92294   107%     -  116s
     0     0 2164.49247    0  412 -33286.944 2164.49247   107%     -  133s
     0     0 1887.43083    0  406 -33286.944 1887.43083   106%     -  147s
     0     0 1885.74413    0  401 -33286.944 1885.74413   106%     -  151s
     0     0 1863.15797    0  406 -33286.944 1863.15797   106%     -  155s
     0     0 1854.41611    0  402 -33286.944 1854.41611   106%     -  158s
     0     0 1852.92568    0  402 -33286.944 1852.92568   106%     -  159s
     0     0 1750.23587    0  407 -33286.944 1750.23587   105%     -  167s
     0     0 1744.27867    0  413 -33286.944 1744.27867   105%     -  172s
     0     0 1714.06482    0  419 -33286.944 1714.06482   105%     -  177s
     0     0 1713.59340    0  418 -33286.944 1713.59340   105%     -  177s
     0     0 -2165.8143    0  424 -33286.944 -2165.8143  93.5%     -  282s
H    0     0                    -29405.15670 -2165.8889  92.6%     -  283s
H    0     0                    -29181.52399 -2165.8889  92.6%     -  283s
H    0     0                    -28939.19127 -2165.8889  92.5%     -  283s
H    0     0                    -28930.23200 -2165.8889  92.5%     -  283s
     0     0 -2282.9976    0  440 -28930.232 -2282.9976  92.1%     -  325s
     0     0 -2388.7195    0  435 -28930.232 -2388.7195  91.7%     -  358s
     0     0 -2465.0658    0  441 -28930.232 -2465.0658  91.5%     -  373s
     0     0 -2527.9352    0  437 -28930.232 -2527.9352  91.3%     -  388s
     0     0 -2645.9901    0  434 -28930.232 -2645.9901  90.9%     -  432s
     0     0 -2687.0308    0  451 -28930.232 -2687.0308  90.7%     -  457s
     0     0 -2729.4345    0  440 -28930.232 -2729.4345  90.6%     -  469s
     0     0 -2800.8932    0  445 -28930.232 -2800.8932  90.3%     -  500s
     0     0 -2841.3842    0  439 -28930.232 -2841.3842  90.2%     -  512s
     0     0 -3078.1222    0  451 -28930.232 -3078.1222  89.4%     -  534s
     0     0 -3092.5724    0  445 -28930.232 -3092.5724  89.3%     -  539s
     0     0 -3092.5784    0  445 -28930.232 -3092.5784  89.3%     -  540s
     0     0 -5229.5523    0  438 -28930.232 -5229.5523  81.9%     -  633s
H    0     0                    -28018.73117 -5229.6173  81.3%     -  634s
H    0     0                    -26647.16051 -5229.6173  80.4%     -  634s
     0     0 -5813.7495    0  478 -26647.161 -5813.7495  78.2%     -  679s
     0     0 -6100.0676    0  489 -26647.161 -6100.0676  77.1%     -  722s
     0     0 -6295.4908    0  517 -26647.161 -6295.4908  76.4%     -  757s
     0     0 -6697.6275    0  497 -26647.161 -6697.6275  74.9%     -  799s
     0     0 -6756.5645    0  511 -26647.161 -6756.5645  74.6%     -  822s
     0     0 -6841.3047    0  506 -26647.161 -6841.3047  74.3%     -  852s
     0     0 -6866.1713    0  503 -26647.161 -6866.1713  74.2%     -  863s
     0     0 -6904.9905    0  505 -26647.161 -6904.9905  74.1%     -  880s
     0     0 -6936.2481    0  514 -26647.161 -6936.2481  74.0%     -  891s
     0     0 -6978.0535    0  498 -26647.161 -6978.0535  73.8%     -  907s
     0     0 -7004.8289    0  499 -26647.161 -7004.8289  73.7%     -  922s
     0     0 -7005.6830    0  508 -26647.161 -7005.6830  73.7%     -  926s
     0     0 -7764.7972    0  480 -26647.161 -7764.7972  70.9%     - 1025s
H    0     0                    -26585.24431 -7764.9591  70.8%     - 1026s
     0     0 -7923.1993    0  476 -26585.244 -7923.1993  70.2%     - 1076s
     0     0 -7972.5899    0  468 -26585.244 -7972.5899  70.0%     - 1103s
     0     0 -8023.4529    0  466 -26585.244 -8023.4529  69.8%     - 1135s
     0     0 -8077.8389    0  482 -26585.244 -8077.8389  69.6%     - 1171s
     0     0 -8104.8220    0  486 -26585.244 -8104.8220  69.5%     - 1195s
     0     0 -8111.7549    0  488 -26585.244 -8111.7549  69.5%     - 1206s
     0     0 -8160.0469    0  485 -26585.244 -8160.0469  69.3%     - 1226s
     0     0 -8164.4324    0  491 -26585.244 -8164.4324  69.3%     - 1234s
     0     0 -8169.1694    0  480 -26585.244 -8169.1694  69.3%     - 1246s
     0     0 -8172.6047    0  474 -26585.244 -8172.6047  69.3%     - 1254s
     0     0 -8175.5793    0  484 -26585.244 -8175.5793  69.2%     - 1261s
     0     0 -8177.9584    0  485 -26585.244 -8177.9584  69.2%     - 1266s
     0     0 -8178.4771    0  489 -26585.244 -8178.4771  69.2%     - 1272s
     0     0 -8411.3412    0  480 -26585.244 -8411.3412  68.4%     - 1342s
H    0     0                    -25986.40790 -8411.4473  67.6%     - 1343s
H    0     0                    -25793.00477 -8411.4473  67.4%     - 1343s
H    0     0                    -25768.22767 -8411.4473  67.4%     - 1343s
     0     0 -8457.1959    0  558 -25768.228 -8457.1959  67.2%     - 1374s
     0     0 -8469.2905    0  556 -25768.228 -8469.2905  67.1%     - 1391s
     0     0 -8474.4407    0  569 -25768.228 -8474.4407  67.1%     - 1406s
     0     0 -8475.5659    0  564 -25768.228 -8475.5659  67.1%     - 1412s
     0     0 -8520.8571    0  573 -25768.228 -8520.8571  66.9%     - 1458s
H    0     0                    -25412.96092 -8521.8484  66.5%     - 1459s
H    0     0                    -19975.21840 -8521.8484  57.3%     - 1460s
H    0     0                    -19965.98960 -8521.8484  57.3%     - 1461s
H    0     0                    -19487.52100 -8521.8484  56.3%     - 1461s
H    0     0                    -19436.95221 -8521.8484  56.2%     - 1461s
H    0     0                    -19399.02549 -8521.8484  56.1%     - 1461s
H    0     0                    -19376.98622 -8521.8484  56.0%     - 1462s
H    0     0                    -19375.77173 -8521.8484  56.0%     - 1462s
H    0     0                    -19334.43174 -8521.8484  55.9%     - 1462s
     0     0 -8531.1817    0  571 -19334.432 -8531.1817  55.9%     - 1488s
     0     0 -8534.8955    0  567 -19334.432 -8534.8955  55.9%     - 1499s
     0     0 -8537.1027    0  576 -19334.432 -8537.1027  55.8%     - 1504s
     0     0 -8564.3285    0  512 -19334.432 -8564.3285  55.7%     - 1536s
     0     0 -8567.3764    0  506 -19334.432 -8567.3764  55.7%     - 1550s
     0     0 -8568.4377    0  504 -19334.432 -8568.4377  55.7%     - 1557s
     0     0 -8597.4754    0  509 -19334.432 -8597.4754  55.5%     - 1588s
H    0     0                    -19287.66433 -8597.5565  55.4%     - 1589s
     0     0 -8609.0709    0  568 -19287.664 -8609.0709  55.4%     - 1615s
     0     0 -8614.5433    0  511 -19287.664 -8614.5433  55.3%     - 1629s
     0     0 -8615.1713    0  513 -19287.664 -8615.1713  55.3%     - 1634s
     0     0 -8638.7064    0  583 -19287.664 -8638.7064  55.2%     - 1668s
     0     0 -8649.1005    0  520 -19287.664 -8649.1005  55.2%     - 1688s
     0     0 -8652.7848    0  520 -19287.664 -8652.7848  55.1%     - 1695s
     0     0 -8654.1832    0  523 -19287.664 -8654.1832  55.1%     - 1699s
     0     0 -8665.2447    0  519 -19287.664 -8665.2447  55.1%     - 1719s
     0     0 -8668.3163    0  522 -19287.664 -8668.3163  55.1%     - 1729s
     0     0 -8668.9716    0  517 -19287.664 -8668.9716  55.1%     - 1732s
     0     0 -8673.2032    0  523 -19287.664 -8673.2032  55.0%     - 1747s
     0     0 -8673.8701    0  524 -19287.664 -8673.8701  55.0%     - 1752s
     0     0 -8677.4510    0  528 -19287.664 -8677.4510  55.0%     - 1763s
     0     0 -8677.4852    0  528 -19287.664 -8677.4852  55.0%     - 1780s
H    0     0                    -19047.57072 -8677.4852  54.4%     - 1867s
H    0     0                    -17310.37294 -8677.4852  49.9%     - 1976s
H    0     0                    -16912.31247 -8677.4852  48.7%     - 1978s
H    0     2                    -16896.65241 -8677.4852  48.6%     - 2018s
     0     2 -8677.4852    0  528 -16896.652 -8677.4852  48.6%     - 2018s
     1     4 -8746.5504    1  495 -16896.652 -8677.6722  48.6%  5968 2104s
     3     8 -8854.9291    2  574 -16896.652 -8746.6168  48.2% 14440 2167s
     7    16 -9013.4881    3  503 -16896.652 -8855.0888  47.6% 15305 2219s
    15    32 -9313.0371    4  573 -16896.652 -9013.6431  46.7% 14331 2272s
    31    46 -9594.9704    5  501 -16896.652 -9313.0875  44.9% 20710 2391s
    47    69 -16668.650    6  219 -16896.652 -9313.0875  44.9% 21732 2495s
H   49    69                    -16842.02478 -9313.0875  44.7% 21226 2495s
H   55    68                    -16562.58535 -9313.0875  43.8% 20846 2495s
H   57    67                    -16491.96297 -9313.0875  43.5% 20395 2495s
H   59    67                    -16473.13855 -9313.0875  43.5% 19890 2495s
    76   148     cutoff    7      -16473.139 -9313.0875  43.5% 18155 2622s
   167   182 -11814.533   10  348 -16473.139 -9313.0875  43.5% 12474 2676s
H  178   182                    -16355.86224 -9313.0875  43.1% 12546 2676s
   203   269 -11910.064   11  350 -16355.862 -9313.0875  43.1% 12265 2728s
   310   290 -11978.500   13  339 -16355.862 -9313.0875  43.1% 10093 2764s
H  312   290                    -16201.57063 -9313.0875  42.5% 10048 2764s
H  313   290                    -16129.05557 -9313.0875  42.3% 10030 2764s
   350   327 -14450.904   17  173 -16129.056 -9313.0875  42.3%  9718 2805s
   426   352 -12399.646   14  329 -16129.056 -9313.0875  42.3%  8882 2844s
   492   348 -12583.740   15  376 -16129.056 -9313.0875  42.3%  8600 2883s
   550   365     cutoff   16      -16129.056 -9313.0875  42.3%  8404 2916s
   593   387 -14550.700   15  383 -16129.056 -9313.0875  42.3%  8426 2953s
   654   396 -14676.248   16  314 -16129.056 -9313.0875  42.3%  8165 2987s
   710   428 infeasible   17      -16129.056 -9313.0875  42.3%  8066 3020s
   774   475 -13009.814   26  381 -16129.056 -9313.0875  42.3%  7975 3057s
   841   517 -13331.067   27  383 -16129.056 -9313.0875  42.3%  7851 3090s
   928   573 -13404.101   29  381 -16129.056 -9313.0875  42.3%  7546 3126s
  1020   601 -13471.933   31  369 -16129.056 -9313.0875  42.3%  7271 3160s
H 1025   601                    -16123.97744 -9313.0875  42.2%  7263 3160s
H 1033   601                    -15750.11717 -9313.0875  40.9%  7228 3160s
  1092   591 -13720.570   30  390 -15750.117 -9313.0875  40.9%  7104 3197s
  1188   623 -14583.082   32  126 -15750.117 -9323.8490  40.8%  6896 3236s
  1273   677 -13774.716   34  362 -15750.117 -9323.8490  40.8%  6828 3270s
  1379   713 -14192.638   35  298 -15750.117 -9323.8490  40.8%  6593 3307s
  1505   720 infeasible   35      -15750.117 -9323.8490  40.8%  6324 3346s
  1609   734 -15377.830   37  114 -15750.117 -9395.9823  40.3%  6221 3387s
H 1622   734                    -15720.86242 -9395.9823  40.2%  6254 3387s
  1643   780 -15478.864   38   86 -15720.862 -9395.9823  40.2%  6309 3433s
  1753   795     cutoff   44      -15720.862 -9395.9823  40.2%  6257 3474s
H 1757   795                    -15633.44883 -9395.9823  39.9%  6256 3474s
  1794   822     cutoff   43      -15633.449 -9395.9823  39.9%  6294 3525s
  1904   863 -15233.185   13  223 -15633.449 -9395.9823  39.9%  6240 3572s
H 1913   863                    -15615.51965 -9395.9823  39.8%  6222 3572s
  1994   963 infeasible   14      -15615.520 -9395.9823  39.8%  6184 3600s

Cutting planes:
  Gomory: 10
  Implied bound: 236
  MIR: 4674
  Flow cover: 3712
  Zero half: 3
  RLT: 91
  Relax-and-lift: 664

Explored 2152 nodes (13597378 simplex iterations) in 3600.06 seconds (4759.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15615.5 -15633.4 -15720.9 ... -16492

Time limit reached
Best objective -1.561551965041e+04, best bound -9.395982297616e+03, gap 39.8292%
  WARNING: Time limit reached. Using best solution found (gap: 39.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -15615.52, θ = 102438.67
  Upper Bound (UB) = -15615.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102438.67
  [DEBUG]   ✓ Scenario 0: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 102438.67 ≤ Q = 102438.67 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6d1b0d36
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6d1b0d36
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.239879e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6435817.4640
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.370437e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137043.73    0  126 6435817.46 -137043.73   102%     -    0s
H    0     0                    -99552.93947 -137043.73  37.7%     -    0s
H    0     0                    -99976.37771 -137043.73  37.1%     -    0s
     0     0 -107043.86    0   70 -99976.378 -107043.86  7.07%     -    0s
H    0     0                    -104523.1077 -106965.24  2.34%     -    0s
H    0     0                    -105098.1903 -106965.24  1.78%     -    0s
H    0     0                    -105256.0067 -106965.24  1.62%     -    0s
H    0     0                    -105831.0893 -106965.24  1.07%     -    0s
     0     0 -106674.73    0   73 -105831.09 -106674.73  0.80%     -    0s
H    0     0                    -105835.3335 -106617.67  0.74%     -    0s
     0     0 -106353.86    0   65 -105835.33 -106353.86  0.49%     -    0s
     0     0 -106305.60    0   59 -105835.33 -106305.60  0.44%     -    0s
     0     0 -106305.60    0   59 -105835.33 -106305.60  0.44%     -    0s
     0     0 -106051.49    0   42 -105835.33 -106051.49  0.20%     -    0s
     0     0 -106027.45    0   43 -105835.33 -106027.45  0.18%     -    0s
     0     0 -105983.35    0   38 -105835.33 -105983.35  0.14%     -    0s
     0     0 -105976.29    0   26 -105835.33 -105976.29  0.13%     -    0s
     0     0 -105946.38    0   17 -105835.33 -105946.38  0.10%     -    0s
     0     0 -105935.35    0   10 -105835.33 -105935.35  0.09%     -    0s
     0     0 -105935.30    0   10 -105835.33 -105935.30  0.09%     -    0s
     0     0 -105935.30    0   26 -105835.33 -105935.30  0.09%     -    0s
     0     0 -105865.54    0    5 -105835.33 -105865.54  0.03%     -    0s
     0     0 -105856.10    0    3 -105835.33 -105856.10  0.02%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 14
  Flow cover: 7

Explored 1 nodes (774 simplex iterations) in 0.16 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -105835 -105831 -105624 ... 1.23988e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.058353335228e+05, best bound -1.058423488228e+05, gap 0.0066%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 100361.51
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105835.33
  [DEBUG]   S×d_nominal = 206196.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206196.84 + -105835.33 = 100361.51
  [DEBUG]   Current θ from Master = 102438.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2077.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17692.68
  Lower Bound (LB) = -17623.16
  Gap (UB-LB) = 2007.6390, Absolute Gap = 2007.6390, Relative Gap = 0.128567
  Not converged yet (gap = 2007.64 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 784055 nonzeros
Model fingerprint: 0x32a79deb
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 114534 rows and 46494 columns (presolve time = 5s)...
Presolve removed 114534 rows and 46494 columns
Presolve time: 5.66s
Presolved: 162069 rows, 68086 columns, 995438 nonzeros
Variable types: 65827 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407604.8704
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.63s

Barrier statistics:
 Dense cols : 725
 AA' NZ     : 7.858e+06
 Factor NZ  : 1.826e+07 (roughly 240 MB of memory)
 Factor Ops : 4.752e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55325172e+07  2.59153288e+08  8.25e+04 1.79e+01  6.44e+04     9s
   1  -1.18547327e+07  2.23264904e+08  5.80e+04 5.66e+01  4.52e+04     9s
   2  -5.74307311e+06  1.75636315e+08  2.71e+04 7.39e+00  2.23e+04     9s
   3  -9.78769336e+05  1.29216620e+08  2.23e+03 1.64e+00  2.19e+03     9s
   4  -5.87734481e+05  8.45871838e+07  5.38e+02 6.92e-01  6.84e+02     9s
   5  -5.08716227e+05  4.68271793e+07  2.90e+02 3.04e-01  3.53e+02    10s
   6  -4.30780071e+05  3.36458524e+07  1.18e+02 2.00e-01  1.88e+02    10s
   7  -3.49576878e+05  2.51368371e+07  2.61e+01 1.39e-01  1.01e+02    10s
   8  -2.19862441e+05  1.34272555e+07  1.42e-01 7.54e-02  4.63e+01    10s
   9  -1.36571795e+05  3.57924297e+06  3.86e-02 1.83e-02  1.26e+01    10s
  10  -1.05852088e+05  2.02036332e+06  2.08e-02 1.02e-02  7.20e+00    10s
  11  -9.01281371e+04  1.20260584e+06  1.42e-02 6.22e-03  4.38e+00    10s
  12  -7.62242605e+04  5.61813348e+05  1.02e-02 2.91e-03  2.16e+00    11s
  13  -4.42571650e+04  2.67657409e+05  4.26e-03 1.57e-03  1.06e+00    11s
  14  -2.85730406e+04  1.36690124e+05  2.19e-03 1.51e-03  5.59e-01    11s
  15  -2.31885278e+04  9.31193360e+04  1.74e-03 1.01e-03  3.94e-01    11s
  16  -1.63215931e+04  6.59745322e+04  1.21e-03 6.95e-04  2.79e-01    11s
  17  -1.12220904e+04  4.81269771e+04  8.23e-04 6.88e-04  2.01e-01    12s
  18  -7.68394665e+03  3.90504017e+04  6.24e-04 5.46e-04  1.58e-01    12s
  19  -4.90575798e+03  3.34193542e+04  4.70e-04 4.52e-04  1.30e-01    12s
  20  -2.31878090e+03  2.67789451e+04  3.47e-04 3.46e-04  9.85e-02    12s
  21  -3.59222823e+02  2.06850294e+04  2.64e-04 2.26e-04  7.12e-02    12s
  22   7.27703712e+02  1.69399043e+04  2.23e-04 1.68e-04  5.49e-02    13s
  23   2.19176432e+03  1.45523823e+04  1.70e-04 1.25e-04  4.18e-02    13s
  24   3.83181127e+03  1.24364877e+04  1.14e-04 8.67e-05  2.91e-02    13s
  25   4.85178925e+03  1.09183395e+04  8.11e-05 5.76e-05  2.05e-02    13s
  26   5.21201209e+03  1.01319283e+04  6.92e-05 4.39e-05  1.67e-02    14s
  27   5.84166302e+03  8.93939528e+03  4.89e-05 2.35e-05  1.05e-02    14s
  28   6.05170203e+03  8.74367820e+03  4.28e-05 2.03e-05  9.11e-03    14s
  29   6.53736130e+03  8.57330301e+03  2.87e-05 1.72e-05  6.89e-03    14s
  30   6.75736209e+03  8.20913935e+03  2.24e-05 1.08e-05  4.91e-03    15s
  31   6.97857600e+03  8.08477809e+03  1.63e-05 8.41e-06  3.74e-03    15s
  32   7.08260355e+03  8.01222014e+03  1.34e-05 7.31e-06  3.15e-03    15s
  33   7.15280895e+03  7.89753330e+03  1.14e-05 5.43e-06  2.52e-03    15s
  34   7.25357501e+03  7.83887218e+03  8.42e-06 4.46e-06  1.98e-03    16s
  35   7.33327412e+03  7.81699404e+03  6.28e-06 4.06e-06  1.64e-03    16s
  36   7.35629875e+03  7.74768889e+03  5.61e-06 2.95e-06  1.32e-03    16s
  37   7.36442099e+03  7.71611361e+03  5.39e-06 2.44e-06  1.19e-03    16s
  38   7.38192514e+03  7.70651656e+03  4.90e-06 2.29e-06  1.10e-03    17s
  39   7.41521736e+03  7.69714130e+03  4.05e-06 2.11e-06  9.54e-04    17s
  40   7.44371229e+03  7.64823407e+03  3.22e-06 1.30e-06  6.92e-04    17s
  41   7.46817580e+03  7.63911575e+03  2.60e-06 1.15e-06  5.79e-04    18s
  42   7.51344080e+03  7.61179839e+03  1.47e-06 6.23e-07  3.33e-04    18s
  43   7.53566584e+03  7.59016712e+03  9.12e-07 2.56e-07  1.84e-04    18s
  44   7.54232205e+03  7.58536175e+03  7.26e-07 1.88e-07  1.46e-04    19s
  45   7.54637066e+03  7.58433478e+03  6.31e-07 1.68e-07  1.29e-04    19s
  46   7.55261641e+03  7.58064480e+03  4.84e-07 1.22e-07  9.49e-05    19s
  47   7.56122214e+03  7.57721006e+03  2.84e-07 5.96e-08  5.41e-05    19s
  48   7.56445592e+03  7.57679341e+03  2.07e-07 5.24e-08  4.18e-05    20s
  49   7.57072259e+03  7.57617550e+03  6.64e-08 3.96e-08  1.85e-05    20s
  50   7.57303572e+03  7.57451956e+03  3.08e-08 1.29e-08  5.02e-06    20s
  51   7.57388748e+03  7.57405262e+03  1.76e-08 2.34e-09  5.59e-07    20s
  52   7.57395378e+03  7.57397143e+03  4.45e-08 6.61e-09  5.98e-08    20s
  53   7.57396256e+03  7.57396266e+03  5.81e-10 1.14e-09  3.66e-10    21s
  54   7.57396259e+03  7.57396259e+03  1.91e-08 5.37e-11  8.10e-12    21s

Barrier solved model in 54 iterations and 20.81 seconds (19.40 work units)
Optimal objective 7.57396259e+03


Root crossover log...

  142449 DPushes remaining with DInf 0.0000000e+00                21s
   12291 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

    4172 PPushes remaining with PInf 6.9223297e-06                27s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.9604520e-10     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70305    7.5739626e+03   0.000000e+00   0.000000e+00     28s
   70305    7.5739626e+03   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 4.35s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 7.573963e+03, 70305 iterations, 25.08 seconds (25.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7573.96259    0  238 -211403.45 7573.96259   104%     -   33s
H    0     0                    -44443.00327 7573.96259   117%     -   33s
H    0     0                    -43447.93626 7573.96259   117%     -   33s
H    0     0                    -37787.23127 7573.96259   120%     -   33s
H    0     0                    -20599.54438 7573.96259   137%     -   34s
H    0     0                    -19831.18736 7573.96259   138%     -   34s
     0     0 2358.87161    0  397 -19831.187 2358.87161   112%     -  103s
H    0     0                    -19712.19357 2358.00793   112%     -  104s
     0     0 2316.59607    0  412 -19712.194 2316.59607   112%     -  119s
     0     0 2291.31744    0  405 -19712.194 2291.31744   112%     -  131s
     0     0 2275.42278    0  413 -19712.194 2275.42278   112%     -  137s
     0     0 2275.01004    0  411 -19712.194 2275.01004   112%     -  139s
     0     0 -1553.1749    0  481 -19712.194 -1553.1749  92.1%     -  289s
H    0     0                    -19666.64924 -1554.6230  92.1%     -  290s
     0     0 -1966.4742    0  481 -19666.649 -1966.4742  90.0%     -  352s
     0     0 -2000.1140    0  479 -19666.649 -2000.1140  89.8%     -  365s
     0     0 -2003.6743    0  482 -19666.649 -2003.6743  89.8%     -  371s
     0     0 -2152.3461    0  435 -19666.649 -2152.3461  89.1%     -  401s
     0     0 -2193.8666    0  431 -19666.649 -2193.8666  88.8%     -  417s
     0     0 -2283.6280    0  432 -19666.649 -2283.6280  88.4%     -  429s
     0     0 -2285.8627    0  433 -19666.649 -2285.8627  88.4%     -  433s
     0     0 -2337.7105    0  426 -19666.649 -2337.7105  88.1%     -  436s
     0     0 -2367.2610    0  428 -19666.649 -2367.2610  88.0%     -  444s
     0     0 -2622.0641    0  438 -19666.649 -2622.0641  86.7%     -  455s
     0     0 -2693.4765    0  435 -19666.649 -2693.4765  86.3%     -  464s
     0     0 -2710.2701    0  432 -19666.649 -2710.2701  86.2%     -  468s
     0     0 -2782.0693    0  438 -19666.649 -2782.0693  85.9%     -  475s
     0     0 -2782.9758    0  440 -19666.649 -2782.9758  85.8%     -  477s
     0     0 -4792.4266    0  441 -19666.649 -4792.4266  75.6%     -  556s
H    0     0                    -19571.56051 -4792.7640  75.5%     -  557s
     0     0 -5262.0659    0  458 -19571.561 -5262.0659  73.1%     -  605s
     0     0 -5564.5719    0  462 -19571.561 -5564.5719  71.6%     -  639s
     0     0 -5592.2748    0  457 -19571.561 -5592.2748  71.4%     -  650s
     0     0 -5605.3654    0  455 -19571.561 -5605.3654  71.4%     -  659s
     0     0 -5695.1418    0  469 -19571.561 -5695.1418  70.9%     -  673s
     0     0 -5720.1725    0  485 -19571.561 -5720.1725  70.8%     -  686s
     0     0 -5735.4771    0  482 -19571.561 -5735.4771  70.7%     -  692s
     0     0 -5746.7117    0  486 -19571.561 -5746.7117  70.6%     -  697s
     0     0 -5754.4706    0  488 -19571.561 -5754.4706  70.6%     -  704s
     0     0 -5757.9213    0  493 -19571.561 -5757.9213  70.6%     -  709s
     0     0 -5906.1957    0  478 -19571.561 -5906.1957  69.8%     -  723s
     0     0 -5975.6254    0  489 -19571.561 -5975.6254  69.5%     -  731s
     0     0 -5984.5040    0  490 -19571.561 -5984.5040  69.4%     -  735s
     0     0 -6154.4440    0  482 -19571.561 -6154.4440  68.6%     -  752s
     0     0 -6282.2734    0  494 -19571.561 -6282.2734  67.9%     -  778s
     0     0 -6306.3916    0  499 -19571.561 -6306.3916  67.8%     -  801s
     0     0 -6314.8963    0  503 -19571.561 -6314.8963  67.7%     -  806s
     0     0 -6319.6041    0  497 -19571.561 -6319.6041  67.7%     -  811s
     0     0 -6320.8098    0  504 -19571.561 -6320.8098  67.7%     -  814s
     0     0 -7110.5075    0  484 -19571.561 -7110.5075  63.7%     -  885s
     0     0 -7252.9079    0  491 -19571.561 -7252.9079  62.9%     -  924s
     0     0 -7416.8741    0  504 -19571.561 -7416.8741  62.1%     -  978s
     0     0 -7518.5620    0  512 -19571.561 -7518.5620  61.6%     - 1023s
     0     0 -7539.6908    0  495 -19571.561 -7539.6908  61.5%     - 1058s
     0     0 -7575.6991    0  499 -19571.561 -7575.6991  61.3%     - 1085s
     0     0 -7607.7676    0  506 -19571.561 -7607.7676  61.1%     - 1101s
     0     0 -7641.5104    0  488 -19571.561 -7641.5104  61.0%     - 1124s
     0     0 -7651.6208    0  496 -19571.561 -7651.6208  60.9%     - 1144s
     0     0 -7656.8449    0  506 -19571.561 -7656.8449  60.9%     - 1157s
     0     0 -7658.8651    0  505 -19571.561 -7658.8651  60.9%     - 1165s
     0     0 -7919.4156    0  510 -19571.561 -7919.4156  59.5%     - 1250s
H    0     0                    -19482.73743 -7919.4743  59.4%     - 1252s
     0     0 -8023.7218    0  516 -19482.737 -8023.7218  58.8%     - 1316s
     0     0 -8064.9772    0  510 -19482.737 -8064.9772  58.6%     - 1358s
     0     0 -8069.9957    0  512 -19482.737 -8069.9957  58.6%     - 1371s
     0     0 -8076.7676    0  507 -19482.737 -8076.7676  58.5%     - 1385s
     0     0 -8079.8035    0  515 -19482.737 -8079.8035  58.5%     - 1393s
     0     0 -8091.1556    0  513 -19482.737 -8091.1556  58.5%     - 1406s
     0     0 -8107.9281    0  557 -19482.737 -8107.9281  58.4%     - 1425s
     0     0 -8111.8892    0  561 -19482.737 -8111.8892  58.4%     - 1443s
     0     0 -8114.2741    0  563 -19482.737 -8114.2741  58.4%     - 1455s
     0     0 -8233.2896    0  490 -19482.737 -8233.2896  57.7%     - 1499s
H    0     0                    -19369.51168 -8233.5362  57.5%     - 1512s
H    0     0                    -19190.45593 -8233.5362  57.1%     - 1513s
H    0     0                    -19180.92597 -8233.5362  57.1%     - 1515s
     0     0 -8265.4958    0  496 -19180.926 -8265.4958  56.9%     - 1556s
     0     0 -8286.7773    0  516 -19180.926 -8286.7773  56.8%     - 1596s
     0     0 -8298.4970    0  502 -19180.926 -8298.4970  56.7%     - 1610s
     0     0 -8299.8889    0  512 -19180.926 -8299.8889  56.7%     - 1617s
     0     0 -8353.4061    0  504 -19180.926 -8353.4061  56.4%     - 1671s
H    0     0                    -19153.84673 -8353.5158  56.4%     - 1673s
     0     0 -8373.2682    0  490 -19153.847 -8373.2682  56.3%     - 1697s
     0     0 -8379.5442    0  502 -19153.847 -8379.5442  56.3%     - 1706s
     0     0 -8382.8022    0  516 -19153.847 -8382.8022  56.2%     - 1711s
     0     0 -8384.0191    0  507 -19153.847 -8384.0191  56.2%     - 1715s
     0     0 -8401.6768    0  500 -19153.847 -8401.6768  56.1%     - 1745s
H    0     0                    -19104.58922 -8401.7955  56.0%     - 1750s
     0     0 -8419.5738    0  496 -19104.589 -8419.5738  55.9%     - 1763s
     0     0 -8426.3647    0  495 -19104.589 -8426.3647  55.9%     - 1776s
     0     0 -8429.4183    0  505 -19104.589 -8429.4183  55.9%     - 1784s
     0     0 -8429.9510    0  517 -19104.589 -8429.9510  55.9%     - 1787s
     0     0 -8442.1313    0  501 -19104.589 -8442.1313  55.8%     - 1811s
     0     0 -8447.3148    0  509 -19104.589 -8447.3148  55.8%     - 1823s
     0     0 -8447.8949    0  528 -19104.589 -8447.8949  55.8%     - 1828s
     0     0 -8453.4540    0  527 -19104.589 -8453.4540  55.8%     - 1848s
H    0     0                    -18873.97302 -8453.4618  55.2%     - 1872s
H    0     0                    -18840.95297 -8453.4618  55.1%     - 1877s
     0     0 -8456.7264    0  531 -18840.953 -8456.7264  55.1%     - 1887s
     0     0 -8457.4824    0  533 -18840.953 -8457.4824  55.1%     - 1891s
     0     0 -8463.0267    0  523 -18840.953 -8463.0267  55.1%     - 1903s
     0     0 -8463.0369    0  523 -18840.953 -8463.0369  55.1%     - 1920s
H    0     0                    -18667.56522 -8463.0555  54.7%     - 2020s
H    0     0                    -18640.48598 -8463.0555  54.6%     - 2020s
H    0     0                    -15783.19866 -8463.0555  46.4%     - 2125s
     0     2 -8463.0555    0  523 -15783.199 -8463.0555  46.4%     - 2130s
     1     3 -8865.1243    1  471 -15783.199 -8463.0666  46.4% 18886 2188s
     2     4 -8557.1219    1  509 -15783.199 -8557.1219  45.8% 12595 2211s
     3     7 -9465.2564    2  393 -15783.199 -8557.1253  45.8% 10524 2251s
     6    12 -9868.8831    3  372 -15783.199 -8557.1778  45.8%  9435 2304s
    11    24 -9087.1742    3  418 -15783.199 -8584.3230  45.6% 12265 2338s
    23    36 -9171.4902    4  423 -15783.199 -8741.7799  44.6% 17511 2442s
    35    67 -10707.357    5  380 -15783.199 -8741.7799  44.6% 21476 2875s
H   38    67                    -15742.88853 -8741.7799  44.5% 21129 2875s
H   39    67                    -15741.62993 -8741.7799  44.5% 20775 2875s
H   43    67                    -15706.63384 -8741.7799  44.3% 19441 2875s
H   55    67                    -15700.69711 -8741.7799  44.3% 17012 2875s
    66   161 -11193.570    6  364 -15700.697 -8878.6181  43.5% 25688 3009s
   166   187 -11357.250    8  357 -15700.697 -8878.6181  43.5% 15270 3067s
H  168   187                    -15699.53978 -8878.6181  43.4% 15112 3067s
   194   234 -11504.712    9  341 -15699.540 -8878.6181  43.4% 14285 3126s
   287   252 -12477.854   11  313 -15699.540 -8878.6181  43.4% 12099 3171s
   374   247 -12499.697   12  317 -15699.540 -8878.6181  43.4% 10841 3212s
   423   256 infeasible   12      -15699.540 -9157.3749  41.7% 10532 3255s
   458   281 -11790.629   11  392 -15699.540 -9157.3749  41.7% 10690 3297s
   506   302 -11117.207    9  416 -15699.540 -9157.3749  41.7% 10968 3336s
   571   312 -11301.843   10  391 -15699.540 -9157.3749  41.7% 10686 3375s
   631   324 -14143.014   18  309 -15699.540 -9157.3749  41.7% 10616 3413s
   691   324 -11248.430   10  402 -15699.540 -9157.3749  41.7% 10429 3453s
   755   344 -14179.784   20  303 -15699.540 -9157.3749  41.7% 10135 3491s
   797   374 -14739.055   22  235 -15699.540 -9157.3749  41.7% 10162 3527s
   857   386 -14947.248   24  211 -15699.540 -9157.3749  41.7% 10117 3558s
   891   394 -15026.518   24  277 -15699.540 -9157.3749  41.7% 10007 3597s
   947   395 -14908.250   20  236 -15699.540 -9157.3749  41.7%  9849 3600s

Cutting planes:
  Learned: 1
  Implied bound: 232
  MIR: 4459
  Flow cover: 3500
  Zero half: 1
  RLT: 84
  Relax-and-lift: 735

Explored 956 nodes (10187128 simplex iterations) in 3600.09 seconds (4525.47 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15699.5 -15706.6 -15741.6 ... -19104.6

Time limit reached
Best objective -1.569953978148e+04, best bound -9.157374899541e+03, gap 41.6711%
  WARNING: Time limit reached. Using best solution found (gap: 41.67%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -15699.54, θ = 102140.94
  Upper Bound (UB) = -15699.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 102140.94
  [DEBUG]   ✓ Scenario 0: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 102140.94 ≤ Q = 102140.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 102140.94 ≤ Q = 102140.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6d8b0d2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x06d8b0d2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.261995e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6508264.7263
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.371956e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137195.62    0  126 6508264.73 -137195.62   102%     -    0s
H    0     0                    -99815.29067 -137195.62  37.4%     -    0s
H    0     0                    -100229.9833 -137195.62  36.9%     -    0s
     0     0 -106595.66    0  136 -100229.98 -106595.66  6.35%     -    0s
H    0     0                    -103350.7768 -106486.65  3.03%     -    0s
     0     0 -106115.64    0  141 -103350.78 -106115.64  2.68%     -    0s
     0     0 -106103.71    0  141 -103350.78 -106103.71  2.66%     -    0s
     0     0 -105845.71    0  142 -103350.78 -105845.71  2.41%     -    0s
H    0     0                    -103603.5595 -105841.65  2.16%     -    0s
H    0     0                    -103833.9700 -105841.65  1.93%     -    0s
     0     0 -105841.65    0  142 -103833.97 -105841.65  1.93%     -    0s
     0     0 -105686.93    0  143 -103833.97 -105686.93  1.78%     -    0s
     0     0 -105667.07    0  143 -103833.97 -105667.07  1.77%     -    0s
     0     2 -105661.02    0  143 -103833.97 -105661.02  1.76%     -    0s
H   31    64                    -104053.4984 -105359.67  1.26%  12.8    0s
H   41    64                    -104223.3967 -105359.67  1.09%  12.8    0s
H   42    64                    -104444.6941 -105359.67  0.88%  12.6    0s
H   50    62                    -104708.5934 -105271.68  0.54%  12.3    0s
H  115   112                    -104720.9100 -105268.93  0.52%  10.6    0s
H  150   112                    -104745.8361 -105268.93  0.50%   9.6    0s
H  546   166                    -104773.0023 -105268.93  0.47%   7.1    0s
*  910   186              22    -104800.8194 -105100.30  0.29%   6.5    0s
* 1139    98              20    -104805.7417 -104998.00  0.18%   6.4    0s
* 1225    98              26    -104821.6680 -104998.00  0.17%   6.3    0s
* 1441     6              23    -104838.9508 -104870.94  0.03%   6.0    0s
* 1452     6              23    -104851.7980 -104870.94  0.02%   6.0    0s

Cutting planes:
  Gomory: 67
  MIR: 253

Explored 1496 nodes (9365 simplex iterations) in 0.38 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -104852 -104839 -104822 ... -104445
No other solutions better than -104852

Optimal solution found (tolerance 1.00e-04)
Best objective -1.048517980073e+05, best bound -1.048517980073e+05, gap 0.0000%
  Subproblem solved in 0.42s
  Worst-case operational profit (Z_SP) = 101136.62
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104851.80
  [DEBUG]   S×d_nominal = 205988.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205988.41 + -104851.80 = 101136.62
  [DEBUG]   Current θ from Master = 102140.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1004.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16703.87
  Lower Bound (LB) = -16703.87
  Gap (UB-LB) = 1004.3258, Absolute Gap = 1004.3258, Relative Gap = 0.063972
  Not converged yet (gap = 1004.33 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827307 nonzeros
Model fingerprint: 0xd79a9ee5
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120897 rows and 49077 columns (presolve time = 5s)...
Presolve removed 120897 rows and 49077 columns
Presolve time: 5.80s
Presolved: 170996 rows, 71743 columns, 1050400 nonzeros
Variable types: 69484 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -407599.3033
Found heuristic solution: objective -211403.4485

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.70s

Barrier statistics:
 Dense cols : 723
 AA' NZ     : 8.706e+06
 Factor NZ  : 2.016e+07 (roughly 260 MB of memory)
 Factor Ops : 5.455e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55266652e+07  2.70851327e+08  8.13e+04 1.74e+01  6.39e+04     9s
   1  -1.18765341e+07  2.32893304e+08  5.71e+04 4.78e+01  4.48e+04     9s
   2  -5.17526653e+06  1.84988438e+08  2.42e+04 3.44e+01  1.95e+04    10s
   3  -9.36132958e+05  1.28830418e+08  1.42e+03 6.43e-01  1.51e+03    10s
   4  -6.06597181e+05  7.78052734e+07  3.96e+02 2.79e-01  5.33e+02    10s
   5  -5.26799905e+05  4.41576377e+07  2.22e+02 1.25e-01  2.84e+02    10s
   6  -4.33905001e+05  3.01873132e+07  8.95e+01 7.68e-02  1.50e+02    10s
   7  -3.17204105e+05  2.24557035e+07  1.99e+01 5.17e-02  8.32e+01    10s
   8  -2.21153988e+05  1.49185705e+07  5.87e+00 3.33e-02  5.09e+01    11s
   9  -1.47661770e+05  7.38304879e+06  1.89e+00 1.57e-02  2.46e+01    11s
  10  -1.24425509e+05  3.89072244e+06  1.18e+00 8.51e-03  1.30e+01    11s
  11  -1.05635814e+05  2.83526359e+06  7.53e-01 6.15e-03  9.51e+00    11s
  12  -9.84033627e+04  2.03083829e+06  5.98e-01 4.38e-03  6.87e+00    11s
  13  -8.19323857e+04  1.40304084e+06  3.29e-01 3.04e-03  4.78e+00    11s
  14  -6.02900502e+04  3.45761662e+05  1.37e-01 6.57e-04  1.31e+00    12s
  15  -4.44232236e+04  1.90454404e+05  7.56e-02 7.77e-04  7.55e-01    12s
  16  -3.21428488e+04  1.14953818e+05  4.90e-02 1.74e-03  4.73e-01    12s
  17  -2.54565783e+04  8.55264434e+04  3.98e-02 2.02e-03  3.57e-01    12s
  18  -2.18007905e+04  7.14484040e+04  3.43e-02 1.25e-03  3.00e-01    12s
  19  -1.88794458e+04  6.13811342e+04  3.01e-02 1.00e-03  2.58e-01    13s
  20  -1.39616291e+04  4.73366161e+04  2.33e-02 7.50e-04  1.97e-01    13s
  21  -1.15423054e+04  3.98239660e+04  2.00e-02 6.29e-04  1.65e-01    13s
  22  -7.54397112e+03  3.14836453e+04  1.49e-02 4.92e-04  1.25e-01    13s
  23  -5.35718881e+03  2.52701769e+04  1.23e-02 3.73e-04  9.84e-02    14s
  24  -2.61979883e+03  1.94650322e+04  9.20e-03 2.50e-04  7.10e-02    14s
  25  -6.41643148e+02  1.67484110e+04  7.16e-03 2.01e-04  5.59e-02    14s
  26   5.94031657e+02  1.36958602e+04  5.93e-03 1.48e-04  4.21e-02    14s
  27   1.77640056e+03  1.19237020e+04  4.85e-03 1.06e-04  3.26e-02    14s
  28   2.23804559e+03  1.05196835e+04  4.43e-03 8.78e-05  2.66e-02    15s
  29   2.79694048e+03  1.00509594e+04  3.94e-03 8.21e-05  2.33e-02    15s
  30   3.83797586e+03  9.27069047e+03  3.04e-03 5.62e-05  1.75e-02    15s
  31   4.46998729e+03  8.49629943e+03  2.51e-03 6.91e-05  1.29e-02    15s
  32   5.31179969e+03  8.00279285e+03  1.73e-03 5.19e-05  8.65e-03    16s
  33   5.44379504e+03  7.95678013e+03  1.62e-03 4.96e-05  8.08e-03    16s
  34   6.15789276e+03  7.83496644e+03  1.02e-03 3.84e-05  5.39e-03    16s
  35   6.57334750e+03  7.64133446e+03  6.63e-04 3.96e-05  3.43e-03    16s
  36   6.61610570e+03  7.58966818e+03  6.26e-04 3.16e-05  3.13e-03    17s
  37   6.66459103e+03  7.54685458e+03  5.86e-04 2.52e-05  2.84e-03    17s
  38   6.79668843e+03  7.49958005e+03  4.72e-04 1.90e-05  2.26e-03    17s
  39   6.96842836e+03  7.46972790e+03  3.26e-04 2.37e-05  1.61e-03    17s
  40   7.03402377e+03  7.45054739e+03  2.71e-04 2.00e-05  1.34e-03    18s
  41   7.05538490e+03  7.44729944e+03  2.53e-04 1.95e-05  1.26e-03    18s
  42   7.10837632e+03  7.42822755e+03  2.06e-04 1.53e-05  1.03e-03    18s
  43   7.13957783e+03  7.41946880e+03  1.80e-04 1.35e-05  9.00e-04    19s
  44   7.17391136e+03  7.40073135e+03  1.51e-04 9.30e-06  7.29e-04    19s
  45   7.23140137e+03  7.38459098e+03  1.01e-04 6.35e-06  4.92e-04    19s
  46   7.24059763e+03  7.37117045e+03  9.27e-05 3.34e-06  4.20e-04    19s
  47   7.27703678e+03  7.36569987e+03  6.13e-05 2.27e-06  2.85e-04    20s
  48   7.30238479e+03  7.36425635e+03  4.13e-05 1.99e-06  1.99e-04    20s
  49   7.32192814e+03  7.36033583e+03  2.46e-05 1.34e-06  1.23e-04    20s
  50   7.33258881e+03  7.35710082e+03  1.55e-05 7.96e-07  7.88e-05    20s
  51   7.33731568e+03  7.35515193e+03  1.17e-05 4.87e-07  5.73e-05    21s
  52   7.34248816e+03  7.35443373e+03  7.72e-06 8.33e-07  3.84e-05    21s
  53   7.34610876e+03  7.35404851e+03  4.90e-06 6.65e-07  2.55e-05    21s
  54   7.34683393e+03  7.35374452e+03  4.29e-06 6.18e-07  2.22e-05    22s
  55   7.35147210e+03  7.35255499e+03  5.73e-07 3.88e-07  3.48e-06    22s
  56   7.35180324e+03  7.35245690e+03  3.56e-07 2.00e-07  2.10e-06    22s
  57   7.35226598e+03  7.35235286e+03  5.15e-08 3.96e-08  2.79e-07    23s
  58   7.35233824e+03  7.35234513e+03  2.41e-07 2.18e-08  2.21e-08    23s
  59   7.35234213e+03  7.35234439e+03  2.02e-07 1.26e-08  7.27e-09    23s
  60   7.35234323e+03  7.35234439e+03  5.88e-07 1.07e-07  3.70e-09    23s
  61   7.35234426e+03  7.35234439e+03  8.07e-08 8.86e-09  3.83e-10    24s
  62   7.35234436e+03  7.35234439e+03  3.59e-08 1.64e-09  9.59e-11    24s

Barrier solved model in 62 iterations and 23.79 seconds (22.10 work units)
Optimal objective 7.35234436e+03


Root crossover log...

  138147 DPushes remaining with DInf 0.0000000e+00                24s
   70883 DPushes remaining with DInf 0.0000000e+00                25s
   20200 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                34s

    6300 PPushes remaining with PInf 2.1138739e-05                34s
       0 PPushes remaining with PInf 0.0000000e+00                35s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.1501553e-01     35s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66952    7.3523444e+03   0.000000e+00   8.150155e-01     35s
   66953    7.3523444e+03   0.000000e+00   0.000000e+00     35s
   66953    7.3523444e+03   0.000000e+00   0.000000e+00     35s
Concurrent spin time: 6.97s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 7.352344e+03, 66953 iterations, 34.93 seconds (38.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7352.34439    0  407 -211403.45 7352.34439   103%     -   44s
H    0     0                    -95733.99065 7352.34439   108%     -   44s
H    0     0                    -90945.84534 7352.34439   108%     -   44s
H    0     0                    -30535.55041 7352.34439   124%     -   44s
H    0     0                    -30533.36668 7352.34439   124%     -   44s
H    0     0                    -30518.99430 7352.34439   124%     -   44s
H    0     0                    -19428.77443 7352.34439   138%     -   45s
H    0     0                    -19247.03630 7352.34439   138%     -   45s
H    0     0                    -19217.11007 7352.34439   138%     -   45s
     0     0 1417.53379    0  395 -19217.110 1417.53379   107%     -  129s
H    0     0                    -19035.28638 1376.40510   107%     -  130s
H    0     0                    -18899.03475 1376.40510   107%     -  130s
     0     0 1186.79955    0  406 -18899.035 1186.79955   106%     -  155s
     0     0 1161.92447    0  407 -18899.035 1161.92447   106%     -  166s
     0     0 1105.37192    0  412 -18899.035 1105.37192   106%     -  178s
     0     0 1027.73082    0  419 -18899.035 1027.73082   105%     -  200s
     0     0  989.86931    0  429 -18899.035  989.86931   105%     -  214s
     0     0  858.98017    0  427 -18899.035  858.98017   105%     -  227s
     0     0  856.95233    0  426 -18899.035  856.95233   105%     -  230s
     0     0  693.72707    0  425 -18899.035  693.72707   104%     -  240s
     0     0  679.20281    0  434 -18899.035  679.20281   104%     -  245s
     0     0  528.53440    0  430 -18899.035  528.53440   103%     -  253s
     0     0  512.32026    0  426 -18899.035  512.32026   103%     -  257s
     0     0  508.46070    0  427 -18899.035  508.46070   103%     -  258s
     0     0  507.36423    0  430 -18899.035  507.36423   103%     -  261s
     0     0  502.72018    0  431 -18899.035  502.72018   103%     -  262s
     0     0  475.60358    0  429 -18899.035  475.60358   103%     -  264s
     0     0  471.83026    0  430 -18899.035  471.83026   102%     -  266s
     0     0  471.80716    0  430 -18899.035  471.80716   102%     -  267s
     0     0 -2603.6985    0  449 -18899.035 -2603.6985  86.2%     -  352s
H    0     0                    -18880.39719 -2604.3443  86.2%     -  354s
     0     0 -3017.2181    0  463 -18880.397 -3017.2181  84.0%     -  409s
     0     0 -3017.2181    0  463 -18880.397 -3017.2181  84.0%     -  410s
     0     0 -3084.1917    0  454 -18880.397 -3084.1917  83.7%     -  433s
     0     0 -3293.9289    0  462 -18880.397 -3293.9289  82.6%     -  468s
     0     0 -3526.3057    0  475 -18880.397 -3526.3057  81.3%     -  500s
     0     0 -3635.5977    0  479 -18880.397 -3635.5977  80.7%     -  517s
     0     0 -3696.6720    0  484 -18880.397 -3696.6720  80.4%     -  531s
     0     0 -3716.4834    0  500 -18880.397 -3716.4834  80.3%     -  542s
     0     0 -3831.5142    0  495 -18880.397 -3831.5142  79.7%     -  562s
     0     0 -3844.3609    0  503 -18880.397 -3844.3609  79.6%     -  569s
     0     0 -3899.3684    0  495 -18880.397 -3899.3684  79.3%     -  585s
     0     0 -3905.1077    0  487 -18880.397 -3905.1077  79.3%     -  592s
     0     0 -3913.7023    0  492 -18880.397 -3913.7023  79.3%     -  597s
     0     0 -3916.9643    0  489 -18880.397 -3916.9643  79.3%     -  599s
     0     0 -3917.2969    0  491 -18880.397 -3917.2969  79.3%     -  600s
     0     0 -5812.6704    0  502 -18880.397 -5812.6704  69.2%     -  742s
     0     0 -6176.9165    0  480 -18880.397 -6176.9165  67.3%     -  800s
     0     0 -6376.1893    0  495 -18880.397 -6376.1893  66.2%     -  844s
     0     0 -6441.9847    0  486 -18880.397 -6441.9847  65.9%     -  882s
     0     0 -6514.8904    0  497 -18880.397 -6514.8904  65.5%     -  918s
     0     0 -6600.9442    0  495 -18880.397 -6600.9442  65.0%     -  960s
     0     0 -6695.4017    0  488 -18880.397 -6695.4017  64.5%     - 1011s
     0     0 -6726.2362    0  497 -18880.397 -6726.2362  64.4%     - 1033s
     0     0 -6765.9444    0  483 -18880.397 -6765.9444  64.2%     - 1053s
     0     0 -6781.1034    0  484 -18880.397 -6781.1034  64.1%     - 1064s
     0     0 -6790.6010    0  493 -18880.397 -6790.6010  64.0%     - 1074s
     0     0 -6792.4308    0  497 -18880.397 -6792.4308  64.0%     - 1082s
     0     0 -7467.5302    0  487 -18880.397 -7467.5302  60.4%     - 1198s
H    0     0                    -18867.05619 -7467.5495  60.4%     - 1199s
H    0     0                    -18840.95297 -7467.5495  60.4%     - 1200s
     0     0 -7637.3887    0  510 -18840.953 -7637.3887  59.5%     - 1247s
     0     0 -7779.7629    0  518 -18840.953 -7779.7629  58.7%     - 1288s
     0     0 -7819.6551    0  513 -18840.953 -7819.6551  58.5%     - 1313s
     0     0 -7892.6625    0  514 -18840.953 -7892.6625  58.1%     - 1348s
     0     0 -7921.2556    0  559 -18840.953 -7921.2556  58.0%     - 1379s
     0     0 -7927.4678    0  518 -18840.953 -7927.4678  57.9%     - 1393s
     0     0 -7928.4163    0  523 -18840.953 -7928.4163  57.9%     - 1397s
     0     0 -8191.0188    0  488 -18840.953 -8191.0188  56.5%     - 1479s
     0     0 -8285.9982    0  492 -18840.953 -8285.9982  56.0%     - 1528s
     0     0 -8299.7409    0  493 -18840.953 -8299.7409  55.9%     - 1549s
     0     0 -8310.8690    0  490 -18840.953 -8310.8690  55.9%     - 1568s
     0     0 -8327.2843    0  474 -18840.953 -8327.2843  55.8%     - 1588s
     0     0 -8350.8577    0  477 -18840.953 -8350.8577  55.7%     - 1624s
     0     0 -8358.0090    0  494 -18840.953 -8358.0090  55.6%     - 1640s
     0     0 -8360.3728    0  491 -18840.953 -8360.3728  55.6%     - 1647s
     0     0 -8444.2337    0  561 -18840.953 -8444.2337  55.2%     - 1708s
     0     0 -8484.8784    0  552 -18840.953 -8484.8784  55.0%     - 1738s
     0     0 -8489.2166    0  546 -18840.953 -8489.2166  54.9%     - 1752s
     0     0 -8496.8786    0  548 -18840.953 -8496.8786  54.9%     - 1767s
     0     0 -8516.9066    0  549 -18840.953 -8516.9066  54.8%     - 1790s
     0     0 -8522.7937    0  552 -18840.953 -8522.7937  54.8%     - 1803s
     0     0 -8535.5974    0  476 -18840.953 -8535.5974  54.7%     - 1819s
     0     0 -8548.3188    0  499 -18840.953 -8548.3188  54.6%     - 1839s
     0     0 -8555.1155    0  518 -18840.953 -8555.1155  54.6%     - 1853s
     0     0 -8562.9239    0  567 -18840.953 -8562.9239  54.6%     - 1870s
     0     0 -8568.5999    0  510 -18840.953 -8568.5999  54.5%     - 1885s
     0     0 -8570.0209    0  498 -18840.953 -8570.0209  54.5%     - 1892s
     0     0 -8616.7691    0  557 -18840.953 -8616.7691  54.3%     - 1926s
     0     0 -8626.5196    0  500 -18840.953 -8626.5196  54.2%     - 1944s
     0     0 -8630.4557    0  558 -18840.953 -8630.4557  54.2%     - 1957s
     0     0 -8632.7062    0  563 -18840.953 -8632.7062  54.2%     - 1962s
     0     0 -8667.7896    0  499 -18840.953 -8667.7896  54.0%     - 1987s
     0     0 -8676.8641    0  495 -18840.953 -8676.8641  53.9%     - 2009s
     0     0 -8679.8696    0  492 -18840.953 -8679.8696  53.9%     - 2019s
     0     0 -8681.7189    0  498 -18840.953 -8681.7189  53.9%     - 2026s
     0     0 -8694.3213    0  485 -18840.953 -8694.3213  53.9%     - 2046s
     0     0 -8698.4876    0  481 -18840.953 -8698.4876  53.8%     - 2055s
     0     0 -8702.4594    0  487 -18840.953 -8702.4594  53.8%     - 2062s
     0     0 -8703.9599    0  489 -18840.953 -8703.9599  53.8%     - 2066s
     0     0 -8710.6210    0  494 -18840.953 -8710.6210  53.8%     - 2080s
     0     0 -8712.8740    0  499 -18840.953 -8712.8740  53.8%     - 2087s
     0     0 -8729.1107    0  507 -18840.953 -8729.1107  53.7%     - 2111s
     0     0 -8729.8256    0  507 -18840.953 -8729.8256  53.7%     - 2131s
H    0     0                    -17899.01300 -8729.8256  51.2%     - 2342s
H    0     0                    -17697.10068 -8729.8256  50.7%     - 2342s
H    0     0                    -17690.00662 -8729.8256  50.7%     - 2343s
H    0     0                    -17508.14720 -8729.8256  50.1%     - 2343s
     0     2 -8729.8256    0  507 -17508.147 -8729.8256  50.1%     - 2347s
     1     3 -9289.8785    1  437 -17508.147 -8729.9215  50.1% 22371 2430s
     2     4 -8970.5706    1  487 -17508.147 -8970.5706  48.8% 21358 2484s
     3     7 -9619.0734    2  483 -17508.147 -8970.6181  48.8% 19353 2541s
     6    13 -9713.0931    3  468 -17508.147 -8970.7546  48.8% 17650 2594s
    12    24 -9474.2348    4  496 -17508.147 -9159.9590  47.7% 14074 2626s
    25    33 -9753.5168    5  417 -17508.147 -9326.6543  46.7% 16491 2705s
    36    54 infeasible    5      -17508.147 -9326.6543  46.7% 17183 3099s
H   37    54                    -17289.52398 -9326.6543  46.1% 16719 3099s
    59    84 -10320.818    7  423 -17289.524 -9326.6543  46.1% 24275 3197s
    89   169 -10739.212    8  404 -17289.524 -9326.6543  46.1% 21678 3296s
H   90   169                    -17274.43914 -9326.6543  46.0% 21437 3296s
H   95   169                    -17064.26673 -9326.6543  45.3% 20683 3296s
H  102   169                    -16995.59380 -9326.6543  45.1% 20111 3296s
   181   226 -10875.855    9  415 -16995.594 -9326.6543  45.1% 15562 3360s
   248   253 -13625.836   10  387 -16995.594 -9326.6543  45.1% 13329 3417s
H  252   253                    -16937.62922 -9326.6543  44.9% 13300 3417s
H  272   253                    -16936.82581 -9326.6543  44.9% 12960 3417s
H  299   253                    -16935.99705 -9326.6543  44.9% 12974 3417s
   304   271 -13630.736   11  377 -16935.997 -9326.6543  44.9% 12916 3469s
   352   303 -14394.305   12  377 -16935.997 -9326.6543  44.9% 12423 3519s
H  362   303                    -16924.14927 -9326.6543  44.9% 12467 3519s
H  374   303                    -16889.92946 -9326.6543  44.8% 12305 3519s
   412   301     cutoff   13      -16889.929 -9326.6543  44.8% 12320 3567s
H  438   301                    -16887.13659 -9326.6543  44.8% 12096 3567s
H  446   301                    -16883.49196 -9326.6543  44.8% 11987 3567s
   454   314     cutoff   12      -16883.492 -9326.6543  44.8% 11891 3600s

Cutting planes:
  Implied bound: 295
  MIR: 4906
  Flow cover: 3557
  RLT: 118
  Relax-and-lift: 654

Explored 508 nodes (6731467 simplex iterations) in 3600.12 seconds (4426.43 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -16883.5 -16887.1 -16889.9 ... -17274.4

Time limit reached
Best objective -1.688349195859e+04, best bound -9.326654313452e+03, gap 44.7587%
  WARNING: Time limit reached. Using best solution found (gap: 44.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = -16883.49, θ = 101002.19
  Upper Bound (UB) = -16883.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 101002.19
  [DEBUG]   ✓ Scenario 0: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 101002.19 ≤ Q = 101002.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 101002.19 ≤ Q = 101002.19 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xecc5d27
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0ecc5d27
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.252417e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6366290.6934
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.384619e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138461.86    0  126 6366290.69 -138461.86   102%     -    0s
H    0     0                    -101024.1075 -138461.86  37.1%     -    0s
H    0     0                    -101480.6487 -138461.86  36.4%     -    0s
     0     0 -116793.79    0   72 -101480.65 -116793.79  15.1%     -    0s
H    0     0                    -114813.5889 -116713.66  1.65%     -    0s
H    0     0                    -115089.5139 -116713.66  1.41%     -    0s
H    0     0                    -115287.1581 -116713.66  1.24%     -    0s
H    0     0                    -115563.0831 -116713.66  1.00%     -    0s
     0     0 -116067.06    0   62 -115563.08 -116067.06  0.44%     -    0s
     0     0 -116012.91    0   56 -115563.08 -116012.91  0.39%     -    0s
     0     0 -115992.48    0   55 -115563.08 -115992.48  0.37%     -    0s
     0     0 -115766.00    0   23 -115563.08 -115766.00  0.18%     -    0s
     0     0 -115764.23    0   20 -115563.08 -115764.23  0.17%     -    0s
     0     0 -115716.06    0   11 -115563.08 -115716.06  0.13%     -    0s
     0     0 -115655.66    0    9 -115563.08 -115655.66  0.08%     -    0s
     0     0 -115655.66    0   13 -115563.08 -115655.66  0.08%     -    0s
     0     0          -    0      -115563.08 -115574.13  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 5
  MIR: 6
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 4

Explored 1 nodes (780 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -115563 -115487 -115287 ... 1.25242e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.155630830916e+05, best bound -1.155741299731e+05, gap 0.0096%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 90687.27
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115563.08
  [DEBUG]   S×d_nominal = 206250.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206250.35 + -115563.08 = 90687.27
  [DEBUG]   Current θ from Master = 101002.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10314.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27198.41
  Lower Bound (LB) = -16703.87
  Gap (UB-LB) = -179.6264, Absolute Gap = 179.6264, Relative Gap = -0.010639
  *** CONVERGED (small negative gap: -179.63 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 19
Total Time: 49687.30s
Converged: True
Final Lower Bound: -16703.8656
Final Upper Bound: -16883.4920
Final Gap: -179.626355
Number of Critical Scenarios: 19
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 5, 8] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 4 customers  Mode 1: 13 customers  Mode 2: 33 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 19
Start Time: 2026-01-05 15:25:04
End Time: 2026-01-06 05:13:11
Total Time: 49687.30s
Optimal Value: -16703.87
Lower Bound: -16703.87
Upper Bound: -16883.49
Gap: -179.626355
Plants Opened: {0: [1], 1: [0], 2: [1]} (3 plants)
DCs Opened: [2, 5, 8] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed40_LD_gamma20_20260106_051312.csv

Total Execution Time: 49687.78 seconds
End Time: 2026-01-06 05:13:12

All tasks completed successfully!

