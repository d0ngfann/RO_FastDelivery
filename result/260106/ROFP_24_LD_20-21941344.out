
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 24
DI Scenario: LD
Start Time: 2026-01-04 12:31:03
================================================================================
Loading data from data/DH_data_full_seed24.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.019', '1.038'] (k=0.045)
  Product 1: ['1.000', '1.001', '1.001'] (k=0.001)
  Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=993, max=1652
  DC capacity (MC): min=447, max=853

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.89, count=87
  Deviation (μ̂): min=4.03, max=9.95

Costs:
  Plant fixed cost: min=5996, max=9615
  DC fixed cost: min=3150, max=5670
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.499', '2.248'] (k=0.999)
    Product 2: ['1.000', '1.406', '1.976'] (k=0.840)
  MD:
    Product 0: ['1.000', '1.251', '1.565'] (k=0.553)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.267', '1.606'] (k=0.584)
  LD:
    Product 0: ['1.000', '1.019', '1.038'] (k=0.045)
    Product 1: ['1.000', '1.001', '1.001'] (k=0.001)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
  Mixed:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0x3be49bf2
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.12s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -315020.6082
Found heuristic solution: objective -195802.1610

Root relaxation: objective 5.410373e+04, 4828 iterations, 0.25 seconds (0.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54103.7317    0  570 -195802.16 54103.7317   128%     -    0s
     0     0 52435.8866    0  993 -195802.16 52435.8866   127%     -    1s
H    0     0                    -172579.1723 52433.5074   130%     -    1s
H    0     0                    -171940.8104 52433.5074   130%     -    1s
     0     0 52300.7827    0  993 -171940.81 52300.7827   130%     -    1s
H    0     0                    -158506.7895 52294.5650   133%     -    1s
     0     0 50384.4465    0  994 -158506.79 50384.4465   132%     -    1s
     0     0 50384.4465    0  993 -158506.79 50384.4465   132%     -    1s
H    0     0                    -54156.67974 50365.3643   193%     -    3s
     0     0 48548.6186    0 1096 -54156.680 48548.6186   190%     -    3s
     0     0 47922.4913    0 1105 -54156.680 47922.4913   188%     -    3s
     0     0 47857.9361    0 1110 -54156.680 47857.9361   188%     -    3s
     0     0 47857.9361    0 1118 -54156.680 47857.9361   188%     -    3s
     0     0 47857.9361    0 1115 -54156.680 47857.9361   188%     -    3s
     0     0 45608.8769    0 1112 -54156.680 45608.8769   184%     -    6s
     0     0 45521.9663    0 1112 -54156.680 45521.9663   184%     -    6s
     0     2 45521.9663    0 1112 -54156.680 45521.9663   184%     -    6s
     7    16 44403.4321    3  744 -54156.680 45521.9663   184%  2758   10s
H   33    64                    -54111.96093 42876.7499   179%  2568   12s
H   36    64                    -54095.63973 42876.7499   179%  2430   12s
H   38    64                    -54058.64355 42876.7499   179%  2344   12s
H   95   249                    -8747.517087 41306.4283   572%  1479   13s
H  100   249                    -5652.483949 41306.4283   831%  1439   13s
H  123   249                    -300.0711510 41306.4283      -  1241   13s
H  352   379                    2936.4387626 41306.4283  1307%   625   14s
H  355   379                    4685.2938761 41306.4283   782%   621   14s
H  359   379                    7265.3517436 41306.4283   469%   620   14s
   378   454 31014.9802   13  415 7265.35174 41306.4283   469%   601   15s
H  479   495                    7352.6484820 41306.4283   462%   548   15s
H  494   495                    7356.9148228 41306.4283   461%   535   15s
H  612   631                    7476.6309116 41306.4283   452%   491   16s
H  730   820                    7591.2325868 41306.4283   444%   450   16s
H  809   820                    7651.0001528 41306.4283   440%   423   16s
H  990  1081                    7696.2218262 39590.3736   414%   368   17s
H 1005  1081                    7729.3815764 39590.3736   412%   363   17s
H 1271  1267                    7745.4560425 39367.7133   408%   318   18s
  1676  1545 13649.0252   45  367 7745.45604 39241.6804   407%   306   20s
H 1715  1575                    8143.5856452 39241.6804   382%   303   20s
H 1727  1575                    10375.164091 39241.6804   278%   303   20s
H 1971  1801                    10490.167049 39101.2902   273%   289   21s
H 2294  1920                    11708.910143 39101.2902   234%   272   22s
H 2322  1898                    12069.612775 39101.2902   224%   272   22s
H 2364  1882                    12282.190985 39101.2902   218%   269   22s
H 2518  1959                    12347.824529 37971.5274   208%   264   22s
H 2673  1982                    12962.799129 37702.3889   191%   262   22s
H 2967  2217                    13021.634424 37350.0898   187%   261   23s
H 2971  2207                    13122.768705 37350.0898   185%   261   23s
H 3025  2192                    13418.974368 37161.8510   177%   260   23s
  3519  2655 19631.3033   15  388 13418.9744 36940.1810   175%   252   25s
  3805  2656 22199.8058   27 1112 13418.9744 36940.1810   175%   245   34s
  3807  2657 15061.2090   65  590 13418.9744 31740.0725   137%   245   35s
  3961  2753 17928.1884   20   73 13418.9744 26513.1064  97.6%   249   40s
H 4043  2611                    13684.597373 26513.1064  93.7%   250   40s
H 4125  2477                    13693.775061 26513.1064  93.6%   249   40s
* 4843  2190              60    13697.439291 22511.8259  64.4%   234   43s
H 4912  2064                    13821.906477 22039.9812  59.5%   233   43s
  5143  1951 13943.7708   24   89 13821.9065 20845.5411  50.8%   230   45s

Explored 6050 nodes (1291314 simplex iterations) in 49.08 seconds (68.88 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 13821.9 13697.4 13693.8 ... 12282.2

Optimal solution found (tolerance 1.00e-04)
Best objective 1.382190647724e+04, best bound 1.382190647724e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 49.08s
  Master Objective (UB) = 13821.91, θ = 140751.14
  Upper Bound (UB) = 13821.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 140751.14
  [DEBUG]   ✓ Scenario 0: θ = 140751.14 ≤ Q = 140751.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1ee3ca8e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1ee3ca8e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.244171e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6941860.4744
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.139370e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113936.97    0  122 6941860.47 -113936.97   102%     -    0s
H    0     0                    -78957.27503 -113936.97  44.3%     -    0s
H    0     0                    -79854.06345 -113936.97  42.7%     -    0s
H    0     0                    -82433.49333 -82433.493  0.00%     -    0s
     0     0          -    0      -82433.493 -82433.493  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 209

Explored 1 nodes (371 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -82433.5 -79854.1 -78957.3 ... 1.24417e+13
No other solutions better than -82433.5

Optimal solution found (tolerance 1.00e-04)
Best objective -8.243349332913e+04, best bound -8.243349332913e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 105939.61
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82433.49
  [DEBUG]   S×d_nominal = 188373.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188373.10 + -82433.49 = 105939.61
  [DEBUG]   Current θ from Master = 140751.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34811.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20989.63
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 34811.5348, Absolute Gap = 34811.5348, Relative Gap = 2.518577
  Not converged yet (gap = 34811.53 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0xc6b1af0e
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -20989.6 (0.02s)
MIP start from previous solve produced solution with objective -20989.6 (0.02s)
Loaded MIP start from previous solve with objective -20989.6

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.49s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 7.125928e+03, 12234 iterations, 3.61 seconds (5.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7125.92776    0  703 -20989.628 7125.92776   134%     -    4s
H    0     0                    -20982.30975 7125.92776   134%     -    4s
     0     0 1322.26994    0  797 -20982.310 1322.26994   106%     -    7s
H    0     0                    -20973.72514 1322.10184   106%     -    7s
     0     0 1119.11021    0  885 -20973.725 1119.11021   105%     -    8s
     0     0 1092.89980    0  892 -20973.725 1092.89980   105%     -    8s
     0     0 1092.52821    0  895 -20973.725 1092.52821   105%     -    8s
     0     0 -2346.4264    0  894 -20973.725 -2346.4264  88.8%     -   14s
     0     0 -2511.4272    0  907 -20973.725 -2511.4272  88.0%     -   15s
H    0     0                    -20962.92079 -2553.9612  87.8%     -   15s
     0     0 -2553.9612    0  913 -20962.921 -2553.9612  87.8%     -   15s
     0     0 -2556.3728    0  918 -20962.921 -2556.3728  87.8%     -   15s
H    0     0                    -20054.55806 -4250.2373  78.8%     -   22s
H    0     0                    -18124.93758 -4250.2373  76.6%     -   22s
H    0     0                    -17476.15796 -4250.2373  75.7%     -   22s
H    0     0                    -16958.11525 -4250.2373  74.9%     -   22s
H    0     0                    -16957.21894 -4250.2373  74.9%     -   22s
H    0     0                    -16894.89934 -4250.2373  74.8%     -   22s
H    0     0                    -16054.28072 -4250.2373  73.5%     -   22s
H    0     0                    -16023.69792 -4250.2373  73.5%     -   22s
     0     0 -4250.2373    0  601 -16023.698 -4250.2373  73.5%     -   22s
H    0     0                    -15958.67107 -4250.4404  73.4%     -   22s
     0     0 -4495.5764    0  692 -15958.671 -4495.5764  71.8%     -   23s
     0     0 -4516.0393    0  664 -15958.671 -4516.0393  71.7%     -   24s
     0     0 -4518.5523    0  666 -15958.671 -4518.5523  71.7%     -   24s
H    0     0                    -15908.56318 -4518.5523  71.6%     -   27s
     0     0 -5097.4011    0  675 -15908.563 -5097.4011  68.0%     -   29s
     0     0 -5312.3366    0  663 -15908.563 -5312.3366  66.6%     -   31s
     0     0 -5376.9211    0  675 -15908.563 -5376.9211  66.2%     -   32s
     0     0 -5384.7278    0  677 -15908.563 -5384.7278  66.2%     -   32s
     0     0 -5387.3641    0  724 -15908.563 -5387.3641  66.1%     -   32s
     0     0 -5675.5980    0  648 -15908.563 -5675.5980  64.3%     -   35s
     0     0 -5727.2794    0  577 -15908.563 -5727.2794  64.0%     -   36s
     0     0 -5745.3073    0  665 -15908.563 -5745.3073  63.9%     -   36s
     0     0 -5749.5619    0  608 -15908.563 -5749.5619  63.9%     -   36s
H    0     0                    -15873.13333 -5749.5619  63.8%     -   37s
H    0     0                    -15591.97125 -5749.5619  63.1%     -   37s
H    0     0                    -15507.11596 -5749.5619  62.9%     -   37s
H    0     0                    -15470.41573 -5927.5540  61.7%     -   38s
     0     0 -5927.5540    0  642 -15470.416 -5927.5540  61.7%     -   38s
H    0     0                    -15116.44185 -5927.7133  60.8%     -   39s
H    0     0                    -15111.48298 -5927.7133  60.8%     -   39s
     0     0 -5998.2793    0  651 -15111.483 -5998.2793  60.3%     -   40s
     0     0 -6022.7216    0  658 -15111.483 -6022.7216  60.1%     -   40s
     0     0 -6029.2413    0  662 -15111.483 -6029.2413  60.1%     -   41s
     0     0 -6030.7965    0  660 -15111.483 -6030.7965  60.1%     -   41s
     0     0 -6202.8377    0  596 -15111.483 -6202.8377  59.0%     -   43s
     0     0 -6237.1281    0  589 -15111.483 -6237.1281  58.7%     -   43s
     0     0 -6247.8743    0  608 -15111.483 -6247.8743  58.7%     -   44s
     0     0 -6254.5797    0  611 -15111.483 -6254.5797  58.6%     -   44s
     0     0 -6256.0715    0  607 -15111.483 -6256.0715  58.6%     -   44s
     0     0 -6517.1532    0  564 -15111.483 -6517.1532  56.9%     -   46s
     0     0 -6643.6872    0  626 -15111.483 -6643.6872  56.0%     -   48s
     0     0 -6666.5525    0  567 -15111.483 -6666.5525  55.9%     -   48s
     0     0 -6668.6505    0  583 -15111.483 -6668.6505  55.9%     -   49s
     0     0 -6743.9556    0  594 -15111.483 -6743.9556  55.4%     -   50s
     0     0 -6765.9153    0  580 -15111.483 -6765.9153  55.2%     -   50s
     0     0 -6777.1788    0  587 -15111.483 -6777.1788  55.2%     -   51s
     0     0 -6782.8988    0  601 -15111.483 -6782.8988  55.1%     -   51s
     0     0 -6837.2167    0  753 -15111.483 -6837.2167  54.8%     -   52s
     0     0 -6869.9976    0  669 -15111.483 -6869.9976  54.5%     -   53s
     0     0 -6878.4149    0  688 -15111.483 -6878.4149  54.5%     -   53s
     0     0 -6881.0890    0  678 -15111.483 -6881.0890  54.5%     -   54s
     0     0 -6917.7572    0  734 -15111.483 -6917.7572  54.2%     -   55s
     0     0 -6943.5089    0  668 -15111.483 -6943.5089  54.1%     -   56s
     0     0 -6949.5336    0  662 -15111.483 -6949.5336  54.0%     -   56s
     0     0 -6970.9606    0  664 -15111.483 -6970.9606  53.9%     -   57s
     0     0 -6971.0137    0  664 -15111.483 -6971.0137  53.9%     -   58s
H    0     0                    -15074.99999 -6971.0812  53.8%     -   70s
H    0     2                    -15063.70710 -6971.0812  53.7%     -   71s
     0     2 -6971.0812    0  664 -15063.707 -6971.0812  53.7%     -   71s
     7    16 -7820.9737    3  529 -15063.707 -7312.8777  51.5%  1475   76s
    31    60 -9560.3476    5  522 -15063.707 -7662.9383  49.1%  1460   80s
   170   182 -11255.206    9  305 -15063.707 -7783.4936  48.3%   932   85s
   241   244 -11151.951   10  264 -15063.707 -7783.4936  48.3%   860   92s
   301   268 -12833.734   11  308 -15063.707 -7783.4936  48.3%   822   95s
   525   318 -14288.658   17  165 -15063.707 -7783.4936  48.3%   766  101s
   691   369 -11856.337    8  284 -15063.707 -8473.5333  43.7%   719  105s
   977   460 -13642.973   11  158 -15063.707 -8556.3203  43.2%   651  110s
  1198   592     cutoff   15      -15063.707 -8587.7620  43.0%   607  115s
  1711   793 -12620.325   44   88 -15063.707 -8587.7620  43.0%   506  120s
  2028   947     cutoff   57      -15063.707 -8587.7620  43.0%   473  126s
  2310   997 infeasible   24      -15063.707 -9174.9969  39.1%   461  130s
  2959  1191 -13493.840   10  332 -15063.707 -10412.280  30.9%   428  135s
  3980  1696     cutoff    9      -15063.707 -10412.280  30.9%   369  140s
  5578  2059 -14948.585   33  664 -15063.707 -11676.973  22.5%   304  178s
  5580  2060 -13708.230   21  396 -15063.707 -11676.973  22.5%   303  184s
  5581  2061 -14676.494   42  540 -15063.707 -11676.973  22.5%   303  189s
  5582  2062 -14132.888    6  557 -15063.707 -11676.973  22.5%   303  191s
  5585  2064 -12601.759   12  606 -15063.707 -11676.973  22.5%   303  195s
  5590  2067 -14984.801   49  561 -15063.707 -11676.973  22.5%   303  200s
  5593  2069 -13541.212   12  558 -15063.707 -11676.973  22.5%   303  205s
  5597  2072 -14536.363   20  584 -15063.707 -11676.973  22.5%   302  211s
  5598  2072 -14619.154   39  584 -15063.707 -11676.973  22.5%   302  217s
  5599  2073 -14907.954   37  584 -15063.707 -11676.973  22.5%   302  222s
  5600  2077 -11676.973   10  466 -15063.707 -11676.973  22.5%   310  225s
  5614  2100 -11676.973   13  396 -15063.707 -11676.973  22.5%   313  233s
  5630  2121 -11676.973   14  304 -15063.707 -11676.973  22.5%   318  235s
  5760  2138 -11870.314   17  237 -15063.707 -11676.973  22.5%   330  241s
  5917  2088 -14404.225   19  217 -15063.707 -11676.973  22.5%   335  245s
  6188  1984     cutoff   17      -15063.707 -11676.973  22.5%   338  251s
  6384  1884 infeasible   19      -15063.707 -11676.973  22.5%   342  256s
  6652  1784 -14685.154   38   84 -15063.707 -11676.973  22.5%   338  260s

Cutting planes:
  Learned: 1
  MIR: 298
  Flow cover: 517
  Zero half: 21
  RLT: 9
  Relax-and-lift: 47

Explored 6989 nodes (2354325 simplex iterations) in 265.01 seconds (368.80 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -15063.7 -15075 -15111.5 ... -15958.7
No other solutions better than -15063.7

Optimal solution found (tolerance 1.00e-04)
Best objective -1.506370710367e+04, best bound -1.506370710367e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 265.01s
  Master Objective (UB) = -15063.71, θ = 107636.79
  Upper Bound (UB) = -15063.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 107636.79
  [DEBUG]   ✓ Scenario 0: θ = 107636.79 ≤ Q = 107636.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 107636.79 ≤ Q = 107636.79 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4354347b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4354347b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.460829e+13
Presolve removed 2562 rows and 1856 columns
Presolve time: 0.01s
Presolved: 531 rows, 533 columns, 1497 nonzeros
Found heuristic solution: objective 8608348.6909
Variable types: 359 continuous, 174 integer (174 binary)

Root relaxation: objective -1.200917e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120091.74    0  130 8608348.69 -120091.74   101%     -    0s
H    0     0                    -81262.11056 -120091.74  47.8%     -    0s
H    0     0                    -83761.29124 -120091.74  43.4%     -    0s
H    0     0                    -99521.34258 -120091.74  20.7%     -    0s
H    0     0                    -103875.2293 -120091.74  15.6%     -    0s
     0     0 -106821.52    0   57 -103875.23 -106821.52  2.84%     -    0s
H    0     0                    -105112.1160 -106790.29  1.60%     -    0s
H    0     0                    -105449.8774 -106790.29  1.27%     -    0s
H    0     0                    -105586.3018 -106487.70  0.85%     -    0s
     0     0 -106470.44    0   58 -105586.30 -106470.44  0.84%     -    0s
     0     0 -106006.81    0   27 -105586.30 -106006.81  0.40%     -    0s
     0     0 -105995.66    0   26 -105586.30 -105995.66  0.39%     -    0s
     0     0 -105935.32    0   25 -105586.30 -105935.32  0.33%     -    0s
     0     0 -105908.53    0   27 -105586.30 -105908.53  0.31%     -    0s
     0     0 -105907.74    0   27 -105586.30 -105907.74  0.30%     -    0s
     0     0 -105797.89    0   10 -105586.30 -105797.89  0.20%     -    0s
H    0     0                    -105598.7228 -105791.67  0.18%     -    0s
     0     0 -105786.40    0   10 -105598.72 -105786.40  0.18%     -    0s
H    0     0                    -105648.7382 -105786.40  0.13%     -    0s
     0     0 -105743.38    0   14 -105648.74 -105743.38  0.09%     -    0s
     0     0 -105743.38    0   13 -105648.74 -105743.38  0.09%     -    0s
     0     0 -105670.81    0    7 -105648.74 -105670.81  0.02%     -    0s
     0     0 -105667.06    0    7 -105648.74 -105667.06  0.02%     -    0s
     0     0 -105666.04    0    7 -105648.74 -105666.04  0.02%     -    0s
*    0     0               0    -105661.3154 -105661.32  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 5
  MIR: 6
  Flow cover: 1
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (761 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -105661 -105649 -105599 ... 8.60835e+06
No other solutions better than -105661

Optimal solution found (tolerance 1.00e-04)
Best objective -1.056613154123e+05, best bound -1.056613154123e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 83170.93
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105661.32
  [DEBUG]   S×d_nominal = 188832.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188832.25 + -105661.32 = 83170.93
  [DEBUG]   Current θ from Master = 107636.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24465.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -39529.56
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 5925.9212, Absolute Gap = 5925.9212, Relative Gap = 0.393391
  Not converged yet (gap = 5925.92 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0x03221175
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -39529.6 (0.03s)
Loaded MIP start from previous solve with objective -39529.6

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.70s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31787   -2.3660826e+03   0.000000e+00   3.008973e+05      5s
   40556   -2.1799149e+02   0.000000e+00   2.813743e+05     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21620    5.8957058e+02   0.000000e+00   0.000000e+00     11s

Root relaxation: objective 5.895706e+02, 21620 iterations, 10.30 seconds (13.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  589.57058    0  406 -39529.564  589.57058   101%     -   11s
H    0     0                    -15609.47723  589.57058   104%     -   11s
H    0     0                    -15584.88701  589.57058   104%     -   11s
H    0     0                    -15492.81891  589.57058   104%     -   12s
H    0     0                    -15491.70039  589.57058   104%     -   12s
     0     0 -2591.2509    0  487 -15491.700 -2591.2509  83.3%     -   16s
     0     0 -2608.5732    0  496 -15491.700 -2608.5732  83.2%     -   17s
     0     0 -2608.5732    0  511 -15491.700 -2608.5732  83.2%     -   18s
     0     0 -2611.7063    0  507 -15491.700 -2611.7063  83.1%     -   18s
     0     0 -2611.8102    0  513 -15491.700 -2611.8102  83.1%     -   19s
     0     0 -3773.8661    0  521 -15491.700 -3773.8661  75.6%     -   23s
     0     0 -3882.1750    0  475 -15491.700 -3882.1750  74.9%     -   25s
     0     0 -3890.4822    0  534 -15491.700 -3890.4822  74.9%     -   25s
     0     0 -3894.0806    0  538 -15491.700 -3894.0806  74.9%     -   26s
     0     0 -3894.1705    0  540 -15491.700 -3894.1705  74.9%     -   26s
     0     0 -4754.0788    0  549 -15491.700 -4754.0788  69.3%     -   32s
     0     0 -5055.7314    0  502 -15491.700 -5055.7314  67.4%     -   34s
     0     0 -5105.1551    0  541 -15491.700 -5105.1551  67.0%     -   35s
     0     0 -5123.4355    0  554 -15491.700 -5123.4355  66.9%     -   35s
     0     0 -5125.5705    0  506 -15491.700 -5125.5705  66.9%     -   36s
     0     0 -5126.2460    0  554 -15491.700 -5126.2460  66.9%     -   36s
     0     0 -5126.3021    0  553 -15491.700 -5126.3021  66.9%     -   36s
     0     0 -5635.2662    0  553 -15491.700 -5635.2662  63.6%     -   42s
     0     0 -5736.2781    0  524 -15491.700 -5736.2781  63.0%     -   44s
     0     0 -5769.6277    0  523 -15491.700 -5769.6277  62.8%     -   45s
     0     0 -5783.6818    0  574 -15491.700 -5783.6818  62.7%     -   46s
     0     0 -5788.9081    0  582 -15491.700 -5788.9081  62.6%     -   46s
     0     0 -5790.3515    0  586 -15491.700 -5790.3515  62.6%     -   46s
     0     0 -5791.2151    0  584 -15491.700 -5791.2151  62.6%     -   47s
     0     0 -5791.4498    0  589 -15491.700 -5791.4498  62.6%     -   47s
     0     0 -6076.5737    0  573 -15491.700 -6076.5737  60.8%     -   50s
     0     0 -6178.1183    0  606 -15491.700 -6178.1183  60.1%     -   52s
     0     0 -6197.1834    0  565 -15491.700 -6197.1834  60.0%     -   53s
     0     0 -6201.1754    0  563 -15491.700 -6201.1754  60.0%     -   53s
     0     0 -6205.6710    0  570 -15491.700 -6205.6710  59.9%     -   54s
     0     0 -6207.6000    0  582 -15491.700 -6207.6000  59.9%     -   54s
     0     0 -6209.2988    0  575 -15491.700 -6209.2988  59.9%     -   54s
     0     0 -6209.5741    0  584 -15491.700 -6209.5741  59.9%     -   54s
     0     0 -6279.3473    0  536 -15491.700 -6279.3473  59.5%     -   56s
H    0     0                    -15479.36084 -6280.1264  59.4%     -   57s
     0     0 -6318.3360    0  535 -15479.361 -6318.3360  59.2%     -   58s
     0     0 -6331.3552    0  596 -15479.361 -6331.3552  59.1%     -   59s
     0     0 -6334.0976    0  597 -15479.361 -6334.0976  59.1%     -   59s
     0     0 -6335.1990    0  607 -15479.361 -6335.1990  59.1%     -   59s
     0     0 -6335.3140    0  604 -15479.361 -6335.3140  59.1%     -   59s
     0     0 -6392.1835    0  647 -15479.361 -6392.1835  58.7%     -   61s
     0     0 -6416.9597    0  597 -15479.361 -6416.9597  58.5%     -   63s
     0     0 -6420.2247    0  649 -15479.361 -6420.2247  58.5%     -   63s
     0     0 -6422.4553    0  655 -15479.361 -6422.4553  58.5%     -   64s
     0     0 -6424.0687    0  654 -15479.361 -6424.0687  58.5%     -   64s
     0     0 -6424.5103    0  654 -15479.361 -6424.5103  58.5%     -   64s
     0     0 -6463.5517    0  657 -15479.361 -6463.5517  58.2%     -   66s
     0     0 -6472.6339    0  648 -15479.361 -6472.6339  58.2%     -   68s
     0     0 -6474.8898    0  664 -15479.361 -6474.8898  58.2%     -   68s
     0     0 -6476.3115    0  667 -15479.361 -6476.3115  58.2%     -   69s
     0     0 -6476.6273    0  672 -15479.361 -6476.6273  58.2%     -   69s
     0     0 -6544.8991    0  551 -15479.361 -6544.8991  57.7%     -   71s
     0     0 -6557.7121    0  675 -15479.361 -6557.7121  57.6%     -   72s
     0     0 -6560.1164    0  679 -15479.361 -6560.1164  57.6%     -   72s
     0     0 -6561.3916    0  624 -15479.361 -6561.3916  57.6%     -   72s
     0     0 -6562.2059    0  682 -15479.361 -6562.2059  57.6%     -   73s
     0     0 -6790.2434    0  616 -15479.361 -6790.2434  56.1%     -   76s
     0     0 -6887.2852    0  614 -15479.361 -6887.2852  55.5%     -   78s
     0     0 -6917.1248    0  638 -15479.361 -6917.1248  55.3%     -   79s
     0     0 -6921.5810    0  645 -15479.361 -6921.5810  55.3%     -   80s
     0     0 -6924.3713    0  646 -15479.361 -6924.3713  55.3%     -   80s
     0     0 -6924.7073    0  644 -15479.361 -6924.7073  55.3%     -   80s
     0     0 -6958.0279    0  645 -15479.361 -6958.0279  55.0%     -   82s
     0     0 -6966.6744    0  655 -15479.361 -6966.6744  55.0%     -   84s
     0     0 -6968.5018    0  652 -15479.361 -6968.5018  55.0%     -   84s
     0     0 -6969.6609    0  653 -15479.361 -6969.6609  55.0%     -   85s
     0     0 -6970.3089    0  659 -15479.361 -6970.3089  55.0%     -   85s
     0     0 -6982.6657    0  664 -15479.361 -6982.6657  54.9%     -   86s
     0     0 -6990.5960    0  667 -15479.361 -6990.5960  54.8%     -   87s
     0     0 -6993.6827    0  608 -15479.361 -6993.6827  54.8%     -   88s
     0     0 -6994.1705    0  610 -15479.361 -6994.1705  54.8%     -   88s
     0     0 -7061.3382    0  590 -15479.361 -7061.3382  54.4%     -   90s
     0     0 -7110.9572    0  584 -15479.361 -7110.9572  54.1%     -   92s
     0     0 -7119.9296    0  588 -15479.361 -7119.9296  54.0%     -   92s
     0     0 -7123.1789    0  594 -15479.361 -7123.1789  54.0%     -   93s
     0     0 -7124.5763    0  599 -15479.361 -7124.5763  54.0%     -   93s
     0     0 -7125.3785    0  599 -15479.361 -7125.3785  54.0%     -   93s
     0     0 -7146.6782    0  592 -15479.361 -7146.6782  53.8%     -   94s
     0     0 -7168.2145    0  595 -15479.361 -7168.2145  53.7%     -  102s
     0     0 -7171.1240    0  603 -15479.361 -7171.1240  53.7%     -  102s
     0     0 -7172.7371    0  618 -15479.361 -7172.7371  53.7%     -  103s
     0     0 -7173.2230    0  621 -15479.361 -7173.2230  53.7%     -  103s
     0     0 -7187.6457    0  654 -15479.361 -7187.6457  53.6%     -  104s
     0     0 -7192.2897    0  655 -15479.361 -7192.2897  53.5%     -  105s
     0     0 -7193.4347    0  656 -15479.361 -7193.4347  53.5%     -  105s
     0     0 -7205.5024    0  599 -15479.361 -7205.5024  53.5%     -  107s
     0     0 -7208.5370    0  600 -15479.361 -7208.5370  53.4%     -  107s
     0     0 -7210.1733    0  606 -15479.361 -7210.1733  53.4%     -  107s
     0     0 -7210.5745    0  609 -15479.361 -7210.5745  53.4%     -  108s
     0     0 -7214.2948    0  614 -15479.361 -7214.2948  53.4%     -  109s
     0     0 -7216.6663    0  612 -15479.361 -7216.6663  53.4%     -  109s
     0     0 -7218.4897    0  611 -15479.361 -7218.4897  53.4%     -  110s
     0     0 -7218.7872    0  607 -15479.361 -7218.7872  53.4%     -  110s
     0     0 -7229.0450    0  609 -15479.361 -7229.0450  53.3%     -  111s
     0     0 -7234.5365    0  610 -15479.361 -7234.5365  53.3%     -  112s
     0     0 -7235.3091    0  614 -15479.361 -7235.3091  53.3%     -  112s
     0     0 -7240.1668    0  618 -15479.361 -7240.1668  53.2%     -  113s
     0     0 -7242.1764    0  609 -15479.361 -7242.1764  53.2%     -  114s
     0     0 -7243.7849    0  616 -15479.361 -7243.7849  53.2%     -  114s
     0     0 -7243.9958    0  614 -15479.361 -7243.9958  53.2%     -  114s
     0     0 -7245.2197    0  608 -15479.361 -7245.2197  53.2%     -  115s
     0     0 -7245.2220    0  608 -15479.361 -7245.2220  53.2%     -  116s
     0     2 -7245.2632    0  608 -15479.361 -7245.2632  53.2%     -  129s
     1     4 -7281.7475    1  635 -15479.361 -7245.2632  53.2%   971  131s
     3     8 -7337.5988    2  583 -15479.361 -7282.2245  53.0%  1070  135s
    15    32 -7532.9954    4  704 -15479.361 -7416.5180  52.1%  2125  146s
    31    60 -7603.3545    5  756 -15479.361 -7533.0204  51.3%  3429  152s
    63    92 -7691.7916    6  758 -15479.361 -7603.5282  50.9%  2531  158s
    95   186 -7749.2481    7  752 -15479.361 -7691.9033  50.3%  1985  165s
   189   260 -7799.2777    9  750 -15479.361 -7691.9033  50.3%  1489  172s
   272   332 -7962.0826   12  741 -15479.361 -7691.9033  50.3%  1304  177s
   364   367 -8057.8563   13  729 -15479.361 -7799.6052  49.6%  1164  182s
   409   409 -8165.3532   14  730 -15479.361 -7799.6052  49.6%  1154  185s
   455   448 -9749.0234   14  573 -15479.361 -7799.6052  49.6%  1150  190s
   522   513 -8192.5835   15  721 -15479.361 -7844.9486  49.3%  1123  197s
   593   571 -8608.3486   16  708 -15479.361 -7844.9486  49.3%  1109  203s
   661   623 -10534.993   17  580 -15479.361 -7844.9486  49.3%  1112  208s
   723   692 -8621.0036   17  657 -15479.361 -7844.9486  49.3%  1099  212s
   796   741 -9072.9970   19  663 -15479.361 -7844.9486  49.3%  1080  217s
   871   808 -9091.8937   20  659 -15479.361 -7844.9486  49.3%  1058  223s
   958   879 -9148.6474   21  591 -15479.361 -7950.8780  48.6%  1043  228s
  1053   959 -9292.6793   23  573 -15479.361 -7969.4231  48.5%  1009  232s
  1157  1018 -11167.860   24  607 -15479.361 -7992.7885  48.4%   980  236s
  1234  1102 -9312.5866   24  575 -15479.361 -7992.7885  48.4%   971  243s
  1342  1180 -10744.319   25  615 -15479.361 -7992.7885  48.4%   949  249s
  1453  1261 -10110.612   26  489 -15479.361 -8017.5251  48.2%   930  253s
  1583  1336 -10251.534   28  599 -15479.361 -8017.5251  48.2%   904  259s
  1712  1398 -10487.310   29  495 -15479.361 -8017.5251  48.2%   887  264s
  1813  1448 -13240.816   29  152 -15479.361 -8017.5251  48.2%   888  270s
  1893  1564 -11485.538   30  470 -15479.361 -8028.2948  48.1%   882  275s
  2041  1658 -13205.066   32  212 -15479.361 -8031.3651  48.1%   856  281s
  2207  1767 -14120.473   33  196 -15479.361 -8051.5714  48.0%   836  287s
  2366  1875 infeasible   33      -15479.361 -8071.7863  47.9%   817  292s
  2520  2017 -14426.422   36  233 -15479.361 -8084.7648  47.8%   799  299s
  2720  2144 -14578.034   38   65 -15479.361 -8084.7648  47.8%   774  307s
  2931  2171 -9312.4358    8  236 -15479.361 -8084.7648  47.8%   753  317s
  2974  2225 -9929.8032    9  208 -15479.361 -8084.7648  47.8%   757  325s
  3201  2457 -10359.503   11  180 -15479.361 -8084.7648  47.8%   748  334s
  3385  2579 -11162.813   15  235 -15479.361 -8145.0414  47.4%   736  340s
  3608  2672 -11996.950   23  212 -15479.361 -8145.0414  47.4%   724  347s
  3768  2805 -12448.137   27  157 -15479.361 -8145.0414  47.4%   720  354s
  3958  2806 -13565.522   40  608 -15479.361 -8192.5676  47.1%   718  378s
  3960  2807 -12684.660   23  406 -15479.361 -8192.5676  47.1%   718  394s
  3961  2808 -10156.621   17  568 -15479.361 -8192.5676  47.1%   717  405s
  3962  2809 -12911.288   53  663 -15479.361 -8192.5676  47.1%   717  410s
  3964  2810 -13798.893   58  636 -15479.361 -8192.5676  47.1%   717  416s
  3967  2812 -12007.881   24  665 -15479.361 -8192.5676  47.1%   716  420s
  3973  2816 -15182.715   17  624 -15479.361 -8192.5676  47.1%   715  428s
  3975  2817 -14941.280    8  633 -15479.361 -8192.5676  47.1%   715  430s
  3979  2820 -9642.1830   17  638 -15479.361 -8192.5676  47.1%   714  437s
  3982  2822 -14805.925   70  564 -15479.361 -8192.5676  47.1%   714  441s
  3984  2823 -10809.869   22  488 -15479.361 -8192.5676  47.1%   713  445s
  3988  2826 -12424.184   27  588 -15479.361 -8192.5676  47.1%   713  451s
  3991  2828 -10889.169   20  587 -15479.361 -8192.5676  47.1%   712  458s
  3993  2829 -15054.103   96  601 -15479.361 -8192.5676  47.1%   712  461s
  3994  2830 -14098.831   41  650 -15479.361 -8192.5676  47.1%   712  465s
  3997  2832 -13470.140   54  679 -15479.361 -8192.5676  47.1%   711  471s
  4000  2834 -13984.384   20  642 -15479.361 -8192.5676  47.1%   710  477s
  4002  2835 -8814.1079   13  644 -15479.361 -8192.5676  47.1%   710  481s
  4003  2836 -10320.000   15  644 -15479.361 -8192.5676  47.1%   710  498s
  4004  2837 -9384.8954   11  644 -15479.361 -8192.5676  47.1%   710  507s
  4005  2840 -8192.5676   14  537 -15479.361 -8192.5676  47.1%   727  523s
  4007  2844 -8192.5676   15  544 -15479.361 -8192.5676  47.1%   728  528s
  4011  2850 -8247.5563   16  528 -15479.361 -8192.5676  47.1%   729  533s
  4019  2864 -8467.3990   17  550 -15479.361 -8241.2433  46.8%   733  541s
  4035  2886 -8753.5040   18  518 -15479.361 -8467.4308  45.3%   745  550s
  4067  2904 -8923.5627   19  438 -15479.361 -8734.3198  43.6%   758  556s
  4099  2960 -9284.8823   20  488 -15479.361 -8923.6354  42.4%   770  565s
  4181  2969 -9654.2048   21  403 -15479.361 -9047.4772  41.6%   784  576s
  4231  2991 -11994.663   21  214 -15479.361 -9047.4772  41.6%   816  581s
  4284  2995 -12238.024   22  295 -15479.361 -9047.4772  41.6%   833  588s
  4343  3008     cutoff   23      -15479.361 -9047.4772  41.6%   850  596s
  4398  3011 -13430.161   23  260 -15479.361 -9085.2734  41.3%   858  602s
  4436  3014 -14211.720   24   88 -15479.361 -9085.2734  41.3%   860  610s
  4474  3026 -13835.416   24  185 -15479.361 -9085.2734  41.3%   865  617s
  4523  3050 -14481.301   26   60 -15479.361 -9205.0609  40.5%   871  622s
  4583  3071 -15112.444   28   48 -15479.361 -9205.0609  40.5%   870  626s
  4654  3079     cutoff   29      -15479.361 -9205.0609  40.5%   874  632s
  4726  3107 infeasible   29      -15479.361 -9226.2224  40.4%   877  641s
  4821  3114 -11758.043   20  578 -15479.361 -9270.5089  40.1%   874  646s
  4898  3136 -12181.121   21  567 -15479.361 -9270.5089  40.1%   871  653s
  4998  3141 -12376.829   24  485 -15479.361 -9270.5089  40.1%   868  661s
  5070  3164 -13153.676   25  484 -15479.361 -9270.5089  40.1%   868  667s
  5172  3164 -13448.118   26  422 -15479.361 -9270.5089  40.1%   865  674s
  5276  3173 -14077.539   27  372 -15479.361 -9270.5089  40.1%   865  679s
  5411  3165 -14848.341   28  395 -15479.361 -9270.5089  40.1%   860  687s
  5568  3135 -14850.614   29  259 -15479.361 -9270.5089  40.1%   851  694s
  5714  3100     cutoff   32      -15479.361 -9270.5089  40.1%   848  704s
  5853  3072 infeasible   31      -15479.361 -9270.5089  40.1%   847  711s
  5937  3072 -14976.326   25  308 -15479.361 -9270.5089  40.1%   849  718s
  6070  3043 -15103.869   30  210 -15479.361 -9270.5089  40.1%   849  724s
  6231  2998     cutoff   31      -15479.361 -9831.9974  36.5%   846  735s
  6393  2963 -10219.012   22  258 -15479.361 -9831.9974  36.5%   842  743s
  6560  2956 infeasible   24      -15479.361 -9973.7109  35.6%   839  751s
  6728  2937 -11747.144   26  260 -15479.361 -10034.683  35.2%   835  757s
  6845  2944 -12368.982   29  196 -15479.361 -10034.683  35.2%   834  765s
  7030  2899 infeasible   34      -15479.361 -10144.966  34.5%   834  773s
  7235  2873 -14635.785   47  105 -15479.361 -10199.732  34.1%   834  782s
  7438  2796 -11530.391   32  108 -15479.361 -10310.091  33.4%   833  789s
  7612  2778 infeasible   33      -15479.361 -10328.091  33.3%   833  796s
  7787  2739 -12562.257   34  300 -15479.361 -10404.643  32.8%   836  808s
  8048  2638 infeasible   40      -15479.361 -10404.643  32.8%   836  818s
  8258  2554 -13241.644   24  376 -15479.361 -10679.418  31.0%   843  829s
  8513  2442 -15286.633   26  297 -15479.361 -10679.418  31.0%   846  839s
  8693  2396     cutoff   28      -15479.361 -10948.869  29.3%   851  848s
  8914  2333 -12936.691   37  125 -15479.361 -11012.821  28.9%   855  860s
  9179  2293 -13398.175   36  123 -15479.361 -11278.829  27.1%   858  868s
  9512  2154 infeasible   42      -15479.361 -11501.045  25.7%   857  879s
  9895  1981 -12524.674   34   75 -15479.361 -11576.461  25.2%   853  889s
 10262  1825 -12585.941   32  115 -15479.361 -11823.733  23.6%   847  899s
 10645  1636 infeasible   40      -15479.361 -11947.449  22.8%   846  912s
 11097  1349 infeasible   24      -15479.361 -12186.086  21.3%   842  923s
 11512   977 infeasible   47      -15479.361 -12186.086  21.3%   838  938s
 11994   615 -14264.354   21  328 -15479.361 -12616.455  18.5%   836  951s
 12466   125 infeasible   36      -15479.361 -12977.151  16.2%   835  963s
 12956    15 infeasible   27      -15479.361 -13380.180  13.6%   823  972s
 13083     0 infeasible   30      -15479.361 -14418.844  6.85%   820  979s

Cutting planes:
  MIR: 409
  Mixing: 3
  Flow cover: 1396
  GUB cover: 1
  Zero half: 16
  RLT: 9
  Relax-and-lift: 65

Explored 13105 nodes (10825920 simplex iterations) in 979.66 seconds (1716.94 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -15479.4 -15491.7 -15492.8 ... -39529.6
No other solutions better than -15479.4

Optimal solution found (tolerance 1.00e-04)
Best objective -1.547936084096e+04, best bound -1.547936084096e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 979.67s
  Master Objective (UB) = -15479.36, θ = 107563.08
  Upper Bound (UB) = -15479.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 107563.08
  [DEBUG]   ✓ Scenario 0: θ = 107563.08 ≤ Q = 107563.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 107563.08 ≤ Q = 107563.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 107563.08 ≤ Q = 107563.08 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x690de24b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x96f21db5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.452745e+13
Presolve removed 2562 rows and 1856 columns
Presolve time: 0.01s
Presolved: 531 rows, 533 columns, 1497 nonzeros
Found heuristic solution: objective 8533308.9410
Variable types: 359 continuous, 174 integer (174 binary)

Root relaxation: objective -1.135676e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113567.57    0  140 8533308.94 -113567.57   101%     -    0s
H    0     0                    -74352.98268 -113567.57  52.7%     -    0s
H    0     0                    -74854.95611 -113567.57  51.7%     -    0s
H    0     0                    -87916.30799 -113567.57  29.2%     -    0s
     0     0 -102221.66    0  128 -87916.308 -102221.66  16.3%     -    0s
H    0     0                    -97743.65039 -102196.08  4.56%     -    0s
     0     0 -102042.50    0  129 -97743.650 -102042.50  4.40%     -    0s
H    0     0                    -99080.42841 -102042.50  2.99%     -    0s
     0     0 -101822.33    0  129 -99080.428 -101822.33  2.77%     -    0s
     0     0 -101733.23    0  129 -99080.428 -101733.23  2.68%     -    0s
     0     0 -101733.23    0  129 -99080.428 -101733.23  2.68%     -    0s
     0     0 -100944.00    0  122 -99080.428 -100944.00  1.88%     -    0s
     0     0 -100871.87    0  118 -99080.428 -100871.87  1.81%     -    0s
     0     0 -100077.49    0   79 -99080.428 -100077.49  1.01%     -    0s
H    0     0                    -99265.33839 -100064.00  0.80%     -    0s
H    0     0                    -99317.56671 -99916.469  0.60%     -    0s
     0     0 -99916.469    0   76 -99317.567 -99916.469  0.60%     -    0s
     0     0 -99909.639    0   78 -99317.567 -99909.639  0.60%     -    0s
     0     0 -99632.935    0   39 -99317.567 -99632.935  0.32%     -    0s
     0     0 -99588.814    0   47 -99317.567 -99588.814  0.27%     -    0s
     0     0 -99588.814    0   51 -99317.567 -99588.814  0.27%     -    0s
     0     0 -99492.465    0   31 -99317.567 -99492.465  0.18%     -    0s
     0     0 -99492.147    0   27 -99317.567 -99492.147  0.18%     -    0s
     0     0 -99477.932    0   29 -99317.567 -99477.932  0.16%     -    0s
     0     0 -99477.932    0   29 -99317.567 -99477.932  0.16%     -    0s
     0     0 -99477.932    0   24 -99317.567 -99477.932  0.16%     -    0s
     0     0 -99426.376    0   20 -99317.567 -99426.376  0.11%     -    0s
     0     0 -99403.207    0    7 -99317.567 -99403.207  0.09%     -    0s
H    0     0                    -99335.30806 -99403.207  0.07%     -    0s
     0     0 -99358.690    0    3 -99335.308 -99358.690  0.02%     -    0s
     0     0 -99349.535    0    2 -99335.308 -99349.535  0.01%     -    0s
     0     0 -99349.532    0    2 -99335.308 -99349.532  0.01%     -    0s
H    0     0                    -99349.49959 -99349.532  0.00%     -    0s

Cutting planes:
  Gomory: 5
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (1202 simplex iterations) in 0.13 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -99349.5 -99335.3 -99317.6 ... 8.53331e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -9.934949958783e+04, best bound -9.934953204875e+04, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 89401.78
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99349.50
  [DEBUG]   S×d_nominal = 188751.28
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188751.28 + -99349.50 = 89401.78
  [DEBUG]   Current θ from Master = 107563.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18161.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33640.66
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 5510.2675, Absolute Gap = 5510.2675, Relative Gap = 0.355975
  Not converged yet (gap = 5510.27 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0xf2b5cb65
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -33640.7 (0.15s)
Loaded MIP start from previous solve with objective -33640.7

Presolve removed 25452 rows and 10332 columns
Presolve time: 1.12s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36925   -2.8707415e+04   0.000000e+00   8.486292e+06      5s
   44112   -6.2628906e+03   0.000000e+00   1.388534e+06     10s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective -9.438095e+02, 23346 iterations, 13.27 seconds (17.96 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -943.80946    0  371 -33640.663 -943.80946  97.2%     -   14s
H    0     0                    -33586.75631 -943.80946  97.2%     -   15s
H    0     0                    -28316.17744 -943.80946  96.7%     -   15s
H    0     0                    -28308.40064 -4456.5132  84.3%     -   25s
     0     0 -4461.6968    0  428 -28308.401 -4461.6968  84.2%     -   25s
     0     0 -4649.1122    0  440 -28308.401 -4649.1122  83.6%     -   27s
     0     0 -4739.0048    0  438 -28308.401 -4739.0048  83.3%     -   28s
     0     0 -4788.8633    0  484 -28308.401 -4788.8633  83.1%     -   31s
     0     0 -4788.8633    0  474 -28308.401 -4788.8633  83.1%     -   31s
     0     0 -4788.8633    0  475 -28308.401 -4788.8633  83.1%     -   31s
     0     0 -6694.9090    0  464 -28308.401 -6694.9090  76.4%     -   43s
     0     0 -6871.5859    0  477 -28308.401 -6871.5859  75.7%     -   47s
H    0     0                    -27741.53569 -6948.8352  75.0%     -   49s
H    0     0                    -26176.41782 -6948.8352  73.5%     -   49s
     0     0 -6948.8352    0  482 -26176.418 -6948.8352  73.5%     -   49s
H    0     0                    -24922.83034 -6966.4065  72.0%     -   50s
H    0     0                    -23331.75899 -6966.4065  70.1%     -   50s
     0     0 -6966.4065    0  484 -23331.759 -6966.4065  70.1%     -   50s
     0     0 -7055.4192    0  485 -23331.759 -7055.4192  69.8%     -   52s
     0     0 -7056.0181    0  486 -23331.759 -7056.0181  69.8%     -   52s
     0     0 -8054.5191    0  505 -23331.759 -8054.5191  65.5%     -   65s
H    0     0                    -23186.39267 -8054.7162  65.3%     -   66s
     0     0 -8447.1313    0  472 -23186.393 -8447.1313  63.6%     -   70s
     0     0 -8613.3117    0  515 -23186.393 -8613.3117  62.9%     -   72s
     0     0 -8639.0726    0  398 -23186.393 -8639.0726  62.7%     -   73s
     0     0 -8658.8040    0  406 -23186.393 -8658.8040  62.7%     -   73s
     0     0 -8661.0131    0  404 -23186.393 -8661.0131  62.6%     -   74s
     0     0 -8663.4429    0  526 -23186.393 -8663.4429  62.6%     -   74s
     0     0 -8663.6416    0  529 -23186.393 -8663.6416  62.6%     -   74s
     0     0 -9133.1392    0  540 -23186.393 -9133.1392  60.6%     -   86s
H    0     0                    -23115.23249 -9133.2790  60.5%     -   86s
     0     0 -9407.3877    0  536 -23115.232 -9407.3877  59.3%     -   93s
     0     0 -9455.7558    0  552 -23115.232 -9455.7558  59.1%     -   96s
     0     0 -9473.5631    0  563 -23115.232 -9473.5631  59.0%     -   97s
     0     0 -9477.4400    0  572 -23115.232 -9477.4400  59.0%     -   98s
     0     0 -9479.0205    0  578 -23115.232 -9479.0205  59.0%     -   98s
     0     0 -9479.1601    0  577 -23115.232 -9479.1601  59.0%     -   98s
H    0     0                    -23082.00874 -9669.6113  58.1%     -  104s
     0     0 -9669.6113    0  526 -23082.009 -9669.6113  58.1%     -  104s
     0     0 -9765.6903    0  525 -23082.009 -9765.6903  57.7%     -  108s
     0     0 -9795.8587    0  527 -23082.009 -9795.8587  57.6%     -  109s
     0     0 -9801.1336    0  535 -23082.009 -9801.1336  57.5%     -  109s
     0     0 -9802.9009    0  536 -23082.009 -9802.9009  57.5%     -  109s
     0     0 -9805.4272    0  542 -23082.009 -9805.4272  57.5%     -  110s
     0     0 -9805.6359    0  541 -23082.009 -9805.6359  57.5%     -  110s
     0     0 -9896.6946    0  593 -23082.009 -9896.6946  57.1%     -  113s
     0     0 -9937.3072    0  581 -23082.009 -9937.3072  56.9%     -  116s
     0     0 -9950.0931    0  594 -23082.009 -9950.0931  56.9%     -  117s
     0     0 -9953.7707    0  596 -23082.009 -9953.7707  56.9%     -  117s
     0     0 -9955.4015    0  593 -23082.009 -9955.4015  56.9%     -  118s
     0     0 -9955.9021    0  601 -23082.009 -9955.9021  56.9%     -  118s
H    0     0                    -23060.19993 -10076.126  56.3%     -  122s
H    0     0                    -22948.28324 -10076.126  56.1%     -  122s
H    0     0                    -22945.79891 -10076.126  56.1%     -  122s
     0     0 -10076.126    0  549 -22945.799 -10076.126  56.1%     -  122s
H    0     0                    -22944.67125 -10076.360  56.1%     -  122s
     0     0 -10104.420    0  541 -22944.671 -10104.420  56.0%     -  123s
     0     0 -10114.796    0  545 -22944.671 -10114.796  55.9%     -  124s
     0     0 -10125.151    0  544 -22944.671 -10125.151  55.9%     -  125s
     0     0 -10127.481    0  544 -22944.671 -10127.481  55.9%     -  126s
     0     0 -10128.750    0  549 -22944.671 -10128.750  55.9%     -  126s
     0     0 -10129.044    0  545 -22944.671 -10129.044  55.9%     -  126s
     0     0 -10170.134    0  555 -22944.671 -10170.134  55.7%     -  129s
     0     0 -10187.989    0  551 -22944.671 -10187.989  55.6%     -  130s
     0     0 -10194.215    0  547 -22944.671 -10194.215  55.6%     -  131s
     0     0 -10194.630    0  554 -22944.671 -10194.630  55.6%     -  131s
     0     0 -10209.669    0  563 -22944.671 -10209.669  55.5%     -  133s
     0     0 -10214.245    0  560 -22944.671 -10214.245  55.5%     -  134s
     0     0 -10217.251    0  555 -22944.671 -10217.251  55.5%     -  134s
     0     0 -10217.622    0  559 -22944.671 -10217.622  55.5%     -  135s
     0     0 -10227.505    0  565 -22944.671 -10227.505  55.4%     -  136s
     0     0 -10231.133    0  562 -22944.671 -10231.133  55.4%     -  137s
     0     0 -10233.119    0  568 -22944.671 -10233.119  55.4%     -  138s
     0     0 -10233.605    0  564 -22944.671 -10233.605  55.4%     -  138s
     0     0 -10238.607    0  563 -22944.671 -10238.607  55.4%     -  139s
     0     0 -10243.742    0  569 -22944.671 -10243.742  55.4%     -  140s
     0     0 -10244.268    0  568 -22944.671 -10244.268  55.4%     -  140s
     0     0 -10248.523    0  574 -22944.671 -10248.523  55.3%     -  141s
H    0     0                    -22652.52257 -10248.852  54.8%     -  142s
H    0     0                    -22461.35717 -10248.852  54.4%     -  143s
     0     0 -10248.932    0  572 -22461.357 -10248.932  54.4%     -  144s
     0     0 -10249.862    0  575 -22461.357 -10249.862  54.4%     -  145s
     0     0 -10250.042    0  575 -22461.357 -10250.042  54.4%     -  146s
H    0     0                    -22396.25917 -10250.271  54.2%     -  169s
     0     2 -10250.271    0  575 -22396.259 -10250.271  54.2%     -  170s
     3     8 -10302.727    2  552 -22396.259 -10269.582  54.1%  1741  177s
     7    16 -10576.115    3  562 -22396.259 -10303.779  54.0%  3549  183s
    15    32 -10627.810    4  573 -22396.259 -10445.722  53.4%  3787  191s
H   31    49                    -22387.67456 -10546.078  52.9%  5084  256s
    48    81 -18909.663    6  231 -22387.675 -10546.152  52.9%  6308  267s
    80   156 -18962.552    7  239 -22387.675 -10546.152  52.9%  4632  274s
H   81   156                    -22198.32934 -10546.152  52.5%  4575  274s
H  135   156                    -21838.48001 -10546.152  51.7%  3015  274s
H  136   156                    -21830.48771 -10546.152  51.7%  3040  274s
   160   263 -18978.813    8  218 -21830.488 -10546.152  51.7%  2721  284s
H  297   315                    -21788.47361 -10546.152  51.6%  1906  294s
H  301   315                    -21788.19838 -10546.152  51.6%  1892  294s
H  303   315                    -21758.58243 -10546.152  51.5%  1899  294s
H  313   315                    -21679.62471 -10546.152  51.4%  1863  294s
H  316   315                    -21625.39585 -10546.152  51.2%  1861  294s
   399   356 -19179.827   11  181 -21625.396 -10546.152  51.2%  1656  303s
H  514   391                    -21623.98522 -10546.152  51.2%  1493  312s
H  518   391                    -21622.39390 -10546.152  51.2%  1490  312s
H  519   391                    -21546.50298 -10546.152  51.1%  1491  312s
H  561   391                    -20706.93208 -10627.902  48.7%  1469  312s
   567   443     cutoff   13      -20706.932 -10627.902  48.7%  1463  319s
   644   495     cutoff   14      -20706.932 -10627.902  48.7%  1455  325s
H  650   495                    -20705.52145 -10627.902  48.7%  1456  325s
   716   559 -16112.982    8  187 -20705.521 -10627.902  48.7%  1418  331s
   798   600 -16371.403   13  158 -20705.521 -10627.902  48.7%  1377  337s
   871   650 -16558.914   18  141 -20705.521 -10627.902  48.7%  1346  343s
   966   685 -16954.543   23  105 -20705.521 -10700.539  48.3%  1295  351s
  1039   733 -18909.738   29   82 -20705.521 -10700.584  48.3%  1280  360s
  1111   754 -20028.565   31   84 -20705.521 -10700.584  48.3%  1269  368s
  1166   791 -13049.290    8  325 -20705.521 -10700.584  48.3%  1274  376s
  1235   817 -15056.519    9  229 -20705.521 -10700.584  48.3%  1272  382s
H 1238   817                    -20142.84477 -10700.584  46.9%  1270  382s
H 1243   817                    -20102.83416 -10700.584  46.8%  1266  382s
  1283   900 -14433.508   10  296 -20102.834 -10801.835  46.3%  1273  388s
  1416   999     cutoff   12      -20102.834 -10801.835  46.3%  1237  396s
  1563  1112 -16666.644   17  207 -20102.834 -10801.835  46.3%  1209  406s
  1722  1198 infeasible   21      -20102.834 -10801.835  46.3%  1175  416s
  1881  1235 -17038.599   25  132 -20102.834 -10827.615  46.1%  1143  425s
  2019  1321 -17420.977   29  123 -20102.834 -10827.615  46.1%  1150  434s
  2137  1403 -17854.495   34  114 -20102.834 -10827.615  46.1%  1158  444s
  2293  1488 -19101.406   42   92 -20102.834 -10827.615  46.1%  1152  452s
  2447  1551 -19881.961   53   98 -20102.834 -10942.864  45.6%  1147  464s
  2642  1623 -12906.269   10  444 -20102.834 -11096.080  44.8%  1137  474s
  2818  1727 -13184.334   12  339 -20102.834 -11096.080  44.8%  1136  486s
  3047  1792 -15247.728   14  323 -20102.834 -11096.080  44.8%  1113  496s
  3333  1744     cutoff   15      -20102.834 -11445.937  43.1%  1082  506s
H 3335  1744                    -19666.56357 -11445.937  41.8%  1082  506s
H 3337  1744                    -19263.09258 -11445.937  40.6%  1083  506s
  3382  1815 -16218.206   15  201 -19263.093 -11445.937  40.6%  1089  518s
  3561  1796     cutoff   19      -19263.093 -11445.937  40.6%  1097  527s
  3737  1798     cutoff   19      -19263.093 -11564.346  40.0%  1103  540s
  3951  1794 -19100.835   13  210 -19263.093 -11568.088  39.9%  1101  550s
  4167  1809 -14613.649   13  300 -19263.093 -11571.138  39.9%  1106  557s
H 4168  1808                    -19262.14001 -11571.138  39.9%  1106  557s
  4220  1914 -15657.008   13  379 -19262.140 -11609.246  39.7%  1111  570s
  4484  1974 -15781.208   14  309 -19262.140 -11685.949  39.3%  1101  582s
  4660  2082 -16448.624   16  370 -19262.140 -11685.949  39.3%  1114  595s
  4900  2178     cutoff   16      -19262.140 -11715.821  39.2%  1112  610s
  5134  2179 -16281.443   27  575 -19262.140 -11715.821  39.2%  1115  657s
  5136  2180 -16254.271   22  371 -19262.140 -11715.821  39.2%  1115  677s
  5137  2181 -16222.516   21  535 -19262.140 -11715.821  39.2%  1115  701s
  5138  2182 -18785.808   29  565 -19262.140 -11715.821  39.2%  1114  712s
  5139  2182 -16205.087   20  589 -19262.140 -11715.821  39.2%  1114  720s
  5140  2183 -14220.650   27  653 -19262.140 -11715.821  39.2%  1114  725s
  5142  2184 -16966.207   16  602 -19262.140 -11715.821  39.2%  1114  732s
  5144  2186 -15891.163   25  577 -19262.140 -11715.821  39.2%  1113  735s
  5146  2187 -18116.490   17  625 -19262.140 -11715.821  39.2%  1113  748s
  5148  2188 -17649.380   30  579 -19262.140 -11715.821  39.2%  1112  750s
  5150  2190 -15639.925   13  566 -19262.140 -11715.821  39.2%  1112  758s
  5151  2190 -12540.117   11  623 -19262.140 -11715.821  39.2%  1112  760s
  5153  2192 -15707.492   12  577 -19262.140 -11715.821  39.2%  1111  767s
  5155  2193 -12404.633   10  581 -19262.140 -11715.821  39.2%  1111  771s
  5156  2194 -17000.639   24  578 -19262.140 -11715.821  39.2%  1111  775s
  5159  2196 -13153.252    8  564 -19262.140 -11715.821  39.2%  1110  783s
  5160  2196 -11824.495   16  576 -19262.140 -11715.821  39.2%  1110  786s
  5161  2197 -13469.508   14  633 -19262.140 -11715.821  39.2%  1110  791s
  5164  2199 -18872.351   11  585 -19262.140 -11715.821  39.2%  1109  795s
  5166  2200 -13427.843   14  587 -19262.140 -11715.821  39.2%  1108  802s
  5167  2201 -13313.885   21  586 -19262.140 -11715.821  39.2%  1108  806s
  5168  2202 -17206.229   12  586 -19262.140 -11715.821  39.2%  1108  830s
  5169  2202 -18074.224   39  586 -19262.140 -11715.821  39.2%  1108  855s
  5170  2206 -11715.821   15  565 -19262.140 -11715.821  39.2%  1131  861s
  5172  2209 -11715.821   16  581 -19262.140 -11715.821  39.2%  1132  872s
  5176  2214 -11715.821   17  570 -19262.140 -11715.821  39.2%  1132  889s
  5184  2223 -11715.821   18  579 -19262.140 -11715.821  39.2%  1138  901s
  5198  2224 -17307.238   19  377 -19262.140 -11715.821  39.2%  1159  916s
  5213  2244 -12340.690   20  458 -19262.140 -11715.821  39.2%  1172  935s
  5244  2269 -13343.068   21  451 -19262.140 -11715.821  39.2%  1192  953s
  5321  2278 -13524.595   24  456 -19262.140 -11715.821  39.2%  1245  967s
  5406  2290     cutoff   27      -19262.140 -11715.821  39.2%  1268  980s
  5466  2327 -14417.370   28  339 -19262.140 -11715.821  39.2%  1276  991s
  5555  2320 -15095.047   31  209 -19262.140 -11715.821  39.2%  1287 1000s
  5595  2333 -15499.870   32  333 -19262.140 -11751.733  39.0%  1295 1010s
  5649  2340 -15759.528   33  316 -19262.140 -11751.733  39.0%  1302 1018s
  5699  2350 -15813.992   34  304 -19262.140 -11751.733  39.0%  1307 1027s
  5781  2350 -18159.951   35  235 -19262.140 -11897.583  38.2%  1313 1037s
  5842  2346 -18296.117   36  245 -19262.140 -11897.583  38.2%  1317 1046s
  5921  2350 -18375.364   37  242 -19262.140 -11897.583  38.2%  1317 1054s
  6001  2346 -18527.445   42  246 -19262.140 -11897.583  38.2%  1318 1062s
  6073  2327 -15157.659   24  468 -19262.140 -11987.065  37.8%  1319 1069s
  6146  2324 -15653.696   25  392 -19262.140 -11987.065  37.8%  1326 1081s
  6241  2310 -17046.780   26  374 -19262.140 -11987.065  37.8%  1327 1091s
  6312  2325 -17460.160   27  290 -19262.140 -11987.065  37.8%  1331 1102s
  6424  2306 -17881.028   29  293 -19262.140 -11987.065  37.8%  1331 1112s
  6554  2296     cutoff   30      -19262.140 -11987.065  37.8%  1327 1122s
  6684  2263 -19034.791   25  214 -19262.140 -12459.109  35.3%  1326 1132s
  6784  2275 -14656.055   27  217 -19262.140 -12461.947  35.3%  1329 1147s
  6903  2267 -15816.364   30  385 -19262.140 -12461.947  35.3%  1335 1159s
  7029  2243     cutoff   32      -19262.140 -12461.947  35.3%  1338 1170s
  7105  2272 -16330.574   35  345 -19262.140 -12461.947  35.3%  1337 1179s
  7241  2258 -17559.677   41  171 -19262.140 -13253.997  31.2%  1334 1193s
  7394  2251     cutoff   44      -19262.140 -13253.997  31.2%  1334 1204s
  7537  2248 -18772.795   28  237 -19262.140 -13378.224  30.5%  1338 1216s
  7706  2221 -16194.091   26  362 -19262.140 -13585.068  29.5%  1339 1229s
  7871  2203 -16923.220   27  330 -19262.140 -13694.161  28.9%  1341 1241s
  7977  2180 -17438.871   30  341 -19262.140 -13762.354  28.6%  1346 1251s
  8061  2163 -18937.541   32  275 -19262.140 -13762.354  28.6%  1348 1266s
  8183  2151 -17819.040   30  310 -19262.140 -13799.795  28.4%  1349 1279s
  8422  2085     cutoff   31      -19262.140 -13869.282  28.0%  1338 1294s
  8662  2010 -17432.182   35  131 -19262.140 -14356.029  25.5%  1335 1310s
  8801  2020 -15865.931   30  294 -19262.140 -14619.826  24.1%  1339 1326s
  8971  1978 -16655.931   34  275 -19262.140 -14628.238  24.1%  1349 1344s
  9201  1886 -19159.809   40  143 -19262.140 -14731.762  23.5%  1348 1356s
  9269  1867     cutoff   41      -19262.140 -14948.159  22.4%  1351 1369s
  9354  1822 infeasible   36      -19262.140 -14962.776  22.3%  1352 1384s
  9473  1777 -15488.330   31  314 -19262.140 -14962.776  22.3%  1353 1398s
  9601  1749 -16255.783   32  323 -19262.140 -14962.776  22.3%  1356 1415s
  9852  1675 -16732.300   36  322 -19262.140 -15210.152  21.0%  1350 1431s
 10179  1534 -17519.969   43  366 -19262.140 -15390.637  20.1%  1340 1451s
 10523  1334 infeasible   40      -19262.140 -15954.997  17.2%  1332 1466s
 10987  1140     cutoff   37      -19262.140 -16297.849  15.4%  1315 1484s
 11347   875     cutoff   38      -19262.140 -16726.584  13.2%  1301 1504s
 11945   375 -19108.542   34  363 -19262.140 -17134.835  11.0%  1276 1523s
 12640     8     cutoff   29      -19262.140 -17426.800  9.53%  1246 1536s

Cutting planes:
  MIR: 685
  Mixing: 1
  Flow cover: 1468
  Zero half: 5
  RLT: 28
  Relax-and-lift: 81

Explored 13202 nodes (16148805 simplex iterations) in 1536.75 seconds (2712.96 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19262.1 -19263.1 -19666.6 ... -21624
No other solutions better than -19262.1

Optimal solution found (tolerance 1.00e-04)
Best objective -1.926214000525e+04, best bound -1.926214000525e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1536.76s
  Master Objective (UB) = -19262.14, θ = 106539.04
  Upper Bound (UB) = -19262.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 106539.04
  [DEBUG]   ✓ Scenario 0: θ = 106539.04 ≤ Q = 106539.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 106539.04 ≤ Q = 106539.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 106539.04 ≤ Q = 106539.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 106539.04 ≤ Q = 106539.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x481cd3f5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x481cd3f5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-01, 2e+02]
Found heuristic solution: objective 1.216810e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6628564.2298
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.161086e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116108.63    0  131 6628564.23 -116108.63   102%     -    0s
H    0     0                    -80519.21353 -116108.63  44.2%     -    0s
H    0     0                    -82264.80050 -116108.63  41.1%     -    0s
H    0     0                    -82582.48049 -116108.63  40.6%     -    0s
H    0     0                    -89770.37202 -97583.253  8.70%     -    0s
H    0     0                    -90491.72356 -97583.253  7.84%     -    0s
     0     0 -97583.253    0   78 -90491.724 -97583.253  7.84%     -    0s
H    0     0                    -95209.84660 -97530.776  2.44%     -    0s
H    0     0                    -95609.69216 -97524.996  2.00%     -    0s
     0     0 -97524.996    0   76 -95609.692 -97524.996  2.00%     -    0s
     0     0 -97316.979    0   57 -95609.692 -97316.979  1.79%     -    0s
     0     0 -97285.423    0   60 -95609.692 -97285.423  1.75%     -    0s
     0     0 -97285.423    0   60 -95609.692 -97285.423  1.75%     -    0s
H    0     0                    -95877.30567 -97285.423  1.47%     -    0s
H    0     0                    -95891.91373 -97285.423  1.45%     -    0s
     0     0 -97168.661    0   63 -95891.914 -97168.661  1.33%     -    0s
     0     0 -97163.237    0   63 -95891.914 -97163.237  1.33%     -    0s
     0     0 -97064.116    0   63 -95891.914 -97064.116  1.22%     -    0s
     0     0 -97027.538    0   63 -95891.914 -97027.538  1.18%     -    0s
H    0     0                    -95893.60293 -97018.703  1.17%     -    0s
     0     2 -97018.703    0   63 -95893.603 -97018.703  1.17%     -    0s
H   75    12                    -95928.35459 -96674.020  0.78%   6.0    0s
H  657   106                    -95935.73905 -96207.486  0.28%   6.1    0s
*  986    29              34    -95943.37180 -96070.977  0.13%   5.6    0s

Cutting planes:
  Gomory: 25
  MIR: 186
  RLT: 42

Explored 1097 nodes (6445 simplex iterations) in 0.24 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -95943.4 -95935.7 -95928.4 ... -82264.8
No other solutions better than -95943.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.594337179587e+04, best bound -9.594337179587e+04, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 92657.19
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95943.37
  [DEBUG]   S×d_nominal = 188600.57
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188600.57 + -95943.37 = 92657.19
  [DEBUG]   Current θ from Master = 106539.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13881.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33143.98
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 1727.4883, Absolute Gap = 1727.4883, Relative Gap = 0.089683
  Not converged yet (gap = 1727.49 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0xdf790164
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 1.15s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -406622.8862
Found heuristic solution: objective -230474.5609

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27018   -1.3134281e+04   0.000000e+00   1.985247e+06      5s
   34972   -3.1355012e+03   0.000000e+00   4.604192e+06     10s
   41059   -2.0905581e+03   0.000000e+00   2.586616e+06     15s
   46888   -1.7458933e+03   0.000000e+00   2.159239e+05     20s
   52054   -1.7284527e+03   0.000000e+00   7.563919e+05     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -9.438095e+02, 38268 iterations, 25.43 seconds (35.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -943.80946    0  371 -230474.56 -943.80946   100%     -   27s
H    0     0                    -219604.2670 -943.80946   100%     -   27s
H    0     0                    -74006.34226 -943.80946  98.7%     -   27s
H    0     0                    -73170.98683 -943.80946  98.7%     -   27s
H    0     0                    -38338.52367 -943.80946  97.5%     -   27s
H    0     0                    -34325.31010 -943.80946  97.3%     -   27s
H    0     0                    -29644.80393 -943.80946  96.8%     -   29s
H    0     0                    -29467.02841 -943.80946  96.8%     -   29s
H    0     0                    -29223.98575 -943.80946  96.8%     -   29s
H    0     0                    -27124.56489 -4501.9854  83.4%     -   44s
     0     0 -4501.9854    0  442 -27124.565 -4501.9854  83.4%     -   44s
H    0     0                    -26012.41549 -4503.6873  82.7%     -   44s
     0     0 -4978.3907    0  428 -26012.415 -4978.3907  80.9%     -   50s
     0     0 -5088.9636    0  439 -26012.415 -5088.9636  80.4%     -   53s
     0     0 -5088.9636    0  445 -26012.415 -5088.9636  80.4%     -   57s
     0     0 -5088.9636    0  453 -26012.415 -5088.9636  80.4%     -   58s
     0     0 -5088.9636    0  454 -26012.415 -5088.9636  80.4%     -   60s
     0     0 -5088.9636    0  456 -26012.415 -5088.9636  80.4%     -   60s
H    0     0                    -25938.85213 -6639.2354  74.4%     -   79s
     0     0 -6639.2354    0  478 -25938.852 -6639.2354  74.4%     -   79s
H    0     0                    -25624.35123 -6639.8143  74.1%     -   80s
H    0     0                    -25616.22245 -6639.8143  74.1%     -   80s
H    0     0                    -23980.89144 -6800.6648  71.6%     -   86s
H    0     0                    -23951.49040 -6800.6648  71.6%     -   86s
H    0     0                    -23912.44196 -6800.6648  71.6%     -   86s
H    0     0                    -23884.35626 -6800.6648  71.5%     -   86s
H    0     0                    -23180.58874 -6800.6648  70.7%     -   86s
H    0     0                    -23146.98768 -6800.6648  70.6%     -   86s
     0     0 -6800.6648    0  538 -23146.988 -6800.6648  70.6%     -   86s
     0     0 -6936.6632    0  538 -23146.988 -6936.6632  70.0%     -   88s
     0     0 -7007.3139    0  551 -23146.988 -7007.3139  69.7%     -   90s
     0     0 -7026.6658    0  562 -23146.988 -7026.6658  69.6%     -   92s
     0     0 -7026.9811    0  561 -23146.988 -7026.9811  69.6%     -   92s
     0     0 -7919.7076    0  491 -23146.988 -7919.7076  65.8%     -  114s
H    0     0                    -23144.50335 -8496.7594  63.3%     -  123s
H    0     0                    -23115.23249 -8496.7594  63.2%     -  123s
H    0     0                    -23086.12250 -8496.7594  63.2%     -  123s
H    0     0                    -23083.26680 -8496.7594  63.2%     -  123s
H    0     0                    -22870.64588 -8496.7594  62.8%     -  123s
H    0     0                    -22694.78899 -8496.7594  62.6%     -  123s
     0     0 -8496.7594    0  565 -22694.789 -8496.7594  62.6%     -  123s
     0     0 -8594.0083    0  533 -22694.789 -8594.0083  62.1%     -  127s
     0     0 -8627.4067    0  539 -22694.789 -8627.4067  62.0%     -  129s
     0     0 -8689.2708    0  548 -22694.789 -8689.2708  61.7%     -  131s
     0     0 -8748.3439    0  541 -22694.789 -8748.3439  61.5%     -  133s
     0     0 -8757.6570    0  547 -22694.789 -8757.6570  61.4%     -  134s
     0     0 -8758.8278    0  545 -22694.789 -8758.8278  61.4%     -  135s
     0     0 -8761.0931    0  553 -22694.789 -8761.0931  61.4%     -  135s
     0     0 -8762.3768    0  553 -22694.789 -8762.3768  61.4%     -  135s
     0     0 -8763.2670    0  558 -22694.789 -8763.2670  61.4%     -  136s
     0     0 -8763.4056    0  555 -22694.789 -8763.4056  61.4%     -  136s
     0     0 -9424.5311    0  561 -22694.789 -9424.5311  58.5%     -  153s
     0     0 -9614.1519    0  496 -22694.789 -9614.1519  57.6%     -  157s
     0     0 -9683.9048    0  501 -22694.789 -9683.9048  57.3%     -  161s
     0     0 -9699.7198    0  520 -22694.789 -9699.7198  57.3%     -  163s
     0     0 -9706.3406    0  525 -22694.789 -9706.3406  57.2%     -  164s
     0     0 -9718.1173    0  434 -22694.789 -9718.1173  57.2%     -  166s
     0     0 -9721.6698    0  445 -22694.789 -9721.6698  57.2%     -  166s
     0     0 -9722.5297    0  520 -22694.789 -9722.5297  57.2%     -  167s
     0     0 -9907.6386    0  521 -22694.789 -9907.6386  56.3%     -  174s
     0     0 -9947.1321    0  518 -22694.789 -9947.1321  56.2%     -  177s
     0     0 -9957.6180    0  534 -22694.789 -9957.6180  56.1%     -  178s
     0     0 -9960.2461    0  535 -22694.789 -9960.2461  56.1%     -  178s
     0     0 -9960.7020    0  543 -22694.789 -9960.7020  56.1%     -  179s
     0     0 -10034.098    0  541 -22694.789 -10034.098  55.8%     -  183s
H    0     0                    -22084.34485 -10034.292  54.6%     -  187s
H    0     0                    -21944.17178 -10034.292  54.3%     -  188s
H    0     0                    -21899.85083 -10034.292  54.2%     -  188s
H    0     0                    -21817.05011 -10034.292  54.0%     -  188s
H    0     0                    -21426.74533 -10034.292  53.2%     -  188s
H    0     0                    -21238.50920 -10034.292  52.8%     -  188s
H    0     0                    -21229.92459 -10034.292  52.7%     -  188s
     0     0 -10074.561    0  534 -21229.925 -10074.561  52.5%     -  191s
     0     0 -10099.540    0  591 -21229.925 -10099.540  52.4%     -  193s
     0     0 -10103.179    0  532 -21229.925 -10103.179  52.4%     -  194s
     0     0 -10105.721    0  541 -21229.925 -10105.721  52.4%     -  194s
     0     0 -10106.455    0  537 -21229.925 -10106.455  52.4%     -  194s
     0     0 -10142.667    0  542 -21229.925 -10142.667  52.2%     -  198s
     0     0 -10147.397    0  554 -21229.925 -10147.397  52.2%     -  199s
     0     0 -10149.336    0  549 -21229.925 -10149.336  52.2%     -  200s
     0     0 -10150.624    0  550 -21229.925 -10150.624  52.2%     -  200s
     0     0 -10151.403    0  552 -21229.925 -10151.403  52.2%     -  201s
     0     0 -10162.757    0  554 -21229.925 -10162.757  52.1%     -  203s
     0     0 -10166.522    0  550 -21229.925 -10166.522  52.1%     -  205s
     0     0 -10169.620    0  566 -21229.925 -10169.620  52.1%     -  206s
     0     0 -10170.524    0  567 -21229.925 -10170.524  52.1%     -  206s
     0     0 -10182.402    0  565 -21229.925 -10182.402  52.0%     -  208s
     0     0 -10185.541    0  560 -21229.925 -10185.541  52.0%     -  209s
     0     0 -10186.275    0  568 -21229.925 -10186.275  52.0%     -  209s
     0     0 -10195.089    0  560 -21229.925 -10195.089  52.0%     -  211s
H    0     0                    -21228.51396 -10196.616  52.0%     -  215s
     0     0 -10197.618    0  547 -21228.514 -10197.618  52.0%     -  216s
     0     0 -10197.839    0  556 -21228.514 -10197.839  52.0%     -  216s
     0     0 -10199.092    0  558 -21228.514 -10199.092  52.0%     -  218s
     0     0 -10199.781    0  558 -21228.514 -10199.781  52.0%     -  218s
     0     0 -10204.332    0  550 -21228.514 -10204.332  51.9%     -  220s
     0     0 -10206.373    0  612 -21228.514 -10206.373  51.9%     -  221s
     0     0 -10208.050    0  551 -21228.514 -10208.050  51.9%     -  221s
     0     0 -10209.177    0  549 -21228.514 -10209.177  51.9%     -  222s
     0     0 -10213.730    0  613 -21228.514 -10213.730  51.9%     -  223s
     0     0 -10213.904    0  613 -21228.514 -10213.904  51.9%     -  225s
     0     2 -10213.904    0  613 -21228.514 -10213.904  51.9%     -  256s
     3     8 -10302.997    2  552 -21228.514 -10245.561  51.7%  1944  267s
     7    16 -10366.511    3  559 -21228.514 -10304.999  51.5%  4061  282s
    15    32 -10494.946    4  598 -21228.514 -10366.825  51.2%  5236  290s
    31    48 -10878.654    5  465 -21228.514 -10494.986  50.6%  6607  307s
    47    80 -11208.534    6  396 -21228.514 -10494.986  50.6%  5978  319s
H   50    80                    -20986.41870 -10494.986  50.0%  5840  319s
    79   186 -11584.371    7  377 -20986.419 -10494.986  50.0%  4949  340s
H  185   305                    -20862.13394 -10494.986  49.7%  2856  351s
H  229   305                    -20762.14633 -10494.986  49.5%  2434  351s
   312   417 -11936.048   10  380 -20762.146 -10494.986  49.5%  2089  361s
   436   452 -11685.568   11  372 -20762.146 -10494.986  49.5%  1717  371s
H  477   452                    -20736.86839 -10494.986  49.4%  1616  371s
   548   482 -11784.525   11  439 -20736.868 -10494.986  49.4%  1532  381s
   640   504 -11611.015    9  362 -20736.868 -10494.986  49.4%  1428  391s
   672   539 -12092.425   11  373 -20736.868 -10494.986  49.4%  1440  400s
H  687   539                    -20705.52145 -10494.986  49.3%  1430  400s
   732   553 -11986.373   11  358 -20705.521 -10494.986  49.3%  1408  408s
   777   578 -13302.103   12  439 -20705.521 -10494.986  49.3%  1416  418s
   823   596 -13581.545   12  368 -20705.521 -10494.986  49.3%  1431  426s
   868   618 -13536.369   12  360 -20705.521 -10494.986  49.3%  1440  434s
   918   643 -12963.316   12  325 -20705.521 -10494.986  49.3%  1428  443s
   970   677 -13570.749   13  235 -20705.521 -10494.986  49.3%  1449  454s
  1020   719 -13586.197   14  308 -20705.521 -10494.986  49.3%  1457  463s
  1080   770 -13765.385   15  234 -20705.521 -10494.986  49.3%  1471  470s
  1142   825 -14336.274   13  257 -20705.521 -10564.526  49.0%  1461  480s
  1225   859 -13850.393   16  303 -20705.521 -10564.954  49.0%  1422  490s
  1297   900     cutoff   15      -20705.521 -10564.954  49.0%  1408  499s
  1368   968     cutoff   16      -20705.521 -10564.954  49.0%  1396  509s
  1476  1039 -14749.907   19  272 -20705.521 -10564.954  49.0%  1374  519s
  1586  1116 -17391.566   17  116 -20705.521 -10564.954  49.0%  1332  530s
  1710  1185 -16557.266   19  144 -20705.521 -10564.954  49.0%  1315  539s
  1821  1248     cutoff   18      -20705.521 -10730.743  48.2%  1300  551s
  1956  1334 -15309.204   21  127 -20705.521 -10829.742  47.7%  1278  563s
  2107  1440 -15317.442   22  127 -20705.521 -10831.403  47.7%  1267  576s
  2266  1530 -15622.296   23  119 -20705.521 -10831.403  47.7%  1260  590s
  2435  1603 -16082.381   25  128 -20705.521 -11019.789  46.8%  1248  604s
  2604  1660 -16293.295   28  264 -20705.521 -11019.789  46.8%  1241  617s
  2753  1736 -17595.905   32  102 -20705.521 -11019.789  46.8%  1255  631s
  2908  1794 -19322.084   10   92 -20705.521 -11019.789  46.8%  1271  646s
  3052  1861 -19947.319   11   73 -20705.521 -11019.789  46.8%  1284  661s
  3215  1943     cutoff   34      -20705.521 -11091.617  46.4%  1298  676s
  3384  2045 -11124.759    6  405 -20705.521 -11124.759  46.3%  1310  692s
  3590  2102 -11362.792    7  302 -20705.521 -11125.899  46.3%  1310  708s
  3768  2180 -20297.986    9  110 -20705.521 -11277.007  45.5%  1326  723s
  3981  2269 -18247.670    8  173 -20705.521 -11286.311  45.5%  1336  737s
  4145  2354 -19462.371    9  171 -20705.521 -11365.504  45.1%  1357  753s
  4381  2422 -13177.035    9  409 -20705.521 -11365.504  45.1%  1354  772s
  4580  2516 -18624.838   11  273 -20705.521 -11453.119  44.7%  1371  790s
  4798  2582 -20660.928   15  224 -20705.521 -11456.076  44.7%  1381  808s
* 4935  2516              40    -20337.69069 -11504.223  43.4%  1379  808s
  4977  2507 -17382.156   18  613 -20337.691 -11504.223  43.4%  1375  946s
H 4978  2382                    -20233.95482 -11504.223  43.1%  1375  985s
H 4978  2263                    -20140.44468 -11504.223  42.9%  1375  985s
H 4978  2150                    -20055.14783 -11504.223  42.6%  1375  985s
H 4978  2042                    -19789.60942 -11504.223  41.9%  1375  987s
H 4978  1940                    -19758.74622 -11504.223  41.8%  1375  987s
H 4979  1843                    -19728.18182 -11504.223  41.7%  1375 1020s
  4981  1845 -18369.491   40  560 -19728.182 -11504.223  41.7%  1374 1036s
  4982  1845 -18954.052   31  657 -19728.182 -11504.223  41.7%  1374 1047s
  4983  1846 -17395.106   32  599 -19728.182 -11504.223  41.7%  1374 1053s
  4984  1847 -12554.858   18  523 -19728.182 -11504.223  41.7%  1374 1059s
  4985  1847 -13031.057   13  544 -19728.182 -11504.223  41.7%  1373 1061s
  4987  1849 -17014.440   16  604 -19728.182 -11504.223  41.7%  1373 1066s
  4988  1849 -18663.106   24  563 -19728.182 -11504.223  41.7%  1372 1072s
  4989  1850 -16578.434   31  626 -19728.182 -11504.223  41.7%  1372 1075s
  4992  1852 -12662.959   10  614 -19728.182 -11504.223  41.7%  1371 1086s
  4994  1853 -18177.602   22  569 -19728.182 -11504.223  41.7%  1371 1091s
  4995  1854 -11611.407    8  500 -19728.182 -11504.223  41.7%  1370 1095s
  4998  1856 -16645.640   33  581 -19728.182 -11504.223  41.7%  1370 1105s
  5000  1857 -13042.045   10  654 -19728.182 -11504.223  41.7%  1369 1114s
  5001  1858 -14293.567   21  636 -19728.182 -11504.223  41.7%  1369 1118s
  5002  1859 -12124.878   12  587 -19728.182 -11504.223  41.7%  1369 1122s
  5003  1859 -16280.582   26  599 -19728.182 -11504.223  41.7%  1368 1125s
  5004  1860 -15219.771    9  646 -19728.182 -11504.223  41.7%  1368 1131s
  5006  1861 -17692.956   10  597 -19728.182 -11504.223  41.7%  1367 1139s
  5007  1862 -12498.430   13  598 -19728.182 -11504.223  41.7%  1367 1142s
  5008  1863 -12596.802   15  638 -19728.182 -11504.223  41.7%  1367 1147s
  5009  1863 -17792.655   17  638 -19728.182 -11504.223  41.7%  1367 1183s
  5010  1864 -15506.699   14  638 -19728.182 -11504.223  41.7%  1366 1204s
  5011  1868 -11504.223   13  615 -19728.182 -11504.223  41.7%  1394 1214s
  5013  1871 -11504.223   14  618 -19728.182 -11504.223  41.7%  1394 1227s
  5017  1878 -11504.223   15  635 -19728.182 -11504.223  41.7%  1398 1244s
  5025  1891 -11504.223   16  631 -19728.182 -11504.223  41.7%  1407 1264s
  5041  1897 -12006.531   17  524 -19728.182 -11504.223  41.7%  1451 1288s
  5060  1916 -13655.244   18  418 -19728.182 -11504.223  41.7%  1480 1312s
H 5091  1904                    -19717.36515 -11504.223  41.7%  1501 1336s
H 5096  1813                    -19705.83716 -11504.223  41.6%  1502 1336s
H 5131  1718                    -19652.02748 -11504.223  41.5%  1512 1336s
  5211  1739 -14721.947   23  274 -19652.027 -11504.223  41.5%  1529 1352s
  5281  1735 -15547.864   21  409 -19652.027 -11504.223  41.5%  1553 1367s
  5325  1765 -16914.902   23  347 -19652.027 -11504.223  41.5%  1566 1380s
  5383  1766 -15961.327   24  217 -19652.027 -11504.223  41.5%  1576 1391s
  5424  1784 -17381.843   24  268 -19652.027 -11504.223  41.5%  1581 1400s
  5486  1763 -17566.596   24  225 -19652.027 -11504.223  41.5%  1584 1414s
  5568  1759     cutoff   24      -19652.027 -11504.223  41.5%  1584 1428s
  5645  1743 -16158.593   25  325 -19652.027 -11504.223  41.5%  1587 1445s
  5720  1737 -16205.386   26  238 -19652.027 -11504.223  41.5%  1594 1460s
  5789  1729 -16485.295   27  248 -19652.027 -11504.223  41.5%  1604 1474s
  5832  1739 -16562.228   28  262 -19652.027 -11538.317  41.3%  1610 1488s
  5886  1743 -16605.707   29  263 -19652.027 -11538.317  41.3%  1616 1501s
  5950  1758     cutoff   29      -19652.027 -11538.317  41.3%  1622 1513s
  6032  1756 -19283.788   22  232 -19652.027 -11538.317  41.3%  1630 1524s
  6126  1751     cutoff   23      -19652.027 -11551.850  41.2%  1636 1537s
  6216  1746     cutoff   23      -19652.027 -11785.427  40.0%  1643 1552s
  6345  1725 -12935.321   20  456 -19652.027 -11785.427  40.0%  1642 1567s
  6436  1738 -13130.951   21  499 -19652.027 -12029.012  38.8%  1656 1578s
  6552  1726 -13338.899   22  499 -19652.027 -12029.012  38.8%  1661 1591s
  6667  1733 -17466.824   24  216 -19652.027 -12414.724  36.8%  1670 1607s
  6827  1704 -18243.371   22  276 -19652.027 -12414.724  36.8%  1673 1622s
  6974  1669     cutoff   21      -19652.027 -12553.851  36.1%  1682 1638s
  7113  1664 infeasible   21      -19652.027 -12855.957  34.6%  1680 1654s
  7242  1637 -18872.200   24  258 -19652.027 -13023.709  33.7%  1685 1672s
  7410  1613 -15390.480   27  315 -19652.027 -13023.709  33.7%  1687 1689s
  7581  1590     cutoff   23      -19652.027 -13023.709  33.7%  1697 1706s
  7797  1549 -16363.965   25  345 -19652.027 -13302.037  32.3%  1694 1723s
  7992  1520 -17394.508   29  225 -19652.027 -13460.979  31.5%  1697 1742s
  8221  1479 -16920.055   25  261 -19652.027 -13460.979  31.5%  1690 1766s
  8419  1429 -17489.138   27  318 -19652.027 -13587.244  30.9%  1687 1786s
  8674  1377 -19251.684   23  378 -19652.027 -13909.215  29.2%  1683 1807s
  8890  1319 -15241.025   21  393 -19652.027 -14076.146  28.4%  1690 1826s
  9187  1252 -15480.511   23  261 -19652.027 -14076.146  28.4%  1680 1847s
  9507  1152 -16770.500   27  297 -19652.027 -14277.424  27.3%  1666 1866s
  9770  1073 -19276.055   27  366 -19652.027 -14449.477  26.5%  1663 1888s
  9893  1059 -19484.194   28  373 -19652.027 -14449.477  26.5%  1660 1909s
 10164  1023 -19132.700   29  235 -19652.027 -14843.295  24.5%  1659 1933s
 10495   998     cutoff   23      -19652.027 -15053.019  23.4%  1655 1957s
 10894   958 -19130.988   26  240 -19652.027 -15377.068  21.8%  1644 1982s
 11327   874     cutoff   32      -19652.027 -15589.026  20.7%  1631 2007s
 11864   741     cutoff   23      -19652.027 -16133.930  17.9%  1602 2034s
 12452   600 -18614.637   28  402 -19652.027 -16358.293  16.8%  1576 2060s
 12754   321     cutoff   29      -19652.027 -16716.264  14.9%  1567 2082s
 13499     7     cutoff   27      -19652.027 -17252.835  12.2%  1524 2100s

Cutting planes:
  MIR: 873
  Mixing: 1
  Flow cover: 1843
  Zero half: 9
  RLT: 18
  Relax-and-lift: 105

Explored 14069 nodes (21128174 simplex iterations) in 2102.04 seconds (3808.00 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19652 -19705.8 -19717.4 ... -20337.7
No other solutions better than -19652

Optimal solution found (tolerance 1.00e-04)
Best objective -1.965202748195e+04, best bound -1.965202748195e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2102.06s
  Master Objective (UB) = -19652.03, θ = 106494.21
  Upper Bound (UB) = -19652.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 106494.21
  [DEBUG]   ✓ Scenario 0: θ = 106494.21 ≤ Q = 106494.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 106494.21 ≤ Q = 106494.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 106494.21 ≤ Q = 106494.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 106494.21 ≤ Q = 106494.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 106494.21 ≤ Q = 106494.21 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x12b76af0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xed489510
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.222771e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6690736.9304
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.160844e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116084.43    0  131 6690736.93 -116084.43   102%     -    0s
H    0     0                    -80484.85775 -116084.43  44.2%     -    0s
H    0     0                    -82235.37993 -116084.43  41.2%     -    0s
H    0     0                    -82553.05992 -116084.43  40.6%     -    0s
H    0     0                    -89741.87281 -93221.145  3.88%     -    0s
H    0     0                    -90475.17193 -93221.145  3.04%     -    0s
     0     0 -93209.825    0   30 -90475.172 -93209.825  3.02%     -    0s
H    0     0                    -92429.01493 -93192.388  0.83%     -    0s
H    0     0                    -92789.49405 -93192.388  0.43%     -    0s
H    0     0                    -93073.45307 -93160.860  0.09%     -    0s
     0     0 -93160.860    0   28 -93073.453 -93160.860  0.09%     -    0s
     0     0          -    0      -93073.453 -93082.602  0.01%     -    0s

Cutting planes:
  Gomory: 12
  MIR: 117
  RLT: 26

Explored 1 nodes (419 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -93073.5 -92789.5 -92429 ... 1.22277e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.307345307498e+04, best bound -9.308260213506e+04, gap 0.0098%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 95465.07
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93073.45
  [DEBUG]   S×d_nominal = 188538.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188538.52 + -93073.45 = 95465.07
  [DEBUG]   Current θ from Master = 106494.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11029.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30681.16
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 1337.6008, Absolute Gap = 1337.6008, Relative Gap = 0.068064
  Not converged yet (gap = 1337.60 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0x4bd7ebc1
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 1.41s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -406622.8862
Found heuristic solution: objective -230474.5609

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24961   -4.2585368e+04   0.000000e+00   2.249131e+09      5s
   34558   -8.4241003e+03   0.000000e+00   4.662497e+06     10s
   40945   -7.5960474e+03   0.000000e+00   2.095096e+06     15s
   46157   -7.5117645e+03   0.000000e+00   3.601520e+06     20s
   51624   -5.4752103e+03   0.000000e+00   1.726787e+06     25s
   56248   -5.3189739e+03   0.000000e+00   7.393135e+05     30s
   61704   -3.2966122e+03   0.000000e+00   3.947102e+05     35s
   66616   -2.8565809e+03   0.000000e+00   1.394646e+06     40s
   72018   -2.0977155e+03   0.000000e+00   4.606819e+06     45s
   76506   -1.4761841e+03   0.000000e+00   4.918242e+05     50s
Concurrent spin time: 4.54s

Solved with dual simplex

Root relaxation: objective -9.609241e+02, 62748 iterations, 53.15 seconds (74.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -960.92409    0  374 -230474.56 -960.92409   100%     -   55s
H    0     0                    -220739.2141 -960.92409   100%     -   55s
H    0     0                    -49932.32542 -960.92409  98.1%     -   55s
H    0     0                    -49926.12089 -960.92409  98.1%     -   55s
H    0     0                    -41959.35808 -960.92409  97.7%     -   55s
H    0     0                    -30053.68819 -960.92409  96.8%     -   55s
H    0     0                    -29190.99210 -960.92409  96.7%     -   55s
H    0     0                    -28392.25027 -4738.7324  83.3%     -   78s
H    0     0                    -28099.54116 -4738.7324  83.1%     -   78s
     0     0 -4993.5997    0  421 -28099.541 -4993.5997  82.2%     -   78s
     0     0 -4993.5997    0  438 -28099.541 -4993.5997  82.2%     -   81s
     0     0 -4993.5997    0  436 -28099.541 -4993.5997  82.2%     -   85s
     0     0 -4993.5997    0  437 -28099.541 -4993.5997  82.2%     -   87s
     0     0 -4993.5997    0  431 -28099.541 -4993.5997  82.2%     -   87s
H    0     0                    -28041.47047 -6349.0213  77.4%     -  110s
H    0     0                    -27993.92412 -6349.0213  77.3%     -  110s
     0     0 -6349.0213    0  482 -27993.924 -6349.0213  77.3%     -  110s
     0     0 -6659.5009    0  479 -27993.924 -6659.5009  76.2%     -  117s
H    0     0                    -23317.49899 -6669.6846  71.4%     -  118s
H    0     0                    -23233.74846 -6669.6846  71.3%     -  118s
     0     0 -6669.6846    0  482 -23233.748 -6669.6846  71.3%     -  118s
     0     0 -6686.1717    0  492 -23233.748 -6686.1717  71.2%     -  119s
     0     0 -6688.7490    0  495 -23233.748 -6688.7490  71.2%     -  119s
     0     0 -6688.8200    0  495 -23233.748 -6688.8200  71.2%     -  120s
     0     0 -7573.2402    0  476 -23233.748 -7573.2402  67.4%     -  135s
H    0     0                    -23174.68946 -7573.9695  67.3%     -  136s
     0     0 -7915.5177    0  528 -23174.689 -7915.5177  65.8%     -  143s
H    0     0                    -23163.70356 -8341.0640  64.0%     -  150s
H    0     0                    -23058.84232 -8341.0640  63.8%     -  150s
H    0     0                    -23047.40439 -8341.0640  63.8%     -  150s
H    0     0                    -23046.36176 -8341.0640  63.8%     -  150s
     0     0 -8341.0640    0  513 -23046.362 -8341.0640  63.8%     -  150s
     0     0 -8557.1678    0  539 -23046.362 -8557.1678  62.9%     -  157s
     0     0 -8599.3478    0  546 -23046.362 -8599.3478  62.7%     -  161s
     0     0 -8609.2908    0  551 -23046.362 -8609.2908  62.6%     -  162s
     0     0 -8612.5092    0  558 -23046.362 -8612.5092  62.6%     -  162s
     0     0 -8613.9892    0  566 -23046.362 -8613.9892  62.6%     -  163s
     0     0 -8628.2498    0  561 -23046.362 -8628.2498  62.6%     -  163s
     0     0 -8630.2354    0  562 -23046.362 -8630.2354  62.6%     -  164s
     0     0 -8630.3954    0  562 -23046.362 -8630.3954  62.6%     -  164s
     0     0 -9067.3397    0  568 -23046.362 -9067.3397  60.7%     -  180s
H    0     0                    -23039.64361 -9067.4192  60.6%     -  181s
     0     0 -9326.6800    0  504 -23039.644 -9326.6800  59.5%     -  188s
     0     0 -9376.2882    0  517 -23039.644 -9376.2882  59.3%     -  190s
     0     0 -9414.9825    0  558 -23039.644 -9414.9825  59.1%     -  193s
     0     0 -9421.8260    0  559 -23039.644 -9421.8260  59.1%     -  195s
     0     0 -9427.5000    0  530 -23039.644 -9427.5000  59.1%     -  195s
     0     0 -9431.5484    0  527 -23039.644 -9431.5484  59.1%     -  196s
     0     0 -9432.5201    0  532 -23039.644 -9432.5201  59.1%     -  196s
     0     0 -9659.1286    0  605 -23039.644 -9659.1286  58.1%     -  203s
     0     0 -9718.0383    0  615 -23039.644 -9718.0383  57.8%     -  206s
     0     0 -9725.8996    0  561 -23039.644 -9725.8996  57.8%     -  207s
     0     0 -9736.7203    0  611 -23039.644 -9736.7203  57.7%     -  209s
     0     0 -9739.0798    0  623 -23039.644 -9739.0798  57.7%     -  210s
     0     0 -9740.0398    0  622 -23039.644 -9740.0398  57.7%     -  210s
     0     0 -9812.7089    0  589 -23039.644 -9812.7089  57.4%     -  214s
H    0     0                    -22881.41846 -9812.8708  57.1%     -  215s
H    0     0                    -22158.90296 -9812.8708  55.7%     -  215s
H    0     0                    -22026.52033 -9812.8708  55.4%     -  216s
H    0     0                    -21838.28420 -9812.8708  55.1%     -  216s
H    0     0                    -21836.87357 -9812.8708  55.1%     -  216s
     0     0 -9843.6246    0  587 -21836.874 -9843.6246  54.9%     -  218s
     0     0 -9852.5226    0  636 -21836.874 -9852.5226  54.9%     -  219s
     0     0 -9856.0639    0  646 -21836.874 -9856.0639  54.9%     -  220s
     0     0 -9857.7308    0  605 -21836.874 -9857.7308  54.9%     -  221s
     0     0 -9857.9782    0  608 -21836.874 -9857.9782  54.9%     -  221s
     0     0 -9928.9483    0  660 -21836.874 -9928.9483  54.5%     -  225s
     0     0 -9938.4034    0  618 -21836.874 -9938.4034  54.5%     -  227s
     0     0 -9944.9486    0  620 -21836.874 -9944.9486  54.5%     -  228s
     0     0 -9947.2360    0  616 -21836.874 -9947.2360  54.4%     -  228s
     0     0 -9947.5906    0  615 -21836.874 -9947.5906  54.4%     -  229s
     0     0 -9988.7744    0  611 -21836.874 -9988.7744  54.3%     -  233s
     0     0 -10003.169    0  627 -21836.874 -10003.169  54.2%     -  235s
     0     0 -10007.041    0  620 -21836.874 -10007.041  54.2%     -  236s
     0     0 -10009.762    0  627 -21836.874 -10009.762  54.2%     -  236s
     0     0 -10011.907    0  622 -21836.874 -10011.907  54.2%     -  237s
     0     0 -10012.349    0  627 -21836.874 -10012.349  54.1%     -  237s
     0     0 -10049.687    0  603 -21836.874 -10049.687  54.0%     -  241s
     0     0 -10058.289    0  615 -21836.874 -10058.289  53.9%     -  242s
     0     0 -10060.517    0  623 -21836.874 -10060.517  53.9%     -  243s
     0     0 -10061.326    0  622 -21836.874 -10061.326  53.9%     -  243s
     0     0 -10073.556    0  589 -21836.874 -10073.556  53.9%     -  246s
H    0     0                    -21347.53215 -10073.724  52.8%     -  249s
H    0     0                    -21338.94754 -10073.724  52.8%     -  249s
     0     0 -10079.335    0  591 -21338.948 -10079.335  52.8%     -  250s
     0     0 -10081.277    0  602 -21338.948 -10081.277  52.8%     -  251s
     0     0 -10081.754    0  599 -21338.948 -10081.754  52.8%     -  251s
     0     0 -10090.461    0  647 -21338.948 -10090.461  52.7%     -  253s
     0     0 -10092.865    0  651 -21338.948 -10092.865  52.7%     -  254s
     0     0 -10094.225    0  606 -21338.948 -10094.225  52.7%     -  254s
     0     0 -10096.153    0  608 -21338.948 -10096.153  52.7%     -  255s
     0     0 -10096.463    0  601 -21338.948 -10096.463  52.7%     -  255s
     0     0 -10109.817    0  600 -21338.948 -10109.817  52.6%     -  257s
H    0     0                    -21257.09046 -10109.872  52.4%     -  261s
H    0     0                    -21238.50920 -10109.872  52.4%     -  262s
H    0     0                    -21228.51396 -10109.872  52.4%     -  263s
     0     0 -10111.830    0  641 -21228.514 -10111.830  52.4%     -  264s
     0     0 -10113.895    0  646 -21228.514 -10113.895  52.4%     -  265s
     0     0 -10114.181    0  651 -21228.514 -10114.181  52.4%     -  265s
     0     0 -10117.612    0  638 -21228.514 -10117.612  52.3%     -  267s
     0     0 -10118.888    0  643 -21228.514 -10118.888  52.3%     -  268s
     0     0 -10119.157    0  649 -21228.514 -10119.157  52.3%     -  268s
     0     0 -10120.922    0  652 -21228.514 -10120.922  52.3%     -  270s
     0     0 -10121.841    0  650 -21228.514 -10121.841  52.3%     -  271s
     0     0 -10122.784    0  653 -21228.514 -10122.784  52.3%     -  272s
     0     0 -10122.874    0  653 -21228.514 -10122.874  52.3%     -  275s
H    0     0                    -21118.72114 -10122.984  52.1%     -  315s
     0     2 -10122.984    0  653 -21118.721 -10122.984  52.1%     -  316s
     1     4 -10137.479    1  631 -21118.721 -10122.990  52.1%  1535  320s
     3     8 -10165.094    2  625 -21118.721 -10137.756  52.0%  2807  328s
     7    16 -10220.191    3  683 -21118.721 -10165.203  51.9%  5121  334s
    15    32 -10336.592    4  610 -21118.721 -10220.231  51.6%  5538  346s
    31    48 -10529.674    5  626 -21118.721 -10337.256  51.1%  8026  364s
    47    80 -10667.912    6  623 -21118.721 -10337.256  51.1%  6626  377s
H   51    80                    -20730.79939 -10337.256  50.1%  6253  377s
    79   150 -10703.937    7  608 -20730.799 -10337.256  50.1%  4981  404s
   149   266 -10931.904    9  421 -20730.799 -10337.256  50.1%  3692  422s
   267   381 -10848.293    9  611 -20730.799 -10337.256  50.1%  2889  434s
   389   420 -10968.641   10  419 -20730.799 -10337.256  50.1%  2413  447s
   435   473 -11035.621   10  407 -20730.799 -10337.256  50.1%  2270  464s
   509   526 -10948.385   10  597 -20730.799 -10337.256  50.1%  2096  477s
   582   567 -10849.729   10  609 -20730.799 -10337.256  50.1%  1996  488s
   655   600 -11158.772   11  389 -20730.799 -10337.256  50.1%  1880  501s
   714   660 -11232.922   11  417 -20730.799 -10337.256  50.1%  1837  512s
   789   693 -18798.564   11  167 -20730.799 -10337.256  50.1%  1786  523s
   864   745 -11286.740   12  387 -20730.799 -10337.256  50.1%  1746  534s
   956   769 -11424.834   12  422 -20730.799 -10337.256  50.1%  1685  546s
  1024   803 -15116.179   12  387 -20730.799 -10337.256  50.1%  1652  559s
  1096   834 -11648.741   13  396 -20730.799 -10337.256  50.1%  1622  571s
  1157   909     cutoff   23      -20730.799 -10337.256  50.1%  1608  583s
  1250   989 -11724.771   14  438 -20730.799 -10337.256  50.1%  1572  594s
  1367  1046 -12017.890   15  442 -20730.799 -10337.256  50.1%  1513  606s
  1487  1080 -11774.704   15  443 -20730.799 -10337.256  50.1%  1458  618s
  1581  1126 -12096.629   16  449 -20730.799 -10337.256  50.1%  1467  634s
  1658  1172 -11832.749   16  448 -20730.799 -10467.880  49.5%  1467  648s
  1749  1213 -12339.321   17  324 -20730.799 -10468.789  49.5%  1473  662s
  1833  1266 -12504.440   17  477 -20730.799 -10468.789  49.5%  1498  678s
  1928  1324 -12649.274   17  370 -20730.799 -10468.789  49.5%  1538  692s
  2032  1419 -12638.449   17  435 -20730.799 -10468.789  49.5%  1555  707s
  2191  1483 -16327.013   16  198 -20730.799 -10468.789  49.5%  1520  723s
  2325  1520 -16045.140   16  173 -20730.799 -10468.789  49.5%  1507  740s
  2464  1609 -12439.245   18  288 -20730.799 -10468.789  49.5%  1504  756s
  2625  1732 -13096.567   18  332 -20730.799 -10468.789  49.5%  1505  774s
  2825  1851 -16803.740   18  204 -20730.799 -10468.789  49.5%  1478  792s
  3012  1966 -14721.670   19  200 -20730.799 -10468.789  49.5%  1447  812s
  3215  2057 -12683.225   19  289 -20730.799 -10468.789  49.5%  1419  830s
  3416  2185 -12948.705   20  221 -20730.799 -10877.662  47.5%  1409  850s
  3636  2312     cutoff   20      -20730.799 -10945.682  47.2%  1391  870s
  3913  2428 -14182.143   22  235 -20730.799 -10956.048  47.2%  1370  892s
  4129  2565 -14825.774   23  269 -20730.799 -10956.048  47.2%  1371  913s
  4363  2566 -18489.543   31  653 -20730.799 -11040.117  46.7%  1367 1013s
  4365  2567 -18382.502   21  374 -20730.799 -11040.117  46.7%  1367 1080s
  4366  2568 -19954.540   24  551 -20730.799 -11040.117  46.7%  1366 1127s
  4367  2569 -11994.678   14  619 -20730.799 -11040.117  46.7%  1366 1160s
  4368  2569 -20551.231   35  653 -20730.799 -11040.117  46.7%  1366 1178s
  4369  2570 -15132.193   28  618 -20730.799 -11040.117  46.7%  1366 1191s
  4370  2571 -12571.908    7  594 -20730.799 -11040.117  46.7%  1365 1200s
  4371  2571 -14346.599    8  594 -20730.799 -11040.117  46.7%  1365 1207s
  4372  2572 -12410.381   11  554 -20730.799 -11040.117  46.7%  1365 1212s
  4373  2573 -18273.132   27  609 -20730.799 -11040.117  46.7%  1364 1217s
  4375  2574 -19051.608   51  624 -20730.799 -11040.117  46.7%  1364 1222s
  4377  2575 -18786.054   53  637 -20730.799 -11040.117  46.7%  1363 1225s
  4379  2577 -17794.439   34  651 -20730.799 -11040.117  46.7%  1362 1230s
  4380  2577 -12799.963   24  628 -20730.799 -11040.117  46.7%  1362 1240s
  4383  2579 -19853.887   34  586 -20730.799 -11040.117  46.7%  1361 1245s
  4385  2581 -19071.253   19  585 -20730.799 -11040.117  46.7%  1361 1251s
  4386  2581 -18543.362   23  623 -20730.799 -11040.117  46.7%  1360 1258s
  4387  2582 -19596.317   26  594 -20730.799 -11040.117  46.7%  1360 1260s
  4389  2583 -18333.251   29  647 -20730.799 -11040.117  46.7%  1359 1265s
  4390  2584 -13062.509   14  592 -20730.799 -11040.117  46.7%  1359 1271s
  4392  2585 -16873.188   23  590 -20730.799 -11040.117  46.7%  1358 1276s
  4393  2586 -19553.021   53  651 -20730.799 -11040.117  46.7%  1358 1283s
  4395  2587 -12885.624   10  654 -20730.799 -11040.117  46.7%  1357 1288s
  4396  2588 -16268.764   30  513 -20730.799 -11040.117  46.7%  1357 1298s
  4397  2589 -19358.871   52  500 -20730.799 -11040.117  46.7%  1357 1301s
  4398  2589 -20310.575   32  560 -20730.799 -11040.117  46.7%  1357 1306s
  4400  2591 -11500.396   14  636 -20730.799 -11040.117  46.7%  1356 1315s
  4402  2592 -18967.073   33  645 -20730.799 -11040.117  46.7%  1355 1323s
  4403  2593 -16487.371   33  649 -20730.799 -11040.117  46.7%  1355 1327s
  4404  2593 -11266.479    9  659 -20730.799 -11040.117  46.7%  1355 1331s
  4405  2594 -15937.451   28  659 -20730.799 -11040.117  46.7%  1354 1393s
  4406  2595 -20643.971   65  659 -20730.799 -11040.117  46.7%  1354 1424s
  4407  2598 -11040.117   16  626 -20730.799 -11040.117  46.7%  1402 1465s
  4409  2602 -11040.117   17  624 -20730.799 -11040.117  46.7%  1403 1484s
  4413  2608 -11040.117   18  634 -20730.799 -11040.117  46.7%  1406 1512s
  4421  2622 -11040.117   19  641 -20730.799 -11040.117  46.7%  1422 1536s
  4437  2635 -18784.871   20  260 -20730.799 -11040.117  46.7%  1464 1573s
  4456  2657 -12757.949   21  273 -20730.799 -11040.117  46.7%  1525 1596s
  4488  2732 -13689.011   22  424 -20730.799 -11040.117  46.7%  1558 1620s
  4607  2720 -14202.558   25  252 -20730.799 -11040.117  46.7%  1592 1637s
  4689  2696 -14501.564   26  347 -20730.799 -11040.117  46.7%  1623 1652s
  4751  2695 -17125.221   27  199 -20730.799 -11040.117  46.7%  1638 1666s
  4809  2699 -14593.337   27  261 -20730.799 -11040.117  46.7%  1661 1681s
  4857  2713 -17723.047   28  219 -20730.799 -11040.117  46.7%  1691 1703s
  4923  2709 -17505.121   28  379 -20730.799 -11040.117  46.7%  1735 1717s
  4984  2720 -19237.298   29  333 -20730.799 -11040.117  46.7%  1754 1731s
  5039  2718     cutoff   29      -20730.799 -11040.117  46.7%  1781 1750s
H 5054  2582                    -20101.90954 -11040.117  45.1%  1782 1750s
  5107  2589 -14571.920   25  443 -20101.910 -11040.117  45.1%  1800 1765s
  5194  2578 -15708.928   26  254 -20101.910 -11040.117  45.1%  1805 1781s
H 5203  2451                    -19954.52268 -11040.117  44.7%  1811 1781s
H 5221  2327                    -19945.52546 -11040.117  44.6%  1819 1781s
H 5222  2216                    -19941.71719 -11040.117  44.6%  1819 1781s
  5231  2245 -16686.310   27  390 -19941.717 -11040.117  44.6%  1825 1798s
  5324  2218     cutoff   28      -19941.717 -11040.117  44.6%  1833 1819s
  5405  2199 -18970.014   29  268 -19941.717 -11040.117  44.6%  1848 1833s
  5482  2190 -18979.583   30  264 -19941.717 -11040.117  44.6%  1866 1856s
  5570  2185     cutoff   34      -19941.717 -11040.117  44.6%  1884 1870s
  5637  2201 -14816.692   28  400 -19941.717 -11040.117  44.6%  1918 1883s
  5728  2199 -15208.398   29  356 -19941.717 -11040.117  44.6%  1934 1900s
  5814  2194 -16633.287   31  297 -19941.717 -11040.117  44.6%  1961 1920s
  5911  2194 -17538.118   33  269 -19941.717 -11040.117  44.6%  1989 1938s
  6012  2177 -18185.118   37  129 -19941.717 -11040.117  44.6%  2013 1959s
  6101  2173 -15260.412   32  415 -19941.717 -11040.117  44.6%  2032 1978s
  6153  2188 -15562.399   33  283 -19941.717 -11040.117  44.6%  2064 1996s
  6238  2194 -16205.519   36  142 -19941.717 -11040.117  44.6%  2087 2016s
  6341  2192 -19275.980   42  207 -19941.717 -11040.117  44.6%  2115 2038s
  6453  2195 -15183.518   25  380 -19941.717 -11040.117  44.6%  2150 2058s
  6550  2196 -19869.036   26  293 -19941.717 -11040.117  44.6%  2189 2079s
  6639  2186     cutoff   27      -19941.717 -11040.117  44.6%  2203 2102s
  6754  2193 -16912.249   26  407 -19941.717 -11040.117  44.6%  2225 2124s
  6872  2183 -19385.234   28  200 -19941.717 -11040.117  44.6%  2235 2147s
  6990  2209 -17395.352   29  295 -19941.717 -11040.117  44.6%  2269 2175s
  7134  2228 -18362.008   33  303 -19941.717 -11040.117  44.6%  2294 2210s
  7268  2211 -19787.655   35  293 -19941.717 -11040.117  44.6%  2336 2238s
  7433  2185 -13881.176   23  467 -19941.717 -12345.391  38.1%  2375 2264s
  7510  2208 -14632.791   25  403 -19941.717 -12345.391  38.1%  2402 2295s
  7647  2195 -19309.516   30  160 -19941.717 -12895.571  35.3%  2426 2324s
  7793  2172 -18716.141   23  189 -19941.717 -13266.895  33.5%  2462 2353s
  7979  2140 -17100.866   26  493 -19941.717 -13266.895  33.5%  2496 2383s
  8112  2158     cutoff   27      -19941.717 -13266.895  33.5%  2525 2415s
  8322  2100 -18540.732   28  304 -19941.717 -13433.930  32.6%  2558 2447s
  8539  2069 -15501.843   26  406 -19941.717 -13433.930  32.6%  2591 2480s
  8756  1989 -17313.025   30  346 -19941.717 -13433.930  32.6%  2625 2513s
  8851  2005 -18218.435   32  289 -19941.717 -13529.694  32.2%  2645 2547s
  9023  1974     cutoff   26      -19941.717 -13529.694  32.2%  2675 2583s
  9265  1960 -16274.623   28  405 -19941.717 -13529.694  32.2%  2703 2621s
  9530  1917 -17976.946   31  166 -19941.717 -13529.694  32.2%  2733 2665s
  9842  1893 -19884.046   29  296 -19941.717 -14036.431  29.6%  2762 2706s
 10158  1802     cutoff   26      -19941.717 -14111.595  29.2%  2786 2743s
 10207  1800 -18364.059   26  327 -19941.717 -14111.595  29.2%  2798 2783s
 10345  1810 -18663.456   27  348 -19941.717 -14111.595  29.2%  2806 2824s
 10648  1732     cutoff   28      -19941.717 -14320.238  28.2%  2822 2869s
 11021  1737 -18823.976   29  475 -19941.717 -14469.940  27.4%  2858 2914s
 11398  1750 -19482.722   34  483 -19941.717 -14758.294  26.0%  2881 2957s
 11803  1753     cutoff   36      -19941.717 -14786.518  25.9%  2918 3005s
 12184  1723 -19497.899   29  283 -19941.717 -15119.485  24.2%  2966 3054s
 12578  1698     cutoff   35      -19941.717 -15343.792  23.1%  3004 3105s
 12906  1685 -19151.246   34  159 -19941.717 -15457.091  22.5%  3039 3163s
 13309  1594     cutoff   25      -19941.717 -15746.544  21.0%  3065 3220s
 13812  1469 -19849.595   36   62 -19941.717 -16054.847  19.5%  3093 3279s
 14299  1222 -18946.966   32  401 -19941.717 -16302.268  18.3%  3126 3339s
 14915   812     cutoff   30      -19941.717 -16937.612  15.1%  3134 3401s
 15671   245     cutoff   33      -19941.717 -17249.326  13.5%  3123 3459s
 16594     0     cutoff   30      -19941.717 -17936.953  10.1%  3059 3484s

Cutting planes:
  MIR: 794
  Flow cover: 2253
  GUB cover: 1
  Zero half: 4
  RLT: 22
  Relax-and-lift: 121

Explored 16919 nodes (51443579 simplex iterations) in 3484.98 seconds (6483.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19941.7 -19945.5 -19954.5 ... -21338.9
No other solutions better than -19941.7

Optimal solution found (tolerance 1.00e-04)
Best objective -1.994171719323e+04, best bound -1.994171719323e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3485.00s
  Master Objective (UB) = -19941.72, θ = 106602.43
  Upper Bound (UB) = -19941.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 106602.43
  [DEBUG]   ✓ Scenario 0: θ = 106602.43 ≤ Q = 106602.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 106602.43 ≤ Q = 106602.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 106602.43 ≤ Q = 106602.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 106602.43 ≤ Q = 106602.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 106602.43 ≤ Q = 106602.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 106602.43 ≤ Q = 106602.43 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d7c5e83
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc283a17d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-01, 2e+02]
Found heuristic solution: objective 1.235762e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6785885.3309
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.135612e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113561.19    0  122 6785885.33 -113561.19   102%     -    0s
H    0     0                    -78674.22362 -113561.19  44.3%     -    0s
H    0     0                    -79806.68060 -113561.19  42.3%     -    0s
H    0     0                    -80124.36059 -113561.19  41.7%     -    0s
H    0     0                    -80237.41615 -113561.19  41.5%     -    0s
     0     0 -87697.194    0   70 -80237.416 -87697.194  9.30%     -    0s
H    0     0                    -85204.80937 -87601.848  2.81%     -    0s
     0     0 -87304.531    0   71 -85204.809 -87304.531  2.46%     -    0s
H    0     0                    -85773.25647 -87287.570  1.77%     -    0s
H    0     0                    -85790.92314 -87287.570  1.74%     -    0s
     0     0 -87144.460    0   74 -85790.923 -87144.460  1.58%     -    0s
     0     0 -87127.423    0   74 -85790.923 -87127.423  1.56%     -    0s
     0     2 -87106.938    0   74 -85790.923 -87106.938  1.53%     -    0s
H   30    32                    -85837.88567 -86818.126  1.14%   8.3    0s
H 1073   509                    -85851.72279 -86510.859  0.77%   7.1    0s

Cutting planes:
  Gomory: 49
  Implied bound: 2
  MIR: 176
  RLT: 1

Explored 7785 nodes (48505 simplex iterations) in 0.44 seconds (0.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -85851.7 -85837.9 -85790.9 ... 1.23576e+13
No other solutions better than -85851.7

Optimal solution found (tolerance 1.00e-04)
Best objective -8.585172278949e+04, best bound -8.585172278949e+04, gap 0.0000%
  Subproblem solved in 0.47s
  Worst-case operational profit (Z_SP) = 102748.84
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85851.72
  [DEBUG]   S×d_nominal = 188600.57
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188600.57 + -85851.72 = 102748.84
  [DEBUG]   Current θ from Master = 106602.43
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3853.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23795.31
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 1047.9111, Absolute Gap = 1047.9111, Relative Gap = 0.052549
  Not converged yet (gap = 1047.91 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0xb03406f5
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 1.92s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -406622.8862
Found heuristic solution: objective -230474.5609

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25903   -1.1539261e+05   0.000000e+00   1.522013e+08      5s
   38397   -1.4012090e+04   0.000000e+00   2.096166e+07     10s
   43348   -1.2525718e+04   0.000000e+00   2.059543e+07     15s
   48174   -1.1538388e+04   0.000000e+00   1.902120e+06     20s
   52645   -1.0849963e+04   0.000000e+00   4.574812e+07     25s
   57178   -9.2330876e+03   0.000000e+00   1.337767e+08     30s
   61742   -8.7994671e+03   0.000000e+00   4.970702e+06     35s
   66925   -6.7107389e+03   0.000000e+00   7.018162e+05     40s
   71553   -5.8530486e+03   0.000000e+00   2.450518e+06     45s
   75647   -5.5539615e+03   0.000000e+00   4.257794e+05     50s
   79881   -5.1746009e+03   0.000000e+00   1.578326e+06     55s
   83829   -4.8107072e+03   0.000000e+00   2.813837e+06     60s
   88355   -3.6769590e+03   0.000000e+00   1.092730e+08     65s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -9.700051e+02, 62126 iterations, 64.38 seconds (83.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -970.00514    0  359 -230474.56 -970.00514   100%     -   67s
H    0     0                    -218355.3265 -970.00514   100%     -   67s
H    0     0                    -56270.90551 -970.00514  98.3%     -   67s
H    0     0                    -55946.69208 -970.00514  98.3%     -   67s
H    0     0                    -47979.92927 -970.00514  98.0%     -   67s
H    0     0                    -38906.22239 -970.00514  97.5%     -   67s
H    0     0                    -30031.35504 -970.00514  96.8%     -   67s
H    0     0                    -29308.27499 -970.00514  96.7%     -   67s
H    0     0                    -29135.77794 -970.00514  96.7%     -   67s
H    0     0                    -26106.36397 -4506.1460  82.7%     -   95s
H    0     0                    -26102.52282 -4506.1460  82.7%     -   95s
H    0     0                    -26078.91262 -4506.1460  82.7%     -   95s
H    0     0                    -26038.99578 -4506.1460  82.7%     -   95s
     0     0 -4518.3304    0  434 -26038.996 -4518.3304  82.6%     -   96s
     0     0 -4988.7639    0  448 -26038.996 -4988.7639  80.8%     -  106s
     0     0 -4988.7639    0  450 -26038.996 -4988.7639  80.8%     -  107s
     0     0 -4988.7639    0  454 -26038.996 -4988.7639  80.8%     -  108s
     0     0 -5035.4701    0  455 -26038.996 -5035.4701  80.7%     -  109s
     0     0 -5056.6532    0  446 -26038.996 -5056.6532  80.6%     -  115s
     0     0 -5056.6532    0  451 -26038.996 -5056.6532  80.6%     -  117s
     0     0 -5056.6532    0  449 -26038.996 -5056.6532  80.6%     -  118s
     0     0 -5056.6532    0  453 -26038.996 -5056.6532  80.6%     -  119s
H    0     0                    -25959.28301 -6112.1301  76.5%     -  141s
H    0     0                    -25957.87238 -6112.1301  76.5%     -  141s
     0     0 -6112.1301    0  484 -25957.872 -6112.1301  76.5%     -  141s
H    0     0                    -25743.00283 -6112.1711  76.3%     -  142s
     0     0 -6201.5902    0  486 -25743.003 -6201.5902  75.9%     -  147s
     0     0 -6217.5073    0  498 -25743.003 -6217.5073  75.8%     -  148s
     0     0 -6231.0286    0  442 -25743.003 -6231.0286  75.8%     -  149s
     0     0 -6235.0847    0  507 -25743.003 -6235.0847  75.8%     -  150s
     0     0 -6235.3770    0  506 -25743.003 -6235.3770  75.8%     -  151s
H    0     0                    -25424.59273 -7155.7526  71.9%     -  181s
H    0     0                    -24093.25799 -7155.7526  70.3%     -  181s
H    0     0                    -24042.01426 -7155.7526  70.2%     -  181s
     0     0 -7155.7526    0  533 -24042.014 -7155.7526  70.2%     -  181s
H    0     0                    -23317.65765 -7155.9638  69.3%     -  181s
H    0     0                    -23082.00874 -7155.9638  69.0%     -  181s
     0     0 -7906.5143    0  482 -23082.009 -7906.5143  65.7%     -  197s
     0     0 -8058.6562    0  505 -23082.009 -8058.6562  65.1%     -  206s
     0     0 -8106.3629    0  545 -23082.009 -8106.3629  64.9%     -  212s
     0     0 -8135.1139    0  504 -23082.009 -8135.1139  64.8%     -  216s
     0     0 -8139.0728    0  500 -23082.009 -8139.0728  64.7%     -  217s
     0     0 -8139.7992    0  507 -23082.009 -8139.7992  64.7%     -  217s
     0     0 -8176.1203    0  514 -23082.009 -8176.1203  64.6%     -  225s
     0     0 -8192.5560    0  501 -23082.009 -8192.5560  64.5%     -  229s
     0     0 -8198.7230    0  504 -23082.009 -8198.7230  64.5%     -  231s
     0     0 -8205.2415    0  507 -23082.009 -8205.2415  64.5%     -  232s
     0     0 -8205.7214    0  510 -23082.009 -8205.7214  64.4%     -  233s
H    0     0                    -23076.71622 -8924.5313  61.3%     -  260s
     0     0 -8924.5313    0  561 -23076.716 -8924.5313  61.3%     -  260s
H    0     0                    -23073.76692 -8924.6226  61.3%     -  261s
     0     0 -9216.4223    0  548 -23073.767 -9216.4223  60.1%     -  272s
     0     0 -9292.7879    0  570 -23073.767 -9292.7879  59.7%     -  278s
     0     0 -9306.0211    0  577 -23073.767 -9306.0211  59.7%     -  280s
     0     0 -9407.7104    0  583 -23073.767 -9407.7104  59.2%     -  283s
     0     0 -9457.4891    0  558 -23073.767 -9457.4891  59.0%     -  287s
     0     0 -9474.0227    0  582 -23073.767 -9474.0227  58.9%     -  290s
     0     0 -9477.4917    0  579 -23073.767 -9477.4917  58.9%     -  291s
     0     0 -9484.2966    0  586 -23073.767 -9484.2966  58.9%     -  294s
     0     0 -9484.4216    0  582 -23073.767 -9484.4216  58.9%     -  295s
     0     0 -9573.4137    0  575 -23073.767 -9573.4137  58.5%     -  304s
H    0     0                    -23036.29146 -9574.0302  58.4%     -  304s
     0     0 -9600.0291    0  573 -23036.291 -9600.0291  58.3%     -  307s
     0     0 -9609.2903    0  591 -23036.291 -9609.2903  58.3%     -  308s
     0     0 -9611.6130    0  594 -23036.291 -9611.6130  58.3%     -  309s
     0     0 -9612.4129    0  596 -23036.291 -9612.4129  58.3%     -  309s
     0     0 -9748.9803    0  572 -23036.291 -9748.9803  57.7%     -  316s
H    0     0                    -23026.76021 -9749.1230  57.7%     -  317s
     0     0 -9780.7437    0  573 -23026.760 -9780.7437  57.5%     -  319s
     0     0 -9792.8861    0  592 -23026.760 -9792.8861  57.5%     -  322s
     0     0 -9796.7749    0  632 -23026.760 -9796.7749  57.5%     -  323s
     0     0 -9798.0556    0  591 -23026.760 -9798.0556  57.4%     -  323s
     0     0 -9798.6571    0  601 -23026.760 -9798.6571  57.4%     -  324s
     0     0 -9834.7506    0  666 -23026.760 -9834.7506  57.3%     -  330s
     0     0 -9851.5662    0  646 -23026.760 -9851.5662  57.2%     -  332s
     0     0 -9857.0170    0  647 -23026.760 -9857.0170  57.2%     -  333s
     0     0 -9860.1974    0  659 -23026.760 -9860.1974  57.2%     -  334s
     0     0 -9861.1224    0  649 -23026.760 -9861.1224  57.2%     -  335s
     0     0 -9879.6608    0  655 -23026.760 -9879.6608  57.1%     -  338s
     0     0 -9884.5262    0  653 -23026.760 -9884.5262  57.1%     -  340s
     0     0 -9890.9717    0  663 -23026.760 -9890.9717  57.0%     -  342s
     0     0 -9891.6916    0  622 -23026.760 -9891.6916  57.0%     -  342s
     0     0 -9899.4833    0  619 -23026.760 -9899.4833  57.0%     -  345s
     0     0 -9905.8171    0  611 -23026.760 -9905.8171  57.0%     -  346s
     0     0 -9907.8386    0  628 -23026.760 -9907.8386  57.0%     -  347s
     0     0 -9908.6706    0  626 -23026.760 -9908.6706  57.0%     -  347s
     0     0 -9914.8897    0  624 -23026.760 -9914.8897  56.9%     -  350s
     0     0 -9915.6140    0  675 -23026.760 -9915.6140  56.9%     -  352s
     0     0 -9916.4953    0  683 -23026.760 -9916.4953  56.9%     -  354s
     0     0 -9917.1296    0  677 -23026.760 -9917.1296  56.9%     -  355s
     0     0 -9917.8268    0  679 -23026.760 -9917.8268  56.9%     -  357s
     0     0 -9918.2489    0  631 -23026.760 -9918.2489  56.9%     -  360s
     0     0 -9918.9551    0  634 -23026.760 -9918.9551  56.9%     -  362s
     0     0 -9918.9942    0  634 -23026.760 -9918.9942  56.9%     -  365s
H    0     0                    -22076.74366 -9919.1335  55.1%     -  405s
H    0     0                    -21906.81220 -9919.1335  54.7%     -  407s
H    0     0                    -21450.04063 -9919.1335  53.8%     -  408s
H    0     0                    -21438.60270 -9919.1335  53.7%     -  408s
H    0     0                    -21261.80450 -9919.1335  53.3%     -  408s
H    0     0                    -21251.00015 -9919.1335  53.3%     -  408s
H    0     0                    -21229.92459 -9919.1335  53.3%     -  409s
     0     2 -9919.1335    0  634 -21229.925 -9919.1335  53.3%     -  410s
     3     8 -9978.2019    2  617 -21229.925 -9938.6389  53.2%  2890  421s
     7    16 -10176.239    3  604 -21229.925 -9978.3449  53.0%  3584  433s
    15    32 -10323.273    4  619 -21229.925 -10176.868  52.1%  4576  446s
    31    49 -17224.343    5  218 -21229.925 -10323.472  51.4%  7177  484s
    48    81 -10714.591    6  578 -21229.925 -10323.472  51.4%  7440  512s
H   61    81                    -21228.51396 -10323.472  51.4%  7280  512s
H   71    81                    -20762.14633 -10323.472  50.3%  6648  512s
    80   212 -10730.953    7  576 -20762.146 -10323.472  50.3%  6103  532s
   211   290 -10898.738   10  377 -20762.146 -10323.472  50.3%  3863  544s
H  232   290                    -20730.79939 -10323.472  50.2%  3665  544s
   295   373 -10809.439    8  540 -20730.799 -10323.472  50.2%  3422  555s
   386   402 -11395.065   19  360 -20730.799 -10323.472  50.2%  3099  565s
   418   424 -11444.434   11  192 -20730.799 -10323.472  50.2%  3030  584s
   454   453 -11471.449   21  309 -20730.799 -10323.472  50.2%  2945  596s
   497   488 -11154.266    9  239 -20730.799 -10323.472  50.2%  2881  606s
   538   521 -11233.357   11  551 -20730.799 -10323.472  50.2%  2906  617s
   583   557 -11494.761   12  193 -20730.799 -10323.472  50.2%  2958  626s
   627   589 -11850.153   14  188 -20730.799 -10323.472  50.2%  2938  639s
   675   627 -11800.093   14  183 -20730.799 -10323.472  50.2%  2951  651s
   728   659 -12020.745   15  184 -20730.799 -10323.472  50.2%  2953  665s
   786   688 -12077.452   16  184 -20730.799 -10323.472  50.2%  2897  678s
   834   726 -12006.007   16  184 -20730.799 -10323.472  50.2%  2951  690s
   883   767 -12015.372   16  178 -20730.799 -10323.472  50.2%  2915  703s
   936   810 -12943.412   17  334 -20730.799 -10323.472  50.2%  2927  716s
   997   856 -18113.598   16  120 -20730.799 -10323.472  50.2%  2927  730s
  1075   902 -13480.025   32  149 -20730.799 -10323.472  50.2%  2862  744s
  1147   949 -17078.264    9  229 -20730.799 -10323.472  50.2%  2873  759s
  1216   993 -17447.708   10  176 -20730.799 -10323.472  50.2%  2885  774s
  1294  1022 -19452.325   14   96 -20730.799 -10323.472  50.2%  2901  790s
  1365  1074 -17971.857   11  169 -20730.799 -10323.472  50.2%  2916  803s
  1456  1135 -19197.117   13  118 -20730.799 -10323.472  50.2%  2957  819s
  1565  1171 -10661.836    6  420 -20730.799 -10323.472  50.2%  2941  835s
  1638  1235 -11778.335    7  291 -20730.799 -10323.472  50.2%  2995  852s
  1738  1315 -11835.695    8  295 -20730.799 -10323.472  50.2%  2986  868s
  1849  1377 -12403.464   11  361 -20730.799 -10323.472  50.2%  2975  887s
  1959  1440 -15138.939   11  166 -20730.799 -10323.472  50.2%  2986  904s
  2089  1472 -16311.957   12  184 -20730.799 -10323.472  50.2%  2957  922s
  2181  1520 -17155.146   13  177 -20730.799 -10353.661  50.1%  2998  940s
  2277  1575 -20102.124   14  460 -20730.799 -10354.242  50.1%  3079  959s
  2410  1669 -18237.913   15  332 -20730.799 -10354.242  50.1%  3093  979s
  2572  1745 -18306.753   16  162 -20730.799 -10354.242  50.1%  3088  999s
  2761  1857 -18655.162   18  158 -20730.799 -10354.242  50.1%  3052 1020s
  2979  1933 -19447.488   20  439 -20730.799 -10354.242  50.1%  2982 1042s
  3151  1990 -19695.811   22  351 -20730.799 -10354.242  50.1%  2968 1065s
  3310  2061 -12513.096   10  190 -20730.799 -10732.976  48.2%  2983 1088s
  3457  2175 -14215.157   14  169 -20730.799 -10732.976  48.2%  3035 1109s
  3652  2257 -15495.708   17  312 -20730.799 -10841.562  47.7%  3052 1135s
  3818  2374 -16364.110   20  332 -20730.799 -10841.562  47.7%  3084 1162s
  3991  2475 -16935.975   24  147 -20730.799 -10841.562  47.7%  3123 1188s
  4198  2551 -20260.804   30   84 -20730.799 -10910.811  47.4%  3099 1216s
  4390  2629 -12239.885   16  181 -20730.799 -10996.328  47.0%  3143 1243s
  4590  2702 -13143.996   19  308 -20730.799 -10996.328  47.0%  3200 1272s
  4813  2724 -18652.470   23   99 -20730.799 -11001.838  46.9%  3223 1293s
  4855  2725 -20105.764   15  634 -20730.799 -11001.838  46.9%  3246 1408s
  4857  2726 -14102.213   10  359 -20730.799 -11001.838  46.9%  3245 1487s
  4858  2727 -18196.089   34  534 -20730.799 -11001.838  46.9%  3244 1561s
  4859  2728 -13750.314   15  550 -20730.799 -11001.838  46.9%  3244 1594s
  4860  2728 -18821.740   34  620 -20730.799 -11001.838  46.9%  3243 1610s
  4861  2729 -15378.346   11  585 -20730.799 -11001.838  46.9%  3242 1624s
  4862  2730 -13726.423   20  607 -20730.799 -11001.838  46.9%  3242 1629s
  4863  2730 -17161.925   17  667 -20730.799 -11001.838  46.9%  3241 1632s
  4864  2731 -15584.566   19  612 -20730.799 -11001.838  46.9%  3240 1642s
  4865  2732 -15879.582   20  586 -20730.799 -11001.838  46.9%  3240 1651s
  4866  2732 -16166.979   14  616 -20730.799 -11001.838  46.9%  3239 1655s
  4869  2734 -18144.247   15  632 -20730.799 -11001.838  46.9%  3237 1660s
  4871  2736 -17228.830   18  593 -20730.799 -11001.838  46.9%  3236 1667s
  4872  2736 -20017.286   34  583 -20730.799 -11001.838  46.9%  3235 1684s
  4873  2737 -19753.480   37  603 -20730.799 -11001.838  46.9%  3234 1690s
  4874  2738 -17830.046   24  619 -20730.799 -11001.838  46.9%  3234 1699s
  4875  2738 -19217.200   47  628 -20730.799 -11001.838  46.9%  3233 1703s
  4876  2739 -11909.108    9  634 -20730.799 -11001.838  46.9%  3232 1709s
  4877  2740 -12483.728   14  611 -20730.799 -11001.838  46.9%  3232 1719s
  4878  2740 -15436.809   12  618 -20730.799 -11001.838  46.9%  3231 1722s
  4879  2741 -17360.933    7  613 -20730.799 -11001.838  46.9%  3230 1727s
  4880  2742 -14930.189   18  572 -20730.799 -11001.838  46.9%  3230 1731s
  4882  2743 -11461.947   11  575 -20730.799 -11001.838  46.9%  3228 1735s
  4883  2744 -17073.534   22  574 -20730.799 -11001.838  46.9%  3228 1745s
  4885  2745 -13135.178    7  624 -20730.799 -11001.838  46.9%  3226 1753s
  4886  2746 -16368.412   25  561 -20730.799 -11001.838  46.9%  3226 1762s
  4888  2747 -20685.755   18  559 -20730.799 -11001.838  46.9%  3224 1766s
  4890  2748 -19653.236   24  561 -20730.799 -11001.838  46.9%  3223 1781s
  4892  2750 -13838.293   18  567 -20730.799 -11001.838  46.9%  3222 1791s
  4893  2750 -19343.240   36  581 -20730.799 -11001.838  46.9%  3221 1795s
  4894  2751 -18441.048   19  567 -20730.799 -11001.838  46.9%  3220 1801s
  4895  2752 -12889.710   19  571 -20730.799 -11001.838  46.9%  3220 1805s
  4896  2752 -18714.259   26  582 -20730.799 -11001.838  46.9%  3219 1811s
  4898  2754 -17520.048   24  593 -20730.799 -11001.838  46.9%  3218 1819s
  4899  2754 -12007.777   17  593 -20730.799 -11001.838  46.9%  3217 1893s
  4900  2755 -17898.500   20  593 -20730.799 -11001.838  46.9%  3217 1933s
  4901  2759 -11001.838   10  579 -20730.799 -11001.838  46.9%  3279 1982s
  4903  2762 -11001.838   11  621 -20730.799 -11001.838  46.9%  3281 2003s
  4907  2769 -11001.838   12  624 -20730.799 -11001.838  46.9%  3282 2031s
  4915  2782 -11001.838   13  681 -20730.799 -11001.838  46.9%  3289 2054s
  4931  2794 -18335.982   14  244 -20730.799 -11001.838  46.9%  3316 2109s
  4948  2813 -11980.261   15  407 -20730.799 -11001.838  46.9%  3360 2143s
  4980  2852 -12502.710   16  291 -20730.799 -11001.838  46.9%  3400 2179s
  5057  2882 -13564.092   18  273 -20730.799 -11001.838  46.9%  3483 2213s
  5130  2909 -13806.972   19  235 -20730.799 -11001.838  46.9%  3499 2240s
H 5133  2769                    -20357.28788 -11001.838  46.0%  3500 2240s
H 5176  2623                    -20038.34375 -11001.838  45.1%  3499 2241s
  5219  2634 -14871.870   21  391 -20038.344 -11001.838  45.1%  3500 2260s
  5318  2634     cutoff   20      -20038.344 -11001.838  45.1%  3472 2278s
H 5319  2508                    -20037.92522 -11001.838  45.1%  3472 2278s
  5398  2499 -15080.489   25  259 -20037.925 -11001.838  45.1%  3452 2299s
  5476  2481 infeasible   28      -20037.925 -11001.838  45.1%  3434 2317s
  5528  2486     cutoff   28      -20037.925 -11001.838  45.1%  3435 2335s
  5604  2477 -19061.607   31  125 -20037.925 -11001.838  45.1%  3413 2352s
  5683  2464     cutoff   33      -20037.925 -11001.838  45.1%  3394 2371s
  5756  2460     cutoff   35      -20037.925 -11001.838  45.1%  3379 2403s
  5823  2465 -14501.180   18  408 -20037.925 -11001.838  45.1%  3369 2420s
  5898  2469 -14990.022   19  285 -20037.925 -11001.838  45.1%  3363 2436s
  5974  2463 -18004.246   23  147 -20037.925 -11001.838  45.1%  3346 2457s
  6063  2453 -19758.195   26  125 -20037.925 -11001.838  45.1%  3333 2477s
  6149  2438 -17375.627   19  260 -20037.925 -11001.838  45.1%  3322 2503s
  6189  2449 -17683.436   20  389 -20037.925 -11001.838  45.1%  3320 2527s
  6231  2455 -17894.416   21  401 -20037.925 -11001.838  45.1%  3319 2563s
  6294  2456 -18010.332   22  376 -20037.925 -11001.838  45.1%  3313 2591s
  6344  2453 -18211.193   23  375 -20037.925 -11001.838  45.1%  3311 2619s
H 6363  2328                    -19944.72422 -11001.838  44.8%  3307 2619s
  6424  2341 -18267.195   24  334 -19944.724 -11001.838  44.8%  3298 2643s
  6507  2333 -19144.496   26  266 -19944.724 -11001.838  44.8%  3286 2676s
  6635  2297 infeasible   20      -19944.724 -11326.563  43.2%  3269 2702s
  6738  2308 -13043.176   16  435 -19944.724 -11562.281  42.0%  3265 2729s
  6854  2304 -13486.017   17  301 -19944.724 -11562.395  42.0%  3261 2757s
  7011  2275 -17034.196   19  188 -19944.724 -11562.395  42.0%  3243 2784s
  7131  2291 -19807.058   22  277 -19944.724 -11562.395  42.0%  3233 2815s
  7269  2288 -15087.121   21  402 -19944.724 -11562.395  42.0%  3225 2848s
  7401  2270 -15605.553   24  149 -19944.724 -11562.395  42.0%  3220 2882s
  7541  2269 -19561.410   29  213 -19944.724 -11562.395  42.0%  3212 2915s
  7686  2267 -17965.119   24  159 -19944.724 -12855.392  35.5%  3208 2952s
  7840  2278 -16090.469   24  180 -19944.724 -12857.146  35.5%  3199 2989s
  7990  2255 -16997.836   22  553 -19944.724 -12857.146  35.5%  3199 3022s
  8164  2240 -17295.311   25  403 -19944.724 -12857.146  35.5%  3178 3059s
  8312  2215     cutoff   28      -19944.724 -12857.146  35.5%  3170 3097s
  8524  2192     cutoff   28      -19944.724 -13788.678  30.9%  3149 3139s
  8685  2196 -18630.602   21  479 -19944.724 -13990.699  29.9%  3156 3176s
  8882  2180 -19675.548   24  472 -19944.724 -14375.236  27.9%  3143 3219s
  9149  2113     cutoff   25      -19944.724 -14508.007  27.3%  3118 3262s
  9391  2101 -18854.807   28  359 -19944.724 -14661.597  26.5%  3105 3307s
  9655  2050 -18547.603   21  429 -19944.724 -14708.868  26.3%  3094 3353s
  9981  1966     cutoff   24      -19944.724 -14862.150  25.5%  3062 3404s
 10254  1855     cutoff   24      -19944.724 -14862.150  25.5%  3059 3461s
 10539  1761 -19701.938   21  506 -19944.724 -15283.298  23.4%  3051 3514s
 10844  1626 -18439.295   24  528 -19944.724 -15336.889  23.1%  3038 3570s
 11153  1506 -18024.749   24  211 -19944.724 -15650.028  21.5%  3030 3600s

Cutting planes:
  Learned: 1
  MIR: 959
  Flow cover: 2273
  Zero half: 2
  RLT: 16
  Relax-and-lift: 130

Explored 11353 nodes (34489485 simplex iterations) in 3600.05 seconds (6299.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19944.7 -20037.9 -20038.3 ... -21261.8

Time limit reached
Best objective -1.994472422284e+04, best bound -1.579468273808e+04, gap 20.8077%
  WARNING: Time limit reached. Using best solution found (gap: 20.81%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -19944.72, θ = 106649.37
  Upper Bound (UB) = -19944.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 106649.37
  [DEBUG]   ✓ Scenario 0: θ = 106649.37 ≤ Q = 106649.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 106649.37 ≤ Q = 106649.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 106649.37 ≤ Q = 106649.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 106649.37 ≤ Q = 106649.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 106649.37 ≤ Q = 106649.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 106649.37 ≤ Q = 106649.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 106649.37 ≤ Q = 106649.37 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5c7198ba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5c7198ba
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-01, 2e+02]
Found heuristic solution: objective 1.238742e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6787579.0800
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.134283e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113428.34    0  122 6787579.08 -113428.34   102%     -    0s
H    0     0                    -78518.07974 -113428.34  44.5%     -    0s
H    0     0                    -79701.24087 -113428.34  42.3%     -    0s
H    0     0                    -80018.92085 -113428.34  41.8%     -    0s
H    0     0                    -80115.89002 -113428.34  41.6%     -    0s
     0     0 -85855.739    0   65 -80115.890 -85855.739  7.16%     -    0s
     0     0 -85650.617    0   68 -80115.890 -85650.617  6.91%     -    0s
H    0     0                    -84668.55371 -85646.979  1.16%     -    0s
H    0     0                    -84838.12036 -85646.979  0.95%     -    0s
     0     0 -85639.109    0   68 -84838.120 -85639.109  0.94%     -    0s
H    0     0                    -85433.70263 -85639.109  0.24%     -    0s
H    0     0                    -85454.95178 -85470.564  0.02%     -    0s
     0     0 -85470.564    0   46 -85454.952 -85470.564  0.02%     -    0s
     0     0 -85465.620    0   44 -85454.952 -85465.620  0.01%     -    0s
     0     0          -    0      -85454.952 -85461.803  0.01%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 158
  Flow cover: 3
  RLT: 3
  Relax-and-lift: 1
  BQP: 4

Explored 1 nodes (474 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -85455 -84838.1 -84668.6 ... 1.23874e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -8.545495177634e+04, best bound -8.546180298254e+04, gap 0.0080%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 103067.91
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85454.95
  [DEBUG]   S×d_nominal = 188522.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188522.86 + -85454.95 = 103067.91
  [DEBUG]   Current θ from Master = 106649.37
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3581.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23526.19
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 1044.9041, Absolute Gap = 1044.9041, Relative Gap = 0.052390
  Not converged yet (gap = 1044.90 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0x48ac520a
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 2.51s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -406622.8862
Found heuristic solution: objective -230474.5609

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25606   -1.4552815e+05   0.000000e+00   2.350328e+08      5s
   39492   -3.3208876e+04   0.000000e+00   4.325717e+07     10s
   47187   -1.6375298e+04   0.000000e+00   4.709414e+06     15s
   53867   -1.0451350e+04   0.000000e+00   9.494319e+06     20s
   58671   -9.0274955e+03   0.000000e+00   2.025482e+06     25s
   64313   -6.8003764e+03   0.000000e+00   5.257286e+07     30s
   68705   -6.3554345e+03   0.000000e+00   3.579159e+06     35s
   73807   -4.9642087e+03   0.000000e+00   8.024507e+07     40s
   77547   -4.5387597e+03   0.000000e+00   4.657286e+08     45s
   81573   -4.2388399e+03   0.000000e+00   4.677092e+05     50s
   84846   -4.0198783e+03   0.000000e+00   1.712366e+06     55s
   88721   -3.8008320e+03   0.000000e+00   1.969654e+06     60s
   92286   -3.7374982e+03   0.000000e+00   3.852340e+05     65s
   96036   -2.8981797e+03   0.000000e+00   7.166819e+06     70s
   99966   -2.3547725e+03   0.000000e+00   1.359039e+06     75s
  103221   -2.2006092e+03   0.000000e+00   1.858302e+06     80s
  106631   -2.1238351e+03   0.000000e+00   7.609575e+05     85s
  110285   -2.0284061e+03   0.000000e+00   1.822199e+06     90s
  114139   -1.8449270e+03   0.000000e+00   3.481046e+05     95s
  117239   -1.8434893e+03   0.000000e+00   4.931983e+05    100s
  120494   -1.8421863e+03   0.000000e+00   6.642289e+05    105s
Concurrent spin time: 14.21s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -9.700051e+02, 117974 iterations, 117.65 seconds (143.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -970.00514    0  359 -230474.56 -970.00514   100%     -  121s
H    0     0                    -222970.0668 -970.00514   100%     -  121s
H    0     0                    -56270.90551 -970.00514  98.3%     -  121s
H    0     0                    -55946.69208 -970.00514  98.3%     -  121s
H    0     0                    -47979.92927 -970.00514  98.0%     -  121s
H    0     0                    -44108.65468 -970.00514  97.8%     -  121s
H    0     0                    -33672.45198 -970.00514  97.1%     -  121s
H    0     0                    -30304.51829 -970.00514  96.8%     -  122s
H    0     0                    -29281.97501 -970.00514  96.7%     -  122s
H    0     0                    -29135.77794 -970.00514  96.7%     -  122s
H    0     0                    -27036.64388 -4448.1691  83.5%     -  169s
H    0     0                    -26140.88440 -4448.1691  83.0%     -  169s
     0     0 -4782.4600    0  439 -26140.884 -4782.4600  81.7%     -  169s
     0     0 -4782.4600    0  447 -26140.884 -4782.4600  81.7%     -  185s
     0     0 -4782.4600    0  444 -26140.884 -4782.4600  81.7%     -  191s
     0     0 -4782.4600    0  444 -26140.884 -4782.4600  81.7%     -  192s
     0     0 -4795.4554    0  447 -26140.884 -4795.4554  81.7%     -  194s
H    0     0                    -26086.65783 -4812.5156  81.6%     -  197s
     0     0 -6339.3973    0  475 -26086.658 -6339.3973  75.7%     -  197s
     0     0 -6339.3973    0  475 -26086.658 -6339.3973  75.7%     -  198s
     0     0 -6339.3973    0  476 -26086.658 -6339.3973  75.7%     -  199s
     0     0 -6339.3973    0  476 -26086.658 -6339.3973  75.7%     -  199s
     0     0 -6378.0656    0  527 -26086.658 -6378.0656  75.6%     -  237s
H    0     0                    -26078.52905 -6378.1291  75.5%     -  237s
     0     0 -6701.3489    0  558 -26078.529 -6701.3489  74.3%     -  255s
H    0     0                    -26068.73297 -6767.0556  74.0%     -  265s
H    0     0                    -24161.36171 -6767.0556  72.0%     -  265s
H    0     0                    -23294.04719 -6767.0556  70.9%     -  265s
H    0     0                    -23245.04591 -6767.0556  70.9%     -  265s
H    0     0                    -23157.22900 -6767.0556  70.8%     -  265s
H    0     0                    -23152.45559 -6767.0556  70.8%     -  265s
     0     0 -6767.0556    0  542 -23152.456 -6767.0556  70.8%     -  265s
     0     0 -6819.6561    0  552 -23152.456 -6819.6561  70.5%     -  271s
     0     0 -6832.2004    0  551 -23152.456 -6832.2004  70.5%     -  275s
     0     0 -6837.6558    0  562 -23152.456 -6837.6558  70.5%     -  278s
     0     0 -6855.8824    0  555 -23152.456 -6855.8824  70.4%     -  284s
     0     0 -6858.0453    0  550 -23152.456 -6858.0453  70.4%     -  286s
     0     0 -6858.1104    0  548 -23152.456 -6858.1104  70.4%     -  286s
     0     0 -8132.2043    0  526 -23152.456 -8132.2043  64.9%     -  341s
H    0     0                    -23028.17084 -8132.6001  64.7%     -  341s
     0     0 -8535.9194    0  588 -23028.171 -8535.9194  62.9%     -  365s
     0     0 -8632.0831    0  502 -23028.171 -8632.0831  62.5%     -  379s
     0     0 -8690.7046    0  543 -23028.171 -8690.7046  62.3%     -  386s
     0     0 -8707.0410    0  505 -23028.171 -8707.0410  62.2%     -  391s
     0     0 -8716.5303    0  509 -23028.171 -8716.5303  62.1%     -  394s
     0     0 -8762.1087    0  503 -23028.171 -8762.1087  62.0%     -  400s
     0     0 -8788.6882    0  502 -23028.171 -8788.6882  61.8%     -  403s
     0     0 -8793.7058    0  508 -23028.171 -8793.7058  61.8%     -  406s
     0     0 -8821.4432    0  503 -23028.171 -8821.4432  61.7%     -  409s
     0     0 -8829.3509    0  506 -23028.171 -8829.3509  61.7%     -  412s
     0     0 -8830.8298    0  508 -23028.171 -8830.8298  61.7%     -  413s
     0     0 -8831.4614    0  509 -23028.171 -8831.4614  61.6%     -  413s
     0     0 -9340.9525    0  584 -23028.171 -9340.9525  59.4%     -  458s
     0     0 -9571.2377    0  554 -23028.171 -9571.2377  58.4%     -  473s
     0     0 -9654.9880    0  560 -23028.171 -9654.9880  58.1%     -  484s
     0     0 -9683.3962    0  558 -23028.171 -9683.3962  57.9%     -  490s
     0     0 -9694.8016    0  560 -23028.171 -9694.8016  57.9%     -  493s
     0     0 -9705.5165    0  567 -23028.171 -9705.5165  57.9%     -  496s
     0     0 -9708.0799    0  573 -23028.171 -9708.0799  57.8%     -  497s
     0     0 -9712.8625    0  575 -23028.171 -9712.8625  57.8%     -  499s
     0     0 -9713.3283    0  530 -23028.171 -9713.3283  57.8%     -  500s
     0     0 -9860.9498    0  572 -23028.171 -9860.9498  57.2%     -  511s
H    0     0                    -22737.97080 -9901.9878  56.5%     -  517s
H    0     0                    -22673.04031 -9901.9878  56.3%     -  517s
     0     0 -9901.9878    0  562 -22673.040 -9901.9878  56.3%     -  517s
H    0     0                    -22660.96696 -9915.0911  56.2%     -  520s
     0     0 -9915.0911    0  566 -22660.967 -9915.0911  56.2%     -  520s
     0     0 -9917.3236    0  575 -22660.967 -9917.3236  56.2%     -  521s
     0     0 -9919.0427    0  584 -22660.967 -9919.0427  56.2%     -  522s
     0     0 -9919.4316    0  533 -22660.967 -9919.4316  56.2%     -  523s
     0     0 -9958.0569    0  581 -22660.967 -9958.0569  56.1%     -  529s
H    0     0                    -22386.00074 -9958.0577  55.5%     -  533s
H    0     0                    -22341.58713 -9958.0577  55.4%     -  534s
     0     0 -9967.8904    0  541 -22341.587 -9967.8904  55.4%     -  537s
     0     0 -9970.3860    0  597 -22341.587 -9970.3860  55.4%     -  538s
     0     0 -9970.8637    0  601 -22341.587 -9970.8637  55.4%     -  539s
     0     0 -9996.9916    0  592 -22341.587 -9996.9916  55.3%     -  545s
     0     0 -10004.658    0  600 -22341.587 -10004.658  55.2%     -  548s
     0     0 -10009.565    0  590 -22341.587 -10009.565  55.2%     -  550s
     0     0 -10010.182    0  598 -22341.587 -10010.182  55.2%     -  551s
     0     0 -10028.713    0  548 -22341.587 -10028.713  55.1%     -  556s
H    0     0                    -22332.38465 -10029.003  55.1%     -  557s
H    0     0                    -22331.43208 -10029.003  55.1%     -  558s
     0     0 -10033.163    0  597 -22331.432 -10033.163  55.1%     -  560s
     0     0 -10034.178    0  603 -22331.432 -10034.178  55.1%     -  562s
     0     0 -10039.817    0  567 -22331.432 -10039.817  55.0%     -  566s
     0     0 -10041.772    0  564 -22331.432 -10041.772  55.0%     -  568s
     0     0 -10042.708    0  570 -22331.432 -10042.708  55.0%     -  569s
     0     0 -10046.192    0  575 -22331.432 -10046.192  55.0%     -  572s
H    0     0                    -21946.73587 -10046.418  54.2%     -  575s
H    0     0                    -21862.72515 -10046.418  54.0%     -  576s
H    0     0                    -21730.83255 -10046.418  53.8%     -  577s
     0     0 -10048.321    0  589 -21730.833 -10048.321  53.8%     -  579s
     0     0 -10048.523    0  587 -21730.833 -10048.523  53.8%     -  580s
     0     0 -10050.773    0  581 -21730.833 -10050.773  53.7%     -  582s
     0     0 -10051.104    0  581 -21730.833 -10051.104  53.7%     -  587s
H    0     0                    -21621.80960 -10051.104  53.5%     -  628s
H    0     0                    -21392.18856 -10051.104  53.0%     -  669s
H    0     0                    -21390.77793 -10051.104  53.0%     -  670s
H    0     0                    -21183.88983 -10051.104  52.6%     -  670s
     0     2 -10051.104    0  581 -21183.890 -10051.104  52.6%     -  672s
     1     4 -10072.195    1  599 -21183.890 -10051.104  52.6%  3316  678s
     3     8 -10105.295    2  602 -21183.890 -10072.253  52.5%  3331  690s
     7    16 -10197.455    3  581 -21183.890 -10106.104  52.3%  5231  705s
    15    32 -10237.174    4  563 -21183.890 -10197.464  51.9%  6533  731s
    31    48 -10799.615    5  446 -21183.890 -10237.176  51.7%  9543  763s
H   47    79                    -21129.79168 -10237.176  51.6%  8241  791s
H   50    79                    -21070.12995 -10237.176  51.4%  8233  791s
H   51    79                    -21066.65199 -10237.176  51.4%  8155  791s
    78   189 -11972.381    7  272 -21066.652 -10237.176  51.4%  6468  821s
   190   226 -12256.579    9  333 -21066.652 -10237.176  51.4%  3837  835s
H  193   226                    -21028.77868 -10237.176  51.3%  3779  835s
H  203   226                    -20924.60986 -10237.176  51.1%  3712  835s
   227   321 -12401.310    9  264 -20924.610 -10237.176  51.1%  3549  849s
   322   359 -12629.495   12  374 -20924.610 -10237.176  51.1%  3148  860s
H  326   359                    -20923.88797 -10237.176  51.1%  3139  860s
   368   419 -12385.101   12  314 -20923.888 -10237.176  51.1%  3020  874s
H  373   419                    -20866.07247 -10237.176  50.9%  3000  874s
H  399   419                    -20810.37061 -10237.176  50.8%  2918  874s
   456   440 -12577.199   14  251 -20810.371 -10237.176  50.8%  2748  888s
H  467   440                    -20797.37492 -10237.176  50.8%  2727  888s
H  470   440                    -20788.04433 -10237.176  50.8%  2716  888s
H  478   440                    -20734.81860 -10237.176  50.6%  2679  888s
   495   477 -12713.612   14  246 -20734.819 -10237.176  50.6%  2647  903s
   552   500 -13026.864   14  376 -20734.819 -10237.176  50.6%  2596  915s
H  553   500                    -20683.65667 -10237.176  50.5%  2591  915s
   581   536 -13071.096   16  288 -20683.657 -10237.176  50.5%  2592  930s
   648   575 -13431.887   19  271 -20683.657 -10237.176  50.5%  2558  946s
   703   598 -16409.660   17  371 -20683.657 -10237.176  50.5%  2564  962s
   736   644 -13474.885   20  326 -20683.657 -10237.176  50.5%  2599  975s
   792   665 -13564.409   25  198 -20683.657 -10237.176  50.5%  2554  987s
   831   686 infeasible   24      -20683.657 -10237.176  50.5%  2577  999s
   887   714 -14420.994   26  257 -20683.657 -10237.176  50.5%  2531 1016s
   943   728 infeasible   25      -20683.657 -10237.176  50.5%  2477 1030s
   993   774 -14232.001   27  181 -20683.657 -10237.176  50.5%  2463 1044s
  1069   845 -14302.407   28  182 -20683.657 -10237.176  50.5%  2414 1058s
  1158   931 -14622.417   29  248 -20683.657 -10237.176  50.5%  2352 1073s
  1276  1030 -14328.233   28  161 -20683.657 -10237.176  50.5%  2253 1087s
  1415  1107 -14320.580   28  156 -20683.657 -10237.176  50.5%  2135 1103s
  1541  1155 -19895.608   28  127 -20683.657 -10237.176  50.5%  2068 1123s
  1695  1166 -14765.450   31  167 -20683.657 -10237.176  50.5%  1992 1141s
  1774  1209 -15518.432   32  204 -20683.657 -10237.176  50.5%  1994 1160s
  1865  1265 -15875.040   34  212 -20683.657 -10237.176  50.5%  2014 1177s
  1959  1353 -16178.576   39  136 -20683.657 -10237.176  50.5%  1992 1197s
  2091  1452 -16746.688   45  134 -20683.657 -10237.176  50.5%  1953 1217s
  2246  1560 -17411.642   52  134 -20683.657 -10237.176  50.5%  1920 1241s
  2430  1590 infeasible   60      -20683.657 -10237.176  50.5%  1875 1267s
  2549  1633 -19927.297   69  150 -20683.657 -10237.176  50.5%  1876 1293s
  2652  1694 -18861.375   36   80 -20683.657 -10237.176  50.5%  1889 1317s
  2786  1792 -14374.420   18  327 -20683.657 -10237.176  50.5%  1894 1339s
  2939  1856 -19501.877   20   91 -20683.657 -10237.176  50.5%  1890 1367s
  3087  1918 -20480.414   33   50 -20683.657 -10237.176  50.5%  1897 1393s
  3235  1976 infeasible   17      -20683.657 -10326.309  50.1%  1899 1426s
  3353  2026 infeasible   42      -20683.657 -10478.837  49.3%  1924 1455s
  3455  2038 -12863.529    7  487 -20683.657 -10479.041  49.3%  1957 1480s
  3502  2052 -13174.968    8  603 -20683.657 -10479.041  49.3%  1970 1506s
  3558  2073 -13490.509    9  626 -20683.657 -10479.041  49.3%  1991 1535s
  3615  2118 -17653.453   10  476 -20683.657 -10894.478  47.3%  2014 1569s
  3692  2178 -17805.660   11  425 -20683.657 -10894.478  47.3%  2036 1605s
  3800  2250 -18319.414   13  588 -20683.657 -10894.478  47.3%  2059 1642s
  3906  2341 -19440.749   15  578 -20683.657 -10894.478  47.3%  2096 1680s
  4070  2395 -19695.279   17  505 -20683.657 -11185.981  45.9%  2112 1713s
  4226  2454 -19810.768   18  515 -20683.657 -11185.981  45.9%  2112 1758s
  4429  2514 -19834.499   19  510 -20683.657 -11292.005  45.4%  2113 1802s
  4602  2570 infeasible   23      -20683.657 -11292.005  45.4%  2143 1848s
  4823  2651 -19295.034   31  411 -20683.657 -11385.466  45.0%  2153 1889s
  5039  2741 -13428.984    8  324 -20683.657 -11518.118  44.3%  2174 1930s
  5308  2791 -17471.997   12  181 -20683.657 -11522.608  44.3%  2176 1978s
  5462  2834 infeasible   14      -20683.657 -11522.608  44.3%  2214 2024s
  5589  2835 -17165.821   15  581 -20683.657 -11656.098  43.6%  2234 2431s
  5591  2836 -13490.274   13  359 -20683.657 -11656.098  43.6%  2233 2504s
  5592  2837 -20208.471   29  484 -20683.657 -11656.098  43.6%  2233 2599s
  5593  2838 -13111.604   11  562 -20683.657 -11656.098  43.6%  2232 2674s
  5594  2838 -12316.590    8  570 -20683.657 -11656.098  43.6%  2232 2712s
  5595  2839 -20205.946   12  669 -20683.657 -11656.098  43.6%  2231 2741s
  5596  2840 -18502.913   26  541 -20683.657 -11656.098  43.6%  2231 2753s
  5597  2840 -19959.935   26  647 -20683.657 -11656.098  43.6%  2231 2761s
  5598  2841 -17244.152   52  624 -20683.657 -11656.098  43.6%  2230 2771s
  5599  2842 -19546.057   42  682 -20683.657 -11656.098  43.6%  2230 2776s
  5600  2842 -19326.063   25  658 -20683.657 -11656.098  43.6%  2229 2782s
  5601  2843 -12260.717   10  624 -20683.657 -11656.098  43.6%  2229 2785s
  5602  2844 -13659.066   14  573 -20683.657 -11656.098  43.6%  2229 2791s
  5603  2844 -13959.812   12  537 -20683.657 -11656.098  43.6%  2228 2815s
  5605  2846 -13492.961   13  641 -20683.657 -11656.098  43.6%  2227 2823s
  5606  2846 -15911.214   26  543 -20683.657 -11656.098  43.6%  2227 2826s
  5609  2848 -20260.484   30  561 -20683.657 -11656.098  43.6%  2226 2833s
  5610  2849 -17679.479   46  621 -20683.657 -11656.098  43.6%  2225 2845s
  5613  2851 -19713.364   43  571 -20683.657 -11656.098  43.6%  2224 2854s
  5614  2852 -12447.823   23  564 -20683.657 -11656.098  43.6%  2224 2864s
  5615  2852 -16757.268   46  580 -20683.657 -11656.098  43.6%  2223 2866s
  5617  2854 -14804.856   19  586 -20683.657 -11656.098  43.6%  2223 2873s
  5618  2854 -13858.395   18  610 -20683.657 -11656.098  43.6%  2222 2885s
  5620  2856 -13149.392   10  589 -20683.657 -11656.098  43.6%  2221 2893s
  5621  2856 -18224.192   36  592 -20683.657 -11656.098  43.6%  2221 2903s
  5622  2857 -15005.917    7  595 -20683.657 -11656.098  43.6%  2221 2905s
  5623  2858 -19808.031   58  644 -20683.657 -11656.098  43.6%  2220 2911s
  5624  2858 -20195.157   53  608 -20683.657 -11656.098  43.6%  2220 2919s
  5625  2859 -17143.090   20  602 -20683.657 -11656.098  43.6%  2220 2923s
  5626  2860 -17366.283   37  600 -20683.657 -11656.098  43.6%  2219 2930s
  5627  2860 -12850.191   17  595 -20683.657 -11656.098  43.6%  2219 2936s
  5628  2861 -19769.830   22  606 -20683.657 -11656.098  43.6%  2218 2943s
  5629  2862 -14173.921   20  587 -20683.657 -11656.098  43.6%  2218 2948s
  5630  2862 -18064.155   27  584 -20683.657 -11656.098  43.6%  2218 2955s
  5631  2863 -12258.292    9  584 -20683.657 -11656.098  43.6%  2217 3026s
  5632  2864 -18490.728   38  584 -20683.657 -11656.098  43.6%  2217 3080s
  5633  2867 -11656.098   11  571 -20683.657 -11656.098  43.6%  2271 3120s
  5635  2871 -11656.098   12  620 -20683.657 -11656.098  43.6%  2272 3163s
  5639  2877 -11656.098   13  622 -20683.657 -11656.098  43.6%  2275 3209s
  5647  2891 -11656.098   14  692 -20683.657 -11656.098  43.6%  2286 3244s
  5663  2903 -19137.303   15  271 -20683.657 -11656.098  43.6%  2330 3313s
  5682  2921 -12363.022   16  477 -20683.657 -11656.098  43.6%  2356 3342s
  5714  2987 -12915.796   17  367 -20683.657 -11656.098  43.6%  2384 3381s
H 5745  2833                    -20042.47635 -11656.098  41.8%  2387 3381s
  5832  2808 -13304.672   19  435 -20042.476 -11656.098  41.8%  2394 3407s
  5908  2799 -13303.792   20  320 -20042.476 -11656.098  41.8%  2393 3429s
H 5910  2661                    -20041.06572 -11656.098  41.8%  2394 3429s
H 5929  2525                    -20037.92522 -11656.098  41.8%  2400 3429s
  5938  2559 -19282.408   19  263 -20037.925 -11656.098  41.8%  2407 3452s
  5989  2571 -14365.157   21  408 -20037.925 -11656.098  41.8%  2427 3472s
  6041  2591 -14452.859   22  410 -20037.925 -11656.098  41.8%  2439 3494s
  6114  2597 -15248.099   24  174 -20037.925 -11656.098  41.8%  2441 3519s
* 6128  2469              38    -20037.78025 -11656.098  41.8%  2442 3519s
H 6163  2340                    -19990.57910 -11656.098  41.7%  2441 3519s
  6176  2362 -15575.611   26  372 -19990.579 -11656.098  41.7%  2443 3546s
  6250  2355 infeasible   28      -19990.579 -11656.098  41.7%  2440 3566s
H 6253  2243                    -19987.72340 -11656.098  41.7%  2440 3566s
H 6258  2135                    -19978.19214 -11656.098  41.7%  2440 3566s
  6283  2173 -13799.278   20  220 -19978.192 -11656.098  41.7%  2444 3587s
H 6363  2078                    -19977.06448 -11656.098  41.7%  2440 3600s

Cutting planes:
  Learned: 5
  MIR: 805
  Flow cover: 1801
  Zero half: 4
  RLT: 13
  Relax-and-lift: 104

Explored 6431 nodes (16012386 simplex iterations) in 3600.06 seconds (5445.82 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19977.1 -19978.2 -19987.7 ... -20734.8

Time limit reached
Best objective -1.997706447923e+04, best bound -1.165609832273e+04, gap 41.6526%
  WARNING: Time limit reached. Using best solution found (gap: 41.65%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -19977.06, θ = 106601.43
  Upper Bound (UB) = -19977.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 106601.43
  [DEBUG]   ✓ Scenario 0: θ = 106601.43 ≤ Q = 106601.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 106601.43 ≤ Q = 106601.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 106601.43 ≤ Q = 106601.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 106601.43 ≤ Q = 106601.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 106601.43 ≤ Q = 106601.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 106601.43 ≤ Q = 106601.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 106601.43 ≤ Q = 106601.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 106601.43 ≤ Q = 106601.43 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x67b318db
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x67b318db
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-01, 2e+02]
Found heuristic solution: objective 1.245237e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6840386.7239
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.134664e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113466.44    0  122 6840386.72 -113466.44   102%     -    0s
H    0     0                    -78551.12516 -113466.44  44.4%     -    0s
H    0     0                    -79734.28629 -113466.44  42.3%     -    0s
H    0     0                    -80051.96628 -113466.44  41.7%     -    0s
H    0     0                    -80148.93544 -113466.44  41.6%     -    0s
     0     0 -86945.110    0   38 -80148.935 -86945.110  8.48%     -    0s
H    0     0                    -85440.85082 -86943.127  1.76%     -    0s
H    0     0                    -85789.07709 -86943.127  1.35%     -    0s
H    0     0                    -85877.82793 -86943.127  1.24%     -    0s
     0     0 -86819.525    0   40 -85877.828 -86819.525  1.10%     -    0s
     0     0 -86751.998    0   40 -85877.828 -86751.998  1.02%     -    0s
     0     2 -86751.998    0   40 -85877.828 -86751.998  1.02%     -    0s
H  143   121                    -85886.21948 -86200.759  0.37%   3.7    0s
H  148   121                    -85899.11336 -86200.759  0.35%   3.7    0s
H  183   121                    -85910.45894 -86200.759  0.34%   3.8    0s
H  620   160                    -85924.16144 -86083.161  0.19%   4.3    0s
H  921   223                    -85974.17745 -86083.161  0.13%   4.0    0s

Cutting planes:
  Gomory: 8
  Implied bound: 5
  MIR: 139

Explored 1300 nodes (4737 simplex iterations) in 0.28 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -85974.2 -85924.2 -85910.5 ... -79734.3

Optimal solution found (tolerance 1.00e-04)
Best objective -8.597417744808e+04, best bound -8.597751043022e+04, gap 0.0039%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 102548.68
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85974.18
  [DEBUG]   S×d_nominal = 188522.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188522.86 + -85974.18 = 102548.68
  [DEBUG]   Current θ from Master = 106601.43
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4052.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24029.81
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 1012.5638, Absolute Gap = 1012.5638, Relative Gap = 0.050686
  Not converged yet (gap = 1012.56 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0xf23016fb
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 2.83s
Presolved: 81726 rows, 35173 columns, 500096 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -406579.4028
Found heuristic solution: objective -230474.5609

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.397e+06
 Factor NZ  : 7.331e+06 (roughly 100 MB of memory)
 Factor Ops : 1.231e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.94211155e+07  1.59330341e+08  2.70e+05 1.77e+01  1.01e+05     4s
   1  -2.40191670e+07  1.54846391e+08  2.11e+05 9.07e+01  7.85e+04     4s
   2  -9.00908278e+06  1.09529841e+08  7.48e+04 2.53e-01  2.90e+04     4s
   3  -3.36153993e+06  1.15489794e+08  2.35e+04 3.73e+01  9.70e+03     5s
   4  -7.37502039e+05  5.11812215e+07  1.72e+03 2.00e+00  9.62e+02     5s
   5  -5.60862018e+05  4.07147712e+07  5.85e+02 1.42e+00  4.75e+02     5s
   6  -4.69423401e+05  2.87827427e+07  2.35e+02 9.11e-01  2.69e+02     5s
   7  -3.79646934e+05  1.64959258e+07  9.08e+01 4.15e-01  1.37e+02     5s
   8  -2.43050242e+05  7.48663648e+06  2.53e+01 8.04e-12  5.61e+01     5s
   9  -1.66956979e+05  3.08352551e+06  1.28e+01 4.28e-12  2.29e+01     5s
  10  -1.33320864e+05  7.60210192e+05  8.25e+00 4.64e-12  6.26e+00     5s
  11  -7.11712859e+04  2.39907982e+05  3.53e+00 2.70e-12  2.13e+00     5s
  12  -4.11821323e+04  1.13959403e+05  1.85e+00 1.98e-12  1.06e+00     5s
  13  -3.35559722e+04  1.08723218e+05  1.47e+00 1.76e-12  9.65e-01     5s
  14  -2.37762649e+04  6.84580734e+04  1.00e+00 8.30e-04  6.25e-01     5s
  15  -1.78188428e+04  5.94780271e+04  7.28e-01 7.04e-04  5.22e-01     5s
  16  -1.18335045e+04  4.30178354e+04  4.58e-01 1.15e-03  3.69e-01     6s
  17  -7.76541223e+03  2.81391920e+04  2.97e-01 1.25e-03  2.42e-01     6s
  18  -6.28585274e+03  1.88685550e+04  2.48e-01 2.00e-03  1.70e-01     6s
  19  -3.75959584e+03  1.37354390e+04  1.72e-01 1.32e-03  1.18e-01     6s
  20  -1.87027311e+03  1.09932983e+04  1.17e-01 1.55e-03  8.66e-02     6s
  21  -9.39305325e+02  8.15811147e+03  9.08e-02 1.73e-03  6.13e-02     6s
  22  -5.34397069e+01  6.48299014e+03  6.77e-02 1.23e-03  4.40e-02     6s
  23   6.79724210e+02  5.60408754e+03  5.00e-02 1.26e-03  3.32e-02     6s
  24   1.01566656e+03  4.77106975e+03  4.21e-02 1.87e-03  2.53e-02     6s
  25   1.36272981e+03  4.37379291e+03  3.43e-02 1.47e-03  2.03e-02     6s
  26   1.59373167e+03  4.30985260e+03  2.95e-02 1.40e-03  1.83e-02     6s
  27   1.68679599e+03  4.13589364e+03  2.73e-02 1.19e-03  1.65e-02     6s
  28   2.07008585e+03  3.74217964e+03  1.93e-02 7.68e-04  1.13e-02     7s
  29   2.14251028e+03  3.46725644e+03  1.75e-02 4.71e-04  8.96e-03     7s
  30   2.39190588e+03  3.35381237e+03  1.25e-02 3.31e-04  6.50e-03     7s
  31   2.50561452e+03  3.33136209e+03  1.04e-02 3.02e-04  5.58e-03     7s
  32   2.59157739e+03  3.24669635e+03  8.71e-03 2.01e-04  4.43e-03     7s
  33   2.70325643e+03  3.21072014e+03  6.64e-03 1.59e-04  3.43e-03     7s
  34   2.76809876e+03  3.16466127e+03  5.39e-03 1.64e-04  2.68e-03     7s
  35   2.90042114e+03  3.14638723e+03  2.95e-03 1.31e-04  1.66e-03     7s
  36   2.90534536e+03  3.11998690e+03  2.86e-03 9.06e-05  1.45e-03     7s
  37   2.94718001e+03  3.11180385e+03  2.07e-03 7.72e-05  1.11e-03     8s
  38   3.01100253e+03  3.08567831e+03  9.11e-04 3.47e-05  5.04e-04     8s
  39   3.01349715e+03  3.07267599e+03  8.53e-04 1.53e-05  4.01e-04     8s
  40   3.05219052e+03  3.06691361e+03  1.53e-04 5.70e-06  9.92e-05     8s
  41   3.06053893e+03  3.06351938e+03  2.68e-05 1.62e-05  2.01e-05     8s
  42   3.06245060e+03  3.06253296e+03  5.73e-07 9.49e-07  5.54e-07     8s
  43   3.06250081e+03  3.06251631e+03  4.25e-07 1.98e-09  1.05e-07     8s
  44   3.06250893e+03  3.06251628e+03  3.86e-06 6.79e-10  4.84e-08     8s
  45   3.06251508e+03  3.06251627e+03  6.23e-07 1.03e-10  7.85e-09     8s
  46   3.06251626e+03  3.06251627e+03  6.56e-08 1.83e-11  7.70e-11     8s

Barrier solved model in 46 iterations and 8.45 seconds (6.79 work units)
Optimal objective 3.06251626e+03


Root crossover log...

   71404 DPushes remaining with DInf 0.0000000e+00                 8s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    1841 PPushes remaining with PInf 9.8684550e-06                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4584199e+01     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36374    3.0625163e+03   0.000000e+00   2.458420e+01     10s
   36388    3.0625163e+03   0.000000e+00   0.000000e+00     10s
   36388    3.0625163e+03   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.062516e+03, 36388 iterations, 6.70 seconds (6.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3062.51627    0  267 -230474.56 3062.51627   101%     -   10s
H    0     0                    -225843.2444 3062.51627   101%     -   10s
H    0     0                    -209517.3754 3062.51627   101%     -   11s
H    0     0                    -129271.5746 3062.51627   102%     -   11s
H    0     0                    -128695.5695 3062.51627   102%     -   11s
H    0     0                    -74535.68129 3062.51627   104%     -   11s
H    0     0                    -74360.18174 3062.51627   104%     -   11s
H    0     0                    -44840.82884 3062.51627   107%     -   11s
H    0     0                    -30117.53163 3062.51627   110%     -   11s
H    0     0                    -28073.64298 3062.51627   111%     -   12s
H    0     0                    -27581.53652 -1052.5919  96.2%     -   54s
H    0     0                    -26512.52818 -1052.5919  96.0%     -   54s
H    0     0                    -25860.02252 -1052.5919  95.9%     -   54s
     0     0 -1181.1483    0  594 -25860.023 -1181.1483  95.4%     -   54s
H    0     0                    -25805.92822 -1181.1483  95.4%     -   55s
H    0     0                    -25767.49385 -1181.1483  95.4%     -   55s
H    0     0                    -25683.02807 -1181.1483  95.4%     -   55s
H    0     0                    -25648.31938 -1181.1483  95.4%     -   55s
H    0     0                    -25614.39777 -1181.1483  95.4%     -   55s
     0     0 -1185.4615    0  597 -25614.398 -1185.4615  95.4%     -   67s
     0     0 -1185.4615    0  591 -25614.398 -1185.4615  95.4%     -   69s
     0     0 -1185.4615    0  593 -25614.398 -1185.4615  95.4%     -   70s
     0     0 -1185.4615    0  595 -25614.398 -1185.4615  95.4%     -   71s
     0     0 -1186.6405    0  588 -25614.398 -1186.6405  95.4%     -   72s
     0     0 -1186.8211    0  588 -25614.398 -1186.8211  95.4%     -   73s
H    0     0                    -25522.08180 -4437.8761  82.6%     -  121s
H    0     0                    -25103.30061 -4437.8761  82.3%     -  121s
H    0     0                    -25090.80966 -4437.8761  82.3%     -  121s
H    0     0                    -25070.09742 -4437.8761  82.3%     -  121s
     0     0 -4437.8761    0  613 -25070.097 -4437.8761  82.3%     -  121s
H    0     0                    -24906.21114 -4438.0118  82.2%     -  122s
H    0     0                    -24878.12544 -4438.0118  82.2%     -  122s
     0     0 -4736.9373    0  523 -24878.125 -4736.9373  81.0%     -  144s
     0     0 -4784.6379    0  539 -24878.125 -4784.6379  80.8%     -  155s
     0     0 -4815.7316    0  534 -24878.125 -4815.7316  80.6%     -  161s
     0     0 -4824.4827    0  598 -24878.125 -4824.4827  80.6%     -  167s
     0     0 -4826.0527    0  542 -24878.125 -4826.0527  80.6%     -  169s
     0     0 -4835.2336    0  588 -24878.125 -4835.2336  80.6%     -  172s
     0     0 -4855.8807    0  547 -24878.125 -4855.8807  80.5%     -  175s
     0     0 -4858.6317    0  550 -24878.125 -4858.6317  80.5%     -  177s
     0     0 -4859.8508    0  552 -24878.125 -4859.8508  80.5%     -  178s
     0     0 -4861.0138    0  556 -24878.125 -4861.0138  80.5%     -  178s
     0     0 -4861.0263    0  556 -24878.125 -4861.0263  80.5%     -  179s
H    0     0                    -23498.48895 -4861.0263  79.3%     -  190s
H    0     0                    -23154.57554 -4861.0263  79.0%     -  190s
H    0     0                    -23151.99610 -6504.2348  71.9%     -  257s
H    0     0                    -23145.24495 -6504.2348  71.9%     -  257s
     0     0 -6504.2348    0  603 -23145.245 -6504.2348  71.9%     -  257s
H    0     0                    -22495.12466 -6504.5294  71.1%     -  258s
H    0     0                    -22493.53334 -6504.5294  71.1%     -  258s
     0     0 -7103.5291    0  617 -22493.533 -7103.5291  68.4%     -  288s
     0     0 -7193.5305    0  607 -22493.533 -7193.5305  68.0%     -  305s
     0     0 -7208.8868    0  605 -22493.533 -7208.8868  68.0%     -  315s
     0     0 -7272.4670    0  603 -22493.533 -7272.4670  67.7%     -  327s
     0     0 -7276.0796    0  608 -22493.533 -7276.0796  67.7%     -  330s
     0     0 -7295.4373    0  659 -22493.533 -7295.4373  67.6%     -  337s
     0     0 -7327.0293    0  616 -22493.533 -7327.0293  67.4%     -  344s
     0     0 -7336.1656    0  616 -22493.533 -7336.1656  67.4%     -  349s
     0     0 -7338.2326    0  680 -22493.533 -7338.2326  67.4%     -  351s
     0     0 -7338.4316    0  683 -22493.533 -7338.4316  67.4%     -  352s
     0     0 -8269.0365    0  618 -22493.533 -8269.0365  63.2%     -  415s
     0     0 -8549.8899    0  599 -22493.533 -8549.8899  62.0%     -  437s
     0     0 -8651.5333    0  635 -22493.533 -8651.5333  61.5%     -  449s
     0     0 -8698.2809    0  651 -22493.533 -8698.2809  61.3%     -  454s
     0     0 -8704.8760    0  660 -22493.533 -8704.8760  61.3%     -  456s
     0     0 -8712.4224    0  655 -22493.533 -8712.4224  61.3%     -  458s
     0     0 -8713.0779    0  660 -22493.533 -8713.0779  61.3%     -  458s
     0     0 -9053.2852    0  631 -22493.533 -9053.2852  59.8%     -  480s
     0     0 -9105.0368    0  646 -22493.533 -9105.0368  59.5%     -  488s
     0     0 -9136.2286    0  649 -22493.533 -9136.2286  59.4%     -  494s
     0     0 -9146.7223    0  646 -22493.533 -9146.7223  59.3%     -  498s
     0     0 -9152.3801    0  595 -22493.533 -9152.3801  59.3%     -  500s
     0     0 -9155.0988    0  696 -22493.533 -9155.0988  59.3%     -  502s
     0     0 -9155.6066    0  700 -22493.533 -9155.6066  59.3%     -  502s
     0     0 -9370.8968    0  662 -22493.533 -9370.8968  58.3%     -  520s
     0     0 -9418.0416    0  612 -22493.533 -9418.0416  58.1%     -  526s
     0     0 -9437.6309    0  571 -22493.533 -9437.6309  58.0%     -  529s
     0     0 -9443.0311    0  633 -22493.533 -9443.0311  58.0%     -  532s
     0     0 -9446.6490    0  593 -22493.533 -9446.6490  58.0%     -  535s
     0     0 -9447.1993    0  641 -22493.533 -9447.1993  58.0%     -  536s
     0     0 -9557.3505    0  660 -22493.533 -9557.3505  57.5%     -  549s
H    0     0                    -22394.61598 -9557.5727  57.3%     -  549s
     0     0 -9584.6969    0  683 -22394.616 -9584.6969  57.2%     -  555s
     0     0 -9614.8030    0  642 -22394.616 -9614.8030  57.1%     -  558s
     0     0 -9618.2773    0  697 -22394.616 -9618.2773  57.1%     -  560s
     0     0 -9620.2424    0  648 -22394.616 -9620.2424  57.0%     -  561s
     0     0 -9687.0103    0  691 -22394.616 -9687.0103  56.7%     -  574s
H    0     0                    -22376.45383 -9687.1507  56.7%     -  575s
H    0     0                    -22371.29400 -9687.1507  56.7%     -  575s
H    0     0                    -22356.77182 -9687.1507  56.7%     -  575s
H    0     0                    -22351.42735 -9687.1507  56.7%     -  575s
     0     0 -9712.6914    0  639 -22351.427 -9712.6914  56.5%     -  581s
     0     0 -9722.4050    0  646 -22351.427 -9722.4050  56.5%     -  585s
     0     0 -9726.8173    0  595 -22351.427 -9726.8173  56.5%     -  587s
     0     0 -9729.1324    0  620 -22351.427 -9729.1324  56.5%     -  588s
     0     0 -9729.5533    0  611 -22351.427 -9729.5533  56.5%     -  590s
     0     0 -9787.6403    0  577 -22351.427 -9787.6403  56.2%     -  600s
     0     0 -9816.1522    0  651 -22351.427 -9816.1522  56.1%     -  607s
     0     0 -9826.4259    0  668 -22351.427 -9826.4259  56.0%     -  611s
     0     0 -9829.3588    0  610 -22351.427 -9829.3588  56.0%     -  613s
     0     0 -9830.3129    0  610 -22351.427 -9830.3129  56.0%     -  614s
     0     0 -9851.3616    0  713 -22351.427 -9851.3616  55.9%     -  621s
     0     0 -9866.7377    0  641 -22351.427 -9866.7377  55.9%     -  627s
     0     0 -9879.6967    0  646 -22351.427 -9879.6967  55.8%     -  632s
     0     0 -9882.4442    0  662 -22351.427 -9882.4442  55.8%     -  634s
     0     0 -9883.0897    0  663 -22351.427 -9883.0897  55.8%     -  635s
     0     0 -9944.4128    0  637 -22351.427 -9944.4128  55.5%     -  645s
     0     0 -9965.8220    0  647 -22351.427 -9965.8220  55.4%     -  651s
     0     0 -9969.2637    0  649 -22351.427 -9969.2637  55.4%     -  653s
     0     0 -9970.8241    0  655 -22351.427 -9970.8241  55.4%     -  654s
     0     0 -9990.2653    0  660 -22351.427 -9990.2653  55.3%     -  661s
     0     0 -9996.6171    0  662 -22351.427 -9996.6171  55.3%     -  664s
     0     0 -9999.0212    0  667 -22351.427 -9999.0212  55.3%     -  666s
     0     0 -10001.466    0  657 -22351.427 -10001.466  55.3%     -  667s
     0     0 -10004.200    0  668 -22351.427 -10004.200  55.2%     -  669s
     0     0 -10004.410    0  666 -22351.427 -10004.410  55.2%     -  669s
     0     0 -10020.586    0  673 -22351.427 -10020.586  55.2%     -  676s
     0     0 -10023.008    0  690 -22351.427 -10023.008  55.2%     -  678s
     0     0 -10025.212    0  679 -22351.427 -10025.212  55.1%     -  680s
     0     0 -10032.281    0  682 -22351.427 -10032.281  55.1%     -  686s
     0     0 -10036.199    0  689 -22351.427 -10036.199  55.1%     -  691s
     0     0 -10037.911    0  681 -22351.427 -10037.911  55.1%     -  693s
     0     0 -10041.692    0  613 -22351.427 -10041.692  55.1%     -  698s
     0     0 -10041.706    0  613 -22351.427 -10041.706  55.1%     -  704s
     0     2 -10041.706    0  613 -22351.427 -10041.706  55.1%     -  811s
     1     3 -10411.181    1  556 -22351.427 -10041.798  55.1%  5133  822s
     2     5 -10523.634    2  562 -22351.427 -10041.798  55.1%  4549  833s
     4     9 -10536.049    3  573 -22351.427 -10160.068  54.5%  4734  874s
     8    17 -10571.072    4  563 -22351.427 -10160.216  54.5%  6126  898s
    16    31 -10601.601    5  560 -22351.427 -10182.469  54.4%  6126  929s
    30    46 -13402.280    6  472 -22351.427 -10195.490  54.4% 10105 1088s
    45    78 -11475.852    6  481 -22351.427 -10212.368  54.3% 10473 1222s
    77   183 -11520.133    7  463 -22351.427 -10230.261  54.2%  9190 1279s
   182   246 -11611.026    9  437 -22351.427 -10230.261  54.2%  5537 1307s
H  224   246                    -22155.76704 -10230.261  53.8%  4803 1307s
   245   341 -11726.768   11  429 -22155.767 -10230.261  53.8%  4763 1331s
H  340   436                    -22151.71110 -10230.261  53.8%  4289 1350s
H  344   436                    -22116.72073 -10230.261  53.7%  4260 1350s
H  351   436                    -22112.66479 -10230.261  53.7%  4219 1350s
H  403   436                    -22107.39014 -10230.261  53.7%  4029 1350s
H  424   436                    -22069.83961 -10230.261  53.6%  3921 1350s
   437   501 -12151.725   19  462 -22069.840 -10230.261  53.6%  3970 1372s
H  510   524                    -22018.27181 -10230.261  53.5%  3851 1391s
H  511   524                    -21973.81963 -10230.261  53.4%  3848 1391s
   551   569 -12332.344   22  454 -21973.820 -10230.261  53.4%  3906 1408s
   609   589 -16092.208   28  386 -21973.820 -10230.261  53.4%  4014 1427s
H  610   589                    -21793.82573 -10230.261  53.1%  4008 1427s
   641   636 -16120.124   29  298 -21793.826 -10230.261  53.1%  4081 1445s
   716   680 -12372.595   21  549 -21793.826 -10230.261  53.1%  4122 1463s
H  723   680                    -21757.00636 -10230.261  53.0%  4097 1463s
   781   706 -12625.470   22  464 -21757.006 -10230.261  53.0%  4137 1482s
   857   739 -12735.893   23  313 -21757.006 -10230.261  53.0%  4135 1500s
H  873   739                    -21748.42176 -10230.261  53.0%  4151 1500s
H  887   739                    -21741.97301 -10230.261  52.9%  4184 1500s
H  906   739                    -21703.50551 -10230.261  52.9%  4206 1500s
   908   777 -13036.549   24  307 -21703.506 -10230.261  52.9%  4210 1524s
H  986   807                    -20790.23232 -10230.261  50.8%  4178 1543s
H 1015   807                    -20721.79846 -10230.261  50.6%  4171 1543s
  1043   808 -16665.328   27  256 -20721.798 -10230.261  50.6%  4250 1563s
H 1078   808                    -20713.21386 -10230.261  50.6%  4269 1563s
H 1081   808                    -20712.49196 -10230.261  50.6%  4292 1563s
  1086   833 -17082.081   28  268 -20712.492 -10230.261  50.6%  4300 1584s
  1137   852 infeasible   30      -20712.492 -10230.261  50.6%  4400 1607s
H 1197   860                    -20703.31427 -10230.261  50.6%  4491 1629s
  1241   867 -19809.586   31  195 -20703.314 -10230.261  50.6%  4527 1655s
  1278   879 infeasible   32      -20703.314 -10230.261  50.6%  4626 1680s
  1326   900 -11454.024   10  688 -20703.314 -10230.261  50.6%  4828 1707s
  1367   921 -11745.681   11  658 -20703.314 -10230.261  50.6%  4960 1734s
  1418   941 -12117.864   12  542 -20703.314 -10230.261  50.6%  5058 1760s
  1480   998 -13659.782   19  381 -20703.314 -10230.261  50.6%  5101 1788s
  1561  1051 -15182.628   11  272 -20703.314 -10230.261  50.6%  5138 1815s
  1689  1094 -16162.615   12  274 -20703.314 -10230.261  50.6%  5058 1844s
  1792  1169 -16434.789   13  277 -20703.314 -10230.261  50.6%  5063 1874s
  1909  1259 -18572.414   15  238 -20703.314 -10230.261  50.6%  5066 1904s
  2065  1350 infeasible   17      -20703.314 -10230.261  50.6%  4950 1935s
  2264  1368 -19548.550   13  219 -20703.314 -10230.261  50.6%  4782 1968s
  2405  1425 -20234.159   15  168 -20703.314 -10230.261  50.6%  4682 2003s
  2508  1458 infeasible   19      -20703.314 -10230.261  50.6%  4746 2039s
  2585  1504 -11849.304   12  397 -20703.314 -10230.261  50.6%  4772 2080s
  2688  1641 -12624.135   13  362 -20703.314 -10230.261  50.6%  4805 2122s
  2876  1772 infeasible   16      -20703.314 -10230.261  50.6%  4743 2158s
  3107  1901 -15663.402   17  181 -20703.314 -10230.261  50.6%  4652 2195s
  3350  1927 -16273.714   19  245 -20703.314 -10230.261  50.6%  4579 2230s
  3386  1971 -16356.147   20  301 -20703.314 -10230.261  50.6%  4613 2272s
  3488  2007 -16727.795   21  155 -20703.314 -10434.214  49.6%  4609 2316s
  3572  2079 infeasible   22      -20703.314 -10436.650  49.6%  4636 2359s
  3705  2203 -17883.317   27  117 -20703.314 -10436.650  49.6%  4677 2405s
  3891  2322 infeasible   41      -20703.314 -10436.650  49.6%  4693 2453s
  4123  2323 -20475.394   55  613 -20703.314 -10783.110  47.9%  4671 2758s
  4125  2324 -18322.046   25  455 -20703.314 -10783.110  47.9%  4669 2775s
  4126  2325 -12545.652    9  568 -20703.314 -10783.110  47.9%  4668 2874s
  4127  2326 -17964.612   17  627 -20703.314 -10783.110  47.9%  4667 2945s
  4128  2326 -17144.473   16  617 -20703.314 -10783.110  47.9%  4666 3015s
  4129  2327 -13092.922   15  687 -20703.314 -10783.110  47.9%  4665 3039s
  4130  2328 -20139.304   44  685 -20703.314 -10783.110  47.9%  4664 3053s
  4131  2328 -20410.438   24  702 -20703.314 -10783.110  47.9%  4662 3064s
  4132  2329 -19107.191   36  655 -20703.314 -10783.110  47.9%  4661 3072s
  4133  2330 -19904.287   19  709 -20703.314 -10783.110  47.9%  4660 3076s
  4134  2330 -19855.327   25  710 -20703.314 -10783.110  47.9%  4659 3082s
  4135  2331 -19848.964   34  756 -20703.314 -10783.110  47.9%  4658 3091s
  4136  2332 -19560.302   69  702 -20703.314 -10783.110  47.9%  4657 3099s
  4137  2332 -14156.174   25  724 -20703.314 -10783.110  47.9%  4656 3102s
  4138  2333 -20375.632   47  727 -20703.314 -10783.110  47.9%  4655 3105s
  4139  2334 -12227.347   13  738 -20703.314 -10783.110  47.9%  4653 3114s
  4140  2334 -19915.030   42  632 -20703.314 -10783.110  47.9%  4652 3150s
  4141  2335 -19959.582   24  715 -20703.314 -10783.110  47.9%  4651 3165s
  4142  2336 -19199.328   61  719 -20703.314 -10783.110  47.9%  4650 3171s
  4143  2336 -16574.204   18  655 -20703.314 -10783.110  47.9%  4649 3176s
  4144  2337 -20283.130   17  671 -20703.314 -10783.110  47.9%  4648 3180s
  4145  2338 -15725.661   14  663 -20703.314 -10783.110  47.9%  4647 3188s
  4146  2338 -20027.021   26  666 -20703.314 -10783.110  47.9%  4646 3208s
  4147  2339 -16974.341   17  626 -20703.314 -10783.110  47.9%  4644 3214s
  4148  2340 -19120.748   40  621 -20703.314 -10783.110  47.9%  4643 3218s
  4149  2340 -20346.021   44  619 -20703.314 -10783.110  47.9%  4642 3220s
  4150  2341 -14341.152   14  620 -20703.314 -10783.110  47.9%  4641 3227s
  4151  2342 -19300.197   15  617 -20703.314 -10783.110  47.9%  4640 3247s
  4152  2342 -12428.213   10  595 -20703.314 -10783.110  47.9%  4639 3253s
  4153  2343 -19655.771   28  617 -20703.314 -10783.110  47.9%  4638 3256s
  4155  2344 -15193.156   11  532 -20703.314 -10783.110  47.9%  4635 3264s
  4156  2345 -19652.302   37  624 -20703.314 -10783.110  47.9%  4634 3286s
  4157  2346 -15103.017   13  693 -20703.314 -10783.110  47.9%  4633 3291s
  4158  2346 -19632.998   32  633 -20703.314 -10783.110  47.9%  4632 3299s
  4159  2347 -11727.080   12  691 -20703.314 -10783.110  47.9%  4631 3323s
  4160  2348 -19952.362   48  603 -20703.314 -10783.110  47.9%  4630 3327s
  4161  2348 -19615.916   28  696 -20703.314 -10783.110  47.9%  4629 3331s
  4162  2349 -19531.101   44  705 -20703.314 -10783.110  47.9%  4628 3339s
  4163  2350 -15970.042   18  631 -20703.314 -10783.110  47.9%  4627 3356s
  4165  2351 -19247.358   40  553 -20703.314 -10783.110  47.9%  4624 3364s
  4166  2352 -16521.214   24  633 -20703.314 -10783.110  47.9%  4623 3382s
  4167  2352 -17516.368   28  542 -20703.314 -10783.110  47.9%  4622 3388s
  4168  2353 -18206.693   35  708 -20703.314 -10783.110  47.9%  4621 3400s
  4169  2354 -12067.241   11  707 -20703.314 -10783.110  47.9%  4620 3407s
  4170  2354 -13121.935    8  513 -20703.314 -10783.110  47.9%  4619 3426s
  4171  2355 -16778.674   24  531 -20703.314 -10783.110  47.9%  4618 3432s
  4172  2356 -18046.704   13  528 -20703.314 -10783.110  47.9%  4617 3438s
  4173  2356 -18441.268   33  531 -20703.314 -10783.110  47.9%  4615 3441s
  4174  2357 -11863.274    8  534 -20703.314 -10783.110  47.9%  4614 3446s
  4175  2358 -16856.853   32  523 -20703.314 -10799.007  47.8%  4613 3464s
  4176  2358 -17448.040   25  530 -20703.314 -10803.704  47.8%  4612 3467s
  4178  2360 -15815.435   11  544 -20703.314 -10810.431  47.8%  4610 3475s
  4179  2360 -13593.364   13  621 -20703.314 -10819.741  47.7%  4609 3499s
  4180  2361 -18777.913   18  621 -20703.314 -10822.483  47.7%  4608 3501s
  4181  2362 -20022.791   45  628 -20703.314 -10825.053  47.7%  4607 3508s
  4182  2362 -16436.145   16  634 -20703.314 -10838.207  47.6%  4606 3525s
  4183  2363 -19811.467   31  618 -20703.314 -10839.752  47.6%  4604 3530s
  4185  2364 -16905.115   11  634 -20703.314 -10851.195  47.6%  4602 3537s
  4186  2365 -19363.664   20  625 -20703.314 -10852.442  47.6%  4601 3543s
  4187  2366 -19243.601   17  534 -20703.314 -10870.855  47.5%  4600 3557s
  4188  2366 -15919.912   28  547 -20703.314 -10870.855  47.5%  4599 3562s
  4189  2367 -14023.595   17  612 -20703.314 -10877.883  47.5%  4598 3573s
  4190  2368 -14765.015   14  606 -20703.314 -10877.883  47.5%  4597 3575s
  4191  2368 -15094.202   24  532 -20703.314 -10878.316  47.5%  4596 3582s
  4192  2369 -19958.463   49  547 -20703.314 -10890.938  47.4%  4595 3594s

Cutting planes:
  Learned: 1
  Implied bound: 1
  Projected implied bound: 92
  MIR: 845
  Flow cover: 963
  GUB cover: 1
  Zero half: 1
  RLT: 21
  Relax-and-lift: 116

Explored 4192 nodes (20042817 simplex iterations) in 3600.10 seconds (5298.72 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -20703.3 -20712.5 -20713.2 ... -21793.8

Time limit reached
Best objective -2.070331427220e+04, best bound -1.089093810117e+04, gap 47.3952%
  WARNING: Time limit reached. Using best solution found (gap: 47.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.25s
  Master Objective (UB) = -20703.31, θ = 105248.61
  Upper Bound (UB) = -20703.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 105248.61
  [DEBUG]   ✓ Scenario 0: θ = 105248.61 ≤ Q = 105248.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 105248.61 ≤ Q = 105248.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 105248.61 ≤ Q = 105248.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 105248.61 ≤ Q = 105248.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 105248.61 ≤ Q = 105248.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 105248.61 ≤ Q = 105248.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 105248.61 ≤ Q = 105248.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 105248.61 ≤ Q = 105248.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 105248.61 ≤ Q = 105248.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d208cd1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2df732f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.244792e+13
Presolve removed 2578 rows and 1868 columns
Presolve time: 0.01s
Presolved: 515 rows, 521 columns, 1455 nonzeros
Found heuristic solution: objective 6737812.3598
Variable types: 350 continuous, 171 integer (171 binary)
Found heuristic solution: objective 6736922.9260

Root relaxation: objective -1.207952e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120795.19    0  126 6736922.93 -120795.19   102%     -    0s
H    0     0                    -86326.05835 -120795.19  39.9%     -    0s
H    0     0                    -88383.94232 -120795.19  36.7%     -    0s
H    0     0                    -88431.12775 -120795.19  36.6%     -    0s
H    0     0                    -98493.45531 -120795.19  22.6%     -    0s
     0     0 -101915.14    0   30 -98493.455 -101915.14  3.47%     -    0s
H    0     0                    -101255.8970 -101904.20  0.64%     -    0s
     0     0 -101727.41    0   27 -101255.90 -101727.41  0.47%     -    0s
     0     0 -101724.31    0    2 -101255.90 -101724.31  0.46%     -    0s
H    0     0                    -101321.0359 -101723.01  0.40%     -    0s
H    0     0                    -101521.4537 -101723.01  0.20%     -    0s
H    0     0                    -101722.0195 -101723.01  0.00%     -    0s

Cutting planes:
  Gomory: 18
  Implied bound: 2
  MIR: 99
  Flow cover: 1
  RLT: 49

Explored 1 nodes (449 simplex iterations) in 0.04 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -101722 -101521 -101321 ... 6.73781e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.017220195421e+05, best bound -1.017230092404e+05, gap 0.0010%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 87130.33
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101722.02
  [DEBUG]   S×d_nominal = 188852.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188852.35 + -101722.02 = 87130.33
  [DEBUG]   Current θ from Master = 105248.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18118.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -38821.59
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 286.3140, Absolute Gap = 286.3140, Relative Gap = 0.013829
  Not converged yet (gap = 286.31 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0x3ac8b7f9
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.78s
Presolved: 90653 rows, 38830 columns, 550679 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -405888.2403
Found heuristic solution: objective -230474.5609

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.925e+06
 Factor NZ  : 8.518e+06 (roughly 120 MB of memory)
 Factor Ops : 1.466e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.91179430e+07  1.78033460e+08  2.67e+05 1.69e+01  9.99e+04     4s
   1  -2.39586491e+07  1.70041045e+08  2.10e+05 8.62e+01  7.77e+04     4s
   2  -9.10996559e+06  1.20640488e+08  7.52e+04 2.15e+00  2.89e+04     4s
   3  -1.46884407e+06  8.32705307e+07  9.68e+03 1.87e+00  4.07e+03     5s
   4  -4.94366879e+05  5.34491933e+07  8.34e+02 6.22e-01  6.11e+02     5s
   5  -4.46831160e+05  2.99809698e+07  5.73e+02 3.03e-01  3.58e+02     5s
   6  -3.23171616e+05  1.84357748e+07  1.88e+02 1.70e-01  1.65e+02     5s
   7  -2.32834523e+05  1.17259625e+07  1.04e+02 9.74e-02  9.66e+01     5s
   8  -1.56344153e+05  5.06401962e+06  5.77e+01 3.30e-02  4.08e+01     5s
   9  -1.16097260e+05  3.95093702e+06  3.69e+01 2.43e-02  2.96e+01     5s
  10  -9.10788666e+04  2.25773639e+06  1.94e+01 1.27e-02  1.59e+01     5s
  11  -4.85211282e+04  5.82552334e+05  5.58e+00 2.54e-03  4.00e+00     5s
  12  -3.75666173e+04  3.09724362e+05  4.26e+00 1.43e-03  2.18e+00     5s
  13  -2.96171626e+04  1.93137287e+05  3.00e+00 7.48e-04  1.38e+00     5s
  14  -2.01151303e+04  9.94557002e+04  1.74e+00 7.77e-04  7.33e-01     5s
  15  -1.62317380e+04  7.11216054e+04  1.38e+00 1.36e-03  5.33e-01     5s
  16  -1.01322708e+04  4.45779379e+04  8.35e-01 1.04e-03  3.32e-01     5s
  17  -7.90016048e+03  3.57070928e+04  6.96e-01 1.15e-03  2.65e-01     5s
  18  -4.60519433e+03  2.86454736e+04  4.97e-01 1.08e-03  2.01e-01     5s
  19  -2.15878076e+03  2.33066444e+04  3.67e-01 2.13e-03  1.54e-01     6s
  20  -1.86601947e+02  1.92753864e+04  2.75e-01 2.52e-03  1.18e-01     6s
  21   1.32219881e+03  1.72326675e+04  2.14e-01 1.60e-03  9.61e-02     6s
  22   2.23118469e+03  1.58151345e+04  1.75e-01 1.31e-03  8.20e-02     6s
  23   2.82642810e+03  1.33287324e+04  1.55e-01 1.45e-03  6.34e-02     6s
  24   3.81819406e+03  1.21317759e+04  1.21e-01 1.88e-03  5.02e-02     6s
  25   4.18305619e+03  1.17892832e+04  1.06e-01 1.80e-03  4.59e-02     6s
  26   4.68460554e+03  1.10708563e+04  8.85e-02 1.21e-03  3.85e-02     6s
  27   5.00882540e+03  9.98791148e+03  7.82e-02 1.21e-03  3.01e-02     6s
  28   5.32064446e+03  9.39556820e+03  6.87e-02 1.23e-03  2.46e-02     6s
  29   5.50508388e+03  8.68619249e+03  6.24e-02 9.56e-04  1.92e-02     6s
  30   5.81549140e+03  8.54295880e+03  5.27e-02 8.45e-04  1.65e-02     6s
  31   5.92101204e+03  8.37603465e+03  4.89e-02 7.38e-04  1.48e-02     6s
  32   6.11814114e+03  8.21551533e+03  4.23e-02 6.05e-04  1.27e-02     6s
  33   6.16463821e+03  8.18541031e+03  4.07e-02 6.35e-04  1.22e-02     6s
  34   6.30670542e+03  8.03309725e+03  3.57e-02 5.03e-04  1.04e-02     7s
  35   6.49090582e+03  7.94692255e+03  2.97e-02 4.60e-04  8.79e-03     7s
  36   6.54039530e+03  7.88273757e+03  2.78e-02 3.88e-04  8.11e-03     7s
  37   6.59096838e+03  7.81683050e+03  2.60e-02 4.53e-04  7.40e-03     7s
  38   6.69216950e+03  7.71028873e+03  2.26e-02 1.15e-03  6.15e-03     7s
  39   6.73344970e+03  7.67696407e+03  2.13e-02 1.08e-03  5.70e-03     7s
  40   6.77931742e+03  7.65713837e+03  1.98e-02 1.02e-03  5.30e-03     7s
  41   6.79823217e+03  7.62760962e+03  1.91e-02 8.63e-04  5.01e-03     7s
  42   6.94206897e+03  7.59990072e+03  1.44e-02 8.36e-04  3.97e-03     7s
  43   6.95947320e+03  7.59120823e+03  1.38e-02 7.92e-04  3.82e-03     7s
  44   7.02572666e+03  7.53801780e+03  1.16e-02 5.77e-04  3.09e-03     7s
  45   7.07129687e+03  7.50456645e+03  1.01e-02 5.25e-04  2.62e-03     7s
  46   7.08161823e+03  7.49713202e+03  9.75e-03 4.89e-04  2.51e-03     7s
  47   7.11615949e+03  7.48195644e+03  8.62e-03 4.11e-04  2.21e-03     8s
  48   7.17141248e+03  7.47443885e+03  6.85e-03 3.81e-04  1.83e-03     8s
  49   7.19735160e+03  7.46067811e+03  5.97e-03 3.23e-04  1.59e-03     8s
  50   7.21448746e+03  7.45329890e+03  5.42e-03 2.56e-04  1.44e-03     8s
  51   7.23618236e+03  7.43817015e+03  4.74e-03 1.90e-04  1.22e-03     8s
  52   7.25810392e+03  7.42667695e+03  4.01e-03 1.41e-04  1.02e-03     8s
  53   7.26263696e+03  7.42548256e+03  3.87e-03 1.37e-04  9.84e-04     8s
  54   7.28473620e+03  7.41686963e+03  3.16e-03 1.07e-04  7.98e-04     8s
  55   7.30344954e+03  7.40667962e+03  2.52e-03 7.52e-05  6.24e-04     8s
  56   7.31693849e+03  7.40237866e+03  2.09e-03 6.21e-05  5.16e-04     8s
  57   7.33006595e+03  7.39758534e+03  1.65e-03 4.00e-05  4.08e-04     8s
  58   7.34862526e+03  7.39531586e+03  1.06e-03 3.32e-05  2.82e-04     8s
  59   7.36401837e+03  7.38965319e+03  5.64e-04 1.85e-05  1.55e-04     9s
  60   7.37029621e+03  7.38583795e+03  3.68e-04 9.16e-06  9.39e-05     9s
  61   7.37071078e+03  7.38579891e+03  3.56e-04 9.05e-06  9.11e-05     9s
  62   7.37153140e+03  7.38572997e+03  3.31e-04 8.85e-06  8.58e-05     9s
  63   7.37534139e+03  7.38477160e+03  2.15e-04 5.07e-06  5.70e-05     9s
  64   7.37918170e+03  7.38388563e+03  1.01e-04 3.40e-06  2.84e-05     9s
  65   7.38187492e+03  7.38342631e+03  2.11e-05 3.20e-06  9.35e-06     9s
  66   7.38210419e+03  7.38309188e+03  1.45e-05 1.79e-06  5.95e-06     9s
  67   7.38233671e+03  7.38297190e+03  8.29e-06 1.29e-06  3.83e-06     9s
  68   7.38243713e+03  7.38285189e+03  5.59e-06 8.00e-07  2.50e-06     9s
  69   7.38255635e+03  7.38266154e+03  2.21e-06 3.24e-08  6.35e-07     9s
  70   7.38260763e+03  7.38264965e+03  8.75e-07 9.92e-09  2.54e-07     9s
  71   7.38264153e+03  7.38264441e+03  6.52e-08 6.65e-08  1.74e-08     9s
  72   7.38264433e+03  7.38264435e+03  1.65e-08 1.16e-09  1.71e-10    10s

Barrier solved model in 72 iterations and 9.57 seconds (9.65 work units)
Optimal objective 7.38264433e+03


Root crossover log...

   60172 DPushes remaining with DInf 5.5975639e-06                10s
   26203 DPushes remaining with DInf 7.4688747e-02                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    8596 PPushes remaining with PInf 1.4871014e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0800542e+02     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34423    7.3826443e+03   0.000000e+00   1.080054e+02     14s
   34449    7.3826443e+03   0.000000e+00   0.000000e+00     14s
   34449    7.3826443e+03   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.33s

Solved with barrier

Root relaxation: objective 7.382644e+03, 34449 iterations, 11.09 seconds (14.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7382.64435    0  749 -230474.56 7382.64435   103%     -   16s
H    0     0                    -229225.6205 7382.64435   103%     -   16s
H    0     0                    -145306.4939 7382.64435   105%     -   16s
H    0     0                    -144772.0146 7382.64435   105%     -   16s
H    0     0                    -144092.9538 7382.64435   105%     -   16s
H    0     0                    -142785.8170 7382.64435   105%     -   16s
H    0     0                    -135759.6606 7382.64435   105%     -   17s
H    0     0                    -94292.90860 7382.64435   108%     -   17s
H    0     0                    -63061.71263 7382.64435   112%     -   17s
H    0     0                    -43502.15303 7382.64435   117%     -   17s
H    0     0                    -43008.17531 7382.64435   117%     -   17s
H    0     0                    -40767.46757 3551.48203   109%     -   52s
H    0     0                    -40185.79162 3551.48203   109%     -   52s
     0     0 3010.23872    0  732 -40185.792 3010.23872   107%     -   53s
H    0     0                    -38874.99276 3010.23872   108%     -   53s
H    0     0                    -38552.22838 3010.23872   108%     -   53s
     0     0 2558.04174    0  793 -38552.228 2558.04174   107%     -   73s
     0     0 2446.24003    0  792 -38552.228 2446.24003   106%     -   82s
     0     0 2407.71417    0  779 -38552.228 2407.71417   106%     -   86s
     0     0 2400.53509    0  778 -38552.228 2400.53509   106%     -   88s
     0     0 2400.53509    0  783 -38552.228 2400.53509   106%     -   89s
     0     0 2400.53509    0  776 -38552.228 2400.53509   106%     -   90s
     0     0 2400.53509    0  785 -38552.228 2400.53509   106%     -   96s
     0     0 2400.53509    0  768 -38552.228 2400.53509   106%     -   98s
     0     0 2400.53509    0  768 -38552.228 2400.53509   106%     -   98s
     0     0 2390.74822    0  760 -38552.228 2390.74822   106%     -  100s
     0     0 2388.32480    0  762 -38552.228 2388.32480   106%     -  101s
     0     0 2385.07926    0  761 -38552.228 2385.07926   106%     -  102s
     0     0 2384.20150    0  765 -38552.228 2384.20150   106%     -  102s
     0     0 2382.77050    0  765 -38552.228 2382.77050   106%     -  103s
     0     0 2381.34553    0  764 -38552.228 2381.34553   106%     -  103s
     0     0 2381.28787    0  761 -38552.228 2381.28787   106%     -  103s
H    0     0                    -30809.17019 -994.48602  96.8%     -  149s
H    0     0                    -30789.03495 -994.48602  96.8%     -  149s
H    0     0                    -30788.13209 -994.48602  96.8%     -  149s
     0     0 -994.48602    0  642 -30788.132 -994.48602  96.8%     -  150s
H    0     0                    -23912.04027 -995.77097  95.8%     -  150s
H    0     0                    -23642.36673 -995.77097  95.8%     -  151s
     0     0 -1935.0669    0  708 -23642.367 -1935.0669  91.8%     -  195s
     0     0 -2089.0740    0  702 -23642.367 -2089.0740  91.2%     -  229s
     0     0 -2122.3132    0  699 -23642.367 -2122.3132  91.0%     -  247s
     0     0 -2327.1803    0  694 -23642.367 -2327.1803  90.2%     -  270s
     0     0 -2375.5463    0  703 -23642.367 -2375.5463  90.0%     -  285s
     0     0 -2386.1508    0  687 -23642.367 -2386.1508  89.9%     -  294s
     0     0 -2406.6740    0  684 -23642.367 -2406.6740  89.8%     -  304s
H    0     0                    -23634.79989 -2436.7759  89.7%     -  315s
H    0     0                    -23622.72881 -2436.7759  89.7%     -  315s
     0     0 -2436.7759    0  698 -23622.729 -2436.7759  89.7%     -  315s
H    0     0                    -23374.96849 -2447.7150  89.5%     -  321s
     0     0 -2447.7150    0  675 -23374.968 -2447.7150  89.5%     -  321s
H    0     0                    -23303.80830 -2449.1604  89.5%     -  325s
     0     0 -2449.1604    0  679 -23303.808 -2449.1604  89.5%     -  325s
     0     0 -2449.6298    0  679 -23303.808 -2449.6298  89.5%     -  326s
     0     0 -4677.0203    0  668 -23303.808 -4677.0203  79.9%     -  475s
H    0     0                    -23109.76591 -4677.0631  79.8%     -  476s
     0     0 -5280.3294    0  722 -23109.766 -5280.3294  77.2%     -  557s
     0     0 -5348.0237    0  713 -23109.766 -5348.0237  76.9%     -  585s
     0     0 -5373.8713    0  711 -23109.766 -5373.8713  76.7%     -  607s
     0     0 -5386.6602    0  708 -23109.766 -5386.6602  76.7%     -  618s
     0     0 -5394.0796    0  705 -23109.766 -5394.0796  76.7%     -  628s
     0     0 -5396.4140    0  715 -23109.766 -5396.4140  76.6%     -  633s
     0     0 -5404.3767    0  698 -23109.766 -5404.3767  76.6%     -  638s
     0     0 -5417.8786    0  703 -23109.766 -5417.8786  76.6%     -  644s
     0     0 -5425.1656    0  700 -23109.766 -5425.1656  76.5%     -  651s
     0     0 -5425.8912    0  707 -23109.766 -5425.8912  76.5%     -  653s
     0     0 -6484.8734    0  556 -23109.766 -6484.8734  71.9%     -  755s
     0     0 -7006.8809    0  609 -23109.766 -7006.8809  69.7%     -  797s
     0     0 -7280.2695    0  528 -23109.766 -7280.2695  68.5%     -  823s
     0     0 -7310.3138    0  586 -23109.766 -7310.3138  68.4%     -  830s
     0     0 -7321.6547    0  550 -23109.766 -7321.6547  68.3%     -  836s
     0     0 -7333.6314    0  554 -23109.766 -7333.6314  68.3%     -  840s
     0     0 -7338.1166    0  557 -23109.766 -7338.1166  68.2%     -  845s
     0     0 -7339.4303    0  558 -23109.766 -7339.4303  68.2%     -  846s
     0     0 -7968.6518    0  602 -23109.766 -7968.6518  65.5%     -  894s
     0     0 -8141.3616    0  596 -23109.766 -8141.3616  64.8%     -  914s
     0     0 -8199.9282    0  555 -23109.766 -8199.9282  64.5%     -  929s
     0     0 -8208.6941    0  566 -23109.766 -8208.6941  64.5%     -  935s
     0     0 -8218.7282    0  550 -23109.766 -8218.7282  64.4%     -  940s
     0     0 -8232.0803    0  540 -23109.766 -8232.0803  64.4%     -  945s
     0     0 -8237.2681    0  543 -23109.766 -8237.2681  64.4%     -  947s
     0     0 -8239.4328    0  593 -23109.766 -8239.4328  64.3%     -  950s
     0     0 -8583.3496    0  612 -23109.766 -8583.3496  62.9%     -  990s
     0     0 -8659.8239    0  602 -23109.766 -8659.8239  62.5%     - 1039s
     0     0 -8677.9242    0  550 -23109.766 -8677.9242  62.4%     - 1049s
     0     0 -8698.4287    0  668 -23109.766 -8698.4287  62.4%     - 1058s
     0     0 -8710.4675    0  607 -23109.766 -8710.4675  62.3%     - 1064s
     0     0 -8712.5597    0  673 -23109.766 -8712.5597  62.3%     - 1067s
     0     0 -8882.3763    0  624 -23109.766 -8882.3763  61.6%     - 1097s
     0     0 -8923.5287    0  637 -23109.766 -8923.5287  61.4%     - 1114s
     0     0 -8932.4999    0  639 -23109.766 -8932.4999  61.3%     - 1121s
     0     0 -8934.7452    0  700 -23109.766 -8934.7452  61.3%     - 1124s
     0     0 -9036.8712    0  550 -23109.766 -9036.8712  60.9%     - 1142s
     0     0 -9052.0509    0  562 -23109.766 -9052.0509  60.8%     - 1150s
     0     0 -9058.2528    0  570 -23109.766 -9058.2528  60.8%     - 1153s
     0     0 -9060.8829    0  573 -23109.766 -9060.8829  60.8%     - 1156s
     0     0 -9160.3292    0  624 -23109.766 -9160.3292  60.4%     - 1173s
     0     0 -9204.1216    0  739 -23109.766 -9204.1216  60.2%     - 1186s
     0     0 -9224.5154    0  635 -23109.766 -9224.5154  60.1%     - 1192s
     0     0 -9241.4400    0  703 -23109.766 -9241.4400  60.0%     - 1196s
     0     0 -9246.0305    0  694 -23109.766 -9246.0305  60.0%     - 1200s
     0     0 -9246.5822    0  642 -23109.766 -9246.5822  60.0%     - 1201s
     0     0 -9298.4803    0  749 -23109.766 -9298.4803  59.8%     - 1217s
     0     0 -9313.1789    0  688 -23109.766 -9313.1789  59.7%     - 1225s
     0     0 -9319.7406    0  716 -23109.766 -9319.7406  59.7%     - 1230s
     0     0 -9322.0694    0  765 -23109.766 -9322.0694  59.7%     - 1233s
     0     0 -9344.6195    0  598 -23109.766 -9344.6195  59.6%     - 1245s
     0     0 -9354.4689    0  703 -23109.766 -9354.4689  59.5%     - 1255s
     0     0 -9358.3490    0  715 -23109.766 -9358.3490  59.5%     - 1258s
     0     0 -9360.4297    0  705 -23109.766 -9360.4297  59.5%     - 1260s
     0     0 -9393.3399    0  683 -23109.766 -9393.3399  59.4%     - 1277s
H    0     0                    -22218.57835 -9393.3960  57.7%     - 1430s
H    0     0                    -22150.25609 -9393.3960  57.6%     - 1437s
H    0     0                    -22108.32050 -9393.3960  57.5%     - 1446s
H    0     0                    -22003.69492 -9393.3960  57.3%     - 1446s
H    0     0                    -21918.67374 -9393.3960  57.1%     - 1446s
H    0     0                    -21237.09857 -9393.3960  55.8%     - 1456s
     0     0 -9401.2392    0  716 -21237.099 -9401.2392  55.7%     - 1467s
     0     0 -9404.7388    0  732 -21237.099 -9404.7388  55.7%     - 1471s
     0     0 -9405.5563    0  731 -21237.099 -9405.5563  55.7%     - 1473s
     0     0 -9439.1882    0  793 -21237.099 -9439.1882  55.6%     - 1489s
     0     0 -9450.1077    0  796 -21237.099 -9450.1077  55.5%     - 1500s
     0     0 -9452.7874    0  794 -21237.099 -9452.7874  55.5%     - 1503s
     0     0 -9471.6307    0  728 -21237.099 -9471.6307  55.4%     - 1514s
     0     0 -9476.5663    0  732 -21237.099 -9476.5663  55.4%     - 1520s
     0     0 -9479.8944    0  727 -21237.099 -9479.8944  55.4%     - 1523s
     0     0 -9482.9047    0  662 -21237.099 -9482.9047  55.3%     - 1527s
     0     0 -9502.3483    0  733 -21237.099 -9502.3483  55.3%     - 1539s
     0     0 -9526.4565    0  725 -21237.099 -9526.4565  55.1%     - 1554s
     0     0 -9536.4117    0  737 -21237.099 -9536.4117  55.1%     - 1559s
     0     0 -9539.3340    0  741 -21237.099 -9539.3340  55.1%     - 1562s
     0     0 -9574.7891    0  670 -21237.099 -9574.7891  54.9%     - 1574s
     0     0 -9588.9079    0  671 -21237.099 -9588.9079  54.8%     - 1580s
     0     0 -9595.4188    0  682 -21237.099 -9595.4188  54.8%     - 1584s
     0     0 -9599.4481    0  690 -21237.099 -9599.4481  54.8%     - 1588s
     0     0 -9602.8700    0  682 -21237.099 -9602.8700  54.8%     - 1591s
     0     0 -9604.6882    0  688 -21237.099 -9604.6882  54.8%     - 1594s
     0     0 -9615.1502    0  736 -21237.099 -9615.1502  54.7%     - 1604s
     0     0 -9622.1114    0  686 -21237.099 -9622.1114  54.7%     - 1614s
     0     0 -9626.7056    0  721 -21237.099 -9626.7056  54.7%     - 1617s
     0     0 -9628.3474    0  731 -21237.099 -9628.3474  54.7%     - 1619s
     0     0 -9632.9793    0  739 -21237.099 -9632.9793  54.6%     - 1625s
     0     0 -9636.3358    0  743 -21237.099 -9636.3358  54.6%     - 1628s
     0     0 -9637.2636    0  749 -21237.099 -9637.2636  54.6%     - 1630s
     0     0 -9639.4428    0  741 -21237.099 -9639.4428  54.6%     - 1635s
     0     0 -9639.4697    0  741 -21237.099 -9639.4697  54.6%     - 1644s
H    0     0                    -21228.51396 -9639.4717  54.6%     - 1851s
     0     2 -9639.4717    0  741 -21228.514 -9639.4717  54.6%     - 1870s
     1     4 -9724.7586    1  708 -21228.514 -9639.5028  54.6%  3484 1897s
     3     7 -10392.431    2  549 -21228.514 -9724.9354  54.2%  9252 1932s
     6    14 -10488.346    3  467 -21228.514 -9725.3332  54.2% 11784 1976s
    13    28 -10607.369    4  450 -21228.514 -9930.5486  53.2% 10950 2019s
    27    43 -17508.633    5  214 -21228.514 -9986.5654  53.0% 17816 2145s
H   42    74                    -21168.00948 -9986.5654  52.8% 17256 3336s
H   51    74                    -20762.14633 -9986.5654  51.9% 16289 3336s
    73   191 -10827.139    6  532 -20762.146 -10072.853  51.5% 18152 3427s
   190   253 -10933.568    9  499 -20762.146 -10145.451  51.1% 10857 3465s
   252   305 -11194.234   10  529 -20762.146 -10145.451  51.1% 10126 3499s
   318   334 -11316.460   11  504 -20762.146 -10145.451  51.1%  9291 3565s
   365   360 -11329.955   12  511 -20762.146 -10145.451  51.1%  8832 3600s

Cutting planes:
  Learned: 1
  Implied bound: 249
  MIR: 3905
  Flow cover: 3656
  Zero half: 9
  RLT: 223
  Relax-and-lift: 884

Explored 421 nodes (4375767 simplex iterations) in 3600.12 seconds (4454.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -20762.1 -21168 -21228.5 ... -23109.8

Time limit reached
Best objective -2.076214632826e+04, best bound -1.014545109093e+04, gap 51.1349%
  WARNING: Time limit reached. Using best solution found (gap: 51.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = -20762.15, θ = 105805.32
  Upper Bound (UB) = -20762.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 105805.32
  [DEBUG]   ✓ Scenario 0: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 105805.32 ≤ Q = 105805.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 105805.32 ≤ Q = 105805.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 105805.32 ≤ Q = 105805.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x77937151
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x77937151
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.234456e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6800354.5621
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.145593e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -114559.30    0  123 6800354.56 -114559.30   102%     -    0s
H    0     0                    -79555.02679 -114559.30  44.0%     -    0s
H    0     0                    -80418.12613 -114559.30  42.5%     -    0s
     0     0 -90700.329    0   83 -80418.126 -90700.329  12.8%     -    0s
H    0     0                    -88270.16348 -90596.815  2.64%     -    0s
     0     0 -90348.696    0   83 -88270.163 -90348.696  2.35%     -    0s
H    0     0                    -88871.94482 -90262.201  1.56%     -    0s
H    0     0                    -88872.78136 -90262.201  1.56%     -    0s
     0     0 -90119.505    0   78 -88872.781 -90119.505  1.40%     -    0s
     0     0 -90088.119    0   78 -88872.781 -90088.119  1.37%     -    0s
     0     0 -90088.119    0   71 -88872.781 -90088.119  1.37%     -    0s
     0     0 -89953.632    0   55 -88872.781 -89953.632  1.22%     -    0s
     0     0 -89937.292    0   56 -88872.781 -89937.292  1.20%     -    0s
     0     0 -89904.102    0   41 -88872.781 -89904.102  1.16%     -    0s
H    0     0                    -88917.33107 -89900.598  1.11%     -    0s
     0     0 -89900.598    0   41 -88917.331 -89900.598  1.11%     -    0s
     0     0 -89752.369    0   53 -88917.331 -89752.369  0.94%     -    0s
     0     0 -89750.828    0   53 -88917.331 -89750.828  0.94%     -    0s
     0     2 -89750.828    0   53 -88917.331 -89750.828  0.94%     -    0s
H   42    46                    -88925.72139 -89413.542  0.55%  11.7    0s

Cutting planes:
  Gomory: 42
  Implied bound: 5
  MIR: 169
  Flow cover: 5
  RLT: 34
  Relax-and-lift: 1

Explored 1513 nodes (10620 simplex iterations) in 0.47 seconds (0.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -88925.7 -88917.3 -88872.8 ... 1.23446e+13
No other solutions better than -88925.7

Optimal solution found (tolerance 1.00e-04)
Best objective -8.892572138754e+04, best bound -8.892572138754e+04, gap 0.0000%
  Subproblem solved in 0.50s
  Worst-case operational profit (Z_SP) = 99844.62
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88925.72
  [DEBUG]   S×d_nominal = 188770.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188770.34 + -88925.72 = 99844.62
  [DEBUG]   Current θ from Master = 105805.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5960.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26722.85
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 227.4820, Absolute Gap = 227.4820, Relative Gap = 0.010957
  Not converged yet (gap = 227.48 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0x3259e572
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 2.98s
Presolved: 99580 rows, 42487 columns, 601994 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -405847.3423
Found heuristic solution: objective -230474.5609

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.526e+06
 Factor NZ  : 9.979e+06 (roughly 140 MB of memory)
 Factor Ops : 1.828e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.89293650e+07  1.94766062e+08  2.66e+05 1.69e+01  9.89e+04     5s
   1  -2.39960891e+07  1.84236108e+08  2.10e+05 8.19e+01  7.74e+04     5s
   2  -8.75753892e+06  1.30886525e+08  7.27e+04 7.62e-12  2.81e+04     5s
   3  -2.49358692e+06  1.17309039e+08  1.40e+04 2.07e+01  5.91e+03     5s
   4  -8.90157827e+05  6.77985984e+07  1.50e+03 5.83e+00  9.09e+02     5s
   5  -7.69045746e+05  4.61970254e+07  6.19e+02 3.59e+00  4.63e+02     5s
   6  -6.96569285e+05  2.73699301e+07  2.37e+02 1.94e+00  2.26e+02     5s
   7  -5.96220488e+05  1.94051723e+07  4.14e+01 1.32e+00  1.21e+02     5s
   8  -5.18336282e+05  1.17658824e+07  6.62e+00 8.08e-01  6.89e+01     6s
   9  -4.69911010e+05  1.01440865e+07  4.83e+00 6.93e-01  5.93e+01     6s
  10  -2.57760826e+05  5.34318614e+06  2.50e+00 3.40e-01  3.10e+01     6s
  11  -1.70001724e+05  3.33400940e+06  1.52e+00 2.17e-01  1.93e+01     6s
  12  -1.44896871e+05  1.18695818e+06  1.18e+00 6.20e-02  7.34e+00     6s
  13  -1.16612076e+05  1.00756137e+06  9.15e-01 5.82e-02  6.19e+00     6s
  14  -5.65101651e+04  6.38441678e+05  4.73e-01 4.08e-02  3.82e+00     6s
  15  -4.52799438e+04  3.74216584e+05  3.76e-01 2.41e-02  2.30e+00     6s
  16  -3.15632567e+04  1.92320309e+05  2.49e-01 9.88e-03  1.23e+00     6s
  17  -2.52979795e+04  1.37443223e+05  1.98e-01 6.26e-03  8.93e-01     6s
  18  -1.35619524e+04  8.95801461e+04  1.16e-01 3.45e-03  5.66e-01     6s
  19  -7.61518543e+03  5.65557443e+04  7.68e-02 1.96e-03  3.52e-01     6s
  20  -2.73594046e+03  4.77661442e+04  4.66e-02 1.52e-03  2.77e-01     6s
  21  -2.16648913e+03  4.22347529e+04  4.32e-02 1.25e-03  2.44e-01     6s
  22   1.77069796e+02  3.53104661e+04  3.10e-02 9.29e-04  1.93e-01     7s
  23   1.40383015e+03  2.83399522e+04  2.53e-02 6.26e-04  1.48e-01     7s
  24   2.55531007e+03  2.70403983e+04  2.05e-02 5.88e-04  1.34e-01     7s
  25   3.52279173e+03  2.08559794e+04  1.67e-02 1.03e-03  9.51e-02     7s
  26   3.91900291e+03  1.89117250e+04  1.50e-02 1.13e-03  8.23e-02     7s
  27   4.97337647e+03  1.77585235e+04  1.12e-02 1.09e-03  7.02e-02     7s
  28   5.25085580e+03  1.69308666e+04  9.89e-03 9.15e-04  6.41e-02     7s
  29   5.95641643e+03  1.55567460e+04  7.38e-03 1.11e-03  5.27e-02     7s
  30   6.20660162e+03  1.35724402e+04  6.55e-03 7.50e-04  4.04e-02     7s
  31   6.70923455e+03  1.28606785e+04  4.80e-03 7.17e-04  3.38e-02     7s
  32   6.90935570e+03  1.10132185e+04  4.12e-03 4.92e-04  2.25e-02     7s
  33   7.11915824e+03  1.05016053e+04  3.44e-03 3.78e-04  1.86e-02     7s
  34   7.37733902e+03  1.02473678e+04  2.66e-03 3.40e-04  1.57e-02     8s
  35   7.54677563e+03  9.74406591e+03  2.12e-03 2.51e-04  1.21e-02     8s
  36   7.60932300e+03  9.61249311e+03  1.87e-03 2.30e-04  1.10e-02     8s
  37   7.64509948e+03  9.42962348e+03  1.75e-03 2.00e-04  9.79e-03     8s
  38   7.79613333e+03  9.02232136e+03  1.24e-03 1.38e-04  6.73e-03     8s
  39   7.92620121e+03  8.84782200e+03  8.43e-04 1.09e-04  5.06e-03     8s
  40   7.96368728e+03  8.75995706e+03  7.22e-04 1.10e-04  4.37e-03     8s
  41   8.00715481e+03  8.67890911e+03  5.95e-04 9.29e-05  3.69e-03     8s
  42   8.04776155e+03  8.59697585e+03  4.73e-04 7.60e-05  3.01e-03     8s
  43   8.10886007e+03  8.53066690e+03  3.04e-04 6.19e-05  2.31e-03     8s
  44   8.14479750e+03  8.45746204e+03  2.08e-04 4.65e-05  1.72e-03     9s
  45   8.15359075e+03  8.44617047e+03  1.86e-04 4.40e-05  1.61e-03     9s
  46   8.17534282e+03  8.36532876e+03  1.29e-04 3.33e-05  1.04e-03     9s
  47   8.18093396e+03  8.35600326e+03  1.17e-04 2.98e-05  9.61e-04     9s
  48   8.19462701e+03  8.32544237e+03  8.31e-05 2.24e-05  7.18e-04     9s
  49   8.19793988e+03  8.31153192e+03  7.58e-05 1.93e-05  6.23e-04     9s
  50   8.20119852e+03  8.29761024e+03  6.84e-05 1.60e-05  5.29e-04     9s
  51   8.20442157e+03  8.29583243e+03  6.14e-05 1.56e-05  5.02e-04     9s
  52   8.21364275e+03  8.27660813e+03  4.02e-05 1.07e-05  3.46e-04     9s
  53   8.22040790e+03  8.26811011e+03  2.45e-05 8.63e-06  2.62e-04    10s
  54   8.22481215e+03  8.25832053e+03  1.57e-05 6.38e-06  1.84e-04    10s
  55   8.22683132e+03  8.24825115e+03  1.14e-05 3.81e-06  1.18e-04    10s
  56   8.22796898e+03  8.24507645e+03  9.01e-06 3.03e-06  9.39e-05    10s
  57   8.22878864e+03  8.24097558e+03  7.37e-06 1.97e-06  6.69e-05    10s
  58   8.22953150e+03  8.23835930e+03  5.93e-06 1.34e-06  4.84e-05    10s
  59   8.23044487e+03  8.23564148e+03  4.19e-06 6.76e-07  2.85e-05    10s
  60   8.23058646e+03  8.23537808e+03  3.92e-06 6.14e-07  2.63e-05    10s
  61   8.23119736e+03  8.23504646e+03  2.78e-06 5.34e-07  2.11e-05    11s
  62   8.23154847e+03  8.23451933e+03  2.14e-06 4.11e-07  1.63e-05    11s
  63   8.23194843e+03  8.23394699e+03  1.46e-06 2.71e-07  1.10e-05    11s
  64   8.23223802e+03  8.23313249e+03  9.17e-07 7.33e-08  4.90e-06    11s
  65   8.23271881e+03  8.23287872e+03  1.19e-07 2.21e-08  8.77e-07    11s
  66   8.23274245e+03  8.23286766e+03  8.47e-08 1.90e-08  6.87e-07    11s
  67   8.23274380e+03  8.23284582e+03  8.27e-08 1.28e-08  5.59e-07    11s
  68   8.23279494e+03  8.23280577e+03  6.92e-09 1.44e-09  5.94e-08    11s
  69   8.23280104e+03  8.23280108e+03  8.78e-10 2.24e-11  2.26e-10    11s

Barrier solved model in 69 iterations and 11.41 seconds (11.42 work units)
Optimal objective 8.23280104e+03


Root crossover log...

   67758 DPushes remaining with DInf 0.0000000e+00                11s
    7312 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

   10134 PPushes remaining with PInf 1.4443142e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.5004655e+00     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39563    8.2328011e+03   0.000000e+00   8.500466e+00     17s
   39588    8.2328011e+03   0.000000e+00   0.000000e+00     17s
   39588    8.2328011e+03   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.232801e+03, 39588 iterations, 13.58 seconds (17.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8232.80106    0  713 -230474.56 8232.80106   104%     -   19s
H    0     0                    -228850.3238 8232.80106   104%     -   19s
H    0     0                    -166162.0837 8232.80106   105%     -   20s
H    0     0                    -143823.8217 8232.80106   106%     -   20s
H    0     0                    -135561.9088 8232.80106   106%     -   22s
H    0     0                    -113577.0500 8232.80106   107%     -   22s
H    0     0                    -94191.91471 8232.80106   109%     -   22s
H    0     0                    -44636.17857 8232.80106   118%     -   23s
H    0     0                    -41803.87057 4313.18477   110%     -   74s
H    0     0                    -41691.51820 4313.18477   110%     -   74s
H    0     0                    -41317.09738 4313.18477   110%     -   74s
     0     0 4275.32255    0  873 -41317.097 4275.32255   110%     -   74s
H    0     0                    -41316.64686 4275.32255   110%     -   75s
H    0     0                    -41304.82436 4275.32255   110%     -   75s
H    0     0                    -41277.05573 4275.32255   110%     -   75s
     0     0 3896.70156    0  908 -41277.056 3896.70156   109%     -   92s
     0     0 3549.66275    0  814 -41277.056 3549.66275   109%     -  104s
     0     0 3549.66275    0  831 -41277.056 3549.66275   109%     -  108s
     0     0 3467.14627    0  818 -41277.056 3467.14627   108%     -  113s
     0     0 3467.14627    0  809 -41277.056 3467.14627   108%     -  116s
     0     0 3388.59211    0  809 -41277.056 3388.59211   108%     -  120s
     0     0 3366.88033    0  810 -41277.056 3366.88033   108%     -  124s
     0     0 3343.07933    0  918 -41277.056 3343.07933   108%     -  136s
     0     0 3343.07933    0  918 -41277.056 3343.07933   108%     -  138s
     0     0 3343.07933    0  921 -41277.056 3343.07933   108%     -  139s
     0     0 3343.07933    0  901 -41277.056 3343.07933   108%     -  139s
H    0     0                    -33763.50969 -298.65205  99.1%     -  219s
     0     0 -298.65205    0  752 -33763.510 -298.65205  99.1%     -  219s
H    0     0                    -30997.61401 -298.90685  99.0%     -  220s
H    0     0                    -26079.71250 -298.90685  98.9%     -  220s
H    0     0                    -25020.88499 -1799.7213  92.8%     -  300s
H    0     0                    -23904.61341 -1799.7213  92.5%     -  300s
H    0     0                    -23868.70691 -1799.7213  92.5%     -  300s
     0     0 -1799.7213    0  676 -23868.707 -1799.7213  92.5%     -  300s
H    0     0                    -23683.94559 -2248.9915  90.5%     -  376s
     0     0 -2248.9915    0  685 -23683.946 -2248.9915  90.5%     -  377s
     0     0 -2313.6561    0  753 -23683.946 -2313.6561  90.2%     -  411s
     0     0 -2366.9517    0  759 -23683.946 -2366.9517  90.0%     -  444s
     0     0 -2385.0240    0  686 -23683.946 -2385.0240  89.9%     -  464s
H    0     0                    -23521.85682 -2580.2140  89.0%     -  520s
H    0     0                    -23391.74240 -2580.2140  89.0%     -  520s
     0     0 -2580.2140    0  685 -23391.742 -2580.2140  89.0%     -  520s
     0     0 -2592.4724    0  679 -23391.742 -2592.4724  88.9%     -  539s
     0     0 -2601.6300    0  682 -23391.742 -2601.6300  88.9%     -  550s
     0     0 -2603.7595    0  683 -23391.742 -2603.7595  88.9%     -  556s
     0     0 -2604.4472    0  684 -23391.742 -2604.4472  88.9%     -  557s
     0     0 -4869.4988    0  740 -23391.742 -4869.4988  79.2%     -  761s
H    0     0                    -23296.53426 -4869.7219  79.1%     -  762s
H    0     0                    -23284.53729 -5293.4440  77.3%     -  843s
H    0     0                    -23120.00491 -5293.4440  77.1%     -  843s
     0     0 -5293.4440    0  647 -23120.005 -5293.4440  77.1%     -  843s
H    0     0                    -23109.76591 -5424.3309  76.5%     -  878s
     0     0 -5424.3309    0  627 -23109.766 -5424.3309  76.5%     -  878s
     0     0 -5512.1176    0  632 -23109.766 -5512.1176  76.1%     -  910s
     0     0 -5530.8971    0  630 -23109.766 -5530.8971  76.1%     -  935s
     0     0 -5551.9786    0  636 -23109.766 -5551.9786  76.0%     -  950s
     0     0 -5552.8618    0  633 -23109.766 -5552.8618  76.0%     -  954s
     0     0 -6690.3967    0  634 -23109.766 -6690.3967  71.0%     - 1147s
     0     0 -7122.6349    0  591 -23109.766 -7122.6349  69.2%     - 1236s
     0     0 -7217.0937    0  678 -23109.766 -7217.0937  68.8%     - 1269s
     0     0 -7313.9648    0  676 -23109.766 -7313.9648  68.4%     - 1310s
     0     0 -7357.9694    0  736 -23109.766 -7357.9694  68.2%     - 1331s
     0     0 -7372.7902    0  610 -23109.766 -7372.7902  68.1%     - 1345s
     0     0 -7380.4300    0  663 -23109.766 -7380.4300  68.1%     - 1352s
     0     0 -7384.0119    0  660 -23109.766 -7384.0119  68.0%     - 1357s
     0     0 -7403.4243    0  671 -23109.766 -7403.4243  68.0%     - 1367s
     0     0 -7406.9280    0  675 -23109.766 -7406.9280  67.9%     - 1373s
     0     0 -7412.5117    0  674 -23109.766 -7412.5117  67.9%     - 1380s
     0     0 -7425.9964    0  664 -23109.766 -7425.9964  67.9%     - 1392s
     0     0 -7426.7211    0  670 -23109.766 -7426.7211  67.9%     - 1395s
     0     0 -7883.0293    0  584 -23109.766 -7883.0293  65.9%     - 1454s
     0     0 -7989.3410    0  538 -23109.766 -7989.3410  65.4%     - 1491s
     0     0 -8020.4524    0  531 -23109.766 -8020.4524  65.3%     - 1504s
     0     0 -8025.5265    0  538 -23109.766 -8025.5265  65.3%     - 1508s
     0     0 -8027.7942    0  542 -23109.766 -8027.7942  65.3%     - 1511s
     0     0 -8261.9781    0  688 -23109.766 -8261.9781  64.2%     - 1549s
     0     0 -8312.9707    0  694 -23109.766 -8312.9707  64.0%     - 1592s
     0     0 -8332.1445    0  676 -23109.766 -8332.1445  63.9%     - 1603s
     0     0 -8337.7775    0  743 -23109.766 -8337.7775  63.9%     - 1609s
     0     0 -8339.8331    0  721 -23109.766 -8339.8331  63.9%     - 1615s
     0     0 -8482.7643    0  661 -23109.766 -8482.7643  63.3%     - 1643s
     0     0 -8529.9213    0  611 -23109.766 -8529.9213  63.1%     - 1660s
     0     0 -8545.0098    0  604 -23109.766 -8545.0098  63.0%     - 1668s
     0     0 -8561.8643    0  599 -23109.766 -8561.8643  63.0%     - 1673s
     0     0 -8564.6391    0  609 -23109.766 -8564.6391  62.9%     - 1677s
     0     0 -8628.7352    0  673 -23109.766 -8628.7352  62.7%     - 1692s
     0     0 -8659.7956    0  577 -23109.766 -8659.7956  62.5%     - 1708s
     0     0 -8670.6867    0  679 -23109.766 -8670.6867  62.5%     - 1718s
     0     0 -8676.9701    0  637 -23109.766 -8676.9701  62.5%     - 1724s
     0     0 -8678.2712    0  590 -23109.766 -8678.2712  62.4%     - 1726s
     0     0 -8736.6676    0  752 -23109.766 -8736.6676  62.2%     - 1747s
     0     0 -8754.7795    0  687 -23109.766 -8754.7795  62.1%     - 1755s
     0     0 -8760.7046    0  647 -23109.766 -8760.7046  62.1%     - 1758s
     0     0 -8763.8034    0  704 -23109.766 -8763.8034  62.1%     - 1760s
     0     0 -8802.9068    0  641 -23109.766 -8802.9068  61.9%     - 1775s
     0     0 -8813.8304    0  690 -23109.766 -8813.8304  61.9%     - 1783s
     0     0 -8816.6449    0  751 -23109.766 -8816.6449  61.8%     - 1787s
     0     0 -8852.4661    0  596 -23109.766 -8852.4661  61.7%     - 1803s
     0     0 -8882.7838    0  713 -23109.766 -8882.7838  61.6%     - 1816s
     0     0 -8889.6537    0  712 -23109.766 -8889.6537  61.5%     - 1820s
     0     0 -8891.2408    0  659 -23109.766 -8891.2408  61.5%     - 1822s
     0     0 -8906.5178    0  595 -23109.766 -8906.5178  61.5%     - 1832s
     0     0 -8909.8855    0  603 -23109.766 -8909.8855  61.4%     - 1965s
     0     0 -8967.1095    0  607 -23109.766 -8967.1095  61.2%     - 1982s
     0     0 -8987.6209    0  604 -23109.766 -8987.6209  61.1%     - 1998s
     0     0 -8999.7166    0  713 -23109.766 -8999.7166  61.1%     - 2009s
     0     0 -9004.0522    0  606 -23109.766 -9004.0522  61.0%     - 2014s
     0     0 -9005.9796    0  718 -23109.766 -9005.9796  61.0%     - 2017s
     0     0 -9072.6024    0  683 -23109.766 -9072.6024  60.7%     - 2038s
     0     0 -9108.5852    0  702 -23109.766 -9108.5852  60.6%     - 2049s
     0     0 -9125.7614    0  769 -23109.766 -9125.7614  60.5%     - 2059s
     0     0 -9129.5219    0  692 -23109.766 -9129.5219  60.5%     - 2062s
     0     0 -9131.9810    0  705 -23109.766 -9131.9810  60.5%     - 2065s
     0     0 -9144.7508    0  779 -23109.766 -9144.7508  60.4%     - 2075s
     0     0 -9147.4237    0  783 -23109.766 -9147.4237  60.4%     - 2082s
     0     0 -9167.2114    0  776 -23109.766 -9167.2114  60.3%     - 2094s
     0     0 -9176.2201    0  719 -23109.766 -9176.2201  60.3%     - 2103s
     0     0 -9180.7519    0  658 -23109.766 -9180.7519  60.3%     - 2107s
     0     0 -9182.2293    0  596 -23109.766 -9182.2293  60.3%     - 2109s
     0     0 -9192.1306    0  712 -23109.766 -9192.1306  60.2%     - 2118s
     0     0 -9192.2191    0  712 -23109.766 -9192.2191  60.2%     - 2132s
H    0     0                    -21597.50245 -9192.6153  57.4%     - 2361s
H    0     0                    -21588.32476 -9192.6153  57.4%     - 2362s
H    0     0                    -21396.72084 -9192.6153  57.0%     - 2368s
H    0     0                    -21395.31021 -9192.6153  57.0%     - 2369s
     0     2 -9192.6153    0  712 -21395.310 -9192.6153  57.0%     - 2375s
     1     4 -9216.4602    1  701 -21395.310 -9193.4108  57.0%  4087 2397s
     3     6 -9428.1222    2  565 -21395.310 -9216.6020  56.9%  7676 2417s
     5     9 -10047.521    3  477 -21395.310 -9216.6020  56.9%  7810 2438s
     8    15 -10219.419    4  472 -21395.310 -9428.3220  55.9%  8435 2473s
    14    30 -10315.899    4  465 -21395.310 -9495.8509  55.6%  9549 2527s
    29    45 -11104.093    5  278 -21395.310 -9683.0217  54.7% 15231 2615s
    44    77 -9948.6221    6  625 -21395.310 -9683.0217  54.7% 14004 3125s
H   76   162                    -20909.15276 -9735.3070  53.4% 13557 3197s
H   79   162                    -20881.52290 -9735.3070  53.4% 13308 3197s
H   82   162                    -20872.93829 -9735.3070  53.4% 13014 3197s
H  104   162                    -20862.13394 -9735.3070  53.3% 11197 3197s
   161   205 -10447.247   10  605 -20862.134 -9735.3070  53.3%  9842 3239s
H  162   205                    -20849.04199 -9735.3070  53.3%  9781 3239s
H  171   205                    -20817.69505 -9735.3070  53.2%  9599 3239s
   210   277 -10140.658    9  450 -20817.695 -9735.3070  53.2%  8760 3283s
H  277   277                    -20792.41712 -9735.3070  53.2%  7663 3283s
   288   308 -10206.268    9  531 -20792.417 -9735.3070  53.2%  7643 3316s
   329   334 -10478.990   10  492 -20792.417 -9735.3070  53.2%  7309 3391s
   359   376 -10282.847    9  590 -20792.417 -9735.3070  53.2%  7398 3501s
   403   403 -11185.525   11  383 -20792.417 -9735.3070  53.2%  7369 3566s
   443   447 -10425.314   10  584 -20792.417 -9735.3070  53.2%  7297 3600s

Cutting planes:
  Implied bound: 256
  MIR: 4314
  Flow cover: 4082
  Zero half: 10
  RLT: 254
  Relax-and-lift: 1299

Explored 490 nodes (4491039 simplex iterations) in 3600.05 seconds (4723.99 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -20792.4 -20817.7 -20849 ... -21588.3

Time limit reached
Best objective -2.079241711521e+04, best bound -9.735306980442e+03, gap 53.1786%
  WARNING: Time limit reached. Using best solution found (gap: 53.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -20792.42, θ = 105845.02
  Upper Bound (UB) = -20792.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 105845.02
  [DEBUG]   ✓ Scenario 0: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 105845.02 ≤ Q = 105845.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 105845.02 ≤ Q = 105845.02 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1052d28f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xefad2d71
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.233683e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.01s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 6805972.7390
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.145142e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -114514.23    0  122 6805972.74 -114514.23   102%     -    0s
H    0     0                    -79463.63396 -114514.23  44.1%     -    0s
H    0     0                    -80360.42239 -114514.23  42.5%     -    0s
H    0     0                    -81949.49954 -114514.23  39.7%     -    0s
H    0     0                    -90523.36253 -114514.23  26.5%     -    0s
H    0     0                    -90716.98747 -93390.314  2.95%     -    0s
     0     0 -93390.314    0   27 -90716.987 -93390.314  2.95%     -    0s
H    0     0                    -93039.78458 -93360.501  0.34%     -    0s
     0     0 -93233.897    0   13 -93039.785 -93233.897  0.21%     -    0s
     0     0 -93233.897    0   16 -93039.785 -93233.897  0.21%     -    0s
H    0     0                    -93093.56743 -93233.897  0.15%     -    0s
H    0     0                    -93140.44163 -93233.897  0.10%     -    0s
*    0     0               0    -93192.83195 -93192.832  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 15
  Flow cover: 2
  RLT: 2

Explored 1 nodes (581 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -93192.8 -93140.4 -93093.6 ... 6.80597e+06
No other solutions better than -93192.8

Optimal solution found (tolerance 1.00e-04)
Best objective -9.319283195448e+04, best bound -9.319283195448e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 95577.51
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93192.83
  [DEBUG]   S×d_nominal = 188770.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 188770.34 + -93192.83 = 95577.51
  [DEBUG]   Current θ from Master = 105845.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10267.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -31059.92
  Lower Bound (LB) = -20989.63
  Gap (UB-LB) = 197.2112, Absolute Gap = 197.2112, Relative Gap = 0.009485
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 11
Total Time: 26426.27s
Converged: True
Final Lower Bound: -20989.6283
Final Upper Bound: -20792.4171
Final Gap: 197.211207
Number of Critical Scenarios: 11
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [5, 7, 8] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 43 customers  Mode 1: 6 customers  Mode 2: 1 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 11
Start Time: 2026-01-04 12:31:03
End Time: 2026-01-04 19:51:29
Total Time: 26426.27s
Optimal Value: -20989.63
Lower Bound: -20989.63
Upper Bound: -20792.42
Gap: 197.211207
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [5, 7, 8] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed24_LD_gamma20_20260104_195129.csv

Total Execution Time: 26426.64 seconds
End Time: 2026-01-04 19:51:29

All tasks completed successfully!

