
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 39
DI Scenario: LD
Start Time: 2026-01-05 14:43:34
================================================================================
Loading data from data/DH_data_full_seed39.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.116', '1.245'] (k=0.270)
  Product 1: ['1.000', '1.116', '1.246'] (k=0.272)
  Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1013, max=1554
  DC capacity (MC): min=417, max=752

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.43, max=34.69, count=83
  Deviation (μ̂): min=4.06, max=9.82

Costs:
  Plant fixed cost: min=5018, max=9712
  DC fixed cost: min=3018, max=5791
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.393', '1.942'] (k=0.818)
    Product 1: ['1.000', '1.457', '2.123'] (k=0.928)
    Product 2: ['1.000', '1.461', '2.135'] (k=0.935)
  MD:
    Product 0: ['1.000', '1.295', '1.677'] (k=0.637)
    Product 1: ['1.000', '1.167', '1.361'] (k=0.380)
    Product 2: ['1.000', '1.278', '1.634'] (k=0.605)
  LD:
    Product 0: ['1.000', '1.116', '1.245'] (k=0.270)
    Product 1: ['1.000', '1.116', '1.246'] (k=0.272)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
  Mixed:
    Product 0: ['1.000', '1.393', '1.942'] (k=0.818)
    Product 1: ['1.000', '1.167', '1.361'] (k=0.380)
    Product 2: ['1.000', '1.016', '1.032'] (k=0.039)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0xea8b0505
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.07s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -297271.2750
Found heuristic solution: objective -186497.3382

Root relaxation: objective 7.332527e+04, 4848 iterations, 0.18 seconds (0.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73325.2664    0  574 -186497.34 73325.2664   139%     -    0s
H    0     0                    -155157.1539 73325.2664   147%     -    0s
     0     0 69817.5453    0  829 -155157.15 69817.5453   145%     -    0s
H    0     0                    -130768.0487 69812.5094   153%     -    0s
     0     0 69797.5881    0  829 -130768.05 69797.5881   153%     -    0s
     0     0 69795.6722    0  829 -130768.05 69795.6722   153%     -    0s
     0     0 69795.2794    0  830 -130768.05 69795.2794   153%     -    0s
     0     0 66957.7529    0  951 -130768.05 66957.7529   151%     -    1s
     0     0 66798.6714    0  947 -130768.05 66798.6714   151%     -    1s
     0     0 66776.3115    0  962 -130768.05 66776.3115   151%     -    1s
     0     0 66773.6292    0  963 -130768.05 66773.6292   151%     -    1s
     0     0 66773.5043    0  962 -130768.05 66773.5043   151%     -    1s
     0     0 64833.0285    0 1099 -130768.05 64833.0285   150%     -    2s
     0     0 64678.6794    0 1100 -130768.05 64678.6794   149%     -    3s
     0     0 64642.3312    0 1097 -130768.05 64642.3312   149%     -    3s
     0     0 64636.4916    0 1099 -130768.05 64636.4916   149%     -    3s
     0     0 64635.8693    0 1106 -130768.05 64635.8693   149%     -    3s
     0     0 63274.7539    0 1202 -130768.05 63274.7539   148%     -    4s
     0     0 63132.8745    0 1210 -130768.05 63132.8745   148%     -    5s
     0     0 63110.9842    0 1216 -130768.05 63110.9842   148%     -    5s
     0     0 63106.7719    0 1230 -130768.05 63106.7719   148%     -    5s
     0     0 63105.8926    0 1224 -130768.05 63105.8926   148%     -    5s
     0     0 62120.8270    0 1263 -130768.05 62120.8270   148%     -    6s
     0     0 61966.0978    0 1295 -130768.05 61966.0978   147%     -    7s
     0     0 61925.1032    0 1302 -130768.05 61925.1032   147%     -    7s
     0     0 61915.6066    0 1308 -130768.05 61915.6066   147%     -    7s
     0     0 61913.7442    0 1317 -130768.05 61913.7442   147%     -    7s
     0     0 60905.3962    0 1285 -130768.05 60905.3962   147%     -    8s
     0     0 60742.6151    0 1319 -130768.05 60742.6151   146%     -    9s
     0     0 60691.7359    0 1350 -130768.05 60691.7359   146%     -    9s
     0     0 60684.3116    0 1357 -130768.05 60684.3116   146%     -    9s
     0     0 60682.3768    0 1370 -130768.05 60682.3768   146%     -    9s
     0     0 59809.0457    0 1299 -130768.05 59809.0457   146%     -   11s
     0     0 59624.5523    0 1352 -130768.05 59624.5523   146%     -   11s
     0     0 59591.7717    0 1365 -130768.05 59591.7717   146%     -   12s
     0     0 59586.0854    0 1370 -130768.05 59586.0854   146%     -   12s
     0     0 58899.0448    0 1350 -130768.05 58899.0448   145%     -   13s
     0     0 58793.7315    0 1386 -130768.05 58793.7315   145%     -   14s
     0     0 58771.9970    0 1394 -130768.05 58771.9970   145%     -   14s
     0     0 58765.5100    0 1385 -130768.05 58765.5100   145%     -   14s
     0     0 58210.9955    0 1323 -130768.05 58210.9955   145%     -   16s
     0     0 58074.3812    0 1394 -130768.05 58074.3812   144%     -   17s
     0     0 58045.2421    0 1397 -130768.05 58045.2421   144%     -   17s
     0     0 58040.4128    0 1403 -130768.05 58040.4128   144%     -   18s
     0     0 57679.9314    0 1354 -130768.05 57679.9314   144%     -   19s
H    0     0                    -128526.9319 57679.7739   145%     -   19s
H    0     0                    -125557.7509 57679.7739   146%     -   19s
     0     0 57591.5349    0 1395 -125557.75 57591.5349   146%     -   20s
     0     0 57571.1734    0 1395 -125557.75 57571.1734   146%     -   20s
     0     0 57564.2718    0 1413 -125557.75 57564.2718   146%     -   20s
     0     0 57239.6975    0 1387 -125557.75 57239.6975   146%     -   22s
     0     0 57177.9332    0 1403 -125557.75 57177.9332   146%     -   23s
     0     0 57160.6152    0 1420 -125557.75 57160.6152   146%     -   23s
     0     0 57156.6990    0 1429 -125557.75 57156.6990   146%     -   23s
     0     0 56837.4805    0 1323 -125557.75 56837.4805   145%     -   25s
H    0     0                    -124945.2944 56837.2355   145%     -   25s
H    0     0                    -123735.8273 56837.2355   146%     -   25s
H    0     0                    -123718.8643 56837.2355   146%     -   25s
H    0     0                    -122789.6814 56837.2355   146%     -   25s
H    0     0                    -122788.0923 56837.2355   146%     -   25s
H    0     0                    -122746.2674 56837.2355   146%     -   25s
H    0     0                    -122705.1720 56837.2355   146%     -   25s
     0     0 56758.4316    0 1366 -122705.17 56758.4316   146%     -   26s
     0     0 56743.5148    0 1397 -122705.17 56743.5148   146%     -   26s
     0     0 56510.2559    0 1338 -122705.17 56510.2559   146%     -   28s
     0     0 56434.6809    0 1379 -122705.17 56434.6809   146%     -   29s
     0     0 56405.3650    0 1386 -122705.17 56405.3650   146%     -   29s
     0     0 56401.2110    0 1373 -122705.17 56401.2110   146%     -   29s
     0     0 56118.3252    0 1391 -122705.17 56118.3252   146%     -   31s
H    0     0                    -121582.5289 56118.3162   146%     -   31s
H    0     0                    -121500.9465 56118.3162   146%     -   31s
     0     0 56058.0258    0 1425 -121500.95 56058.0258   146%     -   32s
     0     0 56044.1350    0 1447 -121500.95 56044.1350   146%     -   33s
     0     0 55871.5378    0 1361 -121500.95 55871.5378   146%     -   34s
     0     0 55819.0115    0 1400 -121500.95 55819.0115   146%     -   35s
     0     0 55800.7735    0 1397 -121500.95 55800.7735   146%     -   35s
     0     0 55578.2343    0 1392 -121500.95 55578.2343   146%     -   37s
H    0     0                    -118118.9213 55578.2165   147%     -   37s
H    0     0                    -117001.2381 55578.2165   148%     -   37s
     0     0 55537.3597    0 1378 -117001.24 55537.3597   147%     -   38s
     0     0 55524.1069    0 1428 -117001.24 55524.1069   147%     -   38s
     0     0 55386.8253    0 1408 -117001.24 55386.8253   147%     -   40s
     0     0 55386.8088    0 1408 -117001.24 55386.8088   147%     -   40s
     0     2 55386.7005    0 1408 -117001.24 55386.7005   147%     -   42s
     3     8 54303.3974    2 1080 -117001.24 55065.1980   147%  7368   48s
     7    16 53664.2937    3  981 -117001.24 54297.3734   146%  7963   51s
H   31    64                    -112678.0280 52486.9071   147%  6572   55s
H   32    64                    -97444.87242 52486.8901   154%  6605   55s
H   33    64                    -86936.08087 52486.8901   160%  6570   55s
H   38    64                    -81943.48392 52486.8901   164%  6682   55s
H   95   240                    3032.4443199 49067.3815  1518%  5165   59s
H  100   240                    6482.6747521 49067.3815   657%  4933   59s
H  107   240                    11604.686688 49067.3815   323%  4706   59s
H  115   240                    18594.303342 49067.3815   164%  4454   59s
H  135   240                    24405.389649 49067.3815   101%  3950   59s
   239   345 37471.2382   11  379 24405.3896 49067.3815   101%  2561   60s
H  366   372                    24534.720166 49067.3815   100%  1899   61s
H  383   372                    25236.358223 49067.3815  94.4%  1847   61s
H  386   372                    25561.089844 49067.3815  92.0%  1833   61s
H  391   372                    26343.083783 49067.3815  86.3%  1816   61s
H  528   499                    26391.975195 47958.1300  81.7%  1488   64s
H  556   499                    26393.681910 47958.1300  81.7%  1445   64s
   608   562     cutoff   18      26393.6819 47926.8727  81.6%  1356   66s
   877   760 41249.2851    9  354 26393.6819 47894.9764  81.5%  1088   70s
H 1091   839                    26432.753408 46806.6058  77.1%   955   71s
H 1330   990                    26491.554080 46806.6058  76.7%   830   73s
  1357  1136 35885.8813   16  469 26491.5541 46806.6058  76.7%   825   75s
  2197  1699 29137.2444   55   75 26491.5541 45245.5349  70.8%   605   80s
H 2535  1791                    26503.360629 44979.4104  69.7%   575   84s
  2573  1902 40764.0816   28   60 26503.3606 44979.4104  69.7%   570   85s
  3339  2238 41134.1368   16   63 26503.3606 44181.8316  66.7%   530   91s
  3653  2349 34742.0016   20  571 26503.3606 44109.9563  66.4%   550   95s
H 3701  2396                    26641.252182 44109.9563  65.6%   554   96s
  4160  2674 30431.3491   20   58 26641.2522 44109.9563  65.6%   554  100s
  4705  2833 31862.8926   22  237 26641.2522 43860.2486  64.6%   563  106s
H 4842  2853                    26670.811741 43817.3785  64.3%   570  107s
H 4848  2849                    26699.657414 43817.3785  64.1%   570  107s
H 4858  2839                    26754.645072 43650.9661  63.2%   572  107s
H 4885  2838                    26789.939718 43572.9794  62.6%   571  107s
  5079  2924     cutoff   29      26789.9397 43530.3000  62.5%   578  111s
H 5088  2924                    26818.642769 43530.3000  62.3%   578  111s
  5393  3023 37766.2978   10   59 26818.6428 43422.3624  61.9%   589  115s
H 5740  3069                    26819.266081 43092.9021  60.7%   590  117s
  6104  3150 41203.9842   13 1408 26819.2661 42963.0149  60.2%   595  141s
  6127  3165 31954.2588   10  480 26819.2661 35221.9993  31.3%   593  145s
  6415  3210     cutoff   24      26819.2661 32233.5661  20.2%   585  150s
H 6781  2903                    26819.450945 31548.7947  17.6%   567  152s
H 6925  2674                    26831.055220 30998.4423  15.5%   560  152s
H 7070  2450                    26832.644843 30998.4423  15.5%   552  153s
H 7086  2308                    26840.118801 30998.4423  15.5%   552  153s
H 7345  2116                    26841.584886 30516.0870  13.7%   534  153s
H 7363  1987                    26841.708425 30516.0870  13.7%   533  153s
H 7557  1799                    26853.311041 30516.0870  13.6%   520  153s
H 7593  1648                    26882.305739 30516.0870  13.5%   518  154s

Cutting planes:
  Gomory: 6
  Implied bound: 2
  Projected implied bound: 53
  MIR: 223
  Flow cover: 370
  RLT: 13
  Relax-and-lift: 91

Explored 7908 nodes (4052392 simplex iterations) in 154.58 seconds (343.64 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26882.3 26853.3 26841.7 ... 26818.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.688230573946e+04, best bound 2.688230573946e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 154.58s
  Master Objective (UB) = 26882.31, θ = 150336.78
  Upper Bound (UB) = 26882.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150336.78
  [DEBUG]   ✓ Scenario 0: θ = 150336.78 ≤ Q = 150336.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x10684b1e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x10684b1e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.274619e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6796553.4676
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.166219e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116621.94    0  123 6796553.47 -116621.94   102%     -    0s
H    0     0                    -84000.67835 -116621.94  38.8%     -    0s
H    0     0                    -85071.29699 -116621.94  37.1%     -    0s
*    0     0               0    -86914.42854 -86914.429  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 206

Explored 1 nodes (384 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -86914.4 -85071.3 -84000.7 ... 1.27462e+13
No other solutions better than -86914.4

Optimal solution found (tolerance 1.00e-04)
Best objective -8.691442854280e+04, best bound -8.691442854280e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 117769.48
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -86914.43
  [DEBUG]   S×d_nominal = 204683.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204683.91 + -86914.43 = 117769.48
  [DEBUG]   Current θ from Master = 150336.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32567.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5684.99
  Lower Bound (LB) = -5684.99
  Gap (UB-LB) = 32567.2984, Absolute Gap = 32567.2984, Relative Gap = 1.211477
  Not converged yet (gap = 32567.30 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0x6e9553fa
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -5684.99 (0.01s)
Loaded MIP start from previous solve with objective -5684.99

Presolve removed 13565 rows and 5504 columns
Presolve time: 0.32s
Presolved: 18398 rows, 9236 columns, 101918 nonzeros
Variable types: 6977 continuous, 2259 integer (2259 binary)

Root relaxation: objective 3.163491e+04, 10855 iterations, 1.42 seconds (2.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 31634.9063    0  442 -5684.9927 31634.9063   656%     -    1s
H    0     0                    -3748.438195 31634.9063   944%     -    1s
     0     0 22784.5278    0  614 -3748.4382 22784.5278   708%     -    3s
     0     0 22058.5905    0  609 -3748.4382 22058.5905   688%     -    3s
     0     0 22041.0180    0  618 -3748.4382 22041.0180   688%     -    4s
     0     0 22041.0180    0  618 -3748.4382 22041.0180   688%     -    4s
     0     0 22041.0180    0  618 -3748.4382 22041.0180   688%     -    4s
H    0     0                    -3741.064791 16753.2391   548%     -    6s
H    0     0                    -3707.337799 16753.2391   552%     -    6s
H    0     0                    -3682.165957 16753.2391   555%     -    6s
     0     0 16753.2391    0  539 -3682.1660 16753.2391   555%     -    6s
H    0     0                    -3668.713739 16748.1075   557%     -    6s
     0     0 15850.9065    0  636 -3668.7137 15850.9065   532%     -    6s
     0     0 15714.2147    0  704 -3668.7137 15714.2147   528%     -    7s
     0     0 15626.5455    0  703 -3668.7137 15626.5455   526%     -    7s
     0     0 15623.7258    0  718 -3668.7137 15623.7258   526%     -    7s
H    0     0                    -3599.901168 12918.2449   459%     -   10s
     0     0 12918.2449    0  560 -3599.9012 12918.2449   459%     -   10s
H    0     0                    -2357.234959 12322.4089   623%     -   11s
H    0     0                    -2321.244607 12322.4089   631%     -   11s
H    0     0                    -2301.059154 12322.4089   636%     -   11s
H    0     0                    -2132.110018 12322.4089   678%     -   11s
H    0     0                    -2058.162825 12322.4089   699%     -   11s
H    0     0                    -1920.750514 12322.4089   742%     -   11s
H    0     0                    -1917.548126 12322.4089   743%     -   11s
H    0     0                    -1863.852874 12322.4089   761%     -   11s
H    0     0                    -1813.341290 12322.4089   780%     -   11s
H    0     0                    -1799.285304 12322.4089   785%     -   11s
     0     0 12322.4089    0  638 -1799.2853 12322.4089   785%     -   11s
     0     0 12216.9511    0  649 -1799.2853 12216.9511   779%     -   11s
     0     0 12189.7284    0  665 -1799.2853 12189.7284   777%     -   12s
     0     0 12186.2844    0  666 -1799.2853 12186.2844   777%     -   12s
H    0     0                    -1794.089069 12186.2844   779%     -   13s
     0     0 10717.8326    0  481 -1794.0891 10717.8326   697%     -   15s
H    0     0                    -1631.621357 10717.5782   757%     -   15s
     0     0 10372.9275    0  541 -1631.6214 10372.9275   736%     -   16s
     0     0 10011.4060    0  643 -1631.6214 10011.4060   714%     -   18s
     0     0 9967.02992    0  508 -1631.6214 9967.02992   711%     -   18s
     0     0 9914.70987    0  650 -1631.6214 9914.70987   708%     -   18s
     0     0 9888.35230    0  584 -1631.6214 9888.35230   706%     -   19s
     0     0 9879.63753    0  585 -1631.6214 9879.63753   706%     -   19s
     0     0 9877.41167    0  589 -1631.6214 9877.41167   705%     -   19s
     0     0 9293.15857    0  544 -1631.6214 9293.15857   670%     -   21s
H    0     0                    -1001.238139 9293.09201  1028%     -   21s
H    0     0                    -918.5621018 9293.09201  1112%     -   21s
H    0     0                    -864.5657197 9293.09201  1175%     -   21s
H    0     0                    -835.4242548 9293.09201  1212%     -   21s
H    0     0                    -753.0144904 9293.09201  1334%     -   21s
H    0     0                    -742.0632301 9293.09201  1352%     -   21s
H    0     0                    -718.8053721 9293.09201  1393%     -   21s
H    0     0                    -680.6531068 9293.09201  1465%     -   21s
H    0     0                    -665.7424862 9293.09201  1496%     -   21s
     0     0 9159.19296    0  683 -665.74249 9159.19296  1476%     -   21s
     0     0 9100.06172    0  707 -665.74249 9100.06172  1467%     -   22s
     0     0 9057.02049    0  704 -665.74249 9057.02049  1460%     -   22s
     0     0 9047.64981    0  709 -665.74249 9047.64981  1459%     -   22s
     0     0 9045.74859    0  576 -665.74249 9045.74859  1459%     -   22s
     0     0 8746.89500    0  537 -665.74249 8746.89500  1414%     -   24s
H    0     0                    -229.9100167 8746.62095  3904%     -   25s
H    0     0                    -220.7795741 8746.62095  4062%     -   25s
H    0     0                       8.0509778 8746.62095      -     -   25s
H    0     0                     140.7676601 8746.62095  6114%     -   25s
H    0     0                     307.9777056 8746.62095  2740%     -   25s
     0     0 8640.79616    0  544  307.97771 8640.79616  2706%     -   26s
     0     0 8606.97975    0  464  307.97771 8606.97975  2695%     -   26s
     0     0 8597.08815    0  476  307.97771 8597.08815  2691%     -   26s
     0     0 8595.36732    0  479  307.97771 8595.36732  2691%     -   26s
     0     0 8474.94298    0  549  307.97771 8474.94298  2652%     -   27s
     0     0 8449.11673    0  560  307.97771 8449.11673  2643%     -   27s
     0     0 8436.82510    0  545  307.97771 8436.82510  2639%     -   28s
     0     0 8435.16746    0  560  307.97771 8435.16746  2639%     -   28s
     0     0 8360.69037    0  461  307.97771 8360.69037  2615%     -   29s
     0     0 8340.54060    0  461  307.97771 8340.54060  2608%     -   29s
     0     0 8335.88260    0  475  307.97771 8335.88260  2607%     -   29s
     0     0 8294.43126    0  479  307.97771 8294.43126  2593%     -   30s
     0     0 8284.06335    0  487  307.97771 8284.06335  2590%     -   30s
     0     0 8281.71958    0  493  307.97771 8281.71958  2589%     -   30s
     0     0 8267.52086    0  473  307.97771 8267.52086  2584%     -   30s
     0     0 8267.16180    0  473  307.97771 8267.16180  2584%     -   31s
H    0     0                     358.3595757 8267.08884  2207%     -   37s
     0     2 8267.08884    0  473  358.35958 8267.08884  2207%     -   37s
    15    32 7344.58036    4  453  358.35958 8075.32071  2153%   965   41s
    95   157 4050.09860    7  434  358.35958 7714.66203  2053%  1215   45s
H  163   187                     360.5659164 7714.66203  2040%   955   45s
H  167   187                     361.1085845 7714.66203  2036%   944   45s
H  385   316                     637.6773536 7331.63226  1050%   681   49s
   506   407     cutoff   13       637.67735 7236.51305  1035%   605   50s
  1066   739 1407.43831   26  118  637.67735 6873.08052   978%   420   55s
  1892  1183 2070.46015   11  410  637.67735 5933.93226   831%   327   60s
H 2067  1217                     678.6173475 5933.93226   774%   316   61s
H 2077  1217                     708.3504822 5933.93226   738%   317   61s
H 2079  1217                     728.6320692 5933.93226   714%   317   61s
H 2103  1217                     968.1690781 5691.47443   488%   315   61s
  2911  1449 1340.10559   13  297  968.16908 4877.06185   404%   286   65s
H 3087  1467                     975.0894894 4759.07437   388%   284   66s
H 3111  1467                    1211.4521879 4633.61150   282%   285   66s
  3789  1558     cutoff   11      1211.45219 4308.09567   256%   282   70s
* 4101  1574              23    1380.7459893 4235.24561   207%   278   71s
H 4287  1563                    1407.9216556 4235.24561   201%   276   72s
H 4349  1563                    1483.1879977 3996.74769   169%   278   72s
  4883  1579     cutoff   21      1483.18800 3829.37035   158%   274   75s
  7096  1620 1870.26162   20  143 1483.18800 3218.14205   117%   247   81s
  8962  1608 1705.04956   24  148 1483.18800 2634.61129  77.6%   223   85s
 14082    38 1694.25325   28   97 1483.18800 1925.49976  29.8%   177   90s

Cutting planes:
  Gomory: 11
  Implied bound: 7
  MIR: 1932
  Flow cover: 1010
  Inf proof: 2
  Zero half: 4
  RLT: 101
  Relax-and-lift: 388

Explored 15174 nodes (2595588 simplex iterations) in 90.49 seconds (216.90 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 1483.19 1407.92 1380.75 ... 361.109

Optimal solution found (tolerance 1.00e-04)
Best objective 1.483187997741e+03, best bound 1.483187997741e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 90.51s
  Master Objective (UB) = 1483.19, θ = 116211.10
  Upper Bound (UB) = 1483.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116211.10
  [DEBUG]   ✓ Scenario 0: θ = 116211.10 ≤ Q = 116211.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116211.10 ≤ Q = 116211.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x17b1e847
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe84e17b9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.176096e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 5942842.5061
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.297486e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129748.57    0  131 5942842.51 -129748.57   102%     -    0s
H    0     0                    -93255.99832 -129748.57  39.1%     -    0s
H    0     0                    -94264.19250 -129748.57  37.6%     -    0s
H    0     0                    -109669.6486 -129748.57  18.3%     -    0s
H    0     0                    -110014.0234 -129748.57  17.9%     -    0s
H    0     0                    -114740.0661 -129748.57  13.1%     -    0s
     0     0 -117531.63    0   62 -114740.07 -117531.63  2.43%     -    0s
H    0     0                    -116678.7729 -117468.33  0.68%     -    0s
H    0     0                    -116893.7045 -117106.07  0.18%     -    0s
     0     0 -117100.60    0   47 -116893.70 -117100.60  0.18%     -    0s
     0     0 -117026.46    0   22 -116893.70 -117026.46  0.11%     -    0s
     0     0 -116992.65    0   18 -116893.70 -116992.65  0.08%     -    0s
     0     0 -116984.03    0   18 -116893.70 -116984.03  0.08%     -    0s
     0     0 -116983.87    0   15 -116893.70 -116983.87  0.08%     -    0s
     0     0 -116939.12    0    5 -116893.70 -116939.12  0.04%     -    0s
     0     0 -116932.73    0    8 -116893.70 -116932.73  0.03%     -    0s
H    0     0                    -116894.9193 -116932.73  0.03%     -    0s
*    0     0               0    -116913.0731 -116913.07  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 2
  Flow cover: 7

Explored 1 nodes (594 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -116913 -116895 -116894 ... 5.94284e+06
No other solutions better than -116913

Optimal solution found (tolerance 1.00e-04)
Best objective -1.169130730699e+05, best bound -1.169130730699e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 94113.75
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116913.07
  [DEBUG]   S×d_nominal = 211026.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211026.82 + -116913.07 = 94113.75
  [DEBUG]   Current θ from Master = 116211.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22097.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20614.17
  Lower Bound (LB) = -5684.99
  Gap (UB-LB) = 7168.1807, Absolute Gap = 7168.1807, Relative Gap = 4.832955
  Not converged yet (gap = 7168.18 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0x74dec4e2
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -20614.2 (0.02s)
MIP start from previous solve produced solution with objective -20614.2 (0.02s)
Loaded MIP start from previous solve with objective -20614.2

Presolve removed 20341 rows and 8261 columns
Presolve time: 0.44s
Presolved: 26912 rows, 12719 columns, 165644 nonzeros
Variable types: 10460 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32600    1.1948879e+04   0.000000e+00   7.060296e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20499    1.9720517e+04   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 1.972052e+04, 20499 iterations, 5.98 seconds (10.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19720.5171    0  271 -20614.167 19720.5171   196%     -    6s
H    0     0                    -20424.25355 19720.5171   197%     -    6s
H    0     0                    -14557.95527 19720.5171   235%     -    6s
H    0     0                    -13186.50912 19720.5171   250%     -    6s
H    0     0                    -13156.74022 19720.5171   250%     -    6s
H    0     0                    -13130.71461 19720.5171   250%     -    6s
H    0     0                    -6519.130683 19720.5171   403%     -    7s
H    0     0                    -6222.942977 19720.5171   417%     -    7s
H    0     0                    -5680.589709 19720.5171   447%     -    7s
H    0     0                    -4334.665616 19720.5171   555%     -    7s
H    0     0                    -4330.253926 19720.5171   555%     -    7s
H    0     0                    -4214.351871 16427.3799   490%     -    9s
     0     0 16263.1397    0  325 -4214.3519 16263.1397   486%     -    9s
H    0     0                    -3940.501550 16263.1397   513%     -    9s
H    0     0                    -3936.715615 16263.1397   513%     -    9s
H    0     0                    -3894.787536 16263.1397   518%     -    9s
H    0     0                    -3809.447633 15901.8878   517%     -   10s
     0     0 15857.1775    0  404 -3809.4476 15857.1775   516%     -   10s
     0     0 15248.8785    0  417 -3809.4476 15248.8785   500%     -   11s
     0     0 15248.8785    0  409 -3809.4476 15248.8785   500%     -   12s
     0     0 15248.8785    0  410 -3809.4476 15248.8785   500%     -   12s
     0     0 15248.8785    0  408 -3809.4476 15248.8785   500%     -   12s
H    0     0                    -3802.074229 12286.3823   423%     -   15s
     0     0 12286.3823    0  443 -3802.0742 12286.3823   423%     -   15s
H    0     0                    -3761.564628 12286.1168   427%     -   16s
     0     0 11710.5490    0  462 -3761.5646 11710.5490   411%     -   16s
H    0     0                    -3747.013011 11541.1433   408%     -   17s
     0     0 11541.1433    0  456 -3747.0130 11541.1433   408%     -   17s
     0     0 11455.2234    0  469 -3747.0130 11455.2234   406%     -   17s
     0     0 11418.6871    0  461 -3747.0130 11418.6871   405%     -   18s
     0     0 11409.1737    0  473 -3747.0130 11409.1737   404%     -   18s
     0     0 11407.7679    0  481 -3747.0130 11407.7679   404%     -   18s
     0     0 11407.6692    0  481 -3747.0130 11407.6692   404%     -   18s
     0     0 10180.5811    0  421 -3747.0130 10180.5811   372%     -   22s
     0     0 9715.01524    0  445 -3747.0130 9715.01524   359%     -   23s
     0     0 9514.58207    0  426 -3747.0130 9514.58207   354%     -   23s
H    0     0                    -3739.639606 9439.35464   352%     -   24s
     0     0 9439.35464    0  441 -3739.6396 9439.35464   352%     -   24s
     0     0 9419.70940    0  437 -3739.6396 9419.70940   352%     -   25s
     0     0 9417.75400    0  450 -3739.6396 9417.75400   352%     -   25s
     0     0 9414.54337    0  449 -3739.6396 9414.54337   352%     -   25s
     0     0 9414.44395    0  449 -3739.6396 9414.44395   352%     -   25s
     0     0 8706.05398    0  473 -3739.6396 8706.05398   333%     -   30s
     0     0 8489.35398    0  463 -3739.6396 8489.35398   327%     -   31s
     0     0 8439.19503    0  467 -3739.6396 8439.19503   326%     -   32s
     0     0 8426.84940    0  473 -3739.6396 8426.84940   325%     -   33s
     0     0 8417.80778    0  469 -3739.6396 8417.80778   325%     -   33s
     0     0 8416.11592    0  469 -3739.6396 8416.11592   325%     -   33s
     0     0 8414.89525    0  472 -3739.6396 8414.89525   325%     -   33s
     0     0 8321.27793    0  479 -3739.6396 8321.27793   323%     -   34s
     0     0 8243.73567    0  484 -3739.6396 8243.73567   320%     -   35s
     0     0 8233.42022    0  487 -3739.6396 8233.42022   320%     -   35s
     0     0 8232.22104    0  478 -3739.6396 8232.22104   320%     -   35s
H    0     0                    -3254.921004 8163.95211   351%     -   36s
H    0     0                    -3249.583435 8163.95211   351%     -   36s
H    0     0                    -3247.447571 8163.95211   351%     -   36s
H    0     0                    -3241.684793 8163.95211   352%     -   36s
H    0     0                    -3232.621047 8163.95211   353%     -   36s
H    0     0                    -3188.396127 8163.95211   356%     -   36s
H    0     0                    -3150.882069 8163.95211   359%     -   36s
     0     0 8163.95211    0  491 -3150.8821 8163.95211   359%     -   36s
H    0     0                    -3142.442507 8145.27347   359%     -   37s
     0     0 8145.27347    0  497 -3142.4425 8145.27347   359%     -   37s
     0     0 8140.01358    0  495 -3142.4425 8140.01358   359%     -   38s
     0     0 8139.62381    0  501 -3142.4425 8139.62381   359%     -   38s
     0     0 8112.90833    0  504 -3142.4425 8112.90833   358%     -   38s
     0     0 8106.56749    0  497 -3142.4425 8106.56749   358%     -   39s
     0     0 8102.85550    0  511 -3142.4425 8102.85550   358%     -   39s
     0     0 8100.44743    0  506 -3142.4425 8100.44743   358%     -   39s
     0     0 8099.75008    0  508 -3142.4425 8099.75008   358%     -   39s
     0     0 8094.18189    0  511 -3142.4425 8094.18189   358%     -   40s
     0     0 8091.86498    0  507 -3142.4425 8091.86498   358%     -   41s
     0     0 8089.32756    0  505 -3142.4425 8089.32756   357%     -   41s
     0     0 8087.32808    0  513 -3142.4425 8087.32808   357%     -   41s
     0     0 8086.90030    0  512 -3142.4425 8086.90030   357%     -   41s
     0     0 8078.83294    0  521 -3142.4425 8078.83294   357%     -   41s
     0     0 8077.36497    0  516 -3142.4425 8077.36497   357%     -   42s
     0     0 8069.11103    0  522 -3142.4425 8069.11103   357%     -   42s
H    0     0                    -3131.406001 8068.36936   358%     -   43s
H    0     0                    -2981.463243 8068.36936   371%     -   43s
H    0     0                    -2896.397580 8068.36936   379%     -   43s
H    0     0                    -2769.769539 8068.36936   391%     -   43s
H    0     0                    -2767.889112 8068.36936   391%     -   43s
     0     0 8067.28302    0  526 -2767.8891 8067.28302   391%     -   43s
     0     0 8065.92417    0  519 -2767.8891 8065.92417   391%     -   43s
     0     0 8057.30453    0  523 -2767.8891 8057.30453   391%     -   44s
     0     0 8057.07199    0  523 -2767.8891 8057.07199   391%     -   44s
H    0     0                    -1669.687062 8056.98528   583%     -   52s
H    0     0                    -478.1346932 8056.98528  1785%     -   52s
H    0     0                    -430.5046471 8056.98528  1972%     -   52s
H    0     0                    -387.7243972 8056.98528  2178%     -   52s
H    0     0                    -368.2504361 8056.98528  2288%     -   52s
H    0     0                    -339.3300931 8056.98528  2474%     -   52s
H    0     2                     -32.2799546 8056.98528      -     -   52s
     0     2 8056.98528    0  523  -32.27995 8056.98528      -     -   52s
     3     8 7997.81846    2  501  -32.27995 8031.68550      -  1072   56s
    15    32 7727.92633    4  574  -32.27995 7904.78432      -  2889   61s
H   32    64                      95.5091401 7727.41980  7991%  3813   64s
H   34    64                     100.1241916 7727.41980  7618%  3679   64s
H   36    64                     118.6450206 7727.41980  6413%  3533   64s
H   37    64                     119.7637981 7727.41980  6352%  3470   64s
    63    96 7399.86394    6  576  119.76380 7594.73667  6241%  3006   66s
   227   292 7202.09359   10  569  119.76380 7594.73667  6241%  1438   71s
   359   399 6972.81565   11  564  119.76380 7594.73667  6241%  1425   76s
   475   487 6753.95917   12  554  119.76380 7331.87359  6022%  1500   81s
   574   557 6506.44102   13  549  119.76380 7331.87359  6022%  1554   85s
   671   639 6414.33022   14  548  119.76380 7331.87359  6022%  1586   92s
   778   731 6105.66831   16  574  119.76380 7331.87359  6022%  1646   96s
   885   819 5092.75220   18  421  119.76380 7331.87359  6022%  1668  102s
  1005   876 4866.77075   19  454  119.76380 7034.95148  5774%  1671  108s
H 1010   876                     188.1021921 7034.95148  3640%  1674  108s
H 1011   876                     464.2607491 7034.95148  1415%  1672  108s
H 1040   876                     592.6879057 7026.35423  1086%  1695  108s
  1047   903 3728.53312   19  344  592.68791 7021.97903  1085%  1705  111s
H 1049   903                     749.7359057 7021.97903   837%  1704  111s
  1206   957 3352.44998   20  420  749.73591 6882.79586   818%  1751  117s
H 1230   957                     765.4946672 6882.79586   799%  1752  117s
H 1233   957                     782.6854682 6882.79586   779%  1755  117s
  1245   995 3659.88983   21  501  782.68547 6882.79586   779%  1759  121s
H 1350  1011                     796.2597750 6882.79586   764%  1753  124s
H 1352  1011                     830.5432431 6882.79586   729%  1753  124s
  1383  1046 3336.73097   22  457  830.54324 6882.79586   729%  1758  127s
  1470  1059     cutoff   23       830.54324 6882.79586   729%  1773  131s
  1578  1132 1388.47233   26  306  830.54324 6882.79586   729%  1776  137s
  1652  1151 1151.11888   34   65  830.54324 6882.79586   729%  1756  141s
  1855  1189 3287.04667   12  354  830.54324 6882.79586   729%  1742  148s
  1962  1210 2540.22848   13  319  830.54324 6882.79586   729%  1740  152s
  2107  1240     cutoff   15       830.54324 6874.31469   728%  1723  156s
  2365  1348 5611.43530   12  439  830.54324 6426.73835   674%  1734  163s
  2505  1373 4381.38235   14  487  830.54324 6426.73835   674%  1727  167s
  2626  1391 4023.43337   15  415  830.54324 6426.73835   674%  1741  170s
H 2676  1411                     841.8420266 6426.73835   663%  1755  173s
  2749  1427 2240.34164   17  429  841.84203 6426.73835   663%  1758  176s
  2920  1437 infeasible   19       841.84203 6426.73835   663%  1743  181s
  3090  1488     cutoff   19       841.84203 5925.54144   604%  1735  185s
  3273  1553     cutoff   18       841.84203 5817.04854   591%  1723  190s
  3646  1608     cutoff   17       841.84203 5790.79284   588%  1702  197s
  3835  1631     cutoff   18       841.84203 5772.11264   586%  1709  202s
  4057  1668 3589.57257   16  411  841.84203 5685.81828   575%  1703  206s
  4182  1675 2287.79199   17  372  841.84203 5620.97802   568%  1713  211s
  4267  1684 1423.40534   18  388  841.84203 5620.97802   568%  1717  215s
  4322  1692     cutoff   19       841.84203 5583.58313   563%  1721  221s
  4430  1733     cutoff   19       841.84203 5493.35063   553%  1722  226s
  4623  1755     cutoff   18       841.84203 5457.11392   548%  1709  232s
  4851  1750 2403.34962   10  271  841.84203 5457.11392   548%  1705  238s
  5026  1770     cutoff   15       841.84203 5395.31512   541%  1706  244s
  5295  1835 4494.08490    7  313  841.84203 5395.31512   541%  1701  250s
  5593  1859 1462.26316   13  186  841.84203 5263.63751   525%  1694  256s
  5916  1906 2820.10461   20  519  841.84203 5242.95820   523%  1682  263s
  6211  1908     cutoff   23       841.84203 5242.95820   523%  1682  270s
  6444  1962     cutoff   18       841.84203 5042.51154   499%  1683  276s
  6728  1987     cutoff   16       841.84203 4945.75948   487%  1683  284s
  7096  2008 1266.92095   17  197  841.84203 4925.48959   485%  1680  291s
  7466  2049 2123.58731   15  284  841.84203 4721.54688   461%  1678  299s
  7872  2065     cutoff   14       841.84203 4667.00786   454%  1669  306s
  8041  2111     cutoff   15       841.84203 4667.00786   454%  1667  315s
H 8316  2088                     973.0285271 4653.61496   378%  1653  315s
  8458  2088 1755.20345   16  175  973.02853 4545.92192   367%  1649  323s
  8907  2090 1693.25412   16  298  973.02853 4457.13010   358%  1640  332s
  9366  2103     cutoff   16       973.02853 4350.69193   347%  1635  341s
H 9392  2102                     974.3776758 4317.61944   343%  1632  341s
H 9479  2092                    1002.0554085 4310.72543   330%  1629  341s
  9889  2097 1450.54619   14  120 1002.05541 4230.89685   322%  1614  350s
 10443  2051     cutoff   20      1002.05541 4103.55576   310%  1603  359s
 11008  2017     cutoff   15      1002.05541 4022.06904   301%  1594  369s
 11699  1970     cutoff   17      1002.05541 3885.93474   288%  1570  378s
 12425  1884     cutoff   14      1002.05541 3807.63096   280%  1550  389s
 13115  1740     cutoff   15      1002.05541 3599.88660   259%  1536  399s
 13825  1510 1186.37380   19  339 1002.05541 3441.65647   243%  1525  409s
 14657  1132     cutoff   13      1002.05541 3174.04099   217%  1503  420s
 15643   598 1128.13249   15  133 1002.05541 2766.19373   176%  1471  429s
*15768   598              20    1003.8490880 2760.07095   175%  1465  429s
 16940     0     cutoff   17      1003.84909 2260.54789   125%  1417  436s

Cutting planes:
  Implied bound: 37
  MIR: 497
  Flow cover: 772
  Zero half: 8
  RLT: 34
  Relax-and-lift: 19

Explored 17919 nodes (24461147 simplex iterations) in 436.14 seconds (1437.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 1003.85 1002.06 974.378 ... 749.736

Optimal solution found (tolerance 1.00e-04)
Best objective 1.003849088028e+03, best bound 1.003849088028e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 436.18s
  Master Objective (UB) = 1003.85, θ = 115821.70
  Upper Bound (UB) = 1003.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115821.70
  [DEBUG]   ✓ Scenario 0: θ = 115821.70 ≤ Q = 115821.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115821.70 ≤ Q = 115821.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115821.70 ≤ Q = 115821.70 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x31a8c79e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xce573862
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.199758e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6086471.5966
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.288605e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128860.53    0  132 6086471.60 -128860.53   102%     -    0s
H    0     0                    -93139.16398 -128860.53  38.4%     -    0s
H    0     0                    -93967.96309 -128860.53  37.1%     -    0s
H    0     0                    -109078.1776 -128860.53  18.1%     -    0s
H    0     0                    -111395.9381 -114844.20  3.10%     -    0s
     0     0 -114844.20    0  127 -111395.94 -114844.20  3.10%     -    0s
     0     0 -114417.27    0  128 -111395.94 -114417.27  2.71%     -    0s
H    0     0                    -111865.3724 -114417.27  2.28%     -    0s
     0     0 -113965.12    0  130 -111865.37 -113965.12  1.88%     -    0s
H    0     0                    -112760.8815 -113959.90  1.06%     -    0s
     0     0 -113937.89    0  130 -112760.88 -113937.89  1.04%     -    0s
     0     0 -113936.48    0  130 -112760.88 -113936.48  1.04%     -    0s
     0     0 -113420.17    0  119 -112760.88 -113420.17  0.58%     -    0s
     0     0 -113339.54    0   98 -112760.88 -113339.54  0.51%     -    0s
     0     0 -113317.48    0   99 -112760.88 -113317.48  0.49%     -    0s
     0     0 -113316.55    0   98 -112760.88 -113316.55  0.49%     -    0s
     0     0 -113129.56    0   84 -112760.88 -113129.56  0.33%     -    0s
H    0     0                    -112764.4098 -113128.64  0.32%     -    0s
     0     0 -113125.21    0   70 -112764.41 -113125.21  0.32%     -    0s
     0     0 -113048.73    0   80 -112764.41 -113048.73  0.25%     -    0s
     0     0 -113033.95    0   75 -112764.41 -113033.95  0.24%     -    0s
H    0     0                    -112780.5195 -113021.77  0.21%     -    0s
     0     2 -113021.77    0   75 -112780.52 -113021.77  0.21%     -    0s
H   65    29                    -112782.4056 -112855.18  0.06%   6.4    0s
H   72    28                    -112794.5640 -112853.12  0.05%   6.2    0s
H  226    75                    -112798.5459 -112839.26  0.04%   3.7    0s
H  236    75                    -112804.3344 -112839.26  0.03%   3.6    0s

Cutting planes:
  Gomory: 36
  Implied bound: 10
  MIR: 141
  Flow cover: 23
  RLT: 77
  Relax-and-lift: 2
  BQP: 4

Explored 401 nodes (2080 simplex iterations) in 0.10 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -112804 -112799 -112795 ... -109078

Optimal solution found (tolerance 1.00e-04)
Best objective -1.128043343652e+05, best bound -1.128093914140e+05, gap 0.0045%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 97968.77
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112804.33
  [DEBUG]   S×d_nominal = 210773.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 210773.10 + -112804.33 = 97968.77
  [DEBUG]   Current θ from Master = 115821.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17852.93 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16849.08
  Lower Bound (LB) = -5684.99
  Gap (UB-LB) = 6688.8418, Absolute Gap = 6688.8418, Relative Gap = 6.663195
  Not converged yet (gap = 6688.84 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0x71bf2d4f
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -16849.1 (0.03s)
Loaded MIP start from previous solve with objective -16849.1

Presolve removed 27108 rows and 11008 columns
Presolve time: 0.56s
Presolved: 35435 rows, 16212 columns, 219059 nonzeros
Variable types: 13953 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35435 rows, 16212 columns, 219059 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38080    1.3157163e+04   0.000000e+00   2.373394e+06      5s
Concurrent spin time: 0.05s

Solved with dual simplex

Root relaxation: objective 1.844770e+04, 26847 iterations, 7.83 seconds (15.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 18447.7022    0  272 -16849.082 18447.7022   209%     -    8s
H    0     0                    -15063.13053 18447.7022   222%     -    8s
H    0     0                    -14677.68085 18447.7022   226%     -    8s
H    0     0                    -7859.203094 18447.7022   335%     -    8s
H    0     0                    -6436.699042 18447.7022   387%     -    8s
H    0     0                    -4275.922297 18447.7022   531%     -    8s
H    0     0                    -4047.813919 18447.7022   556%     -    8s
H    0     0                    -3893.984011 14980.0807   485%     -   13s
H    0     0                    -3873.088817 14980.0807   487%     -   13s
H    0     0                    -3870.059060 14980.0807   487%     -   13s
H    0     0                    -3845.969208 14980.0807   490%     -   13s
     0     0 14980.0807    0  348 -3845.9692 14980.0807   490%     -   13s
     0     0 13038.3427    0  346 -3845.9692 13038.3427   439%     -   15s
     0     0 12999.9608    0  338 -3845.9692 12999.9608   438%     -   17s
     0     0 12999.9608    0  346 -3845.9692 12999.9608   438%     -   18s
     0     0 11028.2297    0  346 -3845.9692 11028.2297   387%     -   18s
H    0     0                    -3838.595804 11028.2297   387%     -   19s
     0     0 11027.2350    0  349 -3838.5958 11027.2350   387%     -   19s
     0     0 11027.2350    0  349 -3838.5958 11027.2350   387%     -   19s
H    0     0                    -3748.893438 11027.2350   394%     -   22s
     0     0 11020.2130    0  430 -3748.8934 11020.2130   394%     -   22s
     0     0 10600.7283    0  449 -3748.8934 10600.7283   383%     -   25s
H    0     0                    -3747.013011 10202.4342   372%     -   27s
     0     0 10202.4342    0  447 -3747.0130 10202.4342   372%     -   27s
H    0     0                    -3739.639606 10077.6261   369%     -   28s
     0     0 10077.6261    0  455 -3739.6396 10077.6261   369%     -   28s
     0     0 9921.32657    0  452 -3739.6396 9921.32657   365%     -   29s
     0     0 9818.51671    0  444 -3739.6396 9818.51671   363%     -   30s
     0     0 9795.73963    0  443 -3739.6396 9795.73963   362%     -   30s
     0     0 9780.08478    0  445 -3739.6396 9780.08478   362%     -   31s
     0     0 9776.58614    0  446 -3739.6396 9776.58614   361%     -   31s
     0     0 9776.33117    0  447 -3739.6396 9776.33117   361%     -   31s
     0     0 8313.20063    0  476 -3739.6396 8313.20063   322%     -   38s
     0     0 7648.72299    0  483 -3739.6396 7648.72299   305%     -   43s
     0     0 7306.44883    0  434 -3739.6396 7306.44883   295%     -   45s
     0     0 7171.82943    0  454 -3739.6396 7171.82943   292%     -   48s
     0     0 7124.32784    0  459 -3739.6396 7124.32784   291%     -   48s
     0     0 6994.90565    0  456 -3739.6396 6994.90565   287%     -   50s
     0     0 6915.67561    0  462 -3739.6396 6915.67561   285%     -   51s
     0     0 6895.05728    0  468 -3739.6396 6895.05728   284%     -   51s
     0     0 6889.58541    0  468 -3739.6396 6889.58541   284%     -   51s
     0     0 6888.01597    0  472 -3739.6396 6888.01597   284%     -   52s
     0     0 6887.87372    0  471 -3739.6396 6887.87372   284%     -   52s
     0     0 6330.58789    0  484 -3739.6396 6330.58789   269%     -   58s
     0     0 6098.44507    0  475 -3739.6396 6098.44507   263%     -   61s
     0     0 6008.57291    0  483 -3739.6396 6008.57291   261%     -   62s
     0     0 5905.91350    0  476 -3739.6396 5905.91350   258%     -   63s
     0     0 5877.67509    0  485 -3739.6396 5877.67509   257%     -   63s
     0     0 5867.80288    0  480 -3739.6396 5867.80288   257%     -   64s
     0     0 5862.94880    0  476 -3739.6396 5862.94880   257%     -   64s
     0     0 5836.19413    0  472 -3739.6396 5836.19413   256%     -   64s
     0     0 5833.87220    0  478 -3739.6396 5833.87220   256%     -   65s
     0     0 5833.38454    0  476 -3739.6396 5833.38454   256%     -   65s
     0     0 5768.69146    0  487 -3739.6396 5768.69146   254%     -   66s
     0     0 5754.13872    0  490 -3739.6396 5754.13872   254%     -   67s
     0     0 5703.08836    0  503 -3739.6396 5703.08836   253%     -   67s
     0     0 5694.21425    0  501 -3739.6396 5694.21425   252%     -   68s
     0     0 5690.70542    0  496 -3739.6396 5690.70542   252%     -   68s
     0     0 5689.74916    0  496 -3739.6396 5689.74916   252%     -   68s
     0     0 5613.23487    0  491 -3739.6396 5613.23487   250%     -   70s
     0     0 5602.47677    0  488 -3739.6396 5602.47677   250%     -   72s
     0     0 5596.87278    0  490 -3739.6396 5596.87278   250%     -   72s
     0     0 5595.15292    0  491 -3739.6396 5595.15292   250%     -   72s
     0     0 5572.34840    0  504 -3739.6396 5572.34840   249%     -   73s
     0     0 5568.97903    0  502 -3739.6396 5568.97903   249%     -   74s
     0     0 5548.01463    0  498 -3739.6396 5548.01463   248%     -   74s
     0     0 5544.90271    0  499 -3739.6396 5544.90271   248%     -   74s
     0     0 5543.80644    0  500 -3739.6396 5543.80644   248%     -   75s
     0     0 5530.59023    0  505 -3739.6396 5530.59023   248%     -   76s
     0     0 5529.54468    0  504 -3739.6396 5529.54468   248%     -   78s
     0     0 5525.39925    0  509 -3739.6396 5525.39925   248%     -   79s
     0     0 5523.34314    0  503 -3739.6396 5523.34314   248%     -   80s
     0     0 5521.44196    0  503 -3739.6396 5521.44196   248%     -   80s
     0     0 5520.23459    0  508 -3739.6396 5520.23459   248%     -   80s
     0     0 5512.94446    0  503 -3739.6396 5512.94446   247%     -   81s
     0     0 5511.92595    0  499 -3739.6396 5511.92595   247%     -   81s
     0     0 5498.29448    0  506 -3739.6396 5498.29448   247%     -   82s
     0     0 5497.62198    0  506 -3739.6396 5497.62198   247%     -   83s
H    0     0                    -2762.723165 5497.62198   299%     -   95s
H    0     2                    -2690.782549 5497.62198   304%     -   96s
     0     2 5497.62198    0  506 -2690.7825 5497.62198   304%     -   96s
     3     8 4980.32229    2  471 -2690.7825 5313.97216   297%  2853  100s
    15    32 4698.73206    4  467 -2690.7825 4919.30485   283%  2237  108s
    31    64 4619.78675    5  474 -2690.7825 4757.82163   277%  3592  112s
    95   171 4434.92526    7  478 -2690.7825 4700.45182   275%  2215  116s
H  171   205                    -2688.902122 4700.45182   275%  1640  118s
   204   275 4217.09590    9  557 -2688.9021 4700.45182   275%  1549  121s
   274   345 3394.92429    9  442 -2688.9021 4700.45182   275%  1464  125s
   416   471 2813.94652   10  508 -2688.9021 4700.45182   275%  1340  133s
   494   523 3929.72930   11  550 -2688.9021 4700.45182   275%  1269  137s
   555   578 2471.21434   11  446 -2688.9021 4655.46852   273%  1250  140s
   664   643 2586.16770   12  483 -2688.9021 4655.46852   273%  1228  145s
   705   683 3359.55390   13  526 -2688.9021 4655.46852   273%  1260  150s
   815   779 2004.96323   14  514 -2688.9021 4655.46852   273%  1275  158s
   887   827 3260.30014   14  524 -2688.9021 4619.23690   272%  1240  162s
   953   878 3160.61228   15  519 -2688.9021 4619.23690   272%  1245  167s
  1022   927 2965.99839   16  509 -2688.9021 4619.23690   272%  1229  170s
  1093   951 2146.18638   17  532 -2688.9021 4619.23690   272%  1214  175s
  1213  1038 -552.65929   18  521 -2688.9021 4619.23690   272%  1192  183s
  1278  1114 1255.16402   19  515 -2688.9021 4500.30930   267%  1186  186s
  1356  1204  470.16932   19  517 -2688.9021 4349.28773   262%  1172  190s
  1453  1287 1082.81008   20  574 -2688.9021 4349.28773   262%  1154  195s
  1688  1511  578.21800   21  497 -2688.9021 4297.59211   260%  1109  201s
  1976  1598  -83.40495   22  485 -2688.9021 4297.59211   260%  1055  209s
  2046  1627 infeasible   22      -2688.9021 4297.59211   260%  1061  211s
  2081  1648 -894.42847   23  412 -2688.9021 4297.59211   260%  1063  215s
  2175  1712     cutoff   27      -2688.9021 4297.59211   260%  1065  224s
  2224  1738  723.53747   11  504 -2688.9021 4297.59211   260%  1070  227s
H 2243  1738                    -2671.236876 4297.59211   261%  1070  227s
  2268  1802  409.82912   12  505 -2671.2369 4297.59211   261%  1070  232s
H 2296  1802                    -2663.814736 4297.59211   261%  1067  232s
  2424  1913  338.41484   13  492 -2663.8147 4297.59211   261%  1044  236s
  2620  2004 -1194.4473   16  426 -2663.8147 4297.59211   261%  1026  242s
  2810  2139 -1822.9627   18  417 -2663.8147 4100.89670   254%  1015  247s
  3026  2250     cutoff   21      -2663.8147 4100.89670   254%   998  252s
  3271  2298  -18.32611   11  343 -2663.8147 4100.89670   254%   980  257s
  3446  2321     cutoff   14      -2663.8147 3796.18459   243%   982  262s
  3531  2355 -2443.8070   16  302 -2663.8147 3632.34206   236%   987  267s
  3684  2439 1429.92531   12  408 -2663.8147 3541.16186   233%   990  274s
  3839  2514   61.39675   15  226 -2663.8147 3541.16186   233%   997  281s
  4026  2581     cutoff   17      -2663.8147 3541.16186   233%  1006  287s
  4258  2651 -1568.3958   17  246 -2663.8147 3351.98026   226%  1002  293s
  4424  2719 2224.83952   10  399 -2663.8147 3203.03707   220%  1016  300s
  4642  2824 1885.38604   12  437 -2663.8147 3201.38544   220%  1023  307s
  4850  2912   81.41175   17  369 -2663.8147 3195.81414   220%  1029  315s
  5135  3035 -163.22351   19  356 -2663.8147 3165.76026   219%  1025  322s
  5378  3036 1439.41443   14  506 -2663.8147 3130.48223   218%  1027  342s
  5380  3037 -1642.7704   15  272 -2663.8147 3130.48223   218%  1026  350s
  5381  3038 1564.29618   13  444 -2663.8147 3130.48223   218%  1026  359s
  5382  3039 -108.06344   29  444 -2663.8147 3130.48223   218%  1026  364s
  5383  3039 -2494.5476   21  486 -2663.8147 3130.48223   218%  1026  368s
  5384  3040 -906.99243   19  476 -2663.8147 3130.48223   218%  1025  371s
  5386  3041  613.04942   16  484 -2663.8147 3130.48223   218%  1025  376s
  5388  3043 1886.66401   11  490 -2663.8147 3130.48223   218%  1025  380s
  5392  3045 1446.96439   12  494 -2663.8147 3130.48223   218%  1024  385s
  5395  3047 1182.11456   17  485 -2663.8147 3130.48223   218%  1023  391s
  5399  3050 -932.09861   16  493 -2663.8147 3130.48223   218%  1023  398s
  5401  3051 -1855.5575   28  498 -2663.8147 3130.48223   218%  1022  400s
  5404  3053  748.44140   21  565 -2663.8147 3130.48223   218%  1022  405s
  5406  3055 -1223.0985   47  498 -2663.8147 3130.48223   218%  1021  410s
  5409  3057 1339.71595   10  501 -2663.8147 3130.48223   218%  1021  415s
  5411  3058 -1326.4732   49  506 -2663.8147 3130.48223   218%  1020  420s
  5413  3059 -1199.5771   46  505 -2663.8147 3130.48223   218%  1020  432s
  5414  3060  384.89123   27  505 -2663.8147 3130.48223   218%  1020  442s
  5415  3064 3130.48223   10  542 -2663.8147 3130.48223   218%  1039  448s
  5417  3067 3130.48223   11  591 -2663.8147 3130.48223   218%  1039  454s
  5421  3074 3130.48223   12  633 -2663.8147 3130.48223   218%  1044  462s
  5429  3087 3130.48223   13  636 -2663.8147 3130.48223   218%  1047  468s
  5445  3114 3130.48223   14  642 -2663.8147 3130.48223   218%  1058  474s
  5477  3131 3130.48223   15  643 -2663.8147 3130.48223   218%  1069  479s
  5509  3150 3130.48223   16  602 -2663.8147 3130.48223   218%  1093  482s
  5543  3180 3130.48223   17  597 -2663.8147 3130.48223   218%  1106  487s
  5586  3203 2514.79205   17  586 -2663.8147 3130.48223   218%  1108  492s
  5634  3221 3130.48223   18  642 -2663.8147 3130.48223   218%  1112  495s
  5687  3237  -89.80353   18  568 -2663.8147 3130.48223   218%  1117  500s
  5792  3262 2117.88088   19  582 -2663.8147 3130.48223   218%  1130  508s
  5842  3270 1298.66234   20  404 -2663.8147 3130.48223   218%  1134  512s
  5900  3270  458.92913   20  412 -2663.8147 3130.48223   218%  1136  517s
  5955  3275 1198.24265   21  340 -2663.8147 3130.48223   218%  1139  521s
  6017  3277 -1347.2275   21  505 -2663.8147 3130.48223   218%  1142  526s
  6068  3272 -207.46833   22  385 -2663.8147 3130.48223   218%  1144  532s
  6132  3270 -198.05974   22  277 -2663.8147 2845.00681   207%  1146  536s
  6192  3269 -609.25976   23  395 -2663.8147 2845.00681   207%  1152  541s
  6258  3276 -1647.0349   23  254 -2663.8147 2845.00681   207%  1153  547s
  6325  3284 -2428.6155   24  248 -2663.8147 2845.00681   207%  1154  552s
  6402  3268     cutoff   24      -2663.8147 2503.47460   194%  1155  557s
  6485  3238     cutoff   26      -2663.8147 2333.01394   188%  1154  562s
  6582  3237 -1987.2463   19  487 -2663.8147 2198.87180   183%  1161  569s
  6660  3232  833.60168   19  456 -2663.8147 2121.18139   180%  1167  574s
  6751  3234 -2286.3323   20  493 -2663.8147 2121.18139   180%  1171  580s
  6846  3229  823.35670   20  455 -2663.8147 2047.38934   177%  1177  585s
  6971  3199   90.09102   21  486 -2663.8147 2047.38934   177%  1176  593s
  7100  3178  -29.84319   22  485 -2663.8147 2047.38934   177%  1179  600s
  7228  3167     cutoff   23      -2663.8147 1621.35122   161%  1181  606s
  7361  3138 -439.14537   23  464 -2663.8147 1621.35122   161%  1184  613s
  7525  3095  287.51234   21  369 -2663.8147 1483.29194   156%  1183  622s
  7671  3081 -688.31304   24  418 -2663.8147 1195.30246   145%  1187  628s
  7814  3029 -2603.6471   29  297 -2663.8147 1117.81141   142%  1189  635s
  7998  2974 -1220.4165   21  387 -2663.8147 1117.81141   142%  1190  642s
  8171  2906     cutoff   23      -2663.8147  757.54687   128%  1191  649s
  8358  2821 -2174.5403   17  408 -2663.8147  698.21269   126%  1192  657s
  8557  2734     cutoff   21      -2663.8147  576.44002   122%  1192  664s
  8789  2649 -988.43655   21  355 -2663.8147  251.03959   109%  1192  671s
  8994  2524     cutoff   27      -2663.8147   95.03384   104%  1194  681s
  9215  2383 -1977.3241   17  140 -2663.8147    5.42410   100%  1198  690s
  9425  2209 -2547.8181   17  349 -2663.8147 -287.88992  89.2%  1201  698s
  9712  1906     cutoff   21      -2663.8147 -640.75919  75.9%  1196  705s
 10141  1570     cutoff   21      -2663.8147 -640.75919  75.9%  1173  713s
 10506  1363 infeasible   29      -2663.8147 -1282.4309  51.9%  1153  716s

Cutting planes:
  MIR: 441
  Flow cover: 802
  Zero half: 4
  RLT: 18
  Relax-and-lift: 25

Explored 10614 nodes (12282506 simplex iterations) in 717.02 seconds (1962.30 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -2663.81 -2671.24 -2688.9 ... -3845.97
No other solutions better than -2663.81

Optimal solution found (tolerance 1.00e-04)
Best objective -2.663814735605e+03, best bound -2.663814735605e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 717.03s
  Master Objective (UB) = -2663.81, θ = 120069.35
  Upper Bound (UB) = -2663.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120069.35
  [DEBUG]   ✓ Scenario 0: θ = 120069.35 ≤ Q = 120069.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120069.35 ≤ Q = 120069.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120069.35 ≤ Q = 120069.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120069.35 ≤ Q = 120069.35 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x63b2a705
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9c4d58fb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.254015e+13
Presolve removed 2586 rows and 1880 columns
Presolve time: 0.00s
Presolved: 507 rows, 509 columns, 1429 nonzeros
Found heuristic solution: objective 6561931.7699
Variable types: 343 continuous, 166 integer (166 binary)

Root relaxation: objective -1.233960e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123396.01    0  130 6561931.77 -123396.01   102%     -    0s
H    0     0                    -88676.30672 -123396.01  39.2%     -    0s
H    0     0                    -89556.99636 -123396.01  37.8%     -    0s
H    0     0                    -92223.42683 -110728.54  20.1%     -    0s
H    0     0                    -95503.34001 -110728.54  15.9%     -    0s
     0     0 -110728.54    0   86 -95503.340 -110728.54  15.9%     -    0s
H    0     0                    -109190.6056 -110719.67  1.40%     -    0s
     0     0 -110564.13    0   81 -109190.61 -110564.13  1.26%     -    0s
H    0     0                    -109713.2308 -110564.13  0.78%     -    0s
     0     0 -110197.67    0   66 -109713.23 -110197.67  0.44%     -    0s
     0     0 -110064.52    0   44 -109713.23 -110064.52  0.32%     -    0s
     0     0 -110055.22    0   34 -109713.23 -110055.22  0.31%     -    0s
     0     0 -109952.14    0   45 -109713.23 -109952.14  0.22%     -    0s
     0     0 -109941.20    0   34 -109713.23 -109941.20  0.21%     -    0s
     0     0 -109933.85    0   31 -109713.23 -109933.85  0.20%     -    0s
     0     0 -109933.00    0   30 -109713.23 -109933.00  0.20%     -    0s
     0     0 -109820.56    0   11 -109713.23 -109820.56  0.10%     -    0s
     0     0 -109820.56    0   13 -109713.23 -109820.56  0.10%     -    0s
H    0     0                    -109743.5812 -109820.56  0.07%     -    0s
*    0     0               0    -109762.7041 -109762.70  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 3
  MIR: 2
  Flow cover: 5
  Relax-and-lift: 6

Explored 1 nodes (702 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109763 -109744 -109713 ... 6.56193e+06
No other solutions better than -109763

Optimal solution found (tolerance 1.00e-04)
Best objective -1.097627041100e+05, best bound -1.097627041100e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 102019.71
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109762.70
  [DEBUG]   S×d_nominal = 211782.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211782.42 + -109762.70 = 102019.71
  [DEBUG]   Current θ from Master = 120069.35
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18049.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20713.45
  Lower Bound (LB) = -5684.99
  Gap (UB-LB) = 3021.1779, Absolute Gap = 3021.1779, Relative Gap = 1.134155
  Not converged yet (gap = 3021.18 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0x550c2f55
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33875 rows and 13755 columns
Presolve time: 0.74s
Presolved: 43958 rows, 19705 columns, 272474 nonzeros
Variable types: 17446 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -359952.0065
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43958 rows, 19705 columns, 272474 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29171   -2.8912068e+03   0.000000e+00   2.845283e+07      5s
Concurrent spin time: 0.08s

Solved with dual simplex

Root relaxation: objective 1.844770e+04, 27505 iterations, 8.56 seconds (17.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 18447.7022    0  272 -210563.59 18447.7022   109%     -    9s
H    0     0                    -201858.7478 18447.7022   109%     -    9s
H    0     0                    -44973.20681 18447.7022   141%     -    9s
H    0     0                    -15063.13053 18447.7022   222%     -    9s
H    0     0                    -14677.68085 18447.7022   226%     -    9s
H    0     0                    -4550.760140 18447.7022   505%     -    9s
H    0     0                    -4047.813919 18447.7022   556%     -   10s
H    0     0                    -3921.395135 14988.6994   482%     -   15s
H    0     0                    -3845.969208 14988.6994   490%     -   15s
     0     0 14983.1006    0  348 -3845.9692 14983.1006   490%     -   15s
     0     0 12997.2761    0  343 -3845.9692 12997.2761   438%     -   20s
     0     0 12997.2761    0  342 -3845.9692 12997.2761   438%     -   22s
     0     0 12997.2761    0  340 -3845.9692 12997.2761   438%     -   22s
     0     0 12997.2761    0  340 -3845.9692 12997.2761   438%     -   22s
     0     0 12997.2761    0  350 -3845.9692 12997.2761   438%     -   23s
     0     0 12997.2761    0  354 -3845.9692 12997.2761   438%     -   24s
     0     0 12997.2761    0  345 -3845.9692 12997.2761   438%     -   24s
     0     0 12997.2761    0  348 -3845.9692 12997.2761   438%     -   24s
     0     0 10819.2819    0  346 -3845.9692 10819.2819   381%     -   24s
     0     0 10819.2819    0  348 -3845.9692 10819.2819   381%     -   25s
H    0     0                    -3838.595804 10819.2819   382%     -   25s
     0     0 10806.9620    0  422 -3838.5958 10806.9620   382%     -   30s
H    0     0                    -3814.790355 10806.9620   383%     -   31s
H    0     0                    -3791.119992 10270.9699   371%     -   35s
H    0     0                    -3748.893438 10270.9699   374%     -   35s
     0     0 10270.9699    0  433 -3748.8934 10270.9699   374%     -   35s
     0     0 9970.88676    0  457 -3748.8934 9970.88676   366%     -   38s
H    0     0                    -3747.013011 9789.09523   361%     -   40s
     0     0 9789.09523    0  443 -3747.0130 9789.09523   361%     -   40s
     0     0 9719.60332    0  448 -3747.0130 9719.60332   359%     -   41s
     0     0 9665.01714    0  452 -3747.0130 9665.01714   358%     -   42s
     0     0 9653.61070    0  455 -3747.0130 9653.61070   358%     -   42s
     0     0 9651.88858    0  452 -3747.0130 9651.88858   358%     -   43s
     0     0 9651.37361    0  451 -3747.0130 9651.37361   358%     -   43s
H    0     0                    -3741.520034 9651.37361   358%     -   46s
H    0     0                    -3739.639606 8094.88411   316%     -   52s
     0     0 8094.88411    0  407 -3739.6396 8094.88411   316%     -   52s
     0     0 7373.02463    0  423 -3739.6396 7373.02463   297%     -   57s
     0     0 7225.93672    0  430 -3739.6396 7225.93672   293%     -   59s
     0     0 7174.93648    0  434 -3739.6396 7174.93648   292%     -   61s
     0     0 7154.26087    0  434 -3739.6396 7154.26087   291%     -   62s
     0     0 7143.17601    0  438 -3739.6396 7143.17601   291%     -   62s
     0     0 7140.42441    0  440 -3739.6396 7140.42441   291%     -   63s
     0     0 7137.36764    0  436 -3739.6396 7137.36764   291%     -   63s
     0     0 7135.58814    0  447 -3739.6396 7135.58814   291%     -   63s
     0     0 7135.24244    0  449 -3739.6396 7135.24244   291%     -   63s
     0     0 6379.66990    0  519 -3739.6396 6379.66990   271%     -   72s
     0     0 6202.84769    0  462 -3739.6396 6202.84769   266%     -   75s
     0     0 6125.59672    0  519 -3739.6396 6125.59672   264%     -   77s
     0     0 6070.90983    0  519 -3739.6396 6070.90983   262%     -   78s
     0     0 6050.09031    0  468 -3739.6396 6050.09031   262%     -   79s
     0     0 6041.55822    0  477 -3739.6396 6041.55822   262%     -   79s
     0     0 6024.42682    0  469 -3739.6396 6024.42682   261%     -   80s
     0     0 6009.23383    0  467 -3739.6396 6009.23383   261%     -   81s
     0     0 6008.09943    0  472 -3739.6396 6008.09943   261%     -   81s
     0     0 5943.21355    0  476 -3739.6396 5943.21355   259%     -   83s
     0     0 5916.37752    0  482 -3739.6396 5916.37752   258%     -   84s
     0     0 5906.14145    0  491 -3739.6396 5906.14145   258%     -   85s
     0     0 5900.16448    0  493 -3739.6396 5900.16448   258%     -   85s
     0     0 5858.84918    0  486 -3739.6396 5858.84918   257%     -   86s
     0     0 5850.57684    0  495 -3739.6396 5850.57684   256%     -   87s
     0     0 5837.17768    0  489 -3739.6396 5837.17768   256%     -   87s
     0     0 5835.95767    0  490 -3739.6396 5835.95767   256%     -   87s
     0     0 5779.53685    0  524 -3739.6396 5779.53685   255%     -   89s
     0     0 5771.66628    0  481 -3739.6396 5771.66628   254%     -   91s
     0     0 5767.42949    0  480 -3739.6396 5767.42949   254%     -   92s
     0     0 5765.65584    0  482 -3739.6396 5765.65584   254%     -   92s
     0     0 5765.41451    0  482 -3739.6396 5765.41451   254%     -   92s
     0     0 5724.05711    0  536 -3739.6396 5724.05711   253%     -   94s
     0     0 5707.67297    0  479 -3739.6396 5707.67297   253%     -   95s
     0     0 5700.52915    0  489 -3739.6396 5700.52915   252%     -   96s
     0     0 5696.32956    0  491 -3739.6396 5696.32956   252%     -   96s
     0     0 5696.02610    0  490 -3739.6396 5696.02610   252%     -   96s
     0     0 5676.60612    0  490 -3739.6396 5676.60612   252%     -   97s
     0     0 5669.13346    0  557 -3739.6396 5669.13346   252%     -   99s
     0     0 5667.24071    0  553 -3739.6396 5667.24071   252%     -   99s
     0     0 5666.99284    0  550 -3739.6396 5666.99284   252%     -   99s
     0     0 5658.06240    0  487 -3739.6396 5658.06240   251%     -  101s
     0     0 5655.15902    0  541 -3739.6396 5655.15902   251%     -  101s
     0     0 5652.45535    0  553 -3739.6396 5652.45535   251%     -  102s
     0     0 5652.09001    0  555 -3739.6396 5652.09001   251%     -  102s
     0     0 5644.48148    0  500 -3739.6396 5644.48148   251%     -  103s
     0     0 5640.92500    0  502 -3739.6396 5640.92500   251%     -  105s
     0     0 5638.95659    0  499 -3739.6396 5638.95659   251%     -  105s
     0     0 5638.85956    0  499 -3739.6396 5638.85956   251%     -  105s
     0     0 5634.80680    0  501 -3739.6396 5634.80680   251%     -  106s
     0     0 5631.86170    0  502 -3739.6396 5631.86170   251%     -  107s
     0     0 5630.94862    0  506 -3739.6396 5630.94862   251%     -  107s
     0     0 5630.33872    0  503 -3739.6396 5630.33872   251%     -  108s
     0     0 5629.86886    0  503 -3739.6396 5629.86886   251%     -  109s
     0     2 5629.68488    0  503 -3739.6396 5629.68488   251%     -  146s
     3     8 5563.44034    2  486 -3739.6396 5586.26744   249%  1870  151s
     7    16 5530.03356    3  493 -3739.6396 5562.93829   249%  2419  155s
    15    32 5246.29717    4  488 -3739.6396 5529.90719   248%  3969  160s
    31    48 4671.81073    5  465 -3739.6396 5385.75227   244%  6125  171s
    47    80 2515.21994    6  260 -3739.6396 5385.75227   244%  5898  175s
    79   145 2253.92273    7  240 -3739.6396 5385.75227   244%  4539  185s
   144   177 1680.10839    9  206 -3739.6396 5385.75227   244%  3258  191s
   176   209 2020.44280    8  198 -3739.6396 5385.75227   244%  2916  195s
   240   273 1861.46222    9  181 -3739.6396 5385.75227   244%  2574  202s
   272   305 1769.47651    9  206 -3739.6396 5385.75227   244%  2471  205s
   336   369 1512.90373   10  192 -3739.6396 5385.75227   244%  2266  212s
   368   415 1793.84323   10  173 -3739.6396 5385.75227   244%  2173  216s
   446   497 1599.04387   11  177 -3739.6396 5385.75227   244%  2020  225s
   558   598 1487.44750   12  179 -3739.6396 5385.75227   244%  1864  238s
   640   642 1484.02707   12  165 -3739.6396 5385.75227   244%  1772  245s
   731   685 1194.70342   11  194 -3739.6396 5246.16889   240%  1696  253s
   821   740  820.10976   13  211 -3739.6396 5246.16889   240%  1663  260s
   924   818  739.62567   13  189 -3739.6396 5246.16889   240%  1621  267s
  1025   898  261.64401   15  143 -3739.6396 5246.16889   240%  1573  274s
  1145  1009 -1358.0988   18  125 -3739.6396 5246.16889   240%  1536  281s
  1286  1120 -1702.6275   22  116 -3739.6396 5246.16889   240%  1469  290s
  1462  1196 -2026.5963   27  109 -3739.6396 4926.95113   232%  1381  297s
  1629  1276     cutoff   29      -3739.6396 4926.95113   232%  1344  304s
  1783  1369 -1534.0598    8  162 -3739.6396 4926.95113   232%  1327  311s
  1927  1455 -2076.1992    9  187 -3739.6396 4926.95113   232%  1326  317s
  2098  1551 3393.66330    9  431 -3739.6396 4413.52520   218%  1318  323s
  2259  1645 3120.05782   11  423 -3739.6396 4413.52520   218%  1311  330s
  2438  1730 2735.93262   14  390 -3739.6396 4270.46082   214%  1299  338s
  2585  1838 1841.01362   17  377 -3739.6396 4270.46082   214%  1314  345s
  2759  1924 -837.19920   23  265 -3739.6396 4270.46082   214%  1311  354s
  2981  1999 -2532.1429   38  220 -3739.6396 4270.46082   214%  1307  362s
  3202  2082     cutoff   49      -3739.6396 4150.80712   211%  1297  369s
  3395  2189 1706.66714    9  384 -3739.6396 3927.42532   205%  1308  377s
  3564  2256 -209.64803   13  347 -3739.6396 3927.42532   205%  1321  384s
  3722  2407 -2107.9481   18  274 -3739.6396 3927.42532   205%  1338  393s
  4001  2461 -1194.6924   10  418 -3739.6396 3866.42442   203%  1315  401s
  4229  2535 -2634.2010   13  310 -3739.6396 3825.89742   202%  1319  408s
  4431  2614     cutoff   13      -3739.6396 3825.89742   202%  1329  416s
  4684  2712 2506.64251   10  387 -3739.6396 3825.89742   202%  1326  425s
  4975  2836 1461.08279   12  410 -3739.6396 3825.89742   202%  1315  435s
  5261  2837 -736.38633   23  503 -3739.6396 3546.71035   195%  1308  466s
  5263  2838 -163.01768   16  272 -3739.6396 3546.71035   195%  1307  481s
  5264  2839  590.26957   14  449 -3739.6396 3546.71035   195%  1307  493s
  5265  2840 1488.22690   22  464 -3739.6396 3546.71035   195%  1307  502s
  5266  2840 1405.98600   16  487 -3739.6396 3546.71035   195%  1306  507s
  5267  2841 -1399.8225   36  462 -3739.6396 3546.71035   195%  1306  511s
  5268  2842  867.91755   23  518 -3739.6396 3546.71035   195%  1306  515s
  5271  2844 1552.90393   11  553 -3739.6396 3546.71035   195%  1305  521s
  5274  2846 -1020.9583   12  499 -3739.6396 3546.71035   195%  1304  525s
  5275  2846 2830.28907    8  482 -3739.6396 3546.71035   195%  1304  530s
  5280  2850 -3464.8026   24  496 -3739.6396 3546.71035   195%  1303  538s
  5282  2851 2689.61933   10  502 -3739.6396 3546.71035   195%  1302  540s
  5284  2852 -2152.5286   17  492 -3739.6396 3546.71035   195%  1302  546s
  5287  2854 -906.65999   13  514 -3739.6396 3546.71035   195%  1301  550s
  5288  2855 -2939.9874   31  564 -3739.6396 3546.71035   195%  1301  556s
  5290  2856 1202.16921    8  515 -3739.6396 3546.71035   195%  1301  560s
  5293  2858 -3035.1597   20  524 -3739.6396 3546.71035   195%  1300  565s
  5296  2860 -3224.2010   47  516 -3739.6396 3546.71035   195%  1299  585s
  5297  2861 -3452.6514   18  516 -3739.6396 3546.71035   195%  1299  605s
  5298  2865 3546.71035   14  496 -3739.6396 3546.71035   195%  1325  613s
  5300  2868 3546.71035   15  486 -3739.6396 3546.71035   195%  1326  621s
  5304  2875 3546.71035   16  529 -3739.6396 3546.71035   195%  1328  631s
  5312  2888 3546.71035   17  500 -3739.6396 3546.71035   195%  1333  639s
  5328  2905  928.02262   18  435 -3739.6396 3546.71035   195%  1361  653s
  5350  2929 1956.54966   19  451 -3739.6396 3546.71035   195%  1388  659s
  5382  3009 1869.14378   20  438 -3739.6396 3546.71035   195%  1409  667s
  5493  2998 1023.33535   23  436 -3739.6396 3546.71035   195%  1433  673s
  5568  2991  555.48305   22  353 -3739.6396 3546.71035   195%  1441  684s
  5643  2979 -1217.2330   24  205 -3739.6396 3546.71035   195%  1452  694s
  5727  2960 -1419.9759   23  178 -3739.6396 3546.71035   195%  1464  700s
  5793  2962 -2382.2548   24  163 -3739.6396 3546.71035   195%  1478  708s
  5830  2972 -2281.3850   24  168 -3739.6396 3546.71035   195%  1489  714s
  5874  2973     cutoff   25      -3739.6396 3546.71035   195%  1497  721s
  5929  2967     cutoff   26      -3739.6396 3546.71035   195%  1503  729s
  6002  2960  100.12125   23  455 -3739.6396 3546.71035   195%  1506  739s
  6073  2947 -1013.6082   24  325 -3739.6396 3546.71035   195%  1509  746s
  6121  2948 -3082.7315   25  135 -3739.6396 3546.71035   195%  1513  753s
  6169  2952     cutoff   26      -3739.6396 3546.71035   195%  1516  759s
  6219  2954 -2208.7861   26  351 -3739.6396 3546.71035   195%  1521  766s
  6277  2946 -3083.3350   27  326 -3739.6396 3546.71035   195%  1527  771s
  6345  2930 -3460.8699   29  244 -3739.6396 3546.71035   195%  1531  781s
  6417  2938 infeasible   30      -3739.6396 3543.14727   195%  1537  790s
  6481  2925  923.05287   22  511 -3739.6396 3542.02595   195%  1545  798s
  6571  2924 -356.29041   24  370 -3739.6396 3542.02595   195%  1546  805s
  6638  2913     cutoff   26      -3739.6396 3542.02595   195%  1555  813s
  6729  2919 -3160.6444   26  373 -3739.6396 3542.02595   195%  1565  821s
  6804  2897     cutoff   27      -3739.6396 3542.02595   195%  1574  829s
  6911  2894     cutoff   27      -3739.6396 3011.87223   181%  1580  836s
  7014  2874 -3053.3641   28  244 -3739.6396 2325.05977   162%  1584  845s
  7108  2869 -3559.4341   33  118 -3739.6396 2320.76439   162%  1589  853s
  7213  2867 -3050.4133   26  460 -3739.6396 2320.76439   162%  1596  862s
  7347  2873 -3452.7054   28  275 -3739.6396 2320.76439   162%  1602  873s
  7471  2877 -1862.6176   21  290 -3739.6396 2320.76439   162%  1599  883s
H 7552  2706                    -3301.331846 2320.76439   170%  1598  883s
  7641  2707     cutoff   24      -3301.3318 2320.76439   170%  1593  894s
  7826  2689 -1241.4617   23  391 -3301.3318 1358.03862   141%  1593  905s
  7978  2673     cutoff   26      -3301.3318 1124.74218   134%  1601  914s
H 8077  2503                    -3125.500284 1124.74218   136%  1600  914s
  8152  2438     cutoff   24      -3125.5003 1124.74218   136%  1603  925s
  8322  2388 -1138.9279   22  405 -3125.5003  383.72098   112%  1614  936s
  8491  2332 -2009.3715   26  310 -3125.5003  339.71868   111%  1624  948s
H 8500  2200                    -3062.491595  339.71868   111%  1624  948s
H 8510  2074                    -3039.575700  113.36167   104%  1625  948s
  8607  2040 -2159.8584   20   95 -3039.5757  113.36167   104%  1629  960s
  8855  1934     cutoff   30      -3039.5757  -81.68446  97.3%  1625  969s
  9039  1897 -2613.7390   29  110 -3039.5757 -212.83894  93.0%  1624  981s
  9273  1798     cutoff   23      -3039.5757 -296.94799  90.2%  1616  994s
  9613  1630 -1583.7309   22  398 -3039.5757 -352.99175  88.4%  1604 1005s
H 9614  1513                    -2992.336171 -352.99175  88.2%  1603 1005s
  9763  1314     cutoff   23      -2992.3362 -636.97769  78.7%  1599 1019s
 10216   917     cutoff   38      -2992.3362 -1139.8041  61.9%  1572 1028s
 11045  1004 -2940.0558   60   77 -2992.3362 -1914.8388  36.0%  1481 1036s
H11081   880                    -2977.841352 -1914.8388  35.7%  1476 1036s
H11600   709                    -2976.901091 -2491.0881  16.3%  1413 1036s
 13517  1734     cutoff   94      -2976.9011 -2800.4041  5.93%  1218 1040s
*18778  2773              90    -2973.182179 -2876.4684  3.25%   886 1044s
 19565  3162     cutoff   63      -2973.1822 -2896.5798  2.58%   852 1046s
 24768  3144 -2935.8983   66   33 -2973.1822 -2916.0888  1.92%   681 1050s
 32390  1952 -2964.6114   63   41 -2973.1822 -2949.2883  0.80%   529 1056s
 34537  1882 -2968.2094   70   30 -2973.1822 -2953.9414  0.65%   498 1061s
 36001   785 -2962.5801   86    8 -2973.1822 -2957.3467  0.53%   479 1066s
 38186    42 -2963.9419   71   22 -2973.1822 -2959.9270  0.45%   453 1070s

Cutting planes:
  MIR: 776
  Flow cover: 1411
  Zero half: 5
  RLT: 11
  Relax-and-lift: 35

Explored 38555 nodes (17465557 simplex iterations) in 1072.80 seconds (2996.51 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -2973.18 -2973.18 -2976.9 ... -3739.64
No other solutions better than -2973.18

Optimal solution found (tolerance 1.00e-04)
Best objective -2.973182178975e+03, best bound -2.973182178975e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1072.82s
  Master Objective (UB) = -2973.18, θ = 110857.46
  Upper Bound (UB) = -2973.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110857.46
  [DEBUG]   ✓ Scenario 0: θ = 110857.46 ≤ Q = 125280.55 (slack: 14423.09)
  [DEBUG]   ✓ Scenario 1: θ = 110857.46 ≤ Q = 110857.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110857.46 ≤ Q = 110857.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110857.46 ≤ Q = 110860.94 (slack: 3.48)
  [DEBUG]   ✓ Scenario 4: θ = 110857.46 ≤ Q = 124230.29 (slack: 13372.83)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2b494011
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2b494011
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.186669e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6248640.1947
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.159425e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115942.46    0  130 6248640.19 -115942.46   102%     -    0s
H    0     0                    -81946.69509 -115942.46  41.5%     -    0s
H    0     0                    -82384.79268 -115942.46  40.7%     -    0s
     0     0 -95969.597    0   38 -82384.793 -95969.597  16.5%     -    0s
H    0     0                    -95347.19604 -95959.690  0.64%     -    0s
     0     0 -95881.066    0   36 -95347.196 -95881.066  0.56%     -    0s
     0     0 -95875.081    0   36 -95347.196 -95875.081  0.55%     -    0s
     0     0 -95720.004    0    6 -95347.196 -95720.004  0.39%     -    0s
H    0     0                    -95630.02683 -95720.004  0.09%     -    0s
     0     0 -95664.407    0    5 -95630.027 -95664.407  0.04%     -    0s
     0     0 -95662.084    0    6 -95630.027 -95662.084  0.03%     -    0s
H    0     0                    -95641.38744 -95662.084  0.02%     -    0s

Cutting planes:
  Gomory: 22
  Implied bound: 2
  MIR: 107
  Flow cover: 2
  RLT: 41
  Relax-and-lift: 1
  BQP: 1

Explored 1 nodes (467 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -95641.4 -95630 -95347.2 ... 1.18667e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.564138744277e+04, best bound -9.564441670752e+04, gap 0.0032%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 100548.98
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95641.39
  [DEBUG]   S×d_nominal = 196190.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 196190.36 + -95641.39 = 100548.98
  [DEBUG]   Current θ from Master = 110857.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10308.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13281.66
  Lower Bound (LB) = -5684.99
  Gap (UB-LB) = 2711.8105, Absolute Gap = 2711.8105, Relative Gap = 0.912090
  Not converged yet (gap = 2711.81 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0x44c04add
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40662 rows and 16512 columns
Presolve time: 0.83s
Presolved: 52461 rows, 23188 columns, 325829 nonzeros
Variable types: 20929 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -359952.0065
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52461 rows, 23188 columns, 325829 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30260   -5.6311086e+03   0.000000e+00   7.794525e+06      5s
   43143    1.0748966e+04   0.000000e+00   7.794328e+05     10s
   53040    1.2884384e+04   0.000000e+00   2.092922e+08     15s
Concurrent spin time: 1.48s

Solved with dual simplex

Root relaxation: objective 1.833576e+04, 44727 iterations, 17.35 seconds (35.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 18335.7647    0  279 -210563.59 18335.7647   109%     -   18s
H    0     0                    -205237.3384 18335.7647   109%     -   18s
H    0     0                    -56715.17298 18335.7647   132%     -   18s
H    0     0                    -50531.42285 18335.7647   136%     -   18s
H    0     0                    -36961.20631 18335.7647   150%     -   18s
H    0     0                    -36700.70276 18335.7647   150%     -   18s
H    0     0                    -24337.78115 18335.7647   175%     -   18s
H    0     0                    -4432.006797 18335.7647   514%     -   18s
H    0     0                    -4077.226598 18335.7647   550%     -   19s
H    0     0                    -4047.813919 18335.7647   553%     -   20s
H    0     0                    -3992.458623 14172.0494   455%     -   26s
H    0     0                    -3898.772721 14172.0494   464%     -   26s
H    0     0                    -3795.819449 14172.0494   473%     -   26s
     0     0 14163.1593    0  319 -3795.8194 14163.1593   473%     -   26s
     0     0 13215.7113    0  348 -3795.8194 13215.7113   448%     -   31s
     0     0 12698.9744    0  353 -3795.8194 12698.9744   435%     -   33s
H    0     0                    -3791.706075 12698.9744   435%     -   35s
     0     0 12658.7592    0  358 -3791.7061 12658.7592   434%     -   36s
     0     0 12658.7592    0  364 -3791.7061 12658.7592   434%     -   36s
     0     0 12658.7592    0  365 -3791.7061 12658.7592   434%     -   37s
     0     0 12658.4654    0  368 -3791.7061 12658.4654   434%     -   37s
     0     0 12658.2935    0  371 -3791.7061 12658.2935   434%     -   37s
H    0     0                    -3789.825648 11097.3664   393%     -   44s
H    0     0                    -3772.014000 11097.3664   394%     -   44s
     0     0 11079.6809    0  453 -3772.0140 11079.6809   394%     -   44s
     0     0 10325.4855    0  438 -3772.0140 10325.4855   374%     -   49s
     0     0 10027.0855    0  450 -3772.0140 10027.0855   366%     -   51s
     0     0 9963.66567    0  454 -3772.0140 9963.66567   364%     -   52s
H    0     0                    -3764.640596 9820.01737   361%     -   53s
     0     0 9820.01737    0  457 -3764.6406 9820.01737   361%     -   53s
     0     0 9424.57646    0  449 -3764.6406 9424.57646   350%     -   56s
     0     0 9394.85449    0  460 -3764.6406 9394.85449   350%     -   57s
     0     0 9377.05005    0  458 -3764.6406 9377.05005   349%     -   57s
     0     0 9373.32939    0  453 -3764.6406 9373.32939   349%     -   57s
     0     0 9362.02022    0  457 -3764.6406 9362.02022   349%     -   57s
     0     0 9361.78311    0  459 -3764.6406 9361.78311   349%     -   58s
     0     0 8157.25096    0  427 -3764.6406 8157.25096   317%     -   69s
     0     0 7591.60574    0  421 -3764.6406 7591.60574   302%     -   74s
     0     0 7456.65856    0  436 -3764.6406 7456.65856   298%     -   78s
     0     0 7351.11730    0  409 -3764.6406 7351.11730   295%     -   81s
     0     0 7167.25201    0  465 -3764.6406 7167.25201   290%     -   84s
     0     0 7000.60913    0  478 -3764.6406 7000.60913   286%     -   87s
     0     0 6954.43058    0  489 -3764.6406 6954.43058   285%     -   89s
     0     0 6901.67279    0  482 -3764.6406 6901.67279   283%     -   90s
     0     0 6773.12162    0  432 -3764.6406 6773.12162   280%     -   93s
     0     0 6744.98309    0  434 -3764.6406 6744.98309   279%     -   94s
     0     0 6741.74703    0  429 -3764.6406 6741.74703   279%     -   94s
     0     0 6736.56950    0  433 -3764.6406 6736.56950   279%     -   94s
     0     0 6734.94903    0  435 -3764.6406 6734.94903   279%     -   95s
     0     0 6734.51856    0  432 -3764.6406 6734.51856   279%     -   95s
     0     0 6278.48310    0  442 -3764.6406 6278.48310   267%     -  103s
     0     0 6131.42165    0  525 -3764.6406 6131.42165   263%     -  107s
     0     0 6100.48183    0  456 -3764.6406 6100.48183   262%     -  109s
     0     0 6066.06749    0  466 -3764.6406 6066.06749   261%     -  111s
     0     0 6048.07674    0  461 -3764.6406 6048.07674   261%     -  112s
     0     0 6035.11149    0  469 -3764.6406 6035.11149   260%     -  112s
     0     0 6030.88236    0  458 -3764.6406 6030.88236   260%     -  113s
     0     0 6028.51658    0  464 -3764.6406 6028.51658   260%     -  113s
     0     0 6027.09165    0  464 -3764.6406 6027.09165   260%     -  114s
     0     0 5952.38368    0  457 -3764.6406 5952.38368   258%     -  118s
     0     0 5918.58683    0  456 -3764.6406 5918.58683   257%     -  120s
     0     0 5910.44182    0  583 -3764.6406 5910.44182   257%     -  122s
     0     0 5890.53307    0  453 -3764.6406 5890.53307   256%     -  123s
     0     0 5881.87543    0  522 -3764.6406 5881.87543   256%     -  124s
     0     0 5880.22726    0  525 -3764.6406 5880.22726   256%     -  124s
     0     0 5878.60564    0  526 -3764.6406 5878.60564   256%     -  124s
     0     0 5878.34141    0  527 -3764.6406 5878.34141   256%     -  124s
     0     0 5821.97864    0  458 -3764.6406 5821.97864   255%     -  127s
     0     0 5803.08368    0  456 -3764.6406 5803.08368   254%     -  130s
     0     0 5795.00434    0  464 -3764.6406 5795.00434   254%     -  131s
     0     0 5793.49916    0  469 -3764.6406 5793.49916   254%     -  132s
     0     0 5753.49059    0  468 -3764.6406 5753.49059   253%     -  134s
     0     0 5740.59018    0  468 -3764.6406 5740.59018   252%     -  135s
     0     0 5737.88526    0  478 -3764.6406 5737.88526   252%     -  136s
     0     0 5730.75892    0  473 -3764.6406 5730.75892   252%     -  136s
     0     0 5728.71109    0  474 -3764.6406 5728.71109   252%     -  137s
     0     0 5727.99325    0  475 -3764.6406 5727.99325   252%     -  137s
     0     0 5709.56023    0  477 -3764.6406 5709.56023   252%     -  139s
     0     0 5704.16306    0  472 -3764.6406 5704.16306   252%     -  144s
     0     0 5700.16649    0  463 -3764.6406 5700.16649   251%     -  144s
     0     0 5697.91900    0  473 -3764.6406 5697.91900   251%     -  145s
     0     0 5697.60341    0  468 -3764.6406 5697.60341   251%     -  145s
     0     0 5685.08197    0  476 -3764.6406 5685.08197   251%     -  147s
     0     0 5683.09210    0  479 -3764.6406 5683.09210   251%     -  148s
     0     0 5682.80013    0  478 -3764.6406 5682.80013   251%     -  148s
     0     0 5668.19660    0  480 -3764.6406 5668.19660   251%     -  150s
     0     0 5665.23625    0  534 -3764.6406 5665.23625   250%     -  151s
     0     0 5664.97230    0  534 -3764.6406 5664.97230   250%     -  151s
     0     0 5662.32333    0  488 -3764.6406 5662.32333   250%     -  152s
     0     0 5662.14444    0  488 -3764.6406 5662.14444   250%     -  153s
     0     0 5660.16458    0  528 -3764.6406 5660.16458   250%     -  153s
     0     0 5659.78194    0  483 -3764.6406 5659.78194   250%     -  154s
     0     0 5657.87177    0  483 -3764.6406 5657.87177   250%     -  155s
     0     0 5657.74649    0  483 -3764.6406 5657.74649   250%     -  156s
     0     2 5657.64878    0  483 -3764.6406 5657.64878   250%     -  182s
     3     8 5619.94246    2  543 -3764.6406 5639.72884   250%  1701  188s
     7    16 5333.51523    3  580 -3764.6406 5619.73153   249%  3282  194s
    15    32 5068.91027    4  524 -3764.6406 5333.26784   242%  4664  199s
    31    50 2905.46906    5  432 -3764.6406 5068.63004   235%  7267  212s
    49    82 3262.79657    6  425 -3764.6406 5067.88448   235%  6720  220s
    81   126 2373.64611    7  352 -3764.6406 5067.88448   235%  5697  229s
   125   252 2149.81779    8  355 -3764.6406 5067.88448   235%  4462  239s
   251   351 2147.05657    9  359 -3764.6406 5067.88448   235%  3270  244s
   350   432 1365.54901   10  356 -3764.6406 5067.88448   235%  2888  251s
   433   487 1404.09111    9  286 -3764.6406 5067.88448   235%  2662  258s
   526   523  776.34286   10  238 -3764.6406 5067.88448   235%  2456  265s
   601   559 1154.80683   11  347 -3764.6406 5067.88448   235%  2355  272s
   665   579  510.59950   11  274 -3764.6406 5067.88448   235%  2317  279s
   705   609 1660.24318   11  349 -3764.6406 5067.88448   235%  2287  286s
   755   624 1779.81816   11  355 -3764.6406 5067.88448   235%  2269  294s
   799   651  931.85038   12  349 -3764.6406 5067.88448   235%  2268  300s
   840   676  255.04259   12  348 -3764.6406 5067.88448   235%  2297  307s
   887   696  246.17643   12  292 -3764.6406 5067.88448   235%  2303  316s
   949   724  786.15331   12  337 -3764.6406 5067.88448   235%  2280  323s
  1005   754 -133.24812   13  252 -3764.6406 5067.88448   235%  2273  328s
  1059   787 -955.89232   14  248 -3764.6406 5067.88448   235%  2262  335s
  1116   805 -2327.8175   14  233 -3764.6406 4897.06716   230%  2256  343s
  1172   845 -2241.4431   14  313 -3764.6406 4896.73883   230%  2257  350s
  1230   879 -1339.4231   15  246 -3764.6406 4896.73883   230%  2257  357s
  1297   905     cutoff   16      -3764.6406 4896.73883   230%  2236  365s
  1381   951 -2772.8760   16  238 -3764.6406 4385.70108   216%  2208  374s
  1469  1012 -3517.7491   20  184 -3764.6406 4385.70108   216%  2183  382s
  1582  1075 -2590.2640   10  432 -3764.6406 4385.70108   216%  2130  390s
  1701  1127 -2654.0920   11  423 -3764.6406 4385.70108   216%  2076  400s
  1826  1197 infeasible   14      -3764.6406 4385.70108   216%  2028  409s
  1970  1276  984.88533   10  228 -3764.6406 4385.70108   216%  1988  418s
  2127  1323 -3228.3002   14  158 -3764.6406 4385.70108   216%  1944  430s
  2279  1375 -538.38348   13  433 -3764.6406 4100.60556   209%  1911  440s
  2412  1452 -2040.8976   15  237 -3764.6406 3920.19430   204%  1913  449s
  2571  1496 -2705.1412   17  328 -3764.6406 3792.02439   201%  1892  460s
  2750  1545     cutoff   25      -3764.6406 3792.02439   201%  1869  470s
  2907  1614 -1045.2953    8  389 -3764.6406 3480.90703   192%  1874  480s
  3056  1682 infeasible   11      -3764.6406 3480.90703   192%  1881  490s
  3250  1741 infeasible   11      -3764.6406 3271.80499   187%  1867  503s
  3427  1807 2455.15992    7  456 -3764.6406 3245.18478   186%  1871  514s
  3599  1911  906.16441    8  402 -3764.6406 3132.13313   183%  1880  526s
  3822  1973 -242.97723   10  389 -3764.6406 3103.87409   182%  1865  537s
  3984  1999 -918.13826   11  279 -3764.6406 3103.87409   182%  1842  549s
  4028  2041 -1721.8550   12  354 -3764.6406 3103.87409   182%  1852  559s
  4094  2106     cutoff   13      -3764.6406 3103.87409   182%  1857  569s
  4217  2247 -2473.8518   14  396 -3764.6406 3103.87409   182%  1860  581s
  4529  2366 -2838.3685   15  308 -3764.6406 3103.87409   182%  1809  597s
  4839  2367 -2117.9759   11  483 -3764.6406 2973.18206   179%  1773  670s
  4841  2368 -1045.7822   26  279 -3764.6406 2973.18206   179%  1772  694s
  4842  2369 2371.74885   10  508 -3764.6406 2973.18206   179%  1772  714s
  4843  2370  791.85188   12  564 -3764.6406 2973.18206   179%  1771  729s
  4844  2370 1956.56742   15  524 -3764.6406 2973.18206   179%  1771  738s
  4845  2371  708.23695    9  499 -3764.6406 2973.18206   179%  1771  748s
  4846  2372 -897.78907   32  459 -3764.6406 2973.18206   179%  1770  755s
  4847  2372 2006.53849   18  523 -3764.6406 2973.18206   179%  1770  764s
  4848  2373 -1414.9783   31  466 -3764.6406 2973.18206   179%  1770  769s
  4849  2374 -3159.1798   23  458 -3764.6406 2973.18206   179%  1769  772s
  4851  2375 1957.76206    9  452 -3764.6406 2973.18206   179%  1768  775s
  4853  2376 1761.62222    9  467 -3764.6406 2973.18206   179%  1768  780s
  4855  2378 -3477.1818   33  526 -3764.6406 2973.18206   179%  1767  789s
  4856  2378  936.93196   16  538 -3764.6406 2973.18206   179%  1767  792s
  4857  2379 1169.06016   15  533 -3764.6406 2973.18206   179%  1766  795s
  4860  2381 -2188.8277   55  473 -3764.6406 2973.18206   179%  1765  802s
  4862  2382 -242.98962   12  467 -3764.6406 2973.18206   179%  1764  805s
  4864  2384 -2073.2866   12  482 -3764.6406 2973.18206   179%  1764  811s
  4865  2384 -755.21176   13  537 -3764.6406 2973.18206   179%  1763  818s
  4867  2386  712.80938   22  493 -3764.6406 2973.18206   179%  1763  822s
  4868  2386 -3708.3773   21  472 -3764.6406 2973.18206   179%  1762  828s
  4869  2387 -2793.6375   24  540 -3764.6406 2973.18206   179%  1762  830s
  4871  2388 1080.48543   12  533 -3764.6406 2973.18206   179%  1761  836s
  4872  2389 -709.35071   22  545 -3764.6406 2973.18206   179%  1761  840s
  4874  2390 -3274.5155   18  501 -3764.6406 2973.18206   179%  1760  866s
  4875  2391 -755.23799   21  501 -3764.6406 2973.18206   179%  1760  885s
  4876  2395 2973.18206   14  529 -3764.6406 2973.18206   179%  1800  897s
  4878  2398 2973.18206   15  518 -3764.6406 2973.18206   179%  1801  904s
  4882  2405 2973.18206   16  468 -3764.6406 2973.18206   179%  1805  913s
  4890  2418 2973.18206   17  523 -3764.6406 2973.18206   179%  1808  923s
  4906  2433 1424.94862   18  326 -3764.6406 2973.18206   179%  1841  947s
  4926  2458 2052.86290   19  439 -3764.6406 2973.18206   179%  1860  956s
  4958  2554 1851.74491   20  420 -3764.6406 2973.18206   179%  1887  968s
  5069  2563 1605.74921   24  449 -3764.6406 2973.18206   179%  1905  976s
  5156  2551  945.17075   26  401 -3764.6406 2973.18206   179%  1909  985s
  5199  2550  156.22552   25  438 -3764.6406 2973.18206   179%  1917  995s
  5265  2545  617.35701   27  431 -3764.6406 2973.18206   179%  1919 1007s
  5303  2536  620.77121   27  385 -3764.6406 2973.18206   179%  1924 1017s
  5358  2539 -505.53473   28  280 -3764.6406 2973.18206   179%  1930 1025s
  5400  2540 -443.92750   28  234 -3764.6406 2973.18206   179%  1933 1036s
  5456  2545 -665.86539   27  439 -3764.6406 2973.18206   179%  1938 1045s
  5521  2538  578.14977   28  359 -3764.6406 2973.18206   179%  1945 1054s
  5591  2547  306.35067   30  374 -3764.6406 2973.18206   179%  1948 1062s
  5649  2553  354.62586   30  295 -3764.6406 2973.18206   179%  1956 1071s
  5722  2548 -870.53826   33  327 -3764.6406 2973.18206   179%  1959 1077s
  5762  2560 -1080.2345   34  340 -3764.6406 2973.18206   179%  1961 1086s
  5804  2570 -1081.9435   35  276 -3764.6406 2973.18206   179%  1966 1093s
  5849  2573 -3506.8316   36  239 -3764.6406 2973.18206   179%  1972 1101s
  5893  2579 -2803.6477   36  137 -3764.6406 2973.18206   179%  1976 1110s
  5937  2573     cutoff   34      -3764.6406 2973.18206   179%  1978 1118s
  5993  2579 -2933.3743   38  195 -3764.6406 2973.18206   179%  1979 1129s
  6044  2579 -2971.6621   39  151 -3764.6406 2973.18206   179%  1982 1138s
  6113  2584     cutoff   37      -3764.6406 2973.18206   179%  1983 1146s
  6182  2594 -3701.3603   45  160 -3764.6406 2973.18206   179%  1985 1157s
  6255  2592 2352.34750   20  426 -3764.6406 2973.18206   179%  1988 1168s
  6342  2579 1790.84434   21  445 -3764.6406 2973.18206   179%  1992 1179s
  6439  2577 1679.48149   22  494 -3764.6406 2973.18206   179%  1995 1189s
  6553  2560 -1642.8469   24  349 -3764.6406 2973.18206   179%  1999 1198s
  6603  2550 -1874.6023   25  343 -3764.6406 2973.18206   179%  2003 1210s
  6696  2545 -2320.5881   26  261 -3764.6406 2973.18206   179%  2007 1222s
  6811  2534 -3704.4539   28  344 -3764.6406 2501.37725   166%  2011 1236s
  6955  2539 -509.61937   21  384 -3764.6406 1742.09257   146%  2014 1249s
  7083  2507 -2175.2415   25  262 -3764.6406 1742.09257   146%  2025 1263s
  7240  2501     cutoff   26      -3764.6406 1742.09257   146%  2027 1276s
  7404  2478 -2786.7056   22  509 -3764.6406 1562.02878   141%  2029 1289s
  7489  2499 -2830.0670   23  498 -3764.6406 1562.02878   141%  2031 1305s
  7639  2513     cutoff   25      -3764.6406 1562.02878   141%  2032 1319s
  7802  2527 -2218.3347   25  352 -3764.6406 1562.02878   141%  2038 1335s
  8039  2489     cutoff   27      -3764.6406 1007.91535   127%  2027 1349s
* 8057  2362             116    -3747.050063 1007.91535   127%  2026 1349s
* 8226  2192             117    -3665.281902  804.39276   122%  2020 1350s
  8315  2167 -2317.8246   22  394 -3665.2819  804.39276   122%  2015 1367s
  8503  2129 -3469.6576   22  322 -3665.2819  603.99027   116%  2026 1384s
  8711  2086 -2921.2542   24  323 -3665.2819  369.32307   110%  2036 1400s
  8945  2033     cutoff   26      -3665.2819  284.30749   108%  2037 1419s
  9194  1968     cutoff   25      -3665.2819  210.91364   106%  2041 1438s
H 9462  1805                    -3433.593466  177.40536   105%  2045 1456s
H 9504  1688                    -3408.549292  177.40536   105%  2042 1456s
H 9506  1589                    -3349.206826  177.40536   105%  2043 1456s
H 9514  1494                    -3179.249456  177.40536   106%  2043 1456s
  9678  1399     cutoff   24      -3179.2495  -71.83734  97.7%  2037 1475s
 10011  1232     cutoff   24      -3179.2495 -108.49124  96.6%  2032 1494s
 10313  1126     cutoff   25      -3179.2495 -448.38714  85.9%  2036 1514s
 10637  1068     cutoff   25      -3179.2495 -599.73191  81.1%  2039 1534s
 10982   957 -2945.3341   33  137 -3179.2495 -904.13346  71.6%  2042 1557s
 11317   753 -3064.5503   24  324 -3179.2495 -1215.4607  61.8%  2048 1577s
 11811   519     cutoff   34      -3179.2495 -1504.6200  52.7%  2028 1596s
 12814  1091 infeasible   31      -3179.2495 -2162.6803  32.0%  1912 1609s
 14413  2046     cutoff   79      -3179.2495 -2826.8406  11.1%  1715 1611s
H14940  2046                    -3175.483599 -2826.8406  11.0%  1657 1611s
H15297  2046                    -3159.340520 -2862.4019  9.40%  1619 1611s
H16397  2740                    -3066.556334 -2862.6798  6.65%  1514 1614s
 18637  1643     cutoff  120      -3066.5563 -2975.2305  2.98%  1338 1619s
*19140  1643             102    -3064.995994 -2983.1767  2.67%  1304 1619s
*19616  1643             111    -3063.786443 -2988.5328  2.46%  1273 1619s
 20693  1823 -3053.9691   80   26 -3063.7864 -2998.5238  2.13%  1208 1622s
*21648  1823             106    -3058.527928 -3011.2893  1.54%  1156 1622s
*23208  1823             116    -3058.206941 -3015.3854  1.40%  1081 1622s
 23850  1011     cutoff   94      -3058.2069 -3028.3541  0.98%  1052 1625s
*23963  1011             109    -3053.867981 -3028.3541  0.84%  1048 1625s
*24088  1011             118    -3053.463559 -3029.3363  0.79%  1042 1625s
*24508  1011             108    -3050.880951 -3029.3604  0.71%  1025 1625s
*25363  1011             107    -3045.657736 -3029.4483  0.53%   991 1625s

Cutting planes:
  MIR: 867
  Flow cover: 1610
  Zero half: 11
  RLT: 20
  Relax-and-lift: 69

Explored 28214 nodes (25415186 simplex iterations) in 1626.73 seconds (4436.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3045.66 -3050.88 -3053.46 ... -3159.34
No other solutions better than -3045.66

Optimal solution found (tolerance 1.00e-04)
Best objective -3.045657736308e+03, best bound -3.045657736308e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1626.75s
  Master Objective (UB) = -3045.66, θ = 110908.64
  Upper Bound (UB) = -3045.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110908.64
  [DEBUG]   ✓ Scenario 0: θ = 110908.64 ≤ Q = 110908.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110908.64 ≤ Q = 110908.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110908.64 ≤ Q = 110908.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110908.64 ≤ Q = 110908.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110908.64 ≤ Q = 110908.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110908.64 ≤ Q = 110908.64 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x26c70fe3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd938f01d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-15, 2e+02]
Found heuristic solution: objective 1.183564e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6214466.5446
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.152236e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115223.61    0  122 6214466.54 -115223.61   102%     -    0s
H    0     0                    -82529.05431 -115223.61  39.6%     -    0s
H    0     0                    -82979.37526 -115223.61  38.9%     -    0s
     0     0 -88565.157    0   69 -82979.375 -88565.157  6.73%     -    0s
H    0     0                    -86145.91474 -88509.277  2.74%     -    0s
H    0     0                    -86450.83664 -88509.277  2.38%     -    0s
H    0     0                    -86729.75608 -88509.277  2.05%     -    0s
H    0     0                    -87034.67798 -88509.277  1.69%     -    0s
     0     0 -88258.142    0   70 -87034.678 -88258.142  1.41%     -    0s
H    0     0                    -87037.32443 -88194.727  1.33%     -    0s
H    0     0                    -87325.11604 -88194.727  1.00%     -    0s
     0     0 -87997.602    0   64 -87325.116 -87997.602  0.77%     -    0s
H    0     0                    -87331.91847 -87988.096  0.75%     -    0s
H    0     0                    -87473.88838 -87988.096  0.59%     -    0s
     0     0 -87987.080    0   64 -87473.888 -87987.080  0.59%     -    0s
     0     0 -87801.635    0    9 -87473.888 -87801.635  0.37%     -    0s
H    0     0                    -87615.31644 -87793.534  0.20%     -    0s
     0     0 -87742.303    0   14 -87615.316 -87742.303  0.14%     -    0s
     0     0 -87726.056    0   10 -87615.316 -87726.056  0.13%     -    0s
     0     0 -87723.273    0    6 -87615.316 -87723.273  0.12%     -    0s
     0     0 -87722.205    0    7 -87615.316 -87722.205  0.12%     -    0s
     0     0 -87701.027    0    4 -87615.316 -87701.027  0.10%     -    0s
H    0     0                    -87644.56826 -87700.476  0.06%     -    0s
     0     0 -87700.476    0    4 -87644.568 -87700.476  0.06%     -    0s
     0     0 -87700.476    0   47 -87644.568 -87700.476  0.06%     -    0s
H    0     0                    -87668.34730 -87700.476  0.04%     -    0s
     0     0 -87700.476    0   39 -87668.347 -87700.476  0.04%     -    0s
     0     0 -87700.476    0   32 -87668.347 -87700.476  0.04%     -    0s
*    0     0               0    -87694.06374 -87694.064  0.00%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 3
  MIR: 57
  Flow cover: 1

Explored 1 nodes (721 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -87694.1 -87668.3 -87644.6 ... -86729.8
No other solutions better than -87694.1

Optimal solution found (tolerance 1.00e-04)
Best objective -8.769406373569e+04, best bound -8.769406373569e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 108573.54
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87694.06
  [DEBUG]   S×d_nominal = 196267.61
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 196267.61 + -87694.06 = 108573.54
  [DEBUG]   Current θ from Master = 110908.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2335.10 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5380.76
  Lower Bound (LB) = -5380.76
  Gap (UB-LB) = 2335.1001, Absolute Gap = 2335.1001, Relative Gap = 0.766698
  Not converged yet (gap = 2335.10 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308199 nonzeros
Model fingerprint: 0x6b8fdd55
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47449 rows and 19269 columns
Presolve time: 1.03s
Presolved: 60964 rows, 26671 columns, 379184 nonzeros
Variable types: 24412 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -359952.0065
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60964 rows, 26671 columns, 379184 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32175   -1.6870926e+03   0.000000e+00   2.844331e+07      5s
   42102    3.1762420e+03   0.000000e+00   2.365944e+06     10s
   50912    5.6361687e+03   0.000000e+00   1.129182e+07     15s
   58694    1.1262016e+04   0.000000e+00   1.591618e+06     20s
   65290    1.4274463e+04   0.000000e+00   1.177811e+06     25s
Concurrent spin time: 0.91s

Solved with dual simplex

Root relaxation: objective 1.833576e+04, 51530 iterations, 25.42 seconds (48.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 18335.7647    0  279 -210563.59 18335.7647   109%     -   27s
H    0     0                    -203854.3630 18335.7647   109%     -   27s
H    0     0                    -57862.69861 18335.7647   132%     -   27s
H    0     0                    -36700.70276 18335.7647   150%     -   27s
H    0     0                    -24337.78115 18335.7647   175%     -   27s
H    0     0                    -11747.24120 18335.7647   256%     -   27s
H    0     0                    -5440.350246 18335.7647   437%     -   27s
H    0     0                    -5107.344209 18335.7647   459%     -   27s
H    0     0                    -4077.226598 18335.7647   550%     -   27s
H    0     0                    -4047.813919 18335.7647   553%     -   28s
H    0     0                    -4013.172771 14056.2617   450%     -   37s
H    0     0                    -3987.172837 14056.2617   453%     -   37s
H    0     0                    -3890.584434 14056.2617   461%     -   37s
     0     0 14056.2617    0  311 -3890.5844 14056.2617   461%     -   37s
     0     0 13069.5056    0  351 -3890.5844 13069.5056   436%     -   43s
     0     0 12936.7959    0  359 -3890.5844 12936.7959   433%     -   46s
     0     0 12936.7959    0  366 -3890.5844 12936.7959   433%     -   49s
     0     0 12936.7959    0  352 -3890.5844 12936.7959   433%     -   52s
H    0     0                    -3883.211030 12936.7959   433%     -   55s
     0     0 11156.3910    0  363 -3883.2110 11156.3910   387%     -   55s
     0     0 11155.7945    0  355 -3883.2110 11155.7945   387%     -   56s
     0     0 11155.7945    0  355 -3883.2110 11155.7945   387%     -   56s
     0     0 11155.7945    0  447 -3883.2110 11155.7945   387%     -   67s
H    0     0                    -3861.286008 11155.7945   389%     -   67s
     0     0 10616.6905    0  439 -3861.2860 10616.6905   375%     -   75s
     0     0 10372.0365    0  454 -3861.2860 10372.0365   369%     -   79s
     0     0 10315.1240    0  461 -3861.2860 10315.1240   367%     -   81s
     0     0 10166.2881    0  461 -3861.2860 10166.2881   363%     -   85s
     0     0 9993.62412    0  449 -3861.2860 9993.62412   359%     -   88s
H    0     0                    -3859.405581 9867.45501   356%     -   90s
     0     0 9867.45501    0  456 -3859.4056 9867.45501   356%     -   90s
     0     0 9829.22142    0  451 -3859.4056 9829.22142   355%     -   92s
     0     0 9796.22511    0  454 -3859.4056 9796.22511   354%     -   93s
     0     0 9790.78300    0  455 -3859.4056 9790.78300   354%     -   93s
     0     0 9790.71750    0  460 -3859.4056 9790.71750   354%     -   93s
H    0     0                    -3782.452243 8191.17381   317%     -  110s
     0     0 8191.17381    0  431 -3782.4522 8191.17381   317%     -  110s
H    0     0                    -3764.640596 8190.99695   318%     -  110s
     0     0 7301.58672    0  476 -3764.6406 7301.58672   294%     -  119s
     0     0 6986.40630    0  437 -3764.6406 6986.40630   286%     -  127s
     0     0 6872.66926    0  489 -3764.6406 6872.66926   283%     -  131s
     0     0 6737.98291    0  450 -3764.6406 6737.98291   279%     -  135s
     0     0 6627.97245    0  434 -3764.6406 6627.97245   276%     -  138s
     0     0 6597.37312    0  447 -3764.6406 6597.37312   275%     -  139s
     0     0 6586.73148    0  448 -3764.6406 6586.73148   275%     -  140s
     0     0 6555.18024    0  457 -3764.6406 6555.18024   274%     -  142s
     0     0 6535.22008    0  457 -3764.6406 6535.22008   274%     -  144s
     0     0 6533.83154    0  459 -3764.6406 6533.83154   274%     -  145s
     0     0 6528.68728    0  460 -3764.6406 6528.68728   273%     -  145s
     0     0 6524.15671    0  461 -3764.6406 6524.15671   273%     -  145s
     0     0 6523.62577    0  457 -3764.6406 6523.62577   273%     -  146s
     0     0 6046.73806    0  484 -3764.6406 6046.73806   261%     -  160s
     0     0 5860.37623    0  479 -3764.6406 5860.37623   256%     -  166s
     0     0 5806.59630    0  481 -3764.6406 5806.59630   254%     -  169s
     0     0 5777.98012    0  487 -3764.6406 5777.98012   253%     -  172s
     0     0 5760.18427    0  486 -3764.6406 5760.18427   253%     -  175s
     0     0 5751.79470    0  487 -3764.6406 5751.79470   253%     -  176s
     0     0 5739.15622    0  487 -3764.6406 5739.15622   252%     -  178s
     0     0 5732.68718    0  479 -3764.6406 5732.68718   252%     -  179s
     0     0 5729.34802    0  477 -3764.6406 5729.34802   252%     -  180s
     0     0 5728.32582    0  485 -3764.6406 5728.32582   252%     -  181s
     0     0 5678.81761    0  479 -3764.6406 5678.81761   251%     -  185s
     0     0 5668.31856    0  492 -3764.6406 5668.31856   251%     -  186s
     0     0 5616.21831    0  496 -3764.6406 5616.21831   249%     -  188s
     0     0 5609.72645    0  488 -3764.6406 5609.72645   249%     -  189s
     0     0 5585.43571    0  493 -3764.6406 5585.43571   248%     -  192s
     0     0 5575.47672    0  497 -3764.6406 5575.47672   248%     -  193s
     0     0 5573.80998    0  500 -3764.6406 5573.80998   248%     -  194s
     0     0 5572.21963    0  499 -3764.6406 5572.21963   248%     -  194s
     0     0 5517.60449    0  492 -3764.6406 5517.60449   247%     -  198s
     0     0 5500.99958    0  497 -3764.6406 5500.99958   246%     -  204s
     0     0 5491.92840    0  499 -3764.6406 5491.92840   246%     -  205s
     0     0 5488.10130    0  506 -3764.6406 5488.10130   246%     -  205s
     0     0 5486.59090    0  508 -3764.6406 5486.59090   246%     -  206s
     0     0 5466.78826    0  499 -3764.6406 5466.78826   245%     -  208s
     0     0 5461.66110    0  507 -3764.6406 5461.66110   245%     -  209s
     0     0 5459.89439    0  510 -3764.6406 5459.89439   245%     -  210s
     0     0 5455.18396    0  504 -3764.6406 5455.18396   245%     -  211s
     0     0 5453.18533    0  506 -3764.6406 5453.18533   245%     -  211s
     0     0 5452.38490    0  507 -3764.6406 5452.38490   245%     -  212s
     0     0 5441.14495    0  504 -3764.6406 5441.14495   245%     -  214s
     0     0 5433.49485    0  516 -3764.6406 5433.49485   244%     -  217s
     0     0 5431.94725    0  515 -3764.6406 5431.94725   244%     -  217s
     0     0 5417.89636    0  517 -3764.6406 5417.89636   244%     -  219s
     0     0 5416.35852    0  523 -3764.6406 5416.35852   244%     -  220s
     0     0 5414.21009    0  516 -3764.6406 5414.21009   244%     -  221s
     0     0 5412.75785    0  518 -3764.6406 5412.75785   244%     -  223s
     0     0 5410.64783    0  521 -3764.6406 5410.64783   244%     -  224s
     0     0 5408.96815    0  518 -3764.6406 5408.96815   244%     -  225s
     0     0 5407.37110    0  517 -3764.6406 5407.37110   244%     -  226s
     0     0 5407.31637    0  517 -3764.6406 5407.31637   244%     -  228s
     0     2 5407.26300    0  517 -3764.6406 5407.26300   244%     -  271s
     1     4 5385.80470    1  508 -3764.6406 5406.45386   244%  1055  275s
     3     8 5330.62150    2  500 -3764.6406 5385.12899   243%  2492  281s
     7    16 4952.73394    3  490 -3764.6406 5330.58405   242%  3913  288s
    15    32 4946.10383    4  490 -3764.6406 4951.85560   232%  4630  298s
    31    50 1871.59468    5  406 -3764.6406 4946.06513   231%  7316  312s
    49    82 3863.79185    6  448 -3764.6406 4946.06513   231%  8147  320s
    81   147 3760.16346    7  453 -3764.6406 4946.06513   231%  6744  330s
   154   255 3173.18603   10  403 -3764.6406 4946.06513   231%  4473  338s
   266   286 3653.60913    9  446 -3764.6406 4946.06513   231%  3476  341s
   307   325 3057.66220   11  408 -3764.6406 4946.06513   231%  3233  346s
   349   362 3167.69500   11  439 -3764.6406 4946.06513   231%  3317  353s
   392   404 1603.57505   11  390 -3764.6406 4946.06513   231%  3186  361s
   454   433 1352.65759   11  369 -3764.6406 4946.06513   231%  2976  368s
   489   460 3427.75126   10  426 -3764.6406 4946.06513   231%  3018  376s
   528   490 3371.00865   10  440 -3764.6406 4946.06513   231%  2989  385s
   570   507 2962.33825   12  417 -3764.6406 4946.06513   231%  3089  393s
   625   537 1383.02923   12  361 -3764.6406 4946.06513   231%  3108  400s
   669   567 3045.21026   12  446 -3764.6406 4946.06513   231%  3202  408s
   717   596 3077.45832   12  431 -3764.6406 4946.06513   231%  3258  414s
   764   624 2019.35374   13  394 -3764.6406 4946.06513   231%  3348  422s
   814   663  653.74159   12  346 -3764.6406 4946.06513   231%  3342  430s
   869   704   14.16532   12  337 -3764.6406 4946.06513   231%  3376  438s
   928   739  609.69419   14  318 -3764.6406 4946.06513   231%  3371  446s
   999   774  891.09270   14  348 -3764.6406 4946.06513   231%  3349  455s
  1068   818  668.21647   13  362 -3764.6406 4946.06513   231%  3296  463s
  1136   883  162.37328   13  323 -3764.6406 4946.06513   231%  3303  472s
  1237   926 -1447.3551   15  313 -3764.6406 4946.06513   231%  3223  480s
  1348   967     cutoff   15      -3764.6406 4946.06513   231%  3118  489s
  1433  1028 -2208.7099   16  288 -3764.6406 4946.06513   231%  3116  496s
  1540  1092 -3680.7314   16  295 -3764.6406 4946.06513   231%  3075  505s
  1632  1183 -2228.9600   17  277 -3764.6406 4946.06513   231%  3059  514s
  1757  1251     cutoff   19      -3764.6406 4946.06513   231%  2995  524s
  1902  1312     cutoff   17      -3764.6406 4946.06513   231%  2928  536s
  2027  1368 -2712.5455   32  221 -3764.6406 4488.26478   219%  2919  546s
  2148  1416 4055.35430    6  473 -3764.6406 4487.44776   219%  2925  557s
  2267  1465 3546.11679    7  454 -3764.6406 4487.44776   219%  2891  568s
  2379  1546 3278.29227    8  439 -3764.6406 4487.44776   219%  2894  578s
  2552  1597 2484.25687   10  404 -3764.6406 4487.44776   219%  2851  591s
  2657  1666 1264.70154   12  379 -3764.6406 4109.41990   209%  2913  602s
  2788  1799  416.91002   14  373 -3764.6406 4054.82495   208%  2942  614s
  2959  1858 -479.75857   16  371 -3764.6406 4054.82495   208%  2939  627s
  3129  1964 -1125.5126   18  448 -3764.6406 4054.82495   208%  2934  639s
  3282  2031 -1835.6533   20  164 -3764.6406 3453.53996   192%  2965  654s
H 3348  2005                    -3530.336352 3412.23703   197%  2953  654s
  3399  2087     cutoff   25      -3530.3364 3412.23703   197%  2951  666s
  3546  2191  261.38871   17  390 -3530.3364 3314.75188   194%  3007  678s
  3727  2273 -550.32886   19  373 -3530.3364 3314.75188   194%  3026  692s
  3936  2315 -2328.2240   22  376 -3530.3364 3150.38895   189%  3034  706s
  4110  2388 -3170.5459   28  258 -3530.3364 2863.98185   181%  3072  720s
  4331  2470  897.28123   11  379 -3530.3364 2863.98185   181%  3080  735s
  4542  2492 -124.81083   13  361 -3530.3364 2863.98185   181%  3102  749s
H 4545  2483                    -3497.269339 2863.98185   182%  3102  749s
H 4546  2443                    -3337.714534 2863.98185   186%  3103  749s
  4628  2529 -1300.4915   14  345 -3337.7145 2830.43070   185%  3118  764s
  4811  2608 -2409.6960   16  294 -3337.7145 2807.62589   184%  3165  779s
  5044  2671 -1216.8599   13  414 -3337.7145 2807.62589   184%  3186  797s
  5313  2743 -2206.7354   15  288 -3337.7145 2615.58227   178%  3182  812s
  5537  2819  795.06016    7  325 -3337.7145 2564.72494   177%  3214  829s
  5784  2820 1114.17014   15  517 -3337.7145 2466.44303   174%  3242  877s
  5786  2821  877.80577    9  279 -3337.7145 2466.44303   174%  3240  910s
  5787  2822 -1289.0672   12  536 -3337.7145 2466.44303   174%  3240  936s
  5788  2823 1005.38011   13  479 -3337.7145 2466.44303   174%  3239  957s
  5789  2823 1263.17437   14  495 -3337.7145 2466.44303   174%  3239  972s
  5790  2824 -754.93607   21  491 -3337.7145 2466.44303   174%  3238  980s
  5791  2825 -2210.2007   28  550 -3337.7145 2466.44303   174%  3238  988s
  5792  2825  668.15036   11  500 -3337.7145 2466.44303   174%  3237  995s
  5793  2826 -318.33781   10  489 -3337.7145 2466.44303   174%  3237 1001s
  5794  2827  993.41888   11  505 -3337.7145 2466.44303   174%  3236 1007s
  5795  2827 2126.06005   13  510 -3337.7145 2466.44303   174%  3235 1012s
  5796  2828 1502.96303   13  503 -3337.7145 2466.44303   174%  3235 1016s
  5797  2829 -2084.3904   51  496 -3337.7145 2466.44303   174%  3234 1020s
  5798  2829   52.35868   15  497 -3337.7145 2466.44303   174%  3234 1025s
  5800  2831 -2319.1317   33  514 -3337.7145 2466.44303   174%  3233 1031s
  5802  2832 -1573.9110   18  556 -3337.7145 2466.44303   174%  3232 1044s
H 5802  2690                    -3323.820102 2466.44303   174%  3232 1047s
H 5802  2555                    -3322.678650 2466.44303   174%  3232 1047s
H 5802  2427                    -3309.060379 2466.44303   175%  3232 1047s
H 5802  2305                    -3308.516595 2466.44303   175%  3232 1047s
  5804  2306 -1380.2792   12  482 -3308.5166 2466.44303   175%  3230 1050s
  5805  2307 -1976.1203   19  503 -3308.5166 2466.44303   175%  3230 1059s
H 5805  2191                    -3269.624690 2466.44303   175%  3230 1060s
H 5805  2081                    -3265.015831 2466.44303   176%  3230 1060s
H 5806  1978                    -3197.429728 2466.44303   177%  3229 1067s
  5808  1979 -834.08447   25  500 -3197.4297 2466.44303   177%  3228 1072s
  5810  1980 -188.85094   11  554 -3197.4297 2466.44303   177%  3227 1082s
H 5810  1880                    -3188.920590 2466.44303   177%  3227 1084s
H 5810  1786                    -3180.508934 2466.44303   178%  3227 1086s
  5812  1788 -1502.9019   68  514 -3180.5089 2466.44303   178%  3226 1094s
  5813  1788 -217.59357   12  523 -3180.5089 2466.44303   178%  3225 1096s
  5815  1790  993.41888   11  507 -3180.5089 2466.44303   178%  3224 1104s
  5816  1790  171.63175   10  521 -3180.5089 2466.44303   178%  3224 1107s
  5817  1791 -2567.2961   16  558 -3180.5089 2466.44303   178%  3223 1112s
  5818  1792 1539.41234   16  561 -3180.5089 2466.44303   178%  3223 1115s
  5819  1792 1786.62518   15  495 -3180.5089 2466.44303   178%  3222 1120s
  5820  1793 -1436.8646   22  495 -3180.5089 2466.44303   178%  3222 1157s
H 5820  1703                    -3174.433512 2466.44303   178%  3222 1189s
H 5820  1617                    -3167.189013 2466.44303   178%  3222 1190s
H 5820  1535                    -3163.561850 2466.44303   178%  3222 1190s
  5822  1538 2466.44303   13  499 -3163.5619 2466.44303   178%  3265 1208s
  5823  1541 2204.33604   14  426 -3163.5619 2466.44303   178%  3266 1217s
  5826  1546 2053.51171   15  421 -3163.5619 2466.44303   178%  3266 1231s
  5832  1556 1885.17702   16  397 -3163.5619 2466.44303   178%  3269 1246s
  5844  1560 2466.44303   16  532 -3163.5619 2466.44303   178%  3284 1264s
  5856  1585 2421.52393   17  454 -3163.5619 2466.44303   178%  3292 1301s
  5885  1606 1348.89548   18  505 -3163.5619 2466.44303   178%  3325 1313s
  5917  1630 1039.41644   19  477 -3163.5619 2466.44303   178%  3372 1324s
  5958  1655  824.24904   20  493 -3163.5619 2466.44303   178%  3390 1339s
  6037  1689 -1341.2345   21  444 -3163.5619 2466.44303   178%  3384 1348s
H 6105  1589                    -3156.947915 2466.44303   178%  3373 1348s
  6123  1622 -1840.6460   20  440 -3156.9479 2466.44303   178%  3374 1361s
  6211  1617 -1920.1320   22  517 -3156.9479 2466.44303   178%  3359 1371s
  6280  1607  517.02894   22  427 -3156.9479 2466.44303   178%  3355 1381s
  6361  1595 -2346.0374   23  463 -3156.9479 2466.44303   178%  3342 1393s
  6449  1580     cutoff   23      -3156.9479 2466.44303   178%  3324 1402s
  6524  1575 -827.86267   23  319 -3156.9479 2466.44303   178%  3312 1410s
H 6535  1498                    -3150.077576 2466.44303   178%  3311 1410s
  6569  1511 -1623.9924   24  197 -3150.0776 2466.44303   178%  3309 1420s
  6629  1515     cutoff   25      -3150.0776 2466.44303   178%  3305 1430s
H 6631  1446                    -3149.697547 2466.44303   178%  3304 1430s
  6670  1459 -1940.4426   24  404 -3149.6975 2466.44303   178%  3300 1438s
  6744  1446 -2910.5599   25  274 -3149.6975 2466.44303   178%  3290 1448s
  6785  1446     cutoff   26      -3149.6975 2466.44303   178%  3286 1463s
  6849  1444 infeasible   26      -3149.6975 2466.44303   178%  3279 1476s
  6916  1445 2427.29707   19  533 -3149.6975 2466.44303   178%  3274 1486s
  7008  1432 2128.28765   20  528 -3149.6975 2466.44303   178%  3260 1497s
  7087  1426 1895.40451   21  522 -3149.6975 2466.44303   178%  3252 1507s
  7140  1420 1625.24773   22  519 -3149.6975 2466.44303   178%  3247 1518s
  7221  1425   34.21761   23  452 -3149.6975 2466.44303   178%  3240 1528s
  7309  1419 -1360.2028   24  362 -3149.6975 2466.44303   178%  3231 1541s
  7402  1409 -1641.5362   25  364 -3149.6975 2466.44303   178%  3224 1553s
  7500  1398 -2859.9132   26  319 -3149.6975 2427.12444   177%  3215 1566s
  7602  1386     cutoff   27      -3149.6975 2427.12444   177%  3206 1579s
  7716  1363 -2900.4977   26  376 -3149.6975 1679.51812   153%  3196 1591s
  7832  1339 -3062.5548   27  333 -3149.6975 1679.51812   153%  3185 1606s
  7963  1297     cutoff   28      -3149.6975 1679.51812   153%  3172 1626s
  8105  1277     cutoff   28      -3149.6975 1240.64201   139%  3160 1645s
  8232  1248 -2680.2140   26  306 -3149.6975  611.34903   119%  3158 1660s
  8319  1246 -2693.8529   25  291 -3149.6975  565.23441   118%  3150 1675s
  8450  1203     cutoff   25      -3149.6975  543.72983   117%  3135 1690s
  8589  1176 -2971.5973   26  207 -3149.6975  416.27178   113%  3128 1706s
  8748  1135     cutoff   24      -3149.6975  342.56718   111%  3121 1721s
H 8779  1058                    -3149.136540  342.56718   111%  3121 1721s
  8792  1058     cutoff   21      -3149.1365  342.56718   111%  3119 1740s
  8996   999 -2334.8927   24  405 -3149.1365  159.88044   105%  3101 1758s
  9194   939 -2573.4668   23  372 -3149.1365   98.51427   103%  3087 1780s
  9391   880 -3092.6620   25  368 -3149.1365   98.51427   103%  3075 1801s
  9626   825 -1048.6846   21  342 -3149.1365  -93.19587  97.0%  3054 1824s
  9845   803 -2271.8807   24  247 -3149.1365 -218.60366  93.1%  3042 1843s
  9982   804     cutoff   25      -3149.1365 -297.57574  90.6%  3034 1865s
 10187   796 -1954.0518   24  516 -3149.1365 -391.49489  87.6%  3024 1887s
 10460   744     cutoff   25      -3149.1365 -482.41229  84.7%  3007 1913s
 10747   672 -2331.2583   20  133 -3149.1365 -664.42219  78.9%  2990 1938s
 11099   534     cutoff   30      -3149.1365 -916.36525  70.9%  2960 1962s
 11554   368 -2994.4394   48   94 -3149.1365 -1119.6171  64.4%  2908 1985s
 12191   463     cutoff   26      -3149.1365 -1612.2225  48.8%  2815 2003s
 13362   948     cutoff   55      -3149.1365 -2222.9504  29.4%  2600 2009s
 14898  1577 -3124.3925   59   70 -3149.1365 -2903.5868  7.80%  2338 2011s
 18930  2734 -3146.3449   59   31 -3149.1365 -3007.9581  4.48%  1852 2017s
 21554  2952     cutoff   54      -3149.1365 -3047.6691  3.22%  1633 2022s
 24399  3107 -3143.9576   66   33 -3149.1365 -3072.2650  2.44%  1449 2026s
 25788  3127     cutoff   51      -3149.1365 -3073.9555  2.39%  1374 2030s
H25847  2710                    -3137.981238 -3074.9383  2.01%  1371 2030s
 25896  2364 -3084.1207   71   28 -3137.9812 -3074.9383  2.01%  1368 2035s
 29467  2347 -3125.0950   57   50 -3137.9812 -3098.7756  1.25%  1208 2040s
 29659  2076 -3132.8660   59   40 -3137.9812 -3101.1799  1.17%  1200 2046s
 30311  1306     cutoff   58      -3137.9812 -3102.6625  1.13%  1176 2050s
H30968  1303                    -3137.868620 -3103.8674  1.08%  1151 2050s

Cutting planes:
  MIR: 858
  Flow cover: 1689
  Zero half: 3
  RLT: 21
  Relax-and-lift: 53

Explored 35057 nodes (36069242 simplex iterations) in 2053.90 seconds (5540.51 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3137.87 -3137.87 -3137.98 ... -3174.43
No other solutions better than -3137.87

Optimal solution found (tolerance 1.00e-04)
Best objective -3.137868620209e+03, best bound -3.137868620209e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2053.99s
  Master Objective (UB) = -3137.87, θ = 110909.77
  Upper Bound (UB) = -3137.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110909.77
  [DEBUG]   ✓ Scenario 0: θ = 110909.77 ≤ Q = 130534.99 (slack: 19625.22)
  [DEBUG]   ✓ Scenario 1: θ = 110909.77 ≤ Q = 110909.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110909.77 ≤ Q = 110909.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110909.77 ≤ Q = 110920.38 (slack: 10.61)
  [DEBUG]   ✓ Scenario 4: θ = 110909.77 ≤ Q = 126137.57 (slack: 15227.80)
  [DEBUG]   ✓ Scenario 5: θ = 110909.77 ≤ Q = 110924.06 (slack: 14.28)
  [DEBUG]   ✓ Scenario 6: θ = 110909.77 ≤ Q = 112432.47 (slack: 1522.69)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x31ff978f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xce006871
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.183564e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6225864.1585
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.150771e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115077.14    0  122 6225864.16 -115077.14   102%     -    0s
H    0     0                    -82377.06236 -115077.14  39.7%     -    0s
H    0     0                    -82815.15995 -115077.14  39.0%     -    0s
H    0     0                    -85473.85280 -87875.344  2.81%     -    0s
     0     0 -87875.344    0   69 -85473.853 -87875.344  2.81%     -    0s
H    0     0                    -85778.77470 -87853.267  2.42%     -    0s
H    0     0                    -86163.44665 -87853.267  1.96%     -    0s
H    0     0                    -86468.36855 -87853.267  1.60%     -    0s
     0     0 -87571.169    0   70 -86468.369 -87571.169  1.28%     -    0s
H    0     0                    -86760.68402 -87561.919  0.92%     -    0s
     0     0 -87512.206    0   70 -86760.684 -87512.206  0.87%     -    0s
     0     0 -87320.449    0   67 -86760.684 -87320.449  0.65%     -    0s
     0     0 -87282.021    0   68 -86760.684 -87282.021  0.60%     -    0s
     0     0 -87277.822    0   70 -86760.684 -87277.822  0.60%     -    0s
     0     0 -87210.720    0   76 -86760.684 -87210.720  0.52%     -    0s
     0     0 -87193.125    0   70 -86760.684 -87193.125  0.50%     -    0s
     0     2 -87193.125    0   70 -86760.684 -87193.125  0.50%     -    0s
H  121    35                    -86788.62006 -87062.940  0.32%   8.6    0s
*  501    70              23    -86794.75736 -86855.790  0.07%   5.0    0s
H  508    70                    -86799.27875 -86855.790  0.07%   5.0    0s
*  582    70              23    -86811.78113 -86855.790  0.05%   4.8    0s
*  662     6              23    -86818.21475 -86830.404  0.01%   4.5    0s

Cutting planes:
  Gomory: 31
  Implied bound: 1
  MIR: 176
  Flow cover: 1
  RLT: 4
  BQP: 1

Explored 671 nodes (3546 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -86818.2 -86811.8 -86799.3 ... -82377.1

Optimal solution found (tolerance 1.00e-04)
Best objective -8.681821474577e+04, best bound -8.682668864437e+04, gap 0.0098%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 109295.59
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -86818.21
  [DEBUG]   S×d_nominal = 196113.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 196113.81 + -86818.21 = 109295.59
  [DEBUG]   Current θ from Master = 110909.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1614.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4752.05
  Lower Bound (LB) = -4752.05
  Gap (UB-LB) = 1614.1827, Absolute Gap = 1614.1827, Relative Gap = 0.514420
  Not converged yet (gap = 1614.18 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351439 nonzeros
Model fingerprint: 0xae51362d
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54236 rows and 22026 columns
Presolve time: 1.16s
Presolved: 69467 rows, 30154 columns, 432539 nonzeros
Variable types: 27895 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -359952.0065
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 69467 rows, 30154 columns, 432539 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31994   -6.1643144e+04   0.000000e+00   1.244213e+08      5s
   43831   -4.1710006e+03   0.000000e+00   1.362799e+06     10s
   51162   -1.3655625e+03   0.000000e+00   9.573702e+06     15s
   59482    1.1288218e+04   0.000000e+00   1.989027e+07     20s
   65654    1.2809242e+04   0.000000e+00   2.175178e+07     25s
   71481    1.3830126e+04   0.000000e+00   1.609837e+06     30s
   76891    1.4526611e+04   0.000000e+00   9.162015e+05     35s
Concurrent spin time: 0.89s

Solved with dual simplex

Root relaxation: objective 1.833576e+04, 66086 iterations, 34.63 seconds (71.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 18335.7647    0  279 -210563.59 18335.7647   109%     -   36s
H    0     0                    -201349.5452 18335.7647   109%     -   36s
H    0     0                    -57862.69861 18335.7647   132%     -   36s
H    0     0                    -36700.70276 18335.7647   150%     -   36s
H    0     0                    -24337.78115 18335.7647   175%     -   36s
H    0     0                    -4577.045439 18335.7647   501%     -   36s
H    0     0                    -4120.737462 18335.7647   545%     -   36s
H    0     0                    -4047.813919 18335.7647   553%     -   38s
     0     0 14492.2470    0  350 -4047.8139 14492.2470   458%     -   46s
H    0     0                    -3975.591838 14491.3254   465%     -   47s
H    0     0                    -3773.894427 14491.3254   484%     -   47s
     0     0 13394.2303    0  351 -3773.8944 13394.2303   455%     -   55s
     0     0 13203.3078    0  360 -3773.8944 13203.3078   450%     -   58s
     0     0 13010.4361    0  363 -3773.8944 13010.4361   445%     -   60s
     0     0 12912.5895    0  366 -3773.8944 12912.5895   442%     -   64s
     0     0 12840.6775    0  371 -3773.8944 12840.6775   440%     -   66s
     0     0 12787.1531    0  353 -3773.8944 12787.1531   439%     -   70s
H    0     0                    -3772.014000 12787.1531   439%     -   74s
     0     0 12787.1531    0  360 -3772.0140 12787.1531   439%     -   74s
     0     0 12786.2236    0  357 -3772.0140 12786.2236   439%     -   75s
     0     0 12785.9983    0  363 -3772.0140 12785.9983   439%     -   75s
H    0     0                    -3764.640596 10959.0188   391%     -   87s
     0     0 10959.0188    0  458 -3764.6406 10959.0188   391%     -   87s
     0     0 10412.4728    0  456 -3764.6406 10412.4728   377%     -   97s
     0     0 10234.2052    0  465 -3764.6406 10234.2052   372%     -  101s
     0     0 10133.7140    0  459 -3764.6406 10133.7140   369%     -  104s
     0     0 9919.96381    0  469 -3764.6406 9919.96381   364%     -  109s
     0     0 9849.13054    0  471 -3764.6406 9849.13054   362%     -  111s
     0     0 9751.54851    0  472 -3764.6406 9751.54851   359%     -  113s
     0     0 9747.52274    0  481 -3764.6406 9747.52274   359%     -  114s
     0     0 9703.82760    0  473 -3764.6406 9703.82760   358%     -  116s
     0     0 9686.21289    0  469 -3764.6406 9686.21289   357%     -  117s
     0     0 9673.53024    0  470 -3764.6406 9673.53024   357%     -  117s
     0     0 9620.14340    0  475 -3764.6406 9620.14340   356%     -  119s
     0     0 9618.80237    0  473 -3764.6406 9618.80237   356%     -  119s
     0     0 9617.99751    0  474 -3764.6406 9617.99751   355%     -  120s
     0     0 7872.48029    0  416 -3764.6406 7872.48029   309%     -  137s
     0     0 7198.00809    0  484 -3764.6406 7198.00809   291%     -  149s
     0     0 7090.90748    0  417 -3764.6406 7090.90748   288%     -  153s
     0     0 6855.40886    0  435 -3764.6406 6855.40886   282%     -  161s
     0     0 6798.57050    0  441 -3764.6406 6798.57050   281%     -  164s
     0     0 6634.59045    0  451 -3764.6406 6634.59045   276%     -  169s
     0     0 6593.09055    0  449 -3764.6406 6593.09055   275%     -  172s
     0     0 6588.54041    0  453 -3764.6406 6588.54041   275%     -  174s
     0     0 6580.19893    0  449 -3764.6406 6580.19893   275%     -  176s
     0     0 6578.98603    0  451 -3764.6406 6578.98603   275%     -  176s
     0     0 6147.29774    0  468 -3764.6406 6147.29774   263%     -  192s
     0     0 6008.93604    0  466 -3764.6406 6008.93604   260%     -  198s
     0     0 5942.06841    0  464 -3764.6406 5942.06841   258%     -  203s
     0     0 5920.45548    0  464 -3764.6406 5920.45548   257%     -  206s
     0     0 5908.49072    0  482 -3764.6406 5908.49072   257%     -  208s
     0     0 5901.24374    0  479 -3764.6406 5901.24374   257%     -  208s
     0     0 5867.47850    0  476 -3764.6406 5867.47850   256%     -  212s
     0     0 5853.54009    0  472 -3764.6406 5853.54009   255%     -  214s
     0     0 5843.46628    0  479 -3764.6406 5843.46628   255%     -  215s
     0     0 5839.78022    0  483 -3764.6406 5839.78022   255%     -  216s
     0     0 5838.23203    0  483 -3764.6406 5838.23203   255%     -  217s
     0     0 5837.53762    0  487 -3764.6406 5837.53762   255%     -  217s
     0     0 5802.93783    0  459 -3764.6406 5802.93783   254%     -  221s
     0     0 5787.20168    0  472 -3764.6406 5787.20168   254%     -  224s
     0     0 5777.05329    0  478 -3764.6406 5777.05329   253%     -  226s
     0     0 5771.51510    0  475 -3764.6406 5771.51510   253%     -  228s
     0     0 5768.27317    0  474 -3764.6406 5768.27317   253%     -  229s
     0     0 5766.91388    0  480 -3764.6406 5766.91388   253%     -  229s
     0     0 5734.14027    0  487 -3764.6406 5734.14027   252%     -  233s
     0     0 5722.76178    0  496 -3764.6406 5722.76178   252%     -  242s
     0     0 5720.23546    0  507 -3764.6406 5720.23546   252%     -  243s
     0     0 5719.62026    0  498 -3764.6406 5719.62026   252%     -  243s
     0     0 5697.72567    0  496 -3764.6406 5697.72567   251%     -  247s
     0     0 5694.56232    0  498 -3764.6406 5694.56232   251%     -  248s
     0     0 5694.03967    0  500 -3764.6406 5694.03967   251%     -  248s
     0     0 5642.04661    0  507 -3764.6406 5642.04661   250%     -  252s
     0     0 5637.24511    0  515 -3764.6406 5637.24511   250%     -  263s
     0     0 5635.72010    0  513 -3764.6406 5635.72010   250%     -  264s
     0     0 5618.59776    0  516 -3764.6406 5618.59776   249%     -  268s
     0     0 5616.30736    0  516 -3764.6406 5616.30736   249%     -  269s
     0     0 5615.90240    0  518 -3764.6406 5615.90240   249%     -  270s
     0     0 5610.01711    0  522 -3764.6406 5610.01711   249%     -  271s
     0     0 5607.95655    0  526 -3764.6406 5607.95655   249%     -  272s
     0     0 5607.53054    0  529 -3764.6406 5607.53054   249%     -  273s
     0     0 5606.04666    0  526 -3764.6406 5606.04666   249%     -  275s
     0     0 5605.83745    0  527 -3764.6406 5605.83745   249%     -  276s
     0     0 5603.40744    0  526 -3764.6406 5603.40744   249%     -  277s
     0     0 5603.21419    0  526 -3764.6406 5603.21419   249%     -  280s
     0     2 5603.21419    0  526 -3764.6406 5603.21419   249%     -  324s
     1     4 5567.85453    1  512 -3764.6406 5602.97532   249%  2587  327s
     3     8 5558.44070    2  516 -3764.6406 5567.78504   248%  2440  338s
     7    15 4028.41973    3  468 -3764.6406 5558.30621   248%  6838  345s
    14    29 3864.13230    4  475 -3764.6406 5558.30621   248%  5733  355s
    28    44 2815.30614    5  510 -3764.6406 5394.82523   243%  9148  375s
    43    76 3958.32838    5  460 -3764.6406 5359.67984   242%  8950  406s
    75   163 3815.55156    6  449 -3764.6406 5309.73369   241%  6885  422s
   162   283   72.91401    8  201 -3764.6406 5309.73369   241%  4149  430s
   282   365 -2562.7535   13  188 -3764.6406 5309.73369   241%  2935  438s
   378   388     cutoff   14      -3764.6406 5309.73369   241%  2646  444s
   412   399 -1652.0069   13  162 -3764.6406 5309.73369   241%  2604  453s
   454   423 -3201.2800   15  162 -3764.6406 5309.73369   241%  2637  462s
   489   443     cutoff   16      -3764.6406 5309.73369   241%  2666  470s
   530   449  555.66072   11  239 -3764.6406 5309.73369   241%  2621  477s
   573   465  497.75332   12  233 -3764.6406 5309.73369   241%  2579  485s
   615   489  360.55972   13  193 -3764.6406 5309.73369   241%  2584  493s
   658   501 -146.19550   14  200 -3764.6406 5309.73369   241%  2627  501s
   704   518 -1028.7162   15  198 -3764.6406 5309.73369   241%  2636  510s
   745   547 -1816.2625   16  165 -3764.6406 5309.73369   241%  2689  518s
   784   571 -2585.7959   17  150 -3764.6406 5309.73369   241%  2747  526s
   822   592     cutoff   18      -3764.6406 5309.73369   241%  2878  534s
   875   609 -3596.4900   23  145 -3764.6406 5309.73369   241%  2847  543s
   935   629 -1378.6437   10  314 -3764.6406 5309.73369   241%  2859  550s
   995   647 infeasible   11      -3764.6406 5309.73369   241%  2832  558s
  1045   670 -1776.6924   13  304 -3764.6406 5309.73369   241%  2852  568s
  1106   710 -3075.1130   15  275 -3764.6406 5309.73369   241%  2853  577s
  1174   759 -3395.2400   17  296 -3764.6406 5309.73369   241%  2854  587s
  1263   796 infeasible   19      -3764.6406 5309.73369   241%  2800  597s
  1344   846 2191.03575    9  325 -3764.6406 5309.73369   241%  2749  606s
  1436   885 -630.68512   11  255 -3764.6406 5309.73369   241%  2723  617s
  1536   937 1052.18915   11  342 -3764.6406 4952.80213   232%  2694  628s
  1643   997 -422.08022   14  301 -3764.6406 4952.80213   232%  2673  640s
  1747  1060 -519.35914   19  230 -3764.6406 4952.80213   232%  2656  652s
  1863  1113 -2429.8233   24  193 -3764.6406 4952.80213   232%  2635  664s
  1978  1140 -3291.4451   36  239 -3764.6406 4617.74929   223%  2619  677s
  2094  1161 -1062.2063    9  147 -3764.6406 4617.74929   223%  2631  691s
  2193  1205 infeasible   14      -3764.6406 4617.74929   223%  2649  705s
  2318  1296 -1897.4544    9  334 -3764.6406 4615.17753   223%  2655  719s
  2463  1448 -3081.3582   11  348 -3764.6406 4615.17753   223%  2619  735s
  2667  1564 infeasible   15      -3764.6406 4615.17753   223%  2533  749s
  2888  1629 -2762.8321   18  239 -3764.6406 3845.36036   202%  2449  765s
  3087  1713 2486.86390    7  509 -3764.6406 3845.36036   202%  2428  785s
  3257  1814 2453.52395    8  499 -3764.6406 3845.36036   202%  2433  799s
  3431  1890 1063.13624   10  398 -3764.6406 3569.32027   195%  2445  816s
  3609  1951 -563.73378   11  372 -3764.6406 3558.59496   195%  2441  838s
  3788  1996 -598.10608   13  241 -3764.6406 3176.33392   184%  2448  855s
  3995  2057 -2324.2855   16  241 -3764.6406 3176.33392   184%  2451  874s
  4126  2118 -2967.1920   19  157 -3764.6406 2962.93162   179%  2454  899s
  4271  2175 infeasible   26      -3764.6406 2906.16505   177%  2468  927s
  4436  2250 -2444.8764   13  300 -3764.6406 2837.08177   175%  2492  950s
  4642  2294 infeasible   17      -3764.6406 2766.73222   173%  2507  981s
  4835  2360 -1818.3395   19  119 -3764.6406 2723.20880   172%  2531 1001s
  5045  2410 -1916.6836   17  359 -3764.6406 2649.29923   170%  2553 1025s
  5275  2459 -2717.6024   19  446 -3764.6406 2649.29923   170%  2560 1046s
  5424  2477 -3035.4786   20  418 -3764.6406 2374.64046   163%  2563 1063s
  5470  2495 -3301.4241   21  437 -3764.6406 2374.64046   163%  2574 1081s
  5531  2523 infeasible   22      -3764.6406 2374.64046   163%  2584 1104s
  5635  2560 -436.86956   21  352 -3764.6406 2374.64046   163%  2600 1129s
  5822  2604 -3328.4968   23  267 -3764.6406 2374.64046   163%  2616 1157s
  6056  2673 -1408.5967   10  357 -3764.6406 2114.73618   156%  2642 1186s
  6346  2738 -3288.8116   13  247 -3764.6406 2114.73618   156%  2656 1215s
  6651  2837 -3419.8167   18  205 -3764.6406 1985.61905   153%  2663 1265s
  6945  2838 -2821.3781   23  526 -3764.6406 1985.61905   153%  2679 1335s
  6947  2839 -1672.5266   16  279 -3764.6406 1985.61905   153%  2678 1366s
  6948  2840 -3574.0627   72  446 -3764.6406 1985.61905   153%  2678 1395s
  6949  2841 -1554.7582   19  496 -3764.6406 1985.61905   153%  2677 1415s
  6950  2841 -3074.5079   55  534 -3764.6406 1985.61905   153%  2677 1425s
  6951  2842 -3007.2181   23  491 -3764.6406 1985.61905   153%  2677 1437s
  6952  2843 -3730.0678   78  493 -3764.6406 1985.61905   153%  2676 1450s
  6953  2843 -1938.2076   10  494 -3764.6406 1985.61905   153%  2676 1458s
  6954  2844 -3224.1019   28  488 -3764.6406 1985.61905   153%  2676 1468s
  6955  2845 -1948.7733   12  504 -3764.6406 1985.61905   153%  2675 1477s
  6956  2845 1168.21533    9  543 -3764.6406 1985.61905   153%  2675 1482s
  6957  2846 -2302.0162   26  501 -3764.6406 1985.61905   153%  2674 1486s
  6958  2847  -29.99687   12  512 -3764.6406 1985.61905   153%  2674 1491s
  6959  2847 -2993.1586   21  510 -3764.6406 1985.61905   153%  2674 1495s
  6961  2849 -1810.7650   17  521 -3764.6406 1985.61905   153%  2673 1508s
  6962  2849 -3492.9422   49  507 -3764.6406 1985.61905   153%  2672 1512s
  6963  2850 1256.63173   16  517 -3764.6406 1985.61905   153%  2672 1515s
  6964  2851  638.23127    8  513 -3764.6406 1985.61905   153%  2672 1525s
  6965  2851  972.08503   13  507 -3764.6406 1985.61905   153%  2671 1530s
  6966  2852 1298.31262    9  511 -3764.6406 1985.61905   153%  2671 1539s
  6967  2853 1211.69645   11  521 -3764.6406 1985.61905   153%  2671 1542s
  6968  2853 1231.43665   11  530 -3764.6406 1985.61905   153%  2670 1545s
  6969  2854 1285.41492    9  556 -3764.6406 1985.61905   153%  2670 1553s
  6970  2855  693.58651   17  503 -3764.6406 1985.61905   153%  2669 1556s
  6971  2855 -1439.3788   19  565 -3764.6406 1985.61905   153%  2669 1564s
  6972  2856 -2304.6153   18  502 -3764.6406 1985.61905   153%  2669 1568s
  6973  2857 1281.38368    9  569 -3764.6406 1985.61905   153%  2668 1575s
  6975  2858 -878.69943   13  537 -3764.6406 1985.61905   153%  2667 1585s
  6976  2859 -2431.7691   17  537 -3764.6406 1985.61905   153%  2667 1617s
  6977  2859 -629.08271   10  537 -3764.6406 1985.61905   153%  2667 1649s
  6978  2863 1985.61905   12  557 -3764.6406 1985.61905   153%  2703 1692s
  6980  2866 1985.61905   13  513 -3764.6406 1985.61905   153%  2704 1705s
  6984  2873 1985.61905   14  509 -3764.6406 1985.61905   153%  2707 1726s
  6992  2886 1985.61905   15  614 -3764.6406 1985.61905   153%  2712 1742s
  7008  2903  983.17565   16  411 -3764.6406 1985.61905   153%  2744 1769s
  7030  2928 1898.80866   17  439 -3764.6406 1985.61905   153%  2765 1783s
  7062  3005 1786.38890   18  422 -3764.6406 1985.61905   153%  2784 1805s
  7163  3013 1502.00941   20  430 -3764.6406 1985.61905   153%  2793 1821s
  7232  3018 -960.72086   19  202 -3764.6406 1985.61905   153%  2803 1833s
  7287  3025     cutoff   21      -3764.6406 1985.61905   153%  2816 1846s
  7350  3004 -2325.6444   21  398 -3764.6406 1985.61905   153%  2825 1859s
  7389  3005 -500.79403   22  327 -3764.6406 1985.61905   153%  2838 1871s
  7444  3006 -472.72745   25  275 -3764.6406 1985.61905   153%  2847 1881s
  7498  2987 -1701.7504   28  216 -3764.6406 1985.61905   153%  2854 1893s
  7533  2983 -2103.8327   29  199 -3764.6406 1985.61905   153%  2862 1905s
  7580  2985 -2569.4980   30  199 -3764.6406 1985.61905   153%  2868 1916s
  7627  2970 -2702.1664   31  165 -3764.6406 1985.61905   153%  2873 1933s
  7685  2948 -2973.8690   33  164 -3764.6406 1985.61905   153%  2881 1948s
  7739  2942 -3485.3892   36  188 -3764.6406 1985.61905   153%  2883 1964s
  7797  2943 -1653.9192   22  314 -3764.6406 1985.61905   153%  2891 1974s
  7859  2924     cutoff   23      -3764.6406 1985.61905   153%  2897 1991s
  7904  2921 -3093.8908   24  236 -3764.6406 1985.61905   153%  2904 2003s
  7973  2913 -3225.1801   24  268 -3764.6406 1985.61905   153%  2908 2016s
  8025  2920 -3581.4700   25  268 -3764.6406 1985.61905   153%  2909 2028s
  8078  2918 -3416.9140   25  264 -3764.6406 1985.61905   153%  2913 2042s
  8136  2908 infeasible   26      -3764.6406 1985.61905   153%  2918 2056s
  8204  2900 infeasible   24      -3764.6406 1985.61905   153%  2923 2085s
  8279  2905 -1566.2955   20  397 -3764.6406 1985.61905   153%  2925 2101s
  8356  2885 infeasible   22      -3764.6406 1985.61905   153%  2931 2120s
  8432  2887 -2178.7757   21  481 -3764.6406 1985.61905   153%  2944 2138s
  8529  2870 -2440.0138   23  484 -3764.6406 1985.61905   153%  2952 2161s
  8614  2858 infeasible   25      -3764.6406 1985.61905   153%  2962 2184s
  8720  2834 -3489.8239   24  188 -3764.6406 1985.61905   153%  2967 2201s
  8812  2837     cutoff   25      -3764.6406 1985.61905   153%  2966 2224s
  8936  2828 -1691.1468   25  312 -3764.6406 1985.61905   153%  2961 2249s
  9042  2820 infeasible   29      -3764.6406 1985.61905   153%  2969 2273s
  9163  2808 infeasible   28      -3764.6406 1985.61905   153%  2978 2290s
  9273  2800  758.20566   19  407 -3764.6406 1985.61905   153%  2976 2309s
  9416  2793  262.68036   20  457 -3764.6406 1985.61905   153%  2974 2335s
  9551  2798  -27.04314   21  433 -3764.6406 1985.61905   153%  2981 2359s
  9685  2795  666.18165   19  530 -3764.6406 1985.61905   153%  2986 2382s
  9828  2805  580.18646   20  461 -3764.6406 1985.61905   153%  2992 2406s
 10012  2765   27.88804   21  474 -3764.6406 1985.61905   153%  2988 2425s
 10082  2782 -760.52325   22  413 -3764.6406 1229.78479   133%  2991 2452s
 10233  2773 -1115.4546   24  426 -3764.6406 1229.78479   133%  2992 2482s
 10456  2743     cutoff   25      -3764.6406  844.87545   122%  2983 2510s
 10689  2721 -3517.8421   27  297 -3764.6406  844.87545   122%  2974 2544s
 10915  2678 infeasible   28      -3764.6406  465.52641   112%  2975 2574s
 11131  2627 -1276.8997   23  336 -3764.6406  465.52641   112%  2983 2606s
 11320  2614 -2644.4960   27  284 -3764.6406  211.34807   106%  3000 2639s
 11562  2569     cutoff   32      -3764.6406 -112.10126  97.0%  3007 2682s
 11891  2570 infeasible   27      -3764.6406 -118.15562  96.9%  2989 2716s
 12297  2653 -3446.9449   24  466 -3764.6406 -196.06593  94.8%  2957 2747s
H12377  2482                    -3534.695487 -309.01841  91.3%  2951 2747s
 12821  2331 -3282.2529   27  308 -3534.6955 -309.01841  91.3%  2897 2781s
*12873  2178             152    -3527.716085 -309.01841  91.2%  2900 2782s
*12880  2046             153    -3521.736908 -309.01841  91.2%  2898 2782s
*12882  1922             153    -3521.077216 -309.01841  91.2%  2898 2782s
 13197  1823 infeasible   26      -3521.0772 -309.01841  91.2%  2889 2821s
 13521  1660 infeasible   26      -3521.0772 -694.00541  80.3%  2897 2860s
H13535  1538                    -3465.070171 -720.86016  79.2%  2898 2860s
H13678  1515                    -3439.217024 -762.63692  77.8%  2908 2860s
H13701  1515                    -3397.237905 -762.63692  77.6%  2910 2860s
 13808  1453     cutoff   22      -3397.2379 -926.37869  72.7%  2918 2906s
 14079  1331 infeasible   28      -3397.2379 -1170.4432  65.5%  2940 2950s
 14435  1202 infeasible   21      -3397.2379 -1488.2849  56.2%  2947 2989s
H14451  1202                    -3387.283411 -1489.2055  56.0%  2947 2989s
H14527  1202                    -3307.909736 -1532.1085  53.7%  2945 2989s
H14585  1202                    -3291.671816 -1580.7063  52.0%  2945 2989s
H14692  1202                    -3228.012309 -1610.9336  50.1%  2945 2989s
 14779   830 infeasible   27      -3228.0123 -1724.9244  46.6%  2948 3026s
 15795   751 -3117.9099   38  205 -3228.0123 -1837.2482  43.1%  2830 3054s
H15813   751                    -3222.257269 -1837.2482  43.0%  2827 3054s
 15952   707 -3117.9569   39  268 -3222.2573 -2333.2759  27.6%  2811 3081s
 17581   761 -3150.9297   75   87 -3222.2573 -2569.7471  20.3%  2589 3104s
H17582   761                    -3204.088059 -2569.7471  19.8%  2589 3104s
 17797  1476 -3167.0401   76   89 -3204.0881 -2569.7471  19.8%  2560 3116s
 19973  2842 -3174.7649   72   82 -3204.0881 -2821.7921  11.9%  2300 3129s
*21091  2842             117    -3181.719658 -2879.2363  9.51%  2184 3129s
 22597  2777     cutoff   84      -3181.7197 -2916.7120  8.33%  2046 3142s
*22686  2398             114    -3160.753003 -2945.1532  6.82%  2038 3142s
 23909  3462 -3077.9796   75   91 -3160.7530 -2970.9947  6.00%  1941 3154s
 27296  4411     cutoff   88      -3160.7530 -3011.8118  4.71%  1716 3164s
 30982  5527 -3121.5058   70   84 -3160.7530 -3030.5817  4.12%  1527 3181s
 35814  5754     cutoff   93      -3160.7530 -3056.9233  3.28%  1339 3185s
H37064  5165                    -3150.072837 -3063.4711  2.75%  1299 3189s
 37071  5173 -3109.0786   77   80 -3150.0728 -3063.4711  2.75%  1299 3193s
 37122  5179 -3121.2212   78   73 -3150.0728 -3064.7329  2.71%  1297 3197s
H37132  5126                    -3149.136540 -3064.7329  2.68%  1297 3197s
 37161  5189 -3134.5313   79   69 -3149.1365 -3064.7329  2.68%  1296 3200s
 39979  5230     cutoff   78      -3149.1365 -3073.1348  2.41%  1214 3208s
 41510  5187 -3114.3188   78   72 -3149.1365 -3076.8112  2.30%  1174 3212s
 43080  5159 -3116.5147   81   62 -3149.1365 -3080.6062  2.18%  1136 3216s
 44498  5030 -3119.7347   86   48 -3149.1365 -3085.1752  2.03%  1105 3221s
 46204  4958 -3144.3582   89   46 -3149.1365 -3088.1633  1.94%  1069 3226s
 46987  4880 infeasible   78      -3149.1365 -3088.6937  1.92%  1054 3230s
 47663  4808 -3131.9420   83   58 -3149.1365 -3090.6347  1.86%  1041 3235s
 48412  4652     cutoff   79      -3149.1365 -3090.8189  1.85%  1027 3240s
 49227  4497     cutoff   82      -3149.1365 -3091.5861  1.83%  1012 3246s
 50045  4243 -3146.4718   71   76 -3149.1365 -3093.0911  1.78%   999 3252s
 51164  3626     cutoff   82      -3149.1365 -3094.4173  1.74%   980 3259s
 53478  2764     cutoff   75      -3149.1365 -3107.8029  1.31%   946 3266s
 55896  1673     cutoff   82      -3149.1365 -3115.6269  1.06%   913 3274s
 58208   441 -3147.6472   77   53 -3149.1365 -3124.1860  0.79%   884 3281s

Cutting planes:
  Gomory: 1
  MIR: 1139
  Flow cover: 2173
  Inf proof: 1
  Zero half: 8
  RLT: 25
  Relax-and-lift: 102

Explored 60869 nodes (52420353 simplex iterations) in 3284.85 seconds (9255.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3149.14 -3149.14 -3150.07 ... -3307.91
No other solutions better than -3149.14

Optimal solution found (tolerance 1.00e-04)
Best objective -3.149136539601e+03, best bound -3.149136539601e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3284.90s
  Master Objective (UB) = -3149.14, θ = 110860.73
  Upper Bound (UB) = -3149.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110860.73
  [DEBUG]   ✓ Scenario 0: θ = 110860.73 ≤ Q = 130273.14 (slack: 19412.41)
  [DEBUG]   ✓ Scenario 1: θ = 110860.73 ≤ Q = 110865.76 (slack: 5.03)
  [DEBUG]   ✓ Scenario 2: θ = 110860.73 ≤ Q = 112197.89 (slack: 1337.16)
  [DEBUG]   ✓ Scenario 3: θ = 110860.73 ≤ Q = 110860.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110860.73 ≤ Q = 126042.32 (slack: 15181.59)
  [DEBUG]   ✓ Scenario 5: θ = 110860.73 ≤ Q = 112842.00 (slack: 1981.27)
  [DEBUG]   ✓ Scenario 6: θ = 110860.73 ≤ Q = 110860.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110860.73 ≤ Q = 111536.67 (slack: 675.94)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xa0ead34
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf5f152cc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.187927e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6228035.3382
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.152528e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115252.76    0  122 6228035.34 -115252.76   102%     -    0s
H    0     0                    -82632.97705 -115252.76  39.5%     -    0s
H    0     0                    -83071.07464 -115252.76  38.7%     -    0s
     0     0 -88457.116    0   77 -83071.075 -88457.116  6.48%     -    0s
H    0     0                    -87789.50569 -88346.135  0.63%     -    0s
     0     0 -88172.657    0   75 -87789.506 -88172.657  0.44%     -    0s
     0     0 -88140.017    0   74 -87789.506 -88140.017  0.40%     -    0s
H    0     0                    -87802.51770 -88001.758  0.23%     -    0s
     0     0 -88001.758    0   25 -87802.518 -88001.758  0.23%     -    0s
     0     0 -87997.126    0   18 -87802.518 -87997.126  0.22%     -    0s
     0     0 -87974.224    0   12 -87802.518 -87974.224  0.20%     -    0s
     0     0 -87930.149    0   17 -87802.518 -87930.149  0.15%     -    0s
     0     0 -87910.984    0   16 -87802.518 -87910.984  0.12%     -    0s
     0     0 -87898.376    0   12 -87802.518 -87898.376  0.11%     -    0s
     0     0 -87883.342    0   10 -87802.518 -87883.342  0.09%     -    0s
     0     0 -87846.874    0    5 -87802.518 -87846.874  0.05%     -    0s
     0     0 -87846.874    0   13 -87802.518 -87846.874  0.05%     -    0s
     0     0 -87843.329    0    9 -87802.518 -87843.329  0.05%     -    0s
H    0     0                    -87809.36780 -87843.329  0.04%     -    0s
     0     0          -    0      -87809.368 -87817.947  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 3
  Flow cover: 2
  RLT: 4
  Relax-and-lift: 1

Explored 1 nodes (606 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -87809.4 -87802.5 -87789.5 ... 1.18793e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -8.780936779893e+04, best bound -8.781794725200e+04, gap 0.0098%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 108437.01
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87809.37
  [DEBUG]   S×d_nominal = 196246.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 196246.38 + -87809.37 = 108437.01
  [DEBUG]   Current θ from Master = 110860.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2423.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5572.85
  Lower Bound (LB) = -4752.05
  Gap (UB-LB) = 1602.9148, Absolute Gap = 1602.9148, Relative Gap = 0.509001
  Not converged yet (gap = 1602.91 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394679 nonzeros
Model fingerprint: 0x70e9bdf5
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61003 rows and 24773 columns
Presolve time: 1.12s
Presolved: 77990 rows, 33647 columns, 478250 nonzeros
Variable types: 31388 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -374563.4771
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77990 rows, 33647 columns, 478250 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35523   -7.5349077e+04   0.000000e+00   6.324892e+07      5s
   50442   -1.4998294e+04   0.000000e+00   1.761514e+06     10s
   59557   -5.9444571e+01   0.000000e+00   2.371629e+08     15s
   66839    3.5910930e+03   0.000000e+00   5.615752e+07     20s
   73054    9.2670375e+03   0.000000e+00   1.209406e+06     25s
   78686    1.3114779e+04   0.000000e+00   1.237023e+07     30s
Concurrent spin time: 2.49s

Solved with dual simplex

Root relaxation: objective 2.206237e+04, 60397 iterations, 32.22 seconds (62.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22062.3698    0  279 -210563.59 22062.3698   110%     -   34s
H    0     0                    -201809.5016 22062.3698   111%     -   34s
H    0     0                    -37130.05599 22062.3698   159%     -   34s
H    0     0                    -24414.86803 22062.3698   190%     -   34s
H    0     0                    -17120.57003 22062.3698   229%     -   34s
H    0     0                    -4980.019658 22062.3698   543%     -   34s
H    0     0                    -4042.852826 22062.3698   646%     -   34s
H    0     0                    -4040.314593 22062.3698   646%     -   34s
H    0     0                    -3988.806038 22062.3698   653%     -   35s
H    0     0                    -3970.220785 15854.8017   499%     -   50s
H    0     0                    -3969.138795 15854.8017   499%     -   50s
     0     0 15674.4614    0  422 -3969.1388 15674.4614   495%     -   50s
     0     0 15507.0218    0  430 -3969.1388 15507.0218   491%     -   54s
     0     0 15507.0218    0  432 -3969.1388 15507.0218   491%     -   55s
     0     0 15313.4614    0  438 -3969.1388 15313.4614   486%     -   57s
     0     0 15306.9796    0  434 -3969.1388 15306.9796   486%     -   59s
     0     0 15306.9796    0  439 -3969.1388 15306.9796   486%     -   61s
     0     0 15306.9796    0  444 -3969.1388 15306.9796   486%     -   62s
     0     0 15295.7385    0  449 -3969.1388 15295.7385   485%     -   64s
     0     0 15295.6694    0  449 -3969.1388 15295.6694   485%     -   64s
H    0     0                    -3954.164890 15295.6694   487%     -   65s
H    0     0                    -3930.682899 12188.3187   410%     -   80s
     0     0 12188.3187    0  466 -3930.6829 12188.3187   410%     -   80s
     0     0 11683.6444    0  524 -3930.6829 11683.6444   397%     -   90s
     0     0 11620.0353    0  538 -3930.6829 11620.0353   396%     -   95s
     0     0 11519.8191    0  471 -3930.6829 11519.8191   393%     -   99s
H    0     0                    -3921.268957 11381.8878   390%     -  105s
     0     0 11381.8878    0  465 -3921.2690 11381.8878   390%     -  105s
     0     0 11359.1162    0  460 -3921.2690 11359.1162   390%     -  108s
     0     0 11138.8340    0  467 -3921.2690 11138.8340   384%     -  114s
     0     0 11103.5997    0  464 -3921.2690 11103.5997   383%     -  117s
     0     0 11096.6365    0  467 -3921.2690 11096.6365   383%     -  118s
     0     0 11082.5689    0  471 -3921.2690 11082.5689   383%     -  120s
     0     0 11077.1748    0  475 -3921.2690 11077.1748   382%     -  121s
     0     0 11074.5720    0  477 -3921.2690 11074.5720   382%     -  121s
     0     0 11068.2689    0  477 -3921.2690 11068.2689   382%     -  122s
     0     0 11068.2329    0  477 -3921.2690 11068.2329   382%     -  122s
H    0     0                    -3907.829980 11068.2329   383%     -  131s
H    0     0                    -3782.452243 9157.89220   342%     -  159s
     0     0 9157.89220    0  449 -3782.4522 9157.89220   342%     -  159s
     0     0 8609.96950    0  498 -3782.4522 8609.96950   328%     -  172s
     0     0 8477.43244    0  455 -3782.4522 8477.43244   324%     -  180s
     0     0 8104.85540    0  503 -3782.4522 8104.85540   314%     -  190s
     0     0 7940.08440    0  505 -3782.4522 7940.08440   310%     -  196s
     0     0 7916.55443    0  510 -3782.4522 7916.55443   309%     -  199s
     0     0 7906.33201    0  505 -3782.4522 7906.33201   309%     -  202s
     0     0 7903.11950    0  457 -3782.4522 7903.11950   309%     -  204s
     0     0 7901.33711    0  458 -3782.4522 7901.33711   309%     -  205s
     0     0 6774.90802    0  532 -3782.4522 6774.90802   279%     -  235s
H    0     0                    -3764.640596 6459.03699   272%     -  249s
     0     0 6459.03699    0  455 -3764.6406 6459.03699   272%     -  249s
     0     0 6326.69691    0  546 -3764.6406 6326.69691   268%     -  256s
     0     0 6061.12832    0  546 -3764.6406 6061.12832   261%     -  270s
     0     0 5999.17354    0  556 -3764.6406 5999.17354   259%     -  277s
     0     0 5963.12846    0  557 -3764.6406 5963.12846   258%     -  282s
     0     0 5909.05946    0  560 -3764.6406 5909.05946   257%     -  286s
     0     0 5882.24756    0  546 -3764.6406 5882.24756   256%     -  289s
     0     0 5874.14845    0  543 -3764.6406 5874.14845   256%     -  291s
     0     0 5870.28787    0  548 -3764.6406 5870.28787   256%     -  293s
     0     0 5864.97820    0  551 -3764.6406 5864.97820   256%     -  294s
     0     0 5860.18343    0  556 -3764.6406 5860.18343   256%     -  295s
     0     0 5859.39286    0  561 -3764.6406 5859.39286   256%     -  296s
     0     0 5687.75482    0  469 -3764.6406 5687.75482   251%     -  307s
     0     0 5615.94460    0  476 -3764.6406 5615.94460   249%     -  313s
     0     0 5595.80831    0  486 -3764.6406 5595.80831   249%     -  317s
     0     0 5588.63670    0  491 -3764.6406 5588.63670   248%     -  319s
     0     0 5585.09458    0  491 -3764.6406 5585.09458   248%     -  319s
     0     0 5582.14255    0  490 -3764.6406 5582.14255   248%     -  321s
     0     0 5581.06702    0  501 -3764.6406 5581.06702   248%     -  321s
     0     0 5533.30490    0  492 -3764.6406 5533.30490   247%     -  326s
     0     0 5524.85094    0  492 -3764.6406 5524.85094   247%     -  330s
     0     0 5520.36134    0  489 -3764.6406 5520.36134   247%     -  331s
     0     0 5513.49311    0  480 -3764.6406 5513.49311   246%     -  334s
     0     0 5510.86707    0  485 -3764.6406 5510.86707   246%     -  335s
     0     0 5485.60764    0  468 -3764.6406 5485.60764   246%     -  340s
     0     0 5481.64181    0  484 -3764.6406 5481.64181   246%     -  341s
     0     0 5478.06503    0  485 -3764.6406 5478.06503   246%     -  343s
     0     0 5477.17142    0  489 -3764.6406 5477.17142   245%     -  343s
     0     0 5442.08583    0  480 -3764.6406 5442.08583   245%     -  348s
     0     0 5434.84205    0  495 -3764.6406 5434.84205   244%     -  351s
     0     0 5429.66131    0  488 -3764.6406 5429.66131   244%     -  352s
     0     0 5427.39595    0  489 -3764.6406 5427.39595   244%     -  354s
     0     0 5402.38073    0  499 -3764.6406 5402.38073   244%     -  358s
     0     0 5397.98629    0  494 -3764.6406 5397.98629   243%     -  360s
     0     0 5396.56809    0  492 -3764.6406 5396.56809   243%     -  361s
     0     0 5386.64705    0  501 -3764.6406 5386.64705   243%     -  364s
     0     0 5382.94714    0  491 -3764.6406 5382.94714   243%     -  366s
     0     0 5381.24688    0  496 -3764.6406 5381.24688   243%     -  368s
     0     0 5377.16857    0  494 -3764.6406 5377.16857   243%     -  369s
     0     0 5376.95510    0  494 -3764.6406 5376.95510   243%     -  372s
     0     2 5376.84350    0  494 -3764.6406 5376.84350   243%     -  419s
     1     3 5239.70358    1  463 -3764.6406 5376.45433   243%  6988  425s
     2     6 4789.34340    2  435 -3764.6406 5376.45433   243%  7242  431s
     5    12 4207.52917    3  420 -3764.6406 5252.57249   240%  6665  446s
    11    24 4123.91153    4  425 -3764.6406 5206.69742   238%  7997  460s
    23    36 3289.16122    4  455 -3764.6406 5174.27629   237% 10060  594s
    35    68 1608.69049    6  372 -3764.6406 5174.27629   237% 13532  636s
    67   151 1538.97877    7  371 -3764.6406 4974.36818   232% 13811  655s
   150   230     cutoff    9      -3764.6406 4974.36818   232%  8462  667s
   233   307     cutoff   10      -3764.6406 4974.36818   232%  6849  678s
   322   339 -616.24939   14  264 -3764.6406 4974.36818   232%  5914  689s
   366   378 -2763.5736   15  326 -3764.6406 4974.36818   232%  5687  702s
   417   404     cutoff   17      -3764.6406 4974.36818   232%  5512  711s
   455   445 -517.88187   16  249 -3764.6406 4974.36818   232%  5406  722s
   502   480 infeasible   18      -3764.6406 4787.51847   227%  5510  732s
   553   524 -3051.0090   20  333 -3764.6406 4787.51847   227%  5495  745s
   624   559 -3146.1790   24  345 -3764.6406 4787.51847   227%  5295  759s
   685   599 -3554.9233   27  272 -3764.6406 4787.51847   227%  5126  770s
   753   632     cutoff   29      -3764.6406 4787.51847   227%  5002  782s
   824   690 -2817.4274   18  117 -3764.6406 4787.51847   227%  4834  792s
   903   717 -3194.2652   24  109 -3764.6406 4787.51847   227%  4686  803s
   964   770     cutoff   28      -3764.6406 4787.51847   227%  4613  812s
  1050   833 3604.50360   10  445 -3764.6406 4787.51847   227%  4492  823s
  1135   918 2431.03457   11  412 -3764.6406 4787.51847   227%  4440  832s
  1244   959     cutoff   28      -3764.6406 4513.41808   220%  4322  842s
  1299  1013 1177.47020   12  351 -3764.6406 4513.41808   220%  4294  853s
  1393  1081  997.73220   13  316 -3764.6406 4513.41808   220%  4233  863s
  1510  1136 -100.07786   15  160 -3764.6406 4513.41808   220%  4146  875s
  1632  1214 -1549.0430   21  111 -3764.6406 4513.41808   220%  4040  886s
  1750  1287 -3624.1486   32  109 -3764.6406 4513.41808   220%  4019  898s
  1872  1372 -1211.9191   13  338 -3764.6406 4453.25558   218%  4012  912s
  2010  1420  765.23804   14  359 -3764.6406 4453.25558   218%  3966  926s
  2139  1452     cutoff   15      -3764.6406 4453.25558   218%  3970  940s
  2240  1520 -1681.9501   15  322 -3764.6406 4453.25558   218%  4032  952s
  2336  1561 -2087.7566   16  283 -3764.6406 4435.74238   218%  4067  966s
  2444  1617     cutoff   17      -3764.6406 4435.74238   218%  4031  982s
  2556  1691     cutoff   18      -3764.6406 4435.74238   218%  4013  997s
  2688  1764 2031.52216   10  369 -3764.6406 3933.27595   204%  4034 1011s
  2839  1815  535.49215   12  324 -3764.6406 3933.27595   204%  4033 1029s
  2994  1878 -1292.2606   14  245 -3764.6406 3933.27595   204%  4049 1045s
  3126  1928     cutoff   15      -3764.6406 3933.27595   204%  4093 1062s
  3196  1998     cutoff   15      -3764.6406 3604.27886   196%  4180 1078s
  3278  2072 -2470.8881   16  242 -3764.6406 3604.27886   196%  4241 1096s
  3393  2162 -3049.7837   24  168 -3764.6406 3604.27886   196%  4242 1115s
  3534  2203 2416.27327    9  406 -3764.6406 3537.56740   194%  4224 1134s
  3646  2287 2220.48172   10  392 -3764.6406 3537.56740   194%  4188 1154s
  3798  2372  632.73989   11  349 -3764.6406 3537.56740   194%  4185 1173s
  3987  2446 infeasible   13      -3764.6406 3320.20421   188%  4209 1200s
  4110  2589 -2464.5956   17  212 -3764.6406 3311.74575   188%  4238 1225s
  4341  2590 2225.17959   13  494 -3764.6406 3311.74575   188%  4225 1305s
  4343  2591 -2990.1165   26  265 -3764.6406 3311.74575   188%  4223 1347s
  4344  2592 -2914.2599   20  466 -3764.6406 3311.74575   188%  4222 1380s
  4345  2593 -3081.6855   16  499 -3764.6406 3311.74575   188%  4221 1412s
  4346  2593 1788.75406   12  507 -3764.6406 3311.74575   188%  4220 1430s
  4347  2594 -358.40175   13  439 -3764.6406 3311.74575   188%  4219 1447s
  4348  2595 -1755.8419   15  498 -3764.6406 3311.74575   188%  4218 1457s
  4349  2595 1178.28456   17  504 -3764.6406 3311.74575   188%  4217 1468s
  4350  2596 -3178.7064   33  517 -3764.6406 3311.74575   188%  4216 1472s
  4351  2597  408.63750   10  528 -3764.6406 3311.74575   188%  4215 1479s
  4352  2597 2486.89381    8  482 -3764.6406 3311.74575   188%  4214 1482s
  4353  2598  566.24175   15  528 -3764.6406 3311.74575   188%  4213 1488s
  4354  2599 -307.04977    8  540 -3764.6406 3311.74575   188%  4212 1493s
  4355  2599 -1495.5346   22  477 -3764.6406 3311.74575   188%  4211 1498s
  4356  2600 -3557.6586   28  496 -3764.6406 3311.74575   188%  4211 1501s
  4357  2601 -1079.0622   16  502 -3764.6406 3311.74575   188%  4210 1505s
  4359  2602 -1176.2138   23  614 -3764.6406 3311.74575   188%  4208 1521s
  4360  2603 -1545.0726   24  502 -3764.6406 3311.74575   188%  4207 1525s
  4362  2604 -1861.7446   33  567 -3764.6406 3311.74575   188%  4205 1531s
  4363  2605 -167.69831   17  571 -3764.6406 3311.74575   188%  4204 1541s
  4365  2606 -3269.5873   35  557 -3764.6406 3311.74575   188%  4202 1546s
  4366  2607 -1880.2107   23  492 -3764.6406 3311.74575   188%  4201 1550s
  4367  2607 -2681.4738   19  493 -3764.6406 3311.74575   188%  4200 1556s
  4368  2608  912.91907   18  498 -3764.6406 3311.74575   188%  4199 1561s
  4369  2609 -3555.3393   28  491 -3764.6406 3311.74575   188%  4198 1567s
  4370  2609   20.44567   10  489 -3764.6406 3311.74575   188%  4197 1570s
  4371  2610 -2935.6949   23  496 -3764.6406 3311.74575   188%  4196 1577s
  4372  2611 1583.27624   12  486 -3764.6406 3311.74575   188%  4195 1580s
  4373  2611 -1829.9424   26  476 -3764.6406 3311.74575   188%  4194 1586s
  4374  2612 -1751.8691   17  486 -3764.6406 3311.74575   188%  4193 1590s
  4375  2613 -3030.9245   36  503 -3764.6406 3311.74575   188%  4192 1597s
  4376  2613 -1934.5679   13  496 -3764.6406 3311.74575   188%  4191 1600s
  4377  2614 -3085.9950   20  492 -3764.6406 3311.74575   188%  4190 1605s
  4379  2615 2050.43894   16  502 -3764.6406 3311.74575   188%  4188 1612s
  4380  2616 -1585.1556   27  502 -3764.6406 3311.74575   188%  4187 1652s
  4381  2617 -3194.6302   36  502 -3764.6406 3311.74575   188%  4186 1685s
  4382  2620 3311.74575   10  506 -3764.6406 3311.74575   188%  4254 1731s
  4384  2624 3311.74575   11  500 -3764.6406 3311.74575   188%  4255 1745s
  4388  2630 3311.74575   12  567 -3764.6406 3311.74575   188%  4258 1763s
  4396  2644 3311.74575   13  581 -3764.6406 3311.74575   188%  4262 1784s
  4412  2652 -3060.4165   14  207 -3764.6406 3311.74575   188%  4299 1819s
  4430  2668 2566.64229   15  430 -3764.6406 3311.74575   188%  4320 1837s
  4462  2755 2426.36037   16  444 -3764.6406 3311.74575   188%  4346 1854s
  4565  2768 2010.70355   19  428 -3764.6406 3311.74575   188%  4344 1867s
  4646  2764 1467.60034   19  429 -3764.6406 3311.74575   188%  4344 1879s
  4682  2784  356.04131   17  195 -3764.6406 3311.74575   188%  4351 1891s
  4729  2796 1616.99514   20  432 -3764.6406 3311.74575   188%  4352 1909s
  4785  2796 1405.35909   21  426 -3764.6406 3311.74575   188%  4343 1928s
  4853  2780  924.29921   22  393 -3764.6406 3311.74575   188%  4331 1943s
  4928  2765  543.53044   23  333 -3764.6406 3311.74575   188%  4340 1960s
  4997  2756 -1452.1265   25  318 -3764.6406 3311.74575   188%  4352 1971s
  5037  2754 -1325.7877   24  355 -3764.6406 3311.74575   188%  4364 1982s
  5086  2755 -890.73571   15  394 -3764.6406 3311.74575   188%  4374 1995s
  5128  2755 -3632.7454   26  202 -3764.6406 3311.74575   188%  4380 2006s
  5180  2756 -1405.0712   25  348 -3764.6406 3311.74575   188%  4395 2020s
  5240  2759  479.90129   18  384 -3764.6406 3311.74575   188%  4413 2032s
  5290  2758  205.52176   19  396 -3764.6406 3311.74575   188%  4417 2043s
  5352  2758 -1086.0840   20  366 -3764.6406 3311.74575   188%  4409 2055s
  5409  2757 -3527.0583   21  237 -3764.6406 3311.74575   188%  4415 2074s
  5452  2754     cutoff   22      -3764.6406 3311.74575   188%  4422 2088s
  5509  2756  -83.78064   21  406 -3764.6406 3311.74575   188%  4435 2101s
  5569  2768 -427.19778   22  399 -3764.6406 3311.74575   188%  4435 2114s
  5637  2771     cutoff   24      -3764.6406 3311.74575   188%  4443 2128s
  5717  2765 -2419.2041   24  344 -3764.6406 3311.74575   188%  4441 2150s
  5756  2768 -3205.1930   25  277 -3764.6406 3311.74575   188%  4449 2164s
  5797  2774     cutoff   26      -3764.6406 3311.74575   188%  4466 2179s
  5845  2780 -3060.4960   25  340 -3764.6406 3311.74575   188%  4480 2194s
  5891  2781     cutoff   26      -3764.6406 3311.74575   188%  4503 2210s
  5968  2779  685.74777   20  382 -3764.6406 3171.84897   184%  4500 2226s
  6032  2776 -612.28449   21  345 -3764.6406 3171.53429   184%  4509 2242s
  6094  2785 -782.16897   22  349 -3764.6406 3171.53429   184%  4520 2259s
  6157  2792   37.03078   21  309 -3764.6406 3171.53429   184%  4532 2276s
  6232  2795 -2057.1794   23  350 -3764.6406 3171.53429   184%  4535 2297s
  6316  2793 -1301.3631   23  247 -3764.6406 3171.53429   184%  4541 2318s
  6393  2785     cutoff   24      -3764.6406 2611.64582   169%  4557 2337s
  6473  2782 -1863.0897   24  316 -3764.6406 2610.60301   169%  4587 2356s
  6551  2765 -1008.6853   22  329 -3764.6406 2610.60301   169%  4587 2377s
  6674  2762     cutoff   25      -3764.6406 2610.60301   169%  4580 2400s
  6809  2730     cutoff   26      -3764.6406 2383.80511   163%  4584 2422s
  6984  2720  140.10679   19  406 -3764.6406 2019.75058   154%  4582 2448s
  7113  2719 -1743.5638   23  292 -3764.6406 1815.45365   148%  4609 2476s
  7275  2708 -3131.4643   27  253 -3764.6406 1815.45365   148%  4637 2502s
  7459  2705 -120.23912   20  395 -3764.6406 1265.99409   134%  4664 2530s
  7675  2667 -3616.6444   26  309 -3764.6406 1031.06822   127%  4663 2557s
  7833  2687     cutoff   20      -3764.6406 1001.78922   127%  4676 2583s
  8037  2686 -2211.7756   24  353 -3764.6406  985.80810   126%  4667 2613s
  8325  2638 -3465.3382   30  155 -3764.6406  972.72168   126%  4626 2640s
  8556  2597 -2508.8540   23  272 -3764.6406  668.44809   118%  4646 2669s
  8801  2520 -1954.0599   22  423 -3764.6406  602.58671   116%  4670 2692s
  8858  2497 -3020.2929   23  324 -3764.6406  602.58671   116%  4677 2719s
  8927  2490     cutoff   24      -3764.6406  602.58671   116%  4682 2744s
  9073  2468     cutoff   25      -3764.6406  522.95128   114%  4666 2777s
  9333  2425 -3389.2226   29  151 -3764.6406  462.72977   112%  4637 2813s
  9613  2345 -2053.7563   19  391 -3764.6406  282.26998   107%  4632 2851s
  9933  2245     cutoff   24      -3764.6406  159.76347   104%  4645 2888s
 10279  2165 -3494.3136   24  185 -3764.6406  146.84407   104%  4660 2927s
 10688  2048 -2523.3477   22  231 -3764.6406 -133.18573  96.5%  4641 2965s
 11089  1898     cutoff   25      -3764.6406 -198.74673  94.7%  4652 3006s
 11459  1771 -3720.4244   38  140 -3764.6406 -384.57395  89.8%  4669 3046s
 11889  1585     cutoff   25      -3764.6406 -521.76745  86.1%  4675 3089s
 12368  1435 -3260.6442   21  395 -3764.6406 -767.59415  79.6%  4674 3133s
 12913  1374 -2268.7426   35  137 -3764.6406 -874.93340  76.8%  4649 3188s
 13452  1380 -2863.1614   60  147 -3764.6406 -1061.1188  71.8%  4646 3223s
 13512  1376 -2919.5747   62  136 -3764.6406 -1061.1188  71.8%  4651 3265s
 13779  1283 -2982.2568   63  205 -3764.6406 -1141.5493  69.7%  4622 3311s
 14301  1354 -3545.8815   92   35 -3764.6406 -1345.9781  64.2%  4609 3362s
H14360  1354                    -3626.239052 -1345.9781  62.9%  4590 3362s
*14692  1354             138    -3600.810261 -1456.0351  59.6%  4551 3362s
*14982  1354             131    -3591.507518 -1456.0351  59.5%  4494 3362s
 15334  1583     cutoff  139      -3591.5075 -1456.0351  59.5%  4460 3408s
 16837  2437     cutoff   27      -3591.5075 -1677.0052  53.3%  4182 3445s
H17193  2437                    -3587.165574 -1892.4240  47.2%  4105 3445s
*17427  2437             118    -3580.222169 -1912.7236  46.6%  4059 3445s
*17863  2437             133    -3497.279634 -1912.7236  45.3%  3974 3445s
H18156  2437                    -3472.450437 -1990.7372  42.7%  3920 3445s
 19268  3795 -3426.0284   39  143 -3472.4504 -2435.1337  29.9%  3722 3457s
H19404  3726                    -3397.132304 -2435.1337  28.3%  3697 3457s
H20720  3726                    -3375.308929 -2613.0821  22.6%  3471 3457s
 22276  5386     cutoff   97      -3375.3089 -2884.3171  14.5%  3237 3465s
H22317  5345                    -3370.700795 -2884.3171  14.4%  3231 3465s
*22348  4625             128    -3289.172547 -2884.3171  12.3%  3227 3465s
*24169  4269             120    -3239.276069 -2904.3530  10.3%  2990 3465s
 25860  5062     cutoff   96      -3239.2761 -2909.5988  10.2%  2801 3473s
 30180  7111     cutoff   93      -3239.2761 -2985.1447  7.85%  2414 3486s
*31320  6167             119    -3201.881410 -2987.4644  6.70%  2329 3486s
 36634  6452 -3193.8375   89   14 -3201.8814 -3034.2487  5.24%  2006 3490s
*37245  4621             115    -3165.497179 -3035.4352  4.11%  1975 3490s
 39489  4431 -3139.2169   70   84 -3165.4972 -3053.9705  3.52%  1868 3496s
 42793  4108 -3116.5250   75   52 -3165.4972 -3081.7550  2.65%  1731 3501s
 46728  3032 -3129.4756   83   36 -3165.4972 -3104.0338  1.94%  1592 3508s
 48929  2124     cutoff   76      -3165.4972 -3119.4687  1.45%  1523 3511s
*49724  1698              99    -3159.210221 -3120.9883  1.21%  1500 3511s
*52132   159             100    -3158.860075 -3134.4862  0.77%  1433 3514s
 53546     0     cutoff   82      -3158.8601 -3147.2230  0.37%  1396 3515s

Cutting planes:
  Gomory: 1
  Projected implied bound: 54
  MIR: 1771
  Mixing: 4
  Flow cover: 2445
  Zero half: 4
  RLT: 20
  Relax-and-lift: 167

Explored 53795 nodes (75173058 simplex iterations) in 3515.75 seconds (9700.97 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3158.86 -3158.86 -3159.21 ... -3397.13
No other solutions better than -3158.86

Optimal solution found (tolerance 1.00e-04)
Best objective -3.158860074714e+03, best bound -3.158860074714e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3515.79s
  Master Objective (UB) = -3158.86, θ = 110847.22
  Upper Bound (UB) = -3158.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110847.22
  [DEBUG]   ✓ Scenario 0: θ = 110847.22 ≤ Q = 130509.92 (slack: 19662.70)
  [DEBUG]   ✓ Scenario 1: θ = 110847.22 ≤ Q = 110848.21 (slack: 0.99)
  [DEBUG]   ✓ Scenario 2: θ = 110847.22 ≤ Q = 113142.12 (slack: 2294.90)
  [DEBUG]   ✓ Scenario 3: θ = 110847.22 ≤ Q = 110847.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110847.22 ≤ Q = 122992.19 (slack: 12144.96)
  [DEBUG]   ✓ Scenario 5: θ = 110847.22 ≤ Q = 113011.08 (slack: 2163.85)
  [DEBUG]   ✓ Scenario 6: θ = 110847.22 ≤ Q = 110847.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110847.22 ≤ Q = 110847.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110847.22 ≤ Q = 112416.49 (slack: 1569.27)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x54d3ed82
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x54d3ed82
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.183564e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6213572.8477
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.151739e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115173.91    0  122 6213572.85 -115173.91   102%     -    0s
H    0     0                    -82476.70777 -115173.91  39.6%     -    0s
H    0     0                    -82914.80536 -115173.91  38.9%     -    0s
     0     0 -88020.598    0   91 -82914.805 -88020.598  6.16%     -    0s
H    0     0                    -84412.21363 -88000.343  4.25%     -    0s
     0     0 -87745.088    0   92 -84412.214 -87745.088  3.95%     -    0s
H    0     0                    -86428.44190 -87735.868  1.51%     -    0s
     0     0 -87694.241    0   92 -86428.442 -87694.241  1.46%     -    0s
     0     0 -87442.335    0   93 -86428.442 -87442.335  1.17%     -    0s
     0     0 -87422.936    0   93 -86428.442 -87422.936  1.15%     -    0s
     0     0 -87292.810    0   96 -86428.442 -87292.810  1.00%     -    0s
     0     0 -87290.700    0   96 -86428.442 -87290.700  1.00%     -    0s
H    0     0                    -86432.60640 -87283.461  0.98%     -    0s
     0     2 -87283.461    0   96 -86432.606 -87283.461  0.98%     -    0s
H   37    19                    -86479.14486 -87009.522  0.61%  13.8    0s
H   40    17                    -86520.29845 -87009.522  0.57%  14.2    0s
H  426   220                    -86531.22864 -86923.671  0.45%   6.5    0s
H  431   220                    -86561.14166 -86923.671  0.42%   6.5    0s
* 1355    39              16    -86572.38223 -86628.491  0.06%   6.3    0s

Cutting planes:
  Gomory: 46
  Implied bound: 6
  MIR: 209
  RLT: 3
  BQP: 1

Explored 1519 nodes (10067 simplex iterations) in 0.12 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -86572.4 -86561.1 -86531.2 ... -82476.7
No other solutions better than -86572.4

Optimal solution found (tolerance 1.00e-04)
Best objective -8.657238222557e+04, best bound -8.657238222557e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 109567.71
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -86572.38
  [DEBUG]   S×d_nominal = 196140.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 196140.10 + -86572.38 = 109567.71
  [DEBUG]   Current θ from Master = 110847.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1279.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4438.37
  Lower Bound (LB) = -4438.37
  Gap (UB-LB) = 1279.5104, Absolute Gap = 1279.5104, Relative Gap = 0.405054
  Not converged yet (gap = 1279.51 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437919 nonzeros
Model fingerprint: 0x992942e7
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67790 rows and 27530 columns
Presolve time: 1.27s
Presolved: 86493 rows, 37130 columns, 527909 nonzeros
Variable types: 34871 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -380917.6525
Found heuristic solution: objective -354329.1377
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.659e+06
 Factor NZ  : 7.898e+06 (roughly 110 MB of memory)
 Factor Ops : 1.328e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -9.02076696e+06  1.37835454e+08  4.99e+04 2.51e+01  4.03e+04     2s
   1  -6.77441980e+06  1.15798591e+08  3.41e+04 4.45e+01  2.72e+04     2s
   2  -2.70257382e+06  8.94487599e+07  1.24e+04 1.62e+01  1.03e+04     2s
   3  -5.52711163e+05  4.87324827e+07  8.17e+02 4.52e-01  9.09e+02     3s
   4  -3.85325273e+05  3.06686485e+07  2.32e+02 2.31e-01  3.53e+02     3s
   5  -3.15992587e+05  2.00069565e+07  1.05e+02 1.36e-01  1.92e+02     3s
   6  -2.21002773e+05  1.43555355e+07  2.95e+01 9.11e-02  1.08e+02     3s
   7  -1.53182755e+05  9.02355749e+06  7.29e+00 5.42e-02  6.07e+01     3s
   8  -1.10667600e+05  5.67930073e+06  4.05e+00 3.29e-02  3.76e+01     3s
   9  -8.17378882e+04  3.32143970e+06  2.50e+00 1.86e-02  2.18e+01     3s
  10  -5.70559803e+04  8.13001225e+05  1.46e+00 4.22e-03  5.56e+00     3s
  11  -2.74623182e+04  3.60066382e+05  7.88e-01 1.79e-03  2.46e+00     3s
  12  -1.56663258e+04  1.77550118e+05  4.61e-01 1.01e-03  1.22e+00     3s
  13  -8.76944400e+03  1.18787734e+05  3.34e-01 1.18e-03  8.07e-01     3s
  14  -1.91862407e+03  8.07601771e+04  2.36e-01 1.25e-03  5.23e-01     3s
  15   1.32414487e+03  6.56929653e+04  2.00e-01 1.48e-03  4.07e-01     3s
  16   5.00128671e+03  5.06487837e+04  1.61e-01 2.13e-03  2.89e-01     3s
  17   8.59070659e+03  4.18926086e+04  1.26e-01 1.79e-03  2.10e-01     3s
  18   1.21822051e+04  3.69823504e+04  9.24e-02 1.94e-03  1.57e-01     3s
  19   1.50565734e+04  3.33984127e+04  6.64e-02 1.51e-03  1.16e-01     3s
  20   1.63551867e+04  3.14382075e+04  5.56e-02 1.79e-03  9.53e-02     3s
  21   1.78801786e+04  3.02906545e+04  4.29e-02 2.28e-03  7.84e-02     3s
  22   1.94310333e+04  2.73486304e+04  3.06e-02 3.16e-03  5.00e-02     3s
  23   2.06318181e+04  2.70600188e+04  2.15e-02 2.97e-03  4.06e-02     3s
  24   2.13993539e+04  2.55626989e+04  1.60e-02 1.58e-03  2.63e-02     4s
  25   2.18551848e+04  2.49561983e+04  1.28e-02 1.01e-03  1.96e-02     4s
  26   2.22109235e+04  2.46018913e+04  1.03e-02 7.40e-04  1.51e-02     4s
  27   2.25808278e+04  2.44199770e+04  7.79e-03 5.58e-04  1.16e-02     4s
  28   2.28205893e+04  2.42505198e+04  6.07e-03 4.20e-04  9.03e-03     4s
  29   2.29925123e+04  2.40207903e+04  4.88e-03 2.29e-04  6.50e-03     4s
  30   2.31781807e+04  2.39202211e+04  3.60e-03 1.48e-04  4.69e-03     4s
  31   2.33547053e+04  2.38427768e+04  2.41e-03 1.57e-04  3.09e-03     4s
  32   2.35093109e+04  2.38054018e+04  1.38e-03 9.49e-05  1.87e-03     4s
  33   2.35750060e+04  2.37965132e+04  9.39e-04 8.39e-05  1.40e-03     4s
  34   2.36137662e+04  2.37755869e+04  6.86e-04 5.94e-05  1.02e-03     4s
  35   2.36344378e+04  2.37729514e+04  5.60e-04 5.60e-05  8.75e-04     4s
  36   2.36585750e+04  2.37523176e+04  4.06e-04 2.78e-05  5.92e-04     4s
  37   2.36910441e+04  2.37377677e+04  2.02e-04 1.95e-05  2.95e-04     4s
  38   2.37115403e+04  2.37328290e+04  7.80e-05 1.46e-05  1.34e-04     4s
  39   2.37160965e+04  2.37305322e+04  5.13e-05 9.90e-06  9.11e-05     4s
  40   2.37228337e+04  2.37259742e+04  1.28e-05 6.52e-07  1.98e-05     5s
  41   2.37240779e+04  2.37256325e+04  6.54e-06 1.66e-06  9.82e-06     5s
  42   2.37254048e+04  2.37254483e+04  1.83e-07 8.99e-08  2.75e-07     5s
  43   2.37254106e+04  2.37254456e+04  1.57e-07 6.39e-10  2.21e-07     5s
  44   2.37254240e+04  2.37254452e+04  4.39e-07 8.58e-10  1.34e-07     5s
  45   2.37254255e+04  2.37254451e+04  4.01e-07 1.57e-08  1.25e-07     5s
  46   2.37254295e+04  2.37254450e+04  3.60e-07 1.23e-08  9.83e-08     5s
  47   2.37254405e+04  2.37254446e+04  1.54e-07 2.31e-07  2.63e-08     5s
  48   2.37254412e+04  2.37254446e+04  6.17e-07 1.89e-07  2.12e-08     5s
  49   2.37254430e+04  2.37254446e+04  1.25e-06 1.06e-07  1.06e-08     5s
  50   2.37254430e+04  2.37254446e+04  1.25e-06 1.04e-07  1.02e-08     5s
  51   2.37254430e+04  2.37254446e+04  1.17e-06 1.04e-07  1.02e-08     5s
  52   2.37254432e+04  2.37254446e+04  1.97e-06 1.02e-07  7.44e-09     5s
  53   2.37254434e+04  2.37254446e+04  2.99e-06 8.86e-08  6.36e-09     5s
  54   2.37254434e+04  2.37254446e+04  2.97e-06 8.88e-08  6.36e-09     5s
  55   2.37254434e+04  2.37254446e+04  2.95e-06 8.84e-08  6.35e-09     5s

Barrier solved model in 55 iterations and 5.50 seconds (8.41 work units)
Optimal objective 2.37254434e+04


Root crossover log...

   70597 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

   30431 PPushes remaining with PInf 3.7399917e-04                 8s
       0 PPushes remaining with PInf 1.7104383e-04                10s

  Push phase complete: Pinf 1.7104383e-04, Dinf 2.9441992e+04     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66356    2.3725444e+04   0.000000e+00   2.944199e+04     10s
   67165    2.3725445e+04   0.000000e+00   0.000000e+00     10s
   67165    2.3725445e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.372544e+04, 67165 iterations, 8.32 seconds (18.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 23725.4445    0  382 -210563.59 23725.4445   111%     -   10s
H    0     0                    -201809.5016 23725.4445   112%     -   10s
H    0     0                    -156675.0036 23725.4445   115%     -   10s
H    0     0                    -30360.85458 23725.4445   178%     -   10s
H    0     0                    -30279.75677 23725.4445   178%     -   10s
H    0     0                    -17841.96468 23725.4445   233%     -   10s
H    0     0                    -16952.22706 23725.4445   240%     -   11s
H    0     0                    -16605.13047 23725.4445   243%     -   11s
H    0     0                    -16581.60584 23725.4445   243%     -   11s
H    0     0                    -15867.00978 23725.4445   250%     -   13s
H    0     0                    -15180.51591 23725.4445   256%     -   13s
H    0     0                    -12929.40735 23725.4445   283%     -   13s
H    0     0                    -11559.82995 23725.4445   305%     -   13s
H    0     0                    -11317.14282 23725.4445   310%     -   13s
H    0     0                    -11316.52102 23725.4445   310%     -   13s
H    0     0                    -11294.02139 23725.4445   310%     -   13s
H    0     0                    -11231.43169 23725.4445   311%     -   13s
H    0     0                    -11207.55858 23725.4445   312%     -   13s
     0     0 18567.5775    0  410 -11207.559 18567.5775   266%     -   40s
H    0     0                    -11169.78843 18567.5775   266%     -   41s
H    0     0                    -11164.46588 18567.5775   266%     -   41s
H    0     0                    -11089.97266 18567.5775   267%     -   41s
     0     0 17401.1743    0  404 -11089.973 17401.1743   257%     -   55s
     0     0 17264.8972    0  376 -11089.973 17264.8972   256%     -   60s
     0     0 17140.8167    0  438 -11089.973 17140.8167   255%     -   66s
     0     0 17140.8167    0  442 -11089.973 17140.8167   255%     -   68s
     0     0 17140.8167    0  440 -11089.973 17140.8167   255%     -   70s
H    0     0                    -4631.600000 13889.7703   400%     -  100s
H    0     0                    -3855.780004 13889.7703   460%     -  100s
     0     0 13889.7703    0  529 -3855.7800 13889.7703   460%     -  100s
H    0     0                    -3852.895359 12724.7069   430%     -  119s
     0     0 12724.7069    0  512 -3852.8954 12724.7069   430%     -  119s
     0     0 12577.6475    0  512 -3852.8954 12577.6475   426%     -  128s
     0     0 12517.1202    0  512 -3852.8954 12517.1202   425%     -  132s
     0     0 12433.7366    0  519 -3852.8954 12433.7366   423%     -  139s
     0     0 12401.2088    0  523 -3852.8954 12401.2088   422%     -  145s
     0     0 12364.2104    0  527 -3852.8954 12364.2104   421%     -  149s
     0     0 12303.3170    0  528 -3852.8954 12303.3170   419%     -  154s
     0     0 12295.3306    0  520 -3852.8954 12295.3306   419%     -  156s
     0     0 12252.1111    0  526 -3852.8954 12252.1111   418%     -  161s
     0     0 12200.6955    0  541 -3852.8954 12200.6955   417%     -  166s
     0     0 12192.0426    0  549 -3852.8954 12192.0426   416%     -  170s
     0     0 12189.2378    0  546 -3852.8954 12189.2378   416%     -  171s
     0     0 12083.3911    0  539 -3852.8954 12083.3911   414%     -  177s
     0     0 12073.3207    0  541 -3852.8954 12073.3207   413%     -  179s
     0     0 12069.7652    0  547 -3852.8954 12069.7652   413%     -  181s
     0     0 12066.4570    0  550 -3852.8954 12066.4570   413%     -  183s
     0     0 12065.4701    0  548 -3852.8954 12065.4701   413%     -  183s
H    0     0                    -3821.879853 9955.04178   360%     -  239s
     0     0 9955.04178    0  501 -3821.8799 9955.04178   360%     -  239s
     0     0 9215.41973    0  465 -3821.8799 9215.41973   341%     -  259s
H    0     0                    -3782.452243 9084.53414   340%     -  273s
H    0     0                    -3764.640596 9084.53414   341%     -  273s
     0     0 9084.53414    0  489 -3764.6406 9084.53414   341%     -  273s
     0     0 9029.36471    0  493 -3764.6406 9029.36471   340%     -  281s
     0     0 9003.31251    0  499 -3764.6406 9003.31251   339%     -  286s
     0     0 8986.19562    0  511 -3764.6406 8986.19562   339%     -  292s
     0     0 8967.80824    0  510 -3764.6406 8967.80824   338%     -  299s
     0     0 8934.74223    0  513 -3764.6406 8934.74223   337%     -  306s
     0     0 8931.69348    0  510 -3764.6406 8931.69348   337%     -  309s
     0     0 8927.40116    0  508 -3764.6406 8927.40116   337%     -  311s
     0     0 8921.81466    0  504 -3764.6406 8921.81466   337%     -  313s
     0     0 8920.02163    0  513 -3764.6406 8920.02163   337%     -  316s
     0     0 7816.47380    0  505 -3764.6406 7816.47380   308%     -  365s
     0     0 7577.60683    0  510 -3764.6406 7577.60683   301%     -  382s
     0     0 7436.28506    0  528 -3764.6406 7436.28506   298%     -  393s
     0     0 7376.72701    0  528 -3764.6406 7376.72701   296%     -  401s
     0     0 7347.69492    0  529 -3764.6406 7347.69492   295%     -  406s
     0     0 7311.76446    0  535 -3764.6406 7311.76446   294%     -  411s
     0     0 7238.05011    0  512 -3764.6406 7238.05011   292%     -  418s
     0     0 7128.29104    0  542 -3764.6406 7128.29104   289%     -  430s
     0     0 7101.54857    0  542 -3764.6406 7101.54857   289%     -  437s
     0     0 7096.22425    0  542 -3764.6406 7096.22425   288%     -  439s
     0     0 7093.87143    0  538 -3764.6406 7093.87143   288%     -  441s
     0     0 6862.10445    0  474 -3764.6406 6862.10445   282%     -  458s
     0     0 6707.88626    0  565 -3764.6406 6707.88626   278%     -  469s
     0     0 6623.94944    0  524 -3764.6406 6623.94944   276%     -  476s
     0     0 6584.07198    0  551 -3764.6406 6584.07198   275%     -  481s
     0     0 6577.81082    0  536 -3764.6406 6577.81082   275%     -  483s
     0     0 6568.96984    0  479 -3764.6406 6568.96984   274%     -  486s
     0     0 6565.06329    0  545 -3764.6406 6565.06329   274%     -  488s
     0     0 6505.31811    0  548 -3764.6406 6505.31811   273%     -  495s
     0     0 6498.92840    0  480 -3764.6406 6498.92840   273%     -  497s
     0     0 6459.94941    0  606 -3764.6406 6459.94941   272%     -  501s
     0     0 6450.40619    0  609 -3764.6406 6450.40619   271%     -  504s
     0     0 6448.29368    0  545 -3764.6406 6448.29368   271%     -  505s
     0     0 6341.19936    0  496 -3764.6406 6341.19936   268%     -  515s
     0     0 6277.98435    0  503 -3764.6406 6277.98435   267%     -  529s
     0     0 6259.75337    0  502 -3764.6406 6259.75337   266%     -  533s
     0     0 6233.54079    0  546 -3764.6406 6233.54079   266%     -  536s
     0     0 6227.39559    0  500 -3764.6406 6227.39559   265%     -  538s
     0     0 6225.16901    0  501 -3764.6406 6225.16901   265%     -  539s
     0     0 6156.86281    0  552 -3764.6406 6156.86281   264%     -  546s
     0     0 6141.66386    0  496 -3764.6406 6141.66386   263%     -  550s
     0     0 6135.22638    0  498 -3764.6406 6135.22638   263%     -  552s
     0     0 6131.21520    0  503 -3764.6406 6131.21520   263%     -  554s
     0     0 6114.36086    0  490 -3764.6406 6114.36086   262%     -  558s
     0     0 6112.65278    0  493 -3764.6406 6112.65278   262%     -  559s
     0     0 6066.68483    0  621 -3764.6406 6066.68483   261%     -  565s
     0     0 6049.95571    0  565 -3764.6406 6049.95571   261%     -  581s
     0     0 6045.27857    0  565 -3764.6406 6045.27857   261%     -  583s
     0     0 6040.90440    0  500 -3764.6406 6040.90440   260%     -  586s
     0     0 6034.78981    0  507 -3764.6406 6034.78981   260%     -  589s
     0     0 6030.97388    0  507 -3764.6406 6030.97388   260%     -  591s
     0     0 6028.89499    0  506 -3764.6406 6028.89499   260%     -  593s
     0     0 6005.02372    0  507 -3764.6406 6005.02372   260%     -  601s
     0     0 5982.62176    0  512 -3764.6406 5982.62176   259%     -  609s
     0     0 5974.51529    0  512 -3764.6406 5974.51529   259%     -  612s
     0     0 5963.18876    0  511 -3764.6406 5963.18876   258%     -  618s
     0     0 5953.15901    0  512 -3764.6406 5953.15901   258%     -  623s
     0     0 5951.52999    0  506 -3764.6406 5951.52999   258%     -  625s
     0     0 5916.63165    0  497 -3764.6406 5916.63165   257%     -  633s
     0     0 5900.67568    0  509 -3764.6406 5900.67568   257%     -  639s
     0     0 5897.06631    0  501 -3764.6406 5897.06631   257%     -  641s
     0     0 5893.92029    0  516 -3764.6406 5893.92029   257%     -  643s
     0     0 5893.52425    0  517 -3764.6406 5893.52425   257%     -  643s
     0     0 5880.28189    0  513 -3764.6406 5880.28189   256%     -  649s
     0     0 5876.72498    0  512 -3764.6406 5876.72498   256%     -  653s
     0     0 5874.59672    0  511 -3764.6406 5874.59672   256%     -  654s
     0     0 5857.12297    0  518 -3764.6406 5857.12297   256%     -  659s
     0     0 5854.58045    0  518 -3764.6406 5854.58045   256%     -  665s
     0     0 5846.38915    0  535 -3764.6406 5846.38915   255%     -  668s
     0     0 5846.30973    0  535 -3764.6406 5846.30973   255%     -  672s
     0     2 5846.28841    0  535 -3764.6406 5846.28841   255%     -  751s
     1     3 4960.55918    1  472 -3764.6406 5846.28013   255%  8065  760s
     2     4 5745.67125    1  512 -3764.6406 5745.67125   253%  6418  768s
     3     7 4423.01297    2  491 -3764.6406 5745.62576   253%  6052  779s
     6    13 4293.76159    3  482 -3764.6406 5745.62576   253%  5333  795s
    12    25 3705.69148    4  475 -3764.6406 5722.93925   252%  8266  817s
    24    38 2077.16175    5  247 -3764.6406 5714.43498   252% 13156  853s
    37    70 3752.88898    5  442 -3764.6406 5657.43173   250% 12300 1033s
    69   113 3705.90075    6  429 -3764.6406 5476.53157   245% 15051 1064s
   112   168 3482.08604    7  414 -3764.6406 5476.17972   245% 12114 1089s
   167   257 2165.36188    8  218 -3764.6406 5476.17972   245%  9731 1113s
   258   325 2139.44172    9  222 -3764.6406 5476.17972   245%  7992 1135s
   334   382 1242.82399   11  210 -3764.6406 5476.17972   245%  7374 1152s
   412   445 -2840.3884   16  227 -3764.6406 5476.17972   245%  6894 1169s
   478   491 -3251.3769   18  208 -3764.6406 5476.17972   245%  6679 1186s
   559   539     cutoff   22      -3764.6406 5476.17972   245%  6689 1202s
   627   588   59.11268   16  302 -3764.6406 5476.17972   245%  6626 1217s
   714   624 -863.32966   18  236 -3764.6406 5476.17972   245%  6384 1233s
   794   666 -2632.9928   20  230 -3764.6406 5476.17972   245%  6300 1247s
   869   692 -2658.4674   21  313 -3764.6406 5476.17972   245%  6215 1262s
   921   723 -2730.3753   22  305 -3764.6406 5437.29900   244%  6056 1279s
  1002   739 -2956.2591   23  307 -3764.6406 5313.37817   241%  5911 1297s
  1047   799 -3084.0142   24  294 -3764.6406 5242.63948   239%  5897 1314s
  1133   851 -3373.9979   28  198 -3764.6406 5242.63948   239%  5831 1328s
  1221   903 -3499.9408   31  120 -3764.6406 5242.63948   239%  5773 1344s
  1313   927 -3604.4666   33  121 -3764.6406 5242.63948   239%  5714 1360s
  1346   951 -3625.2926   34  121 -3764.6406 5242.63948   239%  5785 1377s
  1398   983 infeasible   35      -3764.6406 5242.63948   239%  5810 1393s
  1455  1017  794.21628   10  424 -3764.6406 5242.63948   239%  5814 1414s
  1519  1048  617.84121   11  403 -3764.6406 5242.63948   239%  5785 1432s
  1584  1089  518.75034   12  398 -3764.6406 5242.63948   239%  5802 1451s
  1658  1131 -2378.3454   14  316 -3764.6406 5242.63948   239%  5814 1470s
  1755  1196 infeasible   15      -3764.6406 5242.63948   239%  5851 1491s
  1858  1267 infeasible   15      -3764.6406 5242.63948   239%  5857 1513s
  1987  1366 -2549.7454   15  187 -3764.6406 5242.63948   239%  5802 1537s
  2125  1437 -3478.3756   21  291 -3764.6406 5242.63948   239%  5757 1557s
  2295  1506 3040.92284    7  354 -3764.6406 5242.63948   239%  5649 1580s
  2461  1559  908.19192    9  334 -3764.6406 5242.63948   239%  5570 1603s
  2598  1663 -853.82695   11  272 -3764.6406 5242.63948   239%  5595 1627s
  2755  1771 -1602.8056   13  334 -3764.6406 4614.66262   223%  5616 1649s
  2973  1849 -2805.9572   15  274 -3764.6406 4614.66262   223%  5489 1676s
  3173  1871 -3571.0430   24  160 -3764.6406 4398.48273   217%  5430 1701s
  3289  1954  722.15270   12  251 -3764.6406 4183.88438   211%  5451 1729s
  3448  2029 -1870.0289   16  207 -3764.6406 4183.88438   211%  5477 1757s
  3611  2077 -3118.0554   21  199 -3764.6406 3863.61357   203%  5462 1789s
  3776  2142 infeasible   44      -3764.6406 3760.88220   200%  5501 1822s
  3932  2201  362.93189   12  133 -3764.6406 3705.67275   198%  5540 1857s
  4079  2281 -3183.0112   17   99 -3764.6406 3655.63026   197%  5637 1892s
  4258  2363 2732.93732    6  378 -3764.6406 3572.57278   195%  5711 1933s
  4489  2431 -1174.0729    9  206 -3764.6406 3568.13363   195%  5717 1968s
  4675  2511 2201.16688    8  418 -3764.6406 3545.20324   194%  5695 2005s
  4839  2567 1076.26753   10  363 -3764.6406 3545.20324   194%  5771 2050s
  5069  2635 -550.72625   15  300 -3764.6406 3456.45677   192%  5777 2090s
  5291  2791 -1883.5500   28  172 -3764.6406 3095.23111   182%  5814 2134s
  5609  2792 -2057.4036   11  535 -3764.6406 3000.36009   180%  5778 2333s
  5611  2793 -340.51453   12  405 -3764.6406 3000.36009   180%  5776 2346s
  5612  2794 1155.17722   15  488 -3764.6406 3000.36009   180%  5775 2416s
  5613  2795 1606.17278   12  434 -3764.6406 3000.36009   180%  5774 2472s
  5614  2795 -3141.8661   22  438 -3764.6406 3000.36009   180%  5773 2511s
  5615  2796 -3136.4000   52  533 -3764.6406 3000.36009   180%  5772 2554s
  5616  2797 -2446.5835   10  525 -3764.6406 3000.36009   180%  5771 2576s
  5617  2797 -3440.7303   42  528 -3764.6406 3000.36009   180%  5770 2596s
  5618  2798   34.18650    9  548 -3764.6406 3000.36009   180%  5769 2613s
  5619  2799 -3131.6030   27  495 -3764.6406 3000.36009   180%  5768 2624s
  5620  2799 -1199.5128   20  500 -3764.6406 3000.36009   180%  5766 2632s
  5621  2800 -3220.9394   46  501 -3764.6406 3000.36009   180%  5765 2640s
  5622  2801 -1122.2962   14  486 -3764.6406 3000.36009   180%  5764 2669s
  5623  2801 2568.06771   11  495 -3764.6406 3000.36009   180%  5763 2685s
  5624  2802  548.60113   19  563 -3764.6406 3000.36009   180%  5762 2697s
  5625  2803 -1447.6010   19  561 -3764.6406 3000.36009   180%  5761 2705s
  5626  2803 -1479.2750   27  544 -3764.6406 3000.36009   180%  5760 2710s
  5627  2804 -2356.8846   49  555 -3764.6406 3000.36009   180%  5759 2719s
  5628  2805 -2414.6811   22  569 -3764.6406 3000.36009   180%  5758 2726s
  5629  2805 -3107.9073   15  567 -3764.6406 3000.36009   180%  5757 2733s
  5630  2806 -2355.0703   38  490 -3764.6406 3000.36009   180%  5756 2747s
  5631  2807 -3224.5228   20  514 -3764.6406 3000.36009   180%  5755 2758s
  5632  2807 -1191.9997   16  513 -3764.6406 3000.36009   180%  5754 2765s
  5633  2808 -1759.7395   23  504 -3764.6406 3000.36009   180%  5753 2771s
  5634  2809 -3374.8288   40  497 -3764.6406 3000.36009   180%  5752 2784s
  5635  2809 -2827.1070   40  514 -3764.6406 3000.36009   180%  5751 2791s
  5636  2810  228.09293   18  587 -3764.6406 3000.36009   180%  5750 2799s
  5637  2811 -165.17878   19  518 -3764.6406 3000.36009   180%  5749 2809s
  5638  2811 -1334.3992   12  515 -3764.6406 3000.36009   180%  5748 2816s
  5639  2812 2204.08852    8  577 -3764.6406 3000.36009   180%  5747 2829s
  5640  2813 -2595.2806   58  517 -3764.6406 3000.36009   180%  5746 2834s
  5641  2813 2270.59784   12  516 -3764.6406 3000.36009   180%  5745 2841s
  5642  2814 1517.09535   11  506 -3764.6406 3000.36009   180%  5744 2847s
  5643  2815 -212.24304   20  535 -3764.6406 3000.36009   180%  5743 2854s
  5644  2815 -921.06998   24  535 -3764.6406 3000.36009   180%  5742 2880s
  5645  2816 -3163.3050   30  535 -3764.6406 3000.36009   180%  5741 2933s
  5646  2820 3000.36009   12  513 -3764.6406 3000.36009   180%  5810 2962s
  5648  2823 3000.36009   13  491 -3764.6406 3000.36009   180%  5811 2995s
  5652  2830 3000.36009   14  484 -3764.6406 3000.36009   180%  5816 3047s
  5660  2843 3000.36009   15  492 -3764.6406 3000.36009   180%  5825 3069s
  5676  2854 3000.36009   16  449 -3764.6406 3000.36009   180%  5867 3122s
  5692  2878 2507.59040   17  447 -3764.6406 3000.36009   180%  5897 3156s
  5724  2972 2232.62397   18  422 -3764.6406 3000.36009   180%  5940 3192s
  5834  2958 1959.04129   19  406 -3764.6406 3000.36009   180%  5923 3210s
  5896  2956  169.00193   19  203 -3764.6406 3000.36009   180%  5943 3226s
  5961  2945 1499.11332   20  416 -3764.6406 3000.36009   180%  5968 3261s
  6027  2956 1037.64728   21  433 -3764.6406 3000.36009   180%  5992 3288s
  6097  2932 -1115.7944   23  395 -3764.6406 3000.36009   180%  6020 3307s
  6155  2922  674.94595   20  405 -3764.6406 3000.36009   180%  6045 3323s
  6201  2918   44.66673   21  417 -3764.6406 3000.36009   180%  6066 3339s
  6248  2895 -485.65214   21  309 -3764.6406 3000.36009   180%  6080 3355s
  6295  2887 -3013.8182   27  380 -3764.6406 3000.36009   180%  6110 3370s
  6334  2877  -62.37560   22  410 -3764.6406 3000.36009   180%  6128 3386s
  6376  2868 -2315.7037   23  176 -3764.6406 3000.36009   180%  6138 3405s
  6415  2868     cutoff   25      -3764.6406 3000.36009   180%  6159 3426s
  6465  2863  254.65498   17  293 -3764.6406 3000.36009   180%  6188 3443s
  6510  2861 -357.00632   18  290 -3764.6406 3000.36009   180%  6205 3459s
  6546  2876 -1954.1899   19  273 -3764.6406 3000.36009   180%  6222 3476s
  6594  2875 -2092.9090   21  289 -3764.6406 3000.36009   180%  6238 3495s
  6655  2851 -3600.7249   22  227 -3764.6406 3000.36009   180%  6257 3513s
  6694  2837     cutoff   23      -3764.6406 3000.36009   180%  6286 3544s
  6748  2830  467.43780   24  473 -3764.6406 3000.36009   180%  6304 3570s
  6812  2851  191.54660   25  404 -3764.6406 3000.36009   180%  6335 3594s
  6879  2839 -2510.5866   27  254 -3764.6406 3000.36009   180%  6367 3600s

Cutting planes:
  Gomory: 13
  Implied bound: 21
  Projected implied bound: 252
  MIR: 1685
  Flow cover: 1986
  Zero half: 2
  RLT: 73
  Relax-and-lift: 335

Explored 6895 nodes (44522848 simplex iterations) in 3600.04 seconds (8909.74 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3764.64 -3782.45 -3821.88 ... -11207.6

Time limit reached
Best objective -3.764640595589e+03, best bound 3.000360094338e+03, gap 179.6984%
  WARNING: Time limit reached. Using best solution found (gap: 179.70%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -3764.64, θ = 119506.96
  Upper Bound (UB) = -3764.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119506.96
  [DEBUG]   ✓ Scenario 0: θ = 119506.96 ≤ Q = 119506.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119506.96 ≤ Q = 119506.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119506.96 ≤ Q = 119506.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119506.96 ≤ Q = 120730.42 (slack: 1223.45)
  [DEBUG]   ✓ Scenario 4: θ = 119506.96 ≤ Q = 119506.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119506.96 ≤ Q = 119506.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119506.96 ≤ Q = 119506.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119506.96 ≤ Q = 119848.31 (slack: 341.35)
  [DEBUG]   ✓ Scenario 8: θ = 119506.96 ≤ Q = 119506.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 119506.96 ≤ Q = 120617.71 (slack: 1110.74)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x388e3aa7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x388e3aa7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.266764e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6608144.0684
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.221236e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122123.62    0  123 6608144.07 -122123.62   102%     -    0s
H    0     0                    -89343.66683 -122123.62  36.7%     -    0s
H    0     0                    -89751.31065 -122123.62  36.1%     -    0s
     0     0 -102423.09    0   81 -89751.311 -102423.09  14.1%     -    0s
H    0     0                    -100468.3482 -102326.33  1.85%     -    0s
H    0     0                    -101183.5537 -102326.33  1.13%     -    0s
     0     0 -101779.09    0   70 -101183.55 -101779.09  0.59%     -    0s
     0     0 -101652.54    0   59 -101183.55 -101652.54  0.46%     -    0s
     0     0 -101651.74    0   59 -101183.55 -101651.74  0.46%     -    0s
     0     0 -101391.12    0   29 -101183.55 -101391.12  0.21%     -    0s
     0     0 -101390.94    0   22 -101183.55 -101390.94  0.20%     -    0s
     0     0 -101314.16    0   18 -101183.55 -101314.16  0.13%     -    0s
     0     0 -101295.70    0   15 -101183.55 -101295.70  0.11%     -    0s
     0     0 -101238.89    0    9 -101183.55 -101238.89  0.05%     -    0s
     0     0 -101238.89    0   11 -101183.55 -101238.89  0.05%     -    0s
H    0     0                    -101197.3049 -101238.89  0.04%     -    0s
     0     0 -101231.16    0    6 -101197.30 -101231.16  0.03%     -    0s
H    0     0                    -101220.9134 -101221.64  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 2
  Flow cover: 5
  Relax-and-lift: 3

Explored 1 nodes (717 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -101221 -101197 -101184 ... 1.26676e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.012209133580e+05, best bound -1.012216437534e+05, gap 0.0007%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 110305.09
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101220.91
  [DEBUG]   S×d_nominal = 211526.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211526.01 + -101220.91 = 110305.09
  [DEBUG]   Current θ from Master = 119506.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9201.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12966.51
  Lower Bound (LB) = -4438.37
  Gap (UB-LB) = 673.7299, Absolute Gap = 673.7299, Relative Gap = 0.178963
  Not converged yet (gap = 673.73 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481159 nonzeros
Model fingerprint: 0x2c6a5ac8
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74557 rows and 30277 columns
Presolve time: 1.39s
Presolved: 95016 rows, 40623 columns, 576292 nonzeros
Variable types: 38364 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -381144.4719
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.175e+06
 Factor NZ  : 9.162e+06 (roughly 130 MB of memory)
 Factor Ops : 1.631e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -9.03995612e+06  1.50363514e+08  5.01e+04 2.34e+01  4.01e+04     3s
   1  -6.77992251e+06  1.26700636e+08  3.40e+04 4.26e+01  2.70e+04     3s
   2  -2.78457179e+06  9.68346086e+07  1.29e+04 1.81e+01  1.06e+04     3s
   3  -5.93577840e+05  5.53878760e+07  9.33e+02 7.28e-01  1.00e+03     3s
   4  -4.03374124e+05  2.47721760e+07  2.58e+02 1.95e-01  3.12e+02     3s
   5  -3.33496008e+05  1.74275691e+07  1.48e+02 1.25e-01  1.89e+02     3s
   6  -1.90267502e+05  1.27508396e+07  2.92e+01 8.16e-02  8.97e+01     3s
   7  -1.25116510e+05  9.59557637e+06  1.22e+01 5.90e-02  6.11e+01     3s
   8  -9.68797141e+04  5.31664788e+06  6.58e+00 3.24e-02  3.29e+01     3s
   9  -7.54792469e+04  4.13957308e+06  4.14e+00 2.47e-02  2.51e+01     3s
  10  -6.20976142e+04  3.11708527e+06  2.79e+00 1.82e-02  1.87e+01     3s
  11  -3.65741059e+04  7.03208832e+05  1.20e+00 3.74e-03  4.30e+00     3s
  12  -2.48802377e+04  3.72849202e+05  8.20e-01 1.54e-03  2.31e+00     3s
  13  -1.33962221e+04  1.80747059e+05  4.13e-01 8.31e-04  1.12e+00     3s
  14  -8.54155218e+03  1.19055109e+05  3.12e-01 6.56e-04  7.35e-01     3s
  15  -4.69837301e+03  8.81709575e+04  2.55e-01 7.91e-04  5.35e-01     3s
  16   2.02077070e+02  5.91866230e+04  1.99e-01 1.61e-03  3.40e-01     3s
  17   3.54977449e+03  5.10270541e+04  1.68e-01 1.79e-03  2.73e-01     3s
  18   6.13779593e+03  4.50292509e+04  1.43e-01 1.90e-03  2.24e-01     4s
  19   9.08616991e+03  3.93608602e+04  1.16e-01 1.93e-03  1.74e-01     4s
  20   1.02595144e+04  3.36700412e+04  1.05e-01 1.67e-03  1.35e-01     4s
  21   1.26781736e+04  3.20441389e+04  8.46e-02 1.60e-03  1.12e-01     4s
  22   1.36345571e+04  2.95304879e+04  7.69e-02 2.09e-03  9.16e-02     4s
  23   1.50506309e+04  2.83798831e+04  6.57e-02 1.88e-03  7.68e-02     4s
  24   1.70736785e+04  2.77534553e+04  5.00e-02 1.57e-03  6.15e-02     4s
  25   1.90191660e+04  2.69838413e+04  3.53e-02 1.67e-03  4.59e-02     4s
  26   2.01554004e+04  2.60286810e+04  2.68e-02 1.17e-03  3.38e-02     4s
  27   2.05754792e+04  2.52696380e+04  2.37e-02 7.48e-04  2.70e-02     4s
  28   2.16125172e+04  2.48220221e+04  1.63e-02 4.93e-04  1.85e-02     4s
  29   2.20461531e+04  2.47021357e+04  1.33e-02 4.19e-04  1.53e-02     4s
  30   2.22820670e+04  2.45030236e+04  1.15e-02 3.52e-04  1.28e-02     4s
  31   2.24739992e+04  2.43210779e+04  1.00e-02 2.49e-04  1.06e-02     4s
  32   2.26345999e+04  2.42102344e+04  8.77e-03 1.96e-04  9.08e-03     4s
  33   2.26945547e+04  2.41849577e+04  8.32e-03 1.82e-04  8.59e-03     4s
  34   2.28652696e+04  2.41101399e+04  7.07e-03 1.42e-04  7.17e-03     4s
  35   2.30607210e+04  2.40867753e+04  5.64e-03 1.29e-04  5.91e-03     5s
  36   2.32151913e+04  2.40378492e+04  4.44e-03 1.05e-04  4.74e-03     5s
  37   2.32908688e+04  2.40006105e+04  3.88e-03 8.73e-05  4.09e-03     5s
  38   2.34447690e+04  2.39641832e+04  2.74e-03 8.13e-05  2.99e-03     5s
  39   2.34709761e+04  2.39458357e+04  2.55e-03 6.87e-05  2.74e-03     5s
  40   2.35761481e+04  2.39211007e+04  1.79e-03 5.23e-05  1.99e-03     5s
  41   2.36197910e+04  2.38943275e+04  1.47e-03 5.13e-05  1.58e-03     5s
  42   2.36801093e+04  2.38844071e+04  1.05e-03 4.29e-05  1.18e-03     5s
  43   2.37275470e+04  2.38688652e+04  7.10e-04 3.05e-05  8.14e-04     5s
  44   2.37617001e+04  2.38578392e+04  4.76e-04 2.11e-05  5.54e-04     5s
  45   2.37756496e+04  2.38474346e+04  3.78e-04 1.22e-05  4.13e-04     5s
  46   2.37915099e+04  2.38410905e+04  2.67e-04 7.02e-06  2.86e-04     5s
  47   2.38049475e+04  2.38396828e+04  1.75e-04 5.89e-06  2.00e-04     5s
  48   2.38120724e+04  2.38372798e+04  1.27e-04 4.04e-06  1.45e-04     5s
  49   2.38213814e+04  2.38333958e+04  6.44e-05 6.24e-06  6.92e-05     5s
  50   2.38278160e+04  2.38322347e+04  2.14e-05 3.20e-06  2.54e-05     5s
  51   2.38300334e+04  2.38320190e+04  8.07e-06 2.03e-06  1.14e-05     5s
  52   2.38309979e+04  2.38317560e+04  2.84e-06 6.90e-07  4.36e-06     6s
  53   2.38312387e+04  2.38317044e+04  1.64e-06 4.76e-07  2.68e-06     6s
  54   2.38315657e+04  2.38315984e+04  6.38e-08 2.00e-08  1.88e-07     6s
  55   2.38315680e+04  2.38315922e+04  1.64e-07 7.31e-09  1.39e-07     6s
  56   2.38315761e+04  2.38315904e+04  2.35e-07 3.79e-09  8.24e-08     6s
  57   2.38315798e+04  2.38315897e+04  2.11e-07 2.31e-09  5.66e-08     6s
  58   2.38315830e+04  2.38315896e+04  1.38e-07 2.29e-09  3.84e-08     6s
  59   2.38315878e+04  2.38315886e+04  3.55e-08 6.74e-08  4.68e-09     6s
  60   2.38315883e+04  2.38315885e+04  3.69e-08 3.16e-10  1.40e-09     6s
  61   2.38315885e+04  2.38315885e+04  2.06e-08 3.12e-08  2.94e-11     6s

Barrier solved model in 61 iterations and 6.34 seconds (10.28 work units)
Optimal objective 2.38315885e+04


Root crossover log...

   76790 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    2642 PPushes remaining with PInf 5.5370739e-06                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.0104852e-11      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33378    2.3831589e+04   0.000000e+00   0.000000e+00      8s
   33378    2.3831589e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 2.383159e+04, 33378 iterations, 6.51 seconds (12.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 23831.5885    0  402 -210563.59 23831.5885   111%     -    8s
H    0     0                    -205237.3384 23831.5885   112%     -    8s
H    0     0                    -23754.12885 23831.5885   200%     -    9s
H    0     0                    -16459.83084 23831.5885   245%     -    9s
H    0     0                    -16418.95005 23831.5885   245%     -    9s
H    0     0                    -15151.27701 23831.5885   257%     -   10s
H    0     0                    -15149.74645 23831.5885   257%     -   10s
H    0     0                    -14594.01490 23831.5885   263%     -   11s
H    0     0                    -13286.50925 23831.5885   279%     -   11s
H    0     0                    -12848.55835 23831.5885   285%     -   11s
H    0     0                    -11674.29622 23831.5885   304%     -   11s
H    0     0                    -11459.55887 23831.5885   308%     -   11s
     0     0 19321.1679    0  521 -11459.559 19321.1679   269%     -   33s
H    0     0                    -11409.08606 19317.1469   269%     -   34s
H    0     0                    -11399.26256 19317.1469   269%     -   34s
H    0     0                    -11393.94001 19317.1469   270%     -   34s
H    0     0                    -11331.31622 19317.1469   270%     -   34s
     0     0 18054.5938    0  543 -11331.316 18054.5938   259%     -   51s
     0     0 17923.1489    0  548 -11331.316 17923.1489   258%     -   56s
     0     0 17698.7912    0  547 -11331.316 17698.7912   256%     -   60s
     0     0 17697.0335    0  550 -11331.316 17697.0335   256%     -   61s
     0     0 17697.0335    0  561 -11331.316 17697.0335   256%     -   68s
     0     0 17697.0335    0  559 -11331.316 17697.0335   256%     -   76s
     0     0 17697.0335    0  552 -11331.316 17697.0335   256%     -   77s
     0     0 17697.0335    0  557 -11331.316 17697.0335   256%     -   78s
     0     0 17697.0335    0  557 -11331.316 17697.0335   256%     -   79s
     0     0 14740.6096    0  544 -11331.316 14740.6096   230%     -  108s
H    0     0                    -4255.436677 14740.6096   446%     -  108s
H    0     0                    -4028.919928 14740.6096   466%     -  108s
     0     0 13063.5609    0  570 -4028.9199 13063.5609   424%     -  143s
H    0     0                    -3923.069916 12626.4108   422%     -  176s
H    0     0                    -3898.068927 12626.4108   424%     -  176s
     0     0 12626.4108    0  628 -3898.0689 12626.4108   424%     -  176s
H    0     0                    -3896.188500 12508.4854   421%     -  192s
     0     0 12508.4854    0  636 -3896.1885 12508.4854   421%     -  192s
     0     0 12345.5296    0  584 -3896.1885 12345.5296   417%     -  211s
     0     0 12299.6660    0  569 -3896.1885 12299.6660   416%     -  222s
     0     0 12264.5764    0  558 -3896.1885 12264.5764   415%     -  229s
     0     0 12241.2947    0  559 -3896.1885 12241.2947   414%     -  233s
     0     0 12218.0993    0  563 -3896.1885 12218.0993   414%     -  238s
     0     0 12157.1989    0  602 -3896.1885 12157.1989   412%     -  250s
     0     0 12140.7222    0  560 -3896.1885 12140.7222   412%     -  254s
     0     0 12108.3697    0  616 -3896.1885 12108.3697   411%     -  257s
     0     0 12096.4445    0  590 -3896.1885 12096.4445   410%     -  262s
     0     0 12089.0448    0  580 -3896.1885 12089.0448   410%     -  265s
     0     0 12086.5125    0  584 -3896.1885 12086.5125   410%     -  267s
     0     0 12049.2146    0  581 -3896.1885 12049.2146   409%     -  271s
     0     0 12047.1246    0  593 -3896.1885 12047.1246   409%     -  273s
     0     0 12040.4292    0  585 -3896.1885 12040.4292   409%     -  275s
     0     0 12036.7476    0  591 -3896.1885 12036.7476   409%     -  277s
     0     0 12033.9100    0  593 -3896.1885 12033.9100   409%     -  279s
     0     0 12031.0043    0  592 -3896.1885 12031.0043   409%     -  281s
     0     0 12030.7163    0  592 -3896.1885 12030.7163   409%     -  281s
     0     0 10161.4497    0  504 -3896.1885 10161.4497   361%     -  356s
     0     0 9494.24594    0  500 -3896.1885 9494.24594   344%     -  391s
     0     0 9394.37717    0  573 -3896.1885 9394.37717   341%     -  410s
     0     0 9064.80414    0  576 -3896.1885 9064.80414   333%     -  434s
     0     0 8970.16106    0  570 -3896.1885 8970.16106   330%     -  448s
     0     0 8873.14645    0  592 -3896.1885 8873.14645   328%     -  468s
     0     0 8810.32126    0  585 -3896.1885 8810.32126   326%     -  477s
     0     0 8775.90266    0  581 -3896.1885 8775.90266   325%     -  486s
     0     0 8771.42630    0  589 -3896.1885 8771.42630   325%     -  491s
     0     0 8765.99096    0  587 -3896.1885 8765.99096   325%     -  497s
     0     0 8762.36937    0  587 -3896.1885 8762.36937   325%     -  501s
     0     0 8758.30356    0  589 -3896.1885 8758.30356   325%     -  504s
     0     0 8740.82694    0  571 -3896.1885 8740.82694   324%     -  506s
     0     0 8739.44584    0  580 -3896.1885 8739.44584   324%     -  508s
     0     0 7654.35187    0  519 -3896.1885 7654.35187   296%     -  565s
     0     0 7198.60364    0  671 -3896.1885 7198.60364   285%     -  598s
     0     0 7079.97277    0  664 -3896.1885 7079.97277   282%     -  618s
     0     0 7049.08982    0  666 -3896.1885 7049.08982   281%     -  626s
     0     0 7014.87026    0  661 -3896.1885 7014.87026   280%     -  639s
     0     0 6923.74265    0  599 -3896.1885 6923.74265   278%     -  656s
     0     0 6774.39127    0  648 -3896.1885 6774.39127   274%     -  673s
     0     0 6710.59601    0  674 -3896.1885 6710.59601   272%     -  687s
     0     0 6632.52614    0  596 -3896.1885 6632.52614   270%     -  698s
     0     0 6595.47310    0  606 -3896.1885 6595.47310   269%     -  707s
     0     0 6580.68552    0  679 -3896.1885 6580.68552   269%     -  713s
     0     0 6528.83046    0  675 -3896.1885 6528.83046   268%     -  725s
     0     0 6513.69426    0  677 -3896.1885 6513.69426   267%     -  733s
     0     0 6509.99968    0  613 -3896.1885 6509.99968   267%     -  735s
     0     0 6508.58740    0  552 -3896.1885 6508.58740   267%     -  738s
     0     0 6283.46192    0  525 -3896.1885 6283.46192   261%     -  766s
     0     0 6230.05424    0  475 -3896.1885 6230.05424   260%     -  781s
     0     0 6211.17449    0  529 -3896.1885 6211.17449   259%     -  789s
     0     0 6199.91841    0  537 -3896.1885 6199.91841   259%     -  793s
     0     0 6189.07352    0  533 -3896.1885 6189.07352   259%     -  798s
     0     0 6180.86485    0  539 -3896.1885 6180.86485   259%     -  803s
     0     0 6178.35375    0  542 -3896.1885 6178.35375   259%     -  805s
     0     0 6093.78902    0  461 -3896.1885 6093.78902   256%     -  820s
     0     0 6084.44784    0  469 -3896.1885 6084.44784   256%     -  828s
     0     0 6049.12787    0  472 -3896.1885 6049.12787   255%     -  837s
     0     0 6043.27481    0  483 -3896.1885 6043.27481   255%     -  842s
     0     0 5978.55326    0  484 -3896.1885 5978.55326   253%     -  855s
     0     0 5975.63605    0  620 -3896.1885 5975.63605   253%     -  859s
     0     0 5932.10318    0  485 -3896.1885 5932.10318   252%     -  871s
     0     0 5925.70935    0  494 -3896.1885 5925.70935   252%     -  876s
     0     0 5921.75951    0  494 -3896.1885 5921.75951   252%     -  879s
     0     0 5920.70101    0  490 -3896.1885 5920.70101   252%     -  881s
     0     0 5894.82910    0  494 -3896.1885 5894.82910   251%     -  889s
     0     0 5888.17621    0  507 -3896.1885 5888.17621   251%     -  893s
     0     0 5881.13320    0  502 -3896.1885 5881.13320   251%     -  896s
     0     0 5873.85547    0  501 -3896.1885 5873.85547   251%     -  899s
     0     0 5869.73619    0  491 -3896.1885 5869.73619   251%     -  901s
     0     0 5869.32781    0  501 -3896.1885 5869.32781   251%     -  902s
     0     0 5850.70749    0  485 -3896.1885 5850.70749   250%     -  909s
     0     0 5849.05616    0  489 -3896.1885 5849.05616   250%     -  912s
     0     0 5829.94283    0  497 -3896.1885 5829.94283   250%     -  921s
     0     0 5821.97800    0  511 -3896.1885 5821.97800   249%     -  929s
     0     0 5818.10770    0  509 -3896.1885 5818.10770   249%     -  931s
     0     0 5815.93363    0  509 -3896.1885 5815.93363   249%     -  933s
     0     0 5795.56532    0  503 -3896.1885 5795.56532   249%     -  940s
     0     0 5780.98075    0  502 -3896.1885 5780.98075   248%     -  947s
     0     0 5778.39666    0  502 -3896.1885 5778.39666   248%     -  950s
     0     0 5743.85791    0  500 -3896.1885 5743.85791   247%     -  959s
     0     0 5733.39287    0  489 -3896.1885 5733.39287   247%     -  974s
     0     0 5731.48446    0  484 -3896.1885 5731.48446   247%     -  977s
     0     0 5714.20876    0  577 -3896.1885 5714.20876   247%     -  984s
     0     0 5711.02058    0  497 -3896.1885 5711.02058   247%     -  987s
     0     0 5710.61893    0  502 -3896.1885 5710.61893   247%     -  989s
     0     0 5704.32824    0  490 -3896.1885 5704.32824   246%     -  995s
     0     0 5704.23939    0  490 -3896.1885 5704.23939   246%     -  999s
     0     2 5704.15761    0  490 -3896.1885 5704.15761   246%     - 1278s
     1     4 5562.68954    1  523 -3896.1885 5703.69616   246% 11764 1292s
     3     8 5199.46806    2  487 -3896.1885 5561.71436   243% 11993 1315s
     7    16 5032.22645    3  480 -3896.1885 5331.42895   237% 11761 1337s
    15    32 4873.77433    4  481 -3896.1885 5201.51293   234% 12316 1369s
    31    49 2331.98133    5  189 -3896.1885 5013.70359   229% 17303 1424s
    48    78 2238.92113    6  222 -3896.1885 5013.70359   229% 16375 1474s
    79   221 3335.66056    7  445 -3896.1885 5013.70359   229% 13433 1510s
   224   260 3094.16742    9  429 -3896.1885 5013.70359   229%  7503 1529s
   263   307 2896.14254   10  474 -3896.1885 5013.70359   229%  6864 1559s
   314   348 2815.21934   11  480 -3896.1885 5013.70359   229%  6397 1578s
   364   389 -2260.4331   20  162 -3896.1885 5013.70359   229%  6044 1596s
   415   419 2100.97568   12  429 -3896.1885 5013.70359   229%  5803 1612s
   473   466 1964.44216   13  366 -3896.1885 5013.70359   229%  5597 1629s
   536   513 1907.52125   14  351 -3896.1885 5013.70359   229%  5260 1643s
   603   551 1706.93785   15  346 -3896.1885 5013.70359   229%  4957 1659s
   674   588 1386.59143   16  487 -3896.1885 5013.70359   229%  4654 1673s
   733   610 3195.60160    7  519 -3896.1885 5013.70359   229%  4507 1688s
   797   643  513.35198   17  344 -3896.1885 5013.70359   229%  4354 1702s
   868   677  460.18014   18  346 -3896.1885 5013.70359   229%  4206 1719s
   947   718 -443.50080   14  228 -3896.1885 5013.70359   229%  4085 1734s
  1020   725 -2856.7163   19  128 -3896.1885 5013.70359   229%  3936 1753s
  1098   749 -3355.5984   20  137 -3896.1885 5013.70359   229%  3780 1768s
  1162   766 -3475.6813   21  140 -3896.1885 5013.70359   229%  3716 1785s
  1231   795 -3595.3726   22  132 -3896.1885 5013.70359   229%  3631 1807s
  1292   823     cutoff   23      -3896.1885 5013.70359   229%  3593 1829s
  1360   854 2496.56388   11  441 -3896.1885 5013.70359   229%  3570 1848s
  1425   886 1955.07760   12  455 -3896.1885 5013.70359   229%  3562 1867s
  1495   944 1580.86376   13  371 -3896.1885 5013.70359   229%  3553 1885s
  1589  1001 1516.45248   14  374 -3896.1885 5013.70359   229%  3515 1906s
  1687  1068 1264.04418   15  377 -3896.1885 4873.75703   225%  3448 1925s
  1784  1154 1216.10335   16  288 -3896.1885 4873.75703   225%  3408 1946s
  1911  1211  978.46079   17  292 -3896.1885 4873.75703   225%  3325 1968s
  2021  1252  266.69241   17  575 -3896.1885 4873.75703   225%  3274 1996s
  2110  1326 -2438.4468   18  151 -3896.1885 4873.75703   225%  3273 2022s
  2212  1386 -3051.1981   19  133 -3896.1885 4873.75703   225%  3274 2049s
  2322  1460 -3192.9038   20  125 -3896.1885 4873.75703   225%  3264 2078s
  2425  1573     cutoff   21      -3896.1885 4873.75703   225%  3256 2106s
  2599  1688 1930.04560    7  415 -3896.1885 4873.75703   225%  3185 2135s
  2776  1797 1210.00700    8  580 -3896.1885 4873.75703   225%  3117 2165s
  2980  1855 -1839.3490    9  332 -3896.1885 4858.36505   225%  3050 2206s
  3112  1947 -2000.6278   10  396 -3896.1885 4621.75975   219%  3036 2240s
  3255  1962     cutoff   11      -3896.1885 4621.75975   219%  3041 2322s
  3302  1994 -2542.4995   12  437 -3896.1885 4621.75975   219%  3071 2432s
  3346  2029 -2559.7732   13  439 -3896.1885 4307.63099   211%  3108 2469s
  3391  2063 -3619.7881   15  454 -3896.1885 4307.63099   211%  3154 2502s
  3444  2119 -3278.8877   17  303 -3896.1885 4176.31560   207%  3169 2537s
  3523  2167     cutoff   24      -3896.1885 3865.35003   199%  3172 2577s
  3607  2215 -435.39592   11  430 -3896.1885 3865.35003   199%  3188 2635s
  3677  2309 1864.62116    7  403 -3896.1885 3865.35003   199%  3190 2689s
  3796  2310 3064.02415   15  490 -3896.1885 3865.35003   199%  3158 2892s
  3798  2311 2801.28267   17  403 -3896.1885 3865.35003   199%  3157 2906s
  3799  2312 -3400.6542   68  426 -3896.1885 3865.35003   199%  3156 2971s
  3800  2313 3025.14017    8  479 -3896.1885 3865.35003   199%  3155 3026s
  3801  2313  601.55903   13  456 -3896.1885 3865.35003   199%  3154 3073s
  3802  2314 -3415.6189   36  464 -3896.1885 3865.35003   199%  3153 3107s
  3803  2315  966.26244   20  492 -3896.1885 3865.35003   199%  3153 3130s
  3804  2315 2392.02568   14  521 -3896.1885 3865.35003   199%  3152 3152s
  3805  2316 -1568.6618   21  477 -3896.1885 3865.35003   199%  3151 3166s
  3806  2317 -2223.7181   20  516 -3896.1885 3865.35003   199%  3150 3175s
  3807  2317 -100.22835   19  514 -3896.1885 3865.35003   199%  3149 3185s
  3808  2318 -3452.3531   27  524 -3896.1885 3865.35003   199%  3149 3199s
  3809  2319 -2962.3552   25  458 -3896.1885 3865.35003   199%  3148 3208s
  3810  2319 -1988.7767   20  472 -3896.1885 3865.35003   199%  3147 3219s
  3811  2320 -2973.4936   36  485 -3896.1885 3865.35003   199%  3146 3233s
  3812  2321 -1792.1498   13  554 -3896.1885 3865.35003   199%  3145 3244s
  3813  2321 -2732.5768   50  474 -3896.1885 3865.35003   199%  3144 3258s
  3814  2322 -1069.8243   29  490 -3896.1885 3865.35003   199%  3144 3262s
  3815  2323 -1596.4319   26  492 -3896.1885 3865.35003   199%  3143 3266s
  3816  2323 1107.00793   15  469 -3896.1885 3865.35003   199%  3142 3281s
  3817  2324  314.78141   14  481 -3896.1885 3865.35003   199%  3141 3292s
  3818  2325 -901.77829   23  533 -3896.1885 3865.35003   199%  3140 3303s
  3819  2325 -3761.3203   30  484 -3896.1885 3865.35003   199%  3139 3310s
  3820  2326 -2268.9532   13  494 -3896.1885 3865.35003   199%  3139 3315s
  3822  2327 -1331.3510   10  493 -3896.1885 3865.35003   199%  3137 3322s
  3823  2328 -1836.6397   16  467 -3896.1885 3865.35003   199%  3136 3334s
  3824  2329 -836.56652   31  486 -3896.1885 3865.35003   199%  3135 3338s
  3825  2329 -765.55878   25  479 -3896.1885 3865.35003   199%  3135 3343s
  3826  2330  551.49175   22  483 -3896.1885 3865.35003   199%  3134 3346s
  3827  2331 -1924.1264   15  491 -3896.1885 3865.35003   199%  3133 3358s
  3828  2331 1958.07170   10  483 -3896.1885 3865.35003   199%  3132 3362s
  3829  2332 -3219.7735   20  493 -3896.1885 3865.35003   199%  3131 3367s
  3830  2333 1409.88958   12  565 -3896.1885 3865.35003   199%  3130 3382s
  3831  2333 1692.68433   13  487 -3896.1885 3865.35003   199%  3130 3385s
  3832  2334 -1864.9461   60  497 -3896.1885 3865.35003   199%  3129 3390s
  3833  2335 -1605.1920   19  500 -3896.1885 3865.35003   199%  3128 3409s
  3834  2335 -2378.2775   56  498 -3896.1885 3865.35003   199%  3127 3420s
  3835  2336 -3715.3275   55  558 -3896.1885 3865.35003   199%  3126 3431s
  3836  2337   -6.84999   30  498 -3896.1885 3865.35003   199%  3126 3439s
  3837  2337 -1596.4319   26  492 -3896.1885 3865.35003   199%  3125 3444s
  3838  2338 -2247.7677   42  492 -3896.1885 3865.35003   199%  3124 3454s
  3839  2339 1559.56665   12  501 -3896.1885 3865.35003   199%  3123 3459s
  3840  2339  938.16995   16  486 -3896.1885 3865.35003   199%  3122 3466s
  3841  2340 -922.58071   46  614 -3896.1885 3865.35003   199%  3121 3472s
  3842  2341  619.10403   11  552 -3896.1885 3865.35003   199%  3121 3478s
  3843  2341 -1099.6534   21  552 -3896.1885 3865.35003   199%  3120 3497s
  3844  2342 -2436.0596   43  552 -3896.1885 3865.35003   199%  3119 3561s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 12
  Projected implied bound: 225
  MIR: 1119
  Mixing: 1
  Flow cover: 1071
  Zero half: 1
  RLT: 58
  Relax-and-lift: 188

Explored 3845 nodes (13281338 simplex iterations) in 3600.08 seconds (8352.62 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3896.19 -3898.07 -3923.07 ... -11459.6

Time limit reached
Best objective -3.896188500077e+03, best bound 3.865350027588e+03, gap 199.2085%
  WARNING: Time limit reached. Using best solution found (gap: 199.21%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = -3896.19, θ = 118816.94
  Upper Bound (UB) = -3896.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118816.94
  [DEBUG]   ✓ Scenario 0: θ = 118816.94 ≤ Q = 118816.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118816.94 ≤ Q = 118816.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118816.94 ≤ Q = 118816.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118816.94 ≤ Q = 118816.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118816.94 ≤ Q = 118816.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118816.94 ≤ Q = 118816.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118816.94 ≤ Q = 118816.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118816.94 ≤ Q = 118816.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118816.94 ≤ Q = 118816.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 118816.94 ≤ Q = 118816.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 118816.94 ≤ Q = 118816.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x235bd1d5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdca42e2b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.270256e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6596008.4441
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.228390e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122838.96    0  123 6596008.44 -122838.96   102%     -    0s
H    0     0                    -89981.15951 -122838.96  36.5%     -    0s
H    0     0                    -90388.80332 -122838.96  35.9%     -    0s
H    0     0                    -91424.93910 -99993.889  9.37%     -    0s
H    0     0                    -99417.74815 -99993.889  0.58%     -    0s
     0     0 -99993.889    0   29 -99417.748 -99993.889  0.58%     -    0s
H    0     0                    -99619.52996 -99975.215  0.36%     -    0s
     0     0 -99786.262    0   16 -99619.530 -99786.262  0.17%     -    0s
     0     0 -99785.659    0    5 -99619.530 -99785.659  0.17%     -    0s
H    0     0                    -99759.13635 -99784.759  0.03%     -    0s
H    0     0                    -99782.22761 -99784.759  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 138
  Flow cover: 5
  RLT: 1
  Relax-and-lift: 3
  BQP: 2

Explored 1 nodes (426 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -99782.2 -99619.5 -91424.9 ... 1.27026e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.978222761245e+04, best bound -9.978475939991e+04, gap 0.0025%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 111743.78
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99782.23
  [DEBUG]   S×d_nominal = 211526.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211526.01 + -99782.23 = 111743.78
  [DEBUG]   Current θ from Master = 118816.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7073.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10969.35
  Lower Bound (LB) = -4438.37
  Gap (UB-LB) = 542.1820, Absolute Gap = 542.1820, Relative Gap = 0.139157
  Not converged yet (gap = 542.18 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524399 nonzeros
Model fingerprint: 0xb9cda281
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81344 rows and 33034 columns
Presolve time: 1.59s
Presolved: 103519 rows, 44106 columns, 626927 nonzeros
Variable types: 41847 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -380875.7514
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 614
 AA' NZ     : 3.845e+06
 Factor NZ  : 8.924e+06 (roughly 130 MB of memory)
 Factor Ops : 1.661e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -9.50658891e+06  1.61766445e+08  5.27e+04 2.27e+01  4.19e+04     3s
   1  -7.16278664e+06  1.37095056e+08  3.59e+04 4.51e+01  2.83e+04     3s
   2  -3.39192514e+06  1.06654280e+08  1.61e+04 2.06e+01  1.30e+04     3s
   3  -5.72200346e+05  6.66543964e+07  8.99e+02 8.12e-01  1.01e+03     3s
   4  -4.03682050e+05  2.63402839e+07  2.69e+02 1.86e-01  3.15e+02     3s
   5  -3.39016733e+05  1.93154345e+07  1.61e+02 1.26e-01  2.00e+02     3s
   6  -2.19301409e+05  1.39488319e+07  4.66e+01 8.36e-02  9.93e+01     3s
   7  -1.58278061e+05  1.03810495e+07  1.72e+01 5.87e-02  6.32e+01     3s
   8  -1.14393103e+05  5.95375210e+06  9.61e+00 3.12e-02  3.48e+01     3s
   9  -8.10850256e+04  3.39903374e+06  5.54e+00 1.68e-02  1.94e+01     3s
  10  -6.58641674e+04  1.32460799e+06  3.80e+00 6.15e-03  7.64e+00     3s
  11  -3.07164885e+04  4.17257292e+05  2.07e+00 2.12e-03  2.43e+00     3s
  12  -2.11880839e+04  2.12444246e+05  1.33e+00 8.47e-04  1.26e+00     3s
  13  -1.33216621e+04  1.48123614e+05  9.08e-01 8.14e-04  8.63e-01     3s
  14  -8.12894368e+03  1.11001573e+05  6.96e-01 8.20e-04  6.35e-01     3s
  15  -4.31579475e+03  8.47333549e+04  5.71e-01 7.93e-04  4.74e-01     3s
  16   2.86243993e+03  5.56991269e+04  3.83e-01 1.27e-03  2.81e-01     3s
  17   5.77659874e+03  4.69522866e+04  3.20e-01 1.57e-03  2.19e-01     4s
  18   9.03590022e+03  4.30407465e+04  2.53e-01 1.75e-03  1.81e-01     4s
  19   1.10518784e+04  3.55362205e+04  2.14e-01 1.44e-03  1.30e-01     4s
  20   1.34704653e+04  3.29507346e+04  1.68e-01 1.35e-03  1.04e-01     4s
  21   1.47628106e+04  3.09855874e+04  1.44e-01 1.16e-03  8.62e-02     4s
  22   1.66426404e+04  3.01324920e+04  1.11e-01 1.14e-03  7.17e-02     4s
  23   1.75818979e+04  2.81443293e+04  9.52e-02 1.22e-03  5.61e-02     4s
  24   1.88375385e+04  2.72612631e+04  7.54e-02 1.50e-03  4.48e-02     4s
  25   2.04414043e+04  2.62870267e+04  5.03e-02 2.31e-03  3.10e-02     4s
  26   2.06347084e+04  2.61141321e+04  4.73e-02 2.20e-03  2.91e-02     4s
  27   2.16078695e+04  2.55877128e+04  3.29e-02 1.69e-03  2.11e-02     4s
  28   2.19733319e+04  2.49252916e+04  2.74e-02 2.14e-03  1.57e-02     4s
  29   2.22304889e+04  2.48101269e+04  2.36e-02 1.91e-03  1.37e-02     4s
  30   2.26249717e+04  2.45580466e+04  1.77e-02 1.17e-03  1.03e-02     4s
  31   2.29293371e+04  2.44357881e+04  1.34e-02 9.27e-04  8.00e-03     4s
  32   2.30343366e+04  2.43125596e+04  1.18e-02 7.67e-04  6.79e-03     4s
  33   2.32231110e+04  2.42209244e+04  9.05e-03 7.05e-04  5.30e-03     4s
  34   2.33324388e+04  2.41348543e+04  7.41e-03 8.93e-04  4.26e-03     4s
  35   2.34574814e+04  2.40337620e+04  5.49e-03 6.81e-04  3.06e-03     4s
  36   2.34777076e+04  2.40050041e+04  5.20e-03 5.66e-04  2.80e-03     4s
  37   2.36257088e+04  2.39639372e+04  3.04e-03 5.03e-04  1.80e-03     4s
  38   2.36934042e+04  2.39279030e+04  2.08e-03 2.65e-04  1.25e-03     5s
  39   2.37357344e+04  2.38949952e+04  1.50e-03 1.54e-04  8.46e-04     5s
  40   2.37434681e+04  2.38774806e+04  1.39e-03 9.14e-05  7.12e-04     5s
  41   2.37657086e+04  2.38663581e+04  1.09e-03 7.85e-05  5.35e-04     5s
  42   2.37896562e+04  2.38590407e+04  7.71e-04 6.03e-05  3.69e-04     5s
  43   2.38236779e+04  2.38542023e+04  3.19e-04 3.08e-05  1.62e-04     5s
  44   2.38406018e+04  2.38521125e+04  1.03e-04 2.57e-05  6.11e-05     5s
  45   2.38412791e+04  2.38518862e+04  9.50e-05 2.33e-05  5.63e-05     5s
  46   2.38430528e+04  2.38502933e+04  7.38e-05 6.86e-06  3.85e-05     5s
  47   2.38473967e+04  2.38498927e+04  2.31e-05 3.33e-06  1.33e-05     5s
  48   2.38482517e+04  2.38495762e+04  1.32e-05 6.79e-07  7.04e-06     5s
  49   2.38486665e+04  2.38495392e+04  8.64e-06 4.23e-07  4.64e-06     5s
  50   2.38491916e+04  2.38495179e+04  2.93e-06 6.18e-07  1.73e-06     5s
  51   2.38494174e+04  2.38495124e+04  6.01e-07 5.10e-07  5.04e-07     5s
  52   2.38494437e+04  2.38494907e+04  3.44e-07 1.27e-07  2.49e-07     5s
  53   2.38494450e+04  2.38494866e+04  3.32e-07 6.60e-08  2.21e-07     5s
  54   2.38494619e+04  2.38494842e+04  3.89e-07 3.42e-08  1.18e-07     5s
  55   2.38494719e+04  2.38494834e+04  1.99e-07 1.90e-08  6.11e-08     6s
  56   2.38494812e+04  2.38494824e+04  6.62e-08 1.25e-08  6.36e-09     6s
  57   2.38494813e+04  2.38494824e+04  8.29e-08 1.14e-08  5.93e-09     6s
  58   2.38494822e+04  2.38494822e+04  3.11e-08 8.83e-11  4.00e-10     6s

Barrier solved model in 58 iterations and 5.83 seconds (9.93 work units)
Optimal objective 2.38494822e+04


Root crossover log...

   83364 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    8018 PPushes remaining with PInf 1.1906617e-04                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1890909e+03      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43415    2.3849482e+04   0.000000e+00   2.189091e+03      8s
   43507    2.3849482e+04   0.000000e+00   0.000000e+00      8s
   43507    2.3849482e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.384948e+04, 43507 iterations, 6.38 seconds (13.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 23849.4822    0  408 -210563.59 23849.4822   111%     -    9s
H    0     0                    -204728.1357 23849.4822   112%     -    9s
H    0     0                    -50132.12730 23849.4822   148%     -    9s
H    0     0                    -37690.45694 23849.4822   163%     -    9s
H    0     0                    -30396.15894 23849.4822   178%     -    9s
H    0     0                    -30220.52457 23849.4822   179%     -    9s
H    0     0                    -15484.57048 23849.4822   254%     -    9s
H    0     0                    -15400.77273 23849.4822   255%     -    9s
H    0     0                    -15371.82352 23849.4822   255%     -   10s
H    0     0                    -15370.29297 23849.4822   255%     -   10s
H    0     0                    -15307.82890 23849.4822   256%     -   12s
H    0     0                    -14732.06017 23849.4822   262%     -   12s
H    0     0                    -14723.32551 23849.4822   262%     -   12s
H    0     0                    -11607.38934 23849.4822   305%     -   12s
H    0     0                    -11459.55887 23849.4822   308%     -   12s
     0     0 18452.1041    0  562 -11459.559 18452.1041   261%     -   49s
H    0     0                    -11381.71190 18452.1041   262%     -   50s
H    0     0                    -11334.56304 18452.1041   263%     -   50s
H    0     0                    -11331.31622 18452.1041   263%     -   50s
     0     0 17971.5819    0  569 -11331.316 17971.5819   259%     -   65s
     0     0 17814.4658    0  539 -11331.316 17814.4658   257%     -   76s
     0     0 17814.4658    0  538 -11331.316 17814.4658   257%     -   80s
     0     0 17814.4658    0  544 -11331.316 17814.4658   257%     -   85s
     0     0 17814.4658    0  547 -11331.316 17814.4658   257%     -   93s
     0     0 17814.4658    0  552 -11331.316 17814.4658   257%     -   94s
     0     0 17814.4658    0  552 -11331.316 17814.4658   257%     -   94s
H    0     0                    -4897.673349 15096.5006   408%     -  144s
H    0     0                    -4040.999451 15096.5006   474%     -  144s
H    0     0                    -4038.461218 15096.5006   474%     -  144s
H    0     0                    -4035.214397 15096.5006   474%     -  144s
     0     0 14898.9627    0  399 -4035.2144 14898.9627   469%     -  144s
H    0     0                    -4033.333970 14898.9627   469%     -  145s
H    0     0                    -4008.979728 13686.1327   441%     -  192s
H    0     0                    -4003.194673 13686.1327   442%     -  192s
H    0     0                    -3976.857961 13686.1327   444%     -  192s
     0     0 13686.1327    0  625 -3976.8580 13686.1327   444%     -  192s
H    0     0                    -3963.751524 13071.1971   430%     -  229s
     0     0 13071.1971    0  661 -3963.7515 13071.1971   430%     -  229s
H    0     0                    -3923.069916 12998.7276   431%     -  248s
     0     0 12998.7276    0  665 -3923.0699 12998.7276   431%     -  248s
     0     0 12879.2075    0  598 -3923.0699 12879.2075   428%     -  268s
     0     0 12642.8127    0  654 -3923.0699 12642.8127   422%     -  292s
     0     0 12619.3116    0  633 -3923.0699 12619.3116   422%     -  300s
     0     0 12608.7390    0  653 -3923.0699 12608.7390   421%     -  304s
     0     0 12602.2677    0  642 -3923.0699 12602.2677   421%     -  307s
     0     0 12601.4256    0  628 -3923.0699 12601.4256   421%     -  309s
H    0     0                    -3921.189489 12601.4256   421%     -  326s
     0     0 10523.8843    0  513 -3921.1895 10523.8843   368%     -  412s
     0     0 9579.56417    0  541 -3921.1895 9579.56417   344%     -  470s
     0     0 9179.60792    0  603 -3921.1895 9179.60792   334%     -  508s
     0     0 9084.74879    0  527 -3921.1895 9084.74879   332%     -  532s
     0     0 9045.53153    0  612 -3921.1895 9045.53153   331%     -  544s
     0     0 9004.09103    0  617 -3921.1895 9004.09103   330%     -  555s
     0     0 8978.68409    0  570 -3921.1895 8978.68409   329%     -  567s
     0     0 8946.35367    0  580 -3921.1895 8946.35367   328%     -  576s
     0     0 8898.05064    0  572 -3921.1895 8898.05064   327%     -  587s
     0     0 8874.57090    0  573 -3921.1895 8874.57090   326%     -  596s
     0     0 8848.15733    0  645 -3921.1895 8848.15733   326%     -  603s
     0     0 8837.88508    0  582 -3921.1895 8837.88508   325%     -  607s
     0     0 8818.96585    0  572 -3921.1895 8818.96585   325%     -  613s
     0     0 8738.69962    0  610 -3921.1895 8738.69962   323%     -  624s
     0     0 8731.08901    0  614 -3921.1895 8731.08901   323%     -  627s
     0     0 8727.75680    0  553 -3921.1895 8727.75680   323%     -  629s
     0     0 8726.05978    0  544 -3921.1895 8726.05978   323%     -  631s
     0     0 7848.21983    0  473 -3921.1895 7848.21983   300%     -  675s
     0     0 7347.72356    0  459 -3921.1895 7347.72356   287%     -  701s
     0     0 7185.26445    0  476 -3921.1895 7185.26445   283%     -  719s
     0     0 7050.74991    0  491 -3921.1895 7050.74991   280%     -  741s
     0     0 6999.23100    0  486 -3921.1895 6999.23100   278%     -  752s
     0     0 6955.38794    0  561 -3921.1895 6955.38794   277%     -  763s
     0     0 6899.69703    0  486 -3921.1895 6899.69703   276%     -  772s
     0     0 6836.56593    0  547 -3921.1895 6836.56593   274%     -  785s
     0     0 6824.43706    0  488 -3921.1895 6824.43706   274%     -  790s
     0     0 6802.30113    0  495 -3921.1895 6802.30113   273%     -  795s
     0     0 6772.16383    0  489 -3921.1895 6772.16383   273%     -  807s
     0     0 6763.66835    0  497 -3921.1895 6763.66835   272%     -  812s
     0     0 6760.05551    0  494 -3921.1895 6760.05551   272%     -  815s
     0     0 6744.79054    0  499 -3921.1895 6744.79054   272%     -  820s
     0     0 6738.75748    0  499 -3921.1895 6738.75748   272%     -  822s
     0     0 6684.22624    0  491 -3921.1895 6684.22624   270%     -  832s
     0     0 6664.87266    0  565 -3921.1895 6664.87266   270%     -  836s
     0     0 6663.45603    0  494 -3921.1895 6663.45603   270%     -  838s
     0     0 6530.64654    0  527 -3921.1895 6530.64654   267%     -  852s
     0     0 6413.83851    0  546 -3921.1895 6413.83851   264%     -  863s
     0     0 6374.72985    0  562 -3921.1895 6374.72985   263%     -  871s
     0     0 6329.88558    0  549 -3921.1895 6329.88558   261%     -  878s
     0     0 6326.71073    0  541 -3921.1895 6326.71073   261%     -  880s
     0     0 6321.64128    0  551 -3921.1895 6321.64128   261%     -  883s
     0     0 6316.09192    0  540 -3921.1895 6316.09192   261%     -  885s
     0     0 6314.89791    0  541 -3921.1895 6314.89791   261%     -  886s
     0     0 6191.84821    0  469 -3921.1895 6191.84821   258%     -  899s
     0     0 6148.07759    0  540 -3921.1895 6148.07759   257%     -  914s
     0     0 6124.78713    0  469 -3921.1895 6124.78713   256%     -  920s
     0     0 6118.01057    0  471 -3921.1895 6118.01057   256%     -  923s
     0     0 6113.58636    0  533 -3921.1895 6113.58636   256%     -  925s
     0     0 6109.23364    0  522 -3921.1895 6109.23364   256%     -  927s
     0     0 6107.62578    0  542 -3921.1895 6107.62578   256%     -  928s
     0     0 6053.68664    0  482 -3921.1895 6053.68664   254%     -  937s
     0     0 6012.84019    0  550 -3921.1895 6012.84019   253%     -  945s
     0     0 5975.73142    0  557 -3921.1895 5975.73142   252%     -  953s
     0     0 5949.93301    0  545 -3921.1895 5949.93301   252%     -  963s
     0     0 5938.96092    0  554 -3921.1895 5938.96092   251%     -  967s
     0     0 5932.35555    0  556 -3921.1895 5932.35555   251%     -  970s
     0     0 5930.62690    0  551 -3921.1895 5930.62690   251%     -  972s
     0     0 5881.18573    0  479 -3921.1895 5881.18573   250%     -  983s
     0     0 5866.67903    0  489 -3921.1895 5866.67903   250%     -  993s
     0     0 5860.42959    0  494 -3921.1895 5860.42959   249%     -  999s
     0     0 5858.61162    0  488 -3921.1895 5858.61162   249%     - 1000s
     0     0 5834.69802    0  518 -3921.1895 5834.69802   249%     - 1011s
     0     0 5820.92276    0  731 -3921.1895 5820.92276   248%     - 1022s
     0     0 5818.92426    0  641 -3921.1895 5818.92426   248%     - 1026s
     0     0 5800.25708    0  513 -3921.1895 5800.25708   248%     - 1036s
     0     0 5796.68828    0  504 -3921.1895 5796.68828   248%     - 1042s
     0     0 5794.69702    0  520 -3921.1895 5794.69702   248%     - 1045s
     0     0 5778.54331    0  572 -3921.1895 5778.54331   247%     - 1054s
     0     0 5773.36649    0  599 -3921.1895 5773.36649   247%     - 1062s
     0     0 5771.34805    0  513 -3921.1895 5771.34805   247%     - 1066s
     0     0 5753.85181    0  500 -3921.1895 5753.85181   247%     - 1079s
     0     0 5753.74120    0  500 -3921.1895 5753.74120   247%     - 1083s
     0     2 5753.73400    0  500 -3921.1895 5753.73400   247%     - 1197s
     1     3 5460.61254    1  542 -3921.1895 5753.73400   247% 11325 1214s
     2     6 4100.12179    2  415 -3921.1895 5753.73400   247% 13808 1232s
     5    12 3997.24992    3  472 -3921.1895 5639.00532   244% 10486 1252s
    11    24 3694.65334    4  489 -3921.1895 5297.48084   235% 11895 1282s
    23    36 4598.96104    4  689 -3921.1895 5184.91829   232% 27650 2543s
    35    67 4182.07670    5  441 -3921.1895 5184.91829   232% 22830 2661s
    66   126 3486.44006    5  740 -3921.1895 5058.48281   229% 24816 2716s
   125   211 3218.66770    6  743 -3921.1895 4994.35865   227% 17679 2752s
   210   310 3122.59350   11  646 -3921.1895 4994.35865   227% 12754 2800s
   309   397 3022.22654   14  391 -3921.1895 4994.35865   227% 10529 2841s
   396   469 2932.66820   13  705 -3921.1895 4994.35865   227%  9403 2866s
   476   497 2819.79606   14  632 -3921.1895 4994.35865   227%  8751 2895s
   506   545 2090.39924   22  372 -3921.1895 4994.35865   227%  8683 2918s
   556   572 2669.56890   15  718 -3921.1895 4994.35865   227%  8602 2935s
   587   590 2520.50838   16  703 -3921.1895 4994.35865   227%  8566 2955s
   621   619 2493.32168   17  692 -3921.1895 4994.35865   227%  8506 2972s
   656   649 2474.02462   18  688 -3921.1895 4994.35865   227%  8515 2992s
   700   693 2414.57322   19  687 -3921.1895 4994.35865   227%  8433 3011s
   765   751 2320.69827   20  705 -3921.1895 4994.35865   227%  8254 3029s
   843   799 1115.54043   20  453 -3921.1895 4994.35865   227%  8101 3048s
   915   842 2198.53378   21  689 -3921.1895 4994.35865   227%  7801 3068s
   978   883   76.74055   16  368 -3921.1895 4994.35865   227%  7740 3088s
  1056   952 1981.40872   22  672 -3921.1895 4994.35865   227%  7628 3110s
  1153  1024 1952.69315   23  675 -3921.1895 4994.35865   227%  7521 3131s
  1251  1108 1587.68762   25  600 -3921.1895 4994.35865   227%  7438 3152s
  1370  1180 -2327.4088   27  421 -3921.1895 4994.35865   227%  7312 3177s
  1504  1238  954.41372   27  563 -3921.1895 4994.35865   227%  7078 3199s
  1646  1278  764.83983   28  568 -3921.1895 4994.35865   227%  6854 3222s
  1779  1289  -30.26483   29  397 -3921.1895 4610.64641   218%  6741 3250s
  1866  1327 infeasible   30      -3921.1895 4610.64641   218%  6791 3280s
  1936  1404  234.27483   32  350 -3921.1895 4610.64641   218%  6882 3309s
  2051  1521   37.83129   37  241 -3921.1895 4610.64641   218%  6900 3334s
  2216  1693 -2521.0264   39  209 -3921.1895 4610.64641   218%  6738 3360s
  2442  1787 -2646.3663   46  215 -3921.1895 4610.64641   218%  6498 3388s
  2642  1857 -2812.4515   56  185 -3921.1895 4610.64641   218%  6343 3420s
  2796  1907 -3729.2985   69  154 -3921.1895 4598.72960   217%  6317 3450s
  2948  1960 infeasible   30      -3921.1895 4598.72960   217%  6335 3483s
  3075  2045 infeasible   27      -3921.1895 4221.62497   208%  6368 3517s
  3207  2143   62.68677    6  529 -3921.1895 4221.62497   208%  6444 3553s
  3356  2159 -941.63428    7  526 -3921.1895 4221.62497   208%  6395 3596s
  3480  2151 -3703.8769   30  150 -3921.1895 4221.62497   208%  6446 3600s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 275
  MIR: 3744
  Flow cover: 3591
  Zero half: 1
  RLT: 201
  Relax-and-lift: 1138

Explored 3504 nodes (23464032 simplex iterations) in 3600.05 seconds (7575.93 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3921.19 -3923.07 -3963.75 ... -4041

Time limit reached
Best objective -3.921189489225e+03, best bound 4.221624973081e+03, gap 207.6618%
  WARNING: Time limit reached. Using best solution found (gap: 207.66%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -3921.19, θ = 119431.28
  Upper Bound (UB) = -3921.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119431.28
  [DEBUG]   ✓ Scenario 0: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119431.28 ≤ Q = 119431.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119431.28 ≤ Q = 119431.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 119431.28 ≤ Q = 119431.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 119431.28 ≤ Q = 119431.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 119431.28 ≤ Q = 119431.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4dd43918
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4dd43918
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.272873e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6630818.3082
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.222097e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122209.69    0  123 6630818.31 -122209.69   102%     -    0s
H    0     0                    -89414.13940 -122209.69  36.7%     -    0s
H    0     0                    -89821.78321 -122209.69  36.1%     -    0s
     0     0 -96743.498    0   44 -89821.783 -96743.498  7.71%     -    0s
H    0     0                    -95663.76606 -96663.652  1.05%     -    0s
     0     0 -96361.724    0   32 -95663.766 -96361.724  0.73%     -    0s
H    0     0                    -96096.60268 -96360.771  0.27%     -    0s
     0     0 -96313.543    0   22 -96096.603 -96313.543  0.23%     -    0s
     0     0 -96303.913    0   17 -96096.603 -96303.913  0.22%     -    0s
     0     0 -96281.886    0   19 -96096.603 -96281.886  0.19%     -    0s
     0     0 -96281.344    0   19 -96096.603 -96281.344  0.19%     -    0s
     0     0 -96129.706    0    8 -96096.603 -96129.706  0.03%     -    0s
     0     0 -96129.706    0    6 -96096.603 -96129.706  0.03%     -    0s
H    0     0                    -96124.23042 -96129.706  0.01%     -    0s

Explored 1 nodes (538 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -96124.2 -96096.6 -89821.8 ... 1.27287e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.612423041619e+04, best bound -9.612970583444e+04, gap 0.0057%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 115401.77
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96124.23
  [DEBUG]   S×d_nominal = 211526.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211526.01 + -96124.23 = 115401.77
  [DEBUG]   Current θ from Master = 119431.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4029.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7950.69
  Lower Bound (LB) = -4438.37
  Gap (UB-LB) = 517.1810, Absolute Gap = 517.1810, Relative Gap = 0.131894
  Not converged yet (gap = 517.18 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567639 nonzeros
Model fingerprint: 0xf08398eb
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 88111 rows and 35781 columns
Presolve time: 1.71s
Presolved: 112042 rows, 47599 columns, 676484 nonzeros
Variable types: 45340 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -381315.3956
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 614
 AA' NZ     : 4.326e+06
 Factor NZ  : 1.079e+07 (roughly 150 MB of memory)
 Factor Ops : 2.953e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -9.91357682e+06  1.73300037e+08  5.49e+04 2.18e+01  4.34e+04     3s
   1  -7.53374935e+06  1.47577755e+08  3.78e+04 4.54e+01  2.95e+04     3s
   2  -3.13553644e+06  1.16251879e+08  1.47e+04 2.45e+01  1.19e+04     3s
   3  -6.35756260e+05  8.37629522e+07  1.09e+03 3.85e+00  1.22e+03     3s
   4  -4.47845635e+05  4.31754286e+07  3.58e+02 1.34e+00  4.54e+02     3s
   5  -3.77787768e+05  2.99772382e+07  1.85e+02 6.80e-01  2.63e+02     3s
   6  -3.07476234e+05  2.17058262e+07  6.51e+01 1.91e-01  1.44e+02     3s
   7  -2.17159447e+05  1.66826053e+07  7.75e+00 1.74e-02  8.64e+01     3s
   8  -1.24608465e+05  7.03276627e+06  1.82e+00 6.91e-03  3.54e+01     3s
   9  -9.82338904e+04  4.84659980e+06  1.28e+00 4.69e-03  2.44e+01     3s
  10  -6.78059155e+04  1.66539181e+06  7.39e-01 1.57e-03  8.51e+00     4s
  11  -3.23931740e+04  5.46899430e+05  3.05e-01 7.65e-03  2.84e+00     4s
  12  -1.72977795e+04  2.15986752e+05  1.51e-01 1.80e-04  1.14e+00     4s
  13  -7.84351797e+03  1.34815384e+05  9.41e-02 1.85e-04  6.97e-01     4s
  14  -2.95892743e+03  9.46010682e+04  7.29e-02 1.81e-04  4.76e-01     4s
  15   2.05412728e+02  8.43300759e+04  6.17e-02 2.16e-04  4.11e-01     4s
  16   5.17980146e+03  6.26634063e+04  4.64e-02 1.05e-03  2.81e-01     4s
  17   8.02221683e+03  5.26432085e+04  3.81e-02 7.26e-04  2.18e-01     4s
  18   1.02199019e+04  4.73384911e+04  3.22e-02 6.62e-04  1.81e-01     4s
  19   1.26888380e+04  4.06890902e+04  2.59e-02 9.33e-04  1.37e-01     4s
  20   1.37749807e+04  3.55614769e+04  2.31e-02 1.23e-03  1.06e-01     4s
  21   1.53959949e+04  3.40222855e+04  1.94e-02 1.08e-03  9.09e-02     4s
  22   1.71759607e+04  3.21584552e+04  1.54e-02 8.65e-04  7.32e-02     4s
  23   1.89627225e+04  3.12571954e+04  1.15e-02 8.00e-04  6.00e-02     4s
  24   2.00270026e+04  2.97799414e+04  9.23e-03 6.60e-04  4.76e-02     4s
  25   2.05068397e+04  2.83440477e+04  8.17e-03 5.03e-04  3.83e-02     4s
  26   2.16632751e+04  2.75453422e+04  5.76e-03 4.00e-04  2.87e-02     4s
  27   2.18870034e+04  2.69320576e+04  5.31e-03 3.16e-04  2.46e-02     4s
  28   2.27445609e+04  2.65126140e+04  3.58e-03 2.58e-04  1.84e-02     4s
  29   2.29189019e+04  2.60475950e+04  3.24e-03 1.92e-04  1.53e-02     5s
  30   2.33512471e+04  2.55197954e+04  2.37e-03 1.21e-04  1.06e-02     5s
  31   2.35124635e+04  2.53712378e+04  2.03e-03 1.03e-04  9.08e-03     5s
  32   2.36036546e+04  2.51578775e+04  1.86e-03 7.37e-05  7.59e-03     5s
  33   2.39060646e+04  2.50486694e+04  1.27e-03 5.89e-05  5.58e-03     5s
  34   2.39883947e+04  2.48702582e+04  1.11e-03 5.00e-05  4.31e-03     5s
  35   2.41643048e+04  2.47960237e+04  7.84e-04 3.66e-05  3.08e-03     5s
  36   2.43202957e+04  2.47784375e+04  5.09e-04 3.25e-05  2.24e-03     5s
  37   2.44107724e+04  2.46906891e+04  3.40e-04 1.51e-05  1.37e-03     5s
  38   2.44782116e+04  2.46852709e+04  2.21e-04 1.97e-05  1.01e-03     5s
  39   2.44842870e+04  2.46784760e+04  2.09e-04 1.82e-05  9.48e-04     5s
  40   2.45020285e+04  2.46653904e+04  1.77e-04 1.51e-05  7.98e-04     5s
  41   2.45143954e+04  2.46513025e+04  1.56e-04 1.17e-05  6.68e-04     5s
  42   2.45509210e+04  2.46374233e+04  8.88e-05 8.64e-06  4.22e-04     5s
  43   2.45777401e+04  2.46194158e+04  4.20e-05 3.90e-06  2.03e-04     5s
  44   2.45979739e+04  2.46086746e+04  7.94e-06 1.15e-06  5.22e-05     6s
  45   2.46015072e+04  2.46067233e+04  2.85e-06 7.04e-07  2.55e-05     6s
  46   2.46031394e+04  2.46042163e+04  6.91e-07 8.26e-08  5.26e-06     6s
  47   2.46031557e+04  2.46039262e+04  6.69e-07 3.52e-08  3.76e-06     6s
  48   2.46032975e+04  2.46038764e+04  4.87e-07 2.70e-08  2.83e-06     6s
  49   2.46035478e+04  2.46037085e+04  1.71e-07 3.16e-08  7.84e-07     6s
  50   2.46036150e+04  2.46036996e+04  1.42e-07 9.72e-08  4.13e-07     6s
  51   2.46036859e+04  2.46036970e+04  2.23e-07 2.06e-08  5.41e-08     6s
  52   2.46036964e+04  2.46036970e+04  1.55e-06 7.41e-08  2.82e-09     6s
  53   2.46036967e+04  2.46036970e+04  7.93e-07 4.22e-08  1.44e-09     6s
  54   2.46036970e+04  2.46036970e+04  3.06e-09 4.75e-09  1.76e-12     6s

Barrier solved model in 54 iterations and 6.24 seconds (10.80 work units)
Optimal objective 2.46036970e+04


Root crossover log...

   91863 DPushes remaining with DInf 8.2873772e-09                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    2796 PPushes remaining with PInf 4.3955260e-07                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.3906178e-11      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38649    2.4603697e+04   0.000000e+00   0.000000e+00      8s
   38649    2.4603697e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.460370e+04, 38649 iterations, 6.09 seconds (12.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24603.6970    0  378 -210563.59 24603.6970   112%     -    8s
H    0     0                    -92828.03505 24603.6970   127%     -    9s
H    0     0                    -92663.74088 24603.6970   127%     -    9s
H    0     0                    -91953.08006 24603.6970   127%     -    9s
H    0     0                    -91811.66732 24603.6970   127%     -    9s
H    0     0                    -74435.82653 24603.6970   133%     -    9s
H    0     0                    -73696.57959 24603.6970   133%     -    9s
H    0     0                    -19388.26632 24603.6970   227%     -    9s
H    0     0                    -19220.68557 24603.6970   228%     -    9s
H    0     0                    -18861.89446 24603.6970   230%     -    9s
H    0     0                    -18665.06332 24603.6970   232%     -   11s
H    0     0                    -18004.69939 24603.6970   237%     -   11s
H    0     0                    -17331.81652 24603.6970   242%     -   11s
H    0     0                    -17265.17903 24603.6970   243%     -   11s
     0     0 19892.0007    0  490 -17265.179 19892.0007   215%     -   54s
H    0     0                    -16587.11135 19892.0007   220%     -   55s
H    0     0                    -16553.65998 19892.0007   220%     -   55s
     0     0 18395.8439    0  571 -16553.660 18395.8439   211%     -   77s
     0     0 18360.5444    0  577 -16553.660 18360.5444   211%     -   82s
     0     0 18306.7434    0  572 -16553.660 18306.7434   211%     -   85s
     0     0 18306.7434    0  570 -16553.660 18306.7434   211%     -   89s
     0     0 18306.7434    0  553 -16553.660 18306.7434   211%     -   94s
     0     0 18306.7434    0  557 -16553.660 18306.7434   211%     -   96s
     0     0 18306.7434    0  560 -16553.660 18306.7434   211%     -   97s
     0     0 18306.7434    0  561 -16553.660 18306.7434   211%     -  101s
     0     0 18306.7434    0  556 -16553.660 18306.7434   211%     -  103s
     0     0 18287.4274    0  548 -16553.660 18287.4274   210%     -  106s
     0     0 18285.9055    0  551 -16553.660 18285.9055   210%     -  107s
     0     0 18285.8410    0  556 -16553.660 18285.8410   210%     -  109s
H    0     0                    -16434.22043 15045.2189   192%     -  160s
H    0     0                    -16212.67192 15045.2189   193%     -  160s
H    0     0                    -16200.06417 15045.2189   193%     -  160s
     0     0 15045.2189    0  398 -16200.064 15045.2189   193%     -  160s
H    0     0                    -8907.121558 15045.0790   269%     -  161s
H    0     0                    -8895.704869 15045.0790   269%     -  161s
H    0     0                    -8894.513810 15045.0790   269%     -  161s
H    0     0                    -8674.022762 14138.8841   263%     -  209s
H    0     0                    -6950.770507 14138.8841   303%     -  209s
H    0     0                    -4380.478192 14138.8841   423%     -  209s
H    0     0                    -4248.098844 14138.8841   433%     -  209s
H    0     0                    -4159.043004 14138.8841   440%     -  209s
H    0     0                    -4087.598022 14138.8841   446%     -  209s
     0     0 14138.8841    0  445 -4087.5980 14138.8841   446%     -  209s
     0     0 13884.6880    0  529 -4087.5980 13884.6880   440%     -  246s
     0     0 13706.0215    0  550 -4087.5980 13706.0215   435%     -  279s
     0     0 13650.5528    0  580 -4087.5980 13650.5528   434%     -  304s
     0     0 13607.4269    0  569 -4087.5980 13607.4269   433%     -  323s
     0     0 13572.2756    0  577 -4087.5980 13572.2756   432%     -  341s
H    0     0                    -4054.702089 13549.3009   434%     -  355s
     0     0 13549.3009    0  567 -4054.7021 13549.3009   434%     -  355s
     0     0 13483.9095    0  642 -4054.7021 13483.9095   433%     -  378s
     0     0 13459.0680    0  579 -4054.7021 13459.0680   432%     -  392s
     0     0 13447.4033    0  628 -4054.7021 13447.4033   432%     -  402s
     0     0 13427.7606    0  620 -4054.7021 13427.7606   431%     -  417s
     0     0 13382.4445    0  551 -4054.7021 13382.4445   430%     -  431s
     0     0 13380.7969    0  556 -4054.7021 13380.7969   430%     -  435s
     0     0 13339.7305    0  558 -4054.7021 13339.7305   429%     -  449s
     0     0 13331.6445    0  566 -4054.7021 13331.6445   429%     -  456s
H    0     0                    -4053.697871 13325.4428   429%     -  459s
     0     0 13325.4428    0  556 -4053.6979 13325.4428   429%     -  459s
     0     0 13319.9639    0  556 -4053.6979 13319.9639   429%     -  461s
     0     0 13319.8934    0  559 -4053.6979 13319.8934   429%     -  461s
     0     0 10749.0898    0  643 -4053.6979 10749.0898   365%     -  573s
     0     0 10374.2208    0  632 -4053.6979 10374.2208   356%     -  607s
     0     0 10203.8522    0  670 -4053.6979 10203.8522   352%     -  631s
     0     0 10110.7471    0  655 -4053.6979 10110.7471   349%     -  650s
     0     0 10084.9839    0  643 -4053.6979 10084.9839   349%     -  660s
     0     0 10063.3744    0  629 -4053.6979 10063.3744   348%     -  669s
     0     0 10057.3824    0  637 -4053.6979 10057.3824   348%     -  674s
     0     0 10001.9136    0  622 -4053.6979 10001.9136   347%     -  687s
     0     0 9995.74358    0  625 -4053.6979 9995.74358   347%     -  693s
     0     0 9989.40901    0  616 -4053.6979 9989.40901   346%     -  698s
     0     0 9937.82037    0  630 -4053.6979 9937.82037   345%     -  708s
     0     0 9932.58881    0  627 -4053.6979 9932.58881   345%     -  712s
     0     0 9919.69236    0  619 -4053.6979 9919.69236   345%     -  719s
     0     0 9903.77136    0  641 -4053.6979 9903.77136   344%     -  725s
     0     0 9894.66891    0  636 -4053.6979 9894.66891   344%     -  730s
     0     0 9893.04660    0  639 -4053.6979 9893.04660   344%     -  732s
H    0     0                    -4013.846949 8285.50957   306%     -  837s
H    0     0                    -4006.473544 8285.50957   307%     -  837s
     0     0 8285.50957    0  624 -4006.4735 8285.50957   307%     -  837s
     0     0 7866.24965    0  577 -4006.4735 7866.24965   296%     -  879s
     0     0 7749.23388    0  641 -4006.4735 7749.23388   293%     -  909s
     0     0 7716.13573    0  571 -4006.4735 7716.13573   293%     -  931s
     0     0 7680.63817    0  557 -4006.4735 7680.63817   292%     -  946s
     0     0 7666.28911    0  574 -4006.4735 7666.28911   291%     -  956s
     0     0 7661.82826    0  581 -4006.4735 7661.82826   291%     -  964s
     0     0 7603.57010    0  640 -4006.4735 7603.57010   290%     -  979s
     0     0 7573.78469    0  645 -4006.4735 7573.78469   289%     -  993s
     0     0 7549.29963    0  635 -4006.4735 7549.29963   288%     - 1002s
     0     0 7545.47651    0  642 -4006.4735 7545.47651   288%     - 1006s
     0     0 7543.48754    0  636 -4006.4735 7543.48754   288%     - 1008s
     0     0 7128.16556    0  464 -4006.4735 7128.16556   278%     - 1052s
     0     0 6875.22767    0  535 -4006.4735 6875.22767   272%     - 1082s
     0     0 6812.09698    0  480 -4006.4735 6812.09698   270%     - 1094s
     0     0 6787.25998    0  479 -4006.4735 6787.25998   269%     - 1107s
     0     0 6760.76597    0  562 -4006.4735 6760.76597   269%     - 1119s
     0     0 6747.57487    0  481 -4006.4735 6747.57487   268%     - 1128s
     0     0 6742.79059    0  478 -4006.4735 6742.79059   268%     - 1133s
     0     0 6734.61087    0  551 -4006.4735 6734.61087   268%     - 1141s
     0     0 6733.48058    0  473 -4006.4735 6733.48058   268%     - 1144s
     0     0 6504.13037    0  609 -4006.4735 6504.13037   262%     - 1174s
     0     0 6457.57823    0  678 -4006.4735 6457.57823   261%     - 1190s
     0     0 6429.66577    0  669 -4006.4735 6429.66577   260%     - 1200s
     0     0 6409.59182    0  607 -4006.4735 6409.59182   260%     - 1207s
     0     0 6405.50514    0  615 -4006.4735 6405.50514   260%     - 1212s
     0     0 6403.58379    0  537 -4006.4735 6403.58379   260%     - 1217s
     0     0 6337.84848    0  477 -4006.4735 6337.84848   258%     - 1232s
     0     0 6309.84705    0  461 -4006.4735 6309.84705   257%     - 1240s
     0     0 6298.54002    0  469 -4006.4735 6298.54002   257%     - 1247s
     0     0 6292.92733    0  481 -4006.4735 6292.92733   257%     - 1254s
     0     0 6278.95604    0  481 -4006.4735 6278.95604   257%     - 1262s
     0     0 6267.15086    0  479 -4006.4735 6267.15086   256%     - 1268s
     0     0 6261.55500    0  474 -4006.4735 6261.55500   256%     - 1276s
     0     0 6256.66347    0  468 -4006.4735 6256.66347   256%     - 1282s
     0     0 6254.19271    0  474 -4006.4735 6254.19271   256%     - 1286s
     0     0 6176.31462    0  637 -4006.4735 6176.31462   254%     - 1306s
     0     0 6150.26694    0  566 -4006.4735 6150.26694   254%     - 1317s
     0     0 6133.08089    0  568 -4006.4735 6133.08089   253%     - 1323s
     0     0 6127.68029    0  651 -4006.4735 6127.68029   253%     - 1328s
     0     0 6126.18236    0  566 -4006.4735 6126.18236   253%     - 1330s
     0     0 6087.78213    0  566 -4006.4735 6087.78213   252%     - 1344s
     0     0 6081.86328    0  489 -4006.4735 6081.86328   252%     - 1349s
     0     0 6079.38842    0  497 -4006.4735 6079.38842   252%     - 1352s
     0     0 6053.67508    0  560 -4006.4735 6053.67508   251%     - 1363s
     0     0 6050.22134    0  575 -4006.4735 6050.22134   251%     - 1368s
     0     0 6049.24569    0  573 -4006.4735 6049.24569   251%     - 1370s
     0     0 6013.98236    0  586 -4006.4735 6013.98236   250%     - 1380s
     0     0 6005.00299    0  493 -4006.4735 6005.00299   250%     - 1387s
     0     0 6001.68241    0  490 -4006.4735 6001.68241   250%     - 1390s
     0     0 5999.84347    0  496 -4006.4735 5999.84347   250%     - 1392s
     0     0 5994.17741    0  509 -4006.4735 5994.17741   250%     - 1398s
     0     0 5990.10109    0  505 -4006.4735 5990.10109   250%     - 1420s
     0     0 5989.07482    0  512 -4006.4735 5989.07482   249%     - 1421s
     0     0 5974.88430    0  484 -4006.4735 5974.88430   249%     - 1428s
     0     0 5966.22417    0  502 -4006.4735 5966.22417   249%     - 1434s
     0     0 5964.00952    0  502 -4006.4735 5964.00952   249%     - 1436s
     0     0 5957.19360    0  506 -4006.4735 5957.19360   249%     - 1443s
     0     0 5957.01357    0  506 -4006.4735 5957.01357   249%     - 1449s
     0     2 5956.98902    0  506 -4006.4735 5956.98902   249%     - 1930s
     1     4 5897.94623    1  503 -4006.4735 5956.98902   249% 12457 1943s
     3     8 5789.90221    2  485 -4006.4735 5897.60359   247% 11272 1967s
     7    16 5738.34582    3  644 -4006.4735 5789.06546   244% 13468 1990s
    15    32 5626.23548    4  631 -4006.4735 5738.09189   243% 14097 2029s
    31    48 4749.53574    5  529 -4006.4735 5626.03462   240% 20078 3032s
    47    77 3055.28867    6  519 -4006.4735 5626.03462   240% 23939 3079s
    78   157 4173.14134    7  445 -4006.4735 5626.03462   240% 19815 3166s
   158   268 4130.89152    8  438 -4006.4735 5626.03462   240% 13103 3197s
   269   352 4090.62749   10  441 -4006.4735 5626.03462   240% 10136 3221s
   355   415 4036.89296   14  431 -4006.4735 5626.03462   240%  8962 3240s
   422   480 4000.59490   15  420 -4006.4735 5626.03462   240%  8381 3257s
   497   503 -2038.7757   24  131 -4006.4735 5626.03462   240%  7891 3275s
   526   525 3556.49605   17  400 -4006.4735 5626.03462   240%  7845 3291s
   554   552 3220.15380   18  401 -4006.4735 5626.03462   240%  7870 3306s
   585   583 2971.83897   19  391 -4006.4735 5626.03462   240%  7875 3324s
   625   615 2578.11137   20  391 -4006.4735 5626.03462   240%  7700 3339s
   663   650 2524.07068   21  377 -4006.4735 5626.03462   240%  7654 3361s
   715   666  985.35064   22  438 -4006.4735 5626.03462   240%  7504 3387s
   763   685  966.57429   23  366 -4006.4735 5626.03462   240%  7369 3403s
   816   694 -102.65474   24  340 -4006.4735 5626.03462   240%  7276 3419s
   851   711 -710.41376   25  276 -4006.4735 5626.03462   240%  7307 3437s
   894   725 -1388.1216   18  100 -4006.4735 5626.03462   240%  7371 3455s
   944   744 -892.52941   26  235 -4006.4735 5626.03462   240%  7336 3473s
   991   778 -990.80045   27  241 -4006.4735 5626.03462   240%  7348 3489s
  1039   811 -1063.5949   28  238 -4006.4735 5626.03462   240%  7290 3509s
  1116   855 -1191.7551   29  237 -4006.4735 5626.03462   240%  7143 3530s
  1202   885 -1659.2408   30  236 -4006.4735 5626.03462   240%  6913 3553s
  1309   916 -3622.1529   31  287 -4006.4735 5626.03462   240%  6706 3575s
  1415   922 infeasible   32      -4006.4735 5626.03462   240%  6547 3600s

Cutting planes:
  Learned: 1
  Gomory: 10
  Implied bound: 251
  MIR: 4276
  Flow cover: 3167
  Zero half: 4
  RLT: 207
  Relax-and-lift: 1125

Explored 1491 nodes (10845834 simplex iterations) in 3600.05 seconds (7544.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4006.47 -4013.85 -4053.7 ... -8674.02

Time limit reached
Best objective -4.006473544490e+03, best bound 5.626034619158e+03, gap 240.4236%
  WARNING: Time limit reached. Using best solution found (gap: 240.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -4006.47, θ = 119348.63
  Upper Bound (UB) = -4006.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119348.63
  [DEBUG]   ✓ Scenario 0: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119348.63 ≤ Q = 119348.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119348.63 ≤ Q = 119348.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 119348.63 ≤ Q = 119348.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7b0cc692
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7b0cc692
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.270256e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6623016.4697
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.223099e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122309.89    0  123 6623016.47 -122309.89   102%     -    0s
H    0     0                    -89501.99819 -122309.89  36.7%     -    0s
H    0     0                    -89909.64200 -122309.89  36.0%     -    0s
     0     0 -94463.012    0   75 -89909.642 -94463.012  5.06%     -    0s
H    0     0                    -92063.70063 -94457.043  2.60%     -    0s
H    0     0                    -92361.40569 -94457.043  2.27%     -    0s
     0     0 -94184.855    0   76 -92361.406 -94184.855  1.97%     -    0s
H    0     0                    -93544.27476 -94176.931  0.68%     -    0s
H    0     0                    -93755.70480 -94176.931  0.45%     -    0s
H    0     0                    -94079.73816 -94176.931  0.10%     -    0s
H    0     0                    -94083.50948 -94176.931  0.10%     -    0s
     0     0 -94096.649    0    6 -94083.509 -94096.649  0.01%     -    0s
     0     0 -94093.566    0    2 -94083.509 -94093.566  0.01%     -    0s

Cutting planes:
  Gomory: 11
  MIR: 148
  RLT: 1

Explored 1 nodes (462 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -94083.5 -93755.7 -93544.3 ... 1.27026e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.408350947961e+04, best bound -9.409071182242e+04, gap 0.0077%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 117442.50
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94083.51
  [DEBUG]   S×d_nominal = 211526.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211526.01 + -94083.51 = 117442.50
  [DEBUG]   Current θ from Master = 119348.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1906.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5912.61
  Lower Bound (LB) = -4438.37
  Gap (UB-LB) = 431.8970, Absolute Gap = 431.8970, Relative Gap = 0.107800
  Not converged yet (gap = 431.90 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610879 nonzeros
Model fingerprint: 0xf4bb6513
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94898 rows and 38538 columns
Presolve time: 1.97s
Presolved: 120545 rows, 51082 columns, 742320 nonzeros
Variable types: 48823 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 5.434e+06
 Factor NZ  : 1.219e+07 (roughly 170 MB of memory)
 Factor Ops : 2.549e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.04443289e+07  1.83572665e+08  5.87e+04 2.25e+01  4.54e+04     4s
   1  -8.02913243e+06  1.56534084e+08  4.12e+04 4.38e+01  3.15e+04     4s
   2  -3.47784925e+06  1.23703186e+08  1.64e+04 2.24e+01  1.30e+04     4s
   3  -7.62090407e+05  7.46817167e+07  1.59e+03 4.87e-01  1.49e+03     4s
   4  -4.63328115e+05  4.46731785e+07  3.55e+02 2.28e-01  4.42e+02     4s
   5  -4.07209567e+05  2.96030645e+07  1.96e+02 1.29e-01  2.56e+02     4s
   6  -3.34723439e+05  2.01415035e+07  6.36e+01 7.88e-02  1.28e+02     4s
   7  -2.20914189e+05  1.57135755e+07  1.29e+01 5.90e-02  7.86e+01     4s
   8  -1.41245557e+05  8.32592664e+06  2.67e+00 2.96e-02  3.92e+01     4s
   9  -1.18381506e+05  5.25169902e+06  1.63e+00 1.86e-02  2.47e+01     4s
  10  -8.84470500e+04  3.05470299e+06  8.02e-01 1.09e-02  1.44e+01     4s
  11  -7.17358232e+04  8.38024949e+05  4.32e-01 2.88e-03  4.15e+00     4s
  12  -4.34618367e+04  3.50849760e+05  1.67e-01 1.16e-03  1.79e+00     4s
  13  -2.20974037e+04  2.00493678e+05  7.97e-02 6.34e-04  1.01e+00     4s
  14  -1.57044660e+04  1.38524069e+05  6.43e-02 5.47e-04  7.01e-01     4s
  15  -1.04077570e+04  1.05803737e+05  5.34e-02 9.91e-04  5.28e-01     4s
  16  -3.92962685e+03  8.10688502e+04  4.09e-02 8.50e-04  3.86e-01     4s
  17  -2.23637355e+03  7.32159585e+04  3.76e-02 9.42e-04  3.43e-01     4s
  18   1.13183936e+03  6.10565254e+04  3.14e-02 1.43e-03  2.72e-01     4s
  19   4.52376332e+03  5.24295661e+04  2.50e-02 1.13e-03  2.18e-01     5s
  20   8.07367017e+03  4.48325550e+04  1.87e-02 8.77e-04  1.67e-01     5s
  21   1.08756766e+04  4.18962806e+04  1.41e-02 7.79e-04  1.41e-01     5s
  22   1.24834961e+04  3.55152517e+04  1.18e-02 5.27e-04  1.05e-01     5s
  23   1.37632033e+04  3.35372202e+04  1.01e-02 4.50e-04  8.98e-02     5s
  24   1.50796538e+04  3.01785784e+04  8.36e-03 3.35e-04  6.86e-02     5s
  25   1.58231853e+04  2.86766416e+04  7.46e-03 2.72e-04  5.84e-02     5s
  26   1.78502185e+04  2.77486175e+04  5.03e-03 2.35e-04  4.50e-02     5s
  27   1.84380288e+04  2.74201321e+04  4.36e-03 2.21e-04  4.08e-02     5s
  28   1.87865896e+04  2.69915211e+04  3.98e-03 2.02e-04  3.73e-02     5s
  29   1.90061585e+04  2.61530389e+04  3.71e-03 1.66e-04  3.25e-02     5s
  30   1.96184009e+04  2.50535352e+04  3.03e-03 1.13e-04  2.47e-02     5s
  31   2.04664474e+04  2.45471790e+04  2.11e-03 8.98e-05  1.85e-02     5s
  32   2.08850123e+04  2.38309962e+04  1.67e-03 6.02e-05  1.34e-02     6s
  33   2.12530054e+04  2.35131532e+04  1.30e-03 4.43e-05  1.03e-02     6s
  34   2.13975893e+04  2.31785615e+04  1.15e-03 2.80e-05  8.09e-03     6s
  35   2.16771775e+04  2.30454295e+04  8.71e-04 3.78e-05  6.22e-03     6s
  36   2.19320873e+04  2.29189031e+04  5.93e-04 2.70e-05  4.48e-03     6s
  37   2.19457560e+04  2.28510774e+04  5.79e-04 2.21e-05  4.11e-03     6s
  38   2.21020061e+04  2.28177132e+04  4.28e-04 1.96e-05  3.25e-03     6s
  39   2.22393729e+04  2.27212239e+04  2.92e-04 1.26e-05  2.19e-03     6s
  40   2.23219382e+04  2.26524856e+04  2.06e-04 7.24e-06  1.50e-03     6s
  41   2.23724753e+04  2.26282964e+04  1.58e-04 5.99e-06  1.16e-03     6s
  42   2.24227400e+04  2.26102001e+04  1.10e-04 4.64e-06  8.52e-04     6s
  43   2.24430378e+04  2.25819638e+04  9.10e-05 2.52e-06  6.31e-04     6s
  44   2.24739675e+04  2.25633587e+04  6.29e-05 1.13e-06  4.06e-04     7s
  45   2.24904465e+04  2.25551832e+04  4.80e-05 5.92e-07  2.94e-04     7s
  46   2.25137256e+04  2.25527400e+04  2.71e-05 4.20e-07  1.77e-04     7s
  47   2.25239055e+04  2.25496063e+04  1.83e-05 2.21e-07  1.17e-04     7s
  48   2.25384040e+04  2.25481764e+04  6.05e-06 1.29e-07  4.44e-05     7s
  49   2.25408205e+04  2.25468068e+04  4.05e-06 3.30e-08  2.72e-05     7s
  50   2.25438727e+04  2.25465074e+04  1.66e-06 1.76e-08  1.20e-05     7s
  51   2.25450025e+04  2.25461753e+04  8.25e-07 1.57e-09  5.33e-06     7s
  52   2.25455847e+04  2.25461476e+04  3.79e-07 1.05e-09  2.56e-06     7s
  53   2.25459692e+04  2.25461210e+04  1.04e-07 4.73e-10  6.90e-07     7s
  54   2.25461059e+04  2.25461189e+04  5.72e-07 9.22e-08  5.94e-08     7s
  55   2.25461170e+04  2.25461187e+04  1.67e-07 2.37e-10  7.92e-09     7s
  56   2.25461187e+04  2.25461187e+04  1.70e-08 9.96e-11  4.57e-11     7s

Barrier solved model in 56 iterations and 7.42 seconds (12.62 work units)
Optimal objective 2.25461187e+04


Root crossover log...

  100923 DPushes remaining with DInf 0.0000000e+00                 8s
   13787 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    2722 PPushes remaining with PInf 8.7837715e-06                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0282844e-01     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50521    2.2546119e+04   0.000000e+00   1.028284e-01     12s
   50523    2.2546119e+04   0.000000e+00   0.000000e+00     12s
   50523    2.2546119e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 1.37s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 2.254612e+04, 50523 iterations, 11.21 seconds (23.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22546.1187    0  352 -210563.59 22546.1187   111%     -   14s
H    0     0                    -209180.6100 22546.1187   111%     -   14s
H    0     0                    -134284.3252 22546.1187   117%     -   14s
H    0     0                    -82943.14698 22546.1187   127%     -   14s
H    0     0                    -42340.84854 22546.1187   153%     -   14s
H    0     0                    -42322.39645 22546.1187   153%     -   14s
H    0     0                    -16383.62992 22546.1187   238%     -   15s
H    0     0                    -4892.029882 22546.1187   561%     -   15s
H    0     0                    -4300.938755 22546.1187   624%     -   15s
H    0     0                    -4238.618156 22546.1187   632%     -   18s
H    0     0                    -4204.715830 22546.1187   636%     -   18s
H    0     0                    -4145.007546 16670.9694   502%     -   70s
H    0     0                    -4120.341602 16670.9694   505%     -   70s
     0     0 16238.2109    0  411 -4120.3416 16238.2109   494%     -   70s
H    0     0                    -4118.377106 16238.2109   494%     -   71s
H    0     0                    -4047.342425 16238.2109   501%     -   71s
     0     0 15895.0329    0  437 -4047.3424 15895.0329   493%     -   83s
     0     0 15847.3870    0  449 -4047.3424 15847.3870   492%     -   90s
     0     0 15439.9413    0  456 -4047.3424 15439.9413   481%     -  105s
     0     0 15430.8721    0  461 -4047.3424 15430.8721   481%     -  108s
     0     0 15430.8721    0  460 -4047.3424 15430.8721   481%     -  121s
     0     0 15430.8721    0  461 -4047.3424 15430.8721   481%     -  124s
     0     0 15430.8721    0  455 -4047.3424 15430.8721   481%     -  128s
     0     0 15430.8721    0  457 -4047.3424 15430.8721   481%     -  131s
     0     0 15430.8721    0  458 -4047.3424 15430.8721   481%     -  131s
     0     0 12579.8936    0  485 -4047.3424 12579.8936   411%     -  179s
H    0     0                    -4045.461998 12579.5579   411%     -  180s
     0     0 11979.4373    0  480 -4045.4620 11979.4373   396%     -  203s
     0     0 11482.4817    0  477 -4045.4620 11482.4817   384%     -  229s
     0     0 11436.5014    0  473 -4045.4620 11436.5014   383%     -  239s
     0     0 11331.0766    0  457 -4045.4620 11331.0766   380%     -  249s
     0     0 11302.7115    0  466 -4045.4620 11302.7115   379%     -  258s
     0     0 11143.7873    0  480 -4045.4620 11143.7873   375%     -  267s
     0     0 11135.8223    0  481 -4045.4620 11135.8223   375%     -  272s
     0     0 11098.5609    0  482 -4045.4620 11098.5609   374%     -  279s
     0     0 11078.5441    0  483 -4045.4620 11078.5441   374%     -  284s
     0     0 11065.7284    0  466 -4045.4620 11065.7284   374%     -  286s
     0     0 11062.9172    0  485 -4045.4620 11062.9172   373%     -  289s
     0     0 11058.1915    0  478 -4045.4620 11058.1915   373%     -  291s
     0     0 11047.9376    0  484 -4045.4620 11047.9376   373%     -  295s
     0     0 11006.3001    0  465 -4045.4620 11006.3001   372%     -  302s
     0     0 11002.9981    0  479 -4045.4620 11002.9981   372%     -  305s
     0     0 11002.5344    0  481 -4045.4620 11002.5344   372%     -  305s
     0     0 9175.21774    0  453 -4045.4620 9175.21774   327%     -  358s
H    0     0                    -4038.088593 9174.97530   327%     -  359s
     0     0 8428.35146    0  452 -4038.0886 8428.35146   309%     -  400s
     0     0 8157.57474    0  464 -4038.0886 8157.57474   302%     -  424s
     0     0 8020.19973    0  463 -4038.0886 8020.19973   299%     -  437s
     0     0 7900.64004    0  466 -4038.0886 7900.64004   296%     -  447s
     0     0 7792.98955    0  471 -4038.0886 7792.98955   293%     -  462s
     0     0 7784.06011    0  482 -4038.0886 7784.06011   293%     -  465s
     0     0 7564.54587    0  469 -4038.0886 7564.54587   287%     -  476s
     0     0 7478.50039    0  472 -4038.0886 7478.50039   285%     -  485s
     0     0 7467.87988    0  473 -4038.0886 7467.87988   285%     -  489s
     0     0 7464.96172    0  479 -4038.0886 7464.96172   285%     -  492s
     0     0 7417.46640    0  513 -4038.0886 7417.46640   284%     -  498s
     0     0 7405.54553    0  479 -4038.0886 7405.54553   283%     -  503s
     0     0 7399.33693    0  479 -4038.0886 7399.33693   283%     -  504s
     0     0 7397.03518    0  527 -4038.0886 7397.03518   283%     -  507s
     0     0 7376.10928    0  475 -4038.0886 7376.10928   283%     -  512s
     0     0 7366.79476    0  480 -4038.0886 7366.79476   282%     -  515s
     0     0 7348.06043    0  482 -4038.0886 7348.06043   282%     -  518s
     0     0 7345.99347    0  485 -4038.0886 7345.99347   282%     -  521s
     0     0 7345.87917    0  487 -4038.0886 7345.87917   282%     -  521s
     0     0 6696.02654    0  452 -4038.0886 6696.02654   266%     -  553s
     0     0 6469.08658    0  455 -4038.0886 6469.08658   260%     -  569s
     0     0 6366.12655    0  472 -4038.0886 6366.12655   258%     -  584s
     0     0 6298.34638    0  483 -4038.0886 6298.34638   256%     -  597s
     0     0 6233.85749    0  508 -4038.0886 6233.85749   254%     -  606s
     0     0 6210.67185    0  522 -4038.0886 6210.67185   254%     -  611s
     0     0 6200.29346    0  477 -4038.0886 6200.29346   254%     -  614s
     0     0 6196.28367    0  481 -4038.0886 6196.28367   253%     -  615s
     0     0 6193.64451    0  480 -4038.0886 6193.64451   253%     -  616s
     0     0 6190.70405    0  477 -4038.0886 6190.70405   253%     -  618s
     0     0 6187.47992    0  476 -4038.0886 6187.47992   253%     -  619s
     0     0 6174.79937    0  477 -4038.0886 6174.79937   253%     -  622s
     0     0 6170.10904    0  483 -4038.0886 6170.10904   253%     -  623s
     0     0 6169.33118    0  489 -4038.0886 6169.33118   253%     -  625s
     0     0 5990.89190    0  551 -4038.0886 5990.89190   248%     -  640s
     0     0 5879.06974    0  547 -4038.0886 5879.06974   246%     -  650s
     0     0 5849.58683    0  553 -4038.0886 5849.58683   245%     -  654s
     0     0 5836.08369    0  553 -4038.0886 5836.08369   245%     -  657s
     0     0 5832.38015    0  564 -4038.0886 5832.38015   244%     -  659s
     0     0 5830.77785    0  567 -4038.0886 5830.77785   244%     -  661s
     0     0 5765.20771    0  484 -4038.0886 5765.20771   243%     -  671s
     0     0 5747.26279    0  504 -4038.0886 5747.26279   242%     -  676s
     0     0 5738.06257    0  508 -4038.0886 5738.06257   242%     -  681s
     0     0 5732.50852    0  500 -4038.0886 5732.50852   242%     -  685s
     0     0 5729.03051    0  497 -4038.0886 5729.03051   242%     -  688s
     0     0 5728.28632    0  500 -4038.0886 5728.28632   242%     -  689s
     0     0 5701.50395    0  493 -4038.0886 5701.50395   241%     -  696s
     0     0 5676.30116    0  486 -4038.0886 5676.30116   241%     -  702s
     0     0 5669.62245    0  475 -4038.0886 5669.62245   240%     -  708s
     0     0 5665.98725    0  482 -4038.0886 5665.98725   240%     -  710s
     0     0 5664.85349    0  541 -4038.0886 5664.85349   240%     -  712s
     0     0 5645.25431    0  483 -4038.0886 5645.25431   240%     -  718s
     0     0 5643.42796    0  489 -4038.0886 5643.42796   240%     -  720s
     0     0 5638.89785    0  550 -4038.0886 5638.89785   240%     -  726s
     0     0 5632.87751    0  493 -4038.0886 5632.87751   239%     -  732s
     0     0 5625.44391    0  492 -4038.0886 5625.44391   239%     -  735s
     0     0 5624.66112    0  504 -4038.0886 5624.66112   239%     -  737s
     0     0 5606.21241    0  482 -4038.0886 5606.21241   239%     -  743s
     0     0 5599.04010    0  489 -4038.0886 5599.04010   239%     -  747s
     0     0 5597.74447    0  552 -4038.0886 5597.74447   239%     -  750s
     0     0 5590.33465    0  550 -4038.0886 5590.33465   238%     -  754s
     0     0 5587.58975    0  498 -4038.0886 5587.58975   238%     -  758s
     0     0 5587.17720    0  495 -4038.0886 5587.17720   238%     -  760s
     0     0 5585.72747    0  491 -4038.0886 5585.72747   238%     -  763s
     0     0 5585.60764    0  491 -4038.0886 5585.60764   238%     -  770s
H    0     0                    -4032.098750 5585.60764   239%     -  859s
     0     2 5585.60764    0  491 -4032.0988 5585.60764   239%     -  860s
     1     4 5557.98726    1  482 -4032.0988 5584.75452   239%  2327  872s
     3     7 4533.75012    2  442 -4032.0988 5557.97173   238%  7424  885s
     6    12 4263.60138    3  441 -4032.0988 5557.97173   238%  8104  896s
    11    23 3037.25554    4  438 -4032.0988 5427.26980   235%  8217  911s
    22    34 2166.26802    4  383 -4032.0988 5427.26980   235% 13452  957s
    33    66 3036.79329    4  405 -4032.0988 5278.62335   231% 12525 1081s
H   38    66                    -4006.926908 5278.62335   232% 12230 1081s
    65   169 2663.95500    5  393 -4006.9269 5071.47067   227% 16393 1110s
   168   262 2394.41736    8  395 -4006.9269 5071.25883   227%  9597 1127s
   261   326 -2258.3061   13  188 -4006.9269 5071.25883   227%  7828 1140s
   327   367 2121.31317   13  366 -4006.9269 5071.25883   227%  7467 1154s
   371   402 1607.00833   14  369 -4006.9269 5071.25883   227%  7336 1169s
   451   424 1409.93289   15  351 -4006.9269 5071.25883   227%  6753 1183s
   508   459 1332.34506   16  353 -4006.9269 5071.25883   227%  6584 1196s
   576   493 1127.67208   17  346 -4006.9269 5071.25883   227%  6504 1210s
   649   541 1051.14121   18  351 -4006.9269 5071.25883   227%  6367 1222s
   720   564  -13.65910   19  349 -4006.9269 5071.25883   227%  6127 1234s
   788   578  -62.07042   20  345 -4006.9269 5071.25883   227%  5981 1246s
   862   593 -191.10241   21  334 -4006.9269 5071.25883   227%  5860 1260s
   931   621 -355.15843   22  346 -4006.9269 5071.25883   227%  5848 1274s
   995   646 infeasible   16      -4006.9269 5071.25883   227%  5803 1288s
  1061   664 -1538.0371   23  353 -4006.9269 5071.25883   227%  5789 1300s
  1093   698 -1563.8096   24  352 -4006.9269 5071.25883   227%  5793 1313s
  1141   725     cutoff   25      -4006.9269 5071.25883   227%  5820 1326s
  1191   737 -1712.3384   25  350 -4006.9269 5071.25883   227%  5765 1341s
  1248   758 -1856.5441   26  338 -4006.9269 4702.93185   217%  5768 1358s
  1296   780 -1860.2563   27  340 -4006.9269 4702.93185   217%  5797 1375s
  1346   824 -1879.9820   28  333 -4006.9269 4702.93185   217%  5865 1392s
  1418   858 -2134.5090   30  344 -4006.9269 4702.93185   217%  5871 1407s
  1488   890 -2707.6700   33  317 -4006.9269 4702.93185   217%  5858 1426s
  1578   924 -3198.3955   36  305 -4006.9269 4702.93185   217%  5885 1442s
  1656   995 -3704.3668   41  301 -4006.9269 4702.93185   217%  5879 1461s
  1741  1048 infeasible   45      -4006.9269 4702.93185   217%  5911 1481s
  1866  1100 2644.57270   11  425 -4006.9269 4702.93185   217%  5839 1501s
  1972  1150 -2871.1594   23  100 -4006.9269 4702.93185   217%  5829 1524s
  2056  1217 1866.20235   12  399 -4006.9269 4494.18419   212%  5845 1547s
  2168  1279  209.60551   13  376 -4006.9269 4237.24312   206%  5820 1569s
  2284  1346 -1834.0994   14  381 -4006.9269 4237.24312   206%  5736 1591s
  2405  1402 -2004.3857   15  390 -4006.9269 4237.24312   206%  5685 1614s
  2540  1430 infeasible   17      -4006.9269 3839.90130   196%  5641 1640s
  2659  1485 -2754.6216   19  377 -4006.9269 3839.90130   196%  5622 1666s
  2730  1508 -2966.8691   22  296 -4006.9269 3839.90130   196%  5769 1700s
  2769  1534 -3124.3712   23  384 -4006.9269 3839.90130   196%  5860 1727s
  2807  1567 infeasible   24      -4006.9269 3839.90130   196%  5927 1756s
  2850  1623 -3870.8826   23  350 -4006.9269 3839.90130   196%  5987 1781s
  2920  1685 infeasible   24      -4006.9269 3839.90130   196%  5970 1804s
  3012  1729  305.85601   10  450 -4006.9269 3839.90130   196%  5941 1835s
  3098  1753  260.66513   11  454 -4006.9269 3839.90130   196%  5926 1864s
  3196  1786 -831.07654   12  484 -4006.9269 3839.90130   196%  5923 1895s
  3285  1806 -990.97399   13  477 -4006.9269 3524.38031   188%  5980 1923s
  3343  1842 -1172.3883   14  472 -4006.9269 3524.38031   188%  6063 1959s
  3427  1886 -1209.1282   15  472 -4006.9269 3524.38031   188%  6105 1991s
  3530  1938 -1226.1878   16  469 -4006.9269 3524.38031   188%  6173 2036s
  3654  1989 -3252.3309   17  295 -4006.9269 3524.38031   188%  6216 2079s
  3777  2045 -3924.4798   22  151 -4006.9269 3099.66624   177%  6289 2123s
  3922  2102 -3895.8474   33  344 -4006.9269 2966.20488   174%  6367 2163s
  4068  2172  166.43258   10  403 -4006.9269 2949.53534   174%  6450 2207s
  4261  2213     cutoff   12      -4006.9269 2949.53534   174%  6497 2255s
  4417  2244 -2206.3254   12  325 -4006.9269 2949.53534   174%  6611 2300s
  4520  2310 -2664.0575   15  203 -4006.9269 2949.25966   174%  6661 2350s
  4685  2349     cutoff   34      -4006.9269 2881.90410   172%  6691 2401s
  4852  2395 1098.04722   12  415 -4006.9269 2862.26618   171%  6754 2448s
  5004  2412     cutoff   15      -4006.9269 2742.68876   168%  6891 2506s
  5184  2507 -2908.7428   17  273 -4006.9269 2742.68876   168%  6991 2567s
  5439  2554 -2899.2978   17  463 -4006.9269 2629.60191   166%  7002 2627s
  5631  2614 -2873.6734   12  333 -4006.9269 2629.60191   166%  7112 2692s
  5861  2682 1725.35969   10  292 -4006.9269 2629.60191   166%  7214 2759s
  6114  2769 -570.15834   14  196 -4006.9269 2629.60191   166%  7278 2826s
  6361  2770 -1667.5608   14  491 -4006.9269 2440.24276   161%  7352 3090s
  6363  2771 -2104.8164   13  283 -4006.9269 2440.24276   161%  7349 3104s
  6364  2772 -527.32110    7  474 -4006.9269 2440.24276   161%  7348 3203s
  6365  2773   49.55248   10  494 -4006.9269 2440.24276   161%  7347 3267s
  6366  2773 2072.72387   13  556 -4006.9269 2440.24276   161%  7346 3313s
  6367  2774 -2327.8516   18  446 -4006.9269 2440.24276   161%  7345 3338s
  6368  2775 -496.00517   10  507 -4006.9269 2440.24276   161%  7343 3359s
  6369  2775 -2387.7962   14  524 -4006.9269 2440.24276   161%  7342 3384s
  6370  2776 1740.35617   11  541 -4006.9269 2440.24276   161%  7341 3396s
  6371  2777 -3799.7384   30  531 -4006.9269 2440.24276   161%  7340 3403s
  6372  2777 -2836.6051   32  550 -4006.9269 2440.24276   161%  7339 3411s
  6373  2778 -3769.4358   38  580 -4006.9269 2440.24276   161%  7338 3431s
  6374  2779 -2277.5020   20  533 -4006.9269 2440.24276   161%  7337 3442s
  6375  2779 -2968.9067   19  544 -4006.9269 2440.24276   161%  7335 3452s
  6376  2780 1441.77672   12  572 -4006.9269 2440.24276   161%  7334 3463s
  6377  2781  841.60298   14  550 -4006.9269 2440.24276   161%  7333 3489s
  6378  2781   83.74576    9  531 -4006.9269 2440.24276   161%  7332 3501s
  6379  2782 -3368.4845   49  536 -4006.9269 2440.24276   161%  7331 3507s
  6380  2783  777.40339    7  548 -4006.9269 2440.24276   161%  7330 3515s
  6381  2783 -286.38930   11  562 -4006.9269 2440.24276   161%  7329 3531s
  6382  2784 -2937.1081   16  559 -4006.9269 2440.24276   161%  7327 3542s
  6383  2785 -2598.7354   33  569 -4006.9269 2440.24276   161%  7326 3552s
  6384  2785 -1985.3704   17  565 -4006.9269 2440.24276   161%  7325 3557s
  6385  2786 -2564.5461   31  500 -4006.9269 2440.24276   161%  7324 3577s
  6386  2787  753.71075   15  498 -4006.9269 2440.24276   161%  7323 3584s
  6387  2787 -1510.8584   13  488 -4006.9269 2440.24276   161%  7322 3590s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 11
  Projected implied bound: 152
  MIR: 1340
  Mixing: 3
  Flow cover: 1289
  Zero half: 4
  RLT: 34
  Relax-and-lift: 167

Explored 6387 nodes (47826596 simplex iterations) in 3600.11 seconds (8857.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4006.93 -4032.1 -4038.09 ... -4238.62

Time limit reached
Best objective -4.006926907670e+03, best bound 2.440242758445e+03, gap 160.9006%
  WARNING: Time limit reached. Using best solution found (gap: 160.90%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.32s
  Master Objective (UB) = -4006.93, θ = 119867.36
  Upper Bound (UB) = -4006.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119867.36
  [DEBUG]   ✓ Scenario 0: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119867.36 ≤ Q = 119867.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 119867.36 ≤ Q = 119867.36 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 119867.36 ≤ Q = 119867.36 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 119867.36 ≤ Q = 119867.36 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7d31abf5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7d31abf5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.272873e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6623179.4255
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.217020e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -121701.97    0  123 6623179.43 -121701.97   102%     -    0s
H    0     0                    -88978.05935 -121701.97  36.8%     -    0s
H    0     0                    -89385.70317 -121701.97  36.2%     -    0s
     0     0 -96291.801    0   32 -89385.703 -96291.801  7.73%     -    0s
H    0     0                    -95633.19699 -96198.936  0.59%     -    0s
     0     0 -95960.005    0   15 -95633.197 -95960.005  0.34%     -    0s
     0     0 -95953.375    0   10 -95633.197 -95953.375  0.33%     -    0s
H    0     0                    -95947.34225 -95950.593  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 130

Explored 1 nodes (433 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -95947.3 -95633.2 -89385.7 ... 1.27287e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.594734225481e+04, best bound -9.595059325968e+04, gap 0.0034%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 115578.66
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95947.34
  [DEBUG]   S×d_nominal = 211526.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211526.01 + -95947.34 = 115578.66
  [DEBUG]   Current θ from Master = 119867.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4288.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8295.62
  Lower Bound (LB) = -4438.37
  Gap (UB-LB) = 431.4436, Absolute Gap = 431.4436, Relative Gap = 0.107674
  Not converged yet (gap = 431.44 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654119 nonzeros
Model fingerprint: 0xf1836318
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101685 rows and 41295 columns
Presolve time: 2.11s
Presolved: 129048 rows, 54565 columns, 794796 nonzeros
Variable types: 52306 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 6.149e+06
 Factor NZ  : 1.374e+07 (roughly 200 MB of memory)
 Factor Ops : 3.006e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.08151013e+07  1.94131965e+08  6.06e+04 2.25e+01  4.66e+04     4s
   1  -8.34495147e+06  1.66026894e+08  4.26e+04 4.48e+01  3.24e+04     4s
   2  -3.73456015e+06  1.32922318e+08  1.77e+04 2.60e+01  1.39e+04     4s
   3  -8.50643416e+05  8.64112839e+07  1.89e+03 2.55e-01  1.74e+03     4s
   4  -4.98160230e+05  5.30600769e+07  4.22e+02 9.23e-02  5.13e+02     4s
   5  -4.28743958e+05  3.17794062e+07  2.08e+02 4.93e-02  2.64e+02     4s
   6  -3.47287802e+05  2.21067507e+07  7.06e+01 3.14e-02  1.35e+02     4s
   7  -2.37814271e+05  1.63340568e+07  1.22e+01 2.17e-02  7.62e+01     4s
   8  -1.72776869e+05  9.54549955e+06  4.57e+00 1.21e-02  4.27e+01     4s
   9  -1.39326562e+05  4.04468654e+06  2.77e+00 4.88e-03  1.82e+01     4s
  10  -1.00219312e+05  2.16119679e+06  1.46e+00 2.62e-03  9.72e+00     4s
  11  -7.09293926e+04  6.43510577e+05  7.10e-01 6.71e-04  3.05e+00     5s
  12  -4.53775100e+04  2.97046585e+05  3.54e-01 3.12e-04  1.46e+00     5s
  13  -2.92815601e+04  1.92203743e+05  2.37e-01 1.61e-03  9.43e-01     5s
  14  -1.60607262e+04  1.32263667e+05  1.65e-01 1.60e-03  6.31e-01     5s
  15  -1.03009773e+04  1.12413758e+05  1.37e-01 1.63e-03  5.22e-01     5s
  16  -7.14839962e+02  9.88206547e+04  8.88e-02 1.87e-03  4.23e-01     5s
  17   3.26536864e+03  7.86714071e+04  6.72e-02 1.68e-03  3.21e-01     5s
  18   7.47579053e+03  6.69237760e+04  4.58e-02 1.19e-03  2.53e-01     5s
  19   1.01941194e+04  5.55211765e+04  3.31e-02 8.49e-04  1.93e-01     5s
  20   1.30025820e+04  4.88297312e+04  2.18e-02 1.11e-03  1.52e-01     5s
  21   1.48665328e+04  4.09606134e+04  1.58e-02 9.38e-04  1.11e-01     5s
  22   1.55864638e+04  3.73189535e+04  1.37e-02 7.82e-04  9.23e-02     5s
  23   1.61932003e+04  3.52191088e+04  1.21e-02 6.82e-04  8.08e-02     5s
  24   1.75424894e+04  3.26622349e+04  8.83e-03 5.60e-04  6.42e-02     5s
  25   1.86236052e+04  3.13408467e+04  6.55e-03 4.88e-04  5.40e-02     5s
  26   1.88878387e+04  3.01559402e+04  6.01e-03 4.29e-04  4.79e-02     6s
  27   1.90636089e+04  2.95986440e+04  5.68e-03 4.02e-04  4.47e-02     6s
  28   1.97653772e+04  2.82601857e+04  4.37e-03 3.25e-04  3.61e-02     6s
  29   2.01210223e+04  2.62946414e+04  3.73e-03 2.18e-04  2.62e-02     6s
  30   2.06012839e+04  2.54629198e+04  2.91e-03 1.76e-04  2.07e-02     6s
  31   2.07637111e+04  2.47110131e+04  2.66e-03 1.35e-04  1.68e-02     6s
  32   2.09607846e+04  2.44726270e+04  2.35e-03 1.20e-04  1.49e-02     6s
  33   2.12495933e+04  2.40900088e+04  1.89e-03 9.55e-05  1.21e-02     6s
  34   2.13940698e+04  2.35316878e+04  1.67e-03 5.97e-05  9.08e-03     6s
  35   2.16555926e+04  2.33701216e+04  1.27e-03 5.03e-05  7.29e-03     6s
  36   2.17404745e+04  2.31114663e+04  1.13e-03 3.71e-05  5.83e-03     6s
  37   2.19327286e+04  2.30264497e+04  8.35e-04 3.18e-05  4.65e-03     7s
  38   2.21256466e+04  2.28500662e+04  5.21e-04 2.16e-05  3.08e-03     7s
  39   2.21758395e+04  2.27724716e+04  4.40e-04 1.96e-05  2.54e-03     7s
  40   2.22215401e+04  2.26705058e+04  3.66e-04 1.30e-05  1.91e-03     7s
  41   2.22548142e+04  2.26511648e+04  3.17e-04 1.18e-05  1.68e-03     7s
  42   2.22841657e+04  2.25855643e+04  2.73e-04 7.56e-06  1.28e-03     7s
  43   2.23046973e+04  2.25711373e+04  2.43e-04 6.58e-06  1.13e-03     7s
  44   2.23444967e+04  2.25494147e+04  1.84e-04 5.37e-06  8.71e-04     7s
  45   2.23548000e+04  2.25383279e+04  1.69e-04 4.60e-06  7.80e-04     7s
  46   2.23584554e+04  2.25355563e+04  1.63e-04 4.42e-06  7.53e-04     7s
  47   2.23910033e+04  2.25292986e+04  1.13e-04 3.91e-06  5.88e-04     7s
  48   2.24151813e+04  2.25238327e+04  7.84e-05 3.54e-06  4.62e-04     8s
  49   2.24371912e+04  2.24939224e+04  4.56e-05 1.58e-06  2.41e-04     8s
  50   2.24433829e+04  2.24897421e+04  3.69e-05 1.30e-06  1.97e-04     8s
  51   2.24514895e+04  2.24807077e+04  2.47e-05 6.94e-07  1.24e-04     8s
  52   2.24571593e+04  2.24785956e+04  1.67e-05 5.59e-07  9.11e-05     8s
  53   2.24641474e+04  2.24758365e+04  7.33e-06 3.80e-07  4.97e-05     8s
  54   2.24667718e+04  2.24747812e+04  3.70e-06 3.11e-07  3.40e-05     8s
  55   2.24674649e+04  2.24715007e+04  2.88e-06 9.71e-08  1.72e-05     8s
  56   2.24690803e+04  2.24702940e+04  9.11e-07 1.92e-08  5.16e-06     8s
  57   2.24695271e+04  2.24699605e+04  4.34e-07 9.59e-10  1.85e-06     8s
  58   2.24696626e+04  2.24699508e+04  4.48e-07 6.44e-10  1.23e-06     8s
  59   2.24699191e+04  2.24699423e+04  3.60e-08 1.24e-09  9.89e-08     8s
  60   2.24699395e+04  2.24699398e+04  9.47e-09 2.05e-09  1.07e-09     9s
  61   2.24699396e+04  2.24699397e+04  3.56e-09 3.66e-11  1.06e-10     9s

Barrier solved model in 61 iterations and 8.58 seconds (14.54 work units)
Optimal objective 2.24699396e+04


Root crossover log...

  107884 DPushes remaining with DInf 0.0000000e+00                 9s
    1932 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    4210 PPushes remaining with PInf 1.7474098e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1451501e+00     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54148    2.2469940e+04   0.000000e+00   1.145150e+00     11s
   54165    2.2469940e+04   0.000000e+00   0.000000e+00     11s
   54165    2.2469940e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.246994e+04, 54165 iterations, 8.14 seconds (15.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22469.9397    0  352 -210563.59 22469.9397   111%     -   11s
H    0     0                    -33420.08513 22469.9397   167%     -   11s
H    0     0                    -33276.04212 22469.9397   168%     -   11s
H    0     0                    -18990.44898 22469.9397   218%     -   12s
H    0     0                    -6283.169120 22469.9397   458%     -   12s
H    0     0                    -6047.067812 22469.9397   472%     -   12s
H    0     0                    -4300.938755 22469.9397   622%     -   12s
H    0     0                    -4204.715830 22469.9397   634%     -   15s
H    0     0                    -4153.895934 16714.7669   502%     -   64s
H    0     0                    -4144.345430 16714.7669   503%     -   64s
H    0     0                    -4129.984995 16714.7669   505%     -   64s
H    0     0                    -4129.523963 16714.7669   505%     -   64s
H    0     0                    -4126.494206 16714.7669   505%     -   64s
H    0     0                    -4101.130470 16714.7669   508%     -   64s
H    0     0                    -4086.770035 16714.7669   509%     -   64s
     0     0 16428.0844    0  436 -4086.7700 16428.0844   502%     -   65s
H    0     0                    -4047.342425 16428.0844   506%     -   66s
     0     0 16135.0845    0  443 -4047.3424 16135.0845   499%     -   87s
     0     0 15885.6450    0  445 -4047.3424 15885.6450   492%     -  101s
     0     0 15839.4498    0  450 -4047.3424 15839.4498   491%     -  108s
     0     0 15679.6508    0  484 -4047.3424 15679.6508   487%     -  119s
     0     0 15619.9030    0  476 -4047.3424 15619.9030   486%     -  126s
     0     0 15616.1673    0  480 -4047.3424 15616.1673   486%     -  130s
     0     0 15616.1673    0  481 -4047.3424 15616.1673   486%     -  135s
     0     0 15481.8200    0  518 -4047.3424 15481.8200   483%     -  141s
     0     0 15473.8712    0  515 -4047.3424 15473.8712   482%     -  147s
     0     0 15473.8712    0  521 -4047.3424 15473.8712   482%     -  159s
     0     0 15473.8712    0  524 -4047.3424 15473.8712   482%     -  162s
     0     0 15473.8712    0  449 -4047.3424 15473.8712   482%     -  168s
     0     0 13048.8095    0  523 -4047.3424 13048.8095   422%     -  174s
     0     0 13048.8095    0  520 -4047.3424 13048.8095   422%     -  176s
H    0     0                    -4039.969020 12849.7303   418%     -  224s
     0     0 12849.7303    0  480 -4039.9690 12849.7303   418%     -  224s
H    0     0                    -4038.088593 12849.6164   418%     -  224s
     0     0 12436.4959    0  507 -4038.0886 12436.4959   408%     -  245s
     0     0 12363.5790    0  497 -4038.0886 12363.5790   406%     -  262s
     0     0 11650.9042    0  481 -4038.0886 11650.9042   389%     -  293s
     0     0 11316.3158    0  481 -4038.0886 11316.3158   380%     -  321s
     0     0 11171.0890    0  480 -4038.0886 11171.0890   377%     -  346s
     0     0 11037.4170    0  496 -4038.0886 11037.4170   373%     -  369s
     0     0 10825.4326    0  499 -4038.0886 10825.4326   368%     -  394s
     0     0 10801.0342    0  492 -4038.0886 10801.0342   367%     -  401s
     0     0 10775.4308    0  506 -4038.0886 10775.4308   367%     -  409s
     0     0 10767.9828    0  508 -4038.0886 10767.9828   367%     -  412s
     0     0 10708.8861    0  443 -4038.0886 10708.8861   365%     -  426s
     0     0 10675.3710    0  453 -4038.0886 10675.3710   364%     -  435s
     0     0 10665.5974    0  462 -4038.0886 10665.5974   364%     -  438s
     0     0 10609.9248    0  455 -4038.0886 10609.9248   363%     -  445s
     0     0 10593.8320    0  456 -4038.0886 10593.8320   362%     -  448s
     0     0 10590.2442    0  457 -4038.0886 10590.2442   362%     -  450s
     0     0 10587.8754    0  458 -4038.0886 10587.8754   362%     -  451s
     0     0 10587.7105    0  456 -4038.0886 10587.7105   362%     -  453s
     0     0 8962.99906    0  485 -4038.0886 8962.99906   322%     -  503s
     0     0 8511.04788    0  501 -4038.0886 8511.04788   311%     -  533s
     0     0 8359.92709    0  501 -4038.0886 8359.92709   307%     -  547s
     0     0 8228.21464    0  494 -4038.0886 8228.21464   304%     -  565s
     0     0 8170.51557    0  497 -4038.0886 8170.51557   302%     -  576s
     0     0 8074.59113    0  546 -4038.0886 8074.59113   300%     -  591s
     0     0 8035.05718    0  557 -4038.0886 8035.05718   299%     -  599s
     0     0 8032.29741    0  558 -4038.0886 8032.29741   299%     -  602s
     0     0 8017.49179    0  493 -4038.0886 8017.49179   299%     -  606s
     0     0 8014.58591    0  500 -4038.0886 8014.58591   298%     -  609s
     0     0 8009.84842    0  495 -4038.0886 8009.84842   298%     -  612s
     0     0 8000.90313    0  509 -4038.0886 8000.90313   298%     -  617s
     0     0 8000.03169    0  513 -4038.0886 8000.03169   298%     -  619s
     0     0 7266.28597    0  473 -4038.0886 7266.28597   280%     -  688s
     0     0 7123.15870    0  522 -4038.0886 7123.15870   276%     -  707s
     0     0 7019.67496    0  477 -4038.0886 7019.67496   274%     -  721s
     0     0 6975.95860    0  459 -4038.0886 6975.95860   273%     -  734s
     0     0 6947.81877    0  476 -4038.0886 6947.81877   272%     -  742s
     0     0 6905.95267    0  479 -4038.0886 6905.95267   271%     -  753s
     0     0 6889.85743    0  476 -4038.0886 6889.85743   271%     -  760s
     0     0 6871.32407    0  470 -4038.0886 6871.32407   270%     -  766s
     0     0 6863.63694    0  477 -4038.0886 6863.63694   270%     -  769s
     0     0 6860.57924    0  475 -4038.0886 6860.57924   270%     -  772s
     0     0 6860.04868    0  477 -4038.0886 6860.04868   270%     -  774s
     0     0 6759.24463    0  481 -4038.0886 6759.24463   267%     -  793s
     0     0 6689.04535    0  472 -4038.0886 6689.04535   266%     -  808s
     0     0 6676.51157    0  478 -4038.0886 6676.51157   265%     -  814s
     0     0 6669.59723    0  479 -4038.0886 6669.59723   265%     -  818s
     0     0 6663.48312    0  470 -4038.0886 6663.48312   265%     -  822s
     0     0 6656.69474    0  478 -4038.0886 6656.69474   265%     -  825s
     0     0 6653.58073    0  478 -4038.0886 6653.58073   265%     -  826s
     0     0 6653.33291    0  481 -4038.0886 6653.33291   265%     -  827s
     0     0 6540.02634    0  480 -4038.0886 6540.02634   262%     -  839s
     0     0 6487.82602    0  490 -4038.0886 6487.82602   261%     -  850s
     0     0 6480.64917    0  484 -4038.0886 6480.64917   260%     -  853s
     0     0 6477.09616    0  484 -4038.0886 6477.09616   260%     -  859s
     0     0 6475.97552    0  497 -4038.0886 6475.97552   260%     -  862s
     0     0 6393.20517    0  478 -4038.0886 6393.20517   258%     -  872s
     0     0 6327.68642    0  494 -4038.0886 6327.68642   257%     -  881s
     0     0 6318.19853    0  498 -4038.0886 6318.19853   256%     -  884s
     0     0 6306.43111    0  501 -4038.0886 6306.43111   256%     -  890s
     0     0 6303.09659    0  564 -4038.0886 6303.09659   256%     -  893s
     0     0 6299.55150    0  565 -4038.0886 6299.55150   256%     -  898s
     0     0 6298.10598    0  569 -4038.0886 6298.10598   256%     -  899s
     0     0 6254.42629    0  521 -4038.0886 6254.42629   255%     -  910s
     0     0 6244.31927    0  511 -4038.0886 6244.31927   255%     -  913s
     0     0 6238.30026    0  517 -4038.0886 6238.30026   254%     -  916s
     0     0 6226.12013    0  518 -4038.0886 6226.12013   254%     -  919s
     0     0 6213.71152    0  511 -4038.0886 6213.71152   254%     -  923s
     0     0 6211.52044    0  517 -4038.0886 6211.52044   254%     -  926s
     0     0 6175.02569    0  505 -4038.0886 6175.02569   253%     -  936s
     0     0 6168.58267    0  504 -4038.0886 6168.58267   253%     -  940s
     0     0 6166.41636    0  514 -4038.0886 6166.41636   253%     -  944s
     0     0 6144.50505    0  505 -4038.0886 6144.50505   252%     -  951s
     0     0 6132.21885    0  498 -4038.0886 6132.21885   252%     -  956s
     0     0 6124.43114    0  518 -4038.0886 6124.43114   252%     -  961s
     0     0 6121.61050    0  515 -4038.0886 6121.61050   252%     -  963s
     0     0 6120.63484    0  513 -4038.0886 6120.63484   252%     -  965s
     0     0 6105.02561    0  508 -4038.0886 6105.02561   251%     -  971s
     0     0 6100.00262    0  514 -4038.0886 6100.00262   251%     -  974s
     0     0 6098.58048    0  526 -4038.0886 6098.58048   251%     -  976s
     0     0 6083.90305    0  514 -4038.0886 6083.90305   251%     -  981s
     0     0 6076.75419    0  511 -4038.0886 6076.75419   250%     -  989s
     0     0 6071.63405    0  513 -4038.0886 6071.63405   250%     -  992s
     0     0 6070.43175    0  511 -4038.0886 6070.43175   250%     -  993s
     0     0 6059.82294    0  515 -4038.0886 6059.82294   250%     -  999s
     0     0 6059.65803    0  515 -4038.0886 6059.65803   250%     - 1007s
     0     2 6059.65803    0  515 -4038.0886 6059.65803   250%     - 1105s
     1     3 5985.61036    1  500 -4038.0886 6059.65803   250% 11437 1116s
     2     4 6041.90065    1  508 -4038.0886 6041.90065   250%  8374 1124s
     3     6 4647.40039    2  427 -4038.0886 6041.82415   250%  9276 1135s
     5    12 5694.28912    3  471 -4038.0886 6041.82415   250%  8960 1154s
    11    24 5502.31400    4  461 -4038.0886 5967.30380   248% 10742 1194s
    23    36 5715.34274    4  491 -4038.0886 5919.93610   247% 19378 1259s
    35    67 4101.13984    5  444 -4038.0886 5919.93610   247% 18486 1438s
    66   203 3374.84120    5  444 -4038.0886 5712.20630   241% 23111 1486s
   202   232 3874.62747   11  434 -4038.0886 5712.20630   241% 11187 1504s
   231   265 3361.26796    6  446 -4038.0886 5712.20630   241% 10464 1520s
   264   292 3228.62450    8  432 -4038.0886 5712.20630   241%  9839 1539s
   293   325 3740.77633   14  404 -4038.0886 5712.20630   241%  9420 1559s
   326   365 2970.89006    9  314 -4038.0886 5712.20630   241%  9087 1578s
   366   406 2790.16634   10  324 -4038.0886 5712.20630   241%  8627 1599s
   415   433 2441.08918   11  333 -4038.0886 5712.20630   241%  8306 1616s
   450   475 2369.44600   12  352 -4038.0886 5712.20630   241%  8130 1636s
   502   531 2365.67935   13  351 -4038.0886 5712.20630   241%  7978 1653s
   562   579 2248.90701   14  331 -4038.0886 5712.20630   241%  7716 1670s
   636   593 2111.30263   15  322 -4038.0886 5712.20630   241%  7399 1690s
   700   597 1679.32061   23  445 -4038.0886 5712.20630   241%  7346 1708s
   748   617 1634.13129   24  459 -4038.0886 5542.79808   237%  7351 1727s
   798   655 1327.10257   26  267 -4038.0886 5542.79808   237%  7303 1747s
   866   717 -3486.6645   29  296 -4038.0886 5542.79808   237%  7200 1766s
   958   768 -3629.0964   30  333 -4038.0886 5542.79808   237%  6885 1786s
  1057   777 -3773.5632   32  327 -4038.0886 5542.79808   237%  6661 1805s
  1144   802     cutoff   33      -4038.0886 5542.79808   237%  6487 1827s
  1220   834 -3934.8165   32  328 -4038.0886 5542.79808   237%  6434 1848s
  1310   876 -3964.4742   33  325 -4038.0886 5542.79808   237%  6406 1871s
  1409   881 infeasible   27      -4038.0886 5542.79808   237%  6351 1895s
  1465   917 2880.65777   13  428 -4038.0886 5542.79808   237%  6391 1921s
  1528   953  522.80678    9  206 -4038.0886 5542.79808   237%  6539 1944s
  1633   982  -90.62498   10  191 -4038.0886 5542.79808   237%  6446 1970s
  1708  1046 -1780.4812   13  134 -4038.0886 5542.79808   237%  6553 1999s
H 1784  1046                    -3986.315486 5542.79808   239%  6615 1999s
  1790  1165 -2770.5665   16  103 -3986.3155 5542.79808   239%  6623 2026s
H 1953  1232                    -3980.038908 5542.79808   239%  6461 2054s
H 2020  1232                    -3969.296882 5542.79808   240%  6361 2054s
  2081  1277  403.11753   25  282 -3969.2969 5542.79808   240%  6375 2087s
  2222  1308   82.84915   30  246 -3969.2969 5542.79808   240%  6287 2117s
  2271  1348 -121.23748   29  254 -3969.2969 5542.79808   240%  6393 2147s
H 2317  1348                    -3950.997325 4762.97590   221%  6449 2147s
  2371  1417 -1320.2446   33  290 -3950.9973 4762.97590   221%  6437 2180s
  2509  1477 infeasible   32      -3950.9973 4762.97590   221%  6437 2213s
  2632  1499 -2416.1612   36  176 -3950.9973 4762.97590   221%  6469 2246s
  2672  1519 infeasible   35      -3950.9973 4762.97590   221%  6540 2280s
  2714  1539 -2695.2173   36  251 -3950.9973 4762.97590   221%  6634 2313s
  2772  1552 -2496.9776   37  177 -3950.9973 4737.70451   220%  6652 2343s
  2823  1574 -2562.1478   37  162 -3950.9973 4737.70451   220%  6711 2374s
  2865  1605 -2666.8012   38  228 -3950.9973 4603.38534   217%  6790 2407s
  2937  1686 -2608.9289   38  183 -3950.9973 4603.38534   217%  6810 2447s
  3066  1702 infeasible   49      -3950.9973 4494.66498   214%  6753 2487s
  3159  1771 3377.72176    7  446 -3950.9973 4494.66498   214%  6787 2529s
  3281  1784 1944.60242   10  281 -3950.9973 4494.66498   214%  6842 2575s
  3422  1826 -1294.9528   12  112 -3950.9973 4494.66498   214%  6867 2623s
  3521  1901 -3770.6738   34  155 -3950.9973 4421.12959   212%  6977 2674s
  3660  1975 1118.43594   19  421 -3950.9973 4421.12959   212%  7081 2728s
  3846  2008  447.32432   20  444 -3950.9973 4251.79941   208%  7101 2782s
  4041  2064 -1726.5143   24  465 -3950.9973 4251.79941   208%  7121 2841s
  4219  2125 -2989.6041   26  203 -3950.9973 4251.79941   208%  7208 2905s
  4410  2188 1751.06973   15  215 -3950.9973 3991.08945   201%  7302 2962s
  4597  2261 infeasible   20      -3950.9973 3991.08945   201%  7411 3022s
  4804  2349 -3414.4816   19   68 -3950.9973 3776.45389   196%  7490 3082s
  5043  2469 -572.13092   14  420 -3950.9973 3776.45389   196%  7544 3147s
  5335  2470 -1078.7921   16  515 -3950.9973 3776.45389   196%  7514 3461s
  5337  2471 1428.07536   18  283 -3950.9973 3776.45389   196%  7511 3477s
  5338  2472  934.41452   20  461 -3950.9973 3776.45389   196%  7510 3595s

Cutting planes:
  Gomory: 5
  Implied bound: 8
  Projected implied bound: 114
  MIR: 1289
  Mixing: 1
  Flow cover: 1299
  RLT: 36
  Relax-and-lift: 175

Explored 5338 nodes (41008153 simplex iterations) in 3600.19 seconds (8866.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -3951 -3969.3 -3980.04 ... -4126.49

Time limit reached
Best objective -3.950997325362e+03, best bound 3.776453888117e+03, gap 195.5823%
  WARNING: Time limit reached. Using best solution found (gap: 195.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.34s
  Master Objective (UB) = -3951.00, θ = 120897.64
  Upper Bound (UB) = -3951.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 120897.64
  [DEBUG]   ✓ Scenario 0: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 120897.64 ≤ Q = 120943.78 (slack: 46.14)
  [DEBUG]   ✓ Scenario 5: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 120897.64 ≤ Q = 120897.64 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7fdeb8b3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7fdeb8b3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.262740e+13
Presolve removed 2586 rows and 1880 columns
Presolve time: 0.00s
Presolved: 507 rows, 509 columns, 1429 nonzeros
Found heuristic solution: objective 6621689.1059
Variable types: 343 continuous, 166 integer (166 binary)

Root relaxation: objective -1.206833e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120683.27    0  123 6621689.11 -120683.27   102%     -    0s
H    0     0                    -87878.94762 -120683.27  37.3%     -    0s
H    0     0                    -88265.96011 -120683.27  36.7%     -    0s
     0     0 -96843.434    0   30 -88265.960 -96843.434  9.72%     -    0s
H    0     0                    -96075.73454 -96837.834  0.79%     -    0s
     0     0 -96623.592    0   16 -96075.735 -96623.592  0.57%     -    0s
H    0     0                    -96392.72472 -96618.606  0.23%     -    0s
     0     0 -96534.909    0   13 -96392.725 -96534.909  0.15%     -    0s
     0     0 -96509.792    0    9 -96392.725 -96509.792  0.12%     -    0s
     0     0 -96509.193    0    9 -96392.725 -96509.193  0.12%     -    0s
     0     0 -96477.868    0    7 -96392.725 -96477.868  0.09%     -    0s
     0     0 -96477.868    0   10 -96392.725 -96477.868  0.09%     -    0s
H    0     0                    -96436.49480 -96477.868  0.04%     -    0s
     0     0 -96459.062    0    2 -96436.495 -96459.062  0.02%     -    0s
     0     0 -96458.561    0    2 -96436.495 -96458.561  0.02%     -    0s
H    0     0                    -96450.77427 -96456.049  0.01%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 6
  Flow cover: 3
  Relax-and-lift: 2

Explored 1 nodes (530 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -96450.8 -96436.5 -96392.7 ... 1.26274e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.645077427140e+04, best bound -9.645604931717e+04, gap 0.0055%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 115035.26
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96450.77
  [DEBUG]   S×d_nominal = 211486.03
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 211486.03 + -96450.77 = 115035.26
  [DEBUG]   Current θ from Master = 120897.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5862.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9813.38
  Lower Bound (LB) = -4438.37
  Gap (UB-LB) = 487.3732, Absolute Gap = 487.3732, Relative Gap = 0.123354
  Not converged yet (gap = 487.37 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697359 nonzeros
Model fingerprint: 0xd909d548
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 108472 rows and 44052 columns
Presolve time: 2.45s
Presolved: 137551 rows, 58048 columns, 847133 nonzeros
Variable types: 55789 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378535.5995
Found heuristic solution: objective -210563.5854

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.22s

Barrier statistics:
 Dense cols : 630
 AA' NZ     : 6.922e+06
 Factor NZ  : 1.514e+07 (roughly 200 MB of memory)
 Factor Ops : 3.303e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.12105037e+07  2.05274645e+08  6.31e+04 2.25e+01  4.81e+04     5s
   1  -8.68236342e+06  1.76068840e+08  4.45e+04 4.45e+01  3.36e+04     5s
   2  -3.94361104e+06  1.41980008e+08  1.88e+04 2.77e+01  1.46e+04     5s
   3  -8.90014534e+05  9.55333668e+07  2.02e+03 3.93e-01  1.85e+03     5s
   4  -5.29498304e+05  6.17301253e+07  5.03e+02 1.36e-01  5.90e+02     5s
   5  -4.39536906e+05  3.69149203e+07  2.27e+02 6.74e-02  2.89e+02     5s
   6  -3.66853176e+05  2.61178452e+07  6.77e+01 4.47e-02  1.44e+02     6s
   7  -2.72513059e+05  1.94146169e+07  1.10e+01 3.20e-02  8.38e+01     6s
   8  -1.81926609e+05  1.28015439e+07  1.81e+00 2.06e-02  5.24e+01     6s
   9  -1.47534369e+05  4.71578967e+06  1.00e+00 7.32e-03  1.95e+01     6s
  10  -9.84146489e+04  2.74569888e+06  4.86e-01 4.15e-03  1.14e+01     6s
  11  -7.74814398e+04  8.69248412e+05  2.93e-01 1.25e-03  3.78e+00     6s
  12  -4.59878040e+04  5.03686852e+05  1.05e-01 7.98e-04  2.19e+00     6s
  13  -2.28351014e+04  2.77971754e+05  4.95e-02 1.12e-03  1.20e+00     6s
  14  -1.39392632e+04  1.86274962e+05  3.51e-02 1.71e-03  7.98e-01     6s
  15  -8.86290462e+03  1.38715710e+05  2.86e-02 2.03e-03  5.88e-01     6s
  16  -2.19133816e+03  1.14420925e+05  1.99e-02 1.85e-03  4.65e-01     6s
  17   6.11472279e+01  8.98904263e+04  1.73e-02 1.39e-03  3.58e-01     6s
  18   4.47005258e+03  7.25662365e+04  1.24e-02 1.09e-03  2.71e-01     7s
  19   7.39557374e+03  5.58296964e+04  9.68e-03 8.13e-04  1.93e-01     7s
  20   9.59528259e+03  4.68537171e+04  7.77e-03 6.27e-04  1.48e-01     7s
  21   1.13284116e+04  4.21814322e+04  6.52e-03 5.12e-04  1.23e-01     7s
  22   1.30411312e+04  3.78236783e+04  5.35e-03 3.98e-04  9.87e-02     7s
  23   1.38355081e+04  3.59785759e+04  4.82e-03 3.68e-04  8.82e-02     7s
  24   1.53868436e+04  3.36196749e+04  3.83e-03 3.04e-04  7.26e-02     7s
  25   1.60894078e+04  3.31809913e+04  3.40e-03 2.90e-04  6.81e-02     7s
  26   1.73096855e+04  3.08402012e+04  2.69e-03 2.25e-04  5.39e-02     7s
  27   1.81899841e+04  2.94465312e+04  2.18e-03 1.87e-04  4.48e-02     8s
  28   1.86555565e+04  2.90112011e+04  1.94e-03 1.76e-04  4.13e-02     8s
  29   1.92768390e+04  2.76216418e+04  1.61e-03 1.37e-04  3.32e-02     8s
  30   1.96639919e+04  2.52707744e+04  1.39e-03 2.87e-04  2.23e-02     8s
  31   2.03922363e+04  2.48259651e+04  1.03e-03 2.39e-04  1.77e-02     8s
  32   2.06282382e+04  2.45079217e+04  9.19e-04 2.04e-04  1.55e-02     8s
  33   2.10400306e+04  2.40804560e+04  7.17e-04 1.57e-04  1.21e-02     8s
  34   2.14299135e+04  2.37866471e+04  5.27e-04 1.25e-04  9.39e-03     8s
  35   2.17247522e+04  2.32769085e+04  3.90e-04 7.32e-05  6.18e-03     8s
  36   2.18508069e+04  2.31762189e+04  3.26e-04 6.30e-05  5.28e-03     9s
  37   2.19705663e+04  2.29496543e+04  2.68e-04 3.97e-05  3.90e-03     9s
  38   2.22373471e+04  2.27794280e+04  1.34e-04 2.27e-05  2.16e-03     9s
  39   2.22931477e+04  2.27023906e+04  1.09e-04 1.52e-05  1.63e-03     9s
  40   2.23076574e+04  2.26929787e+04  1.03e-04 1.42e-05  1.54e-03     9s
  41   2.23687949e+04  2.26512125e+04  7.51e-05 1.02e-05  1.13e-03     9s
  42   2.23911804e+04  2.26193209e+04  6.51e-05 7.02e-06  9.09e-04     9s
  43   2.23969426e+04  2.26149646e+04  6.26e-05 6.61e-06  8.69e-04     9s
  44   2.24357362e+04  2.25949839e+04  4.58e-05 4.52e-06  6.35e-04     9s
  45   2.24783411e+04  2.25705315e+04  2.75e-05 2.16e-06  3.67e-04     9s
  46   2.24913570e+04  2.25634132e+04  2.21e-05 1.53e-06  2.87e-04    10s
  47   2.25133021e+04  2.25533569e+04  1.28e-05 6.00e-07  1.60e-04    10s
  48   2.25232988e+04  2.25513869e+04  8.71e-06 4.26e-07  1.12e-04    10s
  49   2.25308586e+04  2.25500665e+04  5.60e-06 3.13e-07  7.65e-05    10s
  50   2.25380963e+04  2.25482134e+04  2.94e-06 1.59e-07  4.03e-05    10s
  51   2.25412355e+04  2.25465330e+04  1.73e-06 2.51e-08  2.11e-05    10s
  52   2.25444338e+04  2.25464239e+04  5.75e-07 1.78e-08  7.93e-06    10s
  53   2.25448423e+04  2.25462592e+04  4.35e-07 7.37e-09  5.65e-06    10s
  54   2.25452394e+04  2.25461959e+04  9.33e-07 4.02e-09  3.81e-06    10s
  55   2.25460381e+04  2.25461449e+04  6.53e-08 1.52e-09  4.26e-07    10s
  56   2.25461169e+04  2.25461190e+04  1.72e-08 5.43e-11  8.18e-09    10s
  57   2.25461183e+04  2.25461187e+04  1.24e-06 6.58e-10  2.56e-09    11s
  58   2.25461187e+04  2.25461187e+04  1.25e-07 5.53e-11  2.06e-10    11s

Barrier solved model in 58 iterations and 10.70 seconds (16.23 work units)
Optimal objective 2.25461187e+04


Root crossover log...

  114919 DPushes remaining with DInf 0.0000000e+00                11s
   32128 DPushes remaining with DInf 0.0000000e+00                15s
    3157 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    6408 PPushes remaining with PInf 3.6776700e-05                22s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.2589100e+01     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59454    2.2546119e+04   0.000000e+00   4.258910e+01     23s
   59516    2.2546119e+04   0.000000e+00   0.000000e+00     23s
   59516    2.2546119e+04   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 2.254612e+04, 59516 iterations, 19.60 seconds (31.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 22546.1187    0  352 -210563.59 22546.1187   111%     -   23s
H    0     0                    -66831.84343 22546.1187   134%     -   24s
H    0     0                    -45232.51470 22546.1187   150%     -   24s
H    0     0                    -45212.23030 22546.1187   150%     -   24s
H    0     0                    -45020.16898 22546.1187   150%     -   24s
H    0     0                    -35999.89400 22546.1187   163%     -   24s
H    0     0                    -6753.189187 22546.1187   434%     -   25s
H    0     0                    -6234.994492 22546.1187   462%     -   25s
H    0     0                    -4300.938755 22546.1187   624%     -   25s
     0     0 16648.2029    0  410 -4300.9388 16648.2029   487%     -   96s
H    0     0                    -4160.980267 16639.6672   500%     -   97s
H    0     0                    -4147.701822 16639.6672   501%     -   97s
H    0     0                    -4121.423592 16639.6672   504%     -   97s
H    0     0                    -4120.341602 16639.6672   504%     -   97s
     0     0 16419.9695    0  439 -4120.3416 16419.9695   499%     -  116s
     0     0 16207.6959    0  440 -4120.3416 16207.6959   493%     -  134s
     0     0 15949.0206    0  449 -4120.3416 15949.0206   487%     -  147s
     0     0 15904.9956    0  456 -4120.3416 15904.9956   486%     -  157s
     0     0 15816.1590    0  458 -4120.3416 15816.1590   484%     -  166s
     0     0 15812.0516    0  456 -4120.3416 15812.0516   484%     -  169s
     0     0 15786.3280    0  457 -4120.3416 15786.3280   483%     -  175s
     0     0 15749.5346    0  485 -4120.3416 15749.5346   482%     -  181s
     0     0 15749.0171    0  484 -4120.3416 15749.0171   482%     -  185s
     0     0 13526.2987    0  478 -4120.3416 13526.2987   428%     -  281s
H    0     0                    -4078.520420 13526.0101   432%     -  282s
H    0     0                    -4077.516203 13526.0101   432%     -  282s
     0     0 12781.3229    0  493 -4077.5162 12781.3229   413%     -  351s
     0     0 12647.0042    0  475 -4077.5162 12647.0042   410%     -  375s
     0     0 12559.5207    0  474 -4077.5162 12559.5207   408%     -  393s
     0     0 12533.1202    0  480 -4077.5162 12533.1202   407%     -  410s
     0     0 12459.5538    0  486 -4077.5162 12459.5538   406%     -  437s
     0     0 12346.9709    0  480 -4077.5162 12346.9709   403%     -  473s
     0     0 12325.6382    0  472 -4077.5162 12325.6382   402%     -  485s
     0     0 11930.1003    0  501 -4077.5162 11930.1003   393%     -  517s
     0     0 11864.6307    0  483 -4077.5162 11864.6307   391%     -  535s
     0     0 11848.6638    0  478 -4077.5162 11848.6638   391%     -  543s
     0     0 11837.5778    0  486 -4077.5162 11837.5778   390%     -  550s
     0     0 11828.5312    0  484 -4077.5162 11828.5312   390%     -  555s
     0     0 11825.9709    0  483 -4077.5162 11825.9709   390%     -  557s
     0     0 11686.6470    0  472 -4077.5162 11686.6470   387%     -  571s
     0     0 11663.8108    0  480 -4077.5162 11663.8108   386%     -  578s
     0     0 11661.2209    0  482 -4077.5162 11661.2209   386%     -  581s
     0     0 11661.1187    0  483 -4077.5162 11661.1187   386%     -  582s
     0     0 9833.75835    0  482 -4077.5162 9833.75835   341%     -  680s
     0     0 9352.17830    0  514 -4077.5162 9352.17830   329%     -  747s
     0     0 9180.53824    0  467 -4077.5162 9180.53824   325%     -  775s
     0     0 9141.07327    0  466 -4077.5162 9141.07327   324%     -  795s
     0     0 8947.36389    0  486 -4077.5162 8947.36389   319%     -  822s
     0     0 8876.72483    0  510 -4077.5162 8876.72483   318%     -  838s
     0     0 8826.57486    0  516 -4077.5162 8826.57486   316%     -  851s
     0     0 8809.52820    0  473 -4077.5162 8809.52820   316%     -  866s
     0     0 8794.04504    0  474 -4077.5162 8794.04504   316%     -  877s
     0     0 8786.21527    0  482 -4077.5162 8786.21527   315%     -  882s
     0     0 8782.60721    0  475 -4077.5162 8782.60721   315%     -  886s
     0     0 8770.79996    0  483 -4077.5162 8770.79996   315%     -  890s
     0     0 8764.67372    0  473 -4077.5162 8764.67372   315%     -  897s
     0     0 8763.64013    0  474 -4077.5162 8763.64013   315%     -  902s
     0     0 7536.97189    0  474 -4077.5162 7536.97189   285%     -  994s
     0     0 7240.44882    0  527 -4077.5162 7240.44882   278%     - 1025s
     0     0 7076.18296    0  451 -4077.5162 7076.18296   274%     - 1049s
     0     0 6980.14447    0  470 -4077.5162 6980.14447   271%     - 1061s
     0     0 6915.27221    0  474 -4077.5162 6915.27221   270%     - 1076s
     0     0 6898.46760    0  487 -4077.5162 6898.46760   269%     - 1087s
     0     0 6869.77406    0  496 -4077.5162 6869.77406   268%     - 1097s
     0     0 6861.65279    0  494 -4077.5162 6861.65279   268%     - 1103s
     0     0 6859.10043    0  489 -4077.5162 6859.10043   268%     - 1106s
     0     0 6857.52440    0  489 -4077.5162 6857.52440   268%     - 1109s
     0     0 6522.45346    0  653 -4077.5162 6522.45346   260%     - 1159s
     0     0 6446.17951    0  652 -4077.5162 6446.17951   258%     - 1189s
     0     0 6439.34678    0  655 -4077.5162 6439.34678   258%     - 1200s
     0     0 6436.83675    0  656 -4077.5162 6436.83675   258%     - 1207s
     0     0 6434.34163    0  666 -4077.5162 6434.34163   258%     - 1215s
     0     0 6432.13257    0  716 -4077.5162 6432.13257   258%     - 1225s
     0     0 6281.48266    0  483 -4077.5162 6281.48266   254%     - 1265s
H    0     0                    -4038.088593 6281.19769   256%     - 1270s
     0     0 6221.53751    0  485 -4038.0886 6221.53751   254%     - 1287s
     0     0 6204.18570    0  492 -4038.0886 6204.18570   254%     - 1298s
     0     0 6191.12301    0  485 -4038.0886 6191.12301   253%     - 1321s
     0     0 6188.20564    0  541 -4038.0886 6188.20564   253%     - 1329s
     0     0 6187.96185    0  547 -4038.0886 6187.96185   253%     - 1332s
     0     0 6108.46428    0  481 -4038.0886 6108.46428   251%     - 1356s
     0     0 6084.17254    0  541 -4038.0886 6084.17254   251%     - 1369s
     0     0 6075.30405    0  499 -4038.0886 6075.30405   250%     - 1382s
     0     0 6073.20191    0  497 -4038.0886 6073.20191   250%     - 1390s
     0     0 6046.01137    0  495 -4038.0886 6046.01137   250%     - 1409s
     0     0 6042.06643    0  499 -4038.0886 6042.06643   250%     - 1417s
     0     0 6039.83613    0  503 -4038.0886 6039.83613   250%     - 1421s
     0     0 6021.94605    0  494 -4038.0886 6021.94605   249%     - 1432s
     0     0 6013.52617    0  496 -4038.0886 6013.52617   249%     - 1444s
     0     0 6003.65746    0  509 -4038.0886 6003.65746   249%     - 1452s
     0     0 6001.64649    0  502 -4038.0886 6001.64649   249%     - 1455s
     0     0 5986.12176    0  566 -4038.0886 5986.12176   248%     - 1467s
     0     0 5983.97248    0  517 -4038.0886 5983.97248   248%     - 1476s
     0     0 5979.93533    0  564 -4038.0886 5979.93533   248%     - 1487s
     0     0 5978.45800    0  509 -4038.0886 5978.45800   248%     - 1492s
     0     0 5944.53806    0  571 -4038.0886 5944.53806   247%     - 1516s
     0     0 5930.89870    0  517 -4038.0886 5930.89870   247%     - 1530s
     0     0 5925.32177    0  515 -4038.0886 5925.32177   247%     - 1539s
     0     0 5922.51833    0  531 -4038.0886 5922.51833   247%     - 1543s
     0     0 5921.31785    0  534 -4038.0886 5921.31785   247%     - 1545s
     0     0 5906.59402    0  532 -4038.0886 5906.59402   246%     - 1560s
     0     0 5904.17587    0  535 -4038.0886 5904.17587   246%     - 1566s
     0     0 5896.90131    0  528 -4038.0886 5896.90131   246%     - 1578s
     0     0 5894.45904    0  532 -4038.0886 5894.45904   246%     - 1584s
     0     0 5891.21435    0  532 -4038.0886 5891.21435   246%     - 1590s
     0     0 5891.15212    0  532 -4038.0886 5891.15212   246%     - 1602s
     0     2 5890.80290    0  532 -4038.0886 5890.80290   246%     - 1852s
     1     3 5134.59824    1  479 -4038.0886 5890.80290   246% 23472 1883s
     2     4 5870.42436    1  578 -4038.0886 5870.42436   245% 13682 1896s
     3     6 5843.68248    2  522 -4038.0886 5869.28172   245% 11739 1917s
     5     9 5806.36580    3  522 -4038.0886 5869.28172   245% 11994 1945s
     8    17 5502.35241    4  499 -4038.0886 5843.02825   245% 13148 1977s
    16    33 5386.69830    5  499 -4038.0886 5675.58990   241% 13030 2012s
    32    48 4721.13629    6  549 -4038.0886 5675.58990   241% 18583 2109s
    47    78 4003.39996    7  484 -4038.0886 5675.58990   241% 22427 2164s
    77   180 3650.61287    8  515 -4038.0886 5558.48204   238% 17848 2221s
   179   208 3571.31549    9  507 -4038.0886 5558.48204   238% 12250 2275s
   209   241 3409.77218   10  448 -4038.0886 5558.48204   238% 11516 2386s
   248   294 3343.10849   11  434 -4038.0886 5558.48204   238% 10594 2472s
   301   337 3313.93402   12  417 -4038.0886 5558.48204   238%  9613 2503s
   344   388 3310.49975   13  413 -4038.0886 5558.48204   238%  8853 2531s
   397   420 3250.94117   14  418 -4038.0886 5558.48204   238%  8290 2563s
   441   453 3190.14189   15  428 -4038.0886 5558.48204   238%  8076 2597s
   480   487 2978.92789   16  405 -4038.0886 5558.48204   238%  7919 2629s
   518   524 2690.06475   17  509 -4038.0886 5558.48204   238%  7732 2663s
   563   550 3550.95481   12  458 -4038.0886 5558.48204   238%  7524 2708s
   599   585   73.97191   18  275 -4038.0886 5558.48204   238%  7436 2739s
   648   626   57.74825   19  271 -4038.0886 5558.48204   238%  7281 2766s
   695   674  -92.23320   20  289 -4038.0886 5558.48204   238%  7134 2796s
   755   691 -228.02154   21  343 -4038.0886 5558.48204   238%  6931 2827s
   799   722 -233.64942   22  336 -4038.0886 5558.48204   238%  6767 2855s
   856   762 -635.27653   23  340 -4038.0886 5558.48204   238%  6552 2887s
   934   792 -639.05832   24  286 -4038.0886 5558.48204   238%  6196 2918s
  1011   806 -1068.6572   25  265 -4038.0886 5558.48204   238%  5881 2956s
  1047   846 -1245.0438   26  271 -4038.0886 5558.48204   238%  5814 2986s
  1129   880 -1248.6369   27  263 -4038.0886 5558.48204   238%  5629 3021s
  1215   940 -1275.5949   28  263 -4038.0886 5558.48204   238%  5419 3052s
  1303  1007 -1760.5747   29  265 -4038.0886 5558.48204   238%  5234 3086s
  1409  1082 -1852.5458   30  246 -4038.0886 5558.48204   238%  5030 3125s
  1528  1149 -1894.0555   31  255 -4038.0886 5558.48204   238%  4803 3157s
  1662  1189 -1995.9732   32  241 -4038.0886 5558.48204   238%  4607 3199s
  1757  1243 -2000.6880   33  245 -4038.0886 5558.48204   238%  4521 3241s
  1841  1259 -2046.4137   34  295 -4038.0886 5558.48204   238%  4450 3282s
  1880  1286 -2239.9834   35  345 -4038.0886 5558.48204   238%  4434 3321s
  1930  1323 -2487.1757   36  342 -4038.0886 5558.48204   238%  4410 3362s
  1991  1380 -2492.7358   37  341 -4038.0886 5261.68520   230%  4374 3416s
  2126  1488 -2510.6292   38  293 -4038.0886 5259.68409   230%  4262 3460s
  2329  1589 infeasible   39      -4038.0886 5259.68409   230%  4069 3515s
  2514  1682 -3675.4284   40  259 -4038.0886 5259.68409   230%  3944 3583s
  2686  1680 infeasible   42      -4038.0886 5259.68409   230%  3884 3600s

Cutting planes:
  Gomory: 4
  Implied bound: 297
  MIR: 3641
  Flow cover: 3750
  Zero half: 2
  RLT: 98
  Relax-and-lift: 655

Explored 2774 nodes (11550471 simplex iterations) in 3600.10 seconds (7620.76 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -4038.09 -4077.52 -4078.52 ... -6753.19

Time limit reached
Best objective -4.038088593172e+03, best bound 5.259684094607e+03, gap 230.2518%
  WARNING: Time limit reached. Using best solution found (gap: 230.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -4038.09, θ = 118952.95
  Upper Bound (UB) = -4038.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118952.95
  [DEBUG]   ✓ Scenario 0: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 118952.95 ≤ Q = 118952.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 118952.95 ≤ Q = 118952.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 118952.95 ≤ Q = 118952.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 118952.95 ≤ Q = 118952.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2fab4308
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2fab4308
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.272873e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.01s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6637943.9686
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.221231e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122123.12    0  123 6637943.97 -122123.12   102%     -    0s
H    0     0                    -89324.02870 -122123.12  36.7%     -    0s
H    0     0                    -89715.43481 -122123.12  36.1%     -    0s
     0     0 -92809.752    0   70 -89715.435 -92809.752  3.45%     -    0s
H    0     0                    -92054.56320 -92760.081  0.77%     -    0s
     0     0 -92620.095    0   45 -92054.563 -92620.095  0.61%     -    0s
     0     0 -92603.009    0   45 -92054.563 -92603.009  0.60%     -    0s
     0     0 -92372.708    0   43 -92054.563 -92372.708  0.35%     -    0s
     0     0 -92350.808    0   44 -92054.563 -92350.808  0.32%     -    0s
     0     0 -92349.592    0   44 -92054.563 -92349.592  0.32%     -    0s
     0     0 -92276.959    0   43 -92054.563 -92276.959  0.24%     -    0s
     0     0 -92274.000    0   43 -92054.563 -92274.000  0.24%     -    0s
     0     0 -92273.898    0   86 -92054.563 -92273.898  0.24%     -    0s
     0     0 -92273.898    0   42 -92054.563 -92273.898  0.24%     -    0s
     0     0 -92273.898    0   44 -92054.563 -92273.898  0.24%     -    0s
     0     0 -92273.898    0   43 -92054.563 -92273.898  0.24%     -    0s
     0     0 -92247.962    0   42 -92054.563 -92247.962  0.21%     -    0s
     0     0 -92247.243    0   69 -92054.563 -92247.243  0.21%     -    0s
     0     0 -92224.462    0   68 -92054.563 -92224.462  0.18%     -    0s
     0     0 -92213.293    0   44 -92054.563 -92213.293  0.17%     -    0s
     0     0 -92193.002    0   41 -92054.563 -92193.002  0.15%     -    0s
     0     0 -92191.437    0   43 -92054.563 -92191.437  0.15%     -    0s
     0     0 -92189.147    0   42 -92054.563 -92189.147  0.15%     -    0s
     0     0 -92189.128    0   42 -92054.563 -92189.128  0.15%     -    0s
     0     2 -92189.128    0   42 -92054.563 -92189.128  0.15%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 4
  MIR: 115
  Flow cover: 16

Explored 30 nodes (1249 simplex iterations) in 0.13 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -92054.6 -90011.2 -89715.4 ... 1.27287e+13
No other solutions better than -92054.6

Optimal solution found (tolerance 1.00e-04)
Best objective -9.205456319635e+04, best bound -9.205456319635e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 118901.43
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92054.56
  [DEBUG]   S×d_nominal = 210955.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 210955.99 + -92054.56 = 118901.43
  [DEBUG]   Current θ from Master = 118952.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 51.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4089.62
  Lower Bound (LB) = -4089.62
  Gap (UB-LB) = 51.5295, Absolute Gap = 51.5295, Relative Gap = 0.012761
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 16
Total Time: 38161.77s
Converged: True
Final Lower Bound: -4089.6181
Final Upper Bound: -4038.0886
Final Gap: 51.529475
Number of Critical Scenarios: 16
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 6, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 4 customers  Mode 1: 9 customers  Mode 2: 37 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 16
Start Time: 2026-01-05 14:43:34
End Time: 2026-01-06 01:19:35
Total Time: 38161.77s
Optimal Value: -4089.62
Lower Bound: -4089.62
Upper Bound: -4038.09
Gap: 51.529475
Plants Opened: {0: [0], 1: [2], 2: [2]} (3 plants)
DCs Opened: [3, 6, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed39_LD_gamma20_20260106_011936.csv

Total Execution Time: 38162.29 seconds
End Time: 2026-01-06 01:19:36

All tasks completed successfully!

