
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 31
DI Scenario: Mixed
Start Time: 2026-01-05 05:55:34
================================================================================
Loading data from data/DH_data_full_seed31.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
  Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
  Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=953, max=1707
  DC capacity (MC): min=537, max=893

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.03, max=34.96, count=83
  Deviation (μ̂): min=4.06, max=9.95

Costs:
  Plant fixed cost: min=5416, max=9026
  DC fixed cost: min=3584, max=5357
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.357', '1.840'] (k=0.752)
    Product 2: ['1.000', '1.369', '1.875'] (k=0.775)
  MD:
    Product 0: ['1.000', '1.211', '1.467'] (k=0.473)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.303', '1.698'] (k=0.653)
  LD:
    Product 0: ['1.000', '1.027', '1.054'] (k=0.065)
    Product 1: ['1.000', '1.079', '1.163'] (k=0.187)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
  Mixed:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0xfbcaef31
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.07s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -282651.0598
Found heuristic solution: objective -197738.4924

Root relaxation: objective 1.183377e+05, 4811 iterations, 0.20 seconds (0.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 118337.726    0  528 -197738.49 118337.726   160%     -    0s
H    0     0                    -177818.2915 118337.726   167%     -    0s
     0     0 110736.444    0  737 -177818.29 110736.444   162%     -    1s
     0     0 110647.503    0  746 -177818.29 110647.503   162%     -    1s
     0     0 110646.562    0  752 -177818.29 110646.562   162%     -    1s
     0     0 106363.372    0  989 -177818.29 106363.372   160%     -    2s
H    0     0                    -176680.1744 106361.098   160%     -    2s
     0     0 106074.242    0 1021 -176680.17 106074.242   160%     -    2s
     0     0 106035.666    0 1038 -176680.17 106035.666   160%     -    2s
     0     0 106030.746    0 1038 -176680.17 106030.746   160%     -    2s
     0     0 106030.578    0 1039 -176680.17 106030.578   160%     -    2s
H    0     0                    -174459.2293 103215.409   159%     -    3s
H    0     0                    -166085.8224 103215.409   162%     -    3s
H    0     0                    -164562.7366 103215.409   163%     -    3s
     0     0 103215.409    0 1104 -164562.74 103215.409   163%     -    3s
     0     0 102968.917    0 1101 -164562.74 102968.917   163%     -    4s
     0     0 102934.279    0 1102 -164562.74 102934.279   163%     -    4s
     0     0 102928.635    0 1107 -164562.74 102928.635   163%     -    4s
     0     0 102927.359    0 1110 -164562.74 102927.359   163%     -    4s
H    0     0                    -147314.9930 102927.359   170%     -    4s
H    0     0                    -141285.5635 102927.359   173%     -    4s
H    0     0                    -133302.4599 102927.359   177%     -    4s
H    0     0                    -128728.3354 102927.359   180%     -    4s
H    0     0                    -68671.63865 102927.359   250%     -    4s
H    0     0                    43101.119593 102927.359   139%     -    4s
     0     0 100473.073    0 1150 43101.1196 100473.073   133%     -    6s
     0     0 100169.153    0 1181 43101.1196 100169.153   132%     -    6s
     0     0 100126.123    0 1180 43101.1196 100126.123   132%     -    6s
     0     0 100116.261    0 1185 43101.1196 100116.261   132%     -    6s
     0     0 100115.556    0 1186 43101.1196 100115.556   132%     -    6s
H    0     0                    48640.986542 100115.556   106%     -    6s
     0     0 97102.4879    0 1134 48640.9865 97102.4879   100%     -    8s
     0     0 96781.5472    0 1145 48640.9865 96781.5472  99.0%     -    8s
     0     0 96715.7979    0 1151 48640.9865 96715.7979  98.8%     -    8s
     0     0 96700.7706    0 1157 48640.9865 96700.7706  98.8%     -    9s
     0     0 96698.9955    0 1169 48640.9865 96698.9955  98.8%     -    9s
H    0     0                    49098.776031 95305.0764  94.1%     -   10s
H    0     0                    50258.875644 95305.0764  89.6%     -   10s
H    0     0                    50443.324614 95305.0764  88.9%     -   10s
H    0     0                    50474.374572 95305.0764  88.8%     -   10s
     0     0 95305.0764    0 1139 50474.3746 95305.0764  88.8%     -   10s
     0     0 95053.8762    0 1184 50474.3746 95053.8762  88.3%     -   10s
     0     0 94983.2382    0 1209 50474.3746 94983.2382  88.2%     -   11s
     0     0 94964.0374    0 1205 50474.3746 94964.0374  88.1%     -   11s
     0     0 94962.1521    0 1219 50474.3746 94962.1521  88.1%     -   11s
H    0     0                    50640.943575 93825.7622  85.3%     -   12s
H    0     0                    50764.011399 93825.7622  84.8%     -   12s
     0     0 93825.7622    0 1127 50764.0114 93825.7622  84.8%     -   12s
H    0     0                    50871.822884 93562.0002  83.9%     -   13s
     0     0 93562.0002    0 1168 50871.8229 93562.0002  83.9%     -   13s
H    0     0                    52171.260507 93485.3605  79.2%     -   13s
H    0     0                    53465.457083 93485.3605  74.9%     -   13s
     0     0 93485.3605    0 1178 53465.4571 93485.3605  74.9%     -   13s
     0     0 93469.9927    0 1181 53465.4571 93469.9927  74.8%     -   13s
     0     0 92069.7979    0 1119 53465.4571 92069.7979  72.2%     -   15s
     0     0 91888.3439    0 1193 53465.4571 91888.3439  71.9%     -   16s
     0     0 91822.6338    0 1205 53465.4571 91822.6338  71.7%     -   16s
     0     0 91813.5740    0 1201 53465.4571 91813.5740  71.7%     -   16s
     0     0 91284.7528    0 1114 53465.4571 91284.7528  70.7%     -   17s
     0     0 91102.5075    0 1134 53465.4571 91102.5075  70.4%     -   18s
     0     0 91065.4260    0 1161 53465.4571 91065.4260  70.3%     -   18s
     0     0 91054.0907    0 1173 53465.4571 91054.0907  70.3%     -   18s
     0     0 90774.6449    0 1078 53465.4571 90774.6449  69.8%     -   20s
     0     0 90632.0228    0 1136 53465.4571 90632.0228  69.5%     -   20s
     0     0 90583.8425    0 1137 53465.4571 90583.8425  69.4%     -   21s
     0     0 90572.9801    0 1134 53465.4571 90572.9801  69.4%     -   21s
H    0     0                    53520.698253 89969.1410  68.1%     -   22s
     0     0 89969.1410    0 1075 53520.6983 89969.1410  68.1%     -   22s
     0     0 89881.4713    0 1127 53520.6983 89881.4713  67.9%     -   23s
     0     0 89857.9911    0 1150 53520.6983 89857.9911  67.9%     -   23s
     0     0 89652.3740    0 1087 53520.6983 89652.3740  67.5%     -   24s
     0     0 89599.4984    0 1096 53520.6983 89599.4984  67.4%     -   25s
H    0     0                    53824.842555 89583.0214  66.4%     -   25s
H    0     0                    54151.358330 89583.0214  65.4%     -   25s
H    0     0                    54186.125644 89583.0214  65.3%     -   25s
     0     0 89583.0214    0 1083 54186.1256 89583.0214  65.3%     -   25s
H    0     0                    54428.464432 88519.1022  62.6%     -   27s
     0     0 88519.1022    0 1024 54428.4644 88519.1022  62.6%     -   27s
     0     0 88247.9248    0 1064 54428.4644 88247.9248  62.1%     -   28s
     0     0 88168.1019    0 1067 54428.4644 88168.1019  62.0%     -   28s
     0     0 88146.2801    0 1053 54428.4644 88146.2801  61.9%     -   29s
     0     0 83833.2893    0 1007 54428.4644 83833.2893  54.0%     -   31s
     0     0 82970.7738    0 1069 54428.4644 82970.7738  52.4%     -   32s
     0     0 82792.8437    0 1076 54428.4644 82792.8437  52.1%     -   33s
     0     0 82742.1930    0 1122 54428.4644 82742.1930  52.0%     -   33s
     0     0 82723.3522    0 1083 54428.4644 82723.3522  52.0%     -   33s
     0     0 78124.2817    0  937 54428.4644 78124.2817  43.5%     -   36s
     0     0 77529.7550    0  997 54428.4644 77529.7550  42.4%     -   37s
     0     0 77407.1757    0 1011 54428.4644 77407.1757  42.2%     -   37s
     0     0 77344.3886    0 1023 54428.4644 77344.3886  42.1%     -   37s
     0     0 77332.7220    0 1037 54428.4644 77332.7220  42.1%     -   38s
     0     0 71848.8678    0  684 54428.4644 71848.8678  32.0%     -   40s
     0     0 71110.4976    0  686 54428.4644 71110.4976  30.6%     -   41s
     0     0 71017.2935    0  730 54428.4644 71017.2935  30.5%     -   41s
     0     0 70965.5394    0  694 54428.4644 70965.5394  30.4%     -   42s
     0     0 70941.8049    0  715 54428.4644 70941.8049  30.3%     -   42s
     0     0 70132.7971    0  755 54428.4644 70132.7971  28.9%     -   43s
     0     0 69788.4101    0  777 54428.4644 69788.4101  28.2%     -   44s
     0     0 69668.3025    0  818 54428.4644 69668.3025  28.0%     -   44s
     0     0 69629.5044    0  812 54428.4644 69629.5044  27.9%     -   45s
     0     0 69220.1722    0  820 54428.4644 69220.1722  27.2%     -   46s
     0     0 69029.2656    0  857 54428.4644 69029.2656  26.8%     -   46s
     0     0 68952.1941    0  814 54428.4644 68952.1941  26.7%     -   47s
     0     0 68930.5344    0  909 54428.4644 68930.5344  26.6%     -   47s
     0     0 68756.7142    0  804 54428.4644 68756.7142  26.3%     -   48s
     0     0 68756.6215    0  804 54428.4644 68756.6215  26.3%     -   48s
     0     2 68756.6053    0  804 54428.4644 68756.6053  26.3%     -   50s
    31    64 65543.1113    5  543 54428.4644 67718.1336  24.4%  2732   56s
   317   335 62787.9576   10  504 54428.4644 67533.5941  24.1%  1032   60s
   572   552 61514.9596   13  422 54428.4644 67398.5609  23.8%   969   65s
   908   811 58075.5639   16  526 54428.4644 67160.3139  23.4%   922   70s
  1464  1070 55810.6508   20  473 54428.4644 66355.5341  21.9%   778   76s
  1730  1190 55149.3987   22  468 54428.4644 65869.4559  21.0%   783   80s
  2200  1484 55785.0553   16  502 54428.4644 65379.3465  20.1%   761   85s
  2892  1787 59951.1186   12  419 54428.4644 65356.6857  20.1%   714   90s
  3483  2023 56620.3667   11  480 54428.4644 64259.4159  18.1%   730   95s
  4051  2154 58228.0682   14  430 54428.4644 63721.7257  17.1%   720  101s
  4674  2328 58278.9664   13  469 54428.4644 63268.8417  16.2%   718  105s
  5376  2425 59770.1765   14  485 54428.4644 63069.7087  15.9%   716  111s
  5856  2597     cutoff   10      54428.4644 62586.3644  15.0%   721  115s
  6809  2786 57262.0437   20  391 54428.4644 62191.7490  14.3%   712  121s
  7606  2888 57907.9391   20  804 54428.4644 61894.4974  13.7%   700  136s
  7623  2899 57814.6984   12  400 54428.4644 61894.4974  13.7%   698  140s
  8153  2791 56096.3385   24  377 54428.4644 58621.1216  7.70%   674  145s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  Projected implied bound: 3
  MIR: 162
  Flow cover: 304
  RLT: 1
  Relax-and-lift: 34

Explored 8471 nodes (5686421 simplex iterations) in 145.95 seconds (330.43 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54428.5 54186.1 54151.4 ... 50640.9

Optimal solution found (tolerance 1.00e-04)
Best objective 5.442846443221e+04, best bound 5.442846443221e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 145.95s
  Master Objective (UB) = 54428.46, θ = 202524.84
  Upper Bound (UB) = 54428.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202524.84
  [DEBUG]   ✓ Scenario 0: θ = 202524.84 ≤ Q = 202524.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x125654ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeda9ab36
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.359788e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6929709.9026
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.439639e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143963.89    0  123 6929709.90 -143963.89   102%     -    0s
H    0     0                    -108609.2682 -143963.89  32.6%     -    0s
H    0     0                    -109875.7590 -143963.89  31.0%     -    0s
*    0     0               0    -112053.1817 -112053.18  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 206

Explored 1 nodes (383 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -112053 -109876 -108609 ... 1.35979e+13
No other solutions better than -112053

Optimal solution found (tolerance 1.00e-04)
Best objective -1.120531817393e+05, best bound -1.120531817393e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 168095.20
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112053.18
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -112053.18 = 168095.20
  [DEBUG]   Current θ from Master = 202524.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34429.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19998.82
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 34429.6442, Absolute Gap = 34429.6442, Relative Gap = 0.632567
  Not converged yet (gap = 34429.64 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0xa624476d
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 19998.8 (0.01s)
MIP start from previous solve produced solution with objective 19998.8 (0.01s)
Loaded MIP start from previous solve with objective 19998.8

Presolve removed 13595 rows and 5514 columns
Presolve time: 0.32s
Presolved: 18368 rows, 9226 columns, 101748 nonzeros
Variable types: 6967 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.028185e+04, 10970 iterations, 1.74 seconds (3.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60281.8460    0  355 19998.8202 60281.8460   201%     -    2s
H    0     0                    20384.684476 60281.8460   196%     -    2s
     0     0 52869.6250    0  579 20384.6845 52869.6250   159%     -    3s
H    0     0                    20414.347585 52860.2651   159%     -    3s
H    0     0                    20419.427710 52860.2651   159%     -    3s
     0     0 52636.4113    0  575 20419.4277 52636.4113   158%     -    3s
     0     0 52618.5211    0  576 20419.4277 52618.5211   158%     -    3s
     0     0 47476.0808    0  464 20419.4277 47476.0808   133%     -    5s
     0     0 46689.0153    0  509 20419.4277 46689.0153   129%     -    6s
     0     0 46644.6417    0  516 20419.4277 46644.6417   128%     -    6s
     0     0 46591.6557    0  522 20419.4277 46591.6557   128%     -    6s
     0     0 46589.6571    0  531 20419.4277 46589.6571   128%     -    6s
     0     0 42826.4786    0  564 20419.4277 42826.4786   110%     -    8s
H    0     0                    20512.403357 42826.0949   109%     -    9s
H    0     0                    20622.555423 42826.0949   108%     -    9s
     0     0 42107.8344    0  677 20622.5554 42107.8344   104%     -    9s
     0     0 41822.4392    0  703 20622.5554 41822.4392   103%     -   10s
     0     0 41755.1029    0  711 20622.5554 41755.1029   102%     -   10s
     0     0 41742.2908    0  727 20622.5554 41742.2908   102%     -   10s
     0     0 41737.1761    0  708 20622.5554 41737.1761   102%     -   10s
     0     0 41735.5891    0  713 20622.5554 41735.5891   102%     -   10s
     0     0 39754.0497    0  450 20622.5554 39754.0497  92.8%     -   13s
     0     0 39285.6044    0  473 20622.5554 39285.6044  90.5%     -   14s
     0     0 39091.8401    0  561 20622.5554 39091.8401  89.6%     -   14s
     0     0 39028.9609    0  487 20622.5554 39028.9609  89.3%     -   14s
     0     0 39014.7325    0  545 20622.5554 39014.7325  89.2%     -   15s
     0     0 39011.8516    0  497 20622.5554 39011.8516  89.2%     -   15s
     0     0 38544.1761    0  529 20622.5554 38544.1761  86.9%     -   16s
     0     0 38362.3119    0  517 20622.5554 38362.3119  86.0%     -   16s
     0     0 38252.0587    0  460 20622.5554 38252.0587  85.5%     -   17s
     0     0 38242.6873    0  454 20622.5554 38242.6873  85.4%     -   17s
     0     0 38237.2007    0  457 20622.5554 38237.2007  85.4%     -   17s
     0     0 38084.6093    0  725 20622.5554 38084.6093  84.7%     -   18s
H    0     0                    20837.930163 38082.6267  82.8%     -   18s
     0     0 38037.3011    0  674 20837.9302 38037.3011  82.5%     -   18s
     0     0 38029.1032    0  677 20837.9302 38029.1032  82.5%     -   18s
     0     0 38021.0500    0  668 20837.9302 38021.0500  82.5%     -   19s
     0     0 38020.2232    0  675 20837.9302 38020.2232  82.5%     -   19s
     0     0 37912.6751    0  442 20837.9302 37912.6751  81.9%     -   19s
     0     0 37854.1867    0  450 20837.9302 37854.1867  81.7%     -   20s
     0     0 37835.6324    0  464 20837.9302 37835.6324  81.6%     -   20s
     0     0 37829.3052    0  485 20837.9302 37829.3052  81.5%     -   20s
     0     0 37787.6679    0  560 20837.9302 37787.6679  81.3%     -   21s
     0     0 37774.4794    0  433 20837.9302 37774.4794  81.3%     -   21s
     0     0 37769.7492    0  563 20837.9302 37769.7492  81.3%     -   22s
     0     0 37754.8652    0  438 20837.9302 37754.8652  81.2%     -   22s
     0     0 37748.1548    0  433 20837.9302 37748.1548  81.2%     -   22s
     0     0 37740.1106    0  417 20837.9302 37740.1106  81.1%     -   23s
     0     0 37727.9686    0  436 20837.9302 37727.9686  81.1%     -   23s
     0     0 37725.3947    0  435 20837.9302 37725.3947  81.0%     -   23s
     0     0 37701.8709    0  439 20837.9302 37701.8709  80.9%     -   23s
     0     0 37701.8451    0  439 20837.9302 37701.8451  80.9%     -   24s
     0     2 37701.5663    0  439 20837.9302 37701.5663  80.9%     -   27s
     7    16 36611.1821    3  511 20837.9302 37448.1379  79.7%  1099   30s
    95   146 35454.9709    7  454 20837.9302 36999.4123  77.6%  1102   35s
H  107   146                    20957.780438 36999.4123  76.5%  1004   35s
H  127   146                    21145.623100 36999.4123  75.0%   902   35s
H  299   324                    21367.884728 36999.4123  73.2%   654   37s
   392   400 33374.2636   14  471 21367.8847 36999.4123  73.2%   673   40s
   729   710 28031.5503   19  239 21367.8847 36410.2540  70.4%   597   45s
  1357  1253 21850.6944   37  139 21367.8847 35927.8202  68.1%   448   50s
  2264  1921 31221.7045   14  295 21367.8847 35790.9258  67.5%   353   55s
  3172  2612 32683.7150   14  283 21367.8847 35096.4889  64.2%   325   60s
  3524  2684 24456.6960   73  439 21367.8847 34875.7546  63.2%   316   75s
  3528  2687 32157.1119    9  446 21367.8847 34875.7546  63.2%   316   80s
  3543  2697 29243.6266   10  436 21367.8847 34875.7546  63.2%   315   85s
  3552  2703 23604.4927   31  427 21367.8847 34875.7546  63.2%   314   91s
  3560  2717 34875.7546   18  278 21367.8847 34875.7546  63.2%   323   95s
  3681  2827 29116.1316   23  290 21367.8847 34875.7546  63.2%   347  100s
H 3821  2705                    21976.479904 34522.9852  57.1%   354  102s
  4025  2745 28811.3317   22  171 21976.4799 33990.3618  54.7%   359  105s
  4633  2671     cutoff   29      21976.4799 33391.7988  51.9%   363  111s
H 4825  2498                    21979.561490 33391.7988  51.9%   365  112s
H 4829  2375                    22015.307073 33391.7988  51.7%   365  112s
H 4842  2254                    22054.021860 33391.7988  51.4%   366  112s
  5080  2229 28185.6526   23  243 22054.0219 33009.4424  49.7%   369  115s
* 5243  2128              36    23837.277168 30754.4434  29.0%   369  116s
  5783  1830     cutoff   28      23837.2772 29850.3657  25.2%   369  121s

Cutting planes:
  Learned: 2
  MIR: 199
  Mixing: 1
  Flow cover: 562
  RLT: 11
  Relax-and-lift: 48

Explored 6769 nodes (2419573 simplex iterations) in 124.65 seconds (301.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23837.3 22054 22015.3 ... 20622.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.383727716838e+04, best bound 2.383727716838e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 124.65s
  Master Objective (UB) = 23837.28, θ = 164305.31
  Upper Bound (UB) = 23837.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 164305.31
  [DEBUG]   ✓ Scenario 0: θ = 164305.31 ≤ Q = 164305.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 164305.31 ≤ Q = 164305.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x48c94680
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb736b980
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.527885e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7995057.7056
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.522214e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152221.42    0  133 7995057.71 -152221.42   102%     -    0s
H    0     0                    -112379.8816 -152221.42  35.5%     -    0s
H    0     0                    -113582.8462 -152221.42  34.0%     -    0s
H    0     0                    -133857.7028 -152221.42  13.7%     -    0s
H    0     0                    -139511.1582 -140678.65  0.84%     -    0s
     0     0 -140678.65    0   75 -139511.16 -140678.65  0.84%     -    0s
H    0     0                    -139769.8653 -140049.06  0.20%     -    0s
     0     0 -140032.19    0   68 -139769.87 -140032.19  0.19%     -    0s
     0     0 -139975.57    0   31 -139769.87 -139975.57  0.15%     -    0s
     0     0 -139972.86    0   19 -139769.87 -139972.86  0.15%     -    0s
     0     0 -139970.38    0   19 -139769.87 -139970.38  0.14%     -    0s
     0     0 -139829.06    0    7 -139769.87 -139829.06  0.04%     -    0s
     0     0 -139829.06    0   10 -139769.87 -139829.06  0.04%     -    0s
H    0     0                    -139809.2607 -139829.06  0.01%     -    0s
     0     0          -    0      -139809.26 -139820.74  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 4
  MIR: 2
  Flow cover: 6
  Relax-and-lift: 2

Explored 1 nodes (684 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -139809 -139809 -139770 ... 1.52788e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.398092606963e+05, best bound -1.398207436359e+05, gap 0.0082%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 140339.12
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139809.26
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -139809.26 = 140339.12
  [DEBUG]   Current θ from Master = 164305.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23966.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -128.91
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 3838.4569, Absolute Gap = 3838.4569, Relative Gap = 0.161027
  Not converged yet (gap = 3838.46 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0x2b1f7763
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -128.912 (0.02s)
Loaded MIP start from previous solve with objective -128.912

Presolve removed 20361 rows and 8271 columns
Presolve time: 0.42s
Presolved: 26892 rows, 12709 columns, 165584 nonzeros
Variable types: 10450 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.950542e+04, 16895 iterations, 4.49 seconds (8.33 work units)
Total elapsed time = 5.03s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49505.4153    0   97 -128.91216 49505.4153      -     -    5s
H    0     0                     633.5887251 49505.4153  7713%     -    5s
H    0     0                    5868.4371610 49505.4153   744%     -    5s
H    0     0                    10602.529000 49505.4153   367%     -    5s
H    0     0                    15494.186310 49505.4153   220%     -    5s
     0     0 45804.4284    0  231 15494.1863 45804.4284   196%     -    7s
H    0     0                    15751.768451 45804.4284   191%     -    7s
     0     0 45487.6546    0  282 15751.7685 45487.6546   189%     -    8s
     0     0 45482.2727    0  281 15751.7685 45482.2727   189%     -    8s
     0     0 45480.6784    0  275 15751.7685 45480.6784   189%     -    8s
     0     0 45480.4309    0  281 15751.7685 45480.4309   189%     -    8s
     0     0 41799.1724    0  268 15751.7685 41799.1724   165%     -   10s
     0     0 40718.0629    0  327 15751.7685 40718.0629   158%     -   11s
     0     0 40530.8530    0  360 15751.7685 40530.8530   157%     -   11s
     0     0 40463.8406    0  355 15751.7685 40463.8406   157%     -   12s
     0     0 40404.1108    0  351 15751.7685 40404.1108   157%     -   12s
     0     0 40400.9550    0  353 15751.7685 40400.9550   156%     -   12s
     0     0 40400.8079    0  354 15751.7685 40400.8079   156%     -   12s
H    0     0                    15996.944876 39399.2271   146%     -   15s
     0     0 39399.2271    0  395 15996.9449 39399.2271   146%     -   15s
     0     0 38839.0168    0  396 15996.9449 38839.0168   143%     -   16s
     0     0 38574.8237    0  358 15996.9449 38574.8237   141%     -   16s
     0     0 38434.9687    0  405 15996.9449 38434.9687   140%     -   17s
     0     0 38425.2221    0  371 15996.9449 38425.2221   140%     -   17s
     0     0 38419.3904    0  409 15996.9449 38419.3904   140%     -   17s
     0     0 38418.9844    0  365 15996.9449 38418.9844   140%     -   17s
H    0     0                    16118.238270 38418.9844   138%     -   19s
H    0     0                    16670.881592 37790.2672   127%     -   20s
     0     0 37790.2672    0  397 16670.8816 37790.2672   127%     -   20s
H    0     0                    16902.750710 37788.8702   124%     -   20s
     0     0 37608.7256    0  395 16902.7507 37608.7256   123%     -   21s
     0     0 37542.7960    0  396 16902.7507 37542.7960   122%     -   22s
     0     0 37468.4175    0  397 16902.7507 37468.4175   122%     -   22s
     0     0 37425.7425    0  410 16902.7507 37425.7425   121%     -   23s
     0     0 37405.1660    0  412 16902.7507 37405.1660   121%     -   23s
     0     0 37388.6874    0  411 16902.7507 37388.6874   121%     -   23s
     0     0 37380.1819    0  416 16902.7507 37380.1819   121%     -   23s
     0     0 37373.9090    0  414 16902.7507 37373.9090   121%     -   23s
     0     0 37368.4619    0  418 16902.7507 37368.4619   121%     -   23s
     0     0 37365.9127    0  420 16902.7507 37365.9127   121%     -   24s
     0     0 37363.9680    0  420 16902.7507 37363.9680   121%     -   24s
     0     0 37362.0536    0  423 16902.7507 37362.0536   121%     -   24s
     0     0 37361.8667    0  425 16902.7507 37361.8667   121%     -   24s
     0     0 37226.2188    0  413 16902.7507 37226.2188   120%     -   25s
H    0     0                    17094.620879 37225.9506   118%     -   25s
H    0     0                    17123.388024 37225.9506   117%     -   25s
H    0     0                    17559.921130 37225.9506   112%     -   25s
     0     0 37175.7420    0  469 17559.9211 37175.7420   112%     -   25s
     0     0 37169.8512    0  462 17559.9211 37169.8512   112%     -   25s
     0     0 37166.1639    0  467 17559.9211 37166.1639   112%     -   25s
     0     0 37165.5625    0  467 17559.9211 37165.5625   112%     -   26s
     0     0 37029.6428    0  452 17559.9211 37029.6428   111%     -   26s
H    0     0                    19849.457209 37027.3520  86.5%     -   27s
     0     0 36984.7417    0  454 19849.4572 36984.7417  86.3%     -   28s
     0     0 36961.8602    0  458 19849.4572 36961.8602  86.2%     -   28s
     0     0 36958.2410    0  468 19849.4572 36958.2410  86.2%     -   28s
     0     0 36957.1315    0  467 19849.4572 36957.1315  86.2%     -   28s
     0     0 36922.3977    0  413 19849.4572 36922.3977  86.0%     -   29s
     0     0 36916.9264    0  469 19849.4572 36916.9264  86.0%     -   29s
     0     0 36912.4265    0  424 19849.4572 36912.4265  86.0%     -   29s
     0     0 36911.7948    0  426 19849.4572 36911.7948  86.0%     -   29s
     0     0 36891.4121    0  422 19849.4572 36891.4121  85.9%     -   30s
H    0     0                    20321.181245 36891.1131  81.5%     -   30s
H    0     0                    20421.323516 36891.1131  80.6%     -   30s
H    0     0                    20478.325445 36891.1131  80.1%     -   30s
H    0     0                    20580.506708 36891.1131  79.3%     -   30s
     0     0 36887.4583    0  421 20580.5067 36887.4583  79.2%     -   30s
     0     0 36885.3931    0  425 20580.5067 36885.3931  79.2%     -   31s
     0     0 36884.6489    0  420 20580.5067 36884.6489  79.2%     -   31s
     0     0 36880.0711    0  423 20580.5067 36880.0711  79.2%     -   31s
     0     0 36876.2457    0  407 20580.5067 36876.2457  79.2%     -   31s
     0     0 36874.0341    0  417 20580.5067 36874.0341  79.2%     -   31s
     0     0 36872.9423    0  420 20580.5067 36872.9423  79.2%     -   31s
     0     0 36872.2786    0  417 20580.5067 36872.2786  79.2%     -   32s
     0     0 36871.9987    0  416 20580.5067 36871.9987  79.2%     -   32s
     0     0 36868.9901    0  413 20580.5067 36868.9901  79.1%     -   32s
     0     0 36867.9871    0  413 20580.5067 36867.9871  79.1%     -   32s
H    0     0                    20772.017034 36867.9871  77.5%     -   37s
H    0     2                    20820.151932 36867.9871  77.1%     -   37s
     0     2 36867.9871    0  413 20820.1519 36867.9871  77.1%     -   37s
     3     8 36751.5385    2  466 20820.1519 36854.0512  77.0%  1380   40s
    31    64 36033.5087    5  466 20820.1519 36348.4837  74.6%  3157   45s
   161   225 35762.0195    8  445 20820.1519 36152.0079  73.6%  1767   50s
   271   315 34134.1721    9  349 20820.1519 36152.0079  73.6%  1668   55s
   369   404 33995.4335   10  353 20820.1519 36152.0079  73.6%  1739   60s
   527   532 32562.2421   12  289 20820.1519 36152.0079  73.6%  1854   68s
   579   580 32360.5254   12  412 20820.1519 36152.0079  73.6%  1869   70s
   708   657 30138.9634   13  270 20820.1519 36013.4169  73.0%  1960   75s
   876   786 30496.8290   15  377 20820.1519 35928.4166  72.6%  2051   81s
   992   894 29443.4550   16  371 20820.1519 35893.3130  72.4%  2104   87s
  1133  1041 27586.6583   18  355 20820.1519 35893.3130  72.4%  1974   91s
  1372  1235 28078.3757   23  297 20820.1519 35893.3130  72.4%  1760   98s
  1472  1340 27717.4003   23  246 20820.1519 35893.3130  72.4%  1689  100s
  1792  1612 25307.4028   29  257 20820.1519 35893.3130  72.4%  1504  105s
  2122  1808 23310.2723   33  118 20820.1519 35893.3130  72.4%  1376  111s
  2395  2029 23495.1911   35  128 20820.1519 35532.3713  70.7%  1306  117s
  2582  2199 23103.7364   37   97 20820.1519 35532.3713  70.7%  1257  120s
  3062  2431 27410.8304   13  294 20820.1519 35532.3713  70.7%  1163  127s
  3214  2500 27133.1521   14  296 20820.1519 35532.3713  70.7%  1140  130s
  3504  2642 27264.6441   15  222 20820.1519 35356.6051  69.8%  1139  137s
  3633  2721 24643.0276   15  210 20820.1519 35143.1944  68.8%  1149  141s
  3946  2858 29827.4738   10  413 20820.1519 35040.8261  68.3%  1156  154s
  3948  2859 30851.9793   14   97 20820.1519 35040.8261  68.3%  1156  159s
  3949  2860 23695.0922   20  331 20820.1519 35040.8261  68.3%  1155  162s
  3951  2861 32311.5748   13  411 20820.1519 35040.8261  68.3%  1155  166s
  3957  2865 29340.9272   14  403 20820.1519 35040.8261  68.3%  1153  170s
  3966  2871 23410.2705   62  487 20820.1519 35040.8261  68.3%  1151  175s
  3973  2876 24570.3368   34  503 20820.1519 35040.8261  68.3%  1149  180s
  3980  2881 22971.3416   32  441 20820.1519 35040.8261  68.3%  1146  185s
  3988  2886 25420.7095   14  535 20820.1519 35040.8261  68.3%  1144  191s
  3993  2889 31496.4617   16  544 20820.1519 35040.8261  68.3%  1143  200s
  3994  2890 25446.4707   36  544 20820.1519 35040.8261  68.3%  1142  205s
  3997  2897 32198.7319   15  337 20820.1519 35040.8261  68.3%  1162  211s
  4009  2917 30066.1477   17  299 20820.1519 33705.0976  61.9%  1170  218s
  4025  2936 25925.7062   18  349 20820.1519 32607.7523  56.6%  1184  225s
H 4045  2783                    20861.908624 32396.5492  55.3%  1226  225s
  4055  2806 23385.6990   19  308 20861.9086 32396.5492  55.3%  1242  230s
H 4087  2718                    20866.188557 32396.5492  55.3%  1260  233s
H 4091  2586                    20974.579497 32396.5492  54.5%  1260  233s
H 4098  2458                    21015.657525 32396.5492  54.2%  1263  233s
H 4131  2329                    21051.559565 32396.5492  53.9%  1269  233s
H 4138  2215                    21065.573050 32396.5492  53.8%  1270  233s
  4155  2263     cutoff   22      21065.5731 32396.5492  53.8%  1276  236s
  4236  2267     cutoff   23      21065.5731 31841.6264  51.2%  1301  241s
H 4237  2160                    21069.852983 31841.6264  51.1%  1301  241s
H 4243  2056                    21117.740294 31841.6264  50.8%  1302  241s
  4391  2078 28203.1459   19  366 21117.7403 30970.5788  46.7%  1316  246s
H 4394  1981                    21121.055438 30970.5788  46.6%  1317  246s
  4532  2001 26812.0706   21  283 21121.0554 30970.5788  46.6%  1317  251s
  4666  2030 24765.0129   23  364 21121.0554 30969.5232  46.6%  1315  257s
  4812  2039 24437.6600   25  324 21121.0554 30969.5232  46.6%  1306  261s
  4969  2057 22350.1251   28  261 21121.0554 30641.1100  45.1%  1293  267s
  5140  2056 21233.6779   29  227 21121.0554 30349.4975  43.7%  1283  271s
  5317  2079 25703.0666   25  351 21121.0554 30349.4975  43.7%  1278  277s
  5406  2069 23855.7604   27  394 21121.0554 30266.9214  43.3%  1277  281s
  5499  2071 22473.3881   29  327 21121.0554 29905.6288  41.6%  1276  286s
  5581  2073 21377.2433   31  273 21121.0554 29903.0641  41.6%  1277  291s
  5682  2072 28285.9311   24  217 21121.0554 29746.4264  40.8%  1272  297s
  5738  2082 27566.2597   25  189 21121.0554 29746.4264  40.8%  1270  300s
  5803  2096 26745.9982   26  248 21121.0554 29684.4615  40.5%  1268  305s
  5971  2094 26364.7344   28  139 21121.0554 29348.2150  39.0%  1260  311s
  6080  2106 24470.9321   29  171 21121.0554 29316.1949  38.8%  1255  315s
  6324  2100 24060.8817   32  108 21121.0554 29316.1949  38.8%  1247  322s
  6450  2092 21897.8640   39  107 21121.0554 29316.1949  38.8%  1246  327s
  6609  2100 25826.4387   25  205 21121.0554 29212.4094  38.3%  1237  332s
  6796  2117 24124.0354   29  259 21121.0554 29212.4094  38.3%  1229  335s
H 7057  2046                    21473.369792 28571.0264  33.1%  1216  339s
  7178  2017     cutoff   47      21473.3698 28571.0264  33.1%  1210  344s
H 7197  1923                    21513.020211 28571.0264  32.8%  1209  344s
H 7337  1795                    21527.365994 28571.0264  32.7%  1200  344s
  7399  1831 24866.3539   27  243 21527.3660 28571.0264  32.7%  1199  348s
  7606  1809 24280.4403   30  186 21527.3660 28571.0264  32.7%  1197  353s
  7847  1772     cutoff   35      21527.3660 28222.2047  31.1%  1190  358s
  8107  1761 24303.5479   25  217 21527.3660 28115.6136  30.6%  1185  363s
  8392  1685     cutoff   32      21527.3660 28115.6136  30.6%  1178  366s
H 8397  1604                    21573.298559 28115.6136  30.3%  1178  366s
H 8402  1597                    21580.603536 28115.6136  30.3%  1178  366s
H 8407  1597                    21725.046563 28115.6136  29.4%  1177  366s
  8435  1665 25275.9137   26  310 21725.0466 28115.6136  29.4%  1177  371s
  8775  1712 23604.0172   34  239 21725.0466 28115.6136  29.4%  1167  376s
  9171  1745     cutoff   26      21725.0466 28115.6136  29.4%  1153  381s
  9608  1684 22399.5444   33  137 21725.0466 26884.8587  23.8%  1138  389s
 10036  1687 22435.6707   28  284 21725.0466 26548.0536  22.2%  1125  394s
 10520  1673 23540.5332   41   84 21725.0466 26425.2168  21.6%  1106  400s
 11063  1626 22092.2447   31  162 21725.0466 25971.7289  19.5%  1088  406s
 11638  1541 23365.3319   29  307 21725.0466 25333.7039  16.6%  1069  411s
H12269  1541                    21803.315713 25141.9985  15.3%  1046  411s
 12318  1250 23934.0740   35  232 21803.3157 25141.9985  15.3%  1043  416s
H13078  1250                    22217.230596 24687.7795  11.1%  1014  416s
 13147   486 23090.3111   27  133 22217.2306 24549.4063  10.5%  1011  421s
H13350   486                    22309.415010 24463.3851  9.65%   999  421s
 14312    61     cutoff   31      22309.4150 24023.8685  7.68%   952  425s
*14449    61              37    22349.919401 24023.8685  7.49%   945  425s
*14729    61              41    22362.625645 23870.6415  6.74%   930  425s
*15069     0              46    22382.106899 22455.8139  0.33%   911  425s
*15133     0              40    22411.273185 22421.3340  0.04%   907  425s

Cutting planes:
  MIR: 328
  Mixing: 1
  Flow cover: 831
  RLT: 15
  Relax-and-lift: 58

Explored 15182 nodes (13794514 simplex iterations) in 425.94 seconds (1275.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22411.3 22382.1 22362.6 ... 21573.3

Optimal solution found (tolerance 1.00e-04)
Best objective 2.241127318550e+04, best bound 2.241127318550e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 425.97s
  Master Objective (UB) = 22411.27, θ = 162302.62
  Upper Bound (UB) = 22411.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 162302.62
  [DEBUG]   ✓ Scenario 0: θ = 162302.62 ≤ Q = 162302.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 162302.62 ≤ Q = 162302.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 162302.62 ≤ Q = 162302.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6cea1c26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6cea1c26
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.534466e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 8017399.8046
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.500163e+05, 274 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150016.33    0  137 8017399.80 -150016.33   102%     -    0s
H    0     0                    -107963.4736 -150016.33  39.0%     -    0s
H    0     0                    -109028.1417 -150016.33  37.6%     -    0s
H    0     0                    -129476.1758 -150016.33  15.9%     -    0s
H    0     0                    -129510.8660 -150016.33  15.8%     -    0s
H    0     0                    -138152.6303 -150016.33  8.59%     -    0s
     0     0 -140651.29    0   75 -138152.63 -140651.29  1.81%     -    0s
H    0     0                    -139352.5997 -140627.78  0.92%     -    0s
     0     0 -140036.52    0   77 -139352.60 -140036.52  0.49%     -    0s
     0     0 -140013.38    0   77 -139352.60 -140013.38  0.47%     -    0s
     0     0 -139508.86    0   15 -139352.60 -139508.86  0.11%     -    0s
     0     0 -139502.96    0   12 -139352.60 -139502.96  0.11%     -    0s
H    0     0                    -139362.4700 -139477.67  0.08%     -    0s
     0     0 -139477.67    0   14 -139362.47 -139477.67  0.08%     -    0s
     0     0 -139475.14    0   15 -139362.47 -139475.14  0.08%     -    0s
H    0     0                    -139366.4208 -139475.14  0.08%     -    0s
H    0     0                    -139380.6869 -139475.14  0.07%     -    0s
     0     0 -139445.38    0    9 -139380.69 -139445.38  0.05%     -    0s
     0     0 -139426.58    0    9 -139380.69 -139426.58  0.03%     -    0s
H    0     0                    -139392.8857 -139426.58  0.02%     -    0s
     0     0          -    0      -139392.89 -139403.22  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 3
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (680 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139393 -139381 -139366 ... -107963

Optimal solution found (tolerance 1.00e-04)
Best objective -1.393928856681e+05, best bound -1.394032199130e+05, gap 0.0074%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 138552.65
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139392.89
  [DEBUG]   S×d_nominal = 277945.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 277945.54 + -139392.89 = 138552.65
  [DEBUG]   Current θ from Master = 162302.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23749.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1338.70
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 2412.4530, Absolute Gap = 2412.4530, Relative Gap = 0.107645
  Not converged yet (gap = 2412.45 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0xa244468b
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -1338.7 (0.04s)
MIP start from previous solve produced solution with objective -1338.7 (0.04s)
Loaded MIP start from previous solve with objective -1338.7

Presolve removed 27128 rows and 11018 columns
Presolve time: 0.55s
Presolved: 35415 rows, 16202 columns, 218999 nonzeros
Variable types: 13943 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35415 rows, 16202 columns, 218999 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47402    2.1276537e+04   0.000000e+00   1.166490e+07      5s
   62122    3.7443145e+04   0.000000e+00   5.506083e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.909449e+04, 25925 iterations, 9.46 seconds (17.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49094.4943    0   90 -1338.6951 49094.4943  3767%     -   10s
H    0     0                    15229.374018 49094.4943   222%     -   10s
H    0     0                    15582.239283 49094.4943   215%     -   10s
     0     0 45753.2948    0  231 15582.2393 45753.2948   194%     -   12s
H    0     0                    15794.463030 45752.5662   190%     -   12s
     0     0 45515.2519    0  283 15794.4630 45515.2519   188%     -   13s
     0     0 45485.1347    0  289 15794.4630 45485.1347   188%     -   14s
     0     0 45485.0515    0  289 15794.4630 45485.0515   188%     -   14s
     0     0 41357.6905    0  308 15794.4630 41357.6905   162%     -   18s
H    0     0                    17934.975160 41357.6905   131%     -   18s
H    0     0                    19547.827715 41357.6905   112%     -   18s
     0     0 41324.7229    0  336 19547.8277 41324.7229   111%     -   20s
     0     0 41133.8679    0  339 19547.8277 41133.8679   110%     -   20s
     0     0 41020.6323    0  337 19547.8277 41020.6323   110%     -   21s
     0     0 40999.6609    0  345 19547.8277 40999.6609   110%     -   21s
     0     0 40997.7491    0  339 19547.8277 40997.7491   110%     -   21s
     0     0 40997.6276    0  337 19547.8277 40997.6276   110%     -   21s
H    0     0                    19554.419266 38809.7216  98.5%     -   27s
H    0     0                    19572.019270 38809.7216  98.3%     -   27s
H    0     0                    19621.915590 38809.7216  97.8%     -   27s
     0     0 38809.7216    0  373 19621.9156 38809.7216  97.8%     -   27s
H    0     0                    19641.806367 38285.7618  94.9%     -   30s
     0     0 38285.7618    0  420 19641.8064 38285.7618  94.9%     -   30s
     0     0 38152.3354    0  424 19641.8064 38152.3354  94.2%     -   31s
     0     0 38081.2143    0  388 19641.8064 38081.2143  93.9%     -   32s
     0     0 38061.3748    0  377 19641.8064 38061.3748  93.8%     -   32s
     0     0 38041.7496    0  383 19641.8064 38041.7496  93.7%     -   32s
     0     0 38035.6367    0  386 19641.8064 38035.6367  93.6%     -   33s
     0     0 38032.8360    0  385 19641.8064 38032.8360  93.6%     -   33s
     0     0 38031.4172    0  390 19641.8064 38031.4172  93.6%     -   33s
     0     0 38030.6206    0  388 19641.8064 38030.6206  93.6%     -   33s
     0     0 37470.1500    0  386 19641.8064 37470.1500  90.8%     -   38s
     0     0 37230.6441    0  433 19641.8064 37230.6441  89.5%     -   39s
     0     0 37135.7254    0  401 19641.8064 37135.7254  89.1%     -   40s
     0     0 37105.8178    0  395 19641.8064 37105.8178  88.9%     -   40s
     0     0 37097.6733    0  392 19641.8064 37097.6733  88.9%     -   41s
     0     0 37090.7664    0  394 19641.8064 37090.7664  88.8%     -   41s
     0     0 37088.5958    0  397 19641.8064 37088.5958  88.8%     -   41s
     0     0 37088.0816    0  395 19641.8064 37088.0816  88.8%     -   41s
H    0     0                    19668.882809 36959.6098  87.9%     -   43s
     0     0 36959.6098    0  453 19668.8828 36959.6098  87.9%     -   43s
     0     0 36922.9581    0  454 19668.8828 36922.9581  87.7%     -   45s
     0     0 36905.0351    0  519 19668.8828 36905.0351  87.6%     -   45s
     0     0 36895.7986    0  515 19668.8828 36895.7986  87.6%     -   46s
     0     0 36888.7519    0  509 19668.8828 36888.7519  87.5%     -   46s
     0     0 36886.6495    0  520 19668.8828 36886.6495  87.5%     -   46s
     0     0 36885.7163    0  517 19668.8828 36885.7163  87.5%     -   46s
     0     0 36824.5194    0  457 19668.8828 36824.5194  87.2%     -   48s
     0     0 36805.9820    0  463 19668.8828 36805.9820  87.1%     -   49s
     0     0 36794.2958    0  467 19668.8828 36794.2958  87.1%     -   49s
     0     0 36791.5912    0  470 19668.8828 36791.5912  87.1%     -   49s
     0     0 36789.8749    0  468 19668.8828 36789.8749  87.0%     -   50s
     0     0 36789.1172    0  473 19668.8828 36789.1172  87.0%     -   50s
     0     0 36608.0233    0  408 19668.8828 36608.0233  86.1%     -   52s
     0     0 36566.6485    0  471 19668.8828 36566.6485  85.9%     -   53s
     0     0 36542.0868    0  414 19668.8828 36542.0868  85.8%     -   54s
     0     0 36531.3616    0  432 19668.8828 36531.3616  85.7%     -   54s
     0     0 36529.1645    0  437 19668.8828 36529.1645  85.7%     -   54s
     0     0 36527.9835    0  440 19668.8828 36527.9835  85.7%     -   54s
     0     0 36500.5996    0  425 19668.8828 36500.5996  85.6%     -   56s
     0     0 36491.3180    0  432 19668.8828 36491.3180  85.5%     -   56s
     0     0 36488.6465    0  437 19668.8828 36488.6465  85.5%     -   56s
     0     0 36488.2734    0  438 19668.8828 36488.2734  85.5%     -   56s
     0     0 36475.3054    0  534 19668.8828 36475.3054  85.4%     -   57s
     0     0 36466.8577    0  436 19668.8828 36466.8577  85.4%     -   58s
     0     0 36466.5985    0  437 19668.8828 36466.5985  85.4%     -   58s
     0     0 36463.8215    0  427 19668.8828 36463.8215  85.4%     -   58s
H    0     0                    20279.260801 36463.6656  79.8%     -   58s
H    0     0                    20286.890087 36463.6656  79.7%     -   58s
H    0     0                    20335.735529 36463.6656  79.3%     -   58s
H    0     0                    20346.433918 36463.6656  79.2%     -   58s
     0     0 36463.1539    0  439 20346.4339 36463.1539  79.2%     -   59s
     0     0 36461.8308    0  439 20346.4339 36461.8308  79.2%     -   59s
     0     0 36461.4204    0  431 20346.4339 36461.4204  79.2%     -   59s
     0     0 36459.1579    0  441 20346.4339 36459.1579  79.2%     -   60s
H    0     0                    20423.204292 36458.1106  78.5%     -   60s
     0     0 36457.4577    0  443 20423.2043 36457.4577  78.5%     -   60s
     0     0 36457.1017    0  444 20423.2043 36457.1017  78.5%     -   60s
     0     0 36453.9393    0  437 20423.2043 36453.9393  78.5%     -   61s
     0     0 36453.1315    0  437 20423.2043 36453.1315  78.5%     -   61s
H    0     0                    20488.060241 36452.9280  77.9%     -   68s
H    0     0                    20665.122465 36452.9280  76.4%     -   69s
     0     2 36452.9280    0  437 20665.1225 36452.9280  76.4%     -   69s
     1     4 36217.1935    1  412 20665.1225 36452.9280  76.4%  1756   71s
     7    16 35991.4508    3  443 20665.1225 36175.3625  75.1%  1955   76s
    31    64 35272.7054    5  433 20665.1225 35819.2172  73.3%  4403   82s
H   32    64                    20688.986609 35819.2172  73.1%  4265   82s
H   33    64                    20751.421997 35819.2172  72.6%  4175   82s
H   33    64                    20848.119181 35819.2172  71.8%  4175   82s
H   34    64                    20923.979563 35819.2172  71.2%  4099   82s
H   38    64                    20954.079537 35819.2172  70.9%  3924   82s
H   43    64                    20983.920173 35819.2172  70.7%  3844   82s
H   44    64                    20999.215367 35819.2172  70.6%  3785   82s
H   44    64                    20999.253046 35819.2172  70.6%  3785   82s
H   55    64                    21013.211036 35309.4146  68.0%  3694   82s
    63    96 35164.8636    6  442 21013.2110 35309.4146  68.0%  3631   85s
H   95   196                    21087.851020 35309.2977  67.4%  2860   88s
H   98   196                    21496.704196 35309.2977  64.3%  2805   88s
H  100   196                    21646.043915 35309.2977  63.1%  2772   88s
H  112   196                    21669.847875 35309.2977  62.9%  2624   88s
   195   273 34077.3349    9  405 21669.8479 35309.2977  62.9%  1992   91s
H  277   335                    21728.451875 35309.2977  62.5%  1783   94s
   336   389 34433.3926   10  432 21728.4519 35309.2977  62.5%  1730   97s
   405   419 34114.1128   12  518 21728.4519 35271.7014  62.3%  1677  102s
   451   462 33384.8224   12  405 21728.4519 35271.7014  62.3%  1828  106s
   552   537 31633.2105   13  474 21728.4519 35271.7014  62.3%  1851  114s
   595   579 31865.4236   14  431 21728.4519 35271.7014  62.3%  2061  119s
   637   629 32011.7988   14  506 21728.4519 35271.7014  62.3%  2054  122s
   691   680 31464.3682   15  369 21728.4519 35271.7014  62.3%  2032  126s
   752   729 29543.0124   16  375 21728.4519 35148.2291  61.8%  2001  130s
   880   854 29894.5543   17  451 21728.4519 35052.7876  61.3%  1927  137s
   960   913 28463.9773   18  184 21728.4519 35002.9469  61.1%  1874  143s
  1033   934     cutoff   18      21728.4519 35002.9469  61.1%  1845  148s
  1090   982 25781.3523   20  159 21728.4519 35002.9469  61.1%  1829  152s
  1169  1034 27713.4831   20  195 21728.4519 35002.9469  61.1%  1800  156s
  1260  1093 27500.8965   22  237 21728.4519 34911.5479  60.7%  1751  160s
  1339  1154 25795.5811   24  148 21728.4519 34911.5479  60.7%  1740  165s
H 1510  1249                    21753.901649 34530.9856  58.7%  1680  168s
  1537  1363 24999.2745   31  127 21753.9016 34530.9856  58.7%  1672  172s
  1699  1461 24710.9868   36  290 21753.9016 34442.0754  58.3%  1591  176s
H 1722  1461                    21757.253724 34442.0754  58.3%  1579  176s
H 1794  1461                    21763.411481 34442.0754  58.3%  1554  176s
  1827  1585 24518.3516   38  221 21763.4115 34442.0754  58.3%  1543  181s
  2015  1690 23721.4760   45  223 21763.4115 34442.0754  58.3%  1471  185s
  2313  1891 29429.9745    9  399 21763.4115 34433.3705  58.2%  1389  194s
  2482  1993 28675.4506   10  364 21763.4115 34433.3705  58.2%  1356  199s
  2683  2050 25905.5290   11  260 21763.4115 34433.3705  58.2%  1322  205s
H 2734  2050                    21768.293820 34433.3705  58.2%  1327  205s
  2844  2131 24687.0346   12  326 21768.2938 34433.3705  58.2%  1314  211s
  2987  2212 23762.4674   14  302 21768.2938 34308.4341  57.6%  1313  216s
  3145  2284 22718.2859   17  295 21768.2938 34308.4341  57.6%  1307  221s
  3296  2372 21867.6287   22  259 21768.2938 34308.4341  57.6%  1303  226s
  3480  2481 31474.9274   12  341 21768.2938 34308.4341  57.6%  1293  231s
  3663  2619 28268.3882   17  213 21768.2938 34308.4341  57.6%  1287  237s
  3881  2798 26272.7411   22  147 21768.2938 34308.4341  57.6%  1268  242s
  4150  2799 27589.7560   23  437 21768.2938 33862.3437  55.6%  1239  258s
  4152  2800 26147.5894   25   90 21768.2938 33862.3437  55.6%  1239  269s
  4153  2801 25812.0226   21  374 21768.2938 33862.3437  55.6%  1239  278s
  4154  2802 26701.2426   20  372 21768.2938 33862.3437  55.6%  1238  283s
  4155  2802 28884.6100   14  397 21768.2938 33862.3437  55.6%  1238  286s
  4157  2804 24877.1775   43  451 21768.2938 33862.3437  55.6%  1237  290s
  4162  2807 31137.4246   13  414 21768.2938 33862.3437  55.6%  1236  295s
  4165  2809 28999.5741   18  473 21768.2938 33862.3437  55.6%  1235  301s
  4169  2812 33700.9886    7  428 21768.2938 33862.3437  55.6%  1234  306s
  4171  2813 24784.5186   35  420 21768.2938 33862.3437  55.6%  1233  310s
  4175  2816 31360.3694   13  441 21768.2938 33862.3437  55.6%  1232  315s
  4179  2818 32553.0236   11  437 21768.2938 33862.3437  55.6%  1231  320s
  4182  2820 22959.6929   32  486 21768.2938 33862.3437  55.6%  1230  325s
  4185  2822 22799.7132   44  433 21768.2938 33862.3437  55.6%  1229  340s
  4186  2823 28120.7478   23  433 21768.2938 33862.3437  55.6%  1229  346s
  4187  2827 33862.3437   11  433 21768.2938 33862.3437  55.6%  1252  356s
  4189  2830 33862.3437   12  495 21768.2938 33862.3437  55.6%  1253  363s
  4193  2837 33862.3437   13  484 21768.2938 33862.3437  55.6%  1256  367s
  4201  2850 33862.3437   14  429 21768.2938 33862.3437  55.6%  1263  377s
  4217  2860 28062.8422   15  207 21768.2938 33862.3437  55.6%  1276  390s
  4234  2884 31339.7007   16  356 21768.2938 33862.3437  55.6%  1311  399s
  4266  2982 28319.0578   17  288 21768.2938 33862.3437  55.6%  1324  406s
  4416  2984     cutoff   20      21768.2938 33862.3437  55.6%  1386  417s
  4461  3002 26700.1515   18  333 21768.2938 33862.3437  55.6%  1383  426s
  4536  3020 26589.8518   21  261 21768.2938 33862.3437  55.6%  1384  434s
  4618  3036 25841.8387   21  312 21768.2938 33862.3437  55.6%  1390  442s
  4702  3063 26489.1794   20  207 21768.2938 33862.3437  55.6%  1389  447s
  4795  3068 26423.9182   21  210 21768.2938 33862.3437  55.6%  1387  455s
  4894  3049 25296.0676   23  257 21768.2938 33862.3437  55.6%  1381  461s
  4987  3050 24401.8483   25  205 21768.2938 33862.3437  55.6%  1383  467s
  5055  3071 23930.2305   27  120 21768.2938 33862.3437  55.6%  1389  471s
  5121  3102     cutoff   31      21768.2938 33862.3437  55.6%  1392  476s
  5204  3121 21833.7948   32  105 21768.2938 33862.3437  55.6%  1391  481s
  5284  3130     cutoff   32      21768.2938 33862.3437  55.6%  1390  488s
  5365  3150 31733.6675   18  379 21768.2938 32699.3546  50.2%  1395  494s
  5441  3170 30426.2697   19  432 21768.2938 32551.9193  49.5%  1401  500s
  5526  3190 30335.4821   20  345 21768.2938 32551.9193  49.5%  1405  505s
  5618  3216 29062.5321   22  407 21768.2938 32217.0834  48.0%  1408  510s
  5729  3224 28014.1695   24  228 21768.2938 32177.5684  47.8%  1406  515s
  5859  3218 26695.4015   26  245 21768.2938 32091.3713  47.4%  1400  521s
  5983  3214 26309.8823   27  262 21768.2938 31920.3051  46.6%  1397  527s
  6082  3238 24438.7808   29  145 21768.2938 30916.0381  42.0%  1403  533s
  6197  3248 22091.2181   31  130 21768.2938 30916.0381  42.0%  1405  539s
  6326  3253 24566.5234   18  235 21768.2938 30916.0381  42.0%  1409  544s
  6452  3270 23270.4709   19  191 21768.2938 30916.0381  42.0%  1410  550s
  6594  3255 22324.4007   21  215 21768.2938 30828.1039  41.6%  1409  556s
  6729  3273 27845.4788   19  302 21768.2938 30789.3324  41.4%  1407  563s
  6863  3272 26620.1866   21  369 21768.2938 30424.0329  39.8%  1409  569s
  7044  3282 24867.1469   26  243 21768.2938 30162.2393  38.6%  1405  577s
  7213  3267 23655.6326   31  147 21768.2938 30122.6601  38.4%  1403  584s
  7311  3272 22082.9822   36   85 21768.2938 30122.6601  38.4%  1406  593s
  7460  3270 25245.7313   24  312 21768.2938 30081.9447  38.2%  1406  600s
  7623  3295 23233.5981   26  269 21768.2938 30054.8030  38.1%  1407  608s
  7827  3254 infeasible   29      21768.2938 30054.8030  38.1%  1402  616s
  7991  3259     cutoff   20      21768.2938 29686.3173  36.4%  1398  625s
  8197  3250     cutoff   24      21768.2938 29686.3173  36.4%  1402  634s
  8441  3229 26871.2992   20  271 21768.2938 29331.1307  34.7%  1403  645s
  8718  3232     cutoff   23      21768.2938 29221.5902  34.2%  1400  654s
  9008  3192 22256.1941   26   28 21768.2938 29054.8945  33.5%  1395  663s
  9307  3164 26728.5758   20   92 21768.2938 28800.3912  32.3%  1392  673s
  9551  3173 22024.0746   23   49 21768.2938 28748.3740  32.1%  1400  682s
  9799  3162 24088.0233   21  424 21768.2938 28447.6272  30.7%  1399  692s
 10224  3155 27082.9284   21  442 21768.2938 28446.1764  30.7%  1385  702s
 10700  3135     cutoff   27      21768.2938 28421.8578  30.6%  1365  712s
 11148  3078     cutoff   33      21768.2938 28107.5781  29.1%  1355  723s
 11520  3052 22025.4273   21  330 21768.2938 28088.3161  29.0%  1352  734s
 12003  3039 23934.7577   31  150 21768.2938 27717.8659  27.3%  1341  746s
 12479  2980 24437.7737   22  421 21768.2938 27538.0459  26.5%  1335  758s
 12966  2976 23245.1895   28  162 21768.2938 27460.5010  26.1%  1330  770s
 13331  3019 26362.3488   24  243 21768.2938 27460.5010  26.1%  1329  783s
 13702  3141 25276.2372   24  268 21768.2938 27229.9193  25.1%  1328  796s
 14252  3227     cutoff   37      21768.2938 27165.4103  24.8%  1320  810s
 14831  3253 23086.5757   24  247 21768.2938 26863.4802  23.4%  1313  824s
 15410  3385 24516.6300   23  275 21768.2938 26762.5062  22.9%  1309  837s
 16088  3485 22294.3346   23  236 21768.2938 26677.1485  22.6%  1298  852s
 16562  3518 21791.6121   22  316 21768.2938 26538.6760  21.9%  1293  868s
 17247  3596 24222.0591   27   95 21768.2938 26266.5017  20.7%  1286  884s
 17987  3606     cutoff   27      21768.2938 26096.3528  19.9%  1278  899s
 18734  3571     cutoff   29      21768.2938 25835.0554  18.7%  1271  916s
 19580  3538 21996.8952   27  213 21768.2938 25631.1910  17.7%  1262  932s
 20503  3552 23124.1753   25  250 21768.2938 25314.8104  16.3%  1249  949s
 21600  3443     cutoff   28      21768.2938 25074.0668  15.2%  1228  966s
 22725  3299     cutoff   28      21768.2938 24826.4754  14.0%  1208  983s
 23919  2972     cutoff   28      21768.2938 24527.4129  12.7%  1187 1000s
 25427  2477 22756.8640   37  216 21768.2938 24099.9324  10.7%  1153 1017s
 27172  1400 infeasible   29      21768.2938 23639.7200  8.60%  1115 1032s
 29692    26 infeasible   29      21768.2938 23231.2822  6.72%  1051 1042s

Cutting planes:
  MIR: 580
  Flow cover: 1485
  RLT: 30
  Relax-and-lift: 109

Explored 32276 nodes (31715199 simplex iterations) in 1043.73 seconds (3239.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21768.3 21763.4 21753.9 ... 20999.3

Optimal solution found (tolerance 1.00e-04)
Best objective 2.176829382004e+04, best bound 2.176829382004e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1043.74s
  Master Objective (UB) = 21768.29, θ = 162706.95
  Upper Bound (UB) = 21768.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 162706.95
  [DEBUG]   ✓ Scenario 0: θ = 162706.95 ≤ Q = 162706.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 162706.95 ≤ Q = 162706.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 162706.95 ≤ Q = 162706.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 162706.95 ≤ Q = 162706.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5946c648
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5946c648
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.531295e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 8060500.4333
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.470788e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147078.80    0  129 8060500.43 -147078.80   102%     -    0s
H    0     0                    -110886.9312 -147078.80  32.6%     -    0s
H    0     0                    -112051.2705 -147078.80  31.3%     -    0s
H    0     0                    -122611.1851 -147078.80  20.0%     -    0s
H    0     0                    -122898.1761 -135299.91  10.1%     -    0s
     0     0 -135299.91    0   77 -122898.18 -135299.91  10.1%     -    0s
H    0     0                    -133533.1962 -135236.04  1.28%     -    0s
H    0     0                    -133555.9844 -135236.04  1.26%     -    0s
H    0     0                    -133928.5679 -135236.04  0.98%     -    0s
H    0     0                    -133951.3561 -135236.04  0.96%     -    0s
     0     0 -135008.20    0   78 -133951.36 -135008.20  0.79%     -    0s
     0     0 -135002.43    0   78 -133951.36 -135002.43  0.78%     -    0s
     0     0 -134995.89    0   79 -133951.36 -134995.89  0.78%     -    0s
     0     0 -134460.77    0   34 -133951.36 -134460.77  0.38%     -    0s
H    0     0                    -134151.6612 -134460.77  0.23%     -    0s
     0     0 -134375.21    0   31 -134151.66 -134375.21  0.17%     -    0s
     0     0 -134327.02    0   15 -134151.66 -134327.02  0.13%     -    0s
     0     0 -134326.58    0   14 -134151.66 -134326.58  0.13%     -    0s
     0     0 -134308.68    0   18 -134151.66 -134308.68  0.12%     -    0s
     0     0 -134307.20    0   18 -134151.66 -134307.20  0.12%     -    0s
     0     0 -134307.19    0   18 -134151.66 -134307.19  0.12%     -    0s
H    0     0                    -134209.8920 -134307.19  0.07%     -    0s
     0     0 -134266.09    0    5 -134209.89 -134266.09  0.04%     -    0s
     0     0 -134255.72    0    3 -134209.89 -134255.72  0.03%     -    0s
H    0     0                    -134240.9191 -134255.72  0.01%     -    0s
H    0     0                    -134248.3312 -134255.72  0.01%     -    0s

Explored 1 nodes (673 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -134248 -134241 -134210 ... 8.0605e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.342483312205e+05, best bound -1.342557154749e+05, gap 0.0055%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 141948.17
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134248.33
  [DEBUG]   S×d_nominal = 276196.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 276196.50 + -134248.33 = 141948.17
  [DEBUG]   Current θ from Master = 162706.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20758.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1009.51
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 1769.4736, Absolute Gap = 1769.4736, Relative Gap = 0.081287
  Not converged yet (gap = 1769.47 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0x64a11090
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33895 rows and 13765 columns
Presolve time: 0.68s
Presolved: 43938 rows, 19695 columns, 272414 nonzeros
Variable types: 17436 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -211323.9797

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43938 rows, 19695 columns, 272414 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29869    1.7120556e+04   0.000000e+00   1.976439e+06      5s
   43143    3.6674998e+04   0.000000e+00   4.903530e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.893580e+04, 31508 iterations, 11.21 seconds (22.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48935.7985    0  170 -211323.98 48935.7985   123%     -   12s
H    0     0                    -199130.4848 48935.7985   125%     -   12s
H    0     0                    -127315.0343 48935.7985   138%     -   12s
H    0     0                    -126992.2398 48935.7985   139%     -   12s
H    0     0                    -53399.49381 48935.7985   192%     -   12s
H    0     0                    -53289.03764 48935.7985   192%     -   12s
H    0     0                    -53181.48527 48935.7985   192%     -   12s
H    0     0                    -52710.60027 48935.7985   193%     -   12s
H    0     0                    -26477.85454 48935.7985   285%     -   12s
H    0     0                    -12377.68610 48935.7985   495%     -   12s
H    0     0                    -12374.60771 48935.7985   495%     -   12s
H    0     0                    -3889.899197 48935.7985  1358%     -   12s
H    0     0                    1926.5256414 48935.7985  2440%     -   12s
H    0     0                    2905.9348780 48935.7985  1584%     -   12s
H    0     0                    7931.6251456 48935.7985   517%     -   12s
H    0     0                    8871.3284734 48935.7985   452%     -   12s
H    0     0                    11487.859780 48935.7985   326%     -   12s
H    0     0                    11555.356105 48935.7985   323%     -   13s
H    0     0                    11648.838523 44976.4297   286%     -   17s
H    0     0                    11724.519801 44976.4297   284%     -   17s
     0     0 44976.4297    0  275 11724.5198 44976.4297   284%     -   17s
     0     0 43984.2936    0  276 11724.5198 43984.2936   275%     -   20s
     0     0 43984.2936    0  274 11724.5198 43984.2936   275%     -   20s
     0     0 43984.2936    0  281 11724.5198 43984.2936   275%     -   21s
     0     0 43984.2936    0  281 11724.5198 43984.2936   275%     -   22s
     0     0 43984.2936    0  281 11724.5198 43984.2936   275%     -   22s
     0     0 41068.4882    0  346 11724.5198 41068.4882   250%     -   28s
H    0     0                    16487.595152 41068.2321   149%     -   28s
H    0     0                    16542.836322 41068.2321   148%     -   28s
     0     0 40170.2521    0  345 16542.8363 40170.2521   143%     -   31s
     0     0 39979.1199    0  356 16542.8363 39979.1199   142%     -   34s
     0     0 39825.0746    0  355 16542.8363 39825.0746   141%     -   35s
     0     0 39784.5567    0  358 16542.8363 39784.5567   140%     -   36s
     0     0 39775.6116    0  355 16542.8363 39775.6116   140%     -   36s
     0     0 39770.0209    0  359 16542.8363 39770.0209   140%     -   36s
     0     0 39769.7038    0  357 16542.8363 39769.7038   140%     -   36s
H    0     0                    17522.492311 38471.2380   120%     -   45s
     0     0 38471.2380    0  359 17522.4923 38471.2380   120%     -   45s
H    0     0                    17641.844349 38470.0589   118%     -   45s
H    0     0                    17643.775498 38470.0589   118%     -   45s
     0     0 38075.9900    0  455 17643.7755 38075.9900   116%     -   48s
     0     0 37930.4246    0  420 17643.7755 37930.4246   115%     -   50s
     0     0 37885.1135    0  458 17643.7755 37885.1135   115%     -   51s
     0     0 37843.8976    0  457 17643.7755 37843.8976   114%     -   52s
     0     0 37817.5536    0  414 17643.7755 37817.5536   114%     -   53s
H    0     0                    17714.694878 37798.0849   113%     -   53s
     0     0 37798.0849    0  419 17714.6949 37798.0849   113%     -   53s
     0     0 37792.4022    0  424 17714.6949 37792.4022   113%     -   53s
     0     0 37784.1004    0  462 17714.6949 37784.1004   113%     -   54s
     0     0 37778.9965    0  467 17714.6949 37778.9965   113%     -   54s
     0     0 37777.9107    0  470 17714.6949 37777.9107   113%     -   54s
H    0     0                    17730.989264 37097.4980   109%     -   60s
H    0     0                    17795.019572 37097.4980   108%     -   60s
H    0     0                    17798.147442 37097.4980   108%     -   60s
H    0     0                    17922.738454 37097.4980   107%     -   60s
H    0     0                    18329.389958 37097.4980   102%     -   60s
     0     0 37097.4980    0  391 18329.3900 37097.4980   102%     -   60s
H    0     0                    18564.494319 37096.6203   100%     -   60s
H    0     0                    18752.569083 36920.9865  96.9%     -   63s
     0     0 36920.9865    0  444 18752.5691 36920.9865  96.9%     -   63s
     0     0 36902.6670    0  396 18752.5691 36902.6670  96.8%     -   64s
     0     0 36844.6364    0  398 18752.5691 36844.6364  96.5%     -   65s
     0     0 36833.2411    0  401 18752.5691 36833.2411  96.4%     -   66s
     0     0 36825.7124    0  402 18752.5691 36825.7124  96.4%     -   66s
     0     0 36819.4287    0  405 18752.5691 36819.4287  96.3%     -   67s
     0     0 36817.6435    0  404 18752.5691 36817.6435  96.3%     -   67s
     0     0 36816.7664    0  406 18752.5691 36816.7664  96.3%     -   67s
     0     0 36758.5234    0  401 18752.5691 36758.5234  96.0%     -   69s
     0     0 36728.2057    0  412 18752.5691 36728.2057  95.9%     -   70s
     0     0 36717.2662    0  410 18752.5691 36717.2662  95.8%     -   70s
     0     0 36709.8631    0  415 18752.5691 36709.8631  95.8%     -   71s
     0     0 36707.3296    0  415 18752.5691 36707.3296  95.7%     -   71s
     0     0 36707.2958    0  417 18752.5691 36707.2958  95.7%     -   71s
     0     0 36666.9949    0  413 18752.5691 36666.9949  95.5%     -   73s
H    0     0                    19643.821561 36666.6966  86.7%     -   74s
     0     0 36643.1450    0  451 19643.8216 36643.1450  86.5%     -   75s
     0     0 36633.2858    0  417 19643.8216 36633.2858  86.5%     -   75s
     0     0 36631.3732    0  410 19643.8216 36631.3732  86.5%     -   76s
     0     0 36630.4072    0  418 19643.8216 36630.4072  86.5%     -   76s
     0     0 36572.0318    0  411 19643.8216 36572.0318  86.2%     -   78s
H    0     0                    19648.901686 36570.5586  86.1%     -   78s
H    0     0                    19661.599793 36570.5586  86.0%     -   78s
     0     0 36558.7243    0  409 19661.5998 36558.7243  85.9%     -   79s
     0     0 36555.8004    0  406 19661.5998 36555.8004  85.9%     -   79s
     0     0 36554.8162    0  413 19661.5998 36554.8162  85.9%     -   80s
     0     0 36510.1403    0  474 19661.5998 36510.1403  85.7%     -   82s
     0     0 36478.2221    0  431 19661.5998 36478.2221  85.5%     -   84s
     0     0 36475.9076    0  429 19661.5998 36475.9076  85.5%     -   84s
     0     0 36474.8683    0  428 19661.5998 36474.8683  85.5%     -   84s
     0     0 36463.5920    0  437 19661.5998 36463.5920  85.5%     -   85s
     0     0 36461.1071    0  433 19661.5998 36461.1071  85.4%     -   86s
     0     0 36459.8651    0  440 19661.5998 36459.8651  85.4%     -   86s
     0     0 36454.9170    0  433 19661.5998 36454.9170  85.4%     -   87s
     0     0 36453.5985    0  427 19661.5998 36453.5985  85.4%     -   89s
     0     0 36449.9610    0  432 19661.5998 36449.9610  85.4%     -   89s
     0     0 36446.4548    0  420 19661.5998 36446.4548  85.4%     -   90s
     0     0 36445.7067    0  418 19661.5998 36445.7067  85.4%     -   90s
     0     0 36441.5515    0  441 19661.5998 36441.5515  85.3%     -   91s
     0     0 36441.4517    0  441 19661.5998 36441.4517  85.3%     -   91s
H    0     0                    20107.800148 36440.0405  81.2%     -  103s
H    0     2                    20820.151932 36440.0405  75.0%     -  123s
     0     2 36440.0405    0  441 20820.1519 36440.0405  75.0%     -  123s
     1     4 36286.2698    1  418 20820.1519 36440.0405  75.0%  3005  125s
     3     8 36071.1140    2  425 20820.1519 36276.9511  74.2%  3883  130s
    15    32 35558.8065    4  414 20820.1519 35740.7850  71.7%  4348  139s
    31    54 33613.7847    5  380 20820.1519 35558.5719  70.8%  6582  147s
    53    86 34202.1309    6  414 20820.1519 35558.0660  70.8%  6135  154s
    85   189 34090.1946    7  337 20820.1519 35558.0660  70.8%  4957  164s
   190   258 34025.1509    8  341 20820.1519 35558.0660  70.8%  3012  171s
   301   329 33600.5684   10  337 20820.1519 35558.0660  70.8%  2650  177s
   340   366 27997.5743   10  250 20820.1519 35558.0660  70.8%  2643  180s
   430   457 33136.2503   10  346 20820.1519 35558.0660  70.8%  2566  189s
   492   510 29560.5267   17  205 20820.1519 35558.0660  70.8%  2438  195s
   557   574 33279.7929   11  380 20820.1519 35415.9408  70.1%  2372  200s
   629   618 32826.1965   12  384 20820.1519 35415.9408  70.1%  2303  206s
   708   661 30389.0221   13  282 20820.1519 35415.9408  70.1%  2207  212s
   775   701 32330.2820   13  383 20820.1519 35404.3894  70.0%  2172  218s
   836   724 29840.8784   12  304 20820.1519 35292.0998  69.5%  2178  224s
   877   758 31357.0743   13  307 20820.1519 35292.0998  69.5%  2215  229s
   921   788 28894.8145   12  272 20820.1519 35292.0998  69.5%  2232  235s
   969   828 29187.7850   14  297 20820.1519 35292.0998  69.5%  2235  241s
  1023   862 29325.6048   14  333 20820.1519 35292.0998  69.5%  2230  248s
  1069   900 31204.3181   14  376 20820.1519 35292.0998  69.5%  2296  252s
  1115   969 31314.3401   14  309 20820.1519 35292.0998  69.5%  2379  258s
  1188  1030 29218.7686   15  340 20820.1519 35292.0998  69.5%  2348  265s
  1265  1073 28447.5296   15  389 20820.1519 35292.0998  69.5%  2296  271s
  1348  1138 28374.3806   15  269 20820.1519 34793.1736  67.1%  2246  278s
  1438  1245 26881.5723   15  256 20820.1519 34738.8293  66.9%  2214  284s
  1561  1380 29441.2366   15  345 20820.1519 34738.8293  66.9%  2145  291s
  1744  1498 28364.3229   16  340 20820.1519 34738.8293  66.9%  2028  298s
  1910  1571 26145.1565   16  321 20820.1519 34738.8293  66.9%  1955  305s
  2054  1679 28358.6885   17  340 20820.1519 34738.8293  66.9%  1918  313s
  2223  1745 24664.9132   16  401 20820.1519 34738.8293  66.9%  1866  319s
  2365  1844 27443.4405   18  221 20820.1519 34428.5223  65.4%  1860  327s
  2498  1970 26599.7361   18  318 20820.1519 34428.5223  65.4%  1828  334s
H 2625  1969                    20860.249701 34290.1669  64.4%  1793  334s
  2688  2038 26061.5192   20  235 20860.2497 34290.1669  64.4%  1788  343s
  2825  2127 26117.2961   20  225 20860.2497 34228.4581  64.1%  1797  350s
  2986  2213 24442.5393   25  118 20860.2497 34228.4581  64.1%  1790  358s
  3160  2320 23331.8655   29  139 20860.2497 34224.8391  64.1%  1777  365s
  3368  2440 22312.6308   36  138 20860.2497 34224.8391  64.1%  1755  373s
H 3586  2535                    21062.450949 34224.8391  62.5%  1736  381s
H 3648  2535                    21065.573050 34224.8391  62.5%  1737  381s
H 3679  2529                    21117.740294 34224.8391  62.1%  1728  381s
  3756  2625 30003.6671   13  302 21117.7403 34107.9977  61.5%  1720  390s
  3960  2710 28315.6898   16  203 21117.7403 33937.8891  60.7%  1716  400s
  4150  2851 25033.8720   22  188 21117.7403 33937.8891  60.7%  1718  410s
  4368  2852 30135.2217   13  441 21117.7403 33695.7971  59.6%  1712  464s
  4370  2853 22671.7582   51  170 21117.7403 33695.7971  59.6%  1711  476s
  4371  2854 27101.6707   17  395 21117.7403 33695.7971  59.6%  1711  488s
H 4371  2711                    21121.055438 33695.7971  59.5%  1711  493s
  4373  2712 27229.6755   18  389 21121.0554 33695.7971  59.5%  1710  498s
  4374  2713 23854.5241   25  449 21121.0554 33695.7971  59.5%  1710  502s
  4375  2714 28369.2549   16  461 21121.0554 33695.7971  59.5%  1709  506s
  4378  2716 28196.9873   10  443 21121.0554 33695.7971  59.5%  1708  511s
  4380  2717 31603.1715    8  435 21121.0554 33695.7971  59.5%  1708  515s
  4382  2718 28864.5487   19  523 21121.0554 33695.7971  59.5%  1707  522s
  4384  2720 23727.5858   26  429 21121.0554 33695.7971  59.5%  1706  528s
  4386  2721 26988.5266   25  423 21121.0554 33695.7971  59.5%  1705  531s
  4388  2722 22799.4335   39  484 21121.0554 33695.7971  59.5%  1704  536s
  4390  2724 24759.4169   22  485 21121.0554 33695.7971  59.5%  1704  542s
  4392  2725 21159.8951   53  532 21121.0554 33695.7971  59.5%  1703  546s
  4394  2726 30467.0247   13  478 21121.0554 33695.7971  59.5%  1702  552s
  4396  2728 29697.0683   14  538 21121.0554 33695.7971  59.5%  1701  556s
  4397  2728 23772.1122   23  538 21121.0554 33695.7971  59.5%  1701  569s
  4398  2729 22477.1821   13  538 21121.0554 33695.7971  59.5%  1701  587s
  4399  2733 33695.7971   15  468 21121.0554 33695.7971  59.5%  1729  597s
  4401  2736 33695.7971   16  522 21121.0554 33695.7971  59.5%  1730  605s
  4405  2743 33695.7971   17  454 21121.0554 33695.7971  59.5%  1734  612s
  4413  2756 33695.7971   18  458 21121.0554 33695.7971  59.5%  1739  619s
  4429  2780 33695.7971   19  452 21121.0554 33695.7971  59.5%  1778  635s
  4458  2800 32154.4310   20  437 21121.0554 33695.7971  59.5%  1808  643s
  4490  2854 30994.4372   21  444 21121.0554 33695.7971  59.5%  1850  654s
  4559  2860 29812.3334   23  379 21121.0554 33695.7971  59.5%  1901  660s
  4593  2887 28321.0122   23  401 21121.0554 33695.7971  59.5%  1909  667s
  4638  2938 30967.4216   22  449 21121.0554 33695.7971  59.5%  1917  676s
  4709  2981 29376.8680   24  379 21121.0554 33695.7971  59.5%  1927  684s
  4790  3013 26755.3445   24  394 21121.0554 33695.7971  59.5%  1935  693s
  4885  3036 29909.7921   23  420 21121.0554 33695.7971  59.5%  1934  704s
  4977  3069 28775.4239   25  390 21121.0554 33695.7971  59.5%  1939  711s
  5057  3087 27811.1319   26  307 21121.0554 33695.7971  59.5%  1945  724s
  5137  3107 26535.8879   28  277 21121.0554 33695.7971  59.5%  1947  732s
  5228  3112 25259.5348   30  280 21121.0554 33695.7971  59.5%  1943  740s
  5317  3134 24743.8406   32  288 21121.0554 33695.7971  59.5%  1944  747s
  5412  3141 24430.4183   34  259 21121.0554 33695.7971  59.5%  1940  755s
  5521  3146 24388.4221   34  257 21121.0554 33695.7971  59.5%  1934  764s
  5626  3147 21816.0651   36  111 21121.0554 33695.7971  59.5%  1928  772s
  5740  3153     cutoff   38      21121.0554 33695.7971  59.5%  1921  784s
  5860  3166 29212.8726   21  355 21121.0554 33695.7971  59.5%  1918  791s
  5967  3195 28152.7608   23  315 21121.0554 32759.1584  55.1%  1915  799s
  6090  3214 27197.4231   26  273 21121.0554 32443.8036  53.6%  1907  808s
  6202  3233 26501.6385   29  272 21121.0554 32384.3375  53.3%  1909  817s
  6312  3278 25777.7967   32  244 21121.0554 32171.4050  52.3%  1910  828s
  6428  3307 25182.6740   37  238 21121.0554 32171.4050  52.3%  1913  837s
  6562  3302 24267.2519   41  189 21121.0554 32064.3527  51.8%  1916  844s
  6652  3341 23296.1568   44  186 21121.0554 32064.3527  51.8%  1918  854s
  6770  3325 22230.8678   50  179 21121.0554 31656.4904  49.9%  1921  861s
  6809  3335 21446.4036   51  177 21121.0554 31656.4904  49.9%  1925  867s
  6850  3349 21406.2543   52  198 21121.0554 31656.4904  49.9%  1925  877s
  6891  3374 21352.8075   53  163 21121.0554 31371.7655  48.5%  1928  887s
  6960  3408 28281.6550   23  360 21121.0554 31371.7655  48.5%  1929  898s
  7055  3449 23400.8891   28  345 21121.0554 31214.9217  47.8%  1927  909s
  7181  3500     cutoff   30      21121.0554 31214.9217  47.8%  1925  924s
  7341  3501     cutoff   36      21121.0554 31064.2688  47.1%  1921  936s
  7526  3510 26870.6112   23  295 21121.0554 31064.2688  47.1%  1920  948s
  7712  3505 24760.6664   30  207 21121.0554 31064.2688  47.1%  1923  959s
  7842  3532 23312.3538   37  105 21121.0554 31033.7400  46.9%  1926  972s
  8073  3543 28401.7375   23  317 21121.0554 31033.7400  46.9%  1920  984s
  8257  3569 25521.9758   29  171 21121.0554 30355.3025  43.7%  1925  997s
  8498  3486 23251.0360   37  182 21121.0554 30331.9347  43.6%  1921 1010s
  8561  3485 23170.4224   38  118 21121.0554 30310.6717  43.5%  1926 1020s
  8606  3491 22592.4112   39  143 21121.0554 30310.6717  43.5%  1927 1030s
  8655  3506 22458.4148   40  108 21121.0554 30310.6717  43.5%  1929 1040s
  8708  3505 22435.2227   41  104 21121.0554 30310.6717  43.5%  1930 1050s
  8773  3515 22027.7239   42  160 21121.0554 30310.6717  43.5%  1930 1063s
  8886  3523 26048.4775   21  300 21121.0554 30310.6717  43.5%  1924 1076s
  9077  3521 23665.9790   29  206 21121.0554 30310.6717  43.5%  1918 1097s
  9305  3548 21363.7004   48   74 21121.0554 29707.4672  40.7%  1913 1115s
  9510  3594 24408.8061   29  302 21121.0554 29707.4672  40.7%  1920 1130s
  9802  3629 24011.9248   25  300 21121.0554 29657.2766  40.4%  1915 1146s
 10157  3608 26306.6507   25  362 21121.0554 29655.3859  40.4%  1910 1162s
 10536  3563 27163.0604   26  307 21121.0554 29575.2794  40.0%  1910 1181s
 10946  3544 25009.9387   30  231 21121.0554 29245.0449  38.5%  1908 1199s
 11328  3579 25631.5700   22  285 21121.0554 28933.1497  37.0%  1912 1218s
 11757  3620 22260.4840   38   98 21121.0554 28892.1390  36.8%  1910 1237s
 12184  3667 22286.5433   31  205 21121.0554 28611.8497  35.5%  1912 1258s
 12667  3718 25897.4029   23  308 21121.0554 28611.8497  35.5%  1909 1279s
 13133  3821 21669.9919   38  178 21121.0554 28494.6949  34.9%  1908 1303s
 13598  3954 21832.8188   33  237 21121.0554 28082.9544  33.0%  1914 1325s
 14080  4079 24236.5126   34  224 21121.0554 27979.2010  32.5%  1920 1348s
 14687  4193 21424.0408   29  155 21121.0554 27843.4587  31.8%  1913 1370s
 15312  4319 25671.8154   31  222 21121.0554 27753.9960  31.4%  1905 1393s
 15973  4474 24336.1630   28  332 21121.0554 27608.2817  30.7%  1896 1418s
 16619  4579 21896.0913   29  304 21121.0554 27384.8550  29.7%  1892 1445s
 17240  4711     cutoff   38      21121.0554 27290.4782  29.2%  1893 1472s
 17971  4829     cutoff   33      21121.0554 27103.0829  28.3%  1886 1499s
 18661  4834     cutoff   28      21121.0554 27027.5520  28.0%  1885 1521s
 18746  4906     cutoff   29      21121.0554 27027.5520  28.0%  1885 1547s
 19326  5001 22259.9849   35  163 21121.0554 26963.8009  27.7%  1882 1578s
 20172  5149 22448.1697   33  305 21121.0554 26671.2977  26.3%  1873 1609s
 20998  5238     cutoff   33      21121.0554 26452.6068  25.2%  1868 1642s
 21863  5314 25049.8510   26  315 21121.0554 26314.6015  24.6%  1864 1676s
 22807  5394 22210.2166   37  213 21121.0554 26153.0680  23.8%  1855 1709s
 23743  5402 24392.1197   31  332 21121.0554 25956.4866  22.9%  1850 1743s
 24816  5435 22329.1715   24  323 21121.0554 25734.2840  21.8%  1837 1779s
 25913  5396 23104.5849   34  336 21121.0554 25530.1322  20.9%  1824 1814s
 26998  5347 21166.4179   42  137 21121.0554 25329.2894  19.9%  1812 1851s
 28231  5265     cutoff   33      21121.0554 25108.6575  18.9%  1797 1888s
 29543  5099 22015.7566   30  222 21121.0554 24843.2442  17.6%  1778 1928s
 31020  4800     cutoff   33      21121.0554 24605.0771  16.5%  1756 1967s
 32546  4373 21416.4899   31  250 21121.0554 24300.7066  15.1%  1732 2007s
 34262  3714 22660.1101   38  197 21121.0554 24066.5101  13.9%  1703 2045s
 36186  2876     cutoff   34      21121.0554 23622.9106  11.8%  1666 2083s
 38370  1436 21262.3761   32  208 21121.0554 23346.9846  10.5%  1621 2120s
 41120     0     cutoff   38      21121.0554 22848.3583  8.18%  1555 2143s

Cutting planes:
  Learned: 1
  MIR: 585
  Mixing: 1
  Flow cover: 1755
  RLT: 33
  Relax-and-lift: 77

Explored 43241 nodes (64948016 simplex iterations) in 2143.63 seconds (7104.78 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21121.1 21121.1 21117.7 ... 19648.9

Optimal solution found (tolerance 1.00e-04)
Best objective 2.112105543834e+04, best bound 2.112105543834e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2143.66s
  Master Objective (UB) = 21121.06, θ = 166828.09
  Upper Bound (UB) = 21121.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166828.09
  [DEBUG]   ✓ Scenario 0: θ = 166828.09 ≤ Q = 183679.02 (slack: 16850.92)
  [DEBUG]   ✓ Scenario 1: θ = 166828.09 ≤ Q = 166828.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166828.09 ≤ Q = 180876.32 (slack: 14048.23)
  [DEBUG]   ✓ Scenario 3: θ = 166828.09 ≤ Q = 180911.37 (slack: 14083.27)
  [DEBUG]   ✓ Scenario 4: θ = 166828.09 ≤ Q = 171746.05 (slack: 4917.96)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x19013999
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe6fec667
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.338602e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6760709.2747
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.486249e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148624.86    0  125 6760709.27 -148624.86   102%     -    0s
H    0     0                    -111240.5194 -148624.86  33.6%     -    0s
H    0     0                    -112397.4703 -148624.86  32.2%     -    0s
H    0     0                    -112859.4028 -124111.82  10.0%     -    0s
H    0     0                    -120438.4196 -124111.82  3.05%     -    0s
     0     0 -124111.82    0   53 -120438.42 -124111.82  3.05%     -    0s
H    0     0                    -124035.7309 -124097.94  0.05%     -    0s
     0     0 -124094.20    0    2 -124035.73 -124094.20  0.05%     -    0s
     0     0 -124094.20    0    2 -124035.73 -124094.20  0.05%     -    0s
H    0     0                    -124043.4434 -124094.20  0.04%     -    0s
H    0     0                    -124047.9172 -124094.20  0.04%     -    0s
     0     0 -124094.20    0   36 -124047.92 -124094.20  0.04%     -    0s
     0     0 -124094.20    0   29 -124047.92 -124094.20  0.04%     -    0s
H    0     0                    -124074.5667 -124094.20  0.02%     -    0s
     0     0 -124093.37    0    2 -124074.57 -124093.37  0.02%     -    0s
H    0     0                    -124083.2962 -124093.37  0.01%     -    0s

Explored 1 nodes (581 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -124083 -124079 -124075 ... 6.76071e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.240832962429e+05, best bound -1.240933729232e+05, gap 0.0081%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 156065.08
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124083.30
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -124083.30 = 156065.08
  [DEBUG]   Current θ from Master = 166828.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10763.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10358.05
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 1122.2352, Absolute Gap = 1122.2352, Relative Gap = 0.053133
  Not converged yet (gap = 1122.24 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0xde44dedd
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40682 rows and 16522 columns
Presolve time: 0.86s
Presolved: 52441 rows, 23178 columns, 325769 nonzeros
Variable types: 20919 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -211323.9797

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52441 rows, 23178 columns, 325769 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36202   -8.9614809e+03   0.000000e+00   1.107905e+07      5s
   48566    1.8311789e+04   0.000000e+00   4.790300e+08     10s
   59417    2.9118696e+04   0.000000e+00   9.965811e+06     15s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.893580e+04, 36404 iterations, 17.40 seconds (33.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48935.7985    0  170 -211323.98 48935.7985   123%     -   18s
H    0     0                    -198441.2329 48935.7985   125%     -   18s
H    0     0                    -167385.7678 48935.7985   129%     -   18s
H    0     0                    -143033.8191 48935.7985   134%     -   18s
H    0     0                    -128735.7521 48935.7985   138%     -   18s
H    0     0                    -124823.8116 48935.7985   139%     -   18s
H    0     0                    -123142.2029 48935.7985   140%     -   18s
H    0     0                    -53399.49381 48935.7985   192%     -   18s
H    0     0                    -53289.03764 48935.7985   192%     -   18s
H    0     0                    -28784.13573 48935.7985   270%     -   18s
H    0     0                    10229.624505 48935.7985   378%     -   18s
H    0     0                    11487.859780 48935.7985   326%     -   19s
H    0     0                    11532.765745 44918.5132   289%     -   27s
H    0     0                    11648.838523 44918.5132   286%     -   27s
H    0     0                    11724.519801 44918.5132   283%     -   27s
     0     0 44159.3926    0  280 11724.5198 44159.3926   277%     -   27s
H    0     0                    12084.331464 44159.3926   265%     -   27s
H    0     0                    12245.659495 44159.3926   261%     -   27s
     0     0 43669.8899    0  285 12245.6595 43669.8899   257%     -   30s
     0     0 43595.7145    0  281 12245.6595 43595.7145   256%     -   30s
     0     0 43580.4787    0  278 12245.6595 43580.4787   256%     -   32s
     0     0 43580.4787    0  277 12245.6595 43580.4787   256%     -   32s
     0     0 43580.4787    0  277 12245.6595 43580.4787   256%     -   33s
     0     0 40827.2763    0  336 12245.6595 40827.2763   233%     -   41s
H    0     0                    17330.529651 40826.6519   136%     -   41s
     0     0 39766.6962    0  352 17330.5297 39766.6962   129%     -   46s
     0     0 39589.6811    0  355 17330.5297 39589.6811   128%     -   49s
     0     0 39488.2087    0  354 17330.5297 39488.2087   128%     -   51s
     0     0 39457.7742    0  359 17330.5297 39457.7742   128%     -   52s
     0     0 39317.8617    0  355 17330.5297 39317.8617   127%     -   54s
     0     0 39309.7424    0  357 17330.5297 39309.7424   127%     -   56s
     0     0 39303.7173    0  357 17330.5297 39303.7173   127%     -   56s
     0     0 39297.9682    0  358 17330.5297 39297.9682   127%     -   56s
     0     0 39296.8785    0  358 17330.5297 39296.8785   127%     -   57s
     0     0 39296.8659    0  362 17330.5297 39296.8659   127%     -   57s
     0     0 38237.6528    0  403 17330.5297 38237.6528   121%     -   68s
H    0     0                    17400.800757 38237.5859   120%     -   68s
H    0     0                    17836.167713 38237.5859   114%     -   68s
     0     0 38071.6912    0  311 17836.1677 38071.6912   113%     -   71s
     0     0 37943.3189    0  348 17836.1677 37943.3189   113%     -   73s
     0     0 37842.8906    0  364 17836.1677 37842.8906   112%     -   76s
     0     0 37784.6706    0  364 17836.1677 37784.6706   112%     -   78s
     0     0 37767.2886    0  375 17836.1677 37767.2886   112%     -   78s
     0     0 37744.7552    0  411 17836.1677 37744.7552   112%     -   80s
     0     0 37734.5676    0  411 17836.1677 37734.5676   112%     -   81s
     0     0 37724.2683    0  410 17836.1677 37724.2683   112%     -   81s
     0     0 37722.3678    0  413 17836.1677 37722.3678   111%     -   82s
     0     0 37716.5129    0  412 17836.1677 37716.5129   111%     -   82s
     0     0 37713.8408    0  414 17836.1677 37713.8408   111%     -   83s
     0     0 37708.1242    0  376 17836.1677 37708.1242   111%     -   83s
     0     0 37707.1554    0  411 17836.1677 37707.1554   111%     -   83s
     0     0 37020.0912    0  433 17836.1677 37020.0912   108%     -   91s
H    0     0                    18008.897526 37020.0723   106%     -   91s
     0     0 36856.7553    0  402 18008.8975 36856.7553   105%     -   94s
     0     0 36796.7683    0  455 18008.8975 36796.7683   104%     -   96s
     0     0 36761.1229    0  462 18008.8975 36761.1229   104%     -   99s
     0     0 36750.2295    0  459 18008.8975 36750.2295   104%     -  100s
     0     0 36737.0399    0  458 18008.8975 36737.0399   104%     -  101s
     0     0 36730.7920    0  456 18008.8975 36730.7920   104%     -  101s
     0     0 36725.3597    0  463 18008.8975 36725.3597   104%     -  102s
     0     0 36722.3515    0  463 18008.8975 36722.3515   104%     -  102s
     0     0 36720.1806    0  463 18008.8975 36720.1806   104%     -  102s
     0     0 36717.8583    0  459 18008.8975 36717.8583   104%     -  103s
     0     0 36717.4969    0  462 18008.8975 36717.4969   104%     -  103s
     0     0 36672.9358    0  407 18008.8975 36672.9358   104%     -  105s
H    0     0                    18028.827262 36672.2477   103%     -  105s
H    0     0                    18076.786459 36672.2477   103%     -  105s
H    0     0                    18142.234341 36672.2477   102%     -  105s
H    0     0                    18185.289114 36672.2477   102%     -  105s
     0     0 36645.2003    0  415 18185.2891 36645.2003   102%     -  107s
     0     0 36639.6602    0  408 18185.2891 36639.6602   101%     -  108s
     0     0 36636.6170    0  408 18185.2891 36636.6170   101%     -  108s
     0     0 36636.4275    0  408 18185.2891 36636.4275   101%     -  108s
     0     0 36609.3544    0  416 18185.2891 36609.3544   101%     -  110s
H    0     0                    18247.149042 36608.9468   101%     -  111s
H    0     0                    18796.834427 36595.4252  94.7%     -  112s
     0     0 36595.4252    0  424 18796.8344 36595.4252  94.7%     -  112s
     0     0 36587.4018    0  424 18796.8344 36587.4018  94.6%     -  112s
     0     0 36580.1574    0  428 18796.8344 36580.1574  94.6%     -  113s
     0     0 36578.9012    0  427 18796.8344 36578.9012  94.6%     -  113s
     0     0 36546.5098    0  409 18796.8344 36546.5098  94.4%     -  115s
     0     0 36535.2985    0  415 18796.8344 36535.2985  94.4%     -  116s
     0     0 36520.5780    0  420 18796.8344 36520.5780  94.3%     -  116s
     0     0 36519.3949    0  427 18796.8344 36519.3949  94.3%     -  116s
     0     0 36506.8402    0  422 18796.8344 36506.8402  94.2%     -  118s
H    0     0                    20376.439136 36506.8156  79.2%     -  119s
     0     0 36503.0045    0  423 20376.4391 36503.0045  79.1%     -  119s
     0     0 36500.9808    0  428 20376.4391 36500.9808  79.1%     -  120s
     0     0 36500.0017    0  427 20376.4391 36500.0017  79.1%     -  120s
     0     0 36493.0520    0  427 20376.4391 36493.0520  79.1%     -  121s
     0     0 36489.7044    0  426 20376.4391 36489.7044  79.1%     -  121s
     0     0 36489.3820    0  426 20376.4391 36489.3820  79.1%     -  122s
     0     0 36488.8157    0  429 20376.4391 36488.8157  79.1%     -  123s
     0     0 36488.6713    0  429 20376.4391 36488.6713  79.1%     -  123s
     0     0 36488.1006    0  432 20376.4391 36488.1006  79.1%     -  124s
     0     0 36487.5279    0  432 20376.4391 36487.5279  79.1%     -  125s
H    0     0                    20588.952927 36487.5279  77.2%     -  139s
H    0     0                    20727.778097 36487.5279  76.0%     -  139s
     0     2 36487.5279    0  432 20727.7781 36487.5279  76.0%     -  140s
     3     8 36411.4693    2  422 20727.7781 36437.0458  75.8%  3017  148s
     7    16 36253.5612    3  435 20727.7781 36411.4451  75.7%  4728  154s
    15    32 35980.3536    4  430 20727.7781 36359.4684  75.4%  5705  162s
    31    49 32411.7183    5  313 20727.7781 35980.2341  73.6%  8760  173s
    48    81 33706.1143    6  382 20727.7781 35980.2341  73.6%  7457  189s
    80   230 33486.8646    7  367 20727.7781 35980.2341  73.6%  6293  201s
   229   275 32529.4591   10  348 20727.7781 35980.2341  73.6%  3472  208s
   274   372 32947.6258   10  342 20727.7781 35980.2341  73.6%  3198  212s
   379   442 32805.7906   12  307 20727.7781 35980.2341  73.6%  2656  217s
   449   507 32428.3047   11  339 20727.7781 35980.2341  73.6%  2461  224s
   542   533 32598.1796   13  291 20727.7781 35980.2341  73.6%  2266  230s
   574   549 32047.6358   13  350 20727.7781 35980.2341  73.6%  2256  236s
   624   565 30493.8402   13  439 20727.7781 35980.2341  73.6%  2246  243s
   668   590 31000.7699   14  332 20727.7781 35980.2341  73.6%  2259  249s
   705   617 31454.4496   14  271 20727.7781 35980.2341  73.6%  2275  255s
   740   642 30739.8669   14  328 20727.7781 35980.2341  73.6%  2288  262s
   778   672 30779.3607   14  442 20727.7781 35980.2341  73.6%  2285  269s
   828   702 31001.3442   14  427 20727.7781 35980.2341  73.6%  2259  272s
   870   724 30170.1204   15  318 20727.7781 35980.2341  73.6%  2229  279s
   914   748 30024.3809   15  259 20727.7781 35980.2341  73.6%  2223  285s
   952   779 29422.9453   15  269 20727.7781 35598.9477  71.7%  2212  293s
   993   808 29813.5882   16  307 20727.7781 35598.2902  71.7%  2220  300s
  1043   852 29706.2581   16  311 20727.7781 35598.2902  71.7%  2220  305s
  1089   901 29372.2425   17  299 20727.7781 35598.2902  71.7%  2213  311s
  1156   954 29556.6802   17  310 20727.7781 35598.2902  71.7%  2171  317s
  1237   997 29017.7342   18  307 20727.7781 35267.8417  70.1%  2127  323s
  1314  1043 29256.9789   18  314 20727.7781 35267.8417  70.1%  2105  331s
  1399  1083 26514.9079   18  173 20727.7781 34871.8501  68.2%  2082  340s
  1469  1131 26657.6087   18  232 20727.7781 34871.8501  68.2%  2082  348s
  1535  1168 24985.7254   19  303 20727.7781 34871.8501  68.2%  2092  356s
  1604  1206 25747.5645   19  307 20727.7781 34871.8501  68.2%  2118  364s
  1690  1264 24656.2150   19  243 20727.7781 34871.8501  68.2%  2132  373s
  1770  1342 25022.6155   19  248 20727.7781 34871.8501  68.2%  2157  381s
  1858  1410 23318.1009   19  194 20727.7781 34871.8501  68.2%  2167  390s
  1970  1457 23760.7111   19  179 20727.7781 34871.8501  68.2%  2157  399s
  2061  1531     cutoff   19      20727.7781 34871.8501  68.2%  2166  408s
  2167  1616 21067.8467   20  223 20727.7781 34871.8501  68.2%  2175  418s
  2291  1712 22813.8892   21  206 20727.7781 34871.8501  68.2%  2162  427s
  2447  1866 22941.6034   15  240 20727.7781 34871.8501  68.2%  2144  438s
  2635  2032 22481.9174   17  163 20727.7781 34871.8501  68.2%  2095  448s
  2841  2187     cutoff   25      20727.7781 34033.9595  64.2%  2049  459s
  3074  2316 28791.4899   11  447 20727.7781 33963.9469  63.9%  2000  469s
  3293  2478 27353.6868   13  439 20727.7781 33878.1752  63.4%  1969  479s
  3523  2647 26165.8510   15  409 20727.7781 33878.1752  63.4%  1945  491s
  3782  2648 23859.9257   21  432 20727.7781 33663.5581  62.4%  1908  520s
  3784  2649 25555.9080   39  170 20727.7781 33663.5581  62.4%  1907  540s
  3785  2650 24273.1784   22  344 20727.7781 33663.5581  62.4%  1907  557s
  3786  2651 31291.2895   12  463 20727.7781 33663.5581  62.4%  1906  568s
  3787  2651 27772.4423   13  347 20727.7781 33663.5581  62.4%  1906  574s
  3788  2652 28214.4869   17  490 20727.7781 33663.5581  62.4%  1905  581s
  3789  2653 33011.1892    8  426 20727.7781 33663.5581  62.4%  1905  586s
  3790  2653 26141.8729   20  463 20727.7781 33663.5581  62.4%  1904  591s
  3793  2655 31952.3913   11  467 20727.7781 33663.5581  62.4%  1903  598s
  3795  2657 23983.7674   54  455 20727.7781 33663.5581  62.4%  1902  604s
  3796  2657 25569.8743    9  423 20727.7781 33663.5581  62.4%  1901  607s
  3799  2659 21598.7687   28  512 20727.7781 33663.5581  62.4%  1900  614s
  3800  2660 26580.9032   11  471 20727.7781 33663.5581  62.4%  1899  616s
  3802  2661 30941.4428   21  536 20727.7781 33663.5581  62.4%  1898  625s
  3805  2663 22341.5471   26  492 20727.7781 33663.5581  62.4%  1897  633s
  3806  2664 23315.6552   22  434 20727.7781 33663.5581  62.4%  1896  635s
  3807  2665 21768.1892   53  431 20727.7781 33663.5581  62.4%  1896  641s
  3809  2666 23129.2814   23  435 20727.7781 33663.5581  62.4%  1895  645s
  3810  2667 24295.1306   36  437 20727.7781 33663.5581  62.4%  1894  650s
  3812  2668 30796.6423   15  504 20727.7781 33663.5581  62.4%  1893  656s
  3813  2669 25656.9766   46  498 20727.7781 33663.5581  62.4%  1893  662s
  3815  2670 26934.9103   18  538 20727.7781 33663.5581  62.4%  1892  669s
  3816  2671 22435.0621   48  564 20727.7781 33663.5581  62.4%  1891  671s
  3817  2671 23456.1672   19  563 20727.7781 33663.5581  62.4%  1891  675s
  3818  2672 32946.6440   12  563 20727.7781 33663.5581  62.4%  1890  697s
H 3818  2537                    20766.936909 33663.5581  62.1%  1890  712s
  3820  2541 33663.5581   15  503 20766.9369 33663.5581  62.1%  1943  738s
  3822  2545 33663.5581   16  549 20766.9369 33663.5581  62.1%  1945  751s
  3826  2551 33663.5581   17  502 20766.9369 33663.5581  62.1%  1950  764s
  3834  2565 33663.5581   18  546 20766.9369 33663.5581  62.1%  1966  780s
  3850  2576 29250.1988   19  256 20766.9369 33663.5581  62.1%  2012  800s
  3867  2603 32826.1776   20  437 20766.9369 33663.5581  62.1%  2047  814s
  3899  2694 30302.6802   21  331 20766.9369 33663.5581  62.1%  2102  828s
  4027  2699 29732.5887   23  296 20766.9369 33663.5581  62.1%  2197  841s
H 4040  2568                    20981.926987 33663.5581  60.4%  2211  841s
  4112  2592 26711.6264   22  382 20981.9270 33663.5581  60.4%  2244  853s
  4193  2592 29110.3875   24  305 20981.9270 33663.5581  60.4%  2289  864s
  4249  2608 28571.2226   24  302 20981.9270 33663.5581  60.4%  2329  875s
  4334  2595 28532.1442   25  313 20981.9270 33663.5581  60.4%  2351  883s
  4385  2604 28477.6528   26  310 20981.9270 33663.5581  60.4%  2366  893s
  4438  2611 27688.9738   27  289 20981.9270 33663.5581  60.4%  2379  901s
  4498  2624 27551.3084   28  230 20981.9270 33663.5581  60.4%  2398  909s
  4562  2632 26790.9324   29  277 20981.9270 33663.5581  60.4%  2411  918s
  4628  2645 26398.6118   30  271 20981.9270 33663.5581  60.4%  2421  925s
  4695  2651 26388.2254   31  259 20981.9270 33663.5581  60.4%  2448  935s
  4760  2674 25737.7492   32  216 20981.9270 32825.4546  56.4%  2475  944s
  4833  2667 25661.3228   33  160 20981.9270 32824.8852  56.4%  2495  953s
  4910  2675     cutoff   34      20981.9270 32824.8852  56.4%  2496  961s
  4999  2670     cutoff   33      20981.9270 32824.8852  56.4%  2513  975s
  5078  2665 23189.9386   35  233 20981.9270 32426.0490  54.5%  2542  985s
  5143  2685 22587.5552   37  191 20981.9270 32091.6452  52.9%  2572  995s
  5208  2711 28987.6509   22  398 20981.9270 32091.6452  52.9%  2595 1005s
  5295  2731 27816.4453   25  316 20981.9270 31550.7106  50.4%  2605 1015s
  5390  2718 26993.8256   27  243 20981.9270 31550.7106  50.4%  2632 1025s
  5498  2724 26190.4429   29  301 20981.9270 31550.7106  50.4%  2652 1035s
  5582  2730 25472.5046   32  222 20981.9270 31550.7106  50.4%  2674 1045s
  5703  2739 22538.3860   39  131 20981.9270 31550.7106  50.4%  2695 1057s
  5819  2760 24229.0344   22  176 20981.9270 31142.6663  48.4%  2709 1068s
  5955  2729 21218.5087   28   53 20981.9270 30798.6693  46.8%  2713 1076s
  6000  2738 21218.4870   29   53 20981.9270 30677.2901  46.2%  2714 1088s
  6050  2747 27968.2287   22  470 20981.9270 30271.8739  44.3%  2722 1099s
  6108  2750 21516.1731   25  164 20981.9270 30271.8739  44.3%  2735 1109s
  6192  2745 26624.6969   23  363 20981.9270 30249.1062  44.2%  2742 1121s
  6295  2728 25132.7087   26  314 20981.9270 30249.1062  44.2%  2750 1135s
  6425  2747 24045.0929   29  280 20981.9270 29874.6744  42.4%  2769 1148s
  6530  2763 22331.8091   34  224 20981.9270 29791.0871  42.0%  2802 1162s
  6696  2768 23546.2917   24  454 20981.9270 29791.0871  42.0%  2814 1176s
  6859  2785 infeasible   25      20981.9270 29592.5345  41.0%  2836 1190s
  7044  2771 21779.8626   27  263 20981.9270 29451.8685  40.4%  2868 1205s
  7210  2774     cutoff   29      20981.9270 29417.6169  40.2%  2878 1220s
  7441  2773 25664.1883   24  269 20981.9270 29381.2020  40.0%  2884 1238s
  7655  2746 25031.7909   27  400 20981.9270 29381.2020  40.0%  2914 1254s
  7884  2739 23859.5156   30  343 20981.9270 29381.2020  40.0%  2940 1272s
  8124  2682     cutoff   35      20981.9270 29028.7378  38.4%  2960 1284s
  8165  2706     cutoff   36      20981.9270 28937.0549  37.9%  2972 1298s
  8268  2735 25498.6347   27  237 20981.9270 28821.2532  37.4%  2988 1315s
  8505  2725 23614.9499   30  253 20981.9270 28821.2532  37.4%  2999 1333s
  8803  2656 25595.0026   25  195 20981.9270 28668.8290  36.6%  3017 1352s
  9190  2628 25174.1514   26  370 20981.9270 28504.8790  35.9%  3017 1371s
  9506  2556 22022.1098   32  275 20981.9270 28318.7828  35.0%  3040 1392s
  9850  2487     cutoff   25      20981.9270 28099.5268  33.9%  3062 1412s
 10216  2434 23984.1929   32  224 20981.9270 28099.5268  33.9%  3086 1434s
 10624  2317 22945.4434   27  279 20981.9270 27796.6529  32.5%  3100 1455s
 11009  2238 23031.5863   30  282 20981.9270 27643.4673  31.7%  3120 1479s
 11456  2249 infeasible   27      20981.9270 27483.5065  31.0%  3132 1502s
 11924  2299 22573.8373   29  310 20981.9270 27346.0460  30.3%  3147 1523s
 12332  2323 23772.4470   31  163 20981.9270 27195.7696  29.6%  3176 1547s
 12812  2341     cutoff   33      20981.9270 26892.0732  28.2%  3193 1572s
 13368  2345 22139.5347   30  194 20981.9270 26730.4627  27.4%  3194 1595s
 13921  2335 21619.7549   29  137 20981.9270 26512.3156  26.4%  3201 1620s
 14486  2273 21804.0334   32  340 20981.9270 26278.9712  25.2%  3211 1647s
 15141  2272 22009.5267   22  399 20981.9270 26083.5857  24.3%  3209 1675s
 15725  2192     cutoff   30      20981.9270 25809.7697  23.0%  3220 1704s
 16451  2059 23427.8332   31  131 20981.9270 25578.0047  21.9%  3215 1735s
 17232  1901 infeasible   30      20981.9270 25243.2607  20.3%  3197 1766s
 18027  1887     cutoff   29      20981.9270 25112.3813  19.7%  3185 1794s
 18153  1656     cutoff   29      20981.9270 24807.1521  18.2%  3190 1825s
 18866  1353 22379.9471   26  263 20981.9270 24544.8066  17.0%  3161 1857s
 19907   758     cutoff   33      20981.9270 24092.7373  14.8%  3124 1890s
 21182    20     cutoff   28      20981.9270 23452.3957  11.8%  3055 1917s
 22209     0 infeasible   26      20981.9270 22249.0973  6.04%  2977 1920s

Cutting planes:
  Gomory: 1
  MIR: 747
  Flow cover: 1826
  RLT: 24
  Relax-and-lift: 131

Explored 22237 nodes (66312512 simplex iterations) in 1920.97 seconds (6313.44 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20981.9 20766.9 20727.8 ... 18076.8

Optimal solution found (tolerance 1.00e-04)
Best objective 2.098192698715e+04, best bound 2.098192698715e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1920.98s
  Master Objective (UB) = 20981.93, θ = 166757.89
  Upper Bound (UB) = 20981.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166757.89
  [DEBUG]   ✓ Scenario 0: θ = 166757.89 ≤ Q = 166757.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166757.89 ≤ Q = 166757.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166757.89 ≤ Q = 166757.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166757.89 ≤ Q = 166757.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166757.89 ≤ Q = 166757.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166757.89 ≤ Q = 166757.89 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4402f7e2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4402f7e2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.337193e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6776439.3726
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.455246e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145524.63    0  123 6776439.37 -145524.63   102%     -    0s
H    0     0                    -109969.2541 -145524.63  32.3%     -    0s
H    0     0                    -111227.0241 -145524.63  30.8%     -    0s
     0     0 -126496.01    0   52 -111227.02 -126496.01  13.7%     -    0s
H    0     0                    -125199.1807 -126413.53  0.97%     -    0s
     0     0 -126025.77    0   34 -125199.18 -126025.77  0.66%     -    0s
     0     0 -126019.18    0   44 -125199.18 -126019.18  0.65%     -    0s
H    0     0                    -125306.3265 -125983.75  0.54%     -    0s
H    0     0                    -125634.0131 -125983.75  0.28%     -    0s
     0     0 -125979.59    0   30 -125634.01 -125979.59  0.28%     -    0s
     0     0 -125947.81    0   19 -125634.01 -125947.81  0.25%     -    0s
     0     0 -125941.58    0   18 -125634.01 -125941.58  0.24%     -    0s
     0     0 -125888.07    0   25 -125634.01 -125888.07  0.20%     -    0s
     0     0 -125880.82    0   22 -125634.01 -125880.82  0.20%     -    0s
     0     0 -125880.34    0   22 -125634.01 -125880.34  0.20%     -    0s
     0     0 -125771.64    0    9 -125634.01 -125771.64  0.11%     -    0s
     0     0 -125771.64    0   16 -125634.01 -125771.64  0.11%     -    0s
H    0     0                    -125662.3016 -125771.64  0.09%     -    0s
     0     0 -125705.47    0    3 -125662.30 -125705.47  0.03%     -    0s
H    0     0                    -125689.6495 -125703.41  0.01%     -    0s
     0     0 -125703.40    0    2 -125689.65 -125703.40  0.01%     -    0s
H    0     0                    -125695.4150 -125703.40  0.01%     -    0s

Explored 1 nodes (664 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -125695 -125690 -125662 ... 6.77644e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.256954150066e+05, best bound -1.257033983829e+05, gap 0.0064%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 154452.96
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125695.42
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -125695.42 = 154452.96
  [DEBUG]   Current θ from Master = 166757.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12304.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8677.00
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 983.1068, Absolute Gap = 983.1068, Relative Gap = 0.046855
  Not converged yet (gap = 983.11 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308199 nonzeros
Model fingerprint: 0xb1cb0417
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47449 rows and 19269 columns
Presolve time: 0.99s
Presolved: 60964 rows, 26671 columns, 379184 nonzeros
Variable types: 24412 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -211323.9797

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60964 rows, 26671 columns, 379184 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31178   -4.6025176e+03   0.000000e+00   5.614435e+07      5s
   45440    2.1891518e+04   0.000000e+00   7.012045e+06     10s
   54263    2.4315748e+04   0.000000e+00   6.769977e+07     15s
   63558    3.4685086e+04   0.000000e+00   6.854101e+06     20s
   73258    3.9393545e+04   0.000000e+00   1.807943e+07     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.893580e+04, 43601 iterations, 27.68 seconds (53.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48935.7985    0  170 -211323.98 48935.7985   123%     -   29s
H    0     0                    -199130.4848 48935.7985   125%     -   29s
H    0     0                    -128967.1346 48935.7985   138%     -   29s
H    0     0                    -128211.1708 48935.7985   138%     -   29s
H    0     0                    -126580.3143 48935.7985   139%     -   29s
H    0     0                    -125146.7788 48935.7985   139%     -   29s
H    0     0                    -124263.3395 48935.7985   139%     -   29s
H    0     0                    -53399.49381 48935.7985   192%     -   29s
H    0     0                    -53289.03764 48935.7985   192%     -   29s
H    0     0                    -24930.63392 48935.7985   296%     -   29s
H    0     0                    5759.8292151 48935.7985   750%     -   29s
H    0     0                    11487.859780 48935.7985   326%     -   29s
H    0     0                    11631.037382 48931.5378   321%     -   30s
H    0     0                    11724.519801 44049.1073   276%     -   40s
     0     0 44049.1073    0  278 11724.5198 44049.1073   276%     -   40s
     0     0 43395.7942    0  285 11724.5198 43395.7942   270%     -   45s
     0     0 43046.0514    0  288 11724.5198 43046.0514   267%     -   46s
     0     0 43024.9146    0  302 11724.5198 43024.9146   267%     -   51s
     0     0 43024.9146    0  294 11724.5198 43024.9146   267%     -   52s
     0     0 43024.9146    0  294 11724.5198 43024.9146   267%     -   52s
     0     0 43024.9146    0  294 11724.5198 43024.9146   267%     -   52s
     0     0 40445.2258    0  349 11724.5198 40445.2258   245%     -   70s
     0     0 39820.1133    0  366 11724.5198 39820.1133   240%     -   75s
     0     0 39701.6754    0  366 11724.5198 39701.6754   239%     -   78s
     0     0 39668.2372    0  372 11724.5198 39668.2372   238%     -   79s
     0     0 39651.1203    0  378 11724.5198 39651.1203   238%     -   80s
     0     0 39640.1481    0  381 11724.5198 39640.1481   238%     -   81s
     0     0 39639.4102    0  379 11724.5198 39639.4102   238%     -   81s
     0     0 38098.6524    0  381 11724.5198 38098.6524   225%     -   94s
H    0     0                    20046.509022 37737.4999  88.2%     -  101s
H    0     0                    20207.865525 37737.4999  86.7%     -  101s
H    0     0                    20563.809196 37737.4999  83.5%     -  101s
H    0     0                    20766.936909 37737.4999  81.7%     -  101s
     0     0 37737.4999    0  438 20766.9369 37737.4999  81.7%     -  101s
     0     0 37652.4315    0  434 20766.9369 37652.4315  81.3%     -  104s
     0     0 37590.7930    0  485 20766.9369 37590.7930  81.0%     -  108s
     0     0 37556.6094    0  448 20766.9369 37556.6094  80.8%     -  110s
     0     0 37538.4737    0  449 20766.9369 37538.4737  80.8%     -  112s
     0     0 37524.4440    0  490 20766.9369 37524.4440  80.7%     -  113s
     0     0 37511.5392    0  447 20766.9369 37511.5392  80.6%     -  114s
     0     0 37509.1490    0  495 20766.9369 37509.1490  80.6%     -  114s
     0     0 37507.1206    0  448 20766.9369 37507.1206  80.6%     -  115s
     0     0 37505.5715    0  453 20766.9369 37505.5715  80.6%     -  115s
     0     0 37505.3266    0  452 20766.9369 37505.3266  80.6%     -  115s
     0     0 37025.4016    0  413 20766.9369 37025.4016  78.3%     -  124s
     0     0 36910.0723    0  418 20766.9369 36910.0723  77.7%     -  128s
     0     0 36862.7788    0  420 20766.9369 36862.7788  77.5%     -  131s
     0     0 36850.2087    0  421 20766.9369 36850.2087  77.4%     -  132s
     0     0 36846.7969    0  415 20766.9369 36846.7969  77.4%     -  133s
     0     0 36844.4795    0  417 20766.9369 36844.4795  77.4%     -  133s
     0     0 36841.1043    0  415 20766.9369 36841.1043  77.4%     -  134s
     0     0 36840.5488    0  419 20766.9369 36840.5488  77.4%     -  134s
     0     0 36771.0611    0  418 20766.9369 36771.0611  77.1%     -  138s
     0     0 36755.3859    0  423 20766.9369 36755.3859  77.0%     -  139s
     0     0 36743.3169    0  426 20766.9369 36743.3169  76.9%     -  140s
     0     0 36735.5729    0  426 20766.9369 36735.5729  76.9%     -  141s
     0     0 36731.0185    0  426 20766.9369 36731.0185  76.9%     -  141s
     0     0 36728.4825    0  426 20766.9369 36728.4825  76.9%     -  141s
     0     0 36727.6737    0  474 20766.9369 36727.6737  76.9%     -  142s
     0     0 36707.6802    0  422 20766.9369 36707.6802  76.8%     -  144s
     0     0 36696.9657    0  419 20766.9369 36696.9657  76.7%     -  148s
     0     0 36689.1140    0  423 20766.9369 36689.1140  76.7%     -  149s
     0     0 36683.8244    0  426 20766.9369 36683.8244  76.6%     -  150s
     0     0 36682.0208    0  425 20766.9369 36682.0208  76.6%     -  151s
     0     0 36680.1585    0  432 20766.9369 36680.1585  76.6%     -  151s
     0     0 36679.6563    0  430 20766.9369 36679.6563  76.6%     -  151s
     0     0 36666.7151    0  424 20766.9369 36666.7151  76.6%     -  153s
     0     0 36658.5041    0  434 20766.9369 36658.5041  76.5%     -  154s
     0     0 36655.1896    0  426 20766.9369 36655.1896  76.5%     -  155s
     0     0 36651.5975    0  429 20766.9369 36651.5975  76.5%     -  156s
     0     0 36650.7874    0  437 20766.9369 36650.7874  76.5%     -  156s
     0     0 36612.8742    0  431 20766.9369 36612.8742  76.3%     -  158s
     0     0 36608.8675    0  428 20766.9369 36608.8675  76.3%     -  164s
     0     0 36606.2056    0  430 20766.9369 36606.2056  76.3%     -  164s
     0     0 36605.2893    0  431 20766.9369 36605.2893  76.3%     -  165s
     0     0 36601.2153    0  433 20766.9369 36601.2153  76.2%     -  166s
     0     0 36594.7467    0  428 20766.9369 36594.7467  76.2%     -  167s
     0     0 36588.0095    0  439 20766.9369 36588.0095  76.2%     -  168s
     0     0 36587.2186    0  437 20766.9369 36587.2186  76.2%     -  168s
     0     0 36579.3157    0  437 20766.9369 36579.3157  76.1%     -  170s
     0     0 36568.8924    0  434 20766.9369 36568.8924  76.1%     -  170s
     0     0 36566.4745    0  430 20766.9369 36566.4745  76.1%     -  171s
     0     0 36565.1531    0  434 20766.9369 36565.1531  76.1%     -  171s
     0     0 36559.7237    0  429 20766.9369 36559.7237  76.0%     -  173s
     0     0 36556.7737    0  434 20766.9369 36556.7737  76.0%     -  174s
     0     0 36556.2138    0  439 20766.9369 36556.2138  76.0%     -  174s
     0     0 36555.8267    0  437 20766.9369 36555.8267  76.0%     -  175s
     0     0 36555.1693    0  431 20766.9369 36555.1693  76.0%     -  175s
     0     0 36544.2635    0  429 20766.9369 36544.2635  76.0%     -  177s
     0     0 36532.5056    0  432 20766.9369 36532.5056  75.9%     -  178s
     0     0 36532.5056    0  434 20766.9369 36532.5056  75.9%     -  179s
     0     0 36532.5056    0  420 20766.9369 36532.5056  75.9%     -  180s
     0     0 36532.5056    0  420 20766.9369 36532.5056  75.9%     -  181s
     0     2 36532.4953    0  420 20766.9369 36532.4953  75.9%     -  223s
     1     4 36531.4000    1  420 20766.9369 36532.4953  75.9%   550  225s
     3     8 36451.2175    2  420 20766.9369 36526.6065  75.9%  2937  230s
     7    16 36187.8413    3  419 20766.9369 36450.6939  75.5%  5334  240s
    15    32 35676.1050    4  434 20766.9369 36187.0593  74.3%  8124  249s
    31    48 34748.8276    5  328 20766.9369 35675.2126  71.8% 12163  268s
    47    80 33246.6084    6  387 20766.9369 35675.2126  71.8% 10894  278s
    79   149 32987.2651    7  378 20766.9369 35675.2126  71.8%  8255  305s
   148   296 32831.5775    9  389 20766.9369 35675.2126  71.8%  5488  316s
   297   377 32581.6134   14  425 20766.9369 35675.2126  71.8%  3675  323s
   384   447 31949.8696   14  366 20766.9369 35675.2126  71.8%  3360  331s
   460   510 32431.1242   12  366 20766.9369 35675.2126  71.8%  3175  339s
   554   553 32147.6248   15  354 20766.9369 35675.2126  71.8%  2944  347s
   636   598 29731.2209   15  323 20766.9369 35675.2126  71.8%  2808  356s
   697   656 28373.9818   14  309 20766.9369 35675.2126  71.8%  2762  364s
   765   710 31440.2194   15  362 20766.9369 35675.2126  71.8%  2684  372s
   842   759 30843.8394   15  336 20766.9369 35675.2126  71.8%  2628  380s
   923   816 30838.4611   16  335 20766.9369 35675.2126  71.8%  2537  388s
  1025   842 23363.6777   35  272 20766.9369 35675.2126  71.8%  2414  395s
  1082   895 30751.9544   17  350 20766.9369 35675.2126  71.8%  2369  402s
  1181   909 30626.7556   19  337 20766.9369 35511.7993  71.0%  2293  410s
  1225   951 30368.2406   20  374 20766.9369 35511.7993  71.0%  2293  418s
  1288  1027 30218.6086   21  367 20766.9369 35511.7993  71.0%  2308  426s
  1370  1129 29840.0242   22  322 20766.9369 35511.7993  71.0%  2282  435s
  1494  1222 29847.5082   22  374 20766.9369 35137.9821  69.2%  2220  443s
  1616  1296 29490.6011   23  325 20766.9369 35137.9821  69.2%  2182  451s
  1745  1400 29831.7260   23  380 20766.9369 35003.4876  68.6%  2146  460s
  1877  1517 29477.6779   24  368 20766.9369 35003.4876  68.6%  2109  470s
  2030  1640 29137.2633   25  362 20766.9369 35003.4876  68.6%  2055  478s
  2173  1665 28736.0647   26  370 20766.9369 34855.3165  67.8%  2031  488s
  2210  1711 28988.6779   26  372 20766.9369 34855.3165  67.8%  2030  498s
  2268  1771 28615.4623   28  281 20766.9369 34287.6950  65.1%  2040  507s
  2374  1814     cutoff   27      20766.9369 34287.6950  65.1%  2047  517s
  2463  1857 25013.8687   31  263 20766.9369 34072.3981  64.1%  2089  531s
  2542  1935     cutoff   30      20766.9369 34072.3981  64.1%  2135  543s
  2663  2016 24328.4656   32  224 20766.9369 34072.3981  64.1%  2143  556s
  2784  2071 23879.6268   32  191 20766.9369 34072.3981  64.1%  2162  568s
  2895  2145 23250.4267   34  198 20766.9369 33695.5162  62.3%  2193  579s
  3019  2226 22695.1020   41  207 20766.9369 33695.5162  62.3%  2211  592s
  3174  2271 21751.7182   44  236 20766.9369 33461.8375  61.1%  2216  602s
  3242  2361 22191.3540   45  287 20766.9369 33444.9822  61.0%  2214  615s
  3376  2389 22004.4508   49  228 20766.9369 33444.9822  61.0%  2206  625s
  3412  2418 21967.5916   50  227 20766.9369 33444.9822  61.0%  2212  636s
H 3429  2418                    20848.400394 33444.9822  60.4%  2215  636s
  3455  2578 21964.9687   51  177 20848.4004 33444.9822  60.4%  2228  651s
  3717  2764 21359.5900   62  170 20848.4004 33444.9822  60.4%  2184  666s
  4012  2765 25230.6529   42  420 20848.4004 33444.9822  60.4%  2128  702s
  4014  2766 26578.6739   56  170 20848.4004 33444.9822  60.4%  2127  735s
  4015  2767 24352.1051   12  392 20848.4004 33444.9822  60.4%  2126  756s
H 4015  2628                    20891.230952 33444.9822  60.1%  2126  770s
  4017  2629 24369.3044   38  418 20891.2310 33444.9822  60.1%  2125  779s
  4018  2630 24369.3044   38  463 20891.2310 33444.9822  60.1%  2124  786s
  4019  2631 22517.3588   52  470 20891.2310 33444.9822  60.1%  2124  792s
  4020  2631 31935.5194   16  475 20891.2310 33444.9822  60.1%  2123  795s
  4022  2633 25811.4216   29  437 20891.2310 33444.9822  60.1%  2122  801s
  4024  2634 22091.7708   45  441 20891.2310 33444.9822  60.1%  2121  806s
H 4025  2503                    20921.734456 33444.9822  59.9%  2121  813s
H 4025  2378                    20948.232881 33444.9822  59.7%  2121  815s
  4028  2380 31282.1669   11  434 20948.2329 33444.9822  59.7%  2119  820s
  4030  2381 28674.1989   23  431 20948.2329 33444.9822  59.7%  2118  826s
  4032  2382 23920.1975   22  478 20948.2329 33444.9822  59.7%  2117  833s
  4033  2383 27580.3908   14  542 20948.2329 33444.9822  59.7%  2116  836s
  4035  2384 23777.4530   25  484 20948.2329 33444.9822  59.7%  2115  843s
  4036  2385 26179.9134   15  494 20948.2329 33444.9822  59.7%  2115  845s
  4038  2386 31732.0634   14  490 20948.2329 33444.9822  59.7%  2114  851s
  4039  2387 29974.7660   19  497 20948.2329 33444.9822  59.7%  2113  856s
  4041  2388 21498.5441   19  432 20948.2329 33444.9822  59.7%  2112  863s
  4043  2390 25682.6449   11  490 20948.2329 33444.9822  59.7%  2111  868s
  4044  2390 28734.8335   15  490 20948.2329 33444.9822  59.7%  2111  900s
  4045  2391 30952.2747   15  490 20948.2329 33444.9822  59.7%  2110  937s
  4046  2395 33444.9822   11  464 20948.2329 33444.9822  59.7%  2162 1043s
  4048  2398 33444.9822   12  434 20948.2329 33444.9822  59.7%  2165 1059s
  4052  2405 33444.9822   13  471 20948.2329 33444.9822  59.7%  2172 1073s
  4060  2418 33444.9822   14  526 20948.2329 33444.9822  59.7%  2185 1086s
  4076  2431 31804.7404   15  319 20948.2329 33444.9822  59.7%  2225 1111s
  4094  2454 31453.6566   16  347 20948.2329 33444.9822  59.7%  2276 1128s
  4126  2504 29585.6465   17  287 20948.2329 33444.9822  59.7%  2340 1149s
  4195  2565 27760.2447   19  396 20948.2329 33444.9822  59.7%  2426 1165s
  4290  2607 27461.0849   20  324 20948.2329 33444.9822  59.7%  2465 1178s
  4380  2638 27450.2111   21  331 20948.2329 33444.9822  59.7%  2474 1191s
  4465  2640 25778.3759   23  244 20948.2329 33444.9822  59.7%  2477 1200s
  4517  2668 25648.5679   24  249 20948.2329 33444.9822  59.7%  2483 1211s
  4593  2656 25508.0702   25  246 20948.2329 33444.9822  59.7%  2482 1221s
  4638  2684     cutoff   27      20948.2329 33444.9822  59.7%  2484 1234s
  4708  2683 25250.5122   29  178 20948.2329 33444.9822  59.7%  2480 1244s
  4782  2686 24425.2600   31  197 20948.2329 33444.9822  59.7%  2477 1257s
  4860  2685     cutoff   31      20948.2329 33444.9822  59.7%  2476 1267s
  4927  2699     cutoff   30      20948.2329 33444.9822  59.7%  2485 1276s
  4998  2707 23903.7776   33  250 20948.2329 33444.9822  59.7%  2490 1286s
  5083  2708 21257.2767   36  186 20948.2329 33444.9822  59.7%  2491 1296s
  5167  2697 28169.7455   16  377 20948.2329 33444.9822  59.7%  2496 1309s
  5237  2698 25892.7748   17  360 20948.2329 33444.9822  59.7%  2500 1319s
  5306  2714 25638.0064   18  300 20948.2329 33444.9822  59.7%  2503 1329s
  5401  2725 21457.0849   19  247 20948.2329 33369.7204  59.3%  2502 1340s
  5489  2757 25309.8546   20  286 20948.2329 32688.9397  56.0%  2506 1351s
  5590  2783 24732.5149   20  272 20948.2329 32688.9397  56.0%  2505 1363s
  5677  2822 22527.2374   23  166 20948.2329 32688.9397  56.0%  2510 1375s
  5784  2828 21834.5402   25  230 20948.2329 32688.9397  56.0%  2514 1387s
  5878  2826     cutoff   28      20948.2329 32411.3172  54.7%  2526 1401s
  5986  2814 28911.8435   19  347 20948.2329 32253.3786  54.0%  2537 1410s
  6025  2822 28699.3320   20  321 20948.2329 32252.0326  54.0%  2541 1417s
  6065  2829 27629.8772   21  359 20948.2329 32252.0326  54.0%  2544 1427s
  6107  2846 27367.9369   22  356 20948.2329 32252.0326  54.0%  2545 1436s
  6140  2859 27299.7077   23  354 20948.2329 32252.0326  54.0%  2550 1445s
  6177  2868 27261.6595   24  205 20948.2329 32252.0326  54.0%  2555 1454s
  6218  2891 27007.6173   25  299 20948.2329 32168.7349  53.6%  2559 1468s
  6279  2909 26912.4233   26  290 20948.2329 32168.7349  53.6%  2560 1481s
  6391  2948 26783.1156   27  286 20948.2329 31617.6495  50.9%  2557 1496s
  6522  2968 24580.8280   31  145 20948.2329 30777.9651  46.9%  2555 1513s
  6689  2973 21532.7061   33  136 20948.2329 30581.3144  46.0%  2552 1532s
  6849  2991 25421.4506   24  198 20948.2329 30581.3144  46.0%  2565 1557s
  7008  3011     cutoff   26      20948.2329 30581.3144  46.0%  2577 1582s
  7174  3039 22743.6585   31  129 20948.2329 30063.7244  43.5%  2589 1601s
  7334  3057 28146.6436   21  350 20948.2329 30063.7244  43.5%  2605 1620s
  7546  3063 26702.2727   25  321 20948.2329 30030.2278  43.4%  2606 1638s
  7759  3081 24435.5312   27  235 20948.2329 30030.2278  43.4%  2592 1658s
  7990  3118 21733.2039   32   57 20948.2329 29884.8637  42.7%  2592 1682s
  8251  3124 26344.3671   24  228 20948.2329 29598.8071  41.3%  2587 1702s
  8447  3166 21065.1918   30  126 20948.2329 29530.4597  41.0%  2595 1725s
  8711  3177 26031.9653   22  269 20948.2329 29530.4597  41.0%  2603 1749s
  9013  3140 21030.3753   31   77 20948.2329 29416.0851  40.4%  2602 1772s
  9240  3158 26116.3748   20  318 20948.2329 29265.1149  39.7%  2609 1801s
  9538  3165 23328.5176   27  244 20948.2329 29083.4673  38.8%  2612 1827s
  9858  3177 26130.2343   23  227 20948.2329 29083.4673  38.8%  2619 1852s
 10233  3170     cutoff   29      20948.2329 28703.3270  37.0%  2615 1878s
 10665  3162 24971.6094   21  352 20948.2329 28701.5022  37.0%  2602 1908s
 11022  3222     cutoff   28      20948.2329 28674.4139  36.9%  2605 1937s
 11411  3319 23576.3265   27  260 20948.2329 28608.2620  36.6%  2601 1966s
 11857  3462     cutoff   22      20948.2329 28329.6056  35.2%  2592 1996s
 12281  3595     cutoff   27      20948.2329 28064.4100  34.0%  2592 2030s
 12866  3661 22207.6072   24  184 20948.2329 27844.8708  32.9%  2567 2062s
 13389  3732 21614.1064   21  213 20948.2329 27822.4876  32.8%  2559 2094s
 13887  3802     cutoff   29      20948.2329 27741.2267  32.4%  2559 2126s
 14340  3939 23031.6870   31  113 20948.2329 27581.6460  31.7%  2553 2161s
 14839  4023 23778.1835   25  326 20948.2329 27525.5236  31.4%  2561 2197s
 15443  4184 24418.1230   24  283 20948.2329 27323.4479  30.4%  2556 2251s
 16049  4316 23473.3730   22  153 20948.2329 27214.6749  29.9%  2556 2289s
 16701  4446 24925.5777   28  225 20948.2329 27093.6138  29.3%  2550 2333s
 17366  4633 22419.3287   27  180 20948.2329 27027.0284  29.0%  2548 2375s
 17992  4658 25059.5188   27  175 20948.2329 26885.2940  28.3%  2551 2411s
 18081  4744 24083.2784   29  300 20948.2329 26885.2940  28.3%  2553 2454s
 18570  4846     cutoff   22      20948.2329 26791.3361  27.9%  2552 2500s
 19278  4895     cutoff   26      20948.2329 26597.2169  27.0%  2555 2548s
 20048  4985 23905.6665   24  166 20948.2329 26452.0485  26.3%  2554 2603s
 20860  5052 infeasible   21      20948.2329 26308.4153  25.6%  2551 2657s
 21709  5121     cutoff   25      20948.2329 26167.3533  24.9%  2546 2713s
 22566  5121 24146.2555   24  328 20948.2329 25992.7225  24.1%  2545 2767s
 23492  5169 22064.1511   29  235 20948.2329 25823.1693  23.3%  2538 2826s
 24514  5181     cutoff   31      20948.2329 25683.2804  22.6%  2526 2888s
 25552  5224 22843.3135   29  278 20948.2329 25503.9708  21.7%  2517 2948s
 26611  5181 22120.6015   21  390 20948.2329 25346.7097  21.0%  2511 3008s
 27725  5110 22002.0605   28  230 20948.2329 25093.1901  19.8%  2502 3072s
 28930  5003     cutoff   34      20948.2329 25013.3047  19.4%  2488 3143s
 30136  4876     cutoff   24      20948.2329 24796.3440  18.4%  2479 3207s
 31454  4662 21846.1088   24  371 20948.2329 24545.9967  17.2%  2463 3277s
 32903  4380 21903.6232   29  193 20948.2329 24373.4836  16.4%  2441 3344s
 34485  3895     cutoff   23      20948.2329 24001.0061  14.6%  2413 3417s
 36247  3320 21708.4680   30  112 20948.2329 23626.0150  12.8%  2376 3487s
 38244  2413     cutoff   26      20948.2329 23297.0385  11.2%  2330 3556s
 40624  1494 infeasible   21      20948.2329 22928.2963  9.45%  2267 3600s

Cutting planes:
  Learned: 4
  MIR: 721
  Mixing: 6
  Flow cover: 2153
  RLT: 42
  Relax-and-lift: 109

Explored 42691 nodes (94437147 simplex iterations) in 3600.04 seconds (11817.36 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20948.2 20891.2 20848.4 ... 11487.9

Time limit reached
Best objective 2.094823288138e+04, best bound 2.250706567738e+04, gap 7.4414%
  WARNING: Time limit reached. Using best solution found (gap: 7.44%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 20948.23, θ = 166689.92
  Upper Bound (UB) = 20948.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166689.92
  [DEBUG]   ✓ Scenario 0: θ = 166689.92 ≤ Q = 166689.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166689.92 ≤ Q = 166689.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166689.92 ≤ Q = 166689.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166689.92 ≤ Q = 166689.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166689.92 ≤ Q = 166689.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166689.92 ≤ Q = 166689.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166689.92 ≤ Q = 166689.92 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3b07b5aa
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3b07b5aa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.330370e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6760946.6918
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.456126e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145612.61    0  123 6760946.69 -145612.61   102%     -    0s
H    0     0                    -110092.4566 -145612.61  32.3%     -    0s
H    0     0                    -111350.2266 -145612.61  30.8%     -    0s
     0     0 -123456.07    0   93 -111350.23 -123456.07  10.9%     -    0s
H    0     0                    -120769.9089 -123369.35  2.15%     -    0s
H    0     0                    -121724.8131 -123369.35  1.35%     -    0s
     0     0 -122766.47    0   96 -121724.81 -122766.47  0.86%     -    0s
     0     0 -122738.59    0   96 -121724.81 -122738.59  0.83%     -    0s
     0     0 -122348.36    0   59 -121724.81 -122348.36  0.51%     -    0s
     0     0 -122271.88    0   69 -121724.81 -122271.88  0.45%     -    0s
     0     0 -122269.65    0   71 -121724.81 -122269.65  0.45%     -    0s
     0     0 -121912.86    0   21 -121724.81 -121912.86  0.15%     -    0s
     0     0 -121912.24    0   19 -121724.81 -121912.24  0.15%     -    0s
     0     0 -121876.27    0   30 -121724.81 -121876.27  0.12%     -    0s
     0     0 -121875.61    0   30 -121724.81 -121875.61  0.12%     -    0s
     0     0 -121875.21    0   30 -121724.81 -121875.21  0.12%     -    0s
     0     0 -121868.04    0   32 -121724.81 -121868.04  0.12%     -    0s
     0     0 -121867.98    0   32 -121724.81 -121867.98  0.12%     -    0s
     0     0 -121820.59    0   12 -121724.81 -121820.59  0.08%     -    0s
     0     0 -121820.59    0   11 -121724.81 -121820.59  0.08%     -    0s
H    0     0                    -121733.1081 -121820.59  0.07%     -    0s
     0     0 -121774.64    0    9 -121733.11 -121774.64  0.03%     -    0s
H    0     0                    -121737.4893 -121770.69  0.03%     -    0s
     0     0 -121767.49    0    9 -121737.49 -121767.49  0.02%     -    0s
H    0     0                    -121744.1529 -121765.00  0.02%     -    0s
     0     0 -121765.00    0    8 -121744.15 -121765.00  0.02%     -    0s
     0     0 -121762.69    0    7 -121744.15 -121762.69  0.02%     -    0s
     0     0 -121762.32    0    7 -121744.15 -121762.32  0.01%     -    0s
     0     0 -121756.44    0    4 -121744.15 -121756.44  0.01%     -    0s
     0     0 -121756.44    0    6 -121744.15 -121756.44  0.01%     -    0s
H    0     0                    -121756.0169 -121756.44  0.00%     -    0s

Explored 1 nodes (881 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -121756 -121744 -121737 ... 1.33037e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.217560169241e+05, best bound -1.217564436127e+05, gap 0.0004%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 158392.36
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121756.02
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -121756.02 = 158392.36
  [DEBUG]   Current θ from Master = 166689.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8297.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12650.68
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 949.4127, Absolute Gap = 949.4127, Relative Gap = 0.045322
  Not converged yet (gap = 949.41 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351439 nonzeros
Model fingerprint: 0x464f71f6
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54216 rows and 22016 columns
Presolve time: 1.11s
Presolved: 69487 rows, 30164 columns, 432599 nonzeros
Variable types: 27905 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -214770.4678

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 69487 rows, 30164 columns, 432599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34226   -4.8484145e+04   0.000000e+00   2.082048e+07      5s
   48177    9.5607169e+03   0.000000e+00   3.279016e+06     10s
   58229    2.2251070e+04   0.000000e+00   1.607893e+07     15s
   68794    2.8141851e+04   0.000000e+00   3.538356e+06     20s
   78431    3.5363236e+04   0.000000e+00   4.623330e+06     25s
   86741    3.7032625e+04   0.000000e+00   7.164218e+05     30s
   93901    3.7959900e+04   0.000000e+00   1.269223e+07     35s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.863481e+04, 56568 iterations, 35.73 seconds (71.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48634.8053    0   95 -214770.47 48634.8053   123%     -   37s
H    0     0                    -198638.5042 48634.8053   124%     -   37s
H    0     0                    -156240.6482 48634.8053   131%     -   37s
H    0     0                    -156177.7707 48634.8053   131%     -   37s
H    0     0                    -156173.8218 48634.8053   131%     -   37s
H    0     0                    -53399.49381 48634.8053   191%     -   37s
H    0     0                    -26139.21101 48634.8053   286%     -   38s
H    0     0                    10666.863027 48634.8053   356%     -   38s
H    0     0                    11013.142937 48634.8053   342%     -   38s
H    0     0                    11461.427649 48634.8053   324%     -   38s
H    0     0                    11555.356105 48634.8053   321%     -   38s
H    0     0                    11631.037382 48632.9590   318%     -   39s
     0     0 45172.2126    0  229 11631.0374 45172.2126   288%     -   49s
     0     0 44716.3139    0  241 11631.0374 44716.3139   284%     -   54s
     0     0 44716.3139    0  239 11631.0374 44716.3139   284%     -   55s
     0     0 44716.3139    0  239 11631.0374 44716.3139   284%     -   55s
     0     0 44716.3139    0  239 11631.0374 44716.3139   284%     -   55s
H    0     0                    11643.422985 41150.2004   253%     -   66s
     0     0 41064.4472    0  346 11643.4230 41064.4472   253%     -   66s
H    0     0                    17641.844349 41064.4472   133%     -   67s
     0     0 40316.8960    0  359 17641.8443 40316.8960   129%     -   72s
     0     0 40175.8013    0  355 17641.8443 40175.8013   128%     -   75s
     0     0 40086.2373    0  362 17641.8443 40086.2373   127%     -   77s
     0     0 40065.9448    0  369 17641.8443 40065.9448   127%     -   78s
     0     0 39915.2739    0  362 17641.8443 39915.2739   126%     -   81s
     0     0 39887.1426    0  360 17641.8443 39887.1426   126%     -   83s
     0     0 39874.9751    0  365 17641.8443 39874.9751   126%     -   84s
     0     0 39873.3732    0  366 17641.8443 39873.3732   126%     -   84s
     0     0 39872.7832    0  364 17641.8443 39872.7832   126%     -   85s
     0     0 37872.5231    0  412 17641.8443 37872.5231   115%     -  108s
H    0     0                    17755.092669 37872.3389   113%     -  109s
     0     0 37515.0350    0  374 17755.0927 37515.0350   111%     -  117s
     0     0 37353.0626    0  418 17755.0927 37353.0626   110%     -  122s
     0     0 37270.1183    0  382 17755.0927 37270.1183   110%     -  125s
     0     0 37246.2794    0  378 17755.0927 37246.2794   110%     -  128s
     0     0 37236.0047    0  382 17755.0927 37236.0047   110%     -  130s
     0     0 37225.9652    0  420 17755.0927 37225.9652   110%     -  132s
     0     0 37220.9627    0  376 17755.0927 37220.9627   110%     -  133s
     0     0 37213.2471    0  336 17755.0927 37213.2471   110%     -  135s
     0     0 37202.2717    0  384 17755.0927 37202.2717   110%     -  137s
     0     0 37192.2251    0  382 17755.0927 37192.2251   109%     -  138s
     0     0 37189.0506    0  381 17755.0927 37189.0506   109%     -  138s
     0     0 37187.8511    0  422 17755.0927 37187.8511   109%     -  139s
     0     0 36547.1574    0  406 17755.0927 36547.1574   106%     -  151s
H    0     0                    17822.588994 36546.5371   105%     -  151s
H    0     0                    20033.208208 36391.6188  81.7%     -  154s
     0     0 36391.6188    0  446 20033.2082 36391.6188  81.7%     -  154s
H    0     0                    20134.384749 36320.5879  80.4%     -  157s
     0     0 36320.5879    0  455 20134.3847 36320.5879  80.4%     -  157s
H    0     0                    20238.541632 36295.7449  79.3%     -  159s
     0     0 36295.7449    0  457 20238.5416 36295.7449  79.3%     -  159s
H    0     0                    20310.895365 36275.2334  78.6%     -  160s
     0     0 36275.2334    0  465 20310.8954 36275.2334  78.6%     -  160s
H    0     0                    20435.217684 36262.9418  77.5%     -  162s
     0     0 36262.9418    0  460 20435.2177 36262.9418  77.5%     -  162s
     0     0 36261.4039    0  462 20435.2177 36261.4039  77.4%     -  162s
     0     0 36256.9563    0  416 20435.2177 36256.9563  77.4%     -  163s
     0     0 36250.9886    0  466 20435.2177 36250.9886  77.4%     -  164s
     0     0 36250.1810    0  467 20435.2177 36250.1810  77.4%     -  164s
     0     0 36169.2658    0  462 20435.2177 36169.2658  77.0%     -  168s
     0     0 36144.3799    0  469 20435.2177 36144.3799  76.9%     -  170s
     0     0 36138.3603    0  428 20435.2177 36138.3603  76.8%     -  171s
     0     0 36132.6534    0  427 20435.2177 36132.6534  76.8%     -  172s
     0     0 36127.3317    0  481 20435.2177 36127.3317  76.8%     -  172s
     0     0 36123.3321    0  479 20435.2177 36123.3321  76.8%     -  173s
     0     0 36121.6012    0  485 20435.2177 36121.6012  76.8%     -  174s
     0     0 36120.7789    0  486 20435.2177 36120.7789  76.8%     -  174s
     0     0 36087.9439    0  430 20435.2177 36087.9439  76.6%     -  177s
H    0     0                    20447.915790 36087.5645  76.5%     -  179s
     0     0 36071.6951    0  433 20447.9158 36071.6951  76.4%     -  181s
     0     0 36068.3026    0  432 20447.9158 36068.3026  76.4%     -  182s
H    0     0                    20492.154727 36063.8845  76.0%     -  183s
     0     0 36063.8845    0  436 20492.1547 36063.8845  76.0%     -  183s
     0     0 36063.0188    0  441 20492.1547 36063.0188  76.0%     -  183s
     0     0 36035.1606    0  435 20492.1547 36035.1606  75.8%     -  186s
     0     0 36025.6293    0  485 20492.1547 36025.6293  75.8%     -  188s
     0     0 36020.5252    0  487 20492.1547 36020.5252  75.8%     -  189s
     0     0 36017.7552    0  480 20492.1547 36017.7552  75.8%     -  190s
     0     0 36014.5969    0  482 20492.1547 36014.5969  75.7%     -  190s
     0     0 36010.3743    0  486 20492.1547 36010.3743  75.7%     -  191s
     0     0 36007.0333    0  432 20492.1547 36007.0333  75.7%     -  191s
     0     0 36006.6509    0  488 20492.1547 36006.6509  75.7%     -  192s
     0     0 35998.7157    0  435 20492.1547 35998.7157  75.7%     -  193s
H    0     0                    20540.543567 35998.6917  75.3%     -  194s
H    0     0                    20588.678465 35998.6917  74.8%     -  194s
H    0     0                    20676.246636 35998.6917  74.1%     -  194s
     0     0 35987.0789    0  436 20676.2466 35987.0789  74.1%     -  195s
     0     0 35983.9567    0  439 20676.2466 35983.9567  74.0%     -  196s
     0     0 35983.3534    0  442 20676.2466 35983.3534  74.0%     -  196s
     0     0 35974.3439    0  437 20676.2466 35974.3439  74.0%     -  198s
H    0     0                    20694.024868 35974.1527  73.8%     -  198s
     0     0 35971.3481    0  436 20694.0249 35971.3481  73.8%     -  199s
     0     0 35967.4392    0  439 20694.0249 35967.4392  73.8%     -  199s
     0     0 35964.4491    0  443 20694.0249 35964.4491  73.8%     -  200s
     0     0 35962.5068    0  443 20694.0249 35962.5068  73.8%     -  200s
     0     0 35961.2969    0  445 20694.0249 35961.2969  73.8%     -  201s
     0     0 35943.1430    0  437 20694.0249 35943.1430  73.7%     -  202s
     0     0 35940.0486    0  447 20694.0249 35940.0486  73.7%     -  203s
     0     0 35938.3326    0  446 20694.0249 35938.3326  73.7%     -  203s
     0     0 35938.2565    0  449 20694.0249 35938.2565  73.7%     -  204s
     0     0 35936.8811    0  449 20694.0249 35936.8811  73.7%     -  205s
     0     0 35935.8422    0  444 20694.0249 35935.8422  73.7%     -  206s
     0     0 35934.8056    0  442 20694.0249 35934.8056  73.6%     -  207s
H    0     0                    20722.697972 35934.2162  73.4%     -  211s
H    0     0                    20727.778097 35934.2162  73.4%     -  211s
     0     0 35934.2162    0  443 20727.7781 35934.2162  73.4%     -  211s
     0     0 35933.5852    0  443 20727.7781 35933.5852  73.4%     -  212s
     0     0 35932.7846    0  443 20727.7781 35932.7846  73.4%     -  214s
H    0     0                    20766.936909 35932.7846  73.0%     -  249s
     0     2 35932.7846    0  443 20766.9369 35932.7846  73.0%     -  251s
     3     7 35791.0684    2  428 20766.9369 35898.6231  72.9%  3443  258s
     6    14 35655.0767    3  478 20766.9369 35824.9920  72.5%  5700  265s
    13    28 35486.8483    4  485 20766.9369 35731.4847  72.1%  6499  278s
    27    42 33150.0672    5  400 20766.9369 35550.9222  71.2% 10394  413s
    41    74 32142.4904    6  384 20766.9369 35550.9222  71.2% 11794  449s
    73   174 32030.8290    7  383 20766.9369 35495.9149  70.9% 11602  462s
   175   206 31478.8023   10  328 20766.9369 35495.6476  70.9%  6710  469s
   207   238 29774.9193   11  281 20766.9369 35495.6476  70.9%  6019  477s
   239   269 29037.6577   12  310 20766.9369 35495.6476  70.9%  5937  484s
   271   299 28729.8659   13  294 20766.9369 35495.6476  70.9%  5887  493s
   303   329 28640.8016   14  293 20766.9369 35495.6476  70.9%  5978  502s
   335   347 28519.2853   15  246 20766.9369 35495.6476  70.9%  5833  511s
   379   370 28424.5916   16  348 20766.9369 35495.6476  70.9%  5670  523s
   414   395 27754.0670   17  277 20766.9369 35495.6476  70.9%  5533  533s
   445   424 27526.2602   18  322 20766.9369 35495.6476  70.9%  5659  544s
   479   452 27354.1110   19  212 20766.9369 35495.6476  70.9%  5570  553s
   515   478 23916.6491   20  263 20766.9369 35495.6476  70.9%  5541  563s
   549   507     cutoff   21      20766.9369 35495.6476  70.9%  5525  574s
   586   538 26687.6013   21  205 20766.9369 35495.6476  70.9%  5595  586s
   625   567 26286.4945   22  200 20766.9369 35495.6476  70.9%  5518  597s
   680   594 26236.7646   23  193 20766.9369 35495.6476  70.9%  5471  606s
   713   623 25889.2835   24  161 20766.9369 35495.6476  70.9%  5448  616s
   758   642 24662.6977   26  116 20766.9369 35495.6476  70.9%  5465  627s
   793   665 24654.3909   27  103 20766.9369 35495.6476  70.9%  5430  638s
   828   700 24621.9461   28   99 20766.9369 35495.6476  70.9%  5428  650s
   865   740 24587.2880   29   97 20766.9369 35495.6476  70.9%  5460  659s
   907   788 24308.5945   32   99 20766.9369 35495.6476  70.9%  5461  671s
   971   843 23754.0045   36   96 20766.9369 35495.6476  70.9%  5384  683s
  1062   875 22610.8819   42   90 20766.9369 35495.6476  70.9%  5240  695s
  1130   924 29628.0147   18  269 20766.9369 35495.6476  70.9%  5276  706s
  1202   976 27927.4110   19  358 20766.9369 35495.6476  70.9%  5303  718s
  1288  1061 28630.8024   20  183 20766.9369 35495.6476  70.9%  5321  730s
  1395  1136 28308.9290   23  380 20766.9369 35154.0067  69.3%  5218  743s
  1498  1234 27619.9961   24  327 20766.9369 34876.1674  67.9%  5172  755s
  1618  1302 27576.3793   25  264 20766.9369 34356.2163  65.4%  5061  770s
  1738  1380 26881.3046   29  209 20766.9369 34356.2163  65.4%  5019  782s
  1872  1469 26381.7564   34  185 20766.9369 33923.1388  63.4%  4957  796s
  1981  1583 26179.4719   38  167 20766.9369 33923.1388  63.4%  4977  810s
  2129  1705 25771.1890   43  146 20766.9369 33923.1388  63.4%  4936  827s
  2291  1800     cutoff   51      20766.9369 33923.1388  63.4%  4854  843s
  2460  1900 23191.8843   61  122 20766.9369 33923.1388  63.4%  4805  860s
  2622  2015 22065.5347   67  142 20766.9369 33923.1388  63.4%  4765  876s
  2801  2133     cutoff   73      20766.9369 33516.6863  61.4%  4740  893s
  3003  2220 30145.4106    9  309 20766.9369 33515.2233  61.4%  4706  911s
  3154  2340 28617.1898   13  261 20766.9369 33515.2233  61.4%  4768  929s
  3372  2488 26748.7650   19  198 20766.9369 33515.2233  61.4%  4763  947s
  3608  2599 25794.0782   25  176 20766.9369 33515.2233  61.4%  4722  967s
  3862  2766 24223.2996   35  191 20766.9369 33461.2076  61.1%  4683  990s
  4110  2767 28457.1021   24  443 20766.9369 33238.1582  60.1%  4649 1048s
  4112  2768 25986.8381   23   95 20766.9369 33238.1582  60.1%  4646 1093s
  4113  2769 28608.8278   10  380 20766.9369 33238.1582  60.1%  4645 1117s
  4114  2770 22873.2419   25  433 20766.9369 33238.1582  60.1%  4644 1133s
  4115  2770 29089.1767   12  422 20766.9369 33238.1582  60.1%  4643 1149s
  4116  2771 25875.7976   42  413 20766.9369 33238.1582  60.1%  4642 1156s
  4117  2772 26708.9735   25  416 20766.9369 33238.1582  60.1%  4641 1162s
  4118  2772 31229.0782    7  461 20766.9369 33238.1582  60.1%  4640 1166s
  4120  2774 23048.0874   43  438 20766.9369 33238.1582  60.1%  4637 1172s
  4121  2774 23835.5729   32  477 20766.9369 33238.1582  60.1%  4636 1175s
  4123  2776 28017.6798   17  490 20766.9369 33238.1582  60.1%  4634 1180s
  4125  2777 26524.0403   21  484 20766.9369 33238.1582  60.1%  4632 1185s
  4127  2778 26015.2777   30  435 20766.9369 33238.1582  60.1%  4630 1195s
  4130  2780 26799.2307   20  445 20766.9369 33238.1582  60.1%  4626 1204s
  4131  2781 22199.8052   40  453 20766.9369 33238.1582  60.1%  4625 1206s
  4132  2782 23571.3351    7  449 20766.9369 33238.1582  60.1%  4624 1211s
  4134  2783 21838.0109   24  509 20766.9369 33238.1582  60.1%  4622 1218s
  4135  2784 25235.9424   12  458 20766.9369 33238.1582  60.1%  4621 1221s
  4136  2784 22287.4717   42  463 20766.9369 33238.1582  60.1%  4619 1228s
  4137  2785 31077.0725   11  455 20766.9369 33238.1582  60.1%  4618 1230s
  4139  2786 22650.3605   16  499 20766.9369 33238.1582  60.1%  4616 1236s
  4140  2787 27734.0710   18  500 20766.9369 33238.1582  60.1%  4615 1240s
  4142  2788 26774.5434   17  488 20766.9369 33238.1582  60.1%  4613 1246s
  4143  2789 24403.8585   23  488 20766.9369 33238.1582  60.1%  4612 1310s
  4144  2790 22762.6364   45  488 20766.9369 33238.1582  60.1%  4611 1360s
  4145  2793 33238.1582   10  469 20766.9369 33238.1582  60.1%  4665 1372s
  4147  2797 33238.1582   11  480 20766.9369 33238.1582  60.1%  4665 1398s
  4151  2803 33238.1582   12  465 20766.9369 33238.1582  60.1%  4669 1414s
  4159  2817 33238.1582   13  430 20766.9369 33238.1582  60.1%  4681 1427s
  4175  2827 33238.1582   14  477 20766.9369 33238.1582  60.1%  4709 1458s
  4191  2852 31764.2626   15  419 20766.9369 33238.1582  60.1%  4754 1475s
  4223  2881 31656.2559   16  410 20766.9369 33238.1582  60.1%  4791 1492s
  4268  2902 31641.0299   17  408 20766.9369 33238.1582  60.1%  4766 1515s
  4320  2947 31581.0995   17  389 20766.9369 33238.1582  60.1%  4766 1534s
  4405  2984 30463.9111   18  457 20766.9369 33238.1582  60.1%  4828 1550s
  4498  2999 29116.1880   18  331 20766.9369 33238.1582  60.1%  4835 1565s
  4587  2988 29980.0981   19  455 20766.9369 33238.1582  60.1%  4849 1578s
  4633  3011 26211.8322   19  407 20766.9369 33238.1582  60.1%  4860 1589s
  4697  3037 29086.4444   19  383 20766.9369 33238.1582  60.1%  4857 1600s
  4773  3064 28801.6969   19  319 20766.9369 33238.1582  60.1%  4852 1616s
  4858  3091 24764.9033   20  309 20766.9369 33238.1582  60.1%  4831 1626s
  4936  3111 23623.8655   21  298 20766.9369 33238.1582  60.1%  4827 1637s
  5021  3110 21013.0914   22  293 20766.9369 33238.1582  60.1%  4795 1648s
  5128  3092 21378.8733   23  261 20766.9369 33238.1582  60.1%  4755 1659s
  5223  3080 22297.3878   24  109 20766.9369 33238.1582  60.1%  4721 1671s
  5308  3106     cutoff   26      20766.9369 33238.1582  60.1%  4693 1682s
  5411  3122 30362.9273   15  246 20766.9369 33238.1582  60.1%  4664 1700s
  5526  3126 27544.8694   17  323 20766.9369 33238.1582  60.1%  4631 1715s
  5624  3145 27191.4949   19  313 20766.9369 33238.1582  60.1%  4630 1733s
  5714  3163 21622.8214   22  140 20766.9369 33238.1582  60.1%  4635 1746s
  5807  3166 22574.4685   23  340 20766.9369 33238.1582  60.1%  4654 1757s
  5865  3194 21959.5656   24  298 20766.9369 33238.1582  60.1%  4664 1772s
  5951  3227 21236.1693   27  294 20766.9369 33238.1582  60.1%  4653 1788s
  6050  3247 24975.5153   16  280 20766.9369 33238.1582  60.1%  4651 1806s
  6175  3271 22474.6151   18  325 20766.9369 33118.9377  59.5%  4638 1824s
  6296  3304 21377.0206   22  265 20766.9369 33118.9377  59.5%  4646 1841s
  6423  3298 22094.2951   20  336 20766.9369 33118.9377  59.5%  4641 1856s
  6515  3327 22075.4181   21  280 20766.9369 33118.9377  59.5%  4633 1872s
  6654  3344 21023.8164   25  205 20766.9369 32683.4812  57.4%  4635 1890s
  6816  3356 25055.5343   21  369 20766.9369 32683.4812  57.4%  4616 1911s
  6969  3376 24381.7623   24  204 20766.9369 32683.4812  57.4%  4596 1931s
  7112  3427 23081.1444   28  167 20766.9369 32683.4812  57.4%  4611 1949s
  7272  3459 22259.7977   32  276 20766.9369 32141.1093  54.8%  4608 1969s
  7473  3469     cutoff   36      20766.9369 30550.3743  47.1%  4581 1993s
  7646  3486 27310.4561   17  397 20766.9369 30487.0243  46.8%  4569 2012s
  7779  3529 26613.8323   19  305 20766.9369 30487.0243  46.8%  4572 2034s
  7968  3544 24580.9219   21  293 20766.9369 30487.0243  46.8%  4559 2056s
  8154  3584 23451.4584   22  268 20766.9369 29897.8210  44.0%  4558 2078s
  8397  3604     cutoff   25      20766.9369 29736.0375  43.2%  4547 2101s
  8614  3679 22991.6071   20  297 20766.9369 29616.9248  42.6%  4552 2124s
  8885  3701     cutoff   24      20766.9369 29586.1039  42.5%  4540 2147s
  9145  3695     cutoff   19      20766.9369 29586.1039  42.5%  4533 2173s
  9389  3715 23766.2122   18  366 20766.9369 29486.3727  42.0%  4539 2198s
  9629  3760     cutoff   23      20766.9369 29227.7111  40.7%  4570 2223s
  9952  3769 22194.0087   26  122 20766.9369 29090.0868  40.1%  4579 2252s
 10278  3802 24156.5943   20  318 20766.9369 29051.6334  39.9%  4582 2281s
 10591  3816 infeasible   26      20766.9369 29051.6334  39.9%  4596 2311s
 11001  3758 24357.1919   20  252 20766.9369 28790.0408  38.6%  4575 2343s
 11307  3795     cutoff   24      20766.9369 28563.9060  37.5%  4584 2373s
 11674  3833 25090.5587   25  215 20766.9369 28470.7200  37.1%  4590 2407s
 12080  3818 21069.1422   34  161 20766.9369 28410.4875  36.8%  4594 2439s
 12423  3808 23473.4182   26  247 20766.9369 28317.0168  36.4%  4614 2475s
 12806  3800 21521.9341   18  382 20766.9369 28317.0168  36.4%  4632 2506s
 12848  3817 23720.0554   18  341 20766.9369 28131.3408  35.5%  4642 2533s
 12895  3842 23512.2843   19  395 20766.9369 28131.3408  35.5%  4650 2560s
 12934  3877     cutoff   19      20766.9369 28131.3408  35.5%  4656 2593s
 13138  4005 infeasible   20      20766.9369 28131.3408  35.5%  4657 2636s
 13542  4101 24956.1457   23  200 20766.9369 27887.5067  34.3%  4665 2674s
 14029  4190 25228.6317   22  164 20766.9369 27746.9934  33.6%  4683 2714s
 14561  4268     cutoff   27      20766.9369 27640.4925  33.1%  4693 2764s
 15087  4352 24928.8176   30  279 20766.9369 27481.6587  32.3%  4702 2811s
 15619  4453 21600.8172   23  299 20766.9369 27318.1214  31.5%  4717 2866s
 16181  4590 20904.6055   23  281 20766.9369 27118.4025  30.6%  4726 2914s
 16761  4708 23150.5747   18  192 20766.9369 26993.0662  30.0%  4737 2967s
 17407  4774 infeasible   31      20766.9369 26821.4937  29.2%  4744 3020s
 18095  4922 24482.8491   28  150 20766.9369 26686.9863  28.5%  4744 3077s
 18772  5037     cutoff   24      20766.9369 26645.3207  28.3%  4753 3132s
 19533  5182 23882.4054   25  234 20766.9369 26381.3586  27.0%  4745 3189s
 20339  5274 21341.9033   29  322 20766.9369 26235.6194  26.3%  4734 3248s
 21122  5376     cutoff   24      20766.9369 26056.1793  25.5%  4733 3310s
 21963  5410     cutoff   25      20766.9369 25925.5803  24.8%  4719 3373s
 22865  5421 23139.9167   24  207 20766.9369 25740.4242  23.9%  4708 3434s
 23785  5388 22701.2575   28  290 20766.9369 25563.2721  23.1%  4700 3501s
 24762  5378 infeasible   28      20766.9369 25318.0987  21.9%  4684 3569s
 25821  5390 24139.4789   29  336 20766.9369 25084.9407  20.8%  4658 3600s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 781
  Mixing: 1
  Flow cover: 2029
  RLT: 20
  Relax-and-lift: 125

Explored 26329 nodes (122537142 simplex iterations) in 3600.03 seconds (11690.74 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20766.9 20727.8 20722.7 ... 20435.2

Time limit reached
Best objective 2.076693690879e+04, best bound 2.506829077937e+04, gap 20.7125%
  WARNING: Time limit reached. Using best solution found (gap: 20.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 20766.94, θ = 168248.68
  Upper Bound (UB) = 20766.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168248.68
  [DEBUG]   ✓ Scenario 0: θ = 168248.68 ≤ Q = 168248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168248.68 ≤ Q = 168248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168248.68 ≤ Q = 168248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168248.68 ≤ Q = 168248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168248.68 ≤ Q = 168248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168248.68 ≤ Q = 168248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168248.68 ≤ Q = 168248.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2a745747
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd58ba8b9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.357631e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6920002.2950
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.438552e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143855.20    0  123 6920002.30 -143855.20   102%     -    0s
H    0     0                    -108389.2204 -143855.20  32.7%     -    0s
H    0     0                    -109655.7112 -143855.20  31.2%     -    0s
H    0     0                    -123425.9273 -124979.60  1.26%     -    0s
     0     0 -124979.60    0   53 -123425.93 -124979.60  1.26%     -    0s
H    0     0                    -123690.0028 -124898.64  0.98%     -    0s
     0     0 -124236.57    0   54 -123690.00 -124236.57  0.44%     -    0s
H    0     0                    -123713.8673 -124220.83  0.41%     -    0s
     0     0 -123874.79    0   14 -123713.87 -123874.79  0.13%     -    0s
     0     0 -123874.73    0   13 -123713.87 -123874.73  0.13%     -    0s
H    0     0                    -123755.2914 -123865.66  0.09%     -    0s
     0     0 -123865.66    0   12 -123755.29 -123865.66  0.09%     -    0s
     0     0 -123857.22    0    9 -123755.29 -123857.22  0.08%     -    0s
     0     0 -123857.22    0   15 -123755.29 -123857.22  0.08%     -    0s
H    0     0                    -123821.3432 -123857.22  0.03%     -    0s
     0     0          -    0      -123821.34 -123832.93  0.01%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 2
  Flow cover: 13
  Relax-and-lift: 3

Explored 1 nodes (617 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -123821 -123755 -123714 ... 1.35763e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.238213431713e+05, best bound -1.238329274941e+05, gap 0.0094%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 156327.04
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123821.34
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -123821.34 = 156327.04
  [DEBUG]   Current θ from Master = 168248.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11921.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8845.29
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 768.1167, Absolute Gap = 768.1167, Relative Gap = 0.036987
  Not converged yet (gap = 768.12 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394679 nonzeros
Model fingerprint: 0x2fb123f0
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61003 rows and 24773 columns
Presolve time: 1.11s
Presolved: 77990 rows, 33647 columns, 478286 nonzeros
Variable types: 31388 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -361254.7791
Found heuristic solution: objective -214770.4678

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77990 rows, 33647 columns, 478286 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34542   -4.5836872e+04   0.000000e+00   1.256046e+09      5s
   47106    4.1702682e+03   0.000000e+00   4.706591e+08     10s
   57454    2.2009023e+04   0.000000e+00   9.483449e+06     15s
   64266    2.4722934e+04   0.000000e+00   6.677171e+06     20s
   71349    2.8046994e+04   0.000000e+00   3.827731e+07     25s
   78358    3.1523754e+04   0.000000e+00   3.702278e+06     30s
   83504    3.1868825e+04   0.000000e+00   1.604131e+06     35s
   89228    3.2170231e+04   0.000000e+00   1.781156e+06     40s
   94108    3.2727019e+04   0.000000e+00   3.294954e+07     45s
   99076    3.6710672e+04   0.000000e+00   1.696439e+07     50s
  104836    4.0255549e+04   0.000000e+00   9.275153e+07     55s
Concurrent spin time: 2.04s

Solved with dual simplex

Root relaxation: objective 4.860959e+04, 76800 iterations, 59.04 seconds (115.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48609.5857    0   99 -214770.47 48609.5857   123%     -   60s
H    0     0                    -203134.2382 48609.5857   124%     -   60s
H    0     0                    -131101.4099 48609.5857   137%     -   61s
H    0     0                    -53399.49381 48609.5857   191%     -   61s
H    0     0                    -5191.389975 48609.5857  1036%     -   61s
H    0     0                    11262.859578 48609.5857   332%     -   61s
H    0     0                    11298.372056 48609.5857   330%     -   61s
H    0     0                    11457.589642 48609.5857   324%     -   61s
H    0     0                    11473.813252 48609.5857   324%     -   61s
H    0     0                    11567.741708 48609.5857   320%     -   61s
H    0     0                    11821.582818 48609.5857   311%     -   61s
H    0     0                    17323.611791 48609.5857   181%     -   62s
H    0     0                    17714.804369 48609.5857   174%     -   62s
H    0     0                    17865.643767 48609.5857   172%     -   62s
     0     0 45103.9431    0  378 17865.6438 45103.9431   152%     -   77s
     0     0 44285.3247    0  434 17865.6438 44285.3247   148%     -   84s
     0     0 44285.3247    0  433 17865.6438 44285.3247   148%     -   85s
     0     0 44285.3247    0  463 17865.6438 44285.3247   148%     -   85s
     0     0 44285.3247    0  464 17865.6438 44285.3247   148%     -   85s
     0     0 41035.0972    0  354 17865.6438 41035.0972   130%     -  102s
     0     0 40397.7599    0  370 17865.6438 40397.7599   126%     -  113s
     0     0 40321.7452    0  380 17865.6438 40321.7452   126%     -  117s
     0     0 40226.1523    0  377 17865.6438 40226.1523   125%     -  121s
     0     0 40117.8754    0  430 17865.6438 40117.8754   125%     -  126s
     0     0 39973.0861    0  434 17865.6438 39973.0861   124%     -  132s
     0     0 39922.7602    0  390 17865.6438 39922.7602   123%     -  136s
     0     0 39865.3596    0  444 17865.6438 39865.3596   123%     -  141s
     0     0 39851.0726    0  457 17865.6438 39851.0726   123%     -  143s
     0     0 39848.2630    0  458 17865.6438 39848.2630   123%     -  144s
     0     0 39839.1022    0  397 17865.6438 39839.1022   123%     -  145s
     0     0 39838.5994    0  399 17865.6438 39838.5994   123%     -  145s
     0     0 37898.8685    0  382 17865.6438 37898.8685   112%     -  174s
     0     0 37621.5807    0  397 17865.6438 37621.5807   111%     -  185s
     0     0 37453.9776    0  502 17865.6438 37453.9776   110%     -  193s
     0     0 37389.0700    0  433 17865.6438 37389.0700   109%     -  199s
     0     0 37353.7127    0  448 17865.6438 37353.7127   109%     -  203s
     0     0 37316.1737    0  421 17865.6438 37316.1737   109%     -  206s
     0     0 37296.3486    0  424 17865.6438 37296.3486   109%     -  210s
     0     0 37289.1518    0  501 17865.6438 37289.1518   109%     -  211s
     0     0 37282.5502    0  422 17865.6438 37282.5502   109%     -  212s
     0     0 37267.1292    0  511 17865.6438 37267.1292   109%     -  215s
     0     0 37264.8723    0  514 17865.6438 37264.8723   109%     -  215s
     0     0 37262.6356    0  445 17865.6438 37262.6356   109%     -  216s
     0     0 37258.5216    0  318 17865.6438 37258.5216   109%     -  217s
     0     0 37252.4827    0  320 17865.6438 37252.4827   109%     -  218s
     0     0 37252.0989    0  445 17865.6438 37252.0989   109%     -  218s
     0     0 36837.6883    0  402 17865.6438 36837.6883   106%     -  235s
     0     0 36655.9148    0  386 17865.6438 36655.9148   105%     -  241s
     0     0 36556.9322    0  400 17865.6438 36556.9322   105%     -  245s
     0     0 36536.1415    0  408 17865.6438 36536.1415   105%     -  248s
     0     0 36519.0350    0  406 17865.6438 36519.0350   104%     -  250s
     0     0 36496.7011    0  407 17865.6438 36496.7011   104%     -  253s
     0     0 36487.3367    0  407 17865.6438 36487.3367   104%     -  254s
     0     0 36483.6654    0  409 17865.6438 36483.6654   104%     -  255s
     0     0 36478.3070    0  411 17865.6438 36478.3070   104%     -  256s
     0     0 36475.7816    0  411 17865.6438 36475.7816   104%     -  257s
     0     0 36471.8543    0  412 17865.6438 36471.8543   104%     -  258s
     0     0 36470.3365    0  414 17865.6438 36470.3365   104%     -  259s
     0     0 36404.7549    0  470 17865.6438 36404.7549   104%     -  265s
     0     0 36365.3217    0  474 17865.6438 36365.3217   104%     -  269s
     0     0 36332.7757    0  471 17865.6438 36332.7757   103%     -  273s
     0     0 36324.3349    0  477 17865.6438 36324.3349   103%     -  275s
     0     0 36318.2010    0  413 17865.6438 36318.2010   103%     -  278s
     0     0 36314.3028    0  413 17865.6438 36314.3028   103%     -  279s
     0     0 36312.9278    0  413 17865.6438 36312.9278   103%     -  280s
     0     0 36280.2566    0  401 17865.6438 36280.2566   103%     -  283s
H    0     0                    18090.240083 36279.1443   101%     -  286s
     0     0 36265.1970    0  411 18090.2401 36265.1970   100%     -  289s
     0     0 36258.5819    0  419 18090.2401 36258.5819   100%     -  290s
     0     0 36235.6282    0  415 18090.2401 36235.6282   100%     -  293s
     0     0 36231.9889    0  411 18090.2401 36231.9889   100%     -  293s
     0     0 36229.5660    0  412 18090.2401 36229.5660   100%     -  294s
     0     0 36229.1920    0  408 18090.2401 36229.1920   100%     -  295s
     0     0 36194.5511    0  415 18090.2401 36194.5511   100%     -  299s
     0     0 36184.8459    0  420 18090.2401 36184.8459   100%     -  301s
     0     0 36181.8830    0  481 18090.2401 36181.8830   100%     -  303s
     0     0 36180.1119    0  477 18090.2401 36180.1119   100%     -  304s
     0     0 36178.8157    0  482 18090.2401 36178.8157   100%     -  305s
     0     0 36125.5226    0  428 18090.2401 36125.5226   100%     -  308s
H    0     0                    19997.814959 36125.4532  80.6%     -  312s
     0     0 36099.3784    0  427 19997.8150 36099.3784  80.5%     -  315s
     0     0 36088.6539    0  428 19997.8150 36088.6539  80.5%     -  316s
     0     0 36084.9065    0  428 19997.8150 36084.9065  80.4%     -  316s
     0     0 36082.7642    0  432 19997.8150 36082.7642  80.4%     -  317s
     0     0 36080.2770    0  425 19997.8150 36080.2770  80.4%     -  318s
     0     0 36079.6431    0  424 19997.8150 36079.6431  80.4%     -  319s
     0     0 36073.1957    0  432 19997.8150 36073.1957  80.4%     -  321s
H    0     0                    20015.593190 36073.0469  80.2%     -  321s
     0     0 36072.6226    0  429 20015.5932 36072.6226  80.2%     -  321s
     0     0 36066.1479    0  423 20015.5932 36066.1479  80.2%     -  323s
H    0     0                    20059.784782 36064.3447  79.8%     -  327s
H    0     0                    20478.199048 36064.3447  76.1%     -  329s
H    0     0                    20517.959672 36064.3447  75.8%     -  329s
     0     0 36063.7976    0  428 20517.9597 36063.7976  75.8%     -  330s
     0     0 36061.6264    0  490 20517.9597 36061.6264  75.8%     -  331s
     0     0 36060.4136    0  489 20517.9597 36060.4136  75.8%     -  332s
     0     0 36057.7388    0  427 20517.9597 36057.7388  75.7%     -  333s
     0     0 36057.4863    0  423 20517.9597 36057.4863  75.7%     -  334s
     0     0 36053.7467    0  426 20517.9597 36053.7467  75.7%     -  335s
     0     0 36053.5317    0  426 20517.9597 36053.5317  75.7%     -  337s
H    0     0                    20563.809196 36053.5317  75.3%     -  381s
     0     2 36053.5317    0  426 20563.8092 36053.5317  75.3%     -  417s
     1     4 35803.7353    1  344 20563.8092 36053.5317  75.3%  6057  422s
     3     8 35365.9010    2  396 20563.8092 35893.6800  74.5%  6899  434s
     7    16 35005.2477    3  548 20563.8092 35364.7816  72.0%  9635  448s
    15    32 34930.1316    4  549 20563.8092 34988.8256  70.1% 10661  460s
    31    48 33437.9923    5  489 20563.8092 34929.4918  69.9% 13711  490s
    47    79 32208.9296    6  386 20563.8092 34929.4918  69.9% 15892  511s
    78   153 31899.0096    7  393 20563.8092 34929.4918  69.9% 12900  545s
   152   185 31132.1872    9  361 20563.8092 34929.4918  69.9%  9340  568s
   184   217 31213.0635    9  393 20563.8092 34929.4918  69.9%  8403  603s
   216   250 31358.7895    8  359 20563.8092 34929.4918  69.9%  7928  614s
   249   286 31077.6049   10  362 20563.8092 34929.4918  69.9%  7439  624s
   285   319 30668.3396   10  295 20563.8092 34929.4918  69.9%  6992  638s
   318   351 30963.5667   10  378 20563.8092 34929.4918  69.9%  6674  650s
   350   384 30424.9372   10  304 20563.8092 34929.4918  69.9%  6343  663s
   383   416 30903.6380   11  369 20563.8092 34929.4918  69.9%  6057  674s
   415   448 30186.6071   11  286 20563.8092 34929.4918  69.9%  5836  685s
   447   479 30853.6945   11  372 20563.8092 34929.4918  69.9%  5623  699s
   478   510 30636.3635   11  283 20563.8092 34929.4918  69.9%  5456  714s
H  499   510                    20622.377205 34929.4918  69.4%  5361  714s
   509   632 30590.4998   11  292 20622.3772 34929.4918  69.4%  5325  730s
   634   663 30464.4306   14  366 20622.3772 34929.4918  69.4%  4767  740s
H  636   663                    20640.155436 34929.4918  69.2%  4768  740s
   667   761 28376.0010   13  347 20640.1554 34929.4918  69.2%  4683  754s
   779   856 30377.4510   14  354 20640.1554 34929.4918  69.2%  4347  766s
   901   951 30336.4821   15  342 20640.1554 34929.4918  69.2%  4024  779s
  1030  1066 30250.6255   16  366 20640.1554 34929.4918  69.2%  3759  799s
  1175  1176 29894.0118   18  402 20640.1554 34929.4918  69.2%  3501  812s
  1312  1286 29884.7571   19  400 20640.1554 34929.4918  69.2%  3321  825s
  1456  1387 26472.2356   19  351 20640.1554 34929.4918  69.2%  3182  838s
  1599  1436 25953.9746   22  407 20640.1554 34929.4918  69.2%  3067  852s
  1715  1461 29177.9323   22  393 20640.1554 34929.4918  69.2%  3027  865s
  1760  1500 28994.4563   23  375 20640.1554 34929.4918  69.2%  3037  878s
  1820  1538 28381.5239   26  379 20640.1554 34929.4918  69.2%  3076  892s
  1898  1597 26558.2009   27  346 20640.1554 34929.4918  69.2%  3073  907s
  1991  1679 27853.0712   28  504 20640.1554 34929.4918  69.2%  3070  927s
  2089  1777 27414.1717   31  455 20640.1554 34929.4918  69.2%  3065  942s
  2265  1889 26653.8107   33  324 20640.1554 34871.5266  68.9%  3005  959s
  2455  1949 26586.7795   35  385 20640.1554 34871.5266  68.9%  2936  985s
  2597  2063 26347.4093   37  373 20640.1554 34325.8048  66.3%  2930 1003s
H 2640  2062                    20679.588709 34322.2909  66.0%  2933 1003s
  2776  2135 25484.8597   44  285 20679.5887 34322.2909  66.0%  2885 1022s
  2941  2185 24786.8440   44  361 20679.5887 33517.5502  62.1%  2891 1039s
  3011  2298 25270.8462   47  131 20679.5887 33516.6318  62.1%  2918 1056s
  3149  2406 25021.1541   50  196 20679.5887 33516.6318  62.1%  2921 1075s
  3284  2522 24688.2081   51  302 20679.5887 33061.5837  59.9%  2935 1095s
  3442  2603 23340.8544   56  202 20679.5887 33061.5837  59.9%  2947 1116s
  3601  2709 22838.6377   61  120 20679.5887 32963.9628  59.4%  2966 1139s
  3768  2710 25124.5625   44  426 20679.5887 32927.8175  59.2%  2994 1297s
  3770  2711 27819.0760   46   99 20679.5887 32927.8175  59.2%  2993 1346s
  3771  2712 29844.9052   21  349 20679.5887 32927.8175  59.2%  2992 1374s
  3772  2713 23521.7446   12  482 20679.5887 32927.8175  59.2%  2991 1397s
  3773  2713 21017.5198   41  381 20679.5887 32927.8175  59.2%  2990 1422s
  3774  2714 22070.7500   67  457 20679.5887 32927.8175  59.2%  2990 1433s
  3775  2715 25562.2511   59  439 20679.5887 32927.8175  59.2%  2989 1444s
  3776  2715 24130.7839   53  409 20679.5887 32927.8175  59.2%  2988 1451s
  3778  2717 28005.5767   13  417 20679.5887 32927.8175  59.2%  2987 1458s
  3779  2717 22284.5608   54  409 20679.5887 32927.8175  59.2%  2986 1461s
  3781  2719 28259.3105   11  430 20679.5887 32927.8175  59.2%  2984 1467s
  3782  2719 28521.2735   20  432 20679.5887 32927.8175  59.2%  2983 1470s
  3783  2720 21728.4981   57  478 20679.5887 32927.8175  59.2%  2983 1478s
  3784  2721 27220.8890   26  476 20679.5887 32927.8175  59.2%  2982 1481s
  3786  2722 21293.0016   23  534 20679.5887 32927.8175  59.2%  2980 1490s
  3788  2723 23767.6769   32  440 20679.5887 32927.8175  59.2%  2979 1495s
  3789  2724 24434.5125   34  426 20679.5887 32927.8175  59.2%  2978 1501s
  3791  2725 22839.1518   35  445 20679.5887 32927.8175  59.2%  2976 1509s
  3792  2726 24969.1839   46  443 20679.5887 32927.8175  59.2%  2976 1512s
  3793  2727 29238.2777   12  489 20679.5887 32927.8175  59.2%  2975 1522s
  3794  2727 21868.2758   59  485 20679.5887 32927.8175  59.2%  2974 1525s
  3796  2729 28635.5526   16  442 20679.5887 32927.8175  59.2%  2972 1534s
  3797  2729 25542.5231   16  500 20679.5887 32927.8175  59.2%  2972 1538s
  3798  2730 25023.1731   24  493 20679.5887 32927.8175  59.2%  2971 1545s
  3800  2731 28074.3071   17  490 20679.5887 32927.8175  59.2%  2969 1554s
  3801  2732 31482.8118    7  490 20679.5887 32927.8175  59.2%  2968 1557s
  3802  2733 25945.7214   37  425 20679.5887 32927.8175  59.2%  2968 1562s
  3804  2734 26643.1794   38  436 20679.5887 32927.8175  59.2%  2966 1567s
  3805  2735 29707.7362   16  436 20679.5887 32927.8175  59.2%  2965 1645s
  3806  2735 24584.5795   38  436 20679.5887 32927.8175  59.2%  2965 1682s
  3807  2739 32927.8175   14  424 20679.5887 32927.8175  59.2%  3048 1737s
  3809  2742 32927.8175   15  420 20679.5887 32927.8175  59.2%  3049 1757s
  3813  2749 32927.8175   16  478 20679.5887 32927.8175  59.2%  3057 1775s
  3821  2762 32927.8175   17  482 20679.5887 32927.8175  59.2%  3073 1798s
  3837  2773 32338.0726   18  464 20679.5887 32927.8175  59.2%  3124 1827s
  3853  2796 31618.9642   19  400 20679.5887 32927.8175  59.2%  3204 1851s
  3885  2827 29871.9433   20  460 20679.5887 32927.8175  59.2%  3234 1873s
  3955  2829 28048.6251   21  312 20679.5887 32927.8175  59.2%  3373 1897s
  3990  2859 27735.6336   22  384 20679.5887 32927.8175  59.2%  3404 1918s
  4041  2895 26154.3886   23  383 20679.5887 32927.8175  59.2%  3450 1935s
  4106  2928 24958.8292   23  314 20679.5887 32927.8175  59.2%  3473 1951s
  4189  2942 26262.7376   23  370 20679.5887 32927.8175  59.2%  3479 1966s
  4278  2937 25241.6756   23  319 20679.5887 32927.8175  59.2%  3475 1981s
  4346  2929 24932.1716   24  244 20679.5887 32927.8175  59.2%  3479 1994s
  4379  2933 22861.1326   25  374 20679.5887 32927.8175  59.2%  3486 2008s
  4417  2935 25255.0097   24  357 20679.5887 32927.8175  59.2%  3495 2023s
  4453  2934 23402.3352   30  253 20679.5887 32927.8175  59.2%  3498 2035s
  4493  2933 infeasible   24      20679.5887 32927.8175  59.2%  3497 2047s
  4531  2942 24382.2352   25  349 20679.5887 32927.8175  59.2%  3506 2059s
  4575  2945 22061.4102   26  266 20679.5887 32927.8175  59.2%  3515 2073s
  4619  2954 21964.8558   26  300 20679.5887 32927.8175  59.2%  3522 2085s
  4673  2948 21052.3507   27  294 20679.5887 32927.8175  59.2%  3518 2101s
  4724  2942 infeasible   27      20679.5887 32927.8175  59.2%  3521 2116s
  4785  2940     cutoff   29      20679.5887 32927.8175  59.2%  3530 2133s
  4834  2933 30111.2285   21  259 20679.5887 32927.8175  59.2%  3531 2150s
  4897  2924 29978.4377   22  212 20679.5887 32927.8175  59.2%  3543 2165s
  4951  2947 29833.1035   23  206 20679.5887 32927.8175  59.2%  3563 2185s
  5014  2969 28550.5568   24  195 20679.5887 32927.8175  59.2%  3575 2207s
  5100  2986 28128.3562   25  169 20679.5887 32927.8175  59.2%  3593 2229s
  5187  2979 26032.9421   27  268 20679.5887 32927.8175  59.2%  3609 2246s
  5221  2981     cutoff   28      20679.5887 32927.8175  59.2%  3614 2267s
  5264  2988 infeasible   29      20679.5887 32927.8175  59.2%  3624 2287s
  5321  3000 21013.7318   30   67 20679.5887 32927.8175  59.2%  3630 2306s
  5387  3016     cutoff   31      20679.5887 32927.8175  59.2%  3633 2325s
  5470  3040 25587.4509   31  209 20679.5887 32927.8175  59.2%  3636 2345s
  5564  3051     cutoff   32      20679.5887 32927.8175  59.2%  3638 2366s
  5682  3042     cutoff   34      20679.5887 32927.8175  59.2%  3640 2388s
  5789  3066 infeasible   36      20679.5887 32927.8175  59.2%  3652 2412s
  5934  3096 22639.5854   39  100 20679.5887 32646.3036  57.9%  3659 2437s
  6052  3149     cutoff   41      20679.5887 32189.2216  55.7%  3679 2464s
  6216  3171 21216.4961   42  126 20679.5887 31650.6636  53.1%  3676 2490s
  6352  3210 27597.6502   22  377 20679.5887 31650.6636  53.1%  3696 2517s
  6505  3224 26473.4974   24  330 20679.5887 31650.6636  53.1%  3708 2551s
  6687  3221 26880.5372   24  386 20679.5887 31650.6636  53.1%  3710 2579s
  6870  3207 26205.1373   27  373 20679.5887 31585.8437  52.7%  3722 2605s
  7026  3241 25002.0146   28  356 20679.5887 31585.8437  52.7%  3729 2634s
  7210  3299 24120.2684   26  401 20679.5887 31585.8437  52.7%  3740 2667s
  7445  3305 20960.3862   33  153 20679.5887 31585.8437  52.7%  3729 2704s
  7661  3286     cutoff   33      20679.5887 31585.8437  52.7%  3729 2740s
  7883  3330 22662.1767   26  300 20679.5887 31585.8437  52.7%  3735 2777s
  8070  3362 21246.6441   30  282 20679.5887 29208.3820  41.2%  3756 2811s
  8270  3383 infeasible   29      20679.5887 29152.3607  41.0%  3762 2849s
  8530  3386 26175.8743   25  265 20679.5887 29062.4530  40.5%  3767 2903s
  8763  3440 22091.5333   35  205 20679.5887 28962.2438  40.1%  3790 2942s
  9079  3493 infeasible   36      20679.5887 28794.3383  39.2%  3786 2982s
  9399  3456 21864.2358   27  277 20679.5887 28719.1393  38.9%  3787 3026s
  9684  3436 infeasible   30      20679.5887 28624.4107  38.4%  3803 3072s
 10014  3428 23779.9850   24  348 20679.5887 28458.5036  37.6%  3817 3117s
 10330  3436     cutoff   29      20679.5887 28398.6021  37.3%  3826 3164s
 10663  3488 infeasible   27      20679.5887 28052.4816  35.7%  3843 3217s
 11003  3515 24599.0471   32  185 20679.5887 27977.0032  35.3%  3848 3267s
 11392  3477 22556.2919   30  257 20679.5887 27931.8615  35.1%  3856 3326s
 11750  3436 21284.9582   26  351 20679.5887 27806.9192  34.5%  3879 3414s
 12140  3410 21027.5072   26  346 20679.5887 27774.6956  34.3%  3889 3472s
 12576  3518 22768.3390   29  303 20679.5887 27527.5183  33.1%  3881 3535s
 12999  3598     cutoff   33      20679.5887 27373.0854  32.4%  3898 3598s
 13461  3585 infeasible   27      20679.5887 27332.4212  32.2%  3908 3600s

Cutting planes:
  Gomory: 2
  Projected implied bound: 48
  MIR: 861
  Flow cover: 2116
  RLT: 33
  Relax-and-lift: 168

Explored 13480 nodes (52991349 simplex iterations) in 3600.03 seconds (10574.84 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20679.6 20640.2 20622.4 ... 18090.2

Time limit reached
Best objective 2.067958870910e+04, best bound 2.733242119267e+04, gap 32.1710%
  WARNING: Time limit reached. Using best solution found (gap: 32.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 20679.59, θ = 167001.02
  Upper Bound (UB) = 20679.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167001.02
  [DEBUG]   ✓ Scenario 0: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 167001.02 ≤ Q = 167001.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 167001.02 ≤ Q = 167001.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x491fcb0c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb6e034f4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.335345e+13
Presolve removed 2581 rows and 1873 columns
Presolve time: 0.00s
Presolved: 512 rows, 516 columns, 1444 nonzeros
Found heuristic solution: objective 6778203.9932
Variable types: 350 continuous, 166 integer (166 binary)

Root relaxation: objective -1.452694e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145269.38    0  123 6778203.99 -145269.38   102%     -    0s
H    0     0                    -109763.7713 -145269.38  32.3%     -    0s
H    0     0                    -111021.5413 -145269.38  30.8%     -    0s
     0     0 -121482.00    0   60 -111021.54 -121482.00  9.42%     -    0s
H    0     0                    -119874.9532 -121457.36  1.32%     -    0s
     0     0 -121187.51    0   60 -119874.95 -121187.51  1.09%     -    0s
H    0     0                    -120719.7468 -121149.91  0.36%     -    0s
H    0     0                    -120734.7451 -121149.91  0.34%     -    0s
H    0     0                    -120734.8246 -121149.91  0.34%     -    0s
     0     0 -121016.91    0   35 -120734.82 -121016.91  0.23%     -    0s
     0     0 -120970.58    0   20 -120734.82 -120970.58  0.20%     -    0s
     0     0 -120956.17    0   18 -120734.82 -120956.17  0.18%     -    0s
     0     0 -120901.06    0   17 -120734.82 -120901.06  0.14%     -    0s
     0     0 -120893.60    0   16 -120734.82 -120893.60  0.13%     -    0s
     0     0 -120808.52    0    9 -120734.82 -120808.52  0.06%     -    0s
     0     0 -120793.52    0    8 -120734.82 -120793.52  0.05%     -    0s
H    0     0                    -120764.2406 -120764.24  0.00%     -    0s
     0     0          -    0      -120764.24 -120764.24  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 1
  Flow cover: 6
  Relax-and-lift: 4

Explored 1 nodes (606 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -120764 -120735 -120720 ... 1.33534e+13
No other solutions better than -120764

Optimal solution found (tolerance 1.00e-04)
Best objective -1.207642405696e+05, best bound -1.207642405696e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 159384.14
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120764.24
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -120764.24 = 159384.14
  [DEBUG]   Current θ from Master = 167001.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7616.88 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13062.71
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 680.7685, Absolute Gap = 680.7685, Relative Gap = 0.032920
  Not converged yet (gap = 680.77 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437919 nonzeros
Model fingerprint: 0xdf3adc02
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67790 rows and 27530 columns
Presolve time: 1.26s
Presolved: 86493 rows, 37130 columns, 528309 nonzeros
Variable types: 34871 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362996.9195
Found heuristic solution: objective -214770.4678

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.674e+06
 Factor NZ  : 7.911e+06 (roughly 110 MB of memory)
 Factor Ops : 1.333e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.56175338e+07  1.59879012e+08  8.77e+04 2.52e+01  6.74e+04     2s
   1  -1.16258059e+07  1.40835235e+08  6.01e+04 5.22e+01  4.58e+04     2s
   2  -3.90534874e+06  1.05676029e+08  2.02e+04 1.08e-11  1.63e+04     3s
   3  -7.25869086e+05  7.20360120e+07  1.39e+03 8.66e-01  1.49e+03     3s
   4  -4.55295019e+05  3.38953082e+07  3.22e+02 3.09e-01  4.29e+02     3s
   5  -3.45176454e+05  2.12096169e+07  1.03e+02 1.68e-01  1.97e+02     3s
   6  -2.76286331e+05  1.46721455e+07  4.43e+01 1.09e-01  1.17e+02     3s
   7  -1.46867277e+05  1.21004593e+07  1.17e+01 8.72e-02  8.25e+01     3s
   8  -1.08485540e+05  6.04380295e+06  6.19e+00 4.17e-02  4.04e+01     3s
   9  -7.16408898e+04  3.06295871e+06  2.93e+00 2.03e-02  2.02e+01     3s
  10  -3.57088036e+04  1.20146659e+06  1.12e+00 7.53e-03  7.86e+00     3s
  11  -4.47155858e+03  4.20742291e+05  4.29e-01 2.53e-03  2.69e+00     3s
  12   2.46222833e+03  2.20397478e+05  3.19e-01 1.51e-03  1.38e+00     3s
  13   8.26190990e+03  1.65257752e+05  2.44e-01 1.02e-03  9.92e-01     3s
  14   1.32906987e+04  1.27611549e+05  1.90e-01 1.21e-03  7.22e-01     3s
  15   1.79469974e+04  1.10192189e+05  1.51e-01 1.80e-03  5.82e-01     3s
  16   2.49799357e+04  9.54049786e+04  1.12e-01 1.51e-03  4.44e-01     3s
  17   2.73605978e+04  8.46443745e+04  9.93e-02 1.65e-03  3.62e-01     3s
  18   2.84436000e+04  7.95607853e+04  9.31e-02 1.27e-03  3.23e-01     3s
  19   3.02127622e+04  7.56462678e+04  8.34e-02 1.37e-03  2.87e-01     3s
  20   3.47529733e+04  6.85822266e+04  5.94e-02 1.34e-03  2.13e-01     3s
  21   3.71780697e+04  6.39866136e+04  4.82e-02 1.44e-03  1.69e-01     3s
  22   3.78045956e+04  6.19206612e+04  4.51e-02 1.66e-03  1.52e-01     3s
  23   3.95459033e+04  6.05448220e+04  3.69e-02 1.63e-03  1.32e-01     3s
  24   4.15603723e+04  5.61855844e+04  2.81e-02 1.59e-03  9.23e-02     3s
  25   4.28611188e+04  5.31677601e+04  2.25e-02 1.45e-03  6.50e-02     3s
  26   4.37600443e+04  5.21726941e+04  1.89e-02 1.10e-03  5.31e-02     3s
  27   4.43540539e+04  5.10015862e+04  1.66e-02 7.13e-04  4.20e-02     3s
  28   4.49819675e+04  5.04326036e+04  1.42e-02 5.33e-04  3.44e-02     3s
  29   4.55190275e+04  5.00423623e+04  1.21e-02 3.95e-04  2.86e-02     4s
  30   4.60118145e+04  4.96861481e+04  1.02e-02 2.97e-04  2.32e-02     4s
  31   4.64971127e+04  4.94243463e+04  8.30e-03 2.14e-04  1.85e-02     4s
  32   4.68455774e+04  4.93122603e+04  7.01e-03 2.34e-04  1.56e-02     4s
  33   4.69737198e+04  4.92373319e+04  6.52e-03 2.04e-04  1.43e-02     4s
  34   4.74083736e+04  4.91221886e+04  4.93e-03 1.58e-04  1.08e-02     4s
  35   4.76025005e+04  4.90365256e+04  4.19e-03 1.16e-04  9.06e-03     4s
  36   4.77046800e+04  4.90023451e+04  3.83e-03 1.02e-04  8.20e-03     4s
  37   4.77418554e+04  4.89724984e+04  3.70e-03 9.00e-05  7.77e-03     4s
  38   4.78862983e+04  4.89560121e+04  3.17e-03 8.33e-05  6.76e-03     4s
  39   4.79613919e+04  4.89257648e+04  2.90e-03 7.13e-05  6.09e-03     4s
  40   4.80215521e+04  4.88969864e+04  2.67e-03 5.97e-05  5.53e-03     4s
  41   4.80873561e+04  4.88576473e+04  2.43e-03 3.64e-05  4.87e-03     4s
  42   4.81721000e+04  4.88394911e+04  2.11e-03 3.13e-05  4.22e-03     4s
  43   4.82786693e+04  4.88181582e+04  1.72e-03 2.41e-05  3.41e-03     4s
  44   4.83355383e+04  4.88023368e+04  1.50e-03 1.90e-05  2.95e-03     4s
  45   4.83915076e+04  4.87986959e+04  1.30e-03 1.76e-05  2.57e-03     4s
  46   4.84644598e+04  4.87898427e+04  1.03e-03 1.48e-05  2.06e-03     4s
  47   4.84939245e+04  4.87783760e+04  9.21e-04 1.11e-05  1.80e-03     4s
  48   4.85479866e+04  4.87685232e+04  7.10e-04 7.99e-06  1.39e-03     4s
  49   4.85636740e+04  4.87649504e+04  6.50e-04 6.84e-06  1.27e-03     4s
  50   4.85747128e+04  4.87638389e+04  6.10e-04 6.44e-06  1.20e-03     5s
  51   4.86268675e+04  4.87550394e+04  4.04e-04 3.89e-06  8.10e-04     5s
  52   4.86523504e+04  4.87488571e+04  3.10e-04 2.38e-06  6.10e-04     5s
  53   4.86841576e+04  4.87475316e+04  1.98e-04 1.99e-06  4.00e-04     5s
  54   4.86910453e+04  4.87469256e+04  1.75e-04 1.80e-06  3.53e-04     5s
  55   4.87031724e+04  4.87458698e+04  1.30e-04 1.53e-06  2.70e-04     5s
  56   4.87088617e+04  4.87439876e+04  1.10e-04 9.97e-07  2.22e-04     5s
  57   4.87128870e+04  4.87427245e+04  9.50e-05 6.18e-07  1.89e-04     5s
  58   4.87225325e+04  4.87424971e+04  6.27e-05 5.35e-07  1.26e-04     5s
  59   4.87261463e+04  4.87418894e+04  4.93e-05 3.84e-07  9.95e-05     5s
  60   4.87322738e+04  4.87414201e+04  2.67e-05 2.66e-07  5.78e-05     5s
  61   4.87353202e+04  4.87411180e+04  1.62e-05 1.91e-07  3.66e-05     5s
  62   4.87367477e+04  4.87408677e+04  1.15e-05 1.39e-07  2.60e-05     5s
  63   4.87370445e+04  4.87408493e+04  1.05e-05 1.33e-07  2.40e-05     5s
  64   4.87371700e+04  4.87408393e+04  1.01e-05 1.31e-07  2.32e-05     5s
  65   4.87377036e+04  4.87407733e+04  8.31e-06 1.17e-07  1.94e-05     5s
  66   4.87380600e+04  4.87406187e+04  7.16e-06 8.11e-08  1.62e-05     5s
  67   4.87382904e+04  4.87405094e+04  6.43e-06 3.26e-07  1.40e-05     5s
  68   4.87388411e+04  4.87404084e+04  4.67e-06 1.14e-07  9.90e-06     5s
  69   4.87389303e+04  4.87403676e+04  4.31e-06 8.38e-08  9.08e-06     5s
  70   4.87394748e+04  4.87403351e+04  2.50e-06 7.81e-08  5.44e-06     5s
  71   4.87397067e+04  4.87402955e+04  1.78e-06 5.68e-09  3.72e-06     6s
  72   4.87397101e+04  4.87402952e+04  1.78e-06 1.01e-08  3.70e-06     6s
  73   4.87397443e+04  4.87402805e+04  1.59e-06 5.10e-09  3.39e-06     6s
  74   4.87400243e+04  4.87402719e+04  8.17e-07 1.24e-08  1.56e-06     6s
  75   4.87402232e+04  4.87402687e+04  1.19e-07 3.16e-08  2.87e-07     6s
  76   4.87402520e+04  4.87402651e+04  8.18e-07 3.04e-07  8.45e-08     6s
  77   4.87402563e+04  4.87402651e+04  2.30e-06 1.70e-06  5.65e-08     6s
  78   4.87402589e+04  4.87402650e+04  5.41e-06 1.85e-06  3.92e-08     6s
  79   4.87402635e+04  4.87402650e+04  1.27e-06 7.60e-07  9.11e-09     6s
  80   4.87402641e+04  4.87402650e+04  7.37e-07 3.92e-07  5.28e-09     6s
  81   4.87402643e+04  4.87402650e+04  7.56e-07 3.08e-07  4.39e-09     6s
  82   4.87402646e+04  4.87402650e+04  3.84e-07 1.48e-07  2.23e-09     6s

Barrier solved model in 82 iterations and 6.01 seconds (11.49 work units)
Optimal objective 4.87402646e+04


Root crossover log...

   74870 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

   14645 PPushes remaining with PInf 1.1204306e-04                 9s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2153339e+04     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54859    4.8740265e+04   0.000000e+00   1.215334e+04     10s
   55859    4.8740265e+04   0.000000e+00   0.000000e+00     11s
   55859    4.8740265e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 1.67s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.874026e+04, 55859 iterations, 10.80 seconds (23.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48740.2650    0  239 -214770.47 48740.2650   123%     -   13s
H    0     0                    -210650.8464 48740.2650   123%     -   13s
H    0     0                    -143808.9236 48740.2650   134%     -   13s
H    0     0                    -135494.9156 48740.2650   136%     -   13s
H    0     0                    -63147.38321 48740.2650   177%     -   13s
H    0     0                    -30505.41949 48740.2650   260%     -   13s
H    0     0                    -27679.24244 48740.2650   276%     -   13s
H    0     0                    -26776.15423 48740.2650   282%     -   13s
H    0     0                    -4645.499381 48740.2650  1149%     -   14s
H    0     0                     572.3288940 48740.2650  8416%     -   14s
H    0     0                     628.6074814 48740.2650  7654%     -   14s
H    0     0                    3399.9372095 48740.2650  1334%     -   15s
H    0     0                    4084.2725729 48740.2650  1093%     -   15s
     0     0 44964.8402    0  474 4084.27257 44964.8402  1001%     -   48s
H    0     0                    8938.5132048 44964.8402   403%     -   48s
H    0     0                    9340.9700696 44964.8402   381%     -   48s
H    0     0                    9350.0711147 44964.8402   381%     -   48s
H    0     0                    9502.3862178 44964.8402   373%     -   48s
H    0     0                    9503.1830249 44964.8402   373%     -   48s
H    0     0                    9578.0674953 44964.8402   369%     -   48s
     0     0 44648.6281    0  457 9578.06750 44648.6281   366%     -   66s
     0     0 44379.0856    0  452 9578.06750 44379.0856   363%     -   84s
     0     0 44378.1683    0  471 9578.06750 44378.1683   363%     -   91s
     0     0 44378.1683    0  460 9578.06750 44378.1683   363%     -   93s
     0     0 44378.1683    0  464 9578.06750 44378.1683   363%     -   94s
     0     0 44378.1683    0  463 9578.06750 44378.1683   363%     -   96s
     0     0 44378.1683    0  466 9578.06750 44378.1683   363%     -   97s
     0     0 44378.1683    0  475 9578.06750 44378.1683   363%     -   98s
     0     0 44378.1683    0  466 9578.06750 44378.1683   363%     -   99s
     0     0 44378.1683    0  466 9578.06750 44378.1683   363%     -   99s
     0     0 40659.6864    0  385 9578.06750 40659.6864   325%     -  142s
     0     0 40183.0504    0  397 9578.06750 40183.0504   320%     -  159s
     0     0 40019.4385    0  386 9578.06750 40019.4385   318%     -  174s
     0     0 40004.7127    0  392 9578.06750 40004.7127   318%     -  181s
H    0     0                    10046.736127 39842.0065   297%     -  194s
H    0     0                    10200.028858 39842.0065   291%     -  194s
H    0     0                    10308.562897 39842.0065   286%     -  194s
H    0     0                    15474.638618 39842.0065   157%     -  194s
H    0     0                    15475.153878 39842.0065   157%     -  194s
H    0     0                    15991.960828 39842.0065   149%     -  194s
H    0     0                    16155.525352 39842.0065   147%     -  194s
H    0     0                    16492.677347 39842.0065   142%     -  194s
H    0     0                    16550.069978 39842.0065   141%     -  194s
H    0     0                    16553.197848 39842.0065   141%     -  194s
     0     0 39842.0065    0  411 16553.1978 39842.0065   141%     -  194s
     0     0 39791.2543    0  401 16553.1978 39791.2543   140%     -  200s
     0     0 39781.5192    0  401 16553.1978 39781.5192   140%     -  204s
     0     0 39779.0181    0  410 16553.1978 39779.0181   140%     -  206s
     0     0 39761.5793    0  404 16553.1978 39761.5793   140%     -  212s
     0     0 39749.9107    0  414 16553.1978 39749.9107   140%     -  216s
     0     0 39749.2825    0  409 16553.1978 39749.2825   140%     -  217s
     0     0 37925.6124    0  361 16553.1978 37925.6124   129%     -  263s
H    0     0                    16714.894028 37925.4142   127%     -  263s
H    0     0                    17299.619734 37925.4142   119%     -  263s
     0     0 37556.1920    0  443 17299.6197 37556.1920   117%     -  283s
     0     0 37470.1938    0  364 17299.6197 37470.1938   117%     -  292s
     0     0 37434.6818    0  371 17299.6197 37434.6818   116%     -  297s
     0     0 37381.4272    0  455 17299.6197 37381.4272   116%     -  305s
     0     0 37324.3285    0  366 17299.6197 37324.3285   116%     -  310s
     0     0 37317.6841    0  440 17299.6197 37317.6841   116%     -  313s
     0     0 37315.1722    0  440 17299.6197 37315.1722   116%     -  314s
     0     0 37309.5618    0  444 17299.6197 37309.5618   116%     -  315s
     0     0 37303.8409    0  442 17299.6197 37303.8409   116%     -  318s
     0     0 37299.7012    0  439 17299.6197 37299.7012   116%     -  320s
     0     0 37296.5021    0  452 17299.6197 37296.5021   116%     -  322s
     0     0 37296.2426    0  507 17299.6197 37296.2426   116%     -  323s
     0     0 36904.6900    0  386 17299.6197 36904.6900   113%     -  343s
     0     0 36717.8124    0  387 17299.6197 36717.8124   112%     -  353s
     0     0 36662.4977    0  391 17299.6197 36662.4977   112%     -  361s
     0     0 36645.5252    0  444 17299.6197 36645.5252   112%     -  366s
     0     0 36631.8607    0  599 17299.6197 36631.8607   112%     -  372s
     0     0 36623.0799    0  410 17299.6197 36623.0799   112%     -  375s
     0     0 36620.9559    0  456 17299.6197 36620.9559   112%     -  376s
     0     0 36617.9028    0  458 17299.6197 36617.9028   112%     -  378s
     0     0 36617.4080    0  408 17299.6197 36617.4080   112%     -  378s
     0     0 36490.3955    0  603 17299.6197 36490.3955   111%     -  387s
H    0     0                    17304.699859 36489.3484   111%     -  388s
     0     0 36450.2342    0  556 17304.6999 36450.2342   111%     -  393s
     0     0 36441.4899    0  447 17304.6999 36441.4899   111%     -  396s
     0     0 36435.1406    0  455 17304.6999 36435.1406   111%     -  398s
     0     0 36433.4943    0  455 17304.6999 36433.4943   111%     -  399s
     0     0 36432.6363    0  457 17304.6999 36432.6363   111%     -  400s
     0     0 36386.4710    0  563 17304.6999 36386.4710   110%     -  407s
H    0     0                    20137.772810 36385.5830  80.7%     -  412s
H    0     0                    20163.053961 36385.5830  80.5%     -  412s
H    0     0                    20168.134086 36385.5830  80.4%     -  413s
     0     0 36364.7922    0  614 20168.1341 36364.7922  80.3%     -  417s
     0     0 36357.4760    0  424 20168.1341 36357.4760  80.3%     -  419s
     0     0 36355.1174    0  421 20168.1341 36355.1174  80.3%     -  422s
     0     0 36354.1962    0  415 20168.1341 36354.1962  80.3%     -  424s
     0     0 36340.9729    0  502 20168.1341 36340.9729  80.2%     -  429s
     0     0 36335.2132    0  501 20168.1341 36335.2132  80.2%     -  433s
     0     0 36331.8770    0  586 20168.1341 36331.8770  80.1%     -  434s
     0     0 36330.4245    0  586 20168.1341 36330.4245  80.1%     -  436s
     0     0 36315.8562    0  427 20168.1341 36315.8562  80.1%     -  441s
H    0     0                    20197.876508 36315.7807  79.8%     -  447s
H    0     0                    20214.438137 36315.7807  79.7%     -  448s
     0     0 36312.4209    0  423 20214.4381 36312.4209  79.6%     -  449s
     0     0 36312.1512    0  425 20214.4381 36312.1512  79.6%     -  450s
     0     0 36300.5555    0  437 20214.4381 36300.5555  79.6%     -  454s
     0     0 36293.5846    0  422 20214.4381 36293.5846  79.5%     -  457s
     0     0 36291.5257    0  426 20214.4381 36291.5257  79.5%     -  458s
     0     0 36286.4935    0  425 20214.4381 36286.4935  79.5%     -  461s
     0     0 36284.8702    0  422 20214.4381 36284.8702  79.5%     -  462s
     0     0 36267.2717    0  429 20214.4381 36267.2717  79.4%     -  468s
H    0     0                    20254.319693 36267.1248  79.1%     -  474s
H    0     0                    20363.342803 36267.1248  78.1%     -  474s
H    0     0                    20519.570259 36267.1248  76.7%     -  474s
H    0     0                    20524.650384 36267.1248  76.7%     -  475s
     0     0 36264.4370    0  431 20524.6504 36264.4370  76.7%     -  477s
     0     0 36264.2621    0  434 20524.6504 36264.2621  76.7%     -  478s
     0     0 36258.7634    0  430 20524.6504 36258.7634  76.7%     -  481s
     0     0 36256.7993    0  441 20524.6504 36256.7993  76.7%     -  483s
     0     0 36256.3418    0  434 20524.6504 36256.3418  76.6%     -  484s
     0     0 36250.3457    0  430 20524.6504 36250.3457  76.6%     -  487s
     0     0 36249.3664    0  431 20524.6504 36249.3664  76.6%     -  489s
     0     0 36247.8715    0  441 20524.6504 36247.8715  76.6%     -  491s
     0     0 36247.7892    0  441 20524.6504 36247.7892  76.6%     -  493s
H    0     0                    20563.809196 36247.7707  76.3%     -  573s
     0     2 36247.7707    0  441 20563.8092 36247.7707  76.3%     -  575s
     1     3 35264.9574    1  390 20563.8092 36247.7707  76.3% 11974  585s
     2     4 36007.5118    1  413 20563.8092 36007.5118  75.1% 10328  592s
     3     6 34519.4522    2  407 20563.8092 36007.3085  75.1% 10522  601s
     5    11 33275.5421    3  419 20563.8092 36007.3085  75.1% 10971  615s
    10    22 33013.8590    4  406 20563.8092 35577.3912  73.0% 10554  632s
    21    33 34224.6236    4  424 20563.8092 35493.2370  72.6% 13889  672s
    32    65 34039.0286    5  490 20563.8092 35493.2370  72.6% 13889  774s
    64    97 33719.3911    6  392 20563.8092 35258.6742  71.5% 19024  860s
    96   178 33575.0413    7  389 20563.8092 35258.6537  71.5% 15897  895s
   177   264 33557.6339    8  386 20563.8092 35258.6537  71.5% 11537  923s
   263   293 31298.0104   18  302 20563.8092 35258.6537  71.5%  9777  943s
   292   328 33484.4465    9  316 20563.8092 35258.6537  71.5%  9756  964s
   327   369 32342.9963   10  275 20563.8092 35258.6537  71.5%  9441  984s
   368   414 31936.8114   12  275 20563.8092 35258.6537  71.5%  9383 1002s
   414   457 30959.7468   17  191 20563.8092 35258.6537  71.5%  9006 1020s
   465   511 30038.6869   19  230 20563.8092 35258.6537  71.5%  8672 1039s
   521   572 29999.8188   21  230 20563.8092 35258.6537  71.5%  8659 1056s
   588   631 28806.4304   25  241 20563.8092 35258.6537  71.5%  8520 1074s
   655   708 28627.7488   27  289 20563.8092 35258.6537  71.5%  8430 1092s
   736   770 28314.7157   30  268 20563.8092 35258.6537  71.5%  8346 1111s
   818   828 27859.3326   34  231 20563.8092 35258.6537  71.5%  8156 1128s
   890   881 27407.2753   36  212 20563.8092 35258.6537  71.5%  8024 1144s
   957   936 26800.0455   39  221 20563.8092 35258.6537  71.5%  8067 1163s
  1022   992 25105.4977   42  183 20563.8092 35258.6537  71.5%  8178 1184s
  1110  1082 24465.0261   47  137 20563.8092 35258.6537  71.5%  8156 1204s
  1214  1152 22902.7580   54  125 20563.8092 35258.6537  71.5%  8051 1225s
  1331  1218 21370.7562   60  157 20563.8092 35258.6537  71.5%  7852 1247s
  1433  1261 30097.9796    9  251 20563.8092 35258.6537  71.5%  7751 1270s
  1521  1318 32408.2789    8  389 20563.8092 35258.6537  71.5%  7768 1293s
  1618  1435 31806.7801    9  338 20563.8092 35258.6537  71.5%  7738 1317s
  1751  1512 31520.2967   10  317 20563.8092 35258.6537  71.5%  7630 1342s
  1888  1612 31323.8501   12  312 20563.8092 35258.6537  71.5%  7517 1367s
  2036  1698 31051.1149   14  293 20563.8092 35258.6537  71.5%  7429 1391s
  2182  1779 30247.5247   16  346 20563.8092 35258.6537  71.5%  7334 1419s
  2307  1873 29488.2292   18  271 20563.8092 35258.6537  71.5%  7380 1445s
  2441  1989 29044.0499   20  273 20563.8092 35258.6537  71.5%  7393 1474s
  2589  2123 28719.2931   25  301 20563.8092 35258.6537  71.5%  7384 1499s
  2745  2223 21032.6961   29  220 20563.8092 34547.4917  68.0%  7337 1531s
  2913  2331 22754.6721   16  302 20563.8092 34547.4917  68.0%  7319 1561s
  3090  2482 21389.9524   18  288 20563.8092 34547.4917  68.0%  7261 1593s
  3303  2610     cutoff   20      20563.8092 34547.4917  68.0%  7184 1627s
  3504  2786     cutoff   28      20563.8092 33999.3358  65.3%  7143 1659s
  3791  2787 22829.3790   42  441 20563.8092 33999.3358  65.3%  6964 1767s
  3793  2788 21540.3523   85  243 20563.8092 33999.3358  65.3%  6961 1778s
  3794  2789 31015.5711   23  452 20563.8092 33999.3358  65.3%  6959 1842s
  3795  2790 26288.0536   47  430 20563.8092 33999.3358  65.3%  6957 1877s
  3796  2790 26454.9186   18  452 20563.8092 33999.3358  65.3%  6955 1897s
  3797  2791 21628.8776   36  418 20563.8092 33999.3358  65.3%  6953 1913s
  3798  2792 26488.2944   41  543 20563.8092 33999.3358  65.3%  6951 1925s
  3799  2792 24423.3869   39  477 20563.8092 33999.3358  65.3%  6950 1934s
  3800  2793 27776.8995   23  415 20563.8092 33999.3358  65.3%  6948 1943s
  3801  2794 23052.6699   62  427 20563.8092 33999.3358  65.3%  6946 1950s
  3802  2794 26658.2261   16  506 20563.8092 33999.3358  65.3%  6944 1959s
  3803  2795 31740.1355   12  433 20563.8092 33999.3358  65.3%  6942 1964s
  3804  2796 23646.9264   66  472 20563.8092 33999.3358  65.3%  6940 1979s
  3805  2796 32358.9291    8  422 20563.8092 33999.3358  65.3%  6939 1985s
  3806  2797 27485.5571   23  441 20563.8092 33999.3358  65.3%  6937 1991s
  3808  2798 25484.1539   24  434 20563.8092 33999.3358  65.3%  6933 1996s
  3809  2799 29824.9173   17  459 20563.8092 33999.3358  65.3%  6931 2014s
  3810  2800 28517.2705   24  539 20563.8092 33999.3358  65.3%  6930 2024s
  3811  2800 25637.0276   24  594 20563.8092 33999.3358  65.3%  6928 2035s
  3812  2801 32959.0901   10  429 20563.8092 33999.3358  65.3%  6926 2040s
  3813  2802 27264.9716   24  434 20563.8092 33999.3358  65.3%  6924 2045s
  3814  2802 23686.1006  101  533 20563.8092 33999.3358  65.3%  6922 2057s
  3815  2803 29266.9501   17  429 20563.8092 33999.3358  65.3%  6920 2060s
  3817  2804 24234.6588   27  602 20563.8092 33999.3358  65.3%  6917 2083s
  3818  2805 23709.5954   19  556 20563.8092 33999.3358  65.3%  6915 2094s
  3819  2806 21156.4896   70  431 20563.8092 33999.3358  65.3%  6913 2098s
  3820  2806 26708.3114   22  547 20563.8092 33999.3358  65.3%  6911 2104s
  3821  2807 23115.0669   21  550 20563.8092 33999.3358  65.3%  6910 2116s
  3822  2808 28602.0580   22  559 20563.8092 33999.3358  65.3%  6908 2121s
  3823  2808 24349.9337   88  564 20563.8092 33999.3358  65.3%  6906 2128s
  3824  2809 32434.9108   13  626 20563.8092 33999.3358  65.3%  6904 2137s
  3825  2810 27259.3383   32  619 20563.8092 33999.3358  65.3%  6902 2143s
  3826  2810 22090.8685   43  555 20563.8092 33999.3358  65.3%  6901 2148s
  3827  2811 26696.7346   17  542 20563.8092 33999.3358  65.3%  6899 2157s
  3829  2812 26232.9514   14  542 20563.8092 33999.3358  65.3%  6895 2162s
  3830  2813 24810.9920   87  548 20563.8092 33999.3358  65.3%  6893 2169s
  3831  2814 30714.0882   16  536 20563.8092 33999.3358  65.3%  6892 2173s
  3832  2814 22118.4063   54  559 20563.8092 33999.3358  65.3%  6890 2183s
  3833  2815 24111.9912   33  559 20563.8092 33999.3358  65.3%  6888 2200s
  3834  2816 24754.0725   16  559 20563.8092 33999.3358  65.3%  6886 2245s
  3835  2819 33999.3358   12  534 20563.8092 33999.3358  65.3%  6979 2341s
  3837  2823 33999.3358   13  488 20563.8092 33999.3358  65.3%  6983 2376s
  3841  2829 33999.3358   14  487 20563.8092 33999.3358  65.3%  6991 2423s
  3849  2843 33999.3358   15  468 20563.8092 33999.3358  65.3%  7009 2464s
  3865  2853 32501.4432   16  406 20563.8092 33999.3358  65.3%  7058 2551s
  3881  2878 30485.3297   17  423 20563.8092 33999.3358  65.3%  7142 2592s
  3911  2986 30121.5837   18  368 20563.8092 33999.3358  65.3%  7171 2631s
  4034  2982 29042.9426   21  315 20563.8092 33999.3358  65.3%  7208 2650s
  4073  3020 27999.9876   22  271 20563.8092 33999.3358  65.3%  7198 2674s
  4134  3043 27540.9877   23  271 20563.8092 33999.3358  65.3%  7162 2707s
  4200  3064 28362.0136   22  490 20563.8092 33999.3358  65.3%  7123 2728s
  4260  3065 27128.4250   22  337 20563.8092 33999.3358  65.3%  7097 2742s
  4298  3079 26993.9634   27  185 20563.8092 33999.3358  65.3%  7073 2758s
  4341  3107 26923.9903   22  297 20563.8092 33999.3358  65.3%  7048 2782s
  4409  3143 28177.3782   23  419 20563.8092 33999.3358  65.3%  6994 2805s
  4491  3146 28138.5959   24  410 20563.8092 33999.3358  65.3%  6922 2831s
  4575  3149 27410.5000   26  440 20563.8092 33999.3358  65.3%  6846 2847s
  4643  3171 27297.8809   27  447 20563.8092 33999.3358  65.3%  6796 2864s
  4728  3176 26265.2905   28  382 20563.8092 33999.3358  65.3%  6728 2882s
  4814  3167 27022.8408   27  425 20563.8092 33999.3358  65.3%  6656 2924s
  4910  3151 22335.6829   28  254 20563.8092 33999.3358  65.3%  6581 2948s
  4964  3163 26110.0295   29  390 20563.8092 33999.3358  65.3%  6553 2967s
  5035  3161 26102.2732   30  389 20563.8092 33999.3358  65.3%  6510 3001s
  5114  3164 24771.5475   33  388 20563.8092 33999.3358  65.3%  6458 3020s
  5181  3184     cutoff   34      20563.8092 33999.3358  65.3%  6428 3040s
  5267  3190 22031.5586   33  272 20563.8092 33999.3358  65.3%  6381 3067s
  5353  3201     cutoff   35      20563.8092 33999.3358  65.3%  6348 3088s
  5434  3223 24787.9666   22  292 20563.8092 33999.3358  65.3%  6321 3118s
  5535  3236 24250.1897   24  114 20563.8092 33999.3358  65.3%  6270 3148s
  5652  3251 22944.3160   29  101 20563.8092 33999.3358  65.3%  6218 3184s
  5770  3259 22138.7254   35   76 20563.8092 33999.3358  65.3%  6169 3219s
  5876  3292 21659.5807   40  208 20563.8092 33999.3358  65.3%  6137 3246s
  5981  3291 26859.2204   20  308 20563.8092 33999.3358  65.3%  6121 3278s
  6036  3335 25822.3818   21  239 20563.8092 33999.3358  65.3%  6122 3304s
  6114  3377 25382.6836   22  238 20563.8092 33999.3358  65.3%  6113 3332s
  6190  3444     cutoff   26      20563.8092 33999.3358  65.3%  6114 3360s
  6323  3474 21871.8906   27  267 20563.8092 33618.0614  63.5%  6075 3397s
  6499  3505 21020.4863   31  235 20563.8092 33618.0614  63.5%  6006 3432s
  6681  3525 20930.9234   33  193 20563.8092 33618.0614  63.5%  5947 3469s
  6851  3552 26937.5295   20  303 20563.8092 33618.0614  63.5%  5900 3512s
  7011  3601 25921.1715   23  254 20563.8092 33618.0614  63.5%  5863 3548s
  7151  3704 23618.6007   27  201 20563.8092 33618.0614  63.5%  5844 3591s
  7370  3651 27711.2813   18  318 20563.8092 31671.5865  54.0%  5773 3600s

Cutting planes:
  Learned: 1
  Implied bound: 20
  Projected implied bound: 392
  MIR: 1059
  Mixing: 3
  Flow cover: 2443
  RLT: 41
  Relax-and-lift: 290

Explored 7400 nodes (43106528 simplex iterations) in 3600.06 seconds (9932.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20563.8 20524.7 20519.6 ... 20137.8

Time limit reached
Best objective 2.056380919582e+04, best bound 3.167158651644e+04, gap 54.0161%
  WARNING: Time limit reached. Using best solution found (gap: 54.02%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 20563.81, θ = 167867.04
  Upper Bound (UB) = 20563.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167867.04
  [DEBUG]   ✓ Scenario 0: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 167867.04 ≤ Q = 167867.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 167867.04 ≤ Q = 167867.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7c599b86
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7c599b86
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.364454e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6968665.4122
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.442752e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144275.20    0  123 6968665.41 -144275.20   102%     -    0s
H    0     0                    -108770.8631 -144275.20  32.6%     -    0s
H    0     0                    -110037.3539 -144275.20  31.1%     -    0s
     0     0 -119575.34    0   28 -110037.35 -119575.34  8.67%     -    0s
H    0     0                    -118568.3363 -119491.63  0.78%     -    0s
H    0     0                    -118646.0527 -119025.61  0.32%     -    0s
     0     0 -119025.61    0   26 -118646.05 -119025.61  0.32%     -    0s
     0     0 -119016.49    0   25 -118646.05 -119016.49  0.31%     -    0s
     0     0 -118996.64    0   24 -118646.05 -118996.64  0.30%     -    0s
     0     0 -118960.51    0   21 -118646.05 -118960.51  0.27%     -    0s
     0     0 -118942.26    0   15 -118646.05 -118942.26  0.25%     -    0s
     0     0 -118941.49    0   14 -118646.05 -118941.49  0.25%     -    0s
H    0     0                    -118713.8712 -118915.63  0.17%     -    0s
     0     0 -118915.63    0   14 -118713.87 -118915.63  0.17%     -    0s
     0     0 -118896.36    0    7 -118713.87 -118896.36  0.15%     -    0s
     0     0 -118896.36    0   17 -118713.87 -118896.36  0.15%     -    0s
H    0     0                    -118742.4913 -118896.36  0.13%     -    0s
*    0     0               0    -118854.5925 -118854.59  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 9
  Flow cover: 8

Explored 1 nodes (577 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -118855 -118742 -118714 ... 1.36445e+13
No other solutions better than -118855

Optimal solution found (tolerance 1.00e-04)
Best objective -1.188545925148e+05, best bound -1.188545925148e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 161293.79
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118854.59
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -118854.59 = 161293.79
  [DEBUG]   Current θ from Master = 167867.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6573.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13990.56
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 564.9890, Absolute Gap = 564.9890, Relative Gap = 0.027475
  Not converged yet (gap = 564.99 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481159 nonzeros
Model fingerprint: 0x0fd9a7fd
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74577 rows and 30287 columns
Presolve time: 1.41s
Presolved: 94996 rows, 40613 columns, 576164 nonzeros
Variable types: 38354 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367877.2666
Found heuristic solution: objective -214770.4678

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.176e+06
 Factor NZ  : 9.156e+06 (roughly 130 MB of memory)
 Factor Ops : 1.630e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62600540e+07  1.73796777e+08  9.13e+04 2.31e+01  6.98e+04     3s
   1  -1.22393634e+07  1.54250185e+08  6.34e+04 5.23e+01  4.80e+04     3s
   2  -3.95032525e+06  1.14894102e+08  2.04e+04 4.64e-11  1.65e+04     3s
   3  -7.63000750e+05  8.18906596e+07  1.56e+03 1.01e+00  1.64e+03     3s
   4  -4.54933732e+05  3.09862481e+07  2.80e+02 2.54e-01  3.63e+02     3s
   5  -3.43128857e+05  2.23579502e+07  8.51e+01 1.65e-01  1.82e+02     3s
   6  -2.62925249e+05  1.49118578e+07  3.86e+01 1.02e-01  1.07e+02     3s
   7  -1.44109679e+05  1.23415211e+07  6.57e+00 8.26e-02  7.46e+01     3s
   8  -1.03918495e+05  6.35923744e+06  4.24e+00 4.13e-02  3.82e+01     3s
   9  -6.00011387e+04  3.54888177e+06  2.09e+00 2.24e-02  2.10e+01     3s
  10  -3.39331126e+04  1.04996388e+06  1.11e+00 6.43e-03  6.28e+00     3s
  11  -6.55893555e+03  4.00865954e+05  5.49e-01 2.11e-03  2.35e+00     3s
  12   6.64613849e+03  1.91447783e+05  3.03e-01 1.30e-03  1.06e+00     3s
  13   1.04774450e+04  1.35652615e+05  2.52e-01 1.43e-03  7.21e-01     3s
  14   1.63614265e+04  1.18989981e+05  1.93e-01 1.43e-03  5.91e-01     3s
  15   2.12135949e+04  1.03035859e+05  1.60e-01 1.62e-03  4.71e-01     3s
  16   2.78261730e+04  8.92161382e+04  1.20e-01 1.89e-03  3.53e-01     3s
  17   3.18949482e+04  8.09318083e+04  9.60e-02 1.86e-03  2.82e-01     3s
  18   3.30339668e+04  7.12149646e+04  8.89e-02 1.58e-03  2.20e-01     3s
  19   3.72196490e+04  6.58016464e+04  6.62e-02 1.47e-03  1.64e-01     3s
  20   3.97124240e+04  6.04328387e+04  5.26e-02 1.21e-03  1.19e-01     3s
  21   4.07767681e+04  5.88685416e+04  4.72e-02 1.16e-03  1.04e-01     3s
  22   4.20153597e+04  5.63860614e+04  4.10e-02 1.28e-03  8.27e-02     3s
  23   4.31452227e+04  5.53546213e+04  3.52e-02 1.33e-03  7.03e-02     3s
  24   4.49189434e+04  5.44934877e+04  2.69e-02 1.20e-03  5.51e-02     3s
  25   4.64192428e+04  5.37869225e+04  1.99e-02 9.62e-04  4.24e-02     4s
  26   4.72395483e+04  5.31856007e+04  1.58e-02 7.71e-04  3.42e-02     4s
  27   4.75971083e+04  5.26505189e+04  1.42e-02 6.08e-04  2.91e-02     4s
  28   4.76376940e+04  5.24931455e+04  1.40e-02 5.62e-04  2.79e-02     4s
  29   4.81998628e+04  5.21978199e+04  1.12e-02 4.75e-04  2.30e-02     4s
  30   4.83701944e+04  5.20291613e+04  1.04e-02 4.25e-04  2.11e-02     4s
  31   4.84036478e+04  5.18443401e+04  1.02e-02 3.70e-04  1.98e-02     4s
  32   4.88242049e+04  5.17153811e+04  8.18e-03 3.30e-04  1.66e-02     4s
  33   4.90492429e+04  5.15273834e+04  7.11e-03 2.72e-04  1.43e-02     4s
  34   4.93227463e+04  5.13450778e+04  5.82e-03 2.14e-04  1.16e-02     4s
  35   4.96157015e+04  5.12631655e+04  4.49e-03 1.88e-04  9.48e-03     4s
  36   4.96810903e+04  5.12299456e+04  4.21e-03 1.78e-04  8.91e-03     4s
  37   4.97519053e+04  5.11253003e+04  3.90e-03 1.42e-04  7.90e-03     4s
  38   4.99547017e+04  5.10482779e+04  2.99e-03 1.15e-04  6.29e-03     4s
  39   5.00317797e+04  5.09019387e+04  2.63e-03 7.41e-05  5.01e-03     4s
  40   5.02223609e+04  5.08729883e+04  1.74e-03 6.60e-05  3.74e-03     4s
  41   5.02870551e+04  5.08465528e+04  1.46e-03 5.83e-05  3.22e-03     4s
  42   5.03675848e+04  5.07811415e+04  1.13e-03 3.95e-05  2.38e-03     4s
  43   5.04579135e+04  5.07217935e+04  7.50e-04 2.21e-05  1.52e-03     4s
  44   5.05099464e+04  5.06897448e+04  5.35e-04 1.28e-05  1.03e-03     4s
  45   5.05224509e+04  5.06868017e+04  4.85e-04 1.19e-05  9.46e-04     4s
  46   5.05590381e+04  5.06787689e+04  3.31e-04 9.62e-06  6.89e-04     4s
  47   5.05769176e+04  5.06644931e+04  2.63e-04 5.50e-06  5.04e-04     5s
  48   5.05824547e+04  5.06613830e+04  2.42e-04 4.61e-06  4.54e-04     5s
  49   5.05844340e+04  5.06603238e+04  2.34e-04 4.30e-06  4.37e-04     5s
  50   5.05928065e+04  5.06577090e+04  2.03e-04 3.49e-06  3.74e-04     5s
  51   5.06193020e+04  5.06537183e+04  9.74e-05 2.30e-06  1.98e-04     5s
  52   5.06255825e+04  5.06491541e+04  7.32e-05 9.56e-07  1.36e-04     5s
  53   5.06365926e+04  5.06484596e+04  3.11e-05 7.62e-07  6.83e-05     5s
  54   5.06446918e+04  5.06463903e+04  2.30e-06 2.30e-07  9.76e-06     5s
  55   5.06450448e+04  5.06455792e+04  1.16e-06 2.01e-07  3.07e-06     5s
  56   5.06453127e+04  5.06454941e+04  2.91e-07 9.13e-08  1.04e-06     5s
  57   5.06454207e+04  5.06454351e+04  2.30e-08 1.64e-08  8.23e-08     5s
  58   5.06454223e+04  5.06454243e+04  1.13e-08 2.92e-09  1.11e-08     5s
  59   5.06454226e+04  5.06454226e+04  1.03e-08 2.45e-10  1.68e-10     5s

Barrier solved model in 59 iterations and 5.12 seconds (9.56 work units)
Optimal objective 5.06454226e+04


Root crossover log...

   77261 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    2926 PPushes remaining with PInf 1.2434441e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0843741e+01      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33724    5.0645423e+04   0.000000e+00   1.084374e+01      8s
   33743    5.0645423e+04   0.000000e+00   0.000000e+00      8s
   33743    5.0645423e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.57s

Solved with barrier

Root relaxation: objective 5.064542e+04, 33743 iterations, 6.99 seconds (15.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50645.4226    0  372 -214770.47 50645.4226   124%     -    9s
H    0     0                    -202758.1256 50645.4226   125%     -    9s
H    0     0                    -182067.2359 50645.4226   128%     -    9s
H    0     0                    -163166.7346 50645.4226   131%     -    9s
H    0     0                    -157696.0087 50645.4226   132%     -    9s
H    0     0                    -154562.0356 50645.4226   133%     -    9s
H    0     0                    -153830.4075 50645.4226   133%     -    9s
H    0     0                    -89731.94373 50645.4226   156%     -    9s
H    0     0                    -89471.79499 50645.4226   157%     -    9s
H    0     0                    -25296.15566 50645.4226   300%     -    9s
H    0     0                    -16084.24403 50645.4226   415%     -    9s
H    0     0                    -15348.80212 50645.4226   430%     -    9s
H    0     0                    -15143.12777 50645.4226   434%     -    9s
     0     0 44806.2039    0  524 -15143.128 44806.2039   396%     -   53s
H    0     0                    -14017.32083 44806.2039   420%     -   54s
H    0     0                    -14001.65551 44806.2039   420%     -   54s
H    0     0                    -13828.87624 44806.2039   424%     -   54s
H    0     0                    -13778.29020 44806.2039   425%     -   54s
H    0     0                    -13533.42246 44806.2039   431%     -   54s
H    0     0                    -13509.29288 44806.2039   432%     -   54s
H    0     0                    -13505.76514 44806.2039   432%     -   54s
H    0     0                    -13413.99949 44806.2039   434%     -   54s
H    0     0                    -13320.51707 44806.2039   436%     -   54s
H    0     0                    -13297.88239 44806.2039   437%     -   54s
H    0     0                    -13156.07612 44806.2039   441%     -   54s
     0     0 43940.0389    0  476 -13156.076 43940.0389   434%     -   76s
     0     0 43685.3450    0  474 -13156.076 43685.3450   432%     -   91s
     0     0 43606.2463    0  482 -13156.076 43606.2463   431%     -  105s
     0     0 43536.4656    0  479 -13156.076 43536.4656   431%     -  112s
     0     0 43535.5673    0  495 -13156.076 43535.5673   431%     -  117s
     0     0 43535.5673    0  476 -13156.076 43535.5673   431%     -  124s
     0     0 43535.5673    0  479 -13156.076 43535.5673   431%     -  126s
     0     0 43535.5673    0  475 -13156.076 43535.5673   431%     -  126s
H    0     0                    -7433.430437 41571.4949   659%     -  173s
H    0     0                    -5823.539665 41571.4949   814%     -  173s
H    0     0                    -5513.369646 41571.4949   854%     -  173s
H    0     0                    -5046.985223 41571.4949   924%     -  173s
H    0     0                    -5008.446874 41571.4949   930%     -  173s
H    0     0                    -4618.891260 41571.4949  1000%     -  173s
     0     0 41275.8700    0  360 -4618.8913 41275.8700   994%     -  173s
H    0     0                    7242.3379803 41275.8700   470%     -  174s
H    0     0                    11689.217812 41275.8700   253%     -  174s
H    0     0                    11866.948623 41275.8700   248%     -  174s
H    0     0                    11894.837518 41275.8700   247%     -  174s
H    0     0                    11913.993258 41275.8700   246%     -  174s
H    0     0                    11937.562791 41275.8700   246%     -  174s
     0     0 40511.2331    0  439 11937.5628 40511.2331   239%     -  216s
     0     0 40309.7153    0  498 11937.5628 40309.7153   238%     -  231s
     0     0 40199.2595    0  507 11937.5628 40199.2595   237%     -  241s
     0     0 40019.4406    0  509 11937.5628 40019.4406   235%     -  253s
     0     0 39926.6660    0  496 11937.5628 39926.6660   234%     -  268s
     0     0 39799.8393    0  496 11937.5628 39799.8393   233%     -  280s
     0     0 39745.6561    0  498 11937.5628 39745.6561   233%     -  292s
     0     0 39719.8773    0  506 11937.5628 39719.8773   233%     -  303s
     0     0 39675.5068    0  505 11937.5628 39675.5068   232%     -  312s
     0     0 39673.5664    0  507 11937.5628 39673.5664   232%     -  316s
     0     0 39668.7277    0  514 11937.5628 39668.7277   232%     -  321s
     0     0 39651.5069    0  519 11937.5628 39651.5069   232%     -  327s
     0     0 39649.6315    0  508 11937.5628 39649.6315   232%     -  329s
     0     0 39649.1556    0  505 11937.5628 39649.1556   232%     -  331s
H    0     0                    13800.481607 37984.4949   175%     -  398s
H    0     0                    13818.166296 37984.4949   175%     -  398s
H    0     0                    15857.576277 37984.4949   140%     -  398s
H    0     0                    15876.467578 37984.4949   139%     -  398s
H    0     0                    16196.547280 37984.4949   135%     -  398s
H    0     0                    16256.678146 37984.4949   134%     -  398s
     0     0 37984.4949    0  504 16256.6781 37984.4949   134%     -  398s
H    0     0                    16511.582080 37694.7696   128%     -  428s
     0     0 37694.7696    0  636 16511.5821 37694.7696   128%     -  428s
     0     0 37541.1636    0  591 16511.5821 37541.1636   127%     -  447s
     0     0 37455.7638    0  540 16511.5821 37455.7638   127%     -  457s
     0     0 37403.2056    0  546 16511.5821 37403.2056   127%     -  465s
     0     0 37392.0231    0  561 16511.5821 37392.0231   126%     -  474s
     0     0 37380.1952    0  559 16511.5821 37380.1952   126%     -  480s
     0     0 37367.1533    0  562 16511.5821 37367.1533   126%     -  484s
     0     0 37358.1781    0  565 16511.5821 37358.1781   126%     -  488s
     0     0 37348.1997    0  562 16511.5821 37348.1997   126%     -  490s
     0     0 37346.2920    0  569 16511.5821 37346.2920   126%     -  493s
     0     0 36869.1242    0  402 16511.5821 36869.1242   123%     -  522s
     0     0 36694.6835    0  557 16511.5821 36694.6835   122%     -  538s
     0     0 36611.8185    0  552 16511.5821 36611.8185   122%     -  547s
     0     0 36583.9772    0  406 16511.5821 36583.9772   122%     -  556s
     0     0 36548.3200    0  405 16511.5821 36548.3200   121%     -  561s
     0     0 36535.6058    0  407 16511.5821 36535.6058   121%     -  566s
     0     0 36529.1169    0  404 16511.5821 36529.1169   121%     -  568s
     0     0 36519.7542    0  405 16511.5821 36519.7542   121%     -  571s
     0     0 36517.2996    0  409 16511.5821 36517.2996   121%     -  573s
     0     0 36516.9119    0  408 16511.5821 36516.9119   121%     -  574s
     0     0 36456.7371    0  550 16511.5821 36456.7371   121%     -  586s
     0     0 36426.8840    0  567 16511.5821 36426.8840   121%     -  594s
     0     0 36413.8341    0  572 16511.5821 36413.8341   121%     -  599s
     0     0 36407.6060    0  578 16511.5821 36407.6060   120%     -  602s
     0     0 36405.1898    0  666 16511.5821 36405.1898   120%     -  605s
     0     0 36404.0715    0  574 16511.5821 36404.0715   120%     -  606s
     0     0 36345.3567    0  428 16511.5821 36345.3567   120%     -  616s
H    0     0                    16587.153195 36345.2003   119%     -  633s
H    0     0                    17023.782934 36345.2003   113%     -  634s
H    0     0                    17403.692460 36345.2003   109%     -  634s
H    0     0                    17639.237194 36345.2003   106%     -  634s
H    0     0                    17905.265606 36345.2003   103%     -  634s
H    0     0                    18848.938729 36345.2003  92.8%     -  635s
H    0     0                    19141.196577 36345.2003  89.9%     -  635s
H    0     0                    19360.725329 36345.2003  87.7%     -  635s
H    0     0                    20145.275730 36345.2003  80.4%     -  637s
     0     0 36315.1342    0  612 20145.2757 36315.1342  80.3%     -  643s
     0     0 36299.5613    0  429 20145.2757 36299.5613  80.2%     -  647s
     0     0 36290.0765    0  435 20145.2757 36290.0765  80.1%     -  653s
     0     0 36285.5415    0  593 20145.2757 36285.5415  80.1%     -  656s
     0     0 36283.8696    0  595 20145.2757 36283.8696  80.1%     -  657s
     0     0 36268.5561    0  593 20145.2757 36268.5561  80.0%     -  665s
     0     0 36259.5885    0  585 20145.2757 36259.5885  80.0%     -  669s
     0     0 36250.0712    0  575 20145.2757 36250.0712  79.9%     -  673s
     0     0 36243.4997    0  580 20145.2757 36243.4997  79.9%     -  675s
     0     0 36240.2119    0  587 20145.2757 36240.2119  79.9%     -  677s
     0     0 36239.0112    0  589 20145.2757 36239.0112  79.9%     -  678s
     0     0 36225.2406    0  429 20145.2757 36225.2406  79.8%     -  684s
     0     0 36221.2205    0  430 20145.2757 36221.2205  79.8%     -  687s
     0     0 36214.4312    0  439 20145.2757 36214.4312  79.8%     -  691s
     0     0 36213.4383    0  439 20145.2757 36213.4383  79.8%     -  692s
     0     0 36203.8795    0  437 20145.2757 36203.8795  79.7%     -  697s
     0     0 36201.4100    0  573 20145.2757 36201.4100  79.7%     -  699s
     0     0 36198.6788    0  437 20145.2757 36198.6788  79.7%     -  701s
     0     0 36198.0753    0  437 20145.2757 36198.0753  79.7%     -  701s
     0     0 36194.6922    0  438 20145.2757 36194.6922  79.7%     -  706s
     0     0 36192.6785    0  438 20145.2757 36192.6785  79.7%     -  708s
H    0     0                    20453.657130 36192.6320  76.9%     -  831s
H    0     0                    20501.792028 36192.6320  76.5%     -  831s
H    0     0                    20517.959672 36192.6320  76.4%     -  865s
     0     2 36192.6320    0  438 20517.9597 36192.6320  76.4%     -  884s
     1     4 36166.8794    1  426 20517.9597 36192.6320  76.4%  3389  889s
     2     4 36085.6600    1  420 20517.9597 36166.5440  76.3%  5118  890s
     3     6 34646.4572    2  400 20517.9597 36166.5440  76.3%  9251  904s
     5     8 35815.3106    2  422 20517.9597 36083.9020  75.9% 10914  916s
     7    13 33161.1164    3  399 20517.9597 35815.0989  74.6% 11676  930s
    12    26 34831.3613    4  408 20517.9597 35814.9749  74.6% 12450  947s
    25    39 34299.0197    5  391 20517.9597 35272.2511  71.9% 14590  988s
    38    70 31791.1997    6  292 20517.9597 35272.2511  71.9% 18290 1071s
    69   156 30730.3418    7  278 20517.9597 34765.2957  69.4% 18932 1105s
   159   188 30489.9287    9  280 20517.9597 34688.3318  69.1% 12185 1130s
   191   215 29155.1143   10  271 20517.9597 34688.3318  69.1% 11804 1170s
   220   251 29085.2986   11  252 20517.9597 34688.3318  69.1% 11649 1199s
   256   285 28959.6721   12  256 20517.9597 34688.3318  69.1% 11073 1232s
   296   321 28898.1892   13  335 20517.9597 34688.3318  69.1% 10601 1257s
   332   351 28880.9286   14  335 20517.9597 34688.3318  69.1% 10128 1287s
   362   385 28870.5773   15  331 20517.9597 34688.3318  69.1%  9873 1307s
   396   420 28869.9532   16  334 20517.9597 34688.3318  69.1%  9711 1329s
   431   449 28855.7712   17  323 20517.9597 34688.3318  69.1%  9532 1347s
   470   476 23853.5297   18  159 20517.9597 34688.3318  69.1%  9275 1377s
   501   512 28781.3122   18  445 20517.9597 34688.3318  69.1%  9168 1395s
   541   545 27749.6363   19  234 20517.9597 34688.3318  69.1%  9199 1420s
   590   586 27710.7360   20  323 20517.9597 34688.3318  69.1%  9103 1442s
   637   619 27486.9691   21  384 20517.9597 34688.3318  69.1%  8913 1464s
   684   661 27271.6849   22  309 20517.9597 34688.3318  69.1%  8724 1481s
   732   696 26785.6200   23  300 20517.9597 34688.3318  69.1%  8585 1499s
   788   734 26469.4965   24  408 20517.9597 34688.3318  69.1%  8474 1515s
   851   780 26325.6288   25  399 20517.9597 34501.8784  68.2%  8361 1533s
   913   822 25943.8982   28  352 20517.9597 34501.8784  68.2%  8230 1552s
   975   845 25730.5331   32  328 20517.9597 34409.2023  67.7%  8063 1573s
  1048   877 25070.1559   37  308 20517.9597 34264.8340  67.0%  8023 1596s
  1110   917 23190.0455   41  315 20517.9597 34264.8340  67.0%  8089 1621s
  1162   944 22677.8641   44  221 20517.9597 34264.8340  67.0%  8236 1659s
  1197   969 22609.3115   45  308 20517.9597 34264.8340  67.0%  8337 1706s
  1234  1004 22509.9748   46  299 20517.9597 34264.8340  67.0%  8342 1744s
  1286  1045 22467.6186   48  300 20517.9597 34264.8340  67.0%  8355 1772s
  1343  1090 22283.5562   52  225 20517.9597 34070.7275  66.1%  8372 1797s
  1403  1121 23364.0509   13  201 20517.9597 34070.7275  66.1%  8365 1823s
  1466  1140 22618.0526   15  154 20517.9597 34070.7275  66.1%  8410 1850s
  1537  1157 20891.2475   31  328 20517.9597 34070.7275  66.1%  8479 1878s
  1604  1196 infeasible   32      20517.9597 33872.5799  65.1%  8597 1911s
  1687  1232 30911.6189    9  273 20517.9597 33872.5799  65.1%  8724 1944s
  1749  1269 27125.6659   11  509 20517.9597 33570.6447  63.6%  8858 1981s
  1814  1313 24175.7531   13  541 20517.9597 33570.6447  63.6%  9019 2018s
  1888  1373 20706.8136   17  487 20517.9597 33570.6447  63.6%  9203 2050s
  1978  1433 30384.1623    8  278 20517.9597 33570.6447  63.6%  9318 2087s
  2097  1504 28690.7647   11  261 20517.9597 33570.6447  63.6%  9362 2126s
  2206  1628 24603.2294   15  131 20517.9597 33570.6447  63.6%  9453 2166s
  2380  1730 23171.9996   20  377 20517.9597 33570.6447  63.6%  9354 2204s
  2565  1803 22225.2236   27  268 20517.9597 33570.6447  63.6%  9236 2247s
  2728  1885 21175.8084   39  223 20517.9597 33555.8186  63.5%  9235 2296s
  2886  1992 27679.3234   12  355 20517.9597 33555.8186  63.5%  9289 2341s
  3043  2099 23667.8804   14  431 20517.9597 33555.8186  63.5%  9338 2388s
  3220  2186 22682.7501   16  379 20517.9597 33555.8186  63.5%  9381 2435s
  3383  2293 21256.3908   19  358 20517.9597 33555.8186  63.5%  9428 2487s
  3605  2412 infeasible   13      20517.9597 33313.5081  62.4%  9403 2543s
  3836  2526 29488.7081   10  253 20517.9597 33313.5081  62.4%  9347 2604s
  4059  2676 27781.3310   13  302 20517.9597 33313.5081  62.4%  9346 2663s
  4290  2677 24379.9754   23  438 20517.9597 33306.7574  62.3%  9375 2915s
  4292  2678 20848.3268   52   91 20517.9597 33306.7574  62.3%  9371 2924s
  4293  2679 23035.0250   19  432 20517.9597 33306.7574  62.3%  9369 2987s
  4294  2680 22514.0693   55  415 20517.9597 33306.7574  62.3%  9367 3037s
  4295  2680 25391.0614   21  432 20517.9597 33306.7574  62.3%  9364 3077s
  4296  2681 23189.5727   42  484 20517.9597 33306.7574  62.3%  9362 3107s
  4297  2682 28488.7926   12  420 20517.9597 33306.7574  62.3%  9360 3120s
  4298  2682 22893.3971   26  427 20517.9597 33306.7574  62.3%  9358 3131s
  4299  2683 22790.6163   44  429 20517.9597 33306.7574  62.3%  9356 3141s
  4300  2684 24993.4034   25  434 20517.9597 33306.7574  62.3%  9353 3149s
  4301  2684 21998.3573   22  443 20517.9597 33306.7574  62.3%  9351 3156s
  4302  2685 21491.2872   25  443 20517.9597 33306.7574  62.3%  9349 3164s
  4303  2686 28034.8265   14  542 20517.9597 33306.7574  62.3%  9347 3187s
  4304  2686 27216.9023   14  433 20517.9597 33306.7574  62.3%  9345 3195s
  4305  2687 31180.4320   11  446 20517.9597 33306.7574  62.3%  9343 3203s
  4306  2688 22322.4314   43  468 20517.9597 33306.7574  62.3%  9340 3214s
  4307  2688 27515.3337   32  443 20517.9597 33306.7574  62.3%  9338 3220s
  4308  2689 21161.9764   56  430 20517.9597 33306.7574  62.3%  9336 3227s
  4309  2690 31926.8304   10  507 20517.9597 33306.7574  62.3%  9334 3246s
  4310  2690 22392.1241   31  467 20517.9597 33306.7574  62.3%  9332 3255s
  4311  2691 23402.1925   19  482 20517.9597 33306.7574  62.3%  9330 3261s
  4312  2692 32751.3282    5  541 20517.9597 33306.7574  62.3%  9327 3275s
  4313  2692 27797.5924   12  400 20517.9597 33306.7574  62.3%  9325 3282s
  4314  2693 24318.7442   19  424 20517.9597 33306.7574  62.3%  9323 3285s
  4316  2694 31292.4780   12  446 20517.9597 33306.7574  62.3%  9319 3302s
  4317  2695 20827.0120   33  438 20517.9597 33306.7574  62.3%  9317 3307s
  4318  2696 23721.7438   37  537 20517.9597 33306.7574  62.3%  9314 3330s
  4319  2696 27930.0124   28  513 20517.9597 33306.7574  62.3%  9312 3337s
  4320  2697 25324.1705   15  482 20517.9597 33306.7574  62.3%  9310 3352s
  4321  2698 27116.0451   15  549 20517.9597 33306.7574  62.3%  9308 3359s
  4322  2698 31928.9768   10  490 20517.9597 33306.7574  62.3%  9306 3365s
  4323  2699 21916.9132   52  447 20517.9597 33306.7574  62.3%  9304 3376s
  4324  2700 25699.3434   32  495 20517.9597 33306.7574  62.3%  9302 3382s
  4325  2700 26820.3003   25  560 20517.9597 33306.7574  62.3%  9299 3390s
  4326  2701 25718.1764   17  515 20517.9597 33306.7574  62.3%  9297 3395s
  4327  2702 26108.9324   22  442 20517.9597 33306.7574  62.3%  9295 3400s
  4328  2702 24002.2655   41  442 20517.9597 33306.7574  62.3%  9293 3442s
  4329  2703 23545.7549   10  442 20517.9597 33306.7574  62.3%  9291 3527s

Cutting planes:
  Implied bound: 19
  Projected implied bound: 213
  MIR: 339
  Flow cover: 807
  RLT: 32
  Relax-and-lift: 169

Explored 4330 nodes (41260829 simplex iterations) in 3600.06 seconds (9628.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20518 20501.8 20453.7 ... 17403.7

Time limit reached
Best objective 2.051795967243e+04, best bound 3.330675735633e+04, gap 62.3298%
  WARNING: Time limit reached. Using best solution found (gap: 62.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 20517.96, θ = 168268.11
  Upper Bound (UB) = 20517.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168268.11
  [DEBUG]   ✓ Scenario 0: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 168268.11 ≤ Q = 168268.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 168268.11 ≤ Q = 168268.11 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x48a8e0f4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x48a8e0f4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356530e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.00s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6893565.8254
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.438600e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143860.04    0  123 6893565.83 -143860.04   102%     -    0s
H    0     0                    -108358.5575 -143860.04  32.8%     -    0s
H    0     0                    -109625.0483 -143860.04  31.2%     -    0s
     0     0 -113649.64    0   51 -109625.05 -113649.64  3.67%     -    0s
H    0     0                    -113038.2798 -113649.36  0.54%     -    0s
     0     0 -113414.44    0   18 -113038.28 -113414.44  0.33%     -    0s
H    0     0                    -113285.4428 -113413.87  0.11%     -    0s
     0     0          -    0      -113285.44 -113296.02  0.01%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 135
  Flow cover: 3
  RLT: 11
  BQP: 3

Explored 1 nodes (429 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -113285 -113038 -109625 ... 1.35653e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.132854428407e+05, best bound -1.132960230889e+05, gap 0.0093%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 166862.94
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113285.44
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -113285.44 = 166862.94
  [DEBUG]   Current θ from Master = 168268.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1405.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19112.79
  Lower Bound (LB) = 19998.82
  Gap (UB-LB) = 519.1394, Absolute Gap = 519.1394, Relative Gap = 0.025302
  Not converged yet (gap = 519.14 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524399 nonzeros
Model fingerprint: 0x02e1eeb2
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81384 rows and 33054 columns
Presolve time: 1.59s
Presolved: 103479 rows, 44086 columns, 625151 nonzeros
Variable types: 41827 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -368212.4835
Found heuristic solution: objective -214770.4678

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 606
 AA' NZ     : 3.835e+06
 Factor NZ  : 8.961e+06 (roughly 130 MB of memory)
 Factor Ops : 1.658e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68422937e+07  1.87168279e+08  9.46e+04 2.40e+01  7.18e+04     3s
   1  -1.27716102e+07  1.67042577e+08  6.61e+04 5.19e+01  4.96e+04     3s
   2  -4.45283123e+06  1.23439577e+08  2.29e+04 3.61e+00  1.83e+04     3s
   3  -7.78166875e+05  8.91972211e+07  1.65e+03 1.81e+00  1.70e+03     3s
   4  -4.54905074e+05  3.20383190e+07  3.05e+02 3.58e-01  3.69e+02     3s
   5  -3.43378127e+05  2.23340965e+07  1.03e+02 2.29e-01  1.81e+02     3s
   6  -2.59081636e+05  1.61137531e+07  4.86e+01 1.55e-01  1.11e+02     3s
   7  -1.28407637e+05  1.26524235e+07  1.21e+01 1.17e-01  7.29e+01     3s
   8  -1.00904990e+05  5.86425509e+06  8.52e+00 5.03e-02  3.36e+01     3s
   9  -5.68478182e+04  3.19203002e+06  3.96e+00 2.60e-02  1.77e+01     3s
  10  -2.66797048e+04  1.02034157e+06  1.81e+00 7.67e-03  5.62e+00     3s
  11  -3.95934275e+03  2.98705466e+05  8.46e-01 1.94e-03  1.61e+00     3s
  12   7.95361290e+03  1.74273556e+05  4.98e-01 1.05e-03  8.83e-01     3s
  13   1.15847106e+04  1.34048396e+05  4.16e-01 1.00e-03  6.50e-01     3s
  14   1.72318404e+04  1.15320902e+05  3.16e-01 7.49e-04  5.20e-01     3s
  15   2.12593424e+04  1.02544655e+05  2.71e-01 9.31e-04  4.31e-01     3s
  16   2.86280935e+04  8.55116282e+04  1.95e-01 1.89e-03  3.02e-01     3s
  17   3.18896687e+04  7.51231913e+04  1.66e-01 1.77e-03  2.29e-01     3s
  18   3.56487423e+04  6.78611379e+04  1.31e-01 1.41e-03  1.71e-01     3s
  19   3.78238188e+04  6.36967862e+04  1.11e-01 2.09e-03  1.37e-01     3s
  20   4.00536050e+04  6.08094264e+04  9.20e-02 1.48e-03  1.10e-01     4s
  21   4.28943731e+04  5.87467546e+04  6.92e-02 1.24e-03  8.40e-02     4s
  22   4.45392860e+04  5.66766858e+04  5.58e-02 1.26e-03  6.44e-02     4s
  23   4.60046880e+04  5.50264842e+04  4.35e-02 1.40e-03  4.78e-02     4s
  24   4.62608504e+04  5.42621091e+04  4.16e-02 1.52e-03  4.24e-02     4s
  25   4.74596035e+04  5.38807071e+04  3.25e-02 1.21e-03  3.41e-02     4s
  26   4.77582513e+04  5.32461956e+04  2.97e-02 1.03e-03  2.91e-02     4s
  27   4.85622628e+04  5.28409808e+04  2.35e-02 7.58e-04  2.27e-02     4s
  28   4.88193295e+04  5.24989622e+04  2.14e-02 9.50e-04  1.95e-02     4s
  29   4.96825022e+04  5.24116176e+04  1.49e-02 9.34e-04  1.45e-02     4s
  30   4.99063343e+04  5.22119071e+04  1.32e-02 6.86e-04  1.22e-02     4s
  31   5.01589492e+04  5.20476017e+04  1.12e-02 5.22e-04  1.00e-02     4s
  32   5.04323027e+04  5.19477056e+04  9.09e-03 3.78e-04  8.04e-03     4s
  33   5.06910035e+04  5.18910101e+04  7.19e-03 3.27e-04  6.37e-03     4s
  34   5.07507789e+04  5.18690620e+04  6.72e-03 2.84e-04  5.94e-03     4s
  35   5.09068652e+04  5.18137114e+04  5.55e-03 2.62e-04  4.81e-03     4s
  36   5.10216974e+04  5.17771751e+04  4.63e-03 2.03e-04  4.01e-03     4s
  37   5.10654567e+04  5.17569873e+04  4.31e-03 1.73e-04  3.67e-03     4s
  38   5.11686073e+04  5.17273904e+04  3.50e-03 1.36e-04  2.97e-03     4s
  39   5.12611637e+04  5.17232619e+04  2.82e-03 1.23e-04  2.45e-03     4s
  40   5.13163702e+04  5.17087706e+04  2.41e-03 1.10e-04  2.08e-03     5s
  41   5.13604860e+04  5.17019696e+04  2.09e-03 9.94e-05  1.81e-03     5s
  42   5.14086272e+04  5.16864782e+04  1.72e-03 7.32e-05  1.47e-03     5s
  43   5.14460345e+04  5.16796148e+04  1.44e-03 5.30e-05  1.24e-03     5s
  44   5.14638252e+04  5.16774596e+04  1.31e-03 4.95e-05  1.13e-03     5s
  45   5.14881263e+04  5.16702796e+04  1.13e-03 3.77e-05  9.67e-04     5s
  46   5.15487443e+04  5.16625982e+04  6.96e-04 2.37e-05  6.04e-04     5s
  47   5.15523138e+04  5.16588846e+04  6.67e-04 1.83e-05  5.66e-04     5s
  48   5.15641635e+04  5.16568441e+04  5.84e-04 1.52e-05  4.92e-04     5s
  49   5.15900437e+04  5.16562518e+04  3.98e-04 1.43e-05  3.51e-04     5s
  50   5.15996411e+04  5.16536983e+04  3.32e-04 1.08e-05  2.87e-04     5s
  51   5.16065682e+04  5.16523980e+04  2.81e-04 8.69e-06  2.43e-04     5s
  52   5.16079246e+04  5.16499821e+04  2.71e-04 5.81e-06  2.23e-04     5s
  53   5.16110525e+04  5.16481602e+04  2.48e-04 1.77e-05  1.97e-04     5s
  54   5.16298069e+04  5.16464404e+04  1.13e-04 5.23e-06  8.84e-05     5s
  55   5.16317170e+04  5.16463660e+04  9.97e-05 4.42e-06  7.78e-05     5s
  56   5.16434518e+04  5.16462072e+04  1.36e-05 3.05e-06  1.46e-05     5s
  57   5.16442048e+04  5.16460840e+04  8.74e-06 2.38e-06  9.96e-06     5s
  58   5.16444705e+04  5.16459509e+04  7.09e-06 1.58e-06  7.85e-06     5s
  59   5.16454537e+04  5.16457102e+04  1.21e-06 2.71e-07  1.36e-06     6s
  60   5.16456115e+04  5.16456684e+04  2.69e-07 3.43e-08  3.01e-07     6s
  61   5.16456585e+04  5.16456621e+04  2.73e-08 4.58e-10  1.87e-08     6s
  62   5.16456618e+04  5.16456619e+04  4.46e-08 2.23e-09  5.04e-10     6s

Barrier solved model in 62 iterations and 5.67 seconds (10.50 work units)
Optimal objective 5.16456618e+04


Root crossover log...

   81360 DPushes remaining with DInf 0.0000000e+00                 6s
    4300 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    6524 PPushes remaining with PInf 2.5581257e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3559552e+02     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39353    5.1645662e+04   0.000000e+00   1.355955e+02     12s
   39378    5.1645662e+04   0.000000e+00   0.000000e+00     12s
   39378    5.1645662e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.164566e+04, 39378 iterations, 9.78 seconds (17.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51645.6618    0  417 -214770.47 51645.6618   124%     -   12s
H    0     0                    -210831.9991 51645.6618   124%     -   12s
H    0     0                    -122638.9889 51645.6618   142%     -   12s
H    0     0                    -120680.5575 51645.6618   143%     -   12s
H    0     0                    -42381.59660 51645.6618   222%     -   13s
H    0     0                    -42355.31766 51645.6618   222%     -   13s
H    0     0                    -6210.566822 51645.6618   932%     -   13s
H    0     0                    2661.5798044 51645.6618  1840%     -   13s
H    0     0                    2823.1092977 51645.6618  1729%     -   13s
H    0     0                    2856.9543764 51645.6618  1708%     -   13s
H    0     0                    3011.3423258 51645.6618  1615%     -   13s
H    0     0                    3965.7555790 45607.2818  1050%     -   69s
H    0     0                    3969.1638256 45607.2818  1049%     -   69s
     0     0 45595.3724    0  462 3969.16383 45595.3724  1049%     -   69s
     0     0 44855.8577    0  491 3969.16383 44855.8577  1030%     -   96s
     0     0 44675.4667    0  497 3969.16383 44675.4667  1026%     -  112s
     0     0 44609.4605    0  499 3969.16383 44609.4605  1024%     -  123s
     0     0 44542.9952    0  507 3969.16383 44542.9952  1022%     -  133s
     0     0 44538.1847    0  511 3969.16383 44538.1847  1022%     -  136s
     0     0 44537.5648    0  503 3969.16383 44537.5648  1022%     -  139s
     0     0 44537.5648    0  489 3969.16383 44537.5648  1022%     -  148s
     0     0 44537.5648    0  494 3969.16383 44537.5648  1022%     -  153s
     0     0 44537.5648    0  490 3969.16383 44537.5648  1022%     -  157s
     0     0 44537.5648    0  482 3969.16383 44537.5648  1022%     -  159s
     0     0 44537.5648    0  482 3969.16383 44537.5648  1022%     -  159s
     0     0 41466.7406    0  519 3969.16383 41466.7406   945%     -  251s
H    0     0                    15674.314767 41466.6501   165%     -  251s
     0     0 40658.7858    0  554 15674.3148 40658.7858   159%     -  295s
     0     0 40269.6286    0  574 15674.3148 40269.6286   157%     -  331s
     0     0 40136.5792    0  587 15674.3148 40136.5792   156%     -  354s
     0     0 40078.2673    0  587 15674.3148 40078.2673   156%     -  370s
     0     0 40059.0024    0  591 15674.3148 40059.0024   156%     -  381s
     0     0 40055.5409    0  590 15674.3148 40055.5409   156%     -  386s
     0     0 40014.9678    0  585 15674.3148 40014.9678   155%     -  397s
     0     0 40011.8821    0  577 15674.3148 40011.8821   155%     -  402s
     0     0 39997.9978    0  573 15674.3148 39997.9978   155%     -  406s
     0     0 39996.3047    0  580 15674.3148 39996.3047   155%     -  408s
     0     0 39995.1021    0  576 15674.3148 39995.1021   155%     -  410s
     0     0 38072.9426    0  561 15674.3148 38072.9426   143%     -  520s
     0     0 37784.5705    0  566 15674.3148 37784.5705   141%     -  564s
     0     0 37568.3157    0  571 15674.3148 37568.3157   140%     -  593s
     0     0 37511.3451    0  617 15674.3148 37511.3451   139%     -  607s
H    0     0                    15858.975747 37477.0105   136%     -  618s
H    0     0                    16414.623200 37477.0105   128%     -  618s
H    0     0                    16452.614770 37477.0105   128%     -  618s
H    0     0                    16457.694895 37477.0105   128%     -  618s
H    0     0                    16834.685369 37477.0105   123%     -  618s
H    0     0                    16909.338562 37477.0105   122%     -  618s
H    0     0                    17023.426024 37477.0105   120%     -  618s
H    0     0                    17183.011968 37477.0105   118%     -  618s
     0     0 37477.0105    0  611 17183.0120 37477.0105   118%     -  618s
     0     0 37435.7726    0  567 17183.0120 37435.7726   118%     -  628s
     0     0 37414.9265    0  580 17183.0120 37414.9265   118%     -  635s
     0     0 37392.3144    0  565 17183.0120 37392.3144   118%     -  644s
     0     0 37378.6141    0  571 17183.0120 37378.6141   118%     -  650s
     0     0 37366.8949    0  577 17183.0120 37366.8949   117%     -  656s
     0     0 37359.5726    0  575 17183.0120 37359.5726   117%     -  660s
     0     0 37355.7641    0  564 17183.0120 37355.7641   117%     -  662s
     0     0 37342.2723    0  560 17183.0120 37342.2723   117%     -  667s
     0     0 37323.2031    0  579 17183.0120 37323.2031   117%     -  672s
     0     0 37309.5655    0  592 17183.0120 37309.5655   117%     -  676s
     0     0 37305.2746    0  606 17183.0120 37305.2746   117%     -  679s
     0     0 37302.4693    0  600 17183.0120 37302.4693   117%     -  681s
     0     0 37301.7037    0  644 17183.0120 37301.7037   117%     -  683s
     0     0 36853.9529    0  396 17183.0120 36853.9529   114%     -  723s
H    0     0                    17238.253138 36853.6727   114%     -  724s
     0     0 36671.0281    0  397 17238.2531 36671.0281   113%     -  743s
     0     0 36567.9023    0  393 17238.2531 36567.9023   112%     -  757s
     0     0 36545.4869    0  398 17238.2531 36545.4869   112%     -  766s
     0     0 36541.4189    0  397 17238.2531 36541.4189   112%     -  770s
H    0     0                    17250.638741 36526.0710   112%     -  778s
     0     0 36526.0710    0  402 17250.6387 36526.0710   112%     -  778s
     0     0 36522.4133    0  398 17250.6387 36522.4133   112%     -  783s
     0     0 36512.3648    0  541 17250.6387 36512.3648   112%     -  789s
     0     0 36509.0147    0  400 17250.6387 36509.0147   112%     -  793s
     0     0 36499.1552    0  397 17250.6387 36499.1552   112%     -  796s
     0     0 36496.3877    0  401 17250.6387 36496.3877   112%     -  799s
     0     0 36493.8794    0  406 17250.6387 36493.8794   112%     -  801s
     0     0 36412.2230    0  518 17250.6387 36412.2230   111%     -  825s
     0     0 36390.4084    0  402 17250.6387 36390.4084   111%     -  854s
     0     0 36384.8974    0  536 17250.6387 36384.8974   111%     -  861s
     0     0 36382.0370    0  538 17250.6387 36382.0370   111%     -  866s
     0     0 36372.4167    0  498 17250.6387 36372.4167   111%     -  870s
     0     0 36353.6992    0  402 17250.6387 36353.6992   111%     -  878s
     0     0 36349.3797    0  616 17250.6387 36349.3797   111%     -  883s
     0     0 36347.2415    0  620 17250.6387 36347.2415   111%     -  886s
     0     0 36311.5397    0  402 17250.6387 36311.5397   110%     -  900s
H    0     0                    17331.928631 36311.1972   110%     -  926s
H    0     0                    17414.122473 36311.1972   109%     -  926s
H    0     0                    19983.027187 36311.1972  81.7%     -  926s
H    0     0                    20072.353475 36311.1972  80.9%     -  927s
H    0     0                    20084.801253 36311.1972  80.8%     -  928s
H    0     0                    20245.952866 36311.1972  79.4%     -  928s
     0     0 36296.6856    0  409 20245.9529 36296.6856  79.3%     -  936s
     0     0 36291.7064    0  408 20245.9529 36291.7064  79.3%     -  940s
     0     0 36290.7888    0  409 20245.9529 36290.7888  79.2%     -  942s
     0     0 36275.9163    0  412 20245.9529 36275.9163  79.2%     -  950s
H    0     0                    20251.032991 36275.8905  79.1%     -  951s
     0     0 36273.3364    0  412 20251.0330 36273.3364  79.1%     -  954s
     0     0 36270.8982    0  568 20251.0330 36270.8982  79.1%     -  962s
     0     0 36268.4047    0  569 20251.0330 36268.4047  79.1%     -  968s
     0     0 36258.7737    0  571 20251.0330 36258.7737  79.0%     -  979s
     0     0 36256.3860    0  410 20251.0330 36256.3860  79.0%     -  983s
     0     0 36251.4016    0  408 20251.0330 36251.4016  79.0%     -  993s
     0     0 36247.3394    0  408 20251.0330 36247.3394  79.0%     -  997s
H    0     0                    20392.622443 36247.0270  77.7%     - 1140s
H    0     0                    20402.429871 36247.0270  77.7%     - 1140s
H    0     0                    20489.545001 36247.0270  76.9%     - 1143s
H    0     0                    20501.792028 36247.0270  76.8%     - 1145s
     0     2 36247.0270    0  408 20501.7920 36247.0270  76.8%     - 1327s
     1     4 36011.3074    1  408 20501.7920 36247.0270  76.8% 11025 1351s
     3     8 35918.6954    2  400 20501.7920 36010.8694  75.6% 13520 1367s
     7    16 35450.1324    3  417 20501.7920 35918.0266  75.2% 14126 1393s
    15    32 35153.8863    4  578 20501.7920 35448.7586  72.9% 18339 1423s
    31    49 26246.1238    5  210 20501.7920 35192.5789  71.7% 23539 1506s
    48    81 33155.0633    6  410 20501.7920 35192.5789  71.7% 26409 1636s
    80   238 32988.6797    7  552 20501.7920 35192.5789  71.7% 20845 1693s
   237   324 32940.8837    9  288 20501.7920 35192.5789  71.7% 11229 1714s
   325   354 32586.7686   10  444 20501.7920 35192.5789  71.7%  9594 1753s
   355   387 32777.9912   12  312 20501.7920 35192.5789  71.7%  9373 1805s
   388   423 32887.0034   12  291 20501.7920 35192.5789  71.7%  9046 1824s
   424   453 32320.8890   13  438 20501.7920 35192.5789  71.7%  8778 1846s
   456   483 32085.8280   13  468 20501.7920 35192.5789  71.7%  8622 1865s
   492   512 31539.4207   13  259 20501.7920 35192.5789  71.7%  8469 1886s
   529   544 31212.7378   14  248 20501.7920 35192.5789  71.7%  8398 1908s
   571   579 22652.3635   24  125 20501.7920 35192.5789  71.7%  8386 1929s
   616   625 31217.0957   14  255 20501.7920 35192.5789  71.7%  8394 1945s
   664   665 30736.2970   16  295 20501.7920 35192.5789  71.7%  8307 1962s
   710   702 30310.5707   17  296 20501.7920 35192.5789  71.7%  8096 1979s
   761   736 29993.9683   18  282 20501.7920 35192.5789  71.7%  7950 1995s
   809   771 27019.9497   17  384 20501.7920 35192.5789  71.7%  7769 2013s
   860   808 29793.6406   19  277 20501.7920 35192.5789  71.7%  7657 2033s
   923   851     cutoff   28      20501.7920 35192.5789  71.7%  7467 2052s
   978   894 27790.7853   20  275 20501.7920 35192.5789  71.7%  7459 2075s
  1033   913 28802.2730   20  263 20501.7920 35192.5789  71.7%  7445 2097s
  1094   930 23533.2503   20  174 20501.7920 35192.5789  71.7%  7308 2117s
  1152   940 27281.8172   21  417 20501.7920 35192.5789  71.7%  7366 2142s
  1194   952 21137.4436   21  260 20501.7920 35192.5789  71.7%  7436 2180s
  1244   967 26818.4585   22  434 20501.7920 35192.5789  71.7%  7483 2208s
  1279   994 24401.7951   24  363 20501.7920 35192.5789  71.7%  7624 2234s
  1322  1022 24242.1840   25  383 20501.7920 35192.5789  71.7%  7746 2260s
  1370  1067 23885.3635   28  422 20501.7920 35192.5789  71.7%  7836 2287s
  1425  1122 22091.4897   34  290 20501.7920 35192.5789  71.7%  7883 2312s
  1490  1176 23332.5705   34  359 20501.7920 35192.5789  71.7%  7880 2340s
  1578  1240 22925.0629   39  310 20501.7920 35192.5789  71.7%  7829 2365s
  1654  1303 22493.5505   42  254 20501.7920 35192.5789  71.7%  7812 2393s
  1763  1338     cutoff   45      20501.7920 35192.5789  71.7%  7702 2426s
  1840  1377     cutoff   47      20501.7920 34893.2317  70.2%  7700 2465s
  1913  1440 33071.4981    7  317 20501.7920 34893.2317  70.2%  7725 2503s
  2004  1496 32030.3739    8  304 20501.7920 34893.2317  70.2%  7691 2541s
  2114  1540 30817.3179    9  285 20501.7920 34762.6072  69.6%  7631 2584s
  2212  1614 28961.0256   11  281 20501.7920 34762.6072  69.6%  7615 2623s
  2332  1674 27941.6316   13  270 20501.7920 34762.6072  69.6%  7590 2666s
  2466  1734 26928.6168   15  210 20501.7920 34762.6072  69.6%  7565 2710s
  2609  1807 26334.9901   18  239 20501.7920 34762.6072  69.6%  7511 2758s
  2758  1870 25269.1612   23  177 20501.7920 34762.6072  69.6%  7495 2806s
  2891  1926 24378.5109   27  168 20501.7920 34627.8293  68.9%  7536 2857s
  2997  1992 22915.7748   33  301 20501.7920 34627.8293  68.9%  7668 2906s
  3109  2093 22378.5029   38  312 20501.7920 34627.8293  68.9%  7785 2958s
  3256  2198 21385.6156   46  229 20501.7920 33813.3467  64.9%  7892 3009s
  3433  2302 31304.3132   14  369 20501.7920 33623.0403  64.0%  7961 3061s
  3587  2406 27417.8027   17  327 20501.7920 33623.0403  64.0%  8083 3123s
  3753  2511 22008.4446   22  165 20501.7920 33623.0403  64.0%  8201 3187s
  3943  2597 21557.8969   27  197 20501.7920 33468.3771  63.2%  8275 3250s

Cutting planes:
  Learned: 2
  Gomory: 5
  Implied bound: 323
  MIR: 3157
  Flow cover: 3369
  RLT: 206
  Relax-and-lift: 1182

Explored 4121 nodes (35273094 simplex iterations) in 3600.03 seconds (8601.29 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20501.8 20489.5 20402.4 ... 17414.1

Time limit reached
Best objective 2.050179202792e+04, best bound 3.328803739993e+04, gap 62.3665%
  WARNING: Time limit reached. Using best solution found (gap: 62.37%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 20501.79, θ = 167614.01
  Upper Bound (UB) = 20501.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 167614.01
  [DEBUG]   ✓ Scenario 0: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 167614.01 ≤ Q = 167614.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 167614.01 ≤ Q = 167614.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x595904bc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa6a6fb44
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356222e+13
Presolve removed 2580 rows and 1872 columns
Presolve time: 0.01s
Presolved: 513 rows, 517 columns, 1447 nonzeros
Found heuristic solution: objective 6904748.8299
Variable types: 351 continuous, 166 integer (166 binary)

Root relaxation: objective -1.445901e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144590.14    0  123 6904748.83 -144590.14   102%     -    0s
H    0     0                    -109092.6159 -144590.14  32.5%     -    0s
H    0     0                    -110359.1066 -144590.14  31.0%     -    0s
     0     0 -112908.33    0   32 -110359.11 -112908.33  2.31%     -    0s
H    0     0                    -110823.7449 -112898.28  1.87%     -    0s
H    0     0                    -111781.6550 -112898.28  1.00%     -    0s
     0     0 -112791.77    0   32 -111781.66 -112791.77  0.90%     -    0s
     0     0 -112759.68    0   32 -111781.66 -112759.68  0.87%     -    0s
H    0     2                    -111793.1939 -112759.68  0.86%     -    0s
     0     2 -112759.68    0   32 -111793.19 -112759.68  0.86%     -    0s
*   11     7               3    -112575.3233 -112648.28  0.06%   7.5    0s

Cutting planes:
  Gomory: 2
  MIR: 135

Explored 22 nodes (637 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -112575 -111793 -111782 ... 1.35622e+13
No other solutions better than -112575

Optimal solution found (tolerance 1.00e-04)
Best objective -1.125753232823e+05, best bound -1.125753232823e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 167573.06
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112575.32
  [DEBUG]   S×d_nominal = 280148.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 280148.38 + -112575.32 = 167573.06
  [DEBUG]   Current θ from Master = 167614.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 40.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20460.84
  Lower Bound (LB) = 20460.84
  Gap (UB-LB) = 40.9540, Absolute Gap = 40.9540, Relative Gap = 0.001998
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 12
Total Time: 27410.32s
Converged: True
Final Lower Bound: 20460.8381
Final Upper Bound: 20501.7920
Final Gap: 40.953956
Number of Critical Scenarios: 12
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 2, 4, 6] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 12
Start Time: 2026-01-05 05:55:34
End Time: 2026-01-05 13:32:25
Total Time: 27410.32s
Optimal Value: 20460.84
Lower Bound: 20460.84
Upper Bound: 20501.79
Gap: 40.953956
Plants Opened: {0: [1], 1: [2], 2: [0]} (3 plants)
DCs Opened: [1, 2, 4, 6] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed31_Mixed_gamma20_20260105_133225.csv

Total Execution Time: 27410.79 seconds
End Time: 2026-01-05 13:32:25

All tasks completed successfully!

