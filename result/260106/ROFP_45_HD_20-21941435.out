
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 45
DI Scenario: HD
Start Time: 2026-01-05 22:33:25
================================================================================
Loading data from data/DH_data_full_seed45.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.451', '2.106'] (k=0.918)
  Product 1: ['1.000', '1.409', '1.984'] (k=0.845)
  Product 2: ['1.000', '1.397', '1.951'] (k=0.824)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=903, max=1710
  DC capacity (MC): min=426, max=852

Demand Structure (s_rk matrix):
  Total customer-product pairs: 78/150 (48.0% sparse)
  Average products per customer: 1.56

Demand (only non-zero entries):
  Nominal (μ): min=8.51, max=34.44, count=78
  Deviation (μ̂): min=4.04, max=9.87

Costs:
  Plant fixed cost: min=5086, max=9697
  DC fixed cost: min=3242, max=5650
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.451', '2.106'] (k=0.918)
    Product 1: ['1.000', '1.409', '1.984'] (k=0.845)
    Product 2: ['1.000', '1.397', '1.951'] (k=0.824)
  MD:
    Product 0: ['1.000', '1.269', '1.609'] (k=0.587)
    Product 1: ['1.000', '1.294', '1.676'] (k=0.637)
    Product 2: ['1.000', '1.195', '1.429'] (k=0.440)
  LD:
    Product 0: ['1.000', '1.001', '1.001'] (k=0.001)
    Product 1: ['1.000', '1.090', '1.189'] (k=0.213)
    Product 2: ['1.000', '1.058', '1.118'] (k=0.138)
  Mixed:
    Product 0: ['1.000', '1.451', '2.106'] (k=0.918)
    Product 1: ['1.000', '1.294', '1.676'] (k=0.637)
    Product 2: ['1.000', '1.058', '1.118'] (k=0.138)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48744 nonzeros
Model fingerprint: 0x2b8ab034
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11953 rows and 2953 columns
Presolve time: 0.08s
Presolved: 4720 rows, 5547 columns, 32846 nonzeros
Variable types: 3288 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -301505.6851
Found heuristic solution: objective -188950.0141

Root relaxation: objective 1.604753e+05, 5850 iterations, 0.30 seconds (0.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 160475.284    0  648 -188950.01 160475.284   185%     -    0s
H    0     0                    -185004.5506 160475.284   187%     -    0s
H    0     0                    -182380.3926 160475.284   188%     -    0s
     0     0 146962.644    0  766 -182380.39 146962.644   181%     -    1s
H    0     0                    -180817.4945 146957.218   181%     -    1s
     0     0 146604.702    0  751 -180817.49 146604.702   181%     -    1s
     0     0 146537.567    0  754 -180817.49 146537.567   181%     -    1s
     0     0 146536.744    0  756 -180817.49 146536.744   181%     -    1s
H    0     0                    -122905.9904 136406.309   211%     -    2s
H    0     0                    -122580.7321 136406.309   211%     -    2s
H    0     0                    -121929.5069 136406.309   212%     -    2s
     0     0 136406.309    0  667 -121929.51 136406.309   212%     -    2s
     0     0 135745.000    0  727 -121929.51 135745.000   211%     -    2s
     0     0 135643.298    0  726 -121929.51 135643.298   211%     -    2s
     0     0 135634.546    0  726 -121929.51 135634.546   211%     -    2s
     0     0 135634.354    0  732 -121929.51 135634.354   211%     -    2s
     0     0 131732.847    0  811 -121929.51 131732.847   208%     -    3s
     0     0 131318.166    0  830 -121929.51 131318.166   208%     -    3s
     0     0 131135.710    0  850 -121929.51 131135.710   208%     -    4s
     0     0 131091.390    0  826 -121929.51 131091.390   208%     -    4s
     0     0 131088.325    0  830 -121929.51 131088.325   208%     -    4s
H    0     0                    12885.755944 131088.325   917%     -    4s
H    0     0                    13198.999973 121155.642   818%     -    5s
H    0     0                    14187.171193 121155.642   754%     -    5s
H    0     0                    28678.496594 121155.642   322%     -    5s
H    0     0                    32918.429876 121155.642   268%     -    5s
H    0     0                    35648.823344 121155.642   240%     -    5s
     0     0 121155.642    0  648 35648.8233 121155.642   240%     -    5s
     0     0 120476.928    0  684 35648.8233 120476.928   238%     -    5s
     0     0 120285.889    0  760 35648.8233 120285.889   237%     -    6s
     0     0 120234.482    0  755 35648.8233 120234.482   237%     -    6s
     0     0 120227.933    0  763 35648.8233 120227.933   237%     -    6s
H    0     0                    35878.417998 116113.937   224%     -    6s
H    0     0                    37483.344673 116113.937   210%     -    6s
H    0     0                    37966.951746 116113.937   206%     -    6s
H    0     0                    38586.482582 116113.937   201%     -    6s
H    0     0                    41888.508945 116113.937   177%     -    6s
H    0     0                    63770.081251 116113.937  82.1%     -    6s
H    0     0                    63802.651947 116113.937  82.0%     -    6s
H    0     0                    67924.074793 116113.937  70.9%     -    6s
     0     0 116113.937    0  651 67924.0748 116113.937  70.9%     -    7s
     0     0 115541.635    0  628 67924.0748 115541.635  70.1%     -    7s
     0     0 115442.035    0  719 67924.0748 115442.035  70.0%     -    7s
     0     0 115414.974    0  739 67924.0748 115414.974  69.9%     -    7s
     0     0 115407.075    0  739 67924.0748 115407.075  69.9%     -    7s
     0     0 113140.808    0  638 67924.0748 113140.808  66.6%     -    8s
     0     0 112654.732    0  689 67924.0748 112654.732  65.9%     -    8s
     0     0 112568.825    0  725 67924.0748 112568.825  65.7%     -    8s
     0     0 112540.204    0  757 67924.0748 112540.204  65.7%     -    8s
     0     0 112525.085    0  736 67924.0748 112525.085  65.7%     -    8s
H    0     0                    67969.292713 111293.116  63.7%     -    9s
H    0     0                    68510.033605 111293.116  62.4%     -    9s
H    0     0                    68544.603065 111293.116  62.4%     -    9s
H    0     0                    68966.316297 111293.116  61.4%     -    9s
H    0     0                    68987.854244 111293.116  61.3%     -    9s
H    0     0                    70093.862878 111293.116  58.8%     -    9s
H    0     0                    70292.920841 111293.116  58.3%     -    9s
H    0     0                    70502.897185 111293.116  57.9%     -    9s
H    0     0                    70565.753607 111293.116  57.7%     -    9s
H    0     0                    72442.464416 111293.116  53.6%     -    9s
H    0     0                    72572.275496 111293.116  53.4%     -    9s
     0     0 111293.116    0  649 72572.2755 111293.116  53.4%     -    9s
H    0     0                    73365.265049 111020.143  51.3%     -    9s
     0     0 111020.143    0  730 73365.2650 111020.143  51.3%     -    9s
     0     0 110960.579    0  794 73365.2650 110960.579  51.2%     -   10s
H    0     0                    74165.554769 110946.469  49.6%     -   10s
H    0     0                    74281.122475 110946.469  49.4%     -   10s
H    0     0                    74585.141638 110946.469  48.8%     -   10s
H    0     0                    75510.310850 110946.469  46.9%     -   10s
     0     0 110946.469    0  789 75510.3109 110946.469  46.9%     -   10s
     0     0 110292.298    0  635 75510.3109 110292.298  46.1%     -   10s
     0     0 110133.602    0  686 75510.3109 110133.602  45.9%     -   10s
     0     0 110035.511    0  655 75510.3109 110035.511  45.7%     -   11s
     0     0 110009.995    0  678 75510.3109 110009.995  45.7%     -   11s
     0     0 109667.814    0  603 75510.3109 109667.814  45.2%     -   11s
     0     0 109557.263    0  561 75510.3109 109557.263  45.1%     -   11s
     0     0 109530.600    0  708 75510.3109 109530.600  45.1%     -   12s
     0     0 109277.547    0  654 75510.3109 109277.547  44.7%     -   12s
     0     0 109246.231    0  631 75510.3109 109246.231  44.7%     -   12s
     0     0 108999.468    0  540 75510.3109 108999.468  44.4%     -   13s
     0     0 108940.224    0  631 75510.3109 108940.224  44.3%     -   13s
H    0     0                    75522.447408 108912.829  44.2%     -   13s
     0     0 108912.829    0  641 75522.4474 108912.829  44.2%     -   13s
H    0     0                    75720.459925 108803.437  43.7%     -   13s
     0     0 108803.437    0  623 75720.4599 108803.437  43.7%     -   13s
     0     0 108802.628    0  623 75720.4599 108802.628  43.7%     -   13s
     0     2 108802.509    0  623 75720.4599 108802.509  43.7%     -   14s
     7    16 107735.633    3  535 75720.4599 108723.821  43.6%  1051   15s
H   31    64                    75928.942413 108337.651  42.7%  1670   17s
H   33    64                    77356.127605 108337.651  40.1%  1627   17s
H   61    64                    77554.569869 107877.307  39.1%  1688   17s
H   95   189                    78528.713099 107875.328  37.4%  1532   19s
H   99   189                    79284.283649 107875.328  36.1%  1484   19s
H  101   189                    80437.278969 107875.328  34.1%  1463   19s
H  107   189                    80471.529742 107875.328  34.1%  1422   19s
H  109   189                    80849.252046 107875.328  33.4%  1404   19s
H  132   189                    81010.606233 107875.328  33.2%  1243   19s
H  133   189                    81083.833079 107875.328  33.0%  1237   19s
H  148   189                    81420.421306 107875.328  32.5%  1151   19s
H  150   189                    81521.632983 107875.328  32.3%  1147   19s
   275   308 105337.020   12  577 81521.6330 107875.328  32.3%   888   20s
H  491   490                    83892.410023 107860.675  28.6%   932   24s
   497   567 101376.524   18  543 83892.4100 107860.675  28.6%   929   25s
H  675   729                    84039.388646 107860.675  28.3%   889   27s
H  808   827                    84265.560093 107608.369  27.7%   852   28s
H  818   827                    84378.413711 107608.369  27.5%   855   28s
H  822   827                    84402.782621 107608.369  27.5%   854   28s
H  823   827                    84463.901840 107608.369  27.4%   854   28s
H  826   827                    84665.813872 107608.369  27.1%   854   28s
   958   962 98094.0808   28  530 84665.8139 107608.369  27.1%   816   30s
H 1137  1069                    85001.577339 107608.369  26.6%   809   31s
  1574  1601 96303.1904   44  410 85001.5773 107608.369  26.6%   729   35s
  3368  3243 93411.3829   74  320 85001.5773 107254.470  26.2%   496   40s
  4142  3655 88528.0205   96  623 85001.5773 107254.470  26.2%   464   48s
  4166  3671 89416.0694   82  373 85001.5773 103824.460  22.1%   461   50s
H 4383  3622                    85909.924497 98543.9811  14.7%   460   53s
H 4413  3493                    86281.857340 98543.9811  14.2%   459   53s
H 4445  3316                    86398.760037 98543.9811  14.1%   458   53s
H 4466  3151                    86412.100939 98543.9811  14.0%   457   53s
H 4565  3040                    86472.261980 97815.3818  13.1%   452   54s
H 4575  2894                    86501.772765 97815.3818  13.1%   451   54s
H 4582  2756                    86504.254961 97815.3818  13.1%   451   54s
H 4610  2618                    86644.090528 97815.3818  12.9%   449   54s
H 4688  2536                    86704.251569 97815.3818  12.8%   445   54s
H 4700  2415                    86736.244549 97815.3818  12.8%   445   54s
H 4710  2302                    86793.923394 97815.3818  12.7%   444   54s
H 4773  2207                    87237.802521 97815.3818  12.1%   441   54s
  4810  2215 92338.0615   24  183 87237.8025 97585.0569  11.9%   439   55s
H 4876  2112                    87364.386204 97585.0569  11.7%   436   55s
H 5033  1998                    87971.346719 97302.6891  10.6%   427   55s
H 5155  1902                    88346.679255 96919.3399  9.70%   422   56s
H 5173  1811                    88449.909618 96919.3399  9.58%   421   56s
H 5179  1728                    88482.998045 96478.9615  9.04%   421   56s
H 5203  1643                    88519.709041 96478.9615  8.99%   421   56s
H 5301  1597                    88631.413122 96478.9615  8.85%   416   56s
H 5336  1516                    88772.960435 96478.9615  8.68%   415   56s
H 5430  1458                    88839.055037 96478.9615  8.60%   410   56s
H 5498  1372                    88902.162553 96478.9615  8.52%   407   57s
H 6463  1264                    88916.195708 95390.7581  7.28%   367   58s
H 6603  1196                    88926.692010 95035.2245  6.87%   363   58s
H 6604  1141                    88926.915308 95035.2245  6.87%   363   58s
H 6623  1084                    89008.031257 95035.2245  6.77%   362   58s
  7911  1200 91387.8870   21  282 89008.0313 94108.8641  5.73%   331   60s
*22738  2280              84    89028.684062 89368.5429  0.38%   165   64s
 23628  2250 89067.4732   75   16 89028.6841 89321.0138  0.33%   160   65s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 259
  Mixing: 1
  Flow cover: 380
  RLT: 1
  Relax-and-lift: 30

Explored 32335 nodes (4030866 simplex iterations) in 66.65 seconds (148.70 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 89028.7 89028.7 89008 ... 88631.4

Optimal solution found (tolerance 1.00e-04)
Best objective 8.902868406245e+04, best bound 8.902868406245e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 66.66s
  Master Objective (UB) = 89028.68, θ = 237211.39
  Upper Bound (UB) = 89028.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 237211.39
  [DEBUG]   ✓ Scenario 0: θ = 237211.39 ≤ Q = 237211.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x135640a5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x135640a5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.497513e+13
Presolve removed 2613 rows and 1905 columns
Presolve time: 0.00s
Presolved: 480 rows, 484 columns, 1353 nonzeros
Found heuristic solution: objective 7352682.2237
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.533378e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153337.84    0  122 7352682.22 -153337.84   102%     -    0s
H    0     0                    -121329.4252 -153337.84  26.4%     -    0s
H    0     0                    -122591.4052 -153337.84  25.1%     -    0s
*    0     0               0    -123801.3516 -123801.35  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 200

Explored 1 nodes (370 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -123801 -122591 -121329 ... 1.49751e+13
No other solutions better than -123801

Optimal solution found (tolerance 1.00e-04)
Best objective -1.238013516283e+05, best bound -1.238013516283e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 203713.99
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123801.35
  [DEBUG]   S×d_nominal = 327515.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 327515.34 + -123801.35 = 203713.99
  [DEBUG]   Current θ from Master = 237211.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33497.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 55531.28
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 33497.4019, Absolute Gap = 33497.4019, Relative Gap = 0.376254
  Not converged yet (gap = 33497.40 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91969 nonzeros
Model fingerprint: 0x42c090c2
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 55531.3 (0.01s)
MIP start from previous solve produced solution with objective 55531.3 (0.01s)
Loaded MIP start from previous solve with objective 55531.3

Presolve removed 14545 rows and 5904 columns
Presolve time: 0.28s
Presolved: 17418 rows, 8836 columns, 96338 nonzeros
Variable types: 6577 continuous, 2259 integer (2259 binary)

Root relaxation: objective 9.947552e+04, 10122 iterations, 1.16 seconds (2.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 99475.5169    0  325 55531.2822 99475.5169  79.1%     -    1s
H    0     0                    60917.868092 99475.5169  63.3%     -    1s
H    0     0                    61180.687830 99475.5169  62.6%     -    1s
H    0     0                    65948.863855 99475.5169  50.8%     -    1s
H    0     0                    66663.376092 99475.5169  49.2%     -    1s
H    0     0                    66801.341861 99475.5169  48.9%     -    1s
     0     0 90207.6025    0  334 66801.3419 90207.6025  35.0%     -    2s
H    0     0                    66956.277729 90178.0793  34.7%     -    2s
     0     0 89586.1509    0  311 66956.2777 89586.1509  33.8%     -    2s
     0     0 89565.9977    0  366 66956.2777 89565.9977  33.8%     -    3s
     0     0 89564.9986    0  365 66956.2777 89564.9986  33.8%     -    3s
     0     0 85406.3812    0  358 66956.2777 85406.3812  27.6%     -    4s
H    0     0                    67539.285999 84659.9037  25.3%     -    4s
     0     0 84659.9037    0  394 67539.2860 84659.9037  25.3%     -    4s
     0     0 84406.5219    0  394 67539.2860 84406.5219  25.0%     -    4s
     0     0 84363.3971    0  378 67539.2860 84363.3971  24.9%     -    5s
     0     0 84340.6908    0  398 67539.2860 84340.6908  24.9%     -    5s
     0     0 84333.7575    0  395 67539.2860 84333.7575  24.9%     -    5s
     0     0 84332.6148    0  401 67539.2860 84332.6148  24.9%     -    5s
     0     0 81917.4487    0  416 67539.2860 81917.4487  21.3%     -    6s
     0     0 80852.7118    0  519 67539.2860 80852.7118  19.7%     -    7s
     0     0 80652.4973    0  514 67539.2860 80652.4973  19.4%     -    7s
     0     0 80567.4812    0  535 67539.2860 80567.4812  19.3%     -    8s
     0     0 80564.2592    0  539 67539.2860 80564.2592  19.3%     -    8s
     0     0 79386.1371    0  379 67539.2860 79386.1371  17.5%     -    9s
     0     0 79035.5858    0  375 67539.2860 79035.5858  17.0%     -   10s
     0     0 78839.3281    0  426 67539.2860 78839.3281  16.7%     -   10s
     0     0 78754.7332    0  426 67539.2860 78754.7332  16.6%     -   11s
     0     0 78695.9792    0  428 67539.2860 78695.9792  16.5%     -   11s
     0     0 78685.3690    0  433 67539.2860 78685.3690  16.5%     -   11s
     0     0 78684.0781    0  435 67539.2860 78684.0781  16.5%     -   11s
     0     0 78309.8210    0  343 67539.2860 78309.8210  15.9%     -   12s
     0     0 78188.5554    0  347 67539.2860 78188.5554  15.8%     -   12s
     0     0 78157.2990    0  344 67539.2860 78157.2990  15.7%     -   12s
     0     0 78150.8354    0  409 67539.2860 78150.8354  15.7%     -   12s
     0     0 78144.4618    0  349 67539.2860 78144.4618  15.7%     -   12s
     0     0 78144.1474    0  360 67539.2860 78144.1474  15.7%     -   12s
     0     0 78050.5526    0  334 67539.2860 78050.5526  15.6%     -   13s
     0     0 78038.5980    0  331 67539.2860 78038.5980  15.5%     -   13s
     0     0 78033.6356    0  325 67539.2860 78033.6356  15.5%     -   13s
     0     0 77976.8238    0  315 67539.2860 77976.8238  15.5%     -   14s
     0     0 77962.1103    0  331 67539.2860 77962.1103  15.4%     -   14s
     0     0 77959.0967    0  333 67539.2860 77959.0967  15.4%     -   14s
     0     0 77909.3457    0  317 67539.2860 77909.3457  15.4%     -   14s
     0     0 77900.4406    0  311 67539.2860 77900.4406  15.3%     -   15s
     0     0 77893.6562    0  369 67539.2860 77893.6562  15.3%     -   15s
     0     0 77888.3947    0  323 67539.2860 77888.3947  15.3%     -   15s
     0     0 77884.5989    0  317 67539.2860 77884.5989  15.3%     -   15s
     0     0 77880.5998    0  322 67539.2860 77880.5998  15.3%     -   15s
     0     0 77878.7670    0  321 67539.2860 77878.7670  15.3%     -   15s
     0     0 77878.5536    0  321 67539.2860 77878.5536  15.3%     -   16s
     0     2 77878.5536    0  321 67539.2860 77878.5536  15.3%     -   18s
     7    16 77362.5857    3  435 67539.2860 77462.0366  14.7%   868   20s
   188   226 74310.5041    8  355 67539.2860 76686.4577  13.5%   708   26s
   446   492 74194.1736   12  415 67539.2860 76665.8551  13.5%   590   30s
   692   632 69526.1967   15  225 67539.2860 76377.8971  13.1%   605   35s
  1076   952 72200.5265   23  359 67539.2860 76228.2701  12.9%   610   40s
  1576  1277     cutoff   33      67539.2860 76116.9395  12.7%   606   46s
  1869  1437 68305.1414   12  113 67539.2860 76116.9395  12.7%   629   50s
  2238  1578 67940.0618   10  272 67539.2860 75871.2584  12.3%   630   55s
  2553  1743 70369.4479   12  310 67539.2860 75747.5622  12.2%   637   60s
  2993  1882 73647.2296   18  420 67539.2860 75491.2342  11.8%   643   65s
  3699  2137 72004.2820   17  298 67539.2860 75333.8992  11.5%   650   71s
  4049  2256 68748.0711   24  315 67539.2860 75319.3343  11.5%   646   75s
  4777  2524 68461.4668   15  266 67539.2860 75011.0566  11.1%   636   81s
  5171  2647     cutoff   15      67539.2860 74941.2950  11.0%   638   86s
  5760  2748 70088.3560   28  321 67539.2860 74862.6666  10.8%   634   95s
  5770  2755 71903.6462   11  326 67539.2860 74862.6666  10.8%   633  100s
  5781  2762 71576.1591   32  325 67539.2860 74862.6666  10.8%   632  105s
  5789  2767 70978.7379   20  326 67539.2860 74862.6666  10.8%   631  110s
  5880  2846 71631.5491   22  328 67539.2860 72951.8879  8.01%   637  115s
  6500  2613 70072.1696   27  307 67539.2860 71336.5153  5.62%   605  120s

Cutting planes:
  MIR: 117
  Flow cover: 272
  RLT: 6
  Relax-and-lift: 26

Explored 6754 nodes (4029420 simplex iterations) in 122.86 seconds (325.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: 67539.3 66956.3 66801.3 ... 55531.3

Optimal solution found (tolerance 1.00e-04)
Best objective 6.753928599869e+04, best bound 6.753928599869e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 122.87s
  Master Objective (UB) = 67539.29, θ = 215172.90
  Upper Bound (UB) = 67539.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215172.90
  [DEBUG]   ✓ Scenario 0: θ = 215172.90 ≤ Q = 215172.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215172.90 ≤ Q = 215172.90 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x157a4b50
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x157a4b50
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.496106e+13
Presolve removed 2613 rows and 1905 columns
Presolve time: 0.00s
Presolved: 480 rows, 484 columns, 1353 nonzeros
Found heuristic solution: objective 7218170.8643
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.675895e+05, 271 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167589.49    0  130 7218170.86 -167589.49   102%     -    0s
H    0     0                    -128329.7254 -167589.49  30.6%     -    0s
H    0     0                    -129112.3851 -167589.49  29.8%     -    0s
H    0     0                    -144239.2309 -167589.49  16.2%     -    0s
H    0     0                    -156332.3758 -167589.49  7.20%     -    0s
     0     0 -161682.17    0  114 -156332.38 -161682.17  3.42%     -    0s
H    0     0                    -156417.6755 -161437.33  3.21%     -    0s
H    0     0                    -156711.1606 -161437.33  3.02%     -    0s
     0     0 -158350.52    0  116 -156711.16 -158350.52  1.05%     -    0s
     0     0 -158340.51    0  116 -156711.16 -158340.51  1.04%     -    0s
     0     0 -158339.31    0  115 -156711.16 -158339.31  1.04%     -    0s
     0     0 -157586.33    0   66 -156711.16 -157586.33  0.56%     -    0s
H    0     0                    -156887.7955 -157575.61  0.44%     -    0s
     0     0 -157482.07    0   43 -156887.80 -157482.07  0.38%     -    0s
     0     0 -157460.73    0   45 -156887.80 -157460.73  0.37%     -    0s
     0     0 -157456.49    0   45 -156887.80 -157456.49  0.36%     -    0s
H    0     0                    -157105.3824 -157455.44  0.22%     -    0s
     0     0 -157455.44    0   45 -157105.38 -157455.44  0.22%     -    0s
     0     0 -157441.38    0   42 -157105.38 -157441.38  0.21%     -    0s
     0     0 -157436.49    0   41 -157105.38 -157436.49  0.21%     -    0s
     0     0 -157435.88    0   41 -157105.38 -157435.88  0.21%     -    0s
     0     0 -157302.93    0    7 -157105.38 -157302.93  0.13%     -    0s
H    0     0                    -157154.1822 -157294.38  0.09%     -    0s
H    0     0                    -157166.7763 -157294.38  0.08%     -    0s
H    0     0                    -157178.3124 -157294.38  0.07%     -    0s
     0     0 -157294.38    0    7 -157178.31 -157294.38  0.07%     -    0s
     0     0 -157293.87    0    7 -157178.31 -157293.87  0.07%     -    0s
     0     0 -157293.87    0   22 -157178.31 -157293.87  0.07%     -    0s
     0     0 -157271.29    0    5 -157178.31 -157271.29  0.06%     -    0s
H    0     0                    -157237.2369 -157260.70  0.01%     -    0s
     0     0 -157260.70    0    4 -157237.24 -157260.70  0.01%     -    0s
     0     0 -157260.70    0    2 -157237.24 -157260.70  0.01%     -    0s
H    0     0                    -157254.4295 -157260.70  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 5
  MIR: 12
  Flow cover: 9
  Relax-and-lift: 4

Explored 1 nodes (898 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -157254 -157237 -157178 ... -156332
No other solutions better than -157254

Optimal solution found (tolerance 1.00e-04)
Best objective -1.572544294933e+05, best bound -1.572544294933e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 191628.87
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157254.43
  [DEBUG]   S×d_nominal = 348883.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348883.30 + -157254.43 = 191628.87
  [DEBUG]   Current θ from Master = 215172.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23544.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43995.26
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 12008.0038, Absolute Gap = 12008.0038, Relative Gap = 0.177793
  Not converged yet (gap = 12008.00 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135194 nonzeros
Model fingerprint: 0xa512e8b6
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 43995.3 (0.02s)
Loaded MIP start from previous solve with objective 43995.3

Presolve removed 21816 rows and 8856 columns
Presolve time: 0.36s
Presolved: 25437 rows, 12124 columns, 142199 nonzeros
Variable types: 9865 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.16s

Solved with primal simplex

Root relaxation: objective 9.796336e+04, 40812 iterations, 4.31 seconds (8.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 97963.3607    0  312 43995.2556 97963.3607   123%     -    4s
H    0     0                    61210.826546 97963.3607  60.0%     -    4s
H    0     0                    62190.530974 97963.3607  57.5%     -    4s
H    0     0                    63073.036455 97963.3607  55.3%     -    4s
     0     0 89358.2373    0  319 63073.0365 89358.2373  41.7%     -    7s
H    0     0                    64158.591057 89350.1778  39.3%     -    7s
     0     0 89046.1010    0  323 64158.5911 89046.1010  38.8%     -    8s
     0     0 88880.6428    0  356 64158.5911 88880.6428  38.5%     -    8s
     0     0 88813.4789    0  325 64158.5911 88813.4789  38.4%     -    8s
     0     0 88813.4789    0  320 64158.5911 88813.4789  38.4%     -    9s
     0     0 84914.3694    0  399 64158.5911 84914.3694  32.4%     -   11s
     0     0 84185.7100    0  413 64158.5911 84185.7100  31.2%     -   13s
     0     0 83763.6691    0  424 64158.5911 83763.6691  30.6%     -   14s
     0     0 83620.9429    0  431 64158.5911 83620.9429  30.3%     -   14s
     0     0 83586.5409    0  432 64158.5911 83586.5409  30.3%     -   14s
     0     0 83579.9400    0  436 64158.5911 83579.9400  30.3%     -   14s
     0     0 83579.3351    0  439 64158.5911 83579.3351  30.3%     -   14s
H    0     0                    64346.701368 83579.3351  29.9%     -   16s
     0     0 80727.0268    0  330 64346.7014 80727.0268  25.5%     -   19s
H    0     0                    65249.539959 80726.0083  23.7%     -   19s
     0     0 80319.6868    0  370 65249.5400 80319.6868  23.1%     -   20s
     0     0 79994.8516    0  375 65249.5400 79994.8516  22.6%     -   21s
     0     0 79791.3080    0  323 65249.5400 79791.3080  22.3%     -   22s
     0     0 79746.2172    0  371 65249.5400 79746.2172  22.2%     -   23s
     0     0 79728.5874    0  323 65249.5400 79728.5874  22.2%     -   23s
     0     0 79709.5849    0  386 65249.5400 79709.5849  22.2%     -   24s
     0     0 79700.7059    0  380 65249.5400 79700.7059  22.1%     -   24s
     0     0 79699.1011    0  385 65249.5400 79699.1011  22.1%     -   24s
     0     0 78242.5092    0  334 65249.5400 78242.5092  19.9%     -   29s
     0     0 77951.9111    0  333 65249.5400 77951.9111  19.5%     -   31s
     0     0 77859.6510    0  330 65249.5400 77859.6510  19.3%     -   31s
     0     0 77758.4607    0  329 65249.5400 77758.4607  19.2%     -   32s
     0     0 77729.0307    0  327 65249.5400 77729.0307  19.1%     -   33s
     0     0 77719.2418    0  335 65249.5400 77719.2418  19.1%     -   33s
     0     0 77715.7314    0  326 65249.5400 77715.7314  19.1%     -   33s
     0     0 77327.1275    0  368 65249.5400 77327.1275  18.5%     -   35s
     0     0 77197.5025    0  364 65249.5400 77197.5025  18.3%     -   36s
     0     0 77113.0761    0  361 65249.5400 77113.0761  18.2%     -   37s
     0     0 77079.8335    0  420 65249.5400 77079.8335  18.1%     -   37s
     0     0 77070.0050    0  378 65249.5400 77070.0050  18.1%     -   38s
     0     0 77065.1692    0  380 65249.5400 77065.1692  18.1%     -   38s
     0     0 77062.5150    0  431 65249.5400 77062.5150  18.1%     -   38s
     0     0 76856.9531    0  319 65249.5400 76856.9531  17.8%     -   40s
H    0     0                    65252.253877 76856.9520  17.8%     -   40s
H    0     0                    65467.988879 76856.9520  17.4%     -   40s
     0     0 76826.2715    0  297 65467.9889 76826.2715  17.3%     -   41s
     0     0 76817.7836    0  339 65467.9889 76817.7836  17.3%     -   41s
     0     0 76814.8581    0  327 65467.9889 76814.8581  17.3%     -   41s
     0     0 76738.0669    0  325 65467.9889 76738.0669  17.2%     -   42s
     0     0 76710.6983    0  320 65467.9889 76710.6983  17.2%     -   43s
     0     0 76705.6165    0  322 65467.9889 76705.6165  17.2%     -   43s
     0     0 76664.5797    0  335 65467.9889 76664.5797  17.1%     -   44s
     0     0 76662.3009    0  318 65467.9889 76662.3009  17.1%     -   45s
     0     0 76650.8983    0  339 65467.9889 76650.8983  17.1%     -   46s
     0     0 76645.5421    0  327 65467.9889 76645.5421  17.1%     -   46s
     0     0 76642.0915    0  328 65467.9889 76642.0915  17.1%     -   46s
     0     0 76632.4554    0  323 65467.9889 76632.4554  17.1%     -   47s
     0     0 76631.6297    0  323 65467.9889 76631.6297  17.1%     -   47s
H    0     0                    65680.631604 76631.2437  16.7%     -   51s
H    0     0                    65758.695355 76631.2286  16.5%     -   54s
     0     2 76631.2286    0  323 65758.6954 76631.2286  16.5%     -   55s
     7    16 75551.9200    3  371 65758.6954 76076.4944  15.7%  3702   62s
    31    50 73896.6736    5  387 65758.6954 75336.2882  14.6%  4529   75s
    81   172 73862.5100    7  367 65758.6954 75336.2882  14.6%  4364   82s
   171   273 73762.5100   10  327 65758.6954 75336.2882  14.6%  2760   85s
   372   452 73646.8533   12  369 65758.6954 75336.2882  14.6%  1941   90s
   559   617 72695.6885   14  315 65758.6954 75336.2882  14.6%  1571   95s
   812   813 68893.6712   16  150 65758.6954 75336.2882  14.6%  1360  104s
   900   849 72288.4199   17  269 65758.6954 75336.2882  14.6%  1322  107s
   976   898 71702.1001   17  174 65758.6954 75336.2882  14.6%  1345  110s
  1041   922 72004.4045   18  266 65758.6954 75336.2882  14.6%  1384  116s
  1156  1006 71951.2941   19  265 65758.6954 75041.0113  14.1%  1403  122s
  1221  1041 71232.2653   20  167 65758.6954 75041.0113  14.1%  1445  125s
  1334  1127 69814.2934   21  256 65758.6954 75029.6612  14.1%  1545  131s
  1460  1194 70623.4259   22  240 65758.6954 74893.9563  13.9%  1646  140s
  1562  1232 70399.7781   23  246 65758.6954 74732.9935  13.6%  1731  149s
  1622  1235 69567.8033   22  142 65758.6954 74732.9935  13.6%  1795  154s
  1679  1254     cutoff   24      65758.6954 74732.9935  13.6%  1858  160s
  1804  1299 66882.7705   27  169 65758.6954 74542.0895  13.4%  1995  168s
  1887  1334 66808.5202   31  126 65758.6954 74542.0895  13.4%  2015  174s
  1968  1379 66742.5898   35  141 65758.6954 74542.0895  13.4%  2054  180s
  2158  1443 71407.2894   12  303 65758.6954 74320.3752  13.0%  2111  188s
  2246  1484 71214.4053   13  311 65758.6954 74320.3752  13.0%  2115  192s
  2329  1514     cutoff   14      65758.6954 74320.3752  13.0%  2131  197s
  2447  1565 68382.7248   15  236 65758.6954 74261.1243  12.9%  2138  201s
  2565  1631 66293.7145   17  170 65758.6954 74261.1243  12.9%  2149  206s
  2697  1691 71202.8833   15  174 65758.6954 74261.1243  12.9%  2159  210s
  2857  1758 66666.5353   18   88 65758.6954 74120.9218  12.7%  2146  216s
  3002  1846 69477.1794    9  269 65758.6954 74120.9218  12.7%  2167  224s
  3156  1905 68142.5047   10  306 65758.6954 74120.9218  12.7%  2159  230s
  3310  1950 67165.7298   13  254 65758.6954 74002.0229  12.5%  2173  235s
  3449  1997 66761.2276   15  175 65758.6954 73981.9510  12.5%  2181  240s
  3589  2023 71804.2823   13  285 65758.6954 73692.4543  12.1%  2192  245s
  3748  2129 68552.2697   16  223 65758.6954 73674.3018  12.0%  2201  250s
  3924  2212 67092.9122   23  178 65758.6954 73674.3018  12.0%  2213  255s
  4139  2287 66244.1973   11  384 65758.6954 73663.3057  12.0%  2203  262s
  4372  2390 71393.4855   11  331 65758.6954 73569.2367  11.9%  2195  270s
  4585  2427 69083.5840   12  323 65758.6954 73569.2367  11.9%  2199  276s
  4823  2483 66043.7966   15  198 65758.6954 73569.2367  11.9%  2179  284s
  5026  2556     cutoff   15      65758.6954 73466.7131  11.7%  2188  292s
  5294  2618     cutoff   13      65758.6954 73419.0761  11.6%  2190  302s
  5478  2684     cutoff   13      65758.6954 73419.0761  11.6%  2175  309s
  5677  2732 68041.6966   14  288 65758.6954 73380.3554  11.6%  2186  317s
  5897  2803 66161.2784   17  130 65758.6954 73211.5616  11.3%  2183  326s
  6153  2804 71393.4259   29  323 65758.6954 73211.5616  11.3%  2190  340s
  6155  2805 72662.5326   14  159 65758.6954 73211.5616  11.3%  2189  345s
  6159  2808 66339.4984   19  310 65758.6954 73211.5616  11.3%  2187  350s
  6166  2813 70362.7900   18  302 65758.6954 73211.5616  11.3%  2185  355s
  6177  2820 71095.3801   12  321 65758.6954 72728.3309  10.6%  2181  360s
  6183  2824 70020.3596   14  334 65758.6954 72531.4140  10.3%  2179  365s
  6189  2828 72298.4105   14  362 65758.6954 72474.0940  10.2%  2177  370s
  6190  2829 69515.6811   16  362 65758.6954 72474.0940  10.2%  2176  375s
  6194  2836 70295.0241   13  332 65758.6954 72029.0492  9.54%  2186  380s
  6220  2861 66007.0781   16  221 65758.6954 70953.0782  7.90%  2187  385s
  6321  2861 69436.1577   19  272 65758.6954 69890.8872  6.28%  2185  390s
  6481  2850 69299.1876   20  314 65758.6954 69322.1893  5.42%  2159  395s
  6686  2774 68176.4837   21  287 65758.6954 69297.2545  5.38%  2116  400s
  6981  2645 67448.5433   24  165 65758.6954 68722.5941  4.51%  2059  406s
  7257  2475     cutoff   20      65758.6954 66351.7604  0.90%  1999  410s

Cutting planes:
  Gomory: 2
  MIR: 167
  Mixing: 1
  Flow cover: 328
  RLT: 3
  Relax-and-lift: 41

Explored 7268 nodes (14622879 simplex iterations) in 411.42 seconds (1112.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 65758.7 65468 65252.3 ... 43995.3

Optimal solution found (tolerance 1.00e-04)
Best objective 6.575869535488e+04, best bound 6.575869535488e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 411.44s
  Master Objective (UB) = 65758.70, θ = 214390.88
  Upper Bound (UB) = 65758.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214390.88
  [DEBUG]   ✓ Scenario 0: θ = 214390.88 ≤ Q = 214390.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214390.88 ≤ Q = 214390.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214390.88 ≤ Q = 214390.88 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2d9182ff
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd26e7d01
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.498954e+13
Presolve removed 2613 rows and 1905 columns
Presolve time: 0.00s
Presolved: 480 rows, 484 columns, 1353 nonzeros
Found heuristic solution: objective 7226473.1286
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.668434e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166843.36    0  128 7226473.13 -166843.36   102%     -    0s
H    0     0                    -131589.0629 -166843.36  26.8%     -    0s
H    0     0                    -132613.9706 -166843.36  25.8%     -    0s
H    0     0                    -135781.3663 -166843.36  22.9%     -    0s
H    0     0                    -138144.8476 -150798.08  9.16%     -    0s
     0     0 -150798.08    0  101 -138144.85 -150798.08  9.16%     -    0s
H    0     0                    -146648.2985 -150669.32  2.74%     -    0s
     0     0 -150235.62    0  102 -146648.30 -150235.62  2.45%     -    0s
     0     0 -150222.85    0  102 -146648.30 -150222.85  2.44%     -    0s
H    0     0                    -147297.2671 -150222.85  1.99%     -    0s
     0     0 -149255.72    0   61 -147297.27 -149255.72  1.33%     -    0s
H    0     0                    -148960.2369 -149252.47  0.20%     -    0s
     0     0 -149149.23    0   56 -148960.24 -149149.23  0.13%     -    0s
     0     0 -149033.46    0   22 -148960.24 -149033.46  0.05%     -    0s
     0     0 -148993.61    0    6 -148960.24 -148993.61  0.02%     -    0s
     0     0 -148986.74    0    6 -148960.24 -148986.74  0.02%     -    0s
     0     0          -    0      -148960.24 -148974.55  0.01%     -    0s

Cutting planes:
  Gomory: 32
  Implied bound: 3
  MIR: 156
  Flow cover: 1
  RLT: 36
  Relax-and-lift: 2

Explored 1 nodes (616 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -148960 -147297 -138145 ... 1.49895e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.489602368594e+05, best bound -1.489745462546e+05, gap 0.0096%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 199923.07
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148960.24
  [DEBUG]   S×d_nominal = 348883.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348883.30 + -148960.24 = 199923.07
  [DEBUG]   Current θ from Master = 214390.88
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14467.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 51290.88
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 10227.4132, Absolute Gap = 10227.4132, Relative Gap = 0.155529
  Not converged yet (gap = 10227.41 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178419 nonzeros
Model fingerprint: 0x59793378
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 51290.9 (0.02s)
MIP start from previous solve produced solution with objective 51290.9 (0.03s)
Loaded MIP start from previous solve with objective 51290.9

Presolve removed 29088 rows and 11808 columns
Presolve time: 0.52s
Presolved: 33455 rows, 15412 columns, 206479 nonzeros
Variable types: 13153 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33455 rows, 15412 columns, 206479 nonzeros

Concurrent spin time: 0.21s

Solved with dual simplex

Root relaxation: objective 9.024491e+04, 18673 iterations, 4.05 seconds (8.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 90244.9148    0  159 51290.8831 90244.9148  75.9%     -    4s
H    0     0                    59345.859229 90244.9148  52.1%     -    4s
H    0     0                    65168.785549 90244.9148  38.5%     -    4s
     0     0 80212.9077    0  211 65168.7855 80212.9077  23.1%     -    8s
     0     0 79688.7014    0  185 65168.7855 79688.7014  22.3%     -    9s
     0     0 79688.7014    0  190 65168.7855 79688.7014  22.3%     -   10s
     0     0 79688.7014    0  189 65168.7855 79688.7014  22.3%     -   10s
H    0     0                    65273.775955 77936.2472  19.4%     -   12s
     0     0 77563.8662    0  271 65273.7760 77563.8662  18.8%     -   12s
H    0     0                    65322.103846 76962.6327  17.8%     -   14s
     0     0 76962.6327    0  282 65322.1038 76962.6327  17.8%     -   14s
     0     0 76850.6934    0  278 65322.1038 76850.6934  17.6%     -   14s
     0     0 76680.4824    0  279 65322.1038 76680.4824  17.4%     -   15s
     0     0 76664.0763    0  279 65322.1038 76664.0763  17.4%     -   15s
     0     0 76662.2780    0  277 65322.1038 76662.2780  17.4%     -   15s
     0     0 76662.1325    0  277 65322.1038 76662.1325  17.4%     -   15s
     0     0 75509.5214    0  250 65322.1038 75509.5214  15.6%     -   18s
     0     0 75148.1694    0  257 65322.1038 75148.1694  15.0%     -   20s
     0     0 75009.3695    0  259 65322.1038 75009.3695  14.8%     -   21s
     0     0 74957.5750    0  260 65322.1038 74957.5750  14.8%     -   21s
     0     0 74942.9364    0  261 65322.1038 74942.9364  14.7%     -   21s
     0     0 74928.1799    0  269 65322.1038 74928.1799  14.7%     -   21s
     0     0 74922.8737    0  270 65322.1038 74922.8737  14.7%     -   22s
     0     0 74919.0953    0  268 65322.1038 74919.0953  14.7%     -   22s
     0     0 74918.0225    0  266 65322.1038 74918.0225  14.7%     -   22s
     0     0 74074.9890    0  291 65322.1038 74074.9890  13.4%     -   25s
     0     0 73824.4910    0  307 65322.1038 73824.4910  13.0%     -   27s
     0     0 73451.1268    0  316 65322.1038 73451.1268  12.4%     -   29s
     0     0 73364.4020    0  293 65322.1038 73364.4020  12.3%     -   30s
     0     0 73343.9479    0  293 65322.1038 73343.9479  12.3%     -   30s
     0     0 73336.8978    0  297 65322.1038 73336.8978  12.3%     -   30s
     0     0 73329.4600    0  329 65322.1038 73329.4600  12.3%     -   31s
     0     0 73328.2683    0  305 65322.1038 73328.2683  12.3%     -   31s
     0     0 73124.7997    0  307 65322.1038 73124.7997  11.9%     -   32s
     0     0 73080.8749    0  350 65322.1038 73080.8749  11.9%     -   33s
     0     0 73063.5765    0  307 65322.1038 73063.5765  11.9%     -   33s
     0     0 73057.4103    0  347 65322.1038 73057.4103  11.8%     -   33s
     0     0 73052.5002    0  345 65322.1038 73052.5002  11.8%     -   34s
     0     0 73042.9479    0  349 65322.1038 73042.9479  11.8%     -   34s
     0     0 73039.5267    0  311 65322.1038 73039.5267  11.8%     -   34s
     0     0 73037.2402    0  312 65322.1038 73037.2402  11.8%     -   34s
     0     0 73037.1635    0  313 65322.1038 73037.1635  11.8%     -   34s
     0     0 72998.3208    0  306 65322.1038 72998.3208  11.8%     -   35s
     0     0 72984.2108    0  300 65322.1038 72984.2108  11.7%     -   35s
     0     0 72976.9877    0  309 65322.1038 72976.9877  11.7%     -   36s
     0     0 72975.8498    0  292 65322.1038 72975.8498  11.7%     -   36s
     0     0 72951.1210    0  316 65322.1038 72951.1210  11.7%     -   36s
     0     0 72946.8532    0  322 65322.1038 72946.8532  11.7%     -   36s
     0     0 72946.4835    0  325 65322.1038 72946.4835  11.7%     -   36s
     0     0 72945.7273    0  319 65322.1038 72945.7273  11.7%     -   36s
     0     0 72916.6694    0  311 65322.1038 72916.6694  11.6%     -   37s
     0     0 72909.8648    0  324 65322.1038 72909.8648  11.6%     -   38s
     0     0 72907.9646    0  326 65322.1038 72907.9646  11.6%     -   38s
     0     0 72903.7607    0  325 65322.1038 72903.7607  11.6%     -   38s
     0     0 72898.9530    0  324 65322.1038 72898.9530  11.6%     -   39s
     0     0 72897.5625    0  326 65322.1038 72897.5625  11.6%     -   39s
     0     0 72894.9045    0  331 65322.1038 72894.9045  11.6%     -   39s
     0     0 72891.4441    0  332 65322.1038 72891.4441  11.6%     -   40s
     0     0 72890.8109    0  326 65322.1038 72890.8109  11.6%     -   40s
     0     0 72888.6262    0  328 65322.1038 72888.6262  11.6%     -   40s
     0     0 72887.4545    0  328 65322.1038 72887.4545  11.6%     -   41s
     0     2 72887.4545    0  328 65322.1038 72887.4545  11.6%     -   45s
     7    16 72696.1015    3  322 65322.1038 72710.5152  11.3%  3227   51s
    31    64 71866.8634    5  356 65322.1038 72076.9319  10.3%  4496   55s
   198   247 70657.4664    8  328 65322.1038 71865.6135  10.0%  2143   61s
   298   306 69230.3942   10  339 65322.1038 71641.8677  9.67%  2201   66s
   420   388 68734.1865   11  337 65322.1038 71641.8677  9.67%  2414   71s
   501   481 69169.6366   12  303 65322.1038 71641.8677  9.67%  2390   75s
   691   626 69390.6998   15  348 65322.1038 71628.4303  9.65%  2213   81s
   797   690 68807.6155   16  307 65322.1038 71172.9652  8.96%  2212   86s
   954   802 68912.7166   18  385 65322.1038 71153.6629  8.93%  2272   92s
  1051   864 67513.2346   20  318 65322.1038 71153.6629  8.93%  2308   95s
  1158   962 67072.6937   21  327 65322.1038 70944.2656  8.61%  2352  100s
  1257  1037 67512.4453   22  377 65322.1038 70944.2656  8.61%  2353  105s
  1404  1165 67125.7322   24  362 65322.1038 70944.2656  8.61%  2303  110s
  1602  1311 66579.3201   25  349 65322.1038 70840.3019  8.45%  2241  116s
  1834  1421 66395.1440   27  348 65322.1038 70703.7743  8.24%  2204  122s
  1947  1507 66097.9757   30  308 65322.1038 70703.7743  8.24%  2189  125s
  2204  1629 infeasible   35      65322.1038 70672.1158  8.19%  2134  133s
  2337  1726 65434.4618   37  280 65322.1038 70605.9331  8.09%  2099  136s
  2685  1922 68378.0854   17  251 65322.1038 70603.9454  8.09%  2028  142s
  2864  2043 67261.4136   21  154 65322.1038 70550.6426  8.00%  2000  147s
  3057  2172 65745.7491   38  138 65322.1038 70521.9294  7.96%  1982  150s
  3399  2358 68274.2112   11  269 65322.1038 70454.2936  7.86%  1930  158s
  3632  2452     cutoff   18      65322.1038 70368.6769  7.73%  1898  161s
  3865  2563 69199.1927   12  339 65322.1038 70202.5250  7.47%  1870  166s
  4088  2648 68412.8986   15  278 65322.1038 70202.5250  7.47%  1858  170s
  4293  2726 67592.4858   19  303 65322.1038 70178.4621  7.43%  1858  175s
  4493  2817 66212.8925   22  216 65322.1038 70145.2008  7.38%  1872  180s
H 4617  2816                    65359.136622 70134.2018  7.31%  1866  180s
  4707  2817 66995.2615   46  328 65359.1366 70109.2858  7.27%  1861  192s
  4709  2818 68119.5941   17  159 65359.1366 70109.2858  7.27%  1860  199s
  4710  2819 67634.3453   19  294 65359.1366 70109.2858  7.27%  1860  204s
  4711  2820 66748.5384   26  302 65359.1366 70109.2858  7.27%  1859  206s
  4713  2821 67654.2351   13  294 65359.1366 70109.2858  7.27%  1859  210s
  4718  2824 67236.7162   14  328 65359.1366 70109.2858  7.27%  1857  215s
  4723  2828 67326.0796   29  394 65359.1366 70109.2858  7.27%  1855  220s
  4729  2832 68973.2640   14  286 65359.1366 70109.2858  7.27%  1852  225s
  4733  2834 66947.7544   19  323 65359.1366 70109.2858  7.27%  1851  230s
  4736  2836 65853.3236   24  329 65359.1366 70109.2858  7.27%  1850  238s
  4737  2837 68063.6737    9  329 65359.1366 70109.2858  7.27%  1849  244s
  4738  2841 70109.2858   16  317 65359.1366 70109.2858  7.27%  1864  246s
  4740  2844 70109.2858   17  341 65359.1366 70109.2858  7.27%  1865  251s
  4744  2851 70109.2858   18  390 65359.1366 70109.2858  7.27%  1866  257s
  4752  2864 70109.2858   19  313 65359.1366 70109.2858  7.27%  1871  261s
  4768  2891 70109.2858   20  382 65359.1366 70109.2858  7.27%  1878  266s
  4832  2963 69692.4091   22  379 65359.1366 70109.2858  7.27%  1895  273s
  4904  2973 69008.2804   23  356 65359.1366 70109.2858  7.27%  1891  276s
  5001  2977 68785.5183   24  358 65359.1366 70109.2858  7.27%  1909  281s
  5045  2977 69384.9842   25  321 65359.1366 70109.2858  7.27%  1915  285s
  5146  2966 68894.6480   27  321 65359.1366 70109.2858  7.27%  1927  292s
  5201  2957 67720.1054   28  288 65359.1366 70109.2858  7.27%  1926  296s
  5316  2951     cutoff   30      65359.1366 70083.2358  7.23%  1948  303s
  5378  2941 66532.7995   27  321 65359.1366 69897.7954  6.94%  1958  307s
  5447  2949 66184.0598   27  310 65359.1366 69897.7954  6.94%  1966  310s
  5578  2921 infeasible   28      65359.1366 69897.7954  6.94%  1969  317s
  5660  2899     cutoff   29      65359.1366 69897.7954  6.94%  1970  320s
  5827  2866 66386.7854   28  220 65359.1366 69897.7954  6.94%  1970  327s
  5927  2831 66165.2778   30  118 65359.1366 69897.7954  6.94%  1967  331s
  6113  2801     cutoff   35      65359.1366 69158.2989  5.81%  1970  339s
  6236  2772 66792.7599   25  255 65359.1366 69158.2989  5.81%  1968  343s
  6337  2730 65761.7639   29  195 65359.1366 69158.2989  5.81%  1972  347s
  6464  2707 66307.1925   33  251 65359.1366 68987.0376  5.55%  1970  353s
  6569  2692     cutoff   36      65359.1366 68987.0376  5.55%  1970  357s
  6725  2632 65659.5310   26  289 65359.1366 68683.8145  5.09%  1958  362s
  6883  2553 66431.2846   25  229 65359.1366 68571.8835  4.92%  1949  366s
  7063  2468 66771.4731   25  279 65359.1366 68286.3589  4.48%  1941  370s
  7365  2292     cutoff   32      65359.1366 67850.5648  3.81%  1928  377s
  7578  2095     cutoff   31      65359.1366 67618.3476  3.46%  1910  381s
  8249  1687     cutoff   32      65359.1366 67040.1952  2.57%  1812  387s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 219
  Mixing: 1
  Flow cover: 449
  RLT: 9
  Relax-and-lift: 47

Explored 8717 nodes (15094540 simplex iterations) in 387.69 seconds (1182.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: 65359.1 65322.1 65273.8 ... 51290.9

Optimal solution found (tolerance 1.00e-04)
Best objective 6.535913662232e+04, best bound 6.535913662232e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 387.69s
  Master Objective (UB) = 65359.14, θ = 214503.63
  Upper Bound (UB) = 65359.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214503.63
  [DEBUG]   ✓ Scenario 0: θ = 214503.63 ≤ Q = 214503.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214503.63 ≤ Q = 214503.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214503.63 ≤ Q = 214503.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 214503.63 ≤ Q = 214503.63 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3c3c041c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc3c3fbe4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.498464e+13
Presolve removed 2613 rows and 1905 columns
Presolve time: 0.00s
Presolved: 480 rows, 484 columns, 1353 nonzeros
Found heuristic solution: objective 7210789.0455
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.663528e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166352.82    0  127 7210789.05 -166352.82   102%     -    0s
H    0     0                    -131717.7614 -166352.82  26.3%     -    0s
H    0     0                    -133241.5925 -166352.82  24.9%     -    0s
H    0     0                    -139378.7193 -166352.82  19.4%     -    0s
H    0     0                    -140649.4624 -150317.93  6.87%     -    0s
     0     0 -150317.93    0   98 -140649.46 -150317.93  6.87%     -    0s
H    0     0                    -142680.0269 -150209.51  5.28%     -    0s
H    0     0                    -142986.4124 -150209.51  5.05%     -    0s
H    0     0                    -147583.6485 -150209.51  1.78%     -    0s
H    0     0                    -147876.0144 -150209.51  1.58%     -    0s
     0     0 -150188.76    0   89 -147876.01 -150188.76  1.56%     -    0s
     0     0 -150188.61    0   88 -147876.01 -150188.61  1.56%     -    0s
     0     0 -149368.98    0   96 -147876.01 -149368.98  1.01%     -    0s
     0     0 -149350.71    0   97 -147876.01 -149350.71  1.00%     -    0s
H    0     0                    -147878.0127 -148669.74  0.54%     -    0s
     0     0 -148669.74    0  100 -147878.01 -148669.74  0.54%     -    0s
     0     0 -148649.77    0   90 -147878.01 -148649.77  0.52%     -    0s
     0     0 -148645.75    0   87 -147878.01 -148645.75  0.52%     -    0s
     0     0 -148324.92    0   79 -147878.01 -148324.92  0.30%     -    0s
     0     0 -148317.15    0   77 -147878.01 -148317.15  0.30%     -    0s
     0     0 -148250.52    0   74 -147878.01 -148250.52  0.25%     -    0s
     0     0 -148248.36    0   73 -147878.01 -148248.36  0.25%     -    0s
     0     0 -148169.64    0   72 -147878.01 -148169.64  0.20%     -    0s
     0     0 -148164.42    0   72 -147878.01 -148164.42  0.19%     -    0s
     0     0 -148164.42    0   85 -147878.01 -148164.42  0.19%     -    0s
     0     0 -148164.42    0   65 -147878.01 -148164.42  0.19%     -    0s
H    0     0                    -147886.9507 -148164.42  0.19%     -    0s
     0     0 -148164.42    0   68 -147886.95 -148164.42  0.19%     -    0s
     0     0 -148114.10    0   69 -147886.95 -148114.10  0.15%     -    0s
     0     0 -148110.55    0   60 -147886.95 -148110.55  0.15%     -    0s
     0     0 -148110.29    0   69 -147886.95 -148110.29  0.15%     -    0s
     0     0 -148055.96    0   49 -147886.95 -148055.96  0.11%     -    0s
     0     0 -148045.18    0   46 -147886.95 -148045.18  0.11%     -    0s
     0     0 -147980.39    0   17 -147886.95 -147980.39  0.06%     -    0s
     0     0 -147916.52    0    5 -147886.95 -147916.52  0.02%     -    0s
H    0     0                    -147910.0106 -147914.68  0.00%     -    0s
     0     0 -147914.68    0    2 -147910.01 -147914.68  0.00%     -    0s

Cutting planes:
  Gomory: 34
  Implied bound: 6
  MIR: 69
  Flow cover: 21
  RLT: 13
  Relax-and-lift: 1

Explored 1 nodes (1213 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -147910 -147887 -147878 ... 1.49846e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.479100106200e+05, best bound -1.479146844206e+05, gap 0.0032%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 200973.29
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147910.01
  [DEBUG]   S×d_nominal = 348883.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348883.30 + -147910.01 = 200973.29
  [DEBUG]   Current θ from Master = 214503.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13530.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 51828.80
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 9827.8544, Absolute Gap = 9827.8544, Relative Gap = 0.150367
  Not converged yet (gap = 9827.85 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221644 nonzeros
Model fingerprint: 0xd21d2c55
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 36360 rows and 14760 columns
Presolve time: 0.64s
Presolved: 41473 rows, 18700 columns, 256719 nonzeros
Variable types: 16441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -156055.0847

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41473 rows, 18700 columns, 256719 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35153    6.9184636e+04   0.000000e+00   1.695722e+07      5s
Concurrent spin time: 0.54s

Solved with dual simplex

Root relaxation: objective 9.024055e+04, 26871 iterations, 8.17 seconds (16.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 90240.5477    0  161 -156055.08 90240.5477   158%     -    9s
H    0     0                    -144108.1642 90240.5477   163%     -    9s
H    0     0                    -117664.4580 90240.5477   177%     -    9s
H    0     0                    -60752.92169 90240.5477   249%     -    9s
H    0     0                    -44927.96305 90240.5477   301%     -    9s
H    0     0                    -44268.00578 90240.5477   304%     -    9s
H    0     0                    -43894.45908 90240.5477   306%     -    9s
H    0     0                    -25188.63366 90240.5477   458%     -    9s
H    0     0                    33271.037541 90240.5477   171%     -    9s
H    0     0                    33274.741651 90240.5477   171%     -    9s
H    0     0                    40719.393979 90240.5477   122%     -    9s
H    0     0                    44165.340441 90240.5477   104%     -    9s
H    0     0                    46384.252394 90240.5477  94.5%     -    9s
H    0     0                    48398.412837 90240.5477  86.5%     -    9s
H    0     0                    48399.495103 90240.5477  86.4%     -    9s
H    0     0                    48833.580662 90240.5477  84.8%     -    9s
H    0     0                    48917.509082 90240.5477  84.5%     -    9s
H    0     0                    52555.885308 83626.8062  59.1%     -   14s
H    0     0                    52628.061130 83626.8062  58.9%     -   14s
H    0     0                    53076.894142 83626.8062  57.6%     -   14s
H    0     0                    53385.209741 83626.8062  56.6%     -   14s
H    0     0                    53409.680907 83626.8062  56.6%     -   14s
H    0     0                    53724.467157 83626.8062  55.7%     -   14s
     0     0 83626.8062    0  212 53724.4672 83626.8062  55.7%     -   14s
     0     0 83401.6372    0  233 53724.4672 83401.6372  55.2%     -   15s
     0     0 83354.1494    0  230 53724.4672 83354.1494  55.2%     -   15s
     0     0 83345.6974    0  230 53724.4672 83345.6974  55.1%     -   16s
     0     0 83345.6974    0  234 53724.4672 83345.6974  55.1%     -   16s
     0     0 83345.6974    0  236 53724.4672 83345.6974  55.1%     -   16s
     0     0 80869.1281    0  226 53724.4672 80869.1281  50.5%     -   21s
H    0     0                    58928.313046 80868.4006  37.2%     -   21s
H    0     0                    59231.022186 80125.3467  35.3%     -   24s
     0     0 80125.3467    0  249 59231.0222 80125.3467  35.3%     -   24s
     0     0 80023.1170    0  248 59231.0222 80023.1170  35.1%     -   25s
     0     0 79843.3363    0  244 59231.0222 79843.3363  34.8%     -   26s
     0     0 79806.2717    0  244 59231.0222 79806.2717  34.7%     -   27s
     0     0 79786.0864    0  245 59231.0222 79786.0864  34.7%     -   27s
     0     0 79774.5182    0  246 59231.0222 79774.5182  34.7%     -   27s
     0     0 79773.3592    0  248 59231.0222 79773.3592  34.7%     -   27s
     0     0 79773.2352    0  243 59231.0222 79773.2352  34.7%     -   27s
     0     0 78674.6474    0  258 59231.0222 78674.6474  32.8%     -   32s
H    0     0                    59457.833396 78674.3708  32.3%     -   32s
H    0     0                    59913.907780 78459.0812  31.0%     -   34s
     0     0 78459.0812    0  267 59913.9078 78459.0812  31.0%     -   34s
     0     0 78291.1786    0  266 59913.9078 78291.1786  30.7%     -   35s
     0     0 78169.6978    0  274 59913.9078 78169.6978  30.5%     -   37s
     0     0 78151.0897    0  272 59913.9078 78151.0897  30.4%     -   37s
     0     0 78131.1860    0  271 59913.9078 78131.1860  30.4%     -   38s
     0     0 78122.3105    0  277 59913.9078 78122.3105  30.4%     -   39s
     0     0 78121.5926    0  277 59913.9078 78121.5926  30.4%     -   39s
     0     0 77274.6028    0  325 59913.9078 77274.6028  29.0%     -   45s
H    0     0                    60033.728076 76954.6321  28.2%     -   48s
H    0     0                    60442.948096 76954.6321  27.3%     -   48s
H    0     0                    60558.604905 76954.6321  27.1%     -   48s
H    0     0                    60633.108431 76954.6321  26.9%     -   48s
H    0     0                    60841.155458 76954.6321  26.5%     -   48s
     0     0 76954.6321    0  362 60841.1555 76954.6321  26.5%     -   48s
     0     0 76887.2688    0  331 60841.1555 76887.2688  26.4%     -   49s
H    0     0                    60883.078040 76828.8296  26.2%     -   50s
     0     0 76828.8296    0  338 60883.0780 76828.8296  26.2%     -   50s
     0     0 76816.5587    0  337 60883.0780 76816.5587  26.2%     -   51s
     0     0 76806.5566    0  345 60883.0780 76806.5566  26.2%     -   51s
     0     0 76801.4431    0  344 60883.0780 76801.4431  26.1%     -   51s
     0     0 76785.6999    0  343 60883.0780 76785.6999  26.1%     -   51s
     0     0 76782.0769    0  373 60883.0780 76782.0769  26.1%     -   52s
     0     0 76779.6518    0  342 60883.0780 76779.6518  26.1%     -   52s
     0     0 76779.3701    0  347 60883.0780 76779.3701  26.1%     -   52s
     0     0 76667.7017    0  373 60883.0780 76667.7017  25.9%     -   54s
H    0     0                    61213.672985 76667.4703  25.2%     -   54s
H    0     0                    61366.494156 76667.4703  24.9%     -   54s
H    0     0                    61544.727238 76667.4703  24.6%     -   54s
H    0     0                    61601.414346 76667.4703  24.5%     -   54s
H    0     0                    61694.573613 76667.4703  24.3%     -   54s
H    0     0                    61790.147734 76667.4703  24.1%     -   54s
H    0     0                    61849.979973 76667.4703  24.0%     -   54s
     0     0 76644.9512    0  338 61849.9800 76644.9512  23.9%     -   55s
     0     0 76625.0560    0  305 61849.9800 76625.0560  23.9%     -   56s
     0     0 76622.5147    0  349 61849.9800 76622.5147  23.9%     -   56s
     0     0 76620.4255    0  314 61849.9800 76620.4255  23.9%     -   57s
     0     0 76620.4153    0  313 61849.9800 76620.4153  23.9%     -   57s
     0     0 76458.3424    0  373 61849.9800 76458.3424  23.6%     -   59s
H    0     0                    63482.240137 76457.8292  20.4%     -   59s
     0     0 76440.9858    0  389 63482.2401 76440.9858  20.4%     -   60s
     0     0 76412.7212    0  385 63482.2401 76412.7212  20.4%     -   60s
     0     0 76399.5027    0  386 63482.2401 76399.5027  20.3%     -   61s
     0     0 76390.9321    0  387 63482.2401 76390.9321  20.3%     -   61s
     0     0 76386.8290    0  385 63482.2401 76386.8290  20.3%     -   61s
     0     0 76383.6067    0  391 63482.2401 76383.6067  20.3%     -   62s
     0     0 76383.1527    0  388 63482.2401 76383.1527  20.3%     -   62s
     0     0 76317.9079    0  383 63482.2401 76317.9079  20.2%     -   63s
H    0     0                    64050.199807 76317.7200  19.2%     -   63s
H    0     0                    64078.207834 76317.7200  19.1%     -   63s
     0     0 76305.2050    0  382 64078.2078 76305.2050  19.1%     -   64s
     0     0 76302.6482    0  382 64078.2078 76302.6482  19.1%     -   64s
     0     0 76301.7290    0  422 64078.2078 76301.7290  19.1%     -   64s
     0     0 76288.8995    0  377 64078.2078 76288.8995  19.1%     -   65s
     0     0 76279.7441    0  355 64078.2078 76279.7441  19.0%     -   66s
     0     0 76278.6851    0  358 64078.2078 76278.6851  19.0%     -   67s
     0     0 76260.6146    0  386 64078.2078 76260.6146  19.0%     -   68s
     0     0 76255.5723    0  433 64078.2078 76255.5723  19.0%     -   68s
     0     0 76254.3293    0  426 64078.2078 76254.3293  19.0%     -   69s
     0     0 76244.9088    0  400 64078.2078 76244.9088  19.0%     -   69s
     0     0 76243.0776    0  410 64078.2078 76243.0776  19.0%     -   70s
     0     0 76241.4079    0  413 64078.2078 76241.4079  19.0%     -   71s
     0     0 76238.8758    0  413 64078.2078 76238.8758  19.0%     -   72s
     0     0 76234.4434    0  414 64078.2078 76234.4434  19.0%     -   72s
     0     0 76232.6445    0  417 64078.2078 76232.6445  19.0%     -   73s
     0     0 76232.0031    0  415 64078.2078 76232.0031  19.0%     -   73s
     0     0 76229.9598    0  413 64078.2078 76229.9598  19.0%     -   73s
     0     0 76228.1855    0  413 64078.2078 76228.1855  19.0%     -   74s
H    0     0                    64154.112643 76228.1855  18.8%     -   78s
H    0     0                    64568.493286 76228.1855  18.1%     -   84s
     0     2 76228.1855    0  413 64568.4933 76228.1855  18.1%     -   89s
     1     4 76091.1096    1  432 64568.4933 76228.1855  18.1%  2359   91s
     7    16 75710.9964    3  424 64568.4933 76062.1585  17.8%  3062   96s
    15    32 75604.7073    4  475 64568.4933 75881.0397  17.5%  3989  101s
    31    49 72419.9577    5  291 64568.4933 75832.1817  17.4%  6428  110s
    48    81 73400.1139    6  297 64568.4933 75827.5749  17.4%  6093  120s
H   61    81                    64570.332462 75827.5749  17.4%  5752  120s
    80   233 73234.2741    7  298 64570.3325 75827.5749  17.4%  5044  127s
   232   272 72629.8102    9  293 64570.3325 75827.5749  17.4%  2958  130s
H  245   272                    64573.684740 75827.5749  17.4%  2894  130s
   271   354 72984.3704   11  294 64573.6847 75827.5749  17.4%  2824  135s
   385   428 72785.0393   12  328 64573.6847 75827.5749  17.4%  2559  142s
   427   459 72043.4352   11  264 64573.6847 75827.5749  17.4%  2495  146s
H  442   459                    64573.690318 75827.5749  17.4%  2483  146s
   548   570 72536.9195   13  323 64573.6903 75827.5749  17.4%  2324  153s
   580   602 71995.7582   12  162 64573.6903 75827.5749  17.4%  2290  156s
   662   691 72190.8387   13  273 64573.6903 75827.5749  17.4%  2159  162s
   729   711 71644.0602   13  159 64573.6903 75827.5749  17.4%  2080  168s
   793   740 72067.2431   13  267 64573.6903 75827.5749  17.4%  2051  171s
   857   767 71782.0189   14  256 64573.6903 75827.5749  17.4%  2003  177s
   920   794 71510.3343   14  154 64573.6903 75827.5749  17.4%  1984  182s
   980   838 71087.2198   14  257 64573.6903 75827.5749  17.4%  1988  187s
  1045   880 72091.0933   14  273 64573.6903 75329.0040  16.7%  2006  192s
H 1108   880                    64589.047883 75329.0040  16.6%  2012  192s
  1109   925 71562.0652   14  216 64589.0479 75329.0040  16.6%  2014  196s
  1194   980 71170.6193   14  197 64589.0479 75329.0040  16.6%  2009  202s
  1283  1026 71117.4079   14  152 64589.0479 75329.0040  16.6%  2009  207s
  1380  1079 70939.1169   15  149 64589.0479 75329.0040  16.6%  2003  213s
  1465  1141 70032.9607   15  233 64589.0479 75329.0040  16.6%  2026  218s
  1560  1219 70548.9897   15  255 64589.0479 75329.0040  16.6%  2022  226s
  1695  1309 68835.6226   16  139 64589.0479 74905.4147  16.0%  1964  233s
  1838  1377 69100.9412   17  141 64589.0479 74905.4147  16.0%  1918  240s
  1979  1379 infeasible   19      64589.0479 74816.7427  15.8%  1886  246s
H 2026  1379                    64591.725595 74816.7427  15.8%  1895  246s
  2063  1429 71947.5556    7  258 64591.7256 74716.4890  15.7%  1906  252s
  2152  1494 70597.5948    9  176 64591.7256 74539.3094  15.4%  1942  259s
  2261  1564 64894.7706   11  121 64591.7256 74539.3094  15.4%  1956  266s
  2407  1670 67999.7592   12  136 64591.7256 74341.0676  15.1%  1934  274s
  2593  1717 72865.6888   11  305 64591.7256 74341.0676  15.1%  1896  280s
  2767  1762 71655.2477   14  306 64591.7256 74099.3247  14.7%  1906  291s
  2813  1809 71430.4010   15  298 64591.7256 74099.3247  14.7%  1908  297s
  2882  1868 70814.2928   16  289 64591.7256 74055.2483  14.7%  1907  305s
  3005  1942 69147.8869   19  194 64591.7256 74006.3803  14.6%  1890  312s
  3173  2049 65886.0247   31  250 64591.7256 73944.7671  14.5%  1873  321s
  3350  2158 72582.0649    8  242 64591.7256 73938.1159  14.5%  1863  329s
  3549  2241 70815.8057   11  236 64591.7256 73812.4733  14.3%  1853  337s
  3750  2310 66216.3881   12  253 64591.7256 73689.2313  14.1%  1847  347s
  4009  2331 69862.7219   12  209 64591.7256 73656.1109  14.0%  1827  355s
  4050  2348 infeasible   13      64591.7256 73538.8556  13.9%  1835  361s
  4107  2379 infeasible   13      64591.7256 73518.2289  13.8%  1846  369s
  4223  2411 71874.9564    8  283 64591.7256 73518.2289  13.8%  1841  379s
  4438  2438 69774.6076    9  293 64591.7256 73510.3532  13.8%  1829  390s
  4674  2526 66094.9381   11  325 64591.7256 73510.3532  13.8%  1829  398s
  4939  2613     cutoff   13      64591.7256 73306.6306  13.5%  1820  410s
  5185  2693 70013.8272    8  206 64591.7256 73306.6306  13.5%  1824  419s
  5442  2748 64815.4676   17  113 64591.7256 73133.0751  13.2%  1830  431s
  5744  2819     cutoff   12      64591.7256 73024.5466  13.1%  1829  443s
  6016  2872 66329.4500   17  138 64591.7256 73024.5466  13.1%  1838  454s
  6430  2948 65430.7984   24  122 64591.7256 72915.7356  12.9%  1813  466s
  6727  3031 71086.8504   11  235 64591.7256 72915.7356  12.9%  1819  480s
  7055  3032 65677.0548   35  413 64591.7256 72629.7735  12.4%  1820  498s
  7057  3033 66068.1802   18  161 64591.7256 72629.7735  12.4%  1820  510s
  7058  3034 66309.1768   24  317 64591.7256 72629.7735  12.4%  1819  520s
  7059  3035 65564.6382   35  326 64591.7256 72629.7735  12.4%  1819  525s
  7060  3035 71735.8472   21  392 64591.7256 72629.7735  12.4%  1819  530s
  7062  3037 71827.1922   13  395 64591.7256 72629.7735  12.4%  1818  536s
  7065  3039 71302.0544   18  386 64591.7256 72629.7735  12.4%  1818  540s
  7068  3041 67761.9247   24  403 64591.7256 72629.7735  12.4%  1817  548s
  7070  3042 66453.1846   20  400 64591.7256 72629.7735  12.4%  1816  550s
  7073  3044 65962.5638   15  502 64591.7256 72629.7735  12.4%  1815  556s
  7077  3047 68658.7640   18  425 64591.7256 72629.7735  12.4%  1814  562s
  7080  3049 67851.1014   15  433 64591.7256 72629.7735  12.4%  1814  567s
  7082  3050 66206.0050   13  444 64591.7256 72629.7735  12.4%  1813  570s
  7084  3051 68885.2868   22  426 64591.7256 72629.7735  12.4%  1813  575s
  7085  3052 71742.3779    9  436 64591.7256 72629.7735  12.4%  1812  580s
  7087  3053 69999.6260   23  439 64591.7256 72629.7735  12.4%  1812  587s
  7089  3055 67825.7797   17  447 64591.7256 72629.7735  12.4%  1811  590s
  7090  3055 66328.2923   19  447 64591.7256 72629.7735  12.4%  1811  603s
  7091  3056 70833.6338   11  447 64591.7256 72629.7735  12.4%  1811  616s
  7092  3060 72629.7735   11  478 64591.7256 72629.7735  12.4%  1830  623s
  7094  3063 72629.7735   12  477 64591.7256 72629.7735  12.4%  1831  631s
  7098  3070 72629.7735   13  414 64591.7256 72629.7735  12.4%  1833  638s
  7106  3083 72629.7735   14  365 64591.7256 72629.7735  12.4%  1839  645s
  7122  3094 71416.9036   15  339 64591.7256 72629.7735  12.4%  1846  657s
  7138  3120 69404.4254   16  299 64591.7256 72629.7735  12.4%  1867  668s
  7170  3138 66257.6898   17  318 64591.7256 72629.7735  12.4%  1878  676s
  7217  3158 65969.8290   18  273 64591.7256 72629.7735  12.4%  1908  688s
  7339  3127     cutoff   19      64591.7256 72629.7735  12.4%  1912  697s
  7453  3114     cutoff   18      64591.7256 72629.7735  12.4%  1918  705s
  7538  3095 66294.9058   20  325 64591.7256 72629.7735  12.4%  1921  710s
  7643  3069 66217.7650   22  316 64591.7256 72629.7735  12.4%  1913  717s
  7707  3051 65078.5861   23  174 64591.7256 72629.7735  12.4%  1912  724s
  7786  3052 65073.5330   24  166 64591.7256 72629.7735  12.4%  1911  730s
  7868  3035 65228.7002   24  149 64591.7256 72230.4830  11.8%  1908  736s
  7963  3009 66891.6590   17  344 64591.7256 72230.4830  11.8%  1906  742s
  8046  3015     cutoff   18      64591.7256 71640.7386  10.9%  1908  746s
  8126  3004 65283.8030   18  329 64591.7256 71640.7386  10.9%  1909  752s
H 8173  2834                    64678.941004 71640.7386  10.8%  1910  752s
  8188  2833 64996.2832   19  245 64678.9410 71640.7386  10.8%  1909  758s
  8286  2804     cutoff   21      64678.9410 71000.4984  9.77%  1907  764s
  8347  2776 66657.9261   19  188 64678.9410 70299.4870  8.69%  1907  769s
  8419  2761 66130.1097   20  192 64678.9410 70034.4776  8.28%  1910  775s
  8470  2755 65099.1503   21  279 64678.9410 70034.4776  8.28%  1913  781s
  8566  2727 64754.5200   22  185 64678.9410 69661.7838  7.70%  1909  787s
  8677  2684     cutoff   23      64678.9410 69661.6118  7.70%  1904  794s
  8801  2632 65284.1644   22  191 64678.9410 69661.6118  7.70%  1900  801s
  8948  2562 65059.1058   30  157 64678.9410 67801.4205  4.83%  1893  808s
  9095  2471     cutoff   23      64678.9410 67800.4887  4.83%  1887  813s
  9288  2375     cutoff   24      64678.9410 67800.4887  4.83%  1873  817s
  9551  2324     cutoff   28      64678.9410 66810.4205  3.30%  1841  822s
  9948  2208 64968.3093   36   23 64678.9410 66810.4205  3.30%  1783  825s
H 9972  2054                    64876.132619 66810.4205  2.98%  1780  825s
 10919  1635 65015.4347   22  138 64876.1326 65311.9803  0.67%  1644  830s
*11090  1440              51    64936.502906 65311.9803  0.58%  1620  830s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 400
  Mixing: 1
  Flow cover: 958
  RLT: 14
  Relax-and-lift: 116

Explored 11848 nodes (18139015 simplex iterations) in 831.21 seconds (2443.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 64936.5 64876.1 64678.9 ... 64154.1

Optimal solution found (tolerance 1.00e-04)
Best objective 6.493650290625e+04, best bound 6.493650290625e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 831.22s
  Master Objective (UB) = 64936.50, θ = 216554.76
  Upper Bound (UB) = 64936.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216554.76
  [DEBUG]   ✓ Scenario 0: θ = 216554.76 ≤ Q = 216554.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216554.76 ≤ Q = 216554.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216554.76 ≤ Q = 216554.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216554.76 ≤ Q = 216554.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216554.76 ≤ Q = 216554.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x74b006aa
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8b4ff956
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.493064e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1356 nonzeros
Found heuristic solution: objective 7236370.1128
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.624728e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162472.77    0  129 7236370.11 -162472.77   102%     -    0s
H    0     0                    -127559.9964 -162472.77  27.4%     -    0s
H    0     0                    -128700.6962 -162472.77  26.2%     -    0s
H    0     0                    -134410.7830 -162472.77  20.9%     -    0s
H    0     0                    -137126.4261 -147262.28  7.39%     -    0s
     0     0 -147262.28    0   91 -137126.43 -147262.28  7.39%     -    0s
H    0     0                    -143389.6215 -147159.69  2.63%     -    0s
H    0     0                    -144078.3685 -147159.69  2.14%     -    0s
H    0     0                    -144214.6972 -147159.69  2.04%     -    0s
H    0     0                    -144903.4443 -147159.69  1.56%     -    0s
     0     0 -146597.85    0   93 -144903.44 -146597.85  1.17%     -    0s
     0     0 -145785.74    0   78 -144903.44 -145785.74  0.61%     -    0s
H    0     0                    -144985.7478 -145735.93  0.52%     -    0s
     0     0 -145624.60    0   53 -144985.75 -145624.60  0.44%     -    0s
     0     0 -145580.03    0   51 -144985.75 -145580.03  0.41%     -    0s
     0     0 -145574.89    0   70 -144985.75 -145574.89  0.41%     -    0s
     0     0 -145128.50    0   22 -144985.75 -145128.50  0.10%     -    0s
     0     0 -145108.24    0   21 -144985.75 -145108.24  0.08%     -    0s
     0     0 -145098.31    0   13 -144985.75 -145098.31  0.08%     -    0s
     0     0 -145068.00    0    7 -144985.75 -145068.00  0.06%     -    0s
     0     0 -145014.55    0    3 -144985.75 -145014.55  0.02%     -    0s
     0     0 -145007.91    0    6 -144985.75 -145007.91  0.02%     -    0s
     0     0 -145006.56    0    5 -144985.75 -145006.56  0.01%     -    0s
     0     0 -145005.64    0    4 -144985.75 -145005.64  0.01%     -    0s
H    0     0                    -144998.3016 -145005.64  0.01%     -    0s

Explored 1 nodes (707 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -144998 -144986 -144903 ... -127560

Optimal solution found (tolerance 1.00e-04)
Best objective -1.449983016078e+05, best bound -1.450056421002e+05, gap 0.0051%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 203143.28
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144998.30
  [DEBUG]   S×d_nominal = 348141.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348141.58 + -144998.30 = 203143.28
  [DEBUG]   Current θ from Master = 216554.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13411.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 51525.02
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 9405.2207, Absolute Gap = 9405.2207, Relative Gap = 0.144837
  Not converged yet (gap = 9405.22 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264869 nonzeros
Model fingerprint: 0xfe720115
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43632 rows and 17712 columns
Presolve time: 0.78s
Presolved: 49491 rows, 21988 columns, 306959 nonzeros
Variable types: 19729 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -156055.0847

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 49491 rows, 21988 columns, 306959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27857   -7.1172033e+03   0.000000e+00   2.781751e+07      5s
   44731    4.7683905e+04   0.000000e+00   1.920427e+08     10s
Concurrent spin time: 0.07s

Solved with dual simplex

Root relaxation: objective 9.019257e+04, 38414 iterations, 13.86 seconds (29.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 90192.5664    0  152 -156055.08 90192.5664   158%     -   15s
H    0     0                    -141128.5806 90192.5664   164%     -   15s
H    0     0                    -60114.98789 90192.5664   250%     -   15s
H    0     0                    -43836.69199 90192.5664   306%     -   15s
H    0     0                    -42447.00397 90192.5664   312%     -   15s
H    0     0                    -42426.81531 90192.5664   313%     -   15s
H    0     0                    -42160.47745 90192.5664   314%     -   15s
H    0     0                    -31695.43547 90192.5664   385%     -   15s
H    0     0                    -31112.29042 90192.5664   390%     -   15s
H    0     0                    15769.627635 90192.5664   472%     -   15s
H    0     0                    46966.675364 90192.5664  92.0%     -   15s
H    0     0                    50829.255491 90192.5664  77.4%     -   15s
H    0     0                    52384.727467 90192.5664  72.2%     -   15s
H    0     0                    53342.128684 90192.5664  69.1%     -   15s
     0     0 84516.0293    0  240 53342.1287 84516.0293  58.4%     -   21s
H    0     0                    53859.881048 84515.9844  56.9%     -   21s
H    0     0                    54018.581931 84515.9844  56.5%     -   21s
H    0     0                    54023.857580 84515.9844  56.4%     -   21s
H    0     0                    54035.216078 84515.9844  56.4%     -   21s
H    0     0                    54057.565440 84515.9844  56.3%     -   21s
     0     0 84294.3146    0  222 54057.5654 84294.3146  55.9%     -   23s
     0     0 84165.1519    0  218 54057.5654 84165.1519  55.7%     -   24s
     0     0 84021.5256    0  252 54057.5654 84021.5256  55.4%     -   25s
     0     0 83847.8297    0  256 54057.5654 83847.8297  55.1%     -   26s
     0     0 83846.5942    0  256 54057.5654 83846.5942  55.1%     -   26s
     0     0 83844.4757    0  256 54057.5654 83844.4757  55.1%     -   26s
     0     0 83844.0285    0  258 54057.5654 83844.0285  55.1%     -   26s
H    0     0                    54399.961076 81445.8494  49.7%     -   34s
H    0     0                    54811.755262 81445.8494  48.6%     -   34s
     0     0 81445.8494    0  289 54811.7553 81445.8494  48.6%     -   34s
H    0     0                    56071.305995 81445.3014  45.3%     -   34s
H    0     0                    58145.848748 81445.3014  40.1%     -   34s
H    0     0                    59708.970685 81445.3014  36.4%     -   34s
     0     0 81053.3234    0  266 59708.9707 81053.3234  35.7%     -   36s
     0     0 80839.8224    0  274 59708.9707 80839.8224  35.4%     -   38s
     0     0 80607.3476    0  280 59708.9707 80607.3476  35.0%     -   39s
     0     0 80299.7803    0  309 59708.9707 80299.7803  34.5%     -   41s
     0     0 80290.7636    0  284 59708.9707 80290.7636  34.5%     -   41s
     0     0 80289.1397    0  284 59708.9707 80289.1397  34.5%     -   41s
     0     0 80288.9431    0  283 59708.9707 80288.9431  34.5%     -   42s
H    0     0                    61230.771891 78952.5400  28.9%     -   51s
     0     0 78952.5400    0  313 61230.7719 78952.5400  28.9%     -   51s
H    0     0                    61340.428346 78951.2226  28.7%     -   52s
H    0     0                    61702.128652 78446.0741  27.1%     -   55s
H    0     0                    61711.275549 78446.0741  27.1%     -   55s
     0     0 78446.0741    0  290 61711.2755 78446.0741  27.1%     -   55s
     0     0 78329.7478    0  291 61711.2755 78329.7478  26.9%     -   56s
     0     0 78300.9307    0  285 61711.2755 78300.9307  26.9%     -   57s
     0     0 78225.9682    0  289 61711.2755 78225.9682  26.8%     -   58s
     0     0 78185.0690    0  297 61711.2755 78185.0690  26.7%     -   59s
     0     0 78146.9886    0  296 61711.2755 78146.9886  26.6%     -   60s
     0     0 78136.0752    0  304 61711.2755 78136.0752  26.6%     -   60s
     0     0 78132.3378    0  305 61711.2755 78132.3378  26.6%     -   61s
     0     0 78130.7996    0  303 61711.2755 78130.7996  26.6%     -   61s
     0     0 78130.6878    0  303 61711.2755 78130.6878  26.6%     -   61s
H    0     0                    62300.834673 78130.6878  25.4%     -   64s
H    0     0                    62353.087992 78130.6878  25.3%     -   64s
H    0     0                    62401.860431 78130.6878  25.2%     -   64s
     0     0 77360.3545    0  303 62401.8604 77360.3545  24.0%     -   67s
H    0     0                    62638.856341 77359.7281  23.5%     -   68s
H    0     0                    62864.604940 77359.7281  23.1%     -   68s
H    0     0                    63140.561772 77359.7281  22.5%     -   68s
     0     0 77212.3705    0  293 63140.5618 77212.3705  22.3%     -   70s
     0     0 77137.3382    0  329 63140.5618 77137.3382  22.2%     -   71s
     0     0 77122.0187    0  344 63140.5618 77122.0187  22.1%     -   72s
     0     0 77081.3428    0  299 63140.5618 77081.3428  22.1%     -   73s
     0     0 77031.1378    0  306 63140.5618 77031.1378  22.0%     -   75s
     0     0 76948.6664    0  302 63140.5618 76948.6664  21.9%     -   75s
     0     0 76902.0018    0  312 63140.5618 76902.0018  21.8%     -   77s
     0     0 76895.0096    0  309 63140.5618 76895.0096  21.8%     -   78s
     0     0 76886.4228    0  312 63140.5618 76886.4228  21.8%     -   78s
     0     0 76884.8921    0  309 63140.5618 76884.8921  21.8%     -   78s
     0     0 76884.0366    0  313 63140.5618 76884.0366  21.8%     -   78s
     0     0 76723.7012    0  336 63140.5618 76723.7012  21.5%     -   81s
     0     0 76700.0879    0  342 63140.5618 76700.0879  21.5%     -   81s
     0     0 76685.4680    0  349 63140.5618 76685.4680  21.5%     -   82s
     0     0 76682.9379    0  347 63140.5618 76682.9379  21.4%     -   82s
     0     0 76678.5232    0  346 63140.5618 76678.5232  21.4%     -   82s
     0     0 76675.1793    0  346 63140.5618 76675.1793  21.4%     -   83s
     0     0 76674.5105    0  349 63140.5618 76674.5105  21.4%     -   83s
     0     0 76612.9734    0  307 63140.5618 76612.9734  21.3%     -   84s
H    0     0                    63207.203171 76612.6233  21.2%     -   84s
     0     0 76602.4032    0  323 63207.2032 76602.4032  21.2%     -   85s
     0     0 76597.4957    0  316 63207.2032 76597.4957  21.2%     -   85s
     0     0 76595.3350    0  325 63207.2032 76595.3350  21.2%     -   85s
     0     0 76592.5639    0  324 63207.2032 76592.5639  21.2%     -   86s
     0     0 76591.5071    0  326 63207.2032 76591.5071  21.2%     -   86s
     0     0 76557.4345    0  333 63207.2032 76557.4345  21.1%     -   87s
     0     0 76537.3004    0  333 63207.2032 76537.3004  21.1%     -   88s
     0     0 76531.6328    0  327 63207.2032 76531.6328  21.1%     -   88s
     0     0 76531.2194    0  326 63207.2032 76531.2194  21.1%     -   88s
     0     0 76525.1929    0  329 63207.2032 76525.1929  21.1%     -   89s
     0     0 76522.7253    0  331 63207.2032 76522.7253  21.1%     -   89s
     0     0 76522.1505    0  330 63207.2032 76522.1505  21.1%     -   90s
     0     0 76520.8021    0  330 63207.2032 76520.8021  21.1%     -   90s
     0     0 76520.6295    0  330 63207.2032 76520.6295  21.1%     -   91s
     0     0 76519.8994    0  331 63207.2032 76519.8994  21.1%     -   91s
     0     0 76519.0442    0  331 63207.2032 76519.0442  21.1%     -   91s
     0     0 76517.0398    0  329 63207.2032 76517.0398  21.1%     -   92s
     0     0 76517.0197    0  329 63207.2032 76517.0197  21.1%     -   92s
H    0     0                    64192.402922 76517.0197  19.2%     -   98s
     0     2 76517.0197    0  329 64192.4029 76517.0197  19.2%     -  102s
     3     8 76285.7363    2  317 64192.4029 76424.7022  19.1%  4107  108s
     7    16 75791.1514    3  339 64192.4029 76283.5890  18.8%  5739  113s
    15    32 75629.0695    4  381 64192.4029 75786.7966  18.1%  6130  121s
    31    56 75157.7674    5  324 64192.4029 75629.0273  17.8%  9004  132s
    55    88 74754.1208    6  373 64192.4029 75629.0273  17.8%  8532  138s
    87   150 74041.1341    7  367 64192.4029 75629.0273  17.8%  6980  150s
   149   258 72957.6806    8  332 64192.4029 75629.0273  17.8%  5298  159s
H  150   258                    64284.435246 75629.0273  17.6%  5263  159s
   257   337 73891.6285    9  363 64284.4352 75629.0273  17.6%  3917  164s
   336   416 73820.8367   10  394 64284.4352 75629.0273  17.6%  3638  170s
   419   478 73102.2346   10  238 64284.4352 75629.0273  17.6%  3340  177s
   491   504 73295.2041   10  384 64284.4352 75629.0273  17.6%  3182  181s
   529   529 73286.6972   11  356 64284.4352 75629.0273  17.6%  3117  188s
   570   563 73629.3659   11  388 64284.4352 75629.0273  17.6%  3113  192s
   616   592 72413.9545   10  236 64284.4352 75629.0273  17.6%  3074  197s
   659   628 72189.6036   11  337 64284.4352 75629.0273  17.6%  3071  204s
   709   664 71428.6929   11  219 64284.4352 75629.0273  17.6%  3030  210s
   755   694 72512.5803   11  266 64284.4352 75629.0273  17.6%  2999  216s
   813   739 72170.3116   11  316 64284.4352 75336.0708  17.2%  2957  222s
   866   775 73569.1934   12  384 64284.4352 75334.8238  17.2%  2947  227s
   918   808 72342.4823   12  346 64284.4352 75334.8238  17.2%  2944  234s
   969   846 73336.0523   13  334 64284.4352 75334.8238  17.2%  2962  240s
  1017   874 72262.9294   14  278 64284.4352 75307.8631  17.1%  2973  245s
  1073   910 72250.4342   14  293 64284.4352 75307.8631  17.1%  2971  252s
  1135   928 71461.7192   13  222 64284.4352 75307.8631  17.1%  2985  257s
  1181   957 69459.8140   12  226 64284.4352 75307.8631  17.1%  3020  264s
  1238   994 70217.4477   15  307 64284.4352 75307.8631  17.1%  3009  270s
  1303  1056 72130.6378   15  214 64284.4352 74993.4009  16.7%  2979  276s
  1399  1105 68850.6385   16  186 64284.4352 74993.4009  16.7%  2894  282s
  1472  1150 65974.0800   15  204 64284.4352 74993.4009  16.7%  2873  288s
  1578  1169 infeasible   16      64284.4352 74993.4009  16.7%  2824  297s
  1630  1200 69694.4815   16  225 64284.4352 74993.4009  16.7%  2831  305s
  1702  1263 68444.8621   17  236 64284.4352 74993.4009  16.7%  2838  313s
  1785  1326 67625.8202   17  291 64284.4352 74993.4009  16.7%  2818  323s
  1881  1386 68220.2541   18  272 64284.4352 74609.2717  16.1%  2803  332s
  2000  1463 67204.5097   18  151 64284.4352 74609.2717  16.1%  2762  340s
  2125  1534 68177.8682   19  264 64284.4352 74405.0864  15.7%  2738  349s
  2275  1604 67268.0279   18  183 64284.4352 74213.7267  15.4%  2695  358s
  2408  1653 66868.0448   18  137 64284.4352 74213.7267  15.4%  2681  367s
  2539  1731 64915.9503   21  146 64284.4352 74155.0378  15.4%  2689  376s
  2661  1787 infeasible   20      64284.4352 74126.1628  15.3%  2705  386s
  2827  1841 69265.1415   14  276 64284.4352 74068.7760  15.2%  2681  399s
  2957  1923 68049.0034   15  186 64284.4352 74041.4853  15.2%  2662  408s
  3150  1987 65099.5183   18  214 64284.4352 73995.3932  15.1%  2623  418s
  3329  2065     cutoff   11      64284.4352 73984.6625  15.1%  2618  430s
  3543  2099 69607.8195   10  284 64284.4352 73981.0475  15.1%  2592  442s
  3716  2186 67452.5349   13  301 64284.4352 73981.0475  15.1%  2605  454s
  3877  2274 66190.7247   15  270 64284.4352 73981.0475  15.1%  2629  467s
  4087  2312     cutoff   16      64284.4352 73821.3190  14.8%  2618  479s
  4228  2361 73128.8302    9  248 64284.4352 73821.3190  14.8%  2630  494s
  4389  2470 68461.6709   12  191 64284.4352 73782.7191  14.8%  2655  507s
  4673  2573 66016.4023   26   92 64284.4352 73774.0415  14.8%  2621  521s
  4948  2628 72893.6797   17  210 64284.4352 73774.0415  14.8%  2603  538s
  5190  2690 64736.4651   21  142 64284.4352 73774.0415  14.8%  2600  556s
  5426  2707 65245.1790   22  120 64284.4352 73693.2185  14.6%  2608  568s
  5489  2810 66153.4298   22  116 64284.4352 73579.4879  14.5%  2614  585s
  5757  2811 72503.5932   11  329 64284.4352 73579.4879  14.5%  2594  608s
  5759  2812 64292.0200   21  152 64284.4352 73579.4879  14.5%  2593  625s
  5760  2813 67168.7856   17  305 64284.4352 73579.4879  14.5%  2593  639s
  5761  2814 69451.6636   12  299 64284.4352 73579.4879  14.5%  2592  646s
  5762  2814 70661.2704   13  334 64284.4352 73579.4879  14.5%  2592  650s
  5764  2816 65464.4253   20  381 64284.4352 73579.4879  14.5%  2591  659s
  5765  2816 68738.7366   12  314 64284.4352 73579.4879  14.5%  2590  661s
  5767  2818 70399.7015   10  355 64284.4352 73579.4879  14.5%  2589  665s
  5771  2820 68214.8140   12  363 64284.4352 73579.4879  14.5%  2588  672s
  5774  2822 67595.7285   33  342 64284.4352 73579.4879  14.5%  2586  677s
  5777  2824 67585.6334   11  451 64284.4352 73579.4879  14.5%  2585  683s
  5778  2825 65073.6247   20  410 64284.4352 73579.4879  14.5%  2585  685s
  5781  2827 65974.1141   28  464 64284.4352 73579.4879  14.5%  2583  692s
  5783  2828 69448.4964   12  374 64284.4352 73579.4879  14.5%  2582  696s
  5785  2830 70546.7120   15  456 64284.4352 73579.4879  14.5%  2581  700s
  5788  2832 68128.0900   12  426 64284.4352 73579.4879  14.5%  2580  706s
  5789  2832 68638.5317   13  426 64284.4352 73579.4879  14.5%  2580  723s
  5790  2833 67660.9881   23  426 64284.4352 73579.4879  14.5%  2579  738s
  5791  2837 73579.4879   16  368 64284.4352 73579.4879  14.5%  2605  746s
  5793  2840 73579.4879   17  366 64284.4352 73579.4879  14.5%  2607  756s
  5797  2847 73579.4879   18  364 64284.4352 73579.4879  14.5%  2609  765s
  5805  2860 73579.4879   19  380 64284.4352 73579.4879  14.5%  2617  777s
  5821  2873 71672.1144   20  298 64284.4352 73579.4879  14.5%  2635  793s
  5839  2899 72181.2356   21  365 64284.4352 73579.4879  14.5%  2656  803s
  5871  2967 71873.6079   22  366 64284.4352 73579.4879  14.5%  2686  816s
  5974  2955 67903.1367   25  269 64284.4352 73579.4879  14.5%  2745  826s
  6051  2931 67184.8919   25  313 64284.4352 73579.4879  14.5%  2759  835s
  6153  2900 67554.1598   26  257 64284.4352 73579.4879  14.5%  2752  846s
  6233  2875 65933.5426   26  251 64284.4352 73579.4879  14.5%  2745  854s
  6307  2865 66494.1091   27  238 64284.4352 73579.4879  14.5%  2748  863s
  6361  2886 66102.8692   28  217 64284.4352 73579.4879  14.5%  2754  871s
  6416  2906     cutoff   29      64284.4352 73579.4879  14.5%  2762  878s
  6473  2897 65062.9922   31  203 64284.4352 73579.4879  14.5%  2762  886s
  6546  2873 64418.4656   34  290 64284.4352 73579.4879  14.5%  2759  893s
  6605  2863     cutoff   32      64284.4352 73579.4879  14.5%  2753  900s
  6678  2855 67294.7236   22  326 64284.4352 73579.4879  14.5%  2749  908s
  6748  2837     cutoff   23      64284.4352 73579.4879  14.5%  2746  917s
  6829  2816 66873.2446   23  372 64284.4352 73579.4879  14.5%  2745  923s
  6873  2798     cutoff   23      64284.4352 71673.8560  11.5%  2744  931s
  6939  2784 65278.3981   25  319 64284.4352 71384.9489  11.0%  2747  940s
  6984  2768     cutoff   26      64284.4352 71384.9489  11.0%  2749  949s
  7050  2743 64435.6666   28  155 64284.4352 71384.9489  11.0%  2750  958s
  7129  2732 65707.7239   25  176 64284.4352 71384.9489  11.0%  2747  966s
  7219  2706 65060.5098   31  144 64284.4352 71384.9489  11.0%  2745  974s
  7314  2670     cutoff   34      64284.4352 70267.4478  9.31%  2746  985s
  7443  2644 64984.5348   26  272 64284.4352 70252.8994  9.28%  2736  993s
  7562  2619 68060.8605   22  296 64284.4352 70252.8994  9.28%  2728 1002s
  7692  2592 65309.7541   24  181 64284.4352 70086.7925  9.03%  2712 1012s
  7854  2564 infeasible   27      64284.4352 68982.1194  7.31%  2695 1023s
H 7958  2386                    64457.185113 68815.6610  6.76%  2676 1023s
  8048  2347 infeasible   25      64457.1851 68815.6610  6.76%  2664 1032s
  8231  2270     cutoff   25      64457.1851 68040.0689  5.56%  2647 1042s
H 8236  2134                    64581.027300 68040.0689  5.36%  2647 1042s
H 8246  2002                    64662.198821 68040.0689  5.22%  2647 1042s
H 8266  1874                    64782.901335 68040.0689  5.03%  2646 1042s
  8439  1713 65273.4261   31   93 64782.9013 68040.0689  5.03%  2624 1050s
  8709  1549 64993.2729   45   59 64782.9013 66905.7375  3.28%  2573 1057s
  9090  1372     cutoff   32      64782.9013 66767.4897  3.06%  2493 1062s
  9611  1293     cutoff   29      64782.9013 66319.8959  2.37%  2381 1067s
 10304  1173 65045.6640   42   24 64782.9013 65404.7945  0.96%  2233 1070s
*11171   768              69    64853.735044 65318.6496  0.72%  2071 1070s

Cutting planes:
  Gomory: 1
  MIR: 446
  Mixing: 1
  Flow cover: 882
  RLT: 12
  Relax-and-lift: 118

Explored 13296 nodes (23452381 simplex iterations) in 1074.56 seconds (3255.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 64853.7 64782.9 64662.2 ... 62864.6

Optimal solution found (tolerance 1.00e-04)
Best objective 6.485373504371e+04, best bound 6.485373504371e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1074.57s
  Master Objective (UB) = 64853.74, θ = 215281.74
  Upper Bound (UB) = 64853.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215281.74
  [DEBUG]   ✓ Scenario 0: θ = 215281.74 ≤ Q = 215281.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215281.74 ≤ Q = 215281.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 215281.74 ≤ Q = 215281.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 215281.74 ≤ Q = 215281.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 215281.74 ≤ Q = 215281.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 215281.74 ≤ Q = 215281.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x21be98d6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde41672a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.499905e+13
Presolve removed 2613 rows and 1905 columns
Presolve time: 0.00s
Presolved: 480 rows, 484 columns, 1353 nonzeros
Found heuristic solution: objective 7237096.8697
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.660165e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166016.47    0  125 7237096.87 -166016.47   102%     -    0s
H    0     0                    -132983.2827 -166016.47  24.8%     -    0s
H    0     0                    -134482.0331 -166016.47  23.4%     -    0s
H    0     0                    -138516.8605 -166016.47  19.9%     -    0s
H    0     0                    -139158.4632 -150909.62  8.44%     -    0s
     0     0 -150909.62    0   75 -139158.46 -150909.62  8.44%     -    0s
H    0     0                    -147669.0361 -150814.13  2.13%     -    0s
H    0     0                    -148630.6836 -150475.28  1.24%     -    0s
     0     0 -150475.28    0   77 -148630.68 -150475.28  1.24%     -    0s
H    0     0                    -149046.2985 -150475.28  0.96%     -    0s
     0     0 -149771.88    0   78 -149046.30 -149771.88  0.49%     -    0s
H    0     0                    -149128.0982 -149763.19  0.43%     -    0s
     0     0 -149583.70    0   52 -149128.10 -149583.70  0.31%     -    0s
     0     0 -149575.86    0   59 -149128.10 -149575.86  0.30%     -    0s
H    0     0                    -149129.4417 -149575.86  0.30%     -    0s
     0     0 -149480.81    0   41 -149129.44 -149480.81  0.24%     -    0s
     0     0 -149475.94    0   40 -149129.44 -149475.94  0.23%     -    0s
H    0     0                    -149135.4749 -149475.94  0.23%     -    0s
     0     0 -149471.66    0   40 -149135.47 -149471.66  0.23%     -    0s
     0     0 -149365.31    0   38 -149135.47 -149365.31  0.15%     -    0s
     0     0 -149357.80    0   24 -149135.47 -149357.80  0.15%     -    0s
     0     0 -149355.96    0   23 -149135.47 -149355.96  0.15%     -    0s
     0     0 -149330.99    0   22 -149135.47 -149330.99  0.13%     -    0s
     0     0 -149303.66    0   18 -149135.47 -149303.66  0.11%     -    0s
     0     0 -149303.06    0   17 -149135.47 -149303.06  0.11%     -    0s
     0     0 -149299.69    0   17 -149135.47 -149299.69  0.11%     -    0s
     0     0 -149212.79    0    9 -149135.47 -149212.79  0.05%     -    0s
     0     0 -149212.79    0   12 -149135.47 -149212.79  0.05%     -    0s
H    0     0                    -149161.3486 -149212.79  0.03%     -    0s
     0     0          -    0      -149161.35 -149174.90  0.01%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 6
  Flow cover: 4
  RLT: 2

Explored 1 nodes (761 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -149161 -149135 -149129 ... -132983

Optimal solution found (tolerance 1.00e-04)
Best objective -1.491613486457e+05, best bound -1.491749010689e+05, gap 0.0091%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 199721.95
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149161.35
  [DEBUG]   S×d_nominal = 348883.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348883.30 + -149161.35 = 199721.95
  [DEBUG]   Current θ from Master = 215281.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15559.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 49293.95
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 9322.4529, Absolute Gap = 9322.4529, Relative Gap = 0.143746
  Not converged yet (gap = 9322.45 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308094 nonzeros
Model fingerprint: 0xf4d51140
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 0.92s
Presolved: 57509 rows, 25276 columns, 357199 nonzeros
Variable types: 23017 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -156055.0847

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 57509 rows, 25276 columns, 357199 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32673    1.0043343e+04   0.000000e+00   1.203301e+08      5s
   51564    5.5556781e+04   0.000000e+00   5.034423e+07     10s
   65251    6.7372598e+04   0.000000e+00   9.189956e+05     15s
   76477    8.4932554e+04   0.000000e+00   2.983448e+07     20s
Concurrent spin time: 5.65s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.992433e+04, 61311 iterations, 24.85 seconds (42.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 89924.3338    0  166 -156055.08 89924.3338   158%     -   26s
H    0     0                    -141128.5806 89924.3338   164%     -   26s
H    0     0                    -135465.9520 89924.3338   166%     -   26s
H    0     0                    -132961.0026 89924.3338   168%     -   26s
H    0     0                    -130937.2416 89924.3338   169%     -   26s
H    0     0                    -128717.8891 89924.3338   170%     -   26s
H    0     0                    -128619.2167 89924.3338   170%     -   26s
H    0     0                    -31695.43547 89924.3338   384%     -   26s
H    0     0                    -31112.29042 89924.3338   389%     -   26s
H    0     0                    -17070.52846 89924.3338   627%     -   26s
H    0     0                    -15870.07583 89924.3338   667%     -   26s
H    0     0                    21566.877161 89924.3338   317%     -   26s
H    0     0                    21642.998108 89924.3338   315%     -   26s
H    0     0                    35126.983829 89924.3338   156%     -   27s
H    0     0                    52122.454049 89924.3338  72.5%     -   27s
H    0     0                    53451.526248 89924.3338  68.2%     -   27s
H    0     0                    53545.178788 89924.3338  67.9%     -   27s
H    0     0                    53758.441771 89924.3338  67.3%     -   27s
H    0     0                    53774.600934 89924.3338  67.2%     -   27s
     0     0 83626.1030    0  187 53774.6009 83626.1030  55.5%     -   36s
     0     0 82227.3839    0  192 53774.6009 82227.3839  52.9%     -   41s
     0     0 82227.3839    0  229 53774.6009 82227.3839  52.9%     -   43s
     0     0 82227.3839    0  236 53774.6009 82227.3839  52.9%     -   43s
     0     0 82227.3839    0  232 53774.6009 82227.3839  52.9%     -   44s
     0     0 82227.3839    0  232 53774.6009 82227.3839  52.9%     -   44s
     0     0 80221.4919    0  278 53774.6009 80221.4919  49.2%     -   51s
H    0     0                    59678.424992 80220.9387  34.4%     -   51s
H    0     0                    60001.499677 80220.9387  33.7%     -   51s
     0     0 79817.6562    0  288 60001.4997 79817.6562  33.0%     -   55s
     0     0 79471.3045    0  297 60001.4997 79471.3045  32.4%     -   60s
     0     0 79278.9790    0  311 60001.4997 79278.9790  32.1%     -   62s
     0     0 79218.1749    0  300 60001.4997 79218.1749  32.0%     -   64s
     0     0 79037.3463    0  304 60001.4997 79037.3463  31.7%     -   66s
     0     0 78806.2812    0  299 60001.4997 78806.2812  31.3%     -   69s
     0     0 78775.8774    0  307 60001.4997 78775.8774  31.3%     -   70s
     0     0 78766.2610    0  315 60001.4997 78766.2610  31.3%     -   71s
     0     0 78764.8249    0  312 60001.4997 78764.8249  31.3%     -   72s
     0     0 78764.0672    0  312 60001.4997 78764.0672  31.3%     -   72s
H    0     0                    60040.048707 77781.5854  29.5%     -   81s
     0     0 77781.5854    0  265 60040.0487 77781.5854  29.5%     -   81s
     0     0 77559.9498    0  268 60040.0487 77559.9498  29.2%     -   84s
     0     0 77443.0839    0  274 60040.0487 77443.0839  29.0%     -   87s
     0     0 77363.2361    0  269 60040.0487 77363.2361  28.9%     -   88s
     0     0 77346.9513    0  271 60040.0487 77346.9513  28.8%     -   89s
     0     0 77311.4623    0  272 60040.0487 77311.4623  28.8%     -   90s
     0     0 77293.3405    0  276 60040.0487 77293.3405  28.7%     -   91s
     0     0 77268.0676    0  269 60040.0487 77268.0676  28.7%     -   92s
     0     0 77259.8161    0  277 60040.0487 77259.8161  28.7%     -   93s
     0     0 77256.6532    0  276 60040.0487 77256.6532  28.7%     -   93s
     0     0 77256.0087    0  277 60040.0487 77256.0087  28.7%     -   93s
     0     0 76798.0223    0  291 60040.0487 76798.0223  27.9%     -   99s
     0     0 76665.4081    0  296 60040.0487 76665.4081  27.7%     -  102s
     0     0 76618.5786    0  296 60040.0487 76618.5786  27.6%     -  103s
     0     0 76604.4022    0  287 60040.0487 76604.4022  27.6%     -  104s
     0     0 76587.3191    0  284 60040.0487 76587.3191  27.6%     -  105s
     0     0 76584.0328    0  292 60040.0487 76584.0328  27.6%     -  106s
     0     0 76578.5634    0  296 60040.0487 76578.5634  27.5%     -  106s
     0     0 76577.7792    0  298 60040.0487 76577.7792  27.5%     -  106s
     0     0 76358.2220    0  335 60040.0487 76358.2220  27.2%     -  109s
     0     0 76302.0108    0  305 60040.0487 76302.0108  27.1%     -  111s
     0     0 76290.6365    0  307 60040.0487 76290.6365  27.1%     -  111s
     0     0 76278.3140    0  301 60040.0487 76278.3140  27.0%     -  112s
     0     0 76275.4544    0  309 60040.0487 76275.4544  27.0%     -  112s
     0     0 76274.2464    0  313 60040.0487 76274.2464  27.0%     -  113s
     0     0 76225.7836    0  330 60040.0487 76225.7836  27.0%     -  114s
H    0     0                    60085.483771 76225.2527  26.9%     -  115s
     0     0 76213.2958    0  359 60085.4838 76213.2958  26.8%     -  116s
     0     0 76209.5796    0  372 60085.4838 76209.5796  26.8%     -  117s
     0     0 76206.7102    0  352 60085.4838 76206.7102  26.8%     -  117s
     0     0 76206.2463    0  356 60085.4838 76206.2463  26.8%     -  117s
     0     0 76167.1888    0  321 60085.4838 76167.1888  26.8%     -  120s
     0     0 76156.2596    0  318 60085.4838 76156.2596  26.7%     -  121s
     0     0 76152.9839    0  360 60085.4838 76152.9839  26.7%     -  122s
     0     0 76151.5495    0  366 60085.4838 76151.5495  26.7%     -  122s
     0     0 76143.8533    0  369 60085.4838 76143.8533  26.7%     -  124s
     0     0 76139.6396    0  372 60085.4838 76139.6396  26.7%     -  125s
     0     0 76137.4702    0  376 60085.4838 76137.4702  26.7%     -  125s
     0     0 76136.5917    0  341 60085.4838 76136.5917  26.7%     -  126s
     0     0 76127.2137    0  336 60085.4838 76127.2137  26.7%     -  127s
     0     0 76123.1380    0  379 60085.4838 76123.1380  26.7%     -  128s
     0     0 76120.2822    0  408 60085.4838 76120.2822  26.7%     -  128s
     0     0 76119.9089    0  342 60085.4838 76119.9089  26.7%     -  129s
     0     0 76115.9780    0  449 60085.4838 76115.9780  26.7%     -  130s
H    0     0                    60666.589234 76115.8576  25.5%     -  132s
     0     0 76114.5348    0  382 60666.5892 76114.5348  25.5%     -  132s
     0     0 76111.8153    0  337 60666.5892 76111.8153  25.5%     -  134s
H    0     0                    61813.271308 76111.0775  23.1%     -  134s
H    0     0                    62148.518117 76111.0775  22.5%     -  134s
     0     0 76108.4126    0  456 62148.5181 76108.4126  22.5%     -  135s
     0     0 76107.4097    0  344 62148.5181 76107.4097  22.5%     -  135s
     0     0 76106.7581    0  344 62148.5181 76106.7581  22.5%     -  136s
     0     0 76106.5121    0  344 62148.5181 76106.5121  22.5%     -  136s
H    0     0                    62747.850111 76106.5121  21.3%     -  153s
H    0     2                    63704.405315 76106.5121  19.5%     -  169s
     0     2 76106.5121    0  344 63704.4053 76106.5121  19.5%     -  169s
     1     4 75739.1245    1  317 63704.4053 76106.5121  19.5%  6635  174s
     3     8 75628.4926    2  397 63704.4053 75739.4911  18.9%  6223  178s
     7    16 75476.2983    3  411 63704.4053 75628.0442  18.7%  6116  182s
    15    32 75280.6727    4  324 63704.4053 75476.2955  18.5%  6065  188s
    31    51 74126.8738    5  252 63704.4053 75353.8275  18.3%  8612  203s
    50    83 73212.8319    6  272 63704.4053 75353.8275  18.3%  8233  211s
H   82   168                    63913.453744 75353.8275  17.9%  6639  220s
   167   272 72971.5532    8  259 63913.4537 75353.8275  17.9%  4426  227s
   271   307 72558.6612   11  249 63913.4537 75353.8275  17.9%  3682  235s
H  279   307                    63996.007329 75353.8275  17.7%  3655  235s
   306   376 72799.3979   10  252 63996.0073 75353.8275  17.7%  3568  240s
   407   464 72579.2275   11  250 63996.0073 75353.8275  17.7%  3310  250s
   497   521 71482.7415   12  221 63996.0073 75353.8275  17.7%  3207  259s
   539   559 72283.8867   13  243 63996.0073 75353.8275  17.7%  3264  266s
   581   590 72220.2122   13  250 63996.0073 75353.8275  17.7%  3328  273s
   622   626 72077.1638   14  246 63996.0073 75353.8275  17.7%  3473  281s
   674   656 70806.8184   14  211 63996.0073 75353.8275  17.7%  3475  289s
   720   695 70123.4545   15  233 63996.0073 75353.8275  17.7%  3494  294s
   767   734 70535.3461   14  167 63996.0073 75353.8275  17.7%  3487  302s
   814   779 71875.0237   15  245 63996.0073 75353.8275  17.7%  3471  309s
   868   828 71245.5432   18  202 63996.0073 75353.8275  17.7%  3467  317s
   919   846 67804.6701   18  185 63996.0073 75353.8275  17.7%  3467  324s
   977   858 70964.8781   19  211 63996.0073 75353.8275  17.7%  3441  334s
  1033   892 70926.6993   19  206 63996.0073 75353.8275  17.7%  3475  342s
  1105   931 68377.8009   20  203 63996.0073 75280.0785  17.6%  3497  350s
  1182   978 66046.3827   21  141 63996.0073 75280.0785  17.6%  3514  358s
  1274   999 68350.9489   20  206 63996.0073 75280.0785  17.6%  3455  365s
  1365  1021 68189.6556   21  182 63996.0073 75262.8533  17.6%  3460  374s
  1433  1047 68100.5679   22  187 63996.0073 75262.8533  17.6%  3497  383s
  1517  1070 67730.0425   25  173 63996.0073 75262.8533  17.6%  3532  393s
  1599  1114 67516.8155   27  177 63996.0073 75262.8533  17.6%  3578  402s
  1673  1163 67259.8948   28  181 63996.0073 75203.7990  17.5%  3661  411s
  1748  1221 64923.0993   29  164 63996.0073 75203.7990  17.5%  3753  421s
  1858  1278 65489.3821   30  154 63996.0073 75203.7990  17.5%  3758  430s
  1997  1303 64933.2386   35  166 63996.0073 75203.7990  17.5%  3715  441s
  2100  1371 72850.9442    9  276 63996.0073 74702.6038  16.7%  3687  450s
  2220  1428 71241.7585    9  253 63996.0073 74702.6038  16.7%  3706  461s
  2365  1453 69051.4180   11  245 63996.0073 74702.6038  16.7%  3694  468s
  2402  1486 67606.1231   12  273 63996.0073 74702.6038  16.7%  3758  479s
H 2457  1486                    64232.072959 74702.6038  16.3%  3768  479s
  2470  1546 68944.5558   11  177 64232.0730 74702.6038  16.3%  3778  491s
  2592  1619 67677.9404   13  209 64232.0730 74702.6038  16.3%  3812  502s
  2703  1704 66902.3908   16  229 64232.0730 74062.3854  15.3%  3872  513s
  2830  1731 66774.9974   16  200 64232.0730 74062.3854  15.3%  3902  523s
  2879  1777 66278.5437   17  235 64232.0730 74062.3854  15.3%  3908  534s
  2999  1841 infeasible   17      64232.0730 73809.7395  14.9%  3915  548s
  3141  1906 69225.5865   11  268 64232.0730 73809.7395  14.9%  3958  563s
  3274  1988 67018.6982   13  242 64232.0730 73705.2752  14.7%  4016  577s
  3431  2071 infeasible   13      64232.0730 73610.4625  14.6%  4044  590s
  3624  2144     cutoff   13      64232.0730 73610.4625  14.6%  4053  604s
  3798  2222 65714.7589   16  202 64232.0730 73610.4625  14.6%  4096  619s
  3982  2280 71504.0118   14  255 64232.0730 73511.9172  14.4%  4135  635s
  4174  2372 67945.1699   18  209 64232.0730 73462.8019  14.4%  4165  650s
  4384  2462 65886.1265   27  166 64232.0730 73423.8705  14.3%  4179  667s
  4563  2532 72171.6706    6  205 64232.0730 73423.8705  14.3%  4229  683s
  4787  2634 infeasible    8      64232.0730 73333.8387  14.2%  4239  701s
  4983  2635 71916.1188   16  344 64232.0730 73253.5358  14.0%  4239  762s
  4985  2636 65180.5074   41  166 64232.0730 73253.5358  14.0%  4238  790s
  4986  2637 68414.6699   13  306 64232.0730 73253.5358  14.0%  4237  805s
  4987  2638 65749.8857   25  307 64232.0730 73253.5358  14.0%  4236  814s
  4988  2638 69439.5668   17  367 64232.0730 73253.5358  14.0%  4235  825s
  4989  2639 67504.2532   22  313 64232.0730 73253.5358  14.0%  4234  831s
  4990  2640 72558.6125   14  383 64232.0730 73253.5358  14.0%  4233  836s
  4992  2641 69241.6209   18  399 64232.0730 73253.5358  14.0%  4232  842s
  4993  2642 70622.8348   20  327 64232.0730 73253.5358  14.0%  4231  845s
  4994  2642 69601.3322   12  394 64232.0730 73253.5358  14.0%  4230  850s
  4997  2644 65933.7910   16  443 64232.0730 73253.5358  14.0%  4227  856s
  4999  2646 65356.6693   27  393 64232.0730 73253.5358  14.0%  4226  861s
  5000  2646 66276.8020   15  397 64232.0730 73253.5358  14.0%  4225  867s
  5001  2647 68696.9131   14  408 64232.0730 73253.5358  14.0%  4224  870s
  5004  2649 64636.5336   36  346 64232.0730 73253.5358  14.0%  4222  876s
  5005  2650 66984.7638   18  373 64232.0730 73253.5358  14.0%  4221  880s
  5008  2652 67015.8771   16  426 64232.0730 73253.5358  14.0%  4218  885s
  5011  2654 66736.2785   16  428 64232.0730 73253.5358  14.0%  4216  891s
  5013  2655 65829.3785   54  454 64232.0730 73253.5358  14.0%  4214  895s
  5016  2657 70051.1906   11  454 64232.0730 73253.5358  14.0%  4211  922s
  5017  2658 66224.6917   20  454 64232.0730 73253.5358  14.0%  4211  929s
  5018  2661 73253.5358   15  339 64232.0730 73253.5358  14.0%  4249  941s
  5020  2665 73253.5358   16  342 64232.0730 73253.5358  14.0%  4250  948s
  5024  2671 73253.5358   17  335 64232.0730 73253.5358  14.0%  4251  961s
  5032  2685 73253.5358   18  357 64232.0730 73253.5358  14.0%  4251  977s
  5048  2699 72933.2419   19  267 64232.0730 73253.5358  14.0%  4284 1001s
  5068  2724 72429.2367   20  280 64232.0730 73253.5358  14.0%  4296 1012s
  5100  2779 71691.2967   21  242 64232.0730 73253.5358  14.0%  4317 1026s
  5174  2798 68450.6772   23  261 64232.0730 73253.5358  14.0%  4332 1038s
  5233  2807     cutoff   22      64232.0730 73253.5358  14.0%  4352 1048s
  5329  2784 66682.6847   23  171 64232.0730 73253.5358  14.0%  4349 1060s
  5377  2771 66629.5727   24  169 64232.0730 73253.5358  14.0%  4349 1073s
  5445  2749 65894.5049   28  162 64232.0730 73253.5358  14.0%  4353 1082s
  5496  2756 infeasible   28      64232.0730 73253.5358  14.0%  4361 1091s
  5549  2749 65318.3097   30  155 64232.0730 73253.5358  14.0%  4365 1102s
  5592  2744 65121.8316   31  147 64232.0730 73253.5358  14.0%  4368 1111s
  5647  2731 64534.8150   32  138 64232.0730 73253.5358  14.0%  4379 1121s
  5695  2722     cutoff   31      64232.0730 73253.5358  14.0%  4382 1130s
  5750  2718 68570.1559   22  268 64232.0730 73253.5358  14.0%  4400 1140s
  5811  2709 68138.1017   23  248 64232.0730 73253.5358  14.0%  4413 1149s
  5876  2715 67869.0622   24  245 64232.0730 73253.5358  14.0%  4424 1158s
  5943  2713     cutoff   26      64232.0730 73253.5358  14.0%  4422 1168s
  6029  2699 64461.0613   26  235 64232.0730 73253.5358  14.0%  4414 1177s
  6102  2694 64405.5369   27  231 64232.0730 73253.5358  14.0%  4402 1188s
  6182  2679 66887.7983   22  172 64232.0730 73253.5358  14.0%  4397 1196s
  6230  2691     cutoff   23      64232.0730 73253.5358  14.0%  4406 1206s
  6280  2685 66509.1982   23  177 64232.0730 73253.5358  14.0%  4408 1216s
  6347  2677 66303.8216   24  180 64232.0730 73112.1522  13.8%  4401 1226s
  6410  2659 66303.2021   25  180 64232.0730 73112.1522  13.8%  4404 1237s
  6483  2635 65590.4315   26  187 64232.0730 72811.1395  13.4%  4404 1247s
  6563  2611 65564.4983   27  151 64232.0730 72811.1395  13.4%  4397 1259s
  6639  2602 64869.7437   28  137 64232.0730 72811.1395  13.4%  4395 1270s
  6716  2603     cutoff   29      64232.0730 71743.3841  11.7%  4391 1282s
  6788  2581     cutoff   29      64232.0730 71743.3841  11.7%  4396 1292s
  6886  2535     cutoff   28      64232.0730 71743.3841  11.7%  4381 1304s
  6996  2517     cutoff   27      64232.0730 70861.9547  10.3%  4366 1317s
  7085  2504     cutoff   26      64232.0730 70861.9547  10.3%  4362 1329s
  7205  2456     cutoff   23      64232.0730 70861.9547  10.3%  4354 1343s
  7332  2446 64711.7597   25  170 64232.0730 70058.5973  9.07%  4346 1355s
  7467  2430 64828.0361   26  186 64232.0730 69790.8879  8.65%  4337 1374s
  7670  2380 66819.1041   26  257 64232.0730 69558.8184  8.29%  4311 1387s
  7847  2335 65358.5286   29  232 64232.0730 69009.7415  7.44%  4305 1403s
  7994  2285     cutoff   32      64232.0730 69009.7415  7.44%  4291 1419s
  8209  2220 64898.5991   34  292 64232.0730 69002.9299  7.43%  4279 1433s
  8372  2187     cutoff   35      64232.0730 67732.9569  5.45%  4264 1450s
  8598  2095     cutoff   37      64232.0730 67570.8855  5.20%  4234 1468s
* 8702  1926              49    64280.733918 67515.2449  5.03%  4232 1468s
  8840  1845 64577.7769   30  230 64280.7339 67050.2485  4.31%  4223 1485s
  9149  1684 65520.8771   27  141 64280.7339 66896.2056  4.07%  4190 1502s
  9484  1529     cutoff   30      64280.7339 66414.4037  3.32%  4150 1518s
  9789  1348 64464.3565   27  276 64280.7339 66352.2604  3.22%  4104 1531s
H 9801  1217                    64357.999202 66352.2604  3.10%  4100 1531s
 10012  1126     cutoff   28      64357.9992 66352.2604  3.10%  4061 1546s
 10851  1163 64806.7900   40  180 64357.9992 65927.0482  2.44%  3811 1557s
 12018  1173 64391.3081   49   12 64357.9992 64887.7450  0.82%  3466 1563s
*12377  1110              65    64369.390115 64887.7450  0.81%  3370 1563s
 13426  1251 infeasible   49      64369.3901 64831.5136  0.72%  3120 1572s
 14349  1533     cutoff   49      64369.3901 64788.3616  0.65%  2930 1579s
*14403  1533              73    64433.088849 64788.3616  0.55%  2919 1579s
 15684  1523     cutoff   54      64433.0888 64788.3616  0.55%  2693 1586s
 15749  1542 64501.2968   54   18 64433.0888 64769.7650  0.52%  2682 1594s
 15785  1583 64494.2942   55   19 64433.0888 64769.5391  0.52%  2676 1601s
 16202  1516 64492.6350   56   18 64433.0888 64769.5391  0.52%  2611 1608s
 17231  1275 64485.6088   57   19 64433.0888 64769.5391  0.52%  2463 1615s
*18078  1275              62    64443.985441 64745.9395  0.47%  2353 1616s
 19114   292     cutoff   57      64443.9854 64745.9395  0.47%  2232 1620s

Cutting planes:
  Learned: 1
  MIR: 560
  Flow cover: 1045
  RLT: 13
  Relax-and-lift: 111

Explored 22252 nodes (43115840 simplex iterations) in 1621.38 seconds (5003.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 64444 64433.1 64369.4 ... 62747.9

Optimal solution found (tolerance 1.00e-04)
Best objective 6.444398544063e+04, best bound 6.444398544063e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1621.39s
  Master Objective (UB) = 64443.99, θ = 214512.92
  Upper Bound (UB) = 64443.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 214512.92
  [DEBUG]   ✓ Scenario 0: θ = 214512.92 ≤ Q = 214512.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 214512.92 ≤ Q = 214512.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 214512.92 ≤ Q = 214512.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 214512.92 ≤ Q = 214512.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 214512.92 ≤ Q = 214512.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 214512.92 ≤ Q = 214512.92 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 214512.92 ≤ Q = 214512.92 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x570d824
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0570d824
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.499905e+13
Presolve removed 2613 rows and 1905 columns
Presolve time: 0.00s
Presolved: 480 rows, 484 columns, 1353 nonzeros
Found heuristic solution: objective 7229746.9778
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.632889e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163288.87    0  123 7229746.98 -163288.87   102%     -    0s
H    0     0                    -131046.6589 -163288.87  24.6%     -    0s
H    0     0                    -132071.5666 -163288.87  23.6%     -    0s
H    0     0                    -135229.2948 -147137.80  8.81%     -    0s
H    0     0                    -135765.6715 -147137.80  8.38%     -    0s
     0     0 -147137.80    0  126 -135765.67 -147137.80  8.38%     -    0s
H    0     0                    -142081.5947 -147009.11  3.47%     -    0s
     0     0 -145421.90    0  131 -142081.59 -145421.90  2.35%     -    0s
H    0     0                    -143748.7624 -145408.08  1.15%     -    0s
     0     0 -145356.88    0  130 -143748.76 -145356.88  1.12%     -    0s
     0     0 -144627.98    0   85 -143748.76 -144627.98  0.61%     -    0s
     0     0 -144425.17    0  102 -143748.76 -144425.17  0.47%     -    0s
     0     0 -144415.81    0   87 -143748.76 -144415.81  0.46%     -    0s
     0     0 -144272.28    0   63 -143748.76 -144272.28  0.36%     -    0s
     0     0 -144247.90    0   64 -143748.76 -144247.90  0.35%     -    0s
     0     0 -144211.16    0   56 -143748.76 -144211.16  0.32%     -    0s
     0     0 -144209.16    0   56 -143748.76 -144209.16  0.32%     -    0s
     0     0 -144169.34    0   56 -143748.76 -144169.34  0.29%     -    0s
     0     0 -144162.33    0   56 -143748.76 -144162.33  0.29%     -    0s
     0     2 -144162.33    0   56 -143748.76 -144162.33  0.29%     -    0s
H   31    14                    -143768.4914 -143974.08  0.14%  11.6    0s
H   32    14                    -143770.7729 -143974.08  0.14%  11.5    0s
H   36    14                    -143771.5009 -143974.08  0.14%  11.2    0s
H   38    14                    -143803.2882 -143974.08  0.12%  10.7    0s
H   68     9                    -143805.8308 -143875.90  0.05%   8.6    0s

Cutting planes:
  Gomory: 21
  Implied bound: 2
  MIR: 207
  Flow cover: 26
  RLT: 39
  Relax-and-lift: 5
  BQP: 7

Explored 127 nodes (1536 simplex iterations) in 0.09 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -143806 -143803 -143772 ... -131047

Optimal solution found (tolerance 1.00e-04)
Best objective -1.438058308137e+05, best bound -1.438158007719e+05, gap 0.0069%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 204330.41
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143805.83
  [DEBUG]   S×d_nominal = 348136.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348136.24 + -143805.83 = 204330.41
  [DEBUG]   Current θ from Master = 214512.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10182.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 54261.47
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 8912.7033, Absolute Gap = 8912.7033, Relative Gap = 0.138302
  Not converged yet (gap = 8912.70 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351319 nonzeros
Model fingerprint: 0x68ab457e
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 58176 rows and 23616 columns
Presolve time: 1.06s
Presolved: 65527 rows, 28564 columns, 407439 nonzeros
Variable types: 26305 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 65527 rows, 28564 columns, 407439 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33013    2.4822336e+03   0.000000e+00   2.680759e+08      5s
   47022    5.4194895e+04   0.000000e+00   2.492257e+06     10s
   57090    5.8274913e+04   0.000000e+00   3.116935e+08     15s
   67016    7.3157293e+04   0.000000e+00   1.007523e+07     20s
   78031    7.9618770e+04   0.000000e+00   1.943044e+07     25s
   88866    8.5379835e+04   0.000000e+00   7.018462e+06     30s
Concurrent spin time: 8.71s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.861662e+04, 70842 iterations, 37.10 seconds (64.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88616.6227    0  114 -168399.12 88616.6227   153%     -   38s
H    0     0                    -153472.6160 88616.6227   158%     -   38s
H    0     0                    -102545.7057 88616.6227   186%     -   38s
H    0     0                    -100230.6272 88616.6227   188%     -   38s
H    0     0                    -64797.18222 88616.6227   237%     -   38s
H    0     0                    -64219.31162 88616.6227   238%     -   38s
H    0     0                    -63926.26497 88616.6227   239%     -   38s
H    0     0                    -63918.81955 88616.6227   239%     -   38s
H    0     0                    -63836.88848 88616.6227   239%     -   38s
H    0     0                    -63618.62112 88616.6227   239%     -   38s
H    0     0                    -26667.30790 88616.6227   432%     -   39s
H    0     0                    -26615.88326 88616.6227   433%     -   39s
H    0     0                    28268.947955 88616.6227   213%     -   39s
H    0     0                    33886.692297 88616.6227   162%     -   39s
H    0     0                    35759.501164 88616.6227   148%     -   39s
H    0     0                    51395.267966 88616.6227  72.4%     -   39s
H    0     0                    51653.984529 88616.6227  71.6%     -   39s
H    0     0                    53415.504512 88616.6227  65.9%     -   39s
     0     0 83088.2507    0  178 53415.5045 83088.2507  55.6%     -   47s
H    0     0                    54922.845482 83088.2310  51.3%     -   47s
H    0     0                    55763.768106 83088.2310  49.0%     -   47s
H    0     0                    55802.998763 83088.2310  48.9%     -   47s
     0     0 82419.3524    0  186 55802.9988 82419.3524  47.7%     -   51s
     0     0 82309.4719    0  179 55802.9988 82309.4719  47.5%     -   54s
     0     0 82229.3813    0  186 55802.9988 82229.3813  47.4%     -   55s
     0     0 82209.0123    0  185 55802.9988 82209.0123  47.3%     -   55s
     0     0 82200.2488    0  185 55802.9988 82200.2488  47.3%     -   56s
     0     0 82109.9926    0  207 55802.9988 82109.9926  47.1%     -   57s
     0     0 82108.8825    0  208 55802.9988 82108.8825  47.1%     -   57s
     0     0 82108.8825    0  208 55802.9988 82108.8825  47.1%     -   58s
     0     0 79090.7574    0  243 55802.9988 79090.7574  41.7%     -   66s
H    0     0                    57451.638312 79089.9644  37.7%     -   66s
H    0     0                    57501.110353 79089.9644  37.5%     -   66s
H    0     0                    57672.798107 79089.9644  37.1%     -   66s
H    0     0                    57695.829644 79089.9644  37.1%     -   66s
H    0     0                    57818.476103 79089.9644  36.8%     -   66s
H    0     0                    57956.284552 79089.9644  36.5%     -   66s
     0     0 78644.1103    0  240 57956.2846 78644.1103  35.7%     -   71s
     0     0 78542.5316    0  273 57956.2846 78542.5316  35.5%     -   74s
     0     0 78501.6623    0  270 57956.2846 78501.6623  35.4%     -   75s
     0     0 78268.0134    0  272 57956.2846 78268.0134  35.0%     -   77s
     0     0 78260.5864    0  278 57956.2846 78260.5864  35.0%     -   78s
     0     0 78215.2100    0  278 57956.2846 78215.2100  35.0%     -   79s
     0     0 78208.1794    0  255 57956.2846 78208.1794  34.9%     -   80s
     0     0 78205.5403    0  255 57956.2846 78205.5403  34.9%     -   80s
     0     0 78203.5432    0  257 57956.2846 78203.5432  34.9%     -   80s
     0     0 78172.5987    0  260 57956.2846 78172.5987  34.9%     -   81s
     0     0 78158.3252    0  258 57956.2846 78158.3252  34.9%     -   82s
     0     0 78156.6830    0  257 57956.2846 78156.6830  34.9%     -   82s
     0     0 78156.2757    0  258 57956.2846 78156.2757  34.9%     -   82s
     0     0 76146.5062    0  281 57956.2846 76146.5062  31.4%     -   99s
H    0     0                    58237.816345 75911.4916  30.3%     -  103s
H    0     0                    58287.652639 75911.4916  30.2%     -  103s
     0     0 75911.4916    0  273 58287.6526 75911.4916  30.2%     -  103s
     0     0 75807.8190    0  284 58287.6526 75807.8190  30.1%     -  105s
     0     0 75777.1738    0  282 58287.6526 75777.1738  30.0%     -  106s
     0     0 75750.3320    0  288 58287.6526 75750.3320  30.0%     -  107s
     0     0 75727.3887    0  297 58287.6526 75727.3887  29.9%     -  107s
     0     0 75711.4535    0  296 58287.6526 75711.4535  29.9%     -  108s
     0     0 75705.6332    0  294 58287.6526 75705.6332  29.9%     -  109s
     0     0 75700.6972    0  294 58287.6526 75700.6972  29.9%     -  109s
     0     0 75696.0753    0  292 58287.6526 75696.0753  29.9%     -  109s
     0     0 75695.0368    0  292 58287.6526 75695.0368  29.9%     -  110s
     0     0 75107.2310    0  314 58287.6526 75107.2310  28.9%     -  115s
     0     0 74975.1919    0  307 58287.6526 74975.1919  28.6%     -  118s
     0     0 74913.2341    0  343 58287.6526 74913.2341  28.5%     -  119s
     0     0 74894.4968    0  285 58287.6526 74894.4968  28.5%     -  120s
     0     0 74886.1406    0  326 58287.6526 74886.1406  28.5%     -  121s
     0     0 74877.6632    0  327 58287.6526 74877.6632  28.5%     -  122s
     0     0 74871.5327    0  323 58287.6526 74871.5327  28.5%     -  122s
     0     0 74867.0014    0  325 58287.6526 74867.0014  28.4%     -  122s
     0     0 74866.0303    0  330 58287.6526 74866.0303  28.4%     -  123s
     0     0 74728.7694    0  363 58287.6526 74728.7694  28.2%     -  126s
     0     0 74714.5638    0  282 58287.6526 74714.5638  28.2%     -  128s
     0     0 74705.0076    0  317 58287.6526 74705.0076  28.2%     -  129s
     0     0 74699.1584    0  286 58287.6526 74699.1584  28.2%     -  129s
     0     0 74697.6170    0  282 58287.6526 74697.6170  28.2%     -  130s
     0     0 74653.5270    0  280 58287.6526 74653.5270  28.1%     -  133s
     0     0 74638.2699    0  307 58287.6526 74638.2699  28.1%     -  134s
     0     0 74625.2805    0  304 58287.6526 74625.2805  28.0%     -  136s
     0     0 74620.0160    0  303 58287.6526 74620.0160  28.0%     -  136s
     0     0 74613.9434    0  305 58287.6526 74613.9434  28.0%     -  137s
     0     0 74613.6394    0  303 58287.6526 74613.6394  28.0%     -  137s
     0     0 74602.6062    0  407 58287.6526 74602.6062  28.0%     -  139s
     0     0 74599.0662    0  372 58287.6526 74599.0662  28.0%     -  140s
     0     0 74598.4913    0  376 58287.6526 74598.4913  28.0%     -  141s
     0     0 74579.8302    0  419 58287.6526 74579.8302  28.0%     -  143s
     0     0 74571.3575    0  318 58287.6526 74571.3575  27.9%     -  144s
     0     0 74568.8372    0  321 58287.6526 74568.8372  27.9%     -  144s
     0     0 74567.4230    0  298 58287.6526 74567.4230  27.9%     -  144s
     0     0 74564.9681    0  295 58287.6526 74564.9681  27.9%     -  145s
     0     0 74562.7249    0  293 58287.6526 74562.7249  27.9%     -  146s
     0     0 74562.3224    0  294 58287.6526 74562.3224  27.9%     -  147s
     0     0 74555.6220    0  299 58287.6526 74555.6220  27.9%     -  148s
     0     0 74554.1550    0  323 58287.6526 74554.1550  27.9%     -  148s
     0     0 74551.5414    0  345 58287.6526 74551.5414  27.9%     -  149s
     0     0 74548.3095    0  321 58287.6526 74548.3095  27.9%     -  150s
     0     0 74547.0916    0  326 58287.6526 74547.0916  27.9%     -  151s
     0     0 74546.9675    0  326 58287.6526 74546.9675  27.9%     -  151s
H    0     0                    58496.187468 74508.1274  27.4%     -  152s
H    0     0                    58601.593507 74508.1274  27.1%     -  152s
     0     0 74508.1274    0  297 58601.5935 74508.1274  27.1%     -  153s
     0     0 74495.1275    0  302 58601.5935 74495.1275  27.1%     -  154s
     0     0 74493.9085    0  303 58601.5935 74493.9085  27.1%     -  154s
     0     0 74485.2634    0  328 58601.5935 74485.2634  27.1%     -  155s
     0     0 74483.6941    0  305 58601.5935 74483.6941  27.1%     -  156s
     0     0 74480.0524    0  322 58601.5935 74480.0524  27.1%     -  157s
H    0     0                    58622.639144 74480.0145  27.0%     -  158s
     0     0 74478.8877    0  322 58622.6391 74478.8877  27.0%     -  158s
     0     0 74475.9212    0  297 58622.6391 74475.9212  27.0%     -  159s
H    0     0                    58656.771970 74475.8464  27.0%     -  159s
     0     0 74475.0484    0  298 58656.7720 74475.0484  27.0%     -  160s
     0     0 74473.4950    0  303 58656.7720 74473.4950  27.0%     -  160s
     0     0 74473.4269    0  303 58656.7720 74473.4269  27.0%     -  161s
H    0     0                    58707.785014 74473.4269  26.9%     -  178s
     0     2 74473.4269    0  303 58707.7850 74473.4269  26.9%     -  187s
     1     3 73735.8193    1  297 58707.7850 74473.3497  26.9%  6351  191s
     2     5 73415.8689    2  368 58707.7850 74473.3497  26.9%  6514  197s
     4    10 73927.5846    2  303 58707.7850 74077.4525  26.2%  6330  202s
     9    20 73822.6117    3  376 58707.7850 73926.8917  25.9%  5544  209s
    19    40 73630.4229    4  338 58707.7850 73857.1538  25.8%  7080  216s
    39    52 72249.4329    5  301 58707.7850 73630.2700  25.4%  9903  233s
    51    83 71824.9690    6  362 58707.7850 73630.2700  25.4%  9884  246s
H   52    83                    58829.915511 73630.2700  25.2%  9694  246s
    82   193 71777.4389    7  367 58829.9155 73630.2700  25.2%  9041  258s
   192   261 71582.4987   10  315 58829.9155 73630.2700  25.2%  5985  265s
H  194   261                    58846.912467 73630.2700  25.1%  5944  265s
H  200   261                    58948.530319 73630.2700  24.9%  5896  265s
H  238   261                    59086.738343 73630.2700  24.6%  5473  265s
   262   331 71206.6653   12  300 59086.7383 73630.2700  24.6%  5249  273s
H  334   400                    59086.804538 73630.2700  24.6%  4766  282s
H  340   400                    59089.129864 73630.2700  24.6%  4749  282s
H  401   400                    59301.852166 73630.2700  24.2%  4405  282s
   409   468 69966.8873   15  227 59301.8522 73630.2700  24.2%  4349  289s
   479   496 68834.0608   18  295 59301.8522 73630.2700  24.2%  4122  295s
   511   554 68798.7824   19  292 59301.8522 73630.2700  24.2%  4018  302s
H  521   554                    59402.530296 73630.2700  24.0%  3982  302s
   575   631 68582.3270   24  290 59402.5303 73630.2700  24.0%  3775  309s
   670   712 67322.7764   29  162 59402.5303 73630.2700  24.0%  3490  316s
   763   780 66675.5645   32  165 59402.5303 73630.2700  24.0%  3266  320s
   845   824 65935.2455   34  127 59402.5303 73630.2700  24.0%  3120  332s
   909   895 65542.4635   36  142 59402.5303 73630.2700  24.0%  3017  336s
   990   965 65187.8032   40  135 59402.5303 73630.2700  24.0%  2899  343s
H 1013   965                    59726.304207 73630.2700  23.3%  2885  343s
  1082  1035 65050.8517   45  111 59726.3042 73630.2700  23.3%  2796  350s
H 1192  1098                    59899.797269 73630.2700  22.9%  2706  358s
  1279  1158 60781.0496   59   59 59899.7973 73630.2700  22.9%  2636  366s
  1378  1240 60549.1679   67   70 59899.7973 73630.2700  22.9%  2530  374s
  1512  1348     cutoff   71      59899.7973 73462.7222  22.6%  2399  382s
  1660  1395 64297.5607   50   61 59899.7973 73462.2655  22.6%  2301  390s
  1726  1518 64691.6279   25  149 59899.7973 73462.2655  22.6%  2279  399s
  1869  1606 64350.3067   34   89 59899.7973 73462.2655  22.6%  2188  407s
  2012  1686 63156.5458   41   74 59899.7973 73462.2655  22.6%  2136  414s
  2151  1778 62832.0294   53  100 59899.7973 72739.0126  21.4%  2111  422s
  2257  1808     cutoff   67      59899.7973 72739.0126  21.4%  2123  431s
  2295  1839 61490.7771   68   69 59899.7973 72739.0126  21.4%  2138  438s
  2328  1888 61476.1376   69   65 59899.7973 72739.0126  21.4%  2159  446s
H 2333  1888                    59913.117155 72739.0126  21.4%  2158  446s
  2383  1913 61432.1053   70   63 59913.1172 72739.0126  21.4%  2167  454s
  2420  1935 61399.7484   71   85 59913.1172 72739.0126  21.4%  2175  464s
  2456  1962 61362.2461   72   83 59913.1172 72739.0126  21.4%  2170  472s
  2493  1984     cutoff   73      59913.1172 72477.8695  21.0%  2175  478s
  2532  2012 61318.5700   74   69 59913.1172 72477.8695  21.0%  2174  488s
  2582  2059     cutoff   75      59913.1172 72477.8695  21.0%  2163  495s
  2639  2133     cutoff   76      59913.1172 72442.7430  20.9%  2150  502s
  2731  2221     cutoff   77      59913.1172 72442.7430  20.9%  2118  509s
  2853  2259 70289.4051    8  330 59913.1172 72442.7430  20.9%  2078  520s
H 2957  2259                    60005.911055 72315.5498  20.5%  2071  520s
  2978  2305 67973.1127   10  280 60005.9111 72315.5498  20.5%  2066  532s
  3110  2361 67175.9066   12  288 60005.9111 72315.5498  20.5%  2101  546s
  3260  2428 64493.4180   16  213 60005.9111 72180.6789  20.3%  2131  560s
H 3391  2452                    60018.622180 72109.4201  20.1%  2159  573s
H 3393  2444                    60098.526314 72109.4201  20.0%  2159  573s
H 3397  2442                    60107.680805 72109.4201  20.0%  2162  573s
H 3405  2434                    60187.619010 72109.4201  19.8%  2164  573s
  3429  2563 62017.4824   21  105 60187.6190 72109.4201  19.8%  2180  587s
  3643  2695 60528.5234   42   79 60187.6190 72109.4201  19.8%  2176  602s
  3859  2801 67597.0728    7  222 60187.6190 71949.5003  19.5%  2164  615s
  4039  2802 67357.1748   19  303 60187.6190 71949.5003  19.5%  2187  685s
  4041  2803 71189.8287   11  114 60187.6190 71949.5003  19.5%  2186  721s
  4042  2804 64067.8010   14  308 60187.6190 71949.5003  19.5%  2185  740s
  4043  2805 61902.6117   61  288 60187.6190 71949.5003  19.5%  2185  749s
  4044  2805 60595.7116   13  310 60187.6190 71949.5003  19.5%  2184  755s
  4045  2806 62856.6698   37  354 60187.6190 71949.5003  19.5%  2184  761s
  4047  2807 63842.6006   34  343 60187.6190 71949.5003  19.5%  2183  767s
  4049  2809 62154.4450   21  377 60187.6190 71949.5003  19.5%  2182  773s
  4050  2809 61704.0332   49  423 60187.6190 71949.5003  19.5%  2181  777s
  4052  2811 65626.4511   23  348 60187.6190 71949.5003  19.5%  2180  782s
  4054  2812 62931.0864   48  323 60187.6190 71949.5003  19.5%  2179  785s
  4056  2813 66522.1918   12  322 60187.6190 71949.5003  19.5%  2178  790s
  4060  2816 70628.3762   16  379 60187.6190 71949.5003  19.5%  2176  798s
  4061  2817 67214.8181   32  346 60187.6190 71949.5003  19.5%  2175  800s
  4062  2817 62296.0086   16  388 60187.6190 71949.5003  19.5%  2175  806s
  4064  2819 65250.6196   16  420 60187.6190 71949.5003  19.5%  2173  811s
  4066  2820 61521.1802   29  429 60187.6190 71949.5003  19.5%  2172  816s
  4068  2821 70595.0323   11  436 60187.6190 71949.5003  19.5%  2171  821s
  4070  2823 61111.1081   33  291 60187.6190 71949.5003  19.5%  2170  825s
  4073  2825 63718.3463   16  456 60187.6190 71949.5003  19.5%  2169  833s
  4075  2826 71419.4924   10  284 60187.6190 71949.5003  19.5%  2168  835s
  4077  2827 68668.1220    9  397 60187.6190 71949.5003  19.5%  2167  869s
  4078  2828 68932.3533   29  397 60187.6190 71949.5003  19.5%  2166  883s
  4079  2832 71949.5003   15  392 60187.6190 71949.5003  19.5%  2218  897s
  4081  2835 71949.5003   16  425 60187.6190 71949.5003  19.5%  2220  912s
  4085  2842 71949.5003   17  421 60187.6190 71949.5003  19.5%  2227  926s
  4093  2855 71949.5003   18  423 60187.6190 71949.5003  19.5%  2239  936s
  4109  2874 71949.5003   19  318 60187.6190 71949.5003  19.5%  2287  960s
  4133  2898 68434.4385   20  269 60187.6190 71949.5003  19.5%  2330  975s
  4165  2975 67688.3458   21  223 60187.6190 71949.5003  19.5%  2384  991s
  4264  3000 65905.3097   24  290 60187.6190 71949.5003  19.5%  2439 1003s
  4338  3003 66036.7211   24  167 60187.6190 71949.5003  19.5%  2469 1019s
  4409  3017 65207.0167   22  199 60187.6190 71949.5003  19.5%  2484 1031s
  4494  2996 62555.4091   25  262 60187.6190 71949.5003  19.5%  2496 1040s
  4538  3008     cutoff   25      60187.6190 71949.5003  19.5%  2506 1049s
  4598  3011 62028.4475   26  200 60187.6190 71949.5003  19.5%  2510 1062s
  4654  3020     cutoff   27      60187.6190 71949.5003  19.5%  2508 1071s
  4733  3015 66355.5233   22  186 60187.6190 71949.5003  19.5%  2510 1080s
  4805  3001 65645.4419   23  182 60187.6190 71949.5003  19.5%  2510 1090s
  4878  3011 62633.7458   24  223 60187.6190 71949.5003  19.5%  2515 1098s
  4954  3021 62475.2153   25  269 60187.6190 71949.5003  19.5%  2515 1113s
  5035  3017 62082.5171   26  152 60187.6190 71949.5003  19.5%  2516 1123s
  5113  3010 60681.2621   27  132 60187.6190 71949.5003  19.5%  2513 1133s
  5188  3013 60777.3375   28  175 60187.6190 71949.5003  19.5%  2511 1143s
  5257  3012 60396.8888   29  125 60187.6190 70829.4083  17.7%  2513 1154s
  5347  2985     cutoff   22      60187.6190 70779.5037  17.6%  2509 1164s
H 5355  2839                    60577.202258 70779.5037  16.8%  2509 1164s
H 5365  2702                    60735.892220 70772.4936  16.5%  2510 1164s
  5405  2705     cutoff   27      60735.8922 70519.5922  16.1%  2518 1174s
H 5415  2572                    61097.039456 70519.5922  15.4%  2518 1174s
H 5476  2431                    61156.144051 70519.5922  15.3%  2521 1174s
  5505  2438 64198.8982   24  232 61156.1441 70466.8842  15.2%  2519 1182s
H 5512  2320                    61542.331861 70466.8842  14.5%  2518 1182s
H 5558  2219                    61727.147646 70466.8842  14.2%  2523 1195s
H 5632  2089                    61736.882627 70005.1388  13.4%  2524 1195s
  5663  2109 63582.8615   26  249 61736.8826 70005.1388  13.4%  2528 1207s
H 5777  2008                    61805.936140 70005.1388  13.3%  2528 1220s
  5906  1983 62064.2507   36  179 61805.9361 70005.1388  13.3%  2524 1235s
  6002  1975     cutoff   38      61805.9361 70005.1388  13.3%  2523 1251s
H 6062  1861                    61819.463016 70005.1388  13.2%  2522 1251s
  6135  1854 64035.3776   26  334 61819.4630 69422.7844  12.3%  2519 1262s
H 6202  1743                    61838.738705 69422.7844  12.3%  2517 1262s
  6216  1772 63557.1439   27  276 61838.7387 69422.7844  12.3%  2518 1274s
  6352  1745 63371.1501   29  222 61838.7387 69115.4841  11.8%  2522 1289s
  6541  1725 63685.5507   48   80 61838.7387 68565.7641  10.9%  2514 1304s
H 6726  1605                    62015.436747 68565.7641  10.6%  2507 1317s
  6864  1588 62828.0815   74   68 62015.4367 68565.7641  10.6%  2498 1332s
  7104  1523 62225.1788   91   40 62015.4367 68565.7641  10.6%  2481 1345s
  7345  1450     cutoff   28      62015.4367 68042.6685  9.72%  2465 1362s
  7581  1390     cutoff   24      62015.4367 67943.3394  9.56%  2457 1378s
  7804  1309 64227.0040   25  265 62015.4367 67282.6088  8.49%  2455 1397s
H 7824  1222                    62022.817912 67282.6088  8.48%  2455 1397s
H 7867  1131                    62036.221903 66958.0065  7.93%  2459 1397s
  8021  1053 62338.7128   27  194 62036.2219 66958.0065  7.93%  2459 1412s
  8187   989 62329.4836   31  104 62036.2219 66235.8348  6.77%  2463 1429s
  8429   913     cutoff   24      62036.2219 66150.5006  6.63%  2460 1448s
  8696   864 infeasible   30      62036.2219 65383.7274  5.40%  2456 1465s
  9036   875 63084.2468   29  167 62036.2219 65184.7698  5.08%  2438 1483s
  9494   888     cutoff   29      62036.2219 64580.5071  4.10%  2392 1499s
  9870   776 62886.3554   24  234 62036.2219 64580.5071  4.10%  2359 1516s
 10426   752     cutoff   35      62036.2219 63785.5939  2.82%  2303 1532s
 11557   862 62272.1550   95   46 62036.2219 63491.8103  2.35%  2120 1543s
H11627   862                    62042.304490 63491.8103  2.34%  2110 1543s
H11673   862                    62160.738372 63480.2692  2.12%  2103 1543s
H12377   862                    62193.506604 63383.5576  1.91%  1995 1543s
 13043   673 62317.1570   84   38 62193.5066 63176.6456  1.58%  1904 1551s
 14786   187     cutoff   87      62193.5066 62806.2406  0.99%  1692 1556s

Cutting planes:
  Learned: 1
  MIR: 534
  Mixing: 1
  Flow cover: 1534
  RLT: 11
  Relax-and-lift: 164

Explored 16829 nodes (25387856 simplex iterations) in 1558.27 seconds (4549.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 62193.5 62160.7 62042.3 ... 61736.9

Optimal solution found (tolerance 1.00e-04)
Best objective 6.219350660422e+04, best bound 6.219350660422e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1558.28s
  Master Objective (UB) = 62193.51, θ = 209840.27
  Upper Bound (UB) = 62193.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 209840.27
  [DEBUG]   ✓ Scenario 0: θ = 209840.27 ≤ Q = 209840.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 209840.27 ≤ Q = 209840.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 209840.27 ≤ Q = 209840.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 209840.27 ≤ Q = 209840.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 209840.27 ≤ Q = 209840.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 209840.27 ≤ Q = 209840.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 209840.27 ≤ Q = 209840.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 209840.27 ≤ Q = 209840.27 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xb84e07c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0b84e07c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.496072e+13
Presolve removed 2619 rows and 1910 columns
Presolve time: 0.00s
Presolved: 474 rows, 479 columns, 1337 nonzeros
Found heuristic solution: objective 7175216.1845
Variable types: 324 continuous, 155 integer (155 binary)
Found heuristic solution: objective 7174840.3403

Root relaxation: objective -1.602319e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160231.87    0  126 7174840.34 -160231.87   102%     -    0s
H    0     0                    -122315.9983 -160231.87  31.0%     -    0s
H    0     0                    -122691.8425 -160231.87  30.6%     -    0s
H    0     0                    -122964.6479 -160231.87  30.3%     -    0s
H    0     0                    -123340.4921 -160231.87  29.9%     -    0s
H    0     0                    -123963.5846 -139846.57  12.8%     -    0s
H    0     0                    -133570.3124 -139846.57  4.70%     -    0s
     0     0 -139846.57    0   60 -133570.31 -139846.57  4.70%     -    0s
H    0     0                    -134345.5495 -139787.82  4.05%     -    0s
H    0     0                    -136570.2131 -139787.82  2.36%     -    0s
H    0     0                    -137760.2137 -139787.82  1.47%     -    0s
H    0     0                    -137949.7850 -139705.40  1.27%     -    0s
     0     0 -139702.39    0   62 -137949.78 -139702.39  1.27%     -    0s
     0     0 -139701.29    0   61 -137949.78 -139701.29  1.27%     -    0s
     0     0 -139173.70    0   48 -137949.78 -139173.70  0.89%     -    0s
H    0     0                    -138805.0529 -139173.70  0.27%     -    0s
     0     0 -139157.07    0   48 -138805.05 -139157.07  0.25%     -    0s
     0     0 -139156.54    0   48 -138805.05 -139156.54  0.25%     -    0s
     0     0 -139156.54    0   34 -138805.05 -139156.54  0.25%     -    0s
     0     0 -139155.38    0   33 -138805.05 -139155.38  0.25%     -    0s
     0     0 -139155.38    0   34 -138805.05 -139155.38  0.25%     -    0s
     0     0 -139151.88    0   34 -138805.05 -139151.88  0.25%     -    0s
     0     0 -139151.88    0   70 -138805.05 -139151.88  0.25%     -    0s
     0     0 -139151.88    0   52 -138805.05 -139151.88  0.25%     -    0s
     0     0 -139151.88    0   46 -138805.05 -139151.88  0.25%     -    0s
     0     0 -139083.68    0   63 -138805.05 -139083.68  0.20%     -    0s
     0     0 -139083.12    0   63 -138805.05 -139083.12  0.20%     -    0s
     0     0 -139047.39    0   47 -138805.05 -139047.39  0.17%     -    0s
H    0     0                    -138812.2215 -139047.08  0.17%     -    0s
     0     0 -139037.61    0   58 -138812.22 -139037.61  0.16%     -    0s
     0     0 -139036.55    0   60 -138812.22 -139036.55  0.16%     -    0s
     0     0 -139019.87    0   54 -138812.22 -139019.87  0.15%     -    0s
     0     0 -139017.22    0   63 -138812.22 -139017.22  0.15%     -    0s
     0     0 -139014.71    0   62 -138812.22 -139014.71  0.15%     -    0s
     0     0 -139003.64    0   62 -138812.22 -139003.64  0.14%     -    0s
     0     2 -139003.64    0   62 -138812.22 -139003.64  0.14%     -    0s

Cutting planes:
  Gomory: 27
  Implied bound: 9
  MIR: 57
  Flow cover: 17
  RLT: 20

Explored 18 nodes (1170 simplex iterations) in 0.10 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -138812 -138805 -137950 ... -122965

Optimal solution found (tolerance 1.00e-04)
Best objective -1.388122215215e+05, best bound -1.388249845483e+05, gap 0.0092%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 200567.90
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138812.22
  [DEBUG]   S×d_nominal = 339380.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 339380.12 + -138812.22 = 200567.90
  [DEBUG]   Current θ from Master = 209840.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9272.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 52921.13
  Lower Bound (LB) = 55531.28
  Gap (UB-LB) = 6662.2244, Absolute Gap = 6662.2244, Relative Gap = 0.107121
  Not converged yet (gap = 6662.22 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394544 nonzeros
Model fingerprint: 0x4c9df483
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 65448 rows and 26568 columns
Presolve time: 1.21s
Presolved: 73545 rows, 31852 columns, 457679 nonzeros
Variable types: 29593 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73545 rows, 31852 columns, 457679 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32527   -9.0626356e+04   0.000000e+00   2.046735e+07      5s
   47783    8.2351817e+03   0.000000e+00   1.203512e+07     10s
   58905    3.0235306e+04   0.000000e+00   3.212805e+06     15s
   68124    4.0655880e+04   0.000000e+00   3.844942e+06     20s
   77973    4.8221969e+04   0.000000e+00   3.114491e+08     25s
   85848    5.2347598e+04   0.000000e+00   2.604770e+06     30s
Concurrent spin time: 6.97s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.835487e+04, 71556 iterations, 36.83 seconds (66.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88354.8748    0   74 -168399.12 88354.8748   152%     -   38s
H    0     0                    -151472.2152 88354.8748   158%     -   38s
H    0     0                    -145380.6530 88354.8748   161%     -   38s
H    0     0                    -143895.7830 88354.8748   161%     -   38s
H    0     0                    -86786.67021 88354.8748   202%     -   39s
H    0     0                    -86350.98451 88354.8748   202%     -   39s
H    0     0                    -86056.86364 88354.8748   203%     -   39s
H    0     0                    -85623.50321 88354.8748   203%     -   39s
H    0     0                    -85100.61408 88354.8748   204%     -   39s
H    0     0                    -84806.49322 88354.8748   204%     -   39s
H    0     0                    -36830.32112 88354.8748   340%     -   39s
H    0     0                    -1773.553513 88354.8748  5082%     -   39s
H    0     0                     279.3269260 88354.8748      -     -   39s
H    0     0                    23326.757520 88354.8748   279%     -   39s
H    0     0                    37955.963028 88354.8748   133%     -   39s
H    0     0                    38285.672413 88354.8748   131%     -   39s
H    0     0                    51008.494982 88354.8748  73.2%     -   39s
H    0     0                    51941.189073 88354.8748  70.1%     -   39s
H    0     0                    52121.445543 88354.8748  69.5%     -   39s
H    0     0                    52205.002249 88354.8748  69.2%     -   39s
H    0     0                    52247.779673 81980.5114  56.9%     -   51s
     0     0 81980.5114    0  214 52247.7797 81980.5114  56.9%     -   51s
     0     0 81743.6136    0  220 52247.7797 81743.6136  56.5%     -   55s
     0     0 81708.3656    0  220 52247.7797 81708.3656  56.4%     -   56s
     0     0 81708.3656    0  219 52247.7797 81708.3656  56.4%     -   57s
     0     0 81499.6467    0  222 52247.7797 81499.6467  56.0%     -   59s
     0     0 81499.6467    0  211 52247.7797 81499.6467  56.0%     -   62s
     0     0 81499.6467    0  211 52247.7797 81499.6467  56.0%     -   63s
     0     0 79084.3442    0  233 52247.7797 79084.3442  51.4%     -   79s
H    0     0                    55253.238379 79084.3442  43.1%     -   80s
H    0     0                    57721.348931 79084.3442  37.0%     -   80s
H    0     0                    57967.810801 79084.3442  36.4%     -   80s
H    0     0                    58259.495998 79084.3442  35.7%     -   80s
H    0     0                    58459.095227 79084.3442  35.3%     -   80s
H    0     0                    58562.588481 79084.3442  35.0%     -   80s
H    0     0                    58707.785014 79084.3442  34.7%     -   80s
     0     0 78391.7427    0  237 58707.7850 78391.7427  33.5%     -   86s
     0     0 78097.3902    0  250 58707.7850 78097.3902  33.0%     -   90s
     0     0 78058.6489    0  247 58707.7850 78058.6489  33.0%     -   92s
     0     0 77988.1509    0  245 58707.7850 77988.1509  32.8%     -   94s
     0     0 77898.4570    0  248 58707.7850 77898.4570  32.7%     -   96s
     0     0 77858.1370    0  253 58707.7850 77858.1370  32.6%     -   98s
     0     0 77570.5920    0  255 58707.7850 77570.5920  32.1%     -  102s
     0     0 77525.9546    0  255 58707.7850 77525.9546  32.1%     -  104s
     0     0 77522.2026    0  256 58707.7850 77522.2026  32.0%     -  105s
     0     0 77450.6059    0  242 58707.7850 77450.6059  31.9%     -  106s
     0     0 77407.6234    0  250 58707.7850 77407.6234  31.9%     -  107s
     0     0 77398.5944    0  241 58707.7850 77398.5944  31.8%     -  108s
     0     0 77392.2792    0  247 58707.7850 77392.2792  31.8%     -  108s
     0     0 77392.2353    0  249 58707.7850 77392.2353  31.8%     -  109s
     0     0 75893.0292    0  264 58707.7850 75893.0292  29.3%     -  127s
     0     0 75526.7654    0  271 58707.7850 75526.7654  28.6%     -  135s
     0     0 75384.5981    0  276 58707.7850 75384.5981  28.4%     -  141s
     0     0 75320.4438    0  329 58707.7850 75320.4438  28.3%     -  143s
     0     0 75295.5701    0  365 58707.7850 75295.5701  28.3%     -  145s
     0     0 75275.2472    0  326 58707.7850 75275.2472  28.2%     -  147s
     0     0 75257.7738    0  324 58707.7850 75257.7738  28.2%     -  149s
     0     0 75234.3808    0  360 58707.7850 75234.3808  28.2%     -  150s
     0     0 75216.8352    0  302 58707.7850 75216.8352  28.1%     -  151s
     0     0 75209.2770    0  305 58707.7850 75209.2770  28.1%     -  152s
     0     0 75203.0074    0  332 58707.7850 75203.0074  28.1%     -  152s
     0     0 75200.8915    0  306 58707.7850 75200.8915  28.1%     -  153s
     0     0 75189.7220    0  308 58707.7850 75189.7220  28.1%     -  154s
     0     0 75182.8212    0  305 58707.7850 75182.8212  28.1%     -  154s
     0     0 75181.7507    0  304 58707.7850 75181.7507  28.1%     -  154s
     0     0 74680.4944    0  354 58707.7850 74680.4944  27.2%     -  162s
     0     0 74594.4511    0  367 58707.7850 74594.4511  27.1%     -  166s
     0     0 74544.1542    0  379 58707.7850 74544.1542  27.0%     -  168s
     0     0 74485.7630    0  376 58707.7850 74485.7630  26.9%     -  170s
     0     0 74463.9079    0  376 58707.7850 74463.9079  26.8%     -  171s
     0     0 74456.7449    0  419 58707.7850 74456.7449  26.8%     -  172s
     0     0 74451.1737    0  420 58707.7850 74451.1737  26.8%     -  172s
     0     0 74437.0226    0  382 58707.7850 74437.0226  26.8%     -  173s
     0     0 74435.4236    0  385 58707.7850 74435.4236  26.8%     -  173s
     0     0 74432.1800    0  392 58707.7850 74432.1800  26.8%     -  174s
     0     0 74428.6598    0  390 58707.7850 74428.6598  26.8%     -  174s
     0     0 74426.3112    0  386 58707.7850 74426.3112  26.8%     -  174s
     0     0 74426.1734    0  392 58707.7850 74426.1734  26.8%     -  175s
     0     0 74368.3198    0  390 58707.7850 74368.3198  26.7%     -  177s
     0     0 74359.2138    0  385 58707.7850 74359.2138  26.7%     -  179s
     0     0 74352.7349    0  388 58707.7850 74352.7349  26.6%     -  179s
     0     0 74349.1011    0  390 58707.7850 74349.1011  26.6%     -  180s
     0     0 74348.0844    0  396 58707.7850 74348.0844  26.6%     -  180s
     0     0 74337.3002    0  396 58707.7850 74337.3002  26.6%     -  182s
     0     0 74335.2018    0  398 58707.7850 74335.2018  26.6%     -  183s
     0     0 74334.1436    0  401 58707.7850 74334.1436  26.6%     -  183s
     0     0 74325.3065    0  405 58707.7850 74325.3065  26.6%     -  184s
     0     0 74320.4991    0  405 58707.7850 74320.4991  26.6%     -  185s
     0     0 74318.8812    0  408 58707.7850 74318.8812  26.6%     -  186s
     0     0 74314.2045    0  405 58707.7850 74314.2045  26.6%     -  187s
     0     0 74312.6456    0  404 58707.7850 74312.6456  26.6%     -  188s
     0     0 74310.4192    0  408 58707.7850 74310.4192  26.6%     -  188s
     0     0 74310.0987    0  408 58707.7850 74310.0987  26.6%     -  189s
     0     0 74308.2433    0  400 58707.7850 74308.2433  26.6%     -  190s
     0     0 74308.0262    0  400 58707.7850 74308.0262  26.6%     -  191s
H    0     0                    59203.005245 74308.0262  25.5%     -  208s
H    0     0                    59347.864909 74308.0262  25.2%     -  208s
     0     2 74308.0262    0  400 59347.8649 74308.0262  25.2%     -  208s
     1     4 74268.7760    1  399 59347.8649 74308.0262  25.2%  2006  213s
     3     8 74145.0137    2  343 59347.8649 74268.4476  25.1%  4479  221s
     7    15 72951.9971    3  334 59347.8649 74144.9813  24.9%  7411  229s
    14    30 72159.7134    4  328 59347.8649 74144.9813  24.9%  7819  235s
    29    45 71841.5821    4  376 59347.8649 73485.9760  23.8% 10144  253s
H   44    77                    59403.566751 73485.9760  23.7% 11021  277s
    76   177 71987.0274    7  295 59403.5668 72904.6384  22.7%  9714  290s
   176   248 71678.1519   10  293 59403.5668 72904.6384  22.7%  6609  298s
H  178   248                    59526.211823 72904.6384  22.5%  6548  298s
H  194   248                    59555.711107 72904.6384  22.4%  6230  298s
H  227   248                    59564.003196 72904.6384  22.4%  5637  298s
   247   332 71487.7505   12  281 59564.0032 72904.6384  22.4%  5411  306s
   331   409 71052.4717   14  280 59564.0032 72904.6384  22.4%  4573  315s
   408   468 70668.0671   17  252 59564.0032 72904.6384  22.4%  4127  323s
   467   509 68448.1830   19  217 59564.0032 72904.6384  22.4%  4020  331s
   508   584 68136.1869   20  230 59564.0032 72904.6384  22.4%  3979  339s
   585   658 67682.4511   22  216 59564.0032 72904.6384  22.4%  3721  347s
   663   707 65653.6605   24  199 59564.0032 72904.6384  22.4%  3530  354s
   730   752 65054.7036   26  216 59564.0032 72904.6384  22.4%  3362  363s
   809   801 64830.1967   27  208 59564.0032 72904.6384  22.4%  3174  370s
H  814   801                    59914.021654 72904.6384  21.7%  3168  370s
   890   814 64517.8245   29  197 59914.0217 72904.6384  21.7%  3027  379s
H  939   814                    59926.059801 72904.6384  21.7%  2970  379s
   965   830 62608.4522   31  179 59926.0598 72904.6384  21.7%  2983  387s
  1007   846 61384.5875   32  144 59926.0598 72904.6384  21.7%  3011  395s
H 1024   846                    59939.830515 72904.6384  21.6%  3035  395s
  1053   882 61344.0020   33  134 59939.8305 72904.6384  21.6%  3051  405s
  1128   894     cutoff   35      59939.8305 72835.7527  21.5%  3025  413s
  1163   912 71397.0253   12  356 59939.8305 72835.7527  21.5%  3036  423s
H 1165   912                    59989.245862 72835.7527  21.4%  3037  423s
  1205   919 63864.7033   14  268 59989.2459 72835.7527  21.4%  3054  433s
  1284   934 68807.1256   13  299 59989.2459 72835.4102  21.4%  3041  444s
  1359   948 infeasible   17      59989.2459 72835.4102  21.4%  3046  455s
  1397   974     cutoff   14      59989.2459 72835.4102  21.4%  3087  465s
  1441  1008 66190.5502   13  341 59989.2459 72591.9938  21.0%  3141  475s
H 1462  1008                    60332.362304 72591.9938  20.3%  3163  475s
  1488  1058 65768.4924   14  295 60332.3623 72591.9938  20.3%  3199  486s
  1566  1142 65707.1261   15  293 60332.3623 72591.9938  20.3%  3227  496s
H 1674  1217                    60341.472209 72591.9938  20.3%  3206  508s
H 1687  1217                    60350.057874 72591.9938  20.3%  3192  508s
  1803  1289 63941.9620   26  243 60350.0579 72402.9314  20.0%  3125  520s
  1929  1368 63518.3552   30  228 60350.0579 72402.9314  20.0%  3085  531s
  2090  1389 62971.8816   35  228 60350.0579 72402.9314  20.0%  3002  542s
  2129  1436 62964.2577   36  236 60350.0579 72402.9314  20.0%  3023  554s
  2212  1493 62959.7621   37  224 60350.0579 72402.9314  20.0%  2998  566s
  2357  1571 61611.9204   42  211 60350.0579 72088.4445  19.5%  2941  579s
  2513  1660 infeasible   43      60350.0579 71950.8027  19.2%  2887  593s
  2678  1734 67049.0812    7  222 60350.0579 71950.8027  19.2%  2854  609s
  2837  1794 62992.4483    9  209 60350.0579 71802.2916  19.0%  2821  624s
  2993  1850 62486.4237   11  220 60350.0579 71789.0003  19.0%  2826  638s
  3107  1907 61922.4532   13  231 60350.0579 71671.4435  18.8%  2841  652s
  3249  1978     cutoff   14      60350.0579 71671.4435  18.8%  2862  669s
  3414  2054     cutoff   15      60350.0579 71501.2530  18.5%  2865  688s
  3606  2123 67451.9459   10  299 60350.0579 71501.2530  18.5%  2846  708s
  3776  2216     cutoff   11      60350.0579 71501.2530  18.5%  2835  726s
  3953  2314 60927.5391   13  151 60350.0579 71501.2530  18.5%  2855  744s
  4164  2381     cutoff   15      60350.0579 71501.2530  18.5%  2838  762s
H 4240  2352                    60888.948880 71501.2530  17.4%  2841  762s
  4320  2378 65661.5071    7  227 60888.9489 71182.3880  16.9%  2825  781s
H 4344  2338                    61087.408535 71182.3880  16.5%  2814  781s
  4526  2387     cutoff   14      61087.4085 71149.4834  16.5%  2829  801s
H 4536  2371                    61178.451483 71149.4834  16.3%  2832  801s
H 4546  2369                    61186.996363 71149.4834  16.3%  2834  801s
H 4548  2357                    61241.248727 71149.4834  16.2%  2836  801s
H 4656  2349                    61296.511383 71100.6206  16.0%  2849  801s
  4704  2399     cutoff   19      61296.5114 71100.6206  16.0%  2857  823s
  4905  2450     cutoff   21      61296.5114 71046.0612  15.9%  2884  844s
  5110  2478 63667.9038   15  209 61296.5114 70892.7272  15.7%  2904  867s
  5339  2501     cutoff   18      61296.5114 70652.8297  15.3%  2919  889s
  5502  2545 63559.4753   15  248 61296.5114 70652.8297  15.3%  2931  913s
  5746  2632     cutoff   18      61296.5114 70513.3564  15.0%  2935  937s
  5998  2681 63607.4633   18  219 61296.5114 70500.8866  15.0%  2949  962s
  6265  2765 66230.2352   20  289 61296.5114 70471.3659  15.0%  2963  989s
  6520  2766 64593.9635   17  400 61296.5114 70471.3659  15.0%  2982 1121s
  6522  2767 68298.6233   13   74 61296.5114 70471.3659  15.0%  2981 1156s
  6523  2768 66943.9956   11  283 61296.5114 70471.3659  15.0%  2981 1176s
  6524  2769 63795.0647   39  352 61296.5114 70471.3659  15.0%  2980 1190s
  6525  2769 69676.5842   20  284 61296.5114 70471.3659  15.0%  2980 1197s
  6526  2770 63122.0111   26  340 61296.5114 70471.3659  15.0%  2979 1201s
  6527  2771 64120.5525   11  369 61296.5114 70471.3659  15.0%  2979 1206s
  6528  2771 65933.6865   17  415 61296.5114 70471.3659  15.0%  2978 1210s
  6530  2773 62761.4879   17  383 61296.5114 70471.3659  15.0%  2977 1217s
  6531  2773 67089.4304   17  383 61296.5114 70471.3659  15.0%  2977 1221s
  6532  2774 65187.8203   10  350 61296.5114 70471.3659  15.0%  2977 1229s
  6533  2775 68944.9376   10  434 61296.5114 70471.3659  15.0%  2976 1233s
  6534  2775 65641.4332   23  437 61296.5114 70471.3659  15.0%  2976 1235s
  6536  2777 63859.0663   14  476 61296.5114 70471.3659  15.0%  2975 1244s
  6537  2777 66455.0222   19  486 61296.5114 70471.3659  15.0%  2974 1246s
  6538  2778 63392.6160   19  359 61296.5114 70471.3659  15.0%  2974 1251s
  6539  2779 65960.4352   29  473 61296.5114 70471.3659  15.0%  2973 1255s
  6541  2780 63445.5015   47  309 61296.5114 70471.3659  15.0%  2972 1261s
  6543  2781 65385.5103   16  328 61296.5114 70471.3659  15.0%  2972 1266s
  6545  2783 63415.1066   26  309 61296.5114 70471.3659  15.0%  2971 1270s
  6547  2784 64153.6314   15  343 61296.5114 70471.3659  15.0%  2970 1275s
  6549  2785 61593.5149   54  300 61296.5114 70471.3659  15.0%  2969 1280s
  6551  2787 66648.4176   14  348 61296.5114 70471.3659  15.0%  2968 1285s
  6552  2787 66297.2384   11  348 61296.5114 70471.3659  15.0%  2967 1320s
  6553  2788 62837.6105   26  348 61296.5114 70471.3659  15.0%  2967 1337s
  6554  2791 70471.3659   15  328 61296.5114 70471.3659  15.0%  3002 1353s
  6555  2793 70471.3659   16  259 61296.5114 70471.3659  15.0%  3003 1364s
  6558  2798 70471.3659   17  216 61296.5114 70471.3659  15.0%  3004 1375s
  6564  2808 70471.3659   18  268 61296.5114 70471.3659  15.0%  3007 1390s
  6576  2816 70471.3659   18  278 61296.5114 70471.3659  15.0%  3021 1407s
  6588  2844 70471.3659   20  248 61296.5114 70471.3659  15.0%  3042 1439s
H 6595  2702                    61414.158309 70471.3659  14.7%  3044 1439s
  6620  2774 69588.6048   21  221 61414.1583 70471.3659  14.7%  3070 1456s
  6704  2786 65028.1871   23  237 61414.1583 70471.3659  14.7%  3136 1468s
  6775  2786 64141.6731   24  273 61414.1583 70471.3659  14.7%  3155 1483s
  6837  2781 67475.2073   22  247 61414.1583 70471.3659  14.7%  3170 1496s
  6902  2785 63102.5001   25  254 61414.1583 70471.3659  14.7%  3183 1508s
  6973  2768     cutoff   26      61414.1583 70471.3659  14.7%  3191 1518s
  7019  2769     cutoff   25      61414.1583 70471.3659  14.7%  3195 1531s
  7086  2769 61955.0041   28  273 61414.1583 70471.3659  14.7%  3200 1542s
  7147  2772 65177.2693   24  297 61414.1583 70471.3659  14.7%  3206 1553s
  7202  2793 64726.5872   25  265 61414.1583 70471.3659  14.7%  3214 1563s
H 7204  2659                    61429.601012 70471.3659  14.7%  3213 1563s
  7255  2674 63461.3442   25  227 61429.6010 70471.3659  14.7%  3217 1573s
  7324  2676 63082.3148   26  226 61429.6010 70471.3659  14.7%  3219 1584s
H 7333  2546                    61640.989519 70471.3659  14.3%  3220 1584s
H 7380  2410                    61713.367141 70471.3659  14.2%  3216 1584s
  7387  2431 63074.2410   27  221 61713.3671 70471.3659  14.2%  3215 1594s
  7466  2419 61842.5126   28  163 61713.3671 70471.3659  14.2%  3214 1605s
  7542  2408     cutoff   29      61713.3671 70471.3659  14.2%  3210 1615s
  7634  2411 62587.4616   28  210 61713.3671 70471.3659  14.2%  3208 1626s
  7723  2407     cutoff   30      61713.3671 70471.3659  14.2%  3206 1638s
  7817  2413     cutoff   32      61713.3671 70471.3659  14.2%  3203 1652s
H 7836  2292                    61820.790618 70471.3659  14.0%  3200 1652s
  7909  2297 63552.5232   23  272 61820.7906 70471.3659  14.0%  3200 1666s
  8013  2286     cutoff   26      61820.7906 70471.3659  14.0%  3195 1678s
  8123  2282     cutoff   27      61820.7906 70025.2583  13.3%  3191 1691s
  8263  2265 62246.5770   29  244 61820.7906 69874.9410  13.0%  3173 1704s
  8407  2249     cutoff   32      61820.7906 69874.9410  13.0%  3160 1717s
  8541  2226 65150.3466   22  157 61820.7906 69511.0512  12.4%  3155 1725s
H 8565  2110                    61958.907544 69511.0512  12.2%  3154 1725s
  8581  2122 62292.0175   23  199 61958.9075 69511.0512  12.2%  3155 1740s
  8710  2094     cutoff   24      61958.9075 69008.9347  11.4%  3140 1757s
  8837  2080     cutoff   24      61958.9075 68920.9061  11.2%  3133 1773s
  8962  2051 67154.5170   25  222 61958.9075 68582.3763  10.7%  3138 1789s
  9151  2017 64619.7374   28  306 61958.9075 68582.3763  10.7%  3126 1805s
  9330  1964 64417.5828   30  259 61958.9075 68196.3086  10.1%  3116 1824s
  9546  1937 62939.3370   36  124 61958.9075 68196.3086  10.1%  3102 1839s
  9755  1883 64335.3590   29  326 61958.9075 68196.3086  10.1%  3090 1854s
  9827  1878 64287.2531   30  333 61958.9075 67491.2678  8.93%  3088 1869s
 10005  1839 63071.9582   34  219 61958.9075 67351.0395  8.70%  3078 1887s
 10201  1795 64674.9888   28  277 61958.9075 67345.6628  8.69%  3076 1906s
 10445  1748     cutoff   33      61958.9075 66672.3517  7.61%  3062 1926s
 10681  1691     cutoff   36      61958.9075 65855.0408  6.29%  3056 1946s
 10964  1597 62999.6138   29  158 61958.9075 65804.7987  6.21%  3040 1969s
 11218  1512     cutoff   29      61958.9075 65729.4910  6.09%  3028 1992s
 11549  1418     cutoff   25      61958.9075 65272.8524  5.35%  3004 2015s
 11912  1304     cutoff   24      61958.9075 64792.2691  4.57%  2975 2036s
 12274  1224 63341.1431   29  203 61958.9075 64657.6196  4.36%  2948 2057s
 12732  1100 62357.0891   29  306 61958.9075 64441.3759  4.01%  2908 2081s
 13177  1109     cutoff   30      61958.9075 64345.4978  3.85%  2875 2104s
 13652  1093     cutoff   30      61958.9075 64345.4978  3.85%  2840 2129s
 14229  1014 62262.8141   25  205 61958.9075 63929.5840  3.18%  2790 2155s
 14912   958 62481.9996   75  100 61958.9075 63645.9746  2.72%  2725 2179s
 16055   952     cutoff   55      61958.9075 63422.3568  2.36%  2588 2200s
H17067   952                    61962.779537 63245.8527  2.07%  2462 2200s
 17774   921 62004.8749   87   60 61962.7795 63017.5039  1.70%  2377 2213s
 20005   951     cutoff  105      61962.7795 62706.0769  1.20%  2133 2224s
H22045   951                    61985.189635 62615.2112  1.02%  1948 2224s
 22723   449 infeasible   78      61985.1896 62491.2000  0.82%  1893 2230s
H22724   449                    62003.362256 62491.2000  0.79%  1893 2230s

Cutting planes:
  MIR: 849
  Mixing: 1
  Flow cover: 1726
  RLT: 14
  Relax-and-lift: 222

Explored 26612 nodes (43676386 simplex iterations) in 2233.38 seconds (6648.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 62003.4 61962.8 61958.9 ... 61241.2

Optimal solution found (tolerance 1.00e-04)
Best objective 6.200336225629e+04, best bound 6.200336225629e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2233.43s
  Master Objective (UB) = 62003.36, θ = 209651.44
  Upper Bound (UB) = 62003.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 209651.44
  [DEBUG]   ✓ Scenario 0: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 209651.44 ≤ Q = 209651.44 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1f7ebddb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe0814225
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.497513e+13
Presolve removed 2619 rows and 1910 columns
Presolve time: 0.00s
Presolved: 474 rows, 479 columns, 1337 nonzeros
Found heuristic solution: objective 7165276.9416
Variable types: 324 continuous, 155 integer (155 binary)
Found heuristic solution: objective 7164901.0974

Root relaxation: objective -1.604409e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160440.90    0  122 7164901.10 -160440.90   102%     -    0s
H    0     0                    -119974.1544 -160440.90  33.7%     -    0s
H    0     0                    -125042.5134 -160440.90  28.3%     -    0s
     0     0 -135497.79    0   63 -125042.51 -135497.79  8.36%     -    0s
H    0     0                    -132912.1423 -135374.87  1.85%     -    0s
H    0     0                    -133212.5060 -135374.87  1.62%     -    0s
H    0     0                    -133246.1133 -135374.87  1.60%     -    0s
H    0     0                    -133546.4769 -135374.87  1.37%     -    0s
     0     0 -134432.96    0   80 -133546.48 -134432.96  0.66%     -    0s
     0     0 -134050.03    0   58 -133546.48 -134050.03  0.38%     -    0s
     0     0 -134015.80    0   70 -133546.48 -134015.80  0.35%     -    0s
     0     0 -134015.75    0   70 -133546.48 -134015.75  0.35%     -    0s
     0     0 -133923.67    0   29 -133546.48 -133923.67  0.28%     -    0s
     0     0 -133885.52    0   31 -133546.48 -133885.52  0.25%     -    0s
     0     0 -133842.89    0   43 -133546.48 -133842.89  0.22%     -    0s
     0     0 -133825.15    0   43 -133546.48 -133825.15  0.21%     -    0s
     0     1 -133825.15    0   43 -133546.48 -133825.15  0.21%     -    0s
H   33    14                    -133547.5487 -133720.69  0.13%   6.3    0s
H   34    14                    -133553.8107 -133720.69  0.12%   6.5    0s
H  150    20                    -133559.9026 -133616.77  0.04%   5.5    0s
*  208     1              17    -133562.1166 -133571.50  0.01%   4.9    0s

Cutting planes:
  Gomory: 35
  Implied bound: 2
  MIR: 138
  Flow cover: 23
  RLT: 23
  Relax-and-lift: 1
  BQP: 2

Explored 214 nodes (1588 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -133562 -133560 -133554 ... 7.16528e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.335621166154e+05, best bound -1.335662616767e+05, gap 0.0031%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 206458.84
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133562.12
  [DEBUG]   S×d_nominal = 340020.96
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340020.96 + -133562.12 = 206458.84
  [DEBUG]   Current θ from Master = 209651.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3192.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 58810.77
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = 3192.5966, Absolute Gap = 3192.5966, Relative Gap = 0.051491
  Not converged yet (gap = 3192.60 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437769 nonzeros
Model fingerprint: 0xbc5c44f9
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 72720 rows and 29520 columns
Presolve time: 1.16s
Presolved: 81563 rows, 35140 columns, 501199 nonzeros
Variable types: 32881 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.15s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.450e+06
 Factor NZ  : 7.358e+06 (roughly 100 MB of memory)
 Factor Ops : 1.239e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67663470e+07  1.56225662e+08  1.25e+05 1.71e+01  7.79e+04     2s
   1  -1.23402353e+07  1.42585628e+08  8.54e+04 1.02e+02  5.26e+04     2s
   2  -3.50024280e+06  1.09005122e+08  2.45e+04 6.45e+00  1.61e+04     2s
   3  -1.02138630e+06  7.80412791e+07  3.33e+03 1.43e+00  2.56e+03     2s
   4  -5.51206325e+05  3.71179296e+07  5.23e+02 2.35e-01  5.35e+02     2s
   5  -3.83222511e+05  2.22636873e+07  2.35e+02 1.23e-01  2.66e+02     2s
   6  -2.94812293e+05  1.55366765e+07  1.03e+02 7.55e-02  1.51e+02     2s
   7  -1.92604712e+05  1.10200185e+07  4.35e+01 5.07e-02  9.11e+01     2s
   8  -1.30725893e+05  6.53295818e+06  2.04e+01 2.80e-02  4.99e+01     2s
   9  -1.01701578e+05  4.44011909e+06  1.21e+01 1.84e-02  3.27e+01     2s
  10  -7.67966160e+04  1.74664481e+06  6.10e+00 6.50e-03  1.27e+01     2s
  11  -3.97046860e+04  4.69276028e+05  2.19e+00 1.44e-03  3.47e+00     3s
  12  -1.57673626e+04  2.94023429e+05  1.47e+00 9.49e-04  2.10e+00     3s
  13  -2.20581216e+03  2.22124450e+05  1.19e+00 1.72e-03  1.52e+00     3s
  14   1.81347369e+04  1.75798639e+05  9.29e-01 1.85e-03  1.07e+00     3s
  15   2.90627070e+04  1.58750204e+05  7.85e-01 1.70e-03  8.81e-01     3s
  16   4.01428218e+04  1.38057388e+05  6.36e-01 3.84e-03  6.66e-01     3s
  17   4.90527819e+04  1.26033282e+05  5.10e-01 2.67e-03  5.23e-01     3s
  18   5.66145010e+04  1.11407860e+05  3.99e-01 2.40e-03  3.73e-01     3s
  19   6.29420031e+04  1.03544388e+05  3.14e-01 2.69e-03  2.77e-01     3s
  20   6.71631246e+04  9.92736603e+04  2.58e-01 2.29e-03  2.19e-01     3s
  21   7.25361527e+04  9.49794175e+04  1.86e-01 1.80e-03  1.53e-01     3s
  22   7.73103420e+04  9.35174777e+04  1.28e-01 1.47e-03  1.10e-01     3s
  23   7.93253915e+04  9.21134429e+04  1.03e-01 1.37e-03  8.72e-02     3s
  24   8.01384704e+04  9.08563337e+04  9.35e-02 1.26e-03  7.32e-02     3s
  25   8.16460167e+04  9.03772309e+04  7.56e-02 1.22e-03  5.96e-02     3s
  26   8.26256278e+04  8.98761409e+04  6.41e-02 9.96e-04  4.95e-02     3s
  27   8.27577012e+04  8.95864731e+04  6.26e-02 7.26e-04  4.67e-02     3s
  28   8.37140422e+04  8.94276735e+04  5.20e-02 5.67e-04  3.91e-02     3s
  29   8.40264121e+04  8.93277993e+04  4.83e-02 6.12e-04  3.62e-02     3s
  30   8.53305845e+04  8.90146887e+04  3.42e-02 6.17e-04  2.52e-02     3s
  31   8.59416025e+04  8.88290755e+04  2.71e-02 6.38e-04  1.98e-02     3s
  32   8.67861577e+04  8.86225601e+04  1.73e-02 6.70e-04  1.26e-02     3s
  33   8.69935224e+04  8.85731374e+04  1.50e-02 5.19e-04  1.08e-02     3s
  34   8.70649391e+04  8.85645858e+04  1.42e-02 4.73e-04  1.03e-02     3s
  35   8.72859641e+04  8.85303515e+04  1.18e-02 4.69e-04  8.52e-03     3s
  36   8.74712645e+04  8.84883426e+04  9.64e-03 4.36e-04  6.96e-03     3s
  37   8.75736785e+04  8.84332926e+04  8.51e-03 2.52e-04  5.89e-03     3s
  38   8.77181462e+04  8.84293177e+04  6.91e-03 2.40e-04  4.87e-03     4s
  39   8.80161958e+04  8.83876883e+04  3.59e-03 1.88e-04  2.54e-03     4s
  40   8.82443519e+04  8.83641591e+04  1.11e-03 8.93e-05  8.19e-04     4s
  41   8.83126833e+04  8.83581376e+04  4.09e-04 3.98e-05  3.11e-04     4s
  42   8.83268710e+04  8.83561862e+04  2.68e-04 5.01e-05  2.00e-04     4s
  43   8.83393465e+04  8.83554259e+04  1.45e-04 2.05e-05  1.10e-04     4s
  44   8.83541923e+04  8.83549300e+04  6.20e-06 1.71e-09  5.04e-06     4s
  45   8.83548466e+04  8.83548829e+04  1.38e-07 2.56e-08  2.45e-07     4s
  46   8.83548748e+04  8.83548748e+04  3.46e-09 4.76e-11  8.84e-11     4s

Barrier solved model in 46 iterations and 3.80 seconds (6.49 work units)
Optimal objective 8.83548748e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

     773 PPushes remaining with PInf 1.4210896e-07                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.0976775e-10      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34653    8.8354875e+04   0.000000e+00   0.000000e+00      5s
   34653    8.8354875e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.835487e+04, 34653 iterations, 3.83 seconds (7.38 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88354.8748    0   74 -168399.12 88354.8748   152%     -    5s
H    0     0                    -151472.2152 88354.8748   158%     -    5s
H    0     0                    -149499.5688 88354.8748   159%     -    5s
H    0     0                    -148657.2154 88354.8748   159%     -    5s
H    0     0                    -140297.1365 88354.8748   163%     -    5s
H    0     0                    -139994.8994 88354.8748   163%     -    6s
H    0     0                    -139824.7090 88354.8748   163%     -    6s
H    0     0                    -36830.32112 88354.8748   340%     -    6s
H    0     0                    23680.369001 88354.8748   273%     -    6s
H    0     0                    40294.751382 88354.8748   119%     -    6s
H    0     0                    42368.588302 88354.8748   109%     -    6s
H    0     0                    51166.930296 88354.8748  72.7%     -    6s
H    0     0                    51562.369820 88354.8748  71.4%     -    6s
H    0     0                    51955.476094 88354.8748  70.1%     -    6s
H    0     0                    52102.912494 88354.8748  69.6%     -    6s
H    0     0                    52105.156847 88346.0718  69.6%     -    7s
H    0     0                    52348.352490 82074.9891  56.8%     -   27s
     0     0 82074.9891    0  245 52348.3525 82074.9891  56.8%     -   27s
     0     0 81569.2800    0  225 52348.3525 81569.2800  55.8%     -   33s
     0     0 81519.6691    0  233 52348.3525 81519.6691  55.7%     -   38s
     0     0 81519.6691    0  238 52348.3525 81519.6691  55.7%     -   40s
     0     0 81519.6691    0  245 52348.3525 81519.6691  55.7%     -   41s
     0     0 81519.6691    0  242 52348.3525 81519.6691  55.7%     -   42s
     0     0 81519.6691    0  247 52348.3525 81519.6691  55.7%     -   42s
     0     0 81519.5975    0  247 52348.3525 81519.5975  55.7%     -   42s
     0     0 79000.9163    0  306 52348.3525 79000.9163  50.9%     -   62s
     0     0 78413.8625    0  269 52348.3525 78413.8625  49.8%     -   72s
     0     0 78277.7684    0  271 52348.3525 78277.7684  49.5%     -   79s
     0     0 78220.0079    0  267 52348.3525 78220.0079  49.4%     -   82s
     0     0 78207.9601    0  269 52348.3525 78207.9601  49.4%     -   83s
     0     0 78181.8943    0  269 52348.3525 78181.8943  49.3%     -   84s
     0     0 78172.5015    0  271 52348.3525 78172.5015  49.3%     -   85s
     0     0 78172.3825    0  271 52348.3525 78172.3825  49.3%     -   85s
H    0     0                    52626.337222 76788.8561  45.9%     -  109s
H    0     0                    52647.707217 76788.8561  45.9%     -  109s
H    0     0                    53036.398364 76788.8561  44.8%     -  109s
     0     0 76788.8561    0  248 53036.3984 76788.8561  44.8%     -  109s
     0     0 76358.6630    0  261 53036.3984 76358.6630  44.0%     -  121s
     0     0 76272.7625    0  257 53036.3984 76272.7625  43.8%     -  125s
     0     0 76252.3164    0  262 53036.3984 76252.3164  43.8%     -  127s
H    0     0                    53125.135294 76183.0506  43.4%     -  131s
H    0     0                    53273.209672 76183.0506  43.0%     -  131s
H    0     0                    53352.311406 76183.0506  42.8%     -  131s
     0     0 76183.0506    0  267 53352.3114 76183.0506  42.8%     -  131s
     0     0 76088.0021    0  264 53352.3114 76088.0021  42.6%     -  136s
     0     0 76032.2261    0  262 53352.3114 76032.2261  42.5%     -  141s
H    0     0                    58521.740666 75991.7033  29.9%     -  145s
H    0     0                    58535.458881 75991.7033  29.8%     -  145s
H    0     0                    58599.478341 75991.7033  29.7%     -  145s
H    0     0                    58649.613444 75991.7033  29.6%     -  145s
H    0     0                    58707.785014 75991.7033  29.4%     -  145s
     0     0 75991.7033    0  267 58707.7850 75991.7033  29.4%     -  145s
     0     0 75973.8788    0  273 58707.7850 75973.8788  29.4%     -  148s
     0     0 75955.0994    0  271 58707.7850 75955.0994  29.4%     -  151s
     0     0 75945.1009    0  270 58707.7850 75945.1009  29.4%     -  152s
     0     0 75882.2808    0  269 58707.7850 75882.2808  29.3%     -  155s
     0     0 75853.2579    0  274 58707.7850 75853.2579  29.2%     -  158s
     0     0 75837.3610    0  271 58707.7850 75837.3610  29.2%     -  160s
     0     0 75813.4160    0  266 58707.7850 75813.4160  29.1%     -  161s
     0     0 75799.9782    0  276 58707.7850 75799.9782  29.1%     -  162s
     0     0 75796.8915    0  276 58707.7850 75796.8915  29.1%     -  163s
     0     0 75795.0230    0  278 58707.7850 75795.0230  29.1%     -  163s
     0     0 75791.6477    0  278 58707.7850 75791.6477  29.1%     -  164s
     0     0 75778.0412    0  271 58707.7850 75778.0412  29.1%     -  165s
     0     0 75777.6261    0  270 58707.7850 75777.6261  29.1%     -  165s
     0     0 74840.8636    0  308 58707.7850 74840.8636  27.5%     -  185s
     0     0 74667.5762    0  356 58707.7850 74667.5762  27.2%     -  191s
     0     0 74582.4913    0  350 58707.7850 74582.4913  27.0%     -  194s
     0     0 74568.8029    0  356 58707.7850 74568.8029  27.0%     -  196s
     0     0 74562.3575    0  356 58707.7850 74562.3575  27.0%     -  197s
     0     0 74558.6726    0  327 58707.7850 74558.6726  27.0%     -  198s
     0     0 74553.9896    0  327 58707.7850 74553.9896  27.0%     -  198s
     0     0 74553.6539    0  329 58707.7850 74553.6539  27.0%     -  199s
     0     0 74423.7564    0  435 58707.7850 74423.7564  26.8%     -  205s
     0     0 74401.6179    0  440 58707.7850 74401.6179  26.7%     -  208s
     0     0 74388.1911    0  446 58707.7850 74388.1911  26.7%     -  210s
     0     0 74381.5807    0  445 58707.7850 74381.5807  26.7%     -  211s
     0     0 74378.4318    0  438 58707.7850 74378.4318  26.7%     -  212s
     0     0 74377.3587    0  447 58707.7850 74377.3587  26.7%     -  213s
     0     0 74299.1445    0  365 58707.7850 74299.1445  26.6%     -  220s
     0     0 74285.0628    0  384 58707.7850 74285.0628  26.5%     -  221s
     0     0 74282.0446    0  387 58707.7850 74282.0446  26.5%     -  222s
     0     0 74275.5378    0  344 58707.7850 74275.5378  26.5%     -  223s
     0     0 74273.4533    0  340 58707.7850 74273.4533  26.5%     -  224s
     0     0 74271.3311    0  341 58707.7850 74271.3311  26.5%     -  225s
     0     0 74269.3123    0  344 58707.7850 74269.3123  26.5%     -  226s
     0     0 74269.1027    0  345 58707.7850 74269.1027  26.5%     -  226s
     0     0 74243.1270    0  393 58707.7850 74243.1270  26.5%     -  231s
     0     0 74233.1219    0  353 58707.7850 74233.1219  26.4%     -  232s
     0     0 74225.7417    0  386 58707.7850 74225.7417  26.4%     -  234s
     0     0 74222.2721    0  393 58707.7850 74222.2721  26.4%     -  235s
     0     0 74221.8650    0  352 58707.7850 74221.8650  26.4%     -  235s
     0     0 74206.0555    0  390 58707.7850 74206.0555  26.4%     -  239s
     0     0 74200.3791    0  396 58707.7850 74200.3791  26.4%     -  241s
     0     0 74196.7241    0  445 58707.7850 74196.7241  26.4%     -  243s
     0     0 74194.3678    0  448 58707.7850 74194.3678  26.4%     -  244s
     0     0 74193.7090    0  451 58707.7850 74193.7090  26.4%     -  245s
     0     0 74184.1673    0  399 58707.7850 74184.1673  26.4%     -  247s
     0     0 74181.7158    0  397 58707.7850 74181.7158  26.4%     -  248s
     0     0 74181.2902    0  395 58707.7850 74181.2902  26.4%     -  248s
     0     0 74179.6664    0  360 58707.7850 74179.6664  26.4%     -  250s
     0     0 74179.0244    0  366 58707.7850 74179.0244  26.4%     -  250s
     0     0 74178.1549    0  410 58707.7850 74178.1549  26.4%     -  252s
     0     0 74177.1937    0  415 58707.7850 74177.1937  26.3%     -  253s
     0     0 74165.2380    0  358 58707.7850 74165.2380  26.3%     -  255s
     0     0 74156.4248    0  409 58707.7850 74156.4248  26.3%     -  257s
     0     0 74151.9470    0  399 58707.7850 74151.9470  26.3%     -  258s
     0     0 74151.0989    0  411 58707.7850 74151.0989  26.3%     -  259s
     0     0 74146.9518    0  404 58707.7850 74146.9518  26.3%     -  260s
     0     0 74144.8655    0  412 58707.7850 74144.8655  26.3%     -  261s
     0     0 74144.2755    0  410 58707.7850 74144.2755  26.3%     -  262s
     0     0 74143.3290    0  364 58707.7850 74143.3290  26.3%     -  263s
     0     0 74141.3931    0  373 58707.7850 74141.3931  26.3%     -  264s
     0     0 74134.7992    0  410 58707.7850 74134.7992  26.3%     -  266s
     0     0 74133.1512    0  450 58707.7850 74133.1512  26.3%     -  268s
     0     0 74131.1367    0  368 58707.7850 74131.1367  26.3%     -  269s
     0     0 74131.1298    0  368 58707.7850 74131.1298  26.3%     -  270s
H    0     0                    59133.518899 74131.0998  25.4%     -  302s
H    0     0                    59192.795939 74131.0998  25.2%     -  303s
H    0     0                    59332.579736 74131.0998  24.9%     -  303s
H    0     0                    59402.194491 74131.0998  24.8%     -  303s
     0     2 74131.0998    0  368 59402.1945 74131.0998  24.8%     -  304s
     1     3 72705.7996    1  269 59402.1945 74131.0544  24.8% 10946  314s
     2     4 73901.9532    1  327 59402.1945 73901.9532  24.4%  6626  322s
     3     7 71890.2097    2  329 59402.1945 73901.9426  24.4%  6564  332s
     6    14 73378.4049    3  386 59402.1945 73898.2810  24.4%  6126  341s
    13    28 72819.0351    4  327 59402.1945 73553.9139  23.8%  7442  353s
    27    42 72271.3669    5  356 59402.1945 72984.3590  22.9% 11174  381s
    41    74 71229.2135    6  342 59402.1945 72984.3590  22.9% 10527  419s
    73   166 71209.4834    7  327 59402.1945 72879.4155  22.7% 10953  447s
   165   260 71101.8405    8  315 59402.1945 72879.3598  22.7%  7350  463s
   259   328 70736.4843   10  373 59402.1945 72879.3598  22.7%  5866  475s
   327   359 70692.3540   10  340 59402.1945 72879.3598  22.7%  5373  485s
   358   400 70861.3431    9  363 59402.1945 72879.3598  22.7%  5245  499s
   399   437 70819.6437    9  312 59402.1945 72879.3598  22.7%  4994  509s
   438   492 70750.0756   10  321 59402.1945 72879.3598  22.7%  4844  521s
H  471   492                    59417.774810 72879.3598  22.7%  4845  521s
H  474   492                    59799.119139 72879.3598  21.9%  4831  521s
   493   561 70632.6547   10  314 59799.1191 72879.3598  21.9%  4761  531s
   566   632 70539.3560   11  315 59799.1191 72879.3598  21.9%  4772  542s
H  581   632                    59890.984397 72879.3598  21.7%  4713  542s
H  585   632                    59899.797269 72879.3598  21.7%  4704  542s
   641   698 70635.1204   11  349 59899.7973 72879.3598  21.7%  4723  553s
   711   747 70193.0905   11  381 59899.7973 72879.3598  21.7%  4733  563s
   766   805 70027.8098   11  248 59899.7973 72879.3598  21.7%  4774  575s
   838   868 70400.0470   11  273 59899.7973 72879.3598  21.7%  4747  588s
   915   944 70433.1608   12  270 59899.7973 72879.3598  21.7%  4694  598s
  1001  1027 69006.2134   12  250 59899.7973 72879.3598  21.7%  4585  610s
  1097  1111 70079.8890   12  365 59899.7973 72879.3598  21.7%  4547  622s
  1203  1218 69537.1046   13  227 59899.7973 72879.3598  21.7%  4453  632s
  1318  1297 68874.1527   14  231 59899.7973 72710.7101  21.4%  4348  642s
  1415  1393 68398.7523   13  193 59899.7973 72710.7101  21.4%  4365  654s
  1541  1469 68122.7035   13  295 59899.7973 72710.7101  21.4%  4260  666s
  1659  1488 68728.2478   15  222 59899.7973 72690.5955  21.4%  4202  680s
  1720  1554 68657.8450   15  220 59899.7973 72517.1440  21.1%  4248  694s
  1808  1585 68639.1030   16  268 59899.7973 72517.1440  21.1%  4283  705s
  1861  1623 68323.1935   17  272 59899.7973 72501.7564  21.0%  4319  718s
  1925  1667 68332.7020   17  209 59899.7973 72490.2074  21.0%  4379  732s
  1981  1710 68133.8568   18  219 59899.7973 72490.2074  21.0%  4477  745s
  2052  1762 68072.3933   19  218 59899.7973 72490.2074  21.0%  4540  759s
  2126  1823 67451.8758   20  187 59899.7973 72490.2074  21.0%  4598  775s
  2215  1874 66737.3004   21  171 59899.7973 72490.2074  21.0%  4662  791s
  2298  1946 64451.6951   21  166 59899.7973 72184.8711  20.5%  4710  809s
  2388  2005 64030.3834   19  185 59899.7973 72184.8711  20.5%  4804  826s
  2471  2082 65156.8835   22  177 59899.7973 72164.1871  20.5%  4911  845s
  2569  2145 63660.0882   22  157 59899.7973 72164.1871  20.5%  4976  864s
  2664  2192 64165.0603   23  177 59899.7973 72164.1871  20.5%  5053  884s
  2787  2244 63524.9298   25  201 59899.7973 72164.1871  20.5%  5095  904s
  2910  2277 60836.7803   27  168 59899.7973 72164.1871  20.5%  5159  928s
  3009  2341 60586.6059   28  157 59899.7973 72164.1871  20.5%  5262  950s
  3125  2412     cutoff   52      59899.7973 71711.6004  19.7%  5366  972s
  3262  2488 68809.0663   10  262 59899.7973 71706.1682  19.7%  5445  997s
  3388  2541 65580.7493   13  218 59899.7973 71706.1682  19.7%  5542 1023s
  3499  2614 62129.1436   16  195 59899.7973 71682.6868  19.7%  5639 1050s
  3622  2695     cutoff   21      59899.7973 71549.3890  19.4%  5735 1078s
  3775  2809 63410.6825   53  151 59899.7973 71549.3890  19.4%  5787 1106s
  3962  2974 62242.3469   75  171 59899.7973 71508.2157  19.4%  5809 1137s
  4230  2975 67859.5114   19  368 59899.7973 71508.2157  19.4%  5728 1232s
  4232  2976 68017.7179   14   74 59899.7973 71508.2157  19.4%  5726 1238s
  4233  2977 63583.3484   25  298 59899.7973 71508.2157  19.4%  5724 1276s
  4234  2978 61872.8079   16  314 59899.7973 71508.2157  19.4%  5723 1296s
  4235  2978 60729.4850   20  393 59899.7973 71508.2157  19.4%  5722 1312s
  4236  2979 60346.4165   35  365 59899.7973 71508.2157  19.4%  5720 1322s
  4237  2980 69603.2318   12  324 59899.7973 71508.2157  19.4%  5719 1328s
  4238  2980 67971.8649   34  372 59899.7973 71508.2157  19.4%  5718 1334s
  4239  2981 62241.4197   93  339 59899.7973 71508.2157  19.4%  5716 1339s
  4240  2982 63347.5209   25  427 59899.7973 71508.2157  19.4%  5715 1344s
  4241  2982 67831.0468   19  386 59899.7973 71508.2157  19.4%  5713 1351s
  4242  2983 61412.8425   23  390 59899.7973 71508.2157  19.4%  5712 1357s
  4243  2984 63473.7813   31  429 59899.7973 71508.2157  19.4%  5711 1361s
  4245  2985 61427.9854   60  402 59899.7973 71508.2157  19.4%  5708 1366s
  4246  2986 67563.4051   17  404 59899.7973 71508.2157  19.4%  5707 1374s
  4247  2986 70007.7125   14  380 59899.7973 71508.2157  19.4%  5705 1378s
  4248  2987 71277.4166   12  372 59899.7973 71508.2157  19.4%  5704 1382s
  4250  2988 64393.6867   15  376 59899.7973 71508.2157  19.4%  5701 1386s
  4252  2990 61387.9529   29  493 59899.7973 71508.2157  19.4%  5699 1396s
  4253  2990 69116.3000   16  391 59899.7973 71508.2157  19.4%  5697 1400s
  4254  2991 69385.1561    9  395 59899.7973 71508.2157  19.4%  5696 1408s
  4255  2992 69162.8048    9  323 59899.7973 71508.2157  19.4%  5695 1411s
  4256  2992 60139.4544   24  320 59899.7973 71508.2157  19.4%  5693 1415s
  4258  2994 60373.8480   37  320 59899.7973 71508.2157  19.4%  5691 1423s
  4259  2994 66941.6455   46  320 59899.7973 71508.2157  19.4%  5689 1426s
  4260  2995 61853.4178   78  447 59899.7973 71508.2157  19.4%  5688 1431s
  4262  2996 68142.1106   13  314 59899.7973 71508.2157  19.4%  5685 1439s
  4263  2997 61278.7417   69  314 59899.7973 71508.2157  19.4%  5684 1441s
  4264  2998 62296.3136   22  486 59899.7973 71508.2157  19.4%  5683 1446s
  4266  2999 66846.7242   13  493 59899.7973 71508.2157  19.4%  5680 1455s
  4267  3000 70157.6238   14  493 59899.7973 71508.2157  19.4%  5679 1465s
  4268  3000 68124.8674   18  493 59899.7973 71508.2157  19.4%  5677 1496s
  4269  3003 71508.2157   16  430 59899.7973 71508.2157  19.4%  5734 1529s
  4270  3005 71508.2157   17  367 59899.7973 71508.2157  19.4%  5735 1541s
  4272  3009 71508.2157   17  285 59899.7973 71508.2157  19.4%  5735 1565s
  4277  3017 71508.2157   18  345 59899.7973 71508.2157  19.4%  5738 1597s
  4287  3034 71508.2157   19  309 59899.7973 71508.2157  19.4%  5756 1623s
  4307  3039 71508.2157   20  285 59899.7973 71508.2157  19.4%  5780 1662s
  4319  3065 69967.6933   21  278 59899.7973 71508.2157  19.4%  5821 1698s
  4349  3158 68971.0442   22  292 59899.7973 71508.2157  19.4%  5863 1728s
  4454  3159 67275.3100   24  213 59899.7973 71508.2157  19.4%  5887 1743s
H 4463  3005                    60051.370468 71508.2157  19.1%  5881 1743s
H 4471  2860                    60221.835049 71508.2157  18.7%  5880 1743s
  4490  2898 66536.8777   25  253 60221.8350 71508.2157  18.7%  5880 1764s
H 4540  2785                    60278.509320 71508.2157  18.6%  5883 1784s
H 4560  2649                    60284.797939 71508.2157  18.6%  5877 1784s
H 4596  2534                    60341.472209 71508.2157  18.5%  5900 1803s
  4649  2545 61421.7873   32  217 60341.4722 71508.2157  18.5%  5932 1821s
  4715  2549 60544.0790   35  116 60341.4722 71508.2157  18.5%  5947 1839s
  4779  2554 62503.5856   28  272 60341.4722 71508.2157  18.5%  5962 1853s
  4858  2538 62945.0014   52  160 60341.4722 71508.2157  18.5%  5970 1869s
  4927  2534     cutoff   29      60341.4722 71508.2157  18.5%  5972 1884s
  4994  2513 61381.4239   34  121 60341.4722 71508.2157  18.5%  5979 1899s
  5032  2514 61342.9419   35  138 60341.4722 71508.2157  18.5%  5992 1917s
H 5055  2389                    60350.057874 71508.2157  18.5%  5999 1917s
  5078  2412 61278.8418   36   97 60350.0579 71508.2157  18.5%  6001 1931s
  5154  2413 61100.9923   40  191 60350.0579 71508.2157  18.5%  6010 1953s
  5223  2420 64721.9643   27  235 60350.0579 71508.2157  18.5%  5996 1969s
  5288  2415 64648.3308   28  199 60350.0579 71508.2157  18.5%  6013 1982s
  5324  2424 64293.0163   29  174 60350.0579 71508.2157  18.5%  6025 1995s
  5380  2434 64146.2466   30  160 60350.0579 71508.2157  18.5%  6020 2010s
  5436  2427 64024.2509   31  162 60350.0579 71508.2157  18.5%  6017 2026s
  5499  2423 63766.0946   32  142 60350.0579 71508.2157  18.5%  6021 2040s
  5566  2440 63053.2724   33  169 60350.0579 71508.2157  18.5%  6022 2058s
  5637  2438 60821.6215   35  144 60350.0579 71508.2157  18.5%  6027 2076s
  5735  2443 67887.8183   23  271 60350.0579 71508.2157  18.5%  6028 2097s
  5853  2429 64346.0398   24  251 60350.0579 71508.2157  18.5%  6031 2122s
  5951  2439 infeasible   24      60350.0579 71508.2157  18.5%  6056 2141s
  6051  2437 64806.9105   25  240 60350.0579 71508.2157  18.5%  6093 2162s
  6171  2457 63103.6406   28  204 60350.0579 71508.2157  18.5%  6103 2183s
  6334  2460 63052.3483   29  142 60350.0579 70346.6851  16.6%  6064 2206s
  6516  2443     cutoff   31      60350.0579 70346.6851  16.6%  6013 2232s
  6689  2460 61730.9598   34  142 60350.0579 70346.6851  16.6%  5990 2255s
  6854  2469     cutoff   37      60350.0579 70346.6851  16.6%  5970 2280s
  7016  2470     cutoff   24      60350.0579 69922.7726  15.9%  5957 2305s
  7173  2498 63105.4229   24  213 60350.0579 69922.7726  15.9%  5975 2330s
  7375  2497 60524.1507   32  143 60350.0579 69729.5828  15.5%  5956 2360s
  7566  2485 infeasible   27      60350.0579 69459.4198  15.1%  5942 2389s
  7755  2501 61995.6975   31  196 60350.0579 69459.4198  15.1%  5957 2421s
  7971  2489 64761.5082   24  128 60350.0579 69459.4198  15.1%  5947 2461s
  8188  2489     cutoff   30      60350.0579 69245.8251  14.7%  5941 2491s
  8392  2510 infeasible   37      60350.0579 69058.6246  14.4%  5917 2521s
  8628  2491 infeasible   28      60350.0579 69058.6246  14.4%  5910 2554s
  8881  2465     cutoff   28      60350.0579 68441.6438  13.4%  5917 2588s
  9143  2459 62535.8509   25  217 60350.0579 68340.5411  13.2%  5927 2620s
  9375  2449     cutoff   28      60350.0579 68180.1133  13.0%  5950 2652s
  9641  2513 61761.9504   25  228 60350.0579 68000.1582  12.7%  5944 2693s
 10001  2512 60778.4864   27  212 60350.0579 67841.3426  12.4%  5907 2731s
*10292  2292              96    60475.260109 67827.0841  12.2%  5873 2731s
 10392  2362 62539.0679   26  223 60475.2601 67766.6057  12.1%  5858 2768s
 10732  2390 infeasible   29      60475.2601 67629.8297  11.8%  5847 2807s
H10768  2263                    60840.944513 67629.8297  11.2%  5847 2807s
 11109  2292 infeasible   28      60840.9445 67237.9362  10.5%  5837 2848s
 11412  2320 61429.3632   31  155 60840.9445 66974.7692  10.1%  5867 2890s
 11753  2350 61670.8769   31  117 60840.9445 66974.7692  10.1%  5890 2934s
H11978  2116                    61183.875456 66699.9515  9.02%  5911 2934s
H12076  2056                    61252.696427 66424.9338  8.44%  5926 2980s
H12273  2010                    61304.641438 66415.7444  8.34%  5929 2980s
H12289  1983                    61339.558025 66273.5764  8.04%  5927 2980s
 12463  1985     cutoff   40      61339.5580 66127.2489  7.81%  5944 3028s
 12835  1984     cutoff   29      61339.5580 65929.3000  7.48%  5962 3073s
H12984  1976                    61358.460648 65824.2644  7.28%  5966 3073s
 13041  1959 infeasible   33      61358.4606 65824.2644  7.28%  5969 3130s
 13485  2038 infeasible   30      61358.4606 65419.3553  6.62%  5976 3181s
H13490  2027                    61377.021369 65419.3553  6.59%  5976 3181s
H13557  2011                    61392.186831 65343.6295  6.44%  5976 3181s
 14061  1998 62362.5600   30  100 61392.1868 65076.5920  6.00%  5930 3233s
 14585  1980     cutoff   34      61392.1868 64568.3254  5.17%  5923 3289s
H14874  1978                    61397.176483 64532.5804  5.11%  5921 3289s
 15196  2013 62302.6183   33  141 61397.1765 64275.9490  4.69%  5895 3343s
H15208  2009                    61402.147643 64275.9490  4.68%  5895 3343s
 15884  1988 infeasible   33      61402.1476 64084.9546  4.37%  5846 3402s
 16568  1886 infeasible   48      61402.1476 63803.5495  3.91%  5805 3461s
 17349  1772     cutoff   34      61402.1476 63465.9959  3.36%  5759 3518s
 18224  1652 infeasible   29      61402.1476 63200.6609  2.93%  5682 3577s
 19401  1998 infeasible   25      61402.1476 62776.3735  2.24%  5533 3600s
H19763  1998                    61716.952320 62735.5941  1.65%  5449 3600s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  Projected implied bound: 26
  MIR: 819
  Mixing: 1
  Flow cover: 2011
  Inf proof: 3
  RLT: 11
  Relax-and-lift: 219

Explored 20641 nodes (109150679 simplex iterations) in 3600.09 seconds (11319.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 61717 61402.1 61392.2 ... 60840.9

Time limit reached
Best objective 6.171695232041e+04, best bound 6.264098250633e+04, gap 1.4972%
  WARNING: Time limit reached. Using best solution found (gap: 1.50%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 61716.95, θ = 209899.66
  Upper Bound (UB) = 61716.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 209899.66
  [DEBUG]   ✓ Scenario 0: θ = 209899.66 ≤ Q = 209899.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 209899.66 ≤ Q = 209899.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 209899.66 ≤ Q = 209899.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 209899.66 ≤ Q = 209899.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 209899.66 ≤ Q = 209899.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 209899.66 ≤ Q = 209899.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 209899.66 ≤ Q = 209899.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 209899.66 ≤ Q = 209899.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 209899.66 ≤ Q = 209899.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 209899.66 ≤ Q = 209899.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6b6e66c3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6b6e66c3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.497513e+13
Presolve removed 2613 rows and 1905 columns
Presolve time: 0.00s
Presolved: 480 rows, 484 columns, 1353 nonzeros
Found heuristic solution: objective 7273745.2297
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.598157e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159815.73    0  122 7273745.23 -159815.73   102%     -    0s
H    0     0                    -127604.4769 -159815.73  25.2%     -    0s
H    0     0                    -128595.0071 -159815.73  24.3%     -    0s
     0     0 -135139.04    0   95 -128595.01 -135139.04  5.09%     -    0s
H    0     0                    -132987.8830 -135136.26  1.62%     -    0s
     0     0 -133885.76    0   92 -132987.88 -133885.76  0.68%     -    0s
     0     0 -133767.67    0   62 -132987.88 -133767.67  0.59%     -    0s
     0     0 -133669.20    0   78 -132987.88 -133669.20  0.51%     -    0s
     0     0 -133348.30    0   46 -132987.88 -133348.30  0.27%     -    0s
     0     0 -133311.98    0   46 -132987.88 -133311.98  0.24%     -    0s
     0     0 -133311.35    0   46 -132987.88 -133311.35  0.24%     -    0s
     0     0 -133272.54    0   44 -132987.88 -133272.54  0.21%     -    0s
     0     0 -133271.54    0   44 -132987.88 -133271.54  0.21%     -    0s
H    0     0                    -133035.5962 -133271.54  0.18%     -    0s
     0     0 -133271.54    0   77 -133035.60 -133271.54  0.18%     -    0s
     0     0 -133271.54    0   66 -133035.60 -133271.54  0.18%     -    0s
     0     0 -133271.54    0   38 -133035.60 -133271.54  0.18%     -    0s
     0     0 -133249.58    0   58 -133035.60 -133249.58  0.16%     -    0s
     0     0 -133249.47    0   56 -133035.60 -133249.47  0.16%     -    0s
     0     0 -133188.12    0   41 -133035.60 -133188.12  0.11%     -    0s
     0     0 -133175.08    0   33 -133035.60 -133175.08  0.10%     -    0s
     0     0 -133165.18    0   33 -133035.60 -133165.18  0.10%     -    0s
     0     0 -133165.18    0   33 -133035.60 -133165.18  0.10%     -    0s
     0     0 -133165.18    0   62 -133035.60 -133165.18  0.10%     -    0s
     0     0 -133165.18    0   34 -133035.60 -133165.18  0.10%     -    0s
     0     0 -133165.18    0   18 -133035.60 -133165.18  0.10%     -    0s
     0     0 -133165.18    0   30 -133035.60 -133165.18  0.10%     -    0s
     0     0 -133165.18    0   32 -133035.60 -133165.18  0.10%     -    0s
     0     0 -133163.64    0   31 -133035.60 -133163.64  0.10%     -    0s
     0     0 -133160.01    0   31 -133035.60 -133160.01  0.09%     -    0s
     0     0 -133156.61    0   31 -133035.60 -133156.61  0.09%     -    0s
     0     0 -133156.61    0   44 -133035.60 -133156.61  0.09%     -    0s
     0     0 -133156.61    0   34 -133035.60 -133156.61  0.09%     -    0s
     0     0 -133156.61    0   17 -133035.60 -133156.61  0.09%     -    0s
     0     0 -133156.61    0   32 -133035.60 -133156.61  0.09%     -    0s
     0     0 -133156.61    0   31 -133035.60 -133156.61  0.09%     -    0s
H    0     0                    -133056.3827 -133156.61  0.08%     -    0s
     0     0 -133156.61    0   31 -133056.38 -133156.61  0.08%     -    0s
     0     0 -133155.68    0   30 -133056.38 -133155.68  0.07%     -    0s
     0     0 -133153.45    0   30 -133056.38 -133153.45  0.07%     -    0s
H    0     0                    -133090.5676 -133153.44  0.05%     -    0s
     0     0 -133153.44    0   37 -133090.57 -133153.44  0.05%     -    0s
     0     0 -133153.44    0   33 -133090.57 -133153.44  0.05%     -    0s
     0     0 -133153.44    0   31 -133090.57 -133153.44  0.05%     -    0s
     0     0 -133153.44    0   31 -133090.57 -133153.44  0.05%     -    0s
H    0     0                    -133109.9389 -133153.44  0.03%     -    0s
     0     0 -133153.44    0   30 -133109.94 -133153.44  0.03%     -    0s
     0     0 -133153.44    0   30 -133109.94 -133153.44  0.03%     -    0s
     0     0 -133152.65    0   30 -133109.94 -133152.65  0.03%     -    0s
     0     2 -133152.65    0   30 -133109.94 -133152.65  0.03%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 2
  MIR: 43
  Flow cover: 12

Explored 7 nodes (1895 simplex iterations) in 0.16 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -133110 -133091 -133056 ... 1.49751e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.331099389456e+05, best bound -1.331213369807e+05, gap 0.0086%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 206915.94
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133109.94
  [DEBUG]   S×d_nominal = 340025.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340025.88 + -133109.94 = 206915.94
  [DEBUG]   Current θ from Master = 209899.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2983.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 58733.23
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = 2906.1867, Absolute Gap = 2906.1867, Relative Gap = 0.047089
  Not converged yet (gap = 2906.19 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480994 nonzeros
Model fingerprint: 0x72effb14
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 79992 rows and 32472 columns
Presolve time: 1.30s
Presolved: 89581 rows, 38428 columns, 546675 nonzeros
Variable types: 36169 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -308931.0062
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 3.180e+06
 Factor NZ  : 7.188e+06 (roughly 100 MB of memory)
 Factor Ops : 1.275e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.74974632e+07  1.69467546e+08  1.31e+05 1.57e+01  8.07e+04     2s
   1  -1.30720748e+07  1.55851713e+08  9.02e+04 1.04e+02  5.51e+04     2s
   2  -4.33449931e+06  1.19958058e+08  3.05e+04 1.32e+01  1.97e+04     2s
   3  -1.25838977e+06  8.82516877e+07  5.17e+03 1.33e+00  3.69e+03     2s
   4  -5.72447218e+05  5.90075250e+07  6.35e+02 5.04e-01  7.24e+02     2s
   5  -4.10251467e+05  2.88419658e+07  2.31e+02 1.84e-01  2.92e+02     3s
   6  -3.10920756e+05  1.97372519e+07  1.03e+02 1.16e-01  1.67e+02     3s
   7  -2.05958897e+05  1.40152378e+07  2.83e+01 7.91e-02  9.71e+01     3s
   8  -1.62923299e+05  1.04494071e+07  1.56e+01 5.75e-02  6.93e+01     3s
   9  -1.13727512e+05  6.12134887e+06  8.12e+00 3.20e-02  3.96e+01     3s
  10  -7.36854525e+04  2.08546789e+06  4.26e+00 9.89e-03  1.35e+01     3s
  11  -1.32480414e+04  4.47699407e+05  9.78e-01 1.71e-03  2.83e+00     3s
  12   1.29423422e+04  2.85438918e+05  6.10e-01 1.28e-03  1.67e+00     3s
  13   2.54978237e+04  2.21255848e+05  4.61e-01 1.08e-03  1.20e+00     3s
  14   3.30665905e+04  1.90653303e+05  3.83e-01 1.60e-03  9.64e-01     3s
  15   4.07060614e+04  1.60000047e+05  3.12e-01 1.87e-03  7.29e-01     3s
  16   4.74602345e+04  1.40379930e+05  2.58e-01 1.50e-03  5.68e-01     3s
  17   5.23505539e+04  1.36152588e+05  2.30e-01 1.69e-03  5.12e-01     3s
  18   5.58749111e+04  1.18091375e+05  2.06e-01 1.24e-03  3.81e-01     3s
  19   6.29497095e+04  1.07148989e+05  1.57e-01 1.79e-03  2.70e-01     3s
  20   6.84749161e+04  1.05544522e+05  1.20e-01 1.73e-03  2.27e-01     3s
  21   7.17020051e+04  1.00809418e+05  9.85e-02 2.29e-03  1.78e-01     3s
  22   7.46185650e+04  9.62632516e+04  8.00e-02 3.64e-03  1.32e-01     3s
  23   7.85768125e+04  9.36255969e+04  5.56e-02 2.43e-03  9.20e-02     3s
  24   7.94328280e+04  9.20979582e+04  5.03e-02 1.60e-03  7.75e-02     3s
  25   8.21130177e+04  9.11064549e+04  3.45e-02 1.50e-03  5.50e-02     3s
  26   8.28933476e+04  9.00908643e+04  2.99e-02 1.53e-03  4.40e-02     3s
  27   8.37919952e+04  8.97221668e+04  2.47e-02 1.19e-03  3.63e-02     3s
  28   8.43031620e+04  8.94778923e+04  2.18e-02 9.84e-04  3.17e-02     3s
  29   8.49389402e+04  8.90584170e+04  1.84e-02 6.06e-04  2.52e-02     3s
  30   8.57144086e+04  8.89312151e+04  1.41e-02 4.82e-04  1.97e-02     3s
  31   8.63534792e+04  8.87567728e+04  1.05e-02 4.76e-04  1.47e-02     3s
  32   8.67721298e+04  8.87059182e+04  8.23e-03 4.25e-04  1.18e-02     4s
  33   8.71343928e+04  8.86389843e+04  6.27e-03 3.40e-04  9.20e-03     4s
  34   8.73045756e+04  8.85158133e+04  5.38e-03 1.39e-04  7.41e-03     4s
  35   8.75006948e+04  8.84596163e+04  4.35e-03 3.47e-04  5.87e-03     4s
  36   8.76856662e+04  8.84068376e+04  3.43e-03 1.64e-04  4.42e-03     4s
  37   8.78470074e+04  8.83990399e+04  2.61e-03 1.33e-04  3.38e-03     4s
  38   8.79158925e+04  8.83959029e+04  2.24e-03 1.26e-04  2.94e-03     4s
  39   8.80813913e+04  8.83799315e+04  1.39e-03 6.89e-05  1.83e-03     4s
  40   8.82715601e+04  8.83652212e+04  4.11e-04 3.55e-05  5.73e-04     4s
  41   8.83170706e+04  8.83571838e+04  1.81e-04 5.91e-06  2.46e-04     4s
  42   8.83268788e+04  8.83560274e+04  1.33e-04 2.20e-06  1.78e-04     4s
  43   8.83399187e+04  8.83552730e+04  6.77e-05 6.76e-07  9.40e-05     4s
  44   8.83543911e+04  8.83549050e+04  2.17e-06 3.71e-08  3.14e-06     4s
  45   8.83548736e+04  8.83548748e+04  2.65e-07 1.07e-07  7.56e-09     4s
  46   8.83548748e+04  8.83548748e+04  6.75e-09 2.58e-08  3.81e-12     4s

Barrier solved model in 46 iterations and 4.09 seconds (7.17 work units)
Optimal objective 8.83548748e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

     729 PPushes remaining with PInf 0.0000000e+00                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2832930e-10      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35212    8.8354875e+04   0.000000e+00   0.000000e+00      5s
   35212    8.8354875e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.835487e+04, 35212 iterations, 3.71 seconds (6.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88354.8748    0   74 -168399.12 88354.8748   152%     -    5s
H    0     0                    -155205.3643 88354.8748   157%     -    5s
H    0     0                    -129294.8593 88354.8748   168%     -    5s
H    0     0                    -129182.4305 88354.8748   168%     -    6s
H    0     0                    -128194.7504 88354.8748   169%     -    6s
H    0     0                    -127541.5488 88354.8748   169%     -    6s
H    0     0                    -127266.4477 88354.8748   169%     -    6s
H    0     0                    -37479.88462 88354.8748   336%     -    6s
H    0     0                    -5205.251851 88354.8748  1797%     -    6s
H    0     0                    18733.727757 88354.8748   372%     -    6s
H    0     0                    40494.178465 88354.8748   118%     -    6s
H    0     0                    51602.537956 88354.8748  71.2%     -    7s
H    0     0                    51694.042670 88354.8748  70.9%     -    7s
H    0     0                    51909.198156 88354.8748  70.2%     -    7s
H    0     0                    51966.804073 88354.8748  70.0%     -    7s
H    0     0                    51977.249964 88354.8748  70.0%     -    7s
H    0     0                    52082.058097 88354.8748  69.6%     -    7s
H    0     0                    52102.912494 88354.8748  69.6%     -    7s
H    0     0                    52105.156847 88354.8748  69.6%     -    7s
H    0     0                    52881.609423 82168.5963  55.4%     -   29s
     0     0 82168.5963    0  228 52881.6094 82168.5963  55.4%     -   29s
H    0     0                    52955.039385 82168.4506  55.2%     -   30s
     0     0 81905.5044    0  245 52955.0394 81905.5044  54.7%     -   41s
     0     0 81702.4022    0  248 52955.0394 81702.4022  54.3%     -   46s
     0     0 81644.0693    0  239 52955.0394 81644.0693  54.2%     -   54s
     0     0 81635.7114    0  209 52955.0394 81635.7114  54.2%     -   61s
     0     0 81635.7114    0  252 52955.0394 81635.7114  54.2%     -   63s
     0     0 81635.7017    0  252 52955.0394 81635.7017  54.2%     -   63s
     0     0 78901.1423    0  354 52955.0394 78901.1423  49.0%     -   91s
H    0     0                    57183.390462 78900.9254  38.0%     -   91s
H    0     0                    57430.483931 78900.9254  37.4%     -   91s
     0     0 78297.7825    0  316 57430.4839 78297.7825  36.3%     -  106s
H    0     0                    58582.555526 78201.3064  33.5%     -  114s
H    0     0                    58583.580087 78201.3064  33.5%     -  114s
     0     0 78201.3064    0  323 58583.5801 78201.3064  33.5%     -  114s
     0     0 78092.8167    0  324 58583.5801 78092.8167  33.3%     -  122s
     0     0 78038.8340    0  324 58583.5801 78038.8340  33.2%     -  126s
     0     0 78002.7104    0  316 58583.5801 78002.7104  33.1%     -  129s
     0     0 77940.8729    0  327 58583.5801 77940.8729  33.0%     -  136s
     0     0 77933.1604    0  329 58583.5801 77933.1604  33.0%     -  138s
     0     0 77782.2048    0  273 58583.5801 77782.2048  32.8%     -  150s
     0     0 77733.2118    0  269 58583.5801 77733.2118  32.7%     -  155s
     0     0 77721.6599    0  270 58583.5801 77721.6599  32.7%     -  159s
     0     0 77719.9260    0  274 58583.5801 77719.9260  32.7%     -  160s
     0     0 77719.5449    0  270 58583.5801 77719.5449  32.7%     -  161s
     0     0 76154.2356    0  251 58583.5801 76154.2356  30.0%     -  191s
     0     0 75844.4758    0  341 58583.5801 75844.4758  29.5%     -  201s
     0     0 75637.7461    0  396 58583.5801 75637.7461  29.1%     -  210s
     0     0 75559.0625    0  343 58583.5801 75559.0625  29.0%     -  217s
     0     0 75542.0342    0  346 58583.5801 75542.0342  28.9%     -  219s
     0     0 75532.6136    0  348 58583.5801 75532.6136  28.9%     -  222s
     0     0 75518.7371    0  354 58583.5801 75518.7371  28.9%     -  227s
     0     0 75504.7175    0  316 58583.5801 75504.7175  28.9%     -  229s
     0     0 75497.4682    0  389 58583.5801 75497.4682  28.9%     -  232s
     0     0 75491.6354    0  357 58583.5801 75491.6354  28.9%     -  234s
     0     0 75469.3231    0  350 58583.5801 75469.3231  28.8%     -  237s
     0     0 75467.3300    0  353 58583.5801 75467.3300  28.8%     -  238s
     0     0 75466.2797    0  354 58583.5801 75466.2797  28.8%     -  239s
H    0     0                    58587.361430 75466.2797  28.8%     -  245s
H    0     0                    58600.766584 75466.2797  28.8%     -  245s
H    0     0                    58618.165122 75466.2797  28.7%     -  245s
     0     0 74859.4991    0  282 58618.1651 74859.4991  27.7%     -  262s
     0     0 74769.3165    0  281 58618.1651 74769.3165  27.6%     -  269s
     0     0 74717.6724    0  389 58618.1651 74717.6724  27.5%     -  276s
     0     0 74688.3103    0  286 58618.1651 74688.3103  27.4%     -  280s
     0     0 74680.2571    0  338 58618.1651 74680.2571  27.4%     -  283s
     0     0 74676.0740    0  287 58618.1651 74676.0740  27.4%     -  286s
     0     0 74654.5108    0  288 58618.1651 74654.5108  27.4%     -  289s
     0     0 74644.9341    0  290 58618.1651 74644.9341  27.3%     -  291s
     0     0 74641.9507    0  288 58618.1651 74641.9507  27.3%     -  293s
     0     0 74640.3447    0  408 58618.1651 74640.3447  27.3%     -  294s
     0     0 74504.7124    0  351 58618.1651 74504.7124  27.1%     -  303s
     0     0 74484.8921    0  359 58618.1651 74484.8921  27.1%     -  308s
     0     0 74468.6199    0  482 58618.1651 74468.6199  27.0%     -  311s
     0     0 74465.2402    0  467 58618.1651 74465.2402  27.0%     -  312s
     0     0 74462.3565    0  476 58618.1651 74462.3565  27.0%     -  313s
     0     0 74452.3971    0  505 58618.1651 74452.3971  27.0%     -  315s
     0     0 74451.1552    0  430 58618.1651 74451.1552  27.0%     -  316s
     0     0 74374.4227    0  462 58618.1651 74374.4227  26.9%     -  322s
     0     0 74354.8872    0  469 58618.1651 74354.8872  26.8%     -  326s
     0     0 74351.8226    0  473 58618.1651 74351.8226  26.8%     -  327s
     0     0 74349.9023    0  473 58618.1651 74349.9023  26.8%     -  328s
     0     0 74349.2486    0  425 58618.1651 74349.2486  26.8%     -  329s
     0     0 74313.9805    0  431 58618.1651 74313.9805  26.8%     -  333s
     0     0 74306.6129    0  486 58618.1651 74306.6129  26.8%     -  336s
     0     0 74304.1279    0  482 58618.1651 74304.1279  26.8%     -  337s
     0     0 74303.1570    0  479 58618.1651 74303.1570  26.8%     -  338s
     0     0 74299.3164    0  482 58618.1651 74299.3164  26.8%     -  340s
     0     0 74298.0266    0  522 58618.1651 74298.0266  26.7%     -  342s
     0     0 74288.4233    0  518 58618.1651 74288.4233  26.7%     -  345s
     0     0 74287.8456    0  521 58618.1651 74287.8456  26.7%     -  346s
     0     0 74285.2519    0  515 58618.1651 74285.2519  26.7%     -  348s
     0     0 74284.9018    0  515 58618.1651 74284.9018  26.7%     -  350s
H    0     0                    58750.940621 74284.9018  26.4%     -  392s
H    0     2                    58834.518554 74284.9018  26.3%     -  394s
     0     2 74284.9018    0  515 58834.5186 74284.9018  26.3%     -  394s
     1     3 73721.3555    1  507 58834.5186 74283.7983  26.3% 10043  402s
     2     5 73125.4186    2  420 58834.5186 74283.7983  26.3% 11068  413s
     4    10 73298.8105    2  447 58834.5186 73827.4859  25.5% 10734  425s
     9    20 72714.8935    3  404 58834.5186 73701.8945  25.3% 10603  443s
    19    40 72560.6952    4  396 58834.5186 73338.6399  24.7% 12184  464s
    39    52 72284.8381    5  360 58834.5186 73180.1248  24.4% 16735  508s
H   51    75                    58859.422020 73180.1248  24.3% 16339  539s
H   52    75                    58876.519899 73180.1248  24.3% 16185  539s
    74   215 71851.0376    7  331 58876.5199 73180.1248  24.3% 13133  570s
   214   247 71335.1359   12  267 58876.5199 73180.1248  24.3%  7172  584s
   246   281 71147.5260   13  323 58876.5199 73180.1248  24.3%  6945  599s
   282   312 71106.8886   15  317 58876.5199 73180.1248  24.3%  6733  612s
   313   344 70929.3538   16  291 58876.5199 73180.1248  24.3%  6735  625s
   347   376 70288.3217   18  247 58876.5199 73180.1248  24.3%  6583  639s
   379   398 70193.0532   20  241 58876.5199 73180.1248  24.3%  6371  655s
   401   427 69786.5692   22  275 58876.5199 73180.1248  24.3%  6387  671s
   430   456 68548.2941   23  262 58876.5199 73180.1248  24.3%  6505  688s
   461   488 68447.1942   24  309 58876.5199 73180.1248  24.3%  6739  707s
   495   524 68161.4854   25  260 58876.5199 73180.1248  24.3%  6595  722s
H  502   524                    59356.910607 73180.1248  23.3%  6582  722s
   535   594 67937.7888   27  295 59356.9106 73180.1248  23.3%  6432  743s
   607   652 67755.7953   29  287 59356.9106 73180.1248  23.3%  6119  763s
H  610   652                    59476.920023 73180.1248  23.0%  6103  763s
H  617   652                    59527.873735 73180.1248  22.9%  6087  763s
   669   701 66840.9263   31  184 59527.8737 73180.1248  22.9%  5969  781s
   726   764 66140.0836   34  153 59527.8737 73180.1248  22.9%  5884  798s
   799   820 65793.3569   37  137 59527.8737 73180.1248  22.9%  5696  816s
   883   913 62462.8398   39  122 59527.8737 73180.1248  22.9%  5395  831s
   999   967 61592.7554   43  127 59527.8737 73180.1248  22.9%  5009  851s
  1069  1087 infeasible   45      59527.8737 73180.1248  22.9%  4864  865s
  1225  1122 infeasible   48      59527.8737 73180.1248  22.9%  4462  882s
  1354  1156 59897.2894   51  139 59527.8737 73180.1248  22.9%  4271  900s
  1464  1247 68961.1231    9  256 59527.8737 72916.8776  22.5%  4165  919s
  1599  1311 68228.4960   10  202 59527.8737 72914.8282  22.5%  4031  938s
  1737  1363 68219.9249   11  196 59527.8737 72914.8282  22.5%  3898  956s
  1817  1405 67482.6830   12  186 59527.8737 72550.5821  21.9%  3881  975s
  1953  1435 67196.2978   13  248 59527.8737 72550.5821  21.9%  3772  997s
  2043  1485 67023.0720   14  247 59527.8737 72302.4869  21.5%  3781 1019s
  2122  1555 64542.7986   15  272 59527.8737 72302.4869  21.5%  3815 1043s
  2243  1636 infeasible   16      59527.8737 72302.4869  21.5%  3754 1065s
  2358  1716 60456.3578   18  212 59527.8737 72302.4869  21.5%  3756 1092s
  2489  1766 60551.1472   18  242 59527.8737 71892.9073  20.8%  3718 1119s
  2591  1857 infeasible   20      59527.8737 71892.9073  20.8%  3761 1144s
  2737  1932 67764.8028   10  242 59527.8737 71892.9073  20.8%  3762 1169s
H 2747  1906                    59788.327681 71892.9073  20.2%  3762 1169s
  2867  1986 64622.8860   11  223 59788.3277 71892.9073  20.2%  3779 1197s
  2983  2128 62509.0401   12  213 59788.3277 71892.9073  20.2%  3801 1225s
H 3153  2207                    59845.532264 71892.9073  20.1%  3784 1258s
  3300  2349     cutoff   34      59845.5323 71515.6091  19.5%  3751 1289s
  3504  2393 67578.6385    7  352 59845.5323 71466.1026  19.4%  3720 1322s
  3650  2463 63632.9370    9  318 59845.5323 71459.8202  19.4%  3752 1358s
  3762  2548 61885.9378   11  233 59845.5323 71459.8202  19.4%  3812 1394s
  3901  2698     cutoff   14      59845.5323 71454.5278  19.4%  3858 1431s
  4119  2699 62448.5185   37  515 59845.5323 71454.5278  19.4%  3830 1498s
  4121  2700 62081.3889   36   74 59845.5323 71454.5278  19.4%  3828 1504s
  4122  2701 70376.8363    9  385 59845.5323 71454.5278  19.4%  3827 1549s
  4123  2702 68100.1837   14  306 59845.5323 71454.5278  19.4%  3826 1579s
  4124  2702 69322.8736   11  305 59845.5323 71454.5278  19.4%  3825 1593s
  4125  2703 60984.0172   27  295 59845.5323 71454.5278  19.4%  3824 1607s
  4126  2704 60993.4984   43  381 59845.5323 71454.5278  19.4%  3823 1623s
  4127  2704 66603.9104   23  361 59845.5323 71454.5278  19.4%  3822 1628s
  4128  2705 70384.4363    9  398 59845.5323 71454.5278  19.4%  3821 1637s
  4129  2706 64377.3126   28  356 59845.5323 71454.5278  19.4%  3820 1643s
  4130  2706 63241.1163   21  357 59845.5323 71454.5278  19.4%  3819 1647s
  4131  2707 61576.5791   39  417 59845.5323 71454.5278  19.4%  3818 1650s
  4133  2708 61319.9845   31  366 59845.5323 71454.5278  19.4%  3817 1655s
  4135  2710 70092.6830   15  375 59845.5323 71454.5278  19.4%  3815 1661s
  4136  2710 61546.1964   35  428 59845.5323 71454.5278  19.4%  3814 1674s
  4137  2711 65719.3827   18  360 59845.5323 71454.5278  19.4%  3813 1677s
  4138  2712 62000.8184   36  295 59845.5323 71454.5278  19.4%  3812 1680s
  4139  2712 67760.1063   19  394 59845.5323 71454.5278  19.4%  3811 1690s
  4141  2714 62140.1970   31  398 59845.5323 71454.5278  19.4%  3809 1695s
  4142  2714 69907.1917   14  500 59845.5323 71454.5278  19.4%  3808 1705s
  4144  2716 61569.1634   21  500 59845.5323 71454.5278  19.4%  3806 1717s
  4145  2716 61441.3959   46  492 59845.5323 71454.5278  19.4%  3806 1721s
  4146  2717 60764.7316   16  368 59845.5323 71454.5278  19.4%  3805 1725s
  4148  2718 62121.8016   35  364 59845.5323 71454.5278  19.4%  3803 1732s
  4149  2719 70674.7725    9  365 59845.5323 71454.5278  19.4%  3802 1735s
  4150  2720 60754.4201   51  503 59845.5323 71454.5278  19.4%  3801 1740s
  4152  2721 61030.9766   29  492 59845.5323 71454.5278  19.4%  3799 1747s
  4154  2722 66398.7808   24  306 59845.5323 71454.5278  19.4%  3797 1753s
  4155  2723 64050.6103   19  484 59845.5323 71454.5278  19.4%  3796 1756s
  4156  2724 62979.2119   18  482 59845.5323 71454.5278  19.4%  3795 1761s
  4157  2724 69482.2782   16  482 59845.5323 71454.5278  19.4%  3795 1773s
  4158  2725 71013.8074   13  482 59845.5323 71454.5278  19.4%  3794 1801s
  4159  2728 71454.5278   14  268 59845.5323 71454.5278  19.4%  3859 1832s
  4160  2729 71454.5278   15  278 59845.5323 71454.5278  19.4%  3861 1848s
  4162  2734 71454.5278   15  355 59845.5323 71454.5278  19.4%  3864 1889s
  4167  2742 71454.5278   16  274 59845.5323 71454.5278  19.4%  3868 1916s
  4177  2759 71229.0439   17  334 59845.5323 71454.5278  19.4%  3889 1954s
  4197  2764 69213.3751   18  364 59845.5323 71454.5278  19.4%  3954 2009s
  4209  2791 70740.6478   19  296 59845.5323 71454.5278  19.4%  4026 2049s
  4240  2874 69568.8066   20  301 59845.5323 71454.5278  19.4%  4105 2085s
  4333  2888 68685.4335   23  259 59845.5323 71454.5278  19.4%  4223 2112s
  4381  2916     cutoff   24      59845.5323 71454.5278  19.4%  4259 2137s
  4440  2931 68801.4048   23  283 59845.5323 71454.5278  19.4%  4272 2160s
  4505  2936     cutoff   28      59845.5323 71454.5278  19.4%  4280 2183s
  4575  2936 68987.5281   22  273 59845.5323 71454.5278  19.4%  4276 2204s
  4634  2942 63213.5159   22  266 59845.5323 71454.5278  19.4%  4273 2222s
  4706  2961     cutoff   23      59845.5323 71454.5278  19.4%  4264 2249s
  4783  2959 61382.1706   36   94 59845.5323 71454.5278  19.4%  4252 2269s
  4856  2959 61282.8998   37  120 59845.5323 71454.5278  19.4%  4243 2285s
  4929  2971 infeasible   39      59845.5323 71454.5278  19.4%  4231 2305s
  5011  2952     cutoff   39      59845.5323 71454.5278  19.4%  4216 2320s
  5043  2958 60348.6001   38  148 59845.5323 71454.5278  19.4%  4218 2337s
H 5056  2817                    59975.885078 71454.5278  19.1%  4216 2337s
H 5073  2681                    60165.307676 71454.5278  18.8%  4216 2337s
  5099  2677 infeasible   40      60165.3077 71454.5278  18.8%  4213 2354s
  5135  2676 62195.7700   23  274 60165.3077 71454.5278  18.8%  4209 2370s
  5170  2697 61979.6520   24  248 60165.3077 71454.5278  18.8%  4210 2386s
H 5208  2560                    60226.267000 71454.5278  18.6%  4203 2386s
  5234  2600 61108.2895   25  214 60226.2670 71454.5278  18.6%  4202 2406s
  5345  2596     cutoff   28      60226.2670 71454.5278  18.6%  4173 2424s
  5476  2579     cutoff   27      60226.2670 71454.5278  18.6%  4128 2447s
  5573  2588 61028.5497   26  202 60226.2670 71454.5278  18.6%  4112 2471s
  5674  2582 infeasible   30      60226.2670 70715.4856  17.4%  4104 2498s
  5771  2585 69428.6449   21  284 60226.2670 70715.4856  17.4%  4097 2537s
  5873  2590 infeasible   28      60226.2670 70510.4865  17.1%  4084 2561s
  5999  2590 65583.9370   22  249 60226.2670 70510.4865  17.1%  4072 2585s
  6107  2594 66054.2643   23  203 60226.2670 70510.4865  17.1%  4062 2611s
  6205  2633 62912.8919   24  196 60226.2670 70510.4865  17.1%  4058 2642s
  6329  2653 61522.6620   27  135 60226.2670 70510.4865  17.1%  4048 2668s
  6484  2649     cutoff   31      60226.2670 70079.1070  16.4%  4032 2697s
  6627  2661 64978.7668   21  214 60226.2670 70079.1070  16.4%  4004 2730s
  6802  2639 64927.9135   22  217 60226.2670 70079.1070  16.4%  3972 2766s
  6972  2651 64729.2765   23  209 60226.2670 70079.1070  16.4%  3955 2800s
  7149  2673 61383.7532   26  300 60226.2670 69544.4962  15.5%  3943 2839s
  7343  2673 60477.1033   28  211 60226.2670 69544.4962  15.5%  3929 2875s
  7536  2647 63883.5992   28  232 60226.2670 69544.4962  15.5%  3919 2908s
  7668  2649 61859.2475   35  178 60226.2670 69544.4962  15.5%  3948 2938s
  7834  2666 60463.3997   53  126 60226.2670 68865.5731  14.3%  3943 2985s
  8001  2687 65124.1908   19  253 60226.2670 68865.5731  14.3%  3955 3033s
  8241  2736 62464.8952   24  125 60226.2670 68865.5731  14.3%  3950 3081s
  8527  2690 61042.6555   30  102 60226.2670 68710.5615  14.1%  3927 3139s
  8827  2658 63318.4510   25  257 60226.2670 68249.4027  13.3%  3904 3195s
H 8850  2418                    61532.222930 68249.4027  10.9%  3900 3195s
  9024  2324 infeasible   31      61532.2229 68249.4027  10.9%  3902 3245s
H 9057  2201                    61650.644393 68249.4027  10.7%  3896 3245s
  9257  2106 infeasible   27      61650.6444 67975.9887  10.3%  3908 3289s
H 9315  1981                    61672.077874 67866.7069  10.0%  3910 3289s
H 9339  1873                    61794.245835 67866.7069  9.83%  3912 3289s
  9473  1807 63271.5107   27  159 61794.2458 67866.7069  9.83%  3918 3338s
  9693  1757 64072.0046   25  183 61794.2458 67785.1454  9.69%  3940 3376s
H 9773  1703                    61849.624048 67785.1454  9.60%  3948 3376s
  9808  1712 63269.1862   26  236 61849.6240 67785.1454  9.60%  3936 3421s
  9967  1706 62655.4792   28  134 61849.6240 67529.8759  9.18%  3941 3480s
 10203  1653 62421.9388   27  129 61849.6240 66878.8714  8.13%  3962 3540s
 10468  1694 infeasible   28      61849.6240 66656.0591  7.77%  3991 3596s
 10741  1695     cutoff   21      61849.6240 66656.0591  7.77%  4018 3600s

Cutting planes:
  Learned: 3
  Projected implied bound: 12
  MIR: 758
  Flow cover: 1938
  RLT: 10
  Relax-and-lift: 219

Explored 10756 nodes (43569935 simplex iterations) in 3600.04 seconds (9765.33 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 61849.6 61794.2 61672.1 ... 59788.3

Time limit reached
Best objective 6.184962404841e+04, best bound 6.665605911533e+04, gap 7.7712%
  WARNING: Time limit reached. Using best solution found (gap: 7.77%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 61849.62, θ = 209560.26
  Upper Bound (UB) = 61849.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 209560.26
  [DEBUG]   ✓ Scenario 0: θ = 209560.26 ≤ Q = 209560.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 209560.26 ≤ Q = 209560.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 209560.26 ≤ Q = 209560.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 209560.26 ≤ Q = 209560.26 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x14a9cc85
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x14a9cc85
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.496072e+13
Presolve removed 2619 rows and 1910 columns
Presolve time: 0.00s
Presolved: 474 rows, 479 columns, 1337 nonzeros
Found heuristic solution: objective 7164895.2834
Variable types: 324 continuous, 155 integer (155 binary)
Found heuristic solution: objective 7164519.4392

Root relaxation: objective -1.606335e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160633.46    0  122 7164519.44 -160633.46   102%     -    0s
H    0     0                    -119924.8142 -160633.46  33.9%     -    0s
H    0     0                    -124831.9162 -160633.46  28.7%     -    0s
     0     0 -136592.86    0   60 -124831.92 -136592.86  9.42%     -    0s
H    0     0                    -132972.8536 -136495.21  2.65%     -    0s
H    0     0                    -134434.9919 -136495.21  1.53%     -    0s
H    0     0                    -134793.2851 -136495.21  1.26%     -    0s
     0     0 -135596.49    0   96 -134793.29 -135596.49  0.60%     -    0s
H    0     0                    -134808.5046 -135567.04  0.56%     -    0s
     0     0 -135567.04    0   82 -134808.50 -135567.04  0.56%     -    0s
     0     0 -135244.77    0   62 -134808.50 -135244.77  0.32%     -    0s
H    0     0                    -134865.2926 -135217.81  0.26%     -    0s
     0     0 -135217.81    0   60 -134865.29 -135217.81  0.26%     -    0s
H    0     0                    -134894.6506 -135217.81  0.24%     -    0s
     0     0 -135198.70    0   59 -134894.65 -135198.70  0.23%     -    0s
     0     0 -135196.92    0   59 -134894.65 -135196.92  0.22%     -    0s
     0     0 -135196.92    0   58 -134894.65 -135196.92  0.22%     -    0s
H    0     0                    -134970.0563 -135196.83  0.17%     -    0s
     0     0 -135196.83    0   72 -134970.06 -135196.83  0.17%     -    0s
     0     0 -135145.60    0   19 -134970.06 -135145.60  0.13%     -    0s
     0     0 -135090.81    0   12 -134970.06 -135090.81  0.09%     -    0s
     0     0 -135071.72    0   11 -134970.06 -135071.72  0.08%     -    0s
     0     0 -135005.46    0    2 -134970.06 -135005.46  0.03%     -    0s
     0     0 -135005.46    0    4 -134970.06 -135005.46  0.03%     -    0s
H    0     0                    -134980.6123 -135005.46  0.02%     -    0s
H    0     0                    -134983.0593 -135005.46  0.02%     -    0s
H    0     0                    -135002.4817 -135005.46  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 1
  Flow cover: 1
  RLT: 1

Explored 1 nodes (839 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135002 -134983 -134981 ... -124832

Optimal solution found (tolerance 1.00e-04)
Best objective -1.350024817078e+05, best bound -1.350054618689e+05, gap 0.0022%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 205180.34
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135002.48
  [DEBUG]   S×d_nominal = 340182.83
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340182.83 + -135002.48 = 205180.34
  [DEBUG]   Current θ from Master = 209560.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4379.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 57469.71
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = 3038.8584, Absolute Gap = 3038.8584, Relative Gap = 0.049133
  Not converged yet (gap = 3038.86 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524219 nonzeros
Model fingerprint: 0x88360354
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87264 rows and 35424 columns
Presolve time: 1.44s
Presolved: 97599 rows, 41716 columns, 591887 nonzeros
Variable types: 39457 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -307957.4725
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 590
 AA' NZ     : 3.636e+06
 Factor NZ  : 8.378e+06 (roughly 120 MB of memory)
 Factor Ops : 1.544e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80811777e+07  1.82921089e+08  1.35e+05 1.58e+01  8.30e+04     3s
   1  -1.36258277e+07  1.69494367e+08  9.41e+04 1.04e+02  5.72e+04     3s
   2  -6.07940365e+06  1.30309658e+08  4.34e+04 1.75e+01  2.76e+04     3s
   3  -1.64308482e+06  1.00353380e+08  7.40e+03 1.16e+00  5.03e+03     3s
   4  -6.71204259e+05  5.67887165e+07  8.50e+02 4.90e-01  7.95e+02     3s
   5  -3.93497909e+05  2.89912748e+07  3.21e+02 2.06e-01  3.22e+02     3s
   6  -3.05419830e+05  2.07228352e+07  1.44e+02 1.33e-01  1.82e+02     3s
   7  -2.38909150e+05  1.43205047e+07  4.88e+01 8.46e-02  1.00e+02     3s
   8  -1.72497419e+05  9.86137192e+06  2.69e+01 5.45e-02  6.44e+01     3s
   9  -1.55154352e+05  7.27086713e+06  2.37e+01 3.87e-02  4.74e+01     3s
  10  -9.96002314e+04  3.79952448e+06  1.16e+01 1.85e-02  2.36e+01     3s
  11  -5.01701063e+04  1.13412099e+06  4.77e+00 4.74e-03  6.91e+00     3s
  12  -5.70212578e+03  4.70930793e+05  2.36e+00 2.03e-03  2.73e+00     3s
  13   4.77530833e+03  3.07494873e+05  1.85e+00 1.18e-03  1.73e+00     3s
  14   1.50925396e+04  2.19441224e+05  1.41e+00 1.78e-03  1.16e+00     3s
  15   2.34533344e+04  1.86817402e+05  1.18e+00 1.98e-03  9.29e-01     3s
  16   3.23163004e+04  1.42637749e+05  9.81e-01 2.38e-03  6.27e-01     3s
  17   4.30215537e+04  1.31728574e+05  7.93e-01 2.17e-03  5.04e-01     3s
  18   4.99222805e+04  1.20381563e+05  6.62e-01 3.70e-03  4.00e-01     3s
  19   5.62592280e+04  1.10835673e+05  5.46e-01 2.29e-03  3.10e-01     3s
  20   6.04622298e+04  1.07251692e+05  4.67e-01 2.73e-03  2.66e-01     3s
  21   6.68996117e+04  1.05154606e+05  3.49e-01 2.61e-03  2.17e-01     3s
  22   7.07685554e+04  1.00932961e+05  2.82e-01 1.71e-03  1.71e-01     3s
  23   7.42851392e+04  9.73188117e+04  2.23e-01 2.46e-03  1.31e-01     3s
  24   7.70603753e+04  9.46971155e+04  1.78e-01 1.52e-03  1.00e-01     3s
  25   7.89482644e+04  9.26676971e+04  1.48e-01 1.23e-03  7.79e-02     3s
  26   7.97794338e+04  9.18165679e+04  1.35e-01 2.25e-03  6.84e-02     4s
  27   8.20918950e+04  9.14737263e+04  9.94e-02 2.01e-03  5.32e-02     4s
  28   8.40516339e+04  9.06237427e+04  6.94e-02 2.46e-03  3.73e-02     4s
  29   8.46674338e+04  9.01516858e+04  5.95e-02 1.68e-03  3.11e-02     4s
  30   8.57910358e+04  8.98777253e+04  4.27e-02 1.81e-03  2.32e-02     4s
  31   8.64857411e+04  8.97280753e+04  3.24e-02 1.30e-03  1.84e-02     4s
  32   8.69404480e+04  8.92905040e+04  2.57e-02 2.52e-03  1.33e-02     4s
  33   8.75243195e+04  8.91147512e+04  1.69e-02 2.60e-03  9.02e-03     4s
  34   8.79470166e+04  8.89933971e+04  1.10e-02 1.35e-03  5.93e-03     4s
  35   8.79790783e+04  8.89633798e+04  1.05e-02 1.14e-03  5.58e-03     4s
  36   8.81211904e+04  8.89118066e+04  8.60e-03 8.52e-04  4.49e-03     4s
  37   8.84515758e+04  8.88410053e+04  4.25e-03 5.47e-04  2.21e-03     4s
  38   8.85419136e+04  8.88050747e+04  3.04e-03 2.79e-04  1.49e-03     4s
  39   8.86463345e+04  8.87976564e+04  1.66e-03 2.02e-04  8.59e-04     4s
  40   8.86862709e+04  8.87940142e+04  1.16e-03 1.59e-04  6.11e-04     4s
  41   8.87233603e+04  8.87881825e+04  6.78e-04 9.72e-05  3.68e-04     4s
  42   8.87642298e+04  8.87844056e+04  1.63e-04 5.72e-05  1.14e-04     4s
  43   8.87690288e+04  8.87819309e+04  1.09e-04 3.15e-05  7.29e-05     4s
  44   8.87749270e+04  8.87791766e+04  4.02e-05 3.65e-06  2.41e-05     4s
  45   8.87786532e+04  8.87786943e+04  3.18e-07 2.15e-07  2.32e-07     4s
  46   8.87786878e+04  8.87786878e+04  3.52e-11 2.23e-11  3.07e-12     4s

Barrier solved model in 46 iterations and 4.26 seconds (7.55 work units)
Optimal objective 8.87786878e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

     951 PPushes remaining with PInf 2.8153157e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7667200e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35732    8.8778688e+04   0.000000e+00   0.000000e+00      6s
   35732    8.8778688e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 8.877869e+04, 35732 iterations, 4.25 seconds (9.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88778.6878    0  122 -168399.12 88778.6878   153%     -    6s
H    0     0                    -156452.1995 88778.6878   157%     -    6s
H    0     0                    -155160.9313 88778.6878   157%     -    6s
H    0     0                    -148787.9480 88778.6878   160%     -    6s
H    0     0                    -140656.6296 88778.6878   163%     -    6s
H    0     0                    -139790.8332 88778.6878   164%     -    7s
H    0     0                    -52369.46288 88778.6878   270%     -    7s
H    0     0                    -31048.94065 88778.6878   386%     -    7s
H    0     0                    -30925.09917 88778.6878   387%     -    7s
H    0     0                    -17970.84979 88778.6878   594%     -    7s
H    0     0                    22966.298611 88778.6878   287%     -    7s
H    0     0                    40894.885955 88778.6878   117%     -    7s
H    0     0                    52119.457043 88778.6878  70.3%     -    7s
H    0     0                    52128.043809 88778.6878  70.3%     -    7s
     0     0 82551.6419    0  219 52128.0438 82551.6419  58.4%     -   44s
     0     0 81978.4594    0  227 52128.0438 81978.4594  57.3%     -   57s
     0     0 81881.9227    0  225 52128.0438 81881.9227  57.1%     -   65s
     0     0 81761.5735    0  225 52128.0438 81761.5735  56.8%     -   67s
     0     0 81724.5580    0  228 52128.0438 81724.5580  56.8%     -   69s
     0     0 81724.5580    0  228 52128.0438 81724.5580  56.8%     -   73s
     0     0 81724.5580    0  260 52128.0438 81724.5580  56.8%     -   84s
H    0     0                    52956.029234 81724.5580  54.3%     -   90s
H    0     0                    53020.898429 81724.5580  54.1%     -   90s
H    0     0                    53407.831612 81724.5580  53.0%     -   90s
H    0     0                    56773.065947 81724.5580  43.9%     -   90s
H    0     0                    56792.945270 81724.5580  43.9%     -   90s
H    0     0                    58298.676177 81724.5580  40.2%     -   90s
H    0     0                    58671.138906 81724.5580  39.3%     -   90s
     0     0 81724.5580    0  258 58671.1389 81724.5580  39.3%     -   91s
     0     0 79369.1039    0  258 58671.1389 79369.1039  35.3%     -   94s
     0     0 79369.1039    0  260 58671.1389 79369.1039  35.3%     -   96s
     0     0 79369.1039    0  260 58671.1389 79369.1039  35.3%     -   97s
     0     0 79369.1039    0  328 58671.1389 79369.1039  35.3%     -  120s
H    0     0                    58707.486499 79369.1039  35.2%     -  121s
H    0     0                    58777.986312 79369.1039  35.0%     -  121s
     0     0 78722.7204    0  320 58777.9863 78722.7204  33.9%     -  142s
     0     0 78487.7384    0  314 58777.9863 78487.7384  33.5%     -  156s
     0     0 78348.7857    0  324 58777.9863 78348.7857  33.3%     -  167s
     0     0 78276.4748    0  298 58777.9863 78276.4748  33.2%     -  177s
     0     0 78237.7517    0  306 58777.9863 78237.7517  33.1%     -  182s
     0     0 78127.1931    0  302 58777.9863 78127.1931  32.9%     -  191s
     0     0 78098.7625    0  301 58777.9863 78098.7625  32.9%     -  194s
     0     0 77926.2296    0  289 58777.9863 77926.2296  32.6%     -  203s
     0     0 77859.3748    0  296 58777.9863 77859.3748  32.5%     -  208s
     0     0 77856.4430    0  301 58777.9863 77856.4430  32.5%     -  210s
     0     0 77856.2698    0  297 58777.9863 77856.2698  32.5%     -  210s
     0     0 76286.7559    0  302 58777.9863 76286.7559  29.8%     -  257s
     0     0 75926.3853    0  295 58777.9863 75926.3853  29.2%     -  276s
     0     0 75798.1765    0  301 58777.9863 75798.1765  29.0%     -  285s
     0     0 75675.3215    0  308 58777.9863 75675.3215  28.7%     -  297s
     0     0 75644.7053    0  307 58777.9863 75644.7053  28.7%     -  303s
     0     0 75617.9047    0  298 58777.9863 75617.9047  28.7%     -  308s
     0     0 75613.4513    0  303 58777.9863 75613.4513  28.6%     -  312s
     0     0 75612.5883    0  304 58777.9863 75612.5883  28.6%     -  314s
     0     0 74997.9450    0  303 58777.9863 74997.9450  27.6%     -  338s
     0     0 74779.4991    0  371 58777.9863 74779.4991  27.2%     -  349s
     0     0 74735.6326    0  328 58777.9863 74735.6326  27.1%     -  354s
     0     0 74703.5525    0  329 58777.9863 74703.5525  27.1%     -  358s
     0     0 74689.8658    0  322 58777.9863 74689.8658  27.1%     -  363s
     0     0 74660.2178    0  326 58777.9863 74660.2178  27.0%     -  367s
     0     0 74644.9535    0  328 58777.9863 74644.9535  27.0%     -  370s
     0     0 74633.4912    0  332 58777.9863 74633.4912  27.0%     -  374s
     0     0 74629.5507    0  330 58777.9863 74629.5507  27.0%     -  376s
     0     0 74628.3129    0  331 58777.9863 74628.3129  27.0%     -  377s
     0     0 74518.3789    0  495 58777.9863 74518.3789  26.8%     -  387s
     0     0 74490.2185    0  458 58777.9863 74490.2185  26.7%     -  391s
     0     0 74482.9910    0  450 58777.9863 74482.9910  26.7%     -  395s
     0     0 74474.5496    0  452 58777.9863 74474.5496  26.7%     -  398s
     0     0 74473.0242    0  440 58777.9863 74473.0242  26.7%     -  400s
     0     0 74413.4314    0  347 58777.9863 74413.4314  26.6%     -  407s
     0     0 74394.8973    0  343 58777.9863 74394.8973  26.6%     -  412s
     0     0 74391.9650    0  338 58777.9863 74391.9650  26.6%     -  414s
     0     0 74390.3260    0  338 58777.9863 74390.3260  26.6%     -  416s
     0     0 74380.9343    0  347 58777.9863 74380.9343  26.5%     -  420s
     0     0 74373.0155    0  412 58777.9863 74373.0155  26.5%     -  423s
     0     0 74370.7176    0  409 58777.9863 74370.7176  26.5%     -  426s
     0     0 74367.6480    0  547 58777.9863 74367.6480  26.5%     -  429s
     0     0 74366.9071    0  491 58777.9863 74366.9071  26.5%     -  433s
     0     0 74352.6664    0  530 58777.9863 74352.6664  26.5%     -  439s
     0     0 74347.1584    0  532 58777.9863 74347.1584  26.5%     -  442s
     0     0 74346.8710    0  541 58777.9863 74346.8710  26.5%     -  443s
     0     0 74326.9780    0  549 58777.9863 74326.9780  26.5%     -  448s
     0     0 74321.3892    0  535 58777.9863 74321.3892  26.4%     -  452s
     0     0 74320.2345    0  541 58777.9863 74320.2345  26.4%     -  455s
     0     0 74221.6192    0  312 58777.9863 74221.6192  26.3%     -  465s
     0     0 74183.2537    0  490 58777.9863 74183.2537  26.2%     -  474s
     0     0 74167.3037    0  501 58777.9863 74167.3037  26.2%     -  480s
     0     0 74165.0254    0  369 58777.9863 74165.0254  26.2%     -  482s
     0     0 74163.5657    0  325 58777.9863 74163.5657  26.2%     -  484s
     0     0 74133.0137    0  327 58777.9863 74133.0137  26.1%     -  490s
     0     0 74127.7093    0  335 58777.9863 74127.7093  26.1%     -  493s
     0     0 74126.3775    0  330 58777.9863 74126.3775  26.1%     -  494s
     0     0 74125.1241    0  327 58777.9863 74125.1241  26.1%     -  496s
     0     0 74123.8292    0  332 58777.9863 74123.8292  26.1%     -  497s
     0     0 74111.5870    0  452 58777.9863 74111.5870  26.1%     -  504s
     0     0 74109.0387    0  406 58777.9863 74109.0387  26.1%     -  507s
     0     0 74108.1880    0  334 58777.9863 74108.1880  26.1%     -  509s
     0     0 74104.4115    0  515 58777.9863 74104.4115  26.1%     -  513s
     0     0 74104.3238    0  515 58777.9863 74104.3238  26.1%     -  514s
H    0     0                    59198.060377 74104.1930  25.2%     -  573s
H    0     0                    59209.664685 74104.1930  25.2%     -  573s
H    0     0                    59360.259707 74104.1930  24.8%     -  573s
H    0     0                    59378.654570 74104.1930  24.8%     -  574s
     0     2 74104.1930    0  515 59378.6546 74104.1930  24.8%     -  576s
     1     4 74086.1312    1  334 59378.6546 74104.1920  24.8%  3534  594s
     3     7 73835.8910    2  321 59378.6546 74085.7647  24.8% 10232  614s
     6    14 73638.9564    3  526 59378.6546 73887.9587  24.4% 14230  648s
    13    28 73025.5515    4  514 59378.6546 73638.8507  24.0% 18269  674s
    27    42 71896.3376    5  302 59378.6546 73025.4705  23.0% 23110  731s
    41    74 70322.2205    6  321 59378.6546 73025.4705  23.0% 25460  797s
H   62    74                    59691.756840 73025.4705  22.3% 21506  797s
    73   168 69608.9588    7  245 59691.7568 72738.4943  21.9% 22570  842s
   167   240 69135.7224   10  419 59691.7568 72738.4943  21.9% 15018  870s
H  228   240                    59818.113256 72738.4943  21.6% 12745  870s
   239   309 68806.0021   12  363 59818.1133 72738.4943  21.6% 12638  905s
   308   372 68558.4987   14  400 59818.1133 72738.4943  21.6% 11395  932s
H  319   372                    60038.844428 72738.4943  21.2% 11197  932s
   371   435 68001.9072   16  414 60038.8444 72738.4943  21.2% 10600  962s
H  434   496                    60066.150033 72738.4943  21.1%  9892  985s
H  477   496                    60091.321099 72738.4943  21.0%  9766  985s
   495   555 66176.1803   19  324 60091.3211 72738.4943  21.0%  9707 1005s
   560   580 66022.1863   20  318 60091.3211 72738.4943  21.0%  9323 1031s
   589   621 65992.7963   21  312 60091.3211 72738.4943  21.0%  9273 1048s
H  602   621                    60101.164904 72738.4943  21.0%  9211 1048s
   632   677 65936.5030   22  316 60101.1649 72738.4943  21.0%  9185 1065s
   700   727 65595.0846   25  289 60101.1649 72738.4943  21.0%  8899 1081s
H  708   727                    60165.307676 72738.4943  20.9%  8852 1081s
H  754   727                    60226.267000 72738.4943  20.8%  8662 1081s
   776   780 65228.3101   27  296 60226.2670 72738.4943  20.8%  8610 1098s
   843   837 64855.5245   30  306 60226.2670 72738.4943  20.8%  8492 1115s
   924   854 64782.9464   32  280 60226.2670 72520.2337  20.4%  8257 1132s
   957   892 64652.5521   33  282 60226.2670 72520.2337  20.4%  8127 1148s
  1009   960 64396.8806   34  273 60226.2670 72520.2337  20.4%  8059 1163s
  1109  1033 64266.8200   35  262 60226.2670 72313.9156  20.1%  7737 1181s
  1220  1080 63732.0835   39  112 60226.2670 72313.9156  20.1%  7438 1201s
  1323  1138 62966.3294   42  119 60226.2670 72313.9156  20.1%  7191 1221s
  1401  1204 62547.4599   46  152 60226.2670 72313.9156  20.1%  7174 1242s
  1493  1273 61855.9483   55   79 60226.2670 72313.9156  20.1%  7174 1264s
  1590  1321 61005.2389   63  226 60226.2670 72313.9156  20.1%  7126 1286s
  1670  1384 infeasible   70      60226.2670 72122.0631  19.8%  7077 1311s
  1763  1427 68984.9247   11  250 60226.2670 72122.0631  19.8%  7044 1333s
  1854  1498 67279.7944   13  243 60226.2670 72122.0631  19.8%  6996 1355s
  1953  1599 66421.3726   15  148 60226.2670 72122.0631  19.8%  7014 1379s
  2074  1712 65933.2105   21  138 60226.2670 72122.0631  19.8%  6944 1403s
  2247  1872 65351.4432   30  134 60226.2670 72122.0631  19.8%  6807 1427s
  2443  2023 64771.4515   35   99 60226.2670 72122.0631  19.8%  6619 1454s
  2658  2177 64025.9577   42   84 60226.2670 72122.0631  19.8%  6394 1483s
  2878  2175 63483.1409   50  104 60226.2670 72122.0631  19.8%  6205 1515s
  3066  2186 infeasible   51      60226.2670 71889.1231  19.4%  6137 1546s
  3139  2204 69834.3196    5  267 60226.2670 71889.1231  19.4%  6269 1579s
  3202  2247 68247.5872    7  350 60226.2670 71889.1231  19.4%  6413 1613s
  3275  2301 65903.1264    8  259 60226.2670 71889.1231  19.4%  6597 1645s
  3349  2336 64952.3881   10  302 60226.2670 71889.1231  19.4%  6766 1678s
  3414  2378 64446.8616   11  300 60226.2670 71889.1231  19.4%  6879 1712s
  3524  2453 infeasible   13      60226.2670 71523.7948  18.8%  6941 1749s
  3645  2512 60864.6307   14  181 60226.2670 71523.7133  18.8%  7025 1786s
  3803  2631 69976.6680   10  446 60226.2670 71523.7133  18.8%  7083 1828s
  4013  2695 infeasible   11      60226.2670 71523.7133  18.8%  7060 1868s
  4188  2780 64458.6721   11  193 60226.2670 71523.7133  18.8%  7105 1913s
  4345  2843 infeasible   14      60226.2670 71523.7133  18.8%  7198 1957s
  4512  2915 infeasible   34      60226.2670 70846.6205  17.6%  7277 1996s
  4637  2916 67510.7869   17  515 60226.2670 70718.9698  17.4%  7336 2148s
  4639  2917 66967.4145   19   74 60226.2670 70718.9698  17.4%  7333 2155s
  4640  2918 61490.1644   73  354 60226.2670 70718.9698  17.4%  7332 2201s
  4641  2919 63915.6176   31  279 60226.2670 70718.9698  17.4%  7330 2232s
  4642  2919 63129.0932   16  356 60226.2670 70718.9698  17.4%  7329 2252s
  4643  2920 62875.3782   37  429 60226.2670 70718.9698  17.4%  7327 2275s
  4644  2921 61003.9515   27  382 60226.2670 70718.9698  17.4%  7325 2290s
  4645  2921 61101.4078   25  350 60226.2670 70718.9698  17.4%  7324 2297s
  4646  2922 61683.7296   47  382 60226.2670 70718.9698  17.4%  7322 2309s
  4647  2923 65552.2338   23  356 60226.2670 70718.9698  17.4%  7321 2316s
  4648  2923 66617.2983   15  359 60226.2670 70718.9698  17.4%  7319 2321s
  4649  2924 61708.7338   51  356 60226.2670 70718.9698  17.4%  7317 2328s
  4650  2925 65828.4770   13  368 60226.2670 70718.9698  17.4%  7316 2337s
  4651  2925 63088.2941   17  363 60226.2670 70718.9698  17.4%  7314 2340s
  4652  2926 61214.8166   47  364 60226.2670 70718.9698  17.4%  7313 2345s
  4653  2927 61777.8113   55  503 60226.2670 70718.9698  17.4%  7311 2362s
  4654  2927 69200.9094    9  434 60226.2670 70718.9698  17.4%  7310 2371s
  4656  2929 61385.6968   62  400 60226.2670 70718.9698  17.4%  7306 2378s
  4657  2929 69146.7973    9  399 60226.2670 70718.9698  17.4%  7305 2386s
  4658  2930 66495.1846   19  445 60226.2670 70718.9698  17.4%  7303 2391s
  4659  2931 64610.8726   36  405 60226.2670 70718.9698  17.4%  7302 2397s
  4660  2931 61745.6811   49  504 60226.2670 70718.9698  17.4%  7300 2401s
  4661  2932 69638.6617   11  417 60226.2670 70718.9698  17.4%  7299 2410s
  4662  2933 67989.3701   18  460 60226.2670 70718.9698  17.4%  7297 2417s
  4663  2933 60928.4587   38  459 60226.2670 70718.9698  17.4%  7296 2422s
  4664  2934 62600.3345   25  423 60226.2670 70718.9698  17.4%  7294 2428s
  4665  2935 65190.7694   27  422 60226.2670 70718.9698  17.4%  7292 2431s
  4666  2935 63277.0784   36  324 60226.2670 70718.9698  17.4%  7291 2436s
  4667  2936 61443.3251   76  427 60226.2670 70718.9698  17.4%  7289 2441s
  4668  2937 60918.5515   36  453 60226.2670 70718.9698  17.4%  7288 2452s
  4669  2937 66293.0092   20  463 60226.2670 70718.9698  17.4%  7286 2458s
  4670  2938 63896.4938   15  320 60226.2670 70718.9698  17.4%  7285 2463s
  4671  2939 62488.2332   46  503 60226.2670 70718.9698  17.4%  7283 2468s
  4672  2939 69335.1140   11  490 60226.2670 70718.9698  17.4%  7281 2477s
  4673  2940 65947.9935   22  490 60226.2670 70718.9698  17.4%  7280 2492s
  4674  2941 62429.6446   20  490 60226.2670 70718.9698  17.4%  7278 2540s
  4675  2943 70718.9698   12  464 60226.2670 70718.9698  17.4%  7345 2584s
  4676  2945 70718.9698   13  382 60226.2670 70718.9698  17.4%  7347 2612s
  4678  2949 70718.9698   14  282 60226.2670 70718.9698  17.4%  7347 2646s
  4683  2958 70718.9698   15  333 60226.2670 70718.9698  17.4%  7354 2673s
  4693  2974 70534.7906   16  342 60226.2670 70718.9698  17.4%  7363 2707s
  4713  2980 70718.9698   16  343 60226.2670 70718.9698  17.4%  7404 2753s
  4725  2999 70718.9698   17  270 60226.2670 70718.9698  17.4%  7446 2789s
  4748  3097 70325.4164   18  329 60226.2670 70718.9698  17.4%  7463 2829s
  4854  3109 67685.5350   22  230 60226.2670 70718.9698  17.4%  7517 2853s
  4908  3120 65916.5221   23  210 60226.2670 70718.9698  17.4%  7519 2876s
  4956  3125 65172.9056   24  184 60226.2670 70718.9698  17.4%  7513 2911s
  4987  3142 62905.6032   25  107 60226.2670 70718.9698  17.4%  7514 2932s
  5023  3154 62384.5884   26  177 60226.2670 70718.9698  17.4%  7518 2960s
  5063  3175 62168.7182   27  179 60226.2670 70718.9698  17.4%  7508 2982s
  5117  3176 61670.9223   28  153 60226.2670 70718.9698  17.4%  7477 3003s
  5170  3176 60612.8806   30  108 60226.2670 70718.9698  17.4%  7453 3027s
  5221  3171 60270.0780   35   82 60226.2670 70718.9698  17.4%  7431 3057s
  5284  3163 60847.3553   36   84 60226.2670 70718.9698  17.4%  7397 3081s
  5348  3153 infeasible   41      60226.2670 70718.9698  17.4%  7371 3114s
  5392  3150 67913.3894   20  318 60226.2670 70718.9698  17.4%  7367 3136s
  5445  3151 67390.5187   21  241 60226.2670 70718.9698  17.4%  7356 3157s
  5502  3156 64156.6085   22  241 60226.2670 70718.9698  17.4%  7335 3177s
  5572  3168 62959.1827   24  316 60226.2670 70718.9698  17.4%  7300 3199s
  5640  3180 62934.3014   25  279 60226.2670 70718.9698  17.4%  7271 3222s
  5720  3173 61770.6863   28  282 60226.2670 70718.9698  17.4%  7224 3243s
  5812  3174 61754.6724   29  290 60226.2670 70718.9698  17.4%  7167 3269s
  5907  3165 61028.7080   30  296 60226.2670 70718.9698  17.4%  7113 3292s
  5954  3185 60511.8355   31  272 60226.2670 70718.9698  17.4%  7098 3314s
  6062  3187 60425.1453   32  194 60226.2670 70718.9698  17.4%  7035 3340s
  6169  3191     cutoff   35      60226.2670 70718.9698  17.4%  6981 3367s
  6283  3197 infeasible   20      60226.2670 70718.9698  17.4%  6919 3396s
  6407  3200 67106.7442   18  270 60226.2670 70718.9698  17.4%  6860 3425s
  6539  3204 65871.3944   20  235 60226.2670 70718.9698  17.4%  6788 3455s
  6689  3195 64395.8985   23  307 60226.2670 70718.9698  17.4%  6709 3488s
  6828  3194 63245.3303   24  312 60226.2670 70718.9698  17.4%  6650 3520s
  6978  3164     cutoff   26      60226.2670 69843.3364  16.0%  6587 3558s
  7053  3198     cutoff   27      60226.2670 69843.3364  16.0%  6569 3591s
  7206  3155 62133.5835   26  237 60226.2670 69843.3364  16.0%  6500 3600s

Cutting planes:
  Projected implied bound: 18
  MIR: 583
  Flow cover: 1596
  RLT: 11
  Relax-and-lift: 253

Explored 7274 nodes (47474409 simplex iterations) in 3600.06 seconds (9501.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 60226.3 60165.3 60101.2 ... 59360.3

Time limit reached
Best objective 6.022626699978e+04, best bound 6.984333638903e+04, gap 15.9682%
  WARNING: Time limit reached. Using best solution found (gap: 15.97%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 60226.27, θ = 213526.21
  Upper Bound (UB) = 60226.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 213526.21
  [DEBUG]   ✓ Scenario 0: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 213526.21 ≤ Q = 213526.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x248474
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xffdb7b8c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.532493e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1359 nonzeros
Found heuristic solution: objective 7361238.8374
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.660707e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166070.73    0  127 7361238.84 -166070.73   102%     -    0s
H    0     0                    -132532.5022 -166070.73  25.3%     -    0s
H    0     0                    -133374.1241 -166070.73  24.5%     -    0s
H    0     0                    -139442.7613 -143408.97  2.84%     -    0s
     0     0 -143408.97    0   33 -139442.76 -143408.97  2.84%     -    0s
H    0     0                    -142248.8612 -143403.02  0.81%     -    0s
H    0     0                    -143134.5257 -143403.02  0.19%     -    0s
     0     0 -143308.49    0   12 -143134.53 -143308.49  0.12%     -    0s
     0     0 -143294.04    0   10 -143134.53 -143294.04  0.11%     -    0s
     0     0 -143266.67    0    7 -143134.53 -143266.67  0.09%     -    0s
*    0     0               0    -143175.3282 -143175.33  0.00%     -    0s

Cutting planes:
  Gomory: 12
  MIR: 114
  Flow cover: 2
  RLT: 27

Explored 1 nodes (434 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -143175 -143135 -142249 ... 1.53249e+13
No other solutions better than -143175

Optimal solution found (tolerance 1.00e-04)
Best objective -1.431753281863e+05, best bound -1.431753281863e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 203248.54
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143175.33
  [DEBUG]   S×d_nominal = 346423.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 346423.87 + -143175.33 = 203248.54
  [DEBUG]   Current θ from Master = 213526.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10277.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 49948.60
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = 1415.5014, Absolute Gap = 1415.5014, Relative Gap = 0.023503
  Not converged yet (gap = 1415.50 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567444 nonzeros
Model fingerprint: 0x6ec60b7b
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94536 rows and 38376 columns
Presolve time: 1.59s
Presolved: 105617 rows, 45004 columns, 638541 nonzeros
Variable types: 42745 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -313221.6924
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 592
 AA' NZ     : 4.081e+06
 Factor NZ  : 9.504e+06 (roughly 140 MB of memory)
 Factor Ops : 1.831e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86950157e+07  1.95802863e+08  1.40e+05 1.50e+01  8.53e+04     3s
   1  -1.41213613e+07  1.82380575e+08  9.72e+04 1.04e+02  5.87e+04     3s
   2  -4.77208045e+06  1.42677731e+08  3.29e+04 2.32e+01  2.10e+04     3s
   3  -1.44600837e+06  1.03857297e+08  5.81e+03 7.80e-01  4.07e+03     3s
   4  -6.83695059e+05  6.40399500e+07  8.19e+02 2.41e-01  7.96e+02     3s
   5  -5.26468299e+05  3.31817721e+07  3.13e+02 9.67e-02  3.28e+02     3s
   6  -3.57431887e+05  2.31692703e+07  1.40e+02 5.90e-02  1.84e+02     3s
   7  -3.04893023e+05  1.81248245e+07  8.06e+01 4.34e-02  1.28e+02     3s
   8  -1.75139191e+05  1.32737025e+07  1.38e+01 3.06e-02  7.43e+01     3s
   9  -1.26723610e+05  8.47924809e+06  7.91e+00 1.92e-02  4.64e+01     3s
  10  -8.42859298e+04  3.82692218e+06  4.83e+00 8.07e-03  2.08e+01     3s
  11  -2.78293481e+04  1.10315456e+06  1.18e+00 2.13e-03  5.90e+00     3s
  12   5.61846463e+03  4.30000246e+05  5.87e-01 1.03e-03  2.21e+00     3s
  13   1.92775310e+04  2.67197073e+05  3.80e-01 6.48e-04  1.29e+00     3s
  14   2.58192366e+04  2.19987510e+05  3.09e-01 6.99e-04  1.01e+00     3s
  15   3.49557477e+04  1.80248676e+05  2.50e-01 1.27e-03  7.53e-01     3s
  16   4.44309273e+04  1.55866303e+05  2.01e-01 2.46e-03  5.78e-01     3s
  17   5.20714946e+04  1.36982933e+05  1.61e-01 2.02e-03  4.40e-01     3s
  18   5.86444081e+04  1.23466071e+05  1.29e-01 1.75e-03  3.36e-01     4s
  19   6.11723937e+04  1.19199316e+05  1.17e-01 1.25e-03  3.01e-01     4s
  20   6.65513028e+04  1.12316424e+05  9.22e-02 1.07e-03  2.37e-01     4s
  21   6.96588004e+04  1.06178936e+05  7.86e-02 9.47e-04  1.89e-01     4s
  22   7.34856960e+04  1.00387772e+05  6.27e-02 2.74e-03  1.39e-01     4s
  23   7.66039467e+04  9.80424736e+04  5.00e-02 2.45e-03  1.11e-01     4s
  24   7.90588737e+04  9.61558582e+04  4.02e-02 2.05e-03  8.86e-02     4s
  25   8.19048633e+04  9.42252363e+04  2.91e-02 1.35e-03  6.39e-02     4s
  26   8.39647826e+04  9.34028581e+04  2.10e-02 1.14e-03  4.89e-02     4s
  27   8.54429453e+04  9.19449252e+04  1.51e-02 7.07e-04  3.37e-02     4s
  28   8.63817921e+04  9.12042910e+04  1.17e-02 4.53e-04  2.50e-02     4s
  29   8.68642363e+04  9.09380850e+04  9.94e-03 3.74e-04  2.11e-02     4s
  30   8.70899986e+04  9.07749283e+04  9.13e-03 3.24e-04  1.91e-02     4s
  31   8.77785589e+04  9.05170273e+04  6.71e-03 2.47e-04  1.42e-02     4s
  32   8.83048312e+04  9.03644222e+04  4.80e-03 1.99e-04  1.07e-02     4s
  33   8.85581120e+04  9.02058656e+04  3.88e-03 1.51e-04  8.54e-03     4s
  34   8.89431013e+04  9.01609442e+04  2.50e-03 1.37e-04  6.31e-03     4s
  35   8.90386233e+04  8.99799306e+04  2.16e-03 8.41e-05  4.88e-03     4s
  36   8.91960052e+04  8.99216978e+04  1.60e-03 6.75e-05  3.76e-03     4s
  37   8.94002585e+04  8.98535916e+04  9.00e-04 4.82e-05  2.35e-03     4s
  38   8.94947963e+04  8.98049819e+04  6.01e-04 4.00e-05  1.61e-03     5s
  39   8.95951453e+04  8.97490969e+04  2.71e-04 4.59e-05  7.97e-04     5s
  40   8.96554751e+04  8.97265227e+04  7.71e-05 2.91e-05  3.68e-04     5s
  41   8.96653701e+04  8.97024214e+04  5.13e-05 1.16e-05  1.92e-04     5s
  42   8.96688846e+04  8.96958000e+04  4.26e-05 6.55e-06  1.39e-04     5s
  43   8.96783696e+04  8.96895595e+04  1.86e-05 2.28e-06  5.80e-05     5s
  44   8.96837001e+04  8.96871677e+04  5.18e-06 4.37e-06  1.80e-05     5s
  45   8.96856182e+04  8.96861610e+04  9.88e-07 2.43e-07  2.81e-06     5s
  46   8.96860643e+04  8.96860893e+04  1.73e-08 7.04e-09  1.29e-07     5s
  47   8.96860825e+04  8.96860825e+04  4.18e-11 4.69e-09  5.91e-12     5s

Barrier solved model in 47 iterations and 4.98 seconds (8.99 work units)
Optimal objective 8.96860825e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1352 PPushes remaining with PInf 3.4455739e-07                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1842615e-10      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37282    8.9686082e+04   0.000000e+00   0.000000e+00      7s
   37282    8.9686082e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.33s

Solved with barrier

Root relaxation: objective 8.968608e+04, 37282 iterations, 5.70 seconds (12.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 89686.0825    0  190 -168399.12 89686.0825   153%     -    9s
H    0     0                    -80342.99270 89686.0825   212%     -    9s
H    0     0                    -76262.66062 89686.0825   218%     -    9s
H    0     0                    -75300.59673 89686.0825   219%     -    9s
H    0     0                    -74747.63621 89686.0825   220%     -    9s
H    0     0                    -74743.85409 89686.0825   220%     -    9s
H    0     0                    -29819.71668 89686.0825   401%     -    9s
H    0     0                    38066.949450 89686.0825   136%     -   10s
H    0     0                    39426.011608 89686.0825   127%     -   10s
H    0     0                    50036.101907 89686.0825  79.2%     -   10s
H    0     0                    50979.526953 89686.0825  75.9%     -   10s
H    0     0                    51130.838588 89686.0825  75.4%     -   10s
H    0     0                    51223.961367 89686.0825  75.1%     -   10s
H    0     0                    51312.441868 83686.8367  63.1%     -   48s
H    0     0                    51328.398281 83686.8367  63.0%     -   48s
H    0     0                    51374.011098 83686.8367  62.9%     -   48s
     0     0 83686.8367    0  220 51374.0111 83686.8367  62.9%     -   48s
     0     0 82875.5908    0  222 51374.0111 82875.5908  61.3%     -   66s
     0     0 82724.4001    0  227 51374.0111 82724.4001  61.0%     -   73s
     0     0 82712.5874    0  226 51374.0111 82712.5874  61.0%     -   78s
     0     0 82596.7118    0  221 51374.0111 82596.7118  60.8%     -   85s
     0     0 82596.7118    0  229 51374.0111 82596.7118  60.8%     -   89s
     0     0 82596.7118    0  229 51374.0111 82596.7118  60.8%     -   92s
     0     0 82596.7118    0  219 51374.0111 82596.7118  60.8%     -   94s
     0     0 82560.4479    0  236 51374.0111 82560.4479  60.7%     -  102s
     0     0 82559.6962    0  236 51374.0111 82559.6962  60.7%     -  103s
     0     0 82559.6177    0  236 51374.0111 82559.6177  60.7%     -  103s
H    0     0                    52716.730122 82559.6177  56.6%     -  104s
H    0     0                    55574.304852 82559.6177  48.6%     -  104s
H    0     0                    56268.520936 79959.9054  42.1%     -  141s
H    0     0                    56463.751924 79959.9054  41.6%     -  141s
H    0     0                    56510.104570 79959.9054  41.5%     -  141s
H    0     0                    56703.667414 79959.9054  41.0%     -  141s
H    0     0                    56857.654226 79959.9054  40.6%     -  141s
H    0     0                    56877.244532 79959.9054  40.6%     -  141s
H    0     0                    57011.188537 79959.9054  40.3%     -  141s
H    0     0                    57228.416848 79959.9054  39.7%     -  141s
H    0     0                    57487.009646 79959.9054  39.1%     -  141s
H    0     0                    57638.982345 79959.9054  38.7%     -  141s
H    0     0                    57874.049912 79959.9054  38.2%     -  141s
H    0     0                    57991.536090 79959.9054  37.9%     -  141s
     0     0 79930.1535    0  340 57991.5361 79930.1535  37.8%     -  141s
     0     0 79396.0212    0  364 57991.5361 79396.0212  36.9%     -  172s
H    0     0                    58200.202690 79280.1644  36.2%     -  185s
     0     0 79280.1644    0  360 58200.2027 79280.1644  36.2%     -  185s
     0     0 79126.0317    0  372 58200.2027 79126.0317  36.0%     -  203s
     0     0 79059.4690    0  377 58200.2027 79059.4690  35.8%     -  211s
     0     0 79001.5717    0  377 58200.2027 79001.5717  35.7%     -  220s
     0     0 78976.1712    0  371 58200.2027 78976.1712  35.7%     -  228s
     0     0 78839.2196    0  375 58200.2027 78839.2196  35.5%     -  237s
H    0     0                    58246.881176 78809.7942  35.3%     -  241s
H    0     0                    58254.527118 78809.7942  35.3%     -  241s
     0     0 78809.7942    0  380 58254.5271 78809.7942  35.3%     -  241s
     0     0 78802.8018    0  381 58254.5271 78802.8018  35.3%     -  244s
     0     0 78773.1226    0  381 58254.5271 78773.1226  35.2%     -  248s
     0     0 78768.5887    0  386 58254.5271 78768.5887  35.2%     -  250s
     0     0 78766.9143    0  387 58254.5271 78766.9143  35.2%     -  253s
     0     0 78758.4202    0  381 58254.5271 78758.4202  35.2%     -  255s
     0     0 78736.9406    0  385 58254.5271 78736.9406  35.2%     -  259s
     0     0 78730.7011    0  391 58254.5271 78730.7011  35.1%     -  262s
     0     0 78730.0899    0  384 58254.5271 78730.0899  35.1%     -  264s
H    0     0                    58327.856459 78730.0899  35.0%     -  272s
H    0     0                    58483.898158 76376.6568  30.6%     -  310s
     0     0 76376.6568    0  256 58483.8982 76376.6568  30.6%     -  310s
     0     0 76026.4595    0  345 58483.8982 76026.4595  30.0%     -  330s
     0     0 75947.2991    0  267 58483.8982 75947.2991  29.9%     -  342s
H    0     0                    58627.849041 75866.1892  29.4%     -  350s
     0     0 75866.1892    0  264 58627.8490 75866.1892  29.4%     -  350s
     0     0 75824.7689    0  269 58627.8490 75824.7689  29.3%     -  357s
     0     0 75811.8230    0  383 58627.8490 75811.8230  29.3%     -  363s
     0     0 75796.3724    0  384 58627.8490 75796.3724  29.3%     -  367s
     0     0 75759.7731    0  377 58627.8490 75759.7731  29.2%     -  373s
     0     0 75748.0868    0  271 58627.8490 75748.0868  29.2%     -  377s
     0     0 75743.2142    0  372 58627.8490 75743.2142  29.2%     -  381s
     0     0 75736.9398    0  375 58627.8490 75736.9398  29.2%     -  385s
     0     0 75736.3459    0  373 58627.8490 75736.3459  29.2%     -  387s
     0     0 75209.5087    0  339 58627.8490 75209.5087  28.3%     -  429s
     0     0 75051.7825    0  379 58627.8490 75051.7825  28.0%     -  446s
     0     0 74950.4430    0  361 58627.8490 74950.4430  27.8%     -  457s
     0     0 74916.1968    0  369 58627.8490 74916.1968  27.8%     -  461s
     0     0 74909.9051    0  345 58627.8490 74909.9051  27.8%     -  464s
     0     0 74899.4407    0  308 58627.8490 74899.4407  27.8%     -  467s
     0     0 74875.2085    0  304 58627.8490 74875.2085  27.7%     -  471s
     0     0 74871.5448    0  313 58627.8490 74871.5448  27.7%     -  473s
     0     0 74870.7255    0  372 58627.8490 74870.7255  27.7%     -  475s
     0     0 74732.9151    0  407 58627.8490 74732.9151  27.5%     -  486s
     0     0 74675.3945    0  396 58627.8490 74675.3945  27.4%     -  495s
     0     0 74640.1917    0  402 58627.8490 74640.1917  27.3%     -  502s
     0     0 74635.3555    0  406 58627.8490 74635.3555  27.3%     -  505s
     0     0 74629.0452    0  469 58627.8490 74629.0452  27.3%     -  508s
     0     0 74622.0388    0  400 58627.8490 74622.0388  27.3%     -  510s
     0     0 74619.9501    0  410 58627.8490 74619.9501  27.3%     -  511s
     0     0 74617.8797    0  413 58627.8490 74617.8797  27.3%     -  512s
     0     0 74616.5624    0  389 58627.8490 74616.5624  27.3%     -  513s
     0     0 74534.2653    0  527 58627.8490 74534.2653  27.1%     -  524s
     0     0 74511.0815    0  533 58627.8490 74511.0815  27.1%     -  529s
     0     0 74490.1460    0  545 58627.8490 74490.1460  27.1%     -  535s
     0     0 74484.7623    0  534 58627.8490 74484.7623  27.0%     -  538s
     0     0 74483.1117    0  550 58627.8490 74483.1117  27.0%     -  540s
     0     0 74402.9886    0  511 58627.8490 74402.9886  26.9%     -  554s
     0     0 74388.8484    0  527 58627.8490 74388.8484  26.9%     -  562s
     0     0 74381.0344    0  530 58627.8490 74381.0344  26.9%     -  567s
     0     0 74368.3834    0  531 58627.8490 74368.3834  26.8%     -  573s
     0     0 74363.7443    0  532 58627.8490 74363.7443  26.8%     -  576s
     0     0 74363.2320    0  532 58627.8490 74363.2320  26.8%     -  577s
     0     0 74320.2111    0  532 58627.8490 74320.2111  26.8%     -  587s
     0     0 74305.0905    0  548 58627.8490 74305.0905  26.7%     -  593s
     0     0 74299.8385    0  543 58627.8490 74299.8385  26.7%     -  597s
     0     0 74297.8271    0  556 58627.8490 74297.8271  26.7%     -  599s
     0     0 74296.6377    0  553 58627.8490 74296.6377  26.7%     -  601s
     0     0 74275.9324    0  521 58627.8490 74275.9324  26.7%     -  611s
     0     0 74213.1462    0  528 58627.8490 74213.1462  26.6%     -  624s
     0     0 74181.2328    0  560 58627.8490 74181.2328  26.5%     -  633s
     0     0 74166.5092    0  563 58627.8490 74166.5092  26.5%     -  640s
     0     0 74161.3714    0  565 58627.8490 74161.3714  26.5%     -  644s
     0     0 74160.3792    0  568 58627.8490 74160.3792  26.5%     -  646s
     0     0 74131.9251    0  540 58627.8490 74131.9251  26.4%     -  652s
     0     0 74108.8684    0  559 58627.8490 74108.8684  26.4%     -  659s
     0     0 74102.3034    0  556 58627.8490 74102.3034  26.4%     -  664s
     0     0 74098.1204    0  436 58627.8490 74098.1204  26.4%     -  669s
     0     0 74096.3370    0  565 58627.8490 74096.3370  26.4%     -  672s
     0     0 74084.9426    0  581 58627.8490 74084.9426  26.4%     -  678s
     0     0 74083.0671    0  572 58627.8490 74083.0671  26.4%     -  681s
     0     0 74068.9246    0  554 58627.8490 74068.9246  26.3%     -  687s
     0     0 74059.4941    0  568 58627.8490 74059.4941  26.3%     -  692s
     0     0 74057.9889    0  555 58627.8490 74057.9889  26.3%     -  694s
     0     0 74052.2729    0  573 58627.8490 74052.2729  26.3%     -  700s
     0     0 74051.0157    0  559 58627.8490 74051.0157  26.3%     -  703s
     0     0 74042.4951    0  384 58627.8490 74042.4951  26.3%     -  708s
     0     0 74040.4034    0  551 58627.8490 74040.4034  26.3%     -  728s
     0     0 74038.3331    0  544 58627.8490 74038.3331  26.3%     -  732s
     0     0 74038.2951    0  544 58627.8490 74038.2951  26.3%     -  735s
H    0     0                    58874.520071 74038.2951  25.8%     -  806s
H    0     0                    59102.433392 74038.2951  25.3%     -  807s
H    0     2                    59109.518451 74038.2951  25.3%     -  808s
     0     2 74038.2951    0  544 59109.5185 74038.2951  25.3%     -  808s
     1     3 73573.2991    1  385 59109.5185 74038.2951  25.3% 24597  833s
     2     4 73965.2253    1  513 59109.5185 73965.2253  25.1% 18610  845s
     3     7 72679.9202    2  532 59109.5185 73965.0988  25.1% 14809  860s
     6    13 72330.6633    3  395 59109.5185 73965.0525  25.1% 12769  890s
    12    25 72246.6795    4  390 59109.5185 73815.3301  24.9% 14668  915s
    24    37 72543.9409    4  333 59109.5185 73815.3301  24.9% 19567  967s
    36    68 72131.2694    5  317 59109.5185 72918.7186  23.4% 23325 1050s
H   38    68                    59263.028865 72918.7186  23.0% 22489 1050s
H   45    68                    59301.545367 72918.7186  23.0% 21604 1050s
    67   195 71035.1998    6  266 59301.5454 72918.7186  23.0% 23034 1097s
   194   275 70634.1132   10  238 59301.5454 72918.7186  23.0% 14056 1121s
H  260   275                    59344.975639 72918.7186  22.9% 11723 1121s
H  266   275                    59441.762885 72918.7186  22.7% 11631 1121s
   274   327 69695.0190   12  246 59441.7629 72918.7186  22.7% 11582 1142s
   326   355 69494.2425   13  235 59441.7629 72918.7186  22.7% 10963 1158s
H  354   391                    59513.201446 72918.7186  22.5% 10890 1176s
H  368   391                    59623.601200 72918.7186  22.3% 10680 1176s
   390   416 69357.6043   15  234 59623.6012 72918.7186  22.3% 10658 1194s
H  417   449                    59748.881017 72918.7186  22.0% 10689 1212s
H  441   449                    59830.932667 72918.7186  21.9% 10586 1212s
   450   506 69340.9544   17  225 59830.9327 72918.7186  21.9% 10546 1233s
   509   548 68054.8894   19  194 59830.9327 72918.7186  21.9% 10166 1251s
H  510   548                    59898.390855 72918.7186  21.7% 10146 1251s
H  524   548                    59931.250396 72918.7186  21.7% 10025 1251s
   555   627 67807.7571   20  183 59931.2504 72918.7186  21.7%  9888 1271s
   640   687 66686.9687   22  224 59931.2504 72918.7186  21.7%  9489 1291s
   708   743 infeasible   24      59931.2504 72918.7186  21.7%  9161 1309s
   776   799 63464.2809   24  169 59931.2504 72918.7186  21.7%  8833 1324s
   855   846 62970.8930   28  181 59931.2504 72918.7186  21.7%  8416 1342s
   924   917 61558.9858   30  164 59931.2504 72918.7186  21.7%  8176 1361s
  1033  1007 65020.3223   21  173 59931.2504 72918.7186  21.7%  7840 1380s
  1155  1100 64734.9994   23  172 59931.2504 72918.7186  21.7%  7416 1398s
  1286  1187 66397.0711   19  142 59931.2504 72918.7186  21.7%  7083 1417s
  1437  1242 66354.6635   20  134 59931.2504 72918.7186  21.7%  6714 1435s
  1536  1270 60363.8297   22  108 59931.2504 72918.7186  21.7%  6504 1454s
  1598  1265 infeasible   25      59931.2504 72918.7186  21.7%  6447 1474s
  1677  1286 70368.4829   12  338 59931.2504 72918.7186  21.7%  6438 1495s
  1740  1320 64648.7844   19  176 59931.2504 72918.7186  21.7%  6596 1516s
  1798  1373 70013.2265   13  267 59931.2504 72918.7186  21.7%  6655 1539s
  1879  1476 69782.9191   15  382 59931.2504 72918.7186  21.7%  6718 1561s
  1996  1515 69441.7132   16  322 59931.2504 72918.7186  21.7%  6687 1591s
  2045  1554 60109.3515   27  136 59931.2504 72918.7186  21.7%  6743 1611s
  2086  1608 60073.6355   28  130 59931.2504 72918.7186  21.7%  6758 1640s
  2170  1725 68516.3829   16  240 59931.2504 72918.7186  21.7%  6708 1663s
  2317  1887 67920.9870   17  266 59931.2504 72918.7186  21.7%  6542 1687s
  2521  1926 66669.5177   18  271 59931.2504 72918.7186  21.7%  6317 1713s
  2603  2033 65872.5877   19  326 59931.2504 72918.7186  21.7%  6334 1741s
  2772  2105 65010.7101   20  215 59931.2504 72918.7186  21.7%  6219 1770s
  2932  2169 63301.9943   21  134 59931.2504 72918.7186  21.7%  6209 1801s
  3066  2207 62303.1579   22  106 59931.2504 72918.7186  21.7%  6234 1832s
  3174  2245 70246.8878    8  258 59931.2504 72520.6783  21.0%  6330 1865s
  3258  2310 68488.8205    9  244 59931.2504 72520.6595  21.0%  6491 1902s
  3355  2333 66460.0543   11  233 59931.2504 72520.6595  21.0%  6671 1934s
  3392  2353 65835.7534   12  203 59931.2504 72520.6595  21.0%  6765 1965s
  3450  2378 65092.6360   13  196 59931.2504 72435.4722  20.9%  6811 1999s
  3522  2434 63839.0200   14  232 59931.2504 72435.4722  20.9%  6878 2037s
  3624  2463 63036.6891   15  370 59931.2504 72435.4722  20.9%  6930 2076s
  3756  2498 62613.5457   16  291 59931.2504 72115.9496  20.3%  7006 2116s
  3912  2528 61038.2661   21  318 59931.2504 72115.9496  20.3%  7108 2159s
  4017  2571 60275.0102   26  136 59931.2504 71243.0239  18.9%  7254 2207s
  4120  2621 67309.4381   13  260 59931.2504 71243.0239  18.9%  7447 2252s
  4238  2680 65776.8392   17  222 59931.2504 71243.0239  18.9%  7604 2304s
  4365  2738 infeasible   19      59931.2504 71243.0239  18.9%  7755 2352s
  4495  2834 61997.1652   18  267 59931.2504 71012.5576  18.5%  7908 2401s
  4658  2835 65943.6712   13  544 59931.2504 71012.5576  18.5%  8014 2619s
  4660  2836 64193.4713   15  111 59931.2504 71012.5576  18.5%  8011 2630s
  4661  2837 68052.9418   16  319 59931.2504 71012.5576  18.5%  8009 2694s
  4662  2838 60582.7047   25  298 59931.2504 71012.5576  18.5%  8007 2732s
  4663  2838 61501.3560   36  432 59931.2504 71012.5576  18.5%  8006 2780s
  4664  2839 62380.1407   29  329 59931.2504 71012.5576  18.5%  8004 2801s
  4665  2840 60086.4262   46  427 59931.2504 71012.5576  18.5%  8002 2821s
  4666  2840 62282.8522   42  390 59931.2504 71012.5576  18.5%  8001 2839s
  4667  2841 60834.9386   45  435 59931.2504 71012.5576  18.5%  7999 2854s
  4668  2842 60469.9730   42  407 59931.2504 71012.5576  18.5%  7997 2865s
  4669  2842 64545.6969   19  448 59931.2504 71012.5576  18.5%  7995 2872s
  4670  2843 60964.8624   28  457 59931.2504 71012.5576  18.5%  7994 2880s
  4671  2844 60407.6052   60  460 59931.2504 71012.5576  18.5%  7992 2888s
  4672  2844 68527.7878   10  432 59931.2504 71012.5576  18.5%  7990 2912s
  4673  2845 63315.2983   27  432 59931.2504 71012.5576  18.5%  7989 2927s
  4674  2846 65611.5618   11  316 59931.2504 71012.5576  18.5%  7987 2935s
  4676  2847 61093.7975   36  435 59931.2504 71012.5576  18.5%  7983 2954s
  4677  2848 63634.7275   24  321 59931.2504 71012.5576  18.5%  7982 2958s
  4678  2848 65093.0637   19  320 59931.2504 71012.5576  18.5%  7980 2963s
  4679  2849 69464.4381   12  327 59931.2504 71012.5576  18.5%  7978 2971s
  4680  2850 66939.1084   14  331 59931.2504 71012.5576  18.5%  7977 2978s
  4681  2850 67097.1762   14  318 59931.2504 71012.5576  18.5%  7975 2984s
  4682  2851 62457.6338   45  370 59931.2504 71012.5576  18.5%  7973 2992s
  4683  2852 67400.6796   13  361 59931.2504 71012.5576  18.5%  7972 3001s
  4684  2852 70542.2532   15  420 59931.2504 71012.5576  18.5%  7970 3007s
  4685  2853 69458.9227   13  388 59931.2504 71012.5576  18.5%  7968 3015s
  4687  2854 64569.6331   47  338 59931.2504 71012.5576  18.5%  7965 3023s
  4688  2855 70438.7576   12  339 59931.2504 71012.5576  18.5%  7963 3027s
  4689  2856 65045.9472   12  326 59931.2504 71012.5576  18.5%  7961 3033s
  4690  2856 61835.9018   23  324 59931.2504 71012.5576  18.5%  7960 3039s
  4691  2857 64161.5948   31  474 59931.2504 71012.5576  18.5%  7958 3048s
  4692  2858 64007.1937   56  474 59931.2504 71012.5576  18.5%  7956 3074s
  4693  2858 60172.4067   56  474 59931.2504 71012.5576  18.5%  7955 3133s
  4694  2861 71012.5576   13  378 59931.2504 71012.5576  18.5%  8031 3186s
  4695  2864 71012.5576   14  313 59931.2504 71012.5576  18.5%  8035 3239s
  4698  2869 71012.5576   15  314 59931.2504 71012.5576  18.5%  8038 3295s
  4704  2879 70941.3931   16  253 59931.2504 71012.5576  18.5%  8051 3345s
  4716  2887 70748.0819   16  345 59931.2504 71012.5576  18.5%  8101 3420s
  4728  2915 70393.2566   18  286 59931.2504 71012.5576  18.5%  8149 3546s
  4760  3023 69158.3334   19  289 59931.2504 71012.5576  18.5%  8235 3600s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 64
  MIR: 657
  Mixing: 1
  Flow cover: 1760
  RLT: 24
  Relax-and-lift: 265

Explored 4879 nodes (41086829 simplex iterations) in 3600.06 seconds (9374.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 59931.3 59898.4 59830.9 ... 59263

Time limit reached
Best objective 5.993125039584e+04, best bound 7.101255757433e+04, gap 18.4900%
  WARNING: Time limit reached. Using best solution found (gap: 18.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 59931.25, θ = 216569.39
  Upper Bound (UB) = 59931.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216569.39
  [DEBUG]   ✓ Scenario 0: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216569.39 ≤ Q = 216569.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216569.39 ≤ Q = 216569.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216569.39 ≤ Q = 216569.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216569.39 ≤ Q = 216569.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216569.39 ≤ Q = 216569.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xac95756
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0ac95756
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.533337e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1359 nonzeros
Found heuristic solution: objective 7435583.1733
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.598714e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159871.39    0  123 7435583.17 -159871.39   102%     -    0s
H    0     0                    -127956.3729 -159871.39  24.9%     -    0s
H    0     0                    -128969.1910 -159871.39  24.0%     -    0s
     0     0 -141321.36    0   59 -128969.19 -141321.36  9.58%     -    0s
H    0     0                    -138876.2141 -141228.53  1.69%     -    0s
     0     0 -140257.74    0   71 -138876.21 -140257.74  0.99%     -    0s
H    0     0                    -139497.9695 -140244.76  0.54%     -    0s
H    0     0                    -139835.1193 -140244.76  0.29%     -    0s
     0     0 -140231.11    0   68 -139835.12 -140231.11  0.28%     -    0s
     0     0 -140223.50    0   63 -139835.12 -140223.50  0.28%     -    0s
     0     0 -140222.35    0   63 -139835.12 -140222.35  0.28%     -    0s
     0     0 -140010.58    0   18 -139835.12 -140010.58  0.13%     -    0s
     0     0 -140009.26    0   17 -139835.12 -140009.26  0.12%     -    0s
     0     0 -140005.08    0   14 -139835.12 -140005.08  0.12%     -    0s
H    0     0                    -139861.3687 -140005.08  0.10%     -    0s
     0     0 -139961.77    0   14 -139861.37 -139961.77  0.07%     -    0s
     0     0 -139957.41    0   14 -139861.37 -139957.41  0.07%     -    0s
     0     0 -139955.58    0   14 -139861.37 -139955.58  0.07%     -    0s
     0     0 -139954.81    0   14 -139861.37 -139954.81  0.07%     -    0s
     0     0 -139952.51    0   14 -139861.37 -139952.51  0.07%     -    0s
     0     0 -139951.42    0   14 -139861.37 -139951.42  0.06%     -    0s
     0     0 -139951.04    0   14 -139861.37 -139951.04  0.06%     -    0s
     0     0 -139928.58    0    9 -139861.37 -139928.58  0.05%     -    0s
     0     0 -139928.58    0   14 -139861.37 -139928.58  0.05%     -    0s
H    0     0                    -139885.4250 -139928.58  0.03%     -    0s
     0     0          -    0      -139885.43 -139895.23  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 3
  MIR: 8
  Flow cover: 3
  RLT: 3
  Relax-and-lift: 1

Explored 1 nodes (656 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139885 -139861 -139835 ... 1.53334e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.398854250341e+05, best bound -1.398952310377e+05, gap 0.0070%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 206817.80
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139885.43
  [DEBUG]   S×d_nominal = 346703.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 346703.23 + -139885.43 = 206817.80
  [DEBUG]   Current θ from Master = 216569.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9751.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 50179.66
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = 1120.4847, Absolute Gap = 1120.4847, Relative Gap = 0.018696
  Not converged yet (gap = 1120.48 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610669 nonzeros
Model fingerprint: 0xdd749116
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101808 rows and 41328 columns
Presolve time: 2.00s
Presolved: 113635 rows, 48292 columns, 686563 nonzeros
Variable types: 46033 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -319596.4432
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 593
 AA' NZ     : 4.614e+06
 Factor NZ  : 1.084e+07 (roughly 150 MB of memory)
 Factor Ops : 2.189e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.93345778e+07  2.08842593e+08  1.44e+05 1.46e+01  8.77e+04     3s
   1  -1.46758879e+07  1.95619083e+08  1.01e+05 1.04e+02  6.06e+04     3s
   2  -5.14888119e+06  1.54339275e+08  3.54e+04 7.75e+00  2.26e+04     3s
   3  -1.56890477e+06  1.16959606e+08  6.54e+03 1.14e+00  4.52e+03     4s
   4  -7.03023065e+05  8.62965585e+07  8.63e+02 5.03e-01  9.14e+02     4s
   5  -5.91980657e+05  4.11658013e+07  3.63e+02 1.81e-01  3.81e+02     4s
   6  -3.54128772e+05  2.91191291e+07  1.00e+02 1.20e-01  1.87e+02     4s
   7  -3.20924848e+05  2.25570176e+07  6.03e+01 8.96e-02  1.35e+02     4s
   8  -1.86010970e+05  1.34965637e+07  6.27e+00 4.97e-02  6.77e+01     4s
   9  -1.49572080e+05  8.06384651e+06  4.02e+00 2.92e-02  4.03e+01     4s
  10  -9.87218984e+04  3.28239552e+06  2.33e+00 1.11e-02  1.65e+01     4s
  11  -3.11268763e+04  1.44592183e+06  7.14e-01 4.64e-03  7.13e+00     4s
  12   4.22697980e+03  7.97552697e+05  3.05e-01 2.41e-03  3.82e+00     4s
  13   1.28721033e+04  4.35972445e+05  2.20e-01 1.33e-03  2.04e+00     4s
  14   2.58590552e+04  2.69486814e+05  1.36e-01 8.64e-04  1.17e+00     4s
  15   3.19090789e+04  2.05838224e+05  1.11e-01 1.79e-03  8.37e-01     4s
  16   4.66957569e+04  1.79164924e+05  6.78e-02 9.57e-04  6.37e-01     4s
  17   5.25183763e+04  1.61806774e+05  5.65e-02 1.06e-03  5.26e-01     4s
  18   6.06192337e+04  1.44678451e+05  3.99e-02 1.26e-03  4.04e-01     4s
  19   6.37474807e+04  1.33192871e+05  3.46e-02 1.03e-03  3.34e-01     4s
  20   6.89693859e+04  1.25309138e+05  2.61e-02 8.60e-04  2.71e-01     4s
  21   7.30131530e+04  1.18900117e+05  2.00e-02 7.21e-04  2.21e-01     4s
  22   7.75897868e+04  1.09276761e+05  1.38e-02 4.95e-04  1.52e-01     4s
  23   7.85926046e+04  1.02326201e+05  1.26e-02 3.21e-04  1.14e-01     4s
  24   8.05681802e+04  9.94690790e+04  1.03e-02 2.49e-04  9.09e-02     4s
  25   8.28207433e+04  9.68996472e+04  7.68e-03 1.78e-04  6.77e-02     5s
  26   8.40036855e+04  9.49304990e+04  6.30e-03 1.29e-04  5.26e-02     5s
  27   8.57994004e+04  9.33422048e+04  4.31e-03 1.21e-04  3.63e-02     5s
  28   8.67902162e+04  9.19186713e+04  3.19e-03 7.79e-05  2.47e-02     5s
  29   8.78250067e+04  9.11931033e+04  2.07e-03 1.10e-04  1.62e-02     5s
  30   8.80173500e+04  9.07851163e+04  1.86e-03 7.65e-05  1.33e-02     5s
  31   8.87660782e+04  9.04468010e+04  1.10e-03 4.81e-05  8.09e-03     5s
  32   8.92036337e+04  9.02000886e+04  6.65e-04 2.51e-05  4.79e-03     5s
  33   8.94085331e+04  9.01177973e+04  4.61e-04 1.78e-05  3.41e-03     5s
  34   8.94594859e+04  9.00954437e+04  4.14e-04 1.58e-05  3.06e-03     5s
  35   8.95548985e+04  9.00452548e+04  3.24e-04 1.17e-05  2.36e-03     5s
  36   8.96028606e+04  9.00028669e+04  2.77e-04 8.23e-06  1.92e-03     5s
  37   8.97067631e+04  8.99969182e+04  1.79e-04 7.70e-06  1.40e-03     5s
  38   8.98108182e+04  8.99813618e+04  7.90e-05 6.39e-06  8.20e-04     5s
  39   8.98774309e+04  8.99140602e+04  1.72e-05 8.72e-07  1.76e-04     5s
  40   8.98923943e+04  8.99061597e+04  7.27e-06 1.99e-07  6.62e-05     5s
  41   8.98993588e+04  8.99041596e+04  2.43e-06 3.57e-08  2.31e-05     6s
  42   8.99035336e+04  8.99036031e+04  1.09e-08 3.04e-09  3.34e-07     6s
  43   8.99035544e+04  8.99035551e+04  2.11e-09 3.35e-09  3.08e-09     6s

Barrier solved model in 43 iterations and 5.66 seconds (10.06 work units)
Optimal objective 8.99035544e+04


Root crossover log...

  100173 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

   18335 PPushes remaining with PInf 7.6404762e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6771033e+05     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66158    8.9903555e+04   0.000000e+00   1.677103e+05     10s
   66347    8.9903555e+04   0.000000e+00   1.138425e+04     10s
   67693    8.9903555e+04   0.000000e+00   0.000000e+00     11s
   67693    8.9903555e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.42s

Solved with barrier

Root relaxation: objective 8.990355e+04, 67693 iterations, 9.14 seconds (21.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 89903.5549    0  190 -168399.12 89903.5549   153%     -   12s
H    0     0                    -164665.9710 89903.5549   155%     -   12s
H    0     0                    -161236.6997 89903.5549   156%     -   12s
H    0     0                    -155131.6872 89903.5549   158%     -   12s
H    0     0                    -34618.20690 89903.5549   360%     -   12s
H    0     0                    25322.140216 89903.5549   255%     -   13s
H    0     0                    44039.489951 89903.5549   104%     -   13s
H    0     0                    48353.424274 89903.5549  85.9%     -   13s
H    0     0                    48487.368279 89903.5549  85.4%     -   13s
H    0     0                    48693.799080 89903.5549  84.6%     -   13s
H    0     0                    48712.058519 89903.5549  84.6%     -   13s
H    0     0                    50122.180819 83926.1150  67.4%     -   53s
H    0     0                    50293.769938 83926.1150  66.9%     -   53s
H    0     0                    50709.654980 83926.1150  65.5%     -   53s
     0     0 83909.4787    0  187 50709.6550 83909.4787  65.5%     -   53s
     0     0 82829.1351    0  182 50709.6550 82829.1351  63.3%     -   80s
     0     0 82787.9946    0  185 50709.6550 82787.9946  63.3%     -   86s
     0     0 82706.7188    0  185 50709.6550 82706.7188  63.1%     -   90s
     0     0 82513.3812    0  177 50709.6550 82513.3812  62.7%     -   99s
     0     0 82414.7389    0  170 50709.6550 82414.7389  62.5%     -  108s
     0     0 82414.7389    0  178 50709.6550 82414.7389  62.5%     -  115s
     0     0 82414.7389    0  183 50709.6550 82414.7389  62.5%     -  125s
     0     0 82414.7389    0  182 50709.6550 82414.7389  62.5%     -  126s
     0     0 79710.2140    0  187 50709.6550 79710.2140  57.2%     -  133s
     0     0 79708.7911    0  187 50709.6550 79708.7911  57.2%     -  134s
     0     0 79708.7911    0  185 50709.6550 79708.7911  57.2%     -  136s
     0     0 79708.7911    0  190 50709.6550 79708.7911  57.2%     -  137s
     0     0 79708.7911    0  190 50709.6550 79708.7911  57.2%     -  137s
     0     0 79488.5142    0  342 50709.6550 79488.5142  56.8%     -  172s
H    0     0                    57032.095023 79488.2946  39.4%     -  172s
H    0     0                    57380.999236 79488.2946  38.5%     -  172s
H    0     0                    58153.943203 79488.2946  36.7%     -  172s
H    0     0                    58311.932965 79488.2946  36.3%     -  172s
     0     0 78838.8625    0  401 58311.9330 78838.8625  35.2%     -  212s
     0     0 78691.8858    0  400 58311.9330 78691.8858  34.9%     -  230s
     0     0 78639.2373    0  406 58311.9330 78639.2373  34.9%     -  239s
     0     0 78540.8603    0  362 58311.9330 78540.8603  34.7%     -  248s
     0     0 78532.1432    0  358 58311.9330 78532.1432  34.7%     -  252s
     0     0 78517.0725    0  358 58311.9330 78517.0725  34.7%     -  257s
     0     0 78457.1928    0  355 58311.9330 78457.1928  34.5%     -  267s
     0     0 78441.8849    0  357 58311.9330 78441.8849  34.5%     -  272s
     0     0 78406.9986    0  356 58311.9330 78406.9986  34.5%     -  281s
     0     0 78386.6179    0  352 58311.9330 78386.6179  34.4%     -  287s
     0     0 78377.3308    0  356 58311.9330 78377.3308  34.4%     -  291s
     0     0 78239.9961    0  364 58311.9330 78239.9961  34.2%     -  303s
     0     0 78211.0911    0  366 58311.9330 78211.0911  34.1%     -  307s
     0     0 78205.3339    0  345 58311.9330 78205.3339  34.1%     -  310s
     0     0 78204.2781    0  370 58311.9330 78204.2781  34.1%     -  312s
     0     0 76489.2572    0  269 58311.9330 76489.2572  31.2%     -  373s
     0     0 76075.8025    0  343 58311.9330 76075.8025  30.5%     -  397s
     0     0 75956.9410    0  328 58311.9330 75956.9410  30.3%     -  412s
H    0     0                    58500.452094 75867.2478  29.7%     -  426s
     0     0 75867.2478    0  353 58500.4521 75867.2478  29.7%     -  426s
     0     0 75845.1614    0  428 58500.4521 75845.1614  29.6%     -  434s
     0     0 75829.5262    0  356 58500.4521 75829.5262  29.6%     -  441s
     0     0 75800.9134    0  362 58500.4521 75800.9134  29.6%     -  447s
     0     0 75793.3361    0  333 58500.4521 75793.3361  29.6%     -  449s
     0     0 75762.7814    0  276 58500.4521 75762.7814  29.5%     -  452s
     0     0 75743.1767    0  267 58500.4521 75743.1767  29.5%     -  454s
     0     0 75712.5948    0  272 58500.4521 75712.5948  29.4%     -  458s
     0     0 75697.6026    0  335 58500.4521 75697.6026  29.4%     -  465s
     0     0 75694.9653    0  281 58500.4521 75694.9653  29.4%     -  466s
     0     0 75682.5676    0  370 58500.4521 75682.5676  29.4%     -  471s
     0     0 75679.6329    0  290 58500.4521 75679.6329  29.4%     -  474s
     0     0 75678.7899    0  371 58500.4521 75678.7899  29.4%     -  475s
H    0     0                    58516.145902 74757.0655  27.8%     -  519s
     0     0 74757.0655    0  278 58516.1459 74757.0655  27.8%     -  519s
     0     0 74607.7237    0  409 58516.1459 74607.7237  27.5%     -  528s
     0     0 74559.7594    0  415 58516.1459 74559.7594  27.4%     -  536s
     0     0 74557.2083    0  419 58516.1459 74557.2083  27.4%     -  538s
     0     0 74547.6768    0  414 58516.1459 74547.6768  27.4%     -  541s
     0     0 74534.5010    0  414 58516.1459 74534.5010  27.4%     -  544s
     0     0 74522.6478    0  372 58516.1459 74522.6478  27.4%     -  548s
     0     0 74515.4186    0  371 58516.1459 74515.4186  27.3%     -  551s
     0     0 74512.9757    0  369 58516.1459 74512.9757  27.3%     -  554s
     0     0 74510.0915    0  369 58516.1459 74510.0915  27.3%     -  555s
     0     0 74508.7511    0  371 58516.1459 74508.7511  27.3%     -  556s
     0     0 74417.1335    0  490 58516.1459 74417.1335  27.2%     -  569s
     0     0 74409.7054    0  496 58516.1459 74409.7054  27.2%     -  576s
     0     0 74406.4023    0  497 58516.1459 74406.4023  27.2%     -  578s
     0     0 74401.4197    0  460 58516.1459 74401.4197  27.1%     -  583s
     0     0 74398.9743    0  430 58516.1459 74398.9743  27.1%     -  586s
     0     0 74397.1840    0  434 58516.1459 74397.1840  27.1%     -  589s
     0     0 74362.0169    0  395 58516.1459 74362.0169  27.1%     -  598s
     0     0 74350.8638    0  366 58516.1459 74350.8638  27.1%     -  610s
     0     0 74347.9265    0  415 58516.1459 74347.9265  27.1%     -  614s
     0     0 74346.9926    0  422 58516.1459 74346.9926  27.1%     -  615s
     0     0 74338.2403    0  411 58516.1459 74338.2403  27.0%     -  621s
     0     0 74336.3698    0  281 58516.1459 74336.3698  27.0%     -  623s
     0     0 74326.9043    0  309 58516.1459 74326.9043  27.0%     -  627s
     0     0 74323.2990    0  306 58516.1459 74323.2990  27.0%     -  633s
     0     0 74321.2328    0  303 58516.1459 74321.2328  27.0%     -  635s
     0     0 74318.8197    0  361 58516.1459 74318.8197  27.0%     -  638s
     0     0 74317.1915    0  359 58516.1459 74317.1915  27.0%     -  640s
     0     0 74309.3097    0  429 58516.1459 74309.3097  27.0%     -  644s
     0     0 74304.3777    0  412 58516.1459 74304.3777  27.0%     -  647s
     0     0 74303.3988    0  408 58516.1459 74303.3988  27.0%     -  648s
     0     0 74301.2721    0  311 58516.1459 74301.2721  27.0%     -  650s
     0     0 74300.6956    0  311 58516.1459 74300.6956  27.0%     -  655s
     0     0 74296.6932    0  320 58516.1459 74296.6932  27.0%     -  658s
     0     0 74295.4808    0  320 58516.1459 74295.4808  27.0%     -  660s
H    0     0                    58569.871021 74295.4808  26.8%     -  751s
     0     2 74295.4808    0  320 58569.8710 74295.4808  26.8%     -  753s
     1     3 73903.1000    1  489 58569.8710 74295.4808  26.8% 16105  769s
     2     4 74027.6020    1  288 58569.8710 74027.6020  26.4% 12351  779s
     3     6 73433.2197    2  506 58569.8710 74027.1632  26.4% 12637  797s
     5    10 72588.0330    3  251 58569.8710 74027.1632  26.4% 14226  815s
     9    19 72366.8639    4  253 58569.8710 73433.0752  25.4% 12890  839s
    18    38 72178.2488    5  438 58569.8710 73043.4396  24.7% 13776  864s
    37    51 72448.2610    5  288 58569.8710 73004.9576  24.6% 17890  942s
    50    76 71138.1482    6  275 58569.8710 73004.9576  24.6% 19892  981s
    75   111 70847.6433    7  268 58569.8710 73004.9576  24.6% 17014 1034s
H   77   111                    58623.878619 73004.9576  24.5% 16708 1034s
H   80   111                    58636.508335 73004.9576  24.5% 16552 1034s
H  100   111                    58736.134767 73004.9576  24.3% 16799 1034s
H  104   111                    58813.581574 73004.9576  24.1% 16615 1034s
   110   230 70781.7889    8  241 58813.5816 73004.9576  24.1% 16542 1075s
   229   298 70375.6402   12  257 58813.5816 73004.9576  24.1% 11126 1099s
   297   327 70073.0643   14  243 58813.5816 73004.9576  24.1%  9927 1124s
   328   357 69048.0639   15  231 58813.5816 73004.9576  24.1%  9738 1146s
   358   392 68857.9140   16  384 58813.5816 73004.9576  24.1%  9608 1166s
   393   426 68849.8695   17  384 58813.5816 73004.9576  24.1%  9845 1187s
   427   461 68826.5582   18  387 58813.5816 73004.9576  24.1%  9468 1208s
   462   495 68691.5953   19  379 58813.5816 73004.9576  24.1%  9113 1227s
   496   530 68395.0927   20  377 58813.5816 73004.9576  24.1%  8862 1249s
   531   567 67729.7012   21  213 58813.5816 73004.9576  24.1%  8615 1272s
   568   605 67586.8464   22  212 58813.5816 73004.9576  24.1%  8387 1294s
   608   649 67510.6099   23  212 58813.5816 73004.9576  24.1%  8115 1314s
H  615   649                    59190.063034 73004.9576  23.3%  8069 1314s
   652   736 67398.5845   24  203 59190.0630 73004.9576  23.3%  7884 1337s
   739   811 65372.6510   27  224 59190.0630 73004.9576  23.3%  7554 1358s
   820   895 65349.7996   28  231 59190.0630 73004.9576  23.3%  7192 1378s
   910   964 64956.5383   34  250 59190.0630 73004.9576  23.3%  6830 1402s
   995  1021 64449.9866   40  189 59190.0630 73004.9576  23.3%  6557 1433s
  1068  1104 63353.8161   42  177 59190.0630 73004.9576  23.3%  6401 1457s
  1181  1190 61755.4930   49  112 59190.0630 73004.9576  23.3%  6064 1483s
  1295  1267 61429.5532   57   91 59190.0630 73004.9576  23.3%  5779 1508s
  1428  1319 60219.8361   65   86 59190.0630 73004.9576  23.3%  5462 1534s
  1542  1340 68654.5434   19  218 59190.0630 73004.9576  23.3%  5307 1562s
H 1635  1363                    59759.538309 73004.9576  22.2%  5256 1589s
  1670  1399 68350.0661   21  216 59759.5383 73004.9576  22.2%  5337 1620s
  1734  1433 63320.6926   25  178 59759.5383 73004.9576  22.2%  5401 1653s
  1798  1466 68055.9845   21  309 59759.5383 73004.9576  22.2%  5409 1687s
  1867  1490 60109.2906   25  209 59759.5383 73004.9576  22.2%  5482 1722s
  1931  1532 65751.8552   20  274 59759.5383 73004.9576  22.2%  5535 1760s
  1995  1571 64552.2755   21  198 59759.5383 73004.9576  22.2%  5610 1800s
  2058  1618 64355.2166   22  194 59759.5383 73004.9576  22.2%  5636 1839s
  2155  1704 63630.2990   24  196 59759.5383 73004.9576  22.2%  5633 1879s
  2253  1792 62814.8919   25  183 59759.5383 73004.9576  22.2%  5629 1920s
  2393  1843 61792.0518   29  169 59759.5383 73004.9576  22.2%  5554 1962s
  2540  1896 61303.4446   33  294 59759.5383 73004.9576  22.2%  5501 2007s
  2704  1917 60140.9021   37  178 59759.5383 72505.7898  21.3%  5420 2041s
  2745  1942 60031.3875   38  216 59759.5383 72502.7270  21.3%  5474 2082s
  2788  1974 59847.0142   39  218 59759.5383 72502.7270  21.3%  5518 2120s
  2850  2002 59814.4765   40   74 59759.5383 72502.7270  21.3%  5530 2161s
H 2865  1985                    59932.414922 72502.7270  21.0%  5572 2161s
H 2868  1985                    59956.318635 72502.7270  20.9%  5580 2161s
  2882  2066     cutoff   41      59956.3186 72502.7270  20.9%  5595 2213s
  3023  2139 67057.6208   12  197 59956.3186 72502.7270  20.9%  5583 2265s
  3148  2222 63521.8692   14  320 59956.3186 72502.7270  20.9%  5606 2321s
  3325  2329 61100.8401   17  245 59956.3186 72502.7270  20.9%  5580 2377s
  3537  2378 60795.8374   45   82 59956.3186 71759.5023  19.7%  5518 2420s
H 3538  2378                    59976.023750 71759.5023  19.6%  5516 2421s
H 3593  2374                    60019.511436 71759.5023  19.6%  5507 2421s
  3612  2456     cutoff   46      60019.5114 71759.5023  19.6%  5526 2483s
  3781  2536 65395.1718   12  172 60019.5114 71759.5023  19.6%  5548 2543s
  3976  2600     cutoff   16      60019.5114 71759.5023  19.6%  5520 2606s
  4183  2638 60808.2668   16  172 60019.5114 71277.6090  18.8%  5522 2666s
  4291  2701 67017.2028   16  156 60019.5114 71277.6090  18.8%  5513 2727s
  4418  2732 61330.6185   21  152 60019.5114 71277.6090  18.8%  5521 2792s
  4581  2775 62062.3106   21  167 60019.5114 71231.4813  18.7%  5553 2867s
  4716  2802 61799.2001   48  259 60019.5114 71052.7765  18.4%  5600 2940s
  4843  2853 62466.7406   19  233 60019.5114 71051.0469  18.4%  5622 3036s
  4998  2960     cutoff   13      60019.5114 70982.0514  18.3%  5708 3124s
  5212  2961 69378.4908   16  320 60019.5114 70982.0514  18.3%  5745 3331s
  5214  2962 65297.5007   26  111 60019.5114 70982.0514  18.3%  5743 3341s
  5215  2963 62059.5620   44  338 60019.5114 70982.0514  18.3%  5742 3410s
  5216  2964 61115.9419   40  265 60019.5114 70982.0514  18.3%  5741 3447s
  5217  2964 67948.6568   17  302 60019.5114 70982.0514  18.3%  5740 3477s
  5218  2965 63524.6813   18  291 60019.5114 70982.0514  18.3%  5739 3496s
  5219  2966 62264.2217   19  397 60019.5114 70982.0514  18.3%  5737 3526s
  5220  2966 62559.9716   13  350 60019.5114 70982.0514  18.3%  5736 3547s
  5221  2967 62112.4200   37  426 60019.5114 70982.0514  18.3%  5735 3564s
  5222  2968 70489.5329   14  414 60019.5114 70982.0514  18.3%  5734 3574s
  5223  2968 61680.0653   20  346 60019.5114 70982.0514  18.3%  5733 3584s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 315
  Mixing: 3
  Flow cover: 616
  RLT: 10
  Relax-and-lift: 98

Explored 5223 nodes (30882357 simplex iterations) in 3600.11 seconds (9140.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 60019.5 59976 59956.3 ... 58569.9

Time limit reached
Best objective 6.001951143581e+04, best bound 7.098205143602e+04, gap 18.2650%
  WARNING: Time limit reached. Using best solution found (gap: 18.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 60019.51, θ = 213990.78
  Upper Bound (UB) = 60019.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 213990.78
  [DEBUG]   ✓ Scenario 0: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 213990.78 ≤ Q = 213990.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 213990.78 ≤ Q = 213990.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 213990.78 ≤ Q = 213990.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 213990.78 ≤ Q = 213990.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 213990.78 ≤ Q = 214535.27 (slack: 544.48)
  [DEBUG]   ✓ Scenario 12: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 213990.78 ≤ Q = 213990.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5e7027c4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5e7027c4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.533000e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1359 nonzeros
Found heuristic solution: objective 7356652.4753
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.645279e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164527.89    0  126 7356652.48 -164527.89   102%     -    0s
H    0     0                    -128299.8493 -164527.89  28.2%     -    0s
H    0     0                    -130229.4040 -164527.89  26.3%     -    0s
H    0     0                    -131102.0089 -143393.87  9.38%     -    0s
H    0     0                    -139061.6535 -143393.87  3.12%     -    0s
     0     0 -143393.87    0   65 -139061.65 -143393.87  3.12%     -    0s
H    0     0                    -140260.8099 -143277.50  2.15%     -    0s
H    0     0                    -140940.1677 -143277.50  1.66%     -    0s
H    0     0                    -141254.3499 -143277.50  1.43%     -    0s
H    0     0                    -141933.7077 -143277.50  0.95%     -    0s
     0     0 -143251.99    0   58 -141933.71 -143251.99  0.93%     -    0s
     0     0 -143204.30    0   63 -141933.71 -143204.30  0.90%     -    0s
     0     0 -143201.14    0   63 -141933.71 -143201.14  0.89%     -    0s
     0     0 -142188.93    0   34 -141933.71 -142188.93  0.18%     -    0s
     0     0 -142188.01    0   34 -141933.71 -142188.01  0.18%     -    0s
     0     0 -142176.06    0   34 -141933.71 -142176.06  0.17%     -    0s
     0     0 -142008.77    0   15 -141933.71 -142008.77  0.05%     -    0s
     0     0 -142008.77    0   12 -141933.71 -142008.77  0.05%     -    0s
     0     0 -141968.29    0    5 -141933.71 -141968.29  0.02%     -    0s
     0     0 -141966.92    0    4 -141933.71 -141966.92  0.02%     -    0s
H    0     0                    -141966.0052 -141966.04  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 6
  Flow cover: 8

Explored 1 nodes (614 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -141966 -141934 -141693 ... 1.533e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.419660051592e+05, best bound -1.419660365429e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 205185.20
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141966.01
  [DEBUG]   S×d_nominal = 347151.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 347151.20 + -141966.01 = 205185.20
  [DEBUG]   Current θ from Master = 213990.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8805.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 51213.92
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = 1208.7458, Absolute Gap = 1208.7458, Relative Gap = 0.020139
  Not converged yet (gap = 1208.75 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653894 nonzeros
Model fingerprint: 0x4c475239
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 109080 rows and 44280 columns
Presolve time: 2.09s
Presolved: 121653 rows, 51580 columns, 749691 nonzeros
Variable types: 49321 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.09s

Barrier statistics:
 Dense cols : 608
 AA' NZ     : 5.756e+06
 Factor NZ  : 1.260e+07 (roughly 170 MB of memory)
 Factor Ops : 2.666e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.99706887e+07  2.22426121e+08  1.50e+05 1.42e+01  9.02e+04     4s
   1  -1.51682937e+07  2.08173652e+08  1.05e+05 1.01e+02  6.27e+04     4s
   2  -4.77209487e+06  1.62015045e+08  3.31e+04 2.38e+01  2.09e+04     4s
   3  -1.65870028e+06  1.21799530e+08  6.67e+03 1.69e+00  4.66e+03     5s
   4  -7.67865093e+05  8.63950218e+07  8.53e+02 3.60e-01  8.89e+02     5s
   5  -6.93153737e+05  4.18434719e+07  4.28e+02 1.28e-01  4.09e+02     5s
   6  -5.80110841e+05  3.61875752e+07  1.22e+02 9.46e-02  2.25e+02     5s
   7  -3.36523006e+05  2.46410994e+07  5.09e+01 2.44e-02  1.34e+02     5s
   8  -3.19020972e+05  1.65656161e+07  2.70e+01 2.89e-02  8.52e+01     5s
   9  -2.28017695e+05  1.16435594e+07  1.49e+01 1.07e-02  5.73e+01     5s
  10  -1.64324832e+05  6.21634961e+06  7.82e+00 5.43e-03  3.00e+01     5s
  11  -1.08056014e+05  2.15371149e+06  3.57e+00 1.76e-03  1.04e+01     5s
  12  -5.51187525e+04  1.06679821e+06  1.31e+00 8.26e-04  5.09e+00     5s
  13  -3.45353502e+04  7.39122351e+05  8.80e-01 5.73e-04  3.50e+00     5s
  14   1.52104119e+03  4.29877021e+05  3.66e-01 4.09e-04  1.93e+00     5s
  15   2.96207458e+04  2.77371795e+05  1.74e-01 3.79e-04  1.12e+00     5s
  16   4.05990028e+04  1.81228053e+05  1.34e-01 1.74e-03  6.34e-01     5s
  17   4.75878520e+04  1.65879421e+05  1.12e-01 1.45e-03  5.33e-01     5s
  18   5.30217093e+04  1.45071837e+05  9.36e-02 1.95e-03  4.15e-01     5s
  19   5.87486567e+04  1.28252593e+05  7.60e-02 1.21e-03  3.13e-01     5s
  20   6.39102819e+04  1.16625504e+05  6.04e-02 2.47e-03  2.38e-01     5s
  21   6.99463414e+04  1.07214380e+05  4.38e-02 2.95e-03  1.68e-01     5s
  22   7.35300292e+04  9.99196731e+04  3.43e-02 1.82e-03  1.19e-01     5s
  23   7.68510729e+04  9.76350758e+04  2.61e-02 1.46e-03  9.38e-02     6s
  24   7.90081240e+04  9.43487342e+04  2.06e-02 9.60e-04  6.92e-02     6s
  25   8.07206321e+04  9.27137224e+04  1.66e-02 7.01e-04  5.41e-02     6s
  26   8.28003151e+04  9.17292713e+04  1.17e-02 5.51e-04  4.03e-02     6s
  27   8.34345628e+04  9.08572753e+04  1.03e-02 4.09e-04  3.35e-02     6s
  28   8.45523512e+04  9.01735130e+04  7.90e-03 2.98e-04  2.54e-02     6s
  29   8.51519536e+04  8.99741436e+04  6.54e-03 2.66e-04  2.18e-02     6s
  30   8.57266269e+04  8.92972969e+04  5.24e-03 1.64e-04  1.61e-02     6s
  31   8.62088599e+04  8.88803766e+04  4.15e-03 1.00e-04  1.21e-02     6s
  32   8.67858286e+04  8.87726920e+04  2.91e-03 8.39e-05  8.97e-03     6s
  33   8.71736366e+04  8.85247395e+04  2.06e-03 4.58e-05  6.10e-03     6s
  34   8.74301269e+04  8.84171714e+04  1.53e-03 4.31e-05  4.46e-03     6s
  35   8.76187156e+04  8.83365660e+04  1.15e-03 2.55e-05  3.24e-03     6s
  36   8.76739083e+04  8.83279417e+04  1.04e-03 2.39e-05  2.95e-03     6s
  37   8.78933502e+04  8.83095070e+04  5.98e-04 1.99e-05  1.88e-03     6s
  38   8.80123380e+04  8.82493178e+04  3.74e-04 7.02e-06  1.07e-03     7s
  39   8.81435988e+04  8.82322432e+04  1.20e-04 3.60e-06  4.00e-04     7s
  40   8.81772443e+04  8.82204891e+04  6.10e-05 2.27e-06  1.95e-04     7s
  41   8.81990463e+04  8.82136063e+04  2.14e-05 3.30e-07  6.57e-05     7s
  42   8.82101962e+04  8.82122870e+04  3.01e-06 1.48e-06  9.44e-06     7s
  43   8.82121134e+04  8.82121193e+04  6.07e-09 1.42e-08  2.69e-08     7s
  44   8.82121178e+04  8.82121178e+04  4.04e-10 2.91e-11  1.13e-11     7s

Barrier solved model in 44 iterations and 6.90 seconds (11.16 work units)
Optimal objective 8.82121178e+04


Root crossover log...

  109895 DPushes remaining with DInf 0.0000000e+00                 7s
     977 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    1184 PPushes remaining with PInf 1.8602819e-08                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.0202939e-10     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47828    8.8212118e+04   0.000000e+00   0.000000e+00     11s
   47828    8.8212118e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.42s

Solved with barrier

Root relaxation: objective 8.821212e+04, 47828 iterations, 8.29 seconds (16.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88212.1178    0  111 -168399.12 88212.1178   152%     -   11s
H    0     0                    -156452.1995 88212.1178   156%     -   11s
H    0     0                    -131666.0283 88212.1178   167%     -   11s
H    0     0                    -131536.5121 88212.1178   167%     -   11s
H    0     0                    -120345.9493 88212.1178   173%     -   11s
H    0     0                    -119309.7616 88212.1178   174%     -   11s
H    0     0                    -119039.4604 88212.1178   174%     -   12s
H    0     0                    -29716.95943 88212.1178   397%     -   12s
H    0     0                    -29061.39754 88212.1178   404%     -   12s
H    0     0                    17213.917929 88212.1178   412%     -   12s
H    0     0                    32460.015471 88212.1178   172%     -   13s
H    0     0                    38182.934795 88212.1178   131%     -   13s
H    0     0                    42123.723421 88212.1178   109%     -   13s
H    0     0                    44603.487995 88212.1178  97.8%     -   13s
H    0     0                    45459.675685 88212.1178  94.0%     -   13s
H    0     0                    47894.428449 88212.1178  84.2%     -   13s
H    0     0                    48374.585920 88212.1178  82.4%     -   14s
H    0     0                    48735.436978 88212.1178  81.0%     -   14s
H    0     0                    48955.886057 88212.1178  80.2%     -   14s
H    0     0                    49698.318818 88212.1178  77.5%     -   14s
H    0     0                    49963.460033 88212.1178  76.6%     -   14s
     0     0 81813.7041    0  214 49963.4600 81813.7041  63.7%     -   39s
H    0     0                    51813.776325 81388.8743  57.1%     -   51s
H    0     0                    51839.785011 81388.8743  57.0%     -   51s
     0     0 81388.8743    0  254 51839.7850 81388.8743  57.0%     -   51s
     0     0 81352.7473    0  255 51839.7850 81352.7473  56.9%     -   56s
     0     0 81338.1944    0  253 51839.7850 81338.1944  56.9%     -   59s
     0     0 81330.0243    0  257 51839.7850 81330.0243  56.9%     -   60s
     0     0 81330.0218    0  257 51839.7850 81330.0218  56.9%     -   61s
H    0     0                    51979.327494 78957.2930  51.9%     -   97s
     0     0 78863.4345    0  274 51979.3275 78863.4345  51.7%     -   97s
H    0     0                    55944.751511 78863.4345  41.0%     -   98s
H    0     0                    56791.256213 78863.4345  38.9%     -   98s
     0     0 78523.1862    0  249 56791.2562 78523.1862  38.3%     -  121s
     0     0 78342.5606    0  238 56791.2562 78342.5606  37.9%     -  135s
     0     0 78214.4227    0  256 56791.2562 78214.4227  37.7%     -  146s
     0     0 78103.5574    0  254 56791.2562 78103.5574  37.5%     -  160s
     0     0 78078.8845    0  252 56791.2562 78078.8845  37.5%     -  163s
     0     0 78071.1989    0  248 56791.2562 78071.1989  37.5%     -  165s
H    0     0                    57278.114605 78044.7087  36.3%     -  168s
     0     0 78044.7087    0  257 57278.1146 78044.7087  36.3%     -  168s
     0     0 77870.5763    0  308 57278.1146 77870.5763  36.0%     -  179s
     0     0 77765.8797    0  257 57278.1146 77765.8797  35.8%     -  186s
     0     0 77753.0257    0  304 57278.1146 77753.0257  35.7%     -  193s
     0     0 77749.1623    0  249 57278.1146 77749.1623  35.7%     -  196s
     0     0 77742.4472    0  260 57278.1146 77742.4472  35.7%     -  198s
     0     0 77737.2323    0  256 57278.1146 77737.2323  35.7%     -  199s
     0     0 77736.8217    0  255 57278.1146 77736.8217  35.7%     -  200s
H    0     0                    57445.152938 77736.8217  35.3%     -  210s
H    0     0                    58005.566626 76534.4013  31.9%     -  236s
H    0     0                    58441.123365 76534.4013  31.0%     -  236s
     0     0 76534.4013    0  363 58441.1234 76534.4013  31.0%     -  236s
     0     0 75868.8213    0  365 58441.1234 75868.8213  29.8%     -  258s
     0     0 75721.8080    0  353 58441.1234 75721.8080  29.6%     -  270s
     0     0 75627.4435    0  358 58441.1234 75627.4435  29.4%     -  280s
     0     0 75605.6313    0  360 58441.1234 75605.6313  29.4%     -  286s
     0     0 75585.1706    0  366 58441.1234 75585.1706  29.3%     -  290s
     0     0 75578.7056    0  395 58441.1234 75578.7056  29.3%     -  294s
     0     0 75570.9608    0  391 58441.1234 75570.9608  29.3%     -  297s
     0     0 75569.8095    0  390 58441.1234 75569.8095  29.3%     -  298s
     0     0 74978.9454    0  316 58441.1234 74978.9454  28.3%     -  326s
     0     0 74816.5954    0  350 58441.1234 74816.5954  28.0%     -  337s
     0     0 74694.7710    0  317 58441.1234 74694.7710  27.8%     -  345s
     0     0 74641.6977    0  354 58441.1234 74641.6977  27.7%     -  354s
     0     0 74619.1632    0  310 58441.1234 74619.1632  27.7%     -  358s
     0     0 74605.9128    0  262 58441.1234 74605.9128  27.7%     -  361s
     0     0 74604.0187    0  268 58441.1234 74604.0187  27.7%     -  362s
     0     0 74597.9300    0  276 58441.1234 74597.9300  27.6%     -  364s
     0     0 74595.2682    0  281 58441.1234 74595.2682  27.6%     -  365s
     0     0 74592.8397    0  281 58441.1234 74592.8397  27.6%     -  367s
     0     0 74585.9847    0  280 58441.1234 74585.9847  27.6%     -  369s
     0     0 74579.4423    0  313 58441.1234 74579.4423  27.6%     -  371s
     0     0 74575.8985    0  277 58441.1234 74575.8985  27.6%     -  372s
     0     0 74573.1692    0  290 58441.1234 74573.1692  27.6%     -  374s
     0     0 74572.4480    0  288 58441.1234 74572.4480  27.6%     -  375s
     0     0 74472.2885    0  419 58441.1234 74472.2885  27.4%     -  386s
     0     0 74414.6359    0  394 58441.1234 74414.6359  27.3%     -  393s
     0     0 74405.2272    0  337 58441.1234 74405.2272  27.3%     -  395s
     0     0 74402.5022    0  332 58441.1234 74402.5022  27.3%     -  396s
     0     0 74400.0314    0  337 58441.1234 74400.0314  27.3%     -  397s
     0     0 74392.1100    0  330 58441.1234 74392.1100  27.3%     -  398s
     0     0 74391.3920    0  330 58441.1234 74391.3920  27.3%     -  399s
     0     0 74334.4070    0  296 58441.1234 74334.4070  27.2%     -  406s
     0     0 74327.4027    0  370 58441.1234 74327.4027  27.2%     -  413s
     0     0 74320.2278    0  367 58441.1234 74320.2278  27.2%     -  415s
     0     0 74310.5365    0  296 58441.1234 74310.5365  27.2%     -  418s
     0     0 74304.9205    0  329 58441.1234 74304.9205  27.1%     -  421s
     0     0 74301.0809    0  334 58441.1234 74301.0809  27.1%     -  422s
     0     0 74300.6124    0  333 58441.1234 74300.6124  27.1%     -  423s
     0     0 74271.4259    0  296 58441.1234 74271.4259  27.1%     -  428s
     0     0 74263.6100    0  297 58441.1234 74263.6100  27.1%     -  430s
     0     0 74259.0989    0  299 58441.1234 74259.0989  27.1%     -  432s
     0     0 74255.9905    0  379 58441.1234 74255.9905  27.1%     -  434s
     0     0 74255.2786    0  297 58441.1234 74255.2786  27.1%     -  434s
     0     0 74235.9734    0  351 58441.1234 74235.9734  27.0%     -  439s
H    0     0                    58548.225148 74235.4631  26.8%     -  441s
     0     0 74230.2815    0  350 58548.2251 74230.2815  26.8%     -  444s
     0     0 74227.9331    0  350 58548.2251 74227.9331  26.8%     -  445s
     0     0 74227.5696    0  349 58548.2251 74227.5696  26.8%     -  446s
     0     0 74225.4474    0  389 58548.2251 74225.4474  26.8%     -  450s
     0     0 74224.5114    0  390 58548.2251 74224.5114  26.8%     -  452s
     0     0 74217.8056    0  383 58548.2251 74217.8056  26.8%     -  455s
H    0     0                    58600.758012 74217.6871  26.6%     -  460s
     0     0 74216.3918    0  388 58600.7580 74216.3918  26.6%     -  464s
     0     0 74214.2496    0  354 58600.7580 74214.2496  26.6%     -  466s
     0     0 74213.9509    0  354 58600.7580 74213.9509  26.6%     -  469s
     0     2 74213.7476    0  354 58600.7580 74213.7476  26.6%     -  529s
     1     3 74032.8901    1  330 58600.7580 74212.3854  26.6%  4574  534s
     2     4 74070.4777    1  344 58600.7580 74070.4777  26.4%  2968  541s
     3     5 72931.4442    2  379 58600.7580 74070.4669  26.4%  7269  556s
     4     9 73489.2138    2  322 58600.7580 74070.3361  26.4%  6409  567s
     8    16 73328.0788    3  265 58600.7580 73509.6445  25.4%  7174  586s
    15    32 73072.3206    4  329 58600.7580 73509.6445  25.4%  9577  605s
    31    48 72370.0494    5  296 58600.7580 73201.9168  24.9% 15922  650s
H   47    79                    58654.592320 73201.9168  24.8% 14666  681s
H   48    79                    58693.827800 73201.9168  24.7% 14622  681s
    78   158 71512.4343    7  279 58693.8278 73201.9168  24.7% 12756  748s
   157   247 70850.7315    9  273 58693.8278 73201.9168  24.7% 10067  779s
   246   311 70789.6403   10  266 58693.8278 73201.9168  24.7%  8188  802s
   310   344 70412.2585   12  303 58693.8278 73201.9168  24.7%  7573  820s
H  323   344                    58929.881163 73201.9168  24.2%  7437  820s
   343   413 70037.1641   13  296 58929.8812 73201.9168  24.2%  7366  842s
   412   481 69563.4263   16  232 58929.8812 73201.9168  24.2%  6982  862s
   480   541 69361.5772   17  221 58929.8812 73201.9168  24.2%  6647  881s
H  540   584                    59101.467473 73201.9168  23.9%  6397  898s
H  544   584                    59139.056652 73201.9168  23.8%  6403  898s
H  551   584                    59243.929025 73201.9168  23.6%  6371  898s
H  554   584                    59329.259368 73201.9168  23.4%  6360  898s
   583   650 69546.3737   21  223 59329.2594 73201.9168  23.4%  6185  919s
   657   721 68146.4570   20  174 59329.2594 73201.9168  23.4%  5859  936s
   728   794 67439.9330   22  153 59329.2594 73201.9168  23.4%  5628  956s
   801   893 66808.2804   24  177 59329.2594 73201.9168  23.4%  5390  973s
   902   964 66515.8772   26  184 59329.2594 73201.9168  23.4%  5043  998s
   977   995 66004.9379   28  105 59329.2594 73201.9168  23.4%  4886 1014s
  1032  1071 65532.8678   30   73 59329.2594 73201.9168  23.4%  4818 1042s
  1122  1139     cutoff   32      59329.2594 73201.9168  23.4%  4680 1064s
  1226  1198 65106.1976   30   74 59329.2594 73201.9168  23.4%  4489 1084s
  1336  1208 63697.4284   32  152 59329.2594 73201.9168  23.4%  4325 1106s
  1432  1238 64519.4071   11  276 59329.2594 73201.9168  23.4%  4255 1129s
  1509  1258     cutoff   32      59329.2594 73201.9168  23.4%  4239 1149s
  1561  1312 infeasible   31      59329.2594 73201.9168  23.4%  4229 1174s
  1633  1376 62272.0370   25  148 59329.2594 73201.9168  23.4%  4241 1199s
  1748  1432 61010.8273   29  124 59329.2594 73201.9168  23.4%  4179 1225s
  1864  1455 infeasible   40      59329.2594 73201.9168  23.4%  4102 1252s
  1965  1515 62869.3514   24  275 59329.2594 73201.9168  23.4%  4102 1280s
  2079  1557 62761.9729   26  245 59329.2594 73201.9168  23.4%  4066 1308s
  2171  1629 62452.9317   30  219 59329.2594 73201.9168  23.4%  4087 1339s
  2280  1741 61881.8440   36  176 59329.2594 73201.9168  23.4%  4086 1369s
  2406  1858 60849.4223   43  101 59329.2594 72972.9570  23.0%  4056 1401s
  2575  1983 60544.1428   49  175 59329.2594 72970.2627  23.0%  3954 1430s
  2776  2014 infeasible   29      59329.2594 72970.2627  23.0%  3842 1466s
  2893  2081 72370.3033    5  279 59329.2594 72786.9377  22.7%  3863 1505s
  3004  2161 69814.5322    6  240 59329.2594 72786.9377  22.7%  3887 1545s
  3116  2241 68895.9932    7  256 59329.2594 72786.9377  22.7%  3914 1585s
  3258  2294 66744.4872    9  287 59329.2594 72786.9377  22.7%  3942 1626s
  3355  2327 66053.2472   13  208 59329.2594 72690.7522  22.5%  3960 1666s
H 3366  2327                    59394.435326 72690.7522  22.4%  3965 1666s
  3402  2349 65846.1657   14  264 59394.4353 72690.7522  22.4%  3996 1698s
  3440  2373 65366.6077   15  180 59394.4353 72690.7522  22.4%  4041 1735s
H 3463  2372                    59435.098901 72690.7522  22.3%  4068 1735s
H 3465  2330                    59733.166082 72690.7522  21.7%  4070 1735s
  3474  2379 65236.9470   16  211 59733.1661 72690.7522  21.7%  4088 1778s
  3554  2428 63480.0266   19  178 59733.1661 72690.7522  21.7%  4160 1819s
H 3611  2421                    59766.315495 71744.0148  20.0%  4181 1819s
  3641  2465 62803.3567   20  145 59766.3155 71744.0148  20.0%  4194 1864s
  3796  2548 infeasible   31      59766.3155 71685.3524  19.9%  4221 1916s
  3958  2660 infeasible   22      59766.3155 71654.4913  19.9%  4242 1965s
  4159  2736 68898.6297    6  249 59766.3155 71654.4913  19.9%  4252 2023s
  4313  2737 68165.7900   17  354 59766.3155 71654.4913  19.9%  4278 2188s
  4315  2738 63388.9360   37  111 59766.3155 71654.4913  19.9%  4276 2198s
  4316  2739 64399.6139   36  318 59766.3155 71654.4913  19.9%  4275 2265s
  4317  2740 63501.6539   15  280 59766.3155 71654.4913  19.9%  4274 2311s
  4318  2740 60833.5843   32  297 59766.3155 71654.4913  19.9%  4273 2338s
  4319  2741 60181.1789   38  344 59766.3155 71654.4913  19.9%  4272 2374s
  4320  2742 61382.6766   47  377 59766.3155 71654.4913  19.9%  4271 2413s
  4321  2742 66725.0013   18  364 59766.3155 71654.4913  19.9%  4270 2439s
  4322  2743 68338.0397   22  329 59766.3155 71654.4913  19.9%  4269 2453s
  4323  2744 59920.7102   45  337 59766.3155 71654.4913  19.9%  4268 2460s
  4324  2744 61093.0801   21  323 59766.3155 71654.4913  19.9%  4267 2469s
  4325  2745 71239.1127    8  321 59766.3155 71654.4913  19.9%  4266 2480s
  4326  2746 60510.7792   50  417 59766.3155 71654.4913  19.9%  4265 2498s
  4327  2746 70429.2862   17  341 59766.3155 71654.4913  19.9%  4264 2503s
  4328  2747 63324.7536   20  345 59766.3155 71654.4913  19.9%  4263 2507s
  4329  2748 60680.4264   39  392 59766.3155 71654.4913  19.9%  4263 2530s
  4330  2748 71138.8467   13  338 59766.3155 71654.4913  19.9%  4262 2536s
  4331  2749 59827.9135   70  338 59766.3155 71654.4913  19.9%  4261 2546s
  4332  2750 61245.4016   54  414 59766.3155 71654.4913  19.9%  4260 2552s
  4333  2750 69227.2101   21  444 59766.3155 71654.4913  19.9%  4259 2558s
  4334  2751 65546.5657   15  456 59766.3155 71654.4913  19.9%  4258 2583s
  4335  2752 65040.2908   46  317 59766.3155 71654.4913  19.9%  4257 2594s
  4336  2752 69336.3215   20  315 59766.3155 71654.4913  19.9%  4256 2599s
  4337  2753 61429.9290   69  323 59766.3155 71654.4913  19.9%  4255 2615s
  4339  2754 60983.7082   59  333 59766.3155 71654.4913  19.9%  4253 2627s
  4340  2755 61585.4919   19  319 59766.3155 71654.4913  19.9%  4252 2630s
  4341  2756 64869.4220   29  329 59766.3155 71654.4913  19.9%  4251 2638s
  4342  2756 63367.3454   22  322 59766.3155 71654.4913  19.9%  4250 2641s
  4343  2757 60905.1685   67  322 59766.3155 71654.4913  19.9%  4249 2647s
  4344  2758 60160.3680   48  324 59766.3155 71654.4913  19.9%  4248 2650s
  4345  2758 60252.9679   34  414 59766.3155 71654.4913  19.9%  4247 2659s
  4346  2759 61188.0934   79  332 59766.3155 71654.4913  19.9%  4246 2666s
  4347  2760 67747.8054   26  360 59766.3155 71654.4913  19.9%  4245 2671s
  4348  2760 71394.2841   17  323 59766.3155 71654.4913  19.9%  4244 2678s
  4349  2761 61939.3751   20  405 59766.3155 71654.4913  19.9%  4243 2689s
  4350  2762 62025.8923   19  460 59766.3155 71654.4913  19.9%  4242 2695s
  4351  2762 68095.7154   13  323 59766.3155 71654.4913  19.9%  4241 2700s
  4352  2763 63864.7894   20  457 59766.3155 71654.4913  19.9%  4240 2711s
  4353  2764 69155.0289   19  457 59766.3155 71654.4913  19.9%  4239 2736s
  4354  2764 59992.9986   78  457 59766.3155 71654.4913  19.9%  4238 2796s
  4355  2767 71654.4913   16  389 59766.3155 71654.4913  19.9%  4333 2836s
  4356  2768 71654.4913   16  368 59766.3155 71654.4913  19.9%  4335 2863s
  4357  2771 71654.4913   17  292 59766.3155 71654.4913  19.9%  4338 2893s
  4361  2777 71654.4913   18  425 59766.3155 71654.4913  19.9%  4344 2946s
  4368  2790 71654.4913   19  343 59766.3155 71654.4913  19.9%  4370 2984s
  4383  2800 71349.0797   20  316 59766.3155 71654.4913  19.9%  4418 3052s
  4398  2827 69393.3087   21  311 59766.3155 71654.4913  19.9%  4501 3185s
  4430  2932 68947.7328   22  283 59766.3155 71654.4913  19.9%  4597 3234s
  4546  2925 68618.5609   24  351 59766.3155 71654.4913  19.9%  4699 3252s
  4578  2944 67901.8362   26  300 59766.3155 71654.4913  19.9%  4721 3277s
  4608  2959 67963.1801   25  365 59766.3155 71654.4913  19.9%  4759 3303s
  4638  2969 65230.1358   25  208 59766.3155 71654.4913  19.9%  4804 3330s
  4667  2995 65764.2318   26  272 59766.3155 71654.4913  19.9%  4871 3355s
  4710  3017 65212.9591   27  279 59766.3155 71654.4913  19.9%  4957 3380s
  4769  3032 62528.0523   28  261 59766.3155 71654.4913  19.9%  5016 3406s
  4827  3041 61627.0594   29  232 59766.3155 71654.4913  19.9%  5060 3430s
  4891  3033     cutoff   30      59766.3155 71654.4913  19.9%  5131 3461s
  4950  3025 60977.2293   29  232 59766.3155 71654.4913  19.9%  5200 3490s
  5002  3020 60232.3611   30  230 59766.3155 71654.4913  19.9%  5270 3518s
  5060  3022 infeasible   31      59766.3155 71654.4913  19.9%  5331 3541s
  5113  3025 infeasible   36      59766.3155 71654.4913  19.9%  5389 3562s
  5174  3014 62174.7561   29  268 59766.3155 71654.4913  19.9%  5430 3594s
  5240  2989 62172.3904   30  213 59766.3155 71654.4913  19.9%  5469 3600s

Cutting planes:
  Learned: 1
  Implied bound: 2
  Projected implied bound: 62
  MIR: 735
  Mixing: 3
  Flow cover: 1706
  RLT: 6
  Relax-and-lift: 268

Explored 5266 nodes (29166673 simplex iterations) in 3600.06 seconds (9261.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 59766.3 59733.2 59435.1 ... 58693.8

Time limit reached
Best objective 5.976631549496e+04, best bound 7.165449131785e+04, gap 19.8911%
  WARNING: Time limit reached. Using best solution found (gap: 19.89%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 59766.32, θ = 213069.27
  Upper Bound (UB) = 59766.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 213069.27
  [DEBUG]   ✓ Scenario 0: θ = 213069.27 ≤ Q = 213069.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 213069.27 ≤ Q = 213069.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 213069.27 ≤ Q = 213069.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 213069.27 ≤ Q = 213069.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 213069.27 ≤ Q = 213069.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 213069.27 ≤ Q = 213069.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 213069.27 ≤ Q = 213069.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 213069.27 ≤ Q = 213069.27 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6b6940e7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6b6940e7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.532989e+13
Presolve removed 2618 rows and 1908 columns
Presolve time: 0.00s
Presolved: 475 rows, 481 columns, 1343 nonzeros
Found heuristic solution: objective 7267712.8562
Variable types: 326 continuous, 155 integer (155 binary)
Found heuristic solution: objective 7267430.4785

Root relaxation: objective -1.648614e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164861.40    0  121 7267430.48 -164861.40   102%     -    0s
H    0     0                    -123147.7154 -164861.40  33.9%     -    0s
H    0     0                    -125141.1281 -164861.40  31.7%     -    0s
H    0     0                    -129687.7125 -143778.37  10.9%     -    0s
     0     0 -143778.37    0   94 -129687.71 -143778.37  10.9%     -    0s
H    0     0                    -139450.1543 -143645.61  3.01%     -    0s
H    0     0                    -139750.5179 -143645.61  2.79%     -    0s
H    0     0                    -140172.9114 -143645.61  2.48%     -    0s
H    0     0                    -140473.2750 -143645.61  2.26%     -    0s
     0     0 -142184.54    0   63 -140473.28 -142184.54  1.22%     -    0s
H    0     0                    -140802.6186 -142129.75  0.94%     -    0s
     0     0 -142129.75    0   63 -140802.62 -142129.75  0.94%     -    0s
H    0     0                    -140988.3645 -142129.75  0.81%     -    0s
     0     0 -141827.71    0   37 -140988.36 -141827.71  0.60%     -    0s
     0     0 -141789.41    0   36 -140988.36 -141789.41  0.57%     -    0s
     0     0 -141653.44    0   43 -140988.36 -141653.44  0.47%     -    0s
H    0     0                    -141038.8812 -141653.44  0.44%     -    0s
     0     0 -141631.68    0   41 -141038.88 -141631.68  0.42%     -    0s
     0     0 -141619.60    0   35 -141038.88 -141619.60  0.41%     -    0s
     0     0 -141614.43    0   35 -141038.88 -141614.43  0.41%     -    0s
H    0     0                    -141076.2005 -141614.43  0.38%     -    0s
     0     2 -141614.43    0   32 -141076.20 -141614.43  0.38%     -    0s
H   46    51                    -141166.5071 -141377.81  0.15%  11.8    0s
H   94   130                    -141241.2241 -141333.04  0.07%   8.0    0s
H  124   130                    -141278.4346 -141333.04  0.04%   6.6    0s
*  357     1              12    -141285.4656 -141294.48  0.01%   3.7    0s

Cutting planes:
  Gomory: 44
  Implied bound: 10
  MIR: 141
  Flow cover: 12
  RLT: 32
  Relax-and-lift: 2
  BQP: 2

Explored 372 nodes (1925 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -141285 -141278 -141241 ... -140173
No other solutions better than -141285

Optimal solution found (tolerance 1.00e-04)
Best objective -1.412854656420e+05, best bound -1.412854656420e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 206460.41
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141285.47
  [DEBUG]   S×d_nominal = 347745.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 347745.87 + -141285.47 = 206460.41
  [DEBUG]   Current θ from Master = 213069.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6608.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 53157.46
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = 955.5498, Absolute Gap = 955.5498, Relative Gap = 0.015988
  Not converged yet (gap = 955.55 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697119 nonzeros
Model fingerprint: 0x2a1354f3
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 116352 rows and 47232 columns
Presolve time: 2.18s
Presolved: 129671 rows, 54868 columns, 799209 nonzeros
Variable types: 52609 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296758.2182
Found heuristic solution: objective -168399.1201

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.04s

Barrier statistics:
 Dense cols : 608
 AA' NZ     : 6.457e+06
 Factor NZ  : 1.409e+07 (roughly 200 MB of memory)
 Factor Ops : 3.037e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.04589727e+07  2.35351267e+08  1.54e+05 1.36e+01  9.20e+04     4s
   1  -1.55770226e+07  2.21055225e+08  1.08e+05 1.01e+02  6.39e+04     4s
   2  -4.94158929e+06  1.73999840e+08  3.41e+04 2.67e+01  2.15e+04     4s
   3  -1.90676728e+06  1.33936772e+08  8.28e+03 1.09e+00  5.52e+03     5s
   4  -8.04857305e+05  9.92154132e+07  1.08e+03 4.83e-01  1.04e+03     5s
   5  -7.14652312e+05  4.83331778e+07  5.35e+02 2.03e-01  4.76e+02     5s
   6  -5.87763716e+05  3.99677185e+07  1.18e+02 1.62e-01  2.28e+02     5s
   7  -3.48422789e+05  2.71582118e+07  4.70e+01 1.03e-01  1.36e+02     5s
   8  -2.57675149e+05  2.05846507e+07  1.01e+01 7.63e-02  9.16e+01     5s
   9  -2.21704848e+05  1.07049259e+07  7.29e+00 3.86e-02  4.77e+01     5s
  10  -1.55447532e+05  5.71047679e+06  3.99e+00 2.00e-02  2.53e+01     5s
  11  -9.54024179e+04  2.12102445e+06  1.74e+00 7.18e-03  9.45e+00     5s
  12  -4.24501878e+04  1.21785390e+06  6.74e-01 4.03e-03  5.34e+00     5s
  13  -1.82364376e+04  7.85637021e+05  4.16e-01 2.56e-03  3.40e+00     5s
  14   1.56812418e+04  3.58910660e+05  1.88e-01 1.21e-03  1.45e+00     5s
  15   2.86213530e+04  2.41659887e+05  1.36e-01 1.57e-03  9.01e-01     5s
  16   4.25045633e+04  1.90406427e+05  1.01e-01 2.03e-03  6.25e-01     5s
  17   4.88105886e+04  1.67159903e+05  8.40e-02 1.74e-03  5.00e-01     5s
  18   5.68399671e+04  1.44606653e+05  6.36e-02 1.76e-03  3.71e-01     5s
  19   6.31818681e+04  1.33953638e+05  4.82e-02 1.77e-03  2.99e-01     5s
  20   6.86916695e+04  1.15561290e+05  3.59e-02 1.70e-03  1.98e-01     5s
  21   7.34482029e+04  1.05958745e+05  2.61e-02 1.98e-03  1.38e-01     5s
  22   7.56547154e+04  9.98990245e+04  2.18e-02 1.36e-03  1.03e-01     6s
  23   7.91142619e+04  9.71224631e+04  1.54e-02 1.04e-03  7.62e-02     6s
  24   8.06554671e+04  9.52097086e+04  1.26e-02 8.25e-04  6.16e-02     6s
  25   8.19790844e+04  9.25253059e+04  1.01e-02 5.17e-04  4.46e-02     6s
  26   8.33746567e+04  9.15225850e+04  7.81e-03 3.90e-04  3.45e-02     6s
  27   8.48340236e+04  9.03140615e+04  5.36e-03 2.39e-04  2.32e-02     6s
  28   8.52421772e+04  8.98680164e+04  4.68e-03 1.92e-04  1.96e-02     6s
  29   8.60510798e+04  8.93724970e+04  3.36e-03 1.31e-04  1.41e-02     6s
  30   8.67537698e+04  8.90745967e+04  2.26e-03 9.92e-05  9.82e-03     6s
  31   8.69245795e+04  8.88458128e+04  1.99e-03 7.22e-05  8.13e-03     6s
  32   8.73750893e+04  8.88072162e+04  1.27e-03 6.76e-05  6.06e-03     6s
  33   8.75343868e+04  8.85350594e+04  1.01e-03 3.68e-05  4.23e-03     6s
  34   8.75825935e+04  8.84884282e+04  9.38e-04 3.16e-05  3.83e-03     6s
  35   8.77614608e+04  8.84302077e+04  6.43e-04 2.49e-05  2.83e-03     6s
  36   8.79998896e+04  8.83899866e+04  2.87e-04 2.04e-05  1.65e-03     7s
  37   8.80593328e+04  8.82765053e+04  2.04e-04 7.24e-06  9.19e-04     7s
  38   8.80983212e+04  8.82508683e+04  1.52e-04 4.36e-06  6.46e-04     7s
  39   8.81562058e+04  8.82405184e+04  7.20e-05 3.16e-06  3.57e-04     7s
  40   8.81900220e+04  8.82299346e+04  2.62e-05 1.96e-06  1.69e-04     7s
  41   8.82022145e+04  8.82145398e+04  1.10e-05 4.05e-06  5.22e-05     7s
  42   8.82101420e+04  8.82123404e+04  2.11e-06 1.33e-06  9.31e-06     7s
  43   8.82121170e+04  8.82121183e+04  8.04e-10 2.16e-08  5.60e-09     7s
  44   8.82121178e+04  8.82121178e+04  3.37e-10 5.60e-11  1.52e-11     7s

Barrier solved model in 44 iterations and 7.03 seconds (12.19 work units)
Optimal objective 8.82121178e+04


Root crossover log...

  117061 DPushes remaining with DInf 0.0000000e+00                 7s
    3768 DPushes remaining with DInf 7.4090137e-09                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    1307 PPushes remaining with PInf 4.3281482e-08                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.3483836e-10     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50713    8.8212118e+04   0.000000e+00   0.000000e+00     11s
   50713    8.8212118e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 1.66s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.821212e+04, 50713 iterations, 10.20 seconds (19.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 88212.1178    0  111 -168399.12 88212.1178   152%     -   13s
H    0     0                    -164670.6745 88212.1178   154%     -   13s
H    0     0                    -98811.03332 88212.1178   189%     -   13s
H    0     0                    -94340.44782 88212.1178   194%     -   13s
H    0     0                    -86636.93803 88212.1178   202%     -   14s
H    0     0                    -29716.95943 88212.1178   397%     -   14s
H    0     0                    -29009.97290 88212.1178   404%     -   14s
H    0     0                    -9986.974295 88212.1178   983%     -   14s
H    0     0                    -9403.829246 88212.1178  1038%     -   14s
H    0     0                    10402.881794 88212.1178   748%     -   14s
H    0     0                    10986.026843 88212.1178   703%     -   14s
H    0     0                    26337.947728 88212.1178   235%     -   15s
H    0     0                    26715.933291 88212.1178   230%     -   15s
H    0     0                    29418.962862 88212.1178   200%     -   15s
H    0     0                    34511.620626 88212.1178   156%     -   15s
H    0     0                    42455.027917 88212.1178   108%     -   15s
H    0     0                    48450.992880 88212.1178  82.1%     -   15s
H    0     0                    48493.486826 88211.8275  81.9%     -   16s
H    0     0                    50380.185968 82167.3354  63.1%     -   55s
H    0     0                    50388.668784 82167.3354  63.1%     -   55s
H    0     0                    50395.453510 82167.3354  63.0%     -   55s
H    0     0                    51295.373993 82167.3354  60.2%     -   55s
H    0     0                    51554.137651 82167.3354  59.4%     -   55s
H    0     0                    51580.724391 82167.3354  59.3%     -   55s
H    0     0                    51638.342949 82167.3354  59.1%     -   55s
     0     0 82167.3354    0  213 51638.3429 82167.3354  59.1%     -   55s
     0     0 81359.3141    0  247 51638.3429 81359.3141  57.6%     -   80s
     0     0 81359.3141    0  253 51638.3429 81359.3141  57.6%     -   86s
     0     0 81309.8744    0  226 51638.3429 81309.8744  57.5%     -   92s
     0     0 81307.7707    0  251 51638.3429 81307.7707  57.5%     -   93s
     0     0 81287.6671    0  248 51638.3429 81287.6671  57.4%     -   96s
     0     0 81269.4886    0  248 51638.3429 81269.4886  57.4%     -   98s
     0     0 81267.2839    0  248 51638.3429 81267.2839  57.4%     -   99s
     0     0 81157.8414    0  225 51638.3429 81157.8414  57.2%     -  106s
     0     0 78705.8315    0  226 51638.3429 78705.8315  52.4%     -  108s
     0     0 78705.8238    0  222 51638.3429 78705.8238  52.4%     -  109s
     0     0 78705.8238    0  218 51638.3429 78705.8238  52.4%     -  112s
     0     0 78705.8238    0  235 51638.3429 78705.8238  52.4%     -  152s
H    0     0                    56454.276438 78705.8238  39.4%     -  153s
H    0     0                    56842.188838 78705.8238  38.5%     -  153s
     0     0 78055.1103    0  274 56842.1888 78055.1103  37.3%     -  184s
     0     0 77943.0480    0  260 56842.1888 77943.0480  37.1%     -  200s
     0     0 77837.9930    0  258 56842.1888 77837.9930  36.9%     -  214s
     0     0 77747.2118    0  259 56842.1888 77747.2118  36.8%     -  222s
     0     0 77641.9292    0  258 56842.1888 77641.9292  36.6%     -  240s
     0     0 77601.0619    0  269 56842.1888 77601.0619  36.5%     -  244s
     0     0 77579.4451    0  271 56842.1888 77579.4451  36.5%     -  250s
H    0     0                    56919.683170 77544.9542  36.2%     -  258s
     0     0 77544.9542    0  278 56919.6832 77544.9542  36.2%     -  258s
     0     0 77521.0490    0  295 56919.6832 77521.0490  36.2%     -  264s
H    0     0                    58137.059261 77489.2144  33.3%     -  269s
H    0     0                    58485.787865 77489.2144  32.5%     -  269s
     0     0 77489.2144    0  272 58485.7879 77489.2144  32.5%     -  269s
     0     0 77483.3394    0  272 58485.7879 77483.3394  32.5%     -  272s
     0     0 77481.5115    0  273 58485.7879 77481.5115  32.5%     -  273s
     0     0 77480.5137    0  272 58485.7879 77480.5137  32.5%     -  275s
     0     0 76327.7896    0  330 58485.7879 76327.7896  30.5%     -  319s
     0     0 75869.4634    0  330 58485.7879 75869.4634  29.7%     -  348s
     0     0 75710.5023    0  364 58485.7879 75710.5023  29.5%     -  360s
     0     0 75654.5697    0  337 58485.7879 75654.5697  29.4%     -  367s
     0     0 75595.5762    0  363 58485.7879 75595.5762  29.3%     -  374s
     0     0 75546.0187    0  330 58485.7879 75546.0187  29.2%     -  381s
     0     0 75537.2820    0  336 58485.7879 75537.2820  29.2%     -  385s
     0     0 75521.6882    0  329 58485.7879 75521.6882  29.1%     -  389s
     0     0 75501.9884    0  332 58485.7879 75501.9884  29.1%     -  393s
     0     0 75496.3281    0  333 58485.7879 75496.3281  29.1%     -  396s
     0     0 75487.2480    0  334 58485.7879 75487.2480  29.1%     -  398s
     0     0 75486.2222    0  332 58485.7879 75486.2222  29.1%     -  400s
     0     0 75020.3512    0  364 58485.7879 75020.3512  28.3%     -  425s
     0     0 74853.5726    0  409 58485.7879 74853.5726  28.0%     -  440s
     0     0 74767.8869    0  379 58485.7879 74767.8869  27.8%     -  450s
     0     0 74727.7779    0  405 58485.7879 74727.7779  27.8%     -  456s
     0     0 74681.7687    0  418 58485.7879 74681.7687  27.7%     -  463s
     0     0 74677.5762    0  414 58485.7879 74677.5762  27.7%     -  465s
     0     0 74665.5082    0  389 58485.7879 74665.5082  27.7%     -  467s
     0     0 74659.8244    0  382 58485.7879 74659.8244  27.7%     -  468s
     0     0 74644.9869    0  413 58485.7879 74644.9869  27.6%     -  472s
     0     0 74642.2790    0  418 58485.7879 74642.2790  27.6%     -  473s
     0     0 74640.9282    0  413 58485.7879 74640.9282  27.6%     -  474s
     0     0 74544.9543    0  410 58485.7879 74544.9543  27.5%     -  487s
     0     0 74526.7055    0  424 58485.7879 74526.7055  27.4%     -  492s
     0     0 74517.8171    0  420 58485.7879 74517.8171  27.4%     -  496s
     0     0 74516.6780    0  394 58485.7879 74516.6780  27.4%     -  498s
     0     0 74416.6155    0  420 58485.7879 74416.6155  27.2%     -  509s
     0     0 74396.9588    0  415 58485.7879 74396.9588  27.2%     -  519s
     0     0 74387.9891    0  388 58485.7879 74387.9891  27.2%     -  521s
     0     0 74344.5916    0  445 58485.7879 74344.5916  27.1%     -  529s
     0     0 74340.6434    0  380 58485.7879 74340.6434  27.1%     -  531s
     0     0 74337.8819    0  379 58485.7879 74337.8819  27.1%     -  533s
     0     0 74336.7869    0  388 58485.7879 74336.7869  27.1%     -  534s
     0     0 74310.6119    0  271 58485.7879 74310.6119  27.1%     -  541s
     0     0 74308.5327    0  416 58485.7879 74308.5327  27.1%     -  545s
     0     0 74307.7494    0  423 58485.7879 74307.7494  27.1%     -  547s
     0     0 74297.4847    0  439 58485.7879 74297.4847  27.0%     -  552s
H    0     0                    58693.827800 74297.1246  26.6%     -  555s
     0     0 74294.1475    0  337 58693.8278 74294.1475  26.6%     -  557s
     0     0 74292.6262    0  316 58693.8278 74292.6262  26.6%     -  560s
     0     0 74289.3696    0  316 58693.8278 74289.3696  26.6%     -  564s
     0     0 74287.9235    0  315 58693.8278 74287.9235  26.6%     -  566s
     0     0 74285.0561    0  426 58693.8278 74285.0561  26.6%     -  570s
     0     0 74285.0378    0  426 58693.8278 74285.0378  26.6%     -  573s
     0     2 74285.0242    0  426 58693.8278 74285.0242  26.6%     -  683s
     1     4 74148.7016    1  351 58693.8278 74284.7340  26.6%  8668  711s
     3     8 74028.9575    2  388 58693.8278 74148.6663  26.3% 13984  739s
     7    16 73571.1191    3  412 58693.8278 74028.5210  26.1% 16893  772s
    15    32 73117.2110    4  373 58693.8278 73568.4762  25.3% 17446  803s
    31    48 72911.3269    5  385 58693.8278 73117.0505  24.6% 21959 1288s
    47    80 72227.9313    6  260 58693.8278 73117.0505  24.6% 23944 1341s
    79   112 71443.9506    7  263 58693.8278 73117.0505  24.6% 19137 1375s
H   98   112                    58700.379837 73117.0505  24.6% 18003 1375s
   111   245 71442.4930    8  265 58700.3798 73117.0505  24.6% 17443 1425s
   244   317 71199.0168   11  258 58700.3798 73117.0505  24.6% 10534 1455s
   316   386 71207.6428   11  336 58700.3798 73117.0505  24.6%  9155 1479s
   385   439 70751.3959   12  245 58700.3798 73117.0505  24.6%  8545 1505s
   438   470 70946.1885   12  352 58700.3798 73117.0505  24.6%  8298 1526s
   469   509 70566.6594   12  253 58700.3798 73117.0505  24.6%  8269 1562s
   508   556 70611.7368   13  335 58700.3798 73117.0505  24.6%  8581 1587s
   555   601 66603.2963   23  189 58700.3798 73117.0505  24.6%  8323 1613s
   602   648 70500.0119   14  320 58700.3798 73117.0505  24.6%  8045 1638s
   659   692 70316.0534   15  317 58700.3798 73117.0505  24.6%  7801 1663s
   715   755 70178.8127   16  269 58700.3798 73117.0505  24.6%  7503 1685s
   786   818 61710.6331   30  211 58700.3798 73117.0505  24.6%  7088 1708s
   862   841 61242.9333   35  209 58700.3798 73117.0505  24.6%  6689 1731s
   887   881 68695.4324   15  216 58700.3798 73117.0505  24.6%  6608 1748s
   934   915 61176.2722   37  282 58700.3798 73117.0505  24.6%  6391 1769s
   988   967 68566.5667   16  210 58700.3798 73117.0505  24.6%  6237 1796s
  1054  1035 infeasible   17      58700.3798 73117.0505  24.6%  6070 1817s
  1151  1118 65509.5240   16  214 58700.3798 73117.0505  24.6%  5804 1841s
  1269  1169 65351.4209   17  208 58700.3798 73117.0505  24.6%  5464 1867s
  1392  1244 65284.9909   17  186 58700.3798 73117.0505  24.6%  5214 1893s
  1510  1309 64292.7979   18  216 58700.3798 73117.0505  24.6%  5013 1920s
  1655  1335 63734.7663   19  173 58700.3798 73117.0505  24.6%  4745 1953s
  1770  1361 63462.6559   20  171 58700.3798 73117.0505  24.6%  4612 1984s
  1844  1395 61204.7203   21  137 58700.3798 73117.0505  24.6%  4597 2017s
  1910  1457 61801.1276   23  132 58700.3798 73117.0505  24.6%  4628 2049s
  2028  1520 61372.4731   26  134 58700.3798 73117.0505  24.6%  4617 2080s
  2166  1589 61191.6337   29  133 58700.3798 73117.0505  24.6%  4544 2115s
  2289  1668 60058.6581   34  107 58700.3798 73117.0505  24.6%  4513 2148s
  2430  1724 60224.7906   39  117 58700.3798 73117.0505  24.6%  4464 2186s
  2535  1813 59913.8779   43  130 58700.3798 73117.0505  24.6%  4452 2224s
  2683  1864 infeasible   47      58700.3798 73117.0505  24.6%  4427 2265s
  2812  1917 70672.9179   14  309 58700.3798 73117.0505  24.6%  4436 2309s
  2938  1986 68175.1141   15  282 58700.3798 73117.0505  24.6%  4419 2353s
  3062  2053 67373.1776   16  216 58700.3798 73117.0505  24.6%  4431 2402s
  3163  2141 65391.9890   19  236 58700.3798 73117.0505  24.6%  4506 2450s
  3295  2237 63929.4932   22  226 58700.3798 73117.0505  24.6%  4524 2498s
  3438  2377 59359.6577   24  151 58700.3798 72901.6893  24.2%  4533 2548s
  3647  2508 infeasible   19      58700.3798 72901.6893  24.2%  4475 2596s
  3885  2509 59706.4116   54  426 58700.3798 72901.6893  24.2%  4402 2916s
  3887  2510 62843.2134   24  111 58700.3798 72901.6893  24.2%  4400 2931s
  3888  2511 59586.8784   77  269 58700.3798 72901.6893  24.2%  4399 2998s
  3889  2512 62606.0553   30  344 58700.3798 72901.6893  24.2%  4398 3047s
  3890  2512 62905.9778   58  383 58700.3798 72901.6893  24.2%  4397 3078s
  3891  2513 58822.7218  100  338 58700.3798 72901.6893  24.2%  4396 3095s
  3892  2514 60554.8103   80  371 58700.3798 72901.6893  24.2%  4394 3109s
  3893  2514 63475.8469   19  382 58700.3798 72901.6893  24.2%  4393 3121s
  3894  2515 69817.7635   16  412 58700.3798 72901.6893  24.2%  4392 3130s
  3895  2516 60539.9925   81  396 58700.3798 72901.6893  24.2%  4391 3135s
  3896  2516 63697.2170   17  429 58700.3798 72901.6893  24.2%  4390 3143s
  3897  2517 59570.7249   50  428 58700.3798 72901.6893  24.2%  4389 3152s
  3898  2518 64435.4336   51  391 58700.3798 72901.6893  24.2%  4388 3158s
  3899  2518 59883.7325   64  380 58700.3798 72901.6893  24.2%  4387 3162s
  3900  2519 62587.5044   22  425 58700.3798 72901.6893  24.2%  4385 3169s
  3901  2520 59949.5864   69  392 58700.3798 72901.6893  24.2%  4384 3179s
  3902  2520 60239.9307   46  403 58700.3798 72901.6893  24.2%  4383 3196s
  3903  2521 62059.8978   43  356 58700.3798 72901.6893  24.2%  4382 3206s
  3904  2522 60262.3039   35  395 58700.3798 72901.6893  24.2%  4381 3214s
  3905  2522 70417.2243   18  458 58700.3798 72901.6893  24.2%  4380 3232s
  3906  2523 66038.2285   30  409 58700.3798 72901.6893  24.2%  4379 3238s
  3907  2524 61522.3923   27  407 58700.3798 72901.6893  24.2%  4378 3242s
  3908  2524 69169.3950   10  414 58700.3798 72901.6893  24.2%  4376 3253s
  3909  2525 62505.0118   64  293 58700.3798 72901.6893  24.2%  4375 3255s
  3910  2526 68607.7936   10  287 58700.3798 72901.6893  24.2%  4374 3260s
  3911  2526 59087.8215   69  396 58700.3798 72901.6893  24.2%  4373 3273s
  3912  2527 69169.3950   10  405 58700.3798 72901.6893  24.2%  4372 3280s
  3913  2528 63509.4393   13  419 58700.3798 72901.6893  24.2%  4371 3285s
  3914  2528 66439.9878   11  405 58700.3798 72901.6893  24.2%  4370 3301s
  3915  2529 70393.9779   14  417 58700.3798 72901.6893  24.2%  4369 3306s
  3916  2530 59406.7163   52  405 58700.3798 72901.6893  24.2%  4367 3311s
  3917  2530 60158.2958   57  266 58700.3798 72901.6893  24.2%  4366 3321s
  3918  2531 62803.5516   22  410 58700.3798 72901.6893  24.2%  4365 3328s
  3919  2532 69520.9190   11  388 58700.3798 72901.6893  24.2%  4364 3332s
  3920  2532 68630.8656   29  399 58700.3798 72901.6893  24.2%  4363 3344s
  3921  2533 60167.8226   28  396 58700.3798 72901.6893  24.2%  4362 3351s
  3922  2534 69708.3041    8  387 58700.3798 72901.6893  24.2%  4361 3360s
  3923  2534 60697.2395   49  315 58700.3798 72901.6893  24.2%  4360 3367s
  3924  2535 64326.8503   18  315 58700.3798 72901.6893  24.2%  4359 3376s
  3925  2536 67609.0149   11  355 58700.3798 72901.6893  24.2%  4357 3380s
  3926  2536 61227.7206   23  375 58700.3798 72901.6893  24.2%  4356 3386s
  3927  2537 59664.3010   37  310 58700.3798 72901.6893  24.2%  4355 3393s
  3928  2538 65287.8794   15  310 58700.3798 72901.6893  24.2%  4354 3407s
  3929  2538 60823.2391   49  310 58700.3798 72901.6893  24.2%  4353 3476s
  3930  2542 72901.6893   15  297 58700.3798 72901.6893  24.2%  4448 3529s
  3932  2545 72901.6893   16  289 58700.3798 72901.6893  24.2%  4455 3578s
  3936  2548 72901.6893   17  293 58700.3798 72901.6893  24.2%  4468 3600s

Cutting planes:
  Learned: 2
  Projected implied bound: 64
  MIR: 281
  Flow cover: 715
  RLT: 8
  Relax-and-lift: 105

Explored 3940 nodes (18164488 simplex iterations) in 3600.09 seconds (8303.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 58700.4 58693.8 58485.8 ... 51554.1

Time limit reached
Best objective 5.870037983743e+04, best bound 7.290168927796e+04, gap 24.1929%
  WARNING: Time limit reached. Using best solution found (gap: 24.19%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 58700.38, θ = 217216.14
  Upper Bound (UB) = 58700.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 217216.14
  [DEBUG]   ✓ Scenario 0: θ = 217216.14 ≤ Q = 217216.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 217216.14 ≤ Q = 217216.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 217216.14 ≤ Q = 217216.14 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x26855c74
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd97aa38c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.541327e+13
Presolve removed 2610 rows and 1901 columns
Presolve time: 0.00s
Presolved: 483 rows, 488 columns, 1362 nonzeros
Found heuristic solution: objective 7455150.3471
Variable types: 332 continuous, 156 integer (156 binary)

Root relaxation: objective -1.587064e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158706.36    0  123 7455150.35 -158706.36   102%     -    0s
H    0     0                    -126804.1576 -158706.36  25.2%     -    0s
H    0     0                    -127797.7739 -158706.36  24.2%     -    0s
     0     0 -140988.74    0   95 -127797.77 -140988.74  10.3%     -    0s
H    0     0                    -137401.1214 -140948.29  2.58%     -    0s
H    0     0                    -137701.4851 -140948.29  2.36%     -    0s
H    0     0                    -138260.5963 -140948.29  1.94%     -    0s
H    0     0                    -138560.9599 -140948.29  1.72%     -    0s
     0     0 -139630.09    0   95 -138560.96 -139630.09  0.77%     -    0s
H    0     0                    -138781.6476 -139594.87  0.59%     -    0s
     0     0 -139483.65    0   93 -138781.65 -139483.65  0.51%     -    0s
     0     0 -139483.65    0   93 -138781.65 -139483.65  0.51%     -    0s
     0     0 -139165.21    0   53 -138781.65 -139165.21  0.28%     -    0s
     0     0 -139158.70    0   52 -138781.65 -139158.70  0.27%     -    0s
H    0     0                    -138797.9758 -139136.44  0.24%     -    0s
     0     0 -139130.75    0   45 -138797.98 -139130.75  0.24%     -    0s
     0     0 -139117.91    0   32 -138797.98 -139117.91  0.23%     -    0s
     0     0 -139117.86    0   31 -138797.98 -139117.86  0.23%     -    0s
     0     0 -138981.63    0   21 -138797.98 -138981.63  0.13%     -    0s
     0     0 -138978.08    0   19 -138797.98 -138978.08  0.13%     -    0s
     0     0 -138941.95    0   23 -138797.98 -138941.95  0.10%     -    0s
     0     0 -138893.71    0   10 -138797.98 -138893.71  0.07%     -    0s
     0     0 -138893.71    0    9 -138797.98 -138893.71  0.07%     -    0s
H    0     0                    -138809.1528 -138893.71  0.06%     -    0s
H    0     0                    -138861.9291 -138893.71  0.02%     -    0s
     0     0          -    0      -138861.93 -138871.85  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 3
  MIR: 3
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (805 simplex iterations) in 0.05 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -138862 -138809 -138798 ... 7.45515e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.388619290813e+05, best bound -1.388718483902e+05, gap 0.0071%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 207278.30
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138861.93
  [DEBUG]   S×d_nominal = 346140.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 346140.22 + -138861.93 = 207278.30
  [DEBUG]   Current θ from Master = 217216.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9937.85 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 48762.53
  Lower Bound (LB) = 58810.77
  Gap (UB-LB) = -110.3858, Absolute Gap = 110.3858, Relative Gap = -0.001880
  *** CONVERGED (small negative gap: -110.39 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 16
Total Time: 33515.77s
Converged: True
Final Lower Bound: 58810.7656
Final Upper Bound: 58700.3798
Final Gap: -110.385811
Number of Critical Scenarios: 16
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0, 1] (2/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 4
DCs Opened: [0, 2, 4, 7] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 1 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 16
Start Time: 2026-01-05 22:33:25
End Time: 2026-01-06 07:52:01
Total Time: 33515.77s
Optimal Value: 58810.77
Lower Bound: 58810.77
Upper Bound: 58700.38
Gap: -110.385811
Plants Opened: {0: [0, 1], 1: [0], 2: [1]} (4 plants)
DCs Opened: [0, 2, 4, 7] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed45_HD_gamma20_20260106_075201.csv

Total Execution Time: 33516.08 seconds
End Time: 2026-01-06 07:52:01

All tasks completed successfully!

