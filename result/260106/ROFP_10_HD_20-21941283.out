
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 10
DI Scenario: HD
Start Time: 2026-01-04 12:30:56
================================================================================
Loading data from data/DH_data_full_seed10.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.382', '1.910'] (k=0.798)
  Product 1: ['1.000', '1.342', '1.801'] (k=0.725)
  Product 2: ['1.000', '1.323', '1.751'] (k=0.691)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=904, max=1742
  DC capacity (MC): min=438, max=892

Demand Structure (s_rk matrix):
  Total customer-product pairs: 79/150 (47.3% sparse)
  Average products per customer: 1.58

Demand (only non-zero entries):
  Nominal (μ): min=8.52, max=33.66, count=79
  Deviation (μ̂): min=4.05, max=9.87

Costs:
  Plant fixed cost: min=5501, max=9136
  DC fixed cost: min=3621, max=5692
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.382', '1.910'] (k=0.798)
    Product 1: ['1.000', '1.342', '1.801'] (k=0.725)
    Product 2: ['1.000', '1.323', '1.751'] (k=0.691)
  MD:
    Product 0: ['1.000', '1.175', '1.380'] (k=0.397)
    Product 1: ['1.000', '1.208', '1.460'] (k=0.467)
    Product 2: ['1.000', '1.211', '1.467'] (k=0.473)
  LD:
    Product 0: ['1.000', '1.109', '1.229'] (k=0.254)
    Product 1: ['1.000', '1.073', '1.151'] (k=0.174)
    Product 2: ['1.000', '1.057', '1.117'] (k=0.137)
  Mixed:
    Product 0: ['1.000', '1.382', '1.910'] (k=0.798)
    Product 1: ['1.000', '1.208', '1.460'] (k=0.467)
    Product 2: ['1.000', '1.057', '1.117'] (k=0.137)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48747 nonzeros
Model fingerprint: 0x62d8d33c
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11912 rows and 2912 columns
Presolve time: 0.08s
Presolved: 4761 rows, 5588 columns, 33115 nonzeros
Variable types: 3329 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -287698.9183
Found heuristic solution: objective -178662.4534

Root relaxation: objective 1.289516e+05, 5221 iterations, 0.24 seconds (0.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 128951.624    0  592 -178662.45 128951.624   172%     -    0s
H    0     0                    -173984.4025 128951.624   174%     -    0s
H    0     0                    -173170.5810 128951.624   174%     -    0s
     0     0 118439.116    0  784 -173170.58 118439.116   168%     -    1s
H    0     0                    -170094.3754 118437.797   170%     -    1s
     0     0 118248.689    0  784 -170094.38 118248.689   170%     -    1s
     0     0 118240.466    0  783 -170094.38 118240.466   170%     -    1s
     0     0 118239.877    0  786 -170094.38 118239.877   170%     -    1s
     0     0 108726.539    0  861 -170094.38 108726.539   164%     -    2s
     0     0 108105.480    0  871 -170094.38 108105.480   164%     -    2s
     0     0 107999.781    0  875 -170094.38 107999.781   163%     -    2s
     0     0 107968.714    0  882 -170094.38 107968.714   163%     -    2s
     0     0 107964.132    0  887 -170094.38 107964.132   163%     -    2s
H    0     0                    -117366.6693 100380.273   186%     -    4s
H    0     0                    -112980.6896 100380.273   189%     -    4s
H    0     0                    -112197.0834 100380.273   189%     -    4s
H    0     0                    -111479.3638 100380.273   190%     -    4s
H    0     0                    -110715.1196 100380.273   191%     -    4s
H    0     0                    -110088.4286 100380.273   191%     -    4s
H    0     0                    -109289.5117 100380.273   192%     -    4s
H    0     0                    -108958.2855 100380.273   192%     -    4s
H    0     0                    -108412.2405 100380.273   193%     -    4s
H    0     0                    -107711.1566 100380.273   193%     -    4s
H    0     0                    -107330.7117 100380.273   194%     -    4s
H    0     0                    -106973.4068 100380.273   194%     -    4s
H    0     0                    -106267.8184 100380.273   194%     -    4s
     0     0 100380.273    0  919 -106267.82 100380.273   194%     -    4s
     0     0 99906.9152    0  930 -106267.82 99906.9152   194%     -    4s
     0     0 99759.2580    0  956 -106267.82 99759.2580   194%     -    4s
     0     0 99740.1776    0  946 -106267.82 99740.1776   194%     -    4s
     0     0 99739.5908    0  953 -106267.82 99739.5908   194%     -    4s
H    0     0                    -105789.5353 99739.5908   194%     -    5s
H    0     0                    -51053.85583 99739.5908   295%     -    5s
H    0     0                    16617.998384 99739.5908   500%     -    5s
     0     0 92820.5862    0  875 16617.9984 92820.5862   459%     -    6s
H    0     0                    17762.206589 92376.4303   420%     -    7s
H    0     0                    17785.281254 92376.4303   419%     -    7s
H    0     0                    20134.355041 92376.4303   359%     -    7s
H    0     0                    24020.328240 92376.4303   285%     -    7s
H    0     0                    25379.049964 92376.4303   264%     -    7s
H    0     0                    30151.283371 92376.4303   206%     -    7s
H    0     0                    30174.358036 92376.4303   206%     -    7s
H    0     0                    38988.927669 92376.4303   137%     -    7s
H    0     0                    39118.731765 92376.4303   136%     -    7s
H    0     0                    39160.589898 92376.4303   136%     -    7s
H    0     0                    39168.785484 92376.4303   136%     -    7s
H    0     0                    39190.580849 92376.4303   136%     -    7s
     0     0 92376.4303    0  934 39190.5808 92376.4303   136%     -    7s
     0     0 92259.1656    0  893 39190.5808 92259.1656   135%     -    7s
     0     0 92241.6199    0  959 39190.5808 92241.6199   135%     -    7s
     0     0 92235.4840    0  952 39190.5808 92235.4840   135%     -    7s
H    0     0                    39217.484572 84921.9927   117%     -    8s
H    0     0                    39613.338435 84921.9927   114%     -    8s
H    0     0                    39632.592836 84921.9927   114%     -    8s
     0     0 84921.9927    0  641 39632.5928 84921.9927   114%     -    8s
     0     0 83811.7080    0  741 39632.5928 83811.7080   111%     -    9s
H    0     0                    39655.186495 83581.0878   111%     -    9s
H    0     0                    39909.073191 83581.0878   109%     -    9s
H    0     0                    39918.749120 83581.0878   109%     -    9s
H    0     0                    40241.561971 83581.0878   108%     -    9s
     0     0 83581.0878    0  792 40241.5620 83581.0878   108%     -    9s
H    0     0                    40361.375767 83543.0337   107%     -    9s
H    0     0                    40743.437106 83543.0337   105%     -    9s
H    0     0                    40965.182667 83543.0337   104%     -    9s
     0     0 83543.0337    0  779 40965.1827 83543.0337   104%     -    9s
H    0     0                    41323.245105 83531.2846   102%     -    9s
H    0     0                    41492.871572 83531.2846   101%     -    9s
     0     0 83531.2846    0  810 41492.8716 83531.2846   101%     -    9s
H    0     0                    41922.900506 83531.2846  99.2%     -    9s
H    0     0                    42510.421209 83531.2846  96.5%     -    9s
H    0     0                    42624.112118 83531.2846  96.0%     -    9s
H    0     0                    42789.785841 79720.4314  86.3%     -   10s
H    0     0                    43009.640053 79720.4314  85.4%     -   10s
H    0     0                    43034.029542 79720.4314  85.2%     -   10s
     0     0 79720.4314    0  629 43034.0295 79720.4314  85.2%     -   10s
H    0     0                    44500.985035 79189.3576  77.9%     -   10s
H    0     0                    45117.261289 79189.3576  75.5%     -   10s
H    0     0                    45832.198061 79189.3576  72.8%     -   10s
H    0     0                    46206.656824 79189.3576  71.4%     -   10s
H    0     0                    46353.602668 79189.3576  70.8%     -   10s
H    0     0                    46669.466256 79189.3576  69.7%     -   10s
     0     0 79189.3576    0  681 46669.4663 79189.3576  69.7%     -   10s
     0     0 79004.6666    0  711 46669.4663 79004.6666  69.3%     -   10s
     0     0 78973.4682    0  732 46669.4663 78973.4682  69.2%     -   11s
     0     0 78957.7985    0  762 46669.4663 78957.7985  69.2%     -   11s
     0     0 77103.7308    0  616 46669.4663 77103.7308  65.2%     -   11s
H    0     0                    47228.123751 76609.6179  62.2%     -   12s
     0     0 76609.6179    0  729 47228.1238 76609.6179  62.2%     -   12s
H    0     0                    48029.783612 76519.6467  59.3%     -   12s
H    0     0                    48177.174187 76519.6467  58.8%     -   12s
     0     0 76519.6467    0  731 48177.1742 76519.6467  58.8%     -   12s
H    0     0                    48297.222473 76500.7545  58.4%     -   12s
H    0     0                    48301.721458 76500.7545  58.4%     -   12s
     0     0 76500.7545    0  747 48301.7215 76500.7545  58.4%     -   12s
H    0     0                    48415.550072 75258.5900  55.4%     -   13s
H    0     0                    48541.402921 75258.5900  55.0%     -   13s
H    0     0                    48641.731359 75258.5900  54.7%     -   13s
H    0     0                    48695.640507 75258.5900  54.5%     -   13s
H    0     0                    48775.675150 75258.5900  54.3%     -   13s
     0     0 75258.5900    0  616 48775.6751 75258.5900  54.3%     -   13s
     0     0 74917.2638    0  709 48775.6751 74917.2638  53.6%     -   13s
     0     0 74773.3919    0  722 48775.6751 74773.3919  53.3%     -   13s
     0     0 74748.3329    0  704 48775.6751 74748.3329  53.2%     -   13s
     0     0 73518.4608    0  654 48775.6751 73518.4608  50.7%     -   14s
     0     0 73301.6257    0  826 48775.6751 73301.6257  50.3%     -   15s
     0     0 73216.8918    0  748 48775.6751 73216.8918  50.1%     -   15s
     0     0 73193.3966    0  853 48775.6751 73193.3966  50.1%     -   15s
     0     0 72259.4436    0  749 48775.6751 72259.4436  48.1%     -   16s
     0     0 72105.6861    0  768 48775.6751 72105.6861  47.8%     -   16s
     0     0 72062.9081    0  795 48775.6751 72062.9081  47.7%     -   17s
     0     0 71558.4334    0  709 48775.6751 71558.4334  46.7%     -   17s
     0     0 71487.1504    0  710 48775.6751 71487.1504  46.6%     -   18s
     0     0 71458.6483    0  698 48775.6751 71458.6483  46.5%     -   18s
     0     0 71079.4462    0  661 48775.6751 71079.4462  45.7%     -   18s
     0     0 71078.4042    0  661 48775.6751 71078.4042  45.7%     -   19s
     0     2 71078.0361    0  661 48775.6751 71078.0361  45.7%     -   20s
    31    64 69670.1793    5  461 48775.6751 69855.9871  43.2%  2751   25s
H   33    64                    48868.374969 69855.9871  42.9%  2599   25s
H   34    64                    49035.017001 69855.9871  42.5%  2560   25s
H  388   390                    49355.397671 69667.8530  41.2%   822   29s
   389   489 67792.9307   12  468 49355.3977 69667.8530  41.2%   823   30s
H  490   572                    50152.163043 69667.8530  38.9%   745   30s
H  492   572                    50661.316977 69667.8530  37.5%   745   30s
H  493   572                    51768.536513 69667.8530  34.6%   745   30s
H  676   737                    52185.675206 69667.8530  33.5%   679   31s
H  734   737                    52205.114621 69667.8530  33.5%   650   31s
H  833   888                    52228.791163 69667.8530  33.4%   624   33s
H  872   888                    52232.566276 69667.8530  33.4%   614   33s
H  880   888                    52334.962639 69667.8530  33.1%   611   33s
H 1005  1021                    52360.729438 69667.8530  33.1%   580   34s
H 1007  1021                    52653.396602 69667.8530  32.3%   580   34s
  1077  1081 64920.7027   17  489 52653.3966 69667.8530  32.3%   571   35s
H 1237  1205                    52744.095749 69548.3394  31.9%   564   36s
H 1249  1205                    52802.362935 69548.3394  31.7%   565   36s
H 1285  1205                    52820.614991 68926.8610  30.5%   567   36s
  1778  1808 59783.8015   29  319 52820.6150 68926.8610  30.5%   540   40s
H 2536  2367                    53403.191618 68495.2960  28.3%   458   43s
  2749  2551 58231.6193   46  379 53403.1916 68248.3601  27.8%   455   45s
  3618  3051 65308.6920   15  661 53403.1916 68057.7411  27.4%   446   60s
  3650  3072 61572.1351   29  499 53403.1916 66372.7794  24.3%   442   65s
H 3650  2917                    53479.124664 66372.7794  24.1%   442   65s
H 3969  2918                    54078.613216 63457.0548  17.3%   435   69s
H 4005  2766                    54722.856366 63339.5899  15.7%   433   69s
H 4205  2585                    54745.628998 62681.7922  14.5%   421   69s
H 4221  2455                    54796.311152 62681.7922  14.4%   420   69s
H 4312  2322                    54797.809250 62547.8203  14.1%   415   70s
H 4348  2197                    55101.664956 62544.6142  13.5%   414   70s
H 4366  2083                    55198.367113 62544.6142  13.3%   412   70s
H 4448  1971                    55296.105035 61834.0505  11.8%   409   70s
H 4662  1840                    55449.621542 61247.1854  10.5%   399   71s
H 5709  1355                    55621.706185 58916.1773  5.92%   355   73s
H 5749  1254                    55733.879930 58916.1773  5.71%   353   73s
H 6115   929                    55940.480795 58372.0913  4.35%   336   73s

Cutting planes:
  Gomory: 2
  Implied bound: 6
  Projected implied bound: 6
  MIR: 109
  Flow cover: 369
  RLT: 14
  Relax-and-lift: 52
  BQP: 1

Explored 6809 nodes (2148289 simplex iterations) in 73.74 seconds (158.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 55940.5 55733.9 55621.7 ... 54722.9

Optimal solution found (tolerance 1.00e-04)
Best objective 5.594048079487e+04, best bound 5.594048079487e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 73.74s
  Master Objective (UB) = 55940.48, θ = 204816.41
  Upper Bound (UB) = 55940.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 204816.41
  [DEBUG]   ✓ Scenario 0: θ = 204816.41 ≤ Q = 204816.41 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x446e724
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfbb918dc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.394227e+13
Presolve removed 2607 rows and 1899 columns
Presolve time: 0.00s
Presolved: 486 rows, 490 columns, 1373 nonzeros
Found heuristic solution: objective 6665256.0084
Variable types: 332 continuous, 158 integer (158 binary)

Root relaxation: objective -1.590370e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159036.97    0  123 6665256.01 -159036.97   102%     -    0s
H    0     0                    -126409.7404 -159036.97  25.8%     -    0s
H    0     0                    -128658.8901 -128658.89  0.00%     -    0s
     0     0          -    0      -128658.89 -128658.89  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 202

Explored 1 nodes (368 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 4: -128659 -126410 6.66526e+06 1.39423e+13 
No other solutions better than -128659

Optimal solution found (tolerance 1.00e-04)
Best objective -1.286588901451e+05, best bound -1.286588901451e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 173103.84
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128658.89
  [DEBUG]   S×d_nominal = 301762.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 301762.73 + -128658.89 = 173103.84
  [DEBUG]   Current θ from Master = 204816.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31712.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24227.91
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 31712.5668, Absolute Gap = 31712.5668, Relative Gap = 0.566898
  Not converged yet (gap = 31712.57 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91975 nonzeros
Model fingerprint: 0x38230591
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 24227.9 (0.01s)
MIP start from previous solve produced solution with objective 24227.9 (0.01s)
Loaded MIP start from previous solve with objective 24227.9

Presolve removed 14403 rows and 5842 columns
Presolve time: 0.31s
Presolved: 17560 rows, 8898 columns, 97148 nonzeros
Variable types: 6639 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.919278e+04, 9666 iterations, 0.92 seconds (1.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 69192.7760    0  253 24227.9140 69192.7760   186%     -    1s
H    0     0                    28305.196250 69192.7760   144%     -    1s
H    0     0                    28931.504671 69192.7760   139%     -    1s
H    0     0                    29278.189510 69192.7760   136%     -    1s
     0     0 58179.4794    0  375 29278.1895 58179.4794  98.7%     -    2s
H    0     0                    29645.568019 58178.9300  96.2%     -    2s
     0     0 57738.8316    0  372 29645.5680 57738.8316  94.8%     -    2s
     0     0 57724.8003    0  415 29645.5680 57724.8003  94.7%     -    2s
     0     0 57721.9302    0  365 29645.5680 57721.9302  94.7%     -    2s
     0     0 53178.4469    0  398 29645.5680 53178.4469  79.4%     -    3s
     0     0 51987.1390    0  351 29645.5680 51987.1390  75.4%     -    3s
     0     0 51977.7843    0  347 29645.5680 51977.7843  75.3%     -    4s
     0     0 51977.7843    0  369 29645.5680 51977.7843  75.3%     -    4s
     0     0 51977.7843    0  370 29645.5680 51977.7843  75.3%     -    4s
     0     0 48365.9718    0  318 29645.5680 48365.9718  63.1%     -    5s
     0     0 47515.8972    0  416 29645.5680 47515.8972  60.3%     -    6s
     0     0 47285.5398    0  435 29645.5680 47285.5398  59.5%     -    6s
     0     0 47266.6173    0  439 29645.5680 47266.6173  59.4%     -    6s
     0     0 47254.4692    0  438 29645.5680 47254.4692  59.4%     -    6s
     0     0 47249.4219    0  437 29645.5680 47249.4219  59.4%     -    6s
     0     0 47249.3556    0  440 29645.5680 47249.3556  59.4%     -    6s
     0     0 45622.1895    0  497 29645.5680 45622.1895  53.9%     -    8s
     0     0 45395.9368    0  415 29645.5680 45395.9368  53.1%     -    9s
     0     0 45316.3624    0  507 29645.5680 45316.3624  52.9%     -    9s
     0     0 45289.1120    0  506 29645.5680 45289.1120  52.8%     -    9s
     0     0 45280.9975    0  499 29645.5680 45280.9975  52.7%     -    9s
     0     0 45278.6829    0  498 29645.5680 45278.6829  52.7%     -    9s
     0     0 44496.1437    0  461 29645.5680 44496.1437  50.1%     -   10s
H    0     0                    29708.926604 44313.3863  49.2%     -   11s
     0     0 44313.3863    0  486 29708.9266 44313.3863  49.2%     -   11s
     0     0 44266.0317    0  561 29708.9266 44266.0317  49.0%     -   11s
     0     0 44228.8414    0  554 29708.9266 44228.8414  48.9%     -   11s
     0     0 44214.0623    0  570 29708.9266 44214.0623  48.8%     -   11s
     0     0 44206.1131    0  567 29708.9266 44206.1131  48.8%     -   11s
     0     0 44203.7485    0  574 29708.9266 44203.7485  48.8%     -   11s
     0     0 43633.4555    0  376 29708.9266 43633.4555  46.9%     -   12s
H    0     0                    30724.236821 43632.9643  42.0%     -   12s
H    0     0                    31341.291401 43632.9643  39.2%     -   12s
H    0     0                    31853.037588 43632.9643  37.0%     -   12s
     0     0 43549.0643    0  427 31853.0376 43549.0643  36.7%     -   13s
     0     0 43526.0594    0  390 31853.0376 43526.0594  36.6%     -   13s
     0     0 43517.9778    0  384 31853.0376 43517.9778  36.6%     -   13s
     0     0 43515.6129    0  384 31853.0376 43515.6129  36.6%     -   13s
     0     0 43265.7394    0  399 31853.0376 43265.7394  35.8%     -   13s
     0     0 43203.2324    0  473 31853.0376 43203.2324  35.6%     -   14s
     0     0 43183.8026    0  396 31853.0376 43183.8026  35.6%     -   14s
     0     0 43181.2085    0  401 31853.0376 43181.2085  35.6%     -   14s
     0     0 43083.6788    0  535 31853.0376 43083.6788  35.3%     -   14s
     0     0 43061.1608    0  409 31853.0376 43061.1608  35.2%     -   15s
     0     0 43045.3873    0  639 31853.0376 43045.3873  35.1%     -   15s
     0     0 43041.2652    0  647 31853.0376 43041.2652  35.1%     -   15s
     0     0 42977.5949    0  662 31853.0376 42977.5949  34.9%     -   16s
     0     0 42940.2102    0  506 31853.0376 42940.2102  34.8%     -   16s
     0     0 42932.6277    0  639 31853.0376 42932.6277  34.8%     -   16s
     0     0 42930.8278    0  625 31853.0376 42930.8278  34.8%     -   16s
     0     0 42909.1907    0  392 31853.0376 42909.1907  34.7%     -   16s
     0     0 42896.2512    0  422 31853.0376 42896.2512  34.7%     -   17s
     0     0 42890.1575    0  352 31853.0376 42890.1575  34.7%     -   17s
     0     0 42865.0686    0  478 31853.0376 42865.0686  34.6%     -   17s
     0     0 42858.4886    0  467 31853.0376 42858.4886  34.6%     -   17s
     0     0 42843.9640    0  401 31853.0376 42843.9640  34.5%     -   18s
     0     0 42838.6888    0  401 31853.0376 42838.6888  34.5%     -   18s
     0     2 42838.6888    0  401 31853.0376 42838.6888  34.5%     -   21s
H   32    64                    32709.388454 42070.4795  28.6%  1000   24s
H   36    64                    33711.864673 42070.4795  24.8%  1000   24s
    63    96 40388.0756    6  416 33711.8647 41737.9960  23.8%  1210   25s
H   66    96                    33951.591056 41737.9960  22.9%  1218   25s
H   70    96                    34321.800366 41737.9960  21.6%  1224   25s
H   83    96                    34433.154617 41737.9960  21.2%  1266   25s
H   85    96                    34454.807827 41737.9960  21.1%  1266   25s
H   86    96                    34478.906442 41737.9960  21.1%  1263   25s
H   87    96                    34512.698614 41737.9960  20.9%  1255   25s
H  213   239                    34528.038216 41737.9960  20.9%   763   27s
H  239   239                    34663.505499 41737.9960  20.4%   731   27s
H  254   239                    34666.105829 41737.9960  20.4%   716   27s
H  270   277                    34669.920742 41737.9960  20.4%   700   28s
   426   377 37686.8001   11  365 34669.9207 41460.7008  19.6%   633   30s
   715   537 36738.4852   14  314 34669.9207 40627.9030  17.2%   549   35s
  1110   768 38322.1934   11  279 34669.9207 40626.1664  17.2%   494   40s
H 1534   981                    34688.097791 40200.9968  15.9%   441   43s
  1718  1122 35361.2632   31  273 34688.0978 40170.9772  15.8%   424   45s
  2351  1413 39095.6325   12  216 34688.0978 39918.3723  15.1%   383   50s
  2857  1650 35583.5992   17  166 34688.0978 39844.8117  14.9%   378   56s
  3253  1753 35359.1077   20  158 34688.0978 39496.9972  13.9%   372   60s
  3843  2069     cutoff   11      34688.0978 39348.1224  13.4%   360   65s
  4869  2427 36196.3552   23  104 34688.0978 39051.7731  12.6%   345   71s
  5525  2579     cutoff   14      34688.0978 38768.6179  11.8%   344   76s
  6511  2809 34837.6456   53  120 34688.0978 38479.0462  10.9%   334   81s
  7484  2997     cutoff   11      34688.0978 38250.7143  10.3%   336   86s
  7883  2998 35553.2926   21  401 34688.0978 38157.7703  10.0%   334   95s
  7890  3003 37417.8988   17  375 34688.0978 38157.7703  10.0%   333  100s
  7903  3011 36211.8066   16  400 34688.0978 38157.7703  10.0%   333  105s
  7909  3015 35256.9920   12  400 34688.0978 38157.7703  10.0%   333  110s
  7940  3052 38157.7703   19  280 34688.0978 38157.7703  10.0%   338  115s
  8204  3029     cutoff   24      34688.0978 38157.7703  10.0%   347  120s
  8689  2858 35293.1905   38  144 34688.0978 37802.5219  8.98%   347  125s
  9209  2591 34863.3978   30  160 34688.0978 35246.0213  1.61%   342  130s

Cutting planes:
  MIR: 128
  Mixing: 1
  Flow cover: 364
  Relax-and-lift: 26

Explored 9303 nodes (3193974 simplex iterations) in 130.28 seconds (328.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 34688.1 34669.9 34528 ... 33711.9

Optimal solution found (tolerance 1.00e-04)
Best objective 3.468809779082e+04, best bound 3.468809779082e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 130.29s
  Master Objective (UB) = 34688.10, θ = 175217.30
  Upper Bound (UB) = 34688.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 175217.30
  [DEBUG]   ✓ Scenario 0: θ = 175217.30 ≤ Q = 175217.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 175217.30 ≤ Q = 175217.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xebf2ed2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0ebf2ed2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.300339e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1357 nonzeros
Found heuristic solution: objective 5951408.0780
Variable types: 329 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5950935.0429

Root relaxation: objective -1.684893e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168489.32    0  123 5950935.04 -168489.32   103%     -    0s
H    0     0                    -147940.8577 -168489.32  13.9%     -    0s
H    0     0                    -148191.4441 -154717.59  4.40%     -    0s
H    0     0                    -150367.3420 -154717.59  2.89%     -    0s
     0     0 -154717.59    0   81 -150367.34 -154717.59  2.89%     -    0s
H    0     0                    -152188.2243 -154642.97  1.61%     -    0s
H    0     0                    -153411.0417 -154153.40  0.48%     -    0s
     0     0 -154153.40    0   73 -153411.04 -154153.40  0.48%     -    0s
     0     0 -154153.33    0   71 -153411.04 -154153.33  0.48%     -    0s
     0     0 -154077.95    0   60 -153411.04 -154077.95  0.43%     -    0s
     0     0 -154077.54    0   60 -153411.04 -154077.54  0.43%     -    0s
     0     0 -153704.14    0   20 -153411.04 -153704.14  0.19%     -    0s
     0     0 -153624.08    0   19 -153411.04 -153624.08  0.14%     -    0s
     0     0 -153520.82    0   18 -153411.04 -153520.82  0.07%     -    0s
     0     0 -153499.52    0    9 -153411.04 -153499.52  0.06%     -    0s
H    0     0                    -153431.6286 -153489.84  0.04%     -    0s
     0     0 -153489.84    0    8 -153431.63 -153489.84  0.04%     -    0s
     0     0 -153485.90    0    9 -153431.63 -153485.90  0.04%     -    0s
     0     0          -    0      -153431.63 -153444.30  0.01%     -    0s

Cutting planes:
  Gomory: 52
  Implied bound: 2
  MIR: 85
  Flow cover: 2
  RLT: 65
  Relax-and-lift: 7
  BQP: 3

Explored 1 nodes (553 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -153432 -153411 -152188 ... 1.30034e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.534316285815e+05, best bound -1.534443019685e+05, gap 0.0083%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 151094.16
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -153431.63
  [DEBUG]   S×d_nominal = 304525.79
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 304525.79 + -153431.63 = 151094.16
  [DEBUG]   Current θ from Master = 175217.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24123.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10564.95
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 10460.1837, Absolute Gap = 10460.1837, Relative Gap = 0.301550
  Not converged yet (gap = 10460.18 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135203 nonzeros
Model fingerprint: 0x6e3ca137
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 10565 (0.02s)
Loaded MIP start from previous solve with objective 10565

Presolve removed 21603 rows and 8763 columns
Presolve time: 0.45s
Presolved: 25650 rows, 12217 columns, 143414 nonzeros
Variable types: 9958 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.38s

Solved with dual simplex

Root relaxation: objective 6.744092e+04, 18789 iterations, 3.92 seconds (7.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67440.9249    0  257 10564.9526 67440.9249   538%     -    4s
H    0     0                    14812.406769 67440.9249   355%     -    4s
H    0     0                    24321.446756 67440.9249   177%     -    4s
H    0     0                    25655.838875 67440.9249   163%     -    4s
H    0     0                    26595.898605 67440.9249   154%     -    4s
H    0     0                    26704.913373 67440.9249   153%     -    4s
H    0     0                    26821.037857 67440.9249   151%     -    4s
H    0     0                    26856.493457 67440.9249   151%     -    4s
H    0     0                    26877.506979 67440.9249   151%     -    4s
H    0     0                    26951.187620 67440.9249   150%     -    4s
H    0     0                    27260.642704 67440.9249   147%     -    5s
H    0     0                    27867.073507 57357.6384   106%     -    6s
     0     0 57332.6633    0  322 27867.0735 57332.6633   106%     -    6s
     0     0 56981.8735    0  323 27867.0735 56981.8735   104%     -    7s
     0     0 56981.8735    0  322 27867.0735 56981.8735   104%     -    7s
     0     0 51495.4351    0  373 27867.0735 51495.4351  84.8%     -    9s
H    0     0                    27869.917607 51485.7203  84.7%     -    9s
H    0     0                    27952.676463 51485.7203  84.2%     -    9s
     0     0 50250.3098    0  371 27952.6765 50250.3098  79.8%     -   10s
     0     0 50045.5452    0  382 27952.6765 50045.5452  79.0%     -   11s
     0     0 49981.7088    0  389 27952.6765 49981.7088  78.8%     -   11s
     0     0 49945.5757    0  432 27952.6765 49945.5757  78.7%     -   11s
     0     0 49943.6494    0  432 27952.6765 49943.6494  78.7%     -   11s
H    0     0                    28450.591708 49943.6494  75.5%     -   12s
H    0     0                    28458.921526 45867.0326  61.2%     -   14s
H    0     0                    28560.649275 45867.0326  60.6%     -   14s
H    0     0                    28883.987527 45867.0326  58.8%     -   14s
     0     0 45867.0326    0  371 28883.9875 45867.0326  58.8%     -   15s
     0     0 45341.6572    0  403 28883.9875 45341.6572  57.0%     -   15s
     0     0 45251.3035    0  399 28883.9875 45251.3035  56.7%     -   16s
     0     0 45145.2337    0  399 28883.9875 45145.2337  56.3%     -   16s
     0     0 45128.6053    0  400 28883.9875 45128.6053  56.2%     -   16s
     0     0 45075.8977    0  402 28883.9875 45075.8977  56.1%     -   16s
     0     0 45065.4380    0  403 28883.9875 45065.4380  56.0%     -   17s
     0     0 45059.9246    0  411 28883.9875 45059.9246  56.0%     -   17s
     0     0 45059.4816    0  409 28883.9875 45059.4816  56.0%     -   17s
     0     0 43463.0110    0  473 28883.9875 43463.0110  50.5%     -   20s
     0     0 43141.3058    0  503 28883.9875 43141.3058  49.4%     -   22s
     0     0 43056.8631    0  571 28883.9875 43056.8631  49.1%     -   22s
     0     0 43035.5945    0  503 28883.9875 43035.5945  49.0%     -   23s
     0     0 43018.7546    0  565 28883.9875 43018.7546  48.9%     -   23s
     0     0 43012.3953    0  497 28883.9875 43012.3953  48.9%     -   23s
     0     0 43010.5905    0  564 28883.9875 43010.5905  48.9%     -   23s
     0     0 42466.7268    0  478 28883.9875 42466.7268  47.0%     -   25s
     0     0 42255.2381    0  494 28883.9875 42255.2381  46.3%     -   26s
     0     0 42200.2493    0  434 28883.9875 42200.2493  46.1%     -   26s
     0     0 42150.6879    0  564 28883.9875 42150.6879  45.9%     -   26s
     0     0 42141.7915    0  578 28883.9875 42141.7915  45.9%     -   27s
     0     0 42135.7390    0  583 28883.9875 42135.7390  45.9%     -   27s
     0     0 41896.3254    0  388 28883.9875 41896.3254  45.1%     -   28s
     0     0 41704.4551    0  415 28883.9875 41704.4551  44.4%     -   29s
     0     0 41637.3238    0  406 28883.9875 41637.3238  44.2%     -   29s
     0     0 41615.2667    0  340 28883.9875 41615.2667  44.1%     -   30s
     0     0 41602.9916    0  412 28883.9875 41602.9916  44.0%     -   30s
     0     0 41598.7243    0  411 28883.9875 41598.7243  44.0%     -   30s
     0     0 41533.8063    0  397 28883.9875 41533.8063  43.8%     -   31s
H    0     0                    28895.621957 41533.6951  43.7%     -   31s
H    0     0                    28900.314960 41533.6951  43.7%     -   31s
     0     0 41491.4641    0  410 28900.3150 41491.4641  43.6%     -   31s
     0     0 41478.0140    0  502 28900.3150 41478.0140  43.5%     -   32s
     0     0 41470.8239    0  429 28900.3150 41470.8239  43.5%     -   32s
     0     0 41469.2212    0  433 28900.3150 41469.2212  43.5%     -   32s
     0     0 41377.8116    0  553 28900.3150 41377.8116  43.2%     -   33s
     0     0 41346.7919    0  615 28900.3150 41346.7919  43.1%     -   34s
     0     0 41340.6899    0  569 28900.3150 41340.6899  43.0%     -   34s
     0     0 41298.9461    0  405 28900.3150 41298.9461  42.9%     -   35s
     0     0 41275.9659    0  411 28900.3150 41275.9659  42.8%     -   35s
     0     0 41266.5642    0  403 28900.3150 41266.5642  42.8%     -   36s
     0     0 41264.4212    0  405 28900.3150 41264.4212  42.8%     -   36s
     0     0 41229.9747    0  525 28900.3150 41229.9747  42.7%     -   37s
H    0     0                    29009.186358 41229.9238  42.1%     -   37s
     0     0 41220.7672    0  515 29009.1864 41220.7672  42.1%     -   37s
     0     0 41218.9964    0  515 29009.1864 41218.9964  42.1%     -   38s
     0     0 41216.5758    0  359 29009.1864 41216.5758  42.1%     -   38s
     0     0 41214.7236    0  379 29009.1864 41214.7236  42.1%     -   38s
     0     0 41210.4747    0  374 29009.1864 41210.4747  42.1%     -   39s
     0     0 41210.4462    0  374 29009.1864 41210.4462  42.1%     -   39s
     0     2 41210.4462    0  374 29009.1864 41210.4462  42.1%     -   46s
     3     8 40565.9627    2  387 29009.1864 40830.0469  40.7%  2296   50s
    31    64 39608.8727    5  495 29009.1864 40390.6512  39.2%  3011   56s
H   39    64                    29108.825008 40390.6214  38.8%  2654   56s
H   41    64                    29149.656353 40390.6214  38.6%  2548   56s
   215   281 38277.1036    9  501 29149.6564 40345.2352  38.4%  1081   60s
H  300   328                    29159.502057 40345.2352  38.4%  1031   62s
   390   440 37804.1454   11  435 29159.5021 40345.2352  38.4%   990   66s
H  474   471                    29323.435445 40345.2352  37.6%  1064   68s
   478   501 33688.0942   12  417 29323.4354 40345.2352  37.6%  1065   70s
H  483   501                    29398.083520 40345.2352  37.2%  1074   70s
H  598   587                    29404.131273 40266.5834  36.9%  1068   73s
   610   641 36559.5384   14  395 29404.1313 40266.5834  36.9%  1066   75s
   784   770 34619.2138   20  322 29404.1313 40068.5479  36.3%  1020   81s
H  797   770                    29513.689264 40068.5479  35.8%  1025   81s
   921   866 infeasible   21      29513.6893 40068.5479  35.8%  1001   86s
  1080  1031 33476.1694   23  317 29513.6893 40068.5479  35.8%   969   90s
  1346  1260 33345.6074   27  276 29513.6893 40068.5479  35.8%   866   95s
H 1540  1319                    29564.942306 40068.5479  35.5%   806   97s
  1743  1591 31783.5338   39  184 29564.9423 40068.5479  35.5%   769  101s
H 1946  1620                    29753.486423 39606.7458  33.1%   729  102s
H 1956  1620                    29780.358259 39606.7458  33.0%   727  102s
H 1966  1620                    29783.839469 39606.7458  33.0%   729  102s
  1976  1765 31085.7424   47  137 29783.8395 39606.7458  33.0%   727  105s
  2412  2038 36715.9370   10  430 29783.8395 39490.3410  32.6%   665  110s
  2753  2183 32141.2560   15  286 29783.8395 39206.9585  31.6%   654  115s
H 2756  2178                    29870.844047 39206.9585  31.3%   654  115s
H 2775  2178                    29884.771493 39206.9585  31.2%   651  115s
H 2779  2165                    30049.678154 39206.9585  30.5%   651  115s
  3154  2452 30596.2015   20  256 30049.6782 39088.5985  30.1%   649  121s
  3304  2657 35489.4565    8  382 30049.6782 39088.5985  30.1%   649  125s
H 3878  2844                    30051.377585 39088.5985  30.1%   608  129s
  3879  2845 35736.1458   12  374 30051.3776 39088.5985  30.1%   608  140s
H 3880  2703                    30055.963379 39088.5985  30.1%   608  144s
  3882  2704 31896.2929   32  310 30055.9634 39088.5985  30.1%   607  147s
H 3883  2570                    30079.911789 39088.5985  29.9%   607  149s
  3884  2570 31310.2142   19  424 30079.9118 39088.5985  29.9%   607  150s
H 3892  2447                    30159.309749 39088.5985  29.6%   606  154s
H 3892  2324                    30191.336047 39088.5985  29.5%   606  154s
H 3892  2208                    30283.919295 39088.5985  29.1%   606  154s
  3894  2209 30517.0497   49  375 30283.9193 39088.5985  29.1%   605  155s
  3902  2214 32615.4839   17  380 30283.9193 39088.5985  29.1%   604  160s
H 3904  2105                    30355.286475 39088.5985  28.8%   604  162s
  3910  2109 32359.3155   57  455 30355.2865 39088.5985  28.8%   603  165s
  3915  2112 33754.4505   36  393 30355.2865 39088.5985  28.8%   602  172s
  3916  2113 33271.0896   27  393 30355.2865 39088.5985  28.8%   602  176s
H 3916  2008                    30372.105429 39088.5985  28.7%   613  177s
  3919  2013 39070.3968   14  384 30372.1054 39088.5985  28.7%   614  180s
  3931  2031 38529.1361   16  385 30372.1054 39088.5985  28.7%   621  186s
H 3947  1948                    30485.083669 38923.2020  27.7%   628  189s
  3977  1959 38226.3664   18  370 30485.0837 38675.0278  26.9%   651  192s
  4067  2030 35778.7097   20  414 30485.0837 38171.5982  25.2%   693  197s
  4232  2044 34203.2352   22  429 30485.0837 38171.0517  25.2%   705  201s
H 4246  1945                    30490.026060 38171.0517  25.2%   704  201s
H 4262  1847                    30536.077634 38060.8625  24.6%   706  201s
  4377  1860 33668.1538   24  322 30536.0776 37709.0864  23.5%   707  205s
  4561  1852     cutoff   27      30536.0776 37709.0864  23.5%   709  210s
  4742  1821     cutoff   29      30536.0776 36733.9558  20.3%   715  215s
  4840  1830     cutoff   29      30536.0776 36711.0915  20.2%   715  220s
  5081  1819 32932.5951   25  163 30536.0776 36689.2787  20.2%   716  226s
  5354  1810     cutoff   27      30536.0776 36106.4708  18.2%   713  231s
  5592  1803 33339.3768   20  290 30536.0776 35480.6494  16.2%   710  235s
  6004  1757     cutoff   29      30536.0776 35072.4426  14.9%   701  242s
  6363  1683 31043.5234   28  191 30536.0776 34756.9740  13.8%   689  246s
  6586  1631 31668.0707   29   97 30536.0776 34682.5901  13.6%   685  250s
H 6613  1536                    30550.124475 34682.5901  13.5%   684  250s
  6929  1485 31698.8930   23  241 30550.1245 34356.8919  12.5%   678  256s
  7486  1293 32617.2154   25  186 30550.1245 33951.7301  11.1%   666  262s
  7755  1188 32282.8629   27  220 30550.1245 33951.7301  11.1%   664  265s
  8216   900 31406.3639   24  319 30550.1245 33385.5458  9.28%   656  270s
  9003   350 31900.3214   27  243 30550.1245 32668.4630  6.93%   638  276s
H 9625   228                    30558.696412 32034.0234  4.83%   619  278s
 10873    25     cutoff   45      30558.6964 30790.9816  0.76%   558  280s

Cutting planes:
  MIR: 194
  Mixing: 1
  Flow cover: 600
  RLT: 12
  Relax-and-lift: 50

Explored 11452 nodes (6155270 simplex iterations) in 280.99 seconds (751.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 30558.7 30550.1 30536.1 ... 30159.3

Optimal solution found (tolerance 1.00e-04)
Best objective 3.055869641183e+04, best bound 3.055869641183e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 281.00s
  Master Objective (UB) = 30558.70, θ = 171133.39
  Upper Bound (UB) = 30558.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171133.39
  [DEBUG]   ✓ Scenario 0: θ = 171133.39 ≤ Q = 171133.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171133.39 ≤ Q = 171133.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171133.39 ≤ Q = 171133.39 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4ba03fa2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4ba03fa2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.280876e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6014876.3357
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.621960e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162195.97    0  126 6014876.34 -162195.97   103%     -    0s
H    0     0                    -124806.8974 -162195.97  30.0%     -    0s
H    0     0                    -132364.3523 -162195.97  22.5%     -    0s
H    0     0                    -144306.2471 -162195.97  12.4%     -    0s
     0     0 -148007.18    0   90 -144306.25 -148007.18  2.56%     -    0s
H    0     0                    -146060.0664 -147981.53  1.32%     -    0s
H    0     0                    -146299.6168 -147548.64  0.85%     -    0s
     0     0 -147548.64    0   88 -146299.62 -147548.64  0.85%     -    0s
     0     0 -147537.57    0   88 -146299.62 -147537.57  0.85%     -    0s
     0     0 -147076.72    0   63 -146299.62 -147076.72  0.53%     -    0s
     0     0 -147076.22    0   62 -146299.62 -147076.22  0.53%     -    0s
     0     0 -147043.99    0   54 -146299.62 -147043.99  0.51%     -    0s
     0     0 -147041.95    0   50 -146299.62 -147041.95  0.51%     -    0s
     0     0 -147028.58    0    6 -146299.62 -147028.58  0.50%     -    0s
     0     0 -147026.78    0    5 -146299.62 -147026.78  0.50%     -    0s
H    0     0                    -146664.7830 -147026.78  0.25%     -    0s
H    0     0                    -146949.8336 -147026.78  0.05%     -    0s
     0     0 -147019.84    0    4 -146949.83 -147019.84  0.05%     -    0s
     0     0 -147018.66    0    4 -146949.83 -147018.66  0.05%     -    0s
     0     0 -147018.66    0   40 -146949.83 -147018.66  0.05%     -    0s
H    0     0                    -147004.0284 -147018.66  0.01%     -    0s

Explored 1 nodes (641 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -147004 -146950 -146883 ... 1.28088e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.470040283837e+05, best bound -1.470186569225e+05, gap 0.0100%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 147122.25
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147004.03
  [DEBUG]   S×d_nominal = 294126.28
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294126.28 + -147004.03 = 147122.25
  [DEBUG]   Current θ from Master = 171133.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24011.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6547.55
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 6330.7824, Absolute Gap = 6330.7824, Relative Gap = 0.207168
  Not converged yet (gap = 6330.78 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178431 nonzeros
Model fingerprint: 0x9c91a73d
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 6547.55 (0.09s)
Loaded MIP start from previous solve with objective 6547.55

Presolve removed 28764 rows and 11684 columns
Presolve time: 0.52s
Presolved: 33779 rows, 15536 columns, 208779 nonzeros
Variable types: 13277 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33779 rows, 15536 columns, 208779 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62046    3.7166704e+04   0.000000e+00   9.796811e+06      5s
Concurrent spin time: 0.35s

Solved with dual simplex

Root relaxation: objective 5.445427e+04, 22526 iterations, 5.51 seconds (11.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54454.2687    0   78 6547.55011 54454.2687   732%     -    6s
H    0     0                    9273.4654145 54454.2687   487%     -    6s
H    0     0                    23707.196225 54454.2687   130%     -    6s
H    0     0                    26738.542933 54454.2687   104%     -    6s
H    0     0                    26880.307012 49264.5666  83.3%     -    8s
H    0     0                    26956.138964 49264.5666  82.8%     -    8s
H    0     0                    27019.708711 49264.5666  82.3%     -    8s
     0     0 49264.5666    0  187 27019.7087 49264.5666  82.3%     -    8s
     0     0 49088.1674    0  191 27019.7087 49088.1674  81.7%     -    9s
     0     0 49047.6730    0  192 27019.7087 49047.6730  81.5%     -    9s
     0     0 49042.5810    0  200 27019.7087 49042.5810  81.5%     -    9s
     0     0 49042.5361    0  200 27019.7087 49042.5361  81.5%     -    9s
     0     0 46815.7682    0  275 27019.7087 46815.7682  73.3%     -   11s
     0     0 46109.7498    0  262 27019.7087 46109.7498  70.7%     -   12s
     0     0 46025.8007    0  256 27019.7087 46025.8007  70.3%     -   13s
     0     0 45993.5283    0  273 27019.7087 45993.5283  70.2%     -   13s
     0     0 45990.4081    0  270 27019.7087 45990.4081  70.2%     -   13s
     0     0 45990.1621    0  270 27019.7087 45990.1621  70.2%     -   13s
     0     0 44175.4522    0  337 27019.7087 44175.4522  63.5%     -   17s
H    0     0                    27035.514364 43571.9765  61.2%     -   19s
H    0     0                    27119.250184 43571.9765  60.7%     -   19s
     0     0 43571.9765    0  293 27119.2502 43571.9765  60.7%     -   19s
     0     0 43345.7803    0  298 27119.2502 43345.7803  59.8%     -   20s
     0     0 43302.6786    0  298 27119.2502 43302.6786  59.7%     -   20s
     0     0 43272.0216    0  299 27119.2502 43272.0216  59.6%     -   21s
     0     0 43257.9714    0  342 27119.2502 43257.9714  59.5%     -   21s
     0     0 43252.7386    0  340 27119.2502 43252.7386  59.5%     -   22s
     0     0 43248.0109    0  302 27119.2502 43248.0109  59.5%     -   22s
     0     0 43246.9703    0  303 27119.2502 43246.9703  59.5%     -   22s
     0     0 42376.8078    0  387 27119.2502 42376.8078  56.3%     -   25s
     0     0 41966.7223    0  388 27119.2502 41966.7223  54.7%     -   27s
     0     0 41865.4414    0  439 27119.2502 41865.4414  54.4%     -   28s
     0     0 41792.8471    0  440 27119.2502 41792.8471  54.1%     -   28s
     0     0 41731.7195    0  448 27119.2502 41731.7195  53.9%     -   29s
     0     0 41677.2831    0  443 27119.2502 41677.2831  53.7%     -   29s
     0     0 41670.3867    0  397 27119.2502 41670.3867  53.7%     -   29s
     0     0 41663.1773    0  449 27119.2502 41663.1773  53.6%     -   30s
     0     0 41658.7311    0  398 27119.2502 41658.7311  53.6%     -   30s
     0     0 41658.3599    0  447 27119.2502 41658.3599  53.6%     -   30s
     0     0 41453.2035    0  360 27119.2502 41453.2035  52.9%     -   31s
     0     0 41427.5955    0  358 27119.2502 41427.5955  52.8%     -   32s
     0     0 41402.4897    0  419 27119.2502 41402.4897  52.7%     -   33s
     0     0 41379.0081    0  422 27119.2502 41379.0081  52.6%     -   33s
     0     0 41370.5548    0  424 27119.2502 41370.5548  52.6%     -   33s
     0     0 41367.8221    0  424 27119.2502 41367.8221  52.5%     -   34s
     0     0 41367.1098    0  413 27119.2502 41367.1098  52.5%     -   34s
     0     0 41310.3293    0  423 27119.2502 41310.3293  52.3%     -   35s
     0     0 41280.1650    0  424 27119.2502 41280.1650  52.2%     -   36s
     0     0 41268.8566    0  428 27119.2502 41268.8566  52.2%     -   36s
     0     0 41264.6768    0  425 27119.2502 41264.6768  52.2%     -   36s
     0     0 41260.2893    0  425 27119.2502 41260.2893  52.1%     -   36s
     0     0 41259.6325    0  428 27119.2502 41259.6325  52.1%     -   37s
     0     0 41224.1602    0  467 27119.2502 41224.1602  52.0%     -   38s
     0     0 41214.9235    0  432 27119.2502 41214.9235  52.0%     -   38s
     0     0 41211.3395    0  434 27119.2502 41211.3395  52.0%     -   38s
     0     0 41207.7631    0  432 27119.2502 41207.7631  52.0%     -   39s
     0     0 41205.4211    0  424 27119.2502 41205.4211  51.9%     -   39s
     0     0 41204.4942    0  430 27119.2502 41204.4942  51.9%     -   39s
     0     0 41180.2608    0  374 27119.2502 41180.2608  51.8%     -   39s
H    0     0                    27308.884189 41158.2392  50.7%     -   41s
H    0     0                    28078.796258 41158.2392  46.6%     -   41s
     0     0 41158.2392    0  421 28078.7963 41158.2392  46.6%     -   41s
     0     0 41150.0193    0  433 28078.7963 41150.0193  46.6%     -   41s
     0     0 41148.7878    0  435 28078.7963 41148.7878  46.5%     -   41s
     0     0 41136.5645    0  428 28078.7963 41136.5645  46.5%     -   42s
     0     0 41133.4258    0  424 28078.7963 41133.4258  46.5%     -   42s
     0     0 41132.9826    0  434 28078.7963 41132.9826  46.5%     -   42s
     0     0 41126.0343    0  438 28078.7963 41126.0343  46.5%     -   43s
H    0     0                    28553.221337 41125.1820  44.0%     -   43s
H    0     0                    28557.044693 41125.1820  44.0%     -   43s
H    0     0                    28558.230676 41125.1820  44.0%     -   43s
H    0     0                    28596.414545 41125.1820  43.8%     -   43s
     0     0 41123.9849    0  433 28596.4145 41123.9849  43.8%     -   43s
     0     0 41123.8426    0  435 28596.4145 41123.8426  43.8%     -   43s
     0     0 41116.4485    0  430 28596.4145 41116.4485  43.8%     -   44s
     0     0 41115.2561    0  433 28596.4145 41115.2561  43.8%     -   44s
     0     0 41114.5561    0  430 28596.4145 41114.5561  43.8%     -   45s
     0     0 41114.1997    0  430 28596.4145 41114.1997  43.8%     -   45s
H    0     0                    28641.661158 41113.5875  43.5%     -   50s
H    0     0                    28719.977033 41113.5875  43.2%     -   50s
     0     2 41113.5875    0  430 28719.9770 41113.5875  43.2%     -   51s
     7    16 40394.0516    3  365 28719.9770 40895.0469  42.4%  3081   57s
    15    32 39624.2837    4  465 28719.9770 40392.4774  40.6%  3363   60s
H   31    64                    28734.693652 39851.1433  38.7%  4553   62s
H   32    64                    28764.061758 39851.1433  38.5%  4467   62s
H   40    64                    28834.767934 39851.0932  38.2%  3938   62s
    95   182 38784.1612    7  456 28834.7679 39577.2771  37.3%  2745   66s
   243   298 38405.7293   10  348 28834.7679 39577.2771  37.3%  1850   71s
   372   441 36832.2387   11  383 28834.7679 39577.2771  37.3%  1726   77s
H  414   441                    28892.448495 39577.2771  37.0%  1681   77s
H  426   441                    28931.680424 39577.2771  36.8%  1646   77s
   445   505 38257.5254   11  345 28931.6804 39577.2771  36.8%  1612   80s
   631   681 37816.8443   13  352 28931.6804 39450.6799  36.4%  1436   87s
   714   744 36371.5910   13  265 28931.6804 39450.6799  36.4%  1359   91s
   824   812 36789.8513   14  353 28931.6804 39274.6366  35.7%  1321   95s
H  855   812                    28933.014145 39274.6366  35.7%  1320   95s
   956   973 36230.7280   16  306 28933.0141 39274.6366  35.7%  1260  100s
  1091  1044 35888.4844   18  263 28933.0141 39122.7485  35.2%  1205  105s
H 1112  1044                    28953.889271 39122.7485  35.1%  1204  105s
  1243  1237 35259.8912   20  339 28953.8893 39122.7485  35.1%  1159  111s
  1472  1456 34942.4615   22  278 28953.8893 39122.7485  35.1%  1095  117s
  1604  1598 34353.3526   24  263 28953.8893 39122.7485  35.1%  1054  120s
H 1810  1665                    28968.762144 39122.7485  35.1%  1003  122s
  1908  1787 32639.3246   26  265 28968.7621 39122.7485  35.1%   991  126s
  2220  2049 29943.5618   30  176 28968.7621 38862.4200  34.2%   920  130s
  2591  2273     cutoff   34      28968.7621 38862.4200  34.2%   868  136s
  2860  2411 31149.6551   44  189 28968.7621 38783.1122  33.9%   845  142s
  2994  2495 30244.3750   51  139 28968.7621 38783.1122  33.9%   841  145s
  3334  2814 35241.1043   10  320 28968.7621 38783.1122  33.9%   814  151s
  3770  2963 34042.2613   15  187 28968.7621 38783.1122  33.9%   795  157s
  3857  3045 32800.6948   15  192 28968.7621 38584.1913  33.2%   798  161s
  4012  3046 31189.6483   40  430 28968.7621 38279.7124  32.1%   799  173s
  4014  3047 37311.7729   10   78 28968.7621 38279.7124  32.1%   799  181s
  4015  3048 30126.3569   62  354 28968.7621 38279.7124  32.1%   799  186s
  4017  3049 29661.8369   58  362 28968.7621 38279.7124  32.1%   798  191s
  4020  3051 29966.7316   69  416 28968.7621 38279.7124  32.1%   798  195s
  4026  3055 31371.6047   36  484 28968.7621 38279.7124  32.1%   797  200s
  4031  3059 30854.3769   26  366 28968.7621 38279.7124  32.1%   796  205s
  4036  3062 30110.7363   66  375 28968.7621 38279.7124  32.1%   795  210s
  4040  3065 32439.0843   40  392 28968.7621 38279.7124  32.1%   794  215s
  4043  3067 29884.8351   32  437 28968.7621 38279.7124  32.1%   793  226s
  4044  3067 33769.5275   19  437 28968.7621 38279.7124  32.1%   793  233s
  4045  3071 38279.7124   12  470 28968.7621 38279.7124  32.1%   811  239s
  4047  3074 38279.7124   13  451 28968.7621 38279.7124  32.1%   811  245s
  4051  3081 38279.7124   14  477 28968.7621 38279.7124  32.1%   814  252s
  4059  3094 38279.7124   15  378 28968.7621 38279.7124  32.1%   819  257s
  4075  3121 38279.7124   16  385 28968.7621 38279.7124  32.1%   844  263s
H 4105  2957                    28971.810975 38279.7124  32.1%   856  263s
  4107  2987 38279.7124   17  379 28971.8110 38279.7124  32.1%   858  267s
  4139  3050 38279.7124   18  371 28971.8110 38279.7124  32.1%   876  273s
  4220  3101 37978.2459   20  454 28971.8110 38279.7124  32.1%   901  278s
  4303  3103 37541.9572   21  465 28971.8110 38279.7124  32.1%   911  280s
  4407  3150 37194.3472   22  431 28971.8110 38279.7124  32.1%   919  288s
  4479  3168 36187.7068   22  393 28971.8110 38279.7124  32.1%   924  293s
  4557  3177 36759.4452   23  424 28971.8110 38279.7124  32.1%   932  297s
  4635  3182 34714.5546   23  401 28971.8110 38279.7124  32.1%   936  301s
  4718  3176 36232.1836   24  330 28971.8110 38279.7124  32.1%   935  306s
  4863  3186 34048.9593   25  235 28971.8110 38279.7124  32.1%   943  313s
  4933  3194 35221.2886   26  396 28971.8110 38279.7124  32.1%   946  316s
  4995  3217 34204.2132   26  337 28971.8110 38279.7124  32.1%   953  320s
  5109  3250 34235.0037   27  409 28971.8110 37902.0735  30.8%   961  327s
  5181  3269 33309.4689   28  348 28971.8110 37902.0735  30.8%   962  330s
  5389  3273 31965.3388   29  373 28971.8110 37678.2491  30.1%   958  338s
  5487  3280 31963.5293   29  343 28971.8110 37678.2491  30.1%   960  342s
  5585  3300 31278.8842   30  279 28971.8110 37678.2491  30.1%   964  345s
  5694  3295 31066.7852   31  311 28971.8110 37571.3992  29.7%   964  350s
  5828  3299     cutoff   32      28971.8110 37459.7518  29.3%   962  355s
  6077  3313     cutoff   19      28971.8110 36938.3852  27.5%   963  361s
  6161  3319 32325.6564   20  371 28971.8110 36938.3852  27.5%   965  368s
  6205  3338 31648.5373   21  319 28971.8110 36938.3852  27.5%   966  371s
  6259  3356 30632.0757   22  315 28971.8110 36938.3852  27.5%   967  376s
  6359  3357 29741.1700   23  381 28971.8110 36938.3852  27.5%   966  380s
H 6400  3196                    28976.249420 36938.3852  27.5%   966  380s
  6647  3281 34818.7844   19  324 28976.2494 36647.5821  26.5%   967  389s
  6860  3318 33490.4607   22  318 28976.2494 36647.5821  26.5%   963  394s
  7079  3315 32040.3179   25  281 28976.2494 36647.5821  26.5%   959  399s
  7328  3327 30135.5882   31  197 28976.2494 36446.9380  25.8%   955  405s
  7597  3283 33984.2418   25  303 28976.2494 36181.0447  24.9%   963  415s
  7697  3309 33586.2148   25  433 28976.2494 35956.6556  24.1%   967  421s
  7802  3336 32747.3806   27  363 28976.2494 35940.7717  24.0%   971  426s
  8029  3349     cutoff   31      28976.2494 35830.3181  23.7%   971  432s
  8370  3295 29364.4853   22  196 28976.2494 35830.3181  23.7%   965  438s
  8710  3232     cutoff   23      28976.2494 35830.3181  23.7%   960  444s
  8978  3204 31207.9539   21  229 28976.2494 35695.9503  23.2%   956  451s
  9245  3166 32770.4400   23  241 28976.2494 35405.1510  22.2%   954  459s
  9572  3120 33152.8303   23  281 28976.2494 35296.0465  21.8%   954  466s
  9931  3063 29818.0889   21  270 28976.2494 35064.4915  21.0%   954  473s
 10314  2986     cutoff   25      28976.2494 34966.6221  20.7%   952  480s
 10692  2940     cutoff   30      28976.2494 34818.4703  20.2%   952  487s
 11067  2901 32752.3594   26  306 28976.2494 34617.6396  19.5%   954  495s
 11420  2861     cutoff   32      28976.2494 34590.1387  19.4%   953  503s
 11822  2790     cutoff   29      28976.2494 34326.1822  18.5%   956  510s
 12031  2768 30476.4453   29   98 28976.2494 34326.1822  18.5%   957  519s
 12480  2699 31352.4635   20  273 28976.2494 34165.3201  17.9%   958  529s
 12977  2734 30050.6852   21  256 28976.2494 34011.6043  17.4%   957  539s
 13433  2773     cutoff   29      28976.2494 33764.5281  16.5%   961  548s
 13888  2848     cutoff   23      28976.2494 33697.9156  16.3%   959  558s
 14483  2899 29485.1473   27  103 28976.2494 33426.6725  15.4%   957  568s
 15014  2893 29464.1659   25  321 28976.2494 33278.6041  14.8%   958  577s
 15713  2919     cutoff   25      28976.2494 33118.0469  14.3%   952  587s
 16300  2962     cutoff   24      28976.2494 32983.1834  13.8%   954  597s
 17009  2952 infeasible   23      28976.2494 32806.9967  13.2%   947  608s
 17722  2863     cutoff   30      28976.2494 32646.7756  12.7%   944  619s
 18493  2743 30416.9284   25  395 28976.2494 32416.3471  11.9%   941  631s
 19300  2603 29348.2077   27   70 28976.2494 32152.2131  11.0%   938  643s
 20270  2353     cutoff   27      28976.2494 31966.2048  10.3%   928  655s
 21290  2317 infeasible   28      28976.2494 31613.6839  9.10%   918  665s
 21459  1959 29347.4288   23  142 28976.2494 31575.2743  8.97%   917  681s
 22509  1194     cutoff   36      28976.2494 31323.1115  8.10%   901  694s
 24212  1230 29376.2940   39   51 28976.2494 30836.8900  6.42%   870  702s
 28229  2874     cutoff   51      28976.2494 29655.3862  2.34%   764  706s
 33093  2954     cutoff   64      28976.2494 29350.0813  1.29%   659  710s
 48987    35 29013.4812   73   29 28976.2494 29028.5232  0.18%   457  715s

Cutting planes:
  Learned: 1
  MIR: 372
  Flow cover: 1018
  RLT: 18
  Relax-and-lift: 67

Explored 50665 nodes (22485152 simplex iterations) in 715.47 seconds (2239.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 28976.2 28976.2 28971.8 ... 28764.1

Optimal solution found (tolerance 1.00e-04)
Best objective 2.897624941958e+04, best bound 2.897624941958e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 715.50s
  Master Objective (UB) = 28976.25, θ = 171594.94
  Upper Bound (UB) = 28976.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171594.94
  [DEBUG]   ✓ Scenario 0: θ = 171594.94 ≤ Q = 179532.77 (slack: 7937.83)
  [DEBUG]   ✓ Scenario 1: θ = 171594.94 ≤ Q = 171594.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171594.94 ≤ Q = 171611.94 (slack: 17.00)
  [DEBUG]   ✓ Scenario 3: θ = 171594.94 ≤ Q = 171594.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xa6c1ce8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf593e318
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.296269e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6107540.1143
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.544615e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154461.53    0  127 6107540.11 -154461.53   103%     -    0s
H    0     0                    -121254.9734 -154461.53  27.4%     -    0s
H    0     0                    -128213.3341 -154461.53  20.5%     -    0s
H    0     0                    -128872.8891 -138382.32  7.38%     -    0s
     0     0 -138382.32    0   92 -128872.89 -138382.32  7.38%     -    0s
H    0     0                    -135377.2837 -138276.75  2.14%     -    0s
     0     0 -137735.63    0   95 -135377.28 -137735.63  1.74%     -    0s
     0     0 -137724.90    0   95 -135377.28 -137724.90  1.73%     -    0s
H    0     0                    -136539.2732 -137724.90  0.87%     -    0s
     0     0 -137008.20    0   68 -136539.27 -137008.20  0.34%     -    0s
     0     0 -136975.89    0   66 -136539.27 -136975.89  0.32%     -    0s
     0     0 -136662.93    0   23 -136539.27 -136662.93  0.09%     -    0s
     0     0 -136646.92    0   22 -136539.27 -136646.92  0.08%     -    0s
     0     0 -136639.79    0   13 -136539.27 -136639.79  0.07%     -    0s
     0     0 -136591.94    0   11 -136539.27 -136591.94  0.04%     -    0s
     0     0 -136591.77    0   12 -136539.27 -136591.77  0.04%     -    0s
     0     0 -136558.03    0    8 -136539.27 -136558.03  0.01%     -    0s
     0     0 -136558.03    0    7 -136539.27 -136558.03  0.01%     -    0s

Cutting planes:
  Implied bound: 2
  Flow cover: 3
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (686 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -136539 -136259 -136186 ... 1.29627e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.365392731713e+05, best bound -1.365497962090e+05, gap 0.0077%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 158249.32
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136539.27
  [DEBUG]   S×d_nominal = 294788.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294788.60 + -136539.27 = 158249.32
  [DEBUG]   Current θ from Master = 171594.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13345.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15630.64
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 4748.3354, Absolute Gap = 4748.3354, Relative Gap = 0.163870
  Not converged yet (gap = 4748.34 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221659 nonzeros
Model fingerprint: 0xa04645ce
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35955 rows and 14605 columns
Presolve time: 0.66s
Presolved: 41878 rows, 18855 columns, 259594 nonzeros
Variable types: 16596 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329277.6881
Found heuristic solution: objective -184706.4344

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41878 rows, 18855 columns, 259594 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33324    2.6285798e+04   0.000000e+00   1.573604e+06      5s
   51078    4.4551436e+04   0.000000e+00   2.262963e+06     10s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 5.433822e+04, 27375 iterations, 10.27 seconds (20.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54338.2162    0   75 -184706.43 54338.2162   129%     -   11s
H    0     0                    -173958.8110 54338.2162   131%     -   11s
H    0     0                    -95808.55088 54338.2162   157%     -   11s
H    0     0                    -67003.42330 54338.2162   181%     -   11s
H    0     0                    -55993.97741 54338.2162   197%     -   11s
H    0     0                    -54741.11976 54338.2162   199%     -   11s
H    0     0                    -54624.94746 54338.2162   199%     -   11s
H    0     0                    -54437.15352 54338.2162   200%     -   11s
H    0     0                    -54272.79353 54338.2162   200%     -   11s
H    0     0                    -54079.92328 54338.2162   200%     -   11s
H    0     0                    -30013.76278 54338.2162   281%     -   11s
H    0     0                    4662.2156532 54338.2162  1066%     -   11s
H    0     0                    4989.1964052 54338.2162   989%     -   11s
H    0     0                    11832.782548 54338.2162   359%     -   11s
H    0     0                    13431.983445 54338.2162   305%     -   11s
H    0     0                    19804.024077 54338.2045   174%     -   12s
H    0     0                    19953.508026 54338.2045   172%     -   12s
H    0     0                    20047.136258 54338.2045   171%     -   12s
     0     0 48431.6179    0  154 20047.1363 48431.6179   142%     -   17s
     0     0 48406.7966    0  195 20047.1363 48406.7966   141%     -   19s
     0     0 48406.7966    0  194 20047.1363 48406.7966   141%     -   20s
     0     0 48406.7966    0  211 20047.1363 48406.7966   141%     -   21s
     0     0 48406.7966    0  207 20047.1363 48406.7966   141%     -   21s
     0     0 48406.7966    0  193 20047.1363 48406.7966   141%     -   21s
     0     0 48406.7966    0  195 20047.1363 48406.7966   141%     -   21s
     0     0 45655.8315    0  195 20047.1363 45655.8315   128%     -   21s
H    0     0                    20523.307916 45655.8315   122%     -   21s
     0     0 45644.4084    0  283 20523.3079 45644.4084   122%     -   24s
H    0     0                    21611.950620 45644.4084   111%     -   24s
H    0     0                    21613.576219 45644.4084   111%     -   24s
H    0     0                    22548.154311 45644.4084   102%     -   24s
H    0     0                    23957.853414 45644.4084  90.5%     -   24s
H    0     0                    24134.449992 45644.4084  89.1%     -   24s
H    0     0                    24151.631295 45644.4084  89.0%     -   24s
     0     0 45398.1223    0  263 24151.6313 45398.1223  88.0%     -   26s
     0     0 45286.8872    0  260 24151.6313 45286.8872  87.5%     -   27s
     0     0 45259.1073    0  269 24151.6313 45259.1073  87.4%     -   28s
     0     0 45022.8470    0  283 24151.6313 45022.8470  86.4%     -   28s
     0     0 45018.2316    0  281 24151.6313 45018.2316  86.4%     -   28s
     0     0 45017.8265    0  279 24151.6313 45017.8265  86.4%     -   29s
     0     0 42942.7937    0  292 24151.6313 42942.7937  77.8%     -   33s
     0     0 42484.9463    0  297 24151.6313 42484.9463  75.9%     -   36s
     0     0 42387.3746    0  347 24151.6313 42387.3746  75.5%     -   37s
     0     0 42270.6517    0  346 24151.6313 42270.6517  75.0%     -   39s
     0     0 42229.9151    0  379 24151.6313 42229.9151  74.9%     -   40s
     0     0 42205.5908    0  336 24151.6313 42205.5908  74.8%     -   41s
     0     0 42197.5839    0  348 24151.6313 42197.5839  74.7%     -   41s
     0     0 42194.0080    0  352 24151.6313 42194.0080  74.7%     -   41s
     0     0 42188.8075    0  393 24151.6313 42188.8075  74.7%     -   42s
     0     0 42187.6705    0  350 24151.6313 42187.6705  74.7%     -   42s
H    0     0                    25992.573474 41631.1590  60.2%     -   47s
H    0     0                    26017.691672 41631.1590  60.0%     -   47s
H    0     0                    26272.727329 41631.1590  58.5%     -   47s
H    0     0                    26288.268073 41631.1590  58.4%     -   47s
H    0     0                    26311.837950 41631.1590  58.2%     -   47s
     0     0 41631.1590    0  401 26311.8379 41631.1590  58.2%     -   47s
H    0     0                    26320.658993 41629.9232  58.2%     -   48s
H    0     0                    26518.668768 41479.3693  56.4%     -   50s
H    0     0                    26555.254560 41479.3693  56.2%     -   50s
H    0     0                    26563.933357 41479.3693  56.1%     -   50s
     0     0 41479.3693    0  398 26563.9334 41479.3693  56.1%     -   50s
     0     0 41440.9151    0  396 26563.9334 41440.9151  56.0%     -   51s
     0     0 41420.5673    0  341 26563.9334 41420.5673  55.9%     -   51s
     0     0 41410.3485    0  406 26563.9334 41410.3485  55.9%     -   52s
     0     0 41408.0509    0  401 26563.9334 41408.0509  55.9%     -   52s
     0     0 41407.1793    0  403 26563.9334 41407.1793  55.9%     -   52s
     0     0 41304.3787    0  398 26563.9334 41304.3787  55.5%     -   54s
H    0     0                    26621.424154 41304.1118  55.2%     -   54s
H    0     0                    26750.066730 41304.1118  54.4%     -   54s
H    0     0                    26826.496569 41304.1118  54.0%     -   54s
H    0     0                    27107.658986 41304.1118  52.4%     -   54s
     0     0 41286.1764    0  455 27107.6590 41286.1764  52.3%     -   55s
     0     0 41276.6708    0  458 27107.6590 41276.6708  52.3%     -   55s
     0     0 41268.2732    0  464 27107.6590 41268.2732  52.2%     -   56s
     0     0 41265.7066    0  460 27107.6590 41265.7066  52.2%     -   56s
     0     0 41263.6924    0  413 27107.6590 41263.6924  52.2%     -   56s
     0     0 41262.5833    0  455 27107.6590 41262.5833  52.2%     -   57s
     0     0 41210.3299    0  421 27107.6590 41210.3299  52.0%     -   58s
H    0     0                    27277.163156 41210.2580  51.1%     -   59s
     0     0 41187.6466    0  423 27277.1632 41187.6466  51.0%     -   59s
     0     0 41181.8129    0  427 27277.1632 41181.8129  51.0%     -   60s
     0     0 41174.0701    0  473 27277.1632 41174.0701  50.9%     -   60s
     0     0 41162.7277    0  476 27277.1632 41162.7277  50.9%     -   61s
     0     0 41158.0759    0  431 27277.1632 41158.0759  50.9%     -   61s
     0     0 41156.8185    0  433 27277.1632 41156.8185  50.9%     -   61s
H    0     0                    27318.014389 41120.0904  50.5%     -   62s
H    0     0                    27405.203163 41120.0904  50.0%     -   62s
H    0     0                    27509.423000 41120.0904  49.5%     -   62s
     0     0 41120.0904    0  436 27509.4230 41120.0904  49.5%     -   62s
H    0     0                    27515.002352 41119.8703  49.4%     -   63s
     0     0 41112.5069    0  435 27515.0024 41112.5069  49.4%     -   63s
     0     0 41102.7431    0  425 27515.0024 41102.7431  49.4%     -   64s
     0     0 41098.9226    0  357 27515.0024 41098.9226  49.4%     -   64s
     0     0 41096.1238    0  439 27515.0024 41096.1238  49.4%     -   64s
     0     0 41093.8330    0  434 27515.0024 41093.8330  49.4%     -   64s
     0     0 41093.1251    0  366 27515.0024 41093.1251  49.3%     -   65s
H    0     0                    27532.599490 41055.8986  49.1%     -   66s
     0     0 41055.8986    0  439 27532.5995 41055.8986  49.1%     -   66s
H    0     0                    27657.216376 41055.5870  48.4%     -   66s
     0     0 41048.2692    0  444 27657.2164 41048.2692  48.4%     -   67s
     0     0 41046.2751    0  444 27657.2164 41046.2751  48.4%     -   67s
     0     0 41045.8433    0  445 27657.2164 41045.8433  48.4%     -   67s
     0     0 41039.8589    0  494 27657.2164 41039.8589  48.4%     -   68s
     0     0 41038.1759    0  500 27657.2164 41038.1759  48.4%     -   68s
     0     0 41037.9392    0  497 27657.2164 41037.9392  48.4%     -   69s
     0     0 41023.3906    0  486 27657.2164 41023.3906  48.3%     -   70s
H    0     0                    27912.460307 41022.2593  47.0%     -   70s
     0     0 41019.1666    0  491 27912.4603 41019.1666  47.0%     -   70s
     0     0 41017.5711    0  482 27912.4603 41017.5711  47.0%     -   71s
     0     0 41006.9190    0  356 27912.4603 41006.9190  46.9%     -   72s
     0     0 41003.0009    0  443 27912.4603 41003.0009  46.9%     -   73s
     0     0 41001.8771    0  443 27912.4603 41001.8771  46.9%     -   73s
     0     0 40999.2626    0  444 27912.4603 40999.2626  46.9%     -   73s
     0     0 40999.2493    0  444 27912.4603 40999.2493  46.9%     -   74s
H    0     0                    27928.367689 40998.9044  46.8%     -   83s
     0     2 40998.9044    0  444 27928.3677 40998.9044  46.8%     -   84s
     1     4 40572.0287    1  425 27928.3677 40998.9044  46.8%  2053   87s
     3     8 40432.4145    2  353 27928.3677 40571.8339  45.3%  2830   90s
     7    16 40138.5900    3  451 27928.3677 40431.9712  44.8%  2948   95s
    31    50 38702.5761    5  371 27928.3677 39897.3022  42.9%  4744  108s
    49    82 38350.2545    6  372 27928.3677 39897.3022  42.9%  4743  112s
    81   125 38248.8576    7  369 27928.3677 39897.3022  42.9%  3585  116s
   124   233 38203.8780    8  364 27928.3677 39897.3022  42.9%  2784  120s
   234   311 38003.4760   10  356 27928.3677 39897.3022  42.9%  2121  125s
   397   456 37874.1624   10  351 27928.3677 39897.3022  42.9%  1888  132s
   480   515 37865.6861   11  357 27928.3677 39897.3022  42.9%  1777  136s
H  501   515                    27932.928740 39897.3022  42.8%  1750  136s
   555   568 37350.7550   10  327 27932.9287 39897.3022  42.8%  1682  142s
   630   621 37214.9983   11  328 27932.9287 39710.2048  42.2%  1630  148s
H  637   621                    27958.455312 39710.2048  42.0%  1637  148s
   706   652 37303.9818   10  355 27958.4553 39710.1324  42.0%  1601  154s
   802   674 37141.3389   11  337 27958.4553 39710.1324  42.0%  1548  160s
   872   722 37151.0185   12  335 27958.4553 39710.1324  42.0%  1549  165s
   928   762 35223.6272   12  334 27958.4553 39710.1324  42.0%  1598  170s
   980   805 35181.3573   12  277 27958.4553 39710.1324  42.0%  1632  176s
  1052   837 35776.6456   12  276 27958.4553 39710.1324  42.0%  1644  182s
  1094   887 36329.0552   13  281 27958.4553 39710.1324  42.0%  1652  185s
  1162   914 34386.0015   13  316 27958.4553 39710.1324  42.0%  1655  191s
H 1177   914                    27986.647723 39167.4954  40.0%  1660  191s
  1207   966 35917.5348   14  340 27986.6477 39167.4954  40.0%  1667  198s
  1287  1010 35774.2689   14  255 27986.6477 39167.4954  40.0%  1666  205s
  1345  1090 34965.8677   15  346 27986.6477 39167.4954  40.0%  1659  210s
  1486  1212 34263.9106   17  318 27986.6477 39167.4954  40.0%  1626  218s
  1587  1302 33511.1609   18  214 27986.6477 39167.4954  40.0%  1589  223s
  1706  1426 33448.2521   19  268 27986.6477 38878.0888  38.9%  1547  227s
  1856  1541 33366.5568   20  204 27986.6477 38878.0888  38.9%  1488  231s
  2013  1641 32827.7429   20  215 27986.6477 38878.0888  38.9%  1434  237s
  2177  1754 33210.3869   21  220 27986.6477 38878.0888  38.9%  1400  244s
  2342  1848 33086.3988   23  220 27986.6477 38878.0888  38.9%  1374  250s
  2506  1995 32727.5510   26  196 27986.6477 38130.7309  36.2%  1360  256s
  2705  2169 32088.2434   31  172 27986.6477 38130.7309  36.2%  1319  264s
  2959  2329     cutoff   37      27986.6477 37873.6279  35.3%  1268  270s
  3236  2483 30384.6133   52  142 27986.6477 37839.7192  35.2%  1216  275s
  3664  2679 29139.6408   66   89 27986.6477 37594.2750  34.3%  1156  286s
  3833  2755 35284.5616   11  275 27986.6477 37594.2750  34.3%  1155  292s
  3961  2859 33436.9442   16  190 27986.6477 37594.2750  34.3%  1172  299s
  4136  2860 34312.0862   12  444 27986.6477 37567.8950  34.2%  1178  321s
  4138  2861 33513.8703   16   75 27986.6477 37567.8950  34.2%  1177  332s
  4139  2862 35513.1751   10  297 27986.6477 37567.8950  34.2%  1177  339s
  4140  2863 33572.3947   14  361 27986.6477 37567.8950  34.2%  1177  343s
  4141  2863 33875.6813   15  378 27986.6477 37567.8950  34.2%  1177  348s
  4142  2864 30498.3922   49  444 27986.6477 37567.8950  34.2%  1176  352s
  4143  2865 33124.2134   23  370 27986.6477 37567.8950  34.2%  1176  355s
  4147  2867 37458.6696    8  420 27986.6477 37567.8950  34.2%  1175  360s
  4152  2871 29286.2194   63  420 27986.6477 37567.8950  34.2%  1173  365s
  4155  2873 32739.5560   17  453 27986.6477 37567.8950  34.2%  1173  370s
  4158  2875 29937.9557   51  494 27986.6477 37567.8950  34.2%  1172  375s
  4161  2877 33050.5186   12  362 27986.6477 37567.8950  34.2%  1171  380s
  4164  2879 29730.2281   37  541 27986.6477 37567.8950  34.2%  1170  386s
  4166  2880 30973.2023   66  505 27986.6477 37567.8950  34.2%  1170  390s
  4169  2882 35664.0918   12  545 27986.6477 37567.8950  34.2%  1169  406s
  4170  2883 32848.4714   27  545 27986.6477 37567.8950  34.2%  1168  422s
  4171  2886 37567.8950   14  534 27986.6477 37567.8950  34.2%  1196  430s
  4173  2890 37567.8950   15  538 27986.6477 37567.8950  34.2%  1196  435s
  4177  2896 37567.8950   16  529 27986.6477 37567.8950  34.2%  1200  445s
  4185  2910 37567.8950   17  442 27986.6477 37567.8950  34.2%  1204  453s
  4201  2922 34779.7051   18  239 27986.6477 37567.8950  34.2%  1238  464s
  4219  2948 37557.3816   19  386 27986.6477 37567.8950  34.2%  1249  469s
  4251  3012 35453.5302   20  388 27986.6477 37567.8950  34.2%  1283  479s
  4352  3012 33962.4298   22  291 27986.6477 37567.8950  34.2%  1317  487s
  4407  3050 30823.9268   21  389 27986.6477 37567.8950  34.2%  1345  494s
  4495  3070 32643.7892   23  302 27986.6477 37567.8950  34.2%  1352  503s
  4588  3069 31243.9509   23  257 27986.6477 37567.8950  34.2%  1355  510s
  4682  3074 29356.6322   24  210 27986.6477 37567.8950  34.2%  1350  515s
  4765  3071 29350.8697   25  197 27986.6477 37567.8950  34.2%  1348  521s
  4850  3075 28581.1797   27  188 27986.6477 37567.8950  34.2%  1347  526s
  4917  3084 28443.1932   28  175 27986.6477 37567.8950  34.2%  1350  532s
  4961  3089     cutoff   29      27986.6477 37567.8950  34.2%  1356  537s
  5000  3100 33881.6540   25  311 27986.6477 37567.8950  34.2%  1364  542s
  5041  3104 33642.9287   26  227 27986.6477 37567.8950  34.2%  1372  546s
H 5071  2949                    27999.193697 37567.8950  34.2%  1372  546s
  5080  2970     cutoff   27      27999.1937 37254.8034  33.1%  1373  552s
H 5087  2830                    27999.944804 37254.8034  33.1%  1374  552s
  5158  2840 33088.8252   28  146 27999.9448 36627.3679  30.8%  1375  558s
  5245  2839 31710.7772   31  218 27999.9448 36627.3679  30.8%  1378  564s
H 5259  2705                    28142.688473 36627.3679  30.1%  1377  564s
  5298  2738 30878.1858   33  114 28142.6885 36627.3679  30.1%  1382  570s
  5389  2729 30085.7199   40  108 28142.6885 36584.8694  30.0%  1384  575s
  5431  2741 29953.7720   41  148 28142.6885 36584.8694  30.0%  1385  580s
  5530  2755 29618.6985   48  164 28142.6885 36584.8694  30.0%  1384  589s
H 5537  2629                    28180.246842 36584.8694  29.8%  1383  589s
  5578  2651 29605.9327   49  135 28180.2468 36584.8694  29.8%  1385  596s
  5710  2640 28992.0422   56  145 28180.2468 36388.6793  29.1%  1382  604s
  5861  2642 28483.7249   66   72 28180.2468 36036.9379  27.9%  1376  611s
  5977  2660 33202.9550   22  220 28180.2468 36036.9379  27.9%  1378  617s
  6090  2672 32038.2937   24  212 28180.2468 35942.0031  27.5%  1383  624s
  6226  2631     cutoff   27      28180.2468 35942.0031  27.5%  1382  631s
  6385  2620 30640.2831   29  187 28180.2468 35942.0031  27.5%  1382  639s
  6508  2612 29470.2606   33  182 28180.2468 35942.0031  27.5%  1389  646s
  6596  2603 28533.1400   36   63 28180.2468 35942.0031  27.5%  1392  652s
H 6599  2484                    28189.896565 35942.0031  27.5%  1392  652s
  6644  2509 28260.4141   37  107 28189.8966 35942.0031  27.5%  1393  661s
  6811  2494 28374.4832   24  314 28189.8966 34532.6277  22.5%  1394  670s
  6996  2473 32449.2924   24  142 28189.8966 34505.4083  22.4%  1395  677s
  7176  2456 31289.2075   27  242 28189.8966 34413.2041  22.1%  1397  687s
  7370  2415 infeasible   34      28189.8966 34368.7775  21.9%  1398  695s
  7586  2380 30191.6094   22  270 28189.8966 33988.6744  20.6%  1397  702s
  7737  2373 29254.8542   27  215 28189.8966 33836.2971  20.0%  1399  711s
  7911  2361 28539.7885   31  160 28189.8966 33836.2971  20.0%  1400  721s
  8177  2308 30663.2465   29  187 28189.8966 33722.4591  19.6%  1399  729s
  8440  2226     cutoff   24      28189.8966 33450.2784  18.7%  1401  737s
  8497  2228 28857.9072   25  306 28189.8966 33440.2703  18.6%  1403  744s
H 8522  2108                    28222.070838 33440.2703  18.5%  1404  744s
  8567  2113     cutoff   26      28222.0708 33440.2703  18.5%  1402  754s
  8898  2022 28581.2112   24  110 28222.0708 33247.4554  17.8%  1400  764s
  9172  1939     cutoff   24      28222.0708 32896.5503  16.6%  1396  774s
  9485  1840     cutoff   25      28222.0708 32723.2951  15.9%  1397  784s
  9849  1724     cutoff   29      28222.0708 32705.5378  15.9%  1397  792s
  9907  1707 29554.6735   23  264 28222.0708 32591.3771  15.5%  1401  800s
  9967  1724     cutoff   24      28222.0708 32591.3771  15.5%  1400  811s
 10159  1678     cutoff   25      28222.0708 32591.3771  15.5%  1393  821s
H10350  1559                    28239.141916 32394.8032  14.7%  1384  821s
 10540  1533 29370.3560   28  175 28239.1419 32372.9142  14.6%  1381  833s
 11011  1497 30939.4135   29  193 28239.1419 32063.5451  13.5%  1375  843s
 11446  1474 28514.1785   30  149 28239.1419 31916.3145  13.0%  1369  856s
 11946  1346 29356.6202   23  149 28239.1419 31613.5683  11.9%  1364  869s
 12494  1181 28529.3560   26  252 28239.1419 31291.8869  10.8%  1356  881s
 13090   734 29420.5814   24  148 28239.1419 30950.0436  9.60%  1344  893s
 13934   465     cutoff   25      28239.1419 30554.3967  8.20%  1311  904s
 15561   575     cutoff   45      28239.1419 29725.2464  5.26%  1205  907s
H16585   575                    28259.605342 29386.9757  3.99%  1136  907s
 17638   942     cutoff   50      28259.6053 28627.9478  1.30%  1072  914s
H17790   942                    28316.461955 28614.4107  1.05%  1064  914s
*18007   942              67    28318.809007 28589.3316  0.96%  1052  914s
 19862   605     cutoff   65      28318.8090 28497.3906  0.63%   959  916s

Cutting planes:
  Learned: 3
  MIR: 527
  Mixing: 3
  Flow cover: 1274
  RLT: 21
  Relax-and-lift: 85

Explored 23435 nodes (19295242 simplex iterations) in 917.50 seconds (2669.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 28318.8 28316.5 28259.6 ... 27986.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.831880900712e+04, best bound 2.831880900712e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 917.53s
  Master Objective (UB) = 28318.81, θ = 171793.68
  Upper Bound (UB) = 28318.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171793.68
  [DEBUG]   ✓ Scenario 0: θ = 171793.68 ≤ Q = 171793.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171793.68 ≤ Q = 171793.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171793.68 ≤ Q = 171793.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171793.68 ≤ Q = 171793.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 171793.68 ≤ Q = 171793.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x36b326c6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc94cd93a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.290312e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6071597.0223
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.569472e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156947.17    0  130 6071597.02 -156947.17   103%     -    0s
H    0     0                    -118763.6337 -156947.17  32.2%     -    0s
H    0     0                    -130511.0496 -156947.17  20.3%     -    0s
H    0     0                    -131211.8641 -143025.69  9.00%     -    0s
H    0     0                    -137488.6450 -143025.69  4.03%     -    0s
     0     0 -143025.69    0   80 -137488.64 -143025.69  4.03%     -    0s
H    0     0                    -141116.9215 -142920.12  1.28%     -    0s
     0     0 -142435.06    0   77 -141116.92 -142435.06  0.93%     -    0s
     0     0 -142434.05    0   77 -141116.92 -142434.05  0.93%     -    0s
     0     0 -142433.71    0   77 -141116.92 -142433.71  0.93%     -    0s
     0     0 -141858.44    0   41 -141116.92 -141858.44  0.53%     -    0s
H    0     0                    -141328.5150 -141779.80  0.32%     -    0s
H    0     0                    -141365.4654 -141779.80  0.29%     -    0s
     0     0 -141698.23    0   40 -141365.47 -141698.23  0.24%     -    0s
     0     0 -141691.67    0   40 -141365.47 -141691.67  0.23%     -    0s
     0     0 -141520.84    0   10 -141365.47 -141520.84  0.11%     -    0s
     0     0 -141474.82    0   10 -141365.47 -141474.82  0.08%     -    0s
     0     0 -141474.66    0   10 -141365.47 -141474.66  0.08%     -    0s
     0     0 -141393.19    0    7 -141365.47 -141393.19  0.02%     -    0s
     0     0          -    0      -141365.47 -141377.86  0.01%     -    0s

Explored 1 nodes (631 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -141365 -141329 -141141 ... 1.29031e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.413654653915e+05, best bound -1.413778569493e+05, gap 0.0088%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 153020.49
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141365.47
  [DEBUG]   S×d_nominal = 294385.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294385.95 + -141365.47 = 153020.49
  [DEBUG]   Current θ from Master = 171793.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18773.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9545.62
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 4090.8950, Absolute Gap = 4090.8950, Relative Gap = 0.144459
  Not converged yet (gap = 4090.89 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264887 nonzeros
Model fingerprint: 0x7cdef391
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43126 rows and 17516 columns
Presolve time: 0.80s
Presolved: 49997 rows, 22184 columns, 310469 nonzeros
Variable types: 19925 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329277.6881
Found heuristic solution: objective -184706.4344

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 49997 rows, 22184 columns, 310469 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31682    2.4378301e+04   0.000000e+00   3.001378e+06      5s
   45466    4.1274944e+04   0.000000e+00   6.223120e+05     10s
Concurrent spin time: 0.98s

Solved with dual simplex

Root relaxation: objective 5.433793e+04, 35843 iterations, 13.37 seconds (27.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54337.9274    0   75 -184706.43 54337.9274   129%     -   14s
H    0     0                    -170230.9914 54337.9274   132%     -   14s
H    0     0                    -82075.91701 54337.9274   166%     -   14s
H    0     0                    -80800.96992 54337.9274   167%     -   14s
H    0     0                    -60074.81002 54337.9274   190%     -   14s
H    0     0                    -59944.11014 54337.9274   191%     -   14s
H    0     0                    -56202.32725 54337.9274   197%     -   14s
H    0     0                     187.2697952 54337.9274      -     -   15s
H    0     0                    4478.9289301 54337.9274  1113%     -   15s
H    0     0                    11502.758954 54337.9274   372%     -   15s
H    0     0                    12849.586211 54337.9274   323%     -   15s
H    0     0                    14507.423734 54337.9274   275%     -   15s
H    0     0                    18567.819055 54337.3028   193%     -   15s
H    0     0                    18768.484601 54337.3028   190%     -   15s
H    0     0                    19179.414773 54337.3028   183%     -   15s
H    0     0                    19340.495402 48983.3283   153%     -   21s
H    0     0                    19415.782875 48983.3283   152%     -   21s
H    0     0                    19466.179101 48983.3283   152%     -   21s
     0     0 48983.3283    0  201 19466.1791 48983.3283   152%     -   21s
     0     0 48737.5766    0  207 19466.1791 48737.5766   150%     -   23s
     0     0 48536.3908    0  206 19466.1791 48536.3908   149%     -   24s
     0     0 48536.3908    0  206 19466.1791 48536.3908   149%     -   25s
     0     0 48536.3908    0  208 19466.1791 48536.3908   149%     -   25s
     0     0 45761.3620    0  288 19466.1791 45761.3620   135%     -   32s
H    0     0                    21803.535189 45761.3620   110%     -   32s
H    0     0                    21841.055067 45761.3620   110%     -   32s
H    0     0                    22114.026842 45761.3620   107%     -   32s
H    0     0                    22172.763728 45761.3620   106%     -   32s
H    0     0                    22173.325542 45761.3620   106%     -   32s
H    0     0                    22191.507188 45761.3620   106%     -   32s
     0     0 45443.7115    0  267 22191.5072 45443.7115   105%     -   34s
     0     0 45249.2482    0  268 22191.5072 45249.2482   104%     -   35s
     0     0 45200.4543    0  267 22191.5072 45200.4543   104%     -   36s
     0     0 45161.5988    0  261 22191.5072 45161.5988   104%     -   37s
     0     0 45000.8958    0  268 22191.5072 45000.8958   103%     -   38s
     0     0 44997.3034    0  268 22191.5072 44997.3034   103%     -   39s
     0     0 44996.3380    0  265 22191.5072 44996.3380   103%     -   39s
     0     0 44996.0214    0  265 22191.5072 44996.0214   103%     -   39s
H    0     0                    22367.632972 43096.3973  92.7%     -   47s
H    0     0                    23956.628044 43096.3973  79.9%     -   47s
     0     0 43096.3973    0  358 23956.6280 43096.3973  79.9%     -   47s
H    0     0                    24020.308933 43095.7100  79.4%     -   48s
     0     0 42755.2676    0  358 24020.3089 42755.2676  78.0%     -   50s
     0     0 42475.8867    0  368 24020.3089 42475.8867  76.8%     -   53s
     0     0 42345.1819    0  339 24020.3089 42345.1819  76.3%     -   56s
     0     0 42312.6330    0  382 24020.3089 42312.6330  76.2%     -   57s
     0     0 42290.1956    0  386 24020.3089 42290.1956  76.1%     -   58s
     0     0 42283.8066    0  387 24020.3089 42283.8066  76.0%     -   58s
     0     0 42280.1159    0  389 24020.3089 42280.1159  76.0%     -   59s
     0     0 42275.0446    0  391 24020.3089 42275.0446  76.0%     -   59s
     0     0 42272.6628    0  391 24020.3089 42272.6628  76.0%     -   60s
     0     0 42272.4481    0  391 24020.3089 42272.4481  76.0%     -   60s
     0     0 41892.5100    0  405 24020.3089 41892.5100  74.4%     -   67s
     0     0 41676.6269    0  391 24020.3089 41676.6269  73.5%     -   69s
     0     0 41598.7350    0  371 24020.3089 41598.7350  73.2%     -   71s
     0     0 41554.0961    0  396 24020.3089 41554.0961  73.0%     -   73s
     0     0 41481.9523    0  396 24020.3089 41481.9523  72.7%     -   75s
     0     0 41467.8237    0  392 24020.3089 41467.8237  72.6%     -   76s
     0     0 41457.6217    0  446 24020.3089 41457.6217  72.6%     -   76s
     0     0 41455.0814    0  442 24020.3089 41455.0814  72.6%     -   77s
     0     0 41453.3749    0  397 24020.3089 41453.3749  72.6%     -   77s
     0     0 41452.1121    0  395 24020.3089 41452.1121  72.6%     -   77s
     0     0 41342.8915    0  427 24020.3089 41342.8915  72.1%     -   81s
H    0     0                    24089.496828 41308.7042  71.5%     -   82s
H    0     0                    24124.651780 41308.7042  71.2%     -   82s
H    0     0                    24234.526112 41308.7042  70.5%     -   82s
     0     0 41308.7042    0  425 24234.5261 41308.7042  70.5%     -   82s
     0     0 41298.9628    0  430 24234.5261 41298.9628  70.4%     -   83s
     0     0 41297.1351    0  432 24234.5261 41297.1351  70.4%     -   83s
     0     0 41293.8312    0  432 24234.5261 41293.8312  70.4%     -   84s
     0     0 41293.4007    0  433 24234.5261 41293.4007  70.4%     -   84s
H    0     0                    24267.159923 41293.4007  70.2%     -   84s
     0     0 41224.4816    0  422 24267.1599 41224.4816  69.9%     -   87s
H    0     0                    24588.959108 41223.9726  67.7%     -   88s
H    0     0                    25413.963960 41223.9726  62.2%     -   88s
H    0     0                    25777.975795 41223.9726  59.9%     -   88s
     0     0 41177.0995    0  434 25777.9758 41177.0995  59.7%     -   89s
     0     0 41164.4018    0  430 25777.9758 41164.4018  59.7%     -   91s
     0     0 41162.3545    0  426 25777.9758 41162.3545  59.7%     -   91s
     0     0 41161.1353    0  429 25777.9758 41161.1353  59.7%     -   91s
     0     0 41131.2727    0  448 25777.9758 41131.2727  59.6%     -   93s
H    0     0                    26384.883816 41130.9780  55.9%     -   93s
     0     0 41124.1508    0  450 26384.8838 41124.1508  55.9%     -   94s
     0     0 41122.2429    0  450 26384.8838 41122.2429  55.9%     -   95s
     0     0 41120.7136    0  455 26384.8838 41120.7136  55.8%     -   95s
     0     0 41069.2551    0  383 26384.8838 41069.2551  55.7%     -   98s
H    0     0                    26409.228852 41068.8244  55.5%     -   99s
     0     0 41059.2559    0  499 26409.2289 41059.2559  55.5%     -  100s
     0     0 41055.3932    0  504 26409.2289 41055.3932  55.5%     -  100s
     0     0 41055.1785    0  505 26409.2289 41055.1785  55.5%     -  101s
     0     0 41043.5248    0  454 26409.2289 41043.5248  55.4%     -  102s
     0     0 41041.6630    0  455 26409.2289 41041.6630  55.4%     -  103s
     0     0 41041.1815    0  513 26409.2289 41041.1815  55.4%     -  103s
     0     0 41037.2847    0  498 26409.2289 41037.2847  55.4%     -  104s
H    0     0                    26886.197482 41037.1694  52.6%     -  105s
H    0     0                    26925.676836 41037.1694  52.4%     -  105s
     0     0 41036.4123    0  499 26925.6768 41036.4123  52.4%     -  106s
     0     0 41033.6636    0  494 26925.6768 41033.6636  52.4%     -  107s
     0     0 41033.0667    0  500 26925.6768 41033.0667  52.4%     -  108s
     0     0 41027.4036    0  506 26925.6768 41027.4036  52.4%     -  109s
     0     0 41027.3448    0  506 26925.6768 41027.3448  52.4%     -  109s
H    0     2                    27012.914318 41027.3448  51.9%     -  132s
     0     2 41027.3448    0  506 27012.9143 41027.3448  51.9%     -  132s
     1     4 40896.6464    1  441 27012.9143 41027.1496  51.9%  2355  136s
     3     8 40390.7412    2  479 27012.9143 40895.2046  51.4%  4694  142s
     7    16 40069.3618    3  420 27012.9143 40390.2072  49.5%  5884  146s
    15    32 39420.7336    4  468 27012.9143 40074.0105  48.4%  5520  153s
    31    53 38370.3009    5  419 27012.9143 39916.8903  47.8%  8074  166s
    52    85 38764.6548    6  316 27012.9143 39916.8903  47.8%  7729  175s
H   56    85                    27035.223019 39916.8903  47.6%  7361  175s
H   72    85                    27064.685926 39916.8903  47.5%  6414  175s
    84   212 38467.9200    7  287 27064.6859 39916.8903  47.5%  5912  193s
   211   325 38186.2534    9  264 27064.6859 39916.8903  47.5%  3603  198s
   324   410 38053.3763   10  321 27064.6859 39916.8903  47.5%  2937  204s
   409   473 38038.8164   11  294 27064.6859 39916.8903  47.5%  2817  209s
   472   553 38098.7898   10  265 27064.6859 39916.8903  47.5%  2818  213s
   552   628 38052.4725   11  315 27064.6859 39916.8903  47.5%  2678  218s
   629   702 37580.2112   12  305 27064.6859 39916.8903  47.5%  2560  225s
   707   780 37133.1058   12  272 27064.6859 39916.8903  47.5%  2461  231s
H  714   780                    27350.993164 39916.8903  45.9%  2444  231s
   788   853 37847.6231   13  268 27350.9932 39916.8903  45.9%  2333  235s
   875   911 36759.9122   12  244 27350.9932 39916.8903  45.9%  2226  243s
H  876   911                    27636.645802 39916.8903  44.4%  2224  243s
   945   980 37535.3463   13  255 27636.6458 39916.8903  44.4%  2166  250s
  1032  1038 36835.7570   14  231 27636.6458 39916.8903  44.4%  2108  256s
H 1104  1038                    27741.149555 39916.8903  43.9%  2076  256s
  1108  1114 31890.1037   13  305 27741.1496 39916.8903  43.9%  2080  264s
  1216  1166 35594.1781   13  237 27741.1496 39916.8903  43.9%  2039  271s
  1286  1234 35742.3041   15  241 27741.1496 39838.3180  43.6%  2029  278s
  1399  1272 35189.2262   15  218 27741.1496 39820.9223  43.5%  1980  284s
  1497  1348 35140.1844   16  220 27741.1496 39820.9223  43.5%  1969  292s
  1595  1378 33112.7153   17  210 27741.1496 39820.9223  43.5%  1972  297s
  1629  1447 32824.2381   17  224 27741.1496 39820.9223  43.5%  1991  303s
  1720  1538 35262.6296   17  225 27741.1496 39820.9223  43.5%  1969  310s
  1833  1671 34114.9355   16  224 27741.1496 39820.9223  43.5%  1940  317s
  1994  1793 32797.9317   18  342 27741.1496 39820.9223  43.5%  1887  325s
  2126  1883 30993.2924   17  243 27741.1496 38981.3888  40.5%  1860  333s
  2226  2014 32648.9778   19  207 27741.1496 38981.3888  40.5%  1824  339s
  2399  2152 31674.9164   19  195 27741.1496 38688.2913  39.5%  1778  344s
  2617  2351 32203.6706   20  196 27741.1496 38688.2913  39.5%  1711  352s
  2874  2533 31517.2811   23  234 27741.1496 38574.3530  39.1%  1639  360s
  3100  2781 31230.3268   23  232 27741.1496 38484.9423  38.7%  1598  367s
  3375  2782 31164.9760   24  506 27741.1496 38484.9423  38.7%  1540  395s
  3377  2783 36657.1903   12   75 27741.1496 38484.9423  38.7%  1539  415s
  3378  2784 35396.4383   22  327 27741.1496 38484.9423  38.7%  1538  425s
  3379  2785 33673.1466   24  327 27741.1496 38484.9423  38.7%  1538  434s
  3380  2785 34503.8782   17  445 27741.1496 38484.9423  38.7%  1538  440s
  3381  2786 36830.6737   12  422 27741.1496 38484.9423  38.7%  1537  445s
  3383  2787 35141.8687   29  423 27741.1496 38484.9423  38.7%  1536  450s
  3387  2790 30213.1801   36  508 27741.1496 38484.9423  38.7%  1534  455s
  3390  2792 31970.0257   21  448 27741.1496 38484.9423  38.7%  1533  460s
  3392  2793 32160.9365   32  500 27741.1496 38484.9423  38.7%  1532  466s
  3395  2795 34277.8617   17  429 27741.1496 38484.9423  38.7%  1531  472s
  3397  2797 28053.6443   38  506 27741.1496 38484.9423  38.7%  1530  476s
  3399  2798 31047.5379   52  458 27741.1496 38484.9423  38.7%  1529  481s
  3401  2799 34628.0790   10  364 27741.1496 38484.9423  38.7%  1528  485s
  3403  2801 37078.0757    9  516 27741.1496 38484.9423  38.7%  1527  491s
  3405  2802 35444.5421   25  476 27741.1496 38484.9423  38.7%  1526  496s
H 3405  2661                    27766.936782 38484.9423  38.6%  1526  497s
  3407  2662 36126.0797   11  538 27766.9368 38484.9423  38.6%  1525  500s
  3408  2663 30217.9808   35  538 27766.9368 38484.9423  38.6%  1525  518s
H 3408  2529                    27834.096134 38484.9423  38.3%  1525  531s
H 3409  2405                    27838.789137 38484.9423  38.2%  1567  539s
  3410  2406 38484.9423   12  443 27838.7891 38484.9423  38.2%  1568  552s
  3412  2410 38484.9423   13  497 27838.7891 38484.9423  38.2%  1570  560s
  3416  2416 38484.9423   14  502 27838.7891 38484.9423  38.2%  1576  570s
  3424  2430 38484.9423   15  532 27838.7891 38484.9423  38.2%  1584  582s
  3440  2448 38102.8402   16  427 27838.7891 38484.9423  38.2%  1637  602s
H 3446  2325                    27847.070064 38484.9423  38.2%  1644  602s
  3464  2351 34194.2542   17  286 27847.0701 38484.9423  38.2%  1674  617s
H 3481  2232                    27860.238169 38484.9423  38.1%  1711  617s
  3496  2363 34031.7273   18  284 27860.2382 38484.9423  38.1%  1746  632s
  3634  2394 32270.4434   22  206 27860.2382 38484.9423  38.1%  1841  640s
  3715  2416 30448.6164   22  239 27860.2382 38484.9423  38.1%  1880  647s
H 3722  2304                    27894.152553 38484.9423  38.0%  1882  647s
  3783  2327     cutoff   23      27894.1526 38484.9423  38.0%  1914  655s
  3870  2335 31237.9175   25  235 27894.1526 38484.9423  38.0%  1950  666s
  3937  2341 29875.9476   25  228 27894.1526 38484.9423  38.0%  1986  675s
  4007  2348 27974.2757   29   86 27894.1526 38484.9423  38.0%  2019  683s
  4070  2369 35762.5698   19  326 27894.1526 38484.9423  38.0%  2046  690s
  4143  2369 34734.4941   21  232 27894.1526 38484.9423  38.0%  2073  703s
  4204  2362 33438.7744   22  252 27894.1526 38484.9423  38.0%  2087  713s
  4278  2354 33470.2454   22  304 27894.1526 38484.9423  38.0%  2106  721s
  4332  2377 31454.1512   23  188 27894.1526 38484.9423  38.0%  2142  730s
  4400  2384 31245.3895   24  148 27894.1526 38484.9423  38.0%  2167  738s
  4458  2402 30988.8741   25  231 27894.1526 38484.9423  38.0%  2176  746s
  4533  2422 30808.5273   26  151 27894.1526 38484.9423  38.0%  2194  755s
  4614  2441     cutoff   27      27894.1526 38484.9423  38.0%  2206  765s
  4714  2425 30288.6077   30  107 27894.1526 38484.9423  38.0%  2214  773s
  4753  2440     cutoff   29      27894.1526 38484.9423  38.0%  2235  780s
  4813  2469     cutoff   30      27894.1526 38127.7779  36.7%  2243  787s
  4928  2486 29406.7173   33  158 27894.1526 38127.7779  36.7%  2233  797s
  5039  2495 29878.2072   35  164 27894.1526 37704.6510  35.2%  2231  807s
  5163  2501 28552.7604   37  161 27894.1526 37244.7112  33.5%  2239  818s
  5291  2505 28113.8621   45  154 27894.1526 37149.6675  33.2%  2239  830s
  5422  2520 36645.7713   20  311 27894.1526 37149.6675  33.2%  2259  841s
  5534  2537 33909.2098   23  287 27894.1526 37087.3341  33.0%  2294  853s
  5640  2565 31674.0707   26  238 27894.1526 37087.3341  33.0%  2317  867s
  5776  2588 29872.9235   29  137 27894.1526 37087.3341  33.0%  2341  879s
  5914  2604     cutoff   33      27894.1526 37087.3341  33.0%  2345  890s
  6087  2588 34166.2443   22  399 27894.1526 36954.2946  32.5%  2350  901s
H 6198  2447                    27906.454179 36821.0188  31.9%  2351  901s
H 6210  2345                    27963.869104 36821.0188  31.7%  2350  901s
  6214  2417 32387.3994   24  325 27963.8691 36821.0188  31.7%  2352  914s
  6377  2422 31108.2861   29  266 27963.8691 36812.2738  31.6%  2376  928s
  6559  2416 28476.1075   35  170 27963.8691 36812.2738  31.6%  2389  941s
  6746  2450 29849.0851   23  342 27963.8691 36407.3768  30.2%  2407  954s
* 6837  2326              52    28121.727020 36252.0300  28.9%  2407  954s
  6992  2344 34891.6052   17  359 28121.7270 36214.2140  28.8%  2403  967s
  7233  2327 34737.2534   18  354 28121.7270 36214.2140  28.8%  2390  982s
  7452  2322 31767.5305   24  300 28121.7270 36214.2140  28.8%  2418  996s
  7672  2339 29280.1331   28  108 28121.7270 36090.2085  28.3%  2456 1012s
  7934  2336 33677.1087   22  339 28121.7270 36090.2085  28.3%  2480 1028s
  8203  2321 30507.9055   26  187 28121.7270 35795.3998  27.3%  2505 1044s
  8425  2311 28656.5945   22  345 28121.7270 35795.3998  27.3%  2544 1061s
  8700  2313 32875.8864   21  245 28121.7270 35534.7516  26.4%  2570 1077s
  8941  2369 29705.7849   26  320 28121.7270 35522.2915  26.3%  2589 1096s
  9185  2467 29963.7431   25  252 28121.7270 35522.2915  26.3%  2613 1115s
  9452  2502     cutoff   26      28121.7270 35157.7949  25.0%  2636 1133s
  9746  2585 31114.0475   26  298 28121.7270 35063.1551  24.7%  2657 1153s
 10041  2668     cutoff   31      28121.7270 34885.0339  24.1%  2679 1172s
 10421  2777 28525.4417   31  282 28121.7270 34785.3319  23.7%  2690 1192s
 10690  2886 28180.3184   33  219 28121.7270 34545.3888  22.8%  2717 1212s
 11054  3037 30007.0971   25  242 28121.7270 34493.8739  22.7%  2740 1231s
 11493  3174 32837.4489   19  151 28121.7270 34423.2363  22.4%  2752 1254s
 11943  3227     cutoff   33      28121.7270 34353.6700  22.2%  2768 1277s
 12282  3315 29695.6770   27  206 28121.7270 34052.7122  21.1%  2811 1300s
 12782  3385 29701.3717   24  193 28121.7270 33973.0555  20.8%  2823 1323s
 13048  3447 28904.8469   30   96 28121.7270 33903.0647  20.6%  2839 1345s
 13431  3529 29136.3484   28  353 28121.7270 33903.0647  20.6%  2854 1373s
 13923  3600 29526.4181   25  215 28121.7270 33785.9245  20.1%  2869 1397s
 14331  3778 31782.9601   20  353 28121.7270 33447.2360  18.9%  2883 1423s
 14887  3931 30000.7341   27  162 28121.7270 33316.8063  18.5%  2890 1450s
 15522  4077 29819.6926   25  267 28121.7270 33111.3784  17.7%  2896 1482s
 16179  4127 30264.9871   20  354 28121.7270 32914.5602  17.0%  2902 1510s
 16879  4221 29728.4477   25  320 28121.7270 32893.5596  17.0%  2906 1540s
 17575  4339 28835.0217   24  224 28121.7270 32621.6277  16.0%  2912 1571s
 18450  4416 30325.9226   24  235 28121.7270 32455.1047  15.4%  2895 1602s
 19276  4549     cutoff   28      28121.7270 32296.5079  14.8%  2893 1635s
 20181  4589 28404.7398   26  169 28121.7270 32115.6611  14.2%  2880 1668s
 20754  4654     cutoff   25      28121.7270 32002.8090  13.8%  2880 1702s
 21745  4734 29400.7460   27  285 28121.7270 31884.5260  13.4%  2865 1737s
 22845  4720 infeasible   25      28121.7270 31689.2685  12.7%  2840 1772s
 23895  4699     cutoff   31      28121.7270 31505.4161  12.0%  2829 1807s
 25064  4655     cutoff   24      28121.7270 31297.1094  11.3%  2807 1844s
 26237  4593 infeasible   32      28121.7270 31091.4320  10.6%  2788 1881s
 27499  4505     cutoff   23      28121.7270 30896.2799  9.87%  2766 1922s
 28899  4254 30170.0403   29   90 28121.7270 30698.9782  9.16%  2734 1963s
 30407  3949 28946.8306   29  216 28121.7270 30516.6005  8.52%  2697 2001s
 32077  3248     cutoff   23      28121.7270 30247.4531  7.56%  2652 2040s
 34089  2036     cutoff   30      28121.7270 29980.6683  6.61%  2588 2076s
 36481  2168 29152.0274   36   81 28121.7270 29595.7903  5.24%  2496 2102s
H38022  2093                    28199.668286 29560.4500  4.83%  2405 2102s
H38025  2078                    28204.361290 29560.4500  4.81%  2405 2102s
H39264  2061                    28218.211200 29554.0619  4.73%  2336 2102s
H43105  1403                    28222.070838 28699.4359  1.69%  2152 2130s
*43320  1403              50    28232.398775 28699.4359  1.65%  2142 2130s
H44523  1403                    28239.141916 28683.5446  1.57%  2086 2130s

Cutting planes:
  MIR: 723
  Mixing: 1
  Flow cover: 1871
  RLT: 17
  Relax-and-lift: 121

Explored 52433 nodes (93594983 simplex iterations) in 2133.27 seconds (7092.82 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 28239.1 28239.1 28232.4 ... 27906.5

Optimal solution found (tolerance 1.00e-04)
Best objective 2.823914191621e+04, best bound 2.823914191621e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2133.40s
  Master Objective (UB) = 28239.14, θ = 170884.26
  Upper Bound (UB) = 28239.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170884.26
  [DEBUG]   ✓ Scenario 0: θ = 170884.26 ≤ Q = 177655.05 (slack: 6770.79)
  [DEBUG]   ✓ Scenario 1: θ = 170884.26 ≤ Q = 170884.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170884.26 ≤ Q = 170909.12 (slack: 24.86)
  [DEBUG]   ✓ Scenario 3: θ = 170884.26 ≤ Q = 170884.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 170884.26 ≤ Q = 170922.00 (slack: 37.74)
  [DEBUG]   ✓ Scenario 5: θ = 170884.26 ≤ Q = 172735.46 (slack: 1851.20)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x9715180
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x09715180
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.284512e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1360 nonzeros
Found heuristic solution: objective 6063093.7657
Variable types: 329 continuous, 157 integer (157 binary)

Root relaxation: objective -1.601930e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160193.02    0  120 6063093.77 -160193.02   103%     -    0s
H    0     0                    -130076.1530 -160193.02  23.2%     -    0s
H    0     0                    -135628.1862 -160193.02  18.1%     -    0s
     0     0 -141084.25    0   96 -135628.19 -141084.25  4.02%     -    0s
H    0     0                    -138330.8487 -141079.42  1.99%     -    0s
     0     0 -140894.12    0   92 -138330.85 -140894.12  1.85%     -    0s
     0     0 -140890.68    0   92 -138330.85 -140890.68  1.85%     -    0s
H    0     0                    -139031.7042 -140890.68  1.34%     -    0s
     0     0 -140188.25    0   73 -139031.70 -140188.25  0.83%     -    0s
     0     0 -140160.01    0   73 -139031.70 -140160.01  0.81%     -    0s
     0     0 -140145.25    0   71 -139031.70 -140145.25  0.80%     -    0s
     0     0 -139852.96    0   78 -139031.70 -139852.96  0.59%     -    0s
     0     0 -139847.56    0   73 -139031.70 -139847.56  0.59%     -    0s
     0     0 -139572.68    0   78 -139031.70 -139572.68  0.39%     -    0s
     0     0 -139571.18    0   76 -139031.70 -139571.18  0.39%     -    0s
     0     0 -139509.77    0   40 -139031.70 -139509.77  0.34%     -    0s
H    0     0                    -139318.8315 -139508.48  0.14%     -    0s
     0     0 -139508.48    0   33 -139318.83 -139508.48  0.14%     -    0s
     0     0 -139508.48    0   27 -139318.83 -139508.48  0.14%     -    0s
     0     0 -139494.12    0   28 -139318.83 -139494.12  0.13%     -    0s
H    0     0                    -139332.3482 -139486.50  0.11%     -    0s
     0     0 -139486.50    0   64 -139332.35 -139486.50  0.11%     -    0s
     0     0 -139486.50    0   28 -139332.35 -139486.50  0.11%     -    0s
     0     0 -139482.27    0   28 -139332.35 -139482.27  0.11%     -    0s
     0     0 -139482.27    0   66 -139332.35 -139482.27  0.11%     -    0s
     0     0 -139482.27    0   76 -139332.35 -139482.27  0.11%     -    0s
     0     0 -139482.27    0   37 -139332.35 -139482.27  0.11%     -    0s
     0     0 -139471.48    0   33 -139332.35 -139471.48  0.10%     -    0s
     0     0 -139470.95    0   28 -139332.35 -139470.95  0.10%     -    0s
     0     0 -139464.38    0   30 -139332.35 -139464.38  0.09%     -    0s
     0     0 -139458.34    0   30 -139332.35 -139458.34  0.09%     -    0s
     0     0 -139420.55    0   37 -139332.35 -139420.55  0.06%     -    0s
     0     0 -139358.87    0    5 -139332.35 -139358.87  0.02%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 1
  MIR: 94
  Flow cover: 8

Explored 1 nodes (964 simplex iterations) in 0.11 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -139332 -139319 -139032 ... 1.28451e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.393323482223e+05, best bound -1.393355663776e+05, gap 0.0023%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 155110.59
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139332.35
  [DEBUG]   S×d_nominal = 294442.94
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294442.94 + -139332.35 = 155110.59
  [DEBUG]   Current θ from Master = 170884.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15773.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12465.48
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 4011.2279, Absolute Gap = 4011.2279, Relative Gap = 0.142045
  Not converged yet (gap = 4011.23 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308115 nonzeros
Model fingerprint: 0xa6627cd8
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50297 rows and 20427 columns
Presolve time: 0.94s
Presolved: 58116 rows, 25513 columns, 361344 nonzeros
Variable types: 23254 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329277.6881
Found heuristic solution: objective -184706.4344

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58116 rows, 25513 columns, 361344 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31252   -1.1605721e+04   0.000000e+00   3.249867e+07      5s
   46711    2.5628828e+04   0.000000e+00   1.070555e+08     10s
   60680    3.5056369e+04   0.000000e+00   2.950717e+07     15s
   72002    4.2196914e+04   0.000000e+00   7.880999e+06     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 5.425376e+04, 45267 iterations, 21.62 seconds (44.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54253.7623    0   74 -184706.43 54253.7623   129%     -   23s
H    0     0                    -178412.1525 54253.7623   130%     -   23s
H    0     0                    -105776.1749 54253.7623   151%     -   23s
H    0     0                    -94810.18789 54253.7623   157%     -   23s
H    0     0                    -94283.65179 54253.7623   158%     -   23s
H    0     0                    -94263.36685 54253.7623   158%     -   23s
H    0     0                    -40359.50500 54253.7623   234%     -   23s
H    0     0                    -9335.680735 54253.7623   681%     -   23s
H    0     0                    3552.6377652 54253.7623  1427%     -   23s
H    0     0                    7944.6755790 54253.7623   583%     -   23s
H    0     0                    14015.484313 54253.7623   287%     -   23s
H    0     0                    14218.753114 49210.1687   246%     -   31s
     0     0 49187.1405    0  194 14218.7531 49187.1405   246%     -   31s
     0     0 48919.0739    0  189 14218.7531 48919.0739   244%     -   34s
     0     0 48919.0739    0  197 14218.7531 48919.0739   244%     -   36s
     0     0 48919.0739    0  189 14218.7531 48919.0739   244%     -   36s
     0     0 48919.0739    0  185 14218.7531 48919.0739   244%     -   36s
     0     0 48919.0739    0  189 14218.7531 48919.0739   244%     -   37s
     0     0 48919.0739    0  190 14218.7531 48919.0739   244%     -   37s
     0     0 48919.0739    0  191 14218.7531 48919.0739   244%     -   38s
     0     0 48919.0730    0  187 14218.7531 48919.0730   244%     -   38s
H    0     0                    15080.512295 46210.7838   206%     -   47s
H    0     0                    15175.596026 46210.7838   205%     -   47s
H    0     0                    15226.700759 46210.7838   203%     -   47s
H    0     0                    16002.823199 46210.7838   189%     -   47s
H    0     0                    16534.672700 46210.7838   179%     -   47s
H    0     0                    16659.284112 46210.7838   177%     -   47s
H    0     0                    16697.896639 46210.7838   177%     -   47s
H    0     0                    21544.506199 46210.7838   114%     -   47s
H    0     0                    21997.172968 46210.7838   110%     -   47s
     0     0 46208.8639    0  277 21997.1730 46208.8639   110%     -   47s
H    0     0                    24968.159482 46208.8639  85.1%     -   47s
H    0     0                    25053.784740 46208.8639  84.4%     -   47s
H    0     0                    25258.719721 46208.8639  82.9%     -   47s
H    0     0                    25316.963831 46208.8639  82.5%     -   47s
H    0     0                    25411.523797 46208.8639  81.8%     -   47s
H    0     0                    25445.186946 46208.8639  81.6%     -   47s
H    0     0                    25554.145466 46208.8639  80.8%     -   47s
H    0     0                    25627.011344 46208.8639  80.3%     -   47s
H    0     0                    25648.957027 46208.8639  80.2%     -   47s
H    0     0                    25752.330182 46208.8639  79.4%     -   47s
H    0     0                    25790.367125 46208.8639  79.2%     -   47s
     0     0 45825.2957    0  284 25790.3671 45825.2957  77.7%     -   51s
     0     0 45735.0801    0  280 25790.3671 45735.0801  77.3%     -   53s
     0     0 45723.2188    0  281 25790.3671 45723.2188  77.3%     -   54s
     0     0 45720.5444    0  292 25790.3671 45720.5444  77.3%     -   54s
     0     0 45717.7011    0  292 25790.3671 45717.7011  77.3%     -   54s
     0     0 45677.6082    0  276 25790.3671 45677.6082  77.1%     -   55s
     0     0 45614.4115    0  279 25790.3671 45614.4115  76.9%     -   56s
     0     0 45608.2500    0  283 25790.3671 45608.2500  76.8%     -   57s
     0     0 45597.3796    0  283 25790.3671 45597.3796  76.8%     -   58s
     0     0 45596.8564    0  283 25790.3671 45596.8564  76.8%     -   58s
H    0     0                    25959.094956 43319.6343  66.9%     -   71s
     0     0 43319.6343    0  389 25959.0950 43319.6343  66.9%     -   71s
H    0     0                    26439.666218 42886.1768  62.2%     -   76s
H    0     0                    26480.091374 42886.1768  62.0%     -   76s
H    0     0                    26769.254214 42886.1768  60.2%     -   76s
     0     0 42886.1768    0  310 26769.2542 42886.1768  60.2%     -   76s
     0     0 42666.7977    0  329 26769.2542 42666.7977  59.4%     -   78s
     0     0 42591.6984    0  329 26769.2542 42591.6984  59.1%     -   81s
     0     0 42507.0682    0  383 26769.2542 42507.0682  58.8%     -   84s
     0     0 42435.7433    0  418 26769.2542 42435.7433  58.5%     -   86s
     0     0 42426.4611    0  336 26769.2542 42426.4611  58.5%     -   87s
     0     0 42410.4115    0  381 26769.2542 42410.4115  58.4%     -   88s
     0     0 42405.9807    0  419 26769.2542 42405.9807  58.4%     -   88s
     0     0 42405.0748    0  417 26769.2542 42405.0748  58.4%     -   89s
     0     0 41855.0884    0  411 26769.2542 41855.0884  56.4%     -   96s
H    0     0                    26787.328026 41853.9236  56.2%     -   97s
H    0     0                    26792.021029 41853.9236  56.2%     -   97s
H    0     0                    26831.637897 41853.9236  56.0%     -   97s
H    0     0                    26884.272431 41853.9236  55.7%     -   97s
     0     0 41666.1965    0  404 26884.2724 41666.1965  55.0%     -  102s
     0     0 41571.5057    0  371 26884.2724 41571.5057  54.6%     -  105s
     0     0 41529.4488    0  389 26884.2724 41529.4488  54.5%     -  107s
     0     0 41503.1361    0  413 26884.2724 41503.1361  54.4%     -  109s
     0     0 41491.1190    0  416 26884.2724 41491.1190  54.3%     -  110s
     0     0 41440.4723    0  416 26884.2724 41440.4723  54.1%     -  113s
     0     0 41429.5927    0  418 26884.2724 41429.5927  54.1%     -  114s
     0     0 41426.9807    0  418 26884.2724 41426.9807  54.1%     -  114s
     0     0 41414.8516    0  420 26884.2724 41414.8516  54.0%     -  115s
     0     0 41414.0991    0  421 26884.2724 41414.0991  54.0%     -  115s
     0     0 41327.9611    0  458 26884.2724 41327.9611  53.7%     -  119s
H    0     0                    26885.034739 41326.5137  53.7%     -  119s
     0     0 41286.5225    0  474 26885.0347 41286.5225  53.6%     -  121s
     0     0 41267.7563    0  472 26885.0347 41267.7563  53.5%     -  123s
     0     0 41261.0161    0  478 26885.0347 41261.0161  53.5%     -  124s
     0     0 41256.0045    0  480 26885.0347 41256.0045  53.5%     -  124s
     0     0 41253.0813    0  479 26885.0347 41253.0813  53.4%     -  125s
     0     0 41251.2632    0  483 26885.0347 41251.2632  53.4%     -  125s
     0     0 41250.9017    0  482 26885.0347 41250.9017  53.4%     -  125s
     0     0 41161.9722    0  437 26885.0347 41161.9722  53.1%     -  129s
H    0     0                    26893.632551 41161.2228  53.1%     -  129s
H    0     0                    27187.829690 41161.2228  51.4%     -  129s
     0     0 41139.2826    0  430 27187.8297 41139.2826  51.3%     -  132s
     0     0 41121.6096    0  484 27187.8297 41121.6096  51.3%     -  134s
     0     0 41109.4185    0  479 27187.8297 41109.4185  51.2%     -  135s
     0     0 41106.2437    0  475 27187.8297 41106.2437  51.2%     -  136s
     0     0 41105.5485    0  481 27187.8297 41105.5485  51.2%     -  136s
     0     0 41087.8462    0  426 27187.8297 41087.8462  51.1%     -  138s
H    0     0                    27378.653675 41087.1839  50.1%     -  139s
     0     0 41079.1541    0  430 27378.6537 41079.1541  50.0%     -  140s
     0     0 41076.8277    0  432 27378.6537 41076.8277  50.0%     -  141s
     0     0 41076.0587    0  441 27378.6537 41076.0587  50.0%     -  141s
     0     0 41062.9958    0  433 27378.6537 41062.9958  50.0%     -  143s
     0     0 41057.2829    0  440 27378.6537 41057.2829  50.0%     -  145s
     0     0 41055.8026    0  442 27378.6537 41055.8026  50.0%     -  145s
     0     0 41045.0010    0  426 27378.6537 41045.0010  49.9%     -  147s
     0     0 41042.2885    0  353 27378.6537 41042.2885  49.9%     -  148s
     0     0 41042.0938    0  439 27378.6537 41042.0938  49.9%     -  148s
     0     0 41040.1550    0  485 27378.6537 41040.1550  49.9%     -  149s
H    0     0                    27390.966633 41039.0699  49.8%     -  150s
     0     0 41039.0699    0  487 27390.9666 41039.0699  49.8%     -  150s
     0     0 41039.0699    0  442 27390.9666 41039.0699  49.8%     -  151s
     0     0 41039.0699    0  442 27390.9666 41039.0699  49.8%     -  151s
     0     0 41036.6929    0  352 27390.9666 41036.6929  49.8%     -  152s
     0     0 41035.7714    0  368 27390.9666 41035.7714  49.8%     -  156s
     0     0 41030.0486    0  438 27390.9666 41030.0486  49.8%     -  157s
     0     0 41029.2616    0  438 27390.9666 41029.2616  49.8%     -  157s
     0     2 41029.2616    0  438 27390.9666 41029.2616  49.8%     -  181s
     1     4 40909.9123    1  427 27390.9666 41027.2114  49.8%  1733  186s
     3     8 40853.3492    2  420 27390.9666 40909.9041  49.4%  3705  192s
     7    14 40582.7062    3  415 27390.9666 40852.1757  49.1%  4978  203s
    13    28 40204.5881    4  425 27390.9666 40840.3543  49.1%  8284  215s
    27    43 36358.4805    5  279 27390.9666 40204.5803  46.8% 11471  235s
H   42    75                    27643.821775 40204.4462  45.4%  9947  251s
H   45    75                    27669.085631 40204.4462  45.3%  9818  251s
H   54    75                    27671.219269 40204.4462  45.3%  9236  251s
H   57    75                    27682.439025 40204.4462  45.2%  9162  251s
H   62    75                    27714.845324 40204.4462  45.1%  8649  251s
    74   200 38708.3549    7  284 27714.8453 40115.7095  44.7%  8424  266s
   199   306 38282.6762   12  281 27714.8453 40112.6657  44.7%  4500  273s
   305   381 34241.2335   16  255 27714.8453 40112.6657  44.7%  3827  281s
   380   413 32022.7254   17  287 27714.8453 40112.6657  44.7%  3767  287s
   412   450 31854.8110   18  293 27714.8453 40112.6657  44.7%  3696  295s
   451   486 30938.9463   20  335 27714.8453 40112.6657  44.7%  3717  302s
   493   522     cutoff   23      27714.8453 40112.6657  44.7%  3665  307s
   541   553 30539.8833   24  302 27714.8453 40112.6657  44.7%  3565  313s
   596   596 28855.9994   27  209 27714.8453 40112.6657  44.7%  3445  321s
H  607   596                    27799.990545 40112.6657  44.3%  3429  321s
   649   667 28461.0573   29  193 27799.9905 40112.6657  44.3%  3316  329s
   749   734     cutoff   30      27799.9905 40112.6657  44.3%  3112  336s
   844   797 32194.8862   36  111 27799.9905 39564.5183  42.3%  2959  344s
   933   871 38262.1154   10  285 27799.9905 39506.5119  42.1%  2858  352s
  1019   971 38102.2577   11  278 27799.9905 39506.5119  42.1%  2814  359s
  1131  1062 38028.0096   12  279 27799.9905 39506.5119  42.1%  2701  367s
  1255  1148 35469.0582   13  284 27799.9905 39506.5119  42.1%  2587  375s
  1379  1236 34740.6140   14  285 27799.9905 39470.5745  42.0%  2484  382s
  1497  1335 34281.8715   16  249 27799.9905 39470.5745  42.0%  2412  391s
  1619  1366 33862.3186   18  272 27799.9905 39470.5745  42.0%  2347  398s
  1652  1394 33126.9249   19  232 27799.9905 39470.5745  42.0%  2333  405s
  1686  1426 32867.3631   20  203 27799.9905 39470.5745  42.0%  2347  412s
  1720  1447 32632.3641   21  201 27799.9905 39470.5745  42.0%  2348  419s
  1759  1485 32514.6381   22  193 27799.9905 39470.5745  42.0%  2337  424s
  1803  1542 32400.4092   23  193 27799.9905 39470.5745  42.0%  2320  430s
  1878  1611 32345.4325   24  184 27799.9905 39179.8942  40.9%  2272  439s
  2003  1679 30543.0819   25  163 27799.9905 39179.8942  40.9%  2213  449s
H 2086  1679                    27813.898292 39179.8942  40.9%  2185  449s
  2097  1805 30133.8135   28  164 27813.8983 39179.8942  40.9%  2181  459s
  2293  1927 29058.2434   37  147 27813.8983 39179.8942  40.9%  2106  468s
  2481  2018     cutoff   40      27813.8983 39080.0777  40.5%  2059  479s
  2658  2151 35022.5534   12  410 27813.8983 39080.0777  40.5%  2038  489s
  2830  2179 33310.3185   15  250 27813.8983 38760.7933  39.4%  2026  498s
  2866  2213 30982.7831   16  206 27813.8983 38760.7933  39.4%  2043  503s
H 2867  2213                    27815.994242 38760.7933  39.3%  2042  503s
  2900  2369 30727.2280   17  195 27815.9942 38760.7933  39.3%  2049  513s
  3102  2530 29886.1559   22  225 27815.9942 38760.7933  39.3%  2020  525s
  3341  2679     cutoff   36      27815.9942 38743.6177  39.3%  1982  537s
H 3596  2745                    27884.574755 38743.6177  38.9%  1941  549s
  3723  2870 33500.1183   16  350 27884.5748 38743.6177  38.9%  1947  562s
  3892  2871 30513.7764   29  438 27884.5748 38412.1649  37.8%  1958  615s
  3894  2872 34084.5994   10   74 27884.5748 38412.1649  37.8%  1957  635s
  3895  2873 30183.3194   28  314 27884.5748 38412.1649  37.8%  1956  650s
  3896  2874 29691.6887   13  330 27884.5748 38412.1649  37.8%  1956  664s
  3897  2874 29838.6530   32  440 27884.5748 38412.1649  37.8%  1955  672s
  3898  2875 31948.7804   17  471 27884.5748 38412.1649  37.8%  1955  680s
  3900  2876 30510.6532   51  414 27884.5748 38412.1649  37.8%  1954  686s
  3902  2878 30350.8429   21  425 27884.5748 38412.1649  37.8%  1953  692s
  3904  2879 28628.6448   60  443 27884.5748 38412.1649  37.8%  1952  697s
  3907  2881 29409.2942   18  459 27884.5748 38412.1649  37.8%  1950  700s
  3910  2883 34830.7193   15  466 27884.5748 38412.1649  37.8%  1949  707s
  3912  2884 32347.1906   20  478 27884.5748 38412.1649  37.8%  1948  711s
  3914  2886 35769.3019    9  492 27884.5748 38412.1649  37.8%  1947  716s
  3915  2886 37814.3435    9  377 27884.5748 38412.1649  37.8%  1946  721s
  3917  2888 29573.9356   48  499 27884.5748 38412.1649  37.8%  1945  727s
  3918  2888 30868.7807   36  486 27884.5748 38412.1649  37.8%  1945  730s
  3919  2889 30741.3628   24  502 27884.5748 38412.1649  37.8%  1944  735s
  3921  2890 31098.3939   16  502 27884.5748 38412.1649  37.8%  1943  742s
  3923  2892 32959.2906   31  398 27884.5748 38412.1649  37.8%  1942  747s
  3925  2893 35561.0928   13  454 27884.5748 38412.1649  37.8%  1941  752s
  3927  2894 29057.0917   24  431 27884.5748 38412.1649  37.8%  1940  758s
  3928  2895 28688.7169   59  431 27884.5748 38412.1649  37.8%  1940  777s
  3929  2896 31846.4888   19  431 27884.5748 38412.1649  37.8%  1939  793s
  3930  2899 38412.1649   15  424 27884.5748 38412.1649  37.8%  1984  818s
  3932  2903 38412.1649   16  358 27884.5748 38412.1649  37.8%  1987  834s
  3936  2909 38412.1649   17  366 27884.5748 38412.1649  37.8%  1992  844s
  3944  2923 38412.1649   18  461 27884.5748 38412.1649  37.8%  2003  862s
  3960  2933 38412.1649   19  465 27884.5748 38412.1649  37.8%  2028  888s
  3976  2960 36574.6132   20  404 27884.5748 38412.1649  37.8%  2088  904s
  4008  3021 36315.6533   21  398 27884.5748 38412.1649  37.8%  2127  922s
H 4051  2861                    27885.081313 38412.1649  37.8%  2142  922s
  4082  2969 36060.5633   22  404 27885.0813 38412.1649  37.8%  2149  938s
  4208  3008 35275.2440   23  260 27885.0813 38412.1649  37.8%  2171  948s
  4301  3003 34467.4752   23  286 27885.0813 38412.1649  37.8%  2186  954s
H 4304  2864                    27886.122569 38412.1649  37.7%  2187  954s
  4341  2909 34786.3297   23  396 27886.1226 38412.1649  37.7%  2200  963s
  4440  2900 35095.7832   24  383 27886.1226 38412.1649  37.7%  2202  972s
  4473  2922 35272.1324   24  309 27886.1226 38412.1649  37.7%  2217  980s
  4531  2944 34680.1452   25  340 27886.1226 38412.1649  37.7%  2214  989s
  4610  2953 34283.3638   26  334 27886.1226 38412.1649  37.7%  2211  997s
  4696  2934 33663.9767   28  363 27886.1226 38412.1649  37.7%  2207 1006s
  4777  2925 33231.5249   26  259 27886.1226 38412.1649  37.7%  2199 1014s
  4836  2915 32684.3343   27  226 27886.1226 38412.1649  37.7%  2233 1024s
  4905  2922 32162.3164   28  224 27886.1226 38412.1649  37.7%  2258 1041s
  4975  2937 31373.3295   30  129 27886.1226 38412.1649  37.7%  2277 1051s
  5059  2951 30537.1462   33  106 27886.1226 38412.1649  37.7%  2296 1063s
  5172  2930 29635.8400   37   97 27886.1226 38412.1649  37.7%  2297 1079s
  5287  2917 29622.7123   35  100 27886.1226 38412.1649  37.7%  2298 1090s
  5397  2913 29233.8560   39   97 27886.1226 38412.1649  37.7%  2316 1102s
  5509  2894 infeasible   44      27886.1226 38412.1649  37.7%  2335 1112s
  5574  2914 31741.3789   23  209 27886.1226 38412.1649  37.7%  2362 1121s
  5671  2934 30938.8800   26  124 27886.1226 38412.1649  37.7%  2379 1133s
  5762  2969 28843.3515   28  162 27886.1226 38412.1649  37.7%  2396 1146s
  5862  3008 28297.0594   31   65 27886.1226 38412.1649  37.7%  2416 1159s
  5991  3024     cutoff   35      27886.1226 38401.1499  37.7%  2425 1171s
  6171  3065 36039.0450   21  429 27886.1226 38401.1499  37.7%  2420 1187s
  6364  3072 35581.0241   22  427 27886.1226 38401.1499  37.7%  2409 1201s
  6579  3044 34479.4315   24  357 27886.1226 36804.1892  32.0%  2411 1220s
  6713  3089 34412.5373   25  314 27886.1226 36804.1892  32.0%  2420 1233s
  6859  3123 34280.8365   26  316 27886.1226 36666.9910  31.5%  2437 1249s
  7036  3153 28979.9510   28  136 27886.1226 36251.3446  30.0%  2451 1264s
  7198  3197 29531.9225   26  389 27886.1226 36251.3446  30.0%  2480 1279s
  7415  3207     cutoff   29      27886.1226 36251.3446  30.0%  2484 1294s
  7667  3186     cutoff   27      27886.1226 35874.3468  28.6%  2486 1310s
  7833  3199 34940.3129   23  315 27886.1226 35874.3468  28.6%  2517 1325s
  7998  3192 34571.4197   24  290 27886.1226 35635.3834  27.8%  2526 1341s
H 8065  3038                    27890.613975 35635.3834  27.8%  2543 1341s
  8131  3121 34167.6293   25  296 27890.6140 35635.3834  27.8%  2553 1359s
  8366  3153 31772.2849   27  333 27890.6140 35635.3834  27.8%  2570 1376s
  8650  3156 29385.9663   31  117 27890.6140 34939.9555  25.3%  2583 1393s
  8917  3141 33653.3664   25  343 27890.6140 34829.5801  24.9%  2598 1411s
  9159  3134 31342.6826   28  249 27890.6140 34829.5801  24.9%  2628 1430s
  9437  3103     cutoff   52      27890.6140 34588.2801  24.0%  2653 1448s
  9636  3100 30528.7331   25  332 27890.6140 34569.4934  23.9%  2674 1471s
* 9764  2922              62    28012.865209 34478.4192  23.1%  2694 1471s
  9869  2930     cutoff   28      28012.8652 34467.4083  23.0%  2709 1489s
H 9875  2810                    28017.573064 34467.4083  23.0%  2710 1489s
 10064  2830 31330.9933   24  263 28017.5731 34410.5495  22.8%  2736 1513s
 10408  2852 30447.2990   30  120 28017.5731 34367.8027  22.7%  2753 1536s
 10798  2896 29160.5938   23  245 28017.5731 34211.2201  22.1%  2759 1557s
 11215  2934 29138.6339   32  111 28017.5731 33988.3295  21.3%  2765 1582s
 11502  3053     cutoff   26      28017.5731 33858.3519  20.8%  2800 1606s
 11876  3139 30397.8409   27  361 28017.5731 33858.3519  20.8%  2823 1634s
 12220  3218     cutoff   34      28017.5731 33704.5824  20.3%  2850 1658s
 12646  3279 29588.6652   28  239 28017.5731 33458.1547  19.4%  2869 1684s
 13042  3380     cutoff   30      28017.5731 33316.2151  18.9%  2901 1709s
 13529  3455 29242.4347   27  148 28017.5731 33223.1035  18.6%  2919 1739s
 13975  3554 29334.7993   27  222 28017.5731 32948.9789  17.6%  2946 1767s
 14498  3682 29221.2092   25  342 28017.5731 32857.4862  17.3%  2964 1796s
 15034  3755 29279.2635   32   67 28017.5731 32600.5035  16.4%  2983 1824s
H15341  3746                    28058.368434 32571.3413  16.1%  3001 1824s
 15457  3856     cutoff   27      28058.3684 32556.0782  16.0%  3000 1855s
H16110  3823                    28121.727020 32437.6187  15.3%  3004 1883s
 16210  3909 30161.6794   30  266 28121.7270 32384.5638  15.2%  3008 1918s
 16813  3958     cutoff   31      28121.7270 32219.6769  14.6%  3023 1951s
 17514  4046 31193.9274   28  246 28121.7270 32080.7248  14.1%  3026 1982s
 18273  4086 29581.1817   24  403 28121.7270 31904.4303  13.5%  3026 2018s
 19036  4127     cutoff   34      28121.7270 31729.7859  12.8%  3030 2052s
 19887  4140     cutoff   34      28121.7270 31514.0996  12.1%  3021 2092s
 20859  4094 infeasible   31      28121.7270 31361.2035  11.5%  3004 2130s
 21748  4081 28371.1164   37   75 28121.7270 31192.3295  10.9%  2994 2167s
 22892  3957 infeasible   38      28121.7270 30954.1838  10.1%  2969 2203s
 23975  3775 30091.4550   28  160 28121.7270 30768.3049  9.41%  2954 2240s
 25158  3460 28894.0655   28  118 28121.7270 30521.8749  8.53%  2931 2282s
 26500  2902     cutoff   33      28121.7270 30260.5285  7.61%  2896 2319s
 28092  1799 28399.5982   39  126 28121.7270 30024.4157  6.77%  2843 2355s
 30312  1262     cutoff   32      28121.7270 29563.8902  5.13%  2732 2385s
 35338  1508 28187.0187   53   41 28121.7270 28708.3265  2.09%  2403 2416s
H35479  1508                    28225.772924 28677.3214  1.60%  2394 2416s
 36168  1130     cutoff   60      28225.7729 28584.3182  1.27%  2352 2424s
 41435    10     cutoff   55      28225.7729 28401.3754  0.62%  2062 2426s

Cutting planes:
  Learned: 1
  MIR: 534
  Flow cover: 1612
  RLT: 18
  Relax-and-lift: 95

Explored 42952 nodes (85718685 simplex iterations) in 2426.91 seconds (7881.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 28225.8 28225.8 28121.7 ... 27816

Optimal solution found (tolerance 1.00e-04)
Best objective 2.822577292429e+04, best bound 2.822577292429e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2426.95s
  Master Objective (UB) = 28225.77, θ = 171640.87
  Upper Bound (UB) = 28225.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171640.87
  [DEBUG]   ✓ Scenario 0: θ = 171640.87 ≤ Q = 178554.88 (slack: 6914.01)
  [DEBUG]   ✓ Scenario 1: θ = 171640.87 ≤ Q = 171640.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171640.87 ≤ Q = 171640.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171640.87 ≤ Q = 174046.36 (slack: 2405.49)
  [DEBUG]   ✓ Scenario 4: θ = 171640.87 ≤ Q = 171640.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 171640.87 ≤ Q = 171661.99 (slack: 21.12)
  [DEBUG]   ✓ Scenario 6: θ = 171640.87 ≤ Q = 171640.87 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x18d07f1e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x18d07f1e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.294643e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6115232.7960
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.533663e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153366.34    0  128 6115232.80 -153366.34   103%     -    0s
H    0     0                    -118427.9767 -153366.34  29.5%     -    0s
H    0     0                    -128356.2952 -153366.34  19.5%     -    0s
H    0     0                    -128685.8155 -140782.56  9.40%     -    0s
H    0     0                    -138205.5974 -140782.56  1.86%     -    0s
     0     0 -140782.56    0   94 -138205.60 -140782.56  1.86%     -    0s
H    0     0                    -138725.0179 -140315.83  1.15%     -    0s
     0     0 -140315.83    0   94 -138725.02 -140315.83  1.15%     -    0s
     0     0 -139539.74    0   63 -138725.02 -139539.74  0.59%     -    0s
     0     0 -139388.86    0   59 -138725.02 -139388.86  0.48%     -    0s
     0     0 -139388.86    0   58 -138725.02 -139388.86  0.48%     -    0s
     0     0 -139037.58    0   34 -138725.02 -139037.58  0.23%     -    0s
     0     0 -138943.85    0   30 -138725.02 -138943.85  0.16%     -    0s
     0     0 -138883.58    0   12 -138725.02 -138883.58  0.11%     -    0s
     0     0 -138844.29    0   17 -138725.02 -138844.29  0.09%     -    0s
     0     0 -138825.44    0   16 -138725.02 -138825.44  0.07%     -    0s
     0     0 -138822.23    0   15 -138725.02 -138822.23  0.07%     -    0s
     0     0 -138777.63    0    6 -138725.02 -138777.63  0.04%     -    0s
     0     0 -138761.48    0    4 -138725.02 -138761.48  0.03%     -    0s
     0     0 -138753.17    0    2 -138725.02 -138753.17  0.02%     -    0s
H    0     0                    -138748.2776 -138753.17  0.00%     -    0s

Explored 1 nodes (697 simplex iterations) in 0.17 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -138748 -138725 -138271 ... 1.29464e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.387482775510e+05, best bound -1.387531711467e+05, gap 0.0035%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 155548.68
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138748.28
  [DEBUG]   S×d_nominal = 294296.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 294296.95 + -138748.28 = 155548.68
  [DEBUG]   Current θ from Master = 171640.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16092.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12133.58
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 3997.8589, Absolute Gap = 3997.8589, Relative Gap = 0.141639
  Not converged yet (gap = 3997.86 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351343 nonzeros
Model fingerprint: 0xf67e2329
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57488 rows and 23348 columns
Presolve time: 3.46s
Presolved: 66215 rows, 28832 columns, 412159 nonzeros
Variable types: 26573 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329277.6881
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66215 rows, 28832 columns, 412159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21875   -1.9002996e+05   0.000000e+00   1.308165e+07      5s
   40484   -1.3914586e+04   0.000000e+00   2.715547e+07     10s
   51589    1.2076487e+04   0.000000e+00   4.791850e+06     15s
   62449    3.4961551e+04   0.000000e+00   1.247906e+07     20s
   74290    3.9351135e+04   0.000000e+00   2.837391e+07     25s
   85087    4.2697220e+04   0.000000e+00   4.431874e+06     30s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 5.395533e+04, 70059 iterations, 30.19 seconds (54.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53955.3345    0   73 -187498.33 53955.3345   129%     -   34s
H    0     0                    -173791.0595 53955.3345   131%     -   34s
H    0     0                    -129062.0222 53955.3345   142%     -   34s
H    0     0                    -128702.9721 53955.3345   142%     -   34s
H    0     0                    -105433.7435 53955.3345   151%     -   34s
H    0     0                    -103894.3424 53955.3345   152%     -   34s
H    0     0                    -103835.1472 53955.3345   152%     -   34s
H    0     0                    -40359.50500 53955.3345   234%     -   34s
H    0     0                    -7436.185528 53955.3345   826%     -   34s
H    0     0                    2344.7181860 53955.3345  2201%     -   34s
H    0     0                    9421.6646309 53955.3345   473%     -   35s
H    0     0                    9922.5542226 53955.3345   444%     -   35s
H    0     0                    14015.484313 53955.3345   285%     -   35s
H    0     0                    14218.753114 49318.0452   247%     -   47s
     0     0 49318.0452    0  182 14218.7531 49318.0452   247%     -   47s
     0     0 48984.4443    0  194 14218.7531 48984.4443   245%     -   51s
     0     0 48984.4443    0  193 14218.7531 48984.4443   245%     -   51s
     0     0 48952.0365    0  197 14218.7531 48952.0365   244%     -   53s
     0     0 48952.0365    0  201 14218.7531 48952.0365   244%     -   54s
     0     0 48952.0365    0  200 14218.7531 48952.0365   244%     -   54s
     0     0 48952.0365    0  198 14218.7531 48952.0365   244%     -   55s
     0     0 48952.0365    0  201 14218.7531 48952.0365   244%     -   56s
     0     0 48952.0166    0  202 14218.7531 48952.0166   244%     -   57s
     0     0 46142.5277    0  256 14218.7531 46142.5277   225%     -   71s
H    0     0                    19210.712065 46142.5277   140%     -   71s
     0     0 45533.9118    0  209 19210.7121 45533.9118   137%     -   78s
     0     0 45458.7382    0  247 19210.7121 45458.7382   137%     -   80s
     0     0 45224.4871    0  284 19210.7121 45224.4871   135%     -   86s
     0     0 45120.9234    0  285 19210.7121 45120.9234   135%     -   90s
     0     0 45109.9764    0  287 19210.7121 45109.9764   135%     -   91s
H    0     0                    19516.489305 45067.0828   131%     -   93s
H    0     0                    19799.898207 45067.0828   128%     -   93s
     0     0 45067.0828    0  297 19799.8982 45067.0828   128%     -   93s
     0     0 45060.2941    0  295 19799.8982 45060.2941   128%     -   93s
     0     0 45058.4301    0  293 19799.8982 45058.4301   128%     -   93s
     0     0 45057.6600    0  298 19799.8982 45057.6600   128%     -   94s
     0     0 43092.2345    0  353 19799.8982 43092.2345   118%     -  111s
H    0     0                    19899.426716 43091.3882   117%     -  112s
     0     0 42664.8902    0  350 19899.4267 42664.8902   114%     -  118s
     0     0 42557.6452    0  401 19899.4267 42557.6452   114%     -  122s
     0     0 42432.6725    0  351 19899.4267 42432.6725   113%     -  124s
     0     0 42392.1100    0  352 19899.4267 42392.1100   113%     -  125s
     0     0 42385.0041    0  353 19899.4267 42385.0041   113%     -  126s
     0     0 42379.4103    0  353 19899.4267 42379.4103   113%     -  126s
     0     0 42378.2637    0  353 19899.4267 42378.2637   113%     -  127s
     0     0 41915.0180    0  391 19899.4267 41915.0180   111%     -  139s
H    0     0                    20422.985320 41728.3979   104%     -  145s
H    0     0                    20449.365855 41728.3979   104%     -  145s
     0     0 41728.3979    0  359 20449.3659 41728.3979   104%     -  145s
     0     0 41688.9980    0  411 20449.3659 41688.9980   104%     -  147s
     0     0 41635.5082    0  325 20449.3659 41635.5082   104%     -  150s
     0     0 41568.7022    0  410 20449.3659 41568.7022   103%     -  153s
     0     0 41490.5142    0  363 20449.3659 41490.5142   103%     -  156s
H    0     0                    22221.805791 41465.1734  86.6%     -  158s
     0     0 41465.1734    0  404 22221.8058 41465.1734  86.6%     -  158s
     0     0 41447.5272    0  413 22221.8058 41447.5272  86.5%     -  160s
     0     0 41443.2649    0  408 22221.8058 41443.2649  86.5%     -  161s
     0     0 41440.1240    0  404 22221.8058 41440.1240  86.5%     -  161s
     0     0 41438.1717    0  406 22221.8058 41438.1717  86.5%     -  162s
     0     0 41436.0931    0  405 22221.8058 41436.0931  86.5%     -  162s
     0     0 41435.0723    0  403 22221.8058 41435.0723  86.5%     -  162s
     0     0 41216.6427    0  351 22221.8058 41216.6427  85.5%     -  168s
H    0     0                    22364.242933 41216.5305  84.3%     -  168s
H    0     0                    22402.951708 41216.5305  84.0%     -  169s
H    0     0                    22404.395389 41216.5305  84.0%     -  169s
H    0     0                    22577.974084 41216.5305  82.6%     -  169s
H    0     0                    22668.260066 41216.5305  81.8%     -  169s
     0     0 41153.0085    0  453 22668.2601 41153.0085  81.5%     -  172s
     0     0 41130.1782    0  452 22668.2601 41130.1782  81.4%     -  173s
     0     0 41125.1758    0  459 22668.2601 41125.1758  81.4%     -  174s
     0     0 41122.4821    0  465 22668.2601 41122.4821  81.4%     -  175s
     0     0 41121.8886    0  465 22668.2601 41121.8886  81.4%     -  175s
H    0     0                    24987.553956 41025.7128  64.2%     -  179s
     0     0 41025.7128    0  418 24987.5540 41025.7128  64.2%     -  179s
     0     0 40980.9069    0  426 24987.5540 40980.9069  64.0%     -  184s
     0     0 40971.2273    0  434 24987.5540 40971.2273  64.0%     -  186s
     0     0 40958.9803    0  429 24987.5540 40958.9803  63.9%     -  187s
     0     0 40949.7364    0  435 24987.5540 40949.7364  63.9%     -  189s
     0     0 40944.6700    0  432 24987.5540 40944.6700  63.9%     -  190s
     0     0 40944.2367    0  435 24987.5540 40944.2367  63.9%     -  190s
     0     0 40873.0834    0  426 24987.5540 40873.0834  63.6%     -  194s
     0     0 40851.1332    0  431 24987.5540 40851.1332  63.5%     -  196s
     0     0 40838.0938    0  430 24987.5540 40838.0938  63.4%     -  198s
     0     0 40835.9135    0  436 24987.5540 40835.9135  63.4%     -  198s
     0     0 40833.9673    0  433 24987.5540 40833.9673  63.4%     -  199s
     0     0 40832.9866    0  430 24987.5540 40832.9866  63.4%     -  199s
     0     0 40813.5065    0  440 24987.5540 40813.5065  63.3%     -  202s
H    0     0                    25177.071111 40812.7351  62.1%     -  203s
     0     0 40807.5080    0  444 25177.0711 40807.5080  62.1%     -  204s
     0     0 40804.9550    0  445 25177.0711 40804.9550  62.1%     -  205s
     0     0 40804.0472    0  447 25177.0711 40804.0472  62.1%     -  205s
     0     0 40793.6670    0  431 25177.0711 40793.6670  62.0%     -  207s
     0     0 40790.7209    0  433 25177.0711 40790.7209  62.0%     -  208s
     0     0 40789.5962    0  430 25177.0711 40789.5962  62.0%     -  209s
     0     0 40782.9158    0  434 25177.0711 40782.9158  62.0%     -  210s
H    0     0                    25236.388080 40782.2728  61.6%     -  211s
     0     0 40781.3118    0  454 25236.3881 40781.3118  61.6%     -  213s
     0     0 40780.3721    0  458 25236.3881 40780.3721  61.6%     -  213s
     0     0 40771.2557    0  450 25236.3881 40771.2557  61.6%     -  215s
     0     0 40762.5905    0  455 25236.3881 40762.5905  61.5%     -  217s
H    0     0                    25495.494385 40761.6481  59.9%     -  217s
     0     0 40761.6481    0  456 25495.4944 40761.6481  59.9%     -  217s
H    0     0                    26011.164850 40761.6481  56.7%     -  218s
H    0     0                    26056.469202 40745.6862  56.4%     -  220s
H    0     0                    26077.280188 40745.6862  56.2%     -  220s
     0     0 40745.6862    0  459 26077.2802 40745.6862  56.2%     -  220s
     0     0 40719.7112    0  494 26077.2802 40719.7112  56.2%     -  224s
     0     0 40707.6778    0  460 26077.2802 40707.6778  56.1%     -  225s
     0     0 40693.5517    0  445 26077.2802 40693.5517  56.0%     -  226s
     0     0 40691.4803    0  448 26077.2802 40691.4803  56.0%     -  227s
     0     0 40690.2036    0  454 26077.2802 40690.2036  56.0%     -  227s
     0     0 40675.2807    0  455 26077.2802 40675.2807  56.0%     -  229s
     0     0 40674.3832    0  435 26077.2802 40674.3832  56.0%     -  230s
     0     0 40653.3460    0  451 26077.2802 40653.3460  55.9%     -  233s
H    0     0                    26729.823305 40652.7256  52.1%     -  234s
H    0     0                    26753.891593 40652.7256  52.0%     -  234s
H    0     0                    26786.610899 40652.7256  51.8%     -  234s
     0     0 40649.2876    0  457 26786.6109 40649.2876  51.8%     -  235s
     0     0 40646.3781    0  455 26786.6109 40646.3781  51.7%     -  236s
     0     0 40646.0333    0  455 26786.6109 40646.0333  51.7%     -  237s
     0     0 40644.2877    0  459 26786.6109 40644.2877  51.7%     -  238s
H    0     0                    26788.672220 40644.2059  51.7%     -  238s
     0     0 40643.3305    0  459 26788.6722 40643.3305  51.7%     -  239s
     0     0 40642.6886    0  458 26788.6722 40642.6886  51.7%     -  240s
H    0     0                    26845.672380 40642.4339  51.4%     -  243s
     0     0 40642.3013    0  456 26845.6724 40642.3013  51.4%     -  244s
     0     0 40641.3768    0  457 26845.6724 40641.3768  51.4%     -  245s
     0     0 40641.1346    0  457 26845.6724 40641.1346  51.4%     -  245s
H    0     0                    26847.356125 40641.1346  51.4%     -  280s
H    0     0                    26895.489320 40641.1346  51.1%     -  284s
H    0     0                    26940.998952 40641.1346  50.9%     -  286s
     0     2 40641.1346    0  457 26940.9990 40641.1346  50.9%     -  287s
     1     4 40441.6550    1  425 26940.9990 40641.0930  50.9%  4582  292s
     3     8 40334.9515    2  425 26940.9990 40433.4254  50.1%  4770  307s
     7    16 40252.4128    3  441 26940.9990 40334.8006  49.7%  8017  312s
    15    30 39832.7148    4  425 26940.9990 40251.9411  49.4%  6569  332s
    29    44 38131.6748    5  446 26940.9990 40167.9737  49.1% 11184  351s
    43    75 36865.9778    5  408 26940.9990 39832.6387  47.9%  9986  372s
H   44    75                    27016.822773 39832.6387  47.4%  9759  372s
H   45    75                    27121.453507 39832.6387  46.9%  9667  372s
H   51    75                    27179.028741 39832.6387  46.6%  9259  372s
    74   178 36436.4360    6  434 27179.0287 39832.6387  46.6%  8295  390s
   177   277 36395.4694    8  427 27179.0287 39832.6387  46.6%  4918  403s
   276   341 36304.9101   13  381 27179.0287 39832.6387  46.6%  4269  412s
   342   380 34897.8211   15  312 27179.0287 39832.6387  46.6%  4216  420s
   383   446 34839.2183   16  318 27179.0287 39832.6387  46.6%  4116  428s
   457   529 34355.4460   19  296 27179.0287 39832.6387  46.6%  3820  434s
   550   605 33865.9290   22  286 27179.0287 39537.6035  45.5%  3504  443s
   640   680 33770.2717   24  349 27179.0287 39537.6035  45.5%  3280  451s
   724   773 33483.2721   26  351 27179.0287 39537.6035  45.5%  3127  458s
   819   872 32293.3367   28  234 27179.0287 39537.6035  45.5%  2966  466s
   922   983 32046.7460   29  303 27179.0287 39537.6035  45.5%  2794  474s
  1040  1028 29442.6681   34  105 27179.0287 39011.8616  43.5%  2617  482s
H 1057  1028                    27183.849608 39011.8616  43.5%  2599  482s
  1087  1128 29151.2458   39   88 27183.8496 39011.8616  43.5%  2579  490s
  1210  1219 36670.2468   13  367 27183.8496 39011.8616  43.5%  2440  498s
  1319  1319 35893.9737   14  314 27183.8496 39011.8616  43.5%  2333  507s
  1455  1412 35724.9936   15  365 27183.8496 39011.8616  43.5%  2234  515s
  1594  1502 35316.3472   17  372 27183.8496 38901.7642  43.1%  2147  524s
  1714  1531 35085.3035   19  278 27183.8496 38901.7642  43.1%  2111  531s
  1749  1572 34919.7649   20  269 27183.8496 38873.9164  43.0%  2126  540s
  1796  1615 34522.0291   21  274 27183.8496 38873.9164  43.0%  2129  547s
  1841  1649 34193.6011   22  273 27183.8496 38873.9164  43.0%  2122  552s
  1885  1694 33800.9171   23  305 27183.8496 38873.9164  43.0%  2112  561s
  1938  1742 33577.7254   24  306 27183.8496 38873.9164  43.0%  2099  568s
  2012  1846 33508.0930   25  304 27183.8496 38873.9164  43.0%  2072  575s
H 2055  1846                    27201.776824 38873.9164  42.9%  2054  575s
  2122  1986 33172.4069   26  302 27201.7768 38873.9164  42.9%  2026  584s
  2306  2132 32093.6469   30  304 27201.7768 38873.9164  42.9%  1966  595s
  2503  2301 31162.6856   37  233 27201.7768 38703.3549  42.3%  1909  604s
  2722  2450 29920.7057   47  253 27201.7768 38703.3549  42.3%  1848  614s
  2962  2576 28122.0449   59  196 27201.7768 38703.3549  42.3%  1791  625s
  3152  2696 37600.5010   10  330 27201.7768 38703.3549  42.3%  1774  637s
  3319  2861 34059.0983   12  304 27201.7768 38703.3549  42.3%  1766  650s
  3523  2862 35454.4089   37  457 27201.7768 38703.3549  42.3%  1739  751s
  3525  2863 30291.0859   34   73 27201.7768 38703.3549  42.3%  1738  783s
  3526  2864 30243.1255   49  329 27201.7768 38703.3549  42.3%  1737  805s
  3527  2865 34151.2324   36  370 27201.7768 38703.3549  42.3%  1737  826s
  3528  2865 30433.5512   64  345 27201.7768 38703.3549  42.3%  1736  838s
  3529  2866 34891.1444   15  342 27201.7768 38703.3549  42.3%  1736  844s
  3530  2867 30161.3030   44  421 27201.7768 38703.3549  42.3%  1735  853s
  3531  2867 34349.7276   12  455 27201.7768 38703.3549  42.3%  1735  859s
  3532  2868 35201.5927   15  439 27201.7768 38703.3549  42.3%  1734  864s
  3533  2869 31074.8562   45  446 27201.7768 38703.3549  42.3%  1734  867s
  3535  2870 31260.0356   35  372 27201.7768 38703.3549  42.3%  1733  874s
  3536  2871 36300.7466   12  442 27201.7768 38703.3549  42.3%  1733  876s
  3538  2872 29288.5074   40  450 27201.7768 38703.3549  42.3%  1732  881s
  3540  2873 30120.4186   60  429 27201.7768 38703.3549  42.3%  1731  888s
  3541  2874 31580.4904   73  427 27201.7768 38703.3549  42.3%  1730  890s
  3543  2875 37233.2363    9  436 27201.7768 38703.3549  42.3%  1729  897s
  3545  2877 35364.2920   16  421 27201.7768 38703.3549  42.3%  1728  901s
  3546  2877 37803.8692   10  468 27201.7768 38703.3549  42.3%  1728  906s
  3548  2879 31753.1133   45  428 27201.7768 38703.3549  42.3%  1727  912s
  3550  2880 33582.2722   26  505 27201.7768 38703.3549  42.3%  1726  920s
H 3550  2735                    27217.363410 38703.3549  42.2%  1726  921s
  3552  2736 33252.1432   15  505 27217.3634 38703.3549  42.2%  1725  929s
  3553  2737 36798.2896   14  503 27217.3634 38703.3549  42.2%  1724  931s
  3555  2738 30791.9978   37  461 27217.3634 38703.3549  42.2%  1723  939s
  3556  2739 29477.9613   38  487 27217.3634 38703.3549  42.2%  1723  941s
  3557  2740 34421.1784   17  476 27217.3634 38703.3549  42.2%  1722  947s
  3558  2740 28080.3866   58  441 27217.3634 38703.3549  42.2%  1722  950s
  3560  2742 31296.6635   35  437 27217.3634 38703.3549  42.2%  1721  987s
  3561  2742 35440.3384   12  437 27217.3634 38703.3549  42.2%  1720 1022s
  3562  2746 38703.3549   15  433 27217.3634 38703.3549  42.2%  1781 1069s
  3564  2749 38703.3549   16  440 27217.3634 38703.3549  42.2%  1785 1086s
  3568  2756 38703.3549   17  434 27217.3634 38703.3549  42.2%  1792 1104s
  3576  2769 38703.3549   18  433 27217.3634 38703.3549  42.2%  1809 1130s
  3592  2780 36011.4127   19  312 27217.3634 38703.3549  42.2%  1873 1176s
  3608  2807 37381.4746   20  356 27217.3634 38703.3549  42.2%  1910 1193s
  3640  2856 36500.1444   21  313 27217.3634 38703.3549  42.2%  1955 1215s
  3700  2926 36094.9850   22  358 27217.3634 38703.3549  42.2%  2033 1232s
  3790  2992 35577.7352   22  290 27217.3634 38703.3549  42.2%  2107 1244s
  3889  2985 35797.6083   23  306 27217.3634 38703.3549  42.2%  2146 1257s
  3925  3007 35311.4332   23  277 27217.3634 38703.3549  42.2%  2161 1267s
  3965  3035 33852.5815   23  306 27217.3634 38703.3549  42.2%  2194 1279s
  4025  3053 35653.3059   24  364 27217.3634 38703.3549  42.2%  2226 1292s
  4099  3084 30456.8364   34  305 27217.3634 38703.3549  42.2%  2245 1302s
  4179  3092 35271.2997   24  243 27217.3634 38703.3549  42.2%  2259 1314s
  4261  3113 33838.8702   25  236 27217.3634 38703.3549  42.2%  2265 1323s
  4340  3130 33522.6817   26  246 27217.3634 38703.3549  42.2%  2276 1334s
  4421  3165 32931.9725   27  198 27217.3634 38703.3549  42.2%  2292 1343s
  4521  3185 32733.8907   28  198 27217.3634 38703.3549  42.2%  2288 1354s
  4628  3194 31950.5575   32  163 27217.3634 38703.3549  42.2%  2280 1368s
  4744  3188     cutoff   35      27217.3634 38703.3549  42.2%  2274 1378s
  4853  3188     cutoff   37      27217.3634 38703.3549  42.2%  2282 1389s
  4957  3208 33306.0836   26  233 27217.3634 38703.3549  42.2%  2287 1407s
  5053  3213 33093.7909   27  223 27217.3634 38703.3549  42.2%  2313 1422s
  5159  3232 32589.8555   29  221 27217.3634 38703.3549  42.2%  2335 1436s
  5259  3257 31271.4010   33  243 27217.3634 38703.3549  42.2%  2368 1450s
  5363  3268 30498.5131   35  239 27217.3634 38703.3549  42.2%  2402 1463s
  5466  3290 30363.1353   36  246 27217.3634 38703.3549  42.2%  2422 1475s
  5577  3313 29965.1049   38  169 27217.3634 38703.3549  42.2%  2422 1491s
  5694  3316 27900.6136   43   82 27217.3634 38703.3549  42.2%  2435 1509s
  5819  3336 27255.0935   50   63 27217.3634 38592.6815  41.8%  2463 1524s
  5954  3372 29636.8889   36  233 27217.3634 38416.3294  41.1%  2488 1538s
  6117  3375 28143.2868   40   88 27217.3634 38416.3294  41.1%  2493 1556s
  6260  3394 27367.3816   55   57 27217.3634 38416.3294  41.1%  2526 1573s
  6385  3385 30992.1367   24  287 27217.3634 38416.3294  41.1%  2562 1594s
  6441  3414 33004.6709   25  349 27217.3634 38416.3294  41.1%  2586 1609s
  6526  3451 32295.9382   26  277 27217.3634 38416.3294  41.1%  2609 1626s
  6659  3473 31748.5178   29  164 27217.3634 37590.5440  38.1%  2620 1644s
H 6744  3306                    27222.281389 37590.5440  38.1%  2629 1644s
  6821  3345 28481.0946   33   86 27222.2814 37590.5440  38.1%  2647 1664s
H 6904  3186                    27222.637310 37590.5440  38.1%  2666 1664s
  6987  3228     cutoff   40      27222.6373 37590.5440  38.1%  2689 1683s
  7173  3282 27722.7321   52   62 27222.6373 36670.6670  34.7%  2712 1705s
  7363  3351 28017.0100   25  291 27222.6373 36670.6670  34.7%  2751 1726s
  7611  3340 27348.3193   27  302 27222.6373 36128.3878  32.7%  2774 1745s
H 7653  3077                    27858.052661 36122.5529  29.7%  2784 1745s
  7726  3156     cutoff   28      27858.0527 36122.5529  29.7%  2790 1768s
  7996  3148 33841.2659   22  304 27858.0527 36026.2133  29.3%  2814 1789s
  8232  3149 33204.5719   26  153 27858.0527 35770.9224  28.4%  2851 1811s
  8458  3120 31799.9811   28  185 27858.0527 35577.0077  27.7%  2904 1832s
H 8467  2990                    27898.145105 35541.1449  27.4%  2907 1832s
H 8496  2859                    27920.654292 35441.7960  26.9%  2911 1832s
H 8508  2712                    28018.275990 35441.7960  26.5%  2914 1832s
  8585  2809 30872.8371   32   94 28018.2760 35441.7960  26.5%  2915 1855s
  8852  2785 29580.4132   50  175 28018.2760 35418.1752  26.4%  2941 1881s
  9030  2816 29222.7267   55  144 28018.2760 35303.8591  26.0%  2984 1908s
  9262  2894 28864.7241   28  326 28018.2760 35303.8591  26.0%  3008 1936s
  9562  2966     cutoff   38      28018.2760 34980.9352  24.9%  3053 1962s
H 9681  2926                    28081.634575 34980.1268  24.6%  3065 1962s
  9897  3082 30934.8605   28  296 28081.6346 34980.1268  24.6%  3080 1989s
 10333  3271 28980.7848   34  240 28081.6346 34959.2869  24.5%  3085 2016s
 10808  3448 31474.3246   28  233 28081.6346 34959.2869  24.5%  3081 2041s
 11154  3667 29039.3895   32  191 28081.6346 34694.5846  23.5%  3105 2070s
 11659  3916 32274.5746   25  243 28081.6346 34605.6620  23.2%  3090 2109s
 12138  4121 28603.9393   36  165 28081.6346 34604.0549  23.2%  3101 2141s
 12577  4283 29217.4551   27  370 28081.6346 34574.9706  23.1%  3135 2175s
H12967  4366                    28121.727020 34480.6637  22.6%  3185 2210s
 13270  4533 28622.1582   28  186 28121.7270 34312.3007  22.0%  3225 2246s
 13789  4657 30127.1494   30  189 28121.7270 34019.7396  21.0%  3246 2285s
 14321  4887 31066.7359   26  368 28121.7270 33915.2525  20.6%  3262 2322s
 14818  5093 31491.0266   32  169 28121.7270 33770.5167  20.1%  3291 2361s
 15389  5206 31239.2040   25  292 28121.7270 33695.4956  19.8%  3315 2403s
 15868  5310 29372.5607   29  234 28121.7270 33615.3460  19.5%  3359 2444s
 16471  5533 29802.7036   34   94 28121.7270 33506.7373  19.1%  3382 2496s
 17140  5683     cutoff   30      28121.7270 33308.9598  18.4%  3394 2542s
 17750  5863 29101.2382   25  295 28121.7270 33217.2905  18.1%  3419 2589s
 18413  6047 31586.5778   25  351 28121.7270 33111.2123  17.7%  3439 2638s
 19023  6269 29948.9432   33  101 28121.7270 33021.8110  17.4%  3455 2687s
 19813  6354 28840.9350   46   86 28121.7270 32825.9031  16.7%  3464 2734s
 20005  6651 29220.8449   29  232 28121.7270 32825.9031  16.7%  3457 2784s
 20755  6985 28855.3275   36  100 28121.7270 32760.5790  16.5%  3459 2838s
 21918  7285     cutoff   36      28121.7270 32679.5339  16.2%  3430 2893s
 22959  7745 31227.7443   27  359 28121.7270 32447.3462  15.4%  3413 2951s
 24077  8045 30307.4554   28   85 28121.7270 32324.6870  14.9%  3392 3008s
 25113  8305 30255.5585   28  357 28121.7270 32206.9348  14.5%  3391 3070s
 26251  8591 30646.7141   26  194 28121.7270 32077.7484  14.1%  3384 3133s
 27329  8830 28844.8213   27  137 28121.7270 31952.2106  13.6%  3384 3198s
 28437  8843 29085.5190   28  167 28121.7270 31849.1361  13.3%  3387 3250s
 28528  9052 28876.0863   29  162 28121.7270 31849.1361  13.3%  3392 3312s
 29326  9514 infeasible   25      28121.7270 31717.6241  12.8%  3386 3397s
 30979  9770 28625.7309   29  203 28121.7270 31587.8404  12.3%  3359 3457s
 32298  9953 29397.3994   31  193 28121.7270 31485.7608  12.0%  3331 3517s
 33543 10216 28581.1686   31  193 28121.7270 31323.1656  11.4%  3307 3573s
 34822 10439 28555.6763   24  273 28121.7270 31229.6147  11.1%  3284 3600s

Cutting planes:
  Learned: 2
  MIR: 676
  Mixing: 1
  Flow cover: 1842
  RLT: 28
  Relax-and-lift: 125

Explored 35635 nodes (116510773 simplex iterations) in 3600.04 seconds (11746.48 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 28121.7 28081.6 28018.3 ... 27183.8

Time limit reached
Best objective 2.812172701989e+04, best bound 3.118242028028e+04, gap 10.8837%
  WARNING: Time limit reached. Using best solution found (gap: 10.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 28121.73, θ = 176740.24
  Upper Bound (UB) = 28121.73

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176740.24
  [DEBUG]   ✓ Scenario 0: θ = 176740.24 ≤ Q = 176740.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176740.24 ≤ Q = 176740.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176740.24 ≤ Q = 176740.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176740.24 ≤ Q = 176740.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176740.24 ≤ Q = 176740.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176740.24 ≤ Q = 176740.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176740.24 ≤ Q = 176740.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176740.24 ≤ Q = 176740.24 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xe12dcf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xff1ed231
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.397795e+13
Presolve removed 2607 rows and 1899 columns
Presolve time: 0.00s
Presolved: 486 rows, 490 columns, 1373 nonzeros
Found heuristic solution: objective 6583205.4399
Variable types: 332 continuous, 158 integer (158 binary)

Root relaxation: objective -1.666994e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166699.41    0  130 6583205.44 -166699.41   103%     -    0s
H    0     0                    -132278.1038 -166699.41  26.0%     -    0s
     0     0 -145758.28    0   78 -132278.10 -145758.28  10.2%     -    0s
H    0     0                    -142164.2469 -145751.16  2.52%     -    0s
H    0     0                    -142437.9042 -145751.16  2.33%     -    0s
H    0     0                    -144450.1462 -145751.16  0.90%     -    0s
H    0     0                    -144723.8035 -145751.16  0.71%     -    0s
     0     0 -145680.78    0   68 -144723.80 -145680.78  0.66%     -    0s
     0     0 -145674.70    0   78 -144723.80 -145674.70  0.66%     -    0s
     0     0 -145190.64    0   29 -144723.80 -145190.64  0.32%     -    0s
     0     0 -145142.05    0   20 -144723.80 -145142.05  0.29%     -    0s
     0     0 -145093.61    0   41 -144723.80 -145093.61  0.26%     -    0s
     0     0 -145093.45    0   24 -144723.80 -145093.45  0.26%     -    0s
     0     0 -144911.03    0   29 -144723.80 -144911.03  0.13%     -    0s
     0     0 -144895.76    0   28 -144723.80 -144895.76  0.12%     -    0s
H    0     0                    -144732.6057 -144886.93  0.11%     -    0s
     0     0 -144870.97    0   14 -144732.61 -144870.97  0.10%     -    0s
     0     0 -144855.45    0   17 -144732.61 -144855.45  0.08%     -    0s
     0     0 -144778.71    0    9 -144732.61 -144778.71  0.03%     -    0s
     0     0 -144778.71    0    9 -144732.61 -144778.71  0.03%     -    0s
H    0     0                    -144740.8271 -144778.71  0.03%     -    0s
     0     0          -    0      -144740.83 -144754.92  0.01%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 2
  Flow cover: 3
  RLT: 1

Explored 1 nodes (660 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -144741 -144733 -144724 ... 1.39779e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.447408270717e+05, best bound -1.447549220099e+05, gap 0.0097%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 165005.03
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144740.83
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -144740.83 = 165005.03
  [DEBUG]   Current θ from Master = 176740.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11735.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16386.52
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 3893.8130, Absolute Gap = 3893.8130, Relative Gap = 0.138463
  Not converged yet (gap = 3893.81 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394571 nonzeros
Model fingerprint: 0x6a52cbf4
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 64699 rows and 26279 columns
Presolve time: 1.21s
Presolved: 74294 rows, 32141 columns, 462914 nonzeros
Variable types: 29882 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329277.6881
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 74294 rows, 32141 columns, 462914 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34220   -9.1421952e+04   0.000000e+00   1.489674e+08      5s
   47050   -1.0064420e+04   0.000000e+00   1.569022e+07     10s
   59117    1.1581634e+04   0.000000e+00   4.772562e+07     15s
   69076    2.2991394e+04   0.000000e+00   5.913580e+06     20s
   77865    3.0559436e+04   0.000000e+00   1.158994e+08     25s
Concurrent spin time: 2.41s

Solved with dual simplex

Root relaxation: objective 5.395533e+04, 50672 iterations, 26.90 seconds (53.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53955.3345    0   73 -187498.33 53955.3345   129%     -   28s
H    0     0                    -178214.9171 53955.3345   130%     -   28s
H    0     0                    -157268.3710 53955.3345   134%     -   28s
H    0     0                    -156617.6029 53955.3345   134%     -   28s
H    0     0                    -136936.8735 53955.3345   139%     -   29s
H    0     0                    -132020.2620 53955.3345   141%     -   29s
H    0     0                    -128565.1121 53955.3345   142%     -   29s
H    0     0                    -128191.6204 53955.3345   142%     -   29s
H    0     0                    -128151.1368 53955.3345   142%     -   29s
H    0     0                    -40359.50500 53955.3345   234%     -   29s
H    0     0                    2830.0429668 53955.3345  1807%     -   29s
H    0     0                    8017.8552846 53955.3345   573%     -   29s
H    0     0                    8856.7722783 53955.3345   509%     -   30s
H    0     0                    11779.557661 53955.3345   358%     -   30s
H    0     0                    12180.012205 53955.3345   343%     -   30s
H    0     0                    14015.484313 53955.3345   285%     -   30s
     0     0 48907.8889    0  185 14015.4843 48907.8889   249%     -   40s
H    0     0                    14044.629620 48907.5218   248%     -   40s
H    0     0                    14428.664012 48907.5218   239%     -   40s
     0     0 48504.7515    0  194 14428.6640 48504.7515   236%     -   44s
     0     0 48379.5922    0  195 14428.6640 48379.5922   235%     -   47s
     0     0 48350.8952    0  192 14428.6640 48350.8952   235%     -   49s
     0     0 48347.4913    0  194 14428.6640 48347.4913   235%     -   49s
     0     0 48347.2900    0  196 14428.6640 48347.2900   235%     -   50s
     0     0 45612.7406    0  291 14428.6640 45612.7406   216%     -   63s
H    0     0                    14978.022904 45612.7406   205%     -   63s
     0     0 45612.3319    0  288 14978.0229 45612.3319   205%     -   67s
     0     0 45612.3319    0  298 14978.0229 45612.3319   205%     -   70s
     0     0 45575.4525    0  302 14978.0229 45575.4525   204%     -   71s
     0     0 45557.8355    0  307 14978.0229 45557.8355   204%     -   72s
     0     0 45486.8961    0  295 14978.0229 45486.8961   204%     -   74s
     0     0 45470.7261    0  306 14978.0229 45470.7261   204%     -   75s
     0     0 45459.5242    0  302 14978.0229 45459.5242   204%     -   76s
     0     0 45242.5345    0  309 14978.0229 45242.5345   202%     -   79s
     0     0 45242.2127    0  316 14978.0229 45242.2127   202%     -   79s
H    0     0                    15888.876982 43219.0635   172%     -   95s
H    0     0                    15893.385581 43219.0635   172%     -   95s
H    0     0                    19056.309722 43219.0635   127%     -   95s
     0     0 43219.0635    0  304 19056.3097 43219.0635   127%     -   95s
H    0     0                    19217.933880 43218.9696   125%     -   96s
     0     0 42828.3491    0  311 19217.9339 42828.3491   123%     -  102s
H    0     0                    19605.668613 42613.8342   117%     -  107s
     0     0 42613.8342    0  314 19605.6686 42613.8342   117%     -  107s
H    0     0                    20711.732453 42427.5857   105%     -  111s
H    0     0                    20724.015638 42427.5857   105%     -  111s
H    0     0                    20843.380728 42427.5857   104%     -  111s
H    0     0                    21032.922066 42427.5857   102%     -  111s
     0     0 42427.5857    0  397 21032.9221 42427.5857   102%     -  111s
H    0     0                    21307.287212 42342.5688  98.7%     -  114s
H    0     0                    21308.711182 42342.5688  98.7%     -  114s
H    0     0                    21402.723708 42342.5688  97.8%     -  114s
H    0     0                    21405.036512 42342.5688  97.8%     -  114s
H    0     0                    21530.419157 42342.5688  96.7%     -  114s
     0     0 42342.5688    0  326 21530.4192 42342.5688  96.7%     -  114s
     0     0 42308.5309    0  378 21530.4192 42308.5309  96.5%     -  116s
     0     0 42274.8423    0  342 21530.4192 42274.8423  96.3%     -  118s
     0     0 42263.3857    0  372 21530.4192 42263.3857  96.3%     -  119s
     0     0 42261.4753    0  377 21530.4192 42261.4753  96.3%     -  120s
     0     0 42256.7855    0  346 21530.4192 42256.7855  96.3%     -  120s
     0     0 42201.5908    0  371 21530.4192 42201.5908  96.0%     -  123s
     0     0 42199.2796    0  337 21530.4192 42199.2796  96.0%     -  123s
     0     0 42197.6300    0  335 21530.4192 42197.6300  96.0%     -  124s
     0     0 42197.5411    0  337 21530.4192 42197.5411  96.0%     -  124s
     0     0 41660.1029    0  399 21530.4192 41660.1029  93.5%     -  136s
H    0     0                    21708.251057 41659.3863  91.9%     -  137s
H    0     0                    21999.969391 41659.3863  89.4%     -  137s
H    0     0                    22261.796339 41659.3863  87.1%     -  137s
H    0     0                    22287.508595 41659.3863  86.9%     -  137s
H    0     0                    22373.351627 41659.3863  86.2%     -  137s
H    0     0                    22420.410693 41659.3863  85.8%     -  137s
H    0     0                    22454.845179 41659.3863  85.5%     -  137s
H    0     0                    22530.536245 41659.3863  84.9%     -  137s
     0     0 41477.3790    0  410 22530.5362 41477.3790  84.1%     -  143s
     0     0 41413.8725    0  451 22530.5362 41413.8725  83.8%     -  147s
     0     0 41398.1407    0  454 22530.5362 41398.1407  83.7%     -  149s
     0     0 41385.5164    0  456 22530.5362 41385.5164  83.7%     -  151s
     0     0 41378.9690    0  455 22530.5362 41378.9690  83.7%     -  153s
     0     0 41365.7307    0  450 22530.5362 41365.7307  83.6%     -  154s
     0     0 41352.4824    0  448 22530.5362 41352.4824  83.5%     -  155s
     0     0 41351.1585    0  443 22530.5362 41351.1585  83.5%     -  155s
     0     0 41243.1378    0  365 22530.5362 41243.1378  83.1%     -  161s
     0     0 41213.7742    0  420 22530.5362 41213.7742  82.9%     -  164s
H    0     0                    22542.414629 41107.2949  82.4%     -  170s
     0     0 41107.2949    0  372 22542.4146 41107.2949  82.4%     -  170s
     0     0 41080.0298    0  421 22542.4146 41080.0298  82.2%     -  173s
     0     0 41071.2986    0  377 22542.4146 41071.2986  82.2%     -  174s
     0     0 41069.7422    0  419 22542.4146 41069.7422  82.2%     -  175s
     0     0 41068.4955    0  425 22542.4146 41068.4955  82.2%     -  175s
H    0     0                    23645.863177 40992.8491  73.4%     -  180s
     0     0 40992.8491    0  367 23645.8632 40992.8491  73.4%     -  180s
H    0     0                    24263.165766 40992.1361  68.9%     -  182s
     0     0 40960.8680    0  428 24263.1658 40960.8680  68.8%     -  185s
     0     0 40950.3763    0  440 24263.1658 40950.3763  68.8%     -  186s
     0     0 40942.8214    0  445 24263.1658 40942.8214  68.7%     -  187s
     0     0 40930.7406    0  443 24263.1658 40930.7406  68.7%     -  189s
     0     0 40922.7092    0  439 24263.1658 40922.7092  68.7%     -  190s
     0     0 40906.8632    0  425 24263.1658 40906.8632  68.6%     -  192s
     0     0 40894.3280    0  417 24263.1658 40894.3280  68.5%     -  194s
     0     0 40891.0948    0  434 24263.1658 40891.0948  68.5%     -  195s
     0     0 40890.1501    0  423 24263.1658 40890.1501  68.5%     -  195s
     0     0 40839.4163    0  368 24263.1658 40839.4163  68.3%     -  199s
H    0     0                    24597.770467 40839.0104  66.0%     -  199s
     0     0 40831.4493    0  374 24597.7705 40831.4493  66.0%     -  201s
     0     0 40825.5724    0  384 24597.7705 40825.5724  66.0%     -  202s
     0     0 40813.4833    0  434 24597.7705 40813.4833  65.9%     -  203s
     0     0 40812.2770    0  371 24597.7705 40812.2770  65.9%     -  204s
     0     0 40804.8991    0  492 24597.7705 40804.8991  65.9%     -  206s
H    0     0                    25784.781531 40804.6659  58.3%     -  207s
H    0     0                    26036.029522 40804.6659  56.7%     -  207s
     0     0 40800.5884    0  489 26036.0295 40800.5884  56.7%     -  209s
     0     0 40798.3986    0  454 26036.0295 40798.3986  56.7%     -  210s
     0     0 40795.2338    0  451 26036.0295 40795.2338  56.7%     -  210s
     0     0 40794.4005    0  497 26036.0295 40794.4005  56.7%     -  211s
     0     0 40769.0907    0  429 26036.0295 40769.0907  56.6%     -  214s
     0     0 40765.4151    0  450 26036.0295 40765.4151  56.6%     -  215s
     0     0 40764.2026    0  449 26036.0295 40764.2026  56.6%     -  216s
     0     0 40746.2211    0  436 26036.0295 40746.2211  56.5%     -  219s
     0     0 40744.3216    0  441 26036.0295 40744.3216  56.5%     -  221s
     0     0 40742.9567    0  434 26036.0295 40742.9567  56.5%     -  222s
     0     0 40742.6505    0  435 26036.0295 40742.6505  56.5%     -  223s
     0     0 40742.1981    0  440 26036.0295 40742.1981  56.5%     -  224s
H    0     0                    26083.146759 40742.0419  56.2%     -  230s
     0     0 40742.0049    0  442 26083.1468 40742.0049  56.2%     -  232s
     0     0 40741.9495    0  439 26083.1468 40741.9495  56.2%     -  232s
     0     0 40741.9167    0  439 26083.1468 40741.9167  56.2%     -  234s
     0     2 40741.8095    0  439 26083.1468 40741.8095  56.2%     -  279s
     1     4 40715.4182    1  426 26083.1468 40739.4767  56.2%  3563  282s
     3     8 40663.0120    2  496 26083.1468 40715.0569  56.1%  3789  290s
     7    15 40257.1958    3  472 26083.1468 40662.9936  55.9%  5999  306s
    14    29 40098.6457    4  469 26083.1468 40257.1231  54.3%  8673  319s
    28    45 38447.0106    5  325 26083.1468 40257.1231  54.3% 11531  350s
    44    76 36807.0460    6  366 26083.1468 40098.5859  53.7% 12662  369s
    75   139 37087.4756    6  292 26083.1468 40098.5859  53.7% 10906  388s
H   76   139                    26098.732310 40098.5859  53.6% 10762  388s
   138   283 37056.7079    7  284 26098.7323 40098.5859  53.6%  7897  403s
   282   372 36245.7298   12  315 26098.7323 40098.5859  53.6%  5223  412s
   371   431 36020.9592   15  316 26098.7323 40098.5859  53.6%  4682  421s
   430   505 35494.5405   17  232 26098.7323 40098.5859  53.6%  4614  430s
   516   532 35314.7818   20  319 26098.7323 40098.5859  53.6%  4215  440s
   549   565 35293.8406   21  323 26098.7323 40098.5859  53.6%  4090  451s
   584   595 35223.9680   22  313 26098.7323 40098.5859  53.6%  4027  461s
H  591   595                    26133.781460 40098.5859  53.4%  4010  461s
   616   692 35017.9256   23  327 26133.7815 40098.5859  53.4%  3966  469s
   715   721 34899.3352   27  277 26133.7815 40098.5859  53.4%  3628  475s
   750   753 34886.0559   28  269 26133.7815 40098.5859  53.4%  3549  482s
   784   787 34314.3878   29  328 26133.7815 40098.5859  53.4%  3509  489s
   820   822 32550.3355   30  257 26133.7815 40098.5859  53.4%  3491  496s
   855   862 32525.0112   31  270 26133.7815 40098.5859  53.4%  3479  501s
   895   907 32392.1940   32  253 26133.7815 40098.5859  53.4%  3414  509s
   940   957 31923.4884   33  295 26133.7815 40098.5859  53.4%  3339  517s
   998  1008 31174.4185   34  271 26133.7815 40098.5859  53.4%  3258  527s
  1065  1090 30040.0141   35  240 26133.7815 40098.5859  53.4%  3189  537s
  1161  1164 29723.6120   36  237 26133.7815 40098.5859  53.4%  3050  548s
  1278  1269 29426.6563   38  245 26133.7815 40098.5859  53.4%  2904  557s
  1409  1349 28470.7745   43  153 26133.7815 40098.5859  53.4%  2748  568s
  1544  1415 27029.2731   49  215 26133.7815 40098.5859  53.4%  2619  580s
  1665  1476     cutoff   50      26133.7815 40098.5859  53.4%  2536  592s
  1782  1600 31976.2890   19  214 26133.7815 40098.5859  53.4%  2493  601s
  1943  1780 30889.0868   26  111 26133.7815 40098.5859  53.4%  2403  611s
  2147  1987 28680.2763   39   96 26133.7815 40098.5859  53.4%  2296  622s
  2384  2095 26665.8191   44  184 26133.7815 40098.2458  53.4%  2176  633s
  2646  2201 36043.5876   12  237 26133.7815 40098.2458  53.4%  2064  644s
  2843  2285 35331.4002   13  225 26133.7815 40098.2458  53.4%  2023  656s
  3014  2409 33597.7438   14  269 26133.7815 40098.2458  53.4%  2001  669s
  3210  2554 33320.1928   15  276 26133.7815 40098.2458  53.4%  1973  683s
  3421  2625 32944.6993   17  338 26133.7815 40098.2458  53.4%  1941  697s
  3628  2691 32197.4475   17  271 26133.7815 38683.8083  48.0%  1921  711s
  3779  2780     cutoff   17      26133.7815 38683.8083  48.0%  1946  726s
  3920  2941 32534.5140   14  226 26133.7815 38683.8083  48.0%  1968  741s
H 4115  2923                    26327.575535 38390.3526  45.8%  1966  747s
H 4115  2922                    26332.161329 38390.3526  45.8%  1966  751s
H 4115  2916                    26384.893118 38390.3526  45.5%  1966  752s
H 4115  2900                    26521.912083 38390.3526  44.7%  1966  754s
H 4115  2866                    26670.532333 38390.3526  43.9%  1966  757s
  4116  2867 31607.6016   20  439 26670.5323 38390.3526  43.9%  1965  788s
H 4117  2724                    26796.463159 38390.3526  43.3%  1965  841s
H 4118  2588                    27105.448740 38390.3526  41.6%  1964  864s
H 4118  2458                    27125.846982 38390.3526  41.5%  1964  864s
  4119  2459 31743.0103   34  356 27125.8470 38390.3526  41.5%  1964  868s
  4120  2460 27646.0411   53  326 27125.8470 38390.3526  41.5%  1963  882s
  4121  2460 36519.1702   14  350 27125.8470 38390.3526  41.5%  1963  891s
  4122  2461 29986.6672   30  457 27125.8470 38390.3526  41.5%  1962  899s
  4123  2462 31522.6706   20  374 27125.8470 38390.3526  41.5%  1962  906s
  4124  2462 30658.9622   18  413 27125.8470 38390.3526  41.5%  1962  915s
  4125  2463 30668.6214   24  427 27125.8470 38390.3526  41.5%  1961  920s
  4127  2464 32564.5833   19  420 27125.8470 38390.3526  41.5%  1960  927s
  4128  2465 29901.4759   32  440 27125.8470 38390.3526  41.5%  1960  931s
  4130  2466 34572.6230   20  429 27125.8470 38390.3526  41.5%  1959  935s
  4131  2467 27818.0297   32  417 27125.8470 38390.3526  41.5%  1958  942s
  4132  2468 28972.9026   43  381 27125.8470 38390.3526  41.5%  1958  945s
  4134  2469 27556.2521   63  352 27125.8470 38390.3526  41.5%  1957  950s
  4135  2470 27125.8470   45  476 27125.8470 38390.3526  41.5%  1956  959s
  4136  2470 28277.5173   43  493 27125.8470 38390.3526  41.5%  1956  962s
  4137  2471 29687.1439   32  483 27125.8470 38390.3526  41.5%  1955  967s
  4138  2472 27584.7407   46  454 27125.8470 38390.3526  41.5%  1955  972s
  4139  2472 35494.5971   13  519 27125.8470 38390.3526  41.5%  1954  975s
  4141  2474 28954.2852   36  529 27125.8470 38390.3526  41.5%  1953  987s
  4142  2474 34891.0522   24  522 27125.8470 38390.3526  41.5%  1953  991s
  4143  2475 28112.6293   37  507 27125.8470 38390.3526  41.5%  1953 1002s
  4144  2476 34338.2001   28  525 27125.8470 38390.3526  41.5%  1952 1005s
  4146  2477 27822.4120   56  451 27125.8470 38390.3526  41.5%  1951 1012s
  4147  2478 34800.5882    8  522 27125.8470 38390.3526  41.5%  1951 1015s
H 4147  2354                    27204.977249 38390.3526  41.1%  1951 1025s
  4150  2356 36343.1246   11  391 27204.9772 38390.3526  41.1%  1949 1032s
  4151  2356 32039.3210   16  391 27204.9772 38390.3526  41.1%  1949 1103s
  4152  2357 31803.1939   18  391 27204.9772 38390.3526  41.1%  1948 1144s
  4153  2361 38390.3526   10  460 27204.9772 38390.3526  41.1%  2009 1168s
  4155  2364 38390.3526   11  448 27204.9772 38390.3526  41.1%  2012 1191s
  4159  2371 38390.3526   12  408 27204.9772 38390.3526  41.1%  2023 1213s
  4167  2384 38390.3526   13  414 27204.9772 38390.3526  41.1%  2043 1241s
  4183  2395 38390.3526   14  410 27204.9772 38390.3526  41.1%  2086 1275s
  4199  2421 36935.0978   15  265 27204.9772 38390.3526  41.1%  2158 1300s
  4231  2532 36693.7307   16  262 27204.9772 38390.3526  41.1%  2210 1326s
  4354  2540 36367.3161   18  283 27204.9772 38390.3526  41.1%  2302 1339s
  4413  2563 36599.2526   17  259 27204.9772 38390.3526  41.1%  2320 1355s
  4491  2569 35340.9757   19  326 27204.9772 38390.3526  41.1%  2338 1371s
  4571  2579 30667.3442   25  157 27204.9772 38390.3526  41.1%  2355 1384s
  4645  2590 35298.5992   19  315 27204.9772 38390.3526  41.1%  2368 1400s
  4733  2578 35113.8626   20  306 27204.9772 38390.3526  41.1%  2363 1412s
  4817  2561 34914.9213   21  185 27204.9772 38390.3526  41.1%  2366 1434s
  4856  2556 33526.4726   22  166 27204.9772 38390.3526  41.1%  2379 1452s
  4900  2548 31438.8257   23  196 27204.9772 38390.3526  41.1%  2388 1471s
  4938  2547 31028.5145   23  249 27204.9772 38390.3526  41.1%  2396 1499s
  4984  2547 32127.8702   22  192 27204.9772 38390.3526  41.1%  2409 1520s
  5028  2557     cutoff   23      27204.9772 38390.3526  41.1%  2415 1539s
  5078  2557 31025.1402   24  245 27204.9772 38390.3526  41.1%  2425 1552s
  5136  2553 29942.3418   25  251 27204.9772 38390.3526  41.1%  2427 1570s
  5187  2561 30242.2040   25  132 27204.9772 38390.3526  41.1%  2429 1584s
  5235  2577 30220.1272   26  122 27204.9772 38390.3526  41.1%  2431 1601s
H 5290  2440                    27249.107765 38390.3526  40.9%  2432 1601s
  5300  2486 29874.2878   27   92 27249.1078 38390.3526  40.9%  2430 1620s
  5420  2481 29221.4895   31  123 27249.1078 38390.3526  40.9%  2424 1646s
  5536  2480 28392.0632   35  119 27249.1078 38390.3526  40.9%  2425 1663s
  5648  2494     cutoff   39      27249.1078 38390.3526  40.9%  2431 1682s
  5728  2523 38390.3526   15  457 27249.1078 38390.3526  40.9%  2453 1701s
  5836  2541 36818.8496   16  413 27249.1078 38390.3526  40.9%  2465 1717s
  5953  2550 36236.9080   17  344 27249.1078 38390.3526  40.9%  2474 1742s
  6082  2574 35079.6119   20  291 27249.1078 38390.3526  40.9%  2479 1760s
  6212  2599 34328.5055   22  260 27249.1078 38390.3526  40.9%  2485 1780s
  6356  2569 29792.1466   26  154 27249.1078 38257.2002  40.4%  2489 1798s
  6417  2605 28726.0198   27  143 27249.1078 38257.2002  40.4%  2495 1817s
  6559  2600     cutoff   28      27249.1078 38257.2002  40.4%  2483 1838s
  6753  2609 34140.1469   17  269 27249.1078 38257.2002  40.4%  2466 1862s
  6906  2651 31235.7244   21  163 27249.1078 38257.2002  40.4%  2479 1884s
  7098  2653 29741.7040   26  121 27249.1078 38257.2002  40.4%  2482 1906s
  7355  2668 28179.4371   37   93 27249.1078 38167.2076  40.1%  2460 1930s
  7644  2719 30897.2332   20  171 27249.1078 38167.2076  40.1%  2432 1954s
  7945  2731 29337.5846   24  180 27249.1078 36675.8879  34.6%  2403 1976s
H 7955  2615                    27590.862349 36675.8879  32.9%  2402 1976s
  8189  2574     cutoff   34      27590.8623 36675.8879  32.9%  2378 2002s
  8401  2543 31978.8335   19  246 27590.8623 36675.8879  32.9%  2392 2026s
  8638  2540 28995.6494   21  206 27590.8623 36675.8879  32.9%  2398 2059s
  8889  2518 27716.1078   23  242 27590.8623 36675.8879  32.9%  2404 2088s
  9152  2442 29843.9271   20  365 27590.8623 35196.9512  27.6%  2412 2116s
H 9174  2212                    27977.480620 35196.9512  25.8%  2414 2116s
  9209  2273 30063.5972   21  357 27977.4806 35079.4444  25.4%  2421 2145s
  9420  2287 29886.4334   22  374 27977.4806 35079.4444  25.4%  2423 2176s
  9672  2325     cutoff   25      27977.4806 35079.4444  25.4%  2438 2208s
 10054  2312 31264.7835   24  167 27977.4806 35018.3222  25.2%  2427 2240s
 10411  2347     cutoff   44      27977.4806 34631.6818  23.8%  2427 2275s
 10745  2470 28186.6323   21  333 27977.4806 34544.4305  23.5%  2437 2308s
 11043  2573 28687.9758   21  121 27977.4806 34531.1358  23.4%  2457 2347s
 11422  2683     cutoff   30      27977.4806 34382.2221  22.9%  2461 2389s
 11767  2760 29167.4133   23  264 27977.4806 33905.2029  21.2%  2474 2428s
 12153  2851     cutoff   27      27977.4806 33786.1824  20.8%  2488 2474s
 12539  2956 31091.4958   19  196 27977.4806 33697.8512  20.4%  2498 2517s
 12949  2971 28818.3276   25  194 27977.4806 33585.3494  20.0%  2512 2556s
 13179  3029     cutoff   26      27977.4806 33338.2584  19.2%  2517 2600s
 13541  3154 28448.3690   28   78 27977.4806 33308.5421  19.1%  2540 2647s
 14032  3189 31503.5245   21  339 27977.4806 33191.2997  18.6%  2543 2698s
 14514  3246 30219.1879   21  200 27977.4806 32982.6261  17.9%  2555 2746s
 15044  3334 30858.9622   24  209 27977.4806 32704.0133  16.9%  2566 2803s
 15597  3388     cutoff   26      27977.4806 32513.7989  16.2%  2574 2857s
 16130  3430 28411.4839   18  285 27977.4806 32364.6735  15.7%  2586 2913s
 16705  3471 28284.8467   29   88 27977.4806 32196.3682  15.1%  2595 2969s
 17268  3489     cutoff   21      27977.4806 32036.9681  14.5%  2599 3023s
 17793  3502 29633.6034   23  118 27977.4806 31934.4091  14.1%  2609 3087s
 18487  3460 infeasible   22      27977.4806 31717.5704  13.4%  2611 3153s
 19222  3436 28113.0020   29  157 27977.4806 31495.7852  12.6%  2609 3223s
 20029  3348     cutoff   21      27977.4806 31290.3068  11.8%  2603 3287s
 20884  3159     cutoff   27      27977.4806 31027.2571  10.9%  2596 3357s
 21877  2915 28211.3570   25  137 27977.4806 30755.4926  9.93%  2580 3428s
 23043  2361 28433.5652   29  121 27977.4806 30502.3349  9.02%  2548 3500s
 24408  2202     cutoff   24      27977.4806 30128.2514  7.69%  2499 3553s
 24677  1532 28595.2455   25  270 27977.4806 30128.2514  7.69%  2488 3600s

Cutting planes:
  Learned: 2
  MIR: 599
  Mixing: 1
  Flow cover: 1686
  RLT: 14
  Relax-and-lift: 148

Explored 26412 nodes (63039908 simplex iterations) in 3600.06 seconds (10285.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27977.5 27590.9 27249.1 ... 26384.9

Time limit reached
Best objective 2.797748061975e+04, best bound 2.980112802927e+04, gap 6.5183%
  WARNING: Time limit reached. Using best solution found (gap: 6.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 27977.48, θ = 176508.89
  Upper Bound (UB) = 27977.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176508.89
  [DEBUG]   ✓ Scenario 0: θ = 176508.89 ≤ Q = 176508.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176508.89 ≤ Q = 176508.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176508.89 ≤ Q = 176508.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176508.89 ≤ Q = 176508.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176508.89 ≤ Q = 176508.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176508.89 ≤ Q = 176508.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176508.89 ≤ Q = 176508.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176508.89 ≤ Q = 176508.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 176508.89 ≤ Q = 176508.89 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x9de587a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf621a786
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-14, 2e+02]
Found heuristic solution: objective 1.389929e+13
Presolve removed 2606 rows and 1898 columns
Presolve time: 0.00s
Presolved: 487 rows, 491 columns, 1373 nonzeros
Found heuristic solution: objective 6544634.2874
Variable types: 333 continuous, 158 integer (158 binary)

Root relaxation: objective -1.673708e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167370.80    0  130 6544634.29 -167370.80   103%     -    0s
H    0     0                    -131342.3532 -167370.80  27.4%     -    0s
     0     0 -143607.10    0   21 -131342.35 -143607.10  9.34%     -    0s
H    0     0                    -135115.8472 -143595.75  6.28%     -    0s
H    0     0                    -135893.2253 -143595.75  5.67%     -    0s
H    0     0                    -143418.1590 -143595.75  0.12%     -    0s
     0     0 -143587.03    0   38 -143418.16 -143587.03  0.12%     -    0s
     0     0 -143584.41    0    2 -143418.16 -143584.41  0.12%     -    0s
     0     0 -143563.05    0    2 -143418.16 -143563.05  0.10%     -    0s
H    0     0                    -143427.8748 -143563.05  0.09%     -    0s
H    0     0                    -143448.1300 -143563.05  0.08%     -    0s
     0     0 -143563.05    0   20 -143448.13 -143563.05  0.08%     -    0s
H    0     0                    -143453.4953 -143563.05  0.08%     -    0s
     0     0 -143563.05    0    4 -143453.50 -143563.05  0.08%     -    0s
H    0     0                    -143558.3555 -143562.38  0.00%     -    0s

Cutting planes:
  MIR: 17
  Flow cover: 2

Explored 1 nodes (495 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -143558 -143453 -143448 ... 1.38993e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.435583555433e+05, best bound -1.435623754776e+05, gap 0.0028%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 166187.51
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143558.36
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -143558.36 = 166187.51
  [DEBUG]   Current θ from Master = 176508.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10321.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17656.10
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 3749.5666, Absolute Gap = 3749.5666, Relative Gap = 0.134021
  Not converged yet (gap = 3749.57 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437799 nonzeros
Model fingerprint: 0x3acd4b03
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 71910 rows and 29210 columns
Presolve time: 1.19s
Presolved: 82373 rows, 35450 columns, 504749 nonzeros
Variable types: 33191 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -331007.1414
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.553e+06
 Factor NZ  : 7.665e+06 (roughly 100 MB of memory)
 Factor Ops : 1.340e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55153092e+07  1.69047610e+08  1.01e+05 2.21e+01  7.39e+04     2s
   1  -1.16789967e+07  1.47704388e+08  7.06e+04 9.19e+01  5.07e+04     2s
   2  -5.78124908e+06  1.13006712e+08  3.36e+04 1.09e-11  2.52e+04     2s
   3  -1.06004784e+06  8.52689573e+07  3.27e+03 1.42e+00  2.87e+03     2s
   4  -5.30401128e+05  3.10295707e+07  4.79e+02 1.69e-01  5.01e+02     2s
   5  -4.33835445e+05  1.87527505e+07  2.59e+02 8.86e-02  2.70e+02     2s
   6  -2.67235949e+05  1.40161629e+07  6.27e+01 6.02e-02  1.26e+02     2s
   7  -1.73783996e+05  1.02535367e+07  2.90e+01 4.22e-02  8.13e+01     3s
   8  -1.20270800e+05  7.31817075e+06  1.45e+01 2.88e-02  5.40e+01     3s
   9  -9.11179577e+04  4.85323586e+06  7.36e+00 1.85e-02  3.44e+01     3s
  10  -7.59476816e+04  2.13264867e+06  3.80e+00 7.61e-03  1.51e+01     3s
  11  -3.49050238e+04  4.05749391e+05  5.34e-01 1.24e-03  2.93e+00     3s
  12  -1.28768660e+04  2.69191381e+05  3.43e-01 1.33e-03  1.87e+00     3s
  13   1.34809351e+03  1.86569447e+05  2.49e-01 1.61e-03  1.23e+00     3s
  14   8.34914334e+03  1.48656814e+05  2.12e-01 1.81e-03  9.31e-01     3s
  15   1.92391363e+04  1.25742575e+05  1.58e-01 1.95e-03  7.06e-01     3s
  16   2.32124797e+04  9.87237982e+04  1.39e-01 2.82e-03  5.01e-01     3s
  17   2.90235849e+04  9.08209209e+04  1.14e-01 2.81e-03  4.10e-01     3s
  18   3.39185367e+04  8.31200148e+04  9.21e-02 2.55e-03  3.26e-01     3s
  19   3.93422331e+04  7.64516875e+04  6.93e-02 2.05e-03  2.46e-01     3s
  20   4.36535962e+04  7.27250798e+04  5.25e-02 1.81e-03  1.93e-01     3s
  21   4.49431618e+04  6.86931794e+04  4.76e-02 1.89e-03  1.58e-01     3s
  22   4.84334581e+04  6.69489332e+04  3.52e-02 1.39e-03  1.23e-01     3s
  23   5.03775851e+04  6.46988057e+04  2.82e-02 1.03e-03  9.50e-02     3s
  24   5.19611316e+04  6.37841727e+04  2.27e-02 8.65e-04  7.84e-02     3s
  25   5.32909126e+04  6.17417462e+04  1.81e-02 5.14e-04  5.61e-02     3s
  26   5.39483848e+04  6.10556926e+04  1.58e-02 3.86e-04  4.72e-02     3s
  27   5.56665376e+04  6.05031228e+04  1.03e-02 2.59e-04  3.21e-02     3s
  28   5.60850392e+04  6.00620934e+04  8.94e-03 1.88e-04  2.64e-02     3s
  29   5.69805049e+04  5.97154295e+04  6.12e-03 3.39e-04  1.82e-02     3s
  30   5.74773701e+04  5.94658756e+04  4.56e-03 2.67e-04  1.32e-02     3s
  31   5.77362789e+04  5.93443075e+04  3.78e-03 2.18e-04  1.07e-02     3s
  32   5.80157283e+04  5.92966016e+04  2.94e-03 1.84e-04  8.50e-03     4s
  33   5.83178324e+04  5.92130691e+04  2.05e-03 1.02e-04  5.94e-03     4s
  34   5.83988321e+04  5.91605853e+04  1.80e-03 7.20e-05  5.06e-03     4s
  35   5.85972748e+04  5.91110210e+04  1.20e-03 4.97e-05  3.41e-03     4s
  36   5.86844138e+04  5.90765337e+04  9.33e-04 3.32e-05  2.60e-03     4s
  37   5.87413638e+04  5.90606090e+04  7.62e-04 2.48e-05  2.12e-03     4s
  38   5.88693436e+04  5.90341141e+04  3.83e-04 1.26e-05  1.09e-03     4s
  39   5.89836598e+04  5.90167744e+04  5.91e-05 4.00e-06  2.20e-04     4s
  40   5.89953238e+04  5.90106185e+04  2.92e-05 1.79e-06  1.01e-04     4s
  41   5.90025313e+04  5.90071886e+04  1.07e-05 1.48e-07  3.09e-05     4s
  42   5.90043100e+04  5.90070774e+04  6.17e-06 1.09e-07  1.84e-05     4s
  43   5.90063968e+04  5.90068028e+04  8.41e-07 1.76e-08  2.70e-06     4s
  44   5.90067431e+04  5.90067619e+04  7.05e-09 2.32e-08  1.24e-07     4s
  45   5.90067441e+04  5.90067589e+04  1.87e-09 1.93e-08  9.78e-08     4s
  46   5.90067441e+04  5.90067548e+04  9.83e-09 1.38e-08  7.07e-08     4s
  47   5.90067442e+04  5.90067444e+04  2.17e-08 1.65e-08  1.29e-09     4s

Barrier solved model in 47 iterations and 4.25 seconds (7.22 work units)
Optimal objective 5.90067442e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

    1946 PPushes remaining with PInf 1.5901475e-05                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8401610e+02      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36164    5.9006744e+04   0.000000e+00   1.840161e+02      6s
   36173    5.9006744e+04   0.000000e+00   0.000000e+00      6s
   36173    5.9006744e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.900674e+04, 36173 iterations, 3.90 seconds (7.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 59006.7442    0  172 -187498.33 59006.7442   131%     -    5s
H    0     0                    -179451.3820 59006.7442   133%     -    5s
H    0     0                    -179102.5752 59006.7442   133%     -    6s
H    0     0                    -157833.2633 59006.7442   137%     -    6s
H    0     0                    -156727.9199 59006.7442   138%     -    6s
H    0     0                    -48691.54515 59006.7442   221%     -    6s
H    0     0                    -2763.301791 59006.7442  2235%     -    6s
H    0     0                    1816.9025758 59006.7442  3148%     -    6s
H    0     0                    2044.4461915 59006.7442  2786%     -    7s
H    0     0                    13041.762475 59006.7442   352%     -    7s
H    0     0                    13105.758193 59006.7442   350%     -    7s
H    0     0                    13132.897918 59006.7442   349%     -    7s
     0     0 51688.6757    0  224 13132.8979 51688.6757   294%     -   29s
H    0     0                    15446.569504 51688.6136   235%     -   30s
H    0     0                    16638.971099 51688.6136   211%     -   30s
H    0     0                    17361.602786 51688.6136   198%     -   30s
H    0     0                    18769.840992 51688.6136   175%     -   30s
H    0     0                    19055.422361 50789.4128   167%     -   42s
H    0     0                    19111.327349 50789.4128   166%     -   42s
     0     0 50789.4128    0  270 19111.3273 50789.4128   166%     -   42s
     0     0 50754.3936    0  253 19111.3273 50754.3936   166%     -   46s
     0     0 50567.0481    0  290 19111.3273 50567.0481   165%     -   52s
     0     0 50563.1875    0  247 19111.3273 50563.1875   165%     -   57s
     0     0 50555.3722    0  241 19111.3273 50555.3722   165%     -   58s
     0     0 50554.7777    0  241 19111.3273 50554.7777   165%     -   58s
H    0     0                    19124.959231 46956.4937   146%     -   88s
H    0     0                    19213.567768 46956.4937   144%     -   88s
     0     0 46956.4937    0  344 19213.5678 46956.4937   144%     -   88s
H    0     0                    23009.816615 46953.2088   104%     -   88s
H    0     0                    23260.030500 46953.2088   102%     -   88s
H    0     0                    24175.964322 46953.2088  94.2%     -   88s
     0     0 46380.1405    0  336 24175.9643 46380.1405  91.8%     -   99s
     0     0 46256.2699    0  364 24175.9643 46256.2699  91.3%     -  105s
     0     0 45969.0177    0  390 24175.9643 45969.0177  90.1%     -  115s
     0     0 45899.1954    0  375 24175.9643 45899.1954  89.9%     -  119s
     0     0 45875.9230    0  405 24175.9643 45875.9230  89.8%     -  122s
     0     0 45846.1727    0  401 24175.9643 45846.1727  89.6%     -  125s
     0     0 45750.4484    0  395 24175.9643 45750.4484  89.2%     -  130s
     0     0 45656.5629    0  399 24175.9643 45656.5629  88.9%     -  134s
     0     0 45603.7912    0  395 24175.9643 45603.7912  88.6%     -  138s
     0     0 45532.9495    0  405 24175.9643 45532.9495  88.3%     -  142s
     0     0 45522.4832    0  406 24175.9643 45522.4832  88.3%     -  144s
     0     0 45521.8080    0  408 24175.9643 45521.8080  88.3%     -  145s
     0     0 43411.6938    0  349 24175.9643 43411.6938  79.6%     -  176s
H    0     0                    24742.479206 43411.5262  75.5%     -  177s
H    0     0                    25144.172275 43411.5262  72.7%     -  177s
H    0     0                    25185.660721 43411.5262  72.4%     -  177s
     0     0 42813.4307    0  440 25185.6607 42813.4307  70.0%     -  193s
     0     0 42558.0738    0  345 25185.6607 42558.0738  69.0%     -  207s
     0     0 42434.2298    0  358 25185.6607 42434.2298  68.5%     -  215s
     0     0 42393.0576    0  384 25185.6607 42393.0576  68.3%     -  219s
     0     0 42352.1423    0  391 25185.6607 42352.1423  68.2%     -  224s
     0     0 42261.5033    0  396 25185.6607 42261.5033  67.8%     -  230s
     0     0 42100.2131    0  366 25185.6607 42100.2131  67.2%     -  236s
     0     0 42065.7484    0  404 25185.6607 42065.7484  67.0%     -  241s
     0     0 42051.5354    0  409 25185.6607 42051.5354  67.0%     -  244s
     0     0 42049.1013    0  409 25185.6607 42049.1013  67.0%     -  246s
     0     0 42046.2211    0  409 25185.6607 42046.2211  66.9%     -  246s
     0     0 42045.0868    0  411 25185.6607 42045.0868  66.9%     -  247s
     0     0 41575.4681    0  405 25185.6607 41575.4681  65.1%     -  268s
     0     0 41468.2265    0  416 25185.6607 41468.2265  64.7%     -  276s
     0     0 41381.4069    0  426 25185.6607 41381.4069  64.3%     -  284s
     0     0 41349.8156    0  428 25185.6607 41349.8156  64.2%     -  288s
     0     0 41325.1106    0  467 25185.6607 41325.1106  64.1%     -  293s
     0     0 41311.4607    0  438 25185.6607 41311.4607  64.0%     -  296s
     0     0 41298.5519    0  435 25185.6607 41298.5519  64.0%     -  297s
     0     0 41294.4161    0  442 25185.6607 41294.4161  64.0%     -  300s
     0     0 41282.3242    0  442 25185.6607 41282.3242  63.9%     -  303s
     0     0 41275.9965    0  450 25185.6607 41275.9965  63.9%     -  306s
     0     0 41265.7948    0  446 25185.6607 41265.7948  63.8%     -  309s
     0     0 41259.1432    0  450 25185.6607 41259.1432  63.8%     -  312s
     0     0 41254.8479    0  447 25185.6607 41254.8479  63.8%     -  315s
     0     0 41252.6368    0  444 25185.6607 41252.6368  63.8%     -  316s
     0     0 41114.3817    0  370 25185.6607 41114.3817  63.2%     -  329s
     0     0 41060.9524    0  378 25185.6607 41060.9524  63.0%     -  335s
     0     0 41048.7928    0  431 25185.6607 41048.7928  63.0%     -  339s
     0     0 41041.7932    0  478 25185.6607 41041.7932  63.0%     -  342s
     0     0 41039.7235    0  433 25185.6607 41039.7235  62.9%     -  343s
     0     0 40966.9759    0  389 25185.6607 40966.9759  62.7%     -  351s
     0     0 40953.1428    0  442 25185.6607 40953.1428  62.6%     -  357s
     0     0 40941.4861    0  393 25185.6607 40941.4861  62.6%     -  360s
     0     0 40934.8893    0  454 25185.6607 40934.8893  62.5%     -  364s
     0     0 40932.7478    0  403 25185.6607 40932.7478  62.5%     -  366s
H    0     0                    25757.865626 40891.6290  58.8%     -  372s
     0     0 40891.6290    0  481 25757.8656 40891.6290  58.8%     -  372s
     0     0 40875.3747    0  448 25757.8656 40875.3747  58.7%     -  376s
     0     0 40871.8515    0  493 25757.8656 40871.8515  58.7%     -  378s
     0     0 40868.8780    0  445 25757.8656 40868.8780  58.7%     -  380s
     0     0 40864.3415    0  446 25757.8656 40864.3415  58.6%     -  381s
     0     0 40863.8974    0  450 25757.8656 40863.8974  58.6%     -  382s
     0     0 40847.8084    0  429 25757.8656 40847.8084  58.6%     -  387s
     0     0 40837.4410    0  422 25757.8656 40837.4410  58.5%     -  391s
     0     0 40831.8245    0  447 25757.8656 40831.8245  58.5%     -  393s
     0     0 40826.7690    0  445 25757.8656 40826.7690  58.5%     -  394s
     0     0 40825.3514    0  441 25757.8656 40825.3514  58.5%     -  395s
     0     0 40807.1847    0  395 25757.8656 40807.1847  58.4%     -  400s
     0     0 40801.4254    0  450 25757.8656 40801.4254  58.4%     -  403s
     0     0 40798.0136    0  457 25757.8656 40798.0136  58.4%     -  404s
     0     0 40797.6071    0  461 25757.8656 40797.6071  58.4%     -  405s
     0     0 40789.8379    0  396 25757.8656 40789.8379  58.4%     -  407s
     0     0 40788.4024    0  396 25757.8656 40788.4024  58.4%     -  411s
     0     0 40778.6831    0  393 25757.8656 40778.6831  58.3%     -  415s
     0     0 40778.5700    0  393 25757.8656 40778.5700  58.3%     -  416s
H    0     0                    25770.374991 40778.3522  58.2%     -  479s
H    0     0                    25825.024977 40778.3522  57.9%     -  479s
     0     2 40778.3522    0  393 25825.0250 40778.3522  57.9%     -  486s
     1     3 39238.7054    1  393 25825.0250 40778.3522  57.9% 25018  512s
     5     9 39759.8884    2  468 25825.0250 40709.2662  57.6%  9077  545s
     8    17 39311.1268    3  411 25825.0250 40709.2662  57.6% 11867  557s
    16    31 34125.3572    5  301 25825.0250 40602.7785  57.2% 10266  574s
    30    46 34669.2574    6  330 25825.0250 40602.6357  57.2% 12735  606s
    45    77 38144.8116    4  335 25825.0250 40576.5975  57.1% 13863  653s
    76   109 38071.1536    5  361 25825.0250 40576.5975  57.1% 11678  680s
H   77   109                    25962.305160 40576.5975  56.3% 11526  680s
H   85   109                    26058.652720 40576.5975  55.7% 11203  680s
H   97   109                    26494.454079 40576.5975  53.2% 10650  680s
H  108   150                    26611.161510 40576.5975  52.5% 10323  704s
H  111   150                    26674.520096 40576.5975  52.1% 10335  704s
   151   286 37647.0758    7  343 26674.5201 40576.5975  52.1%  9816  729s
   291   366 37213.1546   12  324 26674.5201 40576.5975  52.1%  6791  745s
   381   416 37092.2773   13  446 26674.5201 40576.5975  52.1%  5996  760s
   445   481 37079.0042   14  390 26674.5201 40576.5975  52.1%  5596  775s
   521   552 35182.5930   15  326 26674.5201 40576.5975  52.1%  5269  789s
   605   600 34969.7348   16  264 26674.5201 40576.5975  52.1%  4859  803s
   663   642 27326.5522   11  246 26674.5201 40576.5975  52.1%  4741  816s
   728   668 33801.8411   18  314 26674.5201 40576.5975  52.1%  4524  829s
   762   726 33631.8581   19  307 26674.5201 40576.5975  52.1%  4462  841s
   836   814 33317.5799   20  302 26674.5201 40576.5975  52.1%  4254  853s
   938   855 33242.9914   21  301 26674.5201 40576.5975  52.1%  3939  871s
  1024   916 32944.8519   24  288 26674.5201 40576.5975  52.1%  3770  888s
  1109   996 32847.3664   25  284 26674.5201 40576.5975  52.1%  3637  910s
  1219  1041 31863.5419   26  198 26674.5201 40576.5975  52.1%  3472  923s
  1298  1134 31359.5918   27  229 26674.5201 40576.5975  52.1%  3376  940s
  1433  1243 30625.6269   29  170 26674.5201 40576.5975  52.1%  3197  956s
  1578  1311 30044.2077   37  174 26674.5201 40576.5975  52.1%  3034  970s
  1696  1402 29407.1249   43  194 26674.5201 40576.5975  52.1%  2956  985s
  1857  1496 28716.0865   54   78 26674.5201 40576.5975  52.1%  2847 1001s
  2037  1576 28096.8881   66   77 26674.5201 40576.5975  52.1%  2722 1020s
  2193  1648     cutoff   46      26674.5201 40158.9729  50.6%  2651 1041s
  2339  1715     cutoff   42      26674.5201 40158.9729  50.6%  2596 1061s
  2458  1848 29369.1612   22  172 26674.5201 40158.9729  50.6%  2574 1088s
  2629  1864 29155.2378   24  145 26674.5201 40158.9729  50.6%  2515 1106s
  2669  1901 29151.5390   25  146 26674.5201 40158.9729  50.6%  2527 1124s
  2718  2006 29095.3167   26  205 26674.5201 39628.7747  48.6%  2539 1143s
  2871  2116 28779.8417   30  140 26674.5201 39628.7747  48.6%  2491 1163s
  3026  2267 28211.4745   38  176 26674.5201 39628.7747  48.6%  2462 1187s
  3224  2393 27087.8443   57  138 26674.5201 39628.7747  48.6%  2421 1211s
  3396  2525 34963.8840    8  230 26674.5201 39628.7747  48.6%  2410 1234s
  3573  2526 30986.8331   28  393 26674.5201 39628.7747  48.6%  2406 1302s
  3575  2527 29519.5592   39  172 26674.5201 39628.7747  48.6%  2404 1310s
  3576  2528 35750.5548   12  387 26674.5201 39628.7747  48.6%  2404 1364s
  3577  2529 28715.3207   48  367 26674.5201 39628.7747  48.6%  2403 1397s
  3578  2529 31446.1191   20  377 26674.5201 39628.7747  48.6%  2402 1423s
  3579  2530 28379.8152   37  360 26674.5201 39628.7747  48.6%  2402 1440s
  3580  2531 27636.0942   65  359 26674.5201 39628.7747  48.6%  2401 1450s
  3581  2531 28918.9283   42  352 26674.5201 39628.7747  48.6%  2400 1458s
  3582  2532 28220.4548   49  357 26674.5201 39628.7747  48.6%  2400 1471s
  3583  2533 28089.9230   38  426 26674.5201 39628.7747  48.6%  2399 1477s
  3584  2533 29205.1059   37  367 26674.5201 39628.7747  48.6%  2398 1487s
  3585  2534 33641.9024   30  422 26674.5201 39628.7747  48.6%  2398 1494s
  3586  2535 30879.6080   26  424 26674.5201 39628.7747  48.6%  2397 1500s
  3587  2535 29617.1477   37  422 26674.5201 39628.7747  48.6%  2396 1505s
  3590  2537 34950.5062   15  423 26674.5201 39628.7747  48.6%  2394 1510s
  3592  2539 35281.0726   15  377 26674.5201 39628.7747  48.6%  2393 1526s
  3593  2539 30788.7446   14  439 26674.5201 39628.7747  48.6%  2392 1533s
  3594  2540 32050.8098   36  443 26674.5201 39628.7747  48.6%  2392 1538s
  3595  2541 35344.3765   21  376 26674.5201 39628.7747  48.6%  2391 1541s
  3597  2542 27606.9884   47  506 26674.5201 39628.7747  48.6%  2390 1548s
  3598  2543 29254.2149   55  429 26674.5201 39628.7747  48.6%  2389 1559s
  3599  2543 29077.9008   40  439 26674.5201 39628.7747  48.6%  2388 1565s
  3600  2544 29936.8352   27  444 26674.5201 39628.7747  48.6%  2388 1571s
H 3601  2417                    26979.333718 39628.7747  46.9%  2387 1584s
  3602  2417 34431.5866   14  390 26979.3337 39628.7747  46.9%  2386 1587s
  3603  2418 35647.9586   10  386 26979.3337 39628.7747  46.9%  2386 1593s
  3604  2419 29095.4791   23  403 26979.3337 39628.7747  46.9%  2385 1600s
  3605  2419 32098.6471   17  471 26979.3337 39628.7747  46.9%  2384 1605s
  3606  2420 30963.3554   23  491 26979.3337 39628.7747  46.9%  2384 1613s
  3607  2421 30998.7785   56  504 26979.3337 39628.7747  46.9%  2383 1618s
  3608  2421 28472.1105   40  517 26979.3337 39628.7747  46.9%  2382 1622s
  3609  2422 27456.8720   43  443 26979.3337 39628.7747  46.9%  2382 1633s
  3610  2423 35813.1621   12  464 26979.3337 39628.7747  46.9%  2381 1638s
  3611  2423 31199.4296   26  515 26979.3337 39628.7747  46.9%  2380 1649s
  3612  2424 27476.0193   27  444 26979.3337 39628.7747  46.9%  2380 1654s
  3613  2425 33744.2132   15  472 26979.3337 39628.7747  46.9%  2379 1659s
  3614  2425 27811.1463   18  474 26979.3337 39628.7747  46.9%  2378 1667s
  3615  2426 28785.8051   81  450 26979.3337 39628.7747  46.9%  2378 1671s
  3616  2427 33544.0914   13  499 26979.3337 39628.7747  46.9%  2377 1681s
  3617  2427 28229.2447   31  502 26979.3337 39628.7747  46.9%  2376 1688s
  3618  2428 29169.1711   47  511 26979.3337 39628.7747  46.9%  2376 1692s
  3619  2429 36820.2170    9  460 26979.3337 39628.7747  46.9%  2375 1698s
  3620  2429 27351.1708   76  460 26979.3337 39628.7747  46.9%  2374 1707s
H 3620  2307                    27204.977249 39628.7747  45.7%  2374 1761s
H 3621  2193                    27249.107765 39628.7747  45.4%  2458 1829s
  3622  2195 39628.7747   15  435 27249.1078 39628.7747  45.4%  2460 1863s
  3624  2198 39628.7747   16  429 27249.1078 39628.7747  45.4%  2465 1901s
  3628  2205 39628.7747   17  473 27249.1078 39628.7747  45.4%  2477 1944s
  3636  2218 39135.8040   18  388 27249.1078 39628.7747  45.4%  2497 1988s
  3652  2234 37311.7278   19  347 27249.1078 39135.7957  43.6%  2584 2047s
  3673  2259 33700.1738   20  290 27249.1078 39135.7957  43.6%  2656 2081s
  3705  2360 33154.0779   21  294 27249.1078 39135.7957  43.6%  2750 2123s
H 3763  2231                    27253.379575 39135.7957  43.6%  2833 2123s
  3819  2258 32384.7114   26  241 27253.3796 39135.7957  43.6%  2885 2150s
  3885  2262 32221.0883   25  205 27253.3796 39135.7957  43.6%  2922 2169s
  3918  2282 32099.9954   24  213 27253.3796 39135.7957  43.6%  2948 2188s
  3959  2302 30364.8438   27  160 27253.3796 39135.7957  43.6%  2964 2210s
  4006  2313 30425.5605   27  184 27253.3796 39135.7957  43.6%  2977 2229s
  4051  2319 31376.6820   26  198 27253.3796 39135.7957  43.6%  2991 2247s
  4084  2345 29714.2954   28  150 27253.3796 39135.7957  43.6%  2998 2266s
  4129  2358 31565.0148   27  265 27253.3796 39135.7957  43.6%  3006 2301s
  4175  2375 29313.0859   29  153 27253.3796 39135.7957  43.6%  3006 2323s
  4224  2385 28798.2474   30  155 27253.3796 39135.7957  43.6%  3014 2343s
  4277  2396 28461.0905   31  136 27253.3796 39135.7957  43.6%  3014 2378s
  4355  2383 28098.5471   32  133 27253.3796 39135.7957  43.6%  3002 2408s
  4416  2380     cutoff   32      27253.3796 39135.7957  43.6%  3005 2438s
  4474  2394 32074.3353   30  333 27253.3796 39135.7957  43.6%  3016 2469s
  4541  2412 30768.6780   32  203 27253.3796 39135.7957  43.6%  3022 2491s
  4636  2454 30288.7026   36  151 27253.3796 39135.7957  43.6%  3016 2513s
H 4718  2321                    27293.907095 39135.7957  43.4%  3006 2513s
  4739  2391 27958.8623   39  193 27293.9071 39135.7957  43.4%  3004 2535s
  4857  2435 27387.9239   42  104 27293.9071 39135.7957  43.4%  2997 2557s
  4994  2463 28836.1518   47  246 27293.9071 39135.7957  43.4%  2980 2582s
  5136  2481 27509.0172   56   69 27293.9071 39135.7957  43.4%  2953 2615s
  5302  2469 28251.0787   62  158 27293.9071 39135.7957  43.4%  2927 2639s
  5461  2462 30225.7032   33  278 27293.9071 39135.7957  43.4%  2901 2672s
  5610  2448     cutoff   35      27293.9071 39135.7957  43.4%  2882 2698s
  5774  2424 33584.3114   24  342 27293.9071 39135.7957  43.4%  2863 2727s
  5896  2437 32696.3175   25  238 27293.9071 39135.7957  43.4%  2861 2769s
  6016  2451 32654.1793   26  297 27293.9071 38604.6066  41.4%  2872 2801s
  6130  2478 31551.1267   27  175 27293.9071 38604.6066  41.4%  2886 2831s
  6279  2485 29957.8094   28  135 27293.9071 38604.6066  41.4%  2887 2861s
  6467  2467     cutoff   32      27293.9071 38604.6066  41.4%  2872 2901s
  6618  2514     cutoff   36      27293.9071 37643.1583  37.9%  2888 2938s
  6801  2570 28364.3671   40  328 27293.9071 37638.6079  37.9%  2890 2973s
  7054  2582 27297.3597   45  155 27293.9071 37638.6079  37.9%  2864 3010s
  7342  2590 32837.0943   28  200 27293.9071 37638.6079  37.9%  2830 3047s
  7577  2631 30708.6436   30  307 27293.9071 37638.6079  37.9%  2825 3085s
  7814  2656 29894.6572   33  287 27293.9071 36174.4101  32.5%  2822 3127s
  8072  2703 27423.9985   37  270 27293.9071 36174.4101  32.5%  2817 3172s
  8352  2633 30688.9713   23  406 27293.9071 36060.2942  32.1%  2816 3206s
  8392  2642 30263.8762   24  312 27293.9071 36060.2942  32.1%  2822 3234s
  8437  2744 30149.0287   25  290 27293.9071 35584.4487  30.4%  2823 3269s
  8630  2828 29114.8006   26  287 27293.9071 35506.8347  30.1%  2804 3310s
H 8655  2718                    27332.254104 35506.8347  29.9%  2803 3310s
  8936  2769 28740.5140   27  233 27332.2541 35264.8811  29.0%  2774 3354s
  9240  2861 28745.7426   45  105 27332.2541 35160.4741  28.6%  2771 3415s
  9687  3152 32456.8452   23  385 27332.2541 35141.9102  28.6%  2740 3459s
 10134  3413 29399.3353   27  274 27332.2541 35029.4405  28.2%  2710 3513s
 10621  3620 27559.5480   29  207 27332.2541 35029.4405  28.2%  2679 3561s
 11024  3786 29474.7380   28  195 27332.2541 34730.4378  27.1%  2669 3600s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 7
  Projected implied bound: 129
  MIR: 1109
  Mixing: 2
  Flow cover: 2142
  RLT: 27
  Relax-and-lift: 269

Explored 11534 nodes (30717781 simplex iterations) in 3600.04 seconds (9395.95 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27332.3 27293.9 27253.4 ... 26058.7

Time limit reached
Best objective 2.733225410360e+04, best bound 3.453978217647e+04, gap 26.3700%
  WARNING: Time limit reached. Using best solution found (gap: 26.37%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 27332.25, θ = 180428.54
  Upper Bound (UB) = 27332.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 180428.54
  [DEBUG]   ✓ Scenario 0: θ = 180428.54 ≤ Q = 180428.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 180428.54 ≤ Q = 180428.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 180428.54 ≤ Q = 180428.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 180428.54 ≤ Q = 180428.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 180428.54 ≤ Q = 180428.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 180428.54 ≤ Q = 180428.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 180428.54 ≤ Q = 180428.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 180428.54 ≤ Q = 180428.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 180428.54 ≤ Q = 180428.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 180428.54 ≤ Q = 180428.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2caab88c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd3554774
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.229938e+13
Presolve removed 2605 rows and 1906 columns
Presolve time: 0.00s
Presolved: 488 rows, 483 columns, 1369 nonzeros
Found heuristic solution: objective 5258939.4993
Variable types: 325 continuous, 158 integer (158 binary)

Root relaxation: objective -1.641494e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164149.42    0  132 5258939.50 -164149.42   103%     -    0s
H    0     0                    -129204.7942 -164149.42  27.0%     -    0s
H    0     0                    -137991.2454 -146220.38  5.96%     -    0s
H    0     0                    -143866.8265 -146220.38  1.64%     -    0s
     0     0 -146220.38    0   59 -143866.83 -146220.38  1.64%     -    0s
H    0     0                    -145955.1611 -146213.29  0.18%     -    0s
     0     0 -146106.83    0   35 -145955.16 -146106.83  0.10%     -    0s
     0     0 -146077.21    0   23 -145955.16 -146077.21  0.08%     -    0s
     0     0 -146045.37    0   16 -145955.16 -146045.37  0.06%     -    0s
     0     0 -146025.56    0   13 -145955.16 -146025.56  0.05%     -    0s
     0     0 -146022.21    0    7 -145955.16 -146022.21  0.05%     -    0s
*    0     0               0    -145988.3558 -145988.36  0.00%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 105
  Flow cover: 2
  RLT: 30

Explored 1 nodes (504 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -145988 -145955 -143867 ... 1.22994e+13
No other solutions better than -145988

Optimal solution found (tolerance 1.00e-04)
Best objective -1.459883558247e+05, best bound -1.459883558247e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 163757.50
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145988.36
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -145988.36 = 163757.50
  [DEBUG]   Current θ from Master = 180428.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16671.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10661.22
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 3104.3401, Absolute Gap = 3104.3401, Relative Gap = 0.113578
  Not converged yet (gap = 3104.34 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481027 nonzeros
Model fingerprint: 0x961fa0fa
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 79101 rows and 32131 columns
Presolve time: 1.35s
Presolved: 90472 rows, 38769 columns, 551416 nonzeros
Variable types: 36510 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -341992.0268
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 666
 AA' NZ     : 2.839e+06
 Factor NZ  : 6.714e+06 (roughly 100 MB of memory)
 Factor Ops : 1.258e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.62133875e+07  1.83707461e+08  1.06e+05 2.19e+01  7.68e+04     2s
   1  -1.22694576e+07  1.61936712e+08  7.45e+04 9.28e+01  5.34e+04     2s
   2  -4.42317756e+06  1.22726778e+08  2.62e+04 7.43e-01  1.96e+04     2s
   3  -1.13430701e+06  8.74575900e+07  2.60e+03 1.11e+00  2.34e+03     2s
   4  -7.42699670e+05  5.71840249e+07  4.85e+02 4.73e-01  6.62e+02     3s
   5  -5.79886635e+05  4.65177205e+07  2.82e+02 3.76e-01  4.59e+02     3s
   6  -4.02389913e+05  3.07794769e+07  9.26e+01 2.33e-01  2.40e+02     3s
   7  -3.36286915e+05  2.13653030e+07  3.28e+01 1.53e-01  1.46e+02     3s
   8  -2.58912413e+05  1.34468153e+07  1.14e+01 9.31e-02  8.67e+01     3s
   9  -1.47663419e+05  9.51126657e+06  3.50e+00 6.51e-02  5.91e+01     3s
  10  -1.02212684e+05  5.91534474e+06  2.03e+00 3.95e-02  3.66e+01     3s
  11  -6.60196952e+04  1.61488534e+06  8.82e-01 1.00e-02  1.02e+01     3s
  12  -1.29908910e+04  5.49914013e+05  2.66e-01 2.82e-03  3.40e+00     3s
  13  -1.19579208e+03  3.21621627e+05  1.87e-01 1.56e-03  1.95e+00     3s
  14   8.05268033e+03  2.27991929e+05  1.38e-01 1.06e-03  1.33e+00     3s
  15   1.38980920e+04  1.81747821e+05  1.11e-01 1.22e-03  1.01e+00     3s
  16   2.62474676e+04  1.38017035e+05  7.00e-02 1.77e-03  6.74e-01     3s
  17   3.09082403e+04  1.08164903e+05  5.81e-02 1.83e-03  4.66e-01     3s
  18   3.76393417e+04  9.57892519e+04  4.14e-02 1.33e-03  3.50e-01     3s
  19   4.33825353e+04  8.53419807e+04  2.92e-02 1.00e-03  2.53e-01     3s
  20   4.74943678e+04  7.78336126e+04  2.14e-02 7.02e-04  1.83e-01     3s
  21   5.00179672e+04  7.44988061e+04  1.66e-02 5.67e-04  1.48e-01     3s
  22   5.10563379e+04  7.04588435e+04  1.48e-02 4.20e-04  1.17e-01     3s
  23   5.24268960e+04  6.82982932e+04  1.24e-02 3.29e-04  9.56e-02     3s
  24   5.35567818e+04  6.61276491e+04  1.05e-02 2.46e-04  7.58e-02     3s
  25   5.50418121e+04  6.44591876e+04  8.07e-03 1.73e-04  5.68e-02     3s
  26   5.54231510e+04  6.38994093e+04  7.44e-03 1.49e-04  5.11e-02     3s
  27   5.69142524e+04  6.29623663e+04  5.16e-03 1.07e-04  3.65e-02     3s
  28   5.77865840e+04  6.25131089e+04  3.80e-03 1.04e-04  2.85e-02     4s
  29   5.81729350e+04  6.20254259e+04  3.19e-03 7.36e-05  2.32e-02     4s
  30   5.85707034e+04  6.14496243e+04  2.60e-03 7.78e-05  1.74e-02     4s
  31   5.90735714e+04  6.10698812e+04  1.82e-03 4.87e-05  1.20e-02     4s
  32   5.94824120e+04  6.08771743e+04  1.26e-03 3.41e-05  8.41e-03     4s
  33   5.97143790e+04  6.07857239e+04  9.21e-04 2.75e-05  6.46e-03     4s
  34   5.99445400e+04  6.07217439e+04  5.97e-04 3.37e-05  4.68e-03     4s
  35   6.00145220e+04  6.05700226e+04  4.98e-04 1.20e-05  3.35e-03     4s
  36   6.00919757e+04  6.05462154e+04  3.94e-04 1.03e-05  2.74e-03     4s
  37   6.01460615e+04  6.05050908e+04  3.22e-04 7.36e-06  2.16e-03     4s
  38   6.02549835e+04  6.04668020e+04  1.80e-04 8.14e-06  1.28e-03     4s
  39   6.02646493e+04  6.04497103e+04  1.68e-04 5.96e-06  1.12e-03     4s
  40   6.03339038e+04  6.04309045e+04  8.10e-05 5.82e-06  5.85e-04     4s
  41   6.03531235e+04  6.04265058e+04  5.75e-05 4.90e-06  4.42e-04     4s
  42   6.03678791e+04  6.04222587e+04  4.00e-05 3.91e-06  3.28e-04     4s
  43   6.03924668e+04  6.04139550e+04  1.09e-05 3.86e-06  1.29e-04     4s
  44   6.03998144e+04  6.04040107e+04  3.12e-06 1.24e-06  2.53e-05     4s
  45   6.04027688e+04  6.04033266e+04  1.90e-07 3.82e-07  3.36e-06     4s
  46   6.04029133e+04  6.04031243e+04  7.05e-08 1.48e-07  1.27e-06     4s
  47   6.04029931e+04  6.04030020e+04  9.47e-09 1.14e-08  5.36e-08     4s
  48   6.04029992e+04  6.04030018e+04  1.10e-08 3.68e-08  1.58e-08     5s
  49   6.04029992e+04  6.04029993e+04  7.34e-08 2.91e-09  2.58e-10     5s

Barrier solved model in 49 iterations and 4.63 seconds (8.10 work units)
Optimal objective 6.04029992e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1772 PPushes remaining with PInf 9.2130624e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2139546e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32401    6.0402999e+04   0.000000e+00   0.000000e+00      6s
   32401    6.0402999e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.040300e+04, 32401 iterations, 4.60 seconds (9.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60402.9993    0  221 -187498.33 60402.9993   132%     -    6s
H    0     0                    -64301.17309 60402.9993   194%     -    6s
H    0     0                    -64156.44069 60402.9993   194%     -    6s
H    0     0                    -51246.12698 60402.9993   218%     -    6s
H    0     0                    -15906.80858 60402.9993   480%     -    7s
H    0     0                    -13911.25338 60402.9993   534%     -    7s
H    0     0                    -13887.18334 60402.9993   535%     -    7s
H    0     0                    -13638.16135 60402.9993   543%     -    7s
H    0     0                    -12027.06042 60402.9993   602%     -    8s
H    0     0                    3177.8431699 60402.9993  1801%     -    8s
H    0     0                    3526.0374474 60402.9993  1613%     -    8s
H    0     0                    4692.4003121 60402.9993  1187%     -    8s
H    0     0                    5133.9656042 60402.9993  1077%     -    8s
H    0     0                    6296.1658832 53338.5922   747%     -   31s
H    0     0                    12360.596562 53338.5922   332%     -   31s
H    0     0                    12586.041698 53338.5922   324%     -   31s
     0     0 52954.5289    0  264 12586.0417 52954.5289   321%     -   31s
     0     0 52384.2458    0  257 12586.0417 52384.2458   316%     -   43s
     0     0 52323.7588    0  265 12586.0417 52323.7588   316%     -   49s
     0     0 52313.3325    0  246 12586.0417 52313.3325   316%     -   59s
     0     0 51940.2165    0  261 12586.0417 51940.2165   313%     -   65s
     0     0 51909.4311    0  266 12586.0417 51909.4311   312%     -   67s
     0     0 51909.4311    0  252 12586.0417 51909.4311   312%     -   68s
     0     0 51905.2211    0  250 12586.0417 51905.2211   312%     -   71s
     0     0 51899.4484    0  250 12586.0417 51899.4484   312%     -   71s
     0     0 51899.4484    0  250 12586.0417 51899.4484   312%     -   72s
H    0     0                    16776.384241 47983.1297   186%     -  105s
     0     0 47983.1297    0  410 16776.3842 47983.1297   186%     -  105s
H    0     0                    21366.154523 47983.1297   125%     -  106s
     0     0 47451.2068    0  392 21366.1545 47451.2068   122%     -  126s
     0     0 47194.8363    0  451 21366.1545 47194.8363   121%     -  139s
     0     0 47092.4077    0  390 21366.1545 47092.4077   120%     -  150s
     0     0 47017.2090    0  436 21366.1545 47017.2090   120%     -  157s
     0     0 47003.5011    0  444 21366.1545 47003.5011   120%     -  161s
     0     0 46962.5598    0  432 21366.1545 46962.5598   120%     -  167s
     0     0 46957.7307    0  442 21366.1545 46957.7307   120%     -  169s
     0     0 46954.3678    0  442 21366.1545 46954.3678   120%     -  171s
     0     0 46950.9997    0  442 21366.1545 46950.9997   120%     -  172s
     0     0 46937.7347    0  442 21366.1545 46937.7347   120%     -  173s
     0     0 46930.0007    0  436 21366.1545 46930.0007   120%     -  176s
     0     0 46929.5449    0  434 21366.1545 46929.5449   120%     -  176s
     0     0 44123.0564    0  329 21366.1545 44123.0564   107%     -  223s
H    0     0                    22376.130565 44122.8809  97.2%     -  223s
H    0     0                    22761.873626 44122.8809  93.8%     -  223s
H    0     0                    23351.700893 44122.8809  88.9%     -  232s
     0     0 43580.0281    0  401 23351.7009 43580.0281  86.6%     -  248s
     0     0 43390.2238    0  415 23351.7009 43390.2238  85.8%     -  259s
     0     0 43262.4271    0  423 23351.7009 43262.4271  85.3%     -  267s
     0     0 43229.8743    0  464 23351.7009 43229.8743  85.1%     -  274s
     0     0 43202.1519    0  420 23351.7009 43202.1519  85.0%     -  279s
     0     0 43169.5247    0  401 23351.7009 43169.5247  84.9%     -  284s
     0     0 43127.0670    0  444 23351.7009 43127.0670  84.7%     -  291s
     0     0 43101.7945    0  402 23351.7009 43101.7945  84.6%     -  297s
     0     0 43091.0887    0  450 23351.7009 43091.0887  84.5%     -  300s
     0     0 43085.8584    0  401 23351.7009 43085.8584  84.5%     -  303s
     0     0 43081.0163    0  408 23351.7009 43081.0163  84.5%     -  304s
     0     0 43075.5871    0  408 23351.7009 43075.5871  84.5%     -  306s
     0     0 43071.5193    0  406 23351.7009 43071.5193  84.4%     -  307s
     0     0 43070.2078    0  405 23351.7009 43070.2078  84.4%     -  308s
     0     0 42107.9880    0  482 23351.7009 42107.9880  80.3%     -  342s
H    0     0                    23660.831029 42107.8630  78.0%     -  342s
     0     0 41979.4961    0  450 23660.8310 41979.4961  77.4%     -  353s
     0     0 41910.4714    0  495 23660.8310 41910.4714  77.1%     -  360s
     0     0 41863.6762    0  488 23660.8310 41863.6762  76.9%     -  367s
     0     0 41811.7288    0  451 23660.8310 41811.7288  76.7%     -  374s
     0     0 41797.5742    0  450 23660.8310 41797.5742  76.7%     -  377s
     0     0 41789.2437    0  442 23660.8310 41789.2437  76.6%     -  379s
     0     0 41780.8208    0  457 23660.8310 41780.8208  76.6%     -  382s
     0     0 41772.8876    0  450 23660.8310 41772.8876  76.5%     -  385s
     0     0 41769.0040    0  447 23660.8310 41769.0040  76.5%     -  386s
     0     0 41768.2591    0  442 23660.8310 41768.2591  76.5%     -  387s
     0     0 41541.7607    0  425 23660.8310 41541.7607  75.6%     -  405s
H    0     0                    23687.415096 41541.5656  75.4%     -  406s
H    0     0                    23727.507540 41541.5656  75.1%     -  406s
H    0     0                    23855.282474 41541.5656  74.1%     -  406s
H    0     0                    24270.003873 41541.5656  71.2%     -  406s
     0     0 41513.0215    0  438 24270.0039 41513.0215  71.0%     -  410s
     0     0 41497.3408    0  441 24270.0039 41497.3408  71.0%     -  413s
     0     0 41491.0646    0  435 24270.0039 41491.0646  71.0%     -  415s
     0     0 41481.8639    0  429 24270.0039 41481.8639  70.9%     -  418s
     0     0 41469.5388    0  432 24270.0039 41469.5388  70.9%     -  421s
     0     0 41462.4272    0  446 24270.0039 41462.4272  70.8%     -  425s
     0     0 41453.7999    0  454 24270.0039 41453.7999  70.8%     -  427s
     0     0 41450.4389    0  446 24270.0039 41450.4389  70.8%     -  430s
     0     0 41446.3005    0  437 24270.0039 41446.3005  70.8%     -  433s
     0     0 41441.4365    0  439 24270.0039 41441.4365  70.8%     -  435s
     0     0 41440.5503    0  442 24270.0039 41440.5503  70.7%     -  436s
     0     0 41309.6150    0  508 24270.0039 41309.6150  70.2%     -  450s
H    0     0                    24270.200806 41309.4883  70.2%     -  455s
H    0     0                    24647.765561 41309.4883  67.6%     -  455s
H    0     0                    25847.150218 41309.4883  59.8%     -  455s
     0     0 41282.5758    0  504 25847.1502 41282.5758  59.7%     -  461s
     0     0 41269.6394    0  439 25847.1502 41269.6394  59.7%     -  465s
     0     0 41266.0369    0  440 25847.1502 41266.0369  59.7%     -  467s
     0     0 41264.8677    0  448 25847.1502 41264.8677  59.6%     -  469s
     0     0 41172.5517    0  406 25847.1502 41172.5517  59.3%     -  480s
     0     0 41155.2714    0  472 25847.1502 41155.2714  59.2%     -  487s
     0     0 41149.3283    0  458 25847.1502 41149.3283  59.2%     -  491s
     0     0 41140.8516    0  462 25847.1502 41140.8516  59.2%     -  495s
     0     0 41138.1039    0  474 25847.1502 41138.1039  59.2%     -  498s
     0     0 41073.8381    0  430 25847.1502 41073.8381  58.9%     -  507s
     0     0 41048.5587    0  385 25847.1502 41048.5587  58.8%     -  515s
     0     0 41034.1644    0  397 25847.1502 41034.1644  58.8%     -  519s
     0     0 41030.3575    0  463 25847.1502 41030.3575  58.7%     -  522s
     0     0 41027.4335    0  448 25847.1502 41027.4335  58.7%     -  524s
     0     0 41005.0251    0  520 25847.1502 41005.0251  58.6%     -  532s
     0     0 40974.5867    0  401 25847.1502 40974.5867  58.5%     -  536s
     0     0 40972.3873    0  402 25847.1502 40972.3873  58.5%     -  538s
     0     0 40956.4605    0  492 25847.1502 40956.4605  58.5%     -  545s
     0     0 40952.8405    0  402 25847.1502 40952.8405  58.4%     -  549s
     0     0 40949.2740    0  402 25847.1502 40949.2740  58.4%     -  554s
     0     0 40948.7273    0  405 25847.1502 40948.7273  58.4%     -  555s
     0     0 40939.4201    0  407 25847.1502 40939.4201  58.4%     -  562s
     0     0 40933.2338    0  477 25847.1502 40933.2338  58.4%     -  567s
     0     0 40931.9997    0  473 25847.1502 40931.9997  58.4%     -  568s
     0     0 40922.9837    0  410 25847.1502 40922.9837  58.3%     -  573s
     0     0 40919.4932    0  472 25847.1502 40919.4932  58.3%     -  591s
     0     0 40918.7905    0  472 25847.1502 40918.7905  58.3%     -  592s
     0     0 40912.9063    0  475 25847.1502 40912.9063  58.3%     -  595s
     0     0 40912.8231    0  475 25847.1502 40912.8231  58.3%     -  597s
     0     2 40912.8231    0  475 25847.1502 40912.8231  58.3%     -  699s
     1     3 40759.9003    1  399 25847.1502 40912.4644  58.3%  6951  707s
     2     4 40851.3128    1  402 25847.1502 40851.3128  58.0%  6527  715s
     3     6 40364.1420    2  394 25847.1502 40851.2664  58.0%  6493  728s
     5    10 40266.3844    3  382 25847.1502 40851.2664  58.0%  8071  754s
     9    20 38821.8128    3  311 25847.1502 40503.6693  56.7% 10925  773s
    19    39 38446.0456    4  325 25847.1502 40253.3118  55.7% 11014  807s
    38    51 38456.9244    5  419 25847.1502 39915.6486  54.4% 16361  887s
H   50    76                    25906.467187 39915.6486  54.1% 16586  929s
    75   160 37742.5757    7  312 25906.4672 39915.6486  54.1% 13318  969s
   159   272 37527.2460    8  307 25906.4672 39915.6486  54.1%  8345  998s
H  184   272                    25922.708536 39915.6486  54.0%  7812  998s
   271   345 37071.5659   12  287 25922.7085 39915.6486  54.0%  6584 1020s
   344   404 36851.3965   13  283 25922.7085 39915.6486  54.0%  6111 1040s
   403   468 36828.0226   14  283 25922.7085 39915.6486  54.0%  5819 1059s
   468   524 36438.3813   16  277 25922.7085 39915.6486  54.0%  5550 1077s
   524   581 35622.6469   17  243 25922.7085 39915.6486  54.0%  5380 1094s
   585   625 35319.0718   18  251 25922.7085 39915.6486  54.0%  5281 1112s
   637   673 32107.7145   28  194 25922.7085 39915.6486  54.0%  5242 1130s
   689   706 34946.9389   18  242 25922.7085 39915.6486  54.0%  5159 1156s
   734   750 33853.1912   19  248 25922.7085 39915.6486  54.0%  5151 1181s
   789   780     cutoff   32      25922.7085 39915.6486  54.0%  5060 1205s
   843   804 32940.4042   20  251 25922.7085 39915.6486  54.0%  5019 1233s
   901   845 32252.6136   22  239 25922.7085 39915.6486  54.0%  4997 1254s
   968   897 31031.1245   24  179 25922.7085 39915.6486  54.0%  4927 1274s
  1061   920 30115.6845   25  175 25922.7085 39915.6486  54.0%  4738 1291s
H 1081   920                    26130.415360 39915.6486  52.8%  4742 1291s
  1122   968 infeasible   26      26130.4154 39915.6486  52.8%  4688 1316s
  1208  1011 26615.1471   27   96 26130.4154 39915.6486  52.8%  4611 1335s
  1277  1098     cutoff   29      26130.4154 39915.6486  52.8%  4500 1357s
H 1309  1098                    26491.179430 39915.6486  50.7%  4496 1357s
  1388  1160     cutoff   31      26491.1794 39915.6486  50.7%  4339 1381s
  1510  1244 29041.7038   20  216 26491.1794 39915.6486  50.7%  4180 1404s
H 1654  1303                    26627.402859 39915.6486  49.9%  4031 1426s
H 1677  1303                    26674.520096 39915.6486  49.6%  4038 1426s
  1745  1375 28355.4560   26  125 26674.5201 39915.6486  49.6%  3969 1450s
  1887  1450 27190.6923   35  119 26674.5201 39915.6486  49.6%  3872 1475s
  2002  1531 36062.9289   12  428 26674.5201 39915.6486  49.6%  3855 1508s
  2115  1613 34435.0062   13  267 26674.5201 39915.6486  49.6%  3807 1535s
  2237  1671 32832.8307   14  252 26674.5201 39915.6486  49.6%  3771 1563s
  2357  1739 31890.5275   15  311 26674.5201 39915.6486  49.6%  3763 1593s
  2465  1824 31215.3629   17  361 26674.5201 39915.6486  49.6%  3772 1626s
  2601  1940     cutoff   18      26674.5201 39566.2745  48.3%  3763 1657s
  2774  2054 infeasible   31      26674.5201 39138.6789  46.7%  3731 1692s
  2944  2077 33445.4218    8  463 26674.5201 39138.6789  46.7%  3710 1717s
  2993  2115 30548.1960    9  371 26674.5201 39138.6789  46.7%  3725 1745s
  3063  2135 30461.6235   10  371 26674.5201 39138.6789  46.7%  3728 1775s
  3103  2150 30426.6729   11  348 26674.5201 39138.6789  46.7%  3752 1805s
  3170  2168 29995.0523   12  354 26674.5201 38533.4888  44.5%  3776 1841s
  3256  2213 28344.0166   14  195 26674.5201 38533.4252  44.5%  3798 1879s
  3335  2267 28542.5471   14  288 26674.5201 38533.4252  44.5%  3814 1913s
  3447  2358 infeasible   16      26674.5201 38533.4252  44.5%  3818 1950s
  3586  2469 34267.9486   11  300 26674.5201 38533.4252  44.5%  3820 1996s
  3763  2615 27252.6696   14  301 26674.5201 38341.2353  43.7%  3808 2044s
  3998  2616 27831.3375   25  475 26674.5201 38341.2353  43.7%  3758 2236s
  4000  2617 33328.6480   24  169 26674.5201 38341.2353  43.7%  3756 2243s
  4001  2618 30425.4576   20  349 26674.5201 38341.2353  43.7%  3755 2287s
  4002  2619 30675.5487   15  372 26674.5201 38341.2353  43.7%  3754 2342s
  4003  2619 36972.2790   17  394 26674.5201 38341.2353  43.7%  3753 2386s
  4004  2620 36635.9611   12  418 26674.5201 38341.2353  43.7%  3752 2423s
  4005  2621 28515.9114   43  473 26674.5201 38341.2353  43.7%  3751 2456s
  4006  2621 29310.0600   14  447 26674.5201 38341.2353  43.7%  3750 2470s
  4007  2622 33690.3980   11  442 26674.5201 38341.2353  43.7%  3749 2493s
  4008  2623 30211.6175   33  436 26674.5201 38341.2353  43.7%  3748 2507s
  4009  2623 28791.9790   20  434 26674.5201 38341.2353  43.7%  3748 2519s
  4010  2624 36001.7470   14  457 26674.5201 38341.2353  43.7%  3747 2531s
  4011  2625 27393.2123   28  456 26674.5201 38341.2353  43.7%  3746 2537s
  4012  2625 30055.2812   28  394 26674.5201 38341.2353  43.7%  3745 2543s
  4013  2626 36770.6177   19  385 26674.5201 38341.2353  43.7%  3744 2555s
  4014  2627 29635.6657   32  449 26674.5201 38341.2353  43.7%  3743 2564s
  4015  2627 34431.2606   14  456 26674.5201 38341.2353  43.7%  3742 2568s
  4016  2628 30408.2665   20  456 26674.5201 38341.2353  43.7%  3741 2575s
  4018  2629 27502.1580   54  447 26674.5201 38341.2353  43.7%  3739 2605s
  4019  2630 27635.7089   55  475 26674.5201 38341.2353  43.7%  3738 2620s
  4020  2631 33726.5447   24  461 26674.5201 38341.2353  43.7%  3737 2628s
  4021  2631 29703.1882   39  459 26674.5201 38341.2353  43.7%  3736 2632s
  4022  2632 29113.7971   27  517 26674.5201 38341.2353  43.7%  3735 2651s
  4023  2633 35686.6046   16  522 26674.5201 38341.2353  43.7%  3734 2664s
  4024  2633 36701.5990   11  475 26674.5201 38341.2353  43.7%  3734 2669s
  4025  2634 37407.6478    9  529 26674.5201 38341.2353  43.7%  3733 2677s
  4026  2635 28736.3726   24  461 26674.5201 38341.2353  43.7%  3732 2694s
  4027  2635 27278.2397   55  488 26674.5201 38341.2353  43.7%  3731 2701s
  4028  2636 27988.0436   59  531 26674.5201 38341.2353  43.7%  3730 2708s
  4029  2637 33683.0226   11  467 26674.5201 38341.2353  43.7%  3729 2716s
  4030  2637 30961.8533    9  525 26674.5201 38341.2353  43.7%  3728 2729s
  4031  2638 28064.8067   25  477 26674.5201 38341.2353  43.7%  3727 2734s
  4032  2639 32179.1080   40  551 26674.5201 38341.2353  43.7%  3726 2750s
  4033  2639 28049.6127   27  542 26674.5201 38341.2353  43.7%  3725 2758s
  4034  2640 37692.0173    5  496 26674.5201 38341.2353  43.7%  3724 2773s
  4035  2641 27800.2408   31  525 26674.5201 38341.2353  43.7%  3723 2783s
  4036  2641 33729.4672    9  549 26674.5201 38341.2353  43.7%  3722 2801s
  4037  2642 36878.2509   11  545 26674.5201 38341.2353  43.7%  3722 2809s
  4038  2643 32730.4695   30  559 26674.5201 38341.2353  43.7%  3721 2818s
  4039  2643 28788.2837   41  500 26674.5201 38341.2353  43.7%  3720 2825s
  4040  2644 29755.0229   35  553 26674.5201 38341.2353  43.7%  3719 2834s
  4041  2645 27197.4016   40  553 26674.5201 38341.2353  43.7%  3718 2848s
  4042  2645 30675.5487   15  553 26674.5201 38341.2353  43.7%  3717 2917s
  4043  2649 38341.2353   11  477 26674.5201 38341.2353  43.7%  3820 3033s
  4045  2652 38341.2353   12  510 26674.5201 38341.2353  43.7%  3824 3081s
  4049  2659 38341.2353   13  465 26674.5201 38341.2353  43.7%  3831 3135s
  4057  2672 38341.2353   14  446 26674.5201 38341.2353  43.7%  3864 3181s
  4073  2683 37955.6914   15  471 26674.5201 38341.2353  43.7%  3939 3250s
  4089  2710 37272.3182   16  485 26674.5201 38341.2353  43.7%  4041 3305s
  4121  2801 36261.6800   17  382 26674.5201 38341.2353  43.7%  4070 3358s
  4223  2822 35509.9445   19  476 26674.5201 38341.2353  43.7%  4247 3388s
  4280  2846 33805.9630   19  418 26674.5201 38341.2353  43.7%  4263 3416s
  4334  2867 34360.6774   18  376 26674.5201 38341.2353  43.7%  4294 3443s
  4408  2885 34691.9395   20  429 26674.5201 38341.2353  43.7%  4299 3483s
  4483  2908 33895.2084   20  396 26674.5201 38341.2353  43.7%  4295 3511s
  4566  2927 33950.1581   19  458 26674.5201 38341.2353  43.7%  4276 3544s
  4635  2928 29134.2275   37   76 26674.5201 38341.2353  43.7%  4267 3563s
  4668  2942 28925.3834   38  231 26674.5201 38341.2353  43.7%  4267 3582s
  4703  2953 28914.1208   39  223 26674.5201 38341.2353  43.7%  4262 3600s

Cutting planes:
  Learned: 2
  Gomory: 18
  Implied bound: 54
  Projected implied bound: 568
  MIR: 1213
  Flow cover: 1990
  RLT: 42
  Relax-and-lift: 378

Explored 4739 nodes (20689301 simplex iterations) in 3600.04 seconds (8744.79 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26674.5 26627.4 26491.2 ... 24270

Time limit reached
Best objective 2.667452009558e+04, best bound 3.834123528203e+04, gap 43.7373%
  WARNING: Time limit reached. Using best solution found (gap: 43.74%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 26674.52, θ = 177053.59
  Upper Bound (UB) = 26674.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 177053.59
  [DEBUG]   ✓ Scenario 0: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 177053.59 ≤ Q = 177053.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 177053.59 ≤ Q = 177053.59 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2c2555d3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd3daaa2d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.406685e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6558017.1192
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.640009e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164000.90    0  129 6558017.12 -164000.90   103%     -    0s
H    0     0                    -127261.9714 -164000.90  28.9%     -    0s
     0     0 -141208.94    0   52 -127261.97 -141208.94  11.0%     -    0s
H    0     0                    -139150.6625 -141188.72  1.46%     -    0s
     0     0 -141063.06    0   66 -139150.66 -141063.06  1.37%     -    0s
H    0     0                    -139883.2528 -141061.91  0.84%     -    0s
     0     0 -141061.91    0   66 -139883.25 -141061.91  0.84%     -    0s
     0     0 -140636.24    0   36 -139883.25 -140636.24  0.54%     -    0s
     0     0 -140626.63    0   35 -139883.25 -140626.63  0.53%     -    0s
     0     0 -140562.08    0   51 -139883.25 -140562.08  0.49%     -    0s
     0     0 -140547.05    0   51 -139883.25 -140547.05  0.47%     -    0s
H    0     0                    -140064.3796 -140547.05  0.34%     -    0s
     0     0 -140547.05    0   77 -140064.38 -140547.05  0.34%     -    0s
     0     0 -140547.05    0   35 -140064.38 -140547.05  0.34%     -    0s
     0     0 -140513.87    0   35 -140064.38 -140513.87  0.32%     -    0s
     0     0 -140510.36    0   36 -140064.38 -140510.36  0.32%     -    0s
     0     0 -140379.76    0   31 -140064.38 -140379.76  0.23%     -    0s
     0     0 -140317.31    0   31 -140064.38 -140317.31  0.18%     -    0s
     0     0 -140317.31    0   31 -140064.38 -140317.31  0.18%     -    0s
H    0     0                    -140066.0704 -140317.31  0.18%     -    0s
     0     0 -140242.89    0   32 -140066.07 -140242.89  0.13%     -    0s
     0     0 -140238.78    0   33 -140066.07 -140238.78  0.12%     -    0s
     0     0 -140151.42    0   33 -140066.07 -140151.42  0.06%     -    0s
     0     0 -140147.60    0   33 -140066.07 -140147.60  0.06%     -    0s
     0     0 -140086.28    0   29 -140066.07 -140086.28  0.01%     -    0s
     0     0 -140082.68    0   28 -140066.07 -140082.68  0.01%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 18
  MIR: 58
  Flow cover: 10
  RLT: 10

Explored 1 nodes (923 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -140066 -139883 -139151 ... 1.40668e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.400660703770e+05, best bound -1.400795869941e+05, gap 0.0097%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 169679.79
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140066.07
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -140066.07 = 169679.79
  [DEBUG]   Current θ from Master = 177053.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7373.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19300.72
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 2446.6061, Absolute Gap = 2446.6061, Relative Gap = 0.091721
  Not converged yet (gap = 2446.61 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524255 nonzeros
Model fingerprint: 0x6a0bfb11
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86312 rows and 35062 columns
Presolve time: 1.49s
Presolved: 98551 rows, 42078 columns, 598763 nonzeros
Variable types: 39819 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338643.6952
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 663
 AA' NZ     : 3.232e+06
 Factor NZ  : 7.746e+06 (roughly 120 MB of memory)
 Factor Ops : 1.505e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68575564e+07  1.97560849e+08  1.10e+05 2.15e+01  7.92e+04     3s
   1  -1.28076102e+07  1.75288877e+08  7.76e+04 9.42e+01  5.52e+04     3s
   2  -3.90120453e+06  1.33812227e+08  2.45e+04 1.00e+00  1.81e+04     3s
   3  -1.35294840e+06  1.06693454e+08  4.28e+03 5.29e+00  3.57e+03     3s
   4  -7.05964752e+05  6.03157982e+07  5.83e+02 1.15e+00  7.08e+02     3s
   5  -4.93568283e+05  4.71749131e+07  4.38e+02 8.01e-01  5.29e+02     3s
   6  -4.69018159e+05  3.32386848e+07  3.99e+02 5.14e-02  4.11e+02     3s
   7  -3.61280745e+05  2.45338551e+07  1.21e+02 3.44e-02  2.02e+02     3s
   8  -2.11708124e+05  1.60438571e+07  2.37e+01 2.07e-02  1.01e+02     3s
   9  -1.71467075e+05  1.03337910e+07  1.57e+01 1.28e-02  6.33e+01     3s
  10  -1.18829096e+05  6.47073433e+06  9.19e+00 7.77e-03  3.86e+01     3s
  11  -7.33424834e+04  3.46333665e+06  3.64e+00 3.90e-03  2.01e+01     3s
  12  -3.55811523e+04  1.97155461e+06  1.43e+00 2.19e-03  1.12e+01     3s
  13  -2.06936374e+04  8.51841002e+05  9.77e-01 8.69e-04  4.87e+00     3s
  14  -1.03027847e+04  5.03227387e+05  7.53e-01 4.92e-04  2.86e+00     3s
  15   2.25704460e+03  2.88776227e+05  4.96e-01 2.49e-04  1.59e+00     3s
  16   1.29340144e+04  2.11217501e+05  3.49e-01 2.16e-04  1.10e+00     3s
  17   1.78119074e+04  1.74002659e+05  2.93e-01 2.07e-04  8.68e-01     3s
  18   2.69991812e+04  1.36686336e+05  2.05e-01 3.60e-04  6.09e-01     3s
  19   3.30372090e+04  1.17284560e+05  1.60e-01 4.32e-04  4.68e-01     3s
  20   3.80429832e+04  9.66242964e+04  1.27e-01 1.35e-03  3.25e-01     3s
  21   4.21741618e+04  8.34007141e+04  1.02e-01 2.04e-03  2.29e-01     3s
  22   4.64523098e+04  7.73343245e+04  7.71e-02 1.96e-03  1.72e-01     3s
  23   4.89677418e+04  7.54529488e+04  6.35e-02 1.58e-03  1.47e-01     4s
  24   5.02740509e+04  7.18984040e+04  5.64e-02 1.59e-03  1.20e-01     4s
  25   5.38600858e+04  6.94695694e+04  3.77e-02 1.75e-03  8.67e-02     4s
  26   5.52505162e+04  6.74734041e+04  3.00e-02 2.50e-03  6.79e-02     4s
  27   5.67563307e+04  6.63349380e+04  2.28e-02 1.98e-03  5.32e-02     4s
  28   5.80449155e+04  6.53493887e+04  1.67e-02 1.51e-03  4.05e-02     4s
  29   5.87393793e+04  6.41969692e+04  1.34e-02 8.13e-04  3.03e-02     4s
  30   5.97222703e+04  6.36964772e+04  9.12e-03 6.56e-04  2.21e-02     4s
  31   6.02930337e+04  6.34696753e+04  6.64e-03 5.72e-04  1.76e-02     4s
  32   6.04547743e+04  6.29931563e+04  5.90e-03 4.03e-04  1.41e-02     4s
  33   6.07642304e+04  6.28047231e+04  4.57e-03 3.40e-04  1.13e-02     4s
  34   6.09013222e+04  6.26938266e+04  3.93e-03 3.01e-04  9.95e-03     4s
  35   6.11601562e+04  6.24007793e+04  2.83e-03 2.01e-04  6.89e-03     4s
  36   6.12662349e+04  6.23614100e+04  2.35e-03 1.87e-04  6.08e-03     4s
  37   6.13148650e+04  6.23261561e+04  2.14e-03 1.75e-04  5.61e-03     4s
  38   6.14099324e+04  6.22432088e+04  1.74e-03 1.46e-04  4.62e-03     4s
  39   6.14841616e+04  6.21382216e+04  1.42e-03 1.06e-04  3.63e-03     4s
  40   6.15293163e+04  6.20878990e+04  1.23e-03 8.79e-05  3.10e-03     4s
  41   6.15874937e+04  6.20466127e+04  9.85e-04 7.15e-05  2.55e-03     4s
  42   6.16374594e+04  6.19498620e+04  7.81e-04 3.85e-05  1.73e-03     5s
  43   6.16532719e+04  6.19145779e+04  7.14e-04 2.66e-05  1.45e-03     5s
  44   6.17097834e+04  6.19052176e+04  4.90e-04 2.35e-05  1.09e-03     5s
  45   6.17415115e+04  6.18878885e+04  3.57e-04 1.73e-05  8.13e-04     5s
  46   6.17783969e+04  6.18746205e+04  2.14e-04 1.26e-05  5.34e-04     5s
  47   6.17909238e+04  6.18613775e+04  1.69e-04 7.68e-06  3.91e-04     5s
  48   6.18016446e+04  6.18605725e+04  1.28e-04 7.42e-06  3.27e-04     5s
  49   6.18050716e+04  6.18500633e+04  1.15e-04 3.82e-06  2.50e-04     5s
  50   6.18201685e+04  6.18418966e+04  5.78e-05 7.56e-06  1.21e-04     5s
  51   6.18258845e+04  6.18404535e+04  3.81e-05 4.84e-06  8.09e-05     5s
  52   6.18293682e+04  6.18396372e+04  2.62e-05 3.49e-06  5.70e-05     5s
  53   6.18308795e+04  6.18383517e+04  2.10e-05 1.44e-06  4.15e-05     5s
  54   6.18332093e+04  6.18378650e+04  1.32e-05 6.11e-07  2.59e-05     5s
  55   6.18366675e+04  6.18375584e+04  2.14e-06 1.99e-07  4.95e-06     5s
  56   6.18373840e+04  6.18373903e+04  6.65e-09 1.12e-08  3.51e-08     5s
  57   6.18373881e+04  6.18373881e+04  4.18e-10 2.55e-10  2.74e-12     5s

Barrier solved model in 57 iterations and 5.41 seconds (9.25 work units)
Optimal objective 6.18373881e+04


Root crossover log...

   84869 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1260 PPushes remaining with PInf 3.5783471e-07                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.8074027e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31944    6.1837388e+04   0.000000e+00   0.000000e+00      7s
   31944    6.1837388e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.183739e+04, 31944 iterations, 5.31 seconds (10.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 61837.3881    0  272 -187498.33 61837.3881   133%     -    7s
H    0     0                    -182901.5130 61837.3881   134%     -    7s
H    0     0                    -117451.8278 61837.3881   153%     -    7s
H    0     0                    -117119.8544 61837.3881   153%     -    7s
H    0     0                    -110103.7832 61837.3881   156%     -    7s
H    0     0                    -104299.7039 61837.3881   159%     -    7s
H    0     0                    -102920.8505 61837.3881   160%     -    8s
H    0     0                    -41565.35615 61837.3881   249%     -    8s
H    0     0                    -30698.72349 61837.3881   301%     -    8s
H    0     0                    -5707.955191 61837.3881  1183%     -    8s
H    0     0                    -5394.673279 61837.3881  1246%     -    8s
H    0     0                    5470.3452127 53453.9855   877%     -   43s
H    0     0                    5779.6923734 53453.9855   825%     -   43s
     0     0 52999.9079    0  282 5779.69237 52999.9079   817%     -   43s
H    0     0                    8405.5557496 52999.9079   531%     -   44s
H    0     0                    8428.5670756 52999.9079   529%     -   44s
H    0     0                    8885.1103752 52999.9079   497%     -   44s
H    0     0                    10750.758550 52999.9079   393%     -   44s
H    0     0                    10886.042356 52999.9079   387%     -   44s
H    0     0                    11005.606324 52999.9079   382%     -   44s
     0     0 52578.1405    0  269 11005.6063 52578.1405   378%     -   60s
     0     0 52486.7131    0  291 11005.6063 52486.7131   377%     -   71s
     0     0 52486.7131    0  285 11005.6063 52486.7131   377%     -   75s
     0     0 52169.7019    0  292 11005.6063 52169.7019   374%     -   80s
     0     0 52169.7019    0  295 11005.6063 52169.7019   374%     -   80s
     0     0 52124.6605    0  276 11005.6063 52124.6605   374%     -   93s
     0     0 52124.6605    0  294 11005.6063 52124.6605   374%     -   96s
     0     0 52124.6605    0  290 11005.6063 52124.6605   374%     -   97s
     0     0 52124.6605    0  288 11005.6063 52124.6605   374%     -   98s
     0     0 52124.6605    0  288 11005.6063 52124.6605   374%     -   98s
     0     0 52124.6605    0  290 11005.6063 52124.6605   374%     -   99s
     0     0 52124.6605    0  296 11005.6063 52124.6605   374%     -  102s
     0     0 52124.6605    0  295 11005.6063 52124.6605   374%     -  103s
     0     0 48039.1292    0  376 11005.6063 48039.1292   336%     -  168s
H    0     0                    12318.738106 48039.0217   290%     -  169s
H    0     0                    13547.766613 48039.0217   255%     -  169s
H    0     0                    13929.896598 48039.0217   245%     -  169s
H    0     0                    13931.519566 48039.0217   245%     -  169s
H    0     0                    14486.394318 48039.0217   232%     -  169s
     0     0 47637.5238    0  396 14486.3943 47637.5238   229%     -  193s
     0     0 47551.7853    0  405 14486.3943 47551.7853   228%     -  202s
     0     0 47409.9505    0  420 14486.3943 47409.9505   227%     -  213s
     0     0 47367.2630    0  432 14486.3943 47367.2630   227%     -  218s
     0     0 47272.6155    0  408 14486.3943 47272.6155   226%     -  226s
     0     0 47205.6694    0  372 14486.3943 47205.6694   226%     -  236s
     0     0 47191.1642    0  385 14486.3943 47191.1642   226%     -  241s
     0     0 47183.4187    0  382 14486.3943 47183.4187   226%     -  242s
     0     0 47179.4092    0  377 14486.3943 47179.4092   226%     -  244s
     0     0 47178.4498    0  375 14486.3943 47178.4498   226%     -  244s
H    0     0                    14547.770352 44350.0025   205%     -  308s
H    0     0                    14566.774624 44350.0025   204%     -  308s
     0     0 44350.0025    0  485 14566.7746 44350.0025   204%     -  308s
H    0     0                    14958.089015 44349.9524   196%     -  309s
     0     0 43855.9519    0  505 14958.0890 43855.9519   193%     -  333s
     0     0 43685.7614    0  516 14958.0890 43685.7614   192%     -  344s
     0     0 43540.9806    0  512 14958.0890 43540.9806   191%     -  355s
H    0     0                    17189.179951 43490.9646   153%     -  362s
H    0     0                    19645.603396 43490.9646   121%     -  362s
H    0     0                    19791.256146 43490.9646   120%     -  362s
H    0     0                    19846.668186 43490.9646   119%     -  362s
H    0     0                    19870.670632 43490.9646   119%     -  362s
H    0     0                    20036.758568 43490.9646   117%     -  362s
H    0     0                    20286.022812 43490.9646   114%     -  362s
H    0     0                    20522.039955 43490.9646   112%     -  362s
     0     0 43490.9646    0  517 20522.0400 43490.9646   112%     -  362s
     0     0 43458.1303    0  506 20522.0400 43458.1303   112%     -  367s
     0     0 43435.3640    0  507 20522.0400 43435.3640   112%     -  369s
     0     0 43414.0854    0  495 20522.0400 43414.0854   112%     -  373s
     0     0 43394.6587    0  503 20522.0400 43394.6587   111%     -  377s
     0     0 43381.6154    0  503 20522.0400 43381.6154   111%     -  380s
     0     0 43374.9764    0  506 20522.0400 43374.9764   111%     -  382s
     0     0 43364.9175    0  511 20522.0400 43364.9175   111%     -  384s
     0     0 43363.0238    0  498 20522.0400 43363.0238   111%     -  386s
H    0     0                    24245.036190 42150.3497  73.9%     -  431s
H    0     0                    24258.440137 42150.3497  73.8%     -  431s
H    0     0                    24289.810888 42150.3497  73.5%     -  431s
H    0     0                    24437.888783 42150.3497  72.5%     -  431s
     0     0 42150.3497    0  504 24437.8888 42150.3497  72.5%     -  431s
     0     0 41839.5316    0  501 24437.8888 41839.5316  71.2%     -  451s
     0     0 41765.9095    0  513 24437.8888 41765.9095  70.9%     -  461s
     0     0 41729.6129    0  517 24437.8888 41729.6129  70.8%     -  468s
     0     0 41664.9908    0  513 24437.8888 41664.9908  70.5%     -  477s
     0     0 41646.2621    0  509 24437.8888 41646.2621  70.4%     -  481s
     0     0 41635.3991    0  501 24437.8888 41635.3991  70.4%     -  485s
     0     0 41622.8184    0  511 24437.8888 41622.8184  70.3%     -  488s
     0     0 41617.6293    0  513 24437.8888 41617.6293  70.3%     -  491s
     0     0 41614.7381    0  511 24437.8888 41614.7381  70.3%     -  492s
     0     0 41310.6260    0  515 24437.8888 41310.6260  69.0%     -  515s
     0     0 41244.5550    0  527 24437.8888 41244.5550  68.8%     -  527s
     0     0 41209.1318    0  526 24437.8888 41209.1318  68.6%     -  535s
     0     0 41188.4428    0  514 24437.8888 41188.4428  68.5%     -  542s
     0     0 41181.6338    0  517 24437.8888 41181.6338  68.5%     -  546s
     0     0 41177.7293    0  524 24437.8888 41177.7293  68.5%     -  548s
     0     0 41147.7664    0  517 24437.8888 41147.7664  68.4%     -  552s
     0     0 41145.5725    0  517 24437.8888 41145.5725  68.4%     -  554s
     0     0 41020.7828    0  450 24437.8888 41020.7828  67.9%     -  566s
H    0     0                    24453.911245 41020.6436  67.7%     -  569s
     0     0 40968.2400    0  458 24453.9112 40968.2400  67.5%     -  578s
     0     0 40961.9537    0  459 24453.9112 40961.9537  67.5%     -  581s
     0     0 40954.1047    0  463 24453.9112 40954.1047  67.5%     -  586s
     0     0 40952.0555    0  455 24453.9112 40952.0555  67.5%     -  588s
     0     0 40883.8604    0  465 24453.9112 40883.8604  67.2%     -  606s
     0     0 40856.5346    0  453 24453.9112 40856.5346  67.1%     -  614s
     0     0 40843.1840    0  459 24453.9112 40843.1840  67.0%     -  619s
     0     0 40833.3457    0  468 24453.9112 40833.3457  67.0%     -  623s
     0     0 40830.2035    0  464 24453.9112 40830.2035  67.0%     -  625s
     0     0 40794.0363    0  514 24453.9112 40794.0363  66.8%     -  638s
     0     0 40783.3519    0  508 24453.9112 40783.3519  66.8%     -  643s
     0     0 40779.2792    0  510 24453.9112 40779.2792  66.8%     -  646s
     0     0 40770.9204    0  510 24453.9112 40770.9204  66.7%     -  651s
     0     0 40764.2122    0  528 24453.9112 40764.2122  66.7%     -  654s
     0     0 40762.4731    0  512 24453.9112 40762.4731  66.7%     -  656s
     0     0 40739.1061    0  513 24453.9112 40739.1061  66.6%     -  665s
     0     0 40724.3916    0  518 24453.9112 40724.3916  66.5%     -  670s
     0     0 40722.9738    0  460 24453.9112 40722.9738  66.5%     -  671s
     0     0 40720.2457    0  456 24453.9112 40720.2457  66.5%     -  673s
H    0     0                    25308.556891 40720.2249  60.9%     -  682s
     0     0 40717.3867    0  464 25308.5569 40717.3867  60.9%     -  686s
     0     0 40707.8803    0  475 25308.5569 40707.8803  60.8%     -  692s
     0     0 40706.3361    0  494 25308.5569 40706.3361  60.8%     -  695s
     0     0 40703.3084    0  534 25308.5569 40703.3084  60.8%     -  699s
     0     0 40703.1213    0  534 25308.5569 40703.1213  60.8%     -  701s
H    0     0                    25381.081317 40703.1197  60.4%     -  797s
H    0     0                    25481.060799 40703.1197  59.7%     -  797s
H    0     0                    25553.598079 40703.1197  59.3%     -  799s
H    0     2                    25600.715316 40703.1197  59.0%     -  826s
     0     2 40703.1197    0  534 25600.7153 40703.1197  59.0%     -  826s
     1     4 40423.4390    1  462 25600.7153 40702.8714  59.0% 12177  840s
     3     8 40173.0811    2  463 25600.7153 40423.2797  57.9% 11095  867s
     7    16 40078.5060    3  489 25600.7153 40172.8502  56.9% 13337  891s
    15    31 40018.2336    4  531 25600.7153 40078.4282  56.6% 12991  927s
    30    46 38415.0571    5  443 25600.7153 40018.2052  56.3% 19840 1001s
    45    77 33348.6349    6  273 25600.7153 40018.2052  56.3% 17368 1098s
H   58    77                    25649.846164 40018.2052  56.0% 16835 1098s
    76   220 32869.3521    7  272 25649.8462 40018.2052  56.0% 16004 1150s
   219   282 29460.8144   12  179 25649.8462 40018.2052  56.0%  9844 1171s
   281   311 29224.0583   13  175 25649.8462 40018.2052  56.0%  8634 1190s
   310   347 28880.6412   14  174 25649.8462 40018.2052  56.0%  8367 1210s
   346   383 28866.1547   15  164 25649.8462 40018.2052  56.0%  8063 1231s
   382   428 35710.4678   12  406 25649.8462 40018.2052  56.0%  7786 1257s
   427   480 28288.4912   16  175 25649.8462 40018.2052  56.0%  7494 1288s
   483   519 28121.1038   17  162 25649.8462 40018.2052  56.0%  7083 1317s
H  505   519                    25683.383174 40018.2052  55.8%  6976 1317s
   530   563 28038.6861   18  160 25683.3832 40018.2052  55.8%  6850 1342s
   590   598     cutoff   20      25683.3832 40018.2052  55.8%  6603 1364s
   639   640 34441.4410   14  342 25683.3832 40018.2052  55.8%  6539 1388s
   693   683 34937.1737   14  261 25683.3832 40018.2052  55.8%  6409 1410s
   754   734 34076.1789   14  264 25683.3832 40018.2052  55.8%  6248 1430s
   831   790 33776.7511   14  278 25683.3832 40018.2052  55.8%  5977 1449s
   905   861 33343.5406   20  287 25683.3832 40018.2052  55.8%  5764 1468s
   991   911 32764.9568   22  310 25683.3832 40018.2052  55.8%  5520 1488s
  1073   965 32367.1403   25  293 25683.3832 40018.2052  55.8%  5402 1510s
  1151  1053 30712.1584   31  288 25683.3832 40018.2052  55.8%  5307 1532s
  1253  1138 30053.7446   33  282 25683.3832 40018.2052  55.8%  5126 1555s
  1362  1273 28499.7269   41  233 25683.3832 40018.2052  55.8%  4944 1577s
  1536  1305 28286.7932   50  221 25683.3832 40018.2052  55.8%  4609 1599s
  1582  1320 27771.7994   60  197 25683.3832 40018.2052  55.8%  4573 1621s
H 1623  1357                    26148.427083 40018.2052  53.0%  4544 1648s
  1710  1347     cutoff   69      26148.4271 40018.2052  53.0%  4434 1673s
H 1729  1347                    26358.903677 40018.2052  51.8%  4419 1673s
  1761  1458 28871.3766   37  281 26358.9037 40018.2052  51.8%  4393 1700s
H 1932  1474                    26660.805118 40018.2052  50.1%  4204 1732s
H 1945  1474                    26769.726948 40018.2052  49.5%  4194 1732s
  1983  1495     cutoff   51      26769.7269 40018.2052  49.5%  4193 1785s
  2108  1514 36734.1235    8  260 26769.7269 40018.2052  49.5%  4141 1814s
  2143  1539 36118.8309    9  263 26769.7269 40018.2052  49.5%  4207 1844s
H 2154  1539                    26772.721458 40018.2052  49.5%  4229 1844s
  2184  1624 35593.6156   10  253 26772.7215 40018.2052  49.5%  4254 1884s
  2287  1688 34067.8556   11  243 26772.7215 40018.2052  49.5%  4249 1918s
  2407  1749 30283.7455   12  321 26772.7215 40018.2052  49.5%  4224 1955s
  2530  1766 30008.3113   14  261 26772.7215 40018.2052  49.5%  4181 1991s
  2670  1784 29760.2154   14  228 26772.7215 40018.2052  49.5%  4169 2025s
H 2701  1772                    26838.467305 40018.2052  49.1%  4230 2025s
  2704  1826 29668.3498   15  190 26838.4673 40018.2052  49.1%  4232 2074s
  2826  1872     cutoff   44      26838.4673 39804.1558  48.3%  4253 2119s
  2908  1900 38994.1747    6  452 26838.4673 39803.2915  48.3%  4303 2157s
H 2917  1895                    26881.554719 39803.2915  48.1%  4314 2157s
H 2921  1868                    27020.262613 39803.2915  47.3%  4320 2157s
  2962  1983 37821.7654    7  349 27020.2626 39803.2915  47.3%  4346 2197s
  3127  2100 33559.2630    8  446 27020.2626 39803.2915  47.3%  4317 2240s
  3310  2255 31235.5798   10  288 27020.2626 39803.2915  47.3%  4294 2287s
  3521  2434 30023.3125   12  291 27020.2626 39205.4761  45.1%  4247 2334s
H 3774  2428                    27051.006624 38993.3123  44.1%  4150 2364s
  3775  2429 34789.1701   11  534 27051.0066 38993.3123  44.1%  4149 2571s
  3777  2430 29711.4642   42  150 27051.0066 38993.3123  44.1%  4146 2581s
  3778  2431 29663.1859   31  321 27051.0066 38993.3123  44.1%  4145 2647s
  3779  2432 31144.4669   38  322 27051.0066 38993.3123  44.1%  4144 2703s
  3780  2432 36666.3714    5  368 27051.0066 38993.3123  44.1%  4143 2746s
  3781  2433 30073.8355   48  422 27051.0066 38993.3123  44.1%  4142 2781s
  3782  2434 34485.2201   18  454 27051.0066 38993.3123  44.1%  4141 2808s
  3783  2434 29906.3035   36  421 27051.0066 38993.3123  44.1%  4140 2838s
  3784  2435 27954.3132   40  444 27051.0066 38993.3123  44.1%  4139 2859s
  3785  2436 33983.5127   16  458 27051.0066 38993.3123  44.1%  4138 2879s
  3786  2436 37613.1520   11  494 27051.0066 38993.3123  44.1%  4137 2897s
  3787  2437 27424.2087   31  440 27051.0066 38993.3123  44.1%  4135 2918s
  3788  2438 32006.1834   17  445 27051.0066 38993.3123  44.1%  4134 2933s
  3789  2438 30480.7063   44  436 27051.0066 38993.3123  44.1%  4133 2942s
  3790  2439 27667.7823   46  439 27051.0066 38993.3123  44.1%  4132 2950s
  3791  2440 28061.6003   24  476 27051.0066 38993.3123  44.1%  4131 2955s
  3792  2440 35781.3968    9  444 27051.0066 38993.3123  44.1%  4130 2961s
  3793  2441 29627.5020   26  476 27051.0066 38993.3123  44.1%  4129 2965s
  3795  2442 28592.4118   32  491 27051.0066 38993.3123  44.1%  4127 2973s
  3796  2443 37078.1979   11  496 27051.0066 38993.3123  44.1%  4126 2992s
  3797  2444 30406.8154   27  447 27051.0066 38993.3123  44.1%  4125 3001s
  3798  2444 33816.2492   16  453 27051.0066 38993.3123  44.1%  4124 3006s
  3799  2445 29124.1634   20  503 27051.0066 38993.3123  44.1%  4122 3013s
  3800  2446 28730.1740   24  517 27051.0066 38993.3123  44.1%  4121 3025s
  3801  2446 34926.3116   15  463 27051.0066 38993.3123  44.1%  4120 3030s
  3802  2447 28651.5857   19  465 27051.0066 38993.3123  44.1%  4119 3036s
  3803  2448 35346.7253    8  502 27051.0066 38993.3123  44.1%  4118 3052s
  3804  2448 32494.9415   18  464 27051.0066 38993.3123  44.1%  4117 3061s
  3805  2449 29443.1154   57  449 27051.0066 38993.3123  44.1%  4116 3068s
  3806  2450 37498.0565    8  499 27051.0066 38993.3123  44.1%  4115 3074s
  3807  2450 31855.7691   16  446 27051.0066 38993.3123  44.1%  4114 3087s
  3808  2451 37136.7073   11  475 27051.0066 38993.3123  44.1%  4113 3101s
  3809  2452 35352.8845   10  468 27051.0066 38993.3123  44.1%  4112 3109s
  3810  2452 34157.9685   13  460 27051.0066 38993.3123  44.1%  4111 3115s
  3811  2453 29460.2453   25  522 27051.0066 38993.3123  44.1%  4109 3136s
  3812  2454 28817.7818   17  521 27051.0066 38993.3123  44.1%  4108 3144s
  3813  2454 29212.7825   24  461 27051.0066 38993.3123  44.1%  4107 3150s
  3814  2455 30036.5121   18  522 27051.0066 38993.3123  44.1%  4106 3163s
  3815  2456 33983.5127   16  522 27051.0066 38993.3123  44.1%  4105 3168s
  3816  2456 30292.3831   66  525 27051.0066 38993.3123  44.1%  4104 3176s
  3817  2457 29496.6723   26  511 27051.0066 38993.3123  44.1%  4103 3187s
  3818  2458 29663.1859   31  524 27051.0066 38993.3123  44.1%  4102 3192s
  3819  2458 35996.6891   16  441 27051.0066 38993.3123  44.1%  4101 3202s
  3820  2459 30029.9449   21  567 27051.0066 38993.3123  44.1%  4100 3208s
  3821  2460 29582.3284   31  536 27051.0066 38993.3123  44.1%  4099 3220s
  3822  2460 27634.8792   32  526 27051.0066 38993.3123  44.1%  4098 3225s
  3823  2461 29927.3956   28  527 27051.0066 38993.3123  44.1%  4097 3230s
  3824  2462 27739.4053   51  537 27051.0066 38993.3123  44.1%  4095 3236s
  3825  2462 27457.2214   26  534 27051.0066 38993.3123  44.1%  4094 3241s
  3826  2463 28372.8804   39  534 27051.0066 38993.3123  44.1%  4093 3256s
  3827  2464 28493.6622   21  534 27051.0066 38993.3123  44.1%  4092 3358s
  3828  2467 38993.3123   10  508 27051.0066 38993.3123  44.1%  4225 3411s
  3830  2471 38993.3123   11  519 27051.0066 38993.3123  44.1%  4232 3464s
  3834  2477 38993.3123   12  495 27051.0066 38993.3123  44.1%  4243 3515s
  3842  2491 38993.3123   13  469 27051.0066 38993.3123  44.1%  4260 3562s

Cutting planes:
  Learned: 2
  Gomory: 10
  Implied bound: 43
  Projected implied bound: 392
  MIR: 1067
  Mixing: 1
  Flow cover: 1180
  RLT: 39
  Relax-and-lift: 353

Explored 3858 nodes (17381990 simplex iterations) in 3600.03 seconds (8427.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27051 27020.3 26881.6 ... 25683.4

Time limit reached
Best objective 2.705100662436e+04, best bound 3.899331233304e+04, gap 44.1474%
  WARNING: Time limit reached. Using best solution found (gap: 44.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 27051.01, θ = 177458.72
  Upper Bound (UB) = 27051.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 177458.72
  [DEBUG]   ✓ Scenario 0: θ = 177458.72 ≤ Q = 177458.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 177458.72 ≤ Q = 177458.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 177458.72 ≤ Q = 177458.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 177458.72 ≤ Q = 177458.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 177458.72 ≤ Q = 177458.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 177458.72 ≤ Q = 177458.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 177458.72 ≤ Q = 177458.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 177458.72 ≤ Q = 177458.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 177458.72 ≤ Q = 177458.72 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 177458.72 ≤ Q = 177458.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 177458.72 ≤ Q = 177458.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 177458.72 ≤ Q = 177458.72 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3bb6921
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfc4496df
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-13, 2e+02]
Found heuristic solution: objective 1.393902e+13
Presolve removed 2607 rows and 1899 columns
Presolve time: 0.00s
Presolved: 486 rows, 490 columns, 1375 nonzeros
Found heuristic solution: objective 6568450.7748
Variable types: 332 continuous, 158 integer (158 binary)

Root relaxation: objective -1.665268e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166526.80    0  131 6568450.77 -166526.80   103%     -    0s
H    0     0                    -130172.5902 -166526.80  27.9%     -    0s
H    0     0                    -142775.9548 -149764.85  4.90%     -    0s
H    0     0                    -146671.4423 -149764.85  2.11%     -    0s
     0     0 -149764.85    0   55 -146671.44 -149764.85  2.11%     -    0s
H    0     0                    -148653.4402 -149697.10  0.70%     -    0s
     0     0 -149616.61    0   34 -148653.44 -149616.61  0.65%     -    0s
H    0     0                    -149213.8738 -149511.00  0.20%     -    0s
     0     0 -149490.10    0   53 -149213.87 -149490.10  0.19%     -    0s
     0     0 -149345.81    0   23 -149213.87 -149345.81  0.09%     -    0s
     0     0 -149332.65    0   13 -149213.87 -149332.65  0.08%     -    0s
     0     0 -149326.79    0    7 -149213.87 -149326.79  0.08%     -    0s
     0     0 -149247.02    0    5 -149213.87 -149247.02  0.02%     -    0s
     0     0 -149247.02    0    6 -149213.87 -149247.02  0.02%     -    0s
H    0     0                    -149232.5088 -149247.02  0.01%     -    0s

Explored 1 nodes (527 simplex iterations) in 0.04 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -149233 -149214 -148951 ... 1.3939e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.492325087876e+05, best bound -1.492470196885e+05, gap 0.0097%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 160513.35
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149232.51
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -149232.51 = 160513.35
  [DEBUG]   Current θ from Master = 177458.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16945.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10105.64
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 2823.0926, Absolute Gap = 2823.0926, Relative Gap = 0.104362
  Not converged yet (gap = 2823.09 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567483 nonzeros
Model fingerprint: 0x94f49547
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93503 rows and 37983 columns
Presolve time: 1.59s
Presolved: 106650 rows, 45397 columns, 645111 nonzeros
Variable types: 43138 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -336512.8701
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 656
 AA' NZ     : 3.646e+06
 Factor NZ  : 9.592e+06 (roughly 140 MB of memory)
 Factor Ops : 2.922e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73992814e+07  2.11416219e+08  1.14e+05 2.11e+01  8.12e+04     3s
   1  -1.34227307e+07  1.88701636e+08  8.04e+04 9.35e+01  5.66e+04     3s
   2  -7.21253442e+06  1.46173365e+08  4.15e+04 1.49e+00  3.04e+04     3s
   3  -1.13188872e+06  1.10340744e+08  3.28e+03 1.85e+00  2.86e+03     3s
   4  -6.00304700e+05  4.81020150e+07  5.65e+02 2.63e-01  5.93e+02     3s
   5  -4.75893955e+05  2.69953657e+07  3.30e+02 1.06e-01  3.21e+02     3s
   6  -4.10453237e+05  2.14870062e+07  2.32e+02 7.83e-02  2.32e+02     3s
   7  -2.98319531e+05  1.67919676e+07  9.33e+01 5.77e-02  1.32e+02     3s
   8  -1.48226508e+05  1.20205631e+07  2.11e+01 3.72e-02  7.09e+01     3s
   9  -1.12047065e+05  8.19347514e+06  1.40e+01 2.43e-02  4.68e+01     3s
  10  -8.19103424e+04  4.68262423e+06  7.48e+00 1.31e-02  2.58e+01     3s
  11  -5.40577561e+04  1.32950694e+06  3.40e+00 3.18e-03  7.32e+00     3s
  12  -1.05611986e+04  4.49395717e+05  1.09e+00 1.00e-03  2.39e+00     3s
  13  -4.79869255e+02  2.89328292e+05  7.97e-01 7.72e-04  1.50e+00     3s
  14   7.23785994e+03  1.93149846e+05  6.12e-01 9.09e-04  9.60e-01     3s
  15   1.23597426e+04  1.58100095e+05  5.01e-01 9.15e-04  7.52e-01     3s
  16   2.19737864e+04  1.30568954e+05  3.21e-01 9.52e-04  5.59e-01     4s
  17   3.00319504e+04  1.13271691e+05  2.31e-01 9.45e-04  4.28e-01     4s
  18   3.36574841e+04  9.68148472e+04  1.97e-01 1.32e-03  3.25e-01     4s
  19   3.83461982e+04  8.59250050e+04  1.58e-01 1.83e-03  2.45e-01     4s
  20   4.33420250e+04  7.79331479e+04  1.16e-01 1.82e-03  1.78e-01     4s
  21   4.62716916e+04  7.28405487e+04  9.49e-02 2.10e-03  1.37e-01     4s
  22   4.84110455e+04  6.89807120e+04  7.89e-02 1.71e-03  1.06e-01     4s
  23   4.99694750e+04  6.80059528e+04  6.86e-02 1.52e-03  9.28e-02     4s
  24   5.22036833e+04  6.69123398e+04  5.35e-02 1.34e-03  7.57e-02     4s
  25   5.38180774e+04  6.54077616e+04  4.24e-02 1.47e-03  5.96e-02     4s
  26   5.51941900e+04  6.39163953e+04  3.36e-02 1.07e-03  4.49e-02     4s
  27   5.59526728e+04  6.32471963e+04  2.87e-02 9.66e-04  3.75e-02     4s
  28   5.66360616e+04  6.28335783e+04  2.46e-02 1.09e-03  3.19e-02     4s
  29   5.73419127e+04  6.23736738e+04  2.03e-02 1.32e-03  2.59e-02     4s
  30   5.80301115e+04  6.20185476e+04  1.63e-02 9.32e-04  2.05e-02     4s
  31   5.83281016e+04  6.19118132e+04  1.45e-02 8.46e-04  1.84e-02     4s
  32   5.87704988e+04  6.17786412e+04  1.19e-02 7.20e-04  1.55e-02     4s
  33   5.90243312e+04  6.14255218e+04  1.04e-02 4.36e-04  1.24e-02     4s
  34   5.93016699e+04  6.13112102e+04  8.81e-03 3.45e-04  1.03e-02     5s
  35   5.96216124e+04  6.12537295e+04  7.00e-03 2.95e-04  8.40e-03     5s
  36   5.98604295e+04  6.11220159e+04  5.64e-03 1.93e-04  6.49e-03     5s
  37   6.01567619e+04  6.10307111e+04  3.97e-03 1.19e-04  4.50e-03     5s
  38   6.03425209e+04  6.09951482e+04  2.94e-03 1.05e-04  3.36e-03     5s
  39   6.03914830e+04  6.09714404e+04  2.68e-03 8.98e-05  2.99e-03     5s
  40   6.05150023e+04  6.09626551e+04  2.01e-03 7.77e-05  2.30e-03     5s
  41   6.06880418e+04  6.09545915e+04  1.07e-03 6.74e-05  1.37e-03     5s
  42   6.08590466e+04  6.09209074e+04  1.64e-04 4.28e-05  3.18e-04     5s
  43   6.08660136e+04  6.09153214e+04  1.34e-04 3.25e-05  2.53e-04     5s
  44   6.08868862e+04  6.09080577e+04  3.91e-05 1.89e-05  1.09e-04     5s
  45   6.08951743e+04  6.09001478e+04  5.11e-06 5.63e-06  2.55e-05     5s
  46   6.08961722e+04  6.08983533e+04  1.88e-06 2.60e-06  1.12e-05     5s
  47   6.08967526e+04  6.08968357e+04  3.01e-08 9.90e-08  4.26e-07     5s
  48   6.08967729e+04  6.08967730e+04  9.03e-10 5.04e-09  7.95e-10     5s

Barrier solved model in 48 iterations and 5.42 seconds (8.99 work units)
Optimal objective 6.08967729e+04


Root crossover log...

   91920 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    5857 PPushes remaining with PInf 3.1339886e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.9214466e+02      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42858    6.0896773e+04   0.000000e+00   7.921447e+02      8s
   42905    6.0896773e+04   0.000000e+00   0.000000e+00      8s
   42905    6.0896773e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.20s

Solved with barrier

Root relaxation: objective 6.089677e+04, 42905 iterations, 6.41 seconds (13.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60896.7730    0  257 -187498.33 60896.7730   132%     -    8s
H    0     0                    -153644.4978 60896.7730   140%     -    9s
H    0     0                    -152402.5675 60896.7730   140%     -    9s
H    0     0                    -38919.51698 60896.7730   256%     -    9s
H    0     0                    -18493.91598 60896.7730   429%     -    9s
H    0     0                    1405.8840361 60896.7730  4232%     -    9s
H    0     0                    2954.8488716 60896.7730  1961%     -    9s
H    0     0                    14811.706682 54268.4929   266%     -   41s
     0     0 54268.4929    0  318 14811.7067 54268.4929   266%     -   41s
     0     0 53862.9814    0  326 14811.7067 53862.9814   264%     -   56s
     0     0 53799.4115    0  331 14811.7067 53799.4115   263%     -   59s
     0     0 53497.7260    0  335 14811.7067 53497.7260   261%     -   70s
     0     0 53492.2107    0  336 14811.7067 53492.2107   261%     -   73s
     0     0 53433.8439    0  333 14811.7067 53433.8439   261%     -   79s
     0     0 53352.8011    0  337 14811.7067 53352.8011   260%     -   85s
     0     0 53350.2219    0  342 14811.7067 53350.2219   260%     -   86s
     0     0 53339.3806    0  347 14811.7067 53339.3806   260%     -   88s
     0     0 53338.6915    0  347 14811.7067 53338.6915   260%     -   89s
     0     0 49511.2399    0  402 14811.7067 49511.2399   234%     -  149s
H    0     0                    22949.523574 49510.9380   116%     -  150s
H    0     0                    23855.692781 49510.9380   108%     -  150s
H    0     0                    24156.621048 49510.9380   105%     -  150s
     0     0 48606.9248    0  408 24156.6210 48606.9248   101%     -  193s
     0     0 48466.6994    0  421 24156.6210 48466.6994   101%     -  211s
     0     0 48409.8938    0  441 24156.6210 48409.8938   100%     -  226s
     0     0 48357.1290    0  447 24156.6210 48357.1290   100%     -  241s
     0     0 48331.0499    0  454 24156.6210 48331.0499   100%     -  250s
     0     0 48307.4476    0  455 24156.6210 48307.4476   100%     -  259s
     0     0 48073.0222    0  421 24156.6210 48073.0222  99.0%     -  284s
     0     0 48039.0860    0  468 24156.6210 48039.0860  98.9%     -  295s
     0     0 48033.0746    0  434 24156.6210 48033.0746  98.8%     -  299s
     0     0 48021.0910    0  486 24156.6210 48021.0910  98.8%     -  303s
     0     0 48017.6630    0  487 24156.6210 48017.6630  98.8%     -  304s
     0     0 47999.2541    0  482 24156.6210 47999.2541  98.7%     -  310s
     0     0 47975.9220    0  475 24156.6210 47975.9220  98.6%     -  316s
     0     0 47965.3076    0  497 24156.6210 47965.3076  98.6%     -  321s
     0     0 47946.8399    0  494 24156.6210 47946.8399  98.5%     -  326s
     0     0 47941.8640    0  495 24156.6210 47941.8640  98.5%     -  327s
     0     0 47941.5233    0  495 24156.6210 47941.5233  98.5%     -  329s
     0     0 45011.6852    0  422 24156.6210 45011.6852  86.3%     -  421s
H    0     0                    25467.819306 45011.6585  76.7%     -  421s
H    0     0                    25540.356586 45011.6585  76.2%     -  422s
     0     0 44323.1543    0  498 25540.3566 44323.1543  73.5%     -  456s
     0     0 44103.2375    0  505 25540.3566 44103.2375  72.7%     -  476s
     0     0 44029.3708    0  486 25540.3566 44029.3708  72.4%     -  486s
     0     0 43938.1223    0  498 25540.3566 43938.1223  72.0%     -  498s
     0     0 43865.4049    0  488 25540.3566 43865.4049  71.7%     -  509s
     0     0 43855.8262    0  487 25540.3566 43855.8262  71.7%     -  513s
     0     0 43848.8506    0  491 25540.3566 43848.8506  71.7%     -  517s
     0     0 43834.3304    0  488 25540.3566 43834.3304  71.6%     -  522s
     0     0 43813.9386    0  500 25540.3566 43813.9386  71.5%     -  525s
     0     0 43804.4994    0  485 25540.3566 43804.4994  71.5%     -  528s
     0     0 43741.9763    0  480 25540.3566 43741.9763  71.3%     -  538s
     0     0 43725.0596    0  481 25540.3566 43725.0596  71.2%     -  543s
     0     0 43700.6649    0  477 25540.3566 43700.6649  71.1%     -  546s
     0     0 43693.0397    0  497 25540.3566 43693.0397  71.1%     -  548s
     0     0 43688.1015    0  493 25540.3566 43688.1015  71.1%     -  550s
     0     0 43686.9866    0  491 25540.3566 43686.9866  71.1%     -  551s
     0     0 42381.1883    0  474 25540.3566 42381.1883  65.9%     -  602s
     0     0 42166.0604    0  509 25540.3566 42166.0604  65.1%     -  625s
     0     0 42065.9969    0  505 25540.3566 42065.9969  64.7%     -  644s
     0     0 42041.5899    0  503 25540.3566 42041.5899  64.6%     -  653s
     0     0 42032.9733    0  516 25540.3566 42032.9733  64.6%     -  659s
     0     0 41991.0291    0  518 25540.3566 41991.0291  64.4%     -  669s
     0     0 41972.5961    0  518 25540.3566 41972.5961  64.3%     -  675s
     0     0 41968.0414    0  518 25540.3566 41968.0414  64.3%     -  678s
     0     0 41962.8440    0  524 25540.3566 41962.8440  64.3%     -  680s
     0     0 41959.9224    0  514 25540.3566 41959.9224  64.3%     -  683s
     0     0 41433.8188    0  477 25540.3566 41433.8188  62.2%     -  714s
     0     0 41293.1081    0  513 25540.3566 41293.1081  61.7%     -  732s
     0     0 41243.0271    0  526 25540.3566 41243.0271  61.5%     -  742s
     0     0 41221.5404    0  479 25540.3566 41221.5404  61.4%     -  749s
     0     0 41204.7942    0  482 25540.3566 41204.7942  61.3%     -  754s
     0     0 41192.8978    0  558 25540.3566 41192.8978  61.3%     -  758s
     0     0 41187.3837    0  479 25540.3566 41187.3837  61.3%     -  761s
     0     0 41174.9625    0  549 25540.3566 41174.9625  61.2%     -  765s
     0     0 41173.4031    0  552 25540.3566 41173.4031  61.2%     -  767s
     0     0 41057.2068    0  472 25540.3566 41057.2068  60.8%     -  785s
H    0     0                    25575.940974 41057.1529  60.5%     -  794s
     0     0 40996.8338    0  532 25575.9410 40996.8338  60.3%     -  807s
     0     0 40976.7643    0  516 25575.9410 40976.7643  60.2%     -  815s
     0     0 40970.6556    0  520 25575.9410 40970.6556  60.2%     -  818s
     0     0 40967.3749    0  521 25575.9410 40967.3749  60.2%     -  821s
     0     0 40928.5595    0  408 25575.9410 40928.5595  60.0%     -  830s
     0     0 40903.0852    0  466 25575.9410 40903.0852  59.9%     -  842s
     0     0 40894.7429    0  470 25575.9410 40894.7429  59.9%     -  848s
     0     0 40888.4858    0  470 25575.9410 40888.4858  59.9%     -  851s
     0     0 40887.0801    0  467 25575.9410 40887.0801  59.9%     -  853s
     0     0 40853.5691    0  389 25575.9410 40853.5691  59.7%     -  865s
     0     0 40851.6080    0  381 25575.9410 40851.6080  59.7%     -  869s
     0     0 40841.6421    0  410 25575.9410 40841.6421  59.7%     -  878s
     0     0 40839.0935    0  400 25575.9410 40839.0935  59.7%     -  883s
     0     0 40817.9908    0  396 25575.9410 40817.9908  59.6%     -  894s
     0     0 40817.9584    0  396 25575.9410 40817.9584  59.6%     -  896s
H    0     0                    26387.326453 40817.9584  54.7%     - 1037s
     0     2 40817.9584    0  396 26387.3265 40817.9584  54.7%     - 1072s
     1     4 40788.8877    1  382 26387.3265 40817.9535  54.7%  3611 1090s
     3     8 40498.3418    2  417 26387.3265 40785.1518  54.6%  9372 1130s
     7    15 40288.7108    3  429 26387.3265 40498.0957  53.5% 13246 1211s
    14    30 40071.6461    4  433 26387.3265 40287.4719  52.7% 19903 1251s
    29    45 38299.3018    5  414 26387.3265 40071.5803  51.9% 24372 2538s
    44    77 38113.5570    6  409 26387.3265 40071.5803  51.9% 35052 2899s
    76   177 37888.5492    7  363 26387.3265 39821.3025  50.9% 25798 2979s
   176   208 37723.6721   10  361 26387.3265 39821.2505  50.9% 16641 3010s
   207   235 37710.5674   11  364 26387.3265 39821.2505  50.9% 14937 3041s
   234   266 37329.4650   12  368 26387.3265 39821.2505  50.9% 14049 3072s
   265   302 37258.3511   13  344 26387.3265 39821.2505  50.9% 13534 3100s
   301   336 37080.8602   14  275 26387.3265 39821.2505  50.9% 12895 3129s
   335   366 37054.2066   15  282 26387.3265 39821.2505  50.9% 12363 3163s
   365   402 36970.5159   16  333 26387.3265 39821.2505  50.9% 11910 3192s
   401   438 35500.3436   17  255 26387.3265 39821.2505  50.9% 11745 3227s
H  415   438                    26444.319075 39821.2505  50.6% 11582 3227s
   437   467 35238.1306   18  246 26444.3191 39821.2505  50.6% 11346 3265s
H  467   467                    26491.436311 39821.2505  50.3% 11271 3265s
   468   531 34943.2542   19  236 26491.4363 39821.2505  50.3% 11262 3328s
   532   584 33820.8521   21  238 26491.4363 39821.2505  50.3% 10992 3360s
   595   623 33446.2587   23  225 26491.4363 39821.2505  50.3% 11161 3393s
   640   664 33080.0282   24  204 26491.4363 39821.2505  50.3% 11099 3424s
   695   708     cutoff   25      26491.4363 39821.2505  50.3% 11089 3456s
   759   775 29158.2520   25  175 26491.4363 39821.2505  50.3% 11012 3486s
   848   846 27948.4548   26  181 26491.4363 39821.2505  50.3% 10606 3519s
   945   911 27141.3515   27  157 26491.4363 39760.9287  50.1% 10077 3550s
  1073  1039 29389.9088   35  276 26491.4363 39760.9287  50.1%  9642 3580s
  1247  1132 39181.3955    7  339 26491.4363 39760.9287  50.1%  8781 3600s

Cutting planes:
  Learned: 1
  Gomory: 9
  Implied bound: 252
  MIR: 3726
  Flow cover: 2958
  Inf proof: 1
  RLT: 132
  Relax-and-lift: 1514

Explored 1437 nodes (12257927 simplex iterations) in 3600.08 seconds (7101.48 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26491.4 26444.3 26387.3 ... 14811.7

Time limit reached
Best objective 2.649143631136e+04, best bound 3.976092866016e+04, gap 50.0897%
  WARNING: Time limit reached. Using best solution found (gap: 50.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 26491.44, θ = 176889.21
  Upper Bound (UB) = 26491.44

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176889.21
  [DEBUG]   ✓ Scenario 0: θ = 176889.21 ≤ Q = 176889.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176889.21 ≤ Q = 176889.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176889.21 ≤ Q = 176889.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176889.21 ≤ Q = 176889.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176889.21 ≤ Q = 176889.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176889.21 ≤ Q = 176889.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176889.21 ≤ Q = 176889.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176889.21 ≤ Q = 176889.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 176889.21 ≤ Q = 176889.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 176889.21 ≤ Q = 176889.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 176889.21 ≤ Q = 176889.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 176889.21 ≤ Q = 176889.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 176889.21 ≤ Q = 176889.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x26fa88df
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd9057721
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.407656e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6582753.4647
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.634959e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163495.87    0  124 6582753.46 -163495.87   102%     -    0s
H    0     0                    -130614.1414 -163495.87  25.2%     -    0s
     0     0 -142178.69    0   66 -130614.14 -142178.69  8.85%     -    0s
H    0     0                    -139553.6419 -142173.97  1.88%     -    0s
H    0     0                    -140099.7908 -142173.97  1.48%     -    0s
H    0     0                    -140159.3343 -142173.97  1.44%     -    0s
H    0     0                    -140705.4833 -142173.97  1.04%     -    0s
     0     0 -141364.24    0   77 -140705.48 -141364.24  0.47%     -    0s
     0     0 -141280.76    0   61 -140705.48 -141280.76  0.41%     -    0s
     0     0 -141257.65    0   70 -140705.48 -141257.65  0.39%     -    0s
     0     0 -141257.19    0   70 -140705.48 -141257.19  0.39%     -    0s
     0     0 -140910.82    0   27 -140705.48 -140910.82  0.15%     -    0s
     0     0 -140903.74    0   28 -140705.48 -140903.74  0.14%     -    0s
     0     0 -140842.37    0   34 -140705.48 -140842.37  0.10%     -    0s
     0     0 -140841.52    0   18 -140705.48 -140841.52  0.10%     -    0s
     0     0 -140835.61    0   18 -140705.48 -140835.61  0.09%     -    0s
     0     0 -140798.88    0    9 -140705.48 -140798.88  0.07%     -    0s
     0     0 -140798.88    0   18 -140705.48 -140798.88  0.07%     -    0s
     0     0 -140726.91    0    4 -140705.48 -140726.91  0.02%     -    0s
H    0     0                    -140723.6357 -140723.99  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 3
  MIR: 12
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (758 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -140724 -140705 -140159 ... 1.40766e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.407236357109e+05, best bound -1.407239878530e+05, gap 0.0003%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 169022.23
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140723.64
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -140723.64 = 169022.23
  [DEBUG]   Current θ from Master = 176889.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7866.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18624.45
  Lower Bound (LB) = 24227.91
  Gap (UB-LB) = 2263.5223, Absolute Gap = 2263.5223, Relative Gap = 0.085444
  Not converged yet (gap = 2263.52 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610711 nonzeros
Model fingerprint: 0xe41bb0a1
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100714 rows and 40914 columns
Presolve time: 2.34s
Presolved: 114729 rows, 48706 columns, 693205 nonzeros
Variable types: 46447 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -344813.6556
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.98s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 4.130e+06
 Factor NZ  : 9.979e+06 (roughly 150 MB of memory)
 Factor Ops : 1.983e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79516134e+07  2.25645060e+08  1.17e+05 1.91e+01  8.33e+04     4s
   1  -1.38966478e+07  2.02389882e+08  8.30e+04 9.33e+01  5.81e+04     4s
   2  -7.55485158e+06  1.57124040e+08  4.33e+04 3.81e+00  3.15e+04     5s
   3  -1.16462957e+06  1.18357726e+08  3.36e+03 1.69e+00  2.91e+03     5s
   4  -6.24498649e+05  4.67767991e+07  5.54e+02 2.49e-01  5.60e+02     5s
   5  -4.86971410e+05  3.00147723e+07  3.13e+02 1.29e-01  3.19e+02     5s
   6  -3.71570222e+05  2.24437962e+07  1.51e+02 8.75e-02  1.87e+02     5s
   7  -2.82384958e+05  1.70089127e+07  7.72e+01 6.29e-02  1.18e+02     5s
   8  -1.49501895e+05  1.24091634e+07  1.85e+01 4.27e-02  6.69e+01     5s
   9  -1.24972050e+05  9.56823118e+06  1.42e+01 3.19e-02  5.06e+01     5s
  10  -8.52969652e+04  5.64449351e+06  7.02e+00 1.80e-02  2.87e+01     5s
  11  -4.88207368e+04  1.17560920e+06  2.48e+00 3.33e-03  5.98e+00     5s
  12  -1.01350109e+04  4.23110124e+05  1.15e+00 1.41e-03  2.09e+00     5s
  13   2.13914643e+02  2.63775139e+05  8.05e-01 1.21e-03  1.27e+00     5s
  14   8.14870948e+03  1.91164493e+05  6.19e-01 9.00e-04  8.80e-01     5s
  15   1.52875824e+04  1.58077703e+05  4.77e-01 8.35e-04  6.85e-01     5s
  16   2.08757139e+04  1.16152736e+05  3.88e-01 9.71e-04  4.57e-01     5s
  17   2.72866203e+04  9.72120913e+04  3.16e-01 1.77e-03  3.35e-01     5s
  18   3.41906319e+04  8.66294958e+04  2.45e-01 2.44e-03  2.52e-01     5s
  19   3.82515030e+04  8.05027164e+04  2.06e-01 2.31e-03  2.03e-01     5s
  20   4.14495801e+04  7.53433521e+04  1.75e-01 1.98e-03  1.63e-01     5s
  21   4.54932628e+04  7.14635419e+04  1.37e-01 1.66e-03  1.25e-01     5s
  22   4.78114364e+04  6.94353159e+04  1.16e-01 1.52e-03  1.04e-01     6s
  23   5.10584078e+04  6.76370904e+04  8.62e-02 1.95e-03  7.95e-02     6s
  24   5.29408545e+04  6.62477571e+04  6.90e-02 1.62e-03  6.38e-02     6s
  25   5.42803180e+04  6.47397155e+04  5.69e-02 1.33e-03  5.02e-02     6s
  26   5.55357371e+04  6.37670922e+04  4.58e-02 8.75e-04  3.95e-02     6s
  27   5.71160153e+04  6.30687934e+04  3.23e-02 1.05e-03  2.85e-02     6s
  28   5.79488823e+04  6.25224672e+04  2.56e-02 1.39e-03  2.19e-02     6s
  29   5.88593871e+04  6.21908885e+04  1.85e-02 1.05e-03  1.60e-02     6s
  30   5.90826318e+04  6.21183544e+04  1.68e-02 9.45e-04  1.46e-02     6s
  31   5.93119500e+04  6.19625617e+04  1.50e-02 8.95e-04  1.27e-02     6s
  32   5.97697276e+04  6.16834708e+04  1.14e-02 5.53e-04  9.18e-03     6s
  33   6.05538119e+04  6.15959972e+04  5.21e-03 4.87e-04  4.99e-03     6s
  34   6.07145619e+04  6.14793926e+04  4.01e-03 3.03e-04  3.67e-03     6s
  35   6.08724138e+04  6.14467915e+04  2.83e-03 2.55e-04  2.75e-03     6s
  36   6.09979026e+04  6.13810513e+04  1.95e-03 1.53e-04  1.84e-03     6s
  37   6.11096451e+04  6.13610830e+04  1.13e-03 1.24e-04  1.20e-03     6s
  38   6.11550826e+04  6.13088368e+04  8.19e-04 4.69e-05  7.37e-04     6s
  39   6.11884523e+04  6.13070208e+04  5.95e-04 4.40e-05  5.68e-04     6s
  40   6.12023760e+04  6.12967010e+04  4.97e-04 2.91e-05  4.52e-04     7s
  41   6.12165303e+04  6.12959891e+04  4.00e-04 2.80e-05  3.81e-04     7s
  42   6.12465965e+04  6.12901804e+04  1.93e-04 1.91e-05  2.09e-04     7s
  43   6.12474075e+04  6.12889630e+04  1.87e-04 1.74e-05  1.99e-04     7s
  44   6.12521371e+04  6.12851586e+04  1.56e-04 1.18e-05  1.58e-04     7s
  45   6.12701170e+04  6.12836444e+04  3.88e-05 9.64e-06  6.47e-05     7s
  46   6.12758209e+04  6.12784924e+04  4.21e-06 2.28e-06  1.27e-05     7s
  47   6.12765791e+04  6.12766835e+04  2.69e-07 1.11e-06  4.99e-07     7s
  48   6.12766430e+04  6.12766430e+04  3.84e-10 8.43e-10  4.51e-11     7s

Barrier solved model in 48 iterations and 7.10 seconds (10.36 work units)
Optimal objective 6.12766430e+04


Root crossover log...

  100884 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    1688 PPushes remaining with PInf 5.4601122e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.9051062e-11      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37693    6.1276643e+04   0.000000e+00   0.000000e+00      9s
   37693    6.1276643e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.127664e+04, 37693 iterations, 5.94 seconds (10.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 61276.6430    0  207 -187498.33 61276.6430   133%     -    9s
H    0     0                    -183913.9878 61276.6430   133%     -    9s
H    0     0                    -117447.7491 61276.6430   152%     -    9s
H    0     0                    -98347.47366 61276.6430   162%     -    9s
H    0     0                    -97821.07063 61276.6430   163%     -    9s
H    0     0                    -44687.92282 61276.6430   237%     -    9s
H    0     0                    -1518.045427 61276.6430  4137%     -    9s
H    0     0                    -1018.239964 61276.6430  6118%     -    9s
H    0     0                     910.3000868 61276.6430  6631%     -   10s
H    0     0                    5690.9180437 54466.2486   857%     -   45s
H    0     0                    6490.4676726 54466.2486   739%     -   45s
H    0     0                    16955.818976 54466.2486   221%     -   45s
H    0     0                    17476.392915 54466.2486   212%     -   45s
     0     0 54431.7071    0  281 17476.3929 54431.7071   211%     -   45s
H    0     0                    17711.367610 54431.7071   207%     -   45s
H    0     0                    18129.117326 54431.7071   200%     -   46s
H    0     0                    18190.551177 54431.7071   199%     -   46s
     0     0 53797.0253    0  277 18190.5512 53797.0253   196%     -   66s
     0     0 53748.3723    0  274 18190.5512 53748.3723   195%     -   71s
     0     0 53706.4672    0  275 18190.5512 53706.4672   195%     -   74s
     0     0 53592.9357    0  284 18190.5512 53592.9357   195%     -   82s
     0     0 53578.8917    0  285 18190.5512 53578.8917   195%     -   86s
     0     0 53555.5743    0  288 18190.5512 53555.5743   194%     -   90s
     0     0 53555.5743    0  274 18190.5512 53555.5743   194%     -   97s
     0     0 53553.8068    0  275 18190.5512 53553.8068   194%     -   98s
     0     0 53547.7478    0  279 18190.5512 53547.7478   194%     -  100s
     0     0 53547.3499    0  279 18190.5512 53547.3499   194%     -  101s
H    0     0                    20129.125565 48970.6428   143%     -  159s
H    0     0                    20213.569239 48970.6428   142%     -  159s
H    0     0                    20932.815704 48970.6428   134%     -  159s
H    0     0                    21024.898323 48970.6428   133%     -  159s
     0     0 48970.6428    0  461 21024.8983 48970.6428   133%     -  160s
H    0     0                    24779.113577 48967.6922  97.6%     -  160s
H    0     0                    25555.403241 48967.6922  91.6%     -  160s
     0     0 48452.7377    0  452 25555.4032 48452.7377  89.6%     -  193s
     0     0 48313.0888    0  489 25555.4032 48313.0888  89.1%     -  207s
     0     0 48117.4026    0  469 25555.4032 48117.4026  88.3%     -  222s
     0     0 48047.0829    0  453 25555.4032 48047.0829  88.0%     -  229s
     0     0 47994.8620    0  449 25555.4032 47994.8620  87.8%     -  235s
     0     0 47957.8999    0  462 25555.4032 47957.8999  87.7%     -  242s
     0     0 47906.7480    0  487 25555.4032 47906.7480  87.5%     -  251s
     0     0 47851.9188    0  479 25555.4032 47851.9188  87.2%     -  260s
     0     0 47812.3900    0  489 25555.4032 47812.3900  87.1%     -  265s
     0     0 47805.6674    0  491 25555.4032 47805.6674  87.1%     -  270s
     0     0 47766.5424    0  497 25555.4032 47766.5424  86.9%     -  276s
     0     0 47760.3538    0  499 25555.4032 47760.3538  86.9%     -  279s
     0     0 47703.9188    0  485 25555.4032 47703.9188  86.7%     -  287s
     0     0 47684.3871    0  493 25555.4032 47684.3871  86.6%     -  291s
     0     0 47676.7975    0  492 25555.4032 47676.7975  86.6%     -  294s
     0     0 47674.2980    0  492 25555.4032 47674.2980  86.6%     -  296s
     0     0 47639.7970    0  487 25555.4032 47639.7970  86.4%     -  301s
     0     0 47635.1052    0  492 25555.4032 47635.1052  86.4%     -  305s
     0     0 47618.8787    0  501 25555.4032 47618.8787  86.3%     -  308s
     0     0 47618.8247    0  506 25555.4032 47618.8247  86.3%     -  308s
     0     0 44693.5941    0  486 25555.4032 44693.5941  74.9%     -  370s
     0     0 44013.6586    0  518 25555.4032 44013.6586  72.2%     -  409s
     0     0 43534.1302    0  530 25555.4032 43534.1302  70.4%     -  436s
     0     0 43418.4340    0  528 25555.4032 43418.4340  69.9%     -  458s
     0     0 43326.2501    0  536 25555.4032 43326.2501  69.5%     -  472s
     0     0 43302.5404    0  538 25555.4032 43302.5404  69.4%     -  478s
     0     0 43281.5028    0  533 25555.4032 43281.5028  69.4%     -  484s
     0     0 43259.8106    0  541 25555.4032 43259.8106  69.3%     -  490s
     0     0 43230.7958    0  556 25555.4032 43230.7958  69.2%     -  498s
     0     0 43218.3541    0  560 25555.4032 43218.3541  69.1%     -  503s
     0     0 43152.1398    0  538 25555.4032 43152.1398  68.9%     -  515s
     0     0 43143.1980    0  565 25555.4032 43143.1980  68.8%     -  522s
     0     0 43128.2701    0  557 25555.4032 43128.2701  68.8%     -  527s
     0     0 43120.3178    0  558 25555.4032 43120.3178  68.7%     -  532s
     0     0 43116.7230    0  555 25555.4032 43116.7230  68.7%     -  535s
     0     0 43114.2742    0  566 25555.4032 43114.2742  68.7%     -  536s
     0     0 41994.4310    0  529 25555.4032 41994.4310  64.3%     -  593s
     0     0 41729.4489    0  544 25555.4032 41729.4489  63.3%     -  620s
     0     0 41611.1431    0  540 25555.4032 41611.1431  62.8%     -  635s
     0     0 41586.2081    0  533 25555.4032 41586.2081  62.7%     -  642s
     0     0 41573.8781    0  562 25555.4032 41573.8781  62.7%     -  649s
     0     0 41567.3485    0  532 25555.4032 41567.3485  62.7%     -  653s
     0     0 41557.7606    0  543 25555.4032 41557.7606  62.6%     -  659s
     0     0 41537.8510    0  532 25555.4032 41537.8510  62.5%     -  668s
     0     0 41533.4022    0  552 25555.4032 41533.4022  62.5%     -  673s
     0     0 41521.1060    0  539 25555.4032 41521.1060  62.5%     -  680s
     0     0 41517.1935    0  517 25555.4032 41517.1935  62.5%     -  684s
     0     0 41511.1167    0  528 25555.4032 41511.1167  62.4%     -  688s
     0     0 41507.5952    0  535 25555.4032 41507.5952  62.4%     -  691s
     0     0 41506.4841    0  544 25555.4032 41506.4841  62.4%     -  693s
     0     0 41344.3586    0  487 25555.4032 41344.3586  61.8%     -  722s
     0     0 41325.2347    0  452 25555.4032 41325.2347  61.7%     -  734s
     0     0 41311.9816    0  535 25555.4032 41311.9816  61.7%     -  741s
     0     0 41301.3166    0  447 25555.4032 41301.3166  61.6%     -  749s
     0     0 41296.9250    0  451 25555.4032 41296.9250  61.6%     -  753s
     0     0 41294.9809    0  447 25555.4032 41294.9809  61.6%     -  757s
     0     0 41127.8605    0  468 25555.4032 41127.8605  60.9%     -  781s
     0     0 41077.9765    0  539 25555.4032 41077.9765  60.7%     -  805s
     0     0 41058.2611    0  517 25555.4032 41058.2611  60.7%     -  815s
     0     0 41051.6202    0  521 25555.4032 41051.6202  60.6%     -  823s
     0     0 41050.4896    0  509 25555.4032 41050.4896  60.6%     -  825s
     0     0 40992.3469    0  554 25555.4032 40992.3469  60.4%     -  845s
     0     0 40947.4249    0  530 25555.4032 40947.4249  60.2%     -  862s
     0     0 40936.5926    0  478 25555.4032 40936.5926  60.2%     -  871s
     0     0 40931.3392    0  479 25555.4032 40931.3392  60.2%     -  875s
     0     0 40929.2856    0  469 25555.4032 40929.2856  60.2%     -  878s
     0     0 40884.9078    0  541 25555.4032 40884.9078  60.0%     -  897s
     0     0 40861.2443    0  545 25555.4032 40861.2443  59.9%     -  916s
     0     0 40847.1183    0  554 25555.4032 40847.1183  59.8%     -  925s
     0     0 40840.5260    0  557 25555.4032 40840.5260  59.8%     -  931s
     0     0 40836.1331    0  557 25555.4032 40836.1331  59.8%     -  937s
     0     0 40834.1130    0  558 25555.4032 40834.1130  59.8%     -  940s
     0     0 40823.1294    0  531 25555.4032 40823.1294  59.7%     -  952s
     0     0 40820.9119    0  480 25555.4032 40820.9119  59.7%     -  956s
     0     0 40817.0465    0  492 25555.4032 40817.0465  59.7%     -  962s
     0     0 40811.2829    0  477 25555.4032 40811.2829  59.7%     -  969s
     0     0 40810.2528    0  490 25555.4032 40810.2528  59.7%     -  972s
     0     0 40795.9802    0  489 25555.4032 40795.9802  59.6%     -  985s
     0     0 40795.3762    0  489 25555.4032 40795.3762  59.6%     -  988s
     0     2 40795.3762    0  489 25555.4032 40795.3762  59.6%     - 1140s
     1     3 39889.7266    1  428 25555.4032 40795.3762  59.6% 16102 1164s
     2     4 40635.7059    1  410 25555.4032 40635.7059  59.0% 10948 1177s
     3     7 40537.4525    2  535 25555.4032 40635.7001  59.0% 10207 1197s
     6    13 40011.4022    3  421 25555.4032 40537.4139  58.6% 12296 1236s
    12    24 39563.9884    4  420 25555.4032 40537.4139  58.6% 15450 1279s
    23    35 38664.5866    5  506 25555.4032 40010.5566  56.6% 23269 1372s
    34    65 38522.9153    5  480 25555.4032 39563.9582  54.8% 20460 1497s
H   44    65                    25981.379222 39563.9582  52.3% 18342 1497s
    64    97 38054.6790    6  413 25981.3792 39563.9582  52.3% 23237 1660s
H   96   161                    26113.811567 39563.9582  51.5% 23924 1732s
H   98   161                    26387.326453 39563.9582  49.9% 23567 1732s
H  145   161                    26404.226630 39563.9582  49.8% 18068 1732s
   160   292 37552.2343    9  390 26404.2266 39563.9582  49.8% 16996 1803s
   291   375 37049.9509   13  369 26404.2266 39563.9582  49.8% 12189 1850s
   374   438 36835.4045   16  362 26404.2266 39563.9582  49.8% 10905 1887s
   437   496 36650.7601   19  294 26404.2266 39563.9582  49.8% 10343 1927s
   495   556 36261.9876   21  283 26404.2266 39563.9582  49.8%  9826 1962s
   555   627 35595.1176   25  268 26404.2266 39563.9582  49.8%  9459 1995s
   630   699 35369.6027   26  260 26404.2266 39563.9582  49.8%  8983 2030s
   702   778 35088.9682   31  268 26404.2266 39563.9582  49.8%  8724 2059s
   783   835 34584.0159   36  245 26404.2266 39563.9582  49.8%  8270 2086s
   848   884 33855.1708   40  234 26404.2266 39563.9582  49.8%  8055 2115s
   903   950 33473.1854   43  228 26404.2266 39563.9582  49.8%  7919 2148s
   981  1013 infeasible   46      26404.2266 39563.9582  49.8%  7686 2179s
  1060  1081 28346.2073   48  202 26404.2266 39563.9582  49.8%  7452 2210s
  1138  1158 infeasible   53      26404.2266 39563.9582  49.8%  7255 2243s
  1239  1213 26647.9621   53  270 26404.2266 39563.9582  49.8%  7007 2280s
  1329  1264 infeasible   55      26404.2266 39563.9582  49.8%  6811 2315s
  1427  1282 34971.7249   26  251 26404.2266 39563.9582  49.8%  6680 2353s
  1501  1348 35209.1710   26  365 26404.2266 39563.9582  49.8%  6655 2395s
  1591  1443 30848.3659   27  191 26404.2266 39563.9582  49.8%  6606 2438s
  1716  1543 28739.1077   30  355 26404.2266 39563.9582  49.8%  6439 2477s
  1871  1630 26779.0647   37  155 26404.2266 39563.9582  49.8%  6224 2519s
  2037  1741 27661.1791   34  218 26404.2266 39563.9582  49.8%  6069 2564s
  2211  1906 27303.3835   37  182 26404.2266 39563.9582  49.8%  5893 2609s
  2418  2036     cutoff   44      26404.2266 39563.9582  49.8%  5662 2655s
  2618  2208 infeasible   46      26404.2266 39563.9582  49.8%  5468 2696s
  2873  2309 infeasible   48      26404.2266 39139.5246  48.2%  5233 2740s
  3033  2431 35448.8826    8  399 26404.2266 38650.8715  46.4%  5106 2790s
  3209  2499 34718.1401    9  275 26404.2266 38407.1039  45.5%  4990 2839s
  3326  2558 34053.3585   10  251 26404.2266 38407.1039  45.5%  4944 2895s
  3443  2636 33072.9385   11  237 26404.2266 38230.5795  44.8%  4937 2953s
  3549  2724 32021.8419   12  272 26404.2266 38230.5795  44.8%  4977 3016s
  3675  2789 31949.5141   13  214 26404.2266 38230.5795  44.8%  5013 3077s

Cutting planes:
  Learned: 7
  Gomory: 11
  Implied bound: 327
  MIR: 3813
  Flow cover: 3130
  RLT: 121
  Relax-and-lift: 1286

Explored 3788 nodes (19979722 simplex iterations) in 3600.03 seconds (8382.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26404.2 26387.3 26113.8 ... 20129.1

Time limit reached
Best objective 2.640422663029e+04, best bound 3.823057948473e+04, gap 44.7896%
  WARNING: Time limit reached. Using best solution found (gap: 44.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 26404.23, θ = 176894.32
  Upper Bound (UB) = 26404.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176894.32
  [DEBUG]   ✓ Scenario 0: θ = 176894.32 ≤ Q = 176894.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176894.32 ≤ Q = 176894.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176894.32 ≤ Q = 176894.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 176894.32 ≤ Q = 176894.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 176894.32 ≤ Q = 176894.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 176894.32 ≤ Q = 176894.32 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x276693be
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd8996c42
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.404088e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6573930.1344
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.634738e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163473.79    0  124 6573930.13 -163473.79   102%     -    0s
H    0     0                    -130609.0336 -163473.79  25.2%     -    0s
     0     0 -135370.17    0   58 -130609.03 -135370.17  3.65%     -    0s
H    0     0                    -134849.1011 -135349.91  0.37%     -    0s
     0     0 -134976.93    0    8 -134849.10 -134976.93  0.09%     -    0s
     0     0 -134955.12    0    6 -134849.10 -134955.12  0.08%     -    0s
H    0     0                    -134915.3972 -134953.14  0.03%     -    0s
     0     0 -134949.40    0    6 -134915.40 -134949.40  0.03%     -    0s
     0     0          -    0      -134915.40 -134924.09  0.01%     -    0s

Cutting planes:
  Gomory: 33
  Implied bound: 3
  MIR: 141
  Flow cover: 2
  RLT: 6

Explored 1 nodes (428 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -134915 -134849 -130609 ... 1.40409e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.349153971980e+05, best bound -1.349240863755e+05, gap 0.0064%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 174830.46
  Scenario: 5 demand increases, 55 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134915.40
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -134915.40 = 174830.46
  [DEBUG]   Current θ from Master = 176894.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2063.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24340.37
  Lower Bound (LB) = 24340.37
  Gap (UB-LB) = 2063.8566, Absolute Gap = 2063.8566, Relative Gap = 0.078164
  Not converged yet (gap = 2063.86 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 5 increases, 55 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653939 nonzeros
Model fingerprint: 0x11165355
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 107925 rows and 43845 columns
Presolve time: 2.09s
Presolved: 122808 rows, 52015 columns, 756958 nonzeros
Variable types: 49756 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.88s

Barrier statistics:
 Dense cols : 679
 AA' NZ     : 5.089e+06
 Factor NZ  : 1.145e+07 (roughly 160 MB of memory)
 Factor Ops : 2.422e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85821850e+07  2.39371663e+08  1.23e+05 2.02e+01  8.59e+04     4s
   1  -1.44075408e+07  2.14690533e+08  8.78e+04 9.20e+01  6.06e+04     4s
   2  -4.71045824e+06  1.65755607e+08  2.91e+04 3.31e+00  2.12e+04     4s
   3  -8.85914502e+05  1.10348752e+08  2.22e+03 4.18e-01  2.00e+03     4s
   4  -5.46390058e+05  4.32544811e+07  4.48e+02 5.43e-02  4.62e+02     4s
   5  -3.99955222e+05  2.88574022e+07  2.42e+02 2.37e-02  2.63e+02     4s
   6  -2.86736695e+05  2.02164882e+07  5.90e+01 1.69e-02  1.21e+02     5s
   7  -2.04788026e+05  1.40716245e+07  2.90e+01 1.16e-02  7.54e+01     5s
   8  -1.42280619e+05  9.33892376e+06  1.38e+01 7.49e-03  4.65e+01     5s
   9  -1.23157970e+05  6.28267999e+06  8.98e+00 4.80e-03  3.05e+01     5s
  10  -9.98149282e+04  2.53478740e+06  5.12e+00 1.68e-03  1.23e+01     5s
  11  -6.04805776e+04  4.97985153e+05  1.62e+00 2.55e-04  2.54e+00     5s
  12  -1.71129431e+04  2.80283375e+05  5.99e-01 4.97e-04  1.34e+00     5s
  13  -1.79335426e+03  1.98596509e+05  4.51e-01 5.48e-04  9.00e-01     5s
  14   6.36230015e+03  1.43398551e+05  3.76e-01 1.49e-03  6.16e-01     5s
  15   1.57396212e+04  1.23284424e+05  3.00e-01 1.64e-03  4.83e-01     5s
  16   2.21308120e+04  9.90598815e+04  2.49e-01 2.22e-03  3.46e-01     5s
  17   2.75047792e+04  8.58486342e+04  2.10e-01 2.05e-03  2.63e-01     5s
  18   3.02405376e+04  7.76828378e+04  1.88e-01 1.80e-03  2.14e-01     5s
  19   3.41217148e+04  7.38093363e+04  1.60e-01 1.92e-03  1.79e-01     5s
  20   3.96467485e+04  6.99255604e+04  1.21e-01 1.71e-03  1.36e-01     5s
  21   4.40578753e+04  6.72269464e+04  9.05e-02 1.31e-03  1.04e-01     5s
  22   4.48674300e+04  6.54991272e+04  8.51e-02 1.98e-03  9.30e-02     5s
  23   4.81850040e+04  6.39120470e+04  6.23e-02 2.54e-03  7.08e-02     6s
  24   4.95015219e+04  6.19483994e+04  5.36e-02 1.62e-03  5.61e-02     6s
  25   5.14567884e+04  6.07258936e+04  4.07e-02 1.38e-03  4.18e-02     6s
  26   5.28909088e+04  5.99039761e+04  3.15e-02 9.78e-04  3.16e-02     6s
  27   5.34098539e+04  5.94048090e+04  2.79e-02 8.39e-04  2.71e-02     6s
  28   5.37543036e+04  5.90493813e+04  2.57e-02 9.47e-04  2.39e-02     6s
  29   5.43993776e+04  5.87580226e+04  2.15e-02 8.16e-04  1.97e-02     6s
  30   5.47841127e+04  5.85425608e+04  1.91e-02 8.73e-04  1.70e-02     6s
  31   5.52830933e+04  5.85073074e+04  1.60e-02 8.22e-04  1.46e-02     6s
  32   5.59810994e+04  5.83305569e+04  1.18e-02 7.02e-04  1.06e-02     6s
  33   5.68480506e+04  5.82230546e+04  6.57e-03 5.56e-04  6.21e-03     6s
  34   5.75786354e+04  5.80942602e+04  2.12e-03 2.30e-04  2.32e-03     6s
  35   5.78315925e+04  5.80543420e+04  8.02e-04 1.42e-04  1.00e-03     6s
  36   5.79235708e+04  5.80364069e+04  3.10e-04 1.02e-04  5.07e-04     6s
  37   5.79701728e+04  5.80075224e+04  8.27e-05 3.99e-05  1.67e-04     6s
  38   5.79864211e+04  5.79909700e+04  1.16e-05 4.00e-06  2.04e-05     6s
  39   5.79894410e+04  5.79896794e+04  1.08e-07 6.11e-07  1.06e-06     7s
  40   5.79894807e+04  5.79894809e+04  4.47e-10 4.65e-08  7.30e-10     7s

Barrier solved model in 40 iterations and 6.56 seconds (9.91 work units)
Optimal objective 5.79894807e+04


Root crossover log...

  109875 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    3590 PPushes remaining with PInf 3.3042366e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.8355208e-03      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54358    5.7989481e+04   0.000000e+00   7.835520e-03      9s
   54359    5.7989481e+04   0.000000e+00   0.000000e+00      9s
   54359    5.7989481e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.798948e+04, 54359 iterations, 6.88 seconds (13.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57989.4808    0  149 -187498.33 57989.4808   131%     -    9s
H    0     0                    -161145.1339 57989.4808   136%     -   11s
H    0     0                    -161001.2475 57989.4808   136%     -   12s
H    0     0                    -160929.6059 57989.4808   136%     -   12s
H    0     0                    -160785.7195 57989.4808   136%     -   12s
H    0     0                    -160592.5643 57989.4808   136%     -   12s
H    0     0                     791.6644203 57989.4808  7225%     -   12s
H    0     0                    1755.2224001 57989.4808  3204%     -   12s
     0     0 50788.6623    0  236 1755.22240 50788.6623  2794%     -   74s
H    0     0                    6231.3722091 50788.6623   715%     -   75s
H    0     0                    6862.5058700 50788.6623   640%     -   75s
H    0     0                    6865.8118483 50788.6623   640%     -   75s
H    0     0                    7895.0450669 50788.6623   543%     -   75s
H    0     0                    17021.902311 50788.6623   198%     -   75s
H    0     0                    17114.103386 50788.6623   197%     -   75s
H    0     0                    17236.130137 50788.6623   195%     -   75s
     0     0 50220.1906    0  277 17236.1301 50220.1906   191%     -   99s
     0     0 50188.1685    0  272 17236.1301 50188.1685   191%     -  107s
     0     0 50188.1685    0  275 17236.1301 50188.1685   191%     -  109s
     0     0 50147.2657    0  276 17236.1301 50147.2657   191%     -  112s
     0     0 50147.2657    0  275 17236.1301 50147.2657   191%     -  114s
     0     0 50109.9445    0  269 17236.1301 50109.9445   191%     -  119s
     0     0 50109.7030    0  275 17236.1301 50109.7030   191%     -  120s
     0     0 50107.1604    0  274 17236.1301 50107.1604   191%     -  124s
     0     0 50107.1604    0  278 17236.1301 50107.1604   191%     -  128s
     0     0 50107.1604    0  273 17236.1301 50107.1604   191%     -  131s
     0     0 50107.1604    0  273 17236.1301 50107.1604   191%     -  131s
     0     0 46711.0008    0  265 17236.1301 46711.0008   171%     -  205s
H    0     0                    20552.645410 46710.9464   127%     -  206s
H    0     0                    22028.642877 46710.9464   112%     -  206s
     0     0 45912.4074    0  285 22028.6429 45912.4074   108%     -  243s
     0     0 45769.9747    0  301 22028.6429 45769.9747   108%     -  260s
     0     0 45593.0949    0  373 22028.6429 45593.0949   107%     -  275s
     0     0 45508.0010    0  350 22028.6429 45508.0010   107%     -  286s
     0     0 45404.5153    0  372 22028.6429 45404.5153   106%     -  298s
     0     0 45377.9416    0  377 22028.6429 45377.9416   106%     -  303s
     0     0 45256.6406    0  338 22028.6429 45256.6406   105%     -  316s
     0     0 45171.4866    0  393 22028.6429 45171.4866   105%     -  324s
     0     0 45147.4085    0  381 22028.6429 45147.4085   105%     -  329s
     0     0 45125.6903    0  396 22028.6429 45125.6903   105%     -  336s
H    0     0                    23072.934484 45071.2345  95.3%     -  345s
H    0     0                    23865.862608 45071.2345  88.9%     -  345s
H    0     0                    24069.131409 45071.2345  87.3%     -  345s
     0     0 45071.2345    0  390 24069.1314 45071.2345  87.3%     -  345s
     0     0 45054.6848    0  396 24069.1314 45054.6848  87.2%     -  352s
     0     0 45009.5302    0  414 24069.1314 45009.5302  87.0%     -  360s
     0     0 45005.8044    0  421 24069.1314 45005.8044  87.0%     -  362s
H    0     0                    24147.313518 45004.6908  86.4%     -  365s
     0     0 45004.6908    0  417 24147.3135 45004.6908  86.4%     -  365s
H    0     0                    24301.138100 43309.8312  78.2%     -  419s
H    0     0                    24618.807862 43309.8312  75.9%     -  419s
H    0     0                    25828.006544 43309.8312  67.7%     -  419s
     0     0 43309.8312    0  315 25828.0065 43309.8312  67.7%     -  419s
     0     0 43005.6957    0  309 25828.0065 43005.6957  66.5%     -  440s
     0     0 42852.2646    0  306 25828.0065 42852.2646  65.9%     -  451s
     0     0 42788.1391    0  317 25828.0065 42788.1391  65.7%     -  457s
     0     0 42777.2521    0  315 25828.0065 42777.2521  65.6%     -  461s
     0     0 42747.2909    0  319 25828.0065 42747.2909  65.5%     -  468s
     0     0 42711.2194    0  445 25828.0065 42711.2194  65.4%     -  474s
     0     0 42672.9087    0  337 25828.0065 42672.9087  65.2%     -  480s
     0     0 42636.9466    0  376 25828.0065 42636.9466  65.1%     -  488s
     0     0 42624.7117    0  337 25828.0065 42624.7117  65.0%     -  495s
     0     0 42614.7189    0  379 25828.0065 42614.7189  65.0%     -  500s
     0     0 42603.5755    0  338 25828.0065 42603.5755  65.0%     -  504s
     0     0 42582.5563    0  340 25828.0065 42582.5563  64.9%     -  509s
     0     0 42560.2584    0  334 25828.0065 42560.2584  64.8%     -  515s
     0     0 42551.3486    0  338 25828.0065 42551.3486  64.7%     -  520s
     0     0 42545.6942    0  337 25828.0065 42545.6942  64.7%     -  522s
     0     0 42544.4453    0  336 25828.0065 42544.4453  64.7%     -  524s
     0     0 41785.2281    0  433 25828.0065 41785.2281  61.8%     -  568s
     0     0 41616.7358    0  490 25828.0065 41616.7358  61.1%     -  585s
     0     0 41569.2644    0  450 25828.0065 41569.2644  60.9%     -  593s
     0     0 41538.7104    0  449 25828.0065 41538.7104  60.8%     -  602s
     0     0 41530.2666    0  448 25828.0065 41530.2666  60.8%     -  608s
     0     0 41502.5086    0  452 25828.0065 41502.5086  60.7%     -  613s
     0     0 41484.3724    0  457 25828.0065 41484.3724  60.6%     -  620s
     0     0 41471.2728    0  458 25828.0065 41471.2728  60.6%     -  623s
     0     0 41457.7259    0  454 25828.0065 41457.7259  60.5%     -  630s
     0     0 41433.2619    0  461 25828.0065 41433.2619  60.4%     -  636s
     0     0 41426.8971    0  458 25828.0065 41426.8971  60.4%     -  641s
     0     0 41424.2157    0  454 25828.0065 41424.2157  60.4%     -  643s
     0     0 41422.3570    0  463 25828.0065 41422.3570  60.4%     -  644s
     0     0 41218.0553    0  493 25828.0065 41218.0553  59.6%     -  668s
     0     0 41166.3205    0  436 25828.0065 41166.3205  59.4%     -  680s
     0     0 41128.2713    0  483 25828.0065 41128.2713  59.2%     -  688s
     0     0 41114.3468    0  445 25828.0065 41114.3468  59.2%     -  693s
     0     0 41101.4182    0  447 25828.0065 41101.4182  59.1%     -  698s
     0     0 41096.2553    0  454 25828.0065 41096.2553  59.1%     -  701s
     0     0 41095.0028    0  449 25828.0065 41095.0028  59.1%     -  702s
     0     0 40961.8443    0  396 25828.0065 40961.8443  58.6%     -  719s
     0     0 40920.5668    0  437 25828.0065 40920.5668  58.4%     -  739s
     0     0 40909.2041    0  478 25828.0065 40909.2041  58.4%     -  744s
     0     0 40903.5460    0  441 25828.0065 40903.5460  58.4%     -  747s
     0     0 40893.0257    0  493 25828.0065 40893.0257  58.3%     -  753s
     0     0 40885.1218    0  444 25828.0065 40885.1218  58.3%     -  756s
     0     0 40879.6362    0  440 25828.0065 40879.6362  58.3%     -  759s
     0     0 40879.2386    0  443 25828.0065 40879.2386  58.3%     -  761s
     0     0 40833.4122    0  436 25828.0065 40833.4122  58.1%     -  772s
     0     0 40815.1985    0  489 25828.0065 40815.1985  58.0%     -  782s
     0     0 40812.1823    0  502 25828.0065 40812.1823  58.0%     -  786s
     0     0 40807.8409    0  498 25828.0065 40807.8409  58.0%     -  789s
     0     0 40806.0859    0  497 25828.0065 40806.0859  58.0%     -  790s
     0     0 40780.3709    0  389 25828.0065 40780.3709  57.9%     -  802s
     0     0 40763.2369    0  380 25828.0065 40763.2369  57.8%     -  812s
     0     0 40757.9730    0  440 25828.0065 40757.9730  57.8%     -  819s
     0     0 40755.5807    0  447 25828.0065 40755.5807  57.8%     -  823s
     0     0 40742.3427    0  383 25828.0065 40742.3427  57.7%     -  830s
     0     0 40734.8312    0  444 25828.0065 40734.8312  57.7%     -  835s
     0     0 40731.7144    0  444 25828.0065 40731.7144  57.7%     -  839s
     0     0 40729.7496    0  443 25828.0065 40729.7496  57.7%     -  844s
     0     0 40708.3884    0  443 25828.0065 40708.3884  57.6%     -  855s
     0     0 40702.6590    0  450 25828.0065 40702.6590  57.6%     -  861s
     0     0 40699.2034    0  441 25828.0065 40699.2034  57.6%     -  863s
     0     0 40698.3276    0  447 25828.0065 40698.3276  57.6%     -  865s
     0     0 40694.3770    0  453 25828.0065 40694.3770  57.6%     -  869s
     0     0 40693.3673    0  450 25828.0065 40693.3673  57.6%     -  870s
     0     0 40687.8744    0  462 25828.0065 40687.8744  57.5%     -  874s
H    0     0                    26049.749243 40687.6964  56.2%     -  888s
H    0     0                    26353.246545 40687.6964  54.4%     -  891s
     0     0 40686.6893    0  461 26353.2465 40686.6893  54.4%     -  893s
     0     0 40685.0983    0  450 26353.2465 40685.0983  54.4%     -  896s
     0     0 40684.7152    0  450 26353.2465 40684.7152  54.4%     -  899s
     0     2 40684.7152    0  450 26353.2465 40684.7152  54.4%     - 1066s
     1     3 39340.3171    1  346 26353.2465 40684.5284  54.4% 36131 1122s
     2     4 40581.4596    1  447 26353.2465 40581.4596  54.0% 20868 1132s
     3     5 38164.8737    2  368 26353.2465 40581.4087  54.0% 18842 1148s
     4     9 39095.8160    2  318 26353.2465 40581.3354  54.0% 17321 1168s
     8    18 39634.2924    3  437 26353.2465 40177.1358  52.5% 14681 1221s
    17    35 39287.4645    4  419 26353.2465 40083.8145  52.1% 13917 1262s
    34    49 39025.2366    5  315 26353.2465 40083.8117  52.1% 19620 1362s
    48    78 38937.8577    6  311 26353.2465 40083.8117  52.1% 18738 1415s
    77   161 38749.8991    7  425 26353.2465 39748.3564  50.8% 15257 1524s
   160   239 38545.2372    9  407 26353.2465 39748.3564  50.8% 10221 1563s
H  191   239                    26360.785664 39748.3564  50.8%  9836 1563s
H  194   239                    26379.787335 39748.3564  50.7%  9782 1563s
   238   311 38399.0581   12  400 26379.7873 39748.3564  50.7%  9689 1601s
   310   371 37785.4574   16  334 26379.7873 39748.3564  50.7%  8734 1641s
   370   411 37425.5404   17  329 26379.7873 39748.3564  50.7%  8105 1673s
   410   460 36402.3952   18  297 26379.7873 39748.3564  50.7%  7856 1704s
H  426   460                    26387.326453 39748.3564  50.6%  7847 1704s
   459   522 36697.6611   13  250 26387.3265 39748.3564  50.6%  7679 1732s
   522   595 36148.0453   20  285 26387.3265 39748.3564  50.6%  7265 1762s
   595   680 35868.8704   22  225 26387.3265 39748.3564  50.6%  6884 1788s
   682   742 35577.4973   26  242 26387.3265 39748.3564  50.6%  6480 1816s
   753   787 34615.9949   27  245 26387.3265 39748.3564  50.6%  6165 1841s
   814   865 33980.8279   28  177 26387.3265 39748.3564  50.6%  5952 1864s
   903   952 32930.7057   30  163 26387.3265 39748.3564  50.6%  5612 1892s
  1002   982 32422.9969   33  152 26387.3265 39748.3564  50.6%  5244 1912s
  1061  1022 32234.3988   34  148 26387.3265 39748.3564  50.6%  5103 1942s
  1141  1065 31581.2883   41  106 26387.3265 39748.3564  50.6%  4921 1972s
  1245  1123 31253.1768   48  147 26387.3265 39748.3564  50.6%  4715 1998s
  1345  1150 29582.3170   53  103 26387.3265 39748.3564  50.6%  4612 2020s
  1377  1180 29535.9073   54  154 26387.3265 39748.3564  50.6%  4637 2047s
  1415  1233 29331.1195   55  193 26387.3265 39748.3564  50.6%  4613 2072s
  1492  1348 29287.7912   56  212 26387.3265 39748.3564  50.6%  4506 2099s
  1647  1428 28695.4737   66  251 26387.3265 39748.3564  50.6%  4254 2131s
  1777  1473 28317.0821   72  217 26387.3265 39748.3564  50.6%  4116 2163s
  1912  1577 34786.6163   20  247 26387.3265 39748.3564  50.6%  4008 2196s
  2038  1701 34012.5310   22  244 26387.3265 39748.3564  50.6%  3941 2234s
  2183  1818 29149.1174   25  137 26387.3265 39748.3564  50.6%  3868 2273s
  2348  1841 28512.0181   30  119 26387.3265 39748.3564  50.6%  3753 2310s
  2385  1861 27964.5084   31  155 26387.3265 39748.3564  50.6%  3794 2347s
  2431  1897 27948.3483   32  153 26387.3265 39748.3564  50.6%  3815 2378s
  2479  2010 27466.3704   36  146 26387.3265 39748.3564  50.6%  3822 2415s
  2626  2140 27011.9137   52  107 26387.3265 39748.3564  50.6%  3728 2455s
  2810  2273 27616.5966   53  204 26387.3265 39623.2143  50.2%  3589 2495s
  3012  2431 38118.9961    6  296 26387.3265 39622.4955  50.2%  3477 2535s
  3231  2561 36922.6616    7  260 26387.3265 39622.4955  50.2%  3393 2580s
  3425  2692 35970.4402    8  262 26387.3265 39622.4955  50.2%  3358 2628s
  3605  2693 30299.5162   34  450 26387.3265 39622.4955  50.2%  3323 2960s
  3607  2694 34163.2682   15  162 26387.3265 39622.4955  50.2%  3321 2982s
  3608  2695 28560.3242   41  344 26387.3265 39622.4955  50.2%  3320 3098s
  3609  2696 34188.1620   22  368 26387.3265 39622.4955  50.2%  3319 3176s
  3610  2696 26950.4841   32  405 26387.3265 39622.4955  50.2%  3318 3244s
  3611  2697 30826.7434   38  403 26387.3265 39622.4955  50.2%  3317 3284s
  3612  2698 31771.1815   13  460 26387.3265 39622.4955  50.2%  3316 3310s
  3613  2698 32159.0932   41  462 26387.3265 39622.4955  50.2%  3315 3327s
  3614  2699 28571.5863   67  433 26387.3265 39622.4955  50.2%  3314 3342s
  3615  2700 30067.4446   30  435 26387.3265 39622.4955  50.2%  3313 3349s
  3616  2700 35231.3377   14  427 26387.3265 39622.4955  50.2%  3312 3373s
  3617  2701 28864.4548   55  434 26387.3265 39622.4955  50.2%  3312 3401s
  3618  2702 33691.5753   19  434 26387.3265 39622.4955  50.2%  3311 3414s
  3619  2702 33085.1078   39  436 26387.3265 39622.4955  50.2%  3310 3421s
  3620  2703 30486.8102   33  448 26387.3265 39622.4955  50.2%  3309 3432s
  3621  2704 37820.0882    9  450 26387.3265 39622.4955  50.2%  3308 3441s
  3622  2704 29753.7490   47  456 26387.3265 39622.4955  50.2%  3307 3445s
  3623  2705 34536.2406   21  449 26387.3265 39622.4955  50.2%  3306 3450s
  3624  2706 28973.1385   51  446 26387.3265 39622.4955  50.2%  3305 3455s
  3625  2706 27609.0914   71  444 26387.3265 39622.4955  50.2%  3304 3462s
  3626  2707 35885.5180   10  456 26387.3265 39622.4955  50.2%  3303 3467s
  3627  2708 27546.5292   93  453 26387.3265 39622.4955  50.2%  3302 3472s
  3628  2708 26671.8992   85  495 26387.3265 39622.4955  50.2%  3302 3500s
  3629  2709 31919.8032   39  507 26387.3265 39622.4955  50.2%  3301 3510s
  3630  2710 36354.9026   12  491 26387.3265 39622.4955  50.2%  3300 3517s
  3631  2710 28171.5414   57  450 26387.3265 39622.4955  50.2%  3299 3522s
  3632  2711 31631.1088   38  501 26387.3265 39622.4955  50.2%  3298 3541s
  3633  2712 27196.4788   76  504 26387.3265 39622.4955  50.2%  3297 3556s
  3634  2712 27561.3273   74  501 26387.3265 39622.4955  50.2%  3296 3566s
  3635  2713 38487.4249    8  491 26387.3265 39622.4955  50.2%  3295 3573s
  3636  2714 35264.2032   12  508 26387.3265 39622.4955  50.2%  3294 3591s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 15
  Projected implied bound: 169
  MIR: 965
  Flow cover: 900
  RLT: 10
  Relax-and-lift: 225

Explored 3636 nodes (13024130 simplex iterations) in 3600.10 seconds (8112.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26387.3 26379.8 26360.8 ... 24069.1

Time limit reached
Best objective 2.638732645318e+04, best bound 3.962249554601e+04, gap 50.1573%
  WARNING: Time limit reached. Using best solution found (gap: 50.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 26387.33, θ = 175832.13
  Upper Bound (UB) = 26387.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 175832.13
  [DEBUG]   ✓ Scenario 0: θ = 175832.13 ≤ Q = 175832.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 175832.13 ≤ Q = 177318.16 (slack: 1486.03)
  [DEBUG]   ✓ Scenario 3: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 175832.13 ≤ Q = 175832.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 175832.13 ≤ Q = 175832.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 175832.13 ≤ Q = 175832.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 175832.13 ≤ Q = 175832.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5ab1d6ab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa54e2955
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.402386e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6539114.4309
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.646224e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164622.41    0  124 6539114.43 -164622.41   103%     -    0s
H    0     0                    -131658.1643 -164622.41  25.0%     -    0s
     0     0 -144942.50    0   73 -131658.16 -144942.50  10.1%     -    0s
H    0     0                    -140937.1501 -144818.51  2.75%     -    0s
H    0     0                    -143604.0474 -144818.51  0.85%     -    0s
     0     0 -144020.75    0   54 -143604.05 -144020.75  0.29%     -    0s
H    0     0                    -143633.1750 -143976.17  0.24%     -    0s
     0     0 -143851.94    0   32 -143633.18 -143851.94  0.15%     -    0s
     0     0 -143851.94    0   18 -143633.18 -143851.94  0.15%     -    0s
     0     0 -143851.94    0   16 -143633.18 -143851.94  0.15%     -    0s
     0     0 -143851.94    0   15 -143633.18 -143851.94  0.15%     -    0s
     0     0 -143812.63    0   20 -143633.18 -143812.63  0.12%     -    0s
     0     0 -143812.63    0   18 -143633.18 -143812.63  0.12%     -    0s
     0     0 -143669.97    0    5 -143633.18 -143669.97  0.03%     -    0s
     0     0 -143655.12    0    7 -143633.18 -143655.12  0.02%     -    0s
     0     0 -143654.17    0    5 -143633.18 -143654.17  0.01%     -    0s
H    0     0                    -143636.6959 -143654.17  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 2
  Relax-and-lift: 1

Explored 1 nodes (571 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -143637 -143633 -143604 ... 1.40239e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.436366959383e+05, best bound -1.436405714209e+05, gap 0.0027%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 166109.16
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143636.70
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -143636.70 = 166109.16
  [DEBUG]   Current θ from Master = 175832.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9722.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16664.36
  Lower Bound (LB) = 24340.37
  Gap (UB-LB) = 2046.9564, Absolute Gap = 2046.9564, Relative Gap = 0.077573
  Not converged yet (gap = 2046.96 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697167 nonzeros
Model fingerprint: 0x26557110
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 115096 rows and 46756 columns
Presolve time: 2.22s
Presolved: 130927 rows, 55344 columns, 807012 nonzeros
Variable types: 53085 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.29s

Barrier statistics:
 Dense cols : 679
 AA' NZ     : 5.709e+06
 Factor NZ  : 1.289e+07 (roughly 180 MB of memory)
 Factor Ops : 2.846e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.91227163e+07  2.52830040e+08  1.26e+05 1.87e+01  8.79e+04     5s
   1  -1.48673968e+07  2.27747154e+08  9.05e+04 9.24e+01  6.22e+04     5s
   2  -5.63379998e+06  1.77303957e+08  3.35e+04 7.42e+00  2.42e+04     5s
   3  -1.20177277e+06  1.30366667e+08  3.08e+03 7.10e-01  2.65e+03     5s
   4  -7.35349194e+05  6.31593103e+07  4.94e+02 2.37e-01  5.70e+02     5s
   5  -6.40644870e+05  4.97155925e+07  2.91e+02 1.74e-01  3.80e+02     5s
   6  -4.57629451e+05  3.23988366e+07  1.08e+02 1.06e-01  1.94e+02     5s
   7  -4.00129260e+05  2.44998296e+07  6.34e+01 7.67e-02  1.34e+02     5s
   8  -2.79952640e+05  1.77823195e+07  1.59e+01 5.32e-02  8.19e+01     5s
   9  -2.06907584e+05  1.24825581e+07  8.66e+00 3.62e-02  5.57e+01     5s
  10  -1.39376051e+05  6.91882681e+06  4.38e+00 1.93e-02  3.04e+01     5s
  11  -1.13692936e+05  2.47518246e+06  1.77e+00 6.68e-03  1.10e+01     5s
  12  -6.59333690e+04  1.11751742e+06  5.77e-01 3.05e-03  4.97e+00     5s
  13  -4.37832101e+04  4.31829521e+05  3.18e-01 1.07e-03  2.00e+00     5s
  14  -1.67902731e+04  2.86647666e+05  1.85e-01 8.52e-04  1.27e+00     6s
  15  -1.67680105e+03  2.00583066e+05  1.29e-01 1.18e-03  8.48e-01     6s
  16   1.75000060e+04  1.65076007e+05  7.34e-02 2.62e-03  6.18e-01     6s
  17   2.44337479e+04  1.33457083e+05  5.73e-02 2.31e-03  4.57e-01     6s
  18   2.93683044e+04  1.11911917e+05  4.67e-02 1.56e-03  3.46e-01     6s
  19   3.08719948e+04  9.73520983e+04  4.36e-02 1.49e-03  2.79e-01     6s
  20   3.44109114e+04  8.66377910e+04  3.70e-02 1.52e-03  2.19e-01     6s
  21   4.11075470e+04  7.75687055e+04  2.51e-02 1.03e-03  1.53e-01     6s
  22   4.31578561e+04  7.38833006e+04  2.17e-02 8.39e-04  1.29e-01     6s
  23   4.41185724e+04  7.01595219e+04  2.01e-02 6.62e-04  1.09e-01     6s
  24   4.68327017e+04  6.81057986e+04  1.60e-02 5.65e-04  8.91e-02     6s
  25   4.94364094e+04  6.64711242e+04  1.20e-02 4.73e-04  7.14e-02     6s
  26   5.04244285e+04  6.41130644e+04  1.06e-02 3.45e-04  5.74e-02     7s
  27   5.18992757e+04  6.23866561e+04  8.34e-03 2.58e-04  4.39e-02     7s
  28   5.31123087e+04  6.13901891e+04  6.64e-03 3.58e-04  3.47e-02     7s
  29   5.37013006e+04  6.05803785e+04  5.82e-03 2.71e-04  2.88e-02     7s
  30   5.44243059e+04  5.98156504e+04  4.74e-03 1.76e-04  2.26e-02     7s
  31   5.51851856e+04  5.93250368e+04  3.70e-03 1.29e-04  1.74e-02     7s
  32   5.58105937e+04  5.89607631e+04  2.81e-03 1.07e-04  1.32e-02     7s
  33   5.61526494e+04  5.88450507e+04  2.36e-03 9.49e-05  1.13e-02     7s
  34   5.68689465e+04  5.86732191e+04  1.42e-03 7.39e-05  7.56e-03     7s
  35   5.71022904e+04  5.83059039e+04  1.10e-03 1.03e-04  5.05e-03     7s
  36   5.76857009e+04  5.81911635e+04  3.51e-04 6.57e-05  2.12e-03     7s
  37   5.78250084e+04  5.80255832e+04  1.79e-04 1.49e-05  8.41e-04     7s
  38   5.78996273e+04  5.80085244e+04  9.40e-05 8.22e-06  4.56e-04     7s
  39   5.79499144e+04  5.79994739e+04  3.89e-05 4.54e-06  2.08e-04     8s
  40   5.79821284e+04  5.79895139e+04  5.70e-06 1.25e-06  3.09e-05     8s
  41   5.79881117e+04  5.79881676e+04  2.66e-08 2.74e-08  2.34e-07     8s
  42   5.79881580e+04  5.79881581e+04  3.66e-11 2.02e-10  2.34e-10     8s

Barrier solved model in 42 iterations and 7.78 seconds (11.91 work units)
Optimal objective 5.79881580e+04


Root crossover log...

  117394 DPushes remaining with DInf 0.0000000e+00                 8s
   22212 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2607 PPushes remaining with PInf 3.2691702e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.6771785e-01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56444    5.7988158e+04   0.000000e+00   6.677178e-01     14s
   56448    5.7988158e+04   0.000000e+00   0.000000e+00     14s
   56448    5.7988158e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.798816e+04, 56448 iterations, 10.98 seconds (16.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57988.1581    0  149 -187498.33 57988.1581   131%     -   14s
H    0     0                    -165689.2509 57988.1581   135%     -   15s
H    0     0                    -165625.3937 57988.1581   135%     -   15s
H    0     0                    -146018.0742 57988.1581   140%     -   15s
H    0     0                    -144194.2942 57988.1581   140%     -   15s
H    0     0                    -54160.17059 57988.1581   207%     -   15s
H    0     0                      48.4356325 57988.1581      -     -   15s
H    0     0                     473.2996648 57988.1581      -     -   16s
H    0     0                    1785.3596642 57988.1581  3148%     -   16s
H    0     0                    10482.974893 57988.1581   453%     -   17s
H    0     0                    13218.292423 57988.1581   339%     -   17s
H    0     0                    13685.713728 57988.1581   324%     -   17s
H    0     0                    13749.497456 57988.1581   322%     -   17s
H    0     0                    14004.250663 57988.1581   314%     -   17s
H    0     0                    17056.825508 50679.3468   197%     -   82s
H    0     0                    17086.287812 50679.3468   197%     -   82s
H    0     0                    17176.024698 50679.3468   195%     -   82s
     0     0 50632.8452    0  235 17176.0247 50632.8452   195%     -   82s
H    0     0                    17482.810593 50632.8452   190%     -   83s
H    0     0                    17706.593388 50632.8452   186%     -   83s
H    0     0                    18300.906091 50632.8452   177%     -   83s
     0     0 50029.9951    0  261 18300.9061 50029.9951   173%     -  126s
     0     0 49987.6554    0  264 18300.9061 49987.6554   173%     -  144s
     0     0 49959.4525    0  261 18300.9061 49959.4525   173%     -  147s
     0     0 49959.4506    0  267 18300.9061 49959.4506   173%     -  153s
     0     0 49959.4506    0  262 18300.9061 49959.4506   173%     -  160s
     0     0 49959.4506    0  260 18300.9061 49959.4506   173%     -  164s
     0     0 49959.4506    0  260 18300.9061 49959.4506   173%     -  165s
     0     0 49959.4506    0  258 18300.9061 49959.4506   173%     -  166s
     0     0 49959.4506    0  258 18300.9061 49959.4506   173%     -  166s
H    0     0                    18341.608499 46637.0897   154%     -  244s
     0     0 46637.0897    0  300 18341.6085 46637.0897   154%     -  244s
H    0     0                    18377.878814 46635.2936   154%     -  244s
H    0     0                    18629.492472 46635.2936   150%     -  244s
     0     0 45886.7897    0  315 18629.4925 45886.7897   146%     -  280s
     0     0 45663.2167    0  368 18629.4925 45663.2167   145%     -  300s
     0     0 45484.0044    0  398 18629.4925 45484.0044   144%     -  319s
     0     0 45382.1733    0  402 18629.4925 45382.1733   144%     -  332s
     0     0 45332.1431    0  414 18629.4925 45332.1431   143%     -  342s
     0     0 45293.4317    0  415 18629.4925 45293.4317   143%     -  353s
     0     0 45284.3092    0  408 18629.4925 45284.3092   143%     -  355s
     0     0 45267.0188    0  404 18629.4925 45267.0188   143%     -  363s
     0     0 45251.0736    0  410 18629.4925 45251.0736   143%     -  369s
     0     0 45191.5375    0  408 18629.4925 45191.5375   143%     -  380s
H    0     0                    21141.527426 45124.2234   113%     -  392s
     0     0 45124.2234    0  406 21141.5274 45124.2234   113%     -  392s
     0     0 45112.9021    0  412 21141.5274 45112.9021   113%     -  396s
     0     0 45097.3608    0  415 21141.5274 45097.3608   113%     -  402s
     0     0 45091.8997    0  420 21141.5274 45091.8997   113%     -  407s
     0     0 45091.2414    0  417 21141.5274 45091.2414   113%     -  409s
H    0     0                    21429.411399 43374.1107   102%     -  483s
H    0     0                    21499.367822 43374.1107   102%     -  483s
     0     0 43374.1107    0  351 21499.3678 43374.1107   102%     -  483s
     0     0 43373.7071    0  351 21499.3678 43373.7071   102%     -  484s
H    0     0                    22488.532628 43372.4317  92.9%     -  496s
     0     0 42845.8629    0  447 22488.5326 42845.8629  90.5%     -  533s
     0     0 42644.6898    0  421 22488.5326 42644.6898  89.6%     -  560s
H    0     0                    23045.493244 42511.6599  84.5%     -  580s
H    0     0                    23793.130221 42511.6599  78.7%     -  580s
     0     0 42511.6599    0  421 23793.1302 42511.6599  78.7%     -  580s
H    0     0                    23804.499430 42471.8999  78.4%     -  595s
H    0     0                    23922.888506 42471.8999  77.5%     -  595s
     0     0 42471.8999    0  428 23922.8885 42471.8999  77.5%     -  595s
     0     0 42439.7123    0  427 23922.8885 42439.7123  77.4%     -  605s
     0     0 42425.6875    0  427 23922.8885 42425.6875  77.3%     -  613s
     0     0 42408.7276    0  430 23922.8885 42408.7276  77.3%     -  619s
     0     0 42379.4733    0  433 23922.8885 42379.4733  77.2%     -  633s
     0     0 42373.1082    0  435 23922.8885 42373.1082  77.1%     -  636s
     0     0 42370.8980    0  433 23922.8885 42370.8980  77.1%     -  638s
     0     0 42369.3876    0  433 23922.8885 42369.3876  77.1%     -  640s
H    0     0                    24124.912454 42369.3876  75.6%     -  659s
H    0     0                    24975.025627 42369.3876  69.6%     -  659s
H    0     0                    25196.200328 42369.3876  68.2%     -  659s
     0     0 41581.7453    0  447 25196.2003 41581.7453  65.0%     -  703s
     0     0 41434.3246    0  447 25196.2003 41434.3246  64.4%     -  730s
     0     0 41394.5071    0  443 25196.2003 41394.5071  64.3%     -  742s
     0     0 41374.8536    0  447 25196.2003 41374.8536  64.2%     -  753s
     0     0 41368.4413    0  445 25196.2003 41368.4413  64.2%     -  757s
     0     0 41362.1316    0  364 25196.2003 41362.1316  64.2%     -  762s
H    0     0                    25654.030664 41347.1393  61.2%     -  771s
H    0     0                    25694.123109 41347.1393  60.9%     -  771s
     0     0 41347.1393    0  421 25694.1231 41347.1393  60.9%     -  771s
     0     0 41317.1508    0  451 25694.1231 41317.1508  60.8%     -  779s
     0     0 41310.4008    0  456 25694.1231 41310.4008  60.8%     -  784s
     0     0 41309.7135    0  449 25694.1231 41309.7135  60.8%     -  786s
     0     0 41184.2818    0  449 25694.1231 41184.2818  60.3%     -  809s
H    0     0                    25787.343042 41184.2103  59.7%     -  810s
     0     0 41143.2019    0  452 25787.3430 41143.2019  59.5%     -  828s
     0     0 41106.9194    0  466 25787.3430 41106.9194  59.4%     -  839s
     0     0 41094.3343    0  469 25787.3430 41094.3343  59.4%     -  850s
     0     0 41085.4297    0  475 25787.3430 41085.4297  59.3%     -  854s
     0     0 41082.6791    0  474 25787.3430 41082.6791  59.3%     -  859s
     0     0 41075.1043    0  462 25787.3430 41075.1043  59.3%     -  866s
     0     0 41074.1192    0  462 25787.3430 41074.1192  59.3%     -  870s
     0     0 40982.9892    0  421 25787.3430 40982.9892  58.9%     -  891s
     0     0 40950.5821    0  430 25787.3430 40950.5821  58.8%     -  910s
     0     0 40938.5855    0  432 25787.3430 40938.5855  58.8%     -  915s
     0     0 40930.7986    0  438 25787.3430 40930.7986  58.7%     -  917s
     0     0 40928.1977    0  436 25787.3430 40928.1977  58.7%     -  920s
     0     0 40926.2570    0  444 25787.3430 40926.2570  58.7%     -  922s
     0     0 40865.7305    0  447 25787.3430 40865.7305  58.5%     -  941s
     0     0 40850.1782    0  458 25787.3430 40850.1782  58.4%     -  954s
     0     0 40845.3437    0  455 25787.3430 40845.3437  58.4%     -  958s
     0     0 40844.3290    0  455 25787.3430 40844.3290  58.4%     -  960s
     0     0 40804.9895    0  443 25787.3430 40804.9895  58.2%     -  982s
H    0     0                    25834.460278 40804.8333  57.9%     -  983s
     0     0 40785.2205    0  445 25834.4603 40785.2205  57.9%     -  996s
     0     0 40780.5741    0  446 25834.4603 40780.5741  57.9%     - 1007s
     0     0 40777.3344    0  453 25834.4603 40777.3344  57.8%     - 1012s
     0     0 40773.9106    0  449 25834.4603 40773.9106  57.8%     - 1016s
     0     0 40772.1125    0  449 25834.4603 40772.1125  57.8%     - 1018s
     0     0 40740.7416    0  447 25834.4603 40740.7416  57.7%     - 1039s
H    0     0                    26089.128882 40740.7415  56.2%     - 1040s
     0     0 40725.2827    0  446 26089.1289 40725.2827  56.1%     - 1050s
     0     0 40721.0684    0  451 26089.1289 40721.0684  56.1%     - 1056s
     0     0 40719.3315    0  453 26089.1289 40719.3315  56.1%     - 1058s
     0     0 40695.8476    0  448 26089.1289 40695.8476  56.0%     - 1073s
H    0     0                    26129.221327 40695.1715  55.7%     - 1077s
     0     0 40689.6410    0  449 26129.2213 40689.6410  55.7%     - 1084s
     0     0 40686.9348    0  456 26129.2213 40686.9348  55.7%     - 1089s
     0     0 40683.1113    0  511 26129.2213 40683.1113  55.7%     - 1095s
     0     0 40681.2114    0  509 26129.2213 40681.2114  55.7%     - 1097s
     0     0 40668.6198    0  456 26129.2213 40668.6198  55.6%     - 1107s
     0     0 40666.3047    0  507 26129.2213 40666.3047  55.6%     - 1113s
     0     0 40658.0435    0  451 26129.2213 40658.0435  55.6%     - 1121s
     0     0 40656.7101    0  507 26129.2213 40656.7101  55.6%     - 1127s
     0     0 40655.6927    0  500 26129.2213 40655.6927  55.6%     - 1131s
     0     0 40655.3650    0  499 26129.2213 40655.3650  55.6%     - 1133s
     0     0 40649.6828    0  490 26129.2213 40649.6828  55.6%     - 1139s
     0     0 40649.6424    0  490 26129.2213 40649.6424  55.6%     - 1144s
H    0     0                    26281.231423 40649.6263  54.7%     - 1401s
     0     2 40649.6263    0  490 26281.2314 40649.6263  54.7%     - 1657s
     1     4 40606.1400    1  485 26281.2314 40649.6263  54.7%  5442 1678s
     3     8 40313.6004    2  483 26281.2314 40605.9213  54.5% 11159 1729s
     7    16 40227.8869    3  433 26281.2314 40313.5263  53.4% 17136 1768s
    15    32 39671.5027    4  445 26281.2314 40227.7785  53.1% 17248 1820s
    31    48 39381.6136    5  393 26281.2314 39671.3740  50.9% 25742 1920s
    47    80 38309.5561    6  287 26281.2314 39671.3740  50.9% 22419 1971s
    79   143 38122.0228    7  282 26281.2314 39671.3740  50.9% 18771 2123s
   142   257 37995.8179    9  286 26281.2314 39671.3740  50.9% 12997 2178s
   256   340 37701.3751   10  275 26281.2314 39671.3740  50.9%  9861 2216s
   339   393 36102.5338   19  306 26281.2314 39671.3740  50.9%  8627 2249s
   392   466 37450.2732   10  280 26281.2314 39671.3740  50.9%  8210 2281s
   465   523 37589.0022   11  272 26281.2314 39671.3740  50.9%  7676 2320s
   522   583 37258.8048   12  280 26281.2314 39671.3740  50.9%  7461 2359s
   588   606     cutoff   31      26281.2314 39671.3740  50.9%  7147 2393s
   617   624 37103.1900   13  347 26281.2314 39671.3740  50.9%  7065 2427s
   653   652 36913.5600   13  259 26281.2314 39671.3740  50.9%  6993 2460s
   697   684 31823.2119   19  200 26281.2314 39671.3740  50.9%  6880 2496s
   741   744 31443.1306   19  351 26281.2314 39671.3740  50.9%  6757 2531s
   807   832 31205.3008   20  273 26281.2314 39671.3740  50.9%  6449 2559s
   913   907 30611.3874   24  259 26281.2314 39671.3740  50.9%  6008 2592s
  1020   982 28918.2382   37  115 26281.2314 39671.3740  50.9%  5640 2628s
  1137  1097 28434.8301   41  226 26281.2314 39671.3740  50.9%  5332 2655s
  1282  1209 infeasible   44      26281.2314 39671.3740  50.9%  4940 2685s
  1439  1303 26531.0474   47  173 26281.2314 39671.3740  50.9%  4614 2719s
  1607  1308 28796.0153   27  221 26281.2314 39671.3740  50.9%  4352 2747s
  1649  1358 28726.6768   28  252 26281.2314 39671.3740  50.9%  4331 2777s
  1758  1401 28086.3324   29  216 26281.2314 39671.3740  50.9%  4177 2815s
  1906  1536 27702.7912   33  214 26281.2314 39671.3740  50.9%  4026 2849s
  2082  1700 27155.0255   45  111 26281.2314 39671.3740  50.9%  3850 2881s
  2304  1745     cutoff   58      26281.2314 39671.3740  50.9%  3639 2919s
  2443  1801 28310.7816   36  218 26281.2314 39671.3740  50.9%  3583 2956s
  2543  1846 27792.4623   39  130 26281.2314 39671.3740  50.9%  3580 2998s
  2659  1886 27162.5851   49  104 26281.2314 39521.7782  50.4%  3561 3042s
  2739  1908 26791.9803   53   86 26281.2314 39521.7782  50.4%  3567 3081s
  2808  1926     cutoff   55      26281.2314 39520.5273  50.4%  3581 3124s
H 2837  1922                    26320.693219 39520.5273  50.2%  3591 3124s
  2893  1982 26712.7392   47  203 26320.6932 38858.7167  47.6%  3594 3175s
  2990  2052 35801.9180    7  359 26320.6932 38858.7167  47.6%  3637 3225s
  3074  2206 34290.6772    8  348 26320.6932 38858.7167  47.6%  3712 3268s
  3264  2236 33946.0446    9  340 26320.6932 38858.7167  47.6%  3658 3312s
H 3273  2230                    26360.785664 38858.7167  47.4%  3667 3312s
  3296  2389 33503.6363   10  384 26360.7857 38858.7167  47.4%  3689 3365s
  3490  2503 28249.9655   11  379 26360.7857 38588.5000  46.4%  3644 3420s

Cutting planes:
  Learned: 4
  Gomory: 2
  Implied bound: 175
  MIR: 3266
  Flow cover: 3132
  RLT: 56
  Relax-and-lift: 488

Explored 3673 nodes (14032205 simplex iterations) in 3600.08 seconds (7951.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26360.8 26320.7 26281.2 ... 25196.2

Time limit reached
Best objective 2.636078566355e+04, best bound 3.858849997867e+04, gap 46.3860%
  WARNING: Time limit reached. Using best solution found (gap: 46.39%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 26360.79, θ = 175821.89
  Upper Bound (UB) = 26360.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 175821.89
  [DEBUG]   ✓ Scenario 0: θ = 175821.89 ≤ Q = 175821.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 175821.89 ≤ Q = 175821.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 175821.89 ≤ Q = 175821.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 175821.89 ≤ Q = 175821.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 175821.89 ≤ Q = 175821.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 175821.89 ≤ Q = 175821.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 175821.89 ≤ Q = 175821.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 175821.89 ≤ Q = 175821.89 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2acb4eb8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd534b148
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.402386e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6546279.6677
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.646293e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164629.33    0  124 6546279.67 -164629.33   103%     -    0s
H    0     0                    -131592.9692 -164629.33  25.1%     -    0s
     0     0 -140604.08    0   78 -131592.97 -140604.08  6.85%     -    0s
H    0     0                    -137236.9163 -140600.69  2.45%     -    0s
H    0     0                    -137501.0730 -140600.69  2.25%     -    0s
H    0     0                    -138488.8217 -140600.69  1.52%     -    0s
H    0     0                    -139115.7276 -140600.69  1.07%     -    0s
     0     0 -139984.95    0   66 -139115.73 -139984.95  0.62%     -    0s
     0     0 -139979.77    0   66 -139115.73 -139979.77  0.62%     -    0s
     0     0 -139736.15    0   39 -139115.73 -139736.15  0.45%     -    0s
H    0     0                    -139189.1894 -139733.17  0.39%     -    0s
     0     0 -139658.66    0   48 -139189.19 -139658.66  0.34%     -    0s
     0     0 -139652.96    0   46 -139189.19 -139652.96  0.33%     -    0s
     0     0 -139647.22    0   39 -139189.19 -139647.22  0.33%     -    0s
     0     0 -139433.19    0   21 -139189.19 -139433.19  0.18%     -    0s
     0     0 -139433.16    0   13 -139189.19 -139433.16  0.18%     -    0s
     0     0 -139368.07    0   29 -139189.19 -139368.07  0.13%     -    0s
     0     0 -139367.30    0   28 -139189.19 -139367.30  0.13%     -    0s
     0     0 -139366.63    0   27 -139189.19 -139366.63  0.13%     -    0s
     0     0 -139358.25    0   17 -139189.19 -139358.25  0.12%     -    0s
     0     0 -139325.07    0   18 -139189.19 -139325.07  0.10%     -    0s
     0     0 -139325.07    0   23 -139189.19 -139325.07  0.10%     -    0s
H    0     0                    -139214.2475 -139325.07  0.08%     -    0s
     0     0 -139233.28    0    4 -139214.25 -139233.28  0.01%     -    0s
     0     0          -    0      -139214.25 -139225.58  0.01%     -    0s

Cutting planes:
  Gomory: 10
  MIR: 13
  Flow cover: 13
  Relax-and-lift: 6

Explored 1 nodes (802 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139214 -139189 -139116 ... 1.40239e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.392142475337e+05, best bound -1.392255784988e+05, gap 0.0081%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 170531.61
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139214.25
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -139214.25 = 170531.61
  [DEBUG]   Current θ from Master = 175821.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5290.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21070.51
  Lower Bound (LB) = 24340.37
  Gap (UB-LB) = 2020.4156, Absolute Gap = 2020.4156, Relative Gap = 0.076645
  Not converged yet (gap = 2020.42 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740395 nonzeros
Model fingerprint: 0x7a6afb69
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 122307 rows and 49687 columns
Presolve time: 2.80s
Presolved: 139006 rows, 58653 columns, 856936 nonzeros
Variable types: 56394 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.35s

Barrier statistics:
 Dense cols : 678
 AA' NZ     : 6.374e+06
 Factor NZ  : 1.464e+07 (roughly 200 MB of memory)
 Factor Ops : 3.547e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.96674612e+07  2.66529195e+08  1.30e+05 1.83e+01  8.99e+04     5s
   1  -1.53302890e+07  2.41082239e+08  9.32e+04 9.25e+01  6.37e+04     5s
   2  -4.65080091e+06  1.87314734e+08  2.74e+04 9.26e+00  1.99e+04     5s
   3  -1.02079119e+06  1.28841340e+08  2.84e+03 1.50e+00  2.44e+03     5s
   4  -6.16678144e+05  8.04333378e+07  5.69e+02 6.24e-01  6.75e+02     5s
   5  -5.41005193e+05  5.47207413e+07  3.43e+02 3.88e-01  4.16e+02     5s
   6  -4.13828501e+05  3.79418747e+07  1.01e+02 2.49e-01  2.05e+02     5s
   7  -3.66986206e+05  2.71711083e+07  5.71e+01 1.69e-01  1.35e+02     5s
   8  -2.59309792e+05  1.87020229e+07  1.45e+01 1.11e-01  8.03e+01     5s
   9  -2.19097249e+05  1.29253367e+07  9.87e+00 7.43e-02  5.46e+01     5s
  10  -1.53997590e+05  7.95256225e+06  5.04e+00 4.40e-02  3.29e+01     5s
  11  -1.16317906e+05  3.62017153e+06  2.57e+00 1.95e-02  1.50e+01     5s
  12  -8.83702547e+04  1.80462540e+06  1.43e+00 9.50e-03  7.54e+00     6s
  13  -5.57264572e+04  7.91921403e+05  5.87e-01 3.84e-03  3.36e+00     6s
  14  -2.77851242e+04  3.75846882e+05  2.96e-01 1.71e-03  1.60e+00     6s
  15  -1.12215896e+04  2.67273705e+05  1.96e-01 1.29e-03  1.10e+00     6s
  16   4.38673661e+03  1.96563037e+05  1.41e-01 1.62e-03  7.59e-01     6s
  17   1.51379204e+04  1.48965319e+05  1.08e-01 2.20e-03  5.29e-01     6s
  18   2.29547677e+04  1.18868367e+05  8.66e-02 2.15e-03  3.79e-01     6s
  19   2.87712059e+04  1.04711590e+05  6.99e-02 1.79e-03  3.00e-01     6s
  20   3.30593575e+04  8.69768806e+04  5.82e-02 1.75e-03  2.13e-01     6s
  21   3.98842144e+04  7.94682238e+04  4.01e-02 2.00e-03  1.56e-01     6s
  22   4.41344350e+04  7.48944123e+04  2.95e-02 1.58e-03  1.22e-01     6s
  23   4.65046779e+04  7.01045136e+04  2.40e-02 1.17e-03  9.33e-02     6s
  24   4.76952813e+04  6.92307674e+04  2.13e-02 1.09e-03  8.51e-02     6s
  25   4.94655894e+04  6.79477487e+04  1.73e-02 9.77e-04  7.30e-02     7s
  26   5.05192060e+04  6.41531663e+04  1.50e-02 6.49e-04  5.39e-02     7s
  27   5.22225169e+04  6.30203460e+04  1.13e-02 5.52e-04  4.27e-02     7s
  28   5.32849025e+04  6.14310496e+04  9.12e-03 3.81e-04  3.22e-02     7s
  29   5.38556880e+04  6.09348653e+04  7.83e-03 3.24e-04  2.80e-02     7s
  30   5.43995472e+04  5.98966402e+04  6.71e-03 2.29e-04  2.17e-02     7s
  31   5.47902680e+04  5.93193431e+04  5.95e-03 1.51e-04  1.79e-02     7s
  32   5.57860216e+04  5.91321342e+04  4.10e-03 1.32e-04  1.32e-02     7s
  33   5.66263935e+04  5.88212012e+04  2.50e-03 9.23e-05  8.68e-03     7s
  34   5.70815171e+04  5.83822945e+04  1.64e-03 4.45e-05  5.14e-03     7s
  35   5.75584999e+04  5.82068086e+04  7.80e-04 1.38e-04  2.56e-03     7s
  36   5.78504531e+04  5.80763261e+04  2.64e-04 8.08e-05  8.93e-04     8s
  37   5.79723640e+04  5.80347465e+04  6.60e-05 2.60e-05  2.47e-04     8s
  38   5.80149265e+04  5.80232819e+04  3.59e-06 3.35e-06  3.30e-05     8s
  39   5.80185041e+04  5.80190903e+04  1.59e-07 4.75e-07  2.32e-06     8s
  40   5.80188631e+04  5.80188826e+04  7.96e-09 1.62e-09  7.74e-08     8s
  41   5.80188802e+04  5.80188815e+04  8.40e-08 1.03e-09  5.02e-09     8s
  42   5.80188813e+04  5.80188815e+04  2.86e-08 1.39e-10  8.42e-10     8s

Barrier solved model in 42 iterations and 8.09 seconds (12.22 work units)
Optimal objective 5.80188813e+04


Root crossover log...

  124494 DPushes remaining with DInf 0.0000000e+00                 8s
   29461 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    9307 PPushes remaining with PInf 5.6691785e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1051542e+04     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71063    5.8018882e+04   0.000000e+00   1.105154e+04     14s
   72228    5.8018882e+04   0.000000e+00   2.213613e+01     15s
   72464    5.8018882e+04   0.000000e+00   0.000000e+00     15s
   72464    5.8018882e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 7.72s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.801888e+04, 72464 iterations, 19.37 seconds (27.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 58018.8815    0  154 -187498.33 58018.8815   131%     -   23s
H    0     0                    -186261.8660 58018.8815   131%     -   23s
H    0     0                    -173731.9983 58018.8815   133%     -   24s
H    0     0                    -172546.6781 58018.8815   134%     -   24s
H    0     0                    -167922.6759 58018.8815   135%     -   24s
H    0     0                    -142674.7855 58018.8815   141%     -   24s
H    0     0                    -140521.8303 58018.8815   141%     -   24s
H    0     0                    -139186.1744 58018.8815   142%     -   24s
H    0     0                    -138477.1241 58018.8815   142%     -   24s
H    0     0                    -138116.0213 58018.8815   142%     -   24s
H    0     0                    -54160.17059 58018.8815   207%     -   24s
H    0     0                    4462.3179201 58018.8815  1200%     -   24s
H    0     0                    5107.3014400 58018.8815  1036%     -   25s
H    0     0                    13657.647048 58018.8815   325%     -   25s
H    0     0                    13713.552036 58018.8815   323%     -   25s
H    0     0                    14004.250663 58018.8815   314%     -   33s
     0     0 50659.4625    0  242 14004.2507 50659.4625   262%     -  121s
H    0     0                    15019.508601 50658.7344   237%     -  122s
H    0     0                    15619.724070 50658.7344   224%     -  122s
     0     0 50200.2509    0  263 15619.7241 50200.2509   221%     -  153s
     0     0 50118.3512    0  272 15619.7241 50118.3512   221%     -  168s
     0     0 50113.0457    0  279 15619.7241 50113.0457   221%     -  176s
     0     0 50082.6976    0  274 15619.7241 50082.6976   221%     -  186s
     0     0 50077.0941    0  274 15619.7241 50077.0941   221%     -  188s
     0     0 50075.1623    0  278 15619.7241 50075.1623   221%     -  190s
     0     0 50072.2681    0  280 15619.7241 50072.2681   221%     -  192s
     0     0 50072.0292    0  278 15619.7241 50072.0292   221%     -  193s
     0     0 46843.7064    0  281 15619.7241 46843.7064   200%     -  250s
H    0     0                    23987.594628 46843.2575  95.3%     -  250s
     0     0 46147.5842    0  293 23987.5946 46147.5842  92.4%     -  284s
     0     0 45868.5077    0  277 23987.5946 45868.5077  91.2%     -  306s
     0     0 45751.2414    0  338 23987.5946 45751.2414  90.7%     -  323s
     0     0 45720.3832    0  293 23987.5946 45720.3832  90.6%     -  331s
     0     0 45647.9089    0  341 23987.5946 45647.9089  90.3%     -  344s
     0     0 45536.3031    0  297 23987.5946 45536.3031  89.8%     -  355s
     0     0 45514.3655    0  301 23987.5946 45514.3655  89.7%     -  361s
     0     0 45511.4921    0  303 23987.5946 45511.4921  89.7%     -  363s
     0     0 45456.4818    0  334 23987.5946 45456.4818  89.5%     -  374s
     0     0 45419.8878    0  348 23987.5946 45419.8878  89.3%     -  380s
     0     0 45398.1122    0  341 23987.5946 45398.1122  89.3%     -  387s
     0     0 45371.9669    0  350 23987.5946 45371.9669  89.1%     -  391s
     0     0 45284.8278    0  396 23987.5946 45284.8278  88.8%     -  403s
     0     0 45281.3291    0  392 23987.5946 45281.3291  88.8%     -  404s
     0     0 45280.0305    0  391 23987.5946 45280.0305  88.8%     -  405s
     0     0 43349.3298    0  392 23987.5946 43349.3298  80.7%     -  464s
H    0     0                    24101.642445 43347.1801  79.9%     -  465s
     0     0 42976.5791    0  393 24101.6424 42976.5791  78.3%     -  496s
     0     0 42807.9098    0  395 24101.6424 42807.9098  77.6%     -  514s
     0     0 42718.9486    0  404 24101.6424 42718.9486  77.2%     -  527s
     0     0 42670.2933    0  418 24101.6424 42670.2933  77.0%     -  536s
     0     0 42646.1101    0  417 24101.6424 42646.1101  76.9%     -  542s
     0     0 42597.1766    0  438 24101.6424 42597.1766  76.7%     -  552s
     0     0 42593.9152    0  439 24101.6424 42593.9152  76.7%     -  556s
     0     0 42588.5912    0  421 24101.6424 42588.5912  76.7%     -  559s
     0     0 42585.1270    0  428 24101.6424 42585.1270  76.7%     -  561s
     0     0 42548.6134    0  436 24101.6424 42548.6134  76.5%     -  570s
     0     0 42540.4307    0  439 24101.6424 42540.4307  76.5%     -  574s
     0     0 42530.2949    0  437 24101.6424 42530.2949  76.5%     -  578s
     0     0 42521.0082    0  435 24101.6424 42521.0082  76.4%     -  583s
     0     0 42515.9157    0  478 24101.6424 42515.9157  76.4%     -  586s
     0     0 42497.3495    0  439 24101.6424 42497.3495  76.3%     -  591s
     0     0 42493.6084    0  434 24101.6424 42493.6084  76.3%     -  594s
     0     0 42492.6284    0  438 24101.6424 42492.6284  76.3%     -  595s
     0     0 41639.3891    0  419 24101.6424 41639.3891  72.8%     -  662s
     0     0 41480.6495    0  435 24101.6424 41480.6495  72.1%     -  682s
     0     0 41419.2669    0  437 24101.6424 41419.2669  71.9%     -  694s
     0     0 41394.7384    0  435 24101.6424 41394.7384  71.8%     -  703s
     0     0 41371.5056    0  450 24101.6424 41371.5056  71.7%     -  710s
     0     0 41348.1940    0  449 24101.6424 41348.1940  71.6%     -  717s
     0     0 41339.6546    0  453 24101.6424 41339.6546  71.5%     -  723s
     0     0 41331.8761    0  442 24101.6424 41331.8761  71.5%     -  726s
     0     0 41315.8212    0  444 24101.6424 41315.8212  71.4%     -  731s
     0     0 41305.6616    0  446 24101.6424 41305.6616  71.4%     -  734s
     0     0 41303.8798    0  446 24101.6424 41303.8798  71.4%     -  736s
     0     0 41183.6996    0  374 24101.6424 41183.6996  70.9%     -  755s
     0     0 41142.2647    0  420 24101.6424 41142.2647  70.7%     -  766s
     0     0 41132.5661    0  381 24101.6424 41132.5661  70.7%     -  772s
     0     0 41084.4012    0  446 24101.6424 41084.4012  70.5%     -  786s
     0     0 41069.7520    0  443 24101.6424 41069.7520  70.4%     -  791s
     0     0 41065.6935    0  447 24101.6424 41065.6935  70.4%     -  794s
     0     0 41047.3764    0  448 24101.6424 41047.3764  70.3%     -  801s
     0     0 41039.6113    0  458 24101.6424 41039.6113  70.3%     -  807s
     0     0 41037.9447    0  454 24101.6424 41037.9447  70.3%     -  810s
     0     0 40961.8021    0  373 24101.6424 40961.8021  70.0%     -  829s
H    0     0                    24111.307292 40961.6774  69.9%     -  843s
H    0     0                    25541.861067 40961.6774  60.4%     -  843s
     0     0 40906.5113    0  484 25541.8611 40906.5113  60.2%     -  860s
     0     0 40895.5486    0  485 25541.8611 40895.5486  60.1%     -  864s
     0     0 40890.4699    0  434 25541.8611 40890.4699  60.1%     -  868s
     0     0 40888.1354    0  476 25541.8611 40888.1354  60.1%     -  871s
     0     0 40806.6231    0  499 25541.8611 40806.6231  59.8%     -  888s
     0     0 40790.9550    0  521 25541.8611 40790.9550  59.7%     -  899s
     0     0 40783.7585    0  509 25541.8611 40783.7585  59.7%     -  905s
     0     0 40782.4739    0  508 25541.8611 40782.4739  59.7%     -  908s
     0     0 40765.9661    0  460 25541.8611 40765.9661  59.6%     -  918s
     0     0 40761.6844    0  462 25541.8611 40761.6844  59.6%     -  925s
     0     0 40759.6521    0  467 25541.8611 40759.6521  59.6%     -  928s
     0     0 40749.9784    0  466 25541.8611 40749.9784  59.5%     -  936s
     0     0 40740.9975    0  467 25541.8611 40740.9975  59.5%     -  944s
     0     0 40739.4070    0  474 25541.8611 40739.4070  59.5%     -  947s
     0     0 40734.7572    0  470 25541.8611 40734.7572  59.5%     -  954s
H    0     0                    25549.400185 40734.6054  59.4%     -  984s
     0     0 40732.1229    0  473 25549.4002 40732.1229  59.4%     -  991s
     0     0 40731.5491    0  481 25549.4002 40731.5491  59.4%     -  993s
     0     0 40724.9375    0  454 25549.4002 40724.9375  59.4%     - 1000s
     0     0 40724.6344    0  454 25549.4002 40724.6344  59.4%     - 1005s
     0     2 40724.6344    0  454 25549.4002 40724.6344  59.4%     - 1233s
     1     3 40241.5737    1  492 25549.4002 40724.6344  59.4% 13225 1258s
     2     4 40614.6979    1  444 25549.4002 40614.6979  59.0% 10909 1274s
     3     5 39341.2332    2  480 25549.4002 40614.5485  59.0% 12503 1294s
     4     7 39186.4022    3  423 25549.4002 40614.5485  59.0% 11467 1317s
     6    13 38040.7771    3  323 25549.4002 40614.5485  59.0% 11733 1341s
    12    22 37260.5252    4  321 25549.4002 40195.3856  57.3% 11128 1384s
    21    31 37546.8427    5  394 25549.4002 40195.3856  57.3% 19645 1452s
    30    60 39365.5073    4  317 25549.4002 40028.5740  56.7% 18100 1687s
    59    92 39116.8523    5  350 25549.4002 39698.8331  55.4% 24281 1786s
H   69    92                    25568.401856 39698.8331  55.3% 23136 1786s
    91   204 39004.8297    6  298 25568.4019 39488.7937  54.4% 22846 1910s
   203   273 37650.7561    9  353 25568.4019 39488.7937  54.4% 14734 1960s
   272   353 38402.4753    9  350 25568.4019 39488.7937  54.4% 12966 2007s
   352   434 38437.0233    9  288 25568.4019 39488.7937  54.4% 11243 2048s
   433   490 35449.5873   23  203 25568.4019 39488.7937  54.4%  9940 2086s
   489   530 37219.2423   10  278 25568.4019 39488.7937  54.4%  9446 2128s
   529   559 38333.8601   10  268 25568.4019 39488.7937  54.4%  9204 2169s
   558   600 38016.3362   11  281 25568.4019 39488.7937  54.4%  9141 2211s
   599   626 37851.2690   11  276 25568.4019 39488.7937  54.4%  8859 2245s
   625   670 37296.2903   10  331 25568.4019 39488.7937  54.4%  8718 2277s
   669   732 37295.7937   10  275 25568.4019 39488.7937  54.4%  8422 2306s
   731   796 37068.1457   12  265 25568.4019 39488.7937  54.4%  8045 2348s
H  762   796                    25897.637975 39488.7937  52.5%  7830 2348s
   801   897 31363.5465   48  243 25897.6380 39488.7937  52.5%  7605 2387s
   908   973 37300.8616   12  267 25897.6380 39488.7937  52.5%  7089 2423s
   998  1015 infeasible   57      25897.6380 39488.7937  52.5%  6780 2455s
  1101  1048 36626.2928   11  267 25897.6380 39488.7937  52.5%  6448 2490s
  1176  1122 37231.5035   13  269 25897.6380 39488.7937  52.5%  6296 2528s
  1289  1230 infeasible   28      25897.6380 39488.7937  52.5%  5957 2559s
  1457  1287 37206.0569   14  264 25897.6380 39488.7937  52.5%  5488 2599s
  1619  1429 26703.6392   60  123 25897.6380 39488.7937  52.5%  5186 2635s
  1819  1505     cutoff   60      25897.6380 39282.1984  51.7%  4836 2667s
  2012  1534 36297.3521   13  223 25897.6380 39282.1984  51.7%  4557 2713s
  2141  1590 32820.2455   27  181 25897.6380 39282.1984  51.7%  4452 2755s
  2245  1652 32130.0093   36  192 25897.6380 39282.1984  51.7%  4398 2796s
  2338  1805 32167.7537   39  171 25897.6380 39282.1984  51.7%  4373 2844s
  2510  1971 31702.0034   52  182 25897.6380 39282.1984  51.7%  4236 2886s
  2708  2111 31460.6791   66  142 25897.6380 39282.1984  51.7%  4084 2924s
  2924  2189 30642.4625   76   92 25897.6380 39282.1984  51.7%  3934 2966s
H 3071  2236                    26124.075093 38673.8362  48.0%  3907 3005s
H 3116  2218                    26187.433678 38673.8362  47.7%  3897 3005s
  3163  2337 29019.4588   98  101 26187.4337 38673.8362  47.7%  3891 3052s
  3320  2358 28825.5592  110   86 26187.4337 38673.8362  47.7%  3868 3095s
H 3354  2168                    26926.448813 38673.8362  43.6%  3912 3138s
  3428  2230 37399.6742   10  340 26926.4488 38144.7520  41.7%  3919 3194s
  3540  2334 36309.8639   12  299 26926.4488 38144.0824  41.7%  3955 3248s
  3693  2420 29017.8128   14  254 26926.4488 38144.0824  41.7%  3969 3311s
H 3835  2331                    27321.991127 38144.0824  39.6%  3982 3361s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 194
  MIR: 3391
  Flow cover: 3087
  RLT: 63
  Relax-and-lift: 507
  BQP: 2

Explored 3835 nodes (15994691 simplex iterations) in 3600.04 seconds (7945.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27322 26926.4 26187.4 ... 24101.6

Time limit reached
Best objective 2.732199112665e+04, best bound 3.814408240944e+04, gap 39.6095%
  WARNING: Time limit reached. Using best solution found (gap: 39.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 27321.99, θ = 175955.73
  Upper Bound (UB) = 27321.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 175955.73
  [DEBUG]   ✓ Scenario 0: θ = 175955.73 ≤ Q = 175955.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 175955.73 ≤ Q = 175955.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 175955.73 ≤ Q = 175955.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 175955.73 ≤ Q = 175955.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 175955.73 ≤ Q = 175955.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 175955.73 ≤ Q = 175955.73 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xcdc90d2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0cdc90d2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.394227e+13
Presolve removed 2607 rows and 1899 columns
Presolve time: 0.00s
Presolved: 486 rows, 490 columns, 1373 nonzeros
Found heuristic solution: objective 6573294.0763
Variable types: 332 continuous, 158 integer (158 binary)

Root relaxation: objective -1.644358e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164435.85    0  123 6573294.08 -164435.85   103%     -    0s
H    0     0                    -131497.0128 -164435.85  25.0%     -    0s
     0     0 -137958.06    0   79 -131497.01 -137958.06  4.91%     -    0s
H    0     0                    -132990.7153 -137852.78  3.66%     -    0s
H    0     0                    -135785.3886 -137852.78  1.52%     -    0s
H    0     0                    -136059.0459 -137852.78  1.32%     -    0s
H    0     0                    -136205.7876 -137852.78  1.21%     -    0s
     0     0 -137291.86    0   81 -136205.79 -137291.86  0.80%     -    0s
     0     0 -137287.12    0   81 -136205.79 -137287.12  0.79%     -    0s
     0     0 -136932.44    0   62 -136205.79 -136932.44  0.53%     -    0s
     0     0 -136828.72    0   34 -136205.79 -136828.72  0.46%     -    0s
     0     0 -136796.17    0   41 -136205.79 -136796.17  0.43%     -    0s
     0     0 -136794.78    0   41 -136205.79 -136794.78  0.43%     -    0s
     0     0 -136596.66    0   61 -136205.79 -136596.66  0.29%     -    0s
     0     0 -136563.80    0   58 -136205.79 -136563.80  0.26%     -    0s
     0     0 -136559.40    0   57 -136205.79 -136559.40  0.26%     -    0s
     0     0 -136556.71    0   55 -136205.79 -136556.71  0.26%     -    0s
     0     0 -136555.15    0   56 -136205.79 -136555.15  0.26%     -    0s
     0     0 -136547.56    0   55 -136205.79 -136547.56  0.25%     -    0s
     0     0 -136485.95    0   19 -136205.79 -136485.95  0.21%     -    0s
     0     0 -136404.90    0   24 -136205.79 -136404.90  0.15%     -    0s
     0     0 -136403.71    0   14 -136205.79 -136403.71  0.15%     -    0s
     0     0 -136361.19    0   15 -136205.79 -136361.19  0.11%     -    0s
     0     0 -136352.25    0   16 -136205.79 -136352.25  0.11%     -    0s
     0     0 -136309.43    0   12 -136205.79 -136309.43  0.08%     -    0s
     0     0 -136309.43    0   27 -136205.79 -136309.43  0.08%     -    0s
     0     0 -136309.43    0   23 -136205.79 -136309.43  0.08%     -    0s
     0     0 -136309.43    0   22 -136205.79 -136309.43  0.08%     -    0s
     0     0 -136256.39    0    2 -136205.79 -136256.39  0.04%     -    0s
H    0     0                    -136252.1659 -136252.17  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 11
  Flow cover: 10

Explored 1 nodes (879 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -136252 -136206 -136059 ... 1.39423e+13
No other solutions better than -136252

Optimal solution found (tolerance 1.00e-04)
Best objective -1.362521659213e+05, best bound -1.362521659213e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 173493.69
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136252.17
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -136252.17 = 173493.69
  [DEBUG]   Current θ from Master = 175955.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2462.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24859.96
  Lower Bound (LB) = 24859.96
  Gap (UB-LB) = 2462.0344, Absolute Gap = 2462.0344, Relative Gap = 0.090112
  Not converged yet (gap = 2462.03 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783623 nonzeros
Model fingerprint: 0x3767a473
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 129518 rows and 52618 columns
Presolve time: 2.73s
Presolved: 147085 rows, 61962 columns, 906757 nonzeros
Variable types: 59703 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 678
 AA' NZ     : 7.049e+06
 Factor NZ  : 1.619e+07 (roughly 200 MB of memory)
 Factor Ops : 4.074e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.02148210e+07  2.80366377e+08  1.34e+05 1.79e+01  9.19e+04     5s
   1  -1.57995589e+07  2.54651877e+08  9.60e+04 9.21e+01  6.52e+04     5s
   2  -5.00613103e+06  1.98290299e+08  2.95e+04 1.10e+01  2.12e+04     5s
   3  -1.12562211e+06  1.38505607e+08  3.37e+03 1.13e+00  2.81e+03     5s
   4  -6.52425023e+05  7.75902433e+07  6.65e+02 3.97e-01  7.09e+02     5s
   5  -5.45811465e+05  4.99525392e+07  3.50e+02 2.12e-01  3.91e+02     5s
   6  -4.05656768e+05  3.75007405e+07  1.16e+02 1.45e-01  2.04e+02     5s
   7  -3.64923445e+05  2.64442600e+07  5.70e+01 9.50e-02  1.27e+02     5s
   8  -2.41085392e+05  1.84294466e+07  1.41e+01 6.32e-02  7.51e+01     5s
   9  -1.98498102e+05  1.14698660e+07  1.02e+01 3.79e-02  4.62e+01     5s
  10  -1.44818971e+05  6.89865084e+06  5.58e+00 2.18e-02  2.73e+01     5s
  11  -1.07818850e+05  2.38790347e+06  2.39e+00 7.08e-03  9.48e+00     5s
  12  -6.37238741e+04  1.23372602e+06  7.05e-01 3.59e-03  4.87e+00     5s
  13  -3.72209953e+04  4.47195957e+05  3.22e-01 1.25e-03  1.81e+00     6s
  14  -1.44508265e+04  3.09538110e+05  1.92e-01 9.28e-04  1.21e+00     6s
  15   8.42368521e+02  2.15225591e+05  1.34e-01 7.32e-04  8.01e-01     6s
  16   9.87534990e+03  1.60025708e+05  1.09e-01 1.95e-03  5.61e-01     6s
  17   1.74606700e+04  1.32439508e+05  8.99e-02 1.79e-03  4.30e-01     6s
  18   2.46092856e+04  1.07346645e+05  7.18e-02 1.59e-03  3.09e-01     6s
  19   2.95733749e+04  8.95829857e+04  5.90e-02 1.78e-03  2.24e-01     6s
  20   3.28986193e+04  8.50701008e+04  5.12e-02 1.95e-03  1.95e-01     6s
  21   3.84218585e+04  8.03680738e+04  3.87e-02 1.30e-03  1.57e-01     6s
  22   3.99309326e+04  7.21692243e+04  3.54e-02 1.61e-03  1.21e-01     6s
  23   4.52825668e+04  6.99435381e+04  2.42e-02 1.39e-03  9.22e-02     6s
  24   4.64474271e+04  6.80757572e+04  2.19e-02 1.17e-03  8.08e-02     6s
  25   4.85590775e+04  6.50536474e+04  1.77e-02 8.27e-04  6.17e-02     6s
  26   5.03260651e+04  6.31554976e+04  1.41e-02 6.00e-04  4.80e-02     7s
  27   5.23893254e+04  6.17279727e+04  1.01e-02 4.36e-04  3.49e-02     7s
  28   5.29721355e+04  6.09404042e+04  9.01e-03 3.49e-04  2.98e-02     7s
  29   5.36581824e+04  6.03747749e+04  7.67e-03 3.10e-04  2.51e-02     7s
  30   5.45978704e+04  5.96152904e+04  5.93e-03 1.92e-04  1.88e-02     7s
  31   5.50930018e+04  5.93608184e+04  5.05e-03 1.64e-04  1.60e-02     7s
  32   5.56780708e+04  5.91738051e+04  4.00e-03 1.39e-04  1.31e-02     7s
  33   5.63147128e+04  5.87894998e+04  2.86e-03 1.12e-04  9.25e-03     7s
  34   5.68690730e+04  5.85684938e+04  1.90e-03 7.88e-05  6.35e-03     7s
  35   5.71731879e+04  5.83375619e+04  1.38e-03 9.22e-05  4.35e-03     7s
  36   5.76558815e+04  5.81295774e+04  5.64e-04 1.22e-04  1.77e-03     8s
  37   5.78633302e+04  5.80574496e+04  2.32e-04 4.96e-05  7.26e-04     8s
  38   5.79837515e+04  5.80303543e+04  4.61e-05 2.99e-05  1.74e-04     8s
  39   5.80151989e+04  5.80219185e+04  3.63e-06 9.68e-06  2.51e-05     8s
  40   5.80176329e+04  5.80186147e+04  6.19e-07 3.87e-07  3.67e-06     8s
  41   5.80183687e+04  5.80183777e+04  4.51e-09 1.64e-08  3.33e-08     8s
  42   5.80183754e+04  5.80183754e+04  7.25e-10 5.83e-11  4.41e-11     8s

Barrier solved model in 42 iterations and 8.06 seconds (12.94 work units)
Optimal objective 5.80183754e+04


Root crossover log...

  131617 DPushes remaining with DInf 0.0000000e+00                 8s
   44949 DPushes remaining with DInf 0.0000000e+00                10s
    1345 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    1743 PPushes remaining with PInf 6.9630412e-06                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7280122e-10     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58977    5.8018375e+04   0.000000e+00   0.000000e+00     16s
   58977    5.8018375e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.801838e+04, 58977 iterations, 12.68 seconds (20.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 58018.3754    0  154 -187498.33 58018.3754   131%     -   16s
H    0     0                    -133060.9172 58018.3754   144%     -   17s
H    0     0                    -132633.3636 58018.3754   144%     -   17s
H    0     0                    -132471.0459 58018.3754   144%     -   17s
H    0     0                    -54160.17059 58018.3754   207%     -   17s
H    0     0                    -1691.406989 58018.3754  3530%     -   18s
H    0     0                    13657.647048 58018.3754   325%     -   18s
H    0     0                    13700.747434 58018.3754   323%     -   18s
H    0     0                    14004.250663 58018.3754   314%     -   18s
     0     0 50840.3643    0  245 14004.2507 50840.3643   263%     -   94s
H    0     0                    15517.915931 50840.3194   228%     -   95s
H    0     0                    15598.477908 50840.3194   226%     -   96s
H    0     0                    15619.724070 50840.3194   225%     -   96s
     0     0 50321.4036    0  272 15619.7241 50321.4036   222%     -  125s
     0     0 50276.1061    0  274 15619.7241 50276.1061   222%     -  142s
     0     0 50263.6233    0  267 15619.7241 50263.6233   222%     -  149s
     0     0 50262.3681    0  274 15619.7241 50262.3681   222%     -  152s
     0     0 50242.0556    0  265 15619.7241 50242.0556   222%     -  163s
     0     0 50233.2198    0  262 15619.7241 50233.2198   222%     -  166s
     0     0 50231.8374    0  265 15619.7241 50231.8374   222%     -  169s
     0     0 50230.6905    0  266 15619.7241 50230.6905   222%     -  170s
     0     0 50229.0370    0  265 15619.7241 50229.0370   222%     -  171s
     0     0 50214.7694    0  266 15619.7241 50214.7694   221%     -  173s
     0     0 50214.6105    0  265 15619.7241 50214.6105   221%     -  174s
     0     0 46822.0225    0  279 15619.7241 46822.0225   200%     -  247s
H    0     0                    22447.804756 46821.8910   109%     -  247s
H    0     0                    22519.763175 46821.8910   108%     -  247s
     0     0 46162.4687    0  338 22519.7632 46162.4687   105%     -  282s
     0     0 45863.1549    0  398 22519.7632 45863.1549   104%     -  314s
     0     0 45812.3250    0  384 22519.7632 45812.3250   103%     -  330s
     0     0 45693.9428    0  307 22519.7632 45693.9428   103%     -  353s
     0     0 45531.9312    0  363 22519.7632 45531.9312   102%     -  374s
     0     0 45508.8129    0  366 22519.7632 45508.8129   102%     -  383s
     0     0 45491.4308    0  409 22519.7632 45491.4308   102%     -  391s
     0     0 45481.1226    0  375 22519.7632 45481.1226   102%     -  398s
     0     0 45400.5974    0  416 22519.7632 45400.5974   102%     -  414s
     0     0 45384.6568    0  423 22519.7632 45384.6568   102%     -  424s
     0     0 45373.0389    0  415 22519.7632 45373.0389   101%     -  432s
     0     0 45353.4837    0  364 22519.7632 45353.4837   101%     -  437s
     0     0 45287.6335    0  411 22519.7632 45287.6335   101%     -  448s
     0     0 45267.2102    0  416 22519.7632 45267.2102   101%     -  454s
     0     0 45265.9287    0  409 22519.7632 45265.9287   101%     -  456s
     0     0 43049.4354    0  405 22519.7632 43049.4354  91.2%     -  545s
     0     0 42761.4628    0  411 22519.7632 42761.4628  89.9%     -  590s
     0     0 42646.8147    0  409 22519.7632 42646.8147  89.4%     -  612s
     0     0 42572.4497    0  398 22519.7632 42572.4497  89.0%     -  631s
     0     0 42509.0308    0  419 22519.7632 42509.0308  88.8%     -  646s
     0     0 42474.5801    0  419 22519.7632 42474.5801  88.6%     -  658s
     0     0 42448.4084    0  418 22519.7632 42448.4084  88.5%     -  667s
     0     0 42428.1300    0  420 22519.7632 42428.1300  88.4%     -  676s
     0     0 42423.3356    0  418 22519.7632 42423.3356  88.4%     -  681s
     0     0 42413.2897    0  424 22519.7632 42413.2897  88.3%     -  689s
     0     0 42398.2488    0  409 22519.7632 42398.2488  88.3%     -  697s
     0     0 42394.2630    0  423 22519.7632 42394.2630  88.3%     -  701s
     0     0 42359.4671    0  417 22519.7632 42359.4671  88.1%     -  716s
     0     0 42339.8208    0  415 22519.7632 42339.8208  88.0%     -  726s
     0     0 42296.9788    0  413 22519.7632 42296.9788  87.8%     -  737s
     0     0 42283.0931    0  415 22519.7632 42283.0931  87.8%     -  745s
     0     0 42245.5118    0  415 22519.7632 42245.5118  87.6%     -  754s
     0     0 42238.9299    0  426 22519.7632 42238.9299  87.6%     -  760s
     0     0 42234.8533    0  426 22519.7632 42234.8533  87.5%     -  763s
     0     0 42224.5462    0  420 22519.7632 42224.5462  87.5%     -  768s
     0     0 42223.0904    0  418 22519.7632 42223.0904  87.5%     -  770s
     0     0 41591.8967    0  422 22519.7632 41591.8967  84.7%     -  840s
     0     0 41431.3506    0  469 22519.7632 41431.3506  84.0%     -  875s
     0     0 41398.3920    0  436 22519.7632 41398.3920  83.8%     -  887s
     0     0 41384.9577    0  473 22519.7632 41384.9577  83.8%     -  895s
     0     0 41377.9749    0  440 22519.7632 41377.9749  83.7%     -  900s
     0     0 41343.0102    0  430 22519.7632 41343.0102  83.6%     -  914s
     0     0 41316.8544    0  436 22519.7632 41316.8544  83.5%     -  923s
     0     0 41277.1901    0  443 22519.7632 41277.1901  83.3%     -  935s
     0     0 41270.6085    0  478 22519.7632 41270.6085  83.3%     -  940s
     0     0 41265.6771    0  475 22519.7632 41265.6771  83.2%     -  944s
     0     0 41250.9479    0  443 22519.7632 41250.9479  83.2%     -  952s
     0     0 41247.7948    0  445 22519.7632 41247.7948  83.2%     -  955s
     0     0 41235.1327    0  426 22519.7632 41235.1327  83.1%     -  962s
     0     0 41232.0351    0  435 22519.7632 41232.0351  83.1%     -  965s
     0     0 41219.2224    0  475 22519.7632 41219.2224  83.0%     -  972s
     0     0 41218.0490    0  432 22519.7632 41218.0490  83.0%     -  974s
     0     0 41078.1747    0  461 22519.7632 41078.1747  82.4%     - 1000s
H    0     0                    22552.208010 41076.5345  82.1%     - 1001s
     0     0 41051.6026    0  430 22552.2080 41051.6026  82.0%     - 1015s
     0     0 41042.7147    0  434 22552.2080 41042.7147  82.0%     - 1026s
     0     0 41038.2754    0  434 22552.2080 41038.2754  82.0%     - 1034s
     0     0 41034.2960    0  427 22552.2080 41034.2960  82.0%     - 1042s
     0     0 41033.0576    0  480 22552.2080 41033.0576  81.9%     - 1048s
     0     0 40979.3143    0  478 22552.2080 40979.3143  81.7%     - 1075s
H    0     0                    23732.141208 40979.1901  72.7%     - 1088s
     0     0 40963.7573    0  494 23732.1412 40963.7573  72.6%     - 1102s
     0     0 40948.0214    0  500 23732.1412 40948.0214  72.5%     - 1114s
     0     0 40920.0066    0  443 23732.1412 40920.0066  72.4%     - 1122s
     0     0 40914.4648    0  454 23732.1412 40914.4648  72.4%     - 1128s
     0     0 40909.2417    0  500 23732.1412 40909.2417  72.4%     - 1133s
     0     0 40907.1903    0  495 23732.1412 40907.1903  72.4%     - 1137s
     0     0 40873.9719    0  443 23732.1412 40873.9719  72.2%     - 1155s
H    0     0                    23753.387370 40873.5396  72.1%     - 1156s
     0     0 40865.4394    0  489 23753.3874 40865.4394  72.0%     - 1165s
     0     0 40862.9689    0  491 23753.3874 40862.9689  72.0%     - 1170s
     0     0 40861.4004    0  497 23753.3874 40861.4004  72.0%     - 1174s
     0     0 40833.7040    0  480 23753.3874 40833.7040  71.9%     - 1192s
H    0     0                    24971.652114 40833.6810  63.5%     - 1194s
     0     0 40831.2074    0  442 24971.6521 40831.2074  63.5%     - 1200s
     0     0 40830.1990    0  456 24971.6521 40830.1990  63.5%     - 1203s
     0     0 40808.1299    0  385 24971.6521 40808.1299  63.4%     - 1219s
     0     0 40796.8465    0  398 24971.6521 40796.8465  63.4%     - 1229s
     0     0 40793.6828    0  456 24971.6521 40793.6828  63.4%     - 1235s
     0     0 40787.1060    0  503 24971.6521 40787.1060  63.3%     - 1241s
     0     0 40785.6347    0  394 24971.6521 40785.6347  63.3%     - 1245s
     0     0 40772.5483    0  490 24971.6521 40772.5483  63.3%     - 1266s
H    0     0                    25469.323787 40772.4966  60.1%     - 1295s
     0     0 40761.9451    0  495 25469.3238 40761.9451  60.0%     - 1307s
     0     0 40758.1745    0  514 25469.3238 40758.1745  60.0%     - 1313s
     0     0 40756.5848    0  452 25469.3238 40756.5848  60.0%     - 1318s
     0     0 40750.9046    0  501 25469.3238 40750.9046  60.0%     - 1327s
     0     0 40749.5092    0  501 25469.3238 40749.5092  60.0%     - 1336s
     0     0 40745.6581    0  509 25469.3238 40745.6581  60.0%     - 1347s
     0     0 40744.5590    0  511 25469.3238 40744.5590  60.0%     - 1350s
     0     0 40744.1621    0  458 25469.3238 40744.1621  60.0%     - 1354s
     0     0 40744.1083    0  458 25469.3238 40744.1083  60.0%     - 1359s
H    0     0                    25509.416231 40744.1083  59.7%     - 1591s
H    0     0                    25541.861067 40744.1083  59.5%     - 1595s
     0     2 40744.1083    0  458 25541.8611 40744.1083  59.5%     - 1597s
     1     3 40430.9972    1  428 25541.8611 40744.0938  59.5% 15376 1623s
     2     4 40632.4336    1  445 25541.8611 40632.4336  59.1% 12506 1638s
     3     6 40561.2761    2  448 25541.8611 40632.3581  59.1% 11376 1663s
     5    11 38527.1899    3  404 25541.8611 40632.3581  59.1% 13508 1687s
    10    18 38099.5930    4  293 25541.8611 40561.1868  58.8% 11486 1734s
    17    25 37211.7557    5  353 25541.8611 40463.0575  58.4% 19637 1805s
    24    47 39557.5471    5  447 25541.8611 39838.5886  56.0% 18249 1943s
    46    79 39514.8722    6  453 25541.8611 39838.5886  56.0% 22950 1995s
    78   120 39427.8568    7  433 25541.8611 39838.5886  56.0% 22237 2038s
   119   152 39231.3707    8  367 25541.8611 39838.5886  56.0% 17252 2094s
   151   195 39230.6468    9  358 25541.8611 39838.5886  56.0% 15764 2138s
   194   228 38908.7040   10  358 25541.8611 39838.5886  56.0% 13433 2188s
H  197   228                    25581.940657 39838.5886  55.7% 13269 2188s
H  208   228                    25642.307046 39838.5886  55.4% 12896 2188s
   227   288 38616.5066   11  345 25642.3070 39838.5886  55.4% 12484 2242s
   287   344 38510.2902   12  350 25642.3070 39838.5886  55.4% 11526 2303s
   343   389 36521.4691   14  275 25642.3070 39838.5886  55.4% 10754 2350s
   390   441 35891.6603   16  272 25642.3070 39838.5886  55.4% 10291 2403s
   442   493 30837.5551   17  275 25642.3070 39838.5886  55.4%  9902 2466s
   506   576 31921.0630   13  299 25642.3070 39838.5886  55.4%  9480 2510s
   593   663 31885.7463   14  338 25642.3070 39838.5886  55.4%  8854 2548s
   684   741 31596.8782   19  280 25642.3070 39838.5886  55.4%  8238 2582s
   766   830 31414.6414   21  308 25642.3070 39838.5886  55.4%  7721 2612s
   863   898 31291.0412   24  386 25642.3070 39838.5886  55.4%  7251 2644s
   938   952 31246.7966   25  282 25642.3070 39838.5886  55.4%  6979 2690s
   998  1000 30819.0354   34  226 25642.3070 39838.5886  55.4%  6858 2722s
  1063  1105 31099.6156   24  269 25642.3070 39838.5886  55.4%  6711 2760s
  1187  1233 29253.1870   26  270 25642.3070 39838.5886  55.4%  6289 2792s
  1349  1257 28382.9351   27  264 25642.3070 39838.5886  55.4%  5756 2817s
  1385  1291 27756.8237   28  290 25642.3070 39838.5886  55.4%  5716 2845s
  1433  1350 27362.3746   29  208 25642.3070 39838.5886  55.4%  5621 2880s
  1501  1407 27182.9655   30  174 25642.3070 39838.5886  55.4%  5482 2916s
  1625  1544 27123.1764   31  180 25642.3070 39838.5886  55.4%  5225 2951s
  1806  1728 26551.7631   32  179 25642.3070 39838.5886  55.4%  4918 2988s
  2045  1876     cutoff   37      25642.3070 39838.5886  55.4%  4519 3025s
  2280  2037 infeasible   40      25642.3070 39838.5886  55.4%  4214 3076s
  2496  2174 infeasible   66      25642.3070 39838.5886  55.4%  3990 3121s
  2723  2268 26851.1942   73  139 25642.3070 39838.5886  55.4%  3802 3166s
  2930  2319     cutoff   50      25642.3070 39838.5886  55.4%  3683 3211s
  3078  2421 27907.0699   58  113 25642.3070 39838.5886  55.4%  3614 3259s
  3225  2529 26723.4847   65   95 25642.3070 39838.5886  55.4%  3583 3311s
  3415  2617 26392.8304   80   72 25642.3070 39838.5886  55.4%  3515 3367s
  3582  2677     cutoff   93      25642.3070 39838.5886  55.4%  3490 3422s
  3704  2699 26831.6509   58   97 25642.3070 39096.9074  52.5%  3520 3471s
  3734  2725     cutoff   18      25642.3070 39096.9074  52.5%  3580 3521s
  3764  2749 27794.0056   59  147 25642.3070 39096.9074  52.5%  3634 3566s
  3804  2773 infeasible   61      25642.3070 39096.9074  52.5%  3685 3600s

Cutting planes:
  Learned: 2
  Gomory: 9
  Implied bound: 151
  MIR: 3351
  Flow cover: 3197
  RLT: 70
  Relax-and-lift: 585

Explored 3850 nodes (14996589 simplex iterations) in 3600.09 seconds (7818.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25642.3 25581.9 25541.9 ... 22519.8

Time limit reached
Best objective 2.564230704620e+04, best bound 3.909690740911e+04, gap 52.4703%
  WARNING: Time limit reached. Using best solution found (gap: 52.47%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 25642.31, θ = 177710.23
  Upper Bound (UB) = 25642.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 177710.23
  [DEBUG]   ✓ Scenario 0: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 177710.23 ≤ Q = 177710.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 177710.23 ≤ Q = 177710.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 177710.23 ≤ Q = 177710.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 177710.23 ≤ Q = 177710.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 177710.23 ≤ Q = 177710.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 177710.23 ≤ Q = 177710.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 177710.23 ≤ Q = 177710.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 177710.23 ≤ Q = 177710.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2144a7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xffdebb59
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.413985e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.01s
Presolved: 488 rows, 492 columns, 1379 nonzeros
Found heuristic solution: objective 6565309.1925
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.651122e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165112.18    0  124 6565309.19 -165112.18   103%     -    0s
H    0     0                    -132310.2637 -165112.18  24.8%     -    0s
     0     0 -144682.17    0   59 -132310.26 -144682.17  9.35%     -    0s
H    0     0                    -143104.4921 -144611.77  1.05%     -    0s
     0     0 -144573.87    0   49 -143104.49 -144573.87  1.03%     -    0s
H    0     0                    -143710.4489 -144534.68  0.57%     -    0s
     0     0 -144534.68    0   58 -143710.45 -144534.68  0.57%     -    0s
     0     0 -144015.49    0   35 -143710.45 -144015.49  0.21%     -    0s
     0     0 -144001.42    0   32 -143710.45 -144001.42  0.20%     -    0s
     0     0 -143990.06    0   31 -143710.45 -143990.06  0.19%     -    0s
     0     0 -143978.92    0   29 -143710.45 -143978.92  0.19%     -    0s
     0     0 -143959.97    0   26 -143710.45 -143959.97  0.17%     -    0s
     0     0 -143947.13    0   21 -143710.45 -143947.13  0.16%     -    0s
     0     0 -143944.56    0   14 -143710.45 -143944.56  0.16%     -    0s
H    0     0                    -143747.4726 -143935.30  0.13%     -    0s
     0     0 -143902.47    0   15 -143747.47 -143902.47  0.11%     -    0s
     0     0 -143862.63    0   12 -143747.47 -143862.63  0.08%     -    0s
     0     0 -143862.63    0   12 -143747.47 -143862.63  0.08%     -    0s
H    0     0                    -143757.5408 -143862.63  0.07%     -    0s
     0     0 -143820.09    0    8 -143757.54 -143820.09  0.04%     -    0s
H    0     0                    -143792.3970 -143816.18  0.02%     -    0s
     0     0 -143816.18    0    9 -143792.40 -143816.18  0.02%     -    0s
     0     0 -143815.95    0    8 -143792.40 -143815.95  0.02%     -    0s
     0     0 -143815.68    0    8 -143792.40 -143815.68  0.02%     -    0s
     0     0 -143815.38    0    7 -143792.40 -143815.38  0.02%     -    0s
H    0     0                    -143798.8042 -143815.38  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 6
  MIR: 5
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (616 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -143799 -143792 -143758 ... 1.41399e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.437988042250e+05, best bound -1.438084897819e+05, gap 0.0067%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 165947.06
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143798.80
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -143798.80 = 165947.06
  [DEBUG]   Current θ from Master = 177710.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11763.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13879.14
  Lower Bound (LB) = 24859.96
  Gap (UB-LB) = 782.3503, Absolute Gap = 782.3503, Relative Gap = 0.030510
  Not converged yet (gap = 782.35 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826851 nonzeros
Model fingerprint: 0x2a4f481e
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 136729 rows and 55549 columns
Presolve time: 3.86s
Presolved: 155164 rows, 65271 columns, 956654 nonzeros
Variable types: 63012 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -187498.3309

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 678
 AA' NZ     : 7.773e+06
 Factor NZ  : 1.778e+07 (roughly 230 MB of memory)
 Factor Ops : 4.648e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.06412630e+07  2.93753553e+08  1.37e+05 1.75e+01  9.34e+04     6s
   1  -1.61619296e+07  2.67555722e+08  9.80e+04 9.20e+01  6.63e+04     6s
   2  -5.23278592e+06  2.08794372e+08  3.08e+04 1.26e+01  2.20e+04     6s
   3  -1.18816044e+06  1.47270020e+08  3.73e+03 5.26e-01  3.04e+03     6s
   4  -6.68565028e+05  1.16033547e+08  7.18e+02 3.53e-01  8.79e+02     6s
   5  -5.90854615e+05  7.37044302e+07  4.07e+02 1.91e-01  5.04e+02     6s
   6  -4.79156141e+05  4.81354449e+07  1.36e+02 1.20e-01  2.46e+02     6s
   7  -4.13587191e+05  3.60649868e+07  6.22e+01 8.56e-02  1.59e+02     7s
   8  -3.50066303e+05  2.46454546e+07  2.72e+01 5.63e-02  9.94e+01     7s
   9  -2.56215105e+05  1.81084184e+07  1.09e+01 4.02e-02  6.85e+01     7s
  10  -2.11971569e+05  1.02987028e+07  7.36e+00 2.20e-02  3.87e+01     7s
  11  -1.46818536e+05  5.26565217e+06  3.53e+00 1.06e-02  1.96e+01     7s
  12  -1.16899738e+05  3.11546970e+06  2.20e+00 6.40e-03  1.16e+01     7s
  13  -9.65001820e+04  2.32185109e+06  1.48e+00 4.78e-03  8.64e+00     7s
  14  -6.41297910e+04  1.52820898e+06  7.29e-01 3.19e-03  5.66e+00     7s
  15  -3.52826000e+04  5.07012672e+05  2.95e-01 9.22e-04  1.92e+00     7s
  16  -2.66476491e+03  3.06174245e+05  1.27e-01 8.01e-04  1.09e+00     7s
  17   7.51338758e+03  2.17861365e+05  9.78e-02 8.44e-04  7.45e-01     7s
  18   1.95487710e+04  1.42538531e+05  7.01e-02 1.30e-03  4.35e-01     7s
  19   2.65329635e+04  1.08301074e+05  5.57e-02 2.43e-03  2.90e-01     7s
  20   3.15836207e+04  9.12404249e+04  4.54e-02 1.42e-03  2.11e-01     8s
  21   3.74967127e+04  8.39866065e+04  3.35e-02 1.46e-03  1.65e-01     8s
  22   4.19686551e+04  7.87138355e+04  2.52e-02 1.16e-03  1.30e-01     8s
  23   4.59043034e+04  7.39495245e+04  1.83e-02 8.99e-04  9.93e-02     8s
  24   4.64594481e+04  7.02895471e+04  1.73e-02 7.15e-04  8.44e-02     8s
  25   4.89014050e+04  6.75365067e+04  1.34e-02 5.56e-04  6.60e-02     8s
  26   5.03541026e+04  6.59702428e+04  1.10e-02 4.67e-04  5.53e-02     8s
  27   5.21806275e+04  6.30600870e+04  8.18e-03 3.03e-04  3.85e-02     8s
  28   5.32612079e+04  6.22542208e+04  6.64e-03 2.59e-04  3.19e-02     8s
  29   5.41130194e+04  6.14224912e+04  5.32e-03 2.34e-04  2.59e-02     9s
  30   5.46059487e+04  6.07793387e+04  4.57e-03 1.85e-04  2.19e-02     9s
  31   5.50761331e+04  5.99506892e+04  3.90e-03 1.30e-04  1.73e-02     9s
  32   5.56935670e+04  5.97711851e+04  3.03e-03 1.18e-04  1.44e-02     9s
  33   5.65979666e+04  5.91273035e+04  1.79e-03 7.43e-05  8.96e-03     9s
  34   5.71316506e+04  5.85277617e+04  1.10e-03 7.75e-05  4.95e-03     9s
  35   5.75643020e+04  5.81952578e+04  5.39e-04 8.73e-05  2.24e-03     9s
  36   5.79000523e+04  5.80865797e+04  1.34e-04 3.28e-05  6.61e-04     9s
  37   5.79920997e+04  5.80359362e+04  2.61e-05 8.09e-06  1.55e-04     9s
  38   5.80155852e+04  5.80216549e+04  2.23e-06 1.45e-06  2.15e-05    10s
  39   5.80168505e+04  5.80186242e+04  1.21e-06 7.33e-08  6.28e-06    10s
  40   5.80183599e+04  5.80183788e+04  1.20e-08 1.95e-08  6.67e-08    10s
  41   5.80183751e+04  5.80183754e+04  7.80e-09 4.77e-11  1.16e-09    10s

Barrier solved model in 41 iterations and 9.90 seconds (13.76 work units)
Optimal objective 5.80183751e+04


Root crossover log...

  138737 DPushes remaining with DInf 0.0000000e+00                10s
   78505 DPushes remaining with DInf 0.0000000e+00                11s
   20813 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

   15317 PPushes remaining with PInf 2.1824122e-04                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.7741329e+04     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   84766    5.8018375e+04   0.000000e+00   9.774133e+04     19s
   85292    5.8018375e+04   0.000000e+00   1.370169e+02     20s
   85850    5.8018375e+04   0.000000e+00   0.000000e+00     21s
   85850    5.8018375e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 2.74s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.801838e+04, 85850 iterations, 18.81 seconds (25.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 58018.3754    0  154 -187498.33 58018.3754   131%     -   24s
H    0     0                    -179271.8569 58018.3754   132%     -   25s
H    0     0                    -170659.7907 58018.3754   134%     -   25s
H    0     0                    -169402.6320 58018.3754   134%     -   26s
H    0     0                    -167462.6263 58018.3754   135%     -   27s
H    0     0                    -167450.0645 58018.3754   135%     -   27s
H    0     0                    -167424.8262 58018.3754   135%     -   27s
H    0     0                    -167366.8961 58018.3754   135%     -   27s
H    0     0                    -167303.6001 58018.3754   135%     -   27s
H    0     0                    -158167.2687 58018.3754   137%     -   27s
H    0     0                    -157996.8097 58018.3754   137%     -   28s
H    0     0                    -48216.66197 58018.3754   220%     -   28s
H    0     0                    -27618.88317 58018.3754   310%     -   28s
H    0     0                    -24935.08044 58018.3754   333%     -   28s
H    0     0                    -24394.64367 58018.3754   338%     -   28s
     0     0 50900.8424    0  222 -24394.644 50900.8424   309%     -  114s
H    0     0                    -10545.30831 50900.8270   583%     -  116s
H    0     0                    -4003.970929 50900.8270  1371%     -  116s
H    0     0                    -3760.732613 50900.8270  1453%     -  116s
     0     0 50386.0353    0  264 -3760.7326 50386.0353  1440%     -  150s
     0     0 50338.0784    0  267 -3760.7326 50338.0784  1439%     -  164s
     0     0 50304.8151    0  266 -3760.7326 50304.8151  1438%     -  178s
     0     0 50273.3037    0  268 -3760.7326 50273.3037  1437%     -  190s
     0     0 50254.8774    0  263 -3760.7326 50254.8774  1436%     -  199s
     0     0 50226.4717    0  267 -3760.7326 50226.4717  1436%     -  211s
     0     0 50218.5011    0  267 -3760.7326 50218.5011  1435%     -  217s
     0     0 50213.7107    0  264 -3760.7326 50213.7107  1435%     -  218s
     0     0 50212.6701    0  267 -3760.7326 50212.6701  1435%     -  220s
     0     0 50195.3297    0  269 -3760.7326 50195.3297  1435%     -  225s
     0     0 50193.2852    0  271 -3760.7326 50193.2852  1435%     -  226s
     0     0 50191.8603    0  278 -3760.7326 50191.8603  1435%     -  226s
     0     0 50189.9111    0  278 -3760.7326 50189.9111  1435%     -  227s
     0     0 46770.2090    0  302 -3760.7326 46770.2090  1344%     -  317s
H    0     0                    14448.245182 46769.9097   224%     -  318s
H    0     0                    18606.420653 46769.9097   151%     -  318s
H    0     0                    18920.368958 46769.9097   147%     -  318s
     0     0 46025.6816    0  382 18920.3690 46025.6816   143%     -  370s
     0     0 45929.4257    0  419 18920.3690 45929.4257   143%     -  396s
     0     0 45732.9087    0  413 18920.3690 45732.9087   142%     -  425s
     0     0 45530.0306    0  390 18920.3690 45530.0306   141%     -  447s
     0     0 45437.1568    0  410 18920.3690 45437.1568   140%     -  465s
     0     0 45429.5166    0  419 18920.3690 45429.5166   140%     -  473s
     0     0 45422.1645    0  403 18920.3690 45422.1645   140%     -  481s
     0     0 45406.5298    0  421 18920.3690 45406.5298   140%     -  491s
     0     0 45394.8754    0  421 18920.3690 45394.8754   140%     -  498s
     0     0 45387.6154    0  406 18920.3690 45387.6154   140%     -  502s
     0     0 45249.2987    0  392 18920.3690 45249.2987   139%     -  523s
     0     0 45214.5334    0  417 18920.3690 45214.5334   139%     -  533s
     0     0 45209.3045    0  417 18920.3690 45209.3045   139%     -  539s
     0     0 45207.3167    0  417 18920.3690 45207.3167   139%     -  541s
     0     0 45207.2968    0  417 18920.3690 45207.2968   139%     -  541s
     0     0 43246.2938    0  351 18920.3690 43246.2938   129%     -  672s
H    0     0                    18966.131580 43246.2446   128%     -  673s
H    0     0                    19150.181535 43246.2446   126%     -  673s
H    0     0                    19181.204770 43246.2446   125%     -  673s
     0     0 42774.9938    0  399 19181.2048 42774.9938   123%     -  716s
     0     0 42643.5049    0  411 19181.2048 42643.5049   122%     -  747s
     0     0 42601.5268    0  424 19181.2048 42601.5268   122%     -  760s
     0     0 42541.3636    0  419 19181.2048 42541.3636   122%     -  775s
     0     0 42455.2279    0  420 19181.2048 42455.2279   121%     -  794s
     0     0 42449.2644    0  421 19181.2048 42449.2644   121%     -  800s
     0     0 42431.5726    0  424 19181.2048 42431.5726   121%     -  808s
     0     0 42408.7045    0  423 19181.2048 42408.7045   121%     -  817s
     0     0 42392.6595    0  422 19181.2048 42392.6595   121%     -  825s
     0     0 42377.5552    0  424 19181.2048 42377.5552   121%     -  834s
     0     0 42371.0346    0  417 19181.2048 42371.0346   121%     -  837s
     0     0 42369.8055    0  421 19181.2048 42369.8055   121%     -  839s
     0     0 41613.9475    0  482 19181.2048 41613.9475   117%     -  917s
H    0     0                    19265.417233 41613.8177   116%     -  918s
H    0     0                    19452.466798 41613.8177   114%     -  918s
H    0     0                    20028.293676 41613.8177   108%     -  919s
H    0     0                    20047.719294 41613.8177   108%     -  919s
H    0     0                    20080.247614 41613.8177   107%     -  919s
H    0     0                    20087.090588 41613.8177   107%     -  919s
     0     0 41529.5744    0  439 20087.0906 41529.5744   107%     -  936s
     0     0 41482.4422    0  428 20087.0906 41482.4422   107%     -  948s
     0     0 41447.3876    0  422 20087.0906 41447.3876   106%     -  962s
     0     0 41414.9181    0  428 20087.0906 41414.9181   106%     -  973s
     0     0 41396.1149    0  429 20087.0906 41396.1149   106%     -  983s
     0     0 41382.9957    0  433 20087.0906 41382.9957   106%     -  992s
     0     0 41370.8270    0  439 20087.0906 41370.8270   106%     -  999s
     0     0 41365.6863    0  484 20087.0906 41365.6863   106%     - 1007s
     0     0 41362.5766    0  440 20087.0906 41362.5766   106%     - 1012s
     0     0 41361.3017    0  438 20087.0906 41361.3017   106%     - 1015s
     0     0 41221.8942    0  415 20087.0906 41221.8942   105%     - 1049s
H    0     0                    20165.194499 41221.7532   104%     - 1049s
H    0     0                    20243.433751 41221.7532   104%     - 1050s
H    0     0                    20421.160564 41221.7532   102%     - 1050s
H    0     0                    20459.391638 41221.7532   101%     - 1050s
H    0     0                    20477.564459 41221.7532   101%     - 1050s
H    0     0                    20673.271329 41221.7532  99.4%     - 1050s
     0     0 41192.1961    0  428 20673.2713 41192.1961  99.3%     - 1063s
     0     0 41179.2262    0  475 20673.2713 41179.2262  99.2%     - 1073s
     0     0 41175.8356    0  478 20673.2713 41175.8356  99.2%     - 1077s
     0     0 41169.4715    0  428 20673.2713 41169.4715  99.1%     - 1084s
     0     0 41168.6228    0  477 20673.2713 41168.6228  99.1%     - 1087s
     0     0 41082.4064    0  425 20673.2713 41082.4064  98.7%     - 1114s
     0     0 41058.2169    0  486 20673.2713 41058.2169  98.6%     - 1132s
     0     0 41031.9128    0  443 20673.2713 41031.9128  98.5%     - 1148s
     0     0 41020.5626    0  487 20673.2713 41020.5626  98.4%     - 1159s
     0     0 41010.5899    0  492 20673.2713 41010.5899  98.4%     - 1167s
     0     0 40995.9754    0  438 20673.2713 40995.9754  98.3%     - 1175s
     0     0 40988.1077    0  491 20673.2713 40988.1077  98.3%     - 1185s
     0     0 40984.1779    0  498 20673.2713 40984.1779  98.2%     - 1193s
     0     0 40980.8601    0  446 20673.2713 40980.8601  98.2%     - 1196s
     0     0 40980.5328    0  444 20673.2713 40980.5328  98.2%     - 1198s
     0     0 40957.5273    0  466 20673.2713 40957.5273  98.1%     - 1218s
     0     0 40939.6726    0  462 20673.2713 40939.6726  98.0%     - 1234s
     0     0 40934.2945    0  509 20673.2713 40934.2945  98.0%     - 1241s
     0     0 40930.2756    0  512 20673.2713 40930.2756  98.0%     - 1248s
     0     0 40928.5399    0  472 20673.2713 40928.5399  98.0%     - 1252s
     0     0 40904.9361    0  450 20673.2713 40904.9361  97.9%     - 1270s
H    0     0                    20700.781902 40904.9173  97.6%     - 1271s
H    0     0                    22179.865948 40904.9173  84.4%     - 1272s
H    0     0                    22961.679110 40904.9173  78.1%     - 1272s
H    0     0                    23639.222885 40904.9173  73.0%     - 1273s
H    0     0                    23869.931646 40904.9173  71.4%     - 1273s
H    0     0                    24045.923753 40904.9173  70.1%     - 1273s
H    0     0                    24153.427996 40904.9173  69.4%     - 1273s
     0     0 40897.3537    0  508 24153.4280 40897.3537  69.3%     - 1285s
     0     0 40896.3055    0  458 24153.4280 40896.3055  69.3%     - 1288s
     0     0 40873.6010    0  495 24153.4280 40873.6010  69.2%     - 1305s
H    0     0                    24177.236771 40873.2783  69.1%     - 1306s
     0     0 40867.6693    0  501 24177.2368 40867.6693  69.0%     - 1313s
     0     0 40859.1302    0  497 24177.2368 40859.1302  69.0%     - 1324s
     0     0 40848.4933    0  493 24177.2368 40848.4933  69.0%     - 1333s
     0     0 40842.1038    0  504 24177.2368 40842.1038  68.9%     - 1346s
     0     0 40840.4234    0  468 24177.2368 40840.4234  68.9%     - 1349s
     0     0 40824.7396    0  494 24177.2368 40824.7396  68.9%     - 1366s
H    0     0                    24374.248643 40824.4039  67.5%     - 1370s
H    0     0                    24407.214376 40824.4039  67.3%     - 1370s
     0     0 40814.3753    0  448 24407.2144 40814.3753  67.2%     - 1380s
     0     0 40811.7645    0  459 24407.2144 40811.7645  67.2%     - 1384s
     0     0 40801.2390    0  463 24407.2144 40801.2390  67.2%     - 1392s
     0     0 40796.5332    0  514 24407.2144 40796.5332  67.1%     - 1399s
     0     0 40795.5953    0  519 24407.2144 40795.5953  67.1%     - 1402s
     0     0 40781.8949    0  471 24407.2144 40781.8949  67.1%     - 1415s
     0     0 40777.8566    0  462 24407.2144 40777.8566  67.1%     - 1424s
     0     0 40776.9835    0  521 24407.2144 40776.9835  67.1%     - 1428s
     0     0 40766.9069    0  470 24407.2144 40766.9069  67.0%     - 1442s
H    0     0                    24431.085139 40766.7246  66.9%     - 1445s
H    0     0                    24640.740778 40766.7246  65.4%     - 1446s
     0     0 40762.8588    0  518 24640.7408 40762.8588  65.4%     - 1454s
     0     0 40759.5032    0  512 24640.7408 40759.5032  65.4%     - 1460s
     0     0 40754.6157    0  513 24640.7408 40754.6157  65.4%     - 1468s
     0     0 40753.1604    0  469 24640.7408 40753.1604  65.4%     - 1471s
     0     0 40747.5190    0  511 24640.7408 40747.5190  65.4%     - 1484s
     0     0 40746.4010    0  521 24640.7408 40746.4010  65.4%     - 1489s
     0     0 40738.0662    0  471 24640.7408 40738.0662  65.3%     - 1501s
     0     0 40737.9980    0  471 24640.7408 40737.9980  65.3%     - 1508s
H    0     0                    25092.133233 40737.9642  62.4%     - 1908s
H    0     0                    25149.704479 40737.9642  62.0%     - 1926s
H    0     0                    25190.232611 40737.9642  61.7%     - 1930s
     0     2 40737.9642    0  471 25190.2326 40737.9642  61.7%     - 1969s
     1     4 40696.9143    1  461 25190.2326 40737.9642  61.7%  6184 2031s
     3     7 40446.0379    2  407 25190.2326 40696.8336  61.6% 17762 2065s
     6    13 40132.6286    3  443 25190.2326 40524.2630  60.9% 17589 2112s
    12    25 39575.0441    4  315 25190.2326 40445.9216  60.6% 21500 2203s
    24    37 37835.5880    4  402 25190.2326 40139.4569  59.3% 30065 2338s
    36    67 36892.6267    5  302 25190.2326 39769.2797  57.9% 26853 2509s
H   45    67                    25217.314898 39769.2797  57.7% 25224 2509s
    66   167 36151.6488    6  301 25217.3149 39769.2797  57.7% 28385 2657s
   166   257 36136.6131    8  297 25217.3149 39769.2797  57.7% 17794 2722s
H  169   257                    25745.016226 39769.2797  54.5% 17610 2722s
H  176   257                    25768.816219 39769.2797  54.3% 17463 2722s
   256   333 35904.8048   11  275 25768.8162 39769.2797  54.3% 15500 2772s
   332   396 35216.1212   14  361 25768.8162 39769.2797  54.3% 14052 2816s
   395   468 34991.9553   16  314 25768.8162 39769.2797  54.3% 13151 2857s
   467   496 34787.1703   21  292 25768.8162 39769.2797  54.3% 12119 2890s
   495   534 34679.3634   22  250 25768.8162 39769.2797  54.3% 12153 2924s
   533   562 34573.5955   23  253 25768.8162 39769.2797  54.3% 12410 2956s
   563   599 34293.5928   24  241 25768.8162 39769.2797  54.3% 12442 2988s
   600   637 34260.6307   25  246 25768.8162 39769.2797  54.3% 12276 3023s
H  615   637                    25892.170643 39769.2797  53.6% 12195 3023s
   638   713 34247.3468   26  234 25892.1706 39769.2797  53.6% 12048 3063s
   726   780 34171.2416   31  275 25892.1706 39769.2797  53.6% 11576 3095s
   811   846 27144.1357   36  174 25892.1706 39769.2797  53.6% 11137 3133s
   893   906 infeasible   39      25892.1706 39769.2797  53.6% 10886 3172s
   961   990 34107.3464   26  252 25892.1706 39769.2797  53.6% 10912 3207s
  1051  1088     cutoff   27      25892.1706 39769.2797  53.6% 10837 3239s
  1159  1203 30365.1580   31  197 25892.1706 39769.2797  53.6% 10621 3273s
  1294  1304 29974.2519   34  172 25892.1706 39769.2797  53.6% 10242 3314s
  1415  1413 29732.1186   39  174 25892.1706 39769.2797  53.6%  9972 3351s
  1552  1512 29407.1248   44  222 25892.1706 39769.2797  53.6%  9699 3390s
H 1673  1530                    25894.839238 39769.2797  53.6%  9560 3420s
H 1677  1530                    25904.293185 39769.2797  53.5%  9568 3420s
H 1680  1530                    25944.196299 39769.2797  53.3%  9573 3420s
H 1682  1530                    25978.203391 39769.2797  53.1%  9570 3420s
H 1693  1530                    25995.783366 39769.2797  53.0%  9589 3420s
  1713  1610 26089.9588   49  150 25995.7834 39769.2797  53.0%  9602 3465s
  1848  1706 infeasible   48      25995.7834 39769.2797  53.0%  9460 3510s
  2010  1795 29629.9759   42  239 25995.7834 39769.2797  53.0%  9221 3556s
  2169  1885 28494.8821   44  224 25995.7834 39769.2797  53.0%  9009 3600s

Cutting planes:
  Learned: 1
  Implied bound: 165
  MIR: 3958
  Flow cover: 3626
  RLT: 51
  Relax-and-lift: 573

Explored 2349 nodes (21396480 simplex iterations) in 3600.10 seconds (7915.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25995.8 25978.2 25944.2 ... 25190.2

Time limit reached
Best objective 2.599578336600e+04, best bound 3.976927968898e+04, gap 52.9836%
  WARNING: Time limit reached. Using best solution found (gap: 52.98%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 25995.78, θ = 166333.82
  Upper Bound (UB) = 25995.78

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 166333.82
  [DEBUG]   ✓ Scenario 0: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 166333.82 ≤ Q = 166333.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 166333.82 ≤ Q = 166333.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 166333.82 ≤ Q = 166333.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 166333.82 ≤ Q = 166333.82 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x23b635c0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdc49ca40
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.264753e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6051527.9712
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.511548e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151154.77    0  123 6051527.97 -151154.77   102%     -    0s
H    0     0                    -118716.9640 -151154.77  27.3%     -    0s
H    0     0                    -122854.4355 -151154.77  23.0%     -    0s
H    0     0                    -124011.4766 -151154.77  21.9%     -    0s
H    0     0                    -124179.9612 -133524.67  7.53%     -    0s
     0     0 -133524.67    0  126 -124179.96 -133524.67  7.53%     -    0s
H    0     0                    -129195.3489 -133497.23  3.33%     -    0s
H    0     0                    -130290.3073 -133497.23  2.46%     -    0s
     0     0 -132494.51    0  128 -130290.31 -132494.51  1.69%     -    0s
H    0     0                    -130569.3152 -132400.82  1.40%     -    0s
     0     0 -132400.82    0  127 -130569.32 -132400.82  1.40%     -    0s
     0     0 -132395.55    0  128 -130569.32 -132395.55  1.40%     -    0s
     0     0 -131525.15    0   89 -130569.32 -131525.15  0.73%     -    0s
     0     0 -131433.14    0   73 -130569.32 -131433.14  0.66%     -    0s
     0     0 -131142.57    0   54 -130569.32 -131142.57  0.44%     -    0s
     0     0 -131016.93    0   52 -130569.32 -131016.93  0.34%     -    0s
     0     0 -131016.74    0   52 -130569.32 -131016.74  0.34%     -    0s
     0     0 -130839.62    0   44 -130569.32 -130839.62  0.21%     -    0s
     0     0 -130797.15    0   51 -130569.32 -130797.15  0.17%     -    0s
     0     0 -130786.50    0   51 -130569.32 -130786.50  0.17%     -    0s
     0     0 -130677.33    0   42 -130569.32 -130677.33  0.08%     -    0s
     0     0 -130677.33    0   47 -130569.32 -130677.33  0.08%     -    0s
     0     0 -130677.33    0   36 -130569.32 -130677.33  0.08%     -    0s
     0     0 -130659.20    0   32 -130569.32 -130659.20  0.07%     -    0s
     0     0 -130644.50    0   29 -130569.32 -130644.50  0.06%     -    0s
     0     0 -130614.53    0    8 -130569.32 -130614.53  0.03%     -    0s
     0     0 -130605.52    0    7 -130569.32 -130605.52  0.03%     -    0s
     0     0 -130604.87    0    7 -130569.32 -130604.87  0.03%     -    0s
     0     0          -    0      -130569.32 -130580.01  0.01%     -    0s

Cutting planes:
  Gomory: 15
  Implied bound: 15
  MIR: 37
  Flow cover: 15
  RLT: 3
  Relax-and-lift: 1

Explored 1 nodes (1059 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -130569 -130505 -130290 ... 1.26475e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.305693152296e+05, best bound -1.305800121474e+05, gap 0.0082%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 156752.08
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130569.32
  [DEBUG]   S×d_nominal = 287321.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 287321.40 + -130569.32 = 156752.08
  [DEBUG]   Current θ from Master = 166333.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9581.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16414.05
  Lower Bound (LB) = 24859.96
  Gap (UB-LB) = 1135.8266, Absolute Gap = 1135.8266, Relative Gap = 0.043693
  Not converged yet (gap = 1135.83 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870079 nonzeros
Model fingerprint: 0x960fd866
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 143900 rows and 58460 columns
Presolve time: 3.53s
Presolved: 163283 rows, 68600 columns, 1006674 nonzeros
Variable types: 66341 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -197770.0082

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 1081
 AA' NZ     : 4.111e+06
 Factor NZ  : 1.125e+07 (roughly 200 MB of memory)
 Factor Ops : 3.653e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.10258440e+07  3.08124038e+08  1.46e+05 1.70e+01  9.47e+04     6s
   1  -1.64695242e+07  2.82126779e+08  1.04e+05 9.82e+01  6.71e+04     6s
   2  -5.46253787e+06  2.18591149e+08  3.35e+04 1.54e+01  2.29e+04     6s
   3  -1.35926653e+06  1.56180411e+08  4.89e+03 1.31e+00  3.69e+03     6s
   4  -6.94815241e+05  1.25232047e+08  8.06e+02 8.90e-01  9.27e+02     6s
   5  -6.23078341e+05  7.59619059e+07  5.04e+02 4.67e-01  5.43e+02     6s
   6  -5.16614602e+05  5.15822365e+07  2.22e+02 2.85e-01  2.91e+02     6s
   7  -3.99347388e+05  3.90129842e+07  6.60e+01 2.05e-01  1.64e+02     6s
   8  -3.16611366e+05  2.54331122e+07  1.37e+01 1.26e-01  9.19e+01     6s
   9  -2.28616454e+05  1.25326307e+07  4.33e+00 5.91e-02  4.39e+01     6s
  10  -1.70205913e+05  7.02995663e+06  2.79e+00 3.22e-02  2.46e+01     6s
  11  -1.46619821e+05  6.18473720e+06  1.99e+00 2.82e-02  2.15e+01     6s
  12  -1.23127936e+05  4.68376704e+06  1.39e+00 2.12e-02  1.63e+01     6s
  13  -8.39580532e+04  3.44333916e+06  4.80e-01 1.54e-02  1.19e+01     6s
  14  -7.37830732e+04  2.33865117e+06  3.64e-01 1.05e-02  8.13e+00     7s
  15  -5.18367722e+04  1.92984214e+06  1.55e-01 8.64e-03  6.67e+00     7s
  16  -3.54346845e+04  7.71624140e+05  7.41e-02 3.33e-03  2.71e+00     7s
  17  -1.54383492e+04  4.28944117e+05  3.88e-02 1.99e-03  1.49e+00     7s
  18   1.64790533e+03  2.59908336e+05  2.46e-02 1.70e-03  8.68e-01     7s
  19   1.09969605e+04  1.53969213e+05  1.91e-02 1.98e-03  4.81e-01     7s
  20   2.11042491e+04  1.31180009e+05  1.38e-02 1.54e-03  3.70e-01     7s
  21   2.60883833e+04  1.17781221e+05  1.15e-02 1.27e-03  3.08e-01     7s
  22   2.87931901e+04  1.03583669e+05  1.02e-02 9.98e-04  2.51e-01     7s
  23   3.28454600e+04  9.26176178e+04  8.44e-03 7.73e-04  2.01e-01     7s
  24   3.69632236e+04  7.92916622e+04  6.71e-03 5.23e-04  1.42e-01     7s
  25   3.90806149e+04  7.72485165e+04  5.91e-03 4.76e-04  1.28e-01     7s
  26   4.11193893e+04  6.92099621e+04  5.15e-03 3.58e-04  9.44e-02     7s
  27   4.29157441e+04  6.63658888e+04  4.52e-03 2.72e-04  7.88e-02     8s
  28   4.64795407e+04  6.44329519e+04  3.31e-03 2.16e-04  6.04e-02     8s
  29   4.76731686e+04  6.36629749e+04  2.91e-03 1.95e-04  5.38e-02     8s
  30   4.83555263e+04  6.14300236e+04  2.69e-03 1.51e-04  4.40e-02     8s
  31   4.89940338e+04  6.06751801e+04  2.48e-03 1.25e-04  3.93e-02     8s
  32   5.02676109e+04  6.03041534e+04  2.06e-03 1.12e-04  3.37e-02     8s
  33   5.08470550e+04  5.93738446e+04  1.87e-03 8.26e-05  2.87e-02     8s
  34   5.13712299e+04  5.91755544e+04  1.70e-03 7.55e-05  2.62e-02     8s
  35   5.15304298e+04  5.90223584e+04  1.64e-03 7.07e-05  2.52e-02     8s
  36   5.21202136e+04  5.85157150e+04  1.46e-03 5.54e-05  2.15e-02     8s
  37   5.28105615e+04  5.83408316e+04  1.23e-03 5.05e-05  1.86e-02     8s
  38   5.33042619e+04  5.80572746e+04  1.06e-03 4.23e-05  1.60e-02     9s
  39   5.39038870e+04  5.79005422e+04  8.65e-04 3.78e-05  1.34e-02     9s
  40   5.41554272e+04  5.76045056e+04  7.84e-04 2.82e-05  1.16e-02     9s
  41   5.44699909e+04  5.72937225e+04  6.81e-04 1.93e-05  9.49e-03     9s
  42   5.51635196e+04  5.71143390e+04  4.66e-04 1.34e-05  6.56e-03     9s
  43   5.56601007e+04  5.69463536e+04  3.08e-04 1.21e-05  4.32e-03     9s
  44   5.59648537e+04  5.68563906e+04  2.17e-04 7.71e-06  3.00e-03     9s
  45   5.64032163e+04  5.67808509e+04  7.59e-05 4.12e-06  1.27e-03     9s
  46   5.64550929e+04  5.67230000e+04  6.14e-05 1.65e-06  9.01e-04     9s
  47   5.65816361e+04  5.67055405e+04  2.67e-05 8.93e-07  4.17e-04     9s
  48   5.65993034e+04  5.67009434e+04  2.19e-05 6.85e-07  3.42e-04    10s
  49   5.66581398e+04  5.66948346e+04  6.21e-06 4.16e-07  1.23e-04    10s
  50   5.66784202e+04  5.66872185e+04  1.27e-06 1.31e-07  2.96e-05    10s
  51   5.66838295e+04  5.66845058e+04  6.95e-08 2.17e-08  2.27e-06    10s
  52   5.66842222e+04  5.66842529e+04  1.28e-08 1.19e-08  1.04e-07    10s
  53   5.66842512e+04  5.66842513e+04  6.92e-09 1.65e-10  2.66e-10    10s

Barrier solved model in 53 iterations and 9.98 seconds (15.64 work units)
Optimal objective 5.66842512e+04


Root crossover log...

  145564 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    4853 PPushes remaining with PInf 5.4169142e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9029675e+03     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70234    5.6684251e+04   0.000000e+00   2.902967e+03     14s
   70397    5.6684251e+04   0.000000e+00   0.000000e+00     14s
   70397    5.6684251e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 2.59s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.668425e+04, 70397 iterations, 11.98 seconds (19.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56684.2512    0  154 -197770.01 56684.2512   129%     -   17s
H    0     0                    -196822.8950 56684.2512   129%     -   18s
H    0     0                    -195624.4928 56684.2512   129%     -   18s
H    0     0                    -195600.5974 56684.2512   129%     -   18s
H    0     0                    -174582.0391 56684.2512   132%     -   18s
H    0     0                    -174494.5897 56684.2512   132%     -   18s
H    0     0                    -156227.1778 56684.2512   136%     -   19s
H    0     0                    -155772.2530 56684.2512   136%     -   19s
H    0     0                    -155466.6980 56684.2512   136%     -   20s
H    0     0                    -155356.3744 56684.2512   136%     -   20s
H    0     0                    -155124.0274 56684.2512   137%     -   20s
H    0     0                    -20684.67106 56684.2512   374%     -   20s
H    0     0                    -19403.83022 56684.2512   392%     -   21s
H    0     0                    -18937.00217 56684.2512   399%     -   21s
H    0     0                    -18768.58721 56684.2512   402%     -   21s
H    0     0                    -18758.84410 56684.2512   402%     -   21s
     0     0 49516.4503    0  240 -18758.844 49516.4503   364%     -   73s
H    0     0                    -15052.68787 49516.3517   429%     -   75s
H    0     0                    -7886.054767 49516.3517   728%     -   75s
H    0     0                    -5518.316939 49516.3517   997%     -   75s
H    0     0                    -4210.366319 49516.3517  1276%     -   75s
H    0     0                    -3857.224415 49516.3517  1384%     -   75s
H    0     0                    -3639.999185 49516.3517  1460%     -   75s
H    0     0                    -3607.036659 49516.3517  1473%     -   75s
     0     0 49296.3078    0  226 -3607.0367 49296.3078  1467%     -  107s
     0     0 49274.6816    0  236 -3607.0367 49274.6816  1466%     -  115s
     0     0 49266.8977    0  236 -3607.0367 49266.8977  1466%     -  117s
     0     0 49266.5119    0  230 -3607.0367 49266.5119  1466%     -  120s
     0     0 45685.6161    0  361 -3607.0367 45685.6161  1367%     -  194s
H    0     0                    -439.0029820 45685.4236      -     -  195s
H    0     0                    4846.9859400 45685.4236   843%     -  195s
     0     0 45349.9060    0  367 4846.98594 45349.9060   836%     -  227s
     0     0 45252.2510    0  351 4846.98594 45252.2510   834%     -  246s
     0     0 45064.8290    0  397 4846.98594 45064.8290   830%     -  271s
     0     0 44948.0039    0  354 4846.98594 44948.0039   827%     -  287s
     0     0 44879.5643    0  359 4846.98594 44879.5643   826%     -  297s
     0     0 44858.9009    0  357 4846.98594 44858.9009   826%     -  305s
     0     0 44837.8440    0  368 4846.98594 44837.8440   825%     -  314s
     0     0 44825.7068    0  358 4846.98594 44825.7068   825%     -  318s
     0     0 44782.3140    0  370 4846.98594 44782.3140   824%     -  330s
     0     0 44705.8945    0  408 4846.98594 44705.8945   822%     -  344s
     0     0 44696.0711    0  401 4846.98594 44696.0711   822%     -  349s
     0     0 44615.0579    0  364 4846.98594 44615.0579   820%     -  359s
     0     0 44558.2890    0  416 4846.98594 44558.2890   819%     -  370s
     0     0 44554.2664    0  412 4846.98594 44554.2664   819%     -  376s
     0     0 44493.7229    0  397 4846.98594 44493.7229   818%     -  389s
     0     0 44483.6591    0  410 4846.98594 44483.6591   818%     -  395s
     0     0 44479.7791    0  410 4846.98594 44479.7791   818%     -  397s
     0     0 44478.8361    0  406 4846.98594 44478.8361   818%     -  398s
     0     0 42276.2080    0  360 4846.98594 42276.2080   772%     -  483s
H    0     0                    6402.2780664 42276.0873   560%     -  484s
H    0     0                    6504.1635645 42276.0873   550%     -  485s
     0     0 41868.3811    0  448 6504.16356 41868.3811   544%     -  519s
     0     0 41570.7096    0  469 6504.16356 41570.7096   539%     -  544s
     0     0 41489.6645    0  440 6504.16356 41489.6645   538%     -  557s
     0     0 41464.5995    0  438 6504.16356 41464.5995   538%     -  565s
     0     0 41449.0401    0  430 6504.16356 41449.0401   537%     -  571s
     0     0 41433.4132    0  428 6504.16356 41433.4132   537%     -  576s
     0     0 41425.0897    0  475 6504.16356 41425.0897   537%     -  580s
     0     0 41385.9339    0  427 6504.16356 41385.9339   536%     -  590s
     0     0 41376.8728    0  427 6504.16356 41376.8728   536%     -  597s
     0     0 41363.8753    0  425 6504.16356 41363.8753   536%     -  603s
     0     0 41348.7775    0  438 6504.16356 41348.7775   536%     -  610s
     0     0 41347.3262    0  440 6504.16356 41347.3262   536%     -  614s
     0     0 40360.7483    0  462 6504.16356 40360.7483   521%     -  686s
     0     0 40214.0837    0  395 6504.16356 40214.0837   518%     -  706s
     0     0 40144.5724    0  416 6504.16356 40144.5724   517%     -  719s
     0     0 40102.0965    0  405 6504.16356 40102.0965   517%     -  732s
     0     0 40066.5964    0  417 6504.16356 40066.5964   516%     -  740s
     0     0 40060.9681    0  421 6504.16356 40060.9681   516%     -  744s
     0     0 40053.6946    0  429 6504.16356 40053.6946   516%     -  748s
     0     0 40050.7265    0  419 6504.16356 40050.7265   516%     -  751s
     0     0 40046.7532    0  428 6504.16356 40046.7532   516%     -  754s
     0     0 40044.4975    0  429 6504.16356 40044.4975   516%     -  757s
     0     0 40036.8535    0  431 6504.16356 40036.8535   516%     -  761s
     0     0 40027.6056    0  426 6504.16356 40027.6056   515%     -  767s
     0     0 40022.4329    0  429 6504.16356 40022.4329   515%     -  772s
     0     0 40020.4480    0  428 6504.16356 40020.4480   515%     -  774s
     0     0 39840.2950    0  463 6504.16356 39840.2950   513%     -  804s
     0     0 39786.5312    0  444 6504.16356 39786.5312   512%     -  819s
     0     0 39766.6788    0  432 6504.16356 39766.6788   511%     -  826s
     0     0 39750.1937    0  443 6504.16356 39750.1937   511%     -  833s
     0     0 39742.6227    0  434 6504.16356 39742.6227   511%     -  836s
     0     0 39728.8591    0  434 6504.16356 39728.8591   511%     -  843s
     0     0 39717.2326    0  440 6504.16356 39717.2326   511%     -  846s
     0     0 39714.3772    0  450 6504.16356 39714.3772   511%     -  849s
     0     0 39708.3711    0  449 6504.16356 39708.3711   511%     -  852s
     0     0 39695.9443    0  445 6504.16356 39695.9443   510%     -  860s
     0     0 39686.3076    0  446 6504.16356 39686.3076   510%     -  864s
     0     0 39684.2321    0  448 6504.16356 39684.2321   510%     -  867s
     0     0 39594.9680    0  435 6504.16356 39594.9680   509%     -  889s
H    0     0                    8689.0428667 39594.9050   356%     -  895s
H    0     0                    12312.096834 39594.9050   222%     -  895s
H    0     0                    13011.191686 39594.9050   204%     -  895s
     0     0 39568.5537    0  428 13011.1917 39568.5537   204%     -  907s
     0     0 39560.3155    0  473 13011.1917 39560.3155   204%     -  916s
     0     0 39537.1949    0  438 13011.1917 39537.1949   204%     -  924s
     0     0 39530.9894    0  439 13011.1917 39530.9894   204%     -  928s
     0     0 39528.4448    0  379 13011.1917 39528.4448   204%     -  931s
     0     0 39525.9911    0  377 13011.1917 39525.9911   204%     -  935s
     0     0 39523.7422    0  377 13011.1917 39523.7422   204%     -  939s
     0     0 39453.3690    0  387 13011.1917 39453.3690   203%     -  955s
H    0     0                    14351.612843 39452.3617   175%     -  956s
     0     0 39431.8812    0  398 14351.6128 39431.8812   175%     -  968s
     0     0 39417.2316    0  463 14351.6128 39417.2316   175%     -  974s
     0     0 39414.6487    0  470 14351.6128 39414.6487   175%     -  979s
     0     0 39411.7072    0  401 14351.6128 39411.7072   175%     -  981s
     0     0 39410.3982    0  456 14351.6128 39410.3982   175%     -  984s
     0     0 39391.7926    0  450 14351.6128 39391.7926   174%     -  995s
H    0     0                    16367.493987 39391.4734   141%     -  996s
H    0     0                    16550.999004 39391.4734   138%     -  996s
H    0     0                    17814.954108 39391.4734   121%     -  996s
H    0     0                    18306.299843 39391.4734   115%     -  996s
H    0     0                    18460.702186 39391.4734   113%     -  996s
     0     0 39368.6454    0  447 18460.7022 39368.6454   113%     - 1006s
     0     0 39363.3415    0  449 18460.7022 39363.3415   113%     - 1011s
     0     0 39361.0786    0  442 18460.7022 39361.0786   113%     - 1014s
     0     0 39326.3644    0  483 18460.7022 39326.3644   113%     - 1028s
H    0     0                    20120.479553 39326.2697  95.5%     - 1028s
H    0     0                    22172.881121 39326.2697  77.4%     - 1029s
H    0     0                    22847.266565 39326.2697  72.1%     - 1029s
     0     0 39312.9378    0  493 22847.2666 39312.9378  72.1%     - 1037s
     0     0 39308.8123    0  499 22847.2666 39308.8123  72.1%     - 1042s
     0     0 39307.7147    0  498 22847.2666 39307.7147  72.0%     - 1046s
     0     0 39271.7641    0  443 22847.2666 39271.7641  71.9%     - 1057s
H    0     0                    22905.249804 39271.7573  71.5%     - 1068s
     0     0 39269.3213    0  459 22905.2498 39269.3213  71.4%     - 1073s
     0     0 39246.0510    0  490 22905.2498 39246.0510  71.3%     - 1086s
H    0     0                    23050.857882 39245.3178  70.3%     - 1087s
     0     0 39232.4641    0  504 23050.8579 39232.4641  70.2%     - 1094s
     0     0 39225.6014    0  461 23050.8579 39225.6014  70.2%     - 1099s
     0     0 39223.3455    0  460 23050.8579 39223.3455  70.2%     - 1103s
     0     0 39209.9251    0  499 23050.8579 39209.9251  70.1%     - 1111s
     0     0 39197.7654    0  507 23050.8579 39197.7654  70.0%     - 1120s
     0     0 39191.8492    0  518 23050.8579 39191.8492  70.0%     - 1126s
     0     0 39189.3493    0  517 23050.8579 39189.3493  70.0%     - 1131s
     0     0 39161.4650    0  527 23050.8579 39161.4650  69.9%     - 1144s
     0     0 39158.3284    0  521 23050.8579 39158.3284  69.9%     - 1149s
     0     0 39152.9378    0  477 23050.8579 39152.9378  69.9%     - 1156s
     0     0 39151.1565    0  479 23050.8579 39151.1565  69.8%     - 1159s
     0     0 39148.6834    0  464 23050.8579 39148.6834  69.8%     - 1163s
H    0     0                    23947.330245 39148.5672  63.5%     - 1177s
H    0     0                    24515.645617 39148.5672  59.7%     - 1177s
     0     0 39145.5109    0  461 24515.6456 39145.5109  59.7%     - 1180s
     0     0 39145.2104    0  458 24515.6456 39145.2104  59.7%     - 1181s
     0     0 39139.6687    0  460 24515.6456 39139.6687  59.7%     - 1185s
H    0     0                    24659.393623 39137.7574  58.7%     - 1186s
H    0     0                    24739.455931 39137.7574  58.2%     - 1186s
H    0     0                    24792.764596 39137.7574  57.9%     - 1186s
H    0     0                    24904.101854 39137.7574  57.2%     - 1186s
     0     0 39137.7574    0  455 24904.1019 39137.7574  57.2%     - 1188s
     0     0 39137.7234    0  456 24904.1019 39137.7234  57.2%     - 1192s
     0     0 39137.2396    0  461 24904.1019 39137.2396  57.2%     - 1195s
     0     0 39133.1673    0  457 24904.1019 39133.1673  57.1%     - 1200s
     0     0 39132.5899    0  457 24904.1019 39132.5899  57.1%     - 1206s
H    0     0                    25066.313975 39132.5899  56.1%     - 1437s
     0     2 39132.5899    0  457 25066.3140 39132.5899  56.1%     - 1443s
     1     3 38472.9351    1  425 25066.3140 39132.5899  56.1% 21131 1477s
     2     4 38756.5237    1  453 25066.3140 38756.5237  54.6% 18962 1503s
     3     5 37517.5178    2  464 25066.3140 38756.1524  54.6% 18785 1527s
     4    10 37228.1790    3  468 25066.3140 38756.1524  54.6% 19109 1552s
     9    19 36472.7685    4  464 25066.3140 38566.8392  53.9% 15459 1596s
    18    37 36147.2184    5  469 25066.3140 38512.0257  53.6% 17840 1646s
    36    50 35313.0297    5  269 25066.3140 38511.9441  53.6% 24023 1741s
H   49    76                    25967.782688 38511.9441  48.3% 26065 1809s
    75   138 36129.4717    6  343 25967.7827 38378.9773  47.8% 22027 1895s
   137   236 35862.3365    7  328 25967.7827 38378.9773  47.8% 17175 1961s
H  147   236                    26067.311198 38378.9773  47.2% 16476 1961s
H  153   236                    26186.648889 38378.9773  46.6% 16114 1961s
H  202   236                    26448.972904 38378.9773  45.1% 13840 1961s
   235   300 35589.9864    9  348 26448.9729 38378.9773  45.1% 12827 2001s
   299   330 35503.3475   10  348 26448.9729 38378.9773  45.1% 12002 2031s
H  303   330                    26505.910267 38378.9773  44.8% 11941 2031s
H  311   330                    26622.508205 38378.9773  44.2% 11815 2031s
   329   395 35488.4627   11  317 26622.5082 38378.9773  44.2% 11630 2079s
   394   424 35213.9253   14  292 26622.5082 38378.9773  44.2% 10636 2112s
   423   464 35119.3565   15  295 26622.5082 38378.9773  44.2% 10584 2140s
H  435   464                    26660.451298 38378.9773  44.0% 10501 2140s
   463   531 35032.4153   16  298 26660.4513 38378.9773  44.0% 10483 2179s
   530   596 34862.8870   18  297 26660.4513 38378.9773  44.0%  9860 2216s
   599   643 34772.6049   21  234 26660.4513 38378.9773  44.0%  9327 2252s
   646   688 33811.1625   23  285 26660.4513 38378.9773  44.0%  9125 2285s
   691   728 33582.2206   24  281 26660.4513 38378.9773  44.0%  9001 2319s
   735   787 33209.2092   25  270 26660.4513 38378.9773  44.0%  8810 2351s
   798   839 33021.7372   27  290 26660.4513 38378.9773  44.0%  8528 2386s
   858   905 32724.0329   32  317 26660.4513 38378.9773  44.0%  8282 2417s
   936   975 32658.1467   34  322 26660.4513 38378.9773  44.0%  7994 2458s
  1036  1081 32098.6062   40  207 26660.4513 38378.9773  44.0%  7593 2493s
  1172  1114 31770.2547   46  204 26660.4513 38378.9773  44.0%  7083 2530s
  1291  1124 27714.2263   48  195 26660.4513 38378.9773  44.0%  6767 2568s
  1383  1160 28900.2018   20  265 26660.4513 38378.9773  44.0%  6637 2607s
  1461  1182 27087.7359   22  251 26660.4513 38378.9773  44.0%  6584 2649s
H 1497  1182                    26679.825788 38378.9773  43.9%  6530 2649s
  1530  1227 infeasible   39      26679.8258 38378.9773  43.9%  6524 2686s
  1634  1258 26995.2371   22  219 26679.8258 38378.9773  43.9%  6308 2732s
  1723  1287 infeasible   52      26679.8258 38378.9773  43.9%  6230 2775s
  1821  1304 infeasible   22      26679.8258 38378.9773  43.9%  6121 2823s
  1892  1358 31255.0241   14  313 26679.8258 38378.9773  43.9%  6128 2872s
  1968  1417 30753.1287   15  311 26679.8258 38378.9773  43.9%  6151 2918s
H 2052  1417                    26719.479739 38378.9773  43.6%  6103 2918s
  2061  1498 29380.0422   17  255 26719.4797 38378.9773  43.6%  6114 2990s
  2156  1579 29253.2389   20  239 26719.4797 38378.9773  43.6%  6130 3049s
  2276  1645 28199.0586   26  203 26719.4797 38378.9773  43.6%  6056 3103s
  2401  1704 27763.5643   30  260 26719.4797 38378.9773  43.6%  6052 3167s
  2514  1776 27445.1741   36  200 26719.4797 38378.9773  43.6%  6078 3230s
  2636  1849 infeasible   50      26719.4797 38069.1927  42.5%  6105 3299s
  2792  1878 infeasible   56      26719.4797 38065.9471  42.5%  6066 3371s
H 2826  1873                    26830.167091 38065.9471  41.9%  6062 3371s
  2887  1936     cutoff   59      26830.1671 37409.9999  39.4%  6088 3448s
  3005  2014 35195.6798    7  288 26830.1671 37409.9999  39.4%  6122 3522s
  3145  2123 34403.6576    8  278 26830.1671 37409.9999  39.4%  6143 3600s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 191
  MIR: 3652
  Flow cover: 4144
  RLT: 79
  Relax-and-lift: 656
  BQP: 1
  PSD: 1

Explored 3319 nodes (21134730 simplex iterations) in 3600.05 seconds (8850.82 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26830.2 26719.5 26679.8 ... 25967.8

Time limit reached
Best objective 2.683016709122e+04, best bound 3.728445387135e+04, gap 38.9647%
  WARNING: Time limit reached. Using best solution found (gap: 38.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 26830.17, θ = 179967.66
  Upper Bound (UB) = 26830.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179967.66
  [DEBUG]   ✓ Scenario 0: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179967.66 ≤ Q = 179967.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 179967.66 ≤ Q = 179967.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 179967.66 ≤ Q = 179967.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 179967.66 ≤ Q = 179967.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 179967.66 ≤ Q = 179967.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 179967.66 ≤ Q = 179967.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 179967.66 ≤ Q = 179967.66 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x33d664c4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x33d664c4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.223196e+13
Presolve removed 2605 rows and 1896 columns
Presolve time: 0.00s
Presolved: 488 rows, 493 columns, 1382 nonzeros
Found heuristic solution: objective 5614035.9910
Variable types: 335 continuous, 158 integer (158 binary)

Root relaxation: objective -1.638478e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163847.78    0  129 5614035.99 -163847.78   103%     -    0s
H    0     0                    -129349.8724 -163847.78  26.7%     -    0s
H    0     0                    -131454.9290 -163847.78  24.6%     -    0s
H    0     0                    -140194.3202 -144196.90  2.86%     -    0s
     0     0 -143913.25    0   58 -140194.32 -143913.25  2.65%     -    0s
H    0     0                    -142755.1080 -143913.25  0.81%     -    0s
     0     0 -143745.35    0   64 -142755.11 -143745.35  0.69%     -    0s
     0     0 -143724.68    0   58 -142755.11 -143724.68  0.68%     -    0s
     0     0 -143723.91    0   58 -142755.11 -143723.91  0.68%     -    0s
H    0     0                    -143585.8172 -143635.49  0.03%     -    0s
     0     0 -143625.42    0    8 -143585.82 -143625.42  0.03%     -    0s
     0     0          -    0      -143585.82 -143599.07  0.01%     -    0s

Cutting planes:
  Gomory: 43
  Implied bound: 2
  MIR: 117
  Flow cover: 2
  RLT: 57
  Relax-and-lift: 3
  BQP: 10

Explored 1 nodes (487 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -143586 -140194 -131455 ... 1.2232e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.435858172250e+05, best bound -1.435990731881e+05, gap 0.0092%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 166160.04
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143585.82
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -143585.82 = 166160.04
  [DEBUG]   Current θ from Master = 179967.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13807.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13022.55
  Lower Bound (LB) = 24859.96
  Gap (UB-LB) = 1970.2104, Absolute Gap = 1970.2104, Relative Gap = 0.073433
  Not converged yet (gap = 1970.21 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913307 nonzeros
Model fingerprint: 0x96d7eb68
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 151091 rows and 61381 columns
Presolve time: 3.79s
Presolved: 171382 rows, 71919 columns, 1056152 nonzeros
Variable types: 69660 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -197770.0082

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.35s

Barrier statistics:
 Dense cols : 1071
 AA' NZ     : 4.512e+06
 Factor NZ  : 1.227e+07 (roughly 200 MB of memory)
 Factor Ops : 3.894e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.13801609e+07  3.21024591e+08  1.48e+05 1.66e+01  9.58e+04     7s
   1  -1.67717864e+07  2.94711943e+08  1.06e+05 9.75e+01  6.79e+04     7s
   2  -5.69283002e+06  2.28238741e+08  3.49e+04 1.71e+01  2.37e+04     7s
   3  -1.20572129e+06  1.64288532e+08  3.76e+03 1.70e+00  2.94e+03     7s
   4  -7.02101685e+05  1.30855977e+08  7.40e+02 1.18e+00  8.80e+02     7s
   5  -6.27397338e+05  7.05996496e+07  4.24e+02 5.07e-01  4.60e+02     7s
   6  -4.95525619e+05  4.78197077e+07  1.36e+02 3.15e-01  2.24e+02     7s
   7  -4.23554320e+05  3.68299449e+07  6.66e+01 2.32e-01  1.50e+02     7s
   8  -3.60585957e+05  2.37027197e+07  3.34e+01 1.42e-01  8.95e+01     7s
   9  -2.46015261e+05  1.32059742e+07  1.19e+01 7.29e-02  4.62e+01     7s
  10  -1.74920116e+05  8.63172524e+06  7.28e+00 4.71e-02  2.96e+01     8s
  11  -1.45790623e+05  6.59386334e+06  5.08e+00 3.55e-02  2.23e+01     8s
  12  -1.26831846e+05  4.20246071e+06  3.38e+00 2.24e-02  1.42e+01     8s
  13  -8.60129052e+04  3.29826194e+06  1.08e+00 1.74e-02  1.09e+01     8s
  14  -5.90062436e+04  1.00498712e+06  4.48e-01 5.18e-03  3.42e+00     8s
  15  -2.81500793e+04  3.75511865e+05  2.03e-01 1.62e-03  1.30e+00     8s
  16   3.43487022e+02  2.60030030e+05  1.04e-01 9.87e-04  8.33e-01     8s
  17   8.95162534e+03  1.93749788e+05  8.30e-02 1.51e-03  5.93e-01     8s
  18   2.16197786e+04  1.42535813e+05  5.53e-02 2.03e-03  3.88e-01     8s
  19   2.70887639e+04  1.08973775e+05  4.44e-02 3.58e-03  2.63e-01     8s
  20   3.07887642e+04  8.93536417e+04  3.77e-02 2.06e-03  1.88e-01     8s
  21   3.47936959e+04  8.48631649e+04  3.10e-02 1.74e-03  1.61e-01     8s
  22   3.94834373e+04  7.61928362e+04  2.34e-02 1.27e-03  1.18e-01     8s
  23   4.25461880e+04  7.26012269e+04  1.87e-02 1.04e-03  9.64e-02     9s
  24   4.55742669e+04  6.87494336e+04  1.43e-02 7.84e-04  7.44e-02     9s
  25   4.77955501e+04  6.63807824e+04  1.12e-02 6.29e-04  5.96e-02     9s
  26   4.91111011e+04  6.41273314e+04  9.45e-03 4.79e-04  4.82e-02     9s
  27   5.04518144e+04  6.26378853e+04  7.75e-03 3.80e-04  3.91e-02     9s
  28   5.13934815e+04  6.14878359e+04  6.56e-03 3.07e-04  3.24e-02     9s
  29   5.21448863e+04  6.06531506e+04  5.61e-03 2.50e-04  2.73e-02     9s
  30   5.28053168e+04  5.96708197e+04  4.79e-03 1.90e-04  2.20e-02     9s
  31   5.32552934e+04  5.93053007e+04  4.23e-03 1.66e-04  1.94e-02     9s
  32   5.37835184e+04  5.91953315e+04  3.58e-03 1.59e-04  1.74e-02     9s
  33   5.40697268e+04  5.85978402e+04  3.23e-03 1.20e-04  1.45e-02     9s
  34   5.42744045e+04  5.82589589e+04  2.96e-03 9.92e-05  1.28e-02    10s
  35   5.48447280e+04  5.79393080e+04  2.28e-03 8.58e-05  9.93e-03    10s
  36   5.50058316e+04  5.78696364e+04  2.09e-03 8.30e-05  9.19e-03    10s
  37   5.53086081e+04  5.75563351e+04  1.72e-03 5.03e-05  7.21e-03    10s
  38   5.59500753e+04  5.72870217e+04  9.72e-04 3.09e-05  4.29e-03    10s
  39   5.61772099e+04  5.71008550e+04  7.10e-04 1.80e-05  2.96e-03    10s
  40   5.63860118e+04  5.69641174e+04  4.82e-04 8.54e-06  1.86e-03    10s
  41   5.64625214e+04  5.69325197e+04  3.95e-04 6.33e-06  1.51e-03    10s
  42   5.66394329e+04  5.68676528e+04  2.01e-04 2.19e-06  7.33e-04    10s
  43   5.67047899e+04  5.68528388e+04  1.32e-04 1.32e-06  4.75e-04    10s
  44   5.67229331e+04  5.68474926e+04  1.12e-04 1.01e-06  4.00e-04    10s
  45   5.67488386e+04  5.68398037e+04  8.40e-05 6.31e-07  2.92e-04    11s
  46   5.68226810e+04  5.68320852e+04  6.68e-06 8.91e-07  3.02e-05    11s
  47   5.68296583e+04  5.68299509e+04  8.15e-08 1.35e-07  9.39e-07    11s
  48   5.68298886e+04  5.68298889e+04  1.10e-09 6.04e-10  9.39e-10    11s

Barrier solved model in 48 iterations and 10.78 seconds (16.47 work units)
Optimal objective 5.68298886e+04


Root crossover log...

  152069 DPushes remaining with DInf 0.0000000e+00                11s
    8618 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

   12137 PPushes remaining with PInf 8.1654515e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5088688e+03     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   84093    5.6829889e+04   0.000000e+00   4.508869e+03     18s
   84167    5.6829889e+04   0.000000e+00   0.000000e+00     18s
   84167    5.6829889e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.48s

Solved with barrier

Root relaxation: objective 5.682989e+04, 84167 iterations, 13.72 seconds (26.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56829.8888    0  163 -197770.01 56829.8888   129%     -   18s
H    0     0                    -168096.4579 56829.8888   134%     -   19s
H    0     0                    -159296.3799 56829.8888   136%     -   21s
H    0     0                    -150782.9812 56829.8888   138%     -   21s
H    0     0                    -149611.4058 56829.8888   138%     -   21s
H    0     0                    -56915.74733 56829.8888   200%     -   21s
H    0     0                    2285.2954053 56829.8888  2387%     -   21s
H    0     0                    6994.4138293 56829.8888   713%     -   21s
H    0     0                    8776.1600915 56829.8888   548%     -   22s
H    0     0                    13271.471294 56829.8888   328%     -   22s
     0     0 49303.8810    0  242 13271.4713 49303.8810   272%     -   98s
H    0     0                    14227.701755 49301.9713   247%     -  100s
H    0     0                    15716.516927 49301.9713   214%     -  100s
H    0     0                    15783.391882 49301.9713   212%     -  100s
     0     0 48536.6174    0  255 15783.3919 48536.6174   208%     -  133s
     0     0 48521.6322    0  254 15783.3919 48521.6322   207%     -  140s
     0     0 48490.6353    0  258 15783.3919 48490.6353   207%     -  148s
     0     0 48465.8823    0  253 15783.3919 48465.8823   207%     -  155s
     0     0 48463.8846    0  256 15783.3919 48463.8846   207%     -  157s
     0     0 48459.8470    0  257 15783.3919 48459.8470   207%     -  162s
     0     0 48428.9690    0  256 15783.3919 48428.9690   207%     -  171s
     0     0 48405.5153    0  258 15783.3919 48405.5153   207%     -  177s
     0     0 48088.8131    0  268 15783.3919 48088.8131   205%     -  199s
     0     0 48062.6158    0  264 15783.3919 48062.6158   205%     -  206s
     0     0 48061.1542    0  264 15783.3919 48061.1542   205%     -  208s
     0     0 48060.0352    0  264 15783.3919 48060.0352   204%     -  209s
     0     0 48058.9548    0  264 15783.3919 48058.9548   204%     -  210s
     0     0 48058.6373    0  264 15783.3919 48058.6373   204%     -  210s
     0     0 45050.7207    0  373 15783.3919 45050.7207   185%     -  279s
H    0     0                    24144.349015 45050.6821  86.6%     -  279s
     0     0 44624.5109    0  393 24144.3490 44624.5109  84.8%     -  315s
     0     0 44402.4286    0  382 24144.3490 44402.4286  83.9%     -  337s
     0     0 44347.9512    0  391 24144.3490 44347.9512  83.7%     -  347s
     0     0 44324.6137    0  397 24144.3490 44324.6137  83.6%     -  356s
     0     0 44223.2487    0  391 24144.3490 44223.2487  83.2%     -  371s
     0     0 44216.0258    0  389 24144.3490 44216.0258  83.1%     -  375s
     0     0 44113.7885    0  387 24144.3490 44113.7885  82.7%     -  389s
     0     0 44010.8323    0  403 24144.3490 44010.8323  82.3%     -  402s
     0     0 44003.0108    0  401 24144.3490 44003.0108  82.2%     -  405s
     0     0 43995.1805    0  401 24144.3490 43995.1805  82.2%     -  408s
     0     0 43982.3954    0  404 24144.3490 43982.3954  82.2%     -  411s
     0     0 43939.3707    0  403 24144.3490 43939.3707  82.0%     -  420s
     0     0 43929.3721    0  401 24144.3490 43929.3721  81.9%     -  424s
     0     0 43895.3700    0  408 24144.3490 43895.3700  81.8%     -  435s
     0     0 43887.8585    0  412 24144.3490 43887.8585  81.8%     -  440s
     0     0 43886.5682    0  410 24144.3490 43886.5682  81.8%     -  441s
     0     0 41622.8874    0  368 24144.3490 41622.8874  72.4%     -  553s
H    0     0                    24165.595177 41622.8398  72.2%     -  554s
     0     0 41271.3457    0  438 24165.5952 41271.3457  70.8%     -  588s
     0     0 41145.7471    0  462 24165.5952 41145.7471  70.3%     -  613s
     0     0 41143.9597    0  430 24165.5952 41143.9597  70.3%     -  620s
     0     0 41013.1121    0  468 24165.5952 41013.1121  69.7%     -  648s
     0     0 40967.7031    0  477 24165.5952 40967.7031  69.5%     -  661s
     0     0 40944.5866    0  480 24165.5952 40944.5866  69.4%     -  670s
     0     0 40914.7316    0  441 24165.5952 40914.7316  69.3%     -  679s
     0     0 40902.4579    0  467 24165.5952 40902.4579  69.3%     -  685s
     0     0 40889.8233    0  469 24165.5952 40889.8233  69.2%     -  690s
     0     0 40842.1307    0  441 24165.5952 40842.1307  69.0%     -  699s
     0     0 40805.5854    0  434 24165.5952 40805.5854  68.9%     -  708s
     0     0 40792.9619    0  439 24165.5952 40792.9619  68.8%     -  713s
     0     0 40790.3953    0  437 24165.5952 40790.3953  68.8%     -  717s
     0     0 40787.3681    0  440 24165.5952 40787.3681  68.8%     -  720s
     0     0 40777.7195    0  436 24165.5952 40777.7195  68.7%     -  726s
     0     0 40773.6300    0  437 24165.5952 40773.6300  68.7%     -  729s
     0     0 40768.0485    0  437 24165.5952 40768.0485  68.7%     -  732s
     0     0 40759.8854    0  441 24165.5952 40759.8854  68.7%     -  735s
     0     0 40757.1393    0  440 24165.5952 40757.1393  68.7%     -  737s
     0     0 40753.9901    0  437 24165.5952 40753.9901  68.6%     -  740s
     0     0 40743.9546    0  437 24165.5952 40743.9546  68.6%     -  745s
     0     0 40736.7783    0  441 24165.5952 40736.7783  68.6%     -  748s
     0     0 40729.4848    0  440 24165.5952 40729.4848  68.5%     -  752s
     0     0 40728.6868    0  439 24165.5952 40728.6868  68.5%     -  754s
     0     0 40223.2339    0  413 24165.5952 40223.2339  66.4%     -  805s
     0     0 39993.4404    0  458 24165.5952 39993.4404  65.5%     -  829s
     0     0 39942.5638    0  464 24165.5952 39942.5638  65.3%     -  844s
     0     0 39932.6057    0  478 24165.5952 39932.6057  65.2%     -  850s
     0     0 39910.8197    0  477 24165.5952 39910.8197  65.2%     -  858s
     0     0 39873.1014    0  432 24165.5952 39873.1014  65.0%     -  866s
     0     0 39868.2383    0  435 24165.5952 39868.2383  65.0%     -  870s
     0     0 39863.4467    0  437 24165.5952 39863.4467  65.0%     -  872s
     0     0 39861.2314    0  435 24165.5952 39861.2314  65.0%     -  875s
     0     0 39701.7690    0  437 24165.5952 39701.7690  64.3%     -  903s
     0     0 39641.6833    0  497 24165.5952 39641.6833  64.0%     -  922s
     0     0 39627.3029    0  459 24165.5952 39627.3029  64.0%     -  929s
     0     0 39609.3616    0  448 24165.5952 39609.3616  63.9%     -  938s
     0     0 39601.6906    0  463 24165.5952 39601.6906  63.9%     -  946s
     0     0 39589.3110    0  438 24165.5952 39589.3110  63.8%     -  956s
     0     0 39584.6066    0  456 24165.5952 39584.6066  63.8%     -  959s
     0     0 39582.8090    0  445 24165.5952 39582.8090  63.8%     -  965s
     0     0 39525.5774    0  450 24165.5952 39525.5774  63.6%     -  986s
H    0     0                    25006.832621 39525.5534  58.1%     -  999s
H    0     0                    25039.277457 39525.5534  57.9%     - 1004s
     0     0 39518.6840    0  455 25039.2775 39518.6840  57.8%     - 1011s
     0     0 39513.1614    0  486 25039.2775 39513.1614  57.8%     - 1017s
     0     0 39507.1928    0  497 25039.2775 39507.1928  57.8%     - 1022s
     0     0 39502.0496    0  448 25039.2775 39502.0496  57.8%     - 1029s
     0     0 39500.3940    0  488 25039.2775 39500.3940  57.8%     - 1033s
     0     0 39463.6714    0  485 25039.2775 39463.6714  57.6%     - 1050s
     0     0 39455.3206    0  428 25039.2775 39455.3206  57.6%     - 1057s
     0     0 39448.9789    0  496 25039.2775 39448.9789  57.5%     - 1062s
     0     0 39447.4293    0  484 25039.2775 39447.4293  57.5%     - 1065s
     0     0 39420.8667    0  415 25039.2775 39420.8667  57.4%     - 1081s
H    0     0                    25048.942304 39420.4292  57.4%     - 1083s
     0     0 39410.5187    0  472 25048.9423 39410.5187  57.3%     - 1094s
     0     0 39404.5740    0  470 25048.9423 39404.5740  57.3%     - 1099s
     0     0 39400.4848    0  415 25048.9423 39400.4848  57.3%     - 1104s
     0     0 39395.7628    0  465 25048.9423 39395.7628  57.3%     - 1107s
     0     0 39395.1491    0  470 25048.9423 39395.1491  57.3%     - 1111s
     0     0 39374.2433    0  468 25048.9423 39374.2433  57.2%     - 1125s
     0     0 39358.1847    0  461 25048.9423 39358.1847  57.1%     - 1134s
     0     0 39354.0628    0  471 25048.9423 39354.0628  57.1%     - 1140s
     0     0 39353.4629    0  478 25048.9423 39353.4629  57.1%     - 1143s
     0     0 39322.8708    0  419 25048.9423 39322.8708  57.0%     - 1155s
H    0     0                    25197.787517 39322.8385  56.1%     - 1179s
     0     0 39309.1980    0  373 25197.7875 39309.1980  56.0%     - 1190s
     0     0 39303.2557    0  446 25197.7875 39303.2557  56.0%     - 1201s
     0     0 39301.5549    0  438 25197.7875 39301.5549  56.0%     - 1205s
     0     0 39281.9849    0  427 25197.7875 39281.9849  55.9%     - 1220s
     0     0 39269.2851    0  364 25197.7875 39269.2851  55.8%     - 1229s
     0     0 39266.9549    0  427 25197.7875 39266.9549  55.8%     - 1234s
     0     0 39254.0765    0  481 25197.7875 39254.0765  55.8%     - 1243s
     0     0 39249.4605    0  477 25197.7875 39249.4605  55.8%     - 1248s
     0     0 39245.6717    0  374 25197.7875 39245.6717  55.8%     - 1251s
     0     0 39245.5092    0  420 25197.7875 39245.5092  55.7%     - 1252s
     0     0 39227.6234    0  477 25197.7875 39227.6234  55.7%     - 1264s
     0     0 39225.2685    0  371 25197.7875 39225.2685  55.7%     - 1269s
     0     0 39221.5522    0  431 25197.7875 39221.5522  55.7%     - 1275s
H    0     0                    25244.904754 39221.4258  55.4%     - 1276s
     0     0 39220.9985    0  432 25244.9048 39220.9985  55.4%     - 1278s
     0     0 39218.1941    0  377 25244.9048 39218.1941  55.4%     - 1283s
     0     0 39218.0317    0  377 25244.9048 39218.0317  55.4%     - 1285s
     0     0 39216.4888    0  381 25244.9048 39216.4888  55.3%     - 1288s
     0     0 39215.9007    0  442 25244.9048 39215.9007  55.3%     - 1321s
     0     0 39209.2064    0  441 25244.9048 39209.2064  55.3%     - 1326s
     0     0 39209.1871    0  441 25244.9048 39209.1871  55.3%     - 1332s
H    0     0                    25278.148864 39209.1871  55.1%     - 1553s
     0     2 39209.1871    0  441 25278.1489 39209.1871  55.1%     - 1557s
     1     3 39030.8511    1  360 25278.1489 39209.1871  55.1% 12302 1576s
     2     4 39135.0577    1  428 25278.1489 39135.0577  54.8% 12558 1594s
     3     5 37953.6215    2  456 25278.1489 39135.0563  54.8% 15642 1623s
     4     8 39054.3300    2  481 25278.1489 39134.9557  54.8% 13879 1653s
     7    14 38758.8295    3  420 25278.1489 39134.9557  54.8% 14526 1698s
    13    26 38525.4392    4  426 25278.1489 39054.0526  54.5% 15572 1738s
    25    38 37257.2329    4  423 25278.1489 38756.7448  53.3% 23129 1839s
    37    65 36186.7923    5  357 25278.1489 38525.0661  52.4% 22020 2018s
H   42    65                    25285.687982 38525.0661  52.4% 21328 2018s
H   45    65                    25320.085195 38525.0661  52.2% 21725 2018s
H   46    65                    25382.110933 38525.0661  51.8% 21706 2018s
H   50    65                    25800.027877 38525.0661  49.3% 20922 2018s
    64    97 36527.6405    6  358 25800.0279 38525.0661  49.3% 26476 2070s
    96   129 36437.6338    7  297 25800.0279 38525.0661  49.3% 24762 2239s
   128   215 36115.6009    8  340 25800.0279 38525.0661  49.3% 22545 2314s
H  143   215                    25855.932865 38525.0661  49.0% 20817 2314s
H  147   215                    26028.617778 38525.0661  48.0% 20352 2314s
H  156   215                    26129.221327 38525.0661  47.4% 19727 2314s
H  183   215                    26281.231423 38525.0661  46.6% 17824 2314s
   214   259 36085.0900   10  288 26281.2314 38525.0661  46.6% 16197 2356s
   258   291 35919.4875   11  285 26281.2314 38525.0661  46.6% 14602 2402s
   290   346 35633.4423   12  273 26281.2314 38525.0661  46.6% 14141 2446s
   349   441 33973.4089   14  228 26281.2314 38525.0661  46.6% 13845 2490s
   444   522 33902.8108   15  304 26281.2314 38525.0661  46.6% 12435 2527s
   528   558 33882.7806   16  310 26281.2314 38525.0661  46.6% 12008 2559s
   572   590 32968.1471   19  316 26281.2314 38525.0661  46.6% 11996 2592s
   612   624 32659.0594   20  279 26281.2314 38525.0661  46.6% 12125 2630s
   657   675 32568.6852   22  273 26281.2314 38525.0661  46.6% 12322 2667s
   726   734 32267.0185   25  273 26281.2314 38525.0661  46.6% 12420 2699s
   797   752 32117.7105   28  280 26281.2314 38525.0661  46.6% 12036 2727s
   861   769 32002.8913   29  271 26281.2314 38525.0661  46.6% 11903 2759s
   941   816 31788.3501   31  261 26281.2314 38525.0661  46.6% 11683 2796s
  1032   878 31693.6814   34  181 26281.2314 38525.0661  46.6% 11509 2828s
  1164   866 30641.9844   38  179 26281.2314 38525.0661  46.6% 10884 2866s
  1268   865 27911.5643   41  144 26281.2314 38525.0661  46.6% 10549 2905s
  1327   931 infeasible   45      26281.2314 38525.0661  46.6% 10448 2947s
  1433  1006 28312.6273   52  306 26281.2314 38525.0661  46.6% 10161 2990s
  1536   999 27698.5481   61  127 26281.2314 38525.0661  46.6% 10015 3031s
  1653  1011 33899.3770   10  232 26281.2314 38525.0661  46.6%  9929 3080s
  1707  1042 29861.1144   12  198 26281.2314 38525.0661  46.6%  9956 3127s
  1750  1070     cutoff   13      26281.2314 38525.0661  46.6% 10129 3175s
  1786  1119 28981.4609   12  371 26281.2314 38525.0661  46.6% 10313 3223s
  1871  1185 28176.9507   20  189 26281.2314 38525.0661  46.6% 10340 3265s
  1993  1279 27310.6800   27  207 26281.2314 38525.0661  46.6% 10204 3316s
  2123  1357 26434.5748   36  136 26281.2314 38525.0661  46.6% 10053 3360s
  2263  1426 35779.9828    7  331 26281.2314 38525.0661  46.6%  9938 3416s
  2397  1520 33354.3667    8  306 26281.2314 38525.0661  46.6%  9841 3475s
  2553  1638 32804.3430   10  346 26281.2314 38525.0661  46.6%  9745 3533s
  2711  1742 32526.9933   12  386 26281.2314 38525.0661  46.6%  9627 3595s
  2892  1749 29143.6231   41  116 26281.2314 38525.0661  46.6%  9552 3600s

Cutting planes:
  Learned: 2
  Implied bound: 192
  MIR: 4188
  Flow cover: 4233
  RLT: 58
  Relax-and-lift: 711

Explored 2909 nodes (28584132 simplex iterations) in 3600.10 seconds (9213.27 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26281.2 26129.2 26028.6 ... 25244.9

Time limit reached
Best objective 2.628123142291e+04, best bound 3.852506611456e+04, gap 46.5878%
  WARNING: Time limit reached. Using best solution found (gap: 46.59%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 26281.23, θ = 176695.20
  Upper Bound (UB) = 26281.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176695.20
  [DEBUG]   ✓ Scenario 0: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 176695.20 ≤ Q = 176695.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 176695.20 ≤ Q = 176695.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 176695.20 ≤ Q = 176695.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 176695.20 ≤ Q = 176695.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 176695.20 ≤ Q = 176695.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 176695.20 ≤ Q = 176695.20 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x222fcb48
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xddd034b8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.404088e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6565723.7711
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.636416e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163641.62    0  124 6565723.77 -163641.62   102%     -    0s
H    0     0                    -130914.7980 -163641.62  25.0%     -    0s
     0     0 -134669.41    0   72 -130914.80 -134669.41  2.87%     -    0s
H    0     0                    -133178.6655 -134538.70  1.02%     -    0s
     0     0 -133967.90    0   54 -133178.67 -133967.90  0.59%     -    0s
     0     0 -133843.93    0   53 -133178.67 -133843.93  0.50%     -    0s
     0     0 -133838.07    0   53 -133178.67 -133838.07  0.50%     -    0s
     0     0 -133820.77    0   54 -133178.67 -133820.77  0.48%     -    0s
     0     0 -133820.77    0   54 -133178.67 -133820.77  0.48%     -    0s
H    0     0                    -133187.3538 -133820.77  0.48%     -    0s
     0     2 -133820.77    0   54 -133187.35 -133820.77  0.48%     -    0s
H   30    36                    -133269.5662 -133565.91  0.22%  11.4    0s
H   46    33                    -133371.5229 -133518.83  0.11%  11.2    0s

Cutting planes:
  Gomory: 37
  Implied bound: 1
  MIR: 156
  Flow cover: 3
  RLT: 1

Explored 146 nodes (1533 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -133372 -133270 -133187 ... 1.40409e+13
No other solutions better than -133372

Optimal solution found (tolerance 1.00e-04)
Best objective -1.333715228731e+05, best bound -1.333715228731e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 176374.34
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133371.52
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -133371.52 = 176374.34
  [DEBUG]   Current θ from Master = 176695.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 320.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25960.37
  Lower Bound (LB) = 25960.37
  Gap (UB-LB) = 320.8619, Absolute Gap = 320.8619, Relative Gap = 0.012209
  Not converged yet (gap = 320.86 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956535 nonzeros
Model fingerprint: 0x67c154fc
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 158302 rows and 64312 columns
Presolve time: 3.49s
Presolved: 179461 rows, 75228 columns, 1105879 nonzeros
Variable types: 72969 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -197770.0082

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.49s

Barrier statistics:
 Dense cols : 1070
 AA' NZ     : 4.881e+06
 Factor NZ  : 1.320e+07 (roughly 200 MB of memory)
 Factor Ops : 4.253e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.18980874e+07  3.33656262e+08  1.52e+05 1.63e+01  9.76e+04     7s
   1  -1.72167245e+07  3.07553606e+08  1.09e+05 9.78e+01  6.93e+04     7s
   2  -6.03964971e+06  2.38068938e+08  3.69e+04 2.02e+01  2.49e+04     7s
   3  -1.35927323e+06  1.77622067e+08  4.70e+03 1.99e+00  3.56e+03     7s
   4  -7.47436543e+05  1.39693360e+08  9.62e+02 1.15e+00  1.02e+03     7s
   5  -6.62065719e+05  8.02100256e+07  5.64e+02 5.52e-01  5.60e+02     7s
   6  -5.64631839e+05  5.37064291e+07  2.87e+02 3.33e-01  3.14e+02     7s
   7  -4.02965329e+05  3.94615541e+07  5.89e+01 2.28e-01  1.50e+02     7s
   8  -3.64213051e+05  2.47965241e+07  4.00e+01 1.34e-01  9.20e+01     7s
   9  -2.41282609e+05  1.76496755e+07  1.36e+01 9.15e-02  5.89e+01     7s
  10  -2.10950888e+05  1.14632344e+07  1.04e+01 5.78e-02  3.80e+01     7s
  11  -1.68436471e+05  7.80525603e+06  7.06e+00 3.82e-02  2.55e+01     7s
  12  -1.37297384e+05  6.14472596e+06  4.63e+00 2.96e-02  1.98e+01     8s
  13  -1.22074578e+05  3.96886998e+06  3.31e+00 1.89e-02  1.28e+01     8s
  14  -8.82537292e+04  2.30493141e+06  1.29e+00 1.10e-02  7.40e+00     8s
  15  -5.65703896e+04  7.27071938e+05  3.81e-01 3.31e-03  2.41e+00     8s
  16  -2.84610569e+04  3.60634562e+05  1.85e-01 1.83e-03  1.19e+00     8s
  17  -1.05434756e+04  2.41876486e+05  1.27e-01 1.34e-03  7.74e-01     8s
  18   4.50155556e+03  1.75523572e+05  9.38e-02 1.36e-03  5.24e-01     8s
  19   1.74494272e+04  1.30517966e+05  6.91e-02 4.04e-03  3.47e-01     8s
  20   2.17268793e+04  1.06821724e+05  6.09e-02 3.24e-03  2.61e-01     8s
  21   2.48240427e+04  9.74587317e+04  5.46e-02 3.17e-03  2.23e-01     8s
  22   2.89443730e+04  8.64967393e+04  4.65e-02 2.39e-03  1.76e-01     8s
  23   3.19444198e+04  7.73367189e+04  4.09e-02 1.66e-03  1.39e-01     8s
  24   3.36664252e+04  7.44398335e+04  3.78e-02 1.44e-03  1.25e-01     8s
  25   3.92205214e+04  7.13393264e+04  2.80e-02 1.18e-03  9.85e-02     8s
  26   4.12696489e+04  7.00117880e+04  2.45e-02 1.08e-03  8.81e-02     9s
  27   4.29064020e+04  6.80181728e+04  2.18e-02 9.44e-04  7.70e-02     9s
  28   4.43008086e+04  6.59708053e+04  1.95e-02 7.93e-04  6.65e-02     9s
  29   4.54069795e+04  6.37585786e+04  1.77e-02 6.19e-04  5.63e-02     9s
  30   4.72352848e+04  6.24455799e+04  1.48e-02 4.77e-04  4.67e-02     9s
  31   4.80316333e+04  6.20818081e+04  1.35e-02 4.44e-04  4.31e-02     9s
  32   4.86241121e+04  6.15919066e+04  1.26e-02 3.99e-04  3.98e-02     9s
  33   4.93257931e+04  6.06951482e+04  1.15e-02 3.28e-04  3.49e-02     9s
  34   5.01826594e+04  6.03273265e+04  1.02e-02 2.97e-04  3.11e-02     9s
  35   5.05757765e+04  5.99747676e+04  9.57e-03 2.69e-04  2.88e-02     9s
  36   5.14731638e+04  5.92239844e+04  8.17e-03 2.03e-04  2.38e-02     9s
  37   5.23300822e+04  5.88077080e+04  6.81e-03 1.68e-04  1.99e-02    10s
  38   5.28987721e+04  5.82707389e+04  5.89e-03 3.31e-04  1.65e-02    10s
  39   5.32456043e+04  5.79596611e+04  5.37e-03 3.03e-04  1.45e-02    10s
  40   5.37741269e+04  5.77635305e+04  4.58e-03 2.56e-04  1.22e-02    10s
  41   5.41672870e+04  5.76412907e+04  3.96e-03 2.24e-04  1.07e-02    10s
  42   5.48914032e+04  5.74980475e+04  2.87e-03 1.84e-04  8.00e-03    10s
  43   5.54286594e+04  5.74077362e+04  2.07e-03 1.59e-04  6.07e-03    10s
  44   5.56672459e+04  5.73233888e+04  1.70e-03 1.35e-04  5.08e-03    10s
  45   5.58851053e+04  5.71724956e+04  1.37e-03 1.08e-04  3.95e-03    10s
  46   5.61610811e+04  5.70081482e+04  9.57e-04 5.41e-05  2.60e-03    10s
  47   5.62792450e+04  5.69964178e+04  7.79e-04 5.09e-05  2.20e-03    11s
  48   5.64522427e+04  5.69401626e+04  5.25e-04 3.43e-05  1.50e-03    11s
  49   5.66320718e+04  5.68587501e+04  2.69e-04 3.22e-05  6.96e-04    11s
  50   5.67003259e+04  5.68426760e+04  1.74e-04 1.37e-05  4.37e-04    11s
  51   5.67458374e+04  5.68362088e+04  1.11e-04 5.10e-06  2.77e-04    11s
  52   5.68199043e+04  5.68317970e+04  1.28e-05 1.33e-06  3.65e-05    11s
  53   5.68294359e+04  5.68299810e+04  6.42e-07 5.13e-07  1.67e-06    11s
  54   5.68298887e+04  5.68298888e+04  1.27e-09 1.62e-08  3.76e-10    11s

Barrier solved model in 54 iterations and 11.13 seconds (18.21 work units)
Optimal objective 5.68298887e+04


Root crossover log...

  159160 DPushes remaining with DInf 0.0000000e+00                11s
    2955 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    6772 PPushes remaining with PInf 7.5289550e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2636712e+02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   78628    5.6829889e+04   0.000000e+00   2.263671e+02     17s
   78668    5.6829889e+04   0.000000e+00   0.000000e+00     17s
   78668    5.6829889e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.94s

Solved with barrier

Root relaxation: objective 5.682989e+04, 78668 iterations, 13.30 seconds (25.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56829.8888    0  163 -197770.01 56829.8888   129%     -   18s
H    0     0                    -153759.9818 56829.8888   137%     -   19s
H    0     0                    -133335.1328 56829.8888   143%     -   19s
H    0     0                    -132307.4114 56829.8888   143%     -   19s
H    0     0                    -119986.3916 56829.8888   147%     -   19s
H    0     0                    -119662.1435 56829.8888   147%     -   19s
H    0     0                    -119368.1329 56829.8888   148%     -   19s
H    0     0                    -56915.74733 56829.8888   200%     -   20s
H    0     0                    -220.5606863 56829.8888      -     -   20s
H    0     0                    10111.407746 56829.8888   462%     -   20s
H    0     0                    12998.611474 56829.8888   337%     -   21s
H    0     0                    13250.225132 56829.8888   329%     -   21s
H    0     0                    13327.376282 56829.8888   326%     -   21s
     0     0 49462.7081    0  257 13327.3763 49462.7081   271%     -  117s
H    0     0                    16223.449603 49462.6969   205%     -  118s
H    0     0                    17242.774488 49462.6969   187%     -  119s
     0     0 49111.9769    0  248 17242.7745 49111.9769   185%     -  147s
     0     0 49029.8157    0  244 17242.7745 49029.8157   184%     -  159s
     0     0 49009.0157    0  254 17242.7745 49009.0157   184%     -  165s
     0     0 48715.3571    0  259 17242.7745 48715.3571   183%     -  183s
     0     0 48294.1289    0  266 17242.7745 48294.1289   180%     -  210s
     0     0 48279.6139    0  263 17242.7745 48279.6139   180%     -  220s
     0     0 48278.5669    0  270 17242.7745 48278.5669   180%     -  222s
     0     0 48272.6998    0  270 17242.7745 48272.6998   180%     -  225s
     0     0 48250.2506    0  272 17242.7745 48250.2506   180%     -  231s
     0     0 48249.6370    0  271 17242.7745 48249.6370   180%     -  233s
     0     0 45032.5347    0  386 17242.7745 45032.5347   161%     -  321s
H    0     0                    23024.306657 45032.4701  95.6%     -  322s
     0     0 44472.3989    0  405 23024.3067 44472.3989  93.2%     -  359s
     0     0 44355.7894    0  411 23024.3067 44355.7894  92.6%     -  376s
     0     0 44290.0230    0  427 23024.3067 44290.0230  92.4%     -  395s
     0     0 44181.4886    0  422 23024.3067 44181.4886  91.9%     -  417s
     0     0 44164.1382    0  424 23024.3067 44164.1382  91.8%     -  427s
     0     0 44155.3882    0  367 23024.3067 44155.3882  91.8%     -  434s
     0     0 44074.6085    0  408 23024.3067 44074.6085  91.4%     -  454s
     0     0 44068.7812    0  414 23024.3067 44068.7812  91.4%     -  459s
     0     0 44063.3279    0  419 23024.3067 44063.3279  91.4%     -  463s
     0     0 43977.5918    0  406 23024.3067 43977.5918  91.0%     -  479s
     0     0 43965.5116    0  410 23024.3067 43965.5116  91.0%     -  487s
     0     0 43962.2999    0  412 23024.3067 43962.2999  90.9%     -  489s
     0     0 43961.2012    0  412 23024.3067 43961.2012  90.9%     -  490s
     0     0 42434.1088    0  387 23024.3067 42434.1088  84.3%     -  602s
H    0     0                    23273.255368 42434.0979  82.3%     -  603s
H    0     0                    24070.278381 42434.0979  76.3%     -  603s
H    0     0                    24078.862457 42434.0979  76.2%     -  603s
H    0     0                    24725.124836 42434.0979  71.6%     -  603s
     0     0 41881.8807    0  406 24725.1248 41881.8807  69.4%     -  650s
     0     0 41738.8214    0  423 24725.1248 41738.8214  68.8%     -  675s
     0     0 41690.2668    0  435 24725.1248 41690.2668  68.6%     -  692s
     0     0 41647.2894    0  433 24725.1248 41647.2894  68.4%     -  705s
     0     0 41616.3915    0  430 24725.1248 41616.3915  68.3%     -  722s
     0     0 41594.7192    0  433 24725.1248 41594.7192  68.2%     -  734s
     0     0 41579.1267    0  440 24725.1248 41579.1267  68.2%     -  743s
     0     0 41568.4113    0  434 24725.1248 41568.4113  68.1%     -  748s
     0     0 41540.8287    0  432 24725.1248 41540.8287  68.0%     -  761s
     0     0 41523.9157    0  430 24725.1248 41523.9157  67.9%     -  774s
     0     0 41472.2267    0  472 24725.1248 41472.2267  67.7%     -  787s
     0     0 41456.5250    0  473 24725.1248 41456.5250  67.7%     -  795s
     0     0 41454.0714    0  473 24725.1248 41454.0714  67.7%     -  798s
     0     0 41448.7167    0  471 24725.1248 41448.7167  67.6%     -  802s
     0     0 41446.3740    0  435 24725.1248 41446.3740  67.6%     -  804s
     0     0 41443.3974    0  439 24725.1248 41443.3974  67.6%     -  808s
     0     0 41439.6568    0  439 24725.1248 41439.6568  67.6%     -  811s
     0     0 41436.0945    0  446 24725.1248 41436.0945  67.6%     -  814s
     0     0 41418.5358    0  429 24725.1248 41418.5358  67.5%     -  821s
     0     0 41414.6564    0  431 24725.1248 41414.6564  67.5%     -  827s
     0     0 41414.1531    0  435 24725.1248 41414.1531  67.5%     -  829s
     0     0 40556.0041    0  418 24725.1248 40556.0041  64.0%     -  895s
     0     0 40351.2163    0  461 24725.1248 40351.2163  63.2%     -  919s
     0     0 40263.8290    0  427 24725.1248 40263.8290  62.8%     -  937s
     0     0 40240.2011    0  427 24725.1248 40240.2011  62.8%     -  950s
     0     0 40208.7263    0  431 24725.1248 40208.7263  62.6%     -  959s
     0     0 40174.9209    0  472 24725.1248 40174.9209  62.5%     -  969s
     0     0 40166.5586    0  430 24725.1248 40166.5586  62.5%     -  974s
     0     0 40123.8816    0  430 24725.1248 40123.8816  62.3%     -  985s
     0     0 40116.2419    0  432 24725.1248 40116.2419  62.2%     -  990s
     0     0 40111.4716    0  435 24725.1248 40111.4716  62.2%     -  994s
     0     0 40107.7213    0  431 24725.1248 40107.7213  62.2%     -  997s
     0     0 40095.4410    0  434 24725.1248 40095.4410  62.2%     - 1004s
     0     0 40084.7427    0  425 24725.1248 40084.7427  62.1%     - 1008s
     0     0 40073.9015    0  429 24725.1248 40073.9015  62.1%     - 1014s
     0     0 40053.0505    0  429 24725.1248 40053.0505  62.0%     - 1020s
     0     0 40051.2651    0  435 24725.1248 40051.2651  62.0%     - 1022s
     0     0 39788.2398    0  439 24725.1248 39788.2398  60.9%     - 1062s
     0     0 39731.5486    0  485 24725.1248 39731.5486  60.7%     - 1080s
     0     0 39722.3976    0  485 24725.1248 39722.3976  60.7%     - 1086s
     0     0 39716.8810    0  484 24725.1248 39716.8810  60.6%     - 1094s
     0     0 39712.5458    0  487 24725.1248 39712.5458  60.6%     - 1098s
     0     0 39702.9519    0  485 24725.1248 39702.9519  60.6%     - 1105s
     0     0 39697.6842    0  484 24725.1248 39697.6842  60.6%     - 1109s
     0     0 39691.6771    0  485 24725.1248 39691.6771  60.5%     - 1114s
     0     0 39685.4509    0  489 24725.1248 39685.4509  60.5%     - 1119s
     0     0 39682.8173    0  495 24725.1248 39682.8173  60.5%     - 1122s
     0     0 39679.5771    0  493 24725.1248 39679.5771  60.5%     - 1125s
     0     0 39677.2774    0  487 24725.1248 39677.2774  60.5%     - 1130s
     0     0 39579.7148    0  427 24725.1248 39579.7148  60.1%     - 1159s
H    0     0                    24859.153128 39579.6107  59.2%     - 1182s
     0     0 39540.6106    0  499 24859.1531 39540.6106  59.1%     - 1204s
     0     0 39531.5476    0  487 24859.1531 39531.5476  59.0%     - 1212s
     0     0 39524.1663    0  501 24859.1531 39524.1663  59.0%     - 1218s
     0     0 39521.4373    0  486 24859.1531 39521.4373  59.0%     - 1221s
     0     0 39473.5941    0  474 24859.1531 39473.5941  58.8%     - 1238s
     0     0 39461.2686    0  484 24859.1531 39461.2686  58.7%     - 1246s
     0     0 39455.8900    0  487 24859.1531 39455.8900  58.7%     - 1253s
     0     0 39449.8629    0  486 24859.1531 39449.8629  58.7%     - 1258s
     0     0 39443.2012    0  482 24859.1531 39443.2012  58.7%     - 1263s
     0     0 39441.4965    0  489 24859.1531 39441.4965  58.7%     - 1266s
     0     0 39411.8318    0  515 24859.1531 39411.8318  58.5%     - 1283s
H    0     0                    24880.399291 39411.7765  58.4%     - 1284s
     0     0 39381.8303    0  509 24880.3993 39381.8303  58.3%     - 1298s
     0     0 39370.5223    0  514 24880.3993 39370.5223  58.2%     - 1305s
     0     0 39359.4180    0  511 24880.3993 39359.4180  58.2%     - 1315s
     0     0 39357.5444    0  511 24880.3993 39357.5444  58.2%     - 1319s
     0     0 39308.5105    0  500 24880.3993 39308.5105  58.0%     - 1340s
H    0     0                    24912.844126 39308.4895  57.8%     - 1343s
     0     0 39304.1383    0  496 24912.8441 39304.1383  57.8%     - 1353s
     0     0 39302.9877    0  495 24912.8441 39302.9877  57.8%     - 1356s
     0     0 39296.7987    0  449 24912.8441 39296.7987  57.7%     - 1367s
     0     0 39295.2919    0  454 24912.8441 39295.2919  57.7%     - 1372s
     0     0 39287.5369    0  454 24912.8441 39287.5369  57.7%     - 1379s
H    0     0                    25103.671966 39287.3162  56.5%     - 1404s
H    0     0                    25124.918128 39287.3162  56.4%     - 1408s
H    0     0                    25237.879962 39287.3162  55.7%     - 1408s
     0     0 39285.0494    0  458 25237.8800 39285.0494  55.7%     - 1415s
     0     0 39269.0613    0  460 25237.8800 39269.0613  55.6%     - 1431s
     0     0 39263.6468    0  469 25237.8800 39263.6468  55.6%     - 1442s
     0     0 39255.8554    0  470 25237.8800 39255.8554  55.5%     - 1451s
     0     0 39255.0500    0  474 25237.8800 39255.0500  55.5%     - 1454s
     0     0 39235.2910    0  473 25237.8800 39235.2910  55.5%     - 1473s
     0     0 39228.4492    0  472 25237.8800 39228.4492  55.4%     - 1482s
     0     0 39227.3091    0  478 25237.8800 39227.3091  55.4%     - 1484s
     0     0 39210.2100    0  515 25237.8800 39210.2100  55.4%     - 1498s
     0     0 39204.2874    0  474 25237.8800 39204.2874  55.3%     - 1505s
     0     0 39202.8987    0  473 25237.8800 39202.8987  55.3%     - 1508s
     0     0 39196.8854    0  466 25237.8800 39196.8854  55.3%     - 1518s
     0     0 39193.2636    0  469 25237.8800 39193.2636  55.3%     - 1524s
     0     0 39191.8926    0  468 25237.8800 39191.8926  55.3%     - 1527s
     0     0 39189.2157    0  469 25237.8800 39189.2157  55.3%     - 1533s
     0     0 39189.1825    0  469 25237.8800 39189.1825  55.3%     - 1541s
H    0     0                    25334.993696 39189.1825  54.7%     - 1767s
     0     2 39189.1825    0  469 25334.9937 39189.1825  54.7%     - 1774s
     1     3 38937.4901    1  433 25334.9937 39189.1825  54.7% 21935 1811s
     2     4 39104.1679    1  464 25334.9937 39104.1679  54.3% 15802 1825s
     3     5 37773.4190    2  367 25334.9937 39103.4203  54.3% 29059 1923s
     4     8 38550.4469    2  437 25334.9937 39103.3297  54.3% 26705 1958s
     7    15 38249.9797    3  393 25334.9937 39103.3297  54.3% 23047 2004s
    14    30 37949.8481    4  380 25334.9937 38545.4731  52.1% 19570 2086s
    29    45 37749.5718    5  424 25334.9937 38055.4490  50.2% 29956 2255s
    44    77 37496.6490    6  430 25334.9937 38055.4490  50.2% 30746 2402s
H   47    77                    25507.911751 38055.4490  49.2% 29468 2402s
    76   177 37392.2379    7  414 25507.9118 37918.9440  48.7% 26074 2561s
   176   207 37145.0875    9  352 25507.9118 37918.3018  48.7% 17646 2604s
H  180   207                    25742.603436 37918.3018  47.3% 17286 2604s
   206   237 36973.5413   10  319 25742.6034 37918.3018  47.3% 16236 2670s
H  236   271                    25758.406754 37918.3018  47.2% 15265 2714s
H  239   271                    25956.513626 37918.3018  46.1% 15228 2714s
   270   360 36654.0108   12  330 25956.5136 37918.3018  46.1% 16168 2767s
   361   427 36436.2197   14  376 25956.5136 37918.3018  46.1% 13674 2809s
   428   471 36106.1759   16  380 25956.5136 37918.3018  46.1% 12475 2851s
   476   527 35840.5977   18  269 25956.5136 37918.3018  46.1% 11990 2894s
   540   588 35627.3669   20  270 25956.5136 37918.3018  46.1% 11320 2932s
   607   650 35502.6222   21  262 25956.5136 37918.3018  46.1% 10701 2973s
   669   704 35238.7429   23  358 25956.5136 37918.3018  46.1% 10255 3010s
   729   730 34795.9041   27  287 25956.5136 37918.3018  46.1%  9826 3044s
H  736   730                    25997.791443 37918.3018  45.9%  9787 3044s
   757   772 34778.9774   28  285 25997.7914 37918.3018  45.9%  9683 3089s
   803   833 34654.7786   30  352 25997.7914 37918.3018  45.9%  9508 3131s
   870   878 33850.9919   32  346 25997.7914 37918.3018  45.9%  9157 3169s
   927   915 33115.9611   34  336 25997.7914 37918.3018  45.9%  8924 3213s
   984   957 32719.6685   38  302 25997.7914 37918.3018  45.9%  8774 3252s
  1042  1023 32270.8745   41  303 25997.7914 37918.3018  45.9%  8594 3300s
  1147  1034 31440.4786   46  286 25997.7914 37918.3018  45.9%  8176 3347s
H 1148  1034                    26187.433678 37918.3018  44.8%  8169 3347s
  1198  1058 31326.8093   47  269 26187.4337 37918.3018  44.8%  8054 3400s
  1290  1102 30612.6521   52  185 26187.4337 37918.3018  44.8%  7836 3452s
  1369  1162 29690.2391   57  187 26187.4337 37918.3018  44.8%  7734 3516s
  1470  1245 28640.0839   62  239 26187.4337 37918.3018  44.8%  7541 3567s
  1601  1319 28173.1968   68  181 26187.4337 37918.3018  44.8%  7281 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 193
  MIR: 4274
  Flow cover: 4313
  RLT: 69
  Relax-and-lift: 681

Explored 1717 nodes (13050898 simplex iterations) in 3600.19 seconds (8580.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26187.4 25997.8 25956.5 ... 25103.7

Time limit reached
Best objective 2.618743367809e+04, best bound 3.791830179013e+04, gap 44.7958%
  WARNING: Time limit reached. Using best solution found (gap: 44.80%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 26187.43, θ = 176268.51
  Upper Bound (UB) = 26187.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176268.51
  [DEBUG]   ✓ Scenario 0: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 176268.51 ≤ Q = 176268.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 176268.51 ≤ Q = 177812.87 (slack: 1544.36)
  [DEBUG]   ✓ Scenario 19: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 176268.51 ≤ Q = 176268.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x11fd0b15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x11fd0b15
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.399790e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6549259.3854
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.641317e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164131.75    0  124 6549259.39 -164131.75   103%     -    0s
H    0     0                    -131234.8436 -164131.75  25.1%     -    0s
     0     0 -135908.19    0   55 -131234.84 -135908.19  3.56%     -    0s
H    0     0                    -132158.6231 -135834.13  2.78%     -    0s
H    0     0                    -134108.9973 -135834.13  1.29%     -    0s
H    0     0                    -134600.0194 -135834.13  0.92%     -    0s
H    0     0                    -135323.7293 -135834.13  0.38%     -    0s
     0     0 -135505.90    0    6 -135323.73 -135505.90  0.13%     -    0s
H    0     0                    -135433.3475 -135502.99  0.05%     -    0s
     0     0          -    0      -135433.35 -135445.13  0.01%     -    0s

Cutting planes:
  Gomory: 30
  Implied bound: 1
  MIR: 152
  Flow cover: 2
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (438 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -135433 -135324 -134600 ... 1.39979e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.354333475263e+05, best bound -1.354451291190e+05, gap 0.0087%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 174312.51
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135433.35
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -135433.35 = 174312.51
  [DEBUG]   Current θ from Master = 176268.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1956.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24231.44
  Lower Bound (LB) = 25960.37
  Gap (UB-LB) = 227.0641, Absolute Gap = 227.0641, Relative Gap = 0.008671
  Not converged yet (gap = 227.06 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999763 nonzeros
Model fingerprint: 0xab88e086
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [8e-02, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 165513 rows and 67243 columns
Presolve time: 4.16s
Presolved: 187540 rows, 78537 columns, 1155807 nonzeros
Variable types: 76278 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -329826.0254
Found heuristic solution: objective -197770.0082

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.79s

Barrier statistics:
 Dense cols : 1070
 AA' NZ     : 5.254e+06
 Factor NZ  : 1.425e+07 (roughly 220 MB of memory)
 Factor Ops : 4.682e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.26820508e+07  3.46276479e+08  1.57e+05 1.59e+01  1.01e+05     8s
   1  -1.78684182e+07  3.21270006e+08  1.13e+05 9.86e+01  7.15e+04     8s
   2  -6.56153524e+06  2.53239813e+08  4.00e+04 2.56e+01  2.68e+04     8s
   3  -1.51882617e+06  1.88587492e+08  5.22e+03 1.52e+00  3.92e+03     8s
   4  -8.13899548e+05  1.38274108e+08  1.03e+03 5.99e-01  1.04e+03     8s
   5  -7.23326806e+05  9.39656608e+07  5.74e+02 3.48e-01  6.04e+02     8s
   6  -6.48507752e+05  5.97685155e+07  3.07e+02 1.82e-01  3.37e+02     8s
   7  -4.94828485e+05  4.27913520e+07  7.64e+01 1.09e-01  1.63e+02     8s
   8  -3.61177899e+05  2.80996160e+07  2.68e+01 3.74e-02  9.39e+01     9s
   9  -2.63439521e+05  1.91927090e+07  9.44e+00 1.86e-02  5.99e+01     9s
  10  -2.13612503e+05  1.22613816e+07  6.90e+00 1.16e-02  3.80e+01     9s
  11  -1.71808233e+05  9.18201116e+06  4.71e+00 8.59e-03  2.82e+01     9s
  12  -1.48262205e+05  7.47872055e+06  3.24e+00 6.97e-03  2.28e+01     9s
  13  -1.37612148e+05  5.15648048e+06  2.58e+00 4.78e-03  1.58e+01     9s
  14  -1.06207936e+05  3.87168620e+06  1.32e+00 3.50e-03  1.18e+01     9s
  15  -6.47994990e+04  1.65130394e+06  3.32e-01 1.47e-03  5.04e+00     9s
  16  -3.36137442e+04  4.00674384e+05  1.12e-01 2.95e-04  1.27e+00     9s
  17  -1.34756683e+04  2.56747480e+05  7.17e-02 4.98e-04  7.92e-01     9s
  18   1.15180353e+03  1.94555635e+05  5.33e-02 2.11e-03  5.67e-01     9s
  19   1.37618089e+04  1.40298480e+05  4.00e-02 1.70e-03  3.71e-01     9s
  20   1.91822853e+04  1.21534679e+05  3.44e-02 1.37e-03  3.00e-01     9s
  21   2.50758438e+04  1.03374579e+05  2.85e-02 1.15e-03  2.30e-01    10s
  22   3.27443462e+04  8.37229253e+04  2.08e-02 6.77e-04  1.49e-01    10s
  23   3.43434486e+04  7.75268193e+04  1.92e-02 5.25e-04  1.27e-01    10s
  24   3.91745086e+04  7.46973038e+04  1.48e-02 4.56e-04  1.04e-01    10s
  25   4.22887046e+04  7.28376666e+04  1.19e-02 4.12e-04  8.96e-02    10s
  26   4.36133644e+04  6.81579588e+04  1.07e-02 3.00e-04  7.20e-02    10s
  27   4.49419366e+04  6.52419418e+04  9.57e-03 2.27e-04  5.95e-02    10s
  28   4.69084565e+04  6.39481564e+04  7.97e-03 1.95e-04  5.00e-02    10s
  29   4.76327938e+04  6.26565873e+04  7.37e-03 1.63e-04  4.41e-02    10s
  30   4.84138379e+04  6.13595884e+04  6.71e-03 1.26e-04  3.80e-02    11s
  31   4.99887840e+04  6.08788109e+04  5.49e-03 1.10e-04  3.19e-02    11s
  32   5.09295713e+04  6.00500989e+04  4.75e-03 8.53e-05  2.68e-02    11s
  33   5.17922811e+04  5.93259080e+04  4.07e-03 6.43e-05  2.21e-02    11s
  34   5.28468895e+04  5.86691829e+04  3.19e-03 4.69e-05  1.71e-02    11s
  35   5.36086415e+04  5.84075051e+04  2.57e-03 3.96e-05  1.41e-02    11s
  36   5.38623347e+04  5.79285722e+04  2.36e-03 8.88e-05  1.19e-02    11s
  37   5.40779512e+04  5.78208284e+04  2.19e-03 8.00e-05  1.10e-02    11s
  38   5.45166140e+04  5.77358805e+04  1.85e-03 7.21e-05  9.44e-03    11s
  39   5.47945184e+04  5.76997787e+04  1.64e-03 6.85e-05  8.52e-03    12s
  40   5.52675032e+04  5.74753132e+04  1.28e-03 4.77e-05  6.48e-03    12s
  41   5.55590762e+04  5.73897289e+04  1.05e-03 3.96e-05  5.37e-03    12s
  42   5.57965852e+04  5.72615135e+04  8.73e-04 2.78e-05  4.30e-03    12s
  43   5.60578899e+04  5.72178131e+04  6.76e-04 2.37e-05  3.40e-03    12s
  44   5.62557212e+04  5.71228292e+04  5.28e-04 1.45e-05  2.54e-03    12s
  45   5.64617845e+04  5.71156286e+04  3.75e-04 1.37e-05  1.92e-03    12s
  46   5.66559166e+04  5.70542900e+04  2.33e-04 9.00e-06  1.17e-03    12s
  47   5.67676019e+04  5.70269772e+04  1.52e-04 4.72e-06  7.61e-04    13s
  48   5.68579955e+04  5.70117879e+04  8.54e-05 4.29e-06  4.51e-04    13s
  49   5.68601944e+04  5.70066771e+04  8.38e-05 3.25e-06  4.30e-04    13s
  50   5.68786449e+04  5.70023442e+04  7.15e-05 2.47e-06  3.63e-04    13s
  51   5.69234795e+04  5.69944798e+04  4.16e-05 1.05e-06  2.08e-04    13s
  52   5.69779200e+04  5.69901218e+04  6.40e-06 3.94e-06  3.58e-05    13s
  53   5.69814465e+04  5.69887865e+04  4.20e-06 2.91e-07  2.15e-05    13s
  54   5.69879152e+04  5.69886993e+04  2.49e-07 2.59e-09  2.30e-06    13s
  55   5.69885080e+04  5.69885332e+04  5.41e-08 5.63e-09  7.38e-08    13s
  56   5.69885267e+04  5.69885267e+04  1.94e-09 4.94e-11  1.50e-11    13s

Barrier solved model in 56 iterations and 13.41 seconds (20.21 work units)
Optimal objective 5.69885267e+04


Root crossover log...

  165868 DPushes remaining with DInf 0.0000000e+00                13s
   32633 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    2628 PPushes remaining with PInf 8.0590215e-06                18s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.3541100e-10     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69223    5.6988527e+04   0.000000e+00   0.000000e+00     18s
   69223    5.6988527e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.698853e+04, 69223 iterations, 13.00 seconds (23.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56988.5267    0  166 -197770.01 56988.5267   129%     -   18s
H    0     0                    -138759.7965 56988.5267   141%     -   19s
H    0     0                    -128004.8649 56988.5267   145%     -   19s
H    0     0                    -122946.9802 56988.5267   146%     -   19s
H    0     0                    -122686.5500 56988.5267   146%     -   19s
H    0     0                    -60535.07754 56988.5267   194%     -   19s
H    0     0                    12828.839447 56988.5267   344%     -   20s
H    0     0                    13713.552036 56988.5267   316%     -   21s
     0     0 49842.9918    0  234 13713.5520 49842.9918   263%     -   89s
H    0     0                    16499.944031 49842.9736   202%     -   90s
H    0     0                    18534.462113 49842.9736   169%     -   90s
H    0     0                    18872.701259 49842.9736   164%     -   90s
     0     0 49383.4065    0  244 18872.7013 49383.4065   162%     -  126s
     0     0 48946.2097    0  249 18872.7013 48946.2097   159%     -  153s
     0     0 48879.4959    0  249 18872.7013 48879.4959   159%     -  171s
     0     0 48854.8689    0  249 18872.7013 48854.8689   159%     -  182s
     0     0 48645.5566    0  257 18872.7013 48645.5566   158%     -  207s
     0     0 48611.9610    0  261 18872.7013 48611.9610   158%     -  215s
     0     0 48597.1652    0  262 18872.7013 48597.1652   157%     -  222s
     0     0 48591.4127    0  266 18872.7013 48591.4127   157%     -  224s
     0     0 48591.2814    0  264 18872.7013 48591.2814   157%     -  225s
     0     0 46128.5184    0  369 18872.7013 46128.5184   144%     -  301s
H    0     0                    22502.148567 46128.5146   105%     -  302s
H    0     0                    23090.628310 46128.5146   100%     -  302s
H    0     0                    23134.585315 46128.5146  99.4%     -  302s
H    0     0                    23510.581140 46128.5146  96.2%     -  302s
     0     0 45532.7577    0  385 23510.5811 45532.7577  93.7%     -  354s
     0     0 45270.7344    0  399 23510.5811 45270.7344  92.6%     -  381s
     0     0 45242.4594    0  395 23510.5811 45242.4594  92.4%     -  394s
     0     0 45070.5462    0  366 23510.5811 45070.5462  91.7%     -  420s
     0     0 45024.5384    0  395 23510.5811 45024.5384  91.5%     -  434s
     0     0 44998.2525    0  391 23510.5811 44998.2525  91.4%     -  444s
     0     0 44972.9510    0  389 23510.5811 44972.9510  91.3%     -  453s
     0     0 44963.1631    0  392 23510.5811 44963.1631  91.2%     -  459s
     0     0 44878.3909    0  391 23510.5811 44878.3909  90.9%     -  478s
     0     0 44865.6340    0  399 23510.5811 44865.6340  90.8%     -  486s
     0     0 44863.4579    0  392 23510.5811 44863.4579  90.8%     -  490s
     0     0 44860.7023    0  392 23510.5811 44860.7023  90.8%     -  491s
     0     0 44796.5778    0  388 23510.5811 44796.5778  90.5%     -  504s
     0     0 44774.2248    0  400 23510.5811 44774.2248  90.4%     -  514s
     0     0 44761.4776    0  402 23510.5811 44761.4776  90.4%     -  519s
     0     0 44761.3605    0  404 23510.5811 44761.3605  90.4%     -  521s
     0     0 42460.8527    0  359 23510.5811 42460.8527  80.6%     -  624s
     0     0 42100.4110    0  387 23510.5811 42100.4110  79.1%     -  653s
     0     0 41761.9911    0  453 23510.5811 41761.9911  77.6%     -  687s
     0     0 41683.2621    0  360 23510.5811 41683.2621  77.3%     -  708s
     0     0 41635.2084    0  365 23510.5811 41635.2084  77.1%     -  723s
     0     0 41585.7681    0  371 23510.5811 41585.7681  76.9%     -  739s
     0     0 41567.4341    0  425 23510.5811 41567.4341  76.8%     -  748s
     0     0 41537.6802    0  424 23510.5811 41537.6802  76.7%     -  762s
     0     0 41523.7445    0  428 23510.5811 41523.7445  76.6%     -  774s
     0     0 41469.3681    0  420 23510.5811 41469.3681  76.4%     -  791s
     0     0 41458.7711    0  423 23510.5811 41458.7711  76.3%     -  799s
     0     0 41405.8231    0  448 23510.5811 41405.8231  76.1%     -  812s
     0     0 41400.0869    0  461 23510.5811 41400.0869  76.1%     -  819s
     0     0 41383.8203    0  418 23510.5811 41383.8203  76.0%     -  825s
     0     0 41329.2418    0  427 23510.5811 41329.2418  75.8%     -  839s
     0     0 41311.4540    0  424 23510.5811 41311.4540  75.7%     -  849s
     0     0 41283.3508    0  436 23510.5811 41283.3508  75.6%     -  860s
     0     0 41268.5341    0  438 23510.5811 41268.5341  75.5%     -  867s
     0     0 41247.2596    0  436 23510.5811 41247.2596  75.4%     -  875s
     0     0 41239.3132    0  441 23510.5811 41239.3132  75.4%     -  881s
     0     0 41231.4842    0  424 23510.5811 41231.4842  75.4%     -  886s
     0     0 41226.8174    0  441 23510.5811 41226.8174  75.4%     -  890s
     0     0 41225.9806    0  438 23510.5811 41225.9806  75.4%     -  891s
     0     0 40625.5995    0  378 23510.5811 40625.5995  72.8%     -  939s
H    0     0                    23562.304466 40625.2277  72.4%     -  939s
     0     0 40381.5550    0  452 23562.3045 40381.5550  71.4%     -  982s
     0     0 40301.9175    0  453 23562.3045 40301.9175  71.0%     - 1004s
     0     0 40168.2297    0  463 23562.3045 40168.2297  70.5%     - 1030s
     0     0 40120.4236    0  457 23562.3045 40120.4236  70.3%     - 1044s
     0     0 40112.5663    0  464 23562.3045 40112.5663  70.2%     - 1050s
     0     0 40103.4295    0  458 23562.3045 40103.4295  70.2%     - 1056s
     0     0 40027.5996    0  455 23562.3045 40027.5996  69.9%     - 1069s
     0     0 40008.4872    0  456 23562.3045 40008.4872  69.8%     - 1076s
     0     0 39984.8173    0  448 23562.3045 39984.8173  69.7%     - 1085s
     0     0 39977.2462    0  460 23562.3045 39977.2462  69.7%     - 1091s
     0     0 39974.1751    0  462 23562.3045 39974.1751  69.7%     - 1094s
     0     0 39968.4254    0  461 23562.3045 39968.4254  69.6%     - 1097s
     0     0 39964.0045    0  453 23562.3045 39964.0045  69.6%     - 1101s
     0     0 39961.0860    0  453 23562.3045 39961.0860  69.6%     - 1104s
     0     0 39949.5558    0  455 23562.3045 39949.5558  69.5%     - 1110s
     0     0 39947.4395    0  455 23562.3045 39947.4395  69.5%     - 1112s
     0     0 39773.7455    0  490 23562.3045 39773.7455  68.8%     - 1142s
     0     0 39730.4995    0  434 23562.3045 39730.4995  68.6%     - 1163s
     0     0 39722.9693    0  430 23562.3045 39722.9693  68.6%     - 1171s
     0     0 39717.9405    0  439 23562.3045 39717.9405  68.6%     - 1176s
     0     0 39714.7272    0  442 23562.3045 39714.7272  68.6%     - 1180s
     0     0 39712.3629    0  439 23562.3045 39712.3629  68.5%     - 1182s
     0     0 39606.8425    0  487 23562.3045 39606.8425  68.1%     - 1216s
H    0     0                    25268.691973 39606.8293  56.7%     - 1224s
     0     0 39575.6751    0  498 25268.6920 39575.6751  56.6%     - 1244s
     0     0 39556.1413    0  493 25268.6920 39556.1413  56.5%     - 1259s
     0     0 39549.0009    0  496 25268.6920 39549.0009  56.5%     - 1267s
     0     0 39543.2151    0  503 25268.6920 39543.2151  56.5%     - 1272s
     0     0 39542.7592    0  502 25268.6920 39542.7592  56.5%     - 1274s
     0     0 39477.9409    0  434 25268.6920 39477.9409  56.2%     - 1298s
     0     0 39467.9164    0  443 25268.6920 39467.9164  56.2%     - 1309s
     0     0 39461.7341    0  384 25268.6920 39461.7341  56.2%     - 1315s
     0     0 39459.5205    0  444 25268.6920 39459.5205  56.2%     - 1317s
     0     0 39426.5176    0  439 25268.6920 39426.5176  56.0%     - 1332s
     0     0 39403.2184    0  445 25268.6920 39403.2184  55.9%     - 1343s
     0     0 39397.5741    0  449 25268.6920 39397.5741  55.9%     - 1350s
     0     0 39394.5313    0  447 25268.6920 39394.5313  55.9%     - 1355s
     0     0 39391.9597    0  449 25268.6920 39391.9597  55.9%     - 1358s
     0     0 39388.8126    0  448 25268.6920 39388.8126  55.9%     - 1362s
     0     0 39388.1439    0  448 25268.6920 39388.1439  55.9%     - 1365s
     0     0 39369.6984    0  448 25268.6920 39369.6984  55.8%     - 1383s
     0     0 39360.8167    0  457 25268.6920 39360.8167  55.8%     - 1395s
     0     0 39356.2791    0  473 25268.6920 39356.2791  55.8%     - 1403s
     0     0 39354.4845    0  512 25268.6920 39354.4845  55.7%     - 1413s
     0     0 39329.5617    0  428 25268.6920 39329.5617  55.6%     - 1433s
     0     0 39323.6985    0  461 25268.6920 39323.6985  55.6%     - 1448s
     0     0 39321.0610    0  449 25268.6920 39321.0610  55.6%     - 1453s
     0     0 39316.4658    0  499 25268.6920 39316.4658  55.6%     - 1460s
     0     0 39314.4951    0  454 25268.6920 39314.4951  55.6%     - 1466s
     0     0 39303.3223    0  437 25268.6920 39303.3223  55.5%     - 1479s
     0     0 39298.5106    0  455 25268.6920 39298.5106  55.5%     - 1489s
     0     0 39297.1905    0  456 25268.6920 39297.1905  55.5%     - 1493s
     0     0 39281.3313    0  453 25268.6920 39281.3313  55.5%     - 1507s
H    0     0                    25315.809210 39281.0023  55.2%     - 1541s
H    0     0                    25382.110933 39281.0023  54.8%     - 1553s
     0     0 39275.3709    0  459 25382.1109 39275.3709  54.7%     - 1561s
     0     0 39274.3096    0  457 25382.1109 39274.3096  54.7%     - 1565s
     0     0 39267.6919    0  450 25382.1109 39267.6919  54.7%     - 1576s
     0     0 39266.5717    0  447 25382.1109 39266.5717  54.7%     - 1581s
     0     0 39261.9727    0  441 25382.1109 39261.9727  54.7%     - 1590s
     0     0 39261.6038    0  441 25382.1109 39261.6038  54.7%     - 1599s
H    0     0                    25688.066317 39261.4475  52.8%     - 1929s
H    0     2                    25921.849930 39261.4475  51.5%     - 2334s
     0     2 39261.4475    0  441 25921.8499 39261.4475  51.5%     - 2334s
     1     4 39202.7386    1  433 25921.8499 39261.4475  51.5%  9081 2360s
     3     8 38968.1934    2  424 25921.8499 39202.7370  51.2% 14151 2420s
     7    16 38763.1879    3  414 25921.8499 38965.9086  50.3% 23764 2456s
    15    32 38294.8814    4  404 25921.8499 38859.3677  49.9% 22087 2518s
    31    48 36020.8396    5  389 25921.8499 38425.2754  48.2% 32085 2805s
    47    80 35415.0649    6  397 25921.8499 38425.2754  48.2% 34313 2886s
    79   180 35256.5178    7  342 25921.8499 38425.2754  48.2% 27595 2966s
   179   261 35052.3178   10  328 25921.8499 38425.2754  48.2% 17090 3012s
H  206   261                    26015.523103 38425.2754  47.7% 15667 3012s
   260   334 34949.3304   10  334 26015.5231 38425.2754  47.7% 13943 3052s
   333   386 35174.6566    9  367 26015.5231 38425.2754  47.7% 12567 3088s
   385   434 34415.2451   15  285 26015.5231 38425.2754  47.7% 11841 3124s
   433   481 34342.1391   16  284 26015.5231 38425.2754  47.7% 11697 3159s
   480   512 33960.6899   17  287 26015.5231 38425.2754  47.7% 11453 3191s
   513   538 34899.3728   10  370 26015.5231 38425.2754  47.7% 11419 3224s
   541   568 34803.4290   11  368 26015.5231 38425.2754  47.7% 12045 3257s
   571   602 30418.2849   29  242 26015.5231 38425.2754  47.7% 12164 3293s
   615   649 29852.3344   31  244 26015.5231 38425.2754  47.7% 12122 3329s
   689   683 28193.0563   35  294 26015.5231 38425.2754  47.7% 11813 3360s
   760   690 32774.2179   13  249 26015.5231 38425.2754  47.7% 11494 3393s
   819   723 32185.6160   16  224 26015.5231 38425.2754  47.7% 11425 3426s
   876   792 31680.5494   18  204 26015.5231 38425.2754  47.7% 11397 3455s
   977   806 31299.2465   22  191 26015.5231 38425.2754  47.7% 10878 3486s
  1048   802 29626.2836   24  189 26015.5231 38425.2754  47.7% 10669 3521s
  1120   862 29468.2875   25  179 26015.5231 38425.2754  47.7% 10404 3554s
  1210   916 28720.4902   33  141 26015.5231 38425.2754  47.7% 10184 3587s
  1315   987 27829.9463   37  125 26015.5231 38425.2754  47.7%  9836 3600s

Cutting planes:
  Learned: 4
  Gomory: 4
  Implied bound: 256
  MIR: 4696
  Flow cover: 4087
  RLT: 61
  Relax-and-lift: 767

Explored 1408 nodes (14338223 simplex iterations) in 3600.09 seconds (9322.33 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26015.5 25921.8 25688.1 ... 23090.6

Time limit reached
Best objective 2.601552310323e+04, best bound 3.842527535856e+04, gap 47.7013%
  WARNING: Time limit reached. Using best solution found (gap: 47.70%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 26015.52, θ = 177473.90
  Upper Bound (UB) = 26015.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 177473.90
  [DEBUG]   ✓ Scenario 0: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 177473.90 ≤ Q = 177473.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 177473.90 ≤ Q = 177473.90 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7ea6ccce
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x81593332
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.408386e+13
Presolve removed 2605 rows and 1897 columns
Presolve time: 0.00s
Presolved: 488 rows, 492 columns, 1376 nonzeros
Found heuristic solution: objective 6588868.4134
Variable types: 334 continuous, 158 integer (158 binary)

Root relaxation: objective -1.628516e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162851.60    0  123 6588868.41 -162851.60   102%     -    0s
H    0     0                    -130051.2349 -162851.60  25.2%     -    0s
     0     0 -133835.58    0   81 -130051.23 -133835.58  2.91%     -    0s
H    0     0                    -131167.5249 -133832.55  2.03%     -    0s
H    0     0                    -132007.4297 -133832.55  1.38%     -    0s
     0     0 -133527.29    0   65 -132007.43 -133527.29  1.15%     -    0s
     0     0 -133491.07    0   66 -132007.43 -133491.07  1.12%     -    0s
H    0     0                    -132318.9210 -133491.07  0.89%     -    0s
     0     0 -133311.50    0   80 -132318.92 -133311.50  0.75%     -    0s
     0     0 -133294.23    0   80 -132318.92 -133294.23  0.74%     -    0s
H    0     0                    -132876.9591 -133294.23  0.31%     -    0s
H    0     0                    -132889.8778 -133294.23  0.30%     -    0s
     0     2 -133294.23    0   80 -132889.88 -133294.23  0.30%     -    0s
*   57     0              18    -132904.0667 -132904.07  0.00%   5.7    0s

Cutting planes:
  Gomory: 7
  MIR: 164

Explored 58 nodes (779 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -132904 -132890 -132877 ... 1.40839e+13
No other solutions better than -132904

Optimal solution found (tolerance 1.00e-04)
Best objective -1.329040666948e+05, best bound -1.329040666948e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 176841.79
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132904.07
  [DEBUG]   S×d_nominal = 309745.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 309745.86 + -132904.07 = 176841.79
  [DEBUG]   Current θ from Master = 177473.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 632.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25383.42
  Lower Bound (LB) = 25960.37
  Gap (UB-LB) = 55.1535, Absolute Gap = 55.1535, Relative Gap = 0.002120
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 23
Total Time: 64294.06s
Converged: True
Final Lower Bound: 25960.3696
Final Upper Bound: 26015.5231
Final Gap: 55.153544
Number of Critical Scenarios: 23
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [4, 5, 8, 9] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 23
Start Time: 2026-01-04 12:30:56
End Time: 2026-01-05 06:22:31
Total Time: 64294.06s
Optimal Value: 25960.37
Lower Bound: 25960.37
Upper Bound: 26015.52
Gap: 55.153544
Plants Opened: {0: [0], 1: [0], 2: [1]} (3 plants)
DCs Opened: [4, 5, 8, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed10_HD_gamma20_20260105_062231.csv

Total Execution Time: 64294.54 seconds
End Time: 2026-01-05 06:22:31

All tasks completed successfully!

