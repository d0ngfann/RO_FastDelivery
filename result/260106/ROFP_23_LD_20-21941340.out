
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 23
DI Scenario: LD
Start Time: 2026-01-04 12:31:24
================================================================================
Loading data from data/DH_data_full_seed23.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.094', '1.197'] (k=0.222)
  Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
  Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=957, max=1788
  DC capacity (MC): min=424, max=888

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.22, max=34.68, count=82
  Deviation (μ̂): min=4.01, max=9.75

Costs:
  Plant fixed cost: min=5308, max=9514
  DC fixed cost: min=3659, max=5984
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.427', '2.036'] (k=0.877)
    Product 2: ['1.000', '1.404', '1.970'] (k=0.836)
  MD:
    Product 0: ['1.000', '1.153', '1.329'] (k=0.351)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.264', '1.598'] (k=0.578)
  LD:
    Product 0: ['1.000', '1.094', '1.197'] (k=0.222)
    Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
  Mixed:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0x6c1ea4a2
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.14s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -331776.6185
Found heuristic solution: objective -188519.7825

Root relaxation: objective 6.359343e+04, 4832 iterations, 0.32 seconds (0.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 63593.4285    0  727 -188519.78 63593.4285   134%     -    0s
H    0     0                    -142995.7498 63593.4285   144%     -    0s
H    0     0                    -129086.4934 58093.8804   145%     -    1s
     0     0 58093.8804    0  788 -129086.49 58093.8804   145%     -    1s
     0     0 58029.3947    0  905 -129086.49 58029.3947   145%     -    2s
     0     0 58027.3769    0  907 -129086.49 58027.3769   145%     -    2s
     0     0 58027.3379    0  907 -129086.49 58027.3379   145%     -    2s
     0     0 55177.0535    0 1152 -129086.49 55177.0535   143%     -    4s
     0     0 54979.1444    0 1177 -129086.49 54979.1444   143%     -    4s
     0     0 54947.1196    0 1174 -129086.49 54947.1196   143%     -    4s
     0     0 54943.3159    0 1192 -129086.49 54943.3159   143%     -    4s
     0     0 54942.5955    0 1192 -129086.49 54942.5955   143%     -    4s
     0     0 52666.9844    0 1052 -129086.49 52666.9844   141%     -    7s
H    0     0                    -118052.1287 52665.7441   145%     -    7s
H    0     0                    -70513.48301 52498.4849   174%     -    8s
H    0     0                    -18057.56887 52498.4849   391%     -    8s
H    0     0                    -17998.96415 52498.4849   392%     -    8s
H    0     0                    -17976.11599 52498.4849   392%     -    8s
     0     0 52498.4849    0 1140 -17976.116 52498.4849   392%     -    8s
     0     0 52471.9773    0 1060 -17976.116 52471.9773   392%     -    8s
     0     0 52468.2482    0 1060 -17976.116 52468.2482   392%     -    8s
H    0     0                    -17876.11006 50308.7368   381%     -   11s
H    0     0                    -17829.96594 50308.7368   382%     -   11s
H    0     0                    -17772.89152 50308.7368   383%     -   11s
H    0     0                    -17717.10766 50308.7368   384%     -   11s
H    0     0                    -17678.36556 50308.7368   385%     -   11s
H    0     0                    -17661.31690 50308.7368   385%     -   11s
H    0     0                    -17647.02050 50308.7368   385%     -   11s
H    0     0                    -17420.13328 50308.7368   389%     -   11s
H    0     0                    -17368.98278 50308.7368   390%     -   11s
H    0     0                    -17224.75631 50308.7368   392%     -   11s
H    0     0                    -17160.43127 50308.7368   393%     -   11s
H    0     0                    -17149.14575 50308.7368   393%     -   11s
H    0     0                    -17088.20939 50308.7368   394%     -   11s
H    0     0                    -12230.90278 50308.7368   511%     -   11s
     0     0 50308.7368    0 1319 -12230.903 50308.7368   511%     -   11s
     0     0 50025.4923    0 1344 -12230.903 50025.4923   509%     -   12s
     0     0 49979.1817    0 1344 -12230.903 49979.1817   509%     -   13s
     0     0 49972.2613    0 1360 -12230.903 49972.2613   509%     -   13s
     0     0 49970.6182    0 1371 -12230.903 49970.6182   509%     -   13s
H    0     0                    6321.5035934 48441.7650   666%     -   16s
H    0     0                    6332.8525685 48441.7650   665%     -   16s
H    0     0                    7398.8771679 48441.7650   555%     -   16s
H    0     0                    8065.3217011 48441.7650   501%     -   16s
H    0     0                    8096.6026456 48441.7650   498%     -   16s
H    0     0                    8100.5679689 48441.7650   498%     -   16s
H    0     0                    8152.6624507 48441.7650   494%     -   16s
H    0     0                    8159.3728928 48441.7650   494%     -   16s
H    0     0                    8161.2514529 48441.7650   494%     -   16s
H    0     0                    8205.5177929 48441.7650   490%     -   16s
H    0     0                    8221.5097703 48441.7650   489%     -   16s
H    0     0                    8223.3883304 48441.7650   489%     -   16s
H    0     0                    8249.2775488 48441.7650   487%     -   16s
H    0     0                    8249.3452086 48441.7650   487%     -   16s
     0     0 48441.7650    0 1221 8249.34521 48441.7650   487%     -   16s
H    0     0                    8627.6153792 48212.9469   459%     -   17s
H    0     0                    8685.6423464 48212.9469   455%     -   17s
H    0     0                    8884.9860730 48212.9469   443%     -   17s
     0     0 48212.9469    0 1301 8884.98607 48212.9469   443%     -   17s
     0     0 48178.2131    0 1309 8884.98607 48178.2131   442%     -   18s
     0     0 48171.2192    0 1304 8884.98607 48171.2192   442%     -   18s
     0     0 47110.2391    0 1260 8884.98607 47110.2391   430%     -   21s
     0     0 46965.6418    0 1436 8884.98607 46965.6418   429%     -   22s
     0     0 46935.2452    0 1443 8884.98607 46935.2452   428%     -   23s
     0     0 46930.2136    0 1442 8884.98607 46930.2136   428%     -   23s
H    0     0                    8886.8646330 45919.1057   417%     -   26s
     0     0 45919.1057    0 1187 8886.86463 45919.1057   417%     -   26s
H    0     0                    8941.9274145 45726.5916   411%     -   27s
H    0     0                    8962.8863018 45726.5916   410%     -   27s
     0     0 45726.5916    0 1332 8962.88630 45726.5916   410%     -   27s
     0     0 45685.8448    0 1339 8962.88630 45685.8448   410%     -   28s
     0     0 45674.5982    0 1357 8962.88630 45674.5982   410%     -   28s
H    0     0                    8963.0108257 45091.6699   403%     -   31s
     0     0 45091.6699    0 1375 8963.01083 45091.6699   403%     -   31s
     0     0 44942.9589    0 1419 8963.01083 44942.9589   401%     -   33s
H    0     0                    8973.2639210 44907.8117   400%     -   34s
     0     0 44907.8117    0 1444 8973.26392 44907.8117   400%     -   34s
     0     0 44896.5192    0 1450 8973.26392 44896.5192   400%     -   34s
H    0     0                    9044.1081555 44429.9624   391%     -   36s
H    0     0                    10149.910298 44429.9624   338%     -   37s
H    0     0                    14737.005523 44429.9624   201%     -   37s
H    0     0                    14745.775138 44429.9624   201%     -   37s
H    0     0                    14859.977293 44429.9624   199%     -   37s
H    0     0                    14933.659969 44429.9624   198%     -   37s
H    0     0                    14942.759547 44429.9624   197%     -   37s
H    0     0                    14945.289568 44429.9624   197%     -   37s
H    0     0                    14958.898484 44429.9624   197%     -   37s
H    0     0                    14965.964407 44429.9624   197%     -   37s
H    0     0                    14970.252352 44429.9624   197%     -   37s
     0     0 44429.9624    0 1024 14970.2524 44429.9624   197%     -   37s
H    0     0                    15069.484355 44349.8527   194%     -   38s
H    0     0                    15076.550277 44349.8527   194%     -   38s
H    0     0                    15906.408751 44349.8527   179%     -   38s
H    0     0                    17444.775774 44349.8527   154%     -   38s
H    0     0                    18380.559073 44349.8527   141%     -   38s
H    0     0                    18496.762589 44349.8527   140%     -   38s
     0     0 44349.8527    0 1396 18496.7626 44349.8527   140%     -   38s
     0     0 44320.1200    0 1042 18496.7626 44320.1200   140%     -   39s
     0     0 44312.0673    0 1137 18496.7626 44312.0673   140%     -   40s
H    0     0                    18521.121751 43964.3208   137%     -   42s
     0     0 43964.3208    0 1359 18521.1218 43964.3208   137%     -   42s
H    0     0                    18523.480611 43844.4326   137%     -   44s
     0     0 43844.4326    0 1406 18523.4806 43844.4326   137%     -   44s
     0     0 43825.7500    0 1414 18523.4806 43825.7500   137%     -   44s
     0     0 43491.2538    0 1366 18523.4806 43491.2538   135%     -   47s
     0     0 43421.6601    0 1362 18523.4806 43421.6601   134%     -   49s
     0     0 43399.1071    0 1372 18523.4806 43399.1071   134%     -   50s
     0     0 43393.4041    0 1394 18523.4806 43393.4041   134%     -   50s
     0     0 43102.5130    0 1341 18523.4806 43102.5130   133%     -   53s
     0     0 43018.7616    0 1368 18523.4806 43018.7616   132%     -   54s
     0     0 43004.9924    0 1363 18523.4806 43004.9924   132%     -   55s
     0     0 42410.1135    0 1272 18523.4806 42410.1135   129%     -   59s
     0     0 42231.2116    0 1339 18523.4806 42231.2116   128%     -   61s
     0     0 42184.5855    0 1368 18523.4806 42184.5855   128%     -   62s
     0     0 42169.3783    0 1362 18523.4806 42169.3783   128%     -   62s
     0     0 40882.9257    0 1288 18523.4806 40882.9257   121%     -   66s
     0     0 40595.4606    0 1330 18523.4806 40595.4606   119%     -   69s
     0     0 40538.8459    0 1340 18523.4806 40538.8459   119%     -   70s
     0     0 40518.1350    0 1366 18523.4806 40518.1350   119%     -   70s
     0     0 40023.7973    0 1246 18523.4806 40023.7973   116%     -   74s
     0     0 39886.7482    0 1290 18523.4806 39886.7482   115%     -   75s
     0     0 39862.2090    0 1317 18523.4806 39862.2090   115%     -   76s
     0     0 39371.8990    0 1325 18523.4806 39371.8990   113%     -   79s
     0     0 39225.5813    0 1346 18523.4806 39225.5813   112%     -   81s
     0     0 39198.7013    0 1368 18523.4806 39198.7013   112%     -   82s
     0     0 38897.6789    0 1318 18523.4806 38897.6789   110%     -   85s
     0     0 38838.8341    0 1340 18523.4806 38838.8341   110%     -   86s
     0     0 38821.7081    0 1359 18523.4806 38821.7081   110%     -   87s
     0     0 38471.8750    0 1363 18523.4806 38471.8750   108%     -   90s
     0     0 38374.0768    0 1364 18523.4806 38374.0768   107%     -   92s
     0     0 38346.6231    0 1372 18523.4806 38346.6231   107%     -   92s
     0     0 37946.2821    0 1333 18523.4806 37946.2821   105%     -   95s
     0     0 37811.0042    0 1324 18523.4806 37811.0042   104%     -   97s
     0     0 37772.0164    0 1336 18523.4806 37772.0164   104%     -   98s
     0     0 37764.7406    0 1344 18523.4806 37764.7406   104%     -   98s
     0     0 37545.7649    0 1319 18523.4806 37545.7649   103%     -  101s
     0     0 37459.0650    0 1375 18523.4806 37459.0650   102%     -  102s
     0     0 37439.2417    0 1350 18523.4806 37439.2417   102%     -  103s
     0     0 37277.4515    0 1310 18523.4806 37277.4515   101%     -  106s
     0     0 37277.4132    0 1310 18523.4806 37277.4132   101%     -  106s
     0     2 37277.3751    0 1310 18523.4806 37277.3751   101%     -  111s
     3     6 36257.1682    2  951 18523.4806 37104.2876   100%  9085  121s
    25    48 31728.7773    5  660 18523.4806 34649.7033  87.1%  4250  127s
    81   140 28987.0143    7  526 18523.4806 32366.6137  74.7%  4000  130s
   435   291 19442.0347   19  198 18523.4806 32362.2857  74.7%  1215  135s
   822   455 22338.8446   10  272 18523.4806 29019.4561  56.7%   858  140s
  1323   848 20118.2616   15  169 18523.4806 28968.1679  56.4%   642  145s
  1767   888 20701.6778   14  180 18523.4806 27819.7732  50.2%   568  151s
  2307  1094     cutoff   19      18523.4806 27313.7730  47.5%   552  156s
  2815  1127 18822.3618   31   71 18523.4806 27064.2194  46.1%   504  160s
  3815  1084 20536.1756   17  337 18523.4806 26836.5420  44.9%   469  166s
  4536  1034 infeasible   14      18523.4806 24153.5875  30.4%   458  171s
  4978   946 21555.9981   21  168 18523.4806 23526.5367  27.0%   457  175s
  6190   583 infeasible   27      18523.4806 21820.0285  17.8%   445  181s

Cutting planes:
  Gomory: 4
  Implied bound: 418
  MIR: 2813
  Flow cover: 1341
  Zero half: 22
  RLT: 70
  Relax-and-lift: 995

Explored 7542 nodes (3158106 simplex iterations) in 183.25 seconds (239.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 18523.5 18521.1 18496.8 ... 14966

Optimal solution found (tolerance 1.00e-04)
Best objective 1.852348061118e+04, best bound 1.852348061118e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 183.27s
  Master Objective (UB) = 18523.48, θ = 147764.84
  Upper Bound (UB) = 18523.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147764.84
  [DEBUG]   ✓ Scenario 0: θ = 147764.84 ≤ Q = 147764.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x51696846
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xae9697ba
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.293836e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6650510.7190
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.221846e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122184.61    0  123 6650510.72 -122184.61   102%     -    0s
H    0     0                    -89346.05316 -122184.61  36.8%     -    0s
H    0     0                    -90060.03364 -122184.61  35.7%     -    0s
*    0     0               0    -91630.05848 -91630.058  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (380 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -91630.1 -90060 -89346.1 ... 1.29384e+13
No other solutions better than -91630.1

Optimal solution found (tolerance 1.00e-04)
Best objective -9.163005847817e+04, best bound -9.163005847817e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 115604.81
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91630.06
  [DEBUG]   S×d_nominal = 207234.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 207234.87 + -91630.06 = 115604.81
  [DEBUG]   Current θ from Master = 147764.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32160.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13636.55
  Lower Bound (LB) = -13636.55
  Gap (UB-LB) = 32160.0276, Absolute Gap = 32160.0276, Relative Gap = 1.736176
  Not converged yet (gap = 32160.03 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0xaa7856bf
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -13636.5 (0.02s)
Loaded MIP start from previous solve with objective -13636.5

Presolve removed 13767 rows and 5586 columns
Presolve time: 0.50s
Presolved: 18196 rows, 9154 columns, 100768 nonzeros
Variable types: 6895 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.909656e+04, 9879 iterations, 2.26 seconds (3.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 19096.5570    0  345 -13636.547 19096.5570   240%     -    2s
H    0     0                    -12999.64082 19096.5570   247%     -    3s
H    0     0                    -12503.97125 19096.5570   253%     -    3s
     0     0 10457.4515    0  547 -12503.971 10457.4515   184%     -    5s
     0     0 10252.5187    0  550 -12503.971 10252.5187   182%     -    6s
     0     0 10149.6748    0  616 -12503.971 10149.6748   181%     -    6s
     0     0 10149.1362    0  616 -12503.971 10149.1362   181%     -    6s
     0     0 4944.79291    0  572 -12503.971 4944.79291   140%     -    9s
H    0     0                    -12478.90004 4942.46900   140%     -    9s
     0     0 4396.80993    0  552 -12478.900 4396.80993   135%     -   10s
     0     0 4328.73079    0  743 -12478.900 4328.73079   135%     -   10s
     0     0 4302.73528    0  747 -12478.900 4302.73528   134%     -   11s
     0     0 4296.75632    0  742 -12478.900 4296.75632   134%     -   11s
     0     0 4296.54849    0  747 -12478.900 4296.54849   134%     -   11s
     0     0 1639.61156    0  493 -12478.900 1639.61156   113%     -   15s
     0     0 1113.80747    0  647 -12478.900 1113.80747   109%     -   16s
     0     0 1078.79721    0  572 -12478.900 1078.79721   109%     -   16s
     0     0 1071.96367    0  569 -12478.900 1071.96367   109%     -   16s
     0     0 1071.83358    0  569 -12478.900 1071.83358   109%     -   16s
     0     0 -165.85291    0  589 -12478.900 -165.85291  98.7%     -   21s
     0     0 -507.58954    0  428 -12478.900 -507.58954  95.9%     -   22s
     0     0 -595.76885    0  510 -12478.900 -595.76885  95.2%     -   22s
     0     0 -634.00270    0  507 -12478.900 -634.00270  94.9%     -   23s
     0     0 -642.69264    0  585 -12478.900 -642.69264  94.8%     -   23s
     0     0 -643.79215    0  434 -12478.900 -643.79215  94.8%     -   23s
     0     0 -918.51974    0  687 -12478.900 -918.51974  92.6%     -   24s
     0     0 -1037.3508    0  687 -12478.900 -1037.3508  91.7%     -   25s
     0     0 -1075.4499    0  845 -12478.900 -1075.4499  91.4%     -   26s
     0     0 -1084.2837    0  778 -12478.900 -1084.2837  91.3%     -   26s
     0     0 -1085.7436    0  626 -12478.900 -1085.7436  91.3%     -   26s
     0     0 -1303.2710    0  572 -12478.900 -1303.2710  89.6%     -   28s
     0     0 -1366.2228    0  597 -12478.900 -1366.2228  89.1%     -   29s
     0     0 -1399.9170    0  572 -12478.900 -1399.9170  88.8%     -   29s
     0     0 -1414.0585    0  662 -12478.900 -1414.0585  88.7%     -   29s
     0     0 -1416.8984    0  664 -12478.900 -1416.8984  88.6%     -   30s
     0     0 -1508.7036    0  569 -12478.900 -1508.7036  87.9%     -   31s
     0     0 -1532.2955    0  646 -12478.900 -1532.2955  87.7%     -   31s
     0     0 -1537.0863    0  420 -12478.900 -1537.0863  87.7%     -   32s
     0     0 -1671.7956    0  644 -12478.900 -1671.7956  86.6%     -   33s
     0     0 -1706.2204    0  753 -12478.900 -1706.2204  86.3%     -   34s
     0     0 -1717.6676    0  757 -12478.900 -1717.6676  86.2%     -   34s
     0     0 -1720.7430    0  694 -12478.900 -1720.7430  86.2%     -   35s
     0     0 -1845.1953    0  411 -12478.900 -1845.1953  85.2%     -   36s
     0     0 -1855.5381    0  417 -12478.900 -1855.5381  85.1%     -   37s
     0     0 -1861.6785    0  495 -12478.900 -1861.6785  85.1%     -   37s
     0     0 -1885.4767    0  636 -12478.900 -1885.4767  84.9%     -   38s
     0     0 -1889.4732    0  653 -12478.900 -1889.4732  84.9%     -   38s
     0     0 -1898.8219    0  415 -12478.900 -1898.8219  84.8%     -   39s
     0     0 -1899.9800    0  415 -12478.900 -1899.9800  84.8%     -   40s
     0     2 -1899.9858    0  415 -12478.900 -1899.9858  84.8%     -   49s
     1     4 -3226.2255    1  664 -12478.900 -1899.9858  84.8%  3291   51s
     7    16 -3815.2459    3  655 -12478.900 -2415.5666  80.6%  1647   55s
    63    86 -6289.9480    6  544 -12478.900 -3849.9510  69.1%  1422   60s
   246   285 -10295.874   10  353 -12478.900 -4009.1805  67.9%   807   65s
   702   533 -11973.874   16  212 -12478.900 -4270.1181  65.8%   515   70s
  1004   689 -11067.319   12  201 -12478.900 -4270.1181  65.8%   444   75s
H 1578  1002                    -11952.74502 -4270.1181  64.3%   358   79s
  1681  1039     cutoff   22      -11952.745 -5192.7531  56.6%   350   80s
  2555  1462 -9084.9444   25  110 -11952.745 -6070.6936  49.2%   296   85s
H 2798  1485                    -10538.90489 -6505.0415  38.3%   282   86s
H 2806  1485                    -10332.87676 -6505.0415  37.0%   282   86s
H 2824  1485                    -10285.76331 -6505.0415  36.8%   282   86s
  3449  1501     cutoff   21      -10285.763 -6604.5423  35.8%   271   90s
  4013  1503     cutoff   26      -10285.763 -7674.8943  25.4%   263   96s
H 4017  1503                    -10284.57000 -7674.8943  25.4%   262   96s
H 4018  1503                    -10269.00633 -7674.8943  25.3%   262   96s
H 4035  1503                    -10260.42536 -7674.8943  25.2%   262   96s
  4643  1374 -9060.0914    8  214 -10260.425 -8297.4253  19.1%   255  100s
  7161  1609     cutoff   41      -10260.425 -9471.3942  7.69%   204  105s
 13991   627     cutoff   30      -10260.425 -9958.3991  2.94%   124  110s
H16391   724                    -10242.20651 -10097.679  1.41%   109  111s
*16556   724              58    -10241.81923 -10097.679  1.41%   108  111s
*16693   724              51    -10222.56173 -10100.491  1.19%   108  111s
*18795     0              56    -10220.79514 -10178.133  0.42%  97.4  112s
*18867     0              54    -10220.09826 -10178.133  0.41%  97.1  112s

Cutting planes:
  Gomory: 7
  MIR: 1802
  Flow cover: 1094
  Inf proof: 2
  RLT: 91
  Relax-and-lift: 469

Explored 19118 nodes (1879677 simplex iterations) in 112.54 seconds (173.29 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -10220.1 -10220.8 -10222.6 ... -10332.9
No other solutions better than -10220.1

Optimal solution found (tolerance 1.00e-04)
Best objective -1.022009825772e+04, best bound -1.022009825772e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 112.57s
  Master Objective (UB) = -10220.10, θ = 115353.28
  Upper Bound (UB) = -10220.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115353.28
  [DEBUG]   ✓ Scenario 0: θ = 115353.28 ≤ Q = 115353.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115353.28 ≤ Q = 115353.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x208638e0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x208638e0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.146828e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.01s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 5882828.1625
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.251200e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -125119.99    0  124 5882828.16 -125119.99   102%     -    0s
H    0     0                    -91638.90687 -125119.99  36.5%     -    0s
H    0     0                    -92555.48361 -125119.99  35.2%     -    0s
H    0     0                    -99607.74669 -125119.99  25.6%     -    0s
H    0     0                    -102081.4973 -112512.30  10.2%     -    0s
H    0     0                    -105458.9164 -112512.30  6.69%     -    0s
     0     0 -112512.30    0   89 -105458.92 -112512.30  6.69%     -    0s
H    0     0                    -110516.1530 -112462.54  1.76%     -    0s
H    0     0                    -110532.1520 -112462.54  1.75%     -    0s
     0     0 -112351.32    0   88 -110532.15 -112351.32  1.65%     -    0s
     0     0 -112345.03    0   88 -110532.15 -112345.03  1.64%     -    0s
H    0     0                    -111206.7623 -112345.03  1.02%     -    0s
H    0     0                    -111222.7613 -112345.03  1.01%     -    0s
     0     0 -112103.11    0   76 -111222.76 -112103.11  0.79%     -    0s
H    0     0                    -111531.1614 -112075.51  0.49%     -    0s
     0     0 -112012.29    0   70 -111531.16 -112012.29  0.43%     -    0s
     0     0 -111975.30    0   55 -111531.16 -111975.30  0.40%     -    0s
     0     0 -111959.51    0   58 -111531.16 -111959.51  0.38%     -    0s
     0     0 -111957.06    0   61 -111531.16 -111957.06  0.38%     -    0s
     0     0 -111762.23    0   27 -111531.16 -111762.23  0.21%     -    0s
     0     0 -111757.25    0   23 -111531.16 -111757.25  0.20%     -    0s
     0     0 -111700.80    0   24 -111531.16 -111700.80  0.15%     -    0s
     0     0 -111695.61    0   20 -111531.16 -111695.61  0.15%     -    0s
     0     0 -111630.61    0   12 -111531.16 -111630.61  0.09%     -    0s
     0     0 -111630.61    0   14 -111531.16 -111630.61  0.09%     -    0s
     0     0 -111560.36    0   11 -111531.16 -111560.36  0.03%     -    0s
H    0     0                    -111556.1192 -111557.69  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 3
  MIR: 3
  Flow cover: 7

Explored 1 nodes (849 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -111556 -111531 -111442 ... -91638.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.115561191574e+05, best bound -1.115576850281e+05, gap 0.0014%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 92297.47
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111556.12
  [DEBUG]   S×d_nominal = 203853.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 203853.59 + -111556.12 = 92297.47
  [DEBUG]   Current θ from Master = 115353.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23055.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33275.90
  Lower Bound (LB) = -13636.55
  Gap (UB-LB) = 3416.4487, Absolute Gap = 3416.4487, Relative Gap = 0.334287
  Not converged yet (gap = 3416.45 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0x9020307b
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -33275.9 (0.03s)
MIP start from previous solve produced solution with objective -33275.9 (0.03s)
Loaded MIP start from previous solve with objective -33275.9

Presolve removed 20624 rows and 8374 columns
Presolve time: 0.68s
Presolved: 26629 rows, 12606 columns, 163799 nonzeros
Variable types: 10347 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24877    3.3902181e+03   0.000000e+00   4.857793e+06      5s
Concurrent spin time: 0.10s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   17035    8.0573459e+03   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 8.057346e+03, 17035 iterations, 5.51 seconds (7.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8057.34594    0  201 -33275.902 8057.34594   124%     -    6s
H    0     0                    -32471.39224 8057.34594   125%     -    6s
H    0     0                    -30452.61417 8057.34594   126%     -    6s
H    0     0                    -29838.29207 8057.34594   127%     -    6s
H    0     0                    -29740.25786 8057.34594   127%     -    6s
H    0     0                    -29193.77657 8057.34594   128%     -    6s
H    0     0                    -29185.68952 8057.34594   128%     -    6s
H    0     0                    -28716.98526 8057.34594   128%     -    6s
H    0     0                    -28711.96628 8057.34594   128%     -    6s
H    0     0                    -28708.13824 8057.34594   128%     -    6s
H    0     0                    -23603.33947 8057.34594   134%     -    8s
H    0     0                    -16628.97930 3789.38116   123%     -   11s
     0     0 3446.30917    0  260 -16628.979 3446.30917   121%     -   11s
H    0     0                    -16389.66338 3446.30917   121%     -   11s
H    0     0                    -16287.97309 3446.30917   121%     -   11s
H    0     0                    -16193.63942 3446.30917   121%     -   11s
     0     0 3302.37602    0  256 -16193.639 3302.37602   120%     -   12s
     0     0 3302.37602    0  254 -16193.639 3302.37602   120%     -   13s
     0     0 3302.37602    0  254 -16193.639 3302.37602   120%     -   13s
     0     0  361.57741    0  442 -16193.639  361.57741   102%     -   17s
H    0     0                    -16169.28025  359.38711   102%     -   18s
H    0     0                    -15889.24435 -405.38410  97.4%     -   19s
H    0     0                    -15538.43978 -405.38410  97.4%     -   19s
     0     0 -405.38410    0  435 -15538.440 -405.38410  97.4%     -   19s
     0     0 -452.42218    0  439 -15538.440 -452.42218  97.1%     -   20s
     0     0 -476.14566    0  444 -15538.440 -476.14566  96.9%     -   20s
     0     0 -482.75859    0  446 -15538.440 -482.75859  96.9%     -   21s
H    0     0                    -14439.25875 -488.70906  96.6%     -   21s
     0     0 -488.70906    0  446 -14439.259 -488.70906  96.6%     -   21s
H    0     0                    -13955.87384 -488.70906  96.5%     -   23s
H    0     0                    -13817.69629 -488.70906  96.5%     -   23s
     0     0 -1674.9475    0  378 -13817.696 -1674.9475  87.9%     -   25s
H    0     0                    -13224.08735 -1678.4141  87.3%     -   25s
H    0     0                    -13111.85809 -1678.4141  87.2%     -   25s
H    0     0                    -12727.97132 -1678.4141  86.8%     -   25s
     0     0 -2077.1057    0  375 -12727.971 -2077.1057  83.7%     -   27s
H    0     0                    -12656.38310 -2140.5484  83.1%     -   28s
     0     0 -2140.5484    0  386 -12656.383 -2140.5484  83.1%     -   28s
     0     0 -2161.1956    0  389 -12656.383 -2161.1956  82.9%     -   29s
     0     0 -2174.2550    0  381 -12656.383 -2174.2550  82.8%     -   29s
     0     0 -2185.7779    0  380 -12656.383 -2185.7779  82.7%     -   29s
     0     0 -2188.7554    0  386 -12656.383 -2188.7554  82.7%     -   29s
     0     0 -2190.0524    0  386 -12656.383 -2190.0524  82.7%     -   29s
     0     0 -2191.2041    0  386 -12656.383 -2191.2041  82.7%     -   30s
H    0     0                    -12486.69678 -2752.3945  78.0%     -   34s
     0     0 -2752.3945    0  468 -12486.697 -2752.3945  78.0%     -   34s
     0     0 -2823.1605    0  477 -12486.697 -2823.1605  77.4%     -   36s
     0     0 -2846.8585    0  401 -12486.697 -2846.8585  77.2%     -   36s
     0     0 -2856.9963    0  471 -12486.697 -2856.9963  77.1%     -   36s
     0     0 -2866.5003    0  468 -12486.697 -2866.5003  77.0%     -   37s
     0     0 -2869.5540    0  471 -12486.697 -2869.5540  77.0%     -   37s
     0     0 -2870.0285    0  475 -12486.697 -2870.0285  77.0%     -   37s
     0     0 -3000.4212    0  481 -12486.697 -3000.4212  76.0%     -   40s
H    0     0                    -12478.90004 -3131.5340  74.9%     -   42s
     0     0 -3131.5340    0  493 -12478.900 -3131.5340  74.9%     -   42s
     0     0 -3190.2123    0  538 -12478.900 -3190.2123  74.4%     -   42s
     0     0 -3203.6405    0  553 -12478.900 -3203.6405  74.3%     -   43s
     0     0 -3206.9092    0  556 -12478.900 -3206.9092  74.3%     -   43s
     0     0 -3210.0202    0  492 -12478.900 -3210.0202  74.3%     -   43s
     0     0 -3211.4782    0  491 -12478.900 -3211.4782  74.3%     -   44s
     0     0 -3310.1413    0  476 -12478.900 -3310.1413  73.5%     -   45s
     0     0 -3362.5206    0  543 -12478.900 -3362.5206  73.1%     -   47s
     0     0 -3370.3814    0  553 -12478.900 -3370.3814  73.0%     -   48s
     0     0 -3371.0113    0  555 -12478.900 -3371.0113  73.0%     -   48s
     0     0 -3416.0648    0  557 -12478.900 -3416.0648  72.6%     -   49s
     0     0 -3425.4865    0  611 -12478.900 -3425.4865  72.5%     -   50s
     0     0 -3432.4694    0  605 -12478.900 -3432.4694  72.5%     -   50s
     0     0 -3436.1513    0  553 -12478.900 -3436.1513  72.5%     -   51s
     0     0 -3438.0877    0  557 -12478.900 -3438.0877  72.4%     -   51s
     0     0 -3438.8245    0  558 -12478.900 -3438.8245  72.4%     -   51s
     0     0 -3463.1089    0  551 -12478.900 -3463.1089  72.2%     -   53s
     0     0 -3465.7094    0  559 -12478.900 -3465.7094  72.2%     -   53s
     0     0 -3466.5774    0  560 -12478.900 -3466.5774  72.2%     -   53s
     0     0 -3470.1618    0  561 -12478.900 -3470.1618  72.2%     -   54s
     0     0 -3471.6462    0  564 -12478.900 -3471.6462  72.2%     -   55s
     0     0 -3486.4181    0  496 -12478.900 -3486.4181  72.1%     -   56s
     0     0 -3489.9891    0  570 -12478.900 -3489.9891  72.0%     -   57s
     0     0 -3490.5440    0  566 -12478.900 -3490.5440  72.0%     -   57s
     0     0 -3502.5231    0  575 -12478.900 -3502.5231  71.9%     -   58s
     0     0 -3502.6574    0  575 -12478.900 -3502.6574  71.9%     -   59s
     0     2 -3502.7053    0  575 -12478.900 -3502.7053  71.9%     -   67s
     7    16 -3974.5473    3  471 -12478.900 -3647.1581  70.8%  1473   74s
    15    32 -4133.7295    4  577 -12478.900 -3964.2185  68.2%  2176   76s
    31    60 -4660.8635    5  655 -12478.900 -4135.1990  66.9%  2416   81s
    95   168 -5114.5740    7  581 -12478.900 -4609.1924  63.1%  2543   89s
   171   214 -5405.8699    9  637 -12478.900 -4609.1924  63.1%  1956   93s
   249   250 -5857.3950   10  635 -12478.900 -4609.1924  63.1%  1621   97s
   315   285 -8639.5333   11  525 -12478.900 -4681.3236  62.5%  1587  101s
   377   315 -7623.2329   11  346 -12478.900 -4681.3236  62.5%  1638  105s
   429   343 -8704.1295   12  262 -12478.900 -4681.3236  62.5%  1685  110s
   526   414 -10102.694   13  320 -12478.900 -4718.5115  62.2%  1807  117s
   588   450 -10716.358   13  307 -12478.900 -4758.2913  61.9%  1794  120s
   718   519 -11008.184   16  166 -12478.900 -4758.2913  61.9%  1691  126s
   774   557 -10989.099   16  297 -12478.900 -4770.1414  61.8%  1689  131s
   888   613 -11521.482   18  137 -12478.900 -4825.8403  61.3%  1644  136s
   993   652 -11834.855   20  123 -12478.900 -4825.8403  61.3%  1609  143s
  1052   672     cutoff   22      -12478.900 -4825.8403  61.3%  1594  147s
  1115   708 -6956.5988   11  329 -12478.900 -4825.8403  61.3%  1592  150s
  1172   752 -7162.6915   11  486 -12478.900 -4825.8403  61.3%  1605  155s
  1327   838     cutoff   13      -12478.900 -4998.5366  59.9%  1594  164s
  1426   906 -11435.116   13  176 -12478.900 -5219.9355  58.2%  1578  167s
  1526   949     cutoff   13      -12478.900 -5219.9355  58.2%  1561  171s
  1653   974 -8092.4020   13  429 -12478.900 -5219.9355  58.2%  1527  175s
  1873  1043     cutoff   15      -12478.900 -5239.9020  58.0%  1516  185s
  1986  1087 -7460.2945   11  456 -12478.900 -5325.9384  57.3%  1514  191s
  2120  1144 -10619.005   13  340 -12478.900 -5325.9384  57.3%  1510  196s
  2258  1191 -11318.145   17  344 -12478.900 -5325.9384  57.3%  1509  201s
  2411  1200     cutoff   19      -12478.900 -5325.9384  57.3%  1492  207s
  2500  1225 -8033.0940    8  440 -12478.900 -5325.9384  57.3%  1502  212s
  2605  1234 -8174.0867    9  434 -12478.900 -5444.4098  56.4%  1505  218s
  2736  1289 -11234.023    9  156 -12478.900 -5857.8092  53.1%  1508  224s
  2877  1323     cutoff   10      -12478.900 -5907.6905  52.7%  1507  230s
  3076  1341 -12141.990   11  443 -12478.900 -5956.0000  52.3%  1495  237s
  3243  1418     cutoff   13      -12478.900 -6566.9927  47.4%  1493  242s
  3422  1456 -10393.708   16  252 -12478.900 -6769.3589  45.8%  1488  249s
  3619  1485 -11634.989   18  309 -12478.900 -7042.1008  43.6%  1476  256s
  3737  1515 -12039.724   20  227 -12478.900 -7042.1008  43.6%  1475  262s
  3933  1562     cutoff   15      -12478.900 -7233.4014  42.0%  1471  269s
  4114  1577 infeasible   13      -12478.900 -7233.4014  42.0%  1480  276s
  4358  1580 -11420.790   10  148 -12478.900 -7320.9051  41.3%  1465  284s
  4606  1596 -11861.763   15  204 -12478.900 -7970.3304  36.1%  1457  290s
  4839  1610 -9821.7542   10  262 -12478.900 -8035.8992  35.6%  1457  298s
  5117  1627 -12113.308   16  283 -12478.900 -8220.4762  34.1%  1448  306s
  5380  1610     cutoff   13      -12478.900 -8624.2911  30.9%  1445  314s
  5591  1592     cutoff   15      -12478.900 -8772.3015  29.7%  1438  322s
  5925  1586 infeasible   14      -12478.900 -9031.6760  27.6%  1417  330s
  6247  1579 -11161.090   20  320 -12478.900 -9241.5713  25.9%  1407  338s
  6610  1546 infeasible   17      -12478.900 -9529.3071  23.6%  1386  348s
  7092  1486 -11844.425   11  198 -12478.900 -9884.2231  20.8%  1349  356s
  7429  1408     cutoff   17      -12478.900 -9959.9519  20.2%  1326  364s
  7999  1242 -12294.056   23  246 -12478.900 -10117.465  18.9%  1290  373s
  8628   929 -11115.102   14  308 -12478.900 -10475.060  16.1%  1250  381s
  9422   813     cutoff   12      -12478.900 -10855.800  13.0%  1197  389s
  9647   571 -11628.123   18  274 -12478.900 -10895.303  12.7%  1185  397s
 10214    93     cutoff   22      -12478.900 -11016.652  11.7%  1146  406s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 10
  MIR: 502
  Flow cover: 696
  Inf proof: 1
  RLT: 21
  Relax-and-lift: 25

Explored 11332 nodes (12195707 simplex iterations) in 409.09 seconds (811.42 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12478.9 -12486.7 -12656.4 ... -15538.4
No other solutions better than -12478.9

Optimal solution found (tolerance 1.00e-04)
Best objective -1.247890004052e+04, best bound -1.247890004052e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 409.11s
  Master Objective (UB) = -12478.90, θ = 116134.95
  Upper Bound (UB) = -12478.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116134.95
  [DEBUG]   ✓ Scenario 0: θ = 116134.95 ≤ Q = 116134.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116134.95 ≤ Q = 116134.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116134.95 ≤ Q = 117538.57 (slack: 1403.62)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x30b0903c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcf4f6fc4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.287542e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6564417.6685
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.249641e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124964.12    0  133 6564417.67 -124964.12   102%     -    0s
H    0     0                    -87059.04969 -124964.12  43.5%     -    0s
H    0     0                    -87980.24796 -124964.12  42.0%     -    0s
H    0     0                    -100758.3885 -124964.12  24.0%     -    0s
     0     0 -106772.60    0   80 -100758.39 -106772.60  5.97%     -    0s
H    0     0                    -104788.8704 -106760.97  1.88%     -    0s
H    0     0                    -105085.6686 -106760.97  1.59%     -    0s
H    0     0                    -105123.3239 -106760.97  1.56%     -    0s
H    0     0                    -105420.1221 -106760.97  1.27%     -    0s
     0     0 -106539.36    0   77 -105420.12 -106539.36  1.06%     -    0s
     0     0 -106529.67    0   75 -105420.12 -106529.67  1.05%     -    0s
     0     0 -106514.97    0   75 -105420.12 -106514.97  1.04%     -    0s
     0     0 -106356.68    0   58 -105420.12 -106356.68  0.89%     -    0s
H    0     0                    -105526.4395 -106308.72  0.74%     -    0s
     0     0 -106299.78    0   57 -105526.44 -106299.78  0.73%     -    0s
     0     0 -106288.13    0   52 -105526.44 -106288.13  0.72%     -    0s
H    0     0                    -105529.6300 -106288.13  0.72%     -    0s
     0     0 -106122.47    0   56 -105529.63 -106122.47  0.56%     -    0s
     0     0 -106098.82    0   57 -105529.63 -106098.82  0.54%     -    0s
     0     0 -106098.82    0   57 -105529.63 -106098.82  0.54%     -    0s
     0     0 -106077.02    0   50 -105529.63 -106077.02  0.52%     -    0s
     0     0 -106067.10    0   53 -105529.63 -106067.10  0.51%     -    0s
     0     0 -106023.19    0   53 -105529.63 -106023.19  0.47%     -    0s
     0     0 -106015.37    0   53 -105529.63 -106015.37  0.46%     -    0s
     0     0 -106015.37    0   78 -105529.63 -106015.37  0.46%     -    0s
     0     0 -106015.37    0   51 -105529.63 -106015.37  0.46%     -    0s
     0     0 -106015.37    0   48 -105529.63 -106015.37  0.46%     -    0s
     0     0 -106015.37    0   50 -105529.63 -106015.37  0.46%     -    0s
     0     0 -106015.37    0   50 -105529.63 -106015.37  0.46%     -    0s
     0     0 -105939.70    0   49 -105529.63 -105939.70  0.39%     -    0s
     0     0 -105926.01    0   50 -105529.63 -105926.01  0.38%     -    0s
     0     0 -105924.86    0   50 -105529.63 -105924.86  0.37%     -    0s
     0     0 -105824.26    0   48 -105529.63 -105824.26  0.28%     -    0s
     0     0 -105820.46    0   48 -105529.63 -105820.46  0.28%     -    0s
     0     0 -105820.20    0   48 -105529.63 -105820.20  0.28%     -    0s
     0     0 -105793.75    0   49 -105529.63 -105793.75  0.25%     -    0s
     0     0 -105790.86    0   47 -105529.63 -105790.86  0.25%     -    0s
     0     0 -105790.50    0   47 -105529.63 -105790.50  0.25%     -    0s
     0     0 -105788.50    0   47 -105529.63 -105788.50  0.25%     -    0s
     0     0 -105788.27    0   54 -105529.63 -105788.27  0.25%     -    0s
     0     0 -105788.27    0   46 -105529.63 -105788.27  0.25%     -    0s
     0     0 -105788.27    0   47 -105529.63 -105788.27  0.25%     -    0s
     0     0 -105772.82    0   44 -105529.63 -105772.82  0.23%     -    0s
     0     0 -105767.96    0   46 -105529.63 -105767.96  0.23%     -    0s
     0     0 -105767.91    0   46 -105529.63 -105767.91  0.23%     -    0s
     0     0 -105767.11    0   46 -105529.63 -105767.11  0.23%     -    0s
     0     0 -105766.19    0   46 -105529.63 -105766.19  0.22%     -    0s
     0     0 -105763.88    0   44 -105529.63 -105763.88  0.22%     -    0s
     0     0 -105753.16    0   44 -105529.63 -105753.16  0.21%     -    0s
     0     2 -105753.16    0   44 -105529.63 -105753.16  0.21%     -    0s

Cutting planes:
  Gomory: 15
  Implied bound: 3
  MIR: 55
  Flow cover: 26

Explored 120 nodes (2050 simplex iterations) in 0.38 seconds (0.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -105530 -105526 -105420 ... 1.28754e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.055296299540e+05, best bound -1.055331826717e+05, gap 0.0034%
  Subproblem solved in 0.41s
  Worst-case operational profit (Z_SP) = 103584.08
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105529.63
  [DEBUG]   S×d_nominal = 209113.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209113.71 + -105529.63 = 103584.08
  [DEBUG]   Current θ from Master = 116134.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12550.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25029.77
  Lower Bound (LB) = -13636.55
  Gap (UB-LB) = 1157.6469, Absolute Gap = 1157.6469, Relative Gap = 0.092768
  Not converged yet (gap = 1157.65 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0xa54ebf63
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -25029.8 (0.05s)
MIP start from previous solve produced solution with objective -25029.8 (0.06s)
Loaded MIP start from previous solve with objective -25029.8

Presolve removed 27512 rows and 11172 columns
Presolve time: 1.84s
Presolved: 35031 rows, 16048 columns, 216519 nonzeros
Variable types: 13789 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35031 rows, 16048 columns, 216519 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36143   -3.1157114e+04   0.000000e+00   4.800800e+06      5s
   47408    5.4790186e+03   0.000000e+00   1.711458e+06     10s
Concurrent spin time: 0.42s

Solved with dual simplex

Root relaxation: objective 8.034978e+03, 27104 iterations, 12.08 seconds (16.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8034.97838    0  205 -25029.770 8034.97838   132%     -   14s
H    0     0                    -17035.24064 8034.97838   147%     -   14s
H    0     0                    -12967.18920 8034.97838   162%     -   14s
H    0     0                    -12950.65691 8034.97838   162%     -   14s
H    0     0                    -12858.64682 8034.97838   162%     -   14s
H    0     0                    -12758.07339 8034.97838   163%     -   14s
H    0     0                    -12700.36911 8034.97838   163%     -   14s
     0     0 3316.13297    0  266 -12700.369 3316.13297   126%     -   21s
     0     0 3316.13297    0  322 -12700.369 3316.13297   126%     -   23s
     0     0 3316.13297    0  319 -12700.369 3316.13297   126%     -   24s
     0     0 3313.17397    0  323 -12700.369 3313.17397   126%     -   24s
     0     0 3312.78346    0  321 -12700.369 3312.78346   126%     -   24s
     0     0  148.58794    0  459 -12700.369  148.58794   101%     -   30s
     0     0  -25.47875    0  453 -12700.369  -25.47875   100%     -   31s
     0     0  -39.73212    0  447 -12700.369  -39.73212   100%     -   32s
     0     0 -141.78967    0  446 -12700.369 -141.78967  98.9%     -   33s
     0     0 -154.72861    0  455 -12700.369 -154.72861  98.8%     -   34s
     0     0 -161.61524    0  444 -12700.369 -161.61524  98.7%     -   34s
     0     0 -168.11349    0  453 -12700.369 -168.11349  98.7%     -   34s
     0     0 -170.13345    0  453 -12700.369 -170.13345  98.7%     -   34s
     0     0 -171.24027    0  453 -12700.369 -171.24027  98.7%     -   34s
     0     0 -171.80256    0  455 -12700.369 -171.80256  98.6%     -   35s
     0     0 -1118.5173    0  373 -12700.369 -1118.5173  91.2%     -   43s
     0     0 -1697.1009    0  361 -12700.369 -1697.1009  86.6%     -   48s
     0     0 -1741.6715    0  358 -12700.369 -1741.6715  86.3%     -   49s
     0     0 -1770.7512    0  374 -12700.369 -1770.7512  86.1%     -   50s
     0     0 -1783.4534    0  373 -12700.369 -1783.4534  86.0%     -   50s
     0     0 -1788.3365    0  374 -12700.369 -1788.3365  85.9%     -   51s
     0     0 -1788.8342    0  378 -12700.369 -1788.8342  85.9%     -   51s
     0     0 -2521.9208    0  375 -12700.369 -2521.9208  80.1%     -   58s
     0     0 -2718.7458    0  453 -12700.369 -2718.7458  78.6%     -   61s
     0     0 -2773.9295    0  379 -12700.369 -2773.9295  78.2%     -   62s
     0     0 -2784.2713    0  391 -12700.369 -2784.2713  78.1%     -   62s
     0     0 -2792.8811    0  388 -12700.369 -2792.8811  78.0%     -   63s
     0     0 -2794.5579    0  383 -12700.369 -2794.5579  78.0%     -   63s
     0     0 -2794.6246    0  388 -12700.369 -2794.6246  78.0%     -   63s
     0     0 -2916.4198    0  452 -12700.369 -2916.4198  77.0%     -   66s
     0     0 -2933.3984    0  397 -12700.369 -2933.3984  76.9%     -   67s
     0     0 -2941.2956    0  407 -12700.369 -2941.2956  76.8%     -   67s
     0     0 -2942.7555    0  472 -12700.369 -2942.7555  76.8%     -   68s
     0     0 -2943.0772    0  479 -12700.369 -2943.0772  76.8%     -   68s
     0     0 -3063.9507    0  473 -12700.369 -3063.9507  75.9%     -   70s
     0     0 -3111.0439    0  474 -12700.369 -3111.0439  75.5%     -   73s
     0     0 -3117.2015    0  486 -12700.369 -3117.2015  75.5%     -   74s
     0     0 -3123.7434    0  533 -12700.369 -3123.7434  75.4%     -   75s
     0     0 -3127.2759    0  471 -12700.369 -3127.2759  75.4%     -   75s
     0     0 -3128.8963    0  417 -12700.369 -3128.8963  75.4%     -   75s
     0     0 -3129.4487    0  475 -12700.369 -3129.4487  75.4%     -   75s
     0     0 -3242.6431    0  518 -12700.369 -3242.6431  74.5%     -   78s
     0     0 -3260.0187    0  522 -12700.369 -3260.0187  74.3%     -   79s
     0     0 -3267.5141    0  530 -12700.369 -3267.5141  74.3%     -   79s
     0     0 -3279.8784    0  537 -12700.369 -3279.8784  74.2%     -   79s
     0     0 -3292.1830    0  540 -12700.369 -3292.1830  74.1%     -   80s
     0     0 -3292.9227    0  542 -12700.369 -3292.9227  74.1%     -   80s
     0     0 -3317.9442    0  496 -12700.369 -3317.9442  73.9%     -   82s
     0     0 -3328.4260    0  489 -12700.369 -3328.4260  73.8%     -   86s
     0     0 -3329.6375    0  487 -12700.369 -3329.6375  73.8%     -   87s
     0     0 -3362.1594    0  416 -12700.369 -3362.1594  73.5%     -   89s
     0     0 -3378.2481    0  418 -12700.369 -3378.2481  73.4%     -   90s
     0     0 -3380.4260    0  420 -12700.369 -3380.4260  73.4%     -   90s
     0     0 -3383.1272    0  417 -12700.369 -3383.1272  73.4%     -   90s
     0     0 -3384.4008    0  421 -12700.369 -3384.4008  73.4%     -   90s
     0     0 -3423.6537    0  477 -12700.369 -3423.6537  73.0%     -   92s
     0     0 -3434.3272    0  473 -12700.369 -3434.3272  73.0%     -   93s
     0     0 -3437.9888    0  538 -12700.369 -3437.9888  72.9%     -   94s
     0     0 -3438.9667    0  483 -12700.369 -3438.9667  72.9%     -   94s
     0     0 -3457.3496    0  483 -12700.369 -3457.3496  72.8%     -   95s
     0     0 -3467.7184    0  419 -12700.369 -3467.7184  72.7%     -   96s
     0     0 -3470.0297    0  490 -12700.369 -3470.0297  72.7%     -   97s
     0     0 -3472.6596    0  438 -12700.369 -3472.6596  72.7%     -   97s
     0     0 -3474.0033    0  438 -12700.369 -3474.0033  72.6%     -   97s
     0     0 -3495.0180    0  479 -12700.369 -3495.0180  72.5%     -   99s
     0     0 -3503.1551    0  478 -12700.369 -3503.1551  72.4%     -  100s
     0     0 -3507.9702    0  414 -12700.369 -3507.9702  72.4%     -  100s
     0     0 -3508.9559    0  485 -12700.369 -3508.9559  72.4%     -  101s
     0     0 -3517.7505    0  494 -12700.369 -3517.7505  72.3%     -  102s
     0     0 -3520.7348    0  495 -12700.369 -3520.7348  72.3%     -  103s
     0     0 -3521.4449    0  502 -12700.369 -3521.4449  72.3%     -  103s
     0     0 -3525.0822    0  496 -12700.369 -3525.0822  72.2%     -  104s
     0     0 -3526.9251    0  499 -12700.369 -3526.9251  72.2%     -  105s
     0     0 -3527.9269    0  500 -12700.369 -3527.9269  72.2%     -  105s
     0     0 -3533.0975    0  495 -12700.369 -3533.0975  72.2%     -  106s
     0     0 -3534.1861    0  495 -12700.369 -3534.1861  72.2%     -  107s
     0     0 -3540.1136    0  434 -12700.369 -3540.1136  72.1%     -  108s
     0     0 -3544.0573    0  436 -12700.369 -3544.0573  72.1%     -  108s
     0     0 -3544.3836    0  500 -12700.369 -3544.3836  72.1%     -  109s
     0     0 -3548.2681    0  423 -12700.369 -3548.2681  72.1%     -  110s
     0     0 -3551.1155    0  423 -12700.369 -3551.1155  72.0%     -  110s
     0     2 -3551.1155    0  423 -12700.369 -3551.1155  72.0%     -  124s
     1     4 -3622.0992    1  483 -12700.369 -3551.1155  72.0%   998  127s
     7    16 -4111.4130    3  542 -12700.369 -3679.3660  71.0%  2487  132s
    15    32 -4338.7238    4  528 -12700.369 -4058.1976  68.0%  2510  138s
    31    64 -4475.0348    5  468 -12700.369 -4238.3682  66.6%  3557  142s
    63    96 -4509.8601    6  472 -12700.369 -4465.9789  64.8%  2920  147s
    95   141 -4695.5240    7  480 -12700.369 -4465.9789  64.8%  2568  153s
   140   207 -4854.7722    8  475 -12700.369 -4465.9789  64.8%  2282  160s
   208   255 -4769.1296    8  591 -12700.369 -4465.9789  64.8%  2018  167s
   276   292 -5453.0995    9  322 -12700.369 -4465.9789  64.8%  1938  175s
   337   328 -5480.1440    9  515 -12700.369 -4476.2602  64.8%  1995  180s
   385   386 -6116.9266   10  337 -12700.369 -4476.2602  64.8%  2014  186s
   449   423 -6672.9662   10  363 -12700.369 -4476.2602  64.8%  2096  193s
   496   483 -6996.4313   11  273 -12700.369 -4476.2602  64.8%  2105  197s
   558   531 -7181.6093   12  384 -12700.369 -4476.2602  64.8%  2036  202s
   630   596 -7335.7162   13  388 -12700.369 -4511.2871  64.5%  1957  207s
   709   651 -7886.9536   15  328 -12700.369 -4511.2871  64.5%  1880  215s
   788   701 -10166.582   16  186 -12700.369 -4511.2871  64.5%  1798  221s
   864   720 -8706.2452   17  347 -12700.369 -4654.6651  63.4%  1775  227s
   909   743     cutoff   18      -12700.369 -4673.7658  63.2%  1763  232s
   952   764 -10441.825   18  362 -12700.369 -4709.2100  62.9%  1770  236s
   997   787 -10248.585   19  319 -12700.369 -4709.2100  62.9%  1776  243s
  1040   817 -10270.085   20  322 -12700.369 -4722.1735  62.8%  1780  248s
  1078   858 -10444.873   21  448 -12700.369 -4722.1735  62.8%  1804  253s
  1133   912 -10595.076   22  405 -12700.369 -4722.1735  62.8%  1800  260s
  1208   959 -10741.252   23  450 -12700.369 -4722.1735  62.8%  1771  266s
  1316   999     cutoff   23      -12700.369 -4770.4787  62.4%  1708  273s
  1418  1031 -10784.004   24  441 -12700.369 -4858.3343  61.7%  1678  280s
  1515  1087 -11372.992   24  391 -12700.369 -4858.3343  61.7%  1677  287s
  1603  1135 -11234.259   26  391 -12700.369 -4884.2060  61.5%  1679  295s
  1708  1182 -12061.194   32  123 -12700.369 -4888.6133  61.5%  1660  303s
  1829  1266 -8523.0361    8  285 -12700.369 -4898.4872  61.4%  1642  312s
  1977  1308 -11168.712   12  228 -12700.369 -4991.1510  60.7%  1608  321s
  2123  1350     cutoff   13      -12700.369 -5079.0629  60.0%  1582  331s
  2225  1388 -8038.8705   10  346 -12700.369 -5079.0629  60.0%  1572  341s
  2363  1450 -9294.1433   12  263 -12700.369 -5101.6298  59.8%  1559  351s
  2512  1516 -11060.074   15  252 -12700.369 -5101.6298  59.8%  1552  362s
  2700  1553 infeasible   18      -12700.369 -5125.1033  59.6%  1531  370s
  2851  1576 -9000.9983   11  493 -12700.369 -5125.1033  59.6%  1531  376s
  2891  1599 -9896.0148   12  305 -12700.369 -5125.1033  59.6%  1539  382s
  2938  1619 -11255.068   13  330 -12700.369 -5125.1033  59.6%  1541  393s
  2994  1639 infeasible   15      -12700.369 -5352.2425  57.9%  1541  401s
  3048  1662 -11714.596   14  300 -12700.369 -5352.2425  57.9%  1539  411s
  3125  1715 -12197.031   15  296 -12700.369 -5392.4236  57.5%  1537  421s
  3238  1741 -6577.1326    7  340 -12700.369 -5392.4236  57.5%  1523  430s
  3332  1792 -7641.2094    8  297 -12700.369 -5482.2818  56.8%  1518  440s
  3455  1836 -12042.385   13  319 -12700.369 -5482.2818  56.8%  1517  451s
  3628  1920 -9804.5138   12  440 -12700.369 -5482.2818  56.8%  1512  460s
  3811  1959 -10500.393   15  408 -12700.369 -5482.2818  56.8%  1509  470s
  3896  2027 -11153.570   16  327 -12700.369 -5482.2818  56.8%  1508  481s
  4130  2093 -8682.1046   13  257 -12700.369 -5482.2818  56.8%  1491  495s
  4404  2179     cutoff   17      -12700.369 -5482.2818  56.8%  1481  507s
  4640  2273 -8794.1383   13  202 -12700.369 -5891.8367  53.6%  1484  519s
  4888  2403 -11654.527   19  237 -12700.369 -6018.0203  52.6%  1490  532s
  5177  2404 -10866.246   17  423 -12700.369 -6104.8686  51.9%  1482  560s
  5179  2405 -9310.6778   20  205 -12700.369 -6104.8686  51.9%  1482  579s
  5180  2406 -9051.7420   16  432 -12700.369 -6104.8686  51.9%  1482  592s
  5181  2407 -11306.800   26  378 -12700.369 -6104.8686  51.9%  1481  600s
  5182  2407 -12037.599   27  453 -12700.369 -6104.8686  51.9%  1481  606s
  5184  2409 -10473.859   23  470 -12700.369 -6104.8686  51.9%  1480  611s
  5186  2410 -8240.1988   10  527 -12700.369 -6104.8686  51.9%  1480  616s
  5189  2412 -11944.927   31  492 -12700.369 -6104.8686  51.9%  1479  621s
  5190  2413 -9244.7821   13  459 -12700.369 -6104.8686  51.9%  1479  626s
  5193  2415 -12031.730   27  456 -12700.369 -6104.8686  51.9%  1478  633s
  5194  2415 -12027.775   46  451 -12700.369 -6104.8686  51.9%  1478  635s
  5197  2417 -8908.7641   19  529 -12700.369 -6104.8686  51.9%  1477  644s
  5198  2418 -10563.051   16  491 -12700.369 -6104.8686  51.9%  1476  645s
  5201  2420 -9970.7554   14  482 -12700.369 -6104.8686  51.9%  1476  652s
  5203  2421 -11041.436   24  535 -12700.369 -6104.8686  51.9%  1475  655s
  5204  2422 -12455.415   20  468 -12700.369 -6104.8686  51.9%  1475  660s
  5207  2424 -10118.504   19  547 -12700.369 -6104.8686  51.9%  1474  666s
  5208  2425 -8053.0812   13  525 -12700.369 -6104.8686  51.9%  1474  671s
  5210  2426 -9152.1591   13  559 -12700.369 -6104.8686  51.9%  1473  676s
  5211  2427 -7471.3967   11  559 -12700.369 -6104.8686  51.9%  1473  712s
  5212  2427 -10197.559   17  559 -12700.369 -6104.8686  51.9%  1472  721s
  5213  2431 -6104.8686   13  475 -12700.369 -6104.8686  51.9%  1494  734s
  5215  2434 -6104.8686   14  489 -12700.369 -6104.8686  51.9%  1494  743s
  5219  2441 -6104.8686   15  540 -12700.369 -6104.8686  51.9%  1497  750s
  5227  2454 -6104.8686   16  518 -12700.369 -6104.8686  51.9%  1500  757s
  5243  2473 -9326.3020   17  381 -12700.369 -6104.8686  51.9%  1526  772s
  5268  2491 -8555.7234   18  440 -12700.369 -6104.8686  51.9%  1551  782s
  5300  2558 -10438.610   19  478 -12700.369 -6104.8686  51.9%  1571  795s
  5405  2571 -12058.980   22  270 -12700.369 -6104.8686  51.9%  1580  805s
  5499  2560     cutoff   23      -12700.369 -6104.8686  51.9%  1583  811s
  5540  2566 -12229.837   23  267 -12700.369 -6104.8686  51.9%  1589  821s
  5607  2558     cutoff   24      -12700.369 -6104.8686  51.9%  1597  831s
  5676  2539 -11838.036   24  273 -12700.369 -6104.8686  51.9%  1597  841s
  5770  2510     cutoff   26      -12700.369 -6104.8686  51.9%  1597  848s
  5832  2496 -9908.6475   20  528 -12700.369 -7402.5165  41.7%  1602  855s
  5906  2482 -10123.695   22  497 -12700.369 -7402.5165  41.7%  1604  864s
  5959  2466 -10587.720   24  418 -12700.369 -7707.3506  39.3%  1612  873s
  6023  2457 -11816.216   26  455 -12700.369 -7707.3506  39.3%  1618  882s
  6074  2455 -11901.735   27  458 -12700.369 -7707.3506  39.3%  1625  891s
  6116  2453 -12260.942   28  413 -12700.369 -7707.3506  39.3%  1628  901s
  6172  2436 -12309.576   29  396 -12700.369 -7707.3506  39.3%  1632  910s
  6240  2423 -12339.220   30  416 -12700.369 -7707.3506  39.3%  1638  917s
  6284  2428     cutoff   31      -12700.369 -8085.6193  36.3%  1642  923s
  6334  2426 -8831.5311   20  237 -12700.369 -8085.6193  36.3%  1644  931s
  6404  2407 -10741.429   22  302 -12700.369 -8085.6193  36.3%  1647  940s
  6492  2372 -12481.562   23  411 -12700.369 -8181.2219  35.6%  1649  948s
  6571  2345 -11031.894   23  163 -12700.369 -8181.2219  35.6%  1654  956s
  6653  2307 -12466.830   25  379 -12700.369 -8835.9378  30.4%  1660  968s
  6754  2267     cutoff   29      -12700.369 -9220.9211  27.4%  1659  979s
  6865  2214 infeasible   23      -12700.369 -9220.9211  27.4%  1663  991s
  6982  2156     cutoff   24      -12700.369 -9220.9211  27.4%  1668 1000s
  7098  2105     cutoff   23      -12700.369 -9642.6439  24.1%  1668 1010s
  7205  2031 -11776.957   22  482 -12700.369 -9690.0363  23.7%  1673 1022s
  7359  1934 infeasible   23      -12700.369 -9873.3575  22.3%  1671 1032s
  7473  1835     cutoff   29      -12700.369 -10031.656  21.0%  1667 1044s
  7644  1686 -12106.010   24  484 -12700.369 -10031.656  21.0%  1658 1052s
  7820  1567     cutoff   25      -12700.369 -10031.656  21.0%  1639 1062s
  7926  1523     cutoff   30      -12700.369 -11206.264  11.8%  1628 1068s

Cutting planes:
  Learned: 1
  MIR: 580
  Mixing: 2
  Flow cover: 936
  Zero half: 1
  RLT: 6
  Relax-and-lift: 38

Explored 7942 nodes (13029237 simplex iterations) in 1068.76 seconds (1947.93 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -12700.4 -12758.1 -12858.6 ... -25029.8
No other solutions better than -12700.4

Optimal solution found (tolerance 1.00e-04)
Best objective -1.270036910515e+04, best bound -1.270036910515e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1068.79s
  Master Objective (UB) = -12700.37, θ = 115884.86
  Upper Bound (UB) = -12700.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115884.86
  [DEBUG]   ✓ Scenario 0: θ = 115884.86 ≤ Q = 115884.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115884.86 ≤ Q = 115884.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115884.86 ≤ Q = 115884.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115884.86 ≤ Q = 115884.86 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6ec7867c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6ec7867c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.291066e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6611121.2497
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.242411e+05, 266 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124241.06    0  133 6611121.25 -124241.06   102%     -    0s
H    0     0                    -86358.41218 -124241.06  43.9%     -    0s
H    0     0                    -87279.61045 -124241.06  42.3%     -    0s
H    0     0                    -95267.14611 -124241.06  30.4%     -    0s
H    0     0                    -99818.68629 -105093.10  5.28%     -    0s
     0     0 -105010.88    0   32 -99818.686 -105010.88  5.20%     -    0s
H    0     0                    -104606.3752 -105010.88  0.39%     -    0s
H    0     0                    -104779.2150 -104866.92  0.08%     -    0s
     0     0 -104863.66    0   26 -104779.22 -104863.66  0.08%     -    0s
     0     0 -104840.16    0    9 -104779.22 -104840.16  0.06%     -    0s
     0     0 -104836.43    0   10 -104779.22 -104836.43  0.05%     -    0s
     0     0 -104796.00    0    2 -104779.22 -104796.00  0.02%     -    0s
     0     0 -104795.68    0    2 -104779.22 -104795.68  0.02%     -    0s
H    0     0                    -104795.2382 -104795.68  0.00%     -    0s

Explored 1 nodes (519 simplex iterations) in 0.11 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -104795 -104779 -104614 ... 1.29107e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.047952381580e+05, best bound -1.047956779699e+05, gap 0.0004%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 103754.37
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104795.24
  [DEBUG]   S×d_nominal = 208549.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208549.60 + -104795.24 = 103754.37
  [DEBUG]   Current θ from Master = 115884.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12130.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24830.86
  Lower Bound (LB) = -13636.55
  Gap (UB-LB) = 936.1778, Absolute Gap = 936.1778, Relative Gap = 0.073713
  Not converged yet (gap = 936.18 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0x5a82ef94
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34400 rows and 13970 columns
Presolve time: 1.11s
Presolved: 43433 rows, 19490 columns, 269239 nonzeros
Variable types: 17231 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398721.3119
Found heuristic solution: objective -172451.4877

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43433 rows, 19490 columns, 269239 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23230   -1.7691506e+04   0.000000e+00   4.626198e+08      5s
   31735    3.8076812e+03   0.000000e+00   7.317197e+06     10s
   38637    6.1187002e+03   0.000000e+00   5.571488e+06     15s
   45425    7.6297540e+03   0.000000e+00   1.544654e+05     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 8.033499e+03, 31367 iterations, 20.53 seconds (27.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8033.49891    0  205 -172451.49 8033.49891   105%     -   22s
H    0     0                    -158497.5064 8033.49891   105%     -   22s
H    0     0                    -80496.67908 8033.49891   110%     -   22s
H    0     0                    -80462.38208 8033.49891   110%     -   22s
H    0     0                    -67064.93001 8033.49891   112%     -   22s
H    0     0                    -24221.13480 8033.49891   133%     -   22s
H    0     0                    -24009.72186 8033.49891   133%     -   22s
H    0     0                    -23652.78071 8033.49891   134%     -   23s
H    0     0                    -23628.80809 3699.55453   116%     -   30s
     0     0 3699.55453    0  329 -23628.808 3699.55453   116%     -   30s
H    0     0                    -16074.62027 3466.15180   122%     -   33s
     0     0 3270.51203    0  326 -16074.620 3270.51203   120%     -   33s
     0     0 3270.51203    0  325 -16074.620 3270.51203   120%     -   35s
     0     0 3174.76762    0  319 -16074.620 3174.76762   120%     -   36s
     0     0 3142.54732    0  328 -16074.620 3142.54732   120%     -   36s
     0     0 3140.09995    0  330 -16074.620 3140.09995   120%     -   36s
     0     0 3140.09995    0  330 -16074.620 3140.09995   120%     -   37s
H    0     0                    -16004.53924  691.21192   104%     -   47s
     0     0  591.77573    0  376 -16004.539  591.77573   104%     -   48s
H    0     0                    -15976.90324  591.77573   104%     -   48s
H    0     0                    -15888.19683  122.04456   101%     -   53s
H    0     0                    -15628.95421  122.04456   101%     -   53s
     0     0  122.04456    0  467 -15628.954  122.04456   101%     -   53s
     0     0 -112.63945    0  461 -15628.954 -112.63945  99.3%     -   55s
     0     0 -131.17730    0  466 -15628.954 -131.17730  99.2%     -   56s
     0     0 -134.66010    0  464 -15628.954 -134.66010  99.1%     -   57s
     0     0 -138.84534    0  467 -15628.954 -138.84534  99.1%     -   57s
     0     0 -148.63552    0  474 -15628.954 -148.63552  99.0%     -   58s
     0     0 -149.18041    0  475 -15628.954 -149.18041  99.0%     -   58s
H    0     0                    -13965.71270 -1306.9284  90.6%     -   72s
H    0     0                    -13138.62030 -1306.9284  90.1%     -   72s
H    0     0                    -13125.81998 -1306.9284  90.0%     -   72s
     0     0 -1306.9284    0  453 -13125.820 -1306.9284  90.0%     -   72s
H    0     0                    -13118.02324 -1307.1330  90.0%     -   72s
     0     0 -1732.3434    0  504 -13118.023 -1732.3434  86.8%     -   76s
     0     0 -1845.8692    0  448 -13118.023 -1845.8692  85.9%     -   80s
     0     0 -1925.6600    0  496 -13118.023 -1925.6600  85.3%     -   82s
     0     0 -2084.6399    0  483 -13118.023 -2084.6399  84.1%     -   85s
     0     0 -2168.4124    0  494 -13118.023 -2168.4124  83.5%     -   87s
     0     0 -2198.0681    0  501 -13118.023 -2198.0681  83.2%     -   88s
     0     0 -2202.9263    0  497 -13118.023 -2202.9263  83.2%     -   88s
     0     0 -2208.1655    0  502 -13118.023 -2208.1655  83.2%     -   89s
     0     0 -2209.1825    0  509 -13118.023 -2209.1825  83.2%     -   89s
H    0     0                    -12950.65691 -2209.1825  82.9%     -   93s
     0     0 -2515.0471    0  457 -12950.657 -2515.0471  80.6%     -   99s
     0     0 -2568.6364    0  411 -12950.657 -2568.6364  80.2%     -  101s
     0     0 -2653.2253    0  476 -12950.657 -2653.2253  79.5%     -  103s
     0     0 -2702.2879    0  411 -12950.657 -2702.2879  79.1%     -  104s
     0     0 -2706.8529    0  415 -12950.657 -2706.8529  79.1%     -  105s
     0     0 -2709.1110    0  414 -12950.657 -2709.1110  79.1%     -  105s
     0     0 -2709.5978    0  418 -12950.657 -2709.5978  79.1%     -  105s
     0     0 -2849.9358    0  460 -12950.657 -2849.9358  78.0%     -  109s
     0     0 -2871.7425    0  454 -12950.657 -2871.7425  77.8%     -  110s
     0     0 -2887.1651    0  464 -12950.657 -2887.1651  77.7%     -  111s
     0     0 -2906.0941    0  453 -12950.657 -2906.0941  77.6%     -  112s
     0     0 -2917.8420    0  468 -12950.657 -2917.8420  77.5%     -  114s
     0     0 -2921.3494    0  477 -12950.657 -2921.3494  77.4%     -  114s
     0     0 -2923.2310    0  471 -12950.657 -2923.2310  77.4%     -  114s
     0     0 -2923.6062    0  473 -12950.657 -2923.6062  77.4%     -  115s
     0     0 -3113.1397    0  513 -12950.657 -3113.1397  76.0%     -  119s
     0     0 -3230.3841    0  468 -12950.657 -3230.3841  75.1%     -  126s
     0     0 -3252.4691    0  410 -12950.657 -3252.4691  74.9%     -  127s
     0     0 -3255.8599    0  410 -12950.657 -3255.8599  74.9%     -  127s
     0     0 -3258.1082    0  470 -12950.657 -3258.1082  74.8%     -  128s
     0     0 -3258.9264    0  462 -12950.657 -3258.9264  74.8%     -  128s
     0     0 -3300.5019    0  459 -12950.657 -3300.5019  74.5%     -  131s
     0     0 -3322.0376    0  472 -12950.657 -3322.0376  74.3%     -  133s
     0     0 -3327.0011    0  467 -12950.657 -3327.0011  74.3%     -  133s
     0     0 -3330.1154    0  473 -12950.657 -3330.1154  74.3%     -  134s
     0     0 -3332.2314    0  475 -12950.657 -3332.2314  74.3%     -  134s
     0     0 -3332.5417    0  418 -12950.657 -3332.5417  74.3%     -  134s
H    0     0                    -12922.72487 -3353.4134  74.1%     -  137s
     0     0 -3353.4134    0  523 -12922.725 -3353.4134  74.1%     -  137s
     0     0 -3470.3363    0  517 -12922.725 -3470.3363  73.1%     -  140s
     0     0 -3482.0602    0  529 -12922.725 -3482.0602  73.1%     -  141s
     0     0 -3487.6504    0  523 -12922.725 -3487.6504  73.0%     -  142s
     0     0 -3495.4317    0  525 -12922.725 -3495.4317  73.0%     -  143s
     0     0 -3497.0752    0  533 -12922.725 -3497.0752  72.9%     -  144s
     0     0 -3497.7137    0  536 -12922.725 -3497.7137  72.9%     -  144s
     0     0 -3515.8107    0  472 -12922.725 -3515.8107  72.8%     -  146s
     0     0 -3518.1796    0  474 -12922.725 -3518.1796  72.8%     -  148s
     0     0 -3519.9703    0  478 -12922.725 -3519.9703  72.8%     -  148s
     0     0 -3520.5031    0  480 -12922.725 -3520.5031  72.8%     -  148s
     0     0 -3540.8286    0  471 -12922.725 -3540.8286  72.6%     -  151s
     0     0 -3543.7902    0  544 -12922.725 -3543.7902  72.6%     -  153s
     0     0 -3544.7908    0  547 -12922.725 -3544.7908  72.6%     -  153s
     0     0 -3554.2040    0  548 -12922.725 -3554.2040  72.5%     -  155s
     0     0 -3557.0106    0  554 -12922.725 -3557.0106  72.5%     -  156s
     0     0 -3558.8313    0  554 -12922.725 -3558.8313  72.5%     -  157s
     0     0 -3559.7073    0  553 -12922.725 -3559.7073  72.5%     -  157s
     0     0 -3568.7041    0  553 -12922.725 -3568.7041  72.4%     -  159s
     0     0 -3569.7801    0  560 -12922.725 -3569.7801  72.4%     -  165s
     0     0 -3574.7529    0  567 -12922.725 -3574.7529  72.3%     -  167s
     0     0 -3574.8893    0  567 -12922.725 -3574.8893  72.3%     -  168s
     0     2 -3574.9826    0  567 -12922.725 -3574.9826  72.3%     -  188s
     1     4 -3823.0511    1  537 -12922.725 -3574.9826  72.3%  5927  194s
     3     8 -4261.6276    2  534 -12922.725 -3800.6336  70.6%  3376  197s
     7    16 -4853.5319    3  561 -12922.725 -4036.7547  68.8%  3382  205s
    15    32 -5057.2887    4  559 -12922.725 -4165.7562  67.8%  4110  212s
    31    51 -4407.0963    5  472 -12922.725 -4281.3165  66.9%  5118  229s
    50    83 -5005.9826    6  365 -12922.725 -4407.1141  65.9%  6245  235s
    82   126 -5068.3232    7  355 -12922.725 -4719.5351  63.5%  4827  246s
   125   215 -5373.8430    8  414 -12922.725 -4719.5351  63.5%  3906  254s
   220   286 -5485.3590    9  413 -12922.725 -4719.5351  63.5%  2910  265s
   318   339 -9953.7584   10  189 -12922.725 -4719.5351  63.5%  2454  275s
   409   360 -6912.4655   11  419 -12922.725 -4719.5351  63.5%  2348  286s
   490   394 -7143.5482   12  365 -12922.725 -4719.5351  63.5%  2230  295s
   564   420 -7569.6498   13  345 -12922.725 -4719.5351  63.5%  2271  304s
   619   464 -7440.5437   13  332 -12922.725 -4719.5351  63.5%  2291  312s
   691   496 -7997.3424   14  450 -12922.725 -4719.5351  63.5%  2347  322s
   766   531     cutoff   14      -12922.725 -4719.5351  63.5%  2290  330s
   847   550 -10883.788   15  300 -12922.725 -4908.8005  62.0%  2290  338s
   891   584 -8169.5944   15  427 -12922.725 -4908.8005  62.0%  2341  345s
   943   608 -9438.0576   16  180 -12922.725 -4908.8005  62.0%  2383  353s
   981   632 -8262.1299   16  384 -12922.725 -4908.8005  62.0%  2415  361s
  1029   648 -8606.1159   17  391 -12922.725 -4908.8005  62.0%  2423  370s
  1076   656 -8957.9636   17  372 -12922.725 -4908.8005  62.0%  2441  379s
  1136   679 -9445.4926   18  378 -12922.725 -4908.8005  62.0%  2441  388s
  1214   698 -9489.7235   17  184 -12922.725 -5245.6983  59.4%  2446  396s
  1279   727 -9662.0842   18  351 -12922.725 -5253.1780  59.3%  2467  405s
  1353   758 -10325.458   18  432 -12922.725 -5253.1780  59.3%  2497  412s
  1430   791 -10721.074   18  438 -12922.725 -5253.1780  59.3%  2510  424s
  1545   827 -10440.126   18  174 -12922.725 -5477.7359  57.6%  2488  435s
  1651   863 -11368.052   19  365 -12922.725 -5477.7359  57.6%  2485  445s
  1788   890 -11100.535   19  314 -12922.725 -5877.9278  54.5%  2468  455s
  1896   917 infeasible   19      -12922.725 -5923.8720  54.2%  2483  466s
  2006   981 -11247.633   19  381 -12922.725 -5923.8720  54.2%  2521  474s
  2128  1019 -11398.445   22  305 -12922.725 -5923.8720  54.2%  2524  485s
  2280  1060     cutoff   23      -12922.725 -6163.3777  52.3%  2507  495s
  2426  1103 -12003.929   26  375 -12922.725 -6163.3777  52.3%  2508  506s
  2536  1140     cutoff   26      -12922.725 -6233.3448  51.8%  2502  518s
  2669  1202     cutoff   28      -12922.725 -6501.6400  49.7%  2502  527s
  2824  1231 -9300.6503   10  332 -12922.725 -6502.5672  49.7%  2501  539s
  2993  1252 -11599.325   16  272 -12922.725 -6502.5672  49.7%  2492  547s
  3044  1307 -11737.221   17  201 -12922.725 -6502.5672  49.7%  2506  557s
  3147  1311 -11766.657   18  202 -12922.725 -6502.5672  49.7%  2507  569s
  3295  1354 -12368.240   20  179 -12922.725 -6502.5672  49.7%  2494  583s
  3434  1392     cutoff   11      -12922.725 -7023.8426  45.6%  2506  595s
  3606  1415 -11320.815   12  284 -12922.725 -7072.1611  45.3%  2508  608s
  3735  1465 -12518.985   14  236 -12922.725 -7072.1611  45.3%  2524  620s
  3890  1516 -10131.619   11  348 -12922.725 -7184.9962  44.4%  2534  633s
  4076  1567     cutoff   13      -12922.725 -7291.9130  43.6%  2540  649s
  4302  1645 -11565.731   16  243 -12922.725 -7410.7563  42.7%  2539  665s
  4553  1700     cutoff   13      -12922.725 -7410.7563  42.7%  2529  680s
  4775  1704     cutoff   10      -12922.725 -8011.6104  38.0%  2536  690s
  4835  1695 infeasible   11      -12922.725 -8122.2121  37.1%  2541  702s
  4955  1712 -12302.007   18  331 -12922.725 -8122.2121  37.1%  2523  719s
  5131  1762     cutoff   22      -12922.725 -8241.3254  36.2%  2526  736s
  5375  1782     cutoff   15      -12922.725 -8420.7750  34.8%  2517  753s
  5647  1808 -11230.942   18  198 -12922.725 -8514.1076  34.1%  2492  771s
  5895  1781 -12173.739   13  233 -12922.725 -8694.7036  32.7%  2517  790s
  6253  1789 infeasible   11      -12922.725 -8990.0855  30.4%  2496  808s
  6579  1827     cutoff   21      -12922.725 -9031.2782  30.1%  2493  828s
  6946  1831 -11385.342   22  196 -12922.725 -9122.5618  29.4%  2471  847s
  7349  1809 -12582.524   23  216 -12922.725 -9351.9648  27.6%  2454  866s
  7779  1730 -10916.644    9  218 -12922.725 -9351.9648  27.6%  2438  886s
  8184  1675     cutoff   14      -12922.725 -9619.2737  25.6%  2439  906s
  8662  1569 -11934.814   17  376 -12922.725 -9745.9079  24.6%  2422  925s
  9177  1453     cutoff   18      -12922.725 -10039.926  22.3%  2400  946s
  9751  1276 -12545.231   18  367 -12922.725 -10377.854  19.7%  2367  968s
 10439  1092     cutoff   16      -12922.725 -10662.527  17.5%  2314  988s
 11165   775     cutoff   19      -12922.725 -10902.556  15.6%  2264 1009s
 12098   242 -12546.704   24  276 -12922.725 -11362.667  12.1%  2182 1031s
 13232     0 -12677.123   18  344 -12922.725 -11822.003  8.52%  2070 1040s

Cutting planes:
  Gomory: 6
  Implied bound: 45
  MIR: 805
  Flow cover: 1143
  RLT: 17
  Relax-and-lift: 38

Explored 13574 nodes (27731289 simplex iterations) in 1040.69 seconds (2110.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12922.7 -12950.7 -13118 ... -16004.5
No other solutions better than -12922.7

Optimal solution found (tolerance 1.00e-04)
Best objective -1.292272486736e+04, best bound -1.292272486736e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1040.71s
  Master Objective (UB) = -12922.72, θ = 116155.26
  Upper Bound (UB) = -12922.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116155.26
  [DEBUG]   ✓ Scenario 0: θ = 116155.26 ≤ Q = 116155.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116155.26 ≤ Q = 116155.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116155.26 ≤ Q = 116155.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116155.26 ≤ Q = 116155.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116155.26 ≤ Q = 116155.26 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xe5e608f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf1a19f71
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-14, 2e+02]
Found heuristic solution: objective 1.288927e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6576050.3432
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.237185e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123718.54    0  123 6576050.34 -123718.54   102%     -    0s
H    0     0                    -90881.71498 -123718.54  36.1%     -    0s
H    0     0                    -91188.79876 -123718.54  35.7%     -    0s
     0     0 -97620.688    0   79 -91188.799 -97620.688  7.05%     -    0s
H    0     0                    -95442.61386 -97547.697  2.21%     -    0s
H    0     0                    -95739.41211 -97547.697  1.89%     -    0s
H    0     0                    -95874.17617 -97547.697  1.75%     -    0s
H    0     0                    -96170.97442 -97547.697  1.43%     -    0s
     0     0 -97403.370    0   81 -96170.974 -97403.370  1.28%     -    0s
H    0     0                    -96289.60333 -97364.121  1.12%     -    0s
     0     0 -97364.121    0   82 -96289.603 -97364.121  1.12%     -    0s
     0     0 -97045.045    0   88 -96289.603 -97045.045  0.78%     -    0s
     0     0 -97042.324    0   88 -96289.603 -97042.324  0.78%     -    0s
     0     0 -96869.432    0   57 -96289.603 -96869.432  0.60%     -    0s
     0     0 -96812.850    0   61 -96289.603 -96812.850  0.54%     -    0s
     0     0 -96803.949    0   57 -96289.603 -96803.949  0.53%     -    0s
     0     0 -96697.139    0   54 -96289.603 -96697.139  0.42%     -    0s
     0     0 -96684.247    0   51 -96289.603 -96684.247  0.41%     -    0s
H    0     0                    -96322.83827 -96682.779  0.37%     -    0s
     0     0 -96682.779    0   70 -96322.838 -96682.779  0.37%     -    0s
     0     0 -96682.779    0   46 -96322.838 -96682.779  0.37%     -    0s
     0     0 -96682.779    0   48 -96322.838 -96682.779  0.37%     -    0s
     0     0 -96675.491    0   48 -96322.838 -96675.491  0.37%     -    0s
     0     0 -96674.399    0   48 -96322.838 -96674.399  0.36%     -    0s
     0     0 -96605.675    0   47 -96322.838 -96605.675  0.29%     -    0s
     0     0 -96593.587    0   47 -96322.838 -96593.587  0.28%     -    0s
     0     0 -96592.115    0   47 -96322.838 -96592.115  0.28%     -    0s
     0     0 -96578.872    0   44 -96322.838 -96578.872  0.27%     -    0s
     0     0 -96578.173    0   44 -96322.838 -96578.173  0.27%     -    0s
     0     0 -96578.053    0   56 -96322.838 -96578.053  0.26%     -    0s
     0     0 -96578.053    0   44 -96322.838 -96578.053  0.26%     -    0s
     0     0 -96578.053    0   44 -96322.838 -96578.053  0.26%     -    0s
     0     0 -96578.053    0   44 -96322.838 -96578.053  0.26%     -    0s
     0     0 -96575.835    0   43 -96322.838 -96575.835  0.26%     -    0s
     0     0 -96571.638    0   35 -96322.838 -96571.638  0.26%     -    0s
     0     0 -96549.265    0   43 -96322.838 -96549.265  0.24%     -    0s
     0     0 -96544.802    0   44 -96322.838 -96544.802  0.23%     -    0s
     0     0 -96543.048    0   32 -96322.838 -96543.048  0.23%     -    0s
     0     0 -96523.209    0   32 -96322.838 -96523.209  0.21%     -    0s
     0     2 -96523.209    0   32 -96322.838 -96523.209  0.21%     -    0s

Cutting planes:
  Gomory: 19
  Implied bound: 1
  MIR: 62
  Flow cover: 32

Explored 84 nodes (1843 simplex iterations) in 0.26 seconds (0.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -96322.8 -96289.6 -96171 ... 1.28893e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.632283826788e+04, best bound -9.632641034692e+04, gap 0.0037%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 112790.88
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96322.84
  [DEBUG]   S×d_nominal = 209113.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209113.71 + -96322.84 = 112790.88
  [DEBUG]   Current θ from Master = 116155.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3364.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -16287.10
  Lower Bound (LB) = -13636.55
  Gap (UB-LB) = 713.8221, Absolute Gap = 713.8221, Relative Gap = 0.055238
  Not converged yet (gap = 713.82 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0xe48d4580
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41288 rows and 16768 columns
Presolve time: 2.28s
Presolved: 51835 rows, 22932 columns, 321959 nonzeros
Variable types: 20673 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398721.3119
Found heuristic solution: objective -172451.4877

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51835 rows, 22932 columns, 321959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20932   -7.8700386e+04   0.000000e+00   5.244412e+06      5s
   31747   -1.0702242e+04   0.000000e+00   8.392130e+05     10s
   39180    4.1608567e+02   0.000000e+00   4.076861e+06     15s
   45444    1.6922579e+03   0.000000e+00   4.826291e+06     20s
   52471    6.6961374e+03   0.000000e+00   3.215207e+06     25s
Concurrent spin time: 2.70s

Solved with dual simplex

Root relaxation: objective 8.033499e+03, 48420 iterations, 27.42 seconds (37.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8033.49891    0  205 -172451.49 8033.49891   105%     -   30s
H    0     0                    -162545.8332 8033.49891   105%     -   30s
H    0     0                    -127984.5264 8033.49891   106%     -   30s
H    0     0                    -111365.4757 8033.49891   107%     -   30s
H    0     0                    -67074.25284 8033.49891   112%     -   30s
H    0     0                    -25805.11505 8033.49891   131%     -   30s
H    0     0                    -24072.47957 8033.49891   133%     -   31s
H    0     0                    -24009.72186 8033.49891   133%     -   31s
H    0     0                    -23769.74442 8033.49891   134%     -   31s
H    0     0                    -23679.13280 8033.49891   134%     -   31s
H    0     0                    -23652.78071 8033.49891   134%     -   31s
     0     0 3310.75507    0  333 -23652.781 3310.75507   114%     -   43s
     0     0 3274.03235    0  334 -23652.781 3274.03235   114%     -   46s
     0     0 3274.03235    0  328 -23652.781 3274.03235   114%     -   47s
     0     0 3274.03235    0  327 -23652.781 3274.03235   114%     -   48s
     0     0 3274.03235    0  281 -23652.781 3274.03235   114%     -   50s
     0     0 3272.84687    0  272 -23652.781 3272.84687   114%     -   51s
     0     0 3272.01705    0  323 -23652.781 3272.01705   114%     -   51s
     0     0 3272.01705    0  323 -23652.781 3272.01705   114%     -   51s
     0     0  513.89612    0  475 -23652.781  513.89612   102%     -   63s
     0     0   49.14481    0  445 -23652.781   49.14481   100%     -   69s
     0     0  -20.19049    0  441 -23652.781  -20.19049   100%     -   70s
H    0     0                    -16719.46985  -46.60721   100%     -   71s
H    0     0                    -16497.84670  -46.60721   100%     -   71s
     0     0  -46.60721    0  450 -16497.847  -46.60721   100%     -   71s
     0     0  -48.03277    0  457 -16497.847  -48.03277   100%     -   71s
H    0     0                    -16358.18479  -57.93086   100%     -   73s
     0     0  -57.93086    0  449 -16358.185  -57.93086   100%     -   73s
     0     0  -58.15980    0  450 -16358.185  -58.15980   100%     -   73s
     0     0 -1258.1397    0  382 -16358.185 -1258.1397  92.3%     -   87s
     0     0 -1601.5872    0  439 -16358.185 -1601.5872  90.2%     -   95s
H    0     0                    -13149.44815 -1950.2010  85.2%     -  101s
H    0     0                    -13128.13997 -1950.2010  85.1%     -  101s
     0     0 -1950.2010    0  444 -13128.140 -1950.2010  85.1%     -  101s
     0     0 -2034.1135    0  447 -13128.140 -2034.1135  84.5%     -  104s
     0     0 -2069.0057    0  389 -13128.140 -2069.0057  84.2%     -  105s
H    0     0                    -12950.65691 -2083.2074  83.9%     -  107s
     0     0 -2083.2074    0  382 -12950.657 -2083.2074  83.9%     -  107s
     0     0 -2088.1867    0  388 -12950.657 -2088.1867  83.9%     -  108s
     0     0 -2095.6123    0  378 -12950.657 -2095.6123  83.8%     -  108s
     0     0 -2100.7724    0  382 -12950.657 -2100.7724  83.8%     -  110s
     0     0 -2102.5150    0  397 -12950.657 -2102.5150  83.8%     -  111s
     0     0 -2103.4999    0  389 -12950.657 -2103.4999  83.8%     -  111s
     0     0 -2579.5298    0  390 -12950.657 -2579.5298  80.1%     -  124s
     0     0 -2789.1416    0  453 -12950.657 -2789.1416  78.5%     -  130s
     0     0 -2809.5997    0  405 -12950.657 -2809.5997  78.3%     -  133s
     0     0 -2824.4310    0  466 -12950.657 -2824.4310  78.2%     -  134s
     0     0 -2832.9300    0  396 -12950.657 -2832.9300  78.1%     -  135s
     0     0 -2839.9838    0  454 -12950.657 -2839.9838  78.1%     -  136s
     0     0 -2849.1218    0  406 -12950.657 -2849.1218  78.0%     -  137s
     0     0 -2862.0794    0  463 -12950.657 -2862.0794  77.9%     -  138s
     0     0 -2864.9133    0  470 -12950.657 -2864.9133  77.9%     -  139s
     0     0 -2865.9569    0  473 -12950.657 -2865.9569  77.9%     -  139s
     0     0 -2989.8430    0  415 -12950.657 -2989.8430  76.9%     -  144s
     0     0 -3029.2345    0  407 -12950.657 -3029.2345  76.6%     -  147s
     0     0 -3030.9456    0  406 -12950.657 -3030.9456  76.6%     -  147s
     0     0 -3034.1040    0  406 -12950.657 -3034.1040  76.6%     -  148s
     0     0 -3034.6785    0  404 -12950.657 -3034.6785  76.6%     -  148s
     0     0 -3196.3498    0  457 -12950.657 -3196.3498  75.3%     -  154s
     0     0 -3218.2997    0  454 -12950.657 -3218.2997  75.1%     -  157s
     0     0 -3254.0264    0  450 -12950.657 -3254.0264  74.9%     -  159s
     0     0 -3261.2200    0  451 -12950.657 -3261.2200  74.8%     -  160s
     0     0 -3264.6717    0  458 -12950.657 -3264.6717  74.8%     -  161s
     0     0 -3265.8414    0  457 -12950.657 -3265.8414  74.8%     -  162s
     0     0 -3419.6241    0  456 -12950.657 -3419.6241  73.6%     -  169s
     0     0 -3500.0528    0  520 -12950.657 -3500.0528  73.0%     -  172s
     0     0 -3505.5495    0  460 -12950.657 -3505.5495  72.9%     -  173s
     0     0 -3508.6886    0  466 -12950.657 -3508.6886  72.9%     -  175s
     0     0 -3510.2416    0  457 -12950.657 -3510.2416  72.9%     -  176s
     0     0 -3510.9106    0  469 -12950.657 -3510.9106  72.9%     -  176s
     0     0 -3537.6760    0  475 -12950.657 -3537.6760  72.7%     -  181s
     0     0 -3539.7688    0  473 -12950.657 -3539.7688  72.7%     -  185s
     0     0 -3540.7414    0  475 -12950.657 -3540.7414  72.7%     -  186s
     0     0 -3561.5579    0  469 -12950.657 -3561.5579  72.5%     -  190s
     0     0 -3571.0608    0  404 -12950.657 -3571.0608  72.4%     -  192s
     0     0 -3572.8510    0  406 -12950.657 -3572.8510  72.4%     -  193s
     0     0 -3573.5351    0  407 -12950.657 -3573.5351  72.4%     -  193s
     0     0 -3614.1248    0  522 -12950.657 -3614.1248  72.1%     -  198s
     0     0 -3620.3035    0  457 -12950.657 -3620.3035  72.0%     -  201s
     0     0 -3622.6930    0  464 -12950.657 -3622.6930  72.0%     -  201s
     0     0 -3625.2873    0  466 -12950.657 -3625.2873  72.0%     -  202s
     0     0 -3625.9956    0  468 -12950.657 -3625.9956  72.0%     -  202s
     0     0 -3682.4287    0  427 -12950.657 -3682.4287  71.6%     -  207s
     0     0 -3725.2359    0  532 -12950.657 -3725.2359  71.2%     -  211s
     0     0 -3729.8366    0  487 -12950.657 -3729.8366  71.2%     -  212s
     0     0 -3731.1998    0  539 -12950.657 -3731.1998  71.2%     -  213s
     0     0 -3739.8981    0  480 -12950.657 -3739.8981  71.1%     -  215s
     0     0 -3742.4378    0  561 -12950.657 -3742.4378  71.1%     -  219s
     0     0 -3742.8320    0  565 -12950.657 -3742.8320  71.1%     -  220s
     0     0 -3764.9711    0  494 -12950.657 -3764.9711  70.9%     -  223s
     0     0 -3766.7028    0  496 -12950.657 -3766.7028  70.9%     -  224s
     0     0 -3767.4474    0  567 -12950.657 -3767.4474  70.9%     -  224s
     0     0 -3771.8204    0  456 -12950.657 -3771.8204  70.9%     -  226s
     0     0 -3772.7006    0  456 -12950.657 -3772.7006  70.9%     -  226s
     0     0 -3777.2221    0  449 -12950.657 -3777.2221  70.8%     -  229s
     0     0 -3778.7627    0  519 -12950.657 -3778.7627  70.8%     -  230s
     0     0 -3779.2095    0  451 -12950.657 -3779.2095  70.8%     -  230s
     0     0 -3780.4449    0  454 -12950.657 -3780.4449  70.8%     -  232s
     0     0 -3781.8661    0  454 -12950.657 -3781.8661  70.8%     -  233s
     0     2 -3781.8661    0  454 -12950.657 -3781.8661  70.8%     -  287s
     1     4 -3914.1664    1  495 -12950.657 -3782.1592  70.8%  3321  291s
     3     8 -4430.5793    2  549 -12950.657 -3914.3572  69.8%  4500  296s
     7    16 -4549.7931    3  557 -12950.657 -3975.9305  69.3%  4155  306s
    15    32 -4761.8290    4  504 -12950.657 -4549.8921  64.9%  5588  315s
    31    49 -8049.0404    5  337 -12950.657 -4667.9196  64.0%  6554  334s
    48    77 -6571.3448    6  461 -12950.657 -4667.9196  64.0%  8083  351s
    80   224 -6714.7578    7  396 -12950.657 -4667.9196  64.0%  6324  365s
   233   276 -7064.6235   10  372 -12950.657 -4667.9196  64.0%  3529  372s
   287   321 -7123.0086   11  492 -12950.657 -4667.9196  64.0%  3185  380s
   354   352 -10589.834   10  251 -12950.657 -4667.9196  64.0%  2926  391s
   412   384 -9573.2780   10  242 -12950.657 -4667.9196  64.0%  2874  402s
   477   419 -7249.4907   11  375 -12950.657 -4667.9196  64.0%  3011  414s
   534   443 -7269.2819   12  480 -12950.657 -4667.9196  64.0%  3072  425s
   588   468 -7190.7378   12  367 -12950.657 -4667.9196  64.0%  3111  435s
   646   486 -7702.9913   14  397 -12950.657 -4667.9196  64.0%  3200  447s
   688   508 -7562.3651   13  483 -12950.657 -4667.9196  64.0%  3224  456s
   740   526 -8750.6806   15  307 -12950.657 -4667.9196  64.0%  3237  468s
   793   545 -9328.5664   15  401 -12950.657 -4762.2768  63.2%  3253  478s
   836   565     cutoff   13      -12950.657 -5041.3536  61.1%  3287  489s
   886   589     cutoff   14      -12950.657 -5048.9822  61.0%  3271  500s
   940   619 -12228.443   17  309 -12950.657 -5048.9822  61.0%  3341  509s
  1002   638 -10429.625   18  372 -12950.657 -5048.9822  61.0%  3393  521s
  1043   664     cutoff   18      -12950.657 -5061.5636  60.9%  3459  533s
  1085   705 -10619.881   20  288 -12950.657 -5061.5636  60.9%  3514  544s
  1152   737 -11050.949   21  357 -12950.657 -5061.5636  60.9%  3517  554s
  1230   766     cutoff   21      -12950.657 -5061.5636  60.9%  3503  567s
  1298   802 -11795.563   21  226 -12950.657 -5061.5636  60.9%  3489  580s
  1368   829 -12197.579   21  296 -12950.657 -5061.5636  60.9%  3554  590s
  1459   867 -11993.013   23  347 -12950.657 -5061.5636  60.9%  3562  602s
  1543   920 -11601.443   24  282 -12950.657 -5061.5636  60.9%  3606  617s
  1639   969 -12057.232   25  283 -12950.657 -5061.5636  60.9%  3603  629s
  1741   989 -12199.453   28  274 -12950.657 -5061.5636  60.9%  3589  639s
  1785  1016 -12298.081   29  215 -12950.657 -5061.5636  60.9%  3612  652s
  1836  1036 -12366.949   30  212 -12950.657 -5061.5636  60.9%  3628  662s
  1896  1042 -12383.960   31  200 -12950.657 -5061.5636  60.9%  3642  671s
  1976  1070 -12425.473   32  214 -12950.657 -5061.5636  60.9%  3600  687s
  2030  1104 -12479.382   33  261 -12950.657 -5446.6678  57.9%  3613  700s
  2082  1127 -12480.279   34  285 -12950.657 -5446.6678  57.9%  3620  716s
  2139  1157 -12626.145   35  190 -12950.657 -5756.8452  55.5%  3603  731s
  2197  1191 -12681.805   35  294 -12950.657 -5756.8715  55.5%  3621  747s
  2290  1219 -7982.7360   13  372 -12950.657 -5756.8715  55.5%  3609  765s
  2416  1251 -10164.093   16  187 -12950.657 -5929.5349  54.2%  3583  782s
  2513  1260 -9523.9560    7  352 -12950.657 -5929.5349  54.2%  3638  801s
  2590  1304 -9579.1473    8  347 -12950.657 -5990.0521  53.7%  3642  818s
  2688  1352 -12578.351   11  302 -12950.657 -5990.0521  53.7%  3679  836s
  2818  1398     cutoff   12      -12950.657 -5990.0521  53.7%  3710  855s
  2972  1445 -10267.283    9  253 -12950.657 -5990.0521  53.7%  3732  877s
  3151  1480 -11011.157   11  227 -12950.657 -6246.1255  51.8%  3739  893s
  3218  1528 -11573.877   14  242 -12950.657 -6297.2158  51.4%  3750  913s
  3365  1567     cutoff   24      -12950.657 -6355.2192  50.9%  3772  934s
  3520  1611 -9866.1900   16  207 -12950.657 -6355.2192  50.9%  3823  956s
  3716  1659 -12392.583   18  231 -12950.657 -6356.6748  50.9%  3820  978s
  3914  1713 -9079.1655   11  240 -12950.657 -6739.1814  48.0%  3840 1004s
  4120  1784     cutoff   17      -12950.657 -6752.0802  47.9%  3862 1029s
  4325  1838     cutoff   25      -12950.657 -6752.4407  47.9%  3884 1055s
  4578  1875 -8885.9850   15  655 -12950.657 -6752.4407  47.9%  3874 1081s
  4850  1926 -11478.236   22  287 -12950.657 -6752.4407  47.9%  3859 1109s
  5061  1993 -11033.455   10  206 -12950.657 -7212.6831  44.3%  3859 1135s
  5316  2039     cutoff    9      -12950.657 -7265.2898  43.9%  3877 1163s
  5605  2081 -10166.623   10  246 -12950.657 -7270.8950  43.9%  3863 1191s
  5896  2177 -10361.845   15  395 -12950.657 -7272.6005  43.8%  3849 1218s
  6164  2230 -12464.487   18  308 -12950.657 -7272.6005  43.8%  3874 1252s
  6412  2264 -10902.080   16  322 -12950.657 -7378.0972  43.0%  3867 1285s
  6716  2354     cutoff   23      -12950.657 -7395.8566  42.9%  3890 1315s
  7045  2355 -9703.6146   15  454 -12950.657 -7395.8566  42.9%  3896 1366s
  7047  2356 -10784.728   19  205 -12950.657 -7395.8566  42.9%  3895 1406s
  7048  2357 -11220.718   16  480 -12950.657 -7395.8566  42.9%  3894 1428s
  7049  2358 -11674.916   16  450 -12950.657 -7395.8566  42.9%  3894 1441s
  7050  2358 -8088.2229   14  451 -12950.657 -7395.8566  42.9%  3893 1454s
  7051  2359 -11023.366   21  562 -12950.657 -7395.8566  42.9%  3893 1464s
  7052  2360 -10065.484   14  527 -12950.657 -7395.8566  42.9%  3892 1473s
  7053  2360 -11134.642    9  531 -12950.657 -7395.8566  42.9%  3892 1476s
  7054  2361 -8515.8833   16  479 -12950.657 -7395.8566  42.9%  3891 1480s
  7056  2362 -8580.1424   16  543 -12950.657 -7395.8566  42.9%  3890 1488s
  7057  2363 -9002.7555   21  467 -12950.657 -7395.8566  42.9%  3889 1495s
  7059  2364 -11830.741   21  411 -12950.657 -7395.8566  42.9%  3888 1502s
  7060  2365 -11901.375   16  536 -12950.657 -7395.8566  42.9%  3888 1506s
  7061  2366 -12518.542   42  595 -12950.657 -7395.8566  42.9%  3887 1511s
  7062  2366 -9804.9431   19  482 -12950.657 -7395.8566  42.9%  3887 1520s
  7063  2367 -11228.772   29  492 -12950.657 -7395.8566  42.9%  3886 1525s
  7064  2368 -10284.615   10  606 -12950.657 -7395.8566  42.9%  3886 1532s
  7065  2368 -9967.0137   19  612 -12950.657 -7395.8566  42.9%  3885 1537s
  7066  2369 -8169.4997   10  486 -12950.657 -7395.8566  42.9%  3884 1544s
  7067  2370 -11344.654   12  494 -12950.657 -7395.8566  42.9%  3884 1547s
  7068  2370 -9623.5865   14  482 -12950.657 -7395.8566  42.9%  3883 1555s
  7070  2372 -11605.173   20  482 -12950.657 -7395.8566  42.9%  3882 1564s
  7071  2372 -11140.734   16  482 -12950.657 -7395.8566  42.9%  3882 1605s
  7072  2373 -9523.4958   17  482 -12950.657 -7395.8566  42.9%  3881 1627s
  7073  2376 -7395.8566   16  450 -12950.657 -7395.8566  42.9%  3910 1643s
  7074  2378 -7395.8566   17  423 -12950.657 -7395.8566  42.9%  3910 1654s
  7077  2383 -7395.8566   18  298 -12950.657 -7395.8566  42.9%  3910 1665s
  7083  2393 -7395.8566   19  288 -12950.657 -7395.8566  42.9%  3912 1676s
  7095  2400 -11004.349   20  185 -12950.657 -7395.8566  42.9%  3915 1695s
  7110  2410 -7395.8566   20  346 -12950.657 -7395.8566  42.9%  3931 1729s
  7142  2430 -7633.3795   21  333 -12950.657 -7395.8566  42.9%  3949 1755s
  7222  2422 -9273.1151   22  321 -12950.657 -7395.8566  42.9%  3965 1771s
  7259  2433 -10468.606   23  190 -12950.657 -7395.8566  42.9%  3982 1785s
  7308  2422 -8868.2769   23  338 -12950.657 -7395.8566  42.9%  3987 1800s
  7371  2430 -12635.740   22  171 -12950.657 -7395.8566  42.9%  3997 1816s
  7422  2432 -10755.428   24  195 -12950.657 -7395.8566  42.9%  4005 1829s
  7487  2418 -10041.925   24  256 -12950.657 -7395.8566  42.9%  4011 1841s
  7552  2406 -11660.151   26  394 -12950.657 -7395.8566  42.9%  4019 1855s
  7604  2382     cutoff   27      -12950.657 -7395.8566  42.9%  4021 1869s
  7676  2383 -12053.282   23  281 -12950.657 -7395.8566  42.9%  4024 1882s
  7730  2390     cutoff   24      -12950.657 -7395.8566  42.9%  4030 1897s
  7797  2394 -10607.287   24  276 -12950.657 -7395.8566  42.9%  4038 1911s
  7864  2369     cutoff   25      -12950.657 -7395.8566  42.9%  4037 1928s
  7939  2346 -11694.985   26  278 -12950.657 -7912.4389  38.9%  4030 1944s
  8012  2348 infeasible   27      -12950.657 -7912.4389  38.9%  4036 1958s
  8084  2330 -10138.389   23  489 -12950.657 -7912.4389  38.9%  4038 1972s
  8131  2322 -10768.609   24  370 -12950.657 -7912.4389  38.9%  4042 1987s
  8188  2315 -11083.405   24  479 -12950.657 -7912.4389  38.9%  4041 2000s
  8232  2318 -10788.199   25  375 -12950.657 -7912.4389  38.9%  4047 2015s
  8296  2310 -12710.434   26  339 -12950.657 -8728.1730  32.6%  4050 2027s
  8343  2315     cutoff   27      -12950.657 -8728.1730  32.6%  4049 2041s
  8402  2324 -11458.432   26  365 -12950.657 -8816.1970  31.9%  4044 2057s
  8447  2303     cutoff   28      -12950.657 -9011.2907  30.4%  4040 2071s
  8539  2270 infeasible   34      -12950.657 -9349.0410  27.8%  4032 2087s
  8632  2232 -12604.012   23  359 -12950.657 -9351.7937  27.8%  4023 2107s
  8738  2191     cutoff   33      -12950.657 -9521.2874  26.5%  4021 2123s
  8844  2139     cutoff   29      -12950.657 -9603.5118  25.8%  4028 2143s
  8977  2060     cutoff   32      -12950.657 -9881.4621  23.7%  4018 2161s
  9128  1944 -11985.448   26  468 -12950.657 -9881.4621  23.7%  4001 2179s
  9326  1814     cutoff   27      -12950.657 -10399.796  19.7%  3960 2196s
  9520  1663     cutoff   28      -12950.657 -10425.325  19.5%  3930 2212s
  9722  1531     cutoff   36      -12950.657 -10709.857  17.3%  3882 2227s
  9862  1443     cutoff   28      -12950.657 -11363.002  12.3%  3849 2232s

Cutting planes:
  Learned: 2
  Gomory: 2
  MIR: 572
  Mixing: 1
  Flow cover: 1224
  RLT: 6
  Relax-and-lift: 47

Explored 9917 nodes (38239480 simplex iterations) in 2232.48 seconds (4274.31 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -12950.7 -13128.1 -13149.4 ... -24009.7
No other solutions better than -12950.7

Optimal solution found (tolerance 1.00e-04)
Best objective -1.295065690571e+04, best bound -1.295065690571e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2232.51s
  Master Objective (UB) = -12950.66, θ = 115984.31
  Upper Bound (UB) = -12950.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115984.31
  [DEBUG]   ✓ Scenario 0: θ = 115984.31 ≤ Q = 115984.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115984.31 ≤ Q = 115984.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115984.31 ≤ Q = 115984.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115984.31 ≤ Q = 115984.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 115984.31 ≤ Q = 115984.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 115984.31 ≤ Q = 115984.31 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x634c06ea
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9cb3f916
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.288927e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6578910.3279
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.238467e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123846.69    0  123 6578910.33 -123846.69   102%     -    0s
H    0     0                    -90987.36478 -123846.69  36.1%     -    0s
H    0     0                    -91294.44855 -123846.69  35.7%     -    0s
     0     0 -94859.160    0   79 -91294.449 -94859.160  3.90%     -    0s
H    0     0                    -92697.65365 -94803.586  2.27%     -    0s
H    0     0                    -92994.45190 -94803.586  1.95%     -    0s
H    0     0                    -93109.26435 -94803.586  1.82%     -    0s
H    0     0                    -93406.06260 -94803.586  1.50%     -    0s
     0     0 -94680.790    0   76 -93406.063 -94680.790  1.36%     -    0s
     0     0 -94638.842    0   76 -93406.063 -94638.842  1.32%     -    0s
     0     0 -94448.531    0   73 -93406.063 -94448.531  1.12%     -    0s
H    0     0                    -93669.61077 -94442.529  0.83%     -    0s
H    0     0                    -93898.82415 -94442.529  0.58%     -    0s
     0     0 -94442.529    0   73 -93898.824 -94442.529  0.58%     -    0s
     0     0 -94398.516    0   66 -93898.824 -94398.516  0.53%     -    0s
     0     0 -94396.488    0   66 -93898.824 -94396.488  0.53%     -    0s
H    0     0                    -94146.53184 -94396.488  0.27%     -    0s
     0     0 -94396.488    0   71 -94146.532 -94396.488  0.27%     -    0s
     0     0 -94396.488    0   81 -94146.532 -94396.488  0.27%     -    0s
     0     0 -94383.154    0   67 -94146.532 -94383.154  0.25%     -    0s
     0     0 -94382.344    0   65 -94146.532 -94382.344  0.25%     -    0s
     0     0 -94194.008    0    5 -94146.532 -94194.008  0.05%     -    0s
H    0     0                    -94147.15751 -94190.358  0.05%     -    0s
     0     0 -94187.842    0    4 -94147.158 -94187.842  0.04%     -    0s
     0     0 -94182.834    0    4 -94147.158 -94182.834  0.04%     -    0s
     0     0 -94182.834    0   21 -94147.158 -94182.834  0.04%     -    0s
     0     0 -94174.220    0    4 -94147.158 -94174.220  0.03%     -    0s
     0     0 -94162.418    0    2 -94147.158 -94162.418  0.02%     -    0s
     0     0 -94162.418    0    5 -94147.158 -94162.418  0.02%     -    0s
H    0     0                    -94155.71951 -94162.418  0.01%     -    0s

Explored 1 nodes (1134 simplex iterations) in 0.24 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -94155.7 -94147.2 -94146.5 ... -91294.4

Optimal solution found (tolerance 1.00e-04)
Best objective -9.415571951298e+04, best bound -9.416241758860e+04, gap 0.0071%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 114957.99
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94155.72
  [DEBUG]   S×d_nominal = 209113.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209113.71 + -94155.72 = 114957.99
  [DEBUG]   Current θ from Master = 115984.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1026.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13976.97
  Lower Bound (LB) = -13636.55
  Gap (UB-LB) = 685.8900, Absolute Gap = 685.8900, Relative Gap = 0.052962
  Not converged yet (gap = 685.89 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0x82912400
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48176 rows and 19566 columns
Presolve time: 2.17s
Presolved: 60237 rows, 26374 columns, 374679 nonzeros
Variable types: 24115 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398721.3119
Found heuristic solution: objective -172451.4877

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60237 rows, 26374 columns, 374679 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24598   -1.5239023e+05   0.000000e+00   3.259704e+06      5s
   36608   -3.2761618e+04   0.000000e+00   9.368440e+08     10s
   43619   -9.7123443e+03   0.000000e+00   1.156812e+08     15s
   48646   -2.4886019e+03   0.000000e+00   1.607086e+08     20s
   55280    5.0137413e+03   0.000000e+00   2.985663e+06     25s
   60389    5.4203590e+03   0.000000e+00   7.740739e+05     30s
   65355    7.0683238e+03   0.000000e+00   8.286623e+05     35s
   69946    7.4472346e+03   0.000000e+00   1.321833e+07     40s
Concurrent spin time: 0.32s

Solved with dual simplex

Root relaxation: objective 7.963257e+03, 54691 iterations, 40.48 seconds (56.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7963.25739    0  212 -172451.49 7963.25739   105%     -   43s
H    0     0                    -168664.1734 7963.25739   105%     -   43s
H    0     0                    -106040.2046 7963.25739   108%     -   43s
H    0     0                    -105541.2179 7963.25739   108%     -   43s
H    0     0                    -64930.61098 7963.25739   112%     -   43s
H    0     0                    -27730.83794 7963.25739   129%     -   44s
H    0     0                    -24008.64219 7963.25739   133%     -   44s
H    0     0                    -23652.78071 7963.25739   134%     -   44s
     0     0 3567.55056    0  258 -23652.781 3567.55056   115%     -   59s
H    0     0                    -16432.70761 3305.45151   120%     -   63s
     0     0 3286.20966    0  253 -16432.708 3286.20966   120%     -   63s
     0     0 3177.51507    0  269 -16432.708 3177.51507   119%     -   65s
     0     0 3177.51507    0  269 -16432.708 3177.51507   119%     -   65s
     0     0 3158.24529    0  266 -16432.708 3158.24529   119%     -   67s
     0     0 3105.08141    0  259 -16432.708 3105.08141   119%     -   68s
     0     0 3081.24670    0  257 -16432.708 3081.24670   119%     -   70s
     0     0 3081.24670    0  277 -16432.708 3081.24670   119%     -   74s
     0     0  230.00651    0  266 -16432.708  230.00651   101%     -   77s
     0     0  230.00651    0  266 -16432.708  230.00651   101%     -   77s
     0     0  126.27032    0  447 -16432.708  126.27032   101%     -   86s
     0     0 -111.61207    0  459 -16432.708 -111.61207  99.3%     -   90s
     0     0 -252.77524    0  463 -16432.708 -252.77524  98.5%     -   93s
     0     0 -300.14727    0  453 -16432.708 -300.14727  98.2%     -   94s
H    0     0                    -15673.25530 -499.41815  96.8%     -   96s
     0     0 -499.41815    0  447 -15673.255 -499.41815  96.8%     -   96s
H    0     0                    -15628.21631 -514.13955  96.7%     -   98s
     0     0 -514.13955    0  452 -15628.216 -514.13955  96.7%     -   98s
     0     0 -515.50263    0  455 -15628.216 -515.50263  96.7%     -   98s
     0     0 -515.77345    0  455 -15628.216 -515.77345  96.7%     -   99s
     0     0 -1570.2905    0  448 -15628.216 -1570.2905  90.0%     -  112s
H    0     0                    -13138.62030 -1983.5207  84.9%     -  123s
H    0     0                    -13108.00466 -1983.5207  84.9%     -  123s
     0     0 -1983.5207    0  448 -13108.005 -1983.5207  84.9%     -  123s
     0     0 -2061.2180    0  397 -13108.005 -2061.2180  84.3%     -  126s
     0     0 -2091.6963    0  399 -13108.005 -2091.6963  84.0%     -  129s
     0     0 -2097.9832    0  402 -13108.005 -2097.9832  84.0%     -  130s
H    0     0                    -13100.20793 -2101.5018  84.0%     -  132s
     0     0 -2101.5018    0  392 -13100.208 -2101.5018  84.0%     -  132s
     0     0 -2102.6439    0  398 -13100.208 -2102.6439  83.9%     -  132s
     0     0 -2113.8849    0  397 -13100.208 -2113.8849  83.9%     -  133s
     0     0 -2114.9576    0  401 -13100.208 -2114.9576  83.9%     -  134s
     0     0 -2684.4568    0  465 -13100.208 -2684.4568  79.5%     -  149s
     0     0 -2794.1200    0  442 -13100.208 -2794.1200  78.7%     -  155s
     0     0 -2902.2102    0  509 -13100.208 -2902.2102  77.8%     -  162s
     0     0 -2938.4241    0  514 -13100.208 -2938.4241  77.6%     -  165s
     0     0 -2943.9627    0  507 -13100.208 -2943.9627  77.5%     -  166s
     0     0 -2961.4559    0  502 -13100.208 -2961.4559  77.4%     -  168s
     0     0 -2968.4062    0  504 -13100.208 -2968.4062  77.3%     -  170s
     0     0 -2969.0606    0  510 -13100.208 -2969.0606  77.3%     -  170s
     0     0 -3115.3649    0  453 -13100.208 -3115.3649  76.2%     -  176s
     0     0 -3176.9138    0  504 -13100.208 -3176.9138  75.7%     -  182s
     0     0 -3204.8119    0  513 -13100.208 -3204.8119  75.5%     -  184s
     0     0 -3215.4424    0  509 -13100.208 -3215.4424  75.5%     -  187s
     0     0 -3216.0897    0  519 -13100.208 -3216.0897  75.5%     -  188s
     0     0 -3349.7163    0  510 -13100.208 -3349.7163  74.4%     -  197s
H    0     0                    -13052.20033 -3349.7851  74.3%     -  203s
     0     0 -3371.1332    0  463 -13052.200 -3371.1332  74.2%     -  207s
     0     0 -3378.4848    0  470 -13052.200 -3378.4848  74.1%     -  208s
     0     0 -3417.8755    0  516 -13052.200 -3417.8755  73.8%     -  211s
     0     0 -3421.0264    0  466 -13052.200 -3421.0264  73.8%     -  212s
     0     0 -3422.0983    0  514 -13052.200 -3422.0983  73.8%     -  212s
     0     0 -3460.9194    0  527 -13052.200 -3460.9194  73.5%     -  217s
     0     0 -3466.9967    0  470 -13052.200 -3466.9967  73.4%     -  219s
     0     0 -3468.9608    0  471 -13052.200 -3468.9608  73.4%     -  220s
     0     0 -3469.9985    0  473 -13052.200 -3469.9985  73.4%     -  220s
     0     0 -3492.3041    0  521 -13052.200 -3492.3041  73.2%     -  224s
     0     0 -3498.9762    0  525 -13052.200 -3498.9762  73.2%     -  230s
     0     0 -3501.6275    0  527 -13052.200 -3501.6275  73.2%     -  231s
     0     0 -3502.1829    0  529 -13052.200 -3502.1829  73.2%     -  232s
     0     0 -3506.4341    0  527 -13052.200 -3506.4341  73.1%     -  234s
     0     0 -3508.9756    0  532 -13052.200 -3508.9756  73.1%     -  235s
     0     0 -3511.4958    0  467 -13052.200 -3511.4958  73.1%     -  236s
     0     0 -3511.7005    0  471 -13052.200 -3511.7005  73.1%     -  236s
     0     0 -3516.8621    0  473 -13052.200 -3516.8621  73.1%     -  238s
H    0     0                    -13035.00378 -3517.5441  73.0%     -  240s
     0     0 -3517.8357    0  479 -13035.004 -3517.8357  73.0%     -  240s
     0     0 -3528.9746    0  468 -13035.004 -3528.9746  72.9%     -  242s
     0     0 -3533.7687    0  472 -13035.004 -3533.7687  72.9%     -  245s
     0     0 -3535.3621    0  471 -13035.004 -3535.3621  72.9%     -  245s
     0     0 -3535.5906    0  470 -13035.004 -3535.5906  72.9%     -  245s
     0     0 -3542.1793    0  468 -13035.004 -3542.1793  72.8%     -  248s
     0     0 -3542.2087    0  468 -13035.004 -3542.2087  72.8%     -  250s
     0     2 -3542.2087    0  468 -13035.004 -3542.2087  72.8%     -  272s
     1     4 -3631.8284    1  453 -13035.004 -3542.2087  72.8%  2983  275s
     3     8 -3701.5054    2  467 -13035.004 -3632.2800  72.1%  3078  282s
     7    16 -4318.1090    3  514 -13035.004 -3701.9266  71.6%  5166  293s
    15    32 -5228.0456    4  439 -13035.004 -3824.8952  70.7%  6254  304s
    31    48 -4716.3627    5  453 -13035.004 -3933.2968  69.8%  7462  325s
    47    80 -5129.9609    6  448 -13035.004 -3933.2968  69.8%  8445  342s
    79   138 -5189.2602    7  437 -13035.004 -3933.2968  69.8%  6918  358s
   139   187 -5244.0052    8  433 -13035.004 -3933.2968  69.8%  5088  369s
   198   229 -5599.6137    9  424 -13035.004 -3933.2968  69.8%  3964  385s
   263   263 -5443.9203    8  354 -13035.004 -3933.2968  69.8%  3402  393s
   326   274 -5658.8477   10  475 -13035.004 -3933.2968  69.8%  3211  408s
   378   299 -5973.5091   10  287 -13035.004 -3933.2968  69.8%  3166  422s
   417   317 -5399.3699    9  303 -13035.004 -3933.2968  69.8%  3309  433s
   471   346 -7028.4071    9  237 -13035.004 -3933.2968  69.8%  3376  445s
   527   375 -6180.1471    9  396 -13035.004 -3933.2968  69.8%  3421  454s
   590   395 -6535.2985   10  445 -13035.004 -3933.2968  69.8%  3403  467s
   644   409 -12746.592   16   73 -13035.004 -3933.2968  69.8%  3437  480s
   701   433 -8290.7471   10  417 -13035.004 -3933.2968  69.8%  3418  493s
   756   447 -12286.702   11   96 -13035.004 -3933.2968  69.8%  3442  505s
   814   458 -11371.537   10   83 -13035.004 -3933.2968  69.8%  3458  519s
   867   498     cutoff   10      -13035.004 -3933.2968  69.8%  3513  532s
   927   513 -9898.0375   12  354 -13035.004 -3933.2968  69.8%  3524  545s
   994   538 -9279.6874   12  237 -13035.004 -3933.2968  69.8%  3589  558s
  1040   551 -9570.0763   13  273 -13035.004 -3933.2968  69.8%  3685  568s
  1089   570 -9839.6379   11  359 -13035.004 -4151.4058  68.2%  3780  582s
  1140   581 -9954.0901   14  290 -13035.004 -4151.6682  68.1%  3808  597s
  1203   617 -10074.377   13  351 -13035.004 -4151.6682  68.1%  3807  611s
  1271   639 -12339.186   14  297 -13035.004 -4151.6682  68.1%  3823  626s
  1331   667 -11733.887   14  413 -13035.004 -4151.6682  68.1%  3855  639s
  1397   693 infeasible   13      -13035.004 -4151.6682  68.1%  3852  652s
  1469   729 -12109.213   16  349 -13035.004 -4400.1308  66.2%  3890  663s
  1543   753 -12272.920   17  339 -13035.004 -4400.1308  66.2%  3862  679s
  1615   768 infeasible   16      -13035.004 -4400.1308  66.2%  3892  697s
  1684   784 -6540.9664    9  515 -13035.004 -4767.0338  63.4%  3883  715s
  1766   806 -6690.8493   10  507 -13035.004 -4767.0338  63.4%  3916  732s
  1859   835 -7259.4732   11  445 -13035.004 -4767.0338  63.4%  3966  750s
  1941   861 -7754.3641   12  454 -13035.004 -4767.0338  63.4%  4015  767s
  2035   883 -8857.4771   13  454 -13035.004 -5474.7345  58.0%  4042  783s
  2103   918 -8960.3196   14  451 -13035.004 -5588.1456  57.1%  4073  800s
  2178   944 -9653.0037   15  439 -13035.004 -5588.1456  57.1%  4154  819s
  2284   978 -9975.0029   16  420 -13035.004 -5588.1456  57.1%  4195  840s
  2408  1010 -10317.803   17  495 -13035.004 -5634.4271  56.8%  4219  861s
  2559  1031 -10468.829   18  259 -13035.004 -5634.4271  56.8%  4202  882s
  2630  1060 -12853.837   19  319 -13035.004 -5800.8515  55.5%  4216  902s
  2777  1079     cutoff   20      -13035.004 -5800.8515  55.5%  4181  924s
  2919  1099     cutoff   21      -13035.004 -5800.8515  55.5%  4181  948s
  3097  1136 -12227.415   20  412 -13035.004 -5800.8515  55.5%  4212  971s
  3250  1176 -12308.325   21  430 -13035.004 -5800.8515  55.5%  4249  996s
  3381  1215 -12504.781   22  422 -13035.004 -5800.8515  55.5%  4250 1024s
  3544  1254 -12080.030   12  383 -13035.004 -6542.8426  49.8%  4279 1051s
  3728  1285     cutoff   14      -13035.004 -6542.8426  49.8%  4339 1079s
  3936  1310     cutoff   11      -13035.004 -6623.9333  49.2%  4367 1108s
  4137  1331     cutoff   13      -13035.004 -6761.9249  48.1%  4394 1137s
  4355  1374 -11938.550   10  352 -13035.004 -7096.9135  45.6%  4395 1168s
  4590  1372 infeasible   16      -13035.004 -7263.0592  44.3%  4403 1202s
  4822  1406     cutoff   16      -13035.004 -7404.5528  43.2%  4408 1233s
  5084  1435     cutoff   19      -13035.004 -7463.3385  42.7%  4424 1267s
  5336  1443 -10804.936   15  361 -13035.004 -7771.2983  40.4%  4424 1300s
  5407  1435 -10992.945   16  348 -13035.004 -7858.9817  39.7%  4443 1339s
  5623  1434 -11401.356   16  356 -13035.004 -7946.9702  39.0%  4424 1375s
  5904  1456 -11780.848   14  178 -13035.004 -8222.3186  36.9%  4438 1414s
  6173  1464 -12418.546   17  289 -13035.004 -8686.5608  33.4%  4396 1455s
  6526  1466 -12396.231   15  337 -13035.004 -8694.3540  33.3%  4365 1496s
  6900  1488 infeasible   12      -13035.004 -8799.9707  32.5%  4344 1538s
  7297  1442 -11723.362   17  360 -13035.004 -9164.6469  29.7%  4324 1583s
  7749  1410     cutoff   13      -13035.004 -9456.3035  27.5%  4286 1628s
  8160  1375 infeasible   16      -13035.004 -9766.2492  25.1%  4279 1672s
  8687  1291 -11899.186   12   95 -13035.004 -9853.3582  24.4%  4230 1718s
  9301  1139 -12494.619   10  394 -13035.004 -10116.248  22.4%  4160 1766s
  9943   912 -11933.725   16  198 -13035.004 -10590.058  18.8%  4088 1815s
 10639   636     cutoff   17      -13035.004 -10943.814  16.0%  3977 1862s
 11703   266     cutoff   17      -13035.004 -11693.335  10.3%  3787 1907s
 12908     0 -12514.532   21  388 -13035.004 -12018.105  7.80%  3563 1936s

Cutting planes:
  Implied bound: 22
  MIR: 1028
  Flow cover: 1294
  RLT: 17
  Relax-and-lift: 49

Explored 13414 nodes (46669647 simplex iterations) in 1936.32 seconds (4121.65 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -13035 -13052.2 -13100.2 ... -24008.6
No other solutions better than -13035

Optimal solution found (tolerance 1.00e-04)
Best objective -1.303500378364e+04, best bound -1.303500378364e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1936.34s
  Master Objective (UB) = -13035.00, θ = 115899.96
  Upper Bound (UB) = -13035.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115899.96
  [DEBUG]   ✓ Scenario 0: θ = 115899.96 ≤ Q = 115899.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115899.96 ≤ Q = 115899.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115899.96 ≤ Q = 115899.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115899.96 ≤ Q = 115899.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 115899.96 ≤ Q = 115899.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 115899.96 ≤ Q = 115899.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 115899.96 ≤ Q = 115899.96 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5586cec9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5586cec9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.288927e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6595682.0956
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.231132e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123113.15    0  123 6595682.10 -123113.15   102%     -    0s
H    0     0                    -90324.99651 -123113.15  36.3%     -    0s
H    0     0                    -90632.08029 -123113.15  35.8%     -    0s
     0     0 -93275.791    0   74 -90632.080 -93275.791  2.92%     -    0s
H    0     0                    -92106.84354 -93269.552  1.26%     -    0s
H    0     0                    -92224.13766 -93269.552  1.13%     -    0s
     0     0 -93076.655    0   73 -92224.138 -93076.655  0.92%     -    0s
H    0     0                    -92577.14994 -93076.655  0.54%     -    0s
     0     0 -93070.421    0   73 -92577.150 -93070.421  0.53%     -    0s
H    0     0                    -92740.95266 -93070.421  0.36%     -    0s
H    0     0                    -92741.34674 -93070.421  0.35%     -    0s
     0     0 -93070.421    0   68 -92741.347 -93070.421  0.35%     -    0s
     0     0 -93070.421    0   78 -92741.347 -93070.421  0.35%     -    0s
     0     0 -93070.421    0   78 -92741.347 -93070.421  0.35%     -    0s
     0     0 -93070.421    0   74 -92741.347 -93070.421  0.35%     -    0s
     0     0 -93070.421    0   73 -92741.347 -93070.421  0.35%     -    0s
     0     0 -92994.100    0   71 -92741.347 -92994.100  0.27%     -    0s
     0     0 -92984.053    0   72 -92741.347 -92984.053  0.26%     -    0s
     0     0 -92976.597    0   71 -92741.347 -92976.597  0.25%     -    0s
H    0     0                    -92767.20495 -92972.126  0.22%     -    0s
     0     0 -92972.126    0   72 -92767.205 -92972.126  0.22%     -    0s
     0     0 -92940.773    0   72 -92767.205 -92940.773  0.19%     -    0s
H    0     0                    -92787.64953 -92940.773  0.17%     -    0s
     0     0 -92939.251    0   72 -92787.650 -92939.251  0.16%     -    0s
     0     2 -92939.251    0   72 -92787.650 -92939.251  0.16%     -    0s
*   62    11              10    -92804.05428 -92822.981  0.02%   7.1    0s

Cutting planes:
  Gomory: 20
  Implied bound: 2
  MIR: 85
  Flow cover: 12
  RLT: 3

Explored 87 nodes (1475 simplex iterations) in 0.56 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -92804.1 -92787.6 -92767.2 ... 6.59568e+06
No other solutions better than -92804.1

Optimal solution found (tolerance 1.00e-04)
Best objective -9.280405427699e+04, best bound -9.280405427699e+04, gap 0.0000%
  Subproblem solved in 0.59s
  Worst-case operational profit (Z_SP) = 115549.75
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92804.05
  [DEBUG]   S×d_nominal = 208353.80
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208353.80 + -92804.05 = 115549.75
  [DEBUG]   Current θ from Master = 115899.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 350.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13385.21
  Lower Bound (LB) = -13385.21
  Gap (UB-LB) = 350.2106, Absolute Gap = 350.2106, Relative Gap = 0.026867
  Not converged yet (gap = 350.21 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0x4df293ec
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55064 rows and 22364 columns
Presolve time: 1.88s
Presolved: 68639 rows, 29816 columns, 427399 nonzeros
Variable types: 27557 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398721.3119
Found heuristic solution: objective -172451.4877

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68639 rows, 29816 columns, 427399 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19853   -1.7417811e+05   0.000000e+00   1.451398e+06      5s
   35459   -3.5476756e+04   0.000000e+00   4.753592e+09     10s
   44167   -8.0755337e+03   0.000000e+00   3.554629e+07     15s
   50036   -5.2975890e+03   0.000000e+00   2.628827e+07     20s
   54655   -2.9200866e+03   0.000000e+00   2.440896e+06     25s
   59226   -2.2939183e+03   0.000000e+00   1.558774e+06     30s
   63001   -2.2747989e+03   0.000000e+00   1.744858e+07     35s
   68646    4.5814658e+03   0.000000e+00   1.781339e+07     40s
   72832    5.3235352e+03   0.000000e+00   3.003842e+06     45s
   77060    6.0497160e+03   0.000000e+00   5.926190e+05     50s
   81172    6.4136350e+03   0.000000e+00   1.048089e+06     55s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 7.897676e+03, 79201 iterations, 53.88 seconds (65.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 7897.67563    0  151 -172451.49 7897.67563   105%     -   57s
H    0     0                    -158713.3069 7897.67563   105%     -   57s
H    0     0                    -137829.0618 7897.67563   106%     -   57s
H    0     0                    -130894.0243 7897.67563   106%     -   57s
H    0     0                    -122651.7638 7897.67563   106%     -   57s
H    0     0                    -64930.61098 7897.67563   112%     -   57s
H    0     0                    -27730.83794 7897.67563   128%     -   58s
H    0     0                    -24009.72186 7897.67563   133%     -   58s
H    0     0                    -23789.67011 7897.67563   133%     -   58s
H    0     0                    -23731.53644 7897.67563   133%     -   58s
H    0     0                    -23697.81700 7897.67563   133%     -   58s
H    0     0                    -23693.98896 7897.67563   133%     -   59s
     0     0 3089.77235    0  263 -23693.989 3089.77235   113%     -   83s
     0     0 2673.89411    0  286 -23693.989 2673.89411   111%     -   96s
     0     0 2672.95841    0  279 -23693.989 2672.95841   111%     -   97s
     0     0 2672.60796    0  282 -23693.989 2672.60796   111%     -   97s
     0     0  806.55594    0  287 -23693.989  806.55594   103%     -  113s
H    0     0                    -14977.94493  806.55594   105%     -  113s
     0     0  448.75886    0  346 -14977.945  448.75886   103%     -  121s
     0     0  317.38481    0  357 -14977.945  317.38481   102%     -  128s
     0     0  212.30460    0  368 -14977.945  212.30460   101%     -  135s
     0     0  205.85903    0  367 -14977.945  205.85903   101%     -  137s
     0     0  203.02565    0  360 -14977.945  203.02565   101%     -  138s
     0     0  189.16323    0  359 -14977.945  189.16323   101%     -  139s
     0     0   -4.89475    0  367 -14977.945   -4.89475   100%     -  143s
     0     0  -90.99736    0  414 -14977.945  -90.99736  99.4%     -  148s
     0     0  -91.72967    0  419 -14977.945  -91.72967  99.4%     -  150s
H    0     0                    -13183.65659  -91.72967  99.3%     -  160s
H    0     0                    -13180.97299  -91.72967  99.3%     -  160s
     0     0 -1157.3055    0  406 -13180.973 -1157.3055  91.2%     -  175s
     0     0 -1554.2309    0  420 -13180.973 -1554.2309  88.2%     -  186s
     0     0 -1682.9410    0  444 -13180.973 -1682.9410  87.2%     -  193s
     0     0 -1770.8029    0  438 -13180.973 -1770.8029  86.6%     -  199s
     0     0 -1953.8877    0  425 -13180.973 -1953.8877  85.2%     -  206s
     0     0 -1998.8469    0  491 -13180.973 -1998.8469  84.8%     -  209s
     0     0 -2057.7537    0  484 -13180.973 -2057.7537  84.4%     -  212s
     0     0 -2099.3084    0  494 -13180.973 -2099.3084  84.1%     -  216s
     0     0 -2104.9923    0  491 -13180.973 -2104.9923  84.0%     -  217s
     0     0 -2111.4000    0  488 -13180.973 -2111.4000  84.0%     -  218s
     0     0 -2113.9821    0  495 -13180.973 -2113.9821  84.0%     -  219s
     0     0 -2114.4412    0  495 -13180.973 -2114.4412  84.0%     -  219s
H    0     0                    -13172.12597 -2777.5525  78.9%     -  244s
H    0     0                    -13164.32923 -2777.5525  78.9%     -  244s
     0     0 -2777.5525    0  503 -13164.329 -2777.5525  78.9%     -  244s
     0     0 -3041.4595    0  511 -13164.329 -3041.4595  76.9%     -  255s
     0     0 -3105.0123    0  441 -13164.329 -3105.0123  76.4%     -  260s
     0     0 -3181.4024    0  455 -13164.329 -3181.4024  75.8%     -  267s
     0     0 -3198.9556    0  532 -13164.329 -3198.9556  75.7%     -  272s
     0     0 -3222.2168    0  533 -13164.329 -3222.2168  75.5%     -  278s
     0     0 -3246.9437    0  538 -13164.329 -3246.9437  75.3%     -  282s
     0     0 -3253.7225    0  538 -13164.329 -3253.7225  75.3%     -  284s
     0     0 -3261.3508    0  488 -13164.329 -3261.3508  75.2%     -  288s
     0     0 -3293.8943    0  480 -13164.329 -3293.8943  75.0%     -  292s
     0     0 -3295.7009    0  481 -13164.329 -3295.7009  75.0%     -  293s
     0     0 -3295.8049    0  482 -13164.329 -3295.8049  75.0%     -  294s
     0     0 -3453.3157    0  519 -13164.329 -3453.3157  73.8%     -  304s
     0     0 -3532.1755    0  529 -13164.329 -3532.1755  73.2%     -  308s
H    0     0                    -13071.19305 -3558.5246  72.8%     -  311s
     0     0 -3558.5246    0  530 -13071.193 -3558.5246  72.8%     -  311s
     0     0 -3560.4750    0  525 -13071.193 -3560.4750  72.8%     -  312s
     0     0 -3604.2482    0  515 -13071.193 -3604.2482  72.4%     -  314s
     0     0 -3619.6309    0  527 -13071.193 -3619.6309  72.3%     -  316s
     0     0 -3623.2402    0  515 -13071.193 -3623.2402  72.3%     -  317s
     0     0 -3625.7800    0  517 -13071.193 -3625.7800  72.3%     -  317s
     0     0 -3626.6207    0  524 -13071.193 -3626.6207  72.3%     -  318s
     0     0 -3681.5309    0  468 -13071.193 -3681.5309  71.8%     -  324s
     0     0 -3717.8446    0  456 -13071.193 -3717.8446  71.6%     -  330s
     0     0 -3719.4562    0  454 -13071.193 -3719.4562  71.5%     -  331s
     0     0 -3730.1659    0  511 -13071.193 -3730.1659  71.5%     -  334s
     0     0 -3735.6763    0  515 -13071.193 -3735.6763  71.4%     -  336s
     0     0 -3737.7747    0  522 -13071.193 -3737.7747  71.4%     -  338s
     0     0 -3740.3160    0  519 -13071.193 -3740.3160  71.4%     -  339s
     0     0 -3740.8341    0  536 -13071.193 -3740.8341  71.4%     -  340s
     0     0 -3772.3043    0  460 -13071.193 -3772.3043  71.1%     -  347s
     0     0 -3776.2629    0  454 -13071.193 -3776.2629  71.1%     -  349s
     0     0 -3776.9368    0  457 -13071.193 -3776.9368  71.1%     -  349s
     0     0 -3788.8480    0  467 -13071.193 -3788.8480  71.0%     -  353s
     0     0 -3792.6199    0  471 -13071.193 -3792.6199  71.0%     -  355s
     0     0 -3792.6199    0  471 -13071.193 -3792.6199  71.0%     -  356s
     0     0 -3794.6152    0  521 -13071.193 -3794.6152  71.0%     -  359s
     0     0 -3794.7695    0  514 -13071.193 -3794.7695  71.0%     -  359s
     0     0 -3798.2918    0  477 -13071.193 -3798.2918  70.9%     -  363s
     0     0 -3799.5936    0  481 -13071.193 -3799.5936  70.9%     -  364s
     0     0 -3801.5491    0  476 -13071.193 -3801.5491  70.9%     -  367s
     0     0 -3803.7427    0  480 -13071.193 -3803.7427  70.9%     -  369s
     0     0 -3804.5393    0  492 -13071.193 -3804.5393  70.9%     -  371s
     0     0 -3809.4193    0  490 -13071.193 -3809.4193  70.9%     -  374s
     0     0 -3811.6455    0  490 -13071.193 -3811.6455  70.8%     -  377s
     0     2 -3811.6455    0  490 -13071.193 -3811.6455  70.8%     -  422s
     1     4 -3837.0149    1  521 -13071.193 -3811.6455  70.8%  2093  426s
     3     8 -3914.5878    2  522 -13071.193 -3837.0745  70.6%  3008  437s
     7    16 -4021.8943    3  528 -13071.193 -3905.3378  70.1%  5055  451s
    15    32 -4311.0939    4  513 -13071.193 -4022.7655  69.2%  5778  466s
    31    48 -5389.6309    5  431 -13071.193 -4311.4897  67.0%  9192  492s
    47    80 -5290.8721    6  368 -13071.193 -4311.4897  67.0%  8182  517s
    79   141 -5434.3236    7  364 -13071.193 -4311.4897  67.0%  7121  546s
   140   251 -5623.7381    8  371 -13071.193 -4311.4897  67.0%  5616  566s
   252   317 -5688.2356   10  365 -13071.193 -4311.4897  67.0%  4343  582s
   334   367 -5794.3115   11  366 -13071.193 -4311.4897  67.0%  4128  599s
   404   394 -7147.6435   11  544 -13071.193 -4311.4897  67.0%  4144  612s
   478   415 -7213.3799   12  458 -13071.193 -4311.4897  67.0%  4134  627s
   558   446 -7005.7099   12  341 -13071.193 -4311.4897  67.0%  4064  641s
   611   471 -7485.3171   12  523 -13071.193 -4311.4897  67.0%  4283  654s
   645   496 -7298.0121   12  340 -13071.193 -4311.4897  67.0%  4394  665s
   687   505 -7970.0420   13  545 -13071.193 -4311.4897  67.0%  4469  679s
   734   533 -7517.8659   13  334 -13071.193 -4311.4897  67.0%  4499  692s
   780   557 -9247.7003   18  516 -13071.193 -4311.4897  67.0%  4511  705s
   826   592 -8308.5291   14  533 -13071.193 -4311.4897  67.0%  4548  717s
   893   632 -9235.9784   15  512 -13071.193 -4311.4897  67.0%  4528  731s
   957   650 -9550.5204   15  493 -13071.193 -4694.0088  64.1%  4535  745s
  1027   675 -9289.6348   16  513 -13071.193 -4742.2491  63.7%  4546  757s
  1068   701 -9316.8197   16  419 -13071.193 -4742.2491  63.7%  4608  772s
  1118   737 -10103.272   17  529 -13071.193 -4742.2491  63.7%  4632  786s
  1194   774 -10118.690   25  493 -13071.193 -4742.2491  63.7%  4563  802s
  1263   817 -10382.067   17  457 -13071.193 -4742.2491  63.7%  4575  819s
  1334   846 -11796.061   16  370 -13071.193 -4742.2491  63.7%  4568  837s
  1421   893 -10421.066   17  458 -13071.193 -4844.7188  62.9%  4548  854s
  1510   942 -10202.030   18  475 -13071.193 -4844.7188  62.9%  4533  872s
  1599  1000 -10532.226   19  390 -13071.193 -4844.7188  62.9%  4537  890s
  1710  1037 -10558.610   20  387 -13071.193 -4844.7188  62.9%  4495  905s
  1773  1105 -10619.897   21  332 -13071.193 -4844.7188  62.9%  4498  922s
  1885  1177 -11034.754   24  341 -13071.193 -4844.7188  62.9%  4492  943s
  2013  1243 -11287.927   26  402 -13071.193 -4844.7188  62.9%  4444  960s
  2143  1284 -11779.748   30  403 -13071.193 -5368.4765  58.9%  4434  983s
  2244  1318 -12018.928   29  396 -13071.193 -5604.2230  57.1%  4421 1004s
  2375  1388 -12467.709   32  185 -13071.193 -5604.2230  57.1%  4433 1024s
  2504  1474 infeasible   33      -13071.193 -5604.2230  57.1%  4465 1046s
  2678  1521 -8015.0390   12  234 -13071.193 -5604.2230  57.1%  4416 1069s
  2811  1598 -8524.1465   13  305 -13071.193 -5712.6407  56.3%  4467 1092s
  2960  1681 -11362.197   16  457 -13071.193 -5712.6407  56.3%  4512 1118s
  3148  1767 -11429.973   17  446 -13071.193 -5712.6407  56.3%  4497 1143s
  3314  1795 -11968.283   20  438 -13071.193 -6015.3537  54.0%  4490 1166s
  3398  1873 -12057.220   19  391 -13071.193 -6015.3537  54.0%  4510 1193s
  3564  1966 -12087.046   20  399 -13071.193 -6074.9751  53.5%  4523 1219s
  3757  2045 -12559.655   23  357 -13071.193 -6100.6762  53.3%  4517 1246s
  3983  2129 infeasible   27      -13071.193 -6100.6762  53.3%  4490 1277s
  4213  2199 -7783.2364   11  290 -13071.193 -6169.9979  52.8%  4452 1310s
  4394  2252 -10764.162   14  235 -13071.193 -6178.7280  52.7%  4481 1340s
  4535  2273 infeasible   16      -13071.193 -6178.7280  52.7%  4504 1370s
  4584  2315 -8052.3699   10  385 -13071.193 -6178.7280  52.7%  4515 1399s
  4718  2377 -9684.1771   12  328 -13071.193 -6178.7280  52.7%  4511 1431s
  4931  2496 -10339.331   16  451 -13071.193 -6215.5769  52.4%  4538 1470s
  5158  2497 -8754.5569   15  490 -13071.193 -6478.0366  50.4%  4559 1553s
  5160  2498 -12086.641   22  151 -13071.193 -6478.0366  50.4%  4557 1581s
  5161  2499 -11137.514   20  459 -13071.193 -6478.0366  50.4%  4556 1620s
  5162  2500 -11935.781   33  477 -13071.193 -6478.0366  50.4%  4555 1648s
  5163  2500 -7453.8537   13  506 -13071.193 -6478.0366  50.4%  4554 1666s
  5164  2501 -12672.079   23  506 -13071.193 -6478.0366  50.4%  4554 1685s
  5165  2502 -8570.5799   13  521 -13071.193 -6478.0366  50.4%  4553 1696s
  5166  2502 -9038.2162   10  541 -13071.193 -6478.0366  50.4%  4552 1705s
  5167  2503 -11517.251   13  543 -13071.193 -6478.0366  50.4%  4551 1711s
  5168  2504 -11225.795    9  471 -13071.193 -6478.0366  50.4%  4550 1716s
  5169  2504 -11624.048   12  481 -13071.193 -6478.0366  50.4%  4549 1723s
  5170  2505 -11219.880   19  491 -13071.193 -6478.0366  50.4%  4548 1733s
  5171  2506 -7992.7826    7  465 -13071.193 -6478.0366  50.4%  4547 1762s
  5172  2506 -12659.010   25  648 -13071.193 -6478.0366  50.4%  4547 1776s
  5173  2507 -12284.682   24  537 -13071.193 -6478.0366  50.4%  4546 1785s
  5174  2508 -12568.261   28  482 -13071.193 -6478.0366  50.4%  4545 1792s
  5175  2508 -11375.684   15  535 -13071.193 -6478.0366  50.4%  4544 1816s
  5176  2509 -12641.999   26  533 -13071.193 -6478.0366  50.4%  4543 1830s
  5177  2510 -11279.517   17  593 -13071.193 -6478.0366  50.4%  4542 1839s
  5178  2510 -11300.325   21  543 -13071.193 -6478.0366  50.4%  4541 1846s
  5179  2511 -11951.140   16  536 -13071.193 -6478.0366  50.4%  4540 1854s
  5180  2512 -9037.6623    9  469 -13071.193 -6478.0366  50.4%  4539 1859s
  5181  2512 -6693.7121   12  470 -13071.193 -6478.0366  50.4%  4539 1862s
  5182  2513 -12682.276   25  429 -13071.193 -6478.0366  50.4%  4538 1869s
  5183  2514 -6818.4350    6  487 -13071.193 -6478.0366  50.4%  4537 1873s
  5184  2514 -10160.461   11  494 -13071.193 -6478.0366  50.4%  4536 1886s
  5185  2515 -12880.602   29  545 -13071.193 -6478.0366  50.4%  4535 1890s
  5187  2516 -11751.711   17  533 -13071.193 -6478.0366  50.4%  4533 1898s
  5188  2517 -12706.014   23  521 -13071.193 -6478.0366  50.4%  4532 1904s
  5189  2518 -8501.9851   10  346 -13071.193 -6478.0366  50.4%  4532 1907s
  5190  2518 -11002.601    9  493 -13071.193 -6478.0366  50.4%  4531 1911s
  5192  2520 -10672.972   33  490 -13071.193 -6478.0366  50.4%  4529 1916s
  5193  2520 -12693.392   12  490 -13071.193 -6478.0366  50.4%  4528 1945s
  5194  2521 -12754.201   29  490 -13071.193 -6478.0366  50.4%  4527 1967s
  5195  2525 -6478.0366   15  467 -13071.193 -6478.0366  50.4%  4576 2016s
  5197  2528 -6478.0366   16  413 -13071.193 -6478.0366  50.4%  4577 2035s
  5201  2535 -6478.0366   17  519 -13071.193 -6478.0366  50.4%  4578 2058s
  5209  2548 -6478.0366   18  513 -13071.193 -6478.0366  50.4%  4583 2077s
  5225  2560 -11488.689   19  248 -13071.193 -6478.0366  50.4%  4611 2113s
  5242  2584 -7163.7877   20  374 -13071.193 -6478.0366  50.4%  4626 2144s
  5274  2616 -9045.1412   21  395 -13071.193 -6478.0366  50.4%  4629 2178s
  5384  2581 -10743.492   23  369 -13071.193 -6478.0366  50.4%  4610 2200s
  5461  2605 -11938.516   23  367 -13071.193 -6478.0366  50.4%  4593 2218s
  5530  2623 -11154.461   24  422 -13071.193 -6478.0366  50.4%  4574 2238s
  5599  2621 -11924.992   25  374 -13071.193 -6478.0366  50.4%  4558 2254s
  5658  2608 -11628.194   26  282 -13071.193 -6478.0366  50.4%  4536 2276s
  5725  2599 -12353.597   30  210 -13071.193 -6478.0366  50.4%  4512 2294s
  5811  2570 -12569.432   35  318 -13071.193 -6478.0366  50.4%  4473 2311s
  5882  2547 -10162.807   22  545 -13071.193 -6478.0366  50.4%  4452 2326s
  5919  2538 -10313.290   23  540 -13071.193 -6478.0366  50.4%  4448 2343s
  5965  2535 -10789.992   24  547 -13071.193 -6478.0366  50.4%  4441 2358s
  5997  2542 -11117.273   25  461 -13071.193 -6478.0366  50.4%  4434 2374s
  6037  2539 -11444.030   25  180 -13071.193 -6478.0366  50.4%  4432 2388s
  6069  2536 -11162.573   26  452 -13071.193 -6478.0366  50.4%  4430 2407s
  6102  2537 -11548.503   27  514 -13071.193 -6478.0366  50.4%  4425 2427s
  6144  2536 -11549.210   28  515 -13071.193 -6478.0366  50.4%  4413 2442s
  6181  2540 -11629.778   29  460 -13071.193 -6478.0366  50.4%  4404 2457s
  6215  2544     cutoff   30      -13071.193 -6478.0366  50.4%  4398 2476s
  6246  2539 -11917.498   29  508 -13071.193 -6478.0366  50.4%  4390 2493s
  6285  2524     cutoff   30      -13071.193 -6478.0366  50.4%  4384 2511s
  6321  2526 -12264.693   30  478 -13071.193 -6478.0366  50.4%  4384 2531s
  6359  2518 -12681.219   32  423 -13071.193 -6478.0366  50.4%  4381 2549s
  6410  2511 -12805.761   36  303 -13071.193 -6478.0366  50.4%  4373 2567s
  6465  2508     cutoff   37      -13071.193 -6478.0366  50.4%  4374 2587s
  6526  2526 -8672.5930   20  333 -13071.193 -6478.0366  50.4%  4369 2608s
  6598  2528 -8764.8322   21  333 -13071.193 -6478.0366  50.4%  4352 2628s
  6677  2524 -10991.139   24  359 -13071.193 -6478.0366  50.4%  4336 2658s
  6756  2507 -11954.155   26  365 -13071.193 -6478.0366  50.4%  4328 2683s
  6866  2488     cutoff   32      -13071.193 -6483.4611  50.4%  4308 2712s
  6962  2514 -11748.084   28  380 -13071.193 -6483.4611  50.4%  4304 2736s
  7066  2509 -12513.983   31  330 -13071.193 -6483.4611  50.4%  4292 2765s
  7193  2491     cutoff   35      -13071.193 -6483.4611  50.4%  4268 2796s
  7301  2467 -11965.368   24  408 -13071.193 -6483.4611  50.4%  4260 2835s
  7413  2468 -12361.484   25  376 -13071.193 -6483.4611  50.4%  4257 2865s
  7531  2440 -12640.773   27  373 -13071.193 -6483.4611  50.4%  4250 2900s
  7654  2402 -12764.806   28  383 -13071.193 -6483.4611  50.4%  4244 2945s
  7781  2418 -11920.446   27  330 -13071.193 -6483.4611  50.4%  4240 2983s
  7923  2375     cutoff   31      -13071.193 -6483.4611  50.4%  4224 3022s
  8059  2352 infeasible   28      -13071.193 -8603.6178  34.2%  4218 3065s
  8199  2330 -10842.658   24  284 -13071.193 -8934.1945  31.6%  4213 3113s
  8339  2298 -12052.701   30  225 -13071.193 -8934.1945  31.6%  4210 3153s
  8522  2263     cutoff   25      -13071.193 -9519.1524  27.2%  4190 3200s
  8696  2200 -12871.101   26  341 -13071.193 -9959.7290  23.8%  4179 3235s
  8809  2164     cutoff   26      -13071.193 -9990.0875  23.6%  4176 3275s
  8863  2160 -11341.689   26  499 -13071.193 -9990.0875  23.6%  4177 3316s
  8941  2122 -12010.463   27  504 -13071.193 -9990.0875  23.6%  4168 3359s
  9084  2089 -12085.277   28  411 -13071.193 -10442.400  20.1%  4154 3405s
  9259  2060 infeasible   30      -13071.193 -10512.778  19.6%  4146 3460s
  9499  1985 -12894.248   34  253 -13071.193 -10533.816  19.4%  4123 3516s
  9761  1902 -12721.928   29  266 -13071.193 -10781.919  17.5%  4098 3570s
 10013  1835 -12549.704   27  353 -13071.193 -10853.931  17.0%  4081 3600s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 663
  Flow cover: 1492
  RLT: 13
  Relax-and-lift: 87

Explored 10213 nodes (41664089 simplex iterations) in 3600.11 seconds (6586.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -13071.2 -13164.3 -13172.1 ... -23789.7

Time limit reached
Best objective -1.307119305201e+04, best bound -1.085393126467e+04, gap 16.9630%
  WARNING: Time limit reached. Using best solution found (gap: 16.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = -13071.19, θ = 115863.77
  Upper Bound (UB) = -13071.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 115863.77
  [DEBUG]   ✓ Scenario 0: θ = 115863.77 ≤ Q = 115863.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 115863.77 ≤ Q = 115863.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 115863.77 ≤ Q = 115863.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 115863.77 ≤ Q = 115863.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 115863.77 ≤ Q = 115863.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 115863.77 ≤ Q = 115863.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 115863.77 ≤ Q = 115863.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 115863.77 ≤ Q = 115863.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7d747756
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x828b88aa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-15, 2e+02]
Found heuristic solution: objective 1.288927e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.01s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6600486.2088
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.227976e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122797.57    0  123 6600486.21 -122797.57   102%     -    0s
H    0     0                    -90022.57939 -122797.57  36.4%     -    0s
H    0     0                    -90329.66316 -122797.57  35.9%     -    0s
     0     0 -92678.525    0   68 -90329.663 -92678.525  2.60%     -    0s
H    0     0                    -92101.79898 -92611.290  0.55%     -    0s
     0     0 -92564.538    0   36 -92101.799 -92564.538  0.50%     -    0s
     0     0 -92532.718    0   36 -92101.799 -92532.718  0.47%     -    0s
     0     0 -92528.796    0   36 -92101.799 -92528.796  0.46%     -    0s
     0     0 -92528.796    0   68 -92101.799 -92528.796  0.46%     -    0s
     0     0 -92528.796    0   71 -92101.799 -92528.796  0.46%     -    0s
     0     0 -92518.601    0   35 -92101.799 -92518.601  0.45%     -    0s
     0     0 -92502.222    0   35 -92101.799 -92502.222  0.43%     -    0s
     0     0 -92464.010    0   34 -92101.799 -92464.010  0.39%     -    0s
     0     0 -92453.715    0   34 -92101.799 -92453.715  0.38%     -    0s
     0     0 -92451.691    0   34 -92101.799 -92451.691  0.38%     -    0s
     0     0 -92423.547    0   34 -92101.799 -92423.547  0.35%     -    0s
     0     0 -92422.789    0   34 -92101.799 -92422.789  0.35%     -    0s
     0     2 -92422.789    0   34 -92101.799 -92422.789  0.35%     -    0s
H   33    13                    -92164.06055 -92247.826  0.09%   9.7    0s
*   45     9               7    -92164.49517 -92227.886  0.07%   8.2    0s

Cutting planes:
  Gomory: 9
  Implied bound: 3
  MIR: 93
  Flow cover: 10

Explored 70 nodes (1347 simplex iterations) in 0.23 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -92164.5 -92164.1 -92101.8 ... 1.28893e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -9.216449516918e+04, best bound -9.217128494277e+04, gap 0.0074%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 115850.70
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92164.50
  [DEBUG]   S×d_nominal = 208015.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 208015.20 + -92164.50 = 115850.70
  [DEBUG]   Current θ from Master = 115863.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13.07 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13084.26
  Lower Bound (LB) = -13084.26
  Gap (UB-LB) = 13.0687, Absolute Gap = 13.0687, Relative Gap = 0.001000
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 8
Total Time: 10589.68s
Converged: True
Final Lower Bound: -13084.2617
Final Upper Bound: -13071.1931
Final Gap: 13.068660
Number of Critical Scenarios: 8
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 5, 7] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 4 customers  Mode 1: 6 customers  Mode 2: 40 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 8
Start Time: 2026-01-04 12:31:24
End Time: 2026-01-04 15:27:54
Total Time: 10589.68s
Optimal Value: -13084.26
Lower Bound: -13084.26
Upper Bound: -13071.19
Gap: 13.068660
Plants Opened: {0: [2], 1: [1], 2: [1]} (3 plants)
DCs Opened: [0, 5, 7] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed23_LD_gamma20_20260104_152754.csv

Total Execution Time: 10590.23 seconds
End Time: 2026-01-04 15:27:54

All tasks completed successfully!

