
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 47
DI Scenario: MD
Start Time: 2026-01-06 03:02:48
================================================================================
Loading data from data/DH_data_full_seed47.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.209', '1.462'] (k=0.468)
  Product 1: ['1.000', '1.310', '1.716'] (k=0.666)
  Product 2: ['1.000', '1.269', '1.609'] (k=0.587)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=982, max=1479
  DC capacity (MC): min=405, max=871

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.18, max=34.85, count=80
  Deviation (μ̂): min=4.02, max=10.00

Costs:
  Plant fixed cost: min=5196, max=9410
  DC fixed cost: min=3328, max=5650
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.460', '2.133'] (k=0.934)
    Product 1: ['1.000', '1.484', '2.201'] (k=0.973)
    Product 2: ['1.000', '1.467', '2.152'] (k=0.945)
  MD:
    Product 0: ['1.000', '1.209', '1.462'] (k=0.468)
    Product 1: ['1.000', '1.310', '1.716'] (k=0.666)
    Product 2: ['1.000', '1.269', '1.609'] (k=0.587)
  LD:
    Product 0: ['1.000', '1.044', '1.090'] (k=0.107)
    Product 1: ['1.000', '1.116', '1.246'] (k=0.271)
    Product 2: ['1.000', '1.067', '1.139'] (k=0.161)
  Mixed:
    Product 0: ['1.000', '1.460', '2.133'] (k=0.934)
    Product 1: ['1.000', '1.310', '1.716'] (k=0.666)
    Product 2: ['1.000', '1.067', '1.139'] (k=0.161)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x10f39879
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 1e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.08s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -261153.2609
Found heuristic solution: objective -184137.6522

Root relaxation: objective 1.107000e+05, 4859 iterations, 0.18 seconds (0.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 110700.029    0  542 -184137.65 110700.029   160%     -    0s
H    0     0                    -182042.9239 110700.029   161%     -    0s
H    0     0                    -177682.6802 98133.8115   155%     -    0s
     0     0 98133.8115    0  843 -177682.68 98133.8115   155%     -    0s
     0     0 98038.9569    0  843 -177682.68 98038.9569   155%     -    1s
     0     0 98037.8481    0  856 -177682.68 98037.8481   155%     -    1s
     0     0 93168.9223    0  965 -177682.68 93168.9223   152%     -    1s
H    0     0                    -153820.4385 92894.7250   160%     -    2s
     0     0 92894.7250    0  944 -153820.44 92894.7250   160%     -    2s
     0     0 92891.8517    0  948 -153820.44 92891.8517   160%     -    2s
     0     0 89127.0467    0 1058 -153820.44 89127.0467   158%     -    3s
H    0     0                    -137818.4260 88712.2158   164%     -    3s
     0     0 88712.2158    0 1082 -137818.43 88712.2158   164%     -    3s
     0     0 88633.3936    0 1093 -137818.43 88633.3936   164%     -    3s
     0     0 88624.0129    0 1097 -137818.43 88624.0129   164%     -    3s
     0     0 88620.1319    0 1092 -137818.43 88620.1319   164%     -    3s
H    0     0                    -119873.0620 88620.1319   174%     -    4s
H    0     0                    -119839.3523 88620.1319   174%     -    4s
H    0     0                    -107993.2359 88620.1319   182%     -    4s
H    0     0                    -105592.7840 88620.1319   184%     -    4s
H    0     0                    -70245.43260 88620.1319   226%     -    4s
H    0     0                    14907.830315 88620.1319   494%     -    4s
H    0     0                    15050.314637 85728.5177   470%     -    5s
H    0     0                    15183.857375 85728.5177   465%     -    5s
H    0     0                    15188.826629 85728.5177   464%     -    5s
H    0     0                    15268.382845 85728.5177   461%     -    5s
     0     0 85728.5177    0 1055 15268.3828 85728.5177   461%     -    5s
H    0     0                    15276.230090 85359.0040   459%     -    6s
H    0     0                    15283.315515 85359.0040   459%     -    6s
H    0     0                    15626.527423 85359.0040   446%     -    6s
H    0     0                    15775.947758 85359.0040   441%     -    6s
H    0     0                    15897.914680 85359.0040   437%     -    6s
H    0     0                    25467.119659 85359.0040   235%     -    6s
H    0     0                    25566.232259 85359.0040   234%     -    6s
H    0     0                    25641.061461 85359.0040   233%     -    6s
H    0     0                    25654.050767 85359.0040   233%     -    6s
H    0     0                    25685.318178 85359.0040   232%     -    6s
H    0     0                    25798.271801 85359.0040   231%     -    6s
H    0     0                    26002.812936 85359.0040   228%     -    6s
     0     0 85359.0040    0 1103 26002.8129 85359.0040   228%     -    6s
     0     0 85291.4954    0 1051 26002.8129 85291.4954   228%     -    6s
     0     0 85282.3766    0 1103 26002.8129 85282.3766   228%     -    6s
H    0     0                    26270.845827 83755.3454   219%     -    7s
H    0     0                    27102.039795 83755.3454   209%     -    7s
H    0     0                    27125.901403 83755.3454   209%     -    7s
H    0     0                    27408.278343 83755.3454   206%     -    7s
H    0     0                    27500.673152 83755.3454   205%     -    7s
H    0     0                    27602.010491 83755.3454   203%     -    7s
H    0     0                    27698.407850 83755.3454   202%     -    7s
H    0     0                    31201.425939 83755.3454   168%     -    7s
H    0     0                    31472.487962 83755.3454   166%     -    7s
H    0     0                    31544.035946 83755.3454   166%     -    7s
H    0     0                    31712.614641 83755.3454   164%     -    7s
H    0     0                    32521.969285 83755.3454   158%     -    7s
H    0     0                    32589.047786 83755.3454   157%     -    7s
H    0     0                    32618.184619 83755.3454   157%     -    7s
H    0     0                    32620.464640 83755.3454   157%     -    7s
H    0     0                    32686.376581 83755.3454   156%     -    7s
H    0     0                    32786.143152 83755.3454   155%     -    7s
H    0     0                    32853.221653 83755.3454   155%     -    7s
     0     0 83755.3454    0 1089 32853.2217 83755.3454   155%     -    7s
     0     0 83418.1934    0 1130 32853.2217 83418.1934   154%     -    7s
     0     0 83348.8215    0 1148 32853.2217 83348.8215   154%     -    7s
     0     0 83328.4875    0 1165 32853.2217 83328.4875   154%     -    8s
     0     0 83326.2477    0 1154 32853.2217 83326.2477   154%     -    8s
     0     0 81977.9334    0 1081 32853.2217 81977.9334   150%     -    9s
     0     0 81584.3352    0 1116 32853.2217 81584.3352   148%     -    9s
H    0     0                    32899.479760 81467.7750   148%     -   10s
     0     0 81467.7750    0 1146 32899.4798 81467.7750   148%     -   10s
     0     0 81446.6480    0 1159 32899.4798 81446.6480   148%     -   10s
     0     0 81444.6342    0 1173 32899.4798 81444.6342   148%     -   10s
H    0     0                    32900.419975 81444.6342   148%     -   10s
H    0     0                    33710.376133 80587.4274   139%     -   11s
H    0     0                    34686.339099 80587.4274   132%     -   11s
H    0     0                    34709.931023 80587.4274   132%     -   11s
H    0     0                    34948.430436 80587.4274   131%     -   11s
     0     0 80587.4274    0 1077 34948.4304 80587.4274   131%     -   11s
H    0     0                    35156.035328 80395.3667   129%     -   12s
H    0     0                    35580.145061 80395.3667   126%     -   12s
H    0     0                    35683.228367 80395.3667   125%     -   12s
H    0     0                    35834.688436 80395.3667   124%     -   12s
H    0     0                    35847.018019 80395.3667   124%     -   12s
H    0     0                    35900.087989 80395.3667   124%     -   12s
     0     0 80395.3667    0 1127 35900.0880 80395.3667   124%     -   12s
H    0     0                    35907.493519 80346.7316   124%     -   13s
     0     0 80346.7316    0 1142 35907.4935 80346.7316   124%     -   13s
     0     0 80326.2705    0 1139 35907.4935 80326.2705   124%     -   13s
H    0     0                    35982.688132 78929.3227   119%     -   15s
H    0     0                    35988.080199 78929.3227   119%     -   15s
     0     0 78929.3227    0 1029 35988.0802 78929.3227   119%     -   15s
     0     0 78600.4080    0 1087 35988.0802 78600.4080   118%     -   16s
     0     0 78511.4648    0 1097 35988.0802 78511.4648   118%     -   16s
     0     0 78484.2478    0 1121 35988.0802 78484.2478   118%     -   16s
     0     0 78476.4675    0 1139 35988.0802 78476.4675   118%     -   16s
H    0     0                    38354.063578 78476.4675   105%     -   16s
H    0     0                    38376.083793 76343.5023  98.9%     -   18s
H    0     0                    38684.101111 76343.5023  97.4%     -   18s
     0     0 76343.5023    0  936 38684.1011 76343.5023  97.4%     -   18s
H    0     0                    38897.636288 75950.3384  95.3%     -   19s
H    0     0                    39623.324730 75950.3384  91.7%     -   19s
H    0     0                    40369.001612 75950.3384  88.1%     -   19s
H    0     0                    40439.938540 75950.3384  87.8%     -   19s
H    0     0                    40550.817639 75950.3384  87.3%     -   19s
     0     0 75950.3384    0  962 40550.8176 75950.3384  87.3%     -   19s
H    0     0                    42179.057241 75871.5663  79.9%     -   20s
H    0     0                    43012.152628 75871.5663  76.4%     -   20s
     0     0 75871.5663    0 1077 43012.1526 75871.5663  76.4%     -   20s
H    0     0                    43200.563170 75845.7826  75.6%     -   20s
H    0     0                    43336.296748 75845.7826  75.0%     -   20s
H    0     0                    43574.585018 75845.7826  74.1%     -   20s
     0     0 75845.7826    0  973 43574.5850 75845.7826  74.1%     -   20s
     0     0 69955.5067    0  872 43574.5850 69955.5067  60.5%     -   22s
H    0     0                    43818.687760 69264.8121  58.1%     -   23s
     0     0 69264.8121    0  888 43818.6878 69264.8121  58.1%     -   23s
     0     0 69157.2218    0  897 43818.6878 69157.2218  57.8%     -   23s
     0     0 69131.7689    0  923 43818.6878 69131.7689  57.8%     -   23s
H    0     0                    43881.934704 64359.9953  46.7%     -   25s
H    0     0                    43952.447142 64359.9953  46.4%     -   25s
H    0     0                    44011.257666 64359.9953  46.2%     -   25s
     0     0 64359.9953    0  566 44011.2577 64359.9953  46.2%     -   25s
     0     0 63590.3834    0  599 44011.2577 63590.3834  44.5%     -   25s
     0     0 63382.5585    0  540 44011.2577 63382.5585  44.0%     -   26s
     0     0 63316.2423    0  611 44011.2577 63316.2423  43.9%     -   26s
     0     0 63297.7556    0  640 44011.2577 63297.7556  43.8%     -   26s
     0     0 61748.9616    0  687 44011.2577 61748.9616  40.3%     -   27s
     0     0 61373.8683    0  751 44011.2577 61373.8683  39.5%     -   27s
H    0     0                    44013.432048 61300.6022  39.3%     -   27s
     0     0 61300.6022    0  594 44013.4320 61300.6022  39.3%     -   27s
     0     0 61283.3656    0  657 44013.4320 61283.3656  39.2%     -   27s
     0     0 60607.4200    0  737 44013.4320 60607.4200  37.7%     -   28s
     0     0 60406.6136    0  662 44013.4320 60406.6136  37.2%     -   29s
     0     0 60348.9447    0  719 44013.4320 60348.9447  37.1%     -   29s
     0     0 60326.6918    0  700 44013.4320 60326.6918  37.1%     -   29s
H    0     0                    44081.992416 59620.8394  35.2%     -   30s
     0     0 59620.8394    0  609 44081.9924 59620.8394  35.2%     -   30s
     0     0 59460.8515    0  689 44081.9924 59460.8515  34.9%     -   30s
     0     0 59369.6853    0  717 44081.9924 59369.6853  34.7%     -   30s
     0     0 59347.3037    0  709 44081.9924 59347.3037  34.6%     -   30s
     0     0 59076.2893    0  719 44081.9924 59076.2893  34.0%     -   31s
     0     0 58996.5828    0  737 44081.9924 58996.5828  33.8%     -   31s
     0     0 58977.1307    0  715 44081.9924 58977.1307  33.8%     -   32s
     0     0 58839.1785    0  698 44081.9924 58839.1785  33.5%     -   32s
     0     0 58839.0966    0  698 44081.9924 58839.0966  33.5%     -   32s
     0     2 58838.7313    0  698 44081.9924 58838.7313  33.5%     -   33s
     3     8 57436.7216    2  527 44081.9924 58786.3194  33.4%  2283   35s
   356   393 52665.3773   13  399 44081.9924 58281.4464  32.2%   770   40s
H  388   393                    45807.142826 58281.4464  27.2%   730   40s
H  494   489                    45950.869074 58281.4464  26.8%   684   41s
H  702   652                    45959.274222 57858.1909  25.9%   566   42s
   913   874 51391.6046   22  347 45959.2742 57287.1791  24.6%   503   45s
H 1254  1074                    45988.001665 55850.1145  21.4%   464   47s
H 1260  1074                    45989.592745 55850.1145  21.4%   464   47s
  1851  1439 47198.1538   43  296 45989.5927 55507.5081  20.7%   400   50s
H 1873  1439                    46012.564392 55507.5081  20.6%   401   50s
H 2797  1986                    46148.537243 54309.4729  17.7%   372   54s
H 3020  2195                    46179.366485 54309.4729  17.6%   364   55s
H 3135  2185                    46337.688468 54037.7666  16.6%   360   55s
  4415  2728 infeasible   17      46337.6885 53744.8117  16.0%   340   60s
* 4646  2789              40    46353.417696 53744.8117  15.9%   338   61s
  4937  2893 48932.3480   13  698 46353.4177 53744.8117  15.9%   337   69s
  4941  2896 47347.7922   17  254 46353.4177 53744.8117  15.9%   337   70s
  5207  2948 52239.5192   18  203 46353.4177 53087.8037  14.5%   340   75s
H 5516  2702                    46363.100039 52221.9443  12.6%   332   76s

Cutting planes:
  Implied bound: 4
  Projected implied bound: 9
  MIR: 150
  Flow cover: 297
  RLT: 8
  Relax-and-lift: 63

Explored 5917 nodes (2000658 simplex iterations) in 77.59 seconds (162.93 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 46363.1 46353.4 46337.7 ... 45950.9

Optimal solution found (tolerance 1.00e-04)
Best objective 4.636310003930e+04, best bound 4.636310003930e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 77.59s
  Master Objective (UB) = 46363.10, θ = 190502.92
  Upper Bound (UB) = 46363.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190502.92
  [DEBUG]   ✓ Scenario 0: θ = 190502.92 ≤ Q = 190502.92 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4d73b9b5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb28c464b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.350939e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6692025.9456
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.480660e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148065.96    0  123 6692025.95 -148065.96   102%     -    0s
H    0     0                    -113634.4915 -148065.96  30.3%     -    0s
H    0     0                    -113935.8495 -148065.96  30.0%     -    0s
H    0     0                    -114563.7672 -148065.96  29.2%     -    0s
*    0     0               0    -116864.2055 -116864.21  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 203

Explored 1 nodes (365 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -116864 -114564 -113936 ... 1.35094e+13
No other solutions better than -116864

Optimal solution found (tolerance 1.00e-04)
Best objective -1.168642054949e+05, best bound -1.168642054949e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 157639.26
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116864.21
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -116864.21 = 157639.26
  [DEBUG]   Current θ from Master = 190502.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32863.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13499.44
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 32863.6641, Absolute Gap = 32863.6641, Relative Gap = 0.708832
  Not converged yet (gap = 32863.66 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x00eeeced
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 13499.4 (0.01s)
MIP start from previous solve produced solution with objective 13499.4 (0.01s)
Loaded MIP start from previous solve with objective 13499.4

Presolve removed 14201 rows and 5760 columns
Presolve time: 0.31s
Presolved: 17762 rows, 8980 columns, 98298 nonzeros
Variable types: 6721 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.349789e+04, 8829 iterations, 0.82 seconds (1.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53497.8864    0  272 13499.4359 53497.8864   296%     -    1s
H    0     0                    13651.814119 53497.8864   292%     -    1s
     0     0 44944.1189    0  441 13651.8141 44944.1189   229%     -    2s
H    0     0                    13865.154953 44940.7385   224%     -    2s
     0     0 44712.3466    0  449 13865.1550 44712.3466   222%     -    2s
     0     0 44657.5769    0  487 13865.1550 44657.5769   222%     -    2s
     0     0 44657.5769    0  487 13865.1550 44657.5769   222%     -    2s
     0     0 37764.0713    0  473 13865.1550 37764.0713   172%     -    4s
H    0     0                    13999.707001 37284.3438   166%     -    4s
     0     0 37284.3438    0  462 13999.7070 37284.3438   166%     -    4s
     0     0 37100.8312    0  464 13999.7070 37100.8312   165%     -    5s
     0     0 37082.6785    0  453 13999.7070 37082.6785   165%     -    5s
     0     0 37064.7757    0  457 13999.7070 37064.7757   165%     -    5s
     0     0 37064.5302    0  460 13999.7070 37064.5302   165%     -    5s
H    0     0                    19280.008977 33456.2933  73.5%     -    7s
H    0     0                    19430.076766 33456.2933  72.2%     -    7s
H    0     0                    19504.173859 33456.2933  71.5%     -    7s
H    0     0                    19676.084499 33456.2933  70.0%     -    7s
H    0     0                    19676.666319 33456.2933  70.0%     -    7s
H    0     0                    19760.930846 33456.2933  69.3%     -    7s
H    0     0                    19789.870453 33456.2933  69.1%     -    7s
H    0     0                    19798.299433 33456.2933  69.0%     -    7s
     0     0 33456.2933    0  552 19798.2994 33456.2933  69.0%     -    7s
H    0     0                    19869.931916 33453.4004  68.4%     -    7s
H    0     0                    19881.672034 33453.4004  68.3%     -    7s
H    0     0                    20059.088946 32813.9109  63.6%     -    8s
H    0     0                    20087.522374 32813.9109  63.4%     -    8s
H    0     0                    20337.391157 32813.9109  61.3%     -    8s
H    0     0                    20867.698291 32813.9109  57.2%     -    8s
H    0     0                    20887.501199 32813.9109  57.1%     -    8s
H    0     0                    20948.349845 32813.9109  56.6%     -    8s
H    0     0                    21017.466816 32813.9109  56.1%     -    8s
H    0     0                    21051.094297 32813.9109  55.9%     -    8s
H    0     0                    21102.730341 32813.9109  55.5%     -    8s
     0     0 32813.9109    0  587 21102.7303 32813.9109  55.5%     -    8s
     0     0 32642.6544    0  537 21102.7303 32642.6544  54.7%     -    8s
     0     0 32593.5477    0  538 21102.7303 32593.5477  54.5%     -    8s
     0     0 32588.2597    0  542 21102.7303 32588.2597  54.4%     -    8s
     0     0 32588.2248    0  546 21102.7303 32588.2248  54.4%     -    8s
H    0     0                    21469.179477 32588.2248  51.8%     -    9s
H    0     0                    21575.565001 32588.2248  51.0%     -    9s
H    0     0                    21601.253680 32588.2248  50.9%     -    9s
     0     0 31081.7797    0  583 21601.2537 31081.7797  43.9%     -   10s
     0     0 30652.2155    0  583 21601.2537 30652.2155  41.9%     -   11s
H    0     0                    21603.104547 30546.9360  41.4%     -   12s
     0     0 30546.9360    0  605 21603.1045 30546.9360  41.4%     -   12s
     0     0 30491.3718    0  597 21603.1045 30491.3718  41.1%     -   12s
     0     0 30467.9390    0  598 21603.1045 30467.9390  41.0%     -   12s
     0     0 30458.5505    0  603 21603.1045 30458.5505  41.0%     -   12s
     0     0 30455.5537    0  614 21603.1045 30455.5537  41.0%     -   12s
     0     0 29805.1540    0  469 21603.1045 29805.1540  38.0%     -   13s
     0     0 29701.8301    0  588 21603.1045 29701.8301  37.5%     -   14s
     0     0 29677.2155    0  473 21603.1045 29677.2155  37.4%     -   14s
     0     0 29656.1343    0  473 21603.1045 29656.1343  37.3%     -   14s
     0     0 29653.6378    0  466 21603.1045 29653.6378  37.3%     -   14s
H    0     0                    21616.858712 29384.1338  35.9%     -   15s
     0     0 29384.1338    0  637 21616.8587 29384.1338  35.9%     -   15s
     0     0 29261.3684    0  652 21616.8587 29261.3684  35.4%     -   16s
     0     0 29236.3129    0  661 21616.8587 29236.3129  35.2%     -   16s
     0     0 29230.2798    0  666 21616.8587 29230.2798  35.2%     -   16s
H    0     0                    21908.012021 29072.2346  32.7%     -   17s
H    0     0                    22014.833396 29072.2346  32.1%     -   17s
     0     0 29072.2346    0  438 22014.8334 29072.2346  32.1%     -   17s
H    0     0                    22160.791769 29071.7184  31.2%     -   17s
     0     0 29053.4025    0  448 22160.7918 29053.4025  31.1%     -   17s
     0     0 29046.2925    0  430 22160.7918 29046.2925  31.1%     -   17s
     0     0 29031.1751    0  431 22160.7918 29031.1751  31.0%     -   17s
H    0     0                    22341.110488 29031.0541  29.9%     -   17s
H    0     0                    22372.378590 29031.0541  29.8%     -   18s
H    0     0                    22449.551133 29031.0541  29.3%     -   18s
     0     0 29028.6682    0  437 22449.5511 29028.6682  29.3%     -   18s
     0     0 28984.6559    0  416 22449.5511 28984.6559  29.1%     -   18s
     0     0 28982.7603    0  416 22449.5511 28982.7603  29.1%     -   18s
H    0     0                    22581.709808 28982.7233  28.3%     -   22s
     0     2 28982.7233    0  416 22581.7098 28982.7233  28.3%     -   23s
    15    32 27707.3813    4  280 22581.7098 28771.4278  27.4%  1047   25s
H   33    52                    22618.242227 28603.6986  26.5%  1067   26s
H   46    52                    22622.433367 28601.8653  26.4%   996   26s
H   95   140                    22660.558838 28068.8690  23.9%   981   28s
H  100   140                    22699.679739 28068.8690  23.7%   947   28s
H  106   140                    22753.864784 28068.8690  23.4%   937   28s
   305   249 24939.4970   13  279 22753.8648 28058.1954  23.3%   560   30s
H  353   259                    22777.960941 28058.1954  23.2%   531   30s
   928   523 25425.6354   19  260 22777.9609 27089.5382  18.9%   383   35s
  1936   924     cutoff   55      22777.9609 26707.6201  17.3%   286   40s
H 1938   924                    22809.387222 26707.6201  17.1%   286   40s
H 1994   924                    22814.057806 26707.6201  17.1%   286   40s
  2990  1071     cutoff   17      22814.0578 25877.9456  13.4%   265   45s
H 3233  1060                    22832.327005 25543.3975  11.9%   263   46s
  4515  1411 22957.4099   51   49 22832.3270 25086.3433  9.87%   233   50s
  6260  1650     cutoff   22      22832.3270 24556.5433  7.55%   199   55s
H 6504  1673                    22834.222685 24490.2633  7.25%   198   57s
  8466  1692 23194.3859   18  279 22834.2227 24189.2066  5.93%   178   60s
 13990  1652 22846.6049   45  416 22834.2227 23519.1971  3.00%   139   77s
 13993  1654 23123.3733   37  331 22834.2227 23519.1971  3.00%   139   81s
 14004  1661 22865.6447   48  314 22834.2227 23519.1971  3.00%   139   86s
 14010  1665 23149.0964   47  413 22834.2227 23519.1971  3.00%   139   90s
 14016  1669 23116.3344   29  423 22834.2227 23519.1971  3.00%   139   96s
 14107  1713 23519.1971   16  250 22834.2227 23519.1971  3.00%   143  100s
H14150  1623                    22834.343831 23519.1971  3.00%   144  100s
H14317  1474                    22844.344209 23519.1971  2.95%   145  102s
 14763  1305 23115.0958   25  162 22844.3442 23519.1971  2.95%   146  105s

Cutting planes:
  MIR: 127
  Flow cover: 339
  RLT: 12
  Relax-and-lift: 25

Explored 15594 nodes (2218675 simplex iterations) in 108.86 seconds (247.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 22844.3 22834.3 22834.2 ... 22660.6

Optimal solution found (tolerance 1.00e-04)
Best objective 2.284434420919e+04, best bound 2.284434420919e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 108.87s
  Master Objective (UB) = 22844.34, θ = 146528.40
  Upper Bound (UB) = 22844.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146528.40
  [DEBUG]   ✓ Scenario 0: θ = 146528.40 ≤ Q = 146528.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146528.40 ≤ Q = 146535.67 (slack: 7.27)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e054a26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa1fab5da
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.361329e+13
Presolve removed 2615 rows and 1906 columns
Presolve time: 0.00s
Presolved: 478 rows, 483 columns, 1352 nonzeros
Found heuristic solution: objective 6846691.3459
Variable types: 325 continuous, 158 integer (158 binary)
Found heuristic solution: objective 6845767.3202

Root relaxation: objective -1.439610e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143960.98    0  125 6845767.32 -143960.98   102%     -    0s
H    0     0                    -124837.5238 -143960.98  15.3%     -    0s
H    0     0                    -125033.9335 -143960.98  15.1%     -    0s
H    0     0                    -125622.9092 -143732.00  14.4%     -    0s
H    0     0                    -131416.1656 -133100.52  1.28%     -    0s
     0     0 -133100.52    0   73 -131416.17 -133100.52  1.28%     -    0s
     0     0 -132566.31    0   76 -131416.17 -132566.31  0.88%     -    0s
     0     0 -131987.01    0   37 -131416.17 -131987.01  0.43%     -    0s
H    0     0                    -131587.5777 -131985.72  0.30%     -    0s
H    0     0                    -131636.8743 -131920.23  0.22%     -    0s
     0     0 -131920.23    0   36 -131636.87 -131920.23  0.22%     -    0s
     0     0 -131916.98    0   20 -131636.87 -131916.98  0.21%     -    0s
     0     0 -131897.82    0   37 -131636.87 -131897.82  0.20%     -    0s
     0     0 -131897.54    0   37 -131636.87 -131897.54  0.20%     -    0s
     0     0 -131756.95    0   14 -131636.87 -131756.95  0.09%     -    0s
     0     0 -131753.56    0   13 -131636.87 -131753.56  0.09%     -    0s
H    0     0                    -131646.2474 -131753.56  0.08%     -    0s
     0     0 -131694.58    0    9 -131646.25 -131694.58  0.04%     -    0s
     0     0 -131694.39    0    9 -131646.25 -131694.39  0.04%     -    0s
H    0     0                    -131658.4690 -131690.21  0.02%     -    0s
*    0     0               0    -131682.3701 -131682.37  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 1
  MIR: 5
  Flow cover: 6
  Relax-and-lift: 1

Explored 1 nodes (705 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -131682 -131658 -131646 ... 6.84669e+06
No other solutions better than -131682

Optimal solution found (tolerance 1.00e-04)
Best objective -1.316823700938e+05, best bound -1.316823700938e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 122658.44
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -131682.37
  [DEBUG]   S×d_nominal = 254340.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254340.81 + -131682.37 = 122658.44
  [DEBUG]   Current θ from Master = 146528.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23869.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1025.61
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 9344.9083, Absolute Gap = 9344.9083, Relative Gap = 0.409069
  Not converged yet (gap = 9344.91 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xd711b788
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -1025.61 (0.02s)
Loaded MIP start from previous solve with objective -1025.61

Presolve removed 21270 rows and 8640 columns
Presolve time: 0.40s
Presolved: 25983 rows, 12340 columns, 159869 nonzeros
Variable types: 10081 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.24s

Solved with dual simplex

Root relaxation: objective 4.049808e+04, 17424 iterations, 3.67 seconds (7.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40498.0785    0  123 -1025.6116 40498.0785  4049%     -    4s
H    0     0                    6604.7082692 40498.0785   513%     -    4s
H    0     0                    9086.9297783 40498.0785   346%     -    4s
H    0     0                    15423.576675 40498.0785   163%     -    4s
H    0     0                    15423.980420 40498.0785   163%     -    4s
H    0     0                    15446.058181 36427.9684   136%     -    5s
     0     0 36427.9684    0  253 15446.0582 36427.9684   136%     -    5s
     0     0 36064.7925    0  252 15446.0582 36064.7925   133%     -    6s
     0     0 35550.3058    0  260 15446.0582 35550.3058   130%     -    6s
     0     0 35550.3058    0  264 15446.0582 35550.3058   130%     -    6s
     0     0 35550.3058    0  264 15446.0582 35550.3058   130%     -    6s
     0     0 32384.0634    0  199 15446.0582 32384.0634   110%     -    8s
H    0     0                    16513.618689 32384.0634  96.1%     -    8s
H    0     0                    16827.293022 32384.0634  92.4%     -    8s
H    0     0                    16995.532572 32384.0634  90.5%     -    8s
H    0     0                    17100.776980 32384.0634  89.4%     -    8s
H    0     0                    17177.698498 32384.0634  88.5%     -    8s
H    0     0                    17192.058502 32384.0634  88.4%     -    8s
H    0     0                    17207.931002 32384.0634  88.2%     -    8s
H    0     0                    17215.134557 32384.0634  88.1%     -    8s
     0     0 31914.2534    0  274 17215.1346 31914.2534  85.4%     -    9s
     0     0 31859.3953    0  281 17215.1346 31859.3953  85.1%     -   10s
     0     0 31728.2425    0  323 17215.1346 31728.2425  84.3%     -   10s
     0     0 31659.7777    0  324 17215.1346 31659.7777  83.9%     -   11s
     0     0 31653.8173    0  328 17215.1346 31653.8173  83.9%     -   11s
     0     0 31651.3002    0  331 17215.1346 31651.3002  83.9%     -   11s
     0     0 31651.2462    0  332 17215.1346 31651.2462  83.9%     -   11s
     0     0 29723.5931    0  348 17215.1346 29723.5931  72.7%     -   13s
H    0     0                    17297.045917 29723.1759  71.8%     -   13s
     0     0 29435.6242    0  361 17297.0459 29435.6242  70.2%     -   14s
     0     0 29344.2177    0  356 17297.0459 29344.2177  69.6%     -   14s
     0     0 29329.6475    0  366 17297.0459 29329.6475  69.6%     -   14s
     0     0 29308.6486    0  315 17297.0459 29308.6486  69.4%     -   14s
     0     0 29295.9731    0  368 17297.0459 29295.9731  69.4%     -   14s
     0     0 29291.4913    0  365 17297.0459 29291.4913  69.3%     -   14s
     0     0 29290.7053    0  360 17297.0459 29290.7053  69.3%     -   14s
H    0     0                    17297.197533 28495.1937  64.7%     -   17s
H    0     0                    17315.551199 28495.1937  64.6%     -   17s
H    0     0                    17328.170947 28495.1937  64.4%     -   17s
H    0     0                    17331.007880 28495.1937  64.4%     -   17s
     0     0 28495.1937    0  385 17331.0079 28495.1937  64.4%     -   17s
H    0     0                    17349.670295 28494.6560  64.2%     -   17s
     0     0 28239.4136    0  388 17349.6703 28239.4136  62.8%     -   18s
     0     0 28155.0134    0  401 17349.6703 28155.0134  62.3%     -   18s
     0     0 28064.8864    0  399 17349.6703 28064.8864  61.8%     -   18s
     0     0 28039.5293    0  400 17349.6703 28039.5293  61.6%     -   18s
     0     0 28028.7950    0  401 17349.6703 28028.7950  61.6%     -   19s
     0     0 28017.6179    0  405 17349.6703 28017.6179  61.5%     -   19s
     0     0 28013.2081    0  405 17349.6703 28013.2081  61.5%     -   19s
     0     0 28012.2907    0  402 17349.6703 28012.2907  61.5%     -   19s
H    0     0                    17407.873870 27813.4054  59.8%     -   19s
H    0     0                    17432.697671 27813.4054  59.5%     -   19s
H    0     0                    17440.132836 27813.4054  59.5%     -   19s
     0     0 27813.4054    0  402 17440.1328 27813.4054  59.5%     -   20s
     0     0 27793.7038    0  403 17440.1328 27793.7038  59.4%     -   20s
     0     0 27779.7240    0  402 17440.1328 27779.7240  59.3%     -   20s
     0     0 27772.2373    0  405 17440.1328 27772.2373  59.2%     -   20s
     0     0 27770.6480    0  406 17440.1328 27770.6480  59.2%     -   20s
     0     0 27769.6802    0  409 17440.1328 27769.6802  59.2%     -   20s
H    0     0                    17541.619335 27726.6338  58.1%     -   21s
H    0     0                    17575.094170 27726.6338  57.8%     -   21s
H    0     0                    17584.302677 27726.6338  57.7%     -   21s
H    0     0                    17701.264893 27726.6338  56.6%     -   21s
H    0     0                    17729.451365 27726.6338  56.4%     -   21s
H    0     0                    17743.638316 27726.6338  56.3%     -   21s
H    0     0                    17750.712548 27726.6338  56.2%     -   21s
H    0     0                    17776.995064 27726.6338  56.0%     -   21s
     0     0 27726.6338    0  401 17776.9951 27726.6338  56.0%     -   21s
H    0     0                    17794.128393 27726.5125  55.8%     -   21s
H    0     0                    17841.568760 27726.5125  55.4%     -   21s
H    0     0                    17869.841341 27726.5125  55.2%     -   21s
     0     0 27712.3469    0  450 17869.8413 27712.3469  55.1%     -   21s
     0     0 27707.4469    0  441 17869.8413 27707.4469  55.1%     -   21s
     0     0 27702.9911    0  439 17869.8413 27702.9911  55.0%     -   22s
     0     0 27702.2466    0  443 17869.8413 27702.2466  55.0%     -   22s
     0     0 27681.2272    0  441 17869.8413 27681.2272  54.9%     -   22s
     0     0 27672.2289    0  442 17869.8413 27672.2289  54.9%     -   22s
     0     0 27669.7627    0  440 17869.8413 27669.7627  54.8%     -   23s
     0     0 27667.7799    0  449 17869.8413 27667.7799  54.8%     -   23s
     0     0 27666.5934    0  442 17869.8413 27666.5934  54.8%     -   23s
     0     0 27629.0870    0  447 17869.8413 27629.0870  54.6%     -   23s
H    0     0                    18130.388548 27629.0406  52.4%     -   24s
H    0     0                    18163.732743 27629.0406  52.1%     -   24s
     0     0 27607.7831    0  495 18163.7327 27607.7831  52.0%     -   24s
     0     0 27604.7556    0  466 18163.7327 27604.7556  52.0%     -   24s
     0     0 27604.4920    0  465 18163.7327 27604.4920  52.0%     -   24s
     0     0 27598.9111    0  448 18163.7327 27598.9111  51.9%     -   25s
H    0     0                    18185.630566 27598.1671  51.8%     -   25s
H    0     0                    18218.203333 27598.1671  51.5%     -   25s
H    0     0                    18222.800516 27598.1671  51.4%     -   25s
     0     0 27597.1053    0  453 18222.8005 27597.1053  51.4%     -   25s
     0     0 27596.0593    0  414 18222.8005 27596.0593  51.4%     -   25s
     0     0 27583.9761    0  406 18222.8005 27583.9761  51.4%     -   25s
     0     0 27580.1318    0  401 18222.8005 27580.1318  51.3%     -   26s
     0     0 27579.6353    0  407 18222.8005 27579.6353  51.3%     -   26s
     0     0 27578.4475    0  404 18222.8005 27578.4475  51.3%     -   26s
     0     0 27577.9825    0  403 18222.8005 27577.9825  51.3%     -   26s
     0     0 27576.9593    0  395 18222.8005 27576.9593  51.3%     -   26s
H    0     0                    18296.170055 27576.7811  50.7%     -   27s
H    0     0                    18311.018573 27576.7811  50.6%     -   27s
     0     0 27576.2150    0  410 18311.0186 27576.2150  50.6%     -   27s
     0     0 27574.9187    0  400 18311.0186 27574.9187  50.6%     -   27s
     0     0 27574.7498    0  400 18311.0186 27574.7498  50.6%     -   28s
H    0     0                    18337.719804 27574.6829  50.4%     -   31s
H    0     0                    18340.083189 27574.6829  50.4%     -   31s
     0     2 27574.6829    0  400 18340.0832 27574.6829  50.4%     -   31s
    15    32 26723.7346    4  405 18340.0832 27193.4954  48.3%   993   35s
H   34    64                    18353.648851 26713.6508  45.5%  1550   36s
H   37    64                    18357.637908 26713.6508  45.5%  1491   36s
H   38    64                    18361.616604 26713.6508  45.5%  1470   36s
H   43    64                    18402.761643 26713.6508  45.2%  1508   36s
H   55    64                    18457.820091 26541.5433  43.8%  1444   36s
H   64    96                    18468.769913 26541.5433  43.7%  1412   37s
H   66    96                    18531.371196 26541.5433  43.2%  1393   37s
H   68    96                    18601.611748 26541.5433  42.7%  1372   37s
   204   279 25982.2622    9  398 18601.6117 26541.5433  42.7%   820   40s
H  450   440                    18618.417595 26541.5433  42.6%   702   44s
   467   499 25067.2127   13  301 18618.4176 26317.7782  41.4%   704   45s
   710   703 24317.7761   15  303 18618.4176 26115.9657  40.3%   733   50s
  1076  1017 23434.8110   19  322 18618.4176 25986.7261  39.6%   734   55s
  1357  1169 22955.7433   23  305 18618.4176 25986.7261  39.6%   706   60s
H 1580  1261                    18650.148841 25905.7024  38.9%   711   63s
  1609  1386 21816.9664   27  172 18650.1488 25905.7024  38.9%   722   65s
  2088  1659 20645.4371   34  173 18650.1488 25821.4459  38.5%   670   70s
H 2220  1694                    18657.359993 25821.4459  38.4%   676   72s
H 2250  1694                    18662.082549 25821.4459  38.4%   680   72s
  2388  1824 24800.3925   12  214 18662.0825 25722.3016  37.8%   694   75s
  2716  1920 23256.3545   16  199 18662.0825 25551.6056  36.9%   713   81s
H 2718  1920                    18664.110711 25551.6056  36.9%   713   81s
H 2852  1964                    18666.064799 25551.6056  36.9%   734   82s
H 2862  1964                    18670.068181 25551.6056  36.9%   734   82s
  3028  2086     cutoff   14      18670.0682 25547.0786  36.8%   747   87s
  3392  2234     cutoff   19      18670.0682 25397.1779  36.0%   746   90s
H 3604  2298                    18676.995868 25397.1779  36.0%   742   92s
  3737  2344     cutoff   12      18676.9959 25341.8824  35.7%   741   95s
  4215  2492     cutoff   14      18676.9959 25341.8824  35.7%   747  101s
  4618  2716 23693.9997   10  226 18676.9959 25289.7899  35.4%   748  106s
  4858  2717 23183.3649   16  400 18676.9959 25287.2866  35.4%   748  115s
  4860  2718 19928.1208   21  123 18676.9959 25287.2866  35.4%   747  120s
  4862  2720 22812.5600   24  382 18676.9959 25287.2866  35.4%   747  125s
  4871  2726 21867.9879   23  390 18676.9959 25287.2866  35.4%   746  130s
  4878  2730 24337.2627   33  396 18676.9959 25287.2866  35.4%   745  135s
  4885  2735 23492.8643    9  397 18676.9959 25287.2866  35.4%   744  140s
  4887  2736 24828.4651   21  424 18676.9959 25287.2866  35.4%   743  147s
  4888  2737 22429.2129   14  424 18676.9959 25287.2866  35.4%   743  150s
  4895  2751 25287.2866   13  300 18676.9959 25287.2866  35.4%   752  156s
  4919  2788 25287.2866   15  256 18676.9959 25287.2866  35.4%   758  160s
  5044  2856 22253.4703   18  378 18676.9959 25287.2866  35.4%   776  166s
  5181  2870 22507.1599   20  238 18676.9959 25287.2866  35.4%   783  170s
  5368  2850     cutoff   22      18676.9959 25287.2866  35.4%   786  175s
  5592  2843 21242.5478   20  212 18676.9959 25024.6608  34.0%   794  181s
  5796  2825     cutoff   24      18676.9959 24834.2505  33.0%   796  186s
  5991  2784     cutoff   25      18676.9959 24686.9298  32.2%   795  191s
  6263  2744 21746.1634   20  153 18676.9959 24265.8955  29.9%   792  196s
  6462  2699 20245.0924   25  160 18676.9959 24172.3885  29.4%   788  200s
  6850  2590     cutoff   19      18676.9959 23281.4599  24.7%   780  206s
  7130  2484 20200.1328   19  206 18676.9959 23229.5590  24.4%   774  210s
  7414  2351     cutoff   19      18676.9959 22736.8774  21.7%   773  215s
  7740  2209 20209.6623   19  225 18676.9959 22235.4680  19.1%   772  220s
  8046  2001     cutoff   27      18676.9959 21593.8470  15.6%   762  225s
  9586  1824 18689.7176   50   28 18676.9959 19795.3755  5.99%   672  230s
H 9652  1664                    18685.051160 19773.4336  5.82%   667  230s
H10042  1404                    18703.115984 19213.8305  2.73%   643  230s
*11117  1082              68    18703.478991 19023.5197  1.71%   583  230s
*12976  1111              67    18721.257091 18927.1390  1.10%   503  231s
H13099  1562                    18724.473134 18927.1390  1.08%   499  231s
H14861  1893                    18743.906405 18845.7476  0.54%   442  232s
H14898  1893                    18751.115420 18845.7476  0.50%   441  232s
*15244  1893              63    18751.130395 18845.7476  0.50%   431  232s
H15307  1893                    18753.665703 18845.7476  0.49%   430  232s
*15782  1545              63    18756.162595 18834.1613  0.42%   417  233s
*15911  1545              73    18774.502386 18822.9658  0.26%   414  233s
*17802  1545              69    18780.752916 18804.1596  0.12%   372  233s

Cutting planes:
  Learned: 1
  MIR: 318
  Mixing: 1
  Flow cover: 662
  RLT: 6
  Relax-and-lift: 34

Explored 19585 nodes (6677961 simplex iterations) in 233.61 seconds (639.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 18780.8 18774.5 18756.2 ... 18703.5

Optimal solution found (tolerance 1.00e-04)
Best objective 1.878075291634e+04, best bound 1.878075291634e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 233.62s
  Master Objective (UB) = 18780.75, θ = 142708.44
  Upper Bound (UB) = 18780.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 142708.44
  [DEBUG]   ✓ Scenario 0: θ = 142708.44 ≤ Q = 142708.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 142708.44 ≤ Q = 142708.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 142708.44 ≤ Q = 142708.44 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1e760715
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1e760715
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.343769e+13
Presolve removed 2620 rows and 1910 columns
Presolve time: 0.00s
Presolved: 473 rows, 479 columns, 1336 nonzeros
Found heuristic solution: objective 6669468.3891
Variable types: 322 continuous, 157 integer (157 binary)
Found heuristic solution: objective 6668544.3634

Root relaxation: objective -1.428760e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142875.95    0  125 6668544.36 -142875.95   102%     -    0s
H    0     0                    -115435.8474 -142875.95  23.8%     -    0s
H    0     0                    -120976.1164 -131496.80  8.70%     -    0s
H    0     0                    -123166.6463 -131496.80  6.76%     -    0s
     0     0 -131496.80    0   60 -123166.65 -131496.80  6.76%     -    0s
H    0     0                    -130296.4444 -131464.23  0.90%     -    0s
H    0     0                    -130399.8419 -130992.84  0.45%     -    0s
     0     0 -130992.84    0   61 -130399.84 -130992.84  0.45%     -    0s
     0     0 -130972.33    0   61 -130399.84 -130972.33  0.44%     -    0s
     0     0 -130953.61    0   60 -130399.84 -130953.61  0.42%     -    0s
     0     0 -130546.06    0   18 -130399.84 -130546.06  0.11%     -    0s
     0     0 -130541.85    0   14 -130399.84 -130541.85  0.11%     -    0s
     0     0 -130506.65    0   17 -130399.84 -130506.65  0.08%     -    0s
     0     0 -130493.22    0   10 -130399.84 -130493.22  0.07%     -    0s
     0     0 -130421.38    0    4 -130399.84 -130421.38  0.02%     -    0s
     0     0 -130418.45    0    5 -130399.84 -130418.45  0.01%     -    0s
H    0     0                    -130399.9536 -130418.45  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 3
  Flow cover: 5

Explored 1 nodes (581 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -130400 -130400 -123167 ... 1.34377e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.303999536017e+05, best bound -1.304118991636e+05, gap 0.0092%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 117423.87
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130399.95
  [DEBUG]   S×d_nominal = 247823.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 247823.82 + -130399.95 = 117423.87
  [DEBUG]   Current θ from Master = 142708.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25284.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6503.82
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 5281.3170, Absolute Gap = 5281.3170, Relative Gap = 0.281209
  Not converged yet (gap = 5281.32 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x8ff3bca2
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -6503.82 (0.02s)
Loaded MIP start from previous solve with objective -6503.82

Presolve removed 28360 rows and 11520 columns
Presolve time: 0.54s
Presolved: 34183 rows, 15700 columns, 211319 nonzeros
Variable types: 13441 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34183 rows, 15700 columns, 211319 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42556    2.8009095e+04   0.000000e+00   2.803681e+06      5s
Concurrent spin time: 0.09s

Solved with dual simplex

Root relaxation: objective 4.020537e+04, 21438 iterations, 5.32 seconds (10.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40205.3692    0   89 -6503.8165 40205.3692   718%     -    6s
H    0     0                    10105.303670 40205.3692   298%     -    6s
H    0     0                    13440.655499 40205.3692   199%     -    6s
H    0     0                    16021.048532 40205.3692   151%     -    6s
H    0     0                    16196.387176 40205.3692   148%     -    6s
H    0     0                    16442.221902 40205.3692   145%     -    6s
H    0     0                    16442.713691 40205.3692   145%     -    6s
H    0     0                    16489.788265 40205.3692   144%     -    6s
H    0     0                    16501.476742 40205.3692   144%     -    6s
H    0     0                    16556.493941 40205.3692   143%     -    6s
H    0     0                    16618.371465 40205.3692   142%     -    6s
H    0     0                    16618.993088 40205.3692   142%     -    6s
H    0     0                    16636.781609 40205.3692   142%     -    6s
     0     0 35404.5740    0  264 16636.7816 35404.5740   113%     -    9s
H    0     0                    16645.901830 35404.5740   113%     -    9s
     0     0 35254.5252    0  264 16645.9018 35254.5252   112%     -   10s
     0     0 35254.5252    0  264 16645.9018 35254.5252   112%     -   10s
     0     0 35254.5252    0  276 16645.9018 35254.5252   112%     -   11s
     0     0 35254.5252    0  276 16645.9018 35254.5252   112%     -   11s
     0     0 32427.1142    0  313 16645.9018 32427.1142  94.8%     -   13s
H    0     0                    17006.568657 32427.1142  90.7%     -   14s
H    0     0                    17423.046428 32427.1142  86.1%     -   14s
H    0     0                    17788.919623 32427.1142  82.3%     -   14s
H    0     0                    17823.609617 32427.1142  81.9%     -   14s
H    0     0                    17879.355272 32427.1142  81.4%     -   14s
     0     0 31822.4183    0  320 17879.3553 31822.4183  78.0%     -   15s
     0     0 31622.5964    0  325 17879.3553 31622.5964  76.9%     -   15s
     0     0 31561.3951    0  335 17879.3553 31561.3951  76.5%     -   16s
     0     0 31561.3399    0  337 17879.3553 31561.3399  76.5%     -   16s
     0     0 29758.2860    0  360 17879.3553 29758.2860  66.4%     -   20s
     0     0 28990.7256    0  365 17879.3553 28990.7256  62.1%     -   22s
     0     0 28727.9932    0  369 17879.3553 28727.9932  60.7%     -   23s
     0     0 28665.6623    0  370 17879.3553 28665.6623  60.3%     -   23s
     0     0 28655.2286    0  367 17879.3553 28655.2286  60.3%     -   23s
     0     0 28650.4041    0  372 17879.3553 28650.4041  60.2%     -   23s
     0     0 28649.3982    0  370 17879.3553 28649.3982  60.2%     -   24s
     0     0 28192.4002    0  395 17879.3553 28192.4002  57.7%     -   27s
H    0     0                    18029.804895 28191.9510  56.4%     -   28s
H    0     0                    18146.316757 28191.9510  55.4%     -   28s
H    0     0                    18200.245051 28191.9510  54.9%     -   28s
     0     0 28093.8776    0  400 18200.2451 28093.8776  54.4%     -   29s
     0     0 28034.8093    0  416 18200.2451 28034.8093  54.0%     -   29s
     0     0 27994.7969    0  409 18200.2451 27994.7969  53.8%     -   30s
     0     0 27973.2340    0  408 18200.2451 27973.2340  53.7%     -   30s
     0     0 27965.4915    0  403 18200.2451 27965.4915  53.7%     -   31s
     0     0 27964.3514    0  410 18200.2451 27964.3514  53.6%     -   31s
     0     0 27802.3776    0  442 18200.2451 27802.3776  52.8%     -   32s
     0     0 27737.4596    0  443 18200.2451 27737.4596  52.4%     -   33s
     0     0 27717.0154    0  446 18200.2451 27717.0154  52.3%     -   33s
     0     0 27713.2690    0  442 18200.2451 27713.2690  52.3%     -   33s
     0     0 27712.0239    0  446 18200.2451 27712.0239  52.3%     -   33s
     0     0 27659.6151    0  399 18200.2451 27659.6151  52.0%     -   34s
H    0     0                    18282.487110 27659.4960  51.3%     -   35s
     0     0 27652.5318    0  448 18282.4871 27652.5318  51.3%     -   35s
     0     0 27650.3529    0  413 18282.4871 27650.3529  51.2%     -   35s
     0     0 27649.4719    0  410 18282.4871 27649.4719  51.2%     -   35s
     0     0 27625.9133    0  410 18282.4871 27625.9133  51.1%     -   36s
     0     0 27618.5795    0  414 18282.4871 27618.5795  51.1%     -   36s
     0     0 27616.9628    0  410 18282.4871 27616.9628  51.1%     -   36s
     0     0 27614.3853    0  411 18282.4871 27614.3853  51.0%     -   37s
     0     0 27613.0711    0  413 18282.4871 27613.0711  51.0%     -   37s
     0     0 27590.0882    0  403 18282.4871 27590.0882  50.9%     -   37s
     0     0 27589.3514    0  402 18282.4871 27589.3514  50.9%     -   38s
     0     0 27585.2653    0  407 18282.4871 27585.2653  50.9%     -   38s
     0     0 27584.5743    0  408 18282.4871 27584.5743  50.9%     -   38s
     0     0 27560.0001    0  406 18282.4871 27560.0001  50.7%     -   39s
     0     0 27552.5076    0  412 18282.4871 27552.5076  50.7%     -   39s
     0     0 27546.1685    0  410 18282.4871 27546.1685  50.7%     -   39s
     0     0 27545.6083    0  409 18282.4871 27545.6083  50.7%     -   39s
     0     0 27542.9421    0  406 18282.4871 27542.9421  50.7%     -   40s
     0     0 27539.1000    0  410 18282.4871 27539.1000  50.6%     -   40s
     0     0 27538.6356    0  410 18282.4871 27538.6356  50.6%     -   40s
     0     0 27536.5060    0  412 18282.4871 27536.5060  50.6%     -   41s
     0     0 27535.5838    0  417 18282.4871 27535.5838  50.6%     -   41s
     0     0 27535.5838    0  422 18282.4871 27535.5838  50.6%     -   41s
     0     0 27535.5838    0  420 18282.4871 27535.5838  50.6%     -   42s
     0     0 27531.1731    0  410 18282.4871 27531.1731  50.6%     -   42s
     0     0 27531.1728    0  410 18282.4871 27531.1728  50.6%     -   42s
     0     2 27531.1449    0  410 18282.4871 27531.1449  50.6%     -   52s
     3     8 27363.1988    2  399 18282.4871 27381.0398  49.8%  1378   55s
    31    62 26505.8060    5  410 18282.4871 26836.1827  46.8%  2910   61s
H   33    62                    18438.072288 26836.1827  45.5%  2774   61s
    95   196 26148.2634    7  398 18438.0723 26505.4607  43.8%  2307   65s
H  117   196                    18457.512705 26505.4607  43.6%  2017   65s
   336   362 25760.6738    9  401 18457.5127 26403.4931  43.1%  1182   70s
H  378   362                    18467.869440 26403.4931  43.0%  1163   70s
   482   478 23847.2916   11  264 18467.8694 26236.8903  42.1%  1139   76s
   588   543 24620.2338   12  369 18467.8694 26236.8903  42.1%  1103   80s
H  699   597                    18480.410531 26236.8903  42.0%  1132   84s
   729   634 24141.2718   14  327 18480.4105 26236.8903  42.0%  1124   86s
H  766   634                    18492.413661 26102.1878  41.2%  1121   86s
   825   709 23791.3034   16  256 18492.4137 26102.1878  41.2%  1116   90s
   988   820 23246.4717   18  235 18492.4137 26034.7681  40.8%  1072   95s
  1184   992 22571.1286   22  282 18492.4137 25976.8808  40.5%  1026  101s
  1322  1053 21833.9239   25  252 18492.4137 25976.8808  40.5%  1001  105s
H 1384  1082                    18502.828687 25976.8808  40.4%   990  106s
  1577  1304 21326.1310   29  249 18502.8287 25976.8808  40.4%   937  110s
  2061  1587 20129.2149   44  185 18502.8287 25928.1542  40.1%   839  116s
H 2076  1587                    18519.357355 25928.1542  40.0%   838  116s
  2320  1896 19541.4499   49  220 18519.3574 25873.9808  39.7%   808  121s
  2766  2181 21071.6464    9  210 18519.3574 25873.9808  39.7%   749  126s
  3012  2270 19085.4376   10  263 18519.3574 25873.9808  39.7%   723  130s
  3270  2386     cutoff   14      18519.3574 25718.7018  38.9%   720  135s
  3608  2674 23977.0128   15  259 18519.3574 25718.7018  38.9%   716  142s
  3804  2675 21099.6498   23  410 18519.3574 25675.1431  38.6%   711  158s
  3806  2676 20139.5241   43   89 18519.3574 25675.1431  38.6%   711  164s
  3807  2677 25539.8644    8  321 18519.3574 25675.1431  38.6%   711  169s
  3808  2678 20011.2642   11  392 18519.3574 25675.1431  38.6%   711  172s
  3811  2680 24635.9772    6  407 18519.3574 25675.1431  38.6%   710  176s
  3817  2684 21346.3194   30  404 18519.3574 25675.1431  38.6%   709  180s
  3824  2688 19614.2305   31  411 18519.3574 25675.1431  38.6%   708  186s
  3828  2691 25419.2509   12  417 18519.3574 25675.1431  38.6%   707  191s
  3833  2694 21623.1105   28  474 18519.3574 25675.1431  38.6%   706  196s
  3837  2697 19608.2696   46  409 18519.3574 25675.1431  38.6%   705  200s
  3839  2698 22900.6022   11  405 18519.3574 25675.1431  38.6%   705  207s
  3840  2699 22216.8755   24  405 18519.3574 25675.1431  38.6%   705  212s
  3841  2703 25675.1431   13  405 18519.3574 25675.1431  38.6%   722  215s
  3847  2713 25675.1431   15  466 18519.3574 25675.1431  38.6%   723  222s
  3855  2726 25675.1431   16  412 18519.3574 25675.1431  38.6%   726  227s
  3871  2753 25596.3774   17  412 18519.3574 25675.1431  38.6%   744  230s
  3935  2834 24017.1898   19  350 18519.3574 25675.1431  38.6%   777  236s
  4070  2876 22220.6059   21  348 18519.3574 25675.1431  38.6%   804  242s
  4144  2871 22185.9547   21  320 18519.3574 25675.1431  38.6%   813  246s
  4258  2870 19679.5869   22  292 18519.3574 25675.1431  38.6%   829  251s
  4355  2883 20103.4488   23  253 18519.3574 25675.1431  38.6%   840  257s
  4397  2891 20037.8063   24  216 18519.3574 25675.1431  38.6%   847  260s
H 4460  2753                    18520.637309 25597.7226  38.2%   853  262s
  4474  2785     cutoff   25      18520.6373 25597.7226  38.2%   855  266s
  4639  2797     cutoff   27      18520.6373 25597.7226  38.2%   859  271s
  4814  2799 23964.7034   22  265 18520.6373 25067.4303  35.3%   857  276s
  4994  2859 22834.4182   26  265 18520.6373 24796.4796  33.9%   859  281s
  5093  2864 22188.9462   28  239 18520.6373 24796.4796  33.9%   856  285s
  5308  2868 20905.7366   34  155 18520.6373 24738.3214  33.6%   854  291s
H 5552  2719                    18552.598198 24578.3136  32.5%   849  296s
  5705  2758 19019.5752   47  133 18552.5982 24474.8633  31.9%   849  303s
  5854  2766 22628.4265   20  367 18552.5982 24474.8633  31.9%   846  306s
  6001  2780 21507.0424   22  274 18552.5982 24385.9101  31.4%   842  311s
  6150  2772 20424.8051   26  264 18552.5982 24281.4216  30.9%   841  316s
  6333  2734 19566.6217   29  219 18552.5982 24192.5535  30.4%   837  320s
  6485  2703 18794.5743   31  211 18552.5982 23966.3838  29.2%   840  325s
  6623  2691 18837.5079   34  239 18552.5982 23903.8005  28.8%   843  331s
  6825  2662     cutoff   38      18552.5982 23883.3387  28.7%   844  338s
  6979  2630     cutoff   26      18552.5982 23736.1935  27.9%   844  343s
  7136  2629     cutoff   22      18552.5982 23564.7422  27.0%   849  348s
  7350  2576 19551.3411   21  253 18552.5982 23310.8481  25.6%   849  351s
  7582  2541 21323.7191   23  257 18552.5982 23194.6906  25.0%   852  356s
  7852  2413     cutoff   25      18552.5982 23034.9809  24.2%   853  362s
  8078  2309 19486.9493   24  202 18552.5982 22728.1636  22.5%   854  367s
  8410  2168 20927.3578   41  136 18552.5982 22361.1627  20.5%   851  372s
  8771  2000 19620.1765   23  313 18552.5982 22172.4721  19.5%   846  376s
  9172  1776     cutoff   23      18552.5982 21858.7413  17.8%   838  381s
  9486  1531     cutoff   25      18552.5982 21772.0149  17.4%   832  385s
  9958  1155     cutoff   55      18552.5982 21235.6943  14.5%   823  391s
 10579   552     cutoff   25      18552.5982 20602.4998  11.0%   800  395s
H12669   744                    18599.248019 20086.5339  8.00%   695  398s
 14969  1278     cutoff   63      18599.2480 19137.4743  2.89%   597  401s
*19724  1310              75    18600.327576 18821.9118  1.19%   466  403s
 23110  1657     cutoff   67      18600.3276 18667.4145  0.36%   402  406s
*24791  1657              80    18611.415917 18664.1124  0.28%   376  406s
*25323  1657              79    18618.072232 18664.1124  0.25%   369  406s

Cutting planes:
  Learned: 1
  MIR: 376
  Flow cover: 1003
  RLT: 13
  Relax-and-lift: 49

Explored 28749 nodes (9472522 simplex iterations) in 407.24 seconds (1150.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 18618.1 18611.4 18600.3 ... 18480.4

Optimal solution found (tolerance 1.00e-04)
Best objective 1.861807223197e+04, best bound 1.861807223197e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 407.26s
  Master Objective (UB) = 18618.07, θ = 141551.81
  Upper Bound (UB) = 18618.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141551.81
  [DEBUG]   ✓ Scenario 0: θ = 141551.81 ≤ Q = 141551.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141551.81 ≤ Q = 141551.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141551.81 ≤ Q = 141551.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141551.81 ≤ Q = 141551.81 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1cc378ab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1cc378ab
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.337360e+13
Presolve removed 2621 rows and 1911 columns
Presolve time: 0.00s
Presolved: 472 rows, 478 columns, 1333 nonzeros
Found heuristic solution: objective 6756188.7780
Variable types: 321 continuous, 157 integer (157 binary)
Found heuristic solution: objective 6755264.7523

Root relaxation: objective -1.411588e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141158.75    0  124 6755264.75 -141158.75   102%     -    0s
H    0     0                    -113774.2426 -141158.75  24.1%     -    0s
H    0     0                    -114555.1138 -141158.75  23.2%     -    0s
H    0     0                    -114699.0526 -131825.30  14.9%     -    0s
H    0     0                    -114925.4388 -131825.30  14.7%     -    0s
H    0     0                    -127362.8730 -131825.30  3.50%     -    0s
     0     0 -131825.30    0   85 -127362.87 -131825.30  3.50%     -    0s
H    0     0                    -129579.9993 -131762.23  1.68%     -    0s
     0     0 -131572.43    0   85 -129580.00 -131572.43  1.54%     -    0s
     0     0 -130970.55    0   61 -129580.00 -130970.55  1.07%     -    0s
H    0     0                    -130321.5488 -130948.99  0.48%     -    0s
     0     0 -130895.26    0   56 -130321.55 -130895.26  0.44%     -    0s
     0     0 -130895.22    0   56 -130321.55 -130895.22  0.44%     -    0s
     0     0 -130586.69    0   27 -130321.55 -130586.69  0.20%     -    0s
     0     0 -130552.81    0   24 -130321.55 -130552.81  0.18%     -    0s
     0     0 -130455.50    0   21 -130321.55 -130455.50  0.10%     -    0s
     0     0 -130440.52    0   20 -130321.55 -130440.52  0.09%     -    0s
     0     0 -130431.81    0   19 -130321.55 -130431.81  0.08%     -    0s
     0     0 -130419.27    0   18 -130321.55 -130419.27  0.07%     -    0s
     0     0 -130413.87    0   18 -130321.55 -130413.87  0.07%     -    0s
     0     0 -130411.53    0   18 -130321.55 -130411.53  0.07%     -    0s
     0     0 -130410.52    0   18 -130321.55 -130410.52  0.07%     -    0s
     0     0 -130410.08    0   18 -130321.55 -130410.08  0.07%     -    0s
     0     0 -130394.54    0   18 -130321.55 -130394.54  0.06%     -    0s
     0     0 -130390.92    0   17 -130321.55 -130390.92  0.05%     -    0s
     0     0 -130390.72    0   17 -130321.55 -130390.72  0.05%     -    0s
     0     0 -130389.05    0   15 -130321.55 -130389.05  0.05%     -    0s
     0     0 -130388.91    0   15 -130321.55 -130388.91  0.05%     -    0s
     0     0 -130349.61    0   13 -130321.55 -130349.61  0.02%     -    0s
     0     0 -130347.63    0    8 -130321.55 -130347.63  0.02%     -    0s
H    0     0                    -130333.0584 -130347.63  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 2
  Flow cover: 2
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (699 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130333 -130322 -130150 ... 6.75526e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.303330583647e+05, best bound -1.303460566407e+05, gap 0.0100%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 116725.67
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130333.06
  [DEBUG]   S×d_nominal = 247058.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 247058.72 + -130333.06 = 116725.67
  [DEBUG]   Current θ from Master = 141551.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24826.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6208.08
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 5118.6363, Absolute Gap = 5118.6363, Relative Gap = 0.274928
  Not converged yet (gap = 5118.64 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x66b6d15e
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35450 rows and 14400 columns
Presolve time: 0.67s
Presolved: 42383 rows, 19060 columns, 262769 nonzeros
Variable types: 16801 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338447.1000
Found heuristic solution: objective -153372.5729

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42383 rows, 19060 columns, 262769 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32858    2.7514697e+04   0.000000e+00   1.451128e+06      5s
Concurrent spin time: 0.10s

Solved with dual simplex

Root relaxation: objective 3.993110e+04, 28074 iterations, 8.84 seconds (17.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39931.1044    0   82 -153372.57 39931.1044   126%     -    9s
H    0     0                    -146862.4829 39931.1044   127%     -    9s
H    0     0                    -93154.86776 39931.1044   143%     -    9s
H    0     0                    -92955.37394 39931.1044   143%     -    9s
H    0     0                    -44828.67538 39931.1044   189%     -    9s
H    0     0                    -44545.78091 39931.1044   190%     -   10s
H    0     0                    5840.1808800 39931.1044   584%     -   10s
H    0     0                    6477.6804064 39931.1044   516%     -   10s
H    0     0                    6662.0972918 39931.1044   499%     -   10s
H    0     0                    9308.5952841 36041.9238   287%     -   14s
H    0     0                    9455.2734221 36041.9238   281%     -   14s
     0     0 36032.3880    0  265 9455.27342 36032.3880   281%     -   14s
H    0     0                    10085.183391 36032.3880   257%     -   14s
H    0     0                    10114.486313 36032.3880   256%     -   14s
H    0     0                    10231.861529 36032.3880   252%     -   14s
H    0     0                    10315.154574 36032.3880   249%     -   14s
     0     0 35226.3038    0  241 10315.1546 35226.3038   242%     -   15s
     0     0 35223.6086    0  247 10315.1546 35223.6086   241%     -   16s
     0     0 35223.6086    0  248 10315.1546 35223.6086   241%     -   17s
     0     0 35223.6086    0  246 10315.1546 35223.6086   241%     -   17s
     0     0 35223.6086    0  246 10315.1546 35223.6086   241%     -   17s
H    0     0                    13306.242106 32673.1294   146%     -   22s
     0     0 32673.1294    0  303 13306.2421 32673.1294   146%     -   22s
     0     0 32243.9543    0  307 13306.2421 32243.9543   142%     -   24s
     0     0 32018.8837    0  311 13306.2421 32018.8837   141%     -   26s
     0     0 31884.9433    0  312 13306.2421 31884.9433   140%     -   26s
     0     0 31739.2944    0  327 13306.2421 31739.2944   139%     -   28s
     0     0 31716.6267    0  332 13306.2421 31716.6267   138%     -   28s
     0     0 31709.7377    0  333 13306.2421 31709.7377   138%     -   28s
     0     0 31709.1321    0  332 13306.2421 31709.1321   138%     -   29s
H    0     0                    13497.927172 31709.1321   135%     -   31s
     0     0 29430.8529    0  353 13497.9272 29430.8529   118%     -   36s
     0     0 28839.1100    0  360 13497.9272 28839.1100   114%     -   41s
     0     0 28714.2005    0  371 13497.9272 28714.2005   113%     -   42s
     0     0 28624.4998    0  367 13497.9272 28624.4998   112%     -   43s
     0     0 28586.9527    0  379 13497.9272 28586.9527   112%     -   44s
     0     0 28552.8033    0  379 13497.9272 28552.8033   112%     -   44s
     0     0 28546.4211    0  377 13497.9272 28546.4211   111%     -   44s
     0     0 28536.1689    0  386 13497.9272 28536.1689   111%     -   45s
     0     0 28532.9300    0  384 13497.9272 28532.9300   111%     -   45s
     0     0 28519.2924    0  383 13497.9272 28519.2924   111%     -   45s
     0     0 28515.4879    0  386 13497.9272 28515.4879   111%     -   45s
     0     0 28515.4104    0  384 13497.9272 28515.4104   111%     -   45s
     0     0 27877.5573    0  396 13497.9272 27877.5573   107%     -   52s
     0     0 27577.2617    0  396 13497.9272 27577.2617   104%     -   54s
     0     0 27520.1300    0  396 13497.9272 27520.1300   104%     -   55s
     0     0 27483.7596    0  400 13497.9272 27483.7596   104%     -   56s
     0     0 27473.2748    0  403 13497.9272 27473.2748   104%     -   57s
     0     0 27465.8142    0  407 13497.9272 27465.8142   103%     -   57s
     0     0 27461.2613    0  402 13497.9272 27461.2613   103%     -   57s
     0     0 27455.0192    0  406 13497.9272 27455.0192   103%     -   57s
     0     0 27447.3250    0  405 13497.9272 27447.3250   103%     -   58s
     0     0 27445.5168    0  403 13497.9272 27445.5168   103%     -   58s
     0     0 27444.0334    0  406 13497.9272 27444.0334   103%     -   58s
     0     0 27305.2627    0  399 13497.9272 27305.2627   102%     -   60s
     0     0 27294.0770    0  402 13497.9272 27294.0770   102%     -   61s
     0     0 27286.4723    0  398 13497.9272 27286.4723   102%     -   61s
     0     0 27282.0425    0  404 13497.9272 27282.0425   102%     -   61s
     0     0 27281.8460    0  404 13497.9272 27281.8460   102%     -   61s
     0     0 27253.3959    0  409 13497.9272 27253.3959   102%     -   62s
     0     0 27244.1925    0  408 13497.9272 27244.1925   102%     -   63s
     0     0 27240.7568    0  414 13497.9272 27240.7568   102%     -   64s
     0     0 27237.9090    0  403 13497.9272 27237.9090   102%     -   64s
     0     0 27236.6446    0  405 13497.9272 27236.6446   102%     -   64s
     0     0 27217.6418    0  419 13497.9272 27217.6418   102%     -   65s
     0     0 27214.9147    0  421 13497.9272 27214.9147   102%     -   65s
     0     0 27214.1210    0  419 13497.9272 27214.1210   102%     -   66s
     0     0 27170.1185    0  407 13497.9272 27170.1185   101%     -   67s
     0     0 27161.9581    0  404 13497.9272 27161.9581   101%     -   69s
     0     0 27158.7104    0  404 13497.9272 27158.7104   101%     -   70s
     0     0 27157.1635    0  407 13497.9272 27157.1635   101%     -   70s
     0     0 27145.3078    0  414 13497.9272 27145.3078   101%     -   71s
     0     0 27142.5082    0  411 13497.9272 27142.5082   101%     -   71s
     0     0 27142.1014    0  411 13497.9272 27142.1014   101%     -   71s
     0     0 27132.9584    0  405 13497.9272 27132.9584   101%     -   72s
     0     0 27124.9711    0  398 13497.9272 27124.9711   101%     -   72s
     0     0 27123.1550    0  399 13497.9272 27123.1550   101%     -   73s
     0     0 27122.3047    0  406 13497.9272 27122.3047   101%     -   73s
H    0     0                    13919.230472 27122.3047  94.9%     -   73s
     0     0 27100.5174    0  413 13919.2305 27100.5174  94.7%     -   74s
     0     0 27098.7470    0  410 13919.2305 27098.7470  94.7%     -   74s
     0     0 27092.5653    0  408 13919.2305 27092.5653  94.6%     -   75s
     0     0 27089.9556    0  409 13919.2305 27089.9556  94.6%     -   75s
     0     0 27089.5065    0  414 13919.2305 27089.5065  94.6%     -   75s
     0     0 27062.5385    0  401 13919.2305 27062.5385  94.4%     -   76s
     0     0 27059.0410    0  407 13919.2305 27059.0410  94.4%     -   77s
     0     0 27058.0265    0  407 13919.2305 27058.0265  94.4%     -   77s
     0     0 27055.6478    0  408 13919.2305 27055.6478  94.4%     -   77s
     0     0 27054.5928    0  402 13919.2305 27054.5928  94.4%     -   78s
     0     0 27053.8604    0  409 13919.2305 27053.8604  94.4%     -   78s
H    0     0                    13942.470954 27053.7544  94.0%     -   78s
     0     0 27053.7544    0  403 13942.4710 27053.7544  94.0%     -   78s
     0     0 27053.7544    0  409 13942.4710 27053.7544  94.0%     -   79s
     0     0 27053.5207    0  409 13942.4710 27053.5207  94.0%     -   79s
     0     2 27053.4918    0  409 13942.4710 27053.4918  94.0%     -   88s
     1     4 26816.7971    1  385 13942.4710 27052.7843  94.0%  2910   91s
     7    16 26575.7917    3  403 13942.4710 26733.0746  91.7%  2545   96s
    15    32 26463.3351    4  382 13942.4710 26575.6288  90.6%  2800  101s
    31    62 26372.3110    5  397 13942.4710 26462.9168  89.8%  3808  107s
    63    94 26370.3167    6  379 13942.4710 26371.6479  89.1%  3310  113s
    95   168 26233.3068    7  432 13942.4710 26370.0948  89.1%  3100  118s
   169   262 25933.7704    8  377 13942.4710 26370.0948  89.1%  2181  121s
   267   337 26158.3005    8  422 13942.4710 26370.0948  89.1%  1725  125s
   350   401 25896.4999    9  367 13942.4710 26370.0948  89.1%  1582  131s
   423   473 24446.8397    9  261 13942.4710 26370.0948  89.1%  1506  137s
   502   554 25764.5920   10  417 13942.4710 26370.0948  89.1%  1427  140s
   680   718 25633.7115   13  403 13942.4710 26370.0948  89.1%  1285  149s
   773   790 24975.2263   14  366 13942.4710 26370.0948  89.1%  1220  153s
   863   861 24551.2356   15  370 13942.4710 26370.0948  89.1%  1176  156s
  1021   990 24421.0952   16  365 13942.4710 26157.9443  87.6%  1136  160s
  1160  1096 23975.9033   18  365 13942.4710 26156.0980  87.6%  1116  169s
  1238  1163 23616.2555   20  372 13942.4710 26081.3950  87.1%  1115  171s
  1325  1234 22674.6226   22  313 13942.4710 26078.1742  87.0%  1105  175s
  1509  1344 22345.8816   23  358 13942.4710 26006.1696  86.5%  1091  181s
  1606  1410 19416.6472   23  339 13942.4710 25965.7504  86.2%  1091  185s
  1831  1614 22031.0790   24  224 13942.4710 25951.2300  86.1%  1071  194s
  1975  1645 20987.2560   26  295 13942.4710 25951.2300  86.1%  1051  197s
  2008  1675 18026.6137   26  223 13942.4710 25951.2300  86.1%  1057  200s
  2092  1725 20560.2287   28  206 13942.4710 25943.1938  86.1%  1061  209s
  2150  1749 20675.1742   28  204 13942.4710 25943.1938  86.1%  1070  211s
H 2154  1749                    15345.864345 25943.1938  69.1%  1070  211s
H 2168  1749                    15453.119303 25943.1938  67.9%  1069  211s
  2196  1815     cutoff   29      15453.1193 25943.1938  67.9%  1072  216s
  2379  1841 20071.6522   29  211 15453.1193 25943.1938  67.9%  1049  220s
H 2520  1901                    15729.136025 25943.1938  64.9%  1047  225s
H 2523  1872                    15924.171963 25943.1938  62.9%  1048  225s
  2682  1964 16501.3197   33  211 15924.1720 25943.1938  62.9%  1029  230s
H 2702  1934                    16113.144796 25943.1938  61.0%  1024  230s
H 2751  1900                    16431.166374 25943.1938  57.9%  1018  230s
H 2809  1839                    16795.017226 25943.1938  54.5%  1016  230s
H 2852  1767                    16850.379277 25943.1938  54.0%  1018  234s
H 2859  1761                    16872.603200 25943.1938  53.8%  1018  234s
H 2860  1751                    16914.120127 25943.1938  53.4%  1018  234s
H 2861  1751                    16917.202778 25943.1938  53.4%  1018  234s
H 2899  1790                    16937.245482 25943.1938  53.2%  1025  239s
  3010  1850 21860.5706   18  226 16937.2455 25943.1938  53.2%  1048  245s
  3117  1912 19689.9800   19  227 16937.2455 25943.1938  53.2%  1071  251s
H 3150  1896                    16973.367931 25943.1938  52.8%  1074  251s
  3256  1945     cutoff   20      16973.3679 25943.1938  52.8%  1081  256s
H 3259  1942                    16991.930279 25943.1938  52.7%  1083  256s
  3347  2019 18265.5270   20  219 16991.9303 25896.2559  52.4%  1086  262s
  3538  2129 23770.8044   14  338 16991.9303 25896.2559  52.4%  1085  269s
  3726  2143 20841.6139   17  160 16991.9303 25680.2817  51.1%  1094  273s
H 3764  2136                    17015.096319 25646.0866  50.7%  1101  273s
  3774  2252 17942.4124   18  167 17015.0963 25646.0866  50.7%  1106  280s
H 3972  2253                    17031.901929 25646.0866  50.6%  1104  284s
H 3977  2240                    17059.792138 25646.0866  50.3%  1103  284s
  4026  2318     cutoff   21      17059.7921 25646.0866  50.3%  1105  290s
  4217  2442 23703.1593   14  193 17059.7921 25646.0866  50.3%  1111  296s
  4461  2461 18855.6014   17  183 17059.7921 25301.8311  48.3%  1106  300s
H 4470  2454                    17089.500527 25301.8311  48.1%  1106  300s
H 4486  2435                    17134.568045 25301.8311  47.7%  1106  300s
  4507  2436 21697.0257    9  409 17134.5680 25301.8311  47.7%  1106  319s
  4509  2437 21147.6991   17   82 17134.5680 25301.8311  47.7%  1105  332s
  4510  2438 21117.2715   22  321 17134.5680 25301.8311  47.7%  1105  340s
  4512  2439 21512.5069    7  420 17134.5680 25301.8311  47.7%  1105  350s
  4514  2441 20057.5811   26  394 17134.5680 25301.8311  47.7%  1104  355s
  4521  2445 21221.2282   22  409 17134.5680 25301.8311  47.7%  1102  360s
  4526  2449 20789.6768   19  405 17134.5680 25301.8311  47.7%  1101  365s
  4529  2451 23023.8841   14  393 17134.5680 25301.8311  47.7%  1101  371s
  4533  2453 25218.9173   14  430 17134.5680 25301.8311  47.7%  1100  375s
  4536  2455 19372.2552   29  369 17134.5680 25301.8311  47.7%  1099  380s
  4541  2459 17378.4558   36  392 17134.5680 25301.8311  47.7%  1098  385s
  4543  2460 21009.3714   16  403 17134.5680 25301.8311  47.7%  1097  400s
  4544  2461 17400.5289   45  403 17134.5680 25301.8311  47.7%  1097  408s
  4545  2464 25301.8311   13  303 17134.5680 25301.8311  47.7%  1116  413s
  4547  2468 25301.8311   14  319 17134.5680 25301.8311  47.7%  1117  417s
  4551  2474 25301.8311   15  391 17134.5680 25301.8311  47.7%  1119  420s
  4559  2488 25301.8311   16  433 17134.5680 25301.8311  47.7%  1121  425s
  4575  2514 25301.8311   17  368 17134.5680 25301.8311  47.7%  1141  434s
H 4584  2387                    17140.198945 25301.8311  47.6%  1142  434s
  4607  2412 25301.8311   18  372 17140.1989 25301.8311  47.6%  1150  441s
  4639  2455 25301.8311   19  369 17140.1989 25301.8311  47.6%  1172  446s
  4693  2503 24059.3284   20  247 17140.1989 25301.8311  47.6%  1200  451s
  4774  2516 23826.6725   21  235 17140.1989 25301.8311  47.6%  1211  455s
H 4813  2385                    17176.111879 25301.8311  47.3%  1215  455s
  4830  2422 25203.7791   22  334 17176.1119 25301.8311  47.3%  1218  461s
  4905  2415 24261.9670   23  228 17176.1119 25301.8311  47.3%  1228  465s
  5046  2420 23292.8366   24  181 17176.1119 25301.8311  47.3%  1231  473s
  5116  2408 21619.5824   24  197 17176.1119 25301.8311  47.3%  1233  478s
  5188  2394 23164.7046   25  159 17176.1119 25301.8311  47.3%  1233  482s
  5255  2378 22252.2648   26  183 17176.1119 25301.8311  47.3%  1236  487s
  5337  2362 20174.1759   26  162 17176.1119 25301.8311  47.3%  1236  492s
  5380  2372 21628.2841   27  238 17176.1119 25301.8311  47.3%  1241  496s
  5428  2375     cutoff   27      17176.1119 25301.8311  47.3%  1243  500s
  5488  2368     cutoff   28      17176.1119 25301.8311  47.3%  1246  506s
  5552  2374 infeasible   29      17176.1119 25301.8311  47.3%  1249  510s
  5704  2388 19020.0483   33  197 17176.1119 25203.6436  46.7%  1253  519s
  5794  2398 17823.3320   35  169 17176.1119 25155.0152  46.5%  1257  525s
  5893  2404 17196.3724   36  168 17176.1119 25083.3675  46.0%  1258  530s
  6002  2415 20570.9438   21  342 17176.1119 24833.6449  44.6%  1260  537s
H 6018  2298                    17191.468368 24833.6449  44.5%  1258  537s
  6101  2304 18565.8384   24  244 17191.4684 24833.6449  44.5%  1266  541s
  6177  2304 18402.4886   25  240 17191.4684 24833.6449  44.5%  1266  547s
  6290  2303     cutoff   22      17191.4684 24561.9239  42.9%  1264  553s
  6397  2292 21379.2470   24  229 17191.4684 24561.9239  42.9%  1268  559s
  6508  2276 20878.3769   25  291 17191.4684 24381.6157  41.8%  1269  567s
  6639  2272 20172.6342   27  243 17191.4684 23631.3616  37.5%  1274  572s
  6766  2259 17830.2020   32  205 17191.4684 23561.3427  37.1%  1274  580s
  6896  2257 18398.7600   26  312 17191.4684 23406.4142  36.2%  1281  586s
  7000  2267     cutoff   28      17191.4684 23230.2122  35.1%  1286  594s
  7149  2219 18512.8809   20  259 17191.4684 23230.2122  35.1%  1292  601s
H 7166  2108                    17196.972632 23230.2122  35.1%  1292  601s
H 7238  1983                    17278.076476 23187.0917  34.2%  1294  601s
  7245  1986 18093.4035   21  164 17278.0765 23187.0917  34.2%  1294  608s
  7386  1950 infeasible   22      17278.0765 22855.6537  32.3%  1294  616s
  7552  1916 infeasible   25      17278.0765 22808.8902  32.0%  1299  623s
  7753  1858 19196.5192   22  303 17278.0765 22542.1955  30.5%  1299  630s
  7961  1817     cutoff   27      17278.0765 22383.1455  29.5%  1302  639s
  8165  1747 18417.3039   21  220 17278.0765 22091.6786  27.9%  1306  646s
  8398  1644 20399.7516   20  259 17278.0765 22057.8403  27.7%  1306  653s
  8608  1572     cutoff   24      17278.0765 22057.8403  27.7%  1304  661s
  8875  1467 19041.4812   25  178 17278.0765 21351.3088  23.6%  1305  669s
  9208  1340     cutoff   28      17278.0765 21275.6390  23.1%  1298  678s
H 9213  1242                    17282.148821 21275.6390  23.1%  1298  678s
H 9221  1149                    17295.804878 21051.3741  21.7%  1298  678s
H 9234  1058                    17296.058800 20896.9394  20.8%  1299  678s
H 9260   994                    17304.416581 20896.9394  20.8%  1297  678s
H 9299   994                    17310.221151 20827.5059  20.3%  1296  678s
H 9320   994                    17311.773643 20827.5059  20.3%  1296  678s
  9516   902 17869.9853   23  229 17311.7736 20755.1083  19.9%  1289  686s
  9874   772     cutoff   26      17311.7736 20326.9419  17.4%  1275  696s
 10249   524 infeasible   21      17311.7736 20148.3236  16.4%  1263  704s
 10878   431     cutoff   22      17311.7736 19639.3857  13.4%  1229  712s
 12054   834 17571.7082   36  193 17311.7736 18958.7059  9.51%  1130  715s
 15382  1182     cutoff   58      17311.7736 17577.4042  1.53%   903  720s
 22467    25     cutoff   69      17311.7736 17353.8041  0.24%   640  725s
*22797    25              74    17312.217538 17353.8041  0.24%   632  725s

Cutting planes:
  MIR: 355
  Mixing: 1
  Flow cover: 1112
  RLT: 16
  Relax-and-lift: 73

Explored 23175 nodes (14522821 simplex iterations) in 726.15 seconds (2077.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 17312.2 17311.8 17310.2 ... 17191.5

Optimal solution found (tolerance 1.00e-04)
Best objective 1.731221753828e+04, best bound 1.731221753828e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 726.16s
  Master Objective (UB) = 17312.22, θ = 141940.09
  Upper Bound (UB) = 17312.22

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 141940.09
  [DEBUG]   ✓ Scenario 0: θ = 141940.09 ≤ Q = 141940.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 141940.09 ≤ Q = 141940.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 141940.09 ≤ Q = 141940.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 141940.09 ≤ Q = 141940.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 141940.09 ≤ Q = 141940.09 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7edc0720
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8123f8e0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.356380e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6958360.7359
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.336985e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133698.55    0  122 6958360.74 -133698.55   102%     -    0s
H    0     0                    -99616.43177 -133698.55  34.2%     -    0s
H    0     0                    -100329.8101 -133698.55  33.3%     -    0s
H    0     0                    -103598.4973 -116815.75  12.8%     -    0s
     0     0 -116815.75    0  123 -103598.50 -116815.75  12.8%     -    0s
H    0     0                    -112474.7412 -116808.09  3.85%     -    0s
H    0     0                    -113614.5011 -116270.28  2.34%     -    0s
     0     0 -116270.28    0  122 -113614.50 -116270.28  2.34%     -    0s
     0     0 -115892.86    0  126 -113614.50 -115892.86  2.01%     -    0s
H    0     0                    -113850.6621 -115852.64  1.76%     -    0s
     0     0 -115852.64    0  127 -113850.66 -115852.64  1.76%     -    0s
     0     0 -115325.20    0  100 -113850.66 -115325.20  1.30%     -    0s
     0     0 -115298.43    0  104 -113850.66 -115298.43  1.27%     -    0s
     0     0 -115298.43    0  104 -113850.66 -115298.43  1.27%     -    0s
     0     0 -115046.83    0  100 -113850.66 -115046.83  1.05%     -    0s
     0     0 -115009.49    0  103 -113850.66 -115009.49  1.02%     -    0s
     0     0 -115009.14    0  103 -113850.66 -115009.14  1.02%     -    0s
     0     0 -114753.02    0   99 -113850.66 -114753.02  0.79%     -    0s
     0     0 -114712.04    0  101 -113850.66 -114712.04  0.76%     -    0s
     0     0 -114704.31    0  101 -113850.66 -114704.31  0.75%     -    0s
     0     0 -114318.65    0   59 -113850.66 -114318.65  0.41%     -    0s
     0     0 -114245.82    0   68 -113850.66 -114245.82  0.35%     -    0s
     0     0 -114227.20    0   65 -113850.66 -114227.20  0.33%     -    0s
     0     0 -114101.96    0   49 -113850.66 -114101.96  0.22%     -    0s
     0     0 -114101.61    0   47 -113850.66 -114101.61  0.22%     -    0s
     0     0 -114094.16    0   48 -113850.66 -114094.16  0.21%     -    0s
     0     0 -114044.71    0   40 -113850.66 -114044.71  0.17%     -    0s
H    0     0                    -113852.7575 -114028.07  0.15%     -    0s
     0     0 -114028.07    0   40 -113852.76 -114028.07  0.15%     -    0s
     0     0 -113982.40    0   19 -113852.76 -113982.40  0.11%     -    0s
     0     0 -113971.95    0   17 -113852.76 -113971.95  0.10%     -    0s
     0     0 -113971.83    0   17 -113852.76 -113971.83  0.10%     -    0s
     0     0 -113924.99    0   13 -113852.76 -113924.99  0.06%     -    0s
     0     0 -113919.39    0    9 -113852.76 -113919.39  0.06%     -    0s
     0     0 -113878.04    0    2 -113852.76 -113878.04  0.02%     -    0s
H    0     0                    -113853.4829 -113874.51  0.02%     -    0s
     0     0 -113870.77    0    3 -113853.48 -113870.77  0.02%     -    0s
     0     0 -113870.71    0    4 -113853.48 -113870.71  0.02%     -    0s
H    0     0                    -113864.0076 -113870.71  0.01%     -    0s

Explored 1 nodes (1121 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113864 -113853 -113853 ... 6.95836e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.138640076163e+05, best bound -1.138707136559e+05, gap 0.0059%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 130815.69
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113864.01
  [DEBUG]   S×d_nominal = 244679.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 244679.70 + -113864.01 = 130815.69
  [DEBUG]   Current θ from Master = 141940.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11124.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6187.82
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 3812.7816, Absolute Gap = 3812.7816, Relative Gap = 0.220236
  Not converged yet (gap = 3812.78 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x4a21f94f
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42520 rows and 17270 columns
Presolve time: 0.83s
Presolved: 50603 rows, 22430 columns, 314279 nonzeros
Variable types: 20171 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338447.1000
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50603 rows, 22430 columns, 314279 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32330   -7.1636478e+03   0.000000e+00   3.375303e+07      5s
   45704    1.7969069e+04   0.000000e+00   1.183599e+07     10s
   56761    2.5693807e+04   0.000000e+00   1.312588e+06     15s
Concurrent spin time: 1.35s

Solved with dual simplex

Root relaxation: objective 3.880275e+04, 39664 iterations, 17.03 seconds (35.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38802.7537    0   76 -164758.14 38802.7537   124%     -   18s
H    0     0                    -158248.0477 38802.7537   125%     -   18s
H    0     0                    -85853.35934 38802.7537   145%     -   18s
H    0     0                    -85549.56019 38802.7537   145%     -   18s
H    0     0                    -30844.52476 38802.7537   226%     -   18s
H    0     0                    4535.1361762 38802.7537   756%     -   18s
H    0     0                    4699.9899262 38802.7537   726%     -   18s
H    0     0                    5413.9418973 38802.7537   617%     -   18s
H    0     0                    6579.8561126 38802.7537   490%     -   19s
H    0     0                    6619.7369843 38802.7537   486%     -   19s
H    0     0                    6628.4328736 38802.7537   485%     -   19s
H    0     0                    6798.8865534 38802.7537   471%     -   19s
     0     0 34998.1026    0  250 6798.88655 34998.1026   415%     -   23s
H    0     0                    7320.7301210 34996.2162   378%     -   23s
H    0     0                    7320.8059788 34996.2162   378%     -   23s
H    0     0                    9216.1767544 34996.2162   280%     -   23s
H    0     0                    9537.1847820 34996.2162   267%     -   23s
     0     0 34790.4572    0  251 9537.18478 34790.4572   265%     -   24s
     0     0 34420.6069    0  247 9537.18478 34420.6069   261%     -   26s
     0     0 34239.1797    0  251 9537.18478 34239.1797   259%     -   27s
     0     0 34180.4677    0  250 9537.18478 34180.4677   258%     -   28s
     0     0 34179.5148    0  253 9537.18478 34179.5148   258%     -   28s
     0     0 34179.5148    0  253 9537.18478 34179.5148   258%     -   28s
     0     0 30484.3910    0  245 9537.18478 30484.3910   220%     -   36s
H    0     0                    10377.850200 30479.1192   194%     -   36s
     0     0 30013.5023    0  249 10377.8502 30013.5023   189%     -   39s
     0     0 29767.0172    0  293 10377.8502 29767.0172   187%     -   40s
     0     0 29642.8875    0  295 10377.8502 29642.8875   186%     -   41s
     0     0 29526.4734    0  292 10377.8502 29526.4734   185%     -   42s
     0     0 29526.4734    0  292 10377.8502 29526.4734   185%     -   42s
     0     0 27654.8033    0  347 10377.8502 27654.8033   166%     -   48s
H    0     0                    10906.501885 27654.3942   154%     -   48s
H    0     0                    12823.649942 27654.3942   116%     -   48s
H    0     0                    13022.865925 27654.3942   112%     -   48s
     0     0 27063.5138    0  354 13022.8659 27063.5138   108%     -   52s
     0     0 26883.5705    0  360 13022.8659 26883.5705   106%     -   54s
     0     0 26795.5180    0  361 13022.8659 26795.5180   106%     -   56s
     0     0 26746.2446    0  365 13022.8659 26746.2446   105%     -   57s
     0     0 26734.4343    0  378 13022.8659 26734.4343   105%     -   58s
     0     0 26725.6862    0  379 13022.8659 26725.6862   105%     -   58s
     0     0 26705.8988    0  383 13022.8659 26705.8988   105%     -   59s
     0     0 26652.9696    0  377 13022.8659 26652.9696   105%     -   60s
     0     0 26623.6090    0  367 13022.8659 26623.6090   104%     -   61s
     0     0 26615.1621    0  366 13022.8659 26615.1621   104%     -   61s
     0     0 26608.8138    0  378 13022.8659 26608.8138   104%     -   61s
     0     0 26608.5591    0  378 13022.8659 26608.5591   104%     -   61s
     0     0 25997.2311    0  384 13022.8659 25997.2311   100%     -   66s
     0     0 25824.3844    0  378 13022.8659 25824.3844  98.3%     -   68s
     0     0 25725.5189    0  377 13022.8659 25725.5189  97.5%     -   70s
     0     0 25704.7976    0  388 13022.8659 25704.7976  97.4%     -   71s
     0     0 25696.0123    0  394 13022.8659 25696.0123  97.3%     -   72s
     0     0 25691.7319    0  387 13022.8659 25691.7319  97.3%     -   72s
     0     0 25684.4335    0  396 13022.8659 25684.4335  97.2%     -   73s
     0     0 25681.8819    0  397 13022.8659 25681.8819  97.2%     -   73s
     0     0 25681.1532    0  397 13022.8659 25681.1532  97.2%     -   73s
     0     0 25635.8278    0  392 13022.8659 25635.8278  96.9%     -   75s
     0     0 25620.6081    0  400 13022.8659 25620.6081  96.7%     -   76s
     0     0 25609.7414    0  401 13022.8659 25609.7414  96.7%     -   77s
     0     0 25604.5788    0  401 13022.8659 25604.5788  96.6%     -   77s
     0     0 25582.9327    0  404 13022.8659 25582.9327  96.4%     -   77s
     0     0 25577.6948    0  402 13022.8659 25577.6948  96.4%     -   78s
     0     0 25575.9906    0  401 13022.8659 25575.9906  96.4%     -   78s
     0     0 25574.5997    0  406 13022.8659 25574.5997  96.4%     -   78s
     0     0 25538.6961    0  404 13022.8659 25538.6961  96.1%     -   80s
H    0     0                    13363.398508 25538.6245  91.1%     -   81s
     0     0 25530.8040    0  404 13363.3985 25530.8040  91.1%     -   81s
     0     0 25527.3066    0  413 13363.3985 25527.3066  91.0%     -   82s
     0     0 25526.5234    0  416 13363.3985 25526.5234  91.0%     -   82s
     0     0 25490.7879    0  393 13363.3985 25490.7879  90.8%     -   83s
     0     0 25465.8788    0  396 13363.3985 25465.8788  90.6%     -   84s
     0     0 25434.3310    0  396 13363.3985 25434.3310  90.3%     -   85s
     0     0 25410.2351    0  396 13363.3985 25410.2351  90.1%     -   85s
     0     0 25406.4555    0  393 13363.3985 25406.4555  90.1%     -   85s
     0     0 25405.7169    0  394 13363.3985 25405.7169  90.1%     -   85s
     0     0 25393.5816    0  398 13363.3985 25393.5816  90.0%     -   86s
     0     0 25391.4405    0  402 13363.3985 25391.4405  90.0%     -   87s
     0     0 25388.7108    0  403 13363.3985 25388.7108  90.0%     -   87s
     0     0 25388.5204    0  398 13363.3985 25388.5204  90.0%     -   87s
     0     0 25356.8377    0  410 13363.3985 25356.8377  89.7%     -   88s
     0     0 25354.7345    0  403 13363.3985 25354.7345  89.7%     -   89s
     0     0 25354.4797    0  410 13363.3985 25354.4797  89.7%     -   89s
     0     0 25353.1890    0  408 13363.3985 25353.1890  89.7%     -   89s
     0     0 25351.2319    0  410 13363.3985 25351.2319  89.7%     -   91s
     0     0 25351.2319    0  410 13363.3985 25351.2319  89.7%     -   91s
     0     0 25347.3885    0  409 13363.3985 25347.3885  89.7%     -   91s
     0     0 25345.2496    0  404 13363.3985 25345.2496  89.7%     -   92s
     0     0 25343.9935    0  406 13363.3985 25343.9935  89.7%     -   92s
     0     0 25341.3441    0  403 13363.3985 25341.3441  89.6%     -   92s
     0     0 25339.6785    0  403 13363.3985 25339.6785  89.6%     -   93s
H    0     0                    13497.927172 25337.3842  87.7%     -  103s
     0     2 25337.3842    0  403 13497.9272 25337.3842  87.7%     -  104s
     1     4 25094.0567    1  397 13497.9272 25337.3842  87.7%  3277  106s
     7    16 24539.0175    3  397 13497.9272 24955.7099  84.9%  4285  113s
    15    32 24242.7225    4  390 13497.9272 24641.6534  82.6%  4805  116s
    31    48 23717.3381    5  388 13497.9272 24472.7321  81.3%  5780  123s
    47    80 23350.1585    6  310 13497.9272 24472.7321  81.3%  5926  127s
    79   144 23306.0536    7  305 13497.9272 24472.7321  81.3%  4745  137s
   143   182 23098.8570    9  302 13497.9272 24472.7321  81.3%  3712  141s
H  148   182                    13919.230472 24472.7321  75.8%  3604  141s
H  153   182                    13942.470954 24472.7321  75.5%  3574  141s
   181   317 23242.1952    8  305 13942.4710 24472.7321  75.5%  3271  148s
   316   403 22875.2985   12  282 13942.4710 24472.7321  75.5%  2462  153s
   408   483 22729.6236   11  287 13942.4710 24472.7321  75.5%  2256  158s
   498   557 22814.1613   13  273 13942.4710 24472.7321  75.5%  2070  164s
   582   639 22682.7050   12  236 13942.4710 24472.7321  75.5%  1951  169s
   680   720 22701.9968   15  219 13942.4710 24472.7321  75.5%  1825  171s
   790   780 22616.2669   18  230 13942.4710 24472.7321  75.5%  1686  177s
   871   811 17800.6149   17  289 13942.4710 24472.7321  75.5%  1680  181s
   904   854 21984.3250   20  210 13942.4710 24472.7321  75.5%  1690  185s
  1016   943 21283.0084   22  195 13942.4710 24472.7321  75.5%  1631  193s
  1071   980 21485.2975   23  206 13942.4710 24472.7321  75.5%  1598  197s
  1124  1024 20429.6745   24  253 13942.4710 23992.2162  72.1%  1597  202s
  1192  1065 infeasible   24      13942.4710 23992.0389  72.1%  1576  205s
  1304  1135 20142.7607   26  235 13942.4710 23992.0389  72.1%  1553  213s
  1369  1171 16198.7014   27  128 13942.4710 23992.0389  72.1%  1555  215s
  1439  1221 18784.3177   30  234 13942.4710 23992.0389  72.1%  1541  222s
  1529  1269 14893.1959   31   98 13942.4710 23733.5545  70.2%  1525  226s
  1621  1336 16590.1656   32  266 13942.4710 23733.5545  70.2%  1529  232s
  1744  1407 15586.3388   35  245 13942.4710 23733.5545  70.2%  1508  236s
  1928  1460 15596.8396   35  239 13942.4710 23733.5545  70.2%  1492  243s
  1982  1505 15570.7165   36  251 13942.4710 23642.9493  69.6%  1504  248s
  2041  1569 15543.0309   36  247 13942.4710 23642.9493  69.6%  1518  253s
  2145  1615 15187.9997   36  211 13942.4710 23642.9493  69.6%  1506  257s
  2236  1662 15215.5096   36  235 13942.4710 23642.9493  69.6%  1495  263s
  2347  1701     cutoff   36      13942.4710 23642.9493  69.6%  1483  267s
  2431  1776     cutoff   37      13942.4710 23642.9493  69.6%  1487  271s
  2538  1811 21934.0209    7  293 13942.4710 23642.9493  69.6%  1483  277s
  2647  1874 20744.9967    9  275 13942.4710 23642.9493  69.6%  1485  285s
  2746  1927 20020.3775   11  238 13942.4710 23539.0274  68.8%  1498  292s
  2889  2012 16652.4561   13  217 13942.4710 23539.0274  68.8%  1490  300s
  3034  2071 14246.1234   41   11 13942.4710 23455.1982  68.2%  1493  305s
  3158  2160 21096.9078    7  239 13942.4710 23455.1982  68.2%  1508  313s
  3313  2245 19939.0325    9  251 13942.4710 23455.1982  68.2%  1516  319s
  3488  2383 15563.5514   13  268 13942.4710 23314.9798  67.2%  1525  326s
  3724  2509 21973.5138    9  213 13942.4710 23299.3838  67.1%  1507  332s
  3936  2654 20678.9434   12  190 13942.4710 23270.8227  66.9%  1504  340s
  4218  2655 22471.8472    7  403 13942.4710 23225.9176  66.6%  1480  376s
  4220  2656 15284.4343   35   76 13942.4710 23225.9176  66.6%  1480  396s
  4221  2657 21310.8649   20  308 13942.4710 23225.9176  66.6%  1479  404s
  4222  2658 21510.1900   14  363 13942.4710 23225.9176  66.6%  1479  410s
  4223  2658 15491.4531   17  397 13942.4710 23225.9176  66.6%  1479  415s
  4225  2660 22260.5334    9  406 13942.4710 23225.9176  66.6%  1478  420s
  4228  2662 15855.4371   60  413 13942.4710 23225.9176  66.6%  1477  425s
  4232  2664 15521.4904   36  393 13942.4710 23225.9176  66.6%  1475  430s
  4236  2667 20708.8128   14  360 13942.4710 23225.9176  66.6%  1474  437s
  4239  2669 19218.5773   26  320 13942.4710 23225.9176  66.6%  1473  440s
  4242  2671 17355.1435   45  399 13942.4710 23225.9176  66.6%  1472  446s
  4245  2673 20607.3285   22  382 13942.4710 23225.9176  66.6%  1471  450s
  4248  2675 14754.0502   22  409 13942.4710 23225.9176  66.6%  1470  455s
  4249  2676 15725.1794   64  409 13942.4710 23225.9176  66.6%  1470  475s
  4250  2676 17135.0573   29  409 13942.4710 23225.9176  66.6%  1469  482s
  4251  2680 23225.9176   12  390 13942.4710 23225.9176  66.6%  1497  492s
  4253  2683 23225.9176   13  392 13942.4710 23225.9176  66.6%  1497  499s
  4257  2690 23225.9176   14  376 13942.4710 23225.9176  66.6%  1501  506s
  4265  2703 23225.9176   15  296 13942.4710 23225.9176  66.6%  1508  512s
  4281  2717 22854.2772   16  338 13942.4710 23225.9176  66.6%  1535  521s
  4302  2741 22670.8660   17  234 13942.4710 23225.9176  66.6%  1557  526s
  4334  2823 21574.6262   18  206 13942.4710 23225.9176  66.6%  1572  534s
  4440  2841 21469.7505   20  214 13942.4710 23225.9176  66.6%  1603  539s
  4522  2840 19175.8845   22  220 13942.4710 23225.9176  66.6%  1635  546s
  4561  2846 19103.6957   21  196 13942.4710 23225.9176  66.6%  1653  550s
  4608  2842 20892.9836   21  270 13942.4710 23225.9176  66.6%  1664  557s
  4660  2824 18917.5730   21  154 13942.4710 23225.9176  66.6%  1675  564s
  4714  2814 20210.6264   23  323 13942.4710 23225.9176  66.6%  1710  569s
  4762  2817 18160.0341   23  170 13942.4710 23225.9176  66.6%  1731  574s
  4802  2816 20057.1349   24  293 13942.4710 23225.9176  66.6%  1755  578s
  4852  2819 15758.4822   24  210 13942.4710 23225.9176  66.6%  1773  583s
  4905  2830 19740.9435   26  241 13942.4710 23225.9176  66.6%  1780  587s
  4959  2827 14126.2969   28  202 13942.4710 23225.9176  66.6%  1794  594s
  5027  2822 17111.3893   29  155 13942.4710 23225.9176  66.6%  1817  599s
  5087  2827 15582.2695   31  158 13942.4710 23198.2455  66.4%  1830  603s
  5153  2827     cutoff   30      13942.4710 23198.2455  66.4%  1841  609s
  5218  2811 14019.0336   34  116 13942.4710 23198.2455  66.4%  1856  613s
  5307  2816 20573.5165   25  296 13942.4710 23198.2455  66.4%  1867  619s
  5389  2819 18067.8905   28  174 13942.4710 23198.2455  66.4%  1887  626s
  5474  2801 16238.8842   30  120 13942.4710 22663.0655  62.5%  1905  630s
  5564  2793 14716.7260   33  131 13942.4710 22663.0655  62.5%  1925  636s
  5659  2758 18252.0422   20  228 13942.4710 22245.7593  59.6%  1949  644s
  5774  2734 16764.8105   22  183 13942.4710 22245.7593  59.6%  1960  651s
  5895  2725 15828.1526   24  232 13942.4710 21691.7513  55.6%  1978  656s
  6002  2712     cutoff   28      13942.4710 21680.0578  55.5%  1990  662s
  6146  2703 16353.5973   22  188 13942.4710 21369.3437  53.3%  2002  667s
  6282  2682     cutoff   25      13942.4710 21064.8522  51.1%  2006  673s
  6439  2640 16210.3857   22  233 13942.4710 21064.8522  51.1%  2022  679s
  6584  2595     cutoff   22      13942.4710 20829.3687  49.4%  2037  686s
  6736  2577 17199.3504   24  266 13942.4710 20515.5902  47.1%  2055  693s
  6894  2528 14380.8789   27  208 13942.4710 20492.6490  47.0%  2068  699s
  7074  2455     cutoff   22      13942.4710 20421.6981  46.5%  2072  706s
  7269  2378 16448.4933   23  254 13942.4710 20193.2709  44.8%  2091  714s
  7466  2286 14974.2351   25   77 13942.4710 19867.7844  42.5%  2098  721s
  7689  2171 14267.4275   22  132 13942.4710 19491.7331  39.8%  2110  728s
  7926  2041     cutoff   27      13942.4710 19229.6692  37.9%  2116  738s
  8158  1898 15481.1261   29  213 13942.4710 18968.4791  36.0%  2127  746s
  8435  1677 16791.4644   20  289 13942.4710 18610.5954  33.5%  2129  756s
  8734  1392     cutoff   29      13942.4710 18447.4608  32.3%  2130  762s
  9123  1148     cutoff   26      13942.4710 17278.6153  23.9%  2106  770s
  9286   998     cutoff   22      13942.4710 17007.0546  22.0%  2088  775s

Cutting planes:
  Learned: 1
  MIR: 394
  Flow cover: 939
  Zero half: 1
  RLT: 11
  Relax-and-lift: 67

Explored 9423 nodes (19701363 simplex iterations) in 775.30 seconds (2376.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13942.5 13919.2 13497.9 ... 9216.18

Optimal solution found (tolerance 1.00e-04)
Best objective 1.394247095352e+04, best bound 1.394247095352e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 775.31s
  Master Objective (UB) = 13942.47, θ = 156374.55
  Upper Bound (UB) = 13942.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156374.55
  [DEBUG]   ✓ Scenario 0: θ = 156374.55 ≤ Q = 156374.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156374.55 ≤ Q = 156374.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156374.55 ≤ Q = 156374.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156374.55 ≤ Q = 156374.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156374.55 ≤ Q = 156374.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156374.55 ≤ Q = 156374.55 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xe3576cb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0e3576cb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.365573e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6776723.4912
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.528634e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152863.41    0  131 6776723.49 -152863.41   102%     -    0s
H    0     0                    -111605.7255 -152863.41  37.0%     -    0s
H    0     0                    -112195.2379 -152863.41  36.2%     -    0s
H    0     0                    -112506.0383 -152863.41  35.9%     -    0s
H    0     0                    -129680.8715 -152863.41  17.9%     -    0s
     0     0 -133405.27    0   45 -129680.87 -133405.27  2.87%     -    0s
H    0     0                    -132128.1542 -133285.33  0.88%     -    0s
     0     0 -132595.49    0   35 -132128.15 -132595.49  0.35%     -    0s
     0     0 -132582.00    0   33 -132128.15 -132582.00  0.34%     -    0s
     0     0 -132569.27    0   32 -132128.15 -132569.27  0.33%     -    0s
     0     0 -132565.88    0   31 -132128.15 -132565.88  0.33%     -    0s
     0     0 -132441.56    0   13 -132128.15 -132441.56  0.24%     -    0s
H    0     0                    -132352.3715 -132418.88  0.05%     -    0s
     0     0 -132396.87    0    8 -132352.37 -132396.87  0.03%     -    0s
H    0     0                    -132355.2587 -132396.68  0.03%     -    0s
     0     0 -132396.68    0    9 -132355.26 -132396.68  0.03%     -    0s
     0     0 -132396.48    0    7 -132355.26 -132396.48  0.03%     -    0s
     0     0 -132389.65    0    4 -132355.26 -132389.65  0.03%     -    0s
     0     0 -132389.65    0    8 -132355.26 -132389.65  0.03%     -    0s
H    0     0                    -132379.1559 -132389.65  0.01%     -    0s

Explored 1 nodes (529 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -132379 -132355 -132352 ... 6.77672e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.323791559287e+05, best bound -1.323896501167e+05, gap 0.0079%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 142124.31
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132379.16
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -132379.16 = 142124.31
  [DEBUG]   Current θ from Master = 156374.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14250.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -307.77
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 443.0350, Absolute Gap = 443.0350, Relative Gap = 0.031776
  Not converged yet (gap = 443.04 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x0674bc02
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49610 rows and 20150 columns
Presolve time: 0.97s
Presolved: 58803 rows, 25790 columns, 365729 nonzeros
Variable types: 23531 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338447.1000
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58803 rows, 25790 columns, 365729 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32025    6.1144475e+02   0.000000e+00   3.583599e+06      5s
   44225    1.4106342e+04   0.000000e+00   6.367034e+06     10s
   53294    2.5906736e+04   0.000000e+00   1.275873e+06     15s
   63957    3.2815388e+04   0.000000e+00   3.537866e+06     20s
Concurrent spin time: 2.95s (can be avoided by choosing Method=3)

Solved with primal simplex

Root relaxation: objective 3.880275e+04, 86249 iterations, 25.99 seconds (48.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38802.7537    0   76 -164758.14 38802.7537   124%     -   27s
H    0     0                    -158248.0477 38802.7537   125%     -   27s
H    0     0                    -111770.6026 38802.7537   135%     -   27s
H    0     0                    -105980.8289 38802.7537   137%     -   27s
H    0     0                    -105777.2876 38802.7537   137%     -   27s
H    0     0                    -97802.87131 38802.7537   140%     -   27s
H    0     0                    -97787.90602 38802.7537   140%     -   27s
H    0     0                    -97684.14772 38802.7537   140%     -   27s
H    0     0                    -43212.61463 38802.7537   190%     -   27s
H    0     0                    4688.8100680 38802.7537   728%     -   27s
H    0     0                    5413.9418973 38802.7537   617%     -   28s
H    0     0                    6579.8561126 38802.5329   490%     -   28s
H    0     0                    6689.1713443 38802.5329   480%     -   28s
H    0     0                    6700.2994770 38802.5329   479%     -   28s
H    0     0                    6798.8865534 38802.5329   471%     -   28s
H    0     0                    9216.1767544 35182.3656   282%     -   33s
H    0     0                    9253.2234768 35182.3656   280%     -   33s
H    0     0                    9382.5464387 35182.3656   275%     -   33s
H    0     0                    9453.8917376 35182.3656   272%     -   33s
H    0     0                    9862.4929624 35182.3656   257%     -   33s
     0     0 35182.3656    0  253 9862.49296 35182.3656   257%     -   33s
     0     0 34950.2912    0  259 9862.49296 34950.2912   254%     -   35s
     0     0 34783.8743    0  258 9862.49296 34783.8743   253%     -   36s
     0     0 34783.8743    0  259 9862.49296 34783.8743   253%     -   37s
     0     0 34780.7733    0  246 9862.49296 34780.7733   253%     -   38s
     0     0 34780.7733    0  251 9862.49296 34780.7733   253%     -   38s
     0     0 34780.7321    0  251 9862.49296 34780.7321   253%     -   38s
     0     0 34780.7321    0  251 9862.49296 34780.7321   253%     -   39s
H    0     0                    10128.235732 31589.5609   212%     -   47s
H    0     0                    11946.177722 31589.5609   164%     -   47s
H    0     0                    12152.065680 31589.5609   160%     -   47s
     0     0 31589.5609    0  236 12152.0657 31589.5609   160%     -   47s
     0     0 31162.8795    0  306 12152.0657 31162.8795   156%     -   52s
     0     0 31082.1030    0  305 12152.0657 31082.1030   156%     -   53s
     0     0 30807.7682    0  312 12152.0657 30807.7682   154%     -   55s
     0     0 30708.1089    0  311 12152.0657 30708.1089   153%     -   56s
     0     0 30573.6267    0  308 12152.0657 30573.6267   152%     -   57s
     0     0 30559.1476    0  311 12152.0657 30559.1476   151%     -   58s
     0     0 30556.3815    0  305 12152.0657 30556.3815   151%     -   58s
     0     0 30554.1193    0  311 12152.0657 30554.1193   151%     -   58s
     0     0 30553.9770    0  313 12152.0657 30553.9770   151%     -   58s
H    0     0                    12986.354609 28332.9488   118%     -   69s
H    0     0                    13330.371027 28332.9488   113%     -   69s
H    0     0                    13412.282386 28332.9488   111%     -   69s
H    0     0                    13495.575431 28332.9488   110%     -   69s
     0     0 28332.9488    0  355 13495.5754 28332.9488   110%     -   69s
     0     0 27135.7516    0  341 13495.5754 27135.7516   101%     -   74s
     0     0 26969.6531    0  347 13495.5754 26969.6531   100%     -   77s
     0     0 26907.2123    0  345 13495.5754 26907.2123  99.4%     -   78s
     0     0 26889.0186    0  356 13495.5754 26889.0186  99.2%     -   79s
     0     0 26862.2623    0  342 13495.5754 26862.2623  99.0%     -   79s
     0     0 26853.4103    0  347 13495.5754 26853.4103  99.0%     -   80s
     0     0 26845.7782    0  354 13495.5754 26845.7782  98.9%     -   81s
     0     0 26825.9723    0  298 13495.5754 26825.9723  98.8%     -   81s
     0     0 26819.1440    0  297 13495.5754 26819.1440  98.7%     -   82s
     0     0 26815.7478    0  300 13495.5754 26815.7478  98.7%     -   82s
     0     0 26815.5880    0  303 13495.5754 26815.5880  98.7%     -   82s
     0     0 26141.6631    0  326 13495.5754 26141.6631  93.7%     -   89s
     0     0 25977.0753    0  380 13495.5754 25977.0753  92.5%     -   91s
     0     0 25923.5411    0  383 13495.5754 25923.5411  92.1%     -   93s
     0     0 25888.0848    0  381 13495.5754 25888.0848  91.8%     -   94s
     0     0 25868.6389    0  389 13495.5754 25868.6389  91.7%     -   95s
     0     0 25848.3237    0  387 13495.5754 25848.3237  91.5%     -   96s
     0     0 25843.1574    0  394 13495.5754 25843.1574  91.5%     -   96s
     0     0 25842.0591    0  394 13495.5754 25842.0591  91.5%     -   96s
     0     0 25749.3484    0  382 13495.5754 25749.3484  90.8%     -   99s
     0     0 25710.2767    0  387 13495.5754 25710.2767  90.5%     -  100s
     0     0 25699.2383    0  390 13495.5754 25699.2383  90.4%     -  101s
     0     0 25692.3048    0  397 13495.5754 25692.3048  90.4%     -  101s
     0     0 25689.9790    0  402 13495.5754 25689.9790  90.4%     -  102s
     0     0 25688.4189    0  401 13495.5754 25688.4189  90.3%     -  102s
     0     0 25685.5761    0  399 13495.5754 25685.5761  90.3%     -  102s
     0     0 25685.5730    0  399 13495.5754 25685.5730  90.3%     -  102s
     0     0 25662.3153    0  398 13495.5754 25662.3153  90.2%     -  103s
     0     0 25655.4842    0  400 13495.5754 25655.4842  90.1%     -  105s
     0     0 25650.6579    0  401 13495.5754 25650.6579  90.1%     -  106s
     0     0 25648.7617    0  395 13495.5754 25648.7617  90.1%     -  106s
     0     0 25646.8960    0  399 13495.5754 25646.8960  90.0%     -  106s
     0     0 25646.0530    0  396 13495.5754 25646.0530  90.0%     -  106s
     0     0 25594.0896    0  396 13495.5754 25594.0896  89.6%     -  108s
     0     0 25588.6280    0  400 13495.5754 25588.6280  89.6%     -  108s
     0     0 25587.3631    0  397 13495.5754 25587.3631  89.6%     -  108s
     0     0 25568.2474    0  388 13495.5754 25568.2474  89.5%     -  109s
     0     0 25556.4296    0  399 13495.5754 25556.4296  89.4%     -  113s
     0     0 25551.3579    0  389 13495.5754 25551.3579  89.3%     -  114s
     0     0 25549.8662    0  392 13495.5754 25549.8662  89.3%     -  114s
     0     0 25533.2215    0  393 13495.5754 25533.2215  89.2%     -  115s
     0     0 25528.5398    0  393 13495.5754 25528.5398  89.2%     -  116s
     0     0 25523.1052    0  407 13495.5754 25523.1052  89.1%     -  117s
     0     0 25521.8796    0  399 13495.5754 25521.8796  89.1%     -  117s
     0     0 25510.8923    0  405 13495.5754 25510.8923  89.0%     -  118s
     0     0 25504.1140    0  414 13495.5754 25504.1140  89.0%     -  119s
     0     0 25500.6682    0  418 13495.5754 25500.6682  89.0%     -  119s
     0     0 25498.7651    0  416 13495.5754 25498.7651  88.9%     -  119s
     0     0 25497.9019    0  419 13495.5754 25497.9019  88.9%     -  119s
     0     0 25488.1424    0  410 13495.5754 25488.1424  88.9%     -  120s
     0     0 25487.1184    0  410 13495.5754 25487.1184  88.9%     -  121s
     0     0 25482.0855    0  415 13495.5754 25482.0855  88.8%     -  122s
     0     0 25480.1715    0  423 13495.5754 25480.1715  88.8%     -  122s
     0     0 25478.8586    0  421 13495.5754 25478.8586  88.8%     -  123s
     0     0 25477.1101    0  418 13495.5754 25477.1101  88.8%     -  123s
     0     0 25475.0097    0  414 13495.5754 25475.0097  88.8%     -  124s
     0     0 25474.1777    0  417 13495.5754 25474.1777  88.8%     -  124s
     0     0 25451.7349    0  414 13495.5754 25451.7349  88.6%     -  125s
     0     0 25447.8350    0  421 13495.5754 25447.8350  88.6%     -  126s
     0     0 25445.6617    0  422 13495.5754 25445.6617  88.5%     -  126s
     0     0 25445.4696    0  420 13495.5754 25445.4696  88.5%     -  126s
     0     0 25444.5347    0  418 13495.5754 25444.5347  88.5%     -  127s
     0     0 25443.9790    0  423 13495.5754 25443.9790  88.5%     -  127s
     0     0 25443.9790    0  424 13495.5754 25443.9790  88.5%     -  128s
     0     0 25443.3937    0  420 13495.5754 25443.3937  88.5%     -  128s
     0     0 25443.2307    0  421 13495.5754 25443.2307  88.5%     -  128s
     0     0 25440.5866    0  421 13495.5754 25440.5866  88.5%     -  129s
     0     2 25440.5866    0  421 13495.5754 25440.5866  88.5%     -  143s
     1     4 25289.6812    1  402 13495.5754 25439.2077  88.5%  4067  145s
     3     8 25066.0745    2  394 13495.5754 25286.3959  87.4%  5103  150s
    15    32 24581.1834    4  409 13495.5754 25022.3160  85.4%  5375  159s
    31    48 23679.7240    5  393 13495.5754 24580.5994  82.1%  7357  168s
    47    80 23091.3026    6  274 13495.5754 24580.5994  82.1%  6825  172s
H   49    80                    13879.443602 24580.5994  77.1%  6660  172s
    79   146 23025.7678    7  269 13879.4436 24580.5994  77.1%  5203  184s
   145   184 22848.0382    9  255 13879.4436 24580.5994  77.1%  3699  188s
   183   241 21943.6810    9  183 13879.4436 24580.5994  77.1%  3303  195s
   247   340 22772.0861   10  260 13879.4436 24580.5994  77.1%  2875  203s
   354   432 22579.2385    9  259 13879.4436 24580.5994  77.1%  2515  207s
   456   455 22525.8296   13  251 13879.4436 24580.5994  77.1%  2421  213s
   491   493 22489.0422   14  243 13879.4436 24580.5994  77.1%  2457  218s
   535   522 22119.0789   15  210 13879.4436 24580.5994  77.1%  2487  221s
   578   553 20804.3066   14  150 13879.4436 24580.5994  77.1%  2550  226s
   683   624 22067.3357   16  173 13879.4436 24580.5994  77.1%  2637  236s
   726   657 22008.3787   17  174 13879.4436 24580.5994  77.1%  2658  240s
   778   690 21970.1822   18  188 13879.4436 24580.5994  77.1%  2660  247s
   827   722 15440.3545   18   55 13879.4436 24580.5994  77.1%  2653  252s
   873   746 21680.4148   19  176 13879.4436 24375.4785  75.6%  2663  258s
   925   780 15537.9647   17   59 13879.4436 24375.4785  75.6%  2659  262s
   967   810 21779.2005   19  196 13879.4436 24375.4785  75.6%  2676  265s
  1013   848 21653.2560   20  184 13879.4436 24375.4785  75.6%  2677  271s
  1065   878 21655.9670   20  178 13879.4436 24182.0064  74.2%  2663  278s
  1117   919 17163.6735   21  185 13879.4436 24182.0064  74.2%  2675  285s
  1224  1003 21286.3973   22  168 13879.4436 24182.0064  74.2%  2647  293s
  1284  1059 21265.2585   23  165 13879.4436 24182.0064  74.2%  2624  299s
  1358  1130 21246.4711   24  163 13879.4436 24116.2981  73.8%  2596  301s
  1441  1212 21219.6080   25  196 13879.4436 24116.2981  73.8%  2554  308s
  1546  1273 21190.3677   26  159 13879.4436 24116.2981  73.8%  2509  315s
  1655  1372     cutoff   25      13879.4436 24116.2981  73.8%  2501  323s
  1786  1446 20956.0784   27  167 13879.4436 24029.8378  73.1%  2452  330s
  1917  1522     cutoff   26      13879.4436 23933.7259  72.4%  2452  335s
  2041  1632 14130.6836   28   76 13879.4436 23933.7259  72.4%  2431  341s
  2191  1758 20438.9770   29  220 13879.4436 23933.7259  72.4%  2434  346s
  2353  1853 14582.8987   29   73 13879.4436 23933.7259  72.4%  2421  353s
  2499  1952 19332.9727   32  152 13879.4436 23818.0775  71.6%  2434  359s
  2638  2100 18993.0243   36  194 13879.4436 23637.6388  70.3%  2481  365s
  2816  2250 18276.8027   42  112 13879.4436 23637.6388  70.3%  2484  372s
  3056  2348 15533.5701   47  173 13879.4436 23570.8985  69.8%  2439  378s
  3191  2496 15267.6015   50  219 13879.4436 23350.1645  68.2%  2451  383s
  3381  2620 14455.1673   60  209 13879.4436 23350.1645  68.2%  2451  393s
  3574  2621 19059.5247   20  421 13879.4436 23331.1244  68.1%  2460  425s
  3576  2622 16085.6232   22   76 13879.4436 23331.1244  68.1%  2458  452s
  3577  2623 18867.3191   35  316 13879.4436 23331.1244  68.1%  2458  464s
  3578  2624 20880.8955   26  384 13879.4436 23331.1244  68.1%  2457  470s
  3579  2624 17448.6396   22  367 13879.4436 23331.1244  68.1%  2456  476s
  3581  2626 16085.6232   22  436 13879.4436 23331.1244  68.1%  2455  482s
  3582  2626 16701.0555   21  417 13879.4436 23331.1244  68.1%  2454  485s
  3586  2629 19636.3681   24  404 13879.4436 23331.1244  68.1%  2452  490s
  3590  2632 18960.3456   41  430 13879.4436 23331.1244  68.1%  2449  497s
  3592  2633 20361.6552   19  382 13879.4436 23331.1244  68.1%  2447  500s
  3595  2635 22088.5992    9  371 13879.4436 23331.1244  68.1%  2445  505s
  3598  2637 21197.8447   13  404 13879.4436 23331.1244  68.1%  2443  510s
  3602  2640 18227.5393   44  436 13879.4436 23331.1244  68.1%  2441  516s
  3605  2642 18176.8207   11  437 13879.4436 23331.1244  68.1%  2439  520s
  3609  2644 15915.2976   18  442 13879.4436 23331.1244  68.1%  2436  552s
  3610  2645 16913.1794   14  442 13879.4436 23331.1244  68.1%  2435  563s
  3611  2649 23331.1244   10  434 13879.4436 23331.1244  68.1%  2475  572s
  3613  2652 23331.1244   11  422 13879.4436 23331.1244  68.1%  2476  582s
  3617  2659 23331.1244   12  374 13879.4436 23331.1244  68.1%  2480  591s
  3625  2672 23331.1244   13  390 13879.4436 23331.1244  68.1%  2493  597s
  3641  2683 23331.1244   14  358 13879.4436 23331.1244  68.1%  2513  609s
  3657  2707 23206.5044   15  311 13879.4436 23331.1244  68.1%  2544  619s
  3689  2804 21257.1397   16  311 13879.4436 23331.1244  68.1%  2554  629s
  3802  2830 20801.2949   19  228 13879.4436 23331.1244  68.1%  2590  636s
  3873  2865 20828.0175   18  216 13879.4436 23331.1244  68.1%  2587  642s
  3950  2863 20252.2347   20  224 13879.4436 23331.1244  68.1%  2582  648s
  3983  2880 20572.2880   20  312 13879.4436 23331.1244  68.1%  2588  654s
  4030  2894 19928.5033   20  299 13879.4436 23331.1244  68.1%  2591  658s
  4076  2896 20378.1784   20  288 13879.4436 23331.1244  68.1%  2587  664s
  4135  2899 19876.8098   22  166 13879.4436 23331.1244  68.1%  2586  670s
  4189  2906 19052.6159   24  163 13879.4436 23331.1244  68.1%  2595  677s
  4245  2906 18449.3812   24  156 13879.4436 23331.1244  68.1%  2601  684s
  4305  2900 17955.1971   25  175 13879.4436 23331.1244  68.1%  2603  689s
  4372  2888 18183.0587   27  244 13879.4436 23331.1244  68.1%  2606  697s
  4427  2899 16451.6266   29  150 13879.4436 23331.1244  68.1%  2619  704s
  4483  2896 14516.9290   30  201 13879.4436 23331.1244  68.1%  2630  711s
  4548  2904     cutoff   29      13879.4436 23331.1244  68.1%  2647  717s
  4602  2917 14810.1184   30  191 13879.4436 23331.1244  68.1%  2672  724s
  4665  2936     cutoff   19      13879.4436 23331.1244  68.1%  2674  730s
  4730  2954 22410.0725   17  233 13879.4436 23331.1244  68.1%  2694  736s
  4800  2977 21636.4901   19  302 13879.4436 23331.1244  68.1%  2717  742s
  4877  2986 20638.3858   22  262 13879.4436 23331.1244  68.1%  2724  749s
  4962  2995 20170.9108   24  208 13879.4436 23331.1244  68.1%  2723  755s
  5060  3004 18666.1725   27  223 13879.4436 23288.5368  67.8%  2735  763s
  5148  3042 15870.1725   30   24 13879.4436 22710.4658  63.6%  2750  770s
  5258  3058 17378.0631   31  154 13879.4436 22710.4658  63.6%  2755  777s
  5361  3075 16610.6175   33  119 13879.4436 22710.4658  63.6%  2754  783s
  5480  3084 14953.5633   37  192 13879.4436 22623.5800  63.0%  2762  791s
  5582  3118 13941.4920   40  148 13879.4436 22450.0924  61.8%  2767  798s
  5694  3139 20547.9009   17  202 13879.4436 22319.9478  60.8%  2788  806s
  5772  3177 19224.4347   18  182 13879.4436 22319.9478  60.8%  2803  814s
  5912  3185 18420.5913   20  175 13879.4436 22319.9478  60.8%  2806  822s
  6031  3199 16723.4793   23  180 13879.4436 22288.1666  60.6%  2807  830s
  6186  3219 15441.6853   26  166 13879.4436 22288.1666  60.6%  2818  839s
  6317  3226 infeasible   28      13879.4436 21865.1256  57.5%  2839  848s
  6469  3248 19227.5216   18  229 13879.4436 21624.0549  55.8%  2866  856s
  6628  3255 17882.9256   22  278 13879.4436 21624.0549  55.8%  2878  865s
  6815  3248 17006.6712   26  208 13879.4436 21611.5730  55.7%  2882  874s
  6935  3256 14079.6281   34  274 13879.4436 21611.5730  55.7%  2891  883s
  7140  3248 17138.1637   22  157 13879.4436 21611.5730  55.7%  2896  894s
  7330  3242 15949.3340   27  113 13879.4436 21611.5730  55.7%  2908  906s
  7543  3223 16323.6353   20  245 13879.4436 21611.5730  55.7%  2925  918s
  7746  3201     cutoff   22      13879.4436 21306.0489  53.5%  2948  930s
  8001  3157 16603.7784   22  274 13879.4436 21169.0534  52.5%  2958  941s
  8229  3154     cutoff   26      13879.4436 21150.0889  52.4%  2964  953s
  8520  3093     cutoff   20      13879.4436 20895.1390  50.5%  2972  966s
  8803  3049 18319.3008   26  187 13879.4436 20849.5507  50.2%  2986  978s
  9110  3046 16285.6324   22  240 13879.4436 20617.6918  48.5%  2999  992s
  9408  2993     cutoff   27      13879.4436 20552.6677  48.1%  3004 1006s
  9720  2958 17020.0536   20  250 13879.4436 20338.3976  46.5%  3014 1019s
 10078  2913 15905.1277   22  125 13879.4436 20338.3976  46.5%  3020 1032s
 10459  2853     cutoff   21      13879.4436 20170.0736  45.3%  3028 1045s
 10846  2760 18795.2814   18  241 13879.4436 19954.4115  43.8%  3040 1060s
 11254  2655     cutoff   25      13879.4436 19954.4115  43.8%  3050 1076s
 11643  2641 17040.8486   18  218 13879.4436 19728.5736  42.1%  3063 1093s
 12044  2732 15258.5270   25  271 13879.4436 19561.8970  40.9%  3076 1109s
 12483  2733     cutoff   25      13879.4436 19365.5125  39.5%  3075 1123s
 12545  2742     cutoff   27      13879.4436 19365.5125  39.5%  3075 1138s
 12600  2742     cutoff   22      13879.4436 19340.4148  39.3%  3078 1154s
 12670  2745 16243.3165   18  151 13879.4436 19273.2187  38.9%  3078 1170s
 12793  2760 15947.5155   19  154 13879.4436 19273.2187  38.9%  3077 1188s
 13162  2775 15455.6568   23  167 13879.4436 19267.4462  38.8%  3065 1205s
 13211  2792 15036.2238   24  181 13879.4436 19267.4462  38.8%  3071 1222s
 13261  2820 14456.6482   25  231 13879.4436 19267.4462  38.8%  3074 1241s
 13651  2841 15207.6988   22  162 13879.4436 19267.4462  38.8%  3072 1261s
 14266  2907 17027.5705   19  257 13879.4436 18866.3277  35.9%  3066 1280s
 14913  2905     cutoff   26      13879.4436 18866.3277  35.9%  3059 1300s
 15510  2886     cutoff   25      13879.4436 18428.3240  32.8%  3068 1322s
 16216  2874 14897.0168   21  258 13879.4436 18318.3361  32.0%  3061 1343s
 16896  2825     cutoff   24      13879.4436 18133.6077  30.7%  3060 1367s
 17636  2740 infeasible   26      13879.4436 17927.4680  29.2%  3054 1390s
 18431  2671     cutoff   28      13879.4436 17719.6853  27.7%  3046 1414s
 19306  2449 13990.2562   21  216 13879.4436 17514.2764  26.2%  3031 1440s
 20192  2087     cutoff   20      13879.4436 17236.6331  24.2%  3023 1464s
 21245  1483     cutoff   25      13879.4436 16870.8628  21.6%  2993 1490s
 22460   336     cutoff   26      13879.4436 16536.4232  19.1%  2943 1515s
 24164     0     cutoff   34      13879.4436 15570.9432  12.2%  2829 1521s

Cutting planes:
  Learned: 2
  MIR: 558
  Mixing: 2
  Flow cover: 1419
  RLT: 20
  Relax-and-lift: 116

Explored 24577 nodes (68894413 simplex iterations) in 1521.49 seconds (5293.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13879.4 13495.6 13412.3 ... 9453.89

Optimal solution found (tolerance 1.00e-04)
Best objective 1.387944360191e+04, best bound 1.387944360191e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1521.55s
  Master Objective (UB) = 13879.44, θ = 157284.93
  Upper Bound (UB) = 13879.44

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157284.93
  [DEBUG]   ✓ Scenario 0: θ = 157284.93 ≤ Q = 157284.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157284.93 ≤ Q = 157284.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157284.93 ≤ Q = 157284.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157284.93 ≤ Q = 157284.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157284.93 ≤ Q = 157284.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157284.93 ≤ Q = 157284.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157284.93 ≤ Q = 157284.93 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6a6a7081
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x95958f7f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.359616e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6730381.6636
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.484258e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148425.80    0  124 6730381.66 -148425.80   102%     -    0s
H    0     0                    -113921.6866 -148425.80  30.3%     -    0s
H    0     0                    -114236.4969 -148425.80  29.9%     -    0s
H    0     0                    -114864.4146 -148425.80  29.2%     -    0s
     0     0 -129713.78    0   79 -114864.41 -129713.78  12.9%     -    0s
H    0     0                    -126176.1813 -129585.91  2.70%     -    0s
H    0     0                    -126496.0865 -129585.91  2.44%     -    0s
H    0     0                    -127272.4633 -129585.91  1.82%     -    0s
H    0     0                    -127592.3686 -129585.91  1.56%     -    0s
     0     0 -128816.44    0   80 -127592.37 -128816.44  0.96%     -    0s
     0     0 -128789.68    0   76 -127592.37 -128789.68  0.94%     -    0s
     0     0 -128363.39    0   40 -127592.37 -128363.39  0.60%     -    0s
     0     0 -128259.75    0   41 -127592.37 -128259.75  0.52%     -    0s
     0     0 -128215.75    0   38 -127592.37 -128215.75  0.49%     -    0s
     0     0 -128149.90    0   40 -127592.37 -128149.90  0.44%     -    0s
     0     0 -127925.06    0   23 -127592.37 -127925.06  0.26%     -    0s
     0     0 -127896.95    0   27 -127592.37 -127896.95  0.24%     -    0s
     0     0 -127843.24    0   22 -127592.37 -127843.24  0.20%     -    0s
     0     0 -127843.24    0   33 -127592.37 -127843.24  0.20%     -    0s
     0     0 -127843.24    0   32 -127592.37 -127843.24  0.20%     -    0s
     0     0 -127805.23    0   24 -127592.37 -127805.23  0.17%     -    0s
     0     0 -127801.42    0   23 -127592.37 -127801.42  0.16%     -    0s
     0     0 -127715.71    0   16 -127592.37 -127715.71  0.10%     -    0s
     0     0 -127681.30    0   17 -127592.37 -127681.30  0.07%     -    0s
     0     0 -127671.38    0   17 -127592.37 -127671.38  0.06%     -    0s
     0     0 -127661.54    0   17 -127592.37 -127661.54  0.05%     -    0s
     0     0 -127656.96    0   16 -127592.37 -127656.96  0.05%     -    0s
     0     0 -127654.71    0   16 -127592.37 -127654.71  0.05%     -    0s
     0     0 -127653.61    0   16 -127592.37 -127653.61  0.05%     -    0s
     0     0 -127653.59    0    9 -127592.37 -127653.59  0.05%     -    0s
     0     0 -127637.80    0    2 -127592.37 -127637.80  0.04%     -    0s
     0     0 -127637.80    0    7 -127592.37 -127637.80  0.04%     -    0s
H    0     0                    -127613.3021 -127637.80  0.02%     -    0s
H    0     0                    -127624.9771 -127637.80  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 4
  Flow cover: 2
  RLT: 2

Explored 1 nodes (974 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -127625 -127613 -127592 ... 6.73038e+06

Optimal solution found (tolerance 1.00e-04)
Best objective -1.276249770899e+05, best bound -1.276371304820e+05, gap 0.0095%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 146878.49
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127624.98
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -127624.98 = 146878.49
  [DEBUG]   Current θ from Master = 157284.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10406.44 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3473.00
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 380.0077, Absolute Gap = 380.0077, Relative Gap = 0.027379
  Not converged yet (gap = 380.01 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x1f839acf
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56680 rows and 23020 columns
Presolve time: 1.10s
Presolved: 67023 rows, 29160 columns, 417239 nonzeros
Variable types: 26901 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338447.1000
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67023 rows, 29160 columns, 417239 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32061   -3.7203762e+04   0.000000e+00   6.490676e+08      5s
   44402   -3.9273123e+03   0.000000e+00   7.368446e+06     10s
   54906    8.5538277e+03   0.000000e+00   1.501391e+06     15s
   62713    1.1413383e+04   0.000000e+00   4.207755e+06     20s
   71318    2.3782384e+04   0.000000e+00   1.201723e+09     25s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 3.880275e+04, 53417 iterations, 24.92 seconds (52.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38802.7537    0   76 -164758.14 38802.7537   124%     -   26s
H    0     0                    -152614.2587 38802.7537   125%     -   26s
H    0     0                    -112527.1075 38802.7537   134%     -   26s
H    0     0                    -73633.29418 38802.7537   153%     -   26s
H    0     0                    -73323.60784 38802.7537   153%     -   26s
H    0     0                    -43212.61463 38802.7537   190%     -   26s
H    0     0                    4986.2555915 38802.7537   678%     -   26s
H    0     0                    5041.7764003 38802.7537   670%     -   27s
H    0     0                    5226.1932858 38802.7537   642%     -   27s
H    0     0                    5413.9418973 38802.7537   617%     -   27s
H    0     0                    5546.5072032 33861.6771   511%     -   34s
H    0     0                    5610.5139540 33861.6771   504%     -   34s
     0     0 33861.6771    0  243 5610.51395 33861.6771   504%     -   34s
     0     0 33128.3171    0  250 5610.51395 33128.3171   490%     -   38s
     0     0 33128.3171    0  242 5610.51395 33128.3171   490%     -   38s
     0     0 33128.3171    0  242 5610.51395 33128.3171   490%     -   39s
     0     0 33128.3171    0  242 5610.51395 33128.3171   490%     -   39s
     0     0 30240.9486    0  288 5610.51395 30240.9486   439%     -   46s
H    0     0                    11353.434528 30237.4386   166%     -   46s
     0     0 29955.3489    0  296 11353.4345 29955.3489   164%     -   48s
     0     0 29646.8262    0  317 11353.4345 29646.8262   161%     -   51s
     0     0 29553.8758    0  313 11353.4345 29553.8758   160%     -   52s
     0     0 29535.0873    0  316 11353.4345 29535.0873   160%     -   53s
     0     0 29343.8376    0  309 11353.4345 29343.8376   158%     -   56s
     0     0 29237.9892    0  332 11353.4345 29237.9892   158%     -   58s
     0     0 29206.8871    0  320 11353.4345 29206.8871   157%     -   59s
     0     0 29203.8439    0  325 11353.4345 29203.8439   157%     -   59s
     0     0 29161.3039    0  242 11353.4345 29161.3039   157%     -   61s
     0     0 29137.2901    0  283 11353.4345 29137.2901   157%     -   62s
     0     0 29131.7970    0  334 11353.4345 29131.7970   157%     -   62s
     0     0 29126.4166    0  327 11353.4345 29126.4166   157%     -   63s
     0     0 29126.2403    0  333 11353.4345 29126.2403   157%     -   63s
     0     0 27305.0612    0  376 11353.4345 27305.0612   141%     -   77s
H    0     0                    11995.427560 27302.5662   128%     -   78s
     0     0 26820.4927    0  367 11995.4276 26820.4927   124%     -   84s
H    0     0                    12042.710452 26719.6478   122%     -   87s
     0     0 26719.6478    0  374 12042.7105 26719.6478   122%     -   87s
     0     0 26684.9222    0  402 12042.7105 26684.9222   122%     -   88s
     0     0 26613.9959    0  414 12042.7105 26613.9959   121%     -   90s
     0     0 26538.5633    0  367 12042.7105 26538.5633   120%     -   91s
     0     0 26507.5420    0  405 12042.7105 26507.5420   120%     -   93s
     0     0 26492.6424    0  403 12042.7105 26492.6424   120%     -   94s
     0     0 26487.2498    0  406 12042.7105 26487.2498   120%     -   94s
     0     0 26466.5449    0  407 12042.7105 26466.5449   120%     -   95s
     0     0 26455.5572    0  416 12042.7105 26455.5572   120%     -   96s
     0     0 26453.3443    0  420 12042.7105 26453.3443   120%     -   97s
     0     0 26450.8256    0  419 12042.7105 26450.8256   120%     -   97s
     0     0 26450.3372    0  421 12042.7105 26450.3372   120%     -   97s
     0     0 26067.0008    0  395 12042.7105 26067.0008   116%     -  106s
     0     0 25971.6026    0  386 12042.7105 25971.6026   116%     -  110s
H    0     0                    12063.838146 25915.1810   115%     -  111s
     0     0 25915.1810    0  396 12063.8381 25915.1810   115%     -  111s
     0     0 25899.8888    0  388 12063.8381 25899.8888   115%     -  112s
     0     0 25867.1382    0  396 12063.8381 25867.1382   114%     -  112s
     0     0 25863.2787    0  396 12063.8381 25863.2787   114%     -  113s
     0     0 25860.6004    0  341 12063.8381 25860.6004   114%     -  113s
     0     0 25859.0328    0  400 12063.8381 25859.0328   114%     -  113s
     0     0 25858.6365    0  403 12063.8381 25858.6365   114%     -  113s
H    0     0                    12342.375218 25676.6070   108%     -  117s
     0     0 25676.6070    0  397 12342.3752 25676.6070   108%     -  117s
     0     0 25646.4806    0  395 12342.3752 25646.4806   108%     -  119s
     0     0 25626.8732    0  396 12342.3752 25626.8732   108%     -  119s
     0     0 25619.0270    0  397 12342.3752 25619.0270   108%     -  120s
     0     0 25613.7876    0  401 12342.3752 25613.7876   108%     -  120s
     0     0 25607.7719    0  395 12342.3752 25607.7719   107%     -  121s
     0     0 25604.5013    0  408 12342.3752 25604.5013   107%     -  121s
     0     0 25602.1425    0  386 12342.3752 25602.1425   107%     -  121s
     0     0 25602.0679    0  389 12342.3752 25602.0679   107%     -  121s
     0     0 25553.7944    0  400 12342.3752 25553.7944   107%     -  123s
     0     0 25545.2960    0  406 12342.3752 25545.2960   107%     -  126s
     0     0 25538.8684    0  402 12342.3752 25538.8684   107%     -  126s
     0     0 25537.2480    0  405 12342.3752 25537.2480   107%     -  127s
     0     0 25536.8648    0  404 12342.3752 25536.8648   107%     -  127s
     0     0 25504.4406    0  390 12342.3752 25504.4406   107%     -  129s
     0     0 25486.6352    0  389 12342.3752 25486.6352   106%     -  130s
     0     0 25479.8667    0  392 12342.3752 25479.8667   106%     -  131s
     0     0 25475.4358    0  387 12342.3752 25475.4358   106%     -  131s
     0     0 25472.4323    0  394 12342.3752 25472.4323   106%     -  131s
     0     0 25470.9108    0  399 12342.3752 25470.9108   106%     -  132s
     0     0 25448.1445    0  403 12342.3752 25448.1445   106%     -  134s
     0     0 25446.2618    0  405 12342.3752 25446.2618   106%     -  135s
     0     0 25445.6829    0  407 12342.3752 25445.6829   106%     -  135s
     0     0 25435.6069    0  400 12342.3752 25435.6069   106%     -  136s
     0     0 25432.7697    0  399 12342.3752 25432.7697   106%     -  137s
     0     0 25430.4046    0  402 12342.3752 25430.4046   106%     -  137s
     0     0 25429.6154    0  407 12342.3752 25429.6154   106%     -  138s
     0     0 25424.1306    0  404 12342.3752 25424.1306   106%     -  138s
     0     0 25422.1380    0  411 12342.3752 25422.1380   106%     -  140s
     0     0 25421.6321    0  408 12342.3752 25421.6321   106%     -  140s
     0     0 25421.1365    0  407 12342.3752 25421.1365   106%     -  141s
     0     0 25419.8035    0  407 12342.3752 25419.8035   106%     -  142s
H    0     0                    12515.690480 25419.8035   103%     -  162s
H    0     0                    13351.525875 25419.8035  90.4%     -  162s
H    0     0                    13368.881052 25419.8035  90.1%     -  162s
     0     2 25419.8035    0  407 13368.8811 25419.8035  90.1%     -  163s
     1     4 25308.8404    1  388 13368.8811 25419.8035  90.1%  3913  165s
     3     8 25235.8075    2  392 13368.8811 25307.1874  89.3%  4139  171s
     7    16 25039.5657    3  400 13368.8811 25233.7912  88.8%  5907  176s
    15    32 24482.3723    4  404 13368.8811 25038.5802  87.3%  7052  181s
    31    50 23400.4617    5  312 13368.8811 24481.7594  83.1%  8996  194s
    49    80 22636.4176    6  420 13368.8811 24481.1582  83.1% 10075  203s
H   54    80                    13495.575431 24481.1582  81.4%  9859  203s
    81   160 22334.6367    7  361 13495.5754 24481.1582  81.4%  7954  213s
H  161   256                    13591.888365 24481.1582  80.1%  5206  221s
   263   342 22161.7298   10  382 13591.8884 24481.1582  80.1%  4306  227s
   367   411 21919.2206    9  391 13591.8884 24481.1582  80.1%  3707  235s
H  393   411                    13769.576255 24481.1582  77.8%  3615  235s
   458   479 14838.4452   10  199 13769.5763 24481.1582  77.8%  3446  241s
   547   503 20926.1835   10  284 13769.5763 24481.1582  77.8%  3379  248s
H  559   503                    13771.927996 24481.1582  77.8%  3378  248s
   585   561 22106.7467   11  385 13771.9280 24481.1582  77.8%  3383  253s
   666   628 14753.4771   11  182 13771.9280 24481.1582  77.8%  3347  260s
   749   669 20400.5854   11  262 13771.9280 24481.1582  77.8%  3220  267s
   826   696 21938.3276   12  319 13771.9280 23975.0620  74.1%  3238  270s
   917   758 21666.5402   14  182 13771.9280 23974.3981  74.1%  3269  279s
   977   795 21507.3125   15  195 13771.9280 23974.3981  74.1%  3308  283s
  1032   823 21432.4268   16  192 13771.9280 23974.3981  74.1%  3319  287s
  1087   865 20981.8218   17  162 13771.9280 23974.3981  74.1%  3321  295s
  1143   885 19951.7295   18  194 13771.9280 23974.3981  74.1%  3304  303s
H 1178   885                    13779.696698 23974.3981  74.0%  3316  303s
  1199   961     cutoff   18      13779.6967 23974.3981  74.0%  3281  307s
  1311  1040 19570.1655   19  253 13779.6967 23776.4712  72.5%  3242  314s
  1433  1117 19485.3172   20  248 13779.6967 23776.4712  72.5%  3173  319s
  1550  1200 18569.7147   23  213 13779.6967 23479.2410  70.4%  3131  324s
  1677  1267 18198.8645   22  218 13779.6967 23479.2410  70.4%  3103  332s
  1804  1330 18231.4493   24  219 13779.6967 23479.2410  70.4%  3085  340s
  1931  1383 15842.9217   24   57 13779.6967 23364.6339  69.6%  3084  348s
  2050  1457 17425.6470   29  242 13779.6967 23296.0677  69.1%  3098  355s
  2168  1561 17012.1103   32  227 13779.6967 23218.1370  68.5%  3117  362s
  2312  1613 16406.0907   36  196 13779.6967 23218.1370  68.5%  3114  370s
  2402  1688 16164.9094   37  196 13779.6967 23170.1396  68.1%  3128  376s
  2511  1747 16171.7013   37  187 13779.6967 23170.1396  68.1%  3135  384s
  2650  1791 15855.6694   38  298 13779.6967 23114.6950  67.7%  3129  392s
  2805  1877     cutoff   40      13779.6967 23078.3874  67.5%  3142  401s
  2973  1962 14548.3662   10  216 13779.6967 23078.3874  67.5%  3145  409s
  3130  1978 infeasible   12      13779.6967 22994.5342  66.9%  3149  416s
  3178  2007     cutoff    9      13779.6967 22993.3687  66.9%  3168  425s
  3231  2036     cutoff   10      13779.6967 22993.3687  66.9%  3173  431s
  3289  2059 20326.7665    9  176 13779.6967 22993.3687  66.9%  3187  438s
  3358  2125 20251.5344   10  161 13779.6967 22993.3687  66.9%  3183  450s
  3450  2232 19263.6200   14  227 13779.6967 22993.3687  66.9%  3180  458s
  3614  2276 17295.1547   21  174 13779.6967 22853.0864  65.8%  3144  468s
  3674  2399 16897.1299   22  179 13779.6967 22853.0864  65.8%  3144  476s
  3878  2543 22377.2874   10  295 13779.6967 22842.5577  65.8%  3104  488s
  4180  2544 18997.2029   22  407 13779.6967 22772.8331  65.3%  3033  524s
  4182  2545 21932.2827   12   76 13779.6967 22772.8331  65.3%  3032  567s
  4183  2546 14801.9307   22  320 13779.6967 22772.8331  65.3%  3031  579s
  4184  2547 18963.7591   13  353 13779.6967 22772.8331  65.3%  3030  588s
  4185  2547 19589.3500   22  371 13779.6967 22772.8331  65.3%  3030  594s
  4186  2548 16610.2875   32  396 13779.6967 22772.8331  65.3%  3029  600s
  4188  2549 14928.6973   20  439 13779.6967 22772.8331  65.3%  3027  606s
  4190  2551 18696.9615    9  395 13779.6967 22772.8331  65.3%  3026  610s
  4194  2553 20313.8675   20  408 13779.6967 22772.8331  65.3%  3023  615s
  4196  2555 21869.3666   15  419 13779.6967 22772.8331  65.3%  3022  621s
  4200  2557 18637.4769   25  438 13779.6967 22772.8331  65.3%  3019  628s
  4202  2559 20362.8786   17  409 13779.6967 22772.8331  65.3%  3017  633s
  4204  2560 16789.7585   37  395 13779.6967 22772.8331  65.3%  3016  635s
  4206  2561 17449.4290   27  390 13779.6967 22772.8331  65.3%  3014  640s
  4207  2562 21470.0238   11  392 13779.6967 22772.8331  65.3%  3014  647s
  4209  2563 19077.6254   14  389 13779.6967 22772.8331  65.3%  3012  651s
  4211  2565 19179.4276   17  392 13779.6967 22772.8331  65.3%  3011  656s
  4213  2566 18679.3048   30  385 13779.6967 22772.8331  65.3%  3009  660s
  4216  2568 17789.2754   16  387 13779.6967 22772.8331  65.3%  3007  665s
  4217  2569 15407.4360   43  387 13779.6967 22772.8331  65.3%  3007  701s
  4218  2569 20227.5458   13  387 13779.6967 22772.8331  65.3%  3006  713s
  4219  2573 22772.8331   16  381 13779.6967 22772.8331  65.3%  3062  739s
  4221  2576 22772.8331   17  365 13779.6967 22772.8331  65.3%  3062  747s
  4225  2583 22772.8331   18  394 13779.6967 22772.8331  65.3%  3064  757s
  4233  2596 22772.8331   19  386 13779.6967 22772.8331  65.3%  3072  768s
  4249  2605 22772.8331   20  270 13779.6967 22772.8331  65.3%  3099  782s
  4265  2631 22772.8331   21  306 13779.6967 22772.8331  65.3%  3126  798s
  4297  2698 22305.1724   22  250 13779.6967 22772.8331  65.3%  3147  811s
  4396  2698 21430.2400   25  197 13779.6967 22772.8331  65.3%  3197  820s
  4442  2721 21377.2128   25  250 13779.6967 22772.8331  65.3%  3195  829s
  4488  2741 19570.0568   24  208 13779.6967 22772.8331  65.3%  3195  837s
  4552  2748 21949.1264   23  244 13779.6967 22772.8331  65.3%  3196  845s
  4604  2763 20130.5171   26  201 13779.6967 22772.8331  65.3%  3192  854s
  4666  2763 20110.0432   27  192 13779.6967 22772.8331  65.3%  3191  865s
  4740  2765 19379.9537   28  187 13779.6967 22772.8331  65.3%  3181  876s
  4805  2759     cutoff   28      13779.6967 22772.8331  65.3%  3181  887s
  4853  2772 18769.6628   29  251 13779.6967 22772.8331  65.3%  3176  897s
  4913  2765 18619.7002   30  240 13779.6967 22772.8331  65.3%  3171  905s
  4972  2758 18366.1907   31  275 13779.6967 22772.8331  65.3%  3165  913s
  5039  2778     cutoff   31      13779.6967 22772.8331  65.3%  3156  921s
  5099  2806     cutoff   30      13779.6967 22772.8331  65.3%  3155  929s
  5170  2828 17817.4025   33  270 13779.6967 22772.8331  65.3%  3148  936s
  5244  2842     cutoff   35      13779.6967 22772.8331  65.3%  3139  946s
  5315  2870 14946.2609   39  212 13779.6967 22772.8331  65.3%  3141  954s
  5394  2873     cutoff   39      13779.6967 22772.8331  65.3%  3136  962s
  5448  2902     cutoff   43      13779.6967 22772.8331  65.3%  3140  971s
  5518  2930 20397.6190   23  268 13779.6967 22772.8331  65.3%  3142  982s
  5601  2948 19686.7482   25  302 13779.6967 22772.8331  65.3%  3138  993s
  5714  2948 18867.7769   27  289 13779.6967 22772.8331  65.3%  3123 1003s
  5816  2951 18075.8070   31  200 13779.6967 22603.6138  64.0%  3117 1013s
  5937  2946 16168.3943   37  212 13779.6967 22595.4164  64.0%  3099 1023s
  6054  2945     cutoff   43      13779.6967 22362.5232  62.3%  3094 1033s
  6166  2938     cutoff   24      13779.6967 22362.5232  62.3%  3088 1042s
  6240  2949 14866.6035   25  226 13779.6967 22362.5232  62.3%  3086 1054s
  6366  2934 14448.2654   27  203 13779.6967 22362.5232  62.3%  3074 1067s
  6487  2928     cutoff   27      13779.6967 22018.3647  59.8%  3068 1080s
  6597  2932 21466.3994   23  299 13779.6967 21913.6433  59.0%  3065 1092s
  6743  2910 20564.8247   27  250 13779.6967 21913.6433  59.0%  3058 1105s
  6917  2901 19067.5221   32  170 13779.6967 21803.4890  58.2%  3046 1118s
  7073  2893 14922.4257   37   56 13779.6967 21683.6202  57.4%  3042 1132s
  7262  2854 14333.5477   40  158 13779.6967 21429.9346  55.5%  3026 1143s
  7362  2856 14286.2411   41  142 13779.6967 21277.0763  54.4%  3028 1157s
  7559  2821 14237.2365   42  145 13779.6967 21277.0763  54.4%  3010 1173s
  7749  2784 17183.6094   27  240 13779.6967 21209.2810  53.9%  3007 1188s
  7957  2771     cutoff   31      13779.6967 21095.7218  53.1%  2995 1204s
  8155  2736 17976.2971   24  303 13779.6967 21053.3524  52.8%  2992 1220s
  8341  2720 16549.8165   26  166 13779.6967 20732.6840  50.5%  2986 1236s
  8535  2729 17049.4767   28  288 13779.6967 20650.9749  49.9%  2992 1253s
  8748  2694     cutoff   32      13779.6967 20492.7017  48.7%  2992 1272s
  9043  2630 infeasible   26      13779.6967 20275.1493  47.1%  2972 1290s
  9269  2573 15767.7045   30  123 13779.6967 20275.1493  47.1%  2979 1308s
  9505  2504 16276.9419   27  275 13779.6967 20045.0655  45.5%  2971 1323s
  9558  2485 16171.1840   28  259 13779.6967 20045.0655  45.5%  2972 1337s
  9621  2480 15888.8358   29  187 13779.6967 20045.0655  45.5%  2972 1354s
  9716  2461 infeasible   30      13779.6967 20045.0655  45.5%  2964 1371s
  9894  2425 15719.8638   26  159 13779.6967 19854.0179  44.1%  2961 1391s
 10187  2337 15909.4747   27  255 13779.6967 19764.2684  43.4%  2954 1412s
 10522  2231     cutoff   30      13779.6967 19644.7223  42.6%  2952 1433s
 10880  2149 16461.3256   29  303 13779.6967 19192.8790  39.3%  2939 1457s
 11207  2034     cutoff   31      13779.6967 18940.0990  37.4%  2928 1482s
 11672  1891 14078.3029   43  207 13779.6967 18681.1900  35.6%  2906 1505s
 12099  1770 15009.3588   34  164 13779.6967 18495.5823  34.2%  2895 1530s
 12620  1707 14480.3112   25  177 13779.6967 18173.1425  31.9%  2871 1557s
 13146  1616 15564.4412   32  317 13779.6967 17985.0832  30.5%  2852 1584s
 13699  1521 15473.6084   33  250 13779.6967 17621.6363  27.9%  2833 1612s
 14267  1371     cutoff   31      13779.6967 17260.4918  25.3%  2812 1642s
 14882  1317     cutoff   31      13779.6967 16958.3001  23.1%  2789 1673s
 15003  1253     cutoff   28      13779.6967 16958.3001  23.1%  2786 1698s
 15219  1070     cutoff   30      13779.6967 16863.6838  22.4%  2773 1725s
 15516   774     cutoff   33      13779.6967 16764.0928  21.7%  2754 1752s
 15978   338     cutoff   30      13779.6967 16609.5942  20.5%  2719 1779s
 16615    17     cutoff   33      13779.6967 16299.1973  18.3%  2665 1804s
 17098     0 infeasible   28      13779.6967 15279.7487  10.9%  2622 1810s

Cutting planes:
  Learned: 1
  MIR: 558
  Mixing: 2
  Flow cover: 1674
  RLT: 16
  Relax-and-lift: 113

Explored 17128 nodes (45074194 simplex iterations) in 1810.70 seconds (6049.00 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13779.7 13771.9 13769.6 ... 12063.8

Optimal solution found (tolerance 1.00e-04)
Best objective 1.377969669781e+04, best bound 1.377969669781e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1810.74s
  Master Objective (UB) = 13779.70, θ = 157597.50
  Upper Bound (UB) = 13779.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157597.50
  [DEBUG]   ✓ Scenario 0: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157597.50 ≤ Q = 157597.50 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x324e6920
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x324e6920
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.361079e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6750622.8133
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.480763e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148076.26    0  124 6750622.81 -148076.26   102%     -    0s
H    0     0                    -113622.5714 -148076.26  30.3%     -    0s
H    0     0                    -113923.9295 -148076.26  30.0%     -    0s
H    0     0                    -114551.8472 -148076.26  29.3%     -    0s
     0     0 -120731.38    0   81 -114551.85 -120731.38  5.39%     -    0s
H    0     0                    -117052.7573 -120603.51  3.03%     -    0s
H    0     0                    -117350.9752 -120603.51  2.77%     -    0s
H    0     0                    -117877.4582 -120603.51  2.31%     -    0s
H    0     0                    -118175.6761 -120603.51  2.05%     -    0s
     0     0 -120183.34    0   44 -118175.68 -120183.34  1.70%     -    0s
H    0     0                    -119487.6753 -120107.27  0.52%     -    0s
H    0     0                    -119519.8035 -120107.27  0.49%     -    0s
     0     0 -120098.81    0   43 -119519.80 -120098.81  0.48%     -    0s
     0     0 -119822.35    0   15 -119519.80 -119822.35  0.25%     -    0s
     0     0 -119812.55    0   13 -119519.80 -119812.55  0.24%     -    0s
     0     0 -119746.71    0   17 -119519.80 -119746.71  0.19%     -    0s
     0     0 -119743.43    0   18 -119519.80 -119743.43  0.19%     -    0s
     0     0 -119617.10    0    7 -119519.80 -119617.10  0.08%     -    0s
H    0     0                    -119544.5876 -119617.10  0.06%     -    0s
     0     0 -119593.88    0   13 -119544.59 -119593.88  0.04%     -    0s
     0     0 -119591.45    0    8 -119544.59 -119591.45  0.04%     -    0s
     0     0 -119570.79    0    6 -119544.59 -119570.79  0.02%     -    0s
     0     0 -119563.81    0    7 -119544.59 -119563.81  0.02%     -    0s
     0     0          -    0      -119544.59 -119556.25  0.01%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 4
  Flow cover: 2
  Relax-and-lift: 1

Explored 1 nodes (587 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119545 -119520 -119488 ... 1.36108e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.195445875766e+05, best bound -1.195562515117e+05, gap 0.0098%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 154958.88
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119544.59
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -119544.59 = 154958.88
  [DEBUG]   Current θ from Master = 157597.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2638.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11141.08
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 280.2608, Absolute Gap = 280.2608, Relative Gap = 0.020339
  Not converged yet (gap = 280.26 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xc187e5be
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63770 rows and 25900 columns
Presolve time: 1.28s
Presolved: 75223 rows, 32520 columns, 468689 nonzeros
Variable types: 30261 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338447.1000
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75223 rows, 32520 columns, 468689 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35325   -9.3345741e+04   0.000000e+00   1.276071e+08      5s
   48175   -1.7999442e+03   0.000000e+00   2.118551e+08     10s
   57025    1.1178946e+04   0.000000e+00   1.379495e+08     15s
   65506    1.9047404e+04   0.000000e+00   1.640048e+06     20s
   73806    2.7538502e+04   0.000000e+00   2.782072e+07     25s
   81538    3.1427228e+04   0.000000e+00   6.865228e+05     30s
   87907    3.2509746e+04   0.000000e+00   3.217703e+05     35s
Concurrent spin time: 8.50s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.880275e+04, 80130 iterations, 43.74 seconds (76.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38802.7537    0   76 -164758.14 38802.7537   124%     -   45s
H    0     0                    -156738.8465 38802.7537   125%     -   45s
H    0     0                    -125135.2990 38802.7537   131%     -   45s
H    0     0                    -99169.23526 38802.7537   139%     -   45s
H    0     0                    -83677.67302 38802.7537   146%     -   45s
H    0     0                    -78689.12473 38802.7537   149%     -   45s
H    0     0                    -78243.81907 38802.7537   150%     -   45s
H    0     0                    -43212.61463 38802.7537   190%     -   45s
H    0     0                    4943.8952839 38802.7537   685%     -   45s
H    0     0                    5315.3548209 38802.7537   630%     -   45s
H    0     0                    5413.9418973 38802.7537   617%     -   46s
H    0     0                    5468.8377015 34442.3907   530%     -   53s
H    0     0                    5607.5157689 34442.3907   514%     -   53s
H    0     0                    5610.5139540 34442.3907   514%     -   53s
     0     0 34314.9013    0  258 5610.51395 34314.9013   512%     -   53s
     0     0 34291.1387    0  268 5610.51395 34291.1387   511%     -   55s
     0     0 34291.1387    0  264 5610.51395 34291.1387   511%     -   56s
     0     0 34160.9799    0  264 5610.51395 34160.9799   509%     -   56s
     0     0 30644.5509    0  298 5610.51395 30644.5509   446%     -   66s
H    0     0                    6016.0772162 30644.5509   409%     -   67s
H    0     0                    6145.4001781 30644.5509   399%     -   67s
H    0     0                    7443.0457094 30644.5509   312%     -   67s
H    0     0                    7851.6509261 30644.5509   290%     -   67s
H    0     0                    10510.580144 30644.5509   192%     -   67s
H    0     0                    11224.111566 30644.5509   173%     -   67s
H    0     0                    11353.434528 30644.5509   170%     -   67s
     0     0 30636.0822    0  300 11353.4345 30636.0822   170%     -   72s
     0     0 30507.3286    0  301 11353.4345 30507.3286   169%     -   75s
     0     0 30395.1433    0  303 11353.4345 30395.1433   168%     -   78s
     0     0 30374.9528    0  301 11353.4345 30374.9528   168%     -   79s
     0     0 30371.5208    0  306 11353.4345 30371.5208   168%     -   79s
     0     0 30368.9056    0  311 11353.4345 30368.9056   167%     -   80s
     0     0 30304.7441    0  305 11353.4345 30304.7441   167%     -   82s
     0     0 30300.1150    0  311 11353.4345 30300.1150   167%     -   83s
     0     0 30298.5889    0  308 11353.4345 30298.5889   167%     -   83s
     0     0 30298.3943    0  308 11353.4345 30298.3943   167%     -   84s
     0     0 27908.8316    0  342 11353.4345 27908.8316   146%     -   98s
H    0     0                    12169.758948 27907.3677   129%     -   98s
H    0     0                    12286.581998 27907.3677   127%     -   98s
H    0     0                    12429.357903 27907.3677   125%     -   98s
     0     0 27438.0357    0  364 12429.3579 27438.0357   121%     -  103s
     0     0 27185.2927    0  355 12429.3579 27185.2927   119%     -  107s
     0     0 27018.1260    0  374 12429.3579 27018.1260   117%     -  111s
     0     0 26961.4163    0  388 12429.3579 26961.4163   117%     -  113s
     0     0 26932.9310    0  395 12429.3579 26932.9310   117%     -  116s
     0     0 26890.0646    0  391 12429.3579 26890.0646   116%     -  118s
     0     0 26868.2534    0  429 12429.3579 26868.2534   116%     -  120s
     0     0 26851.5695    0  426 12429.3579 26851.5695   116%     -  121s
     0     0 26843.6310    0  390 12429.3579 26843.6310   116%     -  121s
     0     0 26738.8420    0  421 12429.3579 26738.8420   115%     -  123s
     0     0 26731.0376    0  422 12429.3579 26731.0376   115%     -  124s
     0     0 26725.1490    0  389 12429.3579 26725.1490   115%     -  125s
     0     0 26722.4664    0  390 12429.3579 26722.4664   115%     -  125s
     0     0 26722.3028    0  388 12429.3579 26722.3028   115%     -  126s
     0     0 26287.7819    0  381 12429.3579 26287.7819   111%     -  134s
     0     0 26106.7939    0  372 12429.3579 26106.7939   110%     -  138s
     0     0 25978.3344    0  377 12429.3579 25978.3344   109%     -  141s
     0     0 25937.3393    0  380 12429.3579 25937.3393   109%     -  143s
     0     0 25904.6633    0  382 12429.3579 25904.6633   108%     -  145s
     0     0 25899.5210    0  384 12429.3579 25899.5210   108%     -  145s
     0     0 25897.9977    0  386 12429.3579 25897.9977   108%     -  146s
     0     0 25894.3439    0  391 12429.3579 25894.3439   108%     -  146s
     0     0 25893.7442    0  387 12429.3579 25893.7442   108%     -  147s
     0     0 25811.3984    0  377 12429.3579 25811.3984   108%     -  150s
     0     0 25792.2036    0  382 12429.3579 25792.2036   108%     -  151s
     0     0 25780.8775    0  383 12429.3579 25780.8775   107%     -  152s
     0     0 25770.2461    0  381 12429.3579 25770.2461   107%     -  153s
     0     0 25769.7260    0  383 12429.3579 25769.7260   107%     -  154s
     0     0 25727.4181    0  382 12429.3579 25727.4181   107%     -  156s
     0     0 25720.7805    0  380 12429.3579 25720.7805   107%     -  158s
     0     0 25716.5848    0  383 12429.3579 25716.5848   107%     -  159s
     0     0 25708.6567    0  381 12429.3579 25708.6567   107%     -  159s
     0     0 25708.4763    0  381 12429.3579 25708.4763   107%     -  159s
     0     0 25686.4935    0  384 12429.3579 25686.4935   107%     -  161s
     0     0 25682.9849    0  379 12429.3579 25682.9849   107%     -  161s
     0     0 25682.6711    0  383 12429.3579 25682.6711   107%     -  161s
     0     0 25630.1413    0  379 12429.3579 25630.1413   106%     -  163s
     0     0 25623.2951    0  389 12429.3579 25623.2951   106%     -  164s
     0     0 25617.4655    0  386 12429.3579 25617.4655   106%     -  164s
     0     0 25615.0332    0  383 12429.3579 25615.0332   106%     -  165s
     0     0 25613.9544    0  389 12429.3579 25613.9544   106%     -  165s
H    0     0                    12892.056319 25606.9112  98.6%     -  166s
     0     0 25606.9112    0  386 12892.0563 25606.9112  98.6%     -  166s
H    0     0                    13267.961548 25606.3096  93.0%     -  167s
     0     0 25601.2461    0  394 13267.9615 25601.2461  93.0%     -  167s
     0     0 25588.7972    0  386 13267.9615 25588.7972  92.9%     -  168s
     0     0 25581.9619    0  382 13267.9615 25581.9619  92.8%     -  169s
     0     0 25580.1463    0  385 13267.9615 25580.1463  92.8%     -  169s
     0     0 25579.1847    0  385 13267.9615 25579.1847  92.8%     -  169s
     0     0 25533.1605    0  381 13267.9615 25533.1605  92.4%     -  171s
     0     0 25531.9911    0  393 13267.9615 25531.9911  92.4%     -  172s
     0     0 25520.7939    0  385 13267.9615 25520.7939  92.3%     -  173s
     0     0 25515.2850    0  392 13267.9615 25515.2850  92.3%     -  174s
     0     0 25514.4179    0  394 13267.9615 25514.4179  92.3%     -  174s
     0     0 25484.7076    0  393 13267.9615 25484.7076  92.1%     -  176s
H    0     0                    13292.053209 25484.6426  91.7%     -  179s
     0     0 25475.4495    0  396 13292.0532 25475.4495  91.7%     -  180s
     0     0 25473.2304    0  394 13292.0532 25473.2304  91.6%     -  180s
     0     0 25472.6631    0  395 13292.0532 25472.6631  91.6%     -  181s
     0     0 25424.9003    0  395 13292.0532 25424.9003  91.3%     -  182s
H    0     0                    13368.881052 25424.8519  90.2%     -  183s
     0     0 25413.9618    0  389 13368.8811 25413.9618  90.1%     -  183s
     0     0 25412.1445    0  390 13368.8811 25412.1445  90.1%     -  184s
     0     0 25409.7181    0  395 13368.8811 25409.7181  90.1%     -  184s
     0     0 25409.1046    0  382 13368.8811 25409.1046  90.1%     -  184s
     0     0 25400.4580    0  383 13368.8811 25400.4580  90.0%     -  186s
     0     0 25396.7336    0  382 13368.8811 25396.7336  90.0%     -  186s
     0     0 25396.6102    0  382 13368.8811 25396.6102  90.0%     -  187s
     0     0 25360.8026    0  381 13368.8811 25360.8026  89.7%     -  189s
     0     0 25357.0438    0  373 13368.8811 25357.0438  89.7%     -  190s
     0     0 25355.7987    0  374 13368.8811 25355.7987  89.7%     -  190s
     0     0 25350.9684    0  324 13368.8811 25350.9684  89.6%     -  191s
     0     0 25350.2327    0  319 13368.8811 25350.2327  89.6%     -  198s
     0     0 25347.0463    0  351 13368.8811 25347.0463  89.6%     -  199s
     0     0 25346.2837    0  381 13368.8811 25346.2837  89.6%     -  200s
     0     0 25345.4887    0  381 13368.8811 25345.4887  89.6%     -  201s
     0     0 25345.0226    0  387 13368.8811 25345.0226  89.6%     -  201s
     0     0 25343.4073    0  388 13368.8811 25343.4073  89.6%     -  202s
     0     0 25343.1378    0  388 13368.8811 25343.1378  89.6%     -  203s
     0     2 25342.8525    0  388 13368.8811 25342.8525  89.6%     -  232s
     1     4 25317.6258    1  370 13368.8811 25340.5624  89.5%  2323  235s
     7    16 25110.9352    3  456 13368.8811 25266.7321  89.0%  4340  243s
    15    32 24733.6684    4  433 13368.8811 25110.8301  87.8%  6185  250s
    31    48 24154.9659    5  376 13368.8811 24732.8853  85.0%  8932  263s
    47    80 23147.0715    6  315 13368.8811 24732.8853  85.0%  8124  274s
H   48    80                    13426.581873 24732.8853  84.2%  7955  274s
H   49    80                    13458.046300 24732.8853  83.8%  7916  274s
    79   146 22965.2261    7  301 13458.0463 24732.8853  83.8%  6814  294s
   145   178 22878.7315    9  303 13458.0463 24732.8853  83.8%  5088  304s
   177   213 22840.2369    8  331 13458.0463 24732.8853  83.8%  4551  317s
   212   245 22839.5420   10  310 13458.0463 24732.8853  83.8%  4184  326s
   244   277 22824.3334    9  329 13458.0463 24732.8853  83.8%  4096  335s
   276   309 22653.1984   10  242 13458.0463 24732.8853  83.8%  3978  342s
H  291   309                    13591.888365 24732.8853  82.0%  3934  342s
   308   404 22805.1473   11  309 13591.8884 24732.8853  82.0%  3944  350s
   420   438 22293.3702   12  329 13591.8884 24732.8853  82.0%  3549  358s
H  422   438                    13769.576255 24732.8853  79.6%  3543  358s
H  442   438                    13771.927996 24732.8853  79.6%  3535  358s
   475   485 16117.2035   12  155 13771.9280 24732.8853  79.6%  3422  367s
   556   545 22136.8042   12  273 13771.9280 24732.8853  79.6%  3259  376s
   656   616 22039.1189   13  288 13771.9280 24732.8853  79.6%  3064  384s
   756   707 21703.4970   15  230 13771.9280 24732.8853  79.6%  2912  393s
   875   807 21430.9219   19  204 13771.9280 24732.8853  79.6%  2690  400s
   999   892 17016.9607   21  102 13771.9280 24732.8853  79.6%  2515  407s
  1124   966 21101.4876   20  195 13771.9280 24732.8853  79.6%  2356  416s
  1246  1021     cutoff   21      13771.9280 24732.8853  79.6%  2258  424s
  1356  1090 21013.8557   21  164 13771.9280 24732.8853  79.6%  2226  432s
  1478  1164 20701.9821   22  266 13771.9280 24732.8853  79.6%  2192  440s
  1580  1278 16878.2030   21   95 13771.9280 24732.8853  79.6%  2151  448s
  1730  1404 infeasible   22      13771.9280 24648.3247  79.0%  2082  456s
  1915  1481 15331.5775   22  103 13771.9280 24648.3247  79.0%  2010  466s
  2070  1498 infeasible   22      13771.9280 24648.3247  79.0%  1974  473s
  2121  1516     cutoff   23      13771.9280 24648.3247  79.0%  1996  485s
  2225  1538 15040.4358   31   61 13771.9280 24546.3565  78.2%  2010  495s
  2306  1613     cutoff   34      13771.9280 24544.1164  78.2%  2036  503s
  2423  1674 23898.2701    8  427 13771.9280 24544.1164  78.2%  2036  513s
  2545  1716 23654.5027    9  388 13771.9280 24544.1164  78.2%  2046  522s
  2664  1790 23039.8098   11  388 13771.9280 24462.6708  77.6%  2060  534s
  2785  1873 22629.4638   12  351 13771.9280 24451.2287  77.5%  2069  543s
  2922  1942 22006.0222   15  267 13771.9280 24451.2287  77.5%  2071  554s
  3069  2035 20220.6375   23  209 13771.9280 24268.9119  76.2%  2075  566s
  3231  2136 19180.7111   27  210 13771.9280 24084.0591  74.9%  2076  577s
  3396  2256 18575.1531   30  208 13771.9280 23903.5421  73.6%  2073  588s
  3614  2374 16171.8041   45  184 13771.9280 23883.0635  73.4%  2052  600s
  3814  2512 infeasible   57      13771.9280 23883.0635  73.4%  2047  613s
  4016  2513 18403.2714   24  388 13771.9280 23769.3691  72.6%  2046  682s
  4018  2514 14099.8927   31   76 13771.9280 23769.3691  72.6%  2045  722s
  4019  2515 14504.8933   20  312 13771.9280 23769.3691  72.6%  2044  737s
  4020  2516 16155.3047   21  399 13771.9280 23769.3691  72.6%  2044  750s
  4021  2516 19685.3390   11  369 13771.9280 23769.3691  72.6%  2043  756s
  4022  2517 15660.1828   77  391 13771.9280 23769.3691  72.6%  2043  761s
  4023  2518 15649.6968   18  391 13771.9280 23769.3691  72.6%  2042  765s
  4025  2519 21621.9764   18  420 13771.9280 23769.3691  72.6%  2041  772s
  4028  2521 16576.3467   48  432 13771.9280 23769.3691  72.6%  2040  775s
  4032  2524 18457.9418   27  322 13771.9280 23769.3691  72.6%  2038  782s
  4035  2526 23393.4626   14  363 13771.9280 23769.3691  72.6%  2036  786s
  4037  2527 18789.4828   25  388 13771.9280 23769.3691  72.6%  2035  790s
  4039  2528 20792.3723   11  396 13771.9280 23769.3691  72.6%  2034  795s
  4040  2529 20741.1415   28  351 13771.9280 23769.3691  72.6%  2033  800s
  4043  2531 16372.5519   17  375 13771.9280 23769.3691  72.6%  2032  809s
  4044  2532 21904.5093   18  375 13771.9280 23769.3691  72.6%  2031  810s
  4047  2534 22695.2683    7  375 13771.9280 23769.3691  72.6%  2030  816s
  4050  2536 16756.0422   17  223 13771.9280 23769.3691  72.6%  2028  820s
  4052  2537 15233.5317   61  223 13771.9280 23769.3691  72.6%  2027  863s
  4053  2538 14510.7843   16  223 13771.9280 23769.3691  72.6%  2027  878s
  4054  2541 23769.3691   15  409 13771.9280 23769.3691  72.6%  2073  915s
  4056  2545 23769.3691   16  370 13771.9280 23769.3691  72.6%  2074  923s
  4060  2551 23769.3691   17  415 13771.9280 23769.3691  72.6%  2077  943s
  4068  2565 23769.3691   18  417 13771.9280 23769.3691  72.6%  2097  951s
  4084  2575 22976.2024   19  410 13771.9280 23769.3691  72.6%  2136  968s
  4100  2602 20728.7863   20  252 13771.9280 23769.3691  72.6%  2164  979s
  4132  2700 20304.6142   21  249 13771.9280 23769.3691  72.6%  2194  991s
  4247  2734 19881.5963   22  240 13771.9280 23769.3691  72.6%  2248  999s
  4323  2760 18552.3401   25  214 13771.9280 23769.3691  72.6%  2269 1008s
  4384  2761     cutoff   24      13771.9280 23769.3691  72.6%  2303 1015s
  4418  2779 18798.4984   25  223 13771.9280 23769.3691  72.6%  2321 1023s
  4461  2792 17840.4326   25  214 13771.9280 23769.3691  72.6%  2343 1030s
  4503  2807 17527.9771   25  214 13771.9280 23769.3691  72.6%  2367 1038s
  4555  2800 15755.7777   26  273 13771.9280 23769.3691  72.6%  2388 1047s
  4615  2798     cutoff   26      13771.9280 23769.3691  72.6%  2411 1059s
  4675  2803 18586.0979   26  221 13771.9280 23769.3691  72.6%  2446 1066s
  4735  2808 17141.6131   27  204 13771.9280 23769.3691  72.6%  2478 1075s
  4797  2797 16489.2475   26  231 13771.9280 23769.3691  72.6%  2505 1084s
  4864  2796 15741.3965   27  288 13771.9280 23769.3691  72.6%  2536 1094s
  4932  2804 16539.2868   29  276 13771.9280 23769.3691  72.6%  2559 1105s
  5003  2804 15691.6748   31  333 13771.9280 23769.3691  72.6%  2594 1115s
  5070  2801 15601.7270   32  335 13771.9280 23769.3691  72.6%  2617 1125s
  5126  2811 15332.1495   33  189 13771.9280 23769.3691  72.6%  2647 1136s
  5184  2828 14726.9020   35  279 13771.9280 23720.6786  72.2%  2680 1145s
  5243  2862 infeasible   36      13771.9280 23615.4975  71.5%  2719 1153s
  5314  2883 14182.1753   40  233 13771.9280 23615.4975  71.5%  2748 1162s
  5397  2884 20262.2513   22  174 13771.9280 23615.4975  71.5%  2776 1172s
  5444  2918 19914.6779   23  246 13771.9280 22917.2062  66.4%  2799 1180s
  5517  2943 18867.3249   24  166 13771.9280 22917.2062  66.4%  2819 1192s
  5591  2964 18798.1752   25  186 13771.9280 22761.2381  65.3%  2838 1203s
  5673  2982 18345.6065   26  310 13771.9280 22479.3448  63.2%  2877 1213s
  5769  3011 18277.4790   27  306 13771.9280 22479.3448  63.2%  2913 1223s
  5853  3051 18104.3416   28  347 13771.9280 22156.7880  60.9%  2944 1234s
  5970  3069 17967.7499   31  223 13771.9280 22096.8146  60.4%  2974 1245s
  6086  3093 17126.3335   35  234 13771.9280 22093.5558  60.4%  3006 1256s
  6233  3082 16434.0321   40  183 13771.9280 22060.4932  60.2%  3032 1269s
  6331  3102 14415.0707   43  200 13771.9280 21964.7117  59.5%  3067 1282s
  6481  3123 19162.2322   24  133 13771.9280 21857.7065  58.7%  3103 1295s
  6624  3132 17413.3050   27  132 13771.9280 21840.4079  58.6%  3127 1308s
  6784  3128 16525.9363   31   85 13771.9280 21840.4079  58.6%  3156 1323s
  6951  3147 15742.9420   35  218 13771.9280 21771.3101  58.1%  3200 1340s
  7125  3162 14217.9863   28  242 13771.9280 21718.8097  57.7%  3239 1355s
  7301  3154 infeasible   30      13771.9280 21679.1762  57.4%  3269 1372s
  7477  3180 18554.9913   21  219 13771.9280 21539.5799  56.4%  3304 1387s
  7607  3218 17708.2488   25  280 13771.9280 21539.5799  56.4%  3335 1403s
  7779  3246 15400.6853   30  258 13771.9280 21526.9095  56.3%  3366 1420s
  7974  3252 infeasible   35      13771.9280 21334.9783  54.9%  3398 1439s
  8133  3219 18819.6866   29  196 13771.9280 21267.9755  54.4%  3426 1453s
  8176  3223 16755.0630   30   99 13771.9280 21267.9755  54.4%  3441 1466s
  8220  3231     cutoff   31      13771.9280 21267.9755  54.4%  3450 1478s
  8261  3239 16383.2329   32  212 13771.9280 21188.8590  53.9%  3459 1492s
  8310  3270 15701.9281   33  119 13771.9280 21188.8590  53.9%  3468 1510s
  8407  3289 15217.3235   34   99 13771.9280 21132.3022  53.4%  3477 1527s
  8567  3302 15080.5019   35  102 13771.9280 21117.4180  53.3%  3505 1547s
  8816  3252 14187.3312   39  194 13771.9280 20983.0519  52.4%  3544 1565s
  8973  3245 14010.2713   41  133 13771.9280 20930.5804  52.0%  3584 1584s
  9162  3234 infeasible   28      13771.9280 20816.9417  51.2%  3629 1605s
  9458  3166 14620.3591   29  304 13771.9280 20749.9613  50.7%  3681 1627s
  9767  3137 14696.1936   29  218 13771.9280 20720.3968  50.5%  3735 1648s
 10129  3100 14045.3872   30  300 13771.9280 20649.9802  49.9%  3769 1672s
 10495  3062 15399.3312   32  305 13771.9280 20558.1316  49.3%  3815 1701s
 10883  3039 19216.1193   26  156 13771.9280 20291.3681  47.3%  3849 1725s
 11292  3004 15589.7233   34  257 13771.9280 20271.4898  47.2%  3875 1752s
 11708  2965 infeasible   32      13771.9280 20014.1912  45.3%  3909 1778s
 12142  3044 14495.2470   35  182 13771.9280 19884.6815  44.4%  3943 1807s
 12551  3110     cutoff   29      13771.9280 19744.2234  43.4%  3983 1835s
 12834  3155 15044.9959   33  236 13771.9280 19614.0031  42.4%  4010 1863s
 13022  3164 infeasible   27      13771.9280 19614.0031  42.4%  4025 1893s
 13076  3195 infeasible   27      13771.9280 19607.6832  42.4%  4028 1917s
 13196  3206 infeasible   27      13771.9280 19607.6832  42.4%  4033 1943s
 13381  3253 infeasible   27      13771.9280 19449.6038  41.2%  4035 1974s
 13642  3322 14775.4359   36  209 13771.9280 19408.7208  40.9%  4046 2006s
 14030  3445 14317.8489   37  160 13771.9280 19408.7208  40.9%  4053 2037s
 14538  3482 15377.4453   42  203 13771.9280 19272.7630  39.9%  4074 2075s
 15125  3589 15403.7844   22  219 13771.9280 19112.8961  38.8%  4111 2113s
 15735  3683 infeasible   28      13771.9280 18873.5348  37.0%  4148 2149s
 16361  3722 14351.7946   28  162 13771.9280 18577.1908  34.9%  4180 2187s
 17043  3762 infeasible   36      13771.9280 18393.1069  33.6%  4209 2229s
 17792  3804 infeasible   26      13771.9280 18173.0489  32.0%  4228 2270s
 18537  3832 infeasible   28      13771.9280 18001.6749  30.7%  4247 2313s
 19342  3818 infeasible   31      13771.9280 17813.1389  29.3%  4253 2357s
 20191  3749 infeasible   29      13771.9280 17606.4759  27.8%  4254 2405s
 21072  3565 infeasible   31      13771.9280 17409.4973  26.4%  4265 2454s
 22042  3331 14245.9891   25  305 13771.9280 17212.8193  25.0%  4253 2502s
 23012  2850 14287.0381   35  217 13771.9280 16861.4099  22.4%  4246 2551s
 24163  2194 14001.5467   26  260 13771.9280 16559.4820  20.2%  4224 2599s
 25580  1175     cutoff   29      13771.9280 16037.4057  16.4%  4159 2646s
 27303     0 infeasible   26      13771.9280 15459.9077  12.3%  4048 2684s

Cutting planes:
  Learned: 1
  MIR: 715
  Mixing: 1
  Flow cover: 2601
  RLT: 12
  Relax-and-lift: 164

Explored 28927 nodes (113301211 simplex iterations) in 2684.69 seconds (9596.24 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13771.9 13769.6 13591.9 ... 12429.4

Optimal solution found (tolerance 1.00e-04)
Best objective 1.377192799558e+04, best bound 1.377192799558e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2684.76s
  Master Objective (UB) = 13771.93, θ = 157621.31
  Upper Bound (UB) = 13771.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157621.31
  [DEBUG]   ✓ Scenario 0: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157621.31 ≤ Q = 157621.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157621.31 ≤ Q = 157621.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4d30e757
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb2cf18a9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.361183e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6782071.2827
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.480107e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148010.71    0  123 6782071.28 -148010.71   102%     -    0s
H    0     0                    -113621.2164 -148010.71  30.3%     -    0s
H    0     0                    -113936.0266 -148010.71  29.9%     -    0s
H    0     0                    -114563.9444 -148010.71  29.2%     -    0s
     0     0 -119872.06    0   80 -114563.94 -119872.06  4.63%     -    0s
H    0     0                    -117112.3040 -119744.20  2.25%     -    0s
H    0     0                    -117432.2092 -119744.20  1.97%     -    0s
     0     0 -119174.01    0   75 -117432.21 -119174.01  1.48%     -    0s
H    0     0                    -118219.5294 -119172.93  0.81%     -    0s
H    0     0                    -118426.5716 -119172.93  0.63%     -    0s
H    0     0                    -118458.6998 -119172.93  0.60%     -    0s
     0     0 -118904.67    0   62 -118458.70 -118904.67  0.38%     -    0s
     0     0 -118837.49    0   62 -118458.70 -118837.49  0.32%     -    0s
     0     0 -118785.43    0   20 -118458.70 -118785.43  0.28%     -    0s
     0     0 -118780.78    0   17 -118458.70 -118780.78  0.27%     -    0s
     0     0 -118653.48    0   18 -118458.70 -118653.48  0.16%     -    0s
     0     0 -118643.77    0   16 -118458.70 -118643.77  0.16%     -    0s
     0     0 -118637.17    0   19 -118458.70 -118637.17  0.15%     -    0s
     0     0 -118553.61    0    8 -118458.70 -118553.61  0.08%     -    0s
     0     0 -118553.61    0   38 -118458.70 -118553.61  0.08%     -    0s
H    0     0                    -118465.8662 -118527.22  0.05%     -    0s
     0     0 -118527.22    0   11 -118465.87 -118527.22  0.05%     -    0s
     0     0 -118511.37    0   10 -118465.87 -118511.37  0.04%     -    0s
     0     0 -118498.12    0    8 -118465.87 -118498.12  0.03%     -    0s
     0     0 -118497.55    0    7 -118465.87 -118497.55  0.03%     -    0s
H    0     0                    -118489.6138 -118491.13  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 10
  MIR: 29
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (719 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118490 -118466 -118459 ... -113936

Optimal solution found (tolerance 1.00e-04)
Best objective -1.184896137535e+05, best bound -1.184911277435e+05, gap 0.0013%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 156013.85
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118489.61
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -118489.61 = 156013.85
  [DEBUG]   Current θ from Master = 157621.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1607.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12164.47
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 272.4921, Absolute Gap = 272.4921, Relative Gap = 0.019786
  Not converged yet (gap = 272.49 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x31d0782f
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70860 rows and 28780 columns
Presolve time: 1.23s
Presolved: 83423 rows, 35880 columns, 511819 nonzeros
Variable types: 33621 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340254.1343
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.599e+06
 Factor NZ  : 7.693e+06 (roughly 100 MB of memory)
 Factor Ops : 1.322e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.53215180e+07  1.49806102e+08  9.45e+04 2.52e+01  6.83e+04     2s
   1  -1.15839132e+07  1.34371379e+08  6.57e+04 5.79e+01  4.72e+04     2s
   2  -3.84446302e+06  9.82900913e+07  2.13e+04 2.24e+00  1.64e+04     2s
   3  -7.51284454e+05  7.53566082e+07  9.43e+02 1.08e+00  1.17e+03     2s
   4  -5.03163858e+05  3.26653756e+07  2.61e+02 3.80e-01  3.80e+02     2s
   5  -3.91261511e+05  2.15209879e+07  9.25e+01 2.24e-01  1.95e+02     2s
   6  -3.20559539e+05  1.51253580e+07  4.46e+01 1.47e-01  1.22e+02     2s
   7  -2.39350110e+05  1.21551101e+07  1.61e+01 1.15e-01  8.77e+01     2s
   8  -1.58077279e+05  6.21126286e+06  5.91e+00 5.52e-02  4.31e+01     3s
   9  -1.09729395e+05  3.30136306e+06  3.44e+00 2.87e-02  2.28e+01     3s
  10  -8.69569269e+04  1.10645522e+06  2.22e+00 9.33e-03  7.92e+00     3s
  11  -3.27271220e+04  3.66117731e+05  7.21e-01 2.64e-03  2.62e+00     3s
  12  -1.14960411e+04  1.82448081e+05  4.13e-01 1.83e-03  1.27e+00     3s
  13  -3.70417835e+03  1.44319182e+05  3.35e-01 1.20e-03  9.71e-01     3s
  14   4.02183183e+03  1.08231637e+05  2.62e-01 2.11e-03  6.84e-01     3s
  15   1.25755307e+04  8.19959070e+04  1.89e-01 2.18e-03  4.55e-01     3s
  16   1.77378824e+04  6.90271329e+04  1.50e-01 2.53e-03  3.37e-01     3s
  17   2.29543623e+04  6.06252021e+04  1.13e-01 2.82e-03  2.47e-01     3s
  18   2.61585546e+04  5.37489523e+04  8.93e-02 1.76e-03  1.81e-01     3s
  19   3.04145908e+04  5.04323189e+04  6.22e-02 1.87e-03  1.31e-01     3s
  20   3.20051467e+04  4.77040156e+04  5.18e-02 1.35e-03  1.03e-01     3s
  21   3.39765823e+04  4.57512965e+04  3.91e-02 1.43e-03  7.73e-02     3s
  22   3.56892438e+04  4.42519251e+04  2.90e-02 1.12e-03  5.62e-02     3s
  23   3.70214660e+04  4.34387300e+04  2.13e-02 8.50e-04  4.21e-02     3s
  24   3.76386301e+04  4.25916468e+04  1.74e-02 5.98e-04  3.25e-02     3s
  25   3.85692120e+04  4.19936921e+04  1.20e-02 6.21e-04  2.25e-02     3s
  26   3.87212949e+04  4.16370877e+04  1.09e-02 4.46e-04  1.92e-02     3s
  27   3.93772380e+04  4.14682123e+04  7.30e-03 3.60e-04  1.37e-02     3s
  28   3.94865484e+04  4.12489434e+04  6.64e-03 4.62e-04  1.16e-02     3s
  29   3.98022866e+04  4.11424962e+04  4.89e-03 3.39e-04  8.80e-03     3s
  30   4.00115684e+04  4.10161991e+04  3.72e-03 2.37e-04  6.60e-03     3s
  31   4.01443407e+04  4.09690639e+04  3.00e-03 1.99e-04  5.42e-03     3s
  32   4.02350137e+04  4.08924370e+04  2.52e-03 1.38e-04  4.32e-03     3s
  33   4.02859645e+04  4.08716524e+04  2.25e-03 1.22e-04  3.85e-03     4s
  34   4.03370664e+04  4.08543916e+04  1.97e-03 1.09e-04  3.40e-03     4s
  35   4.04018082e+04  4.08202820e+04  1.63e-03 8.47e-05  2.75e-03     4s
  36   4.04642601e+04  4.08049752e+04  1.30e-03 7.35e-05  2.24e-03     4s
  37   4.04874316e+04  4.07700634e+04  1.16e-03 4.89e-05  1.86e-03     4s
  38   4.05174039e+04  4.07642988e+04  9.97e-04 4.46e-05  1.62e-03     4s
  39   4.06024676e+04  4.07511768e+04  5.37e-04 3.45e-05  9.77e-04     4s
  40   4.06106718e+04  4.07364012e+04  4.92e-04 2.38e-05  8.26e-04     4s
  41   4.06254090e+04  4.07284406e+04  4.14e-04 1.79e-05  6.77e-04     4s
  42   4.06397632e+04  4.07168719e+04  3.39e-04 8.73e-06  5.07e-04     4s
  43   4.06678042e+04  4.07111440e+04  1.87e-04 4.64e-06  2.85e-04     4s
  44   4.07009888e+04  4.07083205e+04  1.81e-05 2.74e-06  4.80e-05     4s
  45   4.07021394e+04  4.07050153e+04  1.25e-05 3.74e-07  1.89e-05     4s
  46   4.07040281e+04  4.07048011e+04  3.11e-06 7.61e-08  5.09e-06     4s
  47   4.07047080e+04  4.07047144e+04  2.13e-08 4.99e-08  4.17e-08     4s
  48   4.07047130e+04  4.07047134e+04  5.45e-08 4.63e-10  2.89e-09     4s
  49   4.07047134e+04  4.07047134e+04  3.16e-08 1.38e-10  3.14e-11     4s

Barrier solved model in 49 iterations and 4.20 seconds (7.55 work units)
Optimal objective 4.07047134e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

    1307 PPushes remaining with PInf 3.2101979e-06                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1531593e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29681    4.0704713e+04   0.000000e+00   0.000000e+00      6s
   29681    4.0704713e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 4.070471e+04, 29681 iterations, 3.92 seconds (8.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40704.7134    0  232 -164758.14 40704.7134   125%     -    5s
H    0     0                    -158113.8963 40704.7134   126%     -    5s
H    0     0                    -155675.0513 40704.7134   126%     -    6s
H    0     0                    -155468.5322 40704.7134   126%     -    6s
H    0     0                    -154652.8573 40704.7134   126%     -    6s
H    0     0                    -144269.5227 40704.7134   128%     -    6s
H    0     0                    -144154.0469 40704.7134   128%     -    6s
H    0     0                    -68020.86342 40704.7134   160%     -    6s
H    0     0                    -68020.78756 40704.7134   160%     -    6s
H    0     0                    -60984.00327 40704.7134   167%     -    6s
H    0     0                    -60313.77308 40704.7134   167%     -    6s
H    0     0                    -8121.894042 40704.7134   601%     -    6s
H    0     0                    -4519.623294 40704.7134  1001%     -    7s
H    0     0                    -3414.444527 40704.7134  1292%     -    7s
H    0     0                    -3392.167069 40704.7134  1300%     -    7s
H    0     0                    2784.1123341 35922.9150  1190%     -   23s
     0     0 35876.6686    0  332 2784.11233 35876.6686  1189%     -   23s
H    0     0                    3012.7136138 35876.6686  1091%     -   24s
     0     0 35425.9605    0  317 3012.71361 35425.9605  1076%     -   30s
     0     0 35294.8094    0  315 3012.71361 35294.8094  1072%     -   33s
     0     0 35197.8453    0  327 3012.71361 35197.8453  1068%     -   39s
     0     0 34891.1715    0  326 3012.71361 34891.1715  1058%     -   41s
     0     0 34669.3234    0  328 3012.71361 34669.3234  1051%     -   47s
     0     0 34661.9314    0  325 3012.71361 34661.9314  1051%     -   48s
     0     0 34661.8885    0  330 3012.71361 34661.8885  1051%     -   49s
     0     0 34661.8885    0  330 3012.71361 34661.8885  1051%     -   50s
H    0     0                    5750.2738956 31257.7410   444%     -   71s
H    0     0                    6327.9936985 31257.7410   394%     -   71s
     0     0 31257.7410    0  361 6327.99370 31257.7410   394%     -   71s
H    0     0                    6396.2411588 31257.6650   389%     -   72s
H    0     0                    6987.9636946 31257.6650   347%     -   72s
H    0     0                    7006.7392459 31257.6650   346%     -   72s
H    0     0                    7053.1284129 31257.6650   343%     -   72s
H    0     0                    7091.3181276 31257.6650   341%     -   72s
     0     0 30671.9985    0  351 7091.31813 30671.9985   333%     -   85s
     0     0 30363.8344    0  352 7091.31813 30363.8344   328%     -   90s
     0     0 30294.1149    0  372 7091.31813 30294.1149   327%     -   95s
H    0     0                    7093.6154809 30263.6806   327%     -   98s
H    0     0                    7114.7504275 30263.6806   325%     -   98s
     0     0 30263.6806    0  377 7114.75043 30263.6806   325%     -   98s
     0     0 30258.0999    0  385 7114.75043 30258.0999   325%     -   99s
H    0     0                    9811.2093497 30250.5655   208%     -  100s
     0     0 30250.5655    0  383 9811.20935 30250.5655   208%     -  100s
     0     0 30235.8158    0  381 9811.20935 30235.8158   208%     -  101s
     0     0 30234.6969    0  382 9811.20935 30234.6969   208%     -  102s
     0     0 27767.4513    0  387 9811.20935 27767.4513   183%     -  126s
     0     0 27252.0808    0  400 9811.20935 27252.0808   178%     -  135s
     0     0 27035.9981    0  408 9811.20935 27035.9981   176%     -  142s
     0     0 26988.6350    0  407 9811.20935 26988.6350   175%     -  146s
     0     0 26943.3729    0  407 9811.20935 26943.3729   175%     -  149s
     0     0 26884.5248    0  396 9811.20935 26884.5248   174%     -  153s
H    0     0                    10133.678681 26863.9079   165%     -  155s
     0     0 26863.9079    0  403 10133.6787 26863.9079   165%     -  155s
H    0     0                    10488.208742 26839.7250   156%     -  157s
     0     0 26839.7250    0  398 10488.2087 26839.7250   156%     -  157s
     0     0 26796.5200    0  408 10488.2087 26796.5200   155%     -  159s
     0     0 26781.3332    0  405 10488.2087 26781.3332   155%     -  160s
     0     0 26747.0808    0  416 10488.2087 26747.0808   155%     -  163s
     0     0 26732.0146    0  412 10488.2087 26732.0146   155%     -  164s
     0     0 26723.0727    0  407 10488.2087 26723.0727   155%     -  166s
     0     0 26721.6457    0  410 10488.2087 26721.6457   155%     -  166s
     0     0 26143.7434    0  389 10488.2087 26143.7434   149%     -  180s
     0     0 25980.5361    0  447 10488.2087 25980.5361   148%     -  185s
     0     0 25863.6172    0  453 10488.2087 25863.6172   147%     -  189s
     0     0 25825.8967    0  455 10488.2087 25825.8967   146%     -  192s
     0     0 25795.3473    0  450 10488.2087 25795.3473   146%     -  194s
H    0     0                    12592.292944 25771.3730   105%     -  195s
     0     0 25771.3730    0  451 12592.2929 25771.3730   105%     -  195s
     0     0 25766.1640    0  456 12592.2929 25766.1640   105%     -  196s
     0     0 25761.8610    0  451 12592.2929 25761.8610   105%     -  197s
     0     0 25760.3664    0  455 12592.2929 25760.3664   105%     -  197s
     0     0 25650.9705    0  402 12592.2929 25650.9705   104%     -  201s
H    0     0                    12940.954565 25649.2622  98.2%     -  202s
H    0     0                    12951.520626 25649.2622  98.0%     -  202s
     0     0 25638.4926    0  395 12951.5206 25638.4926  98.0%     -  203s
     0     0 25628.0972    0  404 12951.5206 25628.0972  97.9%     -  204s
     0     0 25616.0044    0  398 12951.5206 25616.0044  97.8%     -  205s
     0     0 25614.6490    0  403 12951.5206 25614.6490  97.8%     -  205s
     0     0 25544.3753    0  393 12951.5206 25544.3753  97.2%     -  211s
H    0     0                    13311.645004 25544.3667  91.9%     -  214s
H    0     0                    13329.000180 25544.3667  91.6%     -  214s
H    0     0                    13351.525875 25544.3667  91.3%     -  214s
     0     0 25532.9215    0  395 13351.5259 25532.9215  91.2%     -  216s
     0     0 25530.1975    0  391 13351.5259 25530.1975  91.2%     -  217s
     0     0 25528.6965    0  391 13351.5259 25528.6965  91.2%     -  217s
     0     0 25504.0967    0  397 13351.5259 25504.0967  91.0%     -  219s
     0     0 25496.7972    0  397 13351.5259 25496.7972  91.0%     -  221s
     0     0 25494.2462    0  445 13351.5259 25494.2462  90.9%     -  222s
     0     0 25489.3804    0  398 13351.5259 25489.3804  90.9%     -  222s
     0     0 25488.7809    0  432 13351.5259 25488.7809  90.9%     -  223s
     0     0 25462.8689    0  441 13351.5259 25462.8689  90.7%     -  225s
H    0     0                    13368.881052 25462.6089  90.5%     -  225s
     0     0 25458.5729    0  443 13368.8811 25458.5729  90.4%     -  226s
     0     0 25456.3978    0  447 13368.8811 25456.3978  90.4%     -  227s
     0     0 25454.6385    0  444 13368.8811 25454.6385  90.4%     -  227s
     0     0 25434.5479    0  434 13368.8811 25434.5479  90.3%     -  230s
     0     0 25421.9235    0  433 13368.8811 25421.9235  90.2%     -  231s
     0     0 25417.8537    0  441 13368.8811 25417.8537  90.1%     -  232s
     0     0 25414.0225    0  429 13368.8811 25414.0225  90.1%     -  233s
     0     0 25410.7453    0  429 13368.8811 25410.7453  90.1%     -  233s
     0     0 25410.1313    0  441 13368.8811 25410.1313  90.1%     -  233s
     0     0 25394.0772    0  429 13368.8811 25394.0772  89.9%     -  235s
     0     0 25390.9064    0  381 13368.8811 25390.9064  89.9%     -  241s
     0     0 25389.3663    0  378 13368.8811 25389.3663  89.9%     -  242s
     0     0 25370.4032    0  384 13368.8811 25370.4032  89.8%     -  243s
     0     0 25366.4935    0  386 13368.8811 25366.4935  89.7%     -  244s
     0     0 25365.8859    0  390 13368.8811 25365.8859  89.7%     -  244s
     0     0 25336.4588    0  395 13368.8811 25336.4588  89.5%     -  247s
     0     0 25331.3872    0  388 13368.8811 25331.3872  89.5%     -  248s
     0     0 25331.0473    0  392 13368.8811 25331.0473  89.5%     -  248s
     0     0 25322.8644    0  383 13368.8811 25322.8644  89.4%     -  250s
     0     0 25320.9899    0  326 13368.8811 25320.9899  89.4%     -  251s
     0     0 25309.9146    0  376 13368.8811 25309.9146  89.3%     -  253s
     0     0 25308.2592    0  319 13368.8811 25308.2592  89.3%     -  254s
     0     0 25307.5886    0  385 13368.8811 25307.5886  89.3%     -  255s
     0     0 25307.1765    0  385 13368.8811 25307.1765  89.3%     -  257s
     0     2 25307.1765    0  385 13368.8811 25307.1765  89.3%     -  284s
     1     4 25197.6438    1  379 13368.8811 25307.1765  89.3%  4154  291s
     3     8 25170.8551    2  382 13368.8811 25196.4490  88.5%  5844  300s
     7    16 24978.7894    3  390 13368.8811 25167.0128  88.3%  8429  319s
    15    32 24861.2296    4  383 13368.8811 24977.8701  86.8%  8816  331s
    31    48 23517.1446    5  362 13368.8811 24860.9371  86.0% 10824  355s
H   47    80                    13426.581873 24860.9371  85.2% 12125  366s
    79   143 23261.2907    7  281 13426.5819 24860.9371  85.2%  9035  392s
   142   174 23225.6870    8  357 13426.5819 24860.9371  85.2%  7359  403s
   173   223 23207.3168    9  365 13426.5819 24860.9371  85.2%  6463  416s
H  174   223                    13455.694559 24860.9371  84.8%  6426  416s
   222   320 23059.6804    9  260 13455.6946 24860.9371  84.8%  5530  430s
   329   430 22986.5366   12  363 13455.6946 24860.9371  84.8%  4689  440s
   449   508 22640.8798   13  349 13455.6946 24860.9371  84.8%  3974  450s
   545   577 22614.4022   12  202 13455.6946 24860.9371  84.8%  3633  460s
   635   659 22354.6677   15  348 13455.6946 24860.9371  84.8%  3395  468s
   735   742 22219.9554   17  269 13455.6946 24860.9371  84.8%  3162  476s
   838   779 21802.7439   21  169 13455.6946 24860.9371  84.8%  2946  485s
   891   816 22073.6152   21  174 13455.6946 24860.9371  84.8%  2871  493s
   962   872 21707.5086   21  184 13455.6946 24860.9371  84.8%  2794  502s
  1062   940 21582.9590   22  188 13455.6946 24860.9371  84.8%  2655  510s
  1168  1019 21855.6311   22  241 13455.6946 24860.9371  84.8%  2565  519s
  1296  1089 21518.2012   23  239 13455.6946 24860.9371  84.8%  2441  529s
  1406  1197 21392.4192   24  315 13455.6946 24860.9371  84.8%  2366  538s
  1545  1290 21150.9986   26  313 13455.6946 24860.9371  84.8%  2273  548s
  1679  1343 20741.1771   30  188 13455.6946 24399.3460  81.3%  2227  557s
  1790  1394 19599.3628   34  212 13455.6946 24397.6872  81.3%  2223  567s
  1909  1450 20157.2223   33  190 13455.6946 24397.6872  81.3%  2203  578s
  2024  1514 19055.4343   34  143 13455.6946 24397.6872  81.3%  2206  589s
  2126  1578 18521.7887   37  230 13455.6946 24397.6872  81.3%  2220  600s
  2247  1657 15069.5061   39   64 13455.6946 24084.7101  79.0%  2241  611s
  2356  1764 16903.0704   42  257 13455.6946 24084.3705  79.0%  2272  621s
  2547  1918 15489.0524   46  262 13455.6946 24084.3705  79.0%  2227  632s
  2767  2053 14667.6043   57  228 13455.6946 24084.3705  79.0%  2167  645s
  3001  2149 infeasible   63      13455.6946 23991.8157  78.3%  2106  657s
  3202  2223 13646.7399   70  167 13455.6946 23624.0753  75.6%  2079  671s
  3383  2287 21540.2573    8  303 13455.6946 23624.0753  75.6%  2085  685s
  3514  2386 21390.6440   11  212 13455.6946 23624.0753  75.6%  2117  699s
  3664  2466 21049.8804   15  200 13455.6946 23624.0753  75.6%  2147  713s
  3819  2558 18842.8057   16  198 13455.6946 23624.0753  75.6%  2169  727s
H 3830  2557                    13506.207566 23624.0753  74.9%  2170  727s
H 3886  2527                    13769.576255 23490.2931  70.6%  2184  727s
  3965  2612 17736.7276   17  188 13769.5763 23490.2873  70.6%  2181  743s
  4117  2613 14162.9231   21  385 13769.5763 23490.2873  70.6%  2209  799s
  4119  2614 17629.4118   18  223 13769.5763 23490.2873  70.6%  2208  807s
  4120  2615 14367.4564   61  367 13769.5763 23490.2873  70.6%  2208  838s
  4121  2616 17554.8167   17  380 13769.5763 23490.2873  70.6%  2207  864s
  4122  2616 17910.6283   26  375 13769.5763 23490.2873  70.6%  2207  879s
  4123  2617 18498.2689   24  394 13769.5763 23490.2873  70.6%  2206  887s
  4124  2618 15238.2660   45  376 13769.5763 23490.2873  70.6%  2206  897s
  4125  2618 18151.7467   17  458 13769.5763 23490.2873  70.6%  2205  904s
  4126  2619 15543.0566   25  392 13769.5763 23490.2873  70.6%  2205  910s
  4127  2620 17601.8930   15  378 13769.5763 23490.2873  70.6%  2204  916s
  4129  2621 22583.5082   11  321 13769.5763 23490.2873  70.6%  2203  920s
  4131  2622 18224.2171   14  323 13769.5763 23490.2873  70.6%  2202  925s
  4132  2623 15810.6617   23  381 13769.5763 23490.2873  70.6%  2201  932s
  4133  2624 19170.2599   19  407 13769.5763 23490.2873  70.6%  2201  935s
  4136  2626 19137.2763   18  381 13769.5763 23490.2873  70.6%  2199  946s
  4139  2628 19116.3586   25  365 13769.5763 23490.2873  70.6%  2198  951s
  4140  2628 14863.6054   15  387 13769.5763 23490.2873  70.6%  2197  956s
  4142  2630 18825.6892   11  395 13769.5763 23490.2873  70.6%  2196  962s
  4144  2631 13980.9153   16  388 13769.5763 23490.2873  70.6%  2195  970s
  4146  2632 18480.3487   46  433 13769.5763 23490.2873  70.6%  2194  978s
  4147  2633 21163.0529   15  439 13769.5763 23490.2873  70.6%  2194  980s
  4149  2634 22245.6187   14  378 13769.5763 23490.2873  70.6%  2192  986s
  4150  2635 14109.8960   45  382 13769.5763 23490.2873  70.6%  2192  990s
  4152  2636 20478.9646   10  415 13769.5763 23490.2873  70.6%  2191  995s
  4153  2637 20393.7671   28  415 13769.5763 23490.2873  70.6%  2190 1025s
  4154  2638 17825.0665   20  415 13769.5763 23490.2873  70.6%  2190 1058s
  4155  2641 23490.2873   12  392 13769.5763 23490.2873  70.6%  2240 1118s
  4157  2645 23490.2873   13  378 13769.5763 23490.2873  70.6%  2245 1134s
  4161  2651 23490.2873   14  388 13769.5763 23490.2873  70.6%  2251 1150s
  4169  2665 23490.2873   15  373 13769.5763 23490.2873  70.6%  2260 1163s
  4185  2675 23490.2873   16  358 13769.5763 23490.2873  70.6%  2308 1198s
  4201  2700 19258.0164   17  234 13769.5763 23490.2873  70.6%  2326 1222s
  4232  2820 19134.1078   18  326 13769.5763 23490.2873  70.6%  2399 1246s
  4382  2809 18883.1569   20  282 13769.5763 23490.2873  70.6%  2428 1257s
  4426  2822 18699.4159   23  297 13769.5763 23490.2873  70.6%  2454 1267s
  4458  2839 18479.5271   23  292 13769.5763 23490.2873  70.6%  2478 1277s
  4505  2855 17651.2617   21  188 13769.5763 23490.2873  70.6%  2509 1288s
  4558  2864 17018.8295   22  222 13769.5763 23490.2873  70.6%  2540 1304s
  4608  2875 18527.4795   24  237 13769.5763 23490.2873  70.6%  2573 1315s
  4679  2880 18087.7573   24  281 13769.5763 23490.2873  70.6%  2603 1326s
  4737  2877 18311.7063   24  293 13769.5763 23490.2873  70.6%  2623 1338s
  4808  2877 17759.1943   25  216 13769.5763 23490.2873  70.6%  2653 1352s
  4873  2883 17080.7667   26  214 13769.5763 23490.2873  70.6%  2682 1363s
  4945  2871 16677.9386   27  256 13769.5763 23490.2873  70.6%  2714 1371s
  4990  2872 16459.5253   26  236 13769.5763 23490.2873  70.6%  2739 1385s
  5039  2891 16191.7881   28  303 13769.5763 23490.2873  70.6%  2764 1399s
  5112  2892 15489.6618   30  222 13769.5763 23490.2873  70.6%  2799 1412s
  5187  2885 15128.2918   32  216 13769.5763 23326.0449  69.4%  2834 1426s
  5228  2896 14796.9316   33  178 13769.5763 23326.0449  69.4%  2866 1437s
  5284  2912 13989.2907   36  263 13769.5763 23326.0449  69.4%  2907 1449s
  5344  2928 infeasible   37      13769.5763 23326.0449  69.4%  2939 1460s
  5421  2937 20467.4980   20  317 13769.5763 23326.0449  69.4%  2985 1472s
  5496  2948 19187.8915   22  296 13769.5763 23326.0449  69.4%  3029 1487s
  5576  2983 18547.4960   24  310 13769.5763 22692.4240  64.8%  3063 1500s
  5661  2991     cutoff   26      13769.5763 22692.4240  64.8%  3115 1512s
  5744  2992 14478.9348   27  196 13769.5763 22491.5772  63.3%  3160 1529s
  5833  3013 infeasible   27      13769.5763 22442.5681  63.0%  3223 1543s
  5935  3009 19688.4440   21  194 13769.5763 22442.5681  63.0%  3268 1560s
  6036  3032 16204.8347   23  167 13769.5763 22365.4243  62.4%  3325 1576s
  6139  3023 14554.4407   25   86 13769.5763 22365.4243  62.4%  3378 1591s
  6201  3030 infeasible   26      13769.5763 22326.2895  62.1%  3408 1607s
  6309  3024 15325.5288   20  260 13769.5763 22326.2895  62.1%  3458 1626s
  6414  3010 infeasible   23      13769.5763 21863.1392  58.8%  3513 1645s
  6535  3030 20761.4298   20  389 13769.5763 21852.8558  58.7%  3586 1662s
  6657  3051 19382.8576   22  212 13769.5763 21836.4899  58.6%  3644 1680s
  6800  3036 16362.3364   25  253 13769.5763 21836.4899  58.6%  3715 1698s
  6886  3028     cutoff   26      13769.5763 21836.4899  58.6%  3767 1712s
  6926  3039 16269.3964   27  253 13769.5763 21836.4899  58.6%  3790 1730s
  6979  3040     cutoff   29      13769.5763 21836.4899  58.6%  3820 1754s
  7031  3050 14300.5208   30  217 13769.5763 21836.4899  58.6%  3840 1772s
  7109  3041 19874.4779   25  275 13769.5763 21836.4899  58.6%  3869 1792s
  7227  3059 18903.7875   25  176 13769.5763 21612.4555  57.0%  3915 1816s
  7358  3080 15007.3741   28  302 13769.5763 21558.2524  56.6%  3971 1839s
  7558  3079 infeasible   29      13769.5763 21485.4113  56.0%  4028 1864s
  7739  3054 16072.4748   20  193 13769.5763 21441.9964  55.7%  4109 1887s
  7907  3030 15654.4259   25  273 13769.5763 21441.9964  55.7%  4191 1912s
  8061  3035 infeasible   27      13769.5763 21441.9964  55.7%  4256 1938s
  8276  3044 15531.3596   27  295 13769.5763 21215.6276  54.1%  4314 1965s
  8483  3011     cutoff   32      13769.5763 21134.2066  53.5%  4372 1993s
  8707  3007 17888.1621   25  251 13769.5763 21107.3540  53.3%  4440 2025s
  8930  2984 14074.7795   32  165 13769.5763 20805.3040  51.1%  4518 2051s
  9117  2953 14212.8274   24  166 13769.5763 20758.0705  50.8%  4565 2081s
  9329  2961     cutoff   20      13769.5763 20733.1390  50.6%  4640 2110s
  9599  2917     cutoff   24      13769.5763 20733.1390  50.6%  4722 2146s
  9910  2873 infeasible   26      13769.5763 20514.5969  49.0%  4800 2180s
 10263  2835 17257.8379   20  222 13769.5763 20237.0418  47.0%  4857 2217s
 10598  2795 13980.3861   24  337 13769.5763 20175.0715  46.5%  4930 2257s
 10959  2705 infeasible   38      13769.5763 19980.2286  45.1%  4993 2293s
 11299  2640 infeasible   30      13769.5763 19862.1303  44.2%  5054 2331s
 11690  2522 14393.5156   27  228 13769.5763 19758.6889  43.5%  5124 2369s
 12069  2435     cutoff   27      13769.5763 19525.0797  41.8%  5183 2409s
 12494  2454 14121.5965   29  218 13769.5763 19334.9340  40.4%  5238 2451s
 12981  2511 infeasible   28      13769.5763 19334.9340  40.4%  5277 2494s
 13390  2570 14464.6179   28  238 13769.5763 19141.8781  39.0%  5309 2542s
 13863  2600 14651.8118   35  130 13769.5763 18935.5877  37.5%  5354 2588s
 14360  2647 15405.6829   25  193 13769.5763 18727.0362  36.0%  5386 2639s
 14875  2619 infeasible   41      13769.5763 18606.4283  35.1%  5426 2690s
 15439  2567 infeasible   26      13769.5763 18373.6402  33.4%  5455 2741s
 16047  2462 infeasible   29      13769.5763 18185.6525  32.1%  5478 2795s
 16717  2351 16060.0555   24  320 13769.5763 17941.8706  30.3%  5483 2850s
 17409  2153 infeasible   32      13769.5763 17766.1148  29.0%  5487 2906s
 18142  2065 infeasible   29      13769.5763 17245.8035  25.2%  5486 2960s
 18333  1838 14047.6114   28  275 13769.5763 17057.1074  23.9%  5484 3016s
 18964  1420 infeasible   23      13769.5763 16742.4040  21.6%  5450 3074s
 19932   475 infeasible   28      13769.5763 16331.2606  18.6%  5413 3132s
 21279     0 infeasible   27      13769.5763 15645.1293  13.6%  5283 3183s

Cutting planes:
  Learned: 1
  Implied bound: 5
  Projected implied bound: 115
  MIR: 1067
  Mixing: 3
  Flow cover: 2529
  RLT: 39
  Relax-and-lift: 277

Explored 21873 nodes (114219201 simplex iterations) in 3183.57 seconds (10689.28 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13769.6 13506.2 13455.7 ... 12941

Optimal solution found (tolerance 1.00e-04)
Best objective 1.376957625451e+04, best bound 1.376957625451e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3183.64s
  Master Objective (UB) = 13769.58, θ = 157365.48
  Upper Bound (UB) = 13769.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157365.48
  [DEBUG]   ✓ Scenario 0: θ = 157365.48 ≤ Q = 157365.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157365.48 ≤ Q = 157365.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157365.48 ≤ Q = 157365.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157365.48 ≤ Q = 157365.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157365.48 ≤ Q = 157365.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157365.48 ≤ Q = 157365.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157365.48 ≤ Q = 157365.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157365.48 ≤ Q = 157365.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157365.48 ≤ Q = 157365.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157365.48 ≤ Q = 157365.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x45dd263e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xba22d9c2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.355330e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6717906.7445
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.483214e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148321.42    0  123 6717906.74 -148321.42   102%     -    0s
H    0     0                    -113841.1346 -148321.42  30.3%     -    0s
H    0     0                    -114155.9448 -148321.42  29.9%     -    0s
H    0     0                    -114783.8626 -148321.42  29.2%     -    0s
     0     0 -120804.82    0   28 -114783.86 -120804.82  5.25%     -    0s
H    0     0                    -119250.7748 -120797.00  1.30%     -    0s
H    0     0                    -119570.6800 -120797.00  1.03%     -    0s
H    0     0                    -119588.5194 -120797.00  1.01%     -    0s
H    0     0                    -119908.4246 -120797.00  0.74%     -    0s
     0     0 -120511.73    0   29 -119908.42 -120511.73  0.50%     -    0s
     0     0 -120499.55    0   29 -119908.42 -120499.55  0.49%     -    0s
     0     0 -120270.57    0   14 -119908.42 -120270.57  0.30%     -    0s
H    0     0                    -119913.8364 -120223.95  0.26%     -    0s
     0     0 -120223.95    0   14 -119913.84 -120223.95  0.26%     -    0s
H    0     0                    -119914.9087 -120223.68  0.26%     -    0s
     0     0 -120223.68    0   15 -119914.91 -120223.68  0.26%     -    0s
H    0     0                    -119954.4532 -120223.68  0.22%     -    0s
     0     0 -120132.73    0   14 -119954.45 -120132.73  0.15%     -    0s
     0     0 -120132.73    0   26 -119954.45 -120132.73  0.15%     -    0s
     0     0 -120046.29    0   15 -119954.45 -120046.29  0.08%     -    0s
     0     0 -120044.18    0   14 -119954.45 -120044.18  0.07%     -    0s
     0     0 -120034.92    0   10 -119954.45 -120034.92  0.07%     -    0s
     0     0 -120031.44    0   11 -119954.45 -120031.44  0.06%     -    0s
     0     0 -120015.88    0    9 -119954.45 -120015.88  0.05%     -    0s
H    0     0                    -119971.7671 -120003.83  0.03%     -    0s
     0     0 -120003.83    0    9 -119971.77 -120003.83  0.03%     -    0s
     0     0 -120000.98    0    9 -119971.77 -120000.98  0.02%     -    0s
     0     0 -120000.59    0    9 -119971.77 -120000.59  0.02%     -    0s
     0     0          -    0      -119971.77 -119983.25  0.01%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 26
  Flow cover: 10
  Relax-and-lift: 1

Explored 1 nodes (653 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119972 -119954 -119915 ... 1.35533e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.199717670620e+05, best bound -1.199832462050e+05, gap 0.0096%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 154531.70
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119971.77
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -119971.77 = 154531.70
  [DEBUG]   Current θ from Master = 157365.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2833.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10935.79
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 270.1403, Absolute Gap = 270.1403, Relative Gap = 0.019619
  Not converged yet (gap = 270.14 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x6d5c665b
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77950 rows and 31660 columns
Presolve time: 1.39s
Presolved: 91623 rows, 39240 columns, 557575 nonzeros
Variable types: 36981 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340407.4879
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 642
 AA' NZ     : 3.023e+06
 Factor NZ  : 7.039e+06 (roughly 100 MB of memory)
 Factor Ops : 1.285e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.53482279e+07  1.62878474e+08  9.46e+04 2.53e+01  6.81e+04     3s
   1  -1.16961572e+07  1.46301482e+08  6.61e+04 5.70e+01  4.72e+04     3s
   2  -4.78446703e+06  1.07916921e+08  2.68e+04 5.70e-01  2.03e+04     3s
   3  -8.80744760e+05  7.80438550e+07  1.87e+03 1.53e+00  1.79e+03     3s
   4  -5.31983140e+05  3.06800016e+07  4.63e+02 3.84e-01  4.77e+02     3s
   5  -3.40099345e+05  1.99678730e+07  9.84e+01 2.11e-01  1.77e+02     3s
   6  -2.74561425e+05  1.53295167e+07  5.33e+01 1.53e-01  1.20e+02     3s
   7  -1.65071575e+05  1.14357417e+07  1.49e+01 1.08e-01  7.55e+01     3s
   8  -1.13216012e+05  7.42735342e+06  7.11e+00 6.81e-02  4.71e+01     3s
   9  -8.88588418e+04  3.44362795e+06  4.71e+00 3.01e-02  2.18e+01     3s
  10  -5.88948936e+04  1.13844616e+06  2.61e+00 9.09e-03  7.29e+00     3s
  11  -1.85762933e+04  3.97154197e+05  9.94e-01 2.88e-03  2.50e+00     3s
  12  -8.90742130e+03  2.02999621e+05  6.58e-01 1.46e-03  1.27e+00     3s
  13  -9.32925389e+01  1.41671265e+05  4.83e-01 1.68e-03  8.49e-01     3s
  14   7.04891034e+03  1.15717889e+05  3.75e-01 2.00e-03  6.50e-01     3s
  15   1.45455811e+04  9.58249246e+04  2.76e-01 1.61e-03  4.86e-01     3s
  16   1.99072765e+04  8.24161829e+04  2.16e-01 1.57e-03  3.73e-01     3s
  17   2.10253089e+04  7.57311889e+04  2.04e-01 1.57e-03  3.27e-01     3s
  18   2.62372316e+04  6.77898877e+04  1.47e-01 1.69e-03  2.48e-01     3s
  19   2.84453538e+04  6.05491297e+04  1.25e-01 1.25e-03  1.92e-01     3s
  20   3.17116777e+04  5.77892461e+04  9.48e-02 1.35e-03  1.56e-01     3s
  21   3.42524940e+04  5.37948975e+04  7.29e-02 1.30e-03  1.17e-01     3s
  22   3.49678742e+04  5.23568756e+04  6.69e-02 1.08e-03  1.04e-01     3s
  23   3.61573725e+04  5.15848322e+04  5.71e-02 1.02e-03  9.21e-02     3s
  24   3.69656551e+04  4.99508823e+04  5.05e-02 1.13e-03  7.75e-02     3s
  25   3.84891504e+04  4.89080742e+04  3.77e-02 1.62e-03  6.22e-02     3s
  26   3.93062493e+04  4.80055663e+04  3.15e-02 1.78e-03  5.19e-02     3s
  27   3.99652171e+04  4.76977442e+04  2.65e-02 1.65e-03  4.61e-02     3s
  28   4.05307220e+04  4.65236687e+04  2.24e-02 9.11e-04  3.58e-02     3s
  29   4.07301017e+04  4.63903684e+04  2.10e-02 8.41e-04  3.38e-02     3s
  30   4.17923626e+04  4.58316167e+04  1.37e-02 6.40e-04  2.41e-02     4s
  31   4.19115312e+04  4.56660287e+04  1.29e-02 5.58e-04  2.24e-02     4s
  32   4.24897814e+04  4.52958421e+04  8.95e-03 5.01e-04  1.67e-02     4s
  33   4.27383612e+04  4.48028676e+04  7.39e-03 4.34e-04  1.23e-02     4s
  34   4.29641557e+04  4.45969622e+04  6.01e-03 3.27e-04  9.75e-03     4s
  35   4.34462574e+04  4.42769831e+04  2.99e-03 2.32e-04  4.96e-03     4s
  36   4.37506247e+04  4.41388136e+04  1.14e-03 1.51e-04  2.32e-03     4s
  37   4.38735029e+04  4.40928040e+04  4.80e-04 1.09e-04  1.31e-03     4s
  38   4.38898345e+04  4.40353881e+04  3.97e-04 5.72e-05  8.68e-04     4s
  39   4.39439503e+04  4.39961365e+04  1.19e-04 2.07e-05  3.11e-04     4s
  40   4.39593704e+04  4.39840483e+04  5.31e-05 1.01e-05  1.47e-04     4s
  41   4.39702566e+04  4.39783943e+04  8.01e-06 5.03e-06  4.84e-05     4s
  42   4.39721051e+04  4.39735042e+04  1.51e-06 1.42e-06  8.33e-06     4s
  43   4.39725224e+04  4.39734168e+04  7.61e-08 1.28e-06  5.32e-06     4s
  44   4.39725463e+04  4.39725853e+04  1.18e-07 4.62e-09  2.32e-07     4s
  45   4.39725766e+04  4.39725767e+04  4.39e-10 1.20e-08  9.61e-10     4s

Barrier solved model in 45 iterations and 4.12 seconds (7.21 work units)
Optimal objective 4.39725766e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    4022 PPushes remaining with PInf 3.2240182e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.1364098e-02      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36188    4.3972577e+04   0.000000e+00   5.136410e-02      6s
   36189    4.3972577e+04   0.000000e+00   0.000000e+00      6s
   36189    4.3972577e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.397258e+04, 36189 iterations, 4.07 seconds (8.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43972.5766    0  181 -164758.14 43972.5766   127%     -    6s
H    0     0                    -162395.7482 43972.5766   127%     -    6s
H    0     0                    -161714.6962 43972.5766   127%     -    6s
H    0     0                    -159735.0438 43972.5766   128%     -    6s
H    0     0                    -154906.4858 43972.5766   128%     -    6s
H    0     0                    -48917.92031 43972.5766   190%     -    6s
H    0     0                    -34362.32571 43972.5766   228%     -    7s
H    0     0                    -23483.68621 43972.5766   287%     -    7s
H    0     0                    -22447.27568 43972.5766   296%     -    7s
H    0     0                    -1293.367757 43972.5766  3500%     -    7s
H    0     0                    1842.7574020 38419.5697  1985%     -   25s
H    0     0                    4034.5074890 38419.5697   852%     -   25s
H    0     0                    4226.1925548 38419.5697   809%     -   25s
H    0     0                    4460.7420285 38419.5697   761%     -   25s
     0     0 38419.5697    0  400 4460.74203 38419.5697   761%     -   25s
     0     0 37964.2326    0  384 4460.74203 37964.2326   751%     -   34s
     0     0 37916.1418    0  383 4460.74203 37916.1418   750%     -   38s
     0     0 37864.1070    0  389 4460.74203 37864.1070   749%     -   42s
     0     0 37864.1070    0  389 4460.74203 37864.1070   749%     -   43s
     0     0 37864.1070    0  385 4460.74203 37864.1070   749%     -   44s
     0     0 37864.1070    0  387 4460.74203 37864.1070   749%     -   45s
     0     0 37864.1070    0  386 4460.74203 37864.1070   749%     -   46s
     0     0 37853.4428    0  398 4460.74203 37853.4428   749%     -   48s
     0     0 37850.9332    0  394 4460.74203 37850.9332   749%     -   49s
     0     0 37850.9332    0  394 4460.74203 37850.9332   749%     -   49s
H    0     0                    5336.4737179 33407.9618   526%     -   69s
H    0     0                    5849.8609135 33407.9618   471%     -   69s
     0     0 33407.9618    0  406 5849.86091 33407.9618   471%     -   69s
H    0     0                    10290.507943 33407.9160   225%     -   70s
H    0     0                    10599.676144 33407.9160   215%     -   70s
     0     0 32779.5486    0  379 10599.6761 32779.5486   209%     -   82s
     0     0 32576.7788    0  406 10599.6761 32576.7788   207%     -   90s
     0     0 32519.1559    0  409 10599.6761 32519.1559   207%     -   98s
     0     0 32225.9402    0  405 10599.6761 32225.9402   204%     -  105s
     0     0 32188.8278    0  407 10599.6761 32188.8278   204%     -  108s
     0     0 32174.2608    0  413 10599.6761 32174.2608   204%     -  110s
     0     0 32170.4985    0  417 10599.6761 32170.4985   204%     -  112s
     0     0 32169.5613    0  417 10599.6761 32169.5613   203%     -  112s
     0     0 29139.0529    0  398 10599.6761 29139.0529   175%     -  145s
H    0     0                    11327.421158 29138.5517   157%     -  145s
H    0     0                    12134.490521 29138.5517   140%     -  145s
     0     0 28731.1382    0  410 12134.4905 28731.1382   137%     -  159s
     0     0 28629.5634    0  407 12134.4905 28629.5634   136%     -  167s
     0     0 28534.3854    0  397 12134.4905 28534.3854   135%     -  173s
     0     0 28475.1048    0  411 12134.4905 28475.1048   135%     -  178s
     0     0 28438.8762    0  392 12134.4905 28438.8762   134%     -  181s
     0     0 28398.0778    0  404 12134.4905 28398.0778   134%     -  185s
     0     0 28379.1547    0  404 12134.4905 28379.1547   134%     -  187s
     0     0 28370.2996    0  411 12134.4905 28370.2996   134%     -  189s
     0     0 28315.5668    0  439 12134.4905 28315.5668   133%     -  194s
     0     0 28298.0755    0  438 12134.4905 28298.0755   133%     -  198s
     0     0 28287.0563    0  427 12134.4905 28287.0563   133%     -  200s
     0     0 28286.0353    0  435 12134.4905 28286.0353   133%     -  201s
     0     0 26974.0347    0  415 12134.4905 26974.0347   122%     -  223s
     0     0 26590.5209    0  412 12134.4905 26590.5209   119%     -  235s
     0     0 26429.9942    0  407 12134.4905 26429.9942   118%     -  243s
     0     0 26370.7401    0  468 12134.4905 26370.7401   117%     -  248s
     0     0 26347.5128    0  460 12134.4905 26347.5128   117%     -  251s
     0     0 26337.4377    0  432 12134.4905 26337.4377   117%     -  254s
     0     0 26317.5069    0  458 12134.4905 26317.5069   117%     -  257s
     0     0 26270.6621    0  452 12134.4905 26270.6621   116%     -  259s
     0     0 26264.3569    0  457 12134.4905 26264.3569   116%     -  260s
     0     0 26262.3366    0  453 12134.4905 26262.3366   116%     -  261s
     0     0 26017.0672    0  412 12134.4905 26017.0672   114%     -  269s
H    0     0                    12199.485040 26010.6844   113%     -  270s
H    0     0                    12257.850905 26010.6844   112%     -  270s
H    0     0                    12831.167498 26010.6844   103%     -  270s
     0     0 25966.6102    0  415 12831.1675 25966.6102   102%     -  274s
     0     0 25932.7269    0  473 12831.1675 25932.7269   102%     -  278s
     0     0 25924.3239    0  426 12831.1675 25924.3239   102%     -  281s
     0     0 25900.3472    0  474 12831.1675 25900.3472   102%     -  284s
     0     0 25888.6582    0  458 12831.1675 25888.6582   102%     -  286s
     0     0 25885.4206    0  413 12831.1675 25885.4206   102%     -  287s
     0     0 25884.7756    0  465 12831.1675 25884.7756   102%     -  288s
     0     0 25822.3691    0  350 12831.1675 25822.3691   101%     -  293s
     0     0 25787.9823    0  419 12831.1675 25787.9823   101%     -  300s
     0     0 25773.3348    0  414 12831.1675 25773.3348   101%     -  301s
     0     0 25770.2558    0  413 12831.1675 25770.2558   101%     -  302s
     0     0 25767.9008    0  414 12831.1675 25767.9008   101%     -  303s
     0     0 25709.7553    0  407 12831.1675 25709.7553   100%     -  306s
     0     0 25697.4024    0  400 12831.1675 25697.4024   100%     -  308s
     0     0 25691.3974    0  346 12831.1675 25691.3974   100%     -  310s
     0     0 25687.0854    0  355 12831.1675 25687.0854   100%     -  311s
     0     0 25683.3435    0  413 12831.1675 25683.3435   100%     -  312s
     0     0 25681.6679    0  411 12831.1675 25681.6679   100%     -  312s
     0     0 25671.6856    0  347 12831.1675 25671.6856   100%     -  315s
     0     0 25658.6375    0  406 12831.1675 25658.6375   100%     -  319s
     0     0 25650.9583    0  400 12831.1675 25650.9583   100%     -  321s
     0     0 25642.3649    0  336 12831.1675 25642.3649   100%     -  323s
     0     0 25639.2283    0  340 12831.1675 25639.2283   100%     -  323s
     0     0 25637.4945    0  404 12831.1675 25637.4945   100%     -  324s
     0     0 25623.7729    0  345 12831.1675 25623.7729   100%     -  326s
     0     0 25621.6877    0  345 12831.1675 25621.6877   100%     -  327s
     0     0 25614.6252    0  340 12831.1675 25614.6252   100%     -  330s
     0     0 25613.0122    0  406 12831.1675 25613.0122   100%     -  333s
     0     0 25606.6839    0  339 12831.1675 25606.6839   100%     -  336s
     0     0 25605.2440    0  380 12831.1675 25605.2440   100%     -  337s
     0     0 25602.1016    0  506 12831.1675 25602.1016   100%     -  339s
     0     0 25601.8685    0  506 12831.1675 25601.8685   100%     -  341s
H    0     0                    12973.196658 25601.8387  97.3%     -  375s
H    0     0                    12979.777089 25601.8387  97.2%     -  384s
H    0     0                    13048.092768 25601.8387  96.2%     -  384s
H    0     0                    13077.353327 25601.8387  95.8%     -  385s
H    0     0                    13266.341647 25601.8387  93.0%     -  386s
     0     2 25601.8387    0  506 13266.3416 25601.8387  93.0%     -  388s
     1     3 25315.4726    1  473 13266.3416 25601.6767  93.0%  7421  394s
     2     5 24055.2101    2  381 13266.3416 25601.6767  93.0%  7566  400s
     4    10 25013.3221    2  317 13266.3416 25525.8337  92.4%  6615  407s
     9    19 24596.5652    3  345 13266.3416 25179.5151  89.8%  6190  417s
    18    38 24227.4807    4  359 13266.3416 24606.9475  85.5%  8392  424s
    37    51 24311.6414    5  406 13266.3416 24511.4698  84.8% 10645  444s
    50    77 24238.3127    6  400 13266.3416 24511.4698  84.8% 11188  459s
    76   172 23917.2254    7  329 13266.3416 24511.4698  84.8%  9045  475s
   171   240 23677.8729   10  314 13266.3416 24511.4698  84.8%  6346  486s
H  232   240                    13660.051166 24511.4698  79.4%  5562  486s
   239   271 23591.9445   12  354 13660.0512 24511.4698  79.4%  5559  495s
H  248   271                    13763.189323 24511.4698  78.1%  5447  495s
   270   332 22864.9934   13  344 13763.1893 24511.4698  78.1%  5257  505s
   331   409 23412.3867   13  364 13763.1893 24511.4698  78.1%  4829  516s
   408   457 23196.8363   15  365 13763.1893 24511.4698  78.1%  4510  525s
   459   519 22961.4865   16  360 13763.1893 24511.4698  78.1%  4480  535s
   523   578 22762.5734   17  403 13763.1893 24511.4698  78.1%  4313  545s
   584   654 22554.1759   18  398 13763.1893 24511.4698  78.1%  4107  554s
   664   686 21826.9207   22  366 13763.1893 24511.4698  78.1%  3853  566s
   698   750 22319.5605   19  436 13763.1893 24511.4698  78.1%  3779  575s
   764   826 21486.2498   25  322 13763.1893 24511.4698  78.1%  3701  585s
   842   909 21173.7035   26  330 13763.1893 24511.4698  78.1%  3537  599s
   933   992 21988.3288   20  450 13763.1893 24511.4698  78.1%  3411  608s
  1020  1038 21913.8407   21  455 13763.1893 24511.4698  78.1%  3300  617s
  1080  1095 21775.3124   22  434 13763.1893 24511.4698  78.1%  3254  627s
  1141  1152 20572.3181   32  404 13763.1893 24511.4698  78.1%  3175  638s
  1208  1241 21620.0588   23  421 13763.1893 24511.4698  78.1%  3108  649s
  1305  1296 21378.6705   24  416 13763.1893 24511.4698  78.1%  3031  660s
  1374  1326 20880.5008   25  416 13763.1893 24511.4698  78.1%  3036  673s
  1432  1382 19984.2501   26  417 13763.1893 24511.4698  78.1%  3109  685s
  1531  1407 17080.2542   27  426 13763.1893 24511.4698  78.1%  3099  696s
  1568  1437 16065.7712   28  429 13763.1893 24303.3845  76.6%  3164  709s
  1614  1472 14410.7538   39  218 13763.1893 24303.3845  76.6%  3191  722s
  1663  1513 14442.1800   29  436 13763.1893 24303.3845  76.6%  3218  735s
  1734  1549 14365.7346   30  437 13763.1893 24303.3845  76.6%  3185  748s
  1807  1583 14302.7187   31  426 13763.1893 24303.3845  76.6%  3177  762s
  1883  1639 14262.8765   32  412 13763.1893 24303.3845  76.6%  3195  778s
  1987  1670 infeasible   33      13763.1893 24303.3845  76.6%  3179  794s
  2064  1705 14675.3768   35  346 13763.1893 24303.3845  76.6%  3201  810s
  2147  1753 14611.5860   37  286 13763.1893 24303.3845  76.6%  3211  825s
  2225  1828 14208.4299   45  116 13763.1893 24303.3845  76.6%  3208  844s
  2347  1905 23373.1883   10  387 13763.1893 24078.2085  74.9%  3185  864s
  2476  2000 18337.5717   10  294 13763.1893 24078.2085  74.9%  3148  883s
  2615  2083 20405.6683   10  249 13763.1893 24078.2085  74.9%  3145  900s
  2720  2260 20327.2346   11  230 13763.1893 24078.2085  74.9%  3137  919s
  2943  2356 18525.8619   13  299 13763.1893 24078.2085  74.9%  3083  940s
  3148  2441     cutoff   15      13763.1893 24078.2085  74.9%  3062  959s
  3265  2541 14131.0639   15  206 13763.1893 24078.2085  74.9%  3061  982s
  3465  2614 16714.3029   13  197 13763.1893 24078.2085  74.9%  3037 1006s
  3642  2707 15969.4066   16  338 13763.1893 23847.3114  73.3%  3068 1030s
  3824  2779 14905.6313   20  339 13763.1893 23847.3114  73.3%  3097 1059s
  3951  2892 infeasible   26      13763.1893 23677.4809  72.0%  3153 1087s
  4152  2893 15634.1834   23  506 13763.1893 23677.4809  72.0%  3165 1186s
  4154  2894 19809.5607   23  231 13763.1893 23677.4809  72.0%  3164 1195s
  4155  2895 15075.9494   36  349 13763.1893 23677.4809  72.0%  3163 1237s
  4156  2896 17986.0289   68  407 13763.1893 23677.4809  72.0%  3162 1264s
  4157  2896 14219.9539   72  381 13763.1893 23677.4809  72.0%  3162 1286s
  4158  2897 21338.9107   11  391 13763.1893 23677.4809  72.0%  3161 1305s
  4159  2898 15725.1442   15  388 13763.1893 23677.4809  72.0%  3160 1314s
  4160  2898 21005.4565   36  438 13763.1893 23677.4809  72.0%  3159 1324s
  4161  2899 16666.9522   36  397 13763.1893 23677.4809  72.0%  3159 1331s
  4163  2900 23130.0371    7  341 13763.1893 23677.4809  72.0%  3157 1339s
  4164  2901 14513.4218   23  390 13763.1893 23677.4809  72.0%  3156 1343s
  4165  2902 21068.8817   29  439 13763.1893 23677.4809  72.0%  3156 1345s
  4167  2903 16697.3036   28  398 13763.1893 23677.4809  72.0%  3154 1357s
  4168  2904 17283.8573   20  434 13763.1893 23677.4809  72.0%  3153 1362s
  4170  2905 21118.3590   15  352 13763.1893 23677.4809  72.0%  3152 1367s
  4171  2906 19532.6888   43  452 13763.1893 23677.4809  72.0%  3151 1377s
  4172  2906 14188.3764   18  455 13763.1893 23677.4809  72.0%  3150 1380s
  4174  2908 15108.6070   25  440 13763.1893 23677.4809  72.0%  3149 1391s
  4176  2909 15107.6249   54  351 13763.1893 23677.4809  72.0%  3147 1398s
  4177  2910 18706.8153   21  446 13763.1893 23677.4809  72.0%  3147 1401s
  4178  2910 22977.1251   13  323 13763.1893 23677.4809  72.0%  3146 1408s
  4179  2911 17010.2532   58  379 13763.1893 23677.4809  72.0%  3145 1410s
  4180  2912 15966.7614   17  401 13763.1893 23677.4809  72.0%  3144 1416s
  4182  2913 19063.4605   34  391 13763.1893 23677.4809  72.0%  3143 1424s
  4183  2914 14827.5779   35  385 13763.1893 23677.4809  72.0%  3142 1426s
  4184  2914 17848.6541   48  382 13763.1893 23677.4809  72.0%  3141 1430s
  4186  2916 21562.9861   28  381 13763.1893 23677.4809  72.0%  3140 1435s
  4187  2916 14362.8079   39  381 13763.1893 23677.4809  72.0%  3139 1447s
  4188  2917 17701.8088   28  381 13763.1893 23677.4809  72.0%  3138 1468s
  4189  2921 23677.4809   10  382 13763.1893 23677.4809  72.0%  3205 1498s
  4191  2924 23677.4809   11  380 13763.1893 23677.4809  72.0%  3206 1514s
  4195  2931 23677.4809   12  385 13763.1893 23677.4809  72.0%  3214 1536s
  4203  2944 23677.4809   13  389 13763.1893 23677.4809  72.0%  3227 1552s
  4219  2953 22774.3271   14  348 13763.1893 23677.4809  72.0%  3276 1585s
  4235  2975 20421.6845   15  352 13763.1893 23677.4809  72.0%  3330 1612s
  4265  3078 20098.4439   16  369 13763.1893 23677.4809  72.0%  3376 1639s
  4388  3075 19753.2506   20  351 13763.1893 23677.4809  72.0%  3468 1653s
  4427  3106 19384.7416   21  344 13763.1893 23677.4809  72.0%  3481 1669s
  4476  3134 19595.0975   19  351 13763.1893 23677.4809  72.0%  3503 1686s
  4538  3167 18210.8604   21  204 13763.1893 23677.4809  72.0%  3522 1701s
  4618  3190 15887.9191   22  265 13763.1893 23677.4809  72.0%  3545 1716s
  4685  3195 18608.8071   24  270 13763.1893 23677.4809  72.0%  3573 1739s
  4743  3210 17282.5283   24  187 13763.1893 23677.4809  72.0%  3601 1751s
  4806  3237 17269.3518   25  181 13763.1893 23677.4809  72.0%  3633 1763s
  4875  3224     cutoff   26      13763.1893 23677.4809  72.0%  3652 1774s
  4914  3245 17989.3791   26  275 13763.1893 23677.4809  72.0%  3669 1787s
  4967  3243 18225.2916   26  263 13763.1893 23677.4809  72.0%  3670 1798s
  5028  3243 17613.9564   28  229 13763.1893 23677.4809  72.0%  3681 1812s
  5079  3240 17002.9387   29  234 13763.1893 23677.4809  72.0%  3702 1830s
  5142  3238 16674.1986   30  215 13763.1893 23677.4809  72.0%  3736 1848s
  5208  3229 15599.1729   31  191 13763.1893 23677.4809  72.0%  3765 1865s
  5270  3235 16104.0831   32  264 13763.1893 23677.4809  72.0%  3800 1879s
  5326  3249 14614.5308   35  236 13763.1893 23677.4809  72.0%  3846 1892s
  5397  3254     cutoff   38      13763.1893 23677.4809  72.0%  3892 1907s
  5461  3277 infeasible   40      13763.1893 23677.4809  72.0%  3932 1923s
  5544  3287 19146.1295   16  345 13763.1893 23677.4809  72.0%  3982 1937s
  5618  3308 18502.6774   17  366 13763.1893 23677.4809  72.0%  4030 1954s
  5702  3326 17775.9049   19  382 13763.1893 23677.4809  72.0%  4079 1972s
  5812  3305 17217.6516   22  342 13763.1893 23677.4809  72.0%  4117 1990s
  5857  3303 17016.7218   23  296 13763.1893 23677.4809  72.0%  4132 2012s
  5901  3310 16856.9583   24  302 13763.1893 23082.4303  67.7%  4147 2025s
  5941  3321 16759.6539   25  287 13763.1893 23082.2103  67.7%  4162 2041s
  5980  3338 16610.1436   26  226 13763.1893 23082.2103  67.7%  4185 2057s
  6020  3355 16449.6070   27  225 13763.1893 22750.6087  65.3%  4214 2075s
  6062  3368 16310.0382   28  266 13763.1893 22750.6087  65.3%  4231 2091s
  6103  3401 14782.9098   29  245 13763.1893 22505.0128  63.5%  4255 2108s
  6184  3401     cutoff   30      13763.1893 22505.0128  63.5%  4256 2128s
  6274  3419 infeasible   30      13763.1893 22394.3748  62.7%  4287 2149s
  6359  3421 15110.1250   29  238 13763.1893 22300.1763  62.0%  4343 2170s
  6452  3433 14312.3650   30  233 13763.1893 22300.1763  62.0%  4391 2194s
  6585  3458 13945.4153   31  261 13763.1893 22300.1763  62.0%  4421 2216s
  6702  3489 infeasible   32      13763.1893 22247.5024  61.6%  4454 2243s
  6871  3517 20601.0544   17  106 13763.1893 22247.5024  61.6%  4487 2269s
  7042  3572 20041.5580   19  326 13763.1893 22247.5024  61.6%  4510 2297s
  7209  3542 14289.3633   24  222 13763.1893 22247.5024  61.6%  4542 2318s
  7244  3562 14219.5026   25  262 13763.1893 22247.5024  61.6%  4555 2340s
  7288  3588     cutoff   27      13763.1893 22247.5024  61.6%  4561 2364s
  7385  3655 20020.8664   22  326 13763.1893 21710.2947  57.7%  4585 2392s
  7579  3677 18927.6102   25  339 13763.1893 21687.2761  57.6%  4601 2424s
  7808  3701 17169.0886   30  275 13763.1893 21678.7227  57.5%  4630 2453s
  8031  3746 14507.1532   38  198 13763.1893 21607.8784  57.0%  4682 2484s
  8301  3724 20588.6535   20  308 13763.1893 21607.8784  57.0%  4722 2517s
  8576  3788 19018.1947   28  153 13763.1893 21607.8784  57.0%  4772 2552s
  8872  3829 15234.8659   37  162 13763.1893 21426.0852  55.7%  4808 2587s
  9163  3849     cutoff   21      13763.1893 21371.9302  55.3%  4859 2623s
  9467  3873 14621.4642   21  114 13763.1893 21120.2597  53.5%  4914 2659s
  9792  3893 14970.1168   23  256 13763.1893 21120.2597  53.5%  4962 2698s
 10156  3927 16457.4066   19  315 13763.1893 20927.7795  52.1%  4999 2735s
 10497  3951 15450.3198   23  253 13763.1893 20822.9965  51.3%  5047 2773s
 10864  3919 14877.8185   22  181 13763.1893 20682.3646  50.3%  5099 2817s
 11286  3894 infeasible   22      13763.1893 20639.3092  50.0%  5137 2857s
 11710  3881 infeasible   30      13763.1893 20627.2417  49.9%  5179 2902s
 12144  3855 infeasible   26      13763.1893 20490.8299  48.9%  5218 2948s
 12593  3754 16271.9952   32  201 13763.1893 20419.7505  48.4%  5260 2995s
 13075  3737     cutoff   23      13763.1893 20329.4592  47.7%  5294 3044s
 13502  3782 16950.1599   21  160 13763.1893 20165.2657  46.5%  5349 3097s
 13912  3771 15823.4489   20  334 13763.1893 20027.8413  45.5%  5405 3149s
 13990  3798 15646.0811   21  379 13763.1893 19973.1960  45.1%  5414 3197s
 14065  3862 infeasible   20      13763.1893 19973.1960  45.1%  5421 3245s
 14230  3902 15337.0863   23  347 13763.1893 19973.1960  45.1%  5435 3298s
 14585  3946 18016.0429   20  324 13763.1893 19875.2742  44.4%  5466 3356s
 15058  4032     cutoff   25      13763.1893 19755.3703  43.5%  5522 3418s
 15514  4062 infeasible   22      13763.1893 19520.4666  41.8%  5593 3485s
 16092  4073 13818.3349   24  352 13763.1893 19280.8470  40.1%  5636 3552s
 16661  4077 infeasible   18      13763.1893 19080.8521  38.6%  5685 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 66
  Projected implied bound: 205
  MIR: 1134
  Mixing: 1
  Flow cover: 2997
  Zero half: 1
  RLT: 29
  Relax-and-lift: 276

Explored 17198 nodes (98690876 simplex iterations) in 3600.05 seconds (11742.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13763.2 13660.1 13266.3 ... 12199.5

Time limit reached
Best objective 1.376318932308e+04, best bound 1.882791927250e+04, gap 36.7991%
  WARNING: Time limit reached. Using best solution found (gap: 36.80%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 13763.19, θ = 157318.53
  Upper Bound (UB) = 13763.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157318.53
  [DEBUG]   ✓ Scenario 0: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157318.53 ≤ Q = 157318.53 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x37a71f79
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x37a71f79
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.355330e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6739618.4297
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.483560e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148356.01    0  124 6739618.43 -148356.01   102%     -    0s
H    0     0                    -113888.0832 -148356.01  30.3%     -    0s
H    0     0                    -114202.8934 -148356.01  29.9%     -    0s
H    0     0                    -114830.8112 -148356.01  29.2%     -    0s
     0     0 -121819.24    0   44 -114830.81 -121819.24  6.09%     -    0s
H    0     0                    -120340.3951 -121818.44  1.23%     -    0s
     0     0 -121449.13    0   19 -120340.40 -121449.13  0.92%     -    0s
H    0     0                    -120540.8916 -121440.77  0.75%     -    0s
     0     0 -121272.27    0   15 -120540.89 -121272.27  0.61%     -    0s
H    0     0                    -120715.9081 -121272.27  0.46%     -    0s
     0     0 -120901.32    0   14 -120715.91 -120901.32  0.15%     -    0s
     0     0 -120876.70    0   13 -120715.91 -120876.70  0.13%     -    0s
     0     0 -120849.00    0    8 -120715.91 -120849.00  0.11%     -    0s
H    0     0                    -120729.7986 -120849.00  0.10%     -    0s
     0     0 -120779.37    0    6 -120729.80 -120779.37  0.04%     -    0s
     0     0 -120779.37    0   26 -120729.80 -120779.37  0.04%     -    0s
     0     0 -120779.37    0   19 -120729.80 -120779.37  0.04%     -    0s
     0     0 -120779.37    0   13 -120729.80 -120779.37  0.04%     -    0s
     0     0 -120779.37    0   12 -120729.80 -120779.37  0.04%     -    0s
     0     0 -120779.37    0   11 -120729.80 -120779.37  0.04%     -    0s
H    0     0                    -120737.0959 -120779.37  0.04%     -    0s
*    0     0               0    -120750.6157 -120750.62  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 7
  Flow cover: 5
  RLT: 3
  Relax-and-lift: 1

Explored 1 nodes (575 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120751 -120737 -120730 ... 6.73962e+06
No other solutions better than -120751

Optimal solution found (tolerance 1.00e-04)
Best objective -1.207506157337e+05, best bound -1.207506157337e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 153752.85
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120750.62
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -120750.62 = 153752.85
  [DEBUG]   Current θ from Master = 157318.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3565.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10197.51
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 263.7534, Absolute Gap = 263.7534, Relative Gap = 0.019164
  Not converged yet (gap = 263.75 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x445efe3f
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85060 rows and 34550 columns
Presolve time: 1.48s
Presolved: 99803 rows, 42590 columns, 605195 nonzeros
Variable types: 40331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -341781.6027
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 638
 AA' NZ     : 3.451e+06
 Factor NZ  : 8.159e+06 (roughly 120 MB of memory)
 Factor Ops : 1.550e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.55156478e+07  1.75160165e+08  9.57e+04 2.44e+01  6.83e+04     3s
   1  -1.18585185e+07  1.57500101e+08  6.69e+04 5.57e+01  4.74e+04     3s
   2  -4.48660881e+06  1.15962667e+08  2.64e+04 8.83e-01  1.98e+04     3s
   3  -7.37280649e+05  8.40801151e+07  2.13e+03 1.60e+00  1.96e+03     3s
   4  -4.28504956e+05  4.09245891e+07  4.50e+02 5.98e-01  5.12e+02     3s
   5  -3.12041242e+05  2.77406723e+07  1.08e+02 3.61e-01  2.17e+02     3s
   6  -2.68868632e+05  2.08526768e+07  6.14e+01 2.57e-01  1.48e+02     3s
   7  -1.94072134e+05  1.44138674e+07  2.08e+01 1.67e-01  8.89e+01     3s
   8  -1.22183003e+05  1.00556148e+07  5.67e+00 1.13e-01  5.75e+01     3s
   9  -9.55684815e+04  6.29305555e+06  3.50e+00 6.94e-02  3.57e+01     3s
  10  -7.00932001e+04  2.12044665e+06  1.90e+00 2.22e-02  1.21e+01     3s
  11  -2.47083955e+04  5.70294093e+05  7.71e-01 5.26e-03  3.28e+00     3s
  12  -1.37593548e+04  3.04348183e+05  5.06e-01 2.80e-03  1.75e+00     3s
  13  -8.45433014e+03  1.96127779e+05  4.11e-01 1.59e-03  1.12e+00     3s
  14  -9.10914718e+02  1.68016660e+05  3.21e-01 1.38e-03  9.27e-01     3s
  15   6.26043625e+03  1.24140562e+05  2.46e-01 1.30e-03  6.46e-01     3s
  16   1.58777107e+04  9.73447996e+04  1.69e-01 1.37e-03  4.47e-01     3s
  17   2.01028500e+04  8.12929719e+04  1.40e-01 1.46e-03  3.35e-01     3s
  18   2.32217322e+04  7.17244209e+04  1.18e-01 1.82e-03  2.66e-01     3s
  19   2.71747923e+04  6.51754883e+04  9.31e-02 1.80e-03  2.08e-01     3s
  20   2.79004056e+04  5.92843004e+04  8.81e-02 1.61e-03  1.72e-01     3s
  21   3.15715515e+04  5.66987486e+04  6.55e-02 1.19e-03  1.38e-01     3s
  22   3.20388573e+04  5.35540511e+04  6.25e-02 1.23e-03  1.18e-01     3s
  23   3.28619389e+04  5.27013505e+04  5.76e-02 1.22e-03  1.09e-01     3s
  24   3.35044574e+04  5.10525181e+04  5.41e-02 1.22e-03  9.62e-02     3s
  25   3.37817951e+04  5.04497965e+04  5.25e-02 1.12e-03  9.14e-02     4s
  26   3.50981063e+04  4.96704286e+04  4.53e-02 1.53e-03  7.99e-02     4s
  27   3.58380819e+04  4.83365462e+04  4.11e-02 1.36e-03  6.85e-02     4s
  28   3.62692507e+04  4.73569942e+04  3.87e-02 1.10e-03  6.08e-02     4s
  29   3.73449273e+04  4.71320544e+04  3.29e-02 1.03e-03  5.37e-02     4s
  30   3.83339190e+04  4.68975319e+04  2.74e-02 1.06e-03  4.70e-02     4s
  31   3.86370382e+04  4.61757411e+04  2.57e-02 8.53e-04  4.13e-02     4s
  32   3.90062011e+04  4.58887808e+04  2.36e-02 7.72e-04  3.77e-02     4s
  33   3.94361247e+04  4.56186762e+04  2.13e-02 6.94e-04  3.39e-02     4s
  34   3.97087969e+04  4.55235026e+04  1.97e-02 6.66e-04  3.19e-02     4s
  35   3.99774595e+04  4.49846394e+04  1.82e-02 5.07e-04  2.75e-02     4s
  36   4.08128347e+04  4.45936937e+04  1.37e-02 3.77e-04  2.07e-02     4s
  37   4.12997273e+04  4.42462232e+04  1.11e-02 2.69e-04  1.62e-02     4s
  38   4.18706753e+04  4.39922438e+04  8.13e-03 1.81e-04  1.16e-02     4s
  39   4.20635341e+04  4.38559268e+04  7.09e-03 1.41e-04  9.83e-03     4s
  40   4.22859537e+04  4.37796832e+04  5.86e-03 1.16e-04  8.20e-03     4s
  41   4.24442359e+04  4.36612605e+04  5.04e-03 8.81e-05  6.68e-03     4s
  42   4.25714248e+04  4.36051452e+04  4.38e-03 6.08e-05  5.67e-03     4s
  43   4.26931405e+04  4.35617892e+04  3.75e-03 4.63e-05  4.77e-03     4s
  44   4.29083527e+04  4.35479721e+04  2.65e-03 4.71e-05  3.51e-03     4s
  45   4.29839635e+04  4.35151527e+04  2.28e-03 3.15e-05  2.92e-03     4s
  46   4.33235584e+04  4.34792066e+04  5.09e-04 7.52e-05  8.53e-04     5s
  47   4.33817560e+04  4.34381394e+04  2.17e-04 1.05e-04  3.09e-04     5s
  48   4.34234676e+04  4.34349908e+04  1.95e-05 6.11e-05  6.31e-05     5s
  49   4.34304638e+04  4.34308772e+04  3.24e-07 5.14e-06  2.26e-06     5s
  50   4.34306776e+04  4.34306779e+04  3.97e-10 1.53e-08  1.22e-09     5s

Barrier solved model in 50 iterations and 4.65 seconds (8.55 work units)
Optimal objective 4.34306776e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

   11570 PPushes remaining with PInf 4.8548642e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.3393830e+03      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48676    4.3430678e+04   0.000000e+00   3.339383e+03      7s
   48879    4.3430678e+04   0.000000e+00   0.000000e+00      7s
   48879    4.3430678e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.32s

Solved with barrier

Root relaxation: objective 4.343068e+04, 48879 iterations, 5.44 seconds (11.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43430.6778    0  184 -164758.14 43430.6778   126%     -    7s
H    0     0                    -159623.0976 43430.6778   127%     -    7s
H    0     0                    -48032.22772 43430.6778   190%     -    8s
H    0     0                    -12314.05398 43430.6778   453%     -    8s
H    0     0                    -1247.904630 43430.6778  3580%     -    8s
H    0     0                    1347.6998929 43430.6778  3123%     -    8s
H    0     0                    1419.0451919 43430.6778  2961%     -    8s
H    0     0                    1953.2135880 38368.9395  1864%     -   28s
H    0     0                    2144.8986538 38368.9395  1689%     -   28s
H    0     0                    3843.6227091 38368.9395   898%     -   28s
H    0     0                    4088.0943136 38368.9395   839%     -   28s
H    0     0                    4280.4233094 38368.9395   796%     -   28s
     0     0 38311.4947    0  406 4280.42331 38311.4947   795%     -   28s
     0     0 37842.5201    0  435 4280.42331 37842.5201   784%     -   35s
     0     0 37778.7797    0  455 4280.42331 37778.7797   783%     -   37s
     0     0 37683.8237    0  429 4280.42331 37683.8237   780%     -   41s
     0     0 37683.1947    0  422 4280.42331 37683.1947   780%     -   44s
     0     0 37683.1947    0  422 4280.42331 37683.1947   780%     -   46s
     0     0 37683.1947    0  425 4280.42331 37683.1947   780%     -   47s
     0     0 37683.1947    0  433 4280.42331 37683.1947   780%     -   48s
     0     0 37683.1947    0  428 4280.42331 37683.1947   780%     -   48s
     0     0 37683.1947    0  428 4280.42331 37683.1947   780%     -   49s
H    0     0                    6914.1015304 33510.1784   385%     -   74s
H    0     0                    6997.3945747 33510.1784   379%     -   74s
     0     0 33510.1784    0  355 6997.39457 33510.1784   379%     -   74s
H    0     0                    9662.4137192 33510.0565   247%     -   75s
     0     0 32682.0782    0  373 9662.41372 32682.0782   238%     -   92s
     0     0 32491.9772    0  359 9662.41372 32491.9772   236%     -  100s
     0     0 32467.5030    0  366 9662.41372 32467.5030   236%     -  104s
     0     0 32438.4609    0  373 9662.41372 32438.4609   236%     -  107s
     0     0 32313.9604    0  386 9662.41372 32313.9604   234%     -  114s
     0     0 32302.6611    0  368 9662.41372 32302.6611   234%     -  116s
     0     0 31975.0009    0  377 9662.41372 31975.0009   231%     -  126s
     0     0 31950.7042    0  377 9662.41372 31950.7042   231%     -  128s
     0     0 31916.5444    0  382 9662.41372 31916.5444   230%     -  131s
     0     0 31838.6172    0  384 9662.41372 31838.6172   230%     -  136s
     0     0 31831.4531    0  378 9662.41372 31831.4531   229%     -  139s
     0     0 31829.4826    0  373 9662.41372 31829.4826   229%     -  140s
     0     0 31828.8825    0  375 9662.41372 31828.8825   229%     -  141s
     0     0 29153.9524    0  395 9662.41372 29153.9524   202%     -  171s
H    0     0                    11669.056851 29152.7446   150%     -  171s
H    0     0                    11930.235537 29152.7446   144%     -  171s
     0     0 28435.1033    0  403 11930.2355 28435.1033   138%     -  186s
     0     0 28031.2377    0  423 11930.2355 28031.2377   135%     -  196s
     0     0 27927.7958    0  422 11930.2355 27927.7958   134%     -  202s
     0     0 27915.6118    0  430 11930.2355 27915.6118   134%     -  204s
     0     0 27904.8906    0  447 11930.2355 27904.8906   134%     -  207s
     0     0 27895.2454    0  435 11930.2355 27895.2454   134%     -  211s
     0     0 27789.5137    0  432 11930.2355 27789.5137   133%     -  218s
     0     0 27765.8349    0  420 11930.2355 27765.8349   133%     -  220s
     0     0 27763.0297    0  420 11930.2355 27763.0297   133%     -  221s
     0     0 27759.0691    0  430 11930.2355 27759.0691   133%     -  221s
     0     0 27756.8803    0  430 11930.2355 27756.8803   133%     -  222s
     0     0 26819.4176    0  379 11930.2355 26819.4176   125%     -  241s
     0     0 26595.2134    0  378 11930.2355 26595.2134   123%     -  248s
     0     0 26418.8840    0  397 11930.2355 26418.8840   121%     -  253s
     0     0 26376.7868    0  404 11930.2355 26376.7868   121%     -  256s
     0     0 26349.7024    0  391 11930.2355 26349.7024   121%     -  259s
     0     0 26331.4004    0  399 11930.2355 26331.4004   121%     -  261s
     0     0 26319.4438    0  412 11930.2355 26319.4438   121%     -  263s
     0     0 26315.7092    0  413 11930.2355 26315.7092   121%     -  264s
     0     0 26314.6917    0  397 11930.2355 26314.6917   121%     -  265s
     0     0 26114.4904    0  396 11930.2355 26114.4904   119%     -  272s
     0     0 26079.4060    0  398 11930.2355 26079.4060   119%     -  276s
     0     0 26068.6394    0  408 11930.2355 26068.6394   119%     -  279s
     0     0 26064.4447    0  410 11930.2355 26064.4447   118%     -  281s
     0     0 26053.5013    0  414 11930.2355 26053.5013   118%     -  283s
     0     0 26051.0102    0  414 11930.2355 26051.0102   118%     -  284s
H    0     0                    12129.878076 25913.2018   114%     -  291s
H    0     0                    12169.758948 25913.2018   113%     -  291s
     0     0 25913.2018    0  378 12169.7589 25913.2018   113%     -  291s
H    0     0                    12216.722974 25911.7181   112%     -  296s
H    0     0                    12256.603845 25886.0679   111%     -  299s
H    0     0                    12260.810431 25886.0679   111%     -  299s
     0     0 25886.0679    0  383 12260.8104 25886.0679   111%     -  299s
     0     0 25876.7910    0  396 12260.8104 25876.7910   111%     -  301s
     0     0 25868.7470    0  388 12260.8104 25868.7470   111%     -  302s
     0     0 25865.5818    0  383 12260.8104 25865.5818   111%     -  303s
     0     0 25864.2307    0  382 12260.8104 25864.2307   111%     -  304s
     0     0 25829.0928    0  396 12260.8104 25829.0928   111%     -  308s
H    0     0                    12694.378237 25827.8721   103%     -  309s
H    0     0                    12831.167498 25827.8721   101%     -  309s
     0     0 25796.4267    0  406 12831.1675 25796.4267   101%     -  311s
     0     0 25778.5070    0  410 12831.1675 25778.5070   101%     -  313s
     0     0 25760.3663    0  404 12831.1675 25760.3663   101%     -  315s
     0     0 25756.1470    0  409 12831.1675 25756.1470   101%     -  316s
     0     0 25755.4253    0  413 12831.1675 25755.4253   101%     -  318s
     0     0 25725.5341    0  390 12831.1675 25725.5341   100%     -  321s
     0     0 25714.6970    0  400 12831.1675 25714.6970   100%     -  325s
     0     0 25707.5239    0  400 12831.1675 25707.5239   100%     -  326s
     0     0 25702.2330    0  404 12831.1675 25702.2330   100%     -  328s
     0     0 25697.0371    0  400 12831.1675 25697.0371   100%     -  328s
     0     0 25694.9011    0  397 12831.1675 25694.9011   100%     -  329s
     0     0 25669.7913    0  392 12831.1675 25669.7913   100%     -  333s
     0     0 25651.1952    0  409 12831.1675 25651.1952   100%     -  335s
     0     0 25644.1694    0  407 12831.1675 25644.1694   100%     -  337s
     0     0 25640.5890    0  405 12831.1675 25640.5890   100%     -  338s
     0     0 25637.7338    0  398 12831.1675 25637.7338   100%     -  339s
     0     0 25637.4233    0  401 12831.1675 25637.4233   100%     -  340s
     0     0 25616.9749    0  383 12831.1675 25616.9749   100%     -  343s
H    0     0                    12851.260796 25616.4490  99.3%     -  354s
H    0     0                    12864.525951 25616.4490  99.1%     -  354s
     0     0 25610.4131    0  402 12864.5260 25610.4131  99.1%     -  356s
     0     0 25607.6686    0  403 12864.5260 25607.6686  99.1%     -  357s
     0     0 25606.5801    0  398 12864.5260 25606.5801  99.0%     -  358s
     0     0 25596.7190    0  401 12864.5260 25596.7190  99.0%     -  361s
H    0     0                    12895.990378 25595.7719  98.5%     -  362s
     0     0 25592.4937    0  402 12895.9904 25592.4937  98.5%     -  363s
     0     0 25591.9435    0  402 12895.9904 25591.9435  98.4%     -  363s
     0     0 25586.5837    0  396 12895.9904 25586.5837  98.4%     -  366s
     0     0 25586.5607    0  396 12895.9904 25586.5607  98.4%     -  368s
H    0     0                    13148.630819 25586.5607  94.6%     -  401s
H    0     0                    13286.969692 25586.5607  92.6%     -  402s
     0     2 25586.5607    0  396 13286.9697 25586.5607  92.6%     -  402s
     1     3 24451.5187    1  276 13286.9697 25586.5607  92.6% 22724  419s
     2     5 23510.0623    2  269 13286.9697 25586.5607  92.6% 16305  427s
     4    10 25300.9258    2  439 13286.9697 25434.3179  91.4% 11615  434s
     9    20 24813.9061    3  445 13286.9697 25300.5265  90.4%  9672  447s
    19    40 24451.2090    4  435 13286.9697 24813.7216  86.8% 10014  457s
    39    52 23057.3382    5  273 13286.9697 24599.2044  85.1% 12826  485s
    51    76 22845.4470    6  249 13286.9697 24599.2044  85.1% 13795  508s
H   55    76                    13358.314991 24599.2044  84.1% 13475  508s
H   66    76                    13368.881052 24599.2044  84.0% 12769  508s
    75   108 22523.7203    7  290 13368.8811 24599.2044  84.0% 11809  520s
   107   140 22396.6525    8  270 13368.8811 24599.2044  84.0% 10799  532s
H  117   140                    13372.401515 24599.2044  84.0% 10131  532s
   139   210 22062.5665    9  281 13372.4015 24599.2044  84.0%  9171  551s
H  154   210                    13455.694559 24599.2044  82.8%  8828  551s
   217   281 21374.7957   13  243 13455.6946 24599.2044  82.8%  7256  566s
H  308   363                    13660.051166 24599.2044  80.1%  6165  581s
   404   384     cutoff   20      13660.0512 24599.2044  80.1%  5295  594s
   471   446 21493.7778   11  384 13660.0512 24599.2044  80.1%  4953  606s
H  497   446                    13687.317542 24599.2044  79.7%  4843  606s
H  500   446                    13739.815826 24599.2044  79.0%  4839  606s
   549   501 20610.6769   12  303 13739.8158 24599.2044  79.0%  4694  617s
   624   552 20145.2106   13  273 13739.8158 24599.2044  79.0%  4477  629s
H  627   552                    13757.171002 24599.2044  78.8%  4470  629s
   693   588 19678.6770   14  306 13757.1710 24599.2044  78.8%  4355  641s
   755   616 19590.5822   15  188 13757.1710 24599.2044  78.8%  4240  654s
   787   676 19401.1902   16  195 13757.1710 24599.2044  78.8%  4242  664s
   861   752 18922.2037   18  194 13757.1710 24599.2044  78.8%  4163  675s
   970   831 18752.8732   18  186 13757.1710 24599.2044  78.8%  3925  687s
  1069   871 18692.5418   20  185 13757.1710 24599.2044  78.8%  3781  701s
  1141   888 18529.3814   19  264 13757.1710 24599.2044  78.8%  3720  712s
  1208   925 18583.4623   21  182 13757.1710 24599.2044  78.8%  3706  725s
  1263   966 18352.7981   22  184 13757.1710 24599.2044  78.8%  3705  739s
  1350  1004 15339.3945   22  240 13757.1710 24599.2044  78.8%  3657  751s
  1436  1058 16984.9865   23  154 13757.1710 24599.2044  78.8%  3611  765s
  1545  1093 14972.1150   24  283 13757.1710 24324.2817  76.8%  3520  779s
  1640  1119 15252.2041   23  242 13757.1710 24319.7840  76.8%  3479  795s
  1736  1146     cutoff   25      13757.1710 24319.7840  76.8%  3458  812s
  1814  1178 21245.8116   10  336 13757.1710 24319.7840  76.8%  3458  830s
  1891  1205 16278.9069   10  362 13757.1710 24319.7840  76.8%  3493  847s
  1940  1240 20618.1106   12  321 13757.1710 24278.0562  76.5%  3559  863s
  1994  1293 20021.0652   14  229 13757.1710 24278.0562  76.5%  3602  882s
  2085  1365     cutoff   17      13757.1710 24278.0562  76.5%  3631  902s
  2196  1417 16239.4113   20  272 13757.1710 24278.0562  76.5%  3620  919s
  2291  1501 15513.5814   25  247 13757.1710 23994.8384  74.4%  3595  938s
  2419  1514     cutoff   40      13757.1710 23994.8384  74.4%  3549  956s
  2470  1553     cutoff   40      13757.1710 23994.8384  74.4%  3561  975s
  2543  1620 21295.1002    7  293 13757.1710 23994.8384  74.4%  3557  995s
  2662  1698 16267.7820    8  372 13757.1710 23994.8384  74.4%  3541 1017s
  2796  1792 20203.3106    7  363 13757.1710 23994.8384  74.4%  3543 1040s
  2936  1911 19724.8705    8  321 13757.1710 23994.8384  74.4%  3554 1064s
  3095  2043 18491.6944    9  355 13757.1710 23994.8384  74.4%  3551 1096s
  3315  2173 17651.6914   11  372 13757.1710 23994.8384  74.4%  3483 1122s
  3537  2317 16894.1053   14  247 13757.1710 23822.6422  73.2%  3446 1149s
  3745  2491     cutoff   16      13757.1710 23668.2289  72.0%  3412 1176s
  3986  2492 19579.6971   17  396 13757.1710 23202.4473  68.7%  3380 1320s
  3988  2493 21696.7376   12  240 13757.1710 23202.4473  68.7%  3379 1329s
  3989  2494 17429.4474   12  370 13757.1710 23202.4473  68.7%  3378 1364s
  3990  2495 17690.0268   56  384 13757.1710 23202.4473  68.7%  3377 1399s
  3991  2495 15701.9848   55  426 13757.1710 23202.4473  68.7%  3376 1422s
  3992  2496 19483.1072   14  401 13757.1710 23202.4473  68.7%  3375 1435s
  3993  2497 14616.1908   39  394 13757.1710 23202.4473  68.7%  3374 1445s
  3994  2497 18178.5776   49  388 13757.1710 23202.4473  68.7%  3374 1451s
  3995  2498 15538.7455   35  344 13757.1710 23202.4473  68.7%  3373 1458s
  3996  2499 16048.6915   30  381 13757.1710 23202.4473  68.7%  3372 1461s
  3997  2499 21593.3238   12  336 13757.1710 23202.4473  68.7%  3371 1465s
  3998  2500 15789.5941   23  435 13757.1710 23202.4473  68.7%  3370 1471s
  4000  2501 17329.5046   11  407 13757.1710 23202.4473  68.7%  3369 1485s
  4002  2503 15130.4501   56  413 13757.1710 23202.4473  68.7%  3367 1490s
  4004  2504 20343.0955   16  403 13757.1710 23202.4473  68.7%  3365 1495s
  4005  2505 15980.5713   45  385 13757.1710 23202.4473  68.7%  3364 1504s
  4006  2505 20935.2685   27  398 13757.1710 23202.4473  68.7%  3363 1507s
  4007  2506 19663.5108   28  393 13757.1710 23202.4473  68.7%  3363 1512s
  4008  2507 20783.3465   13  401 13757.1710 23202.4473  68.7%  3362 1517s
  4009  2507 18700.9224   17  393 13757.1710 23202.4473  68.7%  3361 1520s
  4010  2508 15947.8888   13  388 13757.1710 23202.4473  68.7%  3360 1528s
  4011  2509 19689.4222   13  436 13757.1710 23202.4473  68.7%  3359 1532s
  4012  2509 20076.1304   28  383 13757.1710 23202.4473  68.7%  3358 1535s
  4013  2510 18026.3901   24  432 13757.1710 23202.4473  68.7%  3358 1549s
  4014  2511 18604.6456   20  390 13757.1710 23202.4473  68.7%  3357 1551s
  4015  2511 20009.1294   14  395 13757.1710 23202.4473  68.7%  3356 1556s
  4017  2513 21359.3882   21  375 13757.1710 23202.4473  68.7%  3354 1563s
  4018  2513 14892.1570   45  387 13757.1710 23202.4473  68.7%  3353 1565s
  4020  2515 22087.6009   10  322 13757.1710 23202.4473  68.7%  3352 1571s
  4021  2515 21384.1995   16  388 13757.1710 23202.4473  68.7%  3351 1575s
  4022  2516 21187.9995   24  388 13757.1710 23202.4473  68.7%  3350 1588s
  4023  2517 15595.9116   14  388 13757.1710 23202.4473  68.7%  3349 1606s
  4024  2520 23202.4473   14  369 13757.1710 23202.4473  68.7%  3413 1647s
  4026  2524 23202.4473   15  375 13757.1710 23202.4473  68.7%  3418 1682s
  4030  2530 23202.4473   16  375 13757.1710 23202.4473  68.7%  3425 1709s
  4038  2544 23202.4473   17  433 13757.1710 23202.4473  68.7%  3443 1731s
  4054  2554 21537.4464   18  358 13757.1710 23202.4473  68.7%  3502 1774s
  4070  2581 20134.9575   19  244 13757.1710 23202.4473  68.7%  3555 1802s
  4102  2660 19417.4340   20  236 13757.1710 23202.4473  68.7%  3598 1828s
  4209  2676 18139.9446   23  341 13757.1710 23202.4473  68.7%  3714 1845s
  4282  2664 17204.8802   23  258 13757.1710 23202.4473  68.7%  3757 1862s
  4359  2654 17151.9089   24  318 13757.1710 23202.4473  68.7%  3752 1876s
  4390  2659 15618.3905   24  283 13757.1710 23202.4473  68.7%  3765 1897s
  4437  2651 14018.1115   24  302 13757.1710 23202.4473  68.7%  3773 1917s
  4476  2654 13841.7444   24  202 13757.1710 23202.4473  68.7%  3774 1930s
  4518  2665 16942.4171   25  314 13757.1710 23202.4473  68.7%  3780 1944s
  4582  2673 15437.3166   26  346 13757.1710 23202.4473  68.7%  3770 1967s
  4638  2672 15305.7786   27  228 13757.1710 23202.4473  68.7%  3776 1990s
  4688  2686 15121.8687   28  239 13757.1710 23202.4473  68.7%  3780 2008s
  4756  2681 14986.7573   29  243 13757.1710 23202.4473  68.7%  3780 2032s
  4821  2683 14549.8941   30  187 13757.1710 23202.4473  68.7%  3785 2051s
  4888  2680 17808.7981   28  298 13757.1710 23202.4473  68.7%  3790 2070s
  4961  2678 15389.4134   31  145 13757.1710 23202.4473  68.7%  3784 2089s
  5044  2679 16385.3503   32  152 13757.1710 23202.4473  68.7%  3782 2105s
  5114  2685 14962.4788   36  191 13757.1710 23202.4473  68.7%  3792 2123s
  5196  2701 19026.4843   26  171 13757.1710 23202.4473  68.7%  3797 2140s
  5260  2721 16032.0282   29   98 13757.1710 23202.4473  68.7%  3806 2155s
  5345  2727     cutoff   34      13757.1710 23202.4473  68.7%  3808 2174s
  5426  2725 18658.0321   26  198 13757.1710 22711.9817  65.1%  3819 2191s
  5507  2736     cutoff   27      13757.1710 22666.8496  64.8%  3826 2210s
  5616  2741 21516.1381   19  335 13757.1710 22666.8496  64.8%  3829 2231s
  5704  2751 21140.1443   20  315 13757.1710 22064.5096  60.4%  3841 2258s
  5806  2774 19215.2979   21  227 13757.1710 21908.8756  59.3%  3845 2280s
  5887  2771 13911.5852   23  149 13757.1710 21908.8756  59.3%  3876 2304s
  5989  2764 14887.0834   25  220 13757.1710 21809.9763  58.5%  3888 2330s
  6089  2769     cutoff   26      13757.1710 21729.6341  58.0%  3916 2356s
  6200  2748 20688.6521   26  246 13757.1710 21602.1184  57.0%  3939 2379s
  6247  2765 19240.9476   27  246 13757.1710 21602.1184  57.0%  3953 2399s
  6304  2761 18145.8632   28  341 13757.1710 21602.1184  57.0%  3975 2430s
  6398  2755 18115.3503   29  319 13757.1710 21602.1184  57.0%  3983 2455s
  6503  2750 17037.8876   30  257 13757.1710 21515.7067  56.4%  3978 2479s
  6633  2770 16669.8545   31  248 13757.1710 21515.7067  56.4%  3969 2518s
  6788  2769 16600.4354   32  245 13757.1710 21515.7067  56.4%  3964 2547s
  6947  2748 14060.4409   34  212 13757.1710 21048.4691  53.0%  3964 2577s
  7141  2708 16742.6073   27  260 13757.1710 21048.4691  53.0%  3962 2609s
  7354  2678 15663.6695   30  342 13757.1710 21006.8088  52.7%  3960 2642s
  7521  2690 14941.2307   33  273 13757.1710 21006.8088  52.7%  3955 2679s
  7763  2644 17738.1767   22  272 13757.1710 21006.8088  52.7%  3951 2715s
  7984  2602 14009.9229   27  217 13757.1710 20510.6297  49.1%  3961 2752s
  8179  2577     cutoff   28      13757.1710 20420.7667  48.4%  3990 2792s
  8395  2528 14262.8799   36  268 13757.1710 20192.5484  46.8%  4013 2831s
  8661  2445 17141.3668   25  186 13757.1710 20192.5484  46.8%  4023 2867s
  8855  2401 18392.0393   22  272 13757.1710 19896.1584  44.6%  4031 2905s
  9009  2381 16820.2807   24  277 13757.1710 19679.7797  43.1%  4037 2947s
  9192  2332 14468.2312   27  261 13757.1710 19591.3145  42.4%  4058 2993s
  9488  2265     cutoff   23      13757.1710 19531.8828  42.0%  4068 3044s
  9775  2191 16174.6445   28  154 13757.1710 19281.0956  40.2%  4097 3093s
 10089  2074 16672.8857   27  267 13757.1710 19187.2497  39.5%  4117 3150s
 10445  1934     cutoff   30      13757.1710 19048.7330  38.5%  4124 3203s
 10800  1795     cutoff   24      13757.1710 18769.3686  36.4%  4139 3252s
 11033  1701     cutoff   28      13757.1710 18590.0863  35.1%  4140 3308s
 11480  1492 15170.2984   26  310 13757.1710 18404.7718  33.8%  4135 3366s
 11932  1354 15069.2330   24  269 13757.1710 18133.8515  31.8%  4134 3428s
 12390  1197     cutoff   26      13757.1710 17818.3069  29.5%  4130 3490s
 12937  1020     cutoff   26      13757.1710 17426.0310  26.7%  4110 3553s
 13524   702     cutoff   30      13757.1710 17050.0731  23.9%  4087 3600s

Cutting planes:
  Gomory: 6
  Implied bound: 51
  Projected implied bound: 324
  MIR: 1216
  Mixing: 3
  Flow cover: 2626
  RLT: 33
  Relax-and-lift: 270

Explored 14197 nodes (57445176 simplex iterations) in 3600.05 seconds (10528.92 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13757.2 13739.8 13687.3 ... 13148.6

Time limit reached
Best objective 1.375717100228e+04, best bound 1.650735036869e+04, gap 19.9909%
  WARNING: Time limit reached. Using best solution found (gap: 19.99%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 13757.17, θ = 157355.57
  Upper Bound (UB) = 13757.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157355.57
  [DEBUG]   ✓ Scenario 0: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157355.57 ≤ Q = 157355.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157355.57 ≤ Q = 157355.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157355.57 ≤ Q = 157355.57 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x70f6bb3e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8f0944c2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.355225e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6720605.7837
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.483508e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148350.78    0  124 6720605.78 -148350.78   102%     -    0s
H    0     0                    -113864.5006 -148350.78  30.3%     -    0s
H    0     0                    -114165.8586 -148350.78  29.9%     -    0s
H    0     0                    -114793.7764 -148350.78  29.2%     -    0s
     0     0 -120349.01    0   30 -114793.78 -120349.01  4.84%     -    0s
H    0     0                    -118662.0961 -120246.78  1.34%     -    0s
H    0     0                    -118960.3140 -120246.78  1.08%     -    0s
H    0     0                    -119250.8346 -120246.78  0.84%     -    0s
     0     0 -120136.50    0   30 -119250.83 -120136.50  0.74%     -    0s
     0     0 -119730.72    0   13 -119250.83 -119730.72  0.40%     -    0s
     0     0 -119690.49    0   15 -119250.83 -119690.49  0.37%     -    0s
     0     0 -119588.07    0   11 -119250.83 -119588.07  0.28%     -    0s
     0     0 -119579.07    0   12 -119250.83 -119579.07  0.28%     -    0s
     0     0 -119564.11    0   14 -119250.83 -119564.11  0.26%     -    0s
     0     0 -119561.20    0   14 -119250.83 -119561.20  0.26%     -    0s
H    0     0                    -119342.6643 -119561.20  0.18%     -    0s
H    0     0                    -119361.5356 -119561.20  0.17%     -    0s
     0     0 -119561.20    0   38 -119361.54 -119561.20  0.17%     -    0s
     0     0 -119561.20    0   17 -119361.54 -119561.20  0.17%     -    0s
     0     0 -119561.20    0   16 -119361.54 -119561.20  0.17%     -    0s
     0     0 -119512.61    0   16 -119361.54 -119512.61  0.13%     -    0s
     0     0 -119496.03    0   15 -119361.54 -119496.03  0.11%     -    0s
     0     0 -119491.65    0   14 -119361.54 -119491.65  0.11%     -    0s
     0     0 -119474.69    0    9 -119361.54 -119474.69  0.09%     -    0s
     0     0 -119474.69    0   14 -119361.54 -119474.69  0.09%     -    0s
     0     0 -119455.35    0    7 -119361.54 -119455.35  0.08%     -    0s
H    0     0                    -119406.0196 -119438.44  0.03%     -    0s
     0     0          -    0      -119406.02 -119414.53  0.01%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 6
  MIR: 3
  Flow cover: 9

Explored 1 nodes (748 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119406 -119362 -119343 ... 1.35523e+13

Optimal solution found (tolerance 1.00e-04)
Best objective -1.194060195676e+05, best bound -1.194145311074e+05, gap 0.0071%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 155097.45
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119406.02
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -119406.02 = 155097.45
  [DEBUG]   Current θ from Master = 157355.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2258.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11499.05
  Lower Bound (LB) = 13499.44
  Gap (UB-LB) = 257.7351, Absolute Gap = 257.7351, Relative Gap = 0.018735
  Not converged yet (gap = 257.74 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 0.0001
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0xf9e87b3e
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 92150 rows and 37430 columns
Presolve time: 1.70s
Presolved: 108003 rows, 45950 columns, 653369 nonzeros
Variable types: 43691 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340645.0618
Found heuristic solution: objective -164758.1378

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 3.950e+06
 Factor NZ  : 9.389e+06 (roughly 140 MB of memory)
 Factor Ops : 1.856e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59751646e+07  1.87524303e+08  9.85e+04 2.48e+01  6.99e+04     3s
   1  -1.22627486e+07  1.69116636e+08  6.90e+04 5.60e+01  4.85e+04     3s
   2  -5.06270475e+06  1.25270620e+08  2.79e+04 1.99e+00  2.09e+04     3s
   3  -9.36857105e+05  9.54806117e+07  2.09e+03 1.63e+00  1.97e+03     3s
   4  -5.56159809e+05  3.96967355e+07  5.26e+02 2.72e-01  5.30e+02     3s
   5  -3.97865804e+05  2.70909992e+07  1.55e+02 1.62e-01  2.28e+02     3s
   6  -3.49895737e+05  1.90344049e+07  7.63e+01 1.04e-01  1.37e+02     3s
   7  -2.58867952e+05  1.63931532e+07  3.09e+01 8.70e-02  9.90e+01     3s
   8  -1.68074626e+05  9.61783690e+06  8.92e+00 4.74e-02  5.24e+01     3s
   9  -1.10392127e+05  5.67371914e+06  4.24e+00 2.70e-02  3.02e+01     3s
  10  -7.51922476e+04  3.15664024e+06  2.17e+00 1.44e-02  1.66e+01     3s
  11  -3.84652948e+04  1.23457872e+06  9.41e-01 5.52e-03  6.49e+00     3s
  12  -1.71326645e+04  4.40556553e+05  5.47e-01 2.01e-03  2.33e+00     3s
  13  -6.97121469e+03  2.57452403e+05  3.53e-01 1.40e-03  1.34e+00     3s
  14   1.07790543e+03  1.72788418e+05  2.52e-01 1.18e-03  8.71e-01     3s
  15   7.46176177e+03  1.31203713e+05  1.92e-01 1.05e-03  6.27e-01     3s
  16   1.58831317e+04  9.75137505e+04  1.35e-01 2.16e-03  4.14e-01     4s
  17   1.99821747e+04  9.00502343e+04  1.11e-01 1.93e-03  3.55e-01     4s
  18   2.11228208e+04  8.14395464e+04  1.05e-01 1.30e-03  3.06e-01     4s
  19   2.58521446e+04  7.37825533e+04  7.69e-02 9.67e-04  2.43e-01     4s
  20   2.73094363e+04  6.84009816e+04  6.90e-02 1.12e-03  2.08e-01     4s
  21   2.95724044e+04  6.35167463e+04  5.83e-02 8.25e-04  1.72e-01     4s
  22   3.12416055e+04  5.70584173e+04  5.02e-02 1.21e-03  1.31e-01     4s
  23   3.38462057e+04  5.53123798e+04  3.87e-02 1.07e-03  1.09e-01     4s
  24   3.46693002e+04  5.36756598e+04  3.52e-02 8.78e-04  9.63e-02     4s
  25   3.50104173e+04  5.20040621e+04  3.39e-02 7.39e-04  8.61e-02     4s
  26   3.60245609e+04  5.10379149e+04  2.99e-02 6.83e-04  7.61e-02     4s
  27   3.67586605e+04  4.99781545e+04  2.68e-02 5.85e-04  6.70e-02     4s
  28   3.77824707e+04  4.85921672e+04  2.27e-02 4.53e-04  5.48e-02     4s
  29   3.91450225e+04  4.83160551e+04  1.72e-02 4.20e-04  4.65e-02     4s
  30   3.95675750e+04  4.69734510e+04  1.55e-02 2.92e-04  3.75e-02     4s
  31   3.97979660e+04  4.66210970e+04  1.46e-02 2.61e-04  3.46e-02     4s
  32   4.01804220e+04  4.62798587e+04  1.32e-02 2.29e-04  3.09e-02     4s
  33   4.08908281e+04  4.59773667e+04  1.05e-02 2.01e-04  2.58e-02     4s
  34   4.15668892e+04  4.53756307e+04  7.97e-03 1.50e-04  1.93e-02     4s
  35   4.18980807e+04  4.50826644e+04  6.70e-03 1.21e-04  1.61e-02     4s
  36   4.23702614e+04  4.47064611e+04  5.01e-03 1.43e-04  1.18e-02     4s
  37   4.26840048e+04  4.43020856e+04  3.91e-03 1.26e-04  8.20e-03     5s
  38   4.28383818e+04  4.42631849e+04  3.37e-03 1.16e-04  7.22e-03     5s
  39   4.29106335e+04  4.41674368e+04  3.13e-03 8.93e-05  6.37e-03     5s
  40   4.32263934e+04  4.41227444e+04  2.03e-03 7.68e-05  4.54e-03     5s
  41   4.33802554e+04  4.40510075e+04  1.51e-03 5.56e-05  3.40e-03     5s
  42   4.34109690e+04  4.40073070e+04  1.41e-03 4.40e-05  3.02e-03     5s
  43   4.35582448e+04  4.39513022e+04  9.30e-04 2.65e-05  1.99e-03     5s
  44   4.36403451e+04  4.38846410e+04  6.63e-04 5.37e-05  1.24e-03     5s
  45   4.38077375e+04  4.38661614e+04  1.42e-04 1.84e-05  2.96e-04     5s
  46   4.38478606e+04  4.38555304e+04  1.90e-05 1.24e-05  3.89e-05     5s
  47   4.38541351e+04  4.38545496e+04  1.38e-07 3.15e-06  2.10e-06     5s
  48   4.38541419e+04  4.38544679e+04  1.24e-07 2.39e-06  1.65e-06     5s
  49   4.38541826e+04  4.38542082e+04  4.94e-08 1.10e-08  1.29e-07     5s
  50   4.38542025e+04  4.38542036e+04  2.34e-09 1.00e-10  5.56e-09     5s
  51   4.38542035e+04  4.38542035e+04  8.94e-09 6.28e-09  2.43e-11     5s

Barrier solved model in 51 iterations and 5.25 seconds (9.51 work units)
Optimal objective 4.38542035e+04


Root crossover log...

   93929 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1812 PPushes remaining with PInf 6.2152874e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1968463e-01      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33879    4.3854203e+04   0.000000e+00   1.196846e-01      7s
   33883    4.3854203e+04   0.000000e+00   0.000000e+00      7s
   33883    4.3854203e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 4.385420e+04, 33883 iterations, 4.77 seconds (10.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43854.2035    0  206 -164758.14 43854.2035   127%     -    7s
H    0     0                    -159218.7759 43854.2035   128%     -    7s
H    0     0                    -122552.0213 43854.2035   136%     -    7s
H    0     0                    -119869.3623 43854.2035   137%     -    7s
H    0     0                    -48469.76202 43854.2035   190%     -    7s
H    0     0                    -23233.73355 43854.2035   289%     -    8s
H    0     0                    1895.9735108 43854.2035  2213%     -    8s
H    0     0                    5720.1605614 38541.8557   574%     -   33s
H    0     0                    5802.0719213 38541.8557   564%     -   33s
H    0     0                    6257.4425016 38541.8557   516%     -   33s
     0     0 38474.9209    0  453 6257.44250 38474.9209   515%     -   33s
     0     0 37917.7925    0  444 6257.44250 37917.7925   506%     -   41s
     0     0 37792.7283    0  436 6257.44250 37792.7283   504%     -   49s
     0     0 37792.7283    0  439 6257.44250 37792.7283   504%     -   52s
     0     0 37792.7283    0  437 6257.44250 37792.7283   504%     -   55s
     0     0 37792.7283    0  449 6257.44250 37792.7283   504%     -   58s
     0     0 37792.7283    0  451 6257.44250 37792.7283   504%     -   59s
     0     0 37792.7283    0  445 6257.44250 37792.7283   504%     -   63s
     0     0 37776.1558    0  437 6257.44250 37776.1558   504%     -   66s
     0     0 37770.9117    0  440 6257.44250 37770.9117   504%     -   67s
     0     0 37768.7229    0  442 6257.44250 37768.7229   504%     -   68s
     0     0 37768.6818    0  442 6257.44250 37768.6818   504%     -   68s
H    0     0                    7649.8618710 34399.6531   350%     -  102s
H    0     0                    8062.0878203 34399.6531   327%     -  102s
     0     0 34399.6531    0  341 8062.08782 34399.6531   327%     -  102s
H    0     0                    10623.242256 34399.6334   224%     -  102s
H    0     0                    10905.902329 34399.6334   215%     -  102s
     0     0 33218.6757    0  391 10905.9023 33218.6757   205%     -  145s
     0     0 32935.2930    0  401 10905.9023 32935.2930   202%     -  171s
     0     0 32541.9376    0  414 10905.9023 32541.9376   198%     -  190s
     0     0 32475.2530    0  415 10905.9023 32475.2530   198%     -  201s
     0     0 32429.0501    0  417 10905.9023 32429.0501   197%     -  210s
     0     0 32423.7323    0  426 10905.9023 32423.7323   197%     -  213s
     0     0 32418.6327    0  424 10905.9023 32418.6327   197%     -  216s
     0     0 32399.3050    0  411 10905.9023 32399.3050   197%     -  223s
     0     0 32398.5377    0  411 10905.9023 32398.5377   197%     -  224s
H    0     0                    11055.970119 29742.7222   169%     -  291s
H    0     0                    11073.325295 29742.7222   169%     -  291s
     0     0 29742.7222    0  426 11073.3253 29742.7222   169%     -  291s
H    0     0                    11855.664474 29742.7079   151%     -  291s
     0     0 29057.8558    0  423 11855.6645 29057.8558   145%     -  321s
H    0     0                    12479.221358 28869.9643   131%     -  335s
H    0     0                    12592.292944 28869.9643   129%     -  335s
     0     0 28869.9643    0  461 12592.2929 28869.9643   129%     -  335s
     0     0 28812.7814    0  486 12592.2929 28812.7814   129%     -  346s
     0     0 28797.7981    0  469 12592.2929 28797.7981   129%     -  354s
     0     0 28740.2557    0  491 12592.2929 28740.2557   128%     -  362s
     0     0 28684.4990    0  500 12592.2929 28684.4990   128%     -  371s
     0     0 28632.7495    0  518 12592.2929 28632.7495   127%     -  381s
     0     0 28552.1443    0  504 12592.2929 28552.1443   127%     -  394s
H    0     0                    12621.405630 28519.5707   126%     -  400s
     0     0 28519.5707    0  517 12621.4056 28519.5707   126%     -  400s
     0     0 28513.5680    0  524 12621.4056 28513.5680   126%     -  404s
     0     0 28487.2892    0  517 12621.4056 28487.2892   126%     -  407s
     0     0 28485.6199    0  521 12621.4056 28485.6199   126%     -  409s
     0     0 27119.0929    0  434 12621.4056 27119.0929   115%     -  454s
     0     0 26802.5808    0  431 12621.4056 26802.5808   112%     -  468s
     0     0 26703.2562    0  418 12621.4056 26703.2562   112%     -  475s
     0     0 26676.2893    0  420 12621.4056 26676.2893   111%     -  480s
     0     0 26634.9320    0  420 12621.4056 26634.9320   111%     -  485s
     0     0 26547.2038    0  359 12621.4056 26547.2038   110%     -  494s
     0     0 26528.0856    0  365 12621.4056 26528.0856   110%     -  498s
     0     0 26520.8453    0  419 12621.4056 26520.8453   110%     -  502s
     0     0 26512.3544    0  432 12621.4056 26512.3544   110%     -  504s
     0     0 26510.5104    0  424 12621.4056 26510.5104   110%     -  506s
     0     0 26206.4028    0  482 12621.4056 26206.4028   108%     -  521s
H    0     0                    12720.244980 26205.8895   106%     -  521s
H    0     0                    13066.074484 26205.8895   101%     -  521s
     0     0 26139.3511    0  410 13066.0745 26139.3511   100%     -  528s
     0     0 26096.5155    0  406 13066.0745 26096.5155   100%     -  534s
     0     0 26056.0790    0  415 13066.0745 26056.0790  99.4%     -  539s
     0     0 26043.2921    0  415 13066.0745 26043.2921  99.3%     -  542s
     0     0 26040.0061    0  421 13066.0745 26040.0061  99.3%     -  544s
     0     0 26036.6219    0  422 13066.0745 26036.6219  99.3%     -  546s
     0     0 26025.5964    0  415 13066.0745 26025.5964  99.2%     -  548s
     0     0 25979.2110    0  504 13066.0745 25979.2110  98.8%     -  555s
     0     0 25977.1664    0  502 13066.0745 25977.1664  98.8%     -  556s
     0     0 25857.4443    0  413 13066.0745 25857.4443  97.9%     -  566s
H    0     0                    13215.928593 25857.4141  95.7%     -  570s
H    0     0                    13231.889208 25857.4141  95.4%     -  571s
H    0     0                    13355.963250 25857.4141  93.6%     -  571s
     0     0 25835.3430    0  410 13355.9632 25835.3430  93.4%     -  576s
     0     0 25826.7875    0  408 13355.9632 25826.7875  93.4%     -  579s
     0     0 25821.2741    0  426 13355.9632 25821.2741  93.3%     -  581s
     0     0 25820.0822    0  414 13355.9632 25820.0822  93.3%     -  582s
     0     0 25754.1662    0  407 13355.9632 25754.1662  92.8%     -  591s
H    0     0                    13366.529310 25754.1015  92.7%     -  591s
     0     0 25742.1452    0  414 13366.5293 25742.1452  92.6%     -  594s
     0     0 25723.6405    0  435 13366.5293 25723.6405  92.4%     -  598s
     0     0 25719.6661    0  421 13366.5293 25719.6661  92.4%     -  600s
     0     0 25718.4150    0  417 13366.5293 25718.4150  92.4%     -  602s
     0     0 25703.0511    0  433 13366.5293 25703.0511  92.3%     -  607s
H    0     0                    13368.881052 25703.0297  92.3%     -  609s
     0     0 25688.1527    0  435 13368.8811 25688.1527  92.1%     -  613s
     0     0 25686.6253    0  437 13368.8811 25686.6253  92.1%     -  615s
     0     0 25676.8775    0  415 13368.8811 25676.8775  92.1%     -  618s
     0     0 25653.9769    0  409 13368.8811 25653.9769  91.9%     -  623s
     0     0 25650.2814    0  418 13368.8811 25650.2814  91.9%     -  623s
     0     0 25647.1477    0  409 13368.8811 25647.1477  91.8%     -  625s
     0     0 25646.9252    0  417 13368.8811 25646.9252  91.8%     -  625s
     0     0 25591.4328    0  410 13368.8811 25591.4328  91.4%     -  632s
     0     0 25569.8297    0  410 13368.8811 25569.8297  91.3%     -  645s
     0     0 25568.2629    0  420 13368.8811 25568.2629  91.3%     -  646s
     0     0 25556.7575    0  416 13368.8811 25556.7575  91.2%     -  650s
     0     0 25544.8532    0  420 13368.8811 25544.8532  91.1%     -  654s
     0     0 25541.8653    0  422 13368.8811 25541.8653  91.1%     -  655s
     0     0 25541.3690    0  424 13368.8811 25541.3690  91.1%     -  656s
     0     0 25526.5978    0  434 13368.8811 25526.5978  90.9%     -  660s
     0     0 25513.7075    0  428 13368.8811 25513.7075  90.8%     -  666s
     0     0 25512.0892    0  477 13368.8811 25512.0892  90.8%     -  668s
     0     0 25486.6507    0  373 13368.8811 25486.6507  90.6%     -  688s
     0     0 25479.8108    0  424 13368.8811 25479.8108  90.6%     -  691s
     0     0 25476.6020    0  423 13368.8811 25476.6020  90.6%     -  694s
     0     0 25475.8743    0  429 13368.8811 25475.8743  90.6%     -  695s
     0     0 25469.9864    0  434 13368.8811 25469.9864  90.5%     -  699s
     0     0 25466.5349    0  364 13368.8811 25466.5349  90.5%     -  702s
     0     0 25464.3322    0  379 13368.8811 25464.3322  90.5%     -  704s
     0     0 25444.5070    0  466 13368.8811 25444.5070  90.3%     -  710s
     0     0 25444.4228    0  466 13368.8811 25444.4228  90.3%     -  713s
H    0     0                    13426.581873 25443.6138  89.5%     -  765s
H    0     0                    13455.694559 25443.6138  89.1%     -  773s
     0     2 25443.6138    0  466 13455.6946 25443.6138  89.1%     -  774s
     1     3 24884.5333    1  483 13455.6946 25443.6138  89.1% 13959  787s
     2     5 24444.3470    2  475 13455.6946 25443.6138  89.1% 10751  795s
     4     9 24412.2275    3  482 13455.6946 25261.2208  87.7%  8535  807s
     8    17 24185.0607    4  456 13455.6946 25261.2208  87.7%  8549  821s
    16    34 24991.3535    4  409 13455.6946 25134.5021  86.8% 10173  833s
    33    49 24526.3497    5  340 13455.6946 24991.2602  85.7% 11231  860s
    48    77 23235.4253    6  273 13455.6946 24991.2602  85.7% 12679  917s
    76   109 22434.6839    7  325 13455.6946 24991.2602  85.7% 11240  935s
   108   141 22236.1207    8  250 13455.6946 24991.2602  85.7% 10200  951s
   140   172 22118.7687    9  368 13455.6946 24991.2602  85.7%  9353  971s
H  145   172                    13631.430439 24991.2602  83.3%  9197  971s
   171   272 21740.3883   10  248 13631.4304 24991.2602  83.3%  8842  995s
   276   322 21248.5934   13  240 13631.4304 24991.2602  83.3%  7437 1012s
H  279   322                    13658.773406 24991.2602  83.0%  7377 1012s
H  308   322                    13739.815826 24991.2602  81.9%  7006 1012s
   350   370 20114.5705   15  222 13739.8158 24991.2602  81.9%  6888 1029s
   408   443 19842.3604   16  292 13739.8158 24991.2602  81.9%  6624 1049s
   491   488 19942.8957   16  222 13739.8158 24991.2602  81.9%  6601 1065s
   557   549 19558.4561   17  193 13739.8158 24991.2602  81.9%  6590 1079s
   624   615 19504.8385   18  207 13739.8158 24991.2602  81.9%  6767 1095s
   714   674 19676.5106   17  222 13739.8158 24991.2602  81.9%  6738 1107s
   791   717 18703.6572   19  209 13739.8158 24991.2602  81.9%  6684 1118s
   854   745 19414.3525   18  362 13739.8158 24991.2602  81.9%  6750 1131s
   894   794     cutoff   18      13739.8158 24991.2602  81.9%  6791 1144s
   963   817 18909.6668   20  263 13739.8158 24991.2602  81.9%  6747 1156s
   998   846 18874.5793   21  199 13739.8158 24991.2602  81.9%  6807 1166s
  1035   880 18094.6899   23  294 13739.8158 24991.2602  81.9%  6864 1176s
  1077   922 18753.5220   21  261 13739.8158 24991.2602  81.9%  6885 1193s
  1133   969 18561.4746   22  254 13739.8158 24991.2602  81.9%  6859 1206s
  1213   993     cutoff   23      13739.8158 24991.2602  81.9%  6752 1224s
  1305  1038 14811.5640   22  191 13739.8158 24991.2602  81.9%  6679 1240s
  1394  1083 14218.3269   23  163 13739.8158 24991.2602  81.9%  6708 1257s
  1483  1141     cutoff   25      13739.8158 24991.2602  81.9%  6785 1274s
  1580  1218 18762.1744   35  274 13739.8158 24991.2602  81.9%  6764 1291s
  1692  1273 18582.4178   38  256 13739.8158 24991.2602  81.9%  6778 1311s
  1813  1348 18435.8225   43  246 13739.8158 24924.1106  81.4%  6730 1331s
  1944  1424 17914.5440   50  241 13739.8158 24924.1106  81.4%  6666 1353s
  2089  1477 17373.7019   57  209 13739.8158 24924.1106  81.4%  6600 1375s
  2186  1558 15283.6969   69  174 13739.8158 24924.1106  81.4%  6600 1394s
  2323  1644 infeasible   82      13739.8158 24924.1106  81.4%  6558 1416s
  2488  1738 23195.8628   14  362 13739.8158 24924.1106  81.4%  6496 1441s
  2658  1866 22454.4384   15  288 13739.8158 24924.1106  81.4%  6399 1463s
  2902  1974 21757.8333   16  308 13739.8158 24924.1106  81.4%  6186 1488s
  3116  2059 20345.9179   17  231 13739.8158 24924.1106  81.4%  6108 1515s
  3301  2147 18935.7302   19  348 13739.8158 24597.2600  79.0%  6071 1539s
  3473  2252 18481.2473   22  342 13739.8158 24597.2600  79.0%  6087 1564s
  3650  2331 18153.8037   26  352 13739.8158 24597.2600  79.0%  6112 1594s
  3797  2440 17501.7494   30  232 13739.8158 24527.6777  78.5%  6179 1628s
  3981  2525 17006.9057   34  281 13739.8158 24527.6777  78.5%  6195 1662s
  4161  2617 14940.2231   37  233 13739.8158 24527.6777  78.5%  6212 1691s
  4312  2618 14028.1836   49  466 13739.8158 24147.4159  75.7%  6280 1888s
  4314  2619 19859.1276   14  234 13739.8158 24147.4159  75.7%  6277 1901s
  4315  2620 18868.7055   21  363 13739.8158 24147.4159  75.7%  6276 1952s
  4316  2621 18290.2014   22  364 13739.8158 24147.4159  75.7%  6274 2006s
  4317  2621 18883.6283   15  393 13739.8158 24147.4159  75.7%  6273 2031s
  4318  2622 17718.0705   52  412 13739.8158 24147.4159  75.7%  6271 2056s
  4319  2623 13926.0717   62  393 13739.8158 24147.4159  75.7%  6270 2072s
  4320  2623 15380.3634   42  412 13739.8158 24147.4159  75.7%  6268 2084s
  4321  2624 14386.3623   76  414 13739.8158 24147.4159  75.7%  6267 2093s
  4322  2625 16164.9689   44  419 13739.8158 24147.4159  75.7%  6266 2099s
  4323  2625 17613.3719   16  412 13739.8158 24147.4159  75.7%  6264 2105s
  4324  2626 16011.3967   16  415 13739.8158 24147.4159  75.7%  6263 2110s
  4325  2627 19947.7472   13  395 13739.8158 24147.4159  75.7%  6261 2118s
  4326  2627 18869.0997   19  404 13739.8158 24147.4159  75.7%  6260 2124s
  4327  2628 22384.1888   14  338 13739.8158 24147.4159  75.7%  6258 2130s
  4328  2629 17426.7306   50  394 13739.8158 24147.4159  75.7%  6257 2135s
  4330  2630 18207.9935   40  443 13739.8158 24147.4159  75.7%  6254 2153s
  4331  2631 13970.1571   54  428 13739.8158 24147.4159  75.7%  6253 2157s
  4332  2631 20148.3361   14  435 13739.8158 24147.4159  75.7%  6251 2165s
  4334  2633 19682.9183   19  435 13739.8158 24147.4159  75.7%  6248 2170s
  4337  2635 16504.0274   42  399 13739.8158 24147.4159  75.7%  6244 2176s
  4339  2636 20087.2907   11  392 13739.8158 24147.4159  75.7%  6241 2187s
  4340  2637 16800.5513   42  422 13739.8158 24147.4159  75.7%  6240 2190s
  4342  2638 15399.4904   37  410 13739.8158 24147.4159  75.7%  6237 2195s
  4343  2639 22771.8516   15  377 13739.8158 24147.4159  75.7%  6235 2202s
  4344  2639 20497.4039   16  369 13739.8158 24147.4159  75.7%  6234 2206s
  4345  2640 17467.2430   48  361 13739.8158 24147.4159  75.7%  6232 2212s
  4346  2641 16032.2596   32  360 13739.8158 24147.4159  75.7%  6231 2215s
  4347  2641 15049.8505   34  387 13739.8158 24147.4159  75.7%  6230 2223s
  4348  2642 21573.1732   16  372 13739.8158 24147.4159  75.7%  6228 2225s
  4349  2643 18342.4969   25  387 13739.8158 24147.4159  75.7%  6227 2230s
  4351  2644 15378.8421   21  382 13739.8158 24147.4159  75.7%  6224 2239s
  4352  2645 17016.5906   23  377 13739.8158 24147.4159  75.7%  6222 2242s
  4353  2645 21787.3925   21  377 13739.8158 24147.4159  75.7%  6221 2247s
  4354  2646 15267.1476   61  386 13739.8158 24147.4159  75.7%  6220 2250s
  4356  2647 22228.2647    8  384 13739.8158 24147.4159  75.7%  6217 2273s
  4357  2648 14245.7652   29  384 13739.8158 24147.4159  75.7%  6215 2323s
  4358  2652 24147.4159   14  386 13739.8158 24147.4159  75.7%  6296 2354s
  4360  2655 24147.4159   15  396 13739.8158 24147.4159  75.7%  6295 2371s
  4364  2662 24147.4159   16  394 13739.8158 24147.4159  75.7%  6300 2404s
  4372  2675 24147.4159   17  437 13739.8158 24147.4159  75.7%  6304 2423s
  4388  2686 23052.1010   18  269 13739.8158 24147.4159  75.7%  6362 2467s
  4404  2711 23259.6134   19  399 13739.8158 24147.4159  75.7%  6389 2493s
  4436  2781 23111.5834   20  391 13739.8158 24147.4159  75.7%  6405 2520s
  4519  2793 22697.1286   22  377 13739.8158 24147.4159  75.7%  6486 2539s
  4565  2816 21957.5110   22  351 13739.8158 24147.4159  75.7%  6490 2558s
  4613  2831 22219.2612   25  342 13739.8158 24147.4159  75.7%  6486 2577s
  4660  2860 21156.8336   23  332 13739.8158 24147.4159  75.7%  6485 2597s
  4729  2866 21682.8984   23  284 13739.8158 24147.4159  75.7%  6454 2614s
  4789  2859 21218.5123   34  237 13739.8158 24147.4159  75.7%  6427 2631s
  4846  2863 21193.4199   24  253 13739.8158 24147.4159  75.7%  6413 2657s
  4907  2878 21033.5613   25  249 13739.8158 24147.4159  75.7%  6382 2683s
  4983  2868 17427.9183   26  336 13739.8158 24147.4159  75.7%  6336 2702s
  5044  2864 17399.0592   27  352 13739.8158 24147.4159  75.7%  6300 2730s
  5109  2860 17161.0102   29  340 13739.8158 24147.4159  75.7%  6265 2746s
  5176  2870 20349.2692   21  221 13739.8158 24147.4159  75.7%  6231 2767s
  5230  2876 infeasible   30      13739.8158 24147.4159  75.7%  6212 2789s
  5300  2887 20731.8973   26  153 13739.8158 24147.4159  75.7%  6178 2806s
  5375  2873 20207.2173   28  241 13739.8158 24147.4159  75.7%  6148 2828s
  5407  2894 20017.8591   29  254 13739.8158 24147.4159  75.7%  6136 2849s
  5466  2896 19425.1955   33  220 13739.8158 24147.4159  75.7%  6117 2867s
  5526  2904 18470.2003   36  201 13739.8158 24147.4159  75.7%  6101 2892s
  5579  2907 17723.2378   37  279 13739.8158 24147.4159  75.7%  6092 2911s
  5615  2924 17455.2607   38  246 13739.8158 24147.4159  75.7%  6097 2939s
  5658  2933 infeasible   39      13739.8158 24147.4159  75.7%  6095 2959s
  5704  2941 17006.8102   40  193 13739.8158 24147.4159  75.7%  6094 2982s
  5761  2946 15516.1110   41  251 13739.8158 23977.2581  74.5%  6090 3005s
  5830  2962 14438.5194   44  239 13739.8158 23977.2581  74.5%  6083 3029s
  5912  2970 21629.4042   23  333 13739.8158 23977.2581  74.5%  6070 3055s
  5992  2990 21249.2089   26  326 13739.8158 23977.2581  74.5%  6058 3082s
  6069  3003 20913.0309   29  299 13739.8158 23977.2581  74.5%  6063 3111s
  6146  3027 20827.8274   30  341 13739.8158 23977.2581  74.5%  6061 3140s
  6237  3032 15705.6248   32  114 13739.8158 23977.2581  74.5%  6058 3169s
  6329  3045     cutoff   32      13739.8158 22992.3659  67.3%  6045 3200s
  6415  3048 19700.0973   34  232 13739.8158 22992.3659  67.3%  6055 3230s
  6503  3048 17711.7702   37  236 13739.8158 22992.3659  67.3%  6041 3273s
  6600  3073 16473.0835   43  126 13739.8158 22992.3659  67.3%  6036 3312s
  6711  3077 13810.5099   51  217 13739.8158 22992.3659  67.3%  6036 3352s
  6842  3079 19589.3614   19  226 13739.8158 22590.9133  64.4%  6048 3393s
  6988  3063 infeasible   21      13739.8158 22590.9133  64.4%  6037 3434s
  7129  3076 19278.3987   20  236 13739.8158 22206.5857  61.6%  6036 3480s
  7266  3075 15457.3714   22  219 13739.8158 22206.5857  61.6%  6031 3521s
  7412  3072     cutoff   20      13739.8158 22206.5857  61.6%  6030 3564s
  7568  3056 15257.4901   23  205 13739.8158 22132.1718  61.1%  6024 3600s

Cutting planes:
  Learned: 1
  Gomory: 7
  Implied bound: 29
  Projected implied bound: 311
  MIR: 1094
  Mixing: 5
  Flow cover: 2208
  RLT: 35
  Relax-and-lift: 359

Explored 7685 nodes (47065343 simplex iterations) in 3600.06 seconds (9754.89 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13739.8 13658.8 13631.4 ... 13215.9

Time limit reached
Best objective 1.373981582610e+04, best bound 2.179347285727e+04, gap 58.6155%
  WARNING: Time limit reached. Using best solution found (gap: 58.62%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 13739.82, θ = 157458.94
  Upper Bound (UB) = 13739.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157458.94
  [DEBUG]   ✓ Scenario 0: θ = 157458.94 ≤ Q = 157458.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157458.94 ≤ Q = 157458.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157458.94 ≤ Q = 157458.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157458.94 ≤ Q = 157458.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157458.94 ≤ Q = 157458.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157458.94 ≤ Q = 157458.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157458.94 ≤ Q = 157458.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157458.94 ≤ Q = 157458.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157458.94 ≤ Q = 157458.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157458.94 ≤ Q = 157458.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157458.94 ≤ Q = 157458.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157458.94 ≤ Q = 157458.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 157458.94 ≤ Q = 157458.94 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7a50a32f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7a50a32f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 1e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.355748e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6726155.2058
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.482281e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148228.13    0  124 6726155.21 -148228.13   102%     -    0s
H    0     0                    -113761.1256 -148228.13  30.3%     -    0s
H    0     0                    -114062.4836 -148228.13  30.0%     -    0s
H    0     0                    -114690.4014 -148228.13  29.2%     -    0s
     0     0 -117398.05    0   30 -114690.40 -117398.05  2.36%     -    0s
H    0     0                    -115587.4775 -117339.94  1.52%     -    0s
H    0     0                    -115885.6954 -117339.94  1.25%     -    0s
H    0     0                    -115980.9792 -117339.94  1.17%     -    0s
H    0     0                    -116279.1970 -117339.94  0.91%     -    0s
     0     0 -117189.52    0   29 -116279.20 -117189.52  0.78%     -    0s
     0     0 -117171.26    0   28 -116279.20 -117171.26  0.77%     -    0s
H    0     0                    -116929.6861 -117171.26  0.21%     -    0s
     0     0 -117140.02    0   28 -116929.69 -117140.02  0.18%     -    0s
H    0     0                    -117044.5229 -117140.02  0.08%     -    0s
     0     0 -117140.02    0   51 -117044.52 -117140.02  0.08%     -    0s
     0     0 -117140.02    0   34 -117044.52 -117140.02  0.08%     -    0s
     0     0 -117140.02    0   27 -117044.52 -117140.02  0.08%     -    0s
     0     0 -117140.02    0   28 -117044.52 -117140.02  0.08%     -    0s
     0     0 -117140.02    0   28 -117044.52 -117140.02  0.08%     -    0s
     0     0 -117118.57    0   27 -117044.52 -117118.57  0.06%     -    0s
     0     0 -117088.57    0   25 -117044.52 -117088.57  0.04%     -    0s
     0     0 -117088.57    0   26 -117044.52 -117088.57  0.04%     -    0s
     0     0 -117088.57    0   26 -117044.52 -117088.57  0.04%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 8
  MIR: 46
  Flow cover: 4
  RLT: 13

Explored 1 nodes (672 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -117045 -116930 -116279 ... 1.35575e+13
No other solutions better than -117045

Optimal solution found (tolerance 1.00e-04)
Best objective -1.170445228746e+05, best bound -1.170445228746e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 157458.94
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117044.52
  [DEBUG]   S×d_nominal = 274503.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 274503.47 + -117044.52 = 157458.94
  [DEBUG]   Current θ from Master = 157458.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 0.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13739.82
  Lower Bound (LB) = 13739.82
  Gap (UB-LB) = 0.0000, Absolute Gap = 0.0000, Relative Gap = 0.000000
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 13
Total Time: 22335.36s
Converged: True
Final Lower Bound: 13739.8158
Final Upper Bound: 13739.8158
Final Gap: 0.000000
Number of Critical Scenarios: 13
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 5, 7, 8] (4/10)
Active Routes (Plant→DC): 10
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 13
Start Time: 2026-01-06 03:02:48
End Time: 2026-01-06 09:15:04
Total Time: 22335.36s
Optimal Value: 13739.82
Lower Bound: 13739.82
Upper Bound: 13739.82
Gap: 0.000000
Plants Opened: {0: [2], 1: [2], 2: [1]} (3 plants)
DCs Opened: [0, 5, 7, 8] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed47_MD_gamma20_20260106_091504.csv

Total Execution Time: 22335.63 seconds
End Time: 2026-01-06 09:15:04

All tasks completed successfully!

